<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>Beyond Scalar Reward Model: Learning Generative Judge from Preference Data</title>
<!--Generated on Tue Oct  1 07:37:50 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<base href="/html/2410.03742v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.03742v1#S1" title="In Beyond Scalar Reward Model: Learning Generative Judge from Preference Data"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03742v1#S2" title="In Beyond Scalar Reward Model: Learning Generative Judge from Preference Data"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Preliminary</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03742v1#S2.SS1" title="In 2 Preliminary ‣ Beyond Scalar Reward Model: Learning Generative Judge from Preference Data"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.1 </span>Task definition</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03742v1#S2.SS2" title="In 2 Preliminary ‣ Beyond Scalar Reward Model: Learning Generative Judge from Preference Data"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2 </span>Scalar Model</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.03742v1#S3" title="In Beyond Scalar Reward Model: Learning Generative Judge from Preference Data"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Improving Generative Judge by Training on Contrastive Judgments</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03742v1#S4" title="In Beyond Scalar Reward Model: Learning Generative Judge from Preference Data"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Experiments</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03742v1#S4.SS1" title="In 4 Experiments ‣ Beyond Scalar Reward Model: Learning Generative Judge from Preference Data"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Experimental Setup</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03742v1#S4.SS2" title="In 4 Experiments ‣ Beyond Scalar Reward Model: Learning Generative Judge from Preference Data"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>Main Results</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03742v1#S4.SS3" title="In 4 Experiments ‣ Beyond Scalar Reward Model: Learning Generative Judge from Preference Data"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3 </span>Preference learning yields meaningful and useful rationales.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03742v1#S4.SS4" title="In 4 Experiments ‣ Beyond Scalar Reward Model: Learning Generative Judge from Preference Data"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.4 </span>Rationales help Con-J become less susceptible to biases in the dataset.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03742v1#S4.SS5" title="In 4 Experiments ‣ Beyond Scalar Reward Model: Learning Generative Judge from Preference Data"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.5 </span>Case Analysis of Con-J</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.03742v1#S5" title="In Beyond Scalar Reward Model: Learning Generative Judge from Preference Data"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>related work</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.03742v1#S6" title="In Beyond Scalar Reward Model: Learning Generative Judge from Preference Data"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6 </span>Discussions and Conclusions</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2410.03742v1#A1" title="In Beyond Scalar Reward Model: Learning Generative Judge from Preference Data"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A </span>Appendix</span></a></li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Beyond Scalar Reward Model: Learning Generative Judge from Preference Data</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Ziyi Ye<sup class="ltx_sup" id="id1.1.id1">1</sup>, Xiangsheng Li<sup class="ltx_sup" id="id2.2.id2">2</sup>, Qiuchi Li<sup class="ltx_sup" id="id3.3.id3">3</sup>, Qingyao Ai<sup class="ltx_sup" id="id4.4.id4">1</sup>, Yujia Zhou<sup class="ltx_sup" id="id5.5.id5">1</sup>, Wei Shen<sup class="ltx_sup" id="id6.6.id6">2</sup>, 
<br class="ltx_break"/><span class="ltx_text ltx_font_bold" id="id7.7.id7">Dong Yan<sup class="ltx_sup" id="id7.7.id7.1"><span class="ltx_text ltx_font_medium" id="id7.7.id7.1.1">2</span></sup></span>, <span class="ltx_text ltx_font_bold" id="id8.8.id8">Yiqun Liu<sup class="ltx_sup" id="id8.8.id8.1"><span class="ltx_text ltx_font_medium" id="id8.8.id8.1.1">1</span></sup></span>
<br class="ltx_break"/><sup class="ltx_sup" id="id9.9.id9">1</sup>Department of Computer Science and Technology, Tsinghua University 
<br class="ltx_break"/><sup class="ltx_sup" id="id10.10.id10">2</sup>Baichuan AI  
<sup class="ltx_sup" id="id11.11.id11">3</sup>University of Copenhagen 
<br class="ltx_break"/>ye-zy20@mails.tsinghua.edu.cn,   lixsh6@gmail.com,   qiuchi.li@di.ku.dk,  aiqy@tsinghua.edu.cn, 
<br class="ltx_break"/>zhouyujia@mail.tsinghua.edu.cn,  shenwei0917@126.com,  sproblvem@gmail.com, 
<br class="ltx_break"/>yiqunliu@tsinghua.edu.cn
</span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id12.id1">Learning from preference feedback is a common practice for aligning large language models (LLMs) with human value.
Conventionally, preference data is learned and encoded into a scalar reward model that connects a value head with an LLM to produce a scalar score as preference or reward.
However, scalar models lack interpretability and are known to be susceptible to biases in datasets.
This paper investigates leveraging the generation capability of LLMs to address both limitations in one shot.
Specifically, we prompt the pre-trained LLM to generate positive and negative judgments, both supported with rationales in natural language form.
The self-generated contrastive judgment pairs are used to train the generative judge with Direct Preference Optimization (DPO).
This proposal of training the generative <span class="ltx_text ltx_font_bold" id="id12.id1.1">J</span>udge using self-generated <span class="ltx_text ltx_font_bold" id="id12.id1.2">Con</span>trastive judgments (Con-J) ensures natural interpretability due to the generated rationales together with the judgments, as well as high robustness against bias without the need for an additional reward head.
Experimental results show that the performance of Con-J is comparable to the scalar reward model trained on the same collection of preference data, and demonstrate its superior interpretability and robustness in encoding human preferences.</p>
</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>
<div class="ltx_para ltx_noindent" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">As  <span class="ltx_glossaryref" title="Artificial Intelligence"><span class="ltx_text ltx_glossary_long">Artificial Intelligence</span></span> (<abbr class="ltx_glossaryref" title="Artificial Intelligence"><span class="ltx_text ltx_glossary_short">AI</span></abbr>) systems advance with the emergence of <span class="ltx_glossaryref" title="Large Language Model"><span class="ltx_text ltx_glossary_long-plural">Large Language Models</span></span>, it is crucial to ensure they align with human instructions, values, and ethics.
<abbr class="ltx_glossaryref" title="Large Language Model"><span class="ltx_text ltx_glossary_short-plural">LLMs</span></abbr> alignment is generally achieved by learning from preference data that compares pairs of responses to a question <cite class="ltx_cite ltx_citemacro_citep">(Rafailov et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03742v1#bib.bib26" title="">2024</a>; Christiano et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03742v1#bib.bib6" title="">2017</a>; Liu et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03742v1#bib.bib22" title="">2020</a>)</cite>.
However, collecting high-quality human preference data is both time-consuming and costly.
In practice, the construction of preference datasets often involves scaling with a combination of human and AI-generated feedback <cite class="ltx_cite ltx_citemacro_cite">Lee et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03742v1#bib.bib20" title="">2023</a>); Hou et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03742v1#bib.bib12" title="">2024</a>)</cite>.
An additional advantage of AI feedback is its ability to be incorporated in real-time, which facilitates online algorithms such as iterative-DPO <cite class="ltx_cite ltx_citemacro_cite">Xiong et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03742v1#bib.bib33" title="">2024</a>); Xu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03742v1#bib.bib34" title="">2023</a>)</cite> and online-DPO <cite class="ltx_cite ltx_citemacro_cite">Guo et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03742v1#bib.bib10" title="">2024</a>)</cite>.
Therefore, it is crucial to develop an efficient and accurate AI-based preference model that aligns with human values.</p>
</div>
<figure class="ltx_figure" id="S1.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="393" id="S1.F1.1.g1" src="x1.png" width="830"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Top: Examples of a preamble, a question, a pair of answers, and the corresponding judgment (see the detailed version in Table <a class="ltx_ref" href="https://arxiv.org/html/2410.03742v1#A1.T5" title="Table 5 ‣ Appendix A Appendix ‣ Beyond Scalar Reward Model: Learning Generative Judge from Preference Data"><span class="ltx_text ltx_ref_tag">5</span></a>). Bottom: Illustrations of a scalar reward model and the proposed Con-J for preference judgment. </figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">To obtain such preferences, industrial practices have used scalar models <cite class="ltx_cite ltx_citemacro_cite">Hou et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03742v1#bib.bib12" title="">2024</a>)</cite> that concatenate the pre-trained LLM with a value head to generate scalar scores for the responses.
However, the scalar model suffers from limitations, particularly in the following aspects:
(i) <span class="ltx_text ltx_font_italic" id="S1.p2.1.1">Lack of interpretability</span>:
Beyond scalar scores, additional rationales are crucial to enhance the reliability of judgments and facilitate human involvement in the evaluation loop.
(ii) <span class="ltx_text ltx_font_italic" id="S1.p2.1.2">Susceptibility to bias</span>:
It is prone to capturing the biases present in the preference dataset rather than human values.
For example, when the majority of positive answers in preference datasets are longer sentences, the learned LLM will likely favor more verbose answers <cite class="ltx_cite ltx_citemacro_citep">(Huang et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03742v1#bib.bib13" title="">2024</a>)</cite>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p3">
<p class="ltx_p" id="S1.p3.3">To address the above limitations, we propose <span class="ltx_text ltx_font_bold" id="S1.p3.3.1">Con-J</span>, which trains a generative <span class="ltx_text ltx_font_bold" id="S1.p3.3.2">J</span>udge using its self-generated <span class="ltx_text ltx_font_bold" id="S1.p3.3.3">Con</span>trastive judgments (see Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03742v1#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Beyond Scalar Reward Model: Learning Generative Judge from Preference Data"><span class="ltx_text ltx_ref_tag">1</span></a>).
Con-J leverages the LLM’s pre-existing judgment abilities <cite class="ltx_cite ltx_citemacro_cite">Zelikman et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03742v1#bib.bib38" title="">2022</a>)</cite> and bootstraps its capacity to generate more accurate judgments.
As shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03742v1#S3.F2" title="Figure 2 ‣ 3 Improving Generative Judge by Training on Contrastive Judgments ‣ Beyond Scalar Reward Model: Learning Generative Judge from Preference Data"><span class="ltx_text ltx_ref_tag">2</span></a>, Con-J consists of three steps:
<span class="ltx_text ltx_markedasmath ltx_font_bold" id="S1.p3.3.4">(Judgment Sampling)</span> Sample several judgments from a pre-trained LLM by prompting it with a query and a pair of candidate answers.
<span class="ltx_text ltx_markedasmath ltx_font_bold" id="S1.p3.3.5">(Judgment Filtering)</span> Leverage the true preference annotations to construct contrastive judgment pairs, i.e., judgments with correct or incorrect preference.
<span class="ltx_text ltx_markedasmath ltx_font_bold" id="S1.p3.3.6">(Training)</span> Train Con-J from the pre-trained LLM based on these contrastive judgments using Direct Preference Optimization (DPO).</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">The design of Con-J differs from existing methods for enhancing the capabilities of generative judges (or LLM-as-a-judge) <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03742v1#bib.bib21" title="">2023</a>; Kim et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03742v1#bib.bib16" title="">2024</a>; Park et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03742v1#bib.bib25" title="">2024</a>)</cite>.
These methods typically depend on external models (particularly GPT-4) or algorithmic schemes to produce high-quality instruction-tuning datasets.
In contrast, Con-J directly learns from preference data using a self-bootstrapping approach similar to that of scalar reward models.
As LLMs become more powerful, aligning them with high-quality judgments becomes more difficult since humans may not always be able to write superior judgments.
Instead, Con-J offers a new way by eliciting what the LLM already knows, supervised by human preferences, which are much easier to obtain than high-quality judgments.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p5">
<p class="ltx_p" id="S1.p5.1">We train and evaluate Con-J on self-built commercial datasets across three domains: Text Creation, Math, and Code and a series of publicly available datasets and benchmarks.
Our findings indicate that Con-J not only significantly outperforms the scalar model in the Text Creation task and achieves comparable performance in Math and Code but also that its performance, when trained on domain-specific data, will significantly surpass that of GPT-4o.
Additionally, Con-J trained on publicly available datasets achieves comparable performance with GPT-4o and surpasses a series of existing open-source models.
As a generative judge, Con-J can generate rationales to support its preference prediction.
We evaluate the correctness of these rationales and find that as the accuracy of preference predictions improves, the correctness of the rationales also increases.
Additionally, in a synthetic experiment, we found that Con-J is less susceptible to dataset biases, which we attribute to its generative training target and its feature to generate rationales simultaneously.
To facilitate further research and development within the community, We release the training process and model weights of Con-J trained on publicly available datasets at <a class="ltx_ref ltx_href" href="https://huggingface.co/ZiyiYe/Con-J-Qwen2-7B" title="">https://huggingface.co/ZiyiYe/Con-J-Qwen2-7B</a>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p6">
<p class="ltx_p" id="S1.p6.1">To summarize, our contributions are:</p>
<ol class="ltx_enumerate" id="S1.I1">
<li class="ltx_item" id="S1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span>
<div class="ltx_para" id="S1.I1.i1.p1">
<p class="ltx_p" id="S1.I1.i1.p1.1">We propose Con-J, an approach that trains a generative judge using a self-bootstrapped technology to learn from preference data.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span>
<div class="ltx_para" id="S1.I1.i2.p1">
<p class="ltx_p" id="S1.I1.i2.p1.1">We show that Con-J can offer more accurate rationales during preference learning.
We also provide theoretical motivation and empirical evidence showing that Con-J can be more robust to dataset biases by training with rationales.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">3.</span>
<div class="ltx_para ltx_noindent" id="S1.I1.i3.p1">
<p class="ltx_p" id="S1.I1.i3.p1.1">We test the performance of Con-J in commercial datasets and publicly available benchmarks.
Con-J outperforms the scalar models and a series of existing generative judges.</p>
</div>
</li>
</ol>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Preliminary</h2>
<section class="ltx_subsection" id="S2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Task definition</h3>
<div class="ltx_para ltx_noindent" id="S2.SS1.p1">
<p class="ltx_p" id="S2.SS1.p1.8">Given a question or prompt <math alttext="q" class="ltx_Math" display="inline" id="S2.SS1.p1.1.m1.1"><semantics id="S2.SS1.p1.1.m1.1a"><mi id="S2.SS1.p1.1.m1.1.1" xref="S2.SS1.p1.1.m1.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.1.m1.1b"><ci id="S2.SS1.p1.1.m1.1.1.cmml" xref="S2.SS1.p1.1.m1.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.1.m1.1c">q</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.1.m1.1d">italic_q</annotation></semantics></math> and a pair of assistant responses <math alttext="a^{1}" class="ltx_Math" display="inline" id="S2.SS1.p1.2.m2.1"><semantics id="S2.SS1.p1.2.m2.1a"><msup id="S2.SS1.p1.2.m2.1.1" xref="S2.SS1.p1.2.m2.1.1.cmml"><mi id="S2.SS1.p1.2.m2.1.1.2" xref="S2.SS1.p1.2.m2.1.1.2.cmml">a</mi><mn id="S2.SS1.p1.2.m2.1.1.3" xref="S2.SS1.p1.2.m2.1.1.3.cmml">1</mn></msup><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.2.m2.1b"><apply id="S2.SS1.p1.2.m2.1.1.cmml" xref="S2.SS1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.2.m2.1.1.1.cmml" xref="S2.SS1.p1.2.m2.1.1">superscript</csymbol><ci id="S2.SS1.p1.2.m2.1.1.2.cmml" xref="S2.SS1.p1.2.m2.1.1.2">𝑎</ci><cn id="S2.SS1.p1.2.m2.1.1.3.cmml" type="integer" xref="S2.SS1.p1.2.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.2.m2.1c">a^{1}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.2.m2.1d">italic_a start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="a^{2}" class="ltx_Math" display="inline" id="S2.SS1.p1.3.m3.1"><semantics id="S2.SS1.p1.3.m3.1a"><msup id="S2.SS1.p1.3.m3.1.1" xref="S2.SS1.p1.3.m3.1.1.cmml"><mi id="S2.SS1.p1.3.m3.1.1.2" xref="S2.SS1.p1.3.m3.1.1.2.cmml">a</mi><mn id="S2.SS1.p1.3.m3.1.1.3" xref="S2.SS1.p1.3.m3.1.1.3.cmml">2</mn></msup><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.3.m3.1b"><apply id="S2.SS1.p1.3.m3.1.1.cmml" xref="S2.SS1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.3.m3.1.1.1.cmml" xref="S2.SS1.p1.3.m3.1.1">superscript</csymbol><ci id="S2.SS1.p1.3.m3.1.1.2.cmml" xref="S2.SS1.p1.3.m3.1.1.2">𝑎</ci><cn id="S2.SS1.p1.3.m3.1.1.3.cmml" type="integer" xref="S2.SS1.p1.3.m3.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.3.m3.1c">a^{2}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.3.m3.1d">italic_a start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math>, the task is to judge the preference between <math alttext="a^{1}" class="ltx_Math" display="inline" id="S2.SS1.p1.4.m4.1"><semantics id="S2.SS1.p1.4.m4.1a"><msup id="S2.SS1.p1.4.m4.1.1" xref="S2.SS1.p1.4.m4.1.1.cmml"><mi id="S2.SS1.p1.4.m4.1.1.2" xref="S2.SS1.p1.4.m4.1.1.2.cmml">a</mi><mn id="S2.SS1.p1.4.m4.1.1.3" xref="S2.SS1.p1.4.m4.1.1.3.cmml">1</mn></msup><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.4.m4.1b"><apply id="S2.SS1.p1.4.m4.1.1.cmml" xref="S2.SS1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.4.m4.1.1.1.cmml" xref="S2.SS1.p1.4.m4.1.1">superscript</csymbol><ci id="S2.SS1.p1.4.m4.1.1.2.cmml" xref="S2.SS1.p1.4.m4.1.1.2">𝑎</ci><cn id="S2.SS1.p1.4.m4.1.1.3.cmml" type="integer" xref="S2.SS1.p1.4.m4.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.4.m4.1c">a^{1}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.4.m4.1d">italic_a start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="a^{2}" class="ltx_Math" display="inline" id="S2.SS1.p1.5.m5.1"><semantics id="S2.SS1.p1.5.m5.1a"><msup id="S2.SS1.p1.5.m5.1.1" xref="S2.SS1.p1.5.m5.1.1.cmml"><mi id="S2.SS1.p1.5.m5.1.1.2" xref="S2.SS1.p1.5.m5.1.1.2.cmml">a</mi><mn id="S2.SS1.p1.5.m5.1.1.3" xref="S2.SS1.p1.5.m5.1.1.3.cmml">2</mn></msup><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.5.m5.1b"><apply id="S2.SS1.p1.5.m5.1.1.cmml" xref="S2.SS1.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.5.m5.1.1.1.cmml" xref="S2.SS1.p1.5.m5.1.1">superscript</csymbol><ci id="S2.SS1.p1.5.m5.1.1.2.cmml" xref="S2.SS1.p1.5.m5.1.1.2">𝑎</ci><cn id="S2.SS1.p1.5.m5.1.1.3.cmml" type="integer" xref="S2.SS1.p1.5.m5.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.5.m5.1c">a^{2}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.5.m5.1d">italic_a start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math>.
To accomplish this, we train the model using an existing preference dataset <math alttext="D=\{(q,a^{-},a^{+})_{i}\}_{i=1}^{N}" class="ltx_Math" display="inline" id="S2.SS1.p1.6.m6.2"><semantics id="S2.SS1.p1.6.m6.2a"><mrow id="S2.SS1.p1.6.m6.2.2" xref="S2.SS1.p1.6.m6.2.2.cmml"><mi id="S2.SS1.p1.6.m6.2.2.3" xref="S2.SS1.p1.6.m6.2.2.3.cmml">D</mi><mo id="S2.SS1.p1.6.m6.2.2.2" xref="S2.SS1.p1.6.m6.2.2.2.cmml">=</mo><msubsup id="S2.SS1.p1.6.m6.2.2.1" xref="S2.SS1.p1.6.m6.2.2.1.cmml"><mrow id="S2.SS1.p1.6.m6.2.2.1.1.1.1" xref="S2.SS1.p1.6.m6.2.2.1.1.1.2.cmml"><mo id="S2.SS1.p1.6.m6.2.2.1.1.1.1.2" stretchy="false" xref="S2.SS1.p1.6.m6.2.2.1.1.1.2.cmml">{</mo><msub id="S2.SS1.p1.6.m6.2.2.1.1.1.1.1" xref="S2.SS1.p1.6.m6.2.2.1.1.1.1.1.cmml"><mrow id="S2.SS1.p1.6.m6.2.2.1.1.1.1.1.2.2" xref="S2.SS1.p1.6.m6.2.2.1.1.1.1.1.2.3.cmml"><mo id="S2.SS1.p1.6.m6.2.2.1.1.1.1.1.2.2.3" stretchy="false" xref="S2.SS1.p1.6.m6.2.2.1.1.1.1.1.2.3.cmml">(</mo><mi id="S2.SS1.p1.6.m6.1.1" xref="S2.SS1.p1.6.m6.1.1.cmml">q</mi><mo id="S2.SS1.p1.6.m6.2.2.1.1.1.1.1.2.2.4" xref="S2.SS1.p1.6.m6.2.2.1.1.1.1.1.2.3.cmml">,</mo><msup id="S2.SS1.p1.6.m6.2.2.1.1.1.1.1.1.1.1" xref="S2.SS1.p1.6.m6.2.2.1.1.1.1.1.1.1.1.cmml"><mi id="S2.SS1.p1.6.m6.2.2.1.1.1.1.1.1.1.1.2" xref="S2.SS1.p1.6.m6.2.2.1.1.1.1.1.1.1.1.2.cmml">a</mi><mo id="S2.SS1.p1.6.m6.2.2.1.1.1.1.1.1.1.1.3" xref="S2.SS1.p1.6.m6.2.2.1.1.1.1.1.1.1.1.3.cmml">−</mo></msup><mo id="S2.SS1.p1.6.m6.2.2.1.1.1.1.1.2.2.5" xref="S2.SS1.p1.6.m6.2.2.1.1.1.1.1.2.3.cmml">,</mo><msup id="S2.SS1.p1.6.m6.2.2.1.1.1.1.1.2.2.2" xref="S2.SS1.p1.6.m6.2.2.1.1.1.1.1.2.2.2.cmml"><mi id="S2.SS1.p1.6.m6.2.2.1.1.1.1.1.2.2.2.2" xref="S2.SS1.p1.6.m6.2.2.1.1.1.1.1.2.2.2.2.cmml">a</mi><mo id="S2.SS1.p1.6.m6.2.2.1.1.1.1.1.2.2.2.3" xref="S2.SS1.p1.6.m6.2.2.1.1.1.1.1.2.2.2.3.cmml">+</mo></msup><mo id="S2.SS1.p1.6.m6.2.2.1.1.1.1.1.2.2.6" stretchy="false" xref="S2.SS1.p1.6.m6.2.2.1.1.1.1.1.2.3.cmml">)</mo></mrow><mi id="S2.SS1.p1.6.m6.2.2.1.1.1.1.1.4" xref="S2.SS1.p1.6.m6.2.2.1.1.1.1.1.4.cmml">i</mi></msub><mo id="S2.SS1.p1.6.m6.2.2.1.1.1.1.3" stretchy="false" xref="S2.SS1.p1.6.m6.2.2.1.1.1.2.cmml">}</mo></mrow><mrow id="S2.SS1.p1.6.m6.2.2.1.1.3" xref="S2.SS1.p1.6.m6.2.2.1.1.3.cmml"><mi id="S2.SS1.p1.6.m6.2.2.1.1.3.2" xref="S2.SS1.p1.6.m6.2.2.1.1.3.2.cmml">i</mi><mo id="S2.SS1.p1.6.m6.2.2.1.1.3.1" xref="S2.SS1.p1.6.m6.2.2.1.1.3.1.cmml">=</mo><mn id="S2.SS1.p1.6.m6.2.2.1.1.3.3" xref="S2.SS1.p1.6.m6.2.2.1.1.3.3.cmml">1</mn></mrow><mi id="S2.SS1.p1.6.m6.2.2.1.3" xref="S2.SS1.p1.6.m6.2.2.1.3.cmml">N</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.6.m6.2b"><apply id="S2.SS1.p1.6.m6.2.2.cmml" xref="S2.SS1.p1.6.m6.2.2"><eq id="S2.SS1.p1.6.m6.2.2.2.cmml" xref="S2.SS1.p1.6.m6.2.2.2"></eq><ci id="S2.SS1.p1.6.m6.2.2.3.cmml" xref="S2.SS1.p1.6.m6.2.2.3">𝐷</ci><apply id="S2.SS1.p1.6.m6.2.2.1.cmml" xref="S2.SS1.p1.6.m6.2.2.1"><csymbol cd="ambiguous" id="S2.SS1.p1.6.m6.2.2.1.2.cmml" xref="S2.SS1.p1.6.m6.2.2.1">superscript</csymbol><apply id="S2.SS1.p1.6.m6.2.2.1.1.cmml" xref="S2.SS1.p1.6.m6.2.2.1"><csymbol cd="ambiguous" id="S2.SS1.p1.6.m6.2.2.1.1.2.cmml" xref="S2.SS1.p1.6.m6.2.2.1">subscript</csymbol><set id="S2.SS1.p1.6.m6.2.2.1.1.1.2.cmml" xref="S2.SS1.p1.6.m6.2.2.1.1.1.1"><apply id="S2.SS1.p1.6.m6.2.2.1.1.1.1.1.cmml" xref="S2.SS1.p1.6.m6.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.6.m6.2.2.1.1.1.1.1.3.cmml" xref="S2.SS1.p1.6.m6.2.2.1.1.1.1.1">subscript</csymbol><vector id="S2.SS1.p1.6.m6.2.2.1.1.1.1.1.2.3.cmml" xref="S2.SS1.p1.6.m6.2.2.1.1.1.1.1.2.2"><ci id="S2.SS1.p1.6.m6.1.1.cmml" xref="S2.SS1.p1.6.m6.1.1">𝑞</ci><apply id="S2.SS1.p1.6.m6.2.2.1.1.1.1.1.1.1.1.cmml" xref="S2.SS1.p1.6.m6.2.2.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.6.m6.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S2.SS1.p1.6.m6.2.2.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S2.SS1.p1.6.m6.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="S2.SS1.p1.6.m6.2.2.1.1.1.1.1.1.1.1.2">𝑎</ci><minus id="S2.SS1.p1.6.m6.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="S2.SS1.p1.6.m6.2.2.1.1.1.1.1.1.1.1.3"></minus></apply><apply id="S2.SS1.p1.6.m6.2.2.1.1.1.1.1.2.2.2.cmml" xref="S2.SS1.p1.6.m6.2.2.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S2.SS1.p1.6.m6.2.2.1.1.1.1.1.2.2.2.1.cmml" xref="S2.SS1.p1.6.m6.2.2.1.1.1.1.1.2.2.2">superscript</csymbol><ci id="S2.SS1.p1.6.m6.2.2.1.1.1.1.1.2.2.2.2.cmml" xref="S2.SS1.p1.6.m6.2.2.1.1.1.1.1.2.2.2.2">𝑎</ci><plus id="S2.SS1.p1.6.m6.2.2.1.1.1.1.1.2.2.2.3.cmml" xref="S2.SS1.p1.6.m6.2.2.1.1.1.1.1.2.2.2.3"></plus></apply></vector><ci id="S2.SS1.p1.6.m6.2.2.1.1.1.1.1.4.cmml" xref="S2.SS1.p1.6.m6.2.2.1.1.1.1.1.4">𝑖</ci></apply></set><apply id="S2.SS1.p1.6.m6.2.2.1.1.3.cmml" xref="S2.SS1.p1.6.m6.2.2.1.1.3"><eq id="S2.SS1.p1.6.m6.2.2.1.1.3.1.cmml" xref="S2.SS1.p1.6.m6.2.2.1.1.3.1"></eq><ci id="S2.SS1.p1.6.m6.2.2.1.1.3.2.cmml" xref="S2.SS1.p1.6.m6.2.2.1.1.3.2">𝑖</ci><cn id="S2.SS1.p1.6.m6.2.2.1.1.3.3.cmml" type="integer" xref="S2.SS1.p1.6.m6.2.2.1.1.3.3">1</cn></apply></apply><ci id="S2.SS1.p1.6.m6.2.2.1.3.cmml" xref="S2.SS1.p1.6.m6.2.2.1.3">𝑁</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.6.m6.2c">D=\{(q,a^{-},a^{+})_{i}\}_{i=1}^{N}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.6.m6.2d">italic_D = { ( italic_q , italic_a start_POSTSUPERSCRIPT - end_POSTSUPERSCRIPT , italic_a start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT ) start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT } start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT</annotation></semantics></math>, where <math alttext="a^{+}" class="ltx_Math" display="inline" id="S2.SS1.p1.7.m7.1"><semantics id="S2.SS1.p1.7.m7.1a"><msup id="S2.SS1.p1.7.m7.1.1" xref="S2.SS1.p1.7.m7.1.1.cmml"><mi id="S2.SS1.p1.7.m7.1.1.2" xref="S2.SS1.p1.7.m7.1.1.2.cmml">a</mi><mo id="S2.SS1.p1.7.m7.1.1.3" xref="S2.SS1.p1.7.m7.1.1.3.cmml">+</mo></msup><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.7.m7.1b"><apply id="S2.SS1.p1.7.m7.1.1.cmml" xref="S2.SS1.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.7.m7.1.1.1.cmml" xref="S2.SS1.p1.7.m7.1.1">superscript</csymbol><ci id="S2.SS1.p1.7.m7.1.1.2.cmml" xref="S2.SS1.p1.7.m7.1.1.2">𝑎</ci><plus id="S2.SS1.p1.7.m7.1.1.3.cmml" xref="S2.SS1.p1.7.m7.1.1.3"></plus></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.7.m7.1c">a^{+}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.7.m7.1d">italic_a start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT</annotation></semantics></math> is a preferred answer compared to <math alttext="a^{-}" class="ltx_Math" display="inline" id="S2.SS1.p1.8.m8.1"><semantics id="S2.SS1.p1.8.m8.1a"><msup id="S2.SS1.p1.8.m8.1.1" xref="S2.SS1.p1.8.m8.1.1.cmml"><mi id="S2.SS1.p1.8.m8.1.1.2" xref="S2.SS1.p1.8.m8.1.1.2.cmml">a</mi><mo id="S2.SS1.p1.8.m8.1.1.3" xref="S2.SS1.p1.8.m8.1.1.3.cmml">−</mo></msup><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.8.m8.1b"><apply id="S2.SS1.p1.8.m8.1.1.cmml" xref="S2.SS1.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.8.m8.1.1.1.cmml" xref="S2.SS1.p1.8.m8.1.1">superscript</csymbol><ci id="S2.SS1.p1.8.m8.1.1.2.cmml" xref="S2.SS1.p1.8.m8.1.1.2">𝑎</ci><minus id="S2.SS1.p1.8.m8.1.1.3.cmml" xref="S2.SS1.p1.8.m8.1.1.3"></minus></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.8.m8.1c">a^{-}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.8.m8.1d">italic_a start_POSTSUPERSCRIPT - end_POSTSUPERSCRIPT</annotation></semantics></math>.
The model’s performance is subsequently evaluated on a separate, non-overlapping preference dataset by measuring the accuracy of its preference judgments.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>Scalar Model</h3>
<div class="ltx_para ltx_noindent" id="S2.SS2.p1">
<p class="ltx_p" id="S2.SS2.p1.5">The most common practice for getting the preference judgment is to use a scalar model (SM) similar to the reward model in the RLHF stage (<cite class="ltx_cite ltx_citemacro_cite">Hou et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03742v1#bib.bib12" title="">2024</a>)</cite>).
The SM predicts numerical scores <math alttext="r(q,a)" class="ltx_Math" display="inline" id="S2.SS2.p1.1.m1.2"><semantics id="S2.SS2.p1.1.m1.2a"><mrow id="S2.SS2.p1.1.m1.2.3" xref="S2.SS2.p1.1.m1.2.3.cmml"><mi id="S2.SS2.p1.1.m1.2.3.2" xref="S2.SS2.p1.1.m1.2.3.2.cmml">r</mi><mo id="S2.SS2.p1.1.m1.2.3.1" xref="S2.SS2.p1.1.m1.2.3.1.cmml">⁢</mo><mrow id="S2.SS2.p1.1.m1.2.3.3.2" xref="S2.SS2.p1.1.m1.2.3.3.1.cmml"><mo id="S2.SS2.p1.1.m1.2.3.3.2.1" stretchy="false" xref="S2.SS2.p1.1.m1.2.3.3.1.cmml">(</mo><mi id="S2.SS2.p1.1.m1.1.1" xref="S2.SS2.p1.1.m1.1.1.cmml">q</mi><mo id="S2.SS2.p1.1.m1.2.3.3.2.2" xref="S2.SS2.p1.1.m1.2.3.3.1.cmml">,</mo><mi id="S2.SS2.p1.1.m1.2.2" xref="S2.SS2.p1.1.m1.2.2.cmml">a</mi><mo id="S2.SS2.p1.1.m1.2.3.3.2.3" stretchy="false" xref="S2.SS2.p1.1.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.1.m1.2b"><apply id="S2.SS2.p1.1.m1.2.3.cmml" xref="S2.SS2.p1.1.m1.2.3"><times id="S2.SS2.p1.1.m1.2.3.1.cmml" xref="S2.SS2.p1.1.m1.2.3.1"></times><ci id="S2.SS2.p1.1.m1.2.3.2.cmml" xref="S2.SS2.p1.1.m1.2.3.2">𝑟</ci><interval closure="open" id="S2.SS2.p1.1.m1.2.3.3.1.cmml" xref="S2.SS2.p1.1.m1.2.3.3.2"><ci id="S2.SS2.p1.1.m1.1.1.cmml" xref="S2.SS2.p1.1.m1.1.1">𝑞</ci><ci id="S2.SS2.p1.1.m1.2.2.cmml" xref="S2.SS2.p1.1.m1.2.2">𝑎</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.1.m1.2c">r(q,a)</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.1.m1.2d">italic_r ( italic_q , italic_a )</annotation></semantics></math> for <math alttext="a\in\{a^{1},a^{2}\}" class="ltx_Math" display="inline" id="S2.SS2.p1.2.m2.2"><semantics id="S2.SS2.p1.2.m2.2a"><mrow id="S2.SS2.p1.2.m2.2.2" xref="S2.SS2.p1.2.m2.2.2.cmml"><mi id="S2.SS2.p1.2.m2.2.2.4" xref="S2.SS2.p1.2.m2.2.2.4.cmml">a</mi><mo id="S2.SS2.p1.2.m2.2.2.3" xref="S2.SS2.p1.2.m2.2.2.3.cmml">∈</mo><mrow id="S2.SS2.p1.2.m2.2.2.2.2" xref="S2.SS2.p1.2.m2.2.2.2.3.cmml"><mo id="S2.SS2.p1.2.m2.2.2.2.2.3" stretchy="false" xref="S2.SS2.p1.2.m2.2.2.2.3.cmml">{</mo><msup id="S2.SS2.p1.2.m2.1.1.1.1.1" xref="S2.SS2.p1.2.m2.1.1.1.1.1.cmml"><mi id="S2.SS2.p1.2.m2.1.1.1.1.1.2" xref="S2.SS2.p1.2.m2.1.1.1.1.1.2.cmml">a</mi><mn id="S2.SS2.p1.2.m2.1.1.1.1.1.3" xref="S2.SS2.p1.2.m2.1.1.1.1.1.3.cmml">1</mn></msup><mo id="S2.SS2.p1.2.m2.2.2.2.2.4" xref="S2.SS2.p1.2.m2.2.2.2.3.cmml">,</mo><msup id="S2.SS2.p1.2.m2.2.2.2.2.2" xref="S2.SS2.p1.2.m2.2.2.2.2.2.cmml"><mi id="S2.SS2.p1.2.m2.2.2.2.2.2.2" xref="S2.SS2.p1.2.m2.2.2.2.2.2.2.cmml">a</mi><mn id="S2.SS2.p1.2.m2.2.2.2.2.2.3" xref="S2.SS2.p1.2.m2.2.2.2.2.2.3.cmml">2</mn></msup><mo id="S2.SS2.p1.2.m2.2.2.2.2.5" stretchy="false" xref="S2.SS2.p1.2.m2.2.2.2.3.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.2.m2.2b"><apply id="S2.SS2.p1.2.m2.2.2.cmml" xref="S2.SS2.p1.2.m2.2.2"><in id="S2.SS2.p1.2.m2.2.2.3.cmml" xref="S2.SS2.p1.2.m2.2.2.3"></in><ci id="S2.SS2.p1.2.m2.2.2.4.cmml" xref="S2.SS2.p1.2.m2.2.2.4">𝑎</ci><set id="S2.SS2.p1.2.m2.2.2.2.3.cmml" xref="S2.SS2.p1.2.m2.2.2.2.2"><apply id="S2.SS2.p1.2.m2.1.1.1.1.1.cmml" xref="S2.SS2.p1.2.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.2.m2.1.1.1.1.1.1.cmml" xref="S2.SS2.p1.2.m2.1.1.1.1.1">superscript</csymbol><ci id="S2.SS2.p1.2.m2.1.1.1.1.1.2.cmml" xref="S2.SS2.p1.2.m2.1.1.1.1.1.2">𝑎</ci><cn id="S2.SS2.p1.2.m2.1.1.1.1.1.3.cmml" type="integer" xref="S2.SS2.p1.2.m2.1.1.1.1.1.3">1</cn></apply><apply id="S2.SS2.p1.2.m2.2.2.2.2.2.cmml" xref="S2.SS2.p1.2.m2.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.p1.2.m2.2.2.2.2.2.1.cmml" xref="S2.SS2.p1.2.m2.2.2.2.2.2">superscript</csymbol><ci id="S2.SS2.p1.2.m2.2.2.2.2.2.2.cmml" xref="S2.SS2.p1.2.m2.2.2.2.2.2.2">𝑎</ci><cn id="S2.SS2.p1.2.m2.2.2.2.2.2.3.cmml" type="integer" xref="S2.SS2.p1.2.m2.2.2.2.2.2.3">2</cn></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.2.m2.2c">a\in\{a^{1},a^{2}\}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.2.m2.2d">italic_a ∈ { italic_a start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT , italic_a start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT }</annotation></semantics></math> and judges the preference by comparing <math alttext="r(q,a^{1})" class="ltx_Math" display="inline" id="S2.SS2.p1.3.m3.2"><semantics id="S2.SS2.p1.3.m3.2a"><mrow id="S2.SS2.p1.3.m3.2.2" xref="S2.SS2.p1.3.m3.2.2.cmml"><mi id="S2.SS2.p1.3.m3.2.2.3" xref="S2.SS2.p1.3.m3.2.2.3.cmml">r</mi><mo id="S2.SS2.p1.3.m3.2.2.2" xref="S2.SS2.p1.3.m3.2.2.2.cmml">⁢</mo><mrow id="S2.SS2.p1.3.m3.2.2.1.1" xref="S2.SS2.p1.3.m3.2.2.1.2.cmml"><mo id="S2.SS2.p1.3.m3.2.2.1.1.2" stretchy="false" xref="S2.SS2.p1.3.m3.2.2.1.2.cmml">(</mo><mi id="S2.SS2.p1.3.m3.1.1" xref="S2.SS2.p1.3.m3.1.1.cmml">q</mi><mo id="S2.SS2.p1.3.m3.2.2.1.1.3" xref="S2.SS2.p1.3.m3.2.2.1.2.cmml">,</mo><msup id="S2.SS2.p1.3.m3.2.2.1.1.1" xref="S2.SS2.p1.3.m3.2.2.1.1.1.cmml"><mi id="S2.SS2.p1.3.m3.2.2.1.1.1.2" xref="S2.SS2.p1.3.m3.2.2.1.1.1.2.cmml">a</mi><mn id="S2.SS2.p1.3.m3.2.2.1.1.1.3" xref="S2.SS2.p1.3.m3.2.2.1.1.1.3.cmml">1</mn></msup><mo id="S2.SS2.p1.3.m3.2.2.1.1.4" stretchy="false" xref="S2.SS2.p1.3.m3.2.2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.3.m3.2b"><apply id="S2.SS2.p1.3.m3.2.2.cmml" xref="S2.SS2.p1.3.m3.2.2"><times id="S2.SS2.p1.3.m3.2.2.2.cmml" xref="S2.SS2.p1.3.m3.2.2.2"></times><ci id="S2.SS2.p1.3.m3.2.2.3.cmml" xref="S2.SS2.p1.3.m3.2.2.3">𝑟</ci><interval closure="open" id="S2.SS2.p1.3.m3.2.2.1.2.cmml" xref="S2.SS2.p1.3.m3.2.2.1.1"><ci id="S2.SS2.p1.3.m3.1.1.cmml" xref="S2.SS2.p1.3.m3.1.1">𝑞</ci><apply id="S2.SS2.p1.3.m3.2.2.1.1.1.cmml" xref="S2.SS2.p1.3.m3.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.3.m3.2.2.1.1.1.1.cmml" xref="S2.SS2.p1.3.m3.2.2.1.1.1">superscript</csymbol><ci id="S2.SS2.p1.3.m3.2.2.1.1.1.2.cmml" xref="S2.SS2.p1.3.m3.2.2.1.1.1.2">𝑎</ci><cn id="S2.SS2.p1.3.m3.2.2.1.1.1.3.cmml" type="integer" xref="S2.SS2.p1.3.m3.2.2.1.1.1.3">1</cn></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.3.m3.2c">r(q,a^{1})</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.3.m3.2d">italic_r ( italic_q , italic_a start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT )</annotation></semantics></math> and <math alttext="r(q,a^{2})" class="ltx_Math" display="inline" id="S2.SS2.p1.4.m4.2"><semantics id="S2.SS2.p1.4.m4.2a"><mrow id="S2.SS2.p1.4.m4.2.2" xref="S2.SS2.p1.4.m4.2.2.cmml"><mi id="S2.SS2.p1.4.m4.2.2.3" xref="S2.SS2.p1.4.m4.2.2.3.cmml">r</mi><mo id="S2.SS2.p1.4.m4.2.2.2" xref="S2.SS2.p1.4.m4.2.2.2.cmml">⁢</mo><mrow id="S2.SS2.p1.4.m4.2.2.1.1" xref="S2.SS2.p1.4.m4.2.2.1.2.cmml"><mo id="S2.SS2.p1.4.m4.2.2.1.1.2" stretchy="false" xref="S2.SS2.p1.4.m4.2.2.1.2.cmml">(</mo><mi id="S2.SS2.p1.4.m4.1.1" xref="S2.SS2.p1.4.m4.1.1.cmml">q</mi><mo id="S2.SS2.p1.4.m4.2.2.1.1.3" xref="S2.SS2.p1.4.m4.2.2.1.2.cmml">,</mo><msup id="S2.SS2.p1.4.m4.2.2.1.1.1" xref="S2.SS2.p1.4.m4.2.2.1.1.1.cmml"><mi id="S2.SS2.p1.4.m4.2.2.1.1.1.2" xref="S2.SS2.p1.4.m4.2.2.1.1.1.2.cmml">a</mi><mn id="S2.SS2.p1.4.m4.2.2.1.1.1.3" xref="S2.SS2.p1.4.m4.2.2.1.1.1.3.cmml">2</mn></msup><mo id="S2.SS2.p1.4.m4.2.2.1.1.4" stretchy="false" xref="S2.SS2.p1.4.m4.2.2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.4.m4.2b"><apply id="S2.SS2.p1.4.m4.2.2.cmml" xref="S2.SS2.p1.4.m4.2.2"><times id="S2.SS2.p1.4.m4.2.2.2.cmml" xref="S2.SS2.p1.4.m4.2.2.2"></times><ci id="S2.SS2.p1.4.m4.2.2.3.cmml" xref="S2.SS2.p1.4.m4.2.2.3">𝑟</ci><interval closure="open" id="S2.SS2.p1.4.m4.2.2.1.2.cmml" xref="S2.SS2.p1.4.m4.2.2.1.1"><ci id="S2.SS2.p1.4.m4.1.1.cmml" xref="S2.SS2.p1.4.m4.1.1">𝑞</ci><apply id="S2.SS2.p1.4.m4.2.2.1.1.1.cmml" xref="S2.SS2.p1.4.m4.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.4.m4.2.2.1.1.1.1.cmml" xref="S2.SS2.p1.4.m4.2.2.1.1.1">superscript</csymbol><ci id="S2.SS2.p1.4.m4.2.2.1.1.1.2.cmml" xref="S2.SS2.p1.4.m4.2.2.1.1.1.2">𝑎</ci><cn id="S2.SS2.p1.4.m4.2.2.1.1.1.3.cmml" type="integer" xref="S2.SS2.p1.4.m4.2.2.1.1.1.3">2</cn></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.4.m4.2c">r(q,a^{2})</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.4.m4.2d">italic_r ( italic_q , italic_a start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT )</annotation></semantics></math>.
It is typically initialized by concatenating a pre-trained LLM with a randomly initialized shallow MLP head.
The most widely used training objective for the SM follows the Bradley-Terry model, which maximizes the probability of <math alttext="a^{+}" class="ltx_Math" display="inline" id="S2.SS2.p1.5.m5.1"><semantics id="S2.SS2.p1.5.m5.1a"><msup id="S2.SS2.p1.5.m5.1.1" xref="S2.SS2.p1.5.m5.1.1.cmml"><mi id="S2.SS2.p1.5.m5.1.1.2" xref="S2.SS2.p1.5.m5.1.1.2.cmml">a</mi><mo id="S2.SS2.p1.5.m5.1.1.3" xref="S2.SS2.p1.5.m5.1.1.3.cmml">+</mo></msup><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.5.m5.1b"><apply id="S2.SS2.p1.5.m5.1.1.cmml" xref="S2.SS2.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.5.m5.1.1.1.cmml" xref="S2.SS2.p1.5.m5.1.1">superscript</csymbol><ci id="S2.SS2.p1.5.m5.1.1.2.cmml" xref="S2.SS2.p1.5.m5.1.1.2">𝑎</ci><plus id="S2.SS2.p1.5.m5.1.1.3.cmml" xref="S2.SS2.p1.5.m5.1.1.3"></plus></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.5.m5.1c">a^{+}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.5.m5.1d">italic_a start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT</annotation></semantics></math> being preferred:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="P(a^{+}\succ a^{-}|q)=\frac{\exp(r(q,a^{+}))}{\exp(r(q,a^{+}))+\exp(r(q,a^{-})%
)}=\sigma\big{(}r(q,a^{+})-r(q,a^{-})\big{)}" class="ltx_Math" display="block" id="S2.E1.m1.13"><semantics id="S2.E1.m1.13a"><mrow id="S2.E1.m1.13.13" xref="S2.E1.m1.13.13.cmml"><mrow id="S2.E1.m1.12.12.1" xref="S2.E1.m1.12.12.1.cmml"><mi id="S2.E1.m1.12.12.1.3" xref="S2.E1.m1.12.12.1.3.cmml">P</mi><mo id="S2.E1.m1.12.12.1.2" xref="S2.E1.m1.12.12.1.2.cmml">⁢</mo><mrow id="S2.E1.m1.12.12.1.1.1" xref="S2.E1.m1.12.12.1.1.1.1.cmml"><mo id="S2.E1.m1.12.12.1.1.1.2" stretchy="false" xref="S2.E1.m1.12.12.1.1.1.1.cmml">(</mo><mrow id="S2.E1.m1.12.12.1.1.1.1" xref="S2.E1.m1.12.12.1.1.1.1.cmml"><msup id="S2.E1.m1.12.12.1.1.1.1.2" xref="S2.E1.m1.12.12.1.1.1.1.2.cmml"><mi id="S2.E1.m1.12.12.1.1.1.1.2.2" xref="S2.E1.m1.12.12.1.1.1.1.2.2.cmml">a</mi><mo id="S2.E1.m1.12.12.1.1.1.1.2.3" xref="S2.E1.m1.12.12.1.1.1.1.2.3.cmml">+</mo></msup><mo id="S2.E1.m1.12.12.1.1.1.1.1" xref="S2.E1.m1.12.12.1.1.1.1.1.cmml">≻</mo><mrow id="S2.E1.m1.12.12.1.1.1.1.3" xref="S2.E1.m1.12.12.1.1.1.1.3.cmml"><msup id="S2.E1.m1.12.12.1.1.1.1.3.2" xref="S2.E1.m1.12.12.1.1.1.1.3.2.cmml"><mi id="S2.E1.m1.12.12.1.1.1.1.3.2.2" xref="S2.E1.m1.12.12.1.1.1.1.3.2.2.cmml">a</mi><mo id="S2.E1.m1.12.12.1.1.1.1.3.2.3" xref="S2.E1.m1.12.12.1.1.1.1.3.2.3.cmml">−</mo></msup><mo fence="false" id="S2.E1.m1.12.12.1.1.1.1.3.1" xref="S2.E1.m1.12.12.1.1.1.1.3.1.cmml">|</mo><mi id="S2.E1.m1.12.12.1.1.1.1.3.3" xref="S2.E1.m1.12.12.1.1.1.1.3.3.cmml">q</mi></mrow></mrow><mo id="S2.E1.m1.12.12.1.1.1.3" stretchy="false" xref="S2.E1.m1.12.12.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E1.m1.13.13.4" xref="S2.E1.m1.13.13.4.cmml">=</mo><mfrac id="S2.E1.m1.9.9" xref="S2.E1.m1.9.9.cmml"><mrow id="S2.E1.m1.3.3.3.3" xref="S2.E1.m1.3.3.3.4.cmml"><mi id="S2.E1.m1.2.2.2.2" xref="S2.E1.m1.2.2.2.2.cmml">exp</mi><mo id="S2.E1.m1.3.3.3.3a" xref="S2.E1.m1.3.3.3.4.cmml">⁡</mo><mrow id="S2.E1.m1.3.3.3.3.1" xref="S2.E1.m1.3.3.3.4.cmml"><mo id="S2.E1.m1.3.3.3.3.1.2" stretchy="false" xref="S2.E1.m1.3.3.3.4.cmml">(</mo><mrow id="S2.E1.m1.3.3.3.3.1.1" xref="S2.E1.m1.3.3.3.3.1.1.cmml"><mi id="S2.E1.m1.3.3.3.3.1.1.3" xref="S2.E1.m1.3.3.3.3.1.1.3.cmml">r</mi><mo id="S2.E1.m1.3.3.3.3.1.1.2" xref="S2.E1.m1.3.3.3.3.1.1.2.cmml">⁢</mo><mrow id="S2.E1.m1.3.3.3.3.1.1.1.1" xref="S2.E1.m1.3.3.3.3.1.1.1.2.cmml"><mo id="S2.E1.m1.3.3.3.3.1.1.1.1.2" stretchy="false" xref="S2.E1.m1.3.3.3.3.1.1.1.2.cmml">(</mo><mi id="S2.E1.m1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.cmml">q</mi><mo id="S2.E1.m1.3.3.3.3.1.1.1.1.3" xref="S2.E1.m1.3.3.3.3.1.1.1.2.cmml">,</mo><msup id="S2.E1.m1.3.3.3.3.1.1.1.1.1" xref="S2.E1.m1.3.3.3.3.1.1.1.1.1.cmml"><mi id="S2.E1.m1.3.3.3.3.1.1.1.1.1.2" xref="S2.E1.m1.3.3.3.3.1.1.1.1.1.2.cmml">a</mi><mo id="S2.E1.m1.3.3.3.3.1.1.1.1.1.3" xref="S2.E1.m1.3.3.3.3.1.1.1.1.1.3.cmml">+</mo></msup><mo id="S2.E1.m1.3.3.3.3.1.1.1.1.4" stretchy="false" xref="S2.E1.m1.3.3.3.3.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S2.E1.m1.3.3.3.3.1.3" stretchy="false" xref="S2.E1.m1.3.3.3.4.cmml">)</mo></mrow></mrow><mrow id="S2.E1.m1.9.9.9" xref="S2.E1.m1.9.9.9.cmml"><mrow id="S2.E1.m1.8.8.8.5.1" xref="S2.E1.m1.8.8.8.5.2.cmml"><mi id="S2.E1.m1.5.5.5.2" xref="S2.E1.m1.5.5.5.2.cmml">exp</mi><mo id="S2.E1.m1.8.8.8.5.1a" xref="S2.E1.m1.8.8.8.5.2.cmml">⁡</mo><mrow id="S2.E1.m1.8.8.8.5.1.1" xref="S2.E1.m1.8.8.8.5.2.cmml"><mo id="S2.E1.m1.8.8.8.5.1.1.2" stretchy="false" xref="S2.E1.m1.8.8.8.5.2.cmml">(</mo><mrow id="S2.E1.m1.8.8.8.5.1.1.1" xref="S2.E1.m1.8.8.8.5.1.1.1.cmml"><mi id="S2.E1.m1.8.8.8.5.1.1.1.3" xref="S2.E1.m1.8.8.8.5.1.1.1.3.cmml">r</mi><mo id="S2.E1.m1.8.8.8.5.1.1.1.2" xref="S2.E1.m1.8.8.8.5.1.1.1.2.cmml">⁢</mo><mrow id="S2.E1.m1.8.8.8.5.1.1.1.1.1" xref="S2.E1.m1.8.8.8.5.1.1.1.1.2.cmml"><mo id="S2.E1.m1.8.8.8.5.1.1.1.1.1.2" stretchy="false" xref="S2.E1.m1.8.8.8.5.1.1.1.1.2.cmml">(</mo><mi id="S2.E1.m1.4.4.4.1" xref="S2.E1.m1.4.4.4.1.cmml">q</mi><mo id="S2.E1.m1.8.8.8.5.1.1.1.1.1.3" xref="S2.E1.m1.8.8.8.5.1.1.1.1.2.cmml">,</mo><msup id="S2.E1.m1.8.8.8.5.1.1.1.1.1.1" xref="S2.E1.m1.8.8.8.5.1.1.1.1.1.1.cmml"><mi id="S2.E1.m1.8.8.8.5.1.1.1.1.1.1.2" xref="S2.E1.m1.8.8.8.5.1.1.1.1.1.1.2.cmml">a</mi><mo id="S2.E1.m1.8.8.8.5.1.1.1.1.1.1.3" xref="S2.E1.m1.8.8.8.5.1.1.1.1.1.1.3.cmml">+</mo></msup><mo id="S2.E1.m1.8.8.8.5.1.1.1.1.1.4" stretchy="false" xref="S2.E1.m1.8.8.8.5.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S2.E1.m1.8.8.8.5.1.1.3" stretchy="false" xref="S2.E1.m1.8.8.8.5.2.cmml">)</mo></mrow></mrow><mo id="S2.E1.m1.9.9.9.7" xref="S2.E1.m1.9.9.9.7.cmml">+</mo><mrow id="S2.E1.m1.9.9.9.6.1" xref="S2.E1.m1.9.9.9.6.2.cmml"><mi id="S2.E1.m1.7.7.7.4" xref="S2.E1.m1.7.7.7.4.cmml">exp</mi><mo id="S2.E1.m1.9.9.9.6.1a" xref="S2.E1.m1.9.9.9.6.2.cmml">⁡</mo><mrow id="S2.E1.m1.9.9.9.6.1.1" xref="S2.E1.m1.9.9.9.6.2.cmml"><mo id="S2.E1.m1.9.9.9.6.1.1.2" stretchy="false" xref="S2.E1.m1.9.9.9.6.2.cmml">(</mo><mrow id="S2.E1.m1.9.9.9.6.1.1.1" xref="S2.E1.m1.9.9.9.6.1.1.1.cmml"><mi id="S2.E1.m1.9.9.9.6.1.1.1.3" xref="S2.E1.m1.9.9.9.6.1.1.1.3.cmml">r</mi><mo id="S2.E1.m1.9.9.9.6.1.1.1.2" xref="S2.E1.m1.9.9.9.6.1.1.1.2.cmml">⁢</mo><mrow id="S2.E1.m1.9.9.9.6.1.1.1.1.1" xref="S2.E1.m1.9.9.9.6.1.1.1.1.2.cmml"><mo id="S2.E1.m1.9.9.9.6.1.1.1.1.1.2" stretchy="false" xref="S2.E1.m1.9.9.9.6.1.1.1.1.2.cmml">(</mo><mi id="S2.E1.m1.6.6.6.3" xref="S2.E1.m1.6.6.6.3.cmml">q</mi><mo id="S2.E1.m1.9.9.9.6.1.1.1.1.1.3" xref="S2.E1.m1.9.9.9.6.1.1.1.1.2.cmml">,</mo><msup id="S2.E1.m1.9.9.9.6.1.1.1.1.1.1" xref="S2.E1.m1.9.9.9.6.1.1.1.1.1.1.cmml"><mi id="S2.E1.m1.9.9.9.6.1.1.1.1.1.1.2" xref="S2.E1.m1.9.9.9.6.1.1.1.1.1.1.2.cmml">a</mi><mo id="S2.E1.m1.9.9.9.6.1.1.1.1.1.1.3" xref="S2.E1.m1.9.9.9.6.1.1.1.1.1.1.3.cmml">−</mo></msup><mo id="S2.E1.m1.9.9.9.6.1.1.1.1.1.4" stretchy="false" xref="S2.E1.m1.9.9.9.6.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S2.E1.m1.9.9.9.6.1.1.3" stretchy="false" xref="S2.E1.m1.9.9.9.6.2.cmml">)</mo></mrow></mrow></mrow></mfrac><mo id="S2.E1.m1.13.13.5" xref="S2.E1.m1.13.13.5.cmml">=</mo><mrow id="S2.E1.m1.13.13.2" xref="S2.E1.m1.13.13.2.cmml"><mi id="S2.E1.m1.13.13.2.3" xref="S2.E1.m1.13.13.2.3.cmml">σ</mi><mo id="S2.E1.m1.13.13.2.2" xref="S2.E1.m1.13.13.2.2.cmml">⁢</mo><mrow id="S2.E1.m1.13.13.2.1.1" xref="S2.E1.m1.13.13.2.1.1.1.cmml"><mo id="S2.E1.m1.13.13.2.1.1.2" maxsize="120%" minsize="120%" xref="S2.E1.m1.13.13.2.1.1.1.cmml">(</mo><mrow id="S2.E1.m1.13.13.2.1.1.1" xref="S2.E1.m1.13.13.2.1.1.1.cmml"><mrow id="S2.E1.m1.13.13.2.1.1.1.1" xref="S2.E1.m1.13.13.2.1.1.1.1.cmml"><mi id="S2.E1.m1.13.13.2.1.1.1.1.3" xref="S2.E1.m1.13.13.2.1.1.1.1.3.cmml">r</mi><mo id="S2.E1.m1.13.13.2.1.1.1.1.2" xref="S2.E1.m1.13.13.2.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E1.m1.13.13.2.1.1.1.1.1.1" xref="S2.E1.m1.13.13.2.1.1.1.1.1.2.cmml"><mo id="S2.E1.m1.13.13.2.1.1.1.1.1.1.2" stretchy="false" xref="S2.E1.m1.13.13.2.1.1.1.1.1.2.cmml">(</mo><mi id="S2.E1.m1.10.10" xref="S2.E1.m1.10.10.cmml">q</mi><mo id="S2.E1.m1.13.13.2.1.1.1.1.1.1.3" xref="S2.E1.m1.13.13.2.1.1.1.1.1.2.cmml">,</mo><msup id="S2.E1.m1.13.13.2.1.1.1.1.1.1.1" xref="S2.E1.m1.13.13.2.1.1.1.1.1.1.1.cmml"><mi id="S2.E1.m1.13.13.2.1.1.1.1.1.1.1.2" xref="S2.E1.m1.13.13.2.1.1.1.1.1.1.1.2.cmml">a</mi><mo id="S2.E1.m1.13.13.2.1.1.1.1.1.1.1.3" xref="S2.E1.m1.13.13.2.1.1.1.1.1.1.1.3.cmml">+</mo></msup><mo id="S2.E1.m1.13.13.2.1.1.1.1.1.1.4" stretchy="false" xref="S2.E1.m1.13.13.2.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S2.E1.m1.13.13.2.1.1.1.3" xref="S2.E1.m1.13.13.2.1.1.1.3.cmml">−</mo><mrow id="S2.E1.m1.13.13.2.1.1.1.2" xref="S2.E1.m1.13.13.2.1.1.1.2.cmml"><mi id="S2.E1.m1.13.13.2.1.1.1.2.3" xref="S2.E1.m1.13.13.2.1.1.1.2.3.cmml">r</mi><mo id="S2.E1.m1.13.13.2.1.1.1.2.2" xref="S2.E1.m1.13.13.2.1.1.1.2.2.cmml">⁢</mo><mrow id="S2.E1.m1.13.13.2.1.1.1.2.1.1" xref="S2.E1.m1.13.13.2.1.1.1.2.1.2.cmml"><mo id="S2.E1.m1.13.13.2.1.1.1.2.1.1.2" stretchy="false" xref="S2.E1.m1.13.13.2.1.1.1.2.1.2.cmml">(</mo><mi id="S2.E1.m1.11.11" xref="S2.E1.m1.11.11.cmml">q</mi><mo id="S2.E1.m1.13.13.2.1.1.1.2.1.1.3" xref="S2.E1.m1.13.13.2.1.1.1.2.1.2.cmml">,</mo><msup id="S2.E1.m1.13.13.2.1.1.1.2.1.1.1" xref="S2.E1.m1.13.13.2.1.1.1.2.1.1.1.cmml"><mi id="S2.E1.m1.13.13.2.1.1.1.2.1.1.1.2" xref="S2.E1.m1.13.13.2.1.1.1.2.1.1.1.2.cmml">a</mi><mo id="S2.E1.m1.13.13.2.1.1.1.2.1.1.1.3" xref="S2.E1.m1.13.13.2.1.1.1.2.1.1.1.3.cmml">−</mo></msup><mo id="S2.E1.m1.13.13.2.1.1.1.2.1.1.4" stretchy="false" xref="S2.E1.m1.13.13.2.1.1.1.2.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E1.m1.13.13.2.1.1.3" maxsize="120%" minsize="120%" xref="S2.E1.m1.13.13.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E1.m1.13b"><apply id="S2.E1.m1.13.13.cmml" xref="S2.E1.m1.13.13"><and id="S2.E1.m1.13.13a.cmml" xref="S2.E1.m1.13.13"></and><apply id="S2.E1.m1.13.13b.cmml" xref="S2.E1.m1.13.13"><eq id="S2.E1.m1.13.13.4.cmml" xref="S2.E1.m1.13.13.4"></eq><apply id="S2.E1.m1.12.12.1.cmml" xref="S2.E1.m1.12.12.1"><times id="S2.E1.m1.12.12.1.2.cmml" xref="S2.E1.m1.12.12.1.2"></times><ci id="S2.E1.m1.12.12.1.3.cmml" xref="S2.E1.m1.12.12.1.3">𝑃</ci><apply id="S2.E1.m1.12.12.1.1.1.1.cmml" xref="S2.E1.m1.12.12.1.1.1"><csymbol cd="latexml" id="S2.E1.m1.12.12.1.1.1.1.1.cmml" xref="S2.E1.m1.12.12.1.1.1.1.1">succeeds</csymbol><apply id="S2.E1.m1.12.12.1.1.1.1.2.cmml" xref="S2.E1.m1.12.12.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E1.m1.12.12.1.1.1.1.2.1.cmml" xref="S2.E1.m1.12.12.1.1.1.1.2">superscript</csymbol><ci id="S2.E1.m1.12.12.1.1.1.1.2.2.cmml" xref="S2.E1.m1.12.12.1.1.1.1.2.2">𝑎</ci><plus id="S2.E1.m1.12.12.1.1.1.1.2.3.cmml" xref="S2.E1.m1.12.12.1.1.1.1.2.3"></plus></apply><apply id="S2.E1.m1.12.12.1.1.1.1.3.cmml" xref="S2.E1.m1.12.12.1.1.1.1.3"><csymbol cd="latexml" id="S2.E1.m1.12.12.1.1.1.1.3.1.cmml" xref="S2.E1.m1.12.12.1.1.1.1.3.1">conditional</csymbol><apply id="S2.E1.m1.12.12.1.1.1.1.3.2.cmml" xref="S2.E1.m1.12.12.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S2.E1.m1.12.12.1.1.1.1.3.2.1.cmml" xref="S2.E1.m1.12.12.1.1.1.1.3.2">superscript</csymbol><ci id="S2.E1.m1.12.12.1.1.1.1.3.2.2.cmml" xref="S2.E1.m1.12.12.1.1.1.1.3.2.2">𝑎</ci><minus id="S2.E1.m1.12.12.1.1.1.1.3.2.3.cmml" xref="S2.E1.m1.12.12.1.1.1.1.3.2.3"></minus></apply><ci id="S2.E1.m1.12.12.1.1.1.1.3.3.cmml" xref="S2.E1.m1.12.12.1.1.1.1.3.3">𝑞</ci></apply></apply></apply><apply id="S2.E1.m1.9.9.cmml" xref="S2.E1.m1.9.9"><divide id="S2.E1.m1.9.9.10.cmml" xref="S2.E1.m1.9.9"></divide><apply id="S2.E1.m1.3.3.3.4.cmml" xref="S2.E1.m1.3.3.3.3"><exp id="S2.E1.m1.2.2.2.2.cmml" xref="S2.E1.m1.2.2.2.2"></exp><apply id="S2.E1.m1.3.3.3.3.1.1.cmml" xref="S2.E1.m1.3.3.3.3.1.1"><times id="S2.E1.m1.3.3.3.3.1.1.2.cmml" xref="S2.E1.m1.3.3.3.3.1.1.2"></times><ci id="S2.E1.m1.3.3.3.3.1.1.3.cmml" xref="S2.E1.m1.3.3.3.3.1.1.3">𝑟</ci><interval closure="open" id="S2.E1.m1.3.3.3.3.1.1.1.2.cmml" xref="S2.E1.m1.3.3.3.3.1.1.1.1"><ci id="S2.E1.m1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1.1">𝑞</ci><apply id="S2.E1.m1.3.3.3.3.1.1.1.1.1.cmml" xref="S2.E1.m1.3.3.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.3.3.3.3.1.1.1.1.1.1.cmml" xref="S2.E1.m1.3.3.3.3.1.1.1.1.1">superscript</csymbol><ci id="S2.E1.m1.3.3.3.3.1.1.1.1.1.2.cmml" xref="S2.E1.m1.3.3.3.3.1.1.1.1.1.2">𝑎</ci><plus id="S2.E1.m1.3.3.3.3.1.1.1.1.1.3.cmml" xref="S2.E1.m1.3.3.3.3.1.1.1.1.1.3"></plus></apply></interval></apply></apply><apply id="S2.E1.m1.9.9.9.cmml" xref="S2.E1.m1.9.9.9"><plus id="S2.E1.m1.9.9.9.7.cmml" xref="S2.E1.m1.9.9.9.7"></plus><apply id="S2.E1.m1.8.8.8.5.2.cmml" xref="S2.E1.m1.8.8.8.5.1"><exp id="S2.E1.m1.5.5.5.2.cmml" xref="S2.E1.m1.5.5.5.2"></exp><apply id="S2.E1.m1.8.8.8.5.1.1.1.cmml" xref="S2.E1.m1.8.8.8.5.1.1.1"><times id="S2.E1.m1.8.8.8.5.1.1.1.2.cmml" xref="S2.E1.m1.8.8.8.5.1.1.1.2"></times><ci id="S2.E1.m1.8.8.8.5.1.1.1.3.cmml" xref="S2.E1.m1.8.8.8.5.1.1.1.3">𝑟</ci><interval closure="open" id="S2.E1.m1.8.8.8.5.1.1.1.1.2.cmml" xref="S2.E1.m1.8.8.8.5.1.1.1.1.1"><ci id="S2.E1.m1.4.4.4.1.cmml" xref="S2.E1.m1.4.4.4.1">𝑞</ci><apply id="S2.E1.m1.8.8.8.5.1.1.1.1.1.1.cmml" xref="S2.E1.m1.8.8.8.5.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.8.8.8.5.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.8.8.8.5.1.1.1.1.1.1">superscript</csymbol><ci id="S2.E1.m1.8.8.8.5.1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.8.8.8.5.1.1.1.1.1.1.2">𝑎</ci><plus id="S2.E1.m1.8.8.8.5.1.1.1.1.1.1.3.cmml" xref="S2.E1.m1.8.8.8.5.1.1.1.1.1.1.3"></plus></apply></interval></apply></apply><apply id="S2.E1.m1.9.9.9.6.2.cmml" xref="S2.E1.m1.9.9.9.6.1"><exp id="S2.E1.m1.7.7.7.4.cmml" xref="S2.E1.m1.7.7.7.4"></exp><apply id="S2.E1.m1.9.9.9.6.1.1.1.cmml" xref="S2.E1.m1.9.9.9.6.1.1.1"><times id="S2.E1.m1.9.9.9.6.1.1.1.2.cmml" xref="S2.E1.m1.9.9.9.6.1.1.1.2"></times><ci id="S2.E1.m1.9.9.9.6.1.1.1.3.cmml" xref="S2.E1.m1.9.9.9.6.1.1.1.3">𝑟</ci><interval closure="open" id="S2.E1.m1.9.9.9.6.1.1.1.1.2.cmml" xref="S2.E1.m1.9.9.9.6.1.1.1.1.1"><ci id="S2.E1.m1.6.6.6.3.cmml" xref="S2.E1.m1.6.6.6.3">𝑞</ci><apply id="S2.E1.m1.9.9.9.6.1.1.1.1.1.1.cmml" xref="S2.E1.m1.9.9.9.6.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.9.9.9.6.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.9.9.9.6.1.1.1.1.1.1">superscript</csymbol><ci id="S2.E1.m1.9.9.9.6.1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.9.9.9.6.1.1.1.1.1.1.2">𝑎</ci><minus id="S2.E1.m1.9.9.9.6.1.1.1.1.1.1.3.cmml" xref="S2.E1.m1.9.9.9.6.1.1.1.1.1.1.3"></minus></apply></interval></apply></apply></apply></apply></apply><apply id="S2.E1.m1.13.13c.cmml" xref="S2.E1.m1.13.13"><eq id="S2.E1.m1.13.13.5.cmml" xref="S2.E1.m1.13.13.5"></eq><share href="https://arxiv.org/html/2410.03742v1#S2.E1.m1.9.9.cmml" id="S2.E1.m1.13.13d.cmml" xref="S2.E1.m1.13.13"></share><apply id="S2.E1.m1.13.13.2.cmml" xref="S2.E1.m1.13.13.2"><times id="S2.E1.m1.13.13.2.2.cmml" xref="S2.E1.m1.13.13.2.2"></times><ci id="S2.E1.m1.13.13.2.3.cmml" xref="S2.E1.m1.13.13.2.3">𝜎</ci><apply id="S2.E1.m1.13.13.2.1.1.1.cmml" xref="S2.E1.m1.13.13.2.1.1"><minus id="S2.E1.m1.13.13.2.1.1.1.3.cmml" xref="S2.E1.m1.13.13.2.1.1.1.3"></minus><apply id="S2.E1.m1.13.13.2.1.1.1.1.cmml" xref="S2.E1.m1.13.13.2.1.1.1.1"><times id="S2.E1.m1.13.13.2.1.1.1.1.2.cmml" xref="S2.E1.m1.13.13.2.1.1.1.1.2"></times><ci id="S2.E1.m1.13.13.2.1.1.1.1.3.cmml" xref="S2.E1.m1.13.13.2.1.1.1.1.3">𝑟</ci><interval closure="open" id="S2.E1.m1.13.13.2.1.1.1.1.1.2.cmml" xref="S2.E1.m1.13.13.2.1.1.1.1.1.1"><ci id="S2.E1.m1.10.10.cmml" xref="S2.E1.m1.10.10">𝑞</ci><apply id="S2.E1.m1.13.13.2.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.13.13.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.13.13.2.1.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.13.13.2.1.1.1.1.1.1.1">superscript</csymbol><ci id="S2.E1.m1.13.13.2.1.1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.13.13.2.1.1.1.1.1.1.1.2">𝑎</ci><plus id="S2.E1.m1.13.13.2.1.1.1.1.1.1.1.3.cmml" xref="S2.E1.m1.13.13.2.1.1.1.1.1.1.1.3"></plus></apply></interval></apply><apply id="S2.E1.m1.13.13.2.1.1.1.2.cmml" xref="S2.E1.m1.13.13.2.1.1.1.2"><times id="S2.E1.m1.13.13.2.1.1.1.2.2.cmml" xref="S2.E1.m1.13.13.2.1.1.1.2.2"></times><ci id="S2.E1.m1.13.13.2.1.1.1.2.3.cmml" xref="S2.E1.m1.13.13.2.1.1.1.2.3">𝑟</ci><interval closure="open" id="S2.E1.m1.13.13.2.1.1.1.2.1.2.cmml" xref="S2.E1.m1.13.13.2.1.1.1.2.1.1"><ci id="S2.E1.m1.11.11.cmml" xref="S2.E1.m1.11.11">𝑞</ci><apply id="S2.E1.m1.13.13.2.1.1.1.2.1.1.1.cmml" xref="S2.E1.m1.13.13.2.1.1.1.2.1.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.13.13.2.1.1.1.2.1.1.1.1.cmml" xref="S2.E1.m1.13.13.2.1.1.1.2.1.1.1">superscript</csymbol><ci id="S2.E1.m1.13.13.2.1.1.1.2.1.1.1.2.cmml" xref="S2.E1.m1.13.13.2.1.1.1.2.1.1.1.2">𝑎</ci><minus id="S2.E1.m1.13.13.2.1.1.1.2.1.1.1.3.cmml" xref="S2.E1.m1.13.13.2.1.1.1.2.1.1.1.3"></minus></apply></interval></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1.m1.13c">P(a^{+}\succ a^{-}|q)=\frac{\exp(r(q,a^{+}))}{\exp(r(q,a^{+}))+\exp(r(q,a^{-})%
)}=\sigma\big{(}r(q,a^{+})-r(q,a^{-})\big{)}</annotation><annotation encoding="application/x-llamapun" id="S2.E1.m1.13d">italic_P ( italic_a start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT ≻ italic_a start_POSTSUPERSCRIPT - end_POSTSUPERSCRIPT | italic_q ) = divide start_ARG roman_exp ( italic_r ( italic_q , italic_a start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT ) ) end_ARG start_ARG roman_exp ( italic_r ( italic_q , italic_a start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT ) ) + roman_exp ( italic_r ( italic_q , italic_a start_POSTSUPERSCRIPT - end_POSTSUPERSCRIPT ) ) end_ARG = italic_σ ( italic_r ( italic_q , italic_a start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT ) - italic_r ( italic_q , italic_a start_POSTSUPERSCRIPT - end_POSTSUPERSCRIPT ) )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS2.p1.6">where <math alttext="\sigma" class="ltx_Math" display="inline" id="S2.SS2.p1.6.m1.1"><semantics id="S2.SS2.p1.6.m1.1a"><mi id="S2.SS2.p1.6.m1.1.1" xref="S2.SS2.p1.6.m1.1.1.cmml">σ</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.6.m1.1b"><ci id="S2.SS2.p1.6.m1.1.1.cmml" xref="S2.SS2.p1.6.m1.1.1">𝜎</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.6.m1.1c">\sigma</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.6.m1.1d">italic_σ</annotation></semantics></math> is the sigmoid function.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS2.p2">
<p class="ltx_p" id="S2.SS2.p2.4">The above-mentioned SM utilizes the prompt <math alttext="q" class="ltx_Math" display="inline" id="S2.SS2.p2.1.m1.1"><semantics id="S2.SS2.p2.1.m1.1a"><mi id="S2.SS2.p2.1.m1.1.1" xref="S2.SS2.p2.1.m1.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.1.m1.1b"><ci id="S2.SS2.p2.1.m1.1.1.cmml" xref="S2.SS2.p2.1.m1.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.1.m1.1c">q</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.1.m1.1d">italic_q</annotation></semantics></math> and a single answer <math alttext="a" class="ltx_Math" display="inline" id="S2.SS2.p2.2.m2.1"><semantics id="S2.SS2.p2.2.m2.1a"><mi id="S2.SS2.p2.2.m2.1.1" xref="S2.SS2.p2.2.m2.1.1.cmml">a</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.2.m2.1b"><ci id="S2.SS2.p2.2.m2.1.1.cmml" xref="S2.SS2.p2.2.m2.1.1">𝑎</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.2.m2.1c">a</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.2.m2.1d">italic_a</annotation></semantics></math> as input, which we denote as a pointwise SM.
In addition, existing research has investigated a pairwise variant that uses a pair of candidates as input, i.e., <math alttext="r(q,a^{1},a^{2})" class="ltx_Math" display="inline" id="S2.SS2.p2.3.m3.3"><semantics id="S2.SS2.p2.3.m3.3a"><mrow id="S2.SS2.p2.3.m3.3.3" xref="S2.SS2.p2.3.m3.3.3.cmml"><mi id="S2.SS2.p2.3.m3.3.3.4" xref="S2.SS2.p2.3.m3.3.3.4.cmml">r</mi><mo id="S2.SS2.p2.3.m3.3.3.3" xref="S2.SS2.p2.3.m3.3.3.3.cmml">⁢</mo><mrow id="S2.SS2.p2.3.m3.3.3.2.2" xref="S2.SS2.p2.3.m3.3.3.2.3.cmml"><mo id="S2.SS2.p2.3.m3.3.3.2.2.3" stretchy="false" xref="S2.SS2.p2.3.m3.3.3.2.3.cmml">(</mo><mi id="S2.SS2.p2.3.m3.1.1" xref="S2.SS2.p2.3.m3.1.1.cmml">q</mi><mo id="S2.SS2.p2.3.m3.3.3.2.2.4" xref="S2.SS2.p2.3.m3.3.3.2.3.cmml">,</mo><msup id="S2.SS2.p2.3.m3.2.2.1.1.1" xref="S2.SS2.p2.3.m3.2.2.1.1.1.cmml"><mi id="S2.SS2.p2.3.m3.2.2.1.1.1.2" xref="S2.SS2.p2.3.m3.2.2.1.1.1.2.cmml">a</mi><mn id="S2.SS2.p2.3.m3.2.2.1.1.1.3" xref="S2.SS2.p2.3.m3.2.2.1.1.1.3.cmml">1</mn></msup><mo id="S2.SS2.p2.3.m3.3.3.2.2.5" xref="S2.SS2.p2.3.m3.3.3.2.3.cmml">,</mo><msup id="S2.SS2.p2.3.m3.3.3.2.2.2" xref="S2.SS2.p2.3.m3.3.3.2.2.2.cmml"><mi id="S2.SS2.p2.3.m3.3.3.2.2.2.2" xref="S2.SS2.p2.3.m3.3.3.2.2.2.2.cmml">a</mi><mn id="S2.SS2.p2.3.m3.3.3.2.2.2.3" xref="S2.SS2.p2.3.m3.3.3.2.2.2.3.cmml">2</mn></msup><mo id="S2.SS2.p2.3.m3.3.3.2.2.6" stretchy="false" xref="S2.SS2.p2.3.m3.3.3.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.3.m3.3b"><apply id="S2.SS2.p2.3.m3.3.3.cmml" xref="S2.SS2.p2.3.m3.3.3"><times id="S2.SS2.p2.3.m3.3.3.3.cmml" xref="S2.SS2.p2.3.m3.3.3.3"></times><ci id="S2.SS2.p2.3.m3.3.3.4.cmml" xref="S2.SS2.p2.3.m3.3.3.4">𝑟</ci><vector id="S2.SS2.p2.3.m3.3.3.2.3.cmml" xref="S2.SS2.p2.3.m3.3.3.2.2"><ci id="S2.SS2.p2.3.m3.1.1.cmml" xref="S2.SS2.p2.3.m3.1.1">𝑞</ci><apply id="S2.SS2.p2.3.m3.2.2.1.1.1.cmml" xref="S2.SS2.p2.3.m3.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.3.m3.2.2.1.1.1.1.cmml" xref="S2.SS2.p2.3.m3.2.2.1.1.1">superscript</csymbol><ci id="S2.SS2.p2.3.m3.2.2.1.1.1.2.cmml" xref="S2.SS2.p2.3.m3.2.2.1.1.1.2">𝑎</ci><cn id="S2.SS2.p2.3.m3.2.2.1.1.1.3.cmml" type="integer" xref="S2.SS2.p2.3.m3.2.2.1.1.1.3">1</cn></apply><apply id="S2.SS2.p2.3.m3.3.3.2.2.2.cmml" xref="S2.SS2.p2.3.m3.3.3.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.p2.3.m3.3.3.2.2.2.1.cmml" xref="S2.SS2.p2.3.m3.3.3.2.2.2">superscript</csymbol><ci id="S2.SS2.p2.3.m3.3.3.2.2.2.2.cmml" xref="S2.SS2.p2.3.m3.3.3.2.2.2.2">𝑎</ci><cn id="S2.SS2.p2.3.m3.3.3.2.2.2.3.cmml" type="integer" xref="S2.SS2.p2.3.m3.3.3.2.2.2.3">2</cn></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.3.m3.3c">r(q,a^{1},a^{2})</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.3.m3.3d">italic_r ( italic_q , italic_a start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT , italic_a start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT )</annotation></semantics></math> <cite class="ltx_cite ltx_citemacro_citep">(Jiang et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03742v1#bib.bib15" title="">2023</a>)</cite>.
The pairwise vanilla reward formalizes the preference probability of <math alttext="a^{+}" class="ltx_Math" display="inline" id="S2.SS2.p2.4.m4.1"><semantics id="S2.SS2.p2.4.m4.1a"><msup id="S2.SS2.p2.4.m4.1.1" xref="S2.SS2.p2.4.m4.1.1.cmml"><mi id="S2.SS2.p2.4.m4.1.1.2" xref="S2.SS2.p2.4.m4.1.1.2.cmml">a</mi><mo id="S2.SS2.p2.4.m4.1.1.3" xref="S2.SS2.p2.4.m4.1.1.3.cmml">+</mo></msup><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.4.m4.1b"><apply id="S2.SS2.p2.4.m4.1.1.cmml" xref="S2.SS2.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.4.m4.1.1.1.cmml" xref="S2.SS2.p2.4.m4.1.1">superscript</csymbol><ci id="S2.SS2.p2.4.m4.1.1.2.cmml" xref="S2.SS2.p2.4.m4.1.1.2">𝑎</ci><plus id="S2.SS2.p2.4.m4.1.1.3.cmml" xref="S2.SS2.p2.4.m4.1.1.3"></plus></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.4.m4.1c">a^{+}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.4.m4.1d">italic_a start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT</annotation></semantics></math> as:</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS2.p3">
<table class="ltx_equation ltx_eqn_table" id="S2.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="P(a^{+}\succ a^{-}|q)=\sigma(r(q,a^{+},a^{-}))." class="ltx_Math" display="block" id="S2.E2.m1.2"><semantics id="S2.E2.m1.2a"><mrow id="S2.E2.m1.2.2.1" xref="S2.E2.m1.2.2.1.1.cmml"><mrow id="S2.E2.m1.2.2.1.1" xref="S2.E2.m1.2.2.1.1.cmml"><mrow id="S2.E2.m1.2.2.1.1.1" xref="S2.E2.m1.2.2.1.1.1.cmml"><mi id="S2.E2.m1.2.2.1.1.1.3" xref="S2.E2.m1.2.2.1.1.1.3.cmml">P</mi><mo id="S2.E2.m1.2.2.1.1.1.2" xref="S2.E2.m1.2.2.1.1.1.2.cmml">⁢</mo><mrow id="S2.E2.m1.2.2.1.1.1.1.1" xref="S2.E2.m1.2.2.1.1.1.1.1.1.cmml"><mo id="S2.E2.m1.2.2.1.1.1.1.1.2" stretchy="false" xref="S2.E2.m1.2.2.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E2.m1.2.2.1.1.1.1.1.1" xref="S2.E2.m1.2.2.1.1.1.1.1.1.cmml"><msup id="S2.E2.m1.2.2.1.1.1.1.1.1.2" xref="S2.E2.m1.2.2.1.1.1.1.1.1.2.cmml"><mi id="S2.E2.m1.2.2.1.1.1.1.1.1.2.2" xref="S2.E2.m1.2.2.1.1.1.1.1.1.2.2.cmml">a</mi><mo id="S2.E2.m1.2.2.1.1.1.1.1.1.2.3" xref="S2.E2.m1.2.2.1.1.1.1.1.1.2.3.cmml">+</mo></msup><mo id="S2.E2.m1.2.2.1.1.1.1.1.1.1" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1.cmml">≻</mo><mrow id="S2.E2.m1.2.2.1.1.1.1.1.1.3" xref="S2.E2.m1.2.2.1.1.1.1.1.1.3.cmml"><msup id="S2.E2.m1.2.2.1.1.1.1.1.1.3.2" xref="S2.E2.m1.2.2.1.1.1.1.1.1.3.2.cmml"><mi id="S2.E2.m1.2.2.1.1.1.1.1.1.3.2.2" xref="S2.E2.m1.2.2.1.1.1.1.1.1.3.2.2.cmml">a</mi><mo id="S2.E2.m1.2.2.1.1.1.1.1.1.3.2.3" xref="S2.E2.m1.2.2.1.1.1.1.1.1.3.2.3.cmml">−</mo></msup><mo fence="false" id="S2.E2.m1.2.2.1.1.1.1.1.1.3.1" xref="S2.E2.m1.2.2.1.1.1.1.1.1.3.1.cmml">|</mo><mi id="S2.E2.m1.2.2.1.1.1.1.1.1.3.3" xref="S2.E2.m1.2.2.1.1.1.1.1.1.3.3.cmml">q</mi></mrow></mrow><mo id="S2.E2.m1.2.2.1.1.1.1.1.3" stretchy="false" xref="S2.E2.m1.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E2.m1.2.2.1.1.3" xref="S2.E2.m1.2.2.1.1.3.cmml">=</mo><mrow id="S2.E2.m1.2.2.1.1.2" xref="S2.E2.m1.2.2.1.1.2.cmml"><mi id="S2.E2.m1.2.2.1.1.2.3" xref="S2.E2.m1.2.2.1.1.2.3.cmml">σ</mi><mo id="S2.E2.m1.2.2.1.1.2.2" xref="S2.E2.m1.2.2.1.1.2.2.cmml">⁢</mo><mrow id="S2.E2.m1.2.2.1.1.2.1.1" xref="S2.E2.m1.2.2.1.1.2.1.1.1.cmml"><mo id="S2.E2.m1.2.2.1.1.2.1.1.2" stretchy="false" xref="S2.E2.m1.2.2.1.1.2.1.1.1.cmml">(</mo><mrow id="S2.E2.m1.2.2.1.1.2.1.1.1" xref="S2.E2.m1.2.2.1.1.2.1.1.1.cmml"><mi id="S2.E2.m1.2.2.1.1.2.1.1.1.4" xref="S2.E2.m1.2.2.1.1.2.1.1.1.4.cmml">r</mi><mo id="S2.E2.m1.2.2.1.1.2.1.1.1.3" xref="S2.E2.m1.2.2.1.1.2.1.1.1.3.cmml">⁢</mo><mrow id="S2.E2.m1.2.2.1.1.2.1.1.1.2.2" xref="S2.E2.m1.2.2.1.1.2.1.1.1.2.3.cmml"><mo id="S2.E2.m1.2.2.1.1.2.1.1.1.2.2.3" stretchy="false" xref="S2.E2.m1.2.2.1.1.2.1.1.1.2.3.cmml">(</mo><mi id="S2.E2.m1.1.1" xref="S2.E2.m1.1.1.cmml">q</mi><mo id="S2.E2.m1.2.2.1.1.2.1.1.1.2.2.4" xref="S2.E2.m1.2.2.1.1.2.1.1.1.2.3.cmml">,</mo><msup id="S2.E2.m1.2.2.1.1.2.1.1.1.1.1.1" xref="S2.E2.m1.2.2.1.1.2.1.1.1.1.1.1.cmml"><mi id="S2.E2.m1.2.2.1.1.2.1.1.1.1.1.1.2" xref="S2.E2.m1.2.2.1.1.2.1.1.1.1.1.1.2.cmml">a</mi><mo id="S2.E2.m1.2.2.1.1.2.1.1.1.1.1.1.3" xref="S2.E2.m1.2.2.1.1.2.1.1.1.1.1.1.3.cmml">+</mo></msup><mo id="S2.E2.m1.2.2.1.1.2.1.1.1.2.2.5" xref="S2.E2.m1.2.2.1.1.2.1.1.1.2.3.cmml">,</mo><msup id="S2.E2.m1.2.2.1.1.2.1.1.1.2.2.2" xref="S2.E2.m1.2.2.1.1.2.1.1.1.2.2.2.cmml"><mi id="S2.E2.m1.2.2.1.1.2.1.1.1.2.2.2.2" xref="S2.E2.m1.2.2.1.1.2.1.1.1.2.2.2.2.cmml">a</mi><mo id="S2.E2.m1.2.2.1.1.2.1.1.1.2.2.2.3" xref="S2.E2.m1.2.2.1.1.2.1.1.1.2.2.2.3.cmml">−</mo></msup><mo id="S2.E2.m1.2.2.1.1.2.1.1.1.2.2.6" stretchy="false" xref="S2.E2.m1.2.2.1.1.2.1.1.1.2.3.cmml">)</mo></mrow></mrow><mo id="S2.E2.m1.2.2.1.1.2.1.1.3" stretchy="false" xref="S2.E2.m1.2.2.1.1.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E2.m1.2.2.1.2" lspace="0em" xref="S2.E2.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E2.m1.2b"><apply id="S2.E2.m1.2.2.1.1.cmml" xref="S2.E2.m1.2.2.1"><eq id="S2.E2.m1.2.2.1.1.3.cmml" xref="S2.E2.m1.2.2.1.1.3"></eq><apply id="S2.E2.m1.2.2.1.1.1.cmml" xref="S2.E2.m1.2.2.1.1.1"><times id="S2.E2.m1.2.2.1.1.1.2.cmml" xref="S2.E2.m1.2.2.1.1.1.2"></times><ci id="S2.E2.m1.2.2.1.1.1.3.cmml" xref="S2.E2.m1.2.2.1.1.1.3">𝑃</ci><apply id="S2.E2.m1.2.2.1.1.1.1.1.1.cmml" xref="S2.E2.m1.2.2.1.1.1.1.1"><csymbol cd="latexml" id="S2.E2.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1">succeeds</csymbol><apply id="S2.E2.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.2.2.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E2.m1.2.2.1.1.1.1.1.1.2.1.cmml" xref="S2.E2.m1.2.2.1.1.1.1.1.1.2">superscript</csymbol><ci id="S2.E2.m1.2.2.1.1.1.1.1.1.2.2.cmml" xref="S2.E2.m1.2.2.1.1.1.1.1.1.2.2">𝑎</ci><plus id="S2.E2.m1.2.2.1.1.1.1.1.1.2.3.cmml" xref="S2.E2.m1.2.2.1.1.1.1.1.1.2.3"></plus></apply><apply id="S2.E2.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S2.E2.m1.2.2.1.1.1.1.1.1.3"><csymbol cd="latexml" id="S2.E2.m1.2.2.1.1.1.1.1.1.3.1.cmml" xref="S2.E2.m1.2.2.1.1.1.1.1.1.3.1">conditional</csymbol><apply id="S2.E2.m1.2.2.1.1.1.1.1.1.3.2.cmml" xref="S2.E2.m1.2.2.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S2.E2.m1.2.2.1.1.1.1.1.1.3.2.1.cmml" xref="S2.E2.m1.2.2.1.1.1.1.1.1.3.2">superscript</csymbol><ci id="S2.E2.m1.2.2.1.1.1.1.1.1.3.2.2.cmml" xref="S2.E2.m1.2.2.1.1.1.1.1.1.3.2.2">𝑎</ci><minus id="S2.E2.m1.2.2.1.1.1.1.1.1.3.2.3.cmml" xref="S2.E2.m1.2.2.1.1.1.1.1.1.3.2.3"></minus></apply><ci id="S2.E2.m1.2.2.1.1.1.1.1.1.3.3.cmml" xref="S2.E2.m1.2.2.1.1.1.1.1.1.3.3">𝑞</ci></apply></apply></apply><apply id="S2.E2.m1.2.2.1.1.2.cmml" xref="S2.E2.m1.2.2.1.1.2"><times id="S2.E2.m1.2.2.1.1.2.2.cmml" xref="S2.E2.m1.2.2.1.1.2.2"></times><ci id="S2.E2.m1.2.2.1.1.2.3.cmml" xref="S2.E2.m1.2.2.1.1.2.3">𝜎</ci><apply id="S2.E2.m1.2.2.1.1.2.1.1.1.cmml" xref="S2.E2.m1.2.2.1.1.2.1.1"><times id="S2.E2.m1.2.2.1.1.2.1.1.1.3.cmml" xref="S2.E2.m1.2.2.1.1.2.1.1.1.3"></times><ci id="S2.E2.m1.2.2.1.1.2.1.1.1.4.cmml" xref="S2.E2.m1.2.2.1.1.2.1.1.1.4">𝑟</ci><vector id="S2.E2.m1.2.2.1.1.2.1.1.1.2.3.cmml" xref="S2.E2.m1.2.2.1.1.2.1.1.1.2.2"><ci id="S2.E2.m1.1.1.cmml" xref="S2.E2.m1.1.1">𝑞</ci><apply id="S2.E2.m1.2.2.1.1.2.1.1.1.1.1.1.cmml" xref="S2.E2.m1.2.2.1.1.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.2.2.1.1.2.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.2.2.1.1.2.1.1.1.1.1.1">superscript</csymbol><ci id="S2.E2.m1.2.2.1.1.2.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.2.2.1.1.2.1.1.1.1.1.1.2">𝑎</ci><plus id="S2.E2.m1.2.2.1.1.2.1.1.1.1.1.1.3.cmml" xref="S2.E2.m1.2.2.1.1.2.1.1.1.1.1.1.3"></plus></apply><apply id="S2.E2.m1.2.2.1.1.2.1.1.1.2.2.2.cmml" xref="S2.E2.m1.2.2.1.1.2.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S2.E2.m1.2.2.1.1.2.1.1.1.2.2.2.1.cmml" xref="S2.E2.m1.2.2.1.1.2.1.1.1.2.2.2">superscript</csymbol><ci id="S2.E2.m1.2.2.1.1.2.1.1.1.2.2.2.2.cmml" xref="S2.E2.m1.2.2.1.1.2.1.1.1.2.2.2.2">𝑎</ci><minus id="S2.E2.m1.2.2.1.1.2.1.1.1.2.2.2.3.cmml" xref="S2.E2.m1.2.2.1.1.2.1.1.1.2.2.2.3"></minus></apply></vector></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2.m1.2c">P(a^{+}\succ a^{-}|q)=\sigma(r(q,a^{+},a^{-})).</annotation><annotation encoding="application/x-llamapun" id="S2.E2.m1.2d">italic_P ( italic_a start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT ≻ italic_a start_POSTSUPERSCRIPT - end_POSTSUPERSCRIPT | italic_q ) = italic_σ ( italic_r ( italic_q , italic_a start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT , italic_a start_POSTSUPERSCRIPT - end_POSTSUPERSCRIPT ) ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS2.p4">
<p class="ltx_p" id="S2.SS2.p4.1">To train the above-mentioned pointwise and pairwise SM <math alttext="r" class="ltx_Math" display="inline" id="S2.SS2.p4.1.m1.1"><semantics id="S2.SS2.p4.1.m1.1a"><mi id="S2.SS2.p4.1.m1.1.1" xref="S2.SS2.p4.1.m1.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p4.1.m1.1b"><ci id="S2.SS2.p4.1.m1.1.1.cmml" xref="S2.SS2.p4.1.m1.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p4.1.m1.1c">r</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p4.1.m1.1d">italic_r</annotation></semantics></math>, we maximize the log-likelihood of the preferences by minimizing the following loss function:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\ell_{R}(r)=-\sum_{(x,a^{+},a^{-})}\log p_{r}(a^{+}\succ a^{-}\mid x)=\begin{%
cases}-\sum_{(x,a^{+},a^{-})}\log\sigma(r(x,a^{+})-r(x,a^{-}))&amp;\text{(%
pointwise)}\\
-\sum_{(x,a^{+},a^{-})}\log\sigma(r(x,a^{+},a^{-}))&amp;\text{(pairwise)}\end{cases}" class="ltx_Math" display="block" id="S2.E3.m1.9"><semantics id="S2.E3.m1.9a"><mrow id="S2.E3.m1.9.9" xref="S2.E3.m1.9.9.cmml"><mrow id="S2.E3.m1.9.9.3" xref="S2.E3.m1.9.9.3.cmml"><msub id="S2.E3.m1.9.9.3.2" xref="S2.E3.m1.9.9.3.2.cmml"><mi id="S2.E3.m1.9.9.3.2.2" mathvariant="normal" xref="S2.E3.m1.9.9.3.2.2.cmml">ℓ</mi><mi id="S2.E3.m1.9.9.3.2.3" xref="S2.E3.m1.9.9.3.2.3.cmml">R</mi></msub><mo id="S2.E3.m1.9.9.3.1" xref="S2.E3.m1.9.9.3.1.cmml">⁢</mo><mrow id="S2.E3.m1.9.9.3.3.2" xref="S2.E3.m1.9.9.3.cmml"><mo id="S2.E3.m1.9.9.3.3.2.1" stretchy="false" xref="S2.E3.m1.9.9.3.cmml">(</mo><mi id="S2.E3.m1.8.8" xref="S2.E3.m1.8.8.cmml">r</mi><mo id="S2.E3.m1.9.9.3.3.2.2" stretchy="false" xref="S2.E3.m1.9.9.3.cmml">)</mo></mrow></mrow><mo id="S2.E3.m1.9.9.4" xref="S2.E3.m1.9.9.4.cmml">=</mo><mrow id="S2.E3.m1.9.9.1" xref="S2.E3.m1.9.9.1.cmml"><mo id="S2.E3.m1.9.9.1a" xref="S2.E3.m1.9.9.1.cmml">−</mo><mrow id="S2.E3.m1.9.9.1.1" xref="S2.E3.m1.9.9.1.1.cmml"><munder id="S2.E3.m1.9.9.1.1.2" xref="S2.E3.m1.9.9.1.1.2.cmml"><mo id="S2.E3.m1.9.9.1.1.2.2" movablelimits="false" xref="S2.E3.m1.9.9.1.1.2.2.cmml">∑</mo><mrow id="S2.E3.m1.7.7.3.3" xref="S2.E3.m1.7.7.3.4.cmml"><mo id="S2.E3.m1.7.7.3.3.3" stretchy="false" xref="S2.E3.m1.7.7.3.4.cmml">(</mo><mi id="S2.E3.m1.5.5.1.1" xref="S2.E3.m1.5.5.1.1.cmml">x</mi><mo id="S2.E3.m1.7.7.3.3.4" xref="S2.E3.m1.7.7.3.4.cmml">,</mo><msup id="S2.E3.m1.6.6.2.2.1" xref="S2.E3.m1.6.6.2.2.1.cmml"><mi id="S2.E3.m1.6.6.2.2.1.2" xref="S2.E3.m1.6.6.2.2.1.2.cmml">a</mi><mo id="S2.E3.m1.6.6.2.2.1.3" xref="S2.E3.m1.6.6.2.2.1.3.cmml">+</mo></msup><mo id="S2.E3.m1.7.7.3.3.5" xref="S2.E3.m1.7.7.3.4.cmml">,</mo><msup id="S2.E3.m1.7.7.3.3.2" xref="S2.E3.m1.7.7.3.3.2.cmml"><mi id="S2.E3.m1.7.7.3.3.2.2" xref="S2.E3.m1.7.7.3.3.2.2.cmml">a</mi><mo id="S2.E3.m1.7.7.3.3.2.3" xref="S2.E3.m1.7.7.3.3.2.3.cmml">−</mo></msup><mo id="S2.E3.m1.7.7.3.3.6" stretchy="false" xref="S2.E3.m1.7.7.3.4.cmml">)</mo></mrow></munder><mrow id="S2.E3.m1.9.9.1.1.1" xref="S2.E3.m1.9.9.1.1.1.cmml"><mrow id="S2.E3.m1.9.9.1.1.1.3" xref="S2.E3.m1.9.9.1.1.1.3.cmml"><mi id="S2.E3.m1.9.9.1.1.1.3.1" xref="S2.E3.m1.9.9.1.1.1.3.1.cmml">log</mi><mo id="S2.E3.m1.9.9.1.1.1.3a" lspace="0.167em" xref="S2.E3.m1.9.9.1.1.1.3.cmml">⁡</mo><msub id="S2.E3.m1.9.9.1.1.1.3.2" xref="S2.E3.m1.9.9.1.1.1.3.2.cmml"><mi id="S2.E3.m1.9.9.1.1.1.3.2.2" xref="S2.E3.m1.9.9.1.1.1.3.2.2.cmml">p</mi><mi id="S2.E3.m1.9.9.1.1.1.3.2.3" xref="S2.E3.m1.9.9.1.1.1.3.2.3.cmml">r</mi></msub></mrow><mo id="S2.E3.m1.9.9.1.1.1.2" xref="S2.E3.m1.9.9.1.1.1.2.cmml">⁢</mo><mrow id="S2.E3.m1.9.9.1.1.1.1.1" xref="S2.E3.m1.9.9.1.1.1.1.1.1.cmml"><mo id="S2.E3.m1.9.9.1.1.1.1.1.2" stretchy="false" xref="S2.E3.m1.9.9.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E3.m1.9.9.1.1.1.1.1.1" xref="S2.E3.m1.9.9.1.1.1.1.1.1.cmml"><msup id="S2.E3.m1.9.9.1.1.1.1.1.1.2" xref="S2.E3.m1.9.9.1.1.1.1.1.1.2.cmml"><mi id="S2.E3.m1.9.9.1.1.1.1.1.1.2.2" xref="S2.E3.m1.9.9.1.1.1.1.1.1.2.2.cmml">a</mi><mo id="S2.E3.m1.9.9.1.1.1.1.1.1.2.3" xref="S2.E3.m1.9.9.1.1.1.1.1.1.2.3.cmml">+</mo></msup><mo id="S2.E3.m1.9.9.1.1.1.1.1.1.1" xref="S2.E3.m1.9.9.1.1.1.1.1.1.1.cmml">≻</mo><mrow id="S2.E3.m1.9.9.1.1.1.1.1.1.3" xref="S2.E3.m1.9.9.1.1.1.1.1.1.3.cmml"><msup id="S2.E3.m1.9.9.1.1.1.1.1.1.3.2" xref="S2.E3.m1.9.9.1.1.1.1.1.1.3.2.cmml"><mi id="S2.E3.m1.9.9.1.1.1.1.1.1.3.2.2" xref="S2.E3.m1.9.9.1.1.1.1.1.1.3.2.2.cmml">a</mi><mo id="S2.E3.m1.9.9.1.1.1.1.1.1.3.2.3" xref="S2.E3.m1.9.9.1.1.1.1.1.1.3.2.3.cmml">−</mo></msup><mo id="S2.E3.m1.9.9.1.1.1.1.1.1.3.1" xref="S2.E3.m1.9.9.1.1.1.1.1.1.3.1.cmml">∣</mo><mi id="S2.E3.m1.9.9.1.1.1.1.1.1.3.3" xref="S2.E3.m1.9.9.1.1.1.1.1.1.3.3.cmml">x</mi></mrow></mrow><mo id="S2.E3.m1.9.9.1.1.1.1.1.3" stretchy="false" xref="S2.E3.m1.9.9.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S2.E3.m1.9.9.5" xref="S2.E3.m1.9.9.5.cmml">=</mo><mrow id="S2.E3.m1.4.4" xref="S2.E3.m1.9.9.6.1.cmml"><mo id="S2.E3.m1.4.4.5" xref="S2.E3.m1.9.9.6.1.1.cmml">{</mo><mtable columnspacing="5pt" displaystyle="true" id="S2.E3.m1.4.4.4" rowspacing="0pt" xref="S2.E3.m1.9.9.6.1.cmml"><mtr id="S2.E3.m1.4.4.4a" xref="S2.E3.m1.9.9.6.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S2.E3.m1.4.4.4b" xref="S2.E3.m1.9.9.6.1.cmml"><mrow id="S2.E3.m1.1.1.1.1.1.1" xref="S2.E3.m1.1.1.1.1.1.1.cmml"><mo id="S2.E3.m1.1.1.1.1.1.1a" xref="S2.E3.m1.1.1.1.1.1.1.cmml">−</mo><mrow id="S2.E3.m1.1.1.1.1.1.1.6" xref="S2.E3.m1.1.1.1.1.1.1.6.cmml"><mstyle displaystyle="false" id="S2.E3.m1.1.1.1.1.1.1.6.2" xref="S2.E3.m1.1.1.1.1.1.1.6.2.cmml"><msub id="S2.E3.m1.1.1.1.1.1.1.6.2a" xref="S2.E3.m1.1.1.1.1.1.1.6.2.cmml"><mo id="S2.E3.m1.1.1.1.1.1.1.6.2.2" xref="S2.E3.m1.1.1.1.1.1.1.6.2.2.cmml">∑</mo><mrow id="S2.E3.m1.1.1.1.1.1.1.3.3.3" xref="S2.E3.m1.1.1.1.1.1.1.3.3.4.cmml"><mo id="S2.E3.m1.1.1.1.1.1.1.3.3.3.3" stretchy="false" xref="S2.E3.m1.1.1.1.1.1.1.3.3.4.cmml">(</mo><mi id="S2.E3.m1.1.1.1.1.1.1.1.1.1" xref="S2.E3.m1.1.1.1.1.1.1.1.1.1.cmml">x</mi><mo id="S2.E3.m1.1.1.1.1.1.1.3.3.3.4" xref="S2.E3.m1.1.1.1.1.1.1.3.3.4.cmml">,</mo><msup id="S2.E3.m1.1.1.1.1.1.1.2.2.2.1" xref="S2.E3.m1.1.1.1.1.1.1.2.2.2.1.cmml"><mi id="S2.E3.m1.1.1.1.1.1.1.2.2.2.1.2" xref="S2.E3.m1.1.1.1.1.1.1.2.2.2.1.2.cmml">a</mi><mo id="S2.E3.m1.1.1.1.1.1.1.2.2.2.1.3" xref="S2.E3.m1.1.1.1.1.1.1.2.2.2.1.3.cmml">+</mo></msup><mo id="S2.E3.m1.1.1.1.1.1.1.3.3.3.5" xref="S2.E3.m1.1.1.1.1.1.1.3.3.4.cmml">,</mo><msup id="S2.E3.m1.1.1.1.1.1.1.3.3.3.2" xref="S2.E3.m1.1.1.1.1.1.1.3.3.3.2.cmml"><mi id="S2.E3.m1.1.1.1.1.1.1.3.3.3.2.2" xref="S2.E3.m1.1.1.1.1.1.1.3.3.3.2.2.cmml">a</mi><mo id="S2.E3.m1.1.1.1.1.1.1.3.3.3.2.3" xref="S2.E3.m1.1.1.1.1.1.1.3.3.3.2.3.cmml">−</mo></msup><mo id="S2.E3.m1.1.1.1.1.1.1.3.3.3.6" stretchy="false" xref="S2.E3.m1.1.1.1.1.1.1.3.3.4.cmml">)</mo></mrow></msub></mstyle><mrow id="S2.E3.m1.1.1.1.1.1.1.6.1" xref="S2.E3.m1.1.1.1.1.1.1.6.1.cmml"><mrow id="S2.E3.m1.1.1.1.1.1.1.6.1.3" xref="S2.E3.m1.1.1.1.1.1.1.6.1.3.cmml"><mi id="S2.E3.m1.1.1.1.1.1.1.6.1.3.1" xref="S2.E3.m1.1.1.1.1.1.1.6.1.3.1.cmml">log</mi><mo id="S2.E3.m1.1.1.1.1.1.1.6.1.3a" lspace="0.167em" xref="S2.E3.m1.1.1.1.1.1.1.6.1.3.cmml">⁡</mo><mi id="S2.E3.m1.1.1.1.1.1.1.6.1.3.2" xref="S2.E3.m1.1.1.1.1.1.1.6.1.3.2.cmml">σ</mi></mrow><mo id="S2.E3.m1.1.1.1.1.1.1.6.1.2" xref="S2.E3.m1.1.1.1.1.1.1.6.1.2.cmml">⁢</mo><mrow id="S2.E3.m1.1.1.1.1.1.1.6.1.1.1" xref="S2.E3.m1.1.1.1.1.1.1.6.1.1.1.1.cmml"><mo id="S2.E3.m1.1.1.1.1.1.1.6.1.1.1.2" stretchy="false" xref="S2.E3.m1.1.1.1.1.1.1.6.1.1.1.1.cmml">(</mo><mrow id="S2.E3.m1.1.1.1.1.1.1.6.1.1.1.1" xref="S2.E3.m1.1.1.1.1.1.1.6.1.1.1.1.cmml"><mrow id="S2.E3.m1.1.1.1.1.1.1.6.1.1.1.1.1" xref="S2.E3.m1.1.1.1.1.1.1.6.1.1.1.1.1.cmml"><mi id="S2.E3.m1.1.1.1.1.1.1.6.1.1.1.1.1.3" xref="S2.E3.m1.1.1.1.1.1.1.6.1.1.1.1.1.3.cmml">r</mi><mo id="S2.E3.m1.1.1.1.1.1.1.6.1.1.1.1.1.2" xref="S2.E3.m1.1.1.1.1.1.1.6.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E3.m1.1.1.1.1.1.1.6.1.1.1.1.1.1.1" xref="S2.E3.m1.1.1.1.1.1.1.6.1.1.1.1.1.1.2.cmml"><mo id="S2.E3.m1.1.1.1.1.1.1.6.1.1.1.1.1.1.1.2" stretchy="false" xref="S2.E3.m1.1.1.1.1.1.1.6.1.1.1.1.1.1.2.cmml">(</mo><mi id="S2.E3.m1.1.1.1.1.1.1.4" xref="S2.E3.m1.1.1.1.1.1.1.4.cmml">x</mi><mo id="S2.E3.m1.1.1.1.1.1.1.6.1.1.1.1.1.1.1.3" xref="S2.E3.m1.1.1.1.1.1.1.6.1.1.1.1.1.1.2.cmml">,</mo><msup id="S2.E3.m1.1.1.1.1.1.1.6.1.1.1.1.1.1.1.1" xref="S2.E3.m1.1.1.1.1.1.1.6.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E3.m1.1.1.1.1.1.1.6.1.1.1.1.1.1.1.1.2" xref="S2.E3.m1.1.1.1.1.1.1.6.1.1.1.1.1.1.1.1.2.cmml">a</mi><mo id="S2.E3.m1.1.1.1.1.1.1.6.1.1.1.1.1.1.1.1.3" xref="S2.E3.m1.1.1.1.1.1.1.6.1.1.1.1.1.1.1.1.3.cmml">+</mo></msup><mo id="S2.E3.m1.1.1.1.1.1.1.6.1.1.1.1.1.1.1.4" stretchy="false" xref="S2.E3.m1.1.1.1.1.1.1.6.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S2.E3.m1.1.1.1.1.1.1.6.1.1.1.1.3" xref="S2.E3.m1.1.1.1.1.1.1.6.1.1.1.1.3.cmml">−</mo><mrow id="S2.E3.m1.1.1.1.1.1.1.6.1.1.1.1.2" xref="S2.E3.m1.1.1.1.1.1.1.6.1.1.1.1.2.cmml"><mi id="S2.E3.m1.1.1.1.1.1.1.6.1.1.1.1.2.3" xref="S2.E3.m1.1.1.1.1.1.1.6.1.1.1.1.2.3.cmml">r</mi><mo id="S2.E3.m1.1.1.1.1.1.1.6.1.1.1.1.2.2" xref="S2.E3.m1.1.1.1.1.1.1.6.1.1.1.1.2.2.cmml">⁢</mo><mrow id="S2.E3.m1.1.1.1.1.1.1.6.1.1.1.1.2.1.1" xref="S2.E3.m1.1.1.1.1.1.1.6.1.1.1.1.2.1.2.cmml"><mo id="S2.E3.m1.1.1.1.1.1.1.6.1.1.1.1.2.1.1.2" stretchy="false" xref="S2.E3.m1.1.1.1.1.1.1.6.1.1.1.1.2.1.2.cmml">(</mo><mi id="S2.E3.m1.1.1.1.1.1.1.5" xref="S2.E3.m1.1.1.1.1.1.1.5.cmml">x</mi><mo id="S2.E3.m1.1.1.1.1.1.1.6.1.1.1.1.2.1.1.3" xref="S2.E3.m1.1.1.1.1.1.1.6.1.1.1.1.2.1.2.cmml">,</mo><msup id="S2.E3.m1.1.1.1.1.1.1.6.1.1.1.1.2.1.1.1" xref="S2.E3.m1.1.1.1.1.1.1.6.1.1.1.1.2.1.1.1.cmml"><mi id="S2.E3.m1.1.1.1.1.1.1.6.1.1.1.1.2.1.1.1.2" xref="S2.E3.m1.1.1.1.1.1.1.6.1.1.1.1.2.1.1.1.2.cmml">a</mi><mo id="S2.E3.m1.1.1.1.1.1.1.6.1.1.1.1.2.1.1.1.3" xref="S2.E3.m1.1.1.1.1.1.1.6.1.1.1.1.2.1.1.1.3.cmml">−</mo></msup><mo id="S2.E3.m1.1.1.1.1.1.1.6.1.1.1.1.2.1.1.4" stretchy="false" xref="S2.E3.m1.1.1.1.1.1.1.6.1.1.1.1.2.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E3.m1.1.1.1.1.1.1.6.1.1.1.3" stretchy="false" xref="S2.E3.m1.1.1.1.1.1.1.6.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S2.E3.m1.4.4.4c" xref="S2.E3.m1.9.9.6.1.cmml"><mtext id="S2.E3.m1.2.2.2.2.2.1" xref="S2.E3.m1.2.2.2.2.2.1a.cmml">(pointwise)</mtext></mtd></mtr><mtr id="S2.E3.m1.4.4.4d" xref="S2.E3.m1.9.9.6.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S2.E3.m1.4.4.4e" xref="S2.E3.m1.9.9.6.1.cmml"><mrow id="S2.E3.m1.3.3.3.3.1.1" xref="S2.E3.m1.3.3.3.3.1.1.cmml"><mo id="S2.E3.m1.3.3.3.3.1.1a" xref="S2.E3.m1.3.3.3.3.1.1.cmml">−</mo><mrow id="S2.E3.m1.3.3.3.3.1.1.5" xref="S2.E3.m1.3.3.3.3.1.1.5.cmml"><mstyle displaystyle="false" id="S2.E3.m1.3.3.3.3.1.1.5.2" xref="S2.E3.m1.3.3.3.3.1.1.5.2.cmml"><msub id="S2.E3.m1.3.3.3.3.1.1.5.2a" xref="S2.E3.m1.3.3.3.3.1.1.5.2.cmml"><mo id="S2.E3.m1.3.3.3.3.1.1.5.2.2" xref="S2.E3.m1.3.3.3.3.1.1.5.2.2.cmml">∑</mo><mrow id="S2.E3.m1.3.3.3.3.1.1.3.3.3" xref="S2.E3.m1.3.3.3.3.1.1.3.3.4.cmml"><mo id="S2.E3.m1.3.3.3.3.1.1.3.3.3.3" stretchy="false" xref="S2.E3.m1.3.3.3.3.1.1.3.3.4.cmml">(</mo><mi id="S2.E3.m1.3.3.3.3.1.1.1.1.1" xref="S2.E3.m1.3.3.3.3.1.1.1.1.1.cmml">x</mi><mo id="S2.E3.m1.3.3.3.3.1.1.3.3.3.4" xref="S2.E3.m1.3.3.3.3.1.1.3.3.4.cmml">,</mo><msup id="S2.E3.m1.3.3.3.3.1.1.2.2.2.1" xref="S2.E3.m1.3.3.3.3.1.1.2.2.2.1.cmml"><mi id="S2.E3.m1.3.3.3.3.1.1.2.2.2.1.2" xref="S2.E3.m1.3.3.3.3.1.1.2.2.2.1.2.cmml">a</mi><mo id="S2.E3.m1.3.3.3.3.1.1.2.2.2.1.3" xref="S2.E3.m1.3.3.3.3.1.1.2.2.2.1.3.cmml">+</mo></msup><mo id="S2.E3.m1.3.3.3.3.1.1.3.3.3.5" xref="S2.E3.m1.3.3.3.3.1.1.3.3.4.cmml">,</mo><msup id="S2.E3.m1.3.3.3.3.1.1.3.3.3.2" xref="S2.E3.m1.3.3.3.3.1.1.3.3.3.2.cmml"><mi id="S2.E3.m1.3.3.3.3.1.1.3.3.3.2.2" xref="S2.E3.m1.3.3.3.3.1.1.3.3.3.2.2.cmml">a</mi><mo id="S2.E3.m1.3.3.3.3.1.1.3.3.3.2.3" xref="S2.E3.m1.3.3.3.3.1.1.3.3.3.2.3.cmml">−</mo></msup><mo id="S2.E3.m1.3.3.3.3.1.1.3.3.3.6" stretchy="false" xref="S2.E3.m1.3.3.3.3.1.1.3.3.4.cmml">)</mo></mrow></msub></mstyle><mrow id="S2.E3.m1.3.3.3.3.1.1.5.1" xref="S2.E3.m1.3.3.3.3.1.1.5.1.cmml"><mrow id="S2.E3.m1.3.3.3.3.1.1.5.1.3" xref="S2.E3.m1.3.3.3.3.1.1.5.1.3.cmml"><mi id="S2.E3.m1.3.3.3.3.1.1.5.1.3.1" xref="S2.E3.m1.3.3.3.3.1.1.5.1.3.1.cmml">log</mi><mo id="S2.E3.m1.3.3.3.3.1.1.5.1.3a" lspace="0.167em" xref="S2.E3.m1.3.3.3.3.1.1.5.1.3.cmml">⁡</mo><mi id="S2.E3.m1.3.3.3.3.1.1.5.1.3.2" xref="S2.E3.m1.3.3.3.3.1.1.5.1.3.2.cmml">σ</mi></mrow><mo id="S2.E3.m1.3.3.3.3.1.1.5.1.2" xref="S2.E3.m1.3.3.3.3.1.1.5.1.2.cmml">⁢</mo><mrow id="S2.E3.m1.3.3.3.3.1.1.5.1.1.1" xref="S2.E3.m1.3.3.3.3.1.1.5.1.1.1.1.cmml"><mo id="S2.E3.m1.3.3.3.3.1.1.5.1.1.1.2" stretchy="false" xref="S2.E3.m1.3.3.3.3.1.1.5.1.1.1.1.cmml">(</mo><mrow id="S2.E3.m1.3.3.3.3.1.1.5.1.1.1.1" xref="S2.E3.m1.3.3.3.3.1.1.5.1.1.1.1.cmml"><mi id="S2.E3.m1.3.3.3.3.1.1.5.1.1.1.1.4" xref="S2.E3.m1.3.3.3.3.1.1.5.1.1.1.1.4.cmml">r</mi><mo id="S2.E3.m1.3.3.3.3.1.1.5.1.1.1.1.3" xref="S2.E3.m1.3.3.3.3.1.1.5.1.1.1.1.3.cmml">⁢</mo><mrow id="S2.E3.m1.3.3.3.3.1.1.5.1.1.1.1.2.2" xref="S2.E3.m1.3.3.3.3.1.1.5.1.1.1.1.2.3.cmml"><mo id="S2.E3.m1.3.3.3.3.1.1.5.1.1.1.1.2.2.3" stretchy="false" xref="S2.E3.m1.3.3.3.3.1.1.5.1.1.1.1.2.3.cmml">(</mo><mi id="S2.E3.m1.3.3.3.3.1.1.4" xref="S2.E3.m1.3.3.3.3.1.1.4.cmml">x</mi><mo id="S2.E3.m1.3.3.3.3.1.1.5.1.1.1.1.2.2.4" xref="S2.E3.m1.3.3.3.3.1.1.5.1.1.1.1.2.3.cmml">,</mo><msup id="S2.E3.m1.3.3.3.3.1.1.5.1.1.1.1.1.1.1" xref="S2.E3.m1.3.3.3.3.1.1.5.1.1.1.1.1.1.1.cmml"><mi id="S2.E3.m1.3.3.3.3.1.1.5.1.1.1.1.1.1.1.2" xref="S2.E3.m1.3.3.3.3.1.1.5.1.1.1.1.1.1.1.2.cmml">a</mi><mo id="S2.E3.m1.3.3.3.3.1.1.5.1.1.1.1.1.1.1.3" xref="S2.E3.m1.3.3.3.3.1.1.5.1.1.1.1.1.1.1.3.cmml">+</mo></msup><mo id="S2.E3.m1.3.3.3.3.1.1.5.1.1.1.1.2.2.5" xref="S2.E3.m1.3.3.3.3.1.1.5.1.1.1.1.2.3.cmml">,</mo><msup id="S2.E3.m1.3.3.3.3.1.1.5.1.1.1.1.2.2.2" xref="S2.E3.m1.3.3.3.3.1.1.5.1.1.1.1.2.2.2.cmml"><mi id="S2.E3.m1.3.3.3.3.1.1.5.1.1.1.1.2.2.2.2" xref="S2.E3.m1.3.3.3.3.1.1.5.1.1.1.1.2.2.2.2.cmml">a</mi><mo id="S2.E3.m1.3.3.3.3.1.1.5.1.1.1.1.2.2.2.3" xref="S2.E3.m1.3.3.3.3.1.1.5.1.1.1.1.2.2.2.3.cmml">−</mo></msup><mo id="S2.E3.m1.3.3.3.3.1.1.5.1.1.1.1.2.2.6" stretchy="false" xref="S2.E3.m1.3.3.3.3.1.1.5.1.1.1.1.2.3.cmml">)</mo></mrow></mrow><mo id="S2.E3.m1.3.3.3.3.1.1.5.1.1.1.3" stretchy="false" xref="S2.E3.m1.3.3.3.3.1.1.5.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S2.E3.m1.4.4.4f" xref="S2.E3.m1.9.9.6.1.cmml"><mtext id="S2.E3.m1.4.4.4.4.2.1" xref="S2.E3.m1.4.4.4.4.2.1a.cmml">(pairwise)</mtext></mtd></mtr></mtable></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E3.m1.9b"><apply id="S2.E3.m1.9.9.cmml" xref="S2.E3.m1.9.9"><and id="S2.E3.m1.9.9a.cmml" xref="S2.E3.m1.9.9"></and><apply id="S2.E3.m1.9.9b.cmml" xref="S2.E3.m1.9.9"><eq id="S2.E3.m1.9.9.4.cmml" xref="S2.E3.m1.9.9.4"></eq><apply id="S2.E3.m1.9.9.3.cmml" xref="S2.E3.m1.9.9.3"><times id="S2.E3.m1.9.9.3.1.cmml" xref="S2.E3.m1.9.9.3.1"></times><apply id="S2.E3.m1.9.9.3.2.cmml" xref="S2.E3.m1.9.9.3.2"><csymbol cd="ambiguous" id="S2.E3.m1.9.9.3.2.1.cmml" xref="S2.E3.m1.9.9.3.2">subscript</csymbol><ci id="S2.E3.m1.9.9.3.2.2.cmml" xref="S2.E3.m1.9.9.3.2.2">ℓ</ci><ci id="S2.E3.m1.9.9.3.2.3.cmml" xref="S2.E3.m1.9.9.3.2.3">𝑅</ci></apply><ci id="S2.E3.m1.8.8.cmml" xref="S2.E3.m1.8.8">𝑟</ci></apply><apply id="S2.E3.m1.9.9.1.cmml" xref="S2.E3.m1.9.9.1"><minus id="S2.E3.m1.9.9.1.2.cmml" xref="S2.E3.m1.9.9.1"></minus><apply id="S2.E3.m1.9.9.1.1.cmml" xref="S2.E3.m1.9.9.1.1"><apply id="S2.E3.m1.9.9.1.1.2.cmml" xref="S2.E3.m1.9.9.1.1.2"><csymbol cd="ambiguous" id="S2.E3.m1.9.9.1.1.2.1.cmml" xref="S2.E3.m1.9.9.1.1.2">subscript</csymbol><sum id="S2.E3.m1.9.9.1.1.2.2.cmml" xref="S2.E3.m1.9.9.1.1.2.2"></sum><vector id="S2.E3.m1.7.7.3.4.cmml" xref="S2.E3.m1.7.7.3.3"><ci id="S2.E3.m1.5.5.1.1.cmml" xref="S2.E3.m1.5.5.1.1">𝑥</ci><apply id="S2.E3.m1.6.6.2.2.1.cmml" xref="S2.E3.m1.6.6.2.2.1"><csymbol cd="ambiguous" id="S2.E3.m1.6.6.2.2.1.1.cmml" xref="S2.E3.m1.6.6.2.2.1">superscript</csymbol><ci id="S2.E3.m1.6.6.2.2.1.2.cmml" xref="S2.E3.m1.6.6.2.2.1.2">𝑎</ci><plus id="S2.E3.m1.6.6.2.2.1.3.cmml" xref="S2.E3.m1.6.6.2.2.1.3"></plus></apply><apply id="S2.E3.m1.7.7.3.3.2.cmml" xref="S2.E3.m1.7.7.3.3.2"><csymbol cd="ambiguous" id="S2.E3.m1.7.7.3.3.2.1.cmml" xref="S2.E3.m1.7.7.3.3.2">superscript</csymbol><ci id="S2.E3.m1.7.7.3.3.2.2.cmml" xref="S2.E3.m1.7.7.3.3.2.2">𝑎</ci><minus id="S2.E3.m1.7.7.3.3.2.3.cmml" xref="S2.E3.m1.7.7.3.3.2.3"></minus></apply></vector></apply><apply id="S2.E3.m1.9.9.1.1.1.cmml" xref="S2.E3.m1.9.9.1.1.1"><times id="S2.E3.m1.9.9.1.1.1.2.cmml" xref="S2.E3.m1.9.9.1.1.1.2"></times><apply id="S2.E3.m1.9.9.1.1.1.3.cmml" xref="S2.E3.m1.9.9.1.1.1.3"><log id="S2.E3.m1.9.9.1.1.1.3.1.cmml" xref="S2.E3.m1.9.9.1.1.1.3.1"></log><apply id="S2.E3.m1.9.9.1.1.1.3.2.cmml" xref="S2.E3.m1.9.9.1.1.1.3.2"><csymbol cd="ambiguous" id="S2.E3.m1.9.9.1.1.1.3.2.1.cmml" xref="S2.E3.m1.9.9.1.1.1.3.2">subscript</csymbol><ci id="S2.E3.m1.9.9.1.1.1.3.2.2.cmml" xref="S2.E3.m1.9.9.1.1.1.3.2.2">𝑝</ci><ci id="S2.E3.m1.9.9.1.1.1.3.2.3.cmml" xref="S2.E3.m1.9.9.1.1.1.3.2.3">𝑟</ci></apply></apply><apply id="S2.E3.m1.9.9.1.1.1.1.1.1.cmml" xref="S2.E3.m1.9.9.1.1.1.1.1"><csymbol cd="latexml" id="S2.E3.m1.9.9.1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.9.9.1.1.1.1.1.1.1">succeeds</csymbol><apply id="S2.E3.m1.9.9.1.1.1.1.1.1.2.cmml" xref="S2.E3.m1.9.9.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E3.m1.9.9.1.1.1.1.1.1.2.1.cmml" xref="S2.E3.m1.9.9.1.1.1.1.1.1.2">superscript</csymbol><ci id="S2.E3.m1.9.9.1.1.1.1.1.1.2.2.cmml" xref="S2.E3.m1.9.9.1.1.1.1.1.1.2.2">𝑎</ci><plus id="S2.E3.m1.9.9.1.1.1.1.1.1.2.3.cmml" xref="S2.E3.m1.9.9.1.1.1.1.1.1.2.3"></plus></apply><apply id="S2.E3.m1.9.9.1.1.1.1.1.1.3.cmml" xref="S2.E3.m1.9.9.1.1.1.1.1.1.3"><csymbol cd="latexml" id="S2.E3.m1.9.9.1.1.1.1.1.1.3.1.cmml" xref="S2.E3.m1.9.9.1.1.1.1.1.1.3.1">conditional</csymbol><apply id="S2.E3.m1.9.9.1.1.1.1.1.1.3.2.cmml" xref="S2.E3.m1.9.9.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S2.E3.m1.9.9.1.1.1.1.1.1.3.2.1.cmml" xref="S2.E3.m1.9.9.1.1.1.1.1.1.3.2">superscript</csymbol><ci id="S2.E3.m1.9.9.1.1.1.1.1.1.3.2.2.cmml" xref="S2.E3.m1.9.9.1.1.1.1.1.1.3.2.2">𝑎</ci><minus id="S2.E3.m1.9.9.1.1.1.1.1.1.3.2.3.cmml" xref="S2.E3.m1.9.9.1.1.1.1.1.1.3.2.3"></minus></apply><ci id="S2.E3.m1.9.9.1.1.1.1.1.1.3.3.cmml" xref="S2.E3.m1.9.9.1.1.1.1.1.1.3.3">𝑥</ci></apply></apply></apply></apply></apply></apply><apply id="S2.E3.m1.9.9c.cmml" xref="S2.E3.m1.9.9"><eq id="S2.E3.m1.9.9.5.cmml" xref="S2.E3.m1.9.9.5"></eq><share href="https://arxiv.org/html/2410.03742v1#S2.E3.m1.9.9.1.cmml" id="S2.E3.m1.9.9d.cmml" xref="S2.E3.m1.9.9"></share><apply id="S2.E3.m1.9.9.6.1.cmml" xref="S2.E3.m1.4.4"><csymbol cd="latexml" id="S2.E3.m1.9.9.6.1.1.cmml" xref="S2.E3.m1.4.4.5">cases</csymbol><apply id="S2.E3.m1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1"><minus id="S2.E3.m1.1.1.1.1.1.1.7.cmml" xref="S2.E3.m1.1.1.1.1.1.1"></minus><apply id="S2.E3.m1.1.1.1.1.1.1.6.cmml" xref="S2.E3.m1.1.1.1.1.1.1.6"><apply id="S2.E3.m1.1.1.1.1.1.1.6.2.cmml" xref="S2.E3.m1.1.1.1.1.1.1.6.2"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.1.1.1.1.6.2.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1.6.2">subscript</csymbol><sum id="S2.E3.m1.1.1.1.1.1.1.6.2.2.cmml" xref="S2.E3.m1.1.1.1.1.1.1.6.2.2"></sum><vector id="S2.E3.m1.1.1.1.1.1.1.3.3.4.cmml" xref="S2.E3.m1.1.1.1.1.1.1.3.3.3"><ci id="S2.E3.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.1">𝑥</ci><apply id="S2.E3.m1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1.2.2.2.1"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.1.1.1.1.2.2.2.1.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1.2.2.2.1">superscript</csymbol><ci id="S2.E3.m1.1.1.1.1.1.1.2.2.2.1.2.cmml" xref="S2.E3.m1.1.1.1.1.1.1.2.2.2.1.2">𝑎</ci><plus id="S2.E3.m1.1.1.1.1.1.1.2.2.2.1.3.cmml" xref="S2.E3.m1.1.1.1.1.1.1.2.2.2.1.3"></plus></apply><apply id="S2.E3.m1.1.1.1.1.1.1.3.3.3.2.cmml" xref="S2.E3.m1.1.1.1.1.1.1.3.3.3.2"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.1.1.1.1.3.3.3.2.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1.3.3.3.2">superscript</csymbol><ci id="S2.E3.m1.1.1.1.1.1.1.3.3.3.2.2.cmml" xref="S2.E3.m1.1.1.1.1.1.1.3.3.3.2.2">𝑎</ci><minus id="S2.E3.m1.1.1.1.1.1.1.3.3.3.2.3.cmml" xref="S2.E3.m1.1.1.1.1.1.1.3.3.3.2.3"></minus></apply></vector></apply><apply id="S2.E3.m1.1.1.1.1.1.1.6.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1.6.1"><times id="S2.E3.m1.1.1.1.1.1.1.6.1.2.cmml" xref="S2.E3.m1.1.1.1.1.1.1.6.1.2"></times><apply id="S2.E3.m1.1.1.1.1.1.1.6.1.3.cmml" xref="S2.E3.m1.1.1.1.1.1.1.6.1.3"><log id="S2.E3.m1.1.1.1.1.1.1.6.1.3.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1.6.1.3.1"></log><ci id="S2.E3.m1.1.1.1.1.1.1.6.1.3.2.cmml" xref="S2.E3.m1.1.1.1.1.1.1.6.1.3.2">𝜎</ci></apply><apply id="S2.E3.m1.1.1.1.1.1.1.6.1.1.1.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1.6.1.1.1"><minus id="S2.E3.m1.1.1.1.1.1.1.6.1.1.1.1.3.cmml" xref="S2.E3.m1.1.1.1.1.1.1.6.1.1.1.1.3"></minus><apply id="S2.E3.m1.1.1.1.1.1.1.6.1.1.1.1.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1.6.1.1.1.1.1"><times id="S2.E3.m1.1.1.1.1.1.1.6.1.1.1.1.1.2.cmml" xref="S2.E3.m1.1.1.1.1.1.1.6.1.1.1.1.1.2"></times><ci id="S2.E3.m1.1.1.1.1.1.1.6.1.1.1.1.1.3.cmml" xref="S2.E3.m1.1.1.1.1.1.1.6.1.1.1.1.1.3">𝑟</ci><interval closure="open" id="S2.E3.m1.1.1.1.1.1.1.6.1.1.1.1.1.1.2.cmml" xref="S2.E3.m1.1.1.1.1.1.1.6.1.1.1.1.1.1.1"><ci id="S2.E3.m1.1.1.1.1.1.1.4.cmml" xref="S2.E3.m1.1.1.1.1.1.1.4">𝑥</ci><apply id="S2.E3.m1.1.1.1.1.1.1.6.1.1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1.6.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.1.1.1.1.6.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1.6.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S2.E3.m1.1.1.1.1.1.1.6.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E3.m1.1.1.1.1.1.1.6.1.1.1.1.1.1.1.1.2">𝑎</ci><plus id="S2.E3.m1.1.1.1.1.1.1.6.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E3.m1.1.1.1.1.1.1.6.1.1.1.1.1.1.1.1.3"></plus></apply></interval></apply><apply id="S2.E3.m1.1.1.1.1.1.1.6.1.1.1.1.2.cmml" xref="S2.E3.m1.1.1.1.1.1.1.6.1.1.1.1.2"><times id="S2.E3.m1.1.1.1.1.1.1.6.1.1.1.1.2.2.cmml" xref="S2.E3.m1.1.1.1.1.1.1.6.1.1.1.1.2.2"></times><ci id="S2.E3.m1.1.1.1.1.1.1.6.1.1.1.1.2.3.cmml" xref="S2.E3.m1.1.1.1.1.1.1.6.1.1.1.1.2.3">𝑟</ci><interval closure="open" id="S2.E3.m1.1.1.1.1.1.1.6.1.1.1.1.2.1.2.cmml" xref="S2.E3.m1.1.1.1.1.1.1.6.1.1.1.1.2.1.1"><ci id="S2.E3.m1.1.1.1.1.1.1.5.cmml" xref="S2.E3.m1.1.1.1.1.1.1.5">𝑥</ci><apply id="S2.E3.m1.1.1.1.1.1.1.6.1.1.1.1.2.1.1.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1.6.1.1.1.1.2.1.1.1"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.1.1.1.1.6.1.1.1.1.2.1.1.1.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1.6.1.1.1.1.2.1.1.1">superscript</csymbol><ci id="S2.E3.m1.1.1.1.1.1.1.6.1.1.1.1.2.1.1.1.2.cmml" xref="S2.E3.m1.1.1.1.1.1.1.6.1.1.1.1.2.1.1.1.2">𝑎</ci><minus id="S2.E3.m1.1.1.1.1.1.1.6.1.1.1.1.2.1.1.1.3.cmml" xref="S2.E3.m1.1.1.1.1.1.1.6.1.1.1.1.2.1.1.1.3"></minus></apply></interval></apply></apply></apply></apply></apply><ci id="S2.E3.m1.2.2.2.2.2.1a.cmml" xref="S2.E3.m1.2.2.2.2.2.1"><mtext id="S2.E3.m1.2.2.2.2.2.1.cmml" xref="S2.E3.m1.2.2.2.2.2.1">(pointwise)</mtext></ci><apply id="S2.E3.m1.3.3.3.3.1.1.cmml" xref="S2.E3.m1.3.3.3.3.1.1"><minus id="S2.E3.m1.3.3.3.3.1.1.6.cmml" xref="S2.E3.m1.3.3.3.3.1.1"></minus><apply id="S2.E3.m1.3.3.3.3.1.1.5.cmml" xref="S2.E3.m1.3.3.3.3.1.1.5"><apply id="S2.E3.m1.3.3.3.3.1.1.5.2.cmml" xref="S2.E3.m1.3.3.3.3.1.1.5.2"><csymbol cd="ambiguous" id="S2.E3.m1.3.3.3.3.1.1.5.2.1.cmml" xref="S2.E3.m1.3.3.3.3.1.1.5.2">subscript</csymbol><sum id="S2.E3.m1.3.3.3.3.1.1.5.2.2.cmml" xref="S2.E3.m1.3.3.3.3.1.1.5.2.2"></sum><vector id="S2.E3.m1.3.3.3.3.1.1.3.3.4.cmml" xref="S2.E3.m1.3.3.3.3.1.1.3.3.3"><ci id="S2.E3.m1.3.3.3.3.1.1.1.1.1.cmml" xref="S2.E3.m1.3.3.3.3.1.1.1.1.1">𝑥</ci><apply id="S2.E3.m1.3.3.3.3.1.1.2.2.2.1.cmml" xref="S2.E3.m1.3.3.3.3.1.1.2.2.2.1"><csymbol cd="ambiguous" id="S2.E3.m1.3.3.3.3.1.1.2.2.2.1.1.cmml" xref="S2.E3.m1.3.3.3.3.1.1.2.2.2.1">superscript</csymbol><ci id="S2.E3.m1.3.3.3.3.1.1.2.2.2.1.2.cmml" xref="S2.E3.m1.3.3.3.3.1.1.2.2.2.1.2">𝑎</ci><plus id="S2.E3.m1.3.3.3.3.1.1.2.2.2.1.3.cmml" xref="S2.E3.m1.3.3.3.3.1.1.2.2.2.1.3"></plus></apply><apply id="S2.E3.m1.3.3.3.3.1.1.3.3.3.2.cmml" xref="S2.E3.m1.3.3.3.3.1.1.3.3.3.2"><csymbol cd="ambiguous" id="S2.E3.m1.3.3.3.3.1.1.3.3.3.2.1.cmml" xref="S2.E3.m1.3.3.3.3.1.1.3.3.3.2">superscript</csymbol><ci id="S2.E3.m1.3.3.3.3.1.1.3.3.3.2.2.cmml" xref="S2.E3.m1.3.3.3.3.1.1.3.3.3.2.2">𝑎</ci><minus id="S2.E3.m1.3.3.3.3.1.1.3.3.3.2.3.cmml" xref="S2.E3.m1.3.3.3.3.1.1.3.3.3.2.3"></minus></apply></vector></apply><apply id="S2.E3.m1.3.3.3.3.1.1.5.1.cmml" xref="S2.E3.m1.3.3.3.3.1.1.5.1"><times id="S2.E3.m1.3.3.3.3.1.1.5.1.2.cmml" xref="S2.E3.m1.3.3.3.3.1.1.5.1.2"></times><apply id="S2.E3.m1.3.3.3.3.1.1.5.1.3.cmml" xref="S2.E3.m1.3.3.3.3.1.1.5.1.3"><log id="S2.E3.m1.3.3.3.3.1.1.5.1.3.1.cmml" xref="S2.E3.m1.3.3.3.3.1.1.5.1.3.1"></log><ci id="S2.E3.m1.3.3.3.3.1.1.5.1.3.2.cmml" xref="S2.E3.m1.3.3.3.3.1.1.5.1.3.2">𝜎</ci></apply><apply id="S2.E3.m1.3.3.3.3.1.1.5.1.1.1.1.cmml" xref="S2.E3.m1.3.3.3.3.1.1.5.1.1.1"><times id="S2.E3.m1.3.3.3.3.1.1.5.1.1.1.1.3.cmml" xref="S2.E3.m1.3.3.3.3.1.1.5.1.1.1.1.3"></times><ci id="S2.E3.m1.3.3.3.3.1.1.5.1.1.1.1.4.cmml" xref="S2.E3.m1.3.3.3.3.1.1.5.1.1.1.1.4">𝑟</ci><vector id="S2.E3.m1.3.3.3.3.1.1.5.1.1.1.1.2.3.cmml" xref="S2.E3.m1.3.3.3.3.1.1.5.1.1.1.1.2.2"><ci id="S2.E3.m1.3.3.3.3.1.1.4.cmml" xref="S2.E3.m1.3.3.3.3.1.1.4">𝑥</ci><apply id="S2.E3.m1.3.3.3.3.1.1.5.1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.3.3.3.3.1.1.5.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E3.m1.3.3.3.3.1.1.5.1.1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.3.3.3.3.1.1.5.1.1.1.1.1.1.1">superscript</csymbol><ci id="S2.E3.m1.3.3.3.3.1.1.5.1.1.1.1.1.1.1.2.cmml" xref="S2.E3.m1.3.3.3.3.1.1.5.1.1.1.1.1.1.1.2">𝑎</ci><plus id="S2.E3.m1.3.3.3.3.1.1.5.1.1.1.1.1.1.1.3.cmml" xref="S2.E3.m1.3.3.3.3.1.1.5.1.1.1.1.1.1.1.3"></plus></apply><apply id="S2.E3.m1.3.3.3.3.1.1.5.1.1.1.1.2.2.2.cmml" xref="S2.E3.m1.3.3.3.3.1.1.5.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S2.E3.m1.3.3.3.3.1.1.5.1.1.1.1.2.2.2.1.cmml" xref="S2.E3.m1.3.3.3.3.1.1.5.1.1.1.1.2.2.2">superscript</csymbol><ci id="S2.E3.m1.3.3.3.3.1.1.5.1.1.1.1.2.2.2.2.cmml" xref="S2.E3.m1.3.3.3.3.1.1.5.1.1.1.1.2.2.2.2">𝑎</ci><minus id="S2.E3.m1.3.3.3.3.1.1.5.1.1.1.1.2.2.2.3.cmml" xref="S2.E3.m1.3.3.3.3.1.1.5.1.1.1.1.2.2.2.3"></minus></apply></vector></apply></apply></apply></apply><ci id="S2.E3.m1.4.4.4.4.2.1a.cmml" xref="S2.E3.m1.4.4.4.4.2.1"><mtext id="S2.E3.m1.4.4.4.4.2.1.cmml" xref="S2.E3.m1.4.4.4.4.2.1">(pairwise)</mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E3.m1.9c">\ell_{R}(r)=-\sum_{(x,a^{+},a^{-})}\log p_{r}(a^{+}\succ a^{-}\mid x)=\begin{%
cases}-\sum_{(x,a^{+},a^{-})}\log\sigma(r(x,a^{+})-r(x,a^{-}))&amp;\text{(%
pointwise)}\\
-\sum_{(x,a^{+},a^{-})}\log\sigma(r(x,a^{+},a^{-}))&amp;\text{(pairwise)}\end{cases}</annotation><annotation encoding="application/x-llamapun" id="S2.E3.m1.9d">roman_ℓ start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT ( italic_r ) = - ∑ start_POSTSUBSCRIPT ( italic_x , italic_a start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT , italic_a start_POSTSUPERSCRIPT - end_POSTSUPERSCRIPT ) end_POSTSUBSCRIPT roman_log italic_p start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ( italic_a start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT ≻ italic_a start_POSTSUPERSCRIPT - end_POSTSUPERSCRIPT ∣ italic_x ) = { start_ROW start_CELL - ∑ start_POSTSUBSCRIPT ( italic_x , italic_a start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT , italic_a start_POSTSUPERSCRIPT - end_POSTSUPERSCRIPT ) end_POSTSUBSCRIPT roman_log italic_σ ( italic_r ( italic_x , italic_a start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT ) - italic_r ( italic_x , italic_a start_POSTSUPERSCRIPT - end_POSTSUPERSCRIPT ) ) end_CELL start_CELL (pointwise) end_CELL end_ROW start_ROW start_CELL - ∑ start_POSTSUBSCRIPT ( italic_x , italic_a start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT , italic_a start_POSTSUPERSCRIPT - end_POSTSUPERSCRIPT ) end_POSTSUBSCRIPT roman_log italic_σ ( italic_r ( italic_x , italic_a start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT , italic_a start_POSTSUPERSCRIPT - end_POSTSUPERSCRIPT ) ) end_CELL start_CELL (pairwise) end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
</div>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Improving Generative Judge by Training on Contrastive Judgments</h2>
<figure class="ltx_figure" id="S3.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="201" id="S3.F2.1.g1" src="x2.png" width="830"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>The steps for constructing Con-J with a preference dataset that includes preference annotations for a pair of answers to a question.
<math alttext="S_{1}" class="ltx_Math" display="inline" id="S3.F2.5.m1.1"><semantics id="S3.F2.5.m1.1b"><msub id="S3.F2.5.m1.1.1" xref="S3.F2.5.m1.1.1.cmml"><mi id="S3.F2.5.m1.1.1.2" xref="S3.F2.5.m1.1.1.2.cmml">S</mi><mn id="S3.F2.5.m1.1.1.3" xref="S3.F2.5.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S3.F2.5.m1.1c"><apply id="S3.F2.5.m1.1.1.cmml" xref="S3.F2.5.m1.1.1"><csymbol cd="ambiguous" id="S3.F2.5.m1.1.1.1.cmml" xref="S3.F2.5.m1.1.1">subscript</csymbol><ci id="S3.F2.5.m1.1.1.2.cmml" xref="S3.F2.5.m1.1.1.2">𝑆</ci><cn id="S3.F2.5.m1.1.1.3.cmml" type="integer" xref="S3.F2.5.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.5.m1.1d">S_{1}</annotation><annotation encoding="application/x-llamapun" id="S3.F2.5.m1.1e">italic_S start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math>: Prompt Con-J to generate multiple judgments for a pair of answers by repeated sampling and hint-driven sampling.
<math alttext="S_{2}" class="ltx_Math" display="inline" id="S3.F2.6.m2.1"><semantics id="S3.F2.6.m2.1b"><msub id="S3.F2.6.m2.1.1" xref="S3.F2.6.m2.1.1.cmml"><mi id="S3.F2.6.m2.1.1.2" xref="S3.F2.6.m2.1.1.2.cmml">S</mi><mn id="S3.F2.6.m2.1.1.3" xref="S3.F2.6.m2.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S3.F2.6.m2.1c"><apply id="S3.F2.6.m2.1.1.cmml" xref="S3.F2.6.m2.1.1"><csymbol cd="ambiguous" id="S3.F2.6.m2.1.1.1.cmml" xref="S3.F2.6.m2.1.1">subscript</csymbol><ci id="S3.F2.6.m2.1.1.2.cmml" xref="S3.F2.6.m2.1.1.2">𝑆</ci><cn id="S3.F2.6.m2.1.1.3.cmml" type="integer" xref="S3.F2.6.m2.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.6.m2.1d">S_{2}</annotation><annotation encoding="application/x-llamapun" id="S3.F2.6.m2.1e">italic_S start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>: Bootstrap contrastive judgment pairs by filtering with true preference labels. A contrastive judgment pair consists of one judgment with the correct preference and the other either with an incorrect preference or does not explicitly indicate a preference.
<math alttext="S_{3}" class="ltx_Math" display="inline" id="S3.F2.7.m3.1"><semantics id="S3.F2.7.m3.1b"><msub id="S3.F2.7.m3.1.1" xref="S3.F2.7.m3.1.1.cmml"><mi id="S3.F2.7.m3.1.1.2" xref="S3.F2.7.m3.1.1.2.cmml">S</mi><mn id="S3.F2.7.m3.1.1.3" xref="S3.F2.7.m3.1.1.3.cmml">3</mn></msub><annotation-xml encoding="MathML-Content" id="S3.F2.7.m3.1c"><apply id="S3.F2.7.m3.1.1.cmml" xref="S3.F2.7.m3.1.1"><csymbol cd="ambiguous" id="S3.F2.7.m3.1.1.1.cmml" xref="S3.F2.7.m3.1.1">subscript</csymbol><ci id="S3.F2.7.m3.1.1.2.cmml" xref="S3.F2.7.m3.1.1.2">𝑆</ci><cn id="S3.F2.7.m3.1.1.3.cmml" type="integer" xref="S3.F2.7.m3.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.7.m3.1d">S_{3}</annotation><annotation encoding="application/x-llamapun" id="S3.F2.7.m3.1e">italic_S start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT</annotation></semantics></math>: Train Con-J using the DPO loss on contrastive judgments and the SFT loss on positive judgments. </figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="S3.p1">
<p class="ltx_p" id="S3.p1.9">Instead of using a scalar model for preference judgment, we propose to leverage the LLM itself to make preference judgments (<cite class="ltx_cite ltx_citemacro_cite">Guo et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03742v1#bib.bib10" title="">2024</a>); Lee et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03742v1#bib.bib20" title="">2023</a>)</cite>).
Given the question <math alttext="q" class="ltx_Math" display="inline" id="S3.p1.1.m1.1"><semantics id="S3.p1.1.m1.1a"><mi id="S3.p1.1.m1.1.1" xref="S3.p1.1.m1.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S3.p1.1.m1.1b"><ci id="S3.p1.1.m1.1.1.cmml" xref="S3.p1.1.m1.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.1.m1.1c">q</annotation><annotation encoding="application/x-llamapun" id="S3.p1.1.m1.1d">italic_q</annotation></semantics></math> and a pair of answers <math alttext="a^{1}" class="ltx_Math" display="inline" id="S3.p1.2.m2.1"><semantics id="S3.p1.2.m2.1a"><msup id="S3.p1.2.m2.1.1" xref="S3.p1.2.m2.1.1.cmml"><mi id="S3.p1.2.m2.1.1.2" xref="S3.p1.2.m2.1.1.2.cmml">a</mi><mn id="S3.p1.2.m2.1.1.3" xref="S3.p1.2.m2.1.1.3.cmml">1</mn></msup><annotation-xml encoding="MathML-Content" id="S3.p1.2.m2.1b"><apply id="S3.p1.2.m2.1.1.cmml" xref="S3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.p1.2.m2.1.1.1.cmml" xref="S3.p1.2.m2.1.1">superscript</csymbol><ci id="S3.p1.2.m2.1.1.2.cmml" xref="S3.p1.2.m2.1.1.2">𝑎</ci><cn id="S3.p1.2.m2.1.1.3.cmml" type="integer" xref="S3.p1.2.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.2.m2.1c">a^{1}</annotation><annotation encoding="application/x-llamapun" id="S3.p1.2.m2.1d">italic_a start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="a^{2}" class="ltx_Math" display="inline" id="S3.p1.3.m3.1"><semantics id="S3.p1.3.m3.1a"><msup id="S3.p1.3.m3.1.1" xref="S3.p1.3.m3.1.1.cmml"><mi id="S3.p1.3.m3.1.1.2" xref="S3.p1.3.m3.1.1.2.cmml">a</mi><mn id="S3.p1.3.m3.1.1.3" xref="S3.p1.3.m3.1.1.3.cmml">2</mn></msup><annotation-xml encoding="MathML-Content" id="S3.p1.3.m3.1b"><apply id="S3.p1.3.m3.1.1.cmml" xref="S3.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.p1.3.m3.1.1.1.cmml" xref="S3.p1.3.m3.1.1">superscript</csymbol><ci id="S3.p1.3.m3.1.1.2.cmml" xref="S3.p1.3.m3.1.1.2">𝑎</ci><cn id="S3.p1.3.m3.1.1.3.cmml" type="integer" xref="S3.p1.3.m3.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.3.m3.1c">a^{2}</annotation><annotation encoding="application/x-llamapun" id="S3.p1.3.m3.1d">italic_a start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math>, we construct a prompt <math alttext="p" class="ltx_Math" display="inline" id="S3.p1.4.m4.1"><semantics id="S3.p1.4.m4.1a"><mi id="S3.p1.4.m4.1.1" xref="S3.p1.4.m4.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="S3.p1.4.m4.1b"><ci id="S3.p1.4.m4.1.1.cmml" xref="S3.p1.4.m4.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.4.m4.1c">p</annotation><annotation encoding="application/x-llamapun" id="S3.p1.4.m4.1d">italic_p</annotation></semantics></math> by concatenating a preamble with <math alttext="q" class="ltx_Math" display="inline" id="S3.p1.5.m5.1"><semantics id="S3.p1.5.m5.1a"><mi id="S3.p1.5.m5.1.1" xref="S3.p1.5.m5.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S3.p1.5.m5.1b"><ci id="S3.p1.5.m5.1.1.cmml" xref="S3.p1.5.m5.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.5.m5.1c">q</annotation><annotation encoding="application/x-llamapun" id="S3.p1.5.m5.1d">italic_q</annotation></semantics></math>, <math alttext="a^{1}" class="ltx_Math" display="inline" id="S3.p1.6.m6.1"><semantics id="S3.p1.6.m6.1a"><msup id="S3.p1.6.m6.1.1" xref="S3.p1.6.m6.1.1.cmml"><mi id="S3.p1.6.m6.1.1.2" xref="S3.p1.6.m6.1.1.2.cmml">a</mi><mn id="S3.p1.6.m6.1.1.3" xref="S3.p1.6.m6.1.1.3.cmml">1</mn></msup><annotation-xml encoding="MathML-Content" id="S3.p1.6.m6.1b"><apply id="S3.p1.6.m6.1.1.cmml" xref="S3.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S3.p1.6.m6.1.1.1.cmml" xref="S3.p1.6.m6.1.1">superscript</csymbol><ci id="S3.p1.6.m6.1.1.2.cmml" xref="S3.p1.6.m6.1.1.2">𝑎</ci><cn id="S3.p1.6.m6.1.1.3.cmml" type="integer" xref="S3.p1.6.m6.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.6.m6.1c">a^{1}</annotation><annotation encoding="application/x-llamapun" id="S3.p1.6.m6.1d">italic_a start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT</annotation></semantics></math>, and <math alttext="a^{2}" class="ltx_Math" display="inline" id="S3.p1.7.m7.1"><semantics id="S3.p1.7.m7.1a"><msup id="S3.p1.7.m7.1.1" xref="S3.p1.7.m7.1.1.cmml"><mi id="S3.p1.7.m7.1.1.2" xref="S3.p1.7.m7.1.1.2.cmml">a</mi><mn id="S3.p1.7.m7.1.1.3" xref="S3.p1.7.m7.1.1.3.cmml">2</mn></msup><annotation-xml encoding="MathML-Content" id="S3.p1.7.m7.1b"><apply id="S3.p1.7.m7.1.1.cmml" xref="S3.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S3.p1.7.m7.1.1.1.cmml" xref="S3.p1.7.m7.1.1">superscript</csymbol><ci id="S3.p1.7.m7.1.1.2.cmml" xref="S3.p1.7.m7.1.1.2">𝑎</ci><cn id="S3.p1.7.m7.1.1.3.cmml" type="integer" xref="S3.p1.7.m7.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.7.m7.1c">a^{2}</annotation><annotation encoding="application/x-llamapun" id="S3.p1.7.m7.1d">italic_a start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math>.
The preamble is an instruction that describes the task and asks an LLM <math alttext="\pi" class="ltx_Math" display="inline" id="S3.p1.8.m8.1"><semantics id="S3.p1.8.m8.1a"><mi id="S3.p1.8.m8.1.1" xref="S3.p1.8.m8.1.1.cmml">π</mi><annotation-xml encoding="MathML-Content" id="S3.p1.8.m8.1b"><ci id="S3.p1.8.m8.1.1.cmml" xref="S3.p1.8.m8.1.1">𝜋</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.8.m8.1c">\pi</annotation><annotation encoding="application/x-llamapun" id="S3.p1.8.m8.1d">italic_π</annotation></semantics></math> to act as a judge (see examples in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.03742v1#S3.F2" title="Figure 2 ‣ 3 Improving Generative Judge by Training on Contrastive Judgments ‣ Beyond Scalar Reward Model: Learning Generative Judge from Preference Data"><span class="ltx_text ltx_ref_tag">2</span></a> and Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.03742v1#A1.T5" title="Table 5 ‣ Appendix A Appendix ‣ Beyond Scalar Reward Model: Learning Generative Judge from Preference Data"><span class="ltx_text ltx_ref_tag">5</span></a>).
Then the LLM generates natural language judgments <math alttext="j=\pi(p)" class="ltx_Math" display="inline" id="S3.p1.9.m9.1"><semantics id="S3.p1.9.m9.1a"><mrow id="S3.p1.9.m9.1.2" xref="S3.p1.9.m9.1.2.cmml"><mi id="S3.p1.9.m9.1.2.2" xref="S3.p1.9.m9.1.2.2.cmml">j</mi><mo id="S3.p1.9.m9.1.2.1" xref="S3.p1.9.m9.1.2.1.cmml">=</mo><mrow id="S3.p1.9.m9.1.2.3" xref="S3.p1.9.m9.1.2.3.cmml"><mi id="S3.p1.9.m9.1.2.3.2" xref="S3.p1.9.m9.1.2.3.2.cmml">π</mi><mo id="S3.p1.9.m9.1.2.3.1" xref="S3.p1.9.m9.1.2.3.1.cmml">⁢</mo><mrow id="S3.p1.9.m9.1.2.3.3.2" xref="S3.p1.9.m9.1.2.3.cmml"><mo id="S3.p1.9.m9.1.2.3.3.2.1" stretchy="false" xref="S3.p1.9.m9.1.2.3.cmml">(</mo><mi id="S3.p1.9.m9.1.1" xref="S3.p1.9.m9.1.1.cmml">p</mi><mo id="S3.p1.9.m9.1.2.3.3.2.2" stretchy="false" xref="S3.p1.9.m9.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.9.m9.1b"><apply id="S3.p1.9.m9.1.2.cmml" xref="S3.p1.9.m9.1.2"><eq id="S3.p1.9.m9.1.2.1.cmml" xref="S3.p1.9.m9.1.2.1"></eq><ci id="S3.p1.9.m9.1.2.2.cmml" xref="S3.p1.9.m9.1.2.2">𝑗</ci><apply id="S3.p1.9.m9.1.2.3.cmml" xref="S3.p1.9.m9.1.2.3"><times id="S3.p1.9.m9.1.2.3.1.cmml" xref="S3.p1.9.m9.1.2.3.1"></times><ci id="S3.p1.9.m9.1.2.3.2.cmml" xref="S3.p1.9.m9.1.2.3.2">𝜋</ci><ci id="S3.p1.9.m9.1.1.cmml" xref="S3.p1.9.m9.1.1">𝑝</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.9.m9.1c">j=\pi(p)</annotation><annotation encoding="application/x-llamapun" id="S3.p1.9.m9.1d">italic_j = italic_π ( italic_p )</annotation></semantics></math>, which contains the judgment as well as the rationale in a JSON style: a key named <span class="ltx_text ltx_font_typewriter" id="S3.p1.9.1">"rationale"</span> includes a step-by-step explanation and verification of the answers, and another key named <span class="ltx_text ltx_font_typewriter" id="S3.p1.9.2">"better_answer"</span> indicates the LLM’s binary judgment.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.p2">
<p class="ltx_p" id="S3.p2.1">As shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03742v1#S3.F2" title="Figure 2 ‣ 3 Improving Generative Judge by Training on Contrastive Judgments ‣ Beyond Scalar Reward Model: Learning Generative Judge from Preference Data"><span class="ltx_text ltx_ref_tag">2</span></a>, the construction of Con-J consists of three steps: <span class="ltx_text ltx_font_italic" id="S3.p2.1.1">judgment sampling</span>, <span class="ltx_text ltx_font_italic" id="S3.p2.1.2">judgment filtering</span>, and <span class="ltx_text ltx_font_italic" id="S3.p2.1.3">Con-J training</span>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.p3">
<p class="ltx_p" id="S3.p3.1"><span class="ltx_text ltx_font_italic" id="S3.p3.1.1">Judgment sampling:</span> We construct contrastive judgment pairs by prompting the LLM to generate multiple judgments.
As shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03742v1#S3.F2" title="Figure 2 ‣ 3 Improving Generative Judge by Training on Contrastive Judgments ‣ Beyond Scalar Reward Model: Learning Generative Judge from Preference Data"><span class="ltx_text ltx_ref_tag">2</span></a>, this is achieved by (1) <span class="ltx_text ltx_font_italic" id="S3.p3.1.2">repeated sampling</span> and (2) <span class="ltx_text ltx_font_italic" id="S3.p3.1.3">hint-driven sampling</span>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.p4">
<p class="ltx_p" id="S3.p4.2">Repeated sampling prompts the LLM to generate multiple outputs from the same prompt, each utilizing a different random seed during the generation process.
However, the LLM may produce only one-sided judgments (i.e., all judgments preferred <math alttext="a^{1}" class="ltx_Math" display="inline" id="S3.p4.1.m1.1"><semantics id="S3.p4.1.m1.1a"><msup id="S3.p4.1.m1.1.1" xref="S3.p4.1.m1.1.1.cmml"><mi id="S3.p4.1.m1.1.1.2" xref="S3.p4.1.m1.1.1.2.cmml">a</mi><mn id="S3.p4.1.m1.1.1.3" xref="S3.p4.1.m1.1.1.3.cmml">1</mn></msup><annotation-xml encoding="MathML-Content" id="S3.p4.1.m1.1b"><apply id="S3.p4.1.m1.1.1.cmml" xref="S3.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S3.p4.1.m1.1.1.1.cmml" xref="S3.p4.1.m1.1.1">superscript</csymbol><ci id="S3.p4.1.m1.1.1.2.cmml" xref="S3.p4.1.m1.1.1.2">𝑎</ci><cn id="S3.p4.1.m1.1.1.3.cmml" type="integer" xref="S3.p4.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.1.m1.1c">a^{1}</annotation><annotation encoding="application/x-llamapun" id="S3.p4.1.m1.1d">italic_a start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT</annotation></semantics></math> or <math alttext="a^{2}" class="ltx_Math" display="inline" id="S3.p4.2.m2.1"><semantics id="S3.p4.2.m2.1a"><msup id="S3.p4.2.m2.1.1" xref="S3.p4.2.m2.1.1.cmml"><mi id="S3.p4.2.m2.1.1.2" xref="S3.p4.2.m2.1.1.2.cmml">a</mi><mn id="S3.p4.2.m2.1.1.3" xref="S3.p4.2.m2.1.1.3.cmml">2</mn></msup><annotation-xml encoding="MathML-Content" id="S3.p4.2.m2.1b"><apply id="S3.p4.2.m2.1.1.cmml" xref="S3.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S3.p4.2.m2.1.1.1.cmml" xref="S3.p4.2.m2.1.1">superscript</csymbol><ci id="S3.p4.2.m2.1.1.2.cmml" xref="S3.p4.2.m2.1.1.2">𝑎</ci><cn id="S3.p4.2.m2.1.1.3.cmml" type="integer" xref="S3.p4.2.m2.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.2.m2.1c">a^{2}</annotation><annotation encoding="application/x-llamapun" id="S3.p4.2.m2.1d">italic_a start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math>) across all repeated samples.
In such cases, we cannot construct contrastive judgment pairs with repeated sampling.
Therefore, we propose hint-driven sampling to compel the LLM to generate judgments that favor specific answers.
Essentially, the LLM is provided with an explicit indication of which answer is better, and is instructed to generate the judgment accordingly in the same JSON format as above.
The prompt template for hint-driven sampling is provided in Table <a class="ltx_ref" href="https://arxiv.org/html/2410.03742v1#A1.T6" title="Table 6 ‣ Appendix A Appendix ‣ Beyond Scalar Reward Model: Learning Generative Judge from Preference Data"><span class="ltx_text ltx_ref_tag">6</span></a>.
By manipulating the hint, we can get a contrastive judgment pair for any prompt input.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.p5">
<p class="ltx_p" id="S3.p5.9"><span class="ltx_text ltx_font_italic" id="S3.p5.9.1">Judgment filtering:</span>
We denote the outputs from repeating sampling as <math alttext="M(p)" class="ltx_Math" display="inline" id="S3.p5.1.m1.1"><semantics id="S3.p5.1.m1.1a"><mrow id="S3.p5.1.m1.1.2" xref="S3.p5.1.m1.1.2.cmml"><mi id="S3.p5.1.m1.1.2.2" xref="S3.p5.1.m1.1.2.2.cmml">M</mi><mo id="S3.p5.1.m1.1.2.1" xref="S3.p5.1.m1.1.2.1.cmml">⁢</mo><mrow id="S3.p5.1.m1.1.2.3.2" xref="S3.p5.1.m1.1.2.cmml"><mo id="S3.p5.1.m1.1.2.3.2.1" stretchy="false" xref="S3.p5.1.m1.1.2.cmml">(</mo><mi id="S3.p5.1.m1.1.1" xref="S3.p5.1.m1.1.1.cmml">p</mi><mo id="S3.p5.1.m1.1.2.3.2.2" stretchy="false" xref="S3.p5.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p5.1.m1.1b"><apply id="S3.p5.1.m1.1.2.cmml" xref="S3.p5.1.m1.1.2"><times id="S3.p5.1.m1.1.2.1.cmml" xref="S3.p5.1.m1.1.2.1"></times><ci id="S3.p5.1.m1.1.2.2.cmml" xref="S3.p5.1.m1.1.2.2">𝑀</ci><ci id="S3.p5.1.m1.1.1.cmml" xref="S3.p5.1.m1.1.1">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p5.1.m1.1c">M(p)</annotation><annotation encoding="application/x-llamapun" id="S3.p5.1.m1.1d">italic_M ( italic_p )</annotation></semantics></math>.
<math alttext="M(p)" class="ltx_Math" display="inline" id="S3.p5.2.m2.1"><semantics id="S3.p5.2.m2.1a"><mrow id="S3.p5.2.m2.1.2" xref="S3.p5.2.m2.1.2.cmml"><mi id="S3.p5.2.m2.1.2.2" xref="S3.p5.2.m2.1.2.2.cmml">M</mi><mo id="S3.p5.2.m2.1.2.1" xref="S3.p5.2.m2.1.2.1.cmml">⁢</mo><mrow id="S3.p5.2.m2.1.2.3.2" xref="S3.p5.2.m2.1.2.cmml"><mo id="S3.p5.2.m2.1.2.3.2.1" stretchy="false" xref="S3.p5.2.m2.1.2.cmml">(</mo><mi id="S3.p5.2.m2.1.1" xref="S3.p5.2.m2.1.1.cmml">p</mi><mo id="S3.p5.2.m2.1.2.3.2.2" stretchy="false" xref="S3.p5.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p5.2.m2.1b"><apply id="S3.p5.2.m2.1.2.cmml" xref="S3.p5.2.m2.1.2"><times id="S3.p5.2.m2.1.2.1.cmml" xref="S3.p5.2.m2.1.2.1"></times><ci id="S3.p5.2.m2.1.2.2.cmml" xref="S3.p5.2.m2.1.2.2">𝑀</ci><ci id="S3.p5.2.m2.1.1.cmml" xref="S3.p5.2.m2.1.1">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p5.2.m2.1c">M(p)</annotation><annotation encoding="application/x-llamapun" id="S3.p5.2.m2.1d">italic_M ( italic_p )</annotation></semantics></math> can potentially include both “positive” and “negative” judgments.
A positive judgment indicates the judgment corresponding to the keyword <span class="ltx_text ltx_font_typewriter" id="S3.p5.9.2">"better_answer"</span> is correct (<math alttext="j^{+}" class="ltx_Math" display="inline" id="S3.p5.3.m3.1"><semantics id="S3.p5.3.m3.1a"><msup id="S3.p5.3.m3.1.1" xref="S3.p5.3.m3.1.1.cmml"><mi id="S3.p5.3.m3.1.1.2" xref="S3.p5.3.m3.1.1.2.cmml">j</mi><mo id="S3.p5.3.m3.1.1.3" xref="S3.p5.3.m3.1.1.3.cmml">+</mo></msup><annotation-xml encoding="MathML-Content" id="S3.p5.3.m3.1b"><apply id="S3.p5.3.m3.1.1.cmml" xref="S3.p5.3.m3.1.1"><csymbol cd="ambiguous" id="S3.p5.3.m3.1.1.1.cmml" xref="S3.p5.3.m3.1.1">superscript</csymbol><ci id="S3.p5.3.m3.1.1.2.cmml" xref="S3.p5.3.m3.1.1.2">𝑗</ci><plus id="S3.p5.3.m3.1.1.3.cmml" xref="S3.p5.3.m3.1.1.3"></plus></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p5.3.m3.1c">j^{+}</annotation><annotation encoding="application/x-llamapun" id="S3.p5.3.m3.1d">italic_j start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT</annotation></semantics></math>), while a negative judgment (<math alttext="j^{-}" class="ltx_Math" display="inline" id="S3.p5.4.m4.1"><semantics id="S3.p5.4.m4.1a"><msup id="S3.p5.4.m4.1.1" xref="S3.p5.4.m4.1.1.cmml"><mi id="S3.p5.4.m4.1.1.2" xref="S3.p5.4.m4.1.1.2.cmml">j</mi><mo id="S3.p5.4.m4.1.1.3" xref="S3.p5.4.m4.1.1.3.cmml">−</mo></msup><annotation-xml encoding="MathML-Content" id="S3.p5.4.m4.1b"><apply id="S3.p5.4.m4.1.1.cmml" xref="S3.p5.4.m4.1.1"><csymbol cd="ambiguous" id="S3.p5.4.m4.1.1.1.cmml" xref="S3.p5.4.m4.1.1">superscript</csymbol><ci id="S3.p5.4.m4.1.1.2.cmml" xref="S3.p5.4.m4.1.1.2">𝑗</ci><minus id="S3.p5.4.m4.1.1.3.cmml" xref="S3.p5.4.m4.1.1.3"></minus></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p5.4.m4.1c">j^{-}</annotation><annotation encoding="application/x-llamapun" id="S3.p5.4.m4.1d">italic_j start_POSTSUPERSCRIPT - end_POSTSUPERSCRIPT</annotation></semantics></math>) indicates the judgment is incorrect (<math alttext="j^{i}" class="ltx_Math" display="inline" id="S3.p5.5.m5.1"><semantics id="S3.p5.5.m5.1a"><msup id="S3.p5.5.m5.1.1" xref="S3.p5.5.m5.1.1.cmml"><mi id="S3.p5.5.m5.1.1.2" xref="S3.p5.5.m5.1.1.2.cmml">j</mi><mi id="S3.p5.5.m5.1.1.3" xref="S3.p5.5.m5.1.1.3.cmml">i</mi></msup><annotation-xml encoding="MathML-Content" id="S3.p5.5.m5.1b"><apply id="S3.p5.5.m5.1.1.cmml" xref="S3.p5.5.m5.1.1"><csymbol cd="ambiguous" id="S3.p5.5.m5.1.1.1.cmml" xref="S3.p5.5.m5.1.1">superscript</csymbol><ci id="S3.p5.5.m5.1.1.2.cmml" xref="S3.p5.5.m5.1.1.2">𝑗</ci><ci id="S3.p5.5.m5.1.1.3.cmml" xref="S3.p5.5.m5.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p5.5.m5.1c">j^{i}</annotation><annotation encoding="application/x-llamapun" id="S3.p5.5.m5.1d">italic_j start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT</annotation></semantics></math>) or the model doesn’t explicitly indicate its preference (<math alttext="j^{n}" class="ltx_Math" display="inline" id="S3.p5.6.m6.1"><semantics id="S3.p5.6.m6.1a"><msup id="S3.p5.6.m6.1.1" xref="S3.p5.6.m6.1.1.cmml"><mi id="S3.p5.6.m6.1.1.2" xref="S3.p5.6.m6.1.1.2.cmml">j</mi><mi id="S3.p5.6.m6.1.1.3" xref="S3.p5.6.m6.1.1.3.cmml">n</mi></msup><annotation-xml encoding="MathML-Content" id="S3.p5.6.m6.1b"><apply id="S3.p5.6.m6.1.1.cmml" xref="S3.p5.6.m6.1.1"><csymbol cd="ambiguous" id="S3.p5.6.m6.1.1.1.cmml" xref="S3.p5.6.m6.1.1">superscript</csymbol><ci id="S3.p5.6.m6.1.1.2.cmml" xref="S3.p5.6.m6.1.1.2">𝑗</ci><ci id="S3.p5.6.m6.1.1.3.cmml" xref="S3.p5.6.m6.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p5.6.m6.1c">j^{n}</annotation><annotation encoding="application/x-llamapun" id="S3.p5.6.m6.1d">italic_j start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT</annotation></semantics></math>).
Contrastive judgment pairs <math alttext="\{(j^{+},j^{-})\}" class="ltx_Math" display="inline" id="S3.p5.7.m7.1"><semantics id="S3.p5.7.m7.1a"><mrow id="S3.p5.7.m7.1.1.1" xref="S3.p5.7.m7.1.1.2.cmml"><mo id="S3.p5.7.m7.1.1.1.2" stretchy="false" xref="S3.p5.7.m7.1.1.2.cmml">{</mo><mrow id="S3.p5.7.m7.1.1.1.1.2" xref="S3.p5.7.m7.1.1.1.1.3.cmml"><mo id="S3.p5.7.m7.1.1.1.1.2.3" stretchy="false" xref="S3.p5.7.m7.1.1.1.1.3.cmml">(</mo><msup id="S3.p5.7.m7.1.1.1.1.1.1" xref="S3.p5.7.m7.1.1.1.1.1.1.cmml"><mi id="S3.p5.7.m7.1.1.1.1.1.1.2" xref="S3.p5.7.m7.1.1.1.1.1.1.2.cmml">j</mi><mo id="S3.p5.7.m7.1.1.1.1.1.1.3" xref="S3.p5.7.m7.1.1.1.1.1.1.3.cmml">+</mo></msup><mo id="S3.p5.7.m7.1.1.1.1.2.4" xref="S3.p5.7.m7.1.1.1.1.3.cmml">,</mo><msup id="S3.p5.7.m7.1.1.1.1.2.2" xref="S3.p5.7.m7.1.1.1.1.2.2.cmml"><mi id="S3.p5.7.m7.1.1.1.1.2.2.2" xref="S3.p5.7.m7.1.1.1.1.2.2.2.cmml">j</mi><mo id="S3.p5.7.m7.1.1.1.1.2.2.3" xref="S3.p5.7.m7.1.1.1.1.2.2.3.cmml">−</mo></msup><mo id="S3.p5.7.m7.1.1.1.1.2.5" stretchy="false" xref="S3.p5.7.m7.1.1.1.1.3.cmml">)</mo></mrow><mo id="S3.p5.7.m7.1.1.1.3" stretchy="false" xref="S3.p5.7.m7.1.1.2.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.p5.7.m7.1b"><set id="S3.p5.7.m7.1.1.2.cmml" xref="S3.p5.7.m7.1.1.1"><interval closure="open" id="S3.p5.7.m7.1.1.1.1.3.cmml" xref="S3.p5.7.m7.1.1.1.1.2"><apply id="S3.p5.7.m7.1.1.1.1.1.1.cmml" xref="S3.p5.7.m7.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.p5.7.m7.1.1.1.1.1.1.1.cmml" xref="S3.p5.7.m7.1.1.1.1.1.1">superscript</csymbol><ci id="S3.p5.7.m7.1.1.1.1.1.1.2.cmml" xref="S3.p5.7.m7.1.1.1.1.1.1.2">𝑗</ci><plus id="S3.p5.7.m7.1.1.1.1.1.1.3.cmml" xref="S3.p5.7.m7.1.1.1.1.1.1.3"></plus></apply><apply id="S3.p5.7.m7.1.1.1.1.2.2.cmml" xref="S3.p5.7.m7.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.p5.7.m7.1.1.1.1.2.2.1.cmml" xref="S3.p5.7.m7.1.1.1.1.2.2">superscript</csymbol><ci id="S3.p5.7.m7.1.1.1.1.2.2.2.cmml" xref="S3.p5.7.m7.1.1.1.1.2.2.2">𝑗</ci><minus id="S3.p5.7.m7.1.1.1.1.2.2.3.cmml" xref="S3.p5.7.m7.1.1.1.1.2.2.3"></minus></apply></interval></set></annotation-xml><annotation encoding="application/x-tex" id="S3.p5.7.m7.1c">\{(j^{+},j^{-})\}</annotation><annotation encoding="application/x-llamapun" id="S3.p5.7.m7.1d">{ ( italic_j start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT , italic_j start_POSTSUPERSCRIPT - end_POSTSUPERSCRIPT ) }</annotation></semantics></math> are hence constructed as the direct product of the positive judgment set <math alttext="M(p)^{+}" class="ltx_Math" display="inline" id="S3.p5.8.m8.1"><semantics id="S3.p5.8.m8.1a"><mrow id="S3.p5.8.m8.1.2" xref="S3.p5.8.m8.1.2.cmml"><mi id="S3.p5.8.m8.1.2.2" xref="S3.p5.8.m8.1.2.2.cmml">M</mi><mo id="S3.p5.8.m8.1.2.1" xref="S3.p5.8.m8.1.2.1.cmml">⁢</mo><msup id="S3.p5.8.m8.1.2.3" xref="S3.p5.8.m8.1.2.3.cmml"><mrow id="S3.p5.8.m8.1.2.3.2.2" xref="S3.p5.8.m8.1.2.3.cmml"><mo id="S3.p5.8.m8.1.2.3.2.2.1" stretchy="false" xref="S3.p5.8.m8.1.2.3.cmml">(</mo><mi id="S3.p5.8.m8.1.1" xref="S3.p5.8.m8.1.1.cmml">p</mi><mo id="S3.p5.8.m8.1.2.3.2.2.2" stretchy="false" xref="S3.p5.8.m8.1.2.3.cmml">)</mo></mrow><mo id="S3.p5.8.m8.1.2.3.3" xref="S3.p5.8.m8.1.2.3.3.cmml">+</mo></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.p5.8.m8.1b"><apply id="S3.p5.8.m8.1.2.cmml" xref="S3.p5.8.m8.1.2"><times id="S3.p5.8.m8.1.2.1.cmml" xref="S3.p5.8.m8.1.2.1"></times><ci id="S3.p5.8.m8.1.2.2.cmml" xref="S3.p5.8.m8.1.2.2">𝑀</ci><apply id="S3.p5.8.m8.1.2.3.cmml" xref="S3.p5.8.m8.1.2.3"><csymbol cd="ambiguous" id="S3.p5.8.m8.1.2.3.1.cmml" xref="S3.p5.8.m8.1.2.3">superscript</csymbol><ci id="S3.p5.8.m8.1.1.cmml" xref="S3.p5.8.m8.1.1">𝑝</ci><plus id="S3.p5.8.m8.1.2.3.3.cmml" xref="S3.p5.8.m8.1.2.3.3"></plus></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p5.8.m8.1c">M(p)^{+}</annotation><annotation encoding="application/x-llamapun" id="S3.p5.8.m8.1d">italic_M ( italic_p ) start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT</annotation></semantics></math> and negative judgment set <math alttext="M(p)^{-}" class="ltx_Math" display="inline" id="S3.p5.9.m9.1"><semantics id="S3.p5.9.m9.1a"><mrow id="S3.p5.9.m9.1.2" xref="S3.p5.9.m9.1.2.cmml"><mi id="S3.p5.9.m9.1.2.2" xref="S3.p5.9.m9.1.2.2.cmml">M</mi><mo id="S3.p5.9.m9.1.2.1" xref="S3.p5.9.m9.1.2.1.cmml">⁢</mo><msup id="S3.p5.9.m9.1.2.3" xref="S3.p5.9.m9.1.2.3.cmml"><mrow id="S3.p5.9.m9.1.2.3.2.2" xref="S3.p5.9.m9.1.2.3.cmml"><mo id="S3.p5.9.m9.1.2.3.2.2.1" stretchy="false" xref="S3.p5.9.m9.1.2.3.cmml">(</mo><mi id="S3.p5.9.m9.1.1" xref="S3.p5.9.m9.1.1.cmml">p</mi><mo id="S3.p5.9.m9.1.2.3.2.2.2" stretchy="false" xref="S3.p5.9.m9.1.2.3.cmml">)</mo></mrow><mo id="S3.p5.9.m9.1.2.3.3" xref="S3.p5.9.m9.1.2.3.3.cmml">−</mo></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.p5.9.m9.1b"><apply id="S3.p5.9.m9.1.2.cmml" xref="S3.p5.9.m9.1.2"><times id="S3.p5.9.m9.1.2.1.cmml" xref="S3.p5.9.m9.1.2.1"></times><ci id="S3.p5.9.m9.1.2.2.cmml" xref="S3.p5.9.m9.1.2.2">𝑀</ci><apply id="S3.p5.9.m9.1.2.3.cmml" xref="S3.p5.9.m9.1.2.3"><csymbol cd="ambiguous" id="S3.p5.9.m9.1.2.3.1.cmml" xref="S3.p5.9.m9.1.2.3">superscript</csymbol><ci id="S3.p5.9.m9.1.1.cmml" xref="S3.p5.9.m9.1.1">𝑝</ci><minus id="S3.p5.9.m9.1.2.3.3.cmml" xref="S3.p5.9.m9.1.2.3.3"></minus></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p5.9.m9.1c">M(p)^{-}</annotation><annotation encoding="application/x-llamapun" id="S3.p5.9.m9.1d">italic_M ( italic_p ) start_POSTSUPERSCRIPT - end_POSTSUPERSCRIPT</annotation></semantics></math>.
We set the number of repeated samplings to 8, allowing for the construction of up to 4 pairs (in the optimal case, there exist 4 positive and 4 negative judgments among the 8).
For hint-driven sampling, we prompt the LLM with one correct and one incorrect hint and construct one pair from them.
The detailed sampling and filtering process is outlined in Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2410.03742v1#alg1" title="Algorithm 1 ‣ Appendix A Appendix ‣ Beyond Scalar Reward Model: Learning Generative Judge from Preference Data"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.p6">
<p class="ltx_p" id="S3.p6.2"><span class="ltx_text ltx_font_italic" id="S3.p6.2.1">Con-J training:</span> Based on the constructed judgment pairs <math alttext="D^{J}=\{(q,a^{+},a^{-},j^{+},j^{-})_{i}\}_{i=1}^{K}" class="ltx_Math" display="inline" id="S3.p6.1.m1.2"><semantics id="S3.p6.1.m1.2a"><mrow id="S3.p6.1.m1.2.2" xref="S3.p6.1.m1.2.2.cmml"><msup id="S3.p6.1.m1.2.2.3" xref="S3.p6.1.m1.2.2.3.cmml"><mi id="S3.p6.1.m1.2.2.3.2" xref="S3.p6.1.m1.2.2.3.2.cmml">D</mi><mi id="S3.p6.1.m1.2.2.3.3" xref="S3.p6.1.m1.2.2.3.3.cmml">J</mi></msup><mo id="S3.p6.1.m1.2.2.2" xref="S3.p6.1.m1.2.2.2.cmml">=</mo><msubsup id="S3.p6.1.m1.2.2.1" xref="S3.p6.1.m1.2.2.1.cmml"><mrow id="S3.p6.1.m1.2.2.1.1.1.1" xref="S3.p6.1.m1.2.2.1.1.1.2.cmml"><mo id="S3.p6.1.m1.2.2.1.1.1.1.2" stretchy="false" xref="S3.p6.1.m1.2.2.1.1.1.2.cmml">{</mo><msub id="S3.p6.1.m1.2.2.1.1.1.1.1" xref="S3.p6.1.m1.2.2.1.1.1.1.1.cmml"><mrow id="S3.p6.1.m1.2.2.1.1.1.1.1.4.4" xref="S3.p6.1.m1.2.2.1.1.1.1.1.4.5.cmml"><mo id="S3.p6.1.m1.2.2.1.1.1.1.1.4.4.5" stretchy="false" xref="S3.p6.1.m1.2.2.1.1.1.1.1.4.5.cmml">(</mo><mi id="S3.p6.1.m1.1.1" xref="S3.p6.1.m1.1.1.cmml">q</mi><mo id="S3.p6.1.m1.2.2.1.1.1.1.1.4.4.6" xref="S3.p6.1.m1.2.2.1.1.1.1.1.4.5.cmml">,</mo><msup id="S3.p6.1.m1.2.2.1.1.1.1.1.1.1.1" xref="S3.p6.1.m1.2.2.1.1.1.1.1.1.1.1.cmml"><mi id="S3.p6.1.m1.2.2.1.1.1.1.1.1.1.1.2" xref="S3.p6.1.m1.2.2.1.1.1.1.1.1.1.1.2.cmml">a</mi><mo id="S3.p6.1.m1.2.2.1.1.1.1.1.1.1.1.3" xref="S3.p6.1.m1.2.2.1.1.1.1.1.1.1.1.3.cmml">+</mo></msup><mo id="S3.p6.1.m1.2.2.1.1.1.1.1.4.4.7" xref="S3.p6.1.m1.2.2.1.1.1.1.1.4.5.cmml">,</mo><msup id="S3.p6.1.m1.2.2.1.1.1.1.1.2.2.2" xref="S3.p6.1.m1.2.2.1.1.1.1.1.2.2.2.cmml"><mi id="S3.p6.1.m1.2.2.1.1.1.1.1.2.2.2.2" xref="S3.p6.1.m1.2.2.1.1.1.1.1.2.2.2.2.cmml">a</mi><mo id="S3.p6.1.m1.2.2.1.1.1.1.1.2.2.2.3" xref="S3.p6.1.m1.2.2.1.1.1.1.1.2.2.2.3.cmml">−</mo></msup><mo id="S3.p6.1.m1.2.2.1.1.1.1.1.4.4.8" xref="S3.p6.1.m1.2.2.1.1.1.1.1.4.5.cmml">,</mo><msup id="S3.p6.1.m1.2.2.1.1.1.1.1.3.3.3" xref="S3.p6.1.m1.2.2.1.1.1.1.1.3.3.3.cmml"><mi id="S3.p6.1.m1.2.2.1.1.1.1.1.3.3.3.2" xref="S3.p6.1.m1.2.2.1.1.1.1.1.3.3.3.2.cmml">j</mi><mo id="S3.p6.1.m1.2.2.1.1.1.1.1.3.3.3.3" xref="S3.p6.1.m1.2.2.1.1.1.1.1.3.3.3.3.cmml">+</mo></msup><mo id="S3.p6.1.m1.2.2.1.1.1.1.1.4.4.9" xref="S3.p6.1.m1.2.2.1.1.1.1.1.4.5.cmml">,</mo><msup id="S3.p6.1.m1.2.2.1.1.1.1.1.4.4.4" xref="S3.p6.1.m1.2.2.1.1.1.1.1.4.4.4.cmml"><mi id="S3.p6.1.m1.2.2.1.1.1.1.1.4.4.4.2" xref="S3.p6.1.m1.2.2.1.1.1.1.1.4.4.4.2.cmml">j</mi><mo id="S3.p6.1.m1.2.2.1.1.1.1.1.4.4.4.3" xref="S3.p6.1.m1.2.2.1.1.1.1.1.4.4.4.3.cmml">−</mo></msup><mo id="S3.p6.1.m1.2.2.1.1.1.1.1.4.4.10" stretchy="false" xref="S3.p6.1.m1.2.2.1.1.1.1.1.4.5.cmml">)</mo></mrow><mi id="S3.p6.1.m1.2.2.1.1.1.1.1.6" xref="S3.p6.1.m1.2.2.1.1.1.1.1.6.cmml">i</mi></msub><mo id="S3.p6.1.m1.2.2.1.1.1.1.3" stretchy="false" xref="S3.p6.1.m1.2.2.1.1.1.2.cmml">}</mo></mrow><mrow id="S3.p6.1.m1.2.2.1.1.3" xref="S3.p6.1.m1.2.2.1.1.3.cmml"><mi id="S3.p6.1.m1.2.2.1.1.3.2" xref="S3.p6.1.m1.2.2.1.1.3.2.cmml">i</mi><mo id="S3.p6.1.m1.2.2.1.1.3.1" xref="S3.p6.1.m1.2.2.1.1.3.1.cmml">=</mo><mn id="S3.p6.1.m1.2.2.1.1.3.3" xref="S3.p6.1.m1.2.2.1.1.3.3.cmml">1</mn></mrow><mi id="S3.p6.1.m1.2.2.1.3" xref="S3.p6.1.m1.2.2.1.3.cmml">K</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S3.p6.1.m1.2b"><apply id="S3.p6.1.m1.2.2.cmml" xref="S3.p6.1.m1.2.2"><eq id="S3.p6.1.m1.2.2.2.cmml" xref="S3.p6.1.m1.2.2.2"></eq><apply id="S3.p6.1.m1.2.2.3.cmml" xref="S3.p6.1.m1.2.2.3"><csymbol cd="ambiguous" id="S3.p6.1.m1.2.2.3.1.cmml" xref="S3.p6.1.m1.2.2.3">superscript</csymbol><ci id="S3.p6.1.m1.2.2.3.2.cmml" xref="S3.p6.1.m1.2.2.3.2">𝐷</ci><ci id="S3.p6.1.m1.2.2.3.3.cmml" xref="S3.p6.1.m1.2.2.3.3">𝐽</ci></apply><apply id="S3.p6.1.m1.2.2.1.cmml" xref="S3.p6.1.m1.2.2.1"><csymbol cd="ambiguous" id="S3.p6.1.m1.2.2.1.2.cmml" xref="S3.p6.1.m1.2.2.1">superscript</csymbol><apply id="S3.p6.1.m1.2.2.1.1.cmml" xref="S3.p6.1.m1.2.2.1"><csymbol cd="ambiguous" id="S3.p6.1.m1.2.2.1.1.2.cmml" xref="S3.p6.1.m1.2.2.1">subscript</csymbol><set id="S3.p6.1.m1.2.2.1.1.1.2.cmml" xref="S3.p6.1.m1.2.2.1.1.1.1"><apply id="S3.p6.1.m1.2.2.1.1.1.1.1.cmml" xref="S3.p6.1.m1.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.p6.1.m1.2.2.1.1.1.1.1.5.cmml" xref="S3.p6.1.m1.2.2.1.1.1.1.1">subscript</csymbol><vector id="S3.p6.1.m1.2.2.1.1.1.1.1.4.5.cmml" xref="S3.p6.1.m1.2.2.1.1.1.1.1.4.4"><ci id="S3.p6.1.m1.1.1.cmml" xref="S3.p6.1.m1.1.1">𝑞</ci><apply id="S3.p6.1.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S3.p6.1.m1.2.2.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.p6.1.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S3.p6.1.m1.2.2.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.p6.1.m1.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="S3.p6.1.m1.2.2.1.1.1.1.1.1.1.1.2">𝑎</ci><plus id="S3.p6.1.m1.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="S3.p6.1.m1.2.2.1.1.1.1.1.1.1.1.3"></plus></apply><apply id="S3.p6.1.m1.2.2.1.1.1.1.1.2.2.2.cmml" xref="S3.p6.1.m1.2.2.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.p6.1.m1.2.2.1.1.1.1.1.2.2.2.1.cmml" xref="S3.p6.1.m1.2.2.1.1.1.1.1.2.2.2">superscript</csymbol><ci id="S3.p6.1.m1.2.2.1.1.1.1.1.2.2.2.2.cmml" xref="S3.p6.1.m1.2.2.1.1.1.1.1.2.2.2.2">𝑎</ci><minus id="S3.p6.1.m1.2.2.1.1.1.1.1.2.2.2.3.cmml" xref="S3.p6.1.m1.2.2.1.1.1.1.1.2.2.2.3"></minus></apply><apply id="S3.p6.1.m1.2.2.1.1.1.1.1.3.3.3.cmml" xref="S3.p6.1.m1.2.2.1.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.p6.1.m1.2.2.1.1.1.1.1.3.3.3.1.cmml" xref="S3.p6.1.m1.2.2.1.1.1.1.1.3.3.3">superscript</csymbol><ci id="S3.p6.1.m1.2.2.1.1.1.1.1.3.3.3.2.cmml" xref="S3.p6.1.m1.2.2.1.1.1.1.1.3.3.3.2">𝑗</ci><plus id="S3.p6.1.m1.2.2.1.1.1.1.1.3.3.3.3.cmml" xref="S3.p6.1.m1.2.2.1.1.1.1.1.3.3.3.3"></plus></apply><apply id="S3.p6.1.m1.2.2.1.1.1.1.1.4.4.4.cmml" xref="S3.p6.1.m1.2.2.1.1.1.1.1.4.4.4"><csymbol cd="ambiguous" id="S3.p6.1.m1.2.2.1.1.1.1.1.4.4.4.1.cmml" xref="S3.p6.1.m1.2.2.1.1.1.1.1.4.4.4">superscript</csymbol><ci id="S3.p6.1.m1.2.2.1.1.1.1.1.4.4.4.2.cmml" xref="S3.p6.1.m1.2.2.1.1.1.1.1.4.4.4.2">𝑗</ci><minus id="S3.p6.1.m1.2.2.1.1.1.1.1.4.4.4.3.cmml" xref="S3.p6.1.m1.2.2.1.1.1.1.1.4.4.4.3"></minus></apply></vector><ci id="S3.p6.1.m1.2.2.1.1.1.1.1.6.cmml" xref="S3.p6.1.m1.2.2.1.1.1.1.1.6">𝑖</ci></apply></set><apply id="S3.p6.1.m1.2.2.1.1.3.cmml" xref="S3.p6.1.m1.2.2.1.1.3"><eq id="S3.p6.1.m1.2.2.1.1.3.1.cmml" xref="S3.p6.1.m1.2.2.1.1.3.1"></eq><ci id="S3.p6.1.m1.2.2.1.1.3.2.cmml" xref="S3.p6.1.m1.2.2.1.1.3.2">𝑖</ci><cn id="S3.p6.1.m1.2.2.1.1.3.3.cmml" type="integer" xref="S3.p6.1.m1.2.2.1.1.3.3">1</cn></apply></apply><ci id="S3.p6.1.m1.2.2.1.3.cmml" xref="S3.p6.1.m1.2.2.1.3">𝐾</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p6.1.m1.2c">D^{J}=\{(q,a^{+},a^{-},j^{+},j^{-})_{i}\}_{i=1}^{K}</annotation><annotation encoding="application/x-llamapun" id="S3.p6.1.m1.2d">italic_D start_POSTSUPERSCRIPT italic_J end_POSTSUPERSCRIPT = { ( italic_q , italic_a start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT , italic_a start_POSTSUPERSCRIPT - end_POSTSUPERSCRIPT , italic_j start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT , italic_j start_POSTSUPERSCRIPT - end_POSTSUPERSCRIPT ) start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT } start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT</annotation></semantics></math>, we train the LLM <math alttext="\pi" class="ltx_Math" display="inline" id="S3.p6.2.m2.1"><semantics id="S3.p6.2.m2.1a"><mi id="S3.p6.2.m2.1.1" xref="S3.p6.2.m2.1.1.cmml">π</mi><annotation-xml encoding="MathML-Content" id="S3.p6.2.m2.1b"><ci id="S3.p6.2.m2.1.1.cmml" xref="S3.p6.2.m2.1.1">𝜋</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p6.2.m2.1c">\pi</annotation><annotation encoding="application/x-llamapun" id="S3.p6.2.m2.1d">italic_π</annotation></semantics></math> with a  <span class="ltx_glossaryref" title="direct preference optimization"><span class="ltx_text ltx_glossary_long">direct preference optimization</span></span> (<abbr class="ltx_glossaryref" title="direct preference optimization"><span class="ltx_text ltx_glossary_short">DPO</span></abbr>) loss function:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\ell^{\text{DPO}}=-\sum_{(p,j^{+},j^{-})}\log\sigma\left[\eta\log\frac{\pi({j}%
^{+}|p)}{\pi_{0}({j}^{+}|p)}-\eta\log\frac{\pi({j}^{-}|p)}{\pi_{0}({j}^{-}|p)}\right]" class="ltx_Math" display="block" id="S3.E4.m1.8"><semantics id="S3.E4.m1.8a"><mrow id="S3.E4.m1.8.8" xref="S3.E4.m1.8.8.cmml"><msup id="S3.E4.m1.8.8.3" xref="S3.E4.m1.8.8.3.cmml"><mi id="S3.E4.m1.8.8.3.2" mathvariant="normal" xref="S3.E4.m1.8.8.3.2.cmml">ℓ</mi><mtext id="S3.E4.m1.8.8.3.3" xref="S3.E4.m1.8.8.3.3a.cmml">DPO</mtext></msup><mo id="S3.E4.m1.8.8.2" xref="S3.E4.m1.8.8.2.cmml">=</mo><mrow id="S3.E4.m1.8.8.1" xref="S3.E4.m1.8.8.1.cmml"><mo id="S3.E4.m1.8.8.1a" xref="S3.E4.m1.8.8.1.cmml">−</mo><mrow id="S3.E4.m1.8.8.1.1" xref="S3.E4.m1.8.8.1.1.cmml"><munder id="S3.E4.m1.8.8.1.1.2" xref="S3.E4.m1.8.8.1.1.2.cmml"><mo id="S3.E4.m1.8.8.1.1.2.2" movablelimits="false" xref="S3.E4.m1.8.8.1.1.2.2.cmml">∑</mo><mrow id="S3.E4.m1.3.3.3.3" xref="S3.E4.m1.3.3.3.4.cmml"><mo id="S3.E4.m1.3.3.3.3.3" stretchy="false" xref="S3.E4.m1.3.3.3.4.cmml">(</mo><mi id="S3.E4.m1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.cmml">p</mi><mo id="S3.E4.m1.3.3.3.3.4" xref="S3.E4.m1.3.3.3.4.cmml">,</mo><msup id="S3.E4.m1.2.2.2.2.1" xref="S3.E4.m1.2.2.2.2.1.cmml"><mi id="S3.E4.m1.2.2.2.2.1.2" xref="S3.E4.m1.2.2.2.2.1.2.cmml">j</mi><mo id="S3.E4.m1.2.2.2.2.1.3" xref="S3.E4.m1.2.2.2.2.1.3.cmml">+</mo></msup><mo id="S3.E4.m1.3.3.3.3.5" xref="S3.E4.m1.3.3.3.4.cmml">,</mo><msup id="S3.E4.m1.3.3.3.3.2" xref="S3.E4.m1.3.3.3.3.2.cmml"><mi id="S3.E4.m1.3.3.3.3.2.2" xref="S3.E4.m1.3.3.3.3.2.2.cmml">j</mi><mo id="S3.E4.m1.3.3.3.3.2.3" xref="S3.E4.m1.3.3.3.3.2.3.cmml">−</mo></msup><mo id="S3.E4.m1.3.3.3.3.6" stretchy="false" xref="S3.E4.m1.3.3.3.4.cmml">)</mo></mrow></munder><mrow id="S3.E4.m1.8.8.1.1.1" xref="S3.E4.m1.8.8.1.1.1.cmml"><mrow id="S3.E4.m1.8.8.1.1.1.3" xref="S3.E4.m1.8.8.1.1.1.3.cmml"><mi id="S3.E4.m1.8.8.1.1.1.3.1" xref="S3.E4.m1.8.8.1.1.1.3.1.cmml">log</mi><mo id="S3.E4.m1.8.8.1.1.1.3a" lspace="0.167em" xref="S3.E4.m1.8.8.1.1.1.3.cmml">⁡</mo><mi id="S3.E4.m1.8.8.1.1.1.3.2" xref="S3.E4.m1.8.8.1.1.1.3.2.cmml">σ</mi></mrow><mo id="S3.E4.m1.8.8.1.1.1.2" xref="S3.E4.m1.8.8.1.1.1.2.cmml">⁢</mo><mrow id="S3.E4.m1.8.8.1.1.1.1.1" xref="S3.E4.m1.8.8.1.1.1.1.2.cmml"><mo id="S3.E4.m1.8.8.1.1.1.1.1.2" xref="S3.E4.m1.8.8.1.1.1.1.2.1.cmml">[</mo><mrow id="S3.E4.m1.8.8.1.1.1.1.1.1" xref="S3.E4.m1.8.8.1.1.1.1.1.1.cmml"><mrow id="S3.E4.m1.8.8.1.1.1.1.1.1.2" xref="S3.E4.m1.8.8.1.1.1.1.1.1.2.cmml"><mi id="S3.E4.m1.8.8.1.1.1.1.1.1.2.2" xref="S3.E4.m1.8.8.1.1.1.1.1.1.2.2.cmml">η</mi><mo id="S3.E4.m1.8.8.1.1.1.1.1.1.2.1" lspace="0.167em" xref="S3.E4.m1.8.8.1.1.1.1.1.1.2.1.cmml">⁢</mo><mrow id="S3.E4.m1.8.8.1.1.1.1.1.1.2.3" xref="S3.E4.m1.8.8.1.1.1.1.1.1.2.3.cmml"><mi id="S3.E4.m1.8.8.1.1.1.1.1.1.2.3.1" xref="S3.E4.m1.8.8.1.1.1.1.1.1.2.3.1.cmml">log</mi><mo id="S3.E4.m1.8.8.1.1.1.1.1.1.2.3a" lspace="0.167em" xref="S3.E4.m1.8.8.1.1.1.1.1.1.2.3.cmml">⁡</mo><mfrac id="S3.E4.m1.5.5" xref="S3.E4.m1.5.5.cmml"><mrow id="S3.E4.m1.4.4.1" xref="S3.E4.m1.4.4.1.cmml"><mi id="S3.E4.m1.4.4.1.3" xref="S3.E4.m1.4.4.1.3.cmml">π</mi><mo id="S3.E4.m1.4.4.1.2" xref="S3.E4.m1.4.4.1.2.cmml">⁢</mo><mrow id="S3.E4.m1.4.4.1.1.1" xref="S3.E4.m1.4.4.1.1.1.1.cmml"><mo id="S3.E4.m1.4.4.1.1.1.2" stretchy="false" xref="S3.E4.m1.4.4.1.1.1.1.cmml">(</mo><mrow id="S3.E4.m1.4.4.1.1.1.1" xref="S3.E4.m1.4.4.1.1.1.1.cmml"><msup id="S3.E4.m1.4.4.1.1.1.1.2" xref="S3.E4.m1.4.4.1.1.1.1.2.cmml"><mi id="S3.E4.m1.4.4.1.1.1.1.2.2" xref="S3.E4.m1.4.4.1.1.1.1.2.2.cmml">j</mi><mo id="S3.E4.m1.4.4.1.1.1.1.2.3" xref="S3.E4.m1.4.4.1.1.1.1.2.3.cmml">+</mo></msup><mo fence="false" id="S3.E4.m1.4.4.1.1.1.1.1" xref="S3.E4.m1.4.4.1.1.1.1.1.cmml">|</mo><mi id="S3.E4.m1.4.4.1.1.1.1.3" xref="S3.E4.m1.4.4.1.1.1.1.3.cmml">p</mi></mrow><mo id="S3.E4.m1.4.4.1.1.1.3" stretchy="false" xref="S3.E4.m1.4.4.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="S3.E4.m1.5.5.2" xref="S3.E4.m1.5.5.2.cmml"><msub id="S3.E4.m1.5.5.2.3" xref="S3.E4.m1.5.5.2.3.cmml"><mi id="S3.E4.m1.5.5.2.3.2" xref="S3.E4.m1.5.5.2.3.2.cmml">π</mi><mn id="S3.E4.m1.5.5.2.3.3" xref="S3.E4.m1.5.5.2.3.3.cmml">0</mn></msub><mo id="S3.E4.m1.5.5.2.2" xref="S3.E4.m1.5.5.2.2.cmml">⁢</mo><mrow id="S3.E4.m1.5.5.2.1.1" xref="S3.E4.m1.5.5.2.1.1.1.cmml"><mo id="S3.E4.m1.5.5.2.1.1.2" stretchy="false" xref="S3.E4.m1.5.5.2.1.1.1.cmml">(</mo><mrow id="S3.E4.m1.5.5.2.1.1.1" xref="S3.E4.m1.5.5.2.1.1.1.cmml"><msup id="S3.E4.m1.5.5.2.1.1.1.2" xref="S3.E4.m1.5.5.2.1.1.1.2.cmml"><mi id="S3.E4.m1.5.5.2.1.1.1.2.2" xref="S3.E4.m1.5.5.2.1.1.1.2.2.cmml">j</mi><mo id="S3.E4.m1.5.5.2.1.1.1.2.3" xref="S3.E4.m1.5.5.2.1.1.1.2.3.cmml">+</mo></msup><mo fence="false" id="S3.E4.m1.5.5.2.1.1.1.1" xref="S3.E4.m1.5.5.2.1.1.1.1.cmml">|</mo><mi id="S3.E4.m1.5.5.2.1.1.1.3" xref="S3.E4.m1.5.5.2.1.1.1.3.cmml">p</mi></mrow><mo id="S3.E4.m1.5.5.2.1.1.3" stretchy="false" xref="S3.E4.m1.5.5.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mrow></mrow><mo id="S3.E4.m1.8.8.1.1.1.1.1.1.1" xref="S3.E4.m1.8.8.1.1.1.1.1.1.1.cmml">−</mo><mrow id="S3.E4.m1.8.8.1.1.1.1.1.1.3" xref="S3.E4.m1.8.8.1.1.1.1.1.1.3.cmml"><mi id="S3.E4.m1.8.8.1.1.1.1.1.1.3.2" xref="S3.E4.m1.8.8.1.1.1.1.1.1.3.2.cmml">η</mi><mo id="S3.E4.m1.8.8.1.1.1.1.1.1.3.1" lspace="0.167em" xref="S3.E4.m1.8.8.1.1.1.1.1.1.3.1.cmml">⁢</mo><mrow id="S3.E4.m1.8.8.1.1.1.1.1.1.3.3" xref="S3.E4.m1.8.8.1.1.1.1.1.1.3.3.cmml"><mi id="S3.E4.m1.8.8.1.1.1.1.1.1.3.3.1" xref="S3.E4.m1.8.8.1.1.1.1.1.1.3.3.1.cmml">log</mi><mo id="S3.E4.m1.8.8.1.1.1.1.1.1.3.3a" lspace="0.167em" xref="S3.E4.m1.8.8.1.1.1.1.1.1.3.3.cmml">⁡</mo><mfrac id="S3.E4.m1.7.7" xref="S3.E4.m1.7.7.cmml"><mrow id="S3.E4.m1.6.6.1" xref="S3.E4.m1.6.6.1.cmml"><mi id="S3.E4.m1.6.6.1.3" xref="S3.E4.m1.6.6.1.3.cmml">π</mi><mo id="S3.E4.m1.6.6.1.2" xref="S3.E4.m1.6.6.1.2.cmml">⁢</mo><mrow id="S3.E4.m1.6.6.1.1.1" xref="S3.E4.m1.6.6.1.1.1.1.cmml"><mo id="S3.E4.m1.6.6.1.1.1.2" stretchy="false" xref="S3.E4.m1.6.6.1.1.1.1.cmml">(</mo><mrow id="S3.E4.m1.6.6.1.1.1.1" xref="S3.E4.m1.6.6.1.1.1.1.cmml"><msup id="S3.E4.m1.6.6.1.1.1.1.2" xref="S3.E4.m1.6.6.1.1.1.1.2.cmml"><mi id="S3.E4.m1.6.6.1.1.1.1.2.2" xref="S3.E4.m1.6.6.1.1.1.1.2.2.cmml">j</mi><mo id="S3.E4.m1.6.6.1.1.1.1.2.3" xref="S3.E4.m1.6.6.1.1.1.1.2.3.cmml">−</mo></msup><mo fence="false" id="S3.E4.m1.6.6.1.1.1.1.1" xref="S3.E4.m1.6.6.1.1.1.1.1.cmml">|</mo><mi id="S3.E4.m1.6.6.1.1.1.1.3" xref="S3.E4.m1.6.6.1.1.1.1.3.cmml">p</mi></mrow><mo id="S3.E4.m1.6.6.1.1.1.3" stretchy="false" xref="S3.E4.m1.6.6.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="S3.E4.m1.7.7.2" xref="S3.E4.m1.7.7.2.cmml"><msub id="S3.E4.m1.7.7.2.3" xref="S3.E4.m1.7.7.2.3.cmml"><mi id="S3.E4.m1.7.7.2.3.2" xref="S3.E4.m1.7.7.2.3.2.cmml">π</mi><mn id="S3.E4.m1.7.7.2.3.3" xref="S3.E4.m1.7.7.2.3.3.cmml">0</mn></msub><mo id="S3.E4.m1.7.7.2.2" xref="S3.E4.m1.7.7.2.2.cmml">⁢</mo><mrow id="S3.E4.m1.7.7.2.1.1" xref="S3.E4.m1.7.7.2.1.1.1.cmml"><mo id="S3.E4.m1.7.7.2.1.1.2" stretchy="false" xref="S3.E4.m1.7.7.2.1.1.1.cmml">(</mo><mrow id="S3.E4.m1.7.7.2.1.1.1" xref="S3.E4.m1.7.7.2.1.1.1.cmml"><msup id="S3.E4.m1.7.7.2.1.1.1.2" xref="S3.E4.m1.7.7.2.1.1.1.2.cmml"><mi id="S3.E4.m1.7.7.2.1.1.1.2.2" xref="S3.E4.m1.7.7.2.1.1.1.2.2.cmml">j</mi><mo id="S3.E4.m1.7.7.2.1.1.1.2.3" xref="S3.E4.m1.7.7.2.1.1.1.2.3.cmml">−</mo></msup><mo fence="false" id="S3.E4.m1.7.7.2.1.1.1.1" xref="S3.E4.m1.7.7.2.1.1.1.1.cmml">|</mo><mi id="S3.E4.m1.7.7.2.1.1.1.3" xref="S3.E4.m1.7.7.2.1.1.1.3.cmml">p</mi></mrow><mo id="S3.E4.m1.7.7.2.1.1.3" stretchy="false" xref="S3.E4.m1.7.7.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mrow></mrow></mrow><mo id="S3.E4.m1.8.8.1.1.1.1.1.3" xref="S3.E4.m1.8.8.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.8b"><apply id="S3.E4.m1.8.8.cmml" xref="S3.E4.m1.8.8"><eq id="S3.E4.m1.8.8.2.cmml" xref="S3.E4.m1.8.8.2"></eq><apply id="S3.E4.m1.8.8.3.cmml" xref="S3.E4.m1.8.8.3"><csymbol cd="ambiguous" id="S3.E4.m1.8.8.3.1.cmml" xref="S3.E4.m1.8.8.3">superscript</csymbol><ci id="S3.E4.m1.8.8.3.2.cmml" xref="S3.E4.m1.8.8.3.2">ℓ</ci><ci id="S3.E4.m1.8.8.3.3a.cmml" xref="S3.E4.m1.8.8.3.3"><mtext id="S3.E4.m1.8.8.3.3.cmml" mathsize="70%" xref="S3.E4.m1.8.8.3.3">DPO</mtext></ci></apply><apply id="S3.E4.m1.8.8.1.cmml" xref="S3.E4.m1.8.8.1"><minus id="S3.E4.m1.8.8.1.2.cmml" xref="S3.E4.m1.8.8.1"></minus><apply id="S3.E4.m1.8.8.1.1.cmml" xref="S3.E4.m1.8.8.1.1"><apply id="S3.E4.m1.8.8.1.1.2.cmml" xref="S3.E4.m1.8.8.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.8.8.1.1.2.1.cmml" xref="S3.E4.m1.8.8.1.1.2">subscript</csymbol><sum id="S3.E4.m1.8.8.1.1.2.2.cmml" xref="S3.E4.m1.8.8.1.1.2.2"></sum><vector id="S3.E4.m1.3.3.3.4.cmml" xref="S3.E4.m1.3.3.3.3"><ci id="S3.E4.m1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1">𝑝</ci><apply id="S3.E4.m1.2.2.2.2.1.cmml" xref="S3.E4.m1.2.2.2.2.1"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.2.2.1.1.cmml" xref="S3.E4.m1.2.2.2.2.1">superscript</csymbol><ci id="S3.E4.m1.2.2.2.2.1.2.cmml" xref="S3.E4.m1.2.2.2.2.1.2">𝑗</ci><plus id="S3.E4.m1.2.2.2.2.1.3.cmml" xref="S3.E4.m1.2.2.2.2.1.3"></plus></apply><apply id="S3.E4.m1.3.3.3.3.2.cmml" xref="S3.E4.m1.3.3.3.3.2"><csymbol cd="ambiguous" id="S3.E4.m1.3.3.3.3.2.1.cmml" xref="S3.E4.m1.3.3.3.3.2">superscript</csymbol><ci id="S3.E4.m1.3.3.3.3.2.2.cmml" xref="S3.E4.m1.3.3.3.3.2.2">𝑗</ci><minus id="S3.E4.m1.3.3.3.3.2.3.cmml" xref="S3.E4.m1.3.3.3.3.2.3"></minus></apply></vector></apply><apply id="S3.E4.m1.8.8.1.1.1.cmml" xref="S3.E4.m1.8.8.1.1.1"><times id="S3.E4.m1.8.8.1.1.1.2.cmml" xref="S3.E4.m1.8.8.1.1.1.2"></times><apply id="S3.E4.m1.8.8.1.1.1.3.cmml" xref="S3.E4.m1.8.8.1.1.1.3"><log id="S3.E4.m1.8.8.1.1.1.3.1.cmml" xref="S3.E4.m1.8.8.1.1.1.3.1"></log><ci id="S3.E4.m1.8.8.1.1.1.3.2.cmml" xref="S3.E4.m1.8.8.1.1.1.3.2">𝜎</ci></apply><apply id="S3.E4.m1.8.8.1.1.1.1.2.cmml" xref="S3.E4.m1.8.8.1.1.1.1.1"><csymbol cd="latexml" id="S3.E4.m1.8.8.1.1.1.1.2.1.cmml" xref="S3.E4.m1.8.8.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.E4.m1.8.8.1.1.1.1.1.1.cmml" xref="S3.E4.m1.8.8.1.1.1.1.1.1"><minus id="S3.E4.m1.8.8.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.8.8.1.1.1.1.1.1.1"></minus><apply id="S3.E4.m1.8.8.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.8.8.1.1.1.1.1.1.2"><times id="S3.E4.m1.8.8.1.1.1.1.1.1.2.1.cmml" xref="S3.E4.m1.8.8.1.1.1.1.1.1.2.1"></times><ci id="S3.E4.m1.8.8.1.1.1.1.1.1.2.2.cmml" xref="S3.E4.m1.8.8.1.1.1.1.1.1.2.2">𝜂</ci><apply id="S3.E4.m1.8.8.1.1.1.1.1.1.2.3.cmml" xref="S3.E4.m1.8.8.1.1.1.1.1.1.2.3"><log id="S3.E4.m1.8.8.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E4.m1.8.8.1.1.1.1.1.1.2.3.1"></log><apply id="S3.E4.m1.5.5.cmml" xref="S3.E4.m1.5.5"><divide id="S3.E4.m1.5.5.3.cmml" xref="S3.E4.m1.5.5"></divide><apply id="S3.E4.m1.4.4.1.cmml" xref="S3.E4.m1.4.4.1"><times id="S3.E4.m1.4.4.1.2.cmml" xref="S3.E4.m1.4.4.1.2"></times><ci id="S3.E4.m1.4.4.1.3.cmml" xref="S3.E4.m1.4.4.1.3">𝜋</ci><apply id="S3.E4.m1.4.4.1.1.1.1.cmml" xref="S3.E4.m1.4.4.1.1.1"><csymbol cd="latexml" id="S3.E4.m1.4.4.1.1.1.1.1.cmml" xref="S3.E4.m1.4.4.1.1.1.1.1">conditional</csymbol><apply id="S3.E4.m1.4.4.1.1.1.1.2.cmml" xref="S3.E4.m1.4.4.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.4.4.1.1.1.1.2.1.cmml" xref="S3.E4.m1.4.4.1.1.1.1.2">superscript</csymbol><ci id="S3.E4.m1.4.4.1.1.1.1.2.2.cmml" xref="S3.E4.m1.4.4.1.1.1.1.2.2">𝑗</ci><plus id="S3.E4.m1.4.4.1.1.1.1.2.3.cmml" xref="S3.E4.m1.4.4.1.1.1.1.2.3"></plus></apply><ci id="S3.E4.m1.4.4.1.1.1.1.3.cmml" xref="S3.E4.m1.4.4.1.1.1.1.3">𝑝</ci></apply></apply><apply id="S3.E4.m1.5.5.2.cmml" xref="S3.E4.m1.5.5.2"><times id="S3.E4.m1.5.5.2.2.cmml" xref="S3.E4.m1.5.5.2.2"></times><apply id="S3.E4.m1.5.5.2.3.cmml" xref="S3.E4.m1.5.5.2.3"><csymbol cd="ambiguous" id="S3.E4.m1.5.5.2.3.1.cmml" xref="S3.E4.m1.5.5.2.3">subscript</csymbol><ci id="S3.E4.m1.5.5.2.3.2.cmml" xref="S3.E4.m1.5.5.2.3.2">𝜋</ci><cn id="S3.E4.m1.5.5.2.3.3.cmml" type="integer" xref="S3.E4.m1.5.5.2.3.3">0</cn></apply><apply id="S3.E4.m1.5.5.2.1.1.1.cmml" xref="S3.E4.m1.5.5.2.1.1"><csymbol cd="latexml" id="S3.E4.m1.5.5.2.1.1.1.1.cmml" xref="S3.E4.m1.5.5.2.1.1.1.1">conditional</csymbol><apply id="S3.E4.m1.5.5.2.1.1.1.2.cmml" xref="S3.E4.m1.5.5.2.1.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.5.5.2.1.1.1.2.1.cmml" xref="S3.E4.m1.5.5.2.1.1.1.2">superscript</csymbol><ci id="S3.E4.m1.5.5.2.1.1.1.2.2.cmml" xref="S3.E4.m1.5.5.2.1.1.1.2.2">𝑗</ci><plus id="S3.E4.m1.5.5.2.1.1.1.2.3.cmml" xref="S3.E4.m1.5.5.2.1.1.1.2.3"></plus></apply><ci id="S3.E4.m1.5.5.2.1.1.1.3.cmml" xref="S3.E4.m1.5.5.2.1.1.1.3">𝑝</ci></apply></apply></apply></apply></apply><apply id="S3.E4.m1.8.8.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.8.8.1.1.1.1.1.1.3"><times id="S3.E4.m1.8.8.1.1.1.1.1.1.3.1.cmml" xref="S3.E4.m1.8.8.1.1.1.1.1.1.3.1"></times><ci id="S3.E4.m1.8.8.1.1.1.1.1.1.3.2.cmml" xref="S3.E4.m1.8.8.1.1.1.1.1.1.3.2">𝜂</ci><apply id="S3.E4.m1.8.8.1.1.1.1.1.1.3.3.cmml" xref="S3.E4.m1.8.8.1.1.1.1.1.1.3.3"><log id="S3.E4.m1.8.8.1.1.1.1.1.1.3.3.1.cmml" xref="S3.E4.m1.8.8.1.1.1.1.1.1.3.3.1"></log><apply id="S3.E4.m1.7.7.cmml" xref="S3.E4.m1.7.7"><divide id="S3.E4.m1.7.7.3.cmml" xref="S3.E4.m1.7.7"></divide><apply id="S3.E4.m1.6.6.1.cmml" xref="S3.E4.m1.6.6.1"><times id="S3.E4.m1.6.6.1.2.cmml" xref="S3.E4.m1.6.6.1.2"></times><ci id="S3.E4.m1.6.6.1.3.cmml" xref="S3.E4.m1.6.6.1.3">𝜋</ci><apply id="S3.E4.m1.6.6.1.1.1.1.cmml" xref="S3.E4.m1.6.6.1.1.1"><csymbol cd="latexml" id="S3.E4.m1.6.6.1.1.1.1.1.cmml" xref="S3.E4.m1.6.6.1.1.1.1.1">conditional</csymbol><apply id="S3.E4.m1.6.6.1.1.1.1.2.cmml" xref="S3.E4.m1.6.6.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.6.6.1.1.1.1.2.1.cmml" xref="S3.E4.m1.6.6.1.1.1.1.2">superscript</csymbol><ci id="S3.E4.m1.6.6.1.1.1.1.2.2.cmml" xref="S3.E4.m1.6.6.1.1.1.1.2.2">𝑗</ci><minus id="S3.E4.m1.6.6.1.1.1.1.2.3.cmml" xref="S3.E4.m1.6.6.1.1.1.1.2.3"></minus></apply><ci id="S3.E4.m1.6.6.1.1.1.1.3.cmml" xref="S3.E4.m1.6.6.1.1.1.1.3">𝑝</ci></apply></apply><apply id="S3.E4.m1.7.7.2.cmml" xref="S3.E4.m1.7.7.2"><times id="S3.E4.m1.7.7.2.2.cmml" xref="S3.E4.m1.7.7.2.2"></times><apply id="S3.E4.m1.7.7.2.3.cmml" xref="S3.E4.m1.7.7.2.3"><csymbol cd="ambiguous" id="S3.E4.m1.7.7.2.3.1.cmml" xref="S3.E4.m1.7.7.2.3">subscript</csymbol><ci id="S3.E4.m1.7.7.2.3.2.cmml" xref="S3.E4.m1.7.7.2.3.2">𝜋</ci><cn id="S3.E4.m1.7.7.2.3.3.cmml" type="integer" xref="S3.E4.m1.7.7.2.3.3">0</cn></apply><apply id="S3.E4.m1.7.7.2.1.1.1.cmml" xref="S3.E4.m1.7.7.2.1.1"><csymbol cd="latexml" id="S3.E4.m1.7.7.2.1.1.1.1.cmml" xref="S3.E4.m1.7.7.2.1.1.1.1">conditional</csymbol><apply id="S3.E4.m1.7.7.2.1.1.1.2.cmml" xref="S3.E4.m1.7.7.2.1.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.7.7.2.1.1.1.2.1.cmml" xref="S3.E4.m1.7.7.2.1.1.1.2">superscript</csymbol><ci id="S3.E4.m1.7.7.2.1.1.1.2.2.cmml" xref="S3.E4.m1.7.7.2.1.1.1.2.2">𝑗</ci><minus id="S3.E4.m1.7.7.2.1.1.1.2.3.cmml" xref="S3.E4.m1.7.7.2.1.1.1.2.3"></minus></apply><ci id="S3.E4.m1.7.7.2.1.1.1.3.cmml" xref="S3.E4.m1.7.7.2.1.1.1.3">𝑝</ci></apply></apply></apply></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.8c">\ell^{\text{DPO}}=-\sum_{(p,j^{+},j^{-})}\log\sigma\left[\eta\log\frac{\pi({j}%
^{+}|p)}{\pi_{0}({j}^{+}|p)}-\eta\log\frac{\pi({j}^{-}|p)}{\pi_{0}({j}^{-}|p)}\right]</annotation><annotation encoding="application/x-llamapun" id="S3.E4.m1.8d">roman_ℓ start_POSTSUPERSCRIPT DPO end_POSTSUPERSCRIPT = - ∑ start_POSTSUBSCRIPT ( italic_p , italic_j start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT , italic_j start_POSTSUPERSCRIPT - end_POSTSUPERSCRIPT ) end_POSTSUBSCRIPT roman_log italic_σ [ italic_η roman_log divide start_ARG italic_π ( italic_j start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT | italic_p ) end_ARG start_ARG italic_π start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ( italic_j start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT | italic_p ) end_ARG - italic_η roman_log divide start_ARG italic_π ( italic_j start_POSTSUPERSCRIPT - end_POSTSUPERSCRIPT | italic_p ) end_ARG start_ARG italic_π start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ( italic_j start_POSTSUPERSCRIPT - end_POSTSUPERSCRIPT | italic_p ) end_ARG ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.p6.3">where <math alttext="\pi_{0}" class="ltx_Math" display="inline" id="S3.p6.3.m1.1"><semantics id="S3.p6.3.m1.1a"><msub id="S3.p6.3.m1.1.1" xref="S3.p6.3.m1.1.1.cmml"><mi id="S3.p6.3.m1.1.1.2" xref="S3.p6.3.m1.1.1.2.cmml">π</mi><mn id="S3.p6.3.m1.1.1.3" xref="S3.p6.3.m1.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S3.p6.3.m1.1b"><apply id="S3.p6.3.m1.1.1.cmml" xref="S3.p6.3.m1.1.1"><csymbol cd="ambiguous" id="S3.p6.3.m1.1.1.1.cmml" xref="S3.p6.3.m1.1.1">subscript</csymbol><ci id="S3.p6.3.m1.1.1.2.cmml" xref="S3.p6.3.m1.1.1.2">𝜋</ci><cn id="S3.p6.3.m1.1.1.3.cmml" type="integer" xref="S3.p6.3.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p6.3.m1.1c">\pi_{0}</annotation><annotation encoding="application/x-llamapun" id="S3.p6.3.m1.1d">italic_π start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math> is the reference model initialized as the base LLM and remains untrained.
Following existing practice <cite class="ltx_cite ltx_citemacro_cite">Liu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03742v1#bib.bib23" title="">2024</a>); Hong et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03742v1#bib.bib11" title="">2024</a>); Pal et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03742v1#bib.bib24" title="">2024</a>)</cite>, the DPO also fuses a small weight of  <span class="ltx_glossaryref" title="supervised fine-tuning"><span class="ltx_text ltx_glossary_long">supervised fine-tuning</span></span> (<abbr class="ltx_glossaryref" title="supervised fine-tuning"><span class="ltx_text ltx_glossary_short">SFT</span></abbr>) loss to help mitigate the overoptimization issue, which can be formulated as:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E5">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\ell^{\text{SFT}}=-\sum_{(p,j^{+})}\log\pi({j}^{+}|p)" class="ltx_Math" display="block" id="S3.E5.m1.3"><semantics id="S3.E5.m1.3a"><mrow id="S3.E5.m1.3.3" xref="S3.E5.m1.3.3.cmml"><msup id="S3.E5.m1.3.3.3" xref="S3.E5.m1.3.3.3.cmml"><mi id="S3.E5.m1.3.3.3.2" mathvariant="normal" xref="S3.E5.m1.3.3.3.2.cmml">ℓ</mi><mtext id="S3.E5.m1.3.3.3.3" xref="S3.E5.m1.3.3.3.3a.cmml">SFT</mtext></msup><mo id="S3.E5.m1.3.3.2" xref="S3.E5.m1.3.3.2.cmml">=</mo><mrow id="S3.E5.m1.3.3.1" xref="S3.E5.m1.3.3.1.cmml"><mo id="S3.E5.m1.3.3.1a" xref="S3.E5.m1.3.3.1.cmml">−</mo><mrow id="S3.E5.m1.3.3.1.1" xref="S3.E5.m1.3.3.1.1.cmml"><munder id="S3.E5.m1.3.3.1.1.2" xref="S3.E5.m1.3.3.1.1.2.cmml"><mo id="S3.E5.m1.3.3.1.1.2.2" movablelimits="false" xref="S3.E5.m1.3.3.1.1.2.2.cmml">∑</mo><mrow id="S3.E5.m1.2.2.2.2" xref="S3.E5.m1.2.2.2.3.cmml"><mo id="S3.E5.m1.2.2.2.2.2" stretchy="false" xref="S3.E5.m1.2.2.2.3.cmml">(</mo><mi id="S3.E5.m1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.cmml">p</mi><mo id="S3.E5.m1.2.2.2.2.3" xref="S3.E5.m1.2.2.2.3.cmml">,</mo><msup id="S3.E5.m1.2.2.2.2.1" xref="S3.E5.m1.2.2.2.2.1.cmml"><mi id="S3.E5.m1.2.2.2.2.1.2" xref="S3.E5.m1.2.2.2.2.1.2.cmml">j</mi><mo id="S3.E5.m1.2.2.2.2.1.3" xref="S3.E5.m1.2.2.2.2.1.3.cmml">+</mo></msup><mo id="S3.E5.m1.2.2.2.2.4" stretchy="false" xref="S3.E5.m1.2.2.2.3.cmml">)</mo></mrow></munder><mrow id="S3.E5.m1.3.3.1.1.1" xref="S3.E5.m1.3.3.1.1.1.cmml"><mrow id="S3.E5.m1.3.3.1.1.1.3" xref="S3.E5.m1.3.3.1.1.1.3.cmml"><mi id="S3.E5.m1.3.3.1.1.1.3.1" xref="S3.E5.m1.3.3.1.1.1.3.1.cmml">log</mi><mo id="S3.E5.m1.3.3.1.1.1.3a" lspace="0.167em" xref="S3.E5.m1.3.3.1.1.1.3.cmml">⁡</mo><mi id="S3.E5.m1.3.3.1.1.1.3.2" xref="S3.E5.m1.3.3.1.1.1.3.2.cmml">π</mi></mrow><mo id="S3.E5.m1.3.3.1.1.1.2" xref="S3.E5.m1.3.3.1.1.1.2.cmml">⁢</mo><mrow id="S3.E5.m1.3.3.1.1.1.1.1" xref="S3.E5.m1.3.3.1.1.1.1.1.1.cmml"><mo id="S3.E5.m1.3.3.1.1.1.1.1.2" stretchy="false" xref="S3.E5.m1.3.3.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E5.m1.3.3.1.1.1.1.1.1" xref="S3.E5.m1.3.3.1.1.1.1.1.1.cmml"><msup id="S3.E5.m1.3.3.1.1.1.1.1.1.2" xref="S3.E5.m1.3.3.1.1.1.1.1.1.2.cmml"><mi id="S3.E5.m1.3.3.1.1.1.1.1.1.2.2" xref="S3.E5.m1.3.3.1.1.1.1.1.1.2.2.cmml">j</mi><mo id="S3.E5.m1.3.3.1.1.1.1.1.1.2.3" xref="S3.E5.m1.3.3.1.1.1.1.1.1.2.3.cmml">+</mo></msup><mo fence="false" id="S3.E5.m1.3.3.1.1.1.1.1.1.1" xref="S3.E5.m1.3.3.1.1.1.1.1.1.1.cmml">|</mo><mi id="S3.E5.m1.3.3.1.1.1.1.1.1.3" xref="S3.E5.m1.3.3.1.1.1.1.1.1.3.cmml">p</mi></mrow><mo id="S3.E5.m1.3.3.1.1.1.1.1.3" stretchy="false" xref="S3.E5.m1.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m1.3b"><apply id="S3.E5.m1.3.3.cmml" xref="S3.E5.m1.3.3"><eq id="S3.E5.m1.3.3.2.cmml" xref="S3.E5.m1.3.3.2"></eq><apply id="S3.E5.m1.3.3.3.cmml" xref="S3.E5.m1.3.3.3"><csymbol cd="ambiguous" id="S3.E5.m1.3.3.3.1.cmml" xref="S3.E5.m1.3.3.3">superscript</csymbol><ci id="S3.E5.m1.3.3.3.2.cmml" xref="S3.E5.m1.3.3.3.2">ℓ</ci><ci id="S3.E5.m1.3.3.3.3a.cmml" xref="S3.E5.m1.3.3.3.3"><mtext id="S3.E5.m1.3.3.3.3.cmml" mathsize="70%" xref="S3.E5.m1.3.3.3.3">SFT</mtext></ci></apply><apply id="S3.E5.m1.3.3.1.cmml" xref="S3.E5.m1.3.3.1"><minus id="S3.E5.m1.3.3.1.2.cmml" xref="S3.E5.m1.3.3.1"></minus><apply id="S3.E5.m1.3.3.1.1.cmml" xref="S3.E5.m1.3.3.1.1"><apply id="S3.E5.m1.3.3.1.1.2.cmml" xref="S3.E5.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="S3.E5.m1.3.3.1.1.2.1.cmml" xref="S3.E5.m1.3.3.1.1.2">subscript</csymbol><sum id="S3.E5.m1.3.3.1.1.2.2.cmml" xref="S3.E5.m1.3.3.1.1.2.2"></sum><interval closure="open" id="S3.E5.m1.2.2.2.3.cmml" xref="S3.E5.m1.2.2.2.2"><ci id="S3.E5.m1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1">𝑝</ci><apply id="S3.E5.m1.2.2.2.2.1.cmml" xref="S3.E5.m1.2.2.2.2.1"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.2.2.1.1.cmml" xref="S3.E5.m1.2.2.2.2.1">superscript</csymbol><ci id="S3.E5.m1.2.2.2.2.1.2.cmml" xref="S3.E5.m1.2.2.2.2.1.2">𝑗</ci><plus id="S3.E5.m1.2.2.2.2.1.3.cmml" xref="S3.E5.m1.2.2.2.2.1.3"></plus></apply></interval></apply><apply id="S3.E5.m1.3.3.1.1.1.cmml" xref="S3.E5.m1.3.3.1.1.1"><times id="S3.E5.m1.3.3.1.1.1.2.cmml" xref="S3.E5.m1.3.3.1.1.1.2"></times><apply id="S3.E5.m1.3.3.1.1.1.3.cmml" xref="S3.E5.m1.3.3.1.1.1.3"><log id="S3.E5.m1.3.3.1.1.1.3.1.cmml" xref="S3.E5.m1.3.3.1.1.1.3.1"></log><ci id="S3.E5.m1.3.3.1.1.1.3.2.cmml" xref="S3.E5.m1.3.3.1.1.1.3.2">𝜋</ci></apply><apply id="S3.E5.m1.3.3.1.1.1.1.1.1.cmml" xref="S3.E5.m1.3.3.1.1.1.1.1"><csymbol cd="latexml" id="S3.E5.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.3.3.1.1.1.1.1.1.1">conditional</csymbol><apply id="S3.E5.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.3.3.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E5.m1.3.3.1.1.1.1.1.1.2.1.cmml" xref="S3.E5.m1.3.3.1.1.1.1.1.1.2">superscript</csymbol><ci id="S3.E5.m1.3.3.1.1.1.1.1.1.2.2.cmml" xref="S3.E5.m1.3.3.1.1.1.1.1.1.2.2">𝑗</ci><plus id="S3.E5.m1.3.3.1.1.1.1.1.1.2.3.cmml" xref="S3.E5.m1.3.3.1.1.1.1.1.1.2.3"></plus></apply><ci id="S3.E5.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S3.E5.m1.3.3.1.1.1.1.1.1.3">𝑝</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.3c">\ell^{\text{SFT}}=-\sum_{(p,j^{+})}\log\pi({j}^{+}|p)</annotation><annotation encoding="application/x-llamapun" id="S3.E5.m1.3d">roman_ℓ start_POSTSUPERSCRIPT SFT end_POSTSUPERSCRIPT = - ∑ start_POSTSUBSCRIPT ( italic_p , italic_j start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT ) end_POSTSUBSCRIPT roman_log italic_π ( italic_j start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT | italic_p )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.p6.4">Then we linearly combine the DPO loss and the SFT loss with a small weight <math alttext="\alpha" class="ltx_Math" display="inline" id="S3.p6.4.m1.1"><semantics id="S3.p6.4.m1.1a"><mi id="S3.p6.4.m1.1.1" xref="S3.p6.4.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S3.p6.4.m1.1b"><ci id="S3.p6.4.m1.1.1.cmml" xref="S3.p6.4.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p6.4.m1.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="S3.p6.4.m1.1d">italic_α</annotation></semantics></math>:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E6">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\ell^{\text{final}}=\ell^{\text{DPO}}+\alpha*\ell^{\text{SFT}}" class="ltx_Math" display="block" id="S3.E6.m1.1"><semantics id="S3.E6.m1.1a"><mrow id="S3.E6.m1.1.1" xref="S3.E6.m1.1.1.cmml"><msup id="S3.E6.m1.1.1.2" xref="S3.E6.m1.1.1.2.cmml"><mi id="S3.E6.m1.1.1.2.2" mathvariant="normal" xref="S3.E6.m1.1.1.2.2.cmml">ℓ</mi><mtext id="S3.E6.m1.1.1.2.3" xref="S3.E6.m1.1.1.2.3a.cmml">final</mtext></msup><mo id="S3.E6.m1.1.1.1" xref="S3.E6.m1.1.1.1.cmml">=</mo><mrow id="S3.E6.m1.1.1.3" xref="S3.E6.m1.1.1.3.cmml"><msup id="S3.E6.m1.1.1.3.2" xref="S3.E6.m1.1.1.3.2.cmml"><mi id="S3.E6.m1.1.1.3.2.2" mathvariant="normal" xref="S3.E6.m1.1.1.3.2.2.cmml">ℓ</mi><mtext id="S3.E6.m1.1.1.3.2.3" xref="S3.E6.m1.1.1.3.2.3a.cmml">DPO</mtext></msup><mo id="S3.E6.m1.1.1.3.1" xref="S3.E6.m1.1.1.3.1.cmml">+</mo><mrow id="S3.E6.m1.1.1.3.3" xref="S3.E6.m1.1.1.3.3.cmml"><mi id="S3.E6.m1.1.1.3.3.2" xref="S3.E6.m1.1.1.3.3.2.cmml">α</mi><mo id="S3.E6.m1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.E6.m1.1.1.3.3.1.cmml">∗</mo><msup id="S3.E6.m1.1.1.3.3.3" xref="S3.E6.m1.1.1.3.3.3.cmml"><mi id="S3.E6.m1.1.1.3.3.3.2" mathvariant="normal" xref="S3.E6.m1.1.1.3.3.3.2.cmml">ℓ</mi><mtext id="S3.E6.m1.1.1.3.3.3.3" xref="S3.E6.m1.1.1.3.3.3.3a.cmml">SFT</mtext></msup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E6.m1.1b"><apply id="S3.E6.m1.1.1.cmml" xref="S3.E6.m1.1.1"><eq id="S3.E6.m1.1.1.1.cmml" xref="S3.E6.m1.1.1.1"></eq><apply id="S3.E6.m1.1.1.2.cmml" xref="S3.E6.m1.1.1.2"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.2.1.cmml" xref="S3.E6.m1.1.1.2">superscript</csymbol><ci id="S3.E6.m1.1.1.2.2.cmml" xref="S3.E6.m1.1.1.2.2">ℓ</ci><ci id="S3.E6.m1.1.1.2.3a.cmml" xref="S3.E6.m1.1.1.2.3"><mtext id="S3.E6.m1.1.1.2.3.cmml" mathsize="70%" xref="S3.E6.m1.1.1.2.3">final</mtext></ci></apply><apply id="S3.E6.m1.1.1.3.cmml" xref="S3.E6.m1.1.1.3"><plus id="S3.E6.m1.1.1.3.1.cmml" xref="S3.E6.m1.1.1.3.1"></plus><apply id="S3.E6.m1.1.1.3.2.cmml" xref="S3.E6.m1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.3.2.1.cmml" xref="S3.E6.m1.1.1.3.2">superscript</csymbol><ci id="S3.E6.m1.1.1.3.2.2.cmml" xref="S3.E6.m1.1.1.3.2.2">ℓ</ci><ci id="S3.E6.m1.1.1.3.2.3a.cmml" xref="S3.E6.m1.1.1.3.2.3"><mtext id="S3.E6.m1.1.1.3.2.3.cmml" mathsize="70%" xref="S3.E6.m1.1.1.3.2.3">DPO</mtext></ci></apply><apply id="S3.E6.m1.1.1.3.3.cmml" xref="S3.E6.m1.1.1.3.3"><times id="S3.E6.m1.1.1.3.3.1.cmml" xref="S3.E6.m1.1.1.3.3.1"></times><ci id="S3.E6.m1.1.1.3.3.2.cmml" xref="S3.E6.m1.1.1.3.3.2">𝛼</ci><apply id="S3.E6.m1.1.1.3.3.3.cmml" xref="S3.E6.m1.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.3.3.3.1.cmml" xref="S3.E6.m1.1.1.3.3.3">superscript</csymbol><ci id="S3.E6.m1.1.1.3.3.3.2.cmml" xref="S3.E6.m1.1.1.3.3.3.2">ℓ</ci><ci id="S3.E6.m1.1.1.3.3.3.3a.cmml" xref="S3.E6.m1.1.1.3.3.3.3"><mtext id="S3.E6.m1.1.1.3.3.3.3.cmml" mathsize="70%" xref="S3.E6.m1.1.1.3.3.3.3">SFT</mtext></ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m1.1c">\ell^{\text{final}}=\ell^{\text{DPO}}+\alpha*\ell^{\text{SFT}}</annotation><annotation encoding="application/x-llamapun" id="S3.E6.m1.1d">roman_ℓ start_POSTSUPERSCRIPT final end_POSTSUPERSCRIPT = roman_ℓ start_POSTSUPERSCRIPT DPO end_POSTSUPERSCRIPT + italic_α ∗ roman_ℓ start_POSTSUPERSCRIPT SFT end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="S3.p7">
<p class="ltx_p" id="S3.p7.1"><span class="ltx_text ltx_font_bold" id="S3.p7.1.1">DPO training promotes distinguishing between answers.</span> 
Existing open-source generative judges are generally trained using supervised fine-tuning (SFT) <cite class="ltx_cite ltx_citemacro_citep">(Kim et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03742v1#bib.bib16" title="">2024</a>; Zhang et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03742v1#bib.bib39" title="">2024</a>; Li et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03742v1#bib.bib21" title="">2023</a>)</cite> to imitate correct judgments.
However, we empirically find that only SFT is insufficient (see Setion <a class="ltx_ref" href="https://arxiv.org/html/2410.03742v1#S4" title="4 Experiments ‣ Beyond Scalar Reward Model: Learning Generative Judge from Preference Data"><span class="ltx_text ltx_ref_tag">4</span></a>).
The intuition is that LLMs should identify the more important aspects of a judgment, rather than patterns that may appear in both positive and negative judgments <cite class="ltx_cite ltx_citemacro_citep">(Park et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03742v1#bib.bib25" title="">2024</a>)</cite>.
For example, both “answer 1 has logical errors, so the better answer is 2” and “answer 2 has logical errors, so the better answer is 1” could be positive judgments for different prompt inputs, even though they are opposite in meanings.
When LLM is trained with SFT loss, it may primarily imitate the common pattern that appears in both answers rather than developing the ability to make judgments based on the prompt.
Similar studies <span class="ltx_note ltx_role_footnote" id="footnote1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>https://github.com/LLaMafia/SFT_function_learning</span></span></span> indicate that the likelihood of generating negative output might even surpass that of positive output during SFT training.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.p8">
<p class="ltx_p" id="S3.p8.5"><span class="ltx_text ltx_font_bold" id="S3.p8.5.1">Rationales bring robustness against bias.</span> 

The proposed Con-J can generate rationales in addition to the binary preference prediction.
We suggest that training the model to generate rationales can impart a regularization effect and help avoid potential biases in the datasets.
Here we provide a theoretical motivation for this effect.
We decompose a judgment <math alttext="j" class="ltx_Math" display="inline" id="S3.p8.1.m1.1"><semantics id="S3.p8.1.m1.1a"><mi id="S3.p8.1.m1.1.1" xref="S3.p8.1.m1.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S3.p8.1.m1.1b"><ci id="S3.p8.1.m1.1.1.cmml" xref="S3.p8.1.m1.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p8.1.m1.1c">j</annotation><annotation encoding="application/x-llamapun" id="S3.p8.1.m1.1d">italic_j</annotation></semantics></math> into <math alttext="j_{r}" class="ltx_Math" display="inline" id="S3.p8.2.m2.1"><semantics id="S3.p8.2.m2.1a"><msub id="S3.p8.2.m2.1.1" xref="S3.p8.2.m2.1.1.cmml"><mi id="S3.p8.2.m2.1.1.2" xref="S3.p8.2.m2.1.1.2.cmml">j</mi><mi id="S3.p8.2.m2.1.1.3" xref="S3.p8.2.m2.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p8.2.m2.1b"><apply id="S3.p8.2.m2.1.1.cmml" xref="S3.p8.2.m2.1.1"><csymbol cd="ambiguous" id="S3.p8.2.m2.1.1.1.cmml" xref="S3.p8.2.m2.1.1">subscript</csymbol><ci id="S3.p8.2.m2.1.1.2.cmml" xref="S3.p8.2.m2.1.1.2">𝑗</ci><ci id="S3.p8.2.m2.1.1.3.cmml" xref="S3.p8.2.m2.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p8.2.m2.1c">j_{r}</annotation><annotation encoding="application/x-llamapun" id="S3.p8.2.m2.1d">italic_j start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="j_{y}" class="ltx_Math" display="inline" id="S3.p8.3.m3.1"><semantics id="S3.p8.3.m3.1a"><msub id="S3.p8.3.m3.1.1" xref="S3.p8.3.m3.1.1.cmml"><mi id="S3.p8.3.m3.1.1.2" xref="S3.p8.3.m3.1.1.2.cmml">j</mi><mi id="S3.p8.3.m3.1.1.3" xref="S3.p8.3.m3.1.1.3.cmml">y</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p8.3.m3.1b"><apply id="S3.p8.3.m3.1.1.cmml" xref="S3.p8.3.m3.1.1"><csymbol cd="ambiguous" id="S3.p8.3.m3.1.1.1.cmml" xref="S3.p8.3.m3.1.1">subscript</csymbol><ci id="S3.p8.3.m3.1.1.2.cmml" xref="S3.p8.3.m3.1.1.2">𝑗</ci><ci id="S3.p8.3.m3.1.1.3.cmml" xref="S3.p8.3.m3.1.1.3">𝑦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p8.3.m3.1c">j_{y}</annotation><annotation encoding="application/x-llamapun" id="S3.p8.3.m3.1d">italic_j start_POSTSUBSCRIPT italic_y end_POSTSUBSCRIPT</annotation></semantics></math>, representing the rationale and the binary preference prediction, respectively.
Adding the rationales as training targets can be formalized by introducing an intermediate variable <math alttext="j_{r}" class="ltx_Math" display="inline" id="S3.p8.4.m4.1"><semantics id="S3.p8.4.m4.1a"><msub id="S3.p8.4.m4.1.1" xref="S3.p8.4.m4.1.1.cmml"><mi id="S3.p8.4.m4.1.1.2" xref="S3.p8.4.m4.1.1.2.cmml">j</mi><mi id="S3.p8.4.m4.1.1.3" xref="S3.p8.4.m4.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p8.4.m4.1b"><apply id="S3.p8.4.m4.1.1.cmml" xref="S3.p8.4.m4.1.1"><csymbol cd="ambiguous" id="S3.p8.4.m4.1.1.1.cmml" xref="S3.p8.4.m4.1.1">subscript</csymbol><ci id="S3.p8.4.m4.1.1.2.cmml" xref="S3.p8.4.m4.1.1.2">𝑗</ci><ci id="S3.p8.4.m4.1.1.3.cmml" xref="S3.p8.4.m4.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p8.4.m4.1c">j_{r}</annotation><annotation encoding="application/x-llamapun" id="S3.p8.4.m4.1d">italic_j start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT</annotation></semantics></math> influencing the conditional probability <math alttext="P_{\theta}(j_{y}\mid p)" class="ltx_Math" display="inline" id="S3.p8.5.m5.1"><semantics id="S3.p8.5.m5.1a"><mrow id="S3.p8.5.m5.1.1" xref="S3.p8.5.m5.1.1.cmml"><msub id="S3.p8.5.m5.1.1.3" xref="S3.p8.5.m5.1.1.3.cmml"><mi id="S3.p8.5.m5.1.1.3.2" xref="S3.p8.5.m5.1.1.3.2.cmml">P</mi><mi id="S3.p8.5.m5.1.1.3.3" xref="S3.p8.5.m5.1.1.3.3.cmml">θ</mi></msub><mo id="S3.p8.5.m5.1.1.2" xref="S3.p8.5.m5.1.1.2.cmml">⁢</mo><mrow id="S3.p8.5.m5.1.1.1.1" xref="S3.p8.5.m5.1.1.1.1.1.cmml"><mo id="S3.p8.5.m5.1.1.1.1.2" stretchy="false" xref="S3.p8.5.m5.1.1.1.1.1.cmml">(</mo><mrow id="S3.p8.5.m5.1.1.1.1.1" xref="S3.p8.5.m5.1.1.1.1.1.cmml"><msub id="S3.p8.5.m5.1.1.1.1.1.2" xref="S3.p8.5.m5.1.1.1.1.1.2.cmml"><mi id="S3.p8.5.m5.1.1.1.1.1.2.2" xref="S3.p8.5.m5.1.1.1.1.1.2.2.cmml">j</mi><mi id="S3.p8.5.m5.1.1.1.1.1.2.3" xref="S3.p8.5.m5.1.1.1.1.1.2.3.cmml">y</mi></msub><mo id="S3.p8.5.m5.1.1.1.1.1.1" xref="S3.p8.5.m5.1.1.1.1.1.1.cmml">∣</mo><mi id="S3.p8.5.m5.1.1.1.1.1.3" xref="S3.p8.5.m5.1.1.1.1.1.3.cmml">p</mi></mrow><mo id="S3.p8.5.m5.1.1.1.1.3" stretchy="false" xref="S3.p8.5.m5.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p8.5.m5.1b"><apply id="S3.p8.5.m5.1.1.cmml" xref="S3.p8.5.m5.1.1"><times id="S3.p8.5.m5.1.1.2.cmml" xref="S3.p8.5.m5.1.1.2"></times><apply id="S3.p8.5.m5.1.1.3.cmml" xref="S3.p8.5.m5.1.1.3"><csymbol cd="ambiguous" id="S3.p8.5.m5.1.1.3.1.cmml" xref="S3.p8.5.m5.1.1.3">subscript</csymbol><ci id="S3.p8.5.m5.1.1.3.2.cmml" xref="S3.p8.5.m5.1.1.3.2">𝑃</ci><ci id="S3.p8.5.m5.1.1.3.3.cmml" xref="S3.p8.5.m5.1.1.3.3">𝜃</ci></apply><apply id="S3.p8.5.m5.1.1.1.1.1.cmml" xref="S3.p8.5.m5.1.1.1.1"><csymbol cd="latexml" id="S3.p8.5.m5.1.1.1.1.1.1.cmml" xref="S3.p8.5.m5.1.1.1.1.1.1">conditional</csymbol><apply id="S3.p8.5.m5.1.1.1.1.1.2.cmml" xref="S3.p8.5.m5.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.p8.5.m5.1.1.1.1.1.2.1.cmml" xref="S3.p8.5.m5.1.1.1.1.1.2">subscript</csymbol><ci id="S3.p8.5.m5.1.1.1.1.1.2.2.cmml" xref="S3.p8.5.m5.1.1.1.1.1.2.2">𝑗</ci><ci id="S3.p8.5.m5.1.1.1.1.1.2.3.cmml" xref="S3.p8.5.m5.1.1.1.1.1.2.3">𝑦</ci></apply><ci id="S3.p8.5.m5.1.1.1.1.1.3.cmml" xref="S3.p8.5.m5.1.1.1.1.1.3">𝑝</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p8.5.m5.1c">P_{\theta}(j_{y}\mid p)</annotation><annotation encoding="application/x-llamapun" id="S3.p8.5.m5.1d">italic_P start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_j start_POSTSUBSCRIPT italic_y end_POSTSUBSCRIPT ∣ italic_p )</annotation></semantics></math>:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E7">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="P_{\theta}(j_{y}\mid p)=\sum_{j}P_{\theta}(y\mid j_{r},p)\,P_{\theta}(j_{r}%
\mid p)" class="ltx_Math" display="block" id="S3.E7.m1.4"><semantics id="S3.E7.m1.4a"><mrow id="S3.E7.m1.4.4" xref="S3.E7.m1.4.4.cmml"><mrow id="S3.E7.m1.2.2.1" xref="S3.E7.m1.2.2.1.cmml"><msub id="S3.E7.m1.2.2.1.3" xref="S3.E7.m1.2.2.1.3.cmml"><mi id="S3.E7.m1.2.2.1.3.2" xref="S3.E7.m1.2.2.1.3.2.cmml">P</mi><mi id="S3.E7.m1.2.2.1.3.3" xref="S3.E7.m1.2.2.1.3.3.cmml">θ</mi></msub><mo id="S3.E7.m1.2.2.1.2" xref="S3.E7.m1.2.2.1.2.cmml">⁢</mo><mrow id="S3.E7.m1.2.2.1.1.1" xref="S3.E7.m1.2.2.1.1.1.1.cmml"><mo id="S3.E7.m1.2.2.1.1.1.2" stretchy="false" xref="S3.E7.m1.2.2.1.1.1.1.cmml">(</mo><mrow id="S3.E7.m1.2.2.1.1.1.1" xref="S3.E7.m1.2.2.1.1.1.1.cmml"><msub id="S3.E7.m1.2.2.1.1.1.1.2" xref="S3.E7.m1.2.2.1.1.1.1.2.cmml"><mi id="S3.E7.m1.2.2.1.1.1.1.2.2" xref="S3.E7.m1.2.2.1.1.1.1.2.2.cmml">j</mi><mi id="S3.E7.m1.2.2.1.1.1.1.2.3" xref="S3.E7.m1.2.2.1.1.1.1.2.3.cmml">y</mi></msub><mo id="S3.E7.m1.2.2.1.1.1.1.1" xref="S3.E7.m1.2.2.1.1.1.1.1.cmml">∣</mo><mi id="S3.E7.m1.2.2.1.1.1.1.3" xref="S3.E7.m1.2.2.1.1.1.1.3.cmml">p</mi></mrow><mo id="S3.E7.m1.2.2.1.1.1.3" stretchy="false" xref="S3.E7.m1.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E7.m1.4.4.4" rspace="0.111em" xref="S3.E7.m1.4.4.4.cmml">=</mo><mrow id="S3.E7.m1.4.4.3" xref="S3.E7.m1.4.4.3.cmml"><munder id="S3.E7.m1.4.4.3.3" xref="S3.E7.m1.4.4.3.3.cmml"><mo id="S3.E7.m1.4.4.3.3.2" movablelimits="false" xref="S3.E7.m1.4.4.3.3.2.cmml">∑</mo><mi id="S3.E7.m1.4.4.3.3.3" xref="S3.E7.m1.4.4.3.3.3.cmml">j</mi></munder><mrow id="S3.E7.m1.4.4.3.2" xref="S3.E7.m1.4.4.3.2.cmml"><msub id="S3.E7.m1.4.4.3.2.4" xref="S3.E7.m1.4.4.3.2.4.cmml"><mi id="S3.E7.m1.4.4.3.2.4.2" xref="S3.E7.m1.4.4.3.2.4.2.cmml">P</mi><mi id="S3.E7.m1.4.4.3.2.4.3" xref="S3.E7.m1.4.4.3.2.4.3.cmml">θ</mi></msub><mo id="S3.E7.m1.4.4.3.2.3" xref="S3.E7.m1.4.4.3.2.3.cmml">⁢</mo><mrow id="S3.E7.m1.3.3.2.1.1.1" xref="S3.E7.m1.3.3.2.1.1.1.1.cmml"><mo id="S3.E7.m1.3.3.2.1.1.1.2" stretchy="false" xref="S3.E7.m1.3.3.2.1.1.1.1.cmml">(</mo><mrow id="S3.E7.m1.3.3.2.1.1.1.1" xref="S3.E7.m1.3.3.2.1.1.1.1.cmml"><mi id="S3.E7.m1.3.3.2.1.1.1.1.3" xref="S3.E7.m1.3.3.2.1.1.1.1.3.cmml">y</mi><mo id="S3.E7.m1.3.3.2.1.1.1.1.2" xref="S3.E7.m1.3.3.2.1.1.1.1.2.cmml">∣</mo><mrow id="S3.E7.m1.3.3.2.1.1.1.1.1.1" xref="S3.E7.m1.3.3.2.1.1.1.1.1.2.cmml"><msub id="S3.E7.m1.3.3.2.1.1.1.1.1.1.1" xref="S3.E7.m1.3.3.2.1.1.1.1.1.1.1.cmml"><mi id="S3.E7.m1.3.3.2.1.1.1.1.1.1.1.2" xref="S3.E7.m1.3.3.2.1.1.1.1.1.1.1.2.cmml">j</mi><mi id="S3.E7.m1.3.3.2.1.1.1.1.1.1.1.3" xref="S3.E7.m1.3.3.2.1.1.1.1.1.1.1.3.cmml">r</mi></msub><mo id="S3.E7.m1.3.3.2.1.1.1.1.1.1.2" xref="S3.E7.m1.3.3.2.1.1.1.1.1.2.cmml">,</mo><mi id="S3.E7.m1.1.1" xref="S3.E7.m1.1.1.cmml">p</mi></mrow></mrow><mo id="S3.E7.m1.3.3.2.1.1.1.3" stretchy="false" xref="S3.E7.m1.3.3.2.1.1.1.1.cmml">)</mo></mrow><mo id="S3.E7.m1.4.4.3.2.3a" lspace="0.170em" xref="S3.E7.m1.4.4.3.2.3.cmml">⁢</mo><msub id="S3.E7.m1.4.4.3.2.5" xref="S3.E7.m1.4.4.3.2.5.cmml"><mi id="S3.E7.m1.4.4.3.2.5.2" xref="S3.E7.m1.4.4.3.2.5.2.cmml">P</mi><mi id="S3.E7.m1.4.4.3.2.5.3" xref="S3.E7.m1.4.4.3.2.5.3.cmml">θ</mi></msub><mo id="S3.E7.m1.4.4.3.2.3b" xref="S3.E7.m1.4.4.3.2.3.cmml">⁢</mo><mrow id="S3.E7.m1.4.4.3.2.2.1" xref="S3.E7.m1.4.4.3.2.2.1.1.cmml"><mo id="S3.E7.m1.4.4.3.2.2.1.2" stretchy="false" xref="S3.E7.m1.4.4.3.2.2.1.1.cmml">(</mo><mrow id="S3.E7.m1.4.4.3.2.2.1.1" xref="S3.E7.m1.4.4.3.2.2.1.1.cmml"><msub id="S3.E7.m1.4.4.3.2.2.1.1.2" xref="S3.E7.m1.4.4.3.2.2.1.1.2.cmml"><mi id="S3.E7.m1.4.4.3.2.2.1.1.2.2" xref="S3.E7.m1.4.4.3.2.2.1.1.2.2.cmml">j</mi><mi id="S3.E7.m1.4.4.3.2.2.1.1.2.3" xref="S3.E7.m1.4.4.3.2.2.1.1.2.3.cmml">r</mi></msub><mo id="S3.E7.m1.4.4.3.2.2.1.1.1" xref="S3.E7.m1.4.4.3.2.2.1.1.1.cmml">∣</mo><mi id="S3.E7.m1.4.4.3.2.2.1.1.3" xref="S3.E7.m1.4.4.3.2.2.1.1.3.cmml">p</mi></mrow><mo id="S3.E7.m1.4.4.3.2.2.1.3" stretchy="false" xref="S3.E7.m1.4.4.3.2.2.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E7.m1.4b"><apply id="S3.E7.m1.4.4.cmml" xref="S3.E7.m1.4.4"><eq id="S3.E7.m1.4.4.4.cmml" xref="S3.E7.m1.4.4.4"></eq><apply id="S3.E7.m1.2.2.1.cmml" xref="S3.E7.m1.2.2.1"><times id="S3.E7.m1.2.2.1.2.cmml" xref="S3.E7.m1.2.2.1.2"></times><apply id="S3.E7.m1.2.2.1.3.cmml" xref="S3.E7.m1.2.2.1.3"><csymbol cd="ambiguous" id="S3.E7.m1.2.2.1.3.1.cmml" xref="S3.E7.m1.2.2.1.3">subscript</csymbol><ci id="S3.E7.m1.2.2.1.3.2.cmml" xref="S3.E7.m1.2.2.1.3.2">𝑃</ci><ci id="S3.E7.m1.2.2.1.3.3.cmml" xref="S3.E7.m1.2.2.1.3.3">𝜃</ci></apply><apply id="S3.E7.m1.2.2.1.1.1.1.cmml" xref="S3.E7.m1.2.2.1.1.1"><csymbol cd="latexml" id="S3.E7.m1.2.2.1.1.1.1.1.cmml" xref="S3.E7.m1.2.2.1.1.1.1.1">conditional</csymbol><apply id="S3.E7.m1.2.2.1.1.1.1.2.cmml" xref="S3.E7.m1.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E7.m1.2.2.1.1.1.1.2.1.cmml" xref="S3.E7.m1.2.2.1.1.1.1.2">subscript</csymbol><ci id="S3.E7.m1.2.2.1.1.1.1.2.2.cmml" xref="S3.E7.m1.2.2.1.1.1.1.2.2">𝑗</ci><ci id="S3.E7.m1.2.2.1.1.1.1.2.3.cmml" xref="S3.E7.m1.2.2.1.1.1.1.2.3">𝑦</ci></apply><ci id="S3.E7.m1.2.2.1.1.1.1.3.cmml" xref="S3.E7.m1.2.2.1.1.1.1.3">𝑝</ci></apply></apply><apply id="S3.E7.m1.4.4.3.cmml" xref="S3.E7.m1.4.4.3"><apply id="S3.E7.m1.4.4.3.3.cmml" xref="S3.E7.m1.4.4.3.3"><csymbol cd="ambiguous" id="S3.E7.m1.4.4.3.3.1.cmml" xref="S3.E7.m1.4.4.3.3">subscript</csymbol><sum id="S3.E7.m1.4.4.3.3.2.cmml" xref="S3.E7.m1.4.4.3.3.2"></sum><ci id="S3.E7.m1.4.4.3.3.3.cmml" xref="S3.E7.m1.4.4.3.3.3">𝑗</ci></apply><apply id="S3.E7.m1.4.4.3.2.cmml" xref="S3.E7.m1.4.4.3.2"><times id="S3.E7.m1.4.4.3.2.3.cmml" xref="S3.E7.m1.4.4.3.2.3"></times><apply id="S3.E7.m1.4.4.3.2.4.cmml" xref="S3.E7.m1.4.4.3.2.4"><csymbol cd="ambiguous" id="S3.E7.m1.4.4.3.2.4.1.cmml" xref="S3.E7.m1.4.4.3.2.4">subscript</csymbol><ci id="S3.E7.m1.4.4.3.2.4.2.cmml" xref="S3.E7.m1.4.4.3.2.4.2">𝑃</ci><ci id="S3.E7.m1.4.4.3.2.4.3.cmml" xref="S3.E7.m1.4.4.3.2.4.3">𝜃</ci></apply><apply id="S3.E7.m1.3.3.2.1.1.1.1.cmml" xref="S3.E7.m1.3.3.2.1.1.1"><csymbol cd="latexml" id="S3.E7.m1.3.3.2.1.1.1.1.2.cmml" xref="S3.E7.m1.3.3.2.1.1.1.1.2">conditional</csymbol><ci id="S3.E7.m1.3.3.2.1.1.1.1.3.cmml" xref="S3.E7.m1.3.3.2.1.1.1.1.3">𝑦</ci><list id="S3.E7.m1.3.3.2.1.1.1.1.1.2.cmml" xref="S3.E7.m1.3.3.2.1.1.1.1.1.1"><apply id="S3.E7.m1.3.3.2.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.3.3.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E7.m1.3.3.2.1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.3.3.2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E7.m1.3.3.2.1.1.1.1.1.1.1.2.cmml" xref="S3.E7.m1.3.3.2.1.1.1.1.1.1.1.2">𝑗</ci><ci id="S3.E7.m1.3.3.2.1.1.1.1.1.1.1.3.cmml" xref="S3.E7.m1.3.3.2.1.1.1.1.1.1.1.3">𝑟</ci></apply><ci id="S3.E7.m1.1.1.cmml" xref="S3.E7.m1.1.1">𝑝</ci></list></apply><apply id="S3.E7.m1.4.4.3.2.5.cmml" xref="S3.E7.m1.4.4.3.2.5"><csymbol cd="ambiguous" id="S3.E7.m1.4.4.3.2.5.1.cmml" xref="S3.E7.m1.4.4.3.2.5">subscript</csymbol><ci id="S3.E7.m1.4.4.3.2.5.2.cmml" xref="S3.E7.m1.4.4.3.2.5.2">𝑃</ci><ci id="S3.E7.m1.4.4.3.2.5.3.cmml" xref="S3.E7.m1.4.4.3.2.5.3">𝜃</ci></apply><apply id="S3.E7.m1.4.4.3.2.2.1.1.cmml" xref="S3.E7.m1.4.4.3.2.2.1"><csymbol cd="latexml" id="S3.E7.m1.4.4.3.2.2.1.1.1.cmml" xref="S3.E7.m1.4.4.3.2.2.1.1.1">conditional</csymbol><apply id="S3.E7.m1.4.4.3.2.2.1.1.2.cmml" xref="S3.E7.m1.4.4.3.2.2.1.1.2"><csymbol cd="ambiguous" id="S3.E7.m1.4.4.3.2.2.1.1.2.1.cmml" xref="S3.E7.m1.4.4.3.2.2.1.1.2">subscript</csymbol><ci id="S3.E7.m1.4.4.3.2.2.1.1.2.2.cmml" xref="S3.E7.m1.4.4.3.2.2.1.1.2.2">𝑗</ci><ci id="S3.E7.m1.4.4.3.2.2.1.1.2.3.cmml" xref="S3.E7.m1.4.4.3.2.2.1.1.2.3">𝑟</ci></apply><ci id="S3.E7.m1.4.4.3.2.2.1.1.3.cmml" xref="S3.E7.m1.4.4.3.2.2.1.1.3">𝑝</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7.m1.4c">P_{\theta}(j_{y}\mid p)=\sum_{j}P_{\theta}(y\mid j_{r},p)\,P_{\theta}(j_{r}%
\mid p)</annotation><annotation encoding="application/x-llamapun" id="S3.E7.m1.4d">italic_P start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_j start_POSTSUBSCRIPT italic_y end_POSTSUBSCRIPT ∣ italic_p ) = ∑ start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT italic_P start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_y ∣ italic_j start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT , italic_p ) italic_P start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_j start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ∣ italic_p )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.p8.8">By including rationales, the bias in preference data is distributed between <math alttext="j_{y}" class="ltx_Math" display="inline" id="S3.p8.6.m1.1"><semantics id="S3.p8.6.m1.1a"><msub id="S3.p8.6.m1.1.1" xref="S3.p8.6.m1.1.1.cmml"><mi id="S3.p8.6.m1.1.1.2" xref="S3.p8.6.m1.1.1.2.cmml">j</mi><mi id="S3.p8.6.m1.1.1.3" xref="S3.p8.6.m1.1.1.3.cmml">y</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p8.6.m1.1b"><apply id="S3.p8.6.m1.1.1.cmml" xref="S3.p8.6.m1.1.1"><csymbol cd="ambiguous" id="S3.p8.6.m1.1.1.1.cmml" xref="S3.p8.6.m1.1.1">subscript</csymbol><ci id="S3.p8.6.m1.1.1.2.cmml" xref="S3.p8.6.m1.1.1.2">𝑗</ci><ci id="S3.p8.6.m1.1.1.3.cmml" xref="S3.p8.6.m1.1.1.3">𝑦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p8.6.m1.1c">j_{y}</annotation><annotation encoding="application/x-llamapun" id="S3.p8.6.m1.1d">italic_j start_POSTSUBSCRIPT italic_y end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="j_{r}" class="ltx_Math" display="inline" id="S3.p8.7.m2.1"><semantics id="S3.p8.7.m2.1a"><msub id="S3.p8.7.m2.1.1" xref="S3.p8.7.m2.1.1.cmml"><mi id="S3.p8.7.m2.1.1.2" xref="S3.p8.7.m2.1.1.2.cmml">j</mi><mi id="S3.p8.7.m2.1.1.3" xref="S3.p8.7.m2.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p8.7.m2.1b"><apply id="S3.p8.7.m2.1.1.cmml" xref="S3.p8.7.m2.1.1"><csymbol cd="ambiguous" id="S3.p8.7.m2.1.1.1.cmml" xref="S3.p8.7.m2.1.1">subscript</csymbol><ci id="S3.p8.7.m2.1.1.2.cmml" xref="S3.p8.7.m2.1.1.2">𝑗</ci><ci id="S3.p8.7.m2.1.1.3.cmml" xref="S3.p8.7.m2.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p8.7.m2.1c">j_{r}</annotation><annotation encoding="application/x-llamapun" id="S3.p8.7.m2.1d">italic_j start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT</annotation></semantics></math>, reducing its direct impact on <math alttext="j_{y}" class="ltx_Math" display="inline" id="S3.p8.8.m3.1"><semantics id="S3.p8.8.m3.1a"><msub id="S3.p8.8.m3.1.1" xref="S3.p8.8.m3.1.1.cmml"><mi id="S3.p8.8.m3.1.1.2" xref="S3.p8.8.m3.1.1.2.cmml">j</mi><mi id="S3.p8.8.m3.1.1.3" xref="S3.p8.8.m3.1.1.3.cmml">y</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p8.8.m3.1b"><apply id="S3.p8.8.m3.1.1.cmml" xref="S3.p8.8.m3.1.1"><csymbol cd="ambiguous" id="S3.p8.8.m3.1.1.1.cmml" xref="S3.p8.8.m3.1.1">subscript</csymbol><ci id="S3.p8.8.m3.1.1.2.cmml" xref="S3.p8.8.m3.1.1.2">𝑗</ci><ci id="S3.p8.8.m3.1.1.3.cmml" xref="S3.p8.8.m3.1.1.3">𝑦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p8.8.m3.1c">j_{y}</annotation><annotation encoding="application/x-llamapun" id="S3.p8.8.m3.1d">italic_j start_POSTSUBSCRIPT italic_y end_POSTSUBSCRIPT</annotation></semantics></math>.
We can formalize the loss function as:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E8">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\ell(\theta)=-\sum_{(p,j)\in D}\log P_{\theta}(j_{y}\mid p)-\sum_{(p,j)\in D}%
\log P_{\theta}(j_{r}\mid p)" class="ltx_Math" display="block" id="S3.E8.m1.7"><semantics id="S3.E8.m1.7a"><mrow id="S3.E8.m1.7.7" xref="S3.E8.m1.7.7.cmml"><mrow id="S3.E8.m1.7.7.4" xref="S3.E8.m1.7.7.4.cmml"><mi id="S3.E8.m1.7.7.4.2" mathvariant="normal" xref="S3.E8.m1.7.7.4.2.cmml">ℓ</mi><mo id="S3.E8.m1.7.7.4.1" xref="S3.E8.m1.7.7.4.1.cmml">⁢</mo><mrow id="S3.E8.m1.7.7.4.3.2" xref="S3.E8.m1.7.7.4.cmml"><mo id="S3.E8.m1.7.7.4.3.2.1" stretchy="false" xref="S3.E8.m1.7.7.4.cmml">(</mo><mi id="S3.E8.m1.5.5" xref="S3.E8.m1.5.5.cmml">θ</mi><mo id="S3.E8.m1.7.7.4.3.2.2" stretchy="false" xref="S3.E8.m1.7.7.4.cmml">)</mo></mrow></mrow><mo id="S3.E8.m1.7.7.3" xref="S3.E8.m1.7.7.3.cmml">=</mo><mrow id="S3.E8.m1.7.7.2" xref="S3.E8.m1.7.7.2.cmml"><mrow id="S3.E8.m1.6.6.1.1" xref="S3.E8.m1.6.6.1.1.cmml"><mo id="S3.E8.m1.6.6.1.1a" xref="S3.E8.m1.6.6.1.1.cmml">−</mo><mrow id="S3.E8.m1.6.6.1.1.1" xref="S3.E8.m1.6.6.1.1.1.cmml"><munder id="S3.E8.m1.6.6.1.1.1.2" xref="S3.E8.m1.6.6.1.1.1.2.cmml"><mo id="S3.E8.m1.6.6.1.1.1.2.2" movablelimits="false" xref="S3.E8.m1.6.6.1.1.1.2.2.cmml">∑</mo><mrow id="S3.E8.m1.2.2.2" xref="S3.E8.m1.2.2.2.cmml"><mrow id="S3.E8.m1.2.2.2.4.2" xref="S3.E8.m1.2.2.2.4.1.cmml"><mo id="S3.E8.m1.2.2.2.4.2.1" stretchy="false" xref="S3.E8.m1.2.2.2.4.1.cmml">(</mo><mi id="S3.E8.m1.1.1.1.1" xref="S3.E8.m1.1.1.1.1.cmml">p</mi><mo id="S3.E8.m1.2.2.2.4.2.2" xref="S3.E8.m1.2.2.2.4.1.cmml">,</mo><mi id="S3.E8.m1.2.2.2.2" xref="S3.E8.m1.2.2.2.2.cmml">j</mi><mo id="S3.E8.m1.2.2.2.4.2.3" stretchy="false" xref="S3.E8.m1.2.2.2.4.1.cmml">)</mo></mrow><mo id="S3.E8.m1.2.2.2.3" xref="S3.E8.m1.2.2.2.3.cmml">∈</mo><mi id="S3.E8.m1.2.2.2.5" xref="S3.E8.m1.2.2.2.5.cmml">D</mi></mrow></munder><mrow id="S3.E8.m1.6.6.1.1.1.1" xref="S3.E8.m1.6.6.1.1.1.1.cmml"><mrow id="S3.E8.m1.6.6.1.1.1.1.3" xref="S3.E8.m1.6.6.1.1.1.1.3.cmml"><mi id="S3.E8.m1.6.6.1.1.1.1.3.1" xref="S3.E8.m1.6.6.1.1.1.1.3.1.cmml">log</mi><mo id="S3.E8.m1.6.6.1.1.1.1.3a" lspace="0.167em" xref="S3.E8.m1.6.6.1.1.1.1.3.cmml">⁡</mo><msub id="S3.E8.m1.6.6.1.1.1.1.3.2" xref="S3.E8.m1.6.6.1.1.1.1.3.2.cmml"><mi id="S3.E8.m1.6.6.1.1.1.1.3.2.2" xref="S3.E8.m1.6.6.1.1.1.1.3.2.2.cmml">P</mi><mi id="S3.E8.m1.6.6.1.1.1.1.3.2.3" xref="S3.E8.m1.6.6.1.1.1.1.3.2.3.cmml">θ</mi></msub></mrow><mo id="S3.E8.m1.6.6.1.1.1.1.2" xref="S3.E8.m1.6.6.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E8.m1.6.6.1.1.1.1.1.1" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.cmml"><mo id="S3.E8.m1.6.6.1.1.1.1.1.1.2" stretchy="false" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E8.m1.6.6.1.1.1.1.1.1.1" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.cmml"><msub id="S3.E8.m1.6.6.1.1.1.1.1.1.1.2" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E8.m1.6.6.1.1.1.1.1.1.1.2.2" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.2.2.cmml">j</mi><mi id="S3.E8.m1.6.6.1.1.1.1.1.1.1.2.3" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.2.3.cmml">y</mi></msub><mo id="S3.E8.m1.6.6.1.1.1.1.1.1.1.1" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.1.cmml">∣</mo><mi id="S3.E8.m1.6.6.1.1.1.1.1.1.1.3" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.3.cmml">p</mi></mrow><mo id="S3.E8.m1.6.6.1.1.1.1.1.1.3" stretchy="false" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E8.m1.7.7.2.3" rspace="0.055em" xref="S3.E8.m1.7.7.2.3.cmml">−</mo><mrow id="S3.E8.m1.7.7.2.2" xref="S3.E8.m1.7.7.2.2.cmml"><munder id="S3.E8.m1.7.7.2.2.2" xref="S3.E8.m1.7.7.2.2.2.cmml"><mo id="S3.E8.m1.7.7.2.2.2.2" movablelimits="false" xref="S3.E8.m1.7.7.2.2.2.2.cmml">∑</mo><mrow id="S3.E8.m1.4.4.2" xref="S3.E8.m1.4.4.2.cmml"><mrow id="S3.E8.m1.4.4.2.4.2" xref="S3.E8.m1.4.4.2.4.1.cmml"><mo id="S3.E8.m1.4.4.2.4.2.1" stretchy="false" xref="S3.E8.m1.4.4.2.4.1.cmml">(</mo><mi id="S3.E8.m1.3.3.1.1" xref="S3.E8.m1.3.3.1.1.cmml">p</mi><mo id="S3.E8.m1.4.4.2.4.2.2" xref="S3.E8.m1.4.4.2.4.1.cmml">,</mo><mi id="S3.E8.m1.4.4.2.2" xref="S3.E8.m1.4.4.2.2.cmml">j</mi><mo id="S3.E8.m1.4.4.2.4.2.3" stretchy="false" xref="S3.E8.m1.4.4.2.4.1.cmml">)</mo></mrow><mo id="S3.E8.m1.4.4.2.3" xref="S3.E8.m1.4.4.2.3.cmml">∈</mo><mi id="S3.E8.m1.4.4.2.5" xref="S3.E8.m1.4.4.2.5.cmml">D</mi></mrow></munder><mrow id="S3.E8.m1.7.7.2.2.1" xref="S3.E8.m1.7.7.2.2.1.cmml"><mrow id="S3.E8.m1.7.7.2.2.1.3" xref="S3.E8.m1.7.7.2.2.1.3.cmml"><mi id="S3.E8.m1.7.7.2.2.1.3.1" xref="S3.E8.m1.7.7.2.2.1.3.1.cmml">log</mi><mo id="S3.E8.m1.7.7.2.2.1.3a" lspace="0.167em" xref="S3.E8.m1.7.7.2.2.1.3.cmml">⁡</mo><msub id="S3.E8.m1.7.7.2.2.1.3.2" xref="S3.E8.m1.7.7.2.2.1.3.2.cmml"><mi id="S3.E8.m1.7.7.2.2.1.3.2.2" xref="S3.E8.m1.7.7.2.2.1.3.2.2.cmml">P</mi><mi id="S3.E8.m1.7.7.2.2.1.3.2.3" xref="S3.E8.m1.7.7.2.2.1.3.2.3.cmml">θ</mi></msub></mrow><mo id="S3.E8.m1.7.7.2.2.1.2" xref="S3.E8.m1.7.7.2.2.1.2.cmml">⁢</mo><mrow id="S3.E8.m1.7.7.2.2.1.1.1" xref="S3.E8.m1.7.7.2.2.1.1.1.1.cmml"><mo id="S3.E8.m1.7.7.2.2.1.1.1.2" stretchy="false" xref="S3.E8.m1.7.7.2.2.1.1.1.1.cmml">(</mo><mrow id="S3.E8.m1.7.7.2.2.1.1.1.1" xref="S3.E8.m1.7.7.2.2.1.1.1.1.cmml"><msub id="S3.E8.m1.7.7.2.2.1.1.1.1.2" xref="S3.E8.m1.7.7.2.2.1.1.1.1.2.cmml"><mi id="S3.E8.m1.7.7.2.2.1.1.1.1.2.2" xref="S3.E8.m1.7.7.2.2.1.1.1.1.2.2.cmml">j</mi><mi id="S3.E8.m1.7.7.2.2.1.1.1.1.2.3" xref="S3.E8.m1.7.7.2.2.1.1.1.1.2.3.cmml">r</mi></msub><mo id="S3.E8.m1.7.7.2.2.1.1.1.1.1" xref="S3.E8.m1.7.7.2.2.1.1.1.1.1.cmml">∣</mo><mi id="S3.E8.m1.7.7.2.2.1.1.1.1.3" xref="S3.E8.m1.7.7.2.2.1.1.1.1.3.cmml">p</mi></mrow><mo id="S3.E8.m1.7.7.2.2.1.1.1.3" stretchy="false" xref="S3.E8.m1.7.7.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E8.m1.7b"><apply id="S3.E8.m1.7.7.cmml" xref="S3.E8.m1.7.7"><eq id="S3.E8.m1.7.7.3.cmml" xref="S3.E8.m1.7.7.3"></eq><apply id="S3.E8.m1.7.7.4.cmml" xref="S3.E8.m1.7.7.4"><times id="S3.E8.m1.7.7.4.1.cmml" xref="S3.E8.m1.7.7.4.1"></times><ci id="S3.E8.m1.7.7.4.2.cmml" xref="S3.E8.m1.7.7.4.2">ℓ</ci><ci id="S3.E8.m1.5.5.cmml" xref="S3.E8.m1.5.5">𝜃</ci></apply><apply id="S3.E8.m1.7.7.2.cmml" xref="S3.E8.m1.7.7.2"><minus id="S3.E8.m1.7.7.2.3.cmml" xref="S3.E8.m1.7.7.2.3"></minus><apply id="S3.E8.m1.6.6.1.1.cmml" xref="S3.E8.m1.6.6.1.1"><minus id="S3.E8.m1.6.6.1.1.2.cmml" xref="S3.E8.m1.6.6.1.1"></minus><apply id="S3.E8.m1.6.6.1.1.1.cmml" xref="S3.E8.m1.6.6.1.1.1"><apply id="S3.E8.m1.6.6.1.1.1.2.cmml" xref="S3.E8.m1.6.6.1.1.1.2"><csymbol cd="ambiguous" id="S3.E8.m1.6.6.1.1.1.2.1.cmml" xref="S3.E8.m1.6.6.1.1.1.2">subscript</csymbol><sum id="S3.E8.m1.6.6.1.1.1.2.2.cmml" xref="S3.E8.m1.6.6.1.1.1.2.2"></sum><apply id="S3.E8.m1.2.2.2.cmml" xref="S3.E8.m1.2.2.2"><in id="S3.E8.m1.2.2.2.3.cmml" xref="S3.E8.m1.2.2.2.3"></in><interval closure="open" id="S3.E8.m1.2.2.2.4.1.cmml" xref="S3.E8.m1.2.2.2.4.2"><ci id="S3.E8.m1.1.1.1.1.cmml" xref="S3.E8.m1.1.1.1.1">𝑝</ci><ci id="S3.E8.m1.2.2.2.2.cmml" xref="S3.E8.m1.2.2.2.2">𝑗</ci></interval><ci id="S3.E8.m1.2.2.2.5.cmml" xref="S3.E8.m1.2.2.2.5">𝐷</ci></apply></apply><apply id="S3.E8.m1.6.6.1.1.1.1.cmml" xref="S3.E8.m1.6.6.1.1.1.1"><times id="S3.E8.m1.6.6.1.1.1.1.2.cmml" xref="S3.E8.m1.6.6.1.1.1.1.2"></times><apply id="S3.E8.m1.6.6.1.1.1.1.3.cmml" xref="S3.E8.m1.6.6.1.1.1.1.3"><log id="S3.E8.m1.6.6.1.1.1.1.3.1.cmml" xref="S3.E8.m1.6.6.1.1.1.1.3.1"></log><apply id="S3.E8.m1.6.6.1.1.1.1.3.2.cmml" xref="S3.E8.m1.6.6.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E8.m1.6.6.1.1.1.1.3.2.1.cmml" xref="S3.E8.m1.6.6.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E8.m1.6.6.1.1.1.1.3.2.2.cmml" xref="S3.E8.m1.6.6.1.1.1.1.3.2.2">𝑃</ci><ci id="S3.E8.m1.6.6.1.1.1.1.3.2.3.cmml" xref="S3.E8.m1.6.6.1.1.1.1.3.2.3">𝜃</ci></apply></apply><apply id="S3.E8.m1.6.6.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.6.6.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E8.m1.6.6.1.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.1">conditional</csymbol><apply id="S3.E8.m1.6.6.1.1.1.1.1.1.1.2.cmml" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E8.m1.6.6.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E8.m1.6.6.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.2.2">𝑗</ci><ci id="S3.E8.m1.6.6.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.2.3">𝑦</ci></apply><ci id="S3.E8.m1.6.6.1.1.1.1.1.1.1.3.cmml" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.3">𝑝</ci></apply></apply></apply></apply><apply id="S3.E8.m1.7.7.2.2.cmml" xref="S3.E8.m1.7.7.2.2"><apply id="S3.E8.m1.7.7.2.2.2.cmml" xref="S3.E8.m1.7.7.2.2.2"><csymbol cd="ambiguous" id="S3.E8.m1.7.7.2.2.2.1.cmml" xref="S3.E8.m1.7.7.2.2.2">subscript</csymbol><sum id="S3.E8.m1.7.7.2.2.2.2.cmml" xref="S3.E8.m1.7.7.2.2.2.2"></sum><apply id="S3.E8.m1.4.4.2.cmml" xref="S3.E8.m1.4.4.2"><in id="S3.E8.m1.4.4.2.3.cmml" xref="S3.E8.m1.4.4.2.3"></in><interval closure="open" id="S3.E8.m1.4.4.2.4.1.cmml" xref="S3.E8.m1.4.4.2.4.2"><ci id="S3.E8.m1.3.3.1.1.cmml" xref="S3.E8.m1.3.3.1.1">𝑝</ci><ci id="S3.E8.m1.4.4.2.2.cmml" xref="S3.E8.m1.4.4.2.2">𝑗</ci></interval><ci id="S3.E8.m1.4.4.2.5.cmml" xref="S3.E8.m1.4.4.2.5">𝐷</ci></apply></apply><apply id="S3.E8.m1.7.7.2.2.1.cmml" xref="S3.E8.m1.7.7.2.2.1"><times id="S3.E8.m1.7.7.2.2.1.2.cmml" xref="S3.E8.m1.7.7.2.2.1.2"></times><apply id="S3.E8.m1.7.7.2.2.1.3.cmml" xref="S3.E8.m1.7.7.2.2.1.3"><log id="S3.E8.m1.7.7.2.2.1.3.1.cmml" xref="S3.E8.m1.7.7.2.2.1.3.1"></log><apply id="S3.E8.m1.7.7.2.2.1.3.2.cmml" xref="S3.E8.m1.7.7.2.2.1.3.2"><csymbol cd="ambiguous" id="S3.E8.m1.7.7.2.2.1.3.2.1.cmml" xref="S3.E8.m1.7.7.2.2.1.3.2">subscript</csymbol><ci id="S3.E8.m1.7.7.2.2.1.3.2.2.cmml" xref="S3.E8.m1.7.7.2.2.1.3.2.2">𝑃</ci><ci id="S3.E8.m1.7.7.2.2.1.3.2.3.cmml" xref="S3.E8.m1.7.7.2.2.1.3.2.3">𝜃</ci></apply></apply><apply id="S3.E8.m1.7.7.2.2.1.1.1.1.cmml" xref="S3.E8.m1.7.7.2.2.1.1.1"><csymbol cd="latexml" id="S3.E8.m1.7.7.2.2.1.1.1.1.1.cmml" xref="S3.E8.m1.7.7.2.2.1.1.1.1.1">conditional</csymbol><apply id="S3.E8.m1.7.7.2.2.1.1.1.1.2.cmml" xref="S3.E8.m1.7.7.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E8.m1.7.7.2.2.1.1.1.1.2.1.cmml" xref="S3.E8.m1.7.7.2.2.1.1.1.1.2">subscript</csymbol><ci id="S3.E8.m1.7.7.2.2.1.1.1.1.2.2.cmml" xref="S3.E8.m1.7.7.2.2.1.1.1.1.2.2">𝑗</ci><ci id="S3.E8.m1.7.7.2.2.1.1.1.1.2.3.cmml" xref="S3.E8.m1.7.7.2.2.1.1.1.1.2.3">𝑟</ci></apply><ci id="S3.E8.m1.7.7.2.2.1.1.1.1.3.cmml" xref="S3.E8.m1.7.7.2.2.1.1.1.1.3">𝑝</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E8.m1.7c">\ell(\theta)=-\sum_{(p,j)\in D}\log P_{\theta}(j_{y}\mid p)-\sum_{(p,j)\in D}%
\log P_{\theta}(j_{r}\mid p)</annotation><annotation encoding="application/x-llamapun" id="S3.E8.m1.7d">roman_ℓ ( italic_θ ) = - ∑ start_POSTSUBSCRIPT ( italic_p , italic_j ) ∈ italic_D end_POSTSUBSCRIPT roman_log italic_P start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_j start_POSTSUBSCRIPT italic_y end_POSTSUBSCRIPT ∣ italic_p ) - ∑ start_POSTSUBSCRIPT ( italic_p , italic_j ) ∈ italic_D end_POSTSUBSCRIPT roman_log italic_P start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_j start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ∣ italic_p )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.p8.11">The loss <math alttext="P_{\theta}(j_{r}\mid p)" class="ltx_Math" display="inline" id="S3.p8.9.m1.1"><semantics id="S3.p8.9.m1.1a"><mrow id="S3.p8.9.m1.1.1" xref="S3.p8.9.m1.1.1.cmml"><msub id="S3.p8.9.m1.1.1.3" xref="S3.p8.9.m1.1.1.3.cmml"><mi id="S3.p8.9.m1.1.1.3.2" xref="S3.p8.9.m1.1.1.3.2.cmml">P</mi><mi id="S3.p8.9.m1.1.1.3.3" xref="S3.p8.9.m1.1.1.3.3.cmml">θ</mi></msub><mo id="S3.p8.9.m1.1.1.2" xref="S3.p8.9.m1.1.1.2.cmml">⁢</mo><mrow id="S3.p8.9.m1.1.1.1.1" xref="S3.p8.9.m1.1.1.1.1.1.cmml"><mo id="S3.p8.9.m1.1.1.1.1.2" stretchy="false" xref="S3.p8.9.m1.1.1.1.1.1.cmml">(</mo><mrow id="S3.p8.9.m1.1.1.1.1.1" xref="S3.p8.9.m1.1.1.1.1.1.cmml"><msub id="S3.p8.9.m1.1.1.1.1.1.2" xref="S3.p8.9.m1.1.1.1.1.1.2.cmml"><mi id="S3.p8.9.m1.1.1.1.1.1.2.2" xref="S3.p8.9.m1.1.1.1.1.1.2.2.cmml">j</mi><mi id="S3.p8.9.m1.1.1.1.1.1.2.3" xref="S3.p8.9.m1.1.1.1.1.1.2.3.cmml">r</mi></msub><mo id="S3.p8.9.m1.1.1.1.1.1.1" xref="S3.p8.9.m1.1.1.1.1.1.1.cmml">∣</mo><mi id="S3.p8.9.m1.1.1.1.1.1.3" xref="S3.p8.9.m1.1.1.1.1.1.3.cmml">p</mi></mrow><mo id="S3.p8.9.m1.1.1.1.1.3" stretchy="false" xref="S3.p8.9.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p8.9.m1.1b"><apply id="S3.p8.9.m1.1.1.cmml" xref="S3.p8.9.m1.1.1"><times id="S3.p8.9.m1.1.1.2.cmml" xref="S3.p8.9.m1.1.1.2"></times><apply id="S3.p8.9.m1.1.1.3.cmml" xref="S3.p8.9.m1.1.1.3"><csymbol cd="ambiguous" id="S3.p8.9.m1.1.1.3.1.cmml" xref="S3.p8.9.m1.1.1.3">subscript</csymbol><ci id="S3.p8.9.m1.1.1.3.2.cmml" xref="S3.p8.9.m1.1.1.3.2">𝑃</ci><ci id="S3.p8.9.m1.1.1.3.3.cmml" xref="S3.p8.9.m1.1.1.3.3">𝜃</ci></apply><apply id="S3.p8.9.m1.1.1.1.1.1.cmml" xref="S3.p8.9.m1.1.1.1.1"><csymbol cd="latexml" id="S3.p8.9.m1.1.1.1.1.1.1.cmml" xref="S3.p8.9.m1.1.1.1.1.1.1">conditional</csymbol><apply id="S3.p8.9.m1.1.1.1.1.1.2.cmml" xref="S3.p8.9.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.p8.9.m1.1.1.1.1.1.2.1.cmml" xref="S3.p8.9.m1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.p8.9.m1.1.1.1.1.1.2.2.cmml" xref="S3.p8.9.m1.1.1.1.1.1.2.2">𝑗</ci><ci id="S3.p8.9.m1.1.1.1.1.1.2.3.cmml" xref="S3.p8.9.m1.1.1.1.1.1.2.3">𝑟</ci></apply><ci id="S3.p8.9.m1.1.1.1.1.1.3.cmml" xref="S3.p8.9.m1.1.1.1.1.1.3">𝑝</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p8.9.m1.1c">P_{\theta}(j_{r}\mid p)</annotation><annotation encoding="application/x-llamapun" id="S3.p8.9.m1.1d">italic_P start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_j start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ∣ italic_p )</annotation></semantics></math> encourages the model to find representations that are also effective for predicting <math alttext="j_{r}" class="ltx_Math" display="inline" id="S3.p8.10.m2.1"><semantics id="S3.p8.10.m2.1a"><msub id="S3.p8.10.m2.1.1" xref="S3.p8.10.m2.1.1.cmml"><mi id="S3.p8.10.m2.1.1.2" xref="S3.p8.10.m2.1.1.2.cmml">j</mi><mi id="S3.p8.10.m2.1.1.3" xref="S3.p8.10.m2.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p8.10.m2.1b"><apply id="S3.p8.10.m2.1.1.cmml" xref="S3.p8.10.m2.1.1"><csymbol cd="ambiguous" id="S3.p8.10.m2.1.1.1.cmml" xref="S3.p8.10.m2.1.1">subscript</csymbol><ci id="S3.p8.10.m2.1.1.2.cmml" xref="S3.p8.10.m2.1.1.2">𝑗</ci><ci id="S3.p8.10.m2.1.1.3.cmml" xref="S3.p8.10.m2.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p8.10.m2.1c">j_{r}</annotation><annotation encoding="application/x-llamapun" id="S3.p8.10.m2.1d">italic_j start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT</annotation></semantics></math>, as it is less influenced by the bias compared <math alttext="P_{\theta}(j_{y}\mid p)" class="ltx_Math" display="inline" id="S3.p8.11.m3.1"><semantics id="S3.p8.11.m3.1a"><mrow id="S3.p8.11.m3.1.1" xref="S3.p8.11.m3.1.1.cmml"><msub id="S3.p8.11.m3.1.1.3" xref="S3.p8.11.m3.1.1.3.cmml"><mi id="S3.p8.11.m3.1.1.3.2" xref="S3.p8.11.m3.1.1.3.2.cmml">P</mi><mi id="S3.p8.11.m3.1.1.3.3" xref="S3.p8.11.m3.1.1.3.3.cmml">θ</mi></msub><mo id="S3.p8.11.m3.1.1.2" xref="S3.p8.11.m3.1.1.2.cmml">⁢</mo><mrow id="S3.p8.11.m3.1.1.1.1" xref="S3.p8.11.m3.1.1.1.1.1.cmml"><mo id="S3.p8.11.m3.1.1.1.1.2" stretchy="false" xref="S3.p8.11.m3.1.1.1.1.1.cmml">(</mo><mrow id="S3.p8.11.m3.1.1.1.1.1" xref="S3.p8.11.m3.1.1.1.1.1.cmml"><msub id="S3.p8.11.m3.1.1.1.1.1.2" xref="S3.p8.11.m3.1.1.1.1.1.2.cmml"><mi id="S3.p8.11.m3.1.1.1.1.1.2.2" xref="S3.p8.11.m3.1.1.1.1.1.2.2.cmml">j</mi><mi id="S3.p8.11.m3.1.1.1.1.1.2.3" xref="S3.p8.11.m3.1.1.1.1.1.2.3.cmml">y</mi></msub><mo id="S3.p8.11.m3.1.1.1.1.1.1" xref="S3.p8.11.m3.1.1.1.1.1.1.cmml">∣</mo><mi id="S3.p8.11.m3.1.1.1.1.1.3" xref="S3.p8.11.m3.1.1.1.1.1.3.cmml">p</mi></mrow><mo id="S3.p8.11.m3.1.1.1.1.3" stretchy="false" xref="S3.p8.11.m3.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p8.11.m3.1b"><apply id="S3.p8.11.m3.1.1.cmml" xref="S3.p8.11.m3.1.1"><times id="S3.p8.11.m3.1.1.2.cmml" xref="S3.p8.11.m3.1.1.2"></times><apply id="S3.p8.11.m3.1.1.3.cmml" xref="S3.p8.11.m3.1.1.3"><csymbol cd="ambiguous" id="S3.p8.11.m3.1.1.3.1.cmml" xref="S3.p8.11.m3.1.1.3">subscript</csymbol><ci id="S3.p8.11.m3.1.1.3.2.cmml" xref="S3.p8.11.m3.1.1.3.2">𝑃</ci><ci id="S3.p8.11.m3.1.1.3.3.cmml" xref="S3.p8.11.m3.1.1.3.3">𝜃</ci></apply><apply id="S3.p8.11.m3.1.1.1.1.1.cmml" xref="S3.p8.11.m3.1.1.1.1"><csymbol cd="latexml" id="S3.p8.11.m3.1.1.1.1.1.1.cmml" xref="S3.p8.11.m3.1.1.1.1.1.1">conditional</csymbol><apply id="S3.p8.11.m3.1.1.1.1.1.2.cmml" xref="S3.p8.11.m3.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.p8.11.m3.1.1.1.1.1.2.1.cmml" xref="S3.p8.11.m3.1.1.1.1.1.2">subscript</csymbol><ci id="S3.p8.11.m3.1.1.1.1.1.2.2.cmml" xref="S3.p8.11.m3.1.1.1.1.1.2.2">𝑗</ci><ci id="S3.p8.11.m3.1.1.1.1.1.2.3.cmml" xref="S3.p8.11.m3.1.1.1.1.1.2.3">𝑦</ci></apply><ci id="S3.p8.11.m3.1.1.1.1.1.3.cmml" xref="S3.p8.11.m3.1.1.1.1.1.3">𝑝</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p8.11.m3.1c">P_{\theta}(j_{y}\mid p)</annotation><annotation encoding="application/x-llamapun" id="S3.p8.11.m3.1d">italic_P start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_j start_POSTSUBSCRIPT italic_y end_POSTSUBSCRIPT ∣ italic_p )</annotation></semantics></math>, which solely depends on the dataset’s preference annotation.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.p9">
<p class="ltx_p" id="S3.p9.6"><span class="ltx_text ltx_font_bold" id="S3.p9.6.1">Generative judge resists bias with a better prior.</span> 
SM modifies the LLM’s architecture with a classification head and uses a discriminative training target.
On the contrary, Con-J uses an architecture consistent with the pertaining process and generative training objectives (<cite class="ltx_cite ltx_citemacro_cite">Zhang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03742v1#bib.bib39" title="">2024</a>)</cite>).
We refer to <cite class="ltx_cite ltx_citemacro_citet">Erhan et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03742v1#bib.bib9" title="">2009</a>)</cite> and assume the parameter inherited from the pre-trained LLM as adding an infinite penalty:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E9">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\ell(\theta)=\ell_{data}(\theta)+\frac{\lambda}{2}||\theta-\theta_{0}||^{2}" class="ltx_Math" display="block" id="S3.E9.m1.3"><semantics id="S3.E9.m1.3a"><mrow id="S3.E9.m1.3.3" xref="S3.E9.m1.3.3.cmml"><mrow id="S3.E9.m1.3.3.3" xref="S3.E9.m1.3.3.3.cmml"><mi id="S3.E9.m1.3.3.3.2" mathvariant="normal" xref="S3.E9.m1.3.3.3.2.cmml">ℓ</mi><mo id="S3.E9.m1.3.3.3.1" xref="S3.E9.m1.3.3.3.1.cmml">⁢</mo><mrow id="S3.E9.m1.3.3.3.3.2" xref="S3.E9.m1.3.3.3.cmml"><mo id="S3.E9.m1.3.3.3.3.2.1" stretchy="false" xref="S3.E9.m1.3.3.3.cmml">(</mo><mi id="S3.E9.m1.1.1" xref="S3.E9.m1.1.1.cmml">θ</mi><mo id="S3.E9.m1.3.3.3.3.2.2" stretchy="false" xref="S3.E9.m1.3.3.3.cmml">)</mo></mrow></mrow><mo id="S3.E9.m1.3.3.2" xref="S3.E9.m1.3.3.2.cmml">=</mo><mrow id="S3.E9.m1.3.3.1" xref="S3.E9.m1.3.3.1.cmml"><mrow id="S3.E9.m1.3.3.1.3" xref="S3.E9.m1.3.3.1.3.cmml"><msub id="S3.E9.m1.3.3.1.3.2" xref="S3.E9.m1.3.3.1.3.2.cmml"><mi id="S3.E9.m1.3.3.1.3.2.2" mathvariant="normal" xref="S3.E9.m1.3.3.1.3.2.2.cmml">ℓ</mi><mrow id="S3.E9.m1.3.3.1.3.2.3" xref="S3.E9.m1.3.3.1.3.2.3.cmml"><mi id="S3.E9.m1.3.3.1.3.2.3.2" xref="S3.E9.m1.3.3.1.3.2.3.2.cmml">d</mi><mo id="S3.E9.m1.3.3.1.3.2.3.1" xref="S3.E9.m1.3.3.1.3.2.3.1.cmml">⁢</mo><mi id="S3.E9.m1.3.3.1.3.2.3.3" xref="S3.E9.m1.3.3.1.3.2.3.3.cmml">a</mi><mo id="S3.E9.m1.3.3.1.3.2.3.1a" xref="S3.E9.m1.3.3.1.3.2.3.1.cmml">⁢</mo><mi id="S3.E9.m1.3.3.1.3.2.3.4" xref="S3.E9.m1.3.3.1.3.2.3.4.cmml">t</mi><mo id="S3.E9.m1.3.3.1.3.2.3.1b" xref="S3.E9.m1.3.3.1.3.2.3.1.cmml">⁢</mo><mi id="S3.E9.m1.3.3.1.3.2.3.5" xref="S3.E9.m1.3.3.1.3.2.3.5.cmml">a</mi></mrow></msub><mo id="S3.E9.m1.3.3.1.3.1" xref="S3.E9.m1.3.3.1.3.1.cmml">⁢</mo><mrow id="S3.E9.m1.3.3.1.3.3.2" xref="S3.E9.m1.3.3.1.3.cmml"><mo id="S3.E9.m1.3.3.1.3.3.2.1" stretchy="false" xref="S3.E9.m1.3.3.1.3.cmml">(</mo><mi id="S3.E9.m1.2.2" xref="S3.E9.m1.2.2.cmml">θ</mi><mo id="S3.E9.m1.3.3.1.3.3.2.2" stretchy="false" xref="S3.E9.m1.3.3.1.3.cmml">)</mo></mrow></mrow><mo id="S3.E9.m1.3.3.1.2" xref="S3.E9.m1.3.3.1.2.cmml">+</mo><mrow id="S3.E9.m1.3.3.1.1" xref="S3.E9.m1.3.3.1.1.cmml"><mfrac id="S3.E9.m1.3.3.1.1.3" xref="S3.E9.m1.3.3.1.1.3.cmml"><mi id="S3.E9.m1.3.3.1.1.3.2" xref="S3.E9.m1.3.3.1.1.3.2.cmml">λ</mi><mn id="S3.E9.m1.3.3.1.1.3.3" xref="S3.E9.m1.3.3.1.1.3.3.cmml">2</mn></mfrac><mo id="S3.E9.m1.3.3.1.1.2" xref="S3.E9.m1.3.3.1.1.2.cmml">⁢</mo><msup id="S3.E9.m1.3.3.1.1.1" xref="S3.E9.m1.3.3.1.1.1.cmml"><mrow id="S3.E9.m1.3.3.1.1.1.1.1" xref="S3.E9.m1.3.3.1.1.1.1.2.cmml"><mo id="S3.E9.m1.3.3.1.1.1.1.1.2" stretchy="false" xref="S3.E9.m1.3.3.1.1.1.1.2.1.cmml">‖</mo><mrow id="S3.E9.m1.3.3.1.1.1.1.1.1" xref="S3.E9.m1.3.3.1.1.1.1.1.1.cmml"><mi id="S3.E9.m1.3.3.1.1.1.1.1.1.2" xref="S3.E9.m1.3.3.1.1.1.1.1.1.2.cmml">θ</mi><mo id="S3.E9.m1.3.3.1.1.1.1.1.1.1" xref="S3.E9.m1.3.3.1.1.1.1.1.1.1.cmml">−</mo><msub id="S3.E9.m1.3.3.1.1.1.1.1.1.3" xref="S3.E9.m1.3.3.1.1.1.1.1.1.3.cmml"><mi id="S3.E9.m1.3.3.1.1.1.1.1.1.3.2" xref="S3.E9.m1.3.3.1.1.1.1.1.1.3.2.cmml">θ</mi><mn id="S3.E9.m1.3.3.1.1.1.1.1.1.3.3" xref="S3.E9.m1.3.3.1.1.1.1.1.1.3.3.cmml">0</mn></msub></mrow><mo id="S3.E9.m1.3.3.1.1.1.1.1.3" stretchy="false" xref="S3.E9.m1.3.3.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S3.E9.m1.3.3.1.1.1.3" xref="S3.E9.m1.3.3.1.1.1.3.cmml">2</mn></msup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E9.m1.3b"><apply id="S3.E9.m1.3.3.cmml" xref="S3.E9.m1.3.3"><eq id="S3.E9.m1.3.3.2.cmml" xref="S3.E9.m1.3.3.2"></eq><apply id="S3.E9.m1.3.3.3.cmml" xref="S3.E9.m1.3.3.3"><times id="S3.E9.m1.3.3.3.1.cmml" xref="S3.E9.m1.3.3.3.1"></times><ci id="S3.E9.m1.3.3.3.2.cmml" xref="S3.E9.m1.3.3.3.2">ℓ</ci><ci id="S3.E9.m1.1.1.cmml" xref="S3.E9.m1.1.1">𝜃</ci></apply><apply id="S3.E9.m1.3.3.1.cmml" xref="S3.E9.m1.3.3.1"><plus id="S3.E9.m1.3.3.1.2.cmml" xref="S3.E9.m1.3.3.1.2"></plus><apply id="S3.E9.m1.3.3.1.3.cmml" xref="S3.E9.m1.3.3.1.3"><times id="S3.E9.m1.3.3.1.3.1.cmml" xref="S3.E9.m1.3.3.1.3.1"></times><apply id="S3.E9.m1.3.3.1.3.2.cmml" xref="S3.E9.m1.3.3.1.3.2"><csymbol cd="ambiguous" id="S3.E9.m1.3.3.1.3.2.1.cmml" xref="S3.E9.m1.3.3.1.3.2">subscript</csymbol><ci id="S3.E9.m1.3.3.1.3.2.2.cmml" xref="S3.E9.m1.3.3.1.3.2.2">ℓ</ci><apply id="S3.E9.m1.3.3.1.3.2.3.cmml" xref="S3.E9.m1.3.3.1.3.2.3"><times id="S3.E9.m1.3.3.1.3.2.3.1.cmml" xref="S3.E9.m1.3.3.1.3.2.3.1"></times><ci id="S3.E9.m1.3.3.1.3.2.3.2.cmml" xref="S3.E9.m1.3.3.1.3.2.3.2">𝑑</ci><ci id="S3.E9.m1.3.3.1.3.2.3.3.cmml" xref="S3.E9.m1.3.3.1.3.2.3.3">𝑎</ci><ci id="S3.E9.m1.3.3.1.3.2.3.4.cmml" xref="S3.E9.m1.3.3.1.3.2.3.4">𝑡</ci><ci id="S3.E9.m1.3.3.1.3.2.3.5.cmml" xref="S3.E9.m1.3.3.1.3.2.3.5">𝑎</ci></apply></apply><ci id="S3.E9.m1.2.2.cmml" xref="S3.E9.m1.2.2">𝜃</ci></apply><apply id="S3.E9.m1.3.3.1.1.cmml" xref="S3.E9.m1.3.3.1.1"><times id="S3.E9.m1.3.3.1.1.2.cmml" xref="S3.E9.m1.3.3.1.1.2"></times><apply id="S3.E9.m1.3.3.1.1.3.cmml" xref="S3.E9.m1.3.3.1.1.3"><divide id="S3.E9.m1.3.3.1.1.3.1.cmml" xref="S3.E9.m1.3.3.1.1.3"></divide><ci id="S3.E9.m1.3.3.1.1.3.2.cmml" xref="S3.E9.m1.3.3.1.1.3.2">𝜆</ci><cn id="S3.E9.m1.3.3.1.1.3.3.cmml" type="integer" xref="S3.E9.m1.3.3.1.1.3.3">2</cn></apply><apply id="S3.E9.m1.3.3.1.1.1.cmml" xref="S3.E9.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.E9.m1.3.3.1.1.1.2.cmml" xref="S3.E9.m1.3.3.1.1.1">superscript</csymbol><apply id="S3.E9.m1.3.3.1.1.1.1.2.cmml" xref="S3.E9.m1.3.3.1.1.1.1.1"><csymbol cd="latexml" id="S3.E9.m1.3.3.1.1.1.1.2.1.cmml" xref="S3.E9.m1.3.3.1.1.1.1.1.2">norm</csymbol><apply id="S3.E9.m1.3.3.1.1.1.1.1.1.cmml" xref="S3.E9.m1.3.3.1.1.1.1.1.1"><minus id="S3.E9.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S3.E9.m1.3.3.1.1.1.1.1.1.1"></minus><ci id="S3.E9.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S3.E9.m1.3.3.1.1.1.1.1.1.2">𝜃</ci><apply id="S3.E9.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S3.E9.m1.3.3.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E9.m1.3.3.1.1.1.1.1.1.3.1.cmml" xref="S3.E9.m1.3.3.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E9.m1.3.3.1.1.1.1.1.1.3.2.cmml" xref="S3.E9.m1.3.3.1.1.1.1.1.1.3.2">𝜃</ci><cn id="S3.E9.m1.3.3.1.1.1.1.1.1.3.3.cmml" type="integer" xref="S3.E9.m1.3.3.1.1.1.1.1.1.3.3">0</cn></apply></apply></apply><cn id="S3.E9.m1.3.3.1.1.1.3.cmml" type="integer" xref="S3.E9.m1.3.3.1.1.1.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E9.m1.3c">\ell(\theta)=\ell_{data}(\theta)+\frac{\lambda}{2}||\theta-\theta_{0}||^{2}</annotation><annotation encoding="application/x-llamapun" id="S3.E9.m1.3d">roman_ℓ ( italic_θ ) = roman_ℓ start_POSTSUBSCRIPT italic_d italic_a italic_t italic_a end_POSTSUBSCRIPT ( italic_θ ) + divide start_ARG italic_λ end_ARG start_ARG 2 end_ARG | | italic_θ - italic_θ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT | | start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.p9.5">where <math alttext="\lambda" class="ltx_Math" display="inline" id="S3.p9.1.m1.1"><semantics id="S3.p9.1.m1.1a"><mi id="S3.p9.1.m1.1.1" xref="S3.p9.1.m1.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S3.p9.1.m1.1b"><ci id="S3.p9.1.m1.1.1.cmml" xref="S3.p9.1.m1.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p9.1.m1.1c">\lambda</annotation><annotation encoding="application/x-llamapun" id="S3.p9.1.m1.1d">italic_λ</annotation></semantics></math> is the regularization strength.
We make an ideal hypothesis that there exists an optimal <math alttext="\theta^{*}" class="ltx_Math" display="inline" id="S3.p9.2.m2.1"><semantics id="S3.p9.2.m2.1a"><msup id="S3.p9.2.m2.1.1" xref="S3.p9.2.m2.1.1.cmml"><mi id="S3.p9.2.m2.1.1.2" xref="S3.p9.2.m2.1.1.2.cmml">θ</mi><mo id="S3.p9.2.m2.1.1.3" xref="S3.p9.2.m2.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="S3.p9.2.m2.1b"><apply id="S3.p9.2.m2.1.1.cmml" xref="S3.p9.2.m2.1.1"><csymbol cd="ambiguous" id="S3.p9.2.m2.1.1.1.cmml" xref="S3.p9.2.m2.1.1">superscript</csymbol><ci id="S3.p9.2.m2.1.1.2.cmml" xref="S3.p9.2.m2.1.1.2">𝜃</ci><times id="S3.p9.2.m2.1.1.3.cmml" xref="S3.p9.2.m2.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p9.2.m2.1c">\theta^{*}</annotation><annotation encoding="application/x-llamapun" id="S3.p9.2.m2.1d">italic_θ start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math> which fully encodes human values and consistently makes true judgments.
Such an <math alttext="\theta^{*}" class="ltx_Math" display="inline" id="S3.p9.3.m3.1"><semantics id="S3.p9.3.m3.1a"><msup id="S3.p9.3.m3.1.1" xref="S3.p9.3.m3.1.1.cmml"><mi id="S3.p9.3.m3.1.1.2" xref="S3.p9.3.m3.1.1.2.cmml">θ</mi><mo id="S3.p9.3.m3.1.1.3" xref="S3.p9.3.m3.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="S3.p9.3.m3.1b"><apply id="S3.p9.3.m3.1.1.cmml" xref="S3.p9.3.m3.1.1"><csymbol cd="ambiguous" id="S3.p9.3.m3.1.1.1.cmml" xref="S3.p9.3.m3.1.1">superscript</csymbol><ci id="S3.p9.3.m3.1.1.2.cmml" xref="S3.p9.3.m3.1.1.2">𝜃</ci><times id="S3.p9.3.m3.1.1.3.cmml" xref="S3.p9.3.m3.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p9.3.m3.1c">\theta^{*}</annotation><annotation encoding="application/x-llamapun" id="S3.p9.3.m3.1d">italic_θ start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math> must have sufficient world knowledge beyond what preference datasets can provide during LLM post-training.
Hence we assume that the parameters obtained during the pre-training phase are closer to <math alttext="\theta^{*}" class="ltx_Math" display="inline" id="S3.p9.4.m4.1"><semantics id="S3.p9.4.m4.1a"><msup id="S3.p9.4.m4.1.1" xref="S3.p9.4.m4.1.1.cmml"><mi id="S3.p9.4.m4.1.1.2" xref="S3.p9.4.m4.1.1.2.cmml">θ</mi><mo id="S3.p9.4.m4.1.1.3" xref="S3.p9.4.m4.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="S3.p9.4.m4.1b"><apply id="S3.p9.4.m4.1.1.cmml" xref="S3.p9.4.m4.1.1"><csymbol cd="ambiguous" id="S3.p9.4.m4.1.1.1.cmml" xref="S3.p9.4.m4.1.1">superscript</csymbol><ci id="S3.p9.4.m4.1.1.2.cmml" xref="S3.p9.4.m4.1.1.2">𝜃</ci><times id="S3.p9.4.m4.1.1.3.cmml" xref="S3.p9.4.m4.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p9.4.m4.1c">\theta^{*}</annotation><annotation encoding="application/x-llamapun" id="S3.p9.4.m4.1d">italic_θ start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math> than a random distribution.
This analysis suggests Con-J gets a smaller penalty term for optimization towards <math alttext="\theta^{*}" class="ltx_Math" display="inline" id="S3.p9.5.m5.1"><semantics id="S3.p9.5.m5.1a"><msup id="S3.p9.5.m5.1.1" xref="S3.p9.5.m5.1.1.cmml"><mi id="S3.p9.5.m5.1.1.2" xref="S3.p9.5.m5.1.1.2.cmml">θ</mi><mo id="S3.p9.5.m5.1.1.3" xref="S3.p9.5.m5.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="S3.p9.5.m5.1b"><apply id="S3.p9.5.m5.1.1.cmml" xref="S3.p9.5.m5.1.1"><csymbol cd="ambiguous" id="S3.p9.5.m5.1.1.1.cmml" xref="S3.p9.5.m5.1.1">superscript</csymbol><ci id="S3.p9.5.m5.1.1.2.cmml" xref="S3.p9.5.m5.1.1.2">𝜃</ci><times id="S3.p9.5.m5.1.1.3.cmml" xref="S3.p9.5.m5.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p9.5.m5.1c">\theta^{*}</annotation><annotation encoding="application/x-llamapun" id="S3.p9.5.m5.1d">italic_θ start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math>.
In contrast, SM adopts a different training objective and introduces a randomly initialized head, making the regularization effect less significant.
Hence, SM can be good at encoding the knowledge reflected in the preference dataset but is also more sensitive to its bias than Con-J.</p>
</div>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Experiments</h2>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Experimental Setup</h3>
<div class="ltx_para ltx_noindent" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.1"><span class="ltx_text ltx_font_bold" id="S4.SS1.p1.1.1">Datasets.</span>
We train scalar models and Con-J on three datasets within different vertical domains: Creation, and Math, then evaluate their performance in terms of the accuracy of preference predictions.
The datasets are self-built commercial datasets consisting of approximately 120,000, 50,000, and 50,000 preference samples for Creation, Math, and Code, respectively.
The Creative dataset involves tasks on text creation such as writing poetry or crafting headlines, whereas Math and Code datasets concentrate on math problem-solving and code writing, respectively.
The datasets cover diverse sources, ranging from data generated by a commercial ChatBot, data generated by ChatGPT, and data from open-source datasets like HH-rlhf <cite class="ltx_cite ltx_citemacro_cite">Bai et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03742v1#bib.bib3" title="">2022</a>)</cite> and Infinity-Instruct<span class="ltx_note ltx_role_footnote" id="footnote2"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span>https://huggingface.co/datasets/BAAI/Infinity-Instruct</span></span></span>.
The preference annotation for these datasets is gathered from human annotators, with each annotation being performed by one annotator and subsequently verified by another.
In addition to the self-built datasets, we train Con-J on a publicly available dataset
Skywork-Reward-Preference-80K-v0.1<span class="ltx_note ltx_role_footnote" id="footnote3"><sup class="ltx_note_mark">3</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">3</sup><span class="ltx_tag ltx_tag_note">3</span>https://huggingface.co/datasets/Skywork/Skywork-Reward-Preference-80K-v0.1</span></span></span> and test its performance on public benchmarks including Infinity-Preference<span class="ltx_note ltx_role_footnote" id="footnote4"><sup class="ltx_note_mark">4</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">4</sup><span class="ltx_tag ltx_tag_note">4</span>https://huggingface.co/datasets/BAAI/Infinity-Preference</span></span></span>, UltraFeedback <cite class="ltx_cite ltx_citemacro_cite">Cui et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03742v1#bib.bib7" title="">2023</a>)</cite>, PKU-SafeRLHF <cite class="ltx_cite ltx_citemacro_cite">Ji et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03742v1#bib.bib14" title="">2024</a>)</cite>, and Reward-Bench <cite class="ltx_cite ltx_citemacro_cite">Lambert et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03742v1#bib.bib18" title="">2024</a>)</cite>.
We ensure that no identical prompts appear in both the training and test sets by filtering them out of the training set.
This version of Con-J is publicly released in <span class="ltx_text ltx_font_italic" id="S4.SS1.p1.1.2">anonymized link</span>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS1.p2">
<p class="ltx_p" id="S4.SS1.p2.1"><span class="ltx_text ltx_font_bold" id="S4.SS1.p2.1.1">Model.</span>
We select Qwen2-7B-Instruct <cite class="ltx_cite ltx_citemacro_cite">Yang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03742v1#bib.bib35" title="">2024</a>)</cite> as the base model to train both the scalar model (named <span class="ltx_text ltx_font_bold ltx_font_italic" id="S4.SS1.p2.1.2">SM</span>) and the proposed generative judge (named <span class="ltx_text ltx_font_bold ltx_font_italic" id="S4.SS1.p2.1.3">Con-J</span>).
SM includes both pairwise and pointwise variants.
Additionally, we included the original pre-trained Qwen2-7B-Instruct as an untrained variant of Con-J.
In addition, we compare Con-J with a range of generative judges, including GPT-4o<span class="ltx_note ltx_role_footnote" id="footnote5"><sup class="ltx_note_mark">5</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">5</sup><span class="ltx_tag ltx_tag_note">5</span>https://openai.com/index/hello-gpt-4o/</span></span></span> and two generative models (Auto-J <cite class="ltx_cite ltx_citemacro_cite">Li et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03742v1#bib.bib21" title="">2023</a>)</cite> and Prometheus 2 <cite class="ltx_cite ltx_citemacro_cite">Kim et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03742v1#bib.bib16" title="">2024</a>)</cite>) trained by SFT, Llama series (Llama3.1-8B, and Llama3.1-70B), and Qwen series (Qwen2-7B, Qwen2.5-72B).</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS1.p3">
<p class="ltx_p" id="S4.SS1.p3.2"><span class="ltx_text ltx_font_bold" id="S4.SS1.p3.2.1">Hyper parameters.</span>
We train SM and Con-J from with the DeepSpeed library <cite class="ltx_cite ltx_citemacro_cite">Rasley et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03742v1#bib.bib28" title="">2020</a>)</cite>, Zero Redundancy Optimizer (ZeRO) Stage 3 <cite class="ltx_cite ltx_citemacro_cite">Rajbhandari et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03742v1#bib.bib27" title="">2020</a>)</cite>, gradient-checkpointing <cite class="ltx_cite ltx_citemacro_cite">Chen et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03742v1#bib.bib5" title="">2016</a>)</cite> and FlashAttention <cite class="ltx_cite ltx_citemacro_cite">Dao et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03742v1#bib.bib8" title="">2022</a>)</cite>.
We use bfloat16 (BF16) and tfloat32 (TF32) mix computation precision.
We set a peak learning rate of <math alttext="9e-6" class="ltx_Math" display="inline" id="S4.SS1.p3.1.m1.1"><semantics id="S4.SS1.p3.1.m1.1a"><mrow id="S4.SS1.p3.1.m1.1.1" xref="S4.SS1.p3.1.m1.1.1.cmml"><mrow id="S4.SS1.p3.1.m1.1.1.2" xref="S4.SS1.p3.1.m1.1.1.2.cmml"><mn id="S4.SS1.p3.1.m1.1.1.2.2" xref="S4.SS1.p3.1.m1.1.1.2.2.cmml">9</mn><mo id="S4.SS1.p3.1.m1.1.1.2.1" xref="S4.SS1.p3.1.m1.1.1.2.1.cmml">⁢</mo><mi id="S4.SS1.p3.1.m1.1.1.2.3" xref="S4.SS1.p3.1.m1.1.1.2.3.cmml">e</mi></mrow><mo id="S4.SS1.p3.1.m1.1.1.1" xref="S4.SS1.p3.1.m1.1.1.1.cmml">−</mo><mn id="S4.SS1.p3.1.m1.1.1.3" xref="S4.SS1.p3.1.m1.1.1.3.cmml">6</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.1.m1.1b"><apply id="S4.SS1.p3.1.m1.1.1.cmml" xref="S4.SS1.p3.1.m1.1.1"><minus id="S4.SS1.p3.1.m1.1.1.1.cmml" xref="S4.SS1.p3.1.m1.1.1.1"></minus><apply id="S4.SS1.p3.1.m1.1.1.2.cmml" xref="S4.SS1.p3.1.m1.1.1.2"><times id="S4.SS1.p3.1.m1.1.1.2.1.cmml" xref="S4.SS1.p3.1.m1.1.1.2.1"></times><cn id="S4.SS1.p3.1.m1.1.1.2.2.cmml" type="integer" xref="S4.SS1.p3.1.m1.1.1.2.2">9</cn><ci id="S4.SS1.p3.1.m1.1.1.2.3.cmml" xref="S4.SS1.p3.1.m1.1.1.2.3">𝑒</ci></apply><cn id="S4.SS1.p3.1.m1.1.1.3.cmml" type="integer" xref="S4.SS1.p3.1.m1.1.1.3">6</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.1.m1.1c">9e-6</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.1.m1.1d">9 italic_e - 6</annotation></semantics></math> with 3% warmup steps and cosine scheduler, and a maximum sequence length of 4,096.
The batch sizes of SM and Con-J are set to 128 and 24, respectively.
For Con-J, we linearly combine the SFT loss and the DPO loss with <math alttext="\alpha=1e^{-6}" class="ltx_Math" display="inline" id="S4.SS1.p3.2.m2.1"><semantics id="S4.SS1.p3.2.m2.1a"><mrow id="S4.SS1.p3.2.m2.1.1" xref="S4.SS1.p3.2.m2.1.1.cmml"><mi id="S4.SS1.p3.2.m2.1.1.2" xref="S4.SS1.p3.2.m2.1.1.2.cmml">α</mi><mo id="S4.SS1.p3.2.m2.1.1.1" xref="S4.SS1.p3.2.m2.1.1.1.cmml">=</mo><mrow id="S4.SS1.p3.2.m2.1.1.3" xref="S4.SS1.p3.2.m2.1.1.3.cmml"><mn id="S4.SS1.p3.2.m2.1.1.3.2" xref="S4.SS1.p3.2.m2.1.1.3.2.cmml">1</mn><mo id="S4.SS1.p3.2.m2.1.1.3.1" xref="S4.SS1.p3.2.m2.1.1.3.1.cmml">⁢</mo><msup id="S4.SS1.p3.2.m2.1.1.3.3" xref="S4.SS1.p3.2.m2.1.1.3.3.cmml"><mi id="S4.SS1.p3.2.m2.1.1.3.3.2" xref="S4.SS1.p3.2.m2.1.1.3.3.2.cmml">e</mi><mrow id="S4.SS1.p3.2.m2.1.1.3.3.3" xref="S4.SS1.p3.2.m2.1.1.3.3.3.cmml"><mo id="S4.SS1.p3.2.m2.1.1.3.3.3a" xref="S4.SS1.p3.2.m2.1.1.3.3.3.cmml">−</mo><mn id="S4.SS1.p3.2.m2.1.1.3.3.3.2" xref="S4.SS1.p3.2.m2.1.1.3.3.3.2.cmml">6</mn></mrow></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.2.m2.1b"><apply id="S4.SS1.p3.2.m2.1.1.cmml" xref="S4.SS1.p3.2.m2.1.1"><eq id="S4.SS1.p3.2.m2.1.1.1.cmml" xref="S4.SS1.p3.2.m2.1.1.1"></eq><ci id="S4.SS1.p3.2.m2.1.1.2.cmml" xref="S4.SS1.p3.2.m2.1.1.2">𝛼</ci><apply id="S4.SS1.p3.2.m2.1.1.3.cmml" xref="S4.SS1.p3.2.m2.1.1.3"><times id="S4.SS1.p3.2.m2.1.1.3.1.cmml" xref="S4.SS1.p3.2.m2.1.1.3.1"></times><cn id="S4.SS1.p3.2.m2.1.1.3.2.cmml" type="integer" xref="S4.SS1.p3.2.m2.1.1.3.2">1</cn><apply id="S4.SS1.p3.2.m2.1.1.3.3.cmml" xref="S4.SS1.p3.2.m2.1.1.3.3"><csymbol cd="ambiguous" id="S4.SS1.p3.2.m2.1.1.3.3.1.cmml" xref="S4.SS1.p3.2.m2.1.1.3.3">superscript</csymbol><ci id="S4.SS1.p3.2.m2.1.1.3.3.2.cmml" xref="S4.SS1.p3.2.m2.1.1.3.3.2">𝑒</ci><apply id="S4.SS1.p3.2.m2.1.1.3.3.3.cmml" xref="S4.SS1.p3.2.m2.1.1.3.3.3"><minus id="S4.SS1.p3.2.m2.1.1.3.3.3.1.cmml" xref="S4.SS1.p3.2.m2.1.1.3.3.3"></minus><cn id="S4.SS1.p3.2.m2.1.1.3.3.3.2.cmml" type="integer" xref="S4.SS1.p3.2.m2.1.1.3.3.3.2">6</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.2.m2.1c">\alpha=1e^{-6}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.2.m2.1d">italic_α = 1 italic_e start_POSTSUPERSCRIPT - 6 end_POSTSUPERSCRIPT</annotation></semantics></math>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS1.p4">
<p class="ltx_p" id="S4.SS1.p4.1"><span class="ltx_text ltx_font_bold" id="S4.SS1.p4.1.1">Sampling and inference strategy for Con-J.</span>
We use VLLM <cite class="ltx_cite ltx_citemacro_cite">Kwon et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03742v1#bib.bib17" title="">2023</a>)</cite> for the inference for Con-J.
During repeated sampling and hint-driven sampling, we employ greedy sampling with top-p set at 0.9 and top-k at 20, with a maximum output length set as 512, a temperature of 1.0, and a repetition penalty of 1.2.
During the evaluation, we set top-p at 1.0 and a temperature of 0.0.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Main Results</h3>
<figure class="ltx_table ltx_align_floatright" id="S4.T1">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 1: </span>Judgment accuracy of GPT-4o, SM, and Con-J. <math alttext="*" class="ltx_Math" display="inline" id="S4.T1.3.m1.1"><semantics id="S4.T1.3.m1.1b"><mo id="S4.T1.3.m1.1.1" xref="S4.T1.3.m1.1.1.cmml">∗</mo><annotation-xml encoding="MathML-Content" id="S4.T1.3.m1.1c"><times id="S4.T1.3.m1.1.1.cmml" xref="S4.T1.3.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.3.m1.1d">*</annotation><annotation encoding="application/x-llamapun" id="S4.T1.3.m1.1e">∗</annotation></semantics></math> indicates the performance difference between Con-J is significant at <math alttext="p&lt;0.05" class="ltx_Math" display="inline" id="S4.T1.4.m2.1"><semantics id="S4.T1.4.m2.1b"><mrow id="S4.T1.4.m2.1.1" xref="S4.T1.4.m2.1.1.cmml"><mi id="S4.T1.4.m2.1.1.2" xref="S4.T1.4.m2.1.1.2.cmml">p</mi><mo id="S4.T1.4.m2.1.1.1" xref="S4.T1.4.m2.1.1.1.cmml">&lt;</mo><mn id="S4.T1.4.m2.1.1.3" xref="S4.T1.4.m2.1.1.3.cmml">0.05</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.4.m2.1c"><apply id="S4.T1.4.m2.1.1.cmml" xref="S4.T1.4.m2.1.1"><lt id="S4.T1.4.m2.1.1.1.cmml" xref="S4.T1.4.m2.1.1.1"></lt><ci id="S4.T1.4.m2.1.1.2.cmml" xref="S4.T1.4.m2.1.1.2">𝑝</ci><cn id="S4.T1.4.m2.1.1.3.cmml" type="float" xref="S4.T1.4.m2.1.1.3">0.05</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.4.m2.1d">p&lt;0.05</annotation><annotation encoding="application/x-llamapun" id="S4.T1.4.m2.1e">italic_p &lt; 0.05</annotation></semantics></math> using a pair-wise t-test.</figcaption>
<table class="ltx_tabular ltx_centering ltx_align_middle" id="S4.T1.9">
<tr class="ltx_tr" id="S4.T1.9.6">
<td class="ltx_td ltx_nopad_r ltx_align_left ltx_border_r ltx_border_tt" id="S4.T1.9.6.1">Model</td>
<td class="ltx_td ltx_align_left ltx_border_tt" id="S4.T1.9.6.2">Creation</td>
<td class="ltx_td ltx_align_left ltx_border_tt" id="S4.T1.9.6.3">Math</td>
<td class="ltx_td ltx_align_left ltx_border_tt" id="S4.T1.9.6.4">Code</td>
</tr>
<tr class="ltx_tr" id="S4.T1.7.3">
<td class="ltx_td ltx_nopad_r ltx_align_left ltx_border_r ltx_border_t" id="S4.T1.7.3.4">GPT-4o</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T1.5.1.1"><math alttext="55.6^{*}" class="ltx_Math" display="inline" id="S4.T1.5.1.1.m1.1"><semantics id="S4.T1.5.1.1.m1.1a"><msup id="S4.T1.5.1.1.m1.1.1" xref="S4.T1.5.1.1.m1.1.1.cmml"><mn id="S4.T1.5.1.1.m1.1.1.2" xref="S4.T1.5.1.1.m1.1.1.2.cmml">55.6</mn><mo id="S4.T1.5.1.1.m1.1.1.3" xref="S4.T1.5.1.1.m1.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="S4.T1.5.1.1.m1.1b"><apply id="S4.T1.5.1.1.m1.1.1.cmml" xref="S4.T1.5.1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T1.5.1.1.m1.1.1.1.cmml" xref="S4.T1.5.1.1.m1.1.1">superscript</csymbol><cn id="S4.T1.5.1.1.m1.1.1.2.cmml" type="float" xref="S4.T1.5.1.1.m1.1.1.2">55.6</cn><times id="S4.T1.5.1.1.m1.1.1.3.cmml" xref="S4.T1.5.1.1.m1.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.5.1.1.m1.1c">55.6^{*}</annotation><annotation encoding="application/x-llamapun" id="S4.T1.5.1.1.m1.1d">55.6 start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T1.6.2.2"><math alttext="74.8^{*}" class="ltx_Math" display="inline" id="S4.T1.6.2.2.m1.1"><semantics id="S4.T1.6.2.2.m1.1a"><msup id="S4.T1.6.2.2.m1.1.1" xref="S4.T1.6.2.2.m1.1.1.cmml"><mn id="S4.T1.6.2.2.m1.1.1.2" xref="S4.T1.6.2.2.m1.1.1.2.cmml">74.8</mn><mo id="S4.T1.6.2.2.m1.1.1.3" xref="S4.T1.6.2.2.m1.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="S4.T1.6.2.2.m1.1b"><apply id="S4.T1.6.2.2.m1.1.1.cmml" xref="S4.T1.6.2.2.m1.1.1"><csymbol cd="ambiguous" id="S4.T1.6.2.2.m1.1.1.1.cmml" xref="S4.T1.6.2.2.m1.1.1">superscript</csymbol><cn id="S4.T1.6.2.2.m1.1.1.2.cmml" type="float" xref="S4.T1.6.2.2.m1.1.1.2">74.8</cn><times id="S4.T1.6.2.2.m1.1.1.3.cmml" xref="S4.T1.6.2.2.m1.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.6.2.2.m1.1c">74.8^{*}</annotation><annotation encoding="application/x-llamapun" id="S4.T1.6.2.2.m1.1d">74.8 start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T1.7.3.3"><math alttext="68.1^{*}" class="ltx_Math" display="inline" id="S4.T1.7.3.3.m1.1"><semantics id="S4.T1.7.3.3.m1.1a"><msup id="S4.T1.7.3.3.m1.1.1" xref="S4.T1.7.3.3.m1.1.1.cmml"><mn id="S4.T1.7.3.3.m1.1.1.2" xref="S4.T1.7.3.3.m1.1.1.2.cmml">68.1</mn><mo id="S4.T1.7.3.3.m1.1.1.3" xref="S4.T1.7.3.3.m1.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="S4.T1.7.3.3.m1.1b"><apply id="S4.T1.7.3.3.m1.1.1.cmml" xref="S4.T1.7.3.3.m1.1.1"><csymbol cd="ambiguous" id="S4.T1.7.3.3.m1.1.1.1.cmml" xref="S4.T1.7.3.3.m1.1.1">superscript</csymbol><cn id="S4.T1.7.3.3.m1.1.1.2.cmml" type="float" xref="S4.T1.7.3.3.m1.1.1.2">68.1</cn><times id="S4.T1.7.3.3.m1.1.1.3.cmml" xref="S4.T1.7.3.3.m1.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.7.3.3.m1.1c">68.1^{*}</annotation><annotation encoding="application/x-llamapun" id="S4.T1.7.3.3.m1.1d">68.1 start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S4.T1.8.4">
<td class="ltx_td ltx_nopad_r ltx_align_left ltx_border_r" id="S4.T1.8.4.2">SM (point-wise)</td>
<td class="ltx_td ltx_align_left" id="S4.T1.8.4.1"><math alttext="69.4^{*}" class="ltx_Math" display="inline" id="S4.T1.8.4.1.m1.1"><semantics id="S4.T1.8.4.1.m1.1a"><msup id="S4.T1.8.4.1.m1.1.1" xref="S4.T1.8.4.1.m1.1.1.cmml"><mn id="S4.T1.8.4.1.m1.1.1.2" xref="S4.T1.8.4.1.m1.1.1.2.cmml">69.4</mn><mo id="S4.T1.8.4.1.m1.1.1.3" xref="S4.T1.8.4.1.m1.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="S4.T1.8.4.1.m1.1b"><apply id="S4.T1.8.4.1.m1.1.1.cmml" xref="S4.T1.8.4.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T1.8.4.1.m1.1.1.1.cmml" xref="S4.T1.8.4.1.m1.1.1">superscript</csymbol><cn id="S4.T1.8.4.1.m1.1.1.2.cmml" type="float" xref="S4.T1.8.4.1.m1.1.1.2">69.4</cn><times id="S4.T1.8.4.1.m1.1.1.3.cmml" xref="S4.T1.8.4.1.m1.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.8.4.1.m1.1c">69.4^{*}</annotation><annotation encoding="application/x-llamapun" id="S4.T1.8.4.1.m1.1d">69.4 start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left" id="S4.T1.8.4.3">84.8</td>
<td class="ltx_td ltx_align_left" id="S4.T1.8.4.4">69.4</td>
</tr>
<tr class="ltx_tr" id="S4.T1.9.5">
<td class="ltx_td ltx_nopad_r ltx_align_left ltx_border_r" id="S4.T1.9.5.2">SM (pair-wise)</td>
<td class="ltx_td ltx_align_left" id="S4.T1.9.5.1"><math alttext="69.2^{*}" class="ltx_Math" display="inline" id="S4.T1.9.5.1.m1.1"><semantics id="S4.T1.9.5.1.m1.1a"><msup id="S4.T1.9.5.1.m1.1.1" xref="S4.T1.9.5.1.m1.1.1.cmml"><mn id="S4.T1.9.5.1.m1.1.1.2" xref="S4.T1.9.5.1.m1.1.1.2.cmml">69.2</mn><mo id="S4.T1.9.5.1.m1.1.1.3" xref="S4.T1.9.5.1.m1.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="S4.T1.9.5.1.m1.1b"><apply id="S4.T1.9.5.1.m1.1.1.cmml" xref="S4.T1.9.5.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T1.9.5.1.m1.1.1.1.cmml" xref="S4.T1.9.5.1.m1.1.1">superscript</csymbol><cn id="S4.T1.9.5.1.m1.1.1.2.cmml" type="float" xref="S4.T1.9.5.1.m1.1.1.2">69.2</cn><times id="S4.T1.9.5.1.m1.1.1.3.cmml" xref="S4.T1.9.5.1.m1.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.9.5.1.m1.1c">69.2^{*}</annotation><annotation encoding="application/x-llamapun" id="S4.T1.9.5.1.m1.1d">69.2 start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left" id="S4.T1.9.5.3">84.6</td>
<td class="ltx_td ltx_align_left" id="S4.T1.9.5.4">69.6</td>
</tr>
<tr class="ltx_tr" id="S4.T1.9.7">
<td class="ltx_td ltx_nopad_r ltx_align_left ltx_border_bb ltx_border_r" id="S4.T1.9.7.1">Con-J</td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="S4.T1.9.7.2"><span class="ltx_text ltx_font_bold" id="S4.T1.9.7.2.1">72.4</span></td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="S4.T1.9.7.3"><span class="ltx_text ltx_font_bold" id="S4.T1.9.7.3.1">85.0</span></td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="S4.T1.9.7.4"><span class="ltx_text ltx_font_bold" id="S4.T1.9.7.4.1">70.1</span></td>
</tr>
</table>
</figure>
<div class="ltx_para ltx_noindent" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.1">Table <a class="ltx_ref" href="https://arxiv.org/html/2410.03742v1#S4.T1" title="Table 1 ‣ 4.2 Main Results ‣ 4 Experiments ‣ Beyond Scalar Reward Model: Learning Generative Judge from Preference Data"><span class="ltx_text ltx_ref_tag">1</span></a> presents the results of SM and Con-J on the self-built commercial datasets across three vertical domains.
It can be observed that
(i) there is no significant difference between the pointwise and pairwise variants of SM.
Although existing research suggests that concatenating the list of responses improves performance for scoring the responses <cite class="ltx_cite ltx_citemacro_cite">Jiang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03742v1#bib.bib15" title="">2023</a>)</cite>, we do not observe this effect on our datasets.
(ii) Both Con-J and SM outperform off-the-shelf GPT-4o, indicating that small models trained on domain-specific data can effectively reflect domain-related preferences.
(iii) On the same preference datasets, Con-J consistently outperforms SM across all tasks with a significant gap on the Text Creation task.
This indicates that Con-J is more effective at acquiring accurate judgment abilities than SM.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS2.p2">
<p class="ltx_p" id="S4.SS2.p2.1">We carry out an ablation study to investigate the variants of Con-J.
Given that current methodologies often employ Supervised Fine-Tuning (SFT) to train generative judges <cite class="ltx_cite ltx_citemacro_cite">Li et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03742v1#bib.bib21" title="">2023</a>); Kim et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03742v1#bib.bib16" title="">2024</a>)</cite>, we developed an SFT variant of Con-J, trained exclusively on positive judgments using SFT loss.
As illustrated in Table <a class="ltx_ref" href="https://arxiv.org/html/2410.03742v1#S4.T3" title="Table 3 ‣ 4.2 Main Results ‣ 4 Experiments ‣ Beyond Scalar Reward Model: Learning Generative Judge from Preference Data"><span class="ltx_text ltx_ref_tag">3</span></a>, Con-J trained with our proposed framework outperforms its variant without DPO loss across all datasets.
This observation demonstrates the effectiveness of training from contrastive judgments.
In addition, Con-J outperforms its variant without hint-driven sampling, which relies solely on repeated sampling and may be infeasible to construct contrastive judgment pairs for some prompts.
Similar findings have been observed when using self-taught techniques to improve LLMs <cite class="ltx_cite ltx_citemacro_cite">Zelikman et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03742v1#bib.bib38" title="">2022</a>)</cite>.
Additional variants of Con-J were also tested, which are detailed in the Appendix.</p>
</div>
<figure class="ltx_table" id="S4.T2">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 2: </span>Accuracy of generative judges on the test sets of four benchmarks: Infinity-Preference, UltraFeedback, PKU-SafeRLHF, and Reward-Bench. Results in <span class="ltx_text ltx_font_bold" id="S4.T2.3.1">bold</span> are the best among all models and results with <span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T2.4.2">underline</span> are the second-best.</figcaption>
<table class="ltx_tabular ltx_align_middle" id="S4.T2.5">
<tr class="ltx_tr" id="S4.T2.5.1">
<td class="ltx_td ltx_border_r ltx_border_tt" id="S4.T2.5.1.1"></td>
<td class="ltx_td ltx_nopad_r ltx_align_right ltx_border_r ltx_border_tt" id="S4.T2.5.1.2" rowspan="2">
<span class="ltx_text" id="S4.T2.5.1.2.1"><span class="ltx_text" id="S4.T2.5.1.2.1.1"></span> <span class="ltx_text" id="S4.T2.5.1.2.1.2">
<span class="ltx_tabular ltx_align_middle" id="S4.T2.5.1.2.1.2.1">
<span class="ltx_tr" id="S4.T2.5.1.2.1.2.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T2.5.1.2.1.2.1.1.1">Infinity-</span></span>
<span class="ltx_tr" id="S4.T2.5.1.2.1.2.1.2">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T2.5.1.2.1.2.1.2.1">Preference</span></span>
</span></span> <span class="ltx_text" id="S4.T2.5.1.2.1.3"></span></span></td>
<td class="ltx_td ltx_nopad_r ltx_align_right ltx_border_r ltx_border_tt" id="S4.T2.5.1.3" rowspan="2">
<span class="ltx_text" id="S4.T2.5.1.3.1"><span class="ltx_text" id="S4.T2.5.1.3.1.1"></span> <span class="ltx_text" id="S4.T2.5.1.3.1.2">
<span class="ltx_tabular ltx_align_middle" id="S4.T2.5.1.3.1.2.1">
<span class="ltx_tr" id="S4.T2.5.1.3.1.2.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T2.5.1.3.1.2.1.1.1">Ultra-</span></span>
<span class="ltx_tr" id="S4.T2.5.1.3.1.2.1.2">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T2.5.1.3.1.2.1.2.1">Feedback</span></span>
</span></span> <span class="ltx_text" id="S4.T2.5.1.3.1.3"></span></span></td>
<td class="ltx_td ltx_nopad_r ltx_align_right ltx_border_r ltx_border_tt" id="S4.T2.5.1.4" rowspan="2">
<span class="ltx_text" id="S4.T2.5.1.4.1"><span class="ltx_text" id="S4.T2.5.1.4.1.1"></span> <span class="ltx_text" id="S4.T2.5.1.4.1.2">
<span class="ltx_tabular ltx_align_middle" id="S4.T2.5.1.4.1.2.1">
<span class="ltx_tr" id="S4.T2.5.1.4.1.2.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T2.5.1.4.1.2.1.1.1">PKU-</span></span>
<span class="ltx_tr" id="S4.T2.5.1.4.1.2.1.2">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T2.5.1.4.1.2.1.2.1">SafeRLHF</span></span>
</span></span> <span class="ltx_text" id="S4.T2.5.1.4.1.3"></span></span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="4" id="S4.T2.5.1.5">
<span class="ltx_text" id="S4.T2.5.1.5.1"></span> <span class="ltx_text" id="S4.T2.5.1.5.2">
<span class="ltx_tabular ltx_align_middle" id="S4.T2.5.1.5.2.1">
<span class="ltx_tr" id="S4.T2.5.1.5.2.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T2.5.1.5.2.1.1.1">Reward-Bench</span></span>
</span></span><span class="ltx_text" id="S4.T2.5.1.5.3"></span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.5.2">
<td class="ltx_td ltx_border_r" id="S4.T2.5.2.1"></td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.2.2">Chat</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.2.3">Chat-H</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.2.4">Safety</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.2.5">Reasoning</td>
</tr>
<tr class="ltx_tr" id="S4.T2.5.3">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S4.T2.5.3.1">Llama3.1-8B</td>
<td class="ltx_td ltx_nopad_r ltx_align_right ltx_border_r ltx_border_t" id="S4.T2.5.3.2">59.0</td>
<td class="ltx_td ltx_nopad_r ltx_align_right ltx_border_r ltx_border_t" id="S4.T2.5.3.3">62.9</td>
<td class="ltx_td ltx_nopad_r ltx_align_right ltx_border_r ltx_border_t" id="S4.T2.5.3.4">66.4</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.5.3.5">80.7</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.5.3.6">49.8</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.5.3.7">64.0</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.5.3.8">68.1</td>
</tr>
<tr class="ltx_tr" id="S4.T2.5.4">
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T2.5.4.1">Llama3.1-70B</td>
<td class="ltx_td ltx_nopad_r ltx_align_right ltx_border_r" id="S4.T2.5.4.2">64.0</td>
<td class="ltx_td ltx_nopad_r ltx_align_right ltx_border_r" id="S4.T2.5.4.3">71.4</td>
<td class="ltx_td ltx_nopad_r ltx_align_right ltx_border_r" id="S4.T2.5.4.4">67.6</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.4.5"><span class="ltx_text ltx_font_bold" id="S4.T2.5.4.5.1">97.2</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.4.6">70.2</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.4.7">82.8</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.4.8">86.0</td>
</tr>
<tr class="ltx_tr" id="S4.T2.5.5">
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T2.5.5.1">Qwen2-7B</td>
<td class="ltx_td ltx_nopad_r ltx_align_right ltx_border_r" id="S4.T2.5.5.2">59.0</td>
<td class="ltx_td ltx_nopad_r ltx_align_right ltx_border_r" id="S4.T2.5.5.3">64.5</td>
<td class="ltx_td ltx_nopad_r ltx_align_right ltx_border_r" id="S4.T2.5.5.4">67.2</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.5.5">91.3</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.5.6">44.8</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.5.7">73.6</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.5.8">69.0</td>
</tr>
<tr class="ltx_tr" id="S4.T2.5.6">
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T2.5.6.1">Qwen2.5-72B</td>
<td class="ltx_td ltx_nopad_r ltx_align_right ltx_border_r" id="S4.T2.5.6.2">70.0</td>
<td class="ltx_td ltx_nopad_r ltx_align_right ltx_border_r" id="S4.T2.5.6.3">66.0</td>
<td class="ltx_td ltx_nopad_r ltx_align_right ltx_border_r" id="S4.T2.5.6.4">58.7</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.6.5">86.6</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.6.6">61.4</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.6.7">74.5</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.6.8"><span class="ltx_text ltx_font_bold" id="S4.T2.5.6.8.1">90.7</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.5.7">
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T2.5.7.1">Auto-J</td>
<td class="ltx_td ltx_nopad_r ltx_align_right ltx_border_r" id="S4.T2.5.7.2">69.0</td>
<td class="ltx_td ltx_nopad_r ltx_align_right ltx_border_r" id="S4.T2.5.7.3">63.9</td>
<td class="ltx_td ltx_nopad_r ltx_align_right ltx_border_r" id="S4.T2.5.7.4">66.9</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.7.5">93.0</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.7.6">40.0</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.7.7">65.5</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.7.8">50.5</td>
</tr>
<tr class="ltx_tr" id="S4.T2.5.8">
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T2.5.8.1">Prometheus 2</td>
<td class="ltx_td ltx_nopad_r ltx_align_right ltx_border_r" id="S4.T2.5.8.2">68.0</td>
<td class="ltx_td ltx_nopad_r ltx_align_right ltx_border_r" id="S4.T2.5.8.3">63.3</td>
<td class="ltx_td ltx_nopad_r ltx_align_right ltx_border_r" id="S4.T2.5.8.4">63.0</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.8.5">85.5</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.8.6">49.1</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.8.7">77.1</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.8.8">76.5</td>
</tr>
<tr class="ltx_tr" id="S4.T2.5.9">
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T2.5.9.1">GPT-4o</td>
<td class="ltx_td ltx_nopad_r ltx_align_right ltx_border_r" id="S4.T2.5.9.2">
<span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T2.5.9.2.1">75.0</span></td>
<td class="ltx_td ltx_nopad_r ltx_align_right ltx_border_r" id="S4.T2.5.9.3">
<span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T2.5.9.3.1">72.2</span></td>
<td class="ltx_td ltx_nopad_r ltx_align_right ltx_border_r" id="S4.T2.5.9.4">
<span class="ltx_text ltx_font_bold" id="S4.T2.5.9.4.1">69.6</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.9.5"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T2.5.9.5.1">95.3</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.9.6"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T2.5.9.6.1">74.3</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.9.7"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T2.5.9.7.1">87.6</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.9.8">86.9</td>
</tr>
<tr class="ltx_tr" id="S4.T2.5.10">
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_r" id="S4.T2.5.10.1">Con-J (ours)</td>
<td class="ltx_td ltx_nopad_r ltx_align_right ltx_border_b ltx_border_r" id="S4.T2.5.10.2">
<span class="ltx_text ltx_font_bold" id="S4.T2.5.10.2.1">81.0</span></td>
<td class="ltx_td ltx_nopad_r ltx_align_right ltx_border_b ltx_border_r" id="S4.T2.5.10.3">
<span class="ltx_text ltx_font_bold" id="S4.T2.5.10.3.1">73.0</span></td>
<td class="ltx_td ltx_nopad_r ltx_align_right ltx_border_b ltx_border_r" id="S4.T2.5.10.4">
<span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T2.5.10.4.1">68.4</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T2.5.10.5">91.3</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T2.5.10.6"><span class="ltx_text ltx_font_bold" id="S4.T2.5.10.6.1">79.6</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T2.5.10.7"><span class="ltx_text ltx_font_bold" id="S4.T2.5.10.7.1">88.0</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T2.5.10.8"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T2.5.10.8.1">87.1</span></td>
</tr>
</table>
</figure>
<figure class="ltx_table ltx_align_floatright" id="S4.T3">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 3: </span>Judgment accuracy of Con-J and its variants.  <math alttext="*" class="ltx_Math" display="inline" id="S4.T3.3.m1.1"><semantics id="S4.T3.3.m1.1b"><mo id="S4.T3.3.m1.1.1" xref="S4.T3.3.m1.1.1.cmml">∗</mo><annotation-xml encoding="MathML-Content" id="S4.T3.3.m1.1c"><times id="S4.T3.3.m1.1.1.cmml" xref="S4.T3.3.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.3.m1.1d">*</annotation><annotation encoding="application/x-llamapun" id="S4.T3.3.m1.1e">∗</annotation></semantics></math> indicates the performance difference between Con-J is significant at <math alttext="p&lt;0.05" class="ltx_Math" display="inline" id="S4.T3.4.m2.1"><semantics id="S4.T3.4.m2.1b"><mrow id="S4.T3.4.m2.1.1" xref="S4.T3.4.m2.1.1.cmml"><mi id="S4.T3.4.m2.1.1.2" xref="S4.T3.4.m2.1.1.2.cmml">p</mi><mo id="S4.T3.4.m2.1.1.1" xref="S4.T3.4.m2.1.1.1.cmml">&lt;</mo><mn id="S4.T3.4.m2.1.1.3" xref="S4.T3.4.m2.1.1.3.cmml">0.05</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T3.4.m2.1c"><apply id="S4.T3.4.m2.1.1.cmml" xref="S4.T3.4.m2.1.1"><lt id="S4.T3.4.m2.1.1.1.cmml" xref="S4.T3.4.m2.1.1.1"></lt><ci id="S4.T3.4.m2.1.1.2.cmml" xref="S4.T3.4.m2.1.1.2">𝑝</ci><cn id="S4.T3.4.m2.1.1.3.cmml" type="float" xref="S4.T3.4.m2.1.1.3">0.05</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.4.m2.1d">p&lt;0.05</annotation><annotation encoding="application/x-llamapun" id="S4.T3.4.m2.1e">italic_p &lt; 0.05</annotation></semantics></math> using a pair-wise t-test.</figcaption>
<table class="ltx_tabular ltx_centering ltx_align_middle" id="S4.T3.12">
<tr class="ltx_tr" id="S4.T3.12.9">
<td class="ltx_td ltx_nopad_r ltx_align_left ltx_border_r ltx_border_tt" id="S4.T3.12.9.1">Model</td>
<td class="ltx_td ltx_align_left ltx_border_tt" id="S4.T3.12.9.2">Creation</td>
<td class="ltx_td ltx_align_left ltx_border_tt" id="S4.T3.12.9.3">Math</td>
<td class="ltx_td ltx_align_left ltx_border_tt" id="S4.T3.12.9.4">Code</td>
</tr>
<tr class="ltx_tr" id="S4.T3.7.3">
<td class="ltx_td ltx_nopad_r ltx_align_left ltx_border_r ltx_border_t" id="S4.T3.7.3.4">Con-J untrained</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T3.5.1.1"><math alttext="53.6^{*}" class="ltx_Math" display="inline" id="S4.T3.5.1.1.m1.1"><semantics id="S4.T3.5.1.1.m1.1a"><msup id="S4.T3.5.1.1.m1.1.1" xref="S4.T3.5.1.1.m1.1.1.cmml"><mn id="S4.T3.5.1.1.m1.1.1.2" xref="S4.T3.5.1.1.m1.1.1.2.cmml">53.6</mn><mo id="S4.T3.5.1.1.m1.1.1.3" xref="S4.T3.5.1.1.m1.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="S4.T3.5.1.1.m1.1b"><apply id="S4.T3.5.1.1.m1.1.1.cmml" xref="S4.T3.5.1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T3.5.1.1.m1.1.1.1.cmml" xref="S4.T3.5.1.1.m1.1.1">superscript</csymbol><cn id="S4.T3.5.1.1.m1.1.1.2.cmml" type="float" xref="S4.T3.5.1.1.m1.1.1.2">53.6</cn><times id="S4.T3.5.1.1.m1.1.1.3.cmml" xref="S4.T3.5.1.1.m1.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.5.1.1.m1.1c">53.6^{*}</annotation><annotation encoding="application/x-llamapun" id="S4.T3.5.1.1.m1.1d">53.6 start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T3.6.2.2"><math alttext="63.4^{*}" class="ltx_Math" display="inline" id="S4.T3.6.2.2.m1.1"><semantics id="S4.T3.6.2.2.m1.1a"><msup id="S4.T3.6.2.2.m1.1.1" xref="S4.T3.6.2.2.m1.1.1.cmml"><mn id="S4.T3.6.2.2.m1.1.1.2" xref="S4.T3.6.2.2.m1.1.1.2.cmml">63.4</mn><mo id="S4.T3.6.2.2.m1.1.1.3" xref="S4.T3.6.2.2.m1.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="S4.T3.6.2.2.m1.1b"><apply id="S4.T3.6.2.2.m1.1.1.cmml" xref="S4.T3.6.2.2.m1.1.1"><csymbol cd="ambiguous" id="S4.T3.6.2.2.m1.1.1.1.cmml" xref="S4.T3.6.2.2.m1.1.1">superscript</csymbol><cn id="S4.T3.6.2.2.m1.1.1.2.cmml" type="float" xref="S4.T3.6.2.2.m1.1.1.2">63.4</cn><times id="S4.T3.6.2.2.m1.1.1.3.cmml" xref="S4.T3.6.2.2.m1.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.6.2.2.m1.1c">63.4^{*}</annotation><annotation encoding="application/x-llamapun" id="S4.T3.6.2.2.m1.1d">63.4 start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T3.7.3.3"><math alttext="61.7^{*}" class="ltx_Math" display="inline" id="S4.T3.7.3.3.m1.1"><semantics id="S4.T3.7.3.3.m1.1a"><msup id="S4.T3.7.3.3.m1.1.1" xref="S4.T3.7.3.3.m1.1.1.cmml"><mn id="S4.T3.7.3.3.m1.1.1.2" xref="S4.T3.7.3.3.m1.1.1.2.cmml">61.7</mn><mo id="S4.T3.7.3.3.m1.1.1.3" xref="S4.T3.7.3.3.m1.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="S4.T3.7.3.3.m1.1b"><apply id="S4.T3.7.3.3.m1.1.1.cmml" xref="S4.T3.7.3.3.m1.1.1"><csymbol cd="ambiguous" id="S4.T3.7.3.3.m1.1.1.1.cmml" xref="S4.T3.7.3.3.m1.1.1">superscript</csymbol><cn id="S4.T3.7.3.3.m1.1.1.2.cmml" type="float" xref="S4.T3.7.3.3.m1.1.1.2">61.7</cn><times id="S4.T3.7.3.3.m1.1.1.3.cmml" xref="S4.T3.7.3.3.m1.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.7.3.3.m1.1c">61.7^{*}</annotation><annotation encoding="application/x-llamapun" id="S4.T3.7.3.3.m1.1d">61.7 start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S4.T3.9.5">
<td class="ltx_td ltx_nopad_r ltx_align_left ltx_border_r" id="S4.T3.9.5.3">Con-J w/o Hint</td>
<td class="ltx_td ltx_align_left" id="S4.T3.8.4.1"><math alttext="61.3^{*}" class="ltx_Math" display="inline" id="S4.T3.8.4.1.m1.1"><semantics id="S4.T3.8.4.1.m1.1a"><msup id="S4.T3.8.4.1.m1.1.1" xref="S4.T3.8.4.1.m1.1.1.cmml"><mn id="S4.T3.8.4.1.m1.1.1.2" xref="S4.T3.8.4.1.m1.1.1.2.cmml">61.3</mn><mo id="S4.T3.8.4.1.m1.1.1.3" xref="S4.T3.8.4.1.m1.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="S4.T3.8.4.1.m1.1b"><apply id="S4.T3.8.4.1.m1.1.1.cmml" xref="S4.T3.8.4.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T3.8.4.1.m1.1.1.1.cmml" xref="S4.T3.8.4.1.m1.1.1">superscript</csymbol><cn id="S4.T3.8.4.1.m1.1.1.2.cmml" type="float" xref="S4.T3.8.4.1.m1.1.1.2">61.3</cn><times id="S4.T3.8.4.1.m1.1.1.3.cmml" xref="S4.T3.8.4.1.m1.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.8.4.1.m1.1c">61.3^{*}</annotation><annotation encoding="application/x-llamapun" id="S4.T3.8.4.1.m1.1d">61.3 start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left" id="S4.T3.9.5.2"><math alttext="77.4^{*}" class="ltx_Math" display="inline" id="S4.T3.9.5.2.m1.1"><semantics id="S4.T3.9.5.2.m1.1a"><msup id="S4.T3.9.5.2.m1.1.1" xref="S4.T3.9.5.2.m1.1.1.cmml"><mn id="S4.T3.9.5.2.m1.1.1.2" xref="S4.T3.9.5.2.m1.1.1.2.cmml">77.4</mn><mo id="S4.T3.9.5.2.m1.1.1.3" xref="S4.T3.9.5.2.m1.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="S4.T3.9.5.2.m1.1b"><apply id="S4.T3.9.5.2.m1.1.1.cmml" xref="S4.T3.9.5.2.m1.1.1"><csymbol cd="ambiguous" id="S4.T3.9.5.2.m1.1.1.1.cmml" xref="S4.T3.9.5.2.m1.1.1">superscript</csymbol><cn id="S4.T3.9.5.2.m1.1.1.2.cmml" type="float" xref="S4.T3.9.5.2.m1.1.1.2">77.4</cn><times id="S4.T3.9.5.2.m1.1.1.3.cmml" xref="S4.T3.9.5.2.m1.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.9.5.2.m1.1c">77.4^{*}</annotation><annotation encoding="application/x-llamapun" id="S4.T3.9.5.2.m1.1d">77.4 start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left" id="S4.T3.9.5.4">68.2</td>
</tr>
<tr class="ltx_tr" id="S4.T3.12.8">
<td class="ltx_td ltx_nopad_r ltx_align_left ltx_border_r" id="S4.T3.12.8.4">Con-J w/o DPO</td>
<td class="ltx_td ltx_align_left" id="S4.T3.10.6.1"><math alttext="54.6^{*}" class="ltx_Math" display="inline" id="S4.T3.10.6.1.m1.1"><semantics id="S4.T3.10.6.1.m1.1a"><msup id="S4.T3.10.6.1.m1.1.1" xref="S4.T3.10.6.1.m1.1.1.cmml"><mn id="S4.T3.10.6.1.m1.1.1.2" xref="S4.T3.10.6.1.m1.1.1.2.cmml">54.6</mn><mo id="S4.T3.10.6.1.m1.1.1.3" xref="S4.T3.10.6.1.m1.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="S4.T3.10.6.1.m1.1b"><apply id="S4.T3.10.6.1.m1.1.1.cmml" xref="S4.T3.10.6.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T3.10.6.1.m1.1.1.1.cmml" xref="S4.T3.10.6.1.m1.1.1">superscript</csymbol><cn id="S4.T3.10.6.1.m1.1.1.2.cmml" type="float" xref="S4.T3.10.6.1.m1.1.1.2">54.6</cn><times id="S4.T3.10.6.1.m1.1.1.3.cmml" xref="S4.T3.10.6.1.m1.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.10.6.1.m1.1c">54.6^{*}</annotation><annotation encoding="application/x-llamapun" id="S4.T3.10.6.1.m1.1d">54.6 start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left" id="S4.T3.11.7.2"><math alttext="64.2^{*}" class="ltx_Math" display="inline" id="S4.T3.11.7.2.m1.1"><semantics id="S4.T3.11.7.2.m1.1a"><msup id="S4.T3.11.7.2.m1.1.1" xref="S4.T3.11.7.2.m1.1.1.cmml"><mn id="S4.T3.11.7.2.m1.1.1.2" xref="S4.T3.11.7.2.m1.1.1.2.cmml">64.2</mn><mo id="S4.T3.11.7.2.m1.1.1.3" xref="S4.T3.11.7.2.m1.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="S4.T3.11.7.2.m1.1b"><apply id="S4.T3.11.7.2.m1.1.1.cmml" xref="S4.T3.11.7.2.m1.1.1"><csymbol cd="ambiguous" id="S4.T3.11.7.2.m1.1.1.1.cmml" xref="S4.T3.11.7.2.m1.1.1">superscript</csymbol><cn id="S4.T3.11.7.2.m1.1.1.2.cmml" type="float" xref="S4.T3.11.7.2.m1.1.1.2">64.2</cn><times id="S4.T3.11.7.2.m1.1.1.3.cmml" xref="S4.T3.11.7.2.m1.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.11.7.2.m1.1c">64.2^{*}</annotation><annotation encoding="application/x-llamapun" id="S4.T3.11.7.2.m1.1d">64.2 start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left" id="S4.T3.12.8.3"><math alttext="63.5^{*}" class="ltx_Math" display="inline" id="S4.T3.12.8.3.m1.1"><semantics id="S4.T3.12.8.3.m1.1a"><msup id="S4.T3.12.8.3.m1.1.1" xref="S4.T3.12.8.3.m1.1.1.cmml"><mn id="S4.T3.12.8.3.m1.1.1.2" xref="S4.T3.12.8.3.m1.1.1.2.cmml">63.5</mn><mo id="S4.T3.12.8.3.m1.1.1.3" xref="S4.T3.12.8.3.m1.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="S4.T3.12.8.3.m1.1b"><apply id="S4.T3.12.8.3.m1.1.1.cmml" xref="S4.T3.12.8.3.m1.1.1"><csymbol cd="ambiguous" id="S4.T3.12.8.3.m1.1.1.1.cmml" xref="S4.T3.12.8.3.m1.1.1">superscript</csymbol><cn id="S4.T3.12.8.3.m1.1.1.2.cmml" type="float" xref="S4.T3.12.8.3.m1.1.1.2">63.5</cn><times id="S4.T3.12.8.3.m1.1.1.3.cmml" xref="S4.T3.12.8.3.m1.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.12.8.3.m1.1c">63.5^{*}</annotation><annotation encoding="application/x-llamapun" id="S4.T3.12.8.3.m1.1d">63.5 start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S4.T3.12.10">
<td class="ltx_td ltx_nopad_r ltx_align_left ltx_border_bb ltx_border_r" id="S4.T3.12.10.1">Con-J</td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="S4.T3.12.10.2"><span class="ltx_text ltx_font_bold" id="S4.T3.12.10.2.1">72.4</span></td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="S4.T3.12.10.3"><span class="ltx_text ltx_font_bold" id="S4.T3.12.10.3.1">85.0</span></td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="S4.T3.12.10.4"><span class="ltx_text ltx_font_bold" id="S4.T3.12.10.4.1">70.1</span></td>
</tr>
</table>
</figure>
<div class="ltx_para ltx_noindent" id="S4.SS2.p3">
<p class="ltx_p" id="S4.SS2.p3.1">For a fair comparison with other generative judge models, we trained an open-source version of Con-J using the publicly available dataset Skywork-Reward-Preference-80K-v0.1, and evaluated its performance on public benchmarks, as shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2410.03742v1#S4.T2" title="Table 2 ‣ 4.2 Main Results ‣ 4 Experiments ‣ Beyond Scalar Reward Model: Learning Generative Judge from Preference Data"><span class="ltx_text ltx_ref_tag">2</span></a>.
Con-J outperforms existing publicly available large language models (LLMs) in the vast majority of benchmarks, including commercial instruction-tuned models such as Llama series, Qwen series, and a series of LLMs trained specially for preference judgments such as Auto-J and Prometheus 2, except in the Chat and Reasoning sub-task of Reward-Bench.
Additionally, Con-J achieves comparable performance with the closed-source model GPT-4o in all benchmarks.
As of September 18, 2024, Con-J ranks first on the reward-bench leaderboard among all models within 7B parameters, as well as second among open-source generative models.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Preference learning yields meaningful and useful rationales.</h3>
<div class="ltx_para ltx_noindent" id="S4.SS3.p1">
<p class="ltx_p" id="S4.SS3.p1.1">We select 5 checkpoints trained on different numbers of contrastive judgment pairs, i.e., 2k, 4k, 8k, 16k, and 50k.
Then we prompt GPT-4o with the question, corresponding pair of answers, and the judgment generated by Con-J (see the prompt in Table <a class="ltx_ref" href="https://arxiv.org/html/2410.03742v1#A1.T9" title="Table 9 ‣ Appendix A Appendix ‣ Beyond Scalar Reward Model: Learning Generative Judge from Preference Data"><span class="ltx_text ltx_ref_tag">9</span></a>).
GPT-4o is instructed to score the judgment ranging from 1 to 5 for the rationale’s correctness and from 1 to 3 for the rationale’s consistency with its predicted preference.
Additionally, GPT-4o is tasked as a meta-judge to evaluate whether Con-J makes correct preference predictions.
In this process, if the judgments of GPT-4o conflict with the dataset’s true preference annotations, we exclude these questions for further analysis, as these questions may exceed GPT-4o’s capabilities.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS3.p2">
<p class="ltx_p" id="S4.SS3.p2.1">Experimental results are presented in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03742v1#S4.F3" title="Figure 3 ‣ 4.3 Preference learning yields meaningful and useful rationales. ‣ 4 Experiments ‣ Beyond Scalar Reward Model: Learning Generative Judge from Preference Data"><span class="ltx_text ltx_ref_tag">3</span></a>.
From Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03742v1#S4.F3" title="Figure 3 ‣ 4.3 Preference learning yields meaningful and useful rationales. ‣ 4 Experiments ‣ Beyond Scalar Reward Model: Learning Generative Judge from Preference Data"><span class="ltx_text ltx_ref_tag">3</span></a>(a), we observe that the correctness of the rationales improves when Con-J is trained with more data and achieves increased judgment accuracy.
However, we find that the consistency between Con-J’s preference prediction and its rationales decreases with the increase in judgment accuracy, as shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03742v1#S4.F3" title="Figure 3 ‣ 4.3 Preference learning yields meaningful and useful rationales. ‣ 4 Experiments ‣ Beyond Scalar Reward Model: Learning Generative Judge from Preference Data"><span class="ltx_text ltx_ref_tag">3</span></a>(b).
These observations indicate that Con-J’s abilities to make binary preference predictions and generate correct rationales both improve with training.
However, the increase in inconsistency indicates that these improvements may not be balanced.
We suspect that because the supervision from preference datasets focuses solely on predicted binary preferences, the enhancement in Con-J’s binary prediction ability is more pronounced, leading to inconsistency.</p>
</div>
<figure class="ltx_figure" id="S4.F3">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F3.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="479" id="S4.F3.sf1.g1" src="extracted/5891764/figures/rationale_score_correctness.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(a) </span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F3.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="479" id="S4.F3.sf2.g1" src="extracted/5891764/figures/rationale_score_consistency.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(b) </span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F3.sf3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="479" id="S4.F3.sf3.g1" src="extracted/5891764/figures/rationale_teacher_student.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(c) </span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span> We investigated 5 checkpoints (⚫,  ⃝, ◼, <math alttext="\Box" class="ltx_Math" display="inline" id="S4.F3.2.m1.1"><semantics id="S4.F3.2.m1.1b"><mi id="S4.F3.2.m1.1.1" mathvariant="normal" xref="S4.F3.2.m1.1.1.cmml">□</mi><annotation-xml encoding="MathML-Content" id="S4.F3.2.m1.1c"><ci id="S4.F3.2.m1.1.1.cmml" xref="S4.F3.2.m1.1.1">□</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F3.2.m1.1d">\Box</annotation><annotation encoding="application/x-llamapun" id="S4.F3.2.m1.1e">□</annotation></semantics></math> , ◆, ▲, ▼) trained with different number of contrastive judgment pairs (2k,4k,8k,16k,50k).
(a-b) We prompt GPT-4o to evaluate the correctness of the rationales and their consistency with the predicted preferences.
(c) We tested the use of a strong model’s rationale as input provided to a weak model, which can enhance the accuracy of its preference prediction.
</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="S4.SS3.p3">
<p class="ltx_p" id="S4.SS3.p3.1">We further test whether the improved rationales can be used to help a weak judge make better judgments.
We use the untrained Con-J as the weak judge and prompt it with the rationales generated by the stronger model.
As shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03742v1#S4.F3" title="Figure 3 ‣ 4.3 Preference learning yields meaningful and useful rationales. ‣ 4 Experiments ‣ Beyond Scalar Reward Model: Learning Generative Judge from Preference Data"><span class="ltx_text ltx_ref_tag">3</span></a>(c), the weak judge yields more accurate preference prediction with the rationales provided by a stronger model.
Additionally, we find that rationales generated by GPT-4o can also improve the weak judge, with performance comparable to the rationales from the strongest checkpoint of Con-J.
This indicates that Con-J not only surpasses GPT-4o in preference prediction performance but also generates rationales with similar effectiveness.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.4 </span>Rationales help Con-J become less susceptible to biases in the dataset.</h3>
<div class="ltx_para ltx_noindent" id="S4.SS4.p1">
<p class="ltx_p" id="S4.SS4.p1.4">Scalar models are known to be susceptible to biases in datasets, resulting in preference judgments that reflect biases in the pattern of data rather than true human values.
To investigate the susceptibility of Con-J, we conduct a synthetic experiment that injects artificial bias into the data.
We define the degree of bias in training set <math alttext="\mathcal{D}_{\text{train}}" class="ltx_Math" display="inline" id="S4.SS4.p1.1.m1.1"><semantics id="S4.SS4.p1.1.m1.1a"><msub id="S4.SS4.p1.1.m1.1.1" xref="S4.SS4.p1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS4.p1.1.m1.1.1.2" xref="S4.SS4.p1.1.m1.1.1.2.cmml">𝒟</mi><mtext id="S4.SS4.p1.1.m1.1.1.3" xref="S4.SS4.p1.1.m1.1.1.3a.cmml">train</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.1.m1.1b"><apply id="S4.SS4.p1.1.m1.1.1.cmml" xref="S4.SS4.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS4.p1.1.m1.1.1.1.cmml" xref="S4.SS4.p1.1.m1.1.1">subscript</csymbol><ci id="S4.SS4.p1.1.m1.1.1.2.cmml" xref="S4.SS4.p1.1.m1.1.1.2">𝒟</ci><ci id="S4.SS4.p1.1.m1.1.1.3a.cmml" xref="S4.SS4.p1.1.m1.1.1.3"><mtext id="S4.SS4.p1.1.m1.1.1.3.cmml" mathsize="70%" xref="S4.SS4.p1.1.m1.1.1.3">train</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.1.m1.1c">\mathcal{D}_{\text{train}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p1.1.m1.1d">caligraphic_D start_POSTSUBSCRIPT train end_POSTSUBSCRIPT</annotation></semantics></math> as <math alttext="\gamma" class="ltx_Math" display="inline" id="S4.SS4.p1.2.m2.1"><semantics id="S4.SS4.p1.2.m2.1a"><mi id="S4.SS4.p1.2.m2.1.1" xref="S4.SS4.p1.2.m2.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.2.m2.1b"><ci id="S4.SS4.p1.2.m2.1.1.cmml" xref="S4.SS4.p1.2.m2.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.2.m2.1c">\gamma</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p1.2.m2.1d">italic_γ</annotation></semantics></math>.
This indicates that the <math alttext="\gamma" class="ltx_Math" display="inline" id="S4.SS4.p1.3.m3.1"><semantics id="S4.SS4.p1.3.m3.1a"><mi id="S4.SS4.p1.3.m3.1.1" xref="S4.SS4.p1.3.m3.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.3.m3.1b"><ci id="S4.SS4.p1.3.m3.1.1.cmml" xref="S4.SS4.p1.3.m3.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.3.m3.1c">\gamma</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p1.3.m3.1d">italic_γ</annotation></semantics></math> proportion of the data contains unexpected biases that don’t necessarily reflect human value, while the rest <math alttext="1-\gamma" class="ltx_Math" display="inline" id="S4.SS4.p1.4.m4.1"><semantics id="S4.SS4.p1.4.m4.1a"><mrow id="S4.SS4.p1.4.m4.1.1" xref="S4.SS4.p1.4.m4.1.1.cmml"><mn id="S4.SS4.p1.4.m4.1.1.2" xref="S4.SS4.p1.4.m4.1.1.2.cmml">1</mn><mo id="S4.SS4.p1.4.m4.1.1.1" xref="S4.SS4.p1.4.m4.1.1.1.cmml">−</mo><mi id="S4.SS4.p1.4.m4.1.1.3" xref="S4.SS4.p1.4.m4.1.1.3.cmml">γ</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.4.m4.1b"><apply id="S4.SS4.p1.4.m4.1.1.cmml" xref="S4.SS4.p1.4.m4.1.1"><minus id="S4.SS4.p1.4.m4.1.1.1.cmml" xref="S4.SS4.p1.4.m4.1.1.1"></minus><cn id="S4.SS4.p1.4.m4.1.1.2.cmml" type="integer" xref="S4.SS4.p1.4.m4.1.1.2">1</cn><ci id="S4.SS4.p1.4.m4.1.1.3.cmml" xref="S4.SS4.p1.4.m4.1.1.3">𝛾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.4.m4.1c">1-\gamma</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p1.4.m4.1d">1 - italic_γ</annotation></semantics></math> of the data are randomly sampled from the original training set.</p>
</div>
<figure class="ltx_figure" id="S4.F4">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_4">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F4.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="436" id="S4.F4.sf1.g1" src="extracted/5891764/figures/format.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(a) </span>Format (Adversarial)</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F4.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="434" id="S4.F4.sf2.g1" src="extracted/5891764/figures/test.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(b) </span>Format (General)</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F4.sf3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="434" id="S4.F4.sf3.g1" src="extracted/5891764/figures/format_length.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(c) </span>Verbosity (Adversarial)</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F4.sf4"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="434" id="S4.F4.sf4.g1" src="extracted/5891764/figures/test_length.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(d) </span>Verbosity (General)</figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>The performance comparison of Con-J, Scalar model, and Con-J (without rationale), trained with varying degrees of dataset bias (<math alttext="\gamma" class="ltx_Math" display="inline" id="S4.F4.2.m1.1"><semantics id="S4.F4.2.m1.1b"><mi id="S4.F4.2.m1.1.1" xref="S4.F4.2.m1.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S4.F4.2.m1.1c"><ci id="S4.F4.2.m1.1.1.cmml" xref="S4.F4.2.m1.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F4.2.m1.1d">\gamma</annotation><annotation encoding="application/x-llamapun" id="S4.F4.2.m1.1e">italic_γ</annotation></semantics></math>) in format and verbosity, and evaluated on Adversarial and General test sets. </figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="S4.SS4.p2">
<p class="ltx_p" id="S4.SS4.p2.1">We consider two widely studied biases: format bias and verbosity bias <cite class="ltx_cite ltx_citemacro_cite">Park et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03742v1#bib.bib25" title="">2024</a>); Singhal et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03742v1#bib.bib31" title="">2023</a>); Shen et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03742v1#bib.bib29" title="">2023</a>)</cite>.
For format bias, we use two different prompts to rewrite the pair of answers (see prompt instructions in Table <a class="ltx_ref" href="https://arxiv.org/html/2410.03742v1#A1.T8" title="Table 8 ‣ Appendix A Appendix ‣ Beyond Scalar Reward Model: Learning Generative Judge from Preference Data"><span class="ltx_text ltx_ref_tag">8</span></a>).
Specifically, we rewrite the good answer with a more verbal format and the bad answer with a more formal format with GPT-4o.
For verbosity bias, we follow existing practice <cite class="ltx_cite ltx_citemacro_cite">Zheng et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03742v1#bib.bib41" title="">2023</a>)</cite> by asking GPT-4o to rephrase the good answer without adding any new information and insert the rephrased text at the end of the original answer.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS4.p3">
<p class="ltx_p" id="S4.SS4.p3.3">All experiments are conducted on a filtered Math dataset, where the filtering ensures that the solution in the preferred answer is correct, while incorrect in the less preferred answer.
In this scenario, the format and verbosity of the answers should not be considered in the preference judgments as the correctness of the solution is prioritized.
We investigate the performance of Con-J, SM, and Con-J trained and evaluated without generating the rationales (see the prompt examples in Table <a class="ltx_ref" href="https://arxiv.org/html/2410.03742v1#A1.T7" title="Table 7 ‣ Appendix A Appendix ‣ Beyond Scalar Reward Model: Learning Generative Judge from Preference Data"><span class="ltx_text ltx_ref_tag">7</span></a>) under the injections of the addressed bias.
We trained them on a biased dataset and tested their performance on an original, test set <math alttext="\mathcal{D}_{\text{test}}^{\text{general}}" class="ltx_Math" display="inline" id="S4.SS4.p3.1.m1.1"><semantics id="S4.SS4.p3.1.m1.1a"><msubsup id="S4.SS4.p3.1.m1.1.1" xref="S4.SS4.p3.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS4.p3.1.m1.1.1.2.2" xref="S4.SS4.p3.1.m1.1.1.2.2.cmml">𝒟</mi><mtext id="S4.SS4.p3.1.m1.1.1.2.3" xref="S4.SS4.p3.1.m1.1.1.2.3a.cmml">test</mtext><mtext id="S4.SS4.p3.1.m1.1.1.3" xref="S4.SS4.p3.1.m1.1.1.3a.cmml">general</mtext></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS4.p3.1.m1.1b"><apply id="S4.SS4.p3.1.m1.1.1.cmml" xref="S4.SS4.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS4.p3.1.m1.1.1.1.cmml" xref="S4.SS4.p3.1.m1.1.1">superscript</csymbol><apply id="S4.SS4.p3.1.m1.1.1.2.cmml" xref="S4.SS4.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS4.p3.1.m1.1.1.2.1.cmml" xref="S4.SS4.p3.1.m1.1.1">subscript</csymbol><ci id="S4.SS4.p3.1.m1.1.1.2.2.cmml" xref="S4.SS4.p3.1.m1.1.1.2.2">𝒟</ci><ci id="S4.SS4.p3.1.m1.1.1.2.3a.cmml" xref="S4.SS4.p3.1.m1.1.1.2.3"><mtext id="S4.SS4.p3.1.m1.1.1.2.3.cmml" mathsize="70%" xref="S4.SS4.p3.1.m1.1.1.2.3">test</mtext></ci></apply><ci id="S4.SS4.p3.1.m1.1.1.3a.cmml" xref="S4.SS4.p3.1.m1.1.1.3"><mtext id="S4.SS4.p3.1.m1.1.1.3.cmml" mathsize="70%" xref="S4.SS4.p3.1.m1.1.1.3">general</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p3.1.m1.1c">\mathcal{D}_{\text{test}}^{\text{general}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p3.1.m1.1d">caligraphic_D start_POSTSUBSCRIPT test end_POSTSUBSCRIPT start_POSTSUPERSCRIPT general end_POSTSUPERSCRIPT</annotation></semantics></math> without any modification, and a test set constructed by injecting a contrary bias <math alttext="\mathcal{D}_{\text{test}}^{\text{adversarial}}" class="ltx_Math" display="inline" id="S4.SS4.p3.2.m2.1"><semantics id="S4.SS4.p3.2.m2.1a"><msubsup id="S4.SS4.p3.2.m2.1.1" xref="S4.SS4.p3.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS4.p3.2.m2.1.1.2.2" xref="S4.SS4.p3.2.m2.1.1.2.2.cmml">𝒟</mi><mtext id="S4.SS4.p3.2.m2.1.1.2.3" xref="S4.SS4.p3.2.m2.1.1.2.3a.cmml">test</mtext><mtext id="S4.SS4.p3.2.m2.1.1.3" xref="S4.SS4.p3.2.m2.1.1.3a.cmml">adversarial</mtext></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS4.p3.2.m2.1b"><apply id="S4.SS4.p3.2.m2.1.1.cmml" xref="S4.SS4.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS4.p3.2.m2.1.1.1.cmml" xref="S4.SS4.p3.2.m2.1.1">superscript</csymbol><apply id="S4.SS4.p3.2.m2.1.1.2.cmml" xref="S4.SS4.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS4.p3.2.m2.1.1.2.1.cmml" xref="S4.SS4.p3.2.m2.1.1">subscript</csymbol><ci id="S4.SS4.p3.2.m2.1.1.2.2.cmml" xref="S4.SS4.p3.2.m2.1.1.2.2">𝒟</ci><ci id="S4.SS4.p3.2.m2.1.1.2.3a.cmml" xref="S4.SS4.p3.2.m2.1.1.2.3"><mtext id="S4.SS4.p3.2.m2.1.1.2.3.cmml" mathsize="70%" xref="S4.SS4.p3.2.m2.1.1.2.3">test</mtext></ci></apply><ci id="S4.SS4.p3.2.m2.1.1.3a.cmml" xref="S4.SS4.p3.2.m2.1.1.3"><mtext id="S4.SS4.p3.2.m2.1.1.3.cmml" mathsize="70%" xref="S4.SS4.p3.2.m2.1.1.3">adversarial</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p3.2.m2.1c">\mathcal{D}_{\text{test}}^{\text{adversarial}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p3.2.m2.1d">caligraphic_D start_POSTSUBSCRIPT test end_POSTSUBSCRIPT start_POSTSUPERSCRIPT adversarial end_POSTSUPERSCRIPT</annotation></semantics></math>.
The contrary bias involves applying the bias for preferred answers from the training set to less preferred answers in the testing phase, and vice versa.
The training used the same learning rate as mentioned earlier.
All models achieved an accuracy of over 99% on the biased training dataset when <math alttext="\gamma=1" class="ltx_Math" display="inline" id="S4.SS4.p3.3.m3.1"><semantics id="S4.SS4.p3.3.m3.1a"><mrow id="S4.SS4.p3.3.m3.1.1" xref="S4.SS4.p3.3.m3.1.1.cmml"><mi id="S4.SS4.p3.3.m3.1.1.2" xref="S4.SS4.p3.3.m3.1.1.2.cmml">γ</mi><mo id="S4.SS4.p3.3.m3.1.1.1" xref="S4.SS4.p3.3.m3.1.1.1.cmml">=</mo><mn id="S4.SS4.p3.3.m3.1.1.3" xref="S4.SS4.p3.3.m3.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p3.3.m3.1b"><apply id="S4.SS4.p3.3.m3.1.1.cmml" xref="S4.SS4.p3.3.m3.1.1"><eq id="S4.SS4.p3.3.m3.1.1.1.cmml" xref="S4.SS4.p3.3.m3.1.1.1"></eq><ci id="S4.SS4.p3.3.m3.1.1.2.cmml" xref="S4.SS4.p3.3.m3.1.1.2">𝛾</ci><cn id="S4.SS4.p3.3.m3.1.1.3.cmml" type="integer" xref="S4.SS4.p3.3.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p3.3.m3.1c">\gamma=1</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p3.3.m3.1d">italic_γ = 1</annotation></semantics></math>, indicating the models are thoroughly trained on the data and are strongly influenced by the bias.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS4.p4">
<p class="ltx_p" id="S4.SS4.p4.2">We present the experimental results in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03742v1#S4.F4" title="Figure 4 ‣ 4.4 Rationales help Con-J become less susceptible to biases in the dataset. ‣ 4 Experiments ‣ Beyond Scalar Reward Model: Learning Generative Judge from Preference Data"><span class="ltx_text ltx_ref_tag">4</span></a>(a-d).
From Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03742v1#S4.F4" title="Figure 4 ‣ 4.4 Rationales help Con-J become less susceptible to biases in the dataset. ‣ 4 Experiments ‣ Beyond Scalar Reward Model: Learning Generative Judge from Preference Data"><span class="ltx_text ltx_ref_tag">4</span></a>(a-d), we have the following observations:
(i) Con-J outperforms SM when trained with biased data.
Intuitively, Con-J does not train a value head from scratch; instead, it leverages the text generation capabilities of pre-trained LLMs.
This approach helps retain global knowledge about the task from pretraining and allows it to extract useful judgment standards even from biased data.
(ii) When tested on the adversarial datasets, Con-J without rationales significantly underperforms Con-J when <math alttext="\gamma&gt;0.2" class="ltx_Math" display="inline" id="S4.SS4.p4.1.m1.1"><semantics id="S4.SS4.p4.1.m1.1a"><mrow id="S4.SS4.p4.1.m1.1.1" xref="S4.SS4.p4.1.m1.1.1.cmml"><mi id="S4.SS4.p4.1.m1.1.1.2" xref="S4.SS4.p4.1.m1.1.1.2.cmml">γ</mi><mo id="S4.SS4.p4.1.m1.1.1.1" xref="S4.SS4.p4.1.m1.1.1.1.cmml">&gt;</mo><mn id="S4.SS4.p4.1.m1.1.1.3" xref="S4.SS4.p4.1.m1.1.1.3.cmml">0.2</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p4.1.m1.1b"><apply id="S4.SS4.p4.1.m1.1.1.cmml" xref="S4.SS4.p4.1.m1.1.1"><gt id="S4.SS4.p4.1.m1.1.1.1.cmml" xref="S4.SS4.p4.1.m1.1.1.1"></gt><ci id="S4.SS4.p4.1.m1.1.1.2.cmml" xref="S4.SS4.p4.1.m1.1.1.2">𝛾</ci><cn id="S4.SS4.p4.1.m1.1.1.3.cmml" type="float" xref="S4.SS4.p4.1.m1.1.1.3">0.2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p4.1.m1.1c">\gamma&gt;0.2</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p4.1.m1.1d">italic_γ &gt; 0.2</annotation></semantics></math> and <math alttext="\gamma&gt;0.33" class="ltx_Math" display="inline" id="S4.SS4.p4.2.m2.1"><semantics id="S4.SS4.p4.2.m2.1a"><mrow id="S4.SS4.p4.2.m2.1.1" xref="S4.SS4.p4.2.m2.1.1.cmml"><mi id="S4.SS4.p4.2.m2.1.1.2" xref="S4.SS4.p4.2.m2.1.1.2.cmml">γ</mi><mo id="S4.SS4.p4.2.m2.1.1.1" xref="S4.SS4.p4.2.m2.1.1.1.cmml">&gt;</mo><mn id="S4.SS4.p4.2.m2.1.1.3" xref="S4.SS4.p4.2.m2.1.1.3.cmml">0.33</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p4.2.m2.1b"><apply id="S4.SS4.p4.2.m2.1.1.cmml" xref="S4.SS4.p4.2.m2.1.1"><gt id="S4.SS4.p4.2.m2.1.1.1.cmml" xref="S4.SS4.p4.2.m2.1.1.1"></gt><ci id="S4.SS4.p4.2.m2.1.1.2.cmml" xref="S4.SS4.p4.2.m2.1.1.2">𝛾</ci><cn id="S4.SS4.p4.2.m2.1.1.3.cmml" type="float" xref="S4.SS4.p4.2.m2.1.1.3">0.33</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p4.2.m2.1c">\gamma&gt;0.33</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p4.2.m2.1d">italic_γ &gt; 0.33</annotation></semantics></math> for the format bias and the verbosity bias, respectively.
The above observations indicate that Con-J becomes more robust at learning from biased data through training with rationales.
(iii) When tested on general test sets, Con-J without rationales demonstrates comparable performance to Con-J with rationales.
Some existing research suggests that rationales or critics generated ahead of preference judgments can facilitate Chain-of-Thought (CoT) reasoning and help the LLM make better judgments <cite class="ltx_cite ltx_citemacro_cite">Lee et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03742v1#bib.bib19" title="">2024</a>); Ankner et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03742v1#bib.bib1" title="">2024</a>); Ye et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03742v1#bib.bib37" title="">2024</a>); Zhang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03742v1#bib.bib39" title="">2024</a>)</cite>.
A possible explanation for the lack of a similar CoT effect in our data is that the CoT process is often already embedded in the responses, making the CoT procedure for judgment potentially unnecessary.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.5 </span>Case Analysis of Con-J</h3>
<figure class="ltx_table" id="S4.T4">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 4: </span>Example of rationales and binary preference generated by Con-J. We prompt GPT-4o to annotate the correctness (ranging from 1 to 5) of the rationales and consistency between the predicted preference and the rationale (ranging from 1 to 3). </figcaption>
<table class="ltx_tabular ltx_align_middle" id="S4.T4.2">
<tr class="ltx_tr" id="S4.T4.2.3">
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="2" id="S4.T4.2.3.1"><span class="ltx_text ltx_font_bold" id="S4.T4.2.3.1.1">Prompt input</span></td>
<td class="ltx_td ltx_align_center ltx_align_top ltx_border_tt" id="S4.T4.2.3.2"><span class="ltx_text ltx_font_bold" id="S4.T4.2.3.2.1">Rationale</span></td>
<td class="ltx_td ltx_align_center ltx_align_top ltx_border_tt" id="S4.T4.2.3.3"><span class="ltx_text ltx_font_bold" id="S4.T4.2.3.3.1">Preferred</span></td>
</tr>
<tr class="ltx_tr" id="S4.T4.2.4">
<td class="ltx_td ltx_nopad_r ltx_align_right ltx_border_r ltx_border_t" id="S4.T4.2.4.1">
<span class="ltx_text" id="S4.T4.2.4.1.1">
<span class="ltx_inline-block ltx_transformed_outer" id="S4.T4.2.4.1.1.1" style="width:10.0pt;height:69pt;vertical-align:-32.0pt;"><span class="ltx_transformed_inner" style="width:68.9pt;transform:translate(-29.46pt,3.75pt) rotate(-90deg) ;">
<span class="ltx_p" id="S4.T4.2.4.1.1.1.1"><span class="ltx_text ltx_font_bold" id="S4.T4.2.4.1.1.1.1.1">Creation (1)<span class="ltx_text ltx_phantom ltx_font_medium" id="S4.T4.2.4.1.1.1.1.1.1"><span style="visibility:hidden">XX</span></span></span></span>
</span></span></span></td>
<td class="ltx_td ltx_nopad_r ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="S4.T4.2.4.2">
<span class="ltx_inline-block ltx_align_top" id="S4.T4.2.4.2.1">
<span class="ltx_p" id="S4.T4.2.4.2.1.1" style="width:206.3pt;"><span class="ltx_text ltx_font_bold" id="S4.T4.2.4.2.1.1.1">Question:</span> On the theme of comprehensive rural revitalization, propose a paper title. 
<br class="ltx_break"/><span class="ltx_text ltx_font_bold" id="S4.T4.2.4.2.1.1.2">Answer 1:</span> Research on Strategic Pathways for Rural Revitalization from a Multi-Collaborative Perspective. 
<br class="ltx_break"/><span class="ltx_text ltx_font_bold" id="S4.T4.2.4.2.1.1.3">Answer 2:</span> Comprehensive Rural Revitalization: Deep Integration of Strategies and Practices.</span>
</span></td>
<td class="ltx_td ltx_nopad_r ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="S4.T4.2.4.3">
<span class="ltx_inline-block ltx_align_top" id="S4.T4.2.4.3.1">
<span class="ltx_p" id="S4.T4.2.4.3.1.1" style="width:106.7pt;">The second answer provides a broader applicability and depth of description, with a smoother and more natural context than the first answer. 
<br class="ltx_break"/><span class="ltx_text ltx_font_bold ltx_font_italic" id="S4.T4.2.4.3.1.1.1" style="color:#0000FF;">Correctness: 5, Consistency: 3</span></span>
</span></td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="S4.T4.2.4.4">
<span class="ltx_inline-block ltx_align_top" id="S4.T4.2.4.4.1">
<span class="ltx_p" id="S4.T4.2.4.4.1.1" style="width:19.9pt;">Answer 2 
<br class="ltx_break ltx_centering"/>(<span class="ltx_text ltx_align_center" id="S4.T4.2.4.4.1.1.1" style="color:#00FF00;">correct</span>)</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T4.2.5">
<td class="ltx_td ltx_nopad_r ltx_align_right ltx_border_r ltx_border_t" id="S4.T4.2.5.1">
<span class="ltx_text" id="S4.T4.2.5.1.1">
<span class="ltx_inline-block ltx_transformed_outer" id="S4.T4.2.5.1.1.1" style="width:10.0pt;height:62.2pt;vertical-align:-28.6pt;"><span class="ltx_transformed_inner" style="width:62.2pt;transform:translate(-26.11pt,3.75pt) rotate(-90deg) ;">
<span class="ltx_p" id="S4.T4.2.5.1.1.1.1"><span class="ltx_text ltx_font_bold" id="S4.T4.2.5.1.1.1.1.1">Math (1)<span class="ltx_text ltx_phantom ltx_font_medium" id="S4.T4.2.5.1.1.1.1.1.1"><span style="visibility:hidden">XXX</span></span></span></span>
</span></span></span></td>
<td class="ltx_td ltx_nopad_r ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="S4.T4.2.5.2">
<span class="ltx_inline-block ltx_align_top" id="S4.T4.2.5.2.1">
<span class="ltx_p" id="S4.T4.2.5.2.1.1" style="width:206.3pt;"><span class="ltx_text ltx_font_bold" id="S4.T4.2.5.2.1.1.1">Question:</span> Today is August 12, 2021. What was the date 30 days ago? 
<br class="ltx_break"/><span class="ltx_text ltx_font_bold" id="S4.T4.2.5.2.1.1.2">Answer 1:</span> According to the given information, today is August 12, 2021, so 30 days ago was July 13, 2021. Therefore, 30 days ago was July 13, 2021. 
<br class="ltx_break"/><span class="ltx_text ltx_font_bold" id="S4.T4.2.5.2.1.1.3">Answer 2:</span> July 12, 2021.</span>
</span></td>
<td class="ltx_td ltx_nopad_r ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="S4.T4.2.5.3">
<span class="ltx_inline-block ltx_align_top" id="S4.T4.2.5.3.1">
<span class="ltx_p" id="S4.T4.2.5.3.1.1" style="width:106.7pt;">The second answer does not provide a detailed explanation, whereas the first answer offers a detailed reasoning process and uses correct date subtraction logic. 
<br class="ltx_break"/><span class="ltx_text ltx_font_bold ltx_font_italic" id="S4.T4.2.5.3.1.1.1" style="color:#0000FF;">Correctness: 2, Consistency: 3</span></span>
</span></td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="S4.T4.2.5.4">
<span class="ltx_inline-block ltx_align_top" id="S4.T4.2.5.4.1">
<span class="ltx_p" id="S4.T4.2.5.4.1.1" style="width:19.9pt;">Answer 1 (<span class="ltx_text ltx_align_center" id="S4.T4.2.5.4.1.1.1" style="color:#FF0000;">incorrect</span>)</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T4.2.2">
<td class="ltx_td ltx_nopad_r ltx_align_right ltx_border_r ltx_border_t" id="S4.T4.2.2.3">
<span class="ltx_text" id="S4.T4.2.2.3.1">
<span class="ltx_inline-block ltx_transformed_outer" id="S4.T4.2.2.3.1.1" style="width:10.0pt;height:69.8pt;vertical-align:-32.4pt;"><span class="ltx_transformed_inner" style="width:69.7pt;transform:translate(-29.86pt,3.75pt) rotate(-90deg) ;">
<span class="ltx_p" id="S4.T4.2.2.3.1.1.1"><span class="ltx_text ltx_font_bold" id="S4.T4.2.2.3.1.1.1.1">Math (2)<span class="ltx_text ltx_phantom ltx_font_medium" id="S4.T4.2.2.3.1.1.1.1.1"><span style="visibility:hidden">XXXX</span></span></span></span>
</span></span></span></td>
<td class="ltx_td ltx_nopad_r ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="S4.T4.2.2.2">
<span class="ltx_inline-block ltx_align_top" id="S4.T4.2.2.2.2">
<span class="ltx_p" id="S4.T4.2.2.2.2.2" style="width:206.3pt;"><span class="ltx_text ltx_font_bold" id="S4.T4.2.2.2.2.2.1">Question:</span> Soldiers built a 2000-meter line. They averaged 350 meters per day for the first 3 days. What is the required daily average for the remaining 2 days? 
<br class="ltx_break"/><span class="ltx_text ltx_font_bold" id="S4.T4.2.2.2.2.2.2">Answer1:</span> <math alttext="(2000-350\times 3)\div 2=1400\div 2=700" class="ltx_Math" display="inline" id="S4.T4.1.1.1.1.1.m1.1"><semantics id="S4.T4.1.1.1.1.1.m1.1a"><mrow id="S4.T4.1.1.1.1.1.m1.1.1" xref="S4.T4.1.1.1.1.1.m1.1.1.cmml"><mrow id="S4.T4.1.1.1.1.1.m1.1.1.1" xref="S4.T4.1.1.1.1.1.m1.1.1.1.cmml"><mrow id="S4.T4.1.1.1.1.1.m1.1.1.1.1.1" xref="S4.T4.1.1.1.1.1.m1.1.1.1.1.1.1.cmml"><mo id="S4.T4.1.1.1.1.1.m1.1.1.1.1.1.2" stretchy="false" xref="S4.T4.1.1.1.1.1.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.T4.1.1.1.1.1.m1.1.1.1.1.1.1" xref="S4.T4.1.1.1.1.1.m1.1.1.1.1.1.1.cmml"><mn id="S4.T4.1.1.1.1.1.m1.1.1.1.1.1.1.2" xref="S4.T4.1.1.1.1.1.m1.1.1.1.1.1.1.2.cmml">2000</mn><mo id="S4.T4.1.1.1.1.1.m1.1.1.1.1.1.1.1" xref="S4.T4.1.1.1.1.1.m1.1.1.1.1.1.1.1.cmml">−</mo><mrow id="S4.T4.1.1.1.1.1.m1.1.1.1.1.1.1.3" xref="S4.T4.1.1.1.1.1.m1.1.1.1.1.1.1.3.cmml"><mn id="S4.T4.1.1.1.1.1.m1.1.1.1.1.1.1.3.2" xref="S4.T4.1.1.1.1.1.m1.1.1.1.1.1.1.3.2.cmml">350</mn><mo id="S4.T4.1.1.1.1.1.m1.1.1.1.1.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="S4.T4.1.1.1.1.1.m1.1.1.1.1.1.1.3.1.cmml">×</mo><mn id="S4.T4.1.1.1.1.1.m1.1.1.1.1.1.1.3.3" xref="S4.T4.1.1.1.1.1.m1.1.1.1.1.1.1.3.3.cmml">3</mn></mrow></mrow><mo id="S4.T4.1.1.1.1.1.m1.1.1.1.1.1.3" stretchy="false" xref="S4.T4.1.1.1.1.1.m1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S4.T4.1.1.1.1.1.m1.1.1.1.2" xref="S4.T4.1.1.1.1.1.m1.1.1.1.2.cmml">÷</mo><mn id="S4.T4.1.1.1.1.1.m1.1.1.1.3" xref="S4.T4.1.1.1.1.1.m1.1.1.1.3.cmml">2</mn></mrow><mo id="S4.T4.1.1.1.1.1.m1.1.1.3" xref="S4.T4.1.1.1.1.1.m1.1.1.3.cmml">=</mo><mrow id="S4.T4.1.1.1.1.1.m1.1.1.4" xref="S4.T4.1.1.1.1.1.m1.1.1.4.cmml"><mn id="S4.T4.1.1.1.1.1.m1.1.1.4.2" xref="S4.T4.1.1.1.1.1.m1.1.1.4.2.cmml">1400</mn><mo id="S4.T4.1.1.1.1.1.m1.1.1.4.1" xref="S4.T4.1.1.1.1.1.m1.1.1.4.1.cmml">÷</mo><mn id="S4.T4.1.1.1.1.1.m1.1.1.4.3" xref="S4.T4.1.1.1.1.1.m1.1.1.4.3.cmml">2</mn></mrow><mo id="S4.T4.1.1.1.1.1.m1.1.1.5" xref="S4.T4.1.1.1.1.1.m1.1.1.5.cmml">=</mo><mn id="S4.T4.1.1.1.1.1.m1.1.1.6" xref="S4.T4.1.1.1.1.1.m1.1.1.6.cmml">700</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T4.1.1.1.1.1.m1.1b"><apply id="S4.T4.1.1.1.1.1.m1.1.1.cmml" xref="S4.T4.1.1.1.1.1.m1.1.1"><and id="S4.T4.1.1.1.1.1.m1.1.1a.cmml" xref="S4.T4.1.1.1.1.1.m1.1.1"></and><apply id="S4.T4.1.1.1.1.1.m1.1.1b.cmml" xref="S4.T4.1.1.1.1.1.m1.1.1"><eq id="S4.T4.1.1.1.1.1.m1.1.1.3.cmml" xref="S4.T4.1.1.1.1.1.m1.1.1.3"></eq><apply id="S4.T4.1.1.1.1.1.m1.1.1.1.cmml" xref="S4.T4.1.1.1.1.1.m1.1.1.1"><divide id="S4.T4.1.1.1.1.1.m1.1.1.1.2.cmml" xref="S4.T4.1.1.1.1.1.m1.1.1.1.2"></divide><apply id="S4.T4.1.1.1.1.1.m1.1.1.1.1.1.1.cmml" xref="S4.T4.1.1.1.1.1.m1.1.1.1.1.1"><minus id="S4.T4.1.1.1.1.1.m1.1.1.1.1.1.1.1.cmml" xref="S4.T4.1.1.1.1.1.m1.1.1.1.1.1.1.1"></minus><cn id="S4.T4.1.1.1.1.1.m1.1.1.1.1.1.1.2.cmml" type="integer" xref="S4.T4.1.1.1.1.1.m1.1.1.1.1.1.1.2">2000</cn><apply id="S4.T4.1.1.1.1.1.m1.1.1.1.1.1.1.3.cmml" xref="S4.T4.1.1.1.1.1.m1.1.1.1.1.1.1.3"><times id="S4.T4.1.1.1.1.1.m1.1.1.1.1.1.1.3.1.cmml" xref="S4.T4.1.1.1.1.1.m1.1.1.1.1.1.1.3.1"></times><cn id="S4.T4.1.1.1.1.1.m1.1.1.1.1.1.1.3.2.cmml" type="integer" xref="S4.T4.1.1.1.1.1.m1.1.1.1.1.1.1.3.2">350</cn><cn id="S4.T4.1.1.1.1.1.m1.1.1.1.1.1.1.3.3.cmml" type="integer" xref="S4.T4.1.1.1.1.1.m1.1.1.1.1.1.1.3.3">3</cn></apply></apply><cn id="S4.T4.1.1.1.1.1.m1.1.1.1.3.cmml" type="integer" xref="S4.T4.1.1.1.1.1.m1.1.1.1.3">2</cn></apply><apply id="S4.T4.1.1.1.1.1.m1.1.1.4.cmml" xref="S4.T4.1.1.1.1.1.m1.1.1.4"><divide id="S4.T4.1.1.1.1.1.m1.1.1.4.1.cmml" xref="S4.T4.1.1.1.1.1.m1.1.1.4.1"></divide><cn id="S4.T4.1.1.1.1.1.m1.1.1.4.2.cmml" type="integer" xref="S4.T4.1.1.1.1.1.m1.1.1.4.2">1400</cn><cn id="S4.T4.1.1.1.1.1.m1.1.1.4.3.cmml" type="integer" xref="S4.T4.1.1.1.1.1.m1.1.1.4.3">2</cn></apply></apply><apply id="S4.T4.1.1.1.1.1.m1.1.1c.cmml" xref="S4.T4.1.1.1.1.1.m1.1.1"><eq id="S4.T4.1.1.1.1.1.m1.1.1.5.cmml" xref="S4.T4.1.1.1.1.1.m1.1.1.5"></eq><share href="https://arxiv.org/html/2410.03742v1#S4.T4.1.1.1.1.1.m1.1.1.4.cmml" id="S4.T4.1.1.1.1.1.m1.1.1d.cmml" xref="S4.T4.1.1.1.1.1.m1.1.1"></share><cn id="S4.T4.1.1.1.1.1.m1.1.1.6.cmml" type="integer" xref="S4.T4.1.1.1.1.1.m1.1.1.6">700</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.1.1.1.1.1.m1.1c">(2000-350\times 3)\div 2=1400\div 2=700</annotation><annotation encoding="application/x-llamapun" id="S4.T4.1.1.1.1.1.m1.1d">( 2000 - 350 × 3 ) ÷ 2 = 1400 ÷ 2 = 700</annotation></semantics></math> meters.
Answer: An average of 700 meters needs to be set up each day for the last two days. 
<br class="ltx_break"/><span class="ltx_text ltx_font_bold" id="S4.T4.2.2.2.2.2.3">Answer 2:</span> <math alttext="(2000-350\times 3)\div 2=(2000-1050)\div 2=950\div 2=475" class="ltx_Math" display="inline" id="S4.T4.2.2.2.2.2.m2.2"><semantics id="S4.T4.2.2.2.2.2.m2.2a"><mrow id="S4.T4.2.2.2.2.2.m2.2.2" xref="S4.T4.2.2.2.2.2.m2.2.2.cmml"><mrow id="S4.T4.2.2.2.2.2.m2.1.1.1" xref="S4.T4.2.2.2.2.2.m2.1.1.1.cmml"><mrow id="S4.T4.2.2.2.2.2.m2.1.1.1.1.1" xref="S4.T4.2.2.2.2.2.m2.1.1.1.1.1.1.cmml"><mo id="S4.T4.2.2.2.2.2.m2.1.1.1.1.1.2" stretchy="false" xref="S4.T4.2.2.2.2.2.m2.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.T4.2.2.2.2.2.m2.1.1.1.1.1.1" xref="S4.T4.2.2.2.2.2.m2.1.1.1.1.1.1.cmml"><mn id="S4.T4.2.2.2.2.2.m2.1.1.1.1.1.1.2" xref="S4.T4.2.2.2.2.2.m2.1.1.1.1.1.1.2.cmml">2000</mn><mo id="S4.T4.2.2.2.2.2.m2.1.1.1.1.1.1.1" xref="S4.T4.2.2.2.2.2.m2.1.1.1.1.1.1.1.cmml">−</mo><mrow id="S4.T4.2.2.2.2.2.m2.1.1.1.1.1.1.3" xref="S4.T4.2.2.2.2.2.m2.1.1.1.1.1.1.3.cmml"><mn id="S4.T4.2.2.2.2.2.m2.1.1.1.1.1.1.3.2" xref="S4.T4.2.2.2.2.2.m2.1.1.1.1.1.1.3.2.cmml">350</mn><mo id="S4.T4.2.2.2.2.2.m2.1.1.1.1.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="S4.T4.2.2.2.2.2.m2.1.1.1.1.1.1.3.1.cmml">×</mo><mn id="S4.T4.2.2.2.2.2.m2.1.1.1.1.1.1.3.3" xref="S4.T4.2.2.2.2.2.m2.1.1.1.1.1.1.3.3.cmml">3</mn></mrow></mrow><mo id="S4.T4.2.2.2.2.2.m2.1.1.1.1.1.3" stretchy="false" xref="S4.T4.2.2.2.2.2.m2.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S4.T4.2.2.2.2.2.m2.1.1.1.2" xref="S4.T4.2.2.2.2.2.m2.1.1.1.2.cmml">÷</mo><mn id="S4.T4.2.2.2.2.2.m2.1.1.1.3" xref="S4.T4.2.2.2.2.2.m2.1.1.1.3.cmml">2</mn></mrow><mo id="S4.T4.2.2.2.2.2.m2.2.2.4" xref="S4.T4.2.2.2.2.2.m2.2.2.4.cmml">=</mo><mrow id="S4.T4.2.2.2.2.2.m2.2.2.2" xref="S4.T4.2.2.2.2.2.m2.2.2.2.cmml"><mrow id="S4.T4.2.2.2.2.2.m2.2.2.2.1.1" xref="S4.T4.2.2.2.2.2.m2.2.2.2.1.1.1.cmml"><mo id="S4.T4.2.2.2.2.2.m2.2.2.2.1.1.2" stretchy="false" xref="S4.T4.2.2.2.2.2.m2.2.2.2.1.1.1.cmml">(</mo><mrow id="S4.T4.2.2.2.2.2.m2.2.2.2.1.1.1" xref="S4.T4.2.2.2.2.2.m2.2.2.2.1.1.1.cmml"><mn id="S4.T4.2.2.2.2.2.m2.2.2.2.1.1.1.2" xref="S4.T4.2.2.2.2.2.m2.2.2.2.1.1.1.2.cmml">2000</mn><mo id="S4.T4.2.2.2.2.2.m2.2.2.2.1.1.1.1" xref="S4.T4.2.2.2.2.2.m2.2.2.2.1.1.1.1.cmml">−</mo><mn id="S4.T4.2.2.2.2.2.m2.2.2.2.1.1.1.3" xref="S4.T4.2.2.2.2.2.m2.2.2.2.1.1.1.3.cmml">1050</mn></mrow><mo id="S4.T4.2.2.2.2.2.m2.2.2.2.1.1.3" stretchy="false" xref="S4.T4.2.2.2.2.2.m2.2.2.2.1.1.1.cmml">)</mo></mrow><mo id="S4.T4.2.2.2.2.2.m2.2.2.2.2" xref="S4.T4.2.2.2.2.2.m2.2.2.2.2.cmml">÷</mo><mn id="S4.T4.2.2.2.2.2.m2.2.2.2.3" xref="S4.T4.2.2.2.2.2.m2.2.2.2.3.cmml">2</mn></mrow><mo id="S4.T4.2.2.2.2.2.m2.2.2.5" xref="S4.T4.2.2.2.2.2.m2.2.2.5.cmml">=</mo><mrow id="S4.T4.2.2.2.2.2.m2.2.2.6" xref="S4.T4.2.2.2.2.2.m2.2.2.6.cmml"><mn id="S4.T4.2.2.2.2.2.m2.2.2.6.2" xref="S4.T4.2.2.2.2.2.m2.2.2.6.2.cmml">950</mn><mo id="S4.T4.2.2.2.2.2.m2.2.2.6.1" xref="S4.T4.2.2.2.2.2.m2.2.2.6.1.cmml">÷</mo><mn id="S4.T4.2.2.2.2.2.m2.2.2.6.3" xref="S4.T4.2.2.2.2.2.m2.2.2.6.3.cmml">2</mn></mrow><mo id="S4.T4.2.2.2.2.2.m2.2.2.7" xref="S4.T4.2.2.2.2.2.m2.2.2.7.cmml">=</mo><mn id="S4.T4.2.2.2.2.2.m2.2.2.8" xref="S4.T4.2.2.2.2.2.m2.2.2.8.cmml">475</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T4.2.2.2.2.2.m2.2b"><apply id="S4.T4.2.2.2.2.2.m2.2.2.cmml" xref="S4.T4.2.2.2.2.2.m2.2.2"><and id="S4.T4.2.2.2.2.2.m2.2.2a.cmml" xref="S4.T4.2.2.2.2.2.m2.2.2"></and><apply id="S4.T4.2.2.2.2.2.m2.2.2b.cmml" xref="S4.T4.2.2.2.2.2.m2.2.2"><eq id="S4.T4.2.2.2.2.2.m2.2.2.4.cmml" xref="S4.T4.2.2.2.2.2.m2.2.2.4"></eq><apply id="S4.T4.2.2.2.2.2.m2.1.1.1.cmml" xref="S4.T4.2.2.2.2.2.m2.1.1.1"><divide id="S4.T4.2.2.2.2.2.m2.1.1.1.2.cmml" xref="S4.T4.2.2.2.2.2.m2.1.1.1.2"></divide><apply id="S4.T4.2.2.2.2.2.m2.1.1.1.1.1.1.cmml" xref="S4.T4.2.2.2.2.2.m2.1.1.1.1.1"><minus id="S4.T4.2.2.2.2.2.m2.1.1.1.1.1.1.1.cmml" xref="S4.T4.2.2.2.2.2.m2.1.1.1.1.1.1.1"></minus><cn id="S4.T4.2.2.2.2.2.m2.1.1.1.1.1.1.2.cmml" type="integer" xref="S4.T4.2.2.2.2.2.m2.1.1.1.1.1.1.2">2000</cn><apply id="S4.T4.2.2.2.2.2.m2.1.1.1.1.1.1.3.cmml" xref="S4.T4.2.2.2.2.2.m2.1.1.1.1.1.1.3"><times id="S4.T4.2.2.2.2.2.m2.1.1.1.1.1.1.3.1.cmml" xref="S4.T4.2.2.2.2.2.m2.1.1.1.1.1.1.3.1"></times><cn id="S4.T4.2.2.2.2.2.m2.1.1.1.1.1.1.3.2.cmml" type="integer" xref="S4.T4.2.2.2.2.2.m2.1.1.1.1.1.1.3.2">350</cn><cn id="S4.T4.2.2.2.2.2.m2.1.1.1.1.1.1.3.3.cmml" type="integer" xref="S4.T4.2.2.2.2.2.m2.1.1.1.1.1.1.3.3">3</cn></apply></apply><cn id="S4.T4.2.2.2.2.2.m2.1.1.1.3.cmml" type="integer" xref="S4.T4.2.2.2.2.2.m2.1.1.1.3">2</cn></apply><apply id="S4.T4.2.2.2.2.2.m2.2.2.2.cmml" xref="S4.T4.2.2.2.2.2.m2.2.2.2"><divide id="S4.T4.2.2.2.2.2.m2.2.2.2.2.cmml" xref="S4.T4.2.2.2.2.2.m2.2.2.2.2"></divide><apply id="S4.T4.2.2.2.2.2.m2.2.2.2.1.1.1.cmml" xref="S4.T4.2.2.2.2.2.m2.2.2.2.1.1"><minus id="S4.T4.2.2.2.2.2.m2.2.2.2.1.1.1.1.cmml" xref="S4.T4.2.2.2.2.2.m2.2.2.2.1.1.1.1"></minus><cn id="S4.T4.2.2.2.2.2.m2.2.2.2.1.1.1.2.cmml" type="integer" xref="S4.T4.2.2.2.2.2.m2.2.2.2.1.1.1.2">2000</cn><cn id="S4.T4.2.2.2.2.2.m2.2.2.2.1.1.1.3.cmml" type="integer" xref="S4.T4.2.2.2.2.2.m2.2.2.2.1.1.1.3">1050</cn></apply><cn id="S4.T4.2.2.2.2.2.m2.2.2.2.3.cmml" type="integer" xref="S4.T4.2.2.2.2.2.m2.2.2.2.3">2</cn></apply></apply><apply id="S4.T4.2.2.2.2.2.m2.2.2c.cmml" xref="S4.T4.2.2.2.2.2.m2.2.2"><eq id="S4.T4.2.2.2.2.2.m2.2.2.5.cmml" xref="S4.T4.2.2.2.2.2.m2.2.2.5"></eq><share href="https://arxiv.org/html/2410.03742v1#S4.T4.2.2.2.2.2.m2.2.2.2.cmml" id="S4.T4.2.2.2.2.2.m2.2.2d.cmml" xref="S4.T4.2.2.2.2.2.m2.2.2"></share><apply id="S4.T4.2.2.2.2.2.m2.2.2.6.cmml" xref="S4.T4.2.2.2.2.2.m2.2.2.6"><divide id="S4.T4.2.2.2.2.2.m2.2.2.6.1.cmml" xref="S4.T4.2.2.2.2.2.m2.2.2.6.1"></divide><cn id="S4.T4.2.2.2.2.2.m2.2.2.6.2.cmml" type="integer" xref="S4.T4.2.2.2.2.2.m2.2.2.6.2">950</cn><cn id="S4.T4.2.2.2.2.2.m2.2.2.6.3.cmml" type="integer" xref="S4.T4.2.2.2.2.2.m2.2.2.6.3">2</cn></apply></apply><apply id="S4.T4.2.2.2.2.2.m2.2.2e.cmml" xref="S4.T4.2.2.2.2.2.m2.2.2"><eq id="S4.T4.2.2.2.2.2.m2.2.2.7.cmml" xref="S4.T4.2.2.2.2.2.m2.2.2.7"></eq><share href="https://arxiv.org/html/2410.03742v1#S4.T4.2.2.2.2.2.m2.2.2.6.cmml" id="S4.T4.2.2.2.2.2.m2.2.2f.cmml" xref="S4.T4.2.2.2.2.2.m2.2.2"></share><cn id="S4.T4.2.2.2.2.2.m2.2.2.8.cmml" type="integer" xref="S4.T4.2.2.2.2.2.m2.2.2.8">475</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.2.2.2.2.2.m2.2c">(2000-350\times 3)\div 2=(2000-1050)\div 2=950\div 2=475</annotation><annotation encoding="application/x-llamapun" id="S4.T4.2.2.2.2.2.m2.2d">( 2000 - 350 × 3 ) ÷ 2 = ( 2000 - 1050 ) ÷ 2 = 950 ÷ 2 = 475</annotation></semantics></math> meters.
Answer: 475 meters for the last two days.</span>
</span></td>
<td class="ltx_td ltx_nopad_r ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="S4.T4.2.2.4">
<span class="ltx_inline-block ltx_align_top" id="S4.T4.2.2.4.1">
<span class="ltx_p" id="S4.T4.2.2.4.1.1" style="width:106.7pt;">The first answer is straightforward and accurate, taking into account the total distance that needs to be set up and the known information; the second answer offers a slightly simplified expression and the result is correct. 
<br class="ltx_break"/><span class="ltx_text ltx_font_bold ltx_font_italic" id="S4.T4.2.2.4.1.1.1" style="color:#0000FF;">Correctness: 2, Consistency: 1</span></span>
</span></td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="S4.T4.2.2.5">
<span class="ltx_inline-block ltx_align_top" id="S4.T4.2.2.5.1">
<span class="ltx_p" id="S4.T4.2.2.5.1.1" style="width:19.9pt;">Answer 2 
<br class="ltx_break ltx_centering"/>(<span class="ltx_text ltx_align_center" id="S4.T4.2.2.5.1.1.1" style="color:#00FF00;">correct</span>)</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T4.2.6">
<td class="ltx_td ltx_nopad_r ltx_align_right ltx_border_bb ltx_border_r ltx_border_t" id="S4.T4.2.6.1">
<span class="ltx_text" id="S4.T4.2.6.1.1">
<span class="ltx_inline-block ltx_transformed_outer" id="S4.T4.2.6.1.1.1" style="width:10.0pt;height:91.2pt;vertical-align:-43.1pt;"><span class="ltx_transformed_inner" style="width:91.1pt;transform:translate(-40.55pt,3.75pt) rotate(-90deg) ;">
<span class="ltx_p" id="S4.T4.2.6.1.1.1.1"><span class="ltx_text ltx_font_bold" id="S4.T4.2.6.1.1.1.1.1">Code (1)<span class="ltx_text ltx_phantom ltx_font_medium" id="S4.T4.2.6.1.1.1.1.1.1"><span style="visibility:hidden">XXXXXXX</span></span></span></span>
</span></span></span></td>
<td class="ltx_td ltx_nopad_r ltx_align_justify ltx_align_top ltx_border_bb ltx_border_r ltx_border_t" id="S4.T4.2.6.2">
<span class="ltx_inline-block ltx_align_top" id="S4.T4.2.6.2.1">
<span class="ltx_p" id="S4.T4.2.6.2.1.1" style="width:206.3pt;"><span class="ltx_text ltx_font_bold" id="S4.T4.2.6.2.1.1.1">Question:</span> Reverse the elements in an array and make each character in the elements lowercase. planet_arr = [‘Earth’, ‘Saturn’, ‘Mars’]; 
<br class="ltx_break"/><span class="ltx_text ltx_font_bold" id="S4.T4.2.6.2.1.1.2">Answer 1:</span> def reverse_array(arr):; return arr[::-1]; def lowercase_array(arr):; return [x.lower() for x in arr]; planet_arr = [‘Earth’, ‘Saturn’, ‘Mars’]; print(reverse_array(planet_arr));print(lowercase_array(planet_arr));
<br class="ltx_break"/><span class="ltx_text ltx_font_bold" id="S4.T4.2.6.2.1.1.3">Answer 2:</span> planet_arr = [‘Earth’, ‘Saturn’, ‘Mars’]; planet_arr.reverse(); planet_arr = [p.lower() for p in planet_arr]; print(planet_arr); This code will first reverse the order of the elements in the ‘planet_arr‘ array, and then lowercase each character in each element. The resulting array will be [‘mars’,‘saturn’,‘earth’].</span>
</span></td>
<td class="ltx_td ltx_nopad_r ltx_align_justify ltx_align_top ltx_border_bb ltx_border_r ltx_border_t" id="S4.T4.2.6.3">
<span class="ltx_inline-block ltx_align_top" id="S4.T4.2.6.3.1">
<span class="ltx_p" id="S4.T4.2.6.3.1.1" style="width:106.7pt;">The first answer provides a clearer step-by-step solution to the problem by achieving array reversal and lowercase conversion through independent functions, which makes the code more modular. The second answer is more concise and accurately meets the question’s requirements by first reversing the array and then converting it to lowercase. 
<br class="ltx_break"/><span class="ltx_text ltx_font_bold ltx_font_italic" id="S4.T4.2.6.3.1.1.1" style="color:#0000FF;">Correctness: 3, Consistency: 1</span></span>
</span></td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb ltx_border_t" id="S4.T4.2.6.4">
<span class="ltx_inline-block ltx_align_top" id="S4.T4.2.6.4.1">
<span class="ltx_p" id="S4.T4.2.6.4.1.1" style="width:19.9pt;">Answer 1 (<span class="ltx_text ltx_align_center" id="S4.T4.2.6.4.1.1.1" style="color:#FF0000;">incorrect</span>)</span>
</span>
</td>
</tr>
</table>
</figure>
<div class="ltx_para ltx_noindent" id="S4.SS5.p1">
<p class="ltx_p" id="S4.SS5.p1.1">We present example judgments generated by Con-J in Table <a class="ltx_ref" href="https://arxiv.org/html/2410.03742v1#S4.T4" title="Table 4 ‣ 4.5 Case Analysis of Con-J ‣ 4 Experiments ‣ Beyond Scalar Reward Model: Learning Generative Judge from Preference Data"><span class="ltx_text ltx_ref_tag">4</span></a>, covering three domains and illustrating both correct and incorrect preference predictions.
For that cases of Creation (1) and Math (1), there is high consistency between the rationale and the binary preference (the consistency scores are 3).
We observe that both the rationale and the preference prediction are correct in Creation (1) while incorrect Math (1).
Conversely, the consistency in the cases of Math (2) and Code (1) is relatively low.
In these cases, we find that the rationale does not reflect the most direct support for preference prediction.
For example, in the third example, the answers are compared based on their format, while the key difference is that one of the answers involves an incorrect calculation and is not involved in the rationales.
This indicates that even if the model can make a correct judgment, it may not necessarily be based on the correct rationale.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>related work</h2>
<div class="ltx_para ltx_noindent" id="S5.p1">
<p class="ltx_p" id="S5.p1.1"><span class="ltx_text ltx_font_bold" id="S5.p1.1.1">LLM alignment.</span>
The initial approach developed for aligning LLMs with human values was reinforcement learning from human feedback (RLHF) <cite class="ltx_cite ltx_citemacro_citep">(Christiano et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03742v1#bib.bib6" title="">2017</a>; Liu et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03742v1#bib.bib22" title="">2020</a>)</cite>.
This technique involves training a scalar reward model (RM) and then using reinforcement learning (RL) to optimize a policy according to the RM.
In recent years, a series of  <span class="ltx_glossaryref" title="direct alignment from preference"><span class="ltx_text ltx_glossary_long">direct alignment from preference</span></span> (<abbr class="ltx_glossaryref" title="direct alignment from preference"><span class="ltx_text ltx_glossary_short">DAP</span></abbr>) works, such as DPO <cite class="ltx_cite ltx_citemacro_citep">(Rafailov et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03742v1#bib.bib26" title="">2024</a>)</cite>, SiLC <cite class="ltx_cite ltx_citemacro_citep">(Zhao et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03742v1#bib.bib40" title="">2023</a>)</cite>, and IPO <cite class="ltx_cite ltx_citemacro_cite">Azar et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03742v1#bib.bib2" title="">2024</a>)</cite>, have gained popularity.
Unlike RLHF, DAP methods directly update the LLM using pairwise preference data, making the alignment simpler, and more stable.
To scale the preference datasets, it is common to train an external machine model from existing preference datasets (<cite class="ltx_cite ltx_citemacro_cite">Hou et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03742v1#bib.bib12" title="">2024</a>); Wu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03742v1#bib.bib32" title="">2024</a>)</cite>).
This online and scalable construction process enables DPO to be deployed in an iterative setting (<cite class="ltx_cite ltx_citemacro_cite">Xiong et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03742v1#bib.bib33" title="">2024</a>); Xu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03742v1#bib.bib34" title="">2023</a>)</cite>) or online setting (<cite class="ltx_cite ltx_citemacro_cite">Guo et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03742v1#bib.bib10" title="">2024</a>)</cite>).
Therefore, how to build an accurate external model for preference judgment is an important problem.</p>
</div>
<div class="ltx_para ltx_noindent" id="S5.p2">
<p class="ltx_p" id="S5.p2.1"><span class="ltx_text ltx_font_bold" id="S5.p2.1.1">LLM-as-a-judge.</span>
Instead of training a scalar model for preference judgment, employing LLMs as a generative judge has been a promising alternative <cite class="ltx_cite ltx_citemacro_citep">(Zheng et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03742v1#bib.bib41" title="">2023</a>; Ye et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03742v1#bib.bib36" title="">2023</a>)</cite>.
Efforts have been made to train language models specialized in evaluations.
For example, <cite class="ltx_cite ltx_citemacro_citet">Li et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03742v1#bib.bib21" title="">2023</a>); Kim et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03742v1#bib.bib16" title="">2024</a>)</cite> proposes constructing an instruction-tuning dataset by prompting GPT-4 and using supervised fine-tuning (SFT) to train a pre-trained LLM as a generative judge.
<cite class="ltx_cite ltx_citemacro_citet">Zhang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03742v1#bib.bib39" title="">2024</a>)</cite> propose training the LLM by minimizing the SFT loss with a single “Yes” or “No”, along with a rationale generated either by prompting Gemini 1.0 Pro or through algorithmic construction.
Our contribution to the existing research is that Con-J uses self-sampled contrastive judgments under the supervision of preference data, allowing for more efficient data construction while achieving better performance.</p>
</div>
</section>
<section class="ltx_section" id="S6">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Discussions and Conclusions</h2>
<div class="ltx_para ltx_noindent" id="S6.p1">
<p class="ltx_p" id="S6.p1.1">We introduced Con-J, a novel approach that trains a generative judge by self-bootstrapped learning from preference data.
Con-J addresses the limitations of scalar reward models, including lack of interpretability and susceptibility to dataset bias.
Our experiments on commercial datasets across Text Creation, Math, and Code domains, as well as publicly available benchmarks, demonstrate the effectiveness of Con-J.
Moreover, we show that the correctness of the rationales generated by Con-J improves during learning from preference data.
This enables Con-J not only to make accurate judgments but also to provide reasonable explanations, potentially facilitating human-in-the-loop supervision of LLM alignment.
Finally, we found that Con-J is less susceptible to biases in datasets compared to its variants without rationales and the scalar models.</p>
</div>
<div class="ltx_para ltx_noindent" id="S6.p2">
<p class="ltx_p" id="S6.p2.1">As AI systems become more powerful, many suggest that they will reach the point at which human are unable to easily and reliably assess the quality of their outputs <cite class="ltx_cite ltx_citemacro_citep">(Casper et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03742v1#bib.bib4" title="">2023</a>)</cite>.
To address this issue, using another AI to supervise itself is a viable solution; however, researchers suggest that these methods may fail without human involvement <cite class="ltx_cite ltx_citemacro_citep">(Shumailov et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03742v1#bib.bib30" title="">2024</a>)</cite>.
This paper contributes to addressing this issue in two ways.
On the one hand, Con-J can be used to supervise LLMs by acting as a judge.
At the same time, Con-J produces an explanation of its output that is legible to humans or another trusted system.
This indicates that we can spot any possible errors made by Con-J.
On the other hand, the training and construction of Con-J rely solely on preference data, which is easier to acquire from human annotators than high-quality instruction tunning data.
Furthermore, in many cases humans often find it difficult to provide verbal reasons for their preference, the training of Con-J could be integrated with human preference annotations, thereby enhancing the transparency of the entire annotation process.</p>
</div>
<div class="ltx_para ltx_noindent" id="S6.p3">
<p class="ltx_p" id="S6.p3.1">Several limitations of this work guide future directions including:
(i) We demonstrate that preference learning can enhance the model’s ability to generate correct rationales.
Another unresolved and intriguing question is whether enhancing the quality of rationales during the sampling process could also improve the model’s preference prediction abilities.
It is an important problem to enhance the model’s ability not only to make accurate preference predictions but also to base those judgments on correct reasoning.
(ii) We demonstrated that Con-J can more effectively resist bias than SM in an adversarial experiment.
However, further analysis is needed to understand why Con-J outperforms SM on complex, realistic datasets, and whether this is also related to bias.
(iii) We suggest that Con-j can potentially facilitate human collaboration through interpretable preference judgments for LLM training.
The design of such a pipeline is another interesting and valuable direction.</p>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ankner et al. (2024)</span>
<span class="ltx_bibblock">
Zachary Ankner, Mansheej Paul, Brandon Cui, Jonathan D Chang, and Prithviraj
Ammanabrolu.

</span>
<span class="ltx_bibblock">Critique-out-loud reward models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib1.1.1">arXiv preprint arXiv:2408.11791</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Azar et al. (2024)</span>
<span class="ltx_bibblock">
Mohammad Gheshlaghi Azar, Zhaohan Daniel Guo, Bilal Piot, Remi Munos, Mark
Rowland, Michal Valko, and Daniele Calandriello.

</span>
<span class="ltx_bibblock">A general theoretical paradigm to understand learning from human
preferences.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib2.1.1">International Conference on Artificial Intelligence and
Statistics</em>, pp.  4447–4455. PMLR, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bai et al. (2022)</span>
<span class="ltx_bibblock">
Yuntao Bai, Andy Jones, Kamal Ndousse, Amanda Askell, Anna Chen, Nova DasSarma,
Dawn Drain, Stanislav Fort, Deep Ganguli, Tom Henighan, et al.

</span>
<span class="ltx_bibblock">Training a helpful and harmless assistant with reinforcement learning
from human feedback.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib3.1.1">arXiv preprint arXiv:2204.05862</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Casper et al. (2023)</span>
<span class="ltx_bibblock">
Stephen Casper, Xander Davies, Claudia Shi, Thomas Krendl Gilbert,
Jérémy Scheurer, Javier Rando, Rachel Freedman, Tomasz Korbak, David
Lindner, Pedro Freire, et al.

</span>
<span class="ltx_bibblock">Open problems and fundamental limitations of reinforcement learning
from human feedback.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib4.1.1">arXiv preprint arXiv:2307.15217</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al. (2016)</span>
<span class="ltx_bibblock">
Tianqi Chen, Bing Xu, Chiyuan Zhang, and Carlos Guestrin.

</span>
<span class="ltx_bibblock">Training deep nets with sublinear memory cost.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib5.1.1">arXiv preprint arXiv:1604.06174</em>, 2016.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Christiano et al. (2017)</span>
<span class="ltx_bibblock">
Paul F Christiano, Jan Leike, Tom Brown, Miljan Martic, Shane Legg, and Dario
Amodei.

</span>
<span class="ltx_bibblock">Deep reinforcement learning from human preferences.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib6.1.1">Advances in neural information processing systems</em>, 30, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cui et al. (2023)</span>
<span class="ltx_bibblock">
Ganqu Cui, Lifan Yuan, Ning Ding, Guanming Yao, Wei Zhu, Yuan Ni, Guotong Xie,
Zhiyuan Liu, and Maosong Sun.

</span>
<span class="ltx_bibblock">Ultrafeedback: Boosting language models with high-quality feedback.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib7.1.1">arXiv preprint arXiv:2310.01377</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dao et al. (2022)</span>
<span class="ltx_bibblock">
Tri Dao, Dan Fu, Stefano Ermon, Atri Rudra, and Christopher Ré.

</span>
<span class="ltx_bibblock">Flashattention: Fast and memory-efficient exact attention with
io-awareness.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib8.1.1">Advances in Neural Information Processing Systems</em>,
35:16344–16359, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Erhan et al. (2009)</span>
<span class="ltx_bibblock">
Dumitru Erhan, Pierre-Antoine Manzagol, Yoshua Bengio, Samy Bengio, and Pascal
Vincent.

</span>
<span class="ltx_bibblock">The difficulty of training deep architectures and the effect of
unsupervised pre-training.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib9.1.1">Artificial intelligence and statistics</em>, pp.  153–160.
PMLR, 2009.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Guo et al. (2024)</span>
<span class="ltx_bibblock">
Shangmin Guo, Biao Zhang, Tianlin Liu, Tianqi Liu, Misha Khalman, Felipe
Llinares, Alexandre Rame, Thomas Mesnard, Yao Zhao, Bilal Piot, Johan Ferret,
and Mathieu Blondel.

</span>
<span class="ltx_bibblock">Direct language model alignment from online ai feedback, 2024.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2402.04792" title="">https://arxiv.org/abs/2402.04792</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hong et al. (2024)</span>
<span class="ltx_bibblock">
Jiwoo Hong, Noah Lee, and James Thorne.

</span>
<span class="ltx_bibblock">Orpo: Monolithic preference optimization without reference model.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib11.1.1">arXiv preprint arXiv:2403.07691</em>, 2(4):5,
2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hou et al. (2024)</span>
<span class="ltx_bibblock">
Zhenyu Hou, Yiin Niu, Zhengxiao Du, Xiaohan Zhang, Xiao Liu, Aohan Zeng, Qinkai
Zheng, Minlie Huang, Hongning Wang, Jie Tang, et al.

</span>
<span class="ltx_bibblock">Chatglm-rlhf: Practices of aligning large language models with human
feedback.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib12.1.1">arXiv preprint arXiv:2404.00934</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Huang et al. (2024)</span>
<span class="ltx_bibblock">
Hui Huang, Yingqi Qu, Jing Liu, Muyun Yang, and Tiejun Zhao.

</span>
<span class="ltx_bibblock">An empirical study of llm-as-a-judge for llm evaluation: Fine-tuned
judge models are task-specific classifiers.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib13.1.1">arXiv preprint arXiv:2403.02839</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ji et al. (2024)</span>
<span class="ltx_bibblock">
Jiaming Ji, Donghai Hong, Borong Zhang, Boyuan Chen, Josef Dai, Boren Zheng,
Tianyi Qiu, Boxun Li, and Yaodong Yang.

</span>
<span class="ltx_bibblock">Pku-saferlhf: A safety alignment preference dataset for llama family
models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib14.1.1">arXiv preprint arXiv:2406.15513</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jiang et al. (2023)</span>
<span class="ltx_bibblock">
Dongfu Jiang, Xiang Ren, and Bill Yuchen Lin.

</span>
<span class="ltx_bibblock">Llm-blender: Ensembling large language models with pairwise ranking
and generative fusion.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib15.1.1">arXiv preprint arXiv:2306.02561</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kim et al. (2024)</span>
<span class="ltx_bibblock">
Seungone Kim, Juyoung Suk, Shayne Longpre, Bill Yuchen Lin, Jamin Shin, Sean
Welleck, Graham Neubig, Moontae Lee, Kyungjae Lee, and Minjoon Seo.

</span>
<span class="ltx_bibblock">Prometheus 2: An open source language model specialized in evaluating
other language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib16.1.1">arXiv preprint arXiv:2405.01535</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kwon et al. (2023)</span>
<span class="ltx_bibblock">
Woosuk Kwon, Zhuohan Li, Siyuan Zhuang, Ying Sheng, Lianmin Zheng, Cody Hao Yu,
Joseph E. Gonzalez, Hao Zhang, and Ion Stoica.

</span>
<span class="ltx_bibblock">Efficient memory management for large language model serving with
pagedattention.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib17.1.1">Proceedings of the ACM SIGOPS 29th Symposium on Operating
Systems Principles</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lambert et al. (2024)</span>
<span class="ltx_bibblock">
Nathan Lambert, Valentina Pyatkin, Jacob Morrison, LJ Miranda, Bill Yuchen Lin,
Khyathi Chandu, Nouha Dziri, Sachin Kumar, Tom Zick, Yejin Choi, et al.

</span>
<span class="ltx_bibblock">Rewardbench: Evaluating reward models for language modeling.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib18.1.1">arXiv preprint arXiv:2403.13787</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lee et al. (2024)</span>
<span class="ltx_bibblock">
Gyeong-Geon Lee, Ehsan Latif, Xuansheng Wu, Ninghao Liu, and Xiaoming Zhai.

</span>
<span class="ltx_bibblock">Applying large language models and chain-of-thought for automatic
scoring.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib19.1.1">Computers and Education: Artificial Intelligence</em>, 6:100213, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lee et al. (2023)</span>
<span class="ltx_bibblock">
Harrison Lee, Samrat Phatale, Hassan Mansoor, Thomas Mesnard, Johan Ferret,
Kellie Lu, Colton Bishop, Ethan Hall, Victor Carbune, Abhinav Rastogi, et al.

</span>
<span class="ltx_bibblock">Rlaif: Scaling reinforcement learning from human feedback with ai
feedback.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib20.1.1">arXiv preprint arXiv:2309.00267</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2023)</span>
<span class="ltx_bibblock">
Junlong Li, Shichao Sun, Weizhe Yuan, Run-Ze Fan, Hai Zhao, and Pengfei Liu.

</span>
<span class="ltx_bibblock">Generative judge for evaluating alignment.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib21.1.1">arXiv preprint arXiv:2310.05470</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al. (2020)</span>
<span class="ltx_bibblock">
Fei Liu et al.

</span>
<span class="ltx_bibblock">Learning to summarize from human feedback.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib22.1.1">Proceedings of the 58th Annual Meeting of the Association
for Computational Linguistics</em>, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al. (2024)</span>
<span class="ltx_bibblock">
Zhihan Liu, Miao Lu, Shenao Zhang, Boyi Liu, Hongyi Guo, Yingxiang Yang, Jose
Blanchet, and Zhaoran Wang.

</span>
<span class="ltx_bibblock">Provably mitigating overoptimization in rlhf: Your sft loss is
implicitly an adversarial regularizer.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib23.1.1">arXiv preprint arXiv:2405.16436</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Pal et al. (2024)</span>
<span class="ltx_bibblock">
Arka Pal, Deep Karkhanis, Samuel Dooley, Manley Roberts, Siddartha Naidu, and
Colin White.

</span>
<span class="ltx_bibblock">Smaug: Fixing failure modes of preference optimisation with
dpo-positive.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib24.1.1">arXiv preprint arXiv:2402.13228</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Park et al. (2024)</span>
<span class="ltx_bibblock">
Junsoo Park, Seungyeon Jwa, Meiying Ren, Daeyoung Kim, and Sanghyuk Choi.

</span>
<span class="ltx_bibblock">Offsetbias: Leveraging debiased data for tuning evaluators.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib25.1.1">arXiv preprint arXiv:2407.06551</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rafailov et al. (2024)</span>
<span class="ltx_bibblock">
Rafael Rafailov, Archit Sharma, Eric Mitchell, Christopher D Manning, Stefano
Ermon, and Chelsea Finn.

</span>
<span class="ltx_bibblock">Direct preference optimization: Your language model is secretly a
reward model.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib26.1.1">Advances in Neural Information Processing Systems</em>, 36, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rajbhandari et al. (2020)</span>
<span class="ltx_bibblock">
Samyam Rajbhandari, Jeff Rasley, Olatunji Ruwase, and Yuxiong He.

</span>
<span class="ltx_bibblock">Zero: Memory optimizations toward training trillion parameter models.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib27.1.1">SC20: International Conference for High Performance
Computing, Networking, Storage and Analysis</em>, pp.  1–16. IEEE, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rasley et al. (2020)</span>
<span class="ltx_bibblock">
Jeff Rasley, Samyam Rajbhandari, Olatunji Ruwase, and Yuxiong He.

</span>
<span class="ltx_bibblock">Deepspeed: System optimizations enable training deep learning models
with over 100 billion parameters.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib28.1.1">Proceedings of the 26th ACM SIGKDD International Conference
on Knowledge Discovery &amp; Data Mining</em>, pp.  3505–3506, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shen et al. (2023)</span>
<span class="ltx_bibblock">
Wei Shen, Rui Zheng, Wenyu Zhan, Jun Zhao, Shihan Dou, Tao Gui, Qi Zhang, and
Xuanjing Huang.

</span>
<span class="ltx_bibblock">Loose lips sink ships: Mitigating length bias in reinforcement
learning from human feedback.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib29.1.1">arXiv preprint arXiv:2310.05199</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shumailov et al. (2024)</span>
<span class="ltx_bibblock">
Ilia Shumailov, Zakhar Shumaylov, Yiren Zhao, Nicolas Papernot, Ross Anderson,
and Yarin Gal.

</span>
<span class="ltx_bibblock">Ai models collapse when trained on recursively generated data.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib30.1.1">Nature</em>, 631(8022):755–759, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Singhal et al. (2023)</span>
<span class="ltx_bibblock">
Prasann Singhal, Tanya Goyal, Jiacheng Xu, and Greg Durrett.

</span>
<span class="ltx_bibblock">A long way to go: Investigating length correlations in rlhf.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib31.1.1">arXiv preprint arXiv:2310.03716</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wu et al. (2024)</span>
<span class="ltx_bibblock">
Tianhao Wu, Weizhe Yuan, Olga Golovneva, Jing Xu, Yuandong Tian, Jiantao Jiao,
Jason Weston, and Sainbayar Sukhbaatar.

</span>
<span class="ltx_bibblock">Meta-rewarding language models: Self-improving alignment with
llm-as-a-meta-judge.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib32.1.1">arXiv preprint arXiv:2407.19594</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xiong et al. (2024)</span>
<span class="ltx_bibblock">
Wei Xiong, Hanze Dong, Chenlu Ye, Ziqi Wang, Han Zhong, Heng Ji, Nan Jiang, and
Tong Zhang.

</span>
<span class="ltx_bibblock">Iterative preference learning from human feedback: Bridging theory
and practice for rlhf under kl-constraint.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib33.1.1">Forty-first International Conference on Machine Learning</em>,
2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xu et al. (2023)</span>
<span class="ltx_bibblock">
Jing Xu, Andrew Lee, Sainbayar Sukhbaatar, and Jason Weston.

</span>
<span class="ltx_bibblock">Some things are more cringe than others: Preference optimization with
the pairwise cringe loss.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib34.1.1">arXiv preprint arXiv:2312.16682</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yang et al. (2024)</span>
<span class="ltx_bibblock">
An Yang, Baosong Yang, Binyuan Hui, Bo Zheng, Bowen Yu, Chang Zhou, Chengpeng
Li, Chengyuan Li, Dayiheng Liu, Fei Huang, et al.

</span>
<span class="ltx_bibblock">Qwen2 technical report.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib35.1.1">arXiv preprint arXiv:2407.10671</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ye et al. (2023)</span>
<span class="ltx_bibblock">
Seonghyeon Ye, Doyoung Kim, Sungdong Kim, Hyeonbin Hwang, Seungone Kim, Yongrae
Jo, James Thorne, Juho Kim, and Minjoon Seo.

</span>
<span class="ltx_bibblock">Flask: Fine-grained language model evaluation based on alignment
skill sets.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib36.1.1">arXiv preprint arXiv:2307.10928</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ye et al. (2024)</span>
<span class="ltx_bibblock">
Zihuiwen Ye, Fraser Greenlee-Scott, Max Bartolo, Phil Blunsom, Jon Ander
Campos, and Matthias Gallé.

</span>
<span class="ltx_bibblock">Improving reward models with synthetic critiques.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib37.1.1">arXiv preprint arXiv:2405.20850</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zelikman et al. (2022)</span>
<span class="ltx_bibblock">
Eric Zelikman, Yuhuai Wu, and Noah D Goodman.

</span>
<span class="ltx_bibblock">Star: Self-taught reasoner.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib38.1.1">arXiv preprint arXiv:2203.14465</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib39">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al. (2024)</span>
<span class="ltx_bibblock">
Lunjun Zhang, Arian Hosseini, Hritik Bansal, Mehran Kazemi, Aviral Kumar, and
Rishabh Agarwal.

</span>
<span class="ltx_bibblock">Generative verifiers: Reward modeling as next-token prediction.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib39.1.1">arXiv preprint arXiv:2408.15240</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib40">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhao et al. (2023)</span>
<span class="ltx_bibblock">
Yao Zhao, Rishabh Joshi, Tianqi Liu, Misha Khalman, Mohammad Saleh, and Peter J
Liu.

</span>
<span class="ltx_bibblock">Slic-hf: Sequence likelihood calibration with human feedback.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib40.1.1">arXiv preprint arXiv:2305.10425</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib41">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zheng et al. (2023)</span>
<span class="ltx_bibblock">
Lianmin Zheng, Wei-Lin Chiang, Ying Sheng, Siyuan Zhuang, Zhanghao Wu, Yonghao
Zhuang, Zi Lin, Zhuohan Li, Dacheng Li, Eric Xing, et al.

</span>
<span class="ltx_bibblock">Judging llm-as-a-judge with mt-bench and chatbot arena.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib41.1.1">Advances in Neural Information Processing Systems</em>,
36:46595–46623, 2023.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<section class="ltx_appendix" id="A1">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Appendix</h2>
<figure class="ltx_table" id="A1.T5">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 5: </span>An example of a prompt fed to the LLM to generate preference reward judgments, consisting of a preamble (introduction and instructions describing the task), a question, and a pair of candidate answers. The preamble is neutral and does not indicate which answer is better. </figcaption>
<table class="ltx_tabular ltx_centering ltx_align_middle" id="A1.T5.1">
<tr class="ltx_tr" id="A1.T5.1.1">
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_l ltx_border_r ltx_border_tt" id="A1.T5.1.1.1">
<span class="ltx_inline-block ltx_align_top" id="A1.T5.1.1.1.1">
<span class="ltx_p" id="A1.T5.1.1.1.1.1" style="width:56.9pt;">Preamble</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_tt" id="A1.T5.1.1.2">
<span class="ltx_inline-block ltx_align_top" id="A1.T5.1.1.2.1">
<span class="ltx_p" id="A1.T5.1.1.2.1.1" style="width:313.0pt;">As an evaluation expert, given a question and its two possible answers, please choose which answer best aligns with coherence, accuracy, coverage, and overall quality. Output your judgment in JSON format, where ”rationale” is your explanation, and ”better_answer” is an integer type of 1 or 2, for example, {“rationale”: “your explanation”, “better_answer”: 1}. Below are the question and its candidate answers:</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A1.T5.1.2">
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_l ltx_border_r ltx_border_t" id="A1.T5.1.2.1">
<span class="ltx_inline-block ltx_align_top" id="A1.T5.1.2.1.1">
<span class="ltx_p" id="A1.T5.1.2.1.1.1" style="width:56.9pt;">Question</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="A1.T5.1.2.2">
<span class="ltx_inline-block ltx_align_top" id="A1.T5.1.2.2.1">
<span class="ltx_p" id="A1.T5.1.2.2.1.1" style="width:313.0pt;">The volume of a rectangular prism is 96 cubic decimeters, and the base area is 16 square decimeters. What is its height in decimeters?</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A1.T5.1.3">
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_l ltx_border_r ltx_border_t" id="A1.T5.1.3.1">
<span class="ltx_inline-block ltx_align_top" id="A1.T5.1.3.1.1">
<span class="ltx_p" id="A1.T5.1.3.1.1.1" style="width:56.9pt;">Answer 1</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="A1.T5.1.3.2">
<span class="ltx_inline-block ltx_align_top" id="A1.T5.1.3.2.1">
<span class="ltx_p" id="A1.T5.1.3.2.1.1" style="width:313.0pt;">We can use the following formula to calculate the height h of the rectangular prism: V = S \times h. Substitute the known values into the formula: 96 = 16 \times h; h = 6. Therefore, the height of the rectangular prism is 6 decimeters.</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A1.T5.1.4">
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_l ltx_border_r ltx_border_t" id="A1.T5.1.4.1">
<span class="ltx_inline-block ltx_align_top" id="A1.T5.1.4.1.1">
<span class="ltx_p" id="A1.T5.1.4.1.1.1" style="width:56.9pt;">Answer 2</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="A1.T5.1.4.2">
<span class="ltx_inline-block ltx_align_top" id="A1.T5.1.4.2.1">
<span class="ltx_p" id="A1.T5.1.4.2.1.1" style="width:313.0pt;">5. Height = Volume / Base Area = 96 / 16 = 5 decimeters.</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A1.T5.1.5">
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb ltx_border_l ltx_border_r ltx_border_t" id="A1.T5.1.5.1">
<span class="ltx_inline-block ltx_align_top" id="A1.T5.1.5.1.1">
<span class="ltx_p" id="A1.T5.1.5.1.1.1" style="width:56.9pt;">Prompt</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb ltx_border_r ltx_border_t" id="A1.T5.1.5.2">
<span class="ltx_inline-block ltx_align_top" id="A1.T5.1.5.2.1">
<span class="ltx_p" id="A1.T5.1.5.2.1.1" style="width:313.0pt;"><span class="ltx_text ltx_font_italic" id="A1.T5.1.5.2.1.1.1">As an evaluation expert, given a question and its two possible answers, please choose which answer best aligns with coherence, accuracy, coverage, and overall quality. Output your judgment in JSON format, where ”rationale” is your explanation, and ”better_answer” is an integer type of 1 or 2, for example, </span>{<span class="ltx_text ltx_font_italic" id="A1.T5.1.5.2.1.1.2">“rationale”: “your explanation”, “better_answer”: 1</span>}<span class="ltx_text ltx_font_italic" id="A1.T5.1.5.2.1.1.3">. Below are the question and its candidate answers:

<br class="ltx_break"/><span class="ltx_text ltx_font_bold" id="A1.T5.1.5.2.1.1.3.1">Question:</span></span> The volume of a rectangular prism is 96 cubic decimeters, and the base area is 16 square decimeters. What is its height in decimeters?

<br class="ltx_break"/><span class="ltx_text ltx_font_bold ltx_font_italic" id="A1.T5.1.5.2.1.1.4">Answer 1:</span> We can use the following formula to calculate the height h of the rectangular prism: V = S \times h. Substitute the known values into the formula: 96 = 16 \times h; h = 6. Therefore, the height of the rectangular prism is 6 decimeters.

<br class="ltx_break"/><span class="ltx_text ltx_font_bold ltx_font_italic" id="A1.T5.1.5.2.1.1.5">Answer 2:</span> 5. Height = Volume / Base Area = 96 / 16 = 5 decimeters.</span>
</span>
</td>
</tr>
</table>
</figure>
<div class="ltx_pagination ltx_role_newpage"></div>
<figure class="ltx_table" id="A1.T6">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 6: </span>Prompt template with preamble using correct or incorrect hints, where <math alttext="\alpha,\beta" class="ltx_Math" display="inline" id="A1.T6.4.m1.2"><semantics id="A1.T6.4.m1.2b"><mrow id="A1.T6.4.m1.2.3.2" xref="A1.T6.4.m1.2.3.1.cmml"><mi id="A1.T6.4.m1.1.1" xref="A1.T6.4.m1.1.1.cmml">α</mi><mo id="A1.T6.4.m1.2.3.2.1" xref="A1.T6.4.m1.2.3.1.cmml">,</mo><mi id="A1.T6.4.m1.2.2" xref="A1.T6.4.m1.2.2.cmml">β</mi></mrow><annotation-xml encoding="MathML-Content" id="A1.T6.4.m1.2c"><list id="A1.T6.4.m1.2.3.1.cmml" xref="A1.T6.4.m1.2.3.2"><ci id="A1.T6.4.m1.1.1.cmml" xref="A1.T6.4.m1.1.1">𝛼</ci><ci id="A1.T6.4.m1.2.2.cmml" xref="A1.T6.4.m1.2.2">𝛽</ci></list></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.4.m1.2d">\alpha,\beta</annotation><annotation encoding="application/x-llamapun" id="A1.T6.4.m1.2e">italic_α , italic_β</annotation></semantics></math> are the ID of correct and incorrect answers, respectively, <math alttext="\{\alpha,\beta\}=\{1,2\}" class="ltx_Math" display="inline" id="A1.T6.5.m2.4"><semantics id="A1.T6.5.m2.4b"><mrow id="A1.T6.5.m2.4.5" xref="A1.T6.5.m2.4.5.cmml"><mrow id="A1.T6.5.m2.4.5.2.2" xref="A1.T6.5.m2.4.5.2.1.cmml"><mo id="A1.T6.5.m2.4.5.2.2.1" stretchy="false" xref="A1.T6.5.m2.4.5.2.1.cmml">{</mo><mi id="A1.T6.5.m2.1.1" xref="A1.T6.5.m2.1.1.cmml">α</mi><mo id="A1.T6.5.m2.4.5.2.2.2" xref="A1.T6.5.m2.4.5.2.1.cmml">,</mo><mi id="A1.T6.5.m2.2.2" xref="A1.T6.5.m2.2.2.cmml">β</mi><mo id="A1.T6.5.m2.4.5.2.2.3" stretchy="false" xref="A1.T6.5.m2.4.5.2.1.cmml">}</mo></mrow><mo id="A1.T6.5.m2.4.5.1" xref="A1.T6.5.m2.4.5.1.cmml">=</mo><mrow id="A1.T6.5.m2.4.5.3.2" xref="A1.T6.5.m2.4.5.3.1.cmml"><mo id="A1.T6.5.m2.4.5.3.2.1" stretchy="false" xref="A1.T6.5.m2.4.5.3.1.cmml">{</mo><mn id="A1.T6.5.m2.3.3" xref="A1.T6.5.m2.3.3.cmml">1</mn><mo id="A1.T6.5.m2.4.5.3.2.2" xref="A1.T6.5.m2.4.5.3.1.cmml">,</mo><mn id="A1.T6.5.m2.4.4" xref="A1.T6.5.m2.4.4.cmml">2</mn><mo id="A1.T6.5.m2.4.5.3.2.3" stretchy="false" xref="A1.T6.5.m2.4.5.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.T6.5.m2.4c"><apply id="A1.T6.5.m2.4.5.cmml" xref="A1.T6.5.m2.4.5"><eq id="A1.T6.5.m2.4.5.1.cmml" xref="A1.T6.5.m2.4.5.1"></eq><set id="A1.T6.5.m2.4.5.2.1.cmml" xref="A1.T6.5.m2.4.5.2.2"><ci id="A1.T6.5.m2.1.1.cmml" xref="A1.T6.5.m2.1.1">𝛼</ci><ci id="A1.T6.5.m2.2.2.cmml" xref="A1.T6.5.m2.2.2">𝛽</ci></set><set id="A1.T6.5.m2.4.5.3.1.cmml" xref="A1.T6.5.m2.4.5.3.2"><cn id="A1.T6.5.m2.3.3.cmml" type="integer" xref="A1.T6.5.m2.3.3">1</cn><cn id="A1.T6.5.m2.4.4.cmml" type="integer" xref="A1.T6.5.m2.4.4">2</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.5.m2.4d">\{\alpha,\beta\}=\{1,2\}</annotation><annotation encoding="application/x-llamapun" id="A1.T6.5.m2.4e">{ italic_α , italic_β } = { 1 , 2 }</annotation></semantics></math>, {{Question}}, {{Answer 1}}, {{Answer 2}} are the text content of the question, answer 1, and answer 2, respectively. When the LLM does not output a valid JSON format as expected (e.g., “rationale”: “your explanation”, “better_answer”: <math alttext="\alpha" class="ltx_Math" display="inline" id="A1.T6.6.m3.1"><semantics id="A1.T6.6.m3.1b"><mi id="A1.T6.6.m3.1.1" xref="A1.T6.6.m3.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="A1.T6.6.m3.1c"><ci id="A1.T6.6.m3.1.1.cmml" xref="A1.T6.6.m3.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.6.m3.1d">\alpha</annotation><annotation encoding="application/x-llamapun" id="A1.T6.6.m3.1e">italic_α</annotation></semantics></math>), we use an alternative prompt (rows 3-4) to prompt it again and insert its output as the rationale into the template. </figcaption>
<table class="ltx_tabular ltx_centering ltx_align_middle" id="A1.T6.18.12">
<tr class="ltx_tr" id="A1.T6.10.4.4">
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_l ltx_border_r ltx_border_tt" id="A1.T6.10.4.4.5">
<span class="ltx_inline-block ltx_align_top" id="A1.T6.10.4.4.5.1">
<span class="ltx_p" id="A1.T6.10.4.4.5.1.1" style="width:56.9pt;">Prompt with preamble_correct</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_tt" id="A1.T6.10.4.4.4">
<span class="ltx_inline-block ltx_align_top" id="A1.T6.10.4.4.4.4">
<span class="ltx_p" id="A1.T6.10.4.4.4.4.4" style="width:313.0pt;"><span class="ltx_text ltx_font_italic" id="A1.T6.10.4.4.4.4.4.5">As an evaluation expert, given a question and its two possible answers, please choose which answer best aligns with coherence, accuracy, coverage, and overall quality. Below are the question and its candidate answers:

<br class="ltx_break"/><span class="ltx_text ltx_font_bold" id="A1.T6.10.4.4.4.4.4.5.1">Question:</span></span> {{Question}}

<br class="ltx_break"/><span class="ltx_text ltx_font_bold ltx_font_italic" id="A1.T6.10.4.4.4.4.4.6">Answer 1:</span> {{Answer 1}}

<br class="ltx_break"/><span class="ltx_text ltx_font_bold ltx_font_italic" id="A1.T6.10.4.4.4.4.4.7">Answer 2:</span> {{Answer 2}}

<br class="ltx_break"/><span class="ltx_text ltx_font_italic" id="A1.T6.9.3.3.3.3.3.3">Given that answer <math alttext="\alpha" class="ltx_Math" display="inline" id="A1.T6.7.1.1.1.1.1.1.m1.1"><semantics id="A1.T6.7.1.1.1.1.1.1.m1.1a"><mi id="A1.T6.7.1.1.1.1.1.1.m1.1.1" xref="A1.T6.7.1.1.1.1.1.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="A1.T6.7.1.1.1.1.1.1.m1.1b"><ci id="A1.T6.7.1.1.1.1.1.1.m1.1.1.cmml" xref="A1.T6.7.1.1.1.1.1.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.7.1.1.1.1.1.1.m1.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="A1.T6.7.1.1.1.1.1.1.m1.1d">italic_α</annotation></semantics></math> is better than answer <math alttext="\beta" class="ltx_Math" display="inline" id="A1.T6.8.2.2.2.2.2.2.m2.1"><semantics id="A1.T6.8.2.2.2.2.2.2.m2.1a"><mi id="A1.T6.8.2.2.2.2.2.2.m2.1.1" xref="A1.T6.8.2.2.2.2.2.2.m2.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="A1.T6.8.2.2.2.2.2.2.m2.1b"><ci id="A1.T6.8.2.2.2.2.2.2.m2.1.1.cmml" xref="A1.T6.8.2.2.2.2.2.2.m2.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.8.2.2.2.2.2.2.m2.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="A1.T6.8.2.2.2.2.2.2.m2.1d">italic_β</annotation></semantics></math>, please provide the rationale. Output your judgment in JSON format, where ”rationale” is your explanation, and ”better_answer” is an integer type of <math alttext="\alpha" class="ltx_Math" display="inline" id="A1.T6.9.3.3.3.3.3.3.m3.1"><semantics id="A1.T6.9.3.3.3.3.3.3.m3.1a"><mi id="A1.T6.9.3.3.3.3.3.3.m3.1.1" xref="A1.T6.9.3.3.3.3.3.3.m3.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="A1.T6.9.3.3.3.3.3.3.m3.1b"><ci id="A1.T6.9.3.3.3.3.3.3.m3.1.1.cmml" xref="A1.T6.9.3.3.3.3.3.3.m3.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.9.3.3.3.3.3.3.m3.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="A1.T6.9.3.3.3.3.3.3.m3.1d">italic_α</annotation></semantics></math>, for example, </span>{<span class="ltx_text ltx_font_italic" id="A1.T6.10.4.4.4.4.4.4">“rationale”: “your explanation”, “better_answer”: <math alttext="\alpha" class="ltx_Math" display="inline" id="A1.T6.10.4.4.4.4.4.4.m1.1"><semantics id="A1.T6.10.4.4.4.4.4.4.m1.1a"><mi id="A1.T6.10.4.4.4.4.4.4.m1.1.1" xref="A1.T6.10.4.4.4.4.4.4.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="A1.T6.10.4.4.4.4.4.4.m1.1b"><ci id="A1.T6.10.4.4.4.4.4.4.m1.1.1.cmml" xref="A1.T6.10.4.4.4.4.4.4.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.10.4.4.4.4.4.4.m1.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="A1.T6.10.4.4.4.4.4.4.m1.1d">italic_α</annotation></semantics></math></span>}.</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A1.T6.14.8.8">
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_l ltx_border_r ltx_border_t" id="A1.T6.14.8.8.5">
<span class="ltx_inline-block ltx_align_top" id="A1.T6.14.8.8.5.1">
<span class="ltx_p" id="A1.T6.14.8.8.5.1.1" style="width:56.9pt;">Prompt with preamble_incorrect</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="A1.T6.14.8.8.4">
<span class="ltx_inline-block ltx_align_top" id="A1.T6.14.8.8.4.4">
<span class="ltx_p" id="A1.T6.14.8.8.4.4.4" style="width:313.0pt;"><span class="ltx_text ltx_font_italic" id="A1.T6.14.8.8.4.4.4.5">As an evaluation expert, given a question and its two possible answers, please choose which answer best aligns with coherence, accuracy, coverage, and overall quality. Below are the question and its candidate answers:

<br class="ltx_break"/><span class="ltx_text ltx_font_bold" id="A1.T6.14.8.8.4.4.4.5.1">Question:</span></span> {{Question}}

<br class="ltx_break"/><span class="ltx_text ltx_font_bold ltx_font_italic" id="A1.T6.14.8.8.4.4.4.6">Answer 1:</span> {{Answer 1}}
<br class="ltx_break"/><span class="ltx_text ltx_font_bold ltx_font_italic" id="A1.T6.14.8.8.4.4.4.7">Answer 2:</span> {{Answer 2}}

<br class="ltx_break"/><span class="ltx_text ltx_font_italic" id="A1.T6.13.7.7.3.3.3.3">Given that answer <math alttext="\beta" class="ltx_Math" display="inline" id="A1.T6.11.5.5.1.1.1.1.m1.1"><semantics id="A1.T6.11.5.5.1.1.1.1.m1.1a"><mi id="A1.T6.11.5.5.1.1.1.1.m1.1.1" xref="A1.T6.11.5.5.1.1.1.1.m1.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="A1.T6.11.5.5.1.1.1.1.m1.1b"><ci id="A1.T6.11.5.5.1.1.1.1.m1.1.1.cmml" xref="A1.T6.11.5.5.1.1.1.1.m1.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.11.5.5.1.1.1.1.m1.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="A1.T6.11.5.5.1.1.1.1.m1.1d">italic_β</annotation></semantics></math> is better than answer <math alttext="\alpha" class="ltx_Math" display="inline" id="A1.T6.12.6.6.2.2.2.2.m2.1"><semantics id="A1.T6.12.6.6.2.2.2.2.m2.1a"><mi id="A1.T6.12.6.6.2.2.2.2.m2.1.1" xref="A1.T6.12.6.6.2.2.2.2.m2.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="A1.T6.12.6.6.2.2.2.2.m2.1b"><ci id="A1.T6.12.6.6.2.2.2.2.m2.1.1.cmml" xref="A1.T6.12.6.6.2.2.2.2.m2.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.12.6.6.2.2.2.2.m2.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="A1.T6.12.6.6.2.2.2.2.m2.1d">italic_α</annotation></semantics></math>, please provide the rationale. Output your judgment in JSON format, where ”rationale” is your explanation, and ”better_answer” is an integer type of <math alttext="\beta" class="ltx_Math" display="inline" id="A1.T6.13.7.7.3.3.3.3.m3.1"><semantics id="A1.T6.13.7.7.3.3.3.3.m3.1a"><mi id="A1.T6.13.7.7.3.3.3.3.m3.1.1" xref="A1.T6.13.7.7.3.3.3.3.m3.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="A1.T6.13.7.7.3.3.3.3.m3.1b"><ci id="A1.T6.13.7.7.3.3.3.3.m3.1.1.cmml" xref="A1.T6.13.7.7.3.3.3.3.m3.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.13.7.7.3.3.3.3.m3.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="A1.T6.13.7.7.3.3.3.3.m3.1d">italic_β</annotation></semantics></math>, for example, </span>{<span class="ltx_text ltx_font_italic" id="A1.T6.14.8.8.4.4.4.4">“rationale”: “your explanation”, “better_answer”: <math alttext="\beta" class="ltx_Math" display="inline" id="A1.T6.14.8.8.4.4.4.4.m1.1"><semantics id="A1.T6.14.8.8.4.4.4.4.m1.1a"><mi id="A1.T6.14.8.8.4.4.4.4.m1.1.1" xref="A1.T6.14.8.8.4.4.4.4.m1.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="A1.T6.14.8.8.4.4.4.4.m1.1b"><ci id="A1.T6.14.8.8.4.4.4.4.m1.1.1.cmml" xref="A1.T6.14.8.8.4.4.4.4.m1.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.14.8.8.4.4.4.4.m1.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="A1.T6.14.8.8.4.4.4.4.m1.1d">italic_β</annotation></semantics></math></span>}<span class="ltx_text ltx_font_italic" id="A1.T6.14.8.8.4.4.4.8">.</span></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A1.T6.16.10.10">
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_l ltx_border_r ltx_border_t" id="A1.T6.16.10.10.3">
<span class="ltx_inline-block ltx_align_top" id="A1.T6.16.10.10.3.1">
<span class="ltx_p" id="A1.T6.16.10.10.3.1.1" style="width:56.9pt;">Prompt with preamble_correct (alternative)</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="A1.T6.16.10.10.2">
<span class="ltx_inline-block ltx_align_top" id="A1.T6.16.10.10.2.2">
<span class="ltx_p" id="A1.T6.16.10.10.2.2.2" style="width:313.0pt;"><span class="ltx_text ltx_font_italic" id="A1.T6.16.10.10.2.2.2.3">As an evaluation expert, given a question and its two possible answers, compare the answers according to their coherence, accuracy, coverage, and overall quality. Below are the question and its candidate answers:

<br class="ltx_break"/><span class="ltx_text ltx_font_bold" id="A1.T6.16.10.10.2.2.2.3.1">Question:</span></span> {{Question}}

<br class="ltx_break"/><span class="ltx_text ltx_font_bold ltx_font_italic" id="A1.T6.16.10.10.2.2.2.4">Answer 1:</span> {{Answer 1}}
<br class="ltx_break"/><span class="ltx_text ltx_font_bold ltx_font_italic" id="A1.T6.16.10.10.2.2.2.5">Answer 2:</span> {{Answer 2}}

<br class="ltx_break"/><span class="ltx_text ltx_font_italic" id="A1.T6.16.10.10.2.2.2.2">Given that answer <math alttext="\alpha" class="ltx_Math" display="inline" id="A1.T6.15.9.9.1.1.1.1.m1.1"><semantics id="A1.T6.15.9.9.1.1.1.1.m1.1a"><mi id="A1.T6.15.9.9.1.1.1.1.m1.1.1" xref="A1.T6.15.9.9.1.1.1.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="A1.T6.15.9.9.1.1.1.1.m1.1b"><ci id="A1.T6.15.9.9.1.1.1.1.m1.1.1.cmml" xref="A1.T6.15.9.9.1.1.1.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.15.9.9.1.1.1.1.m1.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="A1.T6.15.9.9.1.1.1.1.m1.1d">italic_α</annotation></semantics></math> is better than answer <math alttext="\beta" class="ltx_Math" display="inline" id="A1.T6.16.10.10.2.2.2.2.m2.1"><semantics id="A1.T6.16.10.10.2.2.2.2.m2.1a"><mi id="A1.T6.16.10.10.2.2.2.2.m2.1.1" xref="A1.T6.16.10.10.2.2.2.2.m2.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="A1.T6.16.10.10.2.2.2.2.m2.1b"><ci id="A1.T6.16.10.10.2.2.2.2.m2.1.1.cmml" xref="A1.T6.16.10.10.2.2.2.2.m2.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.16.10.10.2.2.2.2.m2.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="A1.T6.16.10.10.2.2.2.2.m2.1d">italic_β</annotation></semantics></math>, please provide the rationale:</span></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A1.T6.18.12.12">
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb ltx_border_l ltx_border_r ltx_border_t" id="A1.T6.18.12.12.3">
<span class="ltx_inline-block ltx_align_top" id="A1.T6.18.12.12.3.1">
<span class="ltx_p" id="A1.T6.18.12.12.3.1.1" style="width:56.9pt;">Prompt with preamble_incorrect (alternative)</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb ltx_border_r ltx_border_t" id="A1.T6.18.12.12.2">
<span class="ltx_inline-block ltx_align_top" id="A1.T6.18.12.12.2.2">
<span class="ltx_p" id="A1.T6.18.12.12.2.2.2" style="width:313.0pt;"><span class="ltx_text ltx_font_italic" id="A1.T6.18.12.12.2.2.2.3">As an evaluation expert, given a question and its two possible answers, compare the answers according to their coherence, accuracy, coverage, and overall quality. Below are the question and its candidate answers:

<br class="ltx_break"/><span class="ltx_text ltx_font_bold" id="A1.T6.18.12.12.2.2.2.3.1">Question:</span></span> {{Question}}

<br class="ltx_break"/><span class="ltx_text ltx_font_bold ltx_font_italic" id="A1.T6.18.12.12.2.2.2.4">Answer 1:</span> {{Answer 1}}
<br class="ltx_break"/><span class="ltx_text ltx_font_bold ltx_font_italic" id="A1.T6.18.12.12.2.2.2.5">Answer 2:</span> {{Answer 2}}

<br class="ltx_break"/><span class="ltx_text ltx_font_italic" id="A1.T6.18.12.12.2.2.2.2">Given that answer <math alttext="\beta" class="ltx_Math" display="inline" id="A1.T6.17.11.11.1.1.1.1.m1.1"><semantics id="A1.T6.17.11.11.1.1.1.1.m1.1a"><mi id="A1.T6.17.11.11.1.1.1.1.m1.1.1" xref="A1.T6.17.11.11.1.1.1.1.m1.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="A1.T6.17.11.11.1.1.1.1.m1.1b"><ci id="A1.T6.17.11.11.1.1.1.1.m1.1.1.cmml" xref="A1.T6.17.11.11.1.1.1.1.m1.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.17.11.11.1.1.1.1.m1.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="A1.T6.17.11.11.1.1.1.1.m1.1d">italic_β</annotation></semantics></math> is better than answer <math alttext="\alpha" class="ltx_Math" display="inline" id="A1.T6.18.12.12.2.2.2.2.m2.1"><semantics id="A1.T6.18.12.12.2.2.2.2.m2.1a"><mi id="A1.T6.18.12.12.2.2.2.2.m2.1.1" xref="A1.T6.18.12.12.2.2.2.2.m2.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="A1.T6.18.12.12.2.2.2.2.m2.1b"><ci id="A1.T6.18.12.12.2.2.2.2.m2.1.1.cmml" xref="A1.T6.18.12.12.2.2.2.2.m2.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.18.12.12.2.2.2.2.m2.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="A1.T6.18.12.12.2.2.2.2.m2.1d">italic_α</annotation></semantics></math>, please provide the rationale:</span></span>
</span>
</td>
</tr>
</table>
</figure>
<div class="ltx_pagination ltx_role_newpage"></div>
<figure class="ltx_table" id="A1.T7">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 7: </span>Prompt template for forcing the generative LLM outputs only the binary judgment without any rationales. {{Question}}, {{Answer 1}}, {{Answer 2}} are the text content of the question, answer 1, and answer 2, respectively.
</figcaption>
<table class="ltx_tabular ltx_centering ltx_align_middle" id="A1.T7.1">
<tr class="ltx_tr" id="A1.T7.1.1">
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb ltx_border_l ltx_border_r ltx_border_tt" id="A1.T7.1.1.1">
<span class="ltx_inline-block ltx_align_top" id="A1.T7.1.1.1.1">
<span class="ltx_p" id="A1.T7.1.1.1.1.1" style="width:56.9pt;">Prompt</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb ltx_border_r ltx_border_tt" id="A1.T7.1.1.2">
<span class="ltx_inline-block ltx_align_top" id="A1.T7.1.1.2.1">
<span class="ltx_p" id="A1.T7.1.1.2.1.1" style="width:313.0pt;"><span class="ltx_text ltx_font_italic" id="A1.T7.1.1.2.1.1.1">As an evaluation expert, given a question and its two possible answers, please choose which answer best aligns with coherence, accuracy, coverage, and overall quality. Output your judgment in JSON format in which ”better_answer” is an integer type of 1 or 2, for example, </span>{<span class="ltx_text ltx_font_italic" id="A1.T7.1.1.2.1.1.2">“better_answer”: 1</span>}<span class="ltx_text ltx_font_italic" id="A1.T7.1.1.2.1.1.3">. Do not include any additional explanations. Below are the question and its candidate answers:

<br class="ltx_break"/><span class="ltx_text ltx_font_bold" id="A1.T7.1.1.2.1.1.3.1">Question:</span></span> {{Question}}

<br class="ltx_break"/><span class="ltx_text ltx_font_bold ltx_font_italic" id="A1.T7.1.1.2.1.1.4">Answer 1:</span> {{Answer 1}}

<br class="ltx_break"/><span class="ltx_text ltx_font_bold ltx_font_italic" id="A1.T7.1.1.2.1.1.5">Answer 2:</span> {{Answer 2}}</span>
</span>
</td>
</tr>
</table>
</figure>
<div class="ltx_pagination ltx_role_newpage"></div>
<figure class="ltx_table" id="A1.T8">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 8: </span>Prompt template for transforming the answers into different formats.
</figcaption>
<table class="ltx_tabular ltx_centering ltx_align_middle" id="A1.T8.1">
<tr class="ltx_tr" id="A1.T8.1.1">
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_l ltx_border_r ltx_border_tt" id="A1.T8.1.1.1">
<span class="ltx_inline-block ltx_align_top" id="A1.T8.1.1.1.1">
<span class="ltx_p" id="A1.T8.1.1.1.1.1" style="width:56.9pt;">Prompt for rewriting the answer into a more verbal format</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_tt" id="A1.T8.1.1.2">
<span class="ltx_inline-block ltx_align_top" id="A1.T8.1.1.2.1">
<span class="ltx_p" id="A1.T8.1.1.2.1.1" style="width:313.0pt;"><span class="ltx_text ltx_font_italic" id="A1.T8.1.1.2.1.1.1">You are someone who works on popularizing mathematical knowledge.
Please restate the following content in simpler, more accessible language without changing the original meaning, affecting its length, or adding extra information.
Below is the input:
</span>{{<span class="ltx_text ltx_font_italic" id="A1.T8.1.1.2.1.1.2">Answer</span>}}</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A1.T8.1.2">
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_l ltx_border_r ltx_border_t" id="A1.T8.1.2.1">
<span class="ltx_inline-block ltx_align_top" id="A1.T8.1.2.1.1">
<span class="ltx_p" id="A1.T8.1.2.1.1.1" style="width:56.9pt;">Prompt for rewriting the answer into a more formal format</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="A1.T8.1.2.2">
<span class="ltx_inline-block ltx_align_top" id="A1.T8.1.2.2.1">
<span class="ltx_p" id="A1.T8.1.2.2.1.1" style="width:313.0pt;"><span class="ltx_text ltx_font_italic" id="A1.T8.1.2.2.1.1.1">You are a researcher in the field of mathematics.
Please restate the following content using precise mathematical language without changing the original meaning, affecting its length, or adding extra information.
Below is the input:
</span>{{<span class="ltx_text ltx_font_italic" id="A1.T8.1.2.2.1.1.2">Answer</span>}}</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A1.T8.1.3">
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb ltx_border_l ltx_border_r ltx_border_t" id="A1.T8.1.3.1">
<span class="ltx_inline-block ltx_align_top" id="A1.T8.1.3.1.1">
<span class="ltx_p" id="A1.T8.1.3.1.1.1" style="width:56.9pt;">Prompt for rewriting the answer to be more verbose</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb ltx_border_r ltx_border_t" id="A1.T8.1.3.2">
<span class="ltx_inline-block ltx_align_top" id="A1.T8.1.3.2.1">
<span class="ltx_p" id="A1.T8.1.3.2.1.1" style="width:313.0pt;"><span class="ltx_text ltx_font_italic" id="A1.T8.1.3.2.1.1.1">Please summarize the input by listing the key points in a numbered format.
Below is the input:
</span>{{<span class="ltx_text ltx_font_italic" id="A1.T8.1.3.2.1.1.2">Answer</span>}}</span>
</span>
</td>
</tr>
</table>
</figure>
<div class="ltx_pagination ltx_role_newpage"></div>
<figure class="ltx_table" id="A1.T9">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 9: </span>Prompt template for scoring the rationales and judgments of Con-J.
</figcaption>
<table class="ltx_tabular ltx_centering ltx_align_middle" id="A1.T9.1">
<tr class="ltx_tr" id="A1.T9.1.1">
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb ltx_border_l ltx_border_r ltx_border_tt" id="A1.T9.1.1.1">
<span class="ltx_inline-block ltx_align_top" id="A1.T9.1.1.1.1">
<span class="ltx_p" id="A1.T9.1.1.1.1.1" style="width:313.0pt;"><span class="ltx_text ltx_font_italic" id="A1.T9.1.1.1.1.1.1">
##Background
</span></span>
<span class="ltx_p" id="A1.T9.1.1.1.1.2"><span class="ltx_text ltx_font_italic" id="A1.T9.1.1.1.1.2.1">Given below is a question and two corresponding answers:
</span></span>
<span class="ltx_p" id="A1.T9.1.1.1.1.3"><span class="ltx_text ltx_font_bold ltx_font_italic" id="A1.T9.1.1.1.1.3.1">Question:<span class="ltx_text ltx_font_medium" id="A1.T9.1.1.1.1.3.1.1"> </span></span>{{<span class="ltx_text ltx_font_italic" id="A1.T9.1.1.1.1.3.2">Question</span>}}<span class="ltx_text ltx_font_italic" id="A1.T9.1.1.1.1.3.3">
</span></span>
<span class="ltx_p" id="A1.T9.1.1.1.1.4"><span class="ltx_text ltx_font_bold ltx_font_italic" id="A1.T9.1.1.1.1.4.1">Answer 1:<span class="ltx_text ltx_font_medium" id="A1.T9.1.1.1.1.4.1.1"> </span></span>{{<span class="ltx_text ltx_font_italic" id="A1.T9.1.1.1.1.4.2">Answer 1</span>}}<span class="ltx_text ltx_font_italic" id="A1.T9.1.1.1.1.4.3">
</span></span>
<span class="ltx_p" id="A1.T9.1.1.1.1.5"><span class="ltx_text ltx_font_bold ltx_font_italic" id="A1.T9.1.1.1.1.5.1">Answer 2:<span class="ltx_text ltx_font_medium" id="A1.T9.1.1.1.1.5.1.1"> </span></span>{{<span class="ltx_text ltx_font_italic" id="A1.T9.1.1.1.1.5.2">Answer 2</span>}}<span class="ltx_text ltx_font_italic" id="A1.T9.1.1.1.1.5.3">
</span></span>
<span class="ltx_p" id="A1.T9.1.1.1.1.6"><span class="ltx_text ltx_font_italic" id="A1.T9.1.1.1.1.6.1">A judge has assessed these two answers and judged which one is better.
Here are its judgment and the corresponding rationales:
</span></span>
<span class="ltx_p" id="A1.T9.1.1.1.1.7">{{<span class="ltx_text ltx_font_italic" id="A1.T9.1.1.1.1.7.1">Judgment</span>}}<span class="ltx_text ltx_font_italic" id="A1.T9.1.1.1.1.7.2">
</span></span>
<span class="ltx_p" id="A1.T9.1.1.1.1.8"><span class="ltx_text ltx_font_italic" id="A1.T9.1.1.1.1.8.1">##Workflow and Scoring
</span></span>
<span class="ltx_p" id="A1.T9.1.1.1.1.9"><span class="ltx_text ltx_font_italic" id="A1.T9.1.1.1.1.9.1">Please analyze whether the judgment is correct and evaluate the rationale by scoring them on (i) correctness and (ii) consistency with the binary judgment:
</span></span>
<span class="ltx_p" id="A1.T9.1.1.1.1.10"><span class="ltx_text ltx_font_italic" id="A1.T9.1.1.1.1.10.1">Correctness:
</span></span>
<span class="ltx_p" id="A1.T9.1.1.1.1.11"><span class="ltx_text ltx_font_italic" id="A1.T9.1.1.1.1.11.1">1: Completely incorrect, with obvious erroneous arguments.
</span></span>
<span class="ltx_p" id="A1.T9.1.1.1.1.12"><span class="ltx_text ltx_font_italic" id="A1.T9.1.1.1.1.12.1">2: Mostly incorrect, with some correct arguments.
</span></span>
<span class="ltx_p" id="A1.T9.1.1.1.1.13"><span class="ltx_text ltx_font_italic" id="A1.T9.1.1.1.1.13.1">3: Partially correct, with almost no errors.
</span></span>
<span class="ltx_p" id="A1.T9.1.1.1.1.14"><span class="ltx_text ltx_font_italic" id="A1.T9.1.1.1.1.14.1">4: Mostly correct.
</span></span>
<span class="ltx_p" id="A1.T9.1.1.1.1.15"><span class="ltx_text ltx_font_italic" id="A1.T9.1.1.1.1.15.1">5: Completely correct.
</span></span>
<span class="ltx_p" id="A1.T9.1.1.1.1.16"><span class="ltx_text ltx_font_italic" id="A1.T9.1.1.1.1.16.1">Consistency:
</span></span>
<span class="ltx_p" id="A1.T9.1.1.1.1.17"><span class="ltx_text ltx_font_italic" id="A1.T9.1.1.1.1.17.1">1: The emotional tone of the reasons is inconsistent with the final judgment.
</span></span>
<span class="ltx_p" id="A1.T9.1.1.1.1.18"><span class="ltx_text ltx_font_italic" id="A1.T9.1.1.1.1.18.1">2: The reasons have no clear emotional tone.
</span></span>
<span class="ltx_p" id="A1.T9.1.1.1.1.19"><span class="ltx_text ltx_font_italic" id="A1.T9.1.1.1.1.19.1">3: The emotional tone of the reasons is consistent with the final judgment.
</span></span>
<span class="ltx_p" id="A1.T9.1.1.1.1.20"><span class="ltx_text ltx_font_italic" id="A1.T9.1.1.1.1.20.1">##Formatting
</span></span>
<span class="ltx_p" id="A1.T9.1.1.1.1.21"><span class="ltx_text ltx_font_italic" id="A1.T9.1.1.1.1.21.1">Please return the results in JSON format, for example: “Judgment Correctness”: “Correct”, “Rationale Correctness”: 4, ”Rationale Consistency”: 3, where “Judgment Correctness” can be either “Correct” or “Incorrect”.</span></span>
</span>
</td>
</tr>
</table>
</figure>
<div class="ltx_pagination ltx_role_newpage"></div>
<figure class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top" id="alg1">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="alg1.2.1.1">Algorithm 1</span> </span> Constructing contrastive judgment pairs for Con-J </figcaption>
<div class="ltx_listing ltx_listing" id="alg1.3">
<div class="ltx_listingline" id="alg1.l1">
<span class="ltx_tag ltx_tag_listingline">1:</span><span class="ltx_text ltx_font_bold" id="alg1.l1.1">Input:</span> <math alttext="\pi" class="ltx_Math" display="inline" id="alg1.l1.m1.1"><semantics id="alg1.l1.m1.1a"><mi id="alg1.l1.m1.1.1" xref="alg1.l1.m1.1.1.cmml">π</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m1.1b"><ci id="alg1.l1.m1.1.1.cmml" xref="alg1.l1.m1.1.1">𝜋</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m1.1c">\pi</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m1.1d">italic_π</annotation></semantics></math>: a pre-trained LLM; a preference dataset <math alttext="D=\{(q,a^{-},a^{+})_{i}\}_{i=1}^{N}" class="ltx_Math" display="inline" id="alg1.l1.m2.2"><semantics id="alg1.l1.m2.2a"><mrow id="alg1.l1.m2.2.2" xref="alg1.l1.m2.2.2.cmml"><mi id="alg1.l1.m2.2.2.3" xref="alg1.l1.m2.2.2.3.cmml">D</mi><mo id="alg1.l1.m2.2.2.2" xref="alg1.l1.m2.2.2.2.cmml">=</mo><msubsup id="alg1.l1.m2.2.2.1" xref="alg1.l1.m2.2.2.1.cmml"><mrow id="alg1.l1.m2.2.2.1.1.1.1" xref="alg1.l1.m2.2.2.1.1.1.2.cmml"><mo id="alg1.l1.m2.2.2.1.1.1.1.2" stretchy="false" xref="alg1.l1.m2.2.2.1.1.1.2.cmml">{</mo><msub id="alg1.l1.m2.2.2.1.1.1.1.1" xref="alg1.l1.m2.2.2.1.1.1.1.1.cmml"><mrow id="alg1.l1.m2.2.2.1.1.1.1.1.2.2" xref="alg1.l1.m2.2.2.1.1.1.1.1.2.3.cmml"><mo id="alg1.l1.m2.2.2.1.1.1.1.1.2.2.3" stretchy="false" xref="alg1.l1.m2.2.2.1.1.1.1.1.2.3.cmml">(</mo><mi id="alg1.l1.m2.1.1" xref="alg1.l1.m2.1.1.cmml">q</mi><mo id="alg1.l1.m2.2.2.1.1.1.1.1.2.2.4" xref="alg1.l1.m2.2.2.1.1.1.1.1.2.3.cmml">,</mo><msup id="alg1.l1.m2.2.2.1.1.1.1.1.1.1.1" xref="alg1.l1.m2.2.2.1.1.1.1.1.1.1.1.cmml"><mi id="alg1.l1.m2.2.2.1.1.1.1.1.1.1.1.2" xref="alg1.l1.m2.2.2.1.1.1.1.1.1.1.1.2.cmml">a</mi><mo id="alg1.l1.m2.2.2.1.1.1.1.1.1.1.1.3" xref="alg1.l1.m2.2.2.1.1.1.1.1.1.1.1.3.cmml">−</mo></msup><mo id="alg1.l1.m2.2.2.1.1.1.1.1.2.2.5" xref="alg1.l1.m2.2.2.1.1.1.1.1.2.3.cmml">,</mo><msup id="alg1.l1.m2.2.2.1.1.1.1.1.2.2.2" xref="alg1.l1.m2.2.2.1.1.1.1.1.2.2.2.cmml"><mi id="alg1.l1.m2.2.2.1.1.1.1.1.2.2.2.2" xref="alg1.l1.m2.2.2.1.1.1.1.1.2.2.2.2.cmml">a</mi><mo id="alg1.l1.m2.2.2.1.1.1.1.1.2.2.2.3" xref="alg1.l1.m2.2.2.1.1.1.1.1.2.2.2.3.cmml">+</mo></msup><mo id="alg1.l1.m2.2.2.1.1.1.1.1.2.2.6" stretchy="false" xref="alg1.l1.m2.2.2.1.1.1.1.1.2.3.cmml">)</mo></mrow><mi id="alg1.l1.m2.2.2.1.1.1.1.1.4" xref="alg1.l1.m2.2.2.1.1.1.1.1.4.cmml">i</mi></msub><mo id="alg1.l1.m2.2.2.1.1.1.1.3" stretchy="false" xref="alg1.l1.m2.2.2.1.1.1.2.cmml">}</mo></mrow><mrow id="alg1.l1.m2.2.2.1.1.3" xref="alg1.l1.m2.2.2.1.1.3.cmml"><mi id="alg1.l1.m2.2.2.1.1.3.2" xref="alg1.l1.m2.2.2.1.1.3.2.cmml">i</mi><mo id="alg1.l1.m2.2.2.1.1.3.1" xref="alg1.l1.m2.2.2.1.1.3.1.cmml">=</mo><mn id="alg1.l1.m2.2.2.1.1.3.3" xref="alg1.l1.m2.2.2.1.1.3.3.cmml">1</mn></mrow><mi id="alg1.l1.m2.2.2.1.3" xref="alg1.l1.m2.2.2.1.3.cmml">N</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="alg1.l1.m2.2b"><apply id="alg1.l1.m2.2.2.cmml" xref="alg1.l1.m2.2.2"><eq id="alg1.l1.m2.2.2.2.cmml" xref="alg1.l1.m2.2.2.2"></eq><ci id="alg1.l1.m2.2.2.3.cmml" xref="alg1.l1.m2.2.2.3">𝐷</ci><apply id="alg1.l1.m2.2.2.1.cmml" xref="alg1.l1.m2.2.2.1"><csymbol cd="ambiguous" id="alg1.l1.m2.2.2.1.2.cmml" xref="alg1.l1.m2.2.2.1">superscript</csymbol><apply id="alg1.l1.m2.2.2.1.1.cmml" xref="alg1.l1.m2.2.2.1"><csymbol cd="ambiguous" id="alg1.l1.m2.2.2.1.1.2.cmml" xref="alg1.l1.m2.2.2.1">subscript</csymbol><set id="alg1.l1.m2.2.2.1.1.1.2.cmml" xref="alg1.l1.m2.2.2.1.1.1.1"><apply id="alg1.l1.m2.2.2.1.1.1.1.1.cmml" xref="alg1.l1.m2.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l1.m2.2.2.1.1.1.1.1.3.cmml" xref="alg1.l1.m2.2.2.1.1.1.1.1">subscript</csymbol><vector id="alg1.l1.m2.2.2.1.1.1.1.1.2.3.cmml" xref="alg1.l1.m2.2.2.1.1.1.1.1.2.2"><ci id="alg1.l1.m2.1.1.cmml" xref="alg1.l1.m2.1.1">𝑞</ci><apply id="alg1.l1.m2.2.2.1.1.1.1.1.1.1.1.cmml" xref="alg1.l1.m2.2.2.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l1.m2.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l1.m2.2.2.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="alg1.l1.m2.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l1.m2.2.2.1.1.1.1.1.1.1.1.2">𝑎</ci><minus id="alg1.l1.m2.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l1.m2.2.2.1.1.1.1.1.1.1.1.3"></minus></apply><apply id="alg1.l1.m2.2.2.1.1.1.1.1.2.2.2.cmml" xref="alg1.l1.m2.2.2.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="alg1.l1.m2.2.2.1.1.1.1.1.2.2.2.1.cmml" xref="alg1.l1.m2.2.2.1.1.1.1.1.2.2.2">superscript</csymbol><ci id="alg1.l1.m2.2.2.1.1.1.1.1.2.2.2.2.cmml" xref="alg1.l1.m2.2.2.1.1.1.1.1.2.2.2.2">𝑎</ci><plus id="alg1.l1.m2.2.2.1.1.1.1.1.2.2.2.3.cmml" xref="alg1.l1.m2.2.2.1.1.1.1.1.2.2.2.3"></plus></apply></vector><ci id="alg1.l1.m2.2.2.1.1.1.1.1.4.cmml" xref="alg1.l1.m2.2.2.1.1.1.1.1.4">𝑖</ci></apply></set><apply id="alg1.l1.m2.2.2.1.1.3.cmml" xref="alg1.l1.m2.2.2.1.1.3"><eq id="alg1.l1.m2.2.2.1.1.3.1.cmml" xref="alg1.l1.m2.2.2.1.1.3.1"></eq><ci id="alg1.l1.m2.2.2.1.1.3.2.cmml" xref="alg1.l1.m2.2.2.1.1.3.2">𝑖</ci><cn id="alg1.l1.m2.2.2.1.1.3.3.cmml" type="integer" xref="alg1.l1.m2.2.2.1.1.3.3">1</cn></apply></apply><ci id="alg1.l1.m2.2.2.1.3.cmml" xref="alg1.l1.m2.2.2.1.3">𝑁</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m2.2c">D=\{(q,a^{-},a^{+})_{i}\}_{i=1}^{N}</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m2.2d">italic_D = { ( italic_q , italic_a start_POSTSUPERSCRIPT - end_POSTSUPERSCRIPT , italic_a start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT ) start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT } start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT</annotation></semantics></math>.

</div>
<div class="ltx_listingline" id="alg1.l2">
<span class="ltx_tag ltx_tag_listingline">2:</span><span class="ltx_text ltx_font_bold" id="alg1.l2.1">Output:</span> <math alttext="E" class="ltx_Math" display="inline" id="alg1.l2.m1.1"><semantics id="alg1.l2.m1.1a"><mi id="alg1.l2.m1.1.1" xref="alg1.l2.m1.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="alg1.l2.m1.1b"><ci id="alg1.l2.m1.1.1.cmml" xref="alg1.l2.m1.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m1.1c">E</annotation><annotation encoding="application/x-llamapun" id="alg1.l2.m1.1d">italic_E</annotation></semantics></math>: a set
of constrastive judgment pairs.

</div>
<div class="ltx_listingline" id="alg1.l3">
<span class="ltx_tag ltx_tag_listingline">3:</span><math alttext="E=\emptyset" class="ltx_Math" display="inline" id="alg1.l3.m1.1"><semantics id="alg1.l3.m1.1a"><mrow id="alg1.l3.m1.1.1" xref="alg1.l3.m1.1.1.cmml"><mi id="alg1.l3.m1.1.1.2" xref="alg1.l3.m1.1.1.2.cmml">E</mi><mo id="alg1.l3.m1.1.1.1" xref="alg1.l3.m1.1.1.1.cmml">=</mo><mi id="alg1.l3.m1.1.1.3" mathvariant="normal" xref="alg1.l3.m1.1.1.3.cmml">∅</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l3.m1.1b"><apply id="alg1.l3.m1.1.1.cmml" xref="alg1.l3.m1.1.1"><eq id="alg1.l3.m1.1.1.1.cmml" xref="alg1.l3.m1.1.1.1"></eq><ci id="alg1.l3.m1.1.1.2.cmml" xref="alg1.l3.m1.1.1.2">𝐸</ci><emptyset id="alg1.l3.m1.1.1.3.cmml" xref="alg1.l3.m1.1.1.3"></emptyset></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m1.1c">E=\emptyset</annotation><annotation encoding="application/x-llamapun" id="alg1.l3.m1.1d">italic_E = ∅</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l4">
<span class="ltx_tag ltx_tag_listingline">4:</span><span class="ltx_text ltx_font_bold" id="alg1.l4.1">for</span> <math alttext="(q,a^{-},a^{+})_{i}\in D" class="ltx_Math" display="inline" id="alg1.l4.m1.3"><semantics id="alg1.l4.m1.3a"><mrow id="alg1.l4.m1.3.3" xref="alg1.l4.m1.3.3.cmml"><msub id="alg1.l4.m1.3.3.2" xref="alg1.l4.m1.3.3.2.cmml"><mrow id="alg1.l4.m1.3.3.2.2.2" xref="alg1.l4.m1.3.3.2.2.3.cmml"><mo id="alg1.l4.m1.3.3.2.2.2.3" stretchy="false" xref="alg1.l4.m1.3.3.2.2.3.cmml">(</mo><mi id="alg1.l4.m1.1.1" xref="alg1.l4.m1.1.1.cmml">q</mi><mo id="alg1.l4.m1.3.3.2.2.2.4" xref="alg1.l4.m1.3.3.2.2.3.cmml">,</mo><msup id="alg1.l4.m1.2.2.1.1.1.1" xref="alg1.l4.m1.2.2.1.1.1.1.cmml"><mi id="alg1.l4.m1.2.2.1.1.1.1.2" xref="alg1.l4.m1.2.2.1.1.1.1.2.cmml">a</mi><mo id="alg1.l4.m1.2.2.1.1.1.1.3" xref="alg1.l4.m1.2.2.1.1.1.1.3.cmml">−</mo></msup><mo id="alg1.l4.m1.3.3.2.2.2.5" xref="alg1.l4.m1.3.3.2.2.3.cmml">,</mo><msup id="alg1.l4.m1.3.3.2.2.2.2" xref="alg1.l4.m1.3.3.2.2.2.2.cmml"><mi id="alg1.l4.m1.3.3.2.2.2.2.2" xref="alg1.l4.m1.3.3.2.2.2.2.2.cmml">a</mi><mo id="alg1.l4.m1.3.3.2.2.2.2.3" xref="alg1.l4.m1.3.3.2.2.2.2.3.cmml">+</mo></msup><mo id="alg1.l4.m1.3.3.2.2.2.6" stretchy="false" xref="alg1.l4.m1.3.3.2.2.3.cmml">)</mo></mrow><mi id="alg1.l4.m1.3.3.2.4" xref="alg1.l4.m1.3.3.2.4.cmml">i</mi></msub><mo id="alg1.l4.m1.3.3.3" xref="alg1.l4.m1.3.3.3.cmml">∈</mo><mi id="alg1.l4.m1.3.3.4" xref="alg1.l4.m1.3.3.4.cmml">D</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l4.m1.3b"><apply id="alg1.l4.m1.3.3.cmml" xref="alg1.l4.m1.3.3"><in id="alg1.l4.m1.3.3.3.cmml" xref="alg1.l4.m1.3.3.3"></in><apply id="alg1.l4.m1.3.3.2.cmml" xref="alg1.l4.m1.3.3.2"><csymbol cd="ambiguous" id="alg1.l4.m1.3.3.2.3.cmml" xref="alg1.l4.m1.3.3.2">subscript</csymbol><vector id="alg1.l4.m1.3.3.2.2.3.cmml" xref="alg1.l4.m1.3.3.2.2.2"><ci id="alg1.l4.m1.1.1.cmml" xref="alg1.l4.m1.1.1">𝑞</ci><apply id="alg1.l4.m1.2.2.1.1.1.1.cmml" xref="alg1.l4.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l4.m1.2.2.1.1.1.1.1.cmml" xref="alg1.l4.m1.2.2.1.1.1.1">superscript</csymbol><ci id="alg1.l4.m1.2.2.1.1.1.1.2.cmml" xref="alg1.l4.m1.2.2.1.1.1.1.2">𝑎</ci><minus id="alg1.l4.m1.2.2.1.1.1.1.3.cmml" xref="alg1.l4.m1.2.2.1.1.1.1.3"></minus></apply><apply id="alg1.l4.m1.3.3.2.2.2.2.cmml" xref="alg1.l4.m1.3.3.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l4.m1.3.3.2.2.2.2.1.cmml" xref="alg1.l4.m1.3.3.2.2.2.2">superscript</csymbol><ci id="alg1.l4.m1.3.3.2.2.2.2.2.cmml" xref="alg1.l4.m1.3.3.2.2.2.2.2">𝑎</ci><plus id="alg1.l4.m1.3.3.2.2.2.2.3.cmml" xref="alg1.l4.m1.3.3.2.2.2.2.3"></plus></apply></vector><ci id="alg1.l4.m1.3.3.2.4.cmml" xref="alg1.l4.m1.3.3.2.4">𝑖</ci></apply><ci id="alg1.l4.m1.3.3.4.cmml" xref="alg1.l4.m1.3.3.4">𝐷</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m1.3c">(q,a^{-},a^{+})_{i}\in D</annotation><annotation encoding="application/x-llamapun" id="alg1.l4.m1.3d">( italic_q , italic_a start_POSTSUPERSCRIPT - end_POSTSUPERSCRIPT , italic_a start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT ) start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∈ italic_D</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="alg1.l4.2">do</span>
</div>
<div class="ltx_listingline" id="alg1.l5">
<span class="ltx_tag ltx_tag_listingline">5:</span>     <math alttext="p=\text{format}(\text{preamble},(q,a^{-},a^{+})_{i})" class="ltx_Math" display="inline" id="alg1.l5.m1.3"><semantics id="alg1.l5.m1.3a"><mrow id="alg1.l5.m1.3.3" xref="alg1.l5.m1.3.3.cmml"><mi id="alg1.l5.m1.3.3.3" xref="alg1.l5.m1.3.3.3.cmml">p</mi><mo id="alg1.l5.m1.3.3.2" xref="alg1.l5.m1.3.3.2.cmml">=</mo><mrow id="alg1.l5.m1.3.3.1" xref="alg1.l5.m1.3.3.1.cmml"><mtext id="alg1.l5.m1.3.3.1.3" xref="alg1.l5.m1.3.3.1.3a.cmml">format</mtext><mo id="alg1.l5.m1.3.3.1.2" xref="alg1.l5.m1.3.3.1.2.cmml">⁢</mo><mrow id="alg1.l5.m1.3.3.1.1.1" xref="alg1.l5.m1.3.3.1.1.2.cmml"><mo id="alg1.l5.m1.3.3.1.1.1.2" stretchy="false" xref="alg1.l5.m1.3.3.1.1.2.cmml">(</mo><mtext id="alg1.l5.m1.2.2" xref="alg1.l5.m1.2.2a.cmml">preamble</mtext><mo id="alg1.l5.m1.3.3.1.1.1.3" xref="alg1.l5.m1.3.3.1.1.2.cmml">,</mo><msub id="alg1.l5.m1.3.3.1.1.1.1" xref="alg1.l5.m1.3.3.1.1.1.1.cmml"><mrow id="alg1.l5.m1.3.3.1.1.1.1.2.2" xref="alg1.l5.m1.3.3.1.1.1.1.2.3.cmml"><mo id="alg1.l5.m1.3.3.1.1.1.1.2.2.3" stretchy="false" xref="alg1.l5.m1.3.3.1.1.1.1.2.3.cmml">(</mo><mi id="alg1.l5.m1.1.1" xref="alg1.l5.m1.1.1.cmml">q</mi><mo id="alg1.l5.m1.3.3.1.1.1.1.2.2.4" xref="alg1.l5.m1.3.3.1.1.1.1.2.3.cmml">,</mo><msup id="alg1.l5.m1.3.3.1.1.1.1.1.1.1" xref="alg1.l5.m1.3.3.1.1.1.1.1.1.1.cmml"><mi id="alg1.l5.m1.3.3.1.1.1.1.1.1.1.2" xref="alg1.l5.m1.3.3.1.1.1.1.1.1.1.2.cmml">a</mi><mo id="alg1.l5.m1.3.3.1.1.1.1.1.1.1.3" xref="alg1.l5.m1.3.3.1.1.1.1.1.1.1.3.cmml">−</mo></msup><mo id="alg1.l5.m1.3.3.1.1.1.1.2.2.5" xref="alg1.l5.m1.3.3.1.1.1.1.2.3.cmml">,</mo><msup id="alg1.l5.m1.3.3.1.1.1.1.2.2.2" xref="alg1.l5.m1.3.3.1.1.1.1.2.2.2.cmml"><mi id="alg1.l5.m1.3.3.1.1.1.1.2.2.2.2" xref="alg1.l5.m1.3.3.1.1.1.1.2.2.2.2.cmml">a</mi><mo id="alg1.l5.m1.3.3.1.1.1.1.2.2.2.3" xref="alg1.l5.m1.3.3.1.1.1.1.2.2.2.3.cmml">+</mo></msup><mo id="alg1.l5.m1.3.3.1.1.1.1.2.2.6" stretchy="false" xref="alg1.l5.m1.3.3.1.1.1.1.2.3.cmml">)</mo></mrow><mi id="alg1.l5.m1.3.3.1.1.1.1.4" xref="alg1.l5.m1.3.3.1.1.1.1.4.cmml">i</mi></msub><mo id="alg1.l5.m1.3.3.1.1.1.4" stretchy="false" xref="alg1.l5.m1.3.3.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l5.m1.3b"><apply id="alg1.l5.m1.3.3.cmml" xref="alg1.l5.m1.3.3"><eq id="alg1.l5.m1.3.3.2.cmml" xref="alg1.l5.m1.3.3.2"></eq><ci id="alg1.l5.m1.3.3.3.cmml" xref="alg1.l5.m1.3.3.3">𝑝</ci><apply id="alg1.l5.m1.3.3.1.cmml" xref="alg1.l5.m1.3.3.1"><times id="alg1.l5.m1.3.3.1.2.cmml" xref="alg1.l5.m1.3.3.1.2"></times><ci id="alg1.l5.m1.3.3.1.3a.cmml" xref="alg1.l5.m1.3.3.1.3"><mtext id="alg1.l5.m1.3.3.1.3.cmml" xref="alg1.l5.m1.3.3.1.3">format</mtext></ci><interval closure="open" id="alg1.l5.m1.3.3.1.1.2.cmml" xref="alg1.l5.m1.3.3.1.1.1"><ci id="alg1.l5.m1.2.2a.cmml" xref="alg1.l5.m1.2.2"><mtext id="alg1.l5.m1.2.2.cmml" xref="alg1.l5.m1.2.2">preamble</mtext></ci><apply id="alg1.l5.m1.3.3.1.1.1.1.cmml" xref="alg1.l5.m1.3.3.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l5.m1.3.3.1.1.1.1.3.cmml" xref="alg1.l5.m1.3.3.1.1.1.1">subscript</csymbol><vector id="alg1.l5.m1.3.3.1.1.1.1.2.3.cmml" xref="alg1.l5.m1.3.3.1.1.1.1.2.2"><ci id="alg1.l5.m1.1.1.cmml" xref="alg1.l5.m1.1.1">𝑞</ci><apply id="alg1.l5.m1.3.3.1.1.1.1.1.1.1.cmml" xref="alg1.l5.m1.3.3.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l5.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="alg1.l5.m1.3.3.1.1.1.1.1.1.1">superscript</csymbol><ci id="alg1.l5.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="alg1.l5.m1.3.3.1.1.1.1.1.1.1.2">𝑎</ci><minus id="alg1.l5.m1.3.3.1.1.1.1.1.1.1.3.cmml" xref="alg1.l5.m1.3.3.1.1.1.1.1.1.1.3"></minus></apply><apply id="alg1.l5.m1.3.3.1.1.1.1.2.2.2.cmml" xref="alg1.l5.m1.3.3.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="alg1.l5.m1.3.3.1.1.1.1.2.2.2.1.cmml" xref="alg1.l5.m1.3.3.1.1.1.1.2.2.2">superscript</csymbol><ci id="alg1.l5.m1.3.3.1.1.1.1.2.2.2.2.cmml" xref="alg1.l5.m1.3.3.1.1.1.1.2.2.2.2">𝑎</ci><plus id="alg1.l5.m1.3.3.1.1.1.1.2.2.2.3.cmml" xref="alg1.l5.m1.3.3.1.1.1.1.2.2.2.3"></plus></apply></vector><ci id="alg1.l5.m1.3.3.1.1.1.1.4.cmml" xref="alg1.l5.m1.3.3.1.1.1.1.4">𝑖</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m1.3c">p=\text{format}(\text{preamble},(q,a^{-},a^{+})_{i})</annotation><annotation encoding="application/x-llamapun" id="alg1.l5.m1.3d">italic_p = format ( preamble , ( italic_q , italic_a start_POSTSUPERSCRIPT - end_POSTSUPERSCRIPT , italic_a start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT ) start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT )</annotation></semantics></math> <span class="ltx_text" id="alg1.l5.1" style="float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg1.l5.1.m1.1"><semantics id="alg1.l5.1.m1.1a"><mo id="alg1.l5.1.m1.1.1" xref="alg1.l5.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l5.1.m1.1b"><ci id="alg1.l5.1.m1.1.1.cmml" xref="alg1.l5.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg1.l5.1.m1.1d">▷</annotation></semantics></math> Prompt construction with preamble
</span>
</div>
<div class="ltx_listingline" id="alg1.l6">
<span class="ltx_tag ltx_tag_listingline">6:</span>     Get <math alttext="M(p)" class="ltx_Math" display="inline" id="alg1.l6.m1.1"><semantics id="alg1.l6.m1.1a"><mrow id="alg1.l6.m1.1.2" xref="alg1.l6.m1.1.2.cmml"><mi id="alg1.l6.m1.1.2.2" xref="alg1.l6.m1.1.2.2.cmml">M</mi><mo id="alg1.l6.m1.1.2.1" xref="alg1.l6.m1.1.2.1.cmml">⁢</mo><mrow id="alg1.l6.m1.1.2.3.2" xref="alg1.l6.m1.1.2.cmml"><mo id="alg1.l6.m1.1.2.3.2.1" stretchy="false" xref="alg1.l6.m1.1.2.cmml">(</mo><mi id="alg1.l6.m1.1.1" xref="alg1.l6.m1.1.1.cmml">p</mi><mo id="alg1.l6.m1.1.2.3.2.2" stretchy="false" xref="alg1.l6.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l6.m1.1b"><apply id="alg1.l6.m1.1.2.cmml" xref="alg1.l6.m1.1.2"><times id="alg1.l6.m1.1.2.1.cmml" xref="alg1.l6.m1.1.2.1"></times><ci id="alg1.l6.m1.1.2.2.cmml" xref="alg1.l6.m1.1.2.2">𝑀</ci><ci id="alg1.l6.m1.1.1.cmml" xref="alg1.l6.m1.1.1">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m1.1c">M(p)</annotation><annotation encoding="application/x-llamapun" id="alg1.l6.m1.1d">italic_M ( italic_p )</annotation></semantics></math> with repeated sampling <span class="ltx_text" id="alg1.l6.1" style="float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg1.l6.1.m1.1"><semantics id="alg1.l6.1.m1.1a"><mo id="alg1.l6.1.m1.1.1" xref="alg1.l6.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l6.1.m1.1b"><ci id="alg1.l6.1.m1.1.1.cmml" xref="alg1.l6.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg1.l6.1.m1.1d">▷</annotation></semantics></math> Judgment generation with repeated sampling
</span>
</div>
<div class="ltx_listingline" id="alg1.l7">
<span class="ltx_tag ltx_tag_listingline">7:</span>     <math alttext="M(p)^{+},M(p)^{-}\leftarrow\text{filter\_correct}(M(p)),\text{filter\_%
incorrect}(M(p))" class="ltx_Math" display="inline" id="alg1.l7.m1.6"><semantics id="alg1.l7.m1.6a"><mrow id="alg1.l7.m1.6.6.2" xref="alg1.l7.m1.6.6.3.cmml"><mrow id="alg1.l7.m1.5.5.1.1" xref="alg1.l7.m1.5.5.1.1.cmml"><mrow id="alg1.l7.m1.5.5.1.1.2.2" xref="alg1.l7.m1.5.5.1.1.2.3.cmml"><mrow id="alg1.l7.m1.5.5.1.1.1.1.1" xref="alg1.l7.m1.5.5.1.1.1.1.1.cmml"><mi id="alg1.l7.m1.5.5.1.1.1.1.1.2" xref="alg1.l7.m1.5.5.1.1.1.1.1.2.cmml">M</mi><mo id="alg1.l7.m1.5.5.1.1.1.1.1.1" xref="alg1.l7.m1.5.5.1.1.1.1.1.1.cmml">⁢</mo><msup id="alg1.l7.m1.5.5.1.1.1.1.1.3" xref="alg1.l7.m1.5.5.1.1.1.1.1.3.cmml"><mrow id="alg1.l7.m1.5.5.1.1.1.1.1.3.2.2" xref="alg1.l7.m1.5.5.1.1.1.1.1.3.cmml"><mo id="alg1.l7.m1.5.5.1.1.1.1.1.3.2.2.1" stretchy="false" xref="alg1.l7.m1.5.5.1.1.1.1.1.3.cmml">(</mo><mi id="alg1.l7.m1.1.1" xref="alg1.l7.m1.1.1.cmml">p</mi><mo id="alg1.l7.m1.5.5.1.1.1.1.1.3.2.2.2" stretchy="false" xref="alg1.l7.m1.5.5.1.1.1.1.1.3.cmml">)</mo></mrow><mo id="alg1.l7.m1.5.5.1.1.1.1.1.3.3" xref="alg1.l7.m1.5.5.1.1.1.1.1.3.3.cmml">+</mo></msup></mrow><mo id="alg1.l7.m1.5.5.1.1.2.2.3" xref="alg1.l7.m1.5.5.1.1.2.3.cmml">,</mo><mrow id="alg1.l7.m1.5.5.1.1.2.2.2" xref="alg1.l7.m1.5.5.1.1.2.2.2.cmml"><mi id="alg1.l7.m1.5.5.1.1.2.2.2.2" xref="alg1.l7.m1.5.5.1.1.2.2.2.2.cmml">M</mi><mo id="alg1.l7.m1.5.5.1.1.2.2.2.1" xref="alg1.l7.m1.5.5.1.1.2.2.2.1.cmml">⁢</mo><msup id="alg1.l7.m1.5.5.1.1.2.2.2.3" xref="alg1.l7.m1.5.5.1.1.2.2.2.3.cmml"><mrow id="alg1.l7.m1.5.5.1.1.2.2.2.3.2.2" xref="alg1.l7.m1.5.5.1.1.2.2.2.3.cmml"><mo id="alg1.l7.m1.5.5.1.1.2.2.2.3.2.2.1" stretchy="false" xref="alg1.l7.m1.5.5.1.1.2.2.2.3.cmml">(</mo><mi id="alg1.l7.m1.2.2" xref="alg1.l7.m1.2.2.cmml">p</mi><mo id="alg1.l7.m1.5.5.1.1.2.2.2.3.2.2.2" stretchy="false" xref="alg1.l7.m1.5.5.1.1.2.2.2.3.cmml">)</mo></mrow><mo id="alg1.l7.m1.5.5.1.1.2.2.2.3.3" xref="alg1.l7.m1.5.5.1.1.2.2.2.3.3.cmml">−</mo></msup></mrow></mrow><mo id="alg1.l7.m1.5.5.1.1.4" stretchy="false" xref="alg1.l7.m1.5.5.1.1.4.cmml">←</mo><mrow id="alg1.l7.m1.5.5.1.1.3" xref="alg1.l7.m1.5.5.1.1.3.cmml"><mtext id="alg1.l7.m1.5.5.1.1.3.3" xref="alg1.l7.m1.5.5.1.1.3.3a.cmml">filter_correct</mtext><mo id="alg1.l7.m1.5.5.1.1.3.2" xref="alg1.l7.m1.5.5.1.1.3.2.cmml">⁢</mo><mrow id="alg1.l7.m1.5.5.1.1.3.1.1" xref="alg1.l7.m1.5.5.1.1.3.1.1.1.cmml"><mo id="alg1.l7.m1.5.5.1.1.3.1.1.2" stretchy="false" xref="alg1.l7.m1.5.5.1.1.3.1.1.1.cmml">(</mo><mrow id="alg1.l7.m1.5.5.1.1.3.1.1.1" xref="alg1.l7.m1.5.5.1.1.3.1.1.1.cmml"><mi id="alg1.l7.m1.5.5.1.1.3.1.1.1.2" xref="alg1.l7.m1.5.5.1.1.3.1.1.1.2.cmml">M</mi><mo id="alg1.l7.m1.5.5.1.1.3.1.1.1.1" xref="alg1.l7.m1.5.5.1.1.3.1.1.1.1.cmml">⁢</mo><mrow id="alg1.l7.m1.5.5.1.1.3.1.1.1.3.2" xref="alg1.l7.m1.5.5.1.1.3.1.1.1.cmml"><mo id="alg1.l7.m1.5.5.1.1.3.1.1.1.3.2.1" stretchy="false" xref="alg1.l7.m1.5.5.1.1.3.1.1.1.cmml">(</mo><mi id="alg1.l7.m1.3.3" xref="alg1.l7.m1.3.3.cmml">p</mi><mo id="alg1.l7.m1.5.5.1.1.3.1.1.1.3.2.2" stretchy="false" xref="alg1.l7.m1.5.5.1.1.3.1.1.1.cmml">)</mo></mrow></mrow><mo id="alg1.l7.m1.5.5.1.1.3.1.1.3" stretchy="false" xref="alg1.l7.m1.5.5.1.1.3.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="alg1.l7.m1.6.6.2.3" xref="alg1.l7.m1.6.6.3a.cmml">,</mo><mrow id="alg1.l7.m1.6.6.2.2" xref="alg1.l7.m1.6.6.2.2.cmml"><mtext id="alg1.l7.m1.6.6.2.2.3" xref="alg1.l7.m1.6.6.2.2.3a.cmml">filter_incorrect</mtext><mo id="alg1.l7.m1.6.6.2.2.2" xref="alg1.l7.m1.6.6.2.2.2.cmml">⁢</mo><mrow id="alg1.l7.m1.6.6.2.2.1.1" xref="alg1.l7.m1.6.6.2.2.1.1.1.cmml"><mo id="alg1.l7.m1.6.6.2.2.1.1.2" stretchy="false" xref="alg1.l7.m1.6.6.2.2.1.1.1.cmml">(</mo><mrow id="alg1.l7.m1.6.6.2.2.1.1.1" xref="alg1.l7.m1.6.6.2.2.1.1.1.cmml"><mi id="alg1.l7.m1.6.6.2.2.1.1.1.2" xref="alg1.l7.m1.6.6.2.2.1.1.1.2.cmml">M</mi><mo id="alg1.l7.m1.6.6.2.2.1.1.1.1" xref="alg1.l7.m1.6.6.2.2.1.1.1.1.cmml">⁢</mo><mrow id="alg1.l7.m1.6.6.2.2.1.1.1.3.2" xref="alg1.l7.m1.6.6.2.2.1.1.1.cmml"><mo id="alg1.l7.m1.6.6.2.2.1.1.1.3.2.1" stretchy="false" xref="alg1.l7.m1.6.6.2.2.1.1.1.cmml">(</mo><mi id="alg1.l7.m1.4.4" xref="alg1.l7.m1.4.4.cmml">p</mi><mo id="alg1.l7.m1.6.6.2.2.1.1.1.3.2.2" stretchy="false" xref="alg1.l7.m1.6.6.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="alg1.l7.m1.6.6.2.2.1.1.3" stretchy="false" xref="alg1.l7.m1.6.6.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l7.m1.6b"><apply id="alg1.l7.m1.6.6.3.cmml" xref="alg1.l7.m1.6.6.2"><csymbol cd="ambiguous" id="alg1.l7.m1.6.6.3a.cmml" xref="alg1.l7.m1.6.6.2.3">formulae-sequence</csymbol><apply id="alg1.l7.m1.5.5.1.1.cmml" xref="alg1.l7.m1.5.5.1.1"><ci id="alg1.l7.m1.5.5.1.1.4.cmml" xref="alg1.l7.m1.5.5.1.1.4">←</ci><list id="alg1.l7.m1.5.5.1.1.2.3.cmml" xref="alg1.l7.m1.5.5.1.1.2.2"><apply id="alg1.l7.m1.5.5.1.1.1.1.1.cmml" xref="alg1.l7.m1.5.5.1.1.1.1.1"><times id="alg1.l7.m1.5.5.1.1.1.1.1.1.cmml" xref="alg1.l7.m1.5.5.1.1.1.1.1.1"></times><ci id="alg1.l7.m1.5.5.1.1.1.1.1.2.cmml" xref="alg1.l7.m1.5.5.1.1.1.1.1.2">𝑀</ci><apply id="alg1.l7.m1.5.5.1.1.1.1.1.3.cmml" xref="alg1.l7.m1.5.5.1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l7.m1.5.5.1.1.1.1.1.3.1.cmml" xref="alg1.l7.m1.5.5.1.1.1.1.1.3">superscript</csymbol><ci id="alg1.l7.m1.1.1.cmml" xref="alg1.l7.m1.1.1">𝑝</ci><plus id="alg1.l7.m1.5.5.1.1.1.1.1.3.3.cmml" xref="alg1.l7.m1.5.5.1.1.1.1.1.3.3"></plus></apply></apply><apply id="alg1.l7.m1.5.5.1.1.2.2.2.cmml" xref="alg1.l7.m1.5.5.1.1.2.2.2"><times id="alg1.l7.m1.5.5.1.1.2.2.2.1.cmml" xref="alg1.l7.m1.5.5.1.1.2.2.2.1"></times><ci id="alg1.l7.m1.5.5.1.1.2.2.2.2.cmml" xref="alg1.l7.m1.5.5.1.1.2.2.2.2">𝑀</ci><apply id="alg1.l7.m1.5.5.1.1.2.2.2.3.cmml" xref="alg1.l7.m1.5.5.1.1.2.2.2.3"><csymbol cd="ambiguous" id="alg1.l7.m1.5.5.1.1.2.2.2.3.1.cmml" xref="alg1.l7.m1.5.5.1.1.2.2.2.3">superscript</csymbol><ci id="alg1.l7.m1.2.2.cmml" xref="alg1.l7.m1.2.2">𝑝</ci><minus id="alg1.l7.m1.5.5.1.1.2.2.2.3.3.cmml" xref="alg1.l7.m1.5.5.1.1.2.2.2.3.3"></minus></apply></apply></list><apply id="alg1.l7.m1.5.5.1.1.3.cmml" xref="alg1.l7.m1.5.5.1.1.3"><times id="alg1.l7.m1.5.5.1.1.3.2.cmml" xref="alg1.l7.m1.5.5.1.1.3.2"></times><ci id="alg1.l7.m1.5.5.1.1.3.3a.cmml" xref="alg1.l7.m1.5.5.1.1.3.3"><mtext id="alg1.l7.m1.5.5.1.1.3.3.cmml" xref="alg1.l7.m1.5.5.1.1.3.3">filter_correct</mtext></ci><apply id="alg1.l7.m1.5.5.1.1.3.1.1.1.cmml" xref="alg1.l7.m1.5.5.1.1.3.1.1"><times id="alg1.l7.m1.5.5.1.1.3.1.1.1.1.cmml" xref="alg1.l7.m1.5.5.1.1.3.1.1.1.1"></times><ci id="alg1.l7.m1.5.5.1.1.3.1.1.1.2.cmml" xref="alg1.l7.m1.5.5.1.1.3.1.1.1.2">𝑀</ci><ci id="alg1.l7.m1.3.3.cmml" xref="alg1.l7.m1.3.3">𝑝</ci></apply></apply></apply><apply id="alg1.l7.m1.6.6.2.2.cmml" xref="alg1.l7.m1.6.6.2.2"><times id="alg1.l7.m1.6.6.2.2.2.cmml" xref="alg1.l7.m1.6.6.2.2.2"></times><ci id="alg1.l7.m1.6.6.2.2.3a.cmml" xref="alg1.l7.m1.6.6.2.2.3"><mtext id="alg1.l7.m1.6.6.2.2.3.cmml" xref="alg1.l7.m1.6.6.2.2.3">filter_incorrect</mtext></ci><apply id="alg1.l7.m1.6.6.2.2.1.1.1.cmml" xref="alg1.l7.m1.6.6.2.2.1.1"><times id="alg1.l7.m1.6.6.2.2.1.1.1.1.cmml" xref="alg1.l7.m1.6.6.2.2.1.1.1.1"></times><ci id="alg1.l7.m1.6.6.2.2.1.1.1.2.cmml" xref="alg1.l7.m1.6.6.2.2.1.1.1.2">𝑀</ci><ci id="alg1.l7.m1.4.4.cmml" xref="alg1.l7.m1.4.4">𝑝</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m1.6c">M(p)^{+},M(p)^{-}\leftarrow\text{filter\_correct}(M(p)),\text{filter\_%
incorrect}(M(p))</annotation><annotation encoding="application/x-llamapun" id="alg1.l7.m1.6d">italic_M ( italic_p ) start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT , italic_M ( italic_p ) start_POSTSUPERSCRIPT - end_POSTSUPERSCRIPT ← filter_correct ( italic_M ( italic_p ) ) , filter_incorrect ( italic_M ( italic_p ) )</annotation></semantics></math> <span class="ltx_text" id="alg1.l7.1" style="float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg1.l7.1.m1.1"><semantics id="alg1.l7.1.m1.1a"><mo id="alg1.l7.1.m1.1.1" xref="alg1.l7.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l7.1.m1.1b"><ci id="alg1.l7.1.m1.1.1.cmml" xref="alg1.l7.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg1.l7.1.m1.1d">▷</annotation></semantics></math> Selection with ground truth preference
</span>
</div>
<div class="ltx_listingline" id="alg1.l8">
<span class="ltx_tag ltx_tag_listingline">8:</span>     <math alttext="E=E\cup\{(j_{p},j_{n})|j_{p}\in M(p)^{+},j_{n}\in M(p)^{-}\}" class="ltx_Math" display="inline" id="alg1.l8.m1.4"><semantics id="alg1.l8.m1.4a"><mrow id="alg1.l8.m1.4.4" xref="alg1.l8.m1.4.4.cmml"><mi id="alg1.l8.m1.4.4.4" xref="alg1.l8.m1.4.4.4.cmml">E</mi><mo id="alg1.l8.m1.4.4.3" xref="alg1.l8.m1.4.4.3.cmml">=</mo><mrow id="alg1.l8.m1.4.4.2" xref="alg1.l8.m1.4.4.2.cmml"><mi id="alg1.l8.m1.4.4.2.4" xref="alg1.l8.m1.4.4.2.4.cmml">E</mi><mo id="alg1.l8.m1.4.4.2.3" xref="alg1.l8.m1.4.4.2.3.cmml">∪</mo><mrow id="alg1.l8.m1.4.4.2.2.2" xref="alg1.l8.m1.4.4.2.2.3.cmml"><mo id="alg1.l8.m1.4.4.2.2.2.3" stretchy="false" xref="alg1.l8.m1.4.4.2.2.3.1.cmml">{</mo><mrow id="alg1.l8.m1.3.3.1.1.1.1.2" xref="alg1.l8.m1.3.3.1.1.1.1.3.cmml"><mo id="alg1.l8.m1.3.3.1.1.1.1.2.3" stretchy="false" xref="alg1.l8.m1.3.3.1.1.1.1.3.cmml">(</mo><msub id="alg1.l8.m1.3.3.1.1.1.1.1.1" xref="alg1.l8.m1.3.3.1.1.1.1.1.1.cmml"><mi id="alg1.l8.m1.3.3.1.1.1.1.1.1.2" xref="alg1.l8.m1.3.3.1.1.1.1.1.1.2.cmml">j</mi><mi id="alg1.l8.m1.3.3.1.1.1.1.1.1.3" xref="alg1.l8.m1.3.3.1.1.1.1.1.1.3.cmml">p</mi></msub><mo id="alg1.l8.m1.3.3.1.1.1.1.2.4" xref="alg1.l8.m1.3.3.1.1.1.1.3.cmml">,</mo><msub id="alg1.l8.m1.3.3.1.1.1.1.2.2" xref="alg1.l8.m1.3.3.1.1.1.1.2.2.cmml"><mi id="alg1.l8.m1.3.3.1.1.1.1.2.2.2" xref="alg1.l8.m1.3.3.1.1.1.1.2.2.2.cmml">j</mi><mi id="alg1.l8.m1.3.3.1.1.1.1.2.2.3" xref="alg1.l8.m1.3.3.1.1.1.1.2.2.3.cmml">n</mi></msub><mo id="alg1.l8.m1.3.3.1.1.1.1.2.5" stretchy="false" xref="alg1.l8.m1.3.3.1.1.1.1.3.cmml">)</mo></mrow><mo id="alg1.l8.m1.4.4.2.2.2.4" lspace="0em" rspace="0em" xref="alg1.l8.m1.4.4.2.2.3.1.cmml">|</mo><mrow id="alg1.l8.m1.4.4.2.2.2.2.2" xref="alg1.l8.m1.4.4.2.2.2.2.3.cmml"><mrow id="alg1.l8.m1.4.4.2.2.2.2.1.1" xref="alg1.l8.m1.4.4.2.2.2.2.1.1.cmml"><msub id="alg1.l8.m1.4.4.2.2.2.2.1.1.2" xref="alg1.l8.m1.4.4.2.2.2.2.1.1.2.cmml"><mi id="alg1.l8.m1.4.4.2.2.2.2.1.1.2.2" xref="alg1.l8.m1.4.4.2.2.2.2.1.1.2.2.cmml">j</mi><mi id="alg1.l8.m1.4.4.2.2.2.2.1.1.2.3" xref="alg1.l8.m1.4.4.2.2.2.2.1.1.2.3.cmml">p</mi></msub><mo id="alg1.l8.m1.4.4.2.2.2.2.1.1.1" xref="alg1.l8.m1.4.4.2.2.2.2.1.1.1.cmml">∈</mo><mrow id="alg1.l8.m1.4.4.2.2.2.2.1.1.3" xref="alg1.l8.m1.4.4.2.2.2.2.1.1.3.cmml"><mi id="alg1.l8.m1.4.4.2.2.2.2.1.1.3.2" xref="alg1.l8.m1.4.4.2.2.2.2.1.1.3.2.cmml">M</mi><mo id="alg1.l8.m1.4.4.2.2.2.2.1.1.3.1" xref="alg1.l8.m1.4.4.2.2.2.2.1.1.3.1.cmml">⁢</mo><msup id="alg1.l8.m1.4.4.2.2.2.2.1.1.3.3" xref="alg1.l8.m1.4.4.2.2.2.2.1.1.3.3.cmml"><mrow id="alg1.l8.m1.4.4.2.2.2.2.1.1.3.3.2.2" xref="alg1.l8.m1.4.4.2.2.2.2.1.1.3.3.cmml"><mo id="alg1.l8.m1.4.4.2.2.2.2.1.1.3.3.2.2.1" stretchy="false" xref="alg1.l8.m1.4.4.2.2.2.2.1.1.3.3.cmml">(</mo><mi id="alg1.l8.m1.1.1" xref="alg1.l8.m1.1.1.cmml">p</mi><mo id="alg1.l8.m1.4.4.2.2.2.2.1.1.3.3.2.2.2" stretchy="false" xref="alg1.l8.m1.4.4.2.2.2.2.1.1.3.3.cmml">)</mo></mrow><mo id="alg1.l8.m1.4.4.2.2.2.2.1.1.3.3.3" xref="alg1.l8.m1.4.4.2.2.2.2.1.1.3.3.3.cmml">+</mo></msup></mrow></mrow><mo id="alg1.l8.m1.4.4.2.2.2.2.2.3" xref="alg1.l8.m1.4.4.2.2.2.2.3a.cmml">,</mo><mrow id="alg1.l8.m1.4.4.2.2.2.2.2.2" xref="alg1.l8.m1.4.4.2.2.2.2.2.2.cmml"><msub id="alg1.l8.m1.4.4.2.2.2.2.2.2.2" xref="alg1.l8.m1.4.4.2.2.2.2.2.2.2.cmml"><mi id="alg1.l8.m1.4.4.2.2.2.2.2.2.2.2" xref="alg1.l8.m1.4.4.2.2.2.2.2.2.2.2.cmml">j</mi><mi id="alg1.l8.m1.4.4.2.2.2.2.2.2.2.3" xref="alg1.l8.m1.4.4.2.2.2.2.2.2.2.3.cmml">n</mi></msub><mo id="alg1.l8.m1.4.4.2.2.2.2.2.2.1" xref="alg1.l8.m1.4.4.2.2.2.2.2.2.1.cmml">∈</mo><mrow id="alg1.l8.m1.4.4.2.2.2.2.2.2.3" xref="alg1.l8.m1.4.4.2.2.2.2.2.2.3.cmml"><mi id="alg1.l8.m1.4.4.2.2.2.2.2.2.3.2" xref="alg1.l8.m1.4.4.2.2.2.2.2.2.3.2.cmml">M</mi><mo id="alg1.l8.m1.4.4.2.2.2.2.2.2.3.1" xref="alg1.l8.m1.4.4.2.2.2.2.2.2.3.1.cmml">⁢</mo><msup id="alg1.l8.m1.4.4.2.2.2.2.2.2.3.3" xref="alg1.l8.m1.4.4.2.2.2.2.2.2.3.3.cmml"><mrow id="alg1.l8.m1.4.4.2.2.2.2.2.2.3.3.2.2" xref="alg1.l8.m1.4.4.2.2.2.2.2.2.3.3.cmml"><mo id="alg1.l8.m1.4.4.2.2.2.2.2.2.3.3.2.2.1" stretchy="false" xref="alg1.l8.m1.4.4.2.2.2.2.2.2.3.3.cmml">(</mo><mi id="alg1.l8.m1.2.2" xref="alg1.l8.m1.2.2.cmml">p</mi><mo id="alg1.l8.m1.4.4.2.2.2.2.2.2.3.3.2.2.2" stretchy="false" xref="alg1.l8.m1.4.4.2.2.2.2.2.2.3.3.cmml">)</mo></mrow><mo id="alg1.l8.m1.4.4.2.2.2.2.2.2.3.3.3" xref="alg1.l8.m1.4.4.2.2.2.2.2.2.3.3.3.cmml">−</mo></msup></mrow></mrow></mrow><mo id="alg1.l8.m1.4.4.2.2.2.5" stretchy="false" xref="alg1.l8.m1.4.4.2.2.3.1.cmml">}</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l8.m1.4b"><apply id="alg1.l8.m1.4.4.cmml" xref="alg1.l8.m1.4.4"><eq id="alg1.l8.m1.4.4.3.cmml" xref="alg1.l8.m1.4.4.3"></eq><ci id="alg1.l8.m1.4.4.4.cmml" xref="alg1.l8.m1.4.4.4">𝐸</ci><apply id="alg1.l8.m1.4.4.2.cmml" xref="alg1.l8.m1.4.4.2"><union id="alg1.l8.m1.4.4.2.3.cmml" xref="alg1.l8.m1.4.4.2.3"></union><ci id="alg1.l8.m1.4.4.2.4.cmml" xref="alg1.l8.m1.4.4.2.4">𝐸</ci><apply id="alg1.l8.m1.4.4.2.2.3.cmml" xref="alg1.l8.m1.4.4.2.2.2"><csymbol cd="latexml" id="alg1.l8.m1.4.4.2.2.3.1.cmml" xref="alg1.l8.m1.4.4.2.2.2.3">conditional-set</csymbol><interval closure="open" id="alg1.l8.m1.3.3.1.1.1.1.3.cmml" xref="alg1.l8.m1.3.3.1.1.1.1.2"><apply id="alg1.l8.m1.3.3.1.1.1.1.1.1.cmml" xref="alg1.l8.m1.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l8.m1.3.3.1.1.1.1.1.1.1.cmml" xref="alg1.l8.m1.3.3.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l8.m1.3.3.1.1.1.1.1.1.2.cmml" xref="alg1.l8.m1.3.3.1.1.1.1.1.1.2">𝑗</ci><ci id="alg1.l8.m1.3.3.1.1.1.1.1.1.3.cmml" xref="alg1.l8.m1.3.3.1.1.1.1.1.1.3">𝑝</ci></apply><apply id="alg1.l8.m1.3.3.1.1.1.1.2.2.cmml" xref="alg1.l8.m1.3.3.1.1.1.1.2.2"><csymbol cd="ambiguous" id="alg1.l8.m1.3.3.1.1.1.1.2.2.1.cmml" xref="alg1.l8.m1.3.3.1.1.1.1.2.2">subscript</csymbol><ci id="alg1.l8.m1.3.3.1.1.1.1.2.2.2.cmml" xref="alg1.l8.m1.3.3.1.1.1.1.2.2.2">𝑗</ci><ci id="alg1.l8.m1.3.3.1.1.1.1.2.2.3.cmml" xref="alg1.l8.m1.3.3.1.1.1.1.2.2.3">𝑛</ci></apply></interval><apply id="alg1.l8.m1.4.4.2.2.2.2.3.cmml" xref="alg1.l8.m1.4.4.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l8.m1.4.4.2.2.2.2.3a.cmml" xref="alg1.l8.m1.4.4.2.2.2.2.2.3">formulae-sequence</csymbol><apply id="alg1.l8.m1.4.4.2.2.2.2.1.1.cmml" xref="alg1.l8.m1.4.4.2.2.2.2.1.1"><in id="alg1.l8.m1.4.4.2.2.2.2.1.1.1.cmml" xref="alg1.l8.m1.4.4.2.2.2.2.1.1.1"></in><apply id="alg1.l8.m1.4.4.2.2.2.2.1.1.2.cmml" xref="alg1.l8.m1.4.4.2.2.2.2.1.1.2"><csymbol cd="ambiguous" id="alg1.l8.m1.4.4.2.2.2.2.1.1.2.1.cmml" xref="alg1.l8.m1.4.4.2.2.2.2.1.1.2">subscript</csymbol><ci id="alg1.l8.m1.4.4.2.2.2.2.1.1.2.2.cmml" xref="alg1.l8.m1.4.4.2.2.2.2.1.1.2.2">𝑗</ci><ci id="alg1.l8.m1.4.4.2.2.2.2.1.1.2.3.cmml" xref="alg1.l8.m1.4.4.2.2.2.2.1.1.2.3">𝑝</ci></apply><apply id="alg1.l8.m1.4.4.2.2.2.2.1.1.3.cmml" xref="alg1.l8.m1.4.4.2.2.2.2.1.1.3"><times id="alg1.l8.m1.4.4.2.2.2.2.1.1.3.1.cmml" xref="alg1.l8.m1.4.4.2.2.2.2.1.1.3.1"></times><ci id="alg1.l8.m1.4.4.2.2.2.2.1.1.3.2.cmml" xref="alg1.l8.m1.4.4.2.2.2.2.1.1.3.2">𝑀</ci><apply id="alg1.l8.m1.4.4.2.2.2.2.1.1.3.3.cmml" xref="alg1.l8.m1.4.4.2.2.2.2.1.1.3.3"><csymbol cd="ambiguous" id="alg1.l8.m1.4.4.2.2.2.2.1.1.3.3.1.cmml" xref="alg1.l8.m1.4.4.2.2.2.2.1.1.3.3">superscript</csymbol><ci id="alg1.l8.m1.1.1.cmml" xref="alg1.l8.m1.1.1">𝑝</ci><plus id="alg1.l8.m1.4.4.2.2.2.2.1.1.3.3.3.cmml" xref="alg1.l8.m1.4.4.2.2.2.2.1.1.3.3.3"></plus></apply></apply></apply><apply id="alg1.l8.m1.4.4.2.2.2.2.2.2.cmml" xref="alg1.l8.m1.4.4.2.2.2.2.2.2"><in id="alg1.l8.m1.4.4.2.2.2.2.2.2.1.cmml" xref="alg1.l8.m1.4.4.2.2.2.2.2.2.1"></in><apply id="alg1.l8.m1.4.4.2.2.2.2.2.2.2.cmml" xref="alg1.l8.m1.4.4.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l8.m1.4.4.2.2.2.2.2.2.2.1.cmml" xref="alg1.l8.m1.4.4.2.2.2.2.2.2.2">subscript</csymbol><ci id="alg1.l8.m1.4.4.2.2.2.2.2.2.2.2.cmml" xref="alg1.l8.m1.4.4.2.2.2.2.2.2.2.2">𝑗</ci><ci id="alg1.l8.m1.4.4.2.2.2.2.2.2.2.3.cmml" xref="alg1.l8.m1.4.4.2.2.2.2.2.2.2.3">𝑛</ci></apply><apply id="alg1.l8.m1.4.4.2.2.2.2.2.2.3.cmml" xref="alg1.l8.m1.4.4.2.2.2.2.2.2.3"><times id="alg1.l8.m1.4.4.2.2.2.2.2.2.3.1.cmml" xref="alg1.l8.m1.4.4.2.2.2.2.2.2.3.1"></times><ci id="alg1.l8.m1.4.4.2.2.2.2.2.2.3.2.cmml" xref="alg1.l8.m1.4.4.2.2.2.2.2.2.3.2">𝑀</ci><apply id="alg1.l8.m1.4.4.2.2.2.2.2.2.3.3.cmml" xref="alg1.l8.m1.4.4.2.2.2.2.2.2.3.3"><csymbol cd="ambiguous" id="alg1.l8.m1.4.4.2.2.2.2.2.2.3.3.1.cmml" xref="alg1.l8.m1.4.4.2.2.2.2.2.2.3.3">superscript</csymbol><ci id="alg1.l8.m1.2.2.cmml" xref="alg1.l8.m1.2.2">𝑝</ci><minus id="alg1.l8.m1.4.4.2.2.2.2.2.2.3.3.3.cmml" xref="alg1.l8.m1.4.4.2.2.2.2.2.2.3.3.3"></minus></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m1.4c">E=E\cup\{(j_{p},j_{n})|j_{p}\in M(p)^{+},j_{n}\in M(p)^{-}\}</annotation><annotation encoding="application/x-llamapun" id="alg1.l8.m1.4d">italic_E = italic_E ∪ { ( italic_j start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT , italic_j start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT ) | italic_j start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ∈ italic_M ( italic_p ) start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT , italic_j start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT ∈ italic_M ( italic_p ) start_POSTSUPERSCRIPT - end_POSTSUPERSCRIPT }</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l9">
<span class="ltx_tag ltx_tag_listingline">9:</span>     <math alttext="p_{p},p_{n}=\text{format}(\text{preamble\_correct},(x,a^{-},a^{+})_{i}),\text{%
format}(\text{preamble\_incorrect},(x,a^{-},a^{+})_{i})" class="ltx_Math" display="inline" id="alg1.l9.m1.6"><semantics id="alg1.l9.m1.6a"><mrow id="alg1.l9.m1.6.6.2" xref="alg1.l9.m1.6.6.3.cmml"><mrow id="alg1.l9.m1.5.5.1.1" xref="alg1.l9.m1.5.5.1.1.cmml"><mrow id="alg1.l9.m1.5.5.1.1.2.2" xref="alg1.l9.m1.5.5.1.1.2.3.cmml"><msub id="alg1.l9.m1.5.5.1.1.1.1.1" xref="alg1.l9.m1.5.5.1.1.1.1.1.cmml"><mi id="alg1.l9.m1.5.5.1.1.1.1.1.2" xref="alg1.l9.m1.5.5.1.1.1.1.1.2.cmml">p</mi><mi id="alg1.l9.m1.5.5.1.1.1.1.1.3" xref="alg1.l9.m1.5.5.1.1.1.1.1.3.cmml">p</mi></msub><mo id="alg1.l9.m1.5.5.1.1.2.2.3" xref="alg1.l9.m1.5.5.1.1.2.3.cmml">,</mo><msub id="alg1.l9.m1.5.5.1.1.2.2.2" xref="alg1.l9.m1.5.5.1.1.2.2.2.cmml"><mi id="alg1.l9.m1.5.5.1.1.2.2.2.2" xref="alg1.l9.m1.5.5.1.1.2.2.2.2.cmml">p</mi><mi id="alg1.l9.m1.5.5.1.1.2.2.2.3" xref="alg1.l9.m1.5.5.1.1.2.2.2.3.cmml">n</mi></msub></mrow><mo id="alg1.l9.m1.5.5.1.1.4" xref="alg1.l9.m1.5.5.1.1.4.cmml">=</mo><mrow id="alg1.l9.m1.5.5.1.1.3" xref="alg1.l9.m1.5.5.1.1.3.cmml"><mtext id="alg1.l9.m1.5.5.1.1.3.3" xref="alg1.l9.m1.5.5.1.1.3.3a.cmml">format</mtext><mo id="alg1.l9.m1.5.5.1.1.3.2" xref="alg1.l9.m1.5.5.1.1.3.2.cmml">⁢</mo><mrow id="alg1.l9.m1.5.5.1.1.3.1.1" xref="alg1.l9.m1.5.5.1.1.3.1.2.cmml"><mo id="alg1.l9.m1.5.5.1.1.3.1.1.2" stretchy="false" xref="alg1.l9.m1.5.5.1.1.3.1.2.cmml">(</mo><mtext id="alg1.l9.m1.2.2" xref="alg1.l9.m1.2.2a.cmml">preamble_correct</mtext><mo id="alg1.l9.m1.5.5.1.1.3.1.1.3" xref="alg1.l9.m1.5.5.1.1.3.1.2.cmml">,</mo><msub id="alg1.l9.m1.5.5.1.1.3.1.1.1" xref="alg1.l9.m1.5.5.1.1.3.1.1.1.cmml"><mrow id="alg1.l9.m1.5.5.1.1.3.1.1.1.2.2" xref="alg1.l9.m1.5.5.1.1.3.1.1.1.2.3.cmml"><mo id="alg1.l9.m1.5.5.1.1.3.1.1.1.2.2.3" stretchy="false" xref="alg1.l9.m1.5.5.1.1.3.1.1.1.2.3.cmml">(</mo><mi id="alg1.l9.m1.1.1" xref="alg1.l9.m1.1.1.cmml">x</mi><mo id="alg1.l9.m1.5.5.1.1.3.1.1.1.2.2.4" xref="alg1.l9.m1.5.5.1.1.3.1.1.1.2.3.cmml">,</mo><msup id="alg1.l9.m1.5.5.1.1.3.1.1.1.1.1.1" xref="alg1.l9.m1.5.5.1.1.3.1.1.1.1.1.1.cmml"><mi id="alg1.l9.m1.5.5.1.1.3.1.1.1.1.1.1.2" xref="alg1.l9.m1.5.5.1.1.3.1.1.1.1.1.1.2.cmml">a</mi><mo id="alg1.l9.m1.5.5.1.1.3.1.1.1.1.1.1.3" xref="alg1.l9.m1.5.5.1.1.3.1.1.1.1.1.1.3.cmml">−</mo></msup><mo id="alg1.l9.m1.5.5.1.1.3.1.1.1.2.2.5" xref="alg1.l9.m1.5.5.1.1.3.1.1.1.2.3.cmml">,</mo><msup id="alg1.l9.m1.5.5.1.1.3.1.1.1.2.2.2" xref="alg1.l9.m1.5.5.1.1.3.1.1.1.2.2.2.cmml"><mi id="alg1.l9.m1.5.5.1.1.3.1.1.1.2.2.2.2" xref="alg1.l9.m1.5.5.1.1.3.1.1.1.2.2.2.2.cmml">a</mi><mo id="alg1.l9.m1.5.5.1.1.3.1.1.1.2.2.2.3" xref="alg1.l9.m1.5.5.1.1.3.1.1.1.2.2.2.3.cmml">+</mo></msup><mo id="alg1.l9.m1.5.5.1.1.3.1.1.1.2.2.6" stretchy="false" xref="alg1.l9.m1.5.5.1.1.3.1.1.1.2.3.cmml">)</mo></mrow><mi id="alg1.l9.m1.5.5.1.1.3.1.1.1.4" xref="alg1.l9.m1.5.5.1.1.3.1.1.1.4.cmml">i</mi></msub><mo id="alg1.l9.m1.5.5.1.1.3.1.1.4" stretchy="false" xref="alg1.l9.m1.5.5.1.1.3.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="alg1.l9.m1.6.6.2.3" xref="alg1.l9.m1.6.6.3a.cmml">,</mo><mrow id="alg1.l9.m1.6.6.2.2" xref="alg1.l9.m1.6.6.2.2.cmml"><mtext id="alg1.l9.m1.6.6.2.2.3" xref="alg1.l9.m1.6.6.2.2.3a.cmml">format</mtext><mo id="alg1.l9.m1.6.6.2.2.2" xref="alg1.l9.m1.6.6.2.2.2.cmml">⁢</mo><mrow id="alg1.l9.m1.6.6.2.2.1.1" xref="alg1.l9.m1.6.6.2.2.1.2.cmml"><mo id="alg1.l9.m1.6.6.2.2.1.1.2" stretchy="false" xref="alg1.l9.m1.6.6.2.2.1.2.cmml">(</mo><mtext id="alg1.l9.m1.4.4" xref="alg1.l9.m1.4.4a.cmml">preamble_incorrect</mtext><mo id="alg1.l9.m1.6.6.2.2.1.1.3" xref="alg1.l9.m1.6.6.2.2.1.2.cmml">,</mo><msub id="alg1.l9.m1.6.6.2.2.1.1.1" xref="alg1.l9.m1.6.6.2.2.1.1.1.cmml"><mrow id="alg1.l9.m1.6.6.2.2.1.1.1.2.2" xref="alg1.l9.m1.6.6.2.2.1.1.1.2.3.cmml"><mo id="alg1.l9.m1.6.6.2.2.1.1.1.2.2.3" stretchy="false" xref="alg1.l9.m1.6.6.2.2.1.1.1.2.3.cmml">(</mo><mi id="alg1.l9.m1.3.3" xref="alg1.l9.m1.3.3.cmml">x</mi><mo id="alg1.l9.m1.6.6.2.2.1.1.1.2.2.4" xref="alg1.l9.m1.6.6.2.2.1.1.1.2.3.cmml">,</mo><msup id="alg1.l9.m1.6.6.2.2.1.1.1.1.1.1" xref="alg1.l9.m1.6.6.2.2.1.1.1.1.1.1.cmml"><mi id="alg1.l9.m1.6.6.2.2.1.1.1.1.1.1.2" xref="alg1.l9.m1.6.6.2.2.1.1.1.1.1.1.2.cmml">a</mi><mo id="alg1.l9.m1.6.6.2.2.1.1.1.1.1.1.3" xref="alg1.l9.m1.6.6.2.2.1.1.1.1.1.1.3.cmml">−</mo></msup><mo id="alg1.l9.m1.6.6.2.2.1.1.1.2.2.5" xref="alg1.l9.m1.6.6.2.2.1.1.1.2.3.cmml">,</mo><msup id="alg1.l9.m1.6.6.2.2.1.1.1.2.2.2" xref="alg1.l9.m1.6.6.2.2.1.1.1.2.2.2.cmml"><mi id="alg1.l9.m1.6.6.2.2.1.1.1.2.2.2.2" xref="alg1.l9.m1.6.6.2.2.1.1.1.2.2.2.2.cmml">a</mi><mo id="alg1.l9.m1.6.6.2.2.1.1.1.2.2.2.3" xref="alg1.l9.m1.6.6.2.2.1.1.1.2.2.2.3.cmml">+</mo></msup><mo id="alg1.l9.m1.6.6.2.2.1.1.1.2.2.6" stretchy="false" xref="alg1.l9.m1.6.6.2.2.1.1.1.2.3.cmml">)</mo></mrow><mi id="alg1.l9.m1.6.6.2.2.1.1.1.4" xref="alg1.l9.m1.6.6.2.2.1.1.1.4.cmml">i</mi></msub><mo id="alg1.l9.m1.6.6.2.2.1.1.4" stretchy="false" xref="alg1.l9.m1.6.6.2.2.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l9.m1.6b"><apply id="alg1.l9.m1.6.6.3.cmml" xref="alg1.l9.m1.6.6.2"><csymbol cd="ambiguous" id="alg1.l9.m1.6.6.3a.cmml" xref="alg1.l9.m1.6.6.2.3">formulae-sequence</csymbol><apply id="alg1.l9.m1.5.5.1.1.cmml" xref="alg1.l9.m1.5.5.1.1"><eq id="alg1.l9.m1.5.5.1.1.4.cmml" xref="alg1.l9.m1.5.5.1.1.4"></eq><list id="alg1.l9.m1.5.5.1.1.2.3.cmml" xref="alg1.l9.m1.5.5.1.1.2.2"><apply id="alg1.l9.m1.5.5.1.1.1.1.1.cmml" xref="alg1.l9.m1.5.5.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l9.m1.5.5.1.1.1.1.1.1.cmml" xref="alg1.l9.m1.5.5.1.1.1.1.1">subscript</csymbol><ci id="alg1.l9.m1.5.5.1.1.1.1.1.2.cmml" xref="alg1.l9.m1.5.5.1.1.1.1.1.2">𝑝</ci><ci id="alg1.l9.m1.5.5.1.1.1.1.1.3.cmml" xref="alg1.l9.m1.5.5.1.1.1.1.1.3">𝑝</ci></apply><apply id="alg1.l9.m1.5.5.1.1.2.2.2.cmml" xref="alg1.l9.m1.5.5.1.1.2.2.2"><csymbol cd="ambiguous" id="alg1.l9.m1.5.5.1.1.2.2.2.1.cmml" xref="alg1.l9.m1.5.5.1.1.2.2.2">subscript</csymbol><ci id="alg1.l9.m1.5.5.1.1.2.2.2.2.cmml" xref="alg1.l9.m1.5.5.1.1.2.2.2.2">𝑝</ci><ci id="alg1.l9.m1.5.5.1.1.2.2.2.3.cmml" xref="alg1.l9.m1.5.5.1.1.2.2.2.3">𝑛</ci></apply></list><apply id="alg1.l9.m1.5.5.1.1.3.cmml" xref="alg1.l9.m1.5.5.1.1.3"><times id="alg1.l9.m1.5.5.1.1.3.2.cmml" xref="alg1.l9.m1.5.5.1.1.3.2"></times><ci id="alg1.l9.m1.5.5.1.1.3.3a.cmml" xref="alg1.l9.m1.5.5.1.1.3.3"><mtext id="alg1.l9.m1.5.5.1.1.3.3.cmml" xref="alg1.l9.m1.5.5.1.1.3.3">format</mtext></ci><interval closure="open" id="alg1.l9.m1.5.5.1.1.3.1.2.cmml" xref="alg1.l9.m1.5.5.1.1.3.1.1"><ci id="alg1.l9.m1.2.2a.cmml" xref="alg1.l9.m1.2.2"><mtext id="alg1.l9.m1.2.2.cmml" xref="alg1.l9.m1.2.2">preamble_correct</mtext></ci><apply id="alg1.l9.m1.5.5.1.1.3.1.1.1.cmml" xref="alg1.l9.m1.5.5.1.1.3.1.1.1"><csymbol cd="ambiguous" id="alg1.l9.m1.5.5.1.1.3.1.1.1.3.cmml" xref="alg1.l9.m1.5.5.1.1.3.1.1.1">subscript</csymbol><vector id="alg1.l9.m1.5.5.1.1.3.1.1.1.2.3.cmml" xref="alg1.l9.m1.5.5.1.1.3.1.1.1.2.2"><ci id="alg1.l9.m1.1.1.cmml" xref="alg1.l9.m1.1.1">𝑥</ci><apply id="alg1.l9.m1.5.5.1.1.3.1.1.1.1.1.1.cmml" xref="alg1.l9.m1.5.5.1.1.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l9.m1.5.5.1.1.3.1.1.1.1.1.1.1.cmml" xref="alg1.l9.m1.5.5.1.1.3.1.1.1.1.1.1">superscript</csymbol><ci id="alg1.l9.m1.5.5.1.1.3.1.1.1.1.1.1.2.cmml" xref="alg1.l9.m1.5.5.1.1.3.1.1.1.1.1.1.2">𝑎</ci><minus id="alg1.l9.m1.5.5.1.1.3.1.1.1.1.1.1.3.cmml" xref="alg1.l9.m1.5.5.1.1.3.1.1.1.1.1.1.3"></minus></apply><apply id="alg1.l9.m1.5.5.1.1.3.1.1.1.2.2.2.cmml" xref="alg1.l9.m1.5.5.1.1.3.1.1.1.2.2.2"><csymbol cd="ambiguous" id="alg1.l9.m1.5.5.1.1.3.1.1.1.2.2.2.1.cmml" xref="alg1.l9.m1.5.5.1.1.3.1.1.1.2.2.2">superscript</csymbol><ci id="alg1.l9.m1.5.5.1.1.3.1.1.1.2.2.2.2.cmml" xref="alg1.l9.m1.5.5.1.1.3.1.1.1.2.2.2.2">𝑎</ci><plus id="alg1.l9.m1.5.5.1.1.3.1.1.1.2.2.2.3.cmml" xref="alg1.l9.m1.5.5.1.1.3.1.1.1.2.2.2.3"></plus></apply></vector><ci id="alg1.l9.m1.5.5.1.1.3.1.1.1.4.cmml" xref="alg1.l9.m1.5.5.1.1.3.1.1.1.4">𝑖</ci></apply></interval></apply></apply><apply id="alg1.l9.m1.6.6.2.2.cmml" xref="alg1.l9.m1.6.6.2.2"><times id="alg1.l9.m1.6.6.2.2.2.cmml" xref="alg1.l9.m1.6.6.2.2.2"></times><ci id="alg1.l9.m1.6.6.2.2.3a.cmml" xref="alg1.l9.m1.6.6.2.2.3"><mtext id="alg1.l9.m1.6.6.2.2.3.cmml" xref="alg1.l9.m1.6.6.2.2.3">format</mtext></ci><interval closure="open" id="alg1.l9.m1.6.6.2.2.1.2.cmml" xref="alg1.l9.m1.6.6.2.2.1.1"><ci id="alg1.l9.m1.4.4a.cmml" xref="alg1.l9.m1.4.4"><mtext id="alg1.l9.m1.4.4.cmml" xref="alg1.l9.m1.4.4">preamble_incorrect</mtext></ci><apply id="alg1.l9.m1.6.6.2.2.1.1.1.cmml" xref="alg1.l9.m1.6.6.2.2.1.1.1"><csymbol cd="ambiguous" id="alg1.l9.m1.6.6.2.2.1.1.1.3.cmml" xref="alg1.l9.m1.6.6.2.2.1.1.1">subscript</csymbol><vector id="alg1.l9.m1.6.6.2.2.1.1.1.2.3.cmml" xref="alg1.l9.m1.6.6.2.2.1.1.1.2.2"><ci id="alg1.l9.m1.3.3.cmml" xref="alg1.l9.m1.3.3">𝑥</ci><apply id="alg1.l9.m1.6.6.2.2.1.1.1.1.1.1.cmml" xref="alg1.l9.m1.6.6.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l9.m1.6.6.2.2.1.1.1.1.1.1.1.cmml" xref="alg1.l9.m1.6.6.2.2.1.1.1.1.1.1">superscript</csymbol><ci id="alg1.l9.m1.6.6.2.2.1.1.1.1.1.1.2.cmml" xref="alg1.l9.m1.6.6.2.2.1.1.1.1.1.1.2">𝑎</ci><minus id="alg1.l9.m1.6.6.2.2.1.1.1.1.1.1.3.cmml" xref="alg1.l9.m1.6.6.2.2.1.1.1.1.1.1.3"></minus></apply><apply id="alg1.l9.m1.6.6.2.2.1.1.1.2.2.2.cmml" xref="alg1.l9.m1.6.6.2.2.1.1.1.2.2.2"><csymbol cd="ambiguous" id="alg1.l9.m1.6.6.2.2.1.1.1.2.2.2.1.cmml" xref="alg1.l9.m1.6.6.2.2.1.1.1.2.2.2">superscript</csymbol><ci id="alg1.l9.m1.6.6.2.2.1.1.1.2.2.2.2.cmml" xref="alg1.l9.m1.6.6.2.2.1.1.1.2.2.2.2">𝑎</ci><plus id="alg1.l9.m1.6.6.2.2.1.1.1.2.2.2.3.cmml" xref="alg1.l9.m1.6.6.2.2.1.1.1.2.2.2.3"></plus></apply></vector><ci id="alg1.l9.m1.6.6.2.2.1.1.1.4.cmml" xref="alg1.l9.m1.6.6.2.2.1.1.1.4">𝑖</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m1.6c">p_{p},p_{n}=\text{format}(\text{preamble\_correct},(x,a^{-},a^{+})_{i}),\text{%
format}(\text{preamble\_incorrect},(x,a^{-},a^{+})_{i})</annotation><annotation encoding="application/x-llamapun" id="alg1.l9.m1.6d">italic_p start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT , italic_p start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT = format ( preamble_correct , ( italic_x , italic_a start_POSTSUPERSCRIPT - end_POSTSUPERSCRIPT , italic_a start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT ) start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) , format ( preamble_incorrect , ( italic_x , italic_a start_POSTSUPERSCRIPT - end_POSTSUPERSCRIPT , italic_a start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT ) start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT )</annotation></semantics></math> <span class="ltx_text" id="alg1.l9.1" style="float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg1.l9.1.m1.1"><semantics id="alg1.l9.1.m1.1a"><mo id="alg1.l9.1.m1.1.1" xref="alg1.l9.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l9.1.m1.1b"><ci id="alg1.l9.1.m1.1.1.cmml" xref="alg1.l9.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg1.l9.1.m1.1d">▷</annotation></semantics></math> Using preamble with correct or incorrect hint to construct prompt
</span>
</div>
<div class="ltx_listingline" id="alg1.l10">
<span class="ltx_tag ltx_tag_listingline">10:</span>     Get <math alttext="{M(p_{p})}" class="ltx_Math" display="inline" id="alg1.l10.m1.1"><semantics id="alg1.l10.m1.1a"><mrow id="alg1.l10.m1.1.1" xref="alg1.l10.m1.1.1.cmml"><mi id="alg1.l10.m1.1.1.3" xref="alg1.l10.m1.1.1.3.cmml">M</mi><mo id="alg1.l10.m1.1.1.2" xref="alg1.l10.m1.1.1.2.cmml">⁢</mo><mrow id="alg1.l10.m1.1.1.1.1" xref="alg1.l10.m1.1.1.1.1.1.cmml"><mo id="alg1.l10.m1.1.1.1.1.2" stretchy="false" xref="alg1.l10.m1.1.1.1.1.1.cmml">(</mo><msub id="alg1.l10.m1.1.1.1.1.1" xref="alg1.l10.m1.1.1.1.1.1.cmml"><mi id="alg1.l10.m1.1.1.1.1.1.2" xref="alg1.l10.m1.1.1.1.1.1.2.cmml">p</mi><mi id="alg1.l10.m1.1.1.1.1.1.3" xref="alg1.l10.m1.1.1.1.1.1.3.cmml">p</mi></msub><mo id="alg1.l10.m1.1.1.1.1.3" stretchy="false" xref="alg1.l10.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l10.m1.1b"><apply id="alg1.l10.m1.1.1.cmml" xref="alg1.l10.m1.1.1"><times id="alg1.l10.m1.1.1.2.cmml" xref="alg1.l10.m1.1.1.2"></times><ci id="alg1.l10.m1.1.1.3.cmml" xref="alg1.l10.m1.1.1.3">𝑀</ci><apply id="alg1.l10.m1.1.1.1.1.1.cmml" xref="alg1.l10.m1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l10.m1.1.1.1.1.1.1.cmml" xref="alg1.l10.m1.1.1.1.1">subscript</csymbol><ci id="alg1.l10.m1.1.1.1.1.1.2.cmml" xref="alg1.l10.m1.1.1.1.1.1.2">𝑝</ci><ci id="alg1.l10.m1.1.1.1.1.1.3.cmml" xref="alg1.l10.m1.1.1.1.1.1.3">𝑝</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m1.1c">{M(p_{p})}</annotation><annotation encoding="application/x-llamapun" id="alg1.l10.m1.1d">italic_M ( italic_p start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT )</annotation></semantics></math>,<math alttext="{M(p_{n})}" class="ltx_Math" display="inline" id="alg1.l10.m2.1"><semantics id="alg1.l10.m2.1a"><mrow id="alg1.l10.m2.1.1" xref="alg1.l10.m2.1.1.cmml"><mi id="alg1.l10.m2.1.1.3" xref="alg1.l10.m2.1.1.3.cmml">M</mi><mo id="alg1.l10.m2.1.1.2" xref="alg1.l10.m2.1.1.2.cmml">⁢</mo><mrow id="alg1.l10.m2.1.1.1.1" xref="alg1.l10.m2.1.1.1.1.1.cmml"><mo id="alg1.l10.m2.1.1.1.1.2" stretchy="false" xref="alg1.l10.m2.1.1.1.1.1.cmml">(</mo><msub id="alg1.l10.m2.1.1.1.1.1" xref="alg1.l10.m2.1.1.1.1.1.cmml"><mi id="alg1.l10.m2.1.1.1.1.1.2" xref="alg1.l10.m2.1.1.1.1.1.2.cmml">p</mi><mi id="alg1.l10.m2.1.1.1.1.1.3" xref="alg1.l10.m2.1.1.1.1.1.3.cmml">n</mi></msub><mo id="alg1.l10.m2.1.1.1.1.3" stretchy="false" xref="alg1.l10.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l10.m2.1b"><apply id="alg1.l10.m2.1.1.cmml" xref="alg1.l10.m2.1.1"><times id="alg1.l10.m2.1.1.2.cmml" xref="alg1.l10.m2.1.1.2"></times><ci id="alg1.l10.m2.1.1.3.cmml" xref="alg1.l10.m2.1.1.3">𝑀</ci><apply id="alg1.l10.m2.1.1.1.1.1.cmml" xref="alg1.l10.m2.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l10.m2.1.1.1.1.1.1.cmml" xref="alg1.l10.m2.1.1.1.1">subscript</csymbol><ci id="alg1.l10.m2.1.1.1.1.1.2.cmml" xref="alg1.l10.m2.1.1.1.1.1.2">𝑝</ci><ci id="alg1.l10.m2.1.1.1.1.1.3.cmml" xref="alg1.l10.m2.1.1.1.1.1.3">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m2.1c">{M(p_{n})}</annotation><annotation encoding="application/x-llamapun" id="alg1.l10.m2.1d">italic_M ( italic_p start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT )</annotation></semantics></math> with hint-driven sampling

</div>
<div class="ltx_listingline" id="alg1.l11">
<span class="ltx_tag ltx_tag_listingline">11:</span>     <math alttext="E=E\cup\{(j_{p},j_{n})|j_{p}\in M(p_{p}),j_{n}\in M(p_{n})\}" class="ltx_Math" display="inline" id="alg1.l11.m1.2"><semantics id="alg1.l11.m1.2a"><mrow id="alg1.l11.m1.2.2" xref="alg1.l11.m1.2.2.cmml"><mi id="alg1.l11.m1.2.2.4" xref="alg1.l11.m1.2.2.4.cmml">E</mi><mo id="alg1.l11.m1.2.2.3" xref="alg1.l11.m1.2.2.3.cmml">=</mo><mrow id="alg1.l11.m1.2.2.2" xref="alg1.l11.m1.2.2.2.cmml"><mi id="alg1.l11.m1.2.2.2.4" xref="alg1.l11.m1.2.2.2.4.cmml">E</mi><mo id="alg1.l11.m1.2.2.2.3" xref="alg1.l11.m1.2.2.2.3.cmml">∪</mo><mrow id="alg1.l11.m1.2.2.2.2.2" xref="alg1.l11.m1.2.2.2.2.3.cmml"><mo id="alg1.l11.m1.2.2.2.2.2.3" stretchy="false" xref="alg1.l11.m1.2.2.2.2.3.1.cmml">{</mo><mrow id="alg1.l11.m1.1.1.1.1.1.1.2" xref="alg1.l11.m1.1.1.1.1.1.1.3.cmml"><mo id="alg1.l11.m1.1.1.1.1.1.1.2.3" stretchy="false" xref="alg1.l11.m1.1.1.1.1.1.1.3.cmml">(</mo><msub id="alg1.l11.m1.1.1.1.1.1.1.1.1" xref="alg1.l11.m1.1.1.1.1.1.1.1.1.cmml"><mi id="alg1.l11.m1.1.1.1.1.1.1.1.1.2" xref="alg1.l11.m1.1.1.1.1.1.1.1.1.2.cmml">j</mi><mi id="alg1.l11.m1.1.1.1.1.1.1.1.1.3" xref="alg1.l11.m1.1.1.1.1.1.1.1.1.3.cmml">p</mi></msub><mo id="alg1.l11.m1.1.1.1.1.1.1.2.4" xref="alg1.l11.m1.1.1.1.1.1.1.3.cmml">,</mo><msub id="alg1.l11.m1.1.1.1.1.1.1.2.2" xref="alg1.l11.m1.1.1.1.1.1.1.2.2.cmml"><mi id="alg1.l11.m1.1.1.1.1.1.1.2.2.2" xref="alg1.l11.m1.1.1.1.1.1.1.2.2.2.cmml">j</mi><mi id="alg1.l11.m1.1.1.1.1.1.1.2.2.3" xref="alg1.l11.m1.1.1.1.1.1.1.2.2.3.cmml">n</mi></msub><mo id="alg1.l11.m1.1.1.1.1.1.1.2.5" stretchy="false" xref="alg1.l11.m1.1.1.1.1.1.1.3.cmml">)</mo></mrow><mo id="alg1.l11.m1.2.2.2.2.2.4" lspace="0em" rspace="0em" xref="alg1.l11.m1.2.2.2.2.3.1.cmml">|</mo><mrow id="alg1.l11.m1.2.2.2.2.2.2.2" xref="alg1.l11.m1.2.2.2.2.2.2.3.cmml"><mrow id="alg1.l11.m1.2.2.2.2.2.2.1.1" xref="alg1.l11.m1.2.2.2.2.2.2.1.1.cmml"><msub id="alg1.l11.m1.2.2.2.2.2.2.1.1.3" xref="alg1.l11.m1.2.2.2.2.2.2.1.1.3.cmml"><mi id="alg1.l11.m1.2.2.2.2.2.2.1.1.3.2" xref="alg1.l11.m1.2.2.2.2.2.2.1.1.3.2.cmml">j</mi><mi id="alg1.l11.m1.2.2.2.2.2.2.1.1.3.3" xref="alg1.l11.m1.2.2.2.2.2.2.1.1.3.3.cmml">p</mi></msub><mo id="alg1.l11.m1.2.2.2.2.2.2.1.1.2" xref="alg1.l11.m1.2.2.2.2.2.2.1.1.2.cmml">∈</mo><mrow id="alg1.l11.m1.2.2.2.2.2.2.1.1.1" xref="alg1.l11.m1.2.2.2.2.2.2.1.1.1.cmml"><mi id="alg1.l11.m1.2.2.2.2.2.2.1.1.1.3" xref="alg1.l11.m1.2.2.2.2.2.2.1.1.1.3.cmml">M</mi><mo id="alg1.l11.m1.2.2.2.2.2.2.1.1.1.2" xref="alg1.l11.m1.2.2.2.2.2.2.1.1.1.2.cmml">⁢</mo><mrow id="alg1.l11.m1.2.2.2.2.2.2.1.1.1.1.1" xref="alg1.l11.m1.2.2.2.2.2.2.1.1.1.1.1.1.cmml"><mo id="alg1.l11.m1.2.2.2.2.2.2.1.1.1.1.1.2" stretchy="false" xref="alg1.l11.m1.2.2.2.2.2.2.1.1.1.1.1.1.cmml">(</mo><msub id="alg1.l11.m1.2.2.2.2.2.2.1.1.1.1.1.1" xref="alg1.l11.m1.2.2.2.2.2.2.1.1.1.1.1.1.cmml"><mi id="alg1.l11.m1.2.2.2.2.2.2.1.1.1.1.1.1.2" xref="alg1.l11.m1.2.2.2.2.2.2.1.1.1.1.1.1.2.cmml">p</mi><mi id="alg1.l11.m1.2.2.2.2.2.2.1.1.1.1.1.1.3" xref="alg1.l11.m1.2.2.2.2.2.2.1.1.1.1.1.1.3.cmml">p</mi></msub><mo id="alg1.l11.m1.2.2.2.2.2.2.1.1.1.1.1.3" stretchy="false" xref="alg1.l11.m1.2.2.2.2.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="alg1.l11.m1.2.2.2.2.2.2.2.3" xref="alg1.l11.m1.2.2.2.2.2.2.3a.cmml">,</mo><mrow id="alg1.l11.m1.2.2.2.2.2.2.2.2" xref="alg1.l11.m1.2.2.2.2.2.2.2.2.cmml"><msub id="alg1.l11.m1.2.2.2.2.2.2.2.2.3" xref="alg1.l11.m1.2.2.2.2.2.2.2.2.3.cmml"><mi id="alg1.l11.m1.2.2.2.2.2.2.2.2.3.2" xref="alg1.l11.m1.2.2.2.2.2.2.2.2.3.2.cmml">j</mi><mi id="alg1.l11.m1.2.2.2.2.2.2.2.2.3.3" xref="alg1.l11.m1.2.2.2.2.2.2.2.2.3.3.cmml">n</mi></msub><mo id="alg1.l11.m1.2.2.2.2.2.2.2.2.2" xref="alg1.l11.m1.2.2.2.2.2.2.2.2.2.cmml">∈</mo><mrow id="alg1.l11.m1.2.2.2.2.2.2.2.2.1" xref="alg1.l11.m1.2.2.2.2.2.2.2.2.1.cmml"><mi id="alg1.l11.m1.2.2.2.2.2.2.2.2.1.3" xref="alg1.l11.m1.2.2.2.2.2.2.2.2.1.3.cmml">M</mi><mo id="alg1.l11.m1.2.2.2.2.2.2.2.2.1.2" xref="alg1.l11.m1.2.2.2.2.2.2.2.2.1.2.cmml">⁢</mo><mrow id="alg1.l11.m1.2.2.2.2.2.2.2.2.1.1.1" xref="alg1.l11.m1.2.2.2.2.2.2.2.2.1.1.1.1.cmml"><mo id="alg1.l11.m1.2.2.2.2.2.2.2.2.1.1.1.2" stretchy="false" xref="alg1.l11.m1.2.2.2.2.2.2.2.2.1.1.1.1.cmml">(</mo><msub id="alg1.l11.m1.2.2.2.2.2.2.2.2.1.1.1.1" xref="alg1.l11.m1.2.2.2.2.2.2.2.2.1.1.1.1.cmml"><mi id="alg1.l11.m1.2.2.2.2.2.2.2.2.1.1.1.1.2" xref="alg1.l11.m1.2.2.2.2.2.2.2.2.1.1.1.1.2.cmml">p</mi><mi id="alg1.l11.m1.2.2.2.2.2.2.2.2.1.1.1.1.3" xref="alg1.l11.m1.2.2.2.2.2.2.2.2.1.1.1.1.3.cmml">n</mi></msub><mo id="alg1.l11.m1.2.2.2.2.2.2.2.2.1.1.1.3" stretchy="false" xref="alg1.l11.m1.2.2.2.2.2.2.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="alg1.l11.m1.2.2.2.2.2.5" stretchy="false" xref="alg1.l11.m1.2.2.2.2.3.1.cmml">}</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l11.m1.2b"><apply id="alg1.l11.m1.2.2.cmml" xref="alg1.l11.m1.2.2"><eq id="alg1.l11.m1.2.2.3.cmml" xref="alg1.l11.m1.2.2.3"></eq><ci id="alg1.l11.m1.2.2.4.cmml" xref="alg1.l11.m1.2.2.4">𝐸</ci><apply id="alg1.l11.m1.2.2.2.cmml" xref="alg1.l11.m1.2.2.2"><union id="alg1.l11.m1.2.2.2.3.cmml" xref="alg1.l11.m1.2.2.2.3"></union><ci id="alg1.l11.m1.2.2.2.4.cmml" xref="alg1.l11.m1.2.2.2.4">𝐸</ci><apply id="alg1.l11.m1.2.2.2.2.3.cmml" xref="alg1.l11.m1.2.2.2.2.2"><csymbol cd="latexml" id="alg1.l11.m1.2.2.2.2.3.1.cmml" xref="alg1.l11.m1.2.2.2.2.2.3">conditional-set</csymbol><interval closure="open" id="alg1.l11.m1.1.1.1.1.1.1.3.cmml" xref="alg1.l11.m1.1.1.1.1.1.1.2"><apply id="alg1.l11.m1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l11.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l11.m1.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l11.m1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l11.m1.1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l11.m1.1.1.1.1.1.1.1.1.2">𝑗</ci><ci id="alg1.l11.m1.1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l11.m1.1.1.1.1.1.1.1.1.3">𝑝</ci></apply><apply id="alg1.l11.m1.1.1.1.1.1.1.2.2.cmml" xref="alg1.l11.m1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="alg1.l11.m1.1.1.1.1.1.1.2.2.1.cmml" xref="alg1.l11.m1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="alg1.l11.m1.1.1.1.1.1.1.2.2.2.cmml" xref="alg1.l11.m1.1.1.1.1.1.1.2.2.2">𝑗</ci><ci id="alg1.l11.m1.1.1.1.1.1.1.2.2.3.cmml" xref="alg1.l11.m1.1.1.1.1.1.1.2.2.3">𝑛</ci></apply></interval><apply id="alg1.l11.m1.2.2.2.2.2.2.3.cmml" xref="alg1.l11.m1.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l11.m1.2.2.2.2.2.2.3a.cmml" xref="alg1.l11.m1.2.2.2.2.2.2.2.3">formulae-sequence</csymbol><apply id="alg1.l11.m1.2.2.2.2.2.2.1.1.cmml" xref="alg1.l11.m1.2.2.2.2.2.2.1.1"><in id="alg1.l11.m1.2.2.2.2.2.2.1.1.2.cmml" xref="alg1.l11.m1.2.2.2.2.2.2.1.1.2"></in><apply id="alg1.l11.m1.2.2.2.2.2.2.1.1.3.cmml" xref="alg1.l11.m1.2.2.2.2.2.2.1.1.3"><csymbol cd="ambiguous" id="alg1.l11.m1.2.2.2.2.2.2.1.1.3.1.cmml" xref="alg1.l11.m1.2.2.2.2.2.2.1.1.3">subscript</csymbol><ci id="alg1.l11.m1.2.2.2.2.2.2.1.1.3.2.cmml" xref="alg1.l11.m1.2.2.2.2.2.2.1.1.3.2">𝑗</ci><ci id="alg1.l11.m1.2.2.2.2.2.2.1.1.3.3.cmml" xref="alg1.l11.m1.2.2.2.2.2.2.1.1.3.3">𝑝</ci></apply><apply id="alg1.l11.m1.2.2.2.2.2.2.1.1.1.cmml" xref="alg1.l11.m1.2.2.2.2.2.2.1.1.1"><times id="alg1.l11.m1.2.2.2.2.2.2.1.1.1.2.cmml" xref="alg1.l11.m1.2.2.2.2.2.2.1.1.1.2"></times><ci id="alg1.l11.m1.2.2.2.2.2.2.1.1.1.3.cmml" xref="alg1.l11.m1.2.2.2.2.2.2.1.1.1.3">𝑀</ci><apply id="alg1.l11.m1.2.2.2.2.2.2.1.1.1.1.1.1.cmml" xref="alg1.l11.m1.2.2.2.2.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l11.m1.2.2.2.2.2.2.1.1.1.1.1.1.1.cmml" xref="alg1.l11.m1.2.2.2.2.2.2.1.1.1.1.1">subscript</csymbol><ci id="alg1.l11.m1.2.2.2.2.2.2.1.1.1.1.1.1.2.cmml" xref="alg1.l11.m1.2.2.2.2.2.2.1.1.1.1.1.1.2">𝑝</ci><ci id="alg1.l11.m1.2.2.2.2.2.2.1.1.1.1.1.1.3.cmml" xref="alg1.l11.m1.2.2.2.2.2.2.1.1.1.1.1.1.3">𝑝</ci></apply></apply></apply><apply id="alg1.l11.m1.2.2.2.2.2.2.2.2.cmml" xref="alg1.l11.m1.2.2.2.2.2.2.2.2"><in id="alg1.l11.m1.2.2.2.2.2.2.2.2.2.cmml" xref="alg1.l11.m1.2.2.2.2.2.2.2.2.2"></in><apply id="alg1.l11.m1.2.2.2.2.2.2.2.2.3.cmml" xref="alg1.l11.m1.2.2.2.2.2.2.2.2.3"><csymbol cd="ambiguous" id="alg1.l11.m1.2.2.2.2.2.2.2.2.3.1.cmml" xref="alg1.l11.m1.2.2.2.2.2.2.2.2.3">subscript</csymbol><ci id="alg1.l11.m1.2.2.2.2.2.2.2.2.3.2.cmml" xref="alg1.l11.m1.2.2.2.2.2.2.2.2.3.2">𝑗</ci><ci id="alg1.l11.m1.2.2.2.2.2.2.2.2.3.3.cmml" xref="alg1.l11.m1.2.2.2.2.2.2.2.2.3.3">𝑛</ci></apply><apply id="alg1.l11.m1.2.2.2.2.2.2.2.2.1.cmml" xref="alg1.l11.m1.2.2.2.2.2.2.2.2.1"><times id="alg1.l11.m1.2.2.2.2.2.2.2.2.1.2.cmml" xref="alg1.l11.m1.2.2.2.2.2.2.2.2.1.2"></times><ci id="alg1.l11.m1.2.2.2.2.2.2.2.2.1.3.cmml" xref="alg1.l11.m1.2.2.2.2.2.2.2.2.1.3">𝑀</ci><apply id="alg1.l11.m1.2.2.2.2.2.2.2.2.1.1.1.1.cmml" xref="alg1.l11.m1.2.2.2.2.2.2.2.2.1.1.1"><csymbol cd="ambiguous" id="alg1.l11.m1.2.2.2.2.2.2.2.2.1.1.1.1.1.cmml" xref="alg1.l11.m1.2.2.2.2.2.2.2.2.1.1.1">subscript</csymbol><ci id="alg1.l11.m1.2.2.2.2.2.2.2.2.1.1.1.1.2.cmml" xref="alg1.l11.m1.2.2.2.2.2.2.2.2.1.1.1.1.2">𝑝</ci><ci id="alg1.l11.m1.2.2.2.2.2.2.2.2.1.1.1.1.3.cmml" xref="alg1.l11.m1.2.2.2.2.2.2.2.2.1.1.1.1.3">𝑛</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l11.m1.2c">E=E\cup\{(j_{p},j_{n})|j_{p}\in M(p_{p}),j_{n}\in M(p_{n})\}</annotation><annotation encoding="application/x-llamapun" id="alg1.l11.m1.2d">italic_E = italic_E ∪ { ( italic_j start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT , italic_j start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT ) | italic_j start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ∈ italic_M ( italic_p start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ) , italic_j start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT ∈ italic_M ( italic_p start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT ) }</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l12">
<span class="ltx_tag ltx_tag_listingline">12:</span><span class="ltx_text ltx_font_bold" id="alg1.l12.1">end</span> <span class="ltx_text ltx_font_bold" id="alg1.l12.2">for</span>
</div>
<div class="ltx_listingline" id="alg1.l13">
<span class="ltx_tag ltx_tag_listingline">13:</span><span class="ltx_text ltx_font_bold" id="alg1.l13.1">Return</span> <math alttext="E" class="ltx_Math" display="inline" id="alg1.l13.m1.1"><semantics id="alg1.l13.m1.1a"><mi id="alg1.l13.m1.1.1" xref="alg1.l13.m1.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="alg1.l13.m1.1b"><ci id="alg1.l13.m1.1.1.cmml" xref="alg1.l13.m1.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l13.m1.1c">E</annotation><annotation encoding="application/x-llamapun" id="alg1.l13.m1.1d">italic_E</annotation></semantics></math>
</div>
</div>
</figure>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Tue Oct  1 07:37:50 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
