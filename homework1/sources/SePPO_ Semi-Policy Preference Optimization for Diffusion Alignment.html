<!DOCTYPE html><html lang="en" data-theme="light"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<title>SePPO: Semi-Policy Preference Optimization for Diffusion Alignment</title>
<!--Generated on Mon Oct  7 17:56:26 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css">
<link href="https://arxiv.org/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css">
<link href="https://arxiv.org/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css">
<link href="https://arxiv.org/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css">




<base href="https://arxiv.org/html/2410.05255v1/"><link rel="stylesheet" href="https://use.typekit.net/rwr5zpx.css"><link rel="icon" type="image/png" href="https://static.arxiv.org/static/browse/0.3.4/images/icons/favicon-16x16.png" sizes="16x16"><link rel="icon" type="image/png" href="https://static.arxiv.org/static/browse/0.3.4/images/icons/favicon-32x32.png" sizes="32x32"></head>
<body><header class="mob_header">
    <div class="html-header-logo">
      <a href="https://arxiv.org/">
        <img alt="logo" class="logomark" role="presentation" width="100" src="https://services.dev.arxiv.org/html/static/arxiv-logomark-small-white.svg">
        <span class="sr-only">Back to arXiv</span>
      </a>
    </div>

    <!--TOC, dark mode, links-->
    <div class="html-header-nav">
      <!--back to abstract-->
      
        <a class="nav-link ar5iv-footer-button hover-effect" aria-label="Back to abstract page" href="https://arxiv.org/abs/2410.05255v1">
        <svg xmlns="http://www.w3.org/2000/svg" height="1.25em" viewBox="0 0 512 512" fill="#ffffff" aria-hidden="true">
            <path d="M502.6 278.6c12.5-12.5 12.5-32.8 0-45.3l-128-128c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L402.7 224 192 224c-17.7 0-32 14.3-32 32s14.3 32 32 32l210.7 0-73.4 73.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l128-128zM160 96c17.7 0 32-14.3 32-32s-14.3-32-32-32L96 32C43 32 0 75 0 128L0 384c0 53 43 96 96 96l64 0c17.7 0 32-14.3 32-32s-14.3-32-32-32l-64 0c-17.7 0-32-14.3-32-32l0-256c0-17.7 14.3-32 32-32l64 0z"></path>
        </svg>
        </a>
      <!--dark mode-->
      <a class="ar5iv-toggle-color-scheme" title="Toggle dark/light mode" aria-label="System preference">
        <label id="automatic-tog" class="toggle-icon" title="Switch to light mode" for="__palette_3">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9h-1.9M20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69m-9.15 3.96h2.3L12 9l-1.15 3.65Z"></path></svg>
        </label>
        
        
      </a>
      <!--nav-->
      <button class="navbar-toggler ar5iv-footer-button" type="button" data-bs-theme="dark" data-bs-toggle="collapse" aria-expanded="false" data-bs-target=".ltx_page_main >.ltx_TOC.mobile" aria-controls="navbarSupportedContent" aria-label="Toggle navigation" style="border:none; margin-right: 0em;">
        <svg xmlns="http://www.w3.org/2000/svg" height="1.25em" viewBox="0 0 448 512" aria-hidden="true" role="img" fill="#ffffff"><path d="M0 96C0 78.3 14.3 64 32 64H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32C14.3 128 0 113.7 0 96zM0 256c0-17.7 14.3-32 32-32H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32c-17.7 0-32-14.3-32-32zM448 416c0 17.7-14.3 32-32 32H32c-17.7 0-32-14.3-32-32s14.3-32 32-32H416c17.7 0 32 14.3 32 32z"></path></svg>
      </button>
    </div>
    </header><header class="desktop_header">
    <div class="html-header-logo">
      <a href="https://arxiv.org/">
          <img alt="logo" class="logo" role="presentation" width="100" src="https://services.dev.arxiv.org/html/static/arxiv-logo-one-color-white.svg">
          <span class="sr-only">Back to arXiv</span>
      </a>
    </div>
    <div class="html-header-message" role="banner">
        <p>This is <strong>experimental HTML</strong> to improve accessibility. We invite you to report rendering errors. <span class="sr-only">Use Alt+Y to toggle on accessible reporting links and Alt+Shift+Y to toggle off.</span> Learn more <a href="https://info.arxiv.org/about/accessible_HTML.html" target="_blank">about this project</a> and <a href="https://info.arxiv.org/help/submit_latex_best_practices.html" target="_blank">help improve conversions</a>.
        </p>
    </div>
    <nav class="html-header-nav">
      <a class="ar5iv-footer-button hover-effect" href="https://info.arxiv.org/about/accessible_HTML.html" target="_blank">Why HTML?</a>
      <a class="ar5iv-footer-button hover-effect" target="_blank" href="https://arxiv.org/html/2410.05255v1/#myForm">Report Issue</a>
      <a class="ar5iv-footer-button hover-effect" href="https://arxiv.org/abs/2410.05255v1">Back to Abstract</a>
      <a class="ar5iv-footer-button hover-effect" href="https://arxiv.org/pdf/2410.05255v1" target="_blank">Download PDF</a>
      <a class="ar5iv-toggle-color-scheme" title="Toggle dark/light mode">
        <label id="automatic-tog" class="toggle-icon" title="Switch to light mode" for="__palette_3">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9h-1.9M20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69m-9.15 3.96h2.3L12 9l-1.15 3.65Z"></path></svg>
        </label>
        
        
      </a>
    </nav></header>

<div class="ltx_page_main" id="main">
<nav class="ltx_TOC active" aria-labelledby="toc_header"><h2 id="toc_header" class="sr-only">Table of Contents</h2>

      <div id="listIcon" type="button" class="hide">
          <svg width="17px" height="17px" viewBox="0 0 512 512" style="pointer-events: none;">
          <path d="M40 48C26.7 48 16 58.7 16 72v48c0 13.3 10.7 24 24 24H88c13.3 0 24-10.7 24-24V72c0-13.3-10.7-24-24-24H40zM192 64c-17.7 0-32 14.3-32 32s14.3 32 32 32H480c17.7 0 32-14.3 32-32s-14.3-32-32-32H192zm0 160c-17.7 0-32 14.3-32 32s14.3 32 32 32H480c17.7 0 32-14.3 32-32s-14.3-32-32-32H192zm0 160c-17.7 0-32 14.3-32 32s14.3 32 32 32H480c17.7 0 32-14.3 32-32s-14.3-32-32-32H192zM16 232v48c0 13.3 10.7 24 24 24H88c13.3 0 24-10.7 24-24V232c0-13.3-10.7-24-24-24H40c-13.3 0-24 10.7-24 24zM40 368c-13.3 0-24 10.7-24 24v48c0 13.3 10.7 24 24 24H88c13.3 0 24-10.7 24-24V392c0-13.3-10.7-24-24-24H40z"></path>
          </svg>
      </div>
      <div id="arrowIcon" type="button">
          <svg width="17px" height="17px" viewBox="0 0 448 512" style="pointer-events: none;">
          <path d="M9.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.2 288 416 288c17.7 0 32-14.3 32-32s-14.3-32-32-32l-306.7 0L214.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160z"></path>
          </svg>
      </div><ol class="ltx_toclist"><li class="ltx_tocentry ltx_tocentry_section">
    <a class="ltx_ref" href="https://arxiv.org/html/2410.05255v1#abstract" title="Abstract">
      <span class="ltx_text ltx_ref_title">
        <span class="ltx_tag ltx_tag_ref"></span>
        Abstract
      </span>
    </a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.05255v1#S1" title="In SePPO: Semi-Policy Preference Optimization for Diffusion Alignment"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.05255v1#S2" title="In SePPO: Semi-Policy Preference Optimization for Diffusion Alignment"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Related Work</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.05255v1#S3" title="In SePPO: Semi-Policy Preference Optimization for Diffusion Alignment"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Background</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.05255v1#S3.SS1" title="In 3 Background ‣ SePPO: Semi-Policy Preference Optimization for Diffusion Alignment"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Denoising Diffusion Probabilistic Model</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.05255v1#S3.SS2" title="In 3 Background ‣ SePPO: Semi-Policy Preference Optimization for Diffusion Alignment"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>Direct Preference Optimization</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.05255v1#S4" title="In SePPO: Semi-Policy Preference Optimization for Diffusion Alignment"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Iterative Alignment for Diffusion Models</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.05255v1#S4.SS1" title="In 4 Iterative Alignment for Diffusion Models ‣ SePPO: Semi-Policy Preference Optimization for Diffusion Alignment"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Iterative Alignment from Semi-policy Preference Optimization</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.05255v1#S4.SS2" title="In 4 Iterative Alignment for Diffusion Models ‣ SePPO: Semi-Policy Preference Optimization for Diffusion Alignment"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>Anchor-based Adaptive Flipper for Preference Optimization</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.05255v1#S5" title="In SePPO: Semi-Policy Preference Optimization for Diffusion Alignment"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Experiments</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.05255v1#S5.SS1" title="In 5 Experiments ‣ SePPO: Semi-Policy Preference Optimization for Diffusion Alignment"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.1 </span>Setup</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.05255v1#S5.SS1.SSS1" title="In 5.1 Setup ‣ 5 Experiments ‣ SePPO: Semi-Policy Preference Optimization for Diffusion Alignment"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.1.1 </span>Text-to-Image</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.05255v1#S5.SS1.SSS2" title="In 5.1 Setup ‣ 5 Experiments ‣ SePPO: Semi-Policy Preference Optimization for Diffusion Alignment"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.1.2 </span>Text-to-Video</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.05255v1#S5.SS2" title="In 5 Experiments ‣ SePPO: Semi-Policy Preference Optimization for Diffusion Alignment"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.2 </span>Results</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.05255v1#S5.SS2.SSS1" title="In 5.2 Results ‣ 5 Experiments ‣ SePPO: Semi-Policy Preference Optimization for Diffusion Alignment"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.2.1 </span>Analysis of Text-to-Image</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.05255v1#S5.SS2.SSS2" title="In 5.2 Results ‣ 5 Experiments ‣ SePPO: Semi-Policy Preference Optimization for Diffusion Alignment"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.2.2 </span>Analysis of Text-to-Video</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.05255v1#S5.SS2.SSS3" title="In 5.2 Results ‣ 5 Experiments ‣ SePPO: Semi-Policy Preference Optimization for Diffusion Alignment"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.2.3 </span>Ablation Study</span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.05255v1#S6" title="In SePPO: Semi-Policy Preference Optimization for Diffusion Alignment"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6 </span>Discussions</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.05255v1#S6.SS1" title="In 6 Discussions ‣ SePPO: Semi-Policy Preference Optimization for Diffusion Alignment"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6.1 </span>Limitations</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.05255v1#S6.SS2" title="In 6 Discussions ‣ SePPO: Semi-Policy Preference Optimization for Diffusion Alignment"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6.2 </span>Conclusion</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2410.05255v1#A1" title="In SePPO: Semi-Policy Preference Optimization for Diffusion Alignment"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A </span>Theoretical Analysis</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.05255v1#A1.SS1" title="In Appendix A Theoretical Analysis ‣ SePPO: Semi-Policy Preference Optimization for Diffusion Alignment"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.1 </span>Proof of Theorem <span class="ltx_text ltx_ref_tag">4.1</span></span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2410.05255v1#A2" title="In SePPO: Semi-Policy Preference Optimization for Diffusion Alignment"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B </span>Supplementary Experiments</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.05255v1#A2.SS1" title="In Appendix B Supplementary Experiments ‣ SePPO: Semi-Policy Preference Optimization for Diffusion Alignment"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B.1 </span>Ablation Study on Iteration <math alttext="K" class="ltx_Math" display="inline"><semantics><mi>K</mi><annotation-xml encoding="MathML-Content"><ci>𝐾</ci></annotation-xml><annotation encoding="application/x-tex">K</annotation><annotation encoding="application/x-llamapun">italic_K</annotation></semantics></math></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.05255v1#A2.SS2" title="In Appendix B Supplementary Experiments ‣ SePPO: Semi-Policy Preference Optimization for Diffusion Alignment"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B.2 </span>Pseudocode</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.05255v1#A2.SS3" title="In Appendix B Supplementary Experiments ‣ SePPO: Semi-Policy Preference Optimization for Diffusion Alignment"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B.3 </span>Visual Generation Examples</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
    <a class="ltx_ref" href="https://arxiv.org/html/2410.05255v1#bib" title="References">
      <span class="ltx_text ltx_ref_title">
        <span class="ltx_tag ltx_tag_ref"></span>
        References
      </span>
    </a></li></ol></nav>

<div class="ltx_page_content"><div class="package-alerts ltx_document" role="status" aria-label="Conversion errors have been found">
      <button aria-label="Dismiss alert">
          <span aria-hidden="true"><svg role="presentation" width="20" height="20" viewBox="0 0 44 44" aria-hidden="true" focusable="false">
          <path d="M0.549989 4.44999L4.44999 0.549988L43.45 39.55L39.55 43.45L0.549989 4.44999Z"></path>
          <path d="M39.55 0.549988L43.45 4.44999L4.44999 43.45L0.549988 39.55L39.55 0.549988Z"></path>
          </svg></span>
      </button>
      <p>HTML conversions <a href="https://info.dev.arxiv.org/about/accessibility_html_error_messages.html" target="_blank">sometimes display errors</a> due to content that did not convert correctly from the source. This paper uses the following packages that are not yet supported by the HTML conversion tool. Feedback on these issues are not necessary; they are known and are being worked on.</p>
          <ul arial-label="Unsupported packages used in this paper">
              <li>failed: pythonhighlight</li>
          </ul>
      <p>Authors: achieve the best HTML results from your LaTeX submissions by following these <a href="https://info.arxiv.org/help/submit_latex_best_practices.html" target="_blank">best practices</a>.</p>
    </div><div id="target-section" class="section"><a id="license-tr" href="https://info.arxiv.org/help/license/index.html#licenses-available">License: arXiv.org perpetual non-exclusive license</a><div id="watermark-tr">arXiv:2410.05255v1 [cs.CV] 07 Oct 2024</div></div>
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">SePPO: Semi-Policy Preference Optimization for Diffusion Alignment</h1><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Daoan Zhang<math alttext="{}^{1~{}*}" class="ltx_Math" display="inline" id="id1.1.m1.2"><semantics id="id1.1.m1.2a"><msup id="id1.1.m1.2.2" xref="id1.1.m1.2.2.cmml"><mi id="id1.1.m1.2.2a" xref="id1.1.m1.2.2.cmml"></mi><mrow id="id1.1.m1.2.2.2.4" xref="id1.1.m1.2.2.2.3.cmml"><mn id="id1.1.m1.1.1.1.1" xref="id1.1.m1.1.1.1.1.cmml">1</mn><mo id="id1.1.m1.2.2.2.4.1" lspace="0.452em" xref="id1.1.m1.2.2.2.3.cmml">⁣</mo><mo id="id1.1.m1.2.2.2.2" xref="id1.1.m1.2.2.2.2.cmml">∗</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="id1.1.m1.2b"><apply id="id1.1.m1.2.2.cmml" xref="id1.1.m1.2.2"><list id="id1.1.m1.2.2.2.3.cmml" xref="id1.1.m1.2.2.2.4"><cn id="id1.1.m1.1.1.1.1.cmml" type="integer" xref="id1.1.m1.1.1.1.1">1</cn><times id="id1.1.m1.2.2.2.2.cmml" xref="id1.1.m1.2.2.2.2"></times></list></apply></annotation-xml><annotation encoding="application/x-tex" id="id1.1.m1.2c">{}^{1~{}*}</annotation><annotation encoding="application/x-llamapun" id="id1.1.m1.2d">start_FLOATSUPERSCRIPT 1 ∗ end_FLOATSUPERSCRIPT</annotation></semantics></math>
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname"> Guangchen Lan<sup class="ltx_sup" id="id17.2.id1"><span class="ltx_text ltx_font_italic" id="id17.2.id1.1">2</span></sup>
</span><span class="ltx_author_notes">Authors contributed equally.
<span class="ltx_contact ltx_role_affiliation">
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname"> Dong-Jun Han<sup class="ltx_sup" id="id18.2.id1"><span class="ltx_text ltx_font_italic" id="id18.2.id1.1">3</span></sup>
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname"> Wenlin Yao<sup class="ltx_sup" id="id19.2.id1"><span class="ltx_text ltx_font_italic" id="id19.2.id1.1">4</span></sup>
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname"> Xiaoman Pan<sup class="ltx_sup" id="id20.2.id1"><span class="ltx_text ltx_font_italic" id="id20.2.id1.1">4</span></sup>
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
<br class="ltx_break">Hongming Zhang<sup class="ltx_sup" id="id21.2.id1"><span class="ltx_text ltx_font_italic" id="id21.2.id1.1">4</span></sup>
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname"> Mingxiao Li<sup class="ltx_sup" id="id22.2.id1"><span class="ltx_text ltx_font_italic" id="id22.2.id1.1">4</span></sup>
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname"> Pengcheng Chen<sup class="ltx_sup" id="id23.2.id1"><span class="ltx_text ltx_font_italic" id="id23.2.id1.1">5</span></sup>
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname"> Yu Dong<sup class="ltx_sup" id="id24.2.id1"><span class="ltx_text ltx_font_italic" id="id24.2.id1.1">4</span></sup>
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname"> Christopher Brinton<sup class="ltx_sup" id="id25.2.id1"><span class="ltx_text ltx_font_italic" id="id25.2.id1.1">2</span></sup>
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname"> Jiebo Luo<sup class="ltx_sup" id="id26.3.id1"><span class="ltx_text ltx_font_italic" id="id26.3.id1.1">1</span></sup>
<br class="ltx_break">
<sup class="ltx_sup" id="id27.4.id2"><span class="ltx_text ltx_font_italic" id="id27.4.id2.1">1</span></sup> University of Rochester
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname"> &nbsp;&nbsp;<sup class="ltx_sup" id="id28.2.id1"><span class="ltx_text ltx_font_italic" id="id28.2.id1.1">2</span></sup> Purdue University
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname"> &nbsp;&nbsp;<sup class="ltx_sup" id="id29.2.id1"><span class="ltx_text ltx_font_italic" id="id29.2.id1.1">3</span></sup> Yonsei University
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
<br class="ltx_break"><sup class="ltx_sup" id="id30.2.id1"><span class="ltx_text ltx_font_italic" id="id30.2.id1.1">4</span></sup> Tencent AI Lab
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname"> &nbsp;&nbsp;<sup class="ltx_sup" id="id31.2.id1"><span class="ltx_text ltx_font_italic" id="id31.2.id1.1">5</span></sup> University of Washington 
<br class="ltx_break">
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">
</span></span></span>
</div><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_abstract" id="abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<p class="ltx_p" id="id32.id1">Reinforcement learning from human feedback (RLHF) methods are emerging as a way to fine-tune diffusion models (DMs) for visual generation. However, commonly used on-policy strategies are limited by the generalization capability of the reward model, while off-policy approaches require large amounts of difficult-to-obtain paired human-annotated data, particularly in visual generation tasks. To address the limitations of both on- and off-policy RLHF, we propose a preference optimization method that aligns DMs with preferences without relying on reward models or paired human-annotated data. Specifically, we introduce a Semi-Policy Preference Optimization (SePPO) method. SePPO leverages previous checkpoints as reference models while using them to generate on-policy reference samples, which replace “losing images” in preference pairs. This approach allows us to optimize using only off-policy “winning images.” Furthermore, we design a strategy for reference model selection that expands the exploration in the policy space. Notably, we do not simply treat reference samples as negative examples for learning. Instead, we design an anchor-based criterion to assess whether the reference samples are likely to be winning or losing images, allowing the model to selectively learn from the generated reference samples. This approach mitigates performance degradation caused by the uncertainty in reference sample quality. We validate SePPO across both text-to-image and text-to-video benchmarks. SePPO surpasses all previous approaches on the text-to-image benchmarks and also demonstrates outstanding performance on the text-to-video benchmarks. Code will be released in <a class="ltx_ref ltx_href" href="https://github.com/DwanZhang-AI/SePPO" title="">https://github.com/DwanZhang-AI/SePPO</a>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">Text-to-visual models have become a crucial component of the AIGC (AI-generated content) industry, with the denoising diffusion probabilistic model (DDPM) <cite class="ltx_cite ltx_citemacro_citep">(Ho et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05255v1#bib.bib11" title="">2020</a>; Kingma et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05255v1#bib.bib16" title="">2021</a>)</cite> being the most widely used technology. However, current pre-trained text-to-visual models often fail to adequately align with human requirements. As a result, recent works <cite class="ltx_cite ltx_citemacro_citep">(Liang et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05255v1#bib.bib19" title="">2024a</a>; Black et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05255v1#bib.bib1" title="">2024</a>; Wallace et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05255v1#bib.bib29" title="">2024</a>; Yang et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05255v1#bib.bib31" title="">2024</a>)</cite> adopt reinforcement learning (RL)-based approaches as the post-training process to better satisfy human needs, namely reinforcement learning from human feedback (RLHF).</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">These methods can generally be divided into two categories: on-policy methods and off-policy methods. Similar to large language models (LLMs), in the post-training of diffusion models, on-policy models use a reward model (RM) to score output and then backpropagate the policy gradients based on the scoring results. A typical approach is DDPO <cite class="ltx_cite ltx_citemacro_citep">(Black et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05255v1#bib.bib1" title="">2024</a>)</cite>, which utilizes vision language models as the reward model to improve the prompt-image alignment. Even though on-policy method is approved to be helpful in the Natural Language Processing (NLP) domain <cite class="ltx_cite ltx_citemacro_citep">(Dong et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05255v1#bib.bib5" title="">2024</a>)</cite>. However, aside from the existing issues with on-policy methods, such as reward hacking, which can lead to model collapse <cite class="ltx_cite ltx_citemacro_citep">(Denison et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05255v1#bib.bib4" title="">2024</a>)</cite>, in the text-to-visual task, despite the availability of numerous evaluation models, it is difficult to find a solution that can provide comprehensive feedback on all aspects of the visual content <cite class="ltx_cite ltx_citemacro_citep">(Kim et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05255v1#bib.bib15" title="">2024</a>)</cite>. Additionally, constructing an effective and efficient reward model is extremely challenging and heavily dependent on the collection of costly paired feedback data.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">Another approach is to utilize a fixed set of preference data (generated by human or other models) as training data, which is called off-policy method. This method allows the trained model to achieve a distribution similar to that of the preference data. An example is Diffusion-DPO <cite class="ltx_cite ltx_citemacro_citep">(Wallace et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05255v1#bib.bib29" title="">2024</a>)</cite>, which uses the Pick-a-Pic <cite class="ltx_cite ltx_citemacro_citep">(Kirstain et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05255v1#bib.bib18" title="">2023</a>)</cite> dataset that contains paired preference image data generated by various models with human ratings. Apparently, off-policy methods also depend on human feedback data with positive and negative sample pairs, which requires additional efforts, and their results are usually inferior to those of on-policy methods <cite class="ltx_cite ltx_citemacro_citep">(Tang et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05255v1#bib.bib26" title="">2024</a>)</cite>. Thus, in this paper, our aim is to build a preference optimization method that can mitigate the issues of on-policy and off-policy, allowing the diffusion model to align with preferences without using a reward model or paired human-annotated data.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">To enable models to learn preferences from human feedback, the construction of positive and negative examples is crucial. However, in most datasets, there is usually only one sample in each data point, which typically serves as a positive example. Therefore, in the absence of a reward model, our initial consideration is how to construct appropriate negative samples. Several previous works, such as SPIN-Diffusion <cite class="ltx_cite ltx_citemacro_citep">(Yuan et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05255v1#bib.bib32" title="">2024a</a>)</cite> and DITTO <cite class="ltx_cite ltx_citemacro_citep">(Shaikh et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05255v1#bib.bib24" title="">2024</a>)</cite>, utilize the previous checkpoints to generate the so-called “losing” samples and then use preference optimization for model training. However, these methods cannot guarantee that the samples generated from the previous checkpoints are necessarily “losing” samples relative to the current model.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S1.p5">
<p class="ltx_p" id="S1.p5.1">To address this issue, we propose a method called Semi-Policy Preference Optimization (SePPO). In our method, the positive samples are sampled from the supervised fine-tuning (SFT) dataset. In order to obtain sufficiently good negative samples that are not too far from the current model distribution, the “losing” samples are generated by the reference model. Unlike SPIN-Diffusion, where the reference model is set to use the latest checkpoint, and DITTO, where the reference model is the initial model. In our SePPO, the reference models are sampled from all the previous checkpoints. To be specific, we first study the selection strategies for the reference model, conducting experiments using three different approaches: (1) always selecting the initial checkpoint as the reference model, (2) selecting the checkpoint saved from the previous iteration, and (3) randomly selecting from all previous checkpoints. We found that as the number of training steps increases, compared to always using the initial checkpoint, selecting the checkpoint from the previous iteration makes the reference model less prone to overfitting and yields better results. Moreover, randomly selecting from all previous checkpoints produces similar results to selecting the checkpoint from the previous iteration and leads to a more stable training process overall.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S1.p6">
<p class="ltx_p" id="S1.p6.1">In addition, to determine whether the samples generated from the reference model are genuinely “losing” images or “winning” images relative to the current model. We further design a strategy to determine whether the sampled examples are positive or negative samples, namely Anchor-based Adaptive Flipper (AAF). If we have a winning data point for the model to learn from and the reference model has a higher probability than the current model to generate this winning data point, then the probability of sampling a winning data point from the reference model distribution will be greater than that of generating a losing data point. In other words, in this case, the “losing images” are not truly negative samples for the current model. This could negatively affect the model if we continue to use the direct preference optimization (DPO) <cite class="ltx_cite ltx_citemacro_citep">(Rafailov et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05255v1#bib.bib23" title="">2024</a>)</cite> or SPIN <cite class="ltx_cite ltx_citemacro_citep">(Yuan et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05255v1#bib.bib32" title="">2024a</a>)</cite> loss functions. Therefore, we design a strategy where, if the reference model has a higher probability than the current model of generating the winning data point, the model will learn from both the winning data point and the samples generated by the reference model. This not only helps avoid the negative effects of incorrectly judging sample quality but also increases the chances of the model outperforming the results of SFT to some extent.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S1.p7">
<p class="ltx_p" id="S1.p7.1">In summary, the main contributions of this work are as follows:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<ol class="ltx_enumerate" id="S1.I1">
<li class="ltx_item" id="S1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span>
<div class="ltx_para" id="S1.I1.i1.p1">
<p class="ltx_p" id="S1.I1.i1.p1.1">We design an iterative preference optimization method called Semi-Policy Preference Optimization (SePPO). Our model can achieve preference alignment without human annotation and a reward model, which reduces labor cost and infrastructure burden;</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="S1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span>
<div class="ltx_para ltx_noindent" id="S1.I1.i2.p1">
<p class="ltx_p" id="S1.I1.i2.p1.1">We develop a strategy that first samples the reference model in each iteration, which enables to expand the space of policy exploration. We then design a criterion to evaluate the quality of generated responses and adjust the preference optimization based on this quality information, a process termed Anchor-based Adaptive Flipper (AAF);</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="S1.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">3.</span>
<div class="ltx_para ltx_noindent" id="S1.I1.i3.p1">
<p class="ltx_p" id="S1.I1.i3.p1.1">SePPO exceeds all previous optimization methods on the text-to-image benchmark, and its effectiveness has also been validated on the text-to-video datasets.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
</ol>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Work</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S2.p1">
<p class="ltx_p" id="S2.p1.1"><span class="ltx_text ltx_font_bold" id="S2.p1.1.1">Self-Improvement.</span> Self-improvement methods use iterative sampling to improve pre-trained models, which has the potential to eliminate the need for an expert annotator such as a human or more advanced models. A recent work INPO <cite class="ltx_cite ltx_citemacro_citep">(Zhang et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05255v1#bib.bib36" title="">2024</a>)</cite> directly approximates the Nash policy (the optimal solution) of a two-player game on a human-annotated preference dataset. Concurrently, the demonstrated self-improvement methods <cite class="ltx_cite ltx_citemacro_citep">(Shaikh et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05255v1#bib.bib24" title="">2024</a>; Chen et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05255v1#bib.bib3" title="">2024</a>)</cite> align pre-trained models only using supervised learning dataset (one demonstrated response for each prompt) without using reward models and human-annotated data pairs. Specifically, it takes the demonstrated response as the winner and generates the loser by reference models. DITTO <cite class="ltx_cite ltx_citemacro_citep">(Shaikh et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05255v1#bib.bib24" title="">2024</a>)</cite> fixes the reference model as the initial model and works well on small datasets. SPIN <cite class="ltx_cite ltx_citemacro_citep">(Chen et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05255v1#bib.bib3" title="">2024</a>)</cite> takes the latest checkpoint as the reference model and uses it to generate responses in each iteration. However, these approaches have the following shortcomings. First, they only focus on transformer-based models for the text modality. Second, the selection of reference models is fixed, which has limited space for policy exploration. Third, either a human-annotated preference dataset is necessarily required or they are built on a strong assumption that the demonstrated responses are always preferred to the generated responses. In fact, the responses generated by the models are not necessarily bad and do not always need to be rejected.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S2.p2">
<p class="ltx_p" id="S2.p2.1"><span class="ltx_text ltx_font_bold" id="S2.p2.1.1">RM-Free PO for Diffusion Model Alignment.</span> DPO-style methods <cite class="ltx_cite ltx_citemacro_citep">(Rafailov et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05255v1#bib.bib23" title="">2024</a>)</cite> use a closed-form expression between RMs and the optimal policy to align pre-trained models with human preference. Thus, no RM is needed during the training process. Diffusion-DPO is first proposed in <cite class="ltx_cite ltx_citemacro_citet">Wallace et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.05255v1#bib.bib29" title="">2024</a>)</cite>. Based on offline datasets with labeled human preference, it shows promising results on text-to-image diffusion generation tasks. Diffusion-RPO <cite class="ltx_cite ltx_citemacro_citep">(Gu et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05255v1#bib.bib7" title="">2024</a>)</cite> considers semantic relationships between responses for contrastive weighting. MaPO <cite class="ltx_cite ltx_citemacro_citep">(Hong et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05255v1#bib.bib12" title="">2024</a>)</cite> uses margin-aware information, and removes the reference model. However, only off-policy data is considered and human-annotated data pairs are necessarily required with high labor costs.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S2.p3">
<p class="ltx_p" id="S2.p3.1">To involve on-policy data and minimize human annotation costs, self-improvement methods are being explored. SPIN-Diffusion <cite class="ltx_cite ltx_citemacro_citep">(Yuan et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05255v1#bib.bib32" title="">2024a</a>)</cite> adapts the SPIN method to text-to-image generation tasks with diffusion models. It shows high efficiency in data utilization. However, first, it has the issues mentioned above as a self-improvement method. Second, only the text-to-image generation task is considered in all previous works.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Background</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Denoising Diffusion Probabilistic Model</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.1">Given a data sample <math alttext="\mathbf{x}_{0}\sim\mathcal{D}" class="ltx_Math" display="inline" id="S3.SS1.p1.1.m1.1"><semantics id="S3.SS1.p1.1.m1.1a"><mrow id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml"><msub id="S3.SS1.p1.1.m1.1.1.2" xref="S3.SS1.p1.1.m1.1.1.2.cmml"><mi id="S3.SS1.p1.1.m1.1.1.2.2" xref="S3.SS1.p1.1.m1.1.1.2.2.cmml">𝐱</mi><mn id="S3.SS1.p1.1.m1.1.1.2.3" xref="S3.SS1.p1.1.m1.1.1.2.3.cmml">0</mn></msub><mo id="S3.SS1.p1.1.m1.1.1.1" xref="S3.SS1.p1.1.m1.1.1.1.cmml">∼</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.1.m1.1.1.3" xref="S3.SS1.p1.1.m1.1.1.3.cmml">𝒟</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><apply id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1"><csymbol cd="latexml" id="S3.SS1.p1.1.m1.1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1.1">similar-to</csymbol><apply id="S3.SS1.p1.1.m1.1.1.2.cmml" xref="S3.SS1.p1.1.m1.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.1.1.2.1.cmml" xref="S3.SS1.p1.1.m1.1.1.2">subscript</csymbol><ci id="S3.SS1.p1.1.m1.1.1.2.2.cmml" xref="S3.SS1.p1.1.m1.1.1.2.2">𝐱</ci><cn id="S3.SS1.p1.1.m1.1.1.2.3.cmml" type="integer" xref="S3.SS1.p1.1.m1.1.1.2.3">0</cn></apply><ci id="S3.SS1.p1.1.m1.1.1.3.cmml" xref="S3.SS1.p1.1.m1.1.1.3">𝒟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">\mathbf{x}_{0}\sim\mathcal{D}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.1.m1.1d">bold_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ∼ caligraphic_D</annotation></semantics></math>, the forward process is a Markov chain that gradually adds Gaussian noise to the sample as follows</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equationgroup ltx_eqn_table" id="S3.E1">
<tbody>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S3.E1X">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle q(\mathbf{x}_{1:T}|\mathbf{x}_{0})~{}={}" class="ltx_Math" display="inline" id="S3.E1X.2.1.1.m1.1"><semantics id="S3.E1X.2.1.1.m1.1a"><mrow id="S3.E1X.2.1.1.m1.1.1" xref="S3.E1X.2.1.1.m1.1.1.cmml"><mrow id="S3.E1X.2.1.1.m1.1.1.1" xref="S3.E1X.2.1.1.m1.1.1.1.cmml"><mi id="S3.E1X.2.1.1.m1.1.1.1.3" xref="S3.E1X.2.1.1.m1.1.1.1.3.cmml">q</mi><mo id="S3.E1X.2.1.1.m1.1.1.1.2" xref="S3.E1X.2.1.1.m1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E1X.2.1.1.m1.1.1.1.1.1" xref="S3.E1X.2.1.1.m1.1.1.1.1.1.1.cmml"><mo id="S3.E1X.2.1.1.m1.1.1.1.1.1.2" stretchy="false" xref="S3.E1X.2.1.1.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E1X.2.1.1.m1.1.1.1.1.1.1" xref="S3.E1X.2.1.1.m1.1.1.1.1.1.1.cmml"><msub id="S3.E1X.2.1.1.m1.1.1.1.1.1.1.2" xref="S3.E1X.2.1.1.m1.1.1.1.1.1.1.2.cmml"><mi id="S3.E1X.2.1.1.m1.1.1.1.1.1.1.2.2" xref="S3.E1X.2.1.1.m1.1.1.1.1.1.1.2.2.cmml">𝐱</mi><mrow id="S3.E1X.2.1.1.m1.1.1.1.1.1.1.2.3" xref="S3.E1X.2.1.1.m1.1.1.1.1.1.1.2.3.cmml"><mn id="S3.E1X.2.1.1.m1.1.1.1.1.1.1.2.3.2" xref="S3.E1X.2.1.1.m1.1.1.1.1.1.1.2.3.2.cmml">1</mn><mo id="S3.E1X.2.1.1.m1.1.1.1.1.1.1.2.3.1" lspace="0.278em" rspace="0.278em" xref="S3.E1X.2.1.1.m1.1.1.1.1.1.1.2.3.1.cmml">:</mo><mi id="S3.E1X.2.1.1.m1.1.1.1.1.1.1.2.3.3" xref="S3.E1X.2.1.1.m1.1.1.1.1.1.1.2.3.3.cmml">T</mi></mrow></msub><mo fence="false" id="S3.E1X.2.1.1.m1.1.1.1.1.1.1.1" xref="S3.E1X.2.1.1.m1.1.1.1.1.1.1.1.cmml">|</mo><msub id="S3.E1X.2.1.1.m1.1.1.1.1.1.1.3" xref="S3.E1X.2.1.1.m1.1.1.1.1.1.1.3.cmml"><mi id="S3.E1X.2.1.1.m1.1.1.1.1.1.1.3.2" xref="S3.E1X.2.1.1.m1.1.1.1.1.1.1.3.2.cmml">𝐱</mi><mn id="S3.E1X.2.1.1.m1.1.1.1.1.1.1.3.3" xref="S3.E1X.2.1.1.m1.1.1.1.1.1.1.3.3.cmml">0</mn></msub></mrow><mo id="S3.E1X.2.1.1.m1.1.1.1.1.1.3" rspace="0.330em" stretchy="false" xref="S3.E1X.2.1.1.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E1X.2.1.1.m1.1.1.2" xref="S3.E1X.2.1.1.m1.1.1.2.cmml">=</mo><mi id="S3.E1X.2.1.1.m1.1.1.3" xref="S3.E1X.2.1.1.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="S3.E1X.2.1.1.m1.1b"><apply id="S3.E1X.2.1.1.m1.1.1.cmml" xref="S3.E1X.2.1.1.m1.1.1"><eq id="S3.E1X.2.1.1.m1.1.1.2.cmml" xref="S3.E1X.2.1.1.m1.1.1.2"></eq><apply id="S3.E1X.2.1.1.m1.1.1.1.cmml" xref="S3.E1X.2.1.1.m1.1.1.1"><times id="S3.E1X.2.1.1.m1.1.1.1.2.cmml" xref="S3.E1X.2.1.1.m1.1.1.1.2"></times><ci id="S3.E1X.2.1.1.m1.1.1.1.3.cmml" xref="S3.E1X.2.1.1.m1.1.1.1.3">𝑞</ci><apply id="S3.E1X.2.1.1.m1.1.1.1.1.1.1.cmml" xref="S3.E1X.2.1.1.m1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E1X.2.1.1.m1.1.1.1.1.1.1.1.cmml" xref="S3.E1X.2.1.1.m1.1.1.1.1.1.1.1">conditional</csymbol><apply id="S3.E1X.2.1.1.m1.1.1.1.1.1.1.2.cmml" xref="S3.E1X.2.1.1.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E1X.2.1.1.m1.1.1.1.1.1.1.2.1.cmml" xref="S3.E1X.2.1.1.m1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E1X.2.1.1.m1.1.1.1.1.1.1.2.2.cmml" xref="S3.E1X.2.1.1.m1.1.1.1.1.1.1.2.2">𝐱</ci><apply id="S3.E1X.2.1.1.m1.1.1.1.1.1.1.2.3.cmml" xref="S3.E1X.2.1.1.m1.1.1.1.1.1.1.2.3"><ci id="S3.E1X.2.1.1.m1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E1X.2.1.1.m1.1.1.1.1.1.1.2.3.1">:</ci><cn id="S3.E1X.2.1.1.m1.1.1.1.1.1.1.2.3.2.cmml" type="integer" xref="S3.E1X.2.1.1.m1.1.1.1.1.1.1.2.3.2">1</cn><ci id="S3.E1X.2.1.1.m1.1.1.1.1.1.1.2.3.3.cmml" xref="S3.E1X.2.1.1.m1.1.1.1.1.1.1.2.3.3">𝑇</ci></apply></apply><apply id="S3.E1X.2.1.1.m1.1.1.1.1.1.1.3.cmml" xref="S3.E1X.2.1.1.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E1X.2.1.1.m1.1.1.1.1.1.1.3.1.cmml" xref="S3.E1X.2.1.1.m1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E1X.2.1.1.m1.1.1.1.1.1.1.3.2.cmml" xref="S3.E1X.2.1.1.m1.1.1.1.1.1.1.3.2">𝐱</ci><cn id="S3.E1X.2.1.1.m1.1.1.1.1.1.1.3.3.cmml" type="integer" xref="S3.E1X.2.1.1.m1.1.1.1.1.1.1.3.3">0</cn></apply></apply></apply><csymbol cd="latexml" id="S3.E1X.2.1.1.m1.1.1.3.cmml" xref="S3.E1X.2.1.1.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1X.2.1.1.m1.1c">\displaystyle q(\mathbf{x}_{1:T}|\mathbf{x}_{0})~{}={}</annotation><annotation encoding="application/x-llamapun" id="S3.E1X.2.1.1.m1.1d">italic_q ( bold_x start_POSTSUBSCRIPT 1 : italic_T end_POSTSUBSCRIPT | bold_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ) =</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\mathop{\prod}_{t=1}^{T}q(\mathbf{x}_{t}|\mathbf{x}_{t-1}),~{}~{}%
~{}~{}q(\mathbf{x}_{t}|\mathbf{x}_{t-1})=\mathcal{N}(\mathbf{x}_{t}|\sqrt{%
\alpha}\mathbf{x}_{t-1},(1-\alpha)\mathbf{I})," class="ltx_Math" display="inline" id="S3.E1X.3.2.2.m1.1"><semantics id="S3.E1X.3.2.2.m1.1a"><mrow id="S3.E1X.3.2.2.m1.1.1.1" xref="S3.E1X.3.2.2.m1.1.1.1.1.cmml"><mrow id="S3.E1X.3.2.2.m1.1.1.1.1" xref="S3.E1X.3.2.2.m1.1.1.1.1.cmml"><mrow id="S3.E1X.3.2.2.m1.1.1.1.1.2.2" xref="S3.E1X.3.2.2.m1.1.1.1.1.2.3.cmml"><mrow id="S3.E1X.3.2.2.m1.1.1.1.1.1.1.1" xref="S3.E1X.3.2.2.m1.1.1.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="S3.E1X.3.2.2.m1.1.1.1.1.1.1.1.2" xref="S3.E1X.3.2.2.m1.1.1.1.1.1.1.1.2.cmml"><munderover id="S3.E1X.3.2.2.m1.1.1.1.1.1.1.1.2a" xref="S3.E1X.3.2.2.m1.1.1.1.1.1.1.1.2.cmml"><mo id="S3.E1X.3.2.2.m1.1.1.1.1.1.1.1.2.2.2" largeop="false" movablelimits="false" xref="S3.E1X.3.2.2.m1.1.1.1.1.1.1.1.2.2.2.cmml">∏</mo><mrow id="S3.E1X.3.2.2.m1.1.1.1.1.1.1.1.2.2.3" xref="S3.E1X.3.2.2.m1.1.1.1.1.1.1.1.2.2.3.cmml"><mi id="S3.E1X.3.2.2.m1.1.1.1.1.1.1.1.2.2.3.2" xref="S3.E1X.3.2.2.m1.1.1.1.1.1.1.1.2.2.3.2.cmml">t</mi><mo id="S3.E1X.3.2.2.m1.1.1.1.1.1.1.1.2.2.3.1" xref="S3.E1X.3.2.2.m1.1.1.1.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S3.E1X.3.2.2.m1.1.1.1.1.1.1.1.2.2.3.3" xref="S3.E1X.3.2.2.m1.1.1.1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E1X.3.2.2.m1.1.1.1.1.1.1.1.2.3" xref="S3.E1X.3.2.2.m1.1.1.1.1.1.1.1.2.3.cmml">T</mi></munderover></mstyle><mrow id="S3.E1X.3.2.2.m1.1.1.1.1.1.1.1.1" xref="S3.E1X.3.2.2.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E1X.3.2.2.m1.1.1.1.1.1.1.1.1.3" xref="S3.E1X.3.2.2.m1.1.1.1.1.1.1.1.1.3.cmml">q</mi><mo id="S3.E1X.3.2.2.m1.1.1.1.1.1.1.1.1.2" xref="S3.E1X.3.2.2.m1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E1X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1" xref="S3.E1X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E1X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E1X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E1X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E1X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E1X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E1X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E1X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E1X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">𝐱</mi><mi id="S3.E1X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E1X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">t</mi></msub><mo fence="false" id="S3.E1X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E1X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">|</mo><msub id="S3.E1X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E1X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E1X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E1X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">𝐱</mi><mrow id="S3.E1X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E1X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="S3.E1X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.2" xref="S3.E1X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.cmml">t</mi><mo id="S3.E1X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.1" xref="S3.E1X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml">−</mo><mn id="S3.E1X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.3" xref="S3.E1X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.3.cmml">1</mn></mrow></msub></mrow><mo id="S3.E1X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E1X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E1X.3.2.2.m1.1.1.1.1.2.2.3" rspace="1.487em" xref="S3.E1X.3.2.2.m1.1.1.1.1.2.3.cmml">,</mo><mrow id="S3.E1X.3.2.2.m1.1.1.1.1.2.2.2" xref="S3.E1X.3.2.2.m1.1.1.1.1.2.2.2.cmml"><mi id="S3.E1X.3.2.2.m1.1.1.1.1.2.2.2.3" xref="S3.E1X.3.2.2.m1.1.1.1.1.2.2.2.3.cmml">q</mi><mo id="S3.E1X.3.2.2.m1.1.1.1.1.2.2.2.2" xref="S3.E1X.3.2.2.m1.1.1.1.1.2.2.2.2.cmml">⁢</mo><mrow id="S3.E1X.3.2.2.m1.1.1.1.1.2.2.2.1.1" xref="S3.E1X.3.2.2.m1.1.1.1.1.2.2.2.1.1.1.cmml"><mo id="S3.E1X.3.2.2.m1.1.1.1.1.2.2.2.1.1.2" stretchy="false" xref="S3.E1X.3.2.2.m1.1.1.1.1.2.2.2.1.1.1.cmml">(</mo><mrow id="S3.E1X.3.2.2.m1.1.1.1.1.2.2.2.1.1.1" xref="S3.E1X.3.2.2.m1.1.1.1.1.2.2.2.1.1.1.cmml"><msub id="S3.E1X.3.2.2.m1.1.1.1.1.2.2.2.1.1.1.2" xref="S3.E1X.3.2.2.m1.1.1.1.1.2.2.2.1.1.1.2.cmml"><mi id="S3.E1X.3.2.2.m1.1.1.1.1.2.2.2.1.1.1.2.2" xref="S3.E1X.3.2.2.m1.1.1.1.1.2.2.2.1.1.1.2.2.cmml">𝐱</mi><mi id="S3.E1X.3.2.2.m1.1.1.1.1.2.2.2.1.1.1.2.3" xref="S3.E1X.3.2.2.m1.1.1.1.1.2.2.2.1.1.1.2.3.cmml">t</mi></msub><mo fence="false" id="S3.E1X.3.2.2.m1.1.1.1.1.2.2.2.1.1.1.1" xref="S3.E1X.3.2.2.m1.1.1.1.1.2.2.2.1.1.1.1.cmml">|</mo><msub id="S3.E1X.3.2.2.m1.1.1.1.1.2.2.2.1.1.1.3" xref="S3.E1X.3.2.2.m1.1.1.1.1.2.2.2.1.1.1.3.cmml"><mi id="S3.E1X.3.2.2.m1.1.1.1.1.2.2.2.1.1.1.3.2" xref="S3.E1X.3.2.2.m1.1.1.1.1.2.2.2.1.1.1.3.2.cmml">𝐱</mi><mrow id="S3.E1X.3.2.2.m1.1.1.1.1.2.2.2.1.1.1.3.3" xref="S3.E1X.3.2.2.m1.1.1.1.1.2.2.2.1.1.1.3.3.cmml"><mi id="S3.E1X.3.2.2.m1.1.1.1.1.2.2.2.1.1.1.3.3.2" xref="S3.E1X.3.2.2.m1.1.1.1.1.2.2.2.1.1.1.3.3.2.cmml">t</mi><mo id="S3.E1X.3.2.2.m1.1.1.1.1.2.2.2.1.1.1.3.3.1" xref="S3.E1X.3.2.2.m1.1.1.1.1.2.2.2.1.1.1.3.3.1.cmml">−</mo><mn id="S3.E1X.3.2.2.m1.1.1.1.1.2.2.2.1.1.1.3.3.3" xref="S3.E1X.3.2.2.m1.1.1.1.1.2.2.2.1.1.1.3.3.3.cmml">1</mn></mrow></msub></mrow><mo id="S3.E1X.3.2.2.m1.1.1.1.1.2.2.2.1.1.3" stretchy="false" xref="S3.E1X.3.2.2.m1.1.1.1.1.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E1X.3.2.2.m1.1.1.1.1.4" xref="S3.E1X.3.2.2.m1.1.1.1.1.4.cmml">=</mo><mrow id="S3.E1X.3.2.2.m1.1.1.1.1.3" xref="S3.E1X.3.2.2.m1.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E1X.3.2.2.m1.1.1.1.1.3.3" xref="S3.E1X.3.2.2.m1.1.1.1.1.3.3.cmml">𝒩</mi><mo id="S3.E1X.3.2.2.m1.1.1.1.1.3.2" xref="S3.E1X.3.2.2.m1.1.1.1.1.3.2.cmml">⁢</mo><mrow id="S3.E1X.3.2.2.m1.1.1.1.1.3.1.1" xref="S3.E1X.3.2.2.m1.1.1.1.1.3.1.1.1.cmml"><mo id="S3.E1X.3.2.2.m1.1.1.1.1.3.1.1.2" stretchy="false" xref="S3.E1X.3.2.2.m1.1.1.1.1.3.1.1.1.cmml">(</mo><mrow id="S3.E1X.3.2.2.m1.1.1.1.1.3.1.1.1" xref="S3.E1X.3.2.2.m1.1.1.1.1.3.1.1.1.cmml"><msub id="S3.E1X.3.2.2.m1.1.1.1.1.3.1.1.1.4" xref="S3.E1X.3.2.2.m1.1.1.1.1.3.1.1.1.4.cmml"><mi id="S3.E1X.3.2.2.m1.1.1.1.1.3.1.1.1.4.2" xref="S3.E1X.3.2.2.m1.1.1.1.1.3.1.1.1.4.2.cmml">𝐱</mi><mi id="S3.E1X.3.2.2.m1.1.1.1.1.3.1.1.1.4.3" xref="S3.E1X.3.2.2.m1.1.1.1.1.3.1.1.1.4.3.cmml">t</mi></msub><mo fence="false" id="S3.E1X.3.2.2.m1.1.1.1.1.3.1.1.1.3" xref="S3.E1X.3.2.2.m1.1.1.1.1.3.1.1.1.3.cmml">|</mo><mrow id="S3.E1X.3.2.2.m1.1.1.1.1.3.1.1.1.2.2" xref="S3.E1X.3.2.2.m1.1.1.1.1.3.1.1.1.2.3.cmml"><mrow id="S3.E1X.3.2.2.m1.1.1.1.1.3.1.1.1.1.1.1" xref="S3.E1X.3.2.2.m1.1.1.1.1.3.1.1.1.1.1.1.cmml"><msqrt id="S3.E1X.3.2.2.m1.1.1.1.1.3.1.1.1.1.1.1.2" xref="S3.E1X.3.2.2.m1.1.1.1.1.3.1.1.1.1.1.1.2.cmml"><mi id="S3.E1X.3.2.2.m1.1.1.1.1.3.1.1.1.1.1.1.2.2" xref="S3.E1X.3.2.2.m1.1.1.1.1.3.1.1.1.1.1.1.2.2.cmml">α</mi></msqrt><mo id="S3.E1X.3.2.2.m1.1.1.1.1.3.1.1.1.1.1.1.1" xref="S3.E1X.3.2.2.m1.1.1.1.1.3.1.1.1.1.1.1.1.cmml">⁢</mo><msub id="S3.E1X.3.2.2.m1.1.1.1.1.3.1.1.1.1.1.1.3" xref="S3.E1X.3.2.2.m1.1.1.1.1.3.1.1.1.1.1.1.3.cmml"><mi id="S3.E1X.3.2.2.m1.1.1.1.1.3.1.1.1.1.1.1.3.2" xref="S3.E1X.3.2.2.m1.1.1.1.1.3.1.1.1.1.1.1.3.2.cmml">𝐱</mi><mrow id="S3.E1X.3.2.2.m1.1.1.1.1.3.1.1.1.1.1.1.3.3" xref="S3.E1X.3.2.2.m1.1.1.1.1.3.1.1.1.1.1.1.3.3.cmml"><mi id="S3.E1X.3.2.2.m1.1.1.1.1.3.1.1.1.1.1.1.3.3.2" xref="S3.E1X.3.2.2.m1.1.1.1.1.3.1.1.1.1.1.1.3.3.2.cmml">t</mi><mo id="S3.E1X.3.2.2.m1.1.1.1.1.3.1.1.1.1.1.1.3.3.1" xref="S3.E1X.3.2.2.m1.1.1.1.1.3.1.1.1.1.1.1.3.3.1.cmml">−</mo><mn id="S3.E1X.3.2.2.m1.1.1.1.1.3.1.1.1.1.1.1.3.3.3" xref="S3.E1X.3.2.2.m1.1.1.1.1.3.1.1.1.1.1.1.3.3.3.cmml">1</mn></mrow></msub></mrow><mo id="S3.E1X.3.2.2.m1.1.1.1.1.3.1.1.1.2.2.3" xref="S3.E1X.3.2.2.m1.1.1.1.1.3.1.1.1.2.3.cmml">,</mo><mrow id="S3.E1X.3.2.2.m1.1.1.1.1.3.1.1.1.2.2.2" xref="S3.E1X.3.2.2.m1.1.1.1.1.3.1.1.1.2.2.2.cmml"><mrow id="S3.E1X.3.2.2.m1.1.1.1.1.3.1.1.1.2.2.2.1.1" xref="S3.E1X.3.2.2.m1.1.1.1.1.3.1.1.1.2.2.2.1.1.1.cmml"><mo id="S3.E1X.3.2.2.m1.1.1.1.1.3.1.1.1.2.2.2.1.1.2" stretchy="false" xref="S3.E1X.3.2.2.m1.1.1.1.1.3.1.1.1.2.2.2.1.1.1.cmml">(</mo><mrow id="S3.E1X.3.2.2.m1.1.1.1.1.3.1.1.1.2.2.2.1.1.1" xref="S3.E1X.3.2.2.m1.1.1.1.1.3.1.1.1.2.2.2.1.1.1.cmml"><mn id="S3.E1X.3.2.2.m1.1.1.1.1.3.1.1.1.2.2.2.1.1.1.2" xref="S3.E1X.3.2.2.m1.1.1.1.1.3.1.1.1.2.2.2.1.1.1.2.cmml">1</mn><mo id="S3.E1X.3.2.2.m1.1.1.1.1.3.1.1.1.2.2.2.1.1.1.1" xref="S3.E1X.3.2.2.m1.1.1.1.1.3.1.1.1.2.2.2.1.1.1.1.cmml">−</mo><mi id="S3.E1X.3.2.2.m1.1.1.1.1.3.1.1.1.2.2.2.1.1.1.3" xref="S3.E1X.3.2.2.m1.1.1.1.1.3.1.1.1.2.2.2.1.1.1.3.cmml">α</mi></mrow><mo id="S3.E1X.3.2.2.m1.1.1.1.1.3.1.1.1.2.2.2.1.1.3" stretchy="false" xref="S3.E1X.3.2.2.m1.1.1.1.1.3.1.1.1.2.2.2.1.1.1.cmml">)</mo></mrow><mo id="S3.E1X.3.2.2.m1.1.1.1.1.3.1.1.1.2.2.2.2" xref="S3.E1X.3.2.2.m1.1.1.1.1.3.1.1.1.2.2.2.2.cmml">⁢</mo><mi id="S3.E1X.3.2.2.m1.1.1.1.1.3.1.1.1.2.2.2.3" xref="S3.E1X.3.2.2.m1.1.1.1.1.3.1.1.1.2.2.2.3.cmml">𝐈</mi></mrow></mrow></mrow><mo id="S3.E1X.3.2.2.m1.1.1.1.1.3.1.1.3" stretchy="false" xref="S3.E1X.3.2.2.m1.1.1.1.1.3.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E1X.3.2.2.m1.1.1.1.2" xref="S3.E1X.3.2.2.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E1X.3.2.2.m1.1b"><apply id="S3.E1X.3.2.2.m1.1.1.1.1.cmml" xref="S3.E1X.3.2.2.m1.1.1.1"><eq id="S3.E1X.3.2.2.m1.1.1.1.1.4.cmml" xref="S3.E1X.3.2.2.m1.1.1.1.1.4"></eq><list id="S3.E1X.3.2.2.m1.1.1.1.1.2.3.cmml" xref="S3.E1X.3.2.2.m1.1.1.1.1.2.2"><apply id="S3.E1X.3.2.2.m1.1.1.1.1.1.1.1.cmml" xref="S3.E1X.3.2.2.m1.1.1.1.1.1.1.1"><apply id="S3.E1X.3.2.2.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1X.3.2.2.m1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E1X.3.2.2.m1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E1X.3.2.2.m1.1.1.1.1.1.1.1.2">superscript</csymbol><apply id="S3.E1X.3.2.2.m1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E1X.3.2.2.m1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E1X.3.2.2.m1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E1X.3.2.2.m1.1.1.1.1.1.1.1.2">subscript</csymbol><csymbol cd="latexml" id="S3.E1X.3.2.2.m1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E1X.3.2.2.m1.1.1.1.1.1.1.1.2.2.2">product</csymbol><apply id="S3.E1X.3.2.2.m1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E1X.3.2.2.m1.1.1.1.1.1.1.1.2.2.3"><eq id="S3.E1X.3.2.2.m1.1.1.1.1.1.1.1.2.2.3.1.cmml" xref="S3.E1X.3.2.2.m1.1.1.1.1.1.1.1.2.2.3.1"></eq><ci id="S3.E1X.3.2.2.m1.1.1.1.1.1.1.1.2.2.3.2.cmml" xref="S3.E1X.3.2.2.m1.1.1.1.1.1.1.1.2.2.3.2">𝑡</ci><cn id="S3.E1X.3.2.2.m1.1.1.1.1.1.1.1.2.2.3.3.cmml" type="integer" xref="S3.E1X.3.2.2.m1.1.1.1.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S3.E1X.3.2.2.m1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E1X.3.2.2.m1.1.1.1.1.1.1.1.2.3">𝑇</ci></apply><apply id="S3.E1X.3.2.2.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1X.3.2.2.m1.1.1.1.1.1.1.1.1"><times id="S3.E1X.3.2.2.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1X.3.2.2.m1.1.1.1.1.1.1.1.1.2"></times><ci id="S3.E1X.3.2.2.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E1X.3.2.2.m1.1.1.1.1.1.1.1.1.3">𝑞</ci><apply id="S3.E1X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E1X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.1">conditional</csymbol><apply id="S3.E1X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E1X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E1X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E1X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E1X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.2.2">𝐱</ci><ci id="S3.E1X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E1X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.2.3">𝑡</ci></apply><apply id="S3.E1X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E1X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E1X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E1X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E1X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E1X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.3.2">𝐱</ci><apply id="S3.E1X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E1X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.3.3"><minus id="S3.E1X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.E1X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.1"></minus><ci id="S3.E1X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S3.E1X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.2">𝑡</ci><cn id="S3.E1X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.3.cmml" type="integer" xref="S3.E1X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.3">1</cn></apply></apply></apply></apply></apply><apply id="S3.E1X.3.2.2.m1.1.1.1.1.2.2.2.cmml" xref="S3.E1X.3.2.2.m1.1.1.1.1.2.2.2"><times id="S3.E1X.3.2.2.m1.1.1.1.1.2.2.2.2.cmml" xref="S3.E1X.3.2.2.m1.1.1.1.1.2.2.2.2"></times><ci id="S3.E1X.3.2.2.m1.1.1.1.1.2.2.2.3.cmml" xref="S3.E1X.3.2.2.m1.1.1.1.1.2.2.2.3">𝑞</ci><apply id="S3.E1X.3.2.2.m1.1.1.1.1.2.2.2.1.1.1.cmml" xref="S3.E1X.3.2.2.m1.1.1.1.1.2.2.2.1.1"><csymbol cd="latexml" id="S3.E1X.3.2.2.m1.1.1.1.1.2.2.2.1.1.1.1.cmml" xref="S3.E1X.3.2.2.m1.1.1.1.1.2.2.2.1.1.1.1">conditional</csymbol><apply id="S3.E1X.3.2.2.m1.1.1.1.1.2.2.2.1.1.1.2.cmml" xref="S3.E1X.3.2.2.m1.1.1.1.1.2.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S3.E1X.3.2.2.m1.1.1.1.1.2.2.2.1.1.1.2.1.cmml" xref="S3.E1X.3.2.2.m1.1.1.1.1.2.2.2.1.1.1.2">subscript</csymbol><ci id="S3.E1X.3.2.2.m1.1.1.1.1.2.2.2.1.1.1.2.2.cmml" xref="S3.E1X.3.2.2.m1.1.1.1.1.2.2.2.1.1.1.2.2">𝐱</ci><ci id="S3.E1X.3.2.2.m1.1.1.1.1.2.2.2.1.1.1.2.3.cmml" xref="S3.E1X.3.2.2.m1.1.1.1.1.2.2.2.1.1.1.2.3">𝑡</ci></apply><apply id="S3.E1X.3.2.2.m1.1.1.1.1.2.2.2.1.1.1.3.cmml" xref="S3.E1X.3.2.2.m1.1.1.1.1.2.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.E1X.3.2.2.m1.1.1.1.1.2.2.2.1.1.1.3.1.cmml" xref="S3.E1X.3.2.2.m1.1.1.1.1.2.2.2.1.1.1.3">subscript</csymbol><ci id="S3.E1X.3.2.2.m1.1.1.1.1.2.2.2.1.1.1.3.2.cmml" xref="S3.E1X.3.2.2.m1.1.1.1.1.2.2.2.1.1.1.3.2">𝐱</ci><apply id="S3.E1X.3.2.2.m1.1.1.1.1.2.2.2.1.1.1.3.3.cmml" xref="S3.E1X.3.2.2.m1.1.1.1.1.2.2.2.1.1.1.3.3"><minus id="S3.E1X.3.2.2.m1.1.1.1.1.2.2.2.1.1.1.3.3.1.cmml" xref="S3.E1X.3.2.2.m1.1.1.1.1.2.2.2.1.1.1.3.3.1"></minus><ci id="S3.E1X.3.2.2.m1.1.1.1.1.2.2.2.1.1.1.3.3.2.cmml" xref="S3.E1X.3.2.2.m1.1.1.1.1.2.2.2.1.1.1.3.3.2">𝑡</ci><cn id="S3.E1X.3.2.2.m1.1.1.1.1.2.2.2.1.1.1.3.3.3.cmml" type="integer" xref="S3.E1X.3.2.2.m1.1.1.1.1.2.2.2.1.1.1.3.3.3">1</cn></apply></apply></apply></apply></list><apply id="S3.E1X.3.2.2.m1.1.1.1.1.3.cmml" xref="S3.E1X.3.2.2.m1.1.1.1.1.3"><times id="S3.E1X.3.2.2.m1.1.1.1.1.3.2.cmml" xref="S3.E1X.3.2.2.m1.1.1.1.1.3.2"></times><ci id="S3.E1X.3.2.2.m1.1.1.1.1.3.3.cmml" xref="S3.E1X.3.2.2.m1.1.1.1.1.3.3">𝒩</ci><apply id="S3.E1X.3.2.2.m1.1.1.1.1.3.1.1.1.cmml" xref="S3.E1X.3.2.2.m1.1.1.1.1.3.1.1"><csymbol cd="latexml" id="S3.E1X.3.2.2.m1.1.1.1.1.3.1.1.1.3.cmml" xref="S3.E1X.3.2.2.m1.1.1.1.1.3.1.1.1.3">conditional</csymbol><apply id="S3.E1X.3.2.2.m1.1.1.1.1.3.1.1.1.4.cmml" xref="S3.E1X.3.2.2.m1.1.1.1.1.3.1.1.1.4"><csymbol cd="ambiguous" id="S3.E1X.3.2.2.m1.1.1.1.1.3.1.1.1.4.1.cmml" xref="S3.E1X.3.2.2.m1.1.1.1.1.3.1.1.1.4">subscript</csymbol><ci id="S3.E1X.3.2.2.m1.1.1.1.1.3.1.1.1.4.2.cmml" xref="S3.E1X.3.2.2.m1.1.1.1.1.3.1.1.1.4.2">𝐱</ci><ci id="S3.E1X.3.2.2.m1.1.1.1.1.3.1.1.1.4.3.cmml" xref="S3.E1X.3.2.2.m1.1.1.1.1.3.1.1.1.4.3">𝑡</ci></apply><list id="S3.E1X.3.2.2.m1.1.1.1.1.3.1.1.1.2.3.cmml" xref="S3.E1X.3.2.2.m1.1.1.1.1.3.1.1.1.2.2"><apply id="S3.E1X.3.2.2.m1.1.1.1.1.3.1.1.1.1.1.1.cmml" xref="S3.E1X.3.2.2.m1.1.1.1.1.3.1.1.1.1.1.1"><times id="S3.E1X.3.2.2.m1.1.1.1.1.3.1.1.1.1.1.1.1.cmml" xref="S3.E1X.3.2.2.m1.1.1.1.1.3.1.1.1.1.1.1.1"></times><apply id="S3.E1X.3.2.2.m1.1.1.1.1.3.1.1.1.1.1.1.2.cmml" xref="S3.E1X.3.2.2.m1.1.1.1.1.3.1.1.1.1.1.1.2"><root id="S3.E1X.3.2.2.m1.1.1.1.1.3.1.1.1.1.1.1.2a.cmml" xref="S3.E1X.3.2.2.m1.1.1.1.1.3.1.1.1.1.1.1.2"></root><ci id="S3.E1X.3.2.2.m1.1.1.1.1.3.1.1.1.1.1.1.2.2.cmml" xref="S3.E1X.3.2.2.m1.1.1.1.1.3.1.1.1.1.1.1.2.2">𝛼</ci></apply><apply id="S3.E1X.3.2.2.m1.1.1.1.1.3.1.1.1.1.1.1.3.cmml" xref="S3.E1X.3.2.2.m1.1.1.1.1.3.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E1X.3.2.2.m1.1.1.1.1.3.1.1.1.1.1.1.3.1.cmml" xref="S3.E1X.3.2.2.m1.1.1.1.1.3.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E1X.3.2.2.m1.1.1.1.1.3.1.1.1.1.1.1.3.2.cmml" xref="S3.E1X.3.2.2.m1.1.1.1.1.3.1.1.1.1.1.1.3.2">𝐱</ci><apply id="S3.E1X.3.2.2.m1.1.1.1.1.3.1.1.1.1.1.1.3.3.cmml" xref="S3.E1X.3.2.2.m1.1.1.1.1.3.1.1.1.1.1.1.3.3"><minus id="S3.E1X.3.2.2.m1.1.1.1.1.3.1.1.1.1.1.1.3.3.1.cmml" xref="S3.E1X.3.2.2.m1.1.1.1.1.3.1.1.1.1.1.1.3.3.1"></minus><ci id="S3.E1X.3.2.2.m1.1.1.1.1.3.1.1.1.1.1.1.3.3.2.cmml" xref="S3.E1X.3.2.2.m1.1.1.1.1.3.1.1.1.1.1.1.3.3.2">𝑡</ci><cn id="S3.E1X.3.2.2.m1.1.1.1.1.3.1.1.1.1.1.1.3.3.3.cmml" type="integer" xref="S3.E1X.3.2.2.m1.1.1.1.1.3.1.1.1.1.1.1.3.3.3">1</cn></apply></apply></apply><apply id="S3.E1X.3.2.2.m1.1.1.1.1.3.1.1.1.2.2.2.cmml" xref="S3.E1X.3.2.2.m1.1.1.1.1.3.1.1.1.2.2.2"><times id="S3.E1X.3.2.2.m1.1.1.1.1.3.1.1.1.2.2.2.2.cmml" xref="S3.E1X.3.2.2.m1.1.1.1.1.3.1.1.1.2.2.2.2"></times><apply id="S3.E1X.3.2.2.m1.1.1.1.1.3.1.1.1.2.2.2.1.1.1.cmml" xref="S3.E1X.3.2.2.m1.1.1.1.1.3.1.1.1.2.2.2.1.1"><minus id="S3.E1X.3.2.2.m1.1.1.1.1.3.1.1.1.2.2.2.1.1.1.1.cmml" xref="S3.E1X.3.2.2.m1.1.1.1.1.3.1.1.1.2.2.2.1.1.1.1"></minus><cn id="S3.E1X.3.2.2.m1.1.1.1.1.3.1.1.1.2.2.2.1.1.1.2.cmml" type="integer" xref="S3.E1X.3.2.2.m1.1.1.1.1.3.1.1.1.2.2.2.1.1.1.2">1</cn><ci id="S3.E1X.3.2.2.m1.1.1.1.1.3.1.1.1.2.2.2.1.1.1.3.cmml" xref="S3.E1X.3.2.2.m1.1.1.1.1.3.1.1.1.2.2.2.1.1.1.3">𝛼</ci></apply><ci id="S3.E1X.3.2.2.m1.1.1.1.1.3.1.1.1.2.2.2.3.cmml" xref="S3.E1X.3.2.2.m1.1.1.1.1.3.1.1.1.2.2.2.3">𝐈</ci></apply></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1X.3.2.2.m1.1c">\displaystyle\mathop{\prod}_{t=1}^{T}q(\mathbf{x}_{t}|\mathbf{x}_{t-1}),~{}~{}%
~{}~{}q(\mathbf{x}_{t}|\mathbf{x}_{t-1})=\mathcal{N}(\mathbf{x}_{t}|\sqrt{%
\alpha}\mathbf{x}_{t-1},(1-\alpha)\mathbf{I}),</annotation><annotation encoding="application/x-llamapun" id="S3.E1X.3.2.2.m1.1d">∏ start_POSTSUBSCRIPT italic_t = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_q ( bold_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT | bold_x start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT ) , italic_q ( bold_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT | bold_x start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT ) = caligraphic_N ( bold_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT | square-root start_ARG italic_α end_ARG bold_x start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT , ( 1 - italic_α ) bold_I ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(1)</span></td>
</tr>
</tbody>
</table>
<p class="ltx_p" id="S3.SS1.p1.5">where <math alttext="\mathbf{x}_{1},\cdots,\mathbf{x}_{T}" class="ltx_Math" display="inline" id="S3.SS1.p1.2.m1.3"><semantics id="S3.SS1.p1.2.m1.3a"><mrow id="S3.SS1.p1.2.m1.3.3.2" xref="S3.SS1.p1.2.m1.3.3.3.cmml"><msub id="S3.SS1.p1.2.m1.2.2.1.1" xref="S3.SS1.p1.2.m1.2.2.1.1.cmml"><mi id="S3.SS1.p1.2.m1.2.2.1.1.2" xref="S3.SS1.p1.2.m1.2.2.1.1.2.cmml">𝐱</mi><mn id="S3.SS1.p1.2.m1.2.2.1.1.3" xref="S3.SS1.p1.2.m1.2.2.1.1.3.cmml">1</mn></msub><mo id="S3.SS1.p1.2.m1.3.3.2.3" xref="S3.SS1.p1.2.m1.3.3.3.cmml">,</mo><mi id="S3.SS1.p1.2.m1.1.1" mathvariant="normal" xref="S3.SS1.p1.2.m1.1.1.cmml">⋯</mi><mo id="S3.SS1.p1.2.m1.3.3.2.4" xref="S3.SS1.p1.2.m1.3.3.3.cmml">,</mo><msub id="S3.SS1.p1.2.m1.3.3.2.2" xref="S3.SS1.p1.2.m1.3.3.2.2.cmml"><mi id="S3.SS1.p1.2.m1.3.3.2.2.2" xref="S3.SS1.p1.2.m1.3.3.2.2.2.cmml">𝐱</mi><mi id="S3.SS1.p1.2.m1.3.3.2.2.3" xref="S3.SS1.p1.2.m1.3.3.2.2.3.cmml">T</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m1.3b"><list id="S3.SS1.p1.2.m1.3.3.3.cmml" xref="S3.SS1.p1.2.m1.3.3.2"><apply id="S3.SS1.p1.2.m1.2.2.1.1.cmml" xref="S3.SS1.p1.2.m1.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m1.2.2.1.1.1.cmml" xref="S3.SS1.p1.2.m1.2.2.1.1">subscript</csymbol><ci id="S3.SS1.p1.2.m1.2.2.1.1.2.cmml" xref="S3.SS1.p1.2.m1.2.2.1.1.2">𝐱</ci><cn id="S3.SS1.p1.2.m1.2.2.1.1.3.cmml" type="integer" xref="S3.SS1.p1.2.m1.2.2.1.1.3">1</cn></apply><ci id="S3.SS1.p1.2.m1.1.1.cmml" xref="S3.SS1.p1.2.m1.1.1">⋯</ci><apply id="S3.SS1.p1.2.m1.3.3.2.2.cmml" xref="S3.SS1.p1.2.m1.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m1.3.3.2.2.1.cmml" xref="S3.SS1.p1.2.m1.3.3.2.2">subscript</csymbol><ci id="S3.SS1.p1.2.m1.3.3.2.2.2.cmml" xref="S3.SS1.p1.2.m1.3.3.2.2.2">𝐱</ci><ci id="S3.SS1.p1.2.m1.3.3.2.2.3.cmml" xref="S3.SS1.p1.2.m1.3.3.2.2.3">𝑇</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m1.3c">\mathbf{x}_{1},\cdots,\mathbf{x}_{T}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.2.m1.3d">bold_x start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , ⋯ , bold_x start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT</annotation></semantics></math> are latent variables, and <math alttext="\alpha" class="ltx_Math" display="inline" id="S3.SS1.p1.3.m2.1"><semantics id="S3.SS1.p1.3.m2.1a"><mi id="S3.SS1.p1.3.m2.1.1" xref="S3.SS1.p1.3.m2.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m2.1b"><ci id="S3.SS1.p1.3.m2.1.1.cmml" xref="S3.SS1.p1.3.m2.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m2.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.3.m2.1d">italic_α</annotation></semantics></math> is a noise scheduling factor. Equivalently, <math alttext="\mathbf{x}_{t}=\sqrt{\alpha}\mathbf{x}_{t-1}+\sqrt{1-\alpha}\epsilon" class="ltx_Math" display="inline" id="S3.SS1.p1.4.m3.1"><semantics id="S3.SS1.p1.4.m3.1a"><mrow id="S3.SS1.p1.4.m3.1.1" xref="S3.SS1.p1.4.m3.1.1.cmml"><msub id="S3.SS1.p1.4.m3.1.1.2" xref="S3.SS1.p1.4.m3.1.1.2.cmml"><mi id="S3.SS1.p1.4.m3.1.1.2.2" xref="S3.SS1.p1.4.m3.1.1.2.2.cmml">𝐱</mi><mi id="S3.SS1.p1.4.m3.1.1.2.3" xref="S3.SS1.p1.4.m3.1.1.2.3.cmml">t</mi></msub><mo id="S3.SS1.p1.4.m3.1.1.1" xref="S3.SS1.p1.4.m3.1.1.1.cmml">=</mo><mrow id="S3.SS1.p1.4.m3.1.1.3" xref="S3.SS1.p1.4.m3.1.1.3.cmml"><mrow id="S3.SS1.p1.4.m3.1.1.3.2" xref="S3.SS1.p1.4.m3.1.1.3.2.cmml"><msqrt id="S3.SS1.p1.4.m3.1.1.3.2.2" xref="S3.SS1.p1.4.m3.1.1.3.2.2.cmml"><mi id="S3.SS1.p1.4.m3.1.1.3.2.2.2" xref="S3.SS1.p1.4.m3.1.1.3.2.2.2.cmml">α</mi></msqrt><mo id="S3.SS1.p1.4.m3.1.1.3.2.1" xref="S3.SS1.p1.4.m3.1.1.3.2.1.cmml">⁢</mo><msub id="S3.SS1.p1.4.m3.1.1.3.2.3" xref="S3.SS1.p1.4.m3.1.1.3.2.3.cmml"><mi id="S3.SS1.p1.4.m3.1.1.3.2.3.2" xref="S3.SS1.p1.4.m3.1.1.3.2.3.2.cmml">𝐱</mi><mrow id="S3.SS1.p1.4.m3.1.1.3.2.3.3" xref="S3.SS1.p1.4.m3.1.1.3.2.3.3.cmml"><mi id="S3.SS1.p1.4.m3.1.1.3.2.3.3.2" xref="S3.SS1.p1.4.m3.1.1.3.2.3.3.2.cmml">t</mi><mo id="S3.SS1.p1.4.m3.1.1.3.2.3.3.1" xref="S3.SS1.p1.4.m3.1.1.3.2.3.3.1.cmml">−</mo><mn id="S3.SS1.p1.4.m3.1.1.3.2.3.3.3" xref="S3.SS1.p1.4.m3.1.1.3.2.3.3.3.cmml">1</mn></mrow></msub></mrow><mo id="S3.SS1.p1.4.m3.1.1.3.1" xref="S3.SS1.p1.4.m3.1.1.3.1.cmml">+</mo><mrow id="S3.SS1.p1.4.m3.1.1.3.3" xref="S3.SS1.p1.4.m3.1.1.3.3.cmml"><msqrt id="S3.SS1.p1.4.m3.1.1.3.3.2" xref="S3.SS1.p1.4.m3.1.1.3.3.2.cmml"><mrow id="S3.SS1.p1.4.m3.1.1.3.3.2.2" xref="S3.SS1.p1.4.m3.1.1.3.3.2.2.cmml"><mn id="S3.SS1.p1.4.m3.1.1.3.3.2.2.2" xref="S3.SS1.p1.4.m3.1.1.3.3.2.2.2.cmml">1</mn><mo id="S3.SS1.p1.4.m3.1.1.3.3.2.2.1" xref="S3.SS1.p1.4.m3.1.1.3.3.2.2.1.cmml">−</mo><mi id="S3.SS1.p1.4.m3.1.1.3.3.2.2.3" xref="S3.SS1.p1.4.m3.1.1.3.3.2.2.3.cmml">α</mi></mrow></msqrt><mo id="S3.SS1.p1.4.m3.1.1.3.3.1" xref="S3.SS1.p1.4.m3.1.1.3.3.1.cmml">⁢</mo><mi id="S3.SS1.p1.4.m3.1.1.3.3.3" xref="S3.SS1.p1.4.m3.1.1.3.3.3.cmml">ϵ</mi></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m3.1b"><apply id="S3.SS1.p1.4.m3.1.1.cmml" xref="S3.SS1.p1.4.m3.1.1"><eq id="S3.SS1.p1.4.m3.1.1.1.cmml" xref="S3.SS1.p1.4.m3.1.1.1"></eq><apply id="S3.SS1.p1.4.m3.1.1.2.cmml" xref="S3.SS1.p1.4.m3.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m3.1.1.2.1.cmml" xref="S3.SS1.p1.4.m3.1.1.2">subscript</csymbol><ci id="S3.SS1.p1.4.m3.1.1.2.2.cmml" xref="S3.SS1.p1.4.m3.1.1.2.2">𝐱</ci><ci id="S3.SS1.p1.4.m3.1.1.2.3.cmml" xref="S3.SS1.p1.4.m3.1.1.2.3">𝑡</ci></apply><apply id="S3.SS1.p1.4.m3.1.1.3.cmml" xref="S3.SS1.p1.4.m3.1.1.3"><plus id="S3.SS1.p1.4.m3.1.1.3.1.cmml" xref="S3.SS1.p1.4.m3.1.1.3.1"></plus><apply id="S3.SS1.p1.4.m3.1.1.3.2.cmml" xref="S3.SS1.p1.4.m3.1.1.3.2"><times id="S3.SS1.p1.4.m3.1.1.3.2.1.cmml" xref="S3.SS1.p1.4.m3.1.1.3.2.1"></times><apply id="S3.SS1.p1.4.m3.1.1.3.2.2.cmml" xref="S3.SS1.p1.4.m3.1.1.3.2.2"><root id="S3.SS1.p1.4.m3.1.1.3.2.2a.cmml" xref="S3.SS1.p1.4.m3.1.1.3.2.2"></root><ci id="S3.SS1.p1.4.m3.1.1.3.2.2.2.cmml" xref="S3.SS1.p1.4.m3.1.1.3.2.2.2">𝛼</ci></apply><apply id="S3.SS1.p1.4.m3.1.1.3.2.3.cmml" xref="S3.SS1.p1.4.m3.1.1.3.2.3"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m3.1.1.3.2.3.1.cmml" xref="S3.SS1.p1.4.m3.1.1.3.2.3">subscript</csymbol><ci id="S3.SS1.p1.4.m3.1.1.3.2.3.2.cmml" xref="S3.SS1.p1.4.m3.1.1.3.2.3.2">𝐱</ci><apply id="S3.SS1.p1.4.m3.1.1.3.2.3.3.cmml" xref="S3.SS1.p1.4.m3.1.1.3.2.3.3"><minus id="S3.SS1.p1.4.m3.1.1.3.2.3.3.1.cmml" xref="S3.SS1.p1.4.m3.1.1.3.2.3.3.1"></minus><ci id="S3.SS1.p1.4.m3.1.1.3.2.3.3.2.cmml" xref="S3.SS1.p1.4.m3.1.1.3.2.3.3.2">𝑡</ci><cn id="S3.SS1.p1.4.m3.1.1.3.2.3.3.3.cmml" type="integer" xref="S3.SS1.p1.4.m3.1.1.3.2.3.3.3">1</cn></apply></apply></apply><apply id="S3.SS1.p1.4.m3.1.1.3.3.cmml" xref="S3.SS1.p1.4.m3.1.1.3.3"><times id="S3.SS1.p1.4.m3.1.1.3.3.1.cmml" xref="S3.SS1.p1.4.m3.1.1.3.3.1"></times><apply id="S3.SS1.p1.4.m3.1.1.3.3.2.cmml" xref="S3.SS1.p1.4.m3.1.1.3.3.2"><root id="S3.SS1.p1.4.m3.1.1.3.3.2a.cmml" xref="S3.SS1.p1.4.m3.1.1.3.3.2"></root><apply id="S3.SS1.p1.4.m3.1.1.3.3.2.2.cmml" xref="S3.SS1.p1.4.m3.1.1.3.3.2.2"><minus id="S3.SS1.p1.4.m3.1.1.3.3.2.2.1.cmml" xref="S3.SS1.p1.4.m3.1.1.3.3.2.2.1"></minus><cn id="S3.SS1.p1.4.m3.1.1.3.3.2.2.2.cmml" type="integer" xref="S3.SS1.p1.4.m3.1.1.3.3.2.2.2">1</cn><ci id="S3.SS1.p1.4.m3.1.1.3.3.2.2.3.cmml" xref="S3.SS1.p1.4.m3.1.1.3.3.2.2.3">𝛼</ci></apply></apply><ci id="S3.SS1.p1.4.m3.1.1.3.3.3.cmml" xref="S3.SS1.p1.4.m3.1.1.3.3.3">italic-ϵ</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m3.1c">\mathbf{x}_{t}=\sqrt{\alpha}\mathbf{x}_{t-1}+\sqrt{1-\alpha}\epsilon</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.4.m3.1d">bold_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = square-root start_ARG italic_α end_ARG bold_x start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT + square-root start_ARG 1 - italic_α end_ARG italic_ϵ</annotation></semantics></math>, where <math alttext="\epsilon\sim\mathcal{N}(0,\mathbf{I})" class="ltx_Math" display="inline" id="S3.SS1.p1.5.m4.2"><semantics id="S3.SS1.p1.5.m4.2a"><mrow id="S3.SS1.p1.5.m4.2.3" xref="S3.SS1.p1.5.m4.2.3.cmml"><mi id="S3.SS1.p1.5.m4.2.3.2" xref="S3.SS1.p1.5.m4.2.3.2.cmml">ϵ</mi><mo id="S3.SS1.p1.5.m4.2.3.1" xref="S3.SS1.p1.5.m4.2.3.1.cmml">∼</mo><mrow id="S3.SS1.p1.5.m4.2.3.3" xref="S3.SS1.p1.5.m4.2.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.5.m4.2.3.3.2" xref="S3.SS1.p1.5.m4.2.3.3.2.cmml">𝒩</mi><mo id="S3.SS1.p1.5.m4.2.3.3.1" xref="S3.SS1.p1.5.m4.2.3.3.1.cmml">⁢</mo><mrow id="S3.SS1.p1.5.m4.2.3.3.3.2" xref="S3.SS1.p1.5.m4.2.3.3.3.1.cmml"><mo id="S3.SS1.p1.5.m4.2.3.3.3.2.1" stretchy="false" xref="S3.SS1.p1.5.m4.2.3.3.3.1.cmml">(</mo><mn id="S3.SS1.p1.5.m4.1.1" xref="S3.SS1.p1.5.m4.1.1.cmml">0</mn><mo id="S3.SS1.p1.5.m4.2.3.3.3.2.2" xref="S3.SS1.p1.5.m4.2.3.3.3.1.cmml">,</mo><mi id="S3.SS1.p1.5.m4.2.2" xref="S3.SS1.p1.5.m4.2.2.cmml">𝐈</mi><mo id="S3.SS1.p1.5.m4.2.3.3.3.2.3" stretchy="false" xref="S3.SS1.p1.5.m4.2.3.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.m4.2b"><apply id="S3.SS1.p1.5.m4.2.3.cmml" xref="S3.SS1.p1.5.m4.2.3"><csymbol cd="latexml" id="S3.SS1.p1.5.m4.2.3.1.cmml" xref="S3.SS1.p1.5.m4.2.3.1">similar-to</csymbol><ci id="S3.SS1.p1.5.m4.2.3.2.cmml" xref="S3.SS1.p1.5.m4.2.3.2">italic-ϵ</ci><apply id="S3.SS1.p1.5.m4.2.3.3.cmml" xref="S3.SS1.p1.5.m4.2.3.3"><times id="S3.SS1.p1.5.m4.2.3.3.1.cmml" xref="S3.SS1.p1.5.m4.2.3.3.1"></times><ci id="S3.SS1.p1.5.m4.2.3.3.2.cmml" xref="S3.SS1.p1.5.m4.2.3.3.2">𝒩</ci><interval closure="open" id="S3.SS1.p1.5.m4.2.3.3.3.1.cmml" xref="S3.SS1.p1.5.m4.2.3.3.3.2"><cn id="S3.SS1.p1.5.m4.1.1.cmml" type="integer" xref="S3.SS1.p1.5.m4.1.1">0</cn><ci id="S3.SS1.p1.5.m4.2.2.cmml" xref="S3.SS1.p1.5.m4.2.2">𝐈</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.5.m4.2c">\epsilon\sim\mathcal{N}(0,\mathbf{I})</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.5.m4.2d">italic_ϵ ∼ caligraphic_N ( 0 , bold_I )</annotation></semantics></math>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS1.p2">
<p class="ltx_p" id="S3.SS1.p2.4">With a latent variable <math alttext="\mathbf{x}_{t}" class="ltx_Math" display="inline" id="S3.SS1.p2.1.m1.1"><semantics id="S3.SS1.p2.1.m1.1a"><msub id="S3.SS1.p2.1.m1.1.1" xref="S3.SS1.p2.1.m1.1.1.cmml"><mi id="S3.SS1.p2.1.m1.1.1.2" xref="S3.SS1.p2.1.m1.1.1.2.cmml">𝐱</mi><mi id="S3.SS1.p2.1.m1.1.1.3" xref="S3.SS1.p2.1.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.1b"><apply id="S3.SS1.p2.1.m1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.1.m1.1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1">subscript</csymbol><ci id="S3.SS1.p2.1.m1.1.1.2.cmml" xref="S3.SS1.p2.1.m1.1.1.2">𝐱</ci><ci id="S3.SS1.p2.1.m1.1.1.3.cmml" xref="S3.SS1.p2.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.1c">\mathbf{x}_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.1.m1.1d">bold_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> from the forward process, DDPM estimates the normalized additive noise by <math alttext="\epsilon_{\theta}(\mathbf{x}_{t})" class="ltx_Math" display="inline" id="S3.SS1.p2.2.m2.1"><semantics id="S3.SS1.p2.2.m2.1a"><mrow id="S3.SS1.p2.2.m2.1.1" xref="S3.SS1.p2.2.m2.1.1.cmml"><msub id="S3.SS1.p2.2.m2.1.1.3" xref="S3.SS1.p2.2.m2.1.1.3.cmml"><mi id="S3.SS1.p2.2.m2.1.1.3.2" xref="S3.SS1.p2.2.m2.1.1.3.2.cmml">ϵ</mi><mi id="S3.SS1.p2.2.m2.1.1.3.3" xref="S3.SS1.p2.2.m2.1.1.3.3.cmml">θ</mi></msub><mo id="S3.SS1.p2.2.m2.1.1.2" xref="S3.SS1.p2.2.m2.1.1.2.cmml">⁢</mo><mrow id="S3.SS1.p2.2.m2.1.1.1.1" xref="S3.SS1.p2.2.m2.1.1.1.1.1.cmml"><mo id="S3.SS1.p2.2.m2.1.1.1.1.2" stretchy="false" xref="S3.SS1.p2.2.m2.1.1.1.1.1.cmml">(</mo><msub id="S3.SS1.p2.2.m2.1.1.1.1.1" xref="S3.SS1.p2.2.m2.1.1.1.1.1.cmml"><mi id="S3.SS1.p2.2.m2.1.1.1.1.1.2" xref="S3.SS1.p2.2.m2.1.1.1.1.1.2.cmml">𝐱</mi><mi id="S3.SS1.p2.2.m2.1.1.1.1.1.3" xref="S3.SS1.p2.2.m2.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.SS1.p2.2.m2.1.1.1.1.3" stretchy="false" xref="S3.SS1.p2.2.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.2.m2.1b"><apply id="S3.SS1.p2.2.m2.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1"><times id="S3.SS1.p2.2.m2.1.1.2.cmml" xref="S3.SS1.p2.2.m2.1.1.2"></times><apply id="S3.SS1.p2.2.m2.1.1.3.cmml" xref="S3.SS1.p2.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p2.2.m2.1.1.3.1.cmml" xref="S3.SS1.p2.2.m2.1.1.3">subscript</csymbol><ci id="S3.SS1.p2.2.m2.1.1.3.2.cmml" xref="S3.SS1.p2.2.m2.1.1.3.2">italic-ϵ</ci><ci id="S3.SS1.p2.2.m2.1.1.3.3.cmml" xref="S3.SS1.p2.2.m2.1.1.3.3">𝜃</ci></apply><apply id="S3.SS1.p2.2.m2.1.1.1.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.2.m2.1.1.1.1.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p2.2.m2.1.1.1.1.1.2.cmml" xref="S3.SS1.p2.2.m2.1.1.1.1.1.2">𝐱</ci><ci id="S3.SS1.p2.2.m2.1.1.1.1.1.3.cmml" xref="S3.SS1.p2.2.m2.1.1.1.1.1.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.2.m2.1c">\epsilon_{\theta}(\mathbf{x}_{t})</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.2.m2.1d">italic_ϵ start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( bold_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math>, where <math alttext="\theta" class="ltx_Math" display="inline" id="S3.SS1.p2.3.m3.1"><semantics id="S3.SS1.p2.3.m3.1a"><mi id="S3.SS1.p2.3.m3.1.1" xref="S3.SS1.p2.3.m3.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.3.m3.1b"><ci id="S3.SS1.p2.3.m3.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.3.m3.1c">\theta</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.3.m3.1d">italic_θ</annotation></semantics></math> represents the parameters of the neural network. To <span class="ltx_text ltx_font_italic" id="S3.SS1.p2.4.1">maximize</span> the evidence lower bound (ELBO) <cite class="ltx_cite ltx_citemacro_citep">(Kingma &amp; Welling, <a class="ltx_ref" href="https://arxiv.org/html/2410.05255v1#bib.bib17" title="">2019</a>)</cite>, we usually <span class="ltx_text ltx_font_italic" id="S3.SS1.p2.4.2">minimize</span> the loss function w.r.t. <math alttext="\theta" class="ltx_Math" display="inline" id="S3.SS1.p2.4.m4.1"><semantics id="S3.SS1.p2.4.m4.1a"><mi id="S3.SS1.p2.4.m4.1.1" xref="S3.SS1.p2.4.m4.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.4.m4.1b"><ci id="S3.SS1.p2.4.m4.1.1.cmml" xref="S3.SS1.p2.4.m4.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.4.m4.1c">\theta</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.4.m4.1d">italic_θ</annotation></semantics></math>:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equationgroup ltx_eqn_table" id="S3.E2">
<tbody>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S3.E2X">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathcal{L}_{\rm DM}(\theta;\mathbf{x}_{0})~{}={}" class="ltx_Math" display="inline" id="S3.E2X.2.1.1.m1.2"><semantics id="S3.E2X.2.1.1.m1.2a"><mrow id="S3.E2X.2.1.1.m1.2.2" xref="S3.E2X.2.1.1.m1.2.2.cmml"><mrow id="S3.E2X.2.1.1.m1.2.2.1" xref="S3.E2X.2.1.1.m1.2.2.1.cmml"><msub id="S3.E2X.2.1.1.m1.2.2.1.3" xref="S3.E2X.2.1.1.m1.2.2.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E2X.2.1.1.m1.2.2.1.3.2" xref="S3.E2X.2.1.1.m1.2.2.1.3.2.cmml">ℒ</mi><mi id="S3.E2X.2.1.1.m1.2.2.1.3.3" xref="S3.E2X.2.1.1.m1.2.2.1.3.3.cmml">DM</mi></msub><mo id="S3.E2X.2.1.1.m1.2.2.1.2" xref="S3.E2X.2.1.1.m1.2.2.1.2.cmml">⁢</mo><mrow id="S3.E2X.2.1.1.m1.2.2.1.1.1" xref="S3.E2X.2.1.1.m1.2.2.1.1.2.cmml"><mo id="S3.E2X.2.1.1.m1.2.2.1.1.1.2" stretchy="false" xref="S3.E2X.2.1.1.m1.2.2.1.1.2.cmml">(</mo><mi id="S3.E2X.2.1.1.m1.1.1" xref="S3.E2X.2.1.1.m1.1.1.cmml">θ</mi><mo id="S3.E2X.2.1.1.m1.2.2.1.1.1.3" xref="S3.E2X.2.1.1.m1.2.2.1.1.2.cmml">;</mo><msub id="S3.E2X.2.1.1.m1.2.2.1.1.1.1" xref="S3.E2X.2.1.1.m1.2.2.1.1.1.1.cmml"><mi id="S3.E2X.2.1.1.m1.2.2.1.1.1.1.2" xref="S3.E2X.2.1.1.m1.2.2.1.1.1.1.2.cmml">𝐱</mi><mn id="S3.E2X.2.1.1.m1.2.2.1.1.1.1.3" xref="S3.E2X.2.1.1.m1.2.2.1.1.1.1.3.cmml">0</mn></msub><mo id="S3.E2X.2.1.1.m1.2.2.1.1.1.4" rspace="0.330em" stretchy="false" xref="S3.E2X.2.1.1.m1.2.2.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E2X.2.1.1.m1.2.2.2" xref="S3.E2X.2.1.1.m1.2.2.2.cmml">=</mo><mi id="S3.E2X.2.1.1.m1.2.2.3" xref="S3.E2X.2.1.1.m1.2.2.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="S3.E2X.2.1.1.m1.2b"><apply id="S3.E2X.2.1.1.m1.2.2.cmml" xref="S3.E2X.2.1.1.m1.2.2"><eq id="S3.E2X.2.1.1.m1.2.2.2.cmml" xref="S3.E2X.2.1.1.m1.2.2.2"></eq><apply id="S3.E2X.2.1.1.m1.2.2.1.cmml" xref="S3.E2X.2.1.1.m1.2.2.1"><times id="S3.E2X.2.1.1.m1.2.2.1.2.cmml" xref="S3.E2X.2.1.1.m1.2.2.1.2"></times><apply id="S3.E2X.2.1.1.m1.2.2.1.3.cmml" xref="S3.E2X.2.1.1.m1.2.2.1.3"><csymbol cd="ambiguous" id="S3.E2X.2.1.1.m1.2.2.1.3.1.cmml" xref="S3.E2X.2.1.1.m1.2.2.1.3">subscript</csymbol><ci id="S3.E2X.2.1.1.m1.2.2.1.3.2.cmml" xref="S3.E2X.2.1.1.m1.2.2.1.3.2">ℒ</ci><ci id="S3.E2X.2.1.1.m1.2.2.1.3.3.cmml" xref="S3.E2X.2.1.1.m1.2.2.1.3.3">DM</ci></apply><list id="S3.E2X.2.1.1.m1.2.2.1.1.2.cmml" xref="S3.E2X.2.1.1.m1.2.2.1.1.1"><ci id="S3.E2X.2.1.1.m1.1.1.cmml" xref="S3.E2X.2.1.1.m1.1.1">𝜃</ci><apply id="S3.E2X.2.1.1.m1.2.2.1.1.1.1.cmml" xref="S3.E2X.2.1.1.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2X.2.1.1.m1.2.2.1.1.1.1.1.cmml" xref="S3.E2X.2.1.1.m1.2.2.1.1.1.1">subscript</csymbol><ci id="S3.E2X.2.1.1.m1.2.2.1.1.1.1.2.cmml" xref="S3.E2X.2.1.1.m1.2.2.1.1.1.1.2">𝐱</ci><cn id="S3.E2X.2.1.1.m1.2.2.1.1.1.1.3.cmml" type="integer" xref="S3.E2X.2.1.1.m1.2.2.1.1.1.1.3">0</cn></apply></list></apply><csymbol cd="latexml" id="S3.E2X.2.1.1.m1.2.2.3.cmml" xref="S3.E2X.2.1.1.m1.2.2.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2X.2.1.1.m1.2c">\displaystyle\mathcal{L}_{\rm DM}(\theta;\mathbf{x}_{0})~{}={}</annotation><annotation encoding="application/x-llamapun" id="S3.E2X.2.1.1.m1.2d">caligraphic_L start_POSTSUBSCRIPT roman_DM end_POSTSUBSCRIPT ( italic_θ ; bold_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ) =</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\mathop{\mathbb{E}}_{\epsilon,t}\Big{[}w_{t}\|\epsilon_{\theta}(%
\mathbf{x}_{t})-\mathbf{\epsilon}\|^{2}\Big{]}," class="ltx_Math" display="inline" id="S3.E2X.3.2.2.m1.3"><semantics id="S3.E2X.3.2.2.m1.3a"><mrow id="S3.E2X.3.2.2.m1.3.3.1" xref="S3.E2X.3.2.2.m1.3.3.1.1.cmml"><mrow id="S3.E2X.3.2.2.m1.3.3.1.1" xref="S3.E2X.3.2.2.m1.3.3.1.1.cmml"><munder id="S3.E2X.3.2.2.m1.3.3.1.1.2" xref="S3.E2X.3.2.2.m1.3.3.1.1.2.cmml"><mo id="S3.E2X.3.2.2.m1.3.3.1.1.2.2" movablelimits="false" xref="S3.E2X.3.2.2.m1.3.3.1.1.2.2.cmml">𝔼</mo><mrow id="S3.E2X.3.2.2.m1.2.2.2.4" xref="S3.E2X.3.2.2.m1.2.2.2.3.cmml"><mi id="S3.E2X.3.2.2.m1.1.1.1.1" xref="S3.E2X.3.2.2.m1.1.1.1.1.cmml">ϵ</mi><mo id="S3.E2X.3.2.2.m1.2.2.2.4.1" xref="S3.E2X.3.2.2.m1.2.2.2.3.cmml">,</mo><mi id="S3.E2X.3.2.2.m1.2.2.2.2" xref="S3.E2X.3.2.2.m1.2.2.2.2.cmml">t</mi></mrow></munder><mrow id="S3.E2X.3.2.2.m1.3.3.1.1.1.1" xref="S3.E2X.3.2.2.m1.3.3.1.1.1.2.cmml"><mo id="S3.E2X.3.2.2.m1.3.3.1.1.1.1.2" lspace="0em" maxsize="160%" minsize="160%" xref="S3.E2X.3.2.2.m1.3.3.1.1.1.2.1.cmml">[</mo><mrow id="S3.E2X.3.2.2.m1.3.3.1.1.1.1.1" xref="S3.E2X.3.2.2.m1.3.3.1.1.1.1.1.cmml"><msub id="S3.E2X.3.2.2.m1.3.3.1.1.1.1.1.3" xref="S3.E2X.3.2.2.m1.3.3.1.1.1.1.1.3.cmml"><mi id="S3.E2X.3.2.2.m1.3.3.1.1.1.1.1.3.2" xref="S3.E2X.3.2.2.m1.3.3.1.1.1.1.1.3.2.cmml">w</mi><mi id="S3.E2X.3.2.2.m1.3.3.1.1.1.1.1.3.3" xref="S3.E2X.3.2.2.m1.3.3.1.1.1.1.1.3.3.cmml">t</mi></msub><mo id="S3.E2X.3.2.2.m1.3.3.1.1.1.1.1.2" xref="S3.E2X.3.2.2.m1.3.3.1.1.1.1.1.2.cmml">⁢</mo><msup id="S3.E2X.3.2.2.m1.3.3.1.1.1.1.1.1" xref="S3.E2X.3.2.2.m1.3.3.1.1.1.1.1.1.cmml"><mrow id="S3.E2X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1" xref="S3.E2X.3.2.2.m1.3.3.1.1.1.1.1.1.1.2.cmml"><mo id="S3.E2X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E2X.3.2.2.m1.3.3.1.1.1.1.1.1.1.2.1.cmml">‖</mo><mrow id="S3.E2X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1" xref="S3.E2X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.cmml"><mrow id="S3.E2X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1" xref="S3.E2X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E2X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E2X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E2X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E2X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.2.cmml">ϵ</mi><mi id="S3.E2X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E2X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.3.cmml">θ</mi></msub><mo id="S3.E2X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E2X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E2X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E2X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E2X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E2X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E2X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E2X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E2X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E2X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">𝐱</mi><mi id="S3.E2X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E2X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.E2X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E2X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E2X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.2" xref="S3.E2X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.2.cmml">−</mo><mi id="S3.E2X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.3" xref="S3.E2X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.3.cmml">ϵ</mi></mrow><mo id="S3.E2X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E2X.3.2.2.m1.3.3.1.1.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S3.E2X.3.2.2.m1.3.3.1.1.1.1.1.1.3" xref="S3.E2X.3.2.2.m1.3.3.1.1.1.1.1.1.3.cmml">2</mn></msup></mrow><mo id="S3.E2X.3.2.2.m1.3.3.1.1.1.1.3" maxsize="160%" minsize="160%" xref="S3.E2X.3.2.2.m1.3.3.1.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="S3.E2X.3.2.2.m1.3.3.1.2" xref="S3.E2X.3.2.2.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E2X.3.2.2.m1.3b"><apply id="S3.E2X.3.2.2.m1.3.3.1.1.cmml" xref="S3.E2X.3.2.2.m1.3.3.1"><apply id="S3.E2X.3.2.2.m1.3.3.1.1.2.cmml" xref="S3.E2X.3.2.2.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="S3.E2X.3.2.2.m1.3.3.1.1.2.1.cmml" xref="S3.E2X.3.2.2.m1.3.3.1.1.2">subscript</csymbol><ci id="S3.E2X.3.2.2.m1.3.3.1.1.2.2.cmml" xref="S3.E2X.3.2.2.m1.3.3.1.1.2.2">𝔼</ci><list id="S3.E2X.3.2.2.m1.2.2.2.3.cmml" xref="S3.E2X.3.2.2.m1.2.2.2.4"><ci id="S3.E2X.3.2.2.m1.1.1.1.1.cmml" xref="S3.E2X.3.2.2.m1.1.1.1.1">italic-ϵ</ci><ci id="S3.E2X.3.2.2.m1.2.2.2.2.cmml" xref="S3.E2X.3.2.2.m1.2.2.2.2">𝑡</ci></list></apply><apply id="S3.E2X.3.2.2.m1.3.3.1.1.1.2.cmml" xref="S3.E2X.3.2.2.m1.3.3.1.1.1.1"><csymbol cd="latexml" id="S3.E2X.3.2.2.m1.3.3.1.1.1.2.1.cmml" xref="S3.E2X.3.2.2.m1.3.3.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.E2X.3.2.2.m1.3.3.1.1.1.1.1.cmml" xref="S3.E2X.3.2.2.m1.3.3.1.1.1.1.1"><times id="S3.E2X.3.2.2.m1.3.3.1.1.1.1.1.2.cmml" xref="S3.E2X.3.2.2.m1.3.3.1.1.1.1.1.2"></times><apply id="S3.E2X.3.2.2.m1.3.3.1.1.1.1.1.3.cmml" xref="S3.E2X.3.2.2.m1.3.3.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E2X.3.2.2.m1.3.3.1.1.1.1.1.3.1.cmml" xref="S3.E2X.3.2.2.m1.3.3.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E2X.3.2.2.m1.3.3.1.1.1.1.1.3.2.cmml" xref="S3.E2X.3.2.2.m1.3.3.1.1.1.1.1.3.2">𝑤</ci><ci id="S3.E2X.3.2.2.m1.3.3.1.1.1.1.1.3.3.cmml" xref="S3.E2X.3.2.2.m1.3.3.1.1.1.1.1.3.3">𝑡</ci></apply><apply id="S3.E2X.3.2.2.m1.3.3.1.1.1.1.1.1.cmml" xref="S3.E2X.3.2.2.m1.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2X.3.2.2.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S3.E2X.3.2.2.m1.3.3.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E2X.3.2.2.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="S3.E2X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E2X.3.2.2.m1.3.3.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E2X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.2">norm</csymbol><apply id="S3.E2X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1"><minus id="S3.E2X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E2X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.2"></minus><apply id="S3.E2X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1"><times id="S3.E2X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E2X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.2"></times><apply id="S3.E2X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E2X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E2X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E2X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E2X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E2X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.2">italic-ϵ</ci><ci id="S3.E2X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E2X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.3">𝜃</ci></apply><apply id="S3.E2X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E2X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E2X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.2">𝐱</ci><ci id="S3.E2X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E2X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑡</ci></apply></apply><ci id="S3.E2X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E2X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.3">italic-ϵ</ci></apply></apply><cn id="S3.E2X.3.2.2.m1.3.3.1.1.1.1.1.1.3.cmml" type="integer" xref="S3.E2X.3.2.2.m1.3.3.1.1.1.1.1.1.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2X.3.2.2.m1.3c">\displaystyle\mathop{\mathbb{E}}_{\epsilon,t}\Big{[}w_{t}\|\epsilon_{\theta}(%
\mathbf{x}_{t})-\mathbf{\epsilon}\|^{2}\Big{]},</annotation><annotation encoding="application/x-llamapun" id="S3.E2X.3.2.2.m1.3d">blackboard_E start_POSTSUBSCRIPT italic_ϵ , italic_t end_POSTSUBSCRIPT [ italic_w start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∥ italic_ϵ start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( bold_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) - italic_ϵ ∥ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ] ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(2)</span></td>
</tr>
</tbody>
</table>
<p class="ltx_p" id="S3.SS1.p2.10">where <math alttext="t\sim\mathcal{U}(1,T)" class="ltx_Math" display="inline" id="S3.SS1.p2.5.m1.2"><semantics id="S3.SS1.p2.5.m1.2a"><mrow id="S3.SS1.p2.5.m1.2.3" xref="S3.SS1.p2.5.m1.2.3.cmml"><mi id="S3.SS1.p2.5.m1.2.3.2" xref="S3.SS1.p2.5.m1.2.3.2.cmml">t</mi><mo id="S3.SS1.p2.5.m1.2.3.1" xref="S3.SS1.p2.5.m1.2.3.1.cmml">∼</mo><mrow id="S3.SS1.p2.5.m1.2.3.3" xref="S3.SS1.p2.5.m1.2.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.5.m1.2.3.3.2" xref="S3.SS1.p2.5.m1.2.3.3.2.cmml">𝒰</mi><mo id="S3.SS1.p2.5.m1.2.3.3.1" xref="S3.SS1.p2.5.m1.2.3.3.1.cmml">⁢</mo><mrow id="S3.SS1.p2.5.m1.2.3.3.3.2" xref="S3.SS1.p2.5.m1.2.3.3.3.1.cmml"><mo id="S3.SS1.p2.5.m1.2.3.3.3.2.1" stretchy="false" xref="S3.SS1.p2.5.m1.2.3.3.3.1.cmml">(</mo><mn id="S3.SS1.p2.5.m1.1.1" xref="S3.SS1.p2.5.m1.1.1.cmml">1</mn><mo id="S3.SS1.p2.5.m1.2.3.3.3.2.2" xref="S3.SS1.p2.5.m1.2.3.3.3.1.cmml">,</mo><mi id="S3.SS1.p2.5.m1.2.2" xref="S3.SS1.p2.5.m1.2.2.cmml">T</mi><mo id="S3.SS1.p2.5.m1.2.3.3.3.2.3" stretchy="false" xref="S3.SS1.p2.5.m1.2.3.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.5.m1.2b"><apply id="S3.SS1.p2.5.m1.2.3.cmml" xref="S3.SS1.p2.5.m1.2.3"><csymbol cd="latexml" id="S3.SS1.p2.5.m1.2.3.1.cmml" xref="S3.SS1.p2.5.m1.2.3.1">similar-to</csymbol><ci id="S3.SS1.p2.5.m1.2.3.2.cmml" xref="S3.SS1.p2.5.m1.2.3.2">𝑡</ci><apply id="S3.SS1.p2.5.m1.2.3.3.cmml" xref="S3.SS1.p2.5.m1.2.3.3"><times id="S3.SS1.p2.5.m1.2.3.3.1.cmml" xref="S3.SS1.p2.5.m1.2.3.3.1"></times><ci id="S3.SS1.p2.5.m1.2.3.3.2.cmml" xref="S3.SS1.p2.5.m1.2.3.3.2">𝒰</ci><interval closure="open" id="S3.SS1.p2.5.m1.2.3.3.3.1.cmml" xref="S3.SS1.p2.5.m1.2.3.3.3.2"><cn id="S3.SS1.p2.5.m1.1.1.cmml" type="integer" xref="S3.SS1.p2.5.m1.1.1">1</cn><ci id="S3.SS1.p2.5.m1.2.2.cmml" xref="S3.SS1.p2.5.m1.2.2">𝑇</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.5.m1.2c">t\sim\mathcal{U}(1,T)</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.5.m1.2d">italic_t ∼ caligraphic_U ( 1 , italic_T )</annotation></semantics></math> is uniformly distributed on the integer interval <math alttext="[1,T]" class="ltx_Math" display="inline" id="S3.SS1.p2.6.m2.2"><semantics id="S3.SS1.p2.6.m2.2a"><mrow id="S3.SS1.p2.6.m2.2.3.2" xref="S3.SS1.p2.6.m2.2.3.1.cmml"><mo id="S3.SS1.p2.6.m2.2.3.2.1" stretchy="false" xref="S3.SS1.p2.6.m2.2.3.1.cmml">[</mo><mn id="S3.SS1.p2.6.m2.1.1" xref="S3.SS1.p2.6.m2.1.1.cmml">1</mn><mo id="S3.SS1.p2.6.m2.2.3.2.2" xref="S3.SS1.p2.6.m2.2.3.1.cmml">,</mo><mi id="S3.SS1.p2.6.m2.2.2" xref="S3.SS1.p2.6.m2.2.2.cmml">T</mi><mo id="S3.SS1.p2.6.m2.2.3.2.3" stretchy="false" xref="S3.SS1.p2.6.m2.2.3.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.6.m2.2b"><interval closure="closed" id="S3.SS1.p2.6.m2.2.3.1.cmml" xref="S3.SS1.p2.6.m2.2.3.2"><cn id="S3.SS1.p2.6.m2.1.1.cmml" type="integer" xref="S3.SS1.p2.6.m2.1.1">1</cn><ci id="S3.SS1.p2.6.m2.2.2.cmml" xref="S3.SS1.p2.6.m2.2.2">𝑇</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.6.m2.2c">[1,T]</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.6.m2.2d">[ 1 , italic_T ]</annotation></semantics></math>, <math alttext="w_{t}=\frac{(1-\alpha)^{2}\alpha^{t-1}}{2\sigma_{t}^{2}(1-\alpha^{t})^{2}}" class="ltx_Math" display="inline" id="S3.SS1.p2.7.m3.2"><semantics id="S3.SS1.p2.7.m3.2a"><mrow id="S3.SS1.p2.7.m3.2.3" xref="S3.SS1.p2.7.m3.2.3.cmml"><msub id="S3.SS1.p2.7.m3.2.3.2" xref="S3.SS1.p2.7.m3.2.3.2.cmml"><mi id="S3.SS1.p2.7.m3.2.3.2.2" xref="S3.SS1.p2.7.m3.2.3.2.2.cmml">w</mi><mi id="S3.SS1.p2.7.m3.2.3.2.3" xref="S3.SS1.p2.7.m3.2.3.2.3.cmml">t</mi></msub><mo id="S3.SS1.p2.7.m3.2.3.1" xref="S3.SS1.p2.7.m3.2.3.1.cmml">=</mo><mfrac id="S3.SS1.p2.7.m3.2.2" xref="S3.SS1.p2.7.m3.2.2.cmml"><mrow id="S3.SS1.p2.7.m3.1.1.1" xref="S3.SS1.p2.7.m3.1.1.1.cmml"><msup id="S3.SS1.p2.7.m3.1.1.1.1" xref="S3.SS1.p2.7.m3.1.1.1.1.cmml"><mrow id="S3.SS1.p2.7.m3.1.1.1.1.1.1" xref="S3.SS1.p2.7.m3.1.1.1.1.1.1.1.cmml"><mo id="S3.SS1.p2.7.m3.1.1.1.1.1.1.2" stretchy="false" xref="S3.SS1.p2.7.m3.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS1.p2.7.m3.1.1.1.1.1.1.1" xref="S3.SS1.p2.7.m3.1.1.1.1.1.1.1.cmml"><mn id="S3.SS1.p2.7.m3.1.1.1.1.1.1.1.2" xref="S3.SS1.p2.7.m3.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="S3.SS1.p2.7.m3.1.1.1.1.1.1.1.1" xref="S3.SS1.p2.7.m3.1.1.1.1.1.1.1.1.cmml">−</mo><mi id="S3.SS1.p2.7.m3.1.1.1.1.1.1.1.3" xref="S3.SS1.p2.7.m3.1.1.1.1.1.1.1.3.cmml">α</mi></mrow><mo id="S3.SS1.p2.7.m3.1.1.1.1.1.1.3" stretchy="false" xref="S3.SS1.p2.7.m3.1.1.1.1.1.1.1.cmml">)</mo></mrow><mn id="S3.SS1.p2.7.m3.1.1.1.1.3" xref="S3.SS1.p2.7.m3.1.1.1.1.3.cmml">2</mn></msup><mo id="S3.SS1.p2.7.m3.1.1.1.2" xref="S3.SS1.p2.7.m3.1.1.1.2.cmml">⁢</mo><msup id="S3.SS1.p2.7.m3.1.1.1.3" xref="S3.SS1.p2.7.m3.1.1.1.3.cmml"><mi id="S3.SS1.p2.7.m3.1.1.1.3.2" xref="S3.SS1.p2.7.m3.1.1.1.3.2.cmml">α</mi><mrow id="S3.SS1.p2.7.m3.1.1.1.3.3" xref="S3.SS1.p2.7.m3.1.1.1.3.3.cmml"><mi id="S3.SS1.p2.7.m3.1.1.1.3.3.2" xref="S3.SS1.p2.7.m3.1.1.1.3.3.2.cmml">t</mi><mo id="S3.SS1.p2.7.m3.1.1.1.3.3.1" xref="S3.SS1.p2.7.m3.1.1.1.3.3.1.cmml">−</mo><mn id="S3.SS1.p2.7.m3.1.1.1.3.3.3" xref="S3.SS1.p2.7.m3.1.1.1.3.3.3.cmml">1</mn></mrow></msup></mrow><mrow id="S3.SS1.p2.7.m3.2.2.2" xref="S3.SS1.p2.7.m3.2.2.2.cmml"><mn id="S3.SS1.p2.7.m3.2.2.2.3" xref="S3.SS1.p2.7.m3.2.2.2.3.cmml">2</mn><mo id="S3.SS1.p2.7.m3.2.2.2.2" xref="S3.SS1.p2.7.m3.2.2.2.2.cmml">⁢</mo><msubsup id="S3.SS1.p2.7.m3.2.2.2.4" xref="S3.SS1.p2.7.m3.2.2.2.4.cmml"><mi id="S3.SS1.p2.7.m3.2.2.2.4.2.2" xref="S3.SS1.p2.7.m3.2.2.2.4.2.2.cmml">σ</mi><mi id="S3.SS1.p2.7.m3.2.2.2.4.2.3" xref="S3.SS1.p2.7.m3.2.2.2.4.2.3.cmml">t</mi><mn id="S3.SS1.p2.7.m3.2.2.2.4.3" xref="S3.SS1.p2.7.m3.2.2.2.4.3.cmml">2</mn></msubsup><mo id="S3.SS1.p2.7.m3.2.2.2.2a" xref="S3.SS1.p2.7.m3.2.2.2.2.cmml">⁢</mo><msup id="S3.SS1.p2.7.m3.2.2.2.1" xref="S3.SS1.p2.7.m3.2.2.2.1.cmml"><mrow id="S3.SS1.p2.7.m3.2.2.2.1.1.1" xref="S3.SS1.p2.7.m3.2.2.2.1.1.1.1.cmml"><mo id="S3.SS1.p2.7.m3.2.2.2.1.1.1.2" stretchy="false" xref="S3.SS1.p2.7.m3.2.2.2.1.1.1.1.cmml">(</mo><mrow id="S3.SS1.p2.7.m3.2.2.2.1.1.1.1" xref="S3.SS1.p2.7.m3.2.2.2.1.1.1.1.cmml"><mn id="S3.SS1.p2.7.m3.2.2.2.1.1.1.1.2" xref="S3.SS1.p2.7.m3.2.2.2.1.1.1.1.2.cmml">1</mn><mo id="S3.SS1.p2.7.m3.2.2.2.1.1.1.1.1" xref="S3.SS1.p2.7.m3.2.2.2.1.1.1.1.1.cmml">−</mo><msup id="S3.SS1.p2.7.m3.2.2.2.1.1.1.1.3" xref="S3.SS1.p2.7.m3.2.2.2.1.1.1.1.3.cmml"><mi id="S3.SS1.p2.7.m3.2.2.2.1.1.1.1.3.2" xref="S3.SS1.p2.7.m3.2.2.2.1.1.1.1.3.2.cmml">α</mi><mi id="S3.SS1.p2.7.m3.2.2.2.1.1.1.1.3.3" xref="S3.SS1.p2.7.m3.2.2.2.1.1.1.1.3.3.cmml">t</mi></msup></mrow><mo id="S3.SS1.p2.7.m3.2.2.2.1.1.1.3" stretchy="false" xref="S3.SS1.p2.7.m3.2.2.2.1.1.1.1.cmml">)</mo></mrow><mn id="S3.SS1.p2.7.m3.2.2.2.1.3" xref="S3.SS1.p2.7.m3.2.2.2.1.3.cmml">2</mn></msup></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.7.m3.2b"><apply id="S3.SS1.p2.7.m3.2.3.cmml" xref="S3.SS1.p2.7.m3.2.3"><eq id="S3.SS1.p2.7.m3.2.3.1.cmml" xref="S3.SS1.p2.7.m3.2.3.1"></eq><apply id="S3.SS1.p2.7.m3.2.3.2.cmml" xref="S3.SS1.p2.7.m3.2.3.2"><csymbol cd="ambiguous" id="S3.SS1.p2.7.m3.2.3.2.1.cmml" xref="S3.SS1.p2.7.m3.2.3.2">subscript</csymbol><ci id="S3.SS1.p2.7.m3.2.3.2.2.cmml" xref="S3.SS1.p2.7.m3.2.3.2.2">𝑤</ci><ci id="S3.SS1.p2.7.m3.2.3.2.3.cmml" xref="S3.SS1.p2.7.m3.2.3.2.3">𝑡</ci></apply><apply id="S3.SS1.p2.7.m3.2.2.cmml" xref="S3.SS1.p2.7.m3.2.2"><divide id="S3.SS1.p2.7.m3.2.2.3.cmml" xref="S3.SS1.p2.7.m3.2.2"></divide><apply id="S3.SS1.p2.7.m3.1.1.1.cmml" xref="S3.SS1.p2.7.m3.1.1.1"><times id="S3.SS1.p2.7.m3.1.1.1.2.cmml" xref="S3.SS1.p2.7.m3.1.1.1.2"></times><apply id="S3.SS1.p2.7.m3.1.1.1.1.cmml" xref="S3.SS1.p2.7.m3.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.7.m3.1.1.1.1.2.cmml" xref="S3.SS1.p2.7.m3.1.1.1.1">superscript</csymbol><apply id="S3.SS1.p2.7.m3.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p2.7.m3.1.1.1.1.1.1"><minus id="S3.SS1.p2.7.m3.1.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p2.7.m3.1.1.1.1.1.1.1.1"></minus><cn id="S3.SS1.p2.7.m3.1.1.1.1.1.1.1.2.cmml" type="integer" xref="S3.SS1.p2.7.m3.1.1.1.1.1.1.1.2">1</cn><ci id="S3.SS1.p2.7.m3.1.1.1.1.1.1.1.3.cmml" xref="S3.SS1.p2.7.m3.1.1.1.1.1.1.1.3">𝛼</ci></apply><cn id="S3.SS1.p2.7.m3.1.1.1.1.3.cmml" type="integer" xref="S3.SS1.p2.7.m3.1.1.1.1.3">2</cn></apply><apply id="S3.SS1.p2.7.m3.1.1.1.3.cmml" xref="S3.SS1.p2.7.m3.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p2.7.m3.1.1.1.3.1.cmml" xref="S3.SS1.p2.7.m3.1.1.1.3">superscript</csymbol><ci id="S3.SS1.p2.7.m3.1.1.1.3.2.cmml" xref="S3.SS1.p2.7.m3.1.1.1.3.2">𝛼</ci><apply id="S3.SS1.p2.7.m3.1.1.1.3.3.cmml" xref="S3.SS1.p2.7.m3.1.1.1.3.3"><minus id="S3.SS1.p2.7.m3.1.1.1.3.3.1.cmml" xref="S3.SS1.p2.7.m3.1.1.1.3.3.1"></minus><ci id="S3.SS1.p2.7.m3.1.1.1.3.3.2.cmml" xref="S3.SS1.p2.7.m3.1.1.1.3.3.2">𝑡</ci><cn id="S3.SS1.p2.7.m3.1.1.1.3.3.3.cmml" type="integer" xref="S3.SS1.p2.7.m3.1.1.1.3.3.3">1</cn></apply></apply></apply><apply id="S3.SS1.p2.7.m3.2.2.2.cmml" xref="S3.SS1.p2.7.m3.2.2.2"><times id="S3.SS1.p2.7.m3.2.2.2.2.cmml" xref="S3.SS1.p2.7.m3.2.2.2.2"></times><cn id="S3.SS1.p2.7.m3.2.2.2.3.cmml" type="integer" xref="S3.SS1.p2.7.m3.2.2.2.3">2</cn><apply id="S3.SS1.p2.7.m3.2.2.2.4.cmml" xref="S3.SS1.p2.7.m3.2.2.2.4"><csymbol cd="ambiguous" id="S3.SS1.p2.7.m3.2.2.2.4.1.cmml" xref="S3.SS1.p2.7.m3.2.2.2.4">superscript</csymbol><apply id="S3.SS1.p2.7.m3.2.2.2.4.2.cmml" xref="S3.SS1.p2.7.m3.2.2.2.4"><csymbol cd="ambiguous" id="S3.SS1.p2.7.m3.2.2.2.4.2.1.cmml" xref="S3.SS1.p2.7.m3.2.2.2.4">subscript</csymbol><ci id="S3.SS1.p2.7.m3.2.2.2.4.2.2.cmml" xref="S3.SS1.p2.7.m3.2.2.2.4.2.2">𝜎</ci><ci id="S3.SS1.p2.7.m3.2.2.2.4.2.3.cmml" xref="S3.SS1.p2.7.m3.2.2.2.4.2.3">𝑡</ci></apply><cn id="S3.SS1.p2.7.m3.2.2.2.4.3.cmml" type="integer" xref="S3.SS1.p2.7.m3.2.2.2.4.3">2</cn></apply><apply id="S3.SS1.p2.7.m3.2.2.2.1.cmml" xref="S3.SS1.p2.7.m3.2.2.2.1"><csymbol cd="ambiguous" id="S3.SS1.p2.7.m3.2.2.2.1.2.cmml" xref="S3.SS1.p2.7.m3.2.2.2.1">superscript</csymbol><apply id="S3.SS1.p2.7.m3.2.2.2.1.1.1.1.cmml" xref="S3.SS1.p2.7.m3.2.2.2.1.1.1"><minus id="S3.SS1.p2.7.m3.2.2.2.1.1.1.1.1.cmml" xref="S3.SS1.p2.7.m3.2.2.2.1.1.1.1.1"></minus><cn id="S3.SS1.p2.7.m3.2.2.2.1.1.1.1.2.cmml" type="integer" xref="S3.SS1.p2.7.m3.2.2.2.1.1.1.1.2">1</cn><apply id="S3.SS1.p2.7.m3.2.2.2.1.1.1.1.3.cmml" xref="S3.SS1.p2.7.m3.2.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p2.7.m3.2.2.2.1.1.1.1.3.1.cmml" xref="S3.SS1.p2.7.m3.2.2.2.1.1.1.1.3">superscript</csymbol><ci id="S3.SS1.p2.7.m3.2.2.2.1.1.1.1.3.2.cmml" xref="S3.SS1.p2.7.m3.2.2.2.1.1.1.1.3.2">𝛼</ci><ci id="S3.SS1.p2.7.m3.2.2.2.1.1.1.1.3.3.cmml" xref="S3.SS1.p2.7.m3.2.2.2.1.1.1.1.3.3">𝑡</ci></apply></apply><cn id="S3.SS1.p2.7.m3.2.2.2.1.3.cmml" type="integer" xref="S3.SS1.p2.7.m3.2.2.2.1.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.7.m3.2c">w_{t}=\frac{(1-\alpha)^{2}\alpha^{t-1}}{2\sigma_{t}^{2}(1-\alpha^{t})^{2}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.7.m3.2d">italic_w start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = divide start_ARG ( 1 - italic_α ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT italic_α start_POSTSUPERSCRIPT italic_t - 1 end_POSTSUPERSCRIPT end_ARG start_ARG 2 italic_σ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ( 1 - italic_α start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG</annotation></semantics></math> is a weighting scalar, and <math alttext="\sigma_{t}^{2}=\frac{(1-\alpha)(1-\alpha^{\frac{t-1}{2}})}{1-\alpha^{t}}" class="ltx_Math" display="inline" id="S3.SS1.p2.8.m4.2"><semantics id="S3.SS1.p2.8.m4.2a"><mrow id="S3.SS1.p2.8.m4.2.3" xref="S3.SS1.p2.8.m4.2.3.cmml"><msubsup id="S3.SS1.p2.8.m4.2.3.2" xref="S3.SS1.p2.8.m4.2.3.2.cmml"><mi id="S3.SS1.p2.8.m4.2.3.2.2.2" xref="S3.SS1.p2.8.m4.2.3.2.2.2.cmml">σ</mi><mi id="S3.SS1.p2.8.m4.2.3.2.2.3" xref="S3.SS1.p2.8.m4.2.3.2.2.3.cmml">t</mi><mn id="S3.SS1.p2.8.m4.2.3.2.3" xref="S3.SS1.p2.8.m4.2.3.2.3.cmml">2</mn></msubsup><mo id="S3.SS1.p2.8.m4.2.3.1" xref="S3.SS1.p2.8.m4.2.3.1.cmml">=</mo><mfrac id="S3.SS1.p2.8.m4.2.2" xref="S3.SS1.p2.8.m4.2.2.cmml"><mrow id="S3.SS1.p2.8.m4.2.2.2" xref="S3.SS1.p2.8.m4.2.2.2.cmml"><mrow id="S3.SS1.p2.8.m4.1.1.1.1.1" xref="S3.SS1.p2.8.m4.1.1.1.1.1.1.cmml"><mo id="S3.SS1.p2.8.m4.1.1.1.1.1.2" stretchy="false" xref="S3.SS1.p2.8.m4.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS1.p2.8.m4.1.1.1.1.1.1" xref="S3.SS1.p2.8.m4.1.1.1.1.1.1.cmml"><mn id="S3.SS1.p2.8.m4.1.1.1.1.1.1.2" xref="S3.SS1.p2.8.m4.1.1.1.1.1.1.2.cmml">1</mn><mo id="S3.SS1.p2.8.m4.1.1.1.1.1.1.1" xref="S3.SS1.p2.8.m4.1.1.1.1.1.1.1.cmml">−</mo><mi id="S3.SS1.p2.8.m4.1.1.1.1.1.1.3" xref="S3.SS1.p2.8.m4.1.1.1.1.1.1.3.cmml">α</mi></mrow><mo id="S3.SS1.p2.8.m4.1.1.1.1.1.3" stretchy="false" xref="S3.SS1.p2.8.m4.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.SS1.p2.8.m4.2.2.2.3" xref="S3.SS1.p2.8.m4.2.2.2.3.cmml">⁢</mo><mrow id="S3.SS1.p2.8.m4.2.2.2.2.1" xref="S3.SS1.p2.8.m4.2.2.2.2.1.1.cmml"><mo id="S3.SS1.p2.8.m4.2.2.2.2.1.2" stretchy="false" xref="S3.SS1.p2.8.m4.2.2.2.2.1.1.cmml">(</mo><mrow id="S3.SS1.p2.8.m4.2.2.2.2.1.1" xref="S3.SS1.p2.8.m4.2.2.2.2.1.1.cmml"><mn id="S3.SS1.p2.8.m4.2.2.2.2.1.1.2" xref="S3.SS1.p2.8.m4.2.2.2.2.1.1.2.cmml">1</mn><mo id="S3.SS1.p2.8.m4.2.2.2.2.1.1.1" xref="S3.SS1.p2.8.m4.2.2.2.2.1.1.1.cmml">−</mo><msup id="S3.SS1.p2.8.m4.2.2.2.2.1.1.3" xref="S3.SS1.p2.8.m4.2.2.2.2.1.1.3.cmml"><mi id="S3.SS1.p2.8.m4.2.2.2.2.1.1.3.2" xref="S3.SS1.p2.8.m4.2.2.2.2.1.1.3.2.cmml">α</mi><mfrac id="S3.SS1.p2.8.m4.2.2.2.2.1.1.3.3" xref="S3.SS1.p2.8.m4.2.2.2.2.1.1.3.3.cmml"><mrow id="S3.SS1.p2.8.m4.2.2.2.2.1.1.3.3.2" xref="S3.SS1.p2.8.m4.2.2.2.2.1.1.3.3.2.cmml"><mi id="S3.SS1.p2.8.m4.2.2.2.2.1.1.3.3.2.2" xref="S3.SS1.p2.8.m4.2.2.2.2.1.1.3.3.2.2.cmml">t</mi><mo id="S3.SS1.p2.8.m4.2.2.2.2.1.1.3.3.2.1" xref="S3.SS1.p2.8.m4.2.2.2.2.1.1.3.3.2.1.cmml">−</mo><mn id="S3.SS1.p2.8.m4.2.2.2.2.1.1.3.3.2.3" xref="S3.SS1.p2.8.m4.2.2.2.2.1.1.3.3.2.3.cmml">1</mn></mrow><mn id="S3.SS1.p2.8.m4.2.2.2.2.1.1.3.3.3" xref="S3.SS1.p2.8.m4.2.2.2.2.1.1.3.3.3.cmml">2</mn></mfrac></msup></mrow><mo id="S3.SS1.p2.8.m4.2.2.2.2.1.3" stretchy="false" xref="S3.SS1.p2.8.m4.2.2.2.2.1.1.cmml">)</mo></mrow></mrow><mrow id="S3.SS1.p2.8.m4.2.2.4" xref="S3.SS1.p2.8.m4.2.2.4.cmml"><mn id="S3.SS1.p2.8.m4.2.2.4.2" xref="S3.SS1.p2.8.m4.2.2.4.2.cmml">1</mn><mo id="S3.SS1.p2.8.m4.2.2.4.1" xref="S3.SS1.p2.8.m4.2.2.4.1.cmml">−</mo><msup id="S3.SS1.p2.8.m4.2.2.4.3" xref="S3.SS1.p2.8.m4.2.2.4.3.cmml"><mi id="S3.SS1.p2.8.m4.2.2.4.3.2" xref="S3.SS1.p2.8.m4.2.2.4.3.2.cmml">α</mi><mi id="S3.SS1.p2.8.m4.2.2.4.3.3" xref="S3.SS1.p2.8.m4.2.2.4.3.3.cmml">t</mi></msup></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.8.m4.2b"><apply id="S3.SS1.p2.8.m4.2.3.cmml" xref="S3.SS1.p2.8.m4.2.3"><eq id="S3.SS1.p2.8.m4.2.3.1.cmml" xref="S3.SS1.p2.8.m4.2.3.1"></eq><apply id="S3.SS1.p2.8.m4.2.3.2.cmml" xref="S3.SS1.p2.8.m4.2.3.2"><csymbol cd="ambiguous" id="S3.SS1.p2.8.m4.2.3.2.1.cmml" xref="S3.SS1.p2.8.m4.2.3.2">superscript</csymbol><apply id="S3.SS1.p2.8.m4.2.3.2.2.cmml" xref="S3.SS1.p2.8.m4.2.3.2"><csymbol cd="ambiguous" id="S3.SS1.p2.8.m4.2.3.2.2.1.cmml" xref="S3.SS1.p2.8.m4.2.3.2">subscript</csymbol><ci id="S3.SS1.p2.8.m4.2.3.2.2.2.cmml" xref="S3.SS1.p2.8.m4.2.3.2.2.2">𝜎</ci><ci id="S3.SS1.p2.8.m4.2.3.2.2.3.cmml" xref="S3.SS1.p2.8.m4.2.3.2.2.3">𝑡</ci></apply><cn id="S3.SS1.p2.8.m4.2.3.2.3.cmml" type="integer" xref="S3.SS1.p2.8.m4.2.3.2.3">2</cn></apply><apply id="S3.SS1.p2.8.m4.2.2.cmml" xref="S3.SS1.p2.8.m4.2.2"><divide id="S3.SS1.p2.8.m4.2.2.3.cmml" xref="S3.SS1.p2.8.m4.2.2"></divide><apply id="S3.SS1.p2.8.m4.2.2.2.cmml" xref="S3.SS1.p2.8.m4.2.2.2"><times id="S3.SS1.p2.8.m4.2.2.2.3.cmml" xref="S3.SS1.p2.8.m4.2.2.2.3"></times><apply id="S3.SS1.p2.8.m4.1.1.1.1.1.1.cmml" xref="S3.SS1.p2.8.m4.1.1.1.1.1"><minus id="S3.SS1.p2.8.m4.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p2.8.m4.1.1.1.1.1.1.1"></minus><cn id="S3.SS1.p2.8.m4.1.1.1.1.1.1.2.cmml" type="integer" xref="S3.SS1.p2.8.m4.1.1.1.1.1.1.2">1</cn><ci id="S3.SS1.p2.8.m4.1.1.1.1.1.1.3.cmml" xref="S3.SS1.p2.8.m4.1.1.1.1.1.1.3">𝛼</ci></apply><apply id="S3.SS1.p2.8.m4.2.2.2.2.1.1.cmml" xref="S3.SS1.p2.8.m4.2.2.2.2.1"><minus id="S3.SS1.p2.8.m4.2.2.2.2.1.1.1.cmml" xref="S3.SS1.p2.8.m4.2.2.2.2.1.1.1"></minus><cn id="S3.SS1.p2.8.m4.2.2.2.2.1.1.2.cmml" type="integer" xref="S3.SS1.p2.8.m4.2.2.2.2.1.1.2">1</cn><apply id="S3.SS1.p2.8.m4.2.2.2.2.1.1.3.cmml" xref="S3.SS1.p2.8.m4.2.2.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p2.8.m4.2.2.2.2.1.1.3.1.cmml" xref="S3.SS1.p2.8.m4.2.2.2.2.1.1.3">superscript</csymbol><ci id="S3.SS1.p2.8.m4.2.2.2.2.1.1.3.2.cmml" xref="S3.SS1.p2.8.m4.2.2.2.2.1.1.3.2">𝛼</ci><apply id="S3.SS1.p2.8.m4.2.2.2.2.1.1.3.3.cmml" xref="S3.SS1.p2.8.m4.2.2.2.2.1.1.3.3"><divide id="S3.SS1.p2.8.m4.2.2.2.2.1.1.3.3.1.cmml" xref="S3.SS1.p2.8.m4.2.2.2.2.1.1.3.3"></divide><apply id="S3.SS1.p2.8.m4.2.2.2.2.1.1.3.3.2.cmml" xref="S3.SS1.p2.8.m4.2.2.2.2.1.1.3.3.2"><minus id="S3.SS1.p2.8.m4.2.2.2.2.1.1.3.3.2.1.cmml" xref="S3.SS1.p2.8.m4.2.2.2.2.1.1.3.3.2.1"></minus><ci id="S3.SS1.p2.8.m4.2.2.2.2.1.1.3.3.2.2.cmml" xref="S3.SS1.p2.8.m4.2.2.2.2.1.1.3.3.2.2">𝑡</ci><cn id="S3.SS1.p2.8.m4.2.2.2.2.1.1.3.3.2.3.cmml" type="integer" xref="S3.SS1.p2.8.m4.2.2.2.2.1.1.3.3.2.3">1</cn></apply><cn id="S3.SS1.p2.8.m4.2.2.2.2.1.1.3.3.3.cmml" type="integer" xref="S3.SS1.p2.8.m4.2.2.2.2.1.1.3.3.3">2</cn></apply></apply></apply></apply><apply id="S3.SS1.p2.8.m4.2.2.4.cmml" xref="S3.SS1.p2.8.m4.2.2.4"><minus id="S3.SS1.p2.8.m4.2.2.4.1.cmml" xref="S3.SS1.p2.8.m4.2.2.4.1"></minus><cn id="S3.SS1.p2.8.m4.2.2.4.2.cmml" type="integer" xref="S3.SS1.p2.8.m4.2.2.4.2">1</cn><apply id="S3.SS1.p2.8.m4.2.2.4.3.cmml" xref="S3.SS1.p2.8.m4.2.2.4.3"><csymbol cd="ambiguous" id="S3.SS1.p2.8.m4.2.2.4.3.1.cmml" xref="S3.SS1.p2.8.m4.2.2.4.3">superscript</csymbol><ci id="S3.SS1.p2.8.m4.2.2.4.3.2.cmml" xref="S3.SS1.p2.8.m4.2.2.4.3.2">𝛼</ci><ci id="S3.SS1.p2.8.m4.2.2.4.3.3.cmml" xref="S3.SS1.p2.8.m4.2.2.4.3.3">𝑡</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.8.m4.2c">\sigma_{t}^{2}=\frac{(1-\alpha)(1-\alpha^{\frac{t-1}{2}})}{1-\alpha^{t}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.8.m4.2d">italic_σ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT = divide start_ARG ( 1 - italic_α ) ( 1 - italic_α start_POSTSUPERSCRIPT divide start_ARG italic_t - 1 end_ARG start_ARG 2 end_ARG end_POSTSUPERSCRIPT ) end_ARG start_ARG 1 - italic_α start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT end_ARG</annotation></semantics></math> is the variance of the additive noise. <math alttext="T" class="ltx_Math" display="inline" id="S3.SS1.p2.9.m5.1"><semantics id="S3.SS1.p2.9.m5.1a"><mi id="S3.SS1.p2.9.m5.1.1" xref="S3.SS1.p2.9.m5.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.9.m5.1b"><ci id="S3.SS1.p2.9.m5.1.1.cmml" xref="S3.SS1.p2.9.m5.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.9.m5.1c">T</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.9.m5.1d">italic_T</annotation></semantics></math> as a prespecified constant in <cite class="ltx_cite ltx_citemacro_citet">Kingma et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.05255v1#bib.bib16" title="">2021</a>)</cite> is ignored in the loss function, because it has no contribution to training. In practice, <math alttext="w_{t}" class="ltx_Math" display="inline" id="S3.SS1.p2.10.m6.1"><semantics id="S3.SS1.p2.10.m6.1a"><msub id="S3.SS1.p2.10.m6.1.1" xref="S3.SS1.p2.10.m6.1.1.cmml"><mi id="S3.SS1.p2.10.m6.1.1.2" xref="S3.SS1.p2.10.m6.1.1.2.cmml">w</mi><mi id="S3.SS1.p2.10.m6.1.1.3" xref="S3.SS1.p2.10.m6.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.10.m6.1b"><apply id="S3.SS1.p2.10.m6.1.1.cmml" xref="S3.SS1.p2.10.m6.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.10.m6.1.1.1.cmml" xref="S3.SS1.p2.10.m6.1.1">subscript</csymbol><ci id="S3.SS1.p2.10.m6.1.1.2.cmml" xref="S3.SS1.p2.10.m6.1.1.2">𝑤</ci><ci id="S3.SS1.p2.10.m6.1.1.3.cmml" xref="S3.SS1.p2.10.m6.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.10.m6.1c">w_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.10.m6.1d">italic_w start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> is usually set to a constant <cite class="ltx_cite ltx_citemacro_citep">(Song &amp; Ermon, <a class="ltx_ref" href="https://arxiv.org/html/2410.05255v1#bib.bib25" title="">2019</a>)</cite>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Direct Preference Optimization</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.4">Given a prompt or condition <math alttext="\mathbf{c}" class="ltx_Math" display="inline" id="S3.SS2.p1.1.m1.1"><semantics id="S3.SS2.p1.1.m1.1a"><mi id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml">𝐜</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><ci id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1">𝐜</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">\mathbf{c}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.1.m1.1d">bold_c</annotation></semantics></math>, the human annotates the preference between two results as <math alttext="\mathbf{x}^{w}\succ\mathbf{x}^{l}" class="ltx_Math" display="inline" id="S3.SS2.p1.2.m2.1"><semantics id="S3.SS2.p1.2.m2.1a"><mrow id="S3.SS2.p1.2.m2.1.1" xref="S3.SS2.p1.2.m2.1.1.cmml"><msup id="S3.SS2.p1.2.m2.1.1.2" xref="S3.SS2.p1.2.m2.1.1.2.cmml"><mi id="S3.SS2.p1.2.m2.1.1.2.2" xref="S3.SS2.p1.2.m2.1.1.2.2.cmml">𝐱</mi><mi id="S3.SS2.p1.2.m2.1.1.2.3" xref="S3.SS2.p1.2.m2.1.1.2.3.cmml">w</mi></msup><mo id="S3.SS2.p1.2.m2.1.1.1" xref="S3.SS2.p1.2.m2.1.1.1.cmml">≻</mo><msup id="S3.SS2.p1.2.m2.1.1.3" xref="S3.SS2.p1.2.m2.1.1.3.cmml"><mi id="S3.SS2.p1.2.m2.1.1.3.2" xref="S3.SS2.p1.2.m2.1.1.3.2.cmml">𝐱</mi><mi id="S3.SS2.p1.2.m2.1.1.3.3" xref="S3.SS2.p1.2.m2.1.1.3.3.cmml">l</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.1b"><apply id="S3.SS2.p1.2.m2.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1"><csymbol cd="latexml" id="S3.SS2.p1.2.m2.1.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1.1">succeeds</csymbol><apply id="S3.SS2.p1.2.m2.1.1.2.cmml" xref="S3.SS2.p1.2.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.1.1.2.1.cmml" xref="S3.SS2.p1.2.m2.1.1.2">superscript</csymbol><ci id="S3.SS2.p1.2.m2.1.1.2.2.cmml" xref="S3.SS2.p1.2.m2.1.1.2.2">𝐱</ci><ci id="S3.SS2.p1.2.m2.1.1.2.3.cmml" xref="S3.SS2.p1.2.m2.1.1.2.3">𝑤</ci></apply><apply id="S3.SS2.p1.2.m2.1.1.3.cmml" xref="S3.SS2.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.1.1.3.1.cmml" xref="S3.SS2.p1.2.m2.1.1.3">superscript</csymbol><ci id="S3.SS2.p1.2.m2.1.1.3.2.cmml" xref="S3.SS2.p1.2.m2.1.1.3.2">𝐱</ci><ci id="S3.SS2.p1.2.m2.1.1.3.3.cmml" xref="S3.SS2.p1.2.m2.1.1.3.3">𝑙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.1c">\mathbf{x}^{w}\succ\mathbf{x}^{l}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.2.m2.1d">bold_x start_POSTSUPERSCRIPT italic_w end_POSTSUPERSCRIPT ≻ bold_x start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT</annotation></semantics></math>. After preference data collection, in conventional RLHF, we train a reward function based on the Bradley-Terry (BT) model. The goal is to maximize cumulative rewards with a Kullback–Leibler (KL) constraint between the current model <math alttext="\pi_{\theta}" class="ltx_Math" display="inline" id="S3.SS2.p1.3.m3.1"><semantics id="S3.SS2.p1.3.m3.1a"><msub id="S3.SS2.p1.3.m3.1.1" xref="S3.SS2.p1.3.m3.1.1.cmml"><mi id="S3.SS2.p1.3.m3.1.1.2" xref="S3.SS2.p1.3.m3.1.1.2.cmml">π</mi><mi id="S3.SS2.p1.3.m3.1.1.3" xref="S3.SS2.p1.3.m3.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.3.m3.1b"><apply id="S3.SS2.p1.3.m3.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.3.m3.1.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS2.p1.3.m3.1.1.2.cmml" xref="S3.SS2.p1.3.m3.1.1.2">𝜋</ci><ci id="S3.SS2.p1.3.m3.1.1.3.cmml" xref="S3.SS2.p1.3.m3.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.3.m3.1c">\pi_{\theta}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.3.m3.1d">italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math> and a reference model <math alttext="\pi_{\rm ref}" class="ltx_Math" display="inline" id="S3.SS2.p1.4.m4.1"><semantics id="S3.SS2.p1.4.m4.1a"><msub id="S3.SS2.p1.4.m4.1.1" xref="S3.SS2.p1.4.m4.1.1.cmml"><mi id="S3.SS2.p1.4.m4.1.1.2" xref="S3.SS2.p1.4.m4.1.1.2.cmml">π</mi><mi id="S3.SS2.p1.4.m4.1.1.3" xref="S3.SS2.p1.4.m4.1.1.3.cmml">ref</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.4.m4.1b"><apply id="S3.SS2.p1.4.m4.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.4.m4.1.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1">subscript</csymbol><ci id="S3.SS2.p1.4.m4.1.1.2.cmml" xref="S3.SS2.p1.4.m4.1.1.2">𝜋</ci><ci id="S3.SS2.p1.4.m4.1.1.3.cmml" xref="S3.SS2.p1.4.m4.1.1.3">ref</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.4.m4.1c">\pi_{\rm ref}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.4.m4.1d">italic_π start_POSTSUBSCRIPT roman_ref end_POSTSUBSCRIPT</annotation></semantics></math> (usually the initial model) as follows</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equationgroup ltx_eqn_table" id="S3.E3">
<tbody>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S3.E3X">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\max_{\pi_{\theta}}\mathop{\mathbb{E}}_{\mathbf{c}\sim\mathcal{D}%
,\atop\mathbf{x}\sim\pi_{\theta}(\cdot|\mathbf{c})}\Big{[}r(\mathbf{x},\mathbf%
{c})-\beta D_{\rm KL}\big{(}\pi_{\theta}(\mathbf{x}|\mathbf{c})||\pi_{\rm ref}%
(\mathbf{x}|\mathbf{c})\big{)}\Big{]}," class="ltx_math_unparsed" display="inline" id="S3.E3X.2.1.1.m1.2"><semantics id="S3.E3X.2.1.1.m1.2a"><mrow id="S3.E3X.2.1.1.m1.2b"><munder id="S3.E3X.2.1.1.m1.2.3"><mi id="S3.E3X.2.1.1.m1.2.3.2">max</mi><msub id="S3.E3X.2.1.1.m1.2.3.3"><mi id="S3.E3X.2.1.1.m1.2.3.3.2">π</mi><mi id="S3.E3X.2.1.1.m1.2.3.3.3">θ</mi></msub></munder><munder id="S3.E3X.2.1.1.m1.2.4"><mo id="S3.E3X.2.1.1.m1.2.4.2" lspace="0.167em" movablelimits="false" rspace="0em">𝔼</mo><mfrac id="S3.E3X.2.1.1.m1.2.4.3" linethickness="0pt"><mrow id="S3.E3X.2.1.1.m1.2.4.3.2"><mi id="S3.E3X.2.1.1.m1.2.4.3.2.1">𝐜</mi><mo id="S3.E3X.2.1.1.m1.2.4.3.2.2">∼</mo><mi class="ltx_font_mathcaligraphic" id="S3.E3X.2.1.1.m1.2.4.3.2.3">𝒟</mi><mo id="S3.E3X.2.1.1.m1.2.4.3.2.4">,</mo></mrow><mrow id="S3.E3X.2.1.1.m1.2.4.3.3"><mi id="S3.E3X.2.1.1.m1.2.4.3.3.1">𝐱</mi><mo id="S3.E3X.2.1.1.m1.2.4.3.3.2">∼</mo><msub id="S3.E3X.2.1.1.m1.2.4.3.3.3"><mi id="S3.E3X.2.1.1.m1.2.4.3.3.3.2">π</mi><mi id="S3.E3X.2.1.1.m1.2.4.3.3.3.3">θ</mi></msub><mrow id="S3.E3X.2.1.1.m1.2.4.3.3.4"><mo id="S3.E3X.2.1.1.m1.2.4.3.3.4.1" stretchy="false">(</mo><mo id="S3.E3X.2.1.1.m1.2.4.3.3.4.2" lspace="0em" rspace="0em">⋅</mo><mo fence="false" id="S3.E3X.2.1.1.m1.2.4.3.3.4.3" rspace="0.167em" stretchy="false">|</mo><mi id="S3.E3X.2.1.1.m1.2.4.3.3.4.4">𝐜</mi><mo id="S3.E3X.2.1.1.m1.2.4.3.3.4.5" stretchy="false">)</mo></mrow></mrow></mfrac></munder><mrow id="S3.E3X.2.1.1.m1.2.5"><mo id="S3.E3X.2.1.1.m1.2.5.1" maxsize="160%" minsize="160%">[</mo><mi id="S3.E3X.2.1.1.m1.2.5.2">r</mi><mrow id="S3.E3X.2.1.1.m1.2.5.3"><mo id="S3.E3X.2.1.1.m1.2.5.3.1" stretchy="false">(</mo><mi id="S3.E3X.2.1.1.m1.1.1">𝐱</mi><mo id="S3.E3X.2.1.1.m1.2.5.3.2">,</mo><mi id="S3.E3X.2.1.1.m1.2.2">𝐜</mi><mo id="S3.E3X.2.1.1.m1.2.5.3.3" stretchy="false">)</mo></mrow><mo id="S3.E3X.2.1.1.m1.2.5.4">−</mo><mi id="S3.E3X.2.1.1.m1.2.5.5">β</mi><msub id="S3.E3X.2.1.1.m1.2.5.6"><mi id="S3.E3X.2.1.1.m1.2.5.6.2">D</mi><mi id="S3.E3X.2.1.1.m1.2.5.6.3">KL</mi></msub><mrow id="S3.E3X.2.1.1.m1.2.5.7"><mo id="S3.E3X.2.1.1.m1.2.5.7.1" maxsize="120%" minsize="120%">(</mo><msub id="S3.E3X.2.1.1.m1.2.5.7.2"><mi id="S3.E3X.2.1.1.m1.2.5.7.2.2">π</mi><mi id="S3.E3X.2.1.1.m1.2.5.7.2.3">θ</mi></msub><mrow id="S3.E3X.2.1.1.m1.2.5.7.3"><mo id="S3.E3X.2.1.1.m1.2.5.7.3.1" stretchy="false">(</mo><mi id="S3.E3X.2.1.1.m1.2.5.7.3.2">𝐱</mi><mo fence="false" id="S3.E3X.2.1.1.m1.2.5.7.3.3" rspace="0.167em" stretchy="false">|</mo><mi id="S3.E3X.2.1.1.m1.2.5.7.3.4">𝐜</mi><mo id="S3.E3X.2.1.1.m1.2.5.7.3.5" stretchy="false">)</mo></mrow><mo fence="false" id="S3.E3X.2.1.1.m1.2.5.7.4" rspace="0.167em" stretchy="false">|</mo><mo fence="false" id="S3.E3X.2.1.1.m1.2.5.7.5" rspace="0.167em" stretchy="false">|</mo><msub id="S3.E3X.2.1.1.m1.2.5.7.6"><mi id="S3.E3X.2.1.1.m1.2.5.7.6.2">π</mi><mi id="S3.E3X.2.1.1.m1.2.5.7.6.3">ref</mi></msub><mrow id="S3.E3X.2.1.1.m1.2.5.7.7"><mo id="S3.E3X.2.1.1.m1.2.5.7.7.1" stretchy="false">(</mo><mi id="S3.E3X.2.1.1.m1.2.5.7.7.2">𝐱</mi><mo fence="false" id="S3.E3X.2.1.1.m1.2.5.7.7.3" rspace="0.167em" stretchy="false">|</mo><mi id="S3.E3X.2.1.1.m1.2.5.7.7.4">𝐜</mi><mo id="S3.E3X.2.1.1.m1.2.5.7.7.5" stretchy="false">)</mo></mrow><mo id="S3.E3X.2.1.1.m1.2.5.7.8" maxsize="120%" minsize="120%">)</mo></mrow><mo id="S3.E3X.2.1.1.m1.2.5.8" maxsize="160%" minsize="160%">]</mo></mrow><mo id="S3.E3X.2.1.1.m1.2.6">,</mo></mrow><annotation encoding="application/x-tex" id="S3.E3X.2.1.1.m1.2c">\displaystyle\max_{\pi_{\theta}}\mathop{\mathbb{E}}_{\mathbf{c}\sim\mathcal{D}%
,\atop\mathbf{x}\sim\pi_{\theta}(\cdot|\mathbf{c})}\Big{[}r(\mathbf{x},\mathbf%
{c})-\beta D_{\rm KL}\big{(}\pi_{\theta}(\mathbf{x}|\mathbf{c})||\pi_{\rm ref}%
(\mathbf{x}|\mathbf{c})\big{)}\Big{]},</annotation><annotation encoding="application/x-llamapun" id="S3.E3X.2.1.1.m1.2d">roman_max start_POSTSUBSCRIPT italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT end_POSTSUBSCRIPT blackboard_E start_POSTSUBSCRIPT FRACOP start_ARG bold_c ∼ caligraphic_D , end_ARG start_ARG bold_x ∼ italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( ⋅ | bold_c ) end_ARG end_POSTSUBSCRIPT [ italic_r ( bold_x , bold_c ) - italic_β italic_D start_POSTSUBSCRIPT roman_KL end_POSTSUBSCRIPT ( italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( bold_x | bold_c ) | | italic_π start_POSTSUBSCRIPT roman_ref end_POSTSUBSCRIPT ( bold_x | bold_c ) ) ] ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(3)</span></td>
</tr>
</tbody>
</table>
<p class="ltx_p" id="S3.SS2.p1.5">where <math alttext="r(\cdot)" class="ltx_Math" display="inline" id="S3.SS2.p1.5.m1.1"><semantics id="S3.SS2.p1.5.m1.1a"><mrow id="S3.SS2.p1.5.m1.1.2" xref="S3.SS2.p1.5.m1.1.2.cmml"><mi id="S3.SS2.p1.5.m1.1.2.2" xref="S3.SS2.p1.5.m1.1.2.2.cmml">r</mi><mo id="S3.SS2.p1.5.m1.1.2.1" xref="S3.SS2.p1.5.m1.1.2.1.cmml">⁢</mo><mrow id="S3.SS2.p1.5.m1.1.2.3.2" xref="S3.SS2.p1.5.m1.1.2.cmml"><mo id="S3.SS2.p1.5.m1.1.2.3.2.1" stretchy="false" xref="S3.SS2.p1.5.m1.1.2.cmml">(</mo><mo id="S3.SS2.p1.5.m1.1.1" lspace="0em" rspace="0em" xref="S3.SS2.p1.5.m1.1.1.cmml">⋅</mo><mo id="S3.SS2.p1.5.m1.1.2.3.2.2" stretchy="false" xref="S3.SS2.p1.5.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.5.m1.1b"><apply id="S3.SS2.p1.5.m1.1.2.cmml" xref="S3.SS2.p1.5.m1.1.2"><times id="S3.SS2.p1.5.m1.1.2.1.cmml" xref="S3.SS2.p1.5.m1.1.2.1"></times><ci id="S3.SS2.p1.5.m1.1.2.2.cmml" xref="S3.SS2.p1.5.m1.1.2.2">𝑟</ci><ci id="S3.SS2.p1.5.m1.1.1.cmml" xref="S3.SS2.p1.5.m1.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.5.m1.1c">r(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.5.m1.1d">italic_r ( ⋅ )</annotation></semantics></math> is the reward function induced from the BT model.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS2.p2">
<p class="ltx_p" id="S3.SS2.p2.2">In DPO, the training process is simplified, and the target is converted to minimize a loss function as follows</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equationgroup ltx_eqn_table" id="S3.E4">
<tbody>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S3.E4X">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathcal{L}_{\rm DPO}(\theta)~{}={}" class="ltx_Math" display="inline" id="S3.E4X.2.1.1.m1.1"><semantics id="S3.E4X.2.1.1.m1.1a"><mrow id="S3.E4X.2.1.1.m1.1.2" xref="S3.E4X.2.1.1.m1.1.2.cmml"><mrow id="S3.E4X.2.1.1.m1.1.2.2" xref="S3.E4X.2.1.1.m1.1.2.2.cmml"><msub id="S3.E4X.2.1.1.m1.1.2.2.2" xref="S3.E4X.2.1.1.m1.1.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E4X.2.1.1.m1.1.2.2.2.2" xref="S3.E4X.2.1.1.m1.1.2.2.2.2.cmml">ℒ</mi><mi id="S3.E4X.2.1.1.m1.1.2.2.2.3" xref="S3.E4X.2.1.1.m1.1.2.2.2.3.cmml">DPO</mi></msub><mo id="S3.E4X.2.1.1.m1.1.2.2.1" xref="S3.E4X.2.1.1.m1.1.2.2.1.cmml">⁢</mo><mrow id="S3.E4X.2.1.1.m1.1.2.2.3.2" xref="S3.E4X.2.1.1.m1.1.2.2.cmml"><mo id="S3.E4X.2.1.1.m1.1.2.2.3.2.1" stretchy="false" xref="S3.E4X.2.1.1.m1.1.2.2.cmml">(</mo><mi id="S3.E4X.2.1.1.m1.1.1" xref="S3.E4X.2.1.1.m1.1.1.cmml">θ</mi><mo id="S3.E4X.2.1.1.m1.1.2.2.3.2.2" rspace="0.330em" stretchy="false" xref="S3.E4X.2.1.1.m1.1.2.2.cmml">)</mo></mrow></mrow><mo id="S3.E4X.2.1.1.m1.1.2.1" xref="S3.E4X.2.1.1.m1.1.2.1.cmml">=</mo><mi id="S3.E4X.2.1.1.m1.1.2.3" xref="S3.E4X.2.1.1.m1.1.2.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="S3.E4X.2.1.1.m1.1b"><apply id="S3.E4X.2.1.1.m1.1.2.cmml" xref="S3.E4X.2.1.1.m1.1.2"><eq id="S3.E4X.2.1.1.m1.1.2.1.cmml" xref="S3.E4X.2.1.1.m1.1.2.1"></eq><apply id="S3.E4X.2.1.1.m1.1.2.2.cmml" xref="S3.E4X.2.1.1.m1.1.2.2"><times id="S3.E4X.2.1.1.m1.1.2.2.1.cmml" xref="S3.E4X.2.1.1.m1.1.2.2.1"></times><apply id="S3.E4X.2.1.1.m1.1.2.2.2.cmml" xref="S3.E4X.2.1.1.m1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E4X.2.1.1.m1.1.2.2.2.1.cmml" xref="S3.E4X.2.1.1.m1.1.2.2.2">subscript</csymbol><ci id="S3.E4X.2.1.1.m1.1.2.2.2.2.cmml" xref="S3.E4X.2.1.1.m1.1.2.2.2.2">ℒ</ci><ci id="S3.E4X.2.1.1.m1.1.2.2.2.3.cmml" xref="S3.E4X.2.1.1.m1.1.2.2.2.3">DPO</ci></apply><ci id="S3.E4X.2.1.1.m1.1.1.cmml" xref="S3.E4X.2.1.1.m1.1.1">𝜃</ci></apply><csymbol cd="latexml" id="S3.E4X.2.1.1.m1.1.2.3.cmml" xref="S3.E4X.2.1.1.m1.1.2.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4X.2.1.1.m1.1c">\displaystyle\mathcal{L}_{\rm DPO}(\theta)~{}={}</annotation><annotation encoding="application/x-llamapun" id="S3.E4X.2.1.1.m1.1d">caligraphic_L start_POSTSUBSCRIPT roman_DPO end_POSTSUBSCRIPT ( italic_θ ) =</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\mathop{\mathbb{E}}_{(\mathbf{x}^{w},\mathbf{x}^{l},\mathbf{c})%
\sim\mathcal{D}}\Big{[}-\log{\sigma}\Big{(}\beta\log\frac{\pi_{\theta}(\mathbf%
{x}^{w}|\mathbf{c})}{\pi_{\rm ref}(\mathbf{x}^{w}|\mathbf{c})}-\beta\log\frac{%
\pi_{\theta}(\mathbf{x}^{l}|\mathbf{c})}{\pi_{\rm ref}(\mathbf{x}^{l}|\mathbf{%
c})}\Big{)}\Big{]}," class="ltx_Math" display="inline" id="S3.E4X.3.2.2.m1.8"><semantics id="S3.E4X.3.2.2.m1.8a"><mrow id="S3.E4X.3.2.2.m1.8.8.1" xref="S3.E4X.3.2.2.m1.8.8.1.1.cmml"><mrow id="S3.E4X.3.2.2.m1.8.8.1.1" xref="S3.E4X.3.2.2.m1.8.8.1.1.cmml"><munder id="S3.E4X.3.2.2.m1.8.8.1.1.2" xref="S3.E4X.3.2.2.m1.8.8.1.1.2.cmml"><mo id="S3.E4X.3.2.2.m1.8.8.1.1.2.2" movablelimits="false" xref="S3.E4X.3.2.2.m1.8.8.1.1.2.2.cmml">𝔼</mo><mrow id="S3.E4X.3.2.2.m1.3.3.3" xref="S3.E4X.3.2.2.m1.3.3.3.cmml"><mrow id="S3.E4X.3.2.2.m1.3.3.3.3.2" xref="S3.E4X.3.2.2.m1.3.3.3.3.3.cmml"><mo id="S3.E4X.3.2.2.m1.3.3.3.3.2.3" stretchy="false" xref="S3.E4X.3.2.2.m1.3.3.3.3.3.cmml">(</mo><msup id="S3.E4X.3.2.2.m1.2.2.2.2.1.1" xref="S3.E4X.3.2.2.m1.2.2.2.2.1.1.cmml"><mi id="S3.E4X.3.2.2.m1.2.2.2.2.1.1.2" xref="S3.E4X.3.2.2.m1.2.2.2.2.1.1.2.cmml">𝐱</mi><mi id="S3.E4X.3.2.2.m1.2.2.2.2.1.1.3" xref="S3.E4X.3.2.2.m1.2.2.2.2.1.1.3.cmml">w</mi></msup><mo id="S3.E4X.3.2.2.m1.3.3.3.3.2.4" xref="S3.E4X.3.2.2.m1.3.3.3.3.3.cmml">,</mo><msup id="S3.E4X.3.2.2.m1.3.3.3.3.2.2" xref="S3.E4X.3.2.2.m1.3.3.3.3.2.2.cmml"><mi id="S3.E4X.3.2.2.m1.3.3.3.3.2.2.2" xref="S3.E4X.3.2.2.m1.3.3.3.3.2.2.2.cmml">𝐱</mi><mi id="S3.E4X.3.2.2.m1.3.3.3.3.2.2.3" xref="S3.E4X.3.2.2.m1.3.3.3.3.2.2.3.cmml">l</mi></msup><mo id="S3.E4X.3.2.2.m1.3.3.3.3.2.5" xref="S3.E4X.3.2.2.m1.3.3.3.3.3.cmml">,</mo><mi id="S3.E4X.3.2.2.m1.1.1.1.1" xref="S3.E4X.3.2.2.m1.1.1.1.1.cmml">𝐜</mi><mo id="S3.E4X.3.2.2.m1.3.3.3.3.2.6" stretchy="false" xref="S3.E4X.3.2.2.m1.3.3.3.3.3.cmml">)</mo></mrow><mo id="S3.E4X.3.2.2.m1.3.3.3.4" xref="S3.E4X.3.2.2.m1.3.3.3.4.cmml">∼</mo><mi class="ltx_font_mathcaligraphic" id="S3.E4X.3.2.2.m1.3.3.3.5" xref="S3.E4X.3.2.2.m1.3.3.3.5.cmml">𝒟</mi></mrow></munder><mrow id="S3.E4X.3.2.2.m1.8.8.1.1.1.1" xref="S3.E4X.3.2.2.m1.8.8.1.1.1.2.cmml"><mo id="S3.E4X.3.2.2.m1.8.8.1.1.1.1.2" lspace="0em" maxsize="160%" minsize="160%" xref="S3.E4X.3.2.2.m1.8.8.1.1.1.2.1.cmml">[</mo><mrow id="S3.E4X.3.2.2.m1.8.8.1.1.1.1.1" xref="S3.E4X.3.2.2.m1.8.8.1.1.1.1.1.cmml"><mo id="S3.E4X.3.2.2.m1.8.8.1.1.1.1.1a" rspace="0.167em" xref="S3.E4X.3.2.2.m1.8.8.1.1.1.1.1.cmml">−</mo><mrow id="S3.E4X.3.2.2.m1.8.8.1.1.1.1.1.1" xref="S3.E4X.3.2.2.m1.8.8.1.1.1.1.1.1.cmml"><mrow id="S3.E4X.3.2.2.m1.8.8.1.1.1.1.1.1.3" xref="S3.E4X.3.2.2.m1.8.8.1.1.1.1.1.1.3.cmml"><mi id="S3.E4X.3.2.2.m1.8.8.1.1.1.1.1.1.3.1" xref="S3.E4X.3.2.2.m1.8.8.1.1.1.1.1.1.3.1.cmml">log</mi><mo id="S3.E4X.3.2.2.m1.8.8.1.1.1.1.1.1.3a" lspace="0.167em" xref="S3.E4X.3.2.2.m1.8.8.1.1.1.1.1.1.3.cmml">⁡</mo><mi id="S3.E4X.3.2.2.m1.8.8.1.1.1.1.1.1.3.2" xref="S3.E4X.3.2.2.m1.8.8.1.1.1.1.1.1.3.2.cmml">σ</mi></mrow><mo id="S3.E4X.3.2.2.m1.8.8.1.1.1.1.1.1.2" xref="S3.E4X.3.2.2.m1.8.8.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E4X.3.2.2.m1.8.8.1.1.1.1.1.1.1.1" xref="S3.E4X.3.2.2.m1.8.8.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E4X.3.2.2.m1.8.8.1.1.1.1.1.1.1.1.2" maxsize="160%" minsize="160%" xref="S3.E4X.3.2.2.m1.8.8.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E4X.3.2.2.m1.8.8.1.1.1.1.1.1.1.1.1" xref="S3.E4X.3.2.2.m1.8.8.1.1.1.1.1.1.1.1.1.cmml"><mrow id="S3.E4X.3.2.2.m1.8.8.1.1.1.1.1.1.1.1.1.2" xref="S3.E4X.3.2.2.m1.8.8.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E4X.3.2.2.m1.8.8.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E4X.3.2.2.m1.8.8.1.1.1.1.1.1.1.1.1.2.2.cmml">β</mi><mo id="S3.E4X.3.2.2.m1.8.8.1.1.1.1.1.1.1.1.1.2.1" lspace="0.167em" xref="S3.E4X.3.2.2.m1.8.8.1.1.1.1.1.1.1.1.1.2.1.cmml">⁢</mo><mrow id="S3.E4X.3.2.2.m1.8.8.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E4X.3.2.2.m1.8.8.1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.E4X.3.2.2.m1.8.8.1.1.1.1.1.1.1.1.1.2.3.1" xref="S3.E4X.3.2.2.m1.8.8.1.1.1.1.1.1.1.1.1.2.3.1.cmml">log</mi><mo id="S3.E4X.3.2.2.m1.8.8.1.1.1.1.1.1.1.1.1.2.3a" lspace="0.167em" xref="S3.E4X.3.2.2.m1.8.8.1.1.1.1.1.1.1.1.1.2.3.cmml">⁡</mo><mstyle displaystyle="true" id="S3.E4X.3.2.2.m1.5.5" xref="S3.E4X.3.2.2.m1.5.5.cmml"><mfrac id="S3.E4X.3.2.2.m1.5.5a" xref="S3.E4X.3.2.2.m1.5.5.cmml"><mrow id="S3.E4X.3.2.2.m1.4.4.1" xref="S3.E4X.3.2.2.m1.4.4.1.cmml"><msub id="S3.E4X.3.2.2.m1.4.4.1.3" xref="S3.E4X.3.2.2.m1.4.4.1.3.cmml"><mi id="S3.E4X.3.2.2.m1.4.4.1.3.2" xref="S3.E4X.3.2.2.m1.4.4.1.3.2.cmml">π</mi><mi id="S3.E4X.3.2.2.m1.4.4.1.3.3" xref="S3.E4X.3.2.2.m1.4.4.1.3.3.cmml">θ</mi></msub><mo id="S3.E4X.3.2.2.m1.4.4.1.2" xref="S3.E4X.3.2.2.m1.4.4.1.2.cmml">⁢</mo><mrow id="S3.E4X.3.2.2.m1.4.4.1.1.1" xref="S3.E4X.3.2.2.m1.4.4.1.1.1.1.cmml"><mo id="S3.E4X.3.2.2.m1.4.4.1.1.1.2" stretchy="false" xref="S3.E4X.3.2.2.m1.4.4.1.1.1.1.cmml">(</mo><mrow id="S3.E4X.3.2.2.m1.4.4.1.1.1.1" xref="S3.E4X.3.2.2.m1.4.4.1.1.1.1.cmml"><msup id="S3.E4X.3.2.2.m1.4.4.1.1.1.1.2" xref="S3.E4X.3.2.2.m1.4.4.1.1.1.1.2.cmml"><mi id="S3.E4X.3.2.2.m1.4.4.1.1.1.1.2.2" xref="S3.E4X.3.2.2.m1.4.4.1.1.1.1.2.2.cmml">𝐱</mi><mi id="S3.E4X.3.2.2.m1.4.4.1.1.1.1.2.3" xref="S3.E4X.3.2.2.m1.4.4.1.1.1.1.2.3.cmml">w</mi></msup><mo fence="false" id="S3.E4X.3.2.2.m1.4.4.1.1.1.1.1" xref="S3.E4X.3.2.2.m1.4.4.1.1.1.1.1.cmml">|</mo><mi id="S3.E4X.3.2.2.m1.4.4.1.1.1.1.3" xref="S3.E4X.3.2.2.m1.4.4.1.1.1.1.3.cmml">𝐜</mi></mrow><mo id="S3.E4X.3.2.2.m1.4.4.1.1.1.3" stretchy="false" xref="S3.E4X.3.2.2.m1.4.4.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="S3.E4X.3.2.2.m1.5.5.2" xref="S3.E4X.3.2.2.m1.5.5.2.cmml"><msub id="S3.E4X.3.2.2.m1.5.5.2.3" xref="S3.E4X.3.2.2.m1.5.5.2.3.cmml"><mi id="S3.E4X.3.2.2.m1.5.5.2.3.2" xref="S3.E4X.3.2.2.m1.5.5.2.3.2.cmml">π</mi><mi id="S3.E4X.3.2.2.m1.5.5.2.3.3" xref="S3.E4X.3.2.2.m1.5.5.2.3.3.cmml">ref</mi></msub><mo id="S3.E4X.3.2.2.m1.5.5.2.2" xref="S3.E4X.3.2.2.m1.5.5.2.2.cmml">⁢</mo><mrow id="S3.E4X.3.2.2.m1.5.5.2.1.1" xref="S3.E4X.3.2.2.m1.5.5.2.1.1.1.cmml"><mo id="S3.E4X.3.2.2.m1.5.5.2.1.1.2" stretchy="false" xref="S3.E4X.3.2.2.m1.5.5.2.1.1.1.cmml">(</mo><mrow id="S3.E4X.3.2.2.m1.5.5.2.1.1.1" xref="S3.E4X.3.2.2.m1.5.5.2.1.1.1.cmml"><msup id="S3.E4X.3.2.2.m1.5.5.2.1.1.1.2" xref="S3.E4X.3.2.2.m1.5.5.2.1.1.1.2.cmml"><mi id="S3.E4X.3.2.2.m1.5.5.2.1.1.1.2.2" xref="S3.E4X.3.2.2.m1.5.5.2.1.1.1.2.2.cmml">𝐱</mi><mi id="S3.E4X.3.2.2.m1.5.5.2.1.1.1.2.3" xref="S3.E4X.3.2.2.m1.5.5.2.1.1.1.2.3.cmml">w</mi></msup><mo fence="false" id="S3.E4X.3.2.2.m1.5.5.2.1.1.1.1" xref="S3.E4X.3.2.2.m1.5.5.2.1.1.1.1.cmml">|</mo><mi id="S3.E4X.3.2.2.m1.5.5.2.1.1.1.3" xref="S3.E4X.3.2.2.m1.5.5.2.1.1.1.3.cmml">𝐜</mi></mrow><mo id="S3.E4X.3.2.2.m1.5.5.2.1.1.3" stretchy="false" xref="S3.E4X.3.2.2.m1.5.5.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mstyle></mrow></mrow><mo id="S3.E4X.3.2.2.m1.8.8.1.1.1.1.1.1.1.1.1.1" xref="S3.E4X.3.2.2.m1.8.8.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><mrow id="S3.E4X.3.2.2.m1.8.8.1.1.1.1.1.1.1.1.1.3" xref="S3.E4X.3.2.2.m1.8.8.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E4X.3.2.2.m1.8.8.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E4X.3.2.2.m1.8.8.1.1.1.1.1.1.1.1.1.3.2.cmml">β</mi><mo id="S3.E4X.3.2.2.m1.8.8.1.1.1.1.1.1.1.1.1.3.1" lspace="0.167em" xref="S3.E4X.3.2.2.m1.8.8.1.1.1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mrow id="S3.E4X.3.2.2.m1.8.8.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E4X.3.2.2.m1.8.8.1.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="S3.E4X.3.2.2.m1.8.8.1.1.1.1.1.1.1.1.1.3.3.1" xref="S3.E4X.3.2.2.m1.8.8.1.1.1.1.1.1.1.1.1.3.3.1.cmml">log</mi><mo id="S3.E4X.3.2.2.m1.8.8.1.1.1.1.1.1.1.1.1.3.3a" lspace="0.167em" xref="S3.E4X.3.2.2.m1.8.8.1.1.1.1.1.1.1.1.1.3.3.cmml">⁡</mo><mstyle displaystyle="true" id="S3.E4X.3.2.2.m1.7.7" xref="S3.E4X.3.2.2.m1.7.7.cmml"><mfrac id="S3.E4X.3.2.2.m1.7.7a" xref="S3.E4X.3.2.2.m1.7.7.cmml"><mrow id="S3.E4X.3.2.2.m1.6.6.1" xref="S3.E4X.3.2.2.m1.6.6.1.cmml"><msub id="S3.E4X.3.2.2.m1.6.6.1.3" xref="S3.E4X.3.2.2.m1.6.6.1.3.cmml"><mi id="S3.E4X.3.2.2.m1.6.6.1.3.2" xref="S3.E4X.3.2.2.m1.6.6.1.3.2.cmml">π</mi><mi id="S3.E4X.3.2.2.m1.6.6.1.3.3" xref="S3.E4X.3.2.2.m1.6.6.1.3.3.cmml">θ</mi></msub><mo id="S3.E4X.3.2.2.m1.6.6.1.2" xref="S3.E4X.3.2.2.m1.6.6.1.2.cmml">⁢</mo><mrow id="S3.E4X.3.2.2.m1.6.6.1.1.1" xref="S3.E4X.3.2.2.m1.6.6.1.1.1.1.cmml"><mo id="S3.E4X.3.2.2.m1.6.6.1.1.1.2" stretchy="false" xref="S3.E4X.3.2.2.m1.6.6.1.1.1.1.cmml">(</mo><mrow id="S3.E4X.3.2.2.m1.6.6.1.1.1.1" xref="S3.E4X.3.2.2.m1.6.6.1.1.1.1.cmml"><msup id="S3.E4X.3.2.2.m1.6.6.1.1.1.1.2" xref="S3.E4X.3.2.2.m1.6.6.1.1.1.1.2.cmml"><mi id="S3.E4X.3.2.2.m1.6.6.1.1.1.1.2.2" xref="S3.E4X.3.2.2.m1.6.6.1.1.1.1.2.2.cmml">𝐱</mi><mi id="S3.E4X.3.2.2.m1.6.6.1.1.1.1.2.3" xref="S3.E4X.3.2.2.m1.6.6.1.1.1.1.2.3.cmml">l</mi></msup><mo fence="false" id="S3.E4X.3.2.2.m1.6.6.1.1.1.1.1" xref="S3.E4X.3.2.2.m1.6.6.1.1.1.1.1.cmml">|</mo><mi id="S3.E4X.3.2.2.m1.6.6.1.1.1.1.3" xref="S3.E4X.3.2.2.m1.6.6.1.1.1.1.3.cmml">𝐜</mi></mrow><mo id="S3.E4X.3.2.2.m1.6.6.1.1.1.3" stretchy="false" xref="S3.E4X.3.2.2.m1.6.6.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="S3.E4X.3.2.2.m1.7.7.2" xref="S3.E4X.3.2.2.m1.7.7.2.cmml"><msub id="S3.E4X.3.2.2.m1.7.7.2.3" xref="S3.E4X.3.2.2.m1.7.7.2.3.cmml"><mi id="S3.E4X.3.2.2.m1.7.7.2.3.2" xref="S3.E4X.3.2.2.m1.7.7.2.3.2.cmml">π</mi><mi id="S3.E4X.3.2.2.m1.7.7.2.3.3" xref="S3.E4X.3.2.2.m1.7.7.2.3.3.cmml">ref</mi></msub><mo id="S3.E4X.3.2.2.m1.7.7.2.2" xref="S3.E4X.3.2.2.m1.7.7.2.2.cmml">⁢</mo><mrow id="S3.E4X.3.2.2.m1.7.7.2.1.1" xref="S3.E4X.3.2.2.m1.7.7.2.1.1.1.cmml"><mo id="S3.E4X.3.2.2.m1.7.7.2.1.1.2" stretchy="false" xref="S3.E4X.3.2.2.m1.7.7.2.1.1.1.cmml">(</mo><mrow id="S3.E4X.3.2.2.m1.7.7.2.1.1.1" xref="S3.E4X.3.2.2.m1.7.7.2.1.1.1.cmml"><msup id="S3.E4X.3.2.2.m1.7.7.2.1.1.1.2" xref="S3.E4X.3.2.2.m1.7.7.2.1.1.1.2.cmml"><mi id="S3.E4X.3.2.2.m1.7.7.2.1.1.1.2.2" xref="S3.E4X.3.2.2.m1.7.7.2.1.1.1.2.2.cmml">𝐱</mi><mi id="S3.E4X.3.2.2.m1.7.7.2.1.1.1.2.3" xref="S3.E4X.3.2.2.m1.7.7.2.1.1.1.2.3.cmml">l</mi></msup><mo fence="false" id="S3.E4X.3.2.2.m1.7.7.2.1.1.1.1" xref="S3.E4X.3.2.2.m1.7.7.2.1.1.1.1.cmml">|</mo><mi id="S3.E4X.3.2.2.m1.7.7.2.1.1.1.3" xref="S3.E4X.3.2.2.m1.7.7.2.1.1.1.3.cmml">𝐜</mi></mrow><mo id="S3.E4X.3.2.2.m1.7.7.2.1.1.3" stretchy="false" xref="S3.E4X.3.2.2.m1.7.7.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mstyle></mrow></mrow></mrow><mo id="S3.E4X.3.2.2.m1.8.8.1.1.1.1.1.1.1.1.3" maxsize="160%" minsize="160%" xref="S3.E4X.3.2.2.m1.8.8.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E4X.3.2.2.m1.8.8.1.1.1.1.3" maxsize="160%" minsize="160%" xref="S3.E4X.3.2.2.m1.8.8.1.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="S3.E4X.3.2.2.m1.8.8.1.2" xref="S3.E4X.3.2.2.m1.8.8.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E4X.3.2.2.m1.8b"><apply id="S3.E4X.3.2.2.m1.8.8.1.1.cmml" xref="S3.E4X.3.2.2.m1.8.8.1"><apply id="S3.E4X.3.2.2.m1.8.8.1.1.2.cmml" xref="S3.E4X.3.2.2.m1.8.8.1.1.2"><csymbol cd="ambiguous" id="S3.E4X.3.2.2.m1.8.8.1.1.2.1.cmml" xref="S3.E4X.3.2.2.m1.8.8.1.1.2">subscript</csymbol><ci id="S3.E4X.3.2.2.m1.8.8.1.1.2.2.cmml" xref="S3.E4X.3.2.2.m1.8.8.1.1.2.2">𝔼</ci><apply id="S3.E4X.3.2.2.m1.3.3.3.cmml" xref="S3.E4X.3.2.2.m1.3.3.3"><csymbol cd="latexml" id="S3.E4X.3.2.2.m1.3.3.3.4.cmml" xref="S3.E4X.3.2.2.m1.3.3.3.4">similar-to</csymbol><vector id="S3.E4X.3.2.2.m1.3.3.3.3.3.cmml" xref="S3.E4X.3.2.2.m1.3.3.3.3.2"><apply id="S3.E4X.3.2.2.m1.2.2.2.2.1.1.cmml" xref="S3.E4X.3.2.2.m1.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.E4X.3.2.2.m1.2.2.2.2.1.1.1.cmml" xref="S3.E4X.3.2.2.m1.2.2.2.2.1.1">superscript</csymbol><ci id="S3.E4X.3.2.2.m1.2.2.2.2.1.1.2.cmml" xref="S3.E4X.3.2.2.m1.2.2.2.2.1.1.2">𝐱</ci><ci id="S3.E4X.3.2.2.m1.2.2.2.2.1.1.3.cmml" xref="S3.E4X.3.2.2.m1.2.2.2.2.1.1.3">𝑤</ci></apply><apply id="S3.E4X.3.2.2.m1.3.3.3.3.2.2.cmml" xref="S3.E4X.3.2.2.m1.3.3.3.3.2.2"><csymbol cd="ambiguous" id="S3.E4X.3.2.2.m1.3.3.3.3.2.2.1.cmml" xref="S3.E4X.3.2.2.m1.3.3.3.3.2.2">superscript</csymbol><ci id="S3.E4X.3.2.2.m1.3.3.3.3.2.2.2.cmml" xref="S3.E4X.3.2.2.m1.3.3.3.3.2.2.2">𝐱</ci><ci id="S3.E4X.3.2.2.m1.3.3.3.3.2.2.3.cmml" xref="S3.E4X.3.2.2.m1.3.3.3.3.2.2.3">𝑙</ci></apply><ci id="S3.E4X.3.2.2.m1.1.1.1.1.cmml" xref="S3.E4X.3.2.2.m1.1.1.1.1">𝐜</ci></vector><ci id="S3.E4X.3.2.2.m1.3.3.3.5.cmml" xref="S3.E4X.3.2.2.m1.3.3.3.5">𝒟</ci></apply></apply><apply id="S3.E4X.3.2.2.m1.8.8.1.1.1.2.cmml" xref="S3.E4X.3.2.2.m1.8.8.1.1.1.1"><csymbol cd="latexml" id="S3.E4X.3.2.2.m1.8.8.1.1.1.2.1.cmml" xref="S3.E4X.3.2.2.m1.8.8.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.E4X.3.2.2.m1.8.8.1.1.1.1.1.cmml" xref="S3.E4X.3.2.2.m1.8.8.1.1.1.1.1"><minus id="S3.E4X.3.2.2.m1.8.8.1.1.1.1.1.2.cmml" xref="S3.E4X.3.2.2.m1.8.8.1.1.1.1.1"></minus><apply id="S3.E4X.3.2.2.m1.8.8.1.1.1.1.1.1.cmml" xref="S3.E4X.3.2.2.m1.8.8.1.1.1.1.1.1"><times id="S3.E4X.3.2.2.m1.8.8.1.1.1.1.1.1.2.cmml" xref="S3.E4X.3.2.2.m1.8.8.1.1.1.1.1.1.2"></times><apply id="S3.E4X.3.2.2.m1.8.8.1.1.1.1.1.1.3.cmml" xref="S3.E4X.3.2.2.m1.8.8.1.1.1.1.1.1.3"><log id="S3.E4X.3.2.2.m1.8.8.1.1.1.1.1.1.3.1.cmml" xref="S3.E4X.3.2.2.m1.8.8.1.1.1.1.1.1.3.1"></log><ci id="S3.E4X.3.2.2.m1.8.8.1.1.1.1.1.1.3.2.cmml" xref="S3.E4X.3.2.2.m1.8.8.1.1.1.1.1.1.3.2">𝜎</ci></apply><apply id="S3.E4X.3.2.2.m1.8.8.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4X.3.2.2.m1.8.8.1.1.1.1.1.1.1.1"><minus id="S3.E4X.3.2.2.m1.8.8.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4X.3.2.2.m1.8.8.1.1.1.1.1.1.1.1.1.1"></minus><apply id="S3.E4X.3.2.2.m1.8.8.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E4X.3.2.2.m1.8.8.1.1.1.1.1.1.1.1.1.2"><times id="S3.E4X.3.2.2.m1.8.8.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E4X.3.2.2.m1.8.8.1.1.1.1.1.1.1.1.1.2.1"></times><ci id="S3.E4X.3.2.2.m1.8.8.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E4X.3.2.2.m1.8.8.1.1.1.1.1.1.1.1.1.2.2">𝛽</ci><apply id="S3.E4X.3.2.2.m1.8.8.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E4X.3.2.2.m1.8.8.1.1.1.1.1.1.1.1.1.2.3"><log id="S3.E4X.3.2.2.m1.8.8.1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E4X.3.2.2.m1.8.8.1.1.1.1.1.1.1.1.1.2.3.1"></log><apply id="S3.E4X.3.2.2.m1.5.5.cmml" xref="S3.E4X.3.2.2.m1.5.5"><divide id="S3.E4X.3.2.2.m1.5.5.3.cmml" xref="S3.E4X.3.2.2.m1.5.5"></divide><apply id="S3.E4X.3.2.2.m1.4.4.1.cmml" xref="S3.E4X.3.2.2.m1.4.4.1"><times id="S3.E4X.3.2.2.m1.4.4.1.2.cmml" xref="S3.E4X.3.2.2.m1.4.4.1.2"></times><apply id="S3.E4X.3.2.2.m1.4.4.1.3.cmml" xref="S3.E4X.3.2.2.m1.4.4.1.3"><csymbol cd="ambiguous" id="S3.E4X.3.2.2.m1.4.4.1.3.1.cmml" xref="S3.E4X.3.2.2.m1.4.4.1.3">subscript</csymbol><ci id="S3.E4X.3.2.2.m1.4.4.1.3.2.cmml" xref="S3.E4X.3.2.2.m1.4.4.1.3.2">𝜋</ci><ci id="S3.E4X.3.2.2.m1.4.4.1.3.3.cmml" xref="S3.E4X.3.2.2.m1.4.4.1.3.3">𝜃</ci></apply><apply id="S3.E4X.3.2.2.m1.4.4.1.1.1.1.cmml" xref="S3.E4X.3.2.2.m1.4.4.1.1.1"><csymbol cd="latexml" id="S3.E4X.3.2.2.m1.4.4.1.1.1.1.1.cmml" xref="S3.E4X.3.2.2.m1.4.4.1.1.1.1.1">conditional</csymbol><apply id="S3.E4X.3.2.2.m1.4.4.1.1.1.1.2.cmml" xref="S3.E4X.3.2.2.m1.4.4.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E4X.3.2.2.m1.4.4.1.1.1.1.2.1.cmml" xref="S3.E4X.3.2.2.m1.4.4.1.1.1.1.2">superscript</csymbol><ci id="S3.E4X.3.2.2.m1.4.4.1.1.1.1.2.2.cmml" xref="S3.E4X.3.2.2.m1.4.4.1.1.1.1.2.2">𝐱</ci><ci id="S3.E4X.3.2.2.m1.4.4.1.1.1.1.2.3.cmml" xref="S3.E4X.3.2.2.m1.4.4.1.1.1.1.2.3">𝑤</ci></apply><ci id="S3.E4X.3.2.2.m1.4.4.1.1.1.1.3.cmml" xref="S3.E4X.3.2.2.m1.4.4.1.1.1.1.3">𝐜</ci></apply></apply><apply id="S3.E4X.3.2.2.m1.5.5.2.cmml" xref="S3.E4X.3.2.2.m1.5.5.2"><times id="S3.E4X.3.2.2.m1.5.5.2.2.cmml" xref="S3.E4X.3.2.2.m1.5.5.2.2"></times><apply id="S3.E4X.3.2.2.m1.5.5.2.3.cmml" xref="S3.E4X.3.2.2.m1.5.5.2.3"><csymbol cd="ambiguous" id="S3.E4X.3.2.2.m1.5.5.2.3.1.cmml" xref="S3.E4X.3.2.2.m1.5.5.2.3">subscript</csymbol><ci id="S3.E4X.3.2.2.m1.5.5.2.3.2.cmml" xref="S3.E4X.3.2.2.m1.5.5.2.3.2">𝜋</ci><ci id="S3.E4X.3.2.2.m1.5.5.2.3.3.cmml" xref="S3.E4X.3.2.2.m1.5.5.2.3.3">ref</ci></apply><apply id="S3.E4X.3.2.2.m1.5.5.2.1.1.1.cmml" xref="S3.E4X.3.2.2.m1.5.5.2.1.1"><csymbol cd="latexml" id="S3.E4X.3.2.2.m1.5.5.2.1.1.1.1.cmml" xref="S3.E4X.3.2.2.m1.5.5.2.1.1.1.1">conditional</csymbol><apply id="S3.E4X.3.2.2.m1.5.5.2.1.1.1.2.cmml" xref="S3.E4X.3.2.2.m1.5.5.2.1.1.1.2"><csymbol cd="ambiguous" id="S3.E4X.3.2.2.m1.5.5.2.1.1.1.2.1.cmml" xref="S3.E4X.3.2.2.m1.5.5.2.1.1.1.2">superscript</csymbol><ci id="S3.E4X.3.2.2.m1.5.5.2.1.1.1.2.2.cmml" xref="S3.E4X.3.2.2.m1.5.5.2.1.1.1.2.2">𝐱</ci><ci id="S3.E4X.3.2.2.m1.5.5.2.1.1.1.2.3.cmml" xref="S3.E4X.3.2.2.m1.5.5.2.1.1.1.2.3">𝑤</ci></apply><ci id="S3.E4X.3.2.2.m1.5.5.2.1.1.1.3.cmml" xref="S3.E4X.3.2.2.m1.5.5.2.1.1.1.3">𝐜</ci></apply></apply></apply></apply></apply><apply id="S3.E4X.3.2.2.m1.8.8.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E4X.3.2.2.m1.8.8.1.1.1.1.1.1.1.1.1.3"><times id="S3.E4X.3.2.2.m1.8.8.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E4X.3.2.2.m1.8.8.1.1.1.1.1.1.1.1.1.3.1"></times><ci id="S3.E4X.3.2.2.m1.8.8.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E4X.3.2.2.m1.8.8.1.1.1.1.1.1.1.1.1.3.2">𝛽</ci><apply id="S3.E4X.3.2.2.m1.8.8.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E4X.3.2.2.m1.8.8.1.1.1.1.1.1.1.1.1.3.3"><log id="S3.E4X.3.2.2.m1.8.8.1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.E4X.3.2.2.m1.8.8.1.1.1.1.1.1.1.1.1.3.3.1"></log><apply id="S3.E4X.3.2.2.m1.7.7.cmml" xref="S3.E4X.3.2.2.m1.7.7"><divide id="S3.E4X.3.2.2.m1.7.7.3.cmml" xref="S3.E4X.3.2.2.m1.7.7"></divide><apply id="S3.E4X.3.2.2.m1.6.6.1.cmml" xref="S3.E4X.3.2.2.m1.6.6.1"><times id="S3.E4X.3.2.2.m1.6.6.1.2.cmml" xref="S3.E4X.3.2.2.m1.6.6.1.2"></times><apply id="S3.E4X.3.2.2.m1.6.6.1.3.cmml" xref="S3.E4X.3.2.2.m1.6.6.1.3"><csymbol cd="ambiguous" id="S3.E4X.3.2.2.m1.6.6.1.3.1.cmml" xref="S3.E4X.3.2.2.m1.6.6.1.3">subscript</csymbol><ci id="S3.E4X.3.2.2.m1.6.6.1.3.2.cmml" xref="S3.E4X.3.2.2.m1.6.6.1.3.2">𝜋</ci><ci id="S3.E4X.3.2.2.m1.6.6.1.3.3.cmml" xref="S3.E4X.3.2.2.m1.6.6.1.3.3">𝜃</ci></apply><apply id="S3.E4X.3.2.2.m1.6.6.1.1.1.1.cmml" xref="S3.E4X.3.2.2.m1.6.6.1.1.1"><csymbol cd="latexml" id="S3.E4X.3.2.2.m1.6.6.1.1.1.1.1.cmml" xref="S3.E4X.3.2.2.m1.6.6.1.1.1.1.1">conditional</csymbol><apply id="S3.E4X.3.2.2.m1.6.6.1.1.1.1.2.cmml" xref="S3.E4X.3.2.2.m1.6.6.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E4X.3.2.2.m1.6.6.1.1.1.1.2.1.cmml" xref="S3.E4X.3.2.2.m1.6.6.1.1.1.1.2">superscript</csymbol><ci id="S3.E4X.3.2.2.m1.6.6.1.1.1.1.2.2.cmml" xref="S3.E4X.3.2.2.m1.6.6.1.1.1.1.2.2">𝐱</ci><ci id="S3.E4X.3.2.2.m1.6.6.1.1.1.1.2.3.cmml" xref="S3.E4X.3.2.2.m1.6.6.1.1.1.1.2.3">𝑙</ci></apply><ci id="S3.E4X.3.2.2.m1.6.6.1.1.1.1.3.cmml" xref="S3.E4X.3.2.2.m1.6.6.1.1.1.1.3">𝐜</ci></apply></apply><apply id="S3.E4X.3.2.2.m1.7.7.2.cmml" xref="S3.E4X.3.2.2.m1.7.7.2"><times id="S3.E4X.3.2.2.m1.7.7.2.2.cmml" xref="S3.E4X.3.2.2.m1.7.7.2.2"></times><apply id="S3.E4X.3.2.2.m1.7.7.2.3.cmml" xref="S3.E4X.3.2.2.m1.7.7.2.3"><csymbol cd="ambiguous" id="S3.E4X.3.2.2.m1.7.7.2.3.1.cmml" xref="S3.E4X.3.2.2.m1.7.7.2.3">subscript</csymbol><ci id="S3.E4X.3.2.2.m1.7.7.2.3.2.cmml" xref="S3.E4X.3.2.2.m1.7.7.2.3.2">𝜋</ci><ci id="S3.E4X.3.2.2.m1.7.7.2.3.3.cmml" xref="S3.E4X.3.2.2.m1.7.7.2.3.3">ref</ci></apply><apply id="S3.E4X.3.2.2.m1.7.7.2.1.1.1.cmml" xref="S3.E4X.3.2.2.m1.7.7.2.1.1"><csymbol cd="latexml" id="S3.E4X.3.2.2.m1.7.7.2.1.1.1.1.cmml" xref="S3.E4X.3.2.2.m1.7.7.2.1.1.1.1">conditional</csymbol><apply id="S3.E4X.3.2.2.m1.7.7.2.1.1.1.2.cmml" xref="S3.E4X.3.2.2.m1.7.7.2.1.1.1.2"><csymbol cd="ambiguous" id="S3.E4X.3.2.2.m1.7.7.2.1.1.1.2.1.cmml" xref="S3.E4X.3.2.2.m1.7.7.2.1.1.1.2">superscript</csymbol><ci id="S3.E4X.3.2.2.m1.7.7.2.1.1.1.2.2.cmml" xref="S3.E4X.3.2.2.m1.7.7.2.1.1.1.2.2">𝐱</ci><ci id="S3.E4X.3.2.2.m1.7.7.2.1.1.1.2.3.cmml" xref="S3.E4X.3.2.2.m1.7.7.2.1.1.1.2.3">𝑙</ci></apply><ci id="S3.E4X.3.2.2.m1.7.7.2.1.1.1.3.cmml" xref="S3.E4X.3.2.2.m1.7.7.2.1.1.1.3">𝐜</ci></apply></apply></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4X.3.2.2.m1.8c">\displaystyle\mathop{\mathbb{E}}_{(\mathbf{x}^{w},\mathbf{x}^{l},\mathbf{c})%
\sim\mathcal{D}}\Big{[}-\log{\sigma}\Big{(}\beta\log\frac{\pi_{\theta}(\mathbf%
{x}^{w}|\mathbf{c})}{\pi_{\rm ref}(\mathbf{x}^{w}|\mathbf{c})}-\beta\log\frac{%
\pi_{\theta}(\mathbf{x}^{l}|\mathbf{c})}{\pi_{\rm ref}(\mathbf{x}^{l}|\mathbf{%
c})}\Big{)}\Big{]},</annotation><annotation encoding="application/x-llamapun" id="S3.E4X.3.2.2.m1.8d">blackboard_E start_POSTSUBSCRIPT ( bold_x start_POSTSUPERSCRIPT italic_w end_POSTSUPERSCRIPT , bold_x start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT , bold_c ) ∼ caligraphic_D end_POSTSUBSCRIPT [ - roman_log italic_σ ( italic_β roman_log divide start_ARG italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( bold_x start_POSTSUPERSCRIPT italic_w end_POSTSUPERSCRIPT | bold_c ) end_ARG start_ARG italic_π start_POSTSUBSCRIPT roman_ref end_POSTSUBSCRIPT ( bold_x start_POSTSUPERSCRIPT italic_w end_POSTSUPERSCRIPT | bold_c ) end_ARG - italic_β roman_log divide start_ARG italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( bold_x start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT | bold_c ) end_ARG start_ARG italic_π start_POSTSUBSCRIPT roman_ref end_POSTSUBSCRIPT ( bold_x start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT | bold_c ) end_ARG ) ] ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(4)</span></td>
</tr>
</tbody>
</table>
<p class="ltx_p" id="S3.SS2.p2.1">where <math alttext="\sigma(\cdot)" class="ltx_Math" display="inline" id="S3.SS2.p2.1.m1.1"><semantics id="S3.SS2.p2.1.m1.1a"><mrow id="S3.SS2.p2.1.m1.1.2" xref="S3.SS2.p2.1.m1.1.2.cmml"><mi id="S3.SS2.p2.1.m1.1.2.2" xref="S3.SS2.p2.1.m1.1.2.2.cmml">σ</mi><mo id="S3.SS2.p2.1.m1.1.2.1" xref="S3.SS2.p2.1.m1.1.2.1.cmml">⁢</mo><mrow id="S3.SS2.p2.1.m1.1.2.3.2" xref="S3.SS2.p2.1.m1.1.2.cmml"><mo id="S3.SS2.p2.1.m1.1.2.3.2.1" stretchy="false" xref="S3.SS2.p2.1.m1.1.2.cmml">(</mo><mo id="S3.SS2.p2.1.m1.1.1" lspace="0em" rspace="0em" xref="S3.SS2.p2.1.m1.1.1.cmml">⋅</mo><mo id="S3.SS2.p2.1.m1.1.2.3.2.2" stretchy="false" xref="S3.SS2.p2.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.1.m1.1b"><apply id="S3.SS2.p2.1.m1.1.2.cmml" xref="S3.SS2.p2.1.m1.1.2"><times id="S3.SS2.p2.1.m1.1.2.1.cmml" xref="S3.SS2.p2.1.m1.1.2.1"></times><ci id="S3.SS2.p2.1.m1.1.2.2.cmml" xref="S3.SS2.p2.1.m1.1.2.2">𝜎</ci><ci id="S3.SS2.p2.1.m1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.1.m1.1c">\sigma(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.1.m1.1d">italic_σ ( ⋅ )</annotation></semantics></math> (without subscript) is the logistic function.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_figure" id="S3.F1">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S3.F1.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="137" id="S3.F1.sf1.g1" src="https://arxiv.org/html/2410.05255v1/x1.png" width="159">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span><math alttext="{\rm ref}=0" class="ltx_Math" display="inline" id="S3.F1.sf1.2.m1.1"><semantics id="S3.F1.sf1.2.m1.1b"><mrow id="S3.F1.sf1.2.m1.1.1" xref="S3.F1.sf1.2.m1.1.1.cmml"><mi id="S3.F1.sf1.2.m1.1.1.2" xref="S3.F1.sf1.2.m1.1.1.2.cmml">ref</mi><mo id="S3.F1.sf1.2.m1.1.1.1" xref="S3.F1.sf1.2.m1.1.1.1.cmml">=</mo><mn id="S3.F1.sf1.2.m1.1.1.3" xref="S3.F1.sf1.2.m1.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.F1.sf1.2.m1.1c"><apply id="S3.F1.sf1.2.m1.1.1.cmml" xref="S3.F1.sf1.2.m1.1.1"><eq id="S3.F1.sf1.2.m1.1.1.1.cmml" xref="S3.F1.sf1.2.m1.1.1.1"></eq><ci id="S3.F1.sf1.2.m1.1.1.2.cmml" xref="S3.F1.sf1.2.m1.1.1.2">ref</ci><cn id="S3.F1.sf1.2.m1.1.1.3.cmml" type="integer" xref="S3.F1.sf1.2.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F1.sf1.2.m1.1d">{\rm ref}=0</annotation><annotation encoding="application/x-llamapun" id="S3.F1.sf1.2.m1.1e">roman_ref = 0</annotation></semantics></math></figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S3.F1.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="162" id="S3.F1.sf2.g1" src="https://arxiv.org/html/2410.05255v1/x2.png" width="221">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span><math alttext="{\rm ref}=k-1" class="ltx_Math" display="inline" id="S3.F1.sf2.2.m1.1"><semantics id="S3.F1.sf2.2.m1.1b"><mrow id="S3.F1.sf2.2.m1.1.1" xref="S3.F1.sf2.2.m1.1.1.cmml"><mi id="S3.F1.sf2.2.m1.1.1.2" xref="S3.F1.sf2.2.m1.1.1.2.cmml">ref</mi><mo id="S3.F1.sf2.2.m1.1.1.1" xref="S3.F1.sf2.2.m1.1.1.1.cmml">=</mo><mrow id="S3.F1.sf2.2.m1.1.1.3" xref="S3.F1.sf2.2.m1.1.1.3.cmml"><mi id="S3.F1.sf2.2.m1.1.1.3.2" xref="S3.F1.sf2.2.m1.1.1.3.2.cmml">k</mi><mo id="S3.F1.sf2.2.m1.1.1.3.1" xref="S3.F1.sf2.2.m1.1.1.3.1.cmml">−</mo><mn id="S3.F1.sf2.2.m1.1.1.3.3" xref="S3.F1.sf2.2.m1.1.1.3.3.cmml">1</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.F1.sf2.2.m1.1c"><apply id="S3.F1.sf2.2.m1.1.1.cmml" xref="S3.F1.sf2.2.m1.1.1"><eq id="S3.F1.sf2.2.m1.1.1.1.cmml" xref="S3.F1.sf2.2.m1.1.1.1"></eq><ci id="S3.F1.sf2.2.m1.1.1.2.cmml" xref="S3.F1.sf2.2.m1.1.1.2">ref</ci><apply id="S3.F1.sf2.2.m1.1.1.3.cmml" xref="S3.F1.sf2.2.m1.1.1.3"><minus id="S3.F1.sf2.2.m1.1.1.3.1.cmml" xref="S3.F1.sf2.2.m1.1.1.3.1"></minus><ci id="S3.F1.sf2.2.m1.1.1.3.2.cmml" xref="S3.F1.sf2.2.m1.1.1.3.2">𝑘</ci><cn id="S3.F1.sf2.2.m1.1.1.3.3.cmml" type="integer" xref="S3.F1.sf2.2.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F1.sf2.2.m1.1d">{\rm ref}=k-1</annotation><annotation encoding="application/x-llamapun" id="S3.F1.sf2.2.m1.1e">roman_ref = italic_k - 1</annotation></semantics></math></figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S3.F1.sf3"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="189" id="S3.F1.sf3.g1" src="https://arxiv.org/html/2410.05255v1/x3.png" width="194">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(c) </span><math alttext="{\rm ref}=[0,k-1]" class="ltx_Math" display="inline" id="S3.F1.sf3.2.m1.2"><semantics id="S3.F1.sf3.2.m1.2b"><mrow id="S3.F1.sf3.2.m1.2.2" xref="S3.F1.sf3.2.m1.2.2.cmml"><mi id="S3.F1.sf3.2.m1.2.2.3" xref="S3.F1.sf3.2.m1.2.2.3.cmml">ref</mi><mo id="S3.F1.sf3.2.m1.2.2.2" xref="S3.F1.sf3.2.m1.2.2.2.cmml">=</mo><mrow id="S3.F1.sf3.2.m1.2.2.1.1" xref="S3.F1.sf3.2.m1.2.2.1.2.cmml"><mo id="S3.F1.sf3.2.m1.2.2.1.1.2" stretchy="false" xref="S3.F1.sf3.2.m1.2.2.1.2.cmml">[</mo><mn id="S3.F1.sf3.2.m1.1.1" xref="S3.F1.sf3.2.m1.1.1.cmml">0</mn><mo id="S3.F1.sf3.2.m1.2.2.1.1.3" xref="S3.F1.sf3.2.m1.2.2.1.2.cmml">,</mo><mrow id="S3.F1.sf3.2.m1.2.2.1.1.1" xref="S3.F1.sf3.2.m1.2.2.1.1.1.cmml"><mi id="S3.F1.sf3.2.m1.2.2.1.1.1.2" xref="S3.F1.sf3.2.m1.2.2.1.1.1.2.cmml">k</mi><mo id="S3.F1.sf3.2.m1.2.2.1.1.1.1" xref="S3.F1.sf3.2.m1.2.2.1.1.1.1.cmml">−</mo><mn id="S3.F1.sf3.2.m1.2.2.1.1.1.3" xref="S3.F1.sf3.2.m1.2.2.1.1.1.3.cmml">1</mn></mrow><mo id="S3.F1.sf3.2.m1.2.2.1.1.4" stretchy="false" xref="S3.F1.sf3.2.m1.2.2.1.2.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.F1.sf3.2.m1.2c"><apply id="S3.F1.sf3.2.m1.2.2.cmml" xref="S3.F1.sf3.2.m1.2.2"><eq id="S3.F1.sf3.2.m1.2.2.2.cmml" xref="S3.F1.sf3.2.m1.2.2.2"></eq><ci id="S3.F1.sf3.2.m1.2.2.3.cmml" xref="S3.F1.sf3.2.m1.2.2.3">ref</ci><interval closure="closed" id="S3.F1.sf3.2.m1.2.2.1.2.cmml" xref="S3.F1.sf3.2.m1.2.2.1.1"><cn id="S3.F1.sf3.2.m1.1.1.cmml" type="integer" xref="S3.F1.sf3.2.m1.1.1">0</cn><apply id="S3.F1.sf3.2.m1.2.2.1.1.1.cmml" xref="S3.F1.sf3.2.m1.2.2.1.1.1"><minus id="S3.F1.sf3.2.m1.2.2.1.1.1.1.cmml" xref="S3.F1.sf3.2.m1.2.2.1.1.1.1"></minus><ci id="S3.F1.sf3.2.m1.2.2.1.1.1.2.cmml" xref="S3.F1.sf3.2.m1.2.2.1.1.1.2">𝑘</ci><cn id="S3.F1.sf3.2.m1.2.2.1.1.1.3.cmml" type="integer" xref="S3.F1.sf3.2.m1.2.2.1.1.1.3">1</cn></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F1.sf3.2.m1.2d">{\rm ref}=[0,k-1]</annotation><annotation encoding="application/x-llamapun" id="S3.F1.sf3.2.m1.2e">roman_ref = [ 0 , italic_k - 1 ]</annotation></semantics></math> (ours)</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Illustration of the exploration area. In the <math alttext="k" class="ltx_Math" display="inline" id="S3.F1.3.m1.1"><semantics id="S3.F1.3.m1.1b"><mi id="S3.F1.3.m1.1.1" xref="S3.F1.3.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.F1.3.m1.1c"><ci id="S3.F1.3.m1.1.1.cmml" xref="S3.F1.3.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F1.3.m1.1d">k</annotation><annotation encoding="application/x-llamapun" id="S3.F1.3.m1.1e">italic_k</annotation></semantics></math>-th (<math alttext="k=3" class="ltx_Math" display="inline" id="S3.F1.4.m2.1"><semantics id="S3.F1.4.m2.1b"><mrow id="S3.F1.4.m2.1.1" xref="S3.F1.4.m2.1.1.cmml"><mi id="S3.F1.4.m2.1.1.2" xref="S3.F1.4.m2.1.1.2.cmml">k</mi><mo id="S3.F1.4.m2.1.1.1" xref="S3.F1.4.m2.1.1.1.cmml">=</mo><mn id="S3.F1.4.m2.1.1.3" xref="S3.F1.4.m2.1.1.3.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.F1.4.m2.1c"><apply id="S3.F1.4.m2.1.1.cmml" xref="S3.F1.4.m2.1.1"><eq id="S3.F1.4.m2.1.1.1.cmml" xref="S3.F1.4.m2.1.1.1"></eq><ci id="S3.F1.4.m2.1.1.2.cmml" xref="S3.F1.4.m2.1.1.2">𝑘</ci><cn id="S3.F1.4.m2.1.1.3.cmml" type="integer" xref="S3.F1.4.m2.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F1.4.m2.1d">k=3</annotation><annotation encoding="application/x-llamapun" id="S3.F1.4.m2.1e">italic_k = 3</annotation></semantics></math>) iteration, the green area satisfies the current KL constraint, while the blank area does not.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Iterative Alignment for Diffusion Models</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Iterative Alignment from Semi-policy Preference Optimization</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.2">When we have supervised fine-tuning data (<math alttext="\mathbf{c},\mathbf{x}^{w}" class="ltx_Math" display="inline" id="S4.SS1.p1.1.m1.2"><semantics id="S4.SS1.p1.1.m1.2a"><mrow id="S4.SS1.p1.1.m1.2.2.1" xref="S4.SS1.p1.1.m1.2.2.2.cmml"><mi id="S4.SS1.p1.1.m1.1.1" xref="S4.SS1.p1.1.m1.1.1.cmml">𝐜</mi><mo id="S4.SS1.p1.1.m1.2.2.1.2" xref="S4.SS1.p1.1.m1.2.2.2.cmml">,</mo><msup id="S4.SS1.p1.1.m1.2.2.1.1" xref="S4.SS1.p1.1.m1.2.2.1.1.cmml"><mi id="S4.SS1.p1.1.m1.2.2.1.1.2" xref="S4.SS1.p1.1.m1.2.2.1.1.2.cmml">𝐱</mi><mi id="S4.SS1.p1.1.m1.2.2.1.1.3" xref="S4.SS1.p1.1.m1.2.2.1.1.3.cmml">w</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.1.m1.2b"><list id="S4.SS1.p1.1.m1.2.2.2.cmml" xref="S4.SS1.p1.1.m1.2.2.1"><ci id="S4.SS1.p1.1.m1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1">𝐜</ci><apply id="S4.SS1.p1.1.m1.2.2.1.1.cmml" xref="S4.SS1.p1.1.m1.2.2.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.1.m1.2.2.1.1.1.cmml" xref="S4.SS1.p1.1.m1.2.2.1.1">superscript</csymbol><ci id="S4.SS1.p1.1.m1.2.2.1.1.2.cmml" xref="S4.SS1.p1.1.m1.2.2.1.1.2">𝐱</ci><ci id="S4.SS1.p1.1.m1.2.2.1.1.3.cmml" xref="S4.SS1.p1.1.m1.2.2.1.1.3">𝑤</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.1.m1.2c">\mathbf{c},\mathbf{x}^{w}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.1.m1.2d">bold_c , bold_x start_POSTSUPERSCRIPT italic_w end_POSTSUPERSCRIPT</annotation></semantics></math>), we consider using previous checkpoints to construct preference pairs. Specifically, in our method, we use the reference model for the sampling distribution to ensure high-quality generation of reference samples <math alttext="\mathbf{x}^{\rm ref}" class="ltx_Math" display="inline" id="S4.SS1.p1.2.m2.1"><semantics id="S4.SS1.p1.2.m2.1a"><msup id="S4.SS1.p1.2.m2.1.1" xref="S4.SS1.p1.2.m2.1.1.cmml"><mi id="S4.SS1.p1.2.m2.1.1.2" xref="S4.SS1.p1.2.m2.1.1.2.cmml">𝐱</mi><mi id="S4.SS1.p1.2.m2.1.1.3" xref="S4.SS1.p1.2.m2.1.1.3.cmml">ref</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.2.m2.1b"><apply id="S4.SS1.p1.2.m2.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.2.m2.1.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1">superscript</csymbol><ci id="S4.SS1.p1.2.m2.1.1.2.cmml" xref="S4.SS1.p1.2.m2.1.1.2">𝐱</ci><ci id="S4.SS1.p1.2.m2.1.1.3.cmml" xref="S4.SS1.p1.2.m2.1.1.3">ref</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.2.m2.1c">\mathbf{x}^{\rm ref}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.2.m2.1d">bold_x start_POSTSUPERSCRIPT roman_ref end_POSTSUPERSCRIPT</annotation></semantics></math>. However, how to select an appropriate reference model remains a challenge.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS1.p2">
<p class="ltx_p" id="S4.SS1.p2.8">In RL, equation&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.05255v1#S3.E3" title="Equation 3 ‣ 3.2 Direct Preference Optimization ‣ 3 Background ‣ SePPO: Semi-Policy Preference Optimization for Diffusion Alignment"><span class="ltx_text ltx_ref_tag">3</span></a> is a surrogate loss <cite class="ltx_cite ltx_citemacro_citep">(Heess et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05255v1#bib.bib9" title="">2017</a>; Vieillard et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05255v1#bib.bib28" title="">2020</a>)</cite> of the hard KL-constrained target</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equationgroup ltx_eqn_table" id="S4.E5">
<tbody>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S4.E5X">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\max_{\pi_{\theta}}" class="ltx_Math" display="inline" id="S4.E5X.2.1.1.m1.1"><semantics id="S4.E5X.2.1.1.m1.1a"><munder id="S4.E5X.2.1.1.m1.1.1" xref="S4.E5X.2.1.1.m1.1.1.cmml"><mi id="S4.E5X.2.1.1.m1.1.1.2" xref="S4.E5X.2.1.1.m1.1.1.2.cmml">max</mi><msub id="S4.E5X.2.1.1.m1.1.1.3" xref="S4.E5X.2.1.1.m1.1.1.3.cmml"><mi id="S4.E5X.2.1.1.m1.1.1.3.2" xref="S4.E5X.2.1.1.m1.1.1.3.2.cmml">π</mi><mi id="S4.E5X.2.1.1.m1.1.1.3.3" xref="S4.E5X.2.1.1.m1.1.1.3.3.cmml">θ</mi></msub></munder><annotation-xml encoding="MathML-Content" id="S4.E5X.2.1.1.m1.1b"><apply id="S4.E5X.2.1.1.m1.1.1.cmml" xref="S4.E5X.2.1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.E5X.2.1.1.m1.1.1.1.cmml" xref="S4.E5X.2.1.1.m1.1.1">subscript</csymbol><max id="S4.E5X.2.1.1.m1.1.1.2.cmml" xref="S4.E5X.2.1.1.m1.1.1.2"></max><apply id="S4.E5X.2.1.1.m1.1.1.3.cmml" xref="S4.E5X.2.1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.E5X.2.1.1.m1.1.1.3.1.cmml" xref="S4.E5X.2.1.1.m1.1.1.3">subscript</csymbol><ci id="S4.E5X.2.1.1.m1.1.1.3.2.cmml" xref="S4.E5X.2.1.1.m1.1.1.3.2">𝜋</ci><ci id="S4.E5X.2.1.1.m1.1.1.3.3.cmml" xref="S4.E5X.2.1.1.m1.1.1.3.3">𝜃</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E5X.2.1.1.m1.1c">\displaystyle\max_{\pi_{\theta}}</annotation><annotation encoding="application/x-llamapun" id="S4.E5X.2.1.1.m1.1d">roman_max start_POSTSUBSCRIPT italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\mathop{\mathbb{E}}_{\mathbf{c}\sim\mathcal{D},\atop\mathbf{x}%
\sim\pi_{\theta}(\cdot|\mathbf{c})}\Big{[}r(\mathbf{x},\mathbf{c})\Big{]}," class="ltx_math_unparsed" display="inline" id="S4.E5X.3.2.2.m1.3"><semantics id="S4.E5X.3.2.2.m1.3a"><mrow id="S4.E5X.3.2.2.m1.3.3.1"><mrow id="S4.E5X.3.2.2.m1.3.3.1.1"><munder id="S4.E5X.3.2.2.m1.3.3.1.1.2"><mo id="S4.E5X.3.2.2.m1.3.3.1.1.2.2" movablelimits="false">𝔼</mo><mfrac id="S4.E5X.3.2.2.m1.3.3.1.1.2.3" linethickness="0pt"><mrow id="S4.E5X.3.2.2.m1.3.3.1.1.2.3.2"><mi id="S4.E5X.3.2.2.m1.3.3.1.1.2.3.2.1">𝐜</mi><mo id="S4.E5X.3.2.2.m1.3.3.1.1.2.3.2.2">∼</mo><mi class="ltx_font_mathcaligraphic" id="S4.E5X.3.2.2.m1.3.3.1.1.2.3.2.3">𝒟</mi><mo id="S4.E5X.3.2.2.m1.3.3.1.1.2.3.2.4">,</mo></mrow><mrow id="S4.E5X.3.2.2.m1.3.3.1.1.2.3.3"><mi id="S4.E5X.3.2.2.m1.3.3.1.1.2.3.3.1">𝐱</mi><mo id="S4.E5X.3.2.2.m1.3.3.1.1.2.3.3.2">∼</mo><msub id="S4.E5X.3.2.2.m1.3.3.1.1.2.3.3.3"><mi id="S4.E5X.3.2.2.m1.3.3.1.1.2.3.3.3.2">π</mi><mi id="S4.E5X.3.2.2.m1.3.3.1.1.2.3.3.3.3">θ</mi></msub><mrow id="S4.E5X.3.2.2.m1.3.3.1.1.2.3.3.4"><mo id="S4.E5X.3.2.2.m1.3.3.1.1.2.3.3.4.1" stretchy="false">(</mo><mo id="S4.E5X.3.2.2.m1.3.3.1.1.2.3.3.4.2" lspace="0em" rspace="0em">⋅</mo><mo fence="false" id="S4.E5X.3.2.2.m1.3.3.1.1.2.3.3.4.3" rspace="0.167em" stretchy="false">|</mo><mi id="S4.E5X.3.2.2.m1.3.3.1.1.2.3.3.4.4">𝐜</mi><mo id="S4.E5X.3.2.2.m1.3.3.1.1.2.3.3.4.5" stretchy="false">)</mo></mrow></mrow></mfrac></munder><mrow id="S4.E5X.3.2.2.m1.3.3.1.1.1.1"><mo id="S4.E5X.3.2.2.m1.3.3.1.1.1.1.2" lspace="0em" maxsize="160%" minsize="160%">[</mo><mrow id="S4.E5X.3.2.2.m1.3.3.1.1.1.1.1"><mi id="S4.E5X.3.2.2.m1.3.3.1.1.1.1.1.2">r</mi><mo id="S4.E5X.3.2.2.m1.3.3.1.1.1.1.1.1">⁢</mo><mrow id="S4.E5X.3.2.2.m1.3.3.1.1.1.1.1.3.2"><mo id="S4.E5X.3.2.2.m1.3.3.1.1.1.1.1.3.2.1" stretchy="false">(</mo><mi id="S4.E5X.3.2.2.m1.1.1">𝐱</mi><mo id="S4.E5X.3.2.2.m1.3.3.1.1.1.1.1.3.2.2">,</mo><mi id="S4.E5X.3.2.2.m1.2.2">𝐜</mi><mo id="S4.E5X.3.2.2.m1.3.3.1.1.1.1.1.3.2.3" stretchy="false">)</mo></mrow></mrow><mo id="S4.E5X.3.2.2.m1.3.3.1.1.1.1.3" maxsize="160%" minsize="160%">]</mo></mrow></mrow><mo id="S4.E5X.3.2.2.m1.3.3.1.2">,</mo></mrow><annotation encoding="application/x-tex" id="S4.E5X.3.2.2.m1.3b">\displaystyle\mathop{\mathbb{E}}_{\mathbf{c}\sim\mathcal{D},\atop\mathbf{x}%
\sim\pi_{\theta}(\cdot|\mathbf{c})}\Big{[}r(\mathbf{x},\mathbf{c})\Big{]},</annotation><annotation encoding="application/x-llamapun" id="S4.E5X.3.2.2.m1.3c">blackboard_E start_POSTSUBSCRIPT FRACOP start_ARG bold_c ∼ caligraphic_D , end_ARG start_ARG bold_x ∼ italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( ⋅ | bold_c ) end_ARG end_POSTSUBSCRIPT [ italic_r ( bold_x , bold_c ) ] ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="2"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(5)</span></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S4.E5Xa">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle{\rm s.t.}{}" class="ltx_Math" display="inline" id="S4.E5Xa.2.1.1.m1.3"><semantics id="S4.E5Xa.2.1.1.m1.3a"><mrow id="S4.E5Xa.2.1.1.m1.3.3.1"><mrow id="S4.E5Xa.2.1.1.m1.3.3.1.1.2" xref="S4.E5Xa.2.1.1.m1.3.3.1.1.1.cmml"><mi id="S4.E5Xa.2.1.1.m1.1.1" mathvariant="normal" xref="S4.E5Xa.2.1.1.m1.1.1.cmml">s</mi><mo id="S4.E5Xa.2.1.1.m1.3.3.1.1.2.1" lspace="0em" rspace="0.167em" xref="S4.E5Xa.2.1.1.m1.3.3.1.1.1a.cmml">.</mo><mi id="S4.E5Xa.2.1.1.m1.2.2" mathvariant="normal" xref="S4.E5Xa.2.1.1.m1.2.2.cmml">t</mi></mrow><mo id="S4.E5Xa.2.1.1.m1.3.3.1.2" lspace="0em">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E5Xa.2.1.1.m1.3b"><apply id="S4.E5Xa.2.1.1.m1.3.3.1.1.1.cmml" xref="S4.E5Xa.2.1.1.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="S4.E5Xa.2.1.1.m1.3.3.1.1.1a.cmml" xref="S4.E5Xa.2.1.1.m1.3.3.1.1.2.1">formulae-sequence</csymbol><ci id="S4.E5Xa.2.1.1.m1.1.1.cmml" xref="S4.E5Xa.2.1.1.m1.1.1">s</ci><ci id="S4.E5Xa.2.1.1.m1.2.2.cmml" xref="S4.E5Xa.2.1.1.m1.2.2">t</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E5Xa.2.1.1.m1.3c">\displaystyle{\rm s.t.}{}</annotation><annotation encoding="application/x-llamapun" id="S4.E5Xa.2.1.1.m1.3d">roman_s . roman_t .</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\mathop{\mathbb{E}}_{\mathbf{c}\sim\mathcal{D},\atop\mathbf{x}%
\sim\pi_{\theta}(\cdot|\mathbf{c})}\Big{[}D_{\rm KL}\big{(}\pi_{\theta}(%
\mathbf{x}|\mathbf{c})||\pi_{\rm ref}(\mathbf{x}|\mathbf{c})\big{)}\Big{]}\leq\delta," class="ltx_math_unparsed" display="inline" id="S4.E5Xa.3.2.2.m1.1"><semantics id="S4.E5Xa.3.2.2.m1.1a"><mrow id="S4.E5Xa.3.2.2.m1.1b"><munder id="S4.E5Xa.3.2.2.m1.1.1"><mo id="S4.E5Xa.3.2.2.m1.1.1.2" movablelimits="false">𝔼</mo><mfrac id="S4.E5Xa.3.2.2.m1.1.1.3" linethickness="0pt"><mrow id="S4.E5Xa.3.2.2.m1.1.1.3.2"><mi id="S4.E5Xa.3.2.2.m1.1.1.3.2.1">𝐜</mi><mo id="S4.E5Xa.3.2.2.m1.1.1.3.2.2">∼</mo><mi class="ltx_font_mathcaligraphic" id="S4.E5Xa.3.2.2.m1.1.1.3.2.3">𝒟</mi><mo id="S4.E5Xa.3.2.2.m1.1.1.3.2.4">,</mo></mrow><mrow id="S4.E5Xa.3.2.2.m1.1.1.3.3"><mi id="S4.E5Xa.3.2.2.m1.1.1.3.3.1">𝐱</mi><mo id="S4.E5Xa.3.2.2.m1.1.1.3.3.2">∼</mo><msub id="S4.E5Xa.3.2.2.m1.1.1.3.3.3"><mi id="S4.E5Xa.3.2.2.m1.1.1.3.3.3.2">π</mi><mi id="S4.E5Xa.3.2.2.m1.1.1.3.3.3.3">θ</mi></msub><mrow id="S4.E5Xa.3.2.2.m1.1.1.3.3.4"><mo id="S4.E5Xa.3.2.2.m1.1.1.3.3.4.1" stretchy="false">(</mo><mo id="S4.E5Xa.3.2.2.m1.1.1.3.3.4.2" lspace="0em" rspace="0em">⋅</mo><mo fence="false" id="S4.E5Xa.3.2.2.m1.1.1.3.3.4.3" rspace="0.167em" stretchy="false">|</mo><mi id="S4.E5Xa.3.2.2.m1.1.1.3.3.4.4">𝐜</mi><mo id="S4.E5Xa.3.2.2.m1.1.1.3.3.4.5" stretchy="false">)</mo></mrow></mrow></mfrac></munder><mrow id="S4.E5Xa.3.2.2.m1.1.2"><mo id="S4.E5Xa.3.2.2.m1.1.2.1" lspace="0em" maxsize="160%" minsize="160%">[</mo><msub id="S4.E5Xa.3.2.2.m1.1.2.2"><mi id="S4.E5Xa.3.2.2.m1.1.2.2.2">D</mi><mi id="S4.E5Xa.3.2.2.m1.1.2.2.3">KL</mi></msub><mrow id="S4.E5Xa.3.2.2.m1.1.2.3"><mo id="S4.E5Xa.3.2.2.m1.1.2.3.1" maxsize="120%" minsize="120%">(</mo><msub id="S4.E5Xa.3.2.2.m1.1.2.3.2"><mi id="S4.E5Xa.3.2.2.m1.1.2.3.2.2">π</mi><mi id="S4.E5Xa.3.2.2.m1.1.2.3.2.3">θ</mi></msub><mrow id="S4.E5Xa.3.2.2.m1.1.2.3.3"><mo id="S4.E5Xa.3.2.2.m1.1.2.3.3.1" stretchy="false">(</mo><mi id="S4.E5Xa.3.2.2.m1.1.2.3.3.2">𝐱</mi><mo fence="false" id="S4.E5Xa.3.2.2.m1.1.2.3.3.3" rspace="0.167em" stretchy="false">|</mo><mi id="S4.E5Xa.3.2.2.m1.1.2.3.3.4">𝐜</mi><mo id="S4.E5Xa.3.2.2.m1.1.2.3.3.5" stretchy="false">)</mo></mrow><mo fence="false" id="S4.E5Xa.3.2.2.m1.1.2.3.4" rspace="0.167em" stretchy="false">|</mo><mo fence="false" id="S4.E5Xa.3.2.2.m1.1.2.3.5" rspace="0.167em" stretchy="false">|</mo><msub id="S4.E5Xa.3.2.2.m1.1.2.3.6"><mi id="S4.E5Xa.3.2.2.m1.1.2.3.6.2">π</mi><mi id="S4.E5Xa.3.2.2.m1.1.2.3.6.3">ref</mi></msub><mrow id="S4.E5Xa.3.2.2.m1.1.2.3.7"><mo id="S4.E5Xa.3.2.2.m1.1.2.3.7.1" stretchy="false">(</mo><mi id="S4.E5Xa.3.2.2.m1.1.2.3.7.2">𝐱</mi><mo fence="false" id="S4.E5Xa.3.2.2.m1.1.2.3.7.3" rspace="0.167em" stretchy="false">|</mo><mi id="S4.E5Xa.3.2.2.m1.1.2.3.7.4">𝐜</mi><mo id="S4.E5Xa.3.2.2.m1.1.2.3.7.5" stretchy="false">)</mo></mrow><mo id="S4.E5Xa.3.2.2.m1.1.2.3.8" maxsize="120%" minsize="120%">)</mo></mrow><mo id="S4.E5Xa.3.2.2.m1.1.2.4" maxsize="160%" minsize="160%">]</mo></mrow><mo id="S4.E5Xa.3.2.2.m1.1.3">≤</mo><mi id="S4.E5Xa.3.2.2.m1.1.4">δ</mi><mo id="S4.E5Xa.3.2.2.m1.1.5">,</mo></mrow><annotation encoding="application/x-tex" id="S4.E5Xa.3.2.2.m1.1c">\displaystyle\mathop{\mathbb{E}}_{\mathbf{c}\sim\mathcal{D},\atop\mathbf{x}%
\sim\pi_{\theta}(\cdot|\mathbf{c})}\Big{[}D_{\rm KL}\big{(}\pi_{\theta}(%
\mathbf{x}|\mathbf{c})||\pi_{\rm ref}(\mathbf{x}|\mathbf{c})\big{)}\Big{]}\leq\delta,</annotation><annotation encoding="application/x-llamapun" id="S4.E5Xa.3.2.2.m1.1d">blackboard_E start_POSTSUBSCRIPT FRACOP start_ARG bold_c ∼ caligraphic_D , end_ARG start_ARG bold_x ∼ italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( ⋅ | bold_c ) end_ARG end_POSTSUBSCRIPT [ italic_D start_POSTSUBSCRIPT roman_KL end_POSTSUBSCRIPT ( italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( bold_x | bold_c ) | | italic_π start_POSTSUBSCRIPT roman_ref end_POSTSUBSCRIPT ( bold_x | bold_c ) ) ] ≤ italic_δ ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
<p class="ltx_p" id="S4.SS1.p2.7">where the training path in the policy space (a family of parametric functions) can be visualized in a ball with radius <math alttext="\delta" class="ltx_Math" display="inline" id="S4.SS1.p2.1.m1.1"><semantics id="S4.SS1.p2.1.m1.1a"><mi id="S4.SS1.p2.1.m1.1.1" xref="S4.SS1.p2.1.m1.1.1.cmml">δ</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.1.m1.1b"><ci id="S4.SS1.p2.1.m1.1.1.cmml" xref="S4.SS1.p2.1.m1.1.1">𝛿</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.1.m1.1c">\delta</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.1.m1.1d">italic_δ</annotation></semantics></math> as shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.05255v1#S3.F1" title="Figure 1 ‣ 3.2 Direct Preference Optimization ‣ 3 Background ‣ SePPO: Semi-Policy Preference Optimization for Diffusion Alignment"><span class="ltx_text ltx_ref_tag">1</span></a>. <math alttext="\delta" class="ltx_Math" display="inline" id="S4.SS1.p2.2.m2.1"><semantics id="S4.SS1.p2.2.m2.1a"><mi id="S4.SS1.p2.2.m2.1.1" xref="S4.SS1.p2.2.m2.1.1.cmml">δ</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.2.m2.1b"><ci id="S4.SS1.p2.2.m2.1.1.cmml" xref="S4.SS1.p2.2.m2.1.1">𝛿</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.2.m2.1c">\delta</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.2.m2.1d">italic_δ</annotation></semantics></math> as a hard constraint radius is roughly proportional to <math alttext="1/\beta" class="ltx_Math" display="inline" id="S4.SS1.p2.3.m3.1"><semantics id="S4.SS1.p2.3.m3.1a"><mrow id="S4.SS1.p2.3.m3.1.1" xref="S4.SS1.p2.3.m3.1.1.cmml"><mn id="S4.SS1.p2.3.m3.1.1.2" xref="S4.SS1.p2.3.m3.1.1.2.cmml">1</mn><mo id="S4.SS1.p2.3.m3.1.1.1" xref="S4.SS1.p2.3.m3.1.1.1.cmml">/</mo><mi id="S4.SS1.p2.3.m3.1.1.3" xref="S4.SS1.p2.3.m3.1.1.3.cmml">β</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.3.m3.1b"><apply id="S4.SS1.p2.3.m3.1.1.cmml" xref="S4.SS1.p2.3.m3.1.1"><divide id="S4.SS1.p2.3.m3.1.1.1.cmml" xref="S4.SS1.p2.3.m3.1.1.1"></divide><cn id="S4.SS1.p2.3.m3.1.1.2.cmml" type="integer" xref="S4.SS1.p2.3.m3.1.1.2">1</cn><ci id="S4.SS1.p2.3.m3.1.1.3.cmml" xref="S4.SS1.p2.3.m3.1.1.3">𝛽</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.3.m3.1c">1/\beta</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.3.m3.1d">1 / italic_β</annotation></semantics></math>. Assume that we save <math alttext="K" class="ltx_Math" display="inline" id="S4.SS1.p2.4.m4.1"><semantics id="S4.SS1.p2.4.m4.1a"><mi id="S4.SS1.p2.4.m4.1.1" xref="S4.SS1.p2.4.m4.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.4.m4.1b"><ci id="S4.SS1.p2.4.m4.1.1.cmml" xref="S4.SS1.p2.4.m4.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.4.m4.1c">K</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.4.m4.1d">italic_K</annotation></semantics></math> checkpoints in total during the training process. In the conventional DPO setting, the reference model is fixed to the initial checkpoint (<math alttext="{\rm ref}=0" class="ltx_Math" display="inline" id="S4.SS1.p2.5.m5.1"><semantics id="S4.SS1.p2.5.m5.1a"><mrow id="S4.SS1.p2.5.m5.1.1" xref="S4.SS1.p2.5.m5.1.1.cmml"><mi id="S4.SS1.p2.5.m5.1.1.2" xref="S4.SS1.p2.5.m5.1.1.2.cmml">ref</mi><mo id="S4.SS1.p2.5.m5.1.1.1" xref="S4.SS1.p2.5.m5.1.1.1.cmml">=</mo><mn id="S4.SS1.p2.5.m5.1.1.3" xref="S4.SS1.p2.5.m5.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.5.m5.1b"><apply id="S4.SS1.p2.5.m5.1.1.cmml" xref="S4.SS1.p2.5.m5.1.1"><eq id="S4.SS1.p2.5.m5.1.1.1.cmml" xref="S4.SS1.p2.5.m5.1.1.1"></eq><ci id="S4.SS1.p2.5.m5.1.1.2.cmml" xref="S4.SS1.p2.5.m5.1.1.2">ref</ci><cn id="S4.SS1.p2.5.m5.1.1.3.cmml" type="integer" xref="S4.SS1.p2.5.m5.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.5.m5.1c">{\rm ref}=0</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.5.m5.1d">roman_ref = 0</annotation></semantics></math>). However, this setting may have a limited and fixed exploration area controlled by the hyperparameter <math alttext="\beta" class="ltx_Math" display="inline" id="S4.SS1.p2.6.m6.1"><semantics id="S4.SS1.p2.6.m6.1a"><mi id="S4.SS1.p2.6.m6.1.1" xref="S4.SS1.p2.6.m6.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.6.m6.1b"><ci id="S4.SS1.p2.6.m6.1.1.cmml" xref="S4.SS1.p2.6.m6.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.6.m6.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.6.m6.1d">italic_β</annotation></semantics></math>. To better study the problem, in the <math alttext="k" class="ltx_Math" display="inline" id="S4.SS1.p2.7.m7.1"><semantics id="S4.SS1.p2.7.m7.1a"><mi id="S4.SS1.p2.7.m7.1.1" xref="S4.SS1.p2.7.m7.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.7.m7.1b"><ci id="S4.SS1.p2.7.m7.1.1.cmml" xref="S4.SS1.p2.7.m7.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.7.m7.1c">k</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.7.m7.1d">italic_k</annotation></semantics></math>-th iteration, we design and test three sampling strategies for the reference model as follows:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<ul class="ltx_itemize" id="S4.I1">
<li class="ltx_item" id="S4.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I1.i1.p1">
<p class="ltx_p" id="S4.I1.i1.p1.1">The reference model is sampled from the initial model, and is denoted as <math alttext="{\rm ref}=0" class="ltx_Math" display="inline" id="S4.I1.i1.p1.1.m1.1"><semantics id="S4.I1.i1.p1.1.m1.1a"><mrow id="S4.I1.i1.p1.1.m1.1.1" xref="S4.I1.i1.p1.1.m1.1.1.cmml"><mi id="S4.I1.i1.p1.1.m1.1.1.2" xref="S4.I1.i1.p1.1.m1.1.1.2.cmml">ref</mi><mo id="S4.I1.i1.p1.1.m1.1.1.1" xref="S4.I1.i1.p1.1.m1.1.1.1.cmml">=</mo><mn id="S4.I1.i1.p1.1.m1.1.1.3" xref="S4.I1.i1.p1.1.m1.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.I1.i1.p1.1.m1.1b"><apply id="S4.I1.i1.p1.1.m1.1.1.cmml" xref="S4.I1.i1.p1.1.m1.1.1"><eq id="S4.I1.i1.p1.1.m1.1.1.1.cmml" xref="S4.I1.i1.p1.1.m1.1.1.1"></eq><ci id="S4.I1.i1.p1.1.m1.1.1.2.cmml" xref="S4.I1.i1.p1.1.m1.1.1.2">ref</ci><cn id="S4.I1.i1.p1.1.m1.1.1.3.cmml" type="integer" xref="S4.I1.i1.p1.1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i1.p1.1.m1.1c">{\rm ref}=0</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i1.p1.1.m1.1d">roman_ref = 0</annotation></semantics></math>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="S4.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I1.i2.p1">
<p class="ltx_p" id="S4.I1.i2.p1.1">The reference model is sampled from the checkpoint saved in the last iteration, and is denoted as <math alttext="{\rm ref}=k-1" class="ltx_Math" display="inline" id="S4.I1.i2.p1.1.m1.1"><semantics id="S4.I1.i2.p1.1.m1.1a"><mrow id="S4.I1.i2.p1.1.m1.1.1" xref="S4.I1.i2.p1.1.m1.1.1.cmml"><mi id="S4.I1.i2.p1.1.m1.1.1.2" xref="S4.I1.i2.p1.1.m1.1.1.2.cmml">ref</mi><mo id="S4.I1.i2.p1.1.m1.1.1.1" xref="S4.I1.i2.p1.1.m1.1.1.1.cmml">=</mo><mrow id="S4.I1.i2.p1.1.m1.1.1.3" xref="S4.I1.i2.p1.1.m1.1.1.3.cmml"><mi id="S4.I1.i2.p1.1.m1.1.1.3.2" xref="S4.I1.i2.p1.1.m1.1.1.3.2.cmml">k</mi><mo id="S4.I1.i2.p1.1.m1.1.1.3.1" xref="S4.I1.i2.p1.1.m1.1.1.3.1.cmml">−</mo><mn id="S4.I1.i2.p1.1.m1.1.1.3.3" xref="S4.I1.i2.p1.1.m1.1.1.3.3.cmml">1</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.I1.i2.p1.1.m1.1b"><apply id="S4.I1.i2.p1.1.m1.1.1.cmml" xref="S4.I1.i2.p1.1.m1.1.1"><eq id="S4.I1.i2.p1.1.m1.1.1.1.cmml" xref="S4.I1.i2.p1.1.m1.1.1.1"></eq><ci id="S4.I1.i2.p1.1.m1.1.1.2.cmml" xref="S4.I1.i2.p1.1.m1.1.1.2">ref</ci><apply id="S4.I1.i2.p1.1.m1.1.1.3.cmml" xref="S4.I1.i2.p1.1.m1.1.1.3"><minus id="S4.I1.i2.p1.1.m1.1.1.3.1.cmml" xref="S4.I1.i2.p1.1.m1.1.1.3.1"></minus><ci id="S4.I1.i2.p1.1.m1.1.1.3.2.cmml" xref="S4.I1.i2.p1.1.m1.1.1.3.2">𝑘</ci><cn id="S4.I1.i2.p1.1.m1.1.1.3.3.cmml" type="integer" xref="S4.I1.i2.p1.1.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i2.p1.1.m1.1c">{\rm ref}=k-1</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i2.p1.1.m1.1d">roman_ref = italic_k - 1</annotation></semantics></math>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="S4.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para ltx_noindent" id="S4.I1.i3.p1">
<p class="ltx_p" id="S4.I1.i3.p1.1">The reference model is randomly sampled from all previously saved checkpoints, and is denoted as <math alttext="{\rm ref}=[0,k-1]" class="ltx_Math" display="inline" id="S4.I1.i3.p1.1.m1.2"><semantics id="S4.I1.i3.p1.1.m1.2a"><mrow id="S4.I1.i3.p1.1.m1.2.2" xref="S4.I1.i3.p1.1.m1.2.2.cmml"><mi id="S4.I1.i3.p1.1.m1.2.2.3" xref="S4.I1.i3.p1.1.m1.2.2.3.cmml">ref</mi><mo id="S4.I1.i3.p1.1.m1.2.2.2" xref="S4.I1.i3.p1.1.m1.2.2.2.cmml">=</mo><mrow id="S4.I1.i3.p1.1.m1.2.2.1.1" xref="S4.I1.i3.p1.1.m1.2.2.1.2.cmml"><mo id="S4.I1.i3.p1.1.m1.2.2.1.1.2" stretchy="false" xref="S4.I1.i3.p1.1.m1.2.2.1.2.cmml">[</mo><mn id="S4.I1.i3.p1.1.m1.1.1" xref="S4.I1.i3.p1.1.m1.1.1.cmml">0</mn><mo id="S4.I1.i3.p1.1.m1.2.2.1.1.3" xref="S4.I1.i3.p1.1.m1.2.2.1.2.cmml">,</mo><mrow id="S4.I1.i3.p1.1.m1.2.2.1.1.1" xref="S4.I1.i3.p1.1.m1.2.2.1.1.1.cmml"><mi id="S4.I1.i3.p1.1.m1.2.2.1.1.1.2" xref="S4.I1.i3.p1.1.m1.2.2.1.1.1.2.cmml">k</mi><mo id="S4.I1.i3.p1.1.m1.2.2.1.1.1.1" xref="S4.I1.i3.p1.1.m1.2.2.1.1.1.1.cmml">−</mo><mn id="S4.I1.i3.p1.1.m1.2.2.1.1.1.3" xref="S4.I1.i3.p1.1.m1.2.2.1.1.1.3.cmml">1</mn></mrow><mo id="S4.I1.i3.p1.1.m1.2.2.1.1.4" stretchy="false" xref="S4.I1.i3.p1.1.m1.2.2.1.2.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.I1.i3.p1.1.m1.2b"><apply id="S4.I1.i3.p1.1.m1.2.2.cmml" xref="S4.I1.i3.p1.1.m1.2.2"><eq id="S4.I1.i3.p1.1.m1.2.2.2.cmml" xref="S4.I1.i3.p1.1.m1.2.2.2"></eq><ci id="S4.I1.i3.p1.1.m1.2.2.3.cmml" xref="S4.I1.i3.p1.1.m1.2.2.3">ref</ci><interval closure="closed" id="S4.I1.i3.p1.1.m1.2.2.1.2.cmml" xref="S4.I1.i3.p1.1.m1.2.2.1.1"><cn id="S4.I1.i3.p1.1.m1.1.1.cmml" type="integer" xref="S4.I1.i3.p1.1.m1.1.1">0</cn><apply id="S4.I1.i3.p1.1.m1.2.2.1.1.1.cmml" xref="S4.I1.i3.p1.1.m1.2.2.1.1.1"><minus id="S4.I1.i3.p1.1.m1.2.2.1.1.1.1.cmml" xref="S4.I1.i3.p1.1.m1.2.2.1.1.1.1"></minus><ci id="S4.I1.i3.p1.1.m1.2.2.1.1.1.2.cmml" xref="S4.I1.i3.p1.1.m1.2.2.1.1.1.2">𝑘</ci><cn id="S4.I1.i3.p1.1.m1.2.2.1.1.1.3.cmml" type="integer" xref="S4.I1.i3.p1.1.m1.2.2.1.1.1.3">1</cn></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i3.p1.1.m1.2c">{\rm ref}=[0,k-1]</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i3.p1.1.m1.2d">roman_ref = [ 0 , italic_k - 1 ]</annotation></semantics></math>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
</ul>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS1.p3">
<p class="ltx_p" id="S4.SS1.p3.1">The training algorithm is given in Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2410.05255v1#alg1" title="Algorithm 1 ‣ 4.1 Iterative Alignment from Semi-policy Preference Optimization ‣ 4 Iterative Alignment for Diffusion Models ‣ SePPO: Semi-Policy Preference Optimization for Diffusion Alignment"><span class="ltx_text ltx_ref_tag">1</span></a>. We omit <math alttext="\mathbf{c}" class="ltx_Math" display="inline" id="S4.SS1.p3.1.m1.1"><semantics id="S4.SS1.p3.1.m1.1a"><mi id="S4.SS1.p3.1.m1.1.1" xref="S4.SS1.p3.1.m1.1.1.cmml">𝐜</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.1.m1.1b"><ci id="S4.SS1.p3.1.m1.1.1.cmml" xref="S4.SS1.p3.1.m1.1.1">𝐜</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.1.m1.1c">\mathbf{c}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.1.m1.1d">bold_c</annotation></semantics></math> for the sake of concision. In each iteration, the loss function adapted from diffusion DPO is as follows</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equationgroup ltx_eqn_table" id="S4.E6">
<tbody>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S4.E6X">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathcal{L}(\theta;\mathbf{x}_{0}^{w},\mathbf{x}_{0}^{\rm ref})~{%
}=~{}\mathop{\mathbb{E}}_{\epsilon^{w},\epsilon^{\rm ref},t}\Big{[}-\log{%
\sigma}\Big{(}-\beta Tw_{t}(" class="ltx_math_unparsed" display="inline" id="S4.E6X.2.1.1.m1.4"><semantics id="S4.E6X.2.1.1.m1.4a"><mrow id="S4.E6X.2.1.1.m1.4b"><mi class="ltx_font_mathcaligraphic" id="S4.E6X.2.1.1.m1.4.5">ℒ</mi><mrow id="S4.E6X.2.1.1.m1.4.6"><mo id="S4.E6X.2.1.1.m1.4.6.1" stretchy="false">(</mo><mi id="S4.E6X.2.1.1.m1.4.4">θ</mi><mo id="S4.E6X.2.1.1.m1.4.6.2">;</mo><msubsup id="S4.E6X.2.1.1.m1.4.6.3"><mi id="S4.E6X.2.1.1.m1.4.6.3.2.2">𝐱</mi><mn id="S4.E6X.2.1.1.m1.4.6.3.2.3">0</mn><mi id="S4.E6X.2.1.1.m1.4.6.3.3">w</mi></msubsup><mo id="S4.E6X.2.1.1.m1.4.6.4">,</mo><msubsup id="S4.E6X.2.1.1.m1.4.6.5"><mi id="S4.E6X.2.1.1.m1.4.6.5.2.2">𝐱</mi><mn id="S4.E6X.2.1.1.m1.4.6.5.2.3">0</mn><mi id="S4.E6X.2.1.1.m1.4.6.5.3">ref</mi></msubsup><mo id="S4.E6X.2.1.1.m1.4.6.6" rspace="0.330em" stretchy="false">)</mo></mrow><mo id="S4.E6X.2.1.1.m1.4.7" rspace="0.330em">=</mo><munder id="S4.E6X.2.1.1.m1.4.8"><mo id="S4.E6X.2.1.1.m1.4.8.2" movablelimits="false" rspace="0em">𝔼</mo><mrow id="S4.E6X.2.1.1.m1.3.3.3.3"><msup id="S4.E6X.2.1.1.m1.2.2.2.2.1"><mi id="S4.E6X.2.1.1.m1.2.2.2.2.1.2">ϵ</mi><mi id="S4.E6X.2.1.1.m1.2.2.2.2.1.3">w</mi></msup><mo id="S4.E6X.2.1.1.m1.3.3.3.3.3">,</mo><msup id="S4.E6X.2.1.1.m1.3.3.3.3.2"><mi id="S4.E6X.2.1.1.m1.3.3.3.3.2.2">ϵ</mi><mi id="S4.E6X.2.1.1.m1.3.3.3.3.2.3">ref</mi></msup><mo id="S4.E6X.2.1.1.m1.3.3.3.3.4">,</mo><mi id="S4.E6X.2.1.1.m1.1.1.1.1">t</mi></mrow></munder><mrow id="S4.E6X.2.1.1.m1.4.9"><mo id="S4.E6X.2.1.1.m1.4.9.1" maxsize="160%" minsize="160%">[</mo><mo id="S4.E6X.2.1.1.m1.4.9.2" lspace="0em">−</mo><mi id="S4.E6X.2.1.1.m1.4.9.3">log</mi><mi id="S4.E6X.2.1.1.m1.4.9.4">σ</mi><mrow id="S4.E6X.2.1.1.m1.4.9.5"><mo id="S4.E6X.2.1.1.m1.4.9.5.1" maxsize="160%" minsize="160%">(</mo><mo id="S4.E6X.2.1.1.m1.4.9.5.2" lspace="0em">−</mo><mi id="S4.E6X.2.1.1.m1.4.9.5.3">β</mi><mi id="S4.E6X.2.1.1.m1.4.9.5.4">T</mi><msub id="S4.E6X.2.1.1.m1.4.9.5.5"><mi id="S4.E6X.2.1.1.m1.4.9.5.5.2">w</mi><mi id="S4.E6X.2.1.1.m1.4.9.5.5.3">t</mi></msub><mo id="S4.E6X.2.1.1.m1.4.9.5.6" stretchy="false">(</mo></mrow></mrow></mrow><annotation encoding="application/x-tex" id="S4.E6X.2.1.1.m1.4c">\displaystyle\mathcal{L}(\theta;\mathbf{x}_{0}^{w},\mathbf{x}_{0}^{\rm ref})~{%
}=~{}\mathop{\mathbb{E}}_{\epsilon^{w},\epsilon^{\rm ref},t}\Big{[}-\log{%
\sigma}\Big{(}-\beta Tw_{t}(</annotation><annotation encoding="application/x-llamapun" id="S4.E6X.2.1.1.m1.4d">caligraphic_L ( italic_θ ; bold_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_w end_POSTSUPERSCRIPT , bold_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT roman_ref end_POSTSUPERSCRIPT ) = blackboard_E start_POSTSUBSCRIPT italic_ϵ start_POSTSUPERSCRIPT italic_w end_POSTSUPERSCRIPT , italic_ϵ start_POSTSUPERSCRIPT roman_ref end_POSTSUPERSCRIPT , italic_t end_POSTSUBSCRIPT [ - roman_log italic_σ ( - italic_β italic_T italic_w start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT (</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\|\epsilon_{\theta}(\mathbf{x}_{t}^{w})-\mathbf{\epsilon}^{w}\|^{%
2}-\|\epsilon_{\rm ref}(\mathbf{x}_{t}^{w})-\mathbf{\epsilon}^{w}\|^{2}" class="ltx_Math" display="inline" id="S4.E6X.3.2.2.m1.2"><semantics id="S4.E6X.3.2.2.m1.2a"><mrow id="S4.E6X.3.2.2.m1.2.2" xref="S4.E6X.3.2.2.m1.2.2.cmml"><msup id="S4.E6X.3.2.2.m1.1.1.1" xref="S4.E6X.3.2.2.m1.1.1.1.cmml"><mrow id="S4.E6X.3.2.2.m1.1.1.1.1.1" xref="S4.E6X.3.2.2.m1.1.1.1.1.2.cmml"><mo id="S4.E6X.3.2.2.m1.1.1.1.1.1.2" stretchy="false" xref="S4.E6X.3.2.2.m1.1.1.1.1.2.1.cmml">‖</mo><mrow id="S4.E6X.3.2.2.m1.1.1.1.1.1.1" xref="S4.E6X.3.2.2.m1.1.1.1.1.1.1.cmml"><mrow id="S4.E6X.3.2.2.m1.1.1.1.1.1.1.1" xref="S4.E6X.3.2.2.m1.1.1.1.1.1.1.1.cmml"><msub id="S4.E6X.3.2.2.m1.1.1.1.1.1.1.1.3" xref="S4.E6X.3.2.2.m1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E6X.3.2.2.m1.1.1.1.1.1.1.1.3.2" xref="S4.E6X.3.2.2.m1.1.1.1.1.1.1.1.3.2.cmml">ϵ</mi><mi id="S4.E6X.3.2.2.m1.1.1.1.1.1.1.1.3.3" xref="S4.E6X.3.2.2.m1.1.1.1.1.1.1.1.3.3.cmml">θ</mi></msub><mo id="S4.E6X.3.2.2.m1.1.1.1.1.1.1.1.2" xref="S4.E6X.3.2.2.m1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E6X.3.2.2.m1.1.1.1.1.1.1.1.1.1" xref="S4.E6X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.E6X.3.2.2.m1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.E6X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="S4.E6X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1" xref="S4.E6X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E6X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S4.E6X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">𝐱</mi><mi id="S4.E6X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S4.E6X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">t</mi><mi id="S4.E6X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E6X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.3.cmml">w</mi></msubsup><mo id="S4.E6X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.E6X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E6X.3.2.2.m1.1.1.1.1.1.1.2" xref="S4.E6X.3.2.2.m1.1.1.1.1.1.1.2.cmml">−</mo><msup id="S4.E6X.3.2.2.m1.1.1.1.1.1.1.3" xref="S4.E6X.3.2.2.m1.1.1.1.1.1.1.3.cmml"><mi id="S4.E6X.3.2.2.m1.1.1.1.1.1.1.3.2" xref="S4.E6X.3.2.2.m1.1.1.1.1.1.1.3.2.cmml">ϵ</mi><mi id="S4.E6X.3.2.2.m1.1.1.1.1.1.1.3.3" xref="S4.E6X.3.2.2.m1.1.1.1.1.1.1.3.3.cmml">w</mi></msup></mrow><mo id="S4.E6X.3.2.2.m1.1.1.1.1.1.3" stretchy="false" xref="S4.E6X.3.2.2.m1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S4.E6X.3.2.2.m1.1.1.1.3" xref="S4.E6X.3.2.2.m1.1.1.1.3.cmml">2</mn></msup><mo id="S4.E6X.3.2.2.m1.2.2.3" xref="S4.E6X.3.2.2.m1.2.2.3.cmml">−</mo><msup id="S4.E6X.3.2.2.m1.2.2.2" xref="S4.E6X.3.2.2.m1.2.2.2.cmml"><mrow id="S4.E6X.3.2.2.m1.2.2.2.1.1" xref="S4.E6X.3.2.2.m1.2.2.2.1.2.cmml"><mo id="S4.E6X.3.2.2.m1.2.2.2.1.1.2" stretchy="false" xref="S4.E6X.3.2.2.m1.2.2.2.1.2.1.cmml">‖</mo><mrow id="S4.E6X.3.2.2.m1.2.2.2.1.1.1" xref="S4.E6X.3.2.2.m1.2.2.2.1.1.1.cmml"><mrow id="S4.E6X.3.2.2.m1.2.2.2.1.1.1.1" xref="S4.E6X.3.2.2.m1.2.2.2.1.1.1.1.cmml"><msub id="S4.E6X.3.2.2.m1.2.2.2.1.1.1.1.3" xref="S4.E6X.3.2.2.m1.2.2.2.1.1.1.1.3.cmml"><mi id="S4.E6X.3.2.2.m1.2.2.2.1.1.1.1.3.2" xref="S4.E6X.3.2.2.m1.2.2.2.1.1.1.1.3.2.cmml">ϵ</mi><mi id="S4.E6X.3.2.2.m1.2.2.2.1.1.1.1.3.3" xref="S4.E6X.3.2.2.m1.2.2.2.1.1.1.1.3.3.cmml">ref</mi></msub><mo id="S4.E6X.3.2.2.m1.2.2.2.1.1.1.1.2" xref="S4.E6X.3.2.2.m1.2.2.2.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E6X.3.2.2.m1.2.2.2.1.1.1.1.1.1" xref="S4.E6X.3.2.2.m1.2.2.2.1.1.1.1.1.1.1.cmml"><mo id="S4.E6X.3.2.2.m1.2.2.2.1.1.1.1.1.1.2" stretchy="false" xref="S4.E6X.3.2.2.m1.2.2.2.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="S4.E6X.3.2.2.m1.2.2.2.1.1.1.1.1.1.1" xref="S4.E6X.3.2.2.m1.2.2.2.1.1.1.1.1.1.1.cmml"><mi id="S4.E6X.3.2.2.m1.2.2.2.1.1.1.1.1.1.1.2.2" xref="S4.E6X.3.2.2.m1.2.2.2.1.1.1.1.1.1.1.2.2.cmml">𝐱</mi><mi id="S4.E6X.3.2.2.m1.2.2.2.1.1.1.1.1.1.1.2.3" xref="S4.E6X.3.2.2.m1.2.2.2.1.1.1.1.1.1.1.2.3.cmml">t</mi><mi id="S4.E6X.3.2.2.m1.2.2.2.1.1.1.1.1.1.1.3" xref="S4.E6X.3.2.2.m1.2.2.2.1.1.1.1.1.1.1.3.cmml">w</mi></msubsup><mo id="S4.E6X.3.2.2.m1.2.2.2.1.1.1.1.1.1.3" stretchy="false" xref="S4.E6X.3.2.2.m1.2.2.2.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E6X.3.2.2.m1.2.2.2.1.1.1.2" xref="S4.E6X.3.2.2.m1.2.2.2.1.1.1.2.cmml">−</mo><msup id="S4.E6X.3.2.2.m1.2.2.2.1.1.1.3" xref="S4.E6X.3.2.2.m1.2.2.2.1.1.1.3.cmml"><mi id="S4.E6X.3.2.2.m1.2.2.2.1.1.1.3.2" xref="S4.E6X.3.2.2.m1.2.2.2.1.1.1.3.2.cmml">ϵ</mi><mi id="S4.E6X.3.2.2.m1.2.2.2.1.1.1.3.3" xref="S4.E6X.3.2.2.m1.2.2.2.1.1.1.3.3.cmml">w</mi></msup></mrow><mo id="S4.E6X.3.2.2.m1.2.2.2.1.1.3" stretchy="false" xref="S4.E6X.3.2.2.m1.2.2.2.1.2.1.cmml">‖</mo></mrow><mn id="S4.E6X.3.2.2.m1.2.2.2.3" xref="S4.E6X.3.2.2.m1.2.2.2.3.cmml">2</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.E6X.3.2.2.m1.2b"><apply id="S4.E6X.3.2.2.m1.2.2.cmml" xref="S4.E6X.3.2.2.m1.2.2"><minus id="S4.E6X.3.2.2.m1.2.2.3.cmml" xref="S4.E6X.3.2.2.m1.2.2.3"></minus><apply id="S4.E6X.3.2.2.m1.1.1.1.cmml" xref="S4.E6X.3.2.2.m1.1.1.1"><csymbol cd="ambiguous" id="S4.E6X.3.2.2.m1.1.1.1.2.cmml" xref="S4.E6X.3.2.2.m1.1.1.1">superscript</csymbol><apply id="S4.E6X.3.2.2.m1.1.1.1.1.2.cmml" xref="S4.E6X.3.2.2.m1.1.1.1.1.1"><csymbol cd="latexml" id="S4.E6X.3.2.2.m1.1.1.1.1.2.1.cmml" xref="S4.E6X.3.2.2.m1.1.1.1.1.1.2">norm</csymbol><apply id="S4.E6X.3.2.2.m1.1.1.1.1.1.1.cmml" xref="S4.E6X.3.2.2.m1.1.1.1.1.1.1"><minus id="S4.E6X.3.2.2.m1.1.1.1.1.1.1.2.cmml" xref="S4.E6X.3.2.2.m1.1.1.1.1.1.1.2"></minus><apply id="S4.E6X.3.2.2.m1.1.1.1.1.1.1.1.cmml" xref="S4.E6X.3.2.2.m1.1.1.1.1.1.1.1"><times id="S4.E6X.3.2.2.m1.1.1.1.1.1.1.1.2.cmml" xref="S4.E6X.3.2.2.m1.1.1.1.1.1.1.1.2"></times><apply id="S4.E6X.3.2.2.m1.1.1.1.1.1.1.1.3.cmml" xref="S4.E6X.3.2.2.m1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E6X.3.2.2.m1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E6X.3.2.2.m1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E6X.3.2.2.m1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E6X.3.2.2.m1.1.1.1.1.1.1.1.3.2">italic-ϵ</ci><ci id="S4.E6X.3.2.2.m1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E6X.3.2.2.m1.1.1.1.1.1.1.1.3.3">𝜃</ci></apply><apply id="S4.E6X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E6X.3.2.2.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E6X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E6X.3.2.2.m1.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S4.E6X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E6X.3.2.2.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E6X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E6X.3.2.2.m1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E6X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E6X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.2.2">𝐱</ci><ci id="S4.E6X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E6X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.2.3">𝑡</ci></apply><ci id="S4.E6X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E6X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.3">𝑤</ci></apply></apply><apply id="S4.E6X.3.2.2.m1.1.1.1.1.1.1.3.cmml" xref="S4.E6X.3.2.2.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E6X.3.2.2.m1.1.1.1.1.1.1.3.1.cmml" xref="S4.E6X.3.2.2.m1.1.1.1.1.1.1.3">superscript</csymbol><ci id="S4.E6X.3.2.2.m1.1.1.1.1.1.1.3.2.cmml" xref="S4.E6X.3.2.2.m1.1.1.1.1.1.1.3.2">italic-ϵ</ci><ci id="S4.E6X.3.2.2.m1.1.1.1.1.1.1.3.3.cmml" xref="S4.E6X.3.2.2.m1.1.1.1.1.1.1.3.3">𝑤</ci></apply></apply></apply><cn id="S4.E6X.3.2.2.m1.1.1.1.3.cmml" type="integer" xref="S4.E6X.3.2.2.m1.1.1.1.3">2</cn></apply><apply id="S4.E6X.3.2.2.m1.2.2.2.cmml" xref="S4.E6X.3.2.2.m1.2.2.2"><csymbol cd="ambiguous" id="S4.E6X.3.2.2.m1.2.2.2.2.cmml" xref="S4.E6X.3.2.2.m1.2.2.2">superscript</csymbol><apply id="S4.E6X.3.2.2.m1.2.2.2.1.2.cmml" xref="S4.E6X.3.2.2.m1.2.2.2.1.1"><csymbol cd="latexml" id="S4.E6X.3.2.2.m1.2.2.2.1.2.1.cmml" xref="S4.E6X.3.2.2.m1.2.2.2.1.1.2">norm</csymbol><apply id="S4.E6X.3.2.2.m1.2.2.2.1.1.1.cmml" xref="S4.E6X.3.2.2.m1.2.2.2.1.1.1"><minus id="S4.E6X.3.2.2.m1.2.2.2.1.1.1.2.cmml" xref="S4.E6X.3.2.2.m1.2.2.2.1.1.1.2"></minus><apply id="S4.E6X.3.2.2.m1.2.2.2.1.1.1.1.cmml" xref="S4.E6X.3.2.2.m1.2.2.2.1.1.1.1"><times id="S4.E6X.3.2.2.m1.2.2.2.1.1.1.1.2.cmml" xref="S4.E6X.3.2.2.m1.2.2.2.1.1.1.1.2"></times><apply id="S4.E6X.3.2.2.m1.2.2.2.1.1.1.1.3.cmml" xref="S4.E6X.3.2.2.m1.2.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E6X.3.2.2.m1.2.2.2.1.1.1.1.3.1.cmml" xref="S4.E6X.3.2.2.m1.2.2.2.1.1.1.1.3">subscript</csymbol><ci id="S4.E6X.3.2.2.m1.2.2.2.1.1.1.1.3.2.cmml" xref="S4.E6X.3.2.2.m1.2.2.2.1.1.1.1.3.2">italic-ϵ</ci><ci id="S4.E6X.3.2.2.m1.2.2.2.1.1.1.1.3.3.cmml" xref="S4.E6X.3.2.2.m1.2.2.2.1.1.1.1.3.3">ref</ci></apply><apply id="S4.E6X.3.2.2.m1.2.2.2.1.1.1.1.1.1.1.cmml" xref="S4.E6X.3.2.2.m1.2.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E6X.3.2.2.m1.2.2.2.1.1.1.1.1.1.1.1.cmml" xref="S4.E6X.3.2.2.m1.2.2.2.1.1.1.1.1.1">superscript</csymbol><apply id="S4.E6X.3.2.2.m1.2.2.2.1.1.1.1.1.1.1.2.cmml" xref="S4.E6X.3.2.2.m1.2.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E6X.3.2.2.m1.2.2.2.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E6X.3.2.2.m1.2.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E6X.3.2.2.m1.2.2.2.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E6X.3.2.2.m1.2.2.2.1.1.1.1.1.1.1.2.2">𝐱</ci><ci id="S4.E6X.3.2.2.m1.2.2.2.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E6X.3.2.2.m1.2.2.2.1.1.1.1.1.1.1.2.3">𝑡</ci></apply><ci id="S4.E6X.3.2.2.m1.2.2.2.1.1.1.1.1.1.1.3.cmml" xref="S4.E6X.3.2.2.m1.2.2.2.1.1.1.1.1.1.1.3">𝑤</ci></apply></apply><apply id="S4.E6X.3.2.2.m1.2.2.2.1.1.1.3.cmml" xref="S4.E6X.3.2.2.m1.2.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S4.E6X.3.2.2.m1.2.2.2.1.1.1.3.1.cmml" xref="S4.E6X.3.2.2.m1.2.2.2.1.1.1.3">superscript</csymbol><ci id="S4.E6X.3.2.2.m1.2.2.2.1.1.1.3.2.cmml" xref="S4.E6X.3.2.2.m1.2.2.2.1.1.1.3.2">italic-ϵ</ci><ci id="S4.E6X.3.2.2.m1.2.2.2.1.1.1.3.3.cmml" xref="S4.E6X.3.2.2.m1.2.2.2.1.1.1.3.3">𝑤</ci></apply></apply></apply><cn id="S4.E6X.3.2.2.m1.2.2.2.3.cmml" type="integer" xref="S4.E6X.3.2.2.m1.2.2.2.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E6X.3.2.2.m1.2c">\displaystyle\|\epsilon_{\theta}(\mathbf{x}_{t}^{w})-\mathbf{\epsilon}^{w}\|^{%
2}-\|\epsilon_{\rm ref}(\mathbf{x}_{t}^{w})-\mathbf{\epsilon}^{w}\|^{2}</annotation><annotation encoding="application/x-llamapun" id="S4.E6X.3.2.2.m1.2d">∥ italic_ϵ start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( bold_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_w end_POSTSUPERSCRIPT ) - italic_ϵ start_POSTSUPERSCRIPT italic_w end_POSTSUPERSCRIPT ∥ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT - ∥ italic_ϵ start_POSTSUBSCRIPT roman_ref end_POSTSUBSCRIPT ( bold_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_w end_POSTSUPERSCRIPT ) - italic_ϵ start_POSTSUPERSCRIPT italic_w end_POSTSUPERSCRIPT ∥ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="2"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(6)</span></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S4.E6Xa">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle-\|\epsilon_{\theta}(\mathbf{x}_{t}^{\rm ref})-\mathbf{\epsilon}^%
{\rm ref}\|^{2}+\|\epsilon_{\rm ref}(\mathbf{x}_{t}^{\rm ref})-\mathbf{%
\epsilon}^{\rm ref}\|^{2})\Big{)}\Big{]}," class="ltx_math_unparsed" display="inline" id="S4.E6Xa.2.1.1.m1.1"><semantics id="S4.E6Xa.2.1.1.m1.1a"><mrow id="S4.E6Xa.2.1.1.m1.1b"><mrow id="S4.E6Xa.2.1.1.m1.1.1"><mrow id="S4.E6Xa.2.1.1.m1.1.1.1"><mo id="S4.E6Xa.2.1.1.m1.1.1.1.1" rspace="0em">−</mo><mo id="S4.E6Xa.2.1.1.m1.1.1.1.2" lspace="0em" rspace="0.167em">∥</mo><msub id="S4.E6Xa.2.1.1.m1.1.1.1.3"><mi id="S4.E6Xa.2.1.1.m1.1.1.1.3.2">ϵ</mi><mi id="S4.E6Xa.2.1.1.m1.1.1.1.3.3">θ</mi></msub><mrow id="S4.E6Xa.2.1.1.m1.1.1.1.4"><mo id="S4.E6Xa.2.1.1.m1.1.1.1.4.1" stretchy="false">(</mo><msubsup id="S4.E6Xa.2.1.1.m1.1.1.1.4.2"><mi id="S4.E6Xa.2.1.1.m1.1.1.1.4.2.2.2">𝐱</mi><mi id="S4.E6Xa.2.1.1.m1.1.1.1.4.2.2.3">t</mi><mi id="S4.E6Xa.2.1.1.m1.1.1.1.4.2.3">ref</mi></msubsup><mo id="S4.E6Xa.2.1.1.m1.1.1.1.4.3" stretchy="false">)</mo></mrow><mo id="S4.E6Xa.2.1.1.m1.1.1.1.5">−</mo><msup id="S4.E6Xa.2.1.1.m1.1.1.1.6"><mi id="S4.E6Xa.2.1.1.m1.1.1.1.6.2">ϵ</mi><mi id="S4.E6Xa.2.1.1.m1.1.1.1.6.3">ref</mi></msup><msup id="S4.E6Xa.2.1.1.m1.1.1.1.7"><mo id="S4.E6Xa.2.1.1.m1.1.1.1.7.2" lspace="0em" rspace="0em">∥</mo><mn id="S4.E6Xa.2.1.1.m1.1.1.1.7.3">2</mn></msup><mo id="S4.E6Xa.2.1.1.m1.1.1.1.8" lspace="0em" rspace="0em">+</mo><mo id="S4.E6Xa.2.1.1.m1.1.1.1.9" lspace="0em" rspace="0.167em">∥</mo><msub id="S4.E6Xa.2.1.1.m1.1.1.1.10"><mi id="S4.E6Xa.2.1.1.m1.1.1.1.10.2">ϵ</mi><mi id="S4.E6Xa.2.1.1.m1.1.1.1.10.3">ref</mi></msub><mrow id="S4.E6Xa.2.1.1.m1.1.1.1.11"><mo id="S4.E6Xa.2.1.1.m1.1.1.1.11.1" stretchy="false">(</mo><msubsup id="S4.E6Xa.2.1.1.m1.1.1.1.11.2"><mi id="S4.E6Xa.2.1.1.m1.1.1.1.11.2.2.2">𝐱</mi><mi id="S4.E6Xa.2.1.1.m1.1.1.1.11.2.2.3">t</mi><mi id="S4.E6Xa.2.1.1.m1.1.1.1.11.2.3">ref</mi></msubsup><mo id="S4.E6Xa.2.1.1.m1.1.1.1.11.3" stretchy="false">)</mo></mrow><mo id="S4.E6Xa.2.1.1.m1.1.1.1.12">−</mo><msup id="S4.E6Xa.2.1.1.m1.1.1.1.13"><mi id="S4.E6Xa.2.1.1.m1.1.1.1.13.2">ϵ</mi><mi id="S4.E6Xa.2.1.1.m1.1.1.1.13.3">ref</mi></msup><msup id="S4.E6Xa.2.1.1.m1.1.1.1.14"><mo id="S4.E6Xa.2.1.1.m1.1.1.1.14.2" lspace="0em" rspace="0.167em">∥</mo><mn id="S4.E6Xa.2.1.1.m1.1.1.1.14.3">2</mn></msup><mo id="S4.E6Xa.2.1.1.m1.1.1.1.15" stretchy="false">)</mo></mrow><mo id="S4.E6Xa.2.1.1.m1.1.1.2" maxsize="160%" minsize="160%">)</mo></mrow><mo id="S4.E6Xa.2.1.1.m1.1.2" maxsize="160%" minsize="160%">]</mo><mo id="S4.E6Xa.2.1.1.m1.1.3">,</mo></mrow><annotation encoding="application/x-tex" id="S4.E6Xa.2.1.1.m1.1c">\displaystyle-\|\epsilon_{\theta}(\mathbf{x}_{t}^{\rm ref})-\mathbf{\epsilon}^%
{\rm ref}\|^{2}+\|\epsilon_{\rm ref}(\mathbf{x}_{t}^{\rm ref})-\mathbf{%
\epsilon}^{\rm ref}\|^{2})\Big{)}\Big{]},</annotation><annotation encoding="application/x-llamapun" id="S4.E6Xa.2.1.1.m1.1d">- ∥ italic_ϵ start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( bold_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT roman_ref end_POSTSUPERSCRIPT ) - italic_ϵ start_POSTSUPERSCRIPT roman_ref end_POSTSUPERSCRIPT ∥ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + ∥ italic_ϵ start_POSTSUBSCRIPT roman_ref end_POSTSUBSCRIPT ( bold_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT roman_ref end_POSTSUPERSCRIPT ) - italic_ϵ start_POSTSUPERSCRIPT roman_ref end_POSTSUPERSCRIPT ∥ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ) ) ] ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
<p class="ltx_p" id="S4.SS1.p3.6">where <math alttext="t\sim\mathcal{U}(1,T)" class="ltx_Math" display="inline" id="S4.SS1.p3.2.m1.2"><semantics id="S4.SS1.p3.2.m1.2a"><mrow id="S4.SS1.p3.2.m1.2.3" xref="S4.SS1.p3.2.m1.2.3.cmml"><mi id="S4.SS1.p3.2.m1.2.3.2" xref="S4.SS1.p3.2.m1.2.3.2.cmml">t</mi><mo id="S4.SS1.p3.2.m1.2.3.1" xref="S4.SS1.p3.2.m1.2.3.1.cmml">∼</mo><mrow id="S4.SS1.p3.2.m1.2.3.3" xref="S4.SS1.p3.2.m1.2.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p3.2.m1.2.3.3.2" xref="S4.SS1.p3.2.m1.2.3.3.2.cmml">𝒰</mi><mo id="S4.SS1.p3.2.m1.2.3.3.1" xref="S4.SS1.p3.2.m1.2.3.3.1.cmml">⁢</mo><mrow id="S4.SS1.p3.2.m1.2.3.3.3.2" xref="S4.SS1.p3.2.m1.2.3.3.3.1.cmml"><mo id="S4.SS1.p3.2.m1.2.3.3.3.2.1" stretchy="false" xref="S4.SS1.p3.2.m1.2.3.3.3.1.cmml">(</mo><mn id="S4.SS1.p3.2.m1.1.1" xref="S4.SS1.p3.2.m1.1.1.cmml">1</mn><mo id="S4.SS1.p3.2.m1.2.3.3.3.2.2" xref="S4.SS1.p3.2.m1.2.3.3.3.1.cmml">,</mo><mi id="S4.SS1.p3.2.m1.2.2" xref="S4.SS1.p3.2.m1.2.2.cmml">T</mi><mo id="S4.SS1.p3.2.m1.2.3.3.3.2.3" stretchy="false" xref="S4.SS1.p3.2.m1.2.3.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.2.m1.2b"><apply id="S4.SS1.p3.2.m1.2.3.cmml" xref="S4.SS1.p3.2.m1.2.3"><csymbol cd="latexml" id="S4.SS1.p3.2.m1.2.3.1.cmml" xref="S4.SS1.p3.2.m1.2.3.1">similar-to</csymbol><ci id="S4.SS1.p3.2.m1.2.3.2.cmml" xref="S4.SS1.p3.2.m1.2.3.2">𝑡</ci><apply id="S4.SS1.p3.2.m1.2.3.3.cmml" xref="S4.SS1.p3.2.m1.2.3.3"><times id="S4.SS1.p3.2.m1.2.3.3.1.cmml" xref="S4.SS1.p3.2.m1.2.3.3.1"></times><ci id="S4.SS1.p3.2.m1.2.3.3.2.cmml" xref="S4.SS1.p3.2.m1.2.3.3.2">𝒰</ci><interval closure="open" id="S4.SS1.p3.2.m1.2.3.3.3.1.cmml" xref="S4.SS1.p3.2.m1.2.3.3.3.2"><cn id="S4.SS1.p3.2.m1.1.1.cmml" type="integer" xref="S4.SS1.p3.2.m1.1.1">1</cn><ci id="S4.SS1.p3.2.m1.2.2.cmml" xref="S4.SS1.p3.2.m1.2.2">𝑇</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.2.m1.2c">t\sim\mathcal{U}(1,T)</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.2.m1.2d">italic_t ∼ caligraphic_U ( 1 , italic_T )</annotation></semantics></math>, <math alttext="\epsilon^{w},\epsilon^{\rm ref}\stackrel{{\scriptstyle\rm iid}}{{\sim}}%
\mathcal{N}(0,\mathbf{I})" class="ltx_Math" display="inline" id="S4.SS1.p3.3.m2.4"><semantics id="S4.SS1.p3.3.m2.4a"><mrow id="S4.SS1.p3.3.m2.4.4" xref="S4.SS1.p3.3.m2.4.4.cmml"><mrow id="S4.SS1.p3.3.m2.4.4.2.2" xref="S4.SS1.p3.3.m2.4.4.2.3.cmml"><msup id="S4.SS1.p3.3.m2.3.3.1.1.1" xref="S4.SS1.p3.3.m2.3.3.1.1.1.cmml"><mi id="S4.SS1.p3.3.m2.3.3.1.1.1.2" xref="S4.SS1.p3.3.m2.3.3.1.1.1.2.cmml">ϵ</mi><mi id="S4.SS1.p3.3.m2.3.3.1.1.1.3" xref="S4.SS1.p3.3.m2.3.3.1.1.1.3.cmml">w</mi></msup><mo id="S4.SS1.p3.3.m2.4.4.2.2.3" xref="S4.SS1.p3.3.m2.4.4.2.3.cmml">,</mo><msup id="S4.SS1.p3.3.m2.4.4.2.2.2" xref="S4.SS1.p3.3.m2.4.4.2.2.2.cmml"><mi id="S4.SS1.p3.3.m2.4.4.2.2.2.2" xref="S4.SS1.p3.3.m2.4.4.2.2.2.2.cmml">ϵ</mi><mi id="S4.SS1.p3.3.m2.4.4.2.2.2.3" xref="S4.SS1.p3.3.m2.4.4.2.2.2.3.cmml">ref</mi></msup></mrow><mover id="S4.SS1.p3.3.m2.4.4.3" xref="S4.SS1.p3.3.m2.4.4.3.cmml"><mo id="S4.SS1.p3.3.m2.4.4.3.2" xref="S4.SS1.p3.3.m2.4.4.3.2.cmml">∼</mo><mi id="S4.SS1.p3.3.m2.4.4.3.3" xref="S4.SS1.p3.3.m2.4.4.3.3.cmml">iid</mi></mover><mrow id="S4.SS1.p3.3.m2.4.4.4" xref="S4.SS1.p3.3.m2.4.4.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p3.3.m2.4.4.4.2" xref="S4.SS1.p3.3.m2.4.4.4.2.cmml">𝒩</mi><mo id="S4.SS1.p3.3.m2.4.4.4.1" xref="S4.SS1.p3.3.m2.4.4.4.1.cmml">⁢</mo><mrow id="S4.SS1.p3.3.m2.4.4.4.3.2" xref="S4.SS1.p3.3.m2.4.4.4.3.1.cmml"><mo id="S4.SS1.p3.3.m2.4.4.4.3.2.1" stretchy="false" xref="S4.SS1.p3.3.m2.4.4.4.3.1.cmml">(</mo><mn id="S4.SS1.p3.3.m2.1.1" xref="S4.SS1.p3.3.m2.1.1.cmml">0</mn><mo id="S4.SS1.p3.3.m2.4.4.4.3.2.2" xref="S4.SS1.p3.3.m2.4.4.4.3.1.cmml">,</mo><mi id="S4.SS1.p3.3.m2.2.2" xref="S4.SS1.p3.3.m2.2.2.cmml">𝐈</mi><mo id="S4.SS1.p3.3.m2.4.4.4.3.2.3" stretchy="false" xref="S4.SS1.p3.3.m2.4.4.4.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.3.m2.4b"><apply id="S4.SS1.p3.3.m2.4.4.cmml" xref="S4.SS1.p3.3.m2.4.4"><apply id="S4.SS1.p3.3.m2.4.4.3.cmml" xref="S4.SS1.p3.3.m2.4.4.3"><csymbol cd="ambiguous" id="S4.SS1.p3.3.m2.4.4.3.1.cmml" xref="S4.SS1.p3.3.m2.4.4.3">superscript</csymbol><csymbol cd="latexml" id="S4.SS1.p3.3.m2.4.4.3.2.cmml" xref="S4.SS1.p3.3.m2.4.4.3.2">similar-to</csymbol><ci id="S4.SS1.p3.3.m2.4.4.3.3.cmml" xref="S4.SS1.p3.3.m2.4.4.3.3">iid</ci></apply><list id="S4.SS1.p3.3.m2.4.4.2.3.cmml" xref="S4.SS1.p3.3.m2.4.4.2.2"><apply id="S4.SS1.p3.3.m2.3.3.1.1.1.cmml" xref="S4.SS1.p3.3.m2.3.3.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.3.m2.3.3.1.1.1.1.cmml" xref="S4.SS1.p3.3.m2.3.3.1.1.1">superscript</csymbol><ci id="S4.SS1.p3.3.m2.3.3.1.1.1.2.cmml" xref="S4.SS1.p3.3.m2.3.3.1.1.1.2">italic-ϵ</ci><ci id="S4.SS1.p3.3.m2.3.3.1.1.1.3.cmml" xref="S4.SS1.p3.3.m2.3.3.1.1.1.3">𝑤</ci></apply><apply id="S4.SS1.p3.3.m2.4.4.2.2.2.cmml" xref="S4.SS1.p3.3.m2.4.4.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.p3.3.m2.4.4.2.2.2.1.cmml" xref="S4.SS1.p3.3.m2.4.4.2.2.2">superscript</csymbol><ci id="S4.SS1.p3.3.m2.4.4.2.2.2.2.cmml" xref="S4.SS1.p3.3.m2.4.4.2.2.2.2">italic-ϵ</ci><ci id="S4.SS1.p3.3.m2.4.4.2.2.2.3.cmml" xref="S4.SS1.p3.3.m2.4.4.2.2.2.3">ref</ci></apply></list><apply id="S4.SS1.p3.3.m2.4.4.4.cmml" xref="S4.SS1.p3.3.m2.4.4.4"><times id="S4.SS1.p3.3.m2.4.4.4.1.cmml" xref="S4.SS1.p3.3.m2.4.4.4.1"></times><ci id="S4.SS1.p3.3.m2.4.4.4.2.cmml" xref="S4.SS1.p3.3.m2.4.4.4.2">𝒩</ci><interval closure="open" id="S4.SS1.p3.3.m2.4.4.4.3.1.cmml" xref="S4.SS1.p3.3.m2.4.4.4.3.2"><cn id="S4.SS1.p3.3.m2.1.1.cmml" type="integer" xref="S4.SS1.p3.3.m2.1.1">0</cn><ci id="S4.SS1.p3.3.m2.2.2.cmml" xref="S4.SS1.p3.3.m2.2.2">𝐈</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.3.m2.4c">\epsilon^{w},\epsilon^{\rm ref}\stackrel{{\scriptstyle\rm iid}}{{\sim}}%
\mathcal{N}(0,\mathbf{I})</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.3.m2.4d">italic_ϵ start_POSTSUPERSCRIPT italic_w end_POSTSUPERSCRIPT , italic_ϵ start_POSTSUPERSCRIPT roman_ref end_POSTSUPERSCRIPT start_RELOP SUPERSCRIPTOP start_ARG ∼ end_ARG start_ARG roman_iid end_ARG end_RELOP caligraphic_N ( 0 , bold_I )</annotation></semantics></math>, and <math alttext="\mathbf{x}_{t}^{w,{\rm ref}}=\sqrt{\alpha^{t}}\mathbf{x}_{0}^{w,{\rm ref}}+%
\sqrt{1-\alpha^{t}}\epsilon^{w,{\rm ref}}" class="ltx_Math" display="inline" id="S4.SS1.p3.4.m3.6"><semantics id="S4.SS1.p3.4.m3.6a"><mrow id="S4.SS1.p3.4.m3.6.7" xref="S4.SS1.p3.4.m3.6.7.cmml"><msubsup id="S4.SS1.p3.4.m3.6.7.2" xref="S4.SS1.p3.4.m3.6.7.2.cmml"><mi id="S4.SS1.p3.4.m3.6.7.2.2.2" xref="S4.SS1.p3.4.m3.6.7.2.2.2.cmml">𝐱</mi><mi id="S4.SS1.p3.4.m3.6.7.2.2.3" xref="S4.SS1.p3.4.m3.6.7.2.2.3.cmml">t</mi><mrow id="S4.SS1.p3.4.m3.2.2.2.4" xref="S4.SS1.p3.4.m3.2.2.2.3.cmml"><mi id="S4.SS1.p3.4.m3.1.1.1.1" xref="S4.SS1.p3.4.m3.1.1.1.1.cmml">w</mi><mo id="S4.SS1.p3.4.m3.2.2.2.4.1" xref="S4.SS1.p3.4.m3.2.2.2.3.cmml">,</mo><mi id="S4.SS1.p3.4.m3.2.2.2.2" xref="S4.SS1.p3.4.m3.2.2.2.2.cmml">ref</mi></mrow></msubsup><mo id="S4.SS1.p3.4.m3.6.7.1" xref="S4.SS1.p3.4.m3.6.7.1.cmml">=</mo><mrow id="S4.SS1.p3.4.m3.6.7.3" xref="S4.SS1.p3.4.m3.6.7.3.cmml"><mrow id="S4.SS1.p3.4.m3.6.7.3.2" xref="S4.SS1.p3.4.m3.6.7.3.2.cmml"><msqrt id="S4.SS1.p3.4.m3.6.7.3.2.2" xref="S4.SS1.p3.4.m3.6.7.3.2.2.cmml"><msup id="S4.SS1.p3.4.m3.6.7.3.2.2.2" xref="S4.SS1.p3.4.m3.6.7.3.2.2.2.cmml"><mi id="S4.SS1.p3.4.m3.6.7.3.2.2.2.2" xref="S4.SS1.p3.4.m3.6.7.3.2.2.2.2.cmml">α</mi><mi id="S4.SS1.p3.4.m3.6.7.3.2.2.2.3" xref="S4.SS1.p3.4.m3.6.7.3.2.2.2.3.cmml">t</mi></msup></msqrt><mo id="S4.SS1.p3.4.m3.6.7.3.2.1" xref="S4.SS1.p3.4.m3.6.7.3.2.1.cmml">⁢</mo><msubsup id="S4.SS1.p3.4.m3.6.7.3.2.3" xref="S4.SS1.p3.4.m3.6.7.3.2.3.cmml"><mi id="S4.SS1.p3.4.m3.6.7.3.2.3.2.2" xref="S4.SS1.p3.4.m3.6.7.3.2.3.2.2.cmml">𝐱</mi><mn id="S4.SS1.p3.4.m3.6.7.3.2.3.2.3" xref="S4.SS1.p3.4.m3.6.7.3.2.3.2.3.cmml">0</mn><mrow id="S4.SS1.p3.4.m3.4.4.2.4" xref="S4.SS1.p3.4.m3.4.4.2.3.cmml"><mi id="S4.SS1.p3.4.m3.3.3.1.1" xref="S4.SS1.p3.4.m3.3.3.1.1.cmml">w</mi><mo id="S4.SS1.p3.4.m3.4.4.2.4.1" xref="S4.SS1.p3.4.m3.4.4.2.3.cmml">,</mo><mi id="S4.SS1.p3.4.m3.4.4.2.2" xref="S4.SS1.p3.4.m3.4.4.2.2.cmml">ref</mi></mrow></msubsup></mrow><mo id="S4.SS1.p3.4.m3.6.7.3.1" xref="S4.SS1.p3.4.m3.6.7.3.1.cmml">+</mo><mrow id="S4.SS1.p3.4.m3.6.7.3.3" xref="S4.SS1.p3.4.m3.6.7.3.3.cmml"><msqrt id="S4.SS1.p3.4.m3.6.7.3.3.2" xref="S4.SS1.p3.4.m3.6.7.3.3.2.cmml"><mrow id="S4.SS1.p3.4.m3.6.7.3.3.2.2" xref="S4.SS1.p3.4.m3.6.7.3.3.2.2.cmml"><mn id="S4.SS1.p3.4.m3.6.7.3.3.2.2.2" xref="S4.SS1.p3.4.m3.6.7.3.3.2.2.2.cmml">1</mn><mo id="S4.SS1.p3.4.m3.6.7.3.3.2.2.1" xref="S4.SS1.p3.4.m3.6.7.3.3.2.2.1.cmml">−</mo><msup id="S4.SS1.p3.4.m3.6.7.3.3.2.2.3" xref="S4.SS1.p3.4.m3.6.7.3.3.2.2.3.cmml"><mi id="S4.SS1.p3.4.m3.6.7.3.3.2.2.3.2" xref="S4.SS1.p3.4.m3.6.7.3.3.2.2.3.2.cmml">α</mi><mi id="S4.SS1.p3.4.m3.6.7.3.3.2.2.3.3" xref="S4.SS1.p3.4.m3.6.7.3.3.2.2.3.3.cmml">t</mi></msup></mrow></msqrt><mo id="S4.SS1.p3.4.m3.6.7.3.3.1" xref="S4.SS1.p3.4.m3.6.7.3.3.1.cmml">⁢</mo><msup id="S4.SS1.p3.4.m3.6.7.3.3.3" xref="S4.SS1.p3.4.m3.6.7.3.3.3.cmml"><mi id="S4.SS1.p3.4.m3.6.7.3.3.3.2" xref="S4.SS1.p3.4.m3.6.7.3.3.3.2.cmml">ϵ</mi><mrow id="S4.SS1.p3.4.m3.6.6.2.4" xref="S4.SS1.p3.4.m3.6.6.2.3.cmml"><mi id="S4.SS1.p3.4.m3.5.5.1.1" xref="S4.SS1.p3.4.m3.5.5.1.1.cmml">w</mi><mo id="S4.SS1.p3.4.m3.6.6.2.4.1" xref="S4.SS1.p3.4.m3.6.6.2.3.cmml">,</mo><mi id="S4.SS1.p3.4.m3.6.6.2.2" xref="S4.SS1.p3.4.m3.6.6.2.2.cmml">ref</mi></mrow></msup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.4.m3.6b"><apply id="S4.SS1.p3.4.m3.6.7.cmml" xref="S4.SS1.p3.4.m3.6.7"><eq id="S4.SS1.p3.4.m3.6.7.1.cmml" xref="S4.SS1.p3.4.m3.6.7.1"></eq><apply id="S4.SS1.p3.4.m3.6.7.2.cmml" xref="S4.SS1.p3.4.m3.6.7.2"><csymbol cd="ambiguous" id="S4.SS1.p3.4.m3.6.7.2.1.cmml" xref="S4.SS1.p3.4.m3.6.7.2">superscript</csymbol><apply id="S4.SS1.p3.4.m3.6.7.2.2.cmml" xref="S4.SS1.p3.4.m3.6.7.2"><csymbol cd="ambiguous" id="S4.SS1.p3.4.m3.6.7.2.2.1.cmml" xref="S4.SS1.p3.4.m3.6.7.2">subscript</csymbol><ci id="S4.SS1.p3.4.m3.6.7.2.2.2.cmml" xref="S4.SS1.p3.4.m3.6.7.2.2.2">𝐱</ci><ci id="S4.SS1.p3.4.m3.6.7.2.2.3.cmml" xref="S4.SS1.p3.4.m3.6.7.2.2.3">𝑡</ci></apply><list id="S4.SS1.p3.4.m3.2.2.2.3.cmml" xref="S4.SS1.p3.4.m3.2.2.2.4"><ci id="S4.SS1.p3.4.m3.1.1.1.1.cmml" xref="S4.SS1.p3.4.m3.1.1.1.1">𝑤</ci><ci id="S4.SS1.p3.4.m3.2.2.2.2.cmml" xref="S4.SS1.p3.4.m3.2.2.2.2">ref</ci></list></apply><apply id="S4.SS1.p3.4.m3.6.7.3.cmml" xref="S4.SS1.p3.4.m3.6.7.3"><plus id="S4.SS1.p3.4.m3.6.7.3.1.cmml" xref="S4.SS1.p3.4.m3.6.7.3.1"></plus><apply id="S4.SS1.p3.4.m3.6.7.3.2.cmml" xref="S4.SS1.p3.4.m3.6.7.3.2"><times id="S4.SS1.p3.4.m3.6.7.3.2.1.cmml" xref="S4.SS1.p3.4.m3.6.7.3.2.1"></times><apply id="S4.SS1.p3.4.m3.6.7.3.2.2.cmml" xref="S4.SS1.p3.4.m3.6.7.3.2.2"><root id="S4.SS1.p3.4.m3.6.7.3.2.2a.cmml" xref="S4.SS1.p3.4.m3.6.7.3.2.2"></root><apply id="S4.SS1.p3.4.m3.6.7.3.2.2.2.cmml" xref="S4.SS1.p3.4.m3.6.7.3.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.p3.4.m3.6.7.3.2.2.2.1.cmml" xref="S4.SS1.p3.4.m3.6.7.3.2.2.2">superscript</csymbol><ci id="S4.SS1.p3.4.m3.6.7.3.2.2.2.2.cmml" xref="S4.SS1.p3.4.m3.6.7.3.2.2.2.2">𝛼</ci><ci id="S4.SS1.p3.4.m3.6.7.3.2.2.2.3.cmml" xref="S4.SS1.p3.4.m3.6.7.3.2.2.2.3">𝑡</ci></apply></apply><apply id="S4.SS1.p3.4.m3.6.7.3.2.3.cmml" xref="S4.SS1.p3.4.m3.6.7.3.2.3"><csymbol cd="ambiguous" id="S4.SS1.p3.4.m3.6.7.3.2.3.1.cmml" xref="S4.SS1.p3.4.m3.6.7.3.2.3">superscript</csymbol><apply id="S4.SS1.p3.4.m3.6.7.3.2.3.2.cmml" xref="S4.SS1.p3.4.m3.6.7.3.2.3"><csymbol cd="ambiguous" id="S4.SS1.p3.4.m3.6.7.3.2.3.2.1.cmml" xref="S4.SS1.p3.4.m3.6.7.3.2.3">subscript</csymbol><ci id="S4.SS1.p3.4.m3.6.7.3.2.3.2.2.cmml" xref="S4.SS1.p3.4.m3.6.7.3.2.3.2.2">𝐱</ci><cn id="S4.SS1.p3.4.m3.6.7.3.2.3.2.3.cmml" type="integer" xref="S4.SS1.p3.4.m3.6.7.3.2.3.2.3">0</cn></apply><list id="S4.SS1.p3.4.m3.4.4.2.3.cmml" xref="S4.SS1.p3.4.m3.4.4.2.4"><ci id="S4.SS1.p3.4.m3.3.3.1.1.cmml" xref="S4.SS1.p3.4.m3.3.3.1.1">𝑤</ci><ci id="S4.SS1.p3.4.m3.4.4.2.2.cmml" xref="S4.SS1.p3.4.m3.4.4.2.2">ref</ci></list></apply></apply><apply id="S4.SS1.p3.4.m3.6.7.3.3.cmml" xref="S4.SS1.p3.4.m3.6.7.3.3"><times id="S4.SS1.p3.4.m3.6.7.3.3.1.cmml" xref="S4.SS1.p3.4.m3.6.7.3.3.1"></times><apply id="S4.SS1.p3.4.m3.6.7.3.3.2.cmml" xref="S4.SS1.p3.4.m3.6.7.3.3.2"><root id="S4.SS1.p3.4.m3.6.7.3.3.2a.cmml" xref="S4.SS1.p3.4.m3.6.7.3.3.2"></root><apply id="S4.SS1.p3.4.m3.6.7.3.3.2.2.cmml" xref="S4.SS1.p3.4.m3.6.7.3.3.2.2"><minus id="S4.SS1.p3.4.m3.6.7.3.3.2.2.1.cmml" xref="S4.SS1.p3.4.m3.6.7.3.3.2.2.1"></minus><cn id="S4.SS1.p3.4.m3.6.7.3.3.2.2.2.cmml" type="integer" xref="S4.SS1.p3.4.m3.6.7.3.3.2.2.2">1</cn><apply id="S4.SS1.p3.4.m3.6.7.3.3.2.2.3.cmml" xref="S4.SS1.p3.4.m3.6.7.3.3.2.2.3"><csymbol cd="ambiguous" id="S4.SS1.p3.4.m3.6.7.3.3.2.2.3.1.cmml" xref="S4.SS1.p3.4.m3.6.7.3.3.2.2.3">superscript</csymbol><ci id="S4.SS1.p3.4.m3.6.7.3.3.2.2.3.2.cmml" xref="S4.SS1.p3.4.m3.6.7.3.3.2.2.3.2">𝛼</ci><ci id="S4.SS1.p3.4.m3.6.7.3.3.2.2.3.3.cmml" xref="S4.SS1.p3.4.m3.6.7.3.3.2.2.3.3">𝑡</ci></apply></apply></apply><apply id="S4.SS1.p3.4.m3.6.7.3.3.3.cmml" xref="S4.SS1.p3.4.m3.6.7.3.3.3"><csymbol cd="ambiguous" id="S4.SS1.p3.4.m3.6.7.3.3.3.1.cmml" xref="S4.SS1.p3.4.m3.6.7.3.3.3">superscript</csymbol><ci id="S4.SS1.p3.4.m3.6.7.3.3.3.2.cmml" xref="S4.SS1.p3.4.m3.6.7.3.3.3.2">italic-ϵ</ci><list id="S4.SS1.p3.4.m3.6.6.2.3.cmml" xref="S4.SS1.p3.4.m3.6.6.2.4"><ci id="S4.SS1.p3.4.m3.5.5.1.1.cmml" xref="S4.SS1.p3.4.m3.5.5.1.1">𝑤</ci><ci id="S4.SS1.p3.4.m3.6.6.2.2.cmml" xref="S4.SS1.p3.4.m3.6.6.2.2">ref</ci></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.4.m3.6c">\mathbf{x}_{t}^{w,{\rm ref}}=\sqrt{\alpha^{t}}\mathbf{x}_{0}^{w,{\rm ref}}+%
\sqrt{1-\alpha^{t}}\epsilon^{w,{\rm ref}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.4.m3.6d">bold_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_w , roman_ref end_POSTSUPERSCRIPT = square-root start_ARG italic_α start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT end_ARG bold_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_w , roman_ref end_POSTSUPERSCRIPT + square-root start_ARG 1 - italic_α start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT end_ARG italic_ϵ start_POSTSUPERSCRIPT italic_w , roman_ref end_POSTSUPERSCRIPT</annotation></semantics></math>. Notably, in equation&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.05255v1#S4.E6" title="Equation 6 ‣ 4.1 Iterative Alignment from Semi-policy Preference Optimization ‣ 4 Iterative Alignment for Diffusion Models ‣ SePPO: Semi-Policy Preference Optimization for Diffusion Alignment"><span class="ltx_text ltx_ref_tag">6</span></a>, the reference image <math alttext="\mathbf{x}_{0}^{\rm ref}" class="ltx_Math" display="inline" id="S4.SS1.p3.5.m4.1"><semantics id="S4.SS1.p3.5.m4.1a"><msubsup id="S4.SS1.p3.5.m4.1.1" xref="S4.SS1.p3.5.m4.1.1.cmml"><mi id="S4.SS1.p3.5.m4.1.1.2.2" xref="S4.SS1.p3.5.m4.1.1.2.2.cmml">𝐱</mi><mn id="S4.SS1.p3.5.m4.1.1.2.3" xref="S4.SS1.p3.5.m4.1.1.2.3.cmml">0</mn><mi id="S4.SS1.p3.5.m4.1.1.3" xref="S4.SS1.p3.5.m4.1.1.3.cmml">ref</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.5.m4.1b"><apply id="S4.SS1.p3.5.m4.1.1.cmml" xref="S4.SS1.p3.5.m4.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.5.m4.1.1.1.cmml" xref="S4.SS1.p3.5.m4.1.1">superscript</csymbol><apply id="S4.SS1.p3.5.m4.1.1.2.cmml" xref="S4.SS1.p3.5.m4.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.5.m4.1.1.2.1.cmml" xref="S4.SS1.p3.5.m4.1.1">subscript</csymbol><ci id="S4.SS1.p3.5.m4.1.1.2.2.cmml" xref="S4.SS1.p3.5.m4.1.1.2.2">𝐱</ci><cn id="S4.SS1.p3.5.m4.1.1.2.3.cmml" type="integer" xref="S4.SS1.p3.5.m4.1.1.2.3">0</cn></apply><ci id="S4.SS1.p3.5.m4.1.1.3.cmml" xref="S4.SS1.p3.5.m4.1.1.3">ref</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.5.m4.1c">\mathbf{x}_{0}^{\rm ref}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.5.m4.1d">bold_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT roman_ref end_POSTSUPERSCRIPT</annotation></semantics></math> is generated from the reference model <math alttext="{\theta}_{\rm ref}" class="ltx_Math" display="inline" id="S4.SS1.p3.6.m5.1"><semantics id="S4.SS1.p3.6.m5.1a"><msub id="S4.SS1.p3.6.m5.1.1" xref="S4.SS1.p3.6.m5.1.1.cmml"><mi id="S4.SS1.p3.6.m5.1.1.2" xref="S4.SS1.p3.6.m5.1.1.2.cmml">θ</mi><mi id="S4.SS1.p3.6.m5.1.1.3" xref="S4.SS1.p3.6.m5.1.1.3.cmml">ref</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.6.m5.1b"><apply id="S4.SS1.p3.6.m5.1.1.cmml" xref="S4.SS1.p3.6.m5.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.6.m5.1.1.1.cmml" xref="S4.SS1.p3.6.m5.1.1">subscript</csymbol><ci id="S4.SS1.p3.6.m5.1.1.2.cmml" xref="S4.SS1.p3.6.m5.1.1.2">𝜃</ci><ci id="S4.SS1.p3.6.m5.1.1.3.cmml" xref="S4.SS1.p3.6.m5.1.1.3">ref</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.6.m5.1c">{\theta}_{\rm ref}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.6.m5.1d">italic_θ start_POSTSUBSCRIPT roman_ref end_POSTSUBSCRIPT</annotation></semantics></math>, which is on-policy learning.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS1.p4">
<p class="ltx_p" id="S4.SS1.p4.7">To validate the effectiveness of <math alttext="{\rm ref}=[0,k-1]" class="ltx_Math" display="inline" id="S4.SS1.p4.1.m1.2"><semantics id="S4.SS1.p4.1.m1.2a"><mrow id="S4.SS1.p4.1.m1.2.2" xref="S4.SS1.p4.1.m1.2.2.cmml"><mi id="S4.SS1.p4.1.m1.2.2.3" xref="S4.SS1.p4.1.m1.2.2.3.cmml">ref</mi><mo id="S4.SS1.p4.1.m1.2.2.2" xref="S4.SS1.p4.1.m1.2.2.2.cmml">=</mo><mrow id="S4.SS1.p4.1.m1.2.2.1.1" xref="S4.SS1.p4.1.m1.2.2.1.2.cmml"><mo id="S4.SS1.p4.1.m1.2.2.1.1.2" stretchy="false" xref="S4.SS1.p4.1.m1.2.2.1.2.cmml">[</mo><mn id="S4.SS1.p4.1.m1.1.1" xref="S4.SS1.p4.1.m1.1.1.cmml">0</mn><mo id="S4.SS1.p4.1.m1.2.2.1.1.3" xref="S4.SS1.p4.1.m1.2.2.1.2.cmml">,</mo><mrow id="S4.SS1.p4.1.m1.2.2.1.1.1" xref="S4.SS1.p4.1.m1.2.2.1.1.1.cmml"><mi id="S4.SS1.p4.1.m1.2.2.1.1.1.2" xref="S4.SS1.p4.1.m1.2.2.1.1.1.2.cmml">k</mi><mo id="S4.SS1.p4.1.m1.2.2.1.1.1.1" xref="S4.SS1.p4.1.m1.2.2.1.1.1.1.cmml">−</mo><mn id="S4.SS1.p4.1.m1.2.2.1.1.1.3" xref="S4.SS1.p4.1.m1.2.2.1.1.1.3.cmml">1</mn></mrow><mo id="S4.SS1.p4.1.m1.2.2.1.1.4" stretchy="false" xref="S4.SS1.p4.1.m1.2.2.1.2.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.1.m1.2b"><apply id="S4.SS1.p4.1.m1.2.2.cmml" xref="S4.SS1.p4.1.m1.2.2"><eq id="S4.SS1.p4.1.m1.2.2.2.cmml" xref="S4.SS1.p4.1.m1.2.2.2"></eq><ci id="S4.SS1.p4.1.m1.2.2.3.cmml" xref="S4.SS1.p4.1.m1.2.2.3">ref</ci><interval closure="closed" id="S4.SS1.p4.1.m1.2.2.1.2.cmml" xref="S4.SS1.p4.1.m1.2.2.1.1"><cn id="S4.SS1.p4.1.m1.1.1.cmml" type="integer" xref="S4.SS1.p4.1.m1.1.1">0</cn><apply id="S4.SS1.p4.1.m1.2.2.1.1.1.cmml" xref="S4.SS1.p4.1.m1.2.2.1.1.1"><minus id="S4.SS1.p4.1.m1.2.2.1.1.1.1.cmml" xref="S4.SS1.p4.1.m1.2.2.1.1.1.1"></minus><ci id="S4.SS1.p4.1.m1.2.2.1.1.1.2.cmml" xref="S4.SS1.p4.1.m1.2.2.1.1.1.2">𝑘</ci><cn id="S4.SS1.p4.1.m1.2.2.1.1.1.3.cmml" type="integer" xref="S4.SS1.p4.1.m1.2.2.1.1.1.3">1</cn></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.1.m1.2c">{\rm ref}=[0,k-1]</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p4.1.m1.2d">roman_ref = [ 0 , italic_k - 1 ]</annotation></semantics></math>, we use the Pick-a-Pic dataset and the stable diffusion 1.5 (SD-1.5) model to conduct all experiments for the ablation study. In experiments, we save a checkpoint every <math alttext="30" class="ltx_Math" display="inline" id="S4.SS1.p4.2.m2.1"><semantics id="S4.SS1.p4.2.m2.1a"><mn id="S4.SS1.p4.2.m2.1.1" xref="S4.SS1.p4.2.m2.1.1.cmml">30</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.2.m2.1b"><cn id="S4.SS1.p4.2.m2.1.1.cmml" type="integer" xref="S4.SS1.p4.2.m2.1.1">30</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.2.m2.1c">30</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p4.2.m2.1d">30</annotation></semantics></math> updates (<math alttext="K=7" class="ltx_Math" display="inline" id="S4.SS1.p4.3.m3.1"><semantics id="S4.SS1.p4.3.m3.1a"><mrow id="S4.SS1.p4.3.m3.1.1" xref="S4.SS1.p4.3.m3.1.1.cmml"><mi id="S4.SS1.p4.3.m3.1.1.2" xref="S4.SS1.p4.3.m3.1.1.2.cmml">K</mi><mo id="S4.SS1.p4.3.m3.1.1.1" xref="S4.SS1.p4.3.m3.1.1.1.cmml">=</mo><mn id="S4.SS1.p4.3.m3.1.1.3" xref="S4.SS1.p4.3.m3.1.1.3.cmml">7</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.3.m3.1b"><apply id="S4.SS1.p4.3.m3.1.1.cmml" xref="S4.SS1.p4.3.m3.1.1"><eq id="S4.SS1.p4.3.m3.1.1.1.cmml" xref="S4.SS1.p4.3.m3.1.1.1"></eq><ci id="S4.SS1.p4.3.m3.1.1.2.cmml" xref="S4.SS1.p4.3.m3.1.1.2">𝐾</ci><cn id="S4.SS1.p4.3.m3.1.1.3.cmml" type="integer" xref="S4.SS1.p4.3.m3.1.1.3">7</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.3.m3.1c">K=7</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p4.3.m3.1d">italic_K = 7</annotation></semantics></math> iterations). The experimental results are shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.05255v1#S4.F2" title="Figure 2 ‣ 4.1 Iterative Alignment from Semi-policy Preference Optimization ‣ 4 Iterative Alignment for Diffusion Models ‣ SePPO: Semi-Policy Preference Optimization for Diffusion Alignment"><span class="ltx_text ltx_ref_tag">2</span></a>. In the beginning, the performances of all models are improved. However, as the number of steps <math alttext="T" class="ltx_Math" display="inline" id="S4.SS1.p4.4.m4.1"><semantics id="S4.SS1.p4.4.m4.1a"><mi id="S4.SS1.p4.4.m4.1.1" xref="S4.SS1.p4.4.m4.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.4.m4.1b"><ci id="S4.SS1.p4.4.m4.1.1.cmml" xref="S4.SS1.p4.4.m4.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.4.m4.1c">T</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p4.4.m4.1d">italic_T</annotation></semantics></math> increases, the performance of the model with <math alttext="{\rm ref}=0" class="ltx_Math" display="inline" id="S4.SS1.p4.5.m5.1"><semantics id="S4.SS1.p4.5.m5.1a"><mrow id="S4.SS1.p4.5.m5.1.1" xref="S4.SS1.p4.5.m5.1.1.cmml"><mi id="S4.SS1.p4.5.m5.1.1.2" xref="S4.SS1.p4.5.m5.1.1.2.cmml">ref</mi><mo id="S4.SS1.p4.5.m5.1.1.1" xref="S4.SS1.p4.5.m5.1.1.1.cmml">=</mo><mn id="S4.SS1.p4.5.m5.1.1.3" xref="S4.SS1.p4.5.m5.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.5.m5.1b"><apply id="S4.SS1.p4.5.m5.1.1.cmml" xref="S4.SS1.p4.5.m5.1.1"><eq id="S4.SS1.p4.5.m5.1.1.1.cmml" xref="S4.SS1.p4.5.m5.1.1.1"></eq><ci id="S4.SS1.p4.5.m5.1.1.2.cmml" xref="S4.SS1.p4.5.m5.1.1.2">ref</ci><cn id="S4.SS1.p4.5.m5.1.1.3.cmml" type="integer" xref="S4.SS1.p4.5.m5.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.5.m5.1c">{\rm ref}=0</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p4.5.m5.1d">roman_ref = 0</annotation></semantics></math> starts to decrease and quickly exhibits overfitting. The model with <math alttext="{\rm ref}=k-1" class="ltx_Math" display="inline" id="S4.SS1.p4.6.m6.1"><semantics id="S4.SS1.p4.6.m6.1a"><mrow id="S4.SS1.p4.6.m6.1.1" xref="S4.SS1.p4.6.m6.1.1.cmml"><mi id="S4.SS1.p4.6.m6.1.1.2" xref="S4.SS1.p4.6.m6.1.1.2.cmml">ref</mi><mo id="S4.SS1.p4.6.m6.1.1.1" xref="S4.SS1.p4.6.m6.1.1.1.cmml">=</mo><mrow id="S4.SS1.p4.6.m6.1.1.3" xref="S4.SS1.p4.6.m6.1.1.3.cmml"><mi id="S4.SS1.p4.6.m6.1.1.3.2" xref="S4.SS1.p4.6.m6.1.1.3.2.cmml">k</mi><mo id="S4.SS1.p4.6.m6.1.1.3.1" xref="S4.SS1.p4.6.m6.1.1.3.1.cmml">−</mo><mn id="S4.SS1.p4.6.m6.1.1.3.3" xref="S4.SS1.p4.6.m6.1.1.3.3.cmml">1</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.6.m6.1b"><apply id="S4.SS1.p4.6.m6.1.1.cmml" xref="S4.SS1.p4.6.m6.1.1"><eq id="S4.SS1.p4.6.m6.1.1.1.cmml" xref="S4.SS1.p4.6.m6.1.1.1"></eq><ci id="S4.SS1.p4.6.m6.1.1.2.cmml" xref="S4.SS1.p4.6.m6.1.1.2">ref</ci><apply id="S4.SS1.p4.6.m6.1.1.3.cmml" xref="S4.SS1.p4.6.m6.1.1.3"><minus id="S4.SS1.p4.6.m6.1.1.3.1.cmml" xref="S4.SS1.p4.6.m6.1.1.3.1"></minus><ci id="S4.SS1.p4.6.m6.1.1.3.2.cmml" xref="S4.SS1.p4.6.m6.1.1.3.2">𝑘</ci><cn id="S4.SS1.p4.6.m6.1.1.3.3.cmml" type="integer" xref="S4.SS1.p4.6.m6.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.6.m6.1c">{\rm ref}=k-1</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p4.6.m6.1d">roman_ref = italic_k - 1</annotation></semantics></math> shows unstable performances. Due to the fact that when all reference samples are generated from the last checkpoint in the current round of training, the model is prone to fall into non-global optima, leading to instability in the training process <cite class="ltx_cite ltx_citemacro_cite">Florensa et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.05255v1#bib.bib6" title="">2018</a>)</cite>. Therefore, considering both model performance and stability, our method uses <math alttext="{\rm ref}=[0,k-1]" class="ltx_Math" display="inline" id="S4.SS1.p4.7.m7.2"><semantics id="S4.SS1.p4.7.m7.2a"><mrow id="S4.SS1.p4.7.m7.2.2" xref="S4.SS1.p4.7.m7.2.2.cmml"><mi id="S4.SS1.p4.7.m7.2.2.3" xref="S4.SS1.p4.7.m7.2.2.3.cmml">ref</mi><mo id="S4.SS1.p4.7.m7.2.2.2" xref="S4.SS1.p4.7.m7.2.2.2.cmml">=</mo><mrow id="S4.SS1.p4.7.m7.2.2.1.1" xref="S4.SS1.p4.7.m7.2.2.1.2.cmml"><mo id="S4.SS1.p4.7.m7.2.2.1.1.2" stretchy="false" xref="S4.SS1.p4.7.m7.2.2.1.2.cmml">[</mo><mn id="S4.SS1.p4.7.m7.1.1" xref="S4.SS1.p4.7.m7.1.1.cmml">0</mn><mo id="S4.SS1.p4.7.m7.2.2.1.1.3" xref="S4.SS1.p4.7.m7.2.2.1.2.cmml">,</mo><mrow id="S4.SS1.p4.7.m7.2.2.1.1.1" xref="S4.SS1.p4.7.m7.2.2.1.1.1.cmml"><mi id="S4.SS1.p4.7.m7.2.2.1.1.1.2" xref="S4.SS1.p4.7.m7.2.2.1.1.1.2.cmml">k</mi><mo id="S4.SS1.p4.7.m7.2.2.1.1.1.1" xref="S4.SS1.p4.7.m7.2.2.1.1.1.1.cmml">−</mo><mn id="S4.SS1.p4.7.m7.2.2.1.1.1.3" xref="S4.SS1.p4.7.m7.2.2.1.1.1.3.cmml">1</mn></mrow><mo id="S4.SS1.p4.7.m7.2.2.1.1.4" stretchy="false" xref="S4.SS1.p4.7.m7.2.2.1.2.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.7.m7.2b"><apply id="S4.SS1.p4.7.m7.2.2.cmml" xref="S4.SS1.p4.7.m7.2.2"><eq id="S4.SS1.p4.7.m7.2.2.2.cmml" xref="S4.SS1.p4.7.m7.2.2.2"></eq><ci id="S4.SS1.p4.7.m7.2.2.3.cmml" xref="S4.SS1.p4.7.m7.2.2.3">ref</ci><interval closure="closed" id="S4.SS1.p4.7.m7.2.2.1.2.cmml" xref="S4.SS1.p4.7.m7.2.2.1.1"><cn id="S4.SS1.p4.7.m7.1.1.cmml" type="integer" xref="S4.SS1.p4.7.m7.1.1">0</cn><apply id="S4.SS1.p4.7.m7.2.2.1.1.1.cmml" xref="S4.SS1.p4.7.m7.2.2.1.1.1"><minus id="S4.SS1.p4.7.m7.2.2.1.1.1.1.cmml" xref="S4.SS1.p4.7.m7.2.2.1.1.1.1"></minus><ci id="S4.SS1.p4.7.m7.2.2.1.1.1.2.cmml" xref="S4.SS1.p4.7.m7.2.2.1.1.1.2">𝑘</ci><cn id="S4.SS1.p4.7.m7.2.2.1.1.1.3.cmml" type="integer" xref="S4.SS1.p4.7.m7.2.2.1.1.1.3">1</cn></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.7.m7.2c">{\rm ref}=[0,k-1]</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p4.7.m7.2d">roman_ref = [ 0 , italic_k - 1 ]</annotation></semantics></math> to generate reference samples.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS1.p5">
<p class="ltx_p" id="S4.SS1.p5.2">It is noteworthy that our positive samples <math alttext="\mathbf{x}_{0}^{w}" class="ltx_Math" display="inline" id="S4.SS1.p5.1.m1.1"><semantics id="S4.SS1.p5.1.m1.1a"><msubsup id="S4.SS1.p5.1.m1.1.1" xref="S4.SS1.p5.1.m1.1.1.cmml"><mi id="S4.SS1.p5.1.m1.1.1.2.2" xref="S4.SS1.p5.1.m1.1.1.2.2.cmml">𝐱</mi><mn id="S4.SS1.p5.1.m1.1.1.2.3" xref="S4.SS1.p5.1.m1.1.1.2.3.cmml">0</mn><mi id="S4.SS1.p5.1.m1.1.1.3" xref="S4.SS1.p5.1.m1.1.1.3.cmml">w</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS1.p5.1.m1.1b"><apply id="S4.SS1.p5.1.m1.1.1.cmml" xref="S4.SS1.p5.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p5.1.m1.1.1.1.cmml" xref="S4.SS1.p5.1.m1.1.1">superscript</csymbol><apply id="S4.SS1.p5.1.m1.1.1.2.cmml" xref="S4.SS1.p5.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p5.1.m1.1.1.2.1.cmml" xref="S4.SS1.p5.1.m1.1.1">subscript</csymbol><ci id="S4.SS1.p5.1.m1.1.1.2.2.cmml" xref="S4.SS1.p5.1.m1.1.1.2.2">𝐱</ci><cn id="S4.SS1.p5.1.m1.1.1.2.3.cmml" type="integer" xref="S4.SS1.p5.1.m1.1.1.2.3">0</cn></apply><ci id="S4.SS1.p5.1.m1.1.1.3.cmml" xref="S4.SS1.p5.1.m1.1.1.3">𝑤</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p5.1.m1.1c">\mathbf{x}_{0}^{w}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p5.1.m1.1d">bold_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_w end_POSTSUPERSCRIPT</annotation></semantics></math> are collected off-policy from demonstrations, while the reference samples <math alttext="\mathbf{x}_{0}^{\rm ref}" class="ltx_Math" display="inline" id="S4.SS1.p5.2.m2.1"><semantics id="S4.SS1.p5.2.m2.1a"><msubsup id="S4.SS1.p5.2.m2.1.1" xref="S4.SS1.p5.2.m2.1.1.cmml"><mi id="S4.SS1.p5.2.m2.1.1.2.2" xref="S4.SS1.p5.2.m2.1.1.2.2.cmml">𝐱</mi><mn id="S4.SS1.p5.2.m2.1.1.2.3" xref="S4.SS1.p5.2.m2.1.1.2.3.cmml">0</mn><mi id="S4.SS1.p5.2.m2.1.1.3" xref="S4.SS1.p5.2.m2.1.1.3.cmml">ref</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS1.p5.2.m2.1b"><apply id="S4.SS1.p5.2.m2.1.1.cmml" xref="S4.SS1.p5.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS1.p5.2.m2.1.1.1.cmml" xref="S4.SS1.p5.2.m2.1.1">superscript</csymbol><apply id="S4.SS1.p5.2.m2.1.1.2.cmml" xref="S4.SS1.p5.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS1.p5.2.m2.1.1.2.1.cmml" xref="S4.SS1.p5.2.m2.1.1">subscript</csymbol><ci id="S4.SS1.p5.2.m2.1.1.2.2.cmml" xref="S4.SS1.p5.2.m2.1.1.2.2">𝐱</ci><cn id="S4.SS1.p5.2.m2.1.1.2.3.cmml" type="integer" xref="S4.SS1.p5.2.m2.1.1.2.3">0</cn></apply><ci id="S4.SS1.p5.2.m2.1.1.3.cmml" xref="S4.SS1.p5.2.m2.1.1.3">ref</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p5.2.m2.1c">\mathbf{x}_{0}^{\rm ref}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p5.2.m2.1d">bold_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT roman_ref end_POSTSUPERSCRIPT</annotation></semantics></math> are collected on-policy from the saved policies. Therefore, we term our approach Semi-Policy Preference Optimization (SePPO).</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_figure" id="S4.F2">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F2.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="128" id="S4.F2.sf1.g1" src="https://arxiv.org/html/2410.05255v1/extracted/5908093/figures/pick_score.png" width="170">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span>PickScore</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F2.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="128" id="S4.F2.sf2.g1" src="https://arxiv.org/html/2410.05255v1/extracted/5908093/figures/hpsv2.png" width="170">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span>HPSv2</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F2.sf3"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="128" id="S4.F2.sf3.g1" src="https://arxiv.org/html/2410.05255v1/extracted/5908093/figures/image_reward.png" width="170">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(c) </span>ImageReward</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>Ablation study of the reference model selection strategies. The x-axis is the number of diffusion steps <math alttext="T" class="ltx_Math" display="inline" id="S4.F2.2.m1.1"><semantics id="S4.F2.2.m1.1b"><mi id="S4.F2.2.m1.1.1" xref="S4.F2.2.m1.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S4.F2.2.m1.1c"><ci id="S4.F2.2.m1.1.1.cmml" xref="S4.F2.2.m1.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F2.2.m1.1d">T</annotation><annotation encoding="application/x-llamapun" id="S4.F2.2.m1.1e">italic_T</annotation></semantics></math>. The y-axis is the testing score. (The higher is better.)</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top" id="alg1">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="alg1.2.1.1">Algorithm 1</span> </span> SePPO</figcaption>
<div class="ltx_listing ltx_listing" id="alg1.3">
<div class="ltx_listingline" id="alg1.l0">
<span class="ltx_tag ltx_tag_listingline">0:</span>&nbsp;&nbsp;Demonstrated data set <math alttext="(\mathbf{x}_{0}^{w},\mathbf{c})\sim\mathcal{D}" class="ltx_Math" display="inline" id="alg1.l0.m1.2"><semantics id="alg1.l0.m1.2a"><mrow id="alg1.l0.m1.2.2" xref="alg1.l0.m1.2.2.cmml"><mrow id="alg1.l0.m1.2.2.1.1" xref="alg1.l0.m1.2.2.1.2.cmml"><mo id="alg1.l0.m1.2.2.1.1.2" stretchy="false" xref="alg1.l0.m1.2.2.1.2.cmml">(</mo><msubsup id="alg1.l0.m1.2.2.1.1.1" xref="alg1.l0.m1.2.2.1.1.1.cmml"><mi id="alg1.l0.m1.2.2.1.1.1.2.2" xref="alg1.l0.m1.2.2.1.1.1.2.2.cmml">𝐱</mi><mn id="alg1.l0.m1.2.2.1.1.1.2.3" xref="alg1.l0.m1.2.2.1.1.1.2.3.cmml">0</mn><mi id="alg1.l0.m1.2.2.1.1.1.3" xref="alg1.l0.m1.2.2.1.1.1.3.cmml">w</mi></msubsup><mo id="alg1.l0.m1.2.2.1.1.3" xref="alg1.l0.m1.2.2.1.2.cmml">,</mo><mi id="alg1.l0.m1.1.1" xref="alg1.l0.m1.1.1.cmml">𝐜</mi><mo id="alg1.l0.m1.2.2.1.1.4" stretchy="false" xref="alg1.l0.m1.2.2.1.2.cmml">)</mo></mrow><mo id="alg1.l0.m1.2.2.2" xref="alg1.l0.m1.2.2.2.cmml">∼</mo><mi class="ltx_font_mathcaligraphic" id="alg1.l0.m1.2.2.3" xref="alg1.l0.m1.2.2.3.cmml">𝒟</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l0.m1.2b"><apply id="alg1.l0.m1.2.2.cmml" xref="alg1.l0.m1.2.2"><csymbol cd="latexml" id="alg1.l0.m1.2.2.2.cmml" xref="alg1.l0.m1.2.2.2">similar-to</csymbol><interval closure="open" id="alg1.l0.m1.2.2.1.2.cmml" xref="alg1.l0.m1.2.2.1.1"><apply id="alg1.l0.m1.2.2.1.1.1.cmml" xref="alg1.l0.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="alg1.l0.m1.2.2.1.1.1.1.cmml" xref="alg1.l0.m1.2.2.1.1.1">superscript</csymbol><apply id="alg1.l0.m1.2.2.1.1.1.2.cmml" xref="alg1.l0.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="alg1.l0.m1.2.2.1.1.1.2.1.cmml" xref="alg1.l0.m1.2.2.1.1.1">subscript</csymbol><ci id="alg1.l0.m1.2.2.1.1.1.2.2.cmml" xref="alg1.l0.m1.2.2.1.1.1.2.2">𝐱</ci><cn id="alg1.l0.m1.2.2.1.1.1.2.3.cmml" type="integer" xref="alg1.l0.m1.2.2.1.1.1.2.3">0</cn></apply><ci id="alg1.l0.m1.2.2.1.1.1.3.cmml" xref="alg1.l0.m1.2.2.1.1.1.3">𝑤</ci></apply><ci id="alg1.l0.m1.1.1.cmml" xref="alg1.l0.m1.1.1">𝐜</ci></interval><ci id="alg1.l0.m1.2.2.3.cmml" xref="alg1.l0.m1.2.2.3">𝒟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m1.2c">(\mathbf{x}_{0}^{w},\mathbf{c})\sim\mathcal{D}</annotation><annotation encoding="application/x-llamapun" id="alg1.l0.m1.2d">( bold_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_w end_POSTSUPERSCRIPT , bold_c ) ∼ caligraphic_D</annotation></semantics></math>; Number of diffusion steps <math alttext="T" class="ltx_Math" display="inline" id="alg1.l0.m2.1"><semantics id="alg1.l0.m2.1a"><mi id="alg1.l0.m2.1.1" xref="alg1.l0.m2.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="alg1.l0.m2.1b"><ci id="alg1.l0.m2.1.1.cmml" xref="alg1.l0.m2.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m2.1c">T</annotation><annotation encoding="application/x-llamapun" id="alg1.l0.m2.1d">italic_T</annotation></semantics></math>; Number of iterations <math alttext="K" class="ltx_Math" display="inline" id="alg1.l0.m3.1"><semantics id="alg1.l0.m3.1a"><mi id="alg1.l0.m3.1.1" xref="alg1.l0.m3.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="alg1.l0.m3.1b"><ci id="alg1.l0.m3.1.1.cmml" xref="alg1.l0.m3.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m3.1c">K</annotation><annotation encoding="application/x-llamapun" id="alg1.l0.m3.1d">italic_K</annotation></semantics></math>; Initial model <math alttext="{\theta_{0}}" class="ltx_Math" display="inline" id="alg1.l0.m4.1"><semantics id="alg1.l0.m4.1a"><msub id="alg1.l0.m4.1.1" xref="alg1.l0.m4.1.1.cmml"><mi id="alg1.l0.m4.1.1.2" xref="alg1.l0.m4.1.1.2.cmml">θ</mi><mn id="alg1.l0.m4.1.1.3" xref="alg1.l0.m4.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="alg1.l0.m4.1b"><apply id="alg1.l0.m4.1.1.cmml" xref="alg1.l0.m4.1.1"><csymbol cd="ambiguous" id="alg1.l0.m4.1.1.1.cmml" xref="alg1.l0.m4.1.1">subscript</csymbol><ci id="alg1.l0.m4.1.1.2.cmml" xref="alg1.l0.m4.1.1.2">𝜃</ci><cn id="alg1.l0.m4.1.1.3.cmml" type="integer" xref="alg1.l0.m4.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m4.1c">{\theta_{0}}</annotation><annotation encoding="application/x-llamapun" id="alg1.l0.m4.1d">italic_θ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math>.

</div>
<div class="ltx_listingline" id="alg1.l1">
<span class="ltx_tag ltx_tag_listingline">1:</span>&nbsp;&nbsp;<span class="ltx_text ltx_font_bold" id="alg1.l1.1">for</span> <math alttext="k=1,\cdots,K" class="ltx_Math" display="inline" id="alg1.l1.m1.3"><semantics id="alg1.l1.m1.3a"><mrow id="alg1.l1.m1.3.4" xref="alg1.l1.m1.3.4.cmml"><mi id="alg1.l1.m1.3.4.2" xref="alg1.l1.m1.3.4.2.cmml">k</mi><mo id="alg1.l1.m1.3.4.1" xref="alg1.l1.m1.3.4.1.cmml">=</mo><mrow id="alg1.l1.m1.3.4.3.2" xref="alg1.l1.m1.3.4.3.1.cmml"><mn id="alg1.l1.m1.1.1" xref="alg1.l1.m1.1.1.cmml">1</mn><mo id="alg1.l1.m1.3.4.3.2.1" xref="alg1.l1.m1.3.4.3.1.cmml">,</mo><mi id="alg1.l1.m1.2.2" mathvariant="normal" xref="alg1.l1.m1.2.2.cmml">⋯</mi><mo id="alg1.l1.m1.3.4.3.2.2" xref="alg1.l1.m1.3.4.3.1.cmml">,</mo><mi id="alg1.l1.m1.3.3" xref="alg1.l1.m1.3.3.cmml">K</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l1.m1.3b"><apply id="alg1.l1.m1.3.4.cmml" xref="alg1.l1.m1.3.4"><eq id="alg1.l1.m1.3.4.1.cmml" xref="alg1.l1.m1.3.4.1"></eq><ci id="alg1.l1.m1.3.4.2.cmml" xref="alg1.l1.m1.3.4.2">𝑘</ci><list id="alg1.l1.m1.3.4.3.1.cmml" xref="alg1.l1.m1.3.4.3.2"><cn id="alg1.l1.m1.1.1.cmml" type="integer" xref="alg1.l1.m1.1.1">1</cn><ci id="alg1.l1.m1.2.2.cmml" xref="alg1.l1.m1.2.2">⋯</ci><ci id="alg1.l1.m1.3.3.cmml" xref="alg1.l1.m1.3.3">𝐾</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m1.3c">k=1,\cdots,K</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m1.3d">italic_k = 1 , ⋯ , italic_K</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="alg1.l1.2">do</span>
</div>
<div class="ltx_listingline" id="alg1.l2">
<span class="ltx_tag ltx_tag_listingline">2:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sample a reference model <math alttext="{\rm ref}\sim\mathcal{U}(0,k-1)" class="ltx_Math" display="inline" id="alg1.l2.m1.2"><semantics id="alg1.l2.m1.2a"><mrow id="alg1.l2.m1.2.2" xref="alg1.l2.m1.2.2.cmml"><mi id="alg1.l2.m1.2.2.3" xref="alg1.l2.m1.2.2.3.cmml">ref</mi><mo id="alg1.l2.m1.2.2.2" xref="alg1.l2.m1.2.2.2.cmml">∼</mo><mrow id="alg1.l2.m1.2.2.1" xref="alg1.l2.m1.2.2.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l2.m1.2.2.1.3" xref="alg1.l2.m1.2.2.1.3.cmml">𝒰</mi><mo id="alg1.l2.m1.2.2.1.2" xref="alg1.l2.m1.2.2.1.2.cmml">⁢</mo><mrow id="alg1.l2.m1.2.2.1.1.1" xref="alg1.l2.m1.2.2.1.1.2.cmml"><mo id="alg1.l2.m1.2.2.1.1.1.2" stretchy="false" xref="alg1.l2.m1.2.2.1.1.2.cmml">(</mo><mn id="alg1.l2.m1.1.1" xref="alg1.l2.m1.1.1.cmml">0</mn><mo id="alg1.l2.m1.2.2.1.1.1.3" xref="alg1.l2.m1.2.2.1.1.2.cmml">,</mo><mrow id="alg1.l2.m1.2.2.1.1.1.1" xref="alg1.l2.m1.2.2.1.1.1.1.cmml"><mi id="alg1.l2.m1.2.2.1.1.1.1.2" xref="alg1.l2.m1.2.2.1.1.1.1.2.cmml">k</mi><mo id="alg1.l2.m1.2.2.1.1.1.1.1" xref="alg1.l2.m1.2.2.1.1.1.1.1.cmml">−</mo><mn id="alg1.l2.m1.2.2.1.1.1.1.3" xref="alg1.l2.m1.2.2.1.1.1.1.3.cmml">1</mn></mrow><mo id="alg1.l2.m1.2.2.1.1.1.4" stretchy="false" xref="alg1.l2.m1.2.2.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l2.m1.2b"><apply id="alg1.l2.m1.2.2.cmml" xref="alg1.l2.m1.2.2"><csymbol cd="latexml" id="alg1.l2.m1.2.2.2.cmml" xref="alg1.l2.m1.2.2.2">similar-to</csymbol><ci id="alg1.l2.m1.2.2.3.cmml" xref="alg1.l2.m1.2.2.3">ref</ci><apply id="alg1.l2.m1.2.2.1.cmml" xref="alg1.l2.m1.2.2.1"><times id="alg1.l2.m1.2.2.1.2.cmml" xref="alg1.l2.m1.2.2.1.2"></times><ci id="alg1.l2.m1.2.2.1.3.cmml" xref="alg1.l2.m1.2.2.1.3">𝒰</ci><interval closure="open" id="alg1.l2.m1.2.2.1.1.2.cmml" xref="alg1.l2.m1.2.2.1.1.1"><cn id="alg1.l2.m1.1.1.cmml" type="integer" xref="alg1.l2.m1.1.1">0</cn><apply id="alg1.l2.m1.2.2.1.1.1.1.cmml" xref="alg1.l2.m1.2.2.1.1.1.1"><minus id="alg1.l2.m1.2.2.1.1.1.1.1.cmml" xref="alg1.l2.m1.2.2.1.1.1.1.1"></minus><ci id="alg1.l2.m1.2.2.1.1.1.1.2.cmml" xref="alg1.l2.m1.2.2.1.1.1.1.2">𝑘</ci><cn id="alg1.l2.m1.2.2.1.1.1.1.3.cmml" type="integer" xref="alg1.l2.m1.2.2.1.1.1.1.3">1</cn></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m1.2c">{\rm ref}\sim\mathcal{U}(0,k-1)</annotation><annotation encoding="application/x-llamapun" id="alg1.l2.m1.2d">roman_ref ∼ caligraphic_U ( 0 , italic_k - 1 )</annotation></semantics></math>.

</div>
<div class="ltx_listingline" id="alg1.l3">
<span class="ltx_tag ltx_tag_listingline">3:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Generate <math alttext="\mathbf{x}_{0}^{\rm ref}" class="ltx_Math" display="inline" id="alg1.l3.m1.1"><semantics id="alg1.l3.m1.1a"><msubsup id="alg1.l3.m1.1.1" xref="alg1.l3.m1.1.1.cmml"><mi id="alg1.l3.m1.1.1.2.2" xref="alg1.l3.m1.1.1.2.2.cmml">𝐱</mi><mn id="alg1.l3.m1.1.1.2.3" xref="alg1.l3.m1.1.1.2.3.cmml">0</mn><mi id="alg1.l3.m1.1.1.3" xref="alg1.l3.m1.1.1.3.cmml">ref</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l3.m1.1b"><apply id="alg1.l3.m1.1.1.cmml" xref="alg1.l3.m1.1.1"><csymbol cd="ambiguous" id="alg1.l3.m1.1.1.1.cmml" xref="alg1.l3.m1.1.1">superscript</csymbol><apply id="alg1.l3.m1.1.1.2.cmml" xref="alg1.l3.m1.1.1"><csymbol cd="ambiguous" id="alg1.l3.m1.1.1.2.1.cmml" xref="alg1.l3.m1.1.1">subscript</csymbol><ci id="alg1.l3.m1.1.1.2.2.cmml" xref="alg1.l3.m1.1.1.2.2">𝐱</ci><cn id="alg1.l3.m1.1.1.2.3.cmml" type="integer" xref="alg1.l3.m1.1.1.2.3">0</cn></apply><ci id="alg1.l3.m1.1.1.3.cmml" xref="alg1.l3.m1.1.1.3">ref</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m1.1c">\mathbf{x}_{0}^{\rm ref}</annotation><annotation encoding="application/x-llamapun" id="alg1.l3.m1.1d">bold_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT roman_ref end_POSTSUPERSCRIPT</annotation></semantics></math> from <math alttext="\theta_{\rm ref}" class="ltx_Math" display="inline" id="alg1.l3.m2.1"><semantics id="alg1.l3.m2.1a"><msub id="alg1.l3.m2.1.1" xref="alg1.l3.m2.1.1.cmml"><mi id="alg1.l3.m2.1.1.2" xref="alg1.l3.m2.1.1.2.cmml">θ</mi><mi id="alg1.l3.m2.1.1.3" xref="alg1.l3.m2.1.1.3.cmml">ref</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l3.m2.1b"><apply id="alg1.l3.m2.1.1.cmml" xref="alg1.l3.m2.1.1"><csymbol cd="ambiguous" id="alg1.l3.m2.1.1.1.cmml" xref="alg1.l3.m2.1.1">subscript</csymbol><ci id="alg1.l3.m2.1.1.2.cmml" xref="alg1.l3.m2.1.1.2">𝜃</ci><ci id="alg1.l3.m2.1.1.3.cmml" xref="alg1.l3.m2.1.1.3">ref</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m2.1c">\theta_{\rm ref}</annotation><annotation encoding="application/x-llamapun" id="alg1.l3.m2.1d">italic_θ start_POSTSUBSCRIPT roman_ref end_POSTSUBSCRIPT</annotation></semantics></math>, and compose data pairs <math alttext="(\mathbf{x}_{0}^{w},\mathbf{x}_{0}^{\rm ref},\mathbf{c})" class="ltx_Math" display="inline" id="alg1.l3.m3.3"><semantics id="alg1.l3.m3.3a"><mrow id="alg1.l3.m3.3.3.2" xref="alg1.l3.m3.3.3.3.cmml"><mo id="alg1.l3.m3.3.3.2.3" stretchy="false" xref="alg1.l3.m3.3.3.3.cmml">(</mo><msubsup id="alg1.l3.m3.2.2.1.1" xref="alg1.l3.m3.2.2.1.1.cmml"><mi id="alg1.l3.m3.2.2.1.1.2.2" xref="alg1.l3.m3.2.2.1.1.2.2.cmml">𝐱</mi><mn id="alg1.l3.m3.2.2.1.1.2.3" xref="alg1.l3.m3.2.2.1.1.2.3.cmml">0</mn><mi id="alg1.l3.m3.2.2.1.1.3" xref="alg1.l3.m3.2.2.1.1.3.cmml">w</mi></msubsup><mo id="alg1.l3.m3.3.3.2.4" xref="alg1.l3.m3.3.3.3.cmml">,</mo><msubsup id="alg1.l3.m3.3.3.2.2" xref="alg1.l3.m3.3.3.2.2.cmml"><mi id="alg1.l3.m3.3.3.2.2.2.2" xref="alg1.l3.m3.3.3.2.2.2.2.cmml">𝐱</mi><mn id="alg1.l3.m3.3.3.2.2.2.3" xref="alg1.l3.m3.3.3.2.2.2.3.cmml">0</mn><mi id="alg1.l3.m3.3.3.2.2.3" xref="alg1.l3.m3.3.3.2.2.3.cmml">ref</mi></msubsup><mo id="alg1.l3.m3.3.3.2.5" xref="alg1.l3.m3.3.3.3.cmml">,</mo><mi id="alg1.l3.m3.1.1" xref="alg1.l3.m3.1.1.cmml">𝐜</mi><mo id="alg1.l3.m3.3.3.2.6" stretchy="false" xref="alg1.l3.m3.3.3.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="alg1.l3.m3.3b"><vector id="alg1.l3.m3.3.3.3.cmml" xref="alg1.l3.m3.3.3.2"><apply id="alg1.l3.m3.2.2.1.1.cmml" xref="alg1.l3.m3.2.2.1.1"><csymbol cd="ambiguous" id="alg1.l3.m3.2.2.1.1.1.cmml" xref="alg1.l3.m3.2.2.1.1">superscript</csymbol><apply id="alg1.l3.m3.2.2.1.1.2.cmml" xref="alg1.l3.m3.2.2.1.1"><csymbol cd="ambiguous" id="alg1.l3.m3.2.2.1.1.2.1.cmml" xref="alg1.l3.m3.2.2.1.1">subscript</csymbol><ci id="alg1.l3.m3.2.2.1.1.2.2.cmml" xref="alg1.l3.m3.2.2.1.1.2.2">𝐱</ci><cn id="alg1.l3.m3.2.2.1.1.2.3.cmml" type="integer" xref="alg1.l3.m3.2.2.1.1.2.3">0</cn></apply><ci id="alg1.l3.m3.2.2.1.1.3.cmml" xref="alg1.l3.m3.2.2.1.1.3">𝑤</ci></apply><apply id="alg1.l3.m3.3.3.2.2.cmml" xref="alg1.l3.m3.3.3.2.2"><csymbol cd="ambiguous" id="alg1.l3.m3.3.3.2.2.1.cmml" xref="alg1.l3.m3.3.3.2.2">superscript</csymbol><apply id="alg1.l3.m3.3.3.2.2.2.cmml" xref="alg1.l3.m3.3.3.2.2"><csymbol cd="ambiguous" id="alg1.l3.m3.3.3.2.2.2.1.cmml" xref="alg1.l3.m3.3.3.2.2">subscript</csymbol><ci id="alg1.l3.m3.3.3.2.2.2.2.cmml" xref="alg1.l3.m3.3.3.2.2.2.2">𝐱</ci><cn id="alg1.l3.m3.3.3.2.2.2.3.cmml" type="integer" xref="alg1.l3.m3.3.3.2.2.2.3">0</cn></apply><ci id="alg1.l3.m3.3.3.2.2.3.cmml" xref="alg1.l3.m3.3.3.2.2.3">ref</ci></apply><ci id="alg1.l3.m3.1.1.cmml" xref="alg1.l3.m3.1.1">𝐜</ci></vector></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m3.3c">(\mathbf{x}_{0}^{w},\mathbf{x}_{0}^{\rm ref},\mathbf{c})</annotation><annotation encoding="application/x-llamapun" id="alg1.l3.m3.3d">( bold_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_w end_POSTSUPERSCRIPT , bold_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT roman_ref end_POSTSUPERSCRIPT , bold_c )</annotation></semantics></math>.

</div>
<div class="ltx_listingline" id="alg1.l4">
<span class="ltx_tag ltx_tag_listingline">4:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<math alttext="\theta_{k}\leftarrow\theta_{k-1}-\eta_{k-1}\nabla\mathcal{L}(\theta;\mathbf{x}%
_{0}^{w},\mathbf{x}_{0}^{\rm ref})" class="ltx_Math" display="inline" id="alg1.l4.m1.3"><semantics id="alg1.l4.m1.3a"><mrow id="alg1.l4.m1.3.3" xref="alg1.l4.m1.3.3.cmml"><msub id="alg1.l4.m1.3.3.4" xref="alg1.l4.m1.3.3.4.cmml"><mi id="alg1.l4.m1.3.3.4.2" xref="alg1.l4.m1.3.3.4.2.cmml">θ</mi><mi id="alg1.l4.m1.3.3.4.3" xref="alg1.l4.m1.3.3.4.3.cmml">k</mi></msub><mo id="alg1.l4.m1.3.3.3" stretchy="false" xref="alg1.l4.m1.3.3.3.cmml">←</mo><mrow id="alg1.l4.m1.3.3.2" xref="alg1.l4.m1.3.3.2.cmml"><msub id="alg1.l4.m1.3.3.2.4" xref="alg1.l4.m1.3.3.2.4.cmml"><mi id="alg1.l4.m1.3.3.2.4.2" xref="alg1.l4.m1.3.3.2.4.2.cmml">θ</mi><mrow id="alg1.l4.m1.3.3.2.4.3" xref="alg1.l4.m1.3.3.2.4.3.cmml"><mi id="alg1.l4.m1.3.3.2.4.3.2" xref="alg1.l4.m1.3.3.2.4.3.2.cmml">k</mi><mo id="alg1.l4.m1.3.3.2.4.3.1" xref="alg1.l4.m1.3.3.2.4.3.1.cmml">−</mo><mn id="alg1.l4.m1.3.3.2.4.3.3" xref="alg1.l4.m1.3.3.2.4.3.3.cmml">1</mn></mrow></msub><mo id="alg1.l4.m1.3.3.2.3" xref="alg1.l4.m1.3.3.2.3.cmml">−</mo><mrow id="alg1.l4.m1.3.3.2.2" xref="alg1.l4.m1.3.3.2.2.cmml"><msub id="alg1.l4.m1.3.3.2.2.4" xref="alg1.l4.m1.3.3.2.2.4.cmml"><mi id="alg1.l4.m1.3.3.2.2.4.2" xref="alg1.l4.m1.3.3.2.2.4.2.cmml">η</mi><mrow id="alg1.l4.m1.3.3.2.2.4.3" xref="alg1.l4.m1.3.3.2.2.4.3.cmml"><mi id="alg1.l4.m1.3.3.2.2.4.3.2" xref="alg1.l4.m1.3.3.2.2.4.3.2.cmml">k</mi><mo id="alg1.l4.m1.3.3.2.2.4.3.1" xref="alg1.l4.m1.3.3.2.2.4.3.1.cmml">−</mo><mn id="alg1.l4.m1.3.3.2.2.4.3.3" xref="alg1.l4.m1.3.3.2.2.4.3.3.cmml">1</mn></mrow></msub><mo id="alg1.l4.m1.3.3.2.2.3" lspace="0.167em" xref="alg1.l4.m1.3.3.2.2.3.cmml">⁢</mo><mrow id="alg1.l4.m1.3.3.2.2.5" xref="alg1.l4.m1.3.3.2.2.5.cmml"><mo id="alg1.l4.m1.3.3.2.2.5.1" rspace="0.167em" xref="alg1.l4.m1.3.3.2.2.5.1.cmml">∇</mo><mi class="ltx_font_mathcaligraphic" id="alg1.l4.m1.3.3.2.2.5.2" xref="alg1.l4.m1.3.3.2.2.5.2.cmml">ℒ</mi></mrow><mo id="alg1.l4.m1.3.3.2.2.3a" xref="alg1.l4.m1.3.3.2.2.3.cmml">⁢</mo><mrow id="alg1.l4.m1.3.3.2.2.2.2" xref="alg1.l4.m1.3.3.2.2.2.3.cmml"><mo id="alg1.l4.m1.3.3.2.2.2.2.3" stretchy="false" xref="alg1.l4.m1.3.3.2.2.2.3.cmml">(</mo><mi id="alg1.l4.m1.1.1" xref="alg1.l4.m1.1.1.cmml">θ</mi><mo id="alg1.l4.m1.3.3.2.2.2.2.4" xref="alg1.l4.m1.3.3.2.2.2.3.cmml">;</mo><msubsup id="alg1.l4.m1.2.2.1.1.1.1.1" xref="alg1.l4.m1.2.2.1.1.1.1.1.cmml"><mi id="alg1.l4.m1.2.2.1.1.1.1.1.2.2" xref="alg1.l4.m1.2.2.1.1.1.1.1.2.2.cmml">𝐱</mi><mn id="alg1.l4.m1.2.2.1.1.1.1.1.2.3" xref="alg1.l4.m1.2.2.1.1.1.1.1.2.3.cmml">0</mn><mi id="alg1.l4.m1.2.2.1.1.1.1.1.3" xref="alg1.l4.m1.2.2.1.1.1.1.1.3.cmml">w</mi></msubsup><mo id="alg1.l4.m1.3.3.2.2.2.2.5" xref="alg1.l4.m1.3.3.2.2.2.3.cmml">,</mo><msubsup id="alg1.l4.m1.3.3.2.2.2.2.2" xref="alg1.l4.m1.3.3.2.2.2.2.2.cmml"><mi id="alg1.l4.m1.3.3.2.2.2.2.2.2.2" xref="alg1.l4.m1.3.3.2.2.2.2.2.2.2.cmml">𝐱</mi><mn id="alg1.l4.m1.3.3.2.2.2.2.2.2.3" xref="alg1.l4.m1.3.3.2.2.2.2.2.2.3.cmml">0</mn><mi id="alg1.l4.m1.3.3.2.2.2.2.2.3" xref="alg1.l4.m1.3.3.2.2.2.2.2.3.cmml">ref</mi></msubsup><mo id="alg1.l4.m1.3.3.2.2.2.2.6" stretchy="false" xref="alg1.l4.m1.3.3.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l4.m1.3b"><apply id="alg1.l4.m1.3.3.cmml" xref="alg1.l4.m1.3.3"><ci id="alg1.l4.m1.3.3.3.cmml" xref="alg1.l4.m1.3.3.3">←</ci><apply id="alg1.l4.m1.3.3.4.cmml" xref="alg1.l4.m1.3.3.4"><csymbol cd="ambiguous" id="alg1.l4.m1.3.3.4.1.cmml" xref="alg1.l4.m1.3.3.4">subscript</csymbol><ci id="alg1.l4.m1.3.3.4.2.cmml" xref="alg1.l4.m1.3.3.4.2">𝜃</ci><ci id="alg1.l4.m1.3.3.4.3.cmml" xref="alg1.l4.m1.3.3.4.3">𝑘</ci></apply><apply id="alg1.l4.m1.3.3.2.cmml" xref="alg1.l4.m1.3.3.2"><minus id="alg1.l4.m1.3.3.2.3.cmml" xref="alg1.l4.m1.3.3.2.3"></minus><apply id="alg1.l4.m1.3.3.2.4.cmml" xref="alg1.l4.m1.3.3.2.4"><csymbol cd="ambiguous" id="alg1.l4.m1.3.3.2.4.1.cmml" xref="alg1.l4.m1.3.3.2.4">subscript</csymbol><ci id="alg1.l4.m1.3.3.2.4.2.cmml" xref="alg1.l4.m1.3.3.2.4.2">𝜃</ci><apply id="alg1.l4.m1.3.3.2.4.3.cmml" xref="alg1.l4.m1.3.3.2.4.3"><minus id="alg1.l4.m1.3.3.2.4.3.1.cmml" xref="alg1.l4.m1.3.3.2.4.3.1"></minus><ci id="alg1.l4.m1.3.3.2.4.3.2.cmml" xref="alg1.l4.m1.3.3.2.4.3.2">𝑘</ci><cn id="alg1.l4.m1.3.3.2.4.3.3.cmml" type="integer" xref="alg1.l4.m1.3.3.2.4.3.3">1</cn></apply></apply><apply id="alg1.l4.m1.3.3.2.2.cmml" xref="alg1.l4.m1.3.3.2.2"><times id="alg1.l4.m1.3.3.2.2.3.cmml" xref="alg1.l4.m1.3.3.2.2.3"></times><apply id="alg1.l4.m1.3.3.2.2.4.cmml" xref="alg1.l4.m1.3.3.2.2.4"><csymbol cd="ambiguous" id="alg1.l4.m1.3.3.2.2.4.1.cmml" xref="alg1.l4.m1.3.3.2.2.4">subscript</csymbol><ci id="alg1.l4.m1.3.3.2.2.4.2.cmml" xref="alg1.l4.m1.3.3.2.2.4.2">𝜂</ci><apply id="alg1.l4.m1.3.3.2.2.4.3.cmml" xref="alg1.l4.m1.3.3.2.2.4.3"><minus id="alg1.l4.m1.3.3.2.2.4.3.1.cmml" xref="alg1.l4.m1.3.3.2.2.4.3.1"></minus><ci id="alg1.l4.m1.3.3.2.2.4.3.2.cmml" xref="alg1.l4.m1.3.3.2.2.4.3.2">𝑘</ci><cn id="alg1.l4.m1.3.3.2.2.4.3.3.cmml" type="integer" xref="alg1.l4.m1.3.3.2.2.4.3.3">1</cn></apply></apply><apply id="alg1.l4.m1.3.3.2.2.5.cmml" xref="alg1.l4.m1.3.3.2.2.5"><ci id="alg1.l4.m1.3.3.2.2.5.1.cmml" xref="alg1.l4.m1.3.3.2.2.5.1">∇</ci><ci id="alg1.l4.m1.3.3.2.2.5.2.cmml" xref="alg1.l4.m1.3.3.2.2.5.2">ℒ</ci></apply><list id="alg1.l4.m1.3.3.2.2.2.3.cmml" xref="alg1.l4.m1.3.3.2.2.2.2"><ci id="alg1.l4.m1.1.1.cmml" xref="alg1.l4.m1.1.1">𝜃</ci><apply id="alg1.l4.m1.2.2.1.1.1.1.1.cmml" xref="alg1.l4.m1.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l4.m1.2.2.1.1.1.1.1.1.cmml" xref="alg1.l4.m1.2.2.1.1.1.1.1">superscript</csymbol><apply id="alg1.l4.m1.2.2.1.1.1.1.1.2.cmml" xref="alg1.l4.m1.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l4.m1.2.2.1.1.1.1.1.2.1.cmml" xref="alg1.l4.m1.2.2.1.1.1.1.1">subscript</csymbol><ci id="alg1.l4.m1.2.2.1.1.1.1.1.2.2.cmml" xref="alg1.l4.m1.2.2.1.1.1.1.1.2.2">𝐱</ci><cn id="alg1.l4.m1.2.2.1.1.1.1.1.2.3.cmml" type="integer" xref="alg1.l4.m1.2.2.1.1.1.1.1.2.3">0</cn></apply><ci id="alg1.l4.m1.2.2.1.1.1.1.1.3.cmml" xref="alg1.l4.m1.2.2.1.1.1.1.1.3">𝑤</ci></apply><apply id="alg1.l4.m1.3.3.2.2.2.2.2.cmml" xref="alg1.l4.m1.3.3.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l4.m1.3.3.2.2.2.2.2.1.cmml" xref="alg1.l4.m1.3.3.2.2.2.2.2">superscript</csymbol><apply id="alg1.l4.m1.3.3.2.2.2.2.2.2.cmml" xref="alg1.l4.m1.3.3.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l4.m1.3.3.2.2.2.2.2.2.1.cmml" xref="alg1.l4.m1.3.3.2.2.2.2.2">subscript</csymbol><ci id="alg1.l4.m1.3.3.2.2.2.2.2.2.2.cmml" xref="alg1.l4.m1.3.3.2.2.2.2.2.2.2">𝐱</ci><cn id="alg1.l4.m1.3.3.2.2.2.2.2.2.3.cmml" type="integer" xref="alg1.l4.m1.3.3.2.2.2.2.2.2.3">0</cn></apply><ci id="alg1.l4.m1.3.3.2.2.2.2.2.3.cmml" xref="alg1.l4.m1.3.3.2.2.2.2.2.3">ref</ci></apply></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m1.3c">\theta_{k}\leftarrow\theta_{k-1}-\eta_{k-1}\nabla\mathcal{L}(\theta;\mathbf{x}%
_{0}^{w},\mathbf{x}_{0}^{\rm ref})</annotation><annotation encoding="application/x-llamapun" id="alg1.l4.m1.3d">italic_θ start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ← italic_θ start_POSTSUBSCRIPT italic_k - 1 end_POSTSUBSCRIPT - italic_η start_POSTSUBSCRIPT italic_k - 1 end_POSTSUBSCRIPT ∇ caligraphic_L ( italic_θ ; bold_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_w end_POSTSUPERSCRIPT , bold_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT roman_ref end_POSTSUPERSCRIPT )</annotation></semantics></math>&nbsp;&nbsp;&nbsp;&nbsp;# Or other optimizer, e.g., AdamW.

</div>
<div class="ltx_listingline" id="alg1.l5">
<span class="ltx_tag ltx_tag_listingline">5:</span>&nbsp;&nbsp;<span class="ltx_text ltx_font_bold" id="alg1.l5.1">end for</span>
</div>
<div class="ltx_listingline" id="alg1.l5a">
<span class="ltx_tag ltx_tag_listingline">5:</span>&nbsp;&nbsp;<math alttext="{\theta_{K}}" class="ltx_Math" display="inline" id="alg1.l5a.m1.1"><semantics id="alg1.l5a.m1.1a"><msub id="alg1.l5a.m1.1.1" xref="alg1.l5a.m1.1.1.cmml"><mi id="alg1.l5a.m1.1.1.2" xref="alg1.l5a.m1.1.1.2.cmml">θ</mi><mi id="alg1.l5a.m1.1.1.3" xref="alg1.l5a.m1.1.1.3.cmml">K</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l5a.m1.1b"><apply id="alg1.l5a.m1.1.1.cmml" xref="alg1.l5a.m1.1.1"><csymbol cd="ambiguous" id="alg1.l5a.m1.1.1.1.cmml" xref="alg1.l5a.m1.1.1">subscript</csymbol><ci id="alg1.l5a.m1.1.1.2.cmml" xref="alg1.l5a.m1.1.1.2">𝜃</ci><ci id="alg1.l5a.m1.1.1.3.cmml" xref="alg1.l5a.m1.1.1.3">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5a.m1.1c">{\theta_{K}}</annotation><annotation encoding="application/x-llamapun" id="alg1.l5a.m1.1d">italic_θ start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT</annotation></semantics></math>
</div>
</div>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Anchor-based Adaptive Flipper for Preference Optimization</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.1">On the other hand, this type of demonstrated method faces a significant problem: When using generated reference images <math alttext="\mathbf{x}_{0}^{\rm ref}" class="ltx_Math" display="inline" id="S4.SS2.p1.1.m1.1"><semantics id="S4.SS2.p1.1.m1.1a"><msubsup id="S4.SS2.p1.1.m1.1.1" xref="S4.SS2.p1.1.m1.1.1.cmml"><mi id="S4.SS2.p1.1.m1.1.1.2.2" xref="S4.SS2.p1.1.m1.1.1.2.2.cmml">𝐱</mi><mn id="S4.SS2.p1.1.m1.1.1.2.3" xref="S4.SS2.p1.1.m1.1.1.2.3.cmml">0</mn><mi id="S4.SS2.p1.1.m1.1.1.3" xref="S4.SS2.p1.1.m1.1.1.3.cmml">ref</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.1.m1.1b"><apply id="S4.SS2.p1.1.m1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.1.m1.1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1">superscript</csymbol><apply id="S4.SS2.p1.1.m1.1.1.2.cmml" xref="S4.SS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.1.m1.1.1.2.1.cmml" xref="S4.SS2.p1.1.m1.1.1">subscript</csymbol><ci id="S4.SS2.p1.1.m1.1.1.2.2.cmml" xref="S4.SS2.p1.1.m1.1.1.2.2">𝐱</ci><cn id="S4.SS2.p1.1.m1.1.1.2.3.cmml" type="integer" xref="S4.SS2.p1.1.m1.1.1.2.3">0</cn></apply><ci id="S4.SS2.p1.1.m1.1.1.3.cmml" xref="S4.SS2.p1.1.m1.1.1.3">ref</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.1.m1.1c">\mathbf{x}_{0}^{\rm ref}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.1.m1.1d">bold_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT roman_ref end_POSTSUPERSCRIPT</annotation></semantics></math>, we cannot determine the relative relationship between the reference model and the current model (whether the reference image is better than the image generated by the current model or not). Existing methods, when using a reference model to generate reference samples, always directly assume that the reference samples have relatively poor quality. For example, DITTO assumes that the earlier checkpoints used as the reference model produce worse-performing samples. However, as shown in the experiment in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.05255v1#S4.F2" title="Figure 2 ‣ 4.1 Iterative Alignment from Semi-policy Preference Optimization ‣ 4 Iterative Alignment for Diffusion Models ‣ SePPO: Semi-Policy Preference Optimization for Diffusion Alignment"><span class="ltx_text ltx_ref_tag">2</span></a>, the reference model is not always inferior to the current model.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS2.p2">
<p class="ltx_p" id="S4.SS2.p2.7">Specifically, based on the DPO-style optimization method, we analyze the change in gradient updates when the reference image is <span class="ltx_text ltx_font_bold" id="S4.SS2.p2.7.1">better</span> than the image generated by the current model. The gradient of the loss function in equation&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.05255v1#S4.E6" title="Equation 6 ‣ 4.1 Iterative Alignment from Semi-policy Preference Optimization ‣ 4 Iterative Alignment for Diffusion Models ‣ SePPO: Semi-Policy Preference Optimization for Diffusion Alignment"><span class="ltx_text ltx_ref_tag">6</span></a> is</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equationgroup ltx_eqn_table" id="S4.E7">
<tbody>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S4.E7X">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\nabla\mathcal{L}(\theta;\mathbf{x}_{0}^{w},\mathbf{x}_{0}^{\rm
ref%
})~{}=~{}\mathop{\mathbb{E}}_{\epsilon^{w},\epsilon^{\rm ref},t}\Big{[}" class="ltx_math_unparsed" display="inline" id="S4.E7X.2.1.1.m1.4"><semantics id="S4.E7X.2.1.1.m1.4a"><mrow id="S4.E7X.2.1.1.m1.4b"><mo id="S4.E7X.2.1.1.m1.4.5" rspace="0.167em">∇</mo><mi class="ltx_font_mathcaligraphic" id="S4.E7X.2.1.1.m1.4.6">ℒ</mi><mrow id="S4.E7X.2.1.1.m1.4.7"><mo id="S4.E7X.2.1.1.m1.4.7.1" stretchy="false">(</mo><mi id="S4.E7X.2.1.1.m1.4.4">θ</mi><mo id="S4.E7X.2.1.1.m1.4.7.2">;</mo><msubsup id="S4.E7X.2.1.1.m1.4.7.3"><mi id="S4.E7X.2.1.1.m1.4.7.3.2.2">𝐱</mi><mn id="S4.E7X.2.1.1.m1.4.7.3.2.3">0</mn><mi id="S4.E7X.2.1.1.m1.4.7.3.3">w</mi></msubsup><mo id="S4.E7X.2.1.1.m1.4.7.4">,</mo><msubsup id="S4.E7X.2.1.1.m1.4.7.5"><mi id="S4.E7X.2.1.1.m1.4.7.5.2.2">𝐱</mi><mn id="S4.E7X.2.1.1.m1.4.7.5.2.3">0</mn><mi id="S4.E7X.2.1.1.m1.4.7.5.3">ref</mi></msubsup><mo id="S4.E7X.2.1.1.m1.4.7.6" rspace="0.330em" stretchy="false">)</mo></mrow><mo id="S4.E7X.2.1.1.m1.4.8" rspace="0.330em">=</mo><munder id="S4.E7X.2.1.1.m1.4.9"><mo id="S4.E7X.2.1.1.m1.4.9.2" movablelimits="false" rspace="0em">𝔼</mo><mrow id="S4.E7X.2.1.1.m1.3.3.3.3"><msup id="S4.E7X.2.1.1.m1.2.2.2.2.1"><mi id="S4.E7X.2.1.1.m1.2.2.2.2.1.2">ϵ</mi><mi id="S4.E7X.2.1.1.m1.2.2.2.2.1.3">w</mi></msup><mo id="S4.E7X.2.1.1.m1.3.3.3.3.3">,</mo><msup id="S4.E7X.2.1.1.m1.3.3.3.3.2"><mi id="S4.E7X.2.1.1.m1.3.3.3.3.2.2">ϵ</mi><mi id="S4.E7X.2.1.1.m1.3.3.3.3.2.3">ref</mi></msup><mo id="S4.E7X.2.1.1.m1.3.3.3.3.4">,</mo><mi id="S4.E7X.2.1.1.m1.1.1.1.1">t</mi></mrow></munder><mo id="S4.E7X.2.1.1.m1.4.10" maxsize="160%" minsize="160%">[</mo></mrow><annotation encoding="application/x-tex" id="S4.E7X.2.1.1.m1.4c">\displaystyle\nabla\mathcal{L}(\theta;\mathbf{x}_{0}^{w},\mathbf{x}_{0}^{\rm
ref%
})~{}=~{}\mathop{\mathbb{E}}_{\epsilon^{w},\epsilon^{\rm ref},t}\Big{[}</annotation><annotation encoding="application/x-llamapun" id="S4.E7X.2.1.1.m1.4d">∇ caligraphic_L ( italic_θ ; bold_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_w end_POSTSUPERSCRIPT , bold_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT roman_ref end_POSTSUPERSCRIPT ) = blackboard_E start_POSTSUBSCRIPT italic_ϵ start_POSTSUPERSCRIPT italic_w end_POSTSUPERSCRIPT , italic_ϵ start_POSTSUPERSCRIPT roman_ref end_POSTSUPERSCRIPT , italic_t end_POSTSUBSCRIPT [</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle-2\beta Tw_{t}{\sigma}\Big{(}-\beta Tw_{t}(\hat{\sigma}_{\rm ref}%
^{2}-\hat{\sigma}_{w}^{2})\Big{)}\underbrace{\Big{(}\epsilon_{\theta}(\mathbf{%
x}_{t}^{w})-\mathbf{\epsilon}^{w}-\epsilon_{\theta}(\mathbf{x}_{t}^{\rm ref})+%
\mathbf{\epsilon}^{\rm ref}\Big{)}}_{\text{error term}}\Big{]}," class="ltx_math_unparsed" display="inline" id="S4.E7X.3.2.2.m1.1"><semantics id="S4.E7X.3.2.2.m1.1a"><mrow id="S4.E7X.3.2.2.m1.1b"><mo id="S4.E7X.3.2.2.m1.1.2">−</mo><mn id="S4.E7X.3.2.2.m1.1.3">2</mn><mi id="S4.E7X.3.2.2.m1.1.4">β</mi><mi id="S4.E7X.3.2.2.m1.1.5">T</mi><msub id="S4.E7X.3.2.2.m1.1.6"><mi id="S4.E7X.3.2.2.m1.1.6.2">w</mi><mi id="S4.E7X.3.2.2.m1.1.6.3">t</mi></msub><mi id="S4.E7X.3.2.2.m1.1.7">σ</mi><mrow id="S4.E7X.3.2.2.m1.1.8"><mo id="S4.E7X.3.2.2.m1.1.8.1" maxsize="160%" minsize="160%">(</mo><mo id="S4.E7X.3.2.2.m1.1.8.2" lspace="0em">−</mo><mi id="S4.E7X.3.2.2.m1.1.8.3">β</mi><mi id="S4.E7X.3.2.2.m1.1.8.4">T</mi><msub id="S4.E7X.3.2.2.m1.1.8.5"><mi id="S4.E7X.3.2.2.m1.1.8.5.2">w</mi><mi id="S4.E7X.3.2.2.m1.1.8.5.3">t</mi></msub><mrow id="S4.E7X.3.2.2.m1.1.8.6"><mo id="S4.E7X.3.2.2.m1.1.8.6.1" stretchy="false">(</mo><msubsup id="S4.E7X.3.2.2.m1.1.8.6.2"><mover accent="true" id="S4.E7X.3.2.2.m1.1.8.6.2.2.2"><mi id="S4.E7X.3.2.2.m1.1.8.6.2.2.2.2">σ</mi><mo id="S4.E7X.3.2.2.m1.1.8.6.2.2.2.1">^</mo></mover><mi id="S4.E7X.3.2.2.m1.1.8.6.2.2.3">ref</mi><mn id="S4.E7X.3.2.2.m1.1.8.6.2.3">2</mn></msubsup><mo id="S4.E7X.3.2.2.m1.1.8.6.3">−</mo><msubsup id="S4.E7X.3.2.2.m1.1.8.6.4"><mover accent="true" id="S4.E7X.3.2.2.m1.1.8.6.4.2.2"><mi id="S4.E7X.3.2.2.m1.1.8.6.4.2.2.2">σ</mi><mo id="S4.E7X.3.2.2.m1.1.8.6.4.2.2.1">^</mo></mover><mi id="S4.E7X.3.2.2.m1.1.8.6.4.2.3">w</mi><mn id="S4.E7X.3.2.2.m1.1.8.6.4.3">2</mn></msubsup><mo id="S4.E7X.3.2.2.m1.1.8.6.5" stretchy="false">)</mo></mrow><mo id="S4.E7X.3.2.2.m1.1.8.7" maxsize="160%" minsize="160%">)</mo></mrow><munder id="S4.E7X.3.2.2.m1.1.9"><munder accentunder="true" id="S4.E7X.3.2.2.m1.1.1"><mrow id="S4.E7X.3.2.2.m1.1.1.1.1"><mo id="S4.E7X.3.2.2.m1.1.1.1.1.2" maxsize="160%" minsize="160%">(</mo><mrow id="S4.E7X.3.2.2.m1.1.1.1.1.1"><mrow id="S4.E7X.3.2.2.m1.1.1.1.1.1.2"><mrow id="S4.E7X.3.2.2.m1.1.1.1.1.1.1.1"><msub id="S4.E7X.3.2.2.m1.1.1.1.1.1.1.1.3"><mi id="S4.E7X.3.2.2.m1.1.1.1.1.1.1.1.3.2">ϵ</mi><mi id="S4.E7X.3.2.2.m1.1.1.1.1.1.1.1.3.3">θ</mi></msub><mo id="S4.E7X.3.2.2.m1.1.1.1.1.1.1.1.2">⁢</mo><mrow id="S4.E7X.3.2.2.m1.1.1.1.1.1.1.1.1.1"><mo id="S4.E7X.3.2.2.m1.1.1.1.1.1.1.1.1.1.2" stretchy="false">(</mo><msubsup id="S4.E7X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1"><mi id="S4.E7X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.2.2">𝐱</mi><mi id="S4.E7X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.2.3">t</mi><mi id="S4.E7X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.3">w</mi></msubsup><mo id="S4.E7X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3" stretchy="false">)</mo></mrow></mrow><mo id="S4.E7X.3.2.2.m1.1.1.1.1.1.2.3">−</mo><msup id="S4.E7X.3.2.2.m1.1.1.1.1.1.2.4"><mi id="S4.E7X.3.2.2.m1.1.1.1.1.1.2.4.2">ϵ</mi><mi id="S4.E7X.3.2.2.m1.1.1.1.1.1.2.4.3">w</mi></msup><mo id="S4.E7X.3.2.2.m1.1.1.1.1.1.2.3a">−</mo><mrow id="S4.E7X.3.2.2.m1.1.1.1.1.1.2.2"><msub id="S4.E7X.3.2.2.m1.1.1.1.1.1.2.2.3"><mi id="S4.E7X.3.2.2.m1.1.1.1.1.1.2.2.3.2">ϵ</mi><mi id="S4.E7X.3.2.2.m1.1.1.1.1.1.2.2.3.3">θ</mi></msub><mo id="S4.E7X.3.2.2.m1.1.1.1.1.1.2.2.2">⁢</mo><mrow id="S4.E7X.3.2.2.m1.1.1.1.1.1.2.2.1.1"><mo id="S4.E7X.3.2.2.m1.1.1.1.1.1.2.2.1.1.2" stretchy="false">(</mo><msubsup id="S4.E7X.3.2.2.m1.1.1.1.1.1.2.2.1.1.1"><mi id="S4.E7X.3.2.2.m1.1.1.1.1.1.2.2.1.1.1.2.2">𝐱</mi><mi id="S4.E7X.3.2.2.m1.1.1.1.1.1.2.2.1.1.1.2.3">t</mi><mi id="S4.E7X.3.2.2.m1.1.1.1.1.1.2.2.1.1.1.3">ref</mi></msubsup><mo id="S4.E7X.3.2.2.m1.1.1.1.1.1.2.2.1.1.3" stretchy="false">)</mo></mrow></mrow></mrow><mo id="S4.E7X.3.2.2.m1.1.1.1.1.1.3">+</mo><msup id="S4.E7X.3.2.2.m1.1.1.1.1.1.4"><mi id="S4.E7X.3.2.2.m1.1.1.1.1.1.4.2">ϵ</mi><mi id="S4.E7X.3.2.2.m1.1.1.1.1.1.4.3">ref</mi></msup></mrow><mo id="S4.E7X.3.2.2.m1.1.1.1.1.3" maxsize="160%" minsize="160%">)</mo></mrow><mo id="S4.E7X.3.2.2.m1.1.1.2">⏟</mo></munder><mtext id="S4.E7X.3.2.2.m1.1.9.2">error term</mtext></munder><mo id="S4.E7X.3.2.2.m1.1.10" maxsize="160%" minsize="160%">]</mo><mo id="S4.E7X.3.2.2.m1.1.11">,</mo></mrow><annotation encoding="application/x-tex" id="S4.E7X.3.2.2.m1.1c">\displaystyle-2\beta Tw_{t}{\sigma}\Big{(}-\beta Tw_{t}(\hat{\sigma}_{\rm ref}%
^{2}-\hat{\sigma}_{w}^{2})\Big{)}\underbrace{\Big{(}\epsilon_{\theta}(\mathbf{%
x}_{t}^{w})-\mathbf{\epsilon}^{w}-\epsilon_{\theta}(\mathbf{x}_{t}^{\rm ref})+%
\mathbf{\epsilon}^{\rm ref}\Big{)}}_{\text{error term}}\Big{]},</annotation><annotation encoding="application/x-llamapun" id="S4.E7X.3.2.2.m1.1d">- 2 italic_β italic_T italic_w start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT italic_σ ( - italic_β italic_T italic_w start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( over^ start_ARG italic_σ end_ARG start_POSTSUBSCRIPT roman_ref end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT - over^ start_ARG italic_σ end_ARG start_POSTSUBSCRIPT italic_w end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ) ) under⏟ start_ARG ( italic_ϵ start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( bold_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_w end_POSTSUPERSCRIPT ) - italic_ϵ start_POSTSUPERSCRIPT italic_w end_POSTSUPERSCRIPT - italic_ϵ start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( bold_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT roman_ref end_POSTSUPERSCRIPT ) + italic_ϵ start_POSTSUPERSCRIPT roman_ref end_POSTSUPERSCRIPT ) end_ARG start_POSTSUBSCRIPT error term end_POSTSUBSCRIPT ] ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(7)</span></td>
</tr>
</tbody>
</table>
<p class="ltx_p" id="S4.SS2.p2.6">where <math alttext="\hat{\sigma}_{w}^{2}\coloneqq\|\epsilon_{\theta}(\mathbf{x}_{t}^{w})-\mathbf{%
\epsilon}^{w}\|^{2}-\|\epsilon_{\rm ref}(\mathbf{x}_{t}^{w})-\mathbf{\epsilon}%
^{w}\|^{2}" class="ltx_Math" display="inline" id="S4.SS2.p2.1.m1.2"><semantics id="S4.SS2.p2.1.m1.2a"><mrow id="S4.SS2.p2.1.m1.2.2" xref="S4.SS2.p2.1.m1.2.2.cmml"><msubsup id="S4.SS2.p2.1.m1.2.2.4" xref="S4.SS2.p2.1.m1.2.2.4.cmml"><mover accent="true" id="S4.SS2.p2.1.m1.2.2.4.2.2" xref="S4.SS2.p2.1.m1.2.2.4.2.2.cmml"><mi id="S4.SS2.p2.1.m1.2.2.4.2.2.2" xref="S4.SS2.p2.1.m1.2.2.4.2.2.2.cmml">σ</mi><mo id="S4.SS2.p2.1.m1.2.2.4.2.2.1" xref="S4.SS2.p2.1.m1.2.2.4.2.2.1.cmml">^</mo></mover><mi id="S4.SS2.p2.1.m1.2.2.4.2.3" xref="S4.SS2.p2.1.m1.2.2.4.2.3.cmml">w</mi><mn id="S4.SS2.p2.1.m1.2.2.4.3" xref="S4.SS2.p2.1.m1.2.2.4.3.cmml">2</mn></msubsup><mo id="S4.SS2.p2.1.m1.2.2.3" xref="S4.SS2.p2.1.m1.2.2.3.cmml">≔</mo><mrow id="S4.SS2.p2.1.m1.2.2.2" xref="S4.SS2.p2.1.m1.2.2.2.cmml"><msup id="S4.SS2.p2.1.m1.1.1.1.1" xref="S4.SS2.p2.1.m1.1.1.1.1.cmml"><mrow id="S4.SS2.p2.1.m1.1.1.1.1.1.1" xref="S4.SS2.p2.1.m1.1.1.1.1.1.2.cmml"><mo id="S4.SS2.p2.1.m1.1.1.1.1.1.1.2" stretchy="false" xref="S4.SS2.p2.1.m1.1.1.1.1.1.2.1.cmml">‖</mo><mrow id="S4.SS2.p2.1.m1.1.1.1.1.1.1.1" xref="S4.SS2.p2.1.m1.1.1.1.1.1.1.1.cmml"><mrow id="S4.SS2.p2.1.m1.1.1.1.1.1.1.1.1" xref="S4.SS2.p2.1.m1.1.1.1.1.1.1.1.1.cmml"><msub id="S4.SS2.p2.1.m1.1.1.1.1.1.1.1.1.3" xref="S4.SS2.p2.1.m1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.SS2.p2.1.m1.1.1.1.1.1.1.1.1.3.2" xref="S4.SS2.p2.1.m1.1.1.1.1.1.1.1.1.3.2.cmml">ϵ</mi><mi id="S4.SS2.p2.1.m1.1.1.1.1.1.1.1.1.3.3" xref="S4.SS2.p2.1.m1.1.1.1.1.1.1.1.1.3.3.cmml">θ</mi></msub><mo id="S4.SS2.p2.1.m1.1.1.1.1.1.1.1.1.2" xref="S4.SS2.p2.1.m1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.SS2.p2.1.m1.1.1.1.1.1.1.1.1.1.1" xref="S4.SS2.p2.1.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.SS2.p2.1.m1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.SS2.p2.1.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="S4.SS2.p2.1.m1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.SS2.p2.1.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.SS2.p2.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S4.SS2.p2.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">𝐱</mi><mi id="S4.SS2.p2.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S4.SS2.p2.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">t</mi><mi id="S4.SS2.p2.1.m1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.SS2.p2.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">w</mi></msubsup><mo id="S4.SS2.p2.1.m1.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.SS2.p2.1.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.SS2.p2.1.m1.1.1.1.1.1.1.1.2" xref="S4.SS2.p2.1.m1.1.1.1.1.1.1.1.2.cmml">−</mo><msup id="S4.SS2.p2.1.m1.1.1.1.1.1.1.1.3" xref="S4.SS2.p2.1.m1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.SS2.p2.1.m1.1.1.1.1.1.1.1.3.2" xref="S4.SS2.p2.1.m1.1.1.1.1.1.1.1.3.2.cmml">ϵ</mi><mi id="S4.SS2.p2.1.m1.1.1.1.1.1.1.1.3.3" xref="S4.SS2.p2.1.m1.1.1.1.1.1.1.1.3.3.cmml">w</mi></msup></mrow><mo id="S4.SS2.p2.1.m1.1.1.1.1.1.1.3" stretchy="false" xref="S4.SS2.p2.1.m1.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S4.SS2.p2.1.m1.1.1.1.1.3" xref="S4.SS2.p2.1.m1.1.1.1.1.3.cmml">2</mn></msup><mo id="S4.SS2.p2.1.m1.2.2.2.3" xref="S4.SS2.p2.1.m1.2.2.2.3.cmml">−</mo><msup id="S4.SS2.p2.1.m1.2.2.2.2" xref="S4.SS2.p2.1.m1.2.2.2.2.cmml"><mrow id="S4.SS2.p2.1.m1.2.2.2.2.1.1" xref="S4.SS2.p2.1.m1.2.2.2.2.1.2.cmml"><mo id="S4.SS2.p2.1.m1.2.2.2.2.1.1.2" stretchy="false" xref="S4.SS2.p2.1.m1.2.2.2.2.1.2.1.cmml">‖</mo><mrow id="S4.SS2.p2.1.m1.2.2.2.2.1.1.1" xref="S4.SS2.p2.1.m1.2.2.2.2.1.1.1.cmml"><mrow id="S4.SS2.p2.1.m1.2.2.2.2.1.1.1.1" xref="S4.SS2.p2.1.m1.2.2.2.2.1.1.1.1.cmml"><msub id="S4.SS2.p2.1.m1.2.2.2.2.1.1.1.1.3" xref="S4.SS2.p2.1.m1.2.2.2.2.1.1.1.1.3.cmml"><mi id="S4.SS2.p2.1.m1.2.2.2.2.1.1.1.1.3.2" xref="S4.SS2.p2.1.m1.2.2.2.2.1.1.1.1.3.2.cmml">ϵ</mi><mi id="S4.SS2.p2.1.m1.2.2.2.2.1.1.1.1.3.3" xref="S4.SS2.p2.1.m1.2.2.2.2.1.1.1.1.3.3.cmml">ref</mi></msub><mo id="S4.SS2.p2.1.m1.2.2.2.2.1.1.1.1.2" xref="S4.SS2.p2.1.m1.2.2.2.2.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.SS2.p2.1.m1.2.2.2.2.1.1.1.1.1.1" xref="S4.SS2.p2.1.m1.2.2.2.2.1.1.1.1.1.1.1.cmml"><mo id="S4.SS2.p2.1.m1.2.2.2.2.1.1.1.1.1.1.2" stretchy="false" xref="S4.SS2.p2.1.m1.2.2.2.2.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="S4.SS2.p2.1.m1.2.2.2.2.1.1.1.1.1.1.1" xref="S4.SS2.p2.1.m1.2.2.2.2.1.1.1.1.1.1.1.cmml"><mi id="S4.SS2.p2.1.m1.2.2.2.2.1.1.1.1.1.1.1.2.2" xref="S4.SS2.p2.1.m1.2.2.2.2.1.1.1.1.1.1.1.2.2.cmml">𝐱</mi><mi id="S4.SS2.p2.1.m1.2.2.2.2.1.1.1.1.1.1.1.2.3" xref="S4.SS2.p2.1.m1.2.2.2.2.1.1.1.1.1.1.1.2.3.cmml">t</mi><mi id="S4.SS2.p2.1.m1.2.2.2.2.1.1.1.1.1.1.1.3" xref="S4.SS2.p2.1.m1.2.2.2.2.1.1.1.1.1.1.1.3.cmml">w</mi></msubsup><mo id="S4.SS2.p2.1.m1.2.2.2.2.1.1.1.1.1.1.3" stretchy="false" xref="S4.SS2.p2.1.m1.2.2.2.2.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.SS2.p2.1.m1.2.2.2.2.1.1.1.2" xref="S4.SS2.p2.1.m1.2.2.2.2.1.1.1.2.cmml">−</mo><msup id="S4.SS2.p2.1.m1.2.2.2.2.1.1.1.3" xref="S4.SS2.p2.1.m1.2.2.2.2.1.1.1.3.cmml"><mi id="S4.SS2.p2.1.m1.2.2.2.2.1.1.1.3.2" xref="S4.SS2.p2.1.m1.2.2.2.2.1.1.1.3.2.cmml">ϵ</mi><mi id="S4.SS2.p2.1.m1.2.2.2.2.1.1.1.3.3" xref="S4.SS2.p2.1.m1.2.2.2.2.1.1.1.3.3.cmml">w</mi></msup></mrow><mo id="S4.SS2.p2.1.m1.2.2.2.2.1.1.3" stretchy="false" xref="S4.SS2.p2.1.m1.2.2.2.2.1.2.1.cmml">‖</mo></mrow><mn id="S4.SS2.p2.1.m1.2.2.2.2.3" xref="S4.SS2.p2.1.m1.2.2.2.2.3.cmml">2</mn></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.1.m1.2b"><apply id="S4.SS2.p2.1.m1.2.2.cmml" xref="S4.SS2.p2.1.m1.2.2"><ci id="S4.SS2.p2.1.m1.2.2.3.cmml" xref="S4.SS2.p2.1.m1.2.2.3">≔</ci><apply id="S4.SS2.p2.1.m1.2.2.4.cmml" xref="S4.SS2.p2.1.m1.2.2.4"><csymbol cd="ambiguous" id="S4.SS2.p2.1.m1.2.2.4.1.cmml" xref="S4.SS2.p2.1.m1.2.2.4">superscript</csymbol><apply id="S4.SS2.p2.1.m1.2.2.4.2.cmml" xref="S4.SS2.p2.1.m1.2.2.4"><csymbol cd="ambiguous" id="S4.SS2.p2.1.m1.2.2.4.2.1.cmml" xref="S4.SS2.p2.1.m1.2.2.4">subscript</csymbol><apply id="S4.SS2.p2.1.m1.2.2.4.2.2.cmml" xref="S4.SS2.p2.1.m1.2.2.4.2.2"><ci id="S4.SS2.p2.1.m1.2.2.4.2.2.1.cmml" xref="S4.SS2.p2.1.m1.2.2.4.2.2.1">^</ci><ci id="S4.SS2.p2.1.m1.2.2.4.2.2.2.cmml" xref="S4.SS2.p2.1.m1.2.2.4.2.2.2">𝜎</ci></apply><ci id="S4.SS2.p2.1.m1.2.2.4.2.3.cmml" xref="S4.SS2.p2.1.m1.2.2.4.2.3">𝑤</ci></apply><cn id="S4.SS2.p2.1.m1.2.2.4.3.cmml" type="integer" xref="S4.SS2.p2.1.m1.2.2.4.3">2</cn></apply><apply id="S4.SS2.p2.1.m1.2.2.2.cmml" xref="S4.SS2.p2.1.m1.2.2.2"><minus id="S4.SS2.p2.1.m1.2.2.2.3.cmml" xref="S4.SS2.p2.1.m1.2.2.2.3"></minus><apply id="S4.SS2.p2.1.m1.1.1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.1.m1.1.1.1.1.2.cmml" xref="S4.SS2.p2.1.m1.1.1.1.1">superscript</csymbol><apply id="S4.SS2.p2.1.m1.1.1.1.1.1.2.cmml" xref="S4.SS2.p2.1.m1.1.1.1.1.1.1"><csymbol cd="latexml" id="S4.SS2.p2.1.m1.1.1.1.1.1.2.1.cmml" xref="S4.SS2.p2.1.m1.1.1.1.1.1.1.2">norm</csymbol><apply id="S4.SS2.p2.1.m1.1.1.1.1.1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1.1.1.1.1.1"><minus id="S4.SS2.p2.1.m1.1.1.1.1.1.1.1.2.cmml" xref="S4.SS2.p2.1.m1.1.1.1.1.1.1.1.2"></minus><apply id="S4.SS2.p2.1.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1.1.1.1.1.1.1"><times id="S4.SS2.p2.1.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.SS2.p2.1.m1.1.1.1.1.1.1.1.1.2"></times><apply id="S4.SS2.p2.1.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.SS2.p2.1.m1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p2.1.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.SS2.p2.1.m1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.SS2.p2.1.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.SS2.p2.1.m1.1.1.1.1.1.1.1.1.3.2">italic-ϵ</ci><ci id="S4.SS2.p2.1.m1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.SS2.p2.1.m1.1.1.1.1.1.1.1.1.3.3">𝜃</ci></apply><apply id="S4.SS2.p2.1.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S4.SS2.p2.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.SS2.p2.1.m1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.SS2.p2.1.m1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.SS2.p2.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.SS2.p2.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2">𝐱</ci><ci id="S4.SS2.p2.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.SS2.p2.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.3">𝑡</ci></apply><ci id="S4.SS2.p2.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.SS2.p2.1.m1.1.1.1.1.1.1.1.1.1.1.1.3">𝑤</ci></apply></apply><apply id="S4.SS2.p2.1.m1.1.1.1.1.1.1.1.3.cmml" xref="S4.SS2.p2.1.m1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p2.1.m1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.SS2.p2.1.m1.1.1.1.1.1.1.1.3">superscript</csymbol><ci id="S4.SS2.p2.1.m1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.SS2.p2.1.m1.1.1.1.1.1.1.1.3.2">italic-ϵ</ci><ci id="S4.SS2.p2.1.m1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.SS2.p2.1.m1.1.1.1.1.1.1.1.3.3">𝑤</ci></apply></apply></apply><cn id="S4.SS2.p2.1.m1.1.1.1.1.3.cmml" type="integer" xref="S4.SS2.p2.1.m1.1.1.1.1.3">2</cn></apply><apply id="S4.SS2.p2.1.m1.2.2.2.2.cmml" xref="S4.SS2.p2.1.m1.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS2.p2.1.m1.2.2.2.2.2.cmml" xref="S4.SS2.p2.1.m1.2.2.2.2">superscript</csymbol><apply id="S4.SS2.p2.1.m1.2.2.2.2.1.2.cmml" xref="S4.SS2.p2.1.m1.2.2.2.2.1.1"><csymbol cd="latexml" id="S4.SS2.p2.1.m1.2.2.2.2.1.2.1.cmml" xref="S4.SS2.p2.1.m1.2.2.2.2.1.1.2">norm</csymbol><apply id="S4.SS2.p2.1.m1.2.2.2.2.1.1.1.cmml" xref="S4.SS2.p2.1.m1.2.2.2.2.1.1.1"><minus id="S4.SS2.p2.1.m1.2.2.2.2.1.1.1.2.cmml" xref="S4.SS2.p2.1.m1.2.2.2.2.1.1.1.2"></minus><apply id="S4.SS2.p2.1.m1.2.2.2.2.1.1.1.1.cmml" xref="S4.SS2.p2.1.m1.2.2.2.2.1.1.1.1"><times id="S4.SS2.p2.1.m1.2.2.2.2.1.1.1.1.2.cmml" xref="S4.SS2.p2.1.m1.2.2.2.2.1.1.1.1.2"></times><apply id="S4.SS2.p2.1.m1.2.2.2.2.1.1.1.1.3.cmml" xref="S4.SS2.p2.1.m1.2.2.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p2.1.m1.2.2.2.2.1.1.1.1.3.1.cmml" xref="S4.SS2.p2.1.m1.2.2.2.2.1.1.1.1.3">subscript</csymbol><ci id="S4.SS2.p2.1.m1.2.2.2.2.1.1.1.1.3.2.cmml" xref="S4.SS2.p2.1.m1.2.2.2.2.1.1.1.1.3.2">italic-ϵ</ci><ci id="S4.SS2.p2.1.m1.2.2.2.2.1.1.1.1.3.3.cmml" xref="S4.SS2.p2.1.m1.2.2.2.2.1.1.1.1.3.3">ref</ci></apply><apply id="S4.SS2.p2.1.m1.2.2.2.2.1.1.1.1.1.1.1.cmml" xref="S4.SS2.p2.1.m1.2.2.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.1.m1.2.2.2.2.1.1.1.1.1.1.1.1.cmml" xref="S4.SS2.p2.1.m1.2.2.2.2.1.1.1.1.1.1">superscript</csymbol><apply id="S4.SS2.p2.1.m1.2.2.2.2.1.1.1.1.1.1.1.2.cmml" xref="S4.SS2.p2.1.m1.2.2.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.1.m1.2.2.2.2.1.1.1.1.1.1.1.2.1.cmml" xref="S4.SS2.p2.1.m1.2.2.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="S4.SS2.p2.1.m1.2.2.2.2.1.1.1.1.1.1.1.2.2.cmml" xref="S4.SS2.p2.1.m1.2.2.2.2.1.1.1.1.1.1.1.2.2">𝐱</ci><ci id="S4.SS2.p2.1.m1.2.2.2.2.1.1.1.1.1.1.1.2.3.cmml" xref="S4.SS2.p2.1.m1.2.2.2.2.1.1.1.1.1.1.1.2.3">𝑡</ci></apply><ci id="S4.SS2.p2.1.m1.2.2.2.2.1.1.1.1.1.1.1.3.cmml" xref="S4.SS2.p2.1.m1.2.2.2.2.1.1.1.1.1.1.1.3">𝑤</ci></apply></apply><apply id="S4.SS2.p2.1.m1.2.2.2.2.1.1.1.3.cmml" xref="S4.SS2.p2.1.m1.2.2.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p2.1.m1.2.2.2.2.1.1.1.3.1.cmml" xref="S4.SS2.p2.1.m1.2.2.2.2.1.1.1.3">superscript</csymbol><ci id="S4.SS2.p2.1.m1.2.2.2.2.1.1.1.3.2.cmml" xref="S4.SS2.p2.1.m1.2.2.2.2.1.1.1.3.2">italic-ϵ</ci><ci id="S4.SS2.p2.1.m1.2.2.2.2.1.1.1.3.3.cmml" xref="S4.SS2.p2.1.m1.2.2.2.2.1.1.1.3.3">𝑤</ci></apply></apply></apply><cn id="S4.SS2.p2.1.m1.2.2.2.2.3.cmml" type="integer" xref="S4.SS2.p2.1.m1.2.2.2.2.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.1.m1.2c">\hat{\sigma}_{w}^{2}\coloneqq\|\epsilon_{\theta}(\mathbf{x}_{t}^{w})-\mathbf{%
\epsilon}^{w}\|^{2}-\|\epsilon_{\rm ref}(\mathbf{x}_{t}^{w})-\mathbf{\epsilon}%
^{w}\|^{2}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.1.m1.2d">over^ start_ARG italic_σ end_ARG start_POSTSUBSCRIPT italic_w end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ≔ ∥ italic_ϵ start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( bold_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_w end_POSTSUPERSCRIPT ) - italic_ϵ start_POSTSUPERSCRIPT italic_w end_POSTSUPERSCRIPT ∥ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT - ∥ italic_ϵ start_POSTSUBSCRIPT roman_ref end_POSTSUBSCRIPT ( bold_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_w end_POSTSUPERSCRIPT ) - italic_ϵ start_POSTSUPERSCRIPT italic_w end_POSTSUPERSCRIPT ∥ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="\hat{\sigma}_{\rm ref}^{2}\coloneqq\|\epsilon_{\theta}(\mathbf{x}_{t}^{\rm ref%
})-\mathbf{\epsilon}^{\rm ref}\|^{2}-\|\epsilon_{\rm ref}(\mathbf{x}_{t}^{\rm
ref%
})-\mathbf{\epsilon}^{\rm ref}\|^{2}" class="ltx_Math" display="inline" id="S4.SS2.p2.2.m2.2"><semantics id="S4.SS2.p2.2.m2.2a"><mrow id="S4.SS2.p2.2.m2.2.2" xref="S4.SS2.p2.2.m2.2.2.cmml"><msubsup id="S4.SS2.p2.2.m2.2.2.4" xref="S4.SS2.p2.2.m2.2.2.4.cmml"><mover accent="true" id="S4.SS2.p2.2.m2.2.2.4.2.2" xref="S4.SS2.p2.2.m2.2.2.4.2.2.cmml"><mi id="S4.SS2.p2.2.m2.2.2.4.2.2.2" xref="S4.SS2.p2.2.m2.2.2.4.2.2.2.cmml">σ</mi><mo id="S4.SS2.p2.2.m2.2.2.4.2.2.1" xref="S4.SS2.p2.2.m2.2.2.4.2.2.1.cmml">^</mo></mover><mi id="S4.SS2.p2.2.m2.2.2.4.2.3" xref="S4.SS2.p2.2.m2.2.2.4.2.3.cmml">ref</mi><mn id="S4.SS2.p2.2.m2.2.2.4.3" xref="S4.SS2.p2.2.m2.2.2.4.3.cmml">2</mn></msubsup><mo id="S4.SS2.p2.2.m2.2.2.3" xref="S4.SS2.p2.2.m2.2.2.3.cmml">≔</mo><mrow id="S4.SS2.p2.2.m2.2.2.2" xref="S4.SS2.p2.2.m2.2.2.2.cmml"><msup id="S4.SS2.p2.2.m2.1.1.1.1" xref="S4.SS2.p2.2.m2.1.1.1.1.cmml"><mrow id="S4.SS2.p2.2.m2.1.1.1.1.1.1" xref="S4.SS2.p2.2.m2.1.1.1.1.1.2.cmml"><mo id="S4.SS2.p2.2.m2.1.1.1.1.1.1.2" stretchy="false" xref="S4.SS2.p2.2.m2.1.1.1.1.1.2.1.cmml">‖</mo><mrow id="S4.SS2.p2.2.m2.1.1.1.1.1.1.1" xref="S4.SS2.p2.2.m2.1.1.1.1.1.1.1.cmml"><mrow id="S4.SS2.p2.2.m2.1.1.1.1.1.1.1.1" xref="S4.SS2.p2.2.m2.1.1.1.1.1.1.1.1.cmml"><msub id="S4.SS2.p2.2.m2.1.1.1.1.1.1.1.1.3" xref="S4.SS2.p2.2.m2.1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.SS2.p2.2.m2.1.1.1.1.1.1.1.1.3.2" xref="S4.SS2.p2.2.m2.1.1.1.1.1.1.1.1.3.2.cmml">ϵ</mi><mi id="S4.SS2.p2.2.m2.1.1.1.1.1.1.1.1.3.3" xref="S4.SS2.p2.2.m2.1.1.1.1.1.1.1.1.3.3.cmml">θ</mi></msub><mo id="S4.SS2.p2.2.m2.1.1.1.1.1.1.1.1.2" xref="S4.SS2.p2.2.m2.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.SS2.p2.2.m2.1.1.1.1.1.1.1.1.1.1" xref="S4.SS2.p2.2.m2.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.SS2.p2.2.m2.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.SS2.p2.2.m2.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="S4.SS2.p2.2.m2.1.1.1.1.1.1.1.1.1.1.1" xref="S4.SS2.p2.2.m2.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.SS2.p2.2.m2.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S4.SS2.p2.2.m2.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">𝐱</mi><mi id="S4.SS2.p2.2.m2.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S4.SS2.p2.2.m2.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">t</mi><mi id="S4.SS2.p2.2.m2.1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.SS2.p2.2.m2.1.1.1.1.1.1.1.1.1.1.1.3.cmml">ref</mi></msubsup><mo id="S4.SS2.p2.2.m2.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.SS2.p2.2.m2.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.SS2.p2.2.m2.1.1.1.1.1.1.1.2" xref="S4.SS2.p2.2.m2.1.1.1.1.1.1.1.2.cmml">−</mo><msup id="S4.SS2.p2.2.m2.1.1.1.1.1.1.1.3" xref="S4.SS2.p2.2.m2.1.1.1.1.1.1.1.3.cmml"><mi id="S4.SS2.p2.2.m2.1.1.1.1.1.1.1.3.2" xref="S4.SS2.p2.2.m2.1.1.1.1.1.1.1.3.2.cmml">ϵ</mi><mi id="S4.SS2.p2.2.m2.1.1.1.1.1.1.1.3.3" xref="S4.SS2.p2.2.m2.1.1.1.1.1.1.1.3.3.cmml">ref</mi></msup></mrow><mo id="S4.SS2.p2.2.m2.1.1.1.1.1.1.3" stretchy="false" xref="S4.SS2.p2.2.m2.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S4.SS2.p2.2.m2.1.1.1.1.3" xref="S4.SS2.p2.2.m2.1.1.1.1.3.cmml">2</mn></msup><mo id="S4.SS2.p2.2.m2.2.2.2.3" xref="S4.SS2.p2.2.m2.2.2.2.3.cmml">−</mo><msup id="S4.SS2.p2.2.m2.2.2.2.2" xref="S4.SS2.p2.2.m2.2.2.2.2.cmml"><mrow id="S4.SS2.p2.2.m2.2.2.2.2.1.1" xref="S4.SS2.p2.2.m2.2.2.2.2.1.2.cmml"><mo id="S4.SS2.p2.2.m2.2.2.2.2.1.1.2" stretchy="false" xref="S4.SS2.p2.2.m2.2.2.2.2.1.2.1.cmml">‖</mo><mrow id="S4.SS2.p2.2.m2.2.2.2.2.1.1.1" xref="S4.SS2.p2.2.m2.2.2.2.2.1.1.1.cmml"><mrow id="S4.SS2.p2.2.m2.2.2.2.2.1.1.1.1" xref="S4.SS2.p2.2.m2.2.2.2.2.1.1.1.1.cmml"><msub id="S4.SS2.p2.2.m2.2.2.2.2.1.1.1.1.3" xref="S4.SS2.p2.2.m2.2.2.2.2.1.1.1.1.3.cmml"><mi id="S4.SS2.p2.2.m2.2.2.2.2.1.1.1.1.3.2" xref="S4.SS2.p2.2.m2.2.2.2.2.1.1.1.1.3.2.cmml">ϵ</mi><mi id="S4.SS2.p2.2.m2.2.2.2.2.1.1.1.1.3.3" xref="S4.SS2.p2.2.m2.2.2.2.2.1.1.1.1.3.3.cmml">ref</mi></msub><mo id="S4.SS2.p2.2.m2.2.2.2.2.1.1.1.1.2" xref="S4.SS2.p2.2.m2.2.2.2.2.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.SS2.p2.2.m2.2.2.2.2.1.1.1.1.1.1" xref="S4.SS2.p2.2.m2.2.2.2.2.1.1.1.1.1.1.1.cmml"><mo id="S4.SS2.p2.2.m2.2.2.2.2.1.1.1.1.1.1.2" stretchy="false" xref="S4.SS2.p2.2.m2.2.2.2.2.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="S4.SS2.p2.2.m2.2.2.2.2.1.1.1.1.1.1.1" xref="S4.SS2.p2.2.m2.2.2.2.2.1.1.1.1.1.1.1.cmml"><mi id="S4.SS2.p2.2.m2.2.2.2.2.1.1.1.1.1.1.1.2.2" xref="S4.SS2.p2.2.m2.2.2.2.2.1.1.1.1.1.1.1.2.2.cmml">𝐱</mi><mi id="S4.SS2.p2.2.m2.2.2.2.2.1.1.1.1.1.1.1.2.3" xref="S4.SS2.p2.2.m2.2.2.2.2.1.1.1.1.1.1.1.2.3.cmml">t</mi><mi id="S4.SS2.p2.2.m2.2.2.2.2.1.1.1.1.1.1.1.3" xref="S4.SS2.p2.2.m2.2.2.2.2.1.1.1.1.1.1.1.3.cmml">ref</mi></msubsup><mo id="S4.SS2.p2.2.m2.2.2.2.2.1.1.1.1.1.1.3" stretchy="false" xref="S4.SS2.p2.2.m2.2.2.2.2.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.SS2.p2.2.m2.2.2.2.2.1.1.1.2" xref="S4.SS2.p2.2.m2.2.2.2.2.1.1.1.2.cmml">−</mo><msup id="S4.SS2.p2.2.m2.2.2.2.2.1.1.1.3" xref="S4.SS2.p2.2.m2.2.2.2.2.1.1.1.3.cmml"><mi id="S4.SS2.p2.2.m2.2.2.2.2.1.1.1.3.2" xref="S4.SS2.p2.2.m2.2.2.2.2.1.1.1.3.2.cmml">ϵ</mi><mi id="S4.SS2.p2.2.m2.2.2.2.2.1.1.1.3.3" xref="S4.SS2.p2.2.m2.2.2.2.2.1.1.1.3.3.cmml">ref</mi></msup></mrow><mo id="S4.SS2.p2.2.m2.2.2.2.2.1.1.3" stretchy="false" xref="S4.SS2.p2.2.m2.2.2.2.2.1.2.1.cmml">‖</mo></mrow><mn id="S4.SS2.p2.2.m2.2.2.2.2.3" xref="S4.SS2.p2.2.m2.2.2.2.2.3.cmml">2</mn></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.2.m2.2b"><apply id="S4.SS2.p2.2.m2.2.2.cmml" xref="S4.SS2.p2.2.m2.2.2"><ci id="S4.SS2.p2.2.m2.2.2.3.cmml" xref="S4.SS2.p2.2.m2.2.2.3">≔</ci><apply id="S4.SS2.p2.2.m2.2.2.4.cmml" xref="S4.SS2.p2.2.m2.2.2.4"><csymbol cd="ambiguous" id="S4.SS2.p2.2.m2.2.2.4.1.cmml" xref="S4.SS2.p2.2.m2.2.2.4">superscript</csymbol><apply id="S4.SS2.p2.2.m2.2.2.4.2.cmml" xref="S4.SS2.p2.2.m2.2.2.4"><csymbol cd="ambiguous" id="S4.SS2.p2.2.m2.2.2.4.2.1.cmml" xref="S4.SS2.p2.2.m2.2.2.4">subscript</csymbol><apply id="S4.SS2.p2.2.m2.2.2.4.2.2.cmml" xref="S4.SS2.p2.2.m2.2.2.4.2.2"><ci id="S4.SS2.p2.2.m2.2.2.4.2.2.1.cmml" xref="S4.SS2.p2.2.m2.2.2.4.2.2.1">^</ci><ci id="S4.SS2.p2.2.m2.2.2.4.2.2.2.cmml" xref="S4.SS2.p2.2.m2.2.2.4.2.2.2">𝜎</ci></apply><ci id="S4.SS2.p2.2.m2.2.2.4.2.3.cmml" xref="S4.SS2.p2.2.m2.2.2.4.2.3">ref</ci></apply><cn id="S4.SS2.p2.2.m2.2.2.4.3.cmml" type="integer" xref="S4.SS2.p2.2.m2.2.2.4.3">2</cn></apply><apply id="S4.SS2.p2.2.m2.2.2.2.cmml" xref="S4.SS2.p2.2.m2.2.2.2"><minus id="S4.SS2.p2.2.m2.2.2.2.3.cmml" xref="S4.SS2.p2.2.m2.2.2.2.3"></minus><apply id="S4.SS2.p2.2.m2.1.1.1.1.cmml" xref="S4.SS2.p2.2.m2.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.2.m2.1.1.1.1.2.cmml" xref="S4.SS2.p2.2.m2.1.1.1.1">superscript</csymbol><apply id="S4.SS2.p2.2.m2.1.1.1.1.1.2.cmml" xref="S4.SS2.p2.2.m2.1.1.1.1.1.1"><csymbol cd="latexml" id="S4.SS2.p2.2.m2.1.1.1.1.1.2.1.cmml" xref="S4.SS2.p2.2.m2.1.1.1.1.1.1.2">norm</csymbol><apply id="S4.SS2.p2.2.m2.1.1.1.1.1.1.1.cmml" xref="S4.SS2.p2.2.m2.1.1.1.1.1.1.1"><minus id="S4.SS2.p2.2.m2.1.1.1.1.1.1.1.2.cmml" xref="S4.SS2.p2.2.m2.1.1.1.1.1.1.1.2"></minus><apply id="S4.SS2.p2.2.m2.1.1.1.1.1.1.1.1.cmml" xref="S4.SS2.p2.2.m2.1.1.1.1.1.1.1.1"><times id="S4.SS2.p2.2.m2.1.1.1.1.1.1.1.1.2.cmml" xref="S4.SS2.p2.2.m2.1.1.1.1.1.1.1.1.2"></times><apply id="S4.SS2.p2.2.m2.1.1.1.1.1.1.1.1.3.cmml" xref="S4.SS2.p2.2.m2.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p2.2.m2.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.SS2.p2.2.m2.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.SS2.p2.2.m2.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.SS2.p2.2.m2.1.1.1.1.1.1.1.1.3.2">italic-ϵ</ci><ci id="S4.SS2.p2.2.m2.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.SS2.p2.2.m2.1.1.1.1.1.1.1.1.3.3">𝜃</ci></apply><apply id="S4.SS2.p2.2.m2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.SS2.p2.2.m2.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.2.m2.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.SS2.p2.2.m2.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S4.SS2.p2.2.m2.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.SS2.p2.2.m2.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.2.m2.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.SS2.p2.2.m2.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.SS2.p2.2.m2.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.SS2.p2.2.m2.1.1.1.1.1.1.1.1.1.1.1.2.2">𝐱</ci><ci id="S4.SS2.p2.2.m2.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.SS2.p2.2.m2.1.1.1.1.1.1.1.1.1.1.1.2.3">𝑡</ci></apply><ci id="S4.SS2.p2.2.m2.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.SS2.p2.2.m2.1.1.1.1.1.1.1.1.1.1.1.3">ref</ci></apply></apply><apply id="S4.SS2.p2.2.m2.1.1.1.1.1.1.1.3.cmml" xref="S4.SS2.p2.2.m2.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p2.2.m2.1.1.1.1.1.1.1.3.1.cmml" xref="S4.SS2.p2.2.m2.1.1.1.1.1.1.1.3">superscript</csymbol><ci id="S4.SS2.p2.2.m2.1.1.1.1.1.1.1.3.2.cmml" xref="S4.SS2.p2.2.m2.1.1.1.1.1.1.1.3.2">italic-ϵ</ci><ci id="S4.SS2.p2.2.m2.1.1.1.1.1.1.1.3.3.cmml" xref="S4.SS2.p2.2.m2.1.1.1.1.1.1.1.3.3">ref</ci></apply></apply></apply><cn id="S4.SS2.p2.2.m2.1.1.1.1.3.cmml" type="integer" xref="S4.SS2.p2.2.m2.1.1.1.1.3">2</cn></apply><apply id="S4.SS2.p2.2.m2.2.2.2.2.cmml" xref="S4.SS2.p2.2.m2.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS2.p2.2.m2.2.2.2.2.2.cmml" xref="S4.SS2.p2.2.m2.2.2.2.2">superscript</csymbol><apply id="S4.SS2.p2.2.m2.2.2.2.2.1.2.cmml" xref="S4.SS2.p2.2.m2.2.2.2.2.1.1"><csymbol cd="latexml" id="S4.SS2.p2.2.m2.2.2.2.2.1.2.1.cmml" xref="S4.SS2.p2.2.m2.2.2.2.2.1.1.2">norm</csymbol><apply id="S4.SS2.p2.2.m2.2.2.2.2.1.1.1.cmml" xref="S4.SS2.p2.2.m2.2.2.2.2.1.1.1"><minus id="S4.SS2.p2.2.m2.2.2.2.2.1.1.1.2.cmml" xref="S4.SS2.p2.2.m2.2.2.2.2.1.1.1.2"></minus><apply id="S4.SS2.p2.2.m2.2.2.2.2.1.1.1.1.cmml" xref="S4.SS2.p2.2.m2.2.2.2.2.1.1.1.1"><times id="S4.SS2.p2.2.m2.2.2.2.2.1.1.1.1.2.cmml" xref="S4.SS2.p2.2.m2.2.2.2.2.1.1.1.1.2"></times><apply id="S4.SS2.p2.2.m2.2.2.2.2.1.1.1.1.3.cmml" xref="S4.SS2.p2.2.m2.2.2.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p2.2.m2.2.2.2.2.1.1.1.1.3.1.cmml" xref="S4.SS2.p2.2.m2.2.2.2.2.1.1.1.1.3">subscript</csymbol><ci id="S4.SS2.p2.2.m2.2.2.2.2.1.1.1.1.3.2.cmml" xref="S4.SS2.p2.2.m2.2.2.2.2.1.1.1.1.3.2">italic-ϵ</ci><ci id="S4.SS2.p2.2.m2.2.2.2.2.1.1.1.1.3.3.cmml" xref="S4.SS2.p2.2.m2.2.2.2.2.1.1.1.1.3.3">ref</ci></apply><apply id="S4.SS2.p2.2.m2.2.2.2.2.1.1.1.1.1.1.1.cmml" xref="S4.SS2.p2.2.m2.2.2.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.2.m2.2.2.2.2.1.1.1.1.1.1.1.1.cmml" xref="S4.SS2.p2.2.m2.2.2.2.2.1.1.1.1.1.1">superscript</csymbol><apply id="S4.SS2.p2.2.m2.2.2.2.2.1.1.1.1.1.1.1.2.cmml" xref="S4.SS2.p2.2.m2.2.2.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.2.m2.2.2.2.2.1.1.1.1.1.1.1.2.1.cmml" xref="S4.SS2.p2.2.m2.2.2.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="S4.SS2.p2.2.m2.2.2.2.2.1.1.1.1.1.1.1.2.2.cmml" xref="S4.SS2.p2.2.m2.2.2.2.2.1.1.1.1.1.1.1.2.2">𝐱</ci><ci id="S4.SS2.p2.2.m2.2.2.2.2.1.1.1.1.1.1.1.2.3.cmml" xref="S4.SS2.p2.2.m2.2.2.2.2.1.1.1.1.1.1.1.2.3">𝑡</ci></apply><ci id="S4.SS2.p2.2.m2.2.2.2.2.1.1.1.1.1.1.1.3.cmml" xref="S4.SS2.p2.2.m2.2.2.2.2.1.1.1.1.1.1.1.3">ref</ci></apply></apply><apply id="S4.SS2.p2.2.m2.2.2.2.2.1.1.1.3.cmml" xref="S4.SS2.p2.2.m2.2.2.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p2.2.m2.2.2.2.2.1.1.1.3.1.cmml" xref="S4.SS2.p2.2.m2.2.2.2.2.1.1.1.3">superscript</csymbol><ci id="S4.SS2.p2.2.m2.2.2.2.2.1.1.1.3.2.cmml" xref="S4.SS2.p2.2.m2.2.2.2.2.1.1.1.3.2">italic-ϵ</ci><ci id="S4.SS2.p2.2.m2.2.2.2.2.1.1.1.3.3.cmml" xref="S4.SS2.p2.2.m2.2.2.2.2.1.1.1.3.3">ref</ci></apply></apply></apply><cn id="S4.SS2.p2.2.m2.2.2.2.2.3.cmml" type="integer" xref="S4.SS2.p2.2.m2.2.2.2.2.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.2.m2.2c">\hat{\sigma}_{\rm ref}^{2}\coloneqq\|\epsilon_{\theta}(\mathbf{x}_{t}^{\rm ref%
})-\mathbf{\epsilon}^{\rm ref}\|^{2}-\|\epsilon_{\rm ref}(\mathbf{x}_{t}^{\rm
ref%
})-\mathbf{\epsilon}^{\rm ref}\|^{2}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.2.m2.2d">over^ start_ARG italic_σ end_ARG start_POSTSUBSCRIPT roman_ref end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ≔ ∥ italic_ϵ start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( bold_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT roman_ref end_POSTSUPERSCRIPT ) - italic_ϵ start_POSTSUPERSCRIPT roman_ref end_POSTSUPERSCRIPT ∥ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT - ∥ italic_ϵ start_POSTSUBSCRIPT roman_ref end_POSTSUBSCRIPT ( bold_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT roman_ref end_POSTSUPERSCRIPT ) - italic_ϵ start_POSTSUPERSCRIPT roman_ref end_POSTSUPERSCRIPT ∥ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math>. If <math alttext="\mathbf{x}_{t}^{\rm ref}" class="ltx_Math" display="inline" id="S4.SS2.p2.3.m3.1"><semantics id="S4.SS2.p2.3.m3.1a"><msubsup id="S4.SS2.p2.3.m3.1.1" xref="S4.SS2.p2.3.m3.1.1.cmml"><mi id="S4.SS2.p2.3.m3.1.1.2.2" xref="S4.SS2.p2.3.m3.1.1.2.2.cmml">𝐱</mi><mi id="S4.SS2.p2.3.m3.1.1.2.3" xref="S4.SS2.p2.3.m3.1.1.2.3.cmml">t</mi><mi id="S4.SS2.p2.3.m3.1.1.3" xref="S4.SS2.p2.3.m3.1.1.3.cmml">ref</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.3.m3.1b"><apply id="S4.SS2.p2.3.m3.1.1.cmml" xref="S4.SS2.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.3.m3.1.1.1.cmml" xref="S4.SS2.p2.3.m3.1.1">superscript</csymbol><apply id="S4.SS2.p2.3.m3.1.1.2.cmml" xref="S4.SS2.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.3.m3.1.1.2.1.cmml" xref="S4.SS2.p2.3.m3.1.1">subscript</csymbol><ci id="S4.SS2.p2.3.m3.1.1.2.2.cmml" xref="S4.SS2.p2.3.m3.1.1.2.2">𝐱</ci><ci id="S4.SS2.p2.3.m3.1.1.2.3.cmml" xref="S4.SS2.p2.3.m3.1.1.2.3">𝑡</ci></apply><ci id="S4.SS2.p2.3.m3.1.1.3.cmml" xref="S4.SS2.p2.3.m3.1.1.3">ref</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.3.m3.1c">\mathbf{x}_{t}^{\rm ref}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.3.m3.1d">bold_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT roman_ref end_POSTSUPERSCRIPT</annotation></semantics></math> generated by the reference model is good and close to <math alttext="\mathbf{x}_{t}^{w}" class="ltx_Math" display="inline" id="S4.SS2.p2.4.m4.1"><semantics id="S4.SS2.p2.4.m4.1a"><msubsup id="S4.SS2.p2.4.m4.1.1" xref="S4.SS2.p2.4.m4.1.1.cmml"><mi id="S4.SS2.p2.4.m4.1.1.2.2" xref="S4.SS2.p2.4.m4.1.1.2.2.cmml">𝐱</mi><mi id="S4.SS2.p2.4.m4.1.1.2.3" xref="S4.SS2.p2.4.m4.1.1.2.3.cmml">t</mi><mi id="S4.SS2.p2.4.m4.1.1.3" xref="S4.SS2.p2.4.m4.1.1.3.cmml">w</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.4.m4.1b"><apply id="S4.SS2.p2.4.m4.1.1.cmml" xref="S4.SS2.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.4.m4.1.1.1.cmml" xref="S4.SS2.p2.4.m4.1.1">superscript</csymbol><apply id="S4.SS2.p2.4.m4.1.1.2.cmml" xref="S4.SS2.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.4.m4.1.1.2.1.cmml" xref="S4.SS2.p2.4.m4.1.1">subscript</csymbol><ci id="S4.SS2.p2.4.m4.1.1.2.2.cmml" xref="S4.SS2.p2.4.m4.1.1.2.2">𝐱</ci><ci id="S4.SS2.p2.4.m4.1.1.2.3.cmml" xref="S4.SS2.p2.4.m4.1.1.2.3">𝑡</ci></apply><ci id="S4.SS2.p2.4.m4.1.1.3.cmml" xref="S4.SS2.p2.4.m4.1.1.3">𝑤</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.4.m4.1c">\mathbf{x}_{t}^{w}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.4.m4.1d">bold_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_w end_POSTSUPERSCRIPT</annotation></semantics></math>, both the error term and the weight term <math alttext="\sigma(\cdot)" class="ltx_Math" display="inline" id="S4.SS2.p2.5.m5.1"><semantics id="S4.SS2.p2.5.m5.1a"><mrow id="S4.SS2.p2.5.m5.1.2" xref="S4.SS2.p2.5.m5.1.2.cmml"><mi id="S4.SS2.p2.5.m5.1.2.2" xref="S4.SS2.p2.5.m5.1.2.2.cmml">σ</mi><mo id="S4.SS2.p2.5.m5.1.2.1" xref="S4.SS2.p2.5.m5.1.2.1.cmml">⁢</mo><mrow id="S4.SS2.p2.5.m5.1.2.3.2" xref="S4.SS2.p2.5.m5.1.2.cmml"><mo id="S4.SS2.p2.5.m5.1.2.3.2.1" stretchy="false" xref="S4.SS2.p2.5.m5.1.2.cmml">(</mo><mo id="S4.SS2.p2.5.m5.1.1" lspace="0em" rspace="0em" xref="S4.SS2.p2.5.m5.1.1.cmml">⋅</mo><mo id="S4.SS2.p2.5.m5.1.2.3.2.2" stretchy="false" xref="S4.SS2.p2.5.m5.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.5.m5.1b"><apply id="S4.SS2.p2.5.m5.1.2.cmml" xref="S4.SS2.p2.5.m5.1.2"><times id="S4.SS2.p2.5.m5.1.2.1.cmml" xref="S4.SS2.p2.5.m5.1.2.1"></times><ci id="S4.SS2.p2.5.m5.1.2.2.cmml" xref="S4.SS2.p2.5.m5.1.2.2">𝜎</ci><ci id="S4.SS2.p2.5.m5.1.1.cmml" xref="S4.SS2.p2.5.m5.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.5.m5.1c">\sigma(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.5.m5.1d">italic_σ ( ⋅ )</annotation></semantics></math> tend to be small. This leads to a very small gradient update without making full use of the information in the data sample, even though we know that <math alttext="\mathbf{x}_{0}^{w}" class="ltx_Math" display="inline" id="S4.SS2.p2.6.m6.1"><semantics id="S4.SS2.p2.6.m6.1a"><msubsup id="S4.SS2.p2.6.m6.1.1" xref="S4.SS2.p2.6.m6.1.1.cmml"><mi id="S4.SS2.p2.6.m6.1.1.2.2" xref="S4.SS2.p2.6.m6.1.1.2.2.cmml">𝐱</mi><mn id="S4.SS2.p2.6.m6.1.1.2.3" xref="S4.SS2.p2.6.m6.1.1.2.3.cmml">0</mn><mi id="S4.SS2.p2.6.m6.1.1.3" xref="S4.SS2.p2.6.m6.1.1.3.cmml">w</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.6.m6.1b"><apply id="S4.SS2.p2.6.m6.1.1.cmml" xref="S4.SS2.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.6.m6.1.1.1.cmml" xref="S4.SS2.p2.6.m6.1.1">superscript</csymbol><apply id="S4.SS2.p2.6.m6.1.1.2.cmml" xref="S4.SS2.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.6.m6.1.1.2.1.cmml" xref="S4.SS2.p2.6.m6.1.1">subscript</csymbol><ci id="S4.SS2.p2.6.m6.1.1.2.2.cmml" xref="S4.SS2.p2.6.m6.1.1.2.2">𝐱</ci><cn id="S4.SS2.p2.6.m6.1.1.2.3.cmml" type="integer" xref="S4.SS2.p2.6.m6.1.1.2.3">0</cn></apply><ci id="S4.SS2.p2.6.m6.1.1.3.cmml" xref="S4.SS2.p2.6.m6.1.1.3">𝑤</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.6.m6.1c">\mathbf{x}_{0}^{w}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.6.m6.1d">bold_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_w end_POSTSUPERSCRIPT</annotation></semantics></math> is generated by experts with high quality.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS2.p3">
<p class="ltx_p" id="S4.SS2.p3.7">Therefore, in order to avoid the impact of the uncertainty of the reference image, we design a strategy that uses the winning image as an anchor, and evaluate the quality of the images generated by the reference model based on its performance relative to the current model on the anchor. Specifically, we design an Anchor-based Adaptive Flipper (AAF) to the loss function in equation&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.05255v1#S4.E6" title="Equation 6 ‣ 4.1 Iterative Alignment from Semi-policy Preference Optimization ‣ 4 Iterative Alignment for Diffusion Models ‣ SePPO: Semi-Policy Preference Optimization for Diffusion Alignment"><span class="ltx_text ltx_ref_tag">6</span></a> as follows:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equationgroup ltx_eqn_table" id="S4.E8">
<tbody>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S4.E8X">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathcal{L}(\theta;\mathbf{x}_{0}^{w})~{}=~{}\mathop{\mathbb{E}}_%
{\epsilon^{w},\epsilon^{\rm ref},t}\Big{[}-\log{\sigma}\Big{(}" class="ltx_math_unparsed" display="inline" id="S4.E8X.2.1.1.m1.4"><semantics id="S4.E8X.2.1.1.m1.4a"><mrow id="S4.E8X.2.1.1.m1.4b"><mi class="ltx_font_mathcaligraphic" id="S4.E8X.2.1.1.m1.4.5">ℒ</mi><mrow id="S4.E8X.2.1.1.m1.4.6"><mo id="S4.E8X.2.1.1.m1.4.6.1" stretchy="false">(</mo><mi id="S4.E8X.2.1.1.m1.4.4">θ</mi><mo id="S4.E8X.2.1.1.m1.4.6.2">;</mo><msubsup id="S4.E8X.2.1.1.m1.4.6.3"><mi id="S4.E8X.2.1.1.m1.4.6.3.2.2">𝐱</mi><mn id="S4.E8X.2.1.1.m1.4.6.3.2.3">0</mn><mi id="S4.E8X.2.1.1.m1.4.6.3.3">w</mi></msubsup><mo id="S4.E8X.2.1.1.m1.4.6.4" rspace="0.330em" stretchy="false">)</mo></mrow><mo id="S4.E8X.2.1.1.m1.4.7" rspace="0.330em">=</mo><munder id="S4.E8X.2.1.1.m1.4.8"><mo id="S4.E8X.2.1.1.m1.4.8.2" movablelimits="false" rspace="0em">𝔼</mo><mrow id="S4.E8X.2.1.1.m1.3.3.3.3"><msup id="S4.E8X.2.1.1.m1.2.2.2.2.1"><mi id="S4.E8X.2.1.1.m1.2.2.2.2.1.2">ϵ</mi><mi id="S4.E8X.2.1.1.m1.2.2.2.2.1.3">w</mi></msup><mo id="S4.E8X.2.1.1.m1.3.3.3.3.3">,</mo><msup id="S4.E8X.2.1.1.m1.3.3.3.3.2"><mi id="S4.E8X.2.1.1.m1.3.3.3.3.2.2">ϵ</mi><mi id="S4.E8X.2.1.1.m1.3.3.3.3.2.3">ref</mi></msup><mo id="S4.E8X.2.1.1.m1.3.3.3.3.4">,</mo><mi id="S4.E8X.2.1.1.m1.1.1.1.1">t</mi></mrow></munder><mrow id="S4.E8X.2.1.1.m1.4.9"><mo id="S4.E8X.2.1.1.m1.4.9.1" maxsize="160%" minsize="160%">[</mo><mo id="S4.E8X.2.1.1.m1.4.9.2" lspace="0em">−</mo><mi id="S4.E8X.2.1.1.m1.4.9.3">log</mi><mi id="S4.E8X.2.1.1.m1.4.9.4">σ</mi><mo id="S4.E8X.2.1.1.m1.4.9.5" maxsize="160%" minsize="160%">(</mo></mrow></mrow><annotation encoding="application/x-tex" id="S4.E8X.2.1.1.m1.4c">\displaystyle\mathcal{L}(\theta;\mathbf{x}_{0}^{w})~{}=~{}\mathop{\mathbb{E}}_%
{\epsilon^{w},\epsilon^{\rm ref},t}\Big{[}-\log{\sigma}\Big{(}</annotation><annotation encoding="application/x-llamapun" id="S4.E8X.2.1.1.m1.4d">caligraphic_L ( italic_θ ; bold_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_w end_POSTSUPERSCRIPT ) = blackboard_E start_POSTSUBSCRIPT italic_ϵ start_POSTSUPERSCRIPT italic_w end_POSTSUPERSCRIPT , italic_ϵ start_POSTSUPERSCRIPT roman_ref end_POSTSUPERSCRIPT , italic_t end_POSTSUBSCRIPT [ - roman_log italic_σ (</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle-\beta Tw_{t}\big{(}\|\epsilon_{\theta}(\mathbf{x}_{t}^{w})-%
\mathbf{\epsilon}^{w}\|^{2}-\|\epsilon_{\rm ref}(\mathbf{x}_{t}^{w})-\mathbf{%
\epsilon}^{w}\|^{2}" class="ltx_math_unparsed" display="inline" id="S4.E8X.3.2.2.m1.1"><semantics id="S4.E8X.3.2.2.m1.1a"><mrow id="S4.E8X.3.2.2.m1.1b"><mo id="S4.E8X.3.2.2.m1.1.1">−</mo><mi id="S4.E8X.3.2.2.m1.1.2">β</mi><mi id="S4.E8X.3.2.2.m1.1.3">T</mi><msub id="S4.E8X.3.2.2.m1.1.4"><mi id="S4.E8X.3.2.2.m1.1.4.2">w</mi><mi id="S4.E8X.3.2.2.m1.1.4.3">t</mi></msub><mrow id="S4.E8X.3.2.2.m1.1.5"><mo id="S4.E8X.3.2.2.m1.1.5.1" maxsize="120%" minsize="120%">(</mo><mo id="S4.E8X.3.2.2.m1.1.5.2" lspace="0em" rspace="0.167em">∥</mo><msub id="S4.E8X.3.2.2.m1.1.5.3"><mi id="S4.E8X.3.2.2.m1.1.5.3.2">ϵ</mi><mi id="S4.E8X.3.2.2.m1.1.5.3.3">θ</mi></msub><mrow id="S4.E8X.3.2.2.m1.1.5.4"><mo id="S4.E8X.3.2.2.m1.1.5.4.1" stretchy="false">(</mo><msubsup id="S4.E8X.3.2.2.m1.1.5.4.2"><mi id="S4.E8X.3.2.2.m1.1.5.4.2.2.2">𝐱</mi><mi id="S4.E8X.3.2.2.m1.1.5.4.2.2.3">t</mi><mi id="S4.E8X.3.2.2.m1.1.5.4.2.3">w</mi></msubsup><mo id="S4.E8X.3.2.2.m1.1.5.4.3" stretchy="false">)</mo></mrow><mo id="S4.E8X.3.2.2.m1.1.5.5">−</mo><msup id="S4.E8X.3.2.2.m1.1.5.6"><mi id="S4.E8X.3.2.2.m1.1.5.6.2">ϵ</mi><mi id="S4.E8X.3.2.2.m1.1.5.6.3">w</mi></msup><msup id="S4.E8X.3.2.2.m1.1.5.7"><mo id="S4.E8X.3.2.2.m1.1.5.7.2" lspace="0em" rspace="0em">∥</mo><mn id="S4.E8X.3.2.2.m1.1.5.7.3">2</mn></msup><mo id="S4.E8X.3.2.2.m1.1.5.8" lspace="0em" rspace="0em">−</mo><mo id="S4.E8X.3.2.2.m1.1.5.9" lspace="0em" rspace="0.167em">∥</mo><msub id="S4.E8X.3.2.2.m1.1.5.10"><mi id="S4.E8X.3.2.2.m1.1.5.10.2">ϵ</mi><mi id="S4.E8X.3.2.2.m1.1.5.10.3">ref</mi></msub><mrow id="S4.E8X.3.2.2.m1.1.5.11"><mo id="S4.E8X.3.2.2.m1.1.5.11.1" stretchy="false">(</mo><msubsup id="S4.E8X.3.2.2.m1.1.5.11.2"><mi id="S4.E8X.3.2.2.m1.1.5.11.2.2.2">𝐱</mi><mi id="S4.E8X.3.2.2.m1.1.5.11.2.2.3">t</mi><mi id="S4.E8X.3.2.2.m1.1.5.11.2.3">w</mi></msubsup><mo id="S4.E8X.3.2.2.m1.1.5.11.3" stretchy="false">)</mo></mrow><mo id="S4.E8X.3.2.2.m1.1.5.12">−</mo><msup id="S4.E8X.3.2.2.m1.1.5.13"><mi id="S4.E8X.3.2.2.m1.1.5.13.2">ϵ</mi><mi id="S4.E8X.3.2.2.m1.1.5.13.3">w</mi></msup><msup id="S4.E8X.3.2.2.m1.1.5.14"><mo id="S4.E8X.3.2.2.m1.1.5.14.2" lspace="0em">∥</mo><mn id="S4.E8X.3.2.2.m1.1.5.14.3">2</mn></msup></mrow></mrow><annotation encoding="application/x-tex" id="S4.E8X.3.2.2.m1.1c">\displaystyle-\beta Tw_{t}\big{(}\|\epsilon_{\theta}(\mathbf{x}_{t}^{w})-%
\mathbf{\epsilon}^{w}\|^{2}-\|\epsilon_{\rm ref}(\mathbf{x}_{t}^{w})-\mathbf{%
\epsilon}^{w}\|^{2}</annotation><annotation encoding="application/x-llamapun" id="S4.E8X.3.2.2.m1.1d">- italic_β italic_T italic_w start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( ∥ italic_ϵ start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( bold_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_w end_POSTSUPERSCRIPT ) - italic_ϵ start_POSTSUPERSCRIPT italic_w end_POSTSUPERSCRIPT ∥ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT - ∥ italic_ϵ start_POSTSUBSCRIPT roman_ref end_POSTSUBSCRIPT ( bold_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_w end_POSTSUPERSCRIPT ) - italic_ϵ start_POSTSUPERSCRIPT italic_w end_POSTSUPERSCRIPT ∥ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="2"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(8)</span></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S4.E8Xa">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle-{\rm sign}\cdot(\|\epsilon_{\theta}(\mathbf{x}_{t}^{\rm ref})-%
\mathbf{\epsilon}^{\rm ref}\|^{2}-\|\epsilon_{\rm ref}(\mathbf{x}_{t}^{\rm ref%
})-\mathbf{\epsilon}^{\rm ref}\|^{2})\big{)}\Big{)}\Big{]}," class="ltx_math_unparsed" display="inline" id="S4.E8Xa.2.1.1.m1.1"><semantics id="S4.E8Xa.2.1.1.m1.1a"><mrow id="S4.E8Xa.2.1.1.m1.1b"><mrow id="S4.E8Xa.2.1.1.m1.1.1"><mrow id="S4.E8Xa.2.1.1.m1.1.1.1"><mo id="S4.E8Xa.2.1.1.m1.1.1.1.1">−</mo><mi id="S4.E8Xa.2.1.1.m1.1.1.1.2">sign</mi><mo id="S4.E8Xa.2.1.1.m1.1.1.1.3" lspace="0.222em" rspace="0.222em">⋅</mo><mrow id="S4.E8Xa.2.1.1.m1.1.1.1.4"><mo id="S4.E8Xa.2.1.1.m1.1.1.1.4.1" stretchy="false">(</mo><mo id="S4.E8Xa.2.1.1.m1.1.1.1.4.2" lspace="0em" rspace="0.167em">∥</mo><msub id="S4.E8Xa.2.1.1.m1.1.1.1.4.3"><mi id="S4.E8Xa.2.1.1.m1.1.1.1.4.3.2">ϵ</mi><mi id="S4.E8Xa.2.1.1.m1.1.1.1.4.3.3">θ</mi></msub><mrow id="S4.E8Xa.2.1.1.m1.1.1.1.4.4"><mo id="S4.E8Xa.2.1.1.m1.1.1.1.4.4.1" stretchy="false">(</mo><msubsup id="S4.E8Xa.2.1.1.m1.1.1.1.4.4.2"><mi id="S4.E8Xa.2.1.1.m1.1.1.1.4.4.2.2.2">𝐱</mi><mi id="S4.E8Xa.2.1.1.m1.1.1.1.4.4.2.2.3">t</mi><mi id="S4.E8Xa.2.1.1.m1.1.1.1.4.4.2.3">ref</mi></msubsup><mo id="S4.E8Xa.2.1.1.m1.1.1.1.4.4.3" stretchy="false">)</mo></mrow><mo id="S4.E8Xa.2.1.1.m1.1.1.1.4.5">−</mo><msup id="S4.E8Xa.2.1.1.m1.1.1.1.4.6"><mi id="S4.E8Xa.2.1.1.m1.1.1.1.4.6.2">ϵ</mi><mi id="S4.E8Xa.2.1.1.m1.1.1.1.4.6.3">ref</mi></msup><msup id="S4.E8Xa.2.1.1.m1.1.1.1.4.7"><mo id="S4.E8Xa.2.1.1.m1.1.1.1.4.7.2" lspace="0em" rspace="0em">∥</mo><mn id="S4.E8Xa.2.1.1.m1.1.1.1.4.7.3">2</mn></msup><mo id="S4.E8Xa.2.1.1.m1.1.1.1.4.8" lspace="0em" rspace="0em">−</mo><mo id="S4.E8Xa.2.1.1.m1.1.1.1.4.9" lspace="0em" rspace="0.167em">∥</mo><msub id="S4.E8Xa.2.1.1.m1.1.1.1.4.10"><mi id="S4.E8Xa.2.1.1.m1.1.1.1.4.10.2">ϵ</mi><mi id="S4.E8Xa.2.1.1.m1.1.1.1.4.10.3">ref</mi></msub><mrow id="S4.E8Xa.2.1.1.m1.1.1.1.4.11"><mo id="S4.E8Xa.2.1.1.m1.1.1.1.4.11.1" stretchy="false">(</mo><msubsup id="S4.E8Xa.2.1.1.m1.1.1.1.4.11.2"><mi id="S4.E8Xa.2.1.1.m1.1.1.1.4.11.2.2.2">𝐱</mi><mi id="S4.E8Xa.2.1.1.m1.1.1.1.4.11.2.2.3">t</mi><mi id="S4.E8Xa.2.1.1.m1.1.1.1.4.11.2.3">ref</mi></msubsup><mo id="S4.E8Xa.2.1.1.m1.1.1.1.4.11.3" stretchy="false">)</mo></mrow><mo id="S4.E8Xa.2.1.1.m1.1.1.1.4.12">−</mo><msup id="S4.E8Xa.2.1.1.m1.1.1.1.4.13"><mi id="S4.E8Xa.2.1.1.m1.1.1.1.4.13.2">ϵ</mi><mi id="S4.E8Xa.2.1.1.m1.1.1.1.4.13.3">ref</mi></msup><msup id="S4.E8Xa.2.1.1.m1.1.1.1.4.14"><mo id="S4.E8Xa.2.1.1.m1.1.1.1.4.14.2" lspace="0em" rspace="0.167em">∥</mo><mn id="S4.E8Xa.2.1.1.m1.1.1.1.4.14.3">2</mn></msup><mo id="S4.E8Xa.2.1.1.m1.1.1.1.4.15" stretchy="false">)</mo></mrow><mo id="S4.E8Xa.2.1.1.m1.1.1.1.5" maxsize="120%" minsize="120%">)</mo></mrow><mo id="S4.E8Xa.2.1.1.m1.1.1.2" maxsize="160%" minsize="160%">)</mo></mrow><mo id="S4.E8Xa.2.1.1.m1.1.2" maxsize="160%" minsize="160%">]</mo><mo id="S4.E8Xa.2.1.1.m1.1.3">,</mo></mrow><annotation encoding="application/x-tex" id="S4.E8Xa.2.1.1.m1.1c">\displaystyle-{\rm sign}\cdot(\|\epsilon_{\theta}(\mathbf{x}_{t}^{\rm ref})-%
\mathbf{\epsilon}^{\rm ref}\|^{2}-\|\epsilon_{\rm ref}(\mathbf{x}_{t}^{\rm ref%
})-\mathbf{\epsilon}^{\rm ref}\|^{2})\big{)}\Big{)}\Big{]},</annotation><annotation encoding="application/x-llamapun" id="S4.E8Xa.2.1.1.m1.1d">- roman_sign ⋅ ( ∥ italic_ϵ start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( bold_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT roman_ref end_POSTSUPERSCRIPT ) - italic_ϵ start_POSTSUPERSCRIPT roman_ref end_POSTSUPERSCRIPT ∥ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT - ∥ italic_ϵ start_POSTSUBSCRIPT roman_ref end_POSTSUBSCRIPT ( bold_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT roman_ref end_POSTSUPERSCRIPT ) - italic_ϵ start_POSTSUPERSCRIPT roman_ref end_POSTSUPERSCRIPT ∥ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ) ) ) ] ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
<p class="ltx_p" id="S4.SS2.p3.3">where <math alttext="\epsilon^{w},\epsilon^{\rm ref}\stackrel{{\scriptstyle\rm iid}}{{\sim}}%
\mathcal{N}(0,\mathbf{I})" class="ltx_Math" display="inline" id="S4.SS2.p3.1.m1.4"><semantics id="S4.SS2.p3.1.m1.4a"><mrow id="S4.SS2.p3.1.m1.4.4" xref="S4.SS2.p3.1.m1.4.4.cmml"><mrow id="S4.SS2.p3.1.m1.4.4.2.2" xref="S4.SS2.p3.1.m1.4.4.2.3.cmml"><msup id="S4.SS2.p3.1.m1.3.3.1.1.1" xref="S4.SS2.p3.1.m1.3.3.1.1.1.cmml"><mi id="S4.SS2.p3.1.m1.3.3.1.1.1.2" xref="S4.SS2.p3.1.m1.3.3.1.1.1.2.cmml">ϵ</mi><mi id="S4.SS2.p3.1.m1.3.3.1.1.1.3" xref="S4.SS2.p3.1.m1.3.3.1.1.1.3.cmml">w</mi></msup><mo id="S4.SS2.p3.1.m1.4.4.2.2.3" xref="S4.SS2.p3.1.m1.4.4.2.3.cmml">,</mo><msup id="S4.SS2.p3.1.m1.4.4.2.2.2" xref="S4.SS2.p3.1.m1.4.4.2.2.2.cmml"><mi id="S4.SS2.p3.1.m1.4.4.2.2.2.2" xref="S4.SS2.p3.1.m1.4.4.2.2.2.2.cmml">ϵ</mi><mi id="S4.SS2.p3.1.m1.4.4.2.2.2.3" xref="S4.SS2.p3.1.m1.4.4.2.2.2.3.cmml">ref</mi></msup></mrow><mover id="S4.SS2.p3.1.m1.4.4.3" xref="S4.SS2.p3.1.m1.4.4.3.cmml"><mo id="S4.SS2.p3.1.m1.4.4.3.2" xref="S4.SS2.p3.1.m1.4.4.3.2.cmml">∼</mo><mi id="S4.SS2.p3.1.m1.4.4.3.3" xref="S4.SS2.p3.1.m1.4.4.3.3.cmml">iid</mi></mover><mrow id="S4.SS2.p3.1.m1.4.4.4" xref="S4.SS2.p3.1.m1.4.4.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p3.1.m1.4.4.4.2" xref="S4.SS2.p3.1.m1.4.4.4.2.cmml">𝒩</mi><mo id="S4.SS2.p3.1.m1.4.4.4.1" xref="S4.SS2.p3.1.m1.4.4.4.1.cmml">⁢</mo><mrow id="S4.SS2.p3.1.m1.4.4.4.3.2" xref="S4.SS2.p3.1.m1.4.4.4.3.1.cmml"><mo id="S4.SS2.p3.1.m1.4.4.4.3.2.1" stretchy="false" xref="S4.SS2.p3.1.m1.4.4.4.3.1.cmml">(</mo><mn id="S4.SS2.p3.1.m1.1.1" xref="S4.SS2.p3.1.m1.1.1.cmml">0</mn><mo id="S4.SS2.p3.1.m1.4.4.4.3.2.2" xref="S4.SS2.p3.1.m1.4.4.4.3.1.cmml">,</mo><mi id="S4.SS2.p3.1.m1.2.2" xref="S4.SS2.p3.1.m1.2.2.cmml">𝐈</mi><mo id="S4.SS2.p3.1.m1.4.4.4.3.2.3" stretchy="false" xref="S4.SS2.p3.1.m1.4.4.4.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.1.m1.4b"><apply id="S4.SS2.p3.1.m1.4.4.cmml" xref="S4.SS2.p3.1.m1.4.4"><apply id="S4.SS2.p3.1.m1.4.4.3.cmml" xref="S4.SS2.p3.1.m1.4.4.3"><csymbol cd="ambiguous" id="S4.SS2.p3.1.m1.4.4.3.1.cmml" xref="S4.SS2.p3.1.m1.4.4.3">superscript</csymbol><csymbol cd="latexml" id="S4.SS2.p3.1.m1.4.4.3.2.cmml" xref="S4.SS2.p3.1.m1.4.4.3.2">similar-to</csymbol><ci id="S4.SS2.p3.1.m1.4.4.3.3.cmml" xref="S4.SS2.p3.1.m1.4.4.3.3">iid</ci></apply><list id="S4.SS2.p3.1.m1.4.4.2.3.cmml" xref="S4.SS2.p3.1.m1.4.4.2.2"><apply id="S4.SS2.p3.1.m1.3.3.1.1.1.cmml" xref="S4.SS2.p3.1.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p3.1.m1.3.3.1.1.1.1.cmml" xref="S4.SS2.p3.1.m1.3.3.1.1.1">superscript</csymbol><ci id="S4.SS2.p3.1.m1.3.3.1.1.1.2.cmml" xref="S4.SS2.p3.1.m1.3.3.1.1.1.2">italic-ϵ</ci><ci id="S4.SS2.p3.1.m1.3.3.1.1.1.3.cmml" xref="S4.SS2.p3.1.m1.3.3.1.1.1.3">𝑤</ci></apply><apply id="S4.SS2.p3.1.m1.4.4.2.2.2.cmml" xref="S4.SS2.p3.1.m1.4.4.2.2.2"><csymbol cd="ambiguous" id="S4.SS2.p3.1.m1.4.4.2.2.2.1.cmml" xref="S4.SS2.p3.1.m1.4.4.2.2.2">superscript</csymbol><ci id="S4.SS2.p3.1.m1.4.4.2.2.2.2.cmml" xref="S4.SS2.p3.1.m1.4.4.2.2.2.2">italic-ϵ</ci><ci id="S4.SS2.p3.1.m1.4.4.2.2.2.3.cmml" xref="S4.SS2.p3.1.m1.4.4.2.2.2.3">ref</ci></apply></list><apply id="S4.SS2.p3.1.m1.4.4.4.cmml" xref="S4.SS2.p3.1.m1.4.4.4"><times id="S4.SS2.p3.1.m1.4.4.4.1.cmml" xref="S4.SS2.p3.1.m1.4.4.4.1"></times><ci id="S4.SS2.p3.1.m1.4.4.4.2.cmml" xref="S4.SS2.p3.1.m1.4.4.4.2">𝒩</ci><interval closure="open" id="S4.SS2.p3.1.m1.4.4.4.3.1.cmml" xref="S4.SS2.p3.1.m1.4.4.4.3.2"><cn id="S4.SS2.p3.1.m1.1.1.cmml" type="integer" xref="S4.SS2.p3.1.m1.1.1">0</cn><ci id="S4.SS2.p3.1.m1.2.2.cmml" xref="S4.SS2.p3.1.m1.2.2">𝐈</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.1.m1.4c">\epsilon^{w},\epsilon^{\rm ref}\stackrel{{\scriptstyle\rm iid}}{{\sim}}%
\mathcal{N}(0,\mathbf{I})</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.1.m1.4d">italic_ϵ start_POSTSUPERSCRIPT italic_w end_POSTSUPERSCRIPT , italic_ϵ start_POSTSUPERSCRIPT roman_ref end_POSTSUPERSCRIPT start_RELOP SUPERSCRIPTOP start_ARG ∼ end_ARG start_ARG roman_iid end_ARG end_RELOP caligraphic_N ( 0 , bold_I )</annotation></semantics></math> and <math alttext="\mathbf{x}_{t}^{w,{\rm ref}}=\sqrt{\alpha^{t}}\mathbf{x}_{0}^{w,{\rm ref}}+%
\sqrt{1-\alpha^{t}}\epsilon^{w,{\rm ref}}" class="ltx_Math" display="inline" id="S4.SS2.p3.2.m2.6"><semantics id="S4.SS2.p3.2.m2.6a"><mrow id="S4.SS2.p3.2.m2.6.7" xref="S4.SS2.p3.2.m2.6.7.cmml"><msubsup id="S4.SS2.p3.2.m2.6.7.2" xref="S4.SS2.p3.2.m2.6.7.2.cmml"><mi id="S4.SS2.p3.2.m2.6.7.2.2.2" xref="S4.SS2.p3.2.m2.6.7.2.2.2.cmml">𝐱</mi><mi id="S4.SS2.p3.2.m2.6.7.2.2.3" xref="S4.SS2.p3.2.m2.6.7.2.2.3.cmml">t</mi><mrow id="S4.SS2.p3.2.m2.2.2.2.4" xref="S4.SS2.p3.2.m2.2.2.2.3.cmml"><mi id="S4.SS2.p3.2.m2.1.1.1.1" xref="S4.SS2.p3.2.m2.1.1.1.1.cmml">w</mi><mo id="S4.SS2.p3.2.m2.2.2.2.4.1" xref="S4.SS2.p3.2.m2.2.2.2.3.cmml">,</mo><mi id="S4.SS2.p3.2.m2.2.2.2.2" xref="S4.SS2.p3.2.m2.2.2.2.2.cmml">ref</mi></mrow></msubsup><mo id="S4.SS2.p3.2.m2.6.7.1" xref="S4.SS2.p3.2.m2.6.7.1.cmml">=</mo><mrow id="S4.SS2.p3.2.m2.6.7.3" xref="S4.SS2.p3.2.m2.6.7.3.cmml"><mrow id="S4.SS2.p3.2.m2.6.7.3.2" xref="S4.SS2.p3.2.m2.6.7.3.2.cmml"><msqrt id="S4.SS2.p3.2.m2.6.7.3.2.2" xref="S4.SS2.p3.2.m2.6.7.3.2.2.cmml"><msup id="S4.SS2.p3.2.m2.6.7.3.2.2.2" xref="S4.SS2.p3.2.m2.6.7.3.2.2.2.cmml"><mi id="S4.SS2.p3.2.m2.6.7.3.2.2.2.2" xref="S4.SS2.p3.2.m2.6.7.3.2.2.2.2.cmml">α</mi><mi id="S4.SS2.p3.2.m2.6.7.3.2.2.2.3" xref="S4.SS2.p3.2.m2.6.7.3.2.2.2.3.cmml">t</mi></msup></msqrt><mo id="S4.SS2.p3.2.m2.6.7.3.2.1" xref="S4.SS2.p3.2.m2.6.7.3.2.1.cmml">⁢</mo><msubsup id="S4.SS2.p3.2.m2.6.7.3.2.3" xref="S4.SS2.p3.2.m2.6.7.3.2.3.cmml"><mi id="S4.SS2.p3.2.m2.6.7.3.2.3.2.2" xref="S4.SS2.p3.2.m2.6.7.3.2.3.2.2.cmml">𝐱</mi><mn id="S4.SS2.p3.2.m2.6.7.3.2.3.2.3" xref="S4.SS2.p3.2.m2.6.7.3.2.3.2.3.cmml">0</mn><mrow id="S4.SS2.p3.2.m2.4.4.2.4" xref="S4.SS2.p3.2.m2.4.4.2.3.cmml"><mi id="S4.SS2.p3.2.m2.3.3.1.1" xref="S4.SS2.p3.2.m2.3.3.1.1.cmml">w</mi><mo id="S4.SS2.p3.2.m2.4.4.2.4.1" xref="S4.SS2.p3.2.m2.4.4.2.3.cmml">,</mo><mi id="S4.SS2.p3.2.m2.4.4.2.2" xref="S4.SS2.p3.2.m2.4.4.2.2.cmml">ref</mi></mrow></msubsup></mrow><mo id="S4.SS2.p3.2.m2.6.7.3.1" xref="S4.SS2.p3.2.m2.6.7.3.1.cmml">+</mo><mrow id="S4.SS2.p3.2.m2.6.7.3.3" xref="S4.SS2.p3.2.m2.6.7.3.3.cmml"><msqrt id="S4.SS2.p3.2.m2.6.7.3.3.2" xref="S4.SS2.p3.2.m2.6.7.3.3.2.cmml"><mrow id="S4.SS2.p3.2.m2.6.7.3.3.2.2" xref="S4.SS2.p3.2.m2.6.7.3.3.2.2.cmml"><mn id="S4.SS2.p3.2.m2.6.7.3.3.2.2.2" xref="S4.SS2.p3.2.m2.6.7.3.3.2.2.2.cmml">1</mn><mo id="S4.SS2.p3.2.m2.6.7.3.3.2.2.1" xref="S4.SS2.p3.2.m2.6.7.3.3.2.2.1.cmml">−</mo><msup id="S4.SS2.p3.2.m2.6.7.3.3.2.2.3" xref="S4.SS2.p3.2.m2.6.7.3.3.2.2.3.cmml"><mi id="S4.SS2.p3.2.m2.6.7.3.3.2.2.3.2" xref="S4.SS2.p3.2.m2.6.7.3.3.2.2.3.2.cmml">α</mi><mi id="S4.SS2.p3.2.m2.6.7.3.3.2.2.3.3" xref="S4.SS2.p3.2.m2.6.7.3.3.2.2.3.3.cmml">t</mi></msup></mrow></msqrt><mo id="S4.SS2.p3.2.m2.6.7.3.3.1" xref="S4.SS2.p3.2.m2.6.7.3.3.1.cmml">⁢</mo><msup id="S4.SS2.p3.2.m2.6.7.3.3.3" xref="S4.SS2.p3.2.m2.6.7.3.3.3.cmml"><mi id="S4.SS2.p3.2.m2.6.7.3.3.3.2" xref="S4.SS2.p3.2.m2.6.7.3.3.3.2.cmml">ϵ</mi><mrow id="S4.SS2.p3.2.m2.6.6.2.4" xref="S4.SS2.p3.2.m2.6.6.2.3.cmml"><mi id="S4.SS2.p3.2.m2.5.5.1.1" xref="S4.SS2.p3.2.m2.5.5.1.1.cmml">w</mi><mo id="S4.SS2.p3.2.m2.6.6.2.4.1" xref="S4.SS2.p3.2.m2.6.6.2.3.cmml">,</mo><mi id="S4.SS2.p3.2.m2.6.6.2.2" xref="S4.SS2.p3.2.m2.6.6.2.2.cmml">ref</mi></mrow></msup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.2.m2.6b"><apply id="S4.SS2.p3.2.m2.6.7.cmml" xref="S4.SS2.p3.2.m2.6.7"><eq id="S4.SS2.p3.2.m2.6.7.1.cmml" xref="S4.SS2.p3.2.m2.6.7.1"></eq><apply id="S4.SS2.p3.2.m2.6.7.2.cmml" xref="S4.SS2.p3.2.m2.6.7.2"><csymbol cd="ambiguous" id="S4.SS2.p3.2.m2.6.7.2.1.cmml" xref="S4.SS2.p3.2.m2.6.7.2">superscript</csymbol><apply id="S4.SS2.p3.2.m2.6.7.2.2.cmml" xref="S4.SS2.p3.2.m2.6.7.2"><csymbol cd="ambiguous" id="S4.SS2.p3.2.m2.6.7.2.2.1.cmml" xref="S4.SS2.p3.2.m2.6.7.2">subscript</csymbol><ci id="S4.SS2.p3.2.m2.6.7.2.2.2.cmml" xref="S4.SS2.p3.2.m2.6.7.2.2.2">𝐱</ci><ci id="S4.SS2.p3.2.m2.6.7.2.2.3.cmml" xref="S4.SS2.p3.2.m2.6.7.2.2.3">𝑡</ci></apply><list id="S4.SS2.p3.2.m2.2.2.2.3.cmml" xref="S4.SS2.p3.2.m2.2.2.2.4"><ci id="S4.SS2.p3.2.m2.1.1.1.1.cmml" xref="S4.SS2.p3.2.m2.1.1.1.1">𝑤</ci><ci id="S4.SS2.p3.2.m2.2.2.2.2.cmml" xref="S4.SS2.p3.2.m2.2.2.2.2">ref</ci></list></apply><apply id="S4.SS2.p3.2.m2.6.7.3.cmml" xref="S4.SS2.p3.2.m2.6.7.3"><plus id="S4.SS2.p3.2.m2.6.7.3.1.cmml" xref="S4.SS2.p3.2.m2.6.7.3.1"></plus><apply id="S4.SS2.p3.2.m2.6.7.3.2.cmml" xref="S4.SS2.p3.2.m2.6.7.3.2"><times id="S4.SS2.p3.2.m2.6.7.3.2.1.cmml" xref="S4.SS2.p3.2.m2.6.7.3.2.1"></times><apply id="S4.SS2.p3.2.m2.6.7.3.2.2.cmml" xref="S4.SS2.p3.2.m2.6.7.3.2.2"><root id="S4.SS2.p3.2.m2.6.7.3.2.2a.cmml" xref="S4.SS2.p3.2.m2.6.7.3.2.2"></root><apply id="S4.SS2.p3.2.m2.6.7.3.2.2.2.cmml" xref="S4.SS2.p3.2.m2.6.7.3.2.2.2"><csymbol cd="ambiguous" id="S4.SS2.p3.2.m2.6.7.3.2.2.2.1.cmml" xref="S4.SS2.p3.2.m2.6.7.3.2.2.2">superscript</csymbol><ci id="S4.SS2.p3.2.m2.6.7.3.2.2.2.2.cmml" xref="S4.SS2.p3.2.m2.6.7.3.2.2.2.2">𝛼</ci><ci id="S4.SS2.p3.2.m2.6.7.3.2.2.2.3.cmml" xref="S4.SS2.p3.2.m2.6.7.3.2.2.2.3">𝑡</ci></apply></apply><apply id="S4.SS2.p3.2.m2.6.7.3.2.3.cmml" xref="S4.SS2.p3.2.m2.6.7.3.2.3"><csymbol cd="ambiguous" id="S4.SS2.p3.2.m2.6.7.3.2.3.1.cmml" xref="S4.SS2.p3.2.m2.6.7.3.2.3">superscript</csymbol><apply id="S4.SS2.p3.2.m2.6.7.3.2.3.2.cmml" xref="S4.SS2.p3.2.m2.6.7.3.2.3"><csymbol cd="ambiguous" id="S4.SS2.p3.2.m2.6.7.3.2.3.2.1.cmml" xref="S4.SS2.p3.2.m2.6.7.3.2.3">subscript</csymbol><ci id="S4.SS2.p3.2.m2.6.7.3.2.3.2.2.cmml" xref="S4.SS2.p3.2.m2.6.7.3.2.3.2.2">𝐱</ci><cn id="S4.SS2.p3.2.m2.6.7.3.2.3.2.3.cmml" type="integer" xref="S4.SS2.p3.2.m2.6.7.3.2.3.2.3">0</cn></apply><list id="S4.SS2.p3.2.m2.4.4.2.3.cmml" xref="S4.SS2.p3.2.m2.4.4.2.4"><ci id="S4.SS2.p3.2.m2.3.3.1.1.cmml" xref="S4.SS2.p3.2.m2.3.3.1.1">𝑤</ci><ci id="S4.SS2.p3.2.m2.4.4.2.2.cmml" xref="S4.SS2.p3.2.m2.4.4.2.2">ref</ci></list></apply></apply><apply id="S4.SS2.p3.2.m2.6.7.3.3.cmml" xref="S4.SS2.p3.2.m2.6.7.3.3"><times id="S4.SS2.p3.2.m2.6.7.3.3.1.cmml" xref="S4.SS2.p3.2.m2.6.7.3.3.1"></times><apply id="S4.SS2.p3.2.m2.6.7.3.3.2.cmml" xref="S4.SS2.p3.2.m2.6.7.3.3.2"><root id="S4.SS2.p3.2.m2.6.7.3.3.2a.cmml" xref="S4.SS2.p3.2.m2.6.7.3.3.2"></root><apply id="S4.SS2.p3.2.m2.6.7.3.3.2.2.cmml" xref="S4.SS2.p3.2.m2.6.7.3.3.2.2"><minus id="S4.SS2.p3.2.m2.6.7.3.3.2.2.1.cmml" xref="S4.SS2.p3.2.m2.6.7.3.3.2.2.1"></minus><cn id="S4.SS2.p3.2.m2.6.7.3.3.2.2.2.cmml" type="integer" xref="S4.SS2.p3.2.m2.6.7.3.3.2.2.2">1</cn><apply id="S4.SS2.p3.2.m2.6.7.3.3.2.2.3.cmml" xref="S4.SS2.p3.2.m2.6.7.3.3.2.2.3"><csymbol cd="ambiguous" id="S4.SS2.p3.2.m2.6.7.3.3.2.2.3.1.cmml" xref="S4.SS2.p3.2.m2.6.7.3.3.2.2.3">superscript</csymbol><ci id="S4.SS2.p3.2.m2.6.7.3.3.2.2.3.2.cmml" xref="S4.SS2.p3.2.m2.6.7.3.3.2.2.3.2">𝛼</ci><ci id="S4.SS2.p3.2.m2.6.7.3.3.2.2.3.3.cmml" xref="S4.SS2.p3.2.m2.6.7.3.3.2.2.3.3">𝑡</ci></apply></apply></apply><apply id="S4.SS2.p3.2.m2.6.7.3.3.3.cmml" xref="S4.SS2.p3.2.m2.6.7.3.3.3"><csymbol cd="ambiguous" id="S4.SS2.p3.2.m2.6.7.3.3.3.1.cmml" xref="S4.SS2.p3.2.m2.6.7.3.3.3">superscript</csymbol><ci id="S4.SS2.p3.2.m2.6.7.3.3.3.2.cmml" xref="S4.SS2.p3.2.m2.6.7.3.3.3.2">italic-ϵ</ci><list id="S4.SS2.p3.2.m2.6.6.2.3.cmml" xref="S4.SS2.p3.2.m2.6.6.2.4"><ci id="S4.SS2.p3.2.m2.5.5.1.1.cmml" xref="S4.SS2.p3.2.m2.5.5.1.1">𝑤</ci><ci id="S4.SS2.p3.2.m2.6.6.2.2.cmml" xref="S4.SS2.p3.2.m2.6.6.2.2">ref</ci></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.2.m2.6c">\mathbf{x}_{t}^{w,{\rm ref}}=\sqrt{\alpha^{t}}\mathbf{x}_{0}^{w,{\rm ref}}+%
\sqrt{1-\alpha^{t}}\epsilon^{w,{\rm ref}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.2.m2.6d">bold_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_w , roman_ref end_POSTSUPERSCRIPT = square-root start_ARG italic_α start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT end_ARG bold_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_w , roman_ref end_POSTSUPERSCRIPT + square-root start_ARG 1 - italic_α start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT end_ARG italic_ϵ start_POSTSUPERSCRIPT italic_w , roman_ref end_POSTSUPERSCRIPT</annotation></semantics></math>. <math alttext="{\rm sign}" class="ltx_Math" display="inline" id="S4.SS2.p3.3.m3.1"><semantics id="S4.SS2.p3.3.m3.1a"><mi id="S4.SS2.p3.3.m3.1.1" xref="S4.SS2.p3.3.m3.1.1.cmml">sign</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.3.m3.1b"><ci id="S4.SS2.p3.3.m3.1.1.cmml" xref="S4.SS2.p3.3.m3.1.1">sign</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.3.m3.1c">{\rm sign}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.3.m3.1d">roman_sign</annotation></semantics></math> is a binary variable defined as</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equationgroup ltx_eqn_table" id="S4.E9">
<tbody>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S4.E9X">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle{\rm sign}={\rm sgn}(\|\epsilon_{\rm ref}(\mathbf{x}_{t}^{w})-%
\mathbf{\epsilon}^{w}\|^{2}-\|\epsilon_{\theta}(\mathbf{x}_{t}^{w})-\mathbf{%
\epsilon}^{w}\|^{2})," class="ltx_Math" display="inline" id="S4.E9X.2.1.1.m1.1"><semantics id="S4.E9X.2.1.1.m1.1a"><mrow id="S4.E9X.2.1.1.m1.1.1.1" xref="S4.E9X.2.1.1.m1.1.1.1.1.cmml"><mrow id="S4.E9X.2.1.1.m1.1.1.1.1" xref="S4.E9X.2.1.1.m1.1.1.1.1.cmml"><mi id="S4.E9X.2.1.1.m1.1.1.1.1.3" xref="S4.E9X.2.1.1.m1.1.1.1.1.3.cmml">sign</mi><mo id="S4.E9X.2.1.1.m1.1.1.1.1.2" xref="S4.E9X.2.1.1.m1.1.1.1.1.2.cmml">=</mo><mrow id="S4.E9X.2.1.1.m1.1.1.1.1.1" xref="S4.E9X.2.1.1.m1.1.1.1.1.1.cmml"><mi id="S4.E9X.2.1.1.m1.1.1.1.1.1.3" xref="S4.E9X.2.1.1.m1.1.1.1.1.1.3.cmml">sgn</mi><mo id="S4.E9X.2.1.1.m1.1.1.1.1.1.2" xref="S4.E9X.2.1.1.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1" xref="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1" xref="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.cmml"><msup id="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1" xref="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mo id="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.cmml">‖</mo><mrow id="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">ϵ</mi><mi id="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">ref</mi></msub><mo id="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">𝐱</mi><mi id="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">t</mi><mi id="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">w</mi></msubsup><mo id="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">−</mo><msup id="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">ϵ</mi><mi id="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">w</mi></msup></mrow><mo id="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.3" xref="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.3.cmml">2</mn></msup><mo id="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.3" xref="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.3.cmml">−</mo><msup id="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.2" xref="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.2.cmml"><mrow id="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1" xref="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.2.cmml"><mo id="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.2" stretchy="false" xref="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.2.1.cmml">‖</mo><mrow id="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.1" xref="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.1.cmml"><mrow id="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.1.1" xref="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.cmml"><msub id="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.3" xref="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.3.cmml"><mi id="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.3.2" xref="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.3.2.cmml">ϵ</mi><mi id="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.3.3" xref="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.3.3.cmml">θ</mi></msub><mo id="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.2" xref="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1" xref="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.cmml"><mo id="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.2" stretchy="false" xref="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1" xref="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.cmml"><mi id="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.2.2" xref="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.2.2.cmml">𝐱</mi><mi id="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.2.3" xref="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.2.3.cmml">t</mi><mi id="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.3" xref="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.3.cmml">w</mi></msubsup><mo id="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3" stretchy="false" xref="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.1.2" xref="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.1.2.cmml">−</mo><msup id="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.1.3" xref="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.1.3.cmml"><mi id="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.1.3.2" xref="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.1.3.2.cmml">ϵ</mi><mi id="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.1.3.3" xref="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.1.3.3.cmml">w</mi></msup></mrow><mo id="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.3" stretchy="false" xref="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.2.1.cmml">‖</mo></mrow><mn id="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.2.3" xref="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.cmml">2</mn></msup></mrow><mo id="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E9X.2.1.1.m1.1.1.1.2" xref="S4.E9X.2.1.1.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E9X.2.1.1.m1.1b"><apply id="S4.E9X.2.1.1.m1.1.1.1.1.cmml" xref="S4.E9X.2.1.1.m1.1.1.1"><eq id="S4.E9X.2.1.1.m1.1.1.1.1.2.cmml" xref="S4.E9X.2.1.1.m1.1.1.1.1.2"></eq><ci id="S4.E9X.2.1.1.m1.1.1.1.1.3.cmml" xref="S4.E9X.2.1.1.m1.1.1.1.1.3">sign</ci><apply id="S4.E9X.2.1.1.m1.1.1.1.1.1.cmml" xref="S4.E9X.2.1.1.m1.1.1.1.1.1"><times id="S4.E9X.2.1.1.m1.1.1.1.1.1.2.cmml" xref="S4.E9X.2.1.1.m1.1.1.1.1.1.2"></times><ci id="S4.E9X.2.1.1.m1.1.1.1.1.1.3.cmml" xref="S4.E9X.2.1.1.m1.1.1.1.1.1.3">sgn</ci><apply id="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1"><minus id="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.3"></minus><apply id="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2">norm</csymbol><apply id="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1"><minus id="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2"></minus><apply id="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1"><times id="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2"></times><apply id="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2">italic-ϵ</ci><ci id="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3">ref</ci></apply><apply id="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2">𝐱</ci><ci id="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3">𝑡</ci></apply><ci id="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑤</ci></apply></apply><apply id="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3">superscript</csymbol><ci id="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2">italic-ϵ</ci><ci id="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3">𝑤</ci></apply></apply></apply><cn id="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.3">2</cn></apply><apply id="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.2">superscript</csymbol><apply id="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.2.cmml" xref="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1"><csymbol cd="latexml" id="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.2.1.cmml" xref="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.2">norm</csymbol><apply id="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.1.cmml" xref="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.1"><minus id="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.1.2.cmml" xref="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.1.2"></minus><apply id="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.cmml" xref="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.1.1"><times id="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.2.cmml" xref="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.2"></times><apply id="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.3.cmml" xref="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.3.1.cmml" xref="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.3">subscript</csymbol><ci id="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.3.2.cmml" xref="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.3.2">italic-ϵ</ci><ci id="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.3.3.cmml" xref="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.3.3">𝜃</ci></apply><apply id="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.cmml" xref="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.cmml" xref="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1">superscript</csymbol><apply id="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.2.cmml" xref="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.2.2">𝐱</ci><ci id="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.2.3">𝑡</ci></apply><ci id="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.3.cmml" xref="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.3">𝑤</ci></apply></apply><apply id="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.1.3.cmml" xref="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.1.3"><csymbol cd="ambiguous" id="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.1.3.1.cmml" xref="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.1.3">superscript</csymbol><ci id="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.1.3.2.cmml" xref="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.1.3.2">italic-ϵ</ci><ci id="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.1.3.3.cmml" xref="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.1.3.3">𝑤</ci></apply></apply></apply><cn id="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.cmml" type="integer" xref="S4.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.2.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E9X.2.1.1.m1.1c">\displaystyle{\rm sign}={\rm sgn}(\|\epsilon_{\rm ref}(\mathbf{x}_{t}^{w})-%
\mathbf{\epsilon}^{w}\|^{2}-\|\epsilon_{\theta}(\mathbf{x}_{t}^{w})-\mathbf{%
\epsilon}^{w}\|^{2}),</annotation><annotation encoding="application/x-llamapun" id="S4.E9X.2.1.1.m1.1d">roman_sign = roman_sgn ( ∥ italic_ϵ start_POSTSUBSCRIPT roman_ref end_POSTSUBSCRIPT ( bold_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_w end_POSTSUPERSCRIPT ) - italic_ϵ start_POSTSUPERSCRIPT italic_w end_POSTSUPERSCRIPT ∥ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT - ∥ italic_ϵ start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( bold_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_w end_POSTSUPERSCRIPT ) - italic_ϵ start_POSTSUPERSCRIPT italic_w end_POSTSUPERSCRIPT ∥ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(9)</span></td>
</tr>
</tbody>
</table>
<p class="ltx_p" id="S4.SS2.p3.6">where <math alttext="{\rm sgn}(x)=1" class="ltx_Math" display="inline" id="S4.SS2.p3.4.m1.1"><semantics id="S4.SS2.p3.4.m1.1a"><mrow id="S4.SS2.p3.4.m1.1.2" xref="S4.SS2.p3.4.m1.1.2.cmml"><mrow id="S4.SS2.p3.4.m1.1.2.2" xref="S4.SS2.p3.4.m1.1.2.2.cmml"><mi id="S4.SS2.p3.4.m1.1.2.2.2" xref="S4.SS2.p3.4.m1.1.2.2.2.cmml">sgn</mi><mo id="S4.SS2.p3.4.m1.1.2.2.1" xref="S4.SS2.p3.4.m1.1.2.2.1.cmml">⁢</mo><mrow id="S4.SS2.p3.4.m1.1.2.2.3.2" xref="S4.SS2.p3.4.m1.1.2.2.cmml"><mo id="S4.SS2.p3.4.m1.1.2.2.3.2.1" stretchy="false" xref="S4.SS2.p3.4.m1.1.2.2.cmml">(</mo><mi id="S4.SS2.p3.4.m1.1.1" xref="S4.SS2.p3.4.m1.1.1.cmml">x</mi><mo id="S4.SS2.p3.4.m1.1.2.2.3.2.2" stretchy="false" xref="S4.SS2.p3.4.m1.1.2.2.cmml">)</mo></mrow></mrow><mo id="S4.SS2.p3.4.m1.1.2.1" xref="S4.SS2.p3.4.m1.1.2.1.cmml">=</mo><mn id="S4.SS2.p3.4.m1.1.2.3" xref="S4.SS2.p3.4.m1.1.2.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.4.m1.1b"><apply id="S4.SS2.p3.4.m1.1.2.cmml" xref="S4.SS2.p3.4.m1.1.2"><eq id="S4.SS2.p3.4.m1.1.2.1.cmml" xref="S4.SS2.p3.4.m1.1.2.1"></eq><apply id="S4.SS2.p3.4.m1.1.2.2.cmml" xref="S4.SS2.p3.4.m1.1.2.2"><times id="S4.SS2.p3.4.m1.1.2.2.1.cmml" xref="S4.SS2.p3.4.m1.1.2.2.1"></times><ci id="S4.SS2.p3.4.m1.1.2.2.2.cmml" xref="S4.SS2.p3.4.m1.1.2.2.2">sgn</ci><ci id="S4.SS2.p3.4.m1.1.1.cmml" xref="S4.SS2.p3.4.m1.1.1">𝑥</ci></apply><cn id="S4.SS2.p3.4.m1.1.2.3.cmml" type="integer" xref="S4.SS2.p3.4.m1.1.2.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.4.m1.1c">{\rm sgn}(x)=1</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.4.m1.1d">roman_sgn ( italic_x ) = 1</annotation></semantics></math> if <math alttext="x>0" class="ltx_Math" display="inline" id="S4.SS2.p3.5.m2.1"><semantics id="S4.SS2.p3.5.m2.1a"><mrow id="S4.SS2.p3.5.m2.1.1" xref="S4.SS2.p3.5.m2.1.1.cmml"><mi id="S4.SS2.p3.5.m2.1.1.2" xref="S4.SS2.p3.5.m2.1.1.2.cmml">x</mi><mo id="S4.SS2.p3.5.m2.1.1.1" xref="S4.SS2.p3.5.m2.1.1.1.cmml">&gt;</mo><mn id="S4.SS2.p3.5.m2.1.1.3" xref="S4.SS2.p3.5.m2.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.5.m2.1b"><apply id="S4.SS2.p3.5.m2.1.1.cmml" xref="S4.SS2.p3.5.m2.1.1"><gt id="S4.SS2.p3.5.m2.1.1.1.cmml" xref="S4.SS2.p3.5.m2.1.1.1"></gt><ci id="S4.SS2.p3.5.m2.1.1.2.cmml" xref="S4.SS2.p3.5.m2.1.1.2">𝑥</ci><cn id="S4.SS2.p3.5.m2.1.1.3.cmml" type="integer" xref="S4.SS2.p3.5.m2.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.5.m2.1c">x&gt;0</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.5.m2.1d">italic_x &gt; 0</annotation></semantics></math>, and otherwise <math alttext="{\rm sgn}(x)=-1" class="ltx_Math" display="inline" id="S4.SS2.p3.6.m3.1"><semantics id="S4.SS2.p3.6.m3.1a"><mrow id="S4.SS2.p3.6.m3.1.2" xref="S4.SS2.p3.6.m3.1.2.cmml"><mrow id="S4.SS2.p3.6.m3.1.2.2" xref="S4.SS2.p3.6.m3.1.2.2.cmml"><mi id="S4.SS2.p3.6.m3.1.2.2.2" xref="S4.SS2.p3.6.m3.1.2.2.2.cmml">sgn</mi><mo id="S4.SS2.p3.6.m3.1.2.2.1" xref="S4.SS2.p3.6.m3.1.2.2.1.cmml">⁢</mo><mrow id="S4.SS2.p3.6.m3.1.2.2.3.2" xref="S4.SS2.p3.6.m3.1.2.2.cmml"><mo id="S4.SS2.p3.6.m3.1.2.2.3.2.1" stretchy="false" xref="S4.SS2.p3.6.m3.1.2.2.cmml">(</mo><mi id="S4.SS2.p3.6.m3.1.1" xref="S4.SS2.p3.6.m3.1.1.cmml">x</mi><mo id="S4.SS2.p3.6.m3.1.2.2.3.2.2" stretchy="false" xref="S4.SS2.p3.6.m3.1.2.2.cmml">)</mo></mrow></mrow><mo id="S4.SS2.p3.6.m3.1.2.1" xref="S4.SS2.p3.6.m3.1.2.1.cmml">=</mo><mrow id="S4.SS2.p3.6.m3.1.2.3" xref="S4.SS2.p3.6.m3.1.2.3.cmml"><mo id="S4.SS2.p3.6.m3.1.2.3a" xref="S4.SS2.p3.6.m3.1.2.3.cmml">−</mo><mn id="S4.SS2.p3.6.m3.1.2.3.2" xref="S4.SS2.p3.6.m3.1.2.3.2.cmml">1</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.6.m3.1b"><apply id="S4.SS2.p3.6.m3.1.2.cmml" xref="S4.SS2.p3.6.m3.1.2"><eq id="S4.SS2.p3.6.m3.1.2.1.cmml" xref="S4.SS2.p3.6.m3.1.2.1"></eq><apply id="S4.SS2.p3.6.m3.1.2.2.cmml" xref="S4.SS2.p3.6.m3.1.2.2"><times id="S4.SS2.p3.6.m3.1.2.2.1.cmml" xref="S4.SS2.p3.6.m3.1.2.2.1"></times><ci id="S4.SS2.p3.6.m3.1.2.2.2.cmml" xref="S4.SS2.p3.6.m3.1.2.2.2">sgn</ci><ci id="S4.SS2.p3.6.m3.1.1.cmml" xref="S4.SS2.p3.6.m3.1.1">𝑥</ci></apply><apply id="S4.SS2.p3.6.m3.1.2.3.cmml" xref="S4.SS2.p3.6.m3.1.2.3"><minus id="S4.SS2.p3.6.m3.1.2.3.1.cmml" xref="S4.SS2.p3.6.m3.1.2.3"></minus><cn id="S4.SS2.p3.6.m3.1.2.3.2.cmml" type="integer" xref="S4.SS2.p3.6.m3.1.2.3.2">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.6.m3.1c">{\rm sgn}(x)=-1</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.6.m3.1d">roman_sgn ( italic_x ) = - 1</annotation></semantics></math>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS2.p4">
<p class="ltx_p" id="S4.SS2.p4.1">Intuitively, if the reference model has a higher probability of generating noise <math alttext="\mathbf{\epsilon}^{w}" class="ltx_Math" display="inline" id="S4.SS2.p4.1.m1.1"><semantics id="S4.SS2.p4.1.m1.1a"><msup id="S4.SS2.p4.1.m1.1.1" xref="S4.SS2.p4.1.m1.1.1.cmml"><mi id="S4.SS2.p4.1.m1.1.1.2" xref="S4.SS2.p4.1.m1.1.1.2.cmml">ϵ</mi><mi id="S4.SS2.p4.1.m1.1.1.3" xref="S4.SS2.p4.1.m1.1.1.3.cmml">w</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.1.m1.1b"><apply id="S4.SS2.p4.1.m1.1.1.cmml" xref="S4.SS2.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p4.1.m1.1.1.1.cmml" xref="S4.SS2.p4.1.m1.1.1">superscript</csymbol><ci id="S4.SS2.p4.1.m1.1.1.2.cmml" xref="S4.SS2.p4.1.m1.1.1.2">italic-ϵ</ci><ci id="S4.SS2.p4.1.m1.1.1.3.cmml" xref="S4.SS2.p4.1.m1.1.1.3">𝑤</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.1.m1.1c">\mathbf{\epsilon}^{w}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p4.1.m1.1d">italic_ϵ start_POSTSUPERSCRIPT italic_w end_POSTSUPERSCRIPT</annotation></semantics></math> compared to the current model, then in this situation, the reference image generated by the reference model is also more likely to be a winning image than a losing image. We formalize this claim in Theorem <a class="ltx_ref" href="https://arxiv.org/html/2410.05255v1#S4.Thmtheorem1" title="Theorem 4.1. ‣ 4.2 Anchor-based Adaptive Flipper for Preference Optimization ‣ 4 Iterative Alignment for Diffusion Models ‣ SePPO: Semi-Policy Preference Optimization for Diffusion Alignment"><span class="ltx_text ltx_ref_tag">4.1</span></a>, which motivates the design of the criterion in equation&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.05255v1#S4.E9" title="Equation 9 ‣ 4.2 Anchor-based Adaptive Flipper for Preference Optimization ‣ 4 Iterative Alignment for Diffusion Models ‣ SePPO: Semi-Policy Preference Optimization for Diffusion Alignment"><span class="ltx_text ltx_ref_tag">9</span></a>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_theorem ltx_theorem_theorem" id="S4.Thmtheorem1">
<h6 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span class="ltx_text ltx_font_bold" id="S4.Thmtheorem1.1.1.1">Theorem 4.1</span></span><span class="ltx_text ltx_font_bold" id="S4.Thmtheorem1.2.2">.</span>
</h6><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S4.Thmtheorem1.p1">
<p class="ltx_p" id="S4.Thmtheorem1.p1.4"><span class="ltx_text ltx_font_italic" id="S4.Thmtheorem1.p1.4.4">Given two policy model parameters <math alttext="\theta_{1}" class="ltx_Math" display="inline" id="S4.Thmtheorem1.p1.1.1.m1.1"><semantics id="S4.Thmtheorem1.p1.1.1.m1.1a"><msub id="S4.Thmtheorem1.p1.1.1.m1.1.1" xref="S4.Thmtheorem1.p1.1.1.m1.1.1.cmml"><mi id="S4.Thmtheorem1.p1.1.1.m1.1.1.2" xref="S4.Thmtheorem1.p1.1.1.m1.1.1.2.cmml">θ</mi><mn id="S4.Thmtheorem1.p1.1.1.m1.1.1.3" xref="S4.Thmtheorem1.p1.1.1.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S4.Thmtheorem1.p1.1.1.m1.1b"><apply id="S4.Thmtheorem1.p1.1.1.m1.1.1.cmml" xref="S4.Thmtheorem1.p1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.Thmtheorem1.p1.1.1.m1.1.1.1.cmml" xref="S4.Thmtheorem1.p1.1.1.m1.1.1">subscript</csymbol><ci id="S4.Thmtheorem1.p1.1.1.m1.1.1.2.cmml" xref="S4.Thmtheorem1.p1.1.1.m1.1.1.2">𝜃</ci><cn id="S4.Thmtheorem1.p1.1.1.m1.1.1.3.cmml" type="integer" xref="S4.Thmtheorem1.p1.1.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Thmtheorem1.p1.1.1.m1.1c">\theta_{1}</annotation><annotation encoding="application/x-llamapun" id="S4.Thmtheorem1.p1.1.1.m1.1d">italic_θ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\theta_{2}" class="ltx_Math" display="inline" id="S4.Thmtheorem1.p1.2.2.m2.1"><semantics id="S4.Thmtheorem1.p1.2.2.m2.1a"><msub id="S4.Thmtheorem1.p1.2.2.m2.1.1" xref="S4.Thmtheorem1.p1.2.2.m2.1.1.cmml"><mi id="S4.Thmtheorem1.p1.2.2.m2.1.1.2" xref="S4.Thmtheorem1.p1.2.2.m2.1.1.2.cmml">θ</mi><mn id="S4.Thmtheorem1.p1.2.2.m2.1.1.3" xref="S4.Thmtheorem1.p1.2.2.m2.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S4.Thmtheorem1.p1.2.2.m2.1b"><apply id="S4.Thmtheorem1.p1.2.2.m2.1.1.cmml" xref="S4.Thmtheorem1.p1.2.2.m2.1.1"><csymbol cd="ambiguous" id="S4.Thmtheorem1.p1.2.2.m2.1.1.1.cmml" xref="S4.Thmtheorem1.p1.2.2.m2.1.1">subscript</csymbol><ci id="S4.Thmtheorem1.p1.2.2.m2.1.1.2.cmml" xref="S4.Thmtheorem1.p1.2.2.m2.1.1.2">𝜃</ci><cn id="S4.Thmtheorem1.p1.2.2.m2.1.1.3.cmml" type="integer" xref="S4.Thmtheorem1.p1.2.2.m2.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Thmtheorem1.p1.2.2.m2.1c">\theta_{2}</annotation><annotation encoding="application/x-llamapun" id="S4.Thmtheorem1.p1.2.2.m2.1d">italic_θ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>, it is almost certain that <math alttext="\theta_{1}" class="ltx_Math" display="inline" id="S4.Thmtheorem1.p1.3.3.m3.1"><semantics id="S4.Thmtheorem1.p1.3.3.m3.1a"><msub id="S4.Thmtheorem1.p1.3.3.m3.1.1" xref="S4.Thmtheorem1.p1.3.3.m3.1.1.cmml"><mi id="S4.Thmtheorem1.p1.3.3.m3.1.1.2" xref="S4.Thmtheorem1.p1.3.3.m3.1.1.2.cmml">θ</mi><mn id="S4.Thmtheorem1.p1.3.3.m3.1.1.3" xref="S4.Thmtheorem1.p1.3.3.m3.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S4.Thmtheorem1.p1.3.3.m3.1b"><apply id="S4.Thmtheorem1.p1.3.3.m3.1.1.cmml" xref="S4.Thmtheorem1.p1.3.3.m3.1.1"><csymbol cd="ambiguous" id="S4.Thmtheorem1.p1.3.3.m3.1.1.1.cmml" xref="S4.Thmtheorem1.p1.3.3.m3.1.1">subscript</csymbol><ci id="S4.Thmtheorem1.p1.3.3.m3.1.1.2.cmml" xref="S4.Thmtheorem1.p1.3.3.m3.1.1.2">𝜃</ci><cn id="S4.Thmtheorem1.p1.3.3.m3.1.1.3.cmml" type="integer" xref="S4.Thmtheorem1.p1.3.3.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Thmtheorem1.p1.3.3.m3.1c">\theta_{1}</annotation><annotation encoding="application/x-llamapun" id="S4.Thmtheorem1.p1.3.3.m3.1d">italic_θ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> generates better prediction than <math alttext="\theta_{2}" class="ltx_Math" display="inline" id="S4.Thmtheorem1.p1.4.4.m4.1"><semantics id="S4.Thmtheorem1.p1.4.4.m4.1a"><msub id="S4.Thmtheorem1.p1.4.4.m4.1.1" xref="S4.Thmtheorem1.p1.4.4.m4.1.1.cmml"><mi id="S4.Thmtheorem1.p1.4.4.m4.1.1.2" xref="S4.Thmtheorem1.p1.4.4.m4.1.1.2.cmml">θ</mi><mn id="S4.Thmtheorem1.p1.4.4.m4.1.1.3" xref="S4.Thmtheorem1.p1.4.4.m4.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S4.Thmtheorem1.p1.4.4.m4.1b"><apply id="S4.Thmtheorem1.p1.4.4.m4.1.1.cmml" xref="S4.Thmtheorem1.p1.4.4.m4.1.1"><csymbol cd="ambiguous" id="S4.Thmtheorem1.p1.4.4.m4.1.1.1.cmml" xref="S4.Thmtheorem1.p1.4.4.m4.1.1">subscript</csymbol><ci id="S4.Thmtheorem1.p1.4.4.m4.1.1.2.cmml" xref="S4.Thmtheorem1.p1.4.4.m4.1.1.2">𝜃</ci><cn id="S4.Thmtheorem1.p1.4.4.m4.1.1.3.cmml" type="integer" xref="S4.Thmtheorem1.p1.4.4.m4.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Thmtheorem1.p1.4.4.m4.1c">\theta_{2}</annotation><annotation encoding="application/x-llamapun" id="S4.Thmtheorem1.p1.4.4.m4.1d">italic_θ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>, if</span></p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equationgroup ltx_eqn_table" id="S4.E10">
<tbody>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S4.E10X">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathop{\mathbb{E}}\Big{[}\|\epsilon_{\theta_{1}}(\mathbf{x}_{t})%
-\mathbf{\epsilon}\|^{2}-\|\epsilon_{\theta_{2}}(\mathbf{x}_{t})-\mathbf{%
\epsilon}\|^{2}\Big{]}\leq 0," class="ltx_Math" display="inline" id="S4.E10X.2.1.1.m1.1"><semantics id="S4.E10X.2.1.1.m1.1a"><mrow id="S4.E10X.2.1.1.m1.1.1.1" xref="S4.E10X.2.1.1.m1.1.1.1.1.cmml"><mrow id="S4.E10X.2.1.1.m1.1.1.1.1" xref="S4.E10X.2.1.1.m1.1.1.1.1.cmml"><mrow id="S4.E10X.2.1.1.m1.1.1.1.1.1" xref="S4.E10X.2.1.1.m1.1.1.1.1.1.cmml"><mo id="S4.E10X.2.1.1.m1.1.1.1.1.1.2" movablelimits="false" rspace="0em" xref="S4.E10X.2.1.1.m1.1.1.1.1.1.2.cmml">𝔼</mo><mrow id="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1" xref="S4.E10X.2.1.1.m1.1.1.1.1.1.1.2.cmml"><mo id="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.2" maxsize="160%" minsize="160%" xref="S4.E10X.2.1.1.m1.1.1.1.1.1.1.2.1.cmml">[</mo><mrow id="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1" xref="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.cmml"><msup id="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.1" xref="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mo id="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.cmml">‖</mo><mrow id="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">ϵ</mi><msub id="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.2" xref="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.cmml">θ</mi><mn id="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.3" xref="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.3.cmml">1</mn></msub></msub><mo id="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">𝐱</mi><mi id="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">−</mo><mi id="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">ϵ</mi></mrow><mo id="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.1.3" xref="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.1.3.cmml">2</mn></msup><mo id="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.3" xref="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.3.cmml">−</mo><msup id="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.2" xref="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.2.cmml"><mrow id="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1" xref="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.2.cmml"><mo id="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.2" stretchy="false" xref="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.2.1.cmml">‖</mo><mrow id="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.1" xref="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.1.cmml"><mrow id="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.1.1" xref="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.cmml"><msub id="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.3" xref="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.3.cmml"><mi id="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.3.2" xref="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.3.2.cmml">ϵ</mi><msub id="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.3.3" xref="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.3.3.cmml"><mi id="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.3.3.2" xref="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.3.3.2.cmml">θ</mi><mn id="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.3.3.3" xref="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.3.3.3.cmml">2</mn></msub></msub><mo id="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.2" xref="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1" xref="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.cmml"><mo id="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.2" stretchy="false" xref="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.cmml">(</mo><msub id="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1" xref="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.cmml"><mi id="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.2" xref="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.2.cmml">𝐱</mi><mi id="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.3" xref="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3" stretchy="false" xref="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.1.2" xref="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.1.2.cmml">−</mo><mi id="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.1.3" xref="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.1.3.cmml">ϵ</mi></mrow><mo id="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.3" stretchy="false" xref="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.2.1.cmml">‖</mo></mrow><mn id="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.2.3" xref="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.cmml">2</mn></msup></mrow><mo id="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.3" maxsize="160%" minsize="160%" xref="S4.E10X.2.1.1.m1.1.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="S4.E10X.2.1.1.m1.1.1.1.1.2" xref="S4.E10X.2.1.1.m1.1.1.1.1.2.cmml">≤</mo><mn id="S4.E10X.2.1.1.m1.1.1.1.1.3" xref="S4.E10X.2.1.1.m1.1.1.1.1.3.cmml">0</mn></mrow><mo id="S4.E10X.2.1.1.m1.1.1.1.2" xref="S4.E10X.2.1.1.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E10X.2.1.1.m1.1b"><apply id="S4.E10X.2.1.1.m1.1.1.1.1.cmml" xref="S4.E10X.2.1.1.m1.1.1.1"><leq id="S4.E10X.2.1.1.m1.1.1.1.1.2.cmml" xref="S4.E10X.2.1.1.m1.1.1.1.1.2"></leq><apply id="S4.E10X.2.1.1.m1.1.1.1.1.1.cmml" xref="S4.E10X.2.1.1.m1.1.1.1.1.1"><ci id="S4.E10X.2.1.1.m1.1.1.1.1.1.2.cmml" xref="S4.E10X.2.1.1.m1.1.1.1.1.1.2">𝔼</ci><apply id="S4.E10X.2.1.1.m1.1.1.1.1.1.1.2.cmml" xref="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S4.E10X.2.1.1.m1.1.1.1.1.1.1.2.1.cmml" xref="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1"><minus id="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.3"></minus><apply id="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2">norm</csymbol><apply id="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1"><minus id="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2"></minus><apply id="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1"><times id="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2"></times><apply id="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2">italic-ϵ</ci><apply id="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.2">𝜃</ci><cn id="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.3.cmml" type="integer" xref="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.3">1</cn></apply></apply><apply id="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2">𝐱</ci><ci id="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑡</ci></apply></apply><ci id="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3">italic-ϵ</ci></apply></apply><cn id="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.1.3">2</cn></apply><apply id="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.2">superscript</csymbol><apply id="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.2.cmml" xref="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1"><csymbol cd="latexml" id="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.2.1.cmml" xref="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.2">norm</csymbol><apply id="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.1.cmml" xref="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.1"><minus id="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.1.2.cmml" xref="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.1.2"></minus><apply id="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.cmml" xref="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.1.1"><times id="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.2.cmml" xref="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.2"></times><apply id="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.3.cmml" xref="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.3.1.cmml" xref="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.3">subscript</csymbol><ci id="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.3.2.cmml" xref="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.3.2">italic-ϵ</ci><apply id="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.3.3.cmml" xref="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.3.3.1.cmml" xref="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.3.3">subscript</csymbol><ci id="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.3.3.2.cmml" xref="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.3.3.2">𝜃</ci><cn id="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.3.3.3.cmml" type="integer" xref="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.3.3.3">2</cn></apply></apply><apply id="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.cmml" xref="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.cmml" xref="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.2.cmml" xref="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.2">𝐱</ci><ci id="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.3.cmml" xref="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.3">𝑡</ci></apply></apply><ci id="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.1.3.cmml" xref="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.1.1.3">italic-ϵ</ci></apply></apply><cn id="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.cmml" type="integer" xref="S4.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.2.3">2</cn></apply></apply></apply></apply><cn id="S4.E10X.2.1.1.m1.1.1.1.1.3.cmml" type="integer" xref="S4.E10X.2.1.1.m1.1.1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E10X.2.1.1.m1.1c">\displaystyle\mathop{\mathbb{E}}\Big{[}\|\epsilon_{\theta_{1}}(\mathbf{x}_{t})%
-\mathbf{\epsilon}\|^{2}-\|\epsilon_{\theta_{2}}(\mathbf{x}_{t})-\mathbf{%
\epsilon}\|^{2}\Big{]}\leq 0,</annotation><annotation encoding="application/x-llamapun" id="S4.E10X.2.1.1.m1.1d">blackboard_E [ ∥ italic_ϵ start_POSTSUBSCRIPT italic_θ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) - italic_ϵ ∥ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT - ∥ italic_ϵ start_POSTSUBSCRIPT italic_θ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) - italic_ϵ ∥ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ] ≤ 0 ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(10)</span></td>
</tr>
</tbody>
</table>
<p class="ltx_p" id="S4.Thmtheorem1.p1.6"><span class="ltx_text ltx_font_italic" id="S4.Thmtheorem1.p1.6.2">where <math alttext="\epsilon\sim\mathcal{N}(0,\mathbf{I})" class="ltx_Math" display="inline" id="S4.Thmtheorem1.p1.5.1.m1.2"><semantics id="S4.Thmtheorem1.p1.5.1.m1.2a"><mrow id="S4.Thmtheorem1.p1.5.1.m1.2.3" xref="S4.Thmtheorem1.p1.5.1.m1.2.3.cmml"><mi id="S4.Thmtheorem1.p1.5.1.m1.2.3.2" xref="S4.Thmtheorem1.p1.5.1.m1.2.3.2.cmml">ϵ</mi><mo id="S4.Thmtheorem1.p1.5.1.m1.2.3.1" xref="S4.Thmtheorem1.p1.5.1.m1.2.3.1.cmml">∼</mo><mrow id="S4.Thmtheorem1.p1.5.1.m1.2.3.3" xref="S4.Thmtheorem1.p1.5.1.m1.2.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.Thmtheorem1.p1.5.1.m1.2.3.3.2" xref="S4.Thmtheorem1.p1.5.1.m1.2.3.3.2.cmml">𝒩</mi><mo id="S4.Thmtheorem1.p1.5.1.m1.2.3.3.1" xref="S4.Thmtheorem1.p1.5.1.m1.2.3.3.1.cmml">⁢</mo><mrow id="S4.Thmtheorem1.p1.5.1.m1.2.3.3.3.2" xref="S4.Thmtheorem1.p1.5.1.m1.2.3.3.3.1.cmml"><mo id="S4.Thmtheorem1.p1.5.1.m1.2.3.3.3.2.1" stretchy="false" xref="S4.Thmtheorem1.p1.5.1.m1.2.3.3.3.1.cmml">(</mo><mn id="S4.Thmtheorem1.p1.5.1.m1.1.1" xref="S4.Thmtheorem1.p1.5.1.m1.1.1.cmml">0</mn><mo id="S4.Thmtheorem1.p1.5.1.m1.2.3.3.3.2.2" xref="S4.Thmtheorem1.p1.5.1.m1.2.3.3.3.1.cmml">,</mo><mi id="S4.Thmtheorem1.p1.5.1.m1.2.2" xref="S4.Thmtheorem1.p1.5.1.m1.2.2.cmml">𝐈</mi><mo id="S4.Thmtheorem1.p1.5.1.m1.2.3.3.3.2.3" stretchy="false" xref="S4.Thmtheorem1.p1.5.1.m1.2.3.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.Thmtheorem1.p1.5.1.m1.2b"><apply id="S4.Thmtheorem1.p1.5.1.m1.2.3.cmml" xref="S4.Thmtheorem1.p1.5.1.m1.2.3"><csymbol cd="latexml" id="S4.Thmtheorem1.p1.5.1.m1.2.3.1.cmml" xref="S4.Thmtheorem1.p1.5.1.m1.2.3.1">similar-to</csymbol><ci id="S4.Thmtheorem1.p1.5.1.m1.2.3.2.cmml" xref="S4.Thmtheorem1.p1.5.1.m1.2.3.2">italic-ϵ</ci><apply id="S4.Thmtheorem1.p1.5.1.m1.2.3.3.cmml" xref="S4.Thmtheorem1.p1.5.1.m1.2.3.3"><times id="S4.Thmtheorem1.p1.5.1.m1.2.3.3.1.cmml" xref="S4.Thmtheorem1.p1.5.1.m1.2.3.3.1"></times><ci id="S4.Thmtheorem1.p1.5.1.m1.2.3.3.2.cmml" xref="S4.Thmtheorem1.p1.5.1.m1.2.3.3.2">𝒩</ci><interval closure="open" id="S4.Thmtheorem1.p1.5.1.m1.2.3.3.3.1.cmml" xref="S4.Thmtheorem1.p1.5.1.m1.2.3.3.3.2"><cn id="S4.Thmtheorem1.p1.5.1.m1.1.1.cmml" type="integer" xref="S4.Thmtheorem1.p1.5.1.m1.1.1">0</cn><ci id="S4.Thmtheorem1.p1.5.1.m1.2.2.cmml" xref="S4.Thmtheorem1.p1.5.1.m1.2.2">𝐈</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Thmtheorem1.p1.5.1.m1.2c">\epsilon\sim\mathcal{N}(0,\mathbf{I})</annotation><annotation encoding="application/x-llamapun" id="S4.Thmtheorem1.p1.5.1.m1.2d">italic_ϵ ∼ caligraphic_N ( 0 , bold_I )</annotation></semantics></math>, and <math alttext="\mathbf{x}_{t}=\sqrt{\alpha^{t}}\mathbf{x}_{0}+\sqrt{1-\alpha^{t}}\epsilon" class="ltx_Math" display="inline" id="S4.Thmtheorem1.p1.6.2.m2.1"><semantics id="S4.Thmtheorem1.p1.6.2.m2.1a"><mrow id="S4.Thmtheorem1.p1.6.2.m2.1.1" xref="S4.Thmtheorem1.p1.6.2.m2.1.1.cmml"><msub id="S4.Thmtheorem1.p1.6.2.m2.1.1.2" xref="S4.Thmtheorem1.p1.6.2.m2.1.1.2.cmml"><mi id="S4.Thmtheorem1.p1.6.2.m2.1.1.2.2" xref="S4.Thmtheorem1.p1.6.2.m2.1.1.2.2.cmml">𝐱</mi><mi id="S4.Thmtheorem1.p1.6.2.m2.1.1.2.3" xref="S4.Thmtheorem1.p1.6.2.m2.1.1.2.3.cmml">t</mi></msub><mo id="S4.Thmtheorem1.p1.6.2.m2.1.1.1" xref="S4.Thmtheorem1.p1.6.2.m2.1.1.1.cmml">=</mo><mrow id="S4.Thmtheorem1.p1.6.2.m2.1.1.3" xref="S4.Thmtheorem1.p1.6.2.m2.1.1.3.cmml"><mrow id="S4.Thmtheorem1.p1.6.2.m2.1.1.3.2" xref="S4.Thmtheorem1.p1.6.2.m2.1.1.3.2.cmml"><msqrt id="S4.Thmtheorem1.p1.6.2.m2.1.1.3.2.2" xref="S4.Thmtheorem1.p1.6.2.m2.1.1.3.2.2.cmml"><msup id="S4.Thmtheorem1.p1.6.2.m2.1.1.3.2.2.2" xref="S4.Thmtheorem1.p1.6.2.m2.1.1.3.2.2.2.cmml"><mi id="S4.Thmtheorem1.p1.6.2.m2.1.1.3.2.2.2.2" xref="S4.Thmtheorem1.p1.6.2.m2.1.1.3.2.2.2.2.cmml">α</mi><mi id="S4.Thmtheorem1.p1.6.2.m2.1.1.3.2.2.2.3" xref="S4.Thmtheorem1.p1.6.2.m2.1.1.3.2.2.2.3.cmml">t</mi></msup></msqrt><mo id="S4.Thmtheorem1.p1.6.2.m2.1.1.3.2.1" xref="S4.Thmtheorem1.p1.6.2.m2.1.1.3.2.1.cmml">⁢</mo><msub id="S4.Thmtheorem1.p1.6.2.m2.1.1.3.2.3" xref="S4.Thmtheorem1.p1.6.2.m2.1.1.3.2.3.cmml"><mi id="S4.Thmtheorem1.p1.6.2.m2.1.1.3.2.3.2" xref="S4.Thmtheorem1.p1.6.2.m2.1.1.3.2.3.2.cmml">𝐱</mi><mn id="S4.Thmtheorem1.p1.6.2.m2.1.1.3.2.3.3" xref="S4.Thmtheorem1.p1.6.2.m2.1.1.3.2.3.3.cmml">0</mn></msub></mrow><mo id="S4.Thmtheorem1.p1.6.2.m2.1.1.3.1" xref="S4.Thmtheorem1.p1.6.2.m2.1.1.3.1.cmml">+</mo><mrow id="S4.Thmtheorem1.p1.6.2.m2.1.1.3.3" xref="S4.Thmtheorem1.p1.6.2.m2.1.1.3.3.cmml"><msqrt id="S4.Thmtheorem1.p1.6.2.m2.1.1.3.3.2" xref="S4.Thmtheorem1.p1.6.2.m2.1.1.3.3.2.cmml"><mrow id="S4.Thmtheorem1.p1.6.2.m2.1.1.3.3.2.2" xref="S4.Thmtheorem1.p1.6.2.m2.1.1.3.3.2.2.cmml"><mn id="S4.Thmtheorem1.p1.6.2.m2.1.1.3.3.2.2.2" xref="S4.Thmtheorem1.p1.6.2.m2.1.1.3.3.2.2.2.cmml">1</mn><mo id="S4.Thmtheorem1.p1.6.2.m2.1.1.3.3.2.2.1" xref="S4.Thmtheorem1.p1.6.2.m2.1.1.3.3.2.2.1.cmml">−</mo><msup id="S4.Thmtheorem1.p1.6.2.m2.1.1.3.3.2.2.3" xref="S4.Thmtheorem1.p1.6.2.m2.1.1.3.3.2.2.3.cmml"><mi id="S4.Thmtheorem1.p1.6.2.m2.1.1.3.3.2.2.3.2" xref="S4.Thmtheorem1.p1.6.2.m2.1.1.3.3.2.2.3.2.cmml">α</mi><mi id="S4.Thmtheorem1.p1.6.2.m2.1.1.3.3.2.2.3.3" xref="S4.Thmtheorem1.p1.6.2.m2.1.1.3.3.2.2.3.3.cmml">t</mi></msup></mrow></msqrt><mo id="S4.Thmtheorem1.p1.6.2.m2.1.1.3.3.1" xref="S4.Thmtheorem1.p1.6.2.m2.1.1.3.3.1.cmml">⁢</mo><mi id="S4.Thmtheorem1.p1.6.2.m2.1.1.3.3.3" xref="S4.Thmtheorem1.p1.6.2.m2.1.1.3.3.3.cmml">ϵ</mi></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.Thmtheorem1.p1.6.2.m2.1b"><apply id="S4.Thmtheorem1.p1.6.2.m2.1.1.cmml" xref="S4.Thmtheorem1.p1.6.2.m2.1.1"><eq id="S4.Thmtheorem1.p1.6.2.m2.1.1.1.cmml" xref="S4.Thmtheorem1.p1.6.2.m2.1.1.1"></eq><apply id="S4.Thmtheorem1.p1.6.2.m2.1.1.2.cmml" xref="S4.Thmtheorem1.p1.6.2.m2.1.1.2"><csymbol cd="ambiguous" id="S4.Thmtheorem1.p1.6.2.m2.1.1.2.1.cmml" xref="S4.Thmtheorem1.p1.6.2.m2.1.1.2">subscript</csymbol><ci id="S4.Thmtheorem1.p1.6.2.m2.1.1.2.2.cmml" xref="S4.Thmtheorem1.p1.6.2.m2.1.1.2.2">𝐱</ci><ci id="S4.Thmtheorem1.p1.6.2.m2.1.1.2.3.cmml" xref="S4.Thmtheorem1.p1.6.2.m2.1.1.2.3">𝑡</ci></apply><apply id="S4.Thmtheorem1.p1.6.2.m2.1.1.3.cmml" xref="S4.Thmtheorem1.p1.6.2.m2.1.1.3"><plus id="S4.Thmtheorem1.p1.6.2.m2.1.1.3.1.cmml" xref="S4.Thmtheorem1.p1.6.2.m2.1.1.3.1"></plus><apply id="S4.Thmtheorem1.p1.6.2.m2.1.1.3.2.cmml" xref="S4.Thmtheorem1.p1.6.2.m2.1.1.3.2"><times id="S4.Thmtheorem1.p1.6.2.m2.1.1.3.2.1.cmml" xref="S4.Thmtheorem1.p1.6.2.m2.1.1.3.2.1"></times><apply id="S4.Thmtheorem1.p1.6.2.m2.1.1.3.2.2.cmml" xref="S4.Thmtheorem1.p1.6.2.m2.1.1.3.2.2"><root id="S4.Thmtheorem1.p1.6.2.m2.1.1.3.2.2a.cmml" xref="S4.Thmtheorem1.p1.6.2.m2.1.1.3.2.2"></root><apply id="S4.Thmtheorem1.p1.6.2.m2.1.1.3.2.2.2.cmml" xref="S4.Thmtheorem1.p1.6.2.m2.1.1.3.2.2.2"><csymbol cd="ambiguous" id="S4.Thmtheorem1.p1.6.2.m2.1.1.3.2.2.2.1.cmml" xref="S4.Thmtheorem1.p1.6.2.m2.1.1.3.2.2.2">superscript</csymbol><ci id="S4.Thmtheorem1.p1.6.2.m2.1.1.3.2.2.2.2.cmml" xref="S4.Thmtheorem1.p1.6.2.m2.1.1.3.2.2.2.2">𝛼</ci><ci id="S4.Thmtheorem1.p1.6.2.m2.1.1.3.2.2.2.3.cmml" xref="S4.Thmtheorem1.p1.6.2.m2.1.1.3.2.2.2.3">𝑡</ci></apply></apply><apply id="S4.Thmtheorem1.p1.6.2.m2.1.1.3.2.3.cmml" xref="S4.Thmtheorem1.p1.6.2.m2.1.1.3.2.3"><csymbol cd="ambiguous" id="S4.Thmtheorem1.p1.6.2.m2.1.1.3.2.3.1.cmml" xref="S4.Thmtheorem1.p1.6.2.m2.1.1.3.2.3">subscript</csymbol><ci id="S4.Thmtheorem1.p1.6.2.m2.1.1.3.2.3.2.cmml" xref="S4.Thmtheorem1.p1.6.2.m2.1.1.3.2.3.2">𝐱</ci><cn id="S4.Thmtheorem1.p1.6.2.m2.1.1.3.2.3.3.cmml" type="integer" xref="S4.Thmtheorem1.p1.6.2.m2.1.1.3.2.3.3">0</cn></apply></apply><apply id="S4.Thmtheorem1.p1.6.2.m2.1.1.3.3.cmml" xref="S4.Thmtheorem1.p1.6.2.m2.1.1.3.3"><times id="S4.Thmtheorem1.p1.6.2.m2.1.1.3.3.1.cmml" xref="S4.Thmtheorem1.p1.6.2.m2.1.1.3.3.1"></times><apply id="S4.Thmtheorem1.p1.6.2.m2.1.1.3.3.2.cmml" xref="S4.Thmtheorem1.p1.6.2.m2.1.1.3.3.2"><root id="S4.Thmtheorem1.p1.6.2.m2.1.1.3.3.2a.cmml" xref="S4.Thmtheorem1.p1.6.2.m2.1.1.3.3.2"></root><apply id="S4.Thmtheorem1.p1.6.2.m2.1.1.3.3.2.2.cmml" xref="S4.Thmtheorem1.p1.6.2.m2.1.1.3.3.2.2"><minus id="S4.Thmtheorem1.p1.6.2.m2.1.1.3.3.2.2.1.cmml" xref="S4.Thmtheorem1.p1.6.2.m2.1.1.3.3.2.2.1"></minus><cn id="S4.Thmtheorem1.p1.6.2.m2.1.1.3.3.2.2.2.cmml" type="integer" xref="S4.Thmtheorem1.p1.6.2.m2.1.1.3.3.2.2.2">1</cn><apply id="S4.Thmtheorem1.p1.6.2.m2.1.1.3.3.2.2.3.cmml" xref="S4.Thmtheorem1.p1.6.2.m2.1.1.3.3.2.2.3"><csymbol cd="ambiguous" id="S4.Thmtheorem1.p1.6.2.m2.1.1.3.3.2.2.3.1.cmml" xref="S4.Thmtheorem1.p1.6.2.m2.1.1.3.3.2.2.3">superscript</csymbol><ci id="S4.Thmtheorem1.p1.6.2.m2.1.1.3.3.2.2.3.2.cmml" xref="S4.Thmtheorem1.p1.6.2.m2.1.1.3.3.2.2.3.2">𝛼</ci><ci id="S4.Thmtheorem1.p1.6.2.m2.1.1.3.3.2.2.3.3.cmml" xref="S4.Thmtheorem1.p1.6.2.m2.1.1.3.3.2.2.3.3">𝑡</ci></apply></apply></apply><ci id="S4.Thmtheorem1.p1.6.2.m2.1.1.3.3.3.cmml" xref="S4.Thmtheorem1.p1.6.2.m2.1.1.3.3.3">italic-ϵ</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Thmtheorem1.p1.6.2.m2.1c">\mathbf{x}_{t}=\sqrt{\alpha^{t}}\mathbf{x}_{0}+\sqrt{1-\alpha^{t}}\epsilon</annotation><annotation encoding="application/x-llamapun" id="S4.Thmtheorem1.p1.6.2.m2.1d">bold_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = square-root start_ARG italic_α start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT end_ARG bold_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT + square-root start_ARG 1 - italic_α start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT end_ARG italic_ϵ</annotation></semantics></math>.</span></p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS2.p5">
<p class="ltx_p" id="S4.SS2.p5.5">The proof of Theorem <a class="ltx_ref" href="https://arxiv.org/html/2410.05255v1#S4.Thmtheorem1" title="Theorem 4.1. ‣ 4.2 Anchor-based Adaptive Flipper for Preference Optimization ‣ 4 Iterative Alignment for Diffusion Models ‣ SePPO: Semi-Policy Preference Optimization for Diffusion Alignment"><span class="ltx_text ltx_ref_tag">4.1</span></a> is given in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.05255v1#A1.SS1" title="A.1 Proof of Theorem 4.1 ‣ Appendix A Theoretical Analysis ‣ SePPO: Semi-Policy Preference Optimization for Diffusion Alignment"><span class="ltx_text ltx_ref_tag">A.1</span></a>. According to Theorem <a class="ltx_ref" href="https://arxiv.org/html/2410.05255v1#S4.Thmtheorem1" title="Theorem 4.1. ‣ 4.2 Anchor-based Adaptive Flipper for Preference Optimization ‣ 4 Iterative Alignment for Diffusion Models ‣ SePPO: Semi-Policy Preference Optimization for Diffusion Alignment"><span class="ltx_text ltx_ref_tag">4.1</span></a>, if <math alttext="{\rm sign}=-1" class="ltx_Math" display="inline" id="S4.SS2.p5.1.m1.1"><semantics id="S4.SS2.p5.1.m1.1a"><mrow id="S4.SS2.p5.1.m1.1.1" xref="S4.SS2.p5.1.m1.1.1.cmml"><mi id="S4.SS2.p5.1.m1.1.1.2" xref="S4.SS2.p5.1.m1.1.1.2.cmml">sign</mi><mo id="S4.SS2.p5.1.m1.1.1.1" xref="S4.SS2.p5.1.m1.1.1.1.cmml">=</mo><mrow id="S4.SS2.p5.1.m1.1.1.3" xref="S4.SS2.p5.1.m1.1.1.3.cmml"><mo id="S4.SS2.p5.1.m1.1.1.3a" xref="S4.SS2.p5.1.m1.1.1.3.cmml">−</mo><mn id="S4.SS2.p5.1.m1.1.1.3.2" xref="S4.SS2.p5.1.m1.1.1.3.2.cmml">1</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p5.1.m1.1b"><apply id="S4.SS2.p5.1.m1.1.1.cmml" xref="S4.SS2.p5.1.m1.1.1"><eq id="S4.SS2.p5.1.m1.1.1.1.cmml" xref="S4.SS2.p5.1.m1.1.1.1"></eq><ci id="S4.SS2.p5.1.m1.1.1.2.cmml" xref="S4.SS2.p5.1.m1.1.1.2">sign</ci><apply id="S4.SS2.p5.1.m1.1.1.3.cmml" xref="S4.SS2.p5.1.m1.1.1.3"><minus id="S4.SS2.p5.1.m1.1.1.3.1.cmml" xref="S4.SS2.p5.1.m1.1.1.3"></minus><cn id="S4.SS2.p5.1.m1.1.1.3.2.cmml" type="integer" xref="S4.SS2.p5.1.m1.1.1.3.2">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p5.1.m1.1c">{\rm sign}=-1</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p5.1.m1.1d">roman_sign = - 1</annotation></semantics></math>, it means that <math alttext="\mathbf{x}_{0}^{\rm ref}" class="ltx_Math" display="inline" id="S4.SS2.p5.2.m2.1"><semantics id="S4.SS2.p5.2.m2.1a"><msubsup id="S4.SS2.p5.2.m2.1.1" xref="S4.SS2.p5.2.m2.1.1.cmml"><mi id="S4.SS2.p5.2.m2.1.1.2.2" xref="S4.SS2.p5.2.m2.1.1.2.2.cmml">𝐱</mi><mn id="S4.SS2.p5.2.m2.1.1.2.3" xref="S4.SS2.p5.2.m2.1.1.2.3.cmml">0</mn><mi id="S4.SS2.p5.2.m2.1.1.3" xref="S4.SS2.p5.2.m2.1.1.3.cmml">ref</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.p5.2.m2.1b"><apply id="S4.SS2.p5.2.m2.1.1.cmml" xref="S4.SS2.p5.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.p5.2.m2.1.1.1.cmml" xref="S4.SS2.p5.2.m2.1.1">superscript</csymbol><apply id="S4.SS2.p5.2.m2.1.1.2.cmml" xref="S4.SS2.p5.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.p5.2.m2.1.1.2.1.cmml" xref="S4.SS2.p5.2.m2.1.1">subscript</csymbol><ci id="S4.SS2.p5.2.m2.1.1.2.2.cmml" xref="S4.SS2.p5.2.m2.1.1.2.2">𝐱</ci><cn id="S4.SS2.p5.2.m2.1.1.2.3.cmml" type="integer" xref="S4.SS2.p5.2.m2.1.1.2.3">0</cn></apply><ci id="S4.SS2.p5.2.m2.1.1.3.cmml" xref="S4.SS2.p5.2.m2.1.1.3">ref</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p5.2.m2.1c">\mathbf{x}_{0}^{\rm ref}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p5.2.m2.1d">bold_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT roman_ref end_POSTSUPERSCRIPT</annotation></semantics></math> generated by <math alttext="\epsilon_{\rm ref}" class="ltx_Math" display="inline" id="S4.SS2.p5.3.m3.1"><semantics id="S4.SS2.p5.3.m3.1a"><msub id="S4.SS2.p5.3.m3.1.1" xref="S4.SS2.p5.3.m3.1.1.cmml"><mi id="S4.SS2.p5.3.m3.1.1.2" xref="S4.SS2.p5.3.m3.1.1.2.cmml">ϵ</mi><mi id="S4.SS2.p5.3.m3.1.1.3" xref="S4.SS2.p5.3.m3.1.1.3.cmml">ref</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p5.3.m3.1b"><apply id="S4.SS2.p5.3.m3.1.1.cmml" xref="S4.SS2.p5.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS2.p5.3.m3.1.1.1.cmml" xref="S4.SS2.p5.3.m3.1.1">subscript</csymbol><ci id="S4.SS2.p5.3.m3.1.1.2.cmml" xref="S4.SS2.p5.3.m3.1.1.2">italic-ϵ</ci><ci id="S4.SS2.p5.3.m3.1.1.3.cmml" xref="S4.SS2.p5.3.m3.1.1.3">ref</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p5.3.m3.1c">\epsilon_{\rm ref}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p5.3.m3.1d">italic_ϵ start_POSTSUBSCRIPT roman_ref end_POSTSUBSCRIPT</annotation></semantics></math> has a high probability to be better than the output of <math alttext="\epsilon_{\theta}" class="ltx_Math" display="inline" id="S4.SS2.p5.4.m4.1"><semantics id="S4.SS2.p5.4.m4.1a"><msub id="S4.SS2.p5.4.m4.1.1" xref="S4.SS2.p5.4.m4.1.1.cmml"><mi id="S4.SS2.p5.4.m4.1.1.2" xref="S4.SS2.p5.4.m4.1.1.2.cmml">ϵ</mi><mi id="S4.SS2.p5.4.m4.1.1.3" xref="S4.SS2.p5.4.m4.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p5.4.m4.1b"><apply id="S4.SS2.p5.4.m4.1.1.cmml" xref="S4.SS2.p5.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS2.p5.4.m4.1.1.1.cmml" xref="S4.SS2.p5.4.m4.1.1">subscript</csymbol><ci id="S4.SS2.p5.4.m4.1.1.2.cmml" xref="S4.SS2.p5.4.m4.1.1.2">italic-ϵ</ci><ci id="S4.SS2.p5.4.m4.1.1.3.cmml" xref="S4.SS2.p5.4.m4.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p5.4.m4.1c">\epsilon_{\theta}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p5.4.m4.1d">italic_ϵ start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math>. In this situation, <math alttext="\mathbf{x}_{0}^{\rm ref}" class="ltx_Math" display="inline" id="S4.SS2.p5.5.m5.1"><semantics id="S4.SS2.p5.5.m5.1a"><msubsup id="S4.SS2.p5.5.m5.1.1" xref="S4.SS2.p5.5.m5.1.1.cmml"><mi id="S4.SS2.p5.5.m5.1.1.2.2" xref="S4.SS2.p5.5.m5.1.1.2.2.cmml">𝐱</mi><mn id="S4.SS2.p5.5.m5.1.1.2.3" xref="S4.SS2.p5.5.m5.1.1.2.3.cmml">0</mn><mi id="S4.SS2.p5.5.m5.1.1.3" xref="S4.SS2.p5.5.m5.1.1.3.cmml">ref</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.p5.5.m5.1b"><apply id="S4.SS2.p5.5.m5.1.1.cmml" xref="S4.SS2.p5.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS2.p5.5.m5.1.1.1.cmml" xref="S4.SS2.p5.5.m5.1.1">superscript</csymbol><apply id="S4.SS2.p5.5.m5.1.1.2.cmml" xref="S4.SS2.p5.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS2.p5.5.m5.1.1.2.1.cmml" xref="S4.SS2.p5.5.m5.1.1">subscript</csymbol><ci id="S4.SS2.p5.5.m5.1.1.2.2.cmml" xref="S4.SS2.p5.5.m5.1.1.2.2">𝐱</ci><cn id="S4.SS2.p5.5.m5.1.1.2.3.cmml" type="integer" xref="S4.SS2.p5.5.m5.1.1.2.3">0</cn></apply><ci id="S4.SS2.p5.5.m5.1.1.3.cmml" xref="S4.SS2.p5.5.m5.1.1.3">ref</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p5.5.m5.1c">\mathbf{x}_{0}^{\rm ref}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p5.5.m5.1d">bold_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT roman_ref end_POSTSUPERSCRIPT</annotation></semantics></math> is of good quality and should not be rejected. The effectiveness of the AAF is further verified in the ablation study in Section <a class="ltx_ref" href="https://arxiv.org/html/2410.05255v1#S5" title="5 Experiments ‣ SePPO: Semi-Policy Preference Optimization for Diffusion Alignment"><span class="ltx_text ltx_ref_tag">5</span></a>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Experiments</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<section class="ltx_subsection" id="S5.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1 </span>Setup</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<section class="ltx_subsubsection" id="S5.SS1.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.1.1 </span>Text-to-Image</h4><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S5.SS1.SSS1.p1">
<p class="ltx_p" id="S5.SS1.SSS1.p1.10">In the text-to-image task, we test our methods based on the stable diffusion 1.5 (SD-1.5) model. Following Diffusion-DPO <cite class="ltx_cite ltx_citemacro_citep">(Wallace et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05255v1#bib.bib29" title="">2024</a>)</cite>, we use the sampled training set of the Pick-a-Pic v2 dataset <cite class="ltx_cite ltx_citemacro_citep">(Kirstain et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05255v1#bib.bib18" title="">2023</a>)</cite> as the training dataset. Pick-a-Pic dataset is a human-annotated preference dataset for image generation. It consists of images generated by the SDXL-beta <cite class="ltx_cite ltx_citemacro_citep">(Podell et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05255v1#bib.bib22" title="">2024</a>)</cite> and Dreamlike models. Specifically, as mentioned in Diffusion-DPO, we remove approximately <math alttext="12\%" class="ltx_Math" display="inline" id="S5.SS1.SSS1.p1.1.m1.1"><semantics id="S5.SS1.SSS1.p1.1.m1.1a"><mrow id="S5.SS1.SSS1.p1.1.m1.1.1" xref="S5.SS1.SSS1.p1.1.m1.1.1.cmml"><mn id="S5.SS1.SSS1.p1.1.m1.1.1.2" xref="S5.SS1.SSS1.p1.1.m1.1.1.2.cmml">12</mn><mo id="S5.SS1.SSS1.p1.1.m1.1.1.1" xref="S5.SS1.SSS1.p1.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS1.p1.1.m1.1b"><apply id="S5.SS1.SSS1.p1.1.m1.1.1.cmml" xref="S5.SS1.SSS1.p1.1.m1.1.1"><csymbol cd="latexml" id="S5.SS1.SSS1.p1.1.m1.1.1.1.cmml" xref="S5.SS1.SSS1.p1.1.m1.1.1.1">percent</csymbol><cn id="S5.SS1.SSS1.p1.1.m1.1.1.2.cmml" type="integer" xref="S5.SS1.SSS1.p1.1.m1.1.1.2">12</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS1.p1.1.m1.1c">12\%</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.SSS1.p1.1.m1.1d">12 %</annotation></semantics></math> pairs with ties and use the remaining <math alttext="851,293" class="ltx_Math" display="inline" id="S5.SS1.SSS1.p1.2.m2.2"><semantics id="S5.SS1.SSS1.p1.2.m2.2a"><mrow id="S5.SS1.SSS1.p1.2.m2.2.3.2" xref="S5.SS1.SSS1.p1.2.m2.2.3.1.cmml"><mn id="S5.SS1.SSS1.p1.2.m2.1.1" xref="S5.SS1.SSS1.p1.2.m2.1.1.cmml">851</mn><mo id="S5.SS1.SSS1.p1.2.m2.2.3.2.1" xref="S5.SS1.SSS1.p1.2.m2.2.3.1.cmml">,</mo><mn id="S5.SS1.SSS1.p1.2.m2.2.2" xref="S5.SS1.SSS1.p1.2.m2.2.2.cmml">293</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS1.p1.2.m2.2b"><list id="S5.SS1.SSS1.p1.2.m2.2.3.1.cmml" xref="S5.SS1.SSS1.p1.2.m2.2.3.2"><cn id="S5.SS1.SSS1.p1.2.m2.1.1.cmml" type="integer" xref="S5.SS1.SSS1.p1.2.m2.1.1">851</cn><cn id="S5.SS1.SSS1.p1.2.m2.2.2.cmml" type="integer" xref="S5.SS1.SSS1.p1.2.m2.2.2">293</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS1.p1.2.m2.2c">851,293</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.SSS1.p1.2.m2.2d">851 , 293</annotation></semantics></math> pairs, which include <math alttext="58,960" class="ltx_Math" display="inline" id="S5.SS1.SSS1.p1.3.m3.2"><semantics id="S5.SS1.SSS1.p1.3.m3.2a"><mrow id="S5.SS1.SSS1.p1.3.m3.2.3.2" xref="S5.SS1.SSS1.p1.3.m3.2.3.1.cmml"><mn id="S5.SS1.SSS1.p1.3.m3.1.1" xref="S5.SS1.SSS1.p1.3.m3.1.1.cmml">58</mn><mo id="S5.SS1.SSS1.p1.3.m3.2.3.2.1" xref="S5.SS1.SSS1.p1.3.m3.2.3.1.cmml">,</mo><mn id="S5.SS1.SSS1.p1.3.m3.2.2" xref="S5.SS1.SSS1.p1.3.m3.2.2.cmml">960</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS1.p1.3.m3.2b"><list id="S5.SS1.SSS1.p1.3.m3.2.3.1.cmml" xref="S5.SS1.SSS1.p1.3.m3.2.3.2"><cn id="S5.SS1.SSS1.p1.3.m3.1.1.cmml" type="integer" xref="S5.SS1.SSS1.p1.3.m3.1.1">58</cn><cn id="S5.SS1.SSS1.p1.3.m3.2.2.cmml" type="integer" xref="S5.SS1.SSS1.p1.3.m3.2.2">960</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS1.p1.3.m3.2c">58,960</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.SSS1.p1.3.m3.2d">58 , 960</annotation></semantics></math> unique prompts for training.
We use AdamW <cite class="ltx_cite ltx_citemacro_citep">(Loshchilov &amp; Hutter, <a class="ltx_ref" href="https://arxiv.org/html/2410.05255v1#bib.bib21" title="">2019</a>)</cite> as the optimizer. We train our model on <math alttext="8" class="ltx_Math" display="inline" id="S5.SS1.SSS1.p1.4.m4.1"><semantics id="S5.SS1.SSS1.p1.4.m4.1a"><mn id="S5.SS1.SSS1.p1.4.m4.1.1" xref="S5.SS1.SSS1.p1.4.m4.1.1.cmml">8</mn><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS1.p1.4.m4.1b"><cn id="S5.SS1.SSS1.p1.4.m4.1.1.cmml" type="integer" xref="S5.SS1.SSS1.p1.4.m4.1.1">8</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS1.p1.4.m4.1c">8</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.SSS1.p1.4.m4.1d">8</annotation></semantics></math> NVIDIA A100 GPUs with local batch size <math alttext="1" class="ltx_Math" display="inline" id="S5.SS1.SSS1.p1.5.m5.1"><semantics id="S5.SS1.SSS1.p1.5.m5.1a"><mn id="S5.SS1.SSS1.p1.5.m5.1.1" xref="S5.SS1.SSS1.p1.5.m5.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS1.p1.5.m5.1b"><cn id="S5.SS1.SSS1.p1.5.m5.1.1.cmml" type="integer" xref="S5.SS1.SSS1.p1.5.m5.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS1.p1.5.m5.1c">1</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.SSS1.p1.5.m5.1d">1</annotation></semantics></math>, and the number of gradient accumulation steps is set to <math alttext="256" class="ltx_Math" display="inline" id="S5.SS1.SSS1.p1.6.m6.1"><semantics id="S5.SS1.SSS1.p1.6.m6.1a"><mn id="S5.SS1.SSS1.p1.6.m6.1.1" xref="S5.SS1.SSS1.p1.6.m6.1.1.cmml">256</mn><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS1.p1.6.m6.1b"><cn id="S5.SS1.SSS1.p1.6.m6.1.1.cmml" type="integer" xref="S5.SS1.SSS1.p1.6.m6.1.1">256</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS1.p1.6.m6.1c">256</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.SSS1.p1.6.m6.1d">256</annotation></semantics></math>. Thus, the equivalent batch size is <math alttext="2048" class="ltx_Math" display="inline" id="S5.SS1.SSS1.p1.7.m7.1"><semantics id="S5.SS1.SSS1.p1.7.m7.1a"><mn id="S5.SS1.SSS1.p1.7.m7.1.1" xref="S5.SS1.SSS1.p1.7.m7.1.1.cmml">2048</mn><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS1.p1.7.m7.1b"><cn id="S5.SS1.SSS1.p1.7.m7.1.1.cmml" type="integer" xref="S5.SS1.SSS1.p1.7.m7.1.1">2048</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS1.p1.7.m7.1c">2048</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.SSS1.p1.7.m7.1d">2048</annotation></semantics></math>. We train models at fixed-square resolutions. A learning rate of <math alttext="5\times 10^{-9}" class="ltx_Math" display="inline" id="S5.SS1.SSS1.p1.8.m8.1"><semantics id="S5.SS1.SSS1.p1.8.m8.1a"><mrow id="S5.SS1.SSS1.p1.8.m8.1.1" xref="S5.SS1.SSS1.p1.8.m8.1.1.cmml"><mn id="S5.SS1.SSS1.p1.8.m8.1.1.2" xref="S5.SS1.SSS1.p1.8.m8.1.1.2.cmml">5</mn><mo id="S5.SS1.SSS1.p1.8.m8.1.1.1" lspace="0.222em" rspace="0.222em" xref="S5.SS1.SSS1.p1.8.m8.1.1.1.cmml">×</mo><msup id="S5.SS1.SSS1.p1.8.m8.1.1.3" xref="S5.SS1.SSS1.p1.8.m8.1.1.3.cmml"><mn id="S5.SS1.SSS1.p1.8.m8.1.1.3.2" xref="S5.SS1.SSS1.p1.8.m8.1.1.3.2.cmml">10</mn><mrow id="S5.SS1.SSS1.p1.8.m8.1.1.3.3" xref="S5.SS1.SSS1.p1.8.m8.1.1.3.3.cmml"><mo id="S5.SS1.SSS1.p1.8.m8.1.1.3.3a" xref="S5.SS1.SSS1.p1.8.m8.1.1.3.3.cmml">−</mo><mn id="S5.SS1.SSS1.p1.8.m8.1.1.3.3.2" xref="S5.SS1.SSS1.p1.8.m8.1.1.3.3.2.cmml">9</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS1.p1.8.m8.1b"><apply id="S5.SS1.SSS1.p1.8.m8.1.1.cmml" xref="S5.SS1.SSS1.p1.8.m8.1.1"><times id="S5.SS1.SSS1.p1.8.m8.1.1.1.cmml" xref="S5.SS1.SSS1.p1.8.m8.1.1.1"></times><cn id="S5.SS1.SSS1.p1.8.m8.1.1.2.cmml" type="integer" xref="S5.SS1.SSS1.p1.8.m8.1.1.2">5</cn><apply id="S5.SS1.SSS1.p1.8.m8.1.1.3.cmml" xref="S5.SS1.SSS1.p1.8.m8.1.1.3"><csymbol cd="ambiguous" id="S5.SS1.SSS1.p1.8.m8.1.1.3.1.cmml" xref="S5.SS1.SSS1.p1.8.m8.1.1.3">superscript</csymbol><cn id="S5.SS1.SSS1.p1.8.m8.1.1.3.2.cmml" type="integer" xref="S5.SS1.SSS1.p1.8.m8.1.1.3.2">10</cn><apply id="S5.SS1.SSS1.p1.8.m8.1.1.3.3.cmml" xref="S5.SS1.SSS1.p1.8.m8.1.1.3.3"><minus id="S5.SS1.SSS1.p1.8.m8.1.1.3.3.1.cmml" xref="S5.SS1.SSS1.p1.8.m8.1.1.3.3"></minus><cn id="S5.SS1.SSS1.p1.8.m8.1.1.3.3.2.cmml" type="integer" xref="S5.SS1.SSS1.p1.8.m8.1.1.3.3.2">9</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS1.p1.8.m8.1c">5\times 10^{-9}</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.SSS1.p1.8.m8.1d">5 × 10 start_POSTSUPERSCRIPT - 9 end_POSTSUPERSCRIPT</annotation></semantics></math> is used, as we find that a smaller learning rate can help avoid overfitting. We set <math alttext="\beta" class="ltx_Math" display="inline" id="S5.SS1.SSS1.p1.9.m9.1"><semantics id="S5.SS1.SSS1.p1.9.m9.1a"><mi id="S5.SS1.SSS1.p1.9.m9.1.1" xref="S5.SS1.SSS1.p1.9.m9.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS1.p1.9.m9.1b"><ci id="S5.SS1.SSS1.p1.9.m9.1.1.cmml" xref="S5.SS1.SSS1.p1.9.m9.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS1.p1.9.m9.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.SSS1.p1.9.m9.1d">italic_β</annotation></semantics></math> to <math alttext="2000" class="ltx_Math" display="inline" id="S5.SS1.SSS1.p1.10.m10.1"><semantics id="S5.SS1.SSS1.p1.10.m10.1a"><mn id="S5.SS1.SSS1.p1.10.m10.1.1" xref="S5.SS1.SSS1.p1.10.m10.1.1.cmml">2000</mn><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS1.p1.10.m10.1b"><cn id="S5.SS1.SSS1.p1.10.m10.1.1.cmml" type="integer" xref="S5.SS1.SSS1.p1.10.m10.1.1">2000</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS1.p1.10.m10.1c">2000</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.SSS1.p1.10.m10.1d">2000</annotation></semantics></math>, which stays the same in Diffusion-DPO. For evaluation datasets, we use the validation set of the Pick-a-Pic dataset, the Parti-prompt, and HPSv2, respectively. We utilize the default stable diffusion inference pipeline from Huggingface when testing. The metrics we use are PickScore, HPSv2 score, ImageReward score, and Aesthetic score.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_subsubsection" id="S5.SS1.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.1.2 </span>Text-to-Video</h4><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S5.SS1.SSS2.p1">
<p class="ltx_p" id="S5.SS1.SSS2.p1.4">To further verify that SePPO works well in text-to-video generation tasks, we test our methods based on the AnimateDiff <cite class="ltx_cite ltx_citemacro_citep">(Guo et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05255v1#bib.bib8" title="">2024</a>)</cite>. We use the training set from MagicTime <cite class="ltx_cite ltx_citemacro_citep">(Yuan et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05255v1#bib.bib33" title="">2024b</a>)</cite> as our training set and utilize the ChronoMagic-Bench-150 <cite class="ltx_cite ltx_citemacro_citep">(Yuan et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05255v1#bib.bib34" title="">2024c</a>)</cite> dataset as our validation set. We use LoRA <cite class="ltx_cite ltx_citemacro_citep">(Hu et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05255v1#bib.bib14" title="">2022</a>)</cite> to train all the models at the resolution <math alttext="256\times 256" class="ltx_Math" display="inline" id="S5.SS1.SSS2.p1.1.m1.1"><semantics id="S5.SS1.SSS2.p1.1.m1.1a"><mrow id="S5.SS1.SSS2.p1.1.m1.1.1" xref="S5.SS1.SSS2.p1.1.m1.1.1.cmml"><mn id="S5.SS1.SSS2.p1.1.m1.1.1.2" xref="S5.SS1.SSS2.p1.1.m1.1.1.2.cmml">256</mn><mo id="S5.SS1.SSS2.p1.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S5.SS1.SSS2.p1.1.m1.1.1.1.cmml">×</mo><mn id="S5.SS1.SSS2.p1.1.m1.1.1.3" xref="S5.SS1.SSS2.p1.1.m1.1.1.3.cmml">256</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS2.p1.1.m1.1b"><apply id="S5.SS1.SSS2.p1.1.m1.1.1.cmml" xref="S5.SS1.SSS2.p1.1.m1.1.1"><times id="S5.SS1.SSS2.p1.1.m1.1.1.1.cmml" xref="S5.SS1.SSS2.p1.1.m1.1.1.1"></times><cn id="S5.SS1.SSS2.p1.1.m1.1.1.2.cmml" type="integer" xref="S5.SS1.SSS2.p1.1.m1.1.1.2">256</cn><cn id="S5.SS1.SSS2.p1.1.m1.1.1.3.cmml" type="integer" xref="S5.SS1.SSS2.p1.1.m1.1.1.3">256</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS2.p1.1.m1.1c">256\times 256</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.SSS2.p1.1.m1.1d">256 × 256</annotation></semantics></math> and <math alttext="16" class="ltx_Math" display="inline" id="S5.SS1.SSS2.p1.2.m2.1"><semantics id="S5.SS1.SSS2.p1.2.m2.1a"><mn id="S5.SS1.SSS2.p1.2.m2.1.1" xref="S5.SS1.SSS2.p1.2.m2.1.1.cmml">16</mn><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS2.p1.2.m2.1b"><cn id="S5.SS1.SSS2.p1.2.m2.1.1.cmml" type="integer" xref="S5.SS1.SSS2.p1.2.m2.1.1">16</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS2.p1.2.m2.1c">16</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.SSS2.p1.2.m2.1d">16</annotation></semantics></math> frames are taken by dynamic frames extraction from each video. The learning rate is set to <math alttext="5\times 10^{-6}" class="ltx_Math" display="inline" id="S5.SS1.SSS2.p1.3.m3.1"><semantics id="S5.SS1.SSS2.p1.3.m3.1a"><mrow id="S5.SS1.SSS2.p1.3.m3.1.1" xref="S5.SS1.SSS2.p1.3.m3.1.1.cmml"><mn id="S5.SS1.SSS2.p1.3.m3.1.1.2" xref="S5.SS1.SSS2.p1.3.m3.1.1.2.cmml">5</mn><mo id="S5.SS1.SSS2.p1.3.m3.1.1.1" lspace="0.222em" rspace="0.222em" xref="S5.SS1.SSS2.p1.3.m3.1.1.1.cmml">×</mo><msup id="S5.SS1.SSS2.p1.3.m3.1.1.3" xref="S5.SS1.SSS2.p1.3.m3.1.1.3.cmml"><mn id="S5.SS1.SSS2.p1.3.m3.1.1.3.2" xref="S5.SS1.SSS2.p1.3.m3.1.1.3.2.cmml">10</mn><mrow id="S5.SS1.SSS2.p1.3.m3.1.1.3.3" xref="S5.SS1.SSS2.p1.3.m3.1.1.3.3.cmml"><mo id="S5.SS1.SSS2.p1.3.m3.1.1.3.3a" xref="S5.SS1.SSS2.p1.3.m3.1.1.3.3.cmml">−</mo><mn id="S5.SS1.SSS2.p1.3.m3.1.1.3.3.2" xref="S5.SS1.SSS2.p1.3.m3.1.1.3.3.2.cmml">6</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS2.p1.3.m3.1b"><apply id="S5.SS1.SSS2.p1.3.m3.1.1.cmml" xref="S5.SS1.SSS2.p1.3.m3.1.1"><times id="S5.SS1.SSS2.p1.3.m3.1.1.1.cmml" xref="S5.SS1.SSS2.p1.3.m3.1.1.1"></times><cn id="S5.SS1.SSS2.p1.3.m3.1.1.2.cmml" type="integer" xref="S5.SS1.SSS2.p1.3.m3.1.1.2">5</cn><apply id="S5.SS1.SSS2.p1.3.m3.1.1.3.cmml" xref="S5.SS1.SSS2.p1.3.m3.1.1.3"><csymbol cd="ambiguous" id="S5.SS1.SSS2.p1.3.m3.1.1.3.1.cmml" xref="S5.SS1.SSS2.p1.3.m3.1.1.3">superscript</csymbol><cn id="S5.SS1.SSS2.p1.3.m3.1.1.3.2.cmml" type="integer" xref="S5.SS1.SSS2.p1.3.m3.1.1.3.2">10</cn><apply id="S5.SS1.SSS2.p1.3.m3.1.1.3.3.cmml" xref="S5.SS1.SSS2.p1.3.m3.1.1.3.3"><minus id="S5.SS1.SSS2.p1.3.m3.1.1.3.3.1.cmml" xref="S5.SS1.SSS2.p1.3.m3.1.1.3.3"></minus><cn id="S5.SS1.SSS2.p1.3.m3.1.1.3.3.2.cmml" type="integer" xref="S5.SS1.SSS2.p1.3.m3.1.1.3.3.2">6</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS2.p1.3.m3.1c">5\times 10^{-6}</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.SSS2.p1.3.m3.1d">5 × 10 start_POSTSUPERSCRIPT - 6 end_POSTSUPERSCRIPT</annotation></semantics></math> and the training steps are set to <math alttext="1000" class="ltx_Math" display="inline" id="S5.SS1.SSS2.p1.4.m4.1"><semantics id="S5.SS1.SSS2.p1.4.m4.1a"><mn id="S5.SS1.SSS2.p1.4.m4.1.1" xref="S5.SS1.SSS2.p1.4.m4.1.1.cmml">1000</mn><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS2.p1.4.m4.1b"><cn id="S5.SS1.SSS2.p1.4.m4.1.1.cmml" type="integer" xref="S5.SS1.SSS2.p1.4.m4.1.1">1000</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS2.p1.4.m4.1c">1000</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.SSS2.p1.4.m4.1d">1000</annotation></semantics></math>. The metrics we use are FID <cite class="ltx_cite ltx_citemacro_citep">(Heusel et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05255v1#bib.bib10" title="">2017</a>)</cite>, LPIPS <cite class="ltx_cite ltx_citemacro_citep">(Zhang et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05255v1#bib.bib35" title="">2018</a>)</cite>, SSIM <cite class="ltx_cite ltx_citemacro_citep">(Wang et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05255v1#bib.bib30" title="">2004</a>)</cite>, PSNR <cite class="ltx_cite ltx_citemacro_citep">(Hore &amp; Ziou, <a class="ltx_ref" href="https://arxiv.org/html/2410.05255v1#bib.bib13" title="">2010</a>)</cite> and FVD <cite class="ltx_cite ltx_citemacro_citep">(Unterthiner et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05255v1#bib.bib27" title="">2019</a>)</cite>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
</section>
<section class="ltx_subsection" id="S5.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2 </span>Results</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<section class="ltx_subsubsection" id="S5.SS2.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.2.1 </span>Analysis of Text-to-Image</h4><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S5.SS2.SSS1.p1">
<p class="ltx_p" id="S5.SS2.SSS1.p1.3">To verify the effectiveness of the proposed SePPO, we compare SePPO with the SOTA methods, including DDPO <cite class="ltx_cite ltx_citemacro_citep">(Black et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05255v1#bib.bib1" title="">2024</a>)</cite>, D3PO <cite class="ltx_cite ltx_citemacro_citep">(Yang et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05255v1#bib.bib31" title="">2024</a>)</cite>, Diffusion-DPO, SPO <cite class="ltx_cite ltx_citemacro_citep">(Liang et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05255v1#bib.bib20" title="">2024b</a>)</cite> and SPIN-Diffusion. We first report all the comparison results on the validation unique split of Pick-a-Pic dataset in Table <a class="ltx_ref" href="https://arxiv.org/html/2410.05255v1#S5.T1" title="Table 1 ‣ 5.2.1 Analysis of Text-to-Image ‣ 5.2 Results ‣ 5 Experiments ‣ SePPO: Semi-Policy Preference Optimization for Diffusion Alignment"><span class="ltx_text ltx_ref_tag">1</span></a>. Specifically, SFT<sup class="ltx_sup" id="S5.SS2.SSS1.p1.3.1"><span class="ltx_text ltx_font_italic" id="S5.SS2.SSS1.p1.3.1.1">w</span></sup> indicates that we use the <span class="ltx_text ltx_font_bold" id="S5.SS2.SSS1.p1.3.2">winning</span> images from the Pick-a-Pic dataset for supervised fine-tuning. SePPO<sup class="ltx_sup" id="S5.SS2.SSS1.p1.3.3"><span class="ltx_text ltx_font_italic" id="S5.SS2.SSS1.p1.3.3.1">r</span></sup> and SePPO<sup class="ltx_sup" id="S5.SS2.SSS1.p1.3.4"><span class="ltx_text ltx_font_italic" id="S5.SS2.SSS1.p1.3.4.1">w</span></sup> indicate that we use <span class="ltx_text ltx_font_bold" id="S5.SS2.SSS1.p1.3.5">randomly chosen</span> images or <span class="ltx_text ltx_font_bold" id="S5.SS2.SSS1.p1.3.6">winning</span> images in the Pick-a-Pic dataset as the training set for SePPO. SePPO outperforms previous methods across most metrics, even those that utilize reward models during the training process, such as DDPO and SPO. Moreover, SePPO does not require the three-stage training process like SPIN-Diffusion, nor does it require the complex selection of hyperparameters. Notably, we observe that SePPO significantly improves ImageReward, which may be attributed to the fact that ImageReward reflects not only the alignment between the image and human preference but also the degree of alignment between the image and the text. In contrast, the other metrics primarily reflect the alignment between the image and human preference.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S5.SS2.SSS1.p2">
<p class="ltx_p" id="S5.SS2.SSS1.p2.5">Previous methods like SPIN-Diffusion used the winning images from the Pick-a-Pic dataset as training data. In our experiments, aside from training using the winning images as done previously, we also conduct an experiment where we randomly select images from both the winner and the losing sets as training data for SePPO, which we refer to as SePPO<sup class="ltx_sup" id="S5.SS2.SSS1.p2.5.1"><span class="ltx_text ltx_font_italic" id="S5.SS2.SSS1.p2.5.1.1">r</span></sup>. Despite using a lower-quality training data distribution, SePPO<sup class="ltx_sup" id="S5.SS2.SSS1.p2.5.2"><span class="ltx_text ltx_font_italic" id="S5.SS2.SSS1.p2.5.2.1">r</span></sup> still outperforms other methods on most metrics. Notably, when compared to SFT<sup class="ltx_sup" id="S5.SS2.SSS1.p2.5.3"><span class="ltx_text ltx_font_italic" id="S5.SS2.SSS1.p2.5.3.1">w</span></sup>, which is fine-tuned on the winning images, SePPO<sup class="ltx_sup" id="S5.SS2.SSS1.p2.5.4"><span class="ltx_text ltx_font_italic" id="S5.SS2.SSS1.p2.5.4.1">r</span></sup> still exceeds SFT<sup class="ltx_sup" id="S5.SS2.SSS1.p2.5.5"><span class="ltx_text ltx_font_italic" id="S5.SS2.SSS1.p2.5.5.1">w</span></sup> on three key metrics, further demonstrating the superiority of SePPO.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S5.SS2.SSS1.p3">
<p class="ltx_p" id="S5.SS2.SSS1.p3.2">To better evaluate SePPO’s out-of-distribution performance, we also test the model using the HPSv2 and Parti-prompt datasets, which have different distributions from the Pick-a-pic dataset. As shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2410.05255v1#S5.T2" title="Table 2 ‣ 5.2.1 Analysis of Text-to-Image ‣ 5.2 Results ‣ 5 Experiments ‣ SePPO: Semi-Policy Preference Optimization for Diffusion Alignment"><span class="ltx_text ltx_ref_tag">2</span></a>, SePPO outperforms all other models on these datasets. It is worth noting that SPO has not been tested on these two datasets and SPIN-Diffusion does not report their precise results. So, we reproduce the results by using the checkpoints of SPIN-Diffusion<span class="ltx_note ltx_role_footnote" id="footnote1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>https://huggingface.co/UCLA-AGI/SPIN-Diffusion-iter3</span></span></span> and SPO<span class="ltx_note ltx_role_footnote" id="footnote2"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span>https://huggingface.co/SPO-Diffusion-Models/SPO-SD-v1-5_4k-p_10ep</span></span></span> available on HuggingFace, referred to as SPIN-Diffusion<sup class="ltx_sup" id="S5.SS2.SSS1.p3.2.1"><span class="ltx_text ltx_font_italic" id="S5.SS2.SSS1.p3.2.1.1">∗</span></sup> and SPO<sup class="ltx_sup" id="S5.SS2.SSS1.p3.2.2"><span class="ltx_text ltx_font_italic" id="S5.SS2.SSS1.p3.2.2.1">∗</span></sup>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S5.SS2.SSS1.p4">
<p class="ltx_p" id="S5.SS2.SSS1.p4.1">On the left side of Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.05255v1#S5.F3" title="Figure 3 ‣ 5.2.1 Analysis of Text-to-Image ‣ 5.2 Results ‣ 5 Experiments ‣ SePPO: Semi-Policy Preference Optimization for Diffusion Alignment"><span class="ltx_text ltx_ref_tag">3</span></a>, we further explore the relationship between our AAF rate and model performance. AAF rate is defined as the ratio <math alttext="(\#{\rm{sign}}=-1)/(\#{\rm total})" class="ltx_Math" display="inline" id="S5.SS2.SSS1.p4.1.m1.2"><semantics id="S5.SS2.SSS1.p4.1.m1.2a"><mrow id="S5.SS2.SSS1.p4.1.m1.2.2" xref="S5.SS2.SSS1.p4.1.m1.2.2.cmml"><mrow id="S5.SS2.SSS1.p4.1.m1.1.1.1.1" xref="S5.SS2.SSS1.p4.1.m1.1.1.1.1.1.cmml"><mo id="S5.SS2.SSS1.p4.1.m1.1.1.1.1.2" stretchy="false" xref="S5.SS2.SSS1.p4.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S5.SS2.SSS1.p4.1.m1.1.1.1.1.1" xref="S5.SS2.SSS1.p4.1.m1.1.1.1.1.1.cmml"><mrow id="S5.SS2.SSS1.p4.1.m1.1.1.1.1.1.2" xref="S5.SS2.SSS1.p4.1.m1.1.1.1.1.1.2.cmml"><mi id="S5.SS2.SSS1.p4.1.m1.1.1.1.1.1.2.2" mathvariant="normal" xref="S5.SS2.SSS1.p4.1.m1.1.1.1.1.1.2.2.cmml">#</mi><mo id="S5.SS2.SSS1.p4.1.m1.1.1.1.1.1.2.1" xref="S5.SS2.SSS1.p4.1.m1.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="S5.SS2.SSS1.p4.1.m1.1.1.1.1.1.2.3" xref="S5.SS2.SSS1.p4.1.m1.1.1.1.1.1.2.3.cmml">sign</mi></mrow><mo id="S5.SS2.SSS1.p4.1.m1.1.1.1.1.1.1" xref="S5.SS2.SSS1.p4.1.m1.1.1.1.1.1.1.cmml">=</mo><mrow id="S5.SS2.SSS1.p4.1.m1.1.1.1.1.1.3" xref="S5.SS2.SSS1.p4.1.m1.1.1.1.1.1.3.cmml"><mo id="S5.SS2.SSS1.p4.1.m1.1.1.1.1.1.3a" xref="S5.SS2.SSS1.p4.1.m1.1.1.1.1.1.3.cmml">−</mo><mn id="S5.SS2.SSS1.p4.1.m1.1.1.1.1.1.3.2" xref="S5.SS2.SSS1.p4.1.m1.1.1.1.1.1.3.2.cmml">1</mn></mrow></mrow><mo id="S5.SS2.SSS1.p4.1.m1.1.1.1.1.3" stretchy="false" xref="S5.SS2.SSS1.p4.1.m1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S5.SS2.SSS1.p4.1.m1.2.2.3" xref="S5.SS2.SSS1.p4.1.m1.2.2.3.cmml">/</mo><mrow id="S5.SS2.SSS1.p4.1.m1.2.2.2.1" xref="S5.SS2.SSS1.p4.1.m1.2.2.2.1.1.cmml"><mo id="S5.SS2.SSS1.p4.1.m1.2.2.2.1.2" stretchy="false" xref="S5.SS2.SSS1.p4.1.m1.2.2.2.1.1.cmml">(</mo><mrow id="S5.SS2.SSS1.p4.1.m1.2.2.2.1.1" xref="S5.SS2.SSS1.p4.1.m1.2.2.2.1.1.cmml"><mi id="S5.SS2.SSS1.p4.1.m1.2.2.2.1.1.2" mathvariant="normal" xref="S5.SS2.SSS1.p4.1.m1.2.2.2.1.1.2.cmml">#</mi><mo id="S5.SS2.SSS1.p4.1.m1.2.2.2.1.1.1" xref="S5.SS2.SSS1.p4.1.m1.2.2.2.1.1.1.cmml">⁢</mo><mi id="S5.SS2.SSS1.p4.1.m1.2.2.2.1.1.3" xref="S5.SS2.SSS1.p4.1.m1.2.2.2.1.1.3.cmml">total</mi></mrow><mo id="S5.SS2.SSS1.p4.1.m1.2.2.2.1.3" stretchy="false" xref="S5.SS2.SSS1.p4.1.m1.2.2.2.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS1.p4.1.m1.2b"><apply id="S5.SS2.SSS1.p4.1.m1.2.2.cmml" xref="S5.SS2.SSS1.p4.1.m1.2.2"><divide id="S5.SS2.SSS1.p4.1.m1.2.2.3.cmml" xref="S5.SS2.SSS1.p4.1.m1.2.2.3"></divide><apply id="S5.SS2.SSS1.p4.1.m1.1.1.1.1.1.cmml" xref="S5.SS2.SSS1.p4.1.m1.1.1.1.1"><eq id="S5.SS2.SSS1.p4.1.m1.1.1.1.1.1.1.cmml" xref="S5.SS2.SSS1.p4.1.m1.1.1.1.1.1.1"></eq><apply id="S5.SS2.SSS1.p4.1.m1.1.1.1.1.1.2.cmml" xref="S5.SS2.SSS1.p4.1.m1.1.1.1.1.1.2"><times id="S5.SS2.SSS1.p4.1.m1.1.1.1.1.1.2.1.cmml" xref="S5.SS2.SSS1.p4.1.m1.1.1.1.1.1.2.1"></times><ci id="S5.SS2.SSS1.p4.1.m1.1.1.1.1.1.2.2.cmml" xref="S5.SS2.SSS1.p4.1.m1.1.1.1.1.1.2.2">#</ci><ci id="S5.SS2.SSS1.p4.1.m1.1.1.1.1.1.2.3.cmml" xref="S5.SS2.SSS1.p4.1.m1.1.1.1.1.1.2.3">sign</ci></apply><apply id="S5.SS2.SSS1.p4.1.m1.1.1.1.1.1.3.cmml" xref="S5.SS2.SSS1.p4.1.m1.1.1.1.1.1.3"><minus id="S5.SS2.SSS1.p4.1.m1.1.1.1.1.1.3.1.cmml" xref="S5.SS2.SSS1.p4.1.m1.1.1.1.1.1.3"></minus><cn id="S5.SS2.SSS1.p4.1.m1.1.1.1.1.1.3.2.cmml" type="integer" xref="S5.SS2.SSS1.p4.1.m1.1.1.1.1.1.3.2">1</cn></apply></apply><apply id="S5.SS2.SSS1.p4.1.m1.2.2.2.1.1.cmml" xref="S5.SS2.SSS1.p4.1.m1.2.2.2.1"><times id="S5.SS2.SSS1.p4.1.m1.2.2.2.1.1.1.cmml" xref="S5.SS2.SSS1.p4.1.m1.2.2.2.1.1.1"></times><ci id="S5.SS2.SSS1.p4.1.m1.2.2.2.1.1.2.cmml" xref="S5.SS2.SSS1.p4.1.m1.2.2.2.1.1.2">#</ci><ci id="S5.SS2.SSS1.p4.1.m1.2.2.2.1.1.3.cmml" xref="S5.SS2.SSS1.p4.1.m1.2.2.2.1.1.3">total</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS1.p4.1.m1.2c">(\#{\rm{sign}}=-1)/(\#{\rm total})</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.SSS1.p4.1.m1.2d">( # roman_sign = - 1 ) / ( # roman_total )</annotation></semantics></math> in a batch of data. The AAF rate reflects the comparative performance between the current model and all previous checkpoints; a higher AAF rate indicates that the samples generated by the reference model are more likely to be negative samples for the current model, meaning that the current model is performing better relative to all previous models. We observe that, as training steps increase, both the AAF rate and PickScore gradually increase, showing a similar trend. We then display the changes in PickScore during the training process of SePPO and SFT on the right side of Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.05255v1#S5.F3" title="Figure 3 ‣ 5.2.1 Analysis of Text-to-Image ‣ 5.2 Results ‣ 5 Experiments ‣ SePPO: Semi-Policy Preference Optimization for Diffusion Alignment"><span class="ltx_text ltx_ref_tag">3</span></a>. SFT quickly converges and begins to fluctuate, while SePPO is able to steadily improve throughout the training process.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S5.SS2.SSS1.p5">
<p class="ltx_p" id="S5.SS2.SSS1.p5.1">We also visualize the results of SD-1.5, SPO, SPIN-Diffusion, and SePPO in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.05255v1#S5.F4" title="Figure 4 ‣ 5.2.1 Analysis of Text-to-Image ‣ 5.2 Results ‣ 5 Experiments ‣ SePPO: Semi-Policy Preference Optimization for Diffusion Alignment"><span class="ltx_text ltx_ref_tag">4</span></a>. SePPO is able to capture the verb “nested” and also generating better eye details. SePPO not only demonstrates superior visual quality compared to other methods but also excels in image-text alignment. This is because SePPO’s training approach, which does not rely on a reward model to guide the learning direction, allows the model to learn both human preferences and improve in areas that reward models may fail to address.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_table" id="S5.T1">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1: </span>Model Feedback Results on the Pick-a-Pic Validation Set.</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S5.T1.8">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T1.4.4">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_tt" id="S5.T1.4.4.5">Methods</th>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T1.1.1.1">PickScore <math alttext="\uparrow" class="ltx_Math" display="inline" id="S5.T1.1.1.1.m1.1"><semantics id="S5.T1.1.1.1.m1.1a"><mo id="S5.T1.1.1.1.m1.1.1" stretchy="false" xref="S5.T1.1.1.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S5.T1.1.1.1.m1.1b"><ci id="S5.T1.1.1.1.m1.1.1.cmml" xref="S5.T1.1.1.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.1.1.1.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S5.T1.1.1.1.m1.1d">↑</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T1.2.2.2">HPSv2 <math alttext="\uparrow" class="ltx_Math" display="inline" id="S5.T1.2.2.2.m1.1"><semantics id="S5.T1.2.2.2.m1.1a"><mo id="S5.T1.2.2.2.m1.1.1" stretchy="false" xref="S5.T1.2.2.2.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S5.T1.2.2.2.m1.1b"><ci id="S5.T1.2.2.2.m1.1.1.cmml" xref="S5.T1.2.2.2.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.2.2.2.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S5.T1.2.2.2.m1.1d">↑</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T1.3.3.3">ImageReward <math alttext="\uparrow" class="ltx_Math" display="inline" id="S5.T1.3.3.3.m1.1"><semantics id="S5.T1.3.3.3.m1.1a"><mo id="S5.T1.3.3.3.m1.1.1" stretchy="false" xref="S5.T1.3.3.3.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S5.T1.3.3.3.m1.1b"><ci id="S5.T1.3.3.3.m1.1.1.cmml" xref="S5.T1.3.3.3.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.3.3.3.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S5.T1.3.3.3.m1.1d">↑</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T1.4.4.4">Aesthetic <math alttext="\uparrow" class="ltx_Math" display="inline" id="S5.T1.4.4.4.m1.1"><semantics id="S5.T1.4.4.4.m1.1a"><mo id="S5.T1.4.4.4.m1.1.1" stretchy="false" xref="S5.T1.4.4.4.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S5.T1.4.4.4.m1.1b"><ci id="S5.T1.4.4.4.m1.1.1.cmml" xref="S5.T1.4.4.4.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.4.4.4.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S5.T1.4.4.4.m1.1d">↑</annotation></semantics></math>
</td>
</tr>
<tr class="ltx_tr" id="S5.T1.8.9.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" id="S5.T1.8.9.1.1">SD-1.5</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.8.9.1.2">20.53</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.8.9.1.3">23.79</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.8.9.1.4">-0.163</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.8.9.1.5">5.365</td>
</tr>
<tr class="ltx_tr" id="S5.T1.5.5">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S5.T1.5.5.1">SFT<sup class="ltx_sup" id="S5.T1.5.5.1.1"><span class="ltx_text ltx_font_italic" id="S5.T1.5.5.1.1.1">w</span></sup>
</th>
<td class="ltx_td ltx_align_center" id="S5.T1.5.5.2">21.32</td>
<td class="ltx_td ltx_align_center" id="S5.T1.5.5.3"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T1.5.5.3.1">27.14</span></td>
<td class="ltx_td ltx_align_center" id="S5.T1.5.5.4">0.519</td>
<td class="ltx_td ltx_align_center" id="S5.T1.5.5.5">5.642</td>
</tr>
<tr class="ltx_tr" id="S5.T1.8.10.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S5.T1.8.10.2.1">DDPO</th>
<td class="ltx_td ltx_align_center" id="S5.T1.8.10.2.2">21.06</td>
<td class="ltx_td ltx_align_center" id="S5.T1.8.10.2.3">24.91</td>
<td class="ltx_td ltx_align_center" id="S5.T1.8.10.2.4">0.082</td>
<td class="ltx_td ltx_align_center" id="S5.T1.8.10.2.5">5.591</td>
</tr>
<tr class="ltx_tr" id="S5.T1.8.11.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S5.T1.8.11.3.1">D3PO</th>
<td class="ltx_td ltx_align_center" id="S5.T1.8.11.3.2">20.76</td>
<td class="ltx_td ltx_align_center" id="S5.T1.8.11.3.3">23.91</td>
<td class="ltx_td ltx_align_center" id="S5.T1.8.11.3.4">-0.124</td>
<td class="ltx_td ltx_align_center" id="S5.T1.8.11.3.5">5.527</td>
</tr>
<tr class="ltx_tr" id="S5.T1.8.12.4">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S5.T1.8.12.4.1">Diffusion-DPO</th>
<td class="ltx_td ltx_align_center" id="S5.T1.8.12.4.2">20.98</td>
<td class="ltx_td ltx_align_center" id="S5.T1.8.12.4.3">25.05</td>
<td class="ltx_td ltx_align_center" id="S5.T1.8.12.4.4">0.112</td>
<td class="ltx_td ltx_align_center" id="S5.T1.8.12.4.5">5.505</td>
</tr>
<tr class="ltx_tr" id="S5.T1.8.13.5">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S5.T1.8.13.5.1">SPO</th>
<td class="ltx_td ltx_align_center" id="S5.T1.8.13.5.2">21.43</td>
<td class="ltx_td ltx_align_center" id="S5.T1.8.13.5.3">26.45</td>
<td class="ltx_td ltx_align_center" id="S5.T1.8.13.5.4">0.171</td>
<td class="ltx_td ltx_align_center" id="S5.T1.8.13.5.5"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T1.8.13.5.5.1">5.887</span></td>
</tr>
<tr class="ltx_tr" id="S5.T1.6.6">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S5.T1.6.6.1">SPIN-Diffusion<sup class="ltx_sup" id="S5.T1.6.6.1.1">∗</sup>
</th>
<td class="ltx_td ltx_align_center" id="S5.T1.6.6.2"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T1.6.6.2.1">21.55</span></td>
<td class="ltx_td ltx_align_center" id="S5.T1.6.6.3">27.10</td>
<td class="ltx_td ltx_align_center" id="S5.T1.6.6.4">0.484</td>
<td class="ltx_td ltx_align_center" id="S5.T1.6.6.5"><span class="ltx_text ltx_font_bold" id="S5.T1.6.6.5.1">5.929</span></td>
</tr>
<tr class="ltx_tr" id="S5.T1.7.7">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" id="S5.T1.7.7.1">SePPO<sup class="ltx_sup" id="S5.T1.7.7.1.1"><span class="ltx_text ltx_font_italic" id="S5.T1.7.7.1.1.1">r</span></sup>
</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.7.7.2">21.33</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.7.7.3">27.07</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.7.7.4"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T1.7.7.4.1">0.524</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.7.7.5">5.712</td>
</tr>
<tr class="ltx_tr" id="S5.T1.8.8">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb" id="S5.T1.8.8.1">SePPO<sup class="ltx_sup" id="S5.T1.8.8.1.1"><span class="ltx_text ltx_font_italic" id="S5.T1.8.8.1.1.1">w</span></sup>
</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T1.8.8.2"><span class="ltx_text ltx_font_bold" id="S5.T1.8.8.2.1">21.57</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T1.8.8.3"><span class="ltx_text ltx_font_bold" id="S5.T1.8.8.3.1">27.20</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T1.8.8.4"><span class="ltx_text ltx_font_bold" id="S5.T1.8.8.4.1">0.615</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T1.8.8.5">5.772</td>
</tr>
</tbody>
</table>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_table" id="S5.T2">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 2: </span>Model Feedback Results on the HPSv2 and Parti-prompt Datasets.</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S5.T2.8">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S5.T2.4.4">
<th class="ltx_td ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt" id="S5.T2.4.4.5"></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" colspan="2" id="S5.T2.1.1.1">PickScore <math alttext="\uparrow" class="ltx_Math" display="inline" id="S5.T2.1.1.1.m1.1"><semantics id="S5.T2.1.1.1.m1.1a"><mo id="S5.T2.1.1.1.m1.1.1" stretchy="false" xref="S5.T2.1.1.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S5.T2.1.1.1.m1.1b"><ci id="S5.T2.1.1.1.m1.1.1.cmml" xref="S5.T2.1.1.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.1.1.1.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S5.T2.1.1.1.m1.1d">↑</annotation></semantics></math>
</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" colspan="2" id="S5.T2.2.2.2">HPSv2 <math alttext="\uparrow" class="ltx_Math" display="inline" id="S5.T2.2.2.2.m1.1"><semantics id="S5.T2.2.2.2.m1.1a"><mo id="S5.T2.2.2.2.m1.1.1" stretchy="false" xref="S5.T2.2.2.2.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S5.T2.2.2.2.m1.1b"><ci id="S5.T2.2.2.2.m1.1.1.cmml" xref="S5.T2.2.2.2.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.2.2.2.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S5.T2.2.2.2.m1.1d">↑</annotation></semantics></math>
</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" colspan="2" id="S5.T2.3.3.3">ImageReward <math alttext="\uparrow" class="ltx_Math" display="inline" id="S5.T2.3.3.3.m1.1"><semantics id="S5.T2.3.3.3.m1.1a"><mo id="S5.T2.3.3.3.m1.1.1" stretchy="false" xref="S5.T2.3.3.3.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S5.T2.3.3.3.m1.1b"><ci id="S5.T2.3.3.3.m1.1.1.cmml" xref="S5.T2.3.3.3.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.3.3.3.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S5.T2.3.3.3.m1.1d">↑</annotation></semantics></math>
</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2" id="S5.T2.4.4.4">Aesthetic <math alttext="\uparrow" class="ltx_Math" display="inline" id="S5.T2.4.4.4.m1.1"><semantics id="S5.T2.4.4.4.m1.1a"><mo id="S5.T2.4.4.4.m1.1.1" stretchy="false" xref="S5.T2.4.4.4.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S5.T2.4.4.4.m1.1b"><ci id="S5.T2.4.4.4.m1.1.1.cmml" xref="S5.T2.4.4.4.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.4.4.4.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S5.T2.4.4.4.m1.1d">↑</annotation></semantics></math>
</th>
</tr>
<tr class="ltx_tr" id="S5.T2.8.9.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r" id="S5.T2.8.9.1.1"><span class="ltx_text" id="S5.T2.8.9.1.1.1">Methods</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S5.T2.8.9.1.2">HPS</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r" id="S5.T2.8.9.1.3">Parti</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S5.T2.8.9.1.4">HPS</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r" id="S5.T2.8.9.1.5">Parti</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S5.T2.8.9.1.6">HPS</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r" id="S5.T2.8.9.1.7">Parti</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S5.T2.8.9.1.8">HPS</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S5.T2.8.9.1.9">Parti</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T2.8.10.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S5.T2.8.10.1.1">SD-1.5</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.8.10.1.2">20.95</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.8.10.1.3">21.38</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.8.10.1.4">27.17</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.8.10.1.5">26.70</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.8.10.1.6">0.08</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.8.10.1.7">0.16</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.8.10.1.8">5.55</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.8.10.1.9">5.33</td>
</tr>
<tr class="ltx_tr" id="S5.T2.5.5">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T2.5.5.1">SFT<sup class="ltx_sup" id="S5.T2.5.5.1.1"><span class="ltx_text ltx_font_italic" id="S5.T2.5.5.1.1.1">w</span></sup>
</th>
<td class="ltx_td ltx_align_center" id="S5.T2.5.5.2">21.50</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.5.5.3">21.68</td>
<td class="ltx_td ltx_align_center" id="S5.T2.5.5.4"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T2.5.5.4.1">27.88</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.5.5.5">27.40</td>
<td class="ltx_td ltx_align_center" id="S5.T2.5.5.6"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T2.5.5.6.1">0.68</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.5.5.7"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T2.5.5.7.1">0.56</span></td>
<td class="ltx_td ltx_align_center" id="S5.T2.5.5.8">5.82</td>
<td class="ltx_td ltx_align_center" id="S5.T2.5.5.9">5.53</td>
</tr>
<tr class="ltx_tr" id="S5.T2.8.11.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T2.8.11.2.1">Diffusion-DPO</th>
<td class="ltx_td ltx_align_center" id="S5.T2.8.11.2.2">21.40</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.8.11.2.3">21.63</td>
<td class="ltx_td ltx_align_center" id="S5.T2.8.11.2.4">27.23</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.8.11.2.5">26.93</td>
<td class="ltx_td ltx_align_center" id="S5.T2.8.11.2.6">0.30</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.8.11.2.7">0.32</td>
<td class="ltx_td ltx_align_center" id="S5.T2.8.11.2.8">5.68</td>
<td class="ltx_td ltx_align_center" id="S5.T2.8.11.2.9">5.41</td>
</tr>
<tr class="ltx_tr" id="S5.T2.8.12.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T2.8.12.3.1">Diffusion-RPO</th>
<td class="ltx_td ltx_align_center" id="S5.T2.8.12.3.2">21.43</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.8.12.3.3">21.66</td>
<td class="ltx_td ltx_align_center" id="S5.T2.8.12.3.4">27.37</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.8.12.3.5">27.05</td>
<td class="ltx_td ltx_align_center" id="S5.T2.8.12.3.6">0.34</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.8.12.3.7">0.39</td>
<td class="ltx_td ltx_align_center" id="S5.T2.8.12.3.8">5.69</td>
<td class="ltx_td ltx_align_center" id="S5.T2.8.12.3.9">5.43</td>
</tr>
<tr class="ltx_tr" id="S5.T2.6.6">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T2.6.6.1">SPO<sup class="ltx_sup" id="S5.T2.6.6.1.1">∗</sup>
</th>
<td class="ltx_td ltx_align_center" id="S5.T2.6.6.2">21.87</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.6.6.3">21.85</td>
<td class="ltx_td ltx_align_center" id="S5.T2.6.6.4">27.60</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.6.6.5">27.41</td>
<td class="ltx_td ltx_align_center" id="S5.T2.6.6.6">0.41</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.6.6.7">0.42</td>
<td class="ltx_td ltx_align_center" id="S5.T2.6.6.8">5.87</td>
<td class="ltx_td ltx_align_center" id="S5.T2.6.6.9">5.63</td>
</tr>
<tr class="ltx_tr" id="S5.T2.7.7">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T2.7.7.1">SPIN-Diffusion<sup class="ltx_sup" id="S5.T2.7.7.1.1">∗</sup>
</th>
<td class="ltx_td ltx_align_center" id="S5.T2.7.7.2"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T2.7.7.2.1">21.88</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.7.7.3"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T2.7.7.3.1">21.91</span></td>
<td class="ltx_td ltx_align_center" id="S5.T2.7.7.4">27.71</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.7.7.5"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T2.7.7.5.1">27.58</span></td>
<td class="ltx_td ltx_align_center" id="S5.T2.7.7.6">0.54</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.7.7.7">0.51</td>
<td class="ltx_td ltx_align_center" id="S5.T2.7.7.8"><span class="ltx_text ltx_font_bold" id="S5.T2.7.7.8.1">6.05</span></td>
<td class="ltx_td ltx_align_center" id="S5.T2.7.7.9"><span class="ltx_text ltx_font_bold" id="S5.T2.7.7.9.1">5.78</span></td>
</tr>
<tr class="ltx_tr" id="S5.T2.8.8">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_r ltx_border_t" id="S5.T2.8.8.1">SePPO<sup class="ltx_sup" id="S5.T2.8.8.1.1"><span class="ltx_text ltx_font_italic" id="S5.T2.8.8.1.1.1">w</span></sup>
</th>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S5.T2.8.8.2"><span class="ltx_text ltx_font_bold" id="S5.T2.8.8.2.1">21.90</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t" id="S5.T2.8.8.3"><span class="ltx_text ltx_font_bold" id="S5.T2.8.8.3.1">21.93</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S5.T2.8.8.4"><span class="ltx_text ltx_font_bold" id="S5.T2.8.8.4.1">27.92</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t" id="S5.T2.8.8.5"><span class="ltx_text ltx_font_bold" id="S5.T2.8.8.5.1">27.69</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S5.T2.8.8.6"><span class="ltx_text ltx_font_bold" id="S5.T2.8.8.6.1">0.70</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t" id="S5.T2.8.8.7"><span class="ltx_text ltx_font_bold" id="S5.T2.8.8.7.1">0.58</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S5.T2.8.8.8"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T2.8.8.8.1">5.94</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S5.T2.8.8.9"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T2.8.8.9.1">5.64</span></td>
</tr>
</tbody>
</table>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_figure" id="S5.F3">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S5.F3.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="187" id="S5.F3.sf1.g1" src="https://arxiv.org/html/2410.05255v1/extracted/5908093/figures/aaf.png" width="250">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span>AAF Rate and PickScore</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S5.F3.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="187" id="S5.F3.sf2.g1" src="https://arxiv.org/html/2410.05255v1/extracted/5908093/figures/sft_pickscore.png" width="250">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span>SFT vs. SePPO</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>Relations of AAF rates and model performance.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_figure" id="S5.F4"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="616" id="S5.F4.g1" src="https://arxiv.org/html/2410.05255v1/x4.png" width="813">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>Text-to-image generation results of SD-1.5, SPO, SPIN-Diffusion and SePPO. The prompts from left to right are: (1) <span class="ltx_text ltx_font_italic" id="S5.F4.6.1">Photo of a pigeon in a well <span class="ltx_text ltx_framed ltx_framed_underline" id="S5.F4.6.1.1">tailored suit</span> getting a cup of coffee in a cafe in the morning</span>; (2) <span class="ltx_text ltx_font_italic" id="S5.F4.7.2">Ginger Tabby cat <span class="ltx_text ltx_framed ltx_framed_underline" id="S5.F4.7.2.1">watercolor</span> with flowers</span>; (3) <span class="ltx_text ltx_font_italic" id="S5.F4.8.3">An image of a peaceful mountain landscape at sunset, with <span class="ltx_text ltx_framed ltx_framed_underline" id="S5.F4.8.3.1">a small cabin nestled</span> in the trees and a winding river in the foreground</span>; (4) <span class="ltx_text ltx_font_italic" id="S5.F4.9.4">Space dog</span>; (5) <span class="ltx_text ltx_font_italic" id="S5.F4.10.5">b&amp;w photo of 42 y.o man in <span class="ltx_text ltx_framed ltx_framed_underline" id="S5.F4.10.5.1">white clothes</span>, bald, face, half body, body, high detailed skin, skin pores, <span class="ltx_text ltx_framed ltx_framed_underline" id="S5.F4.10.5.2">coastline</span>, overcast weather</span>.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_figure" id="S5.F5"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="494" id="S5.F5.g1" src="https://arxiv.org/html/2410.05255v1/x5.png" width="830">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>Text-to-video generation results of AnimateDiff (Raw), SFT, and SePPO. The prompt is: “<span class="ltx_text ltx_font_italic ltx_framed ltx_framed_underline" id="S5.F5.3.1">Time-lapse</span><span class="ltx_text ltx_font_italic" id="S5.F5.4.2"> of a lettuce seed germinating and growing into a mature plant. Initially, a seedling <span class="ltx_text ltx_framed ltx_framed_underline" id="S5.F5.4.2.1">emerges</span> from the soil, followed by leaves appearing and growing larger. The plant continues to develop…</span>”</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</section>
<section class="ltx_subsubsection" id="S5.SS2.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.2.2 </span>Analysis of Text-to-Video</h4><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S5.SS2.SSS2.p1">
<p class="ltx_p" id="S5.SS2.SSS2.p1.1">We further validate SePPO on the text-to-video task in Table <a class="ltx_ref" href="https://arxiv.org/html/2410.05255v1#S5.T3" title="Table 3 ‣ 5.2.3 Ablation Study ‣ 5.2 Results ‣ 5 Experiments ‣ SePPO: Semi-Policy Preference Optimization for Diffusion Alignment"><span class="ltx_text ltx_ref_tag">3</span></a>. Time-lapse video generation task is chosed and all the model are trained based on AnimateDiff. Our method achieves improvements across all metrics compared to both the vanilla and the fine-tuned AnimateDiff. We also visualize the video results in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.05255v1#S5.F5" title="Figure 5 ‣ 5.2.1 Analysis of Text-to-Image ‣ 5.2 Results ‣ 5 Experiments ‣ SePPO: Semi-Policy Preference Optimization for Diffusion Alignment"><span class="ltx_text ltx_ref_tag">5</span></a>, showing that SePPO achieves higher alignment with the text and better realism compared to the other methods.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_subsubsection" id="S5.SS2.SSS3">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.2.3 </span>Ablation Study</h4><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S5.SS2.SSS3.p1">
<p class="ltx_p" id="S5.SS2.SSS3.p1.2">We perform an ablation study of our method in Table <a class="ltx_ref" href="https://arxiv.org/html/2410.05255v1#S5.T4" title="Table 4 ‣ 5.2.3 Ablation Study ‣ 5.2 Results ‣ 5 Experiments ‣ SePPO: Semi-Policy Preference Optimization for Diffusion Alignment"><span class="ltx_text ltx_ref_tag">4</span></a>. When we remove AAF, meaning that all reference samples are treated as negative samples, the model’s performance drops significantly, demonstrating the effectiveness of AAF. Furthermore, when we replace the sign function <math alttext="{\rm sgn}(x)" class="ltx_Math" display="inline" id="S5.SS2.SSS3.p1.1.m1.1"><semantics id="S5.SS2.SSS3.p1.1.m1.1a"><mrow id="S5.SS2.SSS3.p1.1.m1.1.2" xref="S5.SS2.SSS3.p1.1.m1.1.2.cmml"><mi id="S5.SS2.SSS3.p1.1.m1.1.2.2" xref="S5.SS2.SSS3.p1.1.m1.1.2.2.cmml">sgn</mi><mo id="S5.SS2.SSS3.p1.1.m1.1.2.1" xref="S5.SS2.SSS3.p1.1.m1.1.2.1.cmml">⁢</mo><mrow id="S5.SS2.SSS3.p1.1.m1.1.2.3.2" xref="S5.SS2.SSS3.p1.1.m1.1.2.cmml"><mo id="S5.SS2.SSS3.p1.1.m1.1.2.3.2.1" stretchy="false" xref="S5.SS2.SSS3.p1.1.m1.1.2.cmml">(</mo><mi id="S5.SS2.SSS3.p1.1.m1.1.1" xref="S5.SS2.SSS3.p1.1.m1.1.1.cmml">x</mi><mo id="S5.SS2.SSS3.p1.1.m1.1.2.3.2.2" stretchy="false" xref="S5.SS2.SSS3.p1.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS3.p1.1.m1.1b"><apply id="S5.SS2.SSS3.p1.1.m1.1.2.cmml" xref="S5.SS2.SSS3.p1.1.m1.1.2"><times id="S5.SS2.SSS3.p1.1.m1.1.2.1.cmml" xref="S5.SS2.SSS3.p1.1.m1.1.2.1"></times><ci id="S5.SS2.SSS3.p1.1.m1.1.2.2.cmml" xref="S5.SS2.SSS3.p1.1.m1.1.2.2">sgn</ci><ci id="S5.SS2.SSS3.p1.1.m1.1.1.cmml" xref="S5.SS2.SSS3.p1.1.m1.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS3.p1.1.m1.1c">{\rm sgn}(x)</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.SSS3.p1.1.m1.1d">roman_sgn ( italic_x )</annotation></semantics></math> in equation&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.05255v1#S4.E9" title="Equation 9 ‣ 4.2 Anchor-based Adaptive Flipper for Preference Optimization ‣ 4 Iterative Alignment for Diffusion Models ‣ SePPO: Semi-Policy Preference Optimization for Diffusion Alignment"><span class="ltx_text ltx_ref_tag">9</span></a> with the indicator function
<math alttext="\mathds{1}(x>0)" class="ltx_Math" display="inline" id="S5.SS2.SSS3.p1.2.m2.1"><semantics id="S5.SS2.SSS3.p1.2.m2.1a"><mrow id="S5.SS2.SSS3.p1.2.m2.1.1" xref="S5.SS2.SSS3.p1.2.m2.1.1.cmml"><mn id="S5.SS2.SSS3.p1.2.m2.1.1.3" xref="S5.SS2.SSS3.p1.2.m2.1.1.3.cmml">𝟙</mn><mo id="S5.SS2.SSS3.p1.2.m2.1.1.2" xref="S5.SS2.SSS3.p1.2.m2.1.1.2.cmml">⁢</mo><mrow id="S5.SS2.SSS3.p1.2.m2.1.1.1.1" xref="S5.SS2.SSS3.p1.2.m2.1.1.1.1.1.cmml"><mo id="S5.SS2.SSS3.p1.2.m2.1.1.1.1.2" stretchy="false" xref="S5.SS2.SSS3.p1.2.m2.1.1.1.1.1.cmml">(</mo><mrow id="S5.SS2.SSS3.p1.2.m2.1.1.1.1.1" xref="S5.SS2.SSS3.p1.2.m2.1.1.1.1.1.cmml"><mi id="S5.SS2.SSS3.p1.2.m2.1.1.1.1.1.2" xref="S5.SS2.SSS3.p1.2.m2.1.1.1.1.1.2.cmml">x</mi><mo id="S5.SS2.SSS3.p1.2.m2.1.1.1.1.1.1" xref="S5.SS2.SSS3.p1.2.m2.1.1.1.1.1.1.cmml">&gt;</mo><mn id="S5.SS2.SSS3.p1.2.m2.1.1.1.1.1.3" xref="S5.SS2.SSS3.p1.2.m2.1.1.1.1.1.3.cmml">0</mn></mrow><mo id="S5.SS2.SSS3.p1.2.m2.1.1.1.1.3" stretchy="false" xref="S5.SS2.SSS3.p1.2.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS3.p1.2.m2.1b"><apply id="S5.SS2.SSS3.p1.2.m2.1.1.cmml" xref="S5.SS2.SSS3.p1.2.m2.1.1"><times id="S5.SS2.SSS3.p1.2.m2.1.1.2.cmml" xref="S5.SS2.SSS3.p1.2.m2.1.1.2"></times><cn id="S5.SS2.SSS3.p1.2.m2.1.1.3.cmml" type="integer" xref="S5.SS2.SSS3.p1.2.m2.1.1.3">1</cn><apply id="S5.SS2.SSS3.p1.2.m2.1.1.1.1.1.cmml" xref="S5.SS2.SSS3.p1.2.m2.1.1.1.1"><gt id="S5.SS2.SSS3.p1.2.m2.1.1.1.1.1.1.cmml" xref="S5.SS2.SSS3.p1.2.m2.1.1.1.1.1.1"></gt><ci id="S5.SS2.SSS3.p1.2.m2.1.1.1.1.1.2.cmml" xref="S5.SS2.SSS3.p1.2.m2.1.1.1.1.1.2">𝑥</ci><cn id="S5.SS2.SSS3.p1.2.m2.1.1.1.1.1.3.cmml" type="integer" xref="S5.SS2.SSS3.p1.2.m2.1.1.1.1.1.3">0</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS3.p1.2.m2.1c">\mathds{1}(x&gt;0)</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.SSS3.p1.2.m2.1d">blackboard_1 ( italic_x &gt; 0 )</annotation></semantics></math>, <span class="ltx_text ltx_font_italic" id="S5.SS2.SSS3.p1.2.1">i.e.</span>, choosing to only learn from the winning image when the reference image has a higher probability of not being a losing image, and applying DPO when the reference image has a higher probability of being a losing image, we observe almost no change in performances. This proves that our method is able to filter out “insufficiently negative samples”–samples that are better than the current model’s distribution and subsequently boost performance. Furthermore, we experiment with different sampling strategies for the reference model with AAF. When we set the reference model’s sampling method to using either the initial checkpoint or the most recent saved checkpoint, we observe a performance drop in both cases. This indicates the effectiveness of our reference model sampling strategy.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_table" id="S5.T3">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 3: </span>Metric Scores on the ChronoMagic-Bench-150 Dataset. <math alttext="\downarrow" class="ltx_Math" display="inline" id="S5.T3.3.m1.1"><semantics id="S5.T3.3.m1.1b"><mo id="S5.T3.3.m1.1.1" stretchy="false" xref="S5.T3.3.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S5.T3.3.m1.1c"><ci id="S5.T3.3.m1.1.1.cmml" xref="S5.T3.3.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.3.m1.1d">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S5.T3.3.m1.1e">↓</annotation></semantics></math> indicates the lower the better, and <math alttext="\uparrow" class="ltx_Math" display="inline" id="S5.T3.4.m2.1"><semantics id="S5.T3.4.m2.1b"><mo id="S5.T3.4.m2.1.1" stretchy="false" xref="S5.T3.4.m2.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S5.T3.4.m2.1c"><ci id="S5.T3.4.m2.1.1.cmml" xref="S5.T3.4.m2.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.4.m2.1d">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S5.T3.4.m2.1e">↑</annotation></semantics></math> indicates the higher the better.</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S5.T3.9">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T3.9.5">
<td class="ltx_td ltx_border_tt" id="S5.T3.9.5.6"></td>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T3.5.1.1">FID <math alttext="\downarrow" class="ltx_Math" display="inline" id="S5.T3.5.1.1.m1.1"><semantics id="S5.T3.5.1.1.m1.1a"><mo id="S5.T3.5.1.1.m1.1.1" stretchy="false" xref="S5.T3.5.1.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S5.T3.5.1.1.m1.1b"><ci id="S5.T3.5.1.1.m1.1.1.cmml" xref="S5.T3.5.1.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.5.1.1.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S5.T3.5.1.1.m1.1d">↓</annotation></semantics></math>
</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T3.6.2.2">LPIPS <math alttext="\downarrow" class="ltx_Math" display="inline" id="S5.T3.6.2.2.m1.1"><semantics id="S5.T3.6.2.2.m1.1a"><mo id="S5.T3.6.2.2.m1.1.1" stretchy="false" xref="S5.T3.6.2.2.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S5.T3.6.2.2.m1.1b"><ci id="S5.T3.6.2.2.m1.1.1.cmml" xref="S5.T3.6.2.2.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.6.2.2.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S5.T3.6.2.2.m1.1d">↓</annotation></semantics></math>
</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T3.7.3.3">SSIM <math alttext="\uparrow" class="ltx_Math" display="inline" id="S5.T3.7.3.3.m1.1"><semantics id="S5.T3.7.3.3.m1.1a"><mo id="S5.T3.7.3.3.m1.1.1" stretchy="false" xref="S5.T3.7.3.3.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S5.T3.7.3.3.m1.1b"><ci id="S5.T3.7.3.3.m1.1.1.cmml" xref="S5.T3.7.3.3.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.7.3.3.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S5.T3.7.3.3.m1.1d">↑</annotation></semantics></math>
</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T3.8.4.4">PSNR <math alttext="\uparrow" class="ltx_Math" display="inline" id="S5.T3.8.4.4.m1.1"><semantics id="S5.T3.8.4.4.m1.1a"><mo id="S5.T3.8.4.4.m1.1.1" stretchy="false" xref="S5.T3.8.4.4.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S5.T3.8.4.4.m1.1b"><ci id="S5.T3.8.4.4.m1.1.1.cmml" xref="S5.T3.8.4.4.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.8.4.4.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S5.T3.8.4.4.m1.1d">↑</annotation></semantics></math>
</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T3.9.5.5">FVD <math alttext="\downarrow" class="ltx_Math" display="inline" id="S5.T3.9.5.5.m1.1"><semantics id="S5.T3.9.5.5.m1.1a"><mo id="S5.T3.9.5.5.m1.1.1" stretchy="false" xref="S5.T3.9.5.5.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S5.T3.9.5.5.m1.1b"><ci id="S5.T3.9.5.5.m1.1.1.cmml" xref="S5.T3.9.5.5.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.9.5.5.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S5.T3.9.5.5.m1.1d">↓</annotation></semantics></math>
</th>
</tr>
<tr class="ltx_tr" id="S5.T3.9.6.1">
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.9.6.1.1">AnimateDiff</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.9.6.1.2">134.86</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.9.6.1.3">0.68</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.9.6.1.4">0.16</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.9.6.1.5">9.18</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.9.6.1.6">1608.41</td>
</tr>
<tr class="ltx_tr" id="S5.T3.9.7.2">
<td class="ltx_td ltx_align_center" id="S5.T3.9.7.2.1">SFT</td>
<td class="ltx_td ltx_align_center" id="S5.T3.9.7.2.2">129.14</td>
<td class="ltx_td ltx_align_center" id="S5.T3.9.7.2.3">0.65</td>
<td class="ltx_td ltx_align_center" id="S5.T3.9.7.2.4">0.17</td>
<td class="ltx_td ltx_align_center" id="S5.T3.9.7.2.5">9.25</td>
<td class="ltx_td ltx_align_center" id="S5.T3.9.7.2.6">1415.68</td>
</tr>
<tr class="ltx_tr" id="S5.T3.9.8.3">
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T3.9.8.3.1">SePPO</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T3.9.8.3.2"><span class="ltx_text ltx_font_bold" id="S5.T3.9.8.3.2.1">115.32</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T3.9.8.3.3"><span class="ltx_text ltx_font_bold" id="S5.T3.9.8.3.3.1">0.61</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T3.9.8.3.4"><span class="ltx_text ltx_font_bold" id="S5.T3.9.8.3.4.1">0.20</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T3.9.8.3.5"><span class="ltx_text ltx_font_bold" id="S5.T3.9.8.3.5.1">9.36</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T3.9.8.3.6"><span class="ltx_text ltx_font_bold" id="S5.T3.9.8.3.6.1">1300.97</span></td>
</tr>
</tbody>
</table>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_table" id="S5.T4">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 4: </span>Ablations on the Pick-a-Pic Validation Dataset.</figcaption>
<table class="ltx_tabular ltx_centering ltx_align_middle" id="S5.T4.8">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T4.4.4">
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T4.4.4.5">Methods</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T4.1.1.1">PickScore <math alttext="\uparrow" class="ltx_Math" display="inline" id="S5.T4.1.1.1.m1.1"><semantics id="S5.T4.1.1.1.m1.1a"><mo id="S5.T4.1.1.1.m1.1.1" stretchy="false" xref="S5.T4.1.1.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S5.T4.1.1.1.m1.1b"><ci id="S5.T4.1.1.1.m1.1.1.cmml" xref="S5.T4.1.1.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.1.1.1.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S5.T4.1.1.1.m1.1d">↑</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T4.2.2.2">HPSv2 <math alttext="\uparrow" class="ltx_Math" display="inline" id="S5.T4.2.2.2.m1.1"><semantics id="S5.T4.2.2.2.m1.1a"><mo id="S5.T4.2.2.2.m1.1.1" stretchy="false" xref="S5.T4.2.2.2.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S5.T4.2.2.2.m1.1b"><ci id="S5.T4.2.2.2.m1.1.1.cmml" xref="S5.T4.2.2.2.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.2.2.2.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S5.T4.2.2.2.m1.1d">↑</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T4.3.3.3">ImageReward <math alttext="\uparrow" class="ltx_Math" display="inline" id="S5.T4.3.3.3.m1.1"><semantics id="S5.T4.3.3.3.m1.1a"><mo id="S5.T4.3.3.3.m1.1.1" stretchy="false" xref="S5.T4.3.3.3.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S5.T4.3.3.3.m1.1b"><ci id="S5.T4.3.3.3.m1.1.1.cmml" xref="S5.T4.3.3.3.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.3.3.3.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S5.T4.3.3.3.m1.1d">↑</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T4.4.4.4">Aesthetic <math alttext="\uparrow" class="ltx_Math" display="inline" id="S5.T4.4.4.4.m1.1"><semantics id="S5.T4.4.4.4.m1.1a"><mo id="S5.T4.4.4.4.m1.1.1" stretchy="false" xref="S5.T4.4.4.4.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S5.T4.4.4.4.m1.1b"><ci id="S5.T4.4.4.4.m1.1.1.cmml" xref="S5.T4.4.4.4.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.4.4.4.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S5.T4.4.4.4.m1.1d">↑</annotation></semantics></math>
</td>
</tr>
<tr class="ltx_tr" id="S5.T4.8.9.1">
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.8.9.1.1">w/o AAF</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.8.9.1.2">20.88</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.8.9.1.3">26.78</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.8.9.1.4">0.366</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.8.9.1.5">5.491</td>
</tr>
<tr class="ltx_tr" id="S5.T4.5.5">
<td class="ltx_td ltx_align_center" id="S5.T4.5.5.1">w/ <math alttext="\mathds{1}(x>0)" class="ltx_Math" display="inline" id="S5.T4.5.5.1.m1.1"><semantics id="S5.T4.5.5.1.m1.1a"><mrow id="S5.T4.5.5.1.m1.1.1" xref="S5.T4.5.5.1.m1.1.1.cmml"><mn id="S5.T4.5.5.1.m1.1.1.3" xref="S5.T4.5.5.1.m1.1.1.3.cmml">𝟙</mn><mo id="S5.T4.5.5.1.m1.1.1.2" xref="S5.T4.5.5.1.m1.1.1.2.cmml">⁢</mo><mrow id="S5.T4.5.5.1.m1.1.1.1.1" xref="S5.T4.5.5.1.m1.1.1.1.1.1.cmml"><mo id="S5.T4.5.5.1.m1.1.1.1.1.2" stretchy="false" xref="S5.T4.5.5.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S5.T4.5.5.1.m1.1.1.1.1.1" xref="S5.T4.5.5.1.m1.1.1.1.1.1.cmml"><mi id="S5.T4.5.5.1.m1.1.1.1.1.1.2" xref="S5.T4.5.5.1.m1.1.1.1.1.1.2.cmml">x</mi><mo id="S5.T4.5.5.1.m1.1.1.1.1.1.1" xref="S5.T4.5.5.1.m1.1.1.1.1.1.1.cmml">&gt;</mo><mn id="S5.T4.5.5.1.m1.1.1.1.1.1.3" xref="S5.T4.5.5.1.m1.1.1.1.1.1.3.cmml">0</mn></mrow><mo id="S5.T4.5.5.1.m1.1.1.1.1.3" stretchy="false" xref="S5.T4.5.5.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.T4.5.5.1.m1.1b"><apply id="S5.T4.5.5.1.m1.1.1.cmml" xref="S5.T4.5.5.1.m1.1.1"><times id="S5.T4.5.5.1.m1.1.1.2.cmml" xref="S5.T4.5.5.1.m1.1.1.2"></times><cn id="S5.T4.5.5.1.m1.1.1.3.cmml" type="integer" xref="S5.T4.5.5.1.m1.1.1.3">1</cn><apply id="S5.T4.5.5.1.m1.1.1.1.1.1.cmml" xref="S5.T4.5.5.1.m1.1.1.1.1"><gt id="S5.T4.5.5.1.m1.1.1.1.1.1.1.cmml" xref="S5.T4.5.5.1.m1.1.1.1.1.1.1"></gt><ci id="S5.T4.5.5.1.m1.1.1.1.1.1.2.cmml" xref="S5.T4.5.5.1.m1.1.1.1.1.1.2">𝑥</ci><cn id="S5.T4.5.5.1.m1.1.1.1.1.1.3.cmml" type="integer" xref="S5.T4.5.5.1.m1.1.1.1.1.1.3">0</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.5.5.1.m1.1c">\mathds{1}(x&gt;0)</annotation><annotation encoding="application/x-llamapun" id="S5.T4.5.5.1.m1.1d">blackboard_1 ( italic_x &gt; 0 )</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center" id="S5.T4.5.5.2">21.56</td>
<td class="ltx_td ltx_align_center" id="S5.T4.5.5.3">27.18</td>
<td class="ltx_td ltx_align_center" id="S5.T4.5.5.4">0.606</td>
<td class="ltx_td ltx_align_center" id="S5.T4.5.5.5"><span class="ltx_text ltx_font_bold" id="S5.T4.5.5.5.1">5.797</span></td>
</tr>
<tr class="ltx_tr" id="S5.T4.6.6">
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.6.6.1">Ref as the initial (<math alttext="{\rm ref}=0" class="ltx_Math" display="inline" id="S5.T4.6.6.1.m1.1"><semantics id="S5.T4.6.6.1.m1.1a"><mrow id="S5.T4.6.6.1.m1.1.1" xref="S5.T4.6.6.1.m1.1.1.cmml"><mi id="S5.T4.6.6.1.m1.1.1.2" xref="S5.T4.6.6.1.m1.1.1.2.cmml">ref</mi><mo id="S5.T4.6.6.1.m1.1.1.1" xref="S5.T4.6.6.1.m1.1.1.1.cmml">=</mo><mn id="S5.T4.6.6.1.m1.1.1.3" xref="S5.T4.6.6.1.m1.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T4.6.6.1.m1.1b"><apply id="S5.T4.6.6.1.m1.1.1.cmml" xref="S5.T4.6.6.1.m1.1.1"><eq id="S5.T4.6.6.1.m1.1.1.1.cmml" xref="S5.T4.6.6.1.m1.1.1.1"></eq><ci id="S5.T4.6.6.1.m1.1.1.2.cmml" xref="S5.T4.6.6.1.m1.1.1.2">ref</ci><cn id="S5.T4.6.6.1.m1.1.1.3.cmml" type="integer" xref="S5.T4.6.6.1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.6.6.1.m1.1c">{\rm ref}=0</annotation><annotation encoding="application/x-llamapun" id="S5.T4.6.6.1.m1.1d">roman_ref = 0</annotation></semantics></math>)</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.6.6.2">21.41</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.6.6.3">27.04</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.6.6.4">0.562</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.6.6.5">5.727</td>
</tr>
<tr class="ltx_tr" id="S5.T4.7.7">
<td class="ltx_td ltx_align_center" id="S5.T4.7.7.1">Ref as the latest (<math alttext="{\rm ref}=k-1" class="ltx_Math" display="inline" id="S5.T4.7.7.1.m1.1"><semantics id="S5.T4.7.7.1.m1.1a"><mrow id="S5.T4.7.7.1.m1.1.1" xref="S5.T4.7.7.1.m1.1.1.cmml"><mi id="S5.T4.7.7.1.m1.1.1.2" xref="S5.T4.7.7.1.m1.1.1.2.cmml">ref</mi><mo id="S5.T4.7.7.1.m1.1.1.1" xref="S5.T4.7.7.1.m1.1.1.1.cmml">=</mo><mrow id="S5.T4.7.7.1.m1.1.1.3" xref="S5.T4.7.7.1.m1.1.1.3.cmml"><mi id="S5.T4.7.7.1.m1.1.1.3.2" xref="S5.T4.7.7.1.m1.1.1.3.2.cmml">k</mi><mo id="S5.T4.7.7.1.m1.1.1.3.1" xref="S5.T4.7.7.1.m1.1.1.3.1.cmml">−</mo><mn id="S5.T4.7.7.1.m1.1.1.3.3" xref="S5.T4.7.7.1.m1.1.1.3.3.cmml">1</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.T4.7.7.1.m1.1b"><apply id="S5.T4.7.7.1.m1.1.1.cmml" xref="S5.T4.7.7.1.m1.1.1"><eq id="S5.T4.7.7.1.m1.1.1.1.cmml" xref="S5.T4.7.7.1.m1.1.1.1"></eq><ci id="S5.T4.7.7.1.m1.1.1.2.cmml" xref="S5.T4.7.7.1.m1.1.1.2">ref</ci><apply id="S5.T4.7.7.1.m1.1.1.3.cmml" xref="S5.T4.7.7.1.m1.1.1.3"><minus id="S5.T4.7.7.1.m1.1.1.3.1.cmml" xref="S5.T4.7.7.1.m1.1.1.3.1"></minus><ci id="S5.T4.7.7.1.m1.1.1.3.2.cmml" xref="S5.T4.7.7.1.m1.1.1.3.2">𝑘</ci><cn id="S5.T4.7.7.1.m1.1.1.3.3.cmml" type="integer" xref="S5.T4.7.7.1.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.7.7.1.m1.1c">{\rm ref}=k-1</annotation><annotation encoding="application/x-llamapun" id="S5.T4.7.7.1.m1.1d">roman_ref = italic_k - 1</annotation></semantics></math>)</td>
<td class="ltx_td ltx_align_center" id="S5.T4.7.7.2">21.34</td>
<td class="ltx_td ltx_align_center" id="S5.T4.7.7.3">27.05</td>
<td class="ltx_td ltx_align_center" id="S5.T4.7.7.4">0.537</td>
<td class="ltx_td ltx_align_center" id="S5.T4.7.7.5">5.708</td>
</tr>
<tr class="ltx_tr" id="S5.T4.8.8">
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S5.T4.8.8.1">SePPO<sup class="ltx_sup" id="S5.T4.8.8.1.1"><span class="ltx_text ltx_font_italic" id="S5.T4.8.8.1.1.1">w</span></sup>
</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S5.T4.8.8.2"><span class="ltx_text ltx_font_bold" id="S5.T4.8.8.2.1">21.57</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S5.T4.8.8.3"><span class="ltx_text ltx_font_bold" id="S5.T4.8.8.3.1">27.20</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S5.T4.8.8.4"><span class="ltx_text ltx_font_bold" id="S5.T4.8.8.4.1">0.615</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S5.T4.8.8.5">5.772</td>
</tr>
</tbody>
</table>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</section>
</section>
</section>
<section class="ltx_section" id="S6">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Discussions</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<section class="ltx_subsection" id="S6.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.1 </span>Limitations</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S6.SS1.p1">
<p class="ltx_p" id="S6.SS1.p1.1">First, in diffusion models, the theoretical analysis of exploration in policy space constrained by reference models is an open problem. Second, the performance may be further improved if the pixel space (images before encoding) is also considered. We leave this to future work.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_subsection" id="S6.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.2 </span>Conclusion</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S6.SS2.p1">
<p class="ltx_p" id="S6.SS2.p1.1">Without using reward models or human-annotated paired data, we have developed a Semi-Policy Preference Optimization (SePPO) method, which takes previous checkpoints as reference models and uses them to generate on-policy reference samples, which replace “losing images” in preference pairs. In addition, we design a strategy for reference model selection that expands the exploration in the policy space. Furthermore, instead of directly taking reference samples as negative examples, we propose an Anchor-based Adaptive Flipper to determine whether the reference samples are likely to be winning or losing images, which allows the model to selectively learn from the generated reference samples. In text-to-image benchmarks, SePPO achieved a <math alttext="21.57" class="ltx_Math" display="inline" id="S6.SS2.p1.1.m1.1"><semantics id="S6.SS2.p1.1.m1.1a"><mn id="S6.SS2.p1.1.m1.1.1" xref="S6.SS2.p1.1.m1.1.1.cmml">21.57</mn><annotation-xml encoding="MathML-Content" id="S6.SS2.p1.1.m1.1b"><cn id="S6.SS2.p1.1.m1.1.1.cmml" type="float" xref="S6.SS2.p1.1.m1.1.1">21.57</cn></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.p1.1.m1.1c">21.57</annotation><annotation encoding="application/x-llamapun" id="S6.SS2.p1.1.m1.1d">21.57</annotation></semantics></math> PickScore, exceeding all previous approaches on the SD-1.5 model. In addition, SePPO performs better than SFT on text-to-video benchmarks.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
</section>
<section class="ltx_section" id="Sx1">
<h2 class="ltx_title ltx_title_section">Reproducibility Statement</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="Sx1.p1">
<p class="ltx_p" id="Sx1.p1.1">For algorithms, we put the key parts (loss function) in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.05255v1#A2.SS2" title="B.2 Pseudocode ‣ Appendix B Supplementary Experiments ‣ SePPO: Semi-Policy Preference Optimization for Diffusion Alignment"><span class="ltx_text ltx_ref_tag">B.2</span></a>. We upload the main code for training to the supplementary material. The model checkpoints will be released shortly in <a class="ltx_ref ltx_href" href="https://github.com/DwanZhang-AI/SePPO" title="">https://github.com/DwanZhang-AI/SePPO</a>. For datasets, we use open source datasets described in Section <a class="ltx_ref" href="https://arxiv.org/html/2410.05255v1#S5.SS1" title="5.1 Setup ‣ 5 Experiments ‣ SePPO: Semi-Policy Preference Optimization for Diffusion Alignment"><span class="ltx_text ltx_ref_tag">5.1</span></a>. For generated results, we upload generated videos to the supplementary material.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Black et&nbsp;al. (2024)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Kevin Black, Michael Janner, Yilun Du, Ilya Kostrikov, and Sergey Levine.

</span>
<span class="ltx_bibblock">Training diffusion models with reinforcement learning.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib1.1.1">The Twelfth International Conference on Learning Representations</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chan (2024)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Stanley&nbsp;H Chan.

</span>
<span class="ltx_bibblock">Tutorial on diffusion models for imaging and vision.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib2.1.1">arXiv preprint arXiv:2403.18103</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et&nbsp;al. (2024)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Zixiang Chen, Yihe Deng, Huizhuo Yuan, Kaixuan Ji, and Quanquan Gu.

</span>
<span class="ltx_bibblock">Self-play fine-tuning converts weak language models to strong language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib3.1.1">arXiv preprint arXiv:2401.01335</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Denison et&nbsp;al. (2024)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Carson Denison, Monte MacDiarmid, Fazl Barez, David Duvenaud, Shauna Kravec, Samuel Marks, Nicholas Schiefer, Ryan Soklaski, Alex Tamkin, Jared Kaplan, et&nbsp;al.

</span>
<span class="ltx_bibblock">Sycophancy to subterfuge: Investigating reward-tampering in large language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib4.1.1">arXiv preprint arXiv:2406.10162</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dong et&nbsp;al. (2024)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Hanze Dong, Wei Xiong, Bo&nbsp;Pang, Haoxiang Wang, Han Zhao, Yingbo Zhou, Nan Jiang, Doyen Sahoo, Caiming Xiong, and Tong Zhang.

</span>
<span class="ltx_bibblock">RLHF workflow: From reward modeling to online RLHF.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib5.1.1">Transactions on Machine Learning Research</em>, 2024.

</span>
<span class="ltx_bibblock">ISSN 2835-8856.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Florensa et&nbsp;al. (2018)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Carlos Florensa, David Held, Xinyang Geng, and Pieter Abbeel.

</span>
<span class="ltx_bibblock">Automatic goal generation for reinforcement learning agents.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib6.1.1">International Conference on Machine Learning</em>, pp.&nbsp; 1515–1528. PMLR, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gu et&nbsp;al. (2024)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Yi&nbsp;Gu, Zhendong Wang, Yueqin Yin, Yujia Xie, and Mingyuan Zhou.

</span>
<span class="ltx_bibblock">Diffusion-RPO: Aligning diffusion models through relative preference optimization.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib7.1.1">arXiv preprint arXiv:2406.06382</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Guo et&nbsp;al. (2024)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Yuwei Guo, Ceyuan Yang, Anyi Rao, Zhengyang Liang, Yaohui Wang, Yu&nbsp;Qiao, Maneesh Agrawala, Dahua Lin, and Bo&nbsp;Dai.

</span>
<span class="ltx_bibblock">AnimateDiff: Animate your personalized text-to-image diffusion models without specific tuning.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib8.1.1">The Twelfth International Conference on Learning Representations</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Heess et&nbsp;al. (2017)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Nicolas Heess, Dhruva Tb, Srinivasan Sriram, Jay Lemmon, Josh Merel, Greg Wayne, Yuval Tassa, Tom Erez, Ziyu Wang, S.M. Eslami, Martin&nbsp;A. Riedmiller, and David Silver.

</span>
<span class="ltx_bibblock">Emergence of locomotion behaviours in rich environments.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib9.1.1">arXiv preprint arXiv:1707.02286</em>, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Heusel et&nbsp;al. (2017)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Martin Heusel, Hubert Ramsauer, Thomas Unterthiner, Bernhard Nessler, and Sepp Hochreiter.

</span>
<span class="ltx_bibblock">GANs trained by a two time-scale update rule converge to a local Nash equilibrium.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib10.1.1">Advances in Neural Information Processing Systems</em>, 30, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ho et&nbsp;al. (2020)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Jonathan Ho, Ajay Jain, and Pieter Abbeel.

</span>
<span class="ltx_bibblock">Denoising diffusion probabilistic models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib11.1.1">Advances in Neural Information Processing Systems</em>, 33:6840–6851, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hong et&nbsp;al. (2024)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Jiwoo Hong, Sayak Paul, Noah Lee, Kashif Rasul, James Thorne, and Jongheon Jeong.

</span>
<span class="ltx_bibblock">Margin-aware preference optimization for aligning diffusion models without reference.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib12.1.1">arXiv preprint arXiv:2406.06424</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hore &amp; Ziou (2010)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Alain Hore and Djemel Ziou.

</span>
<span class="ltx_bibblock">Image quality metrics: PSNR vs. SSIM.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib13.1.1">20th International Conference on Pattern Recognition</em>, pp.&nbsp; 2366–2369. IEEE, 2010.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hu et&nbsp;al. (2022)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Edward&nbsp;J Hu, Yelong Shen, Phillip Wallis, Zeyuan Allen-Zhu, Yuanzhi Li, Shean Wang, Lu&nbsp;Wang, and Weizhu Chen.

</span>
<span class="ltx_bibblock">LoRA: Low-rank adaptation of large language models.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib14.1.1">International Conference on Learning Representations</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kim et&nbsp;al. (2024)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Kyuyoung Kim, Jongheon Jeong, Minyong An, Mohammad Ghavamzadeh, Krishnamurthy&nbsp;Dj Dvijotham, Jinwoo Shin, and Kimin Lee.

</span>
<span class="ltx_bibblock">Confidence-aware reward optimization for fine-tuning text-to-image models.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib15.1.1">The Twelfth International Conference on Learning Representations</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kingma et&nbsp;al. (2021)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Diederik Kingma, Tim Salimans, Ben Poole, and Jonathan Ho.

</span>
<span class="ltx_bibblock">Variational diffusion models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib16.1.1">Advances in Neural Information Processing Systems</em>, 34:21696–21707, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kingma &amp; Welling (2019)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Diederik&nbsp;P Kingma and Max Welling.

</span>
<span class="ltx_bibblock">An introduction to variational autoencoders.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib17.1.1">Foundations and Trends® in Machine Learning</em>, 12(4):307–392, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kirstain et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Yuval Kirstain, Adam Polyak, Uriel Singer, Shahbuland Matiana, Joe Penna, and Omer Levy.

</span>
<span class="ltx_bibblock">Pick-a-Pic: An open dataset of user preferences for text-to-image generation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib18.1.1">Thirty-seventh Conference on Neural Information Processing Systems</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liang et&nbsp;al. (2024a)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Youwei Liang, Junfeng He, Gang Li, Peizhao Li, Arseniy Klimovskiy, Nicholas Carolan, Jiao Sun, Jordi Pont-Tuset, Sarah Young, Feng Yang, et&nbsp;al.

</span>
<span class="ltx_bibblock">Rich human feedback for text-to-image generation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib19.1.1">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition</em>, pp.&nbsp; 19401–19411, 2024a.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liang et&nbsp;al. (2024b)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Zhanhao Liang, Yuhui Yuan, Shuyang Gu, Bohan Chen, Tiankai Hang, Ji&nbsp;Li, and Liang Zheng.

</span>
<span class="ltx_bibblock">Step-aware preference optimization: Aligning preference with denoising performance at each step.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib20.1.1">arXiv preprint arXiv:2406.04314</em>, 2024b.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Loshchilov &amp; Hutter (2019)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Ilya Loshchilov and Frank Hutter.

</span>
<span class="ltx_bibblock">Decoupled weight decay regularization.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib21.1.1">International Conference on Learning Representations</em>, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Podell et&nbsp;al. (2024)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Dustin Podell, Zion English, Kyle Lacey, Andreas Blattmann, Tim Dockhorn, Jonas Müller, Joe Penna, and Robin Rombach.

</span>
<span class="ltx_bibblock">SDXL: Improving latent diffusion models for high-resolution image synthesis.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib22.1.1">The Twelfth International Conference on Learning Representations</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rafailov et&nbsp;al. (2024)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Rafael Rafailov, Archit Sharma, Eric Mitchell, Christopher&nbsp;D Manning, Stefano Ermon, and Chelsea Finn.

</span>
<span class="ltx_bibblock">Direct preference optimization: Your language model is secretly a reward model.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib23.1.1">Advances in Neural Information Processing Systems</em>, 36, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shaikh et&nbsp;al. (2024)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Omar Shaikh, Michelle Lam, Joey Hejna, Yijia Shao, Michael Bernstein, and Diyi Yang.

</span>
<span class="ltx_bibblock">Show, don’t tell: Aligning language models with demonstrated feedback.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib24.1.1">arXiv preprint arXiv:2406.00888</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Song &amp; Ermon (2019)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Yang Song and Stefano Ermon.

</span>
<span class="ltx_bibblock">Generative modeling by estimating gradients of the data distribution.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib25.1.1">Advances in Neural Information Processing Systems</em>, volume&nbsp;32. Curran Associates, Inc., 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tang et&nbsp;al. (2024)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Yunhao Tang, Daniel&nbsp;Zhaohan Guo, Zeyu Zheng, Daniele Calandriello, Yuan Cao, Eugene Tarassov, Rémi Munos, Bernardo&nbsp;Ávila Pires, Michal Valko, Yong Cheng, and Will Dabney.

</span>
<span class="ltx_bibblock">Understanding the performance gap between online and offline alignment algorithms.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib26.1.1">arXiv preprint arXiv:2405.08448</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Unterthiner et&nbsp;al. (2019)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Thomas Unterthiner, Sjoerd van Steenkiste, Karol Kurach, Raphaël Marinier, Marcin Michalski, and Sylvain Gelly.

</span>
<span class="ltx_bibblock">FVD: A new metric for video generation, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Vieillard et&nbsp;al. (2020)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Nino Vieillard, Tadashi Kozuno, Bruno Scherrer, Olivier Pietquin, Rémi Munos, and Matthieu Geist.

</span>
<span class="ltx_bibblock">Leverage the average: an analysis of KL regularization in reinforcement learning.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib28.1.1">Advances in Neural Information Processing Systems</em>, 33:12163–12174, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wallace et&nbsp;al. (2024)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Bram Wallace, Meihua Dang, Rafael Rafailov, Linqi Zhou, Aaron Lou, Senthil Purushwalkam, Stefano Ermon, Caiming Xiong, Shafiq Joty, and Nikhil Naik.

</span>
<span class="ltx_bibblock">Diffusion model alignment using direct preference optimization.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib29.1.1">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition</em>, pp.&nbsp; 8228–8238, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et&nbsp;al. (2004)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Zhou Wang, Alan&nbsp;C Bovik, Hamid&nbsp;R Sheikh, and Eero&nbsp;P Simoncelli.

</span>
<span class="ltx_bibblock">Image quality assessment: from error visibility to structural similarity.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib30.1.1">IEEE Transactions on Image Processing</em>, 13(4):600–612, 2004.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yang et&nbsp;al. (2024)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Kai Yang, Jian Tao, Jiafei Lyu, Chunjiang Ge, Jiaxin Chen, Weihan Shen, Xiaolong Zhu, and Xiu Li.

</span>
<span class="ltx_bibblock">Using human feedback to fine-tune diffusion models without any reward model.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib31.1.1">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition</em>, pp.&nbsp; 8941–8951, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yuan et&nbsp;al. (2024a)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Huizhuo Yuan, Zixiang Chen, Kaixuan Ji, and Quanquan Gu.

</span>
<span class="ltx_bibblock">Self-play fine-tuning of diffusion models for text-to-image generation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib32.1.1">arXiv preprint arXiv:2402.10210</em>, 2024a.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yuan et&nbsp;al. (2024b)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Shenghai Yuan, Jinfa Huang, Yujun Shi, Yongqi Xu, Ruijie Zhu, Bin Lin, Xinhua Cheng, Li&nbsp;Yuan, and Jiebo Luo.

</span>
<span class="ltx_bibblock">MagicTime: Time-lapse video generation models as metamorphic simulators.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib33.1.1">arXiv preprint arXiv:2404.05014</em>, 2024b.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yuan et&nbsp;al. (2024c)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Shenghai Yuan, Jinfa Huang, Yongqi Xu, Yaoyang Liu, Shaofeng Zhang, Yujun Shi, Ruijie Zhu, Xinhua Cheng, Jiebo Luo, and Li&nbsp;Yuan.

</span>
<span class="ltx_bibblock">Chronomagic-bench: A benchmark for metamorphic evaluation of text-to-time-lapse video generation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib34.1.1">arXiv preprint arXiv:2406.18522</em>, 2024c.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et&nbsp;al. (2018)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Richard Zhang, Phillip Isola, Alexei&nbsp;A Efros, Eli Shechtman, and Oliver Wang.

</span>
<span class="ltx_bibblock">The unreasonable effectiveness of deep features as a perceptual metric.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib35.1.1">Proceedings of the IEEE Conference on Computer Vision and Pattern Recognition</em>, pp.&nbsp; 586–595, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et&nbsp;al. (2024)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Yuheng Zhang, Dian Yu, Baolin Peng, Linfeng Song, Ye&nbsp;Tian, Mingyue Huo, Nan Jiang, Haitao Mi, and Dong Yu.

</span>
<span class="ltx_bibblock">Iterative Nash policy optimization: Aligning LLMs with general preferences via no-regret learning.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib36.1.1">arXiv preprint arXiv:2407.00617</em>, 2024.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<section class="ltx_appendix" id="A1">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Theoretical Analysis</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<section class="ltx_subsection" id="A1.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.1 </span>Proof of Theorem <a class="ltx_ref" href="https://arxiv.org/html/2410.05255v1#S4.Thmtheorem1" title="Theorem 4.1. ‣ 4.2 Anchor-based Adaptive Flipper for Preference Optimization ‣ 4 Iterative Alignment for Diffusion Models ‣ SePPO: Semi-Policy Preference Optimization for Diffusion Alignment"><span class="ltx_text ltx_ref_tag">4.1</span></a>
</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="A1.SS1.p1">
<p class="ltx_p" id="A1.SS1.p1.11">In step <math alttext="t" class="ltx_Math" display="inline" id="A1.SS1.p1.1.m1.1"><semantics id="A1.SS1.p1.1.m1.1a"><mi id="A1.SS1.p1.1.m1.1.1" xref="A1.SS1.p1.1.m1.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.1.m1.1b"><ci id="A1.SS1.p1.1.m1.1.1.cmml" xref="A1.SS1.p1.1.m1.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.1.m1.1c">t</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p1.1.m1.1d">italic_t</annotation></semantics></math>, recall that the original image is <math alttext="\mathbf{x}_{0}=\frac{\mathbf{x}_{t}-\sqrt{1-\alpha^{t}}\epsilon}{\sqrt{\alpha^%
{t}}}" class="ltx_Math" display="inline" id="A1.SS1.p1.2.m2.1"><semantics id="A1.SS1.p1.2.m2.1a"><mrow id="A1.SS1.p1.2.m2.1.1" xref="A1.SS1.p1.2.m2.1.1.cmml"><msub id="A1.SS1.p1.2.m2.1.1.2" xref="A1.SS1.p1.2.m2.1.1.2.cmml"><mi id="A1.SS1.p1.2.m2.1.1.2.2" xref="A1.SS1.p1.2.m2.1.1.2.2.cmml">𝐱</mi><mn id="A1.SS1.p1.2.m2.1.1.2.3" xref="A1.SS1.p1.2.m2.1.1.2.3.cmml">0</mn></msub><mo id="A1.SS1.p1.2.m2.1.1.1" xref="A1.SS1.p1.2.m2.1.1.1.cmml">=</mo><mfrac id="A1.SS1.p1.2.m2.1.1.3" xref="A1.SS1.p1.2.m2.1.1.3.cmml"><mrow id="A1.SS1.p1.2.m2.1.1.3.2" xref="A1.SS1.p1.2.m2.1.1.3.2.cmml"><msub id="A1.SS1.p1.2.m2.1.1.3.2.2" xref="A1.SS1.p1.2.m2.1.1.3.2.2.cmml"><mi id="A1.SS1.p1.2.m2.1.1.3.2.2.2" xref="A1.SS1.p1.2.m2.1.1.3.2.2.2.cmml">𝐱</mi><mi id="A1.SS1.p1.2.m2.1.1.3.2.2.3" xref="A1.SS1.p1.2.m2.1.1.3.2.2.3.cmml">t</mi></msub><mo id="A1.SS1.p1.2.m2.1.1.3.2.1" xref="A1.SS1.p1.2.m2.1.1.3.2.1.cmml">−</mo><mrow id="A1.SS1.p1.2.m2.1.1.3.2.3" xref="A1.SS1.p1.2.m2.1.1.3.2.3.cmml"><msqrt id="A1.SS1.p1.2.m2.1.1.3.2.3.2" xref="A1.SS1.p1.2.m2.1.1.3.2.3.2.cmml"><mrow id="A1.SS1.p1.2.m2.1.1.3.2.3.2.2" xref="A1.SS1.p1.2.m2.1.1.3.2.3.2.2.cmml"><mn id="A1.SS1.p1.2.m2.1.1.3.2.3.2.2.2" xref="A1.SS1.p1.2.m2.1.1.3.2.3.2.2.2.cmml">1</mn><mo id="A1.SS1.p1.2.m2.1.1.3.2.3.2.2.1" xref="A1.SS1.p1.2.m2.1.1.3.2.3.2.2.1.cmml">−</mo><msup id="A1.SS1.p1.2.m2.1.1.3.2.3.2.2.3" xref="A1.SS1.p1.2.m2.1.1.3.2.3.2.2.3.cmml"><mi id="A1.SS1.p1.2.m2.1.1.3.2.3.2.2.3.2" xref="A1.SS1.p1.2.m2.1.1.3.2.3.2.2.3.2.cmml">α</mi><mi id="A1.SS1.p1.2.m2.1.1.3.2.3.2.2.3.3" xref="A1.SS1.p1.2.m2.1.1.3.2.3.2.2.3.3.cmml">t</mi></msup></mrow></msqrt><mo id="A1.SS1.p1.2.m2.1.1.3.2.3.1" xref="A1.SS1.p1.2.m2.1.1.3.2.3.1.cmml">⁢</mo><mi id="A1.SS1.p1.2.m2.1.1.3.2.3.3" xref="A1.SS1.p1.2.m2.1.1.3.2.3.3.cmml">ϵ</mi></mrow></mrow><msqrt id="A1.SS1.p1.2.m2.1.1.3.3" xref="A1.SS1.p1.2.m2.1.1.3.3.cmml"><msup id="A1.SS1.p1.2.m2.1.1.3.3.2" xref="A1.SS1.p1.2.m2.1.1.3.3.2.cmml"><mi id="A1.SS1.p1.2.m2.1.1.3.3.2.2" xref="A1.SS1.p1.2.m2.1.1.3.3.2.2.cmml">α</mi><mi id="A1.SS1.p1.2.m2.1.1.3.3.2.3" xref="A1.SS1.p1.2.m2.1.1.3.3.2.3.cmml">t</mi></msup></msqrt></mfrac></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.2.m2.1b"><apply id="A1.SS1.p1.2.m2.1.1.cmml" xref="A1.SS1.p1.2.m2.1.1"><eq id="A1.SS1.p1.2.m2.1.1.1.cmml" xref="A1.SS1.p1.2.m2.1.1.1"></eq><apply id="A1.SS1.p1.2.m2.1.1.2.cmml" xref="A1.SS1.p1.2.m2.1.1.2"><csymbol cd="ambiguous" id="A1.SS1.p1.2.m2.1.1.2.1.cmml" xref="A1.SS1.p1.2.m2.1.1.2">subscript</csymbol><ci id="A1.SS1.p1.2.m2.1.1.2.2.cmml" xref="A1.SS1.p1.2.m2.1.1.2.2">𝐱</ci><cn id="A1.SS1.p1.2.m2.1.1.2.3.cmml" type="integer" xref="A1.SS1.p1.2.m2.1.1.2.3">0</cn></apply><apply id="A1.SS1.p1.2.m2.1.1.3.cmml" xref="A1.SS1.p1.2.m2.1.1.3"><divide id="A1.SS1.p1.2.m2.1.1.3.1.cmml" xref="A1.SS1.p1.2.m2.1.1.3"></divide><apply id="A1.SS1.p1.2.m2.1.1.3.2.cmml" xref="A1.SS1.p1.2.m2.1.1.3.2"><minus id="A1.SS1.p1.2.m2.1.1.3.2.1.cmml" xref="A1.SS1.p1.2.m2.1.1.3.2.1"></minus><apply id="A1.SS1.p1.2.m2.1.1.3.2.2.cmml" xref="A1.SS1.p1.2.m2.1.1.3.2.2"><csymbol cd="ambiguous" id="A1.SS1.p1.2.m2.1.1.3.2.2.1.cmml" xref="A1.SS1.p1.2.m2.1.1.3.2.2">subscript</csymbol><ci id="A1.SS1.p1.2.m2.1.1.3.2.2.2.cmml" xref="A1.SS1.p1.2.m2.1.1.3.2.2.2">𝐱</ci><ci id="A1.SS1.p1.2.m2.1.1.3.2.2.3.cmml" xref="A1.SS1.p1.2.m2.1.1.3.2.2.3">𝑡</ci></apply><apply id="A1.SS1.p1.2.m2.1.1.3.2.3.cmml" xref="A1.SS1.p1.2.m2.1.1.3.2.3"><times id="A1.SS1.p1.2.m2.1.1.3.2.3.1.cmml" xref="A1.SS1.p1.2.m2.1.1.3.2.3.1"></times><apply id="A1.SS1.p1.2.m2.1.1.3.2.3.2.cmml" xref="A1.SS1.p1.2.m2.1.1.3.2.3.2"><root id="A1.SS1.p1.2.m2.1.1.3.2.3.2a.cmml" xref="A1.SS1.p1.2.m2.1.1.3.2.3.2"></root><apply id="A1.SS1.p1.2.m2.1.1.3.2.3.2.2.cmml" xref="A1.SS1.p1.2.m2.1.1.3.2.3.2.2"><minus id="A1.SS1.p1.2.m2.1.1.3.2.3.2.2.1.cmml" xref="A1.SS1.p1.2.m2.1.1.3.2.3.2.2.1"></minus><cn id="A1.SS1.p1.2.m2.1.1.3.2.3.2.2.2.cmml" type="integer" xref="A1.SS1.p1.2.m2.1.1.3.2.3.2.2.2">1</cn><apply id="A1.SS1.p1.2.m2.1.1.3.2.3.2.2.3.cmml" xref="A1.SS1.p1.2.m2.1.1.3.2.3.2.2.3"><csymbol cd="ambiguous" id="A1.SS1.p1.2.m2.1.1.3.2.3.2.2.3.1.cmml" xref="A1.SS1.p1.2.m2.1.1.3.2.3.2.2.3">superscript</csymbol><ci id="A1.SS1.p1.2.m2.1.1.3.2.3.2.2.3.2.cmml" xref="A1.SS1.p1.2.m2.1.1.3.2.3.2.2.3.2">𝛼</ci><ci id="A1.SS1.p1.2.m2.1.1.3.2.3.2.2.3.3.cmml" xref="A1.SS1.p1.2.m2.1.1.3.2.3.2.2.3.3">𝑡</ci></apply></apply></apply><ci id="A1.SS1.p1.2.m2.1.1.3.2.3.3.cmml" xref="A1.SS1.p1.2.m2.1.1.3.2.3.3">italic-ϵ</ci></apply></apply><apply id="A1.SS1.p1.2.m2.1.1.3.3.cmml" xref="A1.SS1.p1.2.m2.1.1.3.3"><root id="A1.SS1.p1.2.m2.1.1.3.3a.cmml" xref="A1.SS1.p1.2.m2.1.1.3.3"></root><apply id="A1.SS1.p1.2.m2.1.1.3.3.2.cmml" xref="A1.SS1.p1.2.m2.1.1.3.3.2"><csymbol cd="ambiguous" id="A1.SS1.p1.2.m2.1.1.3.3.2.1.cmml" xref="A1.SS1.p1.2.m2.1.1.3.3.2">superscript</csymbol><ci id="A1.SS1.p1.2.m2.1.1.3.3.2.2.cmml" xref="A1.SS1.p1.2.m2.1.1.3.3.2.2">𝛼</ci><ci id="A1.SS1.p1.2.m2.1.1.3.3.2.3.cmml" xref="A1.SS1.p1.2.m2.1.1.3.3.2.3">𝑡</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.2.m2.1c">\mathbf{x}_{0}=\frac{\mathbf{x}_{t}-\sqrt{1-\alpha^{t}}\epsilon}{\sqrt{\alpha^%
{t}}}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p1.2.m2.1d">bold_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT = divide start_ARG bold_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT - square-root start_ARG 1 - italic_α start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT end_ARG italic_ϵ end_ARG start_ARG square-root start_ARG italic_α start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT end_ARG end_ARG</annotation></semantics></math>, and the image recovered by the DDPM <math alttext="\theta" class="ltx_Math" display="inline" id="A1.SS1.p1.3.m3.1"><semantics id="A1.SS1.p1.3.m3.1a"><mi id="A1.SS1.p1.3.m3.1.1" xref="A1.SS1.p1.3.m3.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.3.m3.1b"><ci id="A1.SS1.p1.3.m3.1.1.cmml" xref="A1.SS1.p1.3.m3.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.3.m3.1c">\theta</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p1.3.m3.1d">italic_θ</annotation></semantics></math> is defined as <math alttext="\widehat{\mathbf{x}}^{\theta}_{0}\coloneqq\frac{\mathbf{x}_{t}-\sqrt{1-\alpha^%
{t}}\epsilon_{\theta}(\mathbf{x}_{t})}{\sqrt{\alpha^{t}}}" class="ltx_Math" display="inline" id="A1.SS1.p1.4.m4.1"><semantics id="A1.SS1.p1.4.m4.1a"><mrow id="A1.SS1.p1.4.m4.1.2" xref="A1.SS1.p1.4.m4.1.2.cmml"><msubsup id="A1.SS1.p1.4.m4.1.2.2" xref="A1.SS1.p1.4.m4.1.2.2.cmml"><mover accent="true" id="A1.SS1.p1.4.m4.1.2.2.2.2" xref="A1.SS1.p1.4.m4.1.2.2.2.2.cmml"><mi id="A1.SS1.p1.4.m4.1.2.2.2.2.2" xref="A1.SS1.p1.4.m4.1.2.2.2.2.2.cmml">𝐱</mi><mo id="A1.SS1.p1.4.m4.1.2.2.2.2.1" xref="A1.SS1.p1.4.m4.1.2.2.2.2.1.cmml">^</mo></mover><mn id="A1.SS1.p1.4.m4.1.2.2.3" xref="A1.SS1.p1.4.m4.1.2.2.3.cmml">0</mn><mi id="A1.SS1.p1.4.m4.1.2.2.2.3" xref="A1.SS1.p1.4.m4.1.2.2.2.3.cmml">θ</mi></msubsup><mo id="A1.SS1.p1.4.m4.1.2.1" xref="A1.SS1.p1.4.m4.1.2.1.cmml">≔</mo><mfrac id="A1.SS1.p1.4.m4.1.1" xref="A1.SS1.p1.4.m4.1.1.cmml"><mrow id="A1.SS1.p1.4.m4.1.1.1" xref="A1.SS1.p1.4.m4.1.1.1.cmml"><msub id="A1.SS1.p1.4.m4.1.1.1.3" xref="A1.SS1.p1.4.m4.1.1.1.3.cmml"><mi id="A1.SS1.p1.4.m4.1.1.1.3.2" xref="A1.SS1.p1.4.m4.1.1.1.3.2.cmml">𝐱</mi><mi id="A1.SS1.p1.4.m4.1.1.1.3.3" xref="A1.SS1.p1.4.m4.1.1.1.3.3.cmml">t</mi></msub><mo id="A1.SS1.p1.4.m4.1.1.1.2" xref="A1.SS1.p1.4.m4.1.1.1.2.cmml">−</mo><mrow id="A1.SS1.p1.4.m4.1.1.1.1" xref="A1.SS1.p1.4.m4.1.1.1.1.cmml"><msqrt id="A1.SS1.p1.4.m4.1.1.1.1.3" xref="A1.SS1.p1.4.m4.1.1.1.1.3.cmml"><mrow id="A1.SS1.p1.4.m4.1.1.1.1.3.2" xref="A1.SS1.p1.4.m4.1.1.1.1.3.2.cmml"><mn id="A1.SS1.p1.4.m4.1.1.1.1.3.2.2" xref="A1.SS1.p1.4.m4.1.1.1.1.3.2.2.cmml">1</mn><mo id="A1.SS1.p1.4.m4.1.1.1.1.3.2.1" xref="A1.SS1.p1.4.m4.1.1.1.1.3.2.1.cmml">−</mo><msup id="A1.SS1.p1.4.m4.1.1.1.1.3.2.3" xref="A1.SS1.p1.4.m4.1.1.1.1.3.2.3.cmml"><mi id="A1.SS1.p1.4.m4.1.1.1.1.3.2.3.2" xref="A1.SS1.p1.4.m4.1.1.1.1.3.2.3.2.cmml">α</mi><mi id="A1.SS1.p1.4.m4.1.1.1.1.3.2.3.3" xref="A1.SS1.p1.4.m4.1.1.1.1.3.2.3.3.cmml">t</mi></msup></mrow></msqrt><mo id="A1.SS1.p1.4.m4.1.1.1.1.2" xref="A1.SS1.p1.4.m4.1.1.1.1.2.cmml">⁢</mo><msub id="A1.SS1.p1.4.m4.1.1.1.1.4" xref="A1.SS1.p1.4.m4.1.1.1.1.4.cmml"><mi id="A1.SS1.p1.4.m4.1.1.1.1.4.2" xref="A1.SS1.p1.4.m4.1.1.1.1.4.2.cmml">ϵ</mi><mi id="A1.SS1.p1.4.m4.1.1.1.1.4.3" xref="A1.SS1.p1.4.m4.1.1.1.1.4.3.cmml">θ</mi></msub><mo id="A1.SS1.p1.4.m4.1.1.1.1.2a" xref="A1.SS1.p1.4.m4.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.SS1.p1.4.m4.1.1.1.1.1.1" xref="A1.SS1.p1.4.m4.1.1.1.1.1.1.1.cmml"><mo id="A1.SS1.p1.4.m4.1.1.1.1.1.1.2" stretchy="false" xref="A1.SS1.p1.4.m4.1.1.1.1.1.1.1.cmml">(</mo><msub id="A1.SS1.p1.4.m4.1.1.1.1.1.1.1" xref="A1.SS1.p1.4.m4.1.1.1.1.1.1.1.cmml"><mi id="A1.SS1.p1.4.m4.1.1.1.1.1.1.1.2" xref="A1.SS1.p1.4.m4.1.1.1.1.1.1.1.2.cmml">𝐱</mi><mi id="A1.SS1.p1.4.m4.1.1.1.1.1.1.1.3" xref="A1.SS1.p1.4.m4.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="A1.SS1.p1.4.m4.1.1.1.1.1.1.3" stretchy="false" xref="A1.SS1.p1.4.m4.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><msqrt id="A1.SS1.p1.4.m4.1.1.3" xref="A1.SS1.p1.4.m4.1.1.3.cmml"><msup id="A1.SS1.p1.4.m4.1.1.3.2" xref="A1.SS1.p1.4.m4.1.1.3.2.cmml"><mi id="A1.SS1.p1.4.m4.1.1.3.2.2" xref="A1.SS1.p1.4.m4.1.1.3.2.2.cmml">α</mi><mi id="A1.SS1.p1.4.m4.1.1.3.2.3" xref="A1.SS1.p1.4.m4.1.1.3.2.3.cmml">t</mi></msup></msqrt></mfrac></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.4.m4.1b"><apply id="A1.SS1.p1.4.m4.1.2.cmml" xref="A1.SS1.p1.4.m4.1.2"><ci id="A1.SS1.p1.4.m4.1.2.1.cmml" xref="A1.SS1.p1.4.m4.1.2.1">≔</ci><apply id="A1.SS1.p1.4.m4.1.2.2.cmml" xref="A1.SS1.p1.4.m4.1.2.2"><csymbol cd="ambiguous" id="A1.SS1.p1.4.m4.1.2.2.1.cmml" xref="A1.SS1.p1.4.m4.1.2.2">subscript</csymbol><apply id="A1.SS1.p1.4.m4.1.2.2.2.cmml" xref="A1.SS1.p1.4.m4.1.2.2"><csymbol cd="ambiguous" id="A1.SS1.p1.4.m4.1.2.2.2.1.cmml" xref="A1.SS1.p1.4.m4.1.2.2">superscript</csymbol><apply id="A1.SS1.p1.4.m4.1.2.2.2.2.cmml" xref="A1.SS1.p1.4.m4.1.2.2.2.2"><ci id="A1.SS1.p1.4.m4.1.2.2.2.2.1.cmml" xref="A1.SS1.p1.4.m4.1.2.2.2.2.1">^</ci><ci id="A1.SS1.p1.4.m4.1.2.2.2.2.2.cmml" xref="A1.SS1.p1.4.m4.1.2.2.2.2.2">𝐱</ci></apply><ci id="A1.SS1.p1.4.m4.1.2.2.2.3.cmml" xref="A1.SS1.p1.4.m4.1.2.2.2.3">𝜃</ci></apply><cn id="A1.SS1.p1.4.m4.1.2.2.3.cmml" type="integer" xref="A1.SS1.p1.4.m4.1.2.2.3">0</cn></apply><apply id="A1.SS1.p1.4.m4.1.1.cmml" xref="A1.SS1.p1.4.m4.1.1"><divide id="A1.SS1.p1.4.m4.1.1.2.cmml" xref="A1.SS1.p1.4.m4.1.1"></divide><apply id="A1.SS1.p1.4.m4.1.1.1.cmml" xref="A1.SS1.p1.4.m4.1.1.1"><minus id="A1.SS1.p1.4.m4.1.1.1.2.cmml" xref="A1.SS1.p1.4.m4.1.1.1.2"></minus><apply id="A1.SS1.p1.4.m4.1.1.1.3.cmml" xref="A1.SS1.p1.4.m4.1.1.1.3"><csymbol cd="ambiguous" id="A1.SS1.p1.4.m4.1.1.1.3.1.cmml" xref="A1.SS1.p1.4.m4.1.1.1.3">subscript</csymbol><ci id="A1.SS1.p1.4.m4.1.1.1.3.2.cmml" xref="A1.SS1.p1.4.m4.1.1.1.3.2">𝐱</ci><ci id="A1.SS1.p1.4.m4.1.1.1.3.3.cmml" xref="A1.SS1.p1.4.m4.1.1.1.3.3">𝑡</ci></apply><apply id="A1.SS1.p1.4.m4.1.1.1.1.cmml" xref="A1.SS1.p1.4.m4.1.1.1.1"><times id="A1.SS1.p1.4.m4.1.1.1.1.2.cmml" xref="A1.SS1.p1.4.m4.1.1.1.1.2"></times><apply id="A1.SS1.p1.4.m4.1.1.1.1.3.cmml" xref="A1.SS1.p1.4.m4.1.1.1.1.3"><root id="A1.SS1.p1.4.m4.1.1.1.1.3a.cmml" xref="A1.SS1.p1.4.m4.1.1.1.1.3"></root><apply id="A1.SS1.p1.4.m4.1.1.1.1.3.2.cmml" xref="A1.SS1.p1.4.m4.1.1.1.1.3.2"><minus id="A1.SS1.p1.4.m4.1.1.1.1.3.2.1.cmml" xref="A1.SS1.p1.4.m4.1.1.1.1.3.2.1"></minus><cn id="A1.SS1.p1.4.m4.1.1.1.1.3.2.2.cmml" type="integer" xref="A1.SS1.p1.4.m4.1.1.1.1.3.2.2">1</cn><apply id="A1.SS1.p1.4.m4.1.1.1.1.3.2.3.cmml" xref="A1.SS1.p1.4.m4.1.1.1.1.3.2.3"><csymbol cd="ambiguous" id="A1.SS1.p1.4.m4.1.1.1.1.3.2.3.1.cmml" xref="A1.SS1.p1.4.m4.1.1.1.1.3.2.3">superscript</csymbol><ci id="A1.SS1.p1.4.m4.1.1.1.1.3.2.3.2.cmml" xref="A1.SS1.p1.4.m4.1.1.1.1.3.2.3.2">𝛼</ci><ci id="A1.SS1.p1.4.m4.1.1.1.1.3.2.3.3.cmml" xref="A1.SS1.p1.4.m4.1.1.1.1.3.2.3.3">𝑡</ci></apply></apply></apply><apply id="A1.SS1.p1.4.m4.1.1.1.1.4.cmml" xref="A1.SS1.p1.4.m4.1.1.1.1.4"><csymbol cd="ambiguous" id="A1.SS1.p1.4.m4.1.1.1.1.4.1.cmml" xref="A1.SS1.p1.4.m4.1.1.1.1.4">subscript</csymbol><ci id="A1.SS1.p1.4.m4.1.1.1.1.4.2.cmml" xref="A1.SS1.p1.4.m4.1.1.1.1.4.2">italic-ϵ</ci><ci id="A1.SS1.p1.4.m4.1.1.1.1.4.3.cmml" xref="A1.SS1.p1.4.m4.1.1.1.1.4.3">𝜃</ci></apply><apply id="A1.SS1.p1.4.m4.1.1.1.1.1.1.1.cmml" xref="A1.SS1.p1.4.m4.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.SS1.p1.4.m4.1.1.1.1.1.1.1.1.cmml" xref="A1.SS1.p1.4.m4.1.1.1.1.1.1">subscript</csymbol><ci id="A1.SS1.p1.4.m4.1.1.1.1.1.1.1.2.cmml" xref="A1.SS1.p1.4.m4.1.1.1.1.1.1.1.2">𝐱</ci><ci id="A1.SS1.p1.4.m4.1.1.1.1.1.1.1.3.cmml" xref="A1.SS1.p1.4.m4.1.1.1.1.1.1.1.3">𝑡</ci></apply></apply></apply><apply id="A1.SS1.p1.4.m4.1.1.3.cmml" xref="A1.SS1.p1.4.m4.1.1.3"><root id="A1.SS1.p1.4.m4.1.1.3a.cmml" xref="A1.SS1.p1.4.m4.1.1.3"></root><apply id="A1.SS1.p1.4.m4.1.1.3.2.cmml" xref="A1.SS1.p1.4.m4.1.1.3.2"><csymbol cd="ambiguous" id="A1.SS1.p1.4.m4.1.1.3.2.1.cmml" xref="A1.SS1.p1.4.m4.1.1.3.2">superscript</csymbol><ci id="A1.SS1.p1.4.m4.1.1.3.2.2.cmml" xref="A1.SS1.p1.4.m4.1.1.3.2.2">𝛼</ci><ci id="A1.SS1.p1.4.m4.1.1.3.2.3.cmml" xref="A1.SS1.p1.4.m4.1.1.3.2.3">𝑡</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.4.m4.1c">\widehat{\mathbf{x}}^{\theta}_{0}\coloneqq\frac{\mathbf{x}_{t}-\sqrt{1-\alpha^%
{t}}\epsilon_{\theta}(\mathbf{x}_{t})}{\sqrt{\alpha^{t}}}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p1.4.m4.1d">over^ start_ARG bold_x end_ARG start_POSTSUPERSCRIPT italic_θ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ≔ divide start_ARG bold_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT - square-root start_ARG 1 - italic_α start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT end_ARG italic_ϵ start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( bold_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) end_ARG start_ARG square-root start_ARG italic_α start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT end_ARG end_ARG</annotation></semantics></math>. We denote the means of these two Gaussian distributions as <math alttext="\widehat{\mu}^{\theta}_{0}" class="ltx_Math" display="inline" id="A1.SS1.p1.5.m5.1"><semantics id="A1.SS1.p1.5.m5.1a"><msubsup id="A1.SS1.p1.5.m5.1.1" xref="A1.SS1.p1.5.m5.1.1.cmml"><mover accent="true" id="A1.SS1.p1.5.m5.1.1.2.2" xref="A1.SS1.p1.5.m5.1.1.2.2.cmml"><mi id="A1.SS1.p1.5.m5.1.1.2.2.2" xref="A1.SS1.p1.5.m5.1.1.2.2.2.cmml">μ</mi><mo id="A1.SS1.p1.5.m5.1.1.2.2.1" xref="A1.SS1.p1.5.m5.1.1.2.2.1.cmml">^</mo></mover><mn id="A1.SS1.p1.5.m5.1.1.3" xref="A1.SS1.p1.5.m5.1.1.3.cmml">0</mn><mi id="A1.SS1.p1.5.m5.1.1.2.3" xref="A1.SS1.p1.5.m5.1.1.2.3.cmml">θ</mi></msubsup><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.5.m5.1b"><apply id="A1.SS1.p1.5.m5.1.1.cmml" xref="A1.SS1.p1.5.m5.1.1"><csymbol cd="ambiguous" id="A1.SS1.p1.5.m5.1.1.1.cmml" xref="A1.SS1.p1.5.m5.1.1">subscript</csymbol><apply id="A1.SS1.p1.5.m5.1.1.2.cmml" xref="A1.SS1.p1.5.m5.1.1"><csymbol cd="ambiguous" id="A1.SS1.p1.5.m5.1.1.2.1.cmml" xref="A1.SS1.p1.5.m5.1.1">superscript</csymbol><apply id="A1.SS1.p1.5.m5.1.1.2.2.cmml" xref="A1.SS1.p1.5.m5.1.1.2.2"><ci id="A1.SS1.p1.5.m5.1.1.2.2.1.cmml" xref="A1.SS1.p1.5.m5.1.1.2.2.1">^</ci><ci id="A1.SS1.p1.5.m5.1.1.2.2.2.cmml" xref="A1.SS1.p1.5.m5.1.1.2.2.2">𝜇</ci></apply><ci id="A1.SS1.p1.5.m5.1.1.2.3.cmml" xref="A1.SS1.p1.5.m5.1.1.2.3">𝜃</ci></apply><cn id="A1.SS1.p1.5.m5.1.1.3.cmml" type="integer" xref="A1.SS1.p1.5.m5.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.5.m5.1c">\widehat{\mu}^{\theta}_{0}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p1.5.m5.1d">over^ start_ARG italic_μ end_ARG start_POSTSUPERSCRIPT italic_θ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\mu_{0}" class="ltx_Math" display="inline" id="A1.SS1.p1.6.m6.1"><semantics id="A1.SS1.p1.6.m6.1a"><msub id="A1.SS1.p1.6.m6.1.1" xref="A1.SS1.p1.6.m6.1.1.cmml"><mi id="A1.SS1.p1.6.m6.1.1.2" xref="A1.SS1.p1.6.m6.1.1.2.cmml">μ</mi><mn id="A1.SS1.p1.6.m6.1.1.3" xref="A1.SS1.p1.6.m6.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.6.m6.1b"><apply id="A1.SS1.p1.6.m6.1.1.cmml" xref="A1.SS1.p1.6.m6.1.1"><csymbol cd="ambiguous" id="A1.SS1.p1.6.m6.1.1.1.cmml" xref="A1.SS1.p1.6.m6.1.1">subscript</csymbol><ci id="A1.SS1.p1.6.m6.1.1.2.cmml" xref="A1.SS1.p1.6.m6.1.1.2">𝜇</ci><cn id="A1.SS1.p1.6.m6.1.1.3.cmml" type="integer" xref="A1.SS1.p1.6.m6.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.6.m6.1c">\mu_{0}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p1.6.m6.1d">italic_μ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math>, respectfully. The performance of a DDPM model <math alttext="\theta" class="ltx_Math" display="inline" id="A1.SS1.p1.7.m7.1"><semantics id="A1.SS1.p1.7.m7.1a"><mi id="A1.SS1.p1.7.m7.1.1" xref="A1.SS1.p1.7.m7.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.7.m7.1b"><ci id="A1.SS1.p1.7.m7.1.1.cmml" xref="A1.SS1.p1.7.m7.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.7.m7.1c">\theta</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p1.7.m7.1d">italic_θ</annotation></semantics></math> can be measured by the KL distance <cite class="ltx_cite ltx_citemacro_citep">(Chan, <a class="ltx_ref" href="https://arxiv.org/html/2410.05255v1#bib.bib2" title="">2024</a>)</cite> <math alttext="D_{\rm KL}(\widehat{\mathbf{x}}^{\theta}_{0}||\mathbf{x}_{0})" class="ltx_math_unparsed" display="inline" id="A1.SS1.p1.8.m8.1"><semantics id="A1.SS1.p1.8.m8.1a"><mrow id="A1.SS1.p1.8.m8.1b"><msub id="A1.SS1.p1.8.m8.1.1"><mi id="A1.SS1.p1.8.m8.1.1.2">D</mi><mi id="A1.SS1.p1.8.m8.1.1.3">KL</mi></msub><mrow id="A1.SS1.p1.8.m8.1.2"><mo id="A1.SS1.p1.8.m8.1.2.1" stretchy="false">(</mo><msubsup id="A1.SS1.p1.8.m8.1.2.2"><mover accent="true" id="A1.SS1.p1.8.m8.1.2.2.2.2"><mi id="A1.SS1.p1.8.m8.1.2.2.2.2.2">𝐱</mi><mo id="A1.SS1.p1.8.m8.1.2.2.2.2.1">^</mo></mover><mn id="A1.SS1.p1.8.m8.1.2.2.3">0</mn><mi id="A1.SS1.p1.8.m8.1.2.2.2.3">θ</mi></msubsup><mo fence="false" id="A1.SS1.p1.8.m8.1.2.3" rspace="0.167em" stretchy="false">|</mo><mo fence="false" id="A1.SS1.p1.8.m8.1.2.4" rspace="0.167em" stretchy="false">|</mo><msub id="A1.SS1.p1.8.m8.1.2.5"><mi id="A1.SS1.p1.8.m8.1.2.5.2">𝐱</mi><mn id="A1.SS1.p1.8.m8.1.2.5.3">0</mn></msub><mo id="A1.SS1.p1.8.m8.1.2.6" stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="A1.SS1.p1.8.m8.1c">D_{\rm KL}(\widehat{\mathbf{x}}^{\theta}_{0}||\mathbf{x}_{0})</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p1.8.m8.1d">italic_D start_POSTSUBSCRIPT roman_KL end_POSTSUBSCRIPT ( over^ start_ARG bold_x end_ARG start_POSTSUPERSCRIPT italic_θ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT | | bold_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT )</annotation></semantics></math> between the recovered image <math alttext="\widehat{\mathbf{x}}^{\theta}_{0}" class="ltx_Math" display="inline" id="A1.SS1.p1.9.m9.1"><semantics id="A1.SS1.p1.9.m9.1a"><msubsup id="A1.SS1.p1.9.m9.1.1" xref="A1.SS1.p1.9.m9.1.1.cmml"><mover accent="true" id="A1.SS1.p1.9.m9.1.1.2.2" xref="A1.SS1.p1.9.m9.1.1.2.2.cmml"><mi id="A1.SS1.p1.9.m9.1.1.2.2.2" xref="A1.SS1.p1.9.m9.1.1.2.2.2.cmml">𝐱</mi><mo id="A1.SS1.p1.9.m9.1.1.2.2.1" xref="A1.SS1.p1.9.m9.1.1.2.2.1.cmml">^</mo></mover><mn id="A1.SS1.p1.9.m9.1.1.3" xref="A1.SS1.p1.9.m9.1.1.3.cmml">0</mn><mi id="A1.SS1.p1.9.m9.1.1.2.3" xref="A1.SS1.p1.9.m9.1.1.2.3.cmml">θ</mi></msubsup><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.9.m9.1b"><apply id="A1.SS1.p1.9.m9.1.1.cmml" xref="A1.SS1.p1.9.m9.1.1"><csymbol cd="ambiguous" id="A1.SS1.p1.9.m9.1.1.1.cmml" xref="A1.SS1.p1.9.m9.1.1">subscript</csymbol><apply id="A1.SS1.p1.9.m9.1.1.2.cmml" xref="A1.SS1.p1.9.m9.1.1"><csymbol cd="ambiguous" id="A1.SS1.p1.9.m9.1.1.2.1.cmml" xref="A1.SS1.p1.9.m9.1.1">superscript</csymbol><apply id="A1.SS1.p1.9.m9.1.1.2.2.cmml" xref="A1.SS1.p1.9.m9.1.1.2.2"><ci id="A1.SS1.p1.9.m9.1.1.2.2.1.cmml" xref="A1.SS1.p1.9.m9.1.1.2.2.1">^</ci><ci id="A1.SS1.p1.9.m9.1.1.2.2.2.cmml" xref="A1.SS1.p1.9.m9.1.1.2.2.2">𝐱</ci></apply><ci id="A1.SS1.p1.9.m9.1.1.2.3.cmml" xref="A1.SS1.p1.9.m9.1.1.2.3">𝜃</ci></apply><cn id="A1.SS1.p1.9.m9.1.1.3.cmml" type="integer" xref="A1.SS1.p1.9.m9.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.9.m9.1c">\widehat{\mathbf{x}}^{\theta}_{0}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p1.9.m9.1d">over^ start_ARG bold_x end_ARG start_POSTSUPERSCRIPT italic_θ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math> and the original image <math alttext="\mathbf{x}_{0}" class="ltx_Math" display="inline" id="A1.SS1.p1.10.m10.1"><semantics id="A1.SS1.p1.10.m10.1a"><msub id="A1.SS1.p1.10.m10.1.1" xref="A1.SS1.p1.10.m10.1.1.cmml"><mi id="A1.SS1.p1.10.m10.1.1.2" xref="A1.SS1.p1.10.m10.1.1.2.cmml">𝐱</mi><mn id="A1.SS1.p1.10.m10.1.1.3" xref="A1.SS1.p1.10.m10.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.10.m10.1b"><apply id="A1.SS1.p1.10.m10.1.1.cmml" xref="A1.SS1.p1.10.m10.1.1"><csymbol cd="ambiguous" id="A1.SS1.p1.10.m10.1.1.1.cmml" xref="A1.SS1.p1.10.m10.1.1">subscript</csymbol><ci id="A1.SS1.p1.10.m10.1.1.2.cmml" xref="A1.SS1.p1.10.m10.1.1.2">𝐱</ci><cn id="A1.SS1.p1.10.m10.1.1.3.cmml" type="integer" xref="A1.SS1.p1.10.m10.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.10.m10.1c">\mathbf{x}_{0}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p1.10.m10.1d">bold_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math>. Thus, we give the standard of recovery performance from noisy image <math alttext="\mathbf{x}_{t}" class="ltx_Math" display="inline" id="A1.SS1.p1.11.m11.1"><semantics id="A1.SS1.p1.11.m11.1a"><msub id="A1.SS1.p1.11.m11.1.1" xref="A1.SS1.p1.11.m11.1.1.cmml"><mi id="A1.SS1.p1.11.m11.1.1.2" xref="A1.SS1.p1.11.m11.1.1.2.cmml">𝐱</mi><mi id="A1.SS1.p1.11.m11.1.1.3" xref="A1.SS1.p1.11.m11.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.11.m11.1b"><apply id="A1.SS1.p1.11.m11.1.1.cmml" xref="A1.SS1.p1.11.m11.1.1"><csymbol cd="ambiguous" id="A1.SS1.p1.11.m11.1.1.1.cmml" xref="A1.SS1.p1.11.m11.1.1">subscript</csymbol><ci id="A1.SS1.p1.11.m11.1.1.2.cmml" xref="A1.SS1.p1.11.m11.1.1.2">𝐱</ci><ci id="A1.SS1.p1.11.m11.1.1.3.cmml" xref="A1.SS1.p1.11.m11.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.11.m11.1c">\mathbf{x}_{t}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p1.11.m11.1d">bold_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> in Definition <a class="ltx_ref" href="https://arxiv.org/html/2410.05255v1#A1.Thmtheorem1" title="Definition A.1. ‣ A.1 Proof of Theorem 4.1 ‣ Appendix A Theoretical Analysis ‣ SePPO: Semi-Policy Preference Optimization for Diffusion Alignment"><span class="ltx_text ltx_ref_tag">A.1</span></a>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_theorem ltx_theorem_definition" id="A1.Thmtheorem1">
<h6 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span class="ltx_text ltx_font_bold" id="A1.Thmtheorem1.1.1.1">Definition A.1</span></span><span class="ltx_text ltx_font_bold" id="A1.Thmtheorem1.2.2">.</span>
</h6><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="A1.Thmtheorem1.p1">
<p class="ltx_p" id="A1.Thmtheorem1.p1.7">Given two DDPMs <math alttext="\theta_{1}" class="ltx_Math" display="inline" id="A1.Thmtheorem1.p1.1.m1.1"><semantics id="A1.Thmtheorem1.p1.1.m1.1a"><msub id="A1.Thmtheorem1.p1.1.m1.1.1" xref="A1.Thmtheorem1.p1.1.m1.1.1.cmml"><mi id="A1.Thmtheorem1.p1.1.m1.1.1.2" xref="A1.Thmtheorem1.p1.1.m1.1.1.2.cmml">θ</mi><mn id="A1.Thmtheorem1.p1.1.m1.1.1.3" xref="A1.Thmtheorem1.p1.1.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="A1.Thmtheorem1.p1.1.m1.1b"><apply id="A1.Thmtheorem1.p1.1.m1.1.1.cmml" xref="A1.Thmtheorem1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="A1.Thmtheorem1.p1.1.m1.1.1.1.cmml" xref="A1.Thmtheorem1.p1.1.m1.1.1">subscript</csymbol><ci id="A1.Thmtheorem1.p1.1.m1.1.1.2.cmml" xref="A1.Thmtheorem1.p1.1.m1.1.1.2">𝜃</ci><cn id="A1.Thmtheorem1.p1.1.m1.1.1.3.cmml" type="integer" xref="A1.Thmtheorem1.p1.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Thmtheorem1.p1.1.m1.1c">\theta_{1}</annotation><annotation encoding="application/x-llamapun" id="A1.Thmtheorem1.p1.1.m1.1d">italic_θ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\theta_{2}" class="ltx_Math" display="inline" id="A1.Thmtheorem1.p1.2.m2.1"><semantics id="A1.Thmtheorem1.p1.2.m2.1a"><msub id="A1.Thmtheorem1.p1.2.m2.1.1" xref="A1.Thmtheorem1.p1.2.m2.1.1.cmml"><mi id="A1.Thmtheorem1.p1.2.m2.1.1.2" xref="A1.Thmtheorem1.p1.2.m2.1.1.2.cmml">θ</mi><mn id="A1.Thmtheorem1.p1.2.m2.1.1.3" xref="A1.Thmtheorem1.p1.2.m2.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="A1.Thmtheorem1.p1.2.m2.1b"><apply id="A1.Thmtheorem1.p1.2.m2.1.1.cmml" xref="A1.Thmtheorem1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="A1.Thmtheorem1.p1.2.m2.1.1.1.cmml" xref="A1.Thmtheorem1.p1.2.m2.1.1">subscript</csymbol><ci id="A1.Thmtheorem1.p1.2.m2.1.1.2.cmml" xref="A1.Thmtheorem1.p1.2.m2.1.1.2">𝜃</ci><cn id="A1.Thmtheorem1.p1.2.m2.1.1.3.cmml" type="integer" xref="A1.Thmtheorem1.p1.2.m2.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Thmtheorem1.p1.2.m2.1c">\theta_{2}</annotation><annotation encoding="application/x-llamapun" id="A1.Thmtheorem1.p1.2.m2.1d">italic_θ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="\theta_{1}" class="ltx_Math" display="inline" id="A1.Thmtheorem1.p1.3.m3.1"><semantics id="A1.Thmtheorem1.p1.3.m3.1a"><msub id="A1.Thmtheorem1.p1.3.m3.1.1" xref="A1.Thmtheorem1.p1.3.m3.1.1.cmml"><mi id="A1.Thmtheorem1.p1.3.m3.1.1.2" xref="A1.Thmtheorem1.p1.3.m3.1.1.2.cmml">θ</mi><mn id="A1.Thmtheorem1.p1.3.m3.1.1.3" xref="A1.Thmtheorem1.p1.3.m3.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="A1.Thmtheorem1.p1.3.m3.1b"><apply id="A1.Thmtheorem1.p1.3.m3.1.1.cmml" xref="A1.Thmtheorem1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="A1.Thmtheorem1.p1.3.m3.1.1.1.cmml" xref="A1.Thmtheorem1.p1.3.m3.1.1">subscript</csymbol><ci id="A1.Thmtheorem1.p1.3.m3.1.1.2.cmml" xref="A1.Thmtheorem1.p1.3.m3.1.1.2">𝜃</ci><cn id="A1.Thmtheorem1.p1.3.m3.1.1.3.cmml" type="integer" xref="A1.Thmtheorem1.p1.3.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Thmtheorem1.p1.3.m3.1c">\theta_{1}</annotation><annotation encoding="application/x-llamapun" id="A1.Thmtheorem1.p1.3.m3.1d">italic_θ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> is better than <math alttext="\theta_{2}" class="ltx_Math" display="inline" id="A1.Thmtheorem1.p1.4.m4.1"><semantics id="A1.Thmtheorem1.p1.4.m4.1a"><msub id="A1.Thmtheorem1.p1.4.m4.1.1" xref="A1.Thmtheorem1.p1.4.m4.1.1.cmml"><mi id="A1.Thmtheorem1.p1.4.m4.1.1.2" xref="A1.Thmtheorem1.p1.4.m4.1.1.2.cmml">θ</mi><mn id="A1.Thmtheorem1.p1.4.m4.1.1.3" xref="A1.Thmtheorem1.p1.4.m4.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="A1.Thmtheorem1.p1.4.m4.1b"><apply id="A1.Thmtheorem1.p1.4.m4.1.1.cmml" xref="A1.Thmtheorem1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="A1.Thmtheorem1.p1.4.m4.1.1.1.cmml" xref="A1.Thmtheorem1.p1.4.m4.1.1">subscript</csymbol><ci id="A1.Thmtheorem1.p1.4.m4.1.1.2.cmml" xref="A1.Thmtheorem1.p1.4.m4.1.1.2">𝜃</ci><cn id="A1.Thmtheorem1.p1.4.m4.1.1.3.cmml" type="integer" xref="A1.Thmtheorem1.p1.4.m4.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Thmtheorem1.p1.4.m4.1c">\theta_{2}</annotation><annotation encoding="application/x-llamapun" id="A1.Thmtheorem1.p1.4.m4.1d">italic_θ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math> (<math alttext="{\theta_{1}}\succ{\theta_{2}}" class="ltx_Math" display="inline" id="A1.Thmtheorem1.p1.5.m5.1"><semantics id="A1.Thmtheorem1.p1.5.m5.1a"><mrow id="A1.Thmtheorem1.p1.5.m5.1.1" xref="A1.Thmtheorem1.p1.5.m5.1.1.cmml"><msub id="A1.Thmtheorem1.p1.5.m5.1.1.2" xref="A1.Thmtheorem1.p1.5.m5.1.1.2.cmml"><mi id="A1.Thmtheorem1.p1.5.m5.1.1.2.2" xref="A1.Thmtheorem1.p1.5.m5.1.1.2.2.cmml">θ</mi><mn id="A1.Thmtheorem1.p1.5.m5.1.1.2.3" xref="A1.Thmtheorem1.p1.5.m5.1.1.2.3.cmml">1</mn></msub><mo id="A1.Thmtheorem1.p1.5.m5.1.1.1" xref="A1.Thmtheorem1.p1.5.m5.1.1.1.cmml">≻</mo><msub id="A1.Thmtheorem1.p1.5.m5.1.1.3" xref="A1.Thmtheorem1.p1.5.m5.1.1.3.cmml"><mi id="A1.Thmtheorem1.p1.5.m5.1.1.3.2" xref="A1.Thmtheorem1.p1.5.m5.1.1.3.2.cmml">θ</mi><mn id="A1.Thmtheorem1.p1.5.m5.1.1.3.3" xref="A1.Thmtheorem1.p1.5.m5.1.1.3.3.cmml">2</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="A1.Thmtheorem1.p1.5.m5.1b"><apply id="A1.Thmtheorem1.p1.5.m5.1.1.cmml" xref="A1.Thmtheorem1.p1.5.m5.1.1"><csymbol cd="latexml" id="A1.Thmtheorem1.p1.5.m5.1.1.1.cmml" xref="A1.Thmtheorem1.p1.5.m5.1.1.1">succeeds</csymbol><apply id="A1.Thmtheorem1.p1.5.m5.1.1.2.cmml" xref="A1.Thmtheorem1.p1.5.m5.1.1.2"><csymbol cd="ambiguous" id="A1.Thmtheorem1.p1.5.m5.1.1.2.1.cmml" xref="A1.Thmtheorem1.p1.5.m5.1.1.2">subscript</csymbol><ci id="A1.Thmtheorem1.p1.5.m5.1.1.2.2.cmml" xref="A1.Thmtheorem1.p1.5.m5.1.1.2.2">𝜃</ci><cn id="A1.Thmtheorem1.p1.5.m5.1.1.2.3.cmml" type="integer" xref="A1.Thmtheorem1.p1.5.m5.1.1.2.3">1</cn></apply><apply id="A1.Thmtheorem1.p1.5.m5.1.1.3.cmml" xref="A1.Thmtheorem1.p1.5.m5.1.1.3"><csymbol cd="ambiguous" id="A1.Thmtheorem1.p1.5.m5.1.1.3.1.cmml" xref="A1.Thmtheorem1.p1.5.m5.1.1.3">subscript</csymbol><ci id="A1.Thmtheorem1.p1.5.m5.1.1.3.2.cmml" xref="A1.Thmtheorem1.p1.5.m5.1.1.3.2">𝜃</ci><cn id="A1.Thmtheorem1.p1.5.m5.1.1.3.3.cmml" type="integer" xref="A1.Thmtheorem1.p1.5.m5.1.1.3.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Thmtheorem1.p1.5.m5.1c">{\theta_{1}}\succ{\theta_{2}}</annotation><annotation encoding="application/x-llamapun" id="A1.Thmtheorem1.p1.5.m5.1d">italic_θ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ≻ italic_θ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>) if its predicted image <math alttext="\widehat{\mathbf{x}}^{\theta_{1}}_{0}" class="ltx_Math" display="inline" id="A1.Thmtheorem1.p1.6.m6.1"><semantics id="A1.Thmtheorem1.p1.6.m6.1a"><msubsup id="A1.Thmtheorem1.p1.6.m6.1.1" xref="A1.Thmtheorem1.p1.6.m6.1.1.cmml"><mover accent="true" id="A1.Thmtheorem1.p1.6.m6.1.1.2.2" xref="A1.Thmtheorem1.p1.6.m6.1.1.2.2.cmml"><mi id="A1.Thmtheorem1.p1.6.m6.1.1.2.2.2" xref="A1.Thmtheorem1.p1.6.m6.1.1.2.2.2.cmml">𝐱</mi><mo id="A1.Thmtheorem1.p1.6.m6.1.1.2.2.1" xref="A1.Thmtheorem1.p1.6.m6.1.1.2.2.1.cmml">^</mo></mover><mn id="A1.Thmtheorem1.p1.6.m6.1.1.3" xref="A1.Thmtheorem1.p1.6.m6.1.1.3.cmml">0</mn><msub id="A1.Thmtheorem1.p1.6.m6.1.1.2.3" xref="A1.Thmtheorem1.p1.6.m6.1.1.2.3.cmml"><mi id="A1.Thmtheorem1.p1.6.m6.1.1.2.3.2" xref="A1.Thmtheorem1.p1.6.m6.1.1.2.3.2.cmml">θ</mi><mn id="A1.Thmtheorem1.p1.6.m6.1.1.2.3.3" xref="A1.Thmtheorem1.p1.6.m6.1.1.2.3.3.cmml">1</mn></msub></msubsup><annotation-xml encoding="MathML-Content" id="A1.Thmtheorem1.p1.6.m6.1b"><apply id="A1.Thmtheorem1.p1.6.m6.1.1.cmml" xref="A1.Thmtheorem1.p1.6.m6.1.1"><csymbol cd="ambiguous" id="A1.Thmtheorem1.p1.6.m6.1.1.1.cmml" xref="A1.Thmtheorem1.p1.6.m6.1.1">subscript</csymbol><apply id="A1.Thmtheorem1.p1.6.m6.1.1.2.cmml" xref="A1.Thmtheorem1.p1.6.m6.1.1"><csymbol cd="ambiguous" id="A1.Thmtheorem1.p1.6.m6.1.1.2.1.cmml" xref="A1.Thmtheorem1.p1.6.m6.1.1">superscript</csymbol><apply id="A1.Thmtheorem1.p1.6.m6.1.1.2.2.cmml" xref="A1.Thmtheorem1.p1.6.m6.1.1.2.2"><ci id="A1.Thmtheorem1.p1.6.m6.1.1.2.2.1.cmml" xref="A1.Thmtheorem1.p1.6.m6.1.1.2.2.1">^</ci><ci id="A1.Thmtheorem1.p1.6.m6.1.1.2.2.2.cmml" xref="A1.Thmtheorem1.p1.6.m6.1.1.2.2.2">𝐱</ci></apply><apply id="A1.Thmtheorem1.p1.6.m6.1.1.2.3.cmml" xref="A1.Thmtheorem1.p1.6.m6.1.1.2.3"><csymbol cd="ambiguous" id="A1.Thmtheorem1.p1.6.m6.1.1.2.3.1.cmml" xref="A1.Thmtheorem1.p1.6.m6.1.1.2.3">subscript</csymbol><ci id="A1.Thmtheorem1.p1.6.m6.1.1.2.3.2.cmml" xref="A1.Thmtheorem1.p1.6.m6.1.1.2.3.2">𝜃</ci><cn id="A1.Thmtheorem1.p1.6.m6.1.1.2.3.3.cmml" type="integer" xref="A1.Thmtheorem1.p1.6.m6.1.1.2.3.3">1</cn></apply></apply><cn id="A1.Thmtheorem1.p1.6.m6.1.1.3.cmml" type="integer" xref="A1.Thmtheorem1.p1.6.m6.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Thmtheorem1.p1.6.m6.1c">\widehat{\mathbf{x}}^{\theta_{1}}_{0}</annotation><annotation encoding="application/x-llamapun" id="A1.Thmtheorem1.p1.6.m6.1d">over^ start_ARG bold_x end_ARG start_POSTSUPERSCRIPT italic_θ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math> has less KL divergence with the original image <math alttext="\mathbf{x}_{0}" class="ltx_Math" display="inline" id="A1.Thmtheorem1.p1.7.m7.1"><semantics id="A1.Thmtheorem1.p1.7.m7.1a"><msub id="A1.Thmtheorem1.p1.7.m7.1.1" xref="A1.Thmtheorem1.p1.7.m7.1.1.cmml"><mi id="A1.Thmtheorem1.p1.7.m7.1.1.2" xref="A1.Thmtheorem1.p1.7.m7.1.1.2.cmml">𝐱</mi><mn id="A1.Thmtheorem1.p1.7.m7.1.1.3" xref="A1.Thmtheorem1.p1.7.m7.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="A1.Thmtheorem1.p1.7.m7.1b"><apply id="A1.Thmtheorem1.p1.7.m7.1.1.cmml" xref="A1.Thmtheorem1.p1.7.m7.1.1"><csymbol cd="ambiguous" id="A1.Thmtheorem1.p1.7.m7.1.1.1.cmml" xref="A1.Thmtheorem1.p1.7.m7.1.1">subscript</csymbol><ci id="A1.Thmtheorem1.p1.7.m7.1.1.2.cmml" xref="A1.Thmtheorem1.p1.7.m7.1.1.2">𝐱</ci><cn id="A1.Thmtheorem1.p1.7.m7.1.1.3.cmml" type="integer" xref="A1.Thmtheorem1.p1.7.m7.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Thmtheorem1.p1.7.m7.1c">\mathbf{x}_{0}</annotation><annotation encoding="application/x-llamapun" id="A1.Thmtheorem1.p1.7.m7.1d">bold_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math> as follows</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equationgroup ltx_eqn_table" id="A1.E11">
<tbody>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="A1.E11X">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle D_{\rm KL}(\widehat{\mathbf{x}}^{\theta_{1}}_{0}||\mathbf{x}_{0})" class="ltx_math_unparsed" display="inline" id="A1.E11X.2.1.1.m1.1"><semantics id="A1.E11X.2.1.1.m1.1a"><mrow id="A1.E11X.2.1.1.m1.1b"><msub id="A1.E11X.2.1.1.m1.1.1"><mi id="A1.E11X.2.1.1.m1.1.1.2">D</mi><mi id="A1.E11X.2.1.1.m1.1.1.3">KL</mi></msub><mrow id="A1.E11X.2.1.1.m1.1.2"><mo id="A1.E11X.2.1.1.m1.1.2.1" stretchy="false">(</mo><msubsup id="A1.E11X.2.1.1.m1.1.2.2"><mover accent="true" id="A1.E11X.2.1.1.m1.1.2.2.2.2"><mi id="A1.E11X.2.1.1.m1.1.2.2.2.2.2">𝐱</mi><mo id="A1.E11X.2.1.1.m1.1.2.2.2.2.1">^</mo></mover><mn id="A1.E11X.2.1.1.m1.1.2.2.3">0</mn><msub id="A1.E11X.2.1.1.m1.1.2.2.2.3"><mi id="A1.E11X.2.1.1.m1.1.2.2.2.3.2">θ</mi><mn id="A1.E11X.2.1.1.m1.1.2.2.2.3.3">1</mn></msub></msubsup><mo fence="false" id="A1.E11X.2.1.1.m1.1.2.3" rspace="0.167em" stretchy="false">|</mo><mo fence="false" id="A1.E11X.2.1.1.m1.1.2.4" rspace="0.167em" stretchy="false">|</mo><msub id="A1.E11X.2.1.1.m1.1.2.5"><mi id="A1.E11X.2.1.1.m1.1.2.5.2">𝐱</mi><mn id="A1.E11X.2.1.1.m1.1.2.5.3">0</mn></msub><mo id="A1.E11X.2.1.1.m1.1.2.6" stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="A1.E11X.2.1.1.m1.1c">\displaystyle D_{\rm KL}(\widehat{\mathbf{x}}^{\theta_{1}}_{0}||\mathbf{x}_{0})</annotation><annotation encoding="application/x-llamapun" id="A1.E11X.2.1.1.m1.1d">italic_D start_POSTSUBSCRIPT roman_KL end_POSTSUBSCRIPT ( over^ start_ARG bold_x end_ARG start_POSTSUPERSCRIPT italic_θ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT | | bold_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\leq D_{\rm KL}(\widehat{\mathbf{x}}^{\theta_{2}}_{0}||\mathbf{x}%
_{0})." class="ltx_math_unparsed" display="inline" id="A1.E11X.3.2.2.m1.1"><semantics id="A1.E11X.3.2.2.m1.1a"><mrow id="A1.E11X.3.2.2.m1.1b"><mo id="A1.E11X.3.2.2.m1.1.1">≤</mo><msub id="A1.E11X.3.2.2.m1.1.2"><mi id="A1.E11X.3.2.2.m1.1.2.2">D</mi><mi id="A1.E11X.3.2.2.m1.1.2.3">KL</mi></msub><mrow id="A1.E11X.3.2.2.m1.1.3"><mo id="A1.E11X.3.2.2.m1.1.3.1" stretchy="false">(</mo><msubsup id="A1.E11X.3.2.2.m1.1.3.2"><mover accent="true" id="A1.E11X.3.2.2.m1.1.3.2.2.2"><mi id="A1.E11X.3.2.2.m1.1.3.2.2.2.2">𝐱</mi><mo id="A1.E11X.3.2.2.m1.1.3.2.2.2.1">^</mo></mover><mn id="A1.E11X.3.2.2.m1.1.3.2.3">0</mn><msub id="A1.E11X.3.2.2.m1.1.3.2.2.3"><mi id="A1.E11X.3.2.2.m1.1.3.2.2.3.2">θ</mi><mn id="A1.E11X.3.2.2.m1.1.3.2.2.3.3">2</mn></msub></msubsup><mo fence="false" id="A1.E11X.3.2.2.m1.1.3.3" rspace="0.167em" stretchy="false">|</mo><mo fence="false" id="A1.E11X.3.2.2.m1.1.3.4" rspace="0.167em" stretchy="false">|</mo><msub id="A1.E11X.3.2.2.m1.1.3.5"><mi id="A1.E11X.3.2.2.m1.1.3.5.2">𝐱</mi><mn id="A1.E11X.3.2.2.m1.1.3.5.3">0</mn></msub><mo id="A1.E11X.3.2.2.m1.1.3.6" stretchy="false">)</mo></mrow><mo id="A1.E11X.3.2.2.m1.1.4" lspace="0em">.</mo></mrow><annotation encoding="application/x-tex" id="A1.E11X.3.2.2.m1.1c">\displaystyle\leq D_{\rm KL}(\widehat{\mathbf{x}}^{\theta_{2}}_{0}||\mathbf{x}%
_{0}).</annotation><annotation encoding="application/x-llamapun" id="A1.E11X.3.2.2.m1.1d">≤ italic_D start_POSTSUBSCRIPT roman_KL end_POSTSUBSCRIPT ( over^ start_ARG bold_x end_ARG start_POSTSUPERSCRIPT italic_θ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT | | bold_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(11)</span></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="ltx_para ltx_noindent" id="A1.SS1.p2">
<p class="ltx_p" id="A1.SS1.p2.2">In the noise injection process, the variance of the images remains the same. (<math alttext="\mathbf{x}_{0}" class="ltx_Math" display="inline" id="A1.SS1.p2.1.m1.1"><semantics id="A1.SS1.p2.1.m1.1a"><msub id="A1.SS1.p2.1.m1.1.1" xref="A1.SS1.p2.1.m1.1.1.cmml"><mi id="A1.SS1.p2.1.m1.1.1.2" xref="A1.SS1.p2.1.m1.1.1.2.cmml">𝐱</mi><mn id="A1.SS1.p2.1.m1.1.1.3" xref="A1.SS1.p2.1.m1.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="A1.SS1.p2.1.m1.1b"><apply id="A1.SS1.p2.1.m1.1.1.cmml" xref="A1.SS1.p2.1.m1.1.1"><csymbol cd="ambiguous" id="A1.SS1.p2.1.m1.1.1.1.cmml" xref="A1.SS1.p2.1.m1.1.1">subscript</csymbol><ci id="A1.SS1.p2.1.m1.1.1.2.cmml" xref="A1.SS1.p2.1.m1.1.1.2">𝐱</ci><cn id="A1.SS1.p2.1.m1.1.1.3.cmml" type="integer" xref="A1.SS1.p2.1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p2.1.m1.1c">\mathbf{x}_{0}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p2.1.m1.1d">bold_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\mathbf{x}_{t}" class="ltx_Math" display="inline" id="A1.SS1.p2.2.m2.1"><semantics id="A1.SS1.p2.2.m2.1a"><msub id="A1.SS1.p2.2.m2.1.1" xref="A1.SS1.p2.2.m2.1.1.cmml"><mi id="A1.SS1.p2.2.m2.1.1.2" xref="A1.SS1.p2.2.m2.1.1.2.cmml">𝐱</mi><mi id="A1.SS1.p2.2.m2.1.1.3" xref="A1.SS1.p2.2.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS1.p2.2.m2.1b"><apply id="A1.SS1.p2.2.m2.1.1.cmml" xref="A1.SS1.p2.2.m2.1.1"><csymbol cd="ambiguous" id="A1.SS1.p2.2.m2.1.1.1.cmml" xref="A1.SS1.p2.2.m2.1.1">subscript</csymbol><ci id="A1.SS1.p2.2.m2.1.1.2.cmml" xref="A1.SS1.p2.2.m2.1.1.2">𝐱</ci><ci id="A1.SS1.p2.2.m2.1.1.3.cmml" xref="A1.SS1.p2.2.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p2.2.m2.1c">\mathbf{x}_{t}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p2.2.m2.1d">bold_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> have the same variance.) With the fact that the KL divergence between two Gaussian distributions with the identical variance is proportional to the Euclidean distance of their means, we have</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equationgroup ltx_eqn_table" id="A1.E12">
<tbody>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="A1.E12X">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle D_{\rm KL}(\widehat{\mathbf{x}}^{\theta}_{0}||\mathbf{x}_{0}){}" class="ltx_math_unparsed" display="inline" id="A1.E12X.2.1.1.m1.1"><semantics id="A1.E12X.2.1.1.m1.1a"><mrow id="A1.E12X.2.1.1.m1.1b"><msub id="A1.E12X.2.1.1.m1.1.1"><mi id="A1.E12X.2.1.1.m1.1.1.2">D</mi><mi id="A1.E12X.2.1.1.m1.1.1.3">KL</mi></msub><mrow id="A1.E12X.2.1.1.m1.1.2"><mo id="A1.E12X.2.1.1.m1.1.2.1" stretchy="false">(</mo><msubsup id="A1.E12X.2.1.1.m1.1.2.2"><mover accent="true" id="A1.E12X.2.1.1.m1.1.2.2.2.2"><mi id="A1.E12X.2.1.1.m1.1.2.2.2.2.2">𝐱</mi><mo id="A1.E12X.2.1.1.m1.1.2.2.2.2.1">^</mo></mover><mn id="A1.E12X.2.1.1.m1.1.2.2.3">0</mn><mi id="A1.E12X.2.1.1.m1.1.2.2.2.3">θ</mi></msubsup><mo fence="false" id="A1.E12X.2.1.1.m1.1.2.3" rspace="0.167em" stretchy="false">|</mo><mo fence="false" id="A1.E12X.2.1.1.m1.1.2.4" rspace="0.167em" stretchy="false">|</mo><msub id="A1.E12X.2.1.1.m1.1.2.5"><mi id="A1.E12X.2.1.1.m1.1.2.5.2">𝐱</mi><mn id="A1.E12X.2.1.1.m1.1.2.5.3">0</mn></msub><mo id="A1.E12X.2.1.1.m1.1.2.6" stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="A1.E12X.2.1.1.m1.1c">\displaystyle D_{\rm KL}(\widehat{\mathbf{x}}^{\theta}_{0}||\mathbf{x}_{0}){}</annotation><annotation encoding="application/x-llamapun" id="A1.E12X.2.1.1.m1.1d">italic_D start_POSTSUBSCRIPT roman_KL end_POSTSUBSCRIPT ( over^ start_ARG bold_x end_ARG start_POSTSUPERSCRIPT italic_θ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT | | bold_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=~{}\frac{1}{2\sigma_{0}^{2}}\|\widehat{\mu}^{\theta}_{0}-\mu_{0}%
\|^{2}" class="ltx_Math" display="inline" id="A1.E12X.3.2.2.m1.1"><semantics id="A1.E12X.3.2.2.m1.1a"><mrow id="A1.E12X.3.2.2.m1.1.1" xref="A1.E12X.3.2.2.m1.1.1.cmml"><mi id="A1.E12X.3.2.2.m1.1.1.3" xref="A1.E12X.3.2.2.m1.1.1.3.cmml"></mi><mo id="A1.E12X.3.2.2.m1.1.1.2" rspace="0.608em" xref="A1.E12X.3.2.2.m1.1.1.2.cmml">=</mo><mrow id="A1.E12X.3.2.2.m1.1.1.1" xref="A1.E12X.3.2.2.m1.1.1.1.cmml"><mstyle displaystyle="true" id="A1.E12X.3.2.2.m1.1.1.1.3" xref="A1.E12X.3.2.2.m1.1.1.1.3.cmml"><mfrac id="A1.E12X.3.2.2.m1.1.1.1.3a" xref="A1.E12X.3.2.2.m1.1.1.1.3.cmml"><mn id="A1.E12X.3.2.2.m1.1.1.1.3.2" xref="A1.E12X.3.2.2.m1.1.1.1.3.2.cmml">1</mn><mrow id="A1.E12X.3.2.2.m1.1.1.1.3.3" xref="A1.E12X.3.2.2.m1.1.1.1.3.3.cmml"><mn id="A1.E12X.3.2.2.m1.1.1.1.3.3.2" xref="A1.E12X.3.2.2.m1.1.1.1.3.3.2.cmml">2</mn><mo id="A1.E12X.3.2.2.m1.1.1.1.3.3.1" xref="A1.E12X.3.2.2.m1.1.1.1.3.3.1.cmml">⁢</mo><msubsup id="A1.E12X.3.2.2.m1.1.1.1.3.3.3" xref="A1.E12X.3.2.2.m1.1.1.1.3.3.3.cmml"><mi id="A1.E12X.3.2.2.m1.1.1.1.3.3.3.2.2" xref="A1.E12X.3.2.2.m1.1.1.1.3.3.3.2.2.cmml">σ</mi><mn id="A1.E12X.3.2.2.m1.1.1.1.3.3.3.2.3" xref="A1.E12X.3.2.2.m1.1.1.1.3.3.3.2.3.cmml">0</mn><mn id="A1.E12X.3.2.2.m1.1.1.1.3.3.3.3" xref="A1.E12X.3.2.2.m1.1.1.1.3.3.3.3.cmml">2</mn></msubsup></mrow></mfrac></mstyle><mo id="A1.E12X.3.2.2.m1.1.1.1.2" xref="A1.E12X.3.2.2.m1.1.1.1.2.cmml">⁢</mo><msup id="A1.E12X.3.2.2.m1.1.1.1.1" xref="A1.E12X.3.2.2.m1.1.1.1.1.cmml"><mrow id="A1.E12X.3.2.2.m1.1.1.1.1.1.1" xref="A1.E12X.3.2.2.m1.1.1.1.1.1.2.cmml"><mo id="A1.E12X.3.2.2.m1.1.1.1.1.1.1.2" stretchy="false" xref="A1.E12X.3.2.2.m1.1.1.1.1.1.2.1.cmml">‖</mo><mrow id="A1.E12X.3.2.2.m1.1.1.1.1.1.1.1" xref="A1.E12X.3.2.2.m1.1.1.1.1.1.1.1.cmml"><msubsup id="A1.E12X.3.2.2.m1.1.1.1.1.1.1.1.2" xref="A1.E12X.3.2.2.m1.1.1.1.1.1.1.1.2.cmml"><mover accent="true" id="A1.E12X.3.2.2.m1.1.1.1.1.1.1.1.2.2.2" xref="A1.E12X.3.2.2.m1.1.1.1.1.1.1.1.2.2.2.cmml"><mi id="A1.E12X.3.2.2.m1.1.1.1.1.1.1.1.2.2.2.2" xref="A1.E12X.3.2.2.m1.1.1.1.1.1.1.1.2.2.2.2.cmml">μ</mi><mo id="A1.E12X.3.2.2.m1.1.1.1.1.1.1.1.2.2.2.1" xref="A1.E12X.3.2.2.m1.1.1.1.1.1.1.1.2.2.2.1.cmml">^</mo></mover><mn id="A1.E12X.3.2.2.m1.1.1.1.1.1.1.1.2.3" xref="A1.E12X.3.2.2.m1.1.1.1.1.1.1.1.2.3.cmml">0</mn><mi id="A1.E12X.3.2.2.m1.1.1.1.1.1.1.1.2.2.3" xref="A1.E12X.3.2.2.m1.1.1.1.1.1.1.1.2.2.3.cmml">θ</mi></msubsup><mo id="A1.E12X.3.2.2.m1.1.1.1.1.1.1.1.1" xref="A1.E12X.3.2.2.m1.1.1.1.1.1.1.1.1.cmml">−</mo><msub id="A1.E12X.3.2.2.m1.1.1.1.1.1.1.1.3" xref="A1.E12X.3.2.2.m1.1.1.1.1.1.1.1.3.cmml"><mi id="A1.E12X.3.2.2.m1.1.1.1.1.1.1.1.3.2" xref="A1.E12X.3.2.2.m1.1.1.1.1.1.1.1.3.2.cmml">μ</mi><mn id="A1.E12X.3.2.2.m1.1.1.1.1.1.1.1.3.3" xref="A1.E12X.3.2.2.m1.1.1.1.1.1.1.1.3.3.cmml">0</mn></msub></mrow><mo id="A1.E12X.3.2.2.m1.1.1.1.1.1.1.3" stretchy="false" xref="A1.E12X.3.2.2.m1.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="A1.E12X.3.2.2.m1.1.1.1.1.3" xref="A1.E12X.3.2.2.m1.1.1.1.1.3.cmml">2</mn></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E12X.3.2.2.m1.1b"><apply id="A1.E12X.3.2.2.m1.1.1.cmml" xref="A1.E12X.3.2.2.m1.1.1"><eq id="A1.E12X.3.2.2.m1.1.1.2.cmml" xref="A1.E12X.3.2.2.m1.1.1.2"></eq><csymbol cd="latexml" id="A1.E12X.3.2.2.m1.1.1.3.cmml" xref="A1.E12X.3.2.2.m1.1.1.3">absent</csymbol><apply id="A1.E12X.3.2.2.m1.1.1.1.cmml" xref="A1.E12X.3.2.2.m1.1.1.1"><times id="A1.E12X.3.2.2.m1.1.1.1.2.cmml" xref="A1.E12X.3.2.2.m1.1.1.1.2"></times><apply id="A1.E12X.3.2.2.m1.1.1.1.3.cmml" xref="A1.E12X.3.2.2.m1.1.1.1.3"><divide id="A1.E12X.3.2.2.m1.1.1.1.3.1.cmml" xref="A1.E12X.3.2.2.m1.1.1.1.3"></divide><cn id="A1.E12X.3.2.2.m1.1.1.1.3.2.cmml" type="integer" xref="A1.E12X.3.2.2.m1.1.1.1.3.2">1</cn><apply id="A1.E12X.3.2.2.m1.1.1.1.3.3.cmml" xref="A1.E12X.3.2.2.m1.1.1.1.3.3"><times id="A1.E12X.3.2.2.m1.1.1.1.3.3.1.cmml" xref="A1.E12X.3.2.2.m1.1.1.1.3.3.1"></times><cn id="A1.E12X.3.2.2.m1.1.1.1.3.3.2.cmml" type="integer" xref="A1.E12X.3.2.2.m1.1.1.1.3.3.2">2</cn><apply id="A1.E12X.3.2.2.m1.1.1.1.3.3.3.cmml" xref="A1.E12X.3.2.2.m1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="A1.E12X.3.2.2.m1.1.1.1.3.3.3.1.cmml" xref="A1.E12X.3.2.2.m1.1.1.1.3.3.3">superscript</csymbol><apply id="A1.E12X.3.2.2.m1.1.1.1.3.3.3.2.cmml" xref="A1.E12X.3.2.2.m1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="A1.E12X.3.2.2.m1.1.1.1.3.3.3.2.1.cmml" xref="A1.E12X.3.2.2.m1.1.1.1.3.3.3">subscript</csymbol><ci id="A1.E12X.3.2.2.m1.1.1.1.3.3.3.2.2.cmml" xref="A1.E12X.3.2.2.m1.1.1.1.3.3.3.2.2">𝜎</ci><cn id="A1.E12X.3.2.2.m1.1.1.1.3.3.3.2.3.cmml" type="integer" xref="A1.E12X.3.2.2.m1.1.1.1.3.3.3.2.3">0</cn></apply><cn id="A1.E12X.3.2.2.m1.1.1.1.3.3.3.3.cmml" type="integer" xref="A1.E12X.3.2.2.m1.1.1.1.3.3.3.3">2</cn></apply></apply></apply><apply id="A1.E12X.3.2.2.m1.1.1.1.1.cmml" xref="A1.E12X.3.2.2.m1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E12X.3.2.2.m1.1.1.1.1.2.cmml" xref="A1.E12X.3.2.2.m1.1.1.1.1">superscript</csymbol><apply id="A1.E12X.3.2.2.m1.1.1.1.1.1.2.cmml" xref="A1.E12X.3.2.2.m1.1.1.1.1.1.1"><csymbol cd="latexml" id="A1.E12X.3.2.2.m1.1.1.1.1.1.2.1.cmml" xref="A1.E12X.3.2.2.m1.1.1.1.1.1.1.2">norm</csymbol><apply id="A1.E12X.3.2.2.m1.1.1.1.1.1.1.1.cmml" xref="A1.E12X.3.2.2.m1.1.1.1.1.1.1.1"><minus id="A1.E12X.3.2.2.m1.1.1.1.1.1.1.1.1.cmml" xref="A1.E12X.3.2.2.m1.1.1.1.1.1.1.1.1"></minus><apply id="A1.E12X.3.2.2.m1.1.1.1.1.1.1.1.2.cmml" xref="A1.E12X.3.2.2.m1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.E12X.3.2.2.m1.1.1.1.1.1.1.1.2.1.cmml" xref="A1.E12X.3.2.2.m1.1.1.1.1.1.1.1.2">subscript</csymbol><apply id="A1.E12X.3.2.2.m1.1.1.1.1.1.1.1.2.2.cmml" xref="A1.E12X.3.2.2.m1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.E12X.3.2.2.m1.1.1.1.1.1.1.1.2.2.1.cmml" xref="A1.E12X.3.2.2.m1.1.1.1.1.1.1.1.2">superscript</csymbol><apply id="A1.E12X.3.2.2.m1.1.1.1.1.1.1.1.2.2.2.cmml" xref="A1.E12X.3.2.2.m1.1.1.1.1.1.1.1.2.2.2"><ci id="A1.E12X.3.2.2.m1.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="A1.E12X.3.2.2.m1.1.1.1.1.1.1.1.2.2.2.1">^</ci><ci id="A1.E12X.3.2.2.m1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="A1.E12X.3.2.2.m1.1.1.1.1.1.1.1.2.2.2.2">𝜇</ci></apply><ci id="A1.E12X.3.2.2.m1.1.1.1.1.1.1.1.2.2.3.cmml" xref="A1.E12X.3.2.2.m1.1.1.1.1.1.1.1.2.2.3">𝜃</ci></apply><cn id="A1.E12X.3.2.2.m1.1.1.1.1.1.1.1.2.3.cmml" type="integer" xref="A1.E12X.3.2.2.m1.1.1.1.1.1.1.1.2.3">0</cn></apply><apply id="A1.E12X.3.2.2.m1.1.1.1.1.1.1.1.3.cmml" xref="A1.E12X.3.2.2.m1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.E12X.3.2.2.m1.1.1.1.1.1.1.1.3.1.cmml" xref="A1.E12X.3.2.2.m1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="A1.E12X.3.2.2.m1.1.1.1.1.1.1.1.3.2.cmml" xref="A1.E12X.3.2.2.m1.1.1.1.1.1.1.1.3.2">𝜇</ci><cn id="A1.E12X.3.2.2.m1.1.1.1.1.1.1.1.3.3.cmml" type="integer" xref="A1.E12X.3.2.2.m1.1.1.1.1.1.1.1.3.3">0</cn></apply></apply></apply><cn id="A1.E12X.3.2.2.m1.1.1.1.1.3.cmml" type="integer" xref="A1.E12X.3.2.2.m1.1.1.1.1.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E12X.3.2.2.m1.1c">\displaystyle=~{}\frac{1}{2\sigma_{0}^{2}}\|\widehat{\mu}^{\theta}_{0}-\mu_{0}%
\|^{2}</annotation><annotation encoding="application/x-llamapun" id="A1.E12X.3.2.2.m1.1d">= divide start_ARG 1 end_ARG start_ARG 2 italic_σ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG ∥ over^ start_ARG italic_μ end_ARG start_POSTSUPERSCRIPT italic_θ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT - italic_μ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ∥ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="4"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(12)</span></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="A1.E12Xa">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=~{}\frac{1}{2\sigma_{0}^{2}}\left\|\mathop{\mathbb{E}}\Big{[}%
\frac{\mathbf{x}_{t}-\sqrt{1-\alpha^{t}}\epsilon_{\theta}(\mathbf{x}_{t})}{%
\sqrt{\alpha^{t}}}\Big{]}-\mathop{\mathbb{E}}\Big{[}\frac{\mathbf{x}_{t}-\sqrt%
{1-\alpha^{t}}\epsilon}{\sqrt{\alpha^{t}}}\Big{]}\right\|^{2}" class="ltx_Math" display="inline" id="A1.E12Xa.2.1.1.m1.3"><semantics id="A1.E12Xa.2.1.1.m1.3a"><mrow id="A1.E12Xa.2.1.1.m1.3.3" xref="A1.E12Xa.2.1.1.m1.3.3.cmml"><mi id="A1.E12Xa.2.1.1.m1.3.3.3" xref="A1.E12Xa.2.1.1.m1.3.3.3.cmml"></mi><mo id="A1.E12Xa.2.1.1.m1.3.3.2" rspace="0.608em" xref="A1.E12Xa.2.1.1.m1.3.3.2.cmml">=</mo><mrow id="A1.E12Xa.2.1.1.m1.3.3.1" xref="A1.E12Xa.2.1.1.m1.3.3.1.cmml"><mstyle displaystyle="true" id="A1.E12Xa.2.1.1.m1.3.3.1.3" xref="A1.E12Xa.2.1.1.m1.3.3.1.3.cmml"><mfrac id="A1.E12Xa.2.1.1.m1.3.3.1.3a" xref="A1.E12Xa.2.1.1.m1.3.3.1.3.cmml"><mn id="A1.E12Xa.2.1.1.m1.3.3.1.3.2" xref="A1.E12Xa.2.1.1.m1.3.3.1.3.2.cmml">1</mn><mrow id="A1.E12Xa.2.1.1.m1.3.3.1.3.3" xref="A1.E12Xa.2.1.1.m1.3.3.1.3.3.cmml"><mn id="A1.E12Xa.2.1.1.m1.3.3.1.3.3.2" xref="A1.E12Xa.2.1.1.m1.3.3.1.3.3.2.cmml">2</mn><mo id="A1.E12Xa.2.1.1.m1.3.3.1.3.3.1" xref="A1.E12Xa.2.1.1.m1.3.3.1.3.3.1.cmml">⁢</mo><msubsup id="A1.E12Xa.2.1.1.m1.3.3.1.3.3.3" xref="A1.E12Xa.2.1.1.m1.3.3.1.3.3.3.cmml"><mi id="A1.E12Xa.2.1.1.m1.3.3.1.3.3.3.2.2" xref="A1.E12Xa.2.1.1.m1.3.3.1.3.3.3.2.2.cmml">σ</mi><mn id="A1.E12Xa.2.1.1.m1.3.3.1.3.3.3.2.3" xref="A1.E12Xa.2.1.1.m1.3.3.1.3.3.3.2.3.cmml">0</mn><mn id="A1.E12Xa.2.1.1.m1.3.3.1.3.3.3.3" xref="A1.E12Xa.2.1.1.m1.3.3.1.3.3.3.3.cmml">2</mn></msubsup></mrow></mfrac></mstyle><mo id="A1.E12Xa.2.1.1.m1.3.3.1.2" xref="A1.E12Xa.2.1.1.m1.3.3.1.2.cmml">⁢</mo><msup id="A1.E12Xa.2.1.1.m1.3.3.1.1" xref="A1.E12Xa.2.1.1.m1.3.3.1.1.cmml"><mrow id="A1.E12Xa.2.1.1.m1.3.3.1.1.1.1" xref="A1.E12Xa.2.1.1.m1.3.3.1.1.1.2.cmml"><mo id="A1.E12Xa.2.1.1.m1.3.3.1.1.1.1.2" xref="A1.E12Xa.2.1.1.m1.3.3.1.1.1.2.1.cmml">‖</mo><mrow id="A1.E12Xa.2.1.1.m1.3.3.1.1.1.1.1" xref="A1.E12Xa.2.1.1.m1.3.3.1.1.1.1.1.cmml"><mrow id="A1.E12Xa.2.1.1.m1.3.3.1.1.1.1.1.2" xref="A1.E12Xa.2.1.1.m1.3.3.1.1.1.1.1.2.cmml"><mo id="A1.E12Xa.2.1.1.m1.3.3.1.1.1.1.1.2.1" lspace="0em" movablelimits="false" rspace="0em" xref="A1.E12Xa.2.1.1.m1.3.3.1.1.1.1.1.2.1.cmml">𝔼</mo><mrow id="A1.E12Xa.2.1.1.m1.3.3.1.1.1.1.1.2.2.2" xref="A1.E12Xa.2.1.1.m1.3.3.1.1.1.1.1.2.2.1.cmml"><mo id="A1.E12Xa.2.1.1.m1.3.3.1.1.1.1.1.2.2.2.1" maxsize="160%" minsize="160%" xref="A1.E12Xa.2.1.1.m1.3.3.1.1.1.1.1.2.2.1.1.cmml">[</mo><mstyle displaystyle="true" id="A1.E12Xa.2.1.1.m1.1.1" xref="A1.E12Xa.2.1.1.m1.1.1.cmml"><mfrac id="A1.E12Xa.2.1.1.m1.1.1a" xref="A1.E12Xa.2.1.1.m1.1.1.cmml"><mrow id="A1.E12Xa.2.1.1.m1.1.1.1" xref="A1.E12Xa.2.1.1.m1.1.1.1.cmml"><msub id="A1.E12Xa.2.1.1.m1.1.1.1.3" xref="A1.E12Xa.2.1.1.m1.1.1.1.3.cmml"><mi id="A1.E12Xa.2.1.1.m1.1.1.1.3.2" xref="A1.E12Xa.2.1.1.m1.1.1.1.3.2.cmml">𝐱</mi><mi id="A1.E12Xa.2.1.1.m1.1.1.1.3.3" xref="A1.E12Xa.2.1.1.m1.1.1.1.3.3.cmml">t</mi></msub><mo id="A1.E12Xa.2.1.1.m1.1.1.1.2" xref="A1.E12Xa.2.1.1.m1.1.1.1.2.cmml">−</mo><mrow id="A1.E12Xa.2.1.1.m1.1.1.1.1" xref="A1.E12Xa.2.1.1.m1.1.1.1.1.cmml"><msqrt id="A1.E12Xa.2.1.1.m1.1.1.1.1.3" xref="A1.E12Xa.2.1.1.m1.1.1.1.1.3.cmml"><mrow id="A1.E12Xa.2.1.1.m1.1.1.1.1.3.2" xref="A1.E12Xa.2.1.1.m1.1.1.1.1.3.2.cmml"><mn id="A1.E12Xa.2.1.1.m1.1.1.1.1.3.2.2" xref="A1.E12Xa.2.1.1.m1.1.1.1.1.3.2.2.cmml">1</mn><mo id="A1.E12Xa.2.1.1.m1.1.1.1.1.3.2.1" xref="A1.E12Xa.2.1.1.m1.1.1.1.1.3.2.1.cmml">−</mo><msup id="A1.E12Xa.2.1.1.m1.1.1.1.1.3.2.3" xref="A1.E12Xa.2.1.1.m1.1.1.1.1.3.2.3.cmml"><mi id="A1.E12Xa.2.1.1.m1.1.1.1.1.3.2.3.2" xref="A1.E12Xa.2.1.1.m1.1.1.1.1.3.2.3.2.cmml">α</mi><mi id="A1.E12Xa.2.1.1.m1.1.1.1.1.3.2.3.3" xref="A1.E12Xa.2.1.1.m1.1.1.1.1.3.2.3.3.cmml">t</mi></msup></mrow></msqrt><mo id="A1.E12Xa.2.1.1.m1.1.1.1.1.2" xref="A1.E12Xa.2.1.1.m1.1.1.1.1.2.cmml">⁢</mo><msub id="A1.E12Xa.2.1.1.m1.1.1.1.1.4" xref="A1.E12Xa.2.1.1.m1.1.1.1.1.4.cmml"><mi id="A1.E12Xa.2.1.1.m1.1.1.1.1.4.2" xref="A1.E12Xa.2.1.1.m1.1.1.1.1.4.2.cmml">ϵ</mi><mi id="A1.E12Xa.2.1.1.m1.1.1.1.1.4.3" xref="A1.E12Xa.2.1.1.m1.1.1.1.1.4.3.cmml">θ</mi></msub><mo id="A1.E12Xa.2.1.1.m1.1.1.1.1.2a" xref="A1.E12Xa.2.1.1.m1.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.E12Xa.2.1.1.m1.1.1.1.1.1.1" xref="A1.E12Xa.2.1.1.m1.1.1.1.1.1.1.1.cmml"><mo id="A1.E12Xa.2.1.1.m1.1.1.1.1.1.1.2" stretchy="false" xref="A1.E12Xa.2.1.1.m1.1.1.1.1.1.1.1.cmml">(</mo><msub id="A1.E12Xa.2.1.1.m1.1.1.1.1.1.1.1" xref="A1.E12Xa.2.1.1.m1.1.1.1.1.1.1.1.cmml"><mi id="A1.E12Xa.2.1.1.m1.1.1.1.1.1.1.1.2" xref="A1.E12Xa.2.1.1.m1.1.1.1.1.1.1.1.2.cmml">𝐱</mi><mi id="A1.E12Xa.2.1.1.m1.1.1.1.1.1.1.1.3" xref="A1.E12Xa.2.1.1.m1.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="A1.E12Xa.2.1.1.m1.1.1.1.1.1.1.3" stretchy="false" xref="A1.E12Xa.2.1.1.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><msqrt id="A1.E12Xa.2.1.1.m1.1.1.3" xref="A1.E12Xa.2.1.1.m1.1.1.3.cmml"><msup id="A1.E12Xa.2.1.1.m1.1.1.3.2" xref="A1.E12Xa.2.1.1.m1.1.1.3.2.cmml"><mi id="A1.E12Xa.2.1.1.m1.1.1.3.2.2" xref="A1.E12Xa.2.1.1.m1.1.1.3.2.2.cmml">α</mi><mi id="A1.E12Xa.2.1.1.m1.1.1.3.2.3" xref="A1.E12Xa.2.1.1.m1.1.1.3.2.3.cmml">t</mi></msup></msqrt></mfrac></mstyle><mo id="A1.E12Xa.2.1.1.m1.3.3.1.1.1.1.1.2.2.2.2" maxsize="160%" minsize="160%" xref="A1.E12Xa.2.1.1.m1.3.3.1.1.1.1.1.2.2.1.1.cmml">]</mo></mrow></mrow><mo id="A1.E12Xa.2.1.1.m1.3.3.1.1.1.1.1.1" xref="A1.E12Xa.2.1.1.m1.3.3.1.1.1.1.1.1.cmml">−</mo><mrow id="A1.E12Xa.2.1.1.m1.3.3.1.1.1.1.1.3" xref="A1.E12Xa.2.1.1.m1.3.3.1.1.1.1.1.3.cmml"><mo id="A1.E12Xa.2.1.1.m1.3.3.1.1.1.1.1.3.1" lspace="0em" movablelimits="false" rspace="0em" xref="A1.E12Xa.2.1.1.m1.3.3.1.1.1.1.1.3.1.cmml">𝔼</mo><mrow id="A1.E12Xa.2.1.1.m1.3.3.1.1.1.1.1.3.2.2" xref="A1.E12Xa.2.1.1.m1.3.3.1.1.1.1.1.3.2.1.cmml"><mo id="A1.E12Xa.2.1.1.m1.3.3.1.1.1.1.1.3.2.2.1" maxsize="160%" minsize="160%" xref="A1.E12Xa.2.1.1.m1.3.3.1.1.1.1.1.3.2.1.1.cmml">[</mo><mstyle displaystyle="true" id="A1.E12Xa.2.1.1.m1.2.2" xref="A1.E12Xa.2.1.1.m1.2.2.cmml"><mfrac id="A1.E12Xa.2.1.1.m1.2.2a" xref="A1.E12Xa.2.1.1.m1.2.2.cmml"><mrow id="A1.E12Xa.2.1.1.m1.2.2.2" xref="A1.E12Xa.2.1.1.m1.2.2.2.cmml"><msub id="A1.E12Xa.2.1.1.m1.2.2.2.2" xref="A1.E12Xa.2.1.1.m1.2.2.2.2.cmml"><mi id="A1.E12Xa.2.1.1.m1.2.2.2.2.2" xref="A1.E12Xa.2.1.1.m1.2.2.2.2.2.cmml">𝐱</mi><mi id="A1.E12Xa.2.1.1.m1.2.2.2.2.3" xref="A1.E12Xa.2.1.1.m1.2.2.2.2.3.cmml">t</mi></msub><mo id="A1.E12Xa.2.1.1.m1.2.2.2.1" xref="A1.E12Xa.2.1.1.m1.2.2.2.1.cmml">−</mo><mrow id="A1.E12Xa.2.1.1.m1.2.2.2.3" xref="A1.E12Xa.2.1.1.m1.2.2.2.3.cmml"><msqrt id="A1.E12Xa.2.1.1.m1.2.2.2.3.2" xref="A1.E12Xa.2.1.1.m1.2.2.2.3.2.cmml"><mrow id="A1.E12Xa.2.1.1.m1.2.2.2.3.2.2" xref="A1.E12Xa.2.1.1.m1.2.2.2.3.2.2.cmml"><mn id="A1.E12Xa.2.1.1.m1.2.2.2.3.2.2.2" xref="A1.E12Xa.2.1.1.m1.2.2.2.3.2.2.2.cmml">1</mn><mo id="A1.E12Xa.2.1.1.m1.2.2.2.3.2.2.1" xref="A1.E12Xa.2.1.1.m1.2.2.2.3.2.2.1.cmml">−</mo><msup id="A1.E12Xa.2.1.1.m1.2.2.2.3.2.2.3" xref="A1.E12Xa.2.1.1.m1.2.2.2.3.2.2.3.cmml"><mi id="A1.E12Xa.2.1.1.m1.2.2.2.3.2.2.3.2" xref="A1.E12Xa.2.1.1.m1.2.2.2.3.2.2.3.2.cmml">α</mi><mi id="A1.E12Xa.2.1.1.m1.2.2.2.3.2.2.3.3" xref="A1.E12Xa.2.1.1.m1.2.2.2.3.2.2.3.3.cmml">t</mi></msup></mrow></msqrt><mo id="A1.E12Xa.2.1.1.m1.2.2.2.3.1" xref="A1.E12Xa.2.1.1.m1.2.2.2.3.1.cmml">⁢</mo><mi id="A1.E12Xa.2.1.1.m1.2.2.2.3.3" xref="A1.E12Xa.2.1.1.m1.2.2.2.3.3.cmml">ϵ</mi></mrow></mrow><msqrt id="A1.E12Xa.2.1.1.m1.2.2.3" xref="A1.E12Xa.2.1.1.m1.2.2.3.cmml"><msup id="A1.E12Xa.2.1.1.m1.2.2.3.2" xref="A1.E12Xa.2.1.1.m1.2.2.3.2.cmml"><mi id="A1.E12Xa.2.1.1.m1.2.2.3.2.2" xref="A1.E12Xa.2.1.1.m1.2.2.3.2.2.cmml">α</mi><mi id="A1.E12Xa.2.1.1.m1.2.2.3.2.3" xref="A1.E12Xa.2.1.1.m1.2.2.3.2.3.cmml">t</mi></msup></msqrt></mfrac></mstyle><mo id="A1.E12Xa.2.1.1.m1.3.3.1.1.1.1.1.3.2.2.2" maxsize="160%" minsize="160%" xref="A1.E12Xa.2.1.1.m1.3.3.1.1.1.1.1.3.2.1.1.cmml">]</mo></mrow></mrow></mrow><mo id="A1.E12Xa.2.1.1.m1.3.3.1.1.1.1.3" xref="A1.E12Xa.2.1.1.m1.3.3.1.1.1.2.1.cmml">‖</mo></mrow><mn id="A1.E12Xa.2.1.1.m1.3.3.1.1.3" xref="A1.E12Xa.2.1.1.m1.3.3.1.1.3.cmml">2</mn></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E12Xa.2.1.1.m1.3b"><apply id="A1.E12Xa.2.1.1.m1.3.3.cmml" xref="A1.E12Xa.2.1.1.m1.3.3"><eq id="A1.E12Xa.2.1.1.m1.3.3.2.cmml" xref="A1.E12Xa.2.1.1.m1.3.3.2"></eq><csymbol cd="latexml" id="A1.E12Xa.2.1.1.m1.3.3.3.cmml" xref="A1.E12Xa.2.1.1.m1.3.3.3">absent</csymbol><apply id="A1.E12Xa.2.1.1.m1.3.3.1.cmml" xref="A1.E12Xa.2.1.1.m1.3.3.1"><times id="A1.E12Xa.2.1.1.m1.3.3.1.2.cmml" xref="A1.E12Xa.2.1.1.m1.3.3.1.2"></times><apply id="A1.E12Xa.2.1.1.m1.3.3.1.3.cmml" xref="A1.E12Xa.2.1.1.m1.3.3.1.3"><divide id="A1.E12Xa.2.1.1.m1.3.3.1.3.1.cmml" xref="A1.E12Xa.2.1.1.m1.3.3.1.3"></divide><cn id="A1.E12Xa.2.1.1.m1.3.3.1.3.2.cmml" type="integer" xref="A1.E12Xa.2.1.1.m1.3.3.1.3.2">1</cn><apply id="A1.E12Xa.2.1.1.m1.3.3.1.3.3.cmml" xref="A1.E12Xa.2.1.1.m1.3.3.1.3.3"><times id="A1.E12Xa.2.1.1.m1.3.3.1.3.3.1.cmml" xref="A1.E12Xa.2.1.1.m1.3.3.1.3.3.1"></times><cn id="A1.E12Xa.2.1.1.m1.3.3.1.3.3.2.cmml" type="integer" xref="A1.E12Xa.2.1.1.m1.3.3.1.3.3.2">2</cn><apply id="A1.E12Xa.2.1.1.m1.3.3.1.3.3.3.cmml" xref="A1.E12Xa.2.1.1.m1.3.3.1.3.3.3"><csymbol cd="ambiguous" id="A1.E12Xa.2.1.1.m1.3.3.1.3.3.3.1.cmml" xref="A1.E12Xa.2.1.1.m1.3.3.1.3.3.3">superscript</csymbol><apply id="A1.E12Xa.2.1.1.m1.3.3.1.3.3.3.2.cmml" xref="A1.E12Xa.2.1.1.m1.3.3.1.3.3.3"><csymbol cd="ambiguous" id="A1.E12Xa.2.1.1.m1.3.3.1.3.3.3.2.1.cmml" xref="A1.E12Xa.2.1.1.m1.3.3.1.3.3.3">subscript</csymbol><ci id="A1.E12Xa.2.1.1.m1.3.3.1.3.3.3.2.2.cmml" xref="A1.E12Xa.2.1.1.m1.3.3.1.3.3.3.2.2">𝜎</ci><cn id="A1.E12Xa.2.1.1.m1.3.3.1.3.3.3.2.3.cmml" type="integer" xref="A1.E12Xa.2.1.1.m1.3.3.1.3.3.3.2.3">0</cn></apply><cn id="A1.E12Xa.2.1.1.m1.3.3.1.3.3.3.3.cmml" type="integer" xref="A1.E12Xa.2.1.1.m1.3.3.1.3.3.3.3">2</cn></apply></apply></apply><apply id="A1.E12Xa.2.1.1.m1.3.3.1.1.cmml" xref="A1.E12Xa.2.1.1.m1.3.3.1.1"><csymbol cd="ambiguous" id="A1.E12Xa.2.1.1.m1.3.3.1.1.2.cmml" xref="A1.E12Xa.2.1.1.m1.3.3.1.1">superscript</csymbol><apply id="A1.E12Xa.2.1.1.m1.3.3.1.1.1.2.cmml" xref="A1.E12Xa.2.1.1.m1.3.3.1.1.1.1"><csymbol cd="latexml" id="A1.E12Xa.2.1.1.m1.3.3.1.1.1.2.1.cmml" xref="A1.E12Xa.2.1.1.m1.3.3.1.1.1.1.2">norm</csymbol><apply id="A1.E12Xa.2.1.1.m1.3.3.1.1.1.1.1.cmml" xref="A1.E12Xa.2.1.1.m1.3.3.1.1.1.1.1"><minus id="A1.E12Xa.2.1.1.m1.3.3.1.1.1.1.1.1.cmml" xref="A1.E12Xa.2.1.1.m1.3.3.1.1.1.1.1.1"></minus><apply id="A1.E12Xa.2.1.1.m1.3.3.1.1.1.1.1.2.cmml" xref="A1.E12Xa.2.1.1.m1.3.3.1.1.1.1.1.2"><ci id="A1.E12Xa.2.1.1.m1.3.3.1.1.1.1.1.2.1.cmml" xref="A1.E12Xa.2.1.1.m1.3.3.1.1.1.1.1.2.1">𝔼</ci><apply id="A1.E12Xa.2.1.1.m1.3.3.1.1.1.1.1.2.2.1.cmml" xref="A1.E12Xa.2.1.1.m1.3.3.1.1.1.1.1.2.2.2"><csymbol cd="latexml" id="A1.E12Xa.2.1.1.m1.3.3.1.1.1.1.1.2.2.1.1.cmml" xref="A1.E12Xa.2.1.1.m1.3.3.1.1.1.1.1.2.2.2.1">delimited-[]</csymbol><apply id="A1.E12Xa.2.1.1.m1.1.1.cmml" xref="A1.E12Xa.2.1.1.m1.1.1"><divide id="A1.E12Xa.2.1.1.m1.1.1.2.cmml" xref="A1.E12Xa.2.1.1.m1.1.1"></divide><apply id="A1.E12Xa.2.1.1.m1.1.1.1.cmml" xref="A1.E12Xa.2.1.1.m1.1.1.1"><minus id="A1.E12Xa.2.1.1.m1.1.1.1.2.cmml" xref="A1.E12Xa.2.1.1.m1.1.1.1.2"></minus><apply id="A1.E12Xa.2.1.1.m1.1.1.1.3.cmml" xref="A1.E12Xa.2.1.1.m1.1.1.1.3"><csymbol cd="ambiguous" id="A1.E12Xa.2.1.1.m1.1.1.1.3.1.cmml" xref="A1.E12Xa.2.1.1.m1.1.1.1.3">subscript</csymbol><ci id="A1.E12Xa.2.1.1.m1.1.1.1.3.2.cmml" xref="A1.E12Xa.2.1.1.m1.1.1.1.3.2">𝐱</ci><ci id="A1.E12Xa.2.1.1.m1.1.1.1.3.3.cmml" xref="A1.E12Xa.2.1.1.m1.1.1.1.3.3">𝑡</ci></apply><apply id="A1.E12Xa.2.1.1.m1.1.1.1.1.cmml" xref="A1.E12Xa.2.1.1.m1.1.1.1.1"><times id="A1.E12Xa.2.1.1.m1.1.1.1.1.2.cmml" xref="A1.E12Xa.2.1.1.m1.1.1.1.1.2"></times><apply id="A1.E12Xa.2.1.1.m1.1.1.1.1.3.cmml" xref="A1.E12Xa.2.1.1.m1.1.1.1.1.3"><root id="A1.E12Xa.2.1.1.m1.1.1.1.1.3a.cmml" xref="A1.E12Xa.2.1.1.m1.1.1.1.1.3"></root><apply id="A1.E12Xa.2.1.1.m1.1.1.1.1.3.2.cmml" xref="A1.E12Xa.2.1.1.m1.1.1.1.1.3.2"><minus id="A1.E12Xa.2.1.1.m1.1.1.1.1.3.2.1.cmml" xref="A1.E12Xa.2.1.1.m1.1.1.1.1.3.2.1"></minus><cn id="A1.E12Xa.2.1.1.m1.1.1.1.1.3.2.2.cmml" type="integer" xref="A1.E12Xa.2.1.1.m1.1.1.1.1.3.2.2">1</cn><apply id="A1.E12Xa.2.1.1.m1.1.1.1.1.3.2.3.cmml" xref="A1.E12Xa.2.1.1.m1.1.1.1.1.3.2.3"><csymbol cd="ambiguous" id="A1.E12Xa.2.1.1.m1.1.1.1.1.3.2.3.1.cmml" xref="A1.E12Xa.2.1.1.m1.1.1.1.1.3.2.3">superscript</csymbol><ci id="A1.E12Xa.2.1.1.m1.1.1.1.1.3.2.3.2.cmml" xref="A1.E12Xa.2.1.1.m1.1.1.1.1.3.2.3.2">𝛼</ci><ci id="A1.E12Xa.2.1.1.m1.1.1.1.1.3.2.3.3.cmml" xref="A1.E12Xa.2.1.1.m1.1.1.1.1.3.2.3.3">𝑡</ci></apply></apply></apply><apply id="A1.E12Xa.2.1.1.m1.1.1.1.1.4.cmml" xref="A1.E12Xa.2.1.1.m1.1.1.1.1.4"><csymbol cd="ambiguous" id="A1.E12Xa.2.1.1.m1.1.1.1.1.4.1.cmml" xref="A1.E12Xa.2.1.1.m1.1.1.1.1.4">subscript</csymbol><ci id="A1.E12Xa.2.1.1.m1.1.1.1.1.4.2.cmml" xref="A1.E12Xa.2.1.1.m1.1.1.1.1.4.2">italic-ϵ</ci><ci id="A1.E12Xa.2.1.1.m1.1.1.1.1.4.3.cmml" xref="A1.E12Xa.2.1.1.m1.1.1.1.1.4.3">𝜃</ci></apply><apply id="A1.E12Xa.2.1.1.m1.1.1.1.1.1.1.1.cmml" xref="A1.E12Xa.2.1.1.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E12Xa.2.1.1.m1.1.1.1.1.1.1.1.1.cmml" xref="A1.E12Xa.2.1.1.m1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.E12Xa.2.1.1.m1.1.1.1.1.1.1.1.2.cmml" xref="A1.E12Xa.2.1.1.m1.1.1.1.1.1.1.1.2">𝐱</ci><ci id="A1.E12Xa.2.1.1.m1.1.1.1.1.1.1.1.3.cmml" xref="A1.E12Xa.2.1.1.m1.1.1.1.1.1.1.1.3">𝑡</ci></apply></apply></apply><apply id="A1.E12Xa.2.1.1.m1.1.1.3.cmml" xref="A1.E12Xa.2.1.1.m1.1.1.3"><root id="A1.E12Xa.2.1.1.m1.1.1.3a.cmml" xref="A1.E12Xa.2.1.1.m1.1.1.3"></root><apply id="A1.E12Xa.2.1.1.m1.1.1.3.2.cmml" xref="A1.E12Xa.2.1.1.m1.1.1.3.2"><csymbol cd="ambiguous" id="A1.E12Xa.2.1.1.m1.1.1.3.2.1.cmml" xref="A1.E12Xa.2.1.1.m1.1.1.3.2">superscript</csymbol><ci id="A1.E12Xa.2.1.1.m1.1.1.3.2.2.cmml" xref="A1.E12Xa.2.1.1.m1.1.1.3.2.2">𝛼</ci><ci id="A1.E12Xa.2.1.1.m1.1.1.3.2.3.cmml" xref="A1.E12Xa.2.1.1.m1.1.1.3.2.3">𝑡</ci></apply></apply></apply></apply></apply><apply id="A1.E12Xa.2.1.1.m1.3.3.1.1.1.1.1.3.cmml" xref="A1.E12Xa.2.1.1.m1.3.3.1.1.1.1.1.3"><ci id="A1.E12Xa.2.1.1.m1.3.3.1.1.1.1.1.3.1.cmml" xref="A1.E12Xa.2.1.1.m1.3.3.1.1.1.1.1.3.1">𝔼</ci><apply id="A1.E12Xa.2.1.1.m1.3.3.1.1.1.1.1.3.2.1.cmml" xref="A1.E12Xa.2.1.1.m1.3.3.1.1.1.1.1.3.2.2"><csymbol cd="latexml" id="A1.E12Xa.2.1.1.m1.3.3.1.1.1.1.1.3.2.1.1.cmml" xref="A1.E12Xa.2.1.1.m1.3.3.1.1.1.1.1.3.2.2.1">delimited-[]</csymbol><apply id="A1.E12Xa.2.1.1.m1.2.2.cmml" xref="A1.E12Xa.2.1.1.m1.2.2"><divide id="A1.E12Xa.2.1.1.m1.2.2.1.cmml" xref="A1.E12Xa.2.1.1.m1.2.2"></divide><apply id="A1.E12Xa.2.1.1.m1.2.2.2.cmml" xref="A1.E12Xa.2.1.1.m1.2.2.2"><minus id="A1.E12Xa.2.1.1.m1.2.2.2.1.cmml" xref="A1.E12Xa.2.1.1.m1.2.2.2.1"></minus><apply id="A1.E12Xa.2.1.1.m1.2.2.2.2.cmml" xref="A1.E12Xa.2.1.1.m1.2.2.2.2"><csymbol cd="ambiguous" id="A1.E12Xa.2.1.1.m1.2.2.2.2.1.cmml" xref="A1.E12Xa.2.1.1.m1.2.2.2.2">subscript</csymbol><ci id="A1.E12Xa.2.1.1.m1.2.2.2.2.2.cmml" xref="A1.E12Xa.2.1.1.m1.2.2.2.2.2">𝐱</ci><ci id="A1.E12Xa.2.1.1.m1.2.2.2.2.3.cmml" xref="A1.E12Xa.2.1.1.m1.2.2.2.2.3">𝑡</ci></apply><apply id="A1.E12Xa.2.1.1.m1.2.2.2.3.cmml" xref="A1.E12Xa.2.1.1.m1.2.2.2.3"><times id="A1.E12Xa.2.1.1.m1.2.2.2.3.1.cmml" xref="A1.E12Xa.2.1.1.m1.2.2.2.3.1"></times><apply id="A1.E12Xa.2.1.1.m1.2.2.2.3.2.cmml" xref="A1.E12Xa.2.1.1.m1.2.2.2.3.2"><root id="A1.E12Xa.2.1.1.m1.2.2.2.3.2a.cmml" xref="A1.E12Xa.2.1.1.m1.2.2.2.3.2"></root><apply id="A1.E12Xa.2.1.1.m1.2.2.2.3.2.2.cmml" xref="A1.E12Xa.2.1.1.m1.2.2.2.3.2.2"><minus id="A1.E12Xa.2.1.1.m1.2.2.2.3.2.2.1.cmml" xref="A1.E12Xa.2.1.1.m1.2.2.2.3.2.2.1"></minus><cn id="A1.E12Xa.2.1.1.m1.2.2.2.3.2.2.2.cmml" type="integer" xref="A1.E12Xa.2.1.1.m1.2.2.2.3.2.2.2">1</cn><apply id="A1.E12Xa.2.1.1.m1.2.2.2.3.2.2.3.cmml" xref="A1.E12Xa.2.1.1.m1.2.2.2.3.2.2.3"><csymbol cd="ambiguous" id="A1.E12Xa.2.1.1.m1.2.2.2.3.2.2.3.1.cmml" xref="A1.E12Xa.2.1.1.m1.2.2.2.3.2.2.3">superscript</csymbol><ci id="A1.E12Xa.2.1.1.m1.2.2.2.3.2.2.3.2.cmml" xref="A1.E12Xa.2.1.1.m1.2.2.2.3.2.2.3.2">𝛼</ci><ci id="A1.E12Xa.2.1.1.m1.2.2.2.3.2.2.3.3.cmml" xref="A1.E12Xa.2.1.1.m1.2.2.2.3.2.2.3.3">𝑡</ci></apply></apply></apply><ci id="A1.E12Xa.2.1.1.m1.2.2.2.3.3.cmml" xref="A1.E12Xa.2.1.1.m1.2.2.2.3.3">italic-ϵ</ci></apply></apply><apply id="A1.E12Xa.2.1.1.m1.2.2.3.cmml" xref="A1.E12Xa.2.1.1.m1.2.2.3"><root id="A1.E12Xa.2.1.1.m1.2.2.3a.cmml" xref="A1.E12Xa.2.1.1.m1.2.2.3"></root><apply id="A1.E12Xa.2.1.1.m1.2.2.3.2.cmml" xref="A1.E12Xa.2.1.1.m1.2.2.3.2"><csymbol cd="ambiguous" id="A1.E12Xa.2.1.1.m1.2.2.3.2.1.cmml" xref="A1.E12Xa.2.1.1.m1.2.2.3.2">superscript</csymbol><ci id="A1.E12Xa.2.1.1.m1.2.2.3.2.2.cmml" xref="A1.E12Xa.2.1.1.m1.2.2.3.2.2">𝛼</ci><ci id="A1.E12Xa.2.1.1.m1.2.2.3.2.3.cmml" xref="A1.E12Xa.2.1.1.m1.2.2.3.2.3">𝑡</ci></apply></apply></apply></apply></apply></apply></apply><cn id="A1.E12Xa.2.1.1.m1.3.3.1.1.3.cmml" type="integer" xref="A1.E12Xa.2.1.1.m1.3.3.1.1.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E12Xa.2.1.1.m1.3c">\displaystyle=~{}\frac{1}{2\sigma_{0}^{2}}\left\|\mathop{\mathbb{E}}\Big{[}%
\frac{\mathbf{x}_{t}-\sqrt{1-\alpha^{t}}\epsilon_{\theta}(\mathbf{x}_{t})}{%
\sqrt{\alpha^{t}}}\Big{]}-\mathop{\mathbb{E}}\Big{[}\frac{\mathbf{x}_{t}-\sqrt%
{1-\alpha^{t}}\epsilon}{\sqrt{\alpha^{t}}}\Big{]}\right\|^{2}</annotation><annotation encoding="application/x-llamapun" id="A1.E12Xa.2.1.1.m1.3d">= divide start_ARG 1 end_ARG start_ARG 2 italic_σ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG ∥ blackboard_E [ divide start_ARG bold_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT - square-root start_ARG 1 - italic_α start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT end_ARG italic_ϵ start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( bold_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) end_ARG start_ARG square-root start_ARG italic_α start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT end_ARG end_ARG ] - blackboard_E [ divide start_ARG bold_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT - square-root start_ARG 1 - italic_α start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT end_ARG italic_ϵ end_ARG start_ARG square-root start_ARG italic_α start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT end_ARG end_ARG ] ∥ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="A1.E12Xb">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=~{}\frac{1-\alpha^{t}}{2\sigma_{0}^{2}\alpha^{t}}\left\|\mathop{%
\mathbb{E}}\Big{[}\epsilon_{\theta}(\mathbf{x}_{t})\Big{]}-\mathop{\mathbb{E}}%
[\mathbf{\epsilon}]\right\|^{2}" class="ltx_Math" display="inline" id="A1.E12Xb.2.1.1.m1.2"><semantics id="A1.E12Xb.2.1.1.m1.2a"><mrow id="A1.E12Xb.2.1.1.m1.2.2" xref="A1.E12Xb.2.1.1.m1.2.2.cmml"><mi id="A1.E12Xb.2.1.1.m1.2.2.3" xref="A1.E12Xb.2.1.1.m1.2.2.3.cmml"></mi><mo id="A1.E12Xb.2.1.1.m1.2.2.2" rspace="0.608em" xref="A1.E12Xb.2.1.1.m1.2.2.2.cmml">=</mo><mrow id="A1.E12Xb.2.1.1.m1.2.2.1" xref="A1.E12Xb.2.1.1.m1.2.2.1.cmml"><mstyle displaystyle="true" id="A1.E12Xb.2.1.1.m1.2.2.1.3" xref="A1.E12Xb.2.1.1.m1.2.2.1.3.cmml"><mfrac id="A1.E12Xb.2.1.1.m1.2.2.1.3a" xref="A1.E12Xb.2.1.1.m1.2.2.1.3.cmml"><mrow id="A1.E12Xb.2.1.1.m1.2.2.1.3.2" xref="A1.E12Xb.2.1.1.m1.2.2.1.3.2.cmml"><mn id="A1.E12Xb.2.1.1.m1.2.2.1.3.2.2" xref="A1.E12Xb.2.1.1.m1.2.2.1.3.2.2.cmml">1</mn><mo id="A1.E12Xb.2.1.1.m1.2.2.1.3.2.1" xref="A1.E12Xb.2.1.1.m1.2.2.1.3.2.1.cmml">−</mo><msup id="A1.E12Xb.2.1.1.m1.2.2.1.3.2.3" xref="A1.E12Xb.2.1.1.m1.2.2.1.3.2.3.cmml"><mi id="A1.E12Xb.2.1.1.m1.2.2.1.3.2.3.2" xref="A1.E12Xb.2.1.1.m1.2.2.1.3.2.3.2.cmml">α</mi><mi id="A1.E12Xb.2.1.1.m1.2.2.1.3.2.3.3" xref="A1.E12Xb.2.1.1.m1.2.2.1.3.2.3.3.cmml">t</mi></msup></mrow><mrow id="A1.E12Xb.2.1.1.m1.2.2.1.3.3" xref="A1.E12Xb.2.1.1.m1.2.2.1.3.3.cmml"><mn id="A1.E12Xb.2.1.1.m1.2.2.1.3.3.2" xref="A1.E12Xb.2.1.1.m1.2.2.1.3.3.2.cmml">2</mn><mo id="A1.E12Xb.2.1.1.m1.2.2.1.3.3.1" xref="A1.E12Xb.2.1.1.m1.2.2.1.3.3.1.cmml">⁢</mo><msubsup id="A1.E12Xb.2.1.1.m1.2.2.1.3.3.3" xref="A1.E12Xb.2.1.1.m1.2.2.1.3.3.3.cmml"><mi id="A1.E12Xb.2.1.1.m1.2.2.1.3.3.3.2.2" xref="A1.E12Xb.2.1.1.m1.2.2.1.3.3.3.2.2.cmml">σ</mi><mn id="A1.E12Xb.2.1.1.m1.2.2.1.3.3.3.2.3" xref="A1.E12Xb.2.1.1.m1.2.2.1.3.3.3.2.3.cmml">0</mn><mn id="A1.E12Xb.2.1.1.m1.2.2.1.3.3.3.3" xref="A1.E12Xb.2.1.1.m1.2.2.1.3.3.3.3.cmml">2</mn></msubsup><mo id="A1.E12Xb.2.1.1.m1.2.2.1.3.3.1a" xref="A1.E12Xb.2.1.1.m1.2.2.1.3.3.1.cmml">⁢</mo><msup id="A1.E12Xb.2.1.1.m1.2.2.1.3.3.4" xref="A1.E12Xb.2.1.1.m1.2.2.1.3.3.4.cmml"><mi id="A1.E12Xb.2.1.1.m1.2.2.1.3.3.4.2" xref="A1.E12Xb.2.1.1.m1.2.2.1.3.3.4.2.cmml">α</mi><mi id="A1.E12Xb.2.1.1.m1.2.2.1.3.3.4.3" xref="A1.E12Xb.2.1.1.m1.2.2.1.3.3.4.3.cmml">t</mi></msup></mrow></mfrac></mstyle><mo id="A1.E12Xb.2.1.1.m1.2.2.1.2" xref="A1.E12Xb.2.1.1.m1.2.2.1.2.cmml">⁢</mo><msup id="A1.E12Xb.2.1.1.m1.2.2.1.1" xref="A1.E12Xb.2.1.1.m1.2.2.1.1.cmml"><mrow id="A1.E12Xb.2.1.1.m1.2.2.1.1.1.1" xref="A1.E12Xb.2.1.1.m1.2.2.1.1.1.2.cmml"><mo id="A1.E12Xb.2.1.1.m1.2.2.1.1.1.1.2" xref="A1.E12Xb.2.1.1.m1.2.2.1.1.1.2.1.cmml">‖</mo><mrow id="A1.E12Xb.2.1.1.m1.2.2.1.1.1.1.1" xref="A1.E12Xb.2.1.1.m1.2.2.1.1.1.1.1.cmml"><mrow id="A1.E12Xb.2.1.1.m1.2.2.1.1.1.1.1.1" xref="A1.E12Xb.2.1.1.m1.2.2.1.1.1.1.1.1.cmml"><mo id="A1.E12Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2" lspace="0em" movablelimits="false" rspace="0em" xref="A1.E12Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.cmml">𝔼</mo><mrow id="A1.E12Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1" xref="A1.E12Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.cmml"><mo id="A1.E12Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.2" maxsize="160%" minsize="160%" xref="A1.E12Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.1.cmml">[</mo><mrow id="A1.E12Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1" xref="A1.E12Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.cmml"><msub id="A1.E12Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.3" xref="A1.E12Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="A1.E12Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.3.2" xref="A1.E12Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.3.2.cmml">ϵ</mi><mi id="A1.E12Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.3.3" xref="A1.E12Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.3.3.cmml">θ</mi></msub><mo id="A1.E12Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.2" xref="A1.E12Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.E12Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1" xref="A1.E12Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="A1.E12Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="A1.E12Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="A1.E12Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1" xref="A1.E12Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="A1.E12Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="A1.E12Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">𝐱</mi><mi id="A1.E12Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="A1.E12Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="A1.E12Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="A1.E12Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E12Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3" maxsize="160%" minsize="160%" xref="A1.E12Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="A1.E12Xb.2.1.1.m1.2.2.1.1.1.1.1.2" xref="A1.E12Xb.2.1.1.m1.2.2.1.1.1.1.1.2.cmml">−</mo><mrow id="A1.E12Xb.2.1.1.m1.2.2.1.1.1.1.1.3" xref="A1.E12Xb.2.1.1.m1.2.2.1.1.1.1.1.3.cmml"><mo id="A1.E12Xb.2.1.1.m1.2.2.1.1.1.1.1.3.1" lspace="0em" movablelimits="false" rspace="0em" xref="A1.E12Xb.2.1.1.m1.2.2.1.1.1.1.1.3.1.cmml">𝔼</mo><mrow id="A1.E12Xb.2.1.1.m1.2.2.1.1.1.1.1.3.2.2" xref="A1.E12Xb.2.1.1.m1.2.2.1.1.1.1.1.3.2.1.cmml"><mo id="A1.E12Xb.2.1.1.m1.2.2.1.1.1.1.1.3.2.2.1" stretchy="false" xref="A1.E12Xb.2.1.1.m1.2.2.1.1.1.1.1.3.2.1.1.cmml">[</mo><mi id="A1.E12Xb.2.1.1.m1.1.1" xref="A1.E12Xb.2.1.1.m1.1.1.cmml">ϵ</mi><mo id="A1.E12Xb.2.1.1.m1.2.2.1.1.1.1.1.3.2.2.2" stretchy="false" xref="A1.E12Xb.2.1.1.m1.2.2.1.1.1.1.1.3.2.1.1.cmml">]</mo></mrow></mrow></mrow><mo id="A1.E12Xb.2.1.1.m1.2.2.1.1.1.1.3" xref="A1.E12Xb.2.1.1.m1.2.2.1.1.1.2.1.cmml">‖</mo></mrow><mn id="A1.E12Xb.2.1.1.m1.2.2.1.1.3" xref="A1.E12Xb.2.1.1.m1.2.2.1.1.3.cmml">2</mn></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E12Xb.2.1.1.m1.2b"><apply id="A1.E12Xb.2.1.1.m1.2.2.cmml" xref="A1.E12Xb.2.1.1.m1.2.2"><eq id="A1.E12Xb.2.1.1.m1.2.2.2.cmml" xref="A1.E12Xb.2.1.1.m1.2.2.2"></eq><csymbol cd="latexml" id="A1.E12Xb.2.1.1.m1.2.2.3.cmml" xref="A1.E12Xb.2.1.1.m1.2.2.3">absent</csymbol><apply id="A1.E12Xb.2.1.1.m1.2.2.1.cmml" xref="A1.E12Xb.2.1.1.m1.2.2.1"><times id="A1.E12Xb.2.1.1.m1.2.2.1.2.cmml" xref="A1.E12Xb.2.1.1.m1.2.2.1.2"></times><apply id="A1.E12Xb.2.1.1.m1.2.2.1.3.cmml" xref="A1.E12Xb.2.1.1.m1.2.2.1.3"><divide id="A1.E12Xb.2.1.1.m1.2.2.1.3.1.cmml" xref="A1.E12Xb.2.1.1.m1.2.2.1.3"></divide><apply id="A1.E12Xb.2.1.1.m1.2.2.1.3.2.cmml" xref="A1.E12Xb.2.1.1.m1.2.2.1.3.2"><minus id="A1.E12Xb.2.1.1.m1.2.2.1.3.2.1.cmml" xref="A1.E12Xb.2.1.1.m1.2.2.1.3.2.1"></minus><cn id="A1.E12Xb.2.1.1.m1.2.2.1.3.2.2.cmml" type="integer" xref="A1.E12Xb.2.1.1.m1.2.2.1.3.2.2">1</cn><apply id="A1.E12Xb.2.1.1.m1.2.2.1.3.2.3.cmml" xref="A1.E12Xb.2.1.1.m1.2.2.1.3.2.3"><csymbol cd="ambiguous" id="A1.E12Xb.2.1.1.m1.2.2.1.3.2.3.1.cmml" xref="A1.E12Xb.2.1.1.m1.2.2.1.3.2.3">superscript</csymbol><ci id="A1.E12Xb.2.1.1.m1.2.2.1.3.2.3.2.cmml" xref="A1.E12Xb.2.1.1.m1.2.2.1.3.2.3.2">𝛼</ci><ci id="A1.E12Xb.2.1.1.m1.2.2.1.3.2.3.3.cmml" xref="A1.E12Xb.2.1.1.m1.2.2.1.3.2.3.3">𝑡</ci></apply></apply><apply id="A1.E12Xb.2.1.1.m1.2.2.1.3.3.cmml" xref="A1.E12Xb.2.1.1.m1.2.2.1.3.3"><times id="A1.E12Xb.2.1.1.m1.2.2.1.3.3.1.cmml" xref="A1.E12Xb.2.1.1.m1.2.2.1.3.3.1"></times><cn id="A1.E12Xb.2.1.1.m1.2.2.1.3.3.2.cmml" type="integer" xref="A1.E12Xb.2.1.1.m1.2.2.1.3.3.2">2</cn><apply id="A1.E12Xb.2.1.1.m1.2.2.1.3.3.3.cmml" xref="A1.E12Xb.2.1.1.m1.2.2.1.3.3.3"><csymbol cd="ambiguous" id="A1.E12Xb.2.1.1.m1.2.2.1.3.3.3.1.cmml" xref="A1.E12Xb.2.1.1.m1.2.2.1.3.3.3">superscript</csymbol><apply id="A1.E12Xb.2.1.1.m1.2.2.1.3.3.3.2.cmml" xref="A1.E12Xb.2.1.1.m1.2.2.1.3.3.3"><csymbol cd="ambiguous" id="A1.E12Xb.2.1.1.m1.2.2.1.3.3.3.2.1.cmml" xref="A1.E12Xb.2.1.1.m1.2.2.1.3.3.3">subscript</csymbol><ci id="A1.E12Xb.2.1.1.m1.2.2.1.3.3.3.2.2.cmml" xref="A1.E12Xb.2.1.1.m1.2.2.1.3.3.3.2.2">𝜎</ci><cn id="A1.E12Xb.2.1.1.m1.2.2.1.3.3.3.2.3.cmml" type="integer" xref="A1.E12Xb.2.1.1.m1.2.2.1.3.3.3.2.3">0</cn></apply><cn id="A1.E12Xb.2.1.1.m1.2.2.1.3.3.3.3.cmml" type="integer" xref="A1.E12Xb.2.1.1.m1.2.2.1.3.3.3.3">2</cn></apply><apply id="A1.E12Xb.2.1.1.m1.2.2.1.3.3.4.cmml" xref="A1.E12Xb.2.1.1.m1.2.2.1.3.3.4"><csymbol cd="ambiguous" id="A1.E12Xb.2.1.1.m1.2.2.1.3.3.4.1.cmml" xref="A1.E12Xb.2.1.1.m1.2.2.1.3.3.4">superscript</csymbol><ci id="A1.E12Xb.2.1.1.m1.2.2.1.3.3.4.2.cmml" xref="A1.E12Xb.2.1.1.m1.2.2.1.3.3.4.2">𝛼</ci><ci id="A1.E12Xb.2.1.1.m1.2.2.1.3.3.4.3.cmml" xref="A1.E12Xb.2.1.1.m1.2.2.1.3.3.4.3">𝑡</ci></apply></apply></apply><apply id="A1.E12Xb.2.1.1.m1.2.2.1.1.cmml" xref="A1.E12Xb.2.1.1.m1.2.2.1.1"><csymbol cd="ambiguous" id="A1.E12Xb.2.1.1.m1.2.2.1.1.2.cmml" xref="A1.E12Xb.2.1.1.m1.2.2.1.1">superscript</csymbol><apply id="A1.E12Xb.2.1.1.m1.2.2.1.1.1.2.cmml" xref="A1.E12Xb.2.1.1.m1.2.2.1.1.1.1"><csymbol cd="latexml" id="A1.E12Xb.2.1.1.m1.2.2.1.1.1.2.1.cmml" xref="A1.E12Xb.2.1.1.m1.2.2.1.1.1.1.2">norm</csymbol><apply id="A1.E12Xb.2.1.1.m1.2.2.1.1.1.1.1.cmml" xref="A1.E12Xb.2.1.1.m1.2.2.1.1.1.1.1"><minus id="A1.E12Xb.2.1.1.m1.2.2.1.1.1.1.1.2.cmml" xref="A1.E12Xb.2.1.1.m1.2.2.1.1.1.1.1.2"></minus><apply id="A1.E12Xb.2.1.1.m1.2.2.1.1.1.1.1.1.cmml" xref="A1.E12Xb.2.1.1.m1.2.2.1.1.1.1.1.1"><ci id="A1.E12Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.cmml" xref="A1.E12Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2">𝔼</ci><apply id="A1.E12Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="A1.E12Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="A1.E12Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.1.cmml" xref="A1.E12Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="A1.E12Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E12Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1"><times id="A1.E12Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E12Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.2"></times><apply id="A1.E12Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.E12Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.E12Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="A1.E12Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="A1.E12Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="A1.E12Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.3.2">italic-ϵ</ci><ci id="A1.E12Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="A1.E12Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.3.3">𝜃</ci></apply><apply id="A1.E12Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E12Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E12Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E12Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.E12Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E12Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2">𝐱</ci><ci id="A1.E12Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.E12Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑡</ci></apply></apply></apply></apply><apply id="A1.E12Xb.2.1.1.m1.2.2.1.1.1.1.1.3.cmml" xref="A1.E12Xb.2.1.1.m1.2.2.1.1.1.1.1.3"><ci id="A1.E12Xb.2.1.1.m1.2.2.1.1.1.1.1.3.1.cmml" xref="A1.E12Xb.2.1.1.m1.2.2.1.1.1.1.1.3.1">𝔼</ci><apply id="A1.E12Xb.2.1.1.m1.2.2.1.1.1.1.1.3.2.1.cmml" xref="A1.E12Xb.2.1.1.m1.2.2.1.1.1.1.1.3.2.2"><csymbol cd="latexml" id="A1.E12Xb.2.1.1.m1.2.2.1.1.1.1.1.3.2.1.1.cmml" xref="A1.E12Xb.2.1.1.m1.2.2.1.1.1.1.1.3.2.2.1">delimited-[]</csymbol><ci id="A1.E12Xb.2.1.1.m1.1.1.cmml" xref="A1.E12Xb.2.1.1.m1.1.1">italic-ϵ</ci></apply></apply></apply></apply><cn id="A1.E12Xb.2.1.1.m1.2.2.1.1.3.cmml" type="integer" xref="A1.E12Xb.2.1.1.m1.2.2.1.1.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E12Xb.2.1.1.m1.2c">\displaystyle=~{}\frac{1-\alpha^{t}}{2\sigma_{0}^{2}\alpha^{t}}\left\|\mathop{%
\mathbb{E}}\Big{[}\epsilon_{\theta}(\mathbf{x}_{t})\Big{]}-\mathop{\mathbb{E}}%
[\mathbf{\epsilon}]\right\|^{2}</annotation><annotation encoding="application/x-llamapun" id="A1.E12Xb.2.1.1.m1.2d">= divide start_ARG 1 - italic_α start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT end_ARG start_ARG 2 italic_σ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT italic_α start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT end_ARG ∥ blackboard_E [ italic_ϵ start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( bold_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) ] - blackboard_E [ italic_ϵ ] ∥ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="A1.E12Xc">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=~{}\frac{1-\alpha^{t}}{2\sigma_{0}^{2}\alpha^{t}}\mathop{\mathbb%
{E}}\Big{[}\left\|\epsilon_{\theta}(\mathbf{x}_{t})-\mathbf{\epsilon}\right\|^%
{2}\Big{]}-\frac{1-\alpha^{t}}{2\sigma_{0}^{2}\alpha^{t}}." class="ltx_Math" display="inline" id="A1.E12Xc.2.1.1.m1.1"><semantics id="A1.E12Xc.2.1.1.m1.1a"><mrow id="A1.E12Xc.2.1.1.m1.1.1.1" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.cmml"><mrow id="A1.E12Xc.2.1.1.m1.1.1.1.1" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.cmml"><mi id="A1.E12Xc.2.1.1.m1.1.1.1.1.3" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.3.cmml"></mi><mo id="A1.E12Xc.2.1.1.m1.1.1.1.1.2" rspace="0.608em" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.2.cmml">=</mo><mrow id="A1.E12Xc.2.1.1.m1.1.1.1.1.1" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.1.cmml"><mrow id="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.3" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.3.cmml"><mfrac id="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.3a" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.3.cmml"><mrow id="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.3.2" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.3.2.cmml"><mn id="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.3.2.2" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.3.2.2.cmml">1</mn><mo id="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.3.2.1" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.3.2.1.cmml">−</mo><msup id="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.3.2.3" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.3.2.3.cmml"><mi id="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.3.2.3.2" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.3.2.3.2.cmml">α</mi><mi id="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.3.2.3.3" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.3.2.3.3.cmml">t</mi></msup></mrow><mrow id="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.3.3" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.3.3.cmml"><mn id="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.3.3.2" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.3.3.2.cmml">2</mn><mo id="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.3.3.1" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.3.3.1.cmml">⁢</mo><msubsup id="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.3.3.3" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.3.3.3.cmml"><mi id="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.3.3.3.2.2" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.3.3.3.2.2.cmml">σ</mi><mn id="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.3.3.3.2.3" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.3.3.3.2.3.cmml">0</mn><mn id="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.3.3.3.3" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.3.3.3.3.cmml">2</mn></msubsup><mo id="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.3.3.1a" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.3.3.1.cmml">⁢</mo><msup id="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.3.3.4" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.3.3.4.cmml"><mi id="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.3.3.4.2" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.3.3.4.2.cmml">α</mi><mi id="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.3.3.4.3" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.3.3.4.3.cmml">t</mi></msup></mrow></mfrac></mstyle><mo id="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.2" lspace="0.167em" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.1" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.1.cmml"><mo id="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.1.2" movablelimits="false" rspace="0em" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.1.2.cmml">𝔼</mo><mrow id="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.1.1.1" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.1.1.2.cmml"><mo id="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.1.1.1.2" maxsize="160%" minsize="160%" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.cmml">[</mo><msup id="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.1.1.1.1" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mo id="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml">‖</mo><mrow id="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">ϵ</mi><mi id="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">θ</mi></msub><mo id="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">𝐱</mi><mi id="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">−</mo><mi id="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">ϵ</mi></mrow><mo id="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.cmml">2</mn></msup><mo id="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.1.1.1.3" maxsize="160%" minsize="160%" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><mo id="A1.E12Xc.2.1.1.m1.1.1.1.1.1.2" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.1.2.cmml">−</mo><mstyle displaystyle="true" id="A1.E12Xc.2.1.1.m1.1.1.1.1.1.3" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.1.3.cmml"><mfrac id="A1.E12Xc.2.1.1.m1.1.1.1.1.1.3a" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.1.3.cmml"><mrow id="A1.E12Xc.2.1.1.m1.1.1.1.1.1.3.2" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.1.3.2.cmml"><mn id="A1.E12Xc.2.1.1.m1.1.1.1.1.1.3.2.2" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.1.3.2.2.cmml">1</mn><mo id="A1.E12Xc.2.1.1.m1.1.1.1.1.1.3.2.1" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.1.3.2.1.cmml">−</mo><msup id="A1.E12Xc.2.1.1.m1.1.1.1.1.1.3.2.3" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.1.3.2.3.cmml"><mi id="A1.E12Xc.2.1.1.m1.1.1.1.1.1.3.2.3.2" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.1.3.2.3.2.cmml">α</mi><mi id="A1.E12Xc.2.1.1.m1.1.1.1.1.1.3.2.3.3" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.1.3.2.3.3.cmml">t</mi></msup></mrow><mrow id="A1.E12Xc.2.1.1.m1.1.1.1.1.1.3.3" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.1.3.3.cmml"><mn id="A1.E12Xc.2.1.1.m1.1.1.1.1.1.3.3.2" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.1.3.3.2.cmml">2</mn><mo id="A1.E12Xc.2.1.1.m1.1.1.1.1.1.3.3.1" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.1.3.3.1.cmml">⁢</mo><msubsup id="A1.E12Xc.2.1.1.m1.1.1.1.1.1.3.3.3" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.1.3.3.3.cmml"><mi id="A1.E12Xc.2.1.1.m1.1.1.1.1.1.3.3.3.2.2" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.1.3.3.3.2.2.cmml">σ</mi><mn id="A1.E12Xc.2.1.1.m1.1.1.1.1.1.3.3.3.2.3" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.1.3.3.3.2.3.cmml">0</mn><mn id="A1.E12Xc.2.1.1.m1.1.1.1.1.1.3.3.3.3" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.1.3.3.3.3.cmml">2</mn></msubsup><mo id="A1.E12Xc.2.1.1.m1.1.1.1.1.1.3.3.1a" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.1.3.3.1.cmml">⁢</mo><msup id="A1.E12Xc.2.1.1.m1.1.1.1.1.1.3.3.4" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.1.3.3.4.cmml"><mi id="A1.E12Xc.2.1.1.m1.1.1.1.1.1.3.3.4.2" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.1.3.3.4.2.cmml">α</mi><mi id="A1.E12Xc.2.1.1.m1.1.1.1.1.1.3.3.4.3" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.1.3.3.4.3.cmml">t</mi></msup></mrow></mfrac></mstyle></mrow></mrow><mo id="A1.E12Xc.2.1.1.m1.1.1.1.2" lspace="0em" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.E12Xc.2.1.1.m1.1b"><apply id="A1.E12Xc.2.1.1.m1.1.1.1.1.cmml" xref="A1.E12Xc.2.1.1.m1.1.1.1"><eq id="A1.E12Xc.2.1.1.m1.1.1.1.1.2.cmml" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.2"></eq><csymbol cd="latexml" id="A1.E12Xc.2.1.1.m1.1.1.1.1.3.cmml" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.3">absent</csymbol><apply id="A1.E12Xc.2.1.1.m1.1.1.1.1.1.cmml" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.1"><minus id="A1.E12Xc.2.1.1.m1.1.1.1.1.1.2.cmml" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.1.2"></minus><apply id="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.cmml" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1"><times id="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.2.cmml" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.2"></times><apply id="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.3.cmml" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.3"><divide id="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.3.1.cmml" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.3"></divide><apply id="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.3.2.cmml" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.3.2"><minus id="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.3.2.1.cmml" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.3.2.1"></minus><cn id="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.3.2.2.cmml" type="integer" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.3.2.2">1</cn><apply id="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.3.2.3.cmml" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.3.2.3"><csymbol cd="ambiguous" id="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.3.2.3.1.cmml" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.3.2.3">superscript</csymbol><ci id="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.3.2.3.2.cmml" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.3.2.3.2">𝛼</ci><ci id="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.3.2.3.3.cmml" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.3.2.3.3">𝑡</ci></apply></apply><apply id="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.3.3.cmml" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.3.3"><times id="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.3.3.1.cmml" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.3.3.1"></times><cn id="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.3.3.2.cmml" type="integer" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.3.3.2">2</cn><apply id="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.3.3.3.cmml" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.3.3.3.1.cmml" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.3.3.3">superscript</csymbol><apply id="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.3.3.3.2.cmml" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.3.3.3.2.1.cmml" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.3.3.3">subscript</csymbol><ci id="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.3.3.3.2.2.cmml" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.3.3.3.2.2">𝜎</ci><cn id="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.3.3.3.2.3.cmml" type="integer" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.3.3.3.2.3">0</cn></apply><cn id="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.3.3.3.3.cmml" type="integer" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.3.3.3.3">2</cn></apply><apply id="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.3.3.4.cmml" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.3.3.4"><csymbol cd="ambiguous" id="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.3.3.4.1.cmml" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.3.3.4">superscript</csymbol><ci id="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.3.3.4.2.cmml" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.3.3.4.2">𝛼</ci><ci id="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.3.3.4.3.cmml" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.3.3.4.3">𝑡</ci></apply></apply></apply><apply id="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.1.cmml" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.1"><ci id="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.1.2.cmml" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.1.2">𝔼</ci><apply id="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2">norm</csymbol><apply id="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1"><minus id="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2"></minus><apply id="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1"><times id="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2"></times><apply id="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2">italic-ϵ</ci><ci id="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3">𝜃</ci></apply><apply id="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2">𝐱</ci><ci id="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑡</ci></apply></apply><ci id="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">italic-ϵ</ci></apply></apply><cn id="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3">2</cn></apply></apply></apply></apply><apply id="A1.E12Xc.2.1.1.m1.1.1.1.1.1.3.cmml" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.1.3"><divide id="A1.E12Xc.2.1.1.m1.1.1.1.1.1.3.1.cmml" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.1.3"></divide><apply id="A1.E12Xc.2.1.1.m1.1.1.1.1.1.3.2.cmml" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.1.3.2"><minus id="A1.E12Xc.2.1.1.m1.1.1.1.1.1.3.2.1.cmml" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.1.3.2.1"></minus><cn id="A1.E12Xc.2.1.1.m1.1.1.1.1.1.3.2.2.cmml" type="integer" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.1.3.2.2">1</cn><apply id="A1.E12Xc.2.1.1.m1.1.1.1.1.1.3.2.3.cmml" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.1.3.2.3"><csymbol cd="ambiguous" id="A1.E12Xc.2.1.1.m1.1.1.1.1.1.3.2.3.1.cmml" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.1.3.2.3">superscript</csymbol><ci id="A1.E12Xc.2.1.1.m1.1.1.1.1.1.3.2.3.2.cmml" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.1.3.2.3.2">𝛼</ci><ci id="A1.E12Xc.2.1.1.m1.1.1.1.1.1.3.2.3.3.cmml" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.1.3.2.3.3">𝑡</ci></apply></apply><apply id="A1.E12Xc.2.1.1.m1.1.1.1.1.1.3.3.cmml" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.1.3.3"><times id="A1.E12Xc.2.1.1.m1.1.1.1.1.1.3.3.1.cmml" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.1.3.3.1"></times><cn id="A1.E12Xc.2.1.1.m1.1.1.1.1.1.3.3.2.cmml" type="integer" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.1.3.3.2">2</cn><apply id="A1.E12Xc.2.1.1.m1.1.1.1.1.1.3.3.3.cmml" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="A1.E12Xc.2.1.1.m1.1.1.1.1.1.3.3.3.1.cmml" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.1.3.3.3">superscript</csymbol><apply id="A1.E12Xc.2.1.1.m1.1.1.1.1.1.3.3.3.2.cmml" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="A1.E12Xc.2.1.1.m1.1.1.1.1.1.3.3.3.2.1.cmml" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.1.3.3.3">subscript</csymbol><ci id="A1.E12Xc.2.1.1.m1.1.1.1.1.1.3.3.3.2.2.cmml" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.1.3.3.3.2.2">𝜎</ci><cn id="A1.E12Xc.2.1.1.m1.1.1.1.1.1.3.3.3.2.3.cmml" type="integer" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.1.3.3.3.2.3">0</cn></apply><cn id="A1.E12Xc.2.1.1.m1.1.1.1.1.1.3.3.3.3.cmml" type="integer" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.1.3.3.3.3">2</cn></apply><apply id="A1.E12Xc.2.1.1.m1.1.1.1.1.1.3.3.4.cmml" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.1.3.3.4"><csymbol cd="ambiguous" id="A1.E12Xc.2.1.1.m1.1.1.1.1.1.3.3.4.1.cmml" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.1.3.3.4">superscript</csymbol><ci id="A1.E12Xc.2.1.1.m1.1.1.1.1.1.3.3.4.2.cmml" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.1.3.3.4.2">𝛼</ci><ci id="A1.E12Xc.2.1.1.m1.1.1.1.1.1.3.3.4.3.cmml" xref="A1.E12Xc.2.1.1.m1.1.1.1.1.1.3.3.4.3">𝑡</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E12Xc.2.1.1.m1.1c">\displaystyle=~{}\frac{1-\alpha^{t}}{2\sigma_{0}^{2}\alpha^{t}}\mathop{\mathbb%
{E}}\Big{[}\left\|\epsilon_{\theta}(\mathbf{x}_{t})-\mathbf{\epsilon}\right\|^%
{2}\Big{]}-\frac{1-\alpha^{t}}{2\sigma_{0}^{2}\alpha^{t}}.</annotation><annotation encoding="application/x-llamapun" id="A1.E12Xc.2.1.1.m1.1d">= divide start_ARG 1 - italic_α start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT end_ARG start_ARG 2 italic_σ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT italic_α start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT end_ARG blackboard_E [ ∥ italic_ϵ start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( bold_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) - italic_ϵ ∥ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ] - divide start_ARG 1 - italic_α start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT end_ARG start_ARG 2 italic_σ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT italic_α start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT end_ARG .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
<p class="ltx_p" id="A1.SS1.p2.9">The last step is from Jensen’s inequality for the square-error function. Thus, given the condition</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equationgroup ltx_eqn_table" id="A1.E13">
<tbody>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="A1.E13X">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathop{\mathbb{E}}\Big{[}\|\epsilon_{\theta_{1}}(\mathbf{x}_{t})%
-\mathbf{\epsilon}\|^{2}-\|\epsilon_{\theta_{2}}(\mathbf{x}_{t})-\mathbf{%
\epsilon}\|^{2}\Big{]}" class="ltx_Math" display="inline" id="A1.E13X.2.1.1.m1.1"><semantics id="A1.E13X.2.1.1.m1.1a"><mrow id="A1.E13X.2.1.1.m1.1.1" xref="A1.E13X.2.1.1.m1.1.1.cmml"><mo id="A1.E13X.2.1.1.m1.1.1.2" movablelimits="false" rspace="0em" xref="A1.E13X.2.1.1.m1.1.1.2.cmml">𝔼</mo><mrow id="A1.E13X.2.1.1.m1.1.1.1.1" xref="A1.E13X.2.1.1.m1.1.1.1.2.cmml"><mo id="A1.E13X.2.1.1.m1.1.1.1.1.2" maxsize="160%" minsize="160%" xref="A1.E13X.2.1.1.m1.1.1.1.2.1.cmml">[</mo><mrow id="A1.E13X.2.1.1.m1.1.1.1.1.1" xref="A1.E13X.2.1.1.m1.1.1.1.1.1.cmml"><msup id="A1.E13X.2.1.1.m1.1.1.1.1.1.1" xref="A1.E13X.2.1.1.m1.1.1.1.1.1.1.cmml"><mrow id="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.1" xref="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.2.cmml"><mo id="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.2.1.cmml">‖</mo><mrow id="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.1.1" xref="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1" xref="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3" xref="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.2" xref="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">ϵ</mi><msub id="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.3" xref="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.3.2" xref="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.3.2.cmml">θ</mi><mn id="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.3.3" xref="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.3.3.cmml">1</mn></msub></msub><mo id="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2" xref="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1" xref="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">𝐱</mi><mi id="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2" xref="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.cmml">−</mo><mi id="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.1.1.3" xref="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.1.1.3.cmml">ϵ</mi></mrow><mo id="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="A1.E13X.2.1.1.m1.1.1.1.1.1.1.3" xref="A1.E13X.2.1.1.m1.1.1.1.1.1.1.3.cmml">2</mn></msup><mo id="A1.E13X.2.1.1.m1.1.1.1.1.1.3" xref="A1.E13X.2.1.1.m1.1.1.1.1.1.3.cmml">−</mo><msup id="A1.E13X.2.1.1.m1.1.1.1.1.1.2" xref="A1.E13X.2.1.1.m1.1.1.1.1.1.2.cmml"><mrow id="A1.E13X.2.1.1.m1.1.1.1.1.1.2.1.1" xref="A1.E13X.2.1.1.m1.1.1.1.1.1.2.1.2.cmml"><mo id="A1.E13X.2.1.1.m1.1.1.1.1.1.2.1.1.2" stretchy="false" xref="A1.E13X.2.1.1.m1.1.1.1.1.1.2.1.2.1.cmml">‖</mo><mrow id="A1.E13X.2.1.1.m1.1.1.1.1.1.2.1.1.1" xref="A1.E13X.2.1.1.m1.1.1.1.1.1.2.1.1.1.cmml"><mrow id="A1.E13X.2.1.1.m1.1.1.1.1.1.2.1.1.1.1" xref="A1.E13X.2.1.1.m1.1.1.1.1.1.2.1.1.1.1.cmml"><msub id="A1.E13X.2.1.1.m1.1.1.1.1.1.2.1.1.1.1.3" xref="A1.E13X.2.1.1.m1.1.1.1.1.1.2.1.1.1.1.3.cmml"><mi id="A1.E13X.2.1.1.m1.1.1.1.1.1.2.1.1.1.1.3.2" xref="A1.E13X.2.1.1.m1.1.1.1.1.1.2.1.1.1.1.3.2.cmml">ϵ</mi><msub id="A1.E13X.2.1.1.m1.1.1.1.1.1.2.1.1.1.1.3.3" xref="A1.E13X.2.1.1.m1.1.1.1.1.1.2.1.1.1.1.3.3.cmml"><mi id="A1.E13X.2.1.1.m1.1.1.1.1.1.2.1.1.1.1.3.3.2" xref="A1.E13X.2.1.1.m1.1.1.1.1.1.2.1.1.1.1.3.3.2.cmml">θ</mi><mn id="A1.E13X.2.1.1.m1.1.1.1.1.1.2.1.1.1.1.3.3.3" xref="A1.E13X.2.1.1.m1.1.1.1.1.1.2.1.1.1.1.3.3.3.cmml">2</mn></msub></msub><mo id="A1.E13X.2.1.1.m1.1.1.1.1.1.2.1.1.1.1.2" xref="A1.E13X.2.1.1.m1.1.1.1.1.1.2.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.E13X.2.1.1.m1.1.1.1.1.1.2.1.1.1.1.1.1" xref="A1.E13X.2.1.1.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.cmml"><mo id="A1.E13X.2.1.1.m1.1.1.1.1.1.2.1.1.1.1.1.1.2" stretchy="false" xref="A1.E13X.2.1.1.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.cmml">(</mo><msub id="A1.E13X.2.1.1.m1.1.1.1.1.1.2.1.1.1.1.1.1.1" xref="A1.E13X.2.1.1.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.cmml"><mi id="A1.E13X.2.1.1.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.2" xref="A1.E13X.2.1.1.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.2.cmml">𝐱</mi><mi id="A1.E13X.2.1.1.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.3" xref="A1.E13X.2.1.1.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="A1.E13X.2.1.1.m1.1.1.1.1.1.2.1.1.1.1.1.1.3" stretchy="false" xref="A1.E13X.2.1.1.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E13X.2.1.1.m1.1.1.1.1.1.2.1.1.1.2" xref="A1.E13X.2.1.1.m1.1.1.1.1.1.2.1.1.1.2.cmml">−</mo><mi id="A1.E13X.2.1.1.m1.1.1.1.1.1.2.1.1.1.3" xref="A1.E13X.2.1.1.m1.1.1.1.1.1.2.1.1.1.3.cmml">ϵ</mi></mrow><mo id="A1.E13X.2.1.1.m1.1.1.1.1.1.2.1.1.3" stretchy="false" xref="A1.E13X.2.1.1.m1.1.1.1.1.1.2.1.2.1.cmml">‖</mo></mrow><mn id="A1.E13X.2.1.1.m1.1.1.1.1.1.2.3" xref="A1.E13X.2.1.1.m1.1.1.1.1.1.2.3.cmml">2</mn></msup></mrow><mo id="A1.E13X.2.1.1.m1.1.1.1.1.3" maxsize="160%" minsize="160%" xref="A1.E13X.2.1.1.m1.1.1.1.2.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E13X.2.1.1.m1.1b"><apply id="A1.E13X.2.1.1.m1.1.1.cmml" xref="A1.E13X.2.1.1.m1.1.1"><ci id="A1.E13X.2.1.1.m1.1.1.2.cmml" xref="A1.E13X.2.1.1.m1.1.1.2">𝔼</ci><apply id="A1.E13X.2.1.1.m1.1.1.1.2.cmml" xref="A1.E13X.2.1.1.m1.1.1.1.1"><csymbol cd="latexml" id="A1.E13X.2.1.1.m1.1.1.1.2.1.cmml" xref="A1.E13X.2.1.1.m1.1.1.1.1.2">delimited-[]</csymbol><apply id="A1.E13X.2.1.1.m1.1.1.1.1.1.cmml" xref="A1.E13X.2.1.1.m1.1.1.1.1.1"><minus id="A1.E13X.2.1.1.m1.1.1.1.1.1.3.cmml" xref="A1.E13X.2.1.1.m1.1.1.1.1.1.3"></minus><apply id="A1.E13X.2.1.1.m1.1.1.1.1.1.1.cmml" xref="A1.E13X.2.1.1.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E13X.2.1.1.m1.1.1.1.1.1.1.2.cmml" xref="A1.E13X.2.1.1.m1.1.1.1.1.1.1">superscript</csymbol><apply id="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.2.cmml" xref="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.2.1.cmml" xref="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.1.2">norm</csymbol><apply id="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.1.1"><minus id="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2"></minus><apply id="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1"><times id="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2"></times><apply id="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.2">italic-ϵ</ci><apply id="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.3.2">𝜃</ci><cn id="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.3.3.cmml" type="integer" xref="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.3.3">1</cn></apply></apply><apply id="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2">𝐱</ci><ci id="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑡</ci></apply></apply><ci id="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.1.1.3">italic-ϵ</ci></apply></apply><cn id="A1.E13X.2.1.1.m1.1.1.1.1.1.1.3.cmml" type="integer" xref="A1.E13X.2.1.1.m1.1.1.1.1.1.1.3">2</cn></apply><apply id="A1.E13X.2.1.1.m1.1.1.1.1.1.2.cmml" xref="A1.E13X.2.1.1.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.E13X.2.1.1.m1.1.1.1.1.1.2.2.cmml" xref="A1.E13X.2.1.1.m1.1.1.1.1.1.2">superscript</csymbol><apply id="A1.E13X.2.1.1.m1.1.1.1.1.1.2.1.2.cmml" xref="A1.E13X.2.1.1.m1.1.1.1.1.1.2.1.1"><csymbol cd="latexml" id="A1.E13X.2.1.1.m1.1.1.1.1.1.2.1.2.1.cmml" xref="A1.E13X.2.1.1.m1.1.1.1.1.1.2.1.1.2">norm</csymbol><apply id="A1.E13X.2.1.1.m1.1.1.1.1.1.2.1.1.1.cmml" xref="A1.E13X.2.1.1.m1.1.1.1.1.1.2.1.1.1"><minus id="A1.E13X.2.1.1.m1.1.1.1.1.1.2.1.1.1.2.cmml" xref="A1.E13X.2.1.1.m1.1.1.1.1.1.2.1.1.1.2"></minus><apply id="A1.E13X.2.1.1.m1.1.1.1.1.1.2.1.1.1.1.cmml" xref="A1.E13X.2.1.1.m1.1.1.1.1.1.2.1.1.1.1"><times id="A1.E13X.2.1.1.m1.1.1.1.1.1.2.1.1.1.1.2.cmml" xref="A1.E13X.2.1.1.m1.1.1.1.1.1.2.1.1.1.1.2"></times><apply id="A1.E13X.2.1.1.m1.1.1.1.1.1.2.1.1.1.1.3.cmml" xref="A1.E13X.2.1.1.m1.1.1.1.1.1.2.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.E13X.2.1.1.m1.1.1.1.1.1.2.1.1.1.1.3.1.cmml" xref="A1.E13X.2.1.1.m1.1.1.1.1.1.2.1.1.1.1.3">subscript</csymbol><ci id="A1.E13X.2.1.1.m1.1.1.1.1.1.2.1.1.1.1.3.2.cmml" xref="A1.E13X.2.1.1.m1.1.1.1.1.1.2.1.1.1.1.3.2">italic-ϵ</ci><apply id="A1.E13X.2.1.1.m1.1.1.1.1.1.2.1.1.1.1.3.3.cmml" xref="A1.E13X.2.1.1.m1.1.1.1.1.1.2.1.1.1.1.3.3"><csymbol cd="ambiguous" id="A1.E13X.2.1.1.m1.1.1.1.1.1.2.1.1.1.1.3.3.1.cmml" xref="A1.E13X.2.1.1.m1.1.1.1.1.1.2.1.1.1.1.3.3">subscript</csymbol><ci id="A1.E13X.2.1.1.m1.1.1.1.1.1.2.1.1.1.1.3.3.2.cmml" xref="A1.E13X.2.1.1.m1.1.1.1.1.1.2.1.1.1.1.3.3.2">𝜃</ci><cn id="A1.E13X.2.1.1.m1.1.1.1.1.1.2.1.1.1.1.3.3.3.cmml" type="integer" xref="A1.E13X.2.1.1.m1.1.1.1.1.1.2.1.1.1.1.3.3.3">2</cn></apply></apply><apply id="A1.E13X.2.1.1.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.cmml" xref="A1.E13X.2.1.1.m1.1.1.1.1.1.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E13X.2.1.1.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.cmml" xref="A1.E13X.2.1.1.m1.1.1.1.1.1.2.1.1.1.1.1.1">subscript</csymbol><ci id="A1.E13X.2.1.1.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.2.cmml" xref="A1.E13X.2.1.1.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.2">𝐱</ci><ci id="A1.E13X.2.1.1.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.3.cmml" xref="A1.E13X.2.1.1.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.3">𝑡</ci></apply></apply><ci id="A1.E13X.2.1.1.m1.1.1.1.1.1.2.1.1.1.3.cmml" xref="A1.E13X.2.1.1.m1.1.1.1.1.1.2.1.1.1.3">italic-ϵ</ci></apply></apply><cn id="A1.E13X.2.1.1.m1.1.1.1.1.1.2.3.cmml" type="integer" xref="A1.E13X.2.1.1.m1.1.1.1.1.1.2.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E13X.2.1.1.m1.1c">\displaystyle\mathop{\mathbb{E}}\Big{[}\|\epsilon_{\theta_{1}}(\mathbf{x}_{t})%
-\mathbf{\epsilon}\|^{2}-\|\epsilon_{\theta_{2}}(\mathbf{x}_{t})-\mathbf{%
\epsilon}\|^{2}\Big{]}</annotation><annotation encoding="application/x-llamapun" id="A1.E13X.2.1.1.m1.1d">blackboard_E [ ∥ italic_ϵ start_POSTSUBSCRIPT italic_θ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) - italic_ϵ ∥ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT - ∥ italic_ϵ start_POSTSUBSCRIPT italic_θ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) - italic_ϵ ∥ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ]</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\leq 0," class="ltx_Math" display="inline" id="A1.E13X.3.2.2.m1.1"><semantics id="A1.E13X.3.2.2.m1.1a"><mrow id="A1.E13X.3.2.2.m1.1.1.1" xref="A1.E13X.3.2.2.m1.1.1.1.1.cmml"><mrow id="A1.E13X.3.2.2.m1.1.1.1.1" xref="A1.E13X.3.2.2.m1.1.1.1.1.cmml"><mi id="A1.E13X.3.2.2.m1.1.1.1.1.2" xref="A1.E13X.3.2.2.m1.1.1.1.1.2.cmml"></mi><mo id="A1.E13X.3.2.2.m1.1.1.1.1.1" xref="A1.E13X.3.2.2.m1.1.1.1.1.1.cmml">≤</mo><mn id="A1.E13X.3.2.2.m1.1.1.1.1.3" xref="A1.E13X.3.2.2.m1.1.1.1.1.3.cmml">0</mn></mrow><mo id="A1.E13X.3.2.2.m1.1.1.1.2" xref="A1.E13X.3.2.2.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.E13X.3.2.2.m1.1b"><apply id="A1.E13X.3.2.2.m1.1.1.1.1.cmml" xref="A1.E13X.3.2.2.m1.1.1.1"><leq id="A1.E13X.3.2.2.m1.1.1.1.1.1.cmml" xref="A1.E13X.3.2.2.m1.1.1.1.1.1"></leq><csymbol cd="latexml" id="A1.E13X.3.2.2.m1.1.1.1.1.2.cmml" xref="A1.E13X.3.2.2.m1.1.1.1.1.2">absent</csymbol><cn id="A1.E13X.3.2.2.m1.1.1.1.1.3.cmml" type="integer" xref="A1.E13X.3.2.2.m1.1.1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E13X.3.2.2.m1.1c">\displaystyle\leq 0,</annotation><annotation encoding="application/x-llamapun" id="A1.E13X.3.2.2.m1.1d">≤ 0 ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(13)</span></td>
</tr>
</tbody>
</table>
<p class="ltx_p" id="A1.SS1.p2.10">we have</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equationgroup ltx_eqn_table" id="A1.E14">
<tbody>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="A1.E14X">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle D_{\rm KL}(\widehat{\mathbf{x}}^{\theta_{1}}_{0}||\mathbf{x}_{0}%
)-D_{\rm KL}(\widehat{\mathbf{x}}^{\theta_{2}}_{0}||\mathbf{x}_{0})" class="ltx_math_unparsed" display="inline" id="A1.E14X.2.1.1.m1.1"><semantics id="A1.E14X.2.1.1.m1.1a"><mrow id="A1.E14X.2.1.1.m1.1b"><msub id="A1.E14X.2.1.1.m1.1.1"><mi id="A1.E14X.2.1.1.m1.1.1.2">D</mi><mi id="A1.E14X.2.1.1.m1.1.1.3">KL</mi></msub><mrow id="A1.E14X.2.1.1.m1.1.2"><mo id="A1.E14X.2.1.1.m1.1.2.1" stretchy="false">(</mo><msubsup id="A1.E14X.2.1.1.m1.1.2.2"><mover accent="true" id="A1.E14X.2.1.1.m1.1.2.2.2.2"><mi id="A1.E14X.2.1.1.m1.1.2.2.2.2.2">𝐱</mi><mo id="A1.E14X.2.1.1.m1.1.2.2.2.2.1">^</mo></mover><mn id="A1.E14X.2.1.1.m1.1.2.2.3">0</mn><msub id="A1.E14X.2.1.1.m1.1.2.2.2.3"><mi id="A1.E14X.2.1.1.m1.1.2.2.2.3.2">θ</mi><mn id="A1.E14X.2.1.1.m1.1.2.2.2.3.3">1</mn></msub></msubsup><mo fence="false" id="A1.E14X.2.1.1.m1.1.2.3" rspace="0.167em" stretchy="false">|</mo><mo fence="false" id="A1.E14X.2.1.1.m1.1.2.4" rspace="0.167em" stretchy="false">|</mo><msub id="A1.E14X.2.1.1.m1.1.2.5"><mi id="A1.E14X.2.1.1.m1.1.2.5.2">𝐱</mi><mn id="A1.E14X.2.1.1.m1.1.2.5.3">0</mn></msub><mo id="A1.E14X.2.1.1.m1.1.2.6" stretchy="false">)</mo></mrow><mo id="A1.E14X.2.1.1.m1.1.3">−</mo><msub id="A1.E14X.2.1.1.m1.1.4"><mi id="A1.E14X.2.1.1.m1.1.4.2">D</mi><mi id="A1.E14X.2.1.1.m1.1.4.3">KL</mi></msub><mrow id="A1.E14X.2.1.1.m1.1.5"><mo id="A1.E14X.2.1.1.m1.1.5.1" stretchy="false">(</mo><msubsup id="A1.E14X.2.1.1.m1.1.5.2"><mover accent="true" id="A1.E14X.2.1.1.m1.1.5.2.2.2"><mi id="A1.E14X.2.1.1.m1.1.5.2.2.2.2">𝐱</mi><mo id="A1.E14X.2.1.1.m1.1.5.2.2.2.1">^</mo></mover><mn id="A1.E14X.2.1.1.m1.1.5.2.3">0</mn><msub id="A1.E14X.2.1.1.m1.1.5.2.2.3"><mi id="A1.E14X.2.1.1.m1.1.5.2.2.3.2">θ</mi><mn id="A1.E14X.2.1.1.m1.1.5.2.2.3.3">2</mn></msub></msubsup><mo fence="false" id="A1.E14X.2.1.1.m1.1.5.3" rspace="0.167em" stretchy="false">|</mo><mo fence="false" id="A1.E14X.2.1.1.m1.1.5.4" rspace="0.167em" stretchy="false">|</mo><msub id="A1.E14X.2.1.1.m1.1.5.5"><mi id="A1.E14X.2.1.1.m1.1.5.5.2">𝐱</mi><mn id="A1.E14X.2.1.1.m1.1.5.5.3">0</mn></msub><mo id="A1.E14X.2.1.1.m1.1.5.6" stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="A1.E14X.2.1.1.m1.1c">\displaystyle D_{\rm KL}(\widehat{\mathbf{x}}^{\theta_{1}}_{0}||\mathbf{x}_{0}%
)-D_{\rm KL}(\widehat{\mathbf{x}}^{\theta_{2}}_{0}||\mathbf{x}_{0})</annotation><annotation encoding="application/x-llamapun" id="A1.E14X.2.1.1.m1.1d">italic_D start_POSTSUBSCRIPT roman_KL end_POSTSUBSCRIPT ( over^ start_ARG bold_x end_ARG start_POSTSUPERSCRIPT italic_θ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT | | bold_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ) - italic_D start_POSTSUBSCRIPT roman_KL end_POSTSUBSCRIPT ( over^ start_ARG bold_x end_ARG start_POSTSUPERSCRIPT italic_θ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT | | bold_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\leq 0." class="ltx_Math" display="inline" id="A1.E14X.3.2.2.m1.1"><semantics id="A1.E14X.3.2.2.m1.1a"><mrow id="A1.E14X.3.2.2.m1.1.1.1" xref="A1.E14X.3.2.2.m1.1.1.1.1.cmml"><mrow id="A1.E14X.3.2.2.m1.1.1.1.1" xref="A1.E14X.3.2.2.m1.1.1.1.1.cmml"><mi id="A1.E14X.3.2.2.m1.1.1.1.1.2" xref="A1.E14X.3.2.2.m1.1.1.1.1.2.cmml"></mi><mo id="A1.E14X.3.2.2.m1.1.1.1.1.1" xref="A1.E14X.3.2.2.m1.1.1.1.1.1.cmml">≤</mo><mn id="A1.E14X.3.2.2.m1.1.1.1.1.3" xref="A1.E14X.3.2.2.m1.1.1.1.1.3.cmml">0</mn></mrow><mo id="A1.E14X.3.2.2.m1.1.1.1.2" lspace="0em" xref="A1.E14X.3.2.2.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.E14X.3.2.2.m1.1b"><apply id="A1.E14X.3.2.2.m1.1.1.1.1.cmml" xref="A1.E14X.3.2.2.m1.1.1.1"><leq id="A1.E14X.3.2.2.m1.1.1.1.1.1.cmml" xref="A1.E14X.3.2.2.m1.1.1.1.1.1"></leq><csymbol cd="latexml" id="A1.E14X.3.2.2.m1.1.1.1.1.2.cmml" xref="A1.E14X.3.2.2.m1.1.1.1.1.2">absent</csymbol><cn id="A1.E14X.3.2.2.m1.1.1.1.1.3.cmml" type="integer" xref="A1.E14X.3.2.2.m1.1.1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E14X.3.2.2.m1.1c">\displaystyle\leq 0.</annotation><annotation encoding="application/x-llamapun" id="A1.E14X.3.2.2.m1.1d">≤ 0 .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(14)</span></td>
</tr>
</tbody>
</table>
<p class="ltx_p" id="A1.SS1.p2.8">The prediction from model <math alttext="{\theta_{1}}" class="ltx_Math" display="inline" id="A1.SS1.p2.3.m1.1"><semantics id="A1.SS1.p2.3.m1.1a"><msub id="A1.SS1.p2.3.m1.1.1" xref="A1.SS1.p2.3.m1.1.1.cmml"><mi id="A1.SS1.p2.3.m1.1.1.2" xref="A1.SS1.p2.3.m1.1.1.2.cmml">θ</mi><mn id="A1.SS1.p2.3.m1.1.1.3" xref="A1.SS1.p2.3.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="A1.SS1.p2.3.m1.1b"><apply id="A1.SS1.p2.3.m1.1.1.cmml" xref="A1.SS1.p2.3.m1.1.1"><csymbol cd="ambiguous" id="A1.SS1.p2.3.m1.1.1.1.cmml" xref="A1.SS1.p2.3.m1.1.1">subscript</csymbol><ci id="A1.SS1.p2.3.m1.1.1.2.cmml" xref="A1.SS1.p2.3.m1.1.1.2">𝜃</ci><cn id="A1.SS1.p2.3.m1.1.1.3.cmml" type="integer" xref="A1.SS1.p2.3.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p2.3.m1.1c">{\theta_{1}}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p2.3.m1.1d">italic_θ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> has a smaller KL distance compared to the prediction from model <math alttext="{\theta_{2}}" class="ltx_Math" display="inline" id="A1.SS1.p2.4.m2.1"><semantics id="A1.SS1.p2.4.m2.1a"><msub id="A1.SS1.p2.4.m2.1.1" xref="A1.SS1.p2.4.m2.1.1.cmml"><mi id="A1.SS1.p2.4.m2.1.1.2" xref="A1.SS1.p2.4.m2.1.1.2.cmml">θ</mi><mn id="A1.SS1.p2.4.m2.1.1.3" xref="A1.SS1.p2.4.m2.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="A1.SS1.p2.4.m2.1b"><apply id="A1.SS1.p2.4.m2.1.1.cmml" xref="A1.SS1.p2.4.m2.1.1"><csymbol cd="ambiguous" id="A1.SS1.p2.4.m2.1.1.1.cmml" xref="A1.SS1.p2.4.m2.1.1">subscript</csymbol><ci id="A1.SS1.p2.4.m2.1.1.2.cmml" xref="A1.SS1.p2.4.m2.1.1.2">𝜃</ci><cn id="A1.SS1.p2.4.m2.1.1.3.cmml" type="integer" xref="A1.SS1.p2.4.m2.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p2.4.m2.1c">{\theta_{2}}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p2.4.m2.1d">italic_θ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>. Thus, <math alttext="{\theta_{1}}" class="ltx_Math" display="inline" id="A1.SS1.p2.5.m3.1"><semantics id="A1.SS1.p2.5.m3.1a"><msub id="A1.SS1.p2.5.m3.1.1" xref="A1.SS1.p2.5.m3.1.1.cmml"><mi id="A1.SS1.p2.5.m3.1.1.2" xref="A1.SS1.p2.5.m3.1.1.2.cmml">θ</mi><mn id="A1.SS1.p2.5.m3.1.1.3" xref="A1.SS1.p2.5.m3.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="A1.SS1.p2.5.m3.1b"><apply id="A1.SS1.p2.5.m3.1.1.cmml" xref="A1.SS1.p2.5.m3.1.1"><csymbol cd="ambiguous" id="A1.SS1.p2.5.m3.1.1.1.cmml" xref="A1.SS1.p2.5.m3.1.1">subscript</csymbol><ci id="A1.SS1.p2.5.m3.1.1.2.cmml" xref="A1.SS1.p2.5.m3.1.1.2">𝜃</ci><cn id="A1.SS1.p2.5.m3.1.1.3.cmml" type="integer" xref="A1.SS1.p2.5.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p2.5.m3.1c">{\theta_{1}}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p2.5.m3.1d">italic_θ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> recovers better images and <math alttext="{\theta_{1}}\succ{\theta_{2}}" class="ltx_Math" display="inline" id="A1.SS1.p2.6.m4.1"><semantics id="A1.SS1.p2.6.m4.1a"><mrow id="A1.SS1.p2.6.m4.1.1" xref="A1.SS1.p2.6.m4.1.1.cmml"><msub id="A1.SS1.p2.6.m4.1.1.2" xref="A1.SS1.p2.6.m4.1.1.2.cmml"><mi id="A1.SS1.p2.6.m4.1.1.2.2" xref="A1.SS1.p2.6.m4.1.1.2.2.cmml">θ</mi><mn id="A1.SS1.p2.6.m4.1.1.2.3" xref="A1.SS1.p2.6.m4.1.1.2.3.cmml">1</mn></msub><mo id="A1.SS1.p2.6.m4.1.1.1" xref="A1.SS1.p2.6.m4.1.1.1.cmml">≻</mo><msub id="A1.SS1.p2.6.m4.1.1.3" xref="A1.SS1.p2.6.m4.1.1.3.cmml"><mi id="A1.SS1.p2.6.m4.1.1.3.2" xref="A1.SS1.p2.6.m4.1.1.3.2.cmml">θ</mi><mn id="A1.SS1.p2.6.m4.1.1.3.3" xref="A1.SS1.p2.6.m4.1.1.3.3.cmml">2</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.p2.6.m4.1b"><apply id="A1.SS1.p2.6.m4.1.1.cmml" xref="A1.SS1.p2.6.m4.1.1"><csymbol cd="latexml" id="A1.SS1.p2.6.m4.1.1.1.cmml" xref="A1.SS1.p2.6.m4.1.1.1">succeeds</csymbol><apply id="A1.SS1.p2.6.m4.1.1.2.cmml" xref="A1.SS1.p2.6.m4.1.1.2"><csymbol cd="ambiguous" id="A1.SS1.p2.6.m4.1.1.2.1.cmml" xref="A1.SS1.p2.6.m4.1.1.2">subscript</csymbol><ci id="A1.SS1.p2.6.m4.1.1.2.2.cmml" xref="A1.SS1.p2.6.m4.1.1.2.2">𝜃</ci><cn id="A1.SS1.p2.6.m4.1.1.2.3.cmml" type="integer" xref="A1.SS1.p2.6.m4.1.1.2.3">1</cn></apply><apply id="A1.SS1.p2.6.m4.1.1.3.cmml" xref="A1.SS1.p2.6.m4.1.1.3"><csymbol cd="ambiguous" id="A1.SS1.p2.6.m4.1.1.3.1.cmml" xref="A1.SS1.p2.6.m4.1.1.3">subscript</csymbol><ci id="A1.SS1.p2.6.m4.1.1.3.2.cmml" xref="A1.SS1.p2.6.m4.1.1.3.2">𝜃</ci><cn id="A1.SS1.p2.6.m4.1.1.3.3.cmml" type="integer" xref="A1.SS1.p2.6.m4.1.1.3.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p2.6.m4.1c">{\theta_{1}}\succ{\theta_{2}}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p2.6.m4.1d">italic_θ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ≻ italic_θ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math> by the definition of performance measurement. As a result, <math alttext="{\theta_{1}}" class="ltx_Math" display="inline" id="A1.SS1.p2.7.m5.1"><semantics id="A1.SS1.p2.7.m5.1a"><msub id="A1.SS1.p2.7.m5.1.1" xref="A1.SS1.p2.7.m5.1.1.cmml"><mi id="A1.SS1.p2.7.m5.1.1.2" xref="A1.SS1.p2.7.m5.1.1.2.cmml">θ</mi><mn id="A1.SS1.p2.7.m5.1.1.3" xref="A1.SS1.p2.7.m5.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="A1.SS1.p2.7.m5.1b"><apply id="A1.SS1.p2.7.m5.1.1.cmml" xref="A1.SS1.p2.7.m5.1.1"><csymbol cd="ambiguous" id="A1.SS1.p2.7.m5.1.1.1.cmml" xref="A1.SS1.p2.7.m5.1.1">subscript</csymbol><ci id="A1.SS1.p2.7.m5.1.1.2.cmml" xref="A1.SS1.p2.7.m5.1.1.2">𝜃</ci><cn id="A1.SS1.p2.7.m5.1.1.3.cmml" type="integer" xref="A1.SS1.p2.7.m5.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p2.7.m5.1c">{\theta_{1}}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p2.7.m5.1d">italic_θ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> has a higher probability of generating a good result <math alttext="\mathbf{x}_{0}^{\theta_{1}}" class="ltx_Math" display="inline" id="A1.SS1.p2.8.m6.1"><semantics id="A1.SS1.p2.8.m6.1a"><msubsup id="A1.SS1.p2.8.m6.1.1" xref="A1.SS1.p2.8.m6.1.1.cmml"><mi id="A1.SS1.p2.8.m6.1.1.2.2" xref="A1.SS1.p2.8.m6.1.1.2.2.cmml">𝐱</mi><mn id="A1.SS1.p2.8.m6.1.1.2.3" xref="A1.SS1.p2.8.m6.1.1.2.3.cmml">0</mn><msub id="A1.SS1.p2.8.m6.1.1.3" xref="A1.SS1.p2.8.m6.1.1.3.cmml"><mi id="A1.SS1.p2.8.m6.1.1.3.2" xref="A1.SS1.p2.8.m6.1.1.3.2.cmml">θ</mi><mn id="A1.SS1.p2.8.m6.1.1.3.3" xref="A1.SS1.p2.8.m6.1.1.3.3.cmml">1</mn></msub></msubsup><annotation-xml encoding="MathML-Content" id="A1.SS1.p2.8.m6.1b"><apply id="A1.SS1.p2.8.m6.1.1.cmml" xref="A1.SS1.p2.8.m6.1.1"><csymbol cd="ambiguous" id="A1.SS1.p2.8.m6.1.1.1.cmml" xref="A1.SS1.p2.8.m6.1.1">superscript</csymbol><apply id="A1.SS1.p2.8.m6.1.1.2.cmml" xref="A1.SS1.p2.8.m6.1.1"><csymbol cd="ambiguous" id="A1.SS1.p2.8.m6.1.1.2.1.cmml" xref="A1.SS1.p2.8.m6.1.1">subscript</csymbol><ci id="A1.SS1.p2.8.m6.1.1.2.2.cmml" xref="A1.SS1.p2.8.m6.1.1.2.2">𝐱</ci><cn id="A1.SS1.p2.8.m6.1.1.2.3.cmml" type="integer" xref="A1.SS1.p2.8.m6.1.1.2.3">0</cn></apply><apply id="A1.SS1.p2.8.m6.1.1.3.cmml" xref="A1.SS1.p2.8.m6.1.1.3"><csymbol cd="ambiguous" id="A1.SS1.p2.8.m6.1.1.3.1.cmml" xref="A1.SS1.p2.8.m6.1.1.3">subscript</csymbol><ci id="A1.SS1.p2.8.m6.1.1.3.2.cmml" xref="A1.SS1.p2.8.m6.1.1.3.2">𝜃</ci><cn id="A1.SS1.p2.8.m6.1.1.3.3.cmml" type="integer" xref="A1.SS1.p2.8.m6.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p2.8.m6.1c">\mathbf{x}_{0}^{\theta_{1}}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p2.8.m6.1d">bold_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_θ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
</section>
<section class="ltx_appendix" id="A2">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>Supplementary Experiments</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<section class="ltx_subsection" id="A2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.1 </span>Ablation Study on Iteration <math alttext="K" class="ltx_Math" display="inline" id="A2.SS1.1.m1.1"><semantics id="A2.SS1.1.m1.1b"><mi id="A2.SS1.1.m1.1.1" xref="A2.SS1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="A2.SS1.1.m1.1c"><ci id="A2.SS1.1.m1.1.1.cmml" xref="A2.SS1.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.1.m1.1d">K</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.1.m1.1e">italic_K</annotation></semantics></math>
</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="A2.SS1.p1">
<p class="ltx_p" id="A2.SS1.p1.4">In this subsection, we perform an ablation study w.r.t. the number of iterations <math alttext="K" class="ltx_Math" display="inline" id="A2.SS1.p1.1.m1.1"><semantics id="A2.SS1.p1.1.m1.1a"><mi id="A2.SS1.p1.1.m1.1.1" xref="A2.SS1.p1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="A2.SS1.p1.1.m1.1b"><ci id="A2.SS1.p1.1.m1.1.1.cmml" xref="A2.SS1.p1.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p1.1.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p1.1.m1.1d">italic_K</annotation></semantics></math>. In Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.05255v1#A2.F6" title="Figure 6 ‣ B.1 Ablation Study on Iteration 𝐾 ‣ Appendix B Supplementary Experiments ‣ SePPO: Semi-Policy Preference Optimization for Diffusion Alignment"><span class="ltx_text ltx_ref_tag">6</span></a>, we found that when changing the total number of iteration <math alttext="K" class="ltx_Math" display="inline" id="A2.SS1.p1.2.m2.1"><semantics id="A2.SS1.p1.2.m2.1a"><mi id="A2.SS1.p1.2.m2.1.1" xref="A2.SS1.p1.2.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="A2.SS1.p1.2.m2.1b"><ci id="A2.SS1.p1.2.m2.1.1.cmml" xref="A2.SS1.p1.2.m2.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p1.2.m2.1c">K</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p1.2.m2.1d">italic_K</annotation></semantics></math> for saving checkpoints, relatively, the larger <math alttext="K" class="ltx_Math" display="inline" id="A2.SS1.p1.3.m3.1"><semantics id="A2.SS1.p1.3.m3.1a"><mi id="A2.SS1.p1.3.m3.1.1" xref="A2.SS1.p1.3.m3.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="A2.SS1.p1.3.m3.1b"><ci id="A2.SS1.p1.3.m3.1.1.cmml" xref="A2.SS1.p1.3.m3.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p1.3.m3.1c">K</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p1.3.m3.1d">italic_K</annotation></semantics></math> achieves better performance. However, the overall trend does not change significantly, which demonstrates the stability of SePPO on <math alttext="K" class="ltx_Math" display="inline" id="A2.SS1.p1.4.m4.1"><semantics id="A2.SS1.p1.4.m4.1a"><mi id="A2.SS1.p1.4.m4.1.1" xref="A2.SS1.p1.4.m4.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="A2.SS1.p1.4.m4.1b"><ci id="A2.SS1.p1.4.m4.1.1.cmml" xref="A2.SS1.p1.4.m4.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p1.4.m4.1c">K</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p1.4.m4.1d">italic_K</annotation></semantics></math>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_figure" id="A2.F6"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="225" id="A2.F6.g1" src="https://arxiv.org/html/2410.05255v1/extracted/5908093/figures/k_ab.png" width="299">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6: </span>Ablation study of <math alttext="K=10" class="ltx_Math" display="inline" id="A2.F6.3.m1.1"><semantics id="A2.F6.3.m1.1b"><mrow id="A2.F6.3.m1.1.1" xref="A2.F6.3.m1.1.1.cmml"><mi id="A2.F6.3.m1.1.1.2" xref="A2.F6.3.m1.1.1.2.cmml">K</mi><mo id="A2.F6.3.m1.1.1.1" xref="A2.F6.3.m1.1.1.1.cmml">=</mo><mn id="A2.F6.3.m1.1.1.3" xref="A2.F6.3.m1.1.1.3.cmml">10</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.F6.3.m1.1c"><apply id="A2.F6.3.m1.1.1.cmml" xref="A2.F6.3.m1.1.1"><eq id="A2.F6.3.m1.1.1.1.cmml" xref="A2.F6.3.m1.1.1.1"></eq><ci id="A2.F6.3.m1.1.1.2.cmml" xref="A2.F6.3.m1.1.1.2">𝐾</ci><cn id="A2.F6.3.m1.1.1.3.cmml" type="integer" xref="A2.F6.3.m1.1.1.3">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.F6.3.m1.1d">K=10</annotation><annotation encoding="application/x-llamapun" id="A2.F6.3.m1.1e">italic_K = 10</annotation></semantics></math> and <math alttext="K=20" class="ltx_Math" display="inline" id="A2.F6.4.m2.1"><semantics id="A2.F6.4.m2.1b"><mrow id="A2.F6.4.m2.1.1" xref="A2.F6.4.m2.1.1.cmml"><mi id="A2.F6.4.m2.1.1.2" xref="A2.F6.4.m2.1.1.2.cmml">K</mi><mo id="A2.F6.4.m2.1.1.1" xref="A2.F6.4.m2.1.1.1.cmml">=</mo><mn id="A2.F6.4.m2.1.1.3" xref="A2.F6.4.m2.1.1.3.cmml">20</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.F6.4.m2.1c"><apply id="A2.F6.4.m2.1.1.cmml" xref="A2.F6.4.m2.1.1"><eq id="A2.F6.4.m2.1.1.1.cmml" xref="A2.F6.4.m2.1.1.1"></eq><ci id="A2.F6.4.m2.1.1.2.cmml" xref="A2.F6.4.m2.1.1.2">𝐾</ci><cn id="A2.F6.4.m2.1.1.3.cmml" type="integer" xref="A2.F6.4.m2.1.1.3">20</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.F6.4.m2.1d">K=20</annotation><annotation encoding="application/x-llamapun" id="A2.F6.4.m2.1e">italic_K = 20</annotation></semantics></math>.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
<section class="ltx_subsection" id="A2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.2 </span>Pseudocode</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="A2.SS2.p1">
<p class="ltx_p" id="A2.SS2.p1.1">In this subsection, we give the pseudocode of the loss function for training.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="A2.SS2.p2">
<span class="ltx_ERROR undefined" id="A2.SS2.p2.1">{python}</span>
<p class="ltx_p" id="A2.SS2.p2.2">[frame=shadowbox]
def loss(target, model_pred, ref_pred, scale_term):
#### START LOSS COMPUTATION ####
if args.train_method == ’sft’: # SFT, casting for F.mse_loss
loss = F.mse_loss(model_pred.float(), target.float(),
reduction=”mean”)
elif args.train_method == ’seppo’:
# model_pred and ref_pred will be
# (2 * LBS) x 4 x latent_spatial_dim x latent_spatial_dim
# losses are both 2 * LBS
# 1st half of tensors is preferred (y_w),
# second half is unpreferred</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="A2.SS2.p3">
<p class="ltx_p" id="A2.SS2.p3.1">model_losses = (model_pred - target).pow(2).mean(dim=[1,2,3])
model_losses_w, model_losses_l = model_losses.chunk(2)</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="A2.SS2.p4">
<p class="ltx_p" id="A2.SS2.p4.1">with torch.no_grad():
# Get the reference policy (unet) prediction
ref_pred = ref_unet(*model_batch_args,
added_cond_kwargs=added_cond_kwargs
).sample.detach()</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="A2.SS2.p5">
<p class="ltx_p" id="A2.SS2.p5.1">ref_losses = (ref_pred - target).pow(2).mean(dim=[1,2,3])
ref_losses_w, ref_losses_l = ref_losses.chunk(2)</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="A2.SS2.p6">
<p class="ltx_p" id="A2.SS2.p6.1">pos_losses_w = model_losses_w - ref_losses_w</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="A2.SS2.p7">
<p class="ltx_p" id="A2.SS2.p7.1">sign = torch.where(pos_losses_w ¿ 0,
torch.tensor(1.0),
torch.tensor(-1.0))</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="A2.SS2.p8">
<p class="ltx_p" id="A2.SS2.p8.1">model_diff = model_losses_w + sign * model_losses_l
ref_diff = ref_losses_w + sign * ref_losses_l</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="A2.SS2.p9">
<p class="ltx_p" id="A2.SS2.p9.1">scale_term = -0.5 * args.beta_dpo
inside_term = scale_term * (model_diff - ref_diff)
implicit_acc = (inside_term ¿ 0).sum().float() /
inside_term.size(0)
loss = -1 * (F.logsigmoid(inside_term)).mean()</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="A2.SS2.p10">
<p class="ltx_p" id="A2.SS2.p10.1">return loss</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_subsection" id="A2.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.3 </span>Visual Generation Examples</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="A2.SS3.p1">
<p class="ltx_p" id="A2.SS3.p1.1">We present more text-to-visual generation results of SePPO and other methods. In Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.05255v1#A2.F7" title="Figure 7 ‣ B.3 Visual Generation Examples ‣ Appendix B Supplementary Experiments ‣ SePPO: Semi-Policy Preference Optimization for Diffusion Alignment"><span class="ltx_text ltx_ref_tag">7</span></a>, we show the text-to-image generation results of SD-1.5, SPO, SPIN-Diffusion, and SePPO. In Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.05255v1#A2.F8" title="Figure 8 ‣ B.3 Visual Generation Examples ‣ Appendix B Supplementary Experiments ‣ SePPO: Semi-Policy Preference Optimization for Diffusion Alignment"><span class="ltx_text ltx_ref_tag">8</span></a> and Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.05255v1#A2.F9" title="Figure 9 ‣ B.3 Visual Generation Examples ‣ Appendix B Supplementary Experiments ‣ SePPO: Semi-Policy Preference Optimization for Diffusion Alignment"><span class="ltx_text ltx_ref_tag">9</span></a>, we show the text-to-video generation results of AnimateDiff (Raw), SFT, and SePPO.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_figure" id="A2.F7"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="631" id="A2.F7.g1" src="https://arxiv.org/html/2410.05255v1/x6.png" width="830">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 7: </span>Text-to-image generation results of SD-1.5, SPO, SPIN-Diffusion, and SePPO. Prompts from left to right: (1) <span class="ltx_text ltx_font_italic" id="A2.F7.6.1">Pink Chihuahua in <span class="ltx_text ltx_framed ltx_framed_underline" id="A2.F7.6.1.1">police suit</span></span>; (2) <span class="ltx_text ltx_font_italic" id="A2.F7.7.2">Detailed Portrait Of A Disheveled Hippie Girl With Bright Gray Eyes By Anna Dittmann, Digital Painting, 120k, Ultra Hd, Hyper Detailed, Complimentary Colors, <span class="ltx_text ltx_framed ltx_framed_underline" id="A2.F7.7.2.1">Wlop</span>, Digital Painting</span>; (3) <span class="ltx_text ltx_font_italic" id="A2.F7.8.3">Chic Fantasy Compositions, Ultra Detailed Artistic, Midnight Aura, Night Sky, Dreamy, Glowing, Glamour, Glimmer, Shadows, Oil On Canvas, Brush Strokes, Smooth, Ultra High Definition, 8k, Unreal Engine 5, Ultra Sharp Focus, Art By magali villeneuve, rossdraws, Intricate Artwork Masterpiece, Matte Painting Movie Poster</span>; (4) <span class="ltx_text ltx_font_italic" id="A2.F7.9.4">winter owl <span class="ltx_text ltx_framed ltx_framed_underline" id="A2.F7.9.4.1">black and white</span></span>; (5) <span class="ltx_text ltx_font_italic" id="A2.F7.10.5">You are standing at the foot of a lush green hill that stretches up towards the sky. As you look up, you notice <span class="ltx_text ltx_framed ltx_framed_underline" id="A2.F7.10.5.1">a beautiful house</span> perched at the very top, surrounded by vibrant flowers and towering trees. The sun is shining brightly, casting a warm glow over the entire landscape. You can hear the sound of a nearby waterfall and the gentle rustling of leaves as a gentle breeze passes through the trees. The sky is a deep shade of blue, with a few fluffy clouds drifting lazily overhead. As you take in the breathtaking scenery, you can’t help but feel a sense of peace and serenity wash over you</span>.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_figure" id="A2.F8"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="486" id="A2.F8.g1" src="https://arxiv.org/html/2410.05255v1/x7.png" width="830">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 8: </span>Text-to-video generation results of AnimateDiff (Raw), SFT, and SePPO. Prompt: “<span class="ltx_text ltx_font_italic" id="A2.F8.2.1">Time-lapse of <span class="ltx_text ltx_framed ltx_framed_underline" id="A2.F8.2.1.1">night transitioning to dawn</span> over a serene landscape with a reflective water body. It begins with a <span class="ltx_text ltx_framed ltx_framed_underline" id="A2.F8.2.1.2">starry</span> night sky and minimal light on the horizon, progressing through increasing light and a glowing horizon, culminating in a serene early morning with a bright sky, faint stars, and clear reflections in the water.</span>”</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_figure" id="A2.F9"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="486" id="A2.F9.g1" src="https://arxiv.org/html/2410.05255v1/x8.png" width="830">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 9: </span>Text-to-video generation results of AnimateDiff (Raw), SFT, and SePPO. Prompt: “<span class="ltx_text ltx_font_italic" id="A2.F9.2.1">Time-lapse of aurora borealis over a night sky: starting with green arcs, intensifying with pronounced streaks, and evolving into swirling patterns. The aurora <span class="ltx_text ltx_framed ltx_framed_underline" id="A2.F9.2.1.1">peaks</span> in vivid hues before gradually <span class="ltx_text ltx_framed ltx_framed_underline" id="A2.F9.2.1.2">fading</span> into a homogeneous glow on a steadily brightened horizon.</span>”</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</section>
</section>
</article>
</div>

</div>


<button type="button" class="btn btn-primary hover-rp-button" id="openForm">Report Issue</button><div class="modal" id="myForm" role="dialog" aria-labelledby="modal-title"><div class="modal-dialog"><form class="modal-content" id="myFormContent" enctype="multipart/form-data"><div class="modal-header" id="modal-header"><h5 class="modal-title">Report Github Issue</h5><button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button></div><div class="modal-body"><label for="form_title" id="modalTitle">Title:</label><input class="form-control" id="form_title" name="form_title" required="required" placeholder="Enter title"><label for="description" id="selectedTextModalDescription" style="display: none;">Content selection saved. Describe the issue below:</label><label for="description" id="nomralModalDescription">Description:</label><textarea class="form-control" id="description" name="description" required="required" style="height: 80px;" maxlength="500" placeholder="500 characters maximum"></textarea></div><div class="modal-footer d-flex justify-content-end"><button type="submit" class="sr-only button" id="modal-submit-sr">Submit without Github</button><button type="submit" class="btn btn-primary" id="modal-submit">Submit in Github</button></div></form></div></div><button id="small-report-button" type="button" class="btn btn-secondary btn-sm" style="background-color: rgb(179, 27, 27); position: fixed;">Report Issue for Selection</button><div class="ltx_page_footer">
        <div class="ltx_page_logo">
            Generated by
            <a href="https://math.nist.gov/~BMiller/LaTeXML/" class="ltx_LaTeXML_logo">
                <span style="letter-spacing: -0.2em; margin-right: 0.1em;">
                    L
                    <span style="font-size: 70%; position: relative; bottom: 2.2pt;">A</span>
                    T
                    <span style="position: relative; bottom: -0.4ex;">E</span>
                </span>
                <span class="ltx_font_smallcaps">xml</span>
                <img alt="[LOGO]" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==">
            </a>
        </div></div><footer id="footer" class="ltx_document">
        <div class="keyboard-glossary">
            <h2>Instructions for reporting errors</h2>
            <p>We are continuing to improve HTML versions of papers, and your feedback helps enhance accessibility and mobile support. To report errors in the HTML that will help us improve conversion and rendering, choose any of the methods listed below:</p>
            <ul>
                <li>Click the "Report Issue" button.</li>
                <li>Open a report feedback form via keyboard, use "<strong>Ctrl + ?</strong>".</li>
                <li>Make a text selection and click the "Report Issue for Selection" button near your cursor.</li>
                <li class="sr-only">You can use Alt+Y to toggle on and Alt+Shift+Y to toggle off accessible reporting links at each section.</li>
            </ul>
            <p>Our team has already identified <a class="ltx_ref" href="https://github.com/arXiv/html_feedback/issues" target="_blank">the following issues</a>. We appreciate your time reviewing and reporting rendering errors we may not have found yet. Your efforts will help us improve the HTML versions for all readers, because disability should not be a barrier to accessing research. Thank you for your continued support in championing open access for all.</p>
            <p>Have a free development cycle? Help support accessibility at arXiv! Our collaborators at LaTeXML maintain a <a class="ltx_ref" href="https://github.com/brucemiller/LaTeXML/wiki/Porting-LaTeX-packages-for-LaTeXML" target="_blank">list of packages that need conversion</a>, and welcome <a class="ltx_ref" href="https://github.com/brucemiller/LaTeXML/issues" target="_blank">developer contributions</a>.</p>
        </div>
    </footer></body></html>