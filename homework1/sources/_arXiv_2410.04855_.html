<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>Unsupervised Skill Discovery for Robotic Manipulation through Automatic Task Generation</title>
<!--Generated on Mon Oct  7 09:05:31 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<base href="/html/2410.04855v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.04855v1#S1" title="In Unsupervised Skill Discovery for Robotic Manipulation through Automatic Task Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">I </span><span class="ltx_text ltx_font_smallcaps">Introduction</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.04855v1#S2" title="In Unsupervised Skill Discovery for Robotic Manipulation through Automatic Task Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">II </span><span class="ltx_text ltx_font_smallcaps">Related Work</span></span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.04855v1#S2.SS0.SSS0.Px1" title="In II Related Work ‣ Unsupervised Skill Discovery for Robotic Manipulation through Automatic Task Generation"><span class="ltx_text ltx_ref_title">Skill Learning</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.04855v1#S2.SS0.SSS0.Px2" title="In II Related Work ‣ Unsupervised Skill Discovery for Robotic Manipulation through Automatic Task Generation"><span class="ltx_text ltx_ref_title">Pre-Training and Automatic Task Generation</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.04855v1#S3" title="In Unsupervised Skill Discovery for Robotic Manipulation through Automatic Task Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">III </span><span class="ltx_text ltx_font_smallcaps">Preliminaries</span></span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04855v1#S3.SS1" title="In III Preliminaries ‣ Unsupervised Skill Discovery for Robotic Manipulation through Automatic Task Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">III-A</span> </span><span class="ltx_text ltx_font_italic">Reinforcement Learning and Goal-Conditioning</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04855v1#S3.SS2" title="In III Preliminaries ‣ Unsupervised Skill Discovery for Robotic Manipulation through Automatic Task Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">III-B</span> </span><span class="ltx_text ltx_font_italic">Multiplicative Compositional Policy</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04855v1#S3.SS3" title="In III Preliminaries ‣ Unsupervised Skill Discovery for Robotic Manipulation through Automatic Task Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">III-C</span> </span><span class="ltx_text ltx_font_italic">Asymmetric Self-Play</span></span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.04855v1#S4" title="In Unsupervised Skill Discovery for Robotic Manipulation through Automatic Task Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">IV </span><span class="ltx_text ltx_font_smallcaps">Method</span></span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04855v1#S4.SS1" title="In IV Method ‣ Unsupervised Skill Discovery for Robotic Manipulation through Automatic Task Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">IV-A</span> </span><span class="ltx_text ltx_font_italic">Discovering Behaviors through Tasks Diversity</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04855v1#S4.SS2" title="In IV Method ‣ Unsupervised Skill Discovery for Robotic Manipulation through Automatic Task Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">IV-B</span> </span><span class="ltx_text ltx_font_italic">Embedding Behaviors in Composable Primitives</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04855v1#S4.SS3" title="In IV Method ‣ Unsupervised Skill Discovery for Robotic Manipulation through Automatic Task Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">IV-C</span> </span><span class="ltx_text ltx_font_italic">Composing Primitives to Solve Downstream Tasks</span></span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.04855v1#S5" title="In Unsupervised Skill Discovery for Robotic Manipulation through Automatic Task Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">V </span><span class="ltx_text ltx_font_smallcaps">Experimental Setup</span></span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04855v1#S5.SS1" title="In V Experimental Setup ‣ Unsupervised Skill Discovery for Robotic Manipulation through Automatic Task Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">V-A</span> </span><span class="ltx_text ltx_font_italic">Tasks</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04855v1#S5.SS2" title="In V Experimental Setup ‣ Unsupervised Skill Discovery for Robotic Manipulation through Automatic Task Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">V-B</span> </span><span class="ltx_text ltx_font_italic">Baselines</span></span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.04855v1#S6" title="In Unsupervised Skill Discovery for Robotic Manipulation through Automatic Task Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">VI </span><span class="ltx_text ltx_font_smallcaps">Evaluation</span></span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04855v1#S6.SS1" title="In VI Evaluation ‣ Unsupervised Skill Discovery for Robotic Manipulation through Automatic Task Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">VI-A</span> </span><span class="ltx_text ltx_font_italic">Primitives Progression through Pre-Training</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04855v1#S6.SS2" title="In VI Evaluation ‣ Unsupervised Skill Discovery for Robotic Manipulation through Automatic Task Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">VI-B</span> </span><span class="ltx_text ltx_font_italic">Primitives Orchestration on Downstream Tasks</span></span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.04855v1#S7" title="In Unsupervised Skill Discovery for Robotic Manipulation through Automatic Task Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">VII </span><span class="ltx_text ltx_font_smallcaps">Conclusion</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.04855v1#S8" title="In Unsupervised Skill Discovery for Robotic Manipulation through Automatic Task Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">VIII </span><span class="ltx_text ltx_font_smallcaps">Appendix</span></span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.04855v1#S8.SS1" title="In VIII Appendix ‣ Unsupervised Skill Discovery for Robotic Manipulation through Automatic Task Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">VIII-A</span> </span><span class="ltx_text ltx_font_italic">Environment</span></span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04855v1#S8.SS1.SSS1" title="In VIII-A Environment ‣ VIII Appendix ‣ Unsupervised Skill Discovery for Robotic Manipulation through Automatic Task Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">VIII-A</span>1 </span>State</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04855v1#S8.SS1.SSS2" title="In VIII-A Environment ‣ VIII Appendix ‣ Unsupervised Skill Discovery for Robotic Manipulation through Automatic Task Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">VIII-A</span>2 </span>Action</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04855v1#S8.SS1.SSS3" title="In VIII-A Environment ‣ VIII Appendix ‣ Unsupervised Skill Discovery for Robotic Manipulation through Automatic Task Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">VIII-A</span>3 </span>Reward</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04855v1#S8.SS2" title="In VIII Appendix ‣ Unsupervised Skill Discovery for Robotic Manipulation through Automatic Task Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">VIII-B</span> </span><span class="ltx_text ltx_font_italic">Implementation Details</span></span></a></li>
</ol>
</li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_font_bold ltx_title_document" style="font-size:173%;">Unsupervised Skill Discovery for Robotic Manipulation through Automatic Task Generation
</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Paul Jansonnie<sup class="ltx_sup" id="id12.12.id1"><span class="ltx_text ltx_font_italic" id="id12.12.id1.1">12</span></sup>, Bingbing Wu<sup class="ltx_sup" id="id13.13.id2"><span class="ltx_text ltx_font_italic" id="id13.13.id2.1">1</span></sup>, Julien Perez<sup class="ltx_sup" id="id14.14.id3"><span class="ltx_text ltx_font_italic" id="id14.14.id3.1">3†</span></sup> and Jan Peters<sup class="ltx_sup" id="id15.15.id4"><span class="ltx_text ltx_font_italic" id="id15.15.id4.1">2456</span></sup>
</span><span class="ltx_author_notes"><sup class="ltx_sup" id="id16.16.id1"><span class="ltx_text ltx_font_italic" id="id16.16.id1.1">1</span></sup>NAVER LABS Europe, 6 chemin de Maupertuis, Meylan, 38240, France.
email: <span class="ltx_text ltx_font_typewriter" id="id17.17.id2" style="font-size:90%;">firstname.lastname@naverlabs.com</span><sup class="ltx_sup" id="id18.18.id1"><span class="ltx_text ltx_font_italic" id="id18.18.id1.1">2</span></sup>Department of Computer Science, TU Darmstadt, Germany. email: <span class="ltx_text ltx_font_typewriter" id="id19.19.id2" style="font-size:90%;">firstname.lastname@tu-darmstadt.de</span><sup class="ltx_sup" id="id20.20.id1"><span class="ltx_text ltx_font_italic" id="id20.20.id1.1">3</span></sup>EPITA Research Laboratory (LRE), FR-94276 Le Kremlin-Bicêtre, France. <span class="ltx_text ltx_font_typewriter" id="id21.21.id2" style="font-size:90%;">firstname.lastname@epita.fr</span><sup class="ltx_sup" id="id22.22.id1"><span class="ltx_text ltx_font_italic" id="id22.22.id1.1">4</span></sup>German Research Center for AI (DFKI), Systems AI for Robot Learning<sup class="ltx_sup" id="id23.23.id1"><span class="ltx_text ltx_font_italic" id="id23.23.id1.1">5</span></sup>Center for Cognitive Science, TU Darmstadt, Germany<sup class="ltx_sup" id="id24.24.id1"><span class="ltx_text ltx_font_italic" id="id24.24.id1.1">6</span></sup>Hessian Center for Artificial Intelligence (Hessian.ai), Germany<sup class="ltx_sup" id="id25.25.id1"><span class="ltx_text ltx_font_italic" id="id25.25.id1.1">†</span></sup>Work done at Naver Labs Europe</span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id26.id1">Learning skills that interact with objects is of major importance for robotic manipulation.
These skills can indeed serve as an efficient prior for solving various manipulation tasks.
We propose a novel Skill Learning approach that discovers composable behaviors by solving a large and diverse number of autonomously generated tasks.
Our method learns skills allowing the robot to consistently and robustly interact with objects in its environment.
The discovered behaviors are embedded in primitives which can be composed with Hierarchical Reinforcement Learning to solve unseen manipulation tasks.
In particular, we leverage Asymmetric Self-Play to discover behaviors and Multiplicative Compositional Policies to embed them.
We compare our method to Skill Learning baselines and find that our skills are more interactive.
Furthermore, the learned skills can be used to solve a set of unseen manipulation tasks, in simulation as well as on a real robotic platform.</p>
</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">I </span><span class="ltx_text ltx_font_smallcaps" id="S1.1.1">Introduction</span>
</h2>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">Robotic manipulation is notorious for being a challenging problem for Reinforcement Learning (RL), especially for Goal-Conditioned RL (GCRL).
Manipulation tasks are indeed often associated with <span class="ltx_text ltx_font_italic" id="S1.p1.1.1">sparse</span> rewards <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04855v1#bib.bib1" title="">1</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04855v1#bib.bib2" title="">2</a>]</cite>, which dramatically increases the complexity of learning a successful policy.
One classic example is the task of moving an object from an initial position to a target position, also known as a pick-and-place task.
This task involves complex contact reasoning, fine control of the robotic manipulator, and possibly safety constraints.
Learning to solve such a task usually requires reward shaping <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04855v1#bib.bib3" title="">3</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04855v1#bib.bib4" title="">4</a>]</cite>, hindsight relabeling <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04855v1#bib.bib5" title="">5</a>]</cite> or human demonstrations <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04855v1#bib.bib6" title="">6</a>]</cite>.
An alternative is the use of pre-trained behaviors, also known as skills or primitives.
To cope with the complexity of training manipulation policies from scratch, Hierarchical Reinforcement Learning (HRL) proposes orchestrating pre-trained behaviors.
Reusing a repertoire of pre-trained skills aims at increasing the probability of success, e.g., by making interactions with objects more frequent and consistent.
In HRL, an orchestrator policy is trained to reuse pre-trained skills, which allows for maintaining a usable reward signal from the environment.</p>
</div>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">Skill Discovery, or Skill Learning, is a family of methods that focus on autonomously discovering behaviors such that they can then be reused, e.g., with HRL.
The most popular approaches rely on task-agnostic intrinsic rewards based on the mutual information between a skill descriptor and a transformation of the state of the environment <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04855v1#bib.bib7" title="">7</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04855v1#bib.bib8" title="">8</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04855v1#bib.bib9" title="">9</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04855v1#bib.bib10" title="">10</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04855v1#bib.bib11" title="">11</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04855v1#bib.bib12" title="">12</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04855v1#bib.bib13" title="">13</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04855v1#bib.bib14" title="">14</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04855v1#bib.bib15" title="">15</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04855v1#bib.bib16" title="">16</a>]</cite>.
While these methods usually produce reusable behaviors in locomotion settings, they often fail to produce useful skills for manipulation, i.e., skills that yield interactions between the robot and objects in the scene. This property limits their reusability for learning downstream manipulation tasks with HRL.
Furthermore, the discovered skills must not only yield interactions with objects, but these interactions must be diverse for reuse in a large set of downstream tasks.</p>
</div>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">This lack of meaningful interactions is the main struggle in Skill Learning for manipulation and is a direct consequence of the sparsity of the intrinsic reward based on mutual information.</p>
</div>
<div class="ltx_para" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">In this work, we propose a Skill Learning method for robotic manipulation that discovers behaviors enabling the robot to purposely interact with objects in the environment.
As depicted in Figure <span class="ltx_ref ltx_missing_label ltx_ref_self">LABEL:fig:method</span>, our approach relies on pre-training skills to solve automatically generated tasks, which leads to the discovery of diverse and complex behaviors that can be composed on downstream tasks with HRL.
We propose to leverage Asymmetric Self-Play (ASP) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04855v1#bib.bib17" title="">17</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04855v1#bib.bib18" title="">18</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04855v1#bib.bib19" title="">19</a>]</cite> to generate a wide diversity of increasingly difficult tasks and pre-train a Multiplicative Compositional Policy (MCP) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04855v1#bib.bib20" title="">20</a>]</cite> to solve the generated tasks.
The discovered behaviors are embedded in the primitives of the policy, which are later reused to solve downstream tasks, that could otherwise not be solved neither with skills learned with current Skill Discovery methods nor with policies trained without priors.
This curriculum induced by ASP enables the skill repertoire to efficiently capture increasingly diverse and complex behaviors in a self-supervised fashion, without the need for complex reward-shaping.
We evaluate the learned skills on a set of unseen downstream manipulation tasks, which are variants of pick-and-place tasks with modifications of the dynamics, such as the introduction of an obstacle in the scene.
We show that our skills achieve higher performance than skills from other approaches on most downstream tasks when orchestrated with HRL.
Our findings demonstrate that learning an orchestrator on top of our pre-trained skills is comparable to or better than ASP and MCP used in isolation on most downstream tasks. Finally, we provide evidence that our skills outperform Hindsight Experience Replay <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04855v1#bib.bib5" title="">5</a>]</cite> on several tasks. Beyond simulation, we confirm that our approach transfers to a real-world manipulation platform.</p>
</div>
<div class="ltx_para" id="S1.p5">
<p class="ltx_p" id="S1.p5.1">In summary, our contributions are the following:
(1) we propose a novel approach for reusable Skill Learning based on Asymmetric Self-Play and Multiplicative Compositional Policies,
(2) we perform a qualitative evaluation of the resulting skills,
(3) we evaluate our approach against state-of-the-art Skill Learning approaches on downstream tasks.</p>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">II </span><span class="ltx_text ltx_font_smallcaps" id="S2.1.1">Related Work</span>
</h2>
<section class="ltx_paragraph" id="S2.SS0.SSS0.Px1">
<h5 class="ltx_title ltx_title_paragraph">Skill Learning</h5>
<div class="ltx_para" id="S2.SS0.SSS0.Px1.p1">
<p class="ltx_p" id="S2.SS0.SSS0.Px1.p1.2">A large collection of work studies the problem of learning reusable skills. Latent variable methods <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04855v1#bib.bib7" title="">7</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04855v1#bib.bib8" title="">8</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04855v1#bib.bib9" title="">9</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04855v1#bib.bib10" title="">10</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04855v1#bib.bib11" title="">11</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04855v1#bib.bib12" title="">12</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04855v1#bib.bib13" title="">13</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04855v1#bib.bib14" title="">14</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04855v1#bib.bib15" title="">15</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04855v1#bib.bib16" title="">16</a>]</cite> learn skills by maximizing the mutual information between a transformation of the environment state <math alttext="s" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p1.1.m1.1"><semantics id="S2.SS0.SSS0.Px1.p1.1.m1.1a"><mi id="S2.SS0.SSS0.Px1.p1.1.m1.1.1" xref="S2.SS0.SSS0.Px1.p1.1.m1.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p1.1.m1.1b"><ci id="S2.SS0.SSS0.Px1.p1.1.m1.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.1.m1.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p1.1.m1.1c">s</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.p1.1.m1.1d">italic_s</annotation></semantics></math> and a latent skill descriptor <math alttext="z" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p1.2.m2.1"><semantics id="S2.SS0.SSS0.Px1.p1.2.m2.1a"><mi id="S2.SS0.SSS0.Px1.p1.2.m2.1.1" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p1.2.m2.1b"><ci id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1">𝑧</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p1.2.m2.1c">z</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.p1.2.m2.1d">italic_z</annotation></semantics></math>.
Option architectures <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04855v1#bib.bib21" title="">21</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04855v1#bib.bib22" title="">22</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04855v1#bib.bib23" title="">23</a>]</cite> learn to decompose tasks into a set of sub-goals, or options.
Multiplicative Compositional Policies <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04855v1#bib.bib20" title="">20</a>]</cite> learn to decompose behaviors in distinct Gaussian distributions that can be re-composed to yield more complicated behaviors. Our approach is similar to latent variable methods as we learn skills in an unsupervised manner.
However, our training objective is not based on mutual information but rather on the usability of our skills in a manipulation scenario.
Furthermore, contrary to latent variable methods, our approach explicitly learns skills that are composable to solve manipulation tasks.
Our method is most similar to the latter family of approaches as we also rely on an MCP.
However, our work differs from the pre-training objective of the MCP.
While <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04855v1#bib.bib20" title="">20</a>]</cite> pre-trains primitives from cherry-picked demonstrations and <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04855v1#bib.bib24" title="">24</a>]</cite> learns them using an objective based on mutual information, we pre-train our primitives to maximize their usability on automatically generated tasks.</p>
</div>
</section>
<section class="ltx_paragraph" id="S2.SS0.SSS0.Px2">
<h5 class="ltx_title ltx_title_paragraph">Pre-Training and Automatic Task Generation</h5>
<div class="ltx_para" id="S2.SS0.SSS0.Px2.p1">
<p class="ltx_p" id="S2.SS0.SSS0.Px2.p1.1">Many works show the difficulty of learning complex tasks with RL and propose automated curricula <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04855v1#bib.bib5" title="">5</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04855v1#bib.bib25" title="">25</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04855v1#bib.bib26" title="">26</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04855v1#bib.bib27" title="">27</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04855v1#bib.bib28" title="">28</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04855v1#bib.bib29" title="">29</a>]</cite> or auxiliary exploration objectives <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04855v1#bib.bib30" title="">30</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04855v1#bib.bib31" title="">31</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04855v1#bib.bib32" title="">32</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04855v1#bib.bib33" title="">33</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04855v1#bib.bib34" title="">34</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04855v1#bib.bib35" title="">35</a>]</cite> to learn <span class="ltx_text ltx_font_italic" id="S2.SS0.SSS0.Px2.p1.1.1">predefined tasks</span>.
When training goal-conditioned policies, relabeling or reversing trajectories <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04855v1#bib.bib5" title="">5</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04855v1#bib.bib25" title="">25</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04855v1#bib.bib26" title="">26</a>]</cite> or imitating successful demonstrations <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04855v1#bib.bib36" title="">36</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04855v1#bib.bib34" title="">34</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04855v1#bib.bib35" title="">35</a>]</cite> naturally reduces the task complexity.
Open-ended methods <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04855v1#bib.bib37" title="">37</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04855v1#bib.bib38" title="">38</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04855v1#bib.bib39" title="">39</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04855v1#bib.bib40" title="">40</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04855v1#bib.bib41" title="">41</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04855v1#bib.bib42" title="">42</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04855v1#bib.bib43" title="">43</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04855v1#bib.bib44" title="">44</a>]</cite> automatically generate increasingly complicated tasks to train an agent that discovers behaviors in an environment.
Among these methods is Asymmetric Self-Play  <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04855v1#bib.bib17" title="">17</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04855v1#bib.bib18" title="">18</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04855v1#bib.bib19" title="">19</a>]</cite>, which was shown to produce diverse tasks and solutions in the context of robotic manipulation.</p>
</div>
<div class="ltx_para" id="S2.SS0.SSS0.Px2.p2">
<p class="ltx_p" id="S2.SS0.SSS0.Px2.p2.1">A limitation of <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04855v1#bib.bib19" title="">19</a>]</cite> is that the trained agent uses a monolithic policy, which reduces the reusability of the learned behaviors in new scenarios.
Our approach is most similar to <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04855v1#bib.bib19" title="">19</a>]</cite> but differs in the fact we only use ASP as a pre-training of skills that can then be reused with HRL on novel tasks.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">III </span><span class="ltx_text ltx_font_smallcaps" id="S3.1.1">Preliminaries</span>
</h2>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S3.SS1.4.1.1">III-A</span> </span><span class="ltx_text ltx_font_italic" id="S3.SS1.5.2">Reinforcement Learning and Goal-Conditioning</span>
</h3>
<div class="ltx_para" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.15">We consider an environment with a state space <math alttext="\mathcal{S}" class="ltx_Math" display="inline" id="S3.SS1.p1.1.m1.1"><semantics id="S3.SS1.p1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml">𝒮</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><ci id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">𝒮</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">\mathcal{S}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.1.m1.1d">caligraphic_S</annotation></semantics></math>, an action space <math alttext="\mathcal{A}" class="ltx_Math" display="inline" id="S3.SS1.p1.2.m2.1"><semantics id="S3.SS1.p1.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.2.m2.1.1" xref="S3.SS1.p1.2.m2.1.1.cmml">𝒜</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.1b"><ci id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1">𝒜</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.1c">\mathcal{A}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.2.m2.1d">caligraphic_A</annotation></semantics></math>, a state transition probability <math alttext="p(s_{t+1}|s_{t},a_{t})" class="ltx_Math" display="inline" id="S3.SS1.p1.3.m3.1"><semantics id="S3.SS1.p1.3.m3.1a"><mrow id="S3.SS1.p1.3.m3.1.1" xref="S3.SS1.p1.3.m3.1.1.cmml"><mi id="S3.SS1.p1.3.m3.1.1.3" xref="S3.SS1.p1.3.m3.1.1.3.cmml">p</mi><mo id="S3.SS1.p1.3.m3.1.1.2" xref="S3.SS1.p1.3.m3.1.1.2.cmml">⁢</mo><mrow id="S3.SS1.p1.3.m3.1.1.1.1" xref="S3.SS1.p1.3.m3.1.1.1.1.1.cmml"><mo id="S3.SS1.p1.3.m3.1.1.1.1.2" stretchy="false" xref="S3.SS1.p1.3.m3.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS1.p1.3.m3.1.1.1.1.1" xref="S3.SS1.p1.3.m3.1.1.1.1.1.cmml"><msub id="S3.SS1.p1.3.m3.1.1.1.1.1.4" xref="S3.SS1.p1.3.m3.1.1.1.1.1.4.cmml"><mi id="S3.SS1.p1.3.m3.1.1.1.1.1.4.2" xref="S3.SS1.p1.3.m3.1.1.1.1.1.4.2.cmml">s</mi><mrow id="S3.SS1.p1.3.m3.1.1.1.1.1.4.3" xref="S3.SS1.p1.3.m3.1.1.1.1.1.4.3.cmml"><mi id="S3.SS1.p1.3.m3.1.1.1.1.1.4.3.2" xref="S3.SS1.p1.3.m3.1.1.1.1.1.4.3.2.cmml">t</mi><mo id="S3.SS1.p1.3.m3.1.1.1.1.1.4.3.1" xref="S3.SS1.p1.3.m3.1.1.1.1.1.4.3.1.cmml">+</mo><mn id="S3.SS1.p1.3.m3.1.1.1.1.1.4.3.3" xref="S3.SS1.p1.3.m3.1.1.1.1.1.4.3.3.cmml">1</mn></mrow></msub><mo fence="false" id="S3.SS1.p1.3.m3.1.1.1.1.1.3" xref="S3.SS1.p1.3.m3.1.1.1.1.1.3.cmml">|</mo><mrow id="S3.SS1.p1.3.m3.1.1.1.1.1.2.2" xref="S3.SS1.p1.3.m3.1.1.1.1.1.2.3.cmml"><msub id="S3.SS1.p1.3.m3.1.1.1.1.1.1.1.1" xref="S3.SS1.p1.3.m3.1.1.1.1.1.1.1.1.cmml"><mi id="S3.SS1.p1.3.m3.1.1.1.1.1.1.1.1.2" xref="S3.SS1.p1.3.m3.1.1.1.1.1.1.1.1.2.cmml">s</mi><mi id="S3.SS1.p1.3.m3.1.1.1.1.1.1.1.1.3" xref="S3.SS1.p1.3.m3.1.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.SS1.p1.3.m3.1.1.1.1.1.2.2.3" xref="S3.SS1.p1.3.m3.1.1.1.1.1.2.3.cmml">,</mo><msub id="S3.SS1.p1.3.m3.1.1.1.1.1.2.2.2" xref="S3.SS1.p1.3.m3.1.1.1.1.1.2.2.2.cmml"><mi id="S3.SS1.p1.3.m3.1.1.1.1.1.2.2.2.2" xref="S3.SS1.p1.3.m3.1.1.1.1.1.2.2.2.2.cmml">a</mi><mi id="S3.SS1.p1.3.m3.1.1.1.1.1.2.2.2.3" xref="S3.SS1.p1.3.m3.1.1.1.1.1.2.2.2.3.cmml">t</mi></msub></mrow></mrow><mo id="S3.SS1.p1.3.m3.1.1.1.1.3" stretchy="false" xref="S3.SS1.p1.3.m3.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.1b"><apply id="S3.SS1.p1.3.m3.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1"><times id="S3.SS1.p1.3.m3.1.1.2.cmml" xref="S3.SS1.p1.3.m3.1.1.2"></times><ci id="S3.SS1.p1.3.m3.1.1.3.cmml" xref="S3.SS1.p1.3.m3.1.1.3">𝑝</ci><apply id="S3.SS1.p1.3.m3.1.1.1.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1.1.1"><csymbol cd="latexml" id="S3.SS1.p1.3.m3.1.1.1.1.1.3.cmml" xref="S3.SS1.p1.3.m3.1.1.1.1.1.3">conditional</csymbol><apply id="S3.SS1.p1.3.m3.1.1.1.1.1.4.cmml" xref="S3.SS1.p1.3.m3.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.1.1.1.1.1.4.1.cmml" xref="S3.SS1.p1.3.m3.1.1.1.1.1.4">subscript</csymbol><ci id="S3.SS1.p1.3.m3.1.1.1.1.1.4.2.cmml" xref="S3.SS1.p1.3.m3.1.1.1.1.1.4.2">𝑠</ci><apply id="S3.SS1.p1.3.m3.1.1.1.1.1.4.3.cmml" xref="S3.SS1.p1.3.m3.1.1.1.1.1.4.3"><plus id="S3.SS1.p1.3.m3.1.1.1.1.1.4.3.1.cmml" xref="S3.SS1.p1.3.m3.1.1.1.1.1.4.3.1"></plus><ci id="S3.SS1.p1.3.m3.1.1.1.1.1.4.3.2.cmml" xref="S3.SS1.p1.3.m3.1.1.1.1.1.4.3.2">𝑡</ci><cn id="S3.SS1.p1.3.m3.1.1.1.1.1.4.3.3.cmml" type="integer" xref="S3.SS1.p1.3.m3.1.1.1.1.1.4.3.3">1</cn></apply></apply><list id="S3.SS1.p1.3.m3.1.1.1.1.1.2.3.cmml" xref="S3.SS1.p1.3.m3.1.1.1.1.1.2.2"><apply id="S3.SS1.p1.3.m3.1.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.3.m3.1.1.1.1.1.1.1.1.2.cmml" xref="S3.SS1.p1.3.m3.1.1.1.1.1.1.1.1.2">𝑠</ci><ci id="S3.SS1.p1.3.m3.1.1.1.1.1.1.1.1.3.cmml" xref="S3.SS1.p1.3.m3.1.1.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="S3.SS1.p1.3.m3.1.1.1.1.1.2.2.2.cmml" xref="S3.SS1.p1.3.m3.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.1.1.1.1.1.2.2.2.1.cmml" xref="S3.SS1.p1.3.m3.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S3.SS1.p1.3.m3.1.1.1.1.1.2.2.2.2.cmml" xref="S3.SS1.p1.3.m3.1.1.1.1.1.2.2.2.2">𝑎</ci><ci id="S3.SS1.p1.3.m3.1.1.1.1.1.2.2.2.3.cmml" xref="S3.SS1.p1.3.m3.1.1.1.1.1.2.2.2.3">𝑡</ci></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.1c">p(s_{t+1}|s_{t},a_{t})</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.3.m3.1d">italic_p ( italic_s start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT | italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math>, where <math alttext="s_{t}\in\mathcal{S}" class="ltx_Math" display="inline" id="S3.SS1.p1.4.m4.1"><semantics id="S3.SS1.p1.4.m4.1a"><mrow id="S3.SS1.p1.4.m4.1.1" xref="S3.SS1.p1.4.m4.1.1.cmml"><msub id="S3.SS1.p1.4.m4.1.1.2" xref="S3.SS1.p1.4.m4.1.1.2.cmml"><mi id="S3.SS1.p1.4.m4.1.1.2.2" xref="S3.SS1.p1.4.m4.1.1.2.2.cmml">s</mi><mi id="S3.SS1.p1.4.m4.1.1.2.3" xref="S3.SS1.p1.4.m4.1.1.2.3.cmml">t</mi></msub><mo id="S3.SS1.p1.4.m4.1.1.1" xref="S3.SS1.p1.4.m4.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.4.m4.1.1.3" xref="S3.SS1.p1.4.m4.1.1.3.cmml">𝒮</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m4.1b"><apply id="S3.SS1.p1.4.m4.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1"><in id="S3.SS1.p1.4.m4.1.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1.1"></in><apply id="S3.SS1.p1.4.m4.1.1.2.cmml" xref="S3.SS1.p1.4.m4.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m4.1.1.2.1.cmml" xref="S3.SS1.p1.4.m4.1.1.2">subscript</csymbol><ci id="S3.SS1.p1.4.m4.1.1.2.2.cmml" xref="S3.SS1.p1.4.m4.1.1.2.2">𝑠</ci><ci id="S3.SS1.p1.4.m4.1.1.2.3.cmml" xref="S3.SS1.p1.4.m4.1.1.2.3">𝑡</ci></apply><ci id="S3.SS1.p1.4.m4.1.1.3.cmml" xref="S3.SS1.p1.4.m4.1.1.3">𝒮</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m4.1c">s_{t}\in\mathcal{S}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.4.m4.1d">italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∈ caligraphic_S</annotation></semantics></math>, <math alttext="s_{t+1}\in\mathcal{S}" class="ltx_Math" display="inline" id="S3.SS1.p1.5.m5.1"><semantics id="S3.SS1.p1.5.m5.1a"><mrow id="S3.SS1.p1.5.m5.1.1" xref="S3.SS1.p1.5.m5.1.1.cmml"><msub id="S3.SS1.p1.5.m5.1.1.2" xref="S3.SS1.p1.5.m5.1.1.2.cmml"><mi id="S3.SS1.p1.5.m5.1.1.2.2" xref="S3.SS1.p1.5.m5.1.1.2.2.cmml">s</mi><mrow id="S3.SS1.p1.5.m5.1.1.2.3" xref="S3.SS1.p1.5.m5.1.1.2.3.cmml"><mi id="S3.SS1.p1.5.m5.1.1.2.3.2" xref="S3.SS1.p1.5.m5.1.1.2.3.2.cmml">t</mi><mo id="S3.SS1.p1.5.m5.1.1.2.3.1" xref="S3.SS1.p1.5.m5.1.1.2.3.1.cmml">+</mo><mn id="S3.SS1.p1.5.m5.1.1.2.3.3" xref="S3.SS1.p1.5.m5.1.1.2.3.3.cmml">1</mn></mrow></msub><mo id="S3.SS1.p1.5.m5.1.1.1" xref="S3.SS1.p1.5.m5.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.5.m5.1.1.3" xref="S3.SS1.p1.5.m5.1.1.3.cmml">𝒮</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.m5.1b"><apply id="S3.SS1.p1.5.m5.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1"><in id="S3.SS1.p1.5.m5.1.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1.1"></in><apply id="S3.SS1.p1.5.m5.1.1.2.cmml" xref="S3.SS1.p1.5.m5.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p1.5.m5.1.1.2.1.cmml" xref="S3.SS1.p1.5.m5.1.1.2">subscript</csymbol><ci id="S3.SS1.p1.5.m5.1.1.2.2.cmml" xref="S3.SS1.p1.5.m5.1.1.2.2">𝑠</ci><apply id="S3.SS1.p1.5.m5.1.1.2.3.cmml" xref="S3.SS1.p1.5.m5.1.1.2.3"><plus id="S3.SS1.p1.5.m5.1.1.2.3.1.cmml" xref="S3.SS1.p1.5.m5.1.1.2.3.1"></plus><ci id="S3.SS1.p1.5.m5.1.1.2.3.2.cmml" xref="S3.SS1.p1.5.m5.1.1.2.3.2">𝑡</ci><cn id="S3.SS1.p1.5.m5.1.1.2.3.3.cmml" type="integer" xref="S3.SS1.p1.5.m5.1.1.2.3.3">1</cn></apply></apply><ci id="S3.SS1.p1.5.m5.1.1.3.cmml" xref="S3.SS1.p1.5.m5.1.1.3">𝒮</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.5.m5.1c">s_{t+1}\in\mathcal{S}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.5.m5.1d">italic_s start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT ∈ caligraphic_S</annotation></semantics></math>, <math alttext="a_{t}\in\mathcal{A}" class="ltx_Math" display="inline" id="S3.SS1.p1.6.m6.1"><semantics id="S3.SS1.p1.6.m6.1a"><mrow id="S3.SS1.p1.6.m6.1.1" xref="S3.SS1.p1.6.m6.1.1.cmml"><msub id="S3.SS1.p1.6.m6.1.1.2" xref="S3.SS1.p1.6.m6.1.1.2.cmml"><mi id="S3.SS1.p1.6.m6.1.1.2.2" xref="S3.SS1.p1.6.m6.1.1.2.2.cmml">a</mi><mi id="S3.SS1.p1.6.m6.1.1.2.3" xref="S3.SS1.p1.6.m6.1.1.2.3.cmml">t</mi></msub><mo id="S3.SS1.p1.6.m6.1.1.1" xref="S3.SS1.p1.6.m6.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.6.m6.1.1.3" xref="S3.SS1.p1.6.m6.1.1.3.cmml">𝒜</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.6.m6.1b"><apply id="S3.SS1.p1.6.m6.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1"><in id="S3.SS1.p1.6.m6.1.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1.1"></in><apply id="S3.SS1.p1.6.m6.1.1.2.cmml" xref="S3.SS1.p1.6.m6.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p1.6.m6.1.1.2.1.cmml" xref="S3.SS1.p1.6.m6.1.1.2">subscript</csymbol><ci id="S3.SS1.p1.6.m6.1.1.2.2.cmml" xref="S3.SS1.p1.6.m6.1.1.2.2">𝑎</ci><ci id="S3.SS1.p1.6.m6.1.1.2.3.cmml" xref="S3.SS1.p1.6.m6.1.1.2.3">𝑡</ci></apply><ci id="S3.SS1.p1.6.m6.1.1.3.cmml" xref="S3.SS1.p1.6.m6.1.1.3">𝒜</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.6.m6.1c">a_{t}\in\mathcal{A}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.6.m6.1d">italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∈ caligraphic_A</annotation></semantics></math> and <math alttext="t" class="ltx_Math" display="inline" id="S3.SS1.p1.7.m7.1"><semantics id="S3.SS1.p1.7.m7.1a"><mi id="S3.SS1.p1.7.m7.1.1" xref="S3.SS1.p1.7.m7.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.7.m7.1b"><ci id="S3.SS1.p1.7.m7.1.1.cmml" xref="S3.SS1.p1.7.m7.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.7.m7.1c">t</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.7.m7.1d">italic_t</annotation></semantics></math> denotes time, and a reward function <math alttext="\mathcal{R}:\mathcal{S}\times\mathcal{A}\rightarrow\mathbb{R}" class="ltx_Math" display="inline" id="S3.SS1.p1.8.m8.1"><semantics id="S3.SS1.p1.8.m8.1a"><mrow id="S3.SS1.p1.8.m8.1.1" xref="S3.SS1.p1.8.m8.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.8.m8.1.1.2" xref="S3.SS1.p1.8.m8.1.1.2.cmml">ℛ</mi><mo id="S3.SS1.p1.8.m8.1.1.1" lspace="0.278em" rspace="0.278em" xref="S3.SS1.p1.8.m8.1.1.1.cmml">:</mo><mrow id="S3.SS1.p1.8.m8.1.1.3" xref="S3.SS1.p1.8.m8.1.1.3.cmml"><mrow id="S3.SS1.p1.8.m8.1.1.3.2" xref="S3.SS1.p1.8.m8.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.8.m8.1.1.3.2.2" xref="S3.SS1.p1.8.m8.1.1.3.2.2.cmml">𝒮</mi><mo id="S3.SS1.p1.8.m8.1.1.3.2.1" lspace="0.222em" rspace="0.222em" xref="S3.SS1.p1.8.m8.1.1.3.2.1.cmml">×</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.8.m8.1.1.3.2.3" xref="S3.SS1.p1.8.m8.1.1.3.2.3.cmml">𝒜</mi></mrow><mo id="S3.SS1.p1.8.m8.1.1.3.1" stretchy="false" xref="S3.SS1.p1.8.m8.1.1.3.1.cmml">→</mo><mi id="S3.SS1.p1.8.m8.1.1.3.3" xref="S3.SS1.p1.8.m8.1.1.3.3.cmml">ℝ</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.8.m8.1b"><apply id="S3.SS1.p1.8.m8.1.1.cmml" xref="S3.SS1.p1.8.m8.1.1"><ci id="S3.SS1.p1.8.m8.1.1.1.cmml" xref="S3.SS1.p1.8.m8.1.1.1">:</ci><ci id="S3.SS1.p1.8.m8.1.1.2.cmml" xref="S3.SS1.p1.8.m8.1.1.2">ℛ</ci><apply id="S3.SS1.p1.8.m8.1.1.3.cmml" xref="S3.SS1.p1.8.m8.1.1.3"><ci id="S3.SS1.p1.8.m8.1.1.3.1.cmml" xref="S3.SS1.p1.8.m8.1.1.3.1">→</ci><apply id="S3.SS1.p1.8.m8.1.1.3.2.cmml" xref="S3.SS1.p1.8.m8.1.1.3.2"><times id="S3.SS1.p1.8.m8.1.1.3.2.1.cmml" xref="S3.SS1.p1.8.m8.1.1.3.2.1"></times><ci id="S3.SS1.p1.8.m8.1.1.3.2.2.cmml" xref="S3.SS1.p1.8.m8.1.1.3.2.2">𝒮</ci><ci id="S3.SS1.p1.8.m8.1.1.3.2.3.cmml" xref="S3.SS1.p1.8.m8.1.1.3.2.3">𝒜</ci></apply><ci id="S3.SS1.p1.8.m8.1.1.3.3.cmml" xref="S3.SS1.p1.8.m8.1.1.3.3">ℝ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.8.m8.1c">\mathcal{R}:\mathcal{S}\times\mathcal{A}\rightarrow\mathbb{R}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.8.m8.1d">caligraphic_R : caligraphic_S × caligraphic_A → blackboard_R</annotation></semantics></math>.
It formulates a Markov Decision Process (MDP), represented as a tuple <math alttext="(\mathcal{S},\mathcal{A},p,\mathcal{R})" class="ltx_Math" display="inline" id="S3.SS1.p1.9.m9.4"><semantics id="S3.SS1.p1.9.m9.4a"><mrow id="S3.SS1.p1.9.m9.4.5.2" xref="S3.SS1.p1.9.m9.4.5.1.cmml"><mo id="S3.SS1.p1.9.m9.4.5.2.1" stretchy="false" xref="S3.SS1.p1.9.m9.4.5.1.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.9.m9.1.1" xref="S3.SS1.p1.9.m9.1.1.cmml">𝒮</mi><mo id="S3.SS1.p1.9.m9.4.5.2.2" xref="S3.SS1.p1.9.m9.4.5.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.9.m9.2.2" xref="S3.SS1.p1.9.m9.2.2.cmml">𝒜</mi><mo id="S3.SS1.p1.9.m9.4.5.2.3" xref="S3.SS1.p1.9.m9.4.5.1.cmml">,</mo><mi id="S3.SS1.p1.9.m9.3.3" xref="S3.SS1.p1.9.m9.3.3.cmml">p</mi><mo id="S3.SS1.p1.9.m9.4.5.2.4" xref="S3.SS1.p1.9.m9.4.5.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.9.m9.4.4" xref="S3.SS1.p1.9.m9.4.4.cmml">ℛ</mi><mo id="S3.SS1.p1.9.m9.4.5.2.5" stretchy="false" xref="S3.SS1.p1.9.m9.4.5.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.9.m9.4b"><vector id="S3.SS1.p1.9.m9.4.5.1.cmml" xref="S3.SS1.p1.9.m9.4.5.2"><ci id="S3.SS1.p1.9.m9.1.1.cmml" xref="S3.SS1.p1.9.m9.1.1">𝒮</ci><ci id="S3.SS1.p1.9.m9.2.2.cmml" xref="S3.SS1.p1.9.m9.2.2">𝒜</ci><ci id="S3.SS1.p1.9.m9.3.3.cmml" xref="S3.SS1.p1.9.m9.3.3">𝑝</ci><ci id="S3.SS1.p1.9.m9.4.4.cmml" xref="S3.SS1.p1.9.m9.4.4">ℛ</ci></vector></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.9.m9.4c">(\mathcal{S},\mathcal{A},p,\mathcal{R})</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.9.m9.4d">( caligraphic_S , caligraphic_A , italic_p , caligraphic_R )</annotation></semantics></math>.
A solution to an MDP is a policy <math alttext="\pi" class="ltx_Math" display="inline" id="S3.SS1.p1.10.m10.1"><semantics id="S3.SS1.p1.10.m10.1a"><mi id="S3.SS1.p1.10.m10.1.1" xref="S3.SS1.p1.10.m10.1.1.cmml">π</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.10.m10.1b"><ci id="S3.SS1.p1.10.m10.1.1.cmml" xref="S3.SS1.p1.10.m10.1.1">𝜋</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.10.m10.1c">\pi</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.10.m10.1d">italic_π</annotation></semantics></math> which maps a state <math alttext="s_{t}\in\mathcal{S}" class="ltx_Math" display="inline" id="S3.SS1.p1.11.m11.1"><semantics id="S3.SS1.p1.11.m11.1a"><mrow id="S3.SS1.p1.11.m11.1.1" xref="S3.SS1.p1.11.m11.1.1.cmml"><msub id="S3.SS1.p1.11.m11.1.1.2" xref="S3.SS1.p1.11.m11.1.1.2.cmml"><mi id="S3.SS1.p1.11.m11.1.1.2.2" xref="S3.SS1.p1.11.m11.1.1.2.2.cmml">s</mi><mi id="S3.SS1.p1.11.m11.1.1.2.3" xref="S3.SS1.p1.11.m11.1.1.2.3.cmml">t</mi></msub><mo id="S3.SS1.p1.11.m11.1.1.1" xref="S3.SS1.p1.11.m11.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.11.m11.1.1.3" xref="S3.SS1.p1.11.m11.1.1.3.cmml">𝒮</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.11.m11.1b"><apply id="S3.SS1.p1.11.m11.1.1.cmml" xref="S3.SS1.p1.11.m11.1.1"><in id="S3.SS1.p1.11.m11.1.1.1.cmml" xref="S3.SS1.p1.11.m11.1.1.1"></in><apply id="S3.SS1.p1.11.m11.1.1.2.cmml" xref="S3.SS1.p1.11.m11.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p1.11.m11.1.1.2.1.cmml" xref="S3.SS1.p1.11.m11.1.1.2">subscript</csymbol><ci id="S3.SS1.p1.11.m11.1.1.2.2.cmml" xref="S3.SS1.p1.11.m11.1.1.2.2">𝑠</ci><ci id="S3.SS1.p1.11.m11.1.1.2.3.cmml" xref="S3.SS1.p1.11.m11.1.1.2.3">𝑡</ci></apply><ci id="S3.SS1.p1.11.m11.1.1.3.cmml" xref="S3.SS1.p1.11.m11.1.1.3">𝒮</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.11.m11.1c">s_{t}\in\mathcal{S}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.11.m11.1d">italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∈ caligraphic_S</annotation></semantics></math> to a probability distribution over actions, i.e. <math alttext="a_{t}\sim\pi(\cdot|s_{t})" class="ltx_math_unparsed" display="inline" id="S3.SS1.p1.12.m12.1"><semantics id="S3.SS1.p1.12.m12.1a"><mrow id="S3.SS1.p1.12.m12.1b"><msub id="S3.SS1.p1.12.m12.1.1"><mi id="S3.SS1.p1.12.m12.1.1.2">a</mi><mi id="S3.SS1.p1.12.m12.1.1.3">t</mi></msub><mo id="S3.SS1.p1.12.m12.1.2">∼</mo><mi id="S3.SS1.p1.12.m12.1.3">π</mi><mrow id="S3.SS1.p1.12.m12.1.4"><mo id="S3.SS1.p1.12.m12.1.4.1" stretchy="false">(</mo><mo id="S3.SS1.p1.12.m12.1.4.2" lspace="0em" rspace="0em">⋅</mo><mo fence="false" id="S3.SS1.p1.12.m12.1.4.3" rspace="0.167em" stretchy="false">|</mo><msub id="S3.SS1.p1.12.m12.1.4.4"><mi id="S3.SS1.p1.12.m12.1.4.4.2">s</mi><mi id="S3.SS1.p1.12.m12.1.4.4.3">t</mi></msub><mo id="S3.SS1.p1.12.m12.1.4.5" stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="S3.SS1.p1.12.m12.1c">a_{t}\sim\pi(\cdot|s_{t})</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.12.m12.1d">italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∼ italic_π ( ⋅ | italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math>.
The objective of Reinforcement Learning is to find an optimal policy <math alttext="\pi^{*}" class="ltx_Math" display="inline" id="S3.SS1.p1.13.m13.1"><semantics id="S3.SS1.p1.13.m13.1a"><msup id="S3.SS1.p1.13.m13.1.1" xref="S3.SS1.p1.13.m13.1.1.cmml"><mi id="S3.SS1.p1.13.m13.1.1.2" xref="S3.SS1.p1.13.m13.1.1.2.cmml">π</mi><mo id="S3.SS1.p1.13.m13.1.1.3" xref="S3.SS1.p1.13.m13.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.13.m13.1b"><apply id="S3.SS1.p1.13.m13.1.1.cmml" xref="S3.SS1.p1.13.m13.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.13.m13.1.1.1.cmml" xref="S3.SS1.p1.13.m13.1.1">superscript</csymbol><ci id="S3.SS1.p1.13.m13.1.1.2.cmml" xref="S3.SS1.p1.13.m13.1.1.2">𝜋</ci><times id="S3.SS1.p1.13.m13.1.1.3.cmml" xref="S3.SS1.p1.13.m13.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.13.m13.1c">\pi^{*}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.13.m13.1d">italic_π start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math> that maximizes the expected discounted sum of rewards over a potentially infinite horizon, <math alttext="\mathbb{E}\left[\sum_{t=0}^{\infty}{\gamma^{t}\mathcal{R}(s_{t},a_{t})}\right]" class="ltx_Math" display="inline" id="S3.SS1.p1.14.m14.1"><semantics id="S3.SS1.p1.14.m14.1a"><mrow id="S3.SS1.p1.14.m14.1.1" xref="S3.SS1.p1.14.m14.1.1.cmml"><mi id="S3.SS1.p1.14.m14.1.1.3" xref="S3.SS1.p1.14.m14.1.1.3.cmml">𝔼</mi><mo id="S3.SS1.p1.14.m14.1.1.2" xref="S3.SS1.p1.14.m14.1.1.2.cmml">⁢</mo><mrow id="S3.SS1.p1.14.m14.1.1.1.1" xref="S3.SS1.p1.14.m14.1.1.1.2.cmml"><mo id="S3.SS1.p1.14.m14.1.1.1.1.2" xref="S3.SS1.p1.14.m14.1.1.1.2.1.cmml">[</mo><mrow id="S3.SS1.p1.14.m14.1.1.1.1.1" xref="S3.SS1.p1.14.m14.1.1.1.1.1.cmml"><msubsup id="S3.SS1.p1.14.m14.1.1.1.1.1.3" xref="S3.SS1.p1.14.m14.1.1.1.1.1.3.cmml"><mo id="S3.SS1.p1.14.m14.1.1.1.1.1.3.2.2" lspace="0em" xref="S3.SS1.p1.14.m14.1.1.1.1.1.3.2.2.cmml">∑</mo><mrow id="S3.SS1.p1.14.m14.1.1.1.1.1.3.2.3" xref="S3.SS1.p1.14.m14.1.1.1.1.1.3.2.3.cmml"><mi id="S3.SS1.p1.14.m14.1.1.1.1.1.3.2.3.2" xref="S3.SS1.p1.14.m14.1.1.1.1.1.3.2.3.2.cmml">t</mi><mo id="S3.SS1.p1.14.m14.1.1.1.1.1.3.2.3.1" xref="S3.SS1.p1.14.m14.1.1.1.1.1.3.2.3.1.cmml">=</mo><mn id="S3.SS1.p1.14.m14.1.1.1.1.1.3.2.3.3" xref="S3.SS1.p1.14.m14.1.1.1.1.1.3.2.3.3.cmml">0</mn></mrow><mi id="S3.SS1.p1.14.m14.1.1.1.1.1.3.3" mathvariant="normal" xref="S3.SS1.p1.14.m14.1.1.1.1.1.3.3.cmml">∞</mi></msubsup><mrow id="S3.SS1.p1.14.m14.1.1.1.1.1.2" xref="S3.SS1.p1.14.m14.1.1.1.1.1.2.cmml"><msup id="S3.SS1.p1.14.m14.1.1.1.1.1.2.4" xref="S3.SS1.p1.14.m14.1.1.1.1.1.2.4.cmml"><mi id="S3.SS1.p1.14.m14.1.1.1.1.1.2.4.2" xref="S3.SS1.p1.14.m14.1.1.1.1.1.2.4.2.cmml">γ</mi><mi id="S3.SS1.p1.14.m14.1.1.1.1.1.2.4.3" xref="S3.SS1.p1.14.m14.1.1.1.1.1.2.4.3.cmml">t</mi></msup><mo id="S3.SS1.p1.14.m14.1.1.1.1.1.2.3" xref="S3.SS1.p1.14.m14.1.1.1.1.1.2.3.cmml">⁢</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.14.m14.1.1.1.1.1.2.5" xref="S3.SS1.p1.14.m14.1.1.1.1.1.2.5.cmml">ℛ</mi><mo id="S3.SS1.p1.14.m14.1.1.1.1.1.2.3a" xref="S3.SS1.p1.14.m14.1.1.1.1.1.2.3.cmml">⁢</mo><mrow id="S3.SS1.p1.14.m14.1.1.1.1.1.2.2.2" xref="S3.SS1.p1.14.m14.1.1.1.1.1.2.2.3.cmml"><mo id="S3.SS1.p1.14.m14.1.1.1.1.1.2.2.2.3" stretchy="false" xref="S3.SS1.p1.14.m14.1.1.1.1.1.2.2.3.cmml">(</mo><msub id="S3.SS1.p1.14.m14.1.1.1.1.1.1.1.1.1" xref="S3.SS1.p1.14.m14.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.SS1.p1.14.m14.1.1.1.1.1.1.1.1.1.2" xref="S3.SS1.p1.14.m14.1.1.1.1.1.1.1.1.1.2.cmml">s</mi><mi id="S3.SS1.p1.14.m14.1.1.1.1.1.1.1.1.1.3" xref="S3.SS1.p1.14.m14.1.1.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.SS1.p1.14.m14.1.1.1.1.1.2.2.2.4" xref="S3.SS1.p1.14.m14.1.1.1.1.1.2.2.3.cmml">,</mo><msub id="S3.SS1.p1.14.m14.1.1.1.1.1.2.2.2.2" xref="S3.SS1.p1.14.m14.1.1.1.1.1.2.2.2.2.cmml"><mi id="S3.SS1.p1.14.m14.1.1.1.1.1.2.2.2.2.2" xref="S3.SS1.p1.14.m14.1.1.1.1.1.2.2.2.2.2.cmml">a</mi><mi id="S3.SS1.p1.14.m14.1.1.1.1.1.2.2.2.2.3" xref="S3.SS1.p1.14.m14.1.1.1.1.1.2.2.2.2.3.cmml">t</mi></msub><mo id="S3.SS1.p1.14.m14.1.1.1.1.1.2.2.2.5" stretchy="false" xref="S3.SS1.p1.14.m14.1.1.1.1.1.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S3.SS1.p1.14.m14.1.1.1.1.3" xref="S3.SS1.p1.14.m14.1.1.1.2.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.14.m14.1b"><apply id="S3.SS1.p1.14.m14.1.1.cmml" xref="S3.SS1.p1.14.m14.1.1"><times id="S3.SS1.p1.14.m14.1.1.2.cmml" xref="S3.SS1.p1.14.m14.1.1.2"></times><ci id="S3.SS1.p1.14.m14.1.1.3.cmml" xref="S3.SS1.p1.14.m14.1.1.3">𝔼</ci><apply id="S3.SS1.p1.14.m14.1.1.1.2.cmml" xref="S3.SS1.p1.14.m14.1.1.1.1"><csymbol cd="latexml" id="S3.SS1.p1.14.m14.1.1.1.2.1.cmml" xref="S3.SS1.p1.14.m14.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.SS1.p1.14.m14.1.1.1.1.1.cmml" xref="S3.SS1.p1.14.m14.1.1.1.1.1"><apply id="S3.SS1.p1.14.m14.1.1.1.1.1.3.cmml" xref="S3.SS1.p1.14.m14.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p1.14.m14.1.1.1.1.1.3.1.cmml" xref="S3.SS1.p1.14.m14.1.1.1.1.1.3">superscript</csymbol><apply id="S3.SS1.p1.14.m14.1.1.1.1.1.3.2.cmml" xref="S3.SS1.p1.14.m14.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p1.14.m14.1.1.1.1.1.3.2.1.cmml" xref="S3.SS1.p1.14.m14.1.1.1.1.1.3">subscript</csymbol><sum id="S3.SS1.p1.14.m14.1.1.1.1.1.3.2.2.cmml" xref="S3.SS1.p1.14.m14.1.1.1.1.1.3.2.2"></sum><apply id="S3.SS1.p1.14.m14.1.1.1.1.1.3.2.3.cmml" xref="S3.SS1.p1.14.m14.1.1.1.1.1.3.2.3"><eq id="S3.SS1.p1.14.m14.1.1.1.1.1.3.2.3.1.cmml" xref="S3.SS1.p1.14.m14.1.1.1.1.1.3.2.3.1"></eq><ci id="S3.SS1.p1.14.m14.1.1.1.1.1.3.2.3.2.cmml" xref="S3.SS1.p1.14.m14.1.1.1.1.1.3.2.3.2">𝑡</ci><cn id="S3.SS1.p1.14.m14.1.1.1.1.1.3.2.3.3.cmml" type="integer" xref="S3.SS1.p1.14.m14.1.1.1.1.1.3.2.3.3">0</cn></apply></apply><infinity id="S3.SS1.p1.14.m14.1.1.1.1.1.3.3.cmml" xref="S3.SS1.p1.14.m14.1.1.1.1.1.3.3"></infinity></apply><apply id="S3.SS1.p1.14.m14.1.1.1.1.1.2.cmml" xref="S3.SS1.p1.14.m14.1.1.1.1.1.2"><times id="S3.SS1.p1.14.m14.1.1.1.1.1.2.3.cmml" xref="S3.SS1.p1.14.m14.1.1.1.1.1.2.3"></times><apply id="S3.SS1.p1.14.m14.1.1.1.1.1.2.4.cmml" xref="S3.SS1.p1.14.m14.1.1.1.1.1.2.4"><csymbol cd="ambiguous" id="S3.SS1.p1.14.m14.1.1.1.1.1.2.4.1.cmml" xref="S3.SS1.p1.14.m14.1.1.1.1.1.2.4">superscript</csymbol><ci id="S3.SS1.p1.14.m14.1.1.1.1.1.2.4.2.cmml" xref="S3.SS1.p1.14.m14.1.1.1.1.1.2.4.2">𝛾</ci><ci id="S3.SS1.p1.14.m14.1.1.1.1.1.2.4.3.cmml" xref="S3.SS1.p1.14.m14.1.1.1.1.1.2.4.3">𝑡</ci></apply><ci id="S3.SS1.p1.14.m14.1.1.1.1.1.2.5.cmml" xref="S3.SS1.p1.14.m14.1.1.1.1.1.2.5">ℛ</ci><interval closure="open" id="S3.SS1.p1.14.m14.1.1.1.1.1.2.2.3.cmml" xref="S3.SS1.p1.14.m14.1.1.1.1.1.2.2.2"><apply id="S3.SS1.p1.14.m14.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.14.m14.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.14.m14.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.14.m14.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.14.m14.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.SS1.p1.14.m14.1.1.1.1.1.1.1.1.1.2">𝑠</ci><ci id="S3.SS1.p1.14.m14.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.SS1.p1.14.m14.1.1.1.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="S3.SS1.p1.14.m14.1.1.1.1.1.2.2.2.2.cmml" xref="S3.SS1.p1.14.m14.1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.14.m14.1.1.1.1.1.2.2.2.2.1.cmml" xref="S3.SS1.p1.14.m14.1.1.1.1.1.2.2.2.2">subscript</csymbol><ci id="S3.SS1.p1.14.m14.1.1.1.1.1.2.2.2.2.2.cmml" xref="S3.SS1.p1.14.m14.1.1.1.1.1.2.2.2.2.2">𝑎</ci><ci id="S3.SS1.p1.14.m14.1.1.1.1.1.2.2.2.2.3.cmml" xref="S3.SS1.p1.14.m14.1.1.1.1.1.2.2.2.2.3">𝑡</ci></apply></interval></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.14.m14.1c">\mathbb{E}\left[\sum_{t=0}^{\infty}{\gamma^{t}\mathcal{R}(s_{t},a_{t})}\right]</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.14.m14.1d">blackboard_E [ ∑ start_POSTSUBSCRIPT italic_t = 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∞ end_POSTSUPERSCRIPT italic_γ start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT caligraphic_R ( italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) ]</annotation></semantics></math>, where <math alttext="\gamma" class="ltx_Math" display="inline" id="S3.SS1.p1.15.m15.1"><semantics id="S3.SS1.p1.15.m15.1a"><mi id="S3.SS1.p1.15.m15.1.1" xref="S3.SS1.p1.15.m15.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.15.m15.1b"><ci id="S3.SS1.p1.15.m15.1.1.cmml" xref="S3.SS1.p1.15.m15.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.15.m15.1c">\gamma</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.15.m15.1d">italic_γ</annotation></semantics></math> is a discount factor.</p>
</div>
<div class="ltx_para" id="S3.SS1.p2">
<p class="ltx_p" id="S3.SS1.p2.5">When the task is parameterized by a goal, the goal is given as input to the policy.
Goal-conditioned policies, therefore, map from state <math alttext="s_{t}\in\mathcal{S}" class="ltx_Math" display="inline" id="S3.SS1.p2.1.m1.1"><semantics id="S3.SS1.p2.1.m1.1a"><mrow id="S3.SS1.p2.1.m1.1.1" xref="S3.SS1.p2.1.m1.1.1.cmml"><msub id="S3.SS1.p2.1.m1.1.1.2" xref="S3.SS1.p2.1.m1.1.1.2.cmml"><mi id="S3.SS1.p2.1.m1.1.1.2.2" xref="S3.SS1.p2.1.m1.1.1.2.2.cmml">s</mi><mi id="S3.SS1.p2.1.m1.1.1.2.3" xref="S3.SS1.p2.1.m1.1.1.2.3.cmml">t</mi></msub><mo id="S3.SS1.p2.1.m1.1.1.1" xref="S3.SS1.p2.1.m1.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.1.m1.1.1.3" xref="S3.SS1.p2.1.m1.1.1.3.cmml">𝒮</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.1b"><apply id="S3.SS1.p2.1.m1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1"><in id="S3.SS1.p2.1.m1.1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1.1"></in><apply id="S3.SS1.p2.1.m1.1.1.2.cmml" xref="S3.SS1.p2.1.m1.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p2.1.m1.1.1.2.1.cmml" xref="S3.SS1.p2.1.m1.1.1.2">subscript</csymbol><ci id="S3.SS1.p2.1.m1.1.1.2.2.cmml" xref="S3.SS1.p2.1.m1.1.1.2.2">𝑠</ci><ci id="S3.SS1.p2.1.m1.1.1.2.3.cmml" xref="S3.SS1.p2.1.m1.1.1.2.3">𝑡</ci></apply><ci id="S3.SS1.p2.1.m1.1.1.3.cmml" xref="S3.SS1.p2.1.m1.1.1.3">𝒮</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.1c">s_{t}\in\mathcal{S}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.1.m1.1d">italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∈ caligraphic_S</annotation></semantics></math> and goal <math alttext="g_{t}\in\mathcal{G}" class="ltx_Math" display="inline" id="S3.SS1.p2.2.m2.1"><semantics id="S3.SS1.p2.2.m2.1a"><mrow id="S3.SS1.p2.2.m2.1.1" xref="S3.SS1.p2.2.m2.1.1.cmml"><msub id="S3.SS1.p2.2.m2.1.1.2" xref="S3.SS1.p2.2.m2.1.1.2.cmml"><mi id="S3.SS1.p2.2.m2.1.1.2.2" xref="S3.SS1.p2.2.m2.1.1.2.2.cmml">g</mi><mi id="S3.SS1.p2.2.m2.1.1.2.3" xref="S3.SS1.p2.2.m2.1.1.2.3.cmml">t</mi></msub><mo id="S3.SS1.p2.2.m2.1.1.1" xref="S3.SS1.p2.2.m2.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.2.m2.1.1.3" xref="S3.SS1.p2.2.m2.1.1.3.cmml">𝒢</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.2.m2.1b"><apply id="S3.SS1.p2.2.m2.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1"><in id="S3.SS1.p2.2.m2.1.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1.1"></in><apply id="S3.SS1.p2.2.m2.1.1.2.cmml" xref="S3.SS1.p2.2.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p2.2.m2.1.1.2.1.cmml" xref="S3.SS1.p2.2.m2.1.1.2">subscript</csymbol><ci id="S3.SS1.p2.2.m2.1.1.2.2.cmml" xref="S3.SS1.p2.2.m2.1.1.2.2">𝑔</ci><ci id="S3.SS1.p2.2.m2.1.1.2.3.cmml" xref="S3.SS1.p2.2.m2.1.1.2.3">𝑡</ci></apply><ci id="S3.SS1.p2.2.m2.1.1.3.cmml" xref="S3.SS1.p2.2.m2.1.1.3">𝒢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.2.m2.1c">g_{t}\in\mathcal{G}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.2.m2.1d">italic_g start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∈ caligraphic_G</annotation></semantics></math>, with the goal space <math alttext="\mathcal{G}" class="ltx_Math" display="inline" id="S3.SS1.p2.3.m3.1"><semantics id="S3.SS1.p2.3.m3.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.3.m3.1.1" xref="S3.SS1.p2.3.m3.1.1.cmml">𝒢</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.3.m3.1b"><ci id="S3.SS1.p2.3.m3.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1">𝒢</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.3.m3.1c">\mathcal{G}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.3.m3.1d">caligraphic_G</annotation></semantics></math>, to a probability distribution over actions, i.e. <math alttext="a_{t}\sim\pi(\cdot|s_{t},g_{t})" class="ltx_math_unparsed" display="inline" id="S3.SS1.p2.4.m4.1"><semantics id="S3.SS1.p2.4.m4.1a"><mrow id="S3.SS1.p2.4.m4.1b"><msub id="S3.SS1.p2.4.m4.1.1"><mi id="S3.SS1.p2.4.m4.1.1.2">a</mi><mi id="S3.SS1.p2.4.m4.1.1.3">t</mi></msub><mo id="S3.SS1.p2.4.m4.1.2">∼</mo><mi id="S3.SS1.p2.4.m4.1.3">π</mi><mrow id="S3.SS1.p2.4.m4.1.4"><mo id="S3.SS1.p2.4.m4.1.4.1" stretchy="false">(</mo><mo id="S3.SS1.p2.4.m4.1.4.2" lspace="0em" rspace="0em">⋅</mo><mo fence="false" id="S3.SS1.p2.4.m4.1.4.3" rspace="0.167em" stretchy="false">|</mo><msub id="S3.SS1.p2.4.m4.1.4.4"><mi id="S3.SS1.p2.4.m4.1.4.4.2">s</mi><mi id="S3.SS1.p2.4.m4.1.4.4.3">t</mi></msub><mo id="S3.SS1.p2.4.m4.1.4.5">,</mo><msub id="S3.SS1.p2.4.m4.1.4.6"><mi id="S3.SS1.p2.4.m4.1.4.6.2">g</mi><mi id="S3.SS1.p2.4.m4.1.4.6.3">t</mi></msub><mo id="S3.SS1.p2.4.m4.1.4.7" stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="S3.SS1.p2.4.m4.1c">a_{t}\sim\pi(\cdot|s_{t},g_{t})</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.4.m4.1d">italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∼ italic_π ( ⋅ | italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_g start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math>.
In a goal-conditioned formulation, the reward function is also goal-dependent, i.e. <math alttext="\mathcal{R}:\mathcal{S}\times\mathcal{A}\times\mathcal{G}\rightarrow\mathbb{R}" class="ltx_Math" display="inline" id="S3.SS1.p2.5.m5.1"><semantics id="S3.SS1.p2.5.m5.1a"><mrow id="S3.SS1.p2.5.m5.1.1" xref="S3.SS1.p2.5.m5.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.5.m5.1.1.2" xref="S3.SS1.p2.5.m5.1.1.2.cmml">ℛ</mi><mo id="S3.SS1.p2.5.m5.1.1.1" lspace="0.278em" rspace="0.278em" xref="S3.SS1.p2.5.m5.1.1.1.cmml">:</mo><mrow id="S3.SS1.p2.5.m5.1.1.3" xref="S3.SS1.p2.5.m5.1.1.3.cmml"><mrow id="S3.SS1.p2.5.m5.1.1.3.2" xref="S3.SS1.p2.5.m5.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.5.m5.1.1.3.2.2" xref="S3.SS1.p2.5.m5.1.1.3.2.2.cmml">𝒮</mi><mo id="S3.SS1.p2.5.m5.1.1.3.2.1" lspace="0.222em" rspace="0.222em" xref="S3.SS1.p2.5.m5.1.1.3.2.1.cmml">×</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.5.m5.1.1.3.2.3" xref="S3.SS1.p2.5.m5.1.1.3.2.3.cmml">𝒜</mi><mo id="S3.SS1.p2.5.m5.1.1.3.2.1a" lspace="0.222em" rspace="0.222em" xref="S3.SS1.p2.5.m5.1.1.3.2.1.cmml">×</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.5.m5.1.1.3.2.4" xref="S3.SS1.p2.5.m5.1.1.3.2.4.cmml">𝒢</mi></mrow><mo id="S3.SS1.p2.5.m5.1.1.3.1" stretchy="false" xref="S3.SS1.p2.5.m5.1.1.3.1.cmml">→</mo><mi id="S3.SS1.p2.5.m5.1.1.3.3" xref="S3.SS1.p2.5.m5.1.1.3.3.cmml">ℝ</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.5.m5.1b"><apply id="S3.SS1.p2.5.m5.1.1.cmml" xref="S3.SS1.p2.5.m5.1.1"><ci id="S3.SS1.p2.5.m5.1.1.1.cmml" xref="S3.SS1.p2.5.m5.1.1.1">:</ci><ci id="S3.SS1.p2.5.m5.1.1.2.cmml" xref="S3.SS1.p2.5.m5.1.1.2">ℛ</ci><apply id="S3.SS1.p2.5.m5.1.1.3.cmml" xref="S3.SS1.p2.5.m5.1.1.3"><ci id="S3.SS1.p2.5.m5.1.1.3.1.cmml" xref="S3.SS1.p2.5.m5.1.1.3.1">→</ci><apply id="S3.SS1.p2.5.m5.1.1.3.2.cmml" xref="S3.SS1.p2.5.m5.1.1.3.2"><times id="S3.SS1.p2.5.m5.1.1.3.2.1.cmml" xref="S3.SS1.p2.5.m5.1.1.3.2.1"></times><ci id="S3.SS1.p2.5.m5.1.1.3.2.2.cmml" xref="S3.SS1.p2.5.m5.1.1.3.2.2">𝒮</ci><ci id="S3.SS1.p2.5.m5.1.1.3.2.3.cmml" xref="S3.SS1.p2.5.m5.1.1.3.2.3">𝒜</ci><ci id="S3.SS1.p2.5.m5.1.1.3.2.4.cmml" xref="S3.SS1.p2.5.m5.1.1.3.2.4">𝒢</ci></apply><ci id="S3.SS1.p2.5.m5.1.1.3.3.cmml" xref="S3.SS1.p2.5.m5.1.1.3.3">ℝ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.5.m5.1c">\mathcal{R}:\mathcal{S}\times\mathcal{A}\times\mathcal{G}\rightarrow\mathbb{R}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.5.m5.1d">caligraphic_R : caligraphic_S × caligraphic_A × caligraphic_G → blackboard_R</annotation></semantics></math>.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S3.SS2.4.1.1">III-B</span> </span><span class="ltx_text ltx_font_italic" id="S3.SS2.5.2">Multiplicative Compositional Policy</span>
</h3>
<div class="ltx_para" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.2">A Multiplicative Compositional Policy <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04855v1#bib.bib20" title="">20</a>]</cite> is a policy architecture that enables an agent to activate multiple primitives simultaneously, where each primitive specializes in a distinct behavior.
These behaviors can be composed to produce a continuous spectrum of skills.
The policy enables that by treating <math alttext="K" class="ltx_Math" display="inline" id="S3.SS2.p1.1.m1.1"><semantics id="S3.SS2.p1.1.m1.1a"><mi id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><ci id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.1.m1.1d">italic_K</annotation></semantics></math> primitives <math alttext="\pi_{1},...,\pi_{K}" class="ltx_Math" display="inline" id="S3.SS2.p1.2.m2.3"><semantics id="S3.SS2.p1.2.m2.3a"><mrow id="S3.SS2.p1.2.m2.3.3.2" xref="S3.SS2.p1.2.m2.3.3.3.cmml"><msub id="S3.SS2.p1.2.m2.2.2.1.1" xref="S3.SS2.p1.2.m2.2.2.1.1.cmml"><mi id="S3.SS2.p1.2.m2.2.2.1.1.2" xref="S3.SS2.p1.2.m2.2.2.1.1.2.cmml">π</mi><mn id="S3.SS2.p1.2.m2.2.2.1.1.3" xref="S3.SS2.p1.2.m2.2.2.1.1.3.cmml">1</mn></msub><mo id="S3.SS2.p1.2.m2.3.3.2.3" xref="S3.SS2.p1.2.m2.3.3.3.cmml">,</mo><mi id="S3.SS2.p1.2.m2.1.1" mathvariant="normal" xref="S3.SS2.p1.2.m2.1.1.cmml">…</mi><mo id="S3.SS2.p1.2.m2.3.3.2.4" xref="S3.SS2.p1.2.m2.3.3.3.cmml">,</mo><msub id="S3.SS2.p1.2.m2.3.3.2.2" xref="S3.SS2.p1.2.m2.3.3.2.2.cmml"><mi id="S3.SS2.p1.2.m2.3.3.2.2.2" xref="S3.SS2.p1.2.m2.3.3.2.2.2.cmml">π</mi><mi id="S3.SS2.p1.2.m2.3.3.2.2.3" xref="S3.SS2.p1.2.m2.3.3.2.2.3.cmml">K</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.3b"><list id="S3.SS2.p1.2.m2.3.3.3.cmml" xref="S3.SS2.p1.2.m2.3.3.2"><apply id="S3.SS2.p1.2.m2.2.2.1.1.cmml" xref="S3.SS2.p1.2.m2.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.2.2.1.1.1.cmml" xref="S3.SS2.p1.2.m2.2.2.1.1">subscript</csymbol><ci id="S3.SS2.p1.2.m2.2.2.1.1.2.cmml" xref="S3.SS2.p1.2.m2.2.2.1.1.2">𝜋</ci><cn id="S3.SS2.p1.2.m2.2.2.1.1.3.cmml" type="integer" xref="S3.SS2.p1.2.m2.2.2.1.1.3">1</cn></apply><ci id="S3.SS2.p1.2.m2.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1">…</ci><apply id="S3.SS2.p1.2.m2.3.3.2.2.cmml" xref="S3.SS2.p1.2.m2.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.3.3.2.2.1.cmml" xref="S3.SS2.p1.2.m2.3.3.2.2">subscript</csymbol><ci id="S3.SS2.p1.2.m2.3.3.2.2.2.cmml" xref="S3.SS2.p1.2.m2.3.3.2.2.2">𝜋</ci><ci id="S3.SS2.p1.2.m2.3.3.2.2.3.cmml" xref="S3.SS2.p1.2.m2.3.3.2.2.3">𝐾</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.3c">\pi_{1},...,\pi_{K}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.2.m2.3d">italic_π start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_π start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT</annotation></semantics></math> as independent Gaussian distributions over actions.
The composite policy is obtained by a multiplicative composition of these distributions,</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\pi(a|s,g)=\frac{1}{Z(s,g)}\prod_{i=1}^{K}\pi_{i}(a|s)^{w_{i}(s,g)},\quad w_{i%
}(s,g)\geq 0." class="ltx_Math" display="block" id="S3.E1.m1.9"><semantics id="S3.E1.m1.9a"><mrow id="S3.E1.m1.9.9.1"><mrow id="S3.E1.m1.9.9.1.1.2" xref="S3.E1.m1.9.9.1.1.3.cmml"><mrow id="S3.E1.m1.9.9.1.1.1.1" xref="S3.E1.m1.9.9.1.1.1.1.cmml"><mrow id="S3.E1.m1.9.9.1.1.1.1.1" xref="S3.E1.m1.9.9.1.1.1.1.1.cmml"><mi id="S3.E1.m1.9.9.1.1.1.1.1.3" xref="S3.E1.m1.9.9.1.1.1.1.1.3.cmml">π</mi><mo id="S3.E1.m1.9.9.1.1.1.1.1.2" xref="S3.E1.m1.9.9.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E1.m1.9.9.1.1.1.1.1.1.1" xref="S3.E1.m1.9.9.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E1.m1.9.9.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E1.m1.9.9.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E1.m1.9.9.1.1.1.1.1.1.1.1" xref="S3.E1.m1.9.9.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E1.m1.9.9.1.1.1.1.1.1.1.1.2" xref="S3.E1.m1.9.9.1.1.1.1.1.1.1.1.2.cmml">a</mi><mo fence="false" id="S3.E1.m1.9.9.1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.9.9.1.1.1.1.1.1.1.1.1.cmml">|</mo><mrow id="S3.E1.m1.9.9.1.1.1.1.1.1.1.1.3.2" xref="S3.E1.m1.9.9.1.1.1.1.1.1.1.1.3.1.cmml"><mi id="S3.E1.m1.5.5" xref="S3.E1.m1.5.5.cmml">s</mi><mo id="S3.E1.m1.9.9.1.1.1.1.1.1.1.1.3.2.1" xref="S3.E1.m1.9.9.1.1.1.1.1.1.1.1.3.1.cmml">,</mo><mi id="S3.E1.m1.6.6" xref="S3.E1.m1.6.6.cmml">g</mi></mrow></mrow><mo id="S3.E1.m1.9.9.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E1.m1.9.9.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E1.m1.9.9.1.1.1.1.3" xref="S3.E1.m1.9.9.1.1.1.1.3.cmml">=</mo><mrow id="S3.E1.m1.9.9.1.1.1.1.2" xref="S3.E1.m1.9.9.1.1.1.1.2.cmml"><mfrac id="S3.E1.m1.2.2" xref="S3.E1.m1.2.2.cmml"><mn id="S3.E1.m1.2.2.4" xref="S3.E1.m1.2.2.4.cmml">1</mn><mrow id="S3.E1.m1.2.2.2" xref="S3.E1.m1.2.2.2.cmml"><mi id="S3.E1.m1.2.2.2.4" xref="S3.E1.m1.2.2.2.4.cmml">Z</mi><mo id="S3.E1.m1.2.2.2.3" xref="S3.E1.m1.2.2.2.3.cmml">⁢</mo><mrow id="S3.E1.m1.2.2.2.5.2" xref="S3.E1.m1.2.2.2.5.1.cmml"><mo id="S3.E1.m1.2.2.2.5.2.1" stretchy="false" xref="S3.E1.m1.2.2.2.5.1.cmml">(</mo><mi id="S3.E1.m1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.cmml">s</mi><mo id="S3.E1.m1.2.2.2.5.2.2" xref="S3.E1.m1.2.2.2.5.1.cmml">,</mo><mi id="S3.E1.m1.2.2.2.2" xref="S3.E1.m1.2.2.2.2.cmml">g</mi><mo id="S3.E1.m1.2.2.2.5.2.3" stretchy="false" xref="S3.E1.m1.2.2.2.5.1.cmml">)</mo></mrow></mrow></mfrac><mo id="S3.E1.m1.9.9.1.1.1.1.2.2" xref="S3.E1.m1.9.9.1.1.1.1.2.2.cmml">⁢</mo><mrow id="S3.E1.m1.9.9.1.1.1.1.2.1" xref="S3.E1.m1.9.9.1.1.1.1.2.1.cmml"><munderover id="S3.E1.m1.9.9.1.1.1.1.2.1.2" xref="S3.E1.m1.9.9.1.1.1.1.2.1.2.cmml"><mo id="S3.E1.m1.9.9.1.1.1.1.2.1.2.2.2" movablelimits="false" xref="S3.E1.m1.9.9.1.1.1.1.2.1.2.2.2.cmml">∏</mo><mrow id="S3.E1.m1.9.9.1.1.1.1.2.1.2.2.3" xref="S3.E1.m1.9.9.1.1.1.1.2.1.2.2.3.cmml"><mi id="S3.E1.m1.9.9.1.1.1.1.2.1.2.2.3.2" xref="S3.E1.m1.9.9.1.1.1.1.2.1.2.2.3.2.cmml">i</mi><mo id="S3.E1.m1.9.9.1.1.1.1.2.1.2.2.3.1" xref="S3.E1.m1.9.9.1.1.1.1.2.1.2.2.3.1.cmml">=</mo><mn id="S3.E1.m1.9.9.1.1.1.1.2.1.2.2.3.3" xref="S3.E1.m1.9.9.1.1.1.1.2.1.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E1.m1.9.9.1.1.1.1.2.1.2.3" xref="S3.E1.m1.9.9.1.1.1.1.2.1.2.3.cmml">K</mi></munderover><mrow id="S3.E1.m1.9.9.1.1.1.1.2.1.1" xref="S3.E1.m1.9.9.1.1.1.1.2.1.1.cmml"><msub id="S3.E1.m1.9.9.1.1.1.1.2.1.1.3" xref="S3.E1.m1.9.9.1.1.1.1.2.1.1.3.cmml"><mi id="S3.E1.m1.9.9.1.1.1.1.2.1.1.3.2" xref="S3.E1.m1.9.9.1.1.1.1.2.1.1.3.2.cmml">π</mi><mi id="S3.E1.m1.9.9.1.1.1.1.2.1.1.3.3" xref="S3.E1.m1.9.9.1.1.1.1.2.1.1.3.3.cmml">i</mi></msub><mo id="S3.E1.m1.9.9.1.1.1.1.2.1.1.2" xref="S3.E1.m1.9.9.1.1.1.1.2.1.1.2.cmml">⁢</mo><msup id="S3.E1.m1.9.9.1.1.1.1.2.1.1.1" xref="S3.E1.m1.9.9.1.1.1.1.2.1.1.1.cmml"><mrow id="S3.E1.m1.9.9.1.1.1.1.2.1.1.1.1.1" xref="S3.E1.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.cmml"><mo id="S3.E1.m1.9.9.1.1.1.1.2.1.1.1.1.1.2" stretchy="false" xref="S3.E1.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E1.m1.9.9.1.1.1.1.2.1.1.1.1.1.1" xref="S3.E1.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.cmml"><mi id="S3.E1.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.2" xref="S3.E1.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.2.cmml">a</mi><mo fence="false" id="S3.E1.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.1" xref="S3.E1.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.1.cmml">|</mo><mi id="S3.E1.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.3" xref="S3.E1.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.3.cmml">s</mi></mrow><mo id="S3.E1.m1.9.9.1.1.1.1.2.1.1.1.1.1.3" stretchy="false" xref="S3.E1.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.cmml">)</mo></mrow><mrow id="S3.E1.m1.4.4.2" xref="S3.E1.m1.4.4.2.cmml"><msub id="S3.E1.m1.4.4.2.4" xref="S3.E1.m1.4.4.2.4.cmml"><mi id="S3.E1.m1.4.4.2.4.2" xref="S3.E1.m1.4.4.2.4.2.cmml">w</mi><mi id="S3.E1.m1.4.4.2.4.3" xref="S3.E1.m1.4.4.2.4.3.cmml">i</mi></msub><mo id="S3.E1.m1.4.4.2.3" xref="S3.E1.m1.4.4.2.3.cmml">⁢</mo><mrow id="S3.E1.m1.4.4.2.5.2" xref="S3.E1.m1.4.4.2.5.1.cmml"><mo id="S3.E1.m1.4.4.2.5.2.1" stretchy="false" xref="S3.E1.m1.4.4.2.5.1.cmml">(</mo><mi id="S3.E1.m1.3.3.1.1" xref="S3.E1.m1.3.3.1.1.cmml">s</mi><mo id="S3.E1.m1.4.4.2.5.2.2" xref="S3.E1.m1.4.4.2.5.1.cmml">,</mo><mi id="S3.E1.m1.4.4.2.2" xref="S3.E1.m1.4.4.2.2.cmml">g</mi><mo id="S3.E1.m1.4.4.2.5.2.3" stretchy="false" xref="S3.E1.m1.4.4.2.5.1.cmml">)</mo></mrow></mrow></msup></mrow></mrow></mrow></mrow><mo id="S3.E1.m1.9.9.1.1.2.3" rspace="1.167em" xref="S3.E1.m1.9.9.1.1.3a.cmml">,</mo><mrow id="S3.E1.m1.9.9.1.1.2.2" xref="S3.E1.m1.9.9.1.1.2.2.cmml"><mrow id="S3.E1.m1.9.9.1.1.2.2.2" xref="S3.E1.m1.9.9.1.1.2.2.2.cmml"><msub id="S3.E1.m1.9.9.1.1.2.2.2.2" xref="S3.E1.m1.9.9.1.1.2.2.2.2.cmml"><mi id="S3.E1.m1.9.9.1.1.2.2.2.2.2" xref="S3.E1.m1.9.9.1.1.2.2.2.2.2.cmml">w</mi><mi id="S3.E1.m1.9.9.1.1.2.2.2.2.3" xref="S3.E1.m1.9.9.1.1.2.2.2.2.3.cmml">i</mi></msub><mo id="S3.E1.m1.9.9.1.1.2.2.2.1" xref="S3.E1.m1.9.9.1.1.2.2.2.1.cmml">⁢</mo><mrow id="S3.E1.m1.9.9.1.1.2.2.2.3.2" xref="S3.E1.m1.9.9.1.1.2.2.2.3.1.cmml"><mo id="S3.E1.m1.9.9.1.1.2.2.2.3.2.1" stretchy="false" xref="S3.E1.m1.9.9.1.1.2.2.2.3.1.cmml">(</mo><mi id="S3.E1.m1.7.7" xref="S3.E1.m1.7.7.cmml">s</mi><mo id="S3.E1.m1.9.9.1.1.2.2.2.3.2.2" xref="S3.E1.m1.9.9.1.1.2.2.2.3.1.cmml">,</mo><mi id="S3.E1.m1.8.8" xref="S3.E1.m1.8.8.cmml">g</mi><mo id="S3.E1.m1.9.9.1.1.2.2.2.3.2.3" stretchy="false" xref="S3.E1.m1.9.9.1.1.2.2.2.3.1.cmml">)</mo></mrow></mrow><mo id="S3.E1.m1.9.9.1.1.2.2.1" xref="S3.E1.m1.9.9.1.1.2.2.1.cmml">≥</mo><mn id="S3.E1.m1.9.9.1.1.2.2.3" xref="S3.E1.m1.9.9.1.1.2.2.3.cmml">0</mn></mrow></mrow><mo id="S3.E1.m1.9.9.1.2" lspace="0em">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.9b"><apply id="S3.E1.m1.9.9.1.1.3.cmml" xref="S3.E1.m1.9.9.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.9.9.1.1.3a.cmml" xref="S3.E1.m1.9.9.1.1.2.3">formulae-sequence</csymbol><apply id="S3.E1.m1.9.9.1.1.1.1.cmml" xref="S3.E1.m1.9.9.1.1.1.1"><eq id="S3.E1.m1.9.9.1.1.1.1.3.cmml" xref="S3.E1.m1.9.9.1.1.1.1.3"></eq><apply id="S3.E1.m1.9.9.1.1.1.1.1.cmml" xref="S3.E1.m1.9.9.1.1.1.1.1"><times id="S3.E1.m1.9.9.1.1.1.1.1.2.cmml" xref="S3.E1.m1.9.9.1.1.1.1.1.2"></times><ci id="S3.E1.m1.9.9.1.1.1.1.1.3.cmml" xref="S3.E1.m1.9.9.1.1.1.1.1.3">𝜋</ci><apply id="S3.E1.m1.9.9.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.9.9.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E1.m1.9.9.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.9.9.1.1.1.1.1.1.1.1.1">conditional</csymbol><ci id="S3.E1.m1.9.9.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.9.9.1.1.1.1.1.1.1.1.2">𝑎</ci><list id="S3.E1.m1.9.9.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E1.m1.9.9.1.1.1.1.1.1.1.1.3.2"><ci id="S3.E1.m1.5.5.cmml" xref="S3.E1.m1.5.5">𝑠</ci><ci id="S3.E1.m1.6.6.cmml" xref="S3.E1.m1.6.6">𝑔</ci></list></apply></apply><apply id="S3.E1.m1.9.9.1.1.1.1.2.cmml" xref="S3.E1.m1.9.9.1.1.1.1.2"><times id="S3.E1.m1.9.9.1.1.1.1.2.2.cmml" xref="S3.E1.m1.9.9.1.1.1.1.2.2"></times><apply id="S3.E1.m1.2.2.cmml" xref="S3.E1.m1.2.2"><divide id="S3.E1.m1.2.2.3.cmml" xref="S3.E1.m1.2.2"></divide><cn id="S3.E1.m1.2.2.4.cmml" type="integer" xref="S3.E1.m1.2.2.4">1</cn><apply id="S3.E1.m1.2.2.2.cmml" xref="S3.E1.m1.2.2.2"><times id="S3.E1.m1.2.2.2.3.cmml" xref="S3.E1.m1.2.2.2.3"></times><ci id="S3.E1.m1.2.2.2.4.cmml" xref="S3.E1.m1.2.2.2.4">𝑍</ci><interval closure="open" id="S3.E1.m1.2.2.2.5.1.cmml" xref="S3.E1.m1.2.2.2.5.2"><ci id="S3.E1.m1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1">𝑠</ci><ci id="S3.E1.m1.2.2.2.2.cmml" xref="S3.E1.m1.2.2.2.2">𝑔</ci></interval></apply></apply><apply id="S3.E1.m1.9.9.1.1.1.1.2.1.cmml" xref="S3.E1.m1.9.9.1.1.1.1.2.1"><apply id="S3.E1.m1.9.9.1.1.1.1.2.1.2.cmml" xref="S3.E1.m1.9.9.1.1.1.1.2.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.9.9.1.1.1.1.2.1.2.1.cmml" xref="S3.E1.m1.9.9.1.1.1.1.2.1.2">superscript</csymbol><apply id="S3.E1.m1.9.9.1.1.1.1.2.1.2.2.cmml" xref="S3.E1.m1.9.9.1.1.1.1.2.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.9.9.1.1.1.1.2.1.2.2.1.cmml" xref="S3.E1.m1.9.9.1.1.1.1.2.1.2">subscript</csymbol><csymbol cd="latexml" id="S3.E1.m1.9.9.1.1.1.1.2.1.2.2.2.cmml" xref="S3.E1.m1.9.9.1.1.1.1.2.1.2.2.2">product</csymbol><apply id="S3.E1.m1.9.9.1.1.1.1.2.1.2.2.3.cmml" xref="S3.E1.m1.9.9.1.1.1.1.2.1.2.2.3"><eq id="S3.E1.m1.9.9.1.1.1.1.2.1.2.2.3.1.cmml" xref="S3.E1.m1.9.9.1.1.1.1.2.1.2.2.3.1"></eq><ci id="S3.E1.m1.9.9.1.1.1.1.2.1.2.2.3.2.cmml" xref="S3.E1.m1.9.9.1.1.1.1.2.1.2.2.3.2">𝑖</ci><cn id="S3.E1.m1.9.9.1.1.1.1.2.1.2.2.3.3.cmml" type="integer" xref="S3.E1.m1.9.9.1.1.1.1.2.1.2.2.3.3">1</cn></apply></apply><ci id="S3.E1.m1.9.9.1.1.1.1.2.1.2.3.cmml" xref="S3.E1.m1.9.9.1.1.1.1.2.1.2.3">𝐾</ci></apply><apply id="S3.E1.m1.9.9.1.1.1.1.2.1.1.cmml" xref="S3.E1.m1.9.9.1.1.1.1.2.1.1"><times id="S3.E1.m1.9.9.1.1.1.1.2.1.1.2.cmml" xref="S3.E1.m1.9.9.1.1.1.1.2.1.1.2"></times><apply id="S3.E1.m1.9.9.1.1.1.1.2.1.1.3.cmml" xref="S3.E1.m1.9.9.1.1.1.1.2.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.9.9.1.1.1.1.2.1.1.3.1.cmml" xref="S3.E1.m1.9.9.1.1.1.1.2.1.1.3">subscript</csymbol><ci id="S3.E1.m1.9.9.1.1.1.1.2.1.1.3.2.cmml" xref="S3.E1.m1.9.9.1.1.1.1.2.1.1.3.2">𝜋</ci><ci id="S3.E1.m1.9.9.1.1.1.1.2.1.1.3.3.cmml" xref="S3.E1.m1.9.9.1.1.1.1.2.1.1.3.3">𝑖</ci></apply><apply id="S3.E1.m1.9.9.1.1.1.1.2.1.1.1.cmml" xref="S3.E1.m1.9.9.1.1.1.1.2.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.9.9.1.1.1.1.2.1.1.1.2.cmml" xref="S3.E1.m1.9.9.1.1.1.1.2.1.1.1">superscript</csymbol><apply id="S3.E1.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.cmml" xref="S3.E1.m1.9.9.1.1.1.1.2.1.1.1.1.1"><csymbol cd="latexml" id="S3.E1.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.1">conditional</csymbol><ci id="S3.E1.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.2">𝑎</ci><ci id="S3.E1.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.3">𝑠</ci></apply><apply id="S3.E1.m1.4.4.2.cmml" xref="S3.E1.m1.4.4.2"><times id="S3.E1.m1.4.4.2.3.cmml" xref="S3.E1.m1.4.4.2.3"></times><apply id="S3.E1.m1.4.4.2.4.cmml" xref="S3.E1.m1.4.4.2.4"><csymbol cd="ambiguous" id="S3.E1.m1.4.4.2.4.1.cmml" xref="S3.E1.m1.4.4.2.4">subscript</csymbol><ci id="S3.E1.m1.4.4.2.4.2.cmml" xref="S3.E1.m1.4.4.2.4.2">𝑤</ci><ci id="S3.E1.m1.4.4.2.4.3.cmml" xref="S3.E1.m1.4.4.2.4.3">𝑖</ci></apply><interval closure="open" id="S3.E1.m1.4.4.2.5.1.cmml" xref="S3.E1.m1.4.4.2.5.2"><ci id="S3.E1.m1.3.3.1.1.cmml" xref="S3.E1.m1.3.3.1.1">𝑠</ci><ci id="S3.E1.m1.4.4.2.2.cmml" xref="S3.E1.m1.4.4.2.2">𝑔</ci></interval></apply></apply></apply></apply></apply></apply><apply id="S3.E1.m1.9.9.1.1.2.2.cmml" xref="S3.E1.m1.9.9.1.1.2.2"><geq id="S3.E1.m1.9.9.1.1.2.2.1.cmml" xref="S3.E1.m1.9.9.1.1.2.2.1"></geq><apply id="S3.E1.m1.9.9.1.1.2.2.2.cmml" xref="S3.E1.m1.9.9.1.1.2.2.2"><times id="S3.E1.m1.9.9.1.1.2.2.2.1.cmml" xref="S3.E1.m1.9.9.1.1.2.2.2.1"></times><apply id="S3.E1.m1.9.9.1.1.2.2.2.2.cmml" xref="S3.E1.m1.9.9.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.9.9.1.1.2.2.2.2.1.cmml" xref="S3.E1.m1.9.9.1.1.2.2.2.2">subscript</csymbol><ci id="S3.E1.m1.9.9.1.1.2.2.2.2.2.cmml" xref="S3.E1.m1.9.9.1.1.2.2.2.2.2">𝑤</ci><ci id="S3.E1.m1.9.9.1.1.2.2.2.2.3.cmml" xref="S3.E1.m1.9.9.1.1.2.2.2.2.3">𝑖</ci></apply><interval closure="open" id="S3.E1.m1.9.9.1.1.2.2.2.3.1.cmml" xref="S3.E1.m1.9.9.1.1.2.2.2.3.2"><ci id="S3.E1.m1.7.7.cmml" xref="S3.E1.m1.7.7">𝑠</ci><ci id="S3.E1.m1.8.8.cmml" xref="S3.E1.m1.8.8">𝑔</ci></interval></apply><cn id="S3.E1.m1.9.9.1.1.2.2.3.cmml" type="integer" xref="S3.E1.m1.9.9.1.1.2.2.3">0</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.9c">\pi(a|s,g)=\frac{1}{Z(s,g)}\prod_{i=1}^{K}\pi_{i}(a|s)^{w_{i}(s,g)},\quad w_{i%
}(s,g)\geq 0.</annotation><annotation encoding="application/x-llamapun" id="S3.E1.m1.9d">italic_π ( italic_a | italic_s , italic_g ) = divide start_ARG 1 end_ARG start_ARG italic_Z ( italic_s , italic_g ) end_ARG ∏ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT italic_π start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ( italic_a | italic_s ) start_POSTSUPERSCRIPT italic_w start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ( italic_s , italic_g ) end_POSTSUPERSCRIPT , italic_w start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ( italic_s , italic_g ) ≥ 0 .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.p1.20">A gating function <math alttext="w" class="ltx_Math" display="inline" id="S3.SS2.p1.3.m1.1"><semantics id="S3.SS2.p1.3.m1.1a"><mi id="S3.SS2.p1.3.m1.1.1" xref="S3.SS2.p1.3.m1.1.1.cmml">w</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.3.m1.1b"><ci id="S3.SS2.p1.3.m1.1.1.cmml" xref="S3.SS2.p1.3.m1.1.1">𝑤</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.3.m1.1c">w</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.3.m1.1d">italic_w</annotation></semantics></math> specifies each weight <math alttext="w_{i}(s,g)\in\mathbb{R}_{+}" class="ltx_Math" display="inline" id="S3.SS2.p1.4.m2.2"><semantics id="S3.SS2.p1.4.m2.2a"><mrow id="S3.SS2.p1.4.m2.2.3" xref="S3.SS2.p1.4.m2.2.3.cmml"><mrow id="S3.SS2.p1.4.m2.2.3.2" xref="S3.SS2.p1.4.m2.2.3.2.cmml"><msub id="S3.SS2.p1.4.m2.2.3.2.2" xref="S3.SS2.p1.4.m2.2.3.2.2.cmml"><mi id="S3.SS2.p1.4.m2.2.3.2.2.2" xref="S3.SS2.p1.4.m2.2.3.2.2.2.cmml">w</mi><mi id="S3.SS2.p1.4.m2.2.3.2.2.3" xref="S3.SS2.p1.4.m2.2.3.2.2.3.cmml">i</mi></msub><mo id="S3.SS2.p1.4.m2.2.3.2.1" xref="S3.SS2.p1.4.m2.2.3.2.1.cmml">⁢</mo><mrow id="S3.SS2.p1.4.m2.2.3.2.3.2" xref="S3.SS2.p1.4.m2.2.3.2.3.1.cmml"><mo id="S3.SS2.p1.4.m2.2.3.2.3.2.1" stretchy="false" xref="S3.SS2.p1.4.m2.2.3.2.3.1.cmml">(</mo><mi id="S3.SS2.p1.4.m2.1.1" xref="S3.SS2.p1.4.m2.1.1.cmml">s</mi><mo id="S3.SS2.p1.4.m2.2.3.2.3.2.2" xref="S3.SS2.p1.4.m2.2.3.2.3.1.cmml">,</mo><mi id="S3.SS2.p1.4.m2.2.2" xref="S3.SS2.p1.4.m2.2.2.cmml">g</mi><mo id="S3.SS2.p1.4.m2.2.3.2.3.2.3" stretchy="false" xref="S3.SS2.p1.4.m2.2.3.2.3.1.cmml">)</mo></mrow></mrow><mo id="S3.SS2.p1.4.m2.2.3.1" xref="S3.SS2.p1.4.m2.2.3.1.cmml">∈</mo><msub id="S3.SS2.p1.4.m2.2.3.3" xref="S3.SS2.p1.4.m2.2.3.3.cmml"><mi id="S3.SS2.p1.4.m2.2.3.3.2" xref="S3.SS2.p1.4.m2.2.3.3.2.cmml">ℝ</mi><mo id="S3.SS2.p1.4.m2.2.3.3.3" xref="S3.SS2.p1.4.m2.2.3.3.3.cmml">+</mo></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.4.m2.2b"><apply id="S3.SS2.p1.4.m2.2.3.cmml" xref="S3.SS2.p1.4.m2.2.3"><in id="S3.SS2.p1.4.m2.2.3.1.cmml" xref="S3.SS2.p1.4.m2.2.3.1"></in><apply id="S3.SS2.p1.4.m2.2.3.2.cmml" xref="S3.SS2.p1.4.m2.2.3.2"><times id="S3.SS2.p1.4.m2.2.3.2.1.cmml" xref="S3.SS2.p1.4.m2.2.3.2.1"></times><apply id="S3.SS2.p1.4.m2.2.3.2.2.cmml" xref="S3.SS2.p1.4.m2.2.3.2.2"><csymbol cd="ambiguous" id="S3.SS2.p1.4.m2.2.3.2.2.1.cmml" xref="S3.SS2.p1.4.m2.2.3.2.2">subscript</csymbol><ci id="S3.SS2.p1.4.m2.2.3.2.2.2.cmml" xref="S3.SS2.p1.4.m2.2.3.2.2.2">𝑤</ci><ci id="S3.SS2.p1.4.m2.2.3.2.2.3.cmml" xref="S3.SS2.p1.4.m2.2.3.2.2.3">𝑖</ci></apply><interval closure="open" id="S3.SS2.p1.4.m2.2.3.2.3.1.cmml" xref="S3.SS2.p1.4.m2.2.3.2.3.2"><ci id="S3.SS2.p1.4.m2.1.1.cmml" xref="S3.SS2.p1.4.m2.1.1">𝑠</ci><ci id="S3.SS2.p1.4.m2.2.2.cmml" xref="S3.SS2.p1.4.m2.2.2">𝑔</ci></interval></apply><apply id="S3.SS2.p1.4.m2.2.3.3.cmml" xref="S3.SS2.p1.4.m2.2.3.3"><csymbol cd="ambiguous" id="S3.SS2.p1.4.m2.2.3.3.1.cmml" xref="S3.SS2.p1.4.m2.2.3.3">subscript</csymbol><ci id="S3.SS2.p1.4.m2.2.3.3.2.cmml" xref="S3.SS2.p1.4.m2.2.3.3.2">ℝ</ci><plus id="S3.SS2.p1.4.m2.2.3.3.3.cmml" xref="S3.SS2.p1.4.m2.2.3.3.3"></plus></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.4.m2.2c">w_{i}(s,g)\in\mathbb{R}_{+}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.4.m2.2d">italic_w start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ( italic_s , italic_g ) ∈ blackboard_R start_POSTSUBSCRIPT + end_POSTSUBSCRIPT</annotation></semantics></math>, which determines the contribution of the <math alttext="i" class="ltx_Math" display="inline" id="S3.SS2.p1.5.m3.1"><semantics id="S3.SS2.p1.5.m3.1a"><mi id="S3.SS2.p1.5.m3.1.1" xref="S3.SS2.p1.5.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.5.m3.1b"><ci id="S3.SS2.p1.5.m3.1.1.cmml" xref="S3.SS2.p1.5.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.5.m3.1c">i</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.5.m3.1d">italic_i</annotation></semantics></math>-th primitive on the composite action distribution, with a larger weight corresponding to a larger influence.
<math alttext="Z(s,g)" class="ltx_Math" display="inline" id="S3.SS2.p1.6.m4.2"><semantics id="S3.SS2.p1.6.m4.2a"><mrow id="S3.SS2.p1.6.m4.2.3" xref="S3.SS2.p1.6.m4.2.3.cmml"><mi id="S3.SS2.p1.6.m4.2.3.2" xref="S3.SS2.p1.6.m4.2.3.2.cmml">Z</mi><mo id="S3.SS2.p1.6.m4.2.3.1" xref="S3.SS2.p1.6.m4.2.3.1.cmml">⁢</mo><mrow id="S3.SS2.p1.6.m4.2.3.3.2" xref="S3.SS2.p1.6.m4.2.3.3.1.cmml"><mo id="S3.SS2.p1.6.m4.2.3.3.2.1" stretchy="false" xref="S3.SS2.p1.6.m4.2.3.3.1.cmml">(</mo><mi id="S3.SS2.p1.6.m4.1.1" xref="S3.SS2.p1.6.m4.1.1.cmml">s</mi><mo id="S3.SS2.p1.6.m4.2.3.3.2.2" xref="S3.SS2.p1.6.m4.2.3.3.1.cmml">,</mo><mi id="S3.SS2.p1.6.m4.2.2" xref="S3.SS2.p1.6.m4.2.2.cmml">g</mi><mo id="S3.SS2.p1.6.m4.2.3.3.2.3" stretchy="false" xref="S3.SS2.p1.6.m4.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.6.m4.2b"><apply id="S3.SS2.p1.6.m4.2.3.cmml" xref="S3.SS2.p1.6.m4.2.3"><times id="S3.SS2.p1.6.m4.2.3.1.cmml" xref="S3.SS2.p1.6.m4.2.3.1"></times><ci id="S3.SS2.p1.6.m4.2.3.2.cmml" xref="S3.SS2.p1.6.m4.2.3.2">𝑍</ci><interval closure="open" id="S3.SS2.p1.6.m4.2.3.3.1.cmml" xref="S3.SS2.p1.6.m4.2.3.3.2"><ci id="S3.SS2.p1.6.m4.1.1.cmml" xref="S3.SS2.p1.6.m4.1.1">𝑠</ci><ci id="S3.SS2.p1.6.m4.2.2.cmml" xref="S3.SS2.p1.6.m4.2.2">𝑔</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.6.m4.2c">Z(s,g)</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.6.m4.2d">italic_Z ( italic_s , italic_g )</annotation></semantics></math> is a normalizing term.
The <math alttext="i" class="ltx_Math" display="inline" id="S3.SS2.p1.7.m5.1"><semantics id="S3.SS2.p1.7.m5.1a"><mi id="S3.SS2.p1.7.m5.1.1" xref="S3.SS2.p1.7.m5.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.7.m5.1b"><ci id="S3.SS2.p1.7.m5.1.1.cmml" xref="S3.SS2.p1.7.m5.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.7.m5.1c">i</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.7.m5.1d">italic_i</annotation></semantics></math>-th primitive is modeled as a Gaussian distribution <math alttext="\pi_{i}(a|s)=\mathcal{N}(\mu_{i}(s),\Sigma_{i}(s))" class="ltx_Math" display="inline" id="S3.SS2.p1.8.m6.5"><semantics id="S3.SS2.p1.8.m6.5a"><mrow id="S3.SS2.p1.8.m6.5.5" xref="S3.SS2.p1.8.m6.5.5.cmml"><mrow id="S3.SS2.p1.8.m6.3.3.1" xref="S3.SS2.p1.8.m6.3.3.1.cmml"><msub id="S3.SS2.p1.8.m6.3.3.1.3" xref="S3.SS2.p1.8.m6.3.3.1.3.cmml"><mi id="S3.SS2.p1.8.m6.3.3.1.3.2" xref="S3.SS2.p1.8.m6.3.3.1.3.2.cmml">π</mi><mi id="S3.SS2.p1.8.m6.3.3.1.3.3" xref="S3.SS2.p1.8.m6.3.3.1.3.3.cmml">i</mi></msub><mo id="S3.SS2.p1.8.m6.3.3.1.2" xref="S3.SS2.p1.8.m6.3.3.1.2.cmml">⁢</mo><mrow id="S3.SS2.p1.8.m6.3.3.1.1.1" xref="S3.SS2.p1.8.m6.3.3.1.1.1.1.cmml"><mo id="S3.SS2.p1.8.m6.3.3.1.1.1.2" stretchy="false" xref="S3.SS2.p1.8.m6.3.3.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.p1.8.m6.3.3.1.1.1.1" xref="S3.SS2.p1.8.m6.3.3.1.1.1.1.cmml"><mi id="S3.SS2.p1.8.m6.3.3.1.1.1.1.2" xref="S3.SS2.p1.8.m6.3.3.1.1.1.1.2.cmml">a</mi><mo fence="false" id="S3.SS2.p1.8.m6.3.3.1.1.1.1.1" xref="S3.SS2.p1.8.m6.3.3.1.1.1.1.1.cmml">|</mo><mi id="S3.SS2.p1.8.m6.3.3.1.1.1.1.3" xref="S3.SS2.p1.8.m6.3.3.1.1.1.1.3.cmml">s</mi></mrow><mo id="S3.SS2.p1.8.m6.3.3.1.1.1.3" stretchy="false" xref="S3.SS2.p1.8.m6.3.3.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS2.p1.8.m6.5.5.4" xref="S3.SS2.p1.8.m6.5.5.4.cmml">=</mo><mrow id="S3.SS2.p1.8.m6.5.5.3" xref="S3.SS2.p1.8.m6.5.5.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.8.m6.5.5.3.4" xref="S3.SS2.p1.8.m6.5.5.3.4.cmml">𝒩</mi><mo id="S3.SS2.p1.8.m6.5.5.3.3" xref="S3.SS2.p1.8.m6.5.5.3.3.cmml">⁢</mo><mrow id="S3.SS2.p1.8.m6.5.5.3.2.2" xref="S3.SS2.p1.8.m6.5.5.3.2.3.cmml"><mo id="S3.SS2.p1.8.m6.5.5.3.2.2.3" stretchy="false" xref="S3.SS2.p1.8.m6.5.5.3.2.3.cmml">(</mo><mrow id="S3.SS2.p1.8.m6.4.4.2.1.1.1" xref="S3.SS2.p1.8.m6.4.4.2.1.1.1.cmml"><msub id="S3.SS2.p1.8.m6.4.4.2.1.1.1.2" xref="S3.SS2.p1.8.m6.4.4.2.1.1.1.2.cmml"><mi id="S3.SS2.p1.8.m6.4.4.2.1.1.1.2.2" xref="S3.SS2.p1.8.m6.4.4.2.1.1.1.2.2.cmml">μ</mi><mi id="S3.SS2.p1.8.m6.4.4.2.1.1.1.2.3" xref="S3.SS2.p1.8.m6.4.4.2.1.1.1.2.3.cmml">i</mi></msub><mo id="S3.SS2.p1.8.m6.4.4.2.1.1.1.1" xref="S3.SS2.p1.8.m6.4.4.2.1.1.1.1.cmml">⁢</mo><mrow id="S3.SS2.p1.8.m6.4.4.2.1.1.1.3.2" xref="S3.SS2.p1.8.m6.4.4.2.1.1.1.cmml"><mo id="S3.SS2.p1.8.m6.4.4.2.1.1.1.3.2.1" stretchy="false" xref="S3.SS2.p1.8.m6.4.4.2.1.1.1.cmml">(</mo><mi id="S3.SS2.p1.8.m6.1.1" xref="S3.SS2.p1.8.m6.1.1.cmml">s</mi><mo id="S3.SS2.p1.8.m6.4.4.2.1.1.1.3.2.2" stretchy="false" xref="S3.SS2.p1.8.m6.4.4.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS2.p1.8.m6.5.5.3.2.2.4" xref="S3.SS2.p1.8.m6.5.5.3.2.3.cmml">,</mo><mrow id="S3.SS2.p1.8.m6.5.5.3.2.2.2" xref="S3.SS2.p1.8.m6.5.5.3.2.2.2.cmml"><msub id="S3.SS2.p1.8.m6.5.5.3.2.2.2.2" xref="S3.SS2.p1.8.m6.5.5.3.2.2.2.2.cmml"><mi id="S3.SS2.p1.8.m6.5.5.3.2.2.2.2.2" mathvariant="normal" xref="S3.SS2.p1.8.m6.5.5.3.2.2.2.2.2.cmml">Σ</mi><mi id="S3.SS2.p1.8.m6.5.5.3.2.2.2.2.3" xref="S3.SS2.p1.8.m6.5.5.3.2.2.2.2.3.cmml">i</mi></msub><mo id="S3.SS2.p1.8.m6.5.5.3.2.2.2.1" xref="S3.SS2.p1.8.m6.5.5.3.2.2.2.1.cmml">⁢</mo><mrow id="S3.SS2.p1.8.m6.5.5.3.2.2.2.3.2" xref="S3.SS2.p1.8.m6.5.5.3.2.2.2.cmml"><mo id="S3.SS2.p1.8.m6.5.5.3.2.2.2.3.2.1" stretchy="false" xref="S3.SS2.p1.8.m6.5.5.3.2.2.2.cmml">(</mo><mi id="S3.SS2.p1.8.m6.2.2" xref="S3.SS2.p1.8.m6.2.2.cmml">s</mi><mo id="S3.SS2.p1.8.m6.5.5.3.2.2.2.3.2.2" stretchy="false" xref="S3.SS2.p1.8.m6.5.5.3.2.2.2.cmml">)</mo></mrow></mrow><mo id="S3.SS2.p1.8.m6.5.5.3.2.2.5" stretchy="false" xref="S3.SS2.p1.8.m6.5.5.3.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.8.m6.5b"><apply id="S3.SS2.p1.8.m6.5.5.cmml" xref="S3.SS2.p1.8.m6.5.5"><eq id="S3.SS2.p1.8.m6.5.5.4.cmml" xref="S3.SS2.p1.8.m6.5.5.4"></eq><apply id="S3.SS2.p1.8.m6.3.3.1.cmml" xref="S3.SS2.p1.8.m6.3.3.1"><times id="S3.SS2.p1.8.m6.3.3.1.2.cmml" xref="S3.SS2.p1.8.m6.3.3.1.2"></times><apply id="S3.SS2.p1.8.m6.3.3.1.3.cmml" xref="S3.SS2.p1.8.m6.3.3.1.3"><csymbol cd="ambiguous" id="S3.SS2.p1.8.m6.3.3.1.3.1.cmml" xref="S3.SS2.p1.8.m6.3.3.1.3">subscript</csymbol><ci id="S3.SS2.p1.8.m6.3.3.1.3.2.cmml" xref="S3.SS2.p1.8.m6.3.3.1.3.2">𝜋</ci><ci id="S3.SS2.p1.8.m6.3.3.1.3.3.cmml" xref="S3.SS2.p1.8.m6.3.3.1.3.3">𝑖</ci></apply><apply id="S3.SS2.p1.8.m6.3.3.1.1.1.1.cmml" xref="S3.SS2.p1.8.m6.3.3.1.1.1"><csymbol cd="latexml" id="S3.SS2.p1.8.m6.3.3.1.1.1.1.1.cmml" xref="S3.SS2.p1.8.m6.3.3.1.1.1.1.1">conditional</csymbol><ci id="S3.SS2.p1.8.m6.3.3.1.1.1.1.2.cmml" xref="S3.SS2.p1.8.m6.3.3.1.1.1.1.2">𝑎</ci><ci id="S3.SS2.p1.8.m6.3.3.1.1.1.1.3.cmml" xref="S3.SS2.p1.8.m6.3.3.1.1.1.1.3">𝑠</ci></apply></apply><apply id="S3.SS2.p1.8.m6.5.5.3.cmml" xref="S3.SS2.p1.8.m6.5.5.3"><times id="S3.SS2.p1.8.m6.5.5.3.3.cmml" xref="S3.SS2.p1.8.m6.5.5.3.3"></times><ci id="S3.SS2.p1.8.m6.5.5.3.4.cmml" xref="S3.SS2.p1.8.m6.5.5.3.4">𝒩</ci><interval closure="open" id="S3.SS2.p1.8.m6.5.5.3.2.3.cmml" xref="S3.SS2.p1.8.m6.5.5.3.2.2"><apply id="S3.SS2.p1.8.m6.4.4.2.1.1.1.cmml" xref="S3.SS2.p1.8.m6.4.4.2.1.1.1"><times id="S3.SS2.p1.8.m6.4.4.2.1.1.1.1.cmml" xref="S3.SS2.p1.8.m6.4.4.2.1.1.1.1"></times><apply id="S3.SS2.p1.8.m6.4.4.2.1.1.1.2.cmml" xref="S3.SS2.p1.8.m6.4.4.2.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p1.8.m6.4.4.2.1.1.1.2.1.cmml" xref="S3.SS2.p1.8.m6.4.4.2.1.1.1.2">subscript</csymbol><ci id="S3.SS2.p1.8.m6.4.4.2.1.1.1.2.2.cmml" xref="S3.SS2.p1.8.m6.4.4.2.1.1.1.2.2">𝜇</ci><ci id="S3.SS2.p1.8.m6.4.4.2.1.1.1.2.3.cmml" xref="S3.SS2.p1.8.m6.4.4.2.1.1.1.2.3">𝑖</ci></apply><ci id="S3.SS2.p1.8.m6.1.1.cmml" xref="S3.SS2.p1.8.m6.1.1">𝑠</ci></apply><apply id="S3.SS2.p1.8.m6.5.5.3.2.2.2.cmml" xref="S3.SS2.p1.8.m6.5.5.3.2.2.2"><times id="S3.SS2.p1.8.m6.5.5.3.2.2.2.1.cmml" xref="S3.SS2.p1.8.m6.5.5.3.2.2.2.1"></times><apply id="S3.SS2.p1.8.m6.5.5.3.2.2.2.2.cmml" xref="S3.SS2.p1.8.m6.5.5.3.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p1.8.m6.5.5.3.2.2.2.2.1.cmml" xref="S3.SS2.p1.8.m6.5.5.3.2.2.2.2">subscript</csymbol><ci id="S3.SS2.p1.8.m6.5.5.3.2.2.2.2.2.cmml" xref="S3.SS2.p1.8.m6.5.5.3.2.2.2.2.2">Σ</ci><ci id="S3.SS2.p1.8.m6.5.5.3.2.2.2.2.3.cmml" xref="S3.SS2.p1.8.m6.5.5.3.2.2.2.2.3">𝑖</ci></apply><ci id="S3.SS2.p1.8.m6.2.2.cmml" xref="S3.SS2.p1.8.m6.2.2">𝑠</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.8.m6.5c">\pi_{i}(a|s)=\mathcal{N}(\mu_{i}(s),\Sigma_{i}(s))</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.8.m6.5d">italic_π start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ( italic_a | italic_s ) = caligraphic_N ( italic_μ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ( italic_s ) , roman_Σ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ( italic_s ) )</annotation></semantics></math> with mean <math alttext="\mu_{i}(s)" class="ltx_Math" display="inline" id="S3.SS2.p1.9.m7.1"><semantics id="S3.SS2.p1.9.m7.1a"><mrow id="S3.SS2.p1.9.m7.1.2" xref="S3.SS2.p1.9.m7.1.2.cmml"><msub id="S3.SS2.p1.9.m7.1.2.2" xref="S3.SS2.p1.9.m7.1.2.2.cmml"><mi id="S3.SS2.p1.9.m7.1.2.2.2" xref="S3.SS2.p1.9.m7.1.2.2.2.cmml">μ</mi><mi id="S3.SS2.p1.9.m7.1.2.2.3" xref="S3.SS2.p1.9.m7.1.2.2.3.cmml">i</mi></msub><mo id="S3.SS2.p1.9.m7.1.2.1" xref="S3.SS2.p1.9.m7.1.2.1.cmml">⁢</mo><mrow id="S3.SS2.p1.9.m7.1.2.3.2" xref="S3.SS2.p1.9.m7.1.2.cmml"><mo id="S3.SS2.p1.9.m7.1.2.3.2.1" stretchy="false" xref="S3.SS2.p1.9.m7.1.2.cmml">(</mo><mi id="S3.SS2.p1.9.m7.1.1" xref="S3.SS2.p1.9.m7.1.1.cmml">s</mi><mo id="S3.SS2.p1.9.m7.1.2.3.2.2" stretchy="false" xref="S3.SS2.p1.9.m7.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.9.m7.1b"><apply id="S3.SS2.p1.9.m7.1.2.cmml" xref="S3.SS2.p1.9.m7.1.2"><times id="S3.SS2.p1.9.m7.1.2.1.cmml" xref="S3.SS2.p1.9.m7.1.2.1"></times><apply id="S3.SS2.p1.9.m7.1.2.2.cmml" xref="S3.SS2.p1.9.m7.1.2.2"><csymbol cd="ambiguous" id="S3.SS2.p1.9.m7.1.2.2.1.cmml" xref="S3.SS2.p1.9.m7.1.2.2">subscript</csymbol><ci id="S3.SS2.p1.9.m7.1.2.2.2.cmml" xref="S3.SS2.p1.9.m7.1.2.2.2">𝜇</ci><ci id="S3.SS2.p1.9.m7.1.2.2.3.cmml" xref="S3.SS2.p1.9.m7.1.2.2.3">𝑖</ci></apply><ci id="S3.SS2.p1.9.m7.1.1.cmml" xref="S3.SS2.p1.9.m7.1.1">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.9.m7.1c">\mu_{i}(s)</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.9.m7.1d">italic_μ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ( italic_s )</annotation></semantics></math> and diagonal covariance matrix <math alttext="\Sigma_{i}(s)=\mathrm{diag}\left(\sigma_{i}^{1}(s),\sigma_{i}^{2}(s),\ldots,%
\sigma_{i}^{|\mathcal{A}|}(s)\right)" class="ltx_Math" display="inline" id="S3.SS2.p1.10.m8.9"><semantics id="S3.SS2.p1.10.m8.9a"><mrow id="S3.SS2.p1.10.m8.9.9" xref="S3.SS2.p1.10.m8.9.9.cmml"><mrow id="S3.SS2.p1.10.m8.9.9.5" xref="S3.SS2.p1.10.m8.9.9.5.cmml"><msub id="S3.SS2.p1.10.m8.9.9.5.2" xref="S3.SS2.p1.10.m8.9.9.5.2.cmml"><mi id="S3.SS2.p1.10.m8.9.9.5.2.2" mathvariant="normal" xref="S3.SS2.p1.10.m8.9.9.5.2.2.cmml">Σ</mi><mi id="S3.SS2.p1.10.m8.9.9.5.2.3" xref="S3.SS2.p1.10.m8.9.9.5.2.3.cmml">i</mi></msub><mo id="S3.SS2.p1.10.m8.9.9.5.1" xref="S3.SS2.p1.10.m8.9.9.5.1.cmml">⁢</mo><mrow id="S3.SS2.p1.10.m8.9.9.5.3.2" xref="S3.SS2.p1.10.m8.9.9.5.cmml"><mo id="S3.SS2.p1.10.m8.9.9.5.3.2.1" stretchy="false" xref="S3.SS2.p1.10.m8.9.9.5.cmml">(</mo><mi id="S3.SS2.p1.10.m8.2.2" xref="S3.SS2.p1.10.m8.2.2.cmml">s</mi><mo id="S3.SS2.p1.10.m8.9.9.5.3.2.2" stretchy="false" xref="S3.SS2.p1.10.m8.9.9.5.cmml">)</mo></mrow></mrow><mo id="S3.SS2.p1.10.m8.9.9.4" xref="S3.SS2.p1.10.m8.9.9.4.cmml">=</mo><mrow id="S3.SS2.p1.10.m8.9.9.3" xref="S3.SS2.p1.10.m8.9.9.3.cmml"><mi id="S3.SS2.p1.10.m8.9.9.3.5" xref="S3.SS2.p1.10.m8.9.9.3.5.cmml">diag</mi><mo id="S3.SS2.p1.10.m8.9.9.3.4" xref="S3.SS2.p1.10.m8.9.9.3.4.cmml">⁢</mo><mrow id="S3.SS2.p1.10.m8.9.9.3.3.3" xref="S3.SS2.p1.10.m8.9.9.3.3.4.cmml"><mo id="S3.SS2.p1.10.m8.9.9.3.3.3.4" xref="S3.SS2.p1.10.m8.9.9.3.3.4.cmml">(</mo><mrow id="S3.SS2.p1.10.m8.7.7.1.1.1.1" xref="S3.SS2.p1.10.m8.7.7.1.1.1.1.cmml"><msubsup id="S3.SS2.p1.10.m8.7.7.1.1.1.1.2" xref="S3.SS2.p1.10.m8.7.7.1.1.1.1.2.cmml"><mi id="S3.SS2.p1.10.m8.7.7.1.1.1.1.2.2.2" xref="S3.SS2.p1.10.m8.7.7.1.1.1.1.2.2.2.cmml">σ</mi><mi id="S3.SS2.p1.10.m8.7.7.1.1.1.1.2.2.3" xref="S3.SS2.p1.10.m8.7.7.1.1.1.1.2.2.3.cmml">i</mi><mn id="S3.SS2.p1.10.m8.7.7.1.1.1.1.2.3" xref="S3.SS2.p1.10.m8.7.7.1.1.1.1.2.3.cmml">1</mn></msubsup><mo id="S3.SS2.p1.10.m8.7.7.1.1.1.1.1" xref="S3.SS2.p1.10.m8.7.7.1.1.1.1.1.cmml">⁢</mo><mrow id="S3.SS2.p1.10.m8.7.7.1.1.1.1.3.2" xref="S3.SS2.p1.10.m8.7.7.1.1.1.1.cmml"><mo id="S3.SS2.p1.10.m8.7.7.1.1.1.1.3.2.1" stretchy="false" xref="S3.SS2.p1.10.m8.7.7.1.1.1.1.cmml">(</mo><mi id="S3.SS2.p1.10.m8.3.3" xref="S3.SS2.p1.10.m8.3.3.cmml">s</mi><mo id="S3.SS2.p1.10.m8.7.7.1.1.1.1.3.2.2" stretchy="false" xref="S3.SS2.p1.10.m8.7.7.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS2.p1.10.m8.9.9.3.3.3.5" xref="S3.SS2.p1.10.m8.9.9.3.3.4.cmml">,</mo><mrow id="S3.SS2.p1.10.m8.8.8.2.2.2.2" xref="S3.SS2.p1.10.m8.8.8.2.2.2.2.cmml"><msubsup id="S3.SS2.p1.10.m8.8.8.2.2.2.2.2" xref="S3.SS2.p1.10.m8.8.8.2.2.2.2.2.cmml"><mi id="S3.SS2.p1.10.m8.8.8.2.2.2.2.2.2.2" xref="S3.SS2.p1.10.m8.8.8.2.2.2.2.2.2.2.cmml">σ</mi><mi id="S3.SS2.p1.10.m8.8.8.2.2.2.2.2.2.3" xref="S3.SS2.p1.10.m8.8.8.2.2.2.2.2.2.3.cmml">i</mi><mn id="S3.SS2.p1.10.m8.8.8.2.2.2.2.2.3" xref="S3.SS2.p1.10.m8.8.8.2.2.2.2.2.3.cmml">2</mn></msubsup><mo id="S3.SS2.p1.10.m8.8.8.2.2.2.2.1" xref="S3.SS2.p1.10.m8.8.8.2.2.2.2.1.cmml">⁢</mo><mrow id="S3.SS2.p1.10.m8.8.8.2.2.2.2.3.2" xref="S3.SS2.p1.10.m8.8.8.2.2.2.2.cmml"><mo id="S3.SS2.p1.10.m8.8.8.2.2.2.2.3.2.1" stretchy="false" xref="S3.SS2.p1.10.m8.8.8.2.2.2.2.cmml">(</mo><mi id="S3.SS2.p1.10.m8.4.4" xref="S3.SS2.p1.10.m8.4.4.cmml">s</mi><mo id="S3.SS2.p1.10.m8.8.8.2.2.2.2.3.2.2" stretchy="false" xref="S3.SS2.p1.10.m8.8.8.2.2.2.2.cmml">)</mo></mrow></mrow><mo id="S3.SS2.p1.10.m8.9.9.3.3.3.6" xref="S3.SS2.p1.10.m8.9.9.3.3.4.cmml">,</mo><mi id="S3.SS2.p1.10.m8.6.6" mathvariant="normal" xref="S3.SS2.p1.10.m8.6.6.cmml">…</mi><mo id="S3.SS2.p1.10.m8.9.9.3.3.3.7" xref="S3.SS2.p1.10.m8.9.9.3.3.4.cmml">,</mo><mrow id="S3.SS2.p1.10.m8.9.9.3.3.3.3" xref="S3.SS2.p1.10.m8.9.9.3.3.3.3.cmml"><msubsup id="S3.SS2.p1.10.m8.9.9.3.3.3.3.2" xref="S3.SS2.p1.10.m8.9.9.3.3.3.3.2.cmml"><mi id="S3.SS2.p1.10.m8.9.9.3.3.3.3.2.2.2" xref="S3.SS2.p1.10.m8.9.9.3.3.3.3.2.2.2.cmml">σ</mi><mi id="S3.SS2.p1.10.m8.9.9.3.3.3.3.2.2.3" xref="S3.SS2.p1.10.m8.9.9.3.3.3.3.2.2.3.cmml">i</mi><mrow id="S3.SS2.p1.10.m8.1.1.1.3" xref="S3.SS2.p1.10.m8.1.1.1.2.cmml"><mo id="S3.SS2.p1.10.m8.1.1.1.3.1" stretchy="false" xref="S3.SS2.p1.10.m8.1.1.1.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.10.m8.1.1.1.1" xref="S3.SS2.p1.10.m8.1.1.1.1.cmml">𝒜</mi><mo id="S3.SS2.p1.10.m8.1.1.1.3.2" stretchy="false" xref="S3.SS2.p1.10.m8.1.1.1.2.1.cmml">|</mo></mrow></msubsup><mo id="S3.SS2.p1.10.m8.9.9.3.3.3.3.1" xref="S3.SS2.p1.10.m8.9.9.3.3.3.3.1.cmml">⁢</mo><mrow id="S3.SS2.p1.10.m8.9.9.3.3.3.3.3.2" xref="S3.SS2.p1.10.m8.9.9.3.3.3.3.cmml"><mo id="S3.SS2.p1.10.m8.9.9.3.3.3.3.3.2.1" stretchy="false" xref="S3.SS2.p1.10.m8.9.9.3.3.3.3.cmml">(</mo><mi id="S3.SS2.p1.10.m8.5.5" xref="S3.SS2.p1.10.m8.5.5.cmml">s</mi><mo id="S3.SS2.p1.10.m8.9.9.3.3.3.3.3.2.2" stretchy="false" xref="S3.SS2.p1.10.m8.9.9.3.3.3.3.cmml">)</mo></mrow></mrow><mo id="S3.SS2.p1.10.m8.9.9.3.3.3.8" xref="S3.SS2.p1.10.m8.9.9.3.3.4.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.10.m8.9b"><apply id="S3.SS2.p1.10.m8.9.9.cmml" xref="S3.SS2.p1.10.m8.9.9"><eq id="S3.SS2.p1.10.m8.9.9.4.cmml" xref="S3.SS2.p1.10.m8.9.9.4"></eq><apply id="S3.SS2.p1.10.m8.9.9.5.cmml" xref="S3.SS2.p1.10.m8.9.9.5"><times id="S3.SS2.p1.10.m8.9.9.5.1.cmml" xref="S3.SS2.p1.10.m8.9.9.5.1"></times><apply id="S3.SS2.p1.10.m8.9.9.5.2.cmml" xref="S3.SS2.p1.10.m8.9.9.5.2"><csymbol cd="ambiguous" id="S3.SS2.p1.10.m8.9.9.5.2.1.cmml" xref="S3.SS2.p1.10.m8.9.9.5.2">subscript</csymbol><ci id="S3.SS2.p1.10.m8.9.9.5.2.2.cmml" xref="S3.SS2.p1.10.m8.9.9.5.2.2">Σ</ci><ci id="S3.SS2.p1.10.m8.9.9.5.2.3.cmml" xref="S3.SS2.p1.10.m8.9.9.5.2.3">𝑖</ci></apply><ci id="S3.SS2.p1.10.m8.2.2.cmml" xref="S3.SS2.p1.10.m8.2.2">𝑠</ci></apply><apply id="S3.SS2.p1.10.m8.9.9.3.cmml" xref="S3.SS2.p1.10.m8.9.9.3"><times id="S3.SS2.p1.10.m8.9.9.3.4.cmml" xref="S3.SS2.p1.10.m8.9.9.3.4"></times><ci id="S3.SS2.p1.10.m8.9.9.3.5.cmml" xref="S3.SS2.p1.10.m8.9.9.3.5">diag</ci><vector id="S3.SS2.p1.10.m8.9.9.3.3.4.cmml" xref="S3.SS2.p1.10.m8.9.9.3.3.3"><apply id="S3.SS2.p1.10.m8.7.7.1.1.1.1.cmml" xref="S3.SS2.p1.10.m8.7.7.1.1.1.1"><times id="S3.SS2.p1.10.m8.7.7.1.1.1.1.1.cmml" xref="S3.SS2.p1.10.m8.7.7.1.1.1.1.1"></times><apply id="S3.SS2.p1.10.m8.7.7.1.1.1.1.2.cmml" xref="S3.SS2.p1.10.m8.7.7.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p1.10.m8.7.7.1.1.1.1.2.1.cmml" xref="S3.SS2.p1.10.m8.7.7.1.1.1.1.2">superscript</csymbol><apply id="S3.SS2.p1.10.m8.7.7.1.1.1.1.2.2.cmml" xref="S3.SS2.p1.10.m8.7.7.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p1.10.m8.7.7.1.1.1.1.2.2.1.cmml" xref="S3.SS2.p1.10.m8.7.7.1.1.1.1.2">subscript</csymbol><ci id="S3.SS2.p1.10.m8.7.7.1.1.1.1.2.2.2.cmml" xref="S3.SS2.p1.10.m8.7.7.1.1.1.1.2.2.2">𝜎</ci><ci id="S3.SS2.p1.10.m8.7.7.1.1.1.1.2.2.3.cmml" xref="S3.SS2.p1.10.m8.7.7.1.1.1.1.2.2.3">𝑖</ci></apply><cn id="S3.SS2.p1.10.m8.7.7.1.1.1.1.2.3.cmml" type="integer" xref="S3.SS2.p1.10.m8.7.7.1.1.1.1.2.3">1</cn></apply><ci id="S3.SS2.p1.10.m8.3.3.cmml" xref="S3.SS2.p1.10.m8.3.3">𝑠</ci></apply><apply id="S3.SS2.p1.10.m8.8.8.2.2.2.2.cmml" xref="S3.SS2.p1.10.m8.8.8.2.2.2.2"><times id="S3.SS2.p1.10.m8.8.8.2.2.2.2.1.cmml" xref="S3.SS2.p1.10.m8.8.8.2.2.2.2.1"></times><apply id="S3.SS2.p1.10.m8.8.8.2.2.2.2.2.cmml" xref="S3.SS2.p1.10.m8.8.8.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p1.10.m8.8.8.2.2.2.2.2.1.cmml" xref="S3.SS2.p1.10.m8.8.8.2.2.2.2.2">superscript</csymbol><apply id="S3.SS2.p1.10.m8.8.8.2.2.2.2.2.2.cmml" xref="S3.SS2.p1.10.m8.8.8.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p1.10.m8.8.8.2.2.2.2.2.2.1.cmml" xref="S3.SS2.p1.10.m8.8.8.2.2.2.2.2">subscript</csymbol><ci id="S3.SS2.p1.10.m8.8.8.2.2.2.2.2.2.2.cmml" xref="S3.SS2.p1.10.m8.8.8.2.2.2.2.2.2.2">𝜎</ci><ci id="S3.SS2.p1.10.m8.8.8.2.2.2.2.2.2.3.cmml" xref="S3.SS2.p1.10.m8.8.8.2.2.2.2.2.2.3">𝑖</ci></apply><cn id="S3.SS2.p1.10.m8.8.8.2.2.2.2.2.3.cmml" type="integer" xref="S3.SS2.p1.10.m8.8.8.2.2.2.2.2.3">2</cn></apply><ci id="S3.SS2.p1.10.m8.4.4.cmml" xref="S3.SS2.p1.10.m8.4.4">𝑠</ci></apply><ci id="S3.SS2.p1.10.m8.6.6.cmml" xref="S3.SS2.p1.10.m8.6.6">…</ci><apply id="S3.SS2.p1.10.m8.9.9.3.3.3.3.cmml" xref="S3.SS2.p1.10.m8.9.9.3.3.3.3"><times id="S3.SS2.p1.10.m8.9.9.3.3.3.3.1.cmml" xref="S3.SS2.p1.10.m8.9.9.3.3.3.3.1"></times><apply id="S3.SS2.p1.10.m8.9.9.3.3.3.3.2.cmml" xref="S3.SS2.p1.10.m8.9.9.3.3.3.3.2"><csymbol cd="ambiguous" id="S3.SS2.p1.10.m8.9.9.3.3.3.3.2.1.cmml" xref="S3.SS2.p1.10.m8.9.9.3.3.3.3.2">superscript</csymbol><apply id="S3.SS2.p1.10.m8.9.9.3.3.3.3.2.2.cmml" xref="S3.SS2.p1.10.m8.9.9.3.3.3.3.2"><csymbol cd="ambiguous" id="S3.SS2.p1.10.m8.9.9.3.3.3.3.2.2.1.cmml" xref="S3.SS2.p1.10.m8.9.9.3.3.3.3.2">subscript</csymbol><ci id="S3.SS2.p1.10.m8.9.9.3.3.3.3.2.2.2.cmml" xref="S3.SS2.p1.10.m8.9.9.3.3.3.3.2.2.2">𝜎</ci><ci id="S3.SS2.p1.10.m8.9.9.3.3.3.3.2.2.3.cmml" xref="S3.SS2.p1.10.m8.9.9.3.3.3.3.2.2.3">𝑖</ci></apply><apply id="S3.SS2.p1.10.m8.1.1.1.2.cmml" xref="S3.SS2.p1.10.m8.1.1.1.3"><abs id="S3.SS2.p1.10.m8.1.1.1.2.1.cmml" xref="S3.SS2.p1.10.m8.1.1.1.3.1"></abs><ci id="S3.SS2.p1.10.m8.1.1.1.1.cmml" xref="S3.SS2.p1.10.m8.1.1.1.1">𝒜</ci></apply></apply><ci id="S3.SS2.p1.10.m8.5.5.cmml" xref="S3.SS2.p1.10.m8.5.5">𝑠</ci></apply></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.10.m8.9c">\Sigma_{i}(s)=\mathrm{diag}\left(\sigma_{i}^{1}(s),\sigma_{i}^{2}(s),\ldots,%
\sigma_{i}^{|\mathcal{A}|}(s)\right)</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.10.m8.9d">roman_Σ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ( italic_s ) = roman_diag ( italic_σ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT ( italic_s ) , italic_σ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ( italic_s ) , … , italic_σ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT | caligraphic_A | end_POSTSUPERSCRIPT ( italic_s ) )</annotation></semantics></math>, with the variance <math alttext="\sigma_{i}^{j}(s)" class="ltx_Math" display="inline" id="S3.SS2.p1.11.m9.1"><semantics id="S3.SS2.p1.11.m9.1a"><mrow id="S3.SS2.p1.11.m9.1.2" xref="S3.SS2.p1.11.m9.1.2.cmml"><msubsup id="S3.SS2.p1.11.m9.1.2.2" xref="S3.SS2.p1.11.m9.1.2.2.cmml"><mi id="S3.SS2.p1.11.m9.1.2.2.2.2" xref="S3.SS2.p1.11.m9.1.2.2.2.2.cmml">σ</mi><mi id="S3.SS2.p1.11.m9.1.2.2.2.3" xref="S3.SS2.p1.11.m9.1.2.2.2.3.cmml">i</mi><mi id="S3.SS2.p1.11.m9.1.2.2.3" xref="S3.SS2.p1.11.m9.1.2.2.3.cmml">j</mi></msubsup><mo id="S3.SS2.p1.11.m9.1.2.1" xref="S3.SS2.p1.11.m9.1.2.1.cmml">⁢</mo><mrow id="S3.SS2.p1.11.m9.1.2.3.2" xref="S3.SS2.p1.11.m9.1.2.cmml"><mo id="S3.SS2.p1.11.m9.1.2.3.2.1" stretchy="false" xref="S3.SS2.p1.11.m9.1.2.cmml">(</mo><mi id="S3.SS2.p1.11.m9.1.1" xref="S3.SS2.p1.11.m9.1.1.cmml">s</mi><mo id="S3.SS2.p1.11.m9.1.2.3.2.2" stretchy="false" xref="S3.SS2.p1.11.m9.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.11.m9.1b"><apply id="S3.SS2.p1.11.m9.1.2.cmml" xref="S3.SS2.p1.11.m9.1.2"><times id="S3.SS2.p1.11.m9.1.2.1.cmml" xref="S3.SS2.p1.11.m9.1.2.1"></times><apply id="S3.SS2.p1.11.m9.1.2.2.cmml" xref="S3.SS2.p1.11.m9.1.2.2"><csymbol cd="ambiguous" id="S3.SS2.p1.11.m9.1.2.2.1.cmml" xref="S3.SS2.p1.11.m9.1.2.2">superscript</csymbol><apply id="S3.SS2.p1.11.m9.1.2.2.2.cmml" xref="S3.SS2.p1.11.m9.1.2.2"><csymbol cd="ambiguous" id="S3.SS2.p1.11.m9.1.2.2.2.1.cmml" xref="S3.SS2.p1.11.m9.1.2.2">subscript</csymbol><ci id="S3.SS2.p1.11.m9.1.2.2.2.2.cmml" xref="S3.SS2.p1.11.m9.1.2.2.2.2">𝜎</ci><ci id="S3.SS2.p1.11.m9.1.2.2.2.3.cmml" xref="S3.SS2.p1.11.m9.1.2.2.2.3">𝑖</ci></apply><ci id="S3.SS2.p1.11.m9.1.2.2.3.cmml" xref="S3.SS2.p1.11.m9.1.2.2.3">𝑗</ci></apply><ci id="S3.SS2.p1.11.m9.1.1.cmml" xref="S3.SS2.p1.11.m9.1.1">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.11.m9.1c">\sigma_{i}^{j}(s)</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.11.m9.1d">italic_σ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT ( italic_s )</annotation></semantics></math> of the <math alttext="j" class="ltx_Math" display="inline" id="S3.SS2.p1.12.m10.1"><semantics id="S3.SS2.p1.12.m10.1a"><mi id="S3.SS2.p1.12.m10.1.1" xref="S3.SS2.p1.12.m10.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.12.m10.1b"><ci id="S3.SS2.p1.12.m10.1.1.cmml" xref="S3.SS2.p1.12.m10.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.12.m10.1c">j</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.12.m10.1d">italic_j</annotation></semantics></math>-th action dimension from the <math alttext="i" class="ltx_Math" display="inline" id="S3.SS2.p1.13.m11.1"><semantics id="S3.SS2.p1.13.m11.1a"><mi id="S3.SS2.p1.13.m11.1.1" xref="S3.SS2.p1.13.m11.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.13.m11.1b"><ci id="S3.SS2.p1.13.m11.1.1.cmml" xref="S3.SS2.p1.13.m11.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.13.m11.1c">i</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.13.m11.1d">italic_i</annotation></semantics></math>-th primitive, and the dimensionality of the action space <math alttext="|\mathcal{A}|" class="ltx_Math" display="inline" id="S3.SS2.p1.14.m12.1"><semantics id="S3.SS2.p1.14.m12.1a"><mrow id="S3.SS2.p1.14.m12.1.2.2" xref="S3.SS2.p1.14.m12.1.2.1.cmml"><mo id="S3.SS2.p1.14.m12.1.2.2.1" stretchy="false" xref="S3.SS2.p1.14.m12.1.2.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.14.m12.1.1" xref="S3.SS2.p1.14.m12.1.1.cmml">𝒜</mi><mo id="S3.SS2.p1.14.m12.1.2.2.2" stretchy="false" xref="S3.SS2.p1.14.m12.1.2.1.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.14.m12.1b"><apply id="S3.SS2.p1.14.m12.1.2.1.cmml" xref="S3.SS2.p1.14.m12.1.2.2"><abs id="S3.SS2.p1.14.m12.1.2.1.1.cmml" xref="S3.SS2.p1.14.m12.1.2.2.1"></abs><ci id="S3.SS2.p1.14.m12.1.1.cmml" xref="S3.SS2.p1.14.m12.1.1">𝒜</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.14.m12.1c">|\mathcal{A}|</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.14.m12.1d">| caligraphic_A |</annotation></semantics></math>.
Each primitive <math alttext="\pi_{i}(a|s)" class="ltx_Math" display="inline" id="S3.SS2.p1.15.m13.1"><semantics id="S3.SS2.p1.15.m13.1a"><mrow id="S3.SS2.p1.15.m13.1.1" xref="S3.SS2.p1.15.m13.1.1.cmml"><msub id="S3.SS2.p1.15.m13.1.1.3" xref="S3.SS2.p1.15.m13.1.1.3.cmml"><mi id="S3.SS2.p1.15.m13.1.1.3.2" xref="S3.SS2.p1.15.m13.1.1.3.2.cmml">π</mi><mi id="S3.SS2.p1.15.m13.1.1.3.3" xref="S3.SS2.p1.15.m13.1.1.3.3.cmml">i</mi></msub><mo id="S3.SS2.p1.15.m13.1.1.2" xref="S3.SS2.p1.15.m13.1.1.2.cmml">⁢</mo><mrow id="S3.SS2.p1.15.m13.1.1.1.1" xref="S3.SS2.p1.15.m13.1.1.1.1.1.cmml"><mo id="S3.SS2.p1.15.m13.1.1.1.1.2" stretchy="false" xref="S3.SS2.p1.15.m13.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.p1.15.m13.1.1.1.1.1" xref="S3.SS2.p1.15.m13.1.1.1.1.1.cmml"><mi id="S3.SS2.p1.15.m13.1.1.1.1.1.2" xref="S3.SS2.p1.15.m13.1.1.1.1.1.2.cmml">a</mi><mo fence="false" id="S3.SS2.p1.15.m13.1.1.1.1.1.1" xref="S3.SS2.p1.15.m13.1.1.1.1.1.1.cmml">|</mo><mi id="S3.SS2.p1.15.m13.1.1.1.1.1.3" xref="S3.SS2.p1.15.m13.1.1.1.1.1.3.cmml">s</mi></mrow><mo id="S3.SS2.p1.15.m13.1.1.1.1.3" stretchy="false" xref="S3.SS2.p1.15.m13.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.15.m13.1b"><apply id="S3.SS2.p1.15.m13.1.1.cmml" xref="S3.SS2.p1.15.m13.1.1"><times id="S3.SS2.p1.15.m13.1.1.2.cmml" xref="S3.SS2.p1.15.m13.1.1.2"></times><apply id="S3.SS2.p1.15.m13.1.1.3.cmml" xref="S3.SS2.p1.15.m13.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p1.15.m13.1.1.3.1.cmml" xref="S3.SS2.p1.15.m13.1.1.3">subscript</csymbol><ci id="S3.SS2.p1.15.m13.1.1.3.2.cmml" xref="S3.SS2.p1.15.m13.1.1.3.2">𝜋</ci><ci id="S3.SS2.p1.15.m13.1.1.3.3.cmml" xref="S3.SS2.p1.15.m13.1.1.3.3">𝑖</ci></apply><apply id="S3.SS2.p1.15.m13.1.1.1.1.1.cmml" xref="S3.SS2.p1.15.m13.1.1.1.1"><csymbol cd="latexml" id="S3.SS2.p1.15.m13.1.1.1.1.1.1.cmml" xref="S3.SS2.p1.15.m13.1.1.1.1.1.1">conditional</csymbol><ci id="S3.SS2.p1.15.m13.1.1.1.1.1.2.cmml" xref="S3.SS2.p1.15.m13.1.1.1.1.1.2">𝑎</ci><ci id="S3.SS2.p1.15.m13.1.1.1.1.1.3.cmml" xref="S3.SS2.p1.15.m13.1.1.1.1.1.3">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.15.m13.1c">\pi_{i}(a|s)</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.15.m13.1d">italic_π start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ( italic_a | italic_s )</annotation></semantics></math> is independent of the goal <math alttext="g" class="ltx_Math" display="inline" id="S3.SS2.p1.16.m14.1"><semantics id="S3.SS2.p1.16.m14.1a"><mi id="S3.SS2.p1.16.m14.1.1" xref="S3.SS2.p1.16.m14.1.1.cmml">g</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.16.m14.1b"><ci id="S3.SS2.p1.16.m14.1.1.cmml" xref="S3.SS2.p1.16.m14.1.1">𝑔</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.16.m14.1c">g</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.16.m14.1d">italic_g</annotation></semantics></math>, which makes it reusable for any type of downstream task.
A multiplicative composition of Gaussian distributions yields yet another Gaussian distribution <math alttext="\pi(a|s,g)=\mathcal{N}(\mu(s,g),\Sigma(s,g))" class="ltx_Math" display="inline" id="S3.SS2.p1.17.m15.9"><semantics id="S3.SS2.p1.17.m15.9a"><mrow id="S3.SS2.p1.17.m15.9.9" xref="S3.SS2.p1.17.m15.9.9.cmml"><mrow id="S3.SS2.p1.17.m15.7.7.1" xref="S3.SS2.p1.17.m15.7.7.1.cmml"><mi id="S3.SS2.p1.17.m15.7.7.1.3" xref="S3.SS2.p1.17.m15.7.7.1.3.cmml">π</mi><mo id="S3.SS2.p1.17.m15.7.7.1.2" xref="S3.SS2.p1.17.m15.7.7.1.2.cmml">⁢</mo><mrow id="S3.SS2.p1.17.m15.7.7.1.1.1" xref="S3.SS2.p1.17.m15.7.7.1.1.1.1.cmml"><mo id="S3.SS2.p1.17.m15.7.7.1.1.1.2" stretchy="false" xref="S3.SS2.p1.17.m15.7.7.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.p1.17.m15.7.7.1.1.1.1" xref="S3.SS2.p1.17.m15.7.7.1.1.1.1.cmml"><mi id="S3.SS2.p1.17.m15.7.7.1.1.1.1.2" xref="S3.SS2.p1.17.m15.7.7.1.1.1.1.2.cmml">a</mi><mo fence="false" id="S3.SS2.p1.17.m15.7.7.1.1.1.1.1" xref="S3.SS2.p1.17.m15.7.7.1.1.1.1.1.cmml">|</mo><mrow id="S3.SS2.p1.17.m15.7.7.1.1.1.1.3.2" xref="S3.SS2.p1.17.m15.7.7.1.1.1.1.3.1.cmml"><mi id="S3.SS2.p1.17.m15.1.1" xref="S3.SS2.p1.17.m15.1.1.cmml">s</mi><mo id="S3.SS2.p1.17.m15.7.7.1.1.1.1.3.2.1" xref="S3.SS2.p1.17.m15.7.7.1.1.1.1.3.1.cmml">,</mo><mi id="S3.SS2.p1.17.m15.2.2" xref="S3.SS2.p1.17.m15.2.2.cmml">g</mi></mrow></mrow><mo id="S3.SS2.p1.17.m15.7.7.1.1.1.3" stretchy="false" xref="S3.SS2.p1.17.m15.7.7.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS2.p1.17.m15.9.9.4" xref="S3.SS2.p1.17.m15.9.9.4.cmml">=</mo><mrow id="S3.SS2.p1.17.m15.9.9.3" xref="S3.SS2.p1.17.m15.9.9.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.17.m15.9.9.3.4" xref="S3.SS2.p1.17.m15.9.9.3.4.cmml">𝒩</mi><mo id="S3.SS2.p1.17.m15.9.9.3.3" xref="S3.SS2.p1.17.m15.9.9.3.3.cmml">⁢</mo><mrow id="S3.SS2.p1.17.m15.9.9.3.2.2" xref="S3.SS2.p1.17.m15.9.9.3.2.3.cmml"><mo id="S3.SS2.p1.17.m15.9.9.3.2.2.3" stretchy="false" xref="S3.SS2.p1.17.m15.9.9.3.2.3.cmml">(</mo><mrow id="S3.SS2.p1.17.m15.8.8.2.1.1.1" xref="S3.SS2.p1.17.m15.8.8.2.1.1.1.cmml"><mi id="S3.SS2.p1.17.m15.8.8.2.1.1.1.2" xref="S3.SS2.p1.17.m15.8.8.2.1.1.1.2.cmml">μ</mi><mo id="S3.SS2.p1.17.m15.8.8.2.1.1.1.1" xref="S3.SS2.p1.17.m15.8.8.2.1.1.1.1.cmml">⁢</mo><mrow id="S3.SS2.p1.17.m15.8.8.2.1.1.1.3.2" xref="S3.SS2.p1.17.m15.8.8.2.1.1.1.3.1.cmml"><mo id="S3.SS2.p1.17.m15.8.8.2.1.1.1.3.2.1" stretchy="false" xref="S3.SS2.p1.17.m15.8.8.2.1.1.1.3.1.cmml">(</mo><mi id="S3.SS2.p1.17.m15.3.3" xref="S3.SS2.p1.17.m15.3.3.cmml">s</mi><mo id="S3.SS2.p1.17.m15.8.8.2.1.1.1.3.2.2" xref="S3.SS2.p1.17.m15.8.8.2.1.1.1.3.1.cmml">,</mo><mi id="S3.SS2.p1.17.m15.4.4" xref="S3.SS2.p1.17.m15.4.4.cmml">g</mi><mo id="S3.SS2.p1.17.m15.8.8.2.1.1.1.3.2.3" stretchy="false" xref="S3.SS2.p1.17.m15.8.8.2.1.1.1.3.1.cmml">)</mo></mrow></mrow><mo id="S3.SS2.p1.17.m15.9.9.3.2.2.4" xref="S3.SS2.p1.17.m15.9.9.3.2.3.cmml">,</mo><mrow id="S3.SS2.p1.17.m15.9.9.3.2.2.2" xref="S3.SS2.p1.17.m15.9.9.3.2.2.2.cmml"><mi id="S3.SS2.p1.17.m15.9.9.3.2.2.2.2" mathvariant="normal" xref="S3.SS2.p1.17.m15.9.9.3.2.2.2.2.cmml">Σ</mi><mo id="S3.SS2.p1.17.m15.9.9.3.2.2.2.1" xref="S3.SS2.p1.17.m15.9.9.3.2.2.2.1.cmml">⁢</mo><mrow id="S3.SS2.p1.17.m15.9.9.3.2.2.2.3.2" xref="S3.SS2.p1.17.m15.9.9.3.2.2.2.3.1.cmml"><mo id="S3.SS2.p1.17.m15.9.9.3.2.2.2.3.2.1" stretchy="false" xref="S3.SS2.p1.17.m15.9.9.3.2.2.2.3.1.cmml">(</mo><mi id="S3.SS2.p1.17.m15.5.5" xref="S3.SS2.p1.17.m15.5.5.cmml">s</mi><mo id="S3.SS2.p1.17.m15.9.9.3.2.2.2.3.2.2" xref="S3.SS2.p1.17.m15.9.9.3.2.2.2.3.1.cmml">,</mo><mi id="S3.SS2.p1.17.m15.6.6" xref="S3.SS2.p1.17.m15.6.6.cmml">g</mi><mo id="S3.SS2.p1.17.m15.9.9.3.2.2.2.3.2.3" stretchy="false" xref="S3.SS2.p1.17.m15.9.9.3.2.2.2.3.1.cmml">)</mo></mrow></mrow><mo id="S3.SS2.p1.17.m15.9.9.3.2.2.5" stretchy="false" xref="S3.SS2.p1.17.m15.9.9.3.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.17.m15.9b"><apply id="S3.SS2.p1.17.m15.9.9.cmml" xref="S3.SS2.p1.17.m15.9.9"><eq id="S3.SS2.p1.17.m15.9.9.4.cmml" xref="S3.SS2.p1.17.m15.9.9.4"></eq><apply id="S3.SS2.p1.17.m15.7.7.1.cmml" xref="S3.SS2.p1.17.m15.7.7.1"><times id="S3.SS2.p1.17.m15.7.7.1.2.cmml" xref="S3.SS2.p1.17.m15.7.7.1.2"></times><ci id="S3.SS2.p1.17.m15.7.7.1.3.cmml" xref="S3.SS2.p1.17.m15.7.7.1.3">𝜋</ci><apply id="S3.SS2.p1.17.m15.7.7.1.1.1.1.cmml" xref="S3.SS2.p1.17.m15.7.7.1.1.1"><csymbol cd="latexml" id="S3.SS2.p1.17.m15.7.7.1.1.1.1.1.cmml" xref="S3.SS2.p1.17.m15.7.7.1.1.1.1.1">conditional</csymbol><ci id="S3.SS2.p1.17.m15.7.7.1.1.1.1.2.cmml" xref="S3.SS2.p1.17.m15.7.7.1.1.1.1.2">𝑎</ci><list id="S3.SS2.p1.17.m15.7.7.1.1.1.1.3.1.cmml" xref="S3.SS2.p1.17.m15.7.7.1.1.1.1.3.2"><ci id="S3.SS2.p1.17.m15.1.1.cmml" xref="S3.SS2.p1.17.m15.1.1">𝑠</ci><ci id="S3.SS2.p1.17.m15.2.2.cmml" xref="S3.SS2.p1.17.m15.2.2">𝑔</ci></list></apply></apply><apply id="S3.SS2.p1.17.m15.9.9.3.cmml" xref="S3.SS2.p1.17.m15.9.9.3"><times id="S3.SS2.p1.17.m15.9.9.3.3.cmml" xref="S3.SS2.p1.17.m15.9.9.3.3"></times><ci id="S3.SS2.p1.17.m15.9.9.3.4.cmml" xref="S3.SS2.p1.17.m15.9.9.3.4">𝒩</ci><interval closure="open" id="S3.SS2.p1.17.m15.9.9.3.2.3.cmml" xref="S3.SS2.p1.17.m15.9.9.3.2.2"><apply id="S3.SS2.p1.17.m15.8.8.2.1.1.1.cmml" xref="S3.SS2.p1.17.m15.8.8.2.1.1.1"><times id="S3.SS2.p1.17.m15.8.8.2.1.1.1.1.cmml" xref="S3.SS2.p1.17.m15.8.8.2.1.1.1.1"></times><ci id="S3.SS2.p1.17.m15.8.8.2.1.1.1.2.cmml" xref="S3.SS2.p1.17.m15.8.8.2.1.1.1.2">𝜇</ci><interval closure="open" id="S3.SS2.p1.17.m15.8.8.2.1.1.1.3.1.cmml" xref="S3.SS2.p1.17.m15.8.8.2.1.1.1.3.2"><ci id="S3.SS2.p1.17.m15.3.3.cmml" xref="S3.SS2.p1.17.m15.3.3">𝑠</ci><ci id="S3.SS2.p1.17.m15.4.4.cmml" xref="S3.SS2.p1.17.m15.4.4">𝑔</ci></interval></apply><apply id="S3.SS2.p1.17.m15.9.9.3.2.2.2.cmml" xref="S3.SS2.p1.17.m15.9.9.3.2.2.2"><times id="S3.SS2.p1.17.m15.9.9.3.2.2.2.1.cmml" xref="S3.SS2.p1.17.m15.9.9.3.2.2.2.1"></times><ci id="S3.SS2.p1.17.m15.9.9.3.2.2.2.2.cmml" xref="S3.SS2.p1.17.m15.9.9.3.2.2.2.2">Σ</ci><interval closure="open" id="S3.SS2.p1.17.m15.9.9.3.2.2.2.3.1.cmml" xref="S3.SS2.p1.17.m15.9.9.3.2.2.2.3.2"><ci id="S3.SS2.p1.17.m15.5.5.cmml" xref="S3.SS2.p1.17.m15.5.5">𝑠</ci><ci id="S3.SS2.p1.17.m15.6.6.cmml" xref="S3.SS2.p1.17.m15.6.6">𝑔</ci></interval></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.17.m15.9c">\pi(a|s,g)=\mathcal{N}(\mu(s,g),\Sigma(s,g))</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.17.m15.9d">italic_π ( italic_a | italic_s , italic_g ) = caligraphic_N ( italic_μ ( italic_s , italic_g ) , roman_Σ ( italic_s , italic_g ) )</annotation></semantics></math>.
Since the primitives model each dimension independently, the mean and variance of the composite policy <math alttext="\pi" class="ltx_Math" display="inline" id="S3.SS2.p1.18.m16.1"><semantics id="S3.SS2.p1.18.m16.1a"><mi id="S3.SS2.p1.18.m16.1.1" xref="S3.SS2.p1.18.m16.1.1.cmml">π</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.18.m16.1b"><ci id="S3.SS2.p1.18.m16.1.1.cmml" xref="S3.SS2.p1.18.m16.1.1">𝜋</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.18.m16.1c">\pi</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.18.m16.1d">italic_π</annotation></semantics></math> also have independent dimensions with component-wise mean <math alttext="\mu^{j}(s,g)" class="ltx_Math" display="inline" id="S3.SS2.p1.19.m17.2"><semantics id="S3.SS2.p1.19.m17.2a"><mrow id="S3.SS2.p1.19.m17.2.3" xref="S3.SS2.p1.19.m17.2.3.cmml"><msup id="S3.SS2.p1.19.m17.2.3.2" xref="S3.SS2.p1.19.m17.2.3.2.cmml"><mi id="S3.SS2.p1.19.m17.2.3.2.2" xref="S3.SS2.p1.19.m17.2.3.2.2.cmml">μ</mi><mi id="S3.SS2.p1.19.m17.2.3.2.3" xref="S3.SS2.p1.19.m17.2.3.2.3.cmml">j</mi></msup><mo id="S3.SS2.p1.19.m17.2.3.1" xref="S3.SS2.p1.19.m17.2.3.1.cmml">⁢</mo><mrow id="S3.SS2.p1.19.m17.2.3.3.2" xref="S3.SS2.p1.19.m17.2.3.3.1.cmml"><mo id="S3.SS2.p1.19.m17.2.3.3.2.1" stretchy="false" xref="S3.SS2.p1.19.m17.2.3.3.1.cmml">(</mo><mi id="S3.SS2.p1.19.m17.1.1" xref="S3.SS2.p1.19.m17.1.1.cmml">s</mi><mo id="S3.SS2.p1.19.m17.2.3.3.2.2" xref="S3.SS2.p1.19.m17.2.3.3.1.cmml">,</mo><mi id="S3.SS2.p1.19.m17.2.2" xref="S3.SS2.p1.19.m17.2.2.cmml">g</mi><mo id="S3.SS2.p1.19.m17.2.3.3.2.3" stretchy="false" xref="S3.SS2.p1.19.m17.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.19.m17.2b"><apply id="S3.SS2.p1.19.m17.2.3.cmml" xref="S3.SS2.p1.19.m17.2.3"><times id="S3.SS2.p1.19.m17.2.3.1.cmml" xref="S3.SS2.p1.19.m17.2.3.1"></times><apply id="S3.SS2.p1.19.m17.2.3.2.cmml" xref="S3.SS2.p1.19.m17.2.3.2"><csymbol cd="ambiguous" id="S3.SS2.p1.19.m17.2.3.2.1.cmml" xref="S3.SS2.p1.19.m17.2.3.2">superscript</csymbol><ci id="S3.SS2.p1.19.m17.2.3.2.2.cmml" xref="S3.SS2.p1.19.m17.2.3.2.2">𝜇</ci><ci id="S3.SS2.p1.19.m17.2.3.2.3.cmml" xref="S3.SS2.p1.19.m17.2.3.2.3">𝑗</ci></apply><interval closure="open" id="S3.SS2.p1.19.m17.2.3.3.1.cmml" xref="S3.SS2.p1.19.m17.2.3.3.2"><ci id="S3.SS2.p1.19.m17.1.1.cmml" xref="S3.SS2.p1.19.m17.1.1">𝑠</ci><ci id="S3.SS2.p1.19.m17.2.2.cmml" xref="S3.SS2.p1.19.m17.2.2">𝑔</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.19.m17.2c">\mu^{j}(s,g)</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.19.m17.2d">italic_μ start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT ( italic_s , italic_g )</annotation></semantics></math> and variance <math alttext="\sigma^{j}(s,g)" class="ltx_Math" display="inline" id="S3.SS2.p1.20.m18.2"><semantics id="S3.SS2.p1.20.m18.2a"><mrow id="S3.SS2.p1.20.m18.2.3" xref="S3.SS2.p1.20.m18.2.3.cmml"><msup id="S3.SS2.p1.20.m18.2.3.2" xref="S3.SS2.p1.20.m18.2.3.2.cmml"><mi id="S3.SS2.p1.20.m18.2.3.2.2" xref="S3.SS2.p1.20.m18.2.3.2.2.cmml">σ</mi><mi id="S3.SS2.p1.20.m18.2.3.2.3" xref="S3.SS2.p1.20.m18.2.3.2.3.cmml">j</mi></msup><mo id="S3.SS2.p1.20.m18.2.3.1" xref="S3.SS2.p1.20.m18.2.3.1.cmml">⁢</mo><mrow id="S3.SS2.p1.20.m18.2.3.3.2" xref="S3.SS2.p1.20.m18.2.3.3.1.cmml"><mo id="S3.SS2.p1.20.m18.2.3.3.2.1" stretchy="false" xref="S3.SS2.p1.20.m18.2.3.3.1.cmml">(</mo><mi id="S3.SS2.p1.20.m18.1.1" xref="S3.SS2.p1.20.m18.1.1.cmml">s</mi><mo id="S3.SS2.p1.20.m18.2.3.3.2.2" xref="S3.SS2.p1.20.m18.2.3.3.1.cmml">,</mo><mi id="S3.SS2.p1.20.m18.2.2" xref="S3.SS2.p1.20.m18.2.2.cmml">g</mi><mo id="S3.SS2.p1.20.m18.2.3.3.2.3" stretchy="false" xref="S3.SS2.p1.20.m18.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.20.m18.2b"><apply id="S3.SS2.p1.20.m18.2.3.cmml" xref="S3.SS2.p1.20.m18.2.3"><times id="S3.SS2.p1.20.m18.2.3.1.cmml" xref="S3.SS2.p1.20.m18.2.3.1"></times><apply id="S3.SS2.p1.20.m18.2.3.2.cmml" xref="S3.SS2.p1.20.m18.2.3.2"><csymbol cd="ambiguous" id="S3.SS2.p1.20.m18.2.3.2.1.cmml" xref="S3.SS2.p1.20.m18.2.3.2">superscript</csymbol><ci id="S3.SS2.p1.20.m18.2.3.2.2.cmml" xref="S3.SS2.p1.20.m18.2.3.2.2">𝜎</ci><ci id="S3.SS2.p1.20.m18.2.3.2.3.cmml" xref="S3.SS2.p1.20.m18.2.3.2.3">𝑗</ci></apply><interval closure="open" id="S3.SS2.p1.20.m18.2.3.3.1.cmml" xref="S3.SS2.p1.20.m18.2.3.3.2"><ci id="S3.SS2.p1.20.m18.1.1.cmml" xref="S3.SS2.p1.20.m18.1.1">𝑠</ci><ci id="S3.SS2.p1.20.m18.2.2.cmml" xref="S3.SS2.p1.20.m18.2.2">𝑔</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.20.m18.2c">\sigma^{j}(s,g)</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.20.m18.2d">italic_σ start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT ( italic_s , italic_g )</annotation></semantics></math> where</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mu^{j}(s,g)=\frac{1}{\sum_{l=1}^{k}\frac{w_{l}(s,g)}{\sigma_{l}^{j}(s)}}\sum_%
{i=1}^{k}\frac{w_{i}(s,g)}{\sigma_{i}^{j}(s)}\mu_{i}^{j}(s)," class="ltx_Math" display="block" id="S3.E2.m1.10"><semantics id="S3.E2.m1.10a"><mrow id="S3.E2.m1.10.10.1" xref="S3.E2.m1.10.10.1.1.cmml"><mrow id="S3.E2.m1.10.10.1.1" xref="S3.E2.m1.10.10.1.1.cmml"><mrow id="S3.E2.m1.10.10.1.1.2" xref="S3.E2.m1.10.10.1.1.2.cmml"><msup id="S3.E2.m1.10.10.1.1.2.2" xref="S3.E2.m1.10.10.1.1.2.2.cmml"><mi id="S3.E2.m1.10.10.1.1.2.2.2" xref="S3.E2.m1.10.10.1.1.2.2.2.cmml">μ</mi><mi id="S3.E2.m1.10.10.1.1.2.2.3" xref="S3.E2.m1.10.10.1.1.2.2.3.cmml">j</mi></msup><mo id="S3.E2.m1.10.10.1.1.2.1" xref="S3.E2.m1.10.10.1.1.2.1.cmml">⁢</mo><mrow id="S3.E2.m1.10.10.1.1.2.3.2" xref="S3.E2.m1.10.10.1.1.2.3.1.cmml"><mo id="S3.E2.m1.10.10.1.1.2.3.2.1" stretchy="false" xref="S3.E2.m1.10.10.1.1.2.3.1.cmml">(</mo><mi id="S3.E2.m1.7.7" xref="S3.E2.m1.7.7.cmml">s</mi><mo id="S3.E2.m1.10.10.1.1.2.3.2.2" xref="S3.E2.m1.10.10.1.1.2.3.1.cmml">,</mo><mi id="S3.E2.m1.8.8" xref="S3.E2.m1.8.8.cmml">g</mi><mo id="S3.E2.m1.10.10.1.1.2.3.2.3" stretchy="false" xref="S3.E2.m1.10.10.1.1.2.3.1.cmml">)</mo></mrow></mrow><mo id="S3.E2.m1.10.10.1.1.1" xref="S3.E2.m1.10.10.1.1.1.cmml">=</mo><mrow id="S3.E2.m1.10.10.1.1.3" xref="S3.E2.m1.10.10.1.1.3.cmml"><mfrac id="S3.E2.m1.3.3" xref="S3.E2.m1.3.3.cmml"><mn id="S3.E2.m1.3.3.5" xref="S3.E2.m1.3.3.5.cmml">1</mn><mrow id="S3.E2.m1.3.3.3" xref="S3.E2.m1.3.3.3.cmml"><msubsup id="S3.E2.m1.3.3.3.4" xref="S3.E2.m1.3.3.3.4.cmml"><mo id="S3.E2.m1.3.3.3.4.2.2" xref="S3.E2.m1.3.3.3.4.2.2.cmml">∑</mo><mrow id="S3.E2.m1.3.3.3.4.2.3" xref="S3.E2.m1.3.3.3.4.2.3.cmml"><mi id="S3.E2.m1.3.3.3.4.2.3.2" xref="S3.E2.m1.3.3.3.4.2.3.2.cmml">l</mi><mo id="S3.E2.m1.3.3.3.4.2.3.1" xref="S3.E2.m1.3.3.3.4.2.3.1.cmml">=</mo><mn id="S3.E2.m1.3.3.3.4.2.3.3" xref="S3.E2.m1.3.3.3.4.2.3.3.cmml">1</mn></mrow><mi id="S3.E2.m1.3.3.3.4.3" xref="S3.E2.m1.3.3.3.4.3.cmml">k</mi></msubsup><mfrac id="S3.E2.m1.3.3.3.3" xref="S3.E2.m1.3.3.3.3.cmml"><mrow id="S3.E2.m1.2.2.2.2.2" xref="S3.E2.m1.2.2.2.2.2.cmml"><msub id="S3.E2.m1.2.2.2.2.2.4" xref="S3.E2.m1.2.2.2.2.2.4.cmml"><mi id="S3.E2.m1.2.2.2.2.2.4.2" xref="S3.E2.m1.2.2.2.2.2.4.2.cmml">w</mi><mi id="S3.E2.m1.2.2.2.2.2.4.3" xref="S3.E2.m1.2.2.2.2.2.4.3.cmml">l</mi></msub><mo id="S3.E2.m1.2.2.2.2.2.3" xref="S3.E2.m1.2.2.2.2.2.3.cmml">⁢</mo><mrow id="S3.E2.m1.2.2.2.2.2.5.2" xref="S3.E2.m1.2.2.2.2.2.5.1.cmml"><mo id="S3.E2.m1.2.2.2.2.2.5.2.1" stretchy="false" xref="S3.E2.m1.2.2.2.2.2.5.1.cmml">(</mo><mi id="S3.E2.m1.1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.1.cmml">s</mi><mo id="S3.E2.m1.2.2.2.2.2.5.2.2" xref="S3.E2.m1.2.2.2.2.2.5.1.cmml">,</mo><mi id="S3.E2.m1.2.2.2.2.2.2" xref="S3.E2.m1.2.2.2.2.2.2.cmml">g</mi><mo id="S3.E2.m1.2.2.2.2.2.5.2.3" stretchy="false" xref="S3.E2.m1.2.2.2.2.2.5.1.cmml">)</mo></mrow></mrow><mrow id="S3.E2.m1.3.3.3.3.3" xref="S3.E2.m1.3.3.3.3.3.cmml"><msubsup id="S3.E2.m1.3.3.3.3.3.3" xref="S3.E2.m1.3.3.3.3.3.3.cmml"><mi id="S3.E2.m1.3.3.3.3.3.3.2.2" xref="S3.E2.m1.3.3.3.3.3.3.2.2.cmml">σ</mi><mi id="S3.E2.m1.3.3.3.3.3.3.2.3" xref="S3.E2.m1.3.3.3.3.3.3.2.3.cmml">l</mi><mi id="S3.E2.m1.3.3.3.3.3.3.3" xref="S3.E2.m1.3.3.3.3.3.3.3.cmml">j</mi></msubsup><mo id="S3.E2.m1.3.3.3.3.3.2" xref="S3.E2.m1.3.3.3.3.3.2.cmml">⁢</mo><mrow id="S3.E2.m1.3.3.3.3.3.4.2" xref="S3.E2.m1.3.3.3.3.3.cmml"><mo id="S3.E2.m1.3.3.3.3.3.4.2.1" stretchy="false" xref="S3.E2.m1.3.3.3.3.3.cmml">(</mo><mi id="S3.E2.m1.3.3.3.3.3.1" xref="S3.E2.m1.3.3.3.3.3.1.cmml">s</mi><mo id="S3.E2.m1.3.3.3.3.3.4.2.2" stretchy="false" xref="S3.E2.m1.3.3.3.3.3.cmml">)</mo></mrow></mrow></mfrac></mrow></mfrac><mo id="S3.E2.m1.10.10.1.1.3.1" xref="S3.E2.m1.10.10.1.1.3.1.cmml">⁢</mo><mrow id="S3.E2.m1.10.10.1.1.3.2" xref="S3.E2.m1.10.10.1.1.3.2.cmml"><munderover id="S3.E2.m1.10.10.1.1.3.2.1" xref="S3.E2.m1.10.10.1.1.3.2.1.cmml"><mo id="S3.E2.m1.10.10.1.1.3.2.1.2.2" movablelimits="false" xref="S3.E2.m1.10.10.1.1.3.2.1.2.2.cmml">∑</mo><mrow id="S3.E2.m1.10.10.1.1.3.2.1.2.3" xref="S3.E2.m1.10.10.1.1.3.2.1.2.3.cmml"><mi id="S3.E2.m1.10.10.1.1.3.2.1.2.3.2" xref="S3.E2.m1.10.10.1.1.3.2.1.2.3.2.cmml">i</mi><mo id="S3.E2.m1.10.10.1.1.3.2.1.2.3.1" xref="S3.E2.m1.10.10.1.1.3.2.1.2.3.1.cmml">=</mo><mn id="S3.E2.m1.10.10.1.1.3.2.1.2.3.3" xref="S3.E2.m1.10.10.1.1.3.2.1.2.3.3.cmml">1</mn></mrow><mi id="S3.E2.m1.10.10.1.1.3.2.1.3" xref="S3.E2.m1.10.10.1.1.3.2.1.3.cmml">k</mi></munderover><mrow id="S3.E2.m1.10.10.1.1.3.2.2" xref="S3.E2.m1.10.10.1.1.3.2.2.cmml"><mfrac id="S3.E2.m1.6.6" xref="S3.E2.m1.6.6.cmml"><mrow id="S3.E2.m1.5.5.2" xref="S3.E2.m1.5.5.2.cmml"><msub id="S3.E2.m1.5.5.2.4" xref="S3.E2.m1.5.5.2.4.cmml"><mi id="S3.E2.m1.5.5.2.4.2" xref="S3.E2.m1.5.5.2.4.2.cmml">w</mi><mi id="S3.E2.m1.5.5.2.4.3" xref="S3.E2.m1.5.5.2.4.3.cmml">i</mi></msub><mo id="S3.E2.m1.5.5.2.3" xref="S3.E2.m1.5.5.2.3.cmml">⁢</mo><mrow id="S3.E2.m1.5.5.2.5.2" xref="S3.E2.m1.5.5.2.5.1.cmml"><mo id="S3.E2.m1.5.5.2.5.2.1" stretchy="false" xref="S3.E2.m1.5.5.2.5.1.cmml">(</mo><mi id="S3.E2.m1.4.4.1.1" xref="S3.E2.m1.4.4.1.1.cmml">s</mi><mo id="S3.E2.m1.5.5.2.5.2.2" xref="S3.E2.m1.5.5.2.5.1.cmml">,</mo><mi id="S3.E2.m1.5.5.2.2" xref="S3.E2.m1.5.5.2.2.cmml">g</mi><mo id="S3.E2.m1.5.5.2.5.2.3" stretchy="false" xref="S3.E2.m1.5.5.2.5.1.cmml">)</mo></mrow></mrow><mrow id="S3.E2.m1.6.6.3" xref="S3.E2.m1.6.6.3.cmml"><msubsup id="S3.E2.m1.6.6.3.3" xref="S3.E2.m1.6.6.3.3.cmml"><mi id="S3.E2.m1.6.6.3.3.2.2" xref="S3.E2.m1.6.6.3.3.2.2.cmml">σ</mi><mi id="S3.E2.m1.6.6.3.3.2.3" xref="S3.E2.m1.6.6.3.3.2.3.cmml">i</mi><mi id="S3.E2.m1.6.6.3.3.3" xref="S3.E2.m1.6.6.3.3.3.cmml">j</mi></msubsup><mo id="S3.E2.m1.6.6.3.2" xref="S3.E2.m1.6.6.3.2.cmml">⁢</mo><mrow id="S3.E2.m1.6.6.3.4.2" xref="S3.E2.m1.6.6.3.cmml"><mo id="S3.E2.m1.6.6.3.4.2.1" stretchy="false" xref="S3.E2.m1.6.6.3.cmml">(</mo><mi id="S3.E2.m1.6.6.3.1" xref="S3.E2.m1.6.6.3.1.cmml">s</mi><mo id="S3.E2.m1.6.6.3.4.2.2" stretchy="false" xref="S3.E2.m1.6.6.3.cmml">)</mo></mrow></mrow></mfrac><mo id="S3.E2.m1.10.10.1.1.3.2.2.1" xref="S3.E2.m1.10.10.1.1.3.2.2.1.cmml">⁢</mo><msubsup id="S3.E2.m1.10.10.1.1.3.2.2.2" xref="S3.E2.m1.10.10.1.1.3.2.2.2.cmml"><mi id="S3.E2.m1.10.10.1.1.3.2.2.2.2.2" xref="S3.E2.m1.10.10.1.1.3.2.2.2.2.2.cmml">μ</mi><mi id="S3.E2.m1.10.10.1.1.3.2.2.2.2.3" xref="S3.E2.m1.10.10.1.1.3.2.2.2.2.3.cmml">i</mi><mi id="S3.E2.m1.10.10.1.1.3.2.2.2.3" xref="S3.E2.m1.10.10.1.1.3.2.2.2.3.cmml">j</mi></msubsup><mo id="S3.E2.m1.10.10.1.1.3.2.2.1a" xref="S3.E2.m1.10.10.1.1.3.2.2.1.cmml">⁢</mo><mrow id="S3.E2.m1.10.10.1.1.3.2.2.3.2" xref="S3.E2.m1.10.10.1.1.3.2.2.cmml"><mo id="S3.E2.m1.10.10.1.1.3.2.2.3.2.1" stretchy="false" xref="S3.E2.m1.10.10.1.1.3.2.2.cmml">(</mo><mi id="S3.E2.m1.9.9" xref="S3.E2.m1.9.9.cmml">s</mi><mo id="S3.E2.m1.10.10.1.1.3.2.2.3.2.2" stretchy="false" xref="S3.E2.m1.10.10.1.1.3.2.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="S3.E2.m1.10.10.1.2" xref="S3.E2.m1.10.10.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.10b"><apply id="S3.E2.m1.10.10.1.1.cmml" xref="S3.E2.m1.10.10.1"><eq id="S3.E2.m1.10.10.1.1.1.cmml" xref="S3.E2.m1.10.10.1.1.1"></eq><apply id="S3.E2.m1.10.10.1.1.2.cmml" xref="S3.E2.m1.10.10.1.1.2"><times id="S3.E2.m1.10.10.1.1.2.1.cmml" xref="S3.E2.m1.10.10.1.1.2.1"></times><apply id="S3.E2.m1.10.10.1.1.2.2.cmml" xref="S3.E2.m1.10.10.1.1.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.10.10.1.1.2.2.1.cmml" xref="S3.E2.m1.10.10.1.1.2.2">superscript</csymbol><ci id="S3.E2.m1.10.10.1.1.2.2.2.cmml" xref="S3.E2.m1.10.10.1.1.2.2.2">𝜇</ci><ci id="S3.E2.m1.10.10.1.1.2.2.3.cmml" xref="S3.E2.m1.10.10.1.1.2.2.3">𝑗</ci></apply><interval closure="open" id="S3.E2.m1.10.10.1.1.2.3.1.cmml" xref="S3.E2.m1.10.10.1.1.2.3.2"><ci id="S3.E2.m1.7.7.cmml" xref="S3.E2.m1.7.7">𝑠</ci><ci id="S3.E2.m1.8.8.cmml" xref="S3.E2.m1.8.8">𝑔</ci></interval></apply><apply id="S3.E2.m1.10.10.1.1.3.cmml" xref="S3.E2.m1.10.10.1.1.3"><times id="S3.E2.m1.10.10.1.1.3.1.cmml" xref="S3.E2.m1.10.10.1.1.3.1"></times><apply id="S3.E2.m1.3.3.cmml" xref="S3.E2.m1.3.3"><divide id="S3.E2.m1.3.3.4.cmml" xref="S3.E2.m1.3.3"></divide><cn id="S3.E2.m1.3.3.5.cmml" type="integer" xref="S3.E2.m1.3.3.5">1</cn><apply id="S3.E2.m1.3.3.3.cmml" xref="S3.E2.m1.3.3.3"><apply id="S3.E2.m1.3.3.3.4.cmml" xref="S3.E2.m1.3.3.3.4"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.3.4.1.cmml" xref="S3.E2.m1.3.3.3.4">superscript</csymbol><apply id="S3.E2.m1.3.3.3.4.2.cmml" xref="S3.E2.m1.3.3.3.4"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.3.4.2.1.cmml" xref="S3.E2.m1.3.3.3.4">subscript</csymbol><sum id="S3.E2.m1.3.3.3.4.2.2.cmml" xref="S3.E2.m1.3.3.3.4.2.2"></sum><apply id="S3.E2.m1.3.3.3.4.2.3.cmml" xref="S3.E2.m1.3.3.3.4.2.3"><eq id="S3.E2.m1.3.3.3.4.2.3.1.cmml" xref="S3.E2.m1.3.3.3.4.2.3.1"></eq><ci id="S3.E2.m1.3.3.3.4.2.3.2.cmml" xref="S3.E2.m1.3.3.3.4.2.3.2">𝑙</ci><cn id="S3.E2.m1.3.3.3.4.2.3.3.cmml" type="integer" xref="S3.E2.m1.3.3.3.4.2.3.3">1</cn></apply></apply><ci id="S3.E2.m1.3.3.3.4.3.cmml" xref="S3.E2.m1.3.3.3.4.3">𝑘</ci></apply><apply id="S3.E2.m1.3.3.3.3.cmml" xref="S3.E2.m1.3.3.3.3"><divide id="S3.E2.m1.3.3.3.3.4.cmml" xref="S3.E2.m1.3.3.3.3"></divide><apply id="S3.E2.m1.2.2.2.2.2.cmml" xref="S3.E2.m1.2.2.2.2.2"><times id="S3.E2.m1.2.2.2.2.2.3.cmml" xref="S3.E2.m1.2.2.2.2.2.3"></times><apply id="S3.E2.m1.2.2.2.2.2.4.cmml" xref="S3.E2.m1.2.2.2.2.2.4"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.2.2.2.4.1.cmml" xref="S3.E2.m1.2.2.2.2.2.4">subscript</csymbol><ci id="S3.E2.m1.2.2.2.2.2.4.2.cmml" xref="S3.E2.m1.2.2.2.2.2.4.2">𝑤</ci><ci id="S3.E2.m1.2.2.2.2.2.4.3.cmml" xref="S3.E2.m1.2.2.2.2.2.4.3">𝑙</ci></apply><interval closure="open" id="S3.E2.m1.2.2.2.2.2.5.1.cmml" xref="S3.E2.m1.2.2.2.2.2.5.2"><ci id="S3.E2.m1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1">𝑠</ci><ci id="S3.E2.m1.2.2.2.2.2.2.cmml" xref="S3.E2.m1.2.2.2.2.2.2">𝑔</ci></interval></apply><apply id="S3.E2.m1.3.3.3.3.3.cmml" xref="S3.E2.m1.3.3.3.3.3"><times id="S3.E2.m1.3.3.3.3.3.2.cmml" xref="S3.E2.m1.3.3.3.3.3.2"></times><apply id="S3.E2.m1.3.3.3.3.3.3.cmml" xref="S3.E2.m1.3.3.3.3.3.3"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.3.3.3.3.1.cmml" xref="S3.E2.m1.3.3.3.3.3.3">superscript</csymbol><apply id="S3.E2.m1.3.3.3.3.3.3.2.cmml" xref="S3.E2.m1.3.3.3.3.3.3"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.3.3.3.3.2.1.cmml" xref="S3.E2.m1.3.3.3.3.3.3">subscript</csymbol><ci id="S3.E2.m1.3.3.3.3.3.3.2.2.cmml" xref="S3.E2.m1.3.3.3.3.3.3.2.2">𝜎</ci><ci id="S3.E2.m1.3.3.3.3.3.3.2.3.cmml" xref="S3.E2.m1.3.3.3.3.3.3.2.3">𝑙</ci></apply><ci id="S3.E2.m1.3.3.3.3.3.3.3.cmml" xref="S3.E2.m1.3.3.3.3.3.3.3">𝑗</ci></apply><ci id="S3.E2.m1.3.3.3.3.3.1.cmml" xref="S3.E2.m1.3.3.3.3.3.1">𝑠</ci></apply></apply></apply></apply><apply id="S3.E2.m1.10.10.1.1.3.2.cmml" xref="S3.E2.m1.10.10.1.1.3.2"><apply id="S3.E2.m1.10.10.1.1.3.2.1.cmml" xref="S3.E2.m1.10.10.1.1.3.2.1"><csymbol cd="ambiguous" id="S3.E2.m1.10.10.1.1.3.2.1.1.cmml" xref="S3.E2.m1.10.10.1.1.3.2.1">superscript</csymbol><apply id="S3.E2.m1.10.10.1.1.3.2.1.2.cmml" xref="S3.E2.m1.10.10.1.1.3.2.1"><csymbol cd="ambiguous" id="S3.E2.m1.10.10.1.1.3.2.1.2.1.cmml" xref="S3.E2.m1.10.10.1.1.3.2.1">subscript</csymbol><sum id="S3.E2.m1.10.10.1.1.3.2.1.2.2.cmml" xref="S3.E2.m1.10.10.1.1.3.2.1.2.2"></sum><apply id="S3.E2.m1.10.10.1.1.3.2.1.2.3.cmml" xref="S3.E2.m1.10.10.1.1.3.2.1.2.3"><eq id="S3.E2.m1.10.10.1.1.3.2.1.2.3.1.cmml" xref="S3.E2.m1.10.10.1.1.3.2.1.2.3.1"></eq><ci id="S3.E2.m1.10.10.1.1.3.2.1.2.3.2.cmml" xref="S3.E2.m1.10.10.1.1.3.2.1.2.3.2">𝑖</ci><cn id="S3.E2.m1.10.10.1.1.3.2.1.2.3.3.cmml" type="integer" xref="S3.E2.m1.10.10.1.1.3.2.1.2.3.3">1</cn></apply></apply><ci id="S3.E2.m1.10.10.1.1.3.2.1.3.cmml" xref="S3.E2.m1.10.10.1.1.3.2.1.3">𝑘</ci></apply><apply id="S3.E2.m1.10.10.1.1.3.2.2.cmml" xref="S3.E2.m1.10.10.1.1.3.2.2"><times id="S3.E2.m1.10.10.1.1.3.2.2.1.cmml" xref="S3.E2.m1.10.10.1.1.3.2.2.1"></times><apply id="S3.E2.m1.6.6.cmml" xref="S3.E2.m1.6.6"><divide id="S3.E2.m1.6.6.4.cmml" xref="S3.E2.m1.6.6"></divide><apply id="S3.E2.m1.5.5.2.cmml" xref="S3.E2.m1.5.5.2"><times id="S3.E2.m1.5.5.2.3.cmml" xref="S3.E2.m1.5.5.2.3"></times><apply id="S3.E2.m1.5.5.2.4.cmml" xref="S3.E2.m1.5.5.2.4"><csymbol cd="ambiguous" id="S3.E2.m1.5.5.2.4.1.cmml" xref="S3.E2.m1.5.5.2.4">subscript</csymbol><ci id="S3.E2.m1.5.5.2.4.2.cmml" xref="S3.E2.m1.5.5.2.4.2">𝑤</ci><ci id="S3.E2.m1.5.5.2.4.3.cmml" xref="S3.E2.m1.5.5.2.4.3">𝑖</ci></apply><interval closure="open" id="S3.E2.m1.5.5.2.5.1.cmml" xref="S3.E2.m1.5.5.2.5.2"><ci id="S3.E2.m1.4.4.1.1.cmml" xref="S3.E2.m1.4.4.1.1">𝑠</ci><ci id="S3.E2.m1.5.5.2.2.cmml" xref="S3.E2.m1.5.5.2.2">𝑔</ci></interval></apply><apply id="S3.E2.m1.6.6.3.cmml" xref="S3.E2.m1.6.6.3"><times id="S3.E2.m1.6.6.3.2.cmml" xref="S3.E2.m1.6.6.3.2"></times><apply id="S3.E2.m1.6.6.3.3.cmml" xref="S3.E2.m1.6.6.3.3"><csymbol cd="ambiguous" id="S3.E2.m1.6.6.3.3.1.cmml" xref="S3.E2.m1.6.6.3.3">superscript</csymbol><apply id="S3.E2.m1.6.6.3.3.2.cmml" xref="S3.E2.m1.6.6.3.3"><csymbol cd="ambiguous" id="S3.E2.m1.6.6.3.3.2.1.cmml" xref="S3.E2.m1.6.6.3.3">subscript</csymbol><ci id="S3.E2.m1.6.6.3.3.2.2.cmml" xref="S3.E2.m1.6.6.3.3.2.2">𝜎</ci><ci id="S3.E2.m1.6.6.3.3.2.3.cmml" xref="S3.E2.m1.6.6.3.3.2.3">𝑖</ci></apply><ci id="S3.E2.m1.6.6.3.3.3.cmml" xref="S3.E2.m1.6.6.3.3.3">𝑗</ci></apply><ci id="S3.E2.m1.6.6.3.1.cmml" xref="S3.E2.m1.6.6.3.1">𝑠</ci></apply></apply><apply id="S3.E2.m1.10.10.1.1.3.2.2.2.cmml" xref="S3.E2.m1.10.10.1.1.3.2.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.10.10.1.1.3.2.2.2.1.cmml" xref="S3.E2.m1.10.10.1.1.3.2.2.2">superscript</csymbol><apply id="S3.E2.m1.10.10.1.1.3.2.2.2.2.cmml" xref="S3.E2.m1.10.10.1.1.3.2.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.10.10.1.1.3.2.2.2.2.1.cmml" xref="S3.E2.m1.10.10.1.1.3.2.2.2">subscript</csymbol><ci id="S3.E2.m1.10.10.1.1.3.2.2.2.2.2.cmml" xref="S3.E2.m1.10.10.1.1.3.2.2.2.2.2">𝜇</ci><ci id="S3.E2.m1.10.10.1.1.3.2.2.2.2.3.cmml" xref="S3.E2.m1.10.10.1.1.3.2.2.2.2.3">𝑖</ci></apply><ci id="S3.E2.m1.10.10.1.1.3.2.2.2.3.cmml" xref="S3.E2.m1.10.10.1.1.3.2.2.2.3">𝑗</ci></apply><ci id="S3.E2.m1.9.9.cmml" xref="S3.E2.m1.9.9">𝑠</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.10c">\mu^{j}(s,g)=\frac{1}{\sum_{l=1}^{k}\frac{w_{l}(s,g)}{\sigma_{l}^{j}(s)}}\sum_%
{i=1}^{k}\frac{w_{i}(s,g)}{\sigma_{i}^{j}(s)}\mu_{i}^{j}(s),</annotation><annotation encoding="application/x-llamapun" id="S3.E2.m1.10d">italic_μ start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT ( italic_s , italic_g ) = divide start_ARG 1 end_ARG start_ARG ∑ start_POSTSUBSCRIPT italic_l = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT divide start_ARG italic_w start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT ( italic_s , italic_g ) end_ARG start_ARG italic_σ start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT ( italic_s ) end_ARG end_ARG ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT divide start_ARG italic_w start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ( italic_s , italic_g ) end_ARG start_ARG italic_σ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT ( italic_s ) end_ARG italic_μ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT ( italic_s ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.p1.24">and</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\qquad\sigma^{j}(s,g)=\left(\sum_{i=1}^{k}\frac{w_{i}(s,g)}{\sigma_{i}^{j}(s)}%
\right)^{-1}." class="ltx_Math" display="block" id="S3.E3.m1.6"><semantics id="S3.E3.m1.6a"><mrow id="S3.E3.m1.6.6.1" xref="S3.E3.m1.6.6.1.1.cmml"><mrow id="S3.E3.m1.6.6.1.1" xref="S3.E3.m1.6.6.1.1.cmml"><mrow id="S3.E3.m1.6.6.1.1.3" xref="S3.E3.m1.6.6.1.1.3.cmml"><msup id="S3.E3.m1.6.6.1.1.3.2" xref="S3.E3.m1.6.6.1.1.3.2.cmml"><mi id="S3.E3.m1.6.6.1.1.3.2.2" xref="S3.E3.m1.6.6.1.1.3.2.2.cmml">σ</mi><mi id="S3.E3.m1.6.6.1.1.3.2.3" xref="S3.E3.m1.6.6.1.1.3.2.3.cmml">j</mi></msup><mo id="S3.E3.m1.6.6.1.1.3.1" xref="S3.E3.m1.6.6.1.1.3.1.cmml">⁢</mo><mrow id="S3.E3.m1.6.6.1.1.3.3.2" xref="S3.E3.m1.6.6.1.1.3.3.1.cmml"><mo id="S3.E3.m1.6.6.1.1.3.3.2.1" stretchy="false" xref="S3.E3.m1.6.6.1.1.3.3.1.cmml">(</mo><mi id="S3.E3.m1.4.4" xref="S3.E3.m1.4.4.cmml">s</mi><mo id="S3.E3.m1.6.6.1.1.3.3.2.2" xref="S3.E3.m1.6.6.1.1.3.3.1.cmml">,</mo><mi id="S3.E3.m1.5.5" xref="S3.E3.m1.5.5.cmml">g</mi><mo id="S3.E3.m1.6.6.1.1.3.3.2.3" stretchy="false" xref="S3.E3.m1.6.6.1.1.3.3.1.cmml">)</mo></mrow></mrow><mo id="S3.E3.m1.6.6.1.1.2" xref="S3.E3.m1.6.6.1.1.2.cmml">=</mo><msup id="S3.E3.m1.6.6.1.1.1" xref="S3.E3.m1.6.6.1.1.1.cmml"><mrow id="S3.E3.m1.6.6.1.1.1.1.1" xref="S3.E3.m1.6.6.1.1.1.1.1.1.cmml"><mo id="S3.E3.m1.6.6.1.1.1.1.1.2" xref="S3.E3.m1.6.6.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E3.m1.6.6.1.1.1.1.1.1" xref="S3.E3.m1.6.6.1.1.1.1.1.1.cmml"><munderover id="S3.E3.m1.6.6.1.1.1.1.1.1.1" xref="S3.E3.m1.6.6.1.1.1.1.1.1.1.cmml"><mo id="S3.E3.m1.6.6.1.1.1.1.1.1.1.2.2" lspace="0em" movablelimits="false" xref="S3.E3.m1.6.6.1.1.1.1.1.1.1.2.2.cmml">∑</mo><mrow id="S3.E3.m1.6.6.1.1.1.1.1.1.1.2.3" xref="S3.E3.m1.6.6.1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.E3.m1.6.6.1.1.1.1.1.1.1.2.3.2" xref="S3.E3.m1.6.6.1.1.1.1.1.1.1.2.3.2.cmml">i</mi><mo id="S3.E3.m1.6.6.1.1.1.1.1.1.1.2.3.1" xref="S3.E3.m1.6.6.1.1.1.1.1.1.1.2.3.1.cmml">=</mo><mn id="S3.E3.m1.6.6.1.1.1.1.1.1.1.2.3.3" xref="S3.E3.m1.6.6.1.1.1.1.1.1.1.2.3.3.cmml">1</mn></mrow><mi id="S3.E3.m1.6.6.1.1.1.1.1.1.1.3" xref="S3.E3.m1.6.6.1.1.1.1.1.1.1.3.cmml">k</mi></munderover><mfrac id="S3.E3.m1.3.3" xref="S3.E3.m1.3.3.cmml"><mrow id="S3.E3.m1.2.2.2" xref="S3.E3.m1.2.2.2.cmml"><msub id="S3.E3.m1.2.2.2.4" xref="S3.E3.m1.2.2.2.4.cmml"><mi id="S3.E3.m1.2.2.2.4.2" xref="S3.E3.m1.2.2.2.4.2.cmml">w</mi><mi id="S3.E3.m1.2.2.2.4.3" xref="S3.E3.m1.2.2.2.4.3.cmml">i</mi></msub><mo id="S3.E3.m1.2.2.2.3" xref="S3.E3.m1.2.2.2.3.cmml">⁢</mo><mrow id="S3.E3.m1.2.2.2.5.2" xref="S3.E3.m1.2.2.2.5.1.cmml"><mo id="S3.E3.m1.2.2.2.5.2.1" stretchy="false" xref="S3.E3.m1.2.2.2.5.1.cmml">(</mo><mi id="S3.E3.m1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.cmml">s</mi><mo id="S3.E3.m1.2.2.2.5.2.2" xref="S3.E3.m1.2.2.2.5.1.cmml">,</mo><mi id="S3.E3.m1.2.2.2.2" xref="S3.E3.m1.2.2.2.2.cmml">g</mi><mo id="S3.E3.m1.2.2.2.5.2.3" stretchy="false" xref="S3.E3.m1.2.2.2.5.1.cmml">)</mo></mrow></mrow><mrow id="S3.E3.m1.3.3.3" xref="S3.E3.m1.3.3.3.cmml"><msubsup id="S3.E3.m1.3.3.3.3" xref="S3.E3.m1.3.3.3.3.cmml"><mi id="S3.E3.m1.3.3.3.3.2.2" xref="S3.E3.m1.3.3.3.3.2.2.cmml">σ</mi><mi id="S3.E3.m1.3.3.3.3.2.3" xref="S3.E3.m1.3.3.3.3.2.3.cmml">i</mi><mi id="S3.E3.m1.3.3.3.3.3" xref="S3.E3.m1.3.3.3.3.3.cmml">j</mi></msubsup><mo id="S3.E3.m1.3.3.3.2" xref="S3.E3.m1.3.3.3.2.cmml">⁢</mo><mrow id="S3.E3.m1.3.3.3.4.2" xref="S3.E3.m1.3.3.3.cmml"><mo id="S3.E3.m1.3.3.3.4.2.1" stretchy="false" xref="S3.E3.m1.3.3.3.cmml">(</mo><mi id="S3.E3.m1.3.3.3.1" xref="S3.E3.m1.3.3.3.1.cmml">s</mi><mo id="S3.E3.m1.3.3.3.4.2.2" stretchy="false" xref="S3.E3.m1.3.3.3.cmml">)</mo></mrow></mrow></mfrac></mrow><mo id="S3.E3.m1.6.6.1.1.1.1.1.3" xref="S3.E3.m1.6.6.1.1.1.1.1.1.cmml">)</mo></mrow><mrow id="S3.E3.m1.6.6.1.1.1.3" xref="S3.E3.m1.6.6.1.1.1.3.cmml"><mo id="S3.E3.m1.6.6.1.1.1.3a" xref="S3.E3.m1.6.6.1.1.1.3.cmml">−</mo><mn id="S3.E3.m1.6.6.1.1.1.3.2" xref="S3.E3.m1.6.6.1.1.1.3.2.cmml">1</mn></mrow></msup></mrow><mo id="S3.E3.m1.6.6.1.2" lspace="0em" xref="S3.E3.m1.6.6.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.6b"><apply id="S3.E3.m1.6.6.1.1.cmml" xref="S3.E3.m1.6.6.1"><eq id="S3.E3.m1.6.6.1.1.2.cmml" xref="S3.E3.m1.6.6.1.1.2"></eq><apply id="S3.E3.m1.6.6.1.1.3.cmml" xref="S3.E3.m1.6.6.1.1.3"><times id="S3.E3.m1.6.6.1.1.3.1.cmml" xref="S3.E3.m1.6.6.1.1.3.1"></times><apply id="S3.E3.m1.6.6.1.1.3.2.cmml" xref="S3.E3.m1.6.6.1.1.3.2"><csymbol cd="ambiguous" id="S3.E3.m1.6.6.1.1.3.2.1.cmml" xref="S3.E3.m1.6.6.1.1.3.2">superscript</csymbol><ci id="S3.E3.m1.6.6.1.1.3.2.2.cmml" xref="S3.E3.m1.6.6.1.1.3.2.2">𝜎</ci><ci id="S3.E3.m1.6.6.1.1.3.2.3.cmml" xref="S3.E3.m1.6.6.1.1.3.2.3">𝑗</ci></apply><interval closure="open" id="S3.E3.m1.6.6.1.1.3.3.1.cmml" xref="S3.E3.m1.6.6.1.1.3.3.2"><ci id="S3.E3.m1.4.4.cmml" xref="S3.E3.m1.4.4">𝑠</ci><ci id="S3.E3.m1.5.5.cmml" xref="S3.E3.m1.5.5">𝑔</ci></interval></apply><apply id="S3.E3.m1.6.6.1.1.1.cmml" xref="S3.E3.m1.6.6.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.6.6.1.1.1.2.cmml" xref="S3.E3.m1.6.6.1.1.1">superscript</csymbol><apply id="S3.E3.m1.6.6.1.1.1.1.1.1.cmml" xref="S3.E3.m1.6.6.1.1.1.1.1"><apply id="S3.E3.m1.6.6.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.6.6.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.6.6.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.6.6.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E3.m1.6.6.1.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.6.6.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.6.6.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E3.m1.6.6.1.1.1.1.1.1.1">subscript</csymbol><sum id="S3.E3.m1.6.6.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E3.m1.6.6.1.1.1.1.1.1.1.2.2"></sum><apply id="S3.E3.m1.6.6.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E3.m1.6.6.1.1.1.1.1.1.1.2.3"><eq id="S3.E3.m1.6.6.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E3.m1.6.6.1.1.1.1.1.1.1.2.3.1"></eq><ci id="S3.E3.m1.6.6.1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E3.m1.6.6.1.1.1.1.1.1.1.2.3.2">𝑖</ci><cn id="S3.E3.m1.6.6.1.1.1.1.1.1.1.2.3.3.cmml" type="integer" xref="S3.E3.m1.6.6.1.1.1.1.1.1.1.2.3.3">1</cn></apply></apply><ci id="S3.E3.m1.6.6.1.1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.6.6.1.1.1.1.1.1.1.3">𝑘</ci></apply><apply id="S3.E3.m1.3.3.cmml" xref="S3.E3.m1.3.3"><divide id="S3.E3.m1.3.3.4.cmml" xref="S3.E3.m1.3.3"></divide><apply id="S3.E3.m1.2.2.2.cmml" xref="S3.E3.m1.2.2.2"><times id="S3.E3.m1.2.2.2.3.cmml" xref="S3.E3.m1.2.2.2.3"></times><apply id="S3.E3.m1.2.2.2.4.cmml" xref="S3.E3.m1.2.2.2.4"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.2.4.1.cmml" xref="S3.E3.m1.2.2.2.4">subscript</csymbol><ci id="S3.E3.m1.2.2.2.4.2.cmml" xref="S3.E3.m1.2.2.2.4.2">𝑤</ci><ci id="S3.E3.m1.2.2.2.4.3.cmml" xref="S3.E3.m1.2.2.2.4.3">𝑖</ci></apply><interval closure="open" id="S3.E3.m1.2.2.2.5.1.cmml" xref="S3.E3.m1.2.2.2.5.2"><ci id="S3.E3.m1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1">𝑠</ci><ci id="S3.E3.m1.2.2.2.2.cmml" xref="S3.E3.m1.2.2.2.2">𝑔</ci></interval></apply><apply id="S3.E3.m1.3.3.3.cmml" xref="S3.E3.m1.3.3.3"><times id="S3.E3.m1.3.3.3.2.cmml" xref="S3.E3.m1.3.3.3.2"></times><apply id="S3.E3.m1.3.3.3.3.cmml" xref="S3.E3.m1.3.3.3.3"><csymbol cd="ambiguous" id="S3.E3.m1.3.3.3.3.1.cmml" xref="S3.E3.m1.3.3.3.3">superscript</csymbol><apply id="S3.E3.m1.3.3.3.3.2.cmml" xref="S3.E3.m1.3.3.3.3"><csymbol cd="ambiguous" id="S3.E3.m1.3.3.3.3.2.1.cmml" xref="S3.E3.m1.3.3.3.3">subscript</csymbol><ci id="S3.E3.m1.3.3.3.3.2.2.cmml" xref="S3.E3.m1.3.3.3.3.2.2">𝜎</ci><ci id="S3.E3.m1.3.3.3.3.2.3.cmml" xref="S3.E3.m1.3.3.3.3.2.3">𝑖</ci></apply><ci id="S3.E3.m1.3.3.3.3.3.cmml" xref="S3.E3.m1.3.3.3.3.3">𝑗</ci></apply><ci id="S3.E3.m1.3.3.3.1.cmml" xref="S3.E3.m1.3.3.3.1">𝑠</ci></apply></apply></apply><apply id="S3.E3.m1.6.6.1.1.1.3.cmml" xref="S3.E3.m1.6.6.1.1.1.3"><minus id="S3.E3.m1.6.6.1.1.1.3.1.cmml" xref="S3.E3.m1.6.6.1.1.1.3"></minus><cn id="S3.E3.m1.6.6.1.1.1.3.2.cmml" type="integer" xref="S3.E3.m1.6.6.1.1.1.3.2">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.6c">\qquad\sigma^{j}(s,g)=\left(\sum_{i=1}^{k}\frac{w_{i}(s,g)}{\sigma_{i}^{j}(s)}%
\right)^{-1}.</annotation><annotation encoding="application/x-llamapun" id="S3.E3.m1.6d">italic_σ start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT ( italic_s , italic_g ) = ( ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT divide start_ARG italic_w start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ( italic_s , italic_g ) end_ARG start_ARG italic_σ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT ( italic_s ) end_ARG ) start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.p1.23">The gating function <math alttext="w" class="ltx_Math" display="inline" id="S3.SS2.p1.21.m1.1"><semantics id="S3.SS2.p1.21.m1.1a"><mi id="S3.SS2.p1.21.m1.1.1" xref="S3.SS2.p1.21.m1.1.1.cmml">w</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.21.m1.1b"><ci id="S3.SS2.p1.21.m1.1.1.cmml" xref="S3.SS2.p1.21.m1.1.1">𝑤</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.21.m1.1c">w</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.21.m1.1d">italic_w</annotation></semantics></math> and the primitives <math alttext="\pi_{i}" class="ltx_Math" display="inline" id="S3.SS2.p1.22.m2.1"><semantics id="S3.SS2.p1.22.m2.1a"><msub id="S3.SS2.p1.22.m2.1.1" xref="S3.SS2.p1.22.m2.1.1.cmml"><mi id="S3.SS2.p1.22.m2.1.1.2" xref="S3.SS2.p1.22.m2.1.1.2.cmml">π</mi><mi id="S3.SS2.p1.22.m2.1.1.3" xref="S3.SS2.p1.22.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.22.m2.1b"><apply id="S3.SS2.p1.22.m2.1.1.cmml" xref="S3.SS2.p1.22.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.22.m2.1.1.1.cmml" xref="S3.SS2.p1.22.m2.1.1">subscript</csymbol><ci id="S3.SS2.p1.22.m2.1.1.2.cmml" xref="S3.SS2.p1.22.m2.1.1.2">𝜋</ci><ci id="S3.SS2.p1.22.m2.1.1.3.cmml" xref="S3.SS2.p1.22.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.22.m2.1c">\pi_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.22.m2.1d">italic_π start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> mean and variance are parameterized by neural networks.
Hence the policy <math alttext="\pi" class="ltx_Math" display="inline" id="S3.SS2.p1.23.m3.1"><semantics id="S3.SS2.p1.23.m3.1a"><mi id="S3.SS2.p1.23.m3.1.1" xref="S3.SS2.p1.23.m3.1.1.cmml">π</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.23.m3.1b"><ci id="S3.SS2.p1.23.m3.1.1.cmml" xref="S3.SS2.p1.23.m3.1.1">𝜋</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.23.m3.1c">\pi</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.23.m3.1d">italic_π</annotation></semantics></math> can be trained end-to-end using gradient descent.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S3.SS3.4.1.1">III-C</span> </span><span class="ltx_text ltx_font_italic" id="S3.SS3.5.2">Asymmetric Self-Play</span>
</h3>
<div class="ltx_para" id="S3.SS3.p1">
<p class="ltx_p" id="S3.SS3.p1.6">Asymmetric Self-Play <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04855v1#bib.bib17" title="">17</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04855v1#bib.bib18" title="">18</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04855v1#bib.bib19" title="">19</a>]</cite> is a curriculum learning approach that trains a goal <span class="ltx_text ltx_font_italic" id="S3.SS3.p1.6.1">generator</span>, Alice, along with a goal-conditioned <span class="ltx_text ltx_font_italic" id="S3.SS3.p1.6.2">solver</span>, Bob.
Alice starts from an arbitrary state <math alttext="s_{0}" class="ltx_Math" display="inline" id="S3.SS3.p1.1.m1.1"><semantics id="S3.SS3.p1.1.m1.1a"><msub id="S3.SS3.p1.1.m1.1.1" xref="S3.SS3.p1.1.m1.1.1.cmml"><mi id="S3.SS3.p1.1.m1.1.1.2" xref="S3.SS3.p1.1.m1.1.1.2.cmml">s</mi><mn id="S3.SS3.p1.1.m1.1.1.3" xref="S3.SS3.p1.1.m1.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.1.m1.1b"><apply id="S3.SS3.p1.1.m1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.1.m1.1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS3.p1.1.m1.1.1.2.cmml" xref="S3.SS3.p1.1.m1.1.1.2">𝑠</ci><cn id="S3.SS3.p1.1.m1.1.1.3.cmml" type="integer" xref="S3.SS3.p1.1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.1.m1.1c">s_{0}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.1.m1.1d">italic_s start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math> in the environment and takes a sequence of actions that leads to some state <math alttext="s_{g}" class="ltx_Math" display="inline" id="S3.SS3.p1.2.m2.1"><semantics id="S3.SS3.p1.2.m2.1a"><msub id="S3.SS3.p1.2.m2.1.1" xref="S3.SS3.p1.2.m2.1.1.cmml"><mi id="S3.SS3.p1.2.m2.1.1.2" xref="S3.SS3.p1.2.m2.1.1.2.cmml">s</mi><mi id="S3.SS3.p1.2.m2.1.1.3" xref="S3.SS3.p1.2.m2.1.1.3.cmml">g</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.2.m2.1b"><apply id="S3.SS3.p1.2.m2.1.1.cmml" xref="S3.SS3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.2.m2.1.1.1.cmml" xref="S3.SS3.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS3.p1.2.m2.1.1.2.cmml" xref="S3.SS3.p1.2.m2.1.1.2">𝑠</ci><ci id="S3.SS3.p1.2.m2.1.1.3.cmml" xref="S3.SS3.p1.2.m2.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.2.m2.1c">s_{g}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.2.m2.1d">italic_s start_POSTSUBSCRIPT italic_g end_POSTSUBSCRIPT</annotation></semantics></math>, which becomes the goal state of Bob.
The environment is then reset and Bob is tasked to reach the same state <math alttext="s_{g}" class="ltx_Math" display="inline" id="S3.SS3.p1.3.m3.1"><semantics id="S3.SS3.p1.3.m3.1a"><msub id="S3.SS3.p1.3.m3.1.1" xref="S3.SS3.p1.3.m3.1.1.cmml"><mi id="S3.SS3.p1.3.m3.1.1.2" xref="S3.SS3.p1.3.m3.1.1.2.cmml">s</mi><mi id="S3.SS3.p1.3.m3.1.1.3" xref="S3.SS3.p1.3.m3.1.1.3.cmml">g</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.3.m3.1b"><apply id="S3.SS3.p1.3.m3.1.1.cmml" xref="S3.SS3.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.3.m3.1.1.1.cmml" xref="S3.SS3.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS3.p1.3.m3.1.1.2.cmml" xref="S3.SS3.p1.3.m3.1.1.2">𝑠</ci><ci id="S3.SS3.p1.3.m3.1.1.3.cmml" xref="S3.SS3.p1.3.m3.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.3.m3.1c">s_{g}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.3.m3.1d">italic_s start_POSTSUBSCRIPT italic_g end_POSTSUBSCRIPT</annotation></semantics></math> as Alice by starting from the same state <math alttext="s_{0}" class="ltx_Math" display="inline" id="S3.SS3.p1.4.m4.1"><semantics id="S3.SS3.p1.4.m4.1a"><msub id="S3.SS3.p1.4.m4.1.1" xref="S3.SS3.p1.4.m4.1.1.cmml"><mi id="S3.SS3.p1.4.m4.1.1.2" xref="S3.SS3.p1.4.m4.1.1.2.cmml">s</mi><mn id="S3.SS3.p1.4.m4.1.1.3" xref="S3.SS3.p1.4.m4.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.4.m4.1b"><apply id="S3.SS3.p1.4.m4.1.1.cmml" xref="S3.SS3.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.4.m4.1.1.1.cmml" xref="S3.SS3.p1.4.m4.1.1">subscript</csymbol><ci id="S3.SS3.p1.4.m4.1.1.2.cmml" xref="S3.SS3.p1.4.m4.1.1.2">𝑠</ci><cn id="S3.SS3.p1.4.m4.1.1.3.cmml" type="integer" xref="S3.SS3.p1.4.m4.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.4.m4.1c">s_{0}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.4.m4.1d">italic_s start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math> that Alice started in.
Both agents are trained with RL.
On the one hand, Bob is rewarded for achieving the proposed goals.
On the other hand, to encourage the discovery of challenging and novel goals, Alice is rewarded for proposing goals that Bob is unable to achieve.
To prevent Alice from generating goals that are too complex for Bob to achieve, a penalty reward can also be given to Alice for proposing undesirable goals.
This penalty over goals can be hand-crafted to introduce a prior on the types of goals Alice must propose.
Moreover, Bob can always learn from Alice’s trajectory to go from <math alttext="s_{0}" class="ltx_Math" display="inline" id="S3.SS3.p1.5.m5.1"><semantics id="S3.SS3.p1.5.m5.1a"><msub id="S3.SS3.p1.5.m5.1.1" xref="S3.SS3.p1.5.m5.1.1.cmml"><mi id="S3.SS3.p1.5.m5.1.1.2" xref="S3.SS3.p1.5.m5.1.1.2.cmml">s</mi><mn id="S3.SS3.p1.5.m5.1.1.3" xref="S3.SS3.p1.5.m5.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.5.m5.1b"><apply id="S3.SS3.p1.5.m5.1.1.cmml" xref="S3.SS3.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.5.m5.1.1.1.cmml" xref="S3.SS3.p1.5.m5.1.1">subscript</csymbol><ci id="S3.SS3.p1.5.m5.1.1.2.cmml" xref="S3.SS3.p1.5.m5.1.1.2">𝑠</ci><cn id="S3.SS3.p1.5.m5.1.1.3.cmml" type="integer" xref="S3.SS3.p1.5.m5.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.5.m5.1c">s_{0}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.5.m5.1d">italic_s start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math> to <math alttext="s_{g}" class="ltx_Math" display="inline" id="S3.SS3.p1.6.m6.1"><semantics id="S3.SS3.p1.6.m6.1a"><msub id="S3.SS3.p1.6.m6.1.1" xref="S3.SS3.p1.6.m6.1.1.cmml"><mi id="S3.SS3.p1.6.m6.1.1.2" xref="S3.SS3.p1.6.m6.1.1.2.cmml">s</mi><mi id="S3.SS3.p1.6.m6.1.1.3" xref="S3.SS3.p1.6.m6.1.1.3.cmml">g</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.6.m6.1b"><apply id="S3.SS3.p1.6.m6.1.1.cmml" xref="S3.SS3.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.6.m6.1.1.1.cmml" xref="S3.SS3.p1.6.m6.1.1">subscript</csymbol><ci id="S3.SS3.p1.6.m6.1.1.2.cmml" xref="S3.SS3.p1.6.m6.1.1.2">𝑠</ci><ci id="S3.SS3.p1.6.m6.1.1.3.cmml" xref="S3.SS3.p1.6.m6.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.6.m6.1c">s_{g}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.6.m6.1d">italic_s start_POSTSUBSCRIPT italic_g end_POSTSUBSCRIPT</annotation></semantics></math> and hence Bob always gets a positive learning signal even in cases of failure.
This adversarial reward structure yields a curriculum for Bob to learn from an increasingly difficult set of tasks.
We encourage the reader to refer to <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04855v1#bib.bib19" title="">19</a>]</cite> for a more detailed description of ASP.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">IV </span><span class="ltx_text ltx_font_smallcaps" id="S4.1.1">Method</span>
</h2>
<div class="ltx_para" id="S4.p1">
<p class="ltx_p" id="S4.p1.1">We propose discovering diverse and composable primitives by pre-training an MCP to solve a large set of tasks generated through Asymmetry Self-Play.
This pre-training results in a collection of primitives that capture a range of useful behaviors explicitly learned to be composable in a manipulation setting.
The discovered behaviors can then be orchestrated to solve various (unseen) tasks in the environment using HRL.
We present an overview of our method in Figure <span class="ltx_ref ltx_missing_label ltx_ref_self">LABEL:fig:method</span>.</p>
</div>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S4.SS1.4.1.1">IV-A</span> </span><span class="ltx_text ltx_font_italic" id="S4.SS1.5.2">Discovering Behaviors through Tasks Diversity</span>
</h3>
<div class="ltx_para" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.1">The core of our method is the pre-training part.
It requires a task <span class="ltx_text ltx_font_italic" id="S4.SS1.p1.1.1">generator</span> and a task <span class="ltx_text ltx_font_italic" id="S4.SS1.p1.1.2">solver</span>.
The role of the <span class="ltx_text ltx_font_italic" id="S4.SS1.p1.1.3">generator</span> is to propose tasks that the <span class="ltx_text ltx_font_italic" id="S4.SS1.p1.1.4">solver</span> must solve.
Our method relies on the hypothesis that if the set of tasks proposed by the <span class="ltx_text ltx_font_italic" id="S4.SS1.p1.1.5">generator</span> is large, diverse, and complex, then it induces the discovery of diverse and complex behaviors by the <span class="ltx_text ltx_font_italic" id="S4.SS1.p1.1.6">solver</span>.
While this idea is compatible with any automatic task generation framework that learns both a <span class="ltx_text ltx_font_italic" id="S4.SS1.p1.1.7">generator</span> and a <span class="ltx_text ltx_font_italic" id="S4.SS1.p1.1.8">solver</span>, we use Asymmetric Self-Play to discover a complex distribution of tasks.</p>
</div>
<div class="ltx_para" id="S4.SS1.p2">
<p class="ltx_p" id="S4.SS1.p2.1">We choose ASP for two main reasons.
Firstly, ASP is one of the few approaches that was shown to generate a diversity of complex tasks in a robotic manipulation setting <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04855v1#bib.bib19" title="">19</a>]</cite>.
This consequence of the adversarial structure of ASP incites the <span class="ltx_text ltx_font_italic" id="S4.SS1.p2.1.1">generator</span>, Alice, to seek novel and complex goals.
Secondly, due to the structure of ASP, the tasks proposed by the <span class="ltx_text ltx_font_italic" id="S4.SS1.p2.1.2">generator</span> are guaranteed to be feasible by the <span class="ltx_text ltx_font_italic" id="S4.SS1.p2.1.3">solver</span>, Bob.
More importantly, each proposed task comes with a successful demonstration, which can be used to train the <span class="ltx_text ltx_font_italic" id="S4.SS1.p2.1.4">solver</span>, when it cannot succeed independently.
It is called Alice Behavioral Cloning (ABC).
It is of major importance in robotic manipulation to encourage proper interactions with objects.
Hence, we use it during pre-training.</p>
</div>
<div class="ltx_para" id="S4.SS1.p3">
<p class="ltx_p" id="S4.SS1.p3.1">Once the automatic task generation process terminates, i.e. when the <span class="ltx_text ltx_font_italic" id="S4.SS1.p3.1.1">generator</span> does not propose novel tasks anymore and the <span class="ltx_text ltx_font_italic" id="S4.SS1.p3.1.2">solver</span> can solve all proposed tasks, we keep the <span class="ltx_text ltx_font_italic" id="S4.SS1.p3.1.3">solver</span> for reuse with HRL on unseen downstream tasks.
We hypothesize that, as the <span class="ltx_text ltx_font_italic" id="S4.SS1.p3.1.4">solver</span> is exposed to a large variety of tasks, its policy embeds a diversity of behaviors necessary to solve all seen tasks.
We claim that these behaviors can be reused.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S4.SS2.4.1.1">IV-B</span> </span><span class="ltx_text ltx_font_italic" id="S4.SS2.5.2">Embedding Behaviors in Composable Primitives</span>
</h3>
<div class="ltx_para" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.1">We learn the <span class="ltx_text ltx_font_italic" id="S4.SS2.p1.1.1">solver</span> as a Multiplicative Compositional Policy to embed the whole range of discovered behaviors in primitives.
We parameterize the MCP with neural networks.
During pre-training, primitives learn to embed the discovered behaviors in their parameters while the orchestrator learns to compose the primitives to solve the proposed tasks.
Learning the solver’s policy as a monolithic policy limits the range of options for downstream tasks.</p>
</div>
<div class="ltx_para" id="S4.SS2.p2">
<p class="ltx_p" id="S4.SS2.p2.1">Firstly, reusing a monolithic policy limits the range of downstream tasks to tasks with the same input space as in the pre-training phase.
For instance, if downstream tasks require input information that is not part of the input space of the <span class="ltx_text ltx_font_italic" id="S4.SS2.p2.1.1">solver</span> during pre-training, then the skills acquired during pre-training cannot be leveraged on downstream tasks.
MCPs address this problem by separately learning an orchestrator and a set of primitives.
Since the primitives only depend on the state <math alttext="s" class="ltx_Math" display="inline" id="S4.SS2.p2.1.m1.1"><semantics id="S4.SS2.p2.1.m1.1a"><mi id="S4.SS2.p2.1.m1.1.1" xref="S4.SS2.p2.1.m1.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.1.m1.1b"><ci id="S4.SS2.p2.1.m1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.1.m1.1c">s</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.1.m1.1d">italic_s</annotation></semantics></math> and hence not on task-agnostic information, they can be transferred to any task, e.g., with different goal spaces.
The orchestrator can be learned while benefiting from the knowledge embedded in primitives.</p>
</div>
<div class="ltx_para" id="S4.SS2.p3">
<p class="ltx_p" id="S4.SS2.p3.1">Secondly, reusing a monolithic policy on downstream tasks can require fine-tuning.
It occurs when there is a significant shift between the pre-training and downstream task distributions or in the environment dynamics.
While fine-tuning can increase performance on some tasks, it can also induce catastrophic forgetting of the behaviors learned during pre-training.
A benefit of MCPs is that task-agnostic behaviors are embedded in individual primitives, which can be frozen after pre-training to prevent catastrophic forgetting.
The frozen primitives can then be composed to yield behaviors robust to changes in environment dynamics and task distribution shifts.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S4.SS3.4.1.1">IV-C</span> </span><span class="ltx_text ltx_font_italic" id="S4.SS3.5.2">Composing Primitives to Solve Downstream Tasks</span>
</h3>
<div class="ltx_para" id="S4.SS3.p1">
<p class="ltx_p" id="S4.SS3.p1.1">We hypothesize that if primitives can be composed to solve a sufficiently diverse set of tasks during pre-training, these primitives can then be repurposed in novel downstream tasks.
The primitives of the <span class="ltx_text ltx_font_italic" id="S4.SS3.p1.1.1">solver</span> are indeed pre-trained along with an orchestrator to solve the diverse tasks proposed by the <span class="ltx_text ltx_font_italic" id="S4.SS3.p1.1.2">generator</span>.
We hence have a guarantee that the primitives are effective and composable to solve all the tasks proposed by the <span class="ltx_text ltx_font_italic" id="S4.SS3.p1.1.3">generator</span>.
We hypothesize that since tasks proposed in the pre-training are diverse and complex, the primitives are general enough to serve a useful role in new tasks in the same environment.
We argue that a composition of diverse behaviors can adapt to various changes in the environment and facilitate learning new tasks.</p>
</div>
<div class="ltx_para" id="S4.SS3.p2">
<p class="ltx_p" id="S4.SS3.p2.1">This paper investigates the reusability of the learned primitives by an orchestrator trained from scratch.
For each downstream task, an orchestrator is trained from scratch to compose the pre-trained primitives.
To show how general and adaptable the learned primitives are, the very same set of pre-trained primitives is used on all downstream tasks, with frozen parameters.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">V </span><span class="ltx_text ltx_font_smallcaps" id="S5.1.1">Experimental Setup</span>
</h2>
<section class="ltx_subsection" id="S5.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S5.SS1.4.1.1">V-A</span> </span><span class="ltx_text ltx_font_italic" id="S5.SS1.5.2">Tasks</span>
</h3>
<figure class="ltx_figure" id="S5.F2">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_many">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S5.F2.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="395" id="S5.F2.sf1.g1" src="extracted/5906562/figures/example_downstream/larger0.png" width="592"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S5.F2.sf1.3.1.1" style="font-size:90%;">(a)</span> </span><span class="ltx_text ltx_font_italic" id="S5.F2.sf1.4.2" style="font-size:90%;">Larger</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S5.F2.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="395" id="S5.F2.sf2.g1" src="extracted/5906562/figures/example_downstream/in_air0.png" width="592"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S5.F2.sf2.3.1.1" style="font-size:90%;">(b)</span> </span><span class="ltx_text ltx_font_italic" id="S5.F2.sf2.4.2" style="font-size:90%;">In Air</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S5.F2.sf3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="395" id="S5.F2.sf3.g1" src="extracted/5906562/figures/example_downstream/push0.png" width="592"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S5.F2.sf3.3.1.1" style="font-size:90%;">(c)</span> </span><span class="ltx_text ltx_font_italic" id="S5.F2.sf3.4.2" style="font-size:90%;">Push</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S5.F2.sf4"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="395" id="S5.F2.sf4.g1" src="extracted/5906562/figures/example_downstream/sphere0.png" width="592"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S5.F2.sf4.3.1.1" style="font-size:90%;">(d)</span> </span><span class="ltx_text ltx_font_italic" id="S5.F2.sf4.4.2" style="font-size:90%;">Sphere</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S5.F2.sf5"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="395" id="S5.F2.sf5.g1" src="extracted/5906562/figures/example_downstream/box0.png" width="592"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S5.F2.sf5.3.1.1" style="font-size:90%;">(e)</span> </span><span class="ltx_text ltx_font_italic" id="S5.F2.sf5.4.2" style="font-size:90%;">Box</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S5.F2.sf6"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="395" id="S5.F2.sf6.g1" src="extracted/5906562/figures/example_downstream/wall2.png" width="592"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S5.F2.sf6.3.1.1" style="font-size:90%;">(f)</span> </span><span class="ltx_text ltx_font_italic" id="S5.F2.sf6.4.2" style="font-size:90%;">Wall</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S5.F2.3.1.1" style="font-size:90%;">Figure 2</span>: </span><span class="ltx_text ltx_font_bold" id="S5.F2.4.2" style="font-size:90%;">Downstream Tasks<span class="ltx_text ltx_font_medium" id="S5.F2.4.2.1">:
The robot must move the solid red cube to a target position represented as a transparent red cube.
The orange zone represents where the initial position of the cube can be sampled, while the green zone represents where the target position of the cube can be sampled.
</span></span></figcaption>
</figure>
<div class="ltx_para" id="S5.SS1.p1">
<p class="ltx_p" id="S5.SS1.p1.1">We apply our method in a customized version of <span class="ltx_text ltx_font_typewriter" id="S5.SS1.p1.1.1">panda-gym</span> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04855v1#bib.bib45" title="">45</a>]</cite> for pre-training and downstream task training.
The environment consists of a robotic arm placed in a table-top setting where an object can be manipulated.
Similar environments are commonly used to evaluate Skill Learning methods for Robotic Manipulation <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04855v1#bib.bib13" title="">13</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04855v1#bib.bib14" title="">14</a>]</cite>.
We use a Franka Emika Panda with a parallel gripper in all experiments.
We focus on diverse manipulation tasks involving a single rigid object.
Pre-training and downstream training are done in simulation only but we evaluate the transferability of our primitives to a real robotic platform on two downstream tasks.
The action space corresponds to the displacement of the gripper and its finger.
The state space is composed of the state of the robot and of the object.
The reward function is a sparse success-based reward.
The tasks consist of moving an object to a goal position.
The task is considered solved when the object has achieved its target position.
We consider an object has achieved its goal position if it is within a distance <math alttext="d_{\text{threshold}}=5" class="ltx_Math" display="inline" id="S5.SS1.p1.1.m1.1"><semantics id="S5.SS1.p1.1.m1.1a"><mrow id="S5.SS1.p1.1.m1.1.1" xref="S5.SS1.p1.1.m1.1.1.cmml"><msub id="S5.SS1.p1.1.m1.1.1.2" xref="S5.SS1.p1.1.m1.1.1.2.cmml"><mi id="S5.SS1.p1.1.m1.1.1.2.2" xref="S5.SS1.p1.1.m1.1.1.2.2.cmml">d</mi><mtext id="S5.SS1.p1.1.m1.1.1.2.3" xref="S5.SS1.p1.1.m1.1.1.2.3a.cmml">threshold</mtext></msub><mo id="S5.SS1.p1.1.m1.1.1.1" xref="S5.SS1.p1.1.m1.1.1.1.cmml">=</mo><mn id="S5.SS1.p1.1.m1.1.1.3" xref="S5.SS1.p1.1.m1.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.1.m1.1b"><apply id="S5.SS1.p1.1.m1.1.1.cmml" xref="S5.SS1.p1.1.m1.1.1"><eq id="S5.SS1.p1.1.m1.1.1.1.cmml" xref="S5.SS1.p1.1.m1.1.1.1"></eq><apply id="S5.SS1.p1.1.m1.1.1.2.cmml" xref="S5.SS1.p1.1.m1.1.1.2"><csymbol cd="ambiguous" id="S5.SS1.p1.1.m1.1.1.2.1.cmml" xref="S5.SS1.p1.1.m1.1.1.2">subscript</csymbol><ci id="S5.SS1.p1.1.m1.1.1.2.2.cmml" xref="S5.SS1.p1.1.m1.1.1.2.2">𝑑</ci><ci id="S5.SS1.p1.1.m1.1.1.2.3a.cmml" xref="S5.SS1.p1.1.m1.1.1.2.3"><mtext id="S5.SS1.p1.1.m1.1.1.2.3.cmml" mathsize="70%" xref="S5.SS1.p1.1.m1.1.1.2.3">threshold</mtext></ci></apply><cn id="S5.SS1.p1.1.m1.1.1.3.cmml" type="integer" xref="S5.SS1.p1.1.m1.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.1.m1.1c">d_{\text{threshold}}=5</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p1.1.m1.1d">italic_d start_POSTSUBSCRIPT threshold end_POSTSUBSCRIPT = 5</annotation></semantics></math> cm from it.
While <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04855v1#bib.bib19" title="">19</a>]</cite> showed that ASP could be extended to tasks involving both the position and orientation of objects, we limit our study to position only as it is enough to show the benefits of our method.</p>
</div>
<div class="ltx_para" id="S5.SS1.p2">
<p class="ltx_p" id="S5.SS1.p2.2">During pre-training, Alice and Bob manipulate a <math alttext="5" class="ltx_Math" display="inline" id="S5.SS1.p2.1.m1.1"><semantics id="S5.SS1.p2.1.m1.1a"><mn id="S5.SS1.p2.1.m1.1.1" xref="S5.SS1.p2.1.m1.1.1.cmml">5</mn><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.1.m1.1b"><cn id="S5.SS1.p2.1.m1.1.1.cmml" type="integer" xref="S5.SS1.p2.1.m1.1.1">5</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.1.m1.1c">5</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p2.1.m1.1d">5</annotation></semantics></math> cm cube.
Alice proposes goals in the workspace and is penalized otherwise.
We define the workspace as a volume of dimensions <math alttext="35\times 35\times 35" class="ltx_Math" display="inline" id="S5.SS1.p2.2.m2.1"><semantics id="S5.SS1.p2.2.m2.1a"><mrow id="S5.SS1.p2.2.m2.1.1" xref="S5.SS1.p2.2.m2.1.1.cmml"><mn id="S5.SS1.p2.2.m2.1.1.2" xref="S5.SS1.p2.2.m2.1.1.2.cmml">35</mn><mo id="S5.SS1.p2.2.m2.1.1.1" lspace="0.222em" rspace="0.222em" xref="S5.SS1.p2.2.m2.1.1.1.cmml">×</mo><mn id="S5.SS1.p2.2.m2.1.1.3" xref="S5.SS1.p2.2.m2.1.1.3.cmml">35</mn><mo id="S5.SS1.p2.2.m2.1.1.1a" lspace="0.222em" rspace="0.222em" xref="S5.SS1.p2.2.m2.1.1.1.cmml">×</mo><mn id="S5.SS1.p2.2.m2.1.1.4" xref="S5.SS1.p2.2.m2.1.1.4.cmml">35</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.2.m2.1b"><apply id="S5.SS1.p2.2.m2.1.1.cmml" xref="S5.SS1.p2.2.m2.1.1"><times id="S5.SS1.p2.2.m2.1.1.1.cmml" xref="S5.SS1.p2.2.m2.1.1.1"></times><cn id="S5.SS1.p2.2.m2.1.1.2.cmml" type="integer" xref="S5.SS1.p2.2.m2.1.1.2">35</cn><cn id="S5.SS1.p2.2.m2.1.1.3.cmml" type="integer" xref="S5.SS1.p2.2.m2.1.1.3">35</cn><cn id="S5.SS1.p2.2.m2.1.1.4.cmml" type="integer" xref="S5.SS1.p2.2.m2.1.1.4">35</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.2.m2.1c">35\times 35\times 35</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p2.2.m2.1d">35 × 35 × 35</annotation></semantics></math> cm, on the table.
The initial object position is uniformly sampled in the workspace on the table.</p>
</div>
<div class="ltx_para" id="S5.SS1.p3">
<p class="ltx_p" id="S5.SS1.p3.12">Downstream tasks are variations of pick-and-place tasks.
We use the same workspace as in pre-training and sample initial object position similarly.
Goal positions are uniformly sampled anywhere in the workspace with a probability <math alttext="p" class="ltx_Math" display="inline" id="S5.SS1.p3.1.m1.1"><semantics id="S5.SS1.p3.1.m1.1a"><mi id="S5.SS1.p3.1.m1.1.1" xref="S5.SS1.p3.1.m1.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p3.1.m1.1b"><ci id="S5.SS1.p3.1.m1.1.1.cmml" xref="S5.SS1.p3.1.m1.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p3.1.m1.1c">p</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p3.1.m1.1d">italic_p</annotation></semantics></math> and otherwise on the table.
The manipulated object is a cube of size <math alttext="5" class="ltx_Math" display="inline" id="S5.SS1.p3.2.m2.1"><semantics id="S5.SS1.p3.2.m2.1a"><mn id="S5.SS1.p3.2.m2.1.1" xref="S5.SS1.p3.2.m2.1.1.cmml">5</mn><annotation-xml encoding="MathML-Content" id="S5.SS1.p3.2.m2.1b"><cn id="S5.SS1.p3.2.m2.1.1.cmml" type="integer" xref="S5.SS1.p3.2.m2.1.1">5</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p3.2.m2.1c">5</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p3.2.m2.1d">5</annotation></semantics></math> cm unless specified otherwise.
Each downstream task perturbs the dynamics of the environment or the task distribution w.r.t. to pre-training to evaluate how a composition of pre-trained primitives can adapt.
In <span class="ltx_text ltx_font_italic" id="S5.SS1.p3.12.1">Larger</span>, the area where initial and target object positions are sampled is of size <math alttext="45\times 45\times 40" class="ltx_Math" display="inline" id="S5.SS1.p3.3.m3.1"><semantics id="S5.SS1.p3.3.m3.1a"><mrow id="S5.SS1.p3.3.m3.1.1" xref="S5.SS1.p3.3.m3.1.1.cmml"><mn id="S5.SS1.p3.3.m3.1.1.2" xref="S5.SS1.p3.3.m3.1.1.2.cmml">45</mn><mo id="S5.SS1.p3.3.m3.1.1.1" lspace="0.222em" rspace="0.222em" xref="S5.SS1.p3.3.m3.1.1.1.cmml">×</mo><mn id="S5.SS1.p3.3.m3.1.1.3" xref="S5.SS1.p3.3.m3.1.1.3.cmml">45</mn><mo id="S5.SS1.p3.3.m3.1.1.1a" lspace="0.222em" rspace="0.222em" xref="S5.SS1.p3.3.m3.1.1.1.cmml">×</mo><mn id="S5.SS1.p3.3.m3.1.1.4" xref="S5.SS1.p3.3.m3.1.1.4.cmml">40</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p3.3.m3.1b"><apply id="S5.SS1.p3.3.m3.1.1.cmml" xref="S5.SS1.p3.3.m3.1.1"><times id="S5.SS1.p3.3.m3.1.1.1.cmml" xref="S5.SS1.p3.3.m3.1.1.1"></times><cn id="S5.SS1.p3.3.m3.1.1.2.cmml" type="integer" xref="S5.SS1.p3.3.m3.1.1.2">45</cn><cn id="S5.SS1.p3.3.m3.1.1.3.cmml" type="integer" xref="S5.SS1.p3.3.m3.1.1.3">45</cn><cn id="S5.SS1.p3.3.m3.1.1.4.cmml" type="integer" xref="S5.SS1.p3.3.m3.1.1.4">40</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p3.3.m3.1c">45\times 45\times 40</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p3.3.m3.1d">45 × 45 × 40</annotation></semantics></math> cm and <math alttext="p=0.7" class="ltx_Math" display="inline" id="S5.SS1.p3.4.m4.1"><semantics id="S5.SS1.p3.4.m4.1a"><mrow id="S5.SS1.p3.4.m4.1.1" xref="S5.SS1.p3.4.m4.1.1.cmml"><mi id="S5.SS1.p3.4.m4.1.1.2" xref="S5.SS1.p3.4.m4.1.1.2.cmml">p</mi><mo id="S5.SS1.p3.4.m4.1.1.1" xref="S5.SS1.p3.4.m4.1.1.1.cmml">=</mo><mn id="S5.SS1.p3.4.m4.1.1.3" xref="S5.SS1.p3.4.m4.1.1.3.cmml">0.7</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p3.4.m4.1b"><apply id="S5.SS1.p3.4.m4.1.1.cmml" xref="S5.SS1.p3.4.m4.1.1"><eq id="S5.SS1.p3.4.m4.1.1.1.cmml" xref="S5.SS1.p3.4.m4.1.1.1"></eq><ci id="S5.SS1.p3.4.m4.1.1.2.cmml" xref="S5.SS1.p3.4.m4.1.1.2">𝑝</ci><cn id="S5.SS1.p3.4.m4.1.1.3.cmml" type="float" xref="S5.SS1.p3.4.m4.1.1.3">0.7</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p3.4.m4.1c">p=0.7</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p3.4.m4.1d">italic_p = 0.7</annotation></semantics></math>.
In <span class="ltx_text ltx_font_italic" id="S5.SS1.p3.12.2">In Air</span>, target positions are always sampled in the air, i.e. <math alttext="p=1.0" class="ltx_Math" display="inline" id="S5.SS1.p3.5.m5.1"><semantics id="S5.SS1.p3.5.m5.1a"><mrow id="S5.SS1.p3.5.m5.1.1" xref="S5.SS1.p3.5.m5.1.1.cmml"><mi id="S5.SS1.p3.5.m5.1.1.2" xref="S5.SS1.p3.5.m5.1.1.2.cmml">p</mi><mo id="S5.SS1.p3.5.m5.1.1.1" xref="S5.SS1.p3.5.m5.1.1.1.cmml">=</mo><mn id="S5.SS1.p3.5.m5.1.1.3" xref="S5.SS1.p3.5.m5.1.1.3.cmml">1.0</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p3.5.m5.1b"><apply id="S5.SS1.p3.5.m5.1.1.cmml" xref="S5.SS1.p3.5.m5.1.1"><eq id="S5.SS1.p3.5.m5.1.1.1.cmml" xref="S5.SS1.p3.5.m5.1.1.1"></eq><ci id="S5.SS1.p3.5.m5.1.1.2.cmml" xref="S5.SS1.p3.5.m5.1.1.2">𝑝</ci><cn id="S5.SS1.p3.5.m5.1.1.3.cmml" type="float" xref="S5.SS1.p3.5.m5.1.1.3">1.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p3.5.m5.1c">p=1.0</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p3.5.m5.1d">italic_p = 1.0</annotation></semantics></math>,
For <span class="ltx_text ltx_font_italic" id="S5.SS1.p3.12.3">Push</span>, the gripper is blocked in a closed position, and targets are always on the table, i.e., <math alttext="p=0.0" class="ltx_Math" display="inline" id="S5.SS1.p3.6.m6.1"><semantics id="S5.SS1.p3.6.m6.1a"><mrow id="S5.SS1.p3.6.m6.1.1" xref="S5.SS1.p3.6.m6.1.1.cmml"><mi id="S5.SS1.p3.6.m6.1.1.2" xref="S5.SS1.p3.6.m6.1.1.2.cmml">p</mi><mo id="S5.SS1.p3.6.m6.1.1.1" xref="S5.SS1.p3.6.m6.1.1.1.cmml">=</mo><mn id="S5.SS1.p3.6.m6.1.1.3" xref="S5.SS1.p3.6.m6.1.1.3.cmml">0.0</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p3.6.m6.1b"><apply id="S5.SS1.p3.6.m6.1.1.cmml" xref="S5.SS1.p3.6.m6.1.1"><eq id="S5.SS1.p3.6.m6.1.1.1.cmml" xref="S5.SS1.p3.6.m6.1.1.1"></eq><ci id="S5.SS1.p3.6.m6.1.1.2.cmml" xref="S5.SS1.p3.6.m6.1.1.2">𝑝</ci><cn id="S5.SS1.p3.6.m6.1.1.3.cmml" type="float" xref="S5.SS1.p3.6.m6.1.1.3">0.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p3.6.m6.1c">p=0.0</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p3.6.m6.1d">italic_p = 0.0</annotation></semantics></math>,
In Sphere <span class="ltx_text ltx_font_italic" id="S5.SS1.p3.12.4">Sphere</span>, the object is a sphere of diameter <math alttext="D=5" class="ltx_Math" display="inline" id="S5.SS1.p3.7.m7.1"><semantics id="S5.SS1.p3.7.m7.1a"><mrow id="S5.SS1.p3.7.m7.1.1" xref="S5.SS1.p3.7.m7.1.1.cmml"><mi id="S5.SS1.p3.7.m7.1.1.2" xref="S5.SS1.p3.7.m7.1.1.2.cmml">D</mi><mo id="S5.SS1.p3.7.m7.1.1.1" xref="S5.SS1.p3.7.m7.1.1.1.cmml">=</mo><mn id="S5.SS1.p3.7.m7.1.1.3" xref="S5.SS1.p3.7.m7.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p3.7.m7.1b"><apply id="S5.SS1.p3.7.m7.1.1.cmml" xref="S5.SS1.p3.7.m7.1.1"><eq id="S5.SS1.p3.7.m7.1.1.1.cmml" xref="S5.SS1.p3.7.m7.1.1.1"></eq><ci id="S5.SS1.p3.7.m7.1.1.2.cmml" xref="S5.SS1.p3.7.m7.1.1.2">𝐷</ci><cn id="S5.SS1.p3.7.m7.1.1.3.cmml" type="integer" xref="S5.SS1.p3.7.m7.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p3.7.m7.1c">D=5</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p3.7.m7.1d">italic_D = 5</annotation></semantics></math> cm and <math alttext="p=0.7" class="ltx_Math" display="inline" id="S5.SS1.p3.8.m8.1"><semantics id="S5.SS1.p3.8.m8.1a"><mrow id="S5.SS1.p3.8.m8.1.1" xref="S5.SS1.p3.8.m8.1.1.cmml"><mi id="S5.SS1.p3.8.m8.1.1.2" xref="S5.SS1.p3.8.m8.1.1.2.cmml">p</mi><mo id="S5.SS1.p3.8.m8.1.1.1" xref="S5.SS1.p3.8.m8.1.1.1.cmml">=</mo><mn id="S5.SS1.p3.8.m8.1.1.3" xref="S5.SS1.p3.8.m8.1.1.3.cmml">0.7</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p3.8.m8.1b"><apply id="S5.SS1.p3.8.m8.1.1.cmml" xref="S5.SS1.p3.8.m8.1.1"><eq id="S5.SS1.p3.8.m8.1.1.1.cmml" xref="S5.SS1.p3.8.m8.1.1.1"></eq><ci id="S5.SS1.p3.8.m8.1.1.2.cmml" xref="S5.SS1.p3.8.m8.1.1.2">𝑝</ci><cn id="S5.SS1.p3.8.m8.1.1.3.cmml" type="float" xref="S5.SS1.p3.8.m8.1.1.3">0.7</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p3.8.m8.1c">p=0.7</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p3.8.m8.1d">italic_p = 0.7</annotation></semantics></math>,
For <span class="ltx_text ltx_font_italic" id="S5.SS1.p3.12.5">Wall</span>, the initial and target object positions are sampled from disjoint areas of size <math alttext="15\times 35\times 0" class="ltx_Math" display="inline" id="S5.SS1.p3.9.m9.1"><semantics id="S5.SS1.p3.9.m9.1a"><mrow id="S5.SS1.p3.9.m9.1.1" xref="S5.SS1.p3.9.m9.1.1.cmml"><mn id="S5.SS1.p3.9.m9.1.1.2" xref="S5.SS1.p3.9.m9.1.1.2.cmml">15</mn><mo id="S5.SS1.p3.9.m9.1.1.1" lspace="0.222em" rspace="0.222em" xref="S5.SS1.p3.9.m9.1.1.1.cmml">×</mo><mn id="S5.SS1.p3.9.m9.1.1.3" xref="S5.SS1.p3.9.m9.1.1.3.cmml">35</mn><mo id="S5.SS1.p3.9.m9.1.1.1a" lspace="0.222em" rspace="0.222em" xref="S5.SS1.p3.9.m9.1.1.1.cmml">×</mo><mn id="S5.SS1.p3.9.m9.1.1.4" xref="S5.SS1.p3.9.m9.1.1.4.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p3.9.m9.1b"><apply id="S5.SS1.p3.9.m9.1.1.cmml" xref="S5.SS1.p3.9.m9.1.1"><times id="S5.SS1.p3.9.m9.1.1.1.cmml" xref="S5.SS1.p3.9.m9.1.1.1"></times><cn id="S5.SS1.p3.9.m9.1.1.2.cmml" type="integer" xref="S5.SS1.p3.9.m9.1.1.2">15</cn><cn id="S5.SS1.p3.9.m9.1.1.3.cmml" type="integer" xref="S5.SS1.p3.9.m9.1.1.3">35</cn><cn id="S5.SS1.p3.9.m9.1.1.4.cmml" type="integer" xref="S5.SS1.p3.9.m9.1.1.4">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p3.9.m9.1c">15\times 35\times 0</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p3.9.m9.1d">15 × 35 × 0</annotation></semantics></math> cm separated by a fixed wall, and targets are always on the table, i.e. <math alttext="p=0.7" class="ltx_Math" display="inline" id="S5.SS1.p3.10.m10.1"><semantics id="S5.SS1.p3.10.m10.1a"><mrow id="S5.SS1.p3.10.m10.1.1" xref="S5.SS1.p3.10.m10.1.1.cmml"><mi id="S5.SS1.p3.10.m10.1.1.2" xref="S5.SS1.p3.10.m10.1.1.2.cmml">p</mi><mo id="S5.SS1.p3.10.m10.1.1.1" xref="S5.SS1.p3.10.m10.1.1.1.cmml">=</mo><mn id="S5.SS1.p3.10.m10.1.1.3" xref="S5.SS1.p3.10.m10.1.1.3.cmml">0.7</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p3.10.m10.1b"><apply id="S5.SS1.p3.10.m10.1.1.cmml" xref="S5.SS1.p3.10.m10.1.1"><eq id="S5.SS1.p3.10.m10.1.1.1.cmml" xref="S5.SS1.p3.10.m10.1.1.1"></eq><ci id="S5.SS1.p3.10.m10.1.1.2.cmml" xref="S5.SS1.p3.10.m10.1.1.2">𝑝</ci><cn id="S5.SS1.p3.10.m10.1.1.3.cmml" type="float" xref="S5.SS1.p3.10.m10.1.1.3">0.7</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p3.10.m10.1c">p=0.7</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p3.10.m10.1d">italic_p = 0.7</annotation></semantics></math>,
In <span class="ltx_text ltx_font_italic" id="S5.SS1.p3.12.6">Box</span>, a rigid open box of size <math alttext="10\times 10\times 5" class="ltx_Math" display="inline" id="S5.SS1.p3.11.m11.1"><semantics id="S5.SS1.p3.11.m11.1a"><mrow id="S5.SS1.p3.11.m11.1.1" xref="S5.SS1.p3.11.m11.1.1.cmml"><mn id="S5.SS1.p3.11.m11.1.1.2" xref="S5.SS1.p3.11.m11.1.1.2.cmml">10</mn><mo id="S5.SS1.p3.11.m11.1.1.1" lspace="0.222em" rspace="0.222em" xref="S5.SS1.p3.11.m11.1.1.1.cmml">×</mo><mn id="S5.SS1.p3.11.m11.1.1.3" xref="S5.SS1.p3.11.m11.1.1.3.cmml">10</mn><mo id="S5.SS1.p3.11.m11.1.1.1a" lspace="0.222em" rspace="0.222em" xref="S5.SS1.p3.11.m11.1.1.1.cmml">×</mo><mn id="S5.SS1.p3.11.m11.1.1.4" xref="S5.SS1.p3.11.m11.1.1.4.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p3.11.m11.1b"><apply id="S5.SS1.p3.11.m11.1.1.cmml" xref="S5.SS1.p3.11.m11.1.1"><times id="S5.SS1.p3.11.m11.1.1.1.cmml" xref="S5.SS1.p3.11.m11.1.1.1"></times><cn id="S5.SS1.p3.11.m11.1.1.2.cmml" type="integer" xref="S5.SS1.p3.11.m11.1.1.2">10</cn><cn id="S5.SS1.p3.11.m11.1.1.3.cmml" type="integer" xref="S5.SS1.p3.11.m11.1.1.3">10</cn><cn id="S5.SS1.p3.11.m11.1.1.4.cmml" type="integer" xref="S5.SS1.p3.11.m11.1.1.4">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p3.11.m11.1c">10\times 10\times 5</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p3.11.m11.1d">10 × 10 × 5</annotation></semantics></math> cm is welded at a random position to the table, and the goal is inside the box (<math alttext="p=0.0" class="ltx_Math" display="inline" id="S5.SS1.p3.12.m12.1"><semantics id="S5.SS1.p3.12.m12.1a"><mrow id="S5.SS1.p3.12.m12.1.1" xref="S5.SS1.p3.12.m12.1.1.cmml"><mi id="S5.SS1.p3.12.m12.1.1.2" xref="S5.SS1.p3.12.m12.1.1.2.cmml">p</mi><mo id="S5.SS1.p3.12.m12.1.1.1" xref="S5.SS1.p3.12.m12.1.1.1.cmml">=</mo><mn id="S5.SS1.p3.12.m12.1.1.3" xref="S5.SS1.p3.12.m12.1.1.3.cmml">0.0</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p3.12.m12.1b"><apply id="S5.SS1.p3.12.m12.1.1.cmml" xref="S5.SS1.p3.12.m12.1.1"><eq id="S5.SS1.p3.12.m12.1.1.1.cmml" xref="S5.SS1.p3.12.m12.1.1.1"></eq><ci id="S5.SS1.p3.12.m12.1.1.2.cmml" xref="S5.SS1.p3.12.m12.1.1.2">𝑝</ci><cn id="S5.SS1.p3.12.m12.1.1.3.cmml" type="float" xref="S5.SS1.p3.12.m12.1.1.3">0.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p3.12.m12.1c">p=0.0</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p3.12.m12.1d">italic_p = 0.0</annotation></semantics></math>).</p>
</div>
</section>
<section class="ltx_subsection" id="S5.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S5.SS2.4.1.1">V-B</span> </span><span class="ltx_text ltx_font_italic" id="S5.SS2.5.2">Baselines</span>
</h3>
<div class="ltx_para" id="S5.SS2.p1">
<p class="ltx_p" id="S5.SS2.p1.3">We compare our approach to the following baselines:
(a) LSD <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04855v1#bib.bib13" title="">13</a>]</cite> with object position prior: we train the state representation function to transform the position of the object such that its transition is aligned with a latent descriptor <math alttext="z" class="ltx_Math" display="inline" id="S5.SS2.p1.1.m1.1"><semantics id="S5.SS2.p1.1.m1.1a"><mi id="S5.SS2.p1.1.m1.1.1" xref="S5.SS2.p1.1.m1.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.1.m1.1b"><ci id="S5.SS2.p1.1.m1.1.1.cmml" xref="S5.SS2.p1.1.m1.1.1">𝑧</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.1.m1.1c">z</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p1.1.m1.1d">italic_z</annotation></semantics></math>;
(b) DADS <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04855v1#bib.bib8" title="">8</a>]</cite> with object position prior: we train the dynamics predictor to predict the next position of the object given the current position and a continuous skill latent descriptor <math alttext="z" class="ltx_Math" display="inline" id="S5.SS2.p1.2.m2.1"><semantics id="S5.SS2.p1.2.m2.1a"><mi id="S5.SS2.p1.2.m2.1.1" xref="S5.SS2.p1.2.m2.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.2.m2.1b"><ci id="S5.SS2.p1.2.m2.1.1.cmml" xref="S5.SS2.p1.2.m2.1.1">𝑧</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.2.m2.1c">z</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p1.2.m2.1d">italic_z</annotation></semantics></math>;
(c) DIAYN <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04855v1#bib.bib7" title="">7</a>]</cite> with object position prior: we train the skill predictor to predict the continuous skill latent descriptor <math alttext="z" class="ltx_Math" display="inline" id="S5.SS2.p1.3.m3.1"><semantics id="S5.SS2.p1.3.m3.1a"><mi id="S5.SS2.p1.3.m3.1.1" xref="S5.SS2.p1.3.m3.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.3.m3.1b"><ci id="S5.SS2.p1.3.m3.1.1.cmml" xref="S5.SS2.p1.3.m3.1.1">𝑧</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.3.m3.1c">z</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p1.3.m3.1d">italic_z</annotation></semantics></math> given the position of the object;
(d) ASP <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04855v1#bib.bib19" title="">19</a>]</cite> only: we use Bob’s policy from ASP pre-training only, i.e., without any training on downstream tasks;
(e) Scratch MCP with Hindsight Experience Replay (HER) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04855v1#bib.bib5" title="">5</a>]</cite>: we train an MCP from scratch with HER;
(f) Scratch MCP without HER: we train an MCP from scratch without HER;
(g) Scratch Monolithic with HER: we train a monolithic policy from scratch with HER;
(h) Scratch Monolithic without HER: we train a monolithic policy from scratch without HER.
On downstream tasks, skills pre-trained with LSD, DADS, DIAYN, and our approach are reused with HRL.
Scratch baselines are trained end-to-end and do not benefit from pre-training.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S6">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">VI </span><span class="ltx_text ltx_font_smallcaps" id="S6.1.1">Evaluation</span>
</h2>
<div class="ltx_para" id="S6.p1">
<p class="ltx_p" id="S6.p1.1">We want to answer the following questions:
(1) How do our primitives interact with objects?
(2) Can our primitives be efficiently repurposed for new tasks?
(3) What are the benefits of our approach compared to ASP and MCP used in isolation?
(4) Can our primitives be reused in a real-world setting?</p>
</div>
<figure class="ltx_figure" id="S6.F3">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_4">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S6.F3.sf1">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_square" height="176" id="S6.F3.sf1.g1" src="extracted/5906562/figures/trajectories/trajectories_mcp_object_pos_50.png" width="195"/></div>
<div class="ltx_flex_cell ltx_flex_size_3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_square" height="176" id="S6.F3.sf1.g2" src="extracted/5906562/figures/trajectories/trajectories_mcp_object_pos_100.png" width="195"/></div>
<div class="ltx_flex_cell ltx_flex_size_3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_square" height="176" id="S6.F3.sf1.g3" src="extracted/5906562/figures/trajectories/trajectories_mcp_object_pos_300.png" width="195"/></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S6.F3.sf1.2.1.1" style="font-size:90%;">(a)</span> </span><span class="ltx_text" id="S6.F3.sf1.3.2" style="font-size:90%;">Ours</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S6.F3.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="542" id="S6.F3.sf2.g1" src="extracted/5906562/figures/trajectories/trajectories_lsd_object_pos_.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S6.F3.sf2.2.1.1" style="font-size:90%;">(b)</span> </span><span class="ltx_text" id="S6.F3.sf2.3.2" style="font-size:90%;">LSD</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S6.F3.sf3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="542" id="S6.F3.sf3.g1" src="extracted/5906562/figures/trajectories/trajectories_dads_object_pos_.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S6.F3.sf3.2.1.1" style="font-size:90%;">(c)</span> </span><span class="ltx_text" id="S6.F3.sf3.3.2" style="font-size:90%;">DADS</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S6.F3.sf4"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="542" id="S6.F3.sf4.g1" src="extracted/5906562/figures/trajectories/trajectories_diayn_object_pos_.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S6.F3.sf4.2.1.1" style="font-size:90%;">(d)</span> </span><span class="ltx_text" id="S6.F3.sf4.3.2" style="font-size:90%;">DIAYN</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S6.F3.5.2.1" style="font-size:90%;">Figure 3</span>: </span><span class="ltx_text ltx_font_bold" id="S6.F3.2.1" style="font-size:90%;">Per-Skill Trajectories<span class="ltx_text ltx_font_medium" id="S6.F3.2.1.1">:
Trajectories of object positions for <math alttext="N_{\text{skills}}=\text{32}" class="ltx_Math" display="inline" id="S6.F3.2.1.1.m1.1"><semantics id="S6.F3.2.1.1.m1.1b"><mrow id="S6.F3.2.1.1.m1.1.1" xref="S6.F3.2.1.1.m1.1.1.cmml"><msub id="S6.F3.2.1.1.m1.1.1.2" xref="S6.F3.2.1.1.m1.1.1.2.cmml"><mi id="S6.F3.2.1.1.m1.1.1.2.2" xref="S6.F3.2.1.1.m1.1.1.2.2.cmml">N</mi><mtext id="S6.F3.2.1.1.m1.1.1.2.3" xref="S6.F3.2.1.1.m1.1.1.2.3a.cmml">skills</mtext></msub><mo id="S6.F3.2.1.1.m1.1.1.1" xref="S6.F3.2.1.1.m1.1.1.1.cmml">=</mo><mtext id="S6.F3.2.1.1.m1.1.1.3" xref="S6.F3.2.1.1.m1.1.1.3a.cmml">32</mtext></mrow><annotation-xml encoding="MathML-Content" id="S6.F3.2.1.1.m1.1c"><apply id="S6.F3.2.1.1.m1.1.1.cmml" xref="S6.F3.2.1.1.m1.1.1"><eq id="S6.F3.2.1.1.m1.1.1.1.cmml" xref="S6.F3.2.1.1.m1.1.1.1"></eq><apply id="S6.F3.2.1.1.m1.1.1.2.cmml" xref="S6.F3.2.1.1.m1.1.1.2"><csymbol cd="ambiguous" id="S6.F3.2.1.1.m1.1.1.2.1.cmml" xref="S6.F3.2.1.1.m1.1.1.2">subscript</csymbol><ci id="S6.F3.2.1.1.m1.1.1.2.2.cmml" xref="S6.F3.2.1.1.m1.1.1.2.2">𝑁</ci><ci id="S6.F3.2.1.1.m1.1.1.2.3a.cmml" xref="S6.F3.2.1.1.m1.1.1.2.3"><mtext id="S6.F3.2.1.1.m1.1.1.2.3.cmml" mathsize="70%" xref="S6.F3.2.1.1.m1.1.1.2.3">skills</mtext></ci></apply><ci id="S6.F3.2.1.1.m1.1.1.3a.cmml" xref="S6.F3.2.1.1.m1.1.1.3"><mtext id="S6.F3.2.1.1.m1.1.1.3.cmml" xref="S6.F3.2.1.1.m1.1.1.3">32</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.F3.2.1.1.m1.1d">N_{\text{skills}}=\text{32}</annotation><annotation encoding="application/x-llamapun" id="S6.F3.2.1.1.m1.1e">italic_N start_POSTSUBSCRIPT skills end_POSTSUBSCRIPT = 32</annotation></semantics></math> random compositions of skills.
Each color corresponds to a random composition.
Our primitives in <a class="ltx_ref" href="https://arxiv.org/html/2410.04855v1#S6.F3.sf1" title="In Figure 3 ‣ VI Evaluation ‣ Unsupervised Skill Discovery for Robotic Manipulation through Automatic Task Generation"><span class="ltx_text ltx_ref_tag">3(a)</span></a> increasingly learn to cover reachable positions of the object.
The baselines partially cover the workspace (<a class="ltx_ref" href="https://arxiv.org/html/2410.04855v1#S6.F3.sf4" title="In Figure 3 ‣ VI Evaluation ‣ Unsupervised Skill Discovery for Robotic Manipulation through Automatic Task Generation"><span class="ltx_text ltx_ref_tag">3(d)</span></a>,<a class="ltx_ref" href="https://arxiv.org/html/2410.04855v1#S6.F3.sf2" title="In Figure 3 ‣ VI Evaluation ‣ Unsupervised Skill Discovery for Robotic Manipulation through Automatic Task Generation"><span class="ltx_text ltx_ref_tag">3(b)</span></a>), push and throw the object to unreachable positions (<a class="ltx_ref" href="https://arxiv.org/html/2410.04855v1#S6.F3.sf2" title="In Figure 3 ‣ VI Evaluation ‣ Unsupervised Skill Discovery for Robotic Manipulation through Automatic Task Generation"><span class="ltx_text ltx_ref_tag">3(b)</span></a>), or very rarely interact with the object (<a class="ltx_ref" href="https://arxiv.org/html/2410.04855v1#S6.F3.sf3" title="In Figure 3 ‣ VI Evaluation ‣ Unsupervised Skill Discovery for Robotic Manipulation through Automatic Task Generation"><span class="ltx_text ltx_ref_tag">3(c)</span></a>).</span></span></figcaption>
</figure>
<section class="ltx_subsection" id="S6.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S6.SS1.4.1.1">VI-A</span> </span><span class="ltx_text ltx_font_italic" id="S6.SS1.5.2">Primitives Progression through Pre-Training</span>
</h3>
<div class="ltx_para" id="S6.SS1.p1">
<p class="ltx_p" id="S6.SS1.p1.2">We examine the progression of our learned primitives throughout pre-training and evaluate their coverage in terms of object positions.
We believe that analyzing compositions of primitives provides more insights into their behaviors than analyzing individual primitives alone.
During pre-training, we qualitatively assess the evolution of our primitives by keeping checkpoints at three stages.
We sample <math alttext="N_{\text{skill}}" class="ltx_Math" display="inline" id="S6.SS1.p1.1.m1.1"><semantics id="S6.SS1.p1.1.m1.1a"><msub id="S6.SS1.p1.1.m1.1.1" xref="S6.SS1.p1.1.m1.1.1.cmml"><mi id="S6.SS1.p1.1.m1.1.1.2" xref="S6.SS1.p1.1.m1.1.1.2.cmml">N</mi><mtext id="S6.SS1.p1.1.m1.1.1.3" xref="S6.SS1.p1.1.m1.1.1.3a.cmml">skill</mtext></msub><annotation-xml encoding="MathML-Content" id="S6.SS1.p1.1.m1.1b"><apply id="S6.SS1.p1.1.m1.1.1.cmml" xref="S6.SS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S6.SS1.p1.1.m1.1.1.1.cmml" xref="S6.SS1.p1.1.m1.1.1">subscript</csymbol><ci id="S6.SS1.p1.1.m1.1.1.2.cmml" xref="S6.SS1.p1.1.m1.1.1.2">𝑁</ci><ci id="S6.SS1.p1.1.m1.1.1.3a.cmml" xref="S6.SS1.p1.1.m1.1.1.3"><mtext id="S6.SS1.p1.1.m1.1.1.3.cmml" mathsize="70%" xref="S6.SS1.p1.1.m1.1.1.3">skill</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p1.1.m1.1c">N_{\text{skill}}</annotation><annotation encoding="application/x-llamapun" id="S6.SS1.p1.1.m1.1d">italic_N start_POSTSUBSCRIPT skill end_POSTSUBSCRIPT</annotation></semantics></math> random values for the gate <math alttext="w\in\mathbb{R}^{K}" class="ltx_Math" display="inline" id="S6.SS1.p1.2.m2.1"><semantics id="S6.SS1.p1.2.m2.1a"><mrow id="S6.SS1.p1.2.m2.1.1" xref="S6.SS1.p1.2.m2.1.1.cmml"><mi id="S6.SS1.p1.2.m2.1.1.2" xref="S6.SS1.p1.2.m2.1.1.2.cmml">w</mi><mo id="S6.SS1.p1.2.m2.1.1.1" xref="S6.SS1.p1.2.m2.1.1.1.cmml">∈</mo><msup id="S6.SS1.p1.2.m2.1.1.3" xref="S6.SS1.p1.2.m2.1.1.3.cmml"><mi id="S6.SS1.p1.2.m2.1.1.3.2" xref="S6.SS1.p1.2.m2.1.1.3.2.cmml">ℝ</mi><mi id="S6.SS1.p1.2.m2.1.1.3.3" xref="S6.SS1.p1.2.m2.1.1.3.3.cmml">K</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.p1.2.m2.1b"><apply id="S6.SS1.p1.2.m2.1.1.cmml" xref="S6.SS1.p1.2.m2.1.1"><in id="S6.SS1.p1.2.m2.1.1.1.cmml" xref="S6.SS1.p1.2.m2.1.1.1"></in><ci id="S6.SS1.p1.2.m2.1.1.2.cmml" xref="S6.SS1.p1.2.m2.1.1.2">𝑤</ci><apply id="S6.SS1.p1.2.m2.1.1.3.cmml" xref="S6.SS1.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="S6.SS1.p1.2.m2.1.1.3.1.cmml" xref="S6.SS1.p1.2.m2.1.1.3">superscript</csymbol><ci id="S6.SS1.p1.2.m2.1.1.3.2.cmml" xref="S6.SS1.p1.2.m2.1.1.3.2">ℝ</ci><ci id="S6.SS1.p1.2.m2.1.1.3.3.cmml" xref="S6.SS1.p1.2.m2.1.1.3.3">𝐾</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p1.2.m2.1c">w\in\mathbb{R}^{K}</annotation><annotation encoding="application/x-llamapun" id="S6.SS1.p1.2.m2.1d">italic_w ∈ blackboard_R start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT</annotation></semantics></math>, which determines a fixed composition of primitives.</p>
</div>
<div class="ltx_para" id="S6.SS1.p2">
<p class="ltx_p" id="S6.SS1.p2.1">As shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.04855v1#S6.F3" title="Figure 3 ‣ VI Evaluation ‣ Unsupervised Skill Discovery for Robotic Manipulation through Automatic Task Generation"><span class="ltx_text ltx_ref_tag">3</span></a>, the primitives do not exhibit meaningful behaviors in early pre-training, resulting in minimal object movement.
However, as pre-training progresses and proposed tasks require moving the object on the table, the primitives learn to interact with the object.
Subsequently, as tasks requiring object lifting are introduced, the primitives learn to exhibit lifting behaviors.
Towards the end of pre-training, after the robot has been exposed to all tasks, the learned primitives demonstrate the ability to move the object to arbitrary positions in the workspace.
This observation suggests that task diversity plays a crucial role in discovering new behaviors, and these behaviors are effectively embedded in the primitives.</p>
</div>
<div class="ltx_para" id="S6.SS1.p3">
<p class="ltx_p" id="S6.SS1.p3.2">To evaluate the coverage of our primitives, we compare them to skills learned with LSD, DADS, and DIAYN.
Following a similar protocol, we save the skillset only at the end of pre-training.
For baselines, we sample <math alttext="N_{\text{skill}}" class="ltx_Math" display="inline" id="S6.SS1.p3.1.m1.1"><semantics id="S6.SS1.p3.1.m1.1a"><msub id="S6.SS1.p3.1.m1.1.1" xref="S6.SS1.p3.1.m1.1.1.cmml"><mi id="S6.SS1.p3.1.m1.1.1.2" xref="S6.SS1.p3.1.m1.1.1.2.cmml">N</mi><mtext id="S6.SS1.p3.1.m1.1.1.3" xref="S6.SS1.p3.1.m1.1.1.3a.cmml">skill</mtext></msub><annotation-xml encoding="MathML-Content" id="S6.SS1.p3.1.m1.1b"><apply id="S6.SS1.p3.1.m1.1.1.cmml" xref="S6.SS1.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S6.SS1.p3.1.m1.1.1.1.cmml" xref="S6.SS1.p3.1.m1.1.1">subscript</csymbol><ci id="S6.SS1.p3.1.m1.1.1.2.cmml" xref="S6.SS1.p3.1.m1.1.1.2">𝑁</ci><ci id="S6.SS1.p3.1.m1.1.1.3a.cmml" xref="S6.SS1.p3.1.m1.1.1.3"><mtext id="S6.SS1.p3.1.m1.1.1.3.cmml" mathsize="70%" xref="S6.SS1.p3.1.m1.1.1.3">skill</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p3.1.m1.1c">N_{\text{skill}}</annotation><annotation encoding="application/x-llamapun" id="S6.SS1.p3.1.m1.1d">italic_N start_POSTSUBSCRIPT skill end_POSTSUBSCRIPT</annotation></semantics></math> fixed random values of the latent skill descriptor <math alttext="z" class="ltx_Math" display="inline" id="S6.SS1.p3.2.m2.1"><semantics id="S6.SS1.p3.2.m2.1a"><mi id="S6.SS1.p3.2.m2.1.1" xref="S6.SS1.p3.2.m2.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="S6.SS1.p3.2.m2.1b"><ci id="S6.SS1.p3.2.m2.1.1.cmml" xref="S6.SS1.p3.2.m2.1.1">𝑧</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p3.2.m2.1c">z</annotation><annotation encoding="application/x-llamapun" id="S6.SS1.p3.2.m2.1d">italic_z</annotation></semantics></math>, which are then given as fixed inputs to the skill encoder.
The results of our evaluation, depicted in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.04855v1#S6.F3" title="Figure 3 ‣ VI Evaluation ‣ Unsupervised Skill Discovery for Robotic Manipulation through Automatic Task Generation"><span class="ltx_text ltx_ref_tag">3</span></a>, reveal that our method achieves full coverage of reachable object positions.
Compositions of our primitives indeed span all reachable object positions, ensuring the ability to move the object anywhere within the workspace.
Meanwhile, LSD learns skills that partially cover the space of object positions but also push and throw the object in unreachable areas, such as off the table.
We believe this is a direct consequence of the intrinsic objective of LSD, which mainly encourages the discovery of dynamic behaviors.
This lack of coverage and tendency to move objects off the table can be detrimental to solving downstream tasks in a table-top setting.
Our method learns behaviors that are useful for tasks in a table-top setting, which encourages coverage while discouraging moving the object to irrecoverable areas.
The skills learned with DADS and DIAYN exhibit few interactions with the object.
In particular, DIAYN learns skills that achieve a low coverage of object positions while DADS skillset collapses to either ignoring the object or moving it along a fixed path.
These limitations are likely due to the sparsity and noise of their intrinsic rewards in robotic manipulation.
Attempts to address this by adding bonuses to the intrinsic rewards did not result in the learning of interactive skills.
The limited coverage of object positions achieved by DADS and DIAYN restricts the reusability of these skills in downstream tasks.
In contrast, our method overcomes this limitation thanks to the curriculum induced by ASP and ABC, and the explicit design to promote interactions with objects.</p>
</div>
</section>
<section class="ltx_subsection" id="S6.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S6.SS2.4.1.1">VI-B</span> </span><span class="ltx_text ltx_font_italic" id="S6.SS2.5.2">Primitives Orchestration on Downstream Tasks</span>
</h3>
<figure class="ltx_figure" id="S6.F4"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="87" id="S6.F4.g1" src="extracted/5906562/figures/success_rates/success_rate.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S6.F4.3.1.1" style="font-size:90%;">Figure 4</span>: </span><span class="ltx_text ltx_font_bold" id="S6.F4.4.2" style="font-size:90%;">Downstream Learning Curves<span class="ltx_text ltx_font_medium" id="S6.F4.4.2.1">:
Average success rate throughout training on a downstream task.
The solid area represents the standard deviation.
”Scratch” baselines are denoted with a ”0” for compactness.
Our method is overall the most competitive both in terms of sample efficiency and final performance.
</span></span></figcaption>
</figure>
<figure class="ltx_table" id="S6.T1">
<p class="ltx_p" id="S6.T1.2">.

<span class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S6.T1.2.1">
<span class="ltx_thead">
<span class="ltx_tr" id="S6.T1.2.1.1.1">
<span class="ltx_td ltx_th ltx_th_row ltx_border_tt" id="S6.T1.2.1.1.1.1" style="padding-left:2.8pt;padding-right:2.8pt;"></span>
<span class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T1.2.1.1.1.2" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text ltx_font_italic" id="S6.T1.2.1.1.1.2.1">Larger</span></span>
<span class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T1.2.1.1.1.3" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text ltx_font_italic" id="S6.T1.2.1.1.1.3.1">In Air</span></span>
<span class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T1.2.1.1.1.4" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text ltx_font_italic" id="S6.T1.2.1.1.1.4.1">Push</span></span>
<span class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T1.2.1.1.1.5" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text ltx_font_italic" id="S6.T1.2.1.1.1.5.1">Sphere</span></span>
<span class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T1.2.1.1.1.6" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text ltx_font_italic" id="S6.T1.2.1.1.1.6.1">Wall</span></span>
<span class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T1.2.1.1.1.7" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text ltx_font_italic" id="S6.T1.2.1.1.1.7.1">Box</span></span></span>
</span>
<span class="ltx_tbody">
<span class="ltx_tr" id="S6.T1.2.1.2.1">
<span class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S6.T1.2.1.2.1.1" style="padding-left:2.8pt;padding-right:2.8pt;">Ours (simulation)</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S6.T1.2.1.2.1.2" style="padding-left:2.8pt;padding-right:2.8pt;">0.83</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S6.T1.2.1.2.1.3" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text ltx_font_bold" id="S6.T1.2.1.2.1.3.1">1.00</span></span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S6.T1.2.1.2.1.4" style="padding-left:2.8pt;padding-right:2.8pt;">0.52</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S6.T1.2.1.2.1.5" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text ltx_font_bold" id="S6.T1.2.1.2.1.5.1">1.00</span></span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S6.T1.2.1.2.1.6" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text ltx_font_bold" id="S6.T1.2.1.2.1.6.1">0.98</span></span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S6.T1.2.1.2.1.7" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text ltx_font_bold" id="S6.T1.2.1.2.1.7.1">0.98</span></span></span>
<span class="ltx_tr" id="S6.T1.2.1.3.2">
<span class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S6.T1.2.1.3.2.1" style="padding-left:2.8pt;padding-right:2.8pt;">ASP only</span>
<span class="ltx_td ltx_align_center" id="S6.T1.2.1.3.2.2" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text ltx_font_bold" id="S6.T1.2.1.3.2.2.1">0.94</span></span>
<span class="ltx_td ltx_align_center" id="S6.T1.2.1.3.2.3" style="padding-left:2.8pt;padding-right:2.8pt;">0.94</span>
<span class="ltx_td ltx_align_center" id="S6.T1.2.1.3.2.4" style="padding-left:2.8pt;padding-right:2.8pt;">0.02</span>
<span class="ltx_td ltx_align_center" id="S6.T1.2.1.3.2.5" style="padding-left:2.8pt;padding-right:2.8pt;">0.85</span>
<span class="ltx_td ltx_align_center" id="S6.T1.2.1.3.2.6" style="padding-left:2.8pt;padding-right:2.8pt;">0.00</span>
<span class="ltx_td ltx_align_center" id="S6.T1.2.1.3.2.7" style="padding-left:2.8pt;padding-right:2.8pt;">0.27</span></span>
<span class="ltx_tr" id="S6.T1.2.1.4.3">
<span class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S6.T1.2.1.4.3.1" style="padding-left:2.8pt;padding-right:2.8pt;">LSD</span>
<span class="ltx_td ltx_align_center" id="S6.T1.2.1.4.3.2" style="padding-left:2.8pt;padding-right:2.8pt;">0.17</span>
<span class="ltx_td ltx_align_center" id="S6.T1.2.1.4.3.3" style="padding-left:2.8pt;padding-right:2.8pt;">0.17</span>
<span class="ltx_td ltx_align_center" id="S6.T1.2.1.4.3.4" style="padding-left:2.8pt;padding-right:2.8pt;">0.17</span>
<span class="ltx_td ltx_align_center" id="S6.T1.2.1.4.3.5" style="padding-left:2.8pt;padding-right:2.8pt;">0.10</span>
<span class="ltx_td ltx_align_center" id="S6.T1.2.1.4.3.6" style="padding-left:2.8pt;padding-right:2.8pt;">0.04</span>
<span class="ltx_td ltx_align_center" id="S6.T1.2.1.4.3.7" style="padding-left:2.8pt;padding-right:2.8pt;">0.73</span></span>
<span class="ltx_tr" id="S6.T1.2.1.5.4">
<span class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S6.T1.2.1.5.4.1" style="padding-left:2.8pt;padding-right:2.8pt;">DADS</span>
<span class="ltx_td ltx_align_center" id="S6.T1.2.1.5.4.2" style="padding-left:2.8pt;padding-right:2.8pt;">0.06</span>
<span class="ltx_td ltx_align_center" id="S6.T1.2.1.5.4.3" style="padding-left:2.8pt;padding-right:2.8pt;">0.04</span>
<span class="ltx_td ltx_align_center" id="S6.T1.2.1.5.4.4" style="padding-left:2.8pt;padding-right:2.8pt;">0.06</span>
<span class="ltx_td ltx_align_center" id="S6.T1.2.1.5.4.5" style="padding-left:2.8pt;padding-right:2.8pt;">0.15</span>
<span class="ltx_td ltx_align_center" id="S6.T1.2.1.5.4.6" style="padding-left:2.8pt;padding-right:2.8pt;">0.56</span>
<span class="ltx_td ltx_align_center" id="S6.T1.2.1.5.4.7" style="padding-left:2.8pt;padding-right:2.8pt;">0.06</span></span>
<span class="ltx_tr" id="S6.T1.2.1.6.5">
<span class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S6.T1.2.1.6.5.1" style="padding-left:2.8pt;padding-right:2.8pt;">DIAYN</span>
<span class="ltx_td ltx_align_center" id="S6.T1.2.1.6.5.2" style="padding-left:2.8pt;padding-right:2.8pt;">0.00</span>
<span class="ltx_td ltx_align_center" id="S6.T1.2.1.6.5.3" style="padding-left:2.8pt;padding-right:2.8pt;">0.00</span>
<span class="ltx_td ltx_align_center" id="S6.T1.2.1.6.5.4" style="padding-left:2.8pt;padding-right:2.8pt;">0.06</span>
<span class="ltx_td ltx_align_center" id="S6.T1.2.1.6.5.5" style="padding-left:2.8pt;padding-right:2.8pt;">0.02</span>
<span class="ltx_td ltx_align_center" id="S6.T1.2.1.6.5.6" style="padding-left:2.8pt;padding-right:2.8pt;">0.00</span>
<span class="ltx_td ltx_align_center" id="S6.T1.2.1.6.5.7" style="padding-left:2.8pt;padding-right:2.8pt;">0.02</span></span>
<span class="ltx_tr" id="S6.T1.2.1.7.6">
<span class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S6.T1.2.1.7.6.1" style="padding-left:2.8pt;padding-right:2.8pt;">Scratch Monolithic w/ HER</span>
<span class="ltx_td ltx_align_center" id="S6.T1.2.1.7.6.2" style="padding-left:2.8pt;padding-right:2.8pt;">0.58</span>
<span class="ltx_td ltx_align_center" id="S6.T1.2.1.7.6.3" style="padding-left:2.8pt;padding-right:2.8pt;">0.94</span>
<span class="ltx_td ltx_align_center" id="S6.T1.2.1.7.6.4" style="padding-left:2.8pt;padding-right:2.8pt;">0.85</span>
<span class="ltx_td ltx_align_center" id="S6.T1.2.1.7.6.5" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text ltx_font_bold" id="S6.T1.2.1.7.6.5.1">1.00</span></span>
<span class="ltx_td ltx_align_center" id="S6.T1.2.1.7.6.6" style="padding-left:2.8pt;padding-right:2.8pt;">0.00</span>
<span class="ltx_td ltx_align_center" id="S6.T1.2.1.7.6.7" style="padding-left:2.8pt;padding-right:2.8pt;">0.36</span></span>
<span class="ltx_tr" id="S6.T1.2.1.8.7">
<span class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S6.T1.2.1.8.7.1" style="padding-left:2.8pt;padding-right:2.8pt;">Scratch MCP w/ HER</span>
<span class="ltx_td ltx_align_center" id="S6.T1.2.1.8.7.2" style="padding-left:2.8pt;padding-right:2.8pt;">0.85</span>
<span class="ltx_td ltx_align_center" id="S6.T1.2.1.8.7.3" style="padding-left:2.8pt;padding-right:2.8pt;">0.52</span>
<span class="ltx_td ltx_align_center" id="S6.T1.2.1.8.7.4" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text ltx_font_bold" id="S6.T1.2.1.8.7.4.1">0.92</span></span>
<span class="ltx_td ltx_align_center" id="S6.T1.2.1.8.7.5" style="padding-left:2.8pt;padding-right:2.8pt;">0.98</span>
<span class="ltx_td ltx_align_center" id="S6.T1.2.1.8.7.6" style="padding-left:2.8pt;padding-right:2.8pt;">0.00</span>
<span class="ltx_td ltx_align_center" id="S6.T1.2.1.8.7.7" style="padding-left:2.8pt;padding-right:2.8pt;">0.00</span></span>
<span class="ltx_tr" id="S6.T1.2.1.9.8">
<span class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S6.T1.2.1.9.8.1" style="padding-left:2.8pt;padding-right:2.8pt;">Scratch Monolithic w/o HER</span>
<span class="ltx_td ltx_align_center" id="S6.T1.2.1.9.8.2" style="padding-left:2.8pt;padding-right:2.8pt;">0.02</span>
<span class="ltx_td ltx_align_center" id="S6.T1.2.1.9.8.3" style="padding-left:2.8pt;padding-right:2.8pt;">0.00</span>
<span class="ltx_td ltx_align_center" id="S6.T1.2.1.9.8.4" style="padding-left:2.8pt;padding-right:2.8pt;">0.00</span>
<span class="ltx_td ltx_align_center" id="S6.T1.2.1.9.8.5" style="padding-left:2.8pt;padding-right:2.8pt;">0.00</span>
<span class="ltx_td ltx_align_center" id="S6.T1.2.1.9.8.6" style="padding-left:2.8pt;padding-right:2.8pt;">0.00</span>
<span class="ltx_td ltx_align_center" id="S6.T1.2.1.9.8.7" style="padding-left:2.8pt;padding-right:2.8pt;">0.00</span></span>
<span class="ltx_tr" id="S6.T1.2.1.10.9">
<span class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S6.T1.2.1.10.9.1" style="padding-left:2.8pt;padding-right:2.8pt;">Scratch MCP w/o HER</span>
<span class="ltx_td ltx_align_center" id="S6.T1.2.1.10.9.2" style="padding-left:2.8pt;padding-right:2.8pt;">0.00</span>
<span class="ltx_td ltx_align_center" id="S6.T1.2.1.10.9.3" style="padding-left:2.8pt;padding-right:2.8pt;">0.00</span>
<span class="ltx_td ltx_align_center" id="S6.T1.2.1.10.9.4" style="padding-left:2.8pt;padding-right:2.8pt;">0.04</span>
<span class="ltx_td ltx_align_center" id="S6.T1.2.1.10.9.5" style="padding-left:2.8pt;padding-right:2.8pt;">0.00</span>
<span class="ltx_td ltx_align_center" id="S6.T1.2.1.10.9.6" style="padding-left:2.8pt;padding-right:2.8pt;">0.02</span>
<span class="ltx_td ltx_align_center" id="S6.T1.2.1.10.9.7" style="padding-left:2.8pt;padding-right:2.8pt;">0.00</span></span>
<span class="ltx_tr" id="S6.T1.2.1.11.10">
<span class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_t" id="S6.T1.2.1.11.10.1" style="padding-left:2.8pt;padding-right:2.8pt;">Ours (real)</span>
<span class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S6.T1.2.1.11.10.2" style="padding-left:2.8pt;padding-right:2.8pt;">0.83</span>
<span class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S6.T1.2.1.11.10.3" style="padding-left:2.8pt;padding-right:2.8pt;">-</span>
<span class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S6.T1.2.1.11.10.4" style="padding-left:2.8pt;padding-right:2.8pt;">-</span>
<span class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S6.T1.2.1.11.10.5" style="padding-left:2.8pt;padding-right:2.8pt;">-</span>
<span class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S6.T1.2.1.11.10.6" style="padding-left:2.8pt;padding-right:2.8pt;">0.59</span>
<span class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S6.T1.2.1.11.10.7" style="padding-left:2.8pt;padding-right:2.8pt;">-</span></span>
</span>
</span></p>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S6.T1.4.1.1" style="font-size:90%;">TABLE I</span>: </span><span class="ltx_text" id="S6.T1.5.2" style="font-size:90%;">
<span class="ltx_text ltx_font_bold" id="S6.T1.5.2.1">Downstream Success Rates</span>: Each success rate is computed after training on each downstream task and averaged over three random seeds.
</span></figcaption>
</figure>
<div class="ltx_para" id="S6.SS2.p1">
<p class="ltx_p" id="S6.SS2.p1.1">We train orchestrators from scratch in simulation and evaluate how they learn to compose our pre-trained primitives to solve unseen tasks.
For each task, we train a different orchestrator while using the same set of pre-trained primitives with frozen parameters.
In Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.04855v1#S6.F4" title="Figure 4 ‣ VI-B Primitives Orchestration on Downstream Tasks ‣ VI Evaluation ‣ Unsupervised Skill Discovery for Robotic Manipulation through Automatic Task Generation"><span class="ltx_text ltx_ref_tag">4</span></a>, we show the evolution of the success rate on these tasks for our method and baselines averaged over three random seeds.
In our accompanying video, we additionally provide visualizations of each Skill Learning agent on downstream tasks.
Table <a class="ltx_ref" href="https://arxiv.org/html/2410.04855v1#S6.T1" title="TABLE I ‣ VI-B Primitives Orchestration on Downstream Tasks ‣ VI Evaluation ‣ Unsupervised Skill Discovery for Robotic Manipulation through Automatic Task Generation"><span class="ltx_text ltx_ref_tag">I</span></a> reports the final achieved success rate.
Most Skill Learning baselines and agents trained from scratch without HER fail on all tasks.
On <span class="ltx_text ltx_font_italic" id="S6.SS2.p1.1.1">Larger</span>, <span class="ltx_text ltx_font_italic" id="S6.SS2.p1.1.2">In Air</span>, and <span class="ltx_text ltx_font_italic" id="S6.SS2.p1.1.3">Sphere</span>, our orchestrators learn faster than all baselines, including agents benefiting from HER, and reach the highest success rates.
This suggests that our primitives can be reused on tasks they were not explicitly pre-trained to solve and that they can achieve high performance with high sample efficiency.
We find that LSD achieves limited performance on these three tasks, and we qualitatively observe that agents reusing skills learned with LSD can only reach goals in some areas of the workspace and do not stabilize to the target position but rather oscillate around it.
In <span class="ltx_text ltx_font_italic" id="S6.SS2.p1.1.4">Sphere</span>, LSD skills often fail to grasp the object stably. We suggest that this is a consequence of LSD encouraging the discovery of dynamic skills, which makes it difficult to maintain the object at a static position.
DADS and DIAYN also achieve low success rates on these tasks.
Despite the changes in dynamics induced by a new object in the environment, our approach quickly achieves high success rates on <span class="ltx_text ltx_font_italic" id="S6.SS2.p1.1.5">Wall</span> and <span class="ltx_text ltx_font_italic" id="S6.SS2.p1.1.6">Box</span>.
Surprisingly, LSD skills achieve reasonable performance on <span class="ltx_text ltx_font_italic" id="S6.SS2.p1.1.7">Box</span> despite their limited results on other tasks.
We find that the oscillations of the end-effector around the target position that we observed in other tasks are alleviated by the box, which constrains the motion of the end-effector to remain inside the box.
Hence, in this very specific scenario, part of the issues induced by dynamic skills are addressed by the structure of the environment.
On <span class="ltx_text ltx_font_italic" id="S6.SS2.p1.1.8">Wall</span>, LSD skills fail to solve the tasks, and we believe that this is due to the lack of coverage of the skillset.
On <span class="ltx_text ltx_font_italic" id="S6.SS2.p1.1.9">Box</span>, both DIAYN and DADS fail.
However, on <span class="ltx_text ltx_font_italic" id="S6.SS2.p1.1.10">Wall</span>, DADS obtains a surprisingly high score.
We qualitatively observe that DADS always solves the task in a suboptimal manner by using the unique interactive behavior it discovered, by following a long trajectory to avoid the obstacle.
Meanwhile, all other approaches get low success rates, if any.
This shows that our primitives can be composed and used in settings with different dynamics they were pre-trained on.
<span class="ltx_text ltx_font_italic" id="S6.SS2.p1.1.11">Push</span> is where our approach struggles the most, while HER performs well.
As the pre-trained primitives favor grasping, a blocked gripper makes them significantly less efficient in manipulating the object.
LSD skills seem to suffer even more from this issue as its success rate on <span class="ltx_text ltx_font_italic" id="S6.SS2.p1.1.12">Push</span> is significantly lower.
This illustrates a change in dynamics where no Skill Learning method can adapt.
From Table <a class="ltx_ref" href="https://arxiv.org/html/2410.04855v1#S6.T1" title="TABLE I ‣ VI-B Primitives Orchestration on Downstream Tasks ‣ VI Evaluation ‣ Unsupervised Skill Discovery for Robotic Manipulation through Automatic Task Generation"><span class="ltx_text ltx_ref_tag">I</span></a>, we observe that ASP in isolation does not achieve as good results on most tasks, especially with perturbations to the dynamics.
We also observe that MCP trained from scratch in isolation performs similarly to its monolithic counterpart, if not worse.
We think this is due to the more unstable nature of MCP.
Overall, these results suggest that the benefits of our method do not come from ASP or MCP in isolation but from their combination, yielding the discovery of adaptable behaviors.</p>
</div>
<div class="ltx_para" id="S6.SS2.p2">
<p class="ltx_p" id="S6.SS2.p2.1">We evaluate the primitives in the real world and show the real robot using our primitives in our accompanying video.
We track the position of the object with a motion capture system.
We test the models trained in simulation to solve <span class="ltx_text ltx_font_italic" id="S6.SS2.p2.1.1">Large Area</span> and <span class="ltx_text ltx_font_italic" id="S6.SS2.p2.1.2">Wall</span>, without additional training.
As we found that the learned policies tend to push the gripper against the table, we clip the action dimension of the gripper such that its position always remains slightly above the level of the table, hence avoiding collisions.
We found this to be strictly necessary to run our trained policies on the robot safely.
We diversify the initial and target positions such that the object must move in all regions of the workspace.
We run 103 trials and 36 for <span class="ltx_text ltx_font_italic" id="S6.SS2.p2.1.3">Larger</span> and <span class="ltx_text ltx_font_italic" id="S6.SS2.p2.1.4">Wall</span>, respectively.
While the wall is solid and fixed in simulation, it is made of cardboard in our real-world setup to avoid damaging the robot in case of collisions.
We report the average success rate of both tasks in Table <a class="ltx_ref" href="https://arxiv.org/html/2410.04855v1#S6.T1" title="TABLE I ‣ VI-B Primitives Orchestration on Downstream Tasks ‣ VI Evaluation ‣ Unsupervised Skill Discovery for Robotic Manipulation through Automatic Task Generation"><span class="ltx_text ltx_ref_tag">I</span></a>.
On the one hand, the model trained to solve <span class="ltx_text ltx_font_italic" id="S6.SS2.p2.1.5">Larger</span> performs as well as in simulation.
Most failures come from target positions that are at the edge of the reachable area of the end-effector, which triggers failures of the controller.
This suggests that the primitives learned robust behaviors that can be transferred to real-world settings.
On the other hand, the model trained to solve <span class="ltx_text ltx_font_italic" id="S6.SS2.p2.1.6">Wall</span> does not perform as well.
Most failures occur when the target is at the edge of the goal area or when the end-effector collides with the wall.
This is a consequence of the sparse reward, which only encourages success without safety considerations.
Overall, these results are encouraging as they show our primitives can be used on a real robot to solve manipulation tasks.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S7">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">VII </span><span class="ltx_text ltx_font_smallcaps" id="S7.1.1">Conclusion</span>
</h2>
<div class="ltx_para" id="S7.p1">
<p class="ltx_p" id="S7.p1.1">This paper introduces a novel approach to learning composable and reusable skills in robotic manipulation.
We propose to leverage Asymmetric Self-Play to generate diverse and complex pre-training tasks and Multiplicative Compositional Policies to obtain a skill repertoire for diverse object manipulation tasks.
We show the effectiveness of our method in simulated and real-world robotic manipulation scenarios on a set of downstream tasks with Hierarchical Reinforcement Learning.
While showing promising results, some limitations still need to be addressed.
A limitation of our approach is the object-centric observations and we would like to tackle Skill Learning from visual inputs in future work.
Other future directions lie in finding better model architectures to embed and reuse the discovered behaviors.</p>
</div>
</section>
<section class="ltx_section" id="S8">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">VIII </span><span class="ltx_text ltx_font_smallcaps" id="S8.1.1">Appendix</span>
</h2>
<section class="ltx_subsection" id="S8.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S8.SS1.4.1.1">VIII-A</span> </span><span class="ltx_text ltx_font_italic" id="S8.SS1.5.2">Environment</span>
</h3>
<section class="ltx_subsubsection" id="S8.SS1.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span class="ltx_text" id="S8.SS1.SSS1.4.1.1">VIII-A</span>1 </span>State</h4>
<div class="ltx_para" id="S8.SS1.SSS1.p1">
<p class="ltx_p" id="S8.SS1.SSS1.p1.1">The state of the environment consists of the end-effector position and linear velocity, the finger positions and linear velocities, the object absolute positions, the object position relative to the end-effector, the object linear velocity, binary contact information between fingers and the object, and the number of steps taken since the beginning of the episode.
Alice’s policy receives the full state as input.
We find that including contact information and time in Alice’s inputs facilitates the discovery of novel tasks and behaviors, such as grasping objects.
Since Alice is only a proxy to train Bob and is never deployed on the real robot, she can benefit from privileged information as input.
As contact and velocity information would be too different between simulation and reality, we do not provide these to Bob.
Bob’s primitives and its orchestrator only receive positions as inputs.
In addition, as in Eq. <a class="ltx_ref" href="https://arxiv.org/html/2410.04855v1#S3.E1" title="In III-B Multiplicative Compositional Policy ‣ III Preliminaries ‣ Unsupervised Skill Discovery for Robotic Manipulation through Automatic Task Generation"><span class="ltx_text ltx_ref_tag">1</span></a>, the orchestrator also takes task-specific information as input, which consists of the target object position in our experiments.
It ensures that primitives only depend on reliable information in the real robotic platform, making the primitives more transferable to the real world.
During downstream training, all agents receive only positions and goals as input.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S8.SS1.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span class="ltx_text" id="S8.SS1.SSS2.4.1.1">VIII-A</span>2 </span>Action</h4>
<div class="ltx_para" id="S8.SS1.SSS2.p1">
<p class="ltx_p" id="S8.SS1.SSS2.p1.3">The action is four-dimensional, comprising both the desired displacement of the end-effector and the change in width between the fingers.
Actions are scaled from <math alttext="[-1,+1]" class="ltx_Math" display="inline" id="S8.SS1.SSS2.p1.1.m1.2"><semantics id="S8.SS1.SSS2.p1.1.m1.2a"><mrow id="S8.SS1.SSS2.p1.1.m1.2.2.2" xref="S8.SS1.SSS2.p1.1.m1.2.2.3.cmml"><mo id="S8.SS1.SSS2.p1.1.m1.2.2.2.3" stretchy="false" xref="S8.SS1.SSS2.p1.1.m1.2.2.3.cmml">[</mo><mrow id="S8.SS1.SSS2.p1.1.m1.1.1.1.1" xref="S8.SS1.SSS2.p1.1.m1.1.1.1.1.cmml"><mo id="S8.SS1.SSS2.p1.1.m1.1.1.1.1a" xref="S8.SS1.SSS2.p1.1.m1.1.1.1.1.cmml">−</mo><mn id="S8.SS1.SSS2.p1.1.m1.1.1.1.1.2" xref="S8.SS1.SSS2.p1.1.m1.1.1.1.1.2.cmml">1</mn></mrow><mo id="S8.SS1.SSS2.p1.1.m1.2.2.2.4" xref="S8.SS1.SSS2.p1.1.m1.2.2.3.cmml">,</mo><mrow id="S8.SS1.SSS2.p1.1.m1.2.2.2.2" xref="S8.SS1.SSS2.p1.1.m1.2.2.2.2.cmml"><mo id="S8.SS1.SSS2.p1.1.m1.2.2.2.2a" xref="S8.SS1.SSS2.p1.1.m1.2.2.2.2.cmml">+</mo><mn id="S8.SS1.SSS2.p1.1.m1.2.2.2.2.2" xref="S8.SS1.SSS2.p1.1.m1.2.2.2.2.2.cmml">1</mn></mrow><mo id="S8.SS1.SSS2.p1.1.m1.2.2.2.5" stretchy="false" xref="S8.SS1.SSS2.p1.1.m1.2.2.3.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S8.SS1.SSS2.p1.1.m1.2b"><interval closure="closed" id="S8.SS1.SSS2.p1.1.m1.2.2.3.cmml" xref="S8.SS1.SSS2.p1.1.m1.2.2.2"><apply id="S8.SS1.SSS2.p1.1.m1.1.1.1.1.cmml" xref="S8.SS1.SSS2.p1.1.m1.1.1.1.1"><minus id="S8.SS1.SSS2.p1.1.m1.1.1.1.1.1.cmml" xref="S8.SS1.SSS2.p1.1.m1.1.1.1.1"></minus><cn id="S8.SS1.SSS2.p1.1.m1.1.1.1.1.2.cmml" type="integer" xref="S8.SS1.SSS2.p1.1.m1.1.1.1.1.2">1</cn></apply><apply id="S8.SS1.SSS2.p1.1.m1.2.2.2.2.cmml" xref="S8.SS1.SSS2.p1.1.m1.2.2.2.2"><plus id="S8.SS1.SSS2.p1.1.m1.2.2.2.2.1.cmml" xref="S8.SS1.SSS2.p1.1.m1.2.2.2.2"></plus><cn id="S8.SS1.SSS2.p1.1.m1.2.2.2.2.2.cmml" type="integer" xref="S8.SS1.SSS2.p1.1.m1.2.2.2.2.2">1</cn></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S8.SS1.SSS2.p1.1.m1.2c">[-1,+1]</annotation><annotation encoding="application/x-llamapun" id="S8.SS1.SSS2.p1.1.m1.2d">[ - 1 , + 1 ]</annotation></semantics></math> to <math alttext="[-5,+5]" class="ltx_Math" display="inline" id="S8.SS1.SSS2.p1.2.m2.2"><semantics id="S8.SS1.SSS2.p1.2.m2.2a"><mrow id="S8.SS1.SSS2.p1.2.m2.2.2.2" xref="S8.SS1.SSS2.p1.2.m2.2.2.3.cmml"><mo id="S8.SS1.SSS2.p1.2.m2.2.2.2.3" stretchy="false" xref="S8.SS1.SSS2.p1.2.m2.2.2.3.cmml">[</mo><mrow id="S8.SS1.SSS2.p1.2.m2.1.1.1.1" xref="S8.SS1.SSS2.p1.2.m2.1.1.1.1.cmml"><mo id="S8.SS1.SSS2.p1.2.m2.1.1.1.1a" xref="S8.SS1.SSS2.p1.2.m2.1.1.1.1.cmml">−</mo><mn id="S8.SS1.SSS2.p1.2.m2.1.1.1.1.2" xref="S8.SS1.SSS2.p1.2.m2.1.1.1.1.2.cmml">5</mn></mrow><mo id="S8.SS1.SSS2.p1.2.m2.2.2.2.4" xref="S8.SS1.SSS2.p1.2.m2.2.2.3.cmml">,</mo><mrow id="S8.SS1.SSS2.p1.2.m2.2.2.2.2" xref="S8.SS1.SSS2.p1.2.m2.2.2.2.2.cmml"><mo id="S8.SS1.SSS2.p1.2.m2.2.2.2.2a" xref="S8.SS1.SSS2.p1.2.m2.2.2.2.2.cmml">+</mo><mn id="S8.SS1.SSS2.p1.2.m2.2.2.2.2.2" xref="S8.SS1.SSS2.p1.2.m2.2.2.2.2.2.cmml">5</mn></mrow><mo id="S8.SS1.SSS2.p1.2.m2.2.2.2.5" stretchy="false" xref="S8.SS1.SSS2.p1.2.m2.2.2.3.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S8.SS1.SSS2.p1.2.m2.2b"><interval closure="closed" id="S8.SS1.SSS2.p1.2.m2.2.2.3.cmml" xref="S8.SS1.SSS2.p1.2.m2.2.2.2"><apply id="S8.SS1.SSS2.p1.2.m2.1.1.1.1.cmml" xref="S8.SS1.SSS2.p1.2.m2.1.1.1.1"><minus id="S8.SS1.SSS2.p1.2.m2.1.1.1.1.1.cmml" xref="S8.SS1.SSS2.p1.2.m2.1.1.1.1"></minus><cn id="S8.SS1.SSS2.p1.2.m2.1.1.1.1.2.cmml" type="integer" xref="S8.SS1.SSS2.p1.2.m2.1.1.1.1.2">5</cn></apply><apply id="S8.SS1.SSS2.p1.2.m2.2.2.2.2.cmml" xref="S8.SS1.SSS2.p1.2.m2.2.2.2.2"><plus id="S8.SS1.SSS2.p1.2.m2.2.2.2.2.1.cmml" xref="S8.SS1.SSS2.p1.2.m2.2.2.2.2"></plus><cn id="S8.SS1.SSS2.p1.2.m2.2.2.2.2.2.cmml" type="integer" xref="S8.SS1.SSS2.p1.2.m2.2.2.2.2.2">5</cn></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S8.SS1.SSS2.p1.2.m2.2c">[-5,+5]</annotation><annotation encoding="application/x-llamapun" id="S8.SS1.SSS2.p1.2.m2.2d">[ - 5 , + 5 ]</annotation></semantics></math> cm for the end-effector and to <math alttext="[-10,+10]" class="ltx_Math" display="inline" id="S8.SS1.SSS2.p1.3.m3.2"><semantics id="S8.SS1.SSS2.p1.3.m3.2a"><mrow id="S8.SS1.SSS2.p1.3.m3.2.2.2" xref="S8.SS1.SSS2.p1.3.m3.2.2.3.cmml"><mo id="S8.SS1.SSS2.p1.3.m3.2.2.2.3" stretchy="false" xref="S8.SS1.SSS2.p1.3.m3.2.2.3.cmml">[</mo><mrow id="S8.SS1.SSS2.p1.3.m3.1.1.1.1" xref="S8.SS1.SSS2.p1.3.m3.1.1.1.1.cmml"><mo id="S8.SS1.SSS2.p1.3.m3.1.1.1.1a" xref="S8.SS1.SSS2.p1.3.m3.1.1.1.1.cmml">−</mo><mn id="S8.SS1.SSS2.p1.3.m3.1.1.1.1.2" xref="S8.SS1.SSS2.p1.3.m3.1.1.1.1.2.cmml">10</mn></mrow><mo id="S8.SS1.SSS2.p1.3.m3.2.2.2.4" xref="S8.SS1.SSS2.p1.3.m3.2.2.3.cmml">,</mo><mrow id="S8.SS1.SSS2.p1.3.m3.2.2.2.2" xref="S8.SS1.SSS2.p1.3.m3.2.2.2.2.cmml"><mo id="S8.SS1.SSS2.p1.3.m3.2.2.2.2a" xref="S8.SS1.SSS2.p1.3.m3.2.2.2.2.cmml">+</mo><mn id="S8.SS1.SSS2.p1.3.m3.2.2.2.2.2" xref="S8.SS1.SSS2.p1.3.m3.2.2.2.2.2.cmml">10</mn></mrow><mo id="S8.SS1.SSS2.p1.3.m3.2.2.2.5" stretchy="false" xref="S8.SS1.SSS2.p1.3.m3.2.2.3.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S8.SS1.SSS2.p1.3.m3.2b"><interval closure="closed" id="S8.SS1.SSS2.p1.3.m3.2.2.3.cmml" xref="S8.SS1.SSS2.p1.3.m3.2.2.2"><apply id="S8.SS1.SSS2.p1.3.m3.1.1.1.1.cmml" xref="S8.SS1.SSS2.p1.3.m3.1.1.1.1"><minus id="S8.SS1.SSS2.p1.3.m3.1.1.1.1.1.cmml" xref="S8.SS1.SSS2.p1.3.m3.1.1.1.1"></minus><cn id="S8.SS1.SSS2.p1.3.m3.1.1.1.1.2.cmml" type="integer" xref="S8.SS1.SSS2.p1.3.m3.1.1.1.1.2">10</cn></apply><apply id="S8.SS1.SSS2.p1.3.m3.2.2.2.2.cmml" xref="S8.SS1.SSS2.p1.3.m3.2.2.2.2"><plus id="S8.SS1.SSS2.p1.3.m3.2.2.2.2.1.cmml" xref="S8.SS1.SSS2.p1.3.m3.2.2.2.2"></plus><cn id="S8.SS1.SSS2.p1.3.m3.2.2.2.2.2.cmml" type="integer" xref="S8.SS1.SSS2.p1.3.m3.2.2.2.2.2">10</cn></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S8.SS1.SSS2.p1.3.m3.2c">[-10,+10]</annotation><annotation encoding="application/x-llamapun" id="S8.SS1.SSS2.p1.3.m3.2d">[ - 10 , + 10 ]</annotation></semantics></math> cm for finger displacements.
Reference end-effector positions are obtained by applying the displacements to the current positions.
During downstream training, the size of the action space of the orchestrator is the number of primitives or the size of the latent space for Skill Learning baselines.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S8.SS1.SSS3">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span class="ltx_text" id="S8.SS1.SSS3.4.1.1">VIII-A</span>3 </span>Reward</h4>
<div class="ltx_para" id="S8.SS1.SSS3.p1">
<p class="ltx_p" id="S8.SS1.SSS3.p1.3">We use sparse rewards.
During pre-training, we use a comparable adversarial reward structure as used in <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04855v1#bib.bib19" title="">19</a>]</cite>.
On the one hand, Bob is rewarded for solving the task at the moment the task is solved.
On the other hand, Alice is rewarded at the end of each episode and gets a reward <math alttext="r_{\text{valid}}=+1" class="ltx_Math" display="inline" id="S8.SS1.SSS3.p1.1.m1.1"><semantics id="S8.SS1.SSS3.p1.1.m1.1a"><mrow id="S8.SS1.SSS3.p1.1.m1.1.1" xref="S8.SS1.SSS3.p1.1.m1.1.1.cmml"><msub id="S8.SS1.SSS3.p1.1.m1.1.1.2" xref="S8.SS1.SSS3.p1.1.m1.1.1.2.cmml"><mi id="S8.SS1.SSS3.p1.1.m1.1.1.2.2" xref="S8.SS1.SSS3.p1.1.m1.1.1.2.2.cmml">r</mi><mtext id="S8.SS1.SSS3.p1.1.m1.1.1.2.3" xref="S8.SS1.SSS3.p1.1.m1.1.1.2.3a.cmml">valid</mtext></msub><mo id="S8.SS1.SSS3.p1.1.m1.1.1.1" xref="S8.SS1.SSS3.p1.1.m1.1.1.1.cmml">=</mo><mrow id="S8.SS1.SSS3.p1.1.m1.1.1.3" xref="S8.SS1.SSS3.p1.1.m1.1.1.3.cmml"><mo id="S8.SS1.SSS3.p1.1.m1.1.1.3a" xref="S8.SS1.SSS3.p1.1.m1.1.1.3.cmml">+</mo><mn id="S8.SS1.SSS3.p1.1.m1.1.1.3.2" xref="S8.SS1.SSS3.p1.1.m1.1.1.3.2.cmml">1</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S8.SS1.SSS3.p1.1.m1.1b"><apply id="S8.SS1.SSS3.p1.1.m1.1.1.cmml" xref="S8.SS1.SSS3.p1.1.m1.1.1"><eq id="S8.SS1.SSS3.p1.1.m1.1.1.1.cmml" xref="S8.SS1.SSS3.p1.1.m1.1.1.1"></eq><apply id="S8.SS1.SSS3.p1.1.m1.1.1.2.cmml" xref="S8.SS1.SSS3.p1.1.m1.1.1.2"><csymbol cd="ambiguous" id="S8.SS1.SSS3.p1.1.m1.1.1.2.1.cmml" xref="S8.SS1.SSS3.p1.1.m1.1.1.2">subscript</csymbol><ci id="S8.SS1.SSS3.p1.1.m1.1.1.2.2.cmml" xref="S8.SS1.SSS3.p1.1.m1.1.1.2.2">𝑟</ci><ci id="S8.SS1.SSS3.p1.1.m1.1.1.2.3a.cmml" xref="S8.SS1.SSS3.p1.1.m1.1.1.2.3"><mtext id="S8.SS1.SSS3.p1.1.m1.1.1.2.3.cmml" mathsize="70%" xref="S8.SS1.SSS3.p1.1.m1.1.1.2.3">valid</mtext></ci></apply><apply id="S8.SS1.SSS3.p1.1.m1.1.1.3.cmml" xref="S8.SS1.SSS3.p1.1.m1.1.1.3"><plus id="S8.SS1.SSS3.p1.1.m1.1.1.3.1.cmml" xref="S8.SS1.SSS3.p1.1.m1.1.1.3"></plus><cn id="S8.SS1.SSS3.p1.1.m1.1.1.3.2.cmml" type="integer" xref="S8.SS1.SSS3.p1.1.m1.1.1.3.2">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S8.SS1.SSS3.p1.1.m1.1c">r_{\text{valid}}=+1</annotation><annotation encoding="application/x-llamapun" id="S8.SS1.SSS3.p1.1.m1.1d">italic_r start_POSTSUBSCRIPT valid end_POSTSUBSCRIPT = + 1</annotation></semantics></math> if it proposes a valid goal.
A goal position is valid if it is defined in the workspace, and if such position is different from the initial position of the object.
If the goal is valid, Alice gets an additional reward <math alttext="r_{\text{difficult}}=5" class="ltx_Math" display="inline" id="S8.SS1.SSS3.p1.2.m2.1"><semantics id="S8.SS1.SSS3.p1.2.m2.1a"><mrow id="S8.SS1.SSS3.p1.2.m2.1.1" xref="S8.SS1.SSS3.p1.2.m2.1.1.cmml"><msub id="S8.SS1.SSS3.p1.2.m2.1.1.2" xref="S8.SS1.SSS3.p1.2.m2.1.1.2.cmml"><mi id="S8.SS1.SSS3.p1.2.m2.1.1.2.2" xref="S8.SS1.SSS3.p1.2.m2.1.1.2.2.cmml">r</mi><mtext id="S8.SS1.SSS3.p1.2.m2.1.1.2.3" xref="S8.SS1.SSS3.p1.2.m2.1.1.2.3a.cmml">difficult</mtext></msub><mo id="S8.SS1.SSS3.p1.2.m2.1.1.1" xref="S8.SS1.SSS3.p1.2.m2.1.1.1.cmml">=</mo><mn id="S8.SS1.SSS3.p1.2.m2.1.1.3" xref="S8.SS1.SSS3.p1.2.m2.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="S8.SS1.SSS3.p1.2.m2.1b"><apply id="S8.SS1.SSS3.p1.2.m2.1.1.cmml" xref="S8.SS1.SSS3.p1.2.m2.1.1"><eq id="S8.SS1.SSS3.p1.2.m2.1.1.1.cmml" xref="S8.SS1.SSS3.p1.2.m2.1.1.1"></eq><apply id="S8.SS1.SSS3.p1.2.m2.1.1.2.cmml" xref="S8.SS1.SSS3.p1.2.m2.1.1.2"><csymbol cd="ambiguous" id="S8.SS1.SSS3.p1.2.m2.1.1.2.1.cmml" xref="S8.SS1.SSS3.p1.2.m2.1.1.2">subscript</csymbol><ci id="S8.SS1.SSS3.p1.2.m2.1.1.2.2.cmml" xref="S8.SS1.SSS3.p1.2.m2.1.1.2.2">𝑟</ci><ci id="S8.SS1.SSS3.p1.2.m2.1.1.2.3a.cmml" xref="S8.SS1.SSS3.p1.2.m2.1.1.2.3"><mtext id="S8.SS1.SSS3.p1.2.m2.1.1.2.3.cmml" mathsize="70%" xref="S8.SS1.SSS3.p1.2.m2.1.1.2.3">difficult</mtext></ci></apply><cn id="S8.SS1.SSS3.p1.2.m2.1.1.3.cmml" type="integer" xref="S8.SS1.SSS3.p1.2.m2.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S8.SS1.SSS3.p1.2.m2.1c">r_{\text{difficult}}=5</annotation><annotation encoding="application/x-llamapun" id="S8.SS1.SSS3.p1.2.m2.1d">italic_r start_POSTSUBSCRIPT difficult end_POSTSUBSCRIPT = 5</annotation></semantics></math> if Bob fails to solve the task or <math alttext="r_{\text{difficult}}=0" class="ltx_Math" display="inline" id="S8.SS1.SSS3.p1.3.m3.1"><semantics id="S8.SS1.SSS3.p1.3.m3.1a"><mrow id="S8.SS1.SSS3.p1.3.m3.1.1" xref="S8.SS1.SSS3.p1.3.m3.1.1.cmml"><msub id="S8.SS1.SSS3.p1.3.m3.1.1.2" xref="S8.SS1.SSS3.p1.3.m3.1.1.2.cmml"><mi id="S8.SS1.SSS3.p1.3.m3.1.1.2.2" xref="S8.SS1.SSS3.p1.3.m3.1.1.2.2.cmml">r</mi><mtext id="S8.SS1.SSS3.p1.3.m3.1.1.2.3" xref="S8.SS1.SSS3.p1.3.m3.1.1.2.3a.cmml">difficult</mtext></msub><mo id="S8.SS1.SSS3.p1.3.m3.1.1.1" xref="S8.SS1.SSS3.p1.3.m3.1.1.1.cmml">=</mo><mn id="S8.SS1.SSS3.p1.3.m3.1.1.3" xref="S8.SS1.SSS3.p1.3.m3.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S8.SS1.SSS3.p1.3.m3.1b"><apply id="S8.SS1.SSS3.p1.3.m3.1.1.cmml" xref="S8.SS1.SSS3.p1.3.m3.1.1"><eq id="S8.SS1.SSS3.p1.3.m3.1.1.1.cmml" xref="S8.SS1.SSS3.p1.3.m3.1.1.1"></eq><apply id="S8.SS1.SSS3.p1.3.m3.1.1.2.cmml" xref="S8.SS1.SSS3.p1.3.m3.1.1.2"><csymbol cd="ambiguous" id="S8.SS1.SSS3.p1.3.m3.1.1.2.1.cmml" xref="S8.SS1.SSS3.p1.3.m3.1.1.2">subscript</csymbol><ci id="S8.SS1.SSS3.p1.3.m3.1.1.2.2.cmml" xref="S8.SS1.SSS3.p1.3.m3.1.1.2.2">𝑟</ci><ci id="S8.SS1.SSS3.p1.3.m3.1.1.2.3a.cmml" xref="S8.SS1.SSS3.p1.3.m3.1.1.2.3"><mtext id="S8.SS1.SSS3.p1.3.m3.1.1.2.3.cmml" mathsize="70%" xref="S8.SS1.SSS3.p1.3.m3.1.1.2.3">difficult</mtext></ci></apply><cn id="S8.SS1.SSS3.p1.3.m3.1.1.3.cmml" type="integer" xref="S8.SS1.SSS3.p1.3.m3.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S8.SS1.SSS3.p1.3.m3.1c">r_{\text{difficult}}=0</annotation><annotation encoding="application/x-llamapun" id="S8.SS1.SSS3.p1.3.m3.1d">italic_r start_POSTSUBSCRIPT difficult end_POSTSUBSCRIPT = 0</annotation></semantics></math> if Bob succeeds.
During downstream training, the agent is rewarded at every step where an object is on its target.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S8.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S8.SS2.4.1.1">VIII-B</span> </span><span class="ltx_text ltx_font_italic" id="S8.SS2.5.2">Implementation Details</span>
</h3>
<div class="ltx_para" id="S8.SS2.p1">
<p class="ltx_p" id="S8.SS2.p1.1">For pre-training, we use Proximal Policy Optimization (PPO) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04855v1#bib.bib46" title="">46</a>]</cite> to update Alice’s and Bob’s policies as in <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04855v1#bib.bib19" title="">19</a>]</cite>.
We re-implemented PPO as we needed to articulate it with ABC for Bob.
For downstream training, we use the implementation of Soft Actor-Critic <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04855v1#bib.bib47" title="">47</a>]</cite> from Stable Baselines3 <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04855v1#bib.bib48" title="">48</a>]</cite>, for a higher sample efficiency, and compatibility with HER.</p>
</div>
<div class="ltx_para" id="S8.SS2.p2">
<p class="ltx_p" id="S8.SS2.p2.2">To ensure a fair comparison to Skill Learning methods, we set the dimensionality of their skill latent space equal to the number of primitives <math alttext="K" class="ltx_Math" display="inline" id="S8.SS2.p2.1.m1.1"><semantics id="S8.SS2.p2.1.m1.1a"><mi id="S8.SS2.p2.1.m1.1.1" xref="S8.SS2.p2.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S8.SS2.p2.1.m1.1b"><ci id="S8.SS2.p2.1.m1.1.1.cmml" xref="S8.SS2.p2.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S8.SS2.p2.1.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="S8.SS2.p2.1.m1.1d">italic_K</annotation></semantics></math>.
We use <math alttext="K=4" class="ltx_Math" display="inline" id="S8.SS2.p2.2.m2.1"><semantics id="S8.SS2.p2.2.m2.1a"><mrow id="S8.SS2.p2.2.m2.1.1" xref="S8.SS2.p2.2.m2.1.1.cmml"><mi id="S8.SS2.p2.2.m2.1.1.2" xref="S8.SS2.p2.2.m2.1.1.2.cmml">K</mi><mo id="S8.SS2.p2.2.m2.1.1.1" xref="S8.SS2.p2.2.m2.1.1.1.cmml">=</mo><mn id="S8.SS2.p2.2.m2.1.1.3" xref="S8.SS2.p2.2.m2.1.1.3.cmml">4</mn></mrow><annotation-xml encoding="MathML-Content" id="S8.SS2.p2.2.m2.1b"><apply id="S8.SS2.p2.2.m2.1.1.cmml" xref="S8.SS2.p2.2.m2.1.1"><eq id="S8.SS2.p2.2.m2.1.1.1.cmml" xref="S8.SS2.p2.2.m2.1.1.1"></eq><ci id="S8.SS2.p2.2.m2.1.1.2.cmml" xref="S8.SS2.p2.2.m2.1.1.2">𝐾</ci><cn id="S8.SS2.p2.2.m2.1.1.3.cmml" type="integer" xref="S8.SS2.p2.2.m2.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S8.SS2.p2.2.m2.1c">K=4</annotation><annotation encoding="application/x-llamapun" id="S8.SS2.p2.2.m2.1d">italic_K = 4</annotation></semantics></math> for all experiments as we did not find that a higher number helped significantly on the evaluated tasks.</p>
</div>
</section>
</section>
<section class="ltx_section" id="Sx1">
<h2 class="ltx_title ltx_font_smallcaps ltx_title_section">ACKNOWLEDGMENT</h2>
<div class="ltx_para" id="Sx1.p1">
<p class="ltx_p" id="Sx1.p1.1">We thank Jean-Michel Renders, David Emukpere, and Seungsu Kim for their thoughtful feedback.</p>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
M. Riedmiller, R. Hafner, T. Lampe, M. Neunert, J. Degrave, T. V. de Wiele,
V. Mnih, N. Heess, and J. T. Springenberg, “Learning by playing - solving
sparse reward tasks from scratch,” 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
M. Vecerik, T. Hester, J. Scholz, F. Wang, O. Pietquin, B. Piot, N. Heess,
T. Rothörl, T. Lampe, and M. Riedmiller, “Leveraging demonstrations for
deep reinforcement learning on robotics problems with sparse rewards,” 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
I. Popov, N. Heess, T. Lillicrap, R. Hafner, G. Barth-Maron, M. Vecerik,
T. Lampe, Y. Tassa, T. Erez, and M. Riedmiller, “Data-efficient deep
reinforcement learning for dexterous manipulation,” <em class="ltx_emph ltx_font_italic" id="bib.bib3.1.1">arXiv preprint
arXiv:1704.03073</em>, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
T. Yu, D. Quillen, Z. He, R. Julian, K. Hausman, C. Finn, and S. Levine,
“Meta-world: A benchmark and evaluation for multi-task and meta
reinforcement learning,” in <em class="ltx_emph ltx_font_italic" id="bib.bib4.1.1">Conference on Robot Learning</em>, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
M. Andrychowicz, F. Wolski, A. Ray, J. Schneider, R. Fong, P. Welinder,
B. McGrew, J. Tobin, P. Abbeel, and W. Zaremba, “Hindsight experience
replay,” in <em class="ltx_emph ltx_font_italic" id="bib.bib5.1.1">Advances in neural information processing systems</em>, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
A. Nair, B. McGrew, M. Andrychowicz, W. Zaremba, and P. Abbeel, “Overcoming
exploration in reinforcement learning with demonstrations,” in <em class="ltx_emph ltx_font_italic" id="bib.bib6.1.1">IEEE
International Conference on Robotics and Automation (ICRA)</em>, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
B. Eysenbach, A. Gupta, J. Ibarz, and S. Levine, “Diversity is all you need:
Learning skills without a reward function,” in <em class="ltx_emph ltx_font_italic" id="bib.bib7.1.1">ICLR</em>, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
A. Sharma, S. S. Gu, S. Levine, V. Kumar, and K. Hausman, “Dynamics-aware
unsupervised skill discovery,” in <em class="ltx_emph ltx_font_italic" id="bib.bib8.1.1">ICLR 2020</em>, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
J. Achiam, H. Edwards, D. Amodei, and P. Abbeel, “Variational option discovery
algorithms,” <em class="ltx_emph ltx_font_italic" id="bib.bib9.1.1">arXiv preprint arXiv:1807.10299</em>, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
K. Gregor, D. J. Rezende, and D. Wierstra, “Variational intrinsic control,”
<em class="ltx_emph ltx_font_italic" id="bib.bib10.1.1">arXiv preprint arXiv:1611.07507</em>, 2016.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
D. Warde-Farley, T. Van de Wiele, T. Kulkarni, C. Ionescu, S. Hansen, and
V. Mnih, “Unsupervised control through non-parametric discriminative
rewards,” in <em class="ltx_emph ltx_font_italic" id="bib.bib11.1.1">ICLR</em>, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
V. H. Pong, M. Dalal, S. Lin, A. Nair, S. Bahl, and S. Levine, “Skew-fit:
State-covering self-supervised reinforcement learning,” <em class="ltx_emph ltx_font_italic" id="bib.bib12.1.1">arXiv preprint
arXiv:1903.03698</em>, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
S. Park, J. Choi, J. Kim, H. Lee, and G. Kim, “Lipschitz-constrained
unsupervised skill discovery,” in <em class="ltx_emph ltx_font_italic" id="bib.bib13.1.1">International Conference on Learning
Representations</em>, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
S. Park, K. Lee, Y. Lee, and P. Abbeel, “Controllability-aware unsupervised
skill discovery,” in <em class="ltx_emph ltx_font_italic" id="bib.bib14.1.1">Proceedings of the 40th International Conference
on Machine Learning</em>, ser. Proceedings of Machine Learning Research,
A. Krause, E. Brunskill, K. Cho, B. Engelhardt, S. Sabato, and J. Scarlett,
Eds., vol. 202.   PMLR, 23–29 Jul 2023,
pp. 27 225–27 245. [Online]. Available:
https://proceedings.mlr.press/v202/park23h.html

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
M. Laskin, H. Liu, X. B. Peng, D. Yarats, A. Rajeswaran, and P. Abbeel,
“Unsupervised reinforcement learning with contrastive intrinsic control,”
<em class="ltx_emph ltx_font_italic" id="bib.bib15.1.1">Advances in Neural Information Processing Systems</em>, vol. 35, pp.
34 478–34 491, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
V. Campos, A. Trott, C. Xiong, R. Socher, X. Giró-i Nieto, and J. Torres,
“Explore, discover and learn: Unsupervised discovery of state-covering
skills,” in <em class="ltx_emph ltx_font_italic" id="bib.bib16.1.1">International Conference on Machine Learning</em>.   PMLR, 2020, pp. 1317–1327.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
S. Sukhbaatar, Z. Lin, I. Kostrikov, G. Synnaeve, A. Szlam, and R. Fergus,
“Intrinsic motivation and automatic curricula via asymmetric self-play,” in
<em class="ltx_emph ltx_font_italic" id="bib.bib17.1.1">International Conference on Learning Representations</em>, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
S. Sukhbaatar, E. Denton, A. Szlam, and R. Fergus, “Learning goal embeddings
via self-play for hierarchical reinforcement learning,” <em class="ltx_emph ltx_font_italic" id="bib.bib18.1.1">arXiv preprint
arXiv:1811.09083</em>, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
O. OpenAI, M. Plappert, R. Sampedro, T. Xu, I. Akkaya, V. Kosaraju,
P. Welinder, R. D’Sa, A. Petron, H. P. de Oliveira Pinto, A. Paino, H. Noh,
L. Weng, Q. Yuan, C. Chu, and W. Zaremba, “Asymmetric self-play for
automatic goal discovery in robotic manipulation,” <em class="ltx_emph ltx_font_italic" id="bib.bib19.1.1">ArXiv</em>, vol.
abs/2101.04882, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">
X. B. Peng, M. Chang, G. H. Zhang, P. Abbeel, and S. Levine, “Mcp: Learning
composable hierarchical control with multiplicative compositional policies,”
in <em class="ltx_emph ltx_font_italic" id="bib.bib20.1.1">NeurIPS</em>, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock">
M. Stolle and D. Precup, “Learning options in reinforcement learning,” in
<em class="ltx_emph ltx_font_italic" id="bib.bib21.1.1">Abstraction, Reformulation, and Approximation: 5th International
Symposium, SARA 2002 Kananaskis, Alberta, Canada August 2–4, 2002
Proceedings 5</em>.   Springer, 2002, pp.
212–223.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock">
P.-L. Bacon, J. Harb, and D. Precup, “The option-critic architecture,” in
<em class="ltx_emph ltx_font_italic" id="bib.bib22.1.1">Proceedings of the AAAI conference on artificial intelligence</em>,
vol. 31, no. 1, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock">
A. Barreto, D. Borsa, S. Hou, G. Comanici, E. Aygün, P. Hamel, D. Toyama,
J. J. Hunt, S. Mourad, D. Silver, and D. Precup, “The option keyboard:
Combining skills in reinforcement learning,” <em class="ltx_emph ltx_font_italic" id="bib.bib23.1.1">CoRR</em>, vol.
abs/2106.13105, 2021. [Online]. Available:
https://arxiv.org/abs/2106.13105

</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock">
D. Cho, J. Kim, and H. J. Kim, “Unsupervised reinforcement learning for
transferable manipulation skill discovery,” <em class="ltx_emph ltx_font_italic" id="bib.bib24.1.1">IEEE Robotics and
Automation Letters</em>, vol. 7, no. 3, pp. 7455–7462, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock">
C. Florensa, D. Held, M. Wulfmeier, M. Zhang, and P. Abbeel, “Reverse
curriculum generation for reinforcement learning,” in <em class="ltx_emph ltx_font_italic" id="bib.bib25.1.1">Conference on
Robot Learning</em>, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock">
T. Salimans and R. Chen, “Learning montezuma’s revenge from a single
demonstration,” <em class="ltx_emph ltx_font_italic" id="bib.bib26.1.1">arXiv preprint arXiv:1812.03381</em>, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock">
T. Matiisen, A. Oliver, T. Cohen, and J. Schulman, “Teacher-student curriculum
learning,” <em class="ltx_emph ltx_font_italic" id="bib.bib27.1.1">IEEE transactions on neural networks and learning systems</em>,
2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock">
Y. Zhang, P. Abbeel, and L. Pinto, “Automatic curriculum learning through
value disagreement,” <em class="ltx_emph ltx_font_italic" id="bib.bib28.1.1">arXiv preprint arXiv:2006.09641</em>, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock">
R. Portelas, C. Colas, K. Hofmann, and P.-Y. Oudeyer, “Teacher algorithms for
curriculum learning of deep rl in continuously parameterized environments,”
in <em class="ltx_emph ltx_font_italic" id="bib.bib29.1.1">Conference on Robot Learning</em>.   PMLR, 2020, pp. 835–853.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock">
P.-Y. Oudeyer, F. Kaplan, and V. V. Hafner, “Intrinsic motivation systems for
autonomous mental development,” <em class="ltx_emph ltx_font_italic" id="bib.bib30.1.1">IEEE transactions on evolutionary
computation</em>, vol. 11, no. 2, pp. 265–286, 2007.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock">
A. Baranes and P.-Y. Oudeyer, “Active learning of inverse models with
intrinsically motivated goal exploration in robots,” <em class="ltx_emph ltx_font_italic" id="bib.bib31.1.1">Robotics and
Autonomous Systems</em>, vol. 61, no. 1, pp. 49–73, 2013.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_tag_bibitem">[32]</span>
<span class="ltx_bibblock">
D. Pathak, P. Agrawal, A. A. Efros, and T. Darrell, “Curiosity-driven
exploration by self-supervised prediction,” in <em class="ltx_emph ltx_font_italic" id="bib.bib32.1.1">Proceedings of the 34th
International Conference on Machine Learning-Volume 70</em>, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_tag_bibitem">[33]</span>
<span class="ltx_bibblock">
Y. Burda, H. Edwards, A. Storkey, and O. Klimov, “Exploration by random
network distillation,” in <em class="ltx_emph ltx_font_italic" id="bib.bib33.1.1">International Conference on Learning
Representations</em>, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_tag_bibitem">[34]</span>
<span class="ltx_bibblock">
A. Ecoffet, J. Huizinga, J. Lehman, K. O. Stanley, and J. Clune, “Go-explore:
a new approach for hard-exploration problems,” <em class="ltx_emph ltx_font_italic" id="bib.bib34.1.1">arXiv preprint
arXiv:1901.10995</em>, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_tag_bibitem">[35]</span>
<span class="ltx_bibblock">
A. Ecoffet, J. Huizinga, J. Lehman, K. O. Stanley, and J. Clune,
“First return, then explore,” <em class="ltx_emph ltx_font_italic" id="bib.bib35.1.1">Nature</em>, vol. 590, pp. 580 – 586,
2020. [Online]. Available:
https://api.semanticscholar.org/CorpusID:216552951

</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_tag_bibitem">[36]</span>
<span class="ltx_bibblock">
J. Oh, Y. Guo, S. Singh, and H. Lee, “Self-imitation learning,” <em class="ltx_emph ltx_font_italic" id="bib.bib36.1.1">arXiv
preprint arXiv:1806.05635</em>, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_tag_bibitem">[37]</span>
<span class="ltx_bibblock">
R. Wang, J. Lehman, J. Clune, and K. O. Stanley, “Paired open-ended
trailblazer (poet): Endlessly generating increasingly complex and diverse
learning environments and their solutions,” <em class="ltx_emph ltx_font_italic" id="bib.bib37.1.1">arXiv preprint
arXiv:1901.01753</em>, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_tag_bibitem">[38]</span>
<span class="ltx_bibblock">
R. Wang, J. Lehman, A. Rawal, J. Zhi, Y. Li, J. Clune, and K. Stanley,
“Enhanced poet: Open-ended reinforcement learning through unbounded
invention of learning challenges and their solutions,” in
<em class="ltx_emph ltx_font_italic" id="bib.bib38.1.1">International Conference on Machine Learning</em>.   PMLR, 2020, pp. 9940–9951.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib39">
<span class="ltx_tag ltx_tag_bibitem">[39]</span>
<span class="ltx_bibblock">
Y. Du, P. Abbeel, and A. Grover, “It takes four to tango: Multiagent selfplay
for automatic curriculum generation,” <em class="ltx_emph ltx_font_italic" id="bib.bib39.1.1">arXiv preprint
arXiv:2202.10608</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib40">
<span class="ltx_tag ltx_tag_bibitem">[40]</span>
<span class="ltx_bibblock">
M. Dennis, N. Jaques, E. Vinitsky, A. Bayen, S. Russell, A. Critch, and
S. Levine, “Emergent complexity and zero-shot transfer via unsupervised
environment design,” <em class="ltx_emph ltx_font_italic" id="bib.bib40.1.1">Advances in neural information processing
systems</em>, vol. 33, pp. 13 049–13 061, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib41">
<span class="ltx_tag ltx_tag_bibitem">[41]</span>
<span class="ltx_bibblock">
J. Parker-Holder, M. Jiang, M. Dennis, M. Samvelyan, J. Foerster,
E. Grefenstette, and T. Rocktäschel, “Evolving curricula with regret-based
environment design,” 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib42">
<span class="ltx_tag ltx_tag_bibitem">[42]</span>
<span class="ltx_bibblock">
K. Fang, Y. Zhu, S. Savarese, and L. Fei-Fei, “Discovering generalizable
skills via automated generation of diverse tasks,” <em class="ltx_emph ltx_font_italic" id="bib.bib42.1.1">arXiv preprint
arXiv:2106.13935</em>, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib43">
<span class="ltx_tag ltx_tag_bibitem">[43]</span>
<span class="ltx_bibblock">
K. Fang, T. Migimatsu, A. Mandlekar, L. Fei-Fei, and J. Bohg, “Active task
randomization: Learning visuomotor skills for sequential manipulation by
proposing feasible and novel tasks,” <em class="ltx_emph ltx_font_italic" id="bib.bib43.1.1">arXiv preprint arXiv:2211.06134</em>,
2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib44">
<span class="ltx_tag ltx_tag_bibitem">[44]</span>
<span class="ltx_bibblock">
M. Jiang, M. Dennis, J. Parker-Holder, J. Foerster, E. Grefenstette, and
T. Rocktäschel, “Replay-guided adversarial environment design,”
<em class="ltx_emph ltx_font_italic" id="bib.bib44.1.1">Advances in Neural Information Processing Systems</em>, vol. 34, pp.
1884–1897, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib45">
<span class="ltx_tag ltx_tag_bibitem">[45]</span>
<span class="ltx_bibblock">
Q. Gallouédec, N. Cazin, E. Dellandréa, and L. Chen, “panda-gym:
Open-Source Goal-Conditioned Environments for Robotic Learning,” <em class="ltx_emph ltx_font_italic" id="bib.bib45.1.1">4th
Robot Learning Workshop: Self-Supervised and Lifelong Learning at NeurIPS</em>,
2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib46">
<span class="ltx_tag ltx_tag_bibitem">[46]</span>
<span class="ltx_bibblock">
J. Schulman, F. Wolski, P. Dhariwal, A. Radford, and O. Klimov, “Proximal
policy optimization algorithms,” <em class="ltx_emph ltx_font_italic" id="bib.bib46.1.1">arXiv preprint arXiv:1707.06347</em>,
2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib47">
<span class="ltx_tag ltx_tag_bibitem">[47]</span>
<span class="ltx_bibblock">
T. Haarnoja, A. Zhou, K. Hartikainen, G. Tucker, S. Ha, J. Tan, V. Kumar,
H. Zhu, A. Gupta, P. Abbeel, <em class="ltx_emph ltx_font_italic" id="bib.bib47.1.1">et al.</em>, “Soft actor-critic algorithms
and applications,” <em class="ltx_emph ltx_font_italic" id="bib.bib47.2.2">arXiv preprint arXiv:1812.05905</em>, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib48">
<span class="ltx_tag ltx_tag_bibitem">[48]</span>
<span class="ltx_bibblock">
A. Raffin, A. Hill, A. Gleave, A. Kanervisto, M. Ernestus, and N. Dormann,
“Stable-baselines3: Reliable reinforcement learning implementations,”
<em class="ltx_emph ltx_font_italic" id="bib.bib48.1.1">Journal of Machine Learning Research</em>, vol. 22, no. 268, pp. 1–8,
2021. [Online]. Available: http://jmlr.org/papers/v22/20-1364.html

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Mon Oct  7 09:05:31 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
