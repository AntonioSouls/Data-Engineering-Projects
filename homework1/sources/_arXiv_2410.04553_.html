<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>Bisimulation metric for Model Predictive Control</title>
<!--Generated on Sun Oct  6 17:12:28 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<base href="/html/2410.04553v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#S1" title="In Bisimulation metric for Model Predictive Control"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#S2" title="In Bisimulation metric for Model Predictive Control"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Related Work</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#S2.SS0.SSS0.Px1" title="In 2 Related Work ‣ Bisimulation metric for Model Predictive Control"><span class="ltx_text ltx_ref_title">Reinforcement Learning</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#S2.SS0.SSS0.Px2" title="In 2 Related Work ‣ Bisimulation metric for Model Predictive Control"><span class="ltx_text ltx_ref_title">Representation Learning</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#S3" title="In Bisimulation metric for Model Predictive Control"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Preliminaries</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#S3.SS1" title="In 3 Preliminaries ‣ Bisimulation metric for Model Predictive Control"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Reinforcement Learning</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#S3.SS2" title="In 3 Preliminaries ‣ Bisimulation metric for Model Predictive Control"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>Bisimulation Metric</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#S4" title="In Bisimulation metric for Model Predictive Control"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Bisimulation metric for model predictive control</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#S4.SS1" title="In 4 Bisimulation metric for model predictive control ‣ Bisimulation metric for Model Predictive Control"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Bisimulation Metric for Model Predictive Control</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#S4.SS1.SSS0.Px1" title="In 4.1 Bisimulation Metric for Model Predictive Control ‣ 4 Bisimulation metric for model predictive control ‣ Bisimulation metric for Model Predictive Control"><span class="ltx_text ltx_ref_title">Components</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#S4.SS1.SSS0.Px2" title="In 4.1 Bisimulation Metric for Model Predictive Control ‣ 4 Bisimulation metric for model predictive control ‣ Bisimulation metric for Model Predictive Control"><span class="ltx_text ltx_ref_title">Objective function</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#S4.SS1.SSS0.Px3" title="In 4.1 Bisimulation Metric for Model Predictive Control ‣ 4 Bisimulation metric for model predictive control ‣ Bisimulation metric for Model Predictive Control"><span class="ltx_text ltx_ref_title">Model Predictive Control with Learned Model</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#S4.SS2" title="In 4 Bisimulation metric for model predictive control ‣ Bisimulation metric for Model Predictive Control"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>Theoretical Analysis</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#S4.SS3" title="In 4 Bisimulation metric for model predictive control ‣ Bisimulation metric for Model Predictive Control"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3 </span>Difference between BS-MPC and TD-MPC</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#S4.SS3.SSS0.Px1" title="In 4.3 Difference between BS-MPC and TD-MPC ‣ 4 Bisimulation metric for model predictive control ‣ Bisimulation metric for Model Predictive Control"><span class="ltx_text ltx_ref_title">Improved training stability</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#S4.SS3.SSS0.Px2" title="In 4.3 Difference between BS-MPC and TD-MPC ‣ 4 Bisimulation metric for model predictive control ‣ Bisimulation metric for Model Predictive Control"><span class="ltx_text ltx_ref_title">Theoretical support of the latent space</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#S4.SS3.SSS0.Px3" title="In 4.3 Difference between BS-MPC and TD-MPC ‣ 4 Bisimulation metric for model predictive control ‣ Bisimulation metric for Model Predictive Control"><span class="ltx_text ltx_ref_title">Ease of parallelization</span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#S5" title="In Bisimulation metric for Model Predictive Control"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Experiments</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#S5.SS1" title="In 5 Experiments ‣ Bisimulation metric for Model Predictive Control"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.1 </span>Result on state-based tasks</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#S5.SS2" title="In 5 Experiments ‣ Bisimulation metric for Model Predictive Control"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.2 </span>Results on image-based tasks</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#S5.SS3" title="In 5 Experiments ‣ Bisimulation metric for Model Predictive Control"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.3 </span>Resutls on Image input with distractions</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#S6" title="In Bisimulation metric for Model Predictive Control"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6 </span>Conclusion</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#S6.SS0.SSS0.Px1" title="In 6 Conclusion ‣ Bisimulation metric for Model Predictive Control"><span class="ltx_text ltx_ref_title">Limitations.</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#A1" title="In Bisimulation metric for Model Predictive Control"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A </span>Proof of Theorem <span class="ltx_text ltx_ref_tag">3</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#A2" title="In Bisimulation metric for Model Predictive Control"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B </span>Additional Experimental Results</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#A2.SS1" title="In Appendix B Additional Experimental Results ‣ Bisimulation metric for Model Predictive Control"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B.1 </span>All state-based tasks result</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#A2.SS2" title="In Appendix B Additional Experimental Results ‣ Bisimulation metric for Model Predictive Control"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B.2 </span>Computational Time</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#A2.SS3" title="In Appendix B Additional Experimental Results ‣ Bisimulation metric for Model Predictive Control"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B.3 </span>Detailed analysis for the failure of TD-MPC</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#A3" title="In Bisimulation metric for Model Predictive Control"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">C </span>BS-MPC training algorithm flow</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#A4" title="In Bisimulation metric for Model Predictive Control"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">D </span>BS-MPC vs TD-MPC2</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#A5" title="In Bisimulation metric for Model Predictive Control"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">E </span>Implementation Details</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#A5.SS1" title="In Appendix E Implementation Details ‣ Bisimulation metric for Model Predictive Control"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">E.1 </span>Hyperparameters</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#A5.SS2" title="In Appendix E Implementation Details ‣ Bisimulation metric for Model Predictive Control"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">E.2 </span>Model Architecture</span></a></li>
</ol>
</li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Bisimulation metric for Model Predictive Control</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Yutaka Shimizu &amp; Masayoshi Tomizuka 
<br class="ltx_break"/>Mechanical Engineering 
<br class="ltx_break"/>University of California, Berkeley 
<br class="ltx_break"/>Berkeley, CA 94720, USA 
<br class="ltx_break"/><span class="ltx_text ltx_font_typewriter" id="id1.1.id1">{purewater0901, tomizuka}@berkeley.edu</span>
<br class="ltx_break"/>
</span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id2.id1">Model-based reinforcement learning has shown promise for improving sample efficiency and decision-making in complex environments. However, existing methods face challenges in training stability, robustness to noise, and computational efficiency. In this paper, we propose Bisimulation Metric for Model Predictive Control (BS-MPC), a novel approach that incorporates bisimulation metric loss in its objective function to directly optimize the encoder. This time-step-wise direct optimization enables the learned encoder to extract intrinsic information from the original state space while discarding irrelevant details and preventing the gradients and errors from diverging. BS-MPC improves training stability, robustness against input noise, and computational efficiency by reducing training time. We evaluate BS-MPC on both continuous control and image-based tasks from the DeepMind Control Suite, demonstrating superior performance and robustness compared to state-of-the-art baseline methods.
Our code is available through <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/purewater0901/BSMPC" title="">https://github.com/purewater0901/BSMPC</a>.</p>
</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>
<div class="ltx_para ltx_noindent" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">Reinforcement learning (RL) has become a central framework for solving complex sequential decision-making problems in diverse fields such as robotics, autonomous driving, and game playing. Among RL methods, model-based reinforcement learning (MBRL) gets its attention thanks to its ability to achieve higher sample efficiency and better generalization. Representation learning further enhances MBRL by encoding high-dimensional information into compact latent spaces, which can accelerate learning by focusing on essential aspects of the environment. However, achieving stable and robust representations remains a challenge, especially in high-dimensional or partially observable environments, where noise and irrelevant features can degrade performance.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">One prominent MBRL method, Temporal Difference Model Predictive Control (TD-MPC) <cite class="ltx_cite ltx_citemacro_citep">(Hansen et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#bib.bib17" title="">2022</a>)</cite>, combines temporal difference learning with model predictive control to improve policy performance by simulating future trajectories in the learned latent space. TD-MPC sets itself apart from other methods by leveraging the learned latent value function as a long-term reward estimate to approximate cumulative rewards, allowing for the efficient computation of optimal actions.
Despite its successes, TD-MPC suffers from several limitations, including instability during training, vulnerability to noise, and expensive computational costs, which are shown in Fig <a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Bisimulation metric for Model Predictive Control"><span class="ltx_text ltx_ref_tag">1</span></a>.
The first graph illustrates TD-MPC’s performance degradation during training, demonstrating a notable collapse after a certain number of steps. The second set of results focuses on an image-based task, where the addition of background noise (adding a completely irrelevant image to the background) led to TD-MPC’s failure to achieve a high reward in the noisy environment. The third picture shows that TD-MPC suffers from a long calculation time.
These problems are attributed to the encoder’s training method and the objective function’s structure.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p3">
<p class="ltx_p" id="S1.p3.2">To address these issues, we introduce Bisimulation Metric for Model Predictive Control (BS-MPC), a new approach that leverages <math alttext="\pi^{*}" class="ltx_Math" display="inline" id="S1.p3.1.m1.1"><semantics id="S1.p3.1.m1.1a"><msup id="S1.p3.1.m1.1.1" xref="S1.p3.1.m1.1.1.cmml"><mi id="S1.p3.1.m1.1.1.2" xref="S1.p3.1.m1.1.1.2.cmml">π</mi><mo id="S1.p3.1.m1.1.1.3" xref="S1.p3.1.m1.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="S1.p3.1.m1.1b"><apply id="S1.p3.1.m1.1.1.cmml" xref="S1.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S1.p3.1.m1.1.1.1.cmml" xref="S1.p3.1.m1.1.1">superscript</csymbol><ci id="S1.p3.1.m1.1.1.2.cmml" xref="S1.p3.1.m1.1.1.2">𝜋</ci><times id="S1.p3.1.m1.1.1.3.cmml" xref="S1.p3.1.m1.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.1.m1.1c">\pi^{*}</annotation><annotation encoding="application/x-llamapun" id="S1.p3.1.m1.1d">italic_π start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math>-bisimulation metric (on-policy bisimulation metric) <cite class="ltx_cite ltx_citemacro_citep">(Zhang et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#bib.bib47" title="">2021</a>)</cite> to improve the stability and robustness of latent space representations. Bisimulation metrics measure behavioral equivalence between states by comparing their immediate rewards and next state distributions, providing a formal way to ensure that the learned latent representations retain meaningful and essential information from the original states.
In BS-MPC, we minimize the mean square error between the on-policy bisimulation metric and <math alttext="\ell_{1}" class="ltx_Math" display="inline" id="S1.p3.2.m2.1"><semantics id="S1.p3.2.m2.1a"><msub id="S1.p3.2.m2.1.1" xref="S1.p3.2.m2.1.1.cmml"><mi id="S1.p3.2.m2.1.1.2" mathvariant="normal" xref="S1.p3.2.m2.1.1.2.cmml">ℓ</mi><mn id="S1.p3.2.m2.1.1.3" xref="S1.p3.2.m2.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S1.p3.2.m2.1b"><apply id="S1.p3.2.m2.1.1.cmml" xref="S1.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S1.p3.2.m2.1.1.1.cmml" xref="S1.p3.2.m2.1.1">subscript</csymbol><ci id="S1.p3.2.m2.1.1.2.cmml" xref="S1.p3.2.m2.1.1.2">ℓ</ci><cn id="S1.p3.2.m2.1.1.3.cmml" type="integer" xref="S1.p3.2.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.2.m2.1c">\ell_{1}</annotation><annotation encoding="application/x-llamapun" id="S1.p3.2.m2.1d">roman_ℓ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math>-distance in latent space at each time step, directly optimizing the encoder to improve stability and noise resistance.
Integration of the bisimulation metric gives BS-MPC a theoretical guarantee, ensuring that the difference in cumulative rewards between the original state space and the learned latent space can be upper-bounded over a trajectory. This value function difference bound validates the fidelity of the encoder projection.
Additionally, the proposed method reduces training time by making the computation of the objective function parallelizable, leading to less computational cost than TD-MPC.
All these performance improvements are also summarized in Fig <a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Bisimulation metric for Model Predictive Control"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">We implement BS-MPC using the Model Predictive Path Integral (MPPI) <cite class="ltx_cite ltx_citemacro_citep">(Williams et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#bib.bib42" title="">2016</a>; <a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#bib.bib43" title="">2018</a>)</cite> framework and evaluate its performance on a variety of continuous control tasks from DeepMind Control Suite <cite class="ltx_cite ltx_citemacro_citep">(Tassa et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#bib.bib39" title="">2018</a>)</cite>. Our results show that BS-MPC outperforms existing model-free and model-based methods in terms of performance and robustness, making it a promising new approach for model-based reinforcement learning.</p>
</div>
<figure class="ltx_figure" id="S1.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="277" id="S1.F1.g1" src="extracted/5905356/figures/tdmpc_open_problems.png" width="548"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Three open problems of TD-MPC. (Left) TD-MPC initially performs well but collapses after 4 million steps, while BS-MPC steadily improves. (Middle) With added distraction in the input image, TD-MPC fails to gain rewards, whereas BS-MPC remains robust. (Right) BS-MPC reduces training time by removing sequential computation in objective function.</figcaption>
</figure>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Work</h2>
<section class="ltx_paragraph" id="S2.SS0.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">Reinforcement Learning</h4>
<div class="ltx_para ltx_noindent" id="S2.SS0.SSS0.Px1.p1">
<p class="ltx_p" id="S2.SS0.SSS0.Px1.p1.1">Reinforcement Learning (RL) <cite class="ltx_cite ltx_citemacro_citep">(Sutton &amp; Barto, <a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#bib.bib38" title="">2018</a>)</cite> has two main approaches: model-free methods <cite class="ltx_cite ltx_citemacro_citep">(Silver et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#bib.bib36" title="">2014</a>; Fujimoto et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#bib.bib7" title="">2018</a>; Haarnoja et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#bib.bib9" title="">2018a</a>; Schulman et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#bib.bib34" title="">2015</a>; <a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#bib.bib35" title="">2017</a>; Kalashnkov et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#bib.bib21" title="">2021</a>; Kalashnikov et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#bib.bib20" title="">2018</a>; Mnih et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#bib.bib32" title="">2015</a>; Hessel et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#bib.bib18" title="">2018</a>; Yarats et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#bib.bib44" title="">2021</a>; <a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#bib.bib45" title="">2022</a>; Laskin et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#bib.bib28" title="">2020</a>)</cite> and model-based methods <cite class="ltx_cite ltx_citemacro_citep">(Sutton, <a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#bib.bib37" title="">1991</a>; Hafner et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#bib.bib13" title="">2020</a>; <a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#bib.bib14" title="">2021</a>; <a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#bib.bib15" title="">2024</a>; Luo et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#bib.bib31" title="">2019</a>; Janner et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#bib.bib19" title="">2019</a>; Chua et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#bib.bib3" title="">2018</a>; Schrittwieser et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#bib.bib33" title="">2019</a>; Wang &amp; Ba, <a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#bib.bib41" title="">2020</a>)</cite>.
While model-free methods focus on learning the value function and policy, model-based methods aim to learn the underlying model of the environment, using this learned model to compute optimal actions.
This paper focuses on the model-based approach, specifically methods that combine planning and MBRL <cite class="ltx_cite ltx_citemacro_citep">(Hansen et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#bib.bib17" title="">2022</a>; <a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#bib.bib16" title="">2024</a>)</cite>, which learns the underlying model in the latent space and applies sampling-based Model Predictive Control (MPC) <cite class="ltx_cite ltx_citemacro_citep">(Williams et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#bib.bib42" title="">2016</a>; Kobilarov, <a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#bib.bib23" title="">2012</a>)</cite> to solve the trajectory optimization problem. Several variants of TD-MPC have been proposed <cite class="ltx_cite ltx_citemacro_citep">(Lancaster et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#bib.bib24" title="">2024</a>; Zhao et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#bib.bib48" title="">2023</a>; Chitnis et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#bib.bib2" title="">2023</a>; Feng et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#bib.bib4" title="">2023</a>; Wan et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#bib.bib40" title="">2024</a>)</cite>, but none fully address all the challenges outlined in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Bisimulation metric for Model Predictive Control"><span class="ltx_text ltx_ref_tag">1</span></a>.
To the best of our knowledge, BS-MPC is the first approach to tackle all three open problems in TD-MPC, as discussed in Section <a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#S1" title="1 Introduction ‣ Bisimulation metric for Model Predictive Control"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
</section>
<section class="ltx_paragraph" id="S2.SS0.SSS0.Px2">
<h4 class="ltx_title ltx_title_paragraph">Representation Learning</h4>
<div class="ltx_para ltx_noindent" id="S2.SS0.SSS0.Px2.p1">
<p class="ltx_p" id="S2.SS0.SSS0.Px2.p1.2">Learning models in the latent space is an efficient way to approximate internal models, especially for image-based tasks. One approach to learning latent space projections is by training both the encoder and decoder to minimize the reconstruction loss <cite class="ltx_cite ltx_citemacro_citep">(Lange &amp; Riedmiller, <a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#bib.bib25" title="">2010</a>; Lange et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#bib.bib26" title="">2012</a>; Hafner et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#bib.bib12" title="">2019</a>; <a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#bib.bib15" title="">2024</a>; Lee et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#bib.bib29" title="">2020</a>)</cite>. However, this method often suffers model errors and instability and has difficulties in long-term predictions. An alternative approach is to train only the encoder to obtain the latent representation. Bisimulation <cite class="ltx_cite ltx_citemacro_citep">(Larsen &amp; Skou, <a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#bib.bib27" title="">1989</a>)</cite> is a state abstraction technique defined in Markov Decision Processes (MDPs) that clusters states producing identical reward sequences for any given action sequence.
<cite class="ltx_cite ltx_citemacro_citet">Ferns et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#bib.bib6" title="">2011</a>); Ferns &amp; Precup (<a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#bib.bib5" title="">2014</a>)</cite> defined a bisimulation metric that measures the similarity between two states based on the Wasserstein distance between their empirically measured transition distributions. However, computing this metric can be computationally expensive in high-dimensional spaces. To address this, <cite class="ltx_cite ltx_citemacro_citet">Castro (<a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#bib.bib1" title="">2020</a>)</cite> proposed an on-policy bisimulation metric, which considers the distribution of future states under the current policy, providing a scalable way to measure state similarity. <cite class="ltx_cite ltx_citemacro_citet">Zhang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#bib.bib47" title="">2021</a>)</cite> extend this idea to <math alttext="\pi^{*}" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px2.p1.1.m1.1"><semantics id="S2.SS0.SSS0.Px2.p1.1.m1.1a"><msup id="S2.SS0.SSS0.Px2.p1.1.m1.1.1" xref="S2.SS0.SSS0.Px2.p1.1.m1.1.1.cmml"><mi id="S2.SS0.SSS0.Px2.p1.1.m1.1.1.2" xref="S2.SS0.SSS0.Px2.p1.1.m1.1.1.2.cmml">π</mi><mo id="S2.SS0.SSS0.Px2.p1.1.m1.1.1.3" xref="S2.SS0.SSS0.Px2.p1.1.m1.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px2.p1.1.m1.1b"><apply id="S2.SS0.SSS0.Px2.p1.1.m1.1.1.cmml" xref="S2.SS0.SSS0.Px2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px2.p1.1.m1.1.1.1.cmml" xref="S2.SS0.SSS0.Px2.p1.1.m1.1.1">superscript</csymbol><ci id="S2.SS0.SSS0.Px2.p1.1.m1.1.1.2.cmml" xref="S2.SS0.SSS0.Px2.p1.1.m1.1.1.2">𝜋</ci><times id="S2.SS0.SSS0.Px2.p1.1.m1.1.1.3.cmml" xref="S2.SS0.SSS0.Px2.p1.1.m1.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px2.p1.1.m1.1c">\pi^{*}</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px2.p1.1.m1.1d">italic_π start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math>-bisimulation metric by minimizing
MSE loss between bisimulation metric and <math alttext="\ell_{1}" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px2.p1.2.m2.1"><semantics id="S2.SS0.SSS0.Px2.p1.2.m2.1a"><msub id="S2.SS0.SSS0.Px2.p1.2.m2.1.1" xref="S2.SS0.SSS0.Px2.p1.2.m2.1.1.cmml"><mi id="S2.SS0.SSS0.Px2.p1.2.m2.1.1.2" mathvariant="normal" xref="S2.SS0.SSS0.Px2.p1.2.m2.1.1.2.cmml">ℓ</mi><mn id="S2.SS0.SSS0.Px2.p1.2.m2.1.1.3" xref="S2.SS0.SSS0.Px2.p1.2.m2.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px2.p1.2.m2.1b"><apply id="S2.SS0.SSS0.Px2.p1.2.m2.1.1.cmml" xref="S2.SS0.SSS0.Px2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px2.p1.2.m2.1.1.1.cmml" xref="S2.SS0.SSS0.Px2.p1.2.m2.1.1">subscript</csymbol><ci id="S2.SS0.SSS0.Px2.p1.2.m2.1.1.2.cmml" xref="S2.SS0.SSS0.Px2.p1.2.m2.1.1.2">ℓ</ci><cn id="S2.SS0.SSS0.Px2.p1.2.m2.1.1.3.cmml" type="integer" xref="S2.SS0.SSS0.Px2.p1.2.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px2.p1.2.m2.1c">\ell_{1}</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px2.p1.2.m2.1d">roman_ℓ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math>-distance in latent space to train the encoder. Following this approach, we use the on-policy bisimulation metric to train the encoder in model-based reinforcement learning architecture.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Preliminaries</h2>
<div class="ltx_para ltx_noindent" id="S3.p1">
<p class="ltx_p" id="S3.p1.1">This section provides a brief introduction to reinforcement learning and its associated notations, along with an explanation of bisimulation concepts.</p>
</div>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Reinforcement Learning</h3>
<div class="ltx_para ltx_noindent" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.10">Reinforcement Learning (RL) aims to optimize agents that interact with a Markov Decision Process (MDP) defined by a tuple <math alttext="({\mathcal{S}},{\mathcal{A}},\mathcal{P},{\mathcal{R}},\rho_{0},\gamma)" class="ltx_Math" display="inline" id="S3.SS1.p1.1.m1.6"><semantics id="S3.SS1.p1.1.m1.6a"><mrow id="S3.SS1.p1.1.m1.6.6.1" xref="S3.SS1.p1.1.m1.6.6.2.cmml"><mo id="S3.SS1.p1.1.m1.6.6.1.2" stretchy="false" xref="S3.SS1.p1.1.m1.6.6.2.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml">𝒮</mi><mo id="S3.SS1.p1.1.m1.6.6.1.3" xref="S3.SS1.p1.1.m1.6.6.2.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.1.m1.2.2" xref="S3.SS1.p1.1.m1.2.2.cmml">𝒜</mi><mo id="S3.SS1.p1.1.m1.6.6.1.4" xref="S3.SS1.p1.1.m1.6.6.2.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.1.m1.3.3" xref="S3.SS1.p1.1.m1.3.3.cmml">𝒫</mi><mo id="S3.SS1.p1.1.m1.6.6.1.5" xref="S3.SS1.p1.1.m1.6.6.2.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.1.m1.4.4" xref="S3.SS1.p1.1.m1.4.4.cmml">ℛ</mi><mo id="S3.SS1.p1.1.m1.6.6.1.6" xref="S3.SS1.p1.1.m1.6.6.2.cmml">,</mo><msub id="S3.SS1.p1.1.m1.6.6.1.1" xref="S3.SS1.p1.1.m1.6.6.1.1.cmml"><mi id="S3.SS1.p1.1.m1.6.6.1.1.2" xref="S3.SS1.p1.1.m1.6.6.1.1.2.cmml">ρ</mi><mn id="S3.SS1.p1.1.m1.6.6.1.1.3" xref="S3.SS1.p1.1.m1.6.6.1.1.3.cmml">0</mn></msub><mo id="S3.SS1.p1.1.m1.6.6.1.7" xref="S3.SS1.p1.1.m1.6.6.2.cmml">,</mo><mi id="S3.SS1.p1.1.m1.5.5" xref="S3.SS1.p1.1.m1.5.5.cmml">γ</mi><mo id="S3.SS1.p1.1.m1.6.6.1.8" stretchy="false" xref="S3.SS1.p1.1.m1.6.6.2.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.6b"><vector id="S3.SS1.p1.1.m1.6.6.2.cmml" xref="S3.SS1.p1.1.m1.6.6.1"><ci id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">𝒮</ci><ci id="S3.SS1.p1.1.m1.2.2.cmml" xref="S3.SS1.p1.1.m1.2.2">𝒜</ci><ci id="S3.SS1.p1.1.m1.3.3.cmml" xref="S3.SS1.p1.1.m1.3.3">𝒫</ci><ci id="S3.SS1.p1.1.m1.4.4.cmml" xref="S3.SS1.p1.1.m1.4.4">ℛ</ci><apply id="S3.SS1.p1.1.m1.6.6.1.1.cmml" xref="S3.SS1.p1.1.m1.6.6.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.6.6.1.1.1.cmml" xref="S3.SS1.p1.1.m1.6.6.1.1">subscript</csymbol><ci id="S3.SS1.p1.1.m1.6.6.1.1.2.cmml" xref="S3.SS1.p1.1.m1.6.6.1.1.2">𝜌</ci><cn id="S3.SS1.p1.1.m1.6.6.1.1.3.cmml" type="integer" xref="S3.SS1.p1.1.m1.6.6.1.1.3">0</cn></apply><ci id="S3.SS1.p1.1.m1.5.5.cmml" xref="S3.SS1.p1.1.m1.5.5">𝛾</ci></vector></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.6c">({\mathcal{S}},{\mathcal{A}},\mathcal{P},{\mathcal{R}},\rho_{0},\gamma)</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.1.m1.6d">( caligraphic_S , caligraphic_A , caligraphic_P , caligraphic_R , italic_ρ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , italic_γ )</annotation></semantics></math>, where <math alttext="{\mathcal{S}}" class="ltx_Math" display="inline" id="S3.SS1.p1.2.m2.1"><semantics id="S3.SS1.p1.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.2.m2.1.1" xref="S3.SS1.p1.2.m2.1.1.cmml">𝒮</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.1b"><ci id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1">𝒮</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.1c">{\mathcal{S}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.2.m2.1d">caligraphic_S</annotation></semantics></math> represents the set of all possible states, <math alttext="{\mathcal{A}}" class="ltx_Math" display="inline" id="S3.SS1.p1.3.m3.1"><semantics id="S3.SS1.p1.3.m3.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.3.m3.1.1" xref="S3.SS1.p1.3.m3.1.1.cmml">𝒜</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.1b"><ci id="S3.SS1.p1.3.m3.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1">𝒜</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.1c">{\mathcal{A}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.3.m3.1d">caligraphic_A</annotation></semantics></math> is the set of possible actions, <math alttext="{\mathcal{R}}" class="ltx_Math" display="inline" id="S3.SS1.p1.4.m4.1"><semantics id="S3.SS1.p1.4.m4.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.4.m4.1.1" xref="S3.SS1.p1.4.m4.1.1.cmml">ℛ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m4.1b"><ci id="S3.SS1.p1.4.m4.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1">ℛ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m4.1c">{\mathcal{R}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.4.m4.1d">caligraphic_R</annotation></semantics></math> is a reward function, <math alttext="\rho_{0}" class="ltx_Math" display="inline" id="S3.SS1.p1.5.m5.1"><semantics id="S3.SS1.p1.5.m5.1a"><msub id="S3.SS1.p1.5.m5.1.1" xref="S3.SS1.p1.5.m5.1.1.cmml"><mi id="S3.SS1.p1.5.m5.1.1.2" xref="S3.SS1.p1.5.m5.1.1.2.cmml">ρ</mi><mn id="S3.SS1.p1.5.m5.1.1.3" xref="S3.SS1.p1.5.m5.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.m5.1b"><apply id="S3.SS1.p1.5.m5.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.5.m5.1.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1">subscript</csymbol><ci id="S3.SS1.p1.5.m5.1.1.2.cmml" xref="S3.SS1.p1.5.m5.1.1.2">𝜌</ci><cn id="S3.SS1.p1.5.m5.1.1.3.cmml" type="integer" xref="S3.SS1.p1.5.m5.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.5.m5.1c">\rho_{0}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.5.m5.1d">italic_ρ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math> is the initial state distribution, and <math alttext="\gamma" class="ltx_Math" display="inline" id="S3.SS1.p1.6.m6.1"><semantics id="S3.SS1.p1.6.m6.1a"><mi id="S3.SS1.p1.6.m6.1.1" xref="S3.SS1.p1.6.m6.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.6.m6.1b"><ci id="S3.SS1.p1.6.m6.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.6.m6.1c">\gamma</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.6.m6.1d">italic_γ</annotation></semantics></math> is the discount factor. When action <math alttext="a\in{\mathcal{A}}" class="ltx_Math" display="inline" id="S3.SS1.p1.7.m7.1"><semantics id="S3.SS1.p1.7.m7.1a"><mrow id="S3.SS1.p1.7.m7.1.1" xref="S3.SS1.p1.7.m7.1.1.cmml"><mi id="S3.SS1.p1.7.m7.1.1.2" xref="S3.SS1.p1.7.m7.1.1.2.cmml">a</mi><mo id="S3.SS1.p1.7.m7.1.1.1" xref="S3.SS1.p1.7.m7.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.7.m7.1.1.3" xref="S3.SS1.p1.7.m7.1.1.3.cmml">𝒜</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.7.m7.1b"><apply id="S3.SS1.p1.7.m7.1.1.cmml" xref="S3.SS1.p1.7.m7.1.1"><in id="S3.SS1.p1.7.m7.1.1.1.cmml" xref="S3.SS1.p1.7.m7.1.1.1"></in><ci id="S3.SS1.p1.7.m7.1.1.2.cmml" xref="S3.SS1.p1.7.m7.1.1.2">𝑎</ci><ci id="S3.SS1.p1.7.m7.1.1.3.cmml" xref="S3.SS1.p1.7.m7.1.1.3">𝒜</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.7.m7.1c">a\in{\mathcal{A}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.7.m7.1d">italic_a ∈ caligraphic_A</annotation></semantics></math> is executed at state <math alttext="s\in{\mathcal{S}}" class="ltx_Math" display="inline" id="S3.SS1.p1.8.m8.1"><semantics id="S3.SS1.p1.8.m8.1a"><mrow id="S3.SS1.p1.8.m8.1.1" xref="S3.SS1.p1.8.m8.1.1.cmml"><mi id="S3.SS1.p1.8.m8.1.1.2" xref="S3.SS1.p1.8.m8.1.1.2.cmml">s</mi><mo id="S3.SS1.p1.8.m8.1.1.1" xref="S3.SS1.p1.8.m8.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.8.m8.1.1.3" xref="S3.SS1.p1.8.m8.1.1.3.cmml">𝒮</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.8.m8.1b"><apply id="S3.SS1.p1.8.m8.1.1.cmml" xref="S3.SS1.p1.8.m8.1.1"><in id="S3.SS1.p1.8.m8.1.1.1.cmml" xref="S3.SS1.p1.8.m8.1.1.1"></in><ci id="S3.SS1.p1.8.m8.1.1.2.cmml" xref="S3.SS1.p1.8.m8.1.1.2">𝑠</ci><ci id="S3.SS1.p1.8.m8.1.1.3.cmml" xref="S3.SS1.p1.8.m8.1.1.3">𝒮</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.8.m8.1c">s\in{\mathcal{S}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.8.m8.1d">italic_s ∈ caligraphic_S</annotation></semantics></math>, the next state is generated according to <math alttext="s^{\prime}\sim\mathcal{P}(\cdot|s,a)" class="ltx_math_unparsed" display="inline" id="S3.SS1.p1.9.m9.1"><semantics id="S3.SS1.p1.9.m9.1a"><mrow id="S3.SS1.p1.9.m9.1b"><msup id="S3.SS1.p1.9.m9.1.1"><mi id="S3.SS1.p1.9.m9.1.1.2">s</mi><mo id="S3.SS1.p1.9.m9.1.1.3">′</mo></msup><mo id="S3.SS1.p1.9.m9.1.2">∼</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.9.m9.1.3">𝒫</mi><mrow id="S3.SS1.p1.9.m9.1.4"><mo id="S3.SS1.p1.9.m9.1.4.1" stretchy="false">(</mo><mo id="S3.SS1.p1.9.m9.1.4.2" lspace="0em" rspace="0em">⋅</mo><mo fence="false" id="S3.SS1.p1.9.m9.1.4.3" rspace="0.167em" stretchy="false">|</mo><mi id="S3.SS1.p1.9.m9.1.4.4">s</mi><mo id="S3.SS1.p1.9.m9.1.4.5">,</mo><mi id="S3.SS1.p1.9.m9.1.4.6">a</mi><mo id="S3.SS1.p1.9.m9.1.4.7" stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="S3.SS1.p1.9.m9.1c">s^{\prime}\sim\mathcal{P}(\cdot|s,a)</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.9.m9.1d">italic_s start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ∼ caligraphic_P ( ⋅ | italic_s , italic_a )</annotation></semantics></math>, and the agent receives stochastic reward with mean <math alttext="r(s,a)\in\mathbb{R}" class="ltx_Math" display="inline" id="S3.SS1.p1.10.m10.2"><semantics id="S3.SS1.p1.10.m10.2a"><mrow id="S3.SS1.p1.10.m10.2.3" xref="S3.SS1.p1.10.m10.2.3.cmml"><mrow id="S3.SS1.p1.10.m10.2.3.2" xref="S3.SS1.p1.10.m10.2.3.2.cmml"><mi id="S3.SS1.p1.10.m10.2.3.2.2" xref="S3.SS1.p1.10.m10.2.3.2.2.cmml">r</mi><mo id="S3.SS1.p1.10.m10.2.3.2.1" xref="S3.SS1.p1.10.m10.2.3.2.1.cmml">⁢</mo><mrow id="S3.SS1.p1.10.m10.2.3.2.3.2" xref="S3.SS1.p1.10.m10.2.3.2.3.1.cmml"><mo id="S3.SS1.p1.10.m10.2.3.2.3.2.1" stretchy="false" xref="S3.SS1.p1.10.m10.2.3.2.3.1.cmml">(</mo><mi id="S3.SS1.p1.10.m10.1.1" xref="S3.SS1.p1.10.m10.1.1.cmml">s</mi><mo id="S3.SS1.p1.10.m10.2.3.2.3.2.2" xref="S3.SS1.p1.10.m10.2.3.2.3.1.cmml">,</mo><mi id="S3.SS1.p1.10.m10.2.2" xref="S3.SS1.p1.10.m10.2.2.cmml">a</mi><mo id="S3.SS1.p1.10.m10.2.3.2.3.2.3" stretchy="false" xref="S3.SS1.p1.10.m10.2.3.2.3.1.cmml">)</mo></mrow></mrow><mo id="S3.SS1.p1.10.m10.2.3.1" xref="S3.SS1.p1.10.m10.2.3.1.cmml">∈</mo><mi id="S3.SS1.p1.10.m10.2.3.3" xref="S3.SS1.p1.10.m10.2.3.3.cmml">ℝ</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.10.m10.2b"><apply id="S3.SS1.p1.10.m10.2.3.cmml" xref="S3.SS1.p1.10.m10.2.3"><in id="S3.SS1.p1.10.m10.2.3.1.cmml" xref="S3.SS1.p1.10.m10.2.3.1"></in><apply id="S3.SS1.p1.10.m10.2.3.2.cmml" xref="S3.SS1.p1.10.m10.2.3.2"><times id="S3.SS1.p1.10.m10.2.3.2.1.cmml" xref="S3.SS1.p1.10.m10.2.3.2.1"></times><ci id="S3.SS1.p1.10.m10.2.3.2.2.cmml" xref="S3.SS1.p1.10.m10.2.3.2.2">𝑟</ci><interval closure="open" id="S3.SS1.p1.10.m10.2.3.2.3.1.cmml" xref="S3.SS1.p1.10.m10.2.3.2.3.2"><ci id="S3.SS1.p1.10.m10.1.1.cmml" xref="S3.SS1.p1.10.m10.1.1">𝑠</ci><ci id="S3.SS1.p1.10.m10.2.2.cmml" xref="S3.SS1.p1.10.m10.2.2">𝑎</ci></interval></apply><ci id="S3.SS1.p1.10.m10.2.3.3.cmml" xref="S3.SS1.p1.10.m10.2.3.3">ℝ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.10.m10.2c">r(s,a)\in\mathbb{R}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.10.m10.2d">italic_r ( italic_s , italic_a ) ∈ blackboard_R</annotation></semantics></math>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS1.p2">
<p class="ltx_p" id="S3.SS1.p2.15">The Q-function <math alttext="Q^{\pi}(s,a)" class="ltx_Math" display="inline" id="S3.SS1.p2.1.m1.2"><semantics id="S3.SS1.p2.1.m1.2a"><mrow id="S3.SS1.p2.1.m1.2.3" xref="S3.SS1.p2.1.m1.2.3.cmml"><msup id="S3.SS1.p2.1.m1.2.3.2" xref="S3.SS1.p2.1.m1.2.3.2.cmml"><mi id="S3.SS1.p2.1.m1.2.3.2.2" xref="S3.SS1.p2.1.m1.2.3.2.2.cmml">Q</mi><mi id="S3.SS1.p2.1.m1.2.3.2.3" xref="S3.SS1.p2.1.m1.2.3.2.3.cmml">π</mi></msup><mo id="S3.SS1.p2.1.m1.2.3.1" xref="S3.SS1.p2.1.m1.2.3.1.cmml">⁢</mo><mrow id="S3.SS1.p2.1.m1.2.3.3.2" xref="S3.SS1.p2.1.m1.2.3.3.1.cmml"><mo id="S3.SS1.p2.1.m1.2.3.3.2.1" stretchy="false" xref="S3.SS1.p2.1.m1.2.3.3.1.cmml">(</mo><mi id="S3.SS1.p2.1.m1.1.1" xref="S3.SS1.p2.1.m1.1.1.cmml">s</mi><mo id="S3.SS1.p2.1.m1.2.3.3.2.2" xref="S3.SS1.p2.1.m1.2.3.3.1.cmml">,</mo><mi id="S3.SS1.p2.1.m1.2.2" xref="S3.SS1.p2.1.m1.2.2.cmml">a</mi><mo id="S3.SS1.p2.1.m1.2.3.3.2.3" stretchy="false" xref="S3.SS1.p2.1.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.2b"><apply id="S3.SS1.p2.1.m1.2.3.cmml" xref="S3.SS1.p2.1.m1.2.3"><times id="S3.SS1.p2.1.m1.2.3.1.cmml" xref="S3.SS1.p2.1.m1.2.3.1"></times><apply id="S3.SS1.p2.1.m1.2.3.2.cmml" xref="S3.SS1.p2.1.m1.2.3.2"><csymbol cd="ambiguous" id="S3.SS1.p2.1.m1.2.3.2.1.cmml" xref="S3.SS1.p2.1.m1.2.3.2">superscript</csymbol><ci id="S3.SS1.p2.1.m1.2.3.2.2.cmml" xref="S3.SS1.p2.1.m1.2.3.2.2">𝑄</ci><ci id="S3.SS1.p2.1.m1.2.3.2.3.cmml" xref="S3.SS1.p2.1.m1.2.3.2.3">𝜋</ci></apply><interval closure="open" id="S3.SS1.p2.1.m1.2.3.3.1.cmml" xref="S3.SS1.p2.1.m1.2.3.3.2"><ci id="S3.SS1.p2.1.m1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1">𝑠</ci><ci id="S3.SS1.p2.1.m1.2.2.cmml" xref="S3.SS1.p2.1.m1.2.2">𝑎</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.2c">Q^{\pi}(s,a)</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.1.m1.2d">italic_Q start_POSTSUPERSCRIPT italic_π end_POSTSUPERSCRIPT ( italic_s , italic_a )</annotation></semantics></math> for a policy <math alttext="\pi(\cdot|s)" class="ltx_math_unparsed" display="inline" id="S3.SS1.p2.2.m2.1"><semantics id="S3.SS1.p2.2.m2.1a"><mrow id="S3.SS1.p2.2.m2.1b"><mi id="S3.SS1.p2.2.m2.1.1">π</mi><mrow id="S3.SS1.p2.2.m2.1.2"><mo id="S3.SS1.p2.2.m2.1.2.1" stretchy="false">(</mo><mo id="S3.SS1.p2.2.m2.1.2.2" lspace="0em" rspace="0em">⋅</mo><mo fence="false" id="S3.SS1.p2.2.m2.1.2.3" rspace="0.167em" stretchy="false">|</mo><mi id="S3.SS1.p2.2.m2.1.2.4">s</mi><mo id="S3.SS1.p2.2.m2.1.2.5" stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="S3.SS1.p2.2.m2.1c">\pi(\cdot|s)</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.2.m2.1d">italic_π ( ⋅ | italic_s )</annotation></semantics></math> represents the discounted long-term reward attained by executing <math alttext="a" class="ltx_Math" display="inline" id="S3.SS1.p2.3.m3.1"><semantics id="S3.SS1.p2.3.m3.1a"><mi id="S3.SS1.p2.3.m3.1.1" xref="S3.SS1.p2.3.m3.1.1.cmml">a</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.3.m3.1b"><ci id="S3.SS1.p2.3.m3.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1">𝑎</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.3.m3.1c">a</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.3.m3.1d">italic_a</annotation></semantics></math> given observation history <math alttext="s" class="ltx_Math" display="inline" id="S3.SS1.p2.4.m4.1"><semantics id="S3.SS1.p2.4.m4.1a"><mi id="S3.SS1.p2.4.m4.1.1" xref="S3.SS1.p2.4.m4.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.4.m4.1b"><ci id="S3.SS1.p2.4.m4.1.1.cmml" xref="S3.SS1.p2.4.m4.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.4.m4.1c">s</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.4.m4.1d">italic_s</annotation></semantics></math> and then following policy <math alttext="\pi" class="ltx_Math" display="inline" id="S3.SS1.p2.5.m5.1"><semantics id="S3.SS1.p2.5.m5.1a"><mi id="S3.SS1.p2.5.m5.1.1" xref="S3.SS1.p2.5.m5.1.1.cmml">π</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.5.m5.1b"><ci id="S3.SS1.p2.5.m5.1.1.cmml" xref="S3.SS1.p2.5.m5.1.1">𝜋</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.5.m5.1c">\pi</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.5.m5.1d">italic_π</annotation></semantics></math> thereafter.
<math alttext="Q^{\pi}" class="ltx_Math" display="inline" id="S3.SS1.p2.6.m6.1"><semantics id="S3.SS1.p2.6.m6.1a"><msup id="S3.SS1.p2.6.m6.1.1" xref="S3.SS1.p2.6.m6.1.1.cmml"><mi id="S3.SS1.p2.6.m6.1.1.2" xref="S3.SS1.p2.6.m6.1.1.2.cmml">Q</mi><mi id="S3.SS1.p2.6.m6.1.1.3" xref="S3.SS1.p2.6.m6.1.1.3.cmml">π</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.6.m6.1b"><apply id="S3.SS1.p2.6.m6.1.1.cmml" xref="S3.SS1.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.6.m6.1.1.1.cmml" xref="S3.SS1.p2.6.m6.1.1">superscript</csymbol><ci id="S3.SS1.p2.6.m6.1.1.2.cmml" xref="S3.SS1.p2.6.m6.1.1.2">𝑄</ci><ci id="S3.SS1.p2.6.m6.1.1.3.cmml" xref="S3.SS1.p2.6.m6.1.1.3">𝜋</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.6.m6.1c">Q^{\pi}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.6.m6.1d">italic_Q start_POSTSUPERSCRIPT italic_π end_POSTSUPERSCRIPT</annotation></semantics></math> satisfies the Bellman recurrence:
<math alttext="Q^{\pi}(s,a)=\mathbb{B}^{\pi}Q^{\pi}(s,a)=r(s,a)+\gamma\mathbb{E}_{s^{\prime}%
\sim P(\cdot|s,a),a^{\prime}\sim\pi(\cdot|s^{\prime})}\left[Q_{h+1}(s^{\prime}%
,a^{\prime})\right]\,." class="ltx_math_unparsed" display="inline" id="S3.SS1.p2.7.m7.9"><semantics id="S3.SS1.p2.7.m7.9a"><mrow id="S3.SS1.p2.7.m7.9.9.1"><mrow id="S3.SS1.p2.7.m7.9.9.1.1"><mrow id="S3.SS1.p2.7.m7.9.9.1.1.3"><msup id="S3.SS1.p2.7.m7.9.9.1.1.3.2"><mi id="S3.SS1.p2.7.m7.9.9.1.1.3.2.2">Q</mi><mi id="S3.SS1.p2.7.m7.9.9.1.1.3.2.3">π</mi></msup><mo id="S3.SS1.p2.7.m7.9.9.1.1.3.1">⁢</mo><mrow id="S3.SS1.p2.7.m7.9.9.1.1.3.3.2"><mo id="S3.SS1.p2.7.m7.9.9.1.1.3.3.2.1" stretchy="false">(</mo><mi id="S3.SS1.p2.7.m7.3.3">s</mi><mo id="S3.SS1.p2.7.m7.9.9.1.1.3.3.2.2">,</mo><mi id="S3.SS1.p2.7.m7.4.4">a</mi><mo id="S3.SS1.p2.7.m7.9.9.1.1.3.3.2.3" stretchy="false">)</mo></mrow></mrow><mo id="S3.SS1.p2.7.m7.9.9.1.1.4">=</mo><mrow id="S3.SS1.p2.7.m7.9.9.1.1.5"><msup id="S3.SS1.p2.7.m7.9.9.1.1.5.2"><mi id="S3.SS1.p2.7.m7.9.9.1.1.5.2.2">𝔹</mi><mi id="S3.SS1.p2.7.m7.9.9.1.1.5.2.3">π</mi></msup><mo id="S3.SS1.p2.7.m7.9.9.1.1.5.1">⁢</mo><msup id="S3.SS1.p2.7.m7.9.9.1.1.5.3"><mi id="S3.SS1.p2.7.m7.9.9.1.1.5.3.2">Q</mi><mi id="S3.SS1.p2.7.m7.9.9.1.1.5.3.3">π</mi></msup><mo id="S3.SS1.p2.7.m7.9.9.1.1.5.1a">⁢</mo><mrow id="S3.SS1.p2.7.m7.9.9.1.1.5.4.2"><mo id="S3.SS1.p2.7.m7.9.9.1.1.5.4.2.1" stretchy="false">(</mo><mi id="S3.SS1.p2.7.m7.5.5">s</mi><mo id="S3.SS1.p2.7.m7.9.9.1.1.5.4.2.2">,</mo><mi id="S3.SS1.p2.7.m7.6.6">a</mi><mo id="S3.SS1.p2.7.m7.9.9.1.1.5.4.2.3" stretchy="false">)</mo></mrow></mrow><mo id="S3.SS1.p2.7.m7.9.9.1.1.6">=</mo><mrow id="S3.SS1.p2.7.m7.9.9.1.1.1"><mrow id="S3.SS1.p2.7.m7.9.9.1.1.1.3"><mi id="S3.SS1.p2.7.m7.9.9.1.1.1.3.2">r</mi><mo id="S3.SS1.p2.7.m7.9.9.1.1.1.3.1">⁢</mo><mrow id="S3.SS1.p2.7.m7.9.9.1.1.1.3.3.2"><mo id="S3.SS1.p2.7.m7.9.9.1.1.1.3.3.2.1" stretchy="false">(</mo><mi id="S3.SS1.p2.7.m7.7.7">s</mi><mo id="S3.SS1.p2.7.m7.9.9.1.1.1.3.3.2.2">,</mo><mi id="S3.SS1.p2.7.m7.8.8">a</mi><mo id="S3.SS1.p2.7.m7.9.9.1.1.1.3.3.2.3" stretchy="false">)</mo></mrow></mrow><mo id="S3.SS1.p2.7.m7.9.9.1.1.1.2">+</mo><mrow id="S3.SS1.p2.7.m7.9.9.1.1.1.1"><mi id="S3.SS1.p2.7.m7.9.9.1.1.1.1.3">γ</mi><mo id="S3.SS1.p2.7.m7.9.9.1.1.1.1.2">⁢</mo><msub id="S3.SS1.p2.7.m7.9.9.1.1.1.1.4"><mi id="S3.SS1.p2.7.m7.9.9.1.1.1.1.4.2">𝔼</mi><mrow id="S3.SS1.p2.7.m7.2.2.2"><msup id="S3.SS1.p2.7.m7.2.2.2.3"><mi id="S3.SS1.p2.7.m7.2.2.2.3.2">s</mi><mo id="S3.SS1.p2.7.m7.2.2.2.3.3">′</mo></msup><mo id="S3.SS1.p2.7.m7.2.2.2.4">∼</mo><mi id="S3.SS1.p2.7.m7.2.2.2.5">P</mi><mrow id="S3.SS1.p2.7.m7.2.2.2.6"><mo id="S3.SS1.p2.7.m7.2.2.2.6.1" stretchy="false">(</mo><mo id="S3.SS1.p2.7.m7.2.2.2.6.2" lspace="0em" rspace="0em">⋅</mo><mo fence="false" id="S3.SS1.p2.7.m7.2.2.2.6.3" rspace="0.167em" stretchy="false">|</mo><mi id="S3.SS1.p2.7.m7.1.1.1.1">s</mi><mo id="S3.SS1.p2.7.m7.2.2.2.6.4">,</mo><mi id="S3.SS1.p2.7.m7.2.2.2.2">a</mi><mo id="S3.SS1.p2.7.m7.2.2.2.6.5" stretchy="false">)</mo></mrow><mo id="S3.SS1.p2.7.m7.2.2.2.7">,</mo><msup id="S3.SS1.p2.7.m7.2.2.2.8"><mi id="S3.SS1.p2.7.m7.2.2.2.8.2">a</mi><mo id="S3.SS1.p2.7.m7.2.2.2.8.3">′</mo></msup><mo id="S3.SS1.p2.7.m7.2.2.2.9">∼</mo><mi id="S3.SS1.p2.7.m7.2.2.2.10">π</mi><mrow id="S3.SS1.p2.7.m7.2.2.2.11"><mo id="S3.SS1.p2.7.m7.2.2.2.11.1" stretchy="false">(</mo><mo id="S3.SS1.p2.7.m7.2.2.2.11.2" lspace="0em" rspace="0em">⋅</mo><mo fence="false" id="S3.SS1.p2.7.m7.2.2.2.11.3" rspace="0.167em" stretchy="false">|</mo><msup id="S3.SS1.p2.7.m7.2.2.2.11.4"><mi id="S3.SS1.p2.7.m7.2.2.2.11.4.2">s</mi><mo id="S3.SS1.p2.7.m7.2.2.2.11.4.3">′</mo></msup><mo id="S3.SS1.p2.7.m7.2.2.2.11.5" stretchy="false">)</mo></mrow></mrow></msub><mo id="S3.SS1.p2.7.m7.9.9.1.1.1.1.2a">⁢</mo><mrow id="S3.SS1.p2.7.m7.9.9.1.1.1.1.1.1"><mo id="S3.SS1.p2.7.m7.9.9.1.1.1.1.1.1.2">[</mo><mrow id="S3.SS1.p2.7.m7.9.9.1.1.1.1.1.1.1"><msub id="S3.SS1.p2.7.m7.9.9.1.1.1.1.1.1.1.4"><mi id="S3.SS1.p2.7.m7.9.9.1.1.1.1.1.1.1.4.2">Q</mi><mrow id="S3.SS1.p2.7.m7.9.9.1.1.1.1.1.1.1.4.3"><mi id="S3.SS1.p2.7.m7.9.9.1.1.1.1.1.1.1.4.3.2">h</mi><mo id="S3.SS1.p2.7.m7.9.9.1.1.1.1.1.1.1.4.3.1">+</mo><mn id="S3.SS1.p2.7.m7.9.9.1.1.1.1.1.1.1.4.3.3">1</mn></mrow></msub><mo id="S3.SS1.p2.7.m7.9.9.1.1.1.1.1.1.1.3">⁢</mo><mrow id="S3.SS1.p2.7.m7.9.9.1.1.1.1.1.1.1.2.2"><mo id="S3.SS1.p2.7.m7.9.9.1.1.1.1.1.1.1.2.2.3" stretchy="false">(</mo><msup id="S3.SS1.p2.7.m7.9.9.1.1.1.1.1.1.1.1.1.1"><mi id="S3.SS1.p2.7.m7.9.9.1.1.1.1.1.1.1.1.1.1.2">s</mi><mo id="S3.SS1.p2.7.m7.9.9.1.1.1.1.1.1.1.1.1.1.3">′</mo></msup><mo id="S3.SS1.p2.7.m7.9.9.1.1.1.1.1.1.1.2.2.4">,</mo><msup id="S3.SS1.p2.7.m7.9.9.1.1.1.1.1.1.1.2.2.2"><mi id="S3.SS1.p2.7.m7.9.9.1.1.1.1.1.1.1.2.2.2.2">a</mi><mo id="S3.SS1.p2.7.m7.9.9.1.1.1.1.1.1.1.2.2.2.3">′</mo></msup><mo id="S3.SS1.p2.7.m7.9.9.1.1.1.1.1.1.1.2.2.5" stretchy="false">)</mo></mrow></mrow><mo id="S3.SS1.p2.7.m7.9.9.1.1.1.1.1.1.3">]</mo></mrow></mrow></mrow></mrow><mo id="S3.SS1.p2.7.m7.9.9.1.2" lspace="0.170em">.</mo></mrow><annotation encoding="application/x-tex" id="S3.SS1.p2.7.m7.9b">Q^{\pi}(s,a)=\mathbb{B}^{\pi}Q^{\pi}(s,a)=r(s,a)+\gamma\mathbb{E}_{s^{\prime}%
\sim P(\cdot|s,a),a^{\prime}\sim\pi(\cdot|s^{\prime})}\left[Q_{h+1}(s^{\prime}%
,a^{\prime})\right]\,.</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.7.m7.9c">italic_Q start_POSTSUPERSCRIPT italic_π end_POSTSUPERSCRIPT ( italic_s , italic_a ) = blackboard_B start_POSTSUPERSCRIPT italic_π end_POSTSUPERSCRIPT italic_Q start_POSTSUPERSCRIPT italic_π end_POSTSUPERSCRIPT ( italic_s , italic_a ) = italic_r ( italic_s , italic_a ) + italic_γ blackboard_E start_POSTSUBSCRIPT italic_s start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ∼ italic_P ( ⋅ | italic_s , italic_a ) , italic_a start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ∼ italic_π ( ⋅ | italic_s start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ) end_POSTSUBSCRIPT [ italic_Q start_POSTSUBSCRIPT italic_h + 1 end_POSTSUBSCRIPT ( italic_s start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT , italic_a start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ) ] .</annotation></semantics></math>
The value function <math alttext="V^{\pi}" class="ltx_Math" display="inline" id="S3.SS1.p2.8.m8.1"><semantics id="S3.SS1.p2.8.m8.1a"><msup id="S3.SS1.p2.8.m8.1.1" xref="S3.SS1.p2.8.m8.1.1.cmml"><mi id="S3.SS1.p2.8.m8.1.1.2" xref="S3.SS1.p2.8.m8.1.1.2.cmml">V</mi><mi id="S3.SS1.p2.8.m8.1.1.3" xref="S3.SS1.p2.8.m8.1.1.3.cmml">π</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.8.m8.1b"><apply id="S3.SS1.p2.8.m8.1.1.cmml" xref="S3.SS1.p2.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.8.m8.1.1.1.cmml" xref="S3.SS1.p2.8.m8.1.1">superscript</csymbol><ci id="S3.SS1.p2.8.m8.1.1.2.cmml" xref="S3.SS1.p2.8.m8.1.1.2">𝑉</ci><ci id="S3.SS1.p2.8.m8.1.1.3.cmml" xref="S3.SS1.p2.8.m8.1.1.3">𝜋</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.8.m8.1c">V^{\pi}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.8.m8.1d">italic_V start_POSTSUPERSCRIPT italic_π end_POSTSUPERSCRIPT</annotation></semantics></math> considers the expectation of the Q-function over the policy <math alttext="V^{\pi}(h)=\mathbb{E}_{a\sim\pi(\cdot|s)}\left[Q^{\pi}(s,a)\right]" class="ltx_math_unparsed" display="inline" id="S3.SS1.p2.9.m9.4"><semantics id="S3.SS1.p2.9.m9.4a"><mrow id="S3.SS1.p2.9.m9.4.4"><mrow id="S3.SS1.p2.9.m9.4.4.3"><msup id="S3.SS1.p2.9.m9.4.4.3.2"><mi id="S3.SS1.p2.9.m9.4.4.3.2.2">V</mi><mi id="S3.SS1.p2.9.m9.4.4.3.2.3">π</mi></msup><mo id="S3.SS1.p2.9.m9.4.4.3.1">⁢</mo><mrow id="S3.SS1.p2.9.m9.4.4.3.3.2"><mo id="S3.SS1.p2.9.m9.4.4.3.3.2.1" stretchy="false">(</mo><mi id="S3.SS1.p2.9.m9.1.1">h</mi><mo id="S3.SS1.p2.9.m9.4.4.3.3.2.2" stretchy="false">)</mo></mrow></mrow><mo id="S3.SS1.p2.9.m9.4.4.2">=</mo><mrow id="S3.SS1.p2.9.m9.4.4.1"><msub id="S3.SS1.p2.9.m9.4.4.1.3"><mi id="S3.SS1.p2.9.m9.4.4.1.3.2">𝔼</mi><mrow id="S3.SS1.p2.9.m9.4.4.1.3.3"><mi id="S3.SS1.p2.9.m9.4.4.1.3.3.1">a</mi><mo id="S3.SS1.p2.9.m9.4.4.1.3.3.2">∼</mo><mi id="S3.SS1.p2.9.m9.4.4.1.3.3.3">π</mi><mrow id="S3.SS1.p2.9.m9.4.4.1.3.3.4"><mo id="S3.SS1.p2.9.m9.4.4.1.3.3.4.1" stretchy="false">(</mo><mo id="S3.SS1.p2.9.m9.4.4.1.3.3.4.2" lspace="0em" rspace="0em">⋅</mo><mo fence="false" id="S3.SS1.p2.9.m9.4.4.1.3.3.4.3" rspace="0.167em" stretchy="false">|</mo><mi id="S3.SS1.p2.9.m9.4.4.1.3.3.4.4">s</mi><mo id="S3.SS1.p2.9.m9.4.4.1.3.3.4.5" stretchy="false">)</mo></mrow></mrow></msub><mo id="S3.SS1.p2.9.m9.4.4.1.2">⁢</mo><mrow id="S3.SS1.p2.9.m9.4.4.1.1.1"><mo id="S3.SS1.p2.9.m9.4.4.1.1.1.2">[</mo><mrow id="S3.SS1.p2.9.m9.4.4.1.1.1.1"><msup id="S3.SS1.p2.9.m9.4.4.1.1.1.1.2"><mi id="S3.SS1.p2.9.m9.4.4.1.1.1.1.2.2">Q</mi><mi id="S3.SS1.p2.9.m9.4.4.1.1.1.1.2.3">π</mi></msup><mo id="S3.SS1.p2.9.m9.4.4.1.1.1.1.1">⁢</mo><mrow id="S3.SS1.p2.9.m9.4.4.1.1.1.1.3.2"><mo id="S3.SS1.p2.9.m9.4.4.1.1.1.1.3.2.1" stretchy="false">(</mo><mi id="S3.SS1.p2.9.m9.2.2">s</mi><mo id="S3.SS1.p2.9.m9.4.4.1.1.1.1.3.2.2">,</mo><mi id="S3.SS1.p2.9.m9.3.3">a</mi><mo id="S3.SS1.p2.9.m9.4.4.1.1.1.1.3.2.3" stretchy="false">)</mo></mrow></mrow><mo id="S3.SS1.p2.9.m9.4.4.1.1.1.3">]</mo></mrow></mrow></mrow><annotation encoding="application/x-tex" id="S3.SS1.p2.9.m9.4b">V^{\pi}(h)=\mathbb{E}_{a\sim\pi(\cdot|s)}\left[Q^{\pi}(s,a)\right]</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.9.m9.4c">italic_V start_POSTSUPERSCRIPT italic_π end_POSTSUPERSCRIPT ( italic_h ) = blackboard_E start_POSTSUBSCRIPT italic_a ∼ italic_π ( ⋅ | italic_s ) end_POSTSUBSCRIPT [ italic_Q start_POSTSUPERSCRIPT italic_π end_POSTSUPERSCRIPT ( italic_s , italic_a ) ]</annotation></semantics></math>. Meanwhile, the Q-function of the optimal policy <math alttext="Q^{*}" class="ltx_Math" display="inline" id="S3.SS1.p2.10.m10.1"><semantics id="S3.SS1.p2.10.m10.1a"><msup id="S3.SS1.p2.10.m10.1.1" xref="S3.SS1.p2.10.m10.1.1.cmml"><mi id="S3.SS1.p2.10.m10.1.1.2" xref="S3.SS1.p2.10.m10.1.1.2.cmml">Q</mi><mo id="S3.SS1.p2.10.m10.1.1.3" xref="S3.SS1.p2.10.m10.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.10.m10.1b"><apply id="S3.SS1.p2.10.m10.1.1.cmml" xref="S3.SS1.p2.10.m10.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.10.m10.1.1.1.cmml" xref="S3.SS1.p2.10.m10.1.1">superscript</csymbol><ci id="S3.SS1.p2.10.m10.1.1.2.cmml" xref="S3.SS1.p2.10.m10.1.1.2">𝑄</ci><times id="S3.SS1.p2.10.m10.1.1.3.cmml" xref="S3.SS1.p2.10.m10.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.10.m10.1c">Q^{*}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.10.m10.1d">italic_Q start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math> satisfies: <math alttext="Q^{*}(s,a)=r(s,a)+\gamma\mathbb{E}_{s^{\prime}\sim P(\cdot|s,a)}\left[\max_{a^%
{\prime}}Q^{*}(s^{\prime},a^{\prime})\right]" class="ltx_math_unparsed" display="inline" id="S3.SS1.p2.11.m11.7"><semantics id="S3.SS1.p2.11.m11.7a"><mrow id="S3.SS1.p2.11.m11.7.7"><mrow id="S3.SS1.p2.11.m11.7.7.3"><msup id="S3.SS1.p2.11.m11.7.7.3.2"><mi id="S3.SS1.p2.11.m11.7.7.3.2.2">Q</mi><mo id="S3.SS1.p2.11.m11.7.7.3.2.3">∗</mo></msup><mo id="S3.SS1.p2.11.m11.7.7.3.1">⁢</mo><mrow id="S3.SS1.p2.11.m11.7.7.3.3.2"><mo id="S3.SS1.p2.11.m11.7.7.3.3.2.1" stretchy="false">(</mo><mi id="S3.SS1.p2.11.m11.3.3">s</mi><mo id="S3.SS1.p2.11.m11.7.7.3.3.2.2">,</mo><mi id="S3.SS1.p2.11.m11.4.4">a</mi><mo id="S3.SS1.p2.11.m11.7.7.3.3.2.3" stretchy="false">)</mo></mrow></mrow><mo id="S3.SS1.p2.11.m11.7.7.2">=</mo><mrow id="S3.SS1.p2.11.m11.7.7.1"><mrow id="S3.SS1.p2.11.m11.7.7.1.3"><mi id="S3.SS1.p2.11.m11.7.7.1.3.2">r</mi><mo id="S3.SS1.p2.11.m11.7.7.1.3.1">⁢</mo><mrow id="S3.SS1.p2.11.m11.7.7.1.3.3.2"><mo id="S3.SS1.p2.11.m11.7.7.1.3.3.2.1" stretchy="false">(</mo><mi id="S3.SS1.p2.11.m11.5.5">s</mi><mo id="S3.SS1.p2.11.m11.7.7.1.3.3.2.2">,</mo><mi id="S3.SS1.p2.11.m11.6.6">a</mi><mo id="S3.SS1.p2.11.m11.7.7.1.3.3.2.3" stretchy="false">)</mo></mrow></mrow><mo id="S3.SS1.p2.11.m11.7.7.1.2">+</mo><mrow id="S3.SS1.p2.11.m11.7.7.1.1"><mi id="S3.SS1.p2.11.m11.7.7.1.1.3">γ</mi><mo id="S3.SS1.p2.11.m11.7.7.1.1.2">⁢</mo><msub id="S3.SS1.p2.11.m11.7.7.1.1.4"><mi id="S3.SS1.p2.11.m11.7.7.1.1.4.2">𝔼</mi><mrow id="S3.SS1.p2.11.m11.2.2.2"><msup id="S3.SS1.p2.11.m11.2.2.2.3"><mi id="S3.SS1.p2.11.m11.2.2.2.3.2">s</mi><mo id="S3.SS1.p2.11.m11.2.2.2.3.3">′</mo></msup><mo id="S3.SS1.p2.11.m11.2.2.2.4">∼</mo><mi id="S3.SS1.p2.11.m11.2.2.2.5">P</mi><mrow id="S3.SS1.p2.11.m11.2.2.2.6"><mo id="S3.SS1.p2.11.m11.2.2.2.6.1" stretchy="false">(</mo><mo id="S3.SS1.p2.11.m11.2.2.2.6.2" lspace="0em" rspace="0em">⋅</mo><mo fence="false" id="S3.SS1.p2.11.m11.2.2.2.6.3" rspace="0.167em" stretchy="false">|</mo><mi id="S3.SS1.p2.11.m11.1.1.1.1">s</mi><mo id="S3.SS1.p2.11.m11.2.2.2.6.4">,</mo><mi id="S3.SS1.p2.11.m11.2.2.2.2">a</mi><mo id="S3.SS1.p2.11.m11.2.2.2.6.5" stretchy="false">)</mo></mrow></mrow></msub><mo id="S3.SS1.p2.11.m11.7.7.1.1.2a">⁢</mo><mrow id="S3.SS1.p2.11.m11.7.7.1.1.1.1"><mo id="S3.SS1.p2.11.m11.7.7.1.1.1.1.2">[</mo><mrow id="S3.SS1.p2.11.m11.7.7.1.1.1.1.1"><mrow id="S3.SS1.p2.11.m11.7.7.1.1.1.1.1.4"><msub id="S3.SS1.p2.11.m11.7.7.1.1.1.1.1.4.1"><mi id="S3.SS1.p2.11.m11.7.7.1.1.1.1.1.4.1.2">max</mi><msup id="S3.SS1.p2.11.m11.7.7.1.1.1.1.1.4.1.3"><mi id="S3.SS1.p2.11.m11.7.7.1.1.1.1.1.4.1.3.2">a</mi><mo id="S3.SS1.p2.11.m11.7.7.1.1.1.1.1.4.1.3.3">′</mo></msup></msub><mo id="S3.SS1.p2.11.m11.7.7.1.1.1.1.1.4a" lspace="0.167em">⁡</mo><msup id="S3.SS1.p2.11.m11.7.7.1.1.1.1.1.4.2"><mi id="S3.SS1.p2.11.m11.7.7.1.1.1.1.1.4.2.2">Q</mi><mo id="S3.SS1.p2.11.m11.7.7.1.1.1.1.1.4.2.3">∗</mo></msup></mrow><mo id="S3.SS1.p2.11.m11.7.7.1.1.1.1.1.3">⁢</mo><mrow id="S3.SS1.p2.11.m11.7.7.1.1.1.1.1.2.2"><mo id="S3.SS1.p2.11.m11.7.7.1.1.1.1.1.2.2.3" stretchy="false">(</mo><msup id="S3.SS1.p2.11.m11.7.7.1.1.1.1.1.1.1.1"><mi id="S3.SS1.p2.11.m11.7.7.1.1.1.1.1.1.1.1.2">s</mi><mo id="S3.SS1.p2.11.m11.7.7.1.1.1.1.1.1.1.1.3">′</mo></msup><mo id="S3.SS1.p2.11.m11.7.7.1.1.1.1.1.2.2.4">,</mo><msup id="S3.SS1.p2.11.m11.7.7.1.1.1.1.1.2.2.2"><mi id="S3.SS1.p2.11.m11.7.7.1.1.1.1.1.2.2.2.2">a</mi><mo id="S3.SS1.p2.11.m11.7.7.1.1.1.1.1.2.2.2.3">′</mo></msup><mo id="S3.SS1.p2.11.m11.7.7.1.1.1.1.1.2.2.5" stretchy="false">)</mo></mrow></mrow><mo id="S3.SS1.p2.11.m11.7.7.1.1.1.1.3">]</mo></mrow></mrow></mrow></mrow><annotation encoding="application/x-tex" id="S3.SS1.p2.11.m11.7b">Q^{*}(s,a)=r(s,a)+\gamma\mathbb{E}_{s^{\prime}\sim P(\cdot|s,a)}\left[\max_{a^%
{\prime}}Q^{*}(s^{\prime},a^{\prime})\right]</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.11.m11.7c">italic_Q start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ( italic_s , italic_a ) = italic_r ( italic_s , italic_a ) + italic_γ blackboard_E start_POSTSUBSCRIPT italic_s start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ∼ italic_P ( ⋅ | italic_s , italic_a ) end_POSTSUBSCRIPT [ roman_max start_POSTSUBSCRIPT italic_a start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT end_POSTSUBSCRIPT italic_Q start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ( italic_s start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT , italic_a start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ) ]</annotation></semantics></math>, and the optimal value function is <math alttext="V^{*}(s)=\max_{a}Q^{*}(s,a)" class="ltx_Math" display="inline" id="S3.SS1.p2.12.m12.3"><semantics id="S3.SS1.p2.12.m12.3a"><mrow id="S3.SS1.p2.12.m12.3.4" xref="S3.SS1.p2.12.m12.3.4.cmml"><mrow id="S3.SS1.p2.12.m12.3.4.2" xref="S3.SS1.p2.12.m12.3.4.2.cmml"><msup id="S3.SS1.p2.12.m12.3.4.2.2" xref="S3.SS1.p2.12.m12.3.4.2.2.cmml"><mi id="S3.SS1.p2.12.m12.3.4.2.2.2" xref="S3.SS1.p2.12.m12.3.4.2.2.2.cmml">V</mi><mo id="S3.SS1.p2.12.m12.3.4.2.2.3" xref="S3.SS1.p2.12.m12.3.4.2.2.3.cmml">∗</mo></msup><mo id="S3.SS1.p2.12.m12.3.4.2.1" xref="S3.SS1.p2.12.m12.3.4.2.1.cmml">⁢</mo><mrow id="S3.SS1.p2.12.m12.3.4.2.3.2" xref="S3.SS1.p2.12.m12.3.4.2.cmml"><mo id="S3.SS1.p2.12.m12.3.4.2.3.2.1" stretchy="false" xref="S3.SS1.p2.12.m12.3.4.2.cmml">(</mo><mi id="S3.SS1.p2.12.m12.1.1" xref="S3.SS1.p2.12.m12.1.1.cmml">s</mi><mo id="S3.SS1.p2.12.m12.3.4.2.3.2.2" stretchy="false" xref="S3.SS1.p2.12.m12.3.4.2.cmml">)</mo></mrow></mrow><mo id="S3.SS1.p2.12.m12.3.4.1" xref="S3.SS1.p2.12.m12.3.4.1.cmml">=</mo><mrow id="S3.SS1.p2.12.m12.3.4.3" xref="S3.SS1.p2.12.m12.3.4.3.cmml"><mrow id="S3.SS1.p2.12.m12.3.4.3.2" xref="S3.SS1.p2.12.m12.3.4.3.2.cmml"><msub id="S3.SS1.p2.12.m12.3.4.3.2.1" xref="S3.SS1.p2.12.m12.3.4.3.2.1.cmml"><mi id="S3.SS1.p2.12.m12.3.4.3.2.1.2" xref="S3.SS1.p2.12.m12.3.4.3.2.1.2.cmml">max</mi><mi id="S3.SS1.p2.12.m12.3.4.3.2.1.3" xref="S3.SS1.p2.12.m12.3.4.3.2.1.3.cmml">a</mi></msub><mo id="S3.SS1.p2.12.m12.3.4.3.2a" lspace="0.167em" xref="S3.SS1.p2.12.m12.3.4.3.2.cmml">⁡</mo><msup id="S3.SS1.p2.12.m12.3.4.3.2.2" xref="S3.SS1.p2.12.m12.3.4.3.2.2.cmml"><mi id="S3.SS1.p2.12.m12.3.4.3.2.2.2" xref="S3.SS1.p2.12.m12.3.4.3.2.2.2.cmml">Q</mi><mo id="S3.SS1.p2.12.m12.3.4.3.2.2.3" xref="S3.SS1.p2.12.m12.3.4.3.2.2.3.cmml">∗</mo></msup></mrow><mo id="S3.SS1.p2.12.m12.3.4.3.1" xref="S3.SS1.p2.12.m12.3.4.3.1.cmml">⁢</mo><mrow id="S3.SS1.p2.12.m12.3.4.3.3.2" xref="S3.SS1.p2.12.m12.3.4.3.3.1.cmml"><mo id="S3.SS1.p2.12.m12.3.4.3.3.2.1" stretchy="false" xref="S3.SS1.p2.12.m12.3.4.3.3.1.cmml">(</mo><mi id="S3.SS1.p2.12.m12.2.2" xref="S3.SS1.p2.12.m12.2.2.cmml">s</mi><mo id="S3.SS1.p2.12.m12.3.4.3.3.2.2" xref="S3.SS1.p2.12.m12.3.4.3.3.1.cmml">,</mo><mi id="S3.SS1.p2.12.m12.3.3" xref="S3.SS1.p2.12.m12.3.3.cmml">a</mi><mo id="S3.SS1.p2.12.m12.3.4.3.3.2.3" stretchy="false" xref="S3.SS1.p2.12.m12.3.4.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.12.m12.3b"><apply id="S3.SS1.p2.12.m12.3.4.cmml" xref="S3.SS1.p2.12.m12.3.4"><eq id="S3.SS1.p2.12.m12.3.4.1.cmml" xref="S3.SS1.p2.12.m12.3.4.1"></eq><apply id="S3.SS1.p2.12.m12.3.4.2.cmml" xref="S3.SS1.p2.12.m12.3.4.2"><times id="S3.SS1.p2.12.m12.3.4.2.1.cmml" xref="S3.SS1.p2.12.m12.3.4.2.1"></times><apply id="S3.SS1.p2.12.m12.3.4.2.2.cmml" xref="S3.SS1.p2.12.m12.3.4.2.2"><csymbol cd="ambiguous" id="S3.SS1.p2.12.m12.3.4.2.2.1.cmml" xref="S3.SS1.p2.12.m12.3.4.2.2">superscript</csymbol><ci id="S3.SS1.p2.12.m12.3.4.2.2.2.cmml" xref="S3.SS1.p2.12.m12.3.4.2.2.2">𝑉</ci><times id="S3.SS1.p2.12.m12.3.4.2.2.3.cmml" xref="S3.SS1.p2.12.m12.3.4.2.2.3"></times></apply><ci id="S3.SS1.p2.12.m12.1.1.cmml" xref="S3.SS1.p2.12.m12.1.1">𝑠</ci></apply><apply id="S3.SS1.p2.12.m12.3.4.3.cmml" xref="S3.SS1.p2.12.m12.3.4.3"><times id="S3.SS1.p2.12.m12.3.4.3.1.cmml" xref="S3.SS1.p2.12.m12.3.4.3.1"></times><apply id="S3.SS1.p2.12.m12.3.4.3.2.cmml" xref="S3.SS1.p2.12.m12.3.4.3.2"><apply id="S3.SS1.p2.12.m12.3.4.3.2.1.cmml" xref="S3.SS1.p2.12.m12.3.4.3.2.1"><csymbol cd="ambiguous" id="S3.SS1.p2.12.m12.3.4.3.2.1.1.cmml" xref="S3.SS1.p2.12.m12.3.4.3.2.1">subscript</csymbol><max id="S3.SS1.p2.12.m12.3.4.3.2.1.2.cmml" xref="S3.SS1.p2.12.m12.3.4.3.2.1.2"></max><ci id="S3.SS1.p2.12.m12.3.4.3.2.1.3.cmml" xref="S3.SS1.p2.12.m12.3.4.3.2.1.3">𝑎</ci></apply><apply id="S3.SS1.p2.12.m12.3.4.3.2.2.cmml" xref="S3.SS1.p2.12.m12.3.4.3.2.2"><csymbol cd="ambiguous" id="S3.SS1.p2.12.m12.3.4.3.2.2.1.cmml" xref="S3.SS1.p2.12.m12.3.4.3.2.2">superscript</csymbol><ci id="S3.SS1.p2.12.m12.3.4.3.2.2.2.cmml" xref="S3.SS1.p2.12.m12.3.4.3.2.2.2">𝑄</ci><times id="S3.SS1.p2.12.m12.3.4.3.2.2.3.cmml" xref="S3.SS1.p2.12.m12.3.4.3.2.2.3"></times></apply></apply><interval closure="open" id="S3.SS1.p2.12.m12.3.4.3.3.1.cmml" xref="S3.SS1.p2.12.m12.3.4.3.3.2"><ci id="S3.SS1.p2.12.m12.2.2.cmml" xref="S3.SS1.p2.12.m12.2.2">𝑠</ci><ci id="S3.SS1.p2.12.m12.3.3.cmml" xref="S3.SS1.p2.12.m12.3.3">𝑎</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.12.m12.3c">V^{*}(s)=\max_{a}Q^{*}(s,a)</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.12.m12.3d">italic_V start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ( italic_s ) = roman_max start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT italic_Q start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ( italic_s , italic_a )</annotation></semantics></math>. Finally, the expected cumulative reward is given by <math alttext="J(\pi)=\mathbb{E}_{s_{1}\sim\rho_{1}}\left[V^{\pi}(s_{1})\right]" class="ltx_Math" display="inline" id="S3.SS1.p2.13.m13.2"><semantics id="S3.SS1.p2.13.m13.2a"><mrow id="S3.SS1.p2.13.m13.2.2" xref="S3.SS1.p2.13.m13.2.2.cmml"><mrow id="S3.SS1.p2.13.m13.2.2.3" xref="S3.SS1.p2.13.m13.2.2.3.cmml"><mi id="S3.SS1.p2.13.m13.2.2.3.2" xref="S3.SS1.p2.13.m13.2.2.3.2.cmml">J</mi><mo id="S3.SS1.p2.13.m13.2.2.3.1" xref="S3.SS1.p2.13.m13.2.2.3.1.cmml">⁢</mo><mrow id="S3.SS1.p2.13.m13.2.2.3.3.2" xref="S3.SS1.p2.13.m13.2.2.3.cmml"><mo id="S3.SS1.p2.13.m13.2.2.3.3.2.1" stretchy="false" xref="S3.SS1.p2.13.m13.2.2.3.cmml">(</mo><mi id="S3.SS1.p2.13.m13.1.1" xref="S3.SS1.p2.13.m13.1.1.cmml">π</mi><mo id="S3.SS1.p2.13.m13.2.2.3.3.2.2" stretchy="false" xref="S3.SS1.p2.13.m13.2.2.3.cmml">)</mo></mrow></mrow><mo id="S3.SS1.p2.13.m13.2.2.2" xref="S3.SS1.p2.13.m13.2.2.2.cmml">=</mo><mrow id="S3.SS1.p2.13.m13.2.2.1" xref="S3.SS1.p2.13.m13.2.2.1.cmml"><msub id="S3.SS1.p2.13.m13.2.2.1.3" xref="S3.SS1.p2.13.m13.2.2.1.3.cmml"><mi id="S3.SS1.p2.13.m13.2.2.1.3.2" xref="S3.SS1.p2.13.m13.2.2.1.3.2.cmml">𝔼</mi><mrow id="S3.SS1.p2.13.m13.2.2.1.3.3" xref="S3.SS1.p2.13.m13.2.2.1.3.3.cmml"><msub id="S3.SS1.p2.13.m13.2.2.1.3.3.2" xref="S3.SS1.p2.13.m13.2.2.1.3.3.2.cmml"><mi id="S3.SS1.p2.13.m13.2.2.1.3.3.2.2" xref="S3.SS1.p2.13.m13.2.2.1.3.3.2.2.cmml">s</mi><mn id="S3.SS1.p2.13.m13.2.2.1.3.3.2.3" xref="S3.SS1.p2.13.m13.2.2.1.3.3.2.3.cmml">1</mn></msub><mo id="S3.SS1.p2.13.m13.2.2.1.3.3.1" xref="S3.SS1.p2.13.m13.2.2.1.3.3.1.cmml">∼</mo><msub id="S3.SS1.p2.13.m13.2.2.1.3.3.3" xref="S3.SS1.p2.13.m13.2.2.1.3.3.3.cmml"><mi id="S3.SS1.p2.13.m13.2.2.1.3.3.3.2" xref="S3.SS1.p2.13.m13.2.2.1.3.3.3.2.cmml">ρ</mi><mn id="S3.SS1.p2.13.m13.2.2.1.3.3.3.3" xref="S3.SS1.p2.13.m13.2.2.1.3.3.3.3.cmml">1</mn></msub></mrow></msub><mo id="S3.SS1.p2.13.m13.2.2.1.2" xref="S3.SS1.p2.13.m13.2.2.1.2.cmml">⁢</mo><mrow id="S3.SS1.p2.13.m13.2.2.1.1.1" xref="S3.SS1.p2.13.m13.2.2.1.1.2.cmml"><mo id="S3.SS1.p2.13.m13.2.2.1.1.1.2" xref="S3.SS1.p2.13.m13.2.2.1.1.2.1.cmml">[</mo><mrow id="S3.SS1.p2.13.m13.2.2.1.1.1.1" xref="S3.SS1.p2.13.m13.2.2.1.1.1.1.cmml"><msup id="S3.SS1.p2.13.m13.2.2.1.1.1.1.3" xref="S3.SS1.p2.13.m13.2.2.1.1.1.1.3.cmml"><mi id="S3.SS1.p2.13.m13.2.2.1.1.1.1.3.2" xref="S3.SS1.p2.13.m13.2.2.1.1.1.1.3.2.cmml">V</mi><mi id="S3.SS1.p2.13.m13.2.2.1.1.1.1.3.3" xref="S3.SS1.p2.13.m13.2.2.1.1.1.1.3.3.cmml">π</mi></msup><mo id="S3.SS1.p2.13.m13.2.2.1.1.1.1.2" xref="S3.SS1.p2.13.m13.2.2.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.SS1.p2.13.m13.2.2.1.1.1.1.1.1" xref="S3.SS1.p2.13.m13.2.2.1.1.1.1.1.1.1.cmml"><mo id="S3.SS1.p2.13.m13.2.2.1.1.1.1.1.1.2" stretchy="false" xref="S3.SS1.p2.13.m13.2.2.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.SS1.p2.13.m13.2.2.1.1.1.1.1.1.1" xref="S3.SS1.p2.13.m13.2.2.1.1.1.1.1.1.1.cmml"><mi id="S3.SS1.p2.13.m13.2.2.1.1.1.1.1.1.1.2" xref="S3.SS1.p2.13.m13.2.2.1.1.1.1.1.1.1.2.cmml">s</mi><mn id="S3.SS1.p2.13.m13.2.2.1.1.1.1.1.1.1.3" xref="S3.SS1.p2.13.m13.2.2.1.1.1.1.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS1.p2.13.m13.2.2.1.1.1.1.1.1.3" stretchy="false" xref="S3.SS1.p2.13.m13.2.2.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS1.p2.13.m13.2.2.1.1.1.3" xref="S3.SS1.p2.13.m13.2.2.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.13.m13.2b"><apply id="S3.SS1.p2.13.m13.2.2.cmml" xref="S3.SS1.p2.13.m13.2.2"><eq id="S3.SS1.p2.13.m13.2.2.2.cmml" xref="S3.SS1.p2.13.m13.2.2.2"></eq><apply id="S3.SS1.p2.13.m13.2.2.3.cmml" xref="S3.SS1.p2.13.m13.2.2.3"><times id="S3.SS1.p2.13.m13.2.2.3.1.cmml" xref="S3.SS1.p2.13.m13.2.2.3.1"></times><ci id="S3.SS1.p2.13.m13.2.2.3.2.cmml" xref="S3.SS1.p2.13.m13.2.2.3.2">𝐽</ci><ci id="S3.SS1.p2.13.m13.1.1.cmml" xref="S3.SS1.p2.13.m13.1.1">𝜋</ci></apply><apply id="S3.SS1.p2.13.m13.2.2.1.cmml" xref="S3.SS1.p2.13.m13.2.2.1"><times id="S3.SS1.p2.13.m13.2.2.1.2.cmml" xref="S3.SS1.p2.13.m13.2.2.1.2"></times><apply id="S3.SS1.p2.13.m13.2.2.1.3.cmml" xref="S3.SS1.p2.13.m13.2.2.1.3"><csymbol cd="ambiguous" id="S3.SS1.p2.13.m13.2.2.1.3.1.cmml" xref="S3.SS1.p2.13.m13.2.2.1.3">subscript</csymbol><ci id="S3.SS1.p2.13.m13.2.2.1.3.2.cmml" xref="S3.SS1.p2.13.m13.2.2.1.3.2">𝔼</ci><apply id="S3.SS1.p2.13.m13.2.2.1.3.3.cmml" xref="S3.SS1.p2.13.m13.2.2.1.3.3"><csymbol cd="latexml" id="S3.SS1.p2.13.m13.2.2.1.3.3.1.cmml" xref="S3.SS1.p2.13.m13.2.2.1.3.3.1">similar-to</csymbol><apply id="S3.SS1.p2.13.m13.2.2.1.3.3.2.cmml" xref="S3.SS1.p2.13.m13.2.2.1.3.3.2"><csymbol cd="ambiguous" id="S3.SS1.p2.13.m13.2.2.1.3.3.2.1.cmml" xref="S3.SS1.p2.13.m13.2.2.1.3.3.2">subscript</csymbol><ci id="S3.SS1.p2.13.m13.2.2.1.3.3.2.2.cmml" xref="S3.SS1.p2.13.m13.2.2.1.3.3.2.2">𝑠</ci><cn id="S3.SS1.p2.13.m13.2.2.1.3.3.2.3.cmml" type="integer" xref="S3.SS1.p2.13.m13.2.2.1.3.3.2.3">1</cn></apply><apply id="S3.SS1.p2.13.m13.2.2.1.3.3.3.cmml" xref="S3.SS1.p2.13.m13.2.2.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p2.13.m13.2.2.1.3.3.3.1.cmml" xref="S3.SS1.p2.13.m13.2.2.1.3.3.3">subscript</csymbol><ci id="S3.SS1.p2.13.m13.2.2.1.3.3.3.2.cmml" xref="S3.SS1.p2.13.m13.2.2.1.3.3.3.2">𝜌</ci><cn id="S3.SS1.p2.13.m13.2.2.1.3.3.3.3.cmml" type="integer" xref="S3.SS1.p2.13.m13.2.2.1.3.3.3.3">1</cn></apply></apply></apply><apply id="S3.SS1.p2.13.m13.2.2.1.1.2.cmml" xref="S3.SS1.p2.13.m13.2.2.1.1.1"><csymbol cd="latexml" id="S3.SS1.p2.13.m13.2.2.1.1.2.1.cmml" xref="S3.SS1.p2.13.m13.2.2.1.1.1.2">delimited-[]</csymbol><apply id="S3.SS1.p2.13.m13.2.2.1.1.1.1.cmml" xref="S3.SS1.p2.13.m13.2.2.1.1.1.1"><times id="S3.SS1.p2.13.m13.2.2.1.1.1.1.2.cmml" xref="S3.SS1.p2.13.m13.2.2.1.1.1.1.2"></times><apply id="S3.SS1.p2.13.m13.2.2.1.1.1.1.3.cmml" xref="S3.SS1.p2.13.m13.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p2.13.m13.2.2.1.1.1.1.3.1.cmml" xref="S3.SS1.p2.13.m13.2.2.1.1.1.1.3">superscript</csymbol><ci id="S3.SS1.p2.13.m13.2.2.1.1.1.1.3.2.cmml" xref="S3.SS1.p2.13.m13.2.2.1.1.1.1.3.2">𝑉</ci><ci id="S3.SS1.p2.13.m13.2.2.1.1.1.1.3.3.cmml" xref="S3.SS1.p2.13.m13.2.2.1.1.1.1.3.3">𝜋</ci></apply><apply id="S3.SS1.p2.13.m13.2.2.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p2.13.m13.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.13.m13.2.2.1.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p2.13.m13.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p2.13.m13.2.2.1.1.1.1.1.1.1.2.cmml" xref="S3.SS1.p2.13.m13.2.2.1.1.1.1.1.1.1.2">𝑠</ci><cn id="S3.SS1.p2.13.m13.2.2.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S3.SS1.p2.13.m13.2.2.1.1.1.1.1.1.1.3">1</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.13.m13.2c">J(\pi)=\mathbb{E}_{s_{1}\sim\rho_{1}}\left[V^{\pi}(s_{1})\right]</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.13.m13.2d">italic_J ( italic_π ) = blackboard_E start_POSTSUBSCRIPT italic_s start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ∼ italic_ρ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT [ italic_V start_POSTSUPERSCRIPT italic_π end_POSTSUPERSCRIPT ( italic_s start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ) ]</annotation></semantics></math>.
The goal of RL is to optimize a policy <math alttext="\pi(\cdot\mid s)" class="ltx_math_unparsed" display="inline" id="S3.SS1.p2.14.m14.1"><semantics id="S3.SS1.p2.14.m14.1a"><mrow id="S3.SS1.p2.14.m14.1b"><mi id="S3.SS1.p2.14.m14.1.1">π</mi><mrow id="S3.SS1.p2.14.m14.1.2"><mo id="S3.SS1.p2.14.m14.1.2.1" stretchy="false">(</mo><mo id="S3.SS1.p2.14.m14.1.2.2" lspace="0em" rspace="0em">⋅</mo><mo id="S3.SS1.p2.14.m14.1.2.3" lspace="0em" rspace="0.167em">∣</mo><mi id="S3.SS1.p2.14.m14.1.2.4">s</mi><mo id="S3.SS1.p2.14.m14.1.2.5" stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="S3.SS1.p2.14.m14.1c">\pi(\cdot\mid s)</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.14.m14.1d">italic_π ( ⋅ ∣ italic_s )</annotation></semantics></math> that maximizes the cumulative reward
<math alttext="\pi^{*}(\cdot\mid s)=\underset{\pi}{\operatorname{argmax}}\;J(\pi)" class="ltx_math_unparsed" display="inline" id="S3.SS1.p2.15.m15.1"><semantics id="S3.SS1.p2.15.m15.1a"><mrow id="S3.SS1.p2.15.m15.1b"><msup id="S3.SS1.p2.15.m15.1.1"><mi id="S3.SS1.p2.15.m15.1.1.2">π</mi><mo id="S3.SS1.p2.15.m15.1.1.3">∗</mo></msup><mrow id="S3.SS1.p2.15.m15.1.2"><mo id="S3.SS1.p2.15.m15.1.2.1" stretchy="false">(</mo><mo id="S3.SS1.p2.15.m15.1.2.2" lspace="0em" rspace="0em">⋅</mo><mo id="S3.SS1.p2.15.m15.1.2.3" lspace="0em" rspace="0.167em">∣</mo><mi id="S3.SS1.p2.15.m15.1.2.4">s</mi><mo id="S3.SS1.p2.15.m15.1.2.5" stretchy="false">)</mo></mrow><mo id="S3.SS1.p2.15.m15.1.3">=</mo><munder accentunder="true" id="S3.SS1.p2.15.m15.1.4"><mi id="S3.SS1.p2.15.m15.1.4.2">argmax</mi><mo id="S3.SS1.p2.15.m15.1.4.1">𝜋</mo></munder><mi id="S3.SS1.p2.15.m15.1.5">J</mi><mrow id="S3.SS1.p2.15.m15.1.6"><mo id="S3.SS1.p2.15.m15.1.6.1" stretchy="false">(</mo><mi id="S3.SS1.p2.15.m15.1.6.2">π</mi><mo id="S3.SS1.p2.15.m15.1.6.3" stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="S3.SS1.p2.15.m15.1c">\pi^{*}(\cdot\mid s)=\underset{\pi}{\operatorname{argmax}}\;J(\pi)</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.15.m15.1d">italic_π start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ( ⋅ ∣ italic_s ) = underitalic_π start_ARG roman_argmax end_ARG italic_J ( italic_π )</annotation></semantics></math>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS1.p3">
<p class="ltx_p" id="S3.SS1.p3.6">In large-scale or continuous environments, solving reinforcement learning (RL) problems can be challenging due to the prohibitively high computational cost. To address this issue, function approximation is often employed to estimate value functions and policies.
With function approximation, we present <math alttext="Q^{\pi},\pi" class="ltx_Math" display="inline" id="S3.SS1.p3.1.m1.2"><semantics id="S3.SS1.p3.1.m1.2a"><mrow id="S3.SS1.p3.1.m1.2.2.1" xref="S3.SS1.p3.1.m1.2.2.2.cmml"><msup id="S3.SS1.p3.1.m1.2.2.1.1" xref="S3.SS1.p3.1.m1.2.2.1.1.cmml"><mi id="S3.SS1.p3.1.m1.2.2.1.1.2" xref="S3.SS1.p3.1.m1.2.2.1.1.2.cmml">Q</mi><mi id="S3.SS1.p3.1.m1.2.2.1.1.3" xref="S3.SS1.p3.1.m1.2.2.1.1.3.cmml">π</mi></msup><mo id="S3.SS1.p3.1.m1.2.2.1.2" xref="S3.SS1.p3.1.m1.2.2.2.cmml">,</mo><mi id="S3.SS1.p3.1.m1.1.1" xref="S3.SS1.p3.1.m1.1.1.cmml">π</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.1.m1.2b"><list id="S3.SS1.p3.1.m1.2.2.2.cmml" xref="S3.SS1.p3.1.m1.2.2.1"><apply id="S3.SS1.p3.1.m1.2.2.1.1.cmml" xref="S3.SS1.p3.1.m1.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.1.m1.2.2.1.1.1.cmml" xref="S3.SS1.p3.1.m1.2.2.1.1">superscript</csymbol><ci id="S3.SS1.p3.1.m1.2.2.1.1.2.cmml" xref="S3.SS1.p3.1.m1.2.2.1.1.2">𝑄</ci><ci id="S3.SS1.p3.1.m1.2.2.1.1.3.cmml" xref="S3.SS1.p3.1.m1.2.2.1.1.3">𝜋</ci></apply><ci id="S3.SS1.p3.1.m1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1">𝜋</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.1.m1.2c">Q^{\pi},\pi</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.1.m1.2d">italic_Q start_POSTSUPERSCRIPT italic_π end_POSTSUPERSCRIPT , italic_π</annotation></semantics></math> as <math alttext="Q_{\theta^{Q}},\pi_{\psi}" class="ltx_Math" display="inline" id="S3.SS1.p3.2.m2.2"><semantics id="S3.SS1.p3.2.m2.2a"><mrow id="S3.SS1.p3.2.m2.2.2.2" xref="S3.SS1.p3.2.m2.2.2.3.cmml"><msub id="S3.SS1.p3.2.m2.1.1.1.1" xref="S3.SS1.p3.2.m2.1.1.1.1.cmml"><mi id="S3.SS1.p3.2.m2.1.1.1.1.2" xref="S3.SS1.p3.2.m2.1.1.1.1.2.cmml">Q</mi><msup id="S3.SS1.p3.2.m2.1.1.1.1.3" xref="S3.SS1.p3.2.m2.1.1.1.1.3.cmml"><mi id="S3.SS1.p3.2.m2.1.1.1.1.3.2" xref="S3.SS1.p3.2.m2.1.1.1.1.3.2.cmml">θ</mi><mi id="S3.SS1.p3.2.m2.1.1.1.1.3.3" xref="S3.SS1.p3.2.m2.1.1.1.1.3.3.cmml">Q</mi></msup></msub><mo id="S3.SS1.p3.2.m2.2.2.2.3" xref="S3.SS1.p3.2.m2.2.2.3.cmml">,</mo><msub id="S3.SS1.p3.2.m2.2.2.2.2" xref="S3.SS1.p3.2.m2.2.2.2.2.cmml"><mi id="S3.SS1.p3.2.m2.2.2.2.2.2" xref="S3.SS1.p3.2.m2.2.2.2.2.2.cmml">π</mi><mi id="S3.SS1.p3.2.m2.2.2.2.2.3" xref="S3.SS1.p3.2.m2.2.2.2.2.3.cmml">ψ</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.2.m2.2b"><list id="S3.SS1.p3.2.m2.2.2.3.cmml" xref="S3.SS1.p3.2.m2.2.2.2"><apply id="S3.SS1.p3.2.m2.1.1.1.1.cmml" xref="S3.SS1.p3.2.m2.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.2.m2.1.1.1.1.1.cmml" xref="S3.SS1.p3.2.m2.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p3.2.m2.1.1.1.1.2.cmml" xref="S3.SS1.p3.2.m2.1.1.1.1.2">𝑄</ci><apply id="S3.SS1.p3.2.m2.1.1.1.1.3.cmml" xref="S3.SS1.p3.2.m2.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p3.2.m2.1.1.1.1.3.1.cmml" xref="S3.SS1.p3.2.m2.1.1.1.1.3">superscript</csymbol><ci id="S3.SS1.p3.2.m2.1.1.1.1.3.2.cmml" xref="S3.SS1.p3.2.m2.1.1.1.1.3.2">𝜃</ci><ci id="S3.SS1.p3.2.m2.1.1.1.1.3.3.cmml" xref="S3.SS1.p3.2.m2.1.1.1.1.3.3">𝑄</ci></apply></apply><apply id="S3.SS1.p3.2.m2.2.2.2.2.cmml" xref="S3.SS1.p3.2.m2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p3.2.m2.2.2.2.2.1.cmml" xref="S3.SS1.p3.2.m2.2.2.2.2">subscript</csymbol><ci id="S3.SS1.p3.2.m2.2.2.2.2.2.cmml" xref="S3.SS1.p3.2.m2.2.2.2.2.2">𝜋</ci><ci id="S3.SS1.p3.2.m2.2.2.2.2.3.cmml" xref="S3.SS1.p3.2.m2.2.2.2.2.3">𝜓</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.2.m2.2c">Q_{\theta^{Q}},\pi_{\psi}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.2.m2.2d">italic_Q start_POSTSUBSCRIPT italic_θ start_POSTSUPERSCRIPT italic_Q end_POSTSUPERSCRIPT end_POSTSUBSCRIPT , italic_π start_POSTSUBSCRIPT italic_ψ end_POSTSUBSCRIPT</annotation></semantics></math>, with <math alttext="\theta^{Q}" class="ltx_Math" display="inline" id="S3.SS1.p3.3.m3.1"><semantics id="S3.SS1.p3.3.m3.1a"><msup id="S3.SS1.p3.3.m3.1.1" xref="S3.SS1.p3.3.m3.1.1.cmml"><mi id="S3.SS1.p3.3.m3.1.1.2" xref="S3.SS1.p3.3.m3.1.1.2.cmml">θ</mi><mi id="S3.SS1.p3.3.m3.1.1.3" xref="S3.SS1.p3.3.m3.1.1.3.cmml">Q</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.3.m3.1b"><apply id="S3.SS1.p3.3.m3.1.1.cmml" xref="S3.SS1.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.3.m3.1.1.1.cmml" xref="S3.SS1.p3.3.m3.1.1">superscript</csymbol><ci id="S3.SS1.p3.3.m3.1.1.2.cmml" xref="S3.SS1.p3.3.m3.1.1.2">𝜃</ci><ci id="S3.SS1.p3.3.m3.1.1.3.cmml" xref="S3.SS1.p3.3.m3.1.1.3">𝑄</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.3.m3.1c">\theta^{Q}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.3.m3.1d">italic_θ start_POSTSUPERSCRIPT italic_Q end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="\psi" class="ltx_Math" display="inline" id="S3.SS1.p3.4.m4.1"><semantics id="S3.SS1.p3.4.m4.1a"><mi id="S3.SS1.p3.4.m4.1.1" xref="S3.SS1.p3.4.m4.1.1.cmml">ψ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.4.m4.1b"><ci id="S3.SS1.p3.4.m4.1.1.cmml" xref="S3.SS1.p3.4.m4.1.1">𝜓</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.4.m4.1c">\psi</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.4.m4.1d">italic_ψ</annotation></semantics></math> as their parameters. With a replay buffer <math alttext="\mathcal{{\mathcal{B}}}" class="ltx_Math" display="inline" id="S3.SS1.p3.5.m5.1"><semantics id="S3.SS1.p3.5.m5.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p3.5.m5.1.1" xref="S3.SS1.p3.5.m5.1.1.cmml">ℬ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.5.m5.1b"><ci id="S3.SS1.p3.5.m5.1.1.cmml" xref="S3.SS1.p3.5.m5.1.1">ℬ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.5.m5.1c">\mathcal{{\mathcal{B}}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.5.m5.1d">caligraphic_B</annotation></semantics></math>, the policy evaluation and improvement steps at iteration <math alttext="k" class="ltx_Math" display="inline" id="S3.SS1.p3.6.m6.1"><semantics id="S3.SS1.p3.6.m6.1a"><mi id="S3.SS1.p3.6.m6.1.1" xref="S3.SS1.p3.6.m6.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.6.m6.1b"><ci id="S3.SS1.p3.6.m6.1.1.cmml" xref="S3.SS1.p3.6.m6.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.6.m6.1c">k</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.6.m6.1d">italic_k</annotation></semantics></math> can be expressed as:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\begin{split}\theta^{Q}_{k+1}\leftarrow&amp;\underset{\theta^{Q}}{\operatorname{%
argmin}}\;\mathbb{E}_{(s,a,r,s^{\prime})\sim\mathcal{{\mathcal{B}}}}\left[%
\left(Q_{\theta^{Q}}(s,a)-{\mathcal{R}}(s,a)-\gamma\mathbb{E}_{a^{\prime}\sim%
\pi_{\theta^{\pi}_{k}}(\cdot|s)}[Q_{\bar{\theta}^{Q}_{k}}(s,a^{\prime})]\right%
)^{2}\right]\\
\psi_{k+1}\leftarrow&amp;\underset{\psi}{\operatorname{argmax}}\;\mathbb{E}_{s\sim%
\mathcal{{\mathcal{B}}},a\sim\pi_{\psi}(\cdot|s)}\left[Q_{\theta^{Q}_{k+1}}(s,%
a)\right]\,,\end{split}" class="ltx_math_unparsed" display="block" id="S3.E1.m1.59"><semantics id="S3.E1.m1.59a"><mtable columnspacing="0pt" displaystyle="true" id="S3.E1.m1.59.59.3" rowspacing="0pt"><mtr id="S3.E1.m1.59.59.3a"><mtd class="ltx_align_right" columnalign="right" id="S3.E1.m1.59.59.3b"><mrow id="S3.E1.m1.4.4.4.4.4"><msubsup id="S3.E1.m1.4.4.4.4.4.5"><mi id="S3.E1.m1.1.1.1.1.1.1">θ</mi><mrow id="S3.E1.m1.3.3.3.3.3.3.1"><mi id="S3.E1.m1.3.3.3.3.3.3.1.2">k</mi><mo id="S3.E1.m1.3.3.3.3.3.3.1.1">+</mo><mn id="S3.E1.m1.3.3.3.3.3.3.1.3">1</mn></mrow><mi id="S3.E1.m1.2.2.2.2.2.2.1">Q</mi></msubsup><mo id="S3.E1.m1.4.4.4.4.4.4" stretchy="false">←</mo><mi id="S3.E1.m1.4.4.4.4.4.6"></mi></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E1.m1.59.59.3c"><mrow id="S3.E1.m1.58.58.2.57.41.37"><munder accentunder="true" id="S3.E1.m1.5.5.5.5.1.1"><mi id="S3.E1.m1.5.5.5.5.1.1.2">argmin</mi><msup id="S3.E1.m1.5.5.5.5.1.1.1"><mi id="S3.E1.m1.5.5.5.5.1.1.1.2">θ</mi><mi id="S3.E1.m1.5.5.5.5.1.1.1.3">Q</mi></msup></munder><mo id="S3.E1.m1.58.58.2.57.41.37.38" lspace="0.447em">⁢</mo><msub id="S3.E1.m1.58.58.2.57.41.37.39"><mi id="S3.E1.m1.6.6.6.6.2.2">𝔼</mi><mrow id="S3.E1.m1.7.7.7.7.3.3.1"><mrow id="S3.E1.m1.7.7.7.7.3.3.1.4.1"><mo id="S3.E1.m1.7.7.7.7.3.3.1.4.1.2" stretchy="false">(</mo><mi id="S3.E1.m1.7.7.7.7.3.3.1.1">s</mi><mo id="S3.E1.m1.7.7.7.7.3.3.1.4.1.3">,</mo><mi id="S3.E1.m1.7.7.7.7.3.3.1.2">a</mi><mo id="S3.E1.m1.7.7.7.7.3.3.1.4.1.4">,</mo><mi id="S3.E1.m1.7.7.7.7.3.3.1.3">r</mi><mo id="S3.E1.m1.7.7.7.7.3.3.1.4.1.5">,</mo><msup id="S3.E1.m1.7.7.7.7.3.3.1.4.1.1"><mi id="S3.E1.m1.7.7.7.7.3.3.1.4.1.1.2">s</mi><mo id="S3.E1.m1.7.7.7.7.3.3.1.4.1.1.3">′</mo></msup><mo id="S3.E1.m1.7.7.7.7.3.3.1.4.1.6" stretchy="false">)</mo></mrow><mo id="S3.E1.m1.7.7.7.7.3.3.1.5">∼</mo><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.7.7.7.7.3.3.1.6">ℬ</mi></mrow></msub><mo id="S3.E1.m1.58.58.2.57.41.37.38a">⁢</mo><mrow id="S3.E1.m1.58.58.2.57.41.37.37.1"><mo id="S3.E1.m1.8.8.8.8.4.4">[</mo><msup id="S3.E1.m1.58.58.2.57.41.37.37.1.1"><mrow id="S3.E1.m1.58.58.2.57.41.37.37.1.1.1.1"><mo id="S3.E1.m1.9.9.9.9.5.5">(</mo><mrow id="S3.E1.m1.58.58.2.57.41.37.37.1.1.1.1.1"><mrow id="S3.E1.m1.58.58.2.57.41.37.37.1.1.1.1.1.2"><msub id="S3.E1.m1.58.58.2.57.41.37.37.1.1.1.1.1.2.2"><mi id="S3.E1.m1.10.10.10.10.6.6">Q</mi><msup id="S3.E1.m1.11.11.11.11.7.7.1"><mi id="S3.E1.m1.11.11.11.11.7.7.1.2">θ</mi><mi id="S3.E1.m1.11.11.11.11.7.7.1.3">Q</mi></msup></msub><mo id="S3.E1.m1.58.58.2.57.41.37.37.1.1.1.1.1.2.1">⁢</mo><mrow id="S3.E1.m1.58.58.2.57.41.37.37.1.1.1.1.1.2.3"><mo id="S3.E1.m1.12.12.12.12.8.8" stretchy="false">(</mo><mi id="S3.E1.m1.13.13.13.13.9.9">s</mi><mo id="S3.E1.m1.14.14.14.14.10.10">,</mo><mi id="S3.E1.m1.15.15.15.15.11.11">a</mi><mo id="S3.E1.m1.16.16.16.16.12.12" stretchy="false">)</mo></mrow></mrow><mo id="S3.E1.m1.17.17.17.17.13.13">−</mo><mrow id="S3.E1.m1.58.58.2.57.41.37.37.1.1.1.1.1.3"><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.18.18.18.18.14.14">ℛ</mi><mo id="S3.E1.m1.58.58.2.57.41.37.37.1.1.1.1.1.3.1">⁢</mo><mrow id="S3.E1.m1.58.58.2.57.41.37.37.1.1.1.1.1.3.2"><mo id="S3.E1.m1.19.19.19.19.15.15" stretchy="false">(</mo><mi id="S3.E1.m1.20.20.20.20.16.16">s</mi><mo id="S3.E1.m1.21.21.21.21.17.17">,</mo><mi id="S3.E1.m1.22.22.22.22.18.18">a</mi><mo id="S3.E1.m1.23.23.23.23.19.19" stretchy="false">)</mo></mrow></mrow><mo id="S3.E1.m1.17.17.17.17.13.13a">−</mo><mrow id="S3.E1.m1.58.58.2.57.41.37.37.1.1.1.1.1.1"><mi id="S3.E1.m1.25.25.25.25.21.21">γ</mi><mo id="S3.E1.m1.58.58.2.57.41.37.37.1.1.1.1.1.1.2">⁢</mo><msub id="S3.E1.m1.58.58.2.57.41.37.37.1.1.1.1.1.1.3"><mi id="S3.E1.m1.26.26.26.26.22.22">𝔼</mi><mrow id="S3.E1.m1.27.27.27.27.23.23.1"><msup id="S3.E1.m1.27.27.27.27.23.23.1.1"><mi id="S3.E1.m1.27.27.27.27.23.23.1.1.2">a</mi><mo id="S3.E1.m1.27.27.27.27.23.23.1.1.3">′</mo></msup><mo id="S3.E1.m1.27.27.27.27.23.23.1.2">∼</mo><msub id="S3.E1.m1.27.27.27.27.23.23.1.3"><mi id="S3.E1.m1.27.27.27.27.23.23.1.3.2">π</mi><msubsup id="S3.E1.m1.27.27.27.27.23.23.1.3.3"><mi id="S3.E1.m1.27.27.27.27.23.23.1.3.3.2.2">θ</mi><mi id="S3.E1.m1.27.27.27.27.23.23.1.3.3.3">k</mi><mi id="S3.E1.m1.27.27.27.27.23.23.1.3.3.2.3">π</mi></msubsup></msub><mrow id="S3.E1.m1.27.27.27.27.23.23.1.4"><mo id="S3.E1.m1.27.27.27.27.23.23.1.4.1" stretchy="false">(</mo><mo id="S3.E1.m1.27.27.27.27.23.23.1.4.2" lspace="0em" rspace="0em">⋅</mo><mo fence="false" id="S3.E1.m1.27.27.27.27.23.23.1.4.3" rspace="0.167em" stretchy="false">|</mo><mi id="S3.E1.m1.27.27.27.27.23.23.1.4.4">s</mi><mo id="S3.E1.m1.27.27.27.27.23.23.1.4.5" stretchy="false">)</mo></mrow></mrow></msub><mo id="S3.E1.m1.58.58.2.57.41.37.37.1.1.1.1.1.1.2a">⁢</mo><mrow id="S3.E1.m1.58.58.2.57.41.37.37.1.1.1.1.1.1.1.1"><mo id="S3.E1.m1.28.28.28.28.24.24" stretchy="false">[</mo><mrow id="S3.E1.m1.58.58.2.57.41.37.37.1.1.1.1.1.1.1.1.1"><msub id="S3.E1.m1.58.58.2.57.41.37.37.1.1.1.1.1.1.1.1.1.3"><mi id="S3.E1.m1.29.29.29.29.25.25">Q</mi><msubsup id="S3.E1.m1.30.30.30.30.26.26.1"><mover accent="true" id="S3.E1.m1.30.30.30.30.26.26.1.2.2"><mi id="S3.E1.m1.30.30.30.30.26.26.1.2.2.2">θ</mi><mo id="S3.E1.m1.30.30.30.30.26.26.1.2.2.1">¯</mo></mover><mi id="S3.E1.m1.30.30.30.30.26.26.1.3">k</mi><mi id="S3.E1.m1.30.30.30.30.26.26.1.2.3">Q</mi></msubsup></msub><mo id="S3.E1.m1.58.58.2.57.41.37.37.1.1.1.1.1.1.1.1.1.2">⁢</mo><mrow id="S3.E1.m1.58.58.2.57.41.37.37.1.1.1.1.1.1.1.1.1.1.1"><mo id="S3.E1.m1.31.31.31.31.27.27" stretchy="false">(</mo><mi id="S3.E1.m1.32.32.32.32.28.28">s</mi><mo id="S3.E1.m1.33.33.33.33.29.29">,</mo><msup id="S3.E1.m1.58.58.2.57.41.37.37.1.1.1.1.1.1.1.1.1.1.1.1"><mi id="S3.E1.m1.34.34.34.34.30.30">a</mi><mo id="S3.E1.m1.35.35.35.35.31.31.1">′</mo></msup><mo id="S3.E1.m1.36.36.36.36.32.32" stretchy="false">)</mo></mrow></mrow><mo id="S3.E1.m1.37.37.37.37.33.33" stretchy="false">]</mo></mrow></mrow></mrow><mo id="S3.E1.m1.38.38.38.38.34.34">)</mo></mrow><mn id="S3.E1.m1.39.39.39.39.35.35.1">2</mn></msup><mo id="S3.E1.m1.40.40.40.40.36.36">]</mo></mrow></mrow></mtd></mtr><mtr id="S3.E1.m1.59.59.3d"><mtd class="ltx_align_right" columnalign="right" id="S3.E1.m1.59.59.3e"><mrow id="S3.E1.m1.43.43.43.3.3"><msub id="S3.E1.m1.43.43.43.3.3.4"><mi id="S3.E1.m1.41.41.41.1.1.1">ψ</mi><mrow id="S3.E1.m1.42.42.42.2.2.2.1"><mi id="S3.E1.m1.42.42.42.2.2.2.1.2">k</mi><mo id="S3.E1.m1.42.42.42.2.2.2.1.1">+</mo><mn id="S3.E1.m1.42.42.42.2.2.2.1.3">1</mn></mrow></msub><mo id="S3.E1.m1.43.43.43.3.3.3" stretchy="false">←</mo><mi id="S3.E1.m1.43.43.43.3.3.5"></mi></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E1.m1.59.59.3f"><mrow id="S3.E1.m1.59.59.3.58.17.14.14"><mrow id="S3.E1.m1.59.59.3.58.17.14.14.1"><munder accentunder="true" id="S3.E1.m1.44.44.44.4.1.1"><mi id="S3.E1.m1.44.44.44.4.1.1.2">argmax</mi><mo id="S3.E1.m1.44.44.44.4.1.1.1">𝜓</mo></munder><mo id="S3.E1.m1.59.59.3.58.17.14.14.1.2" lspace="0.447em">⁢</mo><msub id="S3.E1.m1.59.59.3.58.17.14.14.1.3"><mi id="S3.E1.m1.45.45.45.5.2.2">𝔼</mi><mrow id="S3.E1.m1.46.46.46.6.3.3.1"><mi id="S3.E1.m1.46.46.46.6.3.3.1.1">s</mi><mo id="S3.E1.m1.46.46.46.6.3.3.1.2">∼</mo><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.46.46.46.6.3.3.1.3">ℬ</mi><mo id="S3.E1.m1.46.46.46.6.3.3.1.4">,</mo><mi id="S3.E1.m1.46.46.46.6.3.3.1.5">a</mi><mo id="S3.E1.m1.46.46.46.6.3.3.1.6">∼</mo><msub id="S3.E1.m1.46.46.46.6.3.3.1.7"><mi id="S3.E1.m1.46.46.46.6.3.3.1.7.2">π</mi><mi id="S3.E1.m1.46.46.46.6.3.3.1.7.3">ψ</mi></msub><mrow id="S3.E1.m1.46.46.46.6.3.3.1.8"><mo id="S3.E1.m1.46.46.46.6.3.3.1.8.1" stretchy="false">(</mo><mo id="S3.E1.m1.46.46.46.6.3.3.1.8.2" lspace="0em" rspace="0em">⋅</mo><mo fence="false" id="S3.E1.m1.46.46.46.6.3.3.1.8.3" rspace="0.167em" stretchy="false">|</mo><mi id="S3.E1.m1.46.46.46.6.3.3.1.8.4">s</mi><mo id="S3.E1.m1.46.46.46.6.3.3.1.8.5" stretchy="false">)</mo></mrow></mrow></msub><mo id="S3.E1.m1.59.59.3.58.17.14.14.1.2a">⁢</mo><mrow id="S3.E1.m1.59.59.3.58.17.14.14.1.1.1"><mo id="S3.E1.m1.47.47.47.7.4.4">[</mo><mrow id="S3.E1.m1.59.59.3.58.17.14.14.1.1.1.1"><msub id="S3.E1.m1.59.59.3.58.17.14.14.1.1.1.1.2"><mi id="S3.E1.m1.48.48.48.8.5.5">Q</mi><msubsup id="S3.E1.m1.49.49.49.9.6.6.1"><mi id="S3.E1.m1.49.49.49.9.6.6.1.2.2">θ</mi><mrow id="S3.E1.m1.49.49.49.9.6.6.1.3"><mi id="S3.E1.m1.49.49.49.9.6.6.1.3.2">k</mi><mo id="S3.E1.m1.49.49.49.9.6.6.1.3.1">+</mo><mn id="S3.E1.m1.49.49.49.9.6.6.1.3.3">1</mn></mrow><mi id="S3.E1.m1.49.49.49.9.6.6.1.2.3">Q</mi></msubsup></msub><mo id="S3.E1.m1.59.59.3.58.17.14.14.1.1.1.1.1">⁢</mo><mrow id="S3.E1.m1.59.59.3.58.17.14.14.1.1.1.1.3"><mo id="S3.E1.m1.50.50.50.10.7.7" stretchy="false">(</mo><mi id="S3.E1.m1.51.51.51.11.8.8">s</mi><mo id="S3.E1.m1.52.52.52.12.9.9">,</mo><mi id="S3.E1.m1.53.53.53.13.10.10">a</mi><mo id="S3.E1.m1.54.54.54.14.11.11" stretchy="false">)</mo></mrow></mrow><mo id="S3.E1.m1.55.55.55.15.12.12" rspace="0.170em">]</mo></mrow></mrow><mo id="S3.E1.m1.56.56.56.16.13.13">,</mo></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex" id="S3.E1.m1.59b">\begin{split}\theta^{Q}_{k+1}\leftarrow&amp;\underset{\theta^{Q}}{\operatorname{%
argmin}}\;\mathbb{E}_{(s,a,r,s^{\prime})\sim\mathcal{{\mathcal{B}}}}\left[%
\left(Q_{\theta^{Q}}(s,a)-{\mathcal{R}}(s,a)-\gamma\mathbb{E}_{a^{\prime}\sim%
\pi_{\theta^{\pi}_{k}}(\cdot|s)}[Q_{\bar{\theta}^{Q}_{k}}(s,a^{\prime})]\right%
)^{2}\right]\\
\psi_{k+1}\leftarrow&amp;\underset{\psi}{\operatorname{argmax}}\;\mathbb{E}_{s\sim%
\mathcal{{\mathcal{B}}},a\sim\pi_{\psi}(\cdot|s)}\left[Q_{\theta^{Q}_{k+1}}(s,%
a)\right]\,,\end{split}</annotation><annotation encoding="application/x-llamapun" id="S3.E1.m1.59c">start_ROW start_CELL italic_θ start_POSTSUPERSCRIPT italic_Q end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_k + 1 end_POSTSUBSCRIPT ← end_CELL start_CELL start_UNDERACCENT italic_θ start_POSTSUPERSCRIPT italic_Q end_POSTSUPERSCRIPT end_UNDERACCENT start_ARG roman_argmin end_ARG blackboard_E start_POSTSUBSCRIPT ( italic_s , italic_a , italic_r , italic_s start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ) ∼ caligraphic_B end_POSTSUBSCRIPT [ ( italic_Q start_POSTSUBSCRIPT italic_θ start_POSTSUPERSCRIPT italic_Q end_POSTSUPERSCRIPT end_POSTSUBSCRIPT ( italic_s , italic_a ) - caligraphic_R ( italic_s , italic_a ) - italic_γ blackboard_E start_POSTSUBSCRIPT italic_a start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ∼ italic_π start_POSTSUBSCRIPT italic_θ start_POSTSUPERSCRIPT italic_π end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( ⋅ | italic_s ) end_POSTSUBSCRIPT [ italic_Q start_POSTSUBSCRIPT over¯ start_ARG italic_θ end_ARG start_POSTSUPERSCRIPT italic_Q end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( italic_s , italic_a start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ) ] ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ] end_CELL end_ROW start_ROW start_CELL italic_ψ start_POSTSUBSCRIPT italic_k + 1 end_POSTSUBSCRIPT ← end_CELL start_CELL underitalic_ψ start_ARG roman_argmax end_ARG blackboard_E start_POSTSUBSCRIPT italic_s ∼ caligraphic_B , italic_a ∼ italic_π start_POSTSUBSCRIPT italic_ψ end_POSTSUBSCRIPT ( ⋅ | italic_s ) end_POSTSUBSCRIPT [ italic_Q start_POSTSUBSCRIPT italic_θ start_POSTSUPERSCRIPT italic_Q end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_k + 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( italic_s , italic_a ) ] , end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS1.p3.9">where <math alttext="\bar{\theta}^{Q}_{k}" class="ltx_Math" display="inline" id="S3.SS1.p3.7.m1.1"><semantics id="S3.SS1.p3.7.m1.1a"><msubsup id="S3.SS1.p3.7.m1.1.1" xref="S3.SS1.p3.7.m1.1.1.cmml"><mover accent="true" id="S3.SS1.p3.7.m1.1.1.2.2" xref="S3.SS1.p3.7.m1.1.1.2.2.cmml"><mi id="S3.SS1.p3.7.m1.1.1.2.2.2" xref="S3.SS1.p3.7.m1.1.1.2.2.2.cmml">θ</mi><mo id="S3.SS1.p3.7.m1.1.1.2.2.1" xref="S3.SS1.p3.7.m1.1.1.2.2.1.cmml">¯</mo></mover><mi id="S3.SS1.p3.7.m1.1.1.3" xref="S3.SS1.p3.7.m1.1.1.3.cmml">k</mi><mi id="S3.SS1.p3.7.m1.1.1.2.3" xref="S3.SS1.p3.7.m1.1.1.2.3.cmml">Q</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.7.m1.1b"><apply id="S3.SS1.p3.7.m1.1.1.cmml" xref="S3.SS1.p3.7.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.7.m1.1.1.1.cmml" xref="S3.SS1.p3.7.m1.1.1">subscript</csymbol><apply id="S3.SS1.p3.7.m1.1.1.2.cmml" xref="S3.SS1.p3.7.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.7.m1.1.1.2.1.cmml" xref="S3.SS1.p3.7.m1.1.1">superscript</csymbol><apply id="S3.SS1.p3.7.m1.1.1.2.2.cmml" xref="S3.SS1.p3.7.m1.1.1.2.2"><ci id="S3.SS1.p3.7.m1.1.1.2.2.1.cmml" xref="S3.SS1.p3.7.m1.1.1.2.2.1">¯</ci><ci id="S3.SS1.p3.7.m1.1.1.2.2.2.cmml" xref="S3.SS1.p3.7.m1.1.1.2.2.2">𝜃</ci></apply><ci id="S3.SS1.p3.7.m1.1.1.2.3.cmml" xref="S3.SS1.p3.7.m1.1.1.2.3">𝑄</ci></apply><ci id="S3.SS1.p3.7.m1.1.1.3.cmml" xref="S3.SS1.p3.7.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.7.m1.1c">\bar{\theta}^{Q}_{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.7.m1.1d">over¯ start_ARG italic_θ end_ARG start_POSTSUPERSCRIPT italic_Q end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> are target parameters that are a slow-moving copy of <math alttext="\theta^{Q}_{k}" class="ltx_Math" display="inline" id="S3.SS1.p3.8.m2.1"><semantics id="S3.SS1.p3.8.m2.1a"><msubsup id="S3.SS1.p3.8.m2.1.1" xref="S3.SS1.p3.8.m2.1.1.cmml"><mi id="S3.SS1.p3.8.m2.1.1.2.2" xref="S3.SS1.p3.8.m2.1.1.2.2.cmml">θ</mi><mi id="S3.SS1.p3.8.m2.1.1.3" xref="S3.SS1.p3.8.m2.1.1.3.cmml">k</mi><mi id="S3.SS1.p3.8.m2.1.1.2.3" xref="S3.SS1.p3.8.m2.1.1.2.3.cmml">Q</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.8.m2.1b"><apply id="S3.SS1.p3.8.m2.1.1.cmml" xref="S3.SS1.p3.8.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.8.m2.1.1.1.cmml" xref="S3.SS1.p3.8.m2.1.1">subscript</csymbol><apply id="S3.SS1.p3.8.m2.1.1.2.cmml" xref="S3.SS1.p3.8.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.8.m2.1.1.2.1.cmml" xref="S3.SS1.p3.8.m2.1.1">superscript</csymbol><ci id="S3.SS1.p3.8.m2.1.1.2.2.cmml" xref="S3.SS1.p3.8.m2.1.1.2.2">𝜃</ci><ci id="S3.SS1.p3.8.m2.1.1.2.3.cmml" xref="S3.SS1.p3.8.m2.1.1.2.3">𝑄</ci></apply><ci id="S3.SS1.p3.8.m2.1.1.3.cmml" xref="S3.SS1.p3.8.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.8.m2.1c">\theta^{Q}_{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.8.m2.1d">italic_θ start_POSTSUPERSCRIPT italic_Q end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math>. Note that in this paper, we denote <math alttext="\bar{\bullet}" class="ltx_Math" display="inline" id="S3.SS1.p3.9.m3.1"><semantics id="S3.SS1.p3.9.m3.1a"><mover accent="true" id="S3.SS1.p3.9.m3.1.1" xref="S3.SS1.p3.9.m3.1.1.cmml"><mo id="S3.SS1.p3.9.m3.1.1.2" xref="S3.SS1.p3.9.m3.1.1.2.cmml">∙</mo><mo id="S3.SS1.p3.9.m3.1.1.1" xref="S3.SS1.p3.9.m3.1.1.1.cmml">¯</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.9.m3.1b"><apply id="S3.SS1.p3.9.m3.1.1.cmml" xref="S3.SS1.p3.9.m3.1.1"><ci id="S3.SS1.p3.9.m3.1.1.1.cmml" xref="S3.SS1.p3.9.m3.1.1.1">¯</ci><ci id="S3.SS1.p3.9.m3.1.1.2.cmml" xref="S3.SS1.p3.9.m3.1.1.2">∙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.9.m3.1c">\bar{\bullet}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.9.m3.1d">over¯ start_ARG ∙ end_ARG</annotation></semantics></math> as target parameters in this paper.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Bisimulation Metric</h3>
<div class="ltx_para ltx_noindent" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.8">When working with high-dimensional state problems, it is often helpful to group ”similar” states into the same set. Bisimulation is a type of state abstraction that groups state <math alttext="s_{i}" class="ltx_Math" display="inline" id="S3.SS2.p1.1.m1.1"><semantics id="S3.SS2.p1.1.m1.1a"><msub id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml"><mi id="S3.SS2.p1.1.m1.1.1.2" xref="S3.SS2.p1.1.m1.1.1.2.cmml">s</mi><mi id="S3.SS2.p1.1.m1.1.1.3" xref="S3.SS2.p1.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><apply id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.p1.1.m1.1.1.2.cmml" xref="S3.SS2.p1.1.m1.1.1.2">𝑠</ci><ci id="S3.SS2.p1.1.m1.1.1.3.cmml" xref="S3.SS2.p1.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">s_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.1.m1.1d">italic_s start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="s_{j}" class="ltx_Math" display="inline" id="S3.SS2.p1.2.m2.1"><semantics id="S3.SS2.p1.2.m2.1a"><msub id="S3.SS2.p1.2.m2.1.1" xref="S3.SS2.p1.2.m2.1.1.cmml"><mi id="S3.SS2.p1.2.m2.1.1.2" xref="S3.SS2.p1.2.m2.1.1.2.cmml">s</mi><mi id="S3.SS2.p1.2.m2.1.1.3" xref="S3.SS2.p1.2.m2.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.1b"><apply id="S3.SS2.p1.2.m2.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.1.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.p1.2.m2.1.1.2.cmml" xref="S3.SS2.p1.2.m2.1.1.2">𝑠</ci><ci id="S3.SS2.p1.2.m2.1.1.3.cmml" xref="S3.SS2.p1.2.m2.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.1c">s_{j}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.2.m2.1d">italic_s start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> if they are ”behaviorally equivalent” <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#bib.bib30" title="">2006</a>)</cite>. A more concise definition states that two states are bisimilar if they yield the same immediate rewards and have equivalent distributions over future bisimilar states<cite class="ltx_cite ltx_citemacro_citep">(Larsen &amp; Skou, <a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#bib.bib27" title="">1989</a>; Givan et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#bib.bib8" title="">2003</a>)</cite>. Bisimulation metric quantifies the bisimilarity of two states <math alttext="s_{i}" class="ltx_Math" display="inline" id="S3.SS2.p1.3.m3.1"><semantics id="S3.SS2.p1.3.m3.1a"><msub id="S3.SS2.p1.3.m3.1.1" xref="S3.SS2.p1.3.m3.1.1.cmml"><mi id="S3.SS2.p1.3.m3.1.1.2" xref="S3.SS2.p1.3.m3.1.1.2.cmml">s</mi><mi id="S3.SS2.p1.3.m3.1.1.3" xref="S3.SS2.p1.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.3.m3.1b"><apply id="S3.SS2.p1.3.m3.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.3.m3.1.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS2.p1.3.m3.1.1.2.cmml" xref="S3.SS2.p1.3.m3.1.1.2">𝑠</ci><ci id="S3.SS2.p1.3.m3.1.1.3.cmml" xref="S3.SS2.p1.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.3.m3.1c">s_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.3.m3.1d">italic_s start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="s_{j}" class="ltx_Math" display="inline" id="S3.SS2.p1.4.m4.1"><semantics id="S3.SS2.p1.4.m4.1a"><msub id="S3.SS2.p1.4.m4.1.1" xref="S3.SS2.p1.4.m4.1.1.cmml"><mi id="S3.SS2.p1.4.m4.1.1.2" xref="S3.SS2.p1.4.m4.1.1.2.cmml">s</mi><mi id="S3.SS2.p1.4.m4.1.1.3" xref="S3.SS2.p1.4.m4.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.4.m4.1b"><apply id="S3.SS2.p1.4.m4.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.4.m4.1.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1">subscript</csymbol><ci id="S3.SS2.p1.4.m4.1.1.2.cmml" xref="S3.SS2.p1.4.m4.1.1.2">𝑠</ci><ci id="S3.SS2.p1.4.m4.1.1.3.cmml" xref="S3.SS2.p1.4.m4.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.4.m4.1c">s_{j}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.4.m4.1d">italic_s start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math>. It is defined with <math alttext="p" class="ltx_Math" display="inline" id="S3.SS2.p1.5.m5.1"><semantics id="S3.SS2.p1.5.m5.1a"><mi id="S3.SS2.p1.5.m5.1.1" xref="S3.SS2.p1.5.m5.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.5.m5.1b"><ci id="S3.SS2.p1.5.m5.1.1.cmml" xref="S3.SS2.p1.5.m5.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.5.m5.1c">p</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.5.m5.1d">italic_p</annotation></semantics></math>-th Wasserstein metric <math alttext="W_{p}(\mathcal{P}_{1},\mathcal{P}_{2})" class="ltx_Math" display="inline" id="S3.SS2.p1.6.m6.2"><semantics id="S3.SS2.p1.6.m6.2a"><mrow id="S3.SS2.p1.6.m6.2.2" xref="S3.SS2.p1.6.m6.2.2.cmml"><msub id="S3.SS2.p1.6.m6.2.2.4" xref="S3.SS2.p1.6.m6.2.2.4.cmml"><mi id="S3.SS2.p1.6.m6.2.2.4.2" xref="S3.SS2.p1.6.m6.2.2.4.2.cmml">W</mi><mi id="S3.SS2.p1.6.m6.2.2.4.3" xref="S3.SS2.p1.6.m6.2.2.4.3.cmml">p</mi></msub><mo id="S3.SS2.p1.6.m6.2.2.3" xref="S3.SS2.p1.6.m6.2.2.3.cmml">⁢</mo><mrow id="S3.SS2.p1.6.m6.2.2.2.2" xref="S3.SS2.p1.6.m6.2.2.2.3.cmml"><mo id="S3.SS2.p1.6.m6.2.2.2.2.3" stretchy="false" xref="S3.SS2.p1.6.m6.2.2.2.3.cmml">(</mo><msub id="S3.SS2.p1.6.m6.1.1.1.1.1" xref="S3.SS2.p1.6.m6.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.6.m6.1.1.1.1.1.2" xref="S3.SS2.p1.6.m6.1.1.1.1.1.2.cmml">𝒫</mi><mn id="S3.SS2.p1.6.m6.1.1.1.1.1.3" xref="S3.SS2.p1.6.m6.1.1.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS2.p1.6.m6.2.2.2.2.4" xref="S3.SS2.p1.6.m6.2.2.2.3.cmml">,</mo><msub id="S3.SS2.p1.6.m6.2.2.2.2.2" xref="S3.SS2.p1.6.m6.2.2.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.6.m6.2.2.2.2.2.2" xref="S3.SS2.p1.6.m6.2.2.2.2.2.2.cmml">𝒫</mi><mn id="S3.SS2.p1.6.m6.2.2.2.2.2.3" xref="S3.SS2.p1.6.m6.2.2.2.2.2.3.cmml">2</mn></msub><mo id="S3.SS2.p1.6.m6.2.2.2.2.5" stretchy="false" xref="S3.SS2.p1.6.m6.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.6.m6.2b"><apply id="S3.SS2.p1.6.m6.2.2.cmml" xref="S3.SS2.p1.6.m6.2.2"><times id="S3.SS2.p1.6.m6.2.2.3.cmml" xref="S3.SS2.p1.6.m6.2.2.3"></times><apply id="S3.SS2.p1.6.m6.2.2.4.cmml" xref="S3.SS2.p1.6.m6.2.2.4"><csymbol cd="ambiguous" id="S3.SS2.p1.6.m6.2.2.4.1.cmml" xref="S3.SS2.p1.6.m6.2.2.4">subscript</csymbol><ci id="S3.SS2.p1.6.m6.2.2.4.2.cmml" xref="S3.SS2.p1.6.m6.2.2.4.2">𝑊</ci><ci id="S3.SS2.p1.6.m6.2.2.4.3.cmml" xref="S3.SS2.p1.6.m6.2.2.4.3">𝑝</ci></apply><interval closure="open" id="S3.SS2.p1.6.m6.2.2.2.3.cmml" xref="S3.SS2.p1.6.m6.2.2.2.2"><apply id="S3.SS2.p1.6.m6.1.1.1.1.1.cmml" xref="S3.SS2.p1.6.m6.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.6.m6.1.1.1.1.1.1.cmml" xref="S3.SS2.p1.6.m6.1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.p1.6.m6.1.1.1.1.1.2.cmml" xref="S3.SS2.p1.6.m6.1.1.1.1.1.2">𝒫</ci><cn id="S3.SS2.p1.6.m6.1.1.1.1.1.3.cmml" type="integer" xref="S3.SS2.p1.6.m6.1.1.1.1.1.3">1</cn></apply><apply id="S3.SS2.p1.6.m6.2.2.2.2.2.cmml" xref="S3.SS2.p1.6.m6.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p1.6.m6.2.2.2.2.2.1.cmml" xref="S3.SS2.p1.6.m6.2.2.2.2.2">subscript</csymbol><ci id="S3.SS2.p1.6.m6.2.2.2.2.2.2.cmml" xref="S3.SS2.p1.6.m6.2.2.2.2.2.2">𝒫</ci><cn id="S3.SS2.p1.6.m6.2.2.2.2.2.3.cmml" type="integer" xref="S3.SS2.p1.6.m6.2.2.2.2.2.3">2</cn></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.6.m6.2c">W_{p}(\mathcal{P}_{1},\mathcal{P}_{2})</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.6.m6.2d">italic_W start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ( caligraphic_P start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , caligraphic_P start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT )</annotation></semantics></math>, which represents the distance between two probability distribution <math alttext="\mathcal{P}_{1}" class="ltx_Math" display="inline" id="S3.SS2.p1.7.m7.1"><semantics id="S3.SS2.p1.7.m7.1a"><msub id="S3.SS2.p1.7.m7.1.1" xref="S3.SS2.p1.7.m7.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.7.m7.1.1.2" xref="S3.SS2.p1.7.m7.1.1.2.cmml">𝒫</mi><mn id="S3.SS2.p1.7.m7.1.1.3" xref="S3.SS2.p1.7.m7.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.7.m7.1b"><apply id="S3.SS2.p1.7.m7.1.1.cmml" xref="S3.SS2.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.7.m7.1.1.1.cmml" xref="S3.SS2.p1.7.m7.1.1">subscript</csymbol><ci id="S3.SS2.p1.7.m7.1.1.2.cmml" xref="S3.SS2.p1.7.m7.1.1.2">𝒫</ci><cn id="S3.SS2.p1.7.m7.1.1.3.cmml" type="integer" xref="S3.SS2.p1.7.m7.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.7.m7.1c">\mathcal{P}_{1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.7.m7.1d">caligraphic_P start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\mathcal{P}_{2}" class="ltx_Math" display="inline" id="S3.SS2.p1.8.m8.1"><semantics id="S3.SS2.p1.8.m8.1a"><msub id="S3.SS2.p1.8.m8.1.1" xref="S3.SS2.p1.8.m8.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.8.m8.1.1.2" xref="S3.SS2.p1.8.m8.1.1.2.cmml">𝒫</mi><mn id="S3.SS2.p1.8.m8.1.1.3" xref="S3.SS2.p1.8.m8.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.8.m8.1b"><apply id="S3.SS2.p1.8.m8.1.1.cmml" xref="S3.SS2.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.8.m8.1.1.1.cmml" xref="S3.SS2.p1.8.m8.1.1">subscript</csymbol><ci id="S3.SS2.p1.8.m8.1.1.2.cmml" xref="S3.SS2.p1.8.m8.1.1.2">𝒫</ci><cn id="S3.SS2.p1.8.m8.1.1.3.cmml" type="integer" xref="S3.SS2.p1.8.m8.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.8.m8.1c">\mathcal{P}_{2}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.8.m8.1d">caligraphic_P start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>:</p>
</div>
<div class="ltx_theorem ltx_theorem_dfn" id="Thmdfn1">
<h6 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span class="ltx_text ltx_font_bold" id="Thmdfn1.1.1.1">Definition 1</span></span><span class="ltx_text ltx_font_bold" id="Thmdfn1.2.2">.</span>
</h6>
<div class="ltx_para" id="Thmdfn1.p1">
<p class="ltx_p" id="Thmdfn1.p1.2">(Bisimulation metric <cite class="ltx_cite ltx_citemacro_citep">(Ferns et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#bib.bib6" title="">2011</a>)</cite>). The following metric exists and is unique, given <math alttext="R:S\times A\rightarrow[0,1]" class="ltx_Math" display="inline" id="Thmdfn1.p1.1.m1.2"><semantics id="Thmdfn1.p1.1.m1.2a"><mrow id="Thmdfn1.p1.1.m1.2.3" xref="Thmdfn1.p1.1.m1.2.3.cmml"><mi id="Thmdfn1.p1.1.m1.2.3.2" xref="Thmdfn1.p1.1.m1.2.3.2.cmml">R</mi><mo id="Thmdfn1.p1.1.m1.2.3.1" lspace="0.278em" rspace="0.278em" xref="Thmdfn1.p1.1.m1.2.3.1.cmml">:</mo><mrow id="Thmdfn1.p1.1.m1.2.3.3" xref="Thmdfn1.p1.1.m1.2.3.3.cmml"><mrow id="Thmdfn1.p1.1.m1.2.3.3.2" xref="Thmdfn1.p1.1.m1.2.3.3.2.cmml"><mi id="Thmdfn1.p1.1.m1.2.3.3.2.2" xref="Thmdfn1.p1.1.m1.2.3.3.2.2.cmml">S</mi><mo id="Thmdfn1.p1.1.m1.2.3.3.2.1" lspace="0.222em" rspace="0.222em" xref="Thmdfn1.p1.1.m1.2.3.3.2.1.cmml">×</mo><mi id="Thmdfn1.p1.1.m1.2.3.3.2.3" xref="Thmdfn1.p1.1.m1.2.3.3.2.3.cmml">A</mi></mrow><mo id="Thmdfn1.p1.1.m1.2.3.3.1" stretchy="false" xref="Thmdfn1.p1.1.m1.2.3.3.1.cmml">→</mo><mrow id="Thmdfn1.p1.1.m1.2.3.3.3.2" xref="Thmdfn1.p1.1.m1.2.3.3.3.1.cmml"><mo id="Thmdfn1.p1.1.m1.2.3.3.3.2.1" stretchy="false" xref="Thmdfn1.p1.1.m1.2.3.3.3.1.cmml">[</mo><mn id="Thmdfn1.p1.1.m1.1.1" xref="Thmdfn1.p1.1.m1.1.1.cmml">0</mn><mo id="Thmdfn1.p1.1.m1.2.3.3.3.2.2" xref="Thmdfn1.p1.1.m1.2.3.3.3.1.cmml">,</mo><mn id="Thmdfn1.p1.1.m1.2.2" xref="Thmdfn1.p1.1.m1.2.2.cmml">1</mn><mo id="Thmdfn1.p1.1.m1.2.3.3.3.2.3" stretchy="false" xref="Thmdfn1.p1.1.m1.2.3.3.3.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmdfn1.p1.1.m1.2b"><apply id="Thmdfn1.p1.1.m1.2.3.cmml" xref="Thmdfn1.p1.1.m1.2.3"><ci id="Thmdfn1.p1.1.m1.2.3.1.cmml" xref="Thmdfn1.p1.1.m1.2.3.1">:</ci><ci id="Thmdfn1.p1.1.m1.2.3.2.cmml" xref="Thmdfn1.p1.1.m1.2.3.2">𝑅</ci><apply id="Thmdfn1.p1.1.m1.2.3.3.cmml" xref="Thmdfn1.p1.1.m1.2.3.3"><ci id="Thmdfn1.p1.1.m1.2.3.3.1.cmml" xref="Thmdfn1.p1.1.m1.2.3.3.1">→</ci><apply id="Thmdfn1.p1.1.m1.2.3.3.2.cmml" xref="Thmdfn1.p1.1.m1.2.3.3.2"><times id="Thmdfn1.p1.1.m1.2.3.3.2.1.cmml" xref="Thmdfn1.p1.1.m1.2.3.3.2.1"></times><ci id="Thmdfn1.p1.1.m1.2.3.3.2.2.cmml" xref="Thmdfn1.p1.1.m1.2.3.3.2.2">𝑆</ci><ci id="Thmdfn1.p1.1.m1.2.3.3.2.3.cmml" xref="Thmdfn1.p1.1.m1.2.3.3.2.3">𝐴</ci></apply><interval closure="closed" id="Thmdfn1.p1.1.m1.2.3.3.3.1.cmml" xref="Thmdfn1.p1.1.m1.2.3.3.3.2"><cn id="Thmdfn1.p1.1.m1.1.1.cmml" type="integer" xref="Thmdfn1.p1.1.m1.1.1">0</cn><cn id="Thmdfn1.p1.1.m1.2.2.cmml" type="integer" xref="Thmdfn1.p1.1.m1.2.2">1</cn></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmdfn1.p1.1.m1.2c">R:S\times A\rightarrow[0,1]</annotation><annotation encoding="application/x-llamapun" id="Thmdfn1.p1.1.m1.2d">italic_R : italic_S × italic_A → [ 0 , 1 ]</annotation></semantics></math> and <math alttext="c\in(0,1)" class="ltx_Math" display="inline" id="Thmdfn1.p1.2.m2.2"><semantics id="Thmdfn1.p1.2.m2.2a"><mrow id="Thmdfn1.p1.2.m2.2.3" xref="Thmdfn1.p1.2.m2.2.3.cmml"><mi id="Thmdfn1.p1.2.m2.2.3.2" xref="Thmdfn1.p1.2.m2.2.3.2.cmml">c</mi><mo id="Thmdfn1.p1.2.m2.2.3.1" xref="Thmdfn1.p1.2.m2.2.3.1.cmml">∈</mo><mrow id="Thmdfn1.p1.2.m2.2.3.3.2" xref="Thmdfn1.p1.2.m2.2.3.3.1.cmml"><mo id="Thmdfn1.p1.2.m2.2.3.3.2.1" stretchy="false" xref="Thmdfn1.p1.2.m2.2.3.3.1.cmml">(</mo><mn id="Thmdfn1.p1.2.m2.1.1" xref="Thmdfn1.p1.2.m2.1.1.cmml">0</mn><mo id="Thmdfn1.p1.2.m2.2.3.3.2.2" xref="Thmdfn1.p1.2.m2.2.3.3.1.cmml">,</mo><mn id="Thmdfn1.p1.2.m2.2.2" xref="Thmdfn1.p1.2.m2.2.2.cmml">1</mn><mo id="Thmdfn1.p1.2.m2.2.3.3.2.3" stretchy="false" xref="Thmdfn1.p1.2.m2.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmdfn1.p1.2.m2.2b"><apply id="Thmdfn1.p1.2.m2.2.3.cmml" xref="Thmdfn1.p1.2.m2.2.3"><in id="Thmdfn1.p1.2.m2.2.3.1.cmml" xref="Thmdfn1.p1.2.m2.2.3.1"></in><ci id="Thmdfn1.p1.2.m2.2.3.2.cmml" xref="Thmdfn1.p1.2.m2.2.3.2">𝑐</ci><interval closure="open" id="Thmdfn1.p1.2.m2.2.3.3.1.cmml" xref="Thmdfn1.p1.2.m2.2.3.3.2"><cn id="Thmdfn1.p1.2.m2.1.1.cmml" type="integer" xref="Thmdfn1.p1.2.m2.1.1">0</cn><cn id="Thmdfn1.p1.2.m2.2.2.cmml" type="integer" xref="Thmdfn1.p1.2.m2.2.2">1</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmdfn1.p1.2.m2.2c">c\in(0,1)</annotation><annotation encoding="application/x-llamapun" id="Thmdfn1.p1.2.m2.2d">italic_c ∈ ( 0 , 1 )</annotation></semantics></math> for continuous MDPs:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="d(s_{i},s_{j})=\max_{a\in\mathcal{A}}(1-c)|{\mathcal{R}}(s_{i},a)-{\mathcal{R}%
}(s_{j},a)|+cW_{1}(\mathcal{P}(\cdot|s_{i},a),\mathcal{P}(\cdot|s_{j},a))." class="ltx_math_unparsed" display="block" id="S3.E2.m1.2"><semantics id="S3.E2.m1.2a"><mrow id="S3.E2.m1.2b"><mi id="S3.E2.m1.2.3">d</mi><mrow id="S3.E2.m1.2.4"><mo id="S3.E2.m1.2.4.1" stretchy="false">(</mo><msub id="S3.E2.m1.2.4.2"><mi id="S3.E2.m1.2.4.2.2">s</mi><mi id="S3.E2.m1.2.4.2.3">i</mi></msub><mo id="S3.E2.m1.2.4.3">,</mo><msub id="S3.E2.m1.2.4.4"><mi id="S3.E2.m1.2.4.4.2">s</mi><mi id="S3.E2.m1.2.4.4.3">j</mi></msub><mo id="S3.E2.m1.2.4.5" stretchy="false">)</mo></mrow><mo id="S3.E2.m1.2.5">=</mo><munder id="S3.E2.m1.2.6"><mi id="S3.E2.m1.2.6.2">max</mi><mrow id="S3.E2.m1.2.6.3"><mi id="S3.E2.m1.2.6.3.2">a</mi><mo id="S3.E2.m1.2.6.3.1">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.E2.m1.2.6.3.3">𝒜</mi></mrow></munder><mrow id="S3.E2.m1.2.7"><mo id="S3.E2.m1.2.7.1" stretchy="false">(</mo><mn id="S3.E2.m1.2.7.2">1</mn><mo id="S3.E2.m1.2.7.3">−</mo><mi id="S3.E2.m1.2.7.4">c</mi><mo id="S3.E2.m1.2.7.5" stretchy="false">)</mo></mrow><mo fence="false" id="S3.E2.m1.2.8" rspace="0.167em" stretchy="false">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.E2.m1.2.9">ℛ</mi><mrow id="S3.E2.m1.2.10"><mo id="S3.E2.m1.2.10.1" stretchy="false">(</mo><msub id="S3.E2.m1.2.10.2"><mi id="S3.E2.m1.2.10.2.2">s</mi><mi id="S3.E2.m1.2.10.2.3">i</mi></msub><mo id="S3.E2.m1.2.10.3">,</mo><mi id="S3.E2.m1.1.1">a</mi><mo id="S3.E2.m1.2.10.4" stretchy="false">)</mo></mrow><mo id="S3.E2.m1.2.11">−</mo><mi class="ltx_font_mathcaligraphic" id="S3.E2.m1.2.12">ℛ</mi><mrow id="S3.E2.m1.2.13"><mo id="S3.E2.m1.2.13.1" stretchy="false">(</mo><msub id="S3.E2.m1.2.13.2"><mi id="S3.E2.m1.2.13.2.2">s</mi><mi id="S3.E2.m1.2.13.2.3">j</mi></msub><mo id="S3.E2.m1.2.13.3">,</mo><mi id="S3.E2.m1.2.2">a</mi><mo id="S3.E2.m1.2.13.4" stretchy="false">)</mo></mrow><mo fence="false" id="S3.E2.m1.2.14" stretchy="false">|</mo><mo id="S3.E2.m1.2.15" lspace="0em">+</mo><mi id="S3.E2.m1.2.16">c</mi><msub id="S3.E2.m1.2.17"><mi id="S3.E2.m1.2.17.2">W</mi><mn id="S3.E2.m1.2.17.3">1</mn></msub><mrow id="S3.E2.m1.2.18"><mo id="S3.E2.m1.2.18.1" stretchy="false">(</mo><mi class="ltx_font_mathcaligraphic" id="S3.E2.m1.2.18.2">𝒫</mi><mrow id="S3.E2.m1.2.18.3"><mo id="S3.E2.m1.2.18.3.1" stretchy="false">(</mo><mo id="S3.E2.m1.2.18.3.2" lspace="0em" rspace="0em">⋅</mo><mo fence="false" id="S3.E2.m1.2.18.3.3" rspace="0.167em" stretchy="false">|</mo><msub id="S3.E2.m1.2.18.3.4"><mi id="S3.E2.m1.2.18.3.4.2">s</mi><mi id="S3.E2.m1.2.18.3.4.3">i</mi></msub><mo id="S3.E2.m1.2.18.3.5">,</mo><mi id="S3.E2.m1.2.18.3.6">a</mi><mo id="S3.E2.m1.2.18.3.7" stretchy="false">)</mo></mrow><mo id="S3.E2.m1.2.18.4">,</mo><mi class="ltx_font_mathcaligraphic" id="S3.E2.m1.2.18.5">𝒫</mi><mrow id="S3.E2.m1.2.18.6"><mo id="S3.E2.m1.2.18.6.1" stretchy="false">(</mo><mo id="S3.E2.m1.2.18.6.2" lspace="0em" rspace="0em">⋅</mo><mo fence="false" id="S3.E2.m1.2.18.6.3" rspace="0.167em" stretchy="false">|</mo><msub id="S3.E2.m1.2.18.6.4"><mi id="S3.E2.m1.2.18.6.4.2">s</mi><mi id="S3.E2.m1.2.18.6.4.3">j</mi></msub><mo id="S3.E2.m1.2.18.6.5">,</mo><mi id="S3.E2.m1.2.18.6.6">a</mi><mo id="S3.E2.m1.2.18.6.7" stretchy="false">)</mo></mrow><mo id="S3.E2.m1.2.18.7" stretchy="false">)</mo></mrow><mo id="S3.E2.m1.2.19" lspace="0em">.</mo></mrow><annotation encoding="application/x-tex" id="S3.E2.m1.2c">d(s_{i},s_{j})=\max_{a\in\mathcal{A}}(1-c)|{\mathcal{R}}(s_{i},a)-{\mathcal{R}%
}(s_{j},a)|+cW_{1}(\mathcal{P}(\cdot|s_{i},a),\mathcal{P}(\cdot|s_{j},a)).</annotation><annotation encoding="application/x-llamapun" id="S3.E2.m1.2d">italic_d ( italic_s start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_s start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) = roman_max start_POSTSUBSCRIPT italic_a ∈ caligraphic_A end_POSTSUBSCRIPT ( 1 - italic_c ) | caligraphic_R ( italic_s start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_a ) - caligraphic_R ( italic_s start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT , italic_a ) | + italic_c italic_W start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ( caligraphic_P ( ⋅ | italic_s start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_a ) , caligraphic_P ( ⋅ | italic_s start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT , italic_a ) ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
</div>
</div>
<div class="ltx_para" id="S3.SS2.p2">
<p class="ltx_p" id="S3.SS2.p2.1">In high-dimensional and continuous environments, analytically computing the max operation in Eq. <a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#S3.E2" title="In Definition 1. ‣ 3.2 Bisimulation Metric ‣ 3 Preliminaries ‣ Bisimulation metric for Model Predictive Control"><span class="ltx_text ltx_ref_tag">2</span></a> is challenging. In response to this difficulty, <cite class="ltx_cite ltx_citemacro_citet">Castro (<a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#bib.bib1" title="">2020</a>)</cite> proposed a new approach, known as the on-policy bisimulation metric (or <math alttext="\pi" class="ltx_Math" display="inline" id="S3.SS2.p2.1.m1.1"><semantics id="S3.SS2.p2.1.m1.1a"><mi id="S3.SS2.p2.1.m1.1.1" xref="S3.SS2.p2.1.m1.1.1.cmml">π</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.1.m1.1b"><ci id="S3.SS2.p2.1.m1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1">𝜋</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.1.m1.1c">\pi</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.1.m1.1d">italic_π</annotation></semantics></math>-bisimulation).</p>
</div>
<div class="ltx_theorem ltx_theorem_dfn" id="Thmdfn2">
<h6 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span class="ltx_text ltx_font_bold" id="Thmdfn2.1.1.1">Definition 2</span></span><span class="ltx_text ltx_font_bold" id="Thmdfn2.2.2">.</span>
</h6>
<div class="ltx_para" id="Thmdfn2.p1">
<p class="ltx_p" id="Thmdfn2.p1.1">(On-Policy bisimulation metric <cite class="ltx_cite ltx_citemacro_citep">(Castro, <a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#bib.bib1" title="">2020</a>)</cite>). Given a fixed policy <math alttext="\pi" class="ltx_Math" display="inline" id="Thmdfn2.p1.1.m1.1"><semantics id="Thmdfn2.p1.1.m1.1a"><mi id="Thmdfn2.p1.1.m1.1.1" xref="Thmdfn2.p1.1.m1.1.1.cmml">π</mi><annotation-xml encoding="MathML-Content" id="Thmdfn2.p1.1.m1.1b"><ci id="Thmdfn2.p1.1.m1.1.1.cmml" xref="Thmdfn2.p1.1.m1.1.1">𝜋</ci></annotation-xml><annotation encoding="application/x-tex" id="Thmdfn2.p1.1.m1.1c">\pi</annotation><annotation encoding="application/x-llamapun" id="Thmdfn2.p1.1.m1.1d">italic_π</annotation></semantics></math>, the following bisimulation metric uniquely exists</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="d(s_{i},s_{j})=|r_{s_{i}}^{\pi}-r_{s_{j}}^{\pi}|+\gamma W_{1}(\mathcal{P}^{\pi%
}(\cdot|s_{i}),\mathcal{P}^{\pi}(\cdot|s_{j}))." class="ltx_math_unparsed" display="block" id="S3.E3.m1.1"><semantics id="S3.E3.m1.1a"><mrow id="S3.E3.m1.1b"><mi id="S3.E3.m1.1.1">d</mi><mrow id="S3.E3.m1.1.2"><mo id="S3.E3.m1.1.2.1" stretchy="false">(</mo><msub id="S3.E3.m1.1.2.2"><mi id="S3.E3.m1.1.2.2.2">s</mi><mi id="S3.E3.m1.1.2.2.3">i</mi></msub><mo id="S3.E3.m1.1.2.3">,</mo><msub id="S3.E3.m1.1.2.4"><mi id="S3.E3.m1.1.2.4.2">s</mi><mi id="S3.E3.m1.1.2.4.3">j</mi></msub><mo id="S3.E3.m1.1.2.5" stretchy="false">)</mo></mrow><mo id="S3.E3.m1.1.3" rspace="0em">=</mo><mo fence="false" id="S3.E3.m1.1.4" rspace="0.167em" stretchy="false">|</mo><msubsup id="S3.E3.m1.1.5"><mi id="S3.E3.m1.1.5.2.2">r</mi><msub id="S3.E3.m1.1.5.2.3"><mi id="S3.E3.m1.1.5.2.3.2">s</mi><mi id="S3.E3.m1.1.5.2.3.3">i</mi></msub><mi id="S3.E3.m1.1.5.3">π</mi></msubsup><mo id="S3.E3.m1.1.6">−</mo><msubsup id="S3.E3.m1.1.7"><mi id="S3.E3.m1.1.7.2.2">r</mi><msub id="S3.E3.m1.1.7.2.3"><mi id="S3.E3.m1.1.7.2.3.2">s</mi><mi id="S3.E3.m1.1.7.2.3.3">j</mi></msub><mi id="S3.E3.m1.1.7.3">π</mi></msubsup><mo fence="false" id="S3.E3.m1.1.8" stretchy="false">|</mo><mo id="S3.E3.m1.1.9" lspace="0em">+</mo><mi id="S3.E3.m1.1.10">γ</mi><msub id="S3.E3.m1.1.11"><mi id="S3.E3.m1.1.11.2">W</mi><mn id="S3.E3.m1.1.11.3">1</mn></msub><mrow id="S3.E3.m1.1.12"><mo id="S3.E3.m1.1.12.1" stretchy="false">(</mo><msup id="S3.E3.m1.1.12.2"><mi class="ltx_font_mathcaligraphic" id="S3.E3.m1.1.12.2.2">𝒫</mi><mi id="S3.E3.m1.1.12.2.3">π</mi></msup><mrow id="S3.E3.m1.1.12.3"><mo id="S3.E3.m1.1.12.3.1" stretchy="false">(</mo><mo id="S3.E3.m1.1.12.3.2" lspace="0em" rspace="0em">⋅</mo><mo fence="false" id="S3.E3.m1.1.12.3.3" rspace="0.167em" stretchy="false">|</mo><msub id="S3.E3.m1.1.12.3.4"><mi id="S3.E3.m1.1.12.3.4.2">s</mi><mi id="S3.E3.m1.1.12.3.4.3">i</mi></msub><mo id="S3.E3.m1.1.12.3.5" stretchy="false">)</mo></mrow><mo id="S3.E3.m1.1.12.4">,</mo><msup id="S3.E3.m1.1.12.5"><mi class="ltx_font_mathcaligraphic" id="S3.E3.m1.1.12.5.2">𝒫</mi><mi id="S3.E3.m1.1.12.5.3">π</mi></msup><mrow id="S3.E3.m1.1.12.6"><mo id="S3.E3.m1.1.12.6.1" stretchy="false">(</mo><mo id="S3.E3.m1.1.12.6.2" lspace="0em" rspace="0em">⋅</mo><mo fence="false" id="S3.E3.m1.1.12.6.3" rspace="0.167em" stretchy="false">|</mo><msub id="S3.E3.m1.1.12.6.4"><mi id="S3.E3.m1.1.12.6.4.2">s</mi><mi id="S3.E3.m1.1.12.6.4.3">j</mi></msub><mo id="S3.E3.m1.1.12.6.5" stretchy="false">)</mo></mrow><mo id="S3.E3.m1.1.12.7" stretchy="false">)</mo></mrow><mo id="S3.E3.m1.1.13" lspace="0em">.</mo></mrow><annotation encoding="application/x-tex" id="S3.E3.m1.1c">d(s_{i},s_{j})=|r_{s_{i}}^{\pi}-r_{s_{j}}^{\pi}|+\gamma W_{1}(\mathcal{P}^{\pi%
}(\cdot|s_{i}),\mathcal{P}^{\pi}(\cdot|s_{j})).</annotation><annotation encoding="application/x-llamapun" id="S3.E3.m1.1d">italic_d ( italic_s start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_s start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) = | italic_r start_POSTSUBSCRIPT italic_s start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_π end_POSTSUPERSCRIPT - italic_r start_POSTSUBSCRIPT italic_s start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_π end_POSTSUPERSCRIPT | + italic_γ italic_W start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ( caligraphic_P start_POSTSUPERSCRIPT italic_π end_POSTSUPERSCRIPT ( ⋅ | italic_s start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) , caligraphic_P start_POSTSUPERSCRIPT italic_π end_POSTSUPERSCRIPT ( ⋅ | italic_s start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="Thmdfn2.p1.2">where</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="r_{s}^{\pi}=\sum_{a}\pi(a|s){\mathcal{R}}(s,a),\quad\mathcal{P}^{\pi}(\cdot|s)%
=\sum_{a}\pi(a|s)\sum_{s^{\prime}\in S}\mathcal{P}(s^{\prime}|s,a)" class="ltx_math_unparsed" display="block" id="S3.E4.m1.2"><semantics id="S3.E4.m1.2a"><mrow id="S3.E4.m1.2b"><msubsup id="S3.E4.m1.2.3"><mi id="S3.E4.m1.2.3.2.2">r</mi><mi id="S3.E4.m1.2.3.2.3">s</mi><mi id="S3.E4.m1.2.3.3">π</mi></msubsup><mo id="S3.E4.m1.2.4" rspace="0.111em">=</mo><munder id="S3.E4.m1.2.5"><mo id="S3.E4.m1.2.5.2" movablelimits="false">∑</mo><mi id="S3.E4.m1.2.5.3">a</mi></munder><mi id="S3.E4.m1.2.6">π</mi><mrow id="S3.E4.m1.2.7"><mo id="S3.E4.m1.2.7.1" stretchy="false">(</mo><mi id="S3.E4.m1.2.7.2">a</mi><mo fence="false" id="S3.E4.m1.2.7.3" rspace="0.167em" stretchy="false">|</mo><mi id="S3.E4.m1.2.7.4">s</mi><mo id="S3.E4.m1.2.7.5" stretchy="false">)</mo></mrow><mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.2.8">ℛ</mi><mrow id="S3.E4.m1.2.9"><mo id="S3.E4.m1.2.9.1" stretchy="false">(</mo><mi id="S3.E4.m1.1.1">s</mi><mo id="S3.E4.m1.2.9.2">,</mo><mi id="S3.E4.m1.2.2">a</mi><mo id="S3.E4.m1.2.9.3" stretchy="false">)</mo></mrow><mo id="S3.E4.m1.2.10" rspace="1.167em">,</mo><msup id="S3.E4.m1.2.11"><mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.2.11.2">𝒫</mi><mi id="S3.E4.m1.2.11.3">π</mi></msup><mrow id="S3.E4.m1.2.12"><mo id="S3.E4.m1.2.12.1" stretchy="false">(</mo><mo id="S3.E4.m1.2.12.2" lspace="0em" rspace="0em">⋅</mo><mo fence="false" id="S3.E4.m1.2.12.3" rspace="0.167em" stretchy="false">|</mo><mi id="S3.E4.m1.2.12.4">s</mi><mo id="S3.E4.m1.2.12.5" stretchy="false">)</mo></mrow><mo id="S3.E4.m1.2.13" rspace="0.111em">=</mo><munder id="S3.E4.m1.2.14"><mo id="S3.E4.m1.2.14.2" movablelimits="false">∑</mo><mi id="S3.E4.m1.2.14.3">a</mi></munder><mi id="S3.E4.m1.2.15">π</mi><mrow id="S3.E4.m1.2.16"><mo id="S3.E4.m1.2.16.1" stretchy="false">(</mo><mi id="S3.E4.m1.2.16.2">a</mi><mo fence="false" id="S3.E4.m1.2.16.3" rspace="0.167em" stretchy="false">|</mo><mi id="S3.E4.m1.2.16.4">s</mi><mo id="S3.E4.m1.2.16.5" stretchy="false">)</mo></mrow><munder id="S3.E4.m1.2.17"><mo id="S3.E4.m1.2.17.2" movablelimits="false">∑</mo><mrow id="S3.E4.m1.2.17.3"><msup id="S3.E4.m1.2.17.3.2"><mi id="S3.E4.m1.2.17.3.2.2">s</mi><mo id="S3.E4.m1.2.17.3.2.3">′</mo></msup><mo id="S3.E4.m1.2.17.3.1">∈</mo><mi id="S3.E4.m1.2.17.3.3">S</mi></mrow></munder><mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.2.18">𝒫</mi><mrow id="S3.E4.m1.2.19"><mo id="S3.E4.m1.2.19.1" stretchy="false">(</mo><msup id="S3.E4.m1.2.19.2"><mi id="S3.E4.m1.2.19.2.2">s</mi><mo id="S3.E4.m1.2.19.2.3">′</mo></msup><mo fence="false" id="S3.E4.m1.2.19.3" rspace="0.167em" stretchy="false">|</mo><mi id="S3.E4.m1.2.19.4">s</mi><mo id="S3.E4.m1.2.19.5">,</mo><mi id="S3.E4.m1.2.19.6">a</mi><mo id="S3.E4.m1.2.19.7" stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="S3.E4.m1.2c">r_{s}^{\pi}=\sum_{a}\pi(a|s){\mathcal{R}}(s,a),\quad\mathcal{P}^{\pi}(\cdot|s)%
=\sum_{a}\pi(a|s)\sum_{s^{\prime}\in S}\mathcal{P}(s^{\prime}|s,a)</annotation><annotation encoding="application/x-llamapun" id="S3.E4.m1.2d">italic_r start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_π end_POSTSUPERSCRIPT = ∑ start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT italic_π ( italic_a | italic_s ) caligraphic_R ( italic_s , italic_a ) , caligraphic_P start_POSTSUPERSCRIPT italic_π end_POSTSUPERSCRIPT ( ⋅ | italic_s ) = ∑ start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT italic_π ( italic_a | italic_s ) ∑ start_POSTSUBSCRIPT italic_s start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ∈ italic_S end_POSTSUBSCRIPT caligraphic_P ( italic_s start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT | italic_s , italic_a )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
</div>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS2.p3">
<p class="ltx_p" id="S3.SS2.p3.4">Recently, <cite class="ltx_cite ltx_citemacro_citep">(Zhang et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#bib.bib47" title="">2021</a>)</cite> extended the concept of the on-policy bisimulation metric (referred to as the <math alttext="\pi^{*}" class="ltx_Math" display="inline" id="S3.SS2.p3.1.m1.1"><semantics id="S3.SS2.p3.1.m1.1a"><msup id="S3.SS2.p3.1.m1.1.1" xref="S3.SS2.p3.1.m1.1.1.cmml"><mi id="S3.SS2.p3.1.m1.1.1.2" xref="S3.SS2.p3.1.m1.1.1.2.cmml">π</mi><mo id="S3.SS2.p3.1.m1.1.1.3" xref="S3.SS2.p3.1.m1.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.1.m1.1b"><apply id="S3.SS2.p3.1.m1.1.1.cmml" xref="S3.SS2.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.1.m1.1.1.1.cmml" xref="S3.SS2.p3.1.m1.1.1">superscript</csymbol><ci id="S3.SS2.p3.1.m1.1.1.2.cmml" xref="S3.SS2.p3.1.m1.1.1.2">𝜋</ci><times id="S3.SS2.p3.1.m1.1.1.3.cmml" xref="S3.SS2.p3.1.m1.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.1.m1.1c">\pi^{*}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.1.m1.1d">italic_π start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math>-bisimulation metric) to learn a comparable metric in the latent space <math alttext="{\mathcal{Z}}" class="ltx_Math" display="inline" id="S3.SS2.p3.2.m2.1"><semantics id="S3.SS2.p3.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p3.2.m2.1.1" xref="S3.SS2.p3.2.m2.1.1.cmml">𝒵</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.2.m2.1b"><ci id="S3.SS2.p3.2.m2.1.1.cmml" xref="S3.SS2.p3.2.m2.1.1">𝒵</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.2.m2.1c">{\mathcal{Z}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.2.m2.1d">caligraphic_Z</annotation></semantics></math>. In their approach, the encoder <math alttext="\phi" class="ltx_Math" display="inline" id="S3.SS2.p3.3.m3.1"><semantics id="S3.SS2.p3.3.m3.1a"><mi id="S3.SS2.p3.3.m3.1.1" xref="S3.SS2.p3.3.m3.1.1.cmml">ϕ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.3.m3.1b"><ci id="S3.SS2.p3.3.m3.1.1.cmml" xref="S3.SS2.p3.3.m3.1.1">italic-ϕ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.3.m3.1c">\phi</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.3.m3.1d">italic_ϕ</annotation></semantics></math> is learned by minimizing the mean square error between the on-policy bisimulation metric and <math alttext="\ell_{1}" class="ltx_Math" display="inline" id="S3.SS2.p3.4.m4.1"><semantics id="S3.SS2.p3.4.m4.1a"><msub id="S3.SS2.p3.4.m4.1.1" xref="S3.SS2.p3.4.m4.1.1.cmml"><mi id="S3.SS2.p3.4.m4.1.1.2" mathvariant="normal" xref="S3.SS2.p3.4.m4.1.1.2.cmml">ℓ</mi><mn id="S3.SS2.p3.4.m4.1.1.3" xref="S3.SS2.p3.4.m4.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.4.m4.1b"><apply id="S3.SS2.p3.4.m4.1.1.cmml" xref="S3.SS2.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.4.m4.1.1.1.cmml" xref="S3.SS2.p3.4.m4.1.1">subscript</csymbol><ci id="S3.SS2.p3.4.m4.1.1.2.cmml" xref="S3.SS2.p3.4.m4.1.1.2">ℓ</ci><cn id="S3.SS2.p3.4.m4.1.1.3.cmml" type="integer" xref="S3.SS2.p3.4.m4.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.4.m4.1c">\ell_{1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.4.m4.1d">roman_ℓ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math>-distance in the latent space.</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E5">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="J(\phi)=\left(\|\phi(s_{i})-\phi(s_{j})\|_{1}-|r_{s_{i}}^{\pi}-r_{s_{j}}^{\pi}%
|-\gamma W_{2}\left(\hat{\mathcal{P}}(\cdot|\bar{\phi}(s_{i}),a_{i}),\hat{%
\mathcal{P}}(\cdot|\bar{\phi}(s_{j}),a_{j})\right)\right)^{2}" class="ltx_math_unparsed" display="block" id="S3.E5.m1.1"><semantics id="S3.E5.m1.1a"><mrow id="S3.E5.m1.1b"><mi id="S3.E5.m1.1.2">J</mi><mrow id="S3.E5.m1.1.3"><mo id="S3.E5.m1.1.3.1" stretchy="false">(</mo><mi id="S3.E5.m1.1.1">ϕ</mi><mo id="S3.E5.m1.1.3.2" stretchy="false">)</mo></mrow><mo id="S3.E5.m1.1.4">=</mo><msup id="S3.E5.m1.1.5"><mrow id="S3.E5.m1.1.5.2"><mo id="S3.E5.m1.1.5.2.1">(</mo><mo id="S3.E5.m1.1.5.2.2" lspace="0em" rspace="0.167em">∥</mo><mi id="S3.E5.m1.1.5.2.3">ϕ</mi><mrow id="S3.E5.m1.1.5.2.4"><mo id="S3.E5.m1.1.5.2.4.1" stretchy="false">(</mo><msub id="S3.E5.m1.1.5.2.4.2"><mi id="S3.E5.m1.1.5.2.4.2.2">s</mi><mi id="S3.E5.m1.1.5.2.4.2.3">i</mi></msub><mo id="S3.E5.m1.1.5.2.4.3" stretchy="false">)</mo></mrow><mo id="S3.E5.m1.1.5.2.5">−</mo><mi id="S3.E5.m1.1.5.2.6">ϕ</mi><mrow id="S3.E5.m1.1.5.2.7"><mo id="S3.E5.m1.1.5.2.7.1" stretchy="false">(</mo><msub id="S3.E5.m1.1.5.2.7.2"><mi id="S3.E5.m1.1.5.2.7.2.2">s</mi><mi id="S3.E5.m1.1.5.2.7.2.3">j</mi></msub><mo id="S3.E5.m1.1.5.2.7.3" stretchy="false">)</mo></mrow><msub id="S3.E5.m1.1.5.2.8"><mo id="S3.E5.m1.1.5.2.8.2" lspace="0em" rspace="0em">∥</mo><mn id="S3.E5.m1.1.5.2.8.3">1</mn></msub><mo id="S3.E5.m1.1.5.2.9" lspace="0em" rspace="0em">−</mo><mo fence="false" id="S3.E5.m1.1.5.2.10" rspace="0.167em" stretchy="false">|</mo><msubsup id="S3.E5.m1.1.5.2.11"><mi id="S3.E5.m1.1.5.2.11.2.2">r</mi><msub id="S3.E5.m1.1.5.2.11.2.3"><mi id="S3.E5.m1.1.5.2.11.2.3.2">s</mi><mi id="S3.E5.m1.1.5.2.11.2.3.3">i</mi></msub><mi id="S3.E5.m1.1.5.2.11.3">π</mi></msubsup><mo id="S3.E5.m1.1.5.2.12">−</mo><msubsup id="S3.E5.m1.1.5.2.13"><mi id="S3.E5.m1.1.5.2.13.2.2">r</mi><msub id="S3.E5.m1.1.5.2.13.2.3"><mi id="S3.E5.m1.1.5.2.13.2.3.2">s</mi><mi id="S3.E5.m1.1.5.2.13.2.3.3">j</mi></msub><mi id="S3.E5.m1.1.5.2.13.3">π</mi></msubsup><mo fence="false" id="S3.E5.m1.1.5.2.14" stretchy="false">|</mo><mo id="S3.E5.m1.1.5.2.15" lspace="0em">−</mo><mi id="S3.E5.m1.1.5.2.16">γ</mi><msub id="S3.E5.m1.1.5.2.17"><mi id="S3.E5.m1.1.5.2.17.2">W</mi><mn id="S3.E5.m1.1.5.2.17.3">2</mn></msub><mrow id="S3.E5.m1.1.5.2.18"><mo id="S3.E5.m1.1.5.2.18.1">(</mo><mover accent="true" id="S3.E5.m1.1.5.2.18.2"><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.1.5.2.18.2.2">𝒫</mi><mo id="S3.E5.m1.1.5.2.18.2.1">^</mo></mover><mrow id="S3.E5.m1.1.5.2.18.3"><mo id="S3.E5.m1.1.5.2.18.3.1" stretchy="false">(</mo><mo id="S3.E5.m1.1.5.2.18.3.2" lspace="0em" rspace="0em">⋅</mo><mo fence="false" id="S3.E5.m1.1.5.2.18.3.3" rspace="0.167em" stretchy="false">|</mo><mover accent="true" id="S3.E5.m1.1.5.2.18.3.4"><mi id="S3.E5.m1.1.5.2.18.3.4.2">ϕ</mi><mo id="S3.E5.m1.1.5.2.18.3.4.1">¯</mo></mover><mrow id="S3.E5.m1.1.5.2.18.3.5"><mo id="S3.E5.m1.1.5.2.18.3.5.1" stretchy="false">(</mo><msub id="S3.E5.m1.1.5.2.18.3.5.2"><mi id="S3.E5.m1.1.5.2.18.3.5.2.2">s</mi><mi id="S3.E5.m1.1.5.2.18.3.5.2.3">i</mi></msub><mo id="S3.E5.m1.1.5.2.18.3.5.3" stretchy="false">)</mo></mrow><mo id="S3.E5.m1.1.5.2.18.3.6">,</mo><msub id="S3.E5.m1.1.5.2.18.3.7"><mi id="S3.E5.m1.1.5.2.18.3.7.2">a</mi><mi id="S3.E5.m1.1.5.2.18.3.7.3">i</mi></msub><mo id="S3.E5.m1.1.5.2.18.3.8" stretchy="false">)</mo></mrow><mo id="S3.E5.m1.1.5.2.18.4">,</mo><mover accent="true" id="S3.E5.m1.1.5.2.18.5"><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.1.5.2.18.5.2">𝒫</mi><mo id="S3.E5.m1.1.5.2.18.5.1">^</mo></mover><mrow id="S3.E5.m1.1.5.2.18.6"><mo id="S3.E5.m1.1.5.2.18.6.1" stretchy="false">(</mo><mo id="S3.E5.m1.1.5.2.18.6.2" lspace="0em" rspace="0em">⋅</mo><mo fence="false" id="S3.E5.m1.1.5.2.18.6.3" rspace="0.167em" stretchy="false">|</mo><mover accent="true" id="S3.E5.m1.1.5.2.18.6.4"><mi id="S3.E5.m1.1.5.2.18.6.4.2">ϕ</mi><mo id="S3.E5.m1.1.5.2.18.6.4.1">¯</mo></mover><mrow id="S3.E5.m1.1.5.2.18.6.5"><mo id="S3.E5.m1.1.5.2.18.6.5.1" stretchy="false">(</mo><msub id="S3.E5.m1.1.5.2.18.6.5.2"><mi id="S3.E5.m1.1.5.2.18.6.5.2.2">s</mi><mi id="S3.E5.m1.1.5.2.18.6.5.2.3">j</mi></msub><mo id="S3.E5.m1.1.5.2.18.6.5.3" stretchy="false">)</mo></mrow><mo id="S3.E5.m1.1.5.2.18.6.6">,</mo><msub id="S3.E5.m1.1.5.2.18.6.7"><mi id="S3.E5.m1.1.5.2.18.6.7.2">a</mi><mi id="S3.E5.m1.1.5.2.18.6.7.3">j</mi></msub><mo id="S3.E5.m1.1.5.2.18.6.8" stretchy="false">)</mo></mrow><mo id="S3.E5.m1.1.5.2.18.7">)</mo></mrow><mo id="S3.E5.m1.1.5.2.19">)</mo></mrow><mn id="S3.E5.m1.1.5.3">2</mn></msup></mrow><annotation encoding="application/x-tex" id="S3.E5.m1.1c">J(\phi)=\left(\|\phi(s_{i})-\phi(s_{j})\|_{1}-|r_{s_{i}}^{\pi}-r_{s_{j}}^{\pi}%
|-\gamma W_{2}\left(\hat{\mathcal{P}}(\cdot|\bar{\phi}(s_{i}),a_{i}),\hat{%
\mathcal{P}}(\cdot|\bar{\phi}(s_{j}),a_{j})\right)\right)^{2}</annotation><annotation encoding="application/x-llamapun" id="S3.E5.m1.1d">italic_J ( italic_ϕ ) = ( ∥ italic_ϕ ( italic_s start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) - italic_ϕ ( italic_s start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) ∥ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT - | italic_r start_POSTSUBSCRIPT italic_s start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_π end_POSTSUPERSCRIPT - italic_r start_POSTSUBSCRIPT italic_s start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_π end_POSTSUPERSCRIPT | - italic_γ italic_W start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ( over^ start_ARG caligraphic_P end_ARG ( ⋅ | over¯ start_ARG italic_ϕ end_ARG ( italic_s start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) , italic_a start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) , over^ start_ARG caligraphic_P end_ARG ( ⋅ | over¯ start_ARG italic_ϕ end_ARG ( italic_s start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) , italic_a start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) ) ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.p3.6">where the latent dynamics model <math alttext="\hat{\mathcal{P}}" class="ltx_Math" display="inline" id="S3.SS2.p3.5.m1.1"><semantics id="S3.SS2.p3.5.m1.1a"><mover accent="true" id="S3.SS2.p3.5.m1.1.1" xref="S3.SS2.p3.5.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p3.5.m1.1.1.2" xref="S3.SS2.p3.5.m1.1.1.2.cmml">𝒫</mi><mo id="S3.SS2.p3.5.m1.1.1.1" xref="S3.SS2.p3.5.m1.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.5.m1.1b"><apply id="S3.SS2.p3.5.m1.1.1.cmml" xref="S3.SS2.p3.5.m1.1.1"><ci id="S3.SS2.p3.5.m1.1.1.1.cmml" xref="S3.SS2.p3.5.m1.1.1.1">^</ci><ci id="S3.SS2.p3.5.m1.1.1.2.cmml" xref="S3.SS2.p3.5.m1.1.1.2">𝒫</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.5.m1.1c">\hat{\mathcal{P}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.5.m1.1d">over^ start_ARG caligraphic_P end_ARG</annotation></semantics></math> is modeled with a Gaussian distribution. In Eq. <a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#S3.E5" title="In 3.2 Bisimulation Metric ‣ 3 Preliminaries ‣ Bisimulation metric for Model Predictive Control"><span class="ltx_text ltx_ref_tag">5</span></a>, 2-Wasserstein metric <math alttext="W_{2}" class="ltx_Math" display="inline" id="S3.SS2.p3.6.m2.1"><semantics id="S3.SS2.p3.6.m2.1a"><msub id="S3.SS2.p3.6.m2.1.1" xref="S3.SS2.p3.6.m2.1.1.cmml"><mi id="S3.SS2.p3.6.m2.1.1.2" xref="S3.SS2.p3.6.m2.1.1.2.cmml">W</mi><mn id="S3.SS2.p3.6.m2.1.1.3" xref="S3.SS2.p3.6.m2.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.6.m2.1b"><apply id="S3.SS2.p3.6.m2.1.1.cmml" xref="S3.SS2.p3.6.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.6.m2.1.1.1.cmml" xref="S3.SS2.p3.6.m2.1.1">subscript</csymbol><ci id="S3.SS2.p3.6.m2.1.1.2.cmml" xref="S3.SS2.p3.6.m2.1.1.2">𝑊</ci><cn id="S3.SS2.p3.6.m2.1.1.3.cmml" type="integer" xref="S3.SS2.p3.6.m2.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.6.m2.1c">W_{2}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.6.m2.1d">italic_W start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math> is used because it has a convenient closed form for Gaussian distribution.
Following this approach, we train our encoder similarly by including this MSE loss (Eq. <a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#S3.E5" title="In 3.2 Bisimulation Metric ‣ 3 Preliminaries ‣ Bisimulation metric for Model Predictive Control"><span class="ltx_text ltx_ref_tag">5</span></a>) in our objective function.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Bisimulation metric for model predictive control</h2>
<div class="ltx_para ltx_noindent" id="S4.p1">
<p class="ltx_p" id="S4.p1.1">We introduce Bisimulation Metric Model Predictive Control (BS-MPC), a robust and efficient model-based reinforcement learning algorithm. This section provides a detailed explanation of the BS-MPC algorithm. Furthermore, we present a theoretical analysis that bounds the suboptimality of cumulative rewards in the learned latent space under our architecture. Finally, we highlight three key distinctions between BS-MPC and TD-MPC that contribute to their performance differences.</p>
</div>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Bisimulation Metric for Model Predictive Control</h3>
<div class="ltx_para ltx_noindent" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.1">We introduce BS-MPC, an improvement over TD-MPC that employs <math alttext="\pi^{*}" class="ltx_Math" display="inline" id="S4.SS1.p1.1.m1.1"><semantics id="S4.SS1.p1.1.m1.1a"><msup id="S4.SS1.p1.1.m1.1.1" xref="S4.SS1.p1.1.m1.1.1.cmml"><mi id="S4.SS1.p1.1.m1.1.1.2" xref="S4.SS1.p1.1.m1.1.1.2.cmml">π</mi><mo id="S4.SS1.p1.1.m1.1.1.3" xref="S4.SS1.p1.1.m1.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.1.m1.1b"><apply id="S4.SS1.p1.1.m1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.1.m1.1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1">superscript</csymbol><ci id="S4.SS1.p1.1.m1.1.1.2.cmml" xref="S4.SS1.p1.1.m1.1.1.2">𝜋</ci><times id="S4.SS1.p1.1.m1.1.1.3.cmml" xref="S4.SS1.p1.1.m1.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.1.m1.1c">\pi^{*}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.1.m1.1d">italic_π start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math>-bisimulation metrics to train the encoder. The training flow for BS-MPC is detailed in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#A3" title="Appendix C BS-MPC training algorithm flow ‣ Bisimulation metric for Model Predictive Control"><span class="ltx_text ltx_ref_tag">C</span></a>.</p>
</div>
<section class="ltx_paragraph" id="S4.SS1.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">Components</h4>
<div class="ltx_para ltx_noindent" id="S4.SS1.SSS0.Px1.p1">
<p class="ltx_p" id="S4.SS1.SSS0.Px1.p1.16">BS-MPC shares the same five core components as TD-MPC: encoder, latent dynamics, reward, state-action value and policy.</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E6">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\begin{split}\textbf{Encoder:}&amp;\quad z_{k}=h_{\theta^{h}}(s_{k})\qquad\hskip 2%
1.33955pt\textbf{Latent dynamics:}\quad z_{k+1}=d_{\theta^{d}}(z_{k},a_{k})\\
\textbf{Reward:}&amp;\quad\hat{r}_{k}={\mathcal{R}}_{\theta^{R}}(z_{k},a_{k})%
\qquad\textbf{State-action value:}\quad\hat{Q}_{k}=Q_{\theta^{Q}}(z_{k},a_{k})%
\\
\textbf{Policy:}&amp;\quad\hat{a}_{k}\sim\pi_{\psi}(z_{k})\end{split}" class="ltx_Math" display="block" id="S4.E6.m1.66"><semantics id="S4.E6.m1.66a"><mtable columnspacing="0pt" displaystyle="true" id="S4.E6.m1.66.66.7" rowspacing="0pt"><mtr id="S4.E6.m1.66.66.7a"><mtd class="ltx_align_right" columnalign="right" id="S4.E6.m1.66.66.7b"><mtext class="ltx_mathvariant_bold" id="S4.E6.m1.1.1.1.1.1.1" xref="S4.E6.m1.1.1.1.1.1.1a.cmml">Encoder:</mtext></mtd><mtd class="ltx_align_left" columnalign="left" id="S4.E6.m1.66.66.7c"><mrow id="S4.E6.m1.63.63.4.61.25.24.24"><mrow id="S4.E6.m1.62.62.3.60.24.23.23.1"><msub id="S4.E6.m1.62.62.3.60.24.23.23.1.2"><mi id="S4.E6.m1.2.2.2.2.1.1" xref="S4.E6.m1.2.2.2.2.1.1.cmml">z</mi><mi id="S4.E6.m1.3.3.3.3.2.2.1" xref="S4.E6.m1.3.3.3.3.2.2.1.cmml">k</mi></msub><mo id="S4.E6.m1.4.4.4.4.3.3" xref="S4.E6.m1.4.4.4.4.3.3.cmml">=</mo><mrow id="S4.E6.m1.62.62.3.60.24.23.23.1.1.1"><mrow id="S4.E6.m1.62.62.3.60.24.23.23.1.1.1.1"><msub id="S4.E6.m1.62.62.3.60.24.23.23.1.1.1.1.3"><mi id="S4.E6.m1.5.5.5.5.4.4" xref="S4.E6.m1.5.5.5.5.4.4.cmml">h</mi><msup id="S4.E6.m1.6.6.6.6.5.5.1" xref="S4.E6.m1.6.6.6.6.5.5.1.cmml"><mi id="S4.E6.m1.6.6.6.6.5.5.1.2" xref="S4.E6.m1.6.6.6.6.5.5.1.2.cmml">θ</mi><mi id="S4.E6.m1.6.6.6.6.5.5.1.3" xref="S4.E6.m1.6.6.6.6.5.5.1.3.cmml">h</mi></msup></msub><mo id="S4.E6.m1.62.62.3.60.24.23.23.1.1.1.1.2" xref="S4.E6.m1.61.61.2.3.cmml">⁢</mo><mrow id="S4.E6.m1.62.62.3.60.24.23.23.1.1.1.1.1.1"><mo id="S4.E6.m1.7.7.7.7.6.6" stretchy="false" xref="S4.E6.m1.61.61.2.3.cmml">(</mo><msub id="S4.E6.m1.62.62.3.60.24.23.23.1.1.1.1.1.1.1"><mi id="S4.E6.m1.8.8.8.8.7.7" xref="S4.E6.m1.8.8.8.8.7.7.cmml">s</mi><mi id="S4.E6.m1.9.9.9.9.8.8.1" xref="S4.E6.m1.9.9.9.9.8.8.1.cmml">k</mi></msub><mo id="S4.E6.m1.10.10.10.10.9.9" stretchy="false" xref="S4.E6.m1.61.61.2.3.cmml">)</mo></mrow></mrow><mspace id="S4.E6.m1.62.62.3.60.24.23.23.1.1.1.2" width="4.13em" xref="S4.E6.m1.61.61.2.3.cmml"></mspace><mtext class="ltx_mathvariant_bold" id="S4.E6.m1.11.11.11.11.10.10" xref="S4.E6.m1.11.11.11.11.10.10a.cmml">Latent dynamics:</mtext></mrow></mrow><mspace id="S4.E6.m1.63.63.4.61.25.24.24.3" width="1em" xref="S4.E6.m1.61.61.2.3.cmml"></mspace><mrow id="S4.E6.m1.63.63.4.61.25.24.24.2"><msub id="S4.E6.m1.63.63.4.61.25.24.24.2.3"><mi id="S4.E6.m1.12.12.12.12.11.11" xref="S4.E6.m1.12.12.12.12.11.11.cmml">z</mi><mrow id="S4.E6.m1.13.13.13.13.12.12.1" xref="S4.E6.m1.13.13.13.13.12.12.1.cmml"><mi id="S4.E6.m1.13.13.13.13.12.12.1.2" xref="S4.E6.m1.13.13.13.13.12.12.1.2.cmml">k</mi><mo id="S4.E6.m1.13.13.13.13.12.12.1.1" xref="S4.E6.m1.13.13.13.13.12.12.1.1.cmml">+</mo><mn id="S4.E6.m1.13.13.13.13.12.12.1.3" xref="S4.E6.m1.13.13.13.13.12.12.1.3.cmml">1</mn></mrow></msub><mo id="S4.E6.m1.14.14.14.14.13.13" xref="S4.E6.m1.14.14.14.14.13.13.cmml">=</mo><mrow id="S4.E6.m1.63.63.4.61.25.24.24.2.2"><msub id="S4.E6.m1.63.63.4.61.25.24.24.2.2.4"><mi id="S4.E6.m1.15.15.15.15.14.14" xref="S4.E6.m1.15.15.15.15.14.14.cmml">d</mi><msup id="S4.E6.m1.16.16.16.16.15.15.1" xref="S4.E6.m1.16.16.16.16.15.15.1.cmml"><mi id="S4.E6.m1.16.16.16.16.15.15.1.2" xref="S4.E6.m1.16.16.16.16.15.15.1.2.cmml">θ</mi><mi id="S4.E6.m1.16.16.16.16.15.15.1.3" xref="S4.E6.m1.16.16.16.16.15.15.1.3.cmml">d</mi></msup></msub><mo id="S4.E6.m1.63.63.4.61.25.24.24.2.2.3" xref="S4.E6.m1.61.61.2.3.cmml">⁢</mo><mrow id="S4.E6.m1.63.63.4.61.25.24.24.2.2.2.2"><mo id="S4.E6.m1.17.17.17.17.16.16" stretchy="false" xref="S4.E6.m1.61.61.2.3.cmml">(</mo><msub id="S4.E6.m1.63.63.4.61.25.24.24.2.1.1.1.1"><mi id="S4.E6.m1.18.18.18.18.17.17" xref="S4.E6.m1.18.18.18.18.17.17.cmml">z</mi><mi id="S4.E6.m1.19.19.19.19.18.18.1" xref="S4.E6.m1.19.19.19.19.18.18.1.cmml">k</mi></msub><mo id="S4.E6.m1.20.20.20.20.19.19" xref="S4.E6.m1.61.61.2.3.cmml">,</mo><msub id="S4.E6.m1.63.63.4.61.25.24.24.2.2.2.2.2"><mi id="S4.E6.m1.21.21.21.21.20.20" xref="S4.E6.m1.21.21.21.21.20.20.cmml">a</mi><mi id="S4.E6.m1.22.22.22.22.21.21.1" xref="S4.E6.m1.22.22.22.22.21.21.1.cmml">k</mi></msub><mo id="S4.E6.m1.23.23.23.23.22.22" stretchy="false" xref="S4.E6.m1.61.61.2.3.cmml">)</mo></mrow></mrow></mrow></mrow></mtd></mtr><mtr id="S4.E6.m1.66.66.7d"><mtd class="ltx_align_right" columnalign="right" id="S4.E6.m1.66.66.7e"><mtext class="ltx_mathvariant_bold" id="S4.E6.m1.24.24.24.1.1.1" xref="S4.E6.m1.24.24.24.1.1.1a.cmml">Reward:</mtext></mtd><mtd class="ltx_align_left" columnalign="left" id="S4.E6.m1.66.66.7f"><mrow id="S4.E6.m1.65.65.6.63.28.27.27"><mrow id="S4.E6.m1.64.64.5.62.27.26.26.1"><msub id="S4.E6.m1.64.64.5.62.27.26.26.1.2"><mover accent="true" id="S4.E6.m1.25.25.25.2.1.1" xref="S4.E6.m1.25.25.25.2.1.1.cmml"><mi id="S4.E6.m1.25.25.25.2.1.1.2" xref="S4.E6.m1.25.25.25.2.1.1.2.cmml">r</mi><mo id="S4.E6.m1.25.25.25.2.1.1.1" xref="S4.E6.m1.25.25.25.2.1.1.1.cmml">^</mo></mover><mi id="S4.E6.m1.26.26.26.3.2.2.1" xref="S4.E6.m1.26.26.26.3.2.2.1.cmml">k</mi></msub><mo id="S4.E6.m1.27.27.27.4.3.3" xref="S4.E6.m1.27.27.27.4.3.3.cmml">=</mo><mrow id="S4.E6.m1.64.64.5.62.27.26.26.1.1.1"><mrow id="S4.E6.m1.64.64.5.62.27.26.26.1.1.1.1"><msub id="S4.E6.m1.64.64.5.62.27.26.26.1.1.1.1.4"><mi class="ltx_font_mathcaligraphic" id="S4.E6.m1.28.28.28.5.4.4" xref="S4.E6.m1.28.28.28.5.4.4.cmml">ℛ</mi><msup id="S4.E6.m1.29.29.29.6.5.5.1" xref="S4.E6.m1.29.29.29.6.5.5.1.cmml"><mi id="S4.E6.m1.29.29.29.6.5.5.1.2" xref="S4.E6.m1.29.29.29.6.5.5.1.2.cmml">θ</mi><mi id="S4.E6.m1.29.29.29.6.5.5.1.3" xref="S4.E6.m1.29.29.29.6.5.5.1.3.cmml">R</mi></msup></msub><mo id="S4.E6.m1.64.64.5.62.27.26.26.1.1.1.1.3" xref="S4.E6.m1.61.61.2.3.cmml">⁢</mo><mrow id="S4.E6.m1.64.64.5.62.27.26.26.1.1.1.1.2.2"><mo id="S4.E6.m1.30.30.30.7.6.6" stretchy="false" xref="S4.E6.m1.61.61.2.3.cmml">(</mo><msub id="S4.E6.m1.64.64.5.62.27.26.26.1.1.1.1.1.1.1"><mi id="S4.E6.m1.31.31.31.8.7.7" xref="S4.E6.m1.31.31.31.8.7.7.cmml">z</mi><mi id="S4.E6.m1.32.32.32.9.8.8.1" xref="S4.E6.m1.32.32.32.9.8.8.1.cmml">k</mi></msub><mo id="S4.E6.m1.33.33.33.10.9.9" xref="S4.E6.m1.61.61.2.3.cmml">,</mo><msub id="S4.E6.m1.64.64.5.62.27.26.26.1.1.1.1.2.2.2"><mi id="S4.E6.m1.34.34.34.11.10.10" xref="S4.E6.m1.34.34.34.11.10.10.cmml">a</mi><mi id="S4.E6.m1.35.35.35.12.11.11.1" xref="S4.E6.m1.35.35.35.12.11.11.1.cmml">k</mi></msub><mo id="S4.E6.m1.36.36.36.13.12.12" stretchy="false" xref="S4.E6.m1.61.61.2.3.cmml">)</mo></mrow></mrow><mspace id="S4.E6.m1.64.64.5.62.27.26.26.1.1.1.2" width="2em" xref="S4.E6.m1.61.61.2.3.cmml"></mspace><mtext class="ltx_mathvariant_bold" id="S4.E6.m1.37.37.37.14.13.13" xref="S4.E6.m1.37.37.37.14.13.13a.cmml">State-action value:</mtext></mrow></mrow><mspace id="S4.E6.m1.65.65.6.63.28.27.27.3" width="1em" xref="S4.E6.m1.61.61.2.3.cmml"></mspace><mrow id="S4.E6.m1.65.65.6.63.28.27.27.2"><msub id="S4.E6.m1.65.65.6.63.28.27.27.2.3"><mover accent="true" id="S4.E6.m1.38.38.38.15.14.14" xref="S4.E6.m1.38.38.38.15.14.14.cmml"><mi id="S4.E6.m1.38.38.38.15.14.14.2" xref="S4.E6.m1.38.38.38.15.14.14.2.cmml">Q</mi><mo id="S4.E6.m1.38.38.38.15.14.14.1" xref="S4.E6.m1.38.38.38.15.14.14.1.cmml">^</mo></mover><mi id="S4.E6.m1.39.39.39.16.15.15.1" xref="S4.E6.m1.39.39.39.16.15.15.1.cmml">k</mi></msub><mo id="S4.E6.m1.40.40.40.17.16.16" xref="S4.E6.m1.40.40.40.17.16.16.cmml">=</mo><mrow id="S4.E6.m1.65.65.6.63.28.27.27.2.2"><msub id="S4.E6.m1.65.65.6.63.28.27.27.2.2.4"><mi id="S4.E6.m1.41.41.41.18.17.17" xref="S4.E6.m1.41.41.41.18.17.17.cmml">Q</mi><msup id="S4.E6.m1.42.42.42.19.18.18.1" xref="S4.E6.m1.42.42.42.19.18.18.1.cmml"><mi id="S4.E6.m1.42.42.42.19.18.18.1.2" xref="S4.E6.m1.42.42.42.19.18.18.1.2.cmml">θ</mi><mi id="S4.E6.m1.42.42.42.19.18.18.1.3" xref="S4.E6.m1.42.42.42.19.18.18.1.3.cmml">Q</mi></msup></msub><mo id="S4.E6.m1.65.65.6.63.28.27.27.2.2.3" xref="S4.E6.m1.61.61.2.3.cmml">⁢</mo><mrow id="S4.E6.m1.65.65.6.63.28.27.27.2.2.2.2"><mo id="S4.E6.m1.43.43.43.20.19.19" stretchy="false" xref="S4.E6.m1.61.61.2.3.cmml">(</mo><msub id="S4.E6.m1.65.65.6.63.28.27.27.2.1.1.1.1"><mi id="S4.E6.m1.44.44.44.21.20.20" xref="S4.E6.m1.44.44.44.21.20.20.cmml">z</mi><mi id="S4.E6.m1.45.45.45.22.21.21.1" xref="S4.E6.m1.45.45.45.22.21.21.1.cmml">k</mi></msub><mo id="S4.E6.m1.46.46.46.23.22.22" xref="S4.E6.m1.61.61.2.3.cmml">,</mo><msub id="S4.E6.m1.65.65.6.63.28.27.27.2.2.2.2.2"><mi id="S4.E6.m1.47.47.47.24.23.23" xref="S4.E6.m1.47.47.47.24.23.23.cmml">a</mi><mi id="S4.E6.m1.48.48.48.25.24.24.1" xref="S4.E6.m1.48.48.48.25.24.24.1.cmml">k</mi></msub><mo id="S4.E6.m1.49.49.49.26.25.25" stretchy="false" xref="S4.E6.m1.61.61.2.3.cmml">)</mo></mrow></mrow></mrow></mrow></mtd></mtr><mtr id="S4.E6.m1.66.66.7g"><mtd class="ltx_align_right" columnalign="right" id="S4.E6.m1.66.66.7h"><mtext class="ltx_mathvariant_bold" id="S4.E6.m1.50.50.50.1.1.1" xref="S4.E6.m1.50.50.50.1.1.1a.cmml">Policy:</mtext></mtd><mtd class="ltx_align_left" columnalign="left" id="S4.E6.m1.66.66.7i"><mrow id="S4.E6.m1.66.66.7.64.11.10"><msub id="S4.E6.m1.66.66.7.64.11.10.11"><mover accent="true" id="S4.E6.m1.51.51.51.2.1.1" xref="S4.E6.m1.51.51.51.2.1.1.cmml"><mi id="S4.E6.m1.51.51.51.2.1.1.2" xref="S4.E6.m1.51.51.51.2.1.1.2.cmml">a</mi><mo id="S4.E6.m1.51.51.51.2.1.1.1" xref="S4.E6.m1.51.51.51.2.1.1.1.cmml">^</mo></mover><mi id="S4.E6.m1.52.52.52.3.2.2.1" xref="S4.E6.m1.52.52.52.3.2.2.1.cmml">k</mi></msub><mo id="S4.E6.m1.53.53.53.4.3.3" xref="S4.E6.m1.53.53.53.4.3.3.cmml">∼</mo><mrow id="S4.E6.m1.66.66.7.64.11.10.10"><msub id="S4.E6.m1.66.66.7.64.11.10.10.3"><mi id="S4.E6.m1.54.54.54.5.4.4" xref="S4.E6.m1.54.54.54.5.4.4.cmml">π</mi><mi id="S4.E6.m1.55.55.55.6.5.5.1" xref="S4.E6.m1.55.55.55.6.5.5.1.cmml">ψ</mi></msub><mo id="S4.E6.m1.66.66.7.64.11.10.10.2" xref="S4.E6.m1.61.61.2.3.cmml">⁢</mo><mrow id="S4.E6.m1.66.66.7.64.11.10.10.1.1"><mo id="S4.E6.m1.56.56.56.7.6.6" stretchy="false" xref="S4.E6.m1.61.61.2.3.cmml">(</mo><msub id="S4.E6.m1.66.66.7.64.11.10.10.1.1.1"><mi id="S4.E6.m1.57.57.57.8.7.7" xref="S4.E6.m1.57.57.57.8.7.7.cmml">z</mi><mi id="S4.E6.m1.58.58.58.9.8.8.1" xref="S4.E6.m1.58.58.58.9.8.8.1.cmml">k</mi></msub><mo id="S4.E6.m1.59.59.59.10.9.9" stretchy="false" xref="S4.E6.m1.61.61.2.3.cmml">)</mo></mrow></mrow></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S4.E6.m1.66b"><apply id="S4.E6.m1.61.61.2.3.cmml" xref="S4.E6.m1.62.62.3.60.24.23.23.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E6.m1.61.61.2.3a.cmml" xref="S4.E6.m1.62.62.3.60.24.23.23.1.1.1.1.2">formulae-sequence</csymbol><apply id="S4.E6.m1.60.60.1.1.1.3.cmml" xref="S4.E6.m1.62.62.3.60.24.23.23.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E6.m1.60.60.1.1.1.3a.cmml" xref="S4.E6.m1.62.62.3.60.24.23.23.1.1.1.1.2">formulae-sequence</csymbol><apply id="S4.E6.m1.60.60.1.1.1.1.1.cmml" xref="S4.E6.m1.62.62.3.60.24.23.23.1.1.1.1.2"><eq id="S4.E6.m1.4.4.4.4.3.3.cmml" xref="S4.E6.m1.4.4.4.4.3.3"></eq><apply id="S4.E6.m1.60.60.1.1.1.1.1.3.cmml" xref="S4.E6.m1.62.62.3.60.24.23.23.1.1.1.1.2"><times id="S4.E6.m1.60.60.1.1.1.1.1.3.1.cmml" xref="S4.E6.m1.62.62.3.60.24.23.23.1.1.1.1.2"></times><ci id="S4.E6.m1.1.1.1.1.1.1a.cmml" xref="S4.E6.m1.1.1.1.1.1.1"><mtext class="ltx_mathvariant_bold" id="S4.E6.m1.1.1.1.1.1.1.cmml" xref="S4.E6.m1.1.1.1.1.1.1">Encoder:</mtext></ci><apply id="S4.E6.m1.60.60.1.1.1.1.1.3.3.cmml" xref="S4.E6.m1.62.62.3.60.24.23.23.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E6.m1.60.60.1.1.1.1.1.3.3.1.cmml" xref="S4.E6.m1.62.62.3.60.24.23.23.1.1.1.1.2">subscript</csymbol><ci id="S4.E6.m1.2.2.2.2.1.1.cmml" xref="S4.E6.m1.2.2.2.2.1.1">𝑧</ci><ci id="S4.E6.m1.3.3.3.3.2.2.1.cmml" xref="S4.E6.m1.3.3.3.3.2.2.1">𝑘</ci></apply></apply><list id="S4.E6.m1.60.60.1.1.1.1.1.1.2.cmml" xref="S4.E6.m1.62.62.3.60.24.23.23.1.1.1.1.2"><apply id="S4.E6.m1.60.60.1.1.1.1.1.1.1.1.cmml" xref="S4.E6.m1.62.62.3.60.24.23.23.1.1.1.1.2"><times id="S4.E6.m1.60.60.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E6.m1.62.62.3.60.24.23.23.1.1.1.1.2"></times><apply id="S4.E6.m1.60.60.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E6.m1.62.62.3.60.24.23.23.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E6.m1.60.60.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E6.m1.62.62.3.60.24.23.23.1.1.1.1.2">subscript</csymbol><ci id="S4.E6.m1.5.5.5.5.4.4.cmml" xref="S4.E6.m1.5.5.5.5.4.4">ℎ</ci><apply id="S4.E6.m1.6.6.6.6.5.5.1.cmml" xref="S4.E6.m1.6.6.6.6.5.5.1"><csymbol cd="ambiguous" id="S4.E6.m1.6.6.6.6.5.5.1.1.cmml" xref="S4.E6.m1.6.6.6.6.5.5.1">superscript</csymbol><ci id="S4.E6.m1.6.6.6.6.5.5.1.2.cmml" xref="S4.E6.m1.6.6.6.6.5.5.1.2">𝜃</ci><ci id="S4.E6.m1.6.6.6.6.5.5.1.3.cmml" xref="S4.E6.m1.6.6.6.6.5.5.1.3">ℎ</ci></apply></apply><apply id="S4.E6.m1.60.60.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E6.m1.62.62.3.60.24.23.23.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E6.m1.60.60.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E6.m1.62.62.3.60.24.23.23.1.1.1.1.2">subscript</csymbol><ci id="S4.E6.m1.8.8.8.8.7.7.cmml" xref="S4.E6.m1.8.8.8.8.7.7">𝑠</ci><ci id="S4.E6.m1.9.9.9.9.8.8.1.cmml" xref="S4.E6.m1.9.9.9.9.8.8.1">𝑘</ci></apply></apply><ci id="S4.E6.m1.11.11.11.11.10.10a.cmml" xref="S4.E6.m1.11.11.11.11.10.10"><mtext class="ltx_mathvariant_bold" id="S4.E6.m1.11.11.11.11.10.10.cmml" xref="S4.E6.m1.11.11.11.11.10.10">Latent dynamics:</mtext></ci></list></apply><apply id="S4.E6.m1.60.60.1.1.1.2.2.cmml" xref="S4.E6.m1.62.62.3.60.24.23.23.1.1.1.1.2"><and id="S4.E6.m1.60.60.1.1.1.2.2a.cmml" xref="S4.E6.m1.62.62.3.60.24.23.23.1.1.1.1.2"></and><apply id="S4.E6.m1.60.60.1.1.1.2.2b.cmml" xref="S4.E6.m1.62.62.3.60.24.23.23.1.1.1.1.2"><eq id="S4.E6.m1.14.14.14.14.13.13.cmml" xref="S4.E6.m1.14.14.14.14.13.13"></eq><apply id="S4.E6.m1.60.60.1.1.1.2.2.6.cmml" xref="S4.E6.m1.62.62.3.60.24.23.23.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E6.m1.60.60.1.1.1.2.2.6.1.cmml" xref="S4.E6.m1.62.62.3.60.24.23.23.1.1.1.1.2">subscript</csymbol><ci id="S4.E6.m1.12.12.12.12.11.11.cmml" xref="S4.E6.m1.12.12.12.12.11.11">𝑧</ci><apply id="S4.E6.m1.13.13.13.13.12.12.1.cmml" xref="S4.E6.m1.13.13.13.13.12.12.1"><plus id="S4.E6.m1.13.13.13.13.12.12.1.1.cmml" xref="S4.E6.m1.13.13.13.13.12.12.1.1"></plus><ci id="S4.E6.m1.13.13.13.13.12.12.1.2.cmml" xref="S4.E6.m1.13.13.13.13.12.12.1.2">𝑘</ci><cn id="S4.E6.m1.13.13.13.13.12.12.1.3.cmml" type="integer" xref="S4.E6.m1.13.13.13.13.12.12.1.3">1</cn></apply></apply><apply id="S4.E6.m1.60.60.1.1.1.2.2.2.cmml" xref="S4.E6.m1.62.62.3.60.24.23.23.1.1.1.1.2"><times id="S4.E6.m1.60.60.1.1.1.2.2.2.3.cmml" xref="S4.E6.m1.62.62.3.60.24.23.23.1.1.1.1.2"></times><apply id="S4.E6.m1.60.60.1.1.1.2.2.2.4.cmml" xref="S4.E6.m1.62.62.3.60.24.23.23.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E6.m1.60.60.1.1.1.2.2.2.4.1.cmml" xref="S4.E6.m1.62.62.3.60.24.23.23.1.1.1.1.2">subscript</csymbol><ci id="S4.E6.m1.15.15.15.15.14.14.cmml" xref="S4.E6.m1.15.15.15.15.14.14">𝑑</ci><apply id="S4.E6.m1.16.16.16.16.15.15.1.cmml" xref="S4.E6.m1.16.16.16.16.15.15.1"><csymbol cd="ambiguous" id="S4.E6.m1.16.16.16.16.15.15.1.1.cmml" xref="S4.E6.m1.16.16.16.16.15.15.1">superscript</csymbol><ci id="S4.E6.m1.16.16.16.16.15.15.1.2.cmml" xref="S4.E6.m1.16.16.16.16.15.15.1.2">𝜃</ci><ci id="S4.E6.m1.16.16.16.16.15.15.1.3.cmml" xref="S4.E6.m1.16.16.16.16.15.15.1.3">𝑑</ci></apply></apply><interval closure="open" id="S4.E6.m1.60.60.1.1.1.2.2.2.2.3.cmml" xref="S4.E6.m1.62.62.3.60.24.23.23.1.1.1.1.2"><apply id="S4.E6.m1.60.60.1.1.1.2.2.1.1.1.1.cmml" xref="S4.E6.m1.62.62.3.60.24.23.23.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E6.m1.60.60.1.1.1.2.2.1.1.1.1.1.cmml" xref="S4.E6.m1.62.62.3.60.24.23.23.1.1.1.1.2">subscript</csymbol><ci id="S4.E6.m1.18.18.18.18.17.17.cmml" xref="S4.E6.m1.18.18.18.18.17.17">𝑧</ci><ci id="S4.E6.m1.19.19.19.19.18.18.1.cmml" xref="S4.E6.m1.19.19.19.19.18.18.1">𝑘</ci></apply><apply id="S4.E6.m1.60.60.1.1.1.2.2.2.2.2.2.cmml" xref="S4.E6.m1.62.62.3.60.24.23.23.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E6.m1.60.60.1.1.1.2.2.2.2.2.2.1.cmml" xref="S4.E6.m1.62.62.3.60.24.23.23.1.1.1.1.2">subscript</csymbol><ci id="S4.E6.m1.21.21.21.21.20.20.cmml" xref="S4.E6.m1.21.21.21.21.20.20">𝑎</ci><ci id="S4.E6.m1.22.22.22.22.21.21.1.cmml" xref="S4.E6.m1.22.22.22.22.21.21.1">𝑘</ci></apply></interval><ci id="S4.E6.m1.24.24.24.1.1.1a.cmml" xref="S4.E6.m1.24.24.24.1.1.1"><mtext class="ltx_mathvariant_bold" id="S4.E6.m1.24.24.24.1.1.1.cmml" xref="S4.E6.m1.24.24.24.1.1.1">Reward:</mtext></ci><apply id="S4.E6.m1.60.60.1.1.1.2.2.2.6.cmml" xref="S4.E6.m1.62.62.3.60.24.23.23.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E6.m1.60.60.1.1.1.2.2.2.6.1.cmml" xref="S4.E6.m1.62.62.3.60.24.23.23.1.1.1.1.2">subscript</csymbol><apply id="S4.E6.m1.25.25.25.2.1.1.cmml" xref="S4.E6.m1.25.25.25.2.1.1"><ci id="S4.E6.m1.25.25.25.2.1.1.1.cmml" xref="S4.E6.m1.25.25.25.2.1.1.1">^</ci><ci id="S4.E6.m1.25.25.25.2.1.1.2.cmml" xref="S4.E6.m1.25.25.25.2.1.1.2">𝑟</ci></apply><ci id="S4.E6.m1.26.26.26.3.2.2.1.cmml" xref="S4.E6.m1.26.26.26.3.2.2.1">𝑘</ci></apply></apply></apply><apply id="S4.E6.m1.60.60.1.1.1.2.2c.cmml" xref="S4.E6.m1.62.62.3.60.24.23.23.1.1.1.1.2"><eq id="S4.E6.m1.27.27.27.4.3.3.cmml" xref="S4.E6.m1.27.27.27.4.3.3"></eq><share href="https://arxiv.org/html/2410.04553v1#S4.E6.m1.60.60.1.1.1.2.2.2.cmml" id="S4.E6.m1.60.60.1.1.1.2.2d.cmml" xref="S4.E6.m1.62.62.3.60.24.23.23.1.1.1.1.2"></share><apply id="S4.E6.m1.60.60.1.1.1.2.2.4.cmml" xref="S4.E6.m1.62.62.3.60.24.23.23.1.1.1.1.2"><times id="S4.E6.m1.60.60.1.1.1.2.2.4.3.cmml" xref="S4.E6.m1.62.62.3.60.24.23.23.1.1.1.1.2"></times><apply id="S4.E6.m1.60.60.1.1.1.2.2.4.4.cmml" xref="S4.E6.m1.62.62.3.60.24.23.23.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E6.m1.60.60.1.1.1.2.2.4.4.1.cmml" xref="S4.E6.m1.62.62.3.60.24.23.23.1.1.1.1.2">subscript</csymbol><ci id="S4.E6.m1.28.28.28.5.4.4.cmml" xref="S4.E6.m1.28.28.28.5.4.4">ℛ</ci><apply id="S4.E6.m1.29.29.29.6.5.5.1.cmml" xref="S4.E6.m1.29.29.29.6.5.5.1"><csymbol cd="ambiguous" id="S4.E6.m1.29.29.29.6.5.5.1.1.cmml" xref="S4.E6.m1.29.29.29.6.5.5.1">superscript</csymbol><ci id="S4.E6.m1.29.29.29.6.5.5.1.2.cmml" xref="S4.E6.m1.29.29.29.6.5.5.1.2">𝜃</ci><ci id="S4.E6.m1.29.29.29.6.5.5.1.3.cmml" xref="S4.E6.m1.29.29.29.6.5.5.1.3">𝑅</ci></apply></apply><interval closure="open" id="S4.E6.m1.60.60.1.1.1.2.2.4.2.3.cmml" xref="S4.E6.m1.62.62.3.60.24.23.23.1.1.1.1.2"><apply id="S4.E6.m1.60.60.1.1.1.2.2.3.1.1.1.cmml" xref="S4.E6.m1.62.62.3.60.24.23.23.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E6.m1.60.60.1.1.1.2.2.3.1.1.1.1.cmml" xref="S4.E6.m1.62.62.3.60.24.23.23.1.1.1.1.2">subscript</csymbol><ci id="S4.E6.m1.31.31.31.8.7.7.cmml" xref="S4.E6.m1.31.31.31.8.7.7">𝑧</ci><ci id="S4.E6.m1.32.32.32.9.8.8.1.cmml" xref="S4.E6.m1.32.32.32.9.8.8.1">𝑘</ci></apply><apply id="S4.E6.m1.60.60.1.1.1.2.2.4.2.2.2.cmml" xref="S4.E6.m1.62.62.3.60.24.23.23.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E6.m1.60.60.1.1.1.2.2.4.2.2.2.1.cmml" xref="S4.E6.m1.62.62.3.60.24.23.23.1.1.1.1.2">subscript</csymbol><ci id="S4.E6.m1.34.34.34.11.10.10.cmml" xref="S4.E6.m1.34.34.34.11.10.10">𝑎</ci><ci id="S4.E6.m1.35.35.35.12.11.11.1.cmml" xref="S4.E6.m1.35.35.35.12.11.11.1">𝑘</ci></apply></interval></apply></apply></apply></apply><apply id="S4.E6.m1.61.61.2.2.2.cmml" xref="S4.E6.m1.62.62.3.60.24.23.23.1.1.1.1.2"><and id="S4.E6.m1.61.61.2.2.2a.cmml" xref="S4.E6.m1.62.62.3.60.24.23.23.1.1.1.1.2"></and><apply id="S4.E6.m1.61.61.2.2.2b.cmml" xref="S4.E6.m1.62.62.3.60.24.23.23.1.1.1.1.2"><eq id="S4.E6.m1.40.40.40.17.16.16.cmml" xref="S4.E6.m1.40.40.40.17.16.16"></eq><list id="S4.E6.m1.61.61.2.2.2.1.2.cmml" xref="S4.E6.m1.62.62.3.60.24.23.23.1.1.1.1.2"><ci id="S4.E6.m1.37.37.37.14.13.13a.cmml" xref="S4.E6.m1.37.37.37.14.13.13"><mtext class="ltx_mathvariant_bold" id="S4.E6.m1.37.37.37.14.13.13.cmml" xref="S4.E6.m1.37.37.37.14.13.13">State-action value:</mtext></ci><apply id="S4.E6.m1.61.61.2.2.2.1.1.1.cmml" xref="S4.E6.m1.62.62.3.60.24.23.23.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E6.m1.61.61.2.2.2.1.1.1.1.cmml" xref="S4.E6.m1.62.62.3.60.24.23.23.1.1.1.1.2">subscript</csymbol><apply id="S4.E6.m1.38.38.38.15.14.14.cmml" xref="S4.E6.m1.38.38.38.15.14.14"><ci id="S4.E6.m1.38.38.38.15.14.14.1.cmml" xref="S4.E6.m1.38.38.38.15.14.14.1">^</ci><ci id="S4.E6.m1.38.38.38.15.14.14.2.cmml" xref="S4.E6.m1.38.38.38.15.14.14.2">𝑄</ci></apply><ci id="S4.E6.m1.39.39.39.16.15.15.1.cmml" xref="S4.E6.m1.39.39.39.16.15.15.1">𝑘</ci></apply></list><apply id="S4.E6.m1.61.61.2.2.2.3.cmml" xref="S4.E6.m1.62.62.3.60.24.23.23.1.1.1.1.2"><times id="S4.E6.m1.61.61.2.2.2.3.3.cmml" xref="S4.E6.m1.62.62.3.60.24.23.23.1.1.1.1.2"></times><apply id="S4.E6.m1.61.61.2.2.2.3.4.cmml" xref="S4.E6.m1.62.62.3.60.24.23.23.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E6.m1.61.61.2.2.2.3.4.1.cmml" xref="S4.E6.m1.62.62.3.60.24.23.23.1.1.1.1.2">subscript</csymbol><ci id="S4.E6.m1.41.41.41.18.17.17.cmml" xref="S4.E6.m1.41.41.41.18.17.17">𝑄</ci><apply id="S4.E6.m1.42.42.42.19.18.18.1.cmml" xref="S4.E6.m1.42.42.42.19.18.18.1"><csymbol cd="ambiguous" id="S4.E6.m1.42.42.42.19.18.18.1.1.cmml" xref="S4.E6.m1.42.42.42.19.18.18.1">superscript</csymbol><ci id="S4.E6.m1.42.42.42.19.18.18.1.2.cmml" xref="S4.E6.m1.42.42.42.19.18.18.1.2">𝜃</ci><ci id="S4.E6.m1.42.42.42.19.18.18.1.3.cmml" xref="S4.E6.m1.42.42.42.19.18.18.1.3">𝑄</ci></apply></apply><interval closure="open" id="S4.E6.m1.61.61.2.2.2.3.2.3.cmml" xref="S4.E6.m1.62.62.3.60.24.23.23.1.1.1.1.2"><apply id="S4.E6.m1.61.61.2.2.2.2.1.1.1.cmml" xref="S4.E6.m1.62.62.3.60.24.23.23.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E6.m1.61.61.2.2.2.2.1.1.1.1.cmml" xref="S4.E6.m1.62.62.3.60.24.23.23.1.1.1.1.2">subscript</csymbol><ci id="S4.E6.m1.44.44.44.21.20.20.cmml" xref="S4.E6.m1.44.44.44.21.20.20">𝑧</ci><ci id="S4.E6.m1.45.45.45.22.21.21.1.cmml" xref="S4.E6.m1.45.45.45.22.21.21.1">𝑘</ci></apply><apply id="S4.E6.m1.61.61.2.2.2.3.2.2.2.cmml" xref="S4.E6.m1.62.62.3.60.24.23.23.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E6.m1.61.61.2.2.2.3.2.2.2.1.cmml" xref="S4.E6.m1.62.62.3.60.24.23.23.1.1.1.1.2">subscript</csymbol><ci id="S4.E6.m1.47.47.47.24.23.23.cmml" xref="S4.E6.m1.47.47.47.24.23.23">𝑎</ci><ci id="S4.E6.m1.48.48.48.25.24.24.1.cmml" xref="S4.E6.m1.48.48.48.25.24.24.1">𝑘</ci></apply></interval><ci id="S4.E6.m1.50.50.50.1.1.1a.cmml" xref="S4.E6.m1.50.50.50.1.1.1"><mtext class="ltx_mathvariant_bold" id="S4.E6.m1.50.50.50.1.1.1.cmml" xref="S4.E6.m1.50.50.50.1.1.1">Policy:</mtext></ci><apply id="S4.E6.m1.61.61.2.2.2.3.6.cmml" xref="S4.E6.m1.62.62.3.60.24.23.23.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E6.m1.61.61.2.2.2.3.6.1.cmml" xref="S4.E6.m1.62.62.3.60.24.23.23.1.1.1.1.2">subscript</csymbol><apply id="S4.E6.m1.51.51.51.2.1.1.cmml" xref="S4.E6.m1.51.51.51.2.1.1"><ci id="S4.E6.m1.51.51.51.2.1.1.1.cmml" xref="S4.E6.m1.51.51.51.2.1.1.1">^</ci><ci id="S4.E6.m1.51.51.51.2.1.1.2.cmml" xref="S4.E6.m1.51.51.51.2.1.1.2">𝑎</ci></apply><ci id="S4.E6.m1.52.52.52.3.2.2.1.cmml" xref="S4.E6.m1.52.52.52.3.2.2.1">𝑘</ci></apply></apply></apply><apply id="S4.E6.m1.61.61.2.2.2c.cmml" xref="S4.E6.m1.62.62.3.60.24.23.23.1.1.1.1.2"><csymbol cd="latexml" id="S4.E6.m1.53.53.53.4.3.3.cmml" xref="S4.E6.m1.53.53.53.4.3.3">similar-to</csymbol><share href="https://arxiv.org/html/2410.04553v1#S4.E6.m1.61.61.2.2.2.3.cmml" id="S4.E6.m1.61.61.2.2.2d.cmml" xref="S4.E6.m1.62.62.3.60.24.23.23.1.1.1.1.2"></share><apply id="S4.E6.m1.61.61.2.2.2.4.cmml" xref="S4.E6.m1.62.62.3.60.24.23.23.1.1.1.1.2"><times id="S4.E6.m1.61.61.2.2.2.4.2.cmml" xref="S4.E6.m1.62.62.3.60.24.23.23.1.1.1.1.2"></times><apply id="S4.E6.m1.61.61.2.2.2.4.3.cmml" xref="S4.E6.m1.62.62.3.60.24.23.23.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E6.m1.61.61.2.2.2.4.3.1.cmml" xref="S4.E6.m1.62.62.3.60.24.23.23.1.1.1.1.2">subscript</csymbol><ci id="S4.E6.m1.54.54.54.5.4.4.cmml" xref="S4.E6.m1.54.54.54.5.4.4">𝜋</ci><ci id="S4.E6.m1.55.55.55.6.5.5.1.cmml" xref="S4.E6.m1.55.55.55.6.5.5.1">𝜓</ci></apply><apply id="S4.E6.m1.61.61.2.2.2.4.1.1.1.cmml" xref="S4.E6.m1.62.62.3.60.24.23.23.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E6.m1.61.61.2.2.2.4.1.1.1.1.cmml" xref="S4.E6.m1.62.62.3.60.24.23.23.1.1.1.1.2">subscript</csymbol><ci id="S4.E6.m1.57.57.57.8.7.7.cmml" xref="S4.E6.m1.57.57.57.8.7.7">𝑧</ci><ci id="S4.E6.m1.58.58.58.9.8.8.1.cmml" xref="S4.E6.m1.58.58.58.9.8.8.1">𝑘</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E6.m1.66c">\begin{split}\textbf{Encoder:}&amp;\quad z_{k}=h_{\theta^{h}}(s_{k})\qquad\hskip 2%
1.33955pt\textbf{Latent dynamics:}\quad z_{k+1}=d_{\theta^{d}}(z_{k},a_{k})\\
\textbf{Reward:}&amp;\quad\hat{r}_{k}={\mathcal{R}}_{\theta^{R}}(z_{k},a_{k})%
\qquad\textbf{State-action value:}\quad\hat{Q}_{k}=Q_{\theta^{Q}}(z_{k},a_{k})%
\\
\textbf{Policy:}&amp;\quad\hat{a}_{k}\sim\pi_{\psi}(z_{k})\end{split}</annotation><annotation encoding="application/x-llamapun" id="S4.E6.m1.66d">start_ROW start_CELL Encoder: end_CELL start_CELL italic_z start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT = italic_h start_POSTSUBSCRIPT italic_θ start_POSTSUPERSCRIPT italic_h end_POSTSUPERSCRIPT end_POSTSUBSCRIPT ( italic_s start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ) Latent dynamics: italic_z start_POSTSUBSCRIPT italic_k + 1 end_POSTSUBSCRIPT = italic_d start_POSTSUBSCRIPT italic_θ start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT end_POSTSUBSCRIPT ( italic_z start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT , italic_a start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ) end_CELL end_ROW start_ROW start_CELL Reward: end_CELL start_CELL over^ start_ARG italic_r end_ARG start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT = caligraphic_R start_POSTSUBSCRIPT italic_θ start_POSTSUPERSCRIPT italic_R end_POSTSUPERSCRIPT end_POSTSUBSCRIPT ( italic_z start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT , italic_a start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ) State-action value: over^ start_ARG italic_Q end_ARG start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT = italic_Q start_POSTSUBSCRIPT italic_θ start_POSTSUPERSCRIPT italic_Q end_POSTSUPERSCRIPT end_POSTSUBSCRIPT ( italic_z start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT , italic_a start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ) end_CELL end_ROW start_ROW start_CELL Policy: end_CELL start_CELL over^ start_ARG italic_a end_ARG start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ∼ italic_π start_POSTSUBSCRIPT italic_ψ end_POSTSUBSCRIPT ( italic_z start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ) end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS1.SSS0.Px1.p1.15">When the input <math alttext="s_{k}" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px1.p1.1.m1.1"><semantics id="S4.SS1.SSS0.Px1.p1.1.m1.1a"><msub id="S4.SS1.SSS0.Px1.p1.1.m1.1.1" xref="S4.SS1.SSS0.Px1.p1.1.m1.1.1.cmml"><mi id="S4.SS1.SSS0.Px1.p1.1.m1.1.1.2" xref="S4.SS1.SSS0.Px1.p1.1.m1.1.1.2.cmml">s</mi><mi id="S4.SS1.SSS0.Px1.p1.1.m1.1.1.3" xref="S4.SS1.SSS0.Px1.p1.1.m1.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p1.1.m1.1b"><apply id="S4.SS1.SSS0.Px1.p1.1.m1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px1.p1.1.m1.1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.1.m1.1.1">subscript</csymbol><ci id="S4.SS1.SSS0.Px1.p1.1.m1.1.1.2.cmml" xref="S4.SS1.SSS0.Px1.p1.1.m1.1.1.2">𝑠</ci><ci id="S4.SS1.SSS0.Px1.p1.1.m1.1.1.3.cmml" xref="S4.SS1.SSS0.Px1.p1.1.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p1.1.m1.1c">s_{k}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px1.p1.1.m1.1d">italic_s start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> is a state vector, the encoder is modeled as a multi-layer perceptron (MLP) and as a convolutional neural network (CNN) when <math alttext="s_{k}" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px1.p1.2.m2.1"><semantics id="S4.SS1.SSS0.Px1.p1.2.m2.1a"><msub id="S4.SS1.SSS0.Px1.p1.2.m2.1.1" xref="S4.SS1.SSS0.Px1.p1.2.m2.1.1.cmml"><mi id="S4.SS1.SSS0.Px1.p1.2.m2.1.1.2" xref="S4.SS1.SSS0.Px1.p1.2.m2.1.1.2.cmml">s</mi><mi id="S4.SS1.SSS0.Px1.p1.2.m2.1.1.3" xref="S4.SS1.SSS0.Px1.p1.2.m2.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p1.2.m2.1b"><apply id="S4.SS1.SSS0.Px1.p1.2.m2.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px1.p1.2.m2.1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.2.m2.1.1">subscript</csymbol><ci id="S4.SS1.SSS0.Px1.p1.2.m2.1.1.2.cmml" xref="S4.SS1.SSS0.Px1.p1.2.m2.1.1.2">𝑠</ci><ci id="S4.SS1.SSS0.Px1.p1.2.m2.1.1.3.cmml" xref="S4.SS1.SSS0.Px1.p1.2.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p1.2.m2.1c">s_{k}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px1.p1.2.m2.1d">italic_s start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> is an image.
Given the latent state <math alttext="z_{k}" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px1.p1.3.m3.1"><semantics id="S4.SS1.SSS0.Px1.p1.3.m3.1a"><msub id="S4.SS1.SSS0.Px1.p1.3.m3.1.1" xref="S4.SS1.SSS0.Px1.p1.3.m3.1.1.cmml"><mi id="S4.SS1.SSS0.Px1.p1.3.m3.1.1.2" xref="S4.SS1.SSS0.Px1.p1.3.m3.1.1.2.cmml">z</mi><mi id="S4.SS1.SSS0.Px1.p1.3.m3.1.1.3" xref="S4.SS1.SSS0.Px1.p1.3.m3.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p1.3.m3.1b"><apply id="S4.SS1.SSS0.Px1.p1.3.m3.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px1.p1.3.m3.1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.3.m3.1.1">subscript</csymbol><ci id="S4.SS1.SSS0.Px1.p1.3.m3.1.1.2.cmml" xref="S4.SS1.SSS0.Px1.p1.3.m3.1.1.2">𝑧</ci><ci id="S4.SS1.SSS0.Px1.p1.3.m3.1.1.3.cmml" xref="S4.SS1.SSS0.Px1.p1.3.m3.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p1.3.m3.1c">z_{k}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px1.p1.3.m3.1d">italic_z start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> and action <math alttext="a_{k}" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px1.p1.4.m4.1"><semantics id="S4.SS1.SSS0.Px1.p1.4.m4.1a"><msub id="S4.SS1.SSS0.Px1.p1.4.m4.1.1" xref="S4.SS1.SSS0.Px1.p1.4.m4.1.1.cmml"><mi id="S4.SS1.SSS0.Px1.p1.4.m4.1.1.2" xref="S4.SS1.SSS0.Px1.p1.4.m4.1.1.2.cmml">a</mi><mi id="S4.SS1.SSS0.Px1.p1.4.m4.1.1.3" xref="S4.SS1.SSS0.Px1.p1.4.m4.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p1.4.m4.1b"><apply id="S4.SS1.SSS0.Px1.p1.4.m4.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px1.p1.4.m4.1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.4.m4.1.1">subscript</csymbol><ci id="S4.SS1.SSS0.Px1.p1.4.m4.1.1.2.cmml" xref="S4.SS1.SSS0.Px1.p1.4.m4.1.1.2">𝑎</ci><ci id="S4.SS1.SSS0.Px1.p1.4.m4.1.1.3.cmml" xref="S4.SS1.SSS0.Px1.p1.4.m4.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p1.4.m4.1c">a_{k}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px1.p1.4.m4.1d">italic_a start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math>, we compute the next latent state <math alttext="z_{k+1}" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px1.p1.5.m5.1"><semantics id="S4.SS1.SSS0.Px1.p1.5.m5.1a"><msub id="S4.SS1.SSS0.Px1.p1.5.m5.1.1" xref="S4.SS1.SSS0.Px1.p1.5.m5.1.1.cmml"><mi id="S4.SS1.SSS0.Px1.p1.5.m5.1.1.2" xref="S4.SS1.SSS0.Px1.p1.5.m5.1.1.2.cmml">z</mi><mrow id="S4.SS1.SSS0.Px1.p1.5.m5.1.1.3" xref="S4.SS1.SSS0.Px1.p1.5.m5.1.1.3.cmml"><mi id="S4.SS1.SSS0.Px1.p1.5.m5.1.1.3.2" xref="S4.SS1.SSS0.Px1.p1.5.m5.1.1.3.2.cmml">k</mi><mo id="S4.SS1.SSS0.Px1.p1.5.m5.1.1.3.1" xref="S4.SS1.SSS0.Px1.p1.5.m5.1.1.3.1.cmml">+</mo><mn id="S4.SS1.SSS0.Px1.p1.5.m5.1.1.3.3" xref="S4.SS1.SSS0.Px1.p1.5.m5.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p1.5.m5.1b"><apply id="S4.SS1.SSS0.Px1.p1.5.m5.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px1.p1.5.m5.1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.5.m5.1.1">subscript</csymbol><ci id="S4.SS1.SSS0.Px1.p1.5.m5.1.1.2.cmml" xref="S4.SS1.SSS0.Px1.p1.5.m5.1.1.2">𝑧</ci><apply id="S4.SS1.SSS0.Px1.p1.5.m5.1.1.3.cmml" xref="S4.SS1.SSS0.Px1.p1.5.m5.1.1.3"><plus id="S4.SS1.SSS0.Px1.p1.5.m5.1.1.3.1.cmml" xref="S4.SS1.SSS0.Px1.p1.5.m5.1.1.3.1"></plus><ci id="S4.SS1.SSS0.Px1.p1.5.m5.1.1.3.2.cmml" xref="S4.SS1.SSS0.Px1.p1.5.m5.1.1.3.2">𝑘</ci><cn id="S4.SS1.SSS0.Px1.p1.5.m5.1.1.3.3.cmml" type="integer" xref="S4.SS1.SSS0.Px1.p1.5.m5.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p1.5.m5.1c">z_{k+1}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px1.p1.5.m5.1d">italic_z start_POSTSUBSCRIPT italic_k + 1 end_POSTSUBSCRIPT</annotation></semantics></math> using the latent dynamics model <math alttext="d_{\theta^{d}}(z_{k},a_{k})" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px1.p1.6.m6.2"><semantics id="S4.SS1.SSS0.Px1.p1.6.m6.2a"><mrow id="S4.SS1.SSS0.Px1.p1.6.m6.2.2" xref="S4.SS1.SSS0.Px1.p1.6.m6.2.2.cmml"><msub id="S4.SS1.SSS0.Px1.p1.6.m6.2.2.4" xref="S4.SS1.SSS0.Px1.p1.6.m6.2.2.4.cmml"><mi id="S4.SS1.SSS0.Px1.p1.6.m6.2.2.4.2" xref="S4.SS1.SSS0.Px1.p1.6.m6.2.2.4.2.cmml">d</mi><msup id="S4.SS1.SSS0.Px1.p1.6.m6.2.2.4.3" xref="S4.SS1.SSS0.Px1.p1.6.m6.2.2.4.3.cmml"><mi id="S4.SS1.SSS0.Px1.p1.6.m6.2.2.4.3.2" xref="S4.SS1.SSS0.Px1.p1.6.m6.2.2.4.3.2.cmml">θ</mi><mi id="S4.SS1.SSS0.Px1.p1.6.m6.2.2.4.3.3" xref="S4.SS1.SSS0.Px1.p1.6.m6.2.2.4.3.3.cmml">d</mi></msup></msub><mo id="S4.SS1.SSS0.Px1.p1.6.m6.2.2.3" xref="S4.SS1.SSS0.Px1.p1.6.m6.2.2.3.cmml">⁢</mo><mrow id="S4.SS1.SSS0.Px1.p1.6.m6.2.2.2.2" xref="S4.SS1.SSS0.Px1.p1.6.m6.2.2.2.3.cmml"><mo id="S4.SS1.SSS0.Px1.p1.6.m6.2.2.2.2.3" stretchy="false" xref="S4.SS1.SSS0.Px1.p1.6.m6.2.2.2.3.cmml">(</mo><msub id="S4.SS1.SSS0.Px1.p1.6.m6.1.1.1.1.1" xref="S4.SS1.SSS0.Px1.p1.6.m6.1.1.1.1.1.cmml"><mi id="S4.SS1.SSS0.Px1.p1.6.m6.1.1.1.1.1.2" xref="S4.SS1.SSS0.Px1.p1.6.m6.1.1.1.1.1.2.cmml">z</mi><mi id="S4.SS1.SSS0.Px1.p1.6.m6.1.1.1.1.1.3" xref="S4.SS1.SSS0.Px1.p1.6.m6.1.1.1.1.1.3.cmml">k</mi></msub><mo id="S4.SS1.SSS0.Px1.p1.6.m6.2.2.2.2.4" xref="S4.SS1.SSS0.Px1.p1.6.m6.2.2.2.3.cmml">,</mo><msub id="S4.SS1.SSS0.Px1.p1.6.m6.2.2.2.2.2" xref="S4.SS1.SSS0.Px1.p1.6.m6.2.2.2.2.2.cmml"><mi id="S4.SS1.SSS0.Px1.p1.6.m6.2.2.2.2.2.2" xref="S4.SS1.SSS0.Px1.p1.6.m6.2.2.2.2.2.2.cmml">a</mi><mi id="S4.SS1.SSS0.Px1.p1.6.m6.2.2.2.2.2.3" xref="S4.SS1.SSS0.Px1.p1.6.m6.2.2.2.2.2.3.cmml">k</mi></msub><mo id="S4.SS1.SSS0.Px1.p1.6.m6.2.2.2.2.5" stretchy="false" xref="S4.SS1.SSS0.Px1.p1.6.m6.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p1.6.m6.2b"><apply id="S4.SS1.SSS0.Px1.p1.6.m6.2.2.cmml" xref="S4.SS1.SSS0.Px1.p1.6.m6.2.2"><times id="S4.SS1.SSS0.Px1.p1.6.m6.2.2.3.cmml" xref="S4.SS1.SSS0.Px1.p1.6.m6.2.2.3"></times><apply id="S4.SS1.SSS0.Px1.p1.6.m6.2.2.4.cmml" xref="S4.SS1.SSS0.Px1.p1.6.m6.2.2.4"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px1.p1.6.m6.2.2.4.1.cmml" xref="S4.SS1.SSS0.Px1.p1.6.m6.2.2.4">subscript</csymbol><ci id="S4.SS1.SSS0.Px1.p1.6.m6.2.2.4.2.cmml" xref="S4.SS1.SSS0.Px1.p1.6.m6.2.2.4.2">𝑑</ci><apply id="S4.SS1.SSS0.Px1.p1.6.m6.2.2.4.3.cmml" xref="S4.SS1.SSS0.Px1.p1.6.m6.2.2.4.3"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px1.p1.6.m6.2.2.4.3.1.cmml" xref="S4.SS1.SSS0.Px1.p1.6.m6.2.2.4.3">superscript</csymbol><ci id="S4.SS1.SSS0.Px1.p1.6.m6.2.2.4.3.2.cmml" xref="S4.SS1.SSS0.Px1.p1.6.m6.2.2.4.3.2">𝜃</ci><ci id="S4.SS1.SSS0.Px1.p1.6.m6.2.2.4.3.3.cmml" xref="S4.SS1.SSS0.Px1.p1.6.m6.2.2.4.3.3">𝑑</ci></apply></apply><interval closure="open" id="S4.SS1.SSS0.Px1.p1.6.m6.2.2.2.3.cmml" xref="S4.SS1.SSS0.Px1.p1.6.m6.2.2.2.2"><apply id="S4.SS1.SSS0.Px1.p1.6.m6.1.1.1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.6.m6.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px1.p1.6.m6.1.1.1.1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.6.m6.1.1.1.1.1">subscript</csymbol><ci id="S4.SS1.SSS0.Px1.p1.6.m6.1.1.1.1.1.2.cmml" xref="S4.SS1.SSS0.Px1.p1.6.m6.1.1.1.1.1.2">𝑧</ci><ci id="S4.SS1.SSS0.Px1.p1.6.m6.1.1.1.1.1.3.cmml" xref="S4.SS1.SSS0.Px1.p1.6.m6.1.1.1.1.1.3">𝑘</ci></apply><apply id="S4.SS1.SSS0.Px1.p1.6.m6.2.2.2.2.2.cmml" xref="S4.SS1.SSS0.Px1.p1.6.m6.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px1.p1.6.m6.2.2.2.2.2.1.cmml" xref="S4.SS1.SSS0.Px1.p1.6.m6.2.2.2.2.2">subscript</csymbol><ci id="S4.SS1.SSS0.Px1.p1.6.m6.2.2.2.2.2.2.cmml" xref="S4.SS1.SSS0.Px1.p1.6.m6.2.2.2.2.2.2">𝑎</ci><ci id="S4.SS1.SSS0.Px1.p1.6.m6.2.2.2.2.2.3.cmml" xref="S4.SS1.SSS0.Px1.p1.6.m6.2.2.2.2.2.3">𝑘</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p1.6.m6.2c">d_{\theta^{d}}(z_{k},a_{k})</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px1.p1.6.m6.2d">italic_d start_POSTSUBSCRIPT italic_θ start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT end_POSTSUBSCRIPT ( italic_z start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT , italic_a start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT )</annotation></semantics></math>, parameterized by <math alttext="\theta^{d}" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px1.p1.7.m7.1"><semantics id="S4.SS1.SSS0.Px1.p1.7.m7.1a"><msup id="S4.SS1.SSS0.Px1.p1.7.m7.1.1" xref="S4.SS1.SSS0.Px1.p1.7.m7.1.1.cmml"><mi id="S4.SS1.SSS0.Px1.p1.7.m7.1.1.2" xref="S4.SS1.SSS0.Px1.p1.7.m7.1.1.2.cmml">θ</mi><mi id="S4.SS1.SSS0.Px1.p1.7.m7.1.1.3" xref="S4.SS1.SSS0.Px1.p1.7.m7.1.1.3.cmml">d</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p1.7.m7.1b"><apply id="S4.SS1.SSS0.Px1.p1.7.m7.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px1.p1.7.m7.1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.7.m7.1.1">superscript</csymbol><ci id="S4.SS1.SSS0.Px1.p1.7.m7.1.1.2.cmml" xref="S4.SS1.SSS0.Px1.p1.7.m7.1.1.2">𝜃</ci><ci id="S4.SS1.SSS0.Px1.p1.7.m7.1.1.3.cmml" xref="S4.SS1.SSS0.Px1.p1.7.m7.1.1.3">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p1.7.m7.1c">\theta^{d}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px1.p1.7.m7.1d">italic_θ start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT</annotation></semantics></math>.
In BS-MPC, the latent dynamics are modeled using an MLP.
We also model the latent dynamics model with an MLP. BS-MPC estimates the reward <math alttext="\hat{r}_{k}" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px1.p1.8.m8.1"><semantics id="S4.SS1.SSS0.Px1.p1.8.m8.1a"><msub id="S4.SS1.SSS0.Px1.p1.8.m8.1.1" xref="S4.SS1.SSS0.Px1.p1.8.m8.1.1.cmml"><mover accent="true" id="S4.SS1.SSS0.Px1.p1.8.m8.1.1.2" xref="S4.SS1.SSS0.Px1.p1.8.m8.1.1.2.cmml"><mi id="S4.SS1.SSS0.Px1.p1.8.m8.1.1.2.2" xref="S4.SS1.SSS0.Px1.p1.8.m8.1.1.2.2.cmml">r</mi><mo id="S4.SS1.SSS0.Px1.p1.8.m8.1.1.2.1" xref="S4.SS1.SSS0.Px1.p1.8.m8.1.1.2.1.cmml">^</mo></mover><mi id="S4.SS1.SSS0.Px1.p1.8.m8.1.1.3" xref="S4.SS1.SSS0.Px1.p1.8.m8.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p1.8.m8.1b"><apply id="S4.SS1.SSS0.Px1.p1.8.m8.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px1.p1.8.m8.1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.8.m8.1.1">subscript</csymbol><apply id="S4.SS1.SSS0.Px1.p1.8.m8.1.1.2.cmml" xref="S4.SS1.SSS0.Px1.p1.8.m8.1.1.2"><ci id="S4.SS1.SSS0.Px1.p1.8.m8.1.1.2.1.cmml" xref="S4.SS1.SSS0.Px1.p1.8.m8.1.1.2.1">^</ci><ci id="S4.SS1.SSS0.Px1.p1.8.m8.1.1.2.2.cmml" xref="S4.SS1.SSS0.Px1.p1.8.m8.1.1.2.2">𝑟</ci></apply><ci id="S4.SS1.SSS0.Px1.p1.8.m8.1.1.3.cmml" xref="S4.SS1.SSS0.Px1.p1.8.m8.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p1.8.m8.1c">\hat{r}_{k}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px1.p1.8.m8.1d">over^ start_ARG italic_r end_ARG start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> and state-action value <math alttext="\hat{Q}_{k}" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px1.p1.9.m9.1"><semantics id="S4.SS1.SSS0.Px1.p1.9.m9.1a"><msub id="S4.SS1.SSS0.Px1.p1.9.m9.1.1" xref="S4.SS1.SSS0.Px1.p1.9.m9.1.1.cmml"><mover accent="true" id="S4.SS1.SSS0.Px1.p1.9.m9.1.1.2" xref="S4.SS1.SSS0.Px1.p1.9.m9.1.1.2.cmml"><mi id="S4.SS1.SSS0.Px1.p1.9.m9.1.1.2.2" xref="S4.SS1.SSS0.Px1.p1.9.m9.1.1.2.2.cmml">Q</mi><mo id="S4.SS1.SSS0.Px1.p1.9.m9.1.1.2.1" xref="S4.SS1.SSS0.Px1.p1.9.m9.1.1.2.1.cmml">^</mo></mover><mi id="S4.SS1.SSS0.Px1.p1.9.m9.1.1.3" xref="S4.SS1.SSS0.Px1.p1.9.m9.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p1.9.m9.1b"><apply id="S4.SS1.SSS0.Px1.p1.9.m9.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.9.m9.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px1.p1.9.m9.1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.9.m9.1.1">subscript</csymbol><apply id="S4.SS1.SSS0.Px1.p1.9.m9.1.1.2.cmml" xref="S4.SS1.SSS0.Px1.p1.9.m9.1.1.2"><ci id="S4.SS1.SSS0.Px1.p1.9.m9.1.1.2.1.cmml" xref="S4.SS1.SSS0.Px1.p1.9.m9.1.1.2.1">^</ci><ci id="S4.SS1.SSS0.Px1.p1.9.m9.1.1.2.2.cmml" xref="S4.SS1.SSS0.Px1.p1.9.m9.1.1.2.2">𝑄</ci></apply><ci id="S4.SS1.SSS0.Px1.p1.9.m9.1.1.3.cmml" xref="S4.SS1.SSS0.Px1.p1.9.m9.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p1.9.m9.1c">\hat{Q}_{k}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px1.p1.9.m9.1d">over^ start_ARG italic_Q end_ARG start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> based on <math alttext="z_{k}" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px1.p1.10.m10.1"><semantics id="S4.SS1.SSS0.Px1.p1.10.m10.1a"><msub id="S4.SS1.SSS0.Px1.p1.10.m10.1.1" xref="S4.SS1.SSS0.Px1.p1.10.m10.1.1.cmml"><mi id="S4.SS1.SSS0.Px1.p1.10.m10.1.1.2" xref="S4.SS1.SSS0.Px1.p1.10.m10.1.1.2.cmml">z</mi><mi id="S4.SS1.SSS0.Px1.p1.10.m10.1.1.3" xref="S4.SS1.SSS0.Px1.p1.10.m10.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p1.10.m10.1b"><apply id="S4.SS1.SSS0.Px1.p1.10.m10.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.10.m10.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px1.p1.10.m10.1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.10.m10.1.1">subscript</csymbol><ci id="S4.SS1.SSS0.Px1.p1.10.m10.1.1.2.cmml" xref="S4.SS1.SSS0.Px1.p1.10.m10.1.1.2">𝑧</ci><ci id="S4.SS1.SSS0.Px1.p1.10.m10.1.1.3.cmml" xref="S4.SS1.SSS0.Px1.p1.10.m10.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p1.10.m10.1c">z_{k}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px1.p1.10.m10.1d">italic_z start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="a_{k}" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px1.p1.11.m11.1"><semantics id="S4.SS1.SSS0.Px1.p1.11.m11.1a"><msub id="S4.SS1.SSS0.Px1.p1.11.m11.1.1" xref="S4.SS1.SSS0.Px1.p1.11.m11.1.1.cmml"><mi id="S4.SS1.SSS0.Px1.p1.11.m11.1.1.2" xref="S4.SS1.SSS0.Px1.p1.11.m11.1.1.2.cmml">a</mi><mi id="S4.SS1.SSS0.Px1.p1.11.m11.1.1.3" xref="S4.SS1.SSS0.Px1.p1.11.m11.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p1.11.m11.1b"><apply id="S4.SS1.SSS0.Px1.p1.11.m11.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.11.m11.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px1.p1.11.m11.1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.11.m11.1.1">subscript</csymbol><ci id="S4.SS1.SSS0.Px1.p1.11.m11.1.1.2.cmml" xref="S4.SS1.SSS0.Px1.p1.11.m11.1.1.2">𝑎</ci><ci id="S4.SS1.SSS0.Px1.p1.11.m11.1.1.3.cmml" xref="S4.SS1.SSS0.Px1.p1.11.m11.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p1.11.m11.1c">a_{k}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px1.p1.11.m11.1d">italic_a start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math>, modeling both <math alttext="{\mathcal{R}}_{\theta^{\mathcal{R}}}" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px1.p1.12.m12.1"><semantics id="S4.SS1.SSS0.Px1.p1.12.m12.1a"><msub id="S4.SS1.SSS0.Px1.p1.12.m12.1.1" xref="S4.SS1.SSS0.Px1.p1.12.m12.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.SSS0.Px1.p1.12.m12.1.1.2" xref="S4.SS1.SSS0.Px1.p1.12.m12.1.1.2.cmml">ℛ</mi><msup id="S4.SS1.SSS0.Px1.p1.12.m12.1.1.3" xref="S4.SS1.SSS0.Px1.p1.12.m12.1.1.3.cmml"><mi id="S4.SS1.SSS0.Px1.p1.12.m12.1.1.3.2" xref="S4.SS1.SSS0.Px1.p1.12.m12.1.1.3.2.cmml">θ</mi><mi class="ltx_font_mathcaligraphic" id="S4.SS1.SSS0.Px1.p1.12.m12.1.1.3.3" xref="S4.SS1.SSS0.Px1.p1.12.m12.1.1.3.3.cmml">ℛ</mi></msup></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p1.12.m12.1b"><apply id="S4.SS1.SSS0.Px1.p1.12.m12.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.12.m12.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px1.p1.12.m12.1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.12.m12.1.1">subscript</csymbol><ci id="S4.SS1.SSS0.Px1.p1.12.m12.1.1.2.cmml" xref="S4.SS1.SSS0.Px1.p1.12.m12.1.1.2">ℛ</ci><apply id="S4.SS1.SSS0.Px1.p1.12.m12.1.1.3.cmml" xref="S4.SS1.SSS0.Px1.p1.12.m12.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px1.p1.12.m12.1.1.3.1.cmml" xref="S4.SS1.SSS0.Px1.p1.12.m12.1.1.3">superscript</csymbol><ci id="S4.SS1.SSS0.Px1.p1.12.m12.1.1.3.2.cmml" xref="S4.SS1.SSS0.Px1.p1.12.m12.1.1.3.2">𝜃</ci><ci id="S4.SS1.SSS0.Px1.p1.12.m12.1.1.3.3.cmml" xref="S4.SS1.SSS0.Px1.p1.12.m12.1.1.3.3">ℛ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p1.12.m12.1c">{\mathcal{R}}_{\theta^{\mathcal{R}}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px1.p1.12.m12.1d">caligraphic_R start_POSTSUBSCRIPT italic_θ start_POSTSUPERSCRIPT caligraphic_R end_POSTSUPERSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="Q_{\theta^{Q}}" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px1.p1.13.m13.1"><semantics id="S4.SS1.SSS0.Px1.p1.13.m13.1a"><msub id="S4.SS1.SSS0.Px1.p1.13.m13.1.1" xref="S4.SS1.SSS0.Px1.p1.13.m13.1.1.cmml"><mi id="S4.SS1.SSS0.Px1.p1.13.m13.1.1.2" xref="S4.SS1.SSS0.Px1.p1.13.m13.1.1.2.cmml">Q</mi><msup id="S4.SS1.SSS0.Px1.p1.13.m13.1.1.3" xref="S4.SS1.SSS0.Px1.p1.13.m13.1.1.3.cmml"><mi id="S4.SS1.SSS0.Px1.p1.13.m13.1.1.3.2" xref="S4.SS1.SSS0.Px1.p1.13.m13.1.1.3.2.cmml">θ</mi><mi id="S4.SS1.SSS0.Px1.p1.13.m13.1.1.3.3" xref="S4.SS1.SSS0.Px1.p1.13.m13.1.1.3.3.cmml">Q</mi></msup></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p1.13.m13.1b"><apply id="S4.SS1.SSS0.Px1.p1.13.m13.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.13.m13.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px1.p1.13.m13.1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.13.m13.1.1">subscript</csymbol><ci id="S4.SS1.SSS0.Px1.p1.13.m13.1.1.2.cmml" xref="S4.SS1.SSS0.Px1.p1.13.m13.1.1.2">𝑄</ci><apply id="S4.SS1.SSS0.Px1.p1.13.m13.1.1.3.cmml" xref="S4.SS1.SSS0.Px1.p1.13.m13.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px1.p1.13.m13.1.1.3.1.cmml" xref="S4.SS1.SSS0.Px1.p1.13.m13.1.1.3">superscript</csymbol><ci id="S4.SS1.SSS0.Px1.p1.13.m13.1.1.3.2.cmml" xref="S4.SS1.SSS0.Px1.p1.13.m13.1.1.3.2">𝜃</ci><ci id="S4.SS1.SSS0.Px1.p1.13.m13.1.1.3.3.cmml" xref="S4.SS1.SSS0.Px1.p1.13.m13.1.1.3.3">𝑄</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p1.13.m13.1c">Q_{\theta^{Q}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px1.p1.13.m13.1d">italic_Q start_POSTSUBSCRIPT italic_θ start_POSTSUPERSCRIPT italic_Q end_POSTSUPERSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math> with MLPs. Finally, we train a policy that outputs the estimated optimal action <math alttext="\hat{a}_{k}" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px1.p1.14.m14.1"><semantics id="S4.SS1.SSS0.Px1.p1.14.m14.1a"><msub id="S4.SS1.SSS0.Px1.p1.14.m14.1.1" xref="S4.SS1.SSS0.Px1.p1.14.m14.1.1.cmml"><mover accent="true" id="S4.SS1.SSS0.Px1.p1.14.m14.1.1.2" xref="S4.SS1.SSS0.Px1.p1.14.m14.1.1.2.cmml"><mi id="S4.SS1.SSS0.Px1.p1.14.m14.1.1.2.2" xref="S4.SS1.SSS0.Px1.p1.14.m14.1.1.2.2.cmml">a</mi><mo id="S4.SS1.SSS0.Px1.p1.14.m14.1.1.2.1" xref="S4.SS1.SSS0.Px1.p1.14.m14.1.1.2.1.cmml">^</mo></mover><mi id="S4.SS1.SSS0.Px1.p1.14.m14.1.1.3" xref="S4.SS1.SSS0.Px1.p1.14.m14.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p1.14.m14.1b"><apply id="S4.SS1.SSS0.Px1.p1.14.m14.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.14.m14.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px1.p1.14.m14.1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.14.m14.1.1">subscript</csymbol><apply id="S4.SS1.SSS0.Px1.p1.14.m14.1.1.2.cmml" xref="S4.SS1.SSS0.Px1.p1.14.m14.1.1.2"><ci id="S4.SS1.SSS0.Px1.p1.14.m14.1.1.2.1.cmml" xref="S4.SS1.SSS0.Px1.p1.14.m14.1.1.2.1">^</ci><ci id="S4.SS1.SSS0.Px1.p1.14.m14.1.1.2.2.cmml" xref="S4.SS1.SSS0.Px1.p1.14.m14.1.1.2.2">𝑎</ci></apply><ci id="S4.SS1.SSS0.Px1.p1.14.m14.1.1.3.cmml" xref="S4.SS1.SSS0.Px1.p1.14.m14.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p1.14.m14.1c">\hat{a}_{k}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px1.p1.14.m14.1d">over^ start_ARG italic_a end_ARG start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> given <math alttext="z_{k}" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px1.p1.15.m15.1"><semantics id="S4.SS1.SSS0.Px1.p1.15.m15.1a"><msub id="S4.SS1.SSS0.Px1.p1.15.m15.1.1" xref="S4.SS1.SSS0.Px1.p1.15.m15.1.1.cmml"><mi id="S4.SS1.SSS0.Px1.p1.15.m15.1.1.2" xref="S4.SS1.SSS0.Px1.p1.15.m15.1.1.2.cmml">z</mi><mi id="S4.SS1.SSS0.Px1.p1.15.m15.1.1.3" xref="S4.SS1.SSS0.Px1.p1.15.m15.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p1.15.m15.1b"><apply id="S4.SS1.SSS0.Px1.p1.15.m15.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.15.m15.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px1.p1.15.m15.1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.15.m15.1.1">subscript</csymbol><ci id="S4.SS1.SSS0.Px1.p1.15.m15.1.1.2.cmml" xref="S4.SS1.SSS0.Px1.p1.15.m15.1.1.2">𝑧</ci><ci id="S4.SS1.SSS0.Px1.p1.15.m15.1.1.3.cmml" xref="S4.SS1.SSS0.Px1.p1.15.m15.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p1.15.m15.1c">z_{k}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px1.p1.15.m15.1d">italic_z start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math>; the policy is also parameterized as an MLP.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS1.SSS0.Px1.p2">
<p class="ltx_p" id="S4.SS1.SSS0.Px1.p2.6">At each time step <math alttext="k" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px1.p2.1.m1.1"><semantics id="S4.SS1.SSS0.Px1.p2.1.m1.1a"><mi id="S4.SS1.SSS0.Px1.p2.1.m1.1.1" xref="S4.SS1.SSS0.Px1.p2.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p2.1.m1.1b"><ci id="S4.SS1.SSS0.Px1.p2.1.m1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p2.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p2.1.m1.1c">k</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px1.p2.1.m1.1d">italic_k</annotation></semantics></math>, the original observation <math alttext="s_{k}" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px1.p2.2.m2.1"><semantics id="S4.SS1.SSS0.Px1.p2.2.m2.1a"><msub id="S4.SS1.SSS0.Px1.p2.2.m2.1.1" xref="S4.SS1.SSS0.Px1.p2.2.m2.1.1.cmml"><mi id="S4.SS1.SSS0.Px1.p2.2.m2.1.1.2" xref="S4.SS1.SSS0.Px1.p2.2.m2.1.1.2.cmml">s</mi><mi id="S4.SS1.SSS0.Px1.p2.2.m2.1.1.3" xref="S4.SS1.SSS0.Px1.p2.2.m2.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p2.2.m2.1b"><apply id="S4.SS1.SSS0.Px1.p2.2.m2.1.1.cmml" xref="S4.SS1.SSS0.Px1.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px1.p2.2.m2.1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p2.2.m2.1.1">subscript</csymbol><ci id="S4.SS1.SSS0.Px1.p2.2.m2.1.1.2.cmml" xref="S4.SS1.SSS0.Px1.p2.2.m2.1.1.2">𝑠</ci><ci id="S4.SS1.SSS0.Px1.p2.2.m2.1.1.3.cmml" xref="S4.SS1.SSS0.Px1.p2.2.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p2.2.m2.1c">s_{k}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px1.p2.2.m2.1d">italic_s start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> is encoded into the latent state <math alttext="z_{k}" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px1.p2.3.m3.1"><semantics id="S4.SS1.SSS0.Px1.p2.3.m3.1a"><msub id="S4.SS1.SSS0.Px1.p2.3.m3.1.1" xref="S4.SS1.SSS0.Px1.p2.3.m3.1.1.cmml"><mi id="S4.SS1.SSS0.Px1.p2.3.m3.1.1.2" xref="S4.SS1.SSS0.Px1.p2.3.m3.1.1.2.cmml">z</mi><mi id="S4.SS1.SSS0.Px1.p2.3.m3.1.1.3" xref="S4.SS1.SSS0.Px1.p2.3.m3.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p2.3.m3.1b"><apply id="S4.SS1.SSS0.Px1.p2.3.m3.1.1.cmml" xref="S4.SS1.SSS0.Px1.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px1.p2.3.m3.1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p2.3.m3.1.1">subscript</csymbol><ci id="S4.SS1.SSS0.Px1.p2.3.m3.1.1.2.cmml" xref="S4.SS1.SSS0.Px1.p2.3.m3.1.1.2">𝑧</ci><ci id="S4.SS1.SSS0.Px1.p2.3.m3.1.1.3.cmml" xref="S4.SS1.SSS0.Px1.p2.3.m3.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p2.3.m3.1c">z_{k}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px1.p2.3.m3.1d">italic_z start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math>. Using <math alttext="z_{k}" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px1.p2.4.m4.1"><semantics id="S4.SS1.SSS0.Px1.p2.4.m4.1a"><msub id="S4.SS1.SSS0.Px1.p2.4.m4.1.1" xref="S4.SS1.SSS0.Px1.p2.4.m4.1.1.cmml"><mi id="S4.SS1.SSS0.Px1.p2.4.m4.1.1.2" xref="S4.SS1.SSS0.Px1.p2.4.m4.1.1.2.cmml">z</mi><mi id="S4.SS1.SSS0.Px1.p2.4.m4.1.1.3" xref="S4.SS1.SSS0.Px1.p2.4.m4.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p2.4.m4.1b"><apply id="S4.SS1.SSS0.Px1.p2.4.m4.1.1.cmml" xref="S4.SS1.SSS0.Px1.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px1.p2.4.m4.1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p2.4.m4.1.1">subscript</csymbol><ci id="S4.SS1.SSS0.Px1.p2.4.m4.1.1.2.cmml" xref="S4.SS1.SSS0.Px1.p2.4.m4.1.1.2">𝑧</ci><ci id="S4.SS1.SSS0.Px1.p2.4.m4.1.1.3.cmml" xref="S4.SS1.SSS0.Px1.p2.4.m4.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p2.4.m4.1c">z_{k}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px1.p2.4.m4.1d">italic_z start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> and the action <math alttext="a_{k}" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px1.p2.5.m5.1"><semantics id="S4.SS1.SSS0.Px1.p2.5.m5.1a"><msub id="S4.SS1.SSS0.Px1.p2.5.m5.1.1" xref="S4.SS1.SSS0.Px1.p2.5.m5.1.1.cmml"><mi id="S4.SS1.SSS0.Px1.p2.5.m5.1.1.2" xref="S4.SS1.SSS0.Px1.p2.5.m5.1.1.2.cmml">a</mi><mi id="S4.SS1.SSS0.Px1.p2.5.m5.1.1.3" xref="S4.SS1.SSS0.Px1.p2.5.m5.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p2.5.m5.1b"><apply id="S4.SS1.SSS0.Px1.p2.5.m5.1.1.cmml" xref="S4.SS1.SSS0.Px1.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px1.p2.5.m5.1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p2.5.m5.1.1">subscript</csymbol><ci id="S4.SS1.SSS0.Px1.p2.5.m5.1.1.2.cmml" xref="S4.SS1.SSS0.Px1.p2.5.m5.1.1.2">𝑎</ci><ci id="S4.SS1.SSS0.Px1.p2.5.m5.1.1.3.cmml" xref="S4.SS1.SSS0.Px1.p2.5.m5.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p2.5.m5.1c">a_{k}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px1.p2.5.m5.1d">italic_a start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math>, we compute the rewards, state-action values, and the next latent state. As highlighted in prior work, these values are computed in the latent space rather than the original observation space, as the latent state <math alttext="z_{k}" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px1.p2.6.m6.1"><semantics id="S4.SS1.SSS0.Px1.p2.6.m6.1a"><msub id="S4.SS1.SSS0.Px1.p2.6.m6.1.1" xref="S4.SS1.SSS0.Px1.p2.6.m6.1.1.cmml"><mi id="S4.SS1.SSS0.Px1.p2.6.m6.1.1.2" xref="S4.SS1.SSS0.Px1.p2.6.m6.1.1.2.cmml">z</mi><mi id="S4.SS1.SSS0.Px1.p2.6.m6.1.1.3" xref="S4.SS1.SSS0.Px1.p2.6.m6.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p2.6.m6.1b"><apply id="S4.SS1.SSS0.Px1.p2.6.m6.1.1.cmml" xref="S4.SS1.SSS0.Px1.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px1.p2.6.m6.1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p2.6.m6.1.1">subscript</csymbol><ci id="S4.SS1.SSS0.Px1.p2.6.m6.1.1.2.cmml" xref="S4.SS1.SSS0.Px1.p2.6.m6.1.1.2">𝑧</ci><ci id="S4.SS1.SSS0.Px1.p2.6.m6.1.1.3.cmml" xref="S4.SS1.SSS0.Px1.p2.6.m6.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p2.6.m6.1c">z_{k}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px1.p2.6.m6.1d">italic_z start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> captures the essential information from the high-dimensional original state. Since the latent space typically has more compact dimensions, this approach is commonly used in image-based tasks where input images are high-dimensional. However, state-based tasks, despite being represented more compactly, also benefit from this structure by utilizing latent states learned through temporal consistency <cite class="ltx_cite ltx_citemacro_citep">(Zhao et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#bib.bib48" title="">2023</a>)</cite>.</p>
</div>
</section>
<section class="ltx_paragraph" id="S4.SS1.SSS0.Px2">
<h4 class="ltx_title ltx_title_paragraph">Objective function</h4>
<div class="ltx_para ltx_noindent" id="S4.SS1.SSS0.Px2.p1">
<p class="ltx_p" id="S4.SS1.SSS0.Px2.p1.12">We jointly train the encoder, latent dynamics model, reward model, and state-action value model. BS-MPC minimizes the following loss function:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E7">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\theta^{*}=\arg\min_{\theta}{\mathcal{L}}(\theta)=\arg\min_{\theta}\;\mathbb{E%
}_{(s,a,r,s^{\prime})\sim\mathcal{{\mathcal{B}}}}\left[\sum_{k=0}^{H}\lambda^{%
k}{\mathcal{L}}_{k}(\theta)\right]" class="ltx_Math" display="block" id="S4.E7.m1.7"><semantics id="S4.E7.m1.7a"><mrow id="S4.E7.m1.7.7" xref="S4.E7.m1.7.7.cmml"><msup id="S4.E7.m1.7.7.3" xref="S4.E7.m1.7.7.3.cmml"><mi id="S4.E7.m1.7.7.3.2" xref="S4.E7.m1.7.7.3.2.cmml">θ</mi><mo id="S4.E7.m1.7.7.3.3" xref="S4.E7.m1.7.7.3.3.cmml">∗</mo></msup><mo id="S4.E7.m1.7.7.4" xref="S4.E7.m1.7.7.4.cmml">=</mo><mrow id="S4.E7.m1.7.7.5" xref="S4.E7.m1.7.7.5.cmml"><mrow id="S4.E7.m1.7.7.5.2" xref="S4.E7.m1.7.7.5.2.cmml"><mi id="S4.E7.m1.7.7.5.2.1" xref="S4.E7.m1.7.7.5.2.1.cmml">arg</mi><mo id="S4.E7.m1.7.7.5.2a" lspace="0.167em" xref="S4.E7.m1.7.7.5.2.cmml">⁡</mo><mrow id="S4.E7.m1.7.7.5.2.2" xref="S4.E7.m1.7.7.5.2.2.cmml"><munder id="S4.E7.m1.7.7.5.2.2.1" xref="S4.E7.m1.7.7.5.2.2.1.cmml"><mi id="S4.E7.m1.7.7.5.2.2.1.2" xref="S4.E7.m1.7.7.5.2.2.1.2.cmml">min</mi><mi id="S4.E7.m1.7.7.5.2.2.1.3" xref="S4.E7.m1.7.7.5.2.2.1.3.cmml">θ</mi></munder><mo id="S4.E7.m1.7.7.5.2.2a" lspace="0.167em" xref="S4.E7.m1.7.7.5.2.2.cmml">⁡</mo><mi class="ltx_font_mathcaligraphic" id="S4.E7.m1.7.7.5.2.2.2" xref="S4.E7.m1.7.7.5.2.2.2.cmml">ℒ</mi></mrow></mrow><mo id="S4.E7.m1.7.7.5.1" xref="S4.E7.m1.7.7.5.1.cmml">⁢</mo><mrow id="S4.E7.m1.7.7.5.3.2" xref="S4.E7.m1.7.7.5.cmml"><mo id="S4.E7.m1.7.7.5.3.2.1" stretchy="false" xref="S4.E7.m1.7.7.5.cmml">(</mo><mi id="S4.E7.m1.5.5" xref="S4.E7.m1.5.5.cmml">θ</mi><mo id="S4.E7.m1.7.7.5.3.2.2" stretchy="false" xref="S4.E7.m1.7.7.5.cmml">)</mo></mrow></mrow><mo id="S4.E7.m1.7.7.6" xref="S4.E7.m1.7.7.6.cmml">=</mo><mrow id="S4.E7.m1.7.7.1" xref="S4.E7.m1.7.7.1.cmml"><mrow id="S4.E7.m1.7.7.1.3" xref="S4.E7.m1.7.7.1.3.cmml"><mi id="S4.E7.m1.7.7.1.3.1" xref="S4.E7.m1.7.7.1.3.1.cmml">arg</mi><mo id="S4.E7.m1.7.7.1.3a" lspace="0.167em" xref="S4.E7.m1.7.7.1.3.cmml">⁡</mo><mrow id="S4.E7.m1.7.7.1.3.2" xref="S4.E7.m1.7.7.1.3.2.cmml"><munder id="S4.E7.m1.7.7.1.3.2.1" xref="S4.E7.m1.7.7.1.3.2.1.cmml"><mi id="S4.E7.m1.7.7.1.3.2.1.2" xref="S4.E7.m1.7.7.1.3.2.1.2.cmml">min</mi><mi id="S4.E7.m1.7.7.1.3.2.1.3" xref="S4.E7.m1.7.7.1.3.2.1.3.cmml">θ</mi></munder><mo id="S4.E7.m1.7.7.1.3.2a" lspace="0.167em" xref="S4.E7.m1.7.7.1.3.2.cmml">⁡</mo><msub id="S4.E7.m1.7.7.1.3.2.2" xref="S4.E7.m1.7.7.1.3.2.2.cmml"><mi id="S4.E7.m1.7.7.1.3.2.2.2" xref="S4.E7.m1.7.7.1.3.2.2.2.cmml">𝔼</mi><mrow id="S4.E7.m1.4.4.4" xref="S4.E7.m1.4.4.4.cmml"><mrow id="S4.E7.m1.4.4.4.4.1" xref="S4.E7.m1.4.4.4.4.2.cmml"><mo id="S4.E7.m1.4.4.4.4.1.2" stretchy="false" xref="S4.E7.m1.4.4.4.4.2.cmml">(</mo><mi id="S4.E7.m1.1.1.1.1" xref="S4.E7.m1.1.1.1.1.cmml">s</mi><mo id="S4.E7.m1.4.4.4.4.1.3" xref="S4.E7.m1.4.4.4.4.2.cmml">,</mo><mi id="S4.E7.m1.2.2.2.2" xref="S4.E7.m1.2.2.2.2.cmml">a</mi><mo id="S4.E7.m1.4.4.4.4.1.4" xref="S4.E7.m1.4.4.4.4.2.cmml">,</mo><mi id="S4.E7.m1.3.3.3.3" xref="S4.E7.m1.3.3.3.3.cmml">r</mi><mo id="S4.E7.m1.4.4.4.4.1.5" xref="S4.E7.m1.4.4.4.4.2.cmml">,</mo><msup id="S4.E7.m1.4.4.4.4.1.1" xref="S4.E7.m1.4.4.4.4.1.1.cmml"><mi id="S4.E7.m1.4.4.4.4.1.1.2" xref="S4.E7.m1.4.4.4.4.1.1.2.cmml">s</mi><mo id="S4.E7.m1.4.4.4.4.1.1.3" xref="S4.E7.m1.4.4.4.4.1.1.3.cmml">′</mo></msup><mo id="S4.E7.m1.4.4.4.4.1.6" stretchy="false" xref="S4.E7.m1.4.4.4.4.2.cmml">)</mo></mrow><mo id="S4.E7.m1.4.4.4.5" xref="S4.E7.m1.4.4.4.5.cmml">∼</mo><mi class="ltx_font_mathcaligraphic" id="S4.E7.m1.4.4.4.6" xref="S4.E7.m1.4.4.4.6.cmml">ℬ</mi></mrow></msub></mrow></mrow><mo id="S4.E7.m1.7.7.1.2" xref="S4.E7.m1.7.7.1.2.cmml">⁢</mo><mrow id="S4.E7.m1.7.7.1.1.1" xref="S4.E7.m1.7.7.1.1.2.cmml"><mo id="S4.E7.m1.7.7.1.1.1.2" xref="S4.E7.m1.7.7.1.1.2.1.cmml">[</mo><mrow id="S4.E7.m1.7.7.1.1.1.1" xref="S4.E7.m1.7.7.1.1.1.1.cmml"><munderover id="S4.E7.m1.7.7.1.1.1.1.1" xref="S4.E7.m1.7.7.1.1.1.1.1.cmml"><mo id="S4.E7.m1.7.7.1.1.1.1.1.2.2" lspace="0em" movablelimits="false" xref="S4.E7.m1.7.7.1.1.1.1.1.2.2.cmml">∑</mo><mrow id="S4.E7.m1.7.7.1.1.1.1.1.2.3" xref="S4.E7.m1.7.7.1.1.1.1.1.2.3.cmml"><mi id="S4.E7.m1.7.7.1.1.1.1.1.2.3.2" xref="S4.E7.m1.7.7.1.1.1.1.1.2.3.2.cmml">k</mi><mo id="S4.E7.m1.7.7.1.1.1.1.1.2.3.1" xref="S4.E7.m1.7.7.1.1.1.1.1.2.3.1.cmml">=</mo><mn id="S4.E7.m1.7.7.1.1.1.1.1.2.3.3" xref="S4.E7.m1.7.7.1.1.1.1.1.2.3.3.cmml">0</mn></mrow><mi id="S4.E7.m1.7.7.1.1.1.1.1.3" xref="S4.E7.m1.7.7.1.1.1.1.1.3.cmml">H</mi></munderover><mrow id="S4.E7.m1.7.7.1.1.1.1.2" xref="S4.E7.m1.7.7.1.1.1.1.2.cmml"><msup id="S4.E7.m1.7.7.1.1.1.1.2.2" xref="S4.E7.m1.7.7.1.1.1.1.2.2.cmml"><mi id="S4.E7.m1.7.7.1.1.1.1.2.2.2" xref="S4.E7.m1.7.7.1.1.1.1.2.2.2.cmml">λ</mi><mi id="S4.E7.m1.7.7.1.1.1.1.2.2.3" xref="S4.E7.m1.7.7.1.1.1.1.2.2.3.cmml">k</mi></msup><mo id="S4.E7.m1.7.7.1.1.1.1.2.1" xref="S4.E7.m1.7.7.1.1.1.1.2.1.cmml">⁢</mo><msub id="S4.E7.m1.7.7.1.1.1.1.2.3" xref="S4.E7.m1.7.7.1.1.1.1.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E7.m1.7.7.1.1.1.1.2.3.2" xref="S4.E7.m1.7.7.1.1.1.1.2.3.2.cmml">ℒ</mi><mi id="S4.E7.m1.7.7.1.1.1.1.2.3.3" xref="S4.E7.m1.7.7.1.1.1.1.2.3.3.cmml">k</mi></msub><mo id="S4.E7.m1.7.7.1.1.1.1.2.1a" xref="S4.E7.m1.7.7.1.1.1.1.2.1.cmml">⁢</mo><mrow id="S4.E7.m1.7.7.1.1.1.1.2.4.2" xref="S4.E7.m1.7.7.1.1.1.1.2.cmml"><mo id="S4.E7.m1.7.7.1.1.1.1.2.4.2.1" stretchy="false" xref="S4.E7.m1.7.7.1.1.1.1.2.cmml">(</mo><mi id="S4.E7.m1.6.6" xref="S4.E7.m1.6.6.cmml">θ</mi><mo id="S4.E7.m1.7.7.1.1.1.1.2.4.2.2" stretchy="false" xref="S4.E7.m1.7.7.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E7.m1.7.7.1.1.1.3" xref="S4.E7.m1.7.7.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E7.m1.7b"><apply id="S4.E7.m1.7.7.cmml" xref="S4.E7.m1.7.7"><and id="S4.E7.m1.7.7a.cmml" xref="S4.E7.m1.7.7"></and><apply id="S4.E7.m1.7.7b.cmml" xref="S4.E7.m1.7.7"><eq id="S4.E7.m1.7.7.4.cmml" xref="S4.E7.m1.7.7.4"></eq><apply id="S4.E7.m1.7.7.3.cmml" xref="S4.E7.m1.7.7.3"><csymbol cd="ambiguous" id="S4.E7.m1.7.7.3.1.cmml" xref="S4.E7.m1.7.7.3">superscript</csymbol><ci id="S4.E7.m1.7.7.3.2.cmml" xref="S4.E7.m1.7.7.3.2">𝜃</ci><times id="S4.E7.m1.7.7.3.3.cmml" xref="S4.E7.m1.7.7.3.3"></times></apply><apply id="S4.E7.m1.7.7.5.cmml" xref="S4.E7.m1.7.7.5"><times id="S4.E7.m1.7.7.5.1.cmml" xref="S4.E7.m1.7.7.5.1"></times><apply id="S4.E7.m1.7.7.5.2.cmml" xref="S4.E7.m1.7.7.5.2"><arg id="S4.E7.m1.7.7.5.2.1.cmml" xref="S4.E7.m1.7.7.5.2.1"></arg><apply id="S4.E7.m1.7.7.5.2.2.cmml" xref="S4.E7.m1.7.7.5.2.2"><apply id="S4.E7.m1.7.7.5.2.2.1.cmml" xref="S4.E7.m1.7.7.5.2.2.1"><csymbol cd="ambiguous" id="S4.E7.m1.7.7.5.2.2.1.1.cmml" xref="S4.E7.m1.7.7.5.2.2.1">subscript</csymbol><min id="S4.E7.m1.7.7.5.2.2.1.2.cmml" xref="S4.E7.m1.7.7.5.2.2.1.2"></min><ci id="S4.E7.m1.7.7.5.2.2.1.3.cmml" xref="S4.E7.m1.7.7.5.2.2.1.3">𝜃</ci></apply><ci id="S4.E7.m1.7.7.5.2.2.2.cmml" xref="S4.E7.m1.7.7.5.2.2.2">ℒ</ci></apply></apply><ci id="S4.E7.m1.5.5.cmml" xref="S4.E7.m1.5.5">𝜃</ci></apply></apply><apply id="S4.E7.m1.7.7c.cmml" xref="S4.E7.m1.7.7"><eq id="S4.E7.m1.7.7.6.cmml" xref="S4.E7.m1.7.7.6"></eq><share href="https://arxiv.org/html/2410.04553v1#S4.E7.m1.7.7.5.cmml" id="S4.E7.m1.7.7d.cmml" xref="S4.E7.m1.7.7"></share><apply id="S4.E7.m1.7.7.1.cmml" xref="S4.E7.m1.7.7.1"><times id="S4.E7.m1.7.7.1.2.cmml" xref="S4.E7.m1.7.7.1.2"></times><apply id="S4.E7.m1.7.7.1.3.cmml" xref="S4.E7.m1.7.7.1.3"><arg id="S4.E7.m1.7.7.1.3.1.cmml" xref="S4.E7.m1.7.7.1.3.1"></arg><apply id="S4.E7.m1.7.7.1.3.2.cmml" xref="S4.E7.m1.7.7.1.3.2"><apply id="S4.E7.m1.7.7.1.3.2.1.cmml" xref="S4.E7.m1.7.7.1.3.2.1"><csymbol cd="ambiguous" id="S4.E7.m1.7.7.1.3.2.1.1.cmml" xref="S4.E7.m1.7.7.1.3.2.1">subscript</csymbol><min id="S4.E7.m1.7.7.1.3.2.1.2.cmml" xref="S4.E7.m1.7.7.1.3.2.1.2"></min><ci id="S4.E7.m1.7.7.1.3.2.1.3.cmml" xref="S4.E7.m1.7.7.1.3.2.1.3">𝜃</ci></apply><apply id="S4.E7.m1.7.7.1.3.2.2.cmml" xref="S4.E7.m1.7.7.1.3.2.2"><csymbol cd="ambiguous" id="S4.E7.m1.7.7.1.3.2.2.1.cmml" xref="S4.E7.m1.7.7.1.3.2.2">subscript</csymbol><ci id="S4.E7.m1.7.7.1.3.2.2.2.cmml" xref="S4.E7.m1.7.7.1.3.2.2.2">𝔼</ci><apply id="S4.E7.m1.4.4.4.cmml" xref="S4.E7.m1.4.4.4"><csymbol cd="latexml" id="S4.E7.m1.4.4.4.5.cmml" xref="S4.E7.m1.4.4.4.5">similar-to</csymbol><vector id="S4.E7.m1.4.4.4.4.2.cmml" xref="S4.E7.m1.4.4.4.4.1"><ci id="S4.E7.m1.1.1.1.1.cmml" xref="S4.E7.m1.1.1.1.1">𝑠</ci><ci id="S4.E7.m1.2.2.2.2.cmml" xref="S4.E7.m1.2.2.2.2">𝑎</ci><ci id="S4.E7.m1.3.3.3.3.cmml" xref="S4.E7.m1.3.3.3.3">𝑟</ci><apply id="S4.E7.m1.4.4.4.4.1.1.cmml" xref="S4.E7.m1.4.4.4.4.1.1"><csymbol cd="ambiguous" id="S4.E7.m1.4.4.4.4.1.1.1.cmml" xref="S4.E7.m1.4.4.4.4.1.1">superscript</csymbol><ci id="S4.E7.m1.4.4.4.4.1.1.2.cmml" xref="S4.E7.m1.4.4.4.4.1.1.2">𝑠</ci><ci id="S4.E7.m1.4.4.4.4.1.1.3.cmml" xref="S4.E7.m1.4.4.4.4.1.1.3">′</ci></apply></vector><ci id="S4.E7.m1.4.4.4.6.cmml" xref="S4.E7.m1.4.4.4.6">ℬ</ci></apply></apply></apply></apply><apply id="S4.E7.m1.7.7.1.1.2.cmml" xref="S4.E7.m1.7.7.1.1.1"><csymbol cd="latexml" id="S4.E7.m1.7.7.1.1.2.1.cmml" xref="S4.E7.m1.7.7.1.1.1.2">delimited-[]</csymbol><apply id="S4.E7.m1.7.7.1.1.1.1.cmml" xref="S4.E7.m1.7.7.1.1.1.1"><apply id="S4.E7.m1.7.7.1.1.1.1.1.cmml" xref="S4.E7.m1.7.7.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E7.m1.7.7.1.1.1.1.1.1.cmml" xref="S4.E7.m1.7.7.1.1.1.1.1">superscript</csymbol><apply id="S4.E7.m1.7.7.1.1.1.1.1.2.cmml" xref="S4.E7.m1.7.7.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E7.m1.7.7.1.1.1.1.1.2.1.cmml" xref="S4.E7.m1.7.7.1.1.1.1.1">subscript</csymbol><sum id="S4.E7.m1.7.7.1.1.1.1.1.2.2.cmml" xref="S4.E7.m1.7.7.1.1.1.1.1.2.2"></sum><apply id="S4.E7.m1.7.7.1.1.1.1.1.2.3.cmml" xref="S4.E7.m1.7.7.1.1.1.1.1.2.3"><eq id="S4.E7.m1.7.7.1.1.1.1.1.2.3.1.cmml" xref="S4.E7.m1.7.7.1.1.1.1.1.2.3.1"></eq><ci id="S4.E7.m1.7.7.1.1.1.1.1.2.3.2.cmml" xref="S4.E7.m1.7.7.1.1.1.1.1.2.3.2">𝑘</ci><cn id="S4.E7.m1.7.7.1.1.1.1.1.2.3.3.cmml" type="integer" xref="S4.E7.m1.7.7.1.1.1.1.1.2.3.3">0</cn></apply></apply><ci id="S4.E7.m1.7.7.1.1.1.1.1.3.cmml" xref="S4.E7.m1.7.7.1.1.1.1.1.3">𝐻</ci></apply><apply id="S4.E7.m1.7.7.1.1.1.1.2.cmml" xref="S4.E7.m1.7.7.1.1.1.1.2"><times id="S4.E7.m1.7.7.1.1.1.1.2.1.cmml" xref="S4.E7.m1.7.7.1.1.1.1.2.1"></times><apply id="S4.E7.m1.7.7.1.1.1.1.2.2.cmml" xref="S4.E7.m1.7.7.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S4.E7.m1.7.7.1.1.1.1.2.2.1.cmml" xref="S4.E7.m1.7.7.1.1.1.1.2.2">superscript</csymbol><ci id="S4.E7.m1.7.7.1.1.1.1.2.2.2.cmml" xref="S4.E7.m1.7.7.1.1.1.1.2.2.2">𝜆</ci><ci id="S4.E7.m1.7.7.1.1.1.1.2.2.3.cmml" xref="S4.E7.m1.7.7.1.1.1.1.2.2.3">𝑘</ci></apply><apply id="S4.E7.m1.7.7.1.1.1.1.2.3.cmml" xref="S4.E7.m1.7.7.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S4.E7.m1.7.7.1.1.1.1.2.3.1.cmml" xref="S4.E7.m1.7.7.1.1.1.1.2.3">subscript</csymbol><ci id="S4.E7.m1.7.7.1.1.1.1.2.3.2.cmml" xref="S4.E7.m1.7.7.1.1.1.1.2.3.2">ℒ</ci><ci id="S4.E7.m1.7.7.1.1.1.1.2.3.3.cmml" xref="S4.E7.m1.7.7.1.1.1.1.2.3.3">𝑘</ci></apply><ci id="S4.E7.m1.6.6.cmml" xref="S4.E7.m1.6.6">𝜃</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E7.m1.7c">\theta^{*}=\arg\min_{\theta}{\mathcal{L}}(\theta)=\arg\min_{\theta}\;\mathbb{E%
}_{(s,a,r,s^{\prime})\sim\mathcal{{\mathcal{B}}}}\left[\sum_{k=0}^{H}\lambda^{%
k}{\mathcal{L}}_{k}(\theta)\right]</annotation><annotation encoding="application/x-llamapun" id="S4.E7.m1.7d">italic_θ start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT = roman_arg roman_min start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT caligraphic_L ( italic_θ ) = roman_arg roman_min start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT blackboard_E start_POSTSUBSCRIPT ( italic_s , italic_a , italic_r , italic_s start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ) ∼ caligraphic_B end_POSTSUBSCRIPT [ ∑ start_POSTSUBSCRIPT italic_k = 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_H end_POSTSUPERSCRIPT italic_λ start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT caligraphic_L start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ( italic_θ ) ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS1.SSS0.Px2.p1.1">where <math alttext="\theta=[\theta^{\mathcal{R}},\theta^{Q},\theta^{d},\theta^{h}]" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px2.p1.1.m1.4"><semantics id="S4.SS1.SSS0.Px2.p1.1.m1.4a"><mrow id="S4.SS1.SSS0.Px2.p1.1.m1.4.4" xref="S4.SS1.SSS0.Px2.p1.1.m1.4.4.cmml"><mi id="S4.SS1.SSS0.Px2.p1.1.m1.4.4.6" xref="S4.SS1.SSS0.Px2.p1.1.m1.4.4.6.cmml">θ</mi><mo id="S4.SS1.SSS0.Px2.p1.1.m1.4.4.5" xref="S4.SS1.SSS0.Px2.p1.1.m1.4.4.5.cmml">=</mo><mrow id="S4.SS1.SSS0.Px2.p1.1.m1.4.4.4.4" xref="S4.SS1.SSS0.Px2.p1.1.m1.4.4.4.5.cmml"><mo id="S4.SS1.SSS0.Px2.p1.1.m1.4.4.4.4.5" stretchy="false" xref="S4.SS1.SSS0.Px2.p1.1.m1.4.4.4.5.cmml">[</mo><msup id="S4.SS1.SSS0.Px2.p1.1.m1.1.1.1.1.1" xref="S4.SS1.SSS0.Px2.p1.1.m1.1.1.1.1.1.cmml"><mi id="S4.SS1.SSS0.Px2.p1.1.m1.1.1.1.1.1.2" xref="S4.SS1.SSS0.Px2.p1.1.m1.1.1.1.1.1.2.cmml">θ</mi><mi class="ltx_font_mathcaligraphic" id="S4.SS1.SSS0.Px2.p1.1.m1.1.1.1.1.1.3" xref="S4.SS1.SSS0.Px2.p1.1.m1.1.1.1.1.1.3.cmml">ℛ</mi></msup><mo id="S4.SS1.SSS0.Px2.p1.1.m1.4.4.4.4.6" xref="S4.SS1.SSS0.Px2.p1.1.m1.4.4.4.5.cmml">,</mo><msup id="S4.SS1.SSS0.Px2.p1.1.m1.2.2.2.2.2" xref="S4.SS1.SSS0.Px2.p1.1.m1.2.2.2.2.2.cmml"><mi id="S4.SS1.SSS0.Px2.p1.1.m1.2.2.2.2.2.2" xref="S4.SS1.SSS0.Px2.p1.1.m1.2.2.2.2.2.2.cmml">θ</mi><mi id="S4.SS1.SSS0.Px2.p1.1.m1.2.2.2.2.2.3" xref="S4.SS1.SSS0.Px2.p1.1.m1.2.2.2.2.2.3.cmml">Q</mi></msup><mo id="S4.SS1.SSS0.Px2.p1.1.m1.4.4.4.4.7" xref="S4.SS1.SSS0.Px2.p1.1.m1.4.4.4.5.cmml">,</mo><msup id="S4.SS1.SSS0.Px2.p1.1.m1.3.3.3.3.3" xref="S4.SS1.SSS0.Px2.p1.1.m1.3.3.3.3.3.cmml"><mi id="S4.SS1.SSS0.Px2.p1.1.m1.3.3.3.3.3.2" xref="S4.SS1.SSS0.Px2.p1.1.m1.3.3.3.3.3.2.cmml">θ</mi><mi id="S4.SS1.SSS0.Px2.p1.1.m1.3.3.3.3.3.3" xref="S4.SS1.SSS0.Px2.p1.1.m1.3.3.3.3.3.3.cmml">d</mi></msup><mo id="S4.SS1.SSS0.Px2.p1.1.m1.4.4.4.4.8" xref="S4.SS1.SSS0.Px2.p1.1.m1.4.4.4.5.cmml">,</mo><msup id="S4.SS1.SSS0.Px2.p1.1.m1.4.4.4.4.4" xref="S4.SS1.SSS0.Px2.p1.1.m1.4.4.4.4.4.cmml"><mi id="S4.SS1.SSS0.Px2.p1.1.m1.4.4.4.4.4.2" xref="S4.SS1.SSS0.Px2.p1.1.m1.4.4.4.4.4.2.cmml">θ</mi><mi id="S4.SS1.SSS0.Px2.p1.1.m1.4.4.4.4.4.3" xref="S4.SS1.SSS0.Px2.p1.1.m1.4.4.4.4.4.3.cmml">h</mi></msup><mo id="S4.SS1.SSS0.Px2.p1.1.m1.4.4.4.4.9" stretchy="false" xref="S4.SS1.SSS0.Px2.p1.1.m1.4.4.4.5.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px2.p1.1.m1.4b"><apply id="S4.SS1.SSS0.Px2.p1.1.m1.4.4.cmml" xref="S4.SS1.SSS0.Px2.p1.1.m1.4.4"><eq id="S4.SS1.SSS0.Px2.p1.1.m1.4.4.5.cmml" xref="S4.SS1.SSS0.Px2.p1.1.m1.4.4.5"></eq><ci id="S4.SS1.SSS0.Px2.p1.1.m1.4.4.6.cmml" xref="S4.SS1.SSS0.Px2.p1.1.m1.4.4.6">𝜃</ci><list id="S4.SS1.SSS0.Px2.p1.1.m1.4.4.4.5.cmml" xref="S4.SS1.SSS0.Px2.p1.1.m1.4.4.4.4"><apply id="S4.SS1.SSS0.Px2.p1.1.m1.1.1.1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px2.p1.1.m1.1.1.1.1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.1.m1.1.1.1.1.1">superscript</csymbol><ci id="S4.SS1.SSS0.Px2.p1.1.m1.1.1.1.1.1.2.cmml" xref="S4.SS1.SSS0.Px2.p1.1.m1.1.1.1.1.1.2">𝜃</ci><ci id="S4.SS1.SSS0.Px2.p1.1.m1.1.1.1.1.1.3.cmml" xref="S4.SS1.SSS0.Px2.p1.1.m1.1.1.1.1.1.3">ℛ</ci></apply><apply id="S4.SS1.SSS0.Px2.p1.1.m1.2.2.2.2.2.cmml" xref="S4.SS1.SSS0.Px2.p1.1.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px2.p1.1.m1.2.2.2.2.2.1.cmml" xref="S4.SS1.SSS0.Px2.p1.1.m1.2.2.2.2.2">superscript</csymbol><ci id="S4.SS1.SSS0.Px2.p1.1.m1.2.2.2.2.2.2.cmml" xref="S4.SS1.SSS0.Px2.p1.1.m1.2.2.2.2.2.2">𝜃</ci><ci id="S4.SS1.SSS0.Px2.p1.1.m1.2.2.2.2.2.3.cmml" xref="S4.SS1.SSS0.Px2.p1.1.m1.2.2.2.2.2.3">𝑄</ci></apply><apply id="S4.SS1.SSS0.Px2.p1.1.m1.3.3.3.3.3.cmml" xref="S4.SS1.SSS0.Px2.p1.1.m1.3.3.3.3.3"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px2.p1.1.m1.3.3.3.3.3.1.cmml" xref="S4.SS1.SSS0.Px2.p1.1.m1.3.3.3.3.3">superscript</csymbol><ci id="S4.SS1.SSS0.Px2.p1.1.m1.3.3.3.3.3.2.cmml" xref="S4.SS1.SSS0.Px2.p1.1.m1.3.3.3.3.3.2">𝜃</ci><ci id="S4.SS1.SSS0.Px2.p1.1.m1.3.3.3.3.3.3.cmml" xref="S4.SS1.SSS0.Px2.p1.1.m1.3.3.3.3.3.3">𝑑</ci></apply><apply id="S4.SS1.SSS0.Px2.p1.1.m1.4.4.4.4.4.cmml" xref="S4.SS1.SSS0.Px2.p1.1.m1.4.4.4.4.4"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px2.p1.1.m1.4.4.4.4.4.1.cmml" xref="S4.SS1.SSS0.Px2.p1.1.m1.4.4.4.4.4">superscript</csymbol><ci id="S4.SS1.SSS0.Px2.p1.1.m1.4.4.4.4.4.2.cmml" xref="S4.SS1.SSS0.Px2.p1.1.m1.4.4.4.4.4.2">𝜃</ci><ci id="S4.SS1.SSS0.Px2.p1.1.m1.4.4.4.4.4.3.cmml" xref="S4.SS1.SSS0.Px2.p1.1.m1.4.4.4.4.4.3">ℎ</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px2.p1.1.m1.4c">\theta=[\theta^{\mathcal{R}},\theta^{Q},\theta^{d},\theta^{h}]</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px2.p1.1.m1.4d">italic_θ = [ italic_θ start_POSTSUPERSCRIPT caligraphic_R end_POSTSUPERSCRIPT , italic_θ start_POSTSUPERSCRIPT italic_Q end_POSTSUPERSCRIPT , italic_θ start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT , italic_θ start_POSTSUPERSCRIPT italic_h end_POSTSUPERSCRIPT ]</annotation></semantics></math>. This objective function is identical to the one proposed in TD-MPC.
However, BS-MPC has an additional bisimulation metric loss term at every time step, as shown in Eq. <a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#S3.E5" title="In 3.2 Bisimulation Metric ‣ 3 Preliminaries ‣ Bisimulation metric for Model Predictive Control"><span class="ltx_text ltx_ref_tag">5</span></a>.</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E8">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\begin{split}&amp;{\mathcal{L}}_{k}(\theta)=c_{1}\underbrace{||{\mathcal{R}}_{%
\theta^{\mathcal{R}}}(z_{k},a_{k})-r_{k}||^{2}_{2}}_{\text{(A) reward loss}}+c%
_{2}\underbrace{\left\|Q_{\theta^{Q}}(z_{k},a_{k})-\left(r_{k}+\gamma Q_{\bar{%
\theta}^{Q}}(z_{k+1},\pi_{\theta^{\pi}}(z_{k+1}))\right)\right\|_{2}^{2}}_{%
\text{(B) state-action value loss}}\\
&amp;+c_{3}\underbrace{\left\|d_{\theta^{d}}(z_{k},a_{k})-h_{\bar{\theta}^{h}}(s_{%
k+1})\right\|_{2}^{2}}_{\text{(C) consistency loss}}+c_{4}\underbrace{\left(\|%
h_{\theta^{h}}(s_{k})-h_{\theta^{h}}(\acute{s}_{k})\|_{1}-|r_{k}-\acute{r}_{k}%
|-\gamma||\bar{z}_{k+1}-\bar{\acute{z}}_{k+1}||_{2}^{2}\right)^{2}}_{\text{(D)%
 bisimulation metric loss}}\end{split}" class="ltx_Math" display="block" id="S4.E8.m1.25"><semantics id="S4.E8.m1.25a"><mtable columnspacing="0pt" displaystyle="true" id="S4.E8.m1.25.25" rowspacing="0pt" xref="S4.E8.m1.25.26.1.cmml"><mtr id="S4.E8.m1.25.25a" xref="S4.E8.m1.25.26.1.cmml"><mtd id="S4.E8.m1.25.25b" xref="S4.E8.m1.25.26.1.cmml"></mtd><mtd class="ltx_align_left" columnalign="left" id="S4.E8.m1.25.25c" xref="S4.E8.m1.25.26.1.cmml"><mrow id="S4.E8.m1.15.15.15.15.15" xref="S4.E8.m1.25.26.1.cmml"><mrow id="S4.E8.m1.15.15.15.15.15.16" xref="S4.E8.m1.25.26.1.cmml"><msub id="S4.E8.m1.15.15.15.15.15.16.2" xref="S4.E8.m1.25.26.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E8.m1.1.1.1.1.1.1" xref="S4.E8.m1.1.1.1.1.1.1.cmml">ℒ</mi><mi id="S4.E8.m1.2.2.2.2.2.2.1" xref="S4.E8.m1.2.2.2.2.2.2.1.cmml">k</mi></msub><mo id="S4.E8.m1.15.15.15.15.15.16.1" xref="S4.E8.m1.25.26.1.cmml">⁢</mo><mrow id="S4.E8.m1.15.15.15.15.15.16.3" xref="S4.E8.m1.25.26.1.cmml"><mo id="S4.E8.m1.3.3.3.3.3.3" stretchy="false" xref="S4.E8.m1.25.26.1.cmml">(</mo><mi id="S4.E8.m1.4.4.4.4.4.4" xref="S4.E8.m1.4.4.4.4.4.4.cmml">θ</mi><mo id="S4.E8.m1.5.5.5.5.5.5" stretchy="false" xref="S4.E8.m1.25.26.1.cmml">)</mo></mrow></mrow><mo id="S4.E8.m1.6.6.6.6.6.6" xref="S4.E8.m1.6.6.6.6.6.6.cmml">=</mo><mrow id="S4.E8.m1.15.15.15.15.15.17" xref="S4.E8.m1.25.26.1.cmml"><mrow id="S4.E8.m1.15.15.15.15.15.17.1" xref="S4.E8.m1.25.26.1.cmml"><msub id="S4.E8.m1.15.15.15.15.15.17.1.2" xref="S4.E8.m1.25.26.1.cmml"><mi id="S4.E8.m1.7.7.7.7.7.7" xref="S4.E8.m1.7.7.7.7.7.7.cmml">c</mi><mn id="S4.E8.m1.8.8.8.8.8.8.1" xref="S4.E8.m1.8.8.8.8.8.8.1.cmml">1</mn></msub><mo id="S4.E8.m1.15.15.15.15.15.17.1.1" xref="S4.E8.m1.25.26.1.cmml">⁢</mo><munder id="S4.E8.m1.15.15.15.15.15.17.1.3" xref="S4.E8.m1.25.26.1.cmml"><munder accentunder="true" id="S4.E8.m1.9.9.9.9.9.9" xref="S4.E8.m1.9.9.9.9.9.9.cmml"><msubsup id="S4.E8.m1.9.9.9.9.9.9.1" xref="S4.E8.m1.9.9.9.9.9.9.1.cmml"><mrow id="S4.E8.m1.9.9.9.9.9.9.1.1.1.1" xref="S4.E8.m1.9.9.9.9.9.9.1.1.1.2.cmml"><mo id="S4.E8.m1.9.9.9.9.9.9.1.1.1.1.2" stretchy="false" xref="S4.E8.m1.9.9.9.9.9.9.1.1.1.2.1.cmml">‖</mo><mrow id="S4.E8.m1.9.9.9.9.9.9.1.1.1.1.1" xref="S4.E8.m1.9.9.9.9.9.9.1.1.1.1.1.cmml"><mrow id="S4.E8.m1.9.9.9.9.9.9.1.1.1.1.1.2" xref="S4.E8.m1.9.9.9.9.9.9.1.1.1.1.1.2.cmml"><msub id="S4.E8.m1.9.9.9.9.9.9.1.1.1.1.1.2.4" xref="S4.E8.m1.9.9.9.9.9.9.1.1.1.1.1.2.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E8.m1.9.9.9.9.9.9.1.1.1.1.1.2.4.2" xref="S4.E8.m1.9.9.9.9.9.9.1.1.1.1.1.2.4.2.cmml">ℛ</mi><msup id="S4.E8.m1.9.9.9.9.9.9.1.1.1.1.1.2.4.3" xref="S4.E8.m1.9.9.9.9.9.9.1.1.1.1.1.2.4.3.cmml"><mi id="S4.E8.m1.9.9.9.9.9.9.1.1.1.1.1.2.4.3.2" xref="S4.E8.m1.9.9.9.9.9.9.1.1.1.1.1.2.4.3.2.cmml">θ</mi><mi class="ltx_font_mathcaligraphic" id="S4.E8.m1.9.9.9.9.9.9.1.1.1.1.1.2.4.3.3" xref="S4.E8.m1.9.9.9.9.9.9.1.1.1.1.1.2.4.3.3.cmml">ℛ</mi></msup></msub><mo id="S4.E8.m1.9.9.9.9.9.9.1.1.1.1.1.2.3" xref="S4.E8.m1.9.9.9.9.9.9.1.1.1.1.1.2.3.cmml">⁢</mo><mrow id="S4.E8.m1.9.9.9.9.9.9.1.1.1.1.1.2.2.2" xref="S4.E8.m1.9.9.9.9.9.9.1.1.1.1.1.2.2.3.cmml"><mo id="S4.E8.m1.9.9.9.9.9.9.1.1.1.1.1.2.2.2.3" stretchy="false" xref="S4.E8.m1.9.9.9.9.9.9.1.1.1.1.1.2.2.3.cmml">(</mo><msub id="S4.E8.m1.9.9.9.9.9.9.1.1.1.1.1.1.1.1.1" xref="S4.E8.m1.9.9.9.9.9.9.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E8.m1.9.9.9.9.9.9.1.1.1.1.1.1.1.1.1.2" xref="S4.E8.m1.9.9.9.9.9.9.1.1.1.1.1.1.1.1.1.2.cmml">z</mi><mi id="S4.E8.m1.9.9.9.9.9.9.1.1.1.1.1.1.1.1.1.3" xref="S4.E8.m1.9.9.9.9.9.9.1.1.1.1.1.1.1.1.1.3.cmml">k</mi></msub><mo id="S4.E8.m1.9.9.9.9.9.9.1.1.1.1.1.2.2.2.4" xref="S4.E8.m1.9.9.9.9.9.9.1.1.1.1.1.2.2.3.cmml">,</mo><msub id="S4.E8.m1.9.9.9.9.9.9.1.1.1.1.1.2.2.2.2" xref="S4.E8.m1.9.9.9.9.9.9.1.1.1.1.1.2.2.2.2.cmml"><mi id="S4.E8.m1.9.9.9.9.9.9.1.1.1.1.1.2.2.2.2.2" xref="S4.E8.m1.9.9.9.9.9.9.1.1.1.1.1.2.2.2.2.2.cmml">a</mi><mi id="S4.E8.m1.9.9.9.9.9.9.1.1.1.1.1.2.2.2.2.3" xref="S4.E8.m1.9.9.9.9.9.9.1.1.1.1.1.2.2.2.2.3.cmml">k</mi></msub><mo id="S4.E8.m1.9.9.9.9.9.9.1.1.1.1.1.2.2.2.5" stretchy="false" xref="S4.E8.m1.9.9.9.9.9.9.1.1.1.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo id="S4.E8.m1.9.9.9.9.9.9.1.1.1.1.1.3" xref="S4.E8.m1.9.9.9.9.9.9.1.1.1.1.1.3.cmml">−</mo><msub id="S4.E8.m1.9.9.9.9.9.9.1.1.1.1.1.4" xref="S4.E8.m1.9.9.9.9.9.9.1.1.1.1.1.4.cmml"><mi id="S4.E8.m1.9.9.9.9.9.9.1.1.1.1.1.4.2" xref="S4.E8.m1.9.9.9.9.9.9.1.1.1.1.1.4.2.cmml">r</mi><mi id="S4.E8.m1.9.9.9.9.9.9.1.1.1.1.1.4.3" xref="S4.E8.m1.9.9.9.9.9.9.1.1.1.1.1.4.3.cmml">k</mi></msub></mrow><mo id="S4.E8.m1.9.9.9.9.9.9.1.1.1.1.3" stretchy="false" xref="S4.E8.m1.9.9.9.9.9.9.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S4.E8.m1.9.9.9.9.9.9.1.3" xref="S4.E8.m1.9.9.9.9.9.9.1.3.cmml">2</mn><mn id="S4.E8.m1.9.9.9.9.9.9.1.1.3" xref="S4.E8.m1.9.9.9.9.9.9.1.1.3.cmml">2</mn></msubsup><mo id="S4.E8.m1.9.9.9.9.9.9.2" xref="S4.E8.m1.9.9.9.9.9.9.2.cmml">⏟</mo></munder><mtext id="S4.E8.m1.10.10.10.10.10.10.1" xref="S4.E8.m1.10.10.10.10.10.10.1a.cmml">(A) reward loss</mtext></munder></mrow><mo id="S4.E8.m1.11.11.11.11.11.11" xref="S4.E8.m1.11.11.11.11.11.11.cmml">+</mo><mrow id="S4.E8.m1.15.15.15.15.15.17.2" xref="S4.E8.m1.25.26.1.cmml"><msub id="S4.E8.m1.15.15.15.15.15.17.2.2" xref="S4.E8.m1.25.26.1.cmml"><mi id="S4.E8.m1.12.12.12.12.12.12" xref="S4.E8.m1.12.12.12.12.12.12.cmml">c</mi><mn id="S4.E8.m1.13.13.13.13.13.13.1" xref="S4.E8.m1.13.13.13.13.13.13.1.cmml">2</mn></msub><mo id="S4.E8.m1.15.15.15.15.15.17.2.1" xref="S4.E8.m1.25.26.1.cmml">⁢</mo><munder id="S4.E8.m1.15.15.15.15.15.17.2.3" xref="S4.E8.m1.25.26.1.cmml"><munder accentunder="true" id="S4.E8.m1.14.14.14.14.14.14" xref="S4.E8.m1.14.14.14.14.14.14.cmml"><msubsup id="S4.E8.m1.14.14.14.14.14.14.1" xref="S4.E8.m1.14.14.14.14.14.14.1.cmml"><mrow id="S4.E8.m1.14.14.14.14.14.14.1.1.1.1" xref="S4.E8.m1.14.14.14.14.14.14.1.1.1.2.cmml"><mo id="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.2" xref="S4.E8.m1.14.14.14.14.14.14.1.1.1.2.1.cmml">‖</mo><mrow id="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1" xref="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.cmml"><mrow id="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.2" xref="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.2.cmml"><msub id="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.2.4" xref="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.2.4.cmml"><mi id="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.2.4.2" xref="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.2.4.2.cmml">Q</mi><msup id="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.2.4.3" xref="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.2.4.3.cmml"><mi id="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.2.4.3.2" xref="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.2.4.3.2.cmml">θ</mi><mi id="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.2.4.3.3" xref="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.2.4.3.3.cmml">Q</mi></msup></msub><mo id="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.2.3" xref="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.2.3.cmml">⁢</mo><mrow id="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.2.2.2" xref="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.2.2.3.cmml"><mo id="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.2.2.2.3" stretchy="false" xref="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.2.2.3.cmml">(</mo><msub id="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.1.1.1.1" xref="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.1.1.1.1.2" xref="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.1.1.1.1.2.cmml">z</mi><mi id="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.1.1.1.1.3" xref="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.1.1.1.1.3.cmml">k</mi></msub><mo id="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.2.2.2.4" xref="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.2.2.3.cmml">,</mo><msub id="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.2.2.2.2" xref="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.2.2.2.2.cmml"><mi id="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.2.2.2.2.2" xref="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.2.2.2.2.2.cmml">a</mi><mi id="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.2.2.2.2.3" xref="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.2.2.2.2.3.cmml">k</mi></msub><mo id="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.2.2.2.5" stretchy="false" xref="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo id="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.4" xref="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.4.cmml">−</mo><mrow id="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1" xref="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.cmml"><mo id="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.2" xref="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.cmml">(</mo><mrow id="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1" xref="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.cmml"><msub id="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.4" xref="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.4.cmml"><mi id="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.4.2" xref="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.4.2.cmml">r</mi><mi id="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.4.3" xref="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.4.3.cmml">k</mi></msub><mo id="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.3" xref="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.3.cmml">+</mo><mrow id="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.2" xref="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.2.cmml"><mi id="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.2.4" xref="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.2.4.cmml">γ</mi><mo id="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.2.3" xref="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.2.3.cmml">⁢</mo><msub id="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.2.5" xref="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.2.5.cmml"><mi id="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.2.5.2" xref="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.2.5.2.cmml">Q</mi><msup id="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.2.5.3" xref="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.2.5.3.cmml"><mover accent="true" id="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.2.5.3.2" xref="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.2.5.3.2.cmml"><mi id="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.2.5.3.2.2" xref="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.2.5.3.2.2.cmml">θ</mi><mo id="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.2.5.3.2.1" xref="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.2.5.3.2.1.cmml">¯</mo></mover><mi id="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.2.5.3.3" xref="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.2.5.3.3.cmml">Q</mi></msup></msub><mo id="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.2.3a" xref="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.2.3.cmml">⁢</mo><mrow id="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.2.2.2" xref="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.2.2.3.cmml"><mo id="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.2.2.2.3" stretchy="false" xref="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.2.2.3.cmml">(</mo><msub id="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.1.1.1.1" xref="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.1.1.1.1.cmml"><mi id="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.1.1.1.1.2" xref="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.1.1.1.1.2.cmml">z</mi><mrow id="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.1.1.1.1.3" xref="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.1.1.1.1.3.cmml"><mi id="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.1.1.1.1.3.2" xref="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.1.1.1.1.3.2.cmml">k</mi><mo id="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.1.1.1.1.3.1" xref="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.1.1.1.1.3.1.cmml">+</mo><mn id="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.1.1.1.1.3.3" xref="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.1.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.2.2.2.4" xref="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.2.2.3.cmml">,</mo><mrow id="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.2.2.2.2" xref="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.2.2.2.2.cmml"><msub id="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.2.2.2.2.3" xref="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.2.2.2.2.3.cmml"><mi id="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.2.2.2.2.3.2" xref="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.2.2.2.2.3.2.cmml">π</mi><msup id="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.2.2.2.2.3.3" xref="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.2.2.2.2.3.3.cmml"><mi id="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.2.2.2.2.3.3.2" xref="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.2.2.2.2.3.3.2.cmml">θ</mi><mi id="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.2.2.2.2.3.3.3" xref="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.2.2.2.2.3.3.3.cmml">π</mi></msup></msub><mo id="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.2.2.2.2.2" xref="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.2.2.2.2.2.cmml">⁢</mo><mrow id="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.2.2.2.2.1.1" xref="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.2.2.2.2.1.1.1.cmml"><mo id="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.2.2.2.2.1.1.2" stretchy="false" xref="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.2.2.2.2.1.1.1.cmml">(</mo><msub id="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.2.2.2.2.1.1.1" xref="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.2.2.2.2.1.1.1.cmml"><mi id="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.2.2.2.2.1.1.1.2" xref="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.2.2.2.2.1.1.1.2.cmml">z</mi><mrow id="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.2.2.2.2.1.1.1.3" xref="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.2.2.2.2.1.1.1.3.cmml"><mi id="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.2.2.2.2.1.1.1.3.2" xref="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.2.2.2.2.1.1.1.3.2.cmml">k</mi><mo id="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.2.2.2.2.1.1.1.3.1" xref="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.2.2.2.2.1.1.1.3.1.cmml">+</mo><mn id="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.2.2.2.2.1.1.1.3.3" xref="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.2.2.2.2.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.2.2.2.2.1.1.3" stretchy="false" xref="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.2.2.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.2.2.2.5" stretchy="false" xref="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.3" xref="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.3" xref="S4.E8.m1.14.14.14.14.14.14.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S4.E8.m1.14.14.14.14.14.14.1.1.3" xref="S4.E8.m1.14.14.14.14.14.14.1.1.3.cmml">2</mn><mn id="S4.E8.m1.14.14.14.14.14.14.1.3" xref="S4.E8.m1.14.14.14.14.14.14.1.3.cmml">2</mn></msubsup><mo id="S4.E8.m1.14.14.14.14.14.14.2" xref="S4.E8.m1.14.14.14.14.14.14.2.cmml">⏟</mo></munder><mtext id="S4.E8.m1.15.15.15.15.15.15.1" xref="S4.E8.m1.15.15.15.15.15.15.1a.cmml">(B) state-action value loss</mtext></munder></mrow></mrow></mrow></mtd></mtr><mtr id="S4.E8.m1.25.25d" xref="S4.E8.m1.25.26.1.cmml"><mtd id="S4.E8.m1.25.25e" xref="S4.E8.m1.25.26.1.cmml"></mtd><mtd class="ltx_align_left" columnalign="left" id="S4.E8.m1.25.25f" xref="S4.E8.m1.25.26.1.cmml"><mrow id="S4.E8.m1.25.25.25.10.10" xref="S4.E8.m1.25.26.1.cmml"><mrow id="S4.E8.m1.25.25.25.10.10.11" xref="S4.E8.m1.25.26.1.cmml"><mo id="S4.E8.m1.25.25.25.10.10.11a" xref="S4.E8.m1.25.26.1.cmml">+</mo><mrow id="S4.E8.m1.25.25.25.10.10.11.1" xref="S4.E8.m1.25.26.1.cmml"><msub id="S4.E8.m1.25.25.25.10.10.11.1.2" xref="S4.E8.m1.25.26.1.cmml"><mi id="S4.E8.m1.17.17.17.2.2.2" xref="S4.E8.m1.17.17.17.2.2.2.cmml">c</mi><mn id="S4.E8.m1.18.18.18.3.3.3.1" xref="S4.E8.m1.18.18.18.3.3.3.1.cmml">3</mn></msub><mo id="S4.E8.m1.25.25.25.10.10.11.1.1" xref="S4.E8.m1.25.26.1.cmml">⁢</mo><munder id="S4.E8.m1.25.25.25.10.10.11.1.3" xref="S4.E8.m1.25.26.1.cmml"><munder accentunder="true" id="S4.E8.m1.19.19.19.4.4.4" xref="S4.E8.m1.19.19.19.4.4.4.cmml"><msubsup id="S4.E8.m1.19.19.19.4.4.4.1" xref="S4.E8.m1.19.19.19.4.4.4.1.cmml"><mrow id="S4.E8.m1.19.19.19.4.4.4.1.1.1.1" xref="S4.E8.m1.19.19.19.4.4.4.1.1.1.2.cmml"><mo id="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.2" xref="S4.E8.m1.19.19.19.4.4.4.1.1.1.2.1.cmml">‖</mo><mrow id="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1" xref="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.cmml"><mrow id="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.2" xref="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.2.cmml"><msub id="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.2.4" xref="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.2.4.cmml"><mi id="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.2.4.2" xref="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.2.4.2.cmml">d</mi><msup id="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.2.4.3" xref="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.2.4.3.cmml"><mi id="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.2.4.3.2" xref="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.2.4.3.2.cmml">θ</mi><mi id="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.2.4.3.3" xref="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.2.4.3.3.cmml">d</mi></msup></msub><mo id="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.2.3" xref="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.2.3.cmml">⁢</mo><mrow id="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.2.2.2" xref="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.2.2.3.cmml"><mo id="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.2.2.2.3" stretchy="false" xref="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.2.2.3.cmml">(</mo><msub id="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.1.1.1.1" xref="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.1.1.1.1.2" xref="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.1.1.1.1.2.cmml">z</mi><mi id="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.1.1.1.1.3" xref="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.1.1.1.1.3.cmml">k</mi></msub><mo id="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.2.2.2.4" xref="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.2.2.3.cmml">,</mo><msub id="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.2.2.2.2" xref="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.2.2.2.2.cmml"><mi id="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.2.2.2.2.2" xref="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.2.2.2.2.2.cmml">a</mi><mi id="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.2.2.2.2.3" xref="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.2.2.2.2.3.cmml">k</mi></msub><mo id="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.2.2.2.5" stretchy="false" xref="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo id="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.4" xref="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.4.cmml">−</mo><mrow id="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.3" xref="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.3.cmml"><msub id="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.3.3" xref="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.3.3.cmml"><mi id="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.3.3.2" xref="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.3.3.2.cmml">h</mi><msup id="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.3.3.3" xref="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.3.3.3.cmml"><mover accent="true" id="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.3.3.3.2" xref="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.3.3.3.2.cmml"><mi id="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.3.3.3.2.2" xref="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.3.3.3.2.2.cmml">θ</mi><mo id="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.3.3.3.2.1" xref="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.3.3.3.2.1.cmml">¯</mo></mover><mi id="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.3.3.3.3" xref="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.3.3.3.3.cmml">h</mi></msup></msub><mo id="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.3.2" xref="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.3.2.cmml">⁢</mo><mrow id="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.3.1.1" xref="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.3.1.1.1.cmml"><mo id="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.3.1.1.2" stretchy="false" xref="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.3.1.1.1.cmml">(</mo><msub id="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.3.1.1.1" xref="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.3.1.1.1.cmml"><mi id="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.3.1.1.1.2" xref="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.3.1.1.1.2.cmml">s</mi><mrow id="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.3.1.1.1.3" xref="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.3.1.1.1.3.cmml"><mi id="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.3.1.1.1.3.2" xref="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.3.1.1.1.3.2.cmml">k</mi><mo id="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.3.1.1.1.3.1" xref="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.3.1.1.1.3.1.cmml">+</mo><mn id="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.3.1.1.1.3.3" xref="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.3.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.3.1.1.3" stretchy="false" xref="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.3.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.3" xref="S4.E8.m1.19.19.19.4.4.4.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S4.E8.m1.19.19.19.4.4.4.1.1.3" xref="S4.E8.m1.19.19.19.4.4.4.1.1.3.cmml">2</mn><mn id="S4.E8.m1.19.19.19.4.4.4.1.3" xref="S4.E8.m1.19.19.19.4.4.4.1.3.cmml">2</mn></msubsup><mo id="S4.E8.m1.19.19.19.4.4.4.2" xref="S4.E8.m1.19.19.19.4.4.4.2.cmml">⏟</mo></munder><mtext id="S4.E8.m1.20.20.20.5.5.5.1" xref="S4.E8.m1.20.20.20.5.5.5.1a.cmml">(C) consistency loss</mtext></munder></mrow></mrow><mo id="S4.E8.m1.21.21.21.6.6.6" xref="S4.E8.m1.25.26.1.cmml">+</mo><mrow id="S4.E8.m1.25.25.25.10.10.12" xref="S4.E8.m1.25.26.1.cmml"><msub id="S4.E8.m1.25.25.25.10.10.12.2" xref="S4.E8.m1.25.26.1.cmml"><mi id="S4.E8.m1.22.22.22.7.7.7" xref="S4.E8.m1.22.22.22.7.7.7.cmml">c</mi><mn id="S4.E8.m1.23.23.23.8.8.8.1" xref="S4.E8.m1.23.23.23.8.8.8.1.cmml">4</mn></msub><mo id="S4.E8.m1.25.25.25.10.10.12.1" xref="S4.E8.m1.25.26.1.cmml">⁢</mo><munder id="S4.E8.m1.25.25.25.10.10.12.3" xref="S4.E8.m1.25.26.1.cmml"><munder accentunder="true" id="S4.E8.m1.24.24.24.9.9.9" xref="S4.E8.m1.24.24.24.9.9.9.cmml"><msup id="S4.E8.m1.24.24.24.9.9.9.1" xref="S4.E8.m1.24.24.24.9.9.9.1.cmml"><mrow id="S4.E8.m1.24.24.24.9.9.9.1.1.1" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.cmml"><mo id="S4.E8.m1.24.24.24.9.9.9.1.1.1.2" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.cmml">(</mo><mrow id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.cmml"><msub id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1.cmml"><mrow id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1.1.1" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1.1.2.cmml"><mo id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1.1.2.1.cmml">‖</mo><mrow id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1.1.1.1" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1.1.1.1.cmml"><mrow id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1.1.1.1.1" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1.1.1.1.1.cmml"><msub id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1.1.1.1.1.3" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1.1.1.1.1.3.2" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1.1.1.1.1.3.2.cmml">h</mi><msup id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1.1.1.1.1.3.3" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1.1.1.1.1.3.3.2" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1.1.1.1.1.3.3.2.cmml">θ</mi><mi id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1.1.1.1.1.3.3.3" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1.1.1.1.1.3.3.3.cmml">h</mi></msup></msub><mo id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1.1.1.1.1.2" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">s</mi><mi id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">k</mi></msub><mo id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1.1.1.1.3" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1.1.1.1.3.cmml">−</mo><mrow id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1.1.1.1.2" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1.1.1.1.2.cmml"><msub id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1.1.1.1.2.3" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1.1.1.1.2.3.2" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1.1.1.1.2.3.2.cmml">h</mi><msup id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1.1.1.1.2.3.3" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1.1.1.1.2.3.3.cmml"><mi id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1.1.1.1.2.3.3.2" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1.1.1.1.2.3.3.2.cmml">θ</mi><mi id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1.1.1.1.2.3.3.3" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1.1.1.1.2.3.3.3.cmml">h</mi></msup></msub><mo id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1.1.1.1.2.2" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1.1.1.1.2.2.cmml">⁢</mo><mrow id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1.1.1.1.2.1.1" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1.1.1.1.2.1.1.1.cmml"><mo id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1.1.1.1.2.1.1.2" stretchy="false" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1.1.1.1.2.1.1.1.cmml">(</mo><msub id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1.1.1.1.2.1.1.1" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1.1.1.1.2.1.1.1.cmml"><mover accent="true" id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1.1.1.1.2.1.1.1.2" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1.1.1.1.2.1.1.1.2.cmml"><mi id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1.1.1.1.2.1.1.1.2.2" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1.1.1.1.2.1.1.1.2.2.cmml">s</mi><mo id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1.1.1.1.2.1.1.1.2.1" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1.1.1.1.2.1.1.1.2.1.cmml">´</mo></mover><mi id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1.1.1.1.2.1.1.1.3" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1.1.1.1.2.1.1.1.3.cmml">k</mi></msub><mo id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1.1.1.1.2.1.1.3" stretchy="false" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1.1.1.1.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1.3" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1.3.cmml">1</mn></msub><mo id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.4" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.4.cmml">−</mo><mrow id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.2.1" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.2.2.cmml"><mo id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.2.1.2" stretchy="false" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.2.2.1.cmml">|</mo><mrow id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.2.1.1" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.2.1.1.cmml"><msub id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.2.1.1.2" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.2.1.1.2.cmml"><mi id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.2.1.1.2.2" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.2.1.1.2.2.cmml">r</mi><mi id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.2.1.1.2.3" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.2.1.1.2.3.cmml">k</mi></msub><mo id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.2.1.1.1" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.2.1.1.1.cmml">−</mo><msub id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.2.1.1.3" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.2.1.1.3.cmml"><mover accent="true" id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.2.1.1.3.2" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.2.1.1.3.2.cmml"><mi id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.2.1.1.3.2.2" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.2.1.1.3.2.2.cmml">r</mi><mo id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.2.1.1.3.2.1" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.2.1.1.3.2.1.cmml">´</mo></mover><mi id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.2.1.1.3.3" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.2.1.1.3.3.cmml">k</mi></msub></mrow><mo id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.2.1.3" stretchy="false" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.2.2.1.cmml">|</mo></mrow><mo id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.4a" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.4.cmml">−</mo><mrow id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.3" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.3.cmml"><mi id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.3.3" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.3.3.cmml">γ</mi><mo id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.3.2" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.3.2.cmml">⁢</mo><msubsup id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.3.1" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.3.1.cmml"><mrow id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.3.1.1.1.1" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.3.1.1.1.2.cmml"><mo id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.3.1.1.1.1.2" stretchy="false" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.3.1.1.1.2.1.cmml">‖</mo><mrow id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.3.1.1.1.1.1" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.3.1.1.1.1.1.cmml"><msub id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.3.1.1.1.1.1.2" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.3.1.1.1.1.1.2.cmml"><mover accent="true" id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.3.1.1.1.1.1.2.2" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.3.1.1.1.1.1.2.2.cmml"><mi id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.3.1.1.1.1.1.2.2.2" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.3.1.1.1.1.1.2.2.2.cmml">z</mi><mo id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.3.1.1.1.1.1.2.2.1" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.3.1.1.1.1.1.2.2.1.cmml">¯</mo></mover><mrow id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.3.1.1.1.1.1.2.3" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.3.1.1.1.1.1.2.3.cmml"><mi id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.3.1.1.1.1.1.2.3.2" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.3.1.1.1.1.1.2.3.2.cmml">k</mi><mo id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.3.1.1.1.1.1.2.3.1" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.3.1.1.1.1.1.2.3.1.cmml">+</mo><mn id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.3.1.1.1.1.1.2.3.3" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.3.1.1.1.1.1.2.3.3.cmml">1</mn></mrow></msub><mo id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.3.1.1.1.1.1.1" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.3.1.1.1.1.1.1.cmml">−</mo><msub id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.3.1.1.1.1.1.3" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.3.1.1.1.1.1.3.cmml"><mover accent="true" id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.3.1.1.1.1.1.3.2" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.3.1.1.1.1.1.3.2.cmml"><mover accent="true" id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.3.1.1.1.1.1.3.2.2" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.3.1.1.1.1.1.3.2.2.cmml"><mi id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.3.1.1.1.1.1.3.2.2.2" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.3.1.1.1.1.1.3.2.2.2.cmml">z</mi><mo id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.3.1.1.1.1.1.3.2.2.1" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.3.1.1.1.1.1.3.2.2.1.cmml">´</mo></mover><mo id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.3.1.1.1.1.1.3.2.1" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.3.1.1.1.1.1.3.2.1.cmml">¯</mo></mover><mrow id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.3.1.1.1.1.1.3.3" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.3.1.1.1.1.1.3.3.cmml"><mi id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.3.1.1.1.1.1.3.3.2" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.3.1.1.1.1.1.3.3.2.cmml">k</mi><mo id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.3.1.1.1.1.1.3.3.1" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.3.1.1.1.1.1.3.3.1.cmml">+</mo><mn id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.3.1.1.1.1.1.3.3.3" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.3.1.1.1.1.1.3.3.3.cmml">1</mn></mrow></msub></mrow><mo id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.3.1.1.1.1.3" stretchy="false" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.3.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.3.1.1.3" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.3.1.1.3.cmml">2</mn><mn id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.3.1.3" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.3.1.3.cmml">2</mn></msubsup></mrow></mrow><mo id="S4.E8.m1.24.24.24.9.9.9.1.1.1.3" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.cmml">)</mo></mrow><mn id="S4.E8.m1.24.24.24.9.9.9.1.3" xref="S4.E8.m1.24.24.24.9.9.9.1.3.cmml">2</mn></msup><mo id="S4.E8.m1.24.24.24.9.9.9.2" xref="S4.E8.m1.24.24.24.9.9.9.2.cmml">⏟</mo></munder><mtext id="S4.E8.m1.25.25.25.10.10.10.1" xref="S4.E8.m1.25.25.25.10.10.10.1a.cmml">(D) bisimulation metric loss</mtext></munder></mrow></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S4.E8.m1.25b"><apply id="S4.E8.m1.25.26.1.cmml" xref="S4.E8.m1.25.25"><eq id="S4.E8.m1.6.6.6.6.6.6.cmml" xref="S4.E8.m1.6.6.6.6.6.6"></eq><apply id="S4.E8.m1.25.26.1.2.cmml" xref="S4.E8.m1.25.25"><times id="S4.E8.m1.25.26.1.2.1.cmml" xref="S4.E8.m1.25.25"></times><apply id="S4.E8.m1.25.26.1.2.2.cmml" xref="S4.E8.m1.25.25"><csymbol cd="ambiguous" id="S4.E8.m1.25.26.1.2.2.1.cmml" xref="S4.E8.m1.25.25">subscript</csymbol><ci id="S4.E8.m1.1.1.1.1.1.1.cmml" xref="S4.E8.m1.1.1.1.1.1.1">ℒ</ci><ci id="S4.E8.m1.2.2.2.2.2.2.1.cmml" xref="S4.E8.m1.2.2.2.2.2.2.1">𝑘</ci></apply><ci id="S4.E8.m1.4.4.4.4.4.4.cmml" xref="S4.E8.m1.4.4.4.4.4.4">𝜃</ci></apply><apply id="S4.E8.m1.25.26.1.3.cmml" xref="S4.E8.m1.25.25"><plus id="S4.E8.m1.11.11.11.11.11.11.cmml" xref="S4.E8.m1.11.11.11.11.11.11"></plus><apply id="S4.E8.m1.25.26.1.3.2.cmml" xref="S4.E8.m1.25.25"><times id="S4.E8.m1.25.26.1.3.2.1.cmml" xref="S4.E8.m1.25.25"></times><apply id="S4.E8.m1.25.26.1.3.2.2.cmml" xref="S4.E8.m1.25.25"><csymbol cd="ambiguous" id="S4.E8.m1.25.26.1.3.2.2.1.cmml" xref="S4.E8.m1.25.25">subscript</csymbol><ci id="S4.E8.m1.7.7.7.7.7.7.cmml" xref="S4.E8.m1.7.7.7.7.7.7">𝑐</ci><cn id="S4.E8.m1.8.8.8.8.8.8.1.cmml" type="integer" xref="S4.E8.m1.8.8.8.8.8.8.1">1</cn></apply><apply id="S4.E8.m1.25.26.1.3.2.3.cmml" xref="S4.E8.m1.25.25"><csymbol cd="ambiguous" id="S4.E8.m1.25.26.1.3.2.3.1.cmml" xref="S4.E8.m1.25.25">subscript</csymbol><apply id="S4.E8.m1.9.9.9.9.9.9.cmml" xref="S4.E8.m1.9.9.9.9.9.9"><ci id="S4.E8.m1.9.9.9.9.9.9.2.cmml" xref="S4.E8.m1.9.9.9.9.9.9.2">⏟</ci><apply id="S4.E8.m1.9.9.9.9.9.9.1.cmml" xref="S4.E8.m1.9.9.9.9.9.9.1"><csymbol cd="ambiguous" id="S4.E8.m1.9.9.9.9.9.9.1.2.cmml" xref="S4.E8.m1.9.9.9.9.9.9.1">subscript</csymbol><apply id="S4.E8.m1.9.9.9.9.9.9.1.1.cmml" xref="S4.E8.m1.9.9.9.9.9.9.1"><csymbol cd="ambiguous" id="S4.E8.m1.9.9.9.9.9.9.1.1.2.cmml" xref="S4.E8.m1.9.9.9.9.9.9.1">superscript</csymbol><apply id="S4.E8.m1.9.9.9.9.9.9.1.1.1.2.cmml" xref="S4.E8.m1.9.9.9.9.9.9.1.1.1.1"><csymbol cd="latexml" id="S4.E8.m1.9.9.9.9.9.9.1.1.1.2.1.cmml" xref="S4.E8.m1.9.9.9.9.9.9.1.1.1.1.2">norm</csymbol><apply id="S4.E8.m1.9.9.9.9.9.9.1.1.1.1.1.cmml" xref="S4.E8.m1.9.9.9.9.9.9.1.1.1.1.1"><minus id="S4.E8.m1.9.9.9.9.9.9.1.1.1.1.1.3.cmml" xref="S4.E8.m1.9.9.9.9.9.9.1.1.1.1.1.3"></minus><apply id="S4.E8.m1.9.9.9.9.9.9.1.1.1.1.1.2.cmml" xref="S4.E8.m1.9.9.9.9.9.9.1.1.1.1.1.2"><times id="S4.E8.m1.9.9.9.9.9.9.1.1.1.1.1.2.3.cmml" xref="S4.E8.m1.9.9.9.9.9.9.1.1.1.1.1.2.3"></times><apply id="S4.E8.m1.9.9.9.9.9.9.1.1.1.1.1.2.4.cmml" xref="S4.E8.m1.9.9.9.9.9.9.1.1.1.1.1.2.4"><csymbol cd="ambiguous" id="S4.E8.m1.9.9.9.9.9.9.1.1.1.1.1.2.4.1.cmml" xref="S4.E8.m1.9.9.9.9.9.9.1.1.1.1.1.2.4">subscript</csymbol><ci id="S4.E8.m1.9.9.9.9.9.9.1.1.1.1.1.2.4.2.cmml" xref="S4.E8.m1.9.9.9.9.9.9.1.1.1.1.1.2.4.2">ℛ</ci><apply id="S4.E8.m1.9.9.9.9.9.9.1.1.1.1.1.2.4.3.cmml" xref="S4.E8.m1.9.9.9.9.9.9.1.1.1.1.1.2.4.3"><csymbol cd="ambiguous" id="S4.E8.m1.9.9.9.9.9.9.1.1.1.1.1.2.4.3.1.cmml" xref="S4.E8.m1.9.9.9.9.9.9.1.1.1.1.1.2.4.3">superscript</csymbol><ci id="S4.E8.m1.9.9.9.9.9.9.1.1.1.1.1.2.4.3.2.cmml" xref="S4.E8.m1.9.9.9.9.9.9.1.1.1.1.1.2.4.3.2">𝜃</ci><ci id="S4.E8.m1.9.9.9.9.9.9.1.1.1.1.1.2.4.3.3.cmml" xref="S4.E8.m1.9.9.9.9.9.9.1.1.1.1.1.2.4.3.3">ℛ</ci></apply></apply><interval closure="open" id="S4.E8.m1.9.9.9.9.9.9.1.1.1.1.1.2.2.3.cmml" xref="S4.E8.m1.9.9.9.9.9.9.1.1.1.1.1.2.2.2"><apply id="S4.E8.m1.9.9.9.9.9.9.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E8.m1.9.9.9.9.9.9.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E8.m1.9.9.9.9.9.9.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E8.m1.9.9.9.9.9.9.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E8.m1.9.9.9.9.9.9.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E8.m1.9.9.9.9.9.9.1.1.1.1.1.1.1.1.1.2">𝑧</ci><ci id="S4.E8.m1.9.9.9.9.9.9.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E8.m1.9.9.9.9.9.9.1.1.1.1.1.1.1.1.1.3">𝑘</ci></apply><apply id="S4.E8.m1.9.9.9.9.9.9.1.1.1.1.1.2.2.2.2.cmml" xref="S4.E8.m1.9.9.9.9.9.9.1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S4.E8.m1.9.9.9.9.9.9.1.1.1.1.1.2.2.2.2.1.cmml" xref="S4.E8.m1.9.9.9.9.9.9.1.1.1.1.1.2.2.2.2">subscript</csymbol><ci id="S4.E8.m1.9.9.9.9.9.9.1.1.1.1.1.2.2.2.2.2.cmml" xref="S4.E8.m1.9.9.9.9.9.9.1.1.1.1.1.2.2.2.2.2">𝑎</ci><ci id="S4.E8.m1.9.9.9.9.9.9.1.1.1.1.1.2.2.2.2.3.cmml" xref="S4.E8.m1.9.9.9.9.9.9.1.1.1.1.1.2.2.2.2.3">𝑘</ci></apply></interval></apply><apply id="S4.E8.m1.9.9.9.9.9.9.1.1.1.1.1.4.cmml" xref="S4.E8.m1.9.9.9.9.9.9.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S4.E8.m1.9.9.9.9.9.9.1.1.1.1.1.4.1.cmml" xref="S4.E8.m1.9.9.9.9.9.9.1.1.1.1.1.4">subscript</csymbol><ci id="S4.E8.m1.9.9.9.9.9.9.1.1.1.1.1.4.2.cmml" xref="S4.E8.m1.9.9.9.9.9.9.1.1.1.1.1.4.2">𝑟</ci><ci id="S4.E8.m1.9.9.9.9.9.9.1.1.1.1.1.4.3.cmml" xref="S4.E8.m1.9.9.9.9.9.9.1.1.1.1.1.4.3">𝑘</ci></apply></apply></apply><cn id="S4.E8.m1.9.9.9.9.9.9.1.1.3.cmml" type="integer" xref="S4.E8.m1.9.9.9.9.9.9.1.1.3">2</cn></apply><cn id="S4.E8.m1.9.9.9.9.9.9.1.3.cmml" type="integer" xref="S4.E8.m1.9.9.9.9.9.9.1.3">2</cn></apply></apply><ci id="S4.E8.m1.10.10.10.10.10.10.1a.cmml" xref="S4.E8.m1.10.10.10.10.10.10.1"><mtext id="S4.E8.m1.10.10.10.10.10.10.1.cmml" mathsize="70%" xref="S4.E8.m1.10.10.10.10.10.10.1">(A) reward loss</mtext></ci></apply></apply><apply id="S4.E8.m1.25.26.1.3.3.cmml" xref="S4.E8.m1.25.25"><times id="S4.E8.m1.25.26.1.3.3.1.cmml" xref="S4.E8.m1.25.25"></times><apply id="S4.E8.m1.25.26.1.3.3.2.cmml" xref="S4.E8.m1.25.25"><csymbol cd="ambiguous" id="S4.E8.m1.25.26.1.3.3.2.1.cmml" xref="S4.E8.m1.25.25">subscript</csymbol><ci id="S4.E8.m1.12.12.12.12.12.12.cmml" xref="S4.E8.m1.12.12.12.12.12.12">𝑐</ci><cn id="S4.E8.m1.13.13.13.13.13.13.1.cmml" type="integer" xref="S4.E8.m1.13.13.13.13.13.13.1">2</cn></apply><apply id="S4.E8.m1.25.26.1.3.3.3.cmml" xref="S4.E8.m1.25.25"><csymbol cd="ambiguous" id="S4.E8.m1.25.26.1.3.3.3.1.cmml" xref="S4.E8.m1.25.25">subscript</csymbol><apply id="S4.E8.m1.14.14.14.14.14.14.cmml" xref="S4.E8.m1.14.14.14.14.14.14"><ci id="S4.E8.m1.14.14.14.14.14.14.2.cmml" xref="S4.E8.m1.14.14.14.14.14.14.2">⏟</ci><apply id="S4.E8.m1.14.14.14.14.14.14.1.cmml" xref="S4.E8.m1.14.14.14.14.14.14.1"><csymbol cd="ambiguous" id="S4.E8.m1.14.14.14.14.14.14.1.2.cmml" xref="S4.E8.m1.14.14.14.14.14.14.1">superscript</csymbol><apply id="S4.E8.m1.14.14.14.14.14.14.1.1.cmml" xref="S4.E8.m1.14.14.14.14.14.14.1"><csymbol cd="ambiguous" id="S4.E8.m1.14.14.14.14.14.14.1.1.2.cmml" xref="S4.E8.m1.14.14.14.14.14.14.1">subscript</csymbol><apply id="S4.E8.m1.14.14.14.14.14.14.1.1.1.2.cmml" xref="S4.E8.m1.14.14.14.14.14.14.1.1.1.1"><csymbol cd="latexml" id="S4.E8.m1.14.14.14.14.14.14.1.1.1.2.1.cmml" xref="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.2">norm</csymbol><apply id="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.cmml" xref="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1"><minus id="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.4.cmml" xref="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.4"></minus><apply id="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.2.cmml" xref="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.2"><times id="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.2.3.cmml" xref="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.2.3"></times><apply id="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.2.4.cmml" xref="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.2.4"><csymbol cd="ambiguous" id="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.2.4.1.cmml" xref="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.2.4">subscript</csymbol><ci id="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.2.4.2.cmml" xref="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.2.4.2">𝑄</ci><apply id="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.2.4.3.cmml" xref="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.2.4.3"><csymbol cd="ambiguous" id="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.2.4.3.1.cmml" xref="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.2.4.3">superscript</csymbol><ci id="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.2.4.3.2.cmml" xref="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.2.4.3.2">𝜃</ci><ci id="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.2.4.3.3.cmml" xref="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.2.4.3.3">𝑄</ci></apply></apply><interval closure="open" id="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.2.2.3.cmml" xref="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.2.2.2"><apply id="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.1.1.1.1.2">𝑧</ci><ci id="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.1.1.1.1.3">𝑘</ci></apply><apply id="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.2.2.2.2.cmml" xref="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.2.2.2.2.1.cmml" xref="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.2.2.2.2">subscript</csymbol><ci id="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.2.2.2.2.2.cmml" xref="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.2.2.2.2.2">𝑎</ci><ci id="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.2.2.2.2.3.cmml" xref="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.2.2.2.2.3">𝑘</ci></apply></interval></apply><apply id="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.cmml" xref="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1"><plus id="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.3.cmml" xref="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.3"></plus><apply id="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.4.cmml" xref="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.4"><csymbol cd="ambiguous" id="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.4.1.cmml" xref="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.4">subscript</csymbol><ci id="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.4.2.cmml" xref="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.4.2">𝑟</ci><ci id="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.4.3.cmml" xref="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.4.3">𝑘</ci></apply><apply id="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.2.cmml" xref="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.2"><times id="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.2.3.cmml" xref="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.2.3"></times><ci id="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.2.4.cmml" xref="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.2.4">𝛾</ci><apply id="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.2.5.cmml" xref="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.2.5"><csymbol cd="ambiguous" id="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.2.5.1.cmml" xref="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.2.5">subscript</csymbol><ci id="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.2.5.2.cmml" xref="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.2.5.2">𝑄</ci><apply id="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.2.5.3.cmml" xref="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.2.5.3"><csymbol cd="ambiguous" id="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.2.5.3.1.cmml" xref="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.2.5.3">superscript</csymbol><apply id="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.2.5.3.2.cmml" xref="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.2.5.3.2"><ci id="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.2.5.3.2.1.cmml" xref="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.2.5.3.2.1">¯</ci><ci id="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.2.5.3.2.2.cmml" xref="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.2.5.3.2.2">𝜃</ci></apply><ci id="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.2.5.3.3.cmml" xref="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.2.5.3.3">𝑄</ci></apply></apply><interval closure="open" id="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.2.2.3.cmml" xref="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.2.2.2"><apply id="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.1.1.1.1.cmml" xref="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.1.1.1.1.1.cmml" xref="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.1.1.1.1.2.cmml" xref="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.1.1.1.1.2">𝑧</ci><apply id="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.1.1.1.1.3.cmml" xref="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.1.1.1.1.3"><plus id="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.1.1.1.1.3.1.cmml" xref="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.1.1.1.1.3.1"></plus><ci id="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.1.1.1.1.3.2.cmml" xref="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.1.1.1.1.3.2">𝑘</ci><cn id="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.1.1.1.1.3.3.cmml" type="integer" xref="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.1.1.1.1.3.3">1</cn></apply></apply><apply id="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.2.2.2.2.cmml" xref="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.2.2.2.2"><times id="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.2.2.2.2.2.cmml" xref="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.2.2.2.2.2"></times><apply id="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.2.2.2.2.3.cmml" xref="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.2.2.2.2.3"><csymbol cd="ambiguous" id="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.2.2.2.2.3.1.cmml" xref="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.2.2.2.2.3">subscript</csymbol><ci id="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.2.2.2.2.3.2.cmml" xref="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.2.2.2.2.3.2">𝜋</ci><apply id="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.2.2.2.2.3.3.cmml" xref="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.2.2.2.2.3.3"><csymbol cd="ambiguous" id="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.2.2.2.2.3.3.1.cmml" xref="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.2.2.2.2.3.3">superscript</csymbol><ci id="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.2.2.2.2.3.3.2.cmml" xref="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.2.2.2.2.3.3.2">𝜃</ci><ci id="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.2.2.2.2.3.3.3.cmml" xref="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.2.2.2.2.3.3.3">𝜋</ci></apply></apply><apply id="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.2.2.2.2.1.1.1.cmml" xref="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.2.2.2.2.1.1.1.1.cmml" xref="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.2.2.2.2.1.1">subscript</csymbol><ci id="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.2.2.2.2.1.1.1.2.cmml" xref="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.2.2.2.2.1.1.1.2">𝑧</ci><apply id="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.2.2.2.2.1.1.1.3.cmml" xref="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.2.2.2.2.1.1.1.3"><plus id="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.2.2.2.2.1.1.1.3.1.cmml" xref="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.2.2.2.2.1.1.1.3.1"></plus><ci id="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.2.2.2.2.1.1.1.3.2.cmml" xref="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.2.2.2.2.1.1.1.3.2">𝑘</ci><cn id="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.2.2.2.2.1.1.1.3.3.cmml" type="integer" xref="S4.E8.m1.14.14.14.14.14.14.1.1.1.1.1.3.1.1.2.2.2.2.1.1.1.3.3">1</cn></apply></apply></apply></interval></apply></apply></apply></apply><cn id="S4.E8.m1.14.14.14.14.14.14.1.1.3.cmml" type="integer" xref="S4.E8.m1.14.14.14.14.14.14.1.1.3">2</cn></apply><cn id="S4.E8.m1.14.14.14.14.14.14.1.3.cmml" type="integer" xref="S4.E8.m1.14.14.14.14.14.14.1.3">2</cn></apply></apply><ci id="S4.E8.m1.15.15.15.15.15.15.1a.cmml" xref="S4.E8.m1.15.15.15.15.15.15.1"><mtext id="S4.E8.m1.15.15.15.15.15.15.1.cmml" mathsize="70%" xref="S4.E8.m1.15.15.15.15.15.15.1">(B) state-action value loss</mtext></ci></apply></apply><apply id="S4.E8.m1.25.26.1.3.4.cmml" xref="S4.E8.m1.25.25"><times id="S4.E8.m1.25.26.1.3.4.1.cmml" xref="S4.E8.m1.25.25"></times><apply id="S4.E8.m1.25.26.1.3.4.2.cmml" xref="S4.E8.m1.25.25"><csymbol cd="ambiguous" id="S4.E8.m1.25.26.1.3.4.2.1.cmml" xref="S4.E8.m1.25.25">subscript</csymbol><ci id="S4.E8.m1.17.17.17.2.2.2.cmml" xref="S4.E8.m1.17.17.17.2.2.2">𝑐</ci><cn id="S4.E8.m1.18.18.18.3.3.3.1.cmml" type="integer" xref="S4.E8.m1.18.18.18.3.3.3.1">3</cn></apply><apply id="S4.E8.m1.25.26.1.3.4.3.cmml" xref="S4.E8.m1.25.25"><csymbol cd="ambiguous" id="S4.E8.m1.25.26.1.3.4.3.1.cmml" xref="S4.E8.m1.25.25">subscript</csymbol><apply id="S4.E8.m1.19.19.19.4.4.4.cmml" xref="S4.E8.m1.19.19.19.4.4.4"><ci id="S4.E8.m1.19.19.19.4.4.4.2.cmml" xref="S4.E8.m1.19.19.19.4.4.4.2">⏟</ci><apply id="S4.E8.m1.19.19.19.4.4.4.1.cmml" xref="S4.E8.m1.19.19.19.4.4.4.1"><csymbol cd="ambiguous" id="S4.E8.m1.19.19.19.4.4.4.1.2.cmml" xref="S4.E8.m1.19.19.19.4.4.4.1">superscript</csymbol><apply id="S4.E8.m1.19.19.19.4.4.4.1.1.cmml" xref="S4.E8.m1.19.19.19.4.4.4.1"><csymbol cd="ambiguous" id="S4.E8.m1.19.19.19.4.4.4.1.1.2.cmml" xref="S4.E8.m1.19.19.19.4.4.4.1">subscript</csymbol><apply id="S4.E8.m1.19.19.19.4.4.4.1.1.1.2.cmml" xref="S4.E8.m1.19.19.19.4.4.4.1.1.1.1"><csymbol cd="latexml" id="S4.E8.m1.19.19.19.4.4.4.1.1.1.2.1.cmml" xref="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.2">norm</csymbol><apply id="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.cmml" xref="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1"><minus id="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.4.cmml" xref="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.4"></minus><apply id="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.2.cmml" xref="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.2"><times id="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.2.3.cmml" xref="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.2.3"></times><apply id="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.2.4.cmml" xref="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.2.4"><csymbol cd="ambiguous" id="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.2.4.1.cmml" xref="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.2.4">subscript</csymbol><ci id="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.2.4.2.cmml" xref="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.2.4.2">𝑑</ci><apply id="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.2.4.3.cmml" xref="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.2.4.3"><csymbol cd="ambiguous" id="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.2.4.3.1.cmml" xref="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.2.4.3">superscript</csymbol><ci id="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.2.4.3.2.cmml" xref="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.2.4.3.2">𝜃</ci><ci id="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.2.4.3.3.cmml" xref="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.2.4.3.3">𝑑</ci></apply></apply><interval closure="open" id="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.2.2.3.cmml" xref="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.2.2.2"><apply id="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.1.1.1.1.2">𝑧</ci><ci id="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.1.1.1.1.3">𝑘</ci></apply><apply id="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.2.2.2.2.cmml" xref="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.2.2.2.2.1.cmml" xref="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.2.2.2.2">subscript</csymbol><ci id="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.2.2.2.2.2.cmml" xref="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.2.2.2.2.2">𝑎</ci><ci id="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.2.2.2.2.3.cmml" xref="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.2.2.2.2.3">𝑘</ci></apply></interval></apply><apply id="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.3.cmml" xref="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.3"><times id="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.3.2.cmml" xref="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.3.2"></times><apply id="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.3.3.cmml" xref="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.3.3.1.cmml" xref="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.3.3">subscript</csymbol><ci id="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.3.3.2.cmml" xref="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.3.3.2">ℎ</ci><apply id="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.3.3.3.cmml" xref="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.3.3.3.1.cmml" xref="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.3.3.3">superscript</csymbol><apply id="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.3.3.3.2.cmml" xref="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.3.3.3.2"><ci id="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.3.3.3.2.1.cmml" xref="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.3.3.3.2.1">¯</ci><ci id="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.3.3.3.2.2.cmml" xref="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.3.3.3.2.2">𝜃</ci></apply><ci id="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.3.3.3.3.cmml" xref="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.3.3.3.3">ℎ</ci></apply></apply><apply id="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.3.1.1.1.cmml" xref="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.3.1.1"><csymbol cd="ambiguous" id="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.3.1.1.1.1.cmml" xref="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.3.1.1">subscript</csymbol><ci id="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.3.1.1.1.2.cmml" xref="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.3.1.1.1.2">𝑠</ci><apply id="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.3.1.1.1.3.cmml" xref="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.3.1.1.1.3"><plus id="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.3.1.1.1.3.1.cmml" xref="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.3.1.1.1.3.1"></plus><ci id="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.3.1.1.1.3.2.cmml" xref="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.3.1.1.1.3.2">𝑘</ci><cn id="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.3.1.1.1.3.3.cmml" type="integer" xref="S4.E8.m1.19.19.19.4.4.4.1.1.1.1.1.3.1.1.1.3.3">1</cn></apply></apply></apply></apply></apply><cn id="S4.E8.m1.19.19.19.4.4.4.1.1.3.cmml" type="integer" xref="S4.E8.m1.19.19.19.4.4.4.1.1.3">2</cn></apply><cn id="S4.E8.m1.19.19.19.4.4.4.1.3.cmml" type="integer" xref="S4.E8.m1.19.19.19.4.4.4.1.3">2</cn></apply></apply><ci id="S4.E8.m1.20.20.20.5.5.5.1a.cmml" xref="S4.E8.m1.20.20.20.5.5.5.1"><mtext id="S4.E8.m1.20.20.20.5.5.5.1.cmml" mathsize="70%" xref="S4.E8.m1.20.20.20.5.5.5.1">(C) consistency loss</mtext></ci></apply></apply><apply id="S4.E8.m1.25.26.1.3.5.cmml" xref="S4.E8.m1.25.25"><times id="S4.E8.m1.25.26.1.3.5.1.cmml" xref="S4.E8.m1.25.25"></times><apply id="S4.E8.m1.25.26.1.3.5.2.cmml" xref="S4.E8.m1.25.25"><csymbol cd="ambiguous" id="S4.E8.m1.25.26.1.3.5.2.1.cmml" xref="S4.E8.m1.25.25">subscript</csymbol><ci id="S4.E8.m1.22.22.22.7.7.7.cmml" xref="S4.E8.m1.22.22.22.7.7.7">𝑐</ci><cn id="S4.E8.m1.23.23.23.8.8.8.1.cmml" type="integer" xref="S4.E8.m1.23.23.23.8.8.8.1">4</cn></apply><apply id="S4.E8.m1.25.26.1.3.5.3.cmml" xref="S4.E8.m1.25.25"><csymbol cd="ambiguous" id="S4.E8.m1.25.26.1.3.5.3.1.cmml" xref="S4.E8.m1.25.25">subscript</csymbol><apply id="S4.E8.m1.24.24.24.9.9.9.cmml" xref="S4.E8.m1.24.24.24.9.9.9"><ci id="S4.E8.m1.24.24.24.9.9.9.2.cmml" xref="S4.E8.m1.24.24.24.9.9.9.2">⏟</ci><apply id="S4.E8.m1.24.24.24.9.9.9.1.cmml" xref="S4.E8.m1.24.24.24.9.9.9.1"><csymbol cd="ambiguous" id="S4.E8.m1.24.24.24.9.9.9.1.2.cmml" xref="S4.E8.m1.24.24.24.9.9.9.1">superscript</csymbol><apply id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.cmml" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1"><minus id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.4.cmml" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.4"></minus><apply id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1.cmml" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1.2.cmml" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1">subscript</csymbol><apply id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1.1.2.cmml" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1.1.2.1.cmml" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1.1.1.2">norm</csymbol><apply id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1.1.1.1.cmml" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1.1.1.1"><minus id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1.1.1.1.3"></minus><apply id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1.1.1.1.1"><times id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1.1.1.1.1.2"></times><apply id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1.1.1.1.1.3.2">ℎ</ci><apply id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1.1.1.1.1.3.3">superscript</csymbol><ci id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1.1.1.1.1.3.3.2">𝜃</ci><ci id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1.1.1.1.1.3.3.3">ℎ</ci></apply></apply><apply id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1.1.1.1.1.1.1.1.2">𝑠</ci><ci id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑘</ci></apply></apply><apply id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1.1.1.1.2"><times id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1.1.1.1.2.2"></times><apply id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1.1.1.1.2.3.2">ℎ</ci><apply id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1.1.1.1.2.3.3"><csymbol cd="ambiguous" id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1.1.1.1.2.3.3.1.cmml" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1.1.1.1.2.3.3">superscript</csymbol><ci id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1.1.1.1.2.3.3.2.cmml" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1.1.1.1.2.3.3.2">𝜃</ci><ci id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1.1.1.1.2.3.3.3.cmml" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1.1.1.1.2.3.3.3">ℎ</ci></apply></apply><apply id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1.1.1.1.2.1.1.1.cmml" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1.1.1.1.2.1.1"><csymbol cd="ambiguous" id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1.1.1.1.2.1.1.1.1.cmml" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1.1.1.1.2.1.1">subscript</csymbol><apply id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1.1.1.1.2.1.1.1.2.cmml" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1.1.1.1.2.1.1.1.2"><ci id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1.1.1.1.2.1.1.1.2.1.cmml" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1.1.1.1.2.1.1.1.2.1">´</ci><ci id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1.1.1.1.2.1.1.1.2.2.cmml" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1.1.1.1.2.1.1.1.2.2">𝑠</ci></apply><ci id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1.1.1.1.2.1.1.1.3.cmml" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1.1.1.1.2.1.1.1.3">𝑘</ci></apply></apply></apply></apply><cn id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1.3.cmml" type="integer" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.1.3">1</cn></apply><apply id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.2.2.cmml" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.2.1"><abs id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.2.2.1.cmml" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.2.1.2"></abs><apply id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.2.1.1.cmml" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.2.1.1"><minus id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.2.1.1.1.cmml" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.2.1.1.1"></minus><apply id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.2.1.1.2.cmml" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.2.1.1.2"><csymbol cd="ambiguous" id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.2.1.1.2.1.cmml" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.2.1.1.2">subscript</csymbol><ci id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.2.1.1.2.2.cmml" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.2.1.1.2.2">𝑟</ci><ci id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.2.1.1.2.3.cmml" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.2.1.1.2.3">𝑘</ci></apply><apply id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.2.1.1.3.cmml" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.2.1.1.3"><csymbol cd="ambiguous" id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.2.1.1.3.1.cmml" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.2.1.1.3">subscript</csymbol><apply id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.2.1.1.3.2.cmml" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.2.1.1.3.2"><ci id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.2.1.1.3.2.1.cmml" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.2.1.1.3.2.1">´</ci><ci id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.2.1.1.3.2.2.cmml" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.2.1.1.3.2.2">𝑟</ci></apply><ci id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.2.1.1.3.3.cmml" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.2.1.1.3.3">𝑘</ci></apply></apply></apply><apply id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.3.cmml" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.3"><times id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.3.2.cmml" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.3.2"></times><ci id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.3.3.cmml" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.3.3">𝛾</ci><apply id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.3.1.cmml" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.3.1"><csymbol cd="ambiguous" id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.3.1.2.cmml" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.3.1">superscript</csymbol><apply id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.3.1.1.cmml" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.3.1"><csymbol cd="ambiguous" id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.3.1.1.2.cmml" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.3.1">subscript</csymbol><apply id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.3.1.1.1.2.cmml" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.3.1.1.1.1"><csymbol cd="latexml" id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.3.1.1.1.2.1.cmml" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.3.1.1.1.1.2">norm</csymbol><apply id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.3.1.1.1.1.1.cmml" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.3.1.1.1.1.1"><minus id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.3.1.1.1.1.1.1.cmml" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.3.1.1.1.1.1.1"></minus><apply id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.3.1.1.1.1.1.2.cmml" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.3.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.3.1.1.1.1.1.2.1.cmml" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.3.1.1.1.1.1.2">subscript</csymbol><apply id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.3.1.1.1.1.1.2.2.cmml" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.3.1.1.1.1.1.2.2"><ci id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.3.1.1.1.1.1.2.2.1.cmml" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.3.1.1.1.1.1.2.2.1">¯</ci><ci id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.3.1.1.1.1.1.2.2.2.cmml" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.3.1.1.1.1.1.2.2.2">𝑧</ci></apply><apply id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.3.1.1.1.1.1.2.3.cmml" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.3.1.1.1.1.1.2.3"><plus id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.3.1.1.1.1.1.2.3.1.cmml" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.3.1.1.1.1.1.2.3.1"></plus><ci id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.3.1.1.1.1.1.2.3.2.cmml" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.3.1.1.1.1.1.2.3.2">𝑘</ci><cn id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.3.1.1.1.1.1.2.3.3.cmml" type="integer" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.3.1.1.1.1.1.2.3.3">1</cn></apply></apply><apply id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.3.1.1.1.1.1.3.cmml" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.3.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.3.1.1.1.1.1.3.1.cmml" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.3.1.1.1.1.1.3">subscript</csymbol><apply id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.3.1.1.1.1.1.3.2.cmml" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.3.1.1.1.1.1.3.2"><ci id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.3.1.1.1.1.1.3.2.1.cmml" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.3.1.1.1.1.1.3.2.1">¯</ci><apply id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.3.1.1.1.1.1.3.2.2.cmml" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.3.1.1.1.1.1.3.2.2"><ci id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.3.1.1.1.1.1.3.2.2.1.cmml" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.3.1.1.1.1.1.3.2.2.1">´</ci><ci id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.3.1.1.1.1.1.3.2.2.2.cmml" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.3.1.1.1.1.1.3.2.2.2">𝑧</ci></apply></apply><apply id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.3.1.1.1.1.1.3.3.cmml" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.3.1.1.1.1.1.3.3"><plus id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.3.1.1.1.1.1.3.3.1.cmml" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.3.1.1.1.1.1.3.3.1"></plus><ci id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.3.1.1.1.1.1.3.3.2.cmml" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.3.1.1.1.1.1.3.3.2">𝑘</ci><cn id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.3.1.1.1.1.1.3.3.3.cmml" type="integer" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.3.1.1.1.1.1.3.3.3">1</cn></apply></apply></apply></apply><cn id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.3.1.1.3.cmml" type="integer" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.3.1.1.3">2</cn></apply><cn id="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.3.1.3.cmml" type="integer" xref="S4.E8.m1.24.24.24.9.9.9.1.1.1.1.3.1.3">2</cn></apply></apply></apply><cn id="S4.E8.m1.24.24.24.9.9.9.1.3.cmml" type="integer" xref="S4.E8.m1.24.24.24.9.9.9.1.3">2</cn></apply></apply><ci id="S4.E8.m1.25.25.25.10.10.10.1a.cmml" xref="S4.E8.m1.25.25.25.10.10.10.1"><mtext id="S4.E8.m1.25.25.25.10.10.10.1.cmml" mathsize="70%" xref="S4.E8.m1.25.25.25.10.10.10.1">(D) bisimulation metric loss</mtext></ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E8.m1.25c">\begin{split}&amp;{\mathcal{L}}_{k}(\theta)=c_{1}\underbrace{||{\mathcal{R}}_{%
\theta^{\mathcal{R}}}(z_{k},a_{k})-r_{k}||^{2}_{2}}_{\text{(A) reward loss}}+c%
_{2}\underbrace{\left\|Q_{\theta^{Q}}(z_{k},a_{k})-\left(r_{k}+\gamma Q_{\bar{%
\theta}^{Q}}(z_{k+1},\pi_{\theta^{\pi}}(z_{k+1}))\right)\right\|_{2}^{2}}_{%
\text{(B) state-action value loss}}\\
&amp;+c_{3}\underbrace{\left\|d_{\theta^{d}}(z_{k},a_{k})-h_{\bar{\theta}^{h}}(s_{%
k+1})\right\|_{2}^{2}}_{\text{(C) consistency loss}}+c_{4}\underbrace{\left(\|%
h_{\theta^{h}}(s_{k})-h_{\theta^{h}}(\acute{s}_{k})\|_{1}-|r_{k}-\acute{r}_{k}%
|-\gamma||\bar{z}_{k+1}-\bar{\acute{z}}_{k+1}||_{2}^{2}\right)^{2}}_{\text{(D)%
 bisimulation metric loss}}\end{split}</annotation><annotation encoding="application/x-llamapun" id="S4.E8.m1.25d">start_ROW start_CELL end_CELL start_CELL caligraphic_L start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ( italic_θ ) = italic_c start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT under⏟ start_ARG | | caligraphic_R start_POSTSUBSCRIPT italic_θ start_POSTSUPERSCRIPT caligraphic_R end_POSTSUPERSCRIPT end_POSTSUBSCRIPT ( italic_z start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT , italic_a start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ) - italic_r start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT | | start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_ARG start_POSTSUBSCRIPT (A) reward loss end_POSTSUBSCRIPT + italic_c start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT under⏟ start_ARG ∥ italic_Q start_POSTSUBSCRIPT italic_θ start_POSTSUPERSCRIPT italic_Q end_POSTSUPERSCRIPT end_POSTSUBSCRIPT ( italic_z start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT , italic_a start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ) - ( italic_r start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT + italic_γ italic_Q start_POSTSUBSCRIPT over¯ start_ARG italic_θ end_ARG start_POSTSUPERSCRIPT italic_Q end_POSTSUPERSCRIPT end_POSTSUBSCRIPT ( italic_z start_POSTSUBSCRIPT italic_k + 1 end_POSTSUBSCRIPT , italic_π start_POSTSUBSCRIPT italic_θ start_POSTSUPERSCRIPT italic_π end_POSTSUPERSCRIPT end_POSTSUBSCRIPT ( italic_z start_POSTSUBSCRIPT italic_k + 1 end_POSTSUBSCRIPT ) ) ) ∥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG start_POSTSUBSCRIPT (B) state-action value loss end_POSTSUBSCRIPT end_CELL end_ROW start_ROW start_CELL end_CELL start_CELL + italic_c start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT under⏟ start_ARG ∥ italic_d start_POSTSUBSCRIPT italic_θ start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT end_POSTSUBSCRIPT ( italic_z start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT , italic_a start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ) - italic_h start_POSTSUBSCRIPT over¯ start_ARG italic_θ end_ARG start_POSTSUPERSCRIPT italic_h end_POSTSUPERSCRIPT end_POSTSUBSCRIPT ( italic_s start_POSTSUBSCRIPT italic_k + 1 end_POSTSUBSCRIPT ) ∥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG start_POSTSUBSCRIPT (C) consistency loss end_POSTSUBSCRIPT + italic_c start_POSTSUBSCRIPT 4 end_POSTSUBSCRIPT under⏟ start_ARG ( ∥ italic_h start_POSTSUBSCRIPT italic_θ start_POSTSUPERSCRIPT italic_h end_POSTSUPERSCRIPT end_POSTSUBSCRIPT ( italic_s start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ) - italic_h start_POSTSUBSCRIPT italic_θ start_POSTSUPERSCRIPT italic_h end_POSTSUPERSCRIPT end_POSTSUBSCRIPT ( over´ start_ARG italic_s end_ARG start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ) ∥ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT - | italic_r start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT - over´ start_ARG italic_r end_ARG start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT | - italic_γ | | over¯ start_ARG italic_z end_ARG start_POSTSUBSCRIPT italic_k + 1 end_POSTSUBSCRIPT - over¯ start_ARG over´ start_ARG italic_z end_ARG end_ARG start_POSTSUBSCRIPT italic_k + 1 end_POSTSUBSCRIPT | | start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG start_POSTSUBSCRIPT (D) bisimulation metric loss end_POSTSUBSCRIPT end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS1.SSS0.Px2.p1.11">where <math alttext="\acute{\bullet}_{k}=\mathrm{permute}(\bullet_{k})" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px2.p1.2.m1.1"><semantics id="S4.SS1.SSS0.Px2.p1.2.m1.1a"><mrow id="S4.SS1.SSS0.Px2.p1.2.m1.1.1" xref="S4.SS1.SSS0.Px2.p1.2.m1.1.1.cmml"><msub id="S4.SS1.SSS0.Px2.p1.2.m1.1.1.3" xref="S4.SS1.SSS0.Px2.p1.2.m1.1.1.3.cmml"><mover accent="true" id="S4.SS1.SSS0.Px2.p1.2.m1.1.1.3.2" xref="S4.SS1.SSS0.Px2.p1.2.m1.1.1.3.2.cmml"><mo id="S4.SS1.SSS0.Px2.p1.2.m1.1.1.3.2.2" xref="S4.SS1.SSS0.Px2.p1.2.m1.1.1.3.2.2.cmml">∙</mo><mo id="S4.SS1.SSS0.Px2.p1.2.m1.1.1.3.2.1" xref="S4.SS1.SSS0.Px2.p1.2.m1.1.1.3.2.1.cmml">´</mo></mover><mi id="S4.SS1.SSS0.Px2.p1.2.m1.1.1.3.3" xref="S4.SS1.SSS0.Px2.p1.2.m1.1.1.3.3.cmml">k</mi></msub><mo id="S4.SS1.SSS0.Px2.p1.2.m1.1.1.2" lspace="0em" xref="S4.SS1.SSS0.Px2.p1.2.m1.1.1.2.cmml">=</mo><mrow id="S4.SS1.SSS0.Px2.p1.2.m1.1.1.1" xref="S4.SS1.SSS0.Px2.p1.2.m1.1.1.1.cmml"><mi id="S4.SS1.SSS0.Px2.p1.2.m1.1.1.1.3" xref="S4.SS1.SSS0.Px2.p1.2.m1.1.1.1.3.cmml">permute</mi><mo id="S4.SS1.SSS0.Px2.p1.2.m1.1.1.1.2" xref="S4.SS1.SSS0.Px2.p1.2.m1.1.1.1.2.cmml">⁢</mo><mrow id="S4.SS1.SSS0.Px2.p1.2.m1.1.1.1.1.1" xref="S4.SS1.SSS0.Px2.p1.2.m1.1.1.1.1.1.1.cmml"><mo id="S4.SS1.SSS0.Px2.p1.2.m1.1.1.1.1.1.2" stretchy="false" xref="S4.SS1.SSS0.Px2.p1.2.m1.1.1.1.1.1.1.cmml">(</mo><msub id="S4.SS1.SSS0.Px2.p1.2.m1.1.1.1.1.1.1" xref="S4.SS1.SSS0.Px2.p1.2.m1.1.1.1.1.1.1.cmml"><mo id="S4.SS1.SSS0.Px2.p1.2.m1.1.1.1.1.1.1.2" lspace="0em" rspace="0em" xref="S4.SS1.SSS0.Px2.p1.2.m1.1.1.1.1.1.1.2.cmml">∙</mo><mi id="S4.SS1.SSS0.Px2.p1.2.m1.1.1.1.1.1.1.3" xref="S4.SS1.SSS0.Px2.p1.2.m1.1.1.1.1.1.1.3.cmml">k</mi></msub><mo id="S4.SS1.SSS0.Px2.p1.2.m1.1.1.1.1.1.3" stretchy="false" xref="S4.SS1.SSS0.Px2.p1.2.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px2.p1.2.m1.1b"><apply id="S4.SS1.SSS0.Px2.p1.2.m1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.2.m1.1.1"><eq id="S4.SS1.SSS0.Px2.p1.2.m1.1.1.2.cmml" xref="S4.SS1.SSS0.Px2.p1.2.m1.1.1.2"></eq><apply id="S4.SS1.SSS0.Px2.p1.2.m1.1.1.3.cmml" xref="S4.SS1.SSS0.Px2.p1.2.m1.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px2.p1.2.m1.1.1.3.1.cmml" xref="S4.SS1.SSS0.Px2.p1.2.m1.1.1.3">subscript</csymbol><apply id="S4.SS1.SSS0.Px2.p1.2.m1.1.1.3.2.cmml" xref="S4.SS1.SSS0.Px2.p1.2.m1.1.1.3.2"><ci id="S4.SS1.SSS0.Px2.p1.2.m1.1.1.3.2.1.cmml" xref="S4.SS1.SSS0.Px2.p1.2.m1.1.1.3.2.1">´</ci><ci id="S4.SS1.SSS0.Px2.p1.2.m1.1.1.3.2.2.cmml" xref="S4.SS1.SSS0.Px2.p1.2.m1.1.1.3.2.2">∙</ci></apply><ci id="S4.SS1.SSS0.Px2.p1.2.m1.1.1.3.3.cmml" xref="S4.SS1.SSS0.Px2.p1.2.m1.1.1.3.3">𝑘</ci></apply><apply id="S4.SS1.SSS0.Px2.p1.2.m1.1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.2.m1.1.1.1"><times id="S4.SS1.SSS0.Px2.p1.2.m1.1.1.1.2.cmml" xref="S4.SS1.SSS0.Px2.p1.2.m1.1.1.1.2"></times><ci id="S4.SS1.SSS0.Px2.p1.2.m1.1.1.1.3.cmml" xref="S4.SS1.SSS0.Px2.p1.2.m1.1.1.1.3">permute</ci><apply id="S4.SS1.SSS0.Px2.p1.2.m1.1.1.1.1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.2.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px2.p1.2.m1.1.1.1.1.1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.2.m1.1.1.1.1.1">subscript</csymbol><ci id="S4.SS1.SSS0.Px2.p1.2.m1.1.1.1.1.1.1.2.cmml" xref="S4.SS1.SSS0.Px2.p1.2.m1.1.1.1.1.1.1.2">∙</ci><ci id="S4.SS1.SSS0.Px2.p1.2.m1.1.1.1.1.1.1.3.cmml" xref="S4.SS1.SSS0.Px2.p1.2.m1.1.1.1.1.1.1.3">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px2.p1.2.m1.1c">\acute{\bullet}_{k}=\mathrm{permute}(\bullet_{k})</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px2.p1.2.m1.1d">over´ start_ARG ∙ end_ARG start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT = roman_permute ( ∙ start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT )</annotation></semantics></math> and <math alttext="\bar{z}_{k+1}=d_{\bar{\theta}^{d}}(z_{k},a_{k})" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px2.p1.3.m2.2"><semantics id="S4.SS1.SSS0.Px2.p1.3.m2.2a"><mrow id="S4.SS1.SSS0.Px2.p1.3.m2.2.2" xref="S4.SS1.SSS0.Px2.p1.3.m2.2.2.cmml"><msub id="S4.SS1.SSS0.Px2.p1.3.m2.2.2.4" xref="S4.SS1.SSS0.Px2.p1.3.m2.2.2.4.cmml"><mover accent="true" id="S4.SS1.SSS0.Px2.p1.3.m2.2.2.4.2" xref="S4.SS1.SSS0.Px2.p1.3.m2.2.2.4.2.cmml"><mi id="S4.SS1.SSS0.Px2.p1.3.m2.2.2.4.2.2" xref="S4.SS1.SSS0.Px2.p1.3.m2.2.2.4.2.2.cmml">z</mi><mo id="S4.SS1.SSS0.Px2.p1.3.m2.2.2.4.2.1" xref="S4.SS1.SSS0.Px2.p1.3.m2.2.2.4.2.1.cmml">¯</mo></mover><mrow id="S4.SS1.SSS0.Px2.p1.3.m2.2.2.4.3" xref="S4.SS1.SSS0.Px2.p1.3.m2.2.2.4.3.cmml"><mi id="S4.SS1.SSS0.Px2.p1.3.m2.2.2.4.3.2" xref="S4.SS1.SSS0.Px2.p1.3.m2.2.2.4.3.2.cmml">k</mi><mo id="S4.SS1.SSS0.Px2.p1.3.m2.2.2.4.3.1" xref="S4.SS1.SSS0.Px2.p1.3.m2.2.2.4.3.1.cmml">+</mo><mn id="S4.SS1.SSS0.Px2.p1.3.m2.2.2.4.3.3" xref="S4.SS1.SSS0.Px2.p1.3.m2.2.2.4.3.3.cmml">1</mn></mrow></msub><mo id="S4.SS1.SSS0.Px2.p1.3.m2.2.2.3" xref="S4.SS1.SSS0.Px2.p1.3.m2.2.2.3.cmml">=</mo><mrow id="S4.SS1.SSS0.Px2.p1.3.m2.2.2.2" xref="S4.SS1.SSS0.Px2.p1.3.m2.2.2.2.cmml"><msub id="S4.SS1.SSS0.Px2.p1.3.m2.2.2.2.4" xref="S4.SS1.SSS0.Px2.p1.3.m2.2.2.2.4.cmml"><mi id="S4.SS1.SSS0.Px2.p1.3.m2.2.2.2.4.2" xref="S4.SS1.SSS0.Px2.p1.3.m2.2.2.2.4.2.cmml">d</mi><msup id="S4.SS1.SSS0.Px2.p1.3.m2.2.2.2.4.3" xref="S4.SS1.SSS0.Px2.p1.3.m2.2.2.2.4.3.cmml"><mover accent="true" id="S4.SS1.SSS0.Px2.p1.3.m2.2.2.2.4.3.2" xref="S4.SS1.SSS0.Px2.p1.3.m2.2.2.2.4.3.2.cmml"><mi id="S4.SS1.SSS0.Px2.p1.3.m2.2.2.2.4.3.2.2" xref="S4.SS1.SSS0.Px2.p1.3.m2.2.2.2.4.3.2.2.cmml">θ</mi><mo id="S4.SS1.SSS0.Px2.p1.3.m2.2.2.2.4.3.2.1" xref="S4.SS1.SSS0.Px2.p1.3.m2.2.2.2.4.3.2.1.cmml">¯</mo></mover><mi id="S4.SS1.SSS0.Px2.p1.3.m2.2.2.2.4.3.3" xref="S4.SS1.SSS0.Px2.p1.3.m2.2.2.2.4.3.3.cmml">d</mi></msup></msub><mo id="S4.SS1.SSS0.Px2.p1.3.m2.2.2.2.3" xref="S4.SS1.SSS0.Px2.p1.3.m2.2.2.2.3.cmml">⁢</mo><mrow id="S4.SS1.SSS0.Px2.p1.3.m2.2.2.2.2.2" xref="S4.SS1.SSS0.Px2.p1.3.m2.2.2.2.2.3.cmml"><mo id="S4.SS1.SSS0.Px2.p1.3.m2.2.2.2.2.2.3" stretchy="false" xref="S4.SS1.SSS0.Px2.p1.3.m2.2.2.2.2.3.cmml">(</mo><msub id="S4.SS1.SSS0.Px2.p1.3.m2.1.1.1.1.1.1" xref="S4.SS1.SSS0.Px2.p1.3.m2.1.1.1.1.1.1.cmml"><mi id="S4.SS1.SSS0.Px2.p1.3.m2.1.1.1.1.1.1.2" xref="S4.SS1.SSS0.Px2.p1.3.m2.1.1.1.1.1.1.2.cmml">z</mi><mi id="S4.SS1.SSS0.Px2.p1.3.m2.1.1.1.1.1.1.3" xref="S4.SS1.SSS0.Px2.p1.3.m2.1.1.1.1.1.1.3.cmml">k</mi></msub><mo id="S4.SS1.SSS0.Px2.p1.3.m2.2.2.2.2.2.4" xref="S4.SS1.SSS0.Px2.p1.3.m2.2.2.2.2.3.cmml">,</mo><msub id="S4.SS1.SSS0.Px2.p1.3.m2.2.2.2.2.2.2" xref="S4.SS1.SSS0.Px2.p1.3.m2.2.2.2.2.2.2.cmml"><mi id="S4.SS1.SSS0.Px2.p1.3.m2.2.2.2.2.2.2.2" xref="S4.SS1.SSS0.Px2.p1.3.m2.2.2.2.2.2.2.2.cmml">a</mi><mi id="S4.SS1.SSS0.Px2.p1.3.m2.2.2.2.2.2.2.3" xref="S4.SS1.SSS0.Px2.p1.3.m2.2.2.2.2.2.2.3.cmml">k</mi></msub><mo id="S4.SS1.SSS0.Px2.p1.3.m2.2.2.2.2.2.5" stretchy="false" xref="S4.SS1.SSS0.Px2.p1.3.m2.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px2.p1.3.m2.2b"><apply id="S4.SS1.SSS0.Px2.p1.3.m2.2.2.cmml" xref="S4.SS1.SSS0.Px2.p1.3.m2.2.2"><eq id="S4.SS1.SSS0.Px2.p1.3.m2.2.2.3.cmml" xref="S4.SS1.SSS0.Px2.p1.3.m2.2.2.3"></eq><apply id="S4.SS1.SSS0.Px2.p1.3.m2.2.2.4.cmml" xref="S4.SS1.SSS0.Px2.p1.3.m2.2.2.4"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px2.p1.3.m2.2.2.4.1.cmml" xref="S4.SS1.SSS0.Px2.p1.3.m2.2.2.4">subscript</csymbol><apply id="S4.SS1.SSS0.Px2.p1.3.m2.2.2.4.2.cmml" xref="S4.SS1.SSS0.Px2.p1.3.m2.2.2.4.2"><ci id="S4.SS1.SSS0.Px2.p1.3.m2.2.2.4.2.1.cmml" xref="S4.SS1.SSS0.Px2.p1.3.m2.2.2.4.2.1">¯</ci><ci id="S4.SS1.SSS0.Px2.p1.3.m2.2.2.4.2.2.cmml" xref="S4.SS1.SSS0.Px2.p1.3.m2.2.2.4.2.2">𝑧</ci></apply><apply id="S4.SS1.SSS0.Px2.p1.3.m2.2.2.4.3.cmml" xref="S4.SS1.SSS0.Px2.p1.3.m2.2.2.4.3"><plus id="S4.SS1.SSS0.Px2.p1.3.m2.2.2.4.3.1.cmml" xref="S4.SS1.SSS0.Px2.p1.3.m2.2.2.4.3.1"></plus><ci id="S4.SS1.SSS0.Px2.p1.3.m2.2.2.4.3.2.cmml" xref="S4.SS1.SSS0.Px2.p1.3.m2.2.2.4.3.2">𝑘</ci><cn id="S4.SS1.SSS0.Px2.p1.3.m2.2.2.4.3.3.cmml" type="integer" xref="S4.SS1.SSS0.Px2.p1.3.m2.2.2.4.3.3">1</cn></apply></apply><apply id="S4.SS1.SSS0.Px2.p1.3.m2.2.2.2.cmml" xref="S4.SS1.SSS0.Px2.p1.3.m2.2.2.2"><times id="S4.SS1.SSS0.Px2.p1.3.m2.2.2.2.3.cmml" xref="S4.SS1.SSS0.Px2.p1.3.m2.2.2.2.3"></times><apply id="S4.SS1.SSS0.Px2.p1.3.m2.2.2.2.4.cmml" xref="S4.SS1.SSS0.Px2.p1.3.m2.2.2.2.4"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px2.p1.3.m2.2.2.2.4.1.cmml" xref="S4.SS1.SSS0.Px2.p1.3.m2.2.2.2.4">subscript</csymbol><ci id="S4.SS1.SSS0.Px2.p1.3.m2.2.2.2.4.2.cmml" xref="S4.SS1.SSS0.Px2.p1.3.m2.2.2.2.4.2">𝑑</ci><apply id="S4.SS1.SSS0.Px2.p1.3.m2.2.2.2.4.3.cmml" xref="S4.SS1.SSS0.Px2.p1.3.m2.2.2.2.4.3"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px2.p1.3.m2.2.2.2.4.3.1.cmml" xref="S4.SS1.SSS0.Px2.p1.3.m2.2.2.2.4.3">superscript</csymbol><apply id="S4.SS1.SSS0.Px2.p1.3.m2.2.2.2.4.3.2.cmml" xref="S4.SS1.SSS0.Px2.p1.3.m2.2.2.2.4.3.2"><ci id="S4.SS1.SSS0.Px2.p1.3.m2.2.2.2.4.3.2.1.cmml" xref="S4.SS1.SSS0.Px2.p1.3.m2.2.2.2.4.3.2.1">¯</ci><ci id="S4.SS1.SSS0.Px2.p1.3.m2.2.2.2.4.3.2.2.cmml" xref="S4.SS1.SSS0.Px2.p1.3.m2.2.2.2.4.3.2.2">𝜃</ci></apply><ci id="S4.SS1.SSS0.Px2.p1.3.m2.2.2.2.4.3.3.cmml" xref="S4.SS1.SSS0.Px2.p1.3.m2.2.2.2.4.3.3">𝑑</ci></apply></apply><interval closure="open" id="S4.SS1.SSS0.Px2.p1.3.m2.2.2.2.2.3.cmml" xref="S4.SS1.SSS0.Px2.p1.3.m2.2.2.2.2.2"><apply id="S4.SS1.SSS0.Px2.p1.3.m2.1.1.1.1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.3.m2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px2.p1.3.m2.1.1.1.1.1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.3.m2.1.1.1.1.1.1">subscript</csymbol><ci id="S4.SS1.SSS0.Px2.p1.3.m2.1.1.1.1.1.1.2.cmml" xref="S4.SS1.SSS0.Px2.p1.3.m2.1.1.1.1.1.1.2">𝑧</ci><ci id="S4.SS1.SSS0.Px2.p1.3.m2.1.1.1.1.1.1.3.cmml" xref="S4.SS1.SSS0.Px2.p1.3.m2.1.1.1.1.1.1.3">𝑘</ci></apply><apply id="S4.SS1.SSS0.Px2.p1.3.m2.2.2.2.2.2.2.cmml" xref="S4.SS1.SSS0.Px2.p1.3.m2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px2.p1.3.m2.2.2.2.2.2.2.1.cmml" xref="S4.SS1.SSS0.Px2.p1.3.m2.2.2.2.2.2.2">subscript</csymbol><ci id="S4.SS1.SSS0.Px2.p1.3.m2.2.2.2.2.2.2.2.cmml" xref="S4.SS1.SSS0.Px2.p1.3.m2.2.2.2.2.2.2.2">𝑎</ci><ci id="S4.SS1.SSS0.Px2.p1.3.m2.2.2.2.2.2.2.3.cmml" xref="S4.SS1.SSS0.Px2.p1.3.m2.2.2.2.2.2.2.3">𝑘</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px2.p1.3.m2.2c">\bar{z}_{k+1}=d_{\bar{\theta}^{d}}(z_{k},a_{k})</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px2.p1.3.m2.2d">over¯ start_ARG italic_z end_ARG start_POSTSUBSCRIPT italic_k + 1 end_POSTSUBSCRIPT = italic_d start_POSTSUBSCRIPT over¯ start_ARG italic_θ end_ARG start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT end_POSTSUBSCRIPT ( italic_z start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT , italic_a start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT )</annotation></semantics></math>. <math alttext="c_{1},c_{2},c_{3},c_{4}" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px2.p1.4.m3.4"><semantics id="S4.SS1.SSS0.Px2.p1.4.m3.4a"><mrow id="S4.SS1.SSS0.Px2.p1.4.m3.4.4.4" xref="S4.SS1.SSS0.Px2.p1.4.m3.4.4.5.cmml"><msub id="S4.SS1.SSS0.Px2.p1.4.m3.1.1.1.1" xref="S4.SS1.SSS0.Px2.p1.4.m3.1.1.1.1.cmml"><mi id="S4.SS1.SSS0.Px2.p1.4.m3.1.1.1.1.2" xref="S4.SS1.SSS0.Px2.p1.4.m3.1.1.1.1.2.cmml">c</mi><mn id="S4.SS1.SSS0.Px2.p1.4.m3.1.1.1.1.3" xref="S4.SS1.SSS0.Px2.p1.4.m3.1.1.1.1.3.cmml">1</mn></msub><mo id="S4.SS1.SSS0.Px2.p1.4.m3.4.4.4.5" xref="S4.SS1.SSS0.Px2.p1.4.m3.4.4.5.cmml">,</mo><msub id="S4.SS1.SSS0.Px2.p1.4.m3.2.2.2.2" xref="S4.SS1.SSS0.Px2.p1.4.m3.2.2.2.2.cmml"><mi id="S4.SS1.SSS0.Px2.p1.4.m3.2.2.2.2.2" xref="S4.SS1.SSS0.Px2.p1.4.m3.2.2.2.2.2.cmml">c</mi><mn id="S4.SS1.SSS0.Px2.p1.4.m3.2.2.2.2.3" xref="S4.SS1.SSS0.Px2.p1.4.m3.2.2.2.2.3.cmml">2</mn></msub><mo id="S4.SS1.SSS0.Px2.p1.4.m3.4.4.4.6" xref="S4.SS1.SSS0.Px2.p1.4.m3.4.4.5.cmml">,</mo><msub id="S4.SS1.SSS0.Px2.p1.4.m3.3.3.3.3" xref="S4.SS1.SSS0.Px2.p1.4.m3.3.3.3.3.cmml"><mi id="S4.SS1.SSS0.Px2.p1.4.m3.3.3.3.3.2" xref="S4.SS1.SSS0.Px2.p1.4.m3.3.3.3.3.2.cmml">c</mi><mn id="S4.SS1.SSS0.Px2.p1.4.m3.3.3.3.3.3" xref="S4.SS1.SSS0.Px2.p1.4.m3.3.3.3.3.3.cmml">3</mn></msub><mo id="S4.SS1.SSS0.Px2.p1.4.m3.4.4.4.7" xref="S4.SS1.SSS0.Px2.p1.4.m3.4.4.5.cmml">,</mo><msub id="S4.SS1.SSS0.Px2.p1.4.m3.4.4.4.4" xref="S4.SS1.SSS0.Px2.p1.4.m3.4.4.4.4.cmml"><mi id="S4.SS1.SSS0.Px2.p1.4.m3.4.4.4.4.2" xref="S4.SS1.SSS0.Px2.p1.4.m3.4.4.4.4.2.cmml">c</mi><mn id="S4.SS1.SSS0.Px2.p1.4.m3.4.4.4.4.3" xref="S4.SS1.SSS0.Px2.p1.4.m3.4.4.4.4.3.cmml">4</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px2.p1.4.m3.4b"><list id="S4.SS1.SSS0.Px2.p1.4.m3.4.4.5.cmml" xref="S4.SS1.SSS0.Px2.p1.4.m3.4.4.4"><apply id="S4.SS1.SSS0.Px2.p1.4.m3.1.1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.4.m3.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px2.p1.4.m3.1.1.1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.4.m3.1.1.1.1">subscript</csymbol><ci id="S4.SS1.SSS0.Px2.p1.4.m3.1.1.1.1.2.cmml" xref="S4.SS1.SSS0.Px2.p1.4.m3.1.1.1.1.2">𝑐</ci><cn id="S4.SS1.SSS0.Px2.p1.4.m3.1.1.1.1.3.cmml" type="integer" xref="S4.SS1.SSS0.Px2.p1.4.m3.1.1.1.1.3">1</cn></apply><apply id="S4.SS1.SSS0.Px2.p1.4.m3.2.2.2.2.cmml" xref="S4.SS1.SSS0.Px2.p1.4.m3.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px2.p1.4.m3.2.2.2.2.1.cmml" xref="S4.SS1.SSS0.Px2.p1.4.m3.2.2.2.2">subscript</csymbol><ci id="S4.SS1.SSS0.Px2.p1.4.m3.2.2.2.2.2.cmml" xref="S4.SS1.SSS0.Px2.p1.4.m3.2.2.2.2.2">𝑐</ci><cn id="S4.SS1.SSS0.Px2.p1.4.m3.2.2.2.2.3.cmml" type="integer" xref="S4.SS1.SSS0.Px2.p1.4.m3.2.2.2.2.3">2</cn></apply><apply id="S4.SS1.SSS0.Px2.p1.4.m3.3.3.3.3.cmml" xref="S4.SS1.SSS0.Px2.p1.4.m3.3.3.3.3"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px2.p1.4.m3.3.3.3.3.1.cmml" xref="S4.SS1.SSS0.Px2.p1.4.m3.3.3.3.3">subscript</csymbol><ci id="S4.SS1.SSS0.Px2.p1.4.m3.3.3.3.3.2.cmml" xref="S4.SS1.SSS0.Px2.p1.4.m3.3.3.3.3.2">𝑐</ci><cn id="S4.SS1.SSS0.Px2.p1.4.m3.3.3.3.3.3.cmml" type="integer" xref="S4.SS1.SSS0.Px2.p1.4.m3.3.3.3.3.3">3</cn></apply><apply id="S4.SS1.SSS0.Px2.p1.4.m3.4.4.4.4.cmml" xref="S4.SS1.SSS0.Px2.p1.4.m3.4.4.4.4"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px2.p1.4.m3.4.4.4.4.1.cmml" xref="S4.SS1.SSS0.Px2.p1.4.m3.4.4.4.4">subscript</csymbol><ci id="S4.SS1.SSS0.Px2.p1.4.m3.4.4.4.4.2.cmml" xref="S4.SS1.SSS0.Px2.p1.4.m3.4.4.4.4.2">𝑐</ci><cn id="S4.SS1.SSS0.Px2.p1.4.m3.4.4.4.4.3.cmml" type="integer" xref="S4.SS1.SSS0.Px2.p1.4.m3.4.4.4.4.3">4</cn></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px2.p1.4.m3.4c">c_{1},c_{2},c_{3},c_{4}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px2.p1.4.m3.4d">italic_c start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_c start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , italic_c start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT , italic_c start_POSTSUBSCRIPT 4 end_POSTSUBSCRIPT</annotation></semantics></math> are parameters that can change the weight of each loss.
The last term is an expansion of Eq. <a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#S3.E5" title="In 3.2 Bisimulation Metric ‣ 3 Preliminaries ‣ Bisimulation metric for Model Predictive Control"><span class="ltx_text ltx_ref_tag">5</span></a>, under the assumption that the model outputs deterministic predictions, corresponding to a Dirac delta distribution (i.e., a Gaussian distribution with zero variance).
As in TD-MPC, we use the same three loss components: (A) reward loss, (B) state-value action loss, and (C) consistency loss. Each training loss aims to update its corresponding parameters, i.e. reward parameter <math alttext="\theta^{{\mathcal{R}}}" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px2.p1.5.m4.1"><semantics id="S4.SS1.SSS0.Px2.p1.5.m4.1a"><msup id="S4.SS1.SSS0.Px2.p1.5.m4.1.1" xref="S4.SS1.SSS0.Px2.p1.5.m4.1.1.cmml"><mi id="S4.SS1.SSS0.Px2.p1.5.m4.1.1.2" xref="S4.SS1.SSS0.Px2.p1.5.m4.1.1.2.cmml">θ</mi><mi class="ltx_font_mathcaligraphic" id="S4.SS1.SSS0.Px2.p1.5.m4.1.1.3" xref="S4.SS1.SSS0.Px2.p1.5.m4.1.1.3.cmml">ℛ</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px2.p1.5.m4.1b"><apply id="S4.SS1.SSS0.Px2.p1.5.m4.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.5.m4.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px2.p1.5.m4.1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.5.m4.1.1">superscript</csymbol><ci id="S4.SS1.SSS0.Px2.p1.5.m4.1.1.2.cmml" xref="S4.SS1.SSS0.Px2.p1.5.m4.1.1.2">𝜃</ci><ci id="S4.SS1.SSS0.Px2.p1.5.m4.1.1.3.cmml" xref="S4.SS1.SSS0.Px2.p1.5.m4.1.1.3">ℛ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px2.p1.5.m4.1c">\theta^{{\mathcal{R}}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px2.p1.5.m4.1d">italic_θ start_POSTSUPERSCRIPT caligraphic_R end_POSTSUPERSCRIPT</annotation></semantics></math>, state-action value parameter <math alttext="\theta^{Q}" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px2.p1.6.m5.1"><semantics id="S4.SS1.SSS0.Px2.p1.6.m5.1a"><msup id="S4.SS1.SSS0.Px2.p1.6.m5.1.1" xref="S4.SS1.SSS0.Px2.p1.6.m5.1.1.cmml"><mi id="S4.SS1.SSS0.Px2.p1.6.m5.1.1.2" xref="S4.SS1.SSS0.Px2.p1.6.m5.1.1.2.cmml">θ</mi><mi id="S4.SS1.SSS0.Px2.p1.6.m5.1.1.3" xref="S4.SS1.SSS0.Px2.p1.6.m5.1.1.3.cmml">Q</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px2.p1.6.m5.1b"><apply id="S4.SS1.SSS0.Px2.p1.6.m5.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.6.m5.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px2.p1.6.m5.1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.6.m5.1.1">superscript</csymbol><ci id="S4.SS1.SSS0.Px2.p1.6.m5.1.1.2.cmml" xref="S4.SS1.SSS0.Px2.p1.6.m5.1.1.2">𝜃</ci><ci id="S4.SS1.SSS0.Px2.p1.6.m5.1.1.3.cmml" xref="S4.SS1.SSS0.Px2.p1.6.m5.1.1.3">𝑄</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px2.p1.6.m5.1c">\theta^{Q}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px2.p1.6.m5.1d">italic_θ start_POSTSUPERSCRIPT italic_Q end_POSTSUPERSCRIPT</annotation></semantics></math>, and dynamics parameter <math alttext="\theta^{d}" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px2.p1.7.m6.1"><semantics id="S4.SS1.SSS0.Px2.p1.7.m6.1a"><msup id="S4.SS1.SSS0.Px2.p1.7.m6.1.1" xref="S4.SS1.SSS0.Px2.p1.7.m6.1.1.cmml"><mi id="S4.SS1.SSS0.Px2.p1.7.m6.1.1.2" xref="S4.SS1.SSS0.Px2.p1.7.m6.1.1.2.cmml">θ</mi><mi id="S4.SS1.SSS0.Px2.p1.7.m6.1.1.3" xref="S4.SS1.SSS0.Px2.p1.7.m6.1.1.3.cmml">d</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px2.p1.7.m6.1b"><apply id="S4.SS1.SSS0.Px2.p1.7.m6.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.7.m6.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px2.p1.7.m6.1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.7.m6.1.1">superscript</csymbol><ci id="S4.SS1.SSS0.Px2.p1.7.m6.1.1.2.cmml" xref="S4.SS1.SSS0.Px2.p1.7.m6.1.1.2">𝜃</ci><ci id="S4.SS1.SSS0.Px2.p1.7.m6.1.1.3.cmml" xref="S4.SS1.SSS0.Px2.p1.7.m6.1.1.3">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px2.p1.7.m6.1c">\theta^{d}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px2.p1.7.m6.1d">italic_θ start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT</annotation></semantics></math>. These losses also help to update the encoder parameter <math alttext="\theta^{h}" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px2.p1.8.m7.1"><semantics id="S4.SS1.SSS0.Px2.p1.8.m7.1a"><msup id="S4.SS1.SSS0.Px2.p1.8.m7.1.1" xref="S4.SS1.SSS0.Px2.p1.8.m7.1.1.cmml"><mi id="S4.SS1.SSS0.Px2.p1.8.m7.1.1.2" xref="S4.SS1.SSS0.Px2.p1.8.m7.1.1.2.cmml">θ</mi><mi id="S4.SS1.SSS0.Px2.p1.8.m7.1.1.3" xref="S4.SS1.SSS0.Px2.p1.8.m7.1.1.3.cmml">h</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px2.p1.8.m7.1b"><apply id="S4.SS1.SSS0.Px2.p1.8.m7.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.8.m7.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px2.p1.8.m7.1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.8.m7.1.1">superscript</csymbol><ci id="S4.SS1.SSS0.Px2.p1.8.m7.1.1.2.cmml" xref="S4.SS1.SSS0.Px2.p1.8.m7.1.1.2">𝜃</ci><ci id="S4.SS1.SSS0.Px2.p1.8.m7.1.1.3.cmml" xref="S4.SS1.SSS0.Px2.p1.8.m7.1.1.3">ℎ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px2.p1.8.m7.1c">\theta^{h}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px2.p1.8.m7.1d">italic_θ start_POSTSUPERSCRIPT italic_h end_POSTSUPERSCRIPT</annotation></semantics></math> by using the derivative of the composition function. In addition to these losses, BS-MPC includes a bisimulation metric loss in its objective function, which explicitly depends on the encoder parameters <math alttext="\theta^{h}" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px2.p1.9.m8.1"><semantics id="S4.SS1.SSS0.Px2.p1.9.m8.1a"><msup id="S4.SS1.SSS0.Px2.p1.9.m8.1.1" xref="S4.SS1.SSS0.Px2.p1.9.m8.1.1.cmml"><mi id="S4.SS1.SSS0.Px2.p1.9.m8.1.1.2" xref="S4.SS1.SSS0.Px2.p1.9.m8.1.1.2.cmml">θ</mi><mi id="S4.SS1.SSS0.Px2.p1.9.m8.1.1.3" xref="S4.SS1.SSS0.Px2.p1.9.m8.1.1.3.cmml">h</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px2.p1.9.m8.1b"><apply id="S4.SS1.SSS0.Px2.p1.9.m8.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.9.m8.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px2.p1.9.m8.1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.9.m8.1.1">superscript</csymbol><ci id="S4.SS1.SSS0.Px2.p1.9.m8.1.1.2.cmml" xref="S4.SS1.SSS0.Px2.p1.9.m8.1.1.2">𝜃</ci><ci id="S4.SS1.SSS0.Px2.p1.9.m8.1.1.3.cmml" xref="S4.SS1.SSS0.Px2.p1.9.m8.1.1.3">ℎ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px2.p1.9.m8.1c">\theta^{h}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px2.p1.9.m8.1d">italic_θ start_POSTSUPERSCRIPT italic_h end_POSTSUPERSCRIPT</annotation></semantics></math>. This bisimulation metric loss (D) is designed to train the encoder to learn a representation space where the <math alttext="\ell_{1}" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px2.p1.10.m9.1"><semantics id="S4.SS1.SSS0.Px2.p1.10.m9.1a"><msub id="S4.SS1.SSS0.Px2.p1.10.m9.1.1" xref="S4.SS1.SSS0.Px2.p1.10.m9.1.1.cmml"><mi id="S4.SS1.SSS0.Px2.p1.10.m9.1.1.2" mathvariant="normal" xref="S4.SS1.SSS0.Px2.p1.10.m9.1.1.2.cmml">ℓ</mi><mn id="S4.SS1.SSS0.Px2.p1.10.m9.1.1.3" xref="S4.SS1.SSS0.Px2.p1.10.m9.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px2.p1.10.m9.1b"><apply id="S4.SS1.SSS0.Px2.p1.10.m9.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.10.m9.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px2.p1.10.m9.1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.10.m9.1.1">subscript</csymbol><ci id="S4.SS1.SSS0.Px2.p1.10.m9.1.1.2.cmml" xref="S4.SS1.SSS0.Px2.p1.10.m9.1.1.2">ℓ</ci><cn id="S4.SS1.SSS0.Px2.p1.10.m9.1.1.3.cmml" type="integer" xref="S4.SS1.SSS0.Px2.p1.10.m9.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px2.p1.10.m9.1c">\ell_{1}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px2.p1.10.m9.1d">roman_ℓ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math>-distance corresponds to the <math alttext="\pi^{*}" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px2.p1.11.m10.1"><semantics id="S4.SS1.SSS0.Px2.p1.11.m10.1a"><msup id="S4.SS1.SSS0.Px2.p1.11.m10.1.1" xref="S4.SS1.SSS0.Px2.p1.11.m10.1.1.cmml"><mi id="S4.SS1.SSS0.Px2.p1.11.m10.1.1.2" xref="S4.SS1.SSS0.Px2.p1.11.m10.1.1.2.cmml">π</mi><mo id="S4.SS1.SSS0.Px2.p1.11.m10.1.1.3" xref="S4.SS1.SSS0.Px2.p1.11.m10.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px2.p1.11.m10.1b"><apply id="S4.SS1.SSS0.Px2.p1.11.m10.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.11.m10.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px2.p1.11.m10.1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.11.m10.1.1">superscript</csymbol><ci id="S4.SS1.SSS0.Px2.p1.11.m10.1.1.2.cmml" xref="S4.SS1.SSS0.Px2.p1.11.m10.1.1.2">𝜋</ci><times id="S4.SS1.SSS0.Px2.p1.11.m10.1.1.3.cmml" xref="S4.SS1.SSS0.Px2.p1.11.m10.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px2.p1.11.m10.1c">\pi^{*}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px2.p1.11.m10.1d">italic_π start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math>-bisimulation metric.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS1.SSS0.Px2.p2">
<p class="ltx_p" id="S4.SS1.SSS0.Px2.p2.1">For policy training, we use the following loss function to update the policy parameter <math alttext="\psi" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px2.p2.1.m1.1"><semantics id="S4.SS1.SSS0.Px2.p2.1.m1.1a"><mi id="S4.SS1.SSS0.Px2.p2.1.m1.1.1" xref="S4.SS1.SSS0.Px2.p2.1.m1.1.1.cmml">ψ</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px2.p2.1.m1.1b"><ci id="S4.SS1.SSS0.Px2.p2.1.m1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p2.1.m1.1.1">𝜓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px2.p2.1.m1.1c">\psi</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px2.p2.1.m1.1d">italic_ψ</annotation></semantics></math>.</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E9">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\psi^{*}=\arg\min_{\psi}{\mathcal{J}}_{\pi}(\psi)=\arg\min_{\psi}\;-\sum_{k=0}%
^{H}\lambda^{k}Q_{\theta^{Q}}\left(z_{k},\pi_{\psi}(\bar{z}_{k})\right)" class="ltx_Math" display="block" id="S4.E9.m1.3"><semantics id="S4.E9.m1.3a"><mrow id="S4.E9.m1.3.3" xref="S4.E9.m1.3.3.cmml"><msup id="S4.E9.m1.3.3.4" xref="S4.E9.m1.3.3.4.cmml"><mi id="S4.E9.m1.3.3.4.2" xref="S4.E9.m1.3.3.4.2.cmml">ψ</mi><mo id="S4.E9.m1.3.3.4.3" xref="S4.E9.m1.3.3.4.3.cmml">∗</mo></msup><mo id="S4.E9.m1.3.3.5" xref="S4.E9.m1.3.3.5.cmml">=</mo><mrow id="S4.E9.m1.3.3.6" xref="S4.E9.m1.3.3.6.cmml"><mrow id="S4.E9.m1.3.3.6.2" xref="S4.E9.m1.3.3.6.2.cmml"><mi id="S4.E9.m1.3.3.6.2.1" xref="S4.E9.m1.3.3.6.2.1.cmml">arg</mi><mo id="S4.E9.m1.3.3.6.2a" lspace="0.167em" xref="S4.E9.m1.3.3.6.2.cmml">⁡</mo><mrow id="S4.E9.m1.3.3.6.2.2" xref="S4.E9.m1.3.3.6.2.2.cmml"><munder id="S4.E9.m1.3.3.6.2.2.1" xref="S4.E9.m1.3.3.6.2.2.1.cmml"><mi id="S4.E9.m1.3.3.6.2.2.1.2" xref="S4.E9.m1.3.3.6.2.2.1.2.cmml">min</mi><mi id="S4.E9.m1.3.3.6.2.2.1.3" xref="S4.E9.m1.3.3.6.2.2.1.3.cmml">ψ</mi></munder><mo id="S4.E9.m1.3.3.6.2.2a" lspace="0.167em" xref="S4.E9.m1.3.3.6.2.2.cmml">⁡</mo><msub id="S4.E9.m1.3.3.6.2.2.2" xref="S4.E9.m1.3.3.6.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E9.m1.3.3.6.2.2.2.2" xref="S4.E9.m1.3.3.6.2.2.2.2.cmml">𝒥</mi><mi id="S4.E9.m1.3.3.6.2.2.2.3" xref="S4.E9.m1.3.3.6.2.2.2.3.cmml">π</mi></msub></mrow></mrow><mo id="S4.E9.m1.3.3.6.1" xref="S4.E9.m1.3.3.6.1.cmml">⁢</mo><mrow id="S4.E9.m1.3.3.6.3.2" xref="S4.E9.m1.3.3.6.cmml"><mo id="S4.E9.m1.3.3.6.3.2.1" stretchy="false" xref="S4.E9.m1.3.3.6.cmml">(</mo><mi id="S4.E9.m1.1.1" xref="S4.E9.m1.1.1.cmml">ψ</mi><mo id="S4.E9.m1.3.3.6.3.2.2" stretchy="false" xref="S4.E9.m1.3.3.6.cmml">)</mo></mrow></mrow><mo id="S4.E9.m1.3.3.7" xref="S4.E9.m1.3.3.7.cmml">=</mo><mrow id="S4.E9.m1.3.3.2" xref="S4.E9.m1.3.3.2.cmml"><mrow id="S4.E9.m1.3.3.2.4" xref="S4.E9.m1.3.3.2.4.cmml"><mi id="S4.E9.m1.3.3.2.4.1" xref="S4.E9.m1.3.3.2.4.1.cmml">arg</mi><mo id="S4.E9.m1.3.3.2.4a" lspace="0.167em" xref="S4.E9.m1.3.3.2.4.cmml">⁡</mo><munder id="S4.E9.m1.3.3.2.4.2" xref="S4.E9.m1.3.3.2.4.2.cmml"><mi id="S4.E9.m1.3.3.2.4.2.2" xref="S4.E9.m1.3.3.2.4.2.2.cmml">min</mi><mi id="S4.E9.m1.3.3.2.4.2.3" xref="S4.E9.m1.3.3.2.4.2.3.cmml">ψ</mi></munder></mrow><mo id="S4.E9.m1.3.3.2.3" lspace="0em" rspace="0.055em" xref="S4.E9.m1.3.3.2.3.cmml">−</mo><mrow id="S4.E9.m1.3.3.2.2" xref="S4.E9.m1.3.3.2.2.cmml"><munderover id="S4.E9.m1.3.3.2.2.3" xref="S4.E9.m1.3.3.2.2.3.cmml"><mo id="S4.E9.m1.3.3.2.2.3.2.2" movablelimits="false" xref="S4.E9.m1.3.3.2.2.3.2.2.cmml">∑</mo><mrow id="S4.E9.m1.3.3.2.2.3.2.3" xref="S4.E9.m1.3.3.2.2.3.2.3.cmml"><mi id="S4.E9.m1.3.3.2.2.3.2.3.2" xref="S4.E9.m1.3.3.2.2.3.2.3.2.cmml">k</mi><mo id="S4.E9.m1.3.3.2.2.3.2.3.1" xref="S4.E9.m1.3.3.2.2.3.2.3.1.cmml">=</mo><mn id="S4.E9.m1.3.3.2.2.3.2.3.3" xref="S4.E9.m1.3.3.2.2.3.2.3.3.cmml">0</mn></mrow><mi id="S4.E9.m1.3.3.2.2.3.3" xref="S4.E9.m1.3.3.2.2.3.3.cmml">H</mi></munderover><mrow id="S4.E9.m1.3.3.2.2.2" xref="S4.E9.m1.3.3.2.2.2.cmml"><msup id="S4.E9.m1.3.3.2.2.2.4" xref="S4.E9.m1.3.3.2.2.2.4.cmml"><mi id="S4.E9.m1.3.3.2.2.2.4.2" xref="S4.E9.m1.3.3.2.2.2.4.2.cmml">λ</mi><mi id="S4.E9.m1.3.3.2.2.2.4.3" xref="S4.E9.m1.3.3.2.2.2.4.3.cmml">k</mi></msup><mo id="S4.E9.m1.3.3.2.2.2.3" xref="S4.E9.m1.3.3.2.2.2.3.cmml">⁢</mo><msub id="S4.E9.m1.3.3.2.2.2.5" xref="S4.E9.m1.3.3.2.2.2.5.cmml"><mi id="S4.E9.m1.3.3.2.2.2.5.2" xref="S4.E9.m1.3.3.2.2.2.5.2.cmml">Q</mi><msup id="S4.E9.m1.3.3.2.2.2.5.3" xref="S4.E9.m1.3.3.2.2.2.5.3.cmml"><mi id="S4.E9.m1.3.3.2.2.2.5.3.2" xref="S4.E9.m1.3.3.2.2.2.5.3.2.cmml">θ</mi><mi id="S4.E9.m1.3.3.2.2.2.5.3.3" xref="S4.E9.m1.3.3.2.2.2.5.3.3.cmml">Q</mi></msup></msub><mo id="S4.E9.m1.3.3.2.2.2.3a" xref="S4.E9.m1.3.3.2.2.2.3.cmml">⁢</mo><mrow id="S4.E9.m1.3.3.2.2.2.2.2" xref="S4.E9.m1.3.3.2.2.2.2.3.cmml"><mo id="S4.E9.m1.3.3.2.2.2.2.2.3" xref="S4.E9.m1.3.3.2.2.2.2.3.cmml">(</mo><msub id="S4.E9.m1.2.2.1.1.1.1.1.1" xref="S4.E9.m1.2.2.1.1.1.1.1.1.cmml"><mi id="S4.E9.m1.2.2.1.1.1.1.1.1.2" xref="S4.E9.m1.2.2.1.1.1.1.1.1.2.cmml">z</mi><mi id="S4.E9.m1.2.2.1.1.1.1.1.1.3" xref="S4.E9.m1.2.2.1.1.1.1.1.1.3.cmml">k</mi></msub><mo id="S4.E9.m1.3.3.2.2.2.2.2.4" xref="S4.E9.m1.3.3.2.2.2.2.3.cmml">,</mo><mrow id="S4.E9.m1.3.3.2.2.2.2.2.2" xref="S4.E9.m1.3.3.2.2.2.2.2.2.cmml"><msub id="S4.E9.m1.3.3.2.2.2.2.2.2.3" xref="S4.E9.m1.3.3.2.2.2.2.2.2.3.cmml"><mi id="S4.E9.m1.3.3.2.2.2.2.2.2.3.2" xref="S4.E9.m1.3.3.2.2.2.2.2.2.3.2.cmml">π</mi><mi id="S4.E9.m1.3.3.2.2.2.2.2.2.3.3" xref="S4.E9.m1.3.3.2.2.2.2.2.2.3.3.cmml">ψ</mi></msub><mo id="S4.E9.m1.3.3.2.2.2.2.2.2.2" xref="S4.E9.m1.3.3.2.2.2.2.2.2.2.cmml">⁢</mo><mrow id="S4.E9.m1.3.3.2.2.2.2.2.2.1.1" xref="S4.E9.m1.3.3.2.2.2.2.2.2.1.1.1.cmml"><mo id="S4.E9.m1.3.3.2.2.2.2.2.2.1.1.2" stretchy="false" xref="S4.E9.m1.3.3.2.2.2.2.2.2.1.1.1.cmml">(</mo><msub id="S4.E9.m1.3.3.2.2.2.2.2.2.1.1.1" xref="S4.E9.m1.3.3.2.2.2.2.2.2.1.1.1.cmml"><mover accent="true" id="S4.E9.m1.3.3.2.2.2.2.2.2.1.1.1.2" xref="S4.E9.m1.3.3.2.2.2.2.2.2.1.1.1.2.cmml"><mi id="S4.E9.m1.3.3.2.2.2.2.2.2.1.1.1.2.2" xref="S4.E9.m1.3.3.2.2.2.2.2.2.1.1.1.2.2.cmml">z</mi><mo id="S4.E9.m1.3.3.2.2.2.2.2.2.1.1.1.2.1" xref="S4.E9.m1.3.3.2.2.2.2.2.2.1.1.1.2.1.cmml">¯</mo></mover><mi id="S4.E9.m1.3.3.2.2.2.2.2.2.1.1.1.3" xref="S4.E9.m1.3.3.2.2.2.2.2.2.1.1.1.3.cmml">k</mi></msub><mo id="S4.E9.m1.3.3.2.2.2.2.2.2.1.1.3" stretchy="false" xref="S4.E9.m1.3.3.2.2.2.2.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E9.m1.3.3.2.2.2.2.2.5" xref="S4.E9.m1.3.3.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E9.m1.3b"><apply id="S4.E9.m1.3.3.cmml" xref="S4.E9.m1.3.3"><and id="S4.E9.m1.3.3a.cmml" xref="S4.E9.m1.3.3"></and><apply id="S4.E9.m1.3.3b.cmml" xref="S4.E9.m1.3.3"><eq id="S4.E9.m1.3.3.5.cmml" xref="S4.E9.m1.3.3.5"></eq><apply id="S4.E9.m1.3.3.4.cmml" xref="S4.E9.m1.3.3.4"><csymbol cd="ambiguous" id="S4.E9.m1.3.3.4.1.cmml" xref="S4.E9.m1.3.3.4">superscript</csymbol><ci id="S4.E9.m1.3.3.4.2.cmml" xref="S4.E9.m1.3.3.4.2">𝜓</ci><times id="S4.E9.m1.3.3.4.3.cmml" xref="S4.E9.m1.3.3.4.3"></times></apply><apply id="S4.E9.m1.3.3.6.cmml" xref="S4.E9.m1.3.3.6"><times id="S4.E9.m1.3.3.6.1.cmml" xref="S4.E9.m1.3.3.6.1"></times><apply id="S4.E9.m1.3.3.6.2.cmml" xref="S4.E9.m1.3.3.6.2"><arg id="S4.E9.m1.3.3.6.2.1.cmml" xref="S4.E9.m1.3.3.6.2.1"></arg><apply id="S4.E9.m1.3.3.6.2.2.cmml" xref="S4.E9.m1.3.3.6.2.2"><apply id="S4.E9.m1.3.3.6.2.2.1.cmml" xref="S4.E9.m1.3.3.6.2.2.1"><csymbol cd="ambiguous" id="S4.E9.m1.3.3.6.2.2.1.1.cmml" xref="S4.E9.m1.3.3.6.2.2.1">subscript</csymbol><min id="S4.E9.m1.3.3.6.2.2.1.2.cmml" xref="S4.E9.m1.3.3.6.2.2.1.2"></min><ci id="S4.E9.m1.3.3.6.2.2.1.3.cmml" xref="S4.E9.m1.3.3.6.2.2.1.3">𝜓</ci></apply><apply id="S4.E9.m1.3.3.6.2.2.2.cmml" xref="S4.E9.m1.3.3.6.2.2.2"><csymbol cd="ambiguous" id="S4.E9.m1.3.3.6.2.2.2.1.cmml" xref="S4.E9.m1.3.3.6.2.2.2">subscript</csymbol><ci id="S4.E9.m1.3.3.6.2.2.2.2.cmml" xref="S4.E9.m1.3.3.6.2.2.2.2">𝒥</ci><ci id="S4.E9.m1.3.3.6.2.2.2.3.cmml" xref="S4.E9.m1.3.3.6.2.2.2.3">𝜋</ci></apply></apply></apply><ci id="S4.E9.m1.1.1.cmml" xref="S4.E9.m1.1.1">𝜓</ci></apply></apply><apply id="S4.E9.m1.3.3c.cmml" xref="S4.E9.m1.3.3"><eq id="S4.E9.m1.3.3.7.cmml" xref="S4.E9.m1.3.3.7"></eq><share href="https://arxiv.org/html/2410.04553v1#S4.E9.m1.3.3.6.cmml" id="S4.E9.m1.3.3d.cmml" xref="S4.E9.m1.3.3"></share><apply id="S4.E9.m1.3.3.2.cmml" xref="S4.E9.m1.3.3.2"><minus id="S4.E9.m1.3.3.2.3.cmml" xref="S4.E9.m1.3.3.2.3"></minus><apply id="S4.E9.m1.3.3.2.4.cmml" xref="S4.E9.m1.3.3.2.4"><arg id="S4.E9.m1.3.3.2.4.1.cmml" xref="S4.E9.m1.3.3.2.4.1"></arg><apply id="S4.E9.m1.3.3.2.4.2.cmml" xref="S4.E9.m1.3.3.2.4.2"><csymbol cd="ambiguous" id="S4.E9.m1.3.3.2.4.2.1.cmml" xref="S4.E9.m1.3.3.2.4.2">subscript</csymbol><min id="S4.E9.m1.3.3.2.4.2.2.cmml" xref="S4.E9.m1.3.3.2.4.2.2"></min><ci id="S4.E9.m1.3.3.2.4.2.3.cmml" xref="S4.E9.m1.3.3.2.4.2.3">𝜓</ci></apply></apply><apply id="S4.E9.m1.3.3.2.2.cmml" xref="S4.E9.m1.3.3.2.2"><apply id="S4.E9.m1.3.3.2.2.3.cmml" xref="S4.E9.m1.3.3.2.2.3"><csymbol cd="ambiguous" id="S4.E9.m1.3.3.2.2.3.1.cmml" xref="S4.E9.m1.3.3.2.2.3">superscript</csymbol><apply id="S4.E9.m1.3.3.2.2.3.2.cmml" xref="S4.E9.m1.3.3.2.2.3"><csymbol cd="ambiguous" id="S4.E9.m1.3.3.2.2.3.2.1.cmml" xref="S4.E9.m1.3.3.2.2.3">subscript</csymbol><sum id="S4.E9.m1.3.3.2.2.3.2.2.cmml" xref="S4.E9.m1.3.3.2.2.3.2.2"></sum><apply id="S4.E9.m1.3.3.2.2.3.2.3.cmml" xref="S4.E9.m1.3.3.2.2.3.2.3"><eq id="S4.E9.m1.3.3.2.2.3.2.3.1.cmml" xref="S4.E9.m1.3.3.2.2.3.2.3.1"></eq><ci id="S4.E9.m1.3.3.2.2.3.2.3.2.cmml" xref="S4.E9.m1.3.3.2.2.3.2.3.2">𝑘</ci><cn id="S4.E9.m1.3.3.2.2.3.2.3.3.cmml" type="integer" xref="S4.E9.m1.3.3.2.2.3.2.3.3">0</cn></apply></apply><ci id="S4.E9.m1.3.3.2.2.3.3.cmml" xref="S4.E9.m1.3.3.2.2.3.3">𝐻</ci></apply><apply id="S4.E9.m1.3.3.2.2.2.cmml" xref="S4.E9.m1.3.3.2.2.2"><times id="S4.E9.m1.3.3.2.2.2.3.cmml" xref="S4.E9.m1.3.3.2.2.2.3"></times><apply id="S4.E9.m1.3.3.2.2.2.4.cmml" xref="S4.E9.m1.3.3.2.2.2.4"><csymbol cd="ambiguous" id="S4.E9.m1.3.3.2.2.2.4.1.cmml" xref="S4.E9.m1.3.3.2.2.2.4">superscript</csymbol><ci id="S4.E9.m1.3.3.2.2.2.4.2.cmml" xref="S4.E9.m1.3.3.2.2.2.4.2">𝜆</ci><ci id="S4.E9.m1.3.3.2.2.2.4.3.cmml" xref="S4.E9.m1.3.3.2.2.2.4.3">𝑘</ci></apply><apply id="S4.E9.m1.3.3.2.2.2.5.cmml" xref="S4.E9.m1.3.3.2.2.2.5"><csymbol cd="ambiguous" id="S4.E9.m1.3.3.2.2.2.5.1.cmml" xref="S4.E9.m1.3.3.2.2.2.5">subscript</csymbol><ci id="S4.E9.m1.3.3.2.2.2.5.2.cmml" xref="S4.E9.m1.3.3.2.2.2.5.2">𝑄</ci><apply id="S4.E9.m1.3.3.2.2.2.5.3.cmml" xref="S4.E9.m1.3.3.2.2.2.5.3"><csymbol cd="ambiguous" id="S4.E9.m1.3.3.2.2.2.5.3.1.cmml" xref="S4.E9.m1.3.3.2.2.2.5.3">superscript</csymbol><ci id="S4.E9.m1.3.3.2.2.2.5.3.2.cmml" xref="S4.E9.m1.3.3.2.2.2.5.3.2">𝜃</ci><ci id="S4.E9.m1.3.3.2.2.2.5.3.3.cmml" xref="S4.E9.m1.3.3.2.2.2.5.3.3">𝑄</ci></apply></apply><interval closure="open" id="S4.E9.m1.3.3.2.2.2.2.3.cmml" xref="S4.E9.m1.3.3.2.2.2.2.2"><apply id="S4.E9.m1.2.2.1.1.1.1.1.1.cmml" xref="S4.E9.m1.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E9.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S4.E9.m1.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E9.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S4.E9.m1.2.2.1.1.1.1.1.1.2">𝑧</ci><ci id="S4.E9.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S4.E9.m1.2.2.1.1.1.1.1.1.3">𝑘</ci></apply><apply id="S4.E9.m1.3.3.2.2.2.2.2.2.cmml" xref="S4.E9.m1.3.3.2.2.2.2.2.2"><times id="S4.E9.m1.3.3.2.2.2.2.2.2.2.cmml" xref="S4.E9.m1.3.3.2.2.2.2.2.2.2"></times><apply id="S4.E9.m1.3.3.2.2.2.2.2.2.3.cmml" xref="S4.E9.m1.3.3.2.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S4.E9.m1.3.3.2.2.2.2.2.2.3.1.cmml" xref="S4.E9.m1.3.3.2.2.2.2.2.2.3">subscript</csymbol><ci id="S4.E9.m1.3.3.2.2.2.2.2.2.3.2.cmml" xref="S4.E9.m1.3.3.2.2.2.2.2.2.3.2">𝜋</ci><ci id="S4.E9.m1.3.3.2.2.2.2.2.2.3.3.cmml" xref="S4.E9.m1.3.3.2.2.2.2.2.2.3.3">𝜓</ci></apply><apply id="S4.E9.m1.3.3.2.2.2.2.2.2.1.1.1.cmml" xref="S4.E9.m1.3.3.2.2.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S4.E9.m1.3.3.2.2.2.2.2.2.1.1.1.1.cmml" xref="S4.E9.m1.3.3.2.2.2.2.2.2.1.1">subscript</csymbol><apply id="S4.E9.m1.3.3.2.2.2.2.2.2.1.1.1.2.cmml" xref="S4.E9.m1.3.3.2.2.2.2.2.2.1.1.1.2"><ci id="S4.E9.m1.3.3.2.2.2.2.2.2.1.1.1.2.1.cmml" xref="S4.E9.m1.3.3.2.2.2.2.2.2.1.1.1.2.1">¯</ci><ci id="S4.E9.m1.3.3.2.2.2.2.2.2.1.1.1.2.2.cmml" xref="S4.E9.m1.3.3.2.2.2.2.2.2.1.1.1.2.2">𝑧</ci></apply><ci id="S4.E9.m1.3.3.2.2.2.2.2.2.1.1.1.3.cmml" xref="S4.E9.m1.3.3.2.2.2.2.2.2.1.1.1.3">𝑘</ci></apply></apply></interval></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E9.m1.3c">\psi^{*}=\arg\min_{\psi}{\mathcal{J}}_{\pi}(\psi)=\arg\min_{\psi}\;-\sum_{k=0}%
^{H}\lambda^{k}Q_{\theta^{Q}}\left(z_{k},\pi_{\psi}(\bar{z}_{k})\right)</annotation><annotation encoding="application/x-llamapun" id="S4.E9.m1.3d">italic_ψ start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT = roman_arg roman_min start_POSTSUBSCRIPT italic_ψ end_POSTSUBSCRIPT caligraphic_J start_POSTSUBSCRIPT italic_π end_POSTSUBSCRIPT ( italic_ψ ) = roman_arg roman_min start_POSTSUBSCRIPT italic_ψ end_POSTSUBSCRIPT - ∑ start_POSTSUBSCRIPT italic_k = 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_H end_POSTSUPERSCRIPT italic_λ start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT italic_Q start_POSTSUBSCRIPT italic_θ start_POSTSUPERSCRIPT italic_Q end_POSTSUPERSCRIPT end_POSTSUBSCRIPT ( italic_z start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT , italic_π start_POSTSUBSCRIPT italic_ψ end_POSTSUBSCRIPT ( over¯ start_ARG italic_z end_ARG start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ) )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS1.SSS0.Px2.p3">
<p class="ltx_p" id="S4.SS1.SSS0.Px2.p3.1">In Section. <a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#S4.SS3" title="4.3 Difference between BS-MPC and TD-MPC ‣ 4 Bisimulation metric for model predictive control ‣ Bisimulation metric for Model Predictive Control"><span class="ltx_text ltx_ref_tag">4.3</span></a>, we give details about the benefit of using Eq. <a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#S4.E8" title="In Objective function ‣ 4.1 Bisimulation Metric for Model Predictive Control ‣ 4 Bisimulation metric for model predictive control ‣ Bisimulation metric for Model Predictive Control"><span class="ltx_text ltx_ref_tag">8</span></a> as the objective function for BS-MPC and the differences between our approach and TD-MPC.</p>
</div>
</section>
<section class="ltx_paragraph" id="S4.SS1.SSS0.Px3">
<h4 class="ltx_title ltx_title_paragraph">Model Predictive Control with Learned Model</h4>
<div class="ltx_para ltx_noindent" id="S4.SS1.SSS0.Px3.p1">
<p class="ltx_p" id="S4.SS1.SSS0.Px3.p1.1">Following TD-MPC, our method has a closed-loop controller using the learned latent dynamics model, reward model, state-value function, and prior policy to compute the optimal action.
Due to the high affinity between reinforcement learning and sampling-based planners, we design a closed-loop controller using MPPI, a type of sampling-based MPC, following the approach of TD-MPC. MPPI is a derivative-free method that samples a large number of trajectories, calculates the weight for each, and then generates the optimal trajectory by taking the weighted average of these trajectories. This framework enables us to solve the local trajectory optimization problem.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS1.SSS0.Px3.p2">
<p class="ltx_p" id="S4.SS1.SSS0.Px3.p2.14">First, it encodes the current observed state <math alttext="s_{t}" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px3.p2.1.m1.1"><semantics id="S4.SS1.SSS0.Px3.p2.1.m1.1a"><msub id="S4.SS1.SSS0.Px3.p2.1.m1.1.1" xref="S4.SS1.SSS0.Px3.p2.1.m1.1.1.cmml"><mi id="S4.SS1.SSS0.Px3.p2.1.m1.1.1.2" xref="S4.SS1.SSS0.Px3.p2.1.m1.1.1.2.cmml">s</mi><mi id="S4.SS1.SSS0.Px3.p2.1.m1.1.1.3" xref="S4.SS1.SSS0.Px3.p2.1.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px3.p2.1.m1.1b"><apply id="S4.SS1.SSS0.Px3.p2.1.m1.1.1.cmml" xref="S4.SS1.SSS0.Px3.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px3.p2.1.m1.1.1.1.cmml" xref="S4.SS1.SSS0.Px3.p2.1.m1.1.1">subscript</csymbol><ci id="S4.SS1.SSS0.Px3.p2.1.m1.1.1.2.cmml" xref="S4.SS1.SSS0.Px3.p2.1.m1.1.1.2">𝑠</ci><ci id="S4.SS1.SSS0.Px3.p2.1.m1.1.1.3.cmml" xref="S4.SS1.SSS0.Px3.p2.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px3.p2.1.m1.1c">s_{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px3.p2.1.m1.1d">italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> into the latent space with the trained encoder <math alttext="z_{t}=h_{\theta^{h}}(s_{t})" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px3.p2.2.m2.1"><semantics id="S4.SS1.SSS0.Px3.p2.2.m2.1a"><mrow id="S4.SS1.SSS0.Px3.p2.2.m2.1.1" xref="S4.SS1.SSS0.Px3.p2.2.m2.1.1.cmml"><msub id="S4.SS1.SSS0.Px3.p2.2.m2.1.1.3" xref="S4.SS1.SSS0.Px3.p2.2.m2.1.1.3.cmml"><mi id="S4.SS1.SSS0.Px3.p2.2.m2.1.1.3.2" xref="S4.SS1.SSS0.Px3.p2.2.m2.1.1.3.2.cmml">z</mi><mi id="S4.SS1.SSS0.Px3.p2.2.m2.1.1.3.3" xref="S4.SS1.SSS0.Px3.p2.2.m2.1.1.3.3.cmml">t</mi></msub><mo id="S4.SS1.SSS0.Px3.p2.2.m2.1.1.2" xref="S4.SS1.SSS0.Px3.p2.2.m2.1.1.2.cmml">=</mo><mrow id="S4.SS1.SSS0.Px3.p2.2.m2.1.1.1" xref="S4.SS1.SSS0.Px3.p2.2.m2.1.1.1.cmml"><msub id="S4.SS1.SSS0.Px3.p2.2.m2.1.1.1.3" xref="S4.SS1.SSS0.Px3.p2.2.m2.1.1.1.3.cmml"><mi id="S4.SS1.SSS0.Px3.p2.2.m2.1.1.1.3.2" xref="S4.SS1.SSS0.Px3.p2.2.m2.1.1.1.3.2.cmml">h</mi><msup id="S4.SS1.SSS0.Px3.p2.2.m2.1.1.1.3.3" xref="S4.SS1.SSS0.Px3.p2.2.m2.1.1.1.3.3.cmml"><mi id="S4.SS1.SSS0.Px3.p2.2.m2.1.1.1.3.3.2" xref="S4.SS1.SSS0.Px3.p2.2.m2.1.1.1.3.3.2.cmml">θ</mi><mi id="S4.SS1.SSS0.Px3.p2.2.m2.1.1.1.3.3.3" xref="S4.SS1.SSS0.Px3.p2.2.m2.1.1.1.3.3.3.cmml">h</mi></msup></msub><mo id="S4.SS1.SSS0.Px3.p2.2.m2.1.1.1.2" xref="S4.SS1.SSS0.Px3.p2.2.m2.1.1.1.2.cmml">⁢</mo><mrow id="S4.SS1.SSS0.Px3.p2.2.m2.1.1.1.1.1" xref="S4.SS1.SSS0.Px3.p2.2.m2.1.1.1.1.1.1.cmml"><mo id="S4.SS1.SSS0.Px3.p2.2.m2.1.1.1.1.1.2" stretchy="false" xref="S4.SS1.SSS0.Px3.p2.2.m2.1.1.1.1.1.1.cmml">(</mo><msub id="S4.SS1.SSS0.Px3.p2.2.m2.1.1.1.1.1.1" xref="S4.SS1.SSS0.Px3.p2.2.m2.1.1.1.1.1.1.cmml"><mi id="S4.SS1.SSS0.Px3.p2.2.m2.1.1.1.1.1.1.2" xref="S4.SS1.SSS0.Px3.p2.2.m2.1.1.1.1.1.1.2.cmml">s</mi><mi id="S4.SS1.SSS0.Px3.p2.2.m2.1.1.1.1.1.1.3" xref="S4.SS1.SSS0.Px3.p2.2.m2.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S4.SS1.SSS0.Px3.p2.2.m2.1.1.1.1.1.3" stretchy="false" xref="S4.SS1.SSS0.Px3.p2.2.m2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px3.p2.2.m2.1b"><apply id="S4.SS1.SSS0.Px3.p2.2.m2.1.1.cmml" xref="S4.SS1.SSS0.Px3.p2.2.m2.1.1"><eq id="S4.SS1.SSS0.Px3.p2.2.m2.1.1.2.cmml" xref="S4.SS1.SSS0.Px3.p2.2.m2.1.1.2"></eq><apply id="S4.SS1.SSS0.Px3.p2.2.m2.1.1.3.cmml" xref="S4.SS1.SSS0.Px3.p2.2.m2.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px3.p2.2.m2.1.1.3.1.cmml" xref="S4.SS1.SSS0.Px3.p2.2.m2.1.1.3">subscript</csymbol><ci id="S4.SS1.SSS0.Px3.p2.2.m2.1.1.3.2.cmml" xref="S4.SS1.SSS0.Px3.p2.2.m2.1.1.3.2">𝑧</ci><ci id="S4.SS1.SSS0.Px3.p2.2.m2.1.1.3.3.cmml" xref="S4.SS1.SSS0.Px3.p2.2.m2.1.1.3.3">𝑡</ci></apply><apply id="S4.SS1.SSS0.Px3.p2.2.m2.1.1.1.cmml" xref="S4.SS1.SSS0.Px3.p2.2.m2.1.1.1"><times id="S4.SS1.SSS0.Px3.p2.2.m2.1.1.1.2.cmml" xref="S4.SS1.SSS0.Px3.p2.2.m2.1.1.1.2"></times><apply id="S4.SS1.SSS0.Px3.p2.2.m2.1.1.1.3.cmml" xref="S4.SS1.SSS0.Px3.p2.2.m2.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px3.p2.2.m2.1.1.1.3.1.cmml" xref="S4.SS1.SSS0.Px3.p2.2.m2.1.1.1.3">subscript</csymbol><ci id="S4.SS1.SSS0.Px3.p2.2.m2.1.1.1.3.2.cmml" xref="S4.SS1.SSS0.Px3.p2.2.m2.1.1.1.3.2">ℎ</ci><apply id="S4.SS1.SSS0.Px3.p2.2.m2.1.1.1.3.3.cmml" xref="S4.SS1.SSS0.Px3.p2.2.m2.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px3.p2.2.m2.1.1.1.3.3.1.cmml" xref="S4.SS1.SSS0.Px3.p2.2.m2.1.1.1.3.3">superscript</csymbol><ci id="S4.SS1.SSS0.Px3.p2.2.m2.1.1.1.3.3.2.cmml" xref="S4.SS1.SSS0.Px3.p2.2.m2.1.1.1.3.3.2">𝜃</ci><ci id="S4.SS1.SSS0.Px3.p2.2.m2.1.1.1.3.3.3.cmml" xref="S4.SS1.SSS0.Px3.p2.2.m2.1.1.1.3.3.3">ℎ</ci></apply></apply><apply id="S4.SS1.SSS0.Px3.p2.2.m2.1.1.1.1.1.1.cmml" xref="S4.SS1.SSS0.Px3.p2.2.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px3.p2.2.m2.1.1.1.1.1.1.1.cmml" xref="S4.SS1.SSS0.Px3.p2.2.m2.1.1.1.1.1">subscript</csymbol><ci id="S4.SS1.SSS0.Px3.p2.2.m2.1.1.1.1.1.1.2.cmml" xref="S4.SS1.SSS0.Px3.p2.2.m2.1.1.1.1.1.1.2">𝑠</ci><ci id="S4.SS1.SSS0.Px3.p2.2.m2.1.1.1.1.1.1.3.cmml" xref="S4.SS1.SSS0.Px3.p2.2.m2.1.1.1.1.1.1.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px3.p2.2.m2.1c">z_{t}=h_{\theta^{h}}(s_{t})</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px3.p2.2.m2.1d">italic_z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = italic_h start_POSTSUBSCRIPT italic_θ start_POSTSUPERSCRIPT italic_h end_POSTSUPERSCRIPT end_POSTSUBSCRIPT ( italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math>.
After that, we sample <math alttext="M" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px3.p2.3.m3.1"><semantics id="S4.SS1.SSS0.Px3.p2.3.m3.1a"><mi id="S4.SS1.SSS0.Px3.p2.3.m3.1.1" xref="S4.SS1.SSS0.Px3.p2.3.m3.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px3.p2.3.m3.1b"><ci id="S4.SS1.SSS0.Px3.p2.3.m3.1.1.cmml" xref="S4.SS1.SSS0.Px3.p2.3.m3.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px3.p2.3.m3.1c">M</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px3.p2.3.m3.1d">italic_M</annotation></semantics></math> action sets from Gaussian distribution <math alttext="{\mathcal{N}}(\mu^{0},\sigma^{0})" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px3.p2.4.m4.2"><semantics id="S4.SS1.SSS0.Px3.p2.4.m4.2a"><mrow id="S4.SS1.SSS0.Px3.p2.4.m4.2.2" xref="S4.SS1.SSS0.Px3.p2.4.m4.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.SSS0.Px3.p2.4.m4.2.2.4" xref="S4.SS1.SSS0.Px3.p2.4.m4.2.2.4.cmml">𝒩</mi><mo id="S4.SS1.SSS0.Px3.p2.4.m4.2.2.3" xref="S4.SS1.SSS0.Px3.p2.4.m4.2.2.3.cmml">⁢</mo><mrow id="S4.SS1.SSS0.Px3.p2.4.m4.2.2.2.2" xref="S4.SS1.SSS0.Px3.p2.4.m4.2.2.2.3.cmml"><mo id="S4.SS1.SSS0.Px3.p2.4.m4.2.2.2.2.3" stretchy="false" xref="S4.SS1.SSS0.Px3.p2.4.m4.2.2.2.3.cmml">(</mo><msup id="S4.SS1.SSS0.Px3.p2.4.m4.1.1.1.1.1" xref="S4.SS1.SSS0.Px3.p2.4.m4.1.1.1.1.1.cmml"><mi id="S4.SS1.SSS0.Px3.p2.4.m4.1.1.1.1.1.2" xref="S4.SS1.SSS0.Px3.p2.4.m4.1.1.1.1.1.2.cmml">μ</mi><mn id="S4.SS1.SSS0.Px3.p2.4.m4.1.1.1.1.1.3" xref="S4.SS1.SSS0.Px3.p2.4.m4.1.1.1.1.1.3.cmml">0</mn></msup><mo id="S4.SS1.SSS0.Px3.p2.4.m4.2.2.2.2.4" xref="S4.SS1.SSS0.Px3.p2.4.m4.2.2.2.3.cmml">,</mo><msup id="S4.SS1.SSS0.Px3.p2.4.m4.2.2.2.2.2" xref="S4.SS1.SSS0.Px3.p2.4.m4.2.2.2.2.2.cmml"><mi id="S4.SS1.SSS0.Px3.p2.4.m4.2.2.2.2.2.2" xref="S4.SS1.SSS0.Px3.p2.4.m4.2.2.2.2.2.2.cmml">σ</mi><mn id="S4.SS1.SSS0.Px3.p2.4.m4.2.2.2.2.2.3" xref="S4.SS1.SSS0.Px3.p2.4.m4.2.2.2.2.2.3.cmml">0</mn></msup><mo id="S4.SS1.SSS0.Px3.p2.4.m4.2.2.2.2.5" stretchy="false" xref="S4.SS1.SSS0.Px3.p2.4.m4.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px3.p2.4.m4.2b"><apply id="S4.SS1.SSS0.Px3.p2.4.m4.2.2.cmml" xref="S4.SS1.SSS0.Px3.p2.4.m4.2.2"><times id="S4.SS1.SSS0.Px3.p2.4.m4.2.2.3.cmml" xref="S4.SS1.SSS0.Px3.p2.4.m4.2.2.3"></times><ci id="S4.SS1.SSS0.Px3.p2.4.m4.2.2.4.cmml" xref="S4.SS1.SSS0.Px3.p2.4.m4.2.2.4">𝒩</ci><interval closure="open" id="S4.SS1.SSS0.Px3.p2.4.m4.2.2.2.3.cmml" xref="S4.SS1.SSS0.Px3.p2.4.m4.2.2.2.2"><apply id="S4.SS1.SSS0.Px3.p2.4.m4.1.1.1.1.1.cmml" xref="S4.SS1.SSS0.Px3.p2.4.m4.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px3.p2.4.m4.1.1.1.1.1.1.cmml" xref="S4.SS1.SSS0.Px3.p2.4.m4.1.1.1.1.1">superscript</csymbol><ci id="S4.SS1.SSS0.Px3.p2.4.m4.1.1.1.1.1.2.cmml" xref="S4.SS1.SSS0.Px3.p2.4.m4.1.1.1.1.1.2">𝜇</ci><cn id="S4.SS1.SSS0.Px3.p2.4.m4.1.1.1.1.1.3.cmml" type="integer" xref="S4.SS1.SSS0.Px3.p2.4.m4.1.1.1.1.1.3">0</cn></apply><apply id="S4.SS1.SSS0.Px3.p2.4.m4.2.2.2.2.2.cmml" xref="S4.SS1.SSS0.Px3.p2.4.m4.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px3.p2.4.m4.2.2.2.2.2.1.cmml" xref="S4.SS1.SSS0.Px3.p2.4.m4.2.2.2.2.2">superscript</csymbol><ci id="S4.SS1.SSS0.Px3.p2.4.m4.2.2.2.2.2.2.cmml" xref="S4.SS1.SSS0.Px3.p2.4.m4.2.2.2.2.2.2">𝜎</ci><cn id="S4.SS1.SSS0.Px3.p2.4.m4.2.2.2.2.2.3.cmml" type="integer" xref="S4.SS1.SSS0.Px3.p2.4.m4.2.2.2.2.2.3">0</cn></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px3.p2.4.m4.2c">{\mathcal{N}}(\mu^{0},\sigma^{0})</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px3.p2.4.m4.2d">caligraphic_N ( italic_μ start_POSTSUPERSCRIPT 0 end_POSTSUPERSCRIPT , italic_σ start_POSTSUPERSCRIPT 0 end_POSTSUPERSCRIPT )</annotation></semantics></math> based on the initial mean<math alttext="\mu^{0}" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px3.p2.5.m5.1"><semantics id="S4.SS1.SSS0.Px3.p2.5.m5.1a"><msup id="S4.SS1.SSS0.Px3.p2.5.m5.1.1" xref="S4.SS1.SSS0.Px3.p2.5.m5.1.1.cmml"><mi id="S4.SS1.SSS0.Px3.p2.5.m5.1.1.2" xref="S4.SS1.SSS0.Px3.p2.5.m5.1.1.2.cmml">μ</mi><mn id="S4.SS1.SSS0.Px3.p2.5.m5.1.1.3" xref="S4.SS1.SSS0.Px3.p2.5.m5.1.1.3.cmml">0</mn></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px3.p2.5.m5.1b"><apply id="S4.SS1.SSS0.Px3.p2.5.m5.1.1.cmml" xref="S4.SS1.SSS0.Px3.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px3.p2.5.m5.1.1.1.cmml" xref="S4.SS1.SSS0.Px3.p2.5.m5.1.1">superscript</csymbol><ci id="S4.SS1.SSS0.Px3.p2.5.m5.1.1.2.cmml" xref="S4.SS1.SSS0.Px3.p2.5.m5.1.1.2">𝜇</ci><cn id="S4.SS1.SSS0.Px3.p2.5.m5.1.1.3.cmml" type="integer" xref="S4.SS1.SSS0.Px3.p2.5.m5.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px3.p2.5.m5.1c">\mu^{0}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px3.p2.5.m5.1d">italic_μ start_POSTSUPERSCRIPT 0 end_POSTSUPERSCRIPT</annotation></semantics></math> and standard deviation <math alttext="\sigma^{0}" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px3.p2.6.m6.1"><semantics id="S4.SS1.SSS0.Px3.p2.6.m6.1a"><msup id="S4.SS1.SSS0.Px3.p2.6.m6.1.1" xref="S4.SS1.SSS0.Px3.p2.6.m6.1.1.cmml"><mi id="S4.SS1.SSS0.Px3.p2.6.m6.1.1.2" xref="S4.SS1.SSS0.Px3.p2.6.m6.1.1.2.cmml">σ</mi><mn id="S4.SS1.SSS0.Px3.p2.6.m6.1.1.3" xref="S4.SS1.SSS0.Px3.p2.6.m6.1.1.3.cmml">0</mn></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px3.p2.6.m6.1b"><apply id="S4.SS1.SSS0.Px3.p2.6.m6.1.1.cmml" xref="S4.SS1.SSS0.Px3.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px3.p2.6.m6.1.1.1.cmml" xref="S4.SS1.SSS0.Px3.p2.6.m6.1.1">superscript</csymbol><ci id="S4.SS1.SSS0.Px3.p2.6.m6.1.1.2.cmml" xref="S4.SS1.SSS0.Px3.p2.6.m6.1.1.2">𝜎</ci><cn id="S4.SS1.SSS0.Px3.p2.6.m6.1.1.3.cmml" type="integer" xref="S4.SS1.SSS0.Px3.p2.6.m6.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px3.p2.6.m6.1c">\sigma^{0}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px3.p2.6.m6.1d">italic_σ start_POSTSUPERSCRIPT 0 end_POSTSUPERSCRIPT</annotation></semantics></math>, and each set contains <math alttext="H" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px3.p2.7.m7.1"><semantics id="S4.SS1.SSS0.Px3.p2.7.m7.1a"><mi id="S4.SS1.SSS0.Px3.p2.7.m7.1.1" xref="S4.SS1.SSS0.Px3.p2.7.m7.1.1.cmml">H</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px3.p2.7.m7.1b"><ci id="S4.SS1.SSS0.Px3.p2.7.m7.1.1.cmml" xref="S4.SS1.SSS0.Px3.p2.7.m7.1.1">𝐻</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px3.p2.7.m7.1c">H</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px3.p2.7.m7.1d">italic_H</annotation></semantics></math> length actions <math alttext="a^{j}_{t:t+H}" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px3.p2.8.m8.1"><semantics id="S4.SS1.SSS0.Px3.p2.8.m8.1a"><msubsup id="S4.SS1.SSS0.Px3.p2.8.m8.1.1" xref="S4.SS1.SSS0.Px3.p2.8.m8.1.1.cmml"><mi id="S4.SS1.SSS0.Px3.p2.8.m8.1.1.2.2" xref="S4.SS1.SSS0.Px3.p2.8.m8.1.1.2.2.cmml">a</mi><mrow id="S4.SS1.SSS0.Px3.p2.8.m8.1.1.3" xref="S4.SS1.SSS0.Px3.p2.8.m8.1.1.3.cmml"><mi id="S4.SS1.SSS0.Px3.p2.8.m8.1.1.3.2" xref="S4.SS1.SSS0.Px3.p2.8.m8.1.1.3.2.cmml">t</mi><mo id="S4.SS1.SSS0.Px3.p2.8.m8.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="S4.SS1.SSS0.Px3.p2.8.m8.1.1.3.1.cmml">:</mo><mrow id="S4.SS1.SSS0.Px3.p2.8.m8.1.1.3.3" xref="S4.SS1.SSS0.Px3.p2.8.m8.1.1.3.3.cmml"><mi id="S4.SS1.SSS0.Px3.p2.8.m8.1.1.3.3.2" xref="S4.SS1.SSS0.Px3.p2.8.m8.1.1.3.3.2.cmml">t</mi><mo id="S4.SS1.SSS0.Px3.p2.8.m8.1.1.3.3.1" xref="S4.SS1.SSS0.Px3.p2.8.m8.1.1.3.3.1.cmml">+</mo><mi id="S4.SS1.SSS0.Px3.p2.8.m8.1.1.3.3.3" xref="S4.SS1.SSS0.Px3.p2.8.m8.1.1.3.3.3.cmml">H</mi></mrow></mrow><mi id="S4.SS1.SSS0.Px3.p2.8.m8.1.1.2.3" xref="S4.SS1.SSS0.Px3.p2.8.m8.1.1.2.3.cmml">j</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px3.p2.8.m8.1b"><apply id="S4.SS1.SSS0.Px3.p2.8.m8.1.1.cmml" xref="S4.SS1.SSS0.Px3.p2.8.m8.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px3.p2.8.m8.1.1.1.cmml" xref="S4.SS1.SSS0.Px3.p2.8.m8.1.1">subscript</csymbol><apply id="S4.SS1.SSS0.Px3.p2.8.m8.1.1.2.cmml" xref="S4.SS1.SSS0.Px3.p2.8.m8.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px3.p2.8.m8.1.1.2.1.cmml" xref="S4.SS1.SSS0.Px3.p2.8.m8.1.1">superscript</csymbol><ci id="S4.SS1.SSS0.Px3.p2.8.m8.1.1.2.2.cmml" xref="S4.SS1.SSS0.Px3.p2.8.m8.1.1.2.2">𝑎</ci><ci id="S4.SS1.SSS0.Px3.p2.8.m8.1.1.2.3.cmml" xref="S4.SS1.SSS0.Px3.p2.8.m8.1.1.2.3">𝑗</ci></apply><apply id="S4.SS1.SSS0.Px3.p2.8.m8.1.1.3.cmml" xref="S4.SS1.SSS0.Px3.p2.8.m8.1.1.3"><ci id="S4.SS1.SSS0.Px3.p2.8.m8.1.1.3.1.cmml" xref="S4.SS1.SSS0.Px3.p2.8.m8.1.1.3.1">:</ci><ci id="S4.SS1.SSS0.Px3.p2.8.m8.1.1.3.2.cmml" xref="S4.SS1.SSS0.Px3.p2.8.m8.1.1.3.2">𝑡</ci><apply id="S4.SS1.SSS0.Px3.p2.8.m8.1.1.3.3.cmml" xref="S4.SS1.SSS0.Px3.p2.8.m8.1.1.3.3"><plus id="S4.SS1.SSS0.Px3.p2.8.m8.1.1.3.3.1.cmml" xref="S4.SS1.SSS0.Px3.p2.8.m8.1.1.3.3.1"></plus><ci id="S4.SS1.SSS0.Px3.p2.8.m8.1.1.3.3.2.cmml" xref="S4.SS1.SSS0.Px3.p2.8.m8.1.1.3.3.2">𝑡</ci><ci id="S4.SS1.SSS0.Px3.p2.8.m8.1.1.3.3.3.cmml" xref="S4.SS1.SSS0.Px3.p2.8.m8.1.1.3.3.3">𝐻</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px3.p2.8.m8.1c">a^{j}_{t:t+H}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px3.p2.8.m8.1d">italic_a start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t : italic_t + italic_H end_POSTSUBSCRIPT</annotation></semantics></math> where <math alttext="j\in M" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px3.p2.9.m9.1"><semantics id="S4.SS1.SSS0.Px3.p2.9.m9.1a"><mrow id="S4.SS1.SSS0.Px3.p2.9.m9.1.1" xref="S4.SS1.SSS0.Px3.p2.9.m9.1.1.cmml"><mi id="S4.SS1.SSS0.Px3.p2.9.m9.1.1.2" xref="S4.SS1.SSS0.Px3.p2.9.m9.1.1.2.cmml">j</mi><mo id="S4.SS1.SSS0.Px3.p2.9.m9.1.1.1" xref="S4.SS1.SSS0.Px3.p2.9.m9.1.1.1.cmml">∈</mo><mi id="S4.SS1.SSS0.Px3.p2.9.m9.1.1.3" xref="S4.SS1.SSS0.Px3.p2.9.m9.1.1.3.cmml">M</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px3.p2.9.m9.1b"><apply id="S4.SS1.SSS0.Px3.p2.9.m9.1.1.cmml" xref="S4.SS1.SSS0.Px3.p2.9.m9.1.1"><in id="S4.SS1.SSS0.Px3.p2.9.m9.1.1.1.cmml" xref="S4.SS1.SSS0.Px3.p2.9.m9.1.1.1"></in><ci id="S4.SS1.SSS0.Px3.p2.9.m9.1.1.2.cmml" xref="S4.SS1.SSS0.Px3.p2.9.m9.1.1.2">𝑗</ci><ci id="S4.SS1.SSS0.Px3.p2.9.m9.1.1.3.cmml" xref="S4.SS1.SSS0.Px3.p2.9.m9.1.1.3">𝑀</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px3.p2.9.m9.1c">j\in M</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px3.p2.9.m9.1d">italic_j ∈ italic_M</annotation></semantics></math>.
Starting from the initial latent state <math alttext="z_{t}" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px3.p2.10.m10.1"><semantics id="S4.SS1.SSS0.Px3.p2.10.m10.1a"><msub id="S4.SS1.SSS0.Px3.p2.10.m10.1.1" xref="S4.SS1.SSS0.Px3.p2.10.m10.1.1.cmml"><mi id="S4.SS1.SSS0.Px3.p2.10.m10.1.1.2" xref="S4.SS1.SSS0.Px3.p2.10.m10.1.1.2.cmml">z</mi><mi id="S4.SS1.SSS0.Px3.p2.10.m10.1.1.3" xref="S4.SS1.SSS0.Px3.p2.10.m10.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px3.p2.10.m10.1b"><apply id="S4.SS1.SSS0.Px3.p2.10.m10.1.1.cmml" xref="S4.SS1.SSS0.Px3.p2.10.m10.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px3.p2.10.m10.1.1.1.cmml" xref="S4.SS1.SSS0.Px3.p2.10.m10.1.1">subscript</csymbol><ci id="S4.SS1.SSS0.Px3.p2.10.m10.1.1.2.cmml" xref="S4.SS1.SSS0.Px3.p2.10.m10.1.1.2">𝑧</ci><ci id="S4.SS1.SSS0.Px3.p2.10.m10.1.1.3.cmml" xref="S4.SS1.SSS0.Px3.p2.10.m10.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px3.p2.10.m10.1c">z_{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px3.p2.10.m10.1d">italic_z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, we use the learned latent dynamics <math alttext="z_{t+1}=d_{\theta^{d}}(z_{t},a_{t})" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px3.p2.11.m11.2"><semantics id="S4.SS1.SSS0.Px3.p2.11.m11.2a"><mrow id="S4.SS1.SSS0.Px3.p2.11.m11.2.2" xref="S4.SS1.SSS0.Px3.p2.11.m11.2.2.cmml"><msub id="S4.SS1.SSS0.Px3.p2.11.m11.2.2.4" xref="S4.SS1.SSS0.Px3.p2.11.m11.2.2.4.cmml"><mi id="S4.SS1.SSS0.Px3.p2.11.m11.2.2.4.2" xref="S4.SS1.SSS0.Px3.p2.11.m11.2.2.4.2.cmml">z</mi><mrow id="S4.SS1.SSS0.Px3.p2.11.m11.2.2.4.3" xref="S4.SS1.SSS0.Px3.p2.11.m11.2.2.4.3.cmml"><mi id="S4.SS1.SSS0.Px3.p2.11.m11.2.2.4.3.2" xref="S4.SS1.SSS0.Px3.p2.11.m11.2.2.4.3.2.cmml">t</mi><mo id="S4.SS1.SSS0.Px3.p2.11.m11.2.2.4.3.1" xref="S4.SS1.SSS0.Px3.p2.11.m11.2.2.4.3.1.cmml">+</mo><mn id="S4.SS1.SSS0.Px3.p2.11.m11.2.2.4.3.3" xref="S4.SS1.SSS0.Px3.p2.11.m11.2.2.4.3.3.cmml">1</mn></mrow></msub><mo id="S4.SS1.SSS0.Px3.p2.11.m11.2.2.3" xref="S4.SS1.SSS0.Px3.p2.11.m11.2.2.3.cmml">=</mo><mrow id="S4.SS1.SSS0.Px3.p2.11.m11.2.2.2" xref="S4.SS1.SSS0.Px3.p2.11.m11.2.2.2.cmml"><msub id="S4.SS1.SSS0.Px3.p2.11.m11.2.2.2.4" xref="S4.SS1.SSS0.Px3.p2.11.m11.2.2.2.4.cmml"><mi id="S4.SS1.SSS0.Px3.p2.11.m11.2.2.2.4.2" xref="S4.SS1.SSS0.Px3.p2.11.m11.2.2.2.4.2.cmml">d</mi><msup id="S4.SS1.SSS0.Px3.p2.11.m11.2.2.2.4.3" xref="S4.SS1.SSS0.Px3.p2.11.m11.2.2.2.4.3.cmml"><mi id="S4.SS1.SSS0.Px3.p2.11.m11.2.2.2.4.3.2" xref="S4.SS1.SSS0.Px3.p2.11.m11.2.2.2.4.3.2.cmml">θ</mi><mi id="S4.SS1.SSS0.Px3.p2.11.m11.2.2.2.4.3.3" xref="S4.SS1.SSS0.Px3.p2.11.m11.2.2.2.4.3.3.cmml">d</mi></msup></msub><mo id="S4.SS1.SSS0.Px3.p2.11.m11.2.2.2.3" xref="S4.SS1.SSS0.Px3.p2.11.m11.2.2.2.3.cmml">⁢</mo><mrow id="S4.SS1.SSS0.Px3.p2.11.m11.2.2.2.2.2" xref="S4.SS1.SSS0.Px3.p2.11.m11.2.2.2.2.3.cmml"><mo id="S4.SS1.SSS0.Px3.p2.11.m11.2.2.2.2.2.3" stretchy="false" xref="S4.SS1.SSS0.Px3.p2.11.m11.2.2.2.2.3.cmml">(</mo><msub id="S4.SS1.SSS0.Px3.p2.11.m11.1.1.1.1.1.1" xref="S4.SS1.SSS0.Px3.p2.11.m11.1.1.1.1.1.1.cmml"><mi id="S4.SS1.SSS0.Px3.p2.11.m11.1.1.1.1.1.1.2" xref="S4.SS1.SSS0.Px3.p2.11.m11.1.1.1.1.1.1.2.cmml">z</mi><mi id="S4.SS1.SSS0.Px3.p2.11.m11.1.1.1.1.1.1.3" xref="S4.SS1.SSS0.Px3.p2.11.m11.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S4.SS1.SSS0.Px3.p2.11.m11.2.2.2.2.2.4" xref="S4.SS1.SSS0.Px3.p2.11.m11.2.2.2.2.3.cmml">,</mo><msub id="S4.SS1.SSS0.Px3.p2.11.m11.2.2.2.2.2.2" xref="S4.SS1.SSS0.Px3.p2.11.m11.2.2.2.2.2.2.cmml"><mi id="S4.SS1.SSS0.Px3.p2.11.m11.2.2.2.2.2.2.2" xref="S4.SS1.SSS0.Px3.p2.11.m11.2.2.2.2.2.2.2.cmml">a</mi><mi id="S4.SS1.SSS0.Px3.p2.11.m11.2.2.2.2.2.2.3" xref="S4.SS1.SSS0.Px3.p2.11.m11.2.2.2.2.2.2.3.cmml">t</mi></msub><mo id="S4.SS1.SSS0.Px3.p2.11.m11.2.2.2.2.2.5" stretchy="false" xref="S4.SS1.SSS0.Px3.p2.11.m11.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px3.p2.11.m11.2b"><apply id="S4.SS1.SSS0.Px3.p2.11.m11.2.2.cmml" xref="S4.SS1.SSS0.Px3.p2.11.m11.2.2"><eq id="S4.SS1.SSS0.Px3.p2.11.m11.2.2.3.cmml" xref="S4.SS1.SSS0.Px3.p2.11.m11.2.2.3"></eq><apply id="S4.SS1.SSS0.Px3.p2.11.m11.2.2.4.cmml" xref="S4.SS1.SSS0.Px3.p2.11.m11.2.2.4"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px3.p2.11.m11.2.2.4.1.cmml" xref="S4.SS1.SSS0.Px3.p2.11.m11.2.2.4">subscript</csymbol><ci id="S4.SS1.SSS0.Px3.p2.11.m11.2.2.4.2.cmml" xref="S4.SS1.SSS0.Px3.p2.11.m11.2.2.4.2">𝑧</ci><apply id="S4.SS1.SSS0.Px3.p2.11.m11.2.2.4.3.cmml" xref="S4.SS1.SSS0.Px3.p2.11.m11.2.2.4.3"><plus id="S4.SS1.SSS0.Px3.p2.11.m11.2.2.4.3.1.cmml" xref="S4.SS1.SSS0.Px3.p2.11.m11.2.2.4.3.1"></plus><ci id="S4.SS1.SSS0.Px3.p2.11.m11.2.2.4.3.2.cmml" xref="S4.SS1.SSS0.Px3.p2.11.m11.2.2.4.3.2">𝑡</ci><cn id="S4.SS1.SSS0.Px3.p2.11.m11.2.2.4.3.3.cmml" type="integer" xref="S4.SS1.SSS0.Px3.p2.11.m11.2.2.4.3.3">1</cn></apply></apply><apply id="S4.SS1.SSS0.Px3.p2.11.m11.2.2.2.cmml" xref="S4.SS1.SSS0.Px3.p2.11.m11.2.2.2"><times id="S4.SS1.SSS0.Px3.p2.11.m11.2.2.2.3.cmml" xref="S4.SS1.SSS0.Px3.p2.11.m11.2.2.2.3"></times><apply id="S4.SS1.SSS0.Px3.p2.11.m11.2.2.2.4.cmml" xref="S4.SS1.SSS0.Px3.p2.11.m11.2.2.2.4"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px3.p2.11.m11.2.2.2.4.1.cmml" xref="S4.SS1.SSS0.Px3.p2.11.m11.2.2.2.4">subscript</csymbol><ci id="S4.SS1.SSS0.Px3.p2.11.m11.2.2.2.4.2.cmml" xref="S4.SS1.SSS0.Px3.p2.11.m11.2.2.2.4.2">𝑑</ci><apply id="S4.SS1.SSS0.Px3.p2.11.m11.2.2.2.4.3.cmml" xref="S4.SS1.SSS0.Px3.p2.11.m11.2.2.2.4.3"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px3.p2.11.m11.2.2.2.4.3.1.cmml" xref="S4.SS1.SSS0.Px3.p2.11.m11.2.2.2.4.3">superscript</csymbol><ci id="S4.SS1.SSS0.Px3.p2.11.m11.2.2.2.4.3.2.cmml" xref="S4.SS1.SSS0.Px3.p2.11.m11.2.2.2.4.3.2">𝜃</ci><ci id="S4.SS1.SSS0.Px3.p2.11.m11.2.2.2.4.3.3.cmml" xref="S4.SS1.SSS0.Px3.p2.11.m11.2.2.2.4.3.3">𝑑</ci></apply></apply><interval closure="open" id="S4.SS1.SSS0.Px3.p2.11.m11.2.2.2.2.3.cmml" xref="S4.SS1.SSS0.Px3.p2.11.m11.2.2.2.2.2"><apply id="S4.SS1.SSS0.Px3.p2.11.m11.1.1.1.1.1.1.cmml" xref="S4.SS1.SSS0.Px3.p2.11.m11.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px3.p2.11.m11.1.1.1.1.1.1.1.cmml" xref="S4.SS1.SSS0.Px3.p2.11.m11.1.1.1.1.1.1">subscript</csymbol><ci id="S4.SS1.SSS0.Px3.p2.11.m11.1.1.1.1.1.1.2.cmml" xref="S4.SS1.SSS0.Px3.p2.11.m11.1.1.1.1.1.1.2">𝑧</ci><ci id="S4.SS1.SSS0.Px3.p2.11.m11.1.1.1.1.1.1.3.cmml" xref="S4.SS1.SSS0.Px3.p2.11.m11.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="S4.SS1.SSS0.Px3.p2.11.m11.2.2.2.2.2.2.cmml" xref="S4.SS1.SSS0.Px3.p2.11.m11.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px3.p2.11.m11.2.2.2.2.2.2.1.cmml" xref="S4.SS1.SSS0.Px3.p2.11.m11.2.2.2.2.2.2">subscript</csymbol><ci id="S4.SS1.SSS0.Px3.p2.11.m11.2.2.2.2.2.2.2.cmml" xref="S4.SS1.SSS0.Px3.p2.11.m11.2.2.2.2.2.2.2">𝑎</ci><ci id="S4.SS1.SSS0.Px3.p2.11.m11.2.2.2.2.2.2.3.cmml" xref="S4.SS1.SSS0.Px3.p2.11.m11.2.2.2.2.2.2.3">𝑡</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px3.p2.11.m11.2c">z_{t+1}=d_{\theta^{d}}(z_{t},a_{t})</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px3.p2.11.m11.2d">italic_z start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT = italic_d start_POSTSUBSCRIPT italic_θ start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT end_POSTSUBSCRIPT ( italic_z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math> and sample <math alttext="M" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px3.p2.12.m12.1"><semantics id="S4.SS1.SSS0.Px3.p2.12.m12.1a"><mi id="S4.SS1.SSS0.Px3.p2.12.m12.1.1" xref="S4.SS1.SSS0.Px3.p2.12.m12.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px3.p2.12.m12.1b"><ci id="S4.SS1.SSS0.Px3.p2.12.m12.1.1.cmml" xref="S4.SS1.SSS0.Px3.p2.12.m12.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px3.p2.12.m12.1c">M</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px3.p2.12.m12.1d">italic_M</annotation></semantics></math> trajectories.
We then calculate the weight of each trajectory based on its cost and compute the weighted mean of the sampled trajectories to get the updated optimal trajectory.
The parameter <math alttext="\mu_{k}" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px3.p2.13.m13.1"><semantics id="S4.SS1.SSS0.Px3.p2.13.m13.1a"><msub id="S4.SS1.SSS0.Px3.p2.13.m13.1.1" xref="S4.SS1.SSS0.Px3.p2.13.m13.1.1.cmml"><mi id="S4.SS1.SSS0.Px3.p2.13.m13.1.1.2" xref="S4.SS1.SSS0.Px3.p2.13.m13.1.1.2.cmml">μ</mi><mi id="S4.SS1.SSS0.Px3.p2.13.m13.1.1.3" xref="S4.SS1.SSS0.Px3.p2.13.m13.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px3.p2.13.m13.1b"><apply id="S4.SS1.SSS0.Px3.p2.13.m13.1.1.cmml" xref="S4.SS1.SSS0.Px3.p2.13.m13.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px3.p2.13.m13.1.1.1.cmml" xref="S4.SS1.SSS0.Px3.p2.13.m13.1.1">subscript</csymbol><ci id="S4.SS1.SSS0.Px3.p2.13.m13.1.1.2.cmml" xref="S4.SS1.SSS0.Px3.p2.13.m13.1.1.2">𝜇</ci><ci id="S4.SS1.SSS0.Px3.p2.13.m13.1.1.3.cmml" xref="S4.SS1.SSS0.Px3.p2.13.m13.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px3.p2.13.m13.1c">\mu_{k}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px3.p2.13.m13.1d">italic_μ start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\sigma_{k}" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px3.p2.14.m14.1"><semantics id="S4.SS1.SSS0.Px3.p2.14.m14.1a"><msub id="S4.SS1.SSS0.Px3.p2.14.m14.1.1" xref="S4.SS1.SSS0.Px3.p2.14.m14.1.1.cmml"><mi id="S4.SS1.SSS0.Px3.p2.14.m14.1.1.2" xref="S4.SS1.SSS0.Px3.p2.14.m14.1.1.2.cmml">σ</mi><mi id="S4.SS1.SSS0.Px3.p2.14.m14.1.1.3" xref="S4.SS1.SSS0.Px3.p2.14.m14.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px3.p2.14.m14.1b"><apply id="S4.SS1.SSS0.Px3.p2.14.m14.1.1.cmml" xref="S4.SS1.SSS0.Px3.p2.14.m14.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px3.p2.14.m14.1.1.1.cmml" xref="S4.SS1.SSS0.Px3.p2.14.m14.1.1">subscript</csymbol><ci id="S4.SS1.SSS0.Px3.p2.14.m14.1.1.2.cmml" xref="S4.SS1.SSS0.Px3.p2.14.m14.1.1.2">𝜎</ci><ci id="S4.SS1.SSS0.Px3.p2.14.m14.1.1.3.cmml" xref="S4.SS1.SSS0.Px3.p2.14.m14.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px3.p2.14.m14.1c">\sigma_{k}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px3.p2.14.m14.1d">italic_σ start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> is updated by maximizing the following equations:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E10">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mu^{k+1},\sigma^{k+1}=\arg\max_{(\mu,\sigma)}\mathbb{E}_{(a_{t},a_{t+1},\dots%
,a_{t+H})\sim\mathcal{N}(\mu,\sigma^{2})}\left[\gamma^{H}V(z_{t+H})+\sum_{h=t}%
^{H-1}\gamma^{h}R_{\theta^{R}}(z_{h},a_{h})\right]" class="ltx_Math" display="block" id="S4.E10.m1.11"><semantics id="S4.E10.m1.11a"><mrow id="S4.E10.m1.11.11" xref="S4.E10.m1.11.11.cmml"><mrow id="S4.E10.m1.10.10.2.2" xref="S4.E10.m1.10.10.2.3.cmml"><msup id="S4.E10.m1.9.9.1.1.1" xref="S4.E10.m1.9.9.1.1.1.cmml"><mi id="S4.E10.m1.9.9.1.1.1.2" xref="S4.E10.m1.9.9.1.1.1.2.cmml">μ</mi><mrow id="S4.E10.m1.9.9.1.1.1.3" xref="S4.E10.m1.9.9.1.1.1.3.cmml"><mi id="S4.E10.m1.9.9.1.1.1.3.2" xref="S4.E10.m1.9.9.1.1.1.3.2.cmml">k</mi><mo id="S4.E10.m1.9.9.1.1.1.3.1" xref="S4.E10.m1.9.9.1.1.1.3.1.cmml">+</mo><mn id="S4.E10.m1.9.9.1.1.1.3.3" xref="S4.E10.m1.9.9.1.1.1.3.3.cmml">1</mn></mrow></msup><mo id="S4.E10.m1.10.10.2.2.3" xref="S4.E10.m1.10.10.2.3.cmml">,</mo><msup id="S4.E10.m1.10.10.2.2.2" xref="S4.E10.m1.10.10.2.2.2.cmml"><mi id="S4.E10.m1.10.10.2.2.2.2" xref="S4.E10.m1.10.10.2.2.2.2.cmml">σ</mi><mrow id="S4.E10.m1.10.10.2.2.2.3" xref="S4.E10.m1.10.10.2.2.2.3.cmml"><mi id="S4.E10.m1.10.10.2.2.2.3.2" xref="S4.E10.m1.10.10.2.2.2.3.2.cmml">k</mi><mo id="S4.E10.m1.10.10.2.2.2.3.1" xref="S4.E10.m1.10.10.2.2.2.3.1.cmml">+</mo><mn id="S4.E10.m1.10.10.2.2.2.3.3" xref="S4.E10.m1.10.10.2.2.2.3.3.cmml">1</mn></mrow></msup></mrow><mo id="S4.E10.m1.11.11.4" xref="S4.E10.m1.11.11.4.cmml">=</mo><mrow id="S4.E10.m1.11.11.3" xref="S4.E10.m1.11.11.3.cmml"><mrow id="S4.E10.m1.11.11.3.3" xref="S4.E10.m1.11.11.3.3.cmml"><mi id="S4.E10.m1.11.11.3.3.1" xref="S4.E10.m1.11.11.3.3.1.cmml">arg</mi><mo id="S4.E10.m1.11.11.3.3a" lspace="0.167em" xref="S4.E10.m1.11.11.3.3.cmml">⁡</mo><mrow id="S4.E10.m1.11.11.3.3.2" xref="S4.E10.m1.11.11.3.3.2.cmml"><munder id="S4.E10.m1.11.11.3.3.2.1" xref="S4.E10.m1.11.11.3.3.2.1.cmml"><mi id="S4.E10.m1.11.11.3.3.2.1.2" xref="S4.E10.m1.11.11.3.3.2.1.2.cmml">max</mi><mrow id="S4.E10.m1.2.2.2.4" xref="S4.E10.m1.2.2.2.3.cmml"><mo id="S4.E10.m1.2.2.2.4.1" stretchy="false" xref="S4.E10.m1.2.2.2.3.cmml">(</mo><mi id="S4.E10.m1.1.1.1.1" xref="S4.E10.m1.1.1.1.1.cmml">μ</mi><mo id="S4.E10.m1.2.2.2.4.2" xref="S4.E10.m1.2.2.2.3.cmml">,</mo><mi id="S4.E10.m1.2.2.2.2" xref="S4.E10.m1.2.2.2.2.cmml">σ</mi><mo id="S4.E10.m1.2.2.2.4.3" stretchy="false" xref="S4.E10.m1.2.2.2.3.cmml">)</mo></mrow></munder><mo id="S4.E10.m1.11.11.3.3.2a" lspace="0.167em" xref="S4.E10.m1.11.11.3.3.2.cmml">⁡</mo><msub id="S4.E10.m1.11.11.3.3.2.2" xref="S4.E10.m1.11.11.3.3.2.2.cmml"><mi id="S4.E10.m1.11.11.3.3.2.2.2" xref="S4.E10.m1.11.11.3.3.2.2.2.cmml">𝔼</mi><mrow id="S4.E10.m1.8.8.6" xref="S4.E10.m1.8.8.6.cmml"><mrow id="S4.E10.m1.7.7.5.5.3" xref="S4.E10.m1.7.7.5.5.4.cmml"><mo id="S4.E10.m1.7.7.5.5.3.4" stretchy="false" xref="S4.E10.m1.7.7.5.5.4.cmml">(</mo><msub id="S4.E10.m1.5.5.3.3.1.1" xref="S4.E10.m1.5.5.3.3.1.1.cmml"><mi id="S4.E10.m1.5.5.3.3.1.1.2" xref="S4.E10.m1.5.5.3.3.1.1.2.cmml">a</mi><mi id="S4.E10.m1.5.5.3.3.1.1.3" xref="S4.E10.m1.5.5.3.3.1.1.3.cmml">t</mi></msub><mo id="S4.E10.m1.7.7.5.5.3.5" xref="S4.E10.m1.7.7.5.5.4.cmml">,</mo><msub id="S4.E10.m1.6.6.4.4.2.2" xref="S4.E10.m1.6.6.4.4.2.2.cmml"><mi id="S4.E10.m1.6.6.4.4.2.2.2" xref="S4.E10.m1.6.6.4.4.2.2.2.cmml">a</mi><mrow id="S4.E10.m1.6.6.4.4.2.2.3" xref="S4.E10.m1.6.6.4.4.2.2.3.cmml"><mi id="S4.E10.m1.6.6.4.4.2.2.3.2" xref="S4.E10.m1.6.6.4.4.2.2.3.2.cmml">t</mi><mo id="S4.E10.m1.6.6.4.4.2.2.3.1" xref="S4.E10.m1.6.6.4.4.2.2.3.1.cmml">+</mo><mn id="S4.E10.m1.6.6.4.4.2.2.3.3" xref="S4.E10.m1.6.6.4.4.2.2.3.3.cmml">1</mn></mrow></msub><mo id="S4.E10.m1.7.7.5.5.3.6" xref="S4.E10.m1.7.7.5.5.4.cmml">,</mo><mi id="S4.E10.m1.3.3.1.1" mathvariant="normal" xref="S4.E10.m1.3.3.1.1.cmml">…</mi><mo id="S4.E10.m1.7.7.5.5.3.7" xref="S4.E10.m1.7.7.5.5.4.cmml">,</mo><msub id="S4.E10.m1.7.7.5.5.3.3" xref="S4.E10.m1.7.7.5.5.3.3.cmml"><mi id="S4.E10.m1.7.7.5.5.3.3.2" xref="S4.E10.m1.7.7.5.5.3.3.2.cmml">a</mi><mrow id="S4.E10.m1.7.7.5.5.3.3.3" xref="S4.E10.m1.7.7.5.5.3.3.3.cmml"><mi id="S4.E10.m1.7.7.5.5.3.3.3.2" xref="S4.E10.m1.7.7.5.5.3.3.3.2.cmml">t</mi><mo id="S4.E10.m1.7.7.5.5.3.3.3.1" xref="S4.E10.m1.7.7.5.5.3.3.3.1.cmml">+</mo><mi id="S4.E10.m1.7.7.5.5.3.3.3.3" xref="S4.E10.m1.7.7.5.5.3.3.3.3.cmml">H</mi></mrow></msub><mo id="S4.E10.m1.7.7.5.5.3.8" stretchy="false" xref="S4.E10.m1.7.7.5.5.4.cmml">)</mo></mrow><mo id="S4.E10.m1.8.8.6.7" xref="S4.E10.m1.8.8.6.7.cmml">∼</mo><mrow id="S4.E10.m1.8.8.6.6" xref="S4.E10.m1.8.8.6.6.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E10.m1.8.8.6.6.3" xref="S4.E10.m1.8.8.6.6.3.cmml">𝒩</mi><mo id="S4.E10.m1.8.8.6.6.2" xref="S4.E10.m1.8.8.6.6.2.cmml">⁢</mo><mrow id="S4.E10.m1.8.8.6.6.1.1" xref="S4.E10.m1.8.8.6.6.1.2.cmml"><mo id="S4.E10.m1.8.8.6.6.1.1.2" stretchy="false" xref="S4.E10.m1.8.8.6.6.1.2.cmml">(</mo><mi id="S4.E10.m1.4.4.2.2" xref="S4.E10.m1.4.4.2.2.cmml">μ</mi><mo id="S4.E10.m1.8.8.6.6.1.1.3" xref="S4.E10.m1.8.8.6.6.1.2.cmml">,</mo><msup id="S4.E10.m1.8.8.6.6.1.1.1" xref="S4.E10.m1.8.8.6.6.1.1.1.cmml"><mi id="S4.E10.m1.8.8.6.6.1.1.1.2" xref="S4.E10.m1.8.8.6.6.1.1.1.2.cmml">σ</mi><mn id="S4.E10.m1.8.8.6.6.1.1.1.3" xref="S4.E10.m1.8.8.6.6.1.1.1.3.cmml">2</mn></msup><mo id="S4.E10.m1.8.8.6.6.1.1.4" stretchy="false" xref="S4.E10.m1.8.8.6.6.1.2.cmml">)</mo></mrow></mrow></mrow></msub></mrow></mrow><mo id="S4.E10.m1.11.11.3.2" xref="S4.E10.m1.11.11.3.2.cmml">⁢</mo><mrow id="S4.E10.m1.11.11.3.1.1" xref="S4.E10.m1.11.11.3.1.2.cmml"><mo id="S4.E10.m1.11.11.3.1.1.2" xref="S4.E10.m1.11.11.3.1.2.1.cmml">[</mo><mrow id="S4.E10.m1.11.11.3.1.1.1" xref="S4.E10.m1.11.11.3.1.1.1.cmml"><mrow id="S4.E10.m1.11.11.3.1.1.1.1" xref="S4.E10.m1.11.11.3.1.1.1.1.cmml"><msup id="S4.E10.m1.11.11.3.1.1.1.1.3" xref="S4.E10.m1.11.11.3.1.1.1.1.3.cmml"><mi id="S4.E10.m1.11.11.3.1.1.1.1.3.2" xref="S4.E10.m1.11.11.3.1.1.1.1.3.2.cmml">γ</mi><mi id="S4.E10.m1.11.11.3.1.1.1.1.3.3" xref="S4.E10.m1.11.11.3.1.1.1.1.3.3.cmml">H</mi></msup><mo id="S4.E10.m1.11.11.3.1.1.1.1.2" xref="S4.E10.m1.11.11.3.1.1.1.1.2.cmml">⁢</mo><mi id="S4.E10.m1.11.11.3.1.1.1.1.4" xref="S4.E10.m1.11.11.3.1.1.1.1.4.cmml">V</mi><mo id="S4.E10.m1.11.11.3.1.1.1.1.2a" xref="S4.E10.m1.11.11.3.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E10.m1.11.11.3.1.1.1.1.1.1" xref="S4.E10.m1.11.11.3.1.1.1.1.1.1.1.cmml"><mo id="S4.E10.m1.11.11.3.1.1.1.1.1.1.2" stretchy="false" xref="S4.E10.m1.11.11.3.1.1.1.1.1.1.1.cmml">(</mo><msub id="S4.E10.m1.11.11.3.1.1.1.1.1.1.1" xref="S4.E10.m1.11.11.3.1.1.1.1.1.1.1.cmml"><mi id="S4.E10.m1.11.11.3.1.1.1.1.1.1.1.2" xref="S4.E10.m1.11.11.3.1.1.1.1.1.1.1.2.cmml">z</mi><mrow id="S4.E10.m1.11.11.3.1.1.1.1.1.1.1.3" xref="S4.E10.m1.11.11.3.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E10.m1.11.11.3.1.1.1.1.1.1.1.3.2" xref="S4.E10.m1.11.11.3.1.1.1.1.1.1.1.3.2.cmml">t</mi><mo id="S4.E10.m1.11.11.3.1.1.1.1.1.1.1.3.1" xref="S4.E10.m1.11.11.3.1.1.1.1.1.1.1.3.1.cmml">+</mo><mi id="S4.E10.m1.11.11.3.1.1.1.1.1.1.1.3.3" xref="S4.E10.m1.11.11.3.1.1.1.1.1.1.1.3.3.cmml">H</mi></mrow></msub><mo id="S4.E10.m1.11.11.3.1.1.1.1.1.1.3" stretchy="false" xref="S4.E10.m1.11.11.3.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E10.m1.11.11.3.1.1.1.4" rspace="0.055em" xref="S4.E10.m1.11.11.3.1.1.1.4.cmml">+</mo><mrow id="S4.E10.m1.11.11.3.1.1.1.3" xref="S4.E10.m1.11.11.3.1.1.1.3.cmml"><munderover id="S4.E10.m1.11.11.3.1.1.1.3.3" xref="S4.E10.m1.11.11.3.1.1.1.3.3.cmml"><mo id="S4.E10.m1.11.11.3.1.1.1.3.3.2.2" movablelimits="false" xref="S4.E10.m1.11.11.3.1.1.1.3.3.2.2.cmml">∑</mo><mrow id="S4.E10.m1.11.11.3.1.1.1.3.3.2.3" xref="S4.E10.m1.11.11.3.1.1.1.3.3.2.3.cmml"><mi id="S4.E10.m1.11.11.3.1.1.1.3.3.2.3.2" xref="S4.E10.m1.11.11.3.1.1.1.3.3.2.3.2.cmml">h</mi><mo id="S4.E10.m1.11.11.3.1.1.1.3.3.2.3.1" xref="S4.E10.m1.11.11.3.1.1.1.3.3.2.3.1.cmml">=</mo><mi id="S4.E10.m1.11.11.3.1.1.1.3.3.2.3.3" xref="S4.E10.m1.11.11.3.1.1.1.3.3.2.3.3.cmml">t</mi></mrow><mrow id="S4.E10.m1.11.11.3.1.1.1.3.3.3" xref="S4.E10.m1.11.11.3.1.1.1.3.3.3.cmml"><mi id="S4.E10.m1.11.11.3.1.1.1.3.3.3.2" xref="S4.E10.m1.11.11.3.1.1.1.3.3.3.2.cmml">H</mi><mo id="S4.E10.m1.11.11.3.1.1.1.3.3.3.1" xref="S4.E10.m1.11.11.3.1.1.1.3.3.3.1.cmml">−</mo><mn id="S4.E10.m1.11.11.3.1.1.1.3.3.3.3" xref="S4.E10.m1.11.11.3.1.1.1.3.3.3.3.cmml">1</mn></mrow></munderover><mrow id="S4.E10.m1.11.11.3.1.1.1.3.2" xref="S4.E10.m1.11.11.3.1.1.1.3.2.cmml"><msup id="S4.E10.m1.11.11.3.1.1.1.3.2.4" xref="S4.E10.m1.11.11.3.1.1.1.3.2.4.cmml"><mi id="S4.E10.m1.11.11.3.1.1.1.3.2.4.2" xref="S4.E10.m1.11.11.3.1.1.1.3.2.4.2.cmml">γ</mi><mi id="S4.E10.m1.11.11.3.1.1.1.3.2.4.3" xref="S4.E10.m1.11.11.3.1.1.1.3.2.4.3.cmml">h</mi></msup><mo id="S4.E10.m1.11.11.3.1.1.1.3.2.3" xref="S4.E10.m1.11.11.3.1.1.1.3.2.3.cmml">⁢</mo><msub id="S4.E10.m1.11.11.3.1.1.1.3.2.5" xref="S4.E10.m1.11.11.3.1.1.1.3.2.5.cmml"><mi id="S4.E10.m1.11.11.3.1.1.1.3.2.5.2" xref="S4.E10.m1.11.11.3.1.1.1.3.2.5.2.cmml">R</mi><msup id="S4.E10.m1.11.11.3.1.1.1.3.2.5.3" xref="S4.E10.m1.11.11.3.1.1.1.3.2.5.3.cmml"><mi id="S4.E10.m1.11.11.3.1.1.1.3.2.5.3.2" xref="S4.E10.m1.11.11.3.1.1.1.3.2.5.3.2.cmml">θ</mi><mi id="S4.E10.m1.11.11.3.1.1.1.3.2.5.3.3" xref="S4.E10.m1.11.11.3.1.1.1.3.2.5.3.3.cmml">R</mi></msup></msub><mo id="S4.E10.m1.11.11.3.1.1.1.3.2.3a" xref="S4.E10.m1.11.11.3.1.1.1.3.2.3.cmml">⁢</mo><mrow id="S4.E10.m1.11.11.3.1.1.1.3.2.2.2" xref="S4.E10.m1.11.11.3.1.1.1.3.2.2.3.cmml"><mo id="S4.E10.m1.11.11.3.1.1.1.3.2.2.2.3" stretchy="false" xref="S4.E10.m1.11.11.3.1.1.1.3.2.2.3.cmml">(</mo><msub id="S4.E10.m1.11.11.3.1.1.1.2.1.1.1.1" xref="S4.E10.m1.11.11.3.1.1.1.2.1.1.1.1.cmml"><mi id="S4.E10.m1.11.11.3.1.1.1.2.1.1.1.1.2" xref="S4.E10.m1.11.11.3.1.1.1.2.1.1.1.1.2.cmml">z</mi><mi id="S4.E10.m1.11.11.3.1.1.1.2.1.1.1.1.3" xref="S4.E10.m1.11.11.3.1.1.1.2.1.1.1.1.3.cmml">h</mi></msub><mo id="S4.E10.m1.11.11.3.1.1.1.3.2.2.2.4" xref="S4.E10.m1.11.11.3.1.1.1.3.2.2.3.cmml">,</mo><msub id="S4.E10.m1.11.11.3.1.1.1.3.2.2.2.2" xref="S4.E10.m1.11.11.3.1.1.1.3.2.2.2.2.cmml"><mi id="S4.E10.m1.11.11.3.1.1.1.3.2.2.2.2.2" xref="S4.E10.m1.11.11.3.1.1.1.3.2.2.2.2.2.cmml">a</mi><mi id="S4.E10.m1.11.11.3.1.1.1.3.2.2.2.2.3" xref="S4.E10.m1.11.11.3.1.1.1.3.2.2.2.2.3.cmml">h</mi></msub><mo id="S4.E10.m1.11.11.3.1.1.1.3.2.2.2.5" stretchy="false" xref="S4.E10.m1.11.11.3.1.1.1.3.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S4.E10.m1.11.11.3.1.1.3" xref="S4.E10.m1.11.11.3.1.2.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E10.m1.11b"><apply id="S4.E10.m1.11.11.cmml" xref="S4.E10.m1.11.11"><eq id="S4.E10.m1.11.11.4.cmml" xref="S4.E10.m1.11.11.4"></eq><list id="S4.E10.m1.10.10.2.3.cmml" xref="S4.E10.m1.10.10.2.2"><apply id="S4.E10.m1.9.9.1.1.1.cmml" xref="S4.E10.m1.9.9.1.1.1"><csymbol cd="ambiguous" id="S4.E10.m1.9.9.1.1.1.1.cmml" xref="S4.E10.m1.9.9.1.1.1">superscript</csymbol><ci id="S4.E10.m1.9.9.1.1.1.2.cmml" xref="S4.E10.m1.9.9.1.1.1.2">𝜇</ci><apply id="S4.E10.m1.9.9.1.1.1.3.cmml" xref="S4.E10.m1.9.9.1.1.1.3"><plus id="S4.E10.m1.9.9.1.1.1.3.1.cmml" xref="S4.E10.m1.9.9.1.1.1.3.1"></plus><ci id="S4.E10.m1.9.9.1.1.1.3.2.cmml" xref="S4.E10.m1.9.9.1.1.1.3.2">𝑘</ci><cn id="S4.E10.m1.9.9.1.1.1.3.3.cmml" type="integer" xref="S4.E10.m1.9.9.1.1.1.3.3">1</cn></apply></apply><apply id="S4.E10.m1.10.10.2.2.2.cmml" xref="S4.E10.m1.10.10.2.2.2"><csymbol cd="ambiguous" id="S4.E10.m1.10.10.2.2.2.1.cmml" xref="S4.E10.m1.10.10.2.2.2">superscript</csymbol><ci id="S4.E10.m1.10.10.2.2.2.2.cmml" xref="S4.E10.m1.10.10.2.2.2.2">𝜎</ci><apply id="S4.E10.m1.10.10.2.2.2.3.cmml" xref="S4.E10.m1.10.10.2.2.2.3"><plus id="S4.E10.m1.10.10.2.2.2.3.1.cmml" xref="S4.E10.m1.10.10.2.2.2.3.1"></plus><ci id="S4.E10.m1.10.10.2.2.2.3.2.cmml" xref="S4.E10.m1.10.10.2.2.2.3.2">𝑘</ci><cn id="S4.E10.m1.10.10.2.2.2.3.3.cmml" type="integer" xref="S4.E10.m1.10.10.2.2.2.3.3">1</cn></apply></apply></list><apply id="S4.E10.m1.11.11.3.cmml" xref="S4.E10.m1.11.11.3"><times id="S4.E10.m1.11.11.3.2.cmml" xref="S4.E10.m1.11.11.3.2"></times><apply id="S4.E10.m1.11.11.3.3.cmml" xref="S4.E10.m1.11.11.3.3"><arg id="S4.E10.m1.11.11.3.3.1.cmml" xref="S4.E10.m1.11.11.3.3.1"></arg><apply id="S4.E10.m1.11.11.3.3.2.cmml" xref="S4.E10.m1.11.11.3.3.2"><apply id="S4.E10.m1.11.11.3.3.2.1.cmml" xref="S4.E10.m1.11.11.3.3.2.1"><csymbol cd="ambiguous" id="S4.E10.m1.11.11.3.3.2.1.1.cmml" xref="S4.E10.m1.11.11.3.3.2.1">subscript</csymbol><max id="S4.E10.m1.11.11.3.3.2.1.2.cmml" xref="S4.E10.m1.11.11.3.3.2.1.2"></max><interval closure="open" id="S4.E10.m1.2.2.2.3.cmml" xref="S4.E10.m1.2.2.2.4"><ci id="S4.E10.m1.1.1.1.1.cmml" xref="S4.E10.m1.1.1.1.1">𝜇</ci><ci id="S4.E10.m1.2.2.2.2.cmml" xref="S4.E10.m1.2.2.2.2">𝜎</ci></interval></apply><apply id="S4.E10.m1.11.11.3.3.2.2.cmml" xref="S4.E10.m1.11.11.3.3.2.2"><csymbol cd="ambiguous" id="S4.E10.m1.11.11.3.3.2.2.1.cmml" xref="S4.E10.m1.11.11.3.3.2.2">subscript</csymbol><ci id="S4.E10.m1.11.11.3.3.2.2.2.cmml" xref="S4.E10.m1.11.11.3.3.2.2.2">𝔼</ci><apply id="S4.E10.m1.8.8.6.cmml" xref="S4.E10.m1.8.8.6"><csymbol cd="latexml" id="S4.E10.m1.8.8.6.7.cmml" xref="S4.E10.m1.8.8.6.7">similar-to</csymbol><vector id="S4.E10.m1.7.7.5.5.4.cmml" xref="S4.E10.m1.7.7.5.5.3"><apply id="S4.E10.m1.5.5.3.3.1.1.cmml" xref="S4.E10.m1.5.5.3.3.1.1"><csymbol cd="ambiguous" id="S4.E10.m1.5.5.3.3.1.1.1.cmml" xref="S4.E10.m1.5.5.3.3.1.1">subscript</csymbol><ci id="S4.E10.m1.5.5.3.3.1.1.2.cmml" xref="S4.E10.m1.5.5.3.3.1.1.2">𝑎</ci><ci id="S4.E10.m1.5.5.3.3.1.1.3.cmml" xref="S4.E10.m1.5.5.3.3.1.1.3">𝑡</ci></apply><apply id="S4.E10.m1.6.6.4.4.2.2.cmml" xref="S4.E10.m1.6.6.4.4.2.2"><csymbol cd="ambiguous" id="S4.E10.m1.6.6.4.4.2.2.1.cmml" xref="S4.E10.m1.6.6.4.4.2.2">subscript</csymbol><ci id="S4.E10.m1.6.6.4.4.2.2.2.cmml" xref="S4.E10.m1.6.6.4.4.2.2.2">𝑎</ci><apply id="S4.E10.m1.6.6.4.4.2.2.3.cmml" xref="S4.E10.m1.6.6.4.4.2.2.3"><plus id="S4.E10.m1.6.6.4.4.2.2.3.1.cmml" xref="S4.E10.m1.6.6.4.4.2.2.3.1"></plus><ci id="S4.E10.m1.6.6.4.4.2.2.3.2.cmml" xref="S4.E10.m1.6.6.4.4.2.2.3.2">𝑡</ci><cn id="S4.E10.m1.6.6.4.4.2.2.3.3.cmml" type="integer" xref="S4.E10.m1.6.6.4.4.2.2.3.3">1</cn></apply></apply><ci id="S4.E10.m1.3.3.1.1.cmml" xref="S4.E10.m1.3.3.1.1">…</ci><apply id="S4.E10.m1.7.7.5.5.3.3.cmml" xref="S4.E10.m1.7.7.5.5.3.3"><csymbol cd="ambiguous" id="S4.E10.m1.7.7.5.5.3.3.1.cmml" xref="S4.E10.m1.7.7.5.5.3.3">subscript</csymbol><ci id="S4.E10.m1.7.7.5.5.3.3.2.cmml" xref="S4.E10.m1.7.7.5.5.3.3.2">𝑎</ci><apply id="S4.E10.m1.7.7.5.5.3.3.3.cmml" xref="S4.E10.m1.7.7.5.5.3.3.3"><plus id="S4.E10.m1.7.7.5.5.3.3.3.1.cmml" xref="S4.E10.m1.7.7.5.5.3.3.3.1"></plus><ci id="S4.E10.m1.7.7.5.5.3.3.3.2.cmml" xref="S4.E10.m1.7.7.5.5.3.3.3.2">𝑡</ci><ci id="S4.E10.m1.7.7.5.5.3.3.3.3.cmml" xref="S4.E10.m1.7.7.5.5.3.3.3.3">𝐻</ci></apply></apply></vector><apply id="S4.E10.m1.8.8.6.6.cmml" xref="S4.E10.m1.8.8.6.6"><times id="S4.E10.m1.8.8.6.6.2.cmml" xref="S4.E10.m1.8.8.6.6.2"></times><ci id="S4.E10.m1.8.8.6.6.3.cmml" xref="S4.E10.m1.8.8.6.6.3">𝒩</ci><interval closure="open" id="S4.E10.m1.8.8.6.6.1.2.cmml" xref="S4.E10.m1.8.8.6.6.1.1"><ci id="S4.E10.m1.4.4.2.2.cmml" xref="S4.E10.m1.4.4.2.2">𝜇</ci><apply id="S4.E10.m1.8.8.6.6.1.1.1.cmml" xref="S4.E10.m1.8.8.6.6.1.1.1"><csymbol cd="ambiguous" id="S4.E10.m1.8.8.6.6.1.1.1.1.cmml" xref="S4.E10.m1.8.8.6.6.1.1.1">superscript</csymbol><ci id="S4.E10.m1.8.8.6.6.1.1.1.2.cmml" xref="S4.E10.m1.8.8.6.6.1.1.1.2">𝜎</ci><cn id="S4.E10.m1.8.8.6.6.1.1.1.3.cmml" type="integer" xref="S4.E10.m1.8.8.6.6.1.1.1.3">2</cn></apply></interval></apply></apply></apply></apply></apply><apply id="S4.E10.m1.11.11.3.1.2.cmml" xref="S4.E10.m1.11.11.3.1.1"><csymbol cd="latexml" id="S4.E10.m1.11.11.3.1.2.1.cmml" xref="S4.E10.m1.11.11.3.1.1.2">delimited-[]</csymbol><apply id="S4.E10.m1.11.11.3.1.1.1.cmml" xref="S4.E10.m1.11.11.3.1.1.1"><plus id="S4.E10.m1.11.11.3.1.1.1.4.cmml" xref="S4.E10.m1.11.11.3.1.1.1.4"></plus><apply id="S4.E10.m1.11.11.3.1.1.1.1.cmml" xref="S4.E10.m1.11.11.3.1.1.1.1"><times id="S4.E10.m1.11.11.3.1.1.1.1.2.cmml" xref="S4.E10.m1.11.11.3.1.1.1.1.2"></times><apply id="S4.E10.m1.11.11.3.1.1.1.1.3.cmml" xref="S4.E10.m1.11.11.3.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E10.m1.11.11.3.1.1.1.1.3.1.cmml" xref="S4.E10.m1.11.11.3.1.1.1.1.3">superscript</csymbol><ci id="S4.E10.m1.11.11.3.1.1.1.1.3.2.cmml" xref="S4.E10.m1.11.11.3.1.1.1.1.3.2">𝛾</ci><ci id="S4.E10.m1.11.11.3.1.1.1.1.3.3.cmml" xref="S4.E10.m1.11.11.3.1.1.1.1.3.3">𝐻</ci></apply><ci id="S4.E10.m1.11.11.3.1.1.1.1.4.cmml" xref="S4.E10.m1.11.11.3.1.1.1.1.4">𝑉</ci><apply id="S4.E10.m1.11.11.3.1.1.1.1.1.1.1.cmml" xref="S4.E10.m1.11.11.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E10.m1.11.11.3.1.1.1.1.1.1.1.1.cmml" xref="S4.E10.m1.11.11.3.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E10.m1.11.11.3.1.1.1.1.1.1.1.2.cmml" xref="S4.E10.m1.11.11.3.1.1.1.1.1.1.1.2">𝑧</ci><apply id="S4.E10.m1.11.11.3.1.1.1.1.1.1.1.3.cmml" xref="S4.E10.m1.11.11.3.1.1.1.1.1.1.1.3"><plus id="S4.E10.m1.11.11.3.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E10.m1.11.11.3.1.1.1.1.1.1.1.3.1"></plus><ci id="S4.E10.m1.11.11.3.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E10.m1.11.11.3.1.1.1.1.1.1.1.3.2">𝑡</ci><ci id="S4.E10.m1.11.11.3.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E10.m1.11.11.3.1.1.1.1.1.1.1.3.3">𝐻</ci></apply></apply></apply><apply id="S4.E10.m1.11.11.3.1.1.1.3.cmml" xref="S4.E10.m1.11.11.3.1.1.1.3"><apply id="S4.E10.m1.11.11.3.1.1.1.3.3.cmml" xref="S4.E10.m1.11.11.3.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.E10.m1.11.11.3.1.1.1.3.3.1.cmml" xref="S4.E10.m1.11.11.3.1.1.1.3.3">superscript</csymbol><apply id="S4.E10.m1.11.11.3.1.1.1.3.3.2.cmml" xref="S4.E10.m1.11.11.3.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.E10.m1.11.11.3.1.1.1.3.3.2.1.cmml" xref="S4.E10.m1.11.11.3.1.1.1.3.3">subscript</csymbol><sum id="S4.E10.m1.11.11.3.1.1.1.3.3.2.2.cmml" xref="S4.E10.m1.11.11.3.1.1.1.3.3.2.2"></sum><apply id="S4.E10.m1.11.11.3.1.1.1.3.3.2.3.cmml" xref="S4.E10.m1.11.11.3.1.1.1.3.3.2.3"><eq id="S4.E10.m1.11.11.3.1.1.1.3.3.2.3.1.cmml" xref="S4.E10.m1.11.11.3.1.1.1.3.3.2.3.1"></eq><ci id="S4.E10.m1.11.11.3.1.1.1.3.3.2.3.2.cmml" xref="S4.E10.m1.11.11.3.1.1.1.3.3.2.3.2">ℎ</ci><ci id="S4.E10.m1.11.11.3.1.1.1.3.3.2.3.3.cmml" xref="S4.E10.m1.11.11.3.1.1.1.3.3.2.3.3">𝑡</ci></apply></apply><apply id="S4.E10.m1.11.11.3.1.1.1.3.3.3.cmml" xref="S4.E10.m1.11.11.3.1.1.1.3.3.3"><minus id="S4.E10.m1.11.11.3.1.1.1.3.3.3.1.cmml" xref="S4.E10.m1.11.11.3.1.1.1.3.3.3.1"></minus><ci id="S4.E10.m1.11.11.3.1.1.1.3.3.3.2.cmml" xref="S4.E10.m1.11.11.3.1.1.1.3.3.3.2">𝐻</ci><cn id="S4.E10.m1.11.11.3.1.1.1.3.3.3.3.cmml" type="integer" xref="S4.E10.m1.11.11.3.1.1.1.3.3.3.3">1</cn></apply></apply><apply id="S4.E10.m1.11.11.3.1.1.1.3.2.cmml" xref="S4.E10.m1.11.11.3.1.1.1.3.2"><times id="S4.E10.m1.11.11.3.1.1.1.3.2.3.cmml" xref="S4.E10.m1.11.11.3.1.1.1.3.2.3"></times><apply id="S4.E10.m1.11.11.3.1.1.1.3.2.4.cmml" xref="S4.E10.m1.11.11.3.1.1.1.3.2.4"><csymbol cd="ambiguous" id="S4.E10.m1.11.11.3.1.1.1.3.2.4.1.cmml" xref="S4.E10.m1.11.11.3.1.1.1.3.2.4">superscript</csymbol><ci id="S4.E10.m1.11.11.3.1.1.1.3.2.4.2.cmml" xref="S4.E10.m1.11.11.3.1.1.1.3.2.4.2">𝛾</ci><ci id="S4.E10.m1.11.11.3.1.1.1.3.2.4.3.cmml" xref="S4.E10.m1.11.11.3.1.1.1.3.2.4.3">ℎ</ci></apply><apply id="S4.E10.m1.11.11.3.1.1.1.3.2.5.cmml" xref="S4.E10.m1.11.11.3.1.1.1.3.2.5"><csymbol cd="ambiguous" id="S4.E10.m1.11.11.3.1.1.1.3.2.5.1.cmml" xref="S4.E10.m1.11.11.3.1.1.1.3.2.5">subscript</csymbol><ci id="S4.E10.m1.11.11.3.1.1.1.3.2.5.2.cmml" xref="S4.E10.m1.11.11.3.1.1.1.3.2.5.2">𝑅</ci><apply id="S4.E10.m1.11.11.3.1.1.1.3.2.5.3.cmml" xref="S4.E10.m1.11.11.3.1.1.1.3.2.5.3"><csymbol cd="ambiguous" id="S4.E10.m1.11.11.3.1.1.1.3.2.5.3.1.cmml" xref="S4.E10.m1.11.11.3.1.1.1.3.2.5.3">superscript</csymbol><ci id="S4.E10.m1.11.11.3.1.1.1.3.2.5.3.2.cmml" xref="S4.E10.m1.11.11.3.1.1.1.3.2.5.3.2">𝜃</ci><ci id="S4.E10.m1.11.11.3.1.1.1.3.2.5.3.3.cmml" xref="S4.E10.m1.11.11.3.1.1.1.3.2.5.3.3">𝑅</ci></apply></apply><interval closure="open" id="S4.E10.m1.11.11.3.1.1.1.3.2.2.3.cmml" xref="S4.E10.m1.11.11.3.1.1.1.3.2.2.2"><apply id="S4.E10.m1.11.11.3.1.1.1.2.1.1.1.1.cmml" xref="S4.E10.m1.11.11.3.1.1.1.2.1.1.1.1"><csymbol cd="ambiguous" id="S4.E10.m1.11.11.3.1.1.1.2.1.1.1.1.1.cmml" xref="S4.E10.m1.11.11.3.1.1.1.2.1.1.1.1">subscript</csymbol><ci id="S4.E10.m1.11.11.3.1.1.1.2.1.1.1.1.2.cmml" xref="S4.E10.m1.11.11.3.1.1.1.2.1.1.1.1.2">𝑧</ci><ci id="S4.E10.m1.11.11.3.1.1.1.2.1.1.1.1.3.cmml" xref="S4.E10.m1.11.11.3.1.1.1.2.1.1.1.1.3">ℎ</ci></apply><apply id="S4.E10.m1.11.11.3.1.1.1.3.2.2.2.2.cmml" xref="S4.E10.m1.11.11.3.1.1.1.3.2.2.2.2"><csymbol cd="ambiguous" id="S4.E10.m1.11.11.3.1.1.1.3.2.2.2.2.1.cmml" xref="S4.E10.m1.11.11.3.1.1.1.3.2.2.2.2">subscript</csymbol><ci id="S4.E10.m1.11.11.3.1.1.1.3.2.2.2.2.2.cmml" xref="S4.E10.m1.11.11.3.1.1.1.3.2.2.2.2.2">𝑎</ci><ci id="S4.E10.m1.11.11.3.1.1.1.3.2.2.2.2.3.cmml" xref="S4.E10.m1.11.11.3.1.1.1.3.2.2.2.2.3">ℎ</ci></apply></interval></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E10.m1.11c">\mu^{k+1},\sigma^{k+1}=\arg\max_{(\mu,\sigma)}\mathbb{E}_{(a_{t},a_{t+1},\dots%
,a_{t+H})\sim\mathcal{N}(\mu,\sigma^{2})}\left[\gamma^{H}V(z_{t+H})+\sum_{h=t}%
^{H-1}\gamma^{h}R_{\theta^{R}}(z_{h},a_{h})\right]</annotation><annotation encoding="application/x-llamapun" id="S4.E10.m1.11d">italic_μ start_POSTSUPERSCRIPT italic_k + 1 end_POSTSUPERSCRIPT , italic_σ start_POSTSUPERSCRIPT italic_k + 1 end_POSTSUPERSCRIPT = roman_arg roman_max start_POSTSUBSCRIPT ( italic_μ , italic_σ ) end_POSTSUBSCRIPT blackboard_E start_POSTSUBSCRIPT ( italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_a start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT , … , italic_a start_POSTSUBSCRIPT italic_t + italic_H end_POSTSUBSCRIPT ) ∼ caligraphic_N ( italic_μ , italic_σ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ) end_POSTSUBSCRIPT [ italic_γ start_POSTSUPERSCRIPT italic_H end_POSTSUPERSCRIPT italic_V ( italic_z start_POSTSUBSCRIPT italic_t + italic_H end_POSTSUBSCRIPT ) + ∑ start_POSTSUBSCRIPT italic_h = italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_H - 1 end_POSTSUPERSCRIPT italic_γ start_POSTSUPERSCRIPT italic_h end_POSTSUPERSCRIPT italic_R start_POSTSUBSCRIPT italic_θ start_POSTSUPERSCRIPT italic_R end_POSTSUPERSCRIPT end_POSTSUBSCRIPT ( italic_z start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT , italic_a start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT ) ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS1.SSS0.Px3.p2.15">where <math alttext="V(z_{t+H})=Q_{\theta^{Q}}\left(z_{t+H},\pi_{\psi}(z_{t+h})\right)" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px3.p2.15.m1.3"><semantics id="S4.SS1.SSS0.Px3.p2.15.m1.3a"><mrow id="S4.SS1.SSS0.Px3.p2.15.m1.3.3" xref="S4.SS1.SSS0.Px3.p2.15.m1.3.3.cmml"><mrow id="S4.SS1.SSS0.Px3.p2.15.m1.1.1.1" xref="S4.SS1.SSS0.Px3.p2.15.m1.1.1.1.cmml"><mi id="S4.SS1.SSS0.Px3.p2.15.m1.1.1.1.3" xref="S4.SS1.SSS0.Px3.p2.15.m1.1.1.1.3.cmml">V</mi><mo id="S4.SS1.SSS0.Px3.p2.15.m1.1.1.1.2" xref="S4.SS1.SSS0.Px3.p2.15.m1.1.1.1.2.cmml">⁢</mo><mrow id="S4.SS1.SSS0.Px3.p2.15.m1.1.1.1.1.1" xref="S4.SS1.SSS0.Px3.p2.15.m1.1.1.1.1.1.1.cmml"><mo id="S4.SS1.SSS0.Px3.p2.15.m1.1.1.1.1.1.2" stretchy="false" xref="S4.SS1.SSS0.Px3.p2.15.m1.1.1.1.1.1.1.cmml">(</mo><msub id="S4.SS1.SSS0.Px3.p2.15.m1.1.1.1.1.1.1" xref="S4.SS1.SSS0.Px3.p2.15.m1.1.1.1.1.1.1.cmml"><mi id="S4.SS1.SSS0.Px3.p2.15.m1.1.1.1.1.1.1.2" xref="S4.SS1.SSS0.Px3.p2.15.m1.1.1.1.1.1.1.2.cmml">z</mi><mrow id="S4.SS1.SSS0.Px3.p2.15.m1.1.1.1.1.1.1.3" xref="S4.SS1.SSS0.Px3.p2.15.m1.1.1.1.1.1.1.3.cmml"><mi id="S4.SS1.SSS0.Px3.p2.15.m1.1.1.1.1.1.1.3.2" xref="S4.SS1.SSS0.Px3.p2.15.m1.1.1.1.1.1.1.3.2.cmml">t</mi><mo id="S4.SS1.SSS0.Px3.p2.15.m1.1.1.1.1.1.1.3.1" xref="S4.SS1.SSS0.Px3.p2.15.m1.1.1.1.1.1.1.3.1.cmml">+</mo><mi id="S4.SS1.SSS0.Px3.p2.15.m1.1.1.1.1.1.1.3.3" xref="S4.SS1.SSS0.Px3.p2.15.m1.1.1.1.1.1.1.3.3.cmml">H</mi></mrow></msub><mo id="S4.SS1.SSS0.Px3.p2.15.m1.1.1.1.1.1.3" stretchy="false" xref="S4.SS1.SSS0.Px3.p2.15.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.SS1.SSS0.Px3.p2.15.m1.3.3.4" xref="S4.SS1.SSS0.Px3.p2.15.m1.3.3.4.cmml">=</mo><mrow id="S4.SS1.SSS0.Px3.p2.15.m1.3.3.3" xref="S4.SS1.SSS0.Px3.p2.15.m1.3.3.3.cmml"><msub id="S4.SS1.SSS0.Px3.p2.15.m1.3.3.3.4" xref="S4.SS1.SSS0.Px3.p2.15.m1.3.3.3.4.cmml"><mi id="S4.SS1.SSS0.Px3.p2.15.m1.3.3.3.4.2" xref="S4.SS1.SSS0.Px3.p2.15.m1.3.3.3.4.2.cmml">Q</mi><msup id="S4.SS1.SSS0.Px3.p2.15.m1.3.3.3.4.3" xref="S4.SS1.SSS0.Px3.p2.15.m1.3.3.3.4.3.cmml"><mi id="S4.SS1.SSS0.Px3.p2.15.m1.3.3.3.4.3.2" xref="S4.SS1.SSS0.Px3.p2.15.m1.3.3.3.4.3.2.cmml">θ</mi><mi id="S4.SS1.SSS0.Px3.p2.15.m1.3.3.3.4.3.3" xref="S4.SS1.SSS0.Px3.p2.15.m1.3.3.3.4.3.3.cmml">Q</mi></msup></msub><mo id="S4.SS1.SSS0.Px3.p2.15.m1.3.3.3.3" xref="S4.SS1.SSS0.Px3.p2.15.m1.3.3.3.3.cmml">⁢</mo><mrow id="S4.SS1.SSS0.Px3.p2.15.m1.3.3.3.2.2" xref="S4.SS1.SSS0.Px3.p2.15.m1.3.3.3.2.3.cmml"><mo id="S4.SS1.SSS0.Px3.p2.15.m1.3.3.3.2.2.3" xref="S4.SS1.SSS0.Px3.p2.15.m1.3.3.3.2.3.cmml">(</mo><msub id="S4.SS1.SSS0.Px3.p2.15.m1.2.2.2.1.1.1" xref="S4.SS1.SSS0.Px3.p2.15.m1.2.2.2.1.1.1.cmml"><mi id="S4.SS1.SSS0.Px3.p2.15.m1.2.2.2.1.1.1.2" xref="S4.SS1.SSS0.Px3.p2.15.m1.2.2.2.1.1.1.2.cmml">z</mi><mrow id="S4.SS1.SSS0.Px3.p2.15.m1.2.2.2.1.1.1.3" xref="S4.SS1.SSS0.Px3.p2.15.m1.2.2.2.1.1.1.3.cmml"><mi id="S4.SS1.SSS0.Px3.p2.15.m1.2.2.2.1.1.1.3.2" xref="S4.SS1.SSS0.Px3.p2.15.m1.2.2.2.1.1.1.3.2.cmml">t</mi><mo id="S4.SS1.SSS0.Px3.p2.15.m1.2.2.2.1.1.1.3.1" xref="S4.SS1.SSS0.Px3.p2.15.m1.2.2.2.1.1.1.3.1.cmml">+</mo><mi id="S4.SS1.SSS0.Px3.p2.15.m1.2.2.2.1.1.1.3.3" xref="S4.SS1.SSS0.Px3.p2.15.m1.2.2.2.1.1.1.3.3.cmml">H</mi></mrow></msub><mo id="S4.SS1.SSS0.Px3.p2.15.m1.3.3.3.2.2.4" xref="S4.SS1.SSS0.Px3.p2.15.m1.3.3.3.2.3.cmml">,</mo><mrow id="S4.SS1.SSS0.Px3.p2.15.m1.3.3.3.2.2.2" xref="S4.SS1.SSS0.Px3.p2.15.m1.3.3.3.2.2.2.cmml"><msub id="S4.SS1.SSS0.Px3.p2.15.m1.3.3.3.2.2.2.3" xref="S4.SS1.SSS0.Px3.p2.15.m1.3.3.3.2.2.2.3.cmml"><mi id="S4.SS1.SSS0.Px3.p2.15.m1.3.3.3.2.2.2.3.2" xref="S4.SS1.SSS0.Px3.p2.15.m1.3.3.3.2.2.2.3.2.cmml">π</mi><mi id="S4.SS1.SSS0.Px3.p2.15.m1.3.3.3.2.2.2.3.3" xref="S4.SS1.SSS0.Px3.p2.15.m1.3.3.3.2.2.2.3.3.cmml">ψ</mi></msub><mo id="S4.SS1.SSS0.Px3.p2.15.m1.3.3.3.2.2.2.2" xref="S4.SS1.SSS0.Px3.p2.15.m1.3.3.3.2.2.2.2.cmml">⁢</mo><mrow id="S4.SS1.SSS0.Px3.p2.15.m1.3.3.3.2.2.2.1.1" xref="S4.SS1.SSS0.Px3.p2.15.m1.3.3.3.2.2.2.1.1.1.cmml"><mo id="S4.SS1.SSS0.Px3.p2.15.m1.3.3.3.2.2.2.1.1.2" stretchy="false" xref="S4.SS1.SSS0.Px3.p2.15.m1.3.3.3.2.2.2.1.1.1.cmml">(</mo><msub id="S4.SS1.SSS0.Px3.p2.15.m1.3.3.3.2.2.2.1.1.1" xref="S4.SS1.SSS0.Px3.p2.15.m1.3.3.3.2.2.2.1.1.1.cmml"><mi id="S4.SS1.SSS0.Px3.p2.15.m1.3.3.3.2.2.2.1.1.1.2" xref="S4.SS1.SSS0.Px3.p2.15.m1.3.3.3.2.2.2.1.1.1.2.cmml">z</mi><mrow id="S4.SS1.SSS0.Px3.p2.15.m1.3.3.3.2.2.2.1.1.1.3" xref="S4.SS1.SSS0.Px3.p2.15.m1.3.3.3.2.2.2.1.1.1.3.cmml"><mi id="S4.SS1.SSS0.Px3.p2.15.m1.3.3.3.2.2.2.1.1.1.3.2" xref="S4.SS1.SSS0.Px3.p2.15.m1.3.3.3.2.2.2.1.1.1.3.2.cmml">t</mi><mo id="S4.SS1.SSS0.Px3.p2.15.m1.3.3.3.2.2.2.1.1.1.3.1" xref="S4.SS1.SSS0.Px3.p2.15.m1.3.3.3.2.2.2.1.1.1.3.1.cmml">+</mo><mi id="S4.SS1.SSS0.Px3.p2.15.m1.3.3.3.2.2.2.1.1.1.3.3" xref="S4.SS1.SSS0.Px3.p2.15.m1.3.3.3.2.2.2.1.1.1.3.3.cmml">h</mi></mrow></msub><mo id="S4.SS1.SSS0.Px3.p2.15.m1.3.3.3.2.2.2.1.1.3" stretchy="false" xref="S4.SS1.SSS0.Px3.p2.15.m1.3.3.3.2.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.SS1.SSS0.Px3.p2.15.m1.3.3.3.2.2.5" xref="S4.SS1.SSS0.Px3.p2.15.m1.3.3.3.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px3.p2.15.m1.3b"><apply id="S4.SS1.SSS0.Px3.p2.15.m1.3.3.cmml" xref="S4.SS1.SSS0.Px3.p2.15.m1.3.3"><eq id="S4.SS1.SSS0.Px3.p2.15.m1.3.3.4.cmml" xref="S4.SS1.SSS0.Px3.p2.15.m1.3.3.4"></eq><apply id="S4.SS1.SSS0.Px3.p2.15.m1.1.1.1.cmml" xref="S4.SS1.SSS0.Px3.p2.15.m1.1.1.1"><times id="S4.SS1.SSS0.Px3.p2.15.m1.1.1.1.2.cmml" xref="S4.SS1.SSS0.Px3.p2.15.m1.1.1.1.2"></times><ci id="S4.SS1.SSS0.Px3.p2.15.m1.1.1.1.3.cmml" xref="S4.SS1.SSS0.Px3.p2.15.m1.1.1.1.3">𝑉</ci><apply id="S4.SS1.SSS0.Px3.p2.15.m1.1.1.1.1.1.1.cmml" xref="S4.SS1.SSS0.Px3.p2.15.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px3.p2.15.m1.1.1.1.1.1.1.1.cmml" xref="S4.SS1.SSS0.Px3.p2.15.m1.1.1.1.1.1">subscript</csymbol><ci id="S4.SS1.SSS0.Px3.p2.15.m1.1.1.1.1.1.1.2.cmml" xref="S4.SS1.SSS0.Px3.p2.15.m1.1.1.1.1.1.1.2">𝑧</ci><apply id="S4.SS1.SSS0.Px3.p2.15.m1.1.1.1.1.1.1.3.cmml" xref="S4.SS1.SSS0.Px3.p2.15.m1.1.1.1.1.1.1.3"><plus id="S4.SS1.SSS0.Px3.p2.15.m1.1.1.1.1.1.1.3.1.cmml" xref="S4.SS1.SSS0.Px3.p2.15.m1.1.1.1.1.1.1.3.1"></plus><ci id="S4.SS1.SSS0.Px3.p2.15.m1.1.1.1.1.1.1.3.2.cmml" xref="S4.SS1.SSS0.Px3.p2.15.m1.1.1.1.1.1.1.3.2">𝑡</ci><ci id="S4.SS1.SSS0.Px3.p2.15.m1.1.1.1.1.1.1.3.3.cmml" xref="S4.SS1.SSS0.Px3.p2.15.m1.1.1.1.1.1.1.3.3">𝐻</ci></apply></apply></apply><apply id="S4.SS1.SSS0.Px3.p2.15.m1.3.3.3.cmml" xref="S4.SS1.SSS0.Px3.p2.15.m1.3.3.3"><times id="S4.SS1.SSS0.Px3.p2.15.m1.3.3.3.3.cmml" xref="S4.SS1.SSS0.Px3.p2.15.m1.3.3.3.3"></times><apply id="S4.SS1.SSS0.Px3.p2.15.m1.3.3.3.4.cmml" xref="S4.SS1.SSS0.Px3.p2.15.m1.3.3.3.4"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px3.p2.15.m1.3.3.3.4.1.cmml" xref="S4.SS1.SSS0.Px3.p2.15.m1.3.3.3.4">subscript</csymbol><ci id="S4.SS1.SSS0.Px3.p2.15.m1.3.3.3.4.2.cmml" xref="S4.SS1.SSS0.Px3.p2.15.m1.3.3.3.4.2">𝑄</ci><apply id="S4.SS1.SSS0.Px3.p2.15.m1.3.3.3.4.3.cmml" xref="S4.SS1.SSS0.Px3.p2.15.m1.3.3.3.4.3"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px3.p2.15.m1.3.3.3.4.3.1.cmml" xref="S4.SS1.SSS0.Px3.p2.15.m1.3.3.3.4.3">superscript</csymbol><ci id="S4.SS1.SSS0.Px3.p2.15.m1.3.3.3.4.3.2.cmml" xref="S4.SS1.SSS0.Px3.p2.15.m1.3.3.3.4.3.2">𝜃</ci><ci id="S4.SS1.SSS0.Px3.p2.15.m1.3.3.3.4.3.3.cmml" xref="S4.SS1.SSS0.Px3.p2.15.m1.3.3.3.4.3.3">𝑄</ci></apply></apply><interval closure="open" id="S4.SS1.SSS0.Px3.p2.15.m1.3.3.3.2.3.cmml" xref="S4.SS1.SSS0.Px3.p2.15.m1.3.3.3.2.2"><apply id="S4.SS1.SSS0.Px3.p2.15.m1.2.2.2.1.1.1.cmml" xref="S4.SS1.SSS0.Px3.p2.15.m1.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px3.p2.15.m1.2.2.2.1.1.1.1.cmml" xref="S4.SS1.SSS0.Px3.p2.15.m1.2.2.2.1.1.1">subscript</csymbol><ci id="S4.SS1.SSS0.Px3.p2.15.m1.2.2.2.1.1.1.2.cmml" xref="S4.SS1.SSS0.Px3.p2.15.m1.2.2.2.1.1.1.2">𝑧</ci><apply id="S4.SS1.SSS0.Px3.p2.15.m1.2.2.2.1.1.1.3.cmml" xref="S4.SS1.SSS0.Px3.p2.15.m1.2.2.2.1.1.1.3"><plus id="S4.SS1.SSS0.Px3.p2.15.m1.2.2.2.1.1.1.3.1.cmml" xref="S4.SS1.SSS0.Px3.p2.15.m1.2.2.2.1.1.1.3.1"></plus><ci id="S4.SS1.SSS0.Px3.p2.15.m1.2.2.2.1.1.1.3.2.cmml" xref="S4.SS1.SSS0.Px3.p2.15.m1.2.2.2.1.1.1.3.2">𝑡</ci><ci id="S4.SS1.SSS0.Px3.p2.15.m1.2.2.2.1.1.1.3.3.cmml" xref="S4.SS1.SSS0.Px3.p2.15.m1.2.2.2.1.1.1.3.3">𝐻</ci></apply></apply><apply id="S4.SS1.SSS0.Px3.p2.15.m1.3.3.3.2.2.2.cmml" xref="S4.SS1.SSS0.Px3.p2.15.m1.3.3.3.2.2.2"><times id="S4.SS1.SSS0.Px3.p2.15.m1.3.3.3.2.2.2.2.cmml" xref="S4.SS1.SSS0.Px3.p2.15.m1.3.3.3.2.2.2.2"></times><apply id="S4.SS1.SSS0.Px3.p2.15.m1.3.3.3.2.2.2.3.cmml" xref="S4.SS1.SSS0.Px3.p2.15.m1.3.3.3.2.2.2.3"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px3.p2.15.m1.3.3.3.2.2.2.3.1.cmml" xref="S4.SS1.SSS0.Px3.p2.15.m1.3.3.3.2.2.2.3">subscript</csymbol><ci id="S4.SS1.SSS0.Px3.p2.15.m1.3.3.3.2.2.2.3.2.cmml" xref="S4.SS1.SSS0.Px3.p2.15.m1.3.3.3.2.2.2.3.2">𝜋</ci><ci id="S4.SS1.SSS0.Px3.p2.15.m1.3.3.3.2.2.2.3.3.cmml" xref="S4.SS1.SSS0.Px3.p2.15.m1.3.3.3.2.2.2.3.3">𝜓</ci></apply><apply id="S4.SS1.SSS0.Px3.p2.15.m1.3.3.3.2.2.2.1.1.1.cmml" xref="S4.SS1.SSS0.Px3.p2.15.m1.3.3.3.2.2.2.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px3.p2.15.m1.3.3.3.2.2.2.1.1.1.1.cmml" xref="S4.SS1.SSS0.Px3.p2.15.m1.3.3.3.2.2.2.1.1">subscript</csymbol><ci id="S4.SS1.SSS0.Px3.p2.15.m1.3.3.3.2.2.2.1.1.1.2.cmml" xref="S4.SS1.SSS0.Px3.p2.15.m1.3.3.3.2.2.2.1.1.1.2">𝑧</ci><apply id="S4.SS1.SSS0.Px3.p2.15.m1.3.3.3.2.2.2.1.1.1.3.cmml" xref="S4.SS1.SSS0.Px3.p2.15.m1.3.3.3.2.2.2.1.1.1.3"><plus id="S4.SS1.SSS0.Px3.p2.15.m1.3.3.3.2.2.2.1.1.1.3.1.cmml" xref="S4.SS1.SSS0.Px3.p2.15.m1.3.3.3.2.2.2.1.1.1.3.1"></plus><ci id="S4.SS1.SSS0.Px3.p2.15.m1.3.3.3.2.2.2.1.1.1.3.2.cmml" xref="S4.SS1.SSS0.Px3.p2.15.m1.3.3.3.2.2.2.1.1.1.3.2">𝑡</ci><ci id="S4.SS1.SSS0.Px3.p2.15.m1.3.3.3.2.2.2.1.1.1.3.3.cmml" xref="S4.SS1.SSS0.Px3.p2.15.m1.3.3.3.2.2.2.1.1.1.3.3">ℎ</ci></apply></apply></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px3.p2.15.m1.3c">V(z_{t+H})=Q_{\theta^{Q}}\left(z_{t+H},\pi_{\psi}(z_{t+h})\right)</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px3.p2.15.m1.3d">italic_V ( italic_z start_POSTSUBSCRIPT italic_t + italic_H end_POSTSUBSCRIPT ) = italic_Q start_POSTSUBSCRIPT italic_θ start_POSTSUPERSCRIPT italic_Q end_POSTSUPERSCRIPT end_POSTSUBSCRIPT ( italic_z start_POSTSUBSCRIPT italic_t + italic_H end_POSTSUBSCRIPT , italic_π start_POSTSUBSCRIPT italic_ψ end_POSTSUBSCRIPT ( italic_z start_POSTSUBSCRIPT italic_t + italic_h end_POSTSUBSCRIPT ) )</annotation></semantics></math>.
We continue this calculation until it reaches the given number of iterations. More details can be found in <cite class="ltx_cite ltx_citemacro_citep">(Hansen et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#bib.bib17" title="">2022</a>; Williams et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#bib.bib42" title="">2016</a>; <a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#bib.bib43" title="">2018</a>)</cite>.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Theoretical Analysis</h3>
<div class="ltx_para ltx_noindent" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.1">It is important to measure the quality of the learned representation space.
In this section, we show that BS-MPC upper-bounds expected cumulative reward by leveraging value function bounds derived from the on-policy bisimulation metric. This property, absent in TD-MPC, strongly differentiates BS-MPC.</p>
</div>
<div class="ltx_para" id="S4.SS2.p2">
<p class="ltx_p" id="S4.SS2.p2.1">We assume that the learned policy in BS-MPC continuously improves throughout training and eventually converges to the optimal policy <math alttext="\pi^{*}" class="ltx_Math" display="inline" id="S4.SS2.p2.1.m1.1"><semantics id="S4.SS2.p2.1.m1.1a"><msup id="S4.SS2.p2.1.m1.1.1" xref="S4.SS2.p2.1.m1.1.1.cmml"><mi id="S4.SS2.p2.1.m1.1.1.2" xref="S4.SS2.p2.1.m1.1.1.2.cmml">π</mi><mo id="S4.SS2.p2.1.m1.1.1.3" xref="S4.SS2.p2.1.m1.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.1.m1.1b"><apply id="S4.SS2.p2.1.m1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.1.m1.1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1">superscript</csymbol><ci id="S4.SS2.p2.1.m1.1.1.2.cmml" xref="S4.SS2.p2.1.m1.1.1.2">𝜋</ci><times id="S4.SS2.p2.1.m1.1.1.3.cmml" xref="S4.SS2.p2.1.m1.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.1.m1.1c">\pi^{*}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.1.m1.1d">italic_π start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math>, which supports Theorem <a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#Thmthm1" title="Theorem 1. ‣ 4.2 Theoretical Analysis ‣ 4 Bisimulation metric for model predictive control ‣ Bisimulation metric for Model Predictive Control"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<div class="ltx_theorem ltx_theorem_thm" id="Thmthm1">
<h6 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span class="ltx_text ltx_font_bold" id="Thmthm1.1.1.1">Theorem 1</span></span><span class="ltx_text ltx_font_bold" id="Thmthm1.2.2">.</span>
</h6>
<div class="ltx_para" id="Thmthm1.p1">
<p class="ltx_p" id="Thmthm1.p1.4">(Theorem 1 in <cite class="ltx_cite ltx_citemacro_citep">(Zhang et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#bib.bib47" title="">2021</a>)</cite>) 
Let’s assume a policy <math alttext="\pi" class="ltx_Math" display="inline" id="Thmthm1.p1.1.m1.1"><semantics id="Thmthm1.p1.1.m1.1a"><mi id="Thmthm1.p1.1.m1.1.1" xref="Thmthm1.p1.1.m1.1.1.cmml">π</mi><annotation-xml encoding="MathML-Content" id="Thmthm1.p1.1.m1.1b"><ci id="Thmthm1.p1.1.m1.1.1.cmml" xref="Thmthm1.p1.1.m1.1.1">𝜋</ci></annotation-xml><annotation encoding="application/x-tex" id="Thmthm1.p1.1.m1.1c">\pi</annotation><annotation encoding="application/x-llamapun" id="Thmthm1.p1.1.m1.1d">italic_π</annotation></semantics></math> in BS-MPC continuously improves over time, converging to the optimal policy <math alttext="\pi^{*}" class="ltx_Math" display="inline" id="Thmthm1.p1.2.m2.1"><semantics id="Thmthm1.p1.2.m2.1a"><msup id="Thmthm1.p1.2.m2.1.1" xref="Thmthm1.p1.2.m2.1.1.cmml"><mi id="Thmthm1.p1.2.m2.1.1.2" xref="Thmthm1.p1.2.m2.1.1.2.cmml">π</mi><mo id="Thmthm1.p1.2.m2.1.1.3" xref="Thmthm1.p1.2.m2.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="Thmthm1.p1.2.m2.1b"><apply id="Thmthm1.p1.2.m2.1.1.cmml" xref="Thmthm1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="Thmthm1.p1.2.m2.1.1.1.cmml" xref="Thmthm1.p1.2.m2.1.1">superscript</csymbol><ci id="Thmthm1.p1.2.m2.1.1.2.cmml" xref="Thmthm1.p1.2.m2.1.1.2">𝜋</ci><times id="Thmthm1.p1.2.m2.1.1.3.cmml" xref="Thmthm1.p1.2.m2.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmthm1.p1.2.m2.1c">\pi^{*}</annotation><annotation encoding="application/x-llamapun" id="Thmthm1.p1.2.m2.1d">italic_π start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math>. Under this assumption, the following bisimulation metric has a least fixed point <math alttext="\tilde{d}" class="ltx_Math" display="inline" id="Thmthm1.p1.3.m3.1"><semantics id="Thmthm1.p1.3.m3.1a"><mover accent="true" id="Thmthm1.p1.3.m3.1.1" xref="Thmthm1.p1.3.m3.1.1.cmml"><mi id="Thmthm1.p1.3.m3.1.1.2" xref="Thmthm1.p1.3.m3.1.1.2.cmml">d</mi><mo id="Thmthm1.p1.3.m3.1.1.1" xref="Thmthm1.p1.3.m3.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="Thmthm1.p1.3.m3.1b"><apply id="Thmthm1.p1.3.m3.1.1.cmml" xref="Thmthm1.p1.3.m3.1.1"><ci id="Thmthm1.p1.3.m3.1.1.1.cmml" xref="Thmthm1.p1.3.m3.1.1.1">~</ci><ci id="Thmthm1.p1.3.m3.1.1.2.cmml" xref="Thmthm1.p1.3.m3.1.1.2">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmthm1.p1.3.m3.1c">\tilde{d}</annotation><annotation encoding="application/x-llamapun" id="Thmthm1.p1.3.m3.1d">over~ start_ARG italic_d end_ARG</annotation></semantics></math> and that is a <math alttext="\pi^{*}" class="ltx_Math" display="inline" id="Thmthm1.p1.4.m4.1"><semantics id="Thmthm1.p1.4.m4.1a"><msup id="Thmthm1.p1.4.m4.1.1" xref="Thmthm1.p1.4.m4.1.1.cmml"><mi id="Thmthm1.p1.4.m4.1.1.2" xref="Thmthm1.p1.4.m4.1.1.2.cmml">π</mi><mo id="Thmthm1.p1.4.m4.1.1.3" xref="Thmthm1.p1.4.m4.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="Thmthm1.p1.4.m4.1b"><apply id="Thmthm1.p1.4.m4.1.1.cmml" xref="Thmthm1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="Thmthm1.p1.4.m4.1.1.1.cmml" xref="Thmthm1.p1.4.m4.1.1">superscript</csymbol><ci id="Thmthm1.p1.4.m4.1.1.2.cmml" xref="Thmthm1.p1.4.m4.1.1.2">𝜋</ci><times id="Thmthm1.p1.4.m4.1.1.3.cmml" xref="Thmthm1.p1.4.m4.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmthm1.p1.4.m4.1c">\pi^{*}</annotation><annotation encoding="application/x-llamapun" id="Thmthm1.p1.4.m4.1d">italic_π start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math>-bisimulation metric.</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E11">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="d(s_{i},s_{j})=(1-c)|r_{s_{i}}^{\pi}-r_{s_{j}}^{\pi}|+cW_{p}(d)(\mathcal{P}^{%
\pi}(\cdot|s_{i}),\mathcal{P}^{\pi}(\cdot|s_{j}))." class="ltx_math_unparsed" display="block" id="S4.E11.m1.1"><semantics id="S4.E11.m1.1a"><mrow id="S4.E11.m1.1b"><mi id="S4.E11.m1.1.2">d</mi><mrow id="S4.E11.m1.1.3"><mo id="S4.E11.m1.1.3.1" stretchy="false">(</mo><msub id="S4.E11.m1.1.3.2"><mi id="S4.E11.m1.1.3.2.2">s</mi><mi id="S4.E11.m1.1.3.2.3">i</mi></msub><mo id="S4.E11.m1.1.3.3">,</mo><msub id="S4.E11.m1.1.3.4"><mi id="S4.E11.m1.1.3.4.2">s</mi><mi id="S4.E11.m1.1.3.4.3">j</mi></msub><mo id="S4.E11.m1.1.3.5" stretchy="false">)</mo></mrow><mo id="S4.E11.m1.1.4">=</mo><mrow id="S4.E11.m1.1.5"><mo id="S4.E11.m1.1.5.1" stretchy="false">(</mo><mn id="S4.E11.m1.1.5.2">1</mn><mo id="S4.E11.m1.1.5.3">−</mo><mi id="S4.E11.m1.1.5.4">c</mi><mo id="S4.E11.m1.1.5.5" stretchy="false">)</mo></mrow><mo fence="false" id="S4.E11.m1.1.6" rspace="0.167em" stretchy="false">|</mo><msubsup id="S4.E11.m1.1.7"><mi id="S4.E11.m1.1.7.2.2">r</mi><msub id="S4.E11.m1.1.7.2.3"><mi id="S4.E11.m1.1.7.2.3.2">s</mi><mi id="S4.E11.m1.1.7.2.3.3">i</mi></msub><mi id="S4.E11.m1.1.7.3">π</mi></msubsup><mo id="S4.E11.m1.1.8">−</mo><msubsup id="S4.E11.m1.1.9"><mi id="S4.E11.m1.1.9.2.2">r</mi><msub id="S4.E11.m1.1.9.2.3"><mi id="S4.E11.m1.1.9.2.3.2">s</mi><mi id="S4.E11.m1.1.9.2.3.3">j</mi></msub><mi id="S4.E11.m1.1.9.3">π</mi></msubsup><mo fence="false" id="S4.E11.m1.1.10" stretchy="false">|</mo><mo id="S4.E11.m1.1.11" lspace="0em">+</mo><mi id="S4.E11.m1.1.12">c</mi><msub id="S4.E11.m1.1.13"><mi id="S4.E11.m1.1.13.2">W</mi><mi id="S4.E11.m1.1.13.3">p</mi></msub><mrow id="S4.E11.m1.1.14"><mo id="S4.E11.m1.1.14.1" stretchy="false">(</mo><mi id="S4.E11.m1.1.1">d</mi><mo id="S4.E11.m1.1.14.2" stretchy="false">)</mo></mrow><mrow id="S4.E11.m1.1.15"><mo id="S4.E11.m1.1.15.1" stretchy="false">(</mo><msup id="S4.E11.m1.1.15.2"><mi class="ltx_font_mathcaligraphic" id="S4.E11.m1.1.15.2.2">𝒫</mi><mi id="S4.E11.m1.1.15.2.3">π</mi></msup><mrow id="S4.E11.m1.1.15.3"><mo id="S4.E11.m1.1.15.3.1" stretchy="false">(</mo><mo id="S4.E11.m1.1.15.3.2" lspace="0em" rspace="0em">⋅</mo><mo fence="false" id="S4.E11.m1.1.15.3.3" rspace="0.167em" stretchy="false">|</mo><msub id="S4.E11.m1.1.15.3.4"><mi id="S4.E11.m1.1.15.3.4.2">s</mi><mi id="S4.E11.m1.1.15.3.4.3">i</mi></msub><mo id="S4.E11.m1.1.15.3.5" stretchy="false">)</mo></mrow><mo id="S4.E11.m1.1.15.4">,</mo><msup id="S4.E11.m1.1.15.5"><mi class="ltx_font_mathcaligraphic" id="S4.E11.m1.1.15.5.2">𝒫</mi><mi id="S4.E11.m1.1.15.5.3">π</mi></msup><mrow id="S4.E11.m1.1.15.6"><mo id="S4.E11.m1.1.15.6.1" stretchy="false">(</mo><mo id="S4.E11.m1.1.15.6.2" lspace="0em" rspace="0em">⋅</mo><mo fence="false" id="S4.E11.m1.1.15.6.3" rspace="0.167em" stretchy="false">|</mo><msub id="S4.E11.m1.1.15.6.4"><mi id="S4.E11.m1.1.15.6.4.2">s</mi><mi id="S4.E11.m1.1.15.6.4.3">j</mi></msub><mo id="S4.E11.m1.1.15.6.5" stretchy="false">)</mo></mrow><mo id="S4.E11.m1.1.15.7" stretchy="false">)</mo></mrow><mo id="S4.E11.m1.1.16" lspace="0em">.</mo></mrow><annotation encoding="application/x-tex" id="S4.E11.m1.1c">d(s_{i},s_{j})=(1-c)|r_{s_{i}}^{\pi}-r_{s_{j}}^{\pi}|+cW_{p}(d)(\mathcal{P}^{%
\pi}(\cdot|s_{i}),\mathcal{P}^{\pi}(\cdot|s_{j})).</annotation><annotation encoding="application/x-llamapun" id="S4.E11.m1.1d">italic_d ( italic_s start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_s start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) = ( 1 - italic_c ) | italic_r start_POSTSUBSCRIPT italic_s start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_π end_POSTSUPERSCRIPT - italic_r start_POSTSUBSCRIPT italic_s start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_π end_POSTSUPERSCRIPT | + italic_c italic_W start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ( italic_d ) ( caligraphic_P start_POSTSUPERSCRIPT italic_π end_POSTSUPERSCRIPT ( ⋅ | italic_s start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) , caligraphic_P start_POSTSUPERSCRIPT italic_π end_POSTSUPERSCRIPT ( ⋅ | italic_s start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(11)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="Thmthm1.p1.8">where <math alttext="W_{p}(d)(\mathcal{P}_{i},\mathcal{P}_{j})=\left(\inf_{\gamma^{\prime}\in\Gamma%
(\mathcal{P}_{i},\mathcal{P}_{j})}\int_{\mathcal{S}\times\mathcal{S}}d(s_{i},s%
_{j})^{p}\,d\gamma^{\prime}(s_{i},s_{j})\right)^{1/p}" class="ltx_Math" display="inline" id="Thmthm1.p1.5.m1.6"><semantics id="Thmthm1.p1.5.m1.6a"><mrow id="Thmthm1.p1.5.m1.6.6" xref="Thmthm1.p1.5.m1.6.6.cmml"><mrow id="Thmthm1.p1.5.m1.5.5.2" xref="Thmthm1.p1.5.m1.5.5.2.cmml"><msub id="Thmthm1.p1.5.m1.5.5.2.4" xref="Thmthm1.p1.5.m1.5.5.2.4.cmml"><mi id="Thmthm1.p1.5.m1.5.5.2.4.2" xref="Thmthm1.p1.5.m1.5.5.2.4.2.cmml">W</mi><mi id="Thmthm1.p1.5.m1.5.5.2.4.3" xref="Thmthm1.p1.5.m1.5.5.2.4.3.cmml">p</mi></msub><mo id="Thmthm1.p1.5.m1.5.5.2.3" xref="Thmthm1.p1.5.m1.5.5.2.3.cmml">⁢</mo><mrow id="Thmthm1.p1.5.m1.5.5.2.5.2" xref="Thmthm1.p1.5.m1.5.5.2.cmml"><mo id="Thmthm1.p1.5.m1.5.5.2.5.2.1" stretchy="false" xref="Thmthm1.p1.5.m1.5.5.2.cmml">(</mo><mi id="Thmthm1.p1.5.m1.3.3" xref="Thmthm1.p1.5.m1.3.3.cmml">d</mi><mo id="Thmthm1.p1.5.m1.5.5.2.5.2.2" stretchy="false" xref="Thmthm1.p1.5.m1.5.5.2.cmml">)</mo></mrow><mo id="Thmthm1.p1.5.m1.5.5.2.3a" xref="Thmthm1.p1.5.m1.5.5.2.3.cmml">⁢</mo><mrow id="Thmthm1.p1.5.m1.5.5.2.2.2" xref="Thmthm1.p1.5.m1.5.5.2.2.3.cmml"><mo id="Thmthm1.p1.5.m1.5.5.2.2.2.3" stretchy="false" xref="Thmthm1.p1.5.m1.5.5.2.2.3.cmml">(</mo><msub id="Thmthm1.p1.5.m1.4.4.1.1.1.1" xref="Thmthm1.p1.5.m1.4.4.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="Thmthm1.p1.5.m1.4.4.1.1.1.1.2" xref="Thmthm1.p1.5.m1.4.4.1.1.1.1.2.cmml">𝒫</mi><mi id="Thmthm1.p1.5.m1.4.4.1.1.1.1.3" xref="Thmthm1.p1.5.m1.4.4.1.1.1.1.3.cmml">i</mi></msub><mo id="Thmthm1.p1.5.m1.5.5.2.2.2.4" xref="Thmthm1.p1.5.m1.5.5.2.2.3.cmml">,</mo><msub id="Thmthm1.p1.5.m1.5.5.2.2.2.2" xref="Thmthm1.p1.5.m1.5.5.2.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="Thmthm1.p1.5.m1.5.5.2.2.2.2.2" xref="Thmthm1.p1.5.m1.5.5.2.2.2.2.2.cmml">𝒫</mi><mi id="Thmthm1.p1.5.m1.5.5.2.2.2.2.3" xref="Thmthm1.p1.5.m1.5.5.2.2.2.2.3.cmml">j</mi></msub><mo id="Thmthm1.p1.5.m1.5.5.2.2.2.5" stretchy="false" xref="Thmthm1.p1.5.m1.5.5.2.2.3.cmml">)</mo></mrow></mrow><mo id="Thmthm1.p1.5.m1.6.6.4" xref="Thmthm1.p1.5.m1.6.6.4.cmml">=</mo><msup id="Thmthm1.p1.5.m1.6.6.3" xref="Thmthm1.p1.5.m1.6.6.3.cmml"><mrow id="Thmthm1.p1.5.m1.6.6.3.1.1" xref="Thmthm1.p1.5.m1.6.6.3.1.1.1.cmml"><mo id="Thmthm1.p1.5.m1.6.6.3.1.1.2" xref="Thmthm1.p1.5.m1.6.6.3.1.1.1.cmml">(</mo><mrow id="Thmthm1.p1.5.m1.6.6.3.1.1.1" xref="Thmthm1.p1.5.m1.6.6.3.1.1.1.cmml"><msub id="Thmthm1.p1.5.m1.6.6.3.1.1.1.5" xref="Thmthm1.p1.5.m1.6.6.3.1.1.1.5.cmml"><mo id="Thmthm1.p1.5.m1.6.6.3.1.1.1.5.2" lspace="0em" rspace="0em" xref="Thmthm1.p1.5.m1.6.6.3.1.1.1.5.2.cmml">inf</mo><mrow id="Thmthm1.p1.5.m1.2.2.2" xref="Thmthm1.p1.5.m1.2.2.2.cmml"><msup id="Thmthm1.p1.5.m1.2.2.2.4" xref="Thmthm1.p1.5.m1.2.2.2.4.cmml"><mi id="Thmthm1.p1.5.m1.2.2.2.4.2" xref="Thmthm1.p1.5.m1.2.2.2.4.2.cmml">γ</mi><mo id="Thmthm1.p1.5.m1.2.2.2.4.3" xref="Thmthm1.p1.5.m1.2.2.2.4.3.cmml">′</mo></msup><mo id="Thmthm1.p1.5.m1.2.2.2.3" xref="Thmthm1.p1.5.m1.2.2.2.3.cmml">∈</mo><mrow id="Thmthm1.p1.5.m1.2.2.2.2" xref="Thmthm1.p1.5.m1.2.2.2.2.cmml"><mi id="Thmthm1.p1.5.m1.2.2.2.2.4" mathvariant="normal" xref="Thmthm1.p1.5.m1.2.2.2.2.4.cmml">Γ</mi><mo id="Thmthm1.p1.5.m1.2.2.2.2.3" xref="Thmthm1.p1.5.m1.2.2.2.2.3.cmml">⁢</mo><mrow id="Thmthm1.p1.5.m1.2.2.2.2.2.2" xref="Thmthm1.p1.5.m1.2.2.2.2.2.3.cmml"><mo id="Thmthm1.p1.5.m1.2.2.2.2.2.2.3" stretchy="false" xref="Thmthm1.p1.5.m1.2.2.2.2.2.3.cmml">(</mo><msub id="Thmthm1.p1.5.m1.1.1.1.1.1.1.1" xref="Thmthm1.p1.5.m1.1.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="Thmthm1.p1.5.m1.1.1.1.1.1.1.1.2" xref="Thmthm1.p1.5.m1.1.1.1.1.1.1.1.2.cmml">𝒫</mi><mi id="Thmthm1.p1.5.m1.1.1.1.1.1.1.1.3" xref="Thmthm1.p1.5.m1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="Thmthm1.p1.5.m1.2.2.2.2.2.2.4" xref="Thmthm1.p1.5.m1.2.2.2.2.2.3.cmml">,</mo><msub id="Thmthm1.p1.5.m1.2.2.2.2.2.2.2" xref="Thmthm1.p1.5.m1.2.2.2.2.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="Thmthm1.p1.5.m1.2.2.2.2.2.2.2.2" xref="Thmthm1.p1.5.m1.2.2.2.2.2.2.2.2.cmml">𝒫</mi><mi id="Thmthm1.p1.5.m1.2.2.2.2.2.2.2.3" xref="Thmthm1.p1.5.m1.2.2.2.2.2.2.2.3.cmml">j</mi></msub><mo id="Thmthm1.p1.5.m1.2.2.2.2.2.2.5" stretchy="false" xref="Thmthm1.p1.5.m1.2.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></msub><mrow id="Thmthm1.p1.5.m1.6.6.3.1.1.1.4" xref="Thmthm1.p1.5.m1.6.6.3.1.1.1.4.cmml"><msub id="Thmthm1.p1.5.m1.6.6.3.1.1.1.4.5" xref="Thmthm1.p1.5.m1.6.6.3.1.1.1.4.5.cmml"><mo id="Thmthm1.p1.5.m1.6.6.3.1.1.1.4.5.2" xref="Thmthm1.p1.5.m1.6.6.3.1.1.1.4.5.2.cmml">∫</mo><mrow id="Thmthm1.p1.5.m1.6.6.3.1.1.1.4.5.3" xref="Thmthm1.p1.5.m1.6.6.3.1.1.1.4.5.3.cmml"><mi class="ltx_font_mathcaligraphic" id="Thmthm1.p1.5.m1.6.6.3.1.1.1.4.5.3.2" xref="Thmthm1.p1.5.m1.6.6.3.1.1.1.4.5.3.2.cmml">𝒮</mi><mo id="Thmthm1.p1.5.m1.6.6.3.1.1.1.4.5.3.1" lspace="0.222em" rspace="0.222em" xref="Thmthm1.p1.5.m1.6.6.3.1.1.1.4.5.3.1.cmml">×</mo><mi class="ltx_font_mathcaligraphic" id="Thmthm1.p1.5.m1.6.6.3.1.1.1.4.5.3.3" xref="Thmthm1.p1.5.m1.6.6.3.1.1.1.4.5.3.3.cmml">𝒮</mi></mrow></msub><mrow id="Thmthm1.p1.5.m1.6.6.3.1.1.1.4.4" xref="Thmthm1.p1.5.m1.6.6.3.1.1.1.4.4.cmml"><mi id="Thmthm1.p1.5.m1.6.6.3.1.1.1.4.4.6" xref="Thmthm1.p1.5.m1.6.6.3.1.1.1.4.4.6.cmml">d</mi><mo id="Thmthm1.p1.5.m1.6.6.3.1.1.1.4.4.5" xref="Thmthm1.p1.5.m1.6.6.3.1.1.1.4.4.5.cmml">⁢</mo><msup id="Thmthm1.p1.5.m1.6.6.3.1.1.1.2.2.2" xref="Thmthm1.p1.5.m1.6.6.3.1.1.1.2.2.2.cmml"><mrow id="Thmthm1.p1.5.m1.6.6.3.1.1.1.2.2.2.2.2" xref="Thmthm1.p1.5.m1.6.6.3.1.1.1.2.2.2.2.3.cmml"><mo id="Thmthm1.p1.5.m1.6.6.3.1.1.1.2.2.2.2.2.3" stretchy="false" xref="Thmthm1.p1.5.m1.6.6.3.1.1.1.2.2.2.2.3.cmml">(</mo><msub id="Thmthm1.p1.5.m1.6.6.3.1.1.1.1.1.1.1.1.1" xref="Thmthm1.p1.5.m1.6.6.3.1.1.1.1.1.1.1.1.1.cmml"><mi id="Thmthm1.p1.5.m1.6.6.3.1.1.1.1.1.1.1.1.1.2" xref="Thmthm1.p1.5.m1.6.6.3.1.1.1.1.1.1.1.1.1.2.cmml">s</mi><mi id="Thmthm1.p1.5.m1.6.6.3.1.1.1.1.1.1.1.1.1.3" xref="Thmthm1.p1.5.m1.6.6.3.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="Thmthm1.p1.5.m1.6.6.3.1.1.1.2.2.2.2.2.4" xref="Thmthm1.p1.5.m1.6.6.3.1.1.1.2.2.2.2.3.cmml">,</mo><msub id="Thmthm1.p1.5.m1.6.6.3.1.1.1.2.2.2.2.2.2" xref="Thmthm1.p1.5.m1.6.6.3.1.1.1.2.2.2.2.2.2.cmml"><mi id="Thmthm1.p1.5.m1.6.6.3.1.1.1.2.2.2.2.2.2.2" xref="Thmthm1.p1.5.m1.6.6.3.1.1.1.2.2.2.2.2.2.2.cmml">s</mi><mi id="Thmthm1.p1.5.m1.6.6.3.1.1.1.2.2.2.2.2.2.3" xref="Thmthm1.p1.5.m1.6.6.3.1.1.1.2.2.2.2.2.2.3.cmml">j</mi></msub><mo id="Thmthm1.p1.5.m1.6.6.3.1.1.1.2.2.2.2.2.5" stretchy="false" xref="Thmthm1.p1.5.m1.6.6.3.1.1.1.2.2.2.2.3.cmml">)</mo></mrow><mi id="Thmthm1.p1.5.m1.6.6.3.1.1.1.2.2.2.4" xref="Thmthm1.p1.5.m1.6.6.3.1.1.1.2.2.2.4.cmml">p</mi></msup><mo id="Thmthm1.p1.5.m1.6.6.3.1.1.1.4.4.5a" lspace="0em" xref="Thmthm1.p1.5.m1.6.6.3.1.1.1.4.4.5.cmml">⁢</mo><mrow id="Thmthm1.p1.5.m1.6.6.3.1.1.1.4.4.7" xref="Thmthm1.p1.5.m1.6.6.3.1.1.1.4.4.7.cmml"><mo id="Thmthm1.p1.5.m1.6.6.3.1.1.1.4.4.7.1" rspace="0em" xref="Thmthm1.p1.5.m1.6.6.3.1.1.1.4.4.7.1.cmml">𝑑</mo><msup id="Thmthm1.p1.5.m1.6.6.3.1.1.1.4.4.7.2" xref="Thmthm1.p1.5.m1.6.6.3.1.1.1.4.4.7.2.cmml"><mi id="Thmthm1.p1.5.m1.6.6.3.1.1.1.4.4.7.2.2" xref="Thmthm1.p1.5.m1.6.6.3.1.1.1.4.4.7.2.2.cmml">γ</mi><mo id="Thmthm1.p1.5.m1.6.6.3.1.1.1.4.4.7.2.3" xref="Thmthm1.p1.5.m1.6.6.3.1.1.1.4.4.7.2.3.cmml">′</mo></msup></mrow><mo id="Thmthm1.p1.5.m1.6.6.3.1.1.1.4.4.5b" xref="Thmthm1.p1.5.m1.6.6.3.1.1.1.4.4.5.cmml">⁢</mo><mrow id="Thmthm1.p1.5.m1.6.6.3.1.1.1.4.4.4.2" xref="Thmthm1.p1.5.m1.6.6.3.1.1.1.4.4.4.3.cmml"><mo id="Thmthm1.p1.5.m1.6.6.3.1.1.1.4.4.4.2.3" stretchy="false" xref="Thmthm1.p1.5.m1.6.6.3.1.1.1.4.4.4.3.cmml">(</mo><msub id="Thmthm1.p1.5.m1.6.6.3.1.1.1.3.3.3.1.1" xref="Thmthm1.p1.5.m1.6.6.3.1.1.1.3.3.3.1.1.cmml"><mi id="Thmthm1.p1.5.m1.6.6.3.1.1.1.3.3.3.1.1.2" xref="Thmthm1.p1.5.m1.6.6.3.1.1.1.3.3.3.1.1.2.cmml">s</mi><mi id="Thmthm1.p1.5.m1.6.6.3.1.1.1.3.3.3.1.1.3" xref="Thmthm1.p1.5.m1.6.6.3.1.1.1.3.3.3.1.1.3.cmml">i</mi></msub><mo id="Thmthm1.p1.5.m1.6.6.3.1.1.1.4.4.4.2.4" xref="Thmthm1.p1.5.m1.6.6.3.1.1.1.4.4.4.3.cmml">,</mo><msub id="Thmthm1.p1.5.m1.6.6.3.1.1.1.4.4.4.2.2" xref="Thmthm1.p1.5.m1.6.6.3.1.1.1.4.4.4.2.2.cmml"><mi id="Thmthm1.p1.5.m1.6.6.3.1.1.1.4.4.4.2.2.2" xref="Thmthm1.p1.5.m1.6.6.3.1.1.1.4.4.4.2.2.2.cmml">s</mi><mi id="Thmthm1.p1.5.m1.6.6.3.1.1.1.4.4.4.2.2.3" xref="Thmthm1.p1.5.m1.6.6.3.1.1.1.4.4.4.2.2.3.cmml">j</mi></msub><mo id="Thmthm1.p1.5.m1.6.6.3.1.1.1.4.4.4.2.5" stretchy="false" xref="Thmthm1.p1.5.m1.6.6.3.1.1.1.4.4.4.3.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="Thmthm1.p1.5.m1.6.6.3.1.1.3" xref="Thmthm1.p1.5.m1.6.6.3.1.1.1.cmml">)</mo></mrow><mrow id="Thmthm1.p1.5.m1.6.6.3.3" xref="Thmthm1.p1.5.m1.6.6.3.3.cmml"><mn id="Thmthm1.p1.5.m1.6.6.3.3.2" xref="Thmthm1.p1.5.m1.6.6.3.3.2.cmml">1</mn><mo id="Thmthm1.p1.5.m1.6.6.3.3.1" xref="Thmthm1.p1.5.m1.6.6.3.3.1.cmml">/</mo><mi id="Thmthm1.p1.5.m1.6.6.3.3.3" xref="Thmthm1.p1.5.m1.6.6.3.3.3.cmml">p</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="Thmthm1.p1.5.m1.6b"><apply id="Thmthm1.p1.5.m1.6.6.cmml" xref="Thmthm1.p1.5.m1.6.6"><eq id="Thmthm1.p1.5.m1.6.6.4.cmml" xref="Thmthm1.p1.5.m1.6.6.4"></eq><apply id="Thmthm1.p1.5.m1.5.5.2.cmml" xref="Thmthm1.p1.5.m1.5.5.2"><times id="Thmthm1.p1.5.m1.5.5.2.3.cmml" xref="Thmthm1.p1.5.m1.5.5.2.3"></times><apply id="Thmthm1.p1.5.m1.5.5.2.4.cmml" xref="Thmthm1.p1.5.m1.5.5.2.4"><csymbol cd="ambiguous" id="Thmthm1.p1.5.m1.5.5.2.4.1.cmml" xref="Thmthm1.p1.5.m1.5.5.2.4">subscript</csymbol><ci id="Thmthm1.p1.5.m1.5.5.2.4.2.cmml" xref="Thmthm1.p1.5.m1.5.5.2.4.2">𝑊</ci><ci id="Thmthm1.p1.5.m1.5.5.2.4.3.cmml" xref="Thmthm1.p1.5.m1.5.5.2.4.3">𝑝</ci></apply><ci id="Thmthm1.p1.5.m1.3.3.cmml" xref="Thmthm1.p1.5.m1.3.3">𝑑</ci><interval closure="open" id="Thmthm1.p1.5.m1.5.5.2.2.3.cmml" xref="Thmthm1.p1.5.m1.5.5.2.2.2"><apply id="Thmthm1.p1.5.m1.4.4.1.1.1.1.cmml" xref="Thmthm1.p1.5.m1.4.4.1.1.1.1"><csymbol cd="ambiguous" id="Thmthm1.p1.5.m1.4.4.1.1.1.1.1.cmml" xref="Thmthm1.p1.5.m1.4.4.1.1.1.1">subscript</csymbol><ci id="Thmthm1.p1.5.m1.4.4.1.1.1.1.2.cmml" xref="Thmthm1.p1.5.m1.4.4.1.1.1.1.2">𝒫</ci><ci id="Thmthm1.p1.5.m1.4.4.1.1.1.1.3.cmml" xref="Thmthm1.p1.5.m1.4.4.1.1.1.1.3">𝑖</ci></apply><apply id="Thmthm1.p1.5.m1.5.5.2.2.2.2.cmml" xref="Thmthm1.p1.5.m1.5.5.2.2.2.2"><csymbol cd="ambiguous" id="Thmthm1.p1.5.m1.5.5.2.2.2.2.1.cmml" xref="Thmthm1.p1.5.m1.5.5.2.2.2.2">subscript</csymbol><ci id="Thmthm1.p1.5.m1.5.5.2.2.2.2.2.cmml" xref="Thmthm1.p1.5.m1.5.5.2.2.2.2.2">𝒫</ci><ci id="Thmthm1.p1.5.m1.5.5.2.2.2.2.3.cmml" xref="Thmthm1.p1.5.m1.5.5.2.2.2.2.3">𝑗</ci></apply></interval></apply><apply id="Thmthm1.p1.5.m1.6.6.3.cmml" xref="Thmthm1.p1.5.m1.6.6.3"><csymbol cd="ambiguous" id="Thmthm1.p1.5.m1.6.6.3.2.cmml" xref="Thmthm1.p1.5.m1.6.6.3">superscript</csymbol><apply id="Thmthm1.p1.5.m1.6.6.3.1.1.1.cmml" xref="Thmthm1.p1.5.m1.6.6.3.1.1"><apply id="Thmthm1.p1.5.m1.6.6.3.1.1.1.5.cmml" xref="Thmthm1.p1.5.m1.6.6.3.1.1.1.5"><csymbol cd="ambiguous" id="Thmthm1.p1.5.m1.6.6.3.1.1.1.5.1.cmml" xref="Thmthm1.p1.5.m1.6.6.3.1.1.1.5">subscript</csymbol><csymbol cd="latexml" id="Thmthm1.p1.5.m1.6.6.3.1.1.1.5.2.cmml" xref="Thmthm1.p1.5.m1.6.6.3.1.1.1.5.2">infimum</csymbol><apply id="Thmthm1.p1.5.m1.2.2.2.cmml" xref="Thmthm1.p1.5.m1.2.2.2"><in id="Thmthm1.p1.5.m1.2.2.2.3.cmml" xref="Thmthm1.p1.5.m1.2.2.2.3"></in><apply id="Thmthm1.p1.5.m1.2.2.2.4.cmml" xref="Thmthm1.p1.5.m1.2.2.2.4"><csymbol cd="ambiguous" id="Thmthm1.p1.5.m1.2.2.2.4.1.cmml" xref="Thmthm1.p1.5.m1.2.2.2.4">superscript</csymbol><ci id="Thmthm1.p1.5.m1.2.2.2.4.2.cmml" xref="Thmthm1.p1.5.m1.2.2.2.4.2">𝛾</ci><ci id="Thmthm1.p1.5.m1.2.2.2.4.3.cmml" xref="Thmthm1.p1.5.m1.2.2.2.4.3">′</ci></apply><apply id="Thmthm1.p1.5.m1.2.2.2.2.cmml" xref="Thmthm1.p1.5.m1.2.2.2.2"><times id="Thmthm1.p1.5.m1.2.2.2.2.3.cmml" xref="Thmthm1.p1.5.m1.2.2.2.2.3"></times><ci id="Thmthm1.p1.5.m1.2.2.2.2.4.cmml" xref="Thmthm1.p1.5.m1.2.2.2.2.4">Γ</ci><interval closure="open" id="Thmthm1.p1.5.m1.2.2.2.2.2.3.cmml" xref="Thmthm1.p1.5.m1.2.2.2.2.2.2"><apply id="Thmthm1.p1.5.m1.1.1.1.1.1.1.1.cmml" xref="Thmthm1.p1.5.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="Thmthm1.p1.5.m1.1.1.1.1.1.1.1.1.cmml" xref="Thmthm1.p1.5.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="Thmthm1.p1.5.m1.1.1.1.1.1.1.1.2.cmml" xref="Thmthm1.p1.5.m1.1.1.1.1.1.1.1.2">𝒫</ci><ci id="Thmthm1.p1.5.m1.1.1.1.1.1.1.1.3.cmml" xref="Thmthm1.p1.5.m1.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="Thmthm1.p1.5.m1.2.2.2.2.2.2.2.cmml" xref="Thmthm1.p1.5.m1.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="Thmthm1.p1.5.m1.2.2.2.2.2.2.2.1.cmml" xref="Thmthm1.p1.5.m1.2.2.2.2.2.2.2">subscript</csymbol><ci id="Thmthm1.p1.5.m1.2.2.2.2.2.2.2.2.cmml" xref="Thmthm1.p1.5.m1.2.2.2.2.2.2.2.2">𝒫</ci><ci id="Thmthm1.p1.5.m1.2.2.2.2.2.2.2.3.cmml" xref="Thmthm1.p1.5.m1.2.2.2.2.2.2.2.3">𝑗</ci></apply></interval></apply></apply></apply><apply id="Thmthm1.p1.5.m1.6.6.3.1.1.1.4.cmml" xref="Thmthm1.p1.5.m1.6.6.3.1.1.1.4"><apply id="Thmthm1.p1.5.m1.6.6.3.1.1.1.4.5.cmml" xref="Thmthm1.p1.5.m1.6.6.3.1.1.1.4.5"><csymbol cd="ambiguous" id="Thmthm1.p1.5.m1.6.6.3.1.1.1.4.5.1.cmml" xref="Thmthm1.p1.5.m1.6.6.3.1.1.1.4.5">subscript</csymbol><int id="Thmthm1.p1.5.m1.6.6.3.1.1.1.4.5.2.cmml" xref="Thmthm1.p1.5.m1.6.6.3.1.1.1.4.5.2"></int><apply id="Thmthm1.p1.5.m1.6.6.3.1.1.1.4.5.3.cmml" xref="Thmthm1.p1.5.m1.6.6.3.1.1.1.4.5.3"><times id="Thmthm1.p1.5.m1.6.6.3.1.1.1.4.5.3.1.cmml" xref="Thmthm1.p1.5.m1.6.6.3.1.1.1.4.5.3.1"></times><ci id="Thmthm1.p1.5.m1.6.6.3.1.1.1.4.5.3.2.cmml" xref="Thmthm1.p1.5.m1.6.6.3.1.1.1.4.5.3.2">𝒮</ci><ci id="Thmthm1.p1.5.m1.6.6.3.1.1.1.4.5.3.3.cmml" xref="Thmthm1.p1.5.m1.6.6.3.1.1.1.4.5.3.3">𝒮</ci></apply></apply><apply id="Thmthm1.p1.5.m1.6.6.3.1.1.1.4.4.cmml" xref="Thmthm1.p1.5.m1.6.6.3.1.1.1.4.4"><times id="Thmthm1.p1.5.m1.6.6.3.1.1.1.4.4.5.cmml" xref="Thmthm1.p1.5.m1.6.6.3.1.1.1.4.4.5"></times><ci id="Thmthm1.p1.5.m1.6.6.3.1.1.1.4.4.6.cmml" xref="Thmthm1.p1.5.m1.6.6.3.1.1.1.4.4.6">𝑑</ci><apply id="Thmthm1.p1.5.m1.6.6.3.1.1.1.2.2.2.cmml" xref="Thmthm1.p1.5.m1.6.6.3.1.1.1.2.2.2"><csymbol cd="ambiguous" id="Thmthm1.p1.5.m1.6.6.3.1.1.1.2.2.2.3.cmml" xref="Thmthm1.p1.5.m1.6.6.3.1.1.1.2.2.2">superscript</csymbol><interval closure="open" id="Thmthm1.p1.5.m1.6.6.3.1.1.1.2.2.2.2.3.cmml" xref="Thmthm1.p1.5.m1.6.6.3.1.1.1.2.2.2.2.2"><apply id="Thmthm1.p1.5.m1.6.6.3.1.1.1.1.1.1.1.1.1.cmml" xref="Thmthm1.p1.5.m1.6.6.3.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="Thmthm1.p1.5.m1.6.6.3.1.1.1.1.1.1.1.1.1.1.cmml" xref="Thmthm1.p1.5.m1.6.6.3.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="Thmthm1.p1.5.m1.6.6.3.1.1.1.1.1.1.1.1.1.2.cmml" xref="Thmthm1.p1.5.m1.6.6.3.1.1.1.1.1.1.1.1.1.2">𝑠</ci><ci id="Thmthm1.p1.5.m1.6.6.3.1.1.1.1.1.1.1.1.1.3.cmml" xref="Thmthm1.p1.5.m1.6.6.3.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="Thmthm1.p1.5.m1.6.6.3.1.1.1.2.2.2.2.2.2.cmml" xref="Thmthm1.p1.5.m1.6.6.3.1.1.1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="Thmthm1.p1.5.m1.6.6.3.1.1.1.2.2.2.2.2.2.1.cmml" xref="Thmthm1.p1.5.m1.6.6.3.1.1.1.2.2.2.2.2.2">subscript</csymbol><ci id="Thmthm1.p1.5.m1.6.6.3.1.1.1.2.2.2.2.2.2.2.cmml" xref="Thmthm1.p1.5.m1.6.6.3.1.1.1.2.2.2.2.2.2.2">𝑠</ci><ci id="Thmthm1.p1.5.m1.6.6.3.1.1.1.2.2.2.2.2.2.3.cmml" xref="Thmthm1.p1.5.m1.6.6.3.1.1.1.2.2.2.2.2.2.3">𝑗</ci></apply></interval><ci id="Thmthm1.p1.5.m1.6.6.3.1.1.1.2.2.2.4.cmml" xref="Thmthm1.p1.5.m1.6.6.3.1.1.1.2.2.2.4">𝑝</ci></apply><apply id="Thmthm1.p1.5.m1.6.6.3.1.1.1.4.4.7.cmml" xref="Thmthm1.p1.5.m1.6.6.3.1.1.1.4.4.7"><csymbol cd="latexml" id="Thmthm1.p1.5.m1.6.6.3.1.1.1.4.4.7.1.cmml" xref="Thmthm1.p1.5.m1.6.6.3.1.1.1.4.4.7.1">differential-d</csymbol><apply id="Thmthm1.p1.5.m1.6.6.3.1.1.1.4.4.7.2.cmml" xref="Thmthm1.p1.5.m1.6.6.3.1.1.1.4.4.7.2"><csymbol cd="ambiguous" id="Thmthm1.p1.5.m1.6.6.3.1.1.1.4.4.7.2.1.cmml" xref="Thmthm1.p1.5.m1.6.6.3.1.1.1.4.4.7.2">superscript</csymbol><ci id="Thmthm1.p1.5.m1.6.6.3.1.1.1.4.4.7.2.2.cmml" xref="Thmthm1.p1.5.m1.6.6.3.1.1.1.4.4.7.2.2">𝛾</ci><ci id="Thmthm1.p1.5.m1.6.6.3.1.1.1.4.4.7.2.3.cmml" xref="Thmthm1.p1.5.m1.6.6.3.1.1.1.4.4.7.2.3">′</ci></apply></apply><interval closure="open" id="Thmthm1.p1.5.m1.6.6.3.1.1.1.4.4.4.3.cmml" xref="Thmthm1.p1.5.m1.6.6.3.1.1.1.4.4.4.2"><apply id="Thmthm1.p1.5.m1.6.6.3.1.1.1.3.3.3.1.1.cmml" xref="Thmthm1.p1.5.m1.6.6.3.1.1.1.3.3.3.1.1"><csymbol cd="ambiguous" id="Thmthm1.p1.5.m1.6.6.3.1.1.1.3.3.3.1.1.1.cmml" xref="Thmthm1.p1.5.m1.6.6.3.1.1.1.3.3.3.1.1">subscript</csymbol><ci id="Thmthm1.p1.5.m1.6.6.3.1.1.1.3.3.3.1.1.2.cmml" xref="Thmthm1.p1.5.m1.6.6.3.1.1.1.3.3.3.1.1.2">𝑠</ci><ci id="Thmthm1.p1.5.m1.6.6.3.1.1.1.3.3.3.1.1.3.cmml" xref="Thmthm1.p1.5.m1.6.6.3.1.1.1.3.3.3.1.1.3">𝑖</ci></apply><apply id="Thmthm1.p1.5.m1.6.6.3.1.1.1.4.4.4.2.2.cmml" xref="Thmthm1.p1.5.m1.6.6.3.1.1.1.4.4.4.2.2"><csymbol cd="ambiguous" id="Thmthm1.p1.5.m1.6.6.3.1.1.1.4.4.4.2.2.1.cmml" xref="Thmthm1.p1.5.m1.6.6.3.1.1.1.4.4.4.2.2">subscript</csymbol><ci id="Thmthm1.p1.5.m1.6.6.3.1.1.1.4.4.4.2.2.2.cmml" xref="Thmthm1.p1.5.m1.6.6.3.1.1.1.4.4.4.2.2.2">𝑠</ci><ci id="Thmthm1.p1.5.m1.6.6.3.1.1.1.4.4.4.2.2.3.cmml" xref="Thmthm1.p1.5.m1.6.6.3.1.1.1.4.4.4.2.2.3">𝑗</ci></apply></interval></apply></apply></apply><apply id="Thmthm1.p1.5.m1.6.6.3.3.cmml" xref="Thmthm1.p1.5.m1.6.6.3.3"><divide id="Thmthm1.p1.5.m1.6.6.3.3.1.cmml" xref="Thmthm1.p1.5.m1.6.6.3.3.1"></divide><cn id="Thmthm1.p1.5.m1.6.6.3.3.2.cmml" type="integer" xref="Thmthm1.p1.5.m1.6.6.3.3.2">1</cn><ci id="Thmthm1.p1.5.m1.6.6.3.3.3.cmml" xref="Thmthm1.p1.5.m1.6.6.3.3.3">𝑝</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmthm1.p1.5.m1.6c">W_{p}(d)(\mathcal{P}_{i},\mathcal{P}_{j})=\left(\inf_{\gamma^{\prime}\in\Gamma%
(\mathcal{P}_{i},\mathcal{P}_{j})}\int_{\mathcal{S}\times\mathcal{S}}d(s_{i},s%
_{j})^{p}\,d\gamma^{\prime}(s_{i},s_{j})\right)^{1/p}</annotation><annotation encoding="application/x-llamapun" id="Thmthm1.p1.5.m1.6d">italic_W start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ( italic_d ) ( caligraphic_P start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , caligraphic_P start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) = ( roman_inf start_POSTSUBSCRIPT italic_γ start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ∈ roman_Γ ( caligraphic_P start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , caligraphic_P start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) end_POSTSUBSCRIPT ∫ start_POSTSUBSCRIPT caligraphic_S × caligraphic_S end_POSTSUBSCRIPT italic_d ( italic_s start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_s start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT italic_p end_POSTSUPERSCRIPT italic_d italic_γ start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ( italic_s start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_s start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) ) start_POSTSUPERSCRIPT 1 / italic_p end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="\Gamma(\mathcal{P}_{i},\mathcal{P}_{j})" class="ltx_Math" display="inline" id="Thmthm1.p1.6.m2.2"><semantics id="Thmthm1.p1.6.m2.2a"><mrow id="Thmthm1.p1.6.m2.2.2" xref="Thmthm1.p1.6.m2.2.2.cmml"><mi id="Thmthm1.p1.6.m2.2.2.4" mathvariant="normal" xref="Thmthm1.p1.6.m2.2.2.4.cmml">Γ</mi><mo id="Thmthm1.p1.6.m2.2.2.3" xref="Thmthm1.p1.6.m2.2.2.3.cmml">⁢</mo><mrow id="Thmthm1.p1.6.m2.2.2.2.2" xref="Thmthm1.p1.6.m2.2.2.2.3.cmml"><mo id="Thmthm1.p1.6.m2.2.2.2.2.3" stretchy="false" xref="Thmthm1.p1.6.m2.2.2.2.3.cmml">(</mo><msub id="Thmthm1.p1.6.m2.1.1.1.1.1" xref="Thmthm1.p1.6.m2.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="Thmthm1.p1.6.m2.1.1.1.1.1.2" xref="Thmthm1.p1.6.m2.1.1.1.1.1.2.cmml">𝒫</mi><mi id="Thmthm1.p1.6.m2.1.1.1.1.1.3" xref="Thmthm1.p1.6.m2.1.1.1.1.1.3.cmml">i</mi></msub><mo id="Thmthm1.p1.6.m2.2.2.2.2.4" xref="Thmthm1.p1.6.m2.2.2.2.3.cmml">,</mo><msub id="Thmthm1.p1.6.m2.2.2.2.2.2" xref="Thmthm1.p1.6.m2.2.2.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="Thmthm1.p1.6.m2.2.2.2.2.2.2" xref="Thmthm1.p1.6.m2.2.2.2.2.2.2.cmml">𝒫</mi><mi id="Thmthm1.p1.6.m2.2.2.2.2.2.3" xref="Thmthm1.p1.6.m2.2.2.2.2.2.3.cmml">j</mi></msub><mo id="Thmthm1.p1.6.m2.2.2.2.2.5" stretchy="false" xref="Thmthm1.p1.6.m2.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmthm1.p1.6.m2.2b"><apply id="Thmthm1.p1.6.m2.2.2.cmml" xref="Thmthm1.p1.6.m2.2.2"><times id="Thmthm1.p1.6.m2.2.2.3.cmml" xref="Thmthm1.p1.6.m2.2.2.3"></times><ci id="Thmthm1.p1.6.m2.2.2.4.cmml" xref="Thmthm1.p1.6.m2.2.2.4">Γ</ci><interval closure="open" id="Thmthm1.p1.6.m2.2.2.2.3.cmml" xref="Thmthm1.p1.6.m2.2.2.2.2"><apply id="Thmthm1.p1.6.m2.1.1.1.1.1.cmml" xref="Thmthm1.p1.6.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="Thmthm1.p1.6.m2.1.1.1.1.1.1.cmml" xref="Thmthm1.p1.6.m2.1.1.1.1.1">subscript</csymbol><ci id="Thmthm1.p1.6.m2.1.1.1.1.1.2.cmml" xref="Thmthm1.p1.6.m2.1.1.1.1.1.2">𝒫</ci><ci id="Thmthm1.p1.6.m2.1.1.1.1.1.3.cmml" xref="Thmthm1.p1.6.m2.1.1.1.1.1.3">𝑖</ci></apply><apply id="Thmthm1.p1.6.m2.2.2.2.2.2.cmml" xref="Thmthm1.p1.6.m2.2.2.2.2.2"><csymbol cd="ambiguous" id="Thmthm1.p1.6.m2.2.2.2.2.2.1.cmml" xref="Thmthm1.p1.6.m2.2.2.2.2.2">subscript</csymbol><ci id="Thmthm1.p1.6.m2.2.2.2.2.2.2.cmml" xref="Thmthm1.p1.6.m2.2.2.2.2.2.2">𝒫</ci><ci id="Thmthm1.p1.6.m2.2.2.2.2.2.3.cmml" xref="Thmthm1.p1.6.m2.2.2.2.2.2.3">𝑗</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmthm1.p1.6.m2.2c">\Gamma(\mathcal{P}_{i},\mathcal{P}_{j})</annotation><annotation encoding="application/x-llamapun" id="Thmthm1.p1.6.m2.2d">roman_Γ ( caligraphic_P start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , caligraphic_P start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT )</annotation></semantics></math> is the set of all couplings of <math alttext="{\mathcal{P}}_{i}" class="ltx_Math" display="inline" id="Thmthm1.p1.7.m3.1"><semantics id="Thmthm1.p1.7.m3.1a"><msub id="Thmthm1.p1.7.m3.1.1" xref="Thmthm1.p1.7.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="Thmthm1.p1.7.m3.1.1.2" xref="Thmthm1.p1.7.m3.1.1.2.cmml">𝒫</mi><mi id="Thmthm1.p1.7.m3.1.1.3" xref="Thmthm1.p1.7.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="Thmthm1.p1.7.m3.1b"><apply id="Thmthm1.p1.7.m3.1.1.cmml" xref="Thmthm1.p1.7.m3.1.1"><csymbol cd="ambiguous" id="Thmthm1.p1.7.m3.1.1.1.cmml" xref="Thmthm1.p1.7.m3.1.1">subscript</csymbol><ci id="Thmthm1.p1.7.m3.1.1.2.cmml" xref="Thmthm1.p1.7.m3.1.1.2">𝒫</ci><ci id="Thmthm1.p1.7.m3.1.1.3.cmml" xref="Thmthm1.p1.7.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmthm1.p1.7.m3.1c">{\mathcal{P}}_{i}</annotation><annotation encoding="application/x-llamapun" id="Thmthm1.p1.7.m3.1d">caligraphic_P start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="{\mathcal{P}}_{j}" class="ltx_Math" display="inline" id="Thmthm1.p1.8.m4.1"><semantics id="Thmthm1.p1.8.m4.1a"><msub id="Thmthm1.p1.8.m4.1.1" xref="Thmthm1.p1.8.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="Thmthm1.p1.8.m4.1.1.2" xref="Thmthm1.p1.8.m4.1.1.2.cmml">𝒫</mi><mi id="Thmthm1.p1.8.m4.1.1.3" xref="Thmthm1.p1.8.m4.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="Thmthm1.p1.8.m4.1b"><apply id="Thmthm1.p1.8.m4.1.1.cmml" xref="Thmthm1.p1.8.m4.1.1"><csymbol cd="ambiguous" id="Thmthm1.p1.8.m4.1.1.1.cmml" xref="Thmthm1.p1.8.m4.1.1">subscript</csymbol><ci id="Thmthm1.p1.8.m4.1.1.2.cmml" xref="Thmthm1.p1.8.m4.1.1.2">𝒫</ci><ci id="Thmthm1.p1.8.m4.1.1.3.cmml" xref="Thmthm1.p1.8.m4.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmthm1.p1.8.m4.1c">{\mathcal{P}}_{j}</annotation><annotation encoding="application/x-llamapun" id="Thmthm1.p1.8.m4.1d">caligraphic_P start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math>.</p>
</div>
</div>
<div class="ltx_para" id="S4.SS2.p3">
<p class="ltx_p" id="S4.SS2.p3.7">Proof can be found in <cite class="ltx_cite ltx_citemacro_citep">(Zhang et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#bib.bib47" title="">2021</a>)</cite>.
Under this <math alttext="\pi^{*}" class="ltx_Math" display="inline" id="S4.SS2.p3.1.m1.1"><semantics id="S4.SS2.p3.1.m1.1a"><msup id="S4.SS2.p3.1.m1.1.1" xref="S4.SS2.p3.1.m1.1.1.cmml"><mi id="S4.SS2.p3.1.m1.1.1.2" xref="S4.SS2.p3.1.m1.1.1.2.cmml">π</mi><mo id="S4.SS2.p3.1.m1.1.1.3" xref="S4.SS2.p3.1.m1.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.1.m1.1b"><apply id="S4.SS2.p3.1.m1.1.1.cmml" xref="S4.SS2.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p3.1.m1.1.1.1.cmml" xref="S4.SS2.p3.1.m1.1.1">superscript</csymbol><ci id="S4.SS2.p3.1.m1.1.1.2.cmml" xref="S4.SS2.p3.1.m1.1.1.2">𝜋</ci><times id="S4.SS2.p3.1.m1.1.1.3.cmml" xref="S4.SS2.p3.1.m1.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.1.m1.1c">\pi^{*}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.1.m1.1d">italic_π start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math>-bisimulation metric, we can divide the latent space into <math alttext="n" class="ltx_Math" display="inline" id="S4.SS2.p3.2.m2.1"><semantics id="S4.SS2.p3.2.m2.1a"><mi id="S4.SS2.p3.2.m2.1.1" xref="S4.SS2.p3.2.m2.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.2.m2.1b"><ci id="S4.SS2.p3.2.m2.1.1.cmml" xref="S4.SS2.p3.2.m2.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.2.m2.1c">n</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.2.m2.1d">italic_n</annotation></semantics></math> partitions based on some <math alttext="\epsilon&gt;0" class="ltx_Math" display="inline" id="S4.SS2.p3.3.m3.1"><semantics id="S4.SS2.p3.3.m3.1a"><mrow id="S4.SS2.p3.3.m3.1.1" xref="S4.SS2.p3.3.m3.1.1.cmml"><mi id="S4.SS2.p3.3.m3.1.1.2" xref="S4.SS2.p3.3.m3.1.1.2.cmml">ϵ</mi><mo id="S4.SS2.p3.3.m3.1.1.1" xref="S4.SS2.p3.3.m3.1.1.1.cmml">&gt;</mo><mn id="S4.SS2.p3.3.m3.1.1.3" xref="S4.SS2.p3.3.m3.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.3.m3.1b"><apply id="S4.SS2.p3.3.m3.1.1.cmml" xref="S4.SS2.p3.3.m3.1.1"><gt id="S4.SS2.p3.3.m3.1.1.1.cmml" xref="S4.SS2.p3.3.m3.1.1.1"></gt><ci id="S4.SS2.p3.3.m3.1.1.2.cmml" xref="S4.SS2.p3.3.m3.1.1.2">italic-ϵ</ci><cn id="S4.SS2.p3.3.m3.1.1.3.cmml" type="integer" xref="S4.SS2.p3.3.m3.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.3.m3.1c">\epsilon&gt;0</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.3.m3.1d">italic_ϵ &gt; 0</annotation></semantics></math>, where <math alttext="\frac{1}{n}&lt;(1-c)\epsilon" class="ltx_Math" display="inline" id="S4.SS2.p3.4.m4.1"><semantics id="S4.SS2.p3.4.m4.1a"><mrow id="S4.SS2.p3.4.m4.1.1" xref="S4.SS2.p3.4.m4.1.1.cmml"><mfrac id="S4.SS2.p3.4.m4.1.1.3" xref="S4.SS2.p3.4.m4.1.1.3.cmml"><mn id="S4.SS2.p3.4.m4.1.1.3.2" xref="S4.SS2.p3.4.m4.1.1.3.2.cmml">1</mn><mi id="S4.SS2.p3.4.m4.1.1.3.3" xref="S4.SS2.p3.4.m4.1.1.3.3.cmml">n</mi></mfrac><mo id="S4.SS2.p3.4.m4.1.1.2" xref="S4.SS2.p3.4.m4.1.1.2.cmml">&lt;</mo><mrow id="S4.SS2.p3.4.m4.1.1.1" xref="S4.SS2.p3.4.m4.1.1.1.cmml"><mrow id="S4.SS2.p3.4.m4.1.1.1.1.1" xref="S4.SS2.p3.4.m4.1.1.1.1.1.1.cmml"><mo id="S4.SS2.p3.4.m4.1.1.1.1.1.2" stretchy="false" xref="S4.SS2.p3.4.m4.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS2.p3.4.m4.1.1.1.1.1.1" xref="S4.SS2.p3.4.m4.1.1.1.1.1.1.cmml"><mn id="S4.SS2.p3.4.m4.1.1.1.1.1.1.2" xref="S4.SS2.p3.4.m4.1.1.1.1.1.1.2.cmml">1</mn><mo id="S4.SS2.p3.4.m4.1.1.1.1.1.1.1" xref="S4.SS2.p3.4.m4.1.1.1.1.1.1.1.cmml">−</mo><mi id="S4.SS2.p3.4.m4.1.1.1.1.1.1.3" xref="S4.SS2.p3.4.m4.1.1.1.1.1.1.3.cmml">c</mi></mrow><mo id="S4.SS2.p3.4.m4.1.1.1.1.1.3" stretchy="false" xref="S4.SS2.p3.4.m4.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S4.SS2.p3.4.m4.1.1.1.2" xref="S4.SS2.p3.4.m4.1.1.1.2.cmml">⁢</mo><mi id="S4.SS2.p3.4.m4.1.1.1.3" xref="S4.SS2.p3.4.m4.1.1.1.3.cmml">ϵ</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.4.m4.1b"><apply id="S4.SS2.p3.4.m4.1.1.cmml" xref="S4.SS2.p3.4.m4.1.1"><lt id="S4.SS2.p3.4.m4.1.1.2.cmml" xref="S4.SS2.p3.4.m4.1.1.2"></lt><apply id="S4.SS2.p3.4.m4.1.1.3.cmml" xref="S4.SS2.p3.4.m4.1.1.3"><divide id="S4.SS2.p3.4.m4.1.1.3.1.cmml" xref="S4.SS2.p3.4.m4.1.1.3"></divide><cn id="S4.SS2.p3.4.m4.1.1.3.2.cmml" type="integer" xref="S4.SS2.p3.4.m4.1.1.3.2">1</cn><ci id="S4.SS2.p3.4.m4.1.1.3.3.cmml" xref="S4.SS2.p3.4.m4.1.1.3.3">𝑛</ci></apply><apply id="S4.SS2.p3.4.m4.1.1.1.cmml" xref="S4.SS2.p3.4.m4.1.1.1"><times id="S4.SS2.p3.4.m4.1.1.1.2.cmml" xref="S4.SS2.p3.4.m4.1.1.1.2"></times><apply id="S4.SS2.p3.4.m4.1.1.1.1.1.1.cmml" xref="S4.SS2.p3.4.m4.1.1.1.1.1"><minus id="S4.SS2.p3.4.m4.1.1.1.1.1.1.1.cmml" xref="S4.SS2.p3.4.m4.1.1.1.1.1.1.1"></minus><cn id="S4.SS2.p3.4.m4.1.1.1.1.1.1.2.cmml" type="integer" xref="S4.SS2.p3.4.m4.1.1.1.1.1.1.2">1</cn><ci id="S4.SS2.p3.4.m4.1.1.1.1.1.1.3.cmml" xref="S4.SS2.p3.4.m4.1.1.1.1.1.1.3">𝑐</ci></apply><ci id="S4.SS2.p3.4.m4.1.1.1.3.cmml" xref="S4.SS2.p3.4.m4.1.1.1.3">italic-ϵ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.4.m4.1c">\frac{1}{n}&lt;(1-c)\epsilon</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.4.m4.1d">divide start_ARG 1 end_ARG start_ARG italic_n end_ARG &lt; ( 1 - italic_c ) italic_ϵ</annotation></semantics></math>. Let <math alttext="\phi" class="ltx_Math" display="inline" id="S4.SS2.p3.5.m5.1"><semantics id="S4.SS2.p3.5.m5.1a"><mi id="S4.SS2.p3.5.m5.1.1" xref="S4.SS2.p3.5.m5.1.1.cmml">ϕ</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.5.m5.1b"><ci id="S4.SS2.p3.5.m5.1.1.cmml" xref="S4.SS2.p3.5.m5.1.1">italic-ϕ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.5.m5.1c">\phi</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.5.m5.1d">italic_ϕ</annotation></semantics></math> represent the encoder that maps each original state from the state space <math alttext="\mathcal{S}" class="ltx_Math" display="inline" id="S4.SS2.p3.6.m6.1"><semantics id="S4.SS2.p3.6.m6.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p3.6.m6.1.1" xref="S4.SS2.p3.6.m6.1.1.cmml">𝒮</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.6.m6.1b"><ci id="S4.SS2.p3.6.m6.1.1.cmml" xref="S4.SS2.p3.6.m6.1.1">𝒮</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.6.m6.1c">\mathcal{S}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.6.m6.1d">caligraphic_S</annotation></semantics></math> to a corresponding <math alttext="\epsilon" class="ltx_Math" display="inline" id="S4.SS2.p3.7.m7.1"><semantics id="S4.SS2.p3.7.m7.1a"><mi id="S4.SS2.p3.7.m7.1.1" xref="S4.SS2.p3.7.m7.1.1.cmml">ϵ</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.7.m7.1b"><ci id="S4.SS2.p3.7.m7.1.1.cmml" xref="S4.SS2.p3.7.m7.1.1">italic-ϵ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.7.m7.1c">\epsilon</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.7.m7.1d">italic_ϵ</annotation></semantics></math>-cluster.
With these notations, <cite class="ltx_cite ltx_citemacro_citep">(Zhang et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#bib.bib47" title="">2021</a>)</cite> shows the following value bound based on bisimulation metrics.</p>
</div>
<div class="ltx_theorem ltx_theorem_thm" id="Thmthm2">
<h6 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span class="ltx_text ltx_font_bold" id="Thmthm2.1.1.1">Theorem 2</span></span><span class="ltx_text ltx_font_bold" id="Thmthm2.2.2">.</span>
</h6>
<div class="ltx_para" id="Thmthm2.p1">
<p class="ltx_p" id="Thmthm2.p1.4">(Theorem 2 in <cite class="ltx_cite ltx_citemacro_citep">(Zhang et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#bib.bib47" title="">2021</a>)</cite>) 
Consider an MDP <math alttext="\bar{\mathcal{M}}" class="ltx_Math" display="inline" id="Thmthm2.p1.1.m1.1"><semantics id="Thmthm2.p1.1.m1.1a"><mover accent="true" id="Thmthm2.p1.1.m1.1.1" xref="Thmthm2.p1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="Thmthm2.p1.1.m1.1.1.2" xref="Thmthm2.p1.1.m1.1.1.2.cmml">ℳ</mi><mo id="Thmthm2.p1.1.m1.1.1.1" xref="Thmthm2.p1.1.m1.1.1.1.cmml">¯</mo></mover><annotation-xml encoding="MathML-Content" id="Thmthm2.p1.1.m1.1b"><apply id="Thmthm2.p1.1.m1.1.1.cmml" xref="Thmthm2.p1.1.m1.1.1"><ci id="Thmthm2.p1.1.m1.1.1.1.cmml" xref="Thmthm2.p1.1.m1.1.1.1">¯</ci><ci id="Thmthm2.p1.1.m1.1.1.2.cmml" xref="Thmthm2.p1.1.m1.1.1.2">ℳ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmthm2.p1.1.m1.1c">\bar{\mathcal{M}}</annotation><annotation encoding="application/x-llamapun" id="Thmthm2.p1.1.m1.1d">over¯ start_ARG caligraphic_M end_ARG</annotation></semantics></math>, which is formed by clustering states within an <math alttext="\epsilon" class="ltx_Math" display="inline" id="Thmthm2.p1.2.m2.1"><semantics id="Thmthm2.p1.2.m2.1a"><mi id="Thmthm2.p1.2.m2.1.1" xref="Thmthm2.p1.2.m2.1.1.cmml">ϵ</mi><annotation-xml encoding="MathML-Content" id="Thmthm2.p1.2.m2.1b"><ci id="Thmthm2.p1.2.m2.1.1.cmml" xref="Thmthm2.p1.2.m2.1.1">italic-ϵ</ci></annotation-xml><annotation encoding="application/x-tex" id="Thmthm2.p1.2.m2.1c">\epsilon</annotation><annotation encoding="application/x-llamapun" id="Thmthm2.p1.2.m2.1d">italic_ϵ</annotation></semantics></math>-neighborhood, along with an encoder <math alttext="\phi" class="ltx_Math" display="inline" id="Thmthm2.p1.3.m3.1"><semantics id="Thmthm2.p1.3.m3.1a"><mi id="Thmthm2.p1.3.m3.1.1" xref="Thmthm2.p1.3.m3.1.1.cmml">ϕ</mi><annotation-xml encoding="MathML-Content" id="Thmthm2.p1.3.m3.1b"><ci id="Thmthm2.p1.3.m3.1.1.cmml" xref="Thmthm2.p1.3.m3.1.1">italic-ϕ</ci></annotation-xml><annotation encoding="application/x-tex" id="Thmthm2.p1.3.m3.1c">\phi</annotation><annotation encoding="application/x-llamapun" id="Thmthm2.p1.3.m3.1d">italic_ϕ</annotation></semantics></math> that maps states from the original MDP <math alttext="\mathcal{M}" class="ltx_Math" display="inline" id="Thmthm2.p1.4.m4.1"><semantics id="Thmthm2.p1.4.m4.1a"><mi class="ltx_font_mathcaligraphic" id="Thmthm2.p1.4.m4.1.1" xref="Thmthm2.p1.4.m4.1.1.cmml">ℳ</mi><annotation-xml encoding="MathML-Content" id="Thmthm2.p1.4.m4.1b"><ci id="Thmthm2.p1.4.m4.1.1.cmml" xref="Thmthm2.p1.4.m4.1.1">ℳ</ci></annotation-xml><annotation encoding="application/x-tex" id="Thmthm2.p1.4.m4.1c">\mathcal{M}</annotation><annotation encoding="application/x-llamapun" id="Thmthm2.p1.4.m4.1d">caligraphic_M</annotation></semantics></math> to these clusters. Under the same assumption in Theorem <a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#Thmthm1" title="Theorem 1. ‣ 4.2 Theoretical Analysis ‣ 4 Bisimulation metric for model predictive control ‣ Bisimulation metric for Model Predictive Control"><span class="ltx_text ltx_ref_tag">1</span></a>, optimal value functions for the two MDPs are bounded by</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E12">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="|V^{*}(s)-V^{*}(\phi(s))|\leq\frac{2\epsilon+2{\mathcal{L}}}{(1-\gamma)(1-c)}" class="ltx_Math" display="block" id="S4.E12.m1.5"><semantics id="S4.E12.m1.5a"><mrow id="S4.E12.m1.5.5" xref="S4.E12.m1.5.5.cmml"><mrow id="S4.E12.m1.5.5.1.1" xref="S4.E12.m1.5.5.1.2.cmml"><mo id="S4.E12.m1.5.5.1.1.2" stretchy="false" xref="S4.E12.m1.5.5.1.2.1.cmml">|</mo><mrow id="S4.E12.m1.5.5.1.1.1" xref="S4.E12.m1.5.5.1.1.1.cmml"><mrow id="S4.E12.m1.5.5.1.1.1.3" xref="S4.E12.m1.5.5.1.1.1.3.cmml"><msup id="S4.E12.m1.5.5.1.1.1.3.2" xref="S4.E12.m1.5.5.1.1.1.3.2.cmml"><mi id="S4.E12.m1.5.5.1.1.1.3.2.2" xref="S4.E12.m1.5.5.1.1.1.3.2.2.cmml">V</mi><mo id="S4.E12.m1.5.5.1.1.1.3.2.3" xref="S4.E12.m1.5.5.1.1.1.3.2.3.cmml">∗</mo></msup><mo id="S4.E12.m1.5.5.1.1.1.3.1" xref="S4.E12.m1.5.5.1.1.1.3.1.cmml">⁢</mo><mrow id="S4.E12.m1.5.5.1.1.1.3.3.2" xref="S4.E12.m1.5.5.1.1.1.3.cmml"><mo id="S4.E12.m1.5.5.1.1.1.3.3.2.1" stretchy="false" xref="S4.E12.m1.5.5.1.1.1.3.cmml">(</mo><mi id="S4.E12.m1.3.3" xref="S4.E12.m1.3.3.cmml">s</mi><mo id="S4.E12.m1.5.5.1.1.1.3.3.2.2" stretchy="false" xref="S4.E12.m1.5.5.1.1.1.3.cmml">)</mo></mrow></mrow><mo id="S4.E12.m1.5.5.1.1.1.2" xref="S4.E12.m1.5.5.1.1.1.2.cmml">−</mo><mrow id="S4.E12.m1.5.5.1.1.1.1" xref="S4.E12.m1.5.5.1.1.1.1.cmml"><msup id="S4.E12.m1.5.5.1.1.1.1.3" xref="S4.E12.m1.5.5.1.1.1.1.3.cmml"><mi id="S4.E12.m1.5.5.1.1.1.1.3.2" xref="S4.E12.m1.5.5.1.1.1.1.3.2.cmml">V</mi><mo id="S4.E12.m1.5.5.1.1.1.1.3.3" xref="S4.E12.m1.5.5.1.1.1.1.3.3.cmml">∗</mo></msup><mo id="S4.E12.m1.5.5.1.1.1.1.2" xref="S4.E12.m1.5.5.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E12.m1.5.5.1.1.1.1.1.1" xref="S4.E12.m1.5.5.1.1.1.1.1.1.1.cmml"><mo id="S4.E12.m1.5.5.1.1.1.1.1.1.2" stretchy="false" xref="S4.E12.m1.5.5.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E12.m1.5.5.1.1.1.1.1.1.1" xref="S4.E12.m1.5.5.1.1.1.1.1.1.1.cmml"><mi id="S4.E12.m1.5.5.1.1.1.1.1.1.1.2" xref="S4.E12.m1.5.5.1.1.1.1.1.1.1.2.cmml">ϕ</mi><mo id="S4.E12.m1.5.5.1.1.1.1.1.1.1.1" xref="S4.E12.m1.5.5.1.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S4.E12.m1.5.5.1.1.1.1.1.1.1.3.2" xref="S4.E12.m1.5.5.1.1.1.1.1.1.1.cmml"><mo id="S4.E12.m1.5.5.1.1.1.1.1.1.1.3.2.1" stretchy="false" xref="S4.E12.m1.5.5.1.1.1.1.1.1.1.cmml">(</mo><mi id="S4.E12.m1.4.4" xref="S4.E12.m1.4.4.cmml">s</mi><mo id="S4.E12.m1.5.5.1.1.1.1.1.1.1.3.2.2" stretchy="false" xref="S4.E12.m1.5.5.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E12.m1.5.5.1.1.1.1.1.1.3" stretchy="false" xref="S4.E12.m1.5.5.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E12.m1.5.5.1.1.3" stretchy="false" xref="S4.E12.m1.5.5.1.2.1.cmml">|</mo></mrow><mo id="S4.E12.m1.5.5.2" xref="S4.E12.m1.5.5.2.cmml">≤</mo><mfrac id="S4.E12.m1.2.2" xref="S4.E12.m1.2.2.cmml"><mrow id="S4.E12.m1.2.2.4" xref="S4.E12.m1.2.2.4.cmml"><mrow id="S4.E12.m1.2.2.4.2" xref="S4.E12.m1.2.2.4.2.cmml"><mn id="S4.E12.m1.2.2.4.2.2" xref="S4.E12.m1.2.2.4.2.2.cmml">2</mn><mo id="S4.E12.m1.2.2.4.2.1" xref="S4.E12.m1.2.2.4.2.1.cmml">⁢</mo><mi id="S4.E12.m1.2.2.4.2.3" xref="S4.E12.m1.2.2.4.2.3.cmml">ϵ</mi></mrow><mo id="S4.E12.m1.2.2.4.1" xref="S4.E12.m1.2.2.4.1.cmml">+</mo><mrow id="S4.E12.m1.2.2.4.3" xref="S4.E12.m1.2.2.4.3.cmml"><mn id="S4.E12.m1.2.2.4.3.2" xref="S4.E12.m1.2.2.4.3.2.cmml">2</mn><mo id="S4.E12.m1.2.2.4.3.1" xref="S4.E12.m1.2.2.4.3.1.cmml">⁢</mo><mi class="ltx_font_mathcaligraphic" id="S4.E12.m1.2.2.4.3.3" xref="S4.E12.m1.2.2.4.3.3.cmml">ℒ</mi></mrow></mrow><mrow id="S4.E12.m1.2.2.2" xref="S4.E12.m1.2.2.2.cmml"><mrow id="S4.E12.m1.1.1.1.1.1" xref="S4.E12.m1.1.1.1.1.1.1.cmml"><mo id="S4.E12.m1.1.1.1.1.1.2" stretchy="false" xref="S4.E12.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E12.m1.1.1.1.1.1.1" xref="S4.E12.m1.1.1.1.1.1.1.cmml"><mn id="S4.E12.m1.1.1.1.1.1.1.2" xref="S4.E12.m1.1.1.1.1.1.1.2.cmml">1</mn><mo id="S4.E12.m1.1.1.1.1.1.1.1" xref="S4.E12.m1.1.1.1.1.1.1.1.cmml">−</mo><mi id="S4.E12.m1.1.1.1.1.1.1.3" xref="S4.E12.m1.1.1.1.1.1.1.3.cmml">γ</mi></mrow><mo id="S4.E12.m1.1.1.1.1.1.3" stretchy="false" xref="S4.E12.m1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S4.E12.m1.2.2.2.3" xref="S4.E12.m1.2.2.2.3.cmml">⁢</mo><mrow id="S4.E12.m1.2.2.2.2.1" xref="S4.E12.m1.2.2.2.2.1.1.cmml"><mo id="S4.E12.m1.2.2.2.2.1.2" stretchy="false" xref="S4.E12.m1.2.2.2.2.1.1.cmml">(</mo><mrow id="S4.E12.m1.2.2.2.2.1.1" xref="S4.E12.m1.2.2.2.2.1.1.cmml"><mn id="S4.E12.m1.2.2.2.2.1.1.2" xref="S4.E12.m1.2.2.2.2.1.1.2.cmml">1</mn><mo id="S4.E12.m1.2.2.2.2.1.1.1" xref="S4.E12.m1.2.2.2.2.1.1.1.cmml">−</mo><mi id="S4.E12.m1.2.2.2.2.1.1.3" xref="S4.E12.m1.2.2.2.2.1.1.3.cmml">c</mi></mrow><mo id="S4.E12.m1.2.2.2.2.1.3" stretchy="false" xref="S4.E12.m1.2.2.2.2.1.1.cmml">)</mo></mrow></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S4.E12.m1.5b"><apply id="S4.E12.m1.5.5.cmml" xref="S4.E12.m1.5.5"><leq id="S4.E12.m1.5.5.2.cmml" xref="S4.E12.m1.5.5.2"></leq><apply id="S4.E12.m1.5.5.1.2.cmml" xref="S4.E12.m1.5.5.1.1"><abs id="S4.E12.m1.5.5.1.2.1.cmml" xref="S4.E12.m1.5.5.1.1.2"></abs><apply id="S4.E12.m1.5.5.1.1.1.cmml" xref="S4.E12.m1.5.5.1.1.1"><minus id="S4.E12.m1.5.5.1.1.1.2.cmml" xref="S4.E12.m1.5.5.1.1.1.2"></minus><apply id="S4.E12.m1.5.5.1.1.1.3.cmml" xref="S4.E12.m1.5.5.1.1.1.3"><times id="S4.E12.m1.5.5.1.1.1.3.1.cmml" xref="S4.E12.m1.5.5.1.1.1.3.1"></times><apply id="S4.E12.m1.5.5.1.1.1.3.2.cmml" xref="S4.E12.m1.5.5.1.1.1.3.2"><csymbol cd="ambiguous" id="S4.E12.m1.5.5.1.1.1.3.2.1.cmml" xref="S4.E12.m1.5.5.1.1.1.3.2">superscript</csymbol><ci id="S4.E12.m1.5.5.1.1.1.3.2.2.cmml" xref="S4.E12.m1.5.5.1.1.1.3.2.2">𝑉</ci><times id="S4.E12.m1.5.5.1.1.1.3.2.3.cmml" xref="S4.E12.m1.5.5.1.1.1.3.2.3"></times></apply><ci id="S4.E12.m1.3.3.cmml" xref="S4.E12.m1.3.3">𝑠</ci></apply><apply id="S4.E12.m1.5.5.1.1.1.1.cmml" xref="S4.E12.m1.5.5.1.1.1.1"><times id="S4.E12.m1.5.5.1.1.1.1.2.cmml" xref="S4.E12.m1.5.5.1.1.1.1.2"></times><apply id="S4.E12.m1.5.5.1.1.1.1.3.cmml" xref="S4.E12.m1.5.5.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E12.m1.5.5.1.1.1.1.3.1.cmml" xref="S4.E12.m1.5.5.1.1.1.1.3">superscript</csymbol><ci id="S4.E12.m1.5.5.1.1.1.1.3.2.cmml" xref="S4.E12.m1.5.5.1.1.1.1.3.2">𝑉</ci><times id="S4.E12.m1.5.5.1.1.1.1.3.3.cmml" xref="S4.E12.m1.5.5.1.1.1.1.3.3"></times></apply><apply id="S4.E12.m1.5.5.1.1.1.1.1.1.1.cmml" xref="S4.E12.m1.5.5.1.1.1.1.1.1"><times id="S4.E12.m1.5.5.1.1.1.1.1.1.1.1.cmml" xref="S4.E12.m1.5.5.1.1.1.1.1.1.1.1"></times><ci id="S4.E12.m1.5.5.1.1.1.1.1.1.1.2.cmml" xref="S4.E12.m1.5.5.1.1.1.1.1.1.1.2">italic-ϕ</ci><ci id="S4.E12.m1.4.4.cmml" xref="S4.E12.m1.4.4">𝑠</ci></apply></apply></apply></apply><apply id="S4.E12.m1.2.2.cmml" xref="S4.E12.m1.2.2"><divide id="S4.E12.m1.2.2.3.cmml" xref="S4.E12.m1.2.2"></divide><apply id="S4.E12.m1.2.2.4.cmml" xref="S4.E12.m1.2.2.4"><plus id="S4.E12.m1.2.2.4.1.cmml" xref="S4.E12.m1.2.2.4.1"></plus><apply id="S4.E12.m1.2.2.4.2.cmml" xref="S4.E12.m1.2.2.4.2"><times id="S4.E12.m1.2.2.4.2.1.cmml" xref="S4.E12.m1.2.2.4.2.1"></times><cn id="S4.E12.m1.2.2.4.2.2.cmml" type="integer" xref="S4.E12.m1.2.2.4.2.2">2</cn><ci id="S4.E12.m1.2.2.4.2.3.cmml" xref="S4.E12.m1.2.2.4.2.3">italic-ϵ</ci></apply><apply id="S4.E12.m1.2.2.4.3.cmml" xref="S4.E12.m1.2.2.4.3"><times id="S4.E12.m1.2.2.4.3.1.cmml" xref="S4.E12.m1.2.2.4.3.1"></times><cn id="S4.E12.m1.2.2.4.3.2.cmml" type="integer" xref="S4.E12.m1.2.2.4.3.2">2</cn><ci id="S4.E12.m1.2.2.4.3.3.cmml" xref="S4.E12.m1.2.2.4.3.3">ℒ</ci></apply></apply><apply id="S4.E12.m1.2.2.2.cmml" xref="S4.E12.m1.2.2.2"><times id="S4.E12.m1.2.2.2.3.cmml" xref="S4.E12.m1.2.2.2.3"></times><apply id="S4.E12.m1.1.1.1.1.1.1.cmml" xref="S4.E12.m1.1.1.1.1.1"><minus id="S4.E12.m1.1.1.1.1.1.1.1.cmml" xref="S4.E12.m1.1.1.1.1.1.1.1"></minus><cn id="S4.E12.m1.1.1.1.1.1.1.2.cmml" type="integer" xref="S4.E12.m1.1.1.1.1.1.1.2">1</cn><ci id="S4.E12.m1.1.1.1.1.1.1.3.cmml" xref="S4.E12.m1.1.1.1.1.1.1.3">𝛾</ci></apply><apply id="S4.E12.m1.2.2.2.2.1.1.cmml" xref="S4.E12.m1.2.2.2.2.1"><minus id="S4.E12.m1.2.2.2.2.1.1.1.cmml" xref="S4.E12.m1.2.2.2.2.1.1.1"></minus><cn id="S4.E12.m1.2.2.2.2.1.1.2.cmml" type="integer" xref="S4.E12.m1.2.2.2.2.1.1.2">1</cn><ci id="S4.E12.m1.2.2.2.2.1.1.3.cmml" xref="S4.E12.m1.2.2.2.2.1.1.3">𝑐</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E12.m1.5c">|V^{*}(s)-V^{*}(\phi(s))|\leq\frac{2\epsilon+2{\mathcal{L}}}{(1-\gamma)(1-c)}</annotation><annotation encoding="application/x-llamapun" id="S4.E12.m1.5d">| italic_V start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ( italic_s ) - italic_V start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ( italic_ϕ ( italic_s ) ) | ≤ divide start_ARG 2 italic_ϵ + 2 caligraphic_L end_ARG start_ARG ( 1 - italic_γ ) ( 1 - italic_c ) end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(12)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="Thmthm2.p1.8">where <math alttext="\mathcal{L}:=\sup_{s_{i},s_{j}\in\mathcal{S}}|\left\|\phi(s_{i})-\phi(s_{j})%
\right\|-\tilde{d}(s_{i},s_{j})|" class="ltx_Math" display="inline" id="Thmthm2.p1.5.m1.3"><semantics id="Thmthm2.p1.5.m1.3a"><mrow id="Thmthm2.p1.5.m1.3.3" xref="Thmthm2.p1.5.m1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="Thmthm2.p1.5.m1.3.3.3" xref="Thmthm2.p1.5.m1.3.3.3.cmml">ℒ</mi><mo id="Thmthm2.p1.5.m1.3.3.2" lspace="0.278em" xref="Thmthm2.p1.5.m1.3.3.2.cmml">:=</mo><mrow id="Thmthm2.p1.5.m1.3.3.1" xref="Thmthm2.p1.5.m1.3.3.1.cmml"><msub id="Thmthm2.p1.5.m1.3.3.1.2" xref="Thmthm2.p1.5.m1.3.3.1.2.cmml"><mo id="Thmthm2.p1.5.m1.3.3.1.2.2" lspace="0.111em" rspace="0em" xref="Thmthm2.p1.5.m1.3.3.1.2.2.cmml">sup</mo><mrow id="Thmthm2.p1.5.m1.2.2.2" xref="Thmthm2.p1.5.m1.2.2.2.cmml"><mrow id="Thmthm2.p1.5.m1.2.2.2.2.2" xref="Thmthm2.p1.5.m1.2.2.2.2.3.cmml"><msub id="Thmthm2.p1.5.m1.1.1.1.1.1.1" xref="Thmthm2.p1.5.m1.1.1.1.1.1.1.cmml"><mi id="Thmthm2.p1.5.m1.1.1.1.1.1.1.2" xref="Thmthm2.p1.5.m1.1.1.1.1.1.1.2.cmml">s</mi><mi id="Thmthm2.p1.5.m1.1.1.1.1.1.1.3" xref="Thmthm2.p1.5.m1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="Thmthm2.p1.5.m1.2.2.2.2.2.3" xref="Thmthm2.p1.5.m1.2.2.2.2.3.cmml">,</mo><msub id="Thmthm2.p1.5.m1.2.2.2.2.2.2" xref="Thmthm2.p1.5.m1.2.2.2.2.2.2.cmml"><mi id="Thmthm2.p1.5.m1.2.2.2.2.2.2.2" xref="Thmthm2.p1.5.m1.2.2.2.2.2.2.2.cmml">s</mi><mi id="Thmthm2.p1.5.m1.2.2.2.2.2.2.3" xref="Thmthm2.p1.5.m1.2.2.2.2.2.2.3.cmml">j</mi></msub></mrow><mo id="Thmthm2.p1.5.m1.2.2.2.3" xref="Thmthm2.p1.5.m1.2.2.2.3.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="Thmthm2.p1.5.m1.2.2.2.4" xref="Thmthm2.p1.5.m1.2.2.2.4.cmml">𝒮</mi></mrow></msub><mrow id="Thmthm2.p1.5.m1.3.3.1.1.1" xref="Thmthm2.p1.5.m1.3.3.1.1.2.cmml"><mo id="Thmthm2.p1.5.m1.3.3.1.1.1.2" stretchy="false" xref="Thmthm2.p1.5.m1.3.3.1.1.2.1.cmml">|</mo><mrow id="Thmthm2.p1.5.m1.3.3.1.1.1.1" xref="Thmthm2.p1.5.m1.3.3.1.1.1.1.cmml"><mrow id="Thmthm2.p1.5.m1.3.3.1.1.1.1.1.1" xref="Thmthm2.p1.5.m1.3.3.1.1.1.1.1.2.cmml"><mo id="Thmthm2.p1.5.m1.3.3.1.1.1.1.1.1.2" xref="Thmthm2.p1.5.m1.3.3.1.1.1.1.1.2.1.cmml">‖</mo><mrow id="Thmthm2.p1.5.m1.3.3.1.1.1.1.1.1.1" xref="Thmthm2.p1.5.m1.3.3.1.1.1.1.1.1.1.cmml"><mrow id="Thmthm2.p1.5.m1.3.3.1.1.1.1.1.1.1.1" xref="Thmthm2.p1.5.m1.3.3.1.1.1.1.1.1.1.1.cmml"><mi id="Thmthm2.p1.5.m1.3.3.1.1.1.1.1.1.1.1.3" xref="Thmthm2.p1.5.m1.3.3.1.1.1.1.1.1.1.1.3.cmml">ϕ</mi><mo id="Thmthm2.p1.5.m1.3.3.1.1.1.1.1.1.1.1.2" xref="Thmthm2.p1.5.m1.3.3.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="Thmthm2.p1.5.m1.3.3.1.1.1.1.1.1.1.1.1.1" xref="Thmthm2.p1.5.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="Thmthm2.p1.5.m1.3.3.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="Thmthm2.p1.5.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="Thmthm2.p1.5.m1.3.3.1.1.1.1.1.1.1.1.1.1.1" xref="Thmthm2.p1.5.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="Thmthm2.p1.5.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2" xref="Thmthm2.p1.5.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.cmml">s</mi><mi id="Thmthm2.p1.5.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3" xref="Thmthm2.p1.5.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="Thmthm2.p1.5.m1.3.3.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="Thmthm2.p1.5.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="Thmthm2.p1.5.m1.3.3.1.1.1.1.1.1.1.3" xref="Thmthm2.p1.5.m1.3.3.1.1.1.1.1.1.1.3.cmml">−</mo><mrow id="Thmthm2.p1.5.m1.3.3.1.1.1.1.1.1.1.2" xref="Thmthm2.p1.5.m1.3.3.1.1.1.1.1.1.1.2.cmml"><mi id="Thmthm2.p1.5.m1.3.3.1.1.1.1.1.1.1.2.3" xref="Thmthm2.p1.5.m1.3.3.1.1.1.1.1.1.1.2.3.cmml">ϕ</mi><mo id="Thmthm2.p1.5.m1.3.3.1.1.1.1.1.1.1.2.2" xref="Thmthm2.p1.5.m1.3.3.1.1.1.1.1.1.1.2.2.cmml">⁢</mo><mrow id="Thmthm2.p1.5.m1.3.3.1.1.1.1.1.1.1.2.1.1" xref="Thmthm2.p1.5.m1.3.3.1.1.1.1.1.1.1.2.1.1.1.cmml"><mo id="Thmthm2.p1.5.m1.3.3.1.1.1.1.1.1.1.2.1.1.2" stretchy="false" xref="Thmthm2.p1.5.m1.3.3.1.1.1.1.1.1.1.2.1.1.1.cmml">(</mo><msub id="Thmthm2.p1.5.m1.3.3.1.1.1.1.1.1.1.2.1.1.1" xref="Thmthm2.p1.5.m1.3.3.1.1.1.1.1.1.1.2.1.1.1.cmml"><mi id="Thmthm2.p1.5.m1.3.3.1.1.1.1.1.1.1.2.1.1.1.2" xref="Thmthm2.p1.5.m1.3.3.1.1.1.1.1.1.1.2.1.1.1.2.cmml">s</mi><mi id="Thmthm2.p1.5.m1.3.3.1.1.1.1.1.1.1.2.1.1.1.3" xref="Thmthm2.p1.5.m1.3.3.1.1.1.1.1.1.1.2.1.1.1.3.cmml">j</mi></msub><mo id="Thmthm2.p1.5.m1.3.3.1.1.1.1.1.1.1.2.1.1.3" stretchy="false" xref="Thmthm2.p1.5.m1.3.3.1.1.1.1.1.1.1.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="Thmthm2.p1.5.m1.3.3.1.1.1.1.1.1.3" xref="Thmthm2.p1.5.m1.3.3.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mo id="Thmthm2.p1.5.m1.3.3.1.1.1.1.4" xref="Thmthm2.p1.5.m1.3.3.1.1.1.1.4.cmml">−</mo><mrow id="Thmthm2.p1.5.m1.3.3.1.1.1.1.3" xref="Thmthm2.p1.5.m1.3.3.1.1.1.1.3.cmml"><mover accent="true" id="Thmthm2.p1.5.m1.3.3.1.1.1.1.3.4" xref="Thmthm2.p1.5.m1.3.3.1.1.1.1.3.4.cmml"><mi id="Thmthm2.p1.5.m1.3.3.1.1.1.1.3.4.2" xref="Thmthm2.p1.5.m1.3.3.1.1.1.1.3.4.2.cmml">d</mi><mo id="Thmthm2.p1.5.m1.3.3.1.1.1.1.3.4.1" xref="Thmthm2.p1.5.m1.3.3.1.1.1.1.3.4.1.cmml">~</mo></mover><mo id="Thmthm2.p1.5.m1.3.3.1.1.1.1.3.3" xref="Thmthm2.p1.5.m1.3.3.1.1.1.1.3.3.cmml">⁢</mo><mrow id="Thmthm2.p1.5.m1.3.3.1.1.1.1.3.2.2" xref="Thmthm2.p1.5.m1.3.3.1.1.1.1.3.2.3.cmml"><mo id="Thmthm2.p1.5.m1.3.3.1.1.1.1.3.2.2.3" stretchy="false" xref="Thmthm2.p1.5.m1.3.3.1.1.1.1.3.2.3.cmml">(</mo><msub id="Thmthm2.p1.5.m1.3.3.1.1.1.1.2.1.1.1" xref="Thmthm2.p1.5.m1.3.3.1.1.1.1.2.1.1.1.cmml"><mi id="Thmthm2.p1.5.m1.3.3.1.1.1.1.2.1.1.1.2" xref="Thmthm2.p1.5.m1.3.3.1.1.1.1.2.1.1.1.2.cmml">s</mi><mi id="Thmthm2.p1.5.m1.3.3.1.1.1.1.2.1.1.1.3" xref="Thmthm2.p1.5.m1.3.3.1.1.1.1.2.1.1.1.3.cmml">i</mi></msub><mo id="Thmthm2.p1.5.m1.3.3.1.1.1.1.3.2.2.4" xref="Thmthm2.p1.5.m1.3.3.1.1.1.1.3.2.3.cmml">,</mo><msub id="Thmthm2.p1.5.m1.3.3.1.1.1.1.3.2.2.2" xref="Thmthm2.p1.5.m1.3.3.1.1.1.1.3.2.2.2.cmml"><mi id="Thmthm2.p1.5.m1.3.3.1.1.1.1.3.2.2.2.2" xref="Thmthm2.p1.5.m1.3.3.1.1.1.1.3.2.2.2.2.cmml">s</mi><mi id="Thmthm2.p1.5.m1.3.3.1.1.1.1.3.2.2.2.3" xref="Thmthm2.p1.5.m1.3.3.1.1.1.1.3.2.2.2.3.cmml">j</mi></msub><mo id="Thmthm2.p1.5.m1.3.3.1.1.1.1.3.2.2.5" stretchy="false" xref="Thmthm2.p1.5.m1.3.3.1.1.1.1.3.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="Thmthm2.p1.5.m1.3.3.1.1.1.3" stretchy="false" xref="Thmthm2.p1.5.m1.3.3.1.1.2.1.cmml">|</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmthm2.p1.5.m1.3b"><apply id="Thmthm2.p1.5.m1.3.3.cmml" xref="Thmthm2.p1.5.m1.3.3"><csymbol cd="latexml" id="Thmthm2.p1.5.m1.3.3.2.cmml" xref="Thmthm2.p1.5.m1.3.3.2">assign</csymbol><ci id="Thmthm2.p1.5.m1.3.3.3.cmml" xref="Thmthm2.p1.5.m1.3.3.3">ℒ</ci><apply id="Thmthm2.p1.5.m1.3.3.1.cmml" xref="Thmthm2.p1.5.m1.3.3.1"><apply id="Thmthm2.p1.5.m1.3.3.1.2.cmml" xref="Thmthm2.p1.5.m1.3.3.1.2"><csymbol cd="ambiguous" id="Thmthm2.p1.5.m1.3.3.1.2.1.cmml" xref="Thmthm2.p1.5.m1.3.3.1.2">subscript</csymbol><csymbol cd="latexml" id="Thmthm2.p1.5.m1.3.3.1.2.2.cmml" xref="Thmthm2.p1.5.m1.3.3.1.2.2">supremum</csymbol><apply id="Thmthm2.p1.5.m1.2.2.2.cmml" xref="Thmthm2.p1.5.m1.2.2.2"><in id="Thmthm2.p1.5.m1.2.2.2.3.cmml" xref="Thmthm2.p1.5.m1.2.2.2.3"></in><list id="Thmthm2.p1.5.m1.2.2.2.2.3.cmml" xref="Thmthm2.p1.5.m1.2.2.2.2.2"><apply id="Thmthm2.p1.5.m1.1.1.1.1.1.1.cmml" xref="Thmthm2.p1.5.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="Thmthm2.p1.5.m1.1.1.1.1.1.1.1.cmml" xref="Thmthm2.p1.5.m1.1.1.1.1.1.1">subscript</csymbol><ci id="Thmthm2.p1.5.m1.1.1.1.1.1.1.2.cmml" xref="Thmthm2.p1.5.m1.1.1.1.1.1.1.2">𝑠</ci><ci id="Thmthm2.p1.5.m1.1.1.1.1.1.1.3.cmml" xref="Thmthm2.p1.5.m1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="Thmthm2.p1.5.m1.2.2.2.2.2.2.cmml" xref="Thmthm2.p1.5.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="Thmthm2.p1.5.m1.2.2.2.2.2.2.1.cmml" xref="Thmthm2.p1.5.m1.2.2.2.2.2.2">subscript</csymbol><ci id="Thmthm2.p1.5.m1.2.2.2.2.2.2.2.cmml" xref="Thmthm2.p1.5.m1.2.2.2.2.2.2.2">𝑠</ci><ci id="Thmthm2.p1.5.m1.2.2.2.2.2.2.3.cmml" xref="Thmthm2.p1.5.m1.2.2.2.2.2.2.3">𝑗</ci></apply></list><ci id="Thmthm2.p1.5.m1.2.2.2.4.cmml" xref="Thmthm2.p1.5.m1.2.2.2.4">𝒮</ci></apply></apply><apply id="Thmthm2.p1.5.m1.3.3.1.1.2.cmml" xref="Thmthm2.p1.5.m1.3.3.1.1.1"><abs id="Thmthm2.p1.5.m1.3.3.1.1.2.1.cmml" xref="Thmthm2.p1.5.m1.3.3.1.1.1.2"></abs><apply id="Thmthm2.p1.5.m1.3.3.1.1.1.1.cmml" xref="Thmthm2.p1.5.m1.3.3.1.1.1.1"><minus id="Thmthm2.p1.5.m1.3.3.1.1.1.1.4.cmml" xref="Thmthm2.p1.5.m1.3.3.1.1.1.1.4"></minus><apply id="Thmthm2.p1.5.m1.3.3.1.1.1.1.1.2.cmml" xref="Thmthm2.p1.5.m1.3.3.1.1.1.1.1.1"><csymbol cd="latexml" id="Thmthm2.p1.5.m1.3.3.1.1.1.1.1.2.1.cmml" xref="Thmthm2.p1.5.m1.3.3.1.1.1.1.1.1.2">norm</csymbol><apply id="Thmthm2.p1.5.m1.3.3.1.1.1.1.1.1.1.cmml" xref="Thmthm2.p1.5.m1.3.3.1.1.1.1.1.1.1"><minus id="Thmthm2.p1.5.m1.3.3.1.1.1.1.1.1.1.3.cmml" xref="Thmthm2.p1.5.m1.3.3.1.1.1.1.1.1.1.3"></minus><apply id="Thmthm2.p1.5.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="Thmthm2.p1.5.m1.3.3.1.1.1.1.1.1.1.1"><times id="Thmthm2.p1.5.m1.3.3.1.1.1.1.1.1.1.1.2.cmml" xref="Thmthm2.p1.5.m1.3.3.1.1.1.1.1.1.1.1.2"></times><ci id="Thmthm2.p1.5.m1.3.3.1.1.1.1.1.1.1.1.3.cmml" xref="Thmthm2.p1.5.m1.3.3.1.1.1.1.1.1.1.1.3">italic-ϕ</ci><apply id="Thmthm2.p1.5.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="Thmthm2.p1.5.m1.3.3.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="Thmthm2.p1.5.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="Thmthm2.p1.5.m1.3.3.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="Thmthm2.p1.5.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="Thmthm2.p1.5.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2">𝑠</ci><ci id="Thmthm2.p1.5.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="Thmthm2.p1.5.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply><apply id="Thmthm2.p1.5.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="Thmthm2.p1.5.m1.3.3.1.1.1.1.1.1.1.2"><times id="Thmthm2.p1.5.m1.3.3.1.1.1.1.1.1.1.2.2.cmml" xref="Thmthm2.p1.5.m1.3.3.1.1.1.1.1.1.1.2.2"></times><ci id="Thmthm2.p1.5.m1.3.3.1.1.1.1.1.1.1.2.3.cmml" xref="Thmthm2.p1.5.m1.3.3.1.1.1.1.1.1.1.2.3">italic-ϕ</ci><apply id="Thmthm2.p1.5.m1.3.3.1.1.1.1.1.1.1.2.1.1.1.cmml" xref="Thmthm2.p1.5.m1.3.3.1.1.1.1.1.1.1.2.1.1"><csymbol cd="ambiguous" id="Thmthm2.p1.5.m1.3.3.1.1.1.1.1.1.1.2.1.1.1.1.cmml" xref="Thmthm2.p1.5.m1.3.3.1.1.1.1.1.1.1.2.1.1">subscript</csymbol><ci id="Thmthm2.p1.5.m1.3.3.1.1.1.1.1.1.1.2.1.1.1.2.cmml" xref="Thmthm2.p1.5.m1.3.3.1.1.1.1.1.1.1.2.1.1.1.2">𝑠</ci><ci id="Thmthm2.p1.5.m1.3.3.1.1.1.1.1.1.1.2.1.1.1.3.cmml" xref="Thmthm2.p1.5.m1.3.3.1.1.1.1.1.1.1.2.1.1.1.3">𝑗</ci></apply></apply></apply></apply><apply id="Thmthm2.p1.5.m1.3.3.1.1.1.1.3.cmml" xref="Thmthm2.p1.5.m1.3.3.1.1.1.1.3"><times id="Thmthm2.p1.5.m1.3.3.1.1.1.1.3.3.cmml" xref="Thmthm2.p1.5.m1.3.3.1.1.1.1.3.3"></times><apply id="Thmthm2.p1.5.m1.3.3.1.1.1.1.3.4.cmml" xref="Thmthm2.p1.5.m1.3.3.1.1.1.1.3.4"><ci id="Thmthm2.p1.5.m1.3.3.1.1.1.1.3.4.1.cmml" xref="Thmthm2.p1.5.m1.3.3.1.1.1.1.3.4.1">~</ci><ci id="Thmthm2.p1.5.m1.3.3.1.1.1.1.3.4.2.cmml" xref="Thmthm2.p1.5.m1.3.3.1.1.1.1.3.4.2">𝑑</ci></apply><interval closure="open" id="Thmthm2.p1.5.m1.3.3.1.1.1.1.3.2.3.cmml" xref="Thmthm2.p1.5.m1.3.3.1.1.1.1.3.2.2"><apply id="Thmthm2.p1.5.m1.3.3.1.1.1.1.2.1.1.1.cmml" xref="Thmthm2.p1.5.m1.3.3.1.1.1.1.2.1.1.1"><csymbol cd="ambiguous" id="Thmthm2.p1.5.m1.3.3.1.1.1.1.2.1.1.1.1.cmml" xref="Thmthm2.p1.5.m1.3.3.1.1.1.1.2.1.1.1">subscript</csymbol><ci id="Thmthm2.p1.5.m1.3.3.1.1.1.1.2.1.1.1.2.cmml" xref="Thmthm2.p1.5.m1.3.3.1.1.1.1.2.1.1.1.2">𝑠</ci><ci id="Thmthm2.p1.5.m1.3.3.1.1.1.1.2.1.1.1.3.cmml" xref="Thmthm2.p1.5.m1.3.3.1.1.1.1.2.1.1.1.3">𝑖</ci></apply><apply id="Thmthm2.p1.5.m1.3.3.1.1.1.1.3.2.2.2.cmml" xref="Thmthm2.p1.5.m1.3.3.1.1.1.1.3.2.2.2"><csymbol cd="ambiguous" id="Thmthm2.p1.5.m1.3.3.1.1.1.1.3.2.2.2.1.cmml" xref="Thmthm2.p1.5.m1.3.3.1.1.1.1.3.2.2.2">subscript</csymbol><ci id="Thmthm2.p1.5.m1.3.3.1.1.1.1.3.2.2.2.2.cmml" xref="Thmthm2.p1.5.m1.3.3.1.1.1.1.3.2.2.2.2">𝑠</ci><ci id="Thmthm2.p1.5.m1.3.3.1.1.1.1.3.2.2.2.3.cmml" xref="Thmthm2.p1.5.m1.3.3.1.1.1.1.3.2.2.2.3">𝑗</ci></apply></interval></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmthm2.p1.5.m1.3c">\mathcal{L}:=\sup_{s_{i},s_{j}\in\mathcal{S}}|\left\|\phi(s_{i})-\phi(s_{j})%
\right\|-\tilde{d}(s_{i},s_{j})|</annotation><annotation encoding="application/x-llamapun" id="Thmthm2.p1.5.m1.3d">caligraphic_L := roman_sup start_POSTSUBSCRIPT italic_s start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_s start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ∈ caligraphic_S end_POSTSUBSCRIPT | ∥ italic_ϕ ( italic_s start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) - italic_ϕ ( italic_s start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) ∥ - over~ start_ARG italic_d end_ARG ( italic_s start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_s start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) |</annotation></semantics></math> is the learning error for encoder <math alttext="\phi" class="ltx_Math" display="inline" id="Thmthm2.p1.6.m2.1"><semantics id="Thmthm2.p1.6.m2.1a"><mi id="Thmthm2.p1.6.m2.1.1" xref="Thmthm2.p1.6.m2.1.1.cmml">ϕ</mi><annotation-xml encoding="MathML-Content" id="Thmthm2.p1.6.m2.1b"><ci id="Thmthm2.p1.6.m2.1.1.cmml" xref="Thmthm2.p1.6.m2.1.1">italic-ϕ</ci></annotation-xml><annotation encoding="application/x-tex" id="Thmthm2.p1.6.m2.1c">\phi</annotation><annotation encoding="application/x-llamapun" id="Thmthm2.p1.6.m2.1d">italic_ϕ</annotation></semantics></math>.
Note that this theorem assumes access to the true dynamics model <math alttext="{\mathcal{P}}" class="ltx_Math" display="inline" id="Thmthm2.p1.7.m3.1"><semantics id="Thmthm2.p1.7.m3.1a"><mi class="ltx_font_mathcaligraphic" id="Thmthm2.p1.7.m3.1.1" xref="Thmthm2.p1.7.m3.1.1.cmml">𝒫</mi><annotation-xml encoding="MathML-Content" id="Thmthm2.p1.7.m3.1b"><ci id="Thmthm2.p1.7.m3.1.1.cmml" xref="Thmthm2.p1.7.m3.1.1">𝒫</ci></annotation-xml><annotation encoding="application/x-tex" id="Thmthm2.p1.7.m3.1c">{\mathcal{P}}</annotation><annotation encoding="application/x-llamapun" id="Thmthm2.p1.7.m3.1d">caligraphic_P</annotation></semantics></math> and reward function <math alttext="{\mathcal{R}}" class="ltx_Math" display="inline" id="Thmthm2.p1.8.m4.1"><semantics id="Thmthm2.p1.8.m4.1a"><mi class="ltx_font_mathcaligraphic" id="Thmthm2.p1.8.m4.1.1" xref="Thmthm2.p1.8.m4.1.1.cmml">ℛ</mi><annotation-xml encoding="MathML-Content" id="Thmthm2.p1.8.m4.1b"><ci id="Thmthm2.p1.8.m4.1.1.cmml" xref="Thmthm2.p1.8.m4.1.1">ℛ</ci></annotation-xml><annotation encoding="application/x-tex" id="Thmthm2.p1.8.m4.1c">{\mathcal{R}}</annotation><annotation encoding="application/x-llamapun" id="Thmthm2.p1.8.m4.1d">caligraphic_R</annotation></semantics></math>.</p>
</div>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS2.p4">
<p class="ltx_p" id="S4.SS2.p4.3">Proof can also be found in <cite class="ltx_cite ltx_citemacro_citep">(Zhang et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#bib.bib47" title="">2021</a>)</cite>. This result demonstrates that the optimal value function in the original state space and the optimal value function in the latent space, projected by the <math alttext="\pi^{*}" class="ltx_Math" display="inline" id="S4.SS2.p4.1.m1.1"><semantics id="S4.SS2.p4.1.m1.1a"><msup id="S4.SS2.p4.1.m1.1.1" xref="S4.SS2.p4.1.m1.1.1.cmml"><mi id="S4.SS2.p4.1.m1.1.1.2" xref="S4.SS2.p4.1.m1.1.1.2.cmml">π</mi><mo id="S4.SS2.p4.1.m1.1.1.3" xref="S4.SS2.p4.1.m1.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.1.m1.1b"><apply id="S4.SS2.p4.1.m1.1.1.cmml" xref="S4.SS2.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p4.1.m1.1.1.1.cmml" xref="S4.SS2.p4.1.m1.1.1">superscript</csymbol><ci id="S4.SS2.p4.1.m1.1.1.2.cmml" xref="S4.SS2.p4.1.m1.1.1.2">𝜋</ci><times id="S4.SS2.p4.1.m1.1.1.3.cmml" xref="S4.SS2.p4.1.m1.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.1.m1.1c">\pi^{*}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p4.1.m1.1d">italic_π start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math>-bisimulation metric, is bounded from above.
Leveraging Theorem <a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#Thmthm1" title="Theorem 1. ‣ 4.2 Theoretical Analysis ‣ 4 Bisimulation metric for model predictive control ‣ Bisimulation metric for Model Predictive Control"><span class="ltx_text ltx_ref_tag">1</span></a> and Theorem <a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#Thmthm2" title="Theorem 2. ‣ 4.2 Theoretical Analysis ‣ 4 Bisimulation metric for model predictive control ‣ Bisimulation metric for Model Predictive Control"><span class="ltx_text ltx_ref_tag">2</span></a>, we can bound the cumulative reward of a trajectory under the original MDP <math alttext="\mathcal{M}" class="ltx_Math" display="inline" id="S4.SS2.p4.2.m2.1"><semantics id="S4.SS2.p4.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p4.2.m2.1.1" xref="S4.SS2.p4.2.m2.1.1.cmml">ℳ</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.2.m2.1b"><ci id="S4.SS2.p4.2.m2.1.1.cmml" xref="S4.SS2.p4.2.m2.1.1">ℳ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.2.m2.1c">\mathcal{M}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p4.2.m2.1d">caligraphic_M</annotation></semantics></math> and the latent MDP <math alttext="\bar{\mathcal{M}}" class="ltx_Math" display="inline" id="S4.SS2.p4.3.m3.1"><semantics id="S4.SS2.p4.3.m3.1a"><mover accent="true" id="S4.SS2.p4.3.m3.1.1" xref="S4.SS2.p4.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p4.3.m3.1.1.2" xref="S4.SS2.p4.3.m3.1.1.2.cmml">ℳ</mi><mo id="S4.SS2.p4.3.m3.1.1.1" xref="S4.SS2.p4.3.m3.1.1.1.cmml">¯</mo></mover><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.3.m3.1b"><apply id="S4.SS2.p4.3.m3.1.1.cmml" xref="S4.SS2.p4.3.m3.1.1"><ci id="S4.SS2.p4.3.m3.1.1.1.cmml" xref="S4.SS2.p4.3.m3.1.1.1">¯</ci><ci id="S4.SS2.p4.3.m3.1.1.2.cmml" xref="S4.SS2.p4.3.m3.1.1.2">ℳ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.3.m3.1c">\bar{\mathcal{M}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p4.3.m3.1d">over¯ start_ARG caligraphic_M end_ARG</annotation></semantics></math>.</p>
</div>
<div class="ltx_theorem ltx_theorem_thm" id="Thmthm3">
<h6 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span class="ltx_text ltx_font_bold" id="Thmthm3.1.1.1">Theorem 3</span></span><span class="ltx_text ltx_font_bold" id="Thmthm3.2.2">.</span>
</h6>
<div class="ltx_para" id="Thmthm3.p1">
<p class="ltx_p" id="Thmthm3.p1.6">Consider a trajectory <math alttext="\tau=(s_{0},a_{0},s_{1},a_{1},\dots,s_{H-1},a_{H-1},s_{H})" class="ltx_Math" display="inline" id="Thmthm3.p1.1.m1.8"><semantics id="Thmthm3.p1.1.m1.8a"><mrow id="Thmthm3.p1.1.m1.8.8" xref="Thmthm3.p1.1.m1.8.8.cmml"><mi id="Thmthm3.p1.1.m1.8.8.9" xref="Thmthm3.p1.1.m1.8.8.9.cmml">τ</mi><mo id="Thmthm3.p1.1.m1.8.8.8" xref="Thmthm3.p1.1.m1.8.8.8.cmml">=</mo><mrow id="Thmthm3.p1.1.m1.8.8.7.7" xref="Thmthm3.p1.1.m1.8.8.7.8.cmml"><mo id="Thmthm3.p1.1.m1.8.8.7.7.8" stretchy="false" xref="Thmthm3.p1.1.m1.8.8.7.8.cmml">(</mo><msub id="Thmthm3.p1.1.m1.2.2.1.1.1" xref="Thmthm3.p1.1.m1.2.2.1.1.1.cmml"><mi id="Thmthm3.p1.1.m1.2.2.1.1.1.2" xref="Thmthm3.p1.1.m1.2.2.1.1.1.2.cmml">s</mi><mn id="Thmthm3.p1.1.m1.2.2.1.1.1.3" xref="Thmthm3.p1.1.m1.2.2.1.1.1.3.cmml">0</mn></msub><mo id="Thmthm3.p1.1.m1.8.8.7.7.9" xref="Thmthm3.p1.1.m1.8.8.7.8.cmml">,</mo><msub id="Thmthm3.p1.1.m1.3.3.2.2.2" xref="Thmthm3.p1.1.m1.3.3.2.2.2.cmml"><mi id="Thmthm3.p1.1.m1.3.3.2.2.2.2" xref="Thmthm3.p1.1.m1.3.3.2.2.2.2.cmml">a</mi><mn id="Thmthm3.p1.1.m1.3.3.2.2.2.3" xref="Thmthm3.p1.1.m1.3.3.2.2.2.3.cmml">0</mn></msub><mo id="Thmthm3.p1.1.m1.8.8.7.7.10" xref="Thmthm3.p1.1.m1.8.8.7.8.cmml">,</mo><msub id="Thmthm3.p1.1.m1.4.4.3.3.3" xref="Thmthm3.p1.1.m1.4.4.3.3.3.cmml"><mi id="Thmthm3.p1.1.m1.4.4.3.3.3.2" xref="Thmthm3.p1.1.m1.4.4.3.3.3.2.cmml">s</mi><mn id="Thmthm3.p1.1.m1.4.4.3.3.3.3" xref="Thmthm3.p1.1.m1.4.4.3.3.3.3.cmml">1</mn></msub><mo id="Thmthm3.p1.1.m1.8.8.7.7.11" xref="Thmthm3.p1.1.m1.8.8.7.8.cmml">,</mo><msub id="Thmthm3.p1.1.m1.5.5.4.4.4" xref="Thmthm3.p1.1.m1.5.5.4.4.4.cmml"><mi id="Thmthm3.p1.1.m1.5.5.4.4.4.2" xref="Thmthm3.p1.1.m1.5.5.4.4.4.2.cmml">a</mi><mn id="Thmthm3.p1.1.m1.5.5.4.4.4.3" xref="Thmthm3.p1.1.m1.5.5.4.4.4.3.cmml">1</mn></msub><mo id="Thmthm3.p1.1.m1.8.8.7.7.12" xref="Thmthm3.p1.1.m1.8.8.7.8.cmml">,</mo><mi id="Thmthm3.p1.1.m1.1.1" mathvariant="normal" xref="Thmthm3.p1.1.m1.1.1.cmml">…</mi><mo id="Thmthm3.p1.1.m1.8.8.7.7.13" xref="Thmthm3.p1.1.m1.8.8.7.8.cmml">,</mo><msub id="Thmthm3.p1.1.m1.6.6.5.5.5" xref="Thmthm3.p1.1.m1.6.6.5.5.5.cmml"><mi id="Thmthm3.p1.1.m1.6.6.5.5.5.2" xref="Thmthm3.p1.1.m1.6.6.5.5.5.2.cmml">s</mi><mrow id="Thmthm3.p1.1.m1.6.6.5.5.5.3" xref="Thmthm3.p1.1.m1.6.6.5.5.5.3.cmml"><mi id="Thmthm3.p1.1.m1.6.6.5.5.5.3.2" xref="Thmthm3.p1.1.m1.6.6.5.5.5.3.2.cmml">H</mi><mo id="Thmthm3.p1.1.m1.6.6.5.5.5.3.1" xref="Thmthm3.p1.1.m1.6.6.5.5.5.3.1.cmml">−</mo><mn id="Thmthm3.p1.1.m1.6.6.5.5.5.3.3" xref="Thmthm3.p1.1.m1.6.6.5.5.5.3.3.cmml">1</mn></mrow></msub><mo id="Thmthm3.p1.1.m1.8.8.7.7.14" xref="Thmthm3.p1.1.m1.8.8.7.8.cmml">,</mo><msub id="Thmthm3.p1.1.m1.7.7.6.6.6" xref="Thmthm3.p1.1.m1.7.7.6.6.6.cmml"><mi id="Thmthm3.p1.1.m1.7.7.6.6.6.2" xref="Thmthm3.p1.1.m1.7.7.6.6.6.2.cmml">a</mi><mrow id="Thmthm3.p1.1.m1.7.7.6.6.6.3" xref="Thmthm3.p1.1.m1.7.7.6.6.6.3.cmml"><mi id="Thmthm3.p1.1.m1.7.7.6.6.6.3.2" xref="Thmthm3.p1.1.m1.7.7.6.6.6.3.2.cmml">H</mi><mo id="Thmthm3.p1.1.m1.7.7.6.6.6.3.1" xref="Thmthm3.p1.1.m1.7.7.6.6.6.3.1.cmml">−</mo><mn id="Thmthm3.p1.1.m1.7.7.6.6.6.3.3" xref="Thmthm3.p1.1.m1.7.7.6.6.6.3.3.cmml">1</mn></mrow></msub><mo id="Thmthm3.p1.1.m1.8.8.7.7.15" xref="Thmthm3.p1.1.m1.8.8.7.8.cmml">,</mo><msub id="Thmthm3.p1.1.m1.8.8.7.7.7" xref="Thmthm3.p1.1.m1.8.8.7.7.7.cmml"><mi id="Thmthm3.p1.1.m1.8.8.7.7.7.2" xref="Thmthm3.p1.1.m1.8.8.7.7.7.2.cmml">s</mi><mi id="Thmthm3.p1.1.m1.8.8.7.7.7.3" xref="Thmthm3.p1.1.m1.8.8.7.7.7.3.cmml">H</mi></msub><mo id="Thmthm3.p1.1.m1.8.8.7.7.16" stretchy="false" xref="Thmthm3.p1.1.m1.8.8.7.8.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmthm3.p1.1.m1.8b"><apply id="Thmthm3.p1.1.m1.8.8.cmml" xref="Thmthm3.p1.1.m1.8.8"><eq id="Thmthm3.p1.1.m1.8.8.8.cmml" xref="Thmthm3.p1.1.m1.8.8.8"></eq><ci id="Thmthm3.p1.1.m1.8.8.9.cmml" xref="Thmthm3.p1.1.m1.8.8.9">𝜏</ci><vector id="Thmthm3.p1.1.m1.8.8.7.8.cmml" xref="Thmthm3.p1.1.m1.8.8.7.7"><apply id="Thmthm3.p1.1.m1.2.2.1.1.1.cmml" xref="Thmthm3.p1.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="Thmthm3.p1.1.m1.2.2.1.1.1.1.cmml" xref="Thmthm3.p1.1.m1.2.2.1.1.1">subscript</csymbol><ci id="Thmthm3.p1.1.m1.2.2.1.1.1.2.cmml" xref="Thmthm3.p1.1.m1.2.2.1.1.1.2">𝑠</ci><cn id="Thmthm3.p1.1.m1.2.2.1.1.1.3.cmml" type="integer" xref="Thmthm3.p1.1.m1.2.2.1.1.1.3">0</cn></apply><apply id="Thmthm3.p1.1.m1.3.3.2.2.2.cmml" xref="Thmthm3.p1.1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="Thmthm3.p1.1.m1.3.3.2.2.2.1.cmml" xref="Thmthm3.p1.1.m1.3.3.2.2.2">subscript</csymbol><ci id="Thmthm3.p1.1.m1.3.3.2.2.2.2.cmml" xref="Thmthm3.p1.1.m1.3.3.2.2.2.2">𝑎</ci><cn id="Thmthm3.p1.1.m1.3.3.2.2.2.3.cmml" type="integer" xref="Thmthm3.p1.1.m1.3.3.2.2.2.3">0</cn></apply><apply id="Thmthm3.p1.1.m1.4.4.3.3.3.cmml" xref="Thmthm3.p1.1.m1.4.4.3.3.3"><csymbol cd="ambiguous" id="Thmthm3.p1.1.m1.4.4.3.3.3.1.cmml" xref="Thmthm3.p1.1.m1.4.4.3.3.3">subscript</csymbol><ci id="Thmthm3.p1.1.m1.4.4.3.3.3.2.cmml" xref="Thmthm3.p1.1.m1.4.4.3.3.3.2">𝑠</ci><cn id="Thmthm3.p1.1.m1.4.4.3.3.3.3.cmml" type="integer" xref="Thmthm3.p1.1.m1.4.4.3.3.3.3">1</cn></apply><apply id="Thmthm3.p1.1.m1.5.5.4.4.4.cmml" xref="Thmthm3.p1.1.m1.5.5.4.4.4"><csymbol cd="ambiguous" id="Thmthm3.p1.1.m1.5.5.4.4.4.1.cmml" xref="Thmthm3.p1.1.m1.5.5.4.4.4">subscript</csymbol><ci id="Thmthm3.p1.1.m1.5.5.4.4.4.2.cmml" xref="Thmthm3.p1.1.m1.5.5.4.4.4.2">𝑎</ci><cn id="Thmthm3.p1.1.m1.5.5.4.4.4.3.cmml" type="integer" xref="Thmthm3.p1.1.m1.5.5.4.4.4.3">1</cn></apply><ci id="Thmthm3.p1.1.m1.1.1.cmml" xref="Thmthm3.p1.1.m1.1.1">…</ci><apply id="Thmthm3.p1.1.m1.6.6.5.5.5.cmml" xref="Thmthm3.p1.1.m1.6.6.5.5.5"><csymbol cd="ambiguous" id="Thmthm3.p1.1.m1.6.6.5.5.5.1.cmml" xref="Thmthm3.p1.1.m1.6.6.5.5.5">subscript</csymbol><ci id="Thmthm3.p1.1.m1.6.6.5.5.5.2.cmml" xref="Thmthm3.p1.1.m1.6.6.5.5.5.2">𝑠</ci><apply id="Thmthm3.p1.1.m1.6.6.5.5.5.3.cmml" xref="Thmthm3.p1.1.m1.6.6.5.5.5.3"><minus id="Thmthm3.p1.1.m1.6.6.5.5.5.3.1.cmml" xref="Thmthm3.p1.1.m1.6.6.5.5.5.3.1"></minus><ci id="Thmthm3.p1.1.m1.6.6.5.5.5.3.2.cmml" xref="Thmthm3.p1.1.m1.6.6.5.5.5.3.2">𝐻</ci><cn id="Thmthm3.p1.1.m1.6.6.5.5.5.3.3.cmml" type="integer" xref="Thmthm3.p1.1.m1.6.6.5.5.5.3.3">1</cn></apply></apply><apply id="Thmthm3.p1.1.m1.7.7.6.6.6.cmml" xref="Thmthm3.p1.1.m1.7.7.6.6.6"><csymbol cd="ambiguous" id="Thmthm3.p1.1.m1.7.7.6.6.6.1.cmml" xref="Thmthm3.p1.1.m1.7.7.6.6.6">subscript</csymbol><ci id="Thmthm3.p1.1.m1.7.7.6.6.6.2.cmml" xref="Thmthm3.p1.1.m1.7.7.6.6.6.2">𝑎</ci><apply id="Thmthm3.p1.1.m1.7.7.6.6.6.3.cmml" xref="Thmthm3.p1.1.m1.7.7.6.6.6.3"><minus id="Thmthm3.p1.1.m1.7.7.6.6.6.3.1.cmml" xref="Thmthm3.p1.1.m1.7.7.6.6.6.3.1"></minus><ci id="Thmthm3.p1.1.m1.7.7.6.6.6.3.2.cmml" xref="Thmthm3.p1.1.m1.7.7.6.6.6.3.2">𝐻</ci><cn id="Thmthm3.p1.1.m1.7.7.6.6.6.3.3.cmml" type="integer" xref="Thmthm3.p1.1.m1.7.7.6.6.6.3.3">1</cn></apply></apply><apply id="Thmthm3.p1.1.m1.8.8.7.7.7.cmml" xref="Thmthm3.p1.1.m1.8.8.7.7.7"><csymbol cd="ambiguous" id="Thmthm3.p1.1.m1.8.8.7.7.7.1.cmml" xref="Thmthm3.p1.1.m1.8.8.7.7.7">subscript</csymbol><ci id="Thmthm3.p1.1.m1.8.8.7.7.7.2.cmml" xref="Thmthm3.p1.1.m1.8.8.7.7.7.2">𝑠</ci><ci id="Thmthm3.p1.1.m1.8.8.7.7.7.3.cmml" xref="Thmthm3.p1.1.m1.8.8.7.7.7.3">𝐻</ci></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmthm3.p1.1.m1.8c">\tau=(s_{0},a_{0},s_{1},a_{1},\dots,s_{H-1},a_{H-1},s_{H})</annotation><annotation encoding="application/x-llamapun" id="Thmthm3.p1.1.m1.8d">italic_τ = ( italic_s start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , italic_a start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , italic_s start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_a start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_s start_POSTSUBSCRIPT italic_H - 1 end_POSTSUBSCRIPT , italic_a start_POSTSUBSCRIPT italic_H - 1 end_POSTSUBSCRIPT , italic_s start_POSTSUBSCRIPT italic_H end_POSTSUBSCRIPT )</annotation></semantics></math> in the original state space <math alttext="\mathcal{S}" class="ltx_Math" display="inline" id="Thmthm3.p1.2.m2.1"><semantics id="Thmthm3.p1.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="Thmthm3.p1.2.m2.1.1" xref="Thmthm3.p1.2.m2.1.1.cmml">𝒮</mi><annotation-xml encoding="MathML-Content" id="Thmthm3.p1.2.m2.1b"><ci id="Thmthm3.p1.2.m2.1.1.cmml" xref="Thmthm3.p1.2.m2.1.1">𝒮</ci></annotation-xml><annotation encoding="application/x-tex" id="Thmthm3.p1.2.m2.1c">\mathcal{S}</annotation><annotation encoding="application/x-llamapun" id="Thmthm3.p1.2.m2.1d">caligraphic_S</annotation></semantics></math>, and its corresponding encoded trajectory <math alttext="\phi(\tau)=(z_{0},a_{0},z_{1},a_{1},\dots,z_{H-1},a_{H-1},z_{H})" class="ltx_Math" display="inline" id="Thmthm3.p1.3.m3.9"><semantics id="Thmthm3.p1.3.m3.9a"><mrow id="Thmthm3.p1.3.m3.9.9" xref="Thmthm3.p1.3.m3.9.9.cmml"><mrow id="Thmthm3.p1.3.m3.9.9.9" xref="Thmthm3.p1.3.m3.9.9.9.cmml"><mi id="Thmthm3.p1.3.m3.9.9.9.2" xref="Thmthm3.p1.3.m3.9.9.9.2.cmml">ϕ</mi><mo id="Thmthm3.p1.3.m3.9.9.9.1" xref="Thmthm3.p1.3.m3.9.9.9.1.cmml">⁢</mo><mrow id="Thmthm3.p1.3.m3.9.9.9.3.2" xref="Thmthm3.p1.3.m3.9.9.9.cmml"><mo id="Thmthm3.p1.3.m3.9.9.9.3.2.1" stretchy="false" xref="Thmthm3.p1.3.m3.9.9.9.cmml">(</mo><mi id="Thmthm3.p1.3.m3.1.1" xref="Thmthm3.p1.3.m3.1.1.cmml">τ</mi><mo id="Thmthm3.p1.3.m3.9.9.9.3.2.2" stretchy="false" xref="Thmthm3.p1.3.m3.9.9.9.cmml">)</mo></mrow></mrow><mo id="Thmthm3.p1.3.m3.9.9.8" xref="Thmthm3.p1.3.m3.9.9.8.cmml">=</mo><mrow id="Thmthm3.p1.3.m3.9.9.7.7" xref="Thmthm3.p1.3.m3.9.9.7.8.cmml"><mo id="Thmthm3.p1.3.m3.9.9.7.7.8" stretchy="false" xref="Thmthm3.p1.3.m3.9.9.7.8.cmml">(</mo><msub id="Thmthm3.p1.3.m3.3.3.1.1.1" xref="Thmthm3.p1.3.m3.3.3.1.1.1.cmml"><mi id="Thmthm3.p1.3.m3.3.3.1.1.1.2" xref="Thmthm3.p1.3.m3.3.3.1.1.1.2.cmml">z</mi><mn id="Thmthm3.p1.3.m3.3.3.1.1.1.3" xref="Thmthm3.p1.3.m3.3.3.1.1.1.3.cmml">0</mn></msub><mo id="Thmthm3.p1.3.m3.9.9.7.7.9" xref="Thmthm3.p1.3.m3.9.9.7.8.cmml">,</mo><msub id="Thmthm3.p1.3.m3.4.4.2.2.2" xref="Thmthm3.p1.3.m3.4.4.2.2.2.cmml"><mi id="Thmthm3.p1.3.m3.4.4.2.2.2.2" xref="Thmthm3.p1.3.m3.4.4.2.2.2.2.cmml">a</mi><mn id="Thmthm3.p1.3.m3.4.4.2.2.2.3" xref="Thmthm3.p1.3.m3.4.4.2.2.2.3.cmml">0</mn></msub><mo id="Thmthm3.p1.3.m3.9.9.7.7.10" xref="Thmthm3.p1.3.m3.9.9.7.8.cmml">,</mo><msub id="Thmthm3.p1.3.m3.5.5.3.3.3" xref="Thmthm3.p1.3.m3.5.5.3.3.3.cmml"><mi id="Thmthm3.p1.3.m3.5.5.3.3.3.2" xref="Thmthm3.p1.3.m3.5.5.3.3.3.2.cmml">z</mi><mn id="Thmthm3.p1.3.m3.5.5.3.3.3.3" xref="Thmthm3.p1.3.m3.5.5.3.3.3.3.cmml">1</mn></msub><mo id="Thmthm3.p1.3.m3.9.9.7.7.11" xref="Thmthm3.p1.3.m3.9.9.7.8.cmml">,</mo><msub id="Thmthm3.p1.3.m3.6.6.4.4.4" xref="Thmthm3.p1.3.m3.6.6.4.4.4.cmml"><mi id="Thmthm3.p1.3.m3.6.6.4.4.4.2" xref="Thmthm3.p1.3.m3.6.6.4.4.4.2.cmml">a</mi><mn id="Thmthm3.p1.3.m3.6.6.4.4.4.3" xref="Thmthm3.p1.3.m3.6.6.4.4.4.3.cmml">1</mn></msub><mo id="Thmthm3.p1.3.m3.9.9.7.7.12" xref="Thmthm3.p1.3.m3.9.9.7.8.cmml">,</mo><mi id="Thmthm3.p1.3.m3.2.2" mathvariant="normal" xref="Thmthm3.p1.3.m3.2.2.cmml">…</mi><mo id="Thmthm3.p1.3.m3.9.9.7.7.13" xref="Thmthm3.p1.3.m3.9.9.7.8.cmml">,</mo><msub id="Thmthm3.p1.3.m3.7.7.5.5.5" xref="Thmthm3.p1.3.m3.7.7.5.5.5.cmml"><mi id="Thmthm3.p1.3.m3.7.7.5.5.5.2" xref="Thmthm3.p1.3.m3.7.7.5.5.5.2.cmml">z</mi><mrow id="Thmthm3.p1.3.m3.7.7.5.5.5.3" xref="Thmthm3.p1.3.m3.7.7.5.5.5.3.cmml"><mi id="Thmthm3.p1.3.m3.7.7.5.5.5.3.2" xref="Thmthm3.p1.3.m3.7.7.5.5.5.3.2.cmml">H</mi><mo id="Thmthm3.p1.3.m3.7.7.5.5.5.3.1" xref="Thmthm3.p1.3.m3.7.7.5.5.5.3.1.cmml">−</mo><mn id="Thmthm3.p1.3.m3.7.7.5.5.5.3.3" xref="Thmthm3.p1.3.m3.7.7.5.5.5.3.3.cmml">1</mn></mrow></msub><mo id="Thmthm3.p1.3.m3.9.9.7.7.14" xref="Thmthm3.p1.3.m3.9.9.7.8.cmml">,</mo><msub id="Thmthm3.p1.3.m3.8.8.6.6.6" xref="Thmthm3.p1.3.m3.8.8.6.6.6.cmml"><mi id="Thmthm3.p1.3.m3.8.8.6.6.6.2" xref="Thmthm3.p1.3.m3.8.8.6.6.6.2.cmml">a</mi><mrow id="Thmthm3.p1.3.m3.8.8.6.6.6.3" xref="Thmthm3.p1.3.m3.8.8.6.6.6.3.cmml"><mi id="Thmthm3.p1.3.m3.8.8.6.6.6.3.2" xref="Thmthm3.p1.3.m3.8.8.6.6.6.3.2.cmml">H</mi><mo id="Thmthm3.p1.3.m3.8.8.6.6.6.3.1" xref="Thmthm3.p1.3.m3.8.8.6.6.6.3.1.cmml">−</mo><mn id="Thmthm3.p1.3.m3.8.8.6.6.6.3.3" xref="Thmthm3.p1.3.m3.8.8.6.6.6.3.3.cmml">1</mn></mrow></msub><mo id="Thmthm3.p1.3.m3.9.9.7.7.15" xref="Thmthm3.p1.3.m3.9.9.7.8.cmml">,</mo><msub id="Thmthm3.p1.3.m3.9.9.7.7.7" xref="Thmthm3.p1.3.m3.9.9.7.7.7.cmml"><mi id="Thmthm3.p1.3.m3.9.9.7.7.7.2" xref="Thmthm3.p1.3.m3.9.9.7.7.7.2.cmml">z</mi><mi id="Thmthm3.p1.3.m3.9.9.7.7.7.3" xref="Thmthm3.p1.3.m3.9.9.7.7.7.3.cmml">H</mi></msub><mo id="Thmthm3.p1.3.m3.9.9.7.7.16" stretchy="false" xref="Thmthm3.p1.3.m3.9.9.7.8.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmthm3.p1.3.m3.9b"><apply id="Thmthm3.p1.3.m3.9.9.cmml" xref="Thmthm3.p1.3.m3.9.9"><eq id="Thmthm3.p1.3.m3.9.9.8.cmml" xref="Thmthm3.p1.3.m3.9.9.8"></eq><apply id="Thmthm3.p1.3.m3.9.9.9.cmml" xref="Thmthm3.p1.3.m3.9.9.9"><times id="Thmthm3.p1.3.m3.9.9.9.1.cmml" xref="Thmthm3.p1.3.m3.9.9.9.1"></times><ci id="Thmthm3.p1.3.m3.9.9.9.2.cmml" xref="Thmthm3.p1.3.m3.9.9.9.2">italic-ϕ</ci><ci id="Thmthm3.p1.3.m3.1.1.cmml" xref="Thmthm3.p1.3.m3.1.1">𝜏</ci></apply><vector id="Thmthm3.p1.3.m3.9.9.7.8.cmml" xref="Thmthm3.p1.3.m3.9.9.7.7"><apply id="Thmthm3.p1.3.m3.3.3.1.1.1.cmml" xref="Thmthm3.p1.3.m3.3.3.1.1.1"><csymbol cd="ambiguous" id="Thmthm3.p1.3.m3.3.3.1.1.1.1.cmml" xref="Thmthm3.p1.3.m3.3.3.1.1.1">subscript</csymbol><ci id="Thmthm3.p1.3.m3.3.3.1.1.1.2.cmml" xref="Thmthm3.p1.3.m3.3.3.1.1.1.2">𝑧</ci><cn id="Thmthm3.p1.3.m3.3.3.1.1.1.3.cmml" type="integer" xref="Thmthm3.p1.3.m3.3.3.1.1.1.3">0</cn></apply><apply id="Thmthm3.p1.3.m3.4.4.2.2.2.cmml" xref="Thmthm3.p1.3.m3.4.4.2.2.2"><csymbol cd="ambiguous" id="Thmthm3.p1.3.m3.4.4.2.2.2.1.cmml" xref="Thmthm3.p1.3.m3.4.4.2.2.2">subscript</csymbol><ci id="Thmthm3.p1.3.m3.4.4.2.2.2.2.cmml" xref="Thmthm3.p1.3.m3.4.4.2.2.2.2">𝑎</ci><cn id="Thmthm3.p1.3.m3.4.4.2.2.2.3.cmml" type="integer" xref="Thmthm3.p1.3.m3.4.4.2.2.2.3">0</cn></apply><apply id="Thmthm3.p1.3.m3.5.5.3.3.3.cmml" xref="Thmthm3.p1.3.m3.5.5.3.3.3"><csymbol cd="ambiguous" id="Thmthm3.p1.3.m3.5.5.3.3.3.1.cmml" xref="Thmthm3.p1.3.m3.5.5.3.3.3">subscript</csymbol><ci id="Thmthm3.p1.3.m3.5.5.3.3.3.2.cmml" xref="Thmthm3.p1.3.m3.5.5.3.3.3.2">𝑧</ci><cn id="Thmthm3.p1.3.m3.5.5.3.3.3.3.cmml" type="integer" xref="Thmthm3.p1.3.m3.5.5.3.3.3.3">1</cn></apply><apply id="Thmthm3.p1.3.m3.6.6.4.4.4.cmml" xref="Thmthm3.p1.3.m3.6.6.4.4.4"><csymbol cd="ambiguous" id="Thmthm3.p1.3.m3.6.6.4.4.4.1.cmml" xref="Thmthm3.p1.3.m3.6.6.4.4.4">subscript</csymbol><ci id="Thmthm3.p1.3.m3.6.6.4.4.4.2.cmml" xref="Thmthm3.p1.3.m3.6.6.4.4.4.2">𝑎</ci><cn id="Thmthm3.p1.3.m3.6.6.4.4.4.3.cmml" type="integer" xref="Thmthm3.p1.3.m3.6.6.4.4.4.3">1</cn></apply><ci id="Thmthm3.p1.3.m3.2.2.cmml" xref="Thmthm3.p1.3.m3.2.2">…</ci><apply id="Thmthm3.p1.3.m3.7.7.5.5.5.cmml" xref="Thmthm3.p1.3.m3.7.7.5.5.5"><csymbol cd="ambiguous" id="Thmthm3.p1.3.m3.7.7.5.5.5.1.cmml" xref="Thmthm3.p1.3.m3.7.7.5.5.5">subscript</csymbol><ci id="Thmthm3.p1.3.m3.7.7.5.5.5.2.cmml" xref="Thmthm3.p1.3.m3.7.7.5.5.5.2">𝑧</ci><apply id="Thmthm3.p1.3.m3.7.7.5.5.5.3.cmml" xref="Thmthm3.p1.3.m3.7.7.5.5.5.3"><minus id="Thmthm3.p1.3.m3.7.7.5.5.5.3.1.cmml" xref="Thmthm3.p1.3.m3.7.7.5.5.5.3.1"></minus><ci id="Thmthm3.p1.3.m3.7.7.5.5.5.3.2.cmml" xref="Thmthm3.p1.3.m3.7.7.5.5.5.3.2">𝐻</ci><cn id="Thmthm3.p1.3.m3.7.7.5.5.5.3.3.cmml" type="integer" xref="Thmthm3.p1.3.m3.7.7.5.5.5.3.3">1</cn></apply></apply><apply id="Thmthm3.p1.3.m3.8.8.6.6.6.cmml" xref="Thmthm3.p1.3.m3.8.8.6.6.6"><csymbol cd="ambiguous" id="Thmthm3.p1.3.m3.8.8.6.6.6.1.cmml" xref="Thmthm3.p1.3.m3.8.8.6.6.6">subscript</csymbol><ci id="Thmthm3.p1.3.m3.8.8.6.6.6.2.cmml" xref="Thmthm3.p1.3.m3.8.8.6.6.6.2">𝑎</ci><apply id="Thmthm3.p1.3.m3.8.8.6.6.6.3.cmml" xref="Thmthm3.p1.3.m3.8.8.6.6.6.3"><minus id="Thmthm3.p1.3.m3.8.8.6.6.6.3.1.cmml" xref="Thmthm3.p1.3.m3.8.8.6.6.6.3.1"></minus><ci id="Thmthm3.p1.3.m3.8.8.6.6.6.3.2.cmml" xref="Thmthm3.p1.3.m3.8.8.6.6.6.3.2">𝐻</ci><cn id="Thmthm3.p1.3.m3.8.8.6.6.6.3.3.cmml" type="integer" xref="Thmthm3.p1.3.m3.8.8.6.6.6.3.3">1</cn></apply></apply><apply id="Thmthm3.p1.3.m3.9.9.7.7.7.cmml" xref="Thmthm3.p1.3.m3.9.9.7.7.7"><csymbol cd="ambiguous" id="Thmthm3.p1.3.m3.9.9.7.7.7.1.cmml" xref="Thmthm3.p1.3.m3.9.9.7.7.7">subscript</csymbol><ci id="Thmthm3.p1.3.m3.9.9.7.7.7.2.cmml" xref="Thmthm3.p1.3.m3.9.9.7.7.7.2">𝑧</ci><ci id="Thmthm3.p1.3.m3.9.9.7.7.7.3.cmml" xref="Thmthm3.p1.3.m3.9.9.7.7.7.3">𝐻</ci></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmthm3.p1.3.m3.9c">\phi(\tau)=(z_{0},a_{0},z_{1},a_{1},\dots,z_{H-1},a_{H-1},z_{H})</annotation><annotation encoding="application/x-llamapun" id="Thmthm3.p1.3.m3.9d">italic_ϕ ( italic_τ ) = ( italic_z start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , italic_a start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , italic_z start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_a start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_z start_POSTSUBSCRIPT italic_H - 1 end_POSTSUBSCRIPT , italic_a start_POSTSUBSCRIPT italic_H - 1 end_POSTSUBSCRIPT , italic_z start_POSTSUBSCRIPT italic_H end_POSTSUBSCRIPT )</annotation></semantics></math>, where <math alttext="a_{k}\sim\pi^{*}(\cdot\mid s_{k})" class="ltx_math_unparsed" display="inline" id="Thmthm3.p1.4.m4.1"><semantics id="Thmthm3.p1.4.m4.1a"><mrow id="Thmthm3.p1.4.m4.1b"><msub id="Thmthm3.p1.4.m4.1.1"><mi id="Thmthm3.p1.4.m4.1.1.2">a</mi><mi id="Thmthm3.p1.4.m4.1.1.3">k</mi></msub><mo id="Thmthm3.p1.4.m4.1.2">∼</mo><msup id="Thmthm3.p1.4.m4.1.3"><mi id="Thmthm3.p1.4.m4.1.3.2">π</mi><mo id="Thmthm3.p1.4.m4.1.3.3">∗</mo></msup><mrow id="Thmthm3.p1.4.m4.1.4"><mo id="Thmthm3.p1.4.m4.1.4.1" stretchy="false">(</mo><mo id="Thmthm3.p1.4.m4.1.4.2" lspace="0em" rspace="0em">⋅</mo><mo id="Thmthm3.p1.4.m4.1.4.3" lspace="0em" rspace="0.167em">∣</mo><msub id="Thmthm3.p1.4.m4.1.4.4"><mi id="Thmthm3.p1.4.m4.1.4.4.2">s</mi><mi id="Thmthm3.p1.4.m4.1.4.4.3">k</mi></msub><mo id="Thmthm3.p1.4.m4.1.4.5" stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="Thmthm3.p1.4.m4.1c">a_{k}\sim\pi^{*}(\cdot\mid s_{k})</annotation><annotation encoding="application/x-llamapun" id="Thmthm3.p1.4.m4.1d">italic_a start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ∼ italic_π start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ( ⋅ ∣ italic_s start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT )</annotation></semantics></math> and <math alttext="z_{k}=\phi(s_{k})" class="ltx_Math" display="inline" id="Thmthm3.p1.5.m5.1"><semantics id="Thmthm3.p1.5.m5.1a"><mrow id="Thmthm3.p1.5.m5.1.1" xref="Thmthm3.p1.5.m5.1.1.cmml"><msub id="Thmthm3.p1.5.m5.1.1.3" xref="Thmthm3.p1.5.m5.1.1.3.cmml"><mi id="Thmthm3.p1.5.m5.1.1.3.2" xref="Thmthm3.p1.5.m5.1.1.3.2.cmml">z</mi><mi id="Thmthm3.p1.5.m5.1.1.3.3" xref="Thmthm3.p1.5.m5.1.1.3.3.cmml">k</mi></msub><mo id="Thmthm3.p1.5.m5.1.1.2" xref="Thmthm3.p1.5.m5.1.1.2.cmml">=</mo><mrow id="Thmthm3.p1.5.m5.1.1.1" xref="Thmthm3.p1.5.m5.1.1.1.cmml"><mi id="Thmthm3.p1.5.m5.1.1.1.3" xref="Thmthm3.p1.5.m5.1.1.1.3.cmml">ϕ</mi><mo id="Thmthm3.p1.5.m5.1.1.1.2" xref="Thmthm3.p1.5.m5.1.1.1.2.cmml">⁢</mo><mrow id="Thmthm3.p1.5.m5.1.1.1.1.1" xref="Thmthm3.p1.5.m5.1.1.1.1.1.1.cmml"><mo id="Thmthm3.p1.5.m5.1.1.1.1.1.2" stretchy="false" xref="Thmthm3.p1.5.m5.1.1.1.1.1.1.cmml">(</mo><msub id="Thmthm3.p1.5.m5.1.1.1.1.1.1" xref="Thmthm3.p1.5.m5.1.1.1.1.1.1.cmml"><mi id="Thmthm3.p1.5.m5.1.1.1.1.1.1.2" xref="Thmthm3.p1.5.m5.1.1.1.1.1.1.2.cmml">s</mi><mi id="Thmthm3.p1.5.m5.1.1.1.1.1.1.3" xref="Thmthm3.p1.5.m5.1.1.1.1.1.1.3.cmml">k</mi></msub><mo id="Thmthm3.p1.5.m5.1.1.1.1.1.3" stretchy="false" xref="Thmthm3.p1.5.m5.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmthm3.p1.5.m5.1b"><apply id="Thmthm3.p1.5.m5.1.1.cmml" xref="Thmthm3.p1.5.m5.1.1"><eq id="Thmthm3.p1.5.m5.1.1.2.cmml" xref="Thmthm3.p1.5.m5.1.1.2"></eq><apply id="Thmthm3.p1.5.m5.1.1.3.cmml" xref="Thmthm3.p1.5.m5.1.1.3"><csymbol cd="ambiguous" id="Thmthm3.p1.5.m5.1.1.3.1.cmml" xref="Thmthm3.p1.5.m5.1.1.3">subscript</csymbol><ci id="Thmthm3.p1.5.m5.1.1.3.2.cmml" xref="Thmthm3.p1.5.m5.1.1.3.2">𝑧</ci><ci id="Thmthm3.p1.5.m5.1.1.3.3.cmml" xref="Thmthm3.p1.5.m5.1.1.3.3">𝑘</ci></apply><apply id="Thmthm3.p1.5.m5.1.1.1.cmml" xref="Thmthm3.p1.5.m5.1.1.1"><times id="Thmthm3.p1.5.m5.1.1.1.2.cmml" xref="Thmthm3.p1.5.m5.1.1.1.2"></times><ci id="Thmthm3.p1.5.m5.1.1.1.3.cmml" xref="Thmthm3.p1.5.m5.1.1.1.3">italic-ϕ</ci><apply id="Thmthm3.p1.5.m5.1.1.1.1.1.1.cmml" xref="Thmthm3.p1.5.m5.1.1.1.1.1"><csymbol cd="ambiguous" id="Thmthm3.p1.5.m5.1.1.1.1.1.1.1.cmml" xref="Thmthm3.p1.5.m5.1.1.1.1.1">subscript</csymbol><ci id="Thmthm3.p1.5.m5.1.1.1.1.1.1.2.cmml" xref="Thmthm3.p1.5.m5.1.1.1.1.1.1.2">𝑠</ci><ci id="Thmthm3.p1.5.m5.1.1.1.1.1.1.3.cmml" xref="Thmthm3.p1.5.m5.1.1.1.1.1.1.3">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmthm3.p1.5.m5.1c">z_{k}=\phi(s_{k})</annotation><annotation encoding="application/x-llamapun" id="Thmthm3.p1.5.m5.1d">italic_z start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT = italic_ϕ ( italic_s start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT )</annotation></semantics></math>, with <math alttext="\phi" class="ltx_Math" display="inline" id="Thmthm3.p1.6.m6.1"><semantics id="Thmthm3.p1.6.m6.1a"><mi id="Thmthm3.p1.6.m6.1.1" xref="Thmthm3.p1.6.m6.1.1.cmml">ϕ</mi><annotation-xml encoding="MathML-Content" id="Thmthm3.p1.6.m6.1b"><ci id="Thmthm3.p1.6.m6.1.1.cmml" xref="Thmthm3.p1.6.m6.1.1">italic-ϕ</ci></annotation-xml><annotation encoding="application/x-tex" id="Thmthm3.p1.6.m6.1c">\phi</annotation><annotation encoding="application/x-llamapun" id="Thmthm3.p1.6.m6.1d">italic_ϕ</annotation></semantics></math> defined as in Theorem <a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#Thmthm2" title="Theorem 2. ‣ 4.2 Theoretical Analysis ‣ 4 Bisimulation metric for model predictive control ‣ Bisimulation metric for Model Predictive Control"><span class="ltx_text ltx_ref_tag">2</span></a>. Under the same assumption as in Theorem <a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#Thmthm1" title="Theorem 1. ‣ 4.2 Theoretical Analysis ‣ 4 Bisimulation metric for model predictive control ‣ Bisimulation metric for Model Predictive Control"><span class="ltx_text ltx_ref_tag">1</span></a> and Theorem <a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#Thmthm2" title="Theorem 2. ‣ 4.2 Theoretical Analysis ‣ 4 Bisimulation metric for model predictive control ‣ Bisimulation metric for Model Predictive Control"><span class="ltx_text ltx_ref_tag">2</span></a>, the following expected cumulative rewards</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A5.EGx1">
<tbody id="S4.Ex1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathbf{S}(\tau)" class="ltx_Math" display="inline" id="S4.Ex1.m1.1"><semantics id="S4.Ex1.m1.1a"><mrow id="S4.Ex1.m1.1.2" xref="S4.Ex1.m1.1.2.cmml"><mi id="S4.Ex1.m1.1.2.2" xref="S4.Ex1.m1.1.2.2.cmml">𝐒</mi><mo id="S4.Ex1.m1.1.2.1" xref="S4.Ex1.m1.1.2.1.cmml">⁢</mo><mrow id="S4.Ex1.m1.1.2.3.2" xref="S4.Ex1.m1.1.2.cmml"><mo id="S4.Ex1.m1.1.2.3.2.1" stretchy="false" xref="S4.Ex1.m1.1.2.cmml">(</mo><mi id="S4.Ex1.m1.1.1" xref="S4.Ex1.m1.1.1.cmml">τ</mi><mo id="S4.Ex1.m1.1.2.3.2.2" stretchy="false" xref="S4.Ex1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.Ex1.m1.1b"><apply id="S4.Ex1.m1.1.2.cmml" xref="S4.Ex1.m1.1.2"><times id="S4.Ex1.m1.1.2.1.cmml" xref="S4.Ex1.m1.1.2.1"></times><ci id="S4.Ex1.m1.1.2.2.cmml" xref="S4.Ex1.m1.1.2.2">𝐒</ci><ci id="S4.Ex1.m1.1.1.cmml" xref="S4.Ex1.m1.1.1">𝜏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Ex1.m1.1c">\displaystyle\mathbf{S}(\tau)</annotation><annotation encoding="application/x-llamapun" id="S4.Ex1.m1.1d">bold_S ( italic_τ )</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\mathbb{E}_{\tau}\left[\gamma^{H}V^{*}(s_{H})+\sum_{h=0}^{H-1}%
\gamma^{h}R(s_{h},a_{h})\right]," class="ltx_Math" display="inline" id="S4.Ex1.m2.1"><semantics id="S4.Ex1.m2.1a"><mrow id="S4.Ex1.m2.1.1.1" xref="S4.Ex1.m2.1.1.1.1.cmml"><mrow id="S4.Ex1.m2.1.1.1.1" xref="S4.Ex1.m2.1.1.1.1.cmml"><mi id="S4.Ex1.m2.1.1.1.1.3" xref="S4.Ex1.m2.1.1.1.1.3.cmml"></mi><mo id="S4.Ex1.m2.1.1.1.1.2" xref="S4.Ex1.m2.1.1.1.1.2.cmml">=</mo><mrow id="S4.Ex1.m2.1.1.1.1.1" xref="S4.Ex1.m2.1.1.1.1.1.cmml"><msub id="S4.Ex1.m2.1.1.1.1.1.3" xref="S4.Ex1.m2.1.1.1.1.1.3.cmml"><mi id="S4.Ex1.m2.1.1.1.1.1.3.2" xref="S4.Ex1.m2.1.1.1.1.1.3.2.cmml">𝔼</mi><mi id="S4.Ex1.m2.1.1.1.1.1.3.3" xref="S4.Ex1.m2.1.1.1.1.1.3.3.cmml">τ</mi></msub><mo id="S4.Ex1.m2.1.1.1.1.1.2" xref="S4.Ex1.m2.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.Ex1.m2.1.1.1.1.1.1.1" xref="S4.Ex1.m2.1.1.1.1.1.1.2.cmml"><mo id="S4.Ex1.m2.1.1.1.1.1.1.1.2" xref="S4.Ex1.m2.1.1.1.1.1.1.2.1.cmml">[</mo><mrow id="S4.Ex1.m2.1.1.1.1.1.1.1.1" xref="S4.Ex1.m2.1.1.1.1.1.1.1.1.cmml"><mrow id="S4.Ex1.m2.1.1.1.1.1.1.1.1.1" xref="S4.Ex1.m2.1.1.1.1.1.1.1.1.1.cmml"><msup id="S4.Ex1.m2.1.1.1.1.1.1.1.1.1.3" xref="S4.Ex1.m2.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.Ex1.m2.1.1.1.1.1.1.1.1.1.3.2" xref="S4.Ex1.m2.1.1.1.1.1.1.1.1.1.3.2.cmml">γ</mi><mi id="S4.Ex1.m2.1.1.1.1.1.1.1.1.1.3.3" xref="S4.Ex1.m2.1.1.1.1.1.1.1.1.1.3.3.cmml">H</mi></msup><mo id="S4.Ex1.m2.1.1.1.1.1.1.1.1.1.2" xref="S4.Ex1.m2.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><msup id="S4.Ex1.m2.1.1.1.1.1.1.1.1.1.4" xref="S4.Ex1.m2.1.1.1.1.1.1.1.1.1.4.cmml"><mi id="S4.Ex1.m2.1.1.1.1.1.1.1.1.1.4.2" xref="S4.Ex1.m2.1.1.1.1.1.1.1.1.1.4.2.cmml">V</mi><mo id="S4.Ex1.m2.1.1.1.1.1.1.1.1.1.4.3" xref="S4.Ex1.m2.1.1.1.1.1.1.1.1.1.4.3.cmml">∗</mo></msup><mo id="S4.Ex1.m2.1.1.1.1.1.1.1.1.1.2a" xref="S4.Ex1.m2.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.Ex1.m2.1.1.1.1.1.1.1.1.1.1.1" xref="S4.Ex1.m2.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.Ex1.m2.1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.Ex1.m2.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S4.Ex1.m2.1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.Ex1.m2.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.Ex1.m2.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.Ex1.m2.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">s</mi><mi id="S4.Ex1.m2.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.Ex1.m2.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">H</mi></msub><mo id="S4.Ex1.m2.1.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.Ex1.m2.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.Ex1.m2.1.1.1.1.1.1.1.1.4" xref="S4.Ex1.m2.1.1.1.1.1.1.1.1.4.cmml">+</mo><mrow id="S4.Ex1.m2.1.1.1.1.1.1.1.1.3" xref="S4.Ex1.m2.1.1.1.1.1.1.1.1.3.cmml"><mstyle displaystyle="true" id="S4.Ex1.m2.1.1.1.1.1.1.1.1.3.3" xref="S4.Ex1.m2.1.1.1.1.1.1.1.1.3.3.cmml"><munderover id="S4.Ex1.m2.1.1.1.1.1.1.1.1.3.3a" xref="S4.Ex1.m2.1.1.1.1.1.1.1.1.3.3.cmml"><mo id="S4.Ex1.m2.1.1.1.1.1.1.1.1.3.3.2.2" movablelimits="false" xref="S4.Ex1.m2.1.1.1.1.1.1.1.1.3.3.2.2.cmml">∑</mo><mrow id="S4.Ex1.m2.1.1.1.1.1.1.1.1.3.3.2.3" xref="S4.Ex1.m2.1.1.1.1.1.1.1.1.3.3.2.3.cmml"><mi id="S4.Ex1.m2.1.1.1.1.1.1.1.1.3.3.2.3.2" xref="S4.Ex1.m2.1.1.1.1.1.1.1.1.3.3.2.3.2.cmml">h</mi><mo id="S4.Ex1.m2.1.1.1.1.1.1.1.1.3.3.2.3.1" xref="S4.Ex1.m2.1.1.1.1.1.1.1.1.3.3.2.3.1.cmml">=</mo><mn id="S4.Ex1.m2.1.1.1.1.1.1.1.1.3.3.2.3.3" xref="S4.Ex1.m2.1.1.1.1.1.1.1.1.3.3.2.3.3.cmml">0</mn></mrow><mrow id="S4.Ex1.m2.1.1.1.1.1.1.1.1.3.3.3" xref="S4.Ex1.m2.1.1.1.1.1.1.1.1.3.3.3.cmml"><mi id="S4.Ex1.m2.1.1.1.1.1.1.1.1.3.3.3.2" xref="S4.Ex1.m2.1.1.1.1.1.1.1.1.3.3.3.2.cmml">H</mi><mo id="S4.Ex1.m2.1.1.1.1.1.1.1.1.3.3.3.1" xref="S4.Ex1.m2.1.1.1.1.1.1.1.1.3.3.3.1.cmml">−</mo><mn id="S4.Ex1.m2.1.1.1.1.1.1.1.1.3.3.3.3" xref="S4.Ex1.m2.1.1.1.1.1.1.1.1.3.3.3.3.cmml">1</mn></mrow></munderover></mstyle><mrow id="S4.Ex1.m2.1.1.1.1.1.1.1.1.3.2" xref="S4.Ex1.m2.1.1.1.1.1.1.1.1.3.2.cmml"><msup id="S4.Ex1.m2.1.1.1.1.1.1.1.1.3.2.4" xref="S4.Ex1.m2.1.1.1.1.1.1.1.1.3.2.4.cmml"><mi id="S4.Ex1.m2.1.1.1.1.1.1.1.1.3.2.4.2" xref="S4.Ex1.m2.1.1.1.1.1.1.1.1.3.2.4.2.cmml">γ</mi><mi id="S4.Ex1.m2.1.1.1.1.1.1.1.1.3.2.4.3" xref="S4.Ex1.m2.1.1.1.1.1.1.1.1.3.2.4.3.cmml">h</mi></msup><mo id="S4.Ex1.m2.1.1.1.1.1.1.1.1.3.2.3" xref="S4.Ex1.m2.1.1.1.1.1.1.1.1.3.2.3.cmml">⁢</mo><mi id="S4.Ex1.m2.1.1.1.1.1.1.1.1.3.2.5" xref="S4.Ex1.m2.1.1.1.1.1.1.1.1.3.2.5.cmml">R</mi><mo id="S4.Ex1.m2.1.1.1.1.1.1.1.1.3.2.3a" xref="S4.Ex1.m2.1.1.1.1.1.1.1.1.3.2.3.cmml">⁢</mo><mrow id="S4.Ex1.m2.1.1.1.1.1.1.1.1.3.2.2.2" xref="S4.Ex1.m2.1.1.1.1.1.1.1.1.3.2.2.3.cmml"><mo id="S4.Ex1.m2.1.1.1.1.1.1.1.1.3.2.2.2.3" stretchy="false" xref="S4.Ex1.m2.1.1.1.1.1.1.1.1.3.2.2.3.cmml">(</mo><msub id="S4.Ex1.m2.1.1.1.1.1.1.1.1.2.1.1.1.1" xref="S4.Ex1.m2.1.1.1.1.1.1.1.1.2.1.1.1.1.cmml"><mi id="S4.Ex1.m2.1.1.1.1.1.1.1.1.2.1.1.1.1.2" xref="S4.Ex1.m2.1.1.1.1.1.1.1.1.2.1.1.1.1.2.cmml">s</mi><mi id="S4.Ex1.m2.1.1.1.1.1.1.1.1.2.1.1.1.1.3" xref="S4.Ex1.m2.1.1.1.1.1.1.1.1.2.1.1.1.1.3.cmml">h</mi></msub><mo id="S4.Ex1.m2.1.1.1.1.1.1.1.1.3.2.2.2.4" xref="S4.Ex1.m2.1.1.1.1.1.1.1.1.3.2.2.3.cmml">,</mo><msub id="S4.Ex1.m2.1.1.1.1.1.1.1.1.3.2.2.2.2" xref="S4.Ex1.m2.1.1.1.1.1.1.1.1.3.2.2.2.2.cmml"><mi id="S4.Ex1.m2.1.1.1.1.1.1.1.1.3.2.2.2.2.2" xref="S4.Ex1.m2.1.1.1.1.1.1.1.1.3.2.2.2.2.2.cmml">a</mi><mi id="S4.Ex1.m2.1.1.1.1.1.1.1.1.3.2.2.2.2.3" xref="S4.Ex1.m2.1.1.1.1.1.1.1.1.3.2.2.2.2.3.cmml">h</mi></msub><mo id="S4.Ex1.m2.1.1.1.1.1.1.1.1.3.2.2.2.5" stretchy="false" xref="S4.Ex1.m2.1.1.1.1.1.1.1.1.3.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S4.Ex1.m2.1.1.1.1.1.1.1.3" xref="S4.Ex1.m2.1.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><mo id="S4.Ex1.m2.1.1.1.2" xref="S4.Ex1.m2.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.Ex1.m2.1b"><apply id="S4.Ex1.m2.1.1.1.1.cmml" xref="S4.Ex1.m2.1.1.1"><eq id="S4.Ex1.m2.1.1.1.1.2.cmml" xref="S4.Ex1.m2.1.1.1.1.2"></eq><csymbol cd="latexml" id="S4.Ex1.m2.1.1.1.1.3.cmml" xref="S4.Ex1.m2.1.1.1.1.3">absent</csymbol><apply id="S4.Ex1.m2.1.1.1.1.1.cmml" xref="S4.Ex1.m2.1.1.1.1.1"><times id="S4.Ex1.m2.1.1.1.1.1.2.cmml" xref="S4.Ex1.m2.1.1.1.1.1.2"></times><apply id="S4.Ex1.m2.1.1.1.1.1.3.cmml" xref="S4.Ex1.m2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.Ex1.m2.1.1.1.1.1.3.1.cmml" xref="S4.Ex1.m2.1.1.1.1.1.3">subscript</csymbol><ci id="S4.Ex1.m2.1.1.1.1.1.3.2.cmml" xref="S4.Ex1.m2.1.1.1.1.1.3.2">𝔼</ci><ci id="S4.Ex1.m2.1.1.1.1.1.3.3.cmml" xref="S4.Ex1.m2.1.1.1.1.1.3.3">𝜏</ci></apply><apply id="S4.Ex1.m2.1.1.1.1.1.1.2.cmml" xref="S4.Ex1.m2.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S4.Ex1.m2.1.1.1.1.1.1.2.1.cmml" xref="S4.Ex1.m2.1.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S4.Ex1.m2.1.1.1.1.1.1.1.1.cmml" xref="S4.Ex1.m2.1.1.1.1.1.1.1.1"><plus id="S4.Ex1.m2.1.1.1.1.1.1.1.1.4.cmml" xref="S4.Ex1.m2.1.1.1.1.1.1.1.1.4"></plus><apply id="S4.Ex1.m2.1.1.1.1.1.1.1.1.1.cmml" xref="S4.Ex1.m2.1.1.1.1.1.1.1.1.1"><times id="S4.Ex1.m2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.Ex1.m2.1.1.1.1.1.1.1.1.1.2"></times><apply id="S4.Ex1.m2.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.Ex1.m2.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.Ex1.m2.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.Ex1.m2.1.1.1.1.1.1.1.1.1.3">superscript</csymbol><ci id="S4.Ex1.m2.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.Ex1.m2.1.1.1.1.1.1.1.1.1.3.2">𝛾</ci><ci id="S4.Ex1.m2.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.Ex1.m2.1.1.1.1.1.1.1.1.1.3.3">𝐻</ci></apply><apply id="S4.Ex1.m2.1.1.1.1.1.1.1.1.1.4.cmml" xref="S4.Ex1.m2.1.1.1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S4.Ex1.m2.1.1.1.1.1.1.1.1.1.4.1.cmml" xref="S4.Ex1.m2.1.1.1.1.1.1.1.1.1.4">superscript</csymbol><ci id="S4.Ex1.m2.1.1.1.1.1.1.1.1.1.4.2.cmml" xref="S4.Ex1.m2.1.1.1.1.1.1.1.1.1.4.2">𝑉</ci><times id="S4.Ex1.m2.1.1.1.1.1.1.1.1.1.4.3.cmml" xref="S4.Ex1.m2.1.1.1.1.1.1.1.1.1.4.3"></times></apply><apply id="S4.Ex1.m2.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.Ex1.m2.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.Ex1.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.Ex1.m2.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.Ex1.m2.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.Ex1.m2.1.1.1.1.1.1.1.1.1.1.1.1.2">𝑠</ci><ci id="S4.Ex1.m2.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.Ex1.m2.1.1.1.1.1.1.1.1.1.1.1.1.3">𝐻</ci></apply></apply><apply id="S4.Ex1.m2.1.1.1.1.1.1.1.1.3.cmml" xref="S4.Ex1.m2.1.1.1.1.1.1.1.1.3"><apply id="S4.Ex1.m2.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.Ex1.m2.1.1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.Ex1.m2.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S4.Ex1.m2.1.1.1.1.1.1.1.1.3.3">superscript</csymbol><apply id="S4.Ex1.m2.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S4.Ex1.m2.1.1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.Ex1.m2.1.1.1.1.1.1.1.1.3.3.2.1.cmml" xref="S4.Ex1.m2.1.1.1.1.1.1.1.1.3.3">subscript</csymbol><sum id="S4.Ex1.m2.1.1.1.1.1.1.1.1.3.3.2.2.cmml" xref="S4.Ex1.m2.1.1.1.1.1.1.1.1.3.3.2.2"></sum><apply id="S4.Ex1.m2.1.1.1.1.1.1.1.1.3.3.2.3.cmml" xref="S4.Ex1.m2.1.1.1.1.1.1.1.1.3.3.2.3"><eq id="S4.Ex1.m2.1.1.1.1.1.1.1.1.3.3.2.3.1.cmml" xref="S4.Ex1.m2.1.1.1.1.1.1.1.1.3.3.2.3.1"></eq><ci id="S4.Ex1.m2.1.1.1.1.1.1.1.1.3.3.2.3.2.cmml" xref="S4.Ex1.m2.1.1.1.1.1.1.1.1.3.3.2.3.2">ℎ</ci><cn id="S4.Ex1.m2.1.1.1.1.1.1.1.1.3.3.2.3.3.cmml" type="integer" xref="S4.Ex1.m2.1.1.1.1.1.1.1.1.3.3.2.3.3">0</cn></apply></apply><apply id="S4.Ex1.m2.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S4.Ex1.m2.1.1.1.1.1.1.1.1.3.3.3"><minus id="S4.Ex1.m2.1.1.1.1.1.1.1.1.3.3.3.1.cmml" xref="S4.Ex1.m2.1.1.1.1.1.1.1.1.3.3.3.1"></minus><ci id="S4.Ex1.m2.1.1.1.1.1.1.1.1.3.3.3.2.cmml" xref="S4.Ex1.m2.1.1.1.1.1.1.1.1.3.3.3.2">𝐻</ci><cn id="S4.Ex1.m2.1.1.1.1.1.1.1.1.3.3.3.3.cmml" type="integer" xref="S4.Ex1.m2.1.1.1.1.1.1.1.1.3.3.3.3">1</cn></apply></apply><apply id="S4.Ex1.m2.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.Ex1.m2.1.1.1.1.1.1.1.1.3.2"><times id="S4.Ex1.m2.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S4.Ex1.m2.1.1.1.1.1.1.1.1.3.2.3"></times><apply id="S4.Ex1.m2.1.1.1.1.1.1.1.1.3.2.4.cmml" xref="S4.Ex1.m2.1.1.1.1.1.1.1.1.3.2.4"><csymbol cd="ambiguous" id="S4.Ex1.m2.1.1.1.1.1.1.1.1.3.2.4.1.cmml" xref="S4.Ex1.m2.1.1.1.1.1.1.1.1.3.2.4">superscript</csymbol><ci id="S4.Ex1.m2.1.1.1.1.1.1.1.1.3.2.4.2.cmml" xref="S4.Ex1.m2.1.1.1.1.1.1.1.1.3.2.4.2">𝛾</ci><ci id="S4.Ex1.m2.1.1.1.1.1.1.1.1.3.2.4.3.cmml" xref="S4.Ex1.m2.1.1.1.1.1.1.1.1.3.2.4.3">ℎ</ci></apply><ci id="S4.Ex1.m2.1.1.1.1.1.1.1.1.3.2.5.cmml" xref="S4.Ex1.m2.1.1.1.1.1.1.1.1.3.2.5">𝑅</ci><interval closure="open" id="S4.Ex1.m2.1.1.1.1.1.1.1.1.3.2.2.3.cmml" xref="S4.Ex1.m2.1.1.1.1.1.1.1.1.3.2.2.2"><apply id="S4.Ex1.m2.1.1.1.1.1.1.1.1.2.1.1.1.1.cmml" xref="S4.Ex1.m2.1.1.1.1.1.1.1.1.2.1.1.1.1"><csymbol cd="ambiguous" id="S4.Ex1.m2.1.1.1.1.1.1.1.1.2.1.1.1.1.1.cmml" xref="S4.Ex1.m2.1.1.1.1.1.1.1.1.2.1.1.1.1">subscript</csymbol><ci id="S4.Ex1.m2.1.1.1.1.1.1.1.1.2.1.1.1.1.2.cmml" xref="S4.Ex1.m2.1.1.1.1.1.1.1.1.2.1.1.1.1.2">𝑠</ci><ci id="S4.Ex1.m2.1.1.1.1.1.1.1.1.2.1.1.1.1.3.cmml" xref="S4.Ex1.m2.1.1.1.1.1.1.1.1.2.1.1.1.1.3">ℎ</ci></apply><apply id="S4.Ex1.m2.1.1.1.1.1.1.1.1.3.2.2.2.2.cmml" xref="S4.Ex1.m2.1.1.1.1.1.1.1.1.3.2.2.2.2"><csymbol cd="ambiguous" id="S4.Ex1.m2.1.1.1.1.1.1.1.1.3.2.2.2.2.1.cmml" xref="S4.Ex1.m2.1.1.1.1.1.1.1.1.3.2.2.2.2">subscript</csymbol><ci id="S4.Ex1.m2.1.1.1.1.1.1.1.1.3.2.2.2.2.2.cmml" xref="S4.Ex1.m2.1.1.1.1.1.1.1.1.3.2.2.2.2.2">𝑎</ci><ci id="S4.Ex1.m2.1.1.1.1.1.1.1.1.3.2.2.2.2.3.cmml" xref="S4.Ex1.m2.1.1.1.1.1.1.1.1.3.2.2.2.2.3">ℎ</ci></apply></interval></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Ex1.m2.1c">\displaystyle=\mathbb{E}_{\tau}\left[\gamma^{H}V^{*}(s_{H})+\sum_{h=0}^{H-1}%
\gamma^{h}R(s_{h},a_{h})\right],</annotation><annotation encoding="application/x-llamapun" id="S4.Ex1.m2.1d">= blackboard_E start_POSTSUBSCRIPT italic_τ end_POSTSUBSCRIPT [ italic_γ start_POSTSUPERSCRIPT italic_H end_POSTSUPERSCRIPT italic_V start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ( italic_s start_POSTSUBSCRIPT italic_H end_POSTSUBSCRIPT ) + ∑ start_POSTSUBSCRIPT italic_h = 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_H - 1 end_POSTSUPERSCRIPT italic_γ start_POSTSUPERSCRIPT italic_h end_POSTSUPERSCRIPT italic_R ( italic_s start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT , italic_a start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT ) ] ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S4.Ex2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathbf{S}(\phi(\tau))" class="ltx_Math" display="inline" id="S4.Ex2.m1.2"><semantics id="S4.Ex2.m1.2a"><mrow id="S4.Ex2.m1.2.2" xref="S4.Ex2.m1.2.2.cmml"><mi id="S4.Ex2.m1.2.2.3" xref="S4.Ex2.m1.2.2.3.cmml">𝐒</mi><mo id="S4.Ex2.m1.2.2.2" xref="S4.Ex2.m1.2.2.2.cmml">⁢</mo><mrow id="S4.Ex2.m1.2.2.1.1" xref="S4.Ex2.m1.2.2.1.1.1.cmml"><mo id="S4.Ex2.m1.2.2.1.1.2" stretchy="false" xref="S4.Ex2.m1.2.2.1.1.1.cmml">(</mo><mrow id="S4.Ex2.m1.2.2.1.1.1" xref="S4.Ex2.m1.2.2.1.1.1.cmml"><mi id="S4.Ex2.m1.2.2.1.1.1.2" xref="S4.Ex2.m1.2.2.1.1.1.2.cmml">ϕ</mi><mo id="S4.Ex2.m1.2.2.1.1.1.1" xref="S4.Ex2.m1.2.2.1.1.1.1.cmml">⁢</mo><mrow id="S4.Ex2.m1.2.2.1.1.1.3.2" xref="S4.Ex2.m1.2.2.1.1.1.cmml"><mo id="S4.Ex2.m1.2.2.1.1.1.3.2.1" stretchy="false" xref="S4.Ex2.m1.2.2.1.1.1.cmml">(</mo><mi id="S4.Ex2.m1.1.1" xref="S4.Ex2.m1.1.1.cmml">τ</mi><mo id="S4.Ex2.m1.2.2.1.1.1.3.2.2" stretchy="false" xref="S4.Ex2.m1.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.Ex2.m1.2.2.1.1.3" stretchy="false" xref="S4.Ex2.m1.2.2.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.Ex2.m1.2b"><apply id="S4.Ex2.m1.2.2.cmml" xref="S4.Ex2.m1.2.2"><times id="S4.Ex2.m1.2.2.2.cmml" xref="S4.Ex2.m1.2.2.2"></times><ci id="S4.Ex2.m1.2.2.3.cmml" xref="S4.Ex2.m1.2.2.3">𝐒</ci><apply id="S4.Ex2.m1.2.2.1.1.1.cmml" xref="S4.Ex2.m1.2.2.1.1"><times id="S4.Ex2.m1.2.2.1.1.1.1.cmml" xref="S4.Ex2.m1.2.2.1.1.1.1"></times><ci id="S4.Ex2.m1.2.2.1.1.1.2.cmml" xref="S4.Ex2.m1.2.2.1.1.1.2">italic-ϕ</ci><ci id="S4.Ex2.m1.1.1.cmml" xref="S4.Ex2.m1.1.1">𝜏</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Ex2.m1.2c">\displaystyle\mathbf{S}(\phi(\tau))</annotation><annotation encoding="application/x-llamapun" id="S4.Ex2.m1.2d">bold_S ( italic_ϕ ( italic_τ ) )</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\mathbb{E}_{\tau}\left[\gamma^{H}V^{*}(\phi(s_{H}))+\sum_{h=0}^{%
H-1}\gamma^{h}R(\phi(s_{h}),a_{h})\right]" class="ltx_Math" display="inline" id="S4.Ex2.m2.1"><semantics id="S4.Ex2.m2.1a"><mrow id="S4.Ex2.m2.1.1" xref="S4.Ex2.m2.1.1.cmml"><mi id="S4.Ex2.m2.1.1.3" xref="S4.Ex2.m2.1.1.3.cmml"></mi><mo id="S4.Ex2.m2.1.1.2" xref="S4.Ex2.m2.1.1.2.cmml">=</mo><mrow id="S4.Ex2.m2.1.1.1" xref="S4.Ex2.m2.1.1.1.cmml"><msub id="S4.Ex2.m2.1.1.1.3" xref="S4.Ex2.m2.1.1.1.3.cmml"><mi id="S4.Ex2.m2.1.1.1.3.2" xref="S4.Ex2.m2.1.1.1.3.2.cmml">𝔼</mi><mi id="S4.Ex2.m2.1.1.1.3.3" xref="S4.Ex2.m2.1.1.1.3.3.cmml">τ</mi></msub><mo id="S4.Ex2.m2.1.1.1.2" xref="S4.Ex2.m2.1.1.1.2.cmml">⁢</mo><mrow id="S4.Ex2.m2.1.1.1.1.1" xref="S4.Ex2.m2.1.1.1.1.2.cmml"><mo id="S4.Ex2.m2.1.1.1.1.1.2" xref="S4.Ex2.m2.1.1.1.1.2.1.cmml">[</mo><mrow id="S4.Ex2.m2.1.1.1.1.1.1" xref="S4.Ex2.m2.1.1.1.1.1.1.cmml"><mrow id="S4.Ex2.m2.1.1.1.1.1.1.1" xref="S4.Ex2.m2.1.1.1.1.1.1.1.cmml"><msup id="S4.Ex2.m2.1.1.1.1.1.1.1.3" xref="S4.Ex2.m2.1.1.1.1.1.1.1.3.cmml"><mi id="S4.Ex2.m2.1.1.1.1.1.1.1.3.2" xref="S4.Ex2.m2.1.1.1.1.1.1.1.3.2.cmml">γ</mi><mi id="S4.Ex2.m2.1.1.1.1.1.1.1.3.3" xref="S4.Ex2.m2.1.1.1.1.1.1.1.3.3.cmml">H</mi></msup><mo id="S4.Ex2.m2.1.1.1.1.1.1.1.2" xref="S4.Ex2.m2.1.1.1.1.1.1.1.2.cmml">⁢</mo><msup id="S4.Ex2.m2.1.1.1.1.1.1.1.4" xref="S4.Ex2.m2.1.1.1.1.1.1.1.4.cmml"><mi id="S4.Ex2.m2.1.1.1.1.1.1.1.4.2" xref="S4.Ex2.m2.1.1.1.1.1.1.1.4.2.cmml">V</mi><mo id="S4.Ex2.m2.1.1.1.1.1.1.1.4.3" xref="S4.Ex2.m2.1.1.1.1.1.1.1.4.3.cmml">∗</mo></msup><mo id="S4.Ex2.m2.1.1.1.1.1.1.1.2a" xref="S4.Ex2.m2.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.Ex2.m2.1.1.1.1.1.1.1.1.1" xref="S4.Ex2.m2.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.Ex2.m2.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.Ex2.m2.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.Ex2.m2.1.1.1.1.1.1.1.1.1.1" xref="S4.Ex2.m2.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.Ex2.m2.1.1.1.1.1.1.1.1.1.1.3" xref="S4.Ex2.m2.1.1.1.1.1.1.1.1.1.1.3.cmml">ϕ</mi><mo id="S4.Ex2.m2.1.1.1.1.1.1.1.1.1.1.2" xref="S4.Ex2.m2.1.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.Ex2.m2.1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.Ex2.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.Ex2.m2.1.1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.Ex2.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S4.Ex2.m2.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.Ex2.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.Ex2.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.Ex2.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">s</mi><mi id="S4.Ex2.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.Ex2.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">H</mi></msub><mo id="S4.Ex2.m2.1.1.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.Ex2.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.Ex2.m2.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.Ex2.m2.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.Ex2.m2.1.1.1.1.1.1.4" xref="S4.Ex2.m2.1.1.1.1.1.1.4.cmml">+</mo><mrow id="S4.Ex2.m2.1.1.1.1.1.1.3" xref="S4.Ex2.m2.1.1.1.1.1.1.3.cmml"><mstyle displaystyle="true" id="S4.Ex2.m2.1.1.1.1.1.1.3.3" xref="S4.Ex2.m2.1.1.1.1.1.1.3.3.cmml"><munderover id="S4.Ex2.m2.1.1.1.1.1.1.3.3a" xref="S4.Ex2.m2.1.1.1.1.1.1.3.3.cmml"><mo id="S4.Ex2.m2.1.1.1.1.1.1.3.3.2.2" movablelimits="false" xref="S4.Ex2.m2.1.1.1.1.1.1.3.3.2.2.cmml">∑</mo><mrow id="S4.Ex2.m2.1.1.1.1.1.1.3.3.2.3" xref="S4.Ex2.m2.1.1.1.1.1.1.3.3.2.3.cmml"><mi id="S4.Ex2.m2.1.1.1.1.1.1.3.3.2.3.2" xref="S4.Ex2.m2.1.1.1.1.1.1.3.3.2.3.2.cmml">h</mi><mo id="S4.Ex2.m2.1.1.1.1.1.1.3.3.2.3.1" xref="S4.Ex2.m2.1.1.1.1.1.1.3.3.2.3.1.cmml">=</mo><mn id="S4.Ex2.m2.1.1.1.1.1.1.3.3.2.3.3" xref="S4.Ex2.m2.1.1.1.1.1.1.3.3.2.3.3.cmml">0</mn></mrow><mrow id="S4.Ex2.m2.1.1.1.1.1.1.3.3.3" xref="S4.Ex2.m2.1.1.1.1.1.1.3.3.3.cmml"><mi id="S4.Ex2.m2.1.1.1.1.1.1.3.3.3.2" xref="S4.Ex2.m2.1.1.1.1.1.1.3.3.3.2.cmml">H</mi><mo id="S4.Ex2.m2.1.1.1.1.1.1.3.3.3.1" xref="S4.Ex2.m2.1.1.1.1.1.1.3.3.3.1.cmml">−</mo><mn id="S4.Ex2.m2.1.1.1.1.1.1.3.3.3.3" xref="S4.Ex2.m2.1.1.1.1.1.1.3.3.3.3.cmml">1</mn></mrow></munderover></mstyle><mrow id="S4.Ex2.m2.1.1.1.1.1.1.3.2" xref="S4.Ex2.m2.1.1.1.1.1.1.3.2.cmml"><msup id="S4.Ex2.m2.1.1.1.1.1.1.3.2.4" xref="S4.Ex2.m2.1.1.1.1.1.1.3.2.4.cmml"><mi id="S4.Ex2.m2.1.1.1.1.1.1.3.2.4.2" xref="S4.Ex2.m2.1.1.1.1.1.1.3.2.4.2.cmml">γ</mi><mi id="S4.Ex2.m2.1.1.1.1.1.1.3.2.4.3" xref="S4.Ex2.m2.1.1.1.1.1.1.3.2.4.3.cmml">h</mi></msup><mo id="S4.Ex2.m2.1.1.1.1.1.1.3.2.3" xref="S4.Ex2.m2.1.1.1.1.1.1.3.2.3.cmml">⁢</mo><mi id="S4.Ex2.m2.1.1.1.1.1.1.3.2.5" xref="S4.Ex2.m2.1.1.1.1.1.1.3.2.5.cmml">R</mi><mo id="S4.Ex2.m2.1.1.1.1.1.1.3.2.3a" xref="S4.Ex2.m2.1.1.1.1.1.1.3.2.3.cmml">⁢</mo><mrow id="S4.Ex2.m2.1.1.1.1.1.1.3.2.2.2" xref="S4.Ex2.m2.1.1.1.1.1.1.3.2.2.3.cmml"><mo id="S4.Ex2.m2.1.1.1.1.1.1.3.2.2.2.3" stretchy="false" xref="S4.Ex2.m2.1.1.1.1.1.1.3.2.2.3.cmml">(</mo><mrow id="S4.Ex2.m2.1.1.1.1.1.1.2.1.1.1.1" xref="S4.Ex2.m2.1.1.1.1.1.1.2.1.1.1.1.cmml"><mi id="S4.Ex2.m2.1.1.1.1.1.1.2.1.1.1.1.3" xref="S4.Ex2.m2.1.1.1.1.1.1.2.1.1.1.1.3.cmml">ϕ</mi><mo id="S4.Ex2.m2.1.1.1.1.1.1.2.1.1.1.1.2" xref="S4.Ex2.m2.1.1.1.1.1.1.2.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.Ex2.m2.1.1.1.1.1.1.2.1.1.1.1.1.1" xref="S4.Ex2.m2.1.1.1.1.1.1.2.1.1.1.1.1.1.1.cmml"><mo id="S4.Ex2.m2.1.1.1.1.1.1.2.1.1.1.1.1.1.2" stretchy="false" xref="S4.Ex2.m2.1.1.1.1.1.1.2.1.1.1.1.1.1.1.cmml">(</mo><msub id="S4.Ex2.m2.1.1.1.1.1.1.2.1.1.1.1.1.1.1" xref="S4.Ex2.m2.1.1.1.1.1.1.2.1.1.1.1.1.1.1.cmml"><mi id="S4.Ex2.m2.1.1.1.1.1.1.2.1.1.1.1.1.1.1.2" xref="S4.Ex2.m2.1.1.1.1.1.1.2.1.1.1.1.1.1.1.2.cmml">s</mi><mi id="S4.Ex2.m2.1.1.1.1.1.1.2.1.1.1.1.1.1.1.3" xref="S4.Ex2.m2.1.1.1.1.1.1.2.1.1.1.1.1.1.1.3.cmml">h</mi></msub><mo id="S4.Ex2.m2.1.1.1.1.1.1.2.1.1.1.1.1.1.3" stretchy="false" xref="S4.Ex2.m2.1.1.1.1.1.1.2.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.Ex2.m2.1.1.1.1.1.1.3.2.2.2.4" xref="S4.Ex2.m2.1.1.1.1.1.1.3.2.2.3.cmml">,</mo><msub id="S4.Ex2.m2.1.1.1.1.1.1.3.2.2.2.2" xref="S4.Ex2.m2.1.1.1.1.1.1.3.2.2.2.2.cmml"><mi id="S4.Ex2.m2.1.1.1.1.1.1.3.2.2.2.2.2" xref="S4.Ex2.m2.1.1.1.1.1.1.3.2.2.2.2.2.cmml">a</mi><mi id="S4.Ex2.m2.1.1.1.1.1.1.3.2.2.2.2.3" xref="S4.Ex2.m2.1.1.1.1.1.1.3.2.2.2.2.3.cmml">h</mi></msub><mo id="S4.Ex2.m2.1.1.1.1.1.1.3.2.2.2.5" stretchy="false" xref="S4.Ex2.m2.1.1.1.1.1.1.3.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S4.Ex2.m2.1.1.1.1.1.3" xref="S4.Ex2.m2.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.Ex2.m2.1b"><apply id="S4.Ex2.m2.1.1.cmml" xref="S4.Ex2.m2.1.1"><eq id="S4.Ex2.m2.1.1.2.cmml" xref="S4.Ex2.m2.1.1.2"></eq><csymbol cd="latexml" id="S4.Ex2.m2.1.1.3.cmml" xref="S4.Ex2.m2.1.1.3">absent</csymbol><apply id="S4.Ex2.m2.1.1.1.cmml" xref="S4.Ex2.m2.1.1.1"><times id="S4.Ex2.m2.1.1.1.2.cmml" xref="S4.Ex2.m2.1.1.1.2"></times><apply id="S4.Ex2.m2.1.1.1.3.cmml" xref="S4.Ex2.m2.1.1.1.3"><csymbol cd="ambiguous" id="S4.Ex2.m2.1.1.1.3.1.cmml" xref="S4.Ex2.m2.1.1.1.3">subscript</csymbol><ci id="S4.Ex2.m2.1.1.1.3.2.cmml" xref="S4.Ex2.m2.1.1.1.3.2">𝔼</ci><ci id="S4.Ex2.m2.1.1.1.3.3.cmml" xref="S4.Ex2.m2.1.1.1.3.3">𝜏</ci></apply><apply id="S4.Ex2.m2.1.1.1.1.2.cmml" xref="S4.Ex2.m2.1.1.1.1.1"><csymbol cd="latexml" id="S4.Ex2.m2.1.1.1.1.2.1.cmml" xref="S4.Ex2.m2.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S4.Ex2.m2.1.1.1.1.1.1.cmml" xref="S4.Ex2.m2.1.1.1.1.1.1"><plus id="S4.Ex2.m2.1.1.1.1.1.1.4.cmml" xref="S4.Ex2.m2.1.1.1.1.1.1.4"></plus><apply id="S4.Ex2.m2.1.1.1.1.1.1.1.cmml" xref="S4.Ex2.m2.1.1.1.1.1.1.1"><times id="S4.Ex2.m2.1.1.1.1.1.1.1.2.cmml" xref="S4.Ex2.m2.1.1.1.1.1.1.1.2"></times><apply id="S4.Ex2.m2.1.1.1.1.1.1.1.3.cmml" xref="S4.Ex2.m2.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.Ex2.m2.1.1.1.1.1.1.1.3.1.cmml" xref="S4.Ex2.m2.1.1.1.1.1.1.1.3">superscript</csymbol><ci id="S4.Ex2.m2.1.1.1.1.1.1.1.3.2.cmml" xref="S4.Ex2.m2.1.1.1.1.1.1.1.3.2">𝛾</ci><ci id="S4.Ex2.m2.1.1.1.1.1.1.1.3.3.cmml" xref="S4.Ex2.m2.1.1.1.1.1.1.1.3.3">𝐻</ci></apply><apply id="S4.Ex2.m2.1.1.1.1.1.1.1.4.cmml" xref="S4.Ex2.m2.1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S4.Ex2.m2.1.1.1.1.1.1.1.4.1.cmml" xref="S4.Ex2.m2.1.1.1.1.1.1.1.4">superscript</csymbol><ci id="S4.Ex2.m2.1.1.1.1.1.1.1.4.2.cmml" xref="S4.Ex2.m2.1.1.1.1.1.1.1.4.2">𝑉</ci><times id="S4.Ex2.m2.1.1.1.1.1.1.1.4.3.cmml" xref="S4.Ex2.m2.1.1.1.1.1.1.1.4.3"></times></apply><apply id="S4.Ex2.m2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.Ex2.m2.1.1.1.1.1.1.1.1.1"><times id="S4.Ex2.m2.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.Ex2.m2.1.1.1.1.1.1.1.1.1.1.2"></times><ci id="S4.Ex2.m2.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.Ex2.m2.1.1.1.1.1.1.1.1.1.1.3">italic-ϕ</ci><apply id="S4.Ex2.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.Ex2.m2.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.Ex2.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.Ex2.m2.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.Ex2.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.Ex2.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.2">𝑠</ci><ci id="S4.Ex2.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.Ex2.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝐻</ci></apply></apply></apply><apply id="S4.Ex2.m2.1.1.1.1.1.1.3.cmml" xref="S4.Ex2.m2.1.1.1.1.1.1.3"><apply id="S4.Ex2.m2.1.1.1.1.1.1.3.3.cmml" xref="S4.Ex2.m2.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.Ex2.m2.1.1.1.1.1.1.3.3.1.cmml" xref="S4.Ex2.m2.1.1.1.1.1.1.3.3">superscript</csymbol><apply id="S4.Ex2.m2.1.1.1.1.1.1.3.3.2.cmml" xref="S4.Ex2.m2.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.Ex2.m2.1.1.1.1.1.1.3.3.2.1.cmml" xref="S4.Ex2.m2.1.1.1.1.1.1.3.3">subscript</csymbol><sum id="S4.Ex2.m2.1.1.1.1.1.1.3.3.2.2.cmml" xref="S4.Ex2.m2.1.1.1.1.1.1.3.3.2.2"></sum><apply id="S4.Ex2.m2.1.1.1.1.1.1.3.3.2.3.cmml" xref="S4.Ex2.m2.1.1.1.1.1.1.3.3.2.3"><eq id="S4.Ex2.m2.1.1.1.1.1.1.3.3.2.3.1.cmml" xref="S4.Ex2.m2.1.1.1.1.1.1.3.3.2.3.1"></eq><ci id="S4.Ex2.m2.1.1.1.1.1.1.3.3.2.3.2.cmml" xref="S4.Ex2.m2.1.1.1.1.1.1.3.3.2.3.2">ℎ</ci><cn id="S4.Ex2.m2.1.1.1.1.1.1.3.3.2.3.3.cmml" type="integer" xref="S4.Ex2.m2.1.1.1.1.1.1.3.3.2.3.3">0</cn></apply></apply><apply id="S4.Ex2.m2.1.1.1.1.1.1.3.3.3.cmml" xref="S4.Ex2.m2.1.1.1.1.1.1.3.3.3"><minus id="S4.Ex2.m2.1.1.1.1.1.1.3.3.3.1.cmml" xref="S4.Ex2.m2.1.1.1.1.1.1.3.3.3.1"></minus><ci id="S4.Ex2.m2.1.1.1.1.1.1.3.3.3.2.cmml" xref="S4.Ex2.m2.1.1.1.1.1.1.3.3.3.2">𝐻</ci><cn id="S4.Ex2.m2.1.1.1.1.1.1.3.3.3.3.cmml" type="integer" xref="S4.Ex2.m2.1.1.1.1.1.1.3.3.3.3">1</cn></apply></apply><apply id="S4.Ex2.m2.1.1.1.1.1.1.3.2.cmml" xref="S4.Ex2.m2.1.1.1.1.1.1.3.2"><times id="S4.Ex2.m2.1.1.1.1.1.1.3.2.3.cmml" xref="S4.Ex2.m2.1.1.1.1.1.1.3.2.3"></times><apply id="S4.Ex2.m2.1.1.1.1.1.1.3.2.4.cmml" xref="S4.Ex2.m2.1.1.1.1.1.1.3.2.4"><csymbol cd="ambiguous" id="S4.Ex2.m2.1.1.1.1.1.1.3.2.4.1.cmml" xref="S4.Ex2.m2.1.1.1.1.1.1.3.2.4">superscript</csymbol><ci id="S4.Ex2.m2.1.1.1.1.1.1.3.2.4.2.cmml" xref="S4.Ex2.m2.1.1.1.1.1.1.3.2.4.2">𝛾</ci><ci id="S4.Ex2.m2.1.1.1.1.1.1.3.2.4.3.cmml" xref="S4.Ex2.m2.1.1.1.1.1.1.3.2.4.3">ℎ</ci></apply><ci id="S4.Ex2.m2.1.1.1.1.1.1.3.2.5.cmml" xref="S4.Ex2.m2.1.1.1.1.1.1.3.2.5">𝑅</ci><interval closure="open" id="S4.Ex2.m2.1.1.1.1.1.1.3.2.2.3.cmml" xref="S4.Ex2.m2.1.1.1.1.1.1.3.2.2.2"><apply id="S4.Ex2.m2.1.1.1.1.1.1.2.1.1.1.1.cmml" xref="S4.Ex2.m2.1.1.1.1.1.1.2.1.1.1.1"><times id="S4.Ex2.m2.1.1.1.1.1.1.2.1.1.1.1.2.cmml" xref="S4.Ex2.m2.1.1.1.1.1.1.2.1.1.1.1.2"></times><ci id="S4.Ex2.m2.1.1.1.1.1.1.2.1.1.1.1.3.cmml" xref="S4.Ex2.m2.1.1.1.1.1.1.2.1.1.1.1.3">italic-ϕ</ci><apply id="S4.Ex2.m2.1.1.1.1.1.1.2.1.1.1.1.1.1.1.cmml" xref="S4.Ex2.m2.1.1.1.1.1.1.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.Ex2.m2.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.cmml" xref="S4.Ex2.m2.1.1.1.1.1.1.2.1.1.1.1.1.1">subscript</csymbol><ci id="S4.Ex2.m2.1.1.1.1.1.1.2.1.1.1.1.1.1.1.2.cmml" xref="S4.Ex2.m2.1.1.1.1.1.1.2.1.1.1.1.1.1.1.2">𝑠</ci><ci id="S4.Ex2.m2.1.1.1.1.1.1.2.1.1.1.1.1.1.1.3.cmml" xref="S4.Ex2.m2.1.1.1.1.1.1.2.1.1.1.1.1.1.1.3">ℎ</ci></apply></apply><apply id="S4.Ex2.m2.1.1.1.1.1.1.3.2.2.2.2.cmml" xref="S4.Ex2.m2.1.1.1.1.1.1.3.2.2.2.2"><csymbol cd="ambiguous" id="S4.Ex2.m2.1.1.1.1.1.1.3.2.2.2.2.1.cmml" xref="S4.Ex2.m2.1.1.1.1.1.1.3.2.2.2.2">subscript</csymbol><ci id="S4.Ex2.m2.1.1.1.1.1.1.3.2.2.2.2.2.cmml" xref="S4.Ex2.m2.1.1.1.1.1.1.3.2.2.2.2.2">𝑎</ci><ci id="S4.Ex2.m2.1.1.1.1.1.1.3.2.2.2.2.3.cmml" xref="S4.Ex2.m2.1.1.1.1.1.1.3.2.2.2.2.3">ℎ</ci></apply></interval></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Ex2.m2.1c">\displaystyle=\mathbb{E}_{\tau}\left[\gamma^{H}V^{*}(\phi(s_{H}))+\sum_{h=0}^{%
H-1}\gamma^{h}R(\phi(s_{h}),a_{h})\right]</annotation><annotation encoding="application/x-llamapun" id="S4.Ex2.m2.1d">= blackboard_E start_POSTSUBSCRIPT italic_τ end_POSTSUBSCRIPT [ italic_γ start_POSTSUPERSCRIPT italic_H end_POSTSUPERSCRIPT italic_V start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ( italic_ϕ ( italic_s start_POSTSUBSCRIPT italic_H end_POSTSUBSCRIPT ) ) + ∑ start_POSTSUBSCRIPT italic_h = 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_H - 1 end_POSTSUPERSCRIPT italic_γ start_POSTSUPERSCRIPT italic_h end_POSTSUPERSCRIPT italic_R ( italic_ϕ ( italic_s start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT ) , italic_a start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT ) ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="Thmthm3.p1.7">can be bounded as follows:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E13">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\left|\mathbf{S}(\tau)-\mathbf{S}(\phi(\tau))\right|\leq\frac{2\gamma^{H}(%
\epsilon+\mathcal{L})}{(1-\gamma)(1-c)}+\frac{2\epsilon(1-\gamma^{H})}{(1-%
\gamma)(1-c)}." class="ltx_Math" display="block" id="S4.E13.m1.9"><semantics id="S4.E13.m1.9a"><mrow id="S4.E13.m1.9.9.1" xref="S4.E13.m1.9.9.1.1.cmml"><mrow id="S4.E13.m1.9.9.1.1" xref="S4.E13.m1.9.9.1.1.cmml"><mrow id="S4.E13.m1.9.9.1.1.1.1" xref="S4.E13.m1.9.9.1.1.1.2.cmml"><mo id="S4.E13.m1.9.9.1.1.1.1.2" xref="S4.E13.m1.9.9.1.1.1.2.1.cmml">|</mo><mrow id="S4.E13.m1.9.9.1.1.1.1.1" xref="S4.E13.m1.9.9.1.1.1.1.1.cmml"><mrow id="S4.E13.m1.9.9.1.1.1.1.1.3" xref="S4.E13.m1.9.9.1.1.1.1.1.3.cmml"><mi id="S4.E13.m1.9.9.1.1.1.1.1.3.2" xref="S4.E13.m1.9.9.1.1.1.1.1.3.2.cmml">𝐒</mi><mo id="S4.E13.m1.9.9.1.1.1.1.1.3.1" xref="S4.E13.m1.9.9.1.1.1.1.1.3.1.cmml">⁢</mo><mrow id="S4.E13.m1.9.9.1.1.1.1.1.3.3.2" xref="S4.E13.m1.9.9.1.1.1.1.1.3.cmml"><mo id="S4.E13.m1.9.9.1.1.1.1.1.3.3.2.1" stretchy="false" xref="S4.E13.m1.9.9.1.1.1.1.1.3.cmml">(</mo><mi id="S4.E13.m1.7.7" xref="S4.E13.m1.7.7.cmml">τ</mi><mo id="S4.E13.m1.9.9.1.1.1.1.1.3.3.2.2" stretchy="false" xref="S4.E13.m1.9.9.1.1.1.1.1.3.cmml">)</mo></mrow></mrow><mo id="S4.E13.m1.9.9.1.1.1.1.1.2" xref="S4.E13.m1.9.9.1.1.1.1.1.2.cmml">−</mo><mrow id="S4.E13.m1.9.9.1.1.1.1.1.1" xref="S4.E13.m1.9.9.1.1.1.1.1.1.cmml"><mi id="S4.E13.m1.9.9.1.1.1.1.1.1.3" xref="S4.E13.m1.9.9.1.1.1.1.1.1.3.cmml">𝐒</mi><mo id="S4.E13.m1.9.9.1.1.1.1.1.1.2" xref="S4.E13.m1.9.9.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E13.m1.9.9.1.1.1.1.1.1.1.1" xref="S4.E13.m1.9.9.1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.E13.m1.9.9.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.E13.m1.9.9.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E13.m1.9.9.1.1.1.1.1.1.1.1.1" xref="S4.E13.m1.9.9.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E13.m1.9.9.1.1.1.1.1.1.1.1.1.2" xref="S4.E13.m1.9.9.1.1.1.1.1.1.1.1.1.2.cmml">ϕ</mi><mo id="S4.E13.m1.9.9.1.1.1.1.1.1.1.1.1.1" xref="S4.E13.m1.9.9.1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S4.E13.m1.9.9.1.1.1.1.1.1.1.1.1.3.2" xref="S4.E13.m1.9.9.1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.E13.m1.9.9.1.1.1.1.1.1.1.1.1.3.2.1" stretchy="false" xref="S4.E13.m1.9.9.1.1.1.1.1.1.1.1.1.cmml">(</mo><mi id="S4.E13.m1.8.8" xref="S4.E13.m1.8.8.cmml">τ</mi><mo id="S4.E13.m1.9.9.1.1.1.1.1.1.1.1.1.3.2.2" stretchy="false" xref="S4.E13.m1.9.9.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E13.m1.9.9.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.E13.m1.9.9.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E13.m1.9.9.1.1.1.1.3" xref="S4.E13.m1.9.9.1.1.1.2.1.cmml">|</mo></mrow><mo id="S4.E13.m1.9.9.1.1.2" xref="S4.E13.m1.9.9.1.1.2.cmml">≤</mo><mrow id="S4.E13.m1.9.9.1.1.3" xref="S4.E13.m1.9.9.1.1.3.cmml"><mfrac id="S4.E13.m1.3.3" xref="S4.E13.m1.3.3.cmml"><mrow id="S4.E13.m1.1.1.1" xref="S4.E13.m1.1.1.1.cmml"><mn id="S4.E13.m1.1.1.1.3" xref="S4.E13.m1.1.1.1.3.cmml">2</mn><mo id="S4.E13.m1.1.1.1.2" xref="S4.E13.m1.1.1.1.2.cmml">⁢</mo><msup id="S4.E13.m1.1.1.1.4" xref="S4.E13.m1.1.1.1.4.cmml"><mi id="S4.E13.m1.1.1.1.4.2" xref="S4.E13.m1.1.1.1.4.2.cmml">γ</mi><mi id="S4.E13.m1.1.1.1.4.3" xref="S4.E13.m1.1.1.1.4.3.cmml">H</mi></msup><mo id="S4.E13.m1.1.1.1.2a" xref="S4.E13.m1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E13.m1.1.1.1.1.1" xref="S4.E13.m1.1.1.1.1.1.1.cmml"><mo id="S4.E13.m1.1.1.1.1.1.2" stretchy="false" xref="S4.E13.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E13.m1.1.1.1.1.1.1" xref="S4.E13.m1.1.1.1.1.1.1.cmml"><mi id="S4.E13.m1.1.1.1.1.1.1.2" xref="S4.E13.m1.1.1.1.1.1.1.2.cmml">ϵ</mi><mo id="S4.E13.m1.1.1.1.1.1.1.1" xref="S4.E13.m1.1.1.1.1.1.1.1.cmml">+</mo><mi class="ltx_font_mathcaligraphic" id="S4.E13.m1.1.1.1.1.1.1.3" xref="S4.E13.m1.1.1.1.1.1.1.3.cmml">ℒ</mi></mrow><mo id="S4.E13.m1.1.1.1.1.1.3" stretchy="false" xref="S4.E13.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="S4.E13.m1.3.3.3" xref="S4.E13.m1.3.3.3.cmml"><mrow id="S4.E13.m1.2.2.2.1.1" xref="S4.E13.m1.2.2.2.1.1.1.cmml"><mo id="S4.E13.m1.2.2.2.1.1.2" stretchy="false" xref="S4.E13.m1.2.2.2.1.1.1.cmml">(</mo><mrow id="S4.E13.m1.2.2.2.1.1.1" xref="S4.E13.m1.2.2.2.1.1.1.cmml"><mn id="S4.E13.m1.2.2.2.1.1.1.2" xref="S4.E13.m1.2.2.2.1.1.1.2.cmml">1</mn><mo id="S4.E13.m1.2.2.2.1.1.1.1" xref="S4.E13.m1.2.2.2.1.1.1.1.cmml">−</mo><mi id="S4.E13.m1.2.2.2.1.1.1.3" xref="S4.E13.m1.2.2.2.1.1.1.3.cmml">γ</mi></mrow><mo id="S4.E13.m1.2.2.2.1.1.3" stretchy="false" xref="S4.E13.m1.2.2.2.1.1.1.cmml">)</mo></mrow><mo id="S4.E13.m1.3.3.3.3" xref="S4.E13.m1.3.3.3.3.cmml">⁢</mo><mrow id="S4.E13.m1.3.3.3.2.1" xref="S4.E13.m1.3.3.3.2.1.1.cmml"><mo id="S4.E13.m1.3.3.3.2.1.2" stretchy="false" xref="S4.E13.m1.3.3.3.2.1.1.cmml">(</mo><mrow id="S4.E13.m1.3.3.3.2.1.1" xref="S4.E13.m1.3.3.3.2.1.1.cmml"><mn id="S4.E13.m1.3.3.3.2.1.1.2" xref="S4.E13.m1.3.3.3.2.1.1.2.cmml">1</mn><mo id="S4.E13.m1.3.3.3.2.1.1.1" xref="S4.E13.m1.3.3.3.2.1.1.1.cmml">−</mo><mi id="S4.E13.m1.3.3.3.2.1.1.3" xref="S4.E13.m1.3.3.3.2.1.1.3.cmml">c</mi></mrow><mo id="S4.E13.m1.3.3.3.2.1.3" stretchy="false" xref="S4.E13.m1.3.3.3.2.1.1.cmml">)</mo></mrow></mrow></mfrac><mo id="S4.E13.m1.9.9.1.1.3.1" xref="S4.E13.m1.9.9.1.1.3.1.cmml">+</mo><mfrac id="S4.E13.m1.6.6" xref="S4.E13.m1.6.6.cmml"><mrow id="S4.E13.m1.4.4.1" xref="S4.E13.m1.4.4.1.cmml"><mn id="S4.E13.m1.4.4.1.3" xref="S4.E13.m1.4.4.1.3.cmml">2</mn><mo id="S4.E13.m1.4.4.1.2" xref="S4.E13.m1.4.4.1.2.cmml">⁢</mo><mi id="S4.E13.m1.4.4.1.4" xref="S4.E13.m1.4.4.1.4.cmml">ϵ</mi><mo id="S4.E13.m1.4.4.1.2a" xref="S4.E13.m1.4.4.1.2.cmml">⁢</mo><mrow id="S4.E13.m1.4.4.1.1.1" xref="S4.E13.m1.4.4.1.1.1.1.cmml"><mo id="S4.E13.m1.4.4.1.1.1.2" stretchy="false" xref="S4.E13.m1.4.4.1.1.1.1.cmml">(</mo><mrow id="S4.E13.m1.4.4.1.1.1.1" xref="S4.E13.m1.4.4.1.1.1.1.cmml"><mn id="S4.E13.m1.4.4.1.1.1.1.2" xref="S4.E13.m1.4.4.1.1.1.1.2.cmml">1</mn><mo id="S4.E13.m1.4.4.1.1.1.1.1" xref="S4.E13.m1.4.4.1.1.1.1.1.cmml">−</mo><msup id="S4.E13.m1.4.4.1.1.1.1.3" xref="S4.E13.m1.4.4.1.1.1.1.3.cmml"><mi id="S4.E13.m1.4.4.1.1.1.1.3.2" xref="S4.E13.m1.4.4.1.1.1.1.3.2.cmml">γ</mi><mi id="S4.E13.m1.4.4.1.1.1.1.3.3" xref="S4.E13.m1.4.4.1.1.1.1.3.3.cmml">H</mi></msup></mrow><mo id="S4.E13.m1.4.4.1.1.1.3" stretchy="false" xref="S4.E13.m1.4.4.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="S4.E13.m1.6.6.3" xref="S4.E13.m1.6.6.3.cmml"><mrow id="S4.E13.m1.5.5.2.1.1" xref="S4.E13.m1.5.5.2.1.1.1.cmml"><mo id="S4.E13.m1.5.5.2.1.1.2" stretchy="false" xref="S4.E13.m1.5.5.2.1.1.1.cmml">(</mo><mrow id="S4.E13.m1.5.5.2.1.1.1" xref="S4.E13.m1.5.5.2.1.1.1.cmml"><mn id="S4.E13.m1.5.5.2.1.1.1.2" xref="S4.E13.m1.5.5.2.1.1.1.2.cmml">1</mn><mo id="S4.E13.m1.5.5.2.1.1.1.1" xref="S4.E13.m1.5.5.2.1.1.1.1.cmml">−</mo><mi id="S4.E13.m1.5.5.2.1.1.1.3" xref="S4.E13.m1.5.5.2.1.1.1.3.cmml">γ</mi></mrow><mo id="S4.E13.m1.5.5.2.1.1.3" stretchy="false" xref="S4.E13.m1.5.5.2.1.1.1.cmml">)</mo></mrow><mo id="S4.E13.m1.6.6.3.3" xref="S4.E13.m1.6.6.3.3.cmml">⁢</mo><mrow id="S4.E13.m1.6.6.3.2.1" xref="S4.E13.m1.6.6.3.2.1.1.cmml"><mo id="S4.E13.m1.6.6.3.2.1.2" stretchy="false" xref="S4.E13.m1.6.6.3.2.1.1.cmml">(</mo><mrow id="S4.E13.m1.6.6.3.2.1.1" xref="S4.E13.m1.6.6.3.2.1.1.cmml"><mn id="S4.E13.m1.6.6.3.2.1.1.2" xref="S4.E13.m1.6.6.3.2.1.1.2.cmml">1</mn><mo id="S4.E13.m1.6.6.3.2.1.1.1" xref="S4.E13.m1.6.6.3.2.1.1.1.cmml">−</mo><mi id="S4.E13.m1.6.6.3.2.1.1.3" xref="S4.E13.m1.6.6.3.2.1.1.3.cmml">c</mi></mrow><mo id="S4.E13.m1.6.6.3.2.1.3" stretchy="false" xref="S4.E13.m1.6.6.3.2.1.1.cmml">)</mo></mrow></mrow></mfrac></mrow></mrow><mo id="S4.E13.m1.9.9.1.2" lspace="0em" xref="S4.E13.m1.9.9.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E13.m1.9b"><apply id="S4.E13.m1.9.9.1.1.cmml" xref="S4.E13.m1.9.9.1"><leq id="S4.E13.m1.9.9.1.1.2.cmml" xref="S4.E13.m1.9.9.1.1.2"></leq><apply id="S4.E13.m1.9.9.1.1.1.2.cmml" xref="S4.E13.m1.9.9.1.1.1.1"><abs id="S4.E13.m1.9.9.1.1.1.2.1.cmml" xref="S4.E13.m1.9.9.1.1.1.1.2"></abs><apply id="S4.E13.m1.9.9.1.1.1.1.1.cmml" xref="S4.E13.m1.9.9.1.1.1.1.1"><minus id="S4.E13.m1.9.9.1.1.1.1.1.2.cmml" xref="S4.E13.m1.9.9.1.1.1.1.1.2"></minus><apply id="S4.E13.m1.9.9.1.1.1.1.1.3.cmml" xref="S4.E13.m1.9.9.1.1.1.1.1.3"><times id="S4.E13.m1.9.9.1.1.1.1.1.3.1.cmml" xref="S4.E13.m1.9.9.1.1.1.1.1.3.1"></times><ci id="S4.E13.m1.9.9.1.1.1.1.1.3.2.cmml" xref="S4.E13.m1.9.9.1.1.1.1.1.3.2">𝐒</ci><ci id="S4.E13.m1.7.7.cmml" xref="S4.E13.m1.7.7">𝜏</ci></apply><apply id="S4.E13.m1.9.9.1.1.1.1.1.1.cmml" xref="S4.E13.m1.9.9.1.1.1.1.1.1"><times id="S4.E13.m1.9.9.1.1.1.1.1.1.2.cmml" xref="S4.E13.m1.9.9.1.1.1.1.1.1.2"></times><ci id="S4.E13.m1.9.9.1.1.1.1.1.1.3.cmml" xref="S4.E13.m1.9.9.1.1.1.1.1.1.3">𝐒</ci><apply id="S4.E13.m1.9.9.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E13.m1.9.9.1.1.1.1.1.1.1.1"><times id="S4.E13.m1.9.9.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E13.m1.9.9.1.1.1.1.1.1.1.1.1.1"></times><ci id="S4.E13.m1.9.9.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E13.m1.9.9.1.1.1.1.1.1.1.1.1.2">italic-ϕ</ci><ci id="S4.E13.m1.8.8.cmml" xref="S4.E13.m1.8.8">𝜏</ci></apply></apply></apply></apply><apply id="S4.E13.m1.9.9.1.1.3.cmml" xref="S4.E13.m1.9.9.1.1.3"><plus id="S4.E13.m1.9.9.1.1.3.1.cmml" xref="S4.E13.m1.9.9.1.1.3.1"></plus><apply id="S4.E13.m1.3.3.cmml" xref="S4.E13.m1.3.3"><divide id="S4.E13.m1.3.3.4.cmml" xref="S4.E13.m1.3.3"></divide><apply id="S4.E13.m1.1.1.1.cmml" xref="S4.E13.m1.1.1.1"><times id="S4.E13.m1.1.1.1.2.cmml" xref="S4.E13.m1.1.1.1.2"></times><cn id="S4.E13.m1.1.1.1.3.cmml" type="integer" xref="S4.E13.m1.1.1.1.3">2</cn><apply id="S4.E13.m1.1.1.1.4.cmml" xref="S4.E13.m1.1.1.1.4"><csymbol cd="ambiguous" id="S4.E13.m1.1.1.1.4.1.cmml" xref="S4.E13.m1.1.1.1.4">superscript</csymbol><ci id="S4.E13.m1.1.1.1.4.2.cmml" xref="S4.E13.m1.1.1.1.4.2">𝛾</ci><ci id="S4.E13.m1.1.1.1.4.3.cmml" xref="S4.E13.m1.1.1.1.4.3">𝐻</ci></apply><apply id="S4.E13.m1.1.1.1.1.1.1.cmml" xref="S4.E13.m1.1.1.1.1.1"><plus id="S4.E13.m1.1.1.1.1.1.1.1.cmml" xref="S4.E13.m1.1.1.1.1.1.1.1"></plus><ci id="S4.E13.m1.1.1.1.1.1.1.2.cmml" xref="S4.E13.m1.1.1.1.1.1.1.2">italic-ϵ</ci><ci id="S4.E13.m1.1.1.1.1.1.1.3.cmml" xref="S4.E13.m1.1.1.1.1.1.1.3">ℒ</ci></apply></apply><apply id="S4.E13.m1.3.3.3.cmml" xref="S4.E13.m1.3.3.3"><times id="S4.E13.m1.3.3.3.3.cmml" xref="S4.E13.m1.3.3.3.3"></times><apply id="S4.E13.m1.2.2.2.1.1.1.cmml" xref="S4.E13.m1.2.2.2.1.1"><minus id="S4.E13.m1.2.2.2.1.1.1.1.cmml" xref="S4.E13.m1.2.2.2.1.1.1.1"></minus><cn id="S4.E13.m1.2.2.2.1.1.1.2.cmml" type="integer" xref="S4.E13.m1.2.2.2.1.1.1.2">1</cn><ci id="S4.E13.m1.2.2.2.1.1.1.3.cmml" xref="S4.E13.m1.2.2.2.1.1.1.3">𝛾</ci></apply><apply id="S4.E13.m1.3.3.3.2.1.1.cmml" xref="S4.E13.m1.3.3.3.2.1"><minus id="S4.E13.m1.3.3.3.2.1.1.1.cmml" xref="S4.E13.m1.3.3.3.2.1.1.1"></minus><cn id="S4.E13.m1.3.3.3.2.1.1.2.cmml" type="integer" xref="S4.E13.m1.3.3.3.2.1.1.2">1</cn><ci id="S4.E13.m1.3.3.3.2.1.1.3.cmml" xref="S4.E13.m1.3.3.3.2.1.1.3">𝑐</ci></apply></apply></apply><apply id="S4.E13.m1.6.6.cmml" xref="S4.E13.m1.6.6"><divide id="S4.E13.m1.6.6.4.cmml" xref="S4.E13.m1.6.6"></divide><apply id="S4.E13.m1.4.4.1.cmml" xref="S4.E13.m1.4.4.1"><times id="S4.E13.m1.4.4.1.2.cmml" xref="S4.E13.m1.4.4.1.2"></times><cn id="S4.E13.m1.4.4.1.3.cmml" type="integer" xref="S4.E13.m1.4.4.1.3">2</cn><ci id="S4.E13.m1.4.4.1.4.cmml" xref="S4.E13.m1.4.4.1.4">italic-ϵ</ci><apply id="S4.E13.m1.4.4.1.1.1.1.cmml" xref="S4.E13.m1.4.4.1.1.1"><minus id="S4.E13.m1.4.4.1.1.1.1.1.cmml" xref="S4.E13.m1.4.4.1.1.1.1.1"></minus><cn id="S4.E13.m1.4.4.1.1.1.1.2.cmml" type="integer" xref="S4.E13.m1.4.4.1.1.1.1.2">1</cn><apply id="S4.E13.m1.4.4.1.1.1.1.3.cmml" xref="S4.E13.m1.4.4.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E13.m1.4.4.1.1.1.1.3.1.cmml" xref="S4.E13.m1.4.4.1.1.1.1.3">superscript</csymbol><ci id="S4.E13.m1.4.4.1.1.1.1.3.2.cmml" xref="S4.E13.m1.4.4.1.1.1.1.3.2">𝛾</ci><ci id="S4.E13.m1.4.4.1.1.1.1.3.3.cmml" xref="S4.E13.m1.4.4.1.1.1.1.3.3">𝐻</ci></apply></apply></apply><apply id="S4.E13.m1.6.6.3.cmml" xref="S4.E13.m1.6.6.3"><times id="S4.E13.m1.6.6.3.3.cmml" xref="S4.E13.m1.6.6.3.3"></times><apply id="S4.E13.m1.5.5.2.1.1.1.cmml" xref="S4.E13.m1.5.5.2.1.1"><minus id="S4.E13.m1.5.5.2.1.1.1.1.cmml" xref="S4.E13.m1.5.5.2.1.1.1.1"></minus><cn id="S4.E13.m1.5.5.2.1.1.1.2.cmml" type="integer" xref="S4.E13.m1.5.5.2.1.1.1.2">1</cn><ci id="S4.E13.m1.5.5.2.1.1.1.3.cmml" xref="S4.E13.m1.5.5.2.1.1.1.3">𝛾</ci></apply><apply id="S4.E13.m1.6.6.3.2.1.1.cmml" xref="S4.E13.m1.6.6.3.2.1"><minus id="S4.E13.m1.6.6.3.2.1.1.1.cmml" xref="S4.E13.m1.6.6.3.2.1.1.1"></minus><cn id="S4.E13.m1.6.6.3.2.1.1.2.cmml" type="integer" xref="S4.E13.m1.6.6.3.2.1.1.2">1</cn><ci id="S4.E13.m1.6.6.3.2.1.1.3.cmml" xref="S4.E13.m1.6.6.3.2.1.1.3">𝑐</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E13.m1.9c">\left|\mathbf{S}(\tau)-\mathbf{S}(\phi(\tau))\right|\leq\frac{2\gamma^{H}(%
\epsilon+\mathcal{L})}{(1-\gamma)(1-c)}+\frac{2\epsilon(1-\gamma^{H})}{(1-%
\gamma)(1-c)}.</annotation><annotation encoding="application/x-llamapun" id="S4.E13.m1.9d">| bold_S ( italic_τ ) - bold_S ( italic_ϕ ( italic_τ ) ) | ≤ divide start_ARG 2 italic_γ start_POSTSUPERSCRIPT italic_H end_POSTSUPERSCRIPT ( italic_ϵ + caligraphic_L ) end_ARG start_ARG ( 1 - italic_γ ) ( 1 - italic_c ) end_ARG + divide start_ARG 2 italic_ϵ ( 1 - italic_γ start_POSTSUPERSCRIPT italic_H end_POSTSUPERSCRIPT ) end_ARG start_ARG ( 1 - italic_γ ) ( 1 - italic_c ) end_ARG .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(13)</span></td>
</tr></tbody>
</table>
</div>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS2.p5">
<p class="ltx_p" id="S4.SS2.p5.4">Proof can be found in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#A1" title="Appendix A Proof of Theorem 3 ‣ Bisimulation metric for Model Predictive Control"><span class="ltx_text ltx_ref_tag">A</span></a>. This theorem states that if the cluster radius <math alttext="\epsilon" class="ltx_Math" display="inline" id="S4.SS2.p5.1.m1.1"><semantics id="S4.SS2.p5.1.m1.1a"><mi id="S4.SS2.p5.1.m1.1.1" xref="S4.SS2.p5.1.m1.1.1.cmml">ϵ</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p5.1.m1.1b"><ci id="S4.SS2.p5.1.m1.1.1.cmml" xref="S4.SS2.p5.1.m1.1.1">italic-ϵ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p5.1.m1.1c">\epsilon</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p5.1.m1.1d">italic_ϵ</annotation></semantics></math> and the encoder error <math alttext="\mathcal{L}" class="ltx_Math" display="inline" id="S4.SS2.p5.2.m2.1"><semantics id="S4.SS2.p5.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p5.2.m2.1.1" xref="S4.SS2.p5.2.m2.1.1.cmml">ℒ</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p5.2.m2.1b"><ci id="S4.SS2.p5.2.m2.1.1.cmml" xref="S4.SS2.p5.2.m2.1.1">ℒ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p5.2.m2.1c">\mathcal{L}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p5.2.m2.1d">caligraphic_L</annotation></semantics></math> are sufficiently small, the learned representation space <math alttext="\mathcal{Z}" class="ltx_Math" display="inline" id="S4.SS2.p5.3.m3.1"><semantics id="S4.SS2.p5.3.m3.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p5.3.m3.1.1" xref="S4.SS2.p5.3.m3.1.1.cmml">𝒵</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p5.3.m3.1b"><ci id="S4.SS2.p5.3.m3.1.1.cmml" xref="S4.SS2.p5.3.m3.1.1">𝒵</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p5.3.m3.1c">\mathcal{Z}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p5.3.m3.1d">caligraphic_Z</annotation></semantics></math> does not change the original cumulative rewards over the same trajectory <math alttext="\tau" class="ltx_Math" display="inline" id="S4.SS2.p5.4.m4.1"><semantics id="S4.SS2.p5.4.m4.1a"><mi id="S4.SS2.p5.4.m4.1.1" xref="S4.SS2.p5.4.m4.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p5.4.m4.1b"><ci id="S4.SS2.p5.4.m4.1.1.cmml" xref="S4.SS2.p5.4.m4.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p5.4.m4.1c">\tau</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p5.4.m4.1d">italic_τ</annotation></semantics></math>. This suggests that the latent space retains essential information from the original space.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Difference between BS-MPC and TD-MPC</h3>
<div class="ltx_para ltx_noindent" id="S4.SS3.p1">
<p class="ltx_p" id="S4.SS3.p1.2">The main difference between BS-MPC and TD-MPC lies in its objective function and computation flow. Specifically, BS-MPC updates the encoder parameter by minimizing MSE loss between on-policy bisimulation metric and <math alttext="\ell_{1}" class="ltx_Math" display="inline" id="S4.SS3.p1.1.m1.1"><semantics id="S4.SS3.p1.1.m1.1a"><msub id="S4.SS3.p1.1.m1.1.1" xref="S4.SS3.p1.1.m1.1.1.cmml"><mi id="S4.SS3.p1.1.m1.1.1.2" mathvariant="normal" xref="S4.SS3.p1.1.m1.1.1.2.cmml">ℓ</mi><mn id="S4.SS3.p1.1.m1.1.1.3" xref="S4.SS3.p1.1.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.1.m1.1b"><apply id="S4.SS3.p1.1.m1.1.1.cmml" xref="S4.SS3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.1.m1.1.1.1.cmml" xref="S4.SS3.p1.1.m1.1.1">subscript</csymbol><ci id="S4.SS3.p1.1.m1.1.1.2.cmml" xref="S4.SS3.p1.1.m1.1.1.2">ℓ</ci><cn id="S4.SS3.p1.1.m1.1.1.3.cmml" type="integer" xref="S4.SS3.p1.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.1.m1.1c">\ell_{1}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.1.m1.1d">roman_ℓ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math>-distance in the latent space at every time step <math alttext="k" class="ltx_Math" display="inline" id="S4.SS3.p1.2.m2.1"><semantics id="S4.SS3.p1.2.m2.1a"><mi id="S4.SS3.p1.2.m2.1.1" xref="S4.SS3.p1.2.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.2.m2.1b"><ci id="S4.SS3.p1.2.m2.1.1.cmml" xref="S4.SS3.p1.2.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.2.m2.1c">k</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.2.m2.1d">italic_k</annotation></semantics></math>, which is shown in Eq. <a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#S4.E7" title="In Objective function ‣ 4.1 Bisimulation Metric for Model Predictive Control ‣ 4 Bisimulation metric for model predictive control ‣ Bisimulation metric for Model Predictive Control"><span class="ltx_text ltx_ref_tag">7</span></a>. These differences result in the following improvements.</p>
</div>
<section class="ltx_paragraph" id="S4.SS3.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">Improved training stability</h4>
<div class="ltx_para ltx_noindent" id="S4.SS3.SSS0.Px1.p1">
<p class="ltx_p" id="S4.SS3.SSS0.Px1.p1.2">In TD-MPC, the encoder is only updated indirectly through gradients propagated from the latent dynamics loss, as the objective function lacks explicit encoder loss term and only consists of the first three terms in Eq. <a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#S4.E8" title="In Objective function ‣ 4.1 Bisimulation Metric for Model Predictive Control ‣ 4 Bisimulation metric for model predictive control ‣ Bisimulation metric for Model Predictive Control"><span class="ltx_text ltx_ref_tag">8</span></a>. This indirect update makes it challenging to effectively optimize the encoder parameters at each training step, potentially leading to significant inconsistencies in the latent dynamics and destabilizing the learning process. Such model inconsistencies have also been reported in <cite class="ltx_cite ltx_citemacro_citet">Zhao et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#bib.bib48" title="">2023</a>)</cite>.
In contrast, BS-MPC has an explicit encoder loss in its objective function thanks to the inclusion of bisimulation metric loss. This allows the gradients of the encoder parameters to be directly computed from the objective function, ensuring continuous improvement of the encoder. As a result, the learned encoder effectively maps the original state <math alttext="s" class="ltx_Math" display="inline" id="S4.SS3.SSS0.Px1.p1.1.m1.1"><semantics id="S4.SS3.SSS0.Px1.p1.1.m1.1a"><mi id="S4.SS3.SSS0.Px1.p1.1.m1.1.1" xref="S4.SS3.SSS0.Px1.p1.1.m1.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px1.p1.1.m1.1b"><ci id="S4.SS3.SSS0.Px1.p1.1.m1.1.1.cmml" xref="S4.SS3.SSS0.Px1.p1.1.m1.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px1.p1.1.m1.1c">s</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS0.Px1.p1.1.m1.1d">italic_s</annotation></semantics></math> to the latent space <math alttext="z" class="ltx_Math" display="inline" id="S4.SS3.SSS0.Px1.p1.2.m2.1"><semantics id="S4.SS3.SSS0.Px1.p1.2.m2.1a"><mi id="S4.SS3.SSS0.Px1.p1.2.m2.1.1" xref="S4.SS3.SSS0.Px1.p1.2.m2.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px1.p1.2.m2.1b"><ci id="S4.SS3.SSS0.Px1.p1.2.m2.1.1.cmml" xref="S4.SS3.SSS0.Px1.p1.2.m2.1.1">𝑧</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px1.p1.2.m2.1c">z</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS0.Px1.p1.2.m2.1d">italic_z</annotation></semantics></math>, leading to reduced model discrepancies. The encoder update difference is shown in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#S4.F2" title="Figure 2 ‣ Ease of parallelization ‣ 4.3 Difference between BS-MPC and TD-MPC ‣ 4 Bisimulation metric for model predictive control ‣ Bisimulation metric for Model Predictive Control"><span class="ltx_text ltx_ref_tag">2</span></a> and Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#S4.F2" title="Figure 2 ‣ Ease of parallelization ‣ 4.3 Difference between BS-MPC and TD-MPC ‣ 4 Bisimulation metric for model predictive control ‣ Bisimulation metric for Model Predictive Control"><span class="ltx_text ltx_ref_tag">2</span></a>.</p>
</div>
</section>
<section class="ltx_paragraph" id="S4.SS3.SSS0.Px2">
<h4 class="ltx_title ltx_title_paragraph">Theoretical support of the latent space</h4>
<div class="ltx_para ltx_noindent" id="S4.SS3.SSS0.Px2.p1">
<p class="ltx_p" id="S4.SS3.SSS0.Px2.p1.4">The encoder in BS-MPC generates a latent representation <math alttext="\mathcal{Z}" class="ltx_Math" display="inline" id="S4.SS3.SSS0.Px2.p1.1.m1.1"><semantics id="S4.SS3.SSS0.Px2.p1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS3.SSS0.Px2.p1.1.m1.1.1" xref="S4.SS3.SSS0.Px2.p1.1.m1.1.1.cmml">𝒵</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px2.p1.1.m1.1b"><ci id="S4.SS3.SSS0.Px2.p1.1.m1.1.1.cmml" xref="S4.SS3.SSS0.Px2.p1.1.m1.1.1">𝒵</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px2.p1.1.m1.1c">\mathcal{Z}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS0.Px2.p1.1.m1.1d">caligraphic_Z</annotation></semantics></math> where the <math alttext="\ell_{1}" class="ltx_Math" display="inline" id="S4.SS3.SSS0.Px2.p1.2.m2.1"><semantics id="S4.SS3.SSS0.Px2.p1.2.m2.1a"><msub id="S4.SS3.SSS0.Px2.p1.2.m2.1.1" xref="S4.SS3.SSS0.Px2.p1.2.m2.1.1.cmml"><mi id="S4.SS3.SSS0.Px2.p1.2.m2.1.1.2" mathvariant="normal" xref="S4.SS3.SSS0.Px2.p1.2.m2.1.1.2.cmml">ℓ</mi><mn id="S4.SS3.SSS0.Px2.p1.2.m2.1.1.3" xref="S4.SS3.SSS0.Px2.p1.2.m2.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px2.p1.2.m2.1b"><apply id="S4.SS3.SSS0.Px2.p1.2.m2.1.1.cmml" xref="S4.SS3.SSS0.Px2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS0.Px2.p1.2.m2.1.1.1.cmml" xref="S4.SS3.SSS0.Px2.p1.2.m2.1.1">subscript</csymbol><ci id="S4.SS3.SSS0.Px2.p1.2.m2.1.1.2.cmml" xref="S4.SS3.SSS0.Px2.p1.2.m2.1.1.2">ℓ</ci><cn id="S4.SS3.SSS0.Px2.p1.2.m2.1.1.3.cmml" type="integer" xref="S4.SS3.SSS0.Px2.p1.2.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px2.p1.2.m2.1c">\ell_{1}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS0.Px2.p1.2.m2.1d">roman_ℓ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math>-distance corresponds to the bisimulation metric. This indicates that the encoder efficiently filters out irrelevant information from the original state <math alttext="s" class="ltx_Math" display="inline" id="S4.SS3.SSS0.Px2.p1.3.m3.1"><semantics id="S4.SS3.SSS0.Px2.p1.3.m3.1a"><mi id="S4.SS3.SSS0.Px2.p1.3.m3.1.1" xref="S4.SS3.SSS0.Px2.p1.3.m3.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px2.p1.3.m3.1b"><ci id="S4.SS3.SSS0.Px2.p1.3.m3.1.1.cmml" xref="S4.SS3.SSS0.Px2.p1.3.m3.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px2.p1.3.m3.1c">s</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS0.Px2.p1.3.m3.1d">italic_s</annotation></semantics></math> and preserves intrinsic details in the latent state <math alttext="z" class="ltx_Math" display="inline" id="S4.SS3.SSS0.Px2.p1.4.m4.1"><semantics id="S4.SS3.SSS0.Px2.p1.4.m4.1a"><mi id="S4.SS3.SSS0.Px2.p1.4.m4.1.1" xref="S4.SS3.SSS0.Px2.p1.4.m4.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px2.p1.4.m4.1b"><ci id="S4.SS3.SSS0.Px2.p1.4.m4.1.1.cmml" xref="S4.SS3.SSS0.Px2.p1.4.m4.1.1">𝑧</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px2.p1.4.m4.1c">z</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS0.Px2.p1.4.m4.1d">italic_z</annotation></semantics></math>. Consequently, BS-MPC exhibits robust resilience to noise. Additionally, this property guarantees that the cumulative reward difference between the learned representation space and the original space over a trajectory is upper-bounded, as discussed in Section <a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#S4.SS2" title="4.2 Theoretical Analysis ‣ 4 Bisimulation metric for model predictive control ‣ Bisimulation metric for Model Predictive Control"><span class="ltx_text ltx_ref_tag">4.2</span></a>. In contrast, the encoder in TD-MPC lacks theoretical guarantees in its learned representation space, potentially leading to the projection of irrelevant details into the latent space. This absence of theoretical validity in the encoder contributes to increased sensitivity to noise, as shown in our experimental results (Section. <a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#S5.SS3" title="5.3 Resutls on Image input with distractions ‣ 5 Experiments ‣ Bisimulation metric for Model Predictive Control"><span class="ltx_text ltx_ref_tag">5.3</span></a>).</p>
</div>
</section>
<section class="ltx_paragraph" id="S4.SS3.SSS0.Px3">
<h4 class="ltx_title ltx_title_paragraph">Ease of parallelization</h4>
<div class="ltx_para ltx_noindent" id="S4.SS3.SSS0.Px3.p1">
<p class="ltx_p" id="S4.SS3.SSS0.Px3.p1.4">TD-MPC predicts the latent state <math alttext="\hat{z}_{k+1}" class="ltx_Math" display="inline" id="S4.SS3.SSS0.Px3.p1.1.m1.1"><semantics id="S4.SS3.SSS0.Px3.p1.1.m1.1a"><msub id="S4.SS3.SSS0.Px3.p1.1.m1.1.1" xref="S4.SS3.SSS0.Px3.p1.1.m1.1.1.cmml"><mover accent="true" id="S4.SS3.SSS0.Px3.p1.1.m1.1.1.2" xref="S4.SS3.SSS0.Px3.p1.1.m1.1.1.2.cmml"><mi id="S4.SS3.SSS0.Px3.p1.1.m1.1.1.2.2" xref="S4.SS3.SSS0.Px3.p1.1.m1.1.1.2.2.cmml">z</mi><mo id="S4.SS3.SSS0.Px3.p1.1.m1.1.1.2.1" xref="S4.SS3.SSS0.Px3.p1.1.m1.1.1.2.1.cmml">^</mo></mover><mrow id="S4.SS3.SSS0.Px3.p1.1.m1.1.1.3" xref="S4.SS3.SSS0.Px3.p1.1.m1.1.1.3.cmml"><mi id="S4.SS3.SSS0.Px3.p1.1.m1.1.1.3.2" xref="S4.SS3.SSS0.Px3.p1.1.m1.1.1.3.2.cmml">k</mi><mo id="S4.SS3.SSS0.Px3.p1.1.m1.1.1.3.1" xref="S4.SS3.SSS0.Px3.p1.1.m1.1.1.3.1.cmml">+</mo><mn id="S4.SS3.SSS0.Px3.p1.1.m1.1.1.3.3" xref="S4.SS3.SSS0.Px3.p1.1.m1.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px3.p1.1.m1.1b"><apply id="S4.SS3.SSS0.Px3.p1.1.m1.1.1.cmml" xref="S4.SS3.SSS0.Px3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS0.Px3.p1.1.m1.1.1.1.cmml" xref="S4.SS3.SSS0.Px3.p1.1.m1.1.1">subscript</csymbol><apply id="S4.SS3.SSS0.Px3.p1.1.m1.1.1.2.cmml" xref="S4.SS3.SSS0.Px3.p1.1.m1.1.1.2"><ci id="S4.SS3.SSS0.Px3.p1.1.m1.1.1.2.1.cmml" xref="S4.SS3.SSS0.Px3.p1.1.m1.1.1.2.1">^</ci><ci id="S4.SS3.SSS0.Px3.p1.1.m1.1.1.2.2.cmml" xref="S4.SS3.SSS0.Px3.p1.1.m1.1.1.2.2">𝑧</ci></apply><apply id="S4.SS3.SSS0.Px3.p1.1.m1.1.1.3.cmml" xref="S4.SS3.SSS0.Px3.p1.1.m1.1.1.3"><plus id="S4.SS3.SSS0.Px3.p1.1.m1.1.1.3.1.cmml" xref="S4.SS3.SSS0.Px3.p1.1.m1.1.1.3.1"></plus><ci id="S4.SS3.SSS0.Px3.p1.1.m1.1.1.3.2.cmml" xref="S4.SS3.SSS0.Px3.p1.1.m1.1.1.3.2">𝑘</ci><cn id="S4.SS3.SSS0.Px3.p1.1.m1.1.1.3.3.cmml" type="integer" xref="S4.SS3.SSS0.Px3.p1.1.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px3.p1.1.m1.1c">\hat{z}_{k+1}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS0.Px3.p1.1.m1.1d">over^ start_ARG italic_z end_ARG start_POSTSUBSCRIPT italic_k + 1 end_POSTSUBSCRIPT</annotation></semantics></math> by applying the dynamics model to the previous predicted latent state <math alttext="\hat{z}_{k}" class="ltx_Math" display="inline" id="S4.SS3.SSS0.Px3.p1.2.m2.1"><semantics id="S4.SS3.SSS0.Px3.p1.2.m2.1a"><msub id="S4.SS3.SSS0.Px3.p1.2.m2.1.1" xref="S4.SS3.SSS0.Px3.p1.2.m2.1.1.cmml"><mover accent="true" id="S4.SS3.SSS0.Px3.p1.2.m2.1.1.2" xref="S4.SS3.SSS0.Px3.p1.2.m2.1.1.2.cmml"><mi id="S4.SS3.SSS0.Px3.p1.2.m2.1.1.2.2" xref="S4.SS3.SSS0.Px3.p1.2.m2.1.1.2.2.cmml">z</mi><mo id="S4.SS3.SSS0.Px3.p1.2.m2.1.1.2.1" xref="S4.SS3.SSS0.Px3.p1.2.m2.1.1.2.1.cmml">^</mo></mover><mi id="S4.SS3.SSS0.Px3.p1.2.m2.1.1.3" xref="S4.SS3.SSS0.Px3.p1.2.m2.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px3.p1.2.m2.1b"><apply id="S4.SS3.SSS0.Px3.p1.2.m2.1.1.cmml" xref="S4.SS3.SSS0.Px3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS0.Px3.p1.2.m2.1.1.1.cmml" xref="S4.SS3.SSS0.Px3.p1.2.m2.1.1">subscript</csymbol><apply id="S4.SS3.SSS0.Px3.p1.2.m2.1.1.2.cmml" xref="S4.SS3.SSS0.Px3.p1.2.m2.1.1.2"><ci id="S4.SS3.SSS0.Px3.p1.2.m2.1.1.2.1.cmml" xref="S4.SS3.SSS0.Px3.p1.2.m2.1.1.2.1">^</ci><ci id="S4.SS3.SSS0.Px3.p1.2.m2.1.1.2.2.cmml" xref="S4.SS3.SSS0.Px3.p1.2.m2.1.1.2.2">𝑧</ci></apply><ci id="S4.SS3.SSS0.Px3.p1.2.m2.1.1.3.cmml" xref="S4.SS3.SSS0.Px3.p1.2.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px3.p1.2.m2.1c">\hat{z}_{k}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS0.Px3.p1.2.m2.1d">over^ start_ARG italic_z end_ARG start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math>, introducing a sequential dependency that hinders parallel computation (see Lines 12 to 17 of Algorithm 2 in <cite class="ltx_cite ltx_citemacro_citet">Hansen et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#bib.bib17" title="">2022</a>)</cite>). In contrast, BS-MPC generates the predicted latent state <math alttext="\hat{z}_{k+1}" class="ltx_Math" display="inline" id="S4.SS3.SSS0.Px3.p1.3.m3.1"><semantics id="S4.SS3.SSS0.Px3.p1.3.m3.1a"><msub id="S4.SS3.SSS0.Px3.p1.3.m3.1.1" xref="S4.SS3.SSS0.Px3.p1.3.m3.1.1.cmml"><mover accent="true" id="S4.SS3.SSS0.Px3.p1.3.m3.1.1.2" xref="S4.SS3.SSS0.Px3.p1.3.m3.1.1.2.cmml"><mi id="S4.SS3.SSS0.Px3.p1.3.m3.1.1.2.2" xref="S4.SS3.SSS0.Px3.p1.3.m3.1.1.2.2.cmml">z</mi><mo id="S4.SS3.SSS0.Px3.p1.3.m3.1.1.2.1" xref="S4.SS3.SSS0.Px3.p1.3.m3.1.1.2.1.cmml">^</mo></mover><mrow id="S4.SS3.SSS0.Px3.p1.3.m3.1.1.3" xref="S4.SS3.SSS0.Px3.p1.3.m3.1.1.3.cmml"><mi id="S4.SS3.SSS0.Px3.p1.3.m3.1.1.3.2" xref="S4.SS3.SSS0.Px3.p1.3.m3.1.1.3.2.cmml">k</mi><mo id="S4.SS3.SSS0.Px3.p1.3.m3.1.1.3.1" xref="S4.SS3.SSS0.Px3.p1.3.m3.1.1.3.1.cmml">+</mo><mn id="S4.SS3.SSS0.Px3.p1.3.m3.1.1.3.3" xref="S4.SS3.SSS0.Px3.p1.3.m3.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px3.p1.3.m3.1b"><apply id="S4.SS3.SSS0.Px3.p1.3.m3.1.1.cmml" xref="S4.SS3.SSS0.Px3.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS0.Px3.p1.3.m3.1.1.1.cmml" xref="S4.SS3.SSS0.Px3.p1.3.m3.1.1">subscript</csymbol><apply id="S4.SS3.SSS0.Px3.p1.3.m3.1.1.2.cmml" xref="S4.SS3.SSS0.Px3.p1.3.m3.1.1.2"><ci id="S4.SS3.SSS0.Px3.p1.3.m3.1.1.2.1.cmml" xref="S4.SS3.SSS0.Px3.p1.3.m3.1.1.2.1">^</ci><ci id="S4.SS3.SSS0.Px3.p1.3.m3.1.1.2.2.cmml" xref="S4.SS3.SSS0.Px3.p1.3.m3.1.1.2.2">𝑧</ci></apply><apply id="S4.SS3.SSS0.Px3.p1.3.m3.1.1.3.cmml" xref="S4.SS3.SSS0.Px3.p1.3.m3.1.1.3"><plus id="S4.SS3.SSS0.Px3.p1.3.m3.1.1.3.1.cmml" xref="S4.SS3.SSS0.Px3.p1.3.m3.1.1.3.1"></plus><ci id="S4.SS3.SSS0.Px3.p1.3.m3.1.1.3.2.cmml" xref="S4.SS3.SSS0.Px3.p1.3.m3.1.1.3.2">𝑘</ci><cn id="S4.SS3.SSS0.Px3.p1.3.m3.1.1.3.3.cmml" type="integer" xref="S4.SS3.SSS0.Px3.p1.3.m3.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px3.p1.3.m3.1c">\hat{z}_{k+1}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS0.Px3.p1.3.m3.1d">over^ start_ARG italic_z end_ARG start_POSTSUBSCRIPT italic_k + 1 end_POSTSUBSCRIPT</annotation></semantics></math> by encoding the current state into the latent state <math alttext="z_{k}=h_{\theta^{h}}(s_{k})" class="ltx_Math" display="inline" id="S4.SS3.SSS0.Px3.p1.4.m4.1"><semantics id="S4.SS3.SSS0.Px3.p1.4.m4.1a"><mrow id="S4.SS3.SSS0.Px3.p1.4.m4.1.1" xref="S4.SS3.SSS0.Px3.p1.4.m4.1.1.cmml"><msub id="S4.SS3.SSS0.Px3.p1.4.m4.1.1.3" xref="S4.SS3.SSS0.Px3.p1.4.m4.1.1.3.cmml"><mi id="S4.SS3.SSS0.Px3.p1.4.m4.1.1.3.2" xref="S4.SS3.SSS0.Px3.p1.4.m4.1.1.3.2.cmml">z</mi><mi id="S4.SS3.SSS0.Px3.p1.4.m4.1.1.3.3" xref="S4.SS3.SSS0.Px3.p1.4.m4.1.1.3.3.cmml">k</mi></msub><mo id="S4.SS3.SSS0.Px3.p1.4.m4.1.1.2" xref="S4.SS3.SSS0.Px3.p1.4.m4.1.1.2.cmml">=</mo><mrow id="S4.SS3.SSS0.Px3.p1.4.m4.1.1.1" xref="S4.SS3.SSS0.Px3.p1.4.m4.1.1.1.cmml"><msub id="S4.SS3.SSS0.Px3.p1.4.m4.1.1.1.3" xref="S4.SS3.SSS0.Px3.p1.4.m4.1.1.1.3.cmml"><mi id="S4.SS3.SSS0.Px3.p1.4.m4.1.1.1.3.2" xref="S4.SS3.SSS0.Px3.p1.4.m4.1.1.1.3.2.cmml">h</mi><msup id="S4.SS3.SSS0.Px3.p1.4.m4.1.1.1.3.3" xref="S4.SS3.SSS0.Px3.p1.4.m4.1.1.1.3.3.cmml"><mi id="S4.SS3.SSS0.Px3.p1.4.m4.1.1.1.3.3.2" xref="S4.SS3.SSS0.Px3.p1.4.m4.1.1.1.3.3.2.cmml">θ</mi><mi id="S4.SS3.SSS0.Px3.p1.4.m4.1.1.1.3.3.3" xref="S4.SS3.SSS0.Px3.p1.4.m4.1.1.1.3.3.3.cmml">h</mi></msup></msub><mo id="S4.SS3.SSS0.Px3.p1.4.m4.1.1.1.2" xref="S4.SS3.SSS0.Px3.p1.4.m4.1.1.1.2.cmml">⁢</mo><mrow id="S4.SS3.SSS0.Px3.p1.4.m4.1.1.1.1.1" xref="S4.SS3.SSS0.Px3.p1.4.m4.1.1.1.1.1.1.cmml"><mo id="S4.SS3.SSS0.Px3.p1.4.m4.1.1.1.1.1.2" stretchy="false" xref="S4.SS3.SSS0.Px3.p1.4.m4.1.1.1.1.1.1.cmml">(</mo><msub id="S4.SS3.SSS0.Px3.p1.4.m4.1.1.1.1.1.1" xref="S4.SS3.SSS0.Px3.p1.4.m4.1.1.1.1.1.1.cmml"><mi id="S4.SS3.SSS0.Px3.p1.4.m4.1.1.1.1.1.1.2" xref="S4.SS3.SSS0.Px3.p1.4.m4.1.1.1.1.1.1.2.cmml">s</mi><mi id="S4.SS3.SSS0.Px3.p1.4.m4.1.1.1.1.1.1.3" xref="S4.SS3.SSS0.Px3.p1.4.m4.1.1.1.1.1.1.3.cmml">k</mi></msub><mo id="S4.SS3.SSS0.Px3.p1.4.m4.1.1.1.1.1.3" stretchy="false" xref="S4.SS3.SSS0.Px3.p1.4.m4.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px3.p1.4.m4.1b"><apply id="S4.SS3.SSS0.Px3.p1.4.m4.1.1.cmml" xref="S4.SS3.SSS0.Px3.p1.4.m4.1.1"><eq id="S4.SS3.SSS0.Px3.p1.4.m4.1.1.2.cmml" xref="S4.SS3.SSS0.Px3.p1.4.m4.1.1.2"></eq><apply id="S4.SS3.SSS0.Px3.p1.4.m4.1.1.3.cmml" xref="S4.SS3.SSS0.Px3.p1.4.m4.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.SSS0.Px3.p1.4.m4.1.1.3.1.cmml" xref="S4.SS3.SSS0.Px3.p1.4.m4.1.1.3">subscript</csymbol><ci id="S4.SS3.SSS0.Px3.p1.4.m4.1.1.3.2.cmml" xref="S4.SS3.SSS0.Px3.p1.4.m4.1.1.3.2">𝑧</ci><ci id="S4.SS3.SSS0.Px3.p1.4.m4.1.1.3.3.cmml" xref="S4.SS3.SSS0.Px3.p1.4.m4.1.1.3.3">𝑘</ci></apply><apply id="S4.SS3.SSS0.Px3.p1.4.m4.1.1.1.cmml" xref="S4.SS3.SSS0.Px3.p1.4.m4.1.1.1"><times id="S4.SS3.SSS0.Px3.p1.4.m4.1.1.1.2.cmml" xref="S4.SS3.SSS0.Px3.p1.4.m4.1.1.1.2"></times><apply id="S4.SS3.SSS0.Px3.p1.4.m4.1.1.1.3.cmml" xref="S4.SS3.SSS0.Px3.p1.4.m4.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.SSS0.Px3.p1.4.m4.1.1.1.3.1.cmml" xref="S4.SS3.SSS0.Px3.p1.4.m4.1.1.1.3">subscript</csymbol><ci id="S4.SS3.SSS0.Px3.p1.4.m4.1.1.1.3.2.cmml" xref="S4.SS3.SSS0.Px3.p1.4.m4.1.1.1.3.2">ℎ</ci><apply id="S4.SS3.SSS0.Px3.p1.4.m4.1.1.1.3.3.cmml" xref="S4.SS3.SSS0.Px3.p1.4.m4.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.SS3.SSS0.Px3.p1.4.m4.1.1.1.3.3.1.cmml" xref="S4.SS3.SSS0.Px3.p1.4.m4.1.1.1.3.3">superscript</csymbol><ci id="S4.SS3.SSS0.Px3.p1.4.m4.1.1.1.3.3.2.cmml" xref="S4.SS3.SSS0.Px3.p1.4.m4.1.1.1.3.3.2">𝜃</ci><ci id="S4.SS3.SSS0.Px3.p1.4.m4.1.1.1.3.3.3.cmml" xref="S4.SS3.SSS0.Px3.p1.4.m4.1.1.1.3.3.3">ℎ</ci></apply></apply><apply id="S4.SS3.SSS0.Px3.p1.4.m4.1.1.1.1.1.1.cmml" xref="S4.SS3.SSS0.Px3.p1.4.m4.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS0.Px3.p1.4.m4.1.1.1.1.1.1.1.cmml" xref="S4.SS3.SSS0.Px3.p1.4.m4.1.1.1.1.1">subscript</csymbol><ci id="S4.SS3.SSS0.Px3.p1.4.m4.1.1.1.1.1.1.2.cmml" xref="S4.SS3.SSS0.Px3.p1.4.m4.1.1.1.1.1.1.2">𝑠</ci><ci id="S4.SS3.SSS0.Px3.p1.4.m4.1.1.1.1.1.1.3.cmml" xref="S4.SS3.SSS0.Px3.p1.4.m4.1.1.1.1.1.1.3">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px3.p1.4.m4.1c">z_{k}=h_{\theta^{h}}(s_{k})</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS0.Px3.p1.4.m4.1d">italic_z start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT = italic_h start_POSTSUBSCRIPT italic_θ start_POSTSUPERSCRIPT italic_h end_POSTSUPERSCRIPT end_POSTSUBSCRIPT ( italic_s start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT )</annotation></semantics></math> and using it as input to the dynamics model, which removes the sequential dependency and allows for parallel computation across time steps. Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#S4.F2" title="Figure 2 ‣ Ease of parallelization ‣ 4.3 Difference between BS-MPC and TD-MPC ‣ 4 Bisimulation metric for model predictive control ‣ Bisimulation metric for Model Predictive Control"><span class="ltx_text ltx_ref_tag">2</span></a> and Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#S4.F2" title="Figure 2 ‣ Ease of parallelization ‣ 4.3 Difference between BS-MPC and TD-MPC ‣ 4 Bisimulation metric for model predictive control ‣ Bisimulation metric for Model Predictive Control"><span class="ltx_text ltx_ref_tag">2</span></a> show the calculation flow difference between TD-MPC and BS-MPC. Consequently, BS-MPC achieves faster computational times compared to TD-MPC.</p>
</div>
<figure class="ltx_figure" id="S4.F2">
<table class="ltx_tabular ltx_align_middle" id="S4.F2.2">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.F2.2.2">
<td class="ltx_td ltx_align_center" id="S4.F2.1.1.1">
<div class="ltx_block ltx_minipage ltx_align_bottom" id="S4.F2.1.1.1.1" style="width:203.8pt;">
<img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="332" id="S4.F2.1.1.1.1.g1" src="extracted/5905356/figures/tdmpc_gradient_flow.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_block">(a) </span>TD-MPC calculation flow</figcaption>
</div>
</td>
<td class="ltx_td ltx_align_center" id="S4.F2.2.2.2">
<div class="ltx_block ltx_minipage ltx_align_bottom" id="S4.F2.2.2.2.1" style="width:203.8pt;">
<img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="332" id="S4.F2.2.2.2.1.g1" src="extracted/5905356/figures/bsmpc_gradient_flow.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_block">(b) </span>BS-MPC calculation flow</figcaption>
</div>
</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>Calculation flow comparison. The black line shows the forward calculation flow, and the red arrows represent the gradient of <math alttext="\theta^{h}" class="ltx_Math" display="inline" id="S4.F2.4.m1.1"><semantics id="S4.F2.4.m1.1b"><msup id="S4.F2.4.m1.1.1" xref="S4.F2.4.m1.1.1.cmml"><mi id="S4.F2.4.m1.1.1.2" xref="S4.F2.4.m1.1.1.2.cmml">θ</mi><mi id="S4.F2.4.m1.1.1.3" xref="S4.F2.4.m1.1.1.3.cmml">h</mi></msup><annotation-xml encoding="MathML-Content" id="S4.F2.4.m1.1c"><apply id="S4.F2.4.m1.1.1.cmml" xref="S4.F2.4.m1.1.1"><csymbol cd="ambiguous" id="S4.F2.4.m1.1.1.1.cmml" xref="S4.F2.4.m1.1.1">superscript</csymbol><ci id="S4.F2.4.m1.1.1.2.cmml" xref="S4.F2.4.m1.1.1.2">𝜃</ci><ci id="S4.F2.4.m1.1.1.3.cmml" xref="S4.F2.4.m1.1.1.3">ℎ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F2.4.m1.1d">\theta^{h}</annotation><annotation encoding="application/x-llamapun" id="S4.F2.4.m1.1e">italic_θ start_POSTSUPERSCRIPT italic_h end_POSTSUPERSCRIPT</annotation></semantics></math>. While TD-MPC needs sequential calculation in its forward computational flow, BS-MPC can process all the calculation parallel. Moreover, BS-MPC has explicit encoder loss in its cost function, so its derivative directly updates the parameters of the encoder. Note that TD-MPC only encodes the original observation at the initial time step and predicts latent states by using the latent dynamics model.</figcaption>
</figure>
</section>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Experiments</h2>
<div class="ltx_para ltx_noindent" id="S5.p1">
<p class="ltx_p" id="S5.p1.1">We evaluate BS-MPC across various continuous control tasks using the DeepMind Control Suite (DM Control <cite class="ltx_cite ltx_citemacro_citep">(Tassa et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#bib.bib39" title="">2018</a>)</cite>). The inputs in these experiments include both high-dimensional state vectors and images, with some tasks set in sparse-reward environments. The objective of this section is to demonstrate that BS-MPC maintains its performance over time and remains robust to noise. Additionally, we aim to confirm that it outperforms TD-MPC in terms of computational efficiency.
In this experiment, we focus specifically on comparing BS-MPC with TD-MPC. <span class="ltx_text ltx_font_bold" id="S5.p1.1.1">For a fair comparison, BS-MPC uses the same model architecture as TD-MPC, with an identical number of parameters and tuning parameters set to the same values. We also run BS-MPC and TD-MPC using the same random seeds.</span> The only difference between BS-MPC and TD-MPC is explicit encoder loss in the objective function with an additional parameter <math alttext="c_{4}" class="ltx_Math" display="inline" id="S5.p1.1.m1.1"><semantics id="S5.p1.1.m1.1a"><msub id="S5.p1.1.m1.1.1" xref="S5.p1.1.m1.1.1.cmml"><mi id="S5.p1.1.m1.1.1.2" xref="S5.p1.1.m1.1.1.2.cmml">c</mi><mn id="S5.p1.1.m1.1.1.3" xref="S5.p1.1.m1.1.1.3.cmml">4</mn></msub><annotation-xml encoding="MathML-Content" id="S5.p1.1.m1.1b"><apply id="S5.p1.1.m1.1.1.cmml" xref="S5.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S5.p1.1.m1.1.1.1.cmml" xref="S5.p1.1.m1.1.1">subscript</csymbol><ci id="S5.p1.1.m1.1.1.2.cmml" xref="S5.p1.1.m1.1.1.2">𝑐</ci><cn id="S5.p1.1.m1.1.1.3.cmml" type="integer" xref="S5.p1.1.m1.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p1.1.m1.1c">c_{4}</annotation><annotation encoding="application/x-llamapun" id="S5.p1.1.m1.1d">italic_c start_POSTSUBSCRIPT 4 end_POSTSUBSCRIPT</annotation></semantics></math>. We adopt the same environmental settings as those used in the original TD-MPC paper <cite class="ltx_cite ltx_citemacro_citep">(Hansen et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#bib.bib17" title="">2022</a>)</cite>. Detailed experimental configurations are provided in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#A5" title="Appendix E Implementation Details ‣ Bisimulation metric for Model Predictive Control"><span class="ltx_text ltx_ref_tag">E</span></a>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S5.p2">
<p class="ltx_p" id="S5.p2.1">For the baselines, we use the model-free RL algorithm SAC <cite class="ltx_cite ltx_citemacro_citep">(Haarnoja et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#bib.bib9" title="">2018a</a>; <a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#bib.bib10" title="">b</a>; <a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#bib.bib11" title="">2019</a>)</cite>, the model-based RL algorithm Dreamer-v3 <cite class="ltx_cite ltx_citemacro_citep">(Hafner et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#bib.bib15" title="">2024</a>)</cite>, and the planning-based model-based RL approach TD-MPC <cite class="ltx_cite ltx_citemacro_cite">Hansen et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#bib.bib17" title="">2022</a>)</cite>, evaluating them on both state-based and image-based tasks. In addition to these algorithms, we also compare BS-MPC with DrQ-v2 <cite class="ltx_cite ltx_citemacro_citep">(Yarats et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#bib.bib45" title="">2022</a>)</cite> and CURL <cite class="ltx_cite ltx_citemacro_citep">(Laskin et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#bib.bib28" title="">2020</a>)</cite> on image-based tasks. For a more strong baseline comparison, we compare BS-MPC with TD-MPC2 <cite class="ltx_cite ltx_citemacro_citep">(Hansen et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#bib.bib16" title="">2024</a>)</cite> in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#A4" title="Appendix D BS-MPC vs TD-MPC2 ‣ Bisimulation metric for Model Predictive Control"><span class="ltx_text ltx_ref_tag">D</span></a>. We publicly release the value of episode return at each time step and code for training BS-MPC agents.</p>
</div>
<section class="ltx_subsection" id="S5.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1 </span>Result on state-based tasks</h3>
<div class="ltx_para ltx_noindent" id="S5.SS1.p1">
<p class="ltx_p" id="S5.SS1.p1.1">We evaluate BS-MPC across 26 diverse continuous control tasks with state inputs, comparing its performance to other baseline methods. In this setting, agents have direct access to all internal states of the environment.</p>
</div>
<div class="ltx_para ltx_noindent" id="S5.SS1.p2">
<p class="ltx_p" id="S5.SS1.p2.1">Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#S5.F3" title="Figure 3 ‣ 5.1 Result on state-based tasks ‣ 5 Experiments ‣ Bisimulation metric for Model Predictive Control"><span class="ltx_text ltx_ref_tag">3</span></a> shows the average performance of each algorithm across 10 tasks, along with the individual scores from 9 specific tasks.
We ran 10 million time steps for the dog experiment and 8 million time steps for the humanoid experiment.
For the other tasks, the experiments were run for 4 million time steps. The results demonstrate that BS-MPC consistently outperforms existing model-based and model-free reinforcement learning methods, particularly in high-dimensional environments.
On complex tasks involving dog and humanoid environments, BS-MPC significantly outperforms TD-MPC, SAC, and Dreamer-v3. In particular, BS-MPC achieves higher episode returns early in training and maintains superior performance throughout, whereas the other methods either plateau or display instability.
TD-MPC performs well in the early stages of training, achieving competitive results up to approximately 1 million steps. However, in many tasks, its performance suddenly collapses after this point, leading to high variance and reduced episode returns. It is important to note that BS-MPC and TD-MPC share the exact same model architecture, hyperparameters, and number of parameters. The only difference between them lies in the cost function: BS-MPC explicitly minimizes the bisimulation metric loss at every time step to train the encoder, whereas TD-MPC only calculates the encoder loss at the initial time step.
Appendix. <a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#A2" title="Appendix B Additional Experimental Results ‣ Bisimulation metric for Model Predictive Control"><span class="ltx_text ltx_ref_tag">B</span></a> shows all the results from 26 continuous control tasks, computation time comparison, and detailed analysis of the training failure of TD-MPC.</p>
</div>
<figure class="ltx_figure" id="S5.F3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="238" id="S5.F3.g1" src="extracted/5905356/figures/main_state_result.png" width="548"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>Performance comparison on the average over 26 state-based tasks and 9 DM Control tasks with state input. At each evaluation step, the episode return is computed over 10 episodes. The results are averaged over 3 seeds, with shaded regions representing the standard deviation. Results for SAC and Dreamer-v3 are obtained from <cite class="ltx_cite ltx_citemacro_citep">(Hansen et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#bib.bib16" title="">2024</a>)</cite>, and results for TD-MPC are reproduced using their official code with the same architecture and hyperparameters for BS-MPC. We use the same seeds for evaluation.</figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S5.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2 </span>Results on image-based tasks</h3>
<div class="ltx_para ltx_noindent" id="S5.SS2.p1">
<p class="ltx_p" id="S5.SS2.p1.1">Next, we evaluate BS-MPC and other baseline methods on image-based tasks from 10 DM Control environments. In these tasks, the encoders of both BS-MPC and TD-MPC are modeled by CNN to project high-dimensional image data into a compact latent space. To ensure a fair comparison, we use the same model architecture, hyperparameters, and number of parameters for both BS-MPC and TD-MPC, and we use identical seeds for evaluation. We run 3 million environmental steps for all tasks.
Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#S5.F4" title="Figure 4 ‣ 5.2 Results on image-based tasks ‣ 5 Experiments ‣ Bisimulation metric for Model Predictive Control"><span class="ltx_text ltx_ref_tag">4</span></a> shows the results across 10 image-based tasks. BS-MPC demonstrates performance competitive with TD-MPC, DrQ-v2 and Dreamer-v3, consistently outperforming CURL and SAC.</p>
</div>
<figure class="ltx_figure" id="S5.F4"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="238" id="S5.F4.g1" src="extracted/5905356/figures/main_image_result.png" width="548"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>Performance comparison on 10 DM Control image-based tasks. At each evaluation step, the episode return is computed over 10 episodes. The results are averaged over 3 seeds, with shaded regions representing the standard deviation. Results for DrQ-v2 are obtained from their official results, and results for CURL, SAC and Dreamer-v3 are obtained from Dreamer-v3 code <cite class="ltx_cite ltx_citemacro_citep">(Hafner et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#bib.bib15" title="">2024</a>)</cite>.</figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S5.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.3 </span>Resutls on Image input with distractions</h3>
<div class="ltx_para ltx_noindent" id="S5.SS3.p1">
<p class="ltx_p" id="S5.SS3.p1.1">Finally, we evaluate the robustness of the proposed method in the presence of distracting information. The goal of this experiment is to show that BS-MPC has better resilience against irrelevant data in the input. We benchmark BS-MPC on 5 DM Control tasks by introducing irrelevant information into the input as noise. Following <cite class="ltx_cite ltx_citemacro_citep">(Zhang et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#bib.bib46" title="">2018</a>; <a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#bib.bib47" title="">2021</a>)</cite>, driving videos from the Kinetics dataset <cite class="ltx_cite ltx_citemacro_citep">(Kay et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#bib.bib22" title="">2017</a>)</cite> are used as background for the original images. In this experiment, the same parameters and architecture as in Section <a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#S5.SS2" title="5.2 Results on image-based tasks ‣ 5 Experiments ‣ Bisimulation metric for Model Predictive Control"><span class="ltx_text ltx_ref_tag">5.2</span></a> are employed, and the performance of BS-MPC is compared to that of TD-MPC.</p>
</div>
<div class="ltx_para ltx_noindent" id="S5.SS3.p2">
<p class="ltx_p" id="S5.SS3.p2.1">Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#S5.F5" title="Figure 5 ‣ 5.3 Resutls on Image input with distractions ‣ 5 Experiments ‣ Bisimulation metric for Model Predictive Control"><span class="ltx_text ltx_ref_tag">5</span></a> shows the experimental results, which reveal that BS-MPC constantly outperforms TD-MPC in every environment. Since TD-MPC does not have an explicit objective function for its encoder, its encoder simply learns representation space to keep the latent dynamics consistent. Therefore, its encoder struggles to filter out the noise during training.
BS-MPC, however, learns its encoder by minimizing the bisimulation metric loss to retain bisimulation information in the learned representation space. This architectural modification enhances performance and increases robustness to noise compared to TD-MPC.</p>
</div>
<figure class="ltx_figure" id="S5.F5"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="266" id="S5.F5.g1" src="extracted/5905356/figures/distractor_result.png" width="548"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>Performance comparison on 5 DM Control image-based tasks with distracted information from Kinetics dataset. At each evaluation step, the episode return is computed over 10 episodes. The results are averaged over 5 seeds, with shaded regions representing the standard deviation. (Top) Original Image. (Middle) Distracted Image. (Bottom) Performance results. BS-MPC constantly outperforms TD-MPC when the input is disturbed.</figcaption>
</figure>
</section>
</section>
<section class="ltx_section" id="S6">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Conclusion</h2>
<div class="ltx_para ltx_noindent" id="S6.p1">
<p class="ltx_p" id="S6.p1.1">In this paper, we propose a novel model-based reinforcement learning method called Bisimulation Metric for Model Predictive Control (BS-MPC). While inheriting several properties from TD-MPC, our approach differentiates it from the previous method in three key areas: inclusion of explicit encoder loss term, adaptation of bisimulation metric, and parallelizing the computational flow. These improvements stabilize the learning process and enhance the model’s robustness to noise while reducing the training time. Experimental results on continuous control tasks from DM Control demonstrate that BS-MPC has superior stability and robustness, whereas TD-MPC and other baselines fail to achieve comparable performance.</p>
</div>
<section class="ltx_paragraph" id="S6.SS0.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">Limitations.</h4>
<div class="ltx_para ltx_noindent" id="S6.SS0.SSS0.Px1.p1">
<p class="ltx_p" id="S6.SS0.SSS0.Px1.p1.1">Despite the theoretical foundations and experimental results supporting BS-MPC, it has one notable limitation: the need for extensive parameter tuning of <math alttext="c_{4}" class="ltx_Math" display="inline" id="S6.SS0.SSS0.Px1.p1.1.m1.1"><semantics id="S6.SS0.SSS0.Px1.p1.1.m1.1a"><msub id="S6.SS0.SSS0.Px1.p1.1.m1.1.1" xref="S6.SS0.SSS0.Px1.p1.1.m1.1.1.cmml"><mi id="S6.SS0.SSS0.Px1.p1.1.m1.1.1.2" xref="S6.SS0.SSS0.Px1.p1.1.m1.1.1.2.cmml">c</mi><mn id="S6.SS0.SSS0.Px1.p1.1.m1.1.1.3" xref="S6.SS0.SSS0.Px1.p1.1.m1.1.1.3.cmml">4</mn></msub><annotation-xml encoding="MathML-Content" id="S6.SS0.SSS0.Px1.p1.1.m1.1b"><apply id="S6.SS0.SSS0.Px1.p1.1.m1.1.1.cmml" xref="S6.SS0.SSS0.Px1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S6.SS0.SSS0.Px1.p1.1.m1.1.1.1.cmml" xref="S6.SS0.SSS0.Px1.p1.1.m1.1.1">subscript</csymbol><ci id="S6.SS0.SSS0.Px1.p1.1.m1.1.1.2.cmml" xref="S6.SS0.SSS0.Px1.p1.1.m1.1.1.2">𝑐</ci><cn id="S6.SS0.SSS0.Px1.p1.1.m1.1.1.3.cmml" type="integer" xref="S6.SS0.SSS0.Px1.p1.1.m1.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS0.SSS0.Px1.p1.1.m1.1c">c_{4}</annotation><annotation encoding="application/x-llamapun" id="S6.SS0.SSS0.Px1.p1.1.m1.1d">italic_c start_POSTSUBSCRIPT 4 end_POSTSUBSCRIPT</annotation></semantics></math> across different environments. In this paper, we employ a grid search to identify the optimal parameter values; however, future research should focus on developing methods for automatic parameter adjustment.</p>
</div>
</section>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Castro (2020)</span>
<span class="ltx_bibblock">
Pablo Samuel Castro.

</span>
<span class="ltx_bibblock">Scalable methods for computing state similarity in deterministic markov decision processes.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib1.1.1">Proceedings of the Thirty-Fourth AAAI Conference on Artificial Intelligence (AAAI-20)</em>, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chitnis et al. (2023)</span>
<span class="ltx_bibblock">
Rohan Chitnis, Yingchen Xu, Bobak Hashemi, Lucas Lehnert, Ürün Dogan, Zheqing Zhu, and Olivier Delalleau.

</span>
<span class="ltx_bibblock">Iql-td-mpc: Implicit q-learning for hierarchical model predictive control.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib2.1.1">2024 IEEE International Conference on Robotics and Automation (ICRA)</em>, pp.  9154–9160, 2023.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://api.semanticscholar.org/CorpusID:258999679" title="">https://api.semanticscholar.org/CorpusID:258999679</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chua et al. (2018)</span>
<span class="ltx_bibblock">
Kurtland Chua, Roberto Calandra, Rowan McAllister, and Sergey Levine.

</span>
<span class="ltx_bibblock">Deep reinforcement learning in a handful of trials using probabilistic dynamics models.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib3.1.1">Proceedings of the 32nd International Conference on Neural Information Processing Systems</em>, NIPS’18, pp.  4759–4770, Red Hook, NY, USA, 2018. Curran Associates Inc.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Feng et al. (2023)</span>
<span class="ltx_bibblock">
Yunhai Feng, Nicklas Hansen, Ziyan Xiong, Chandramouli Rajagopalan, and Xiaolong Wang.

</span>
<span class="ltx_bibblock">Finetuning offline world models in the real world.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib4.1.1">7th Annual Conference on Robot Learning</em>, 2023.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://openreview.net/forum?id=JkFeyEC6VXV" title="">https://openreview.net/forum?id=JkFeyEC6VXV</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ferns &amp; Precup (2014)</span>
<span class="ltx_bibblock">
Norm Ferns and Doina Precup.

</span>
<span class="ltx_bibblock">Bisimulation metrics are optimal value functions.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib5.1.1">Proceedings of the Thirtieth Conference on Uncertainty in Artificial Intelligence</em>, UAI’14, pp.  210–219, Arlington, Virginia, USA, 2014. AUAI Press.

</span>
<span class="ltx_bibblock">ISBN 9780974903910.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ferns et al. (2011)</span>
<span class="ltx_bibblock">
Norm Ferns, Prakash Panangaden, and Doina Precup.

</span>
<span class="ltx_bibblock">Bisimulation metrics for continuous markov decision processes.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib6.1.1">SIAM Journal on Computing</em>, 40(6):1662–1714, 2011.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.1137/10080484X</span>.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1137/10080484X" title="">https://doi.org/10.1137/10080484X</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Fujimoto et al. (2018)</span>
<span class="ltx_bibblock">
Scott Fujimoto, Herke van Hoof, and David Meger.

</span>
<span class="ltx_bibblock">Addressing function approximation error in actor-critic methods.

</span>
<span class="ltx_bibblock">In Jennifer G. Dy and Andreas Krause (eds.), <em class="ltx_emph ltx_font_italic" id="bib.bib7.1.1">Proceedings of the 35th International Conference on Machine Learning, ICML 2018, Stockholmsmässan, Stockholm, Sweden, July 10-15, 2018</em>, volume 80 of <em class="ltx_emph ltx_font_italic" id="bib.bib7.2.2">Proceedings of Machine Learning Research</em>, pp.  1582–1591. PMLR, 2018.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="http://proceedings.mlr.press/v80/fujimoto18a.html" title="">http://proceedings.mlr.press/v80/fujimoto18a.html</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Givan et al. (2003)</span>
<span class="ltx_bibblock">
Robert Givan, Thomas Dean, and Matthew Greig.

</span>
<span class="ltx_bibblock">Equivalence notions and model minimization in markov decision processes.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib8.1.1">Artificial Intelligence</em>, 147(1):163–223, 2003.

</span>
<span class="ltx_bibblock">ISSN 0004-3702.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">https://doi.org/10.1016/S0004-3702(02)00376-4</span>.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://www.sciencedirect.com/science/article/pii/S0004370202003764" title="">https://www.sciencedirect.com/science/article/pii/S0004370202003764</a>.

</span>
<span class="ltx_bibblock">Planning with Uncertainty and Incomplete Information.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Haarnoja et al. (2018a)</span>
<span class="ltx_bibblock">
Tuomas Haarnoja, Aurick Zhou, Pieter Abbeel, and Sergey Levine.

</span>
<span class="ltx_bibblock">Soft actor-critic: Off-policy maximum entropy deep reinforcement learning with a stochastic actor.

</span>
<span class="ltx_bibblock">In Jennifer Dy and Andreas Krause (eds.), <em class="ltx_emph ltx_font_italic" id="bib.bib9.1.1">Proceedings of the 35th International Conference on Machine Learning</em>, volume 80 of <em class="ltx_emph ltx_font_italic" id="bib.bib9.2.2">Proceedings of Machine Learning Research</em>, pp.  1861–1870. PMLR, 10–15 Jul 2018a.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://proceedings.mlr.press/v80/haarnoja18b.html" title="">https://proceedings.mlr.press/v80/haarnoja18b.html</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Haarnoja et al. (2018b)</span>
<span class="ltx_bibblock">
Tuomas Haarnoja, Aurick Zhou, Kristian Hartikainen, George Tucker, Sehoon Ha, Jie Tan, Vikash Kumar, Henry Zhu, Abhishek Gupta, Pieter Abbeel, and Sergey Levine.

</span>
<span class="ltx_bibblock">Soft actor-critic algorithms and applications.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib10.1.1">CoRR</em>, abs/1812.05905, 2018b.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="http://arxiv.org/abs/1812.05905" title="">http://arxiv.org/abs/1812.05905</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Haarnoja et al. (2019)</span>
<span class="ltx_bibblock">
Tuomas Haarnoja, Sehoon Ha, Aurick Zhou, Jie Tan, George Tucker, and Sergey Levine.

</span>
<span class="ltx_bibblock">Learning to walk via deep reinforcement learning.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib11.1.1">Proceedings of Robotics: Science and Systems</em>, FreiburgimBreisgau, Germany, June 2019.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.15607/RSS.2019.XV.011</span>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hafner et al. (2019)</span>
<span class="ltx_bibblock">
Danijar Hafner, Timothy Lillicrap, Ian Fischer, Ruben Villegas, David Ha, Honglak Lee, and James Davidson.

</span>
<span class="ltx_bibblock">Learning latent dynamics for planning from pixels.

</span>
<span class="ltx_bibblock">In Kamalika Chaudhuri and Ruslan Salakhutdinov (eds.), <em class="ltx_emph ltx_font_italic" id="bib.bib12.1.1">Proceedings of the 36th International Conference on Machine Learning</em>, volume 97 of <em class="ltx_emph ltx_font_italic" id="bib.bib12.2.2">Proceedings of Machine Learning Research</em>, pp.  2555–2565. PMLR, 09–15 Jun 2019.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://proceedings.mlr.press/v97/hafner19a.html" title="">https://proceedings.mlr.press/v97/hafner19a.html</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hafner et al. (2020)</span>
<span class="ltx_bibblock">
Danijar Hafner, Timothy Lillicrap, Jimmy Ba, and Mohammad Norouzi.

</span>
<span class="ltx_bibblock">Dream to control: Learning behaviors by latent imagination.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib13.1.1">International Conference on Learning Representations</em>, 2020.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://openreview.net/forum?id=S1lOTC4tDS" title="">https://openreview.net/forum?id=S1lOTC4tDS</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hafner et al. (2021)</span>
<span class="ltx_bibblock">
Danijar Hafner, Timothy P Lillicrap, Mohammad Norouzi, and Jimmy Ba.

</span>
<span class="ltx_bibblock">Mastering atari with discrete world models.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib14.1.1">International Conference on Learning Representations</em>, 2021.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://openreview.net/forum?id=0oabwyZbOu" title="">https://openreview.net/forum?id=0oabwyZbOu</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hafner et al. (2024)</span>
<span class="ltx_bibblock">
Danijar Hafner, Jurgis Pasukonis, Jimmy Ba, and Timothy Lillicrap.

</span>
<span class="ltx_bibblock">Mastering diverse domains through world models, 2024.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2301.04104" title="">https://arxiv.org/abs/2301.04104</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hansen et al. (2024)</span>
<span class="ltx_bibblock">
Nicklas Hansen, Hao Su, and Xiaolong Wang.

</span>
<span class="ltx_bibblock">Td-mpc2: Scalable, robust world models for continuous control, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hansen et al. (2022)</span>
<span class="ltx_bibblock">
Nicklas A Hansen, Hao Su, and Xiaolong Wang.

</span>
<span class="ltx_bibblock">Temporal difference learning for model predictive control.

</span>
<span class="ltx_bibblock">In Kamalika Chaudhuri, Stefanie Jegelka, Le Song, Csaba Szepesvari, Gang Niu, and Sivan Sabato (eds.), <em class="ltx_emph ltx_font_italic" id="bib.bib17.1.1">Proceedings of the 39th International Conference on Machine Learning</em>, volume 162 of <em class="ltx_emph ltx_font_italic" id="bib.bib17.2.2">Proceedings of Machine Learning Research</em>, pp.  8387–8406. PMLR, 17–23 Jul 2022.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://proceedings.mlr.press/v162/hansen22a.html" title="">https://proceedings.mlr.press/v162/hansen22a.html</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hessel et al. (2018)</span>
<span class="ltx_bibblock">
Matteo Hessel, Joseph Modayil, Hado van Hasselt, Tom Schaul, Georg Ostrovski, Will Dabney, Dan Horgan, Bilal Piot, Mohammad Azar, and David Silver.

</span>
<span class="ltx_bibblock">Rainbow: combining improvements in deep reinforcement learning.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib18.1.1">Proceedings of the Thirty-Second AAAI Conference on Artificial Intelligence and Thirtieth Innovative Applications of Artificial Intelligence Conference and Eighth AAAI Symposium on Educational Advances in Artificial Intelligence</em>, AAAI’18/IAAI’18/EAAI’18. AAAI Press, 2018.

</span>
<span class="ltx_bibblock">ISBN 978-1-57735-800-8.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Janner et al. (2019)</span>
<span class="ltx_bibblock">
Michael Janner, Justin Fu, Marvin Zhang, and Sergey Levine.

</span>
<span class="ltx_bibblock">When to trust your model: Model-based policy optimization.

</span>
<span class="ltx_bibblock">In H. Wallach, H. Larochelle, A. Beygelzimer, F. d'Alché-Buc, E. Fox, and R. Garnett (eds.), <em class="ltx_emph ltx_font_italic" id="bib.bib19.1.1">Advances in Neural Information Processing Systems</em>, volume 32. Curran Associates, Inc., 2019.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://proceedings.neurips.cc/paper_files/paper/2019/file/5faf461eff3099671ad63c6f3f094f7f-Paper.pdf" title="">https://proceedings.neurips.cc/paper_files/paper/2019/file/5faf461eff3099671ad63c6f3f094f7f-Paper.pdf</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kalashnikov et al. (2018)</span>
<span class="ltx_bibblock">
Dmitry Kalashnikov, Alex Irpan, Peter Pastor, Julian Ibarz, Alexander Herzog, Eric Jang, Deirdre Quillen, Ethan Holly, Mrinal Kalakrishnan, Vincent Vanhoucke, et al.

</span>
<span class="ltx_bibblock">Scalable deep reinforcement learning for vision-based robotic manipulation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib20.1.1">Conference on robot learning</em>, pp.  651–673. PMLR, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kalashnkov et al. (2021)</span>
<span class="ltx_bibblock">
Dmitry Kalashnkov, Jake Varley, Yevgen Chebotar, Ben Swanson, Rico Jonschkowski, Chelsea Finn, Sergey Levine, and Karol Hausman.

</span>
<span class="ltx_bibblock">Mt-opt: Continuous multi-task robotic reinforcement learning at scale.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib21.1.1">arXiv</em>, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kay et al. (2017)</span>
<span class="ltx_bibblock">
Will Kay, João Carreira, Karen Simonyan, Brian Zhang, Chloe Hillier, Sudheendra Vijayanarasimhan, Fabio Viola, Tim Green, Trevor Back, Paul Natsev, Mustafa Suleyman, and Andrew Zisserman.

</span>
<span class="ltx_bibblock">The kinetics human action video dataset.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib22.1.1">CoRR</em>, abs/1705.06950, 2017.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="http://arxiv.org/abs/1705.06950" title="">http://arxiv.org/abs/1705.06950</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kobilarov (2012)</span>
<span class="ltx_bibblock">
Marin Kobilarov.

</span>
<span class="ltx_bibblock">Cross-entropy motion planning.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib23.1.1">Int. J. Rob. Res.</em>, 31(7):855–871, jun 2012.

</span>
<span class="ltx_bibblock">ISSN 0278-3649.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.1177/0278364912444543</span>.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1177/0278364912444543" title="">https://doi.org/10.1177/0278364912444543</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lancaster et al. (2024)</span>
<span class="ltx_bibblock">
Patrick Lancaster, Nicklas Hansen, Aravind Rajeswaran, and Vikash Kumar.

</span>
<span class="ltx_bibblock">Modem-v2: Visuo-motor world models for real-world robot manipulation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib24.1.1">International Conference on Robotics and Automation (ICRA)</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lange &amp; Riedmiller (2010)</span>
<span class="ltx_bibblock">
Sascha Lange and Martin A. Riedmiller.

</span>
<span class="ltx_bibblock">Deep auto-encoder neural networks in reinforcement learning.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib25.1.1">The 2010 International Joint Conference on Neural Networks (IJCNN)</em>, pp.  1–8, 2010.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://api.semanticscholar.org/CorpusID:1240464" title="">https://api.semanticscholar.org/CorpusID:1240464</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lange et al. (2012)</span>
<span class="ltx_bibblock">
Sascha Lange, Martin Riedmiller, and Arne Voigtländer.

</span>
<span class="ltx_bibblock">Autonomous reinforcement learning on raw visual input data in a real world application.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib26.1.1">The 2012 International Joint Conference on Neural Networks (IJCNN)</em>, pp.  1–8, 2012.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.1109/IJCNN.2012.6252823</span>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Larsen &amp; Skou (1989)</span>
<span class="ltx_bibblock">
K. G. Larsen and A. Skou.

</span>
<span class="ltx_bibblock">Bisimulation through probabilistic testing (preliminary report).

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib27.1.1">Proceedings of the 16th ACM SIGPLAN-SIGACT Symposium on Principles of Programming Languages</em>, POPL ’89, pp.  344–352, New York, NY, USA, 1989. Association for Computing Machinery.

</span>
<span class="ltx_bibblock">ISBN 0897912942.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.1145/75277.75307</span>.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/75277.75307" title="">https://doi.org/10.1145/75277.75307</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Laskin et al. (2020)</span>
<span class="ltx_bibblock">
Michael Laskin, Aravind Srinivas, and Pieter Abbeel.

</span>
<span class="ltx_bibblock">CURL: Contrastive unsupervised representations for reinforcement learning.

</span>
<span class="ltx_bibblock">In Hal Daumé III and Aarti Singh (eds.), <em class="ltx_emph ltx_font_italic" id="bib.bib28.1.1">Proceedings of the 37th International Conference on Machine Learning</em>, volume 119 of <em class="ltx_emph ltx_font_italic" id="bib.bib28.2.2">Proceedings of Machine Learning Research</em>, pp.  5639–5650. PMLR, 13–18 Jul 2020.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://proceedings.mlr.press/v119/laskin20a.html" title="">https://proceedings.mlr.press/v119/laskin20a.html</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lee et al. (2020)</span>
<span class="ltx_bibblock">
Alex X. Lee, Anusha Nagabandi, Pieter Abbeel, and Sergey Levine.

</span>
<span class="ltx_bibblock">Stochastic latent actor-critic: Deep reinforcement learning with a latent variable model.

</span>
<span class="ltx_bibblock">In H. Larochelle, M. Ranzato, R. Hadsell, M.F. Balcan, and H. Lin (eds.), <em class="ltx_emph ltx_font_italic" id="bib.bib29.1.1">Advances in Neural Information Processing Systems</em>, volume 33, pp.  741–752. Curran Associates, Inc., 2020.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://proceedings.neurips.cc/paper_files/paper/2020/file/08058bf500242562c0d031ff830ad094-Paper.pdf" title="">https://proceedings.neurips.cc/paper_files/paper/2020/file/08058bf500242562c0d031ff830ad094-Paper.pdf</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2006)</span>
<span class="ltx_bibblock">
Lihong Li, Thomas J. Walsh, and Michael L. Littman.

</span>
<span class="ltx_bibblock">Towards a unified theory of state abstraction for mdps.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib30.1.1">International Symposium on Artificial Intelligence and Mathematics, AI&amp;Math 2006, Fort Lauderdale, Florida, USA, January 4-6, 2006</em>, 2006.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="http://anytime.cs.umass.edu/aimath06/proceedings/P21.pdf" title="">http://anytime.cs.umass.edu/aimath06/proceedings/P21.pdf</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Luo et al. (2019)</span>
<span class="ltx_bibblock">
Yuping Luo, Huazhe Xu, Yuanzhi Li, Yuandong Tian, Trevor Darrell, and Tengyu Ma.

</span>
<span class="ltx_bibblock">Algorithmic framework for model-based deep reinforcement learning with theoretical guarantees.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib31.1.1">International Conference on Learning Representations</em>, 2019.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://openreview.net/forum?id=BJe1E2R5KX" title="">https://openreview.net/forum?id=BJe1E2R5KX</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mnih et al. (2015)</span>
<span class="ltx_bibblock">
Volodymyr Mnih, Koray Kavukcuoglu, David Silver, Andrei A. Rusu, Joel Veness, Marc G. Bellemare, Alex Graves, Martin A. Riedmiller, Andreas Fidjeland, Georg Ostrovski, Stig Petersen, Charles Beattie, Amir Sadik, Ioannis Antonoglou, Helen King, Dharshan Kumaran, Daan Wierstra, Shane Legg, and Demis Hassabis.

</span>
<span class="ltx_bibblock">Human-level control through deep reinforcement learning.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib32.1.1">Nat.</em>, 518(7540):529–533, 2015.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.1038/NATURE14236</span>.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1038/nature14236" title="">https://doi.org/10.1038/nature14236</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Schrittwieser et al. (2019)</span>
<span class="ltx_bibblock">
Julian Schrittwieser, Ioannis Antonoglou, Thomas Hubert, Karen Simonyan, L. Sifre, Simon Schmitt, Arthur Guez, Edward Lockhart, Demis Hassabis, Thore Graepel, Timothy P. Lillicrap, and David Silver.

</span>
<span class="ltx_bibblock">Mastering atari, go, chess and shogi by planning with a learned model.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib33.1.1">Nature</em>, 588:604 – 609, 2019.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://api.semanticscholar.org/CorpusID:208158225" title="">https://api.semanticscholar.org/CorpusID:208158225</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Schulman et al. (2015)</span>
<span class="ltx_bibblock">
John Schulman, Sergey Levine, Pieter Abbeel, Michael Jordan, and Philipp Moritz.

</span>
<span class="ltx_bibblock">Trust region policy optimization.

</span>
<span class="ltx_bibblock">In Francis Bach and David Blei (eds.), <em class="ltx_emph ltx_font_italic" id="bib.bib34.1.1">Proceedings of the 32nd International Conference on Machine Learning</em>, volume 37 of <em class="ltx_emph ltx_font_italic" id="bib.bib34.2.2">Proceedings of Machine Learning Research</em>, pp.  1889–1897, Lille, France, 07–09 Jul 2015. PMLR.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://proceedings.mlr.press/v37/schulman15.html" title="">https://proceedings.mlr.press/v37/schulman15.html</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Schulman et al. (2017)</span>
<span class="ltx_bibblock">
John Schulman, Filip Wolski, Prafulla Dhariwal, Alec Radford, and Oleg Klimov.

</span>
<span class="ltx_bibblock">Proximal policy optimization algorithms.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib35.1.1">CoRR</em>, abs/1707.06347, 2017.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="http://dblp.uni-trier.de/db/journals/corr/corr1707.html#SchulmanWDRK17" title="">http://dblp.uni-trier.de/db/journals/corr/corr1707.html#SchulmanWDRK17</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Silver et al. (2014)</span>
<span class="ltx_bibblock">
David Silver, Guy Lever, Nicolas Heess, Thomas Degris, Daan Wierstra, and Martin Riedmiller.

</span>
<span class="ltx_bibblock">Deterministic policy gradient algorithms.

</span>
<span class="ltx_bibblock">In Eric P. Xing and Tony Jebara (eds.), <em class="ltx_emph ltx_font_italic" id="bib.bib36.1.1">Proceedings of the 31st International Conference on Machine Learning</em>, volume 32 of <em class="ltx_emph ltx_font_italic" id="bib.bib36.2.2">Proceedings of Machine Learning Research</em>, pp.  387–395, Bejing, China, 22–24 Jun 2014. PMLR.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sutton (1991)</span>
<span class="ltx_bibblock">
Richard S. Sutton.

</span>
<span class="ltx_bibblock">Dyna, an integrated architecture for learning, planning, and reacting.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib37.1.1">SIGART Bull.</em>, 2(4):160–163, jul 1991.

</span>
<span class="ltx_bibblock">ISSN 0163-5719.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.1145/122344.122377</span>.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/122344.122377" title="">https://doi.org/10.1145/122344.122377</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sutton &amp; Barto (2018)</span>
<span class="ltx_bibblock">
Richard S. Sutton and Andrew G. Barto.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib38.1.1">Reinforcement Learning: An Introduction</em>.

</span>
<span class="ltx_bibblock">A Bradford Book, Cambridge, MA, USA, 2018.

</span>
<span class="ltx_bibblock">ISBN 0262039249.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib39">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tassa et al. (2018)</span>
<span class="ltx_bibblock">
Yuval Tassa, Yotam Doron, Alistair Muldal, Tom Erez, Yazhe Li, Diego de Las Casas, David Budden, Abbas Abdolmaleki, Josh Merel, Andrew Lefrancq, Timothy P. Lillicrap, and Martin A. Riedmiller.

</span>
<span class="ltx_bibblock">Deepmind control suite.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib39.1.1">ArXiv</em>, abs/1801.00690, 2018.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://api.semanticscholar.org/CorpusID:6315299" title="">https://api.semanticscholar.org/CorpusID:6315299</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib40">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wan et al. (2024)</span>
<span class="ltx_bibblock">
Weikang Wan, Yufei Wang, Zackory Erickson, and David Held.

</span>
<span class="ltx_bibblock">Differentiable trajectory optimization as a policy class for reinforcement and imitation learning, 2024.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://openreview.net/forum?id=HL5P4H8eO2" title="">https://openreview.net/forum?id=HL5P4H8eO2</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib41">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang &amp; Ba (2020)</span>
<span class="ltx_bibblock">
Tingwu Wang and Jimmy Ba.

</span>
<span class="ltx_bibblock">Exploring model-based planning with policy networks.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib41.1.1">International Conference on Learning Representations</em>, 2020.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://openreview.net/forum?id=H1exf64KwH" title="">https://openreview.net/forum?id=H1exf64KwH</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib42">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Williams et al. (2016)</span>
<span class="ltx_bibblock">
Grady Williams, Paul Drews, Brian Goldfain, James M. Rehg, and Evangelos A. Theodorou.

</span>
<span class="ltx_bibblock">Aggressive driving with model predictive path integral control.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib42.1.1">2016 IEEE International Conference on Robotics and Automation (ICRA)</em>, pp.  1433–1440, 2016.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.1109/ICRA.2016.7487277</span>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib43">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Williams et al. (2018)</span>
<span class="ltx_bibblock">
Grady Williams, Paul Drews, Brian Goldfain, James M. Rehg, and Evangelos A. Theodorou.

</span>
<span class="ltx_bibblock">Information-theoretic model predictive control: Theory and applications to autonomous driving.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib43.1.1">IEEE Transactions on Robotics</em>, 34(6):1603–1622, 2018.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.1109/TRO.2018.2865891</span>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib44">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yarats et al. (2021)</span>
<span class="ltx_bibblock">
Denis Yarats, Ilya Kostrikov, and Rob Fergus.

</span>
<span class="ltx_bibblock">Image augmentation is all you need: Regularizing deep reinforcement learning from pixels.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib44.1.1">International Conference on Learning Representations</em>, 2021.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://openreview.net/forum?id=GY6-6sTvGaf" title="">https://openreview.net/forum?id=GY6-6sTvGaf</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib45">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yarats et al. (2022)</span>
<span class="ltx_bibblock">
Denis Yarats, Rob Fergus, Alessandro Lazaric, and Lerrel Pinto.

</span>
<span class="ltx_bibblock">Mastering visual continuous control: Improved data-augmented reinforcement learning.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib45.1.1">International Conference on Learning Representations</em>, 2022.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://openreview.net/forum?id=_SJ-_yyes8" title="">https://openreview.net/forum?id=_SJ-_yyes8</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib46">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al. (2018)</span>
<span class="ltx_bibblock">
Amy Zhang, Yuxin Wu, and Joelle Pineau.

</span>
<span class="ltx_bibblock">Natural environment benchmarks for reinforcement learning.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib46.1.1">ArXiv</em>, abs/1811.06032, 2018.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://api.semanticscholar.org/CorpusID:53434808" title="">https://api.semanticscholar.org/CorpusID:53434808</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib47">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al. (2021)</span>
<span class="ltx_bibblock">
Amy Zhang, Rowan Thomas McAllister, Roberto Calandra, Yarin Gal, and Sergey Levine.

</span>
<span class="ltx_bibblock">Learning invariant representations for reinforcement learning without reconstruction.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib47.1.1">International Conference on Learning Representations</em>, 2021.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://openreview.net/forum?id=-2FCwDKRREu" title="">https://openreview.net/forum?id=-2FCwDKRREu</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib48">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhao et al. (2023)</span>
<span class="ltx_bibblock">
Yi Zhao, Wenshuai Zhao, Rinu Boney, Juho Kannala, and Joni Pajarinen.

</span>
<span class="ltx_bibblock">Simplified temporal consistency reinforcement learning.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib48.1.1">Proceedings of the 40th International Conference on Machine Learning</em>, ICML’23. JMLR.org, 2023.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<section class="ltx_appendix" id="A1">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Proof of Theorem <a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#Thmthm3" title="Theorem 3. ‣ 4.2 Theoretical Analysis ‣ 4 Bisimulation metric for model predictive control ‣ Bisimulation metric for Model Predictive Control"><span class="ltx_text ltx_ref_tag">3</span></a>
</h2>
<div class="ltx_para" id="A1.p1">
<p class="ltx_p" id="A1.p1.1">Our proof uses the following Lemma.</p>
</div>
<div class="ltx_theorem ltx_theorem_lem" id="Thmlem1">
<h6 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span class="ltx_text ltx_font_bold" id="Thmlem1.2.1.1">Lemma 1</span></span><span class="ltx_text ltx_font_bold" id="Thmlem1.3.2">.</span>
</h6>
<div class="ltx_para ltx_noindent" id="Thmlem1.p1">
<p class="ltx_p" id="Thmlem1.p1.5">Assume action <math alttext="a" class="ltx_Math" display="inline" id="Thmlem1.p1.1.m1.1"><semantics id="Thmlem1.p1.1.m1.1a"><mi id="Thmlem1.p1.1.m1.1.1" xref="Thmlem1.p1.1.m1.1.1.cmml">a</mi><annotation-xml encoding="MathML-Content" id="Thmlem1.p1.1.m1.1b"><ci id="Thmlem1.p1.1.m1.1.1.cmml" xref="Thmlem1.p1.1.m1.1.1">𝑎</ci></annotation-xml><annotation encoding="application/x-tex" id="Thmlem1.p1.1.m1.1c">a</annotation><annotation encoding="application/x-llamapun" id="Thmlem1.p1.1.m1.1d">italic_a</annotation></semantics></math> is sampled from optimal policy <math alttext="a\sim\pi^{*}(\cdot|s)" class="ltx_math_unparsed" display="inline" id="Thmlem1.p1.2.m2.1"><semantics id="Thmlem1.p1.2.m2.1a"><mrow id="Thmlem1.p1.2.m2.1b"><mi id="Thmlem1.p1.2.m2.1.1">a</mi><mo id="Thmlem1.p1.2.m2.1.2">∼</mo><msup id="Thmlem1.p1.2.m2.1.3"><mi id="Thmlem1.p1.2.m2.1.3.2">π</mi><mo id="Thmlem1.p1.2.m2.1.3.3">∗</mo></msup><mrow id="Thmlem1.p1.2.m2.1.4"><mo id="Thmlem1.p1.2.m2.1.4.1" stretchy="false">(</mo><mo id="Thmlem1.p1.2.m2.1.4.2" lspace="0em" rspace="0em">⋅</mo><mo fence="false" id="Thmlem1.p1.2.m2.1.4.3" rspace="0.167em" stretchy="false">|</mo><mi id="Thmlem1.p1.2.m2.1.4.4">s</mi><mo id="Thmlem1.p1.2.m2.1.4.5" stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="Thmlem1.p1.2.m2.1c">a\sim\pi^{*}(\cdot|s)</annotation><annotation encoding="application/x-llamapun" id="Thmlem1.p1.2.m2.1d">italic_a ∼ italic_π start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ( ⋅ | italic_s )</annotation></semantics></math>.
With the same assumption in Theorem <a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#Thmthm2" title="Theorem 2. ‣ 4.2 Theoretical Analysis ‣ 4 Bisimulation metric for model predictive control ‣ Bisimulation metric for Model Predictive Control"><span class="ltx_text ltx_ref_tag">2</span></a>, the difference between <math alttext="R(s,a)" class="ltx_Math" display="inline" id="Thmlem1.p1.3.m3.2"><semantics id="Thmlem1.p1.3.m3.2a"><mrow id="Thmlem1.p1.3.m3.2.3" xref="Thmlem1.p1.3.m3.2.3.cmml"><mi id="Thmlem1.p1.3.m3.2.3.2" xref="Thmlem1.p1.3.m3.2.3.2.cmml">R</mi><mo id="Thmlem1.p1.3.m3.2.3.1" xref="Thmlem1.p1.3.m3.2.3.1.cmml">⁢</mo><mrow id="Thmlem1.p1.3.m3.2.3.3.2" xref="Thmlem1.p1.3.m3.2.3.3.1.cmml"><mo id="Thmlem1.p1.3.m3.2.3.3.2.1" stretchy="false" xref="Thmlem1.p1.3.m3.2.3.3.1.cmml">(</mo><mi id="Thmlem1.p1.3.m3.1.1" xref="Thmlem1.p1.3.m3.1.1.cmml">s</mi><mo id="Thmlem1.p1.3.m3.2.3.3.2.2" xref="Thmlem1.p1.3.m3.2.3.3.1.cmml">,</mo><mi id="Thmlem1.p1.3.m3.2.2" xref="Thmlem1.p1.3.m3.2.2.cmml">a</mi><mo id="Thmlem1.p1.3.m3.2.3.3.2.3" stretchy="false" xref="Thmlem1.p1.3.m3.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmlem1.p1.3.m3.2b"><apply id="Thmlem1.p1.3.m3.2.3.cmml" xref="Thmlem1.p1.3.m3.2.3"><times id="Thmlem1.p1.3.m3.2.3.1.cmml" xref="Thmlem1.p1.3.m3.2.3.1"></times><ci id="Thmlem1.p1.3.m3.2.3.2.cmml" xref="Thmlem1.p1.3.m3.2.3.2">𝑅</ci><interval closure="open" id="Thmlem1.p1.3.m3.2.3.3.1.cmml" xref="Thmlem1.p1.3.m3.2.3.3.2"><ci id="Thmlem1.p1.3.m3.1.1.cmml" xref="Thmlem1.p1.3.m3.1.1">𝑠</ci><ci id="Thmlem1.p1.3.m3.2.2.cmml" xref="Thmlem1.p1.3.m3.2.2">𝑎</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmlem1.p1.3.m3.2c">R(s,a)</annotation><annotation encoding="application/x-llamapun" id="Thmlem1.p1.3.m3.2d">italic_R ( italic_s , italic_a )</annotation></semantics></math> and <math alttext="R(\phi(s),a)" class="ltx_Math" display="inline" id="Thmlem1.p1.4.m4.3"><semantics id="Thmlem1.p1.4.m4.3a"><mrow id="Thmlem1.p1.4.m4.3.3" xref="Thmlem1.p1.4.m4.3.3.cmml"><mi id="Thmlem1.p1.4.m4.3.3.3" xref="Thmlem1.p1.4.m4.3.3.3.cmml">R</mi><mo id="Thmlem1.p1.4.m4.3.3.2" xref="Thmlem1.p1.4.m4.3.3.2.cmml">⁢</mo><mrow id="Thmlem1.p1.4.m4.3.3.1.1" xref="Thmlem1.p1.4.m4.3.3.1.2.cmml"><mo id="Thmlem1.p1.4.m4.3.3.1.1.2" stretchy="false" xref="Thmlem1.p1.4.m4.3.3.1.2.cmml">(</mo><mrow id="Thmlem1.p1.4.m4.3.3.1.1.1" xref="Thmlem1.p1.4.m4.3.3.1.1.1.cmml"><mi id="Thmlem1.p1.4.m4.3.3.1.1.1.2" xref="Thmlem1.p1.4.m4.3.3.1.1.1.2.cmml">ϕ</mi><mo id="Thmlem1.p1.4.m4.3.3.1.1.1.1" xref="Thmlem1.p1.4.m4.3.3.1.1.1.1.cmml">⁢</mo><mrow id="Thmlem1.p1.4.m4.3.3.1.1.1.3.2" xref="Thmlem1.p1.4.m4.3.3.1.1.1.cmml"><mo id="Thmlem1.p1.4.m4.3.3.1.1.1.3.2.1" stretchy="false" xref="Thmlem1.p1.4.m4.3.3.1.1.1.cmml">(</mo><mi id="Thmlem1.p1.4.m4.1.1" xref="Thmlem1.p1.4.m4.1.1.cmml">s</mi><mo id="Thmlem1.p1.4.m4.3.3.1.1.1.3.2.2" stretchy="false" xref="Thmlem1.p1.4.m4.3.3.1.1.1.cmml">)</mo></mrow></mrow><mo id="Thmlem1.p1.4.m4.3.3.1.1.3" xref="Thmlem1.p1.4.m4.3.3.1.2.cmml">,</mo><mi id="Thmlem1.p1.4.m4.2.2" xref="Thmlem1.p1.4.m4.2.2.cmml">a</mi><mo id="Thmlem1.p1.4.m4.3.3.1.1.4" stretchy="false" xref="Thmlem1.p1.4.m4.3.3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmlem1.p1.4.m4.3b"><apply id="Thmlem1.p1.4.m4.3.3.cmml" xref="Thmlem1.p1.4.m4.3.3"><times id="Thmlem1.p1.4.m4.3.3.2.cmml" xref="Thmlem1.p1.4.m4.3.3.2"></times><ci id="Thmlem1.p1.4.m4.3.3.3.cmml" xref="Thmlem1.p1.4.m4.3.3.3">𝑅</ci><interval closure="open" id="Thmlem1.p1.4.m4.3.3.1.2.cmml" xref="Thmlem1.p1.4.m4.3.3.1.1"><apply id="Thmlem1.p1.4.m4.3.3.1.1.1.cmml" xref="Thmlem1.p1.4.m4.3.3.1.1.1"><times id="Thmlem1.p1.4.m4.3.3.1.1.1.1.cmml" xref="Thmlem1.p1.4.m4.3.3.1.1.1.1"></times><ci id="Thmlem1.p1.4.m4.3.3.1.1.1.2.cmml" xref="Thmlem1.p1.4.m4.3.3.1.1.1.2">italic-ϕ</ci><ci id="Thmlem1.p1.4.m4.1.1.cmml" xref="Thmlem1.p1.4.m4.1.1">𝑠</ci></apply><ci id="Thmlem1.p1.4.m4.2.2.cmml" xref="Thmlem1.p1.4.m4.2.2">𝑎</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmlem1.p1.4.m4.3c">R(\phi(s),a)</annotation><annotation encoding="application/x-llamapun" id="Thmlem1.p1.4.m4.3d">italic_R ( italic_ϕ ( italic_s ) , italic_a )</annotation></semantics></math> under the <math alttext="\pi^{*}" class="ltx_Math" display="inline" id="Thmlem1.p1.5.m5.1"><semantics id="Thmlem1.p1.5.m5.1a"><msup id="Thmlem1.p1.5.m5.1.1" xref="Thmlem1.p1.5.m5.1.1.cmml"><mi id="Thmlem1.p1.5.m5.1.1.2" xref="Thmlem1.p1.5.m5.1.1.2.cmml">π</mi><mo id="Thmlem1.p1.5.m5.1.1.3" xref="Thmlem1.p1.5.m5.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="Thmlem1.p1.5.m5.1b"><apply id="Thmlem1.p1.5.m5.1.1.cmml" xref="Thmlem1.p1.5.m5.1.1"><csymbol cd="ambiguous" id="Thmlem1.p1.5.m5.1.1.1.cmml" xref="Thmlem1.p1.5.m5.1.1">superscript</csymbol><ci id="Thmlem1.p1.5.m5.1.1.2.cmml" xref="Thmlem1.p1.5.m5.1.1.2">𝜋</ci><times id="Thmlem1.p1.5.m5.1.1.3.cmml" xref="Thmlem1.p1.5.m5.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmlem1.p1.5.m5.1c">\pi^{*}</annotation><annotation encoding="application/x-llamapun" id="Thmlem1.p1.5.m5.1d">italic_π start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math>-bisimulation metric has the following upper bound.</p>
<table class="ltx_equation ltx_eqn_table" id="A1.E14">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="(1-c)|R(s,a)-R(\phi(s),a)|\leq 2\epsilon" class="ltx_Math" display="block" id="A1.E14.m1.6"><semantics id="A1.E14.m1.6a"><mrow id="A1.E14.m1.6.6" xref="A1.E14.m1.6.6.cmml"><mrow id="A1.E14.m1.6.6.2" xref="A1.E14.m1.6.6.2.cmml"><mrow id="A1.E14.m1.5.5.1.1.1" xref="A1.E14.m1.5.5.1.1.1.1.cmml"><mo id="A1.E14.m1.5.5.1.1.1.2" stretchy="false" xref="A1.E14.m1.5.5.1.1.1.1.cmml">(</mo><mrow id="A1.E14.m1.5.5.1.1.1.1" xref="A1.E14.m1.5.5.1.1.1.1.cmml"><mn id="A1.E14.m1.5.5.1.1.1.1.2" xref="A1.E14.m1.5.5.1.1.1.1.2.cmml">1</mn><mo id="A1.E14.m1.5.5.1.1.1.1.1" xref="A1.E14.m1.5.5.1.1.1.1.1.cmml">−</mo><mi id="A1.E14.m1.5.5.1.1.1.1.3" xref="A1.E14.m1.5.5.1.1.1.1.3.cmml">c</mi></mrow><mo id="A1.E14.m1.5.5.1.1.1.3" stretchy="false" xref="A1.E14.m1.5.5.1.1.1.1.cmml">)</mo></mrow><mo id="A1.E14.m1.6.6.2.3" xref="A1.E14.m1.6.6.2.3.cmml">⁢</mo><mrow id="A1.E14.m1.6.6.2.2.1" xref="A1.E14.m1.6.6.2.2.2.cmml"><mo id="A1.E14.m1.6.6.2.2.1.2" stretchy="false" xref="A1.E14.m1.6.6.2.2.2.1.cmml">|</mo><mrow id="A1.E14.m1.6.6.2.2.1.1" xref="A1.E14.m1.6.6.2.2.1.1.cmml"><mrow id="A1.E14.m1.6.6.2.2.1.1.3" xref="A1.E14.m1.6.6.2.2.1.1.3.cmml"><mi id="A1.E14.m1.6.6.2.2.1.1.3.2" xref="A1.E14.m1.6.6.2.2.1.1.3.2.cmml">R</mi><mo id="A1.E14.m1.6.6.2.2.1.1.3.1" xref="A1.E14.m1.6.6.2.2.1.1.3.1.cmml">⁢</mo><mrow id="A1.E14.m1.6.6.2.2.1.1.3.3.2" xref="A1.E14.m1.6.6.2.2.1.1.3.3.1.cmml"><mo id="A1.E14.m1.6.6.2.2.1.1.3.3.2.1" stretchy="false" xref="A1.E14.m1.6.6.2.2.1.1.3.3.1.cmml">(</mo><mi id="A1.E14.m1.1.1" xref="A1.E14.m1.1.1.cmml">s</mi><mo id="A1.E14.m1.6.6.2.2.1.1.3.3.2.2" xref="A1.E14.m1.6.6.2.2.1.1.3.3.1.cmml">,</mo><mi id="A1.E14.m1.2.2" xref="A1.E14.m1.2.2.cmml">a</mi><mo id="A1.E14.m1.6.6.2.2.1.1.3.3.2.3" stretchy="false" xref="A1.E14.m1.6.6.2.2.1.1.3.3.1.cmml">)</mo></mrow></mrow><mo id="A1.E14.m1.6.6.2.2.1.1.2" xref="A1.E14.m1.6.6.2.2.1.1.2.cmml">−</mo><mrow id="A1.E14.m1.6.6.2.2.1.1.1" xref="A1.E14.m1.6.6.2.2.1.1.1.cmml"><mi id="A1.E14.m1.6.6.2.2.1.1.1.3" xref="A1.E14.m1.6.6.2.2.1.1.1.3.cmml">R</mi><mo id="A1.E14.m1.6.6.2.2.1.1.1.2" xref="A1.E14.m1.6.6.2.2.1.1.1.2.cmml">⁢</mo><mrow id="A1.E14.m1.6.6.2.2.1.1.1.1.1" xref="A1.E14.m1.6.6.2.2.1.1.1.1.2.cmml"><mo id="A1.E14.m1.6.6.2.2.1.1.1.1.1.2" stretchy="false" xref="A1.E14.m1.6.6.2.2.1.1.1.1.2.cmml">(</mo><mrow id="A1.E14.m1.6.6.2.2.1.1.1.1.1.1" xref="A1.E14.m1.6.6.2.2.1.1.1.1.1.1.cmml"><mi id="A1.E14.m1.6.6.2.2.1.1.1.1.1.1.2" xref="A1.E14.m1.6.6.2.2.1.1.1.1.1.1.2.cmml">ϕ</mi><mo id="A1.E14.m1.6.6.2.2.1.1.1.1.1.1.1" xref="A1.E14.m1.6.6.2.2.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="A1.E14.m1.6.6.2.2.1.1.1.1.1.1.3.2" xref="A1.E14.m1.6.6.2.2.1.1.1.1.1.1.cmml"><mo id="A1.E14.m1.6.6.2.2.1.1.1.1.1.1.3.2.1" stretchy="false" xref="A1.E14.m1.6.6.2.2.1.1.1.1.1.1.cmml">(</mo><mi id="A1.E14.m1.3.3" xref="A1.E14.m1.3.3.cmml">s</mi><mo id="A1.E14.m1.6.6.2.2.1.1.1.1.1.1.3.2.2" stretchy="false" xref="A1.E14.m1.6.6.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E14.m1.6.6.2.2.1.1.1.1.1.3" xref="A1.E14.m1.6.6.2.2.1.1.1.1.2.cmml">,</mo><mi id="A1.E14.m1.4.4" xref="A1.E14.m1.4.4.cmml">a</mi><mo id="A1.E14.m1.6.6.2.2.1.1.1.1.1.4" stretchy="false" xref="A1.E14.m1.6.6.2.2.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="A1.E14.m1.6.6.2.2.1.3" stretchy="false" xref="A1.E14.m1.6.6.2.2.2.1.cmml">|</mo></mrow></mrow><mo id="A1.E14.m1.6.6.3" xref="A1.E14.m1.6.6.3.cmml">≤</mo><mrow id="A1.E14.m1.6.6.4" xref="A1.E14.m1.6.6.4.cmml"><mn id="A1.E14.m1.6.6.4.2" xref="A1.E14.m1.6.6.4.2.cmml">2</mn><mo id="A1.E14.m1.6.6.4.1" xref="A1.E14.m1.6.6.4.1.cmml">⁢</mo><mi id="A1.E14.m1.6.6.4.3" xref="A1.E14.m1.6.6.4.3.cmml">ϵ</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E14.m1.6b"><apply id="A1.E14.m1.6.6.cmml" xref="A1.E14.m1.6.6"><leq id="A1.E14.m1.6.6.3.cmml" xref="A1.E14.m1.6.6.3"></leq><apply id="A1.E14.m1.6.6.2.cmml" xref="A1.E14.m1.6.6.2"><times id="A1.E14.m1.6.6.2.3.cmml" xref="A1.E14.m1.6.6.2.3"></times><apply id="A1.E14.m1.5.5.1.1.1.1.cmml" xref="A1.E14.m1.5.5.1.1.1"><minus id="A1.E14.m1.5.5.1.1.1.1.1.cmml" xref="A1.E14.m1.5.5.1.1.1.1.1"></minus><cn id="A1.E14.m1.5.5.1.1.1.1.2.cmml" type="integer" xref="A1.E14.m1.5.5.1.1.1.1.2">1</cn><ci id="A1.E14.m1.5.5.1.1.1.1.3.cmml" xref="A1.E14.m1.5.5.1.1.1.1.3">𝑐</ci></apply><apply id="A1.E14.m1.6.6.2.2.2.cmml" xref="A1.E14.m1.6.6.2.2.1"><abs id="A1.E14.m1.6.6.2.2.2.1.cmml" xref="A1.E14.m1.6.6.2.2.1.2"></abs><apply id="A1.E14.m1.6.6.2.2.1.1.cmml" xref="A1.E14.m1.6.6.2.2.1.1"><minus id="A1.E14.m1.6.6.2.2.1.1.2.cmml" xref="A1.E14.m1.6.6.2.2.1.1.2"></minus><apply id="A1.E14.m1.6.6.2.2.1.1.3.cmml" xref="A1.E14.m1.6.6.2.2.1.1.3"><times id="A1.E14.m1.6.6.2.2.1.1.3.1.cmml" xref="A1.E14.m1.6.6.2.2.1.1.3.1"></times><ci id="A1.E14.m1.6.6.2.2.1.1.3.2.cmml" xref="A1.E14.m1.6.6.2.2.1.1.3.2">𝑅</ci><interval closure="open" id="A1.E14.m1.6.6.2.2.1.1.3.3.1.cmml" xref="A1.E14.m1.6.6.2.2.1.1.3.3.2"><ci id="A1.E14.m1.1.1.cmml" xref="A1.E14.m1.1.1">𝑠</ci><ci id="A1.E14.m1.2.2.cmml" xref="A1.E14.m1.2.2">𝑎</ci></interval></apply><apply id="A1.E14.m1.6.6.2.2.1.1.1.cmml" xref="A1.E14.m1.6.6.2.2.1.1.1"><times id="A1.E14.m1.6.6.2.2.1.1.1.2.cmml" xref="A1.E14.m1.6.6.2.2.1.1.1.2"></times><ci id="A1.E14.m1.6.6.2.2.1.1.1.3.cmml" xref="A1.E14.m1.6.6.2.2.1.1.1.3">𝑅</ci><interval closure="open" id="A1.E14.m1.6.6.2.2.1.1.1.1.2.cmml" xref="A1.E14.m1.6.6.2.2.1.1.1.1.1"><apply id="A1.E14.m1.6.6.2.2.1.1.1.1.1.1.cmml" xref="A1.E14.m1.6.6.2.2.1.1.1.1.1.1"><times id="A1.E14.m1.6.6.2.2.1.1.1.1.1.1.1.cmml" xref="A1.E14.m1.6.6.2.2.1.1.1.1.1.1.1"></times><ci id="A1.E14.m1.6.6.2.2.1.1.1.1.1.1.2.cmml" xref="A1.E14.m1.6.6.2.2.1.1.1.1.1.1.2">italic-ϕ</ci><ci id="A1.E14.m1.3.3.cmml" xref="A1.E14.m1.3.3">𝑠</ci></apply><ci id="A1.E14.m1.4.4.cmml" xref="A1.E14.m1.4.4">𝑎</ci></interval></apply></apply></apply></apply><apply id="A1.E14.m1.6.6.4.cmml" xref="A1.E14.m1.6.6.4"><times id="A1.E14.m1.6.6.4.1.cmml" xref="A1.E14.m1.6.6.4.1"></times><cn id="A1.E14.m1.6.6.4.2.cmml" type="integer" xref="A1.E14.m1.6.6.4.2">2</cn><ci id="A1.E14.m1.6.6.4.3.cmml" xref="A1.E14.m1.6.6.4.3">italic-ϵ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E14.m1.6c">(1-c)|R(s,a)-R(\phi(s),a)|\leq 2\epsilon</annotation><annotation encoding="application/x-llamapun" id="A1.E14.m1.6d">( 1 - italic_c ) | italic_R ( italic_s , italic_a ) - italic_R ( italic_ϕ ( italic_s ) , italic_a ) | ≤ 2 italic_ϵ</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(14)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_proof" id="Thmlem1.1">
<h6 class="ltx_title ltx_runin ltx_font_italic ltx_title_proof">Proof.</h6>
<div class="ltx_para" id="Thmlem1.1.p1">
<p class="ltx_p" id="Thmlem1.1.p1.1">From Theorem <a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#Thmthm1" title="Theorem 1. ‣ 4.2 Theoretical Analysis ‣ 4 Bisimulation metric for model predictive control ‣ Bisimulation metric for Model Predictive Control"><span class="ltx_text ltx_ref_tag">1</span></a>, the fixed point <math alttext="\tilde{d}" class="ltx_Math" display="inline" id="Thmlem1.1.p1.1.m1.1"><semantics id="Thmlem1.1.p1.1.m1.1a"><mover accent="true" id="Thmlem1.1.p1.1.m1.1.1" xref="Thmlem1.1.p1.1.m1.1.1.cmml"><mi id="Thmlem1.1.p1.1.m1.1.1.2" xref="Thmlem1.1.p1.1.m1.1.1.2.cmml">d</mi><mo id="Thmlem1.1.p1.1.m1.1.1.1" xref="Thmlem1.1.p1.1.m1.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="Thmlem1.1.p1.1.m1.1b"><apply id="Thmlem1.1.p1.1.m1.1.1.cmml" xref="Thmlem1.1.p1.1.m1.1.1"><ci id="Thmlem1.1.p1.1.m1.1.1.1.cmml" xref="Thmlem1.1.p1.1.m1.1.1.1">~</ci><ci id="Thmlem1.1.p1.1.m1.1.1.2.cmml" xref="Thmlem1.1.p1.1.m1.1.1.2">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmlem1.1.p1.1.m1.1c">\tilde{d}</annotation><annotation encoding="application/x-llamapun" id="Thmlem1.1.p1.1.m1.1d">over~ start_ARG italic_d end_ARG</annotation></semantics></math> satisfies</p>
<table class="ltx_equation ltx_eqn_table" id="A1.E15">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\tilde{d}(s,\phi(s))=(1-c)|R(s,a)-R(\phi(s),a)|+cW_{p}(d)(\mathcal{P}^{\pi^{*}%
}(\cdot|s_{i}),\mathcal{P}^{\pi^{*}}(\cdot|s_{j}))." class="ltx_math_unparsed" display="block" id="A1.E15.m1.7"><semantics id="A1.E15.m1.7a"><mrow id="A1.E15.m1.7b"><mover accent="true" id="A1.E15.m1.7.8"><mi id="A1.E15.m1.7.8.2">d</mi><mo id="A1.E15.m1.7.8.1">~</mo></mover><mrow id="A1.E15.m1.7.9"><mo id="A1.E15.m1.7.9.1" stretchy="false">(</mo><mi id="A1.E15.m1.2.2">s</mi><mo id="A1.E15.m1.7.9.2">,</mo><mi id="A1.E15.m1.7.9.3">ϕ</mi><mrow id="A1.E15.m1.7.9.4"><mo id="A1.E15.m1.7.9.4.1" stretchy="false">(</mo><mi id="A1.E15.m1.1.1">s</mi><mo id="A1.E15.m1.7.9.4.2" stretchy="false">)</mo></mrow><mo id="A1.E15.m1.7.9.5" stretchy="false">)</mo></mrow><mo id="A1.E15.m1.7.10">=</mo><mrow id="A1.E15.m1.7.11"><mo id="A1.E15.m1.7.11.1" stretchy="false">(</mo><mn id="A1.E15.m1.7.11.2">1</mn><mo id="A1.E15.m1.7.11.3">−</mo><mi id="A1.E15.m1.7.11.4">c</mi><mo id="A1.E15.m1.7.11.5" stretchy="false">)</mo></mrow><mo fence="false" id="A1.E15.m1.7.12" rspace="0.167em" stretchy="false">|</mo><mi id="A1.E15.m1.7.13">R</mi><mrow id="A1.E15.m1.7.14"><mo id="A1.E15.m1.7.14.1" stretchy="false">(</mo><mi id="A1.E15.m1.3.3">s</mi><mo id="A1.E15.m1.7.14.2">,</mo><mi id="A1.E15.m1.4.4">a</mi><mo id="A1.E15.m1.7.14.3" stretchy="false">)</mo></mrow><mo id="A1.E15.m1.7.15">−</mo><mi id="A1.E15.m1.7.16">R</mi><mrow id="A1.E15.m1.7.17"><mo id="A1.E15.m1.7.17.1" stretchy="false">(</mo><mi id="A1.E15.m1.7.17.2">ϕ</mi><mrow id="A1.E15.m1.7.17.3"><mo id="A1.E15.m1.7.17.3.1" stretchy="false">(</mo><mi id="A1.E15.m1.5.5">s</mi><mo id="A1.E15.m1.7.17.3.2" stretchy="false">)</mo></mrow><mo id="A1.E15.m1.7.17.4">,</mo><mi id="A1.E15.m1.6.6">a</mi><mo id="A1.E15.m1.7.17.5" stretchy="false">)</mo></mrow><mo fence="false" id="A1.E15.m1.7.18" stretchy="false">|</mo><mo id="A1.E15.m1.7.19" lspace="0em">+</mo><mi id="A1.E15.m1.7.20">c</mi><msub id="A1.E15.m1.7.21"><mi id="A1.E15.m1.7.21.2">W</mi><mi id="A1.E15.m1.7.21.3">p</mi></msub><mrow id="A1.E15.m1.7.22"><mo id="A1.E15.m1.7.22.1" stretchy="false">(</mo><mi id="A1.E15.m1.7.7">d</mi><mo id="A1.E15.m1.7.22.2" stretchy="false">)</mo></mrow><mrow id="A1.E15.m1.7.23"><mo id="A1.E15.m1.7.23.1" stretchy="false">(</mo><msup id="A1.E15.m1.7.23.2"><mi class="ltx_font_mathcaligraphic" id="A1.E15.m1.7.23.2.2">𝒫</mi><msup id="A1.E15.m1.7.23.2.3"><mi id="A1.E15.m1.7.23.2.3.2">π</mi><mo id="A1.E15.m1.7.23.2.3.3">∗</mo></msup></msup><mrow id="A1.E15.m1.7.23.3"><mo id="A1.E15.m1.7.23.3.1" stretchy="false">(</mo><mo id="A1.E15.m1.7.23.3.2" lspace="0em" rspace="0em">⋅</mo><mo fence="false" id="A1.E15.m1.7.23.3.3" rspace="0.167em" stretchy="false">|</mo><msub id="A1.E15.m1.7.23.3.4"><mi id="A1.E15.m1.7.23.3.4.2">s</mi><mi id="A1.E15.m1.7.23.3.4.3">i</mi></msub><mo id="A1.E15.m1.7.23.3.5" stretchy="false">)</mo></mrow><mo id="A1.E15.m1.7.23.4">,</mo><msup id="A1.E15.m1.7.23.5"><mi class="ltx_font_mathcaligraphic" id="A1.E15.m1.7.23.5.2">𝒫</mi><msup id="A1.E15.m1.7.23.5.3"><mi id="A1.E15.m1.7.23.5.3.2">π</mi><mo id="A1.E15.m1.7.23.5.3.3">∗</mo></msup></msup><mrow id="A1.E15.m1.7.23.6"><mo id="A1.E15.m1.7.23.6.1" stretchy="false">(</mo><mo id="A1.E15.m1.7.23.6.2" lspace="0em" rspace="0em">⋅</mo><mo fence="false" id="A1.E15.m1.7.23.6.3" rspace="0.167em" stretchy="false">|</mo><msub id="A1.E15.m1.7.23.6.4"><mi id="A1.E15.m1.7.23.6.4.2">s</mi><mi id="A1.E15.m1.7.23.6.4.3">j</mi></msub><mo id="A1.E15.m1.7.23.6.5" stretchy="false">)</mo></mrow><mo id="A1.E15.m1.7.23.7" stretchy="false">)</mo></mrow><mo id="A1.E15.m1.7.24" lspace="0em">.</mo></mrow><annotation encoding="application/x-tex" id="A1.E15.m1.7c">\tilde{d}(s,\phi(s))=(1-c)|R(s,a)-R(\phi(s),a)|+cW_{p}(d)(\mathcal{P}^{\pi^{*}%
}(\cdot|s_{i}),\mathcal{P}^{\pi^{*}}(\cdot|s_{j})).</annotation><annotation encoding="application/x-llamapun" id="A1.E15.m1.7d">over~ start_ARG italic_d end_ARG ( italic_s , italic_ϕ ( italic_s ) ) = ( 1 - italic_c ) | italic_R ( italic_s , italic_a ) - italic_R ( italic_ϕ ( italic_s ) , italic_a ) | + italic_c italic_W start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ( italic_d ) ( caligraphic_P start_POSTSUPERSCRIPT italic_π start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT end_POSTSUPERSCRIPT ( ⋅ | italic_s start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) , caligraphic_P start_POSTSUPERSCRIPT italic_π start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT end_POSTSUPERSCRIPT ( ⋅ | italic_s start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(15)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="Thmlem1.1.p1.2">Since the second term is always positive, we can get</p>
<table class="ltx_equation ltx_eqn_table" id="A1.E16">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\begin{split}(1-c)|R(s,a)-R(\phi(s),a)|&amp;\leq\tilde{d}(s,\phi(s))\\
&amp;\leq 2\epsilon\end{split}" class="ltx_Math" display="block" id="A1.E16.m1.42"><semantics id="A1.E16.m1.42a"><mtable columnspacing="0pt" displaystyle="true" id="A1.E16.m1.42.42.6" rowspacing="0pt" xref="A1.E16.m1.39.39.3.cmml"><mtr id="A1.E16.m1.42.42.6a" xref="A1.E16.m1.39.39.3.cmml"><mtd class="ltx_align_right" columnalign="right" id="A1.E16.m1.42.42.6b" xref="A1.E16.m1.39.39.3.cmml"><mrow id="A1.E16.m1.41.41.5.38.35.25" xref="A1.E16.m1.39.39.3.cmml"><mrow id="A1.E16.m1.40.40.4.37.34.24.24.1" xref="A1.E16.m1.39.39.3.cmml"><mo id="A1.E16.m1.1.1.1.1.1.1" stretchy="false" xref="A1.E16.m1.39.39.3a.cmml">(</mo><mrow id="A1.E16.m1.40.40.4.37.34.24.24.1.1" xref="A1.E16.m1.39.39.3.cmml"><mn id="A1.E16.m1.2.2.2.2.2.2" xref="A1.E16.m1.2.2.2.2.2.2.cmml">1</mn><mo id="A1.E16.m1.3.3.3.3.3.3" xref="A1.E16.m1.3.3.3.3.3.3.cmml">−</mo><mi id="A1.E16.m1.4.4.4.4.4.4" xref="A1.E16.m1.4.4.4.4.4.4.cmml">c</mi></mrow><mo id="A1.E16.m1.5.5.5.5.5.5" stretchy="false" xref="A1.E16.m1.39.39.3a.cmml">)</mo></mrow><mo id="A1.E16.m1.41.41.5.38.35.25.26" xref="A1.E16.m1.39.39.3a.cmml">⁢</mo><mrow id="A1.E16.m1.41.41.5.38.35.25.25.1" xref="A1.E16.m1.39.39.3.cmml"><mo id="A1.E16.m1.6.6.6.6.6.6" stretchy="false" xref="A1.E16.m1.39.39.3a.cmml">|</mo><mrow id="A1.E16.m1.41.41.5.38.35.25.25.1.1" xref="A1.E16.m1.39.39.3.cmml"><mrow id="A1.E16.m1.41.41.5.38.35.25.25.1.1.2" xref="A1.E16.m1.39.39.3.cmml"><mi id="A1.E16.m1.7.7.7.7.7.7" xref="A1.E16.m1.7.7.7.7.7.7.cmml">R</mi><mo id="A1.E16.m1.41.41.5.38.35.25.25.1.1.2.1" xref="A1.E16.m1.39.39.3a.cmml">⁢</mo><mrow id="A1.E16.m1.41.41.5.38.35.25.25.1.1.2.2" xref="A1.E16.m1.39.39.3.cmml"><mo id="A1.E16.m1.8.8.8.8.8.8" stretchy="false" xref="A1.E16.m1.39.39.3a.cmml">(</mo><mi id="A1.E16.m1.9.9.9.9.9.9" xref="A1.E16.m1.9.9.9.9.9.9.cmml">s</mi><mo id="A1.E16.m1.10.10.10.10.10.10" xref="A1.E16.m1.39.39.3a.cmml">,</mo><mi id="A1.E16.m1.11.11.11.11.11.11" xref="A1.E16.m1.11.11.11.11.11.11.cmml">a</mi><mo id="A1.E16.m1.12.12.12.12.12.12" stretchy="false" xref="A1.E16.m1.39.39.3a.cmml">)</mo></mrow></mrow><mo id="A1.E16.m1.13.13.13.13.13.13" xref="A1.E16.m1.13.13.13.13.13.13.cmml">−</mo><mrow id="A1.E16.m1.41.41.5.38.35.25.25.1.1.1" xref="A1.E16.m1.39.39.3.cmml"><mi id="A1.E16.m1.14.14.14.14.14.14" xref="A1.E16.m1.14.14.14.14.14.14.cmml">R</mi><mo id="A1.E16.m1.41.41.5.38.35.25.25.1.1.1.2" xref="A1.E16.m1.39.39.3a.cmml">⁢</mo><mrow id="A1.E16.m1.41.41.5.38.35.25.25.1.1.1.1.1" xref="A1.E16.m1.39.39.3.cmml"><mo id="A1.E16.m1.15.15.15.15.15.15" stretchy="false" xref="A1.E16.m1.39.39.3a.cmml">(</mo><mrow id="A1.E16.m1.41.41.5.38.35.25.25.1.1.1.1.1.1" xref="A1.E16.m1.39.39.3.cmml"><mi id="A1.E16.m1.16.16.16.16.16.16" xref="A1.E16.m1.16.16.16.16.16.16.cmml">ϕ</mi><mo id="A1.E16.m1.41.41.5.38.35.25.25.1.1.1.1.1.1.1" xref="A1.E16.m1.39.39.3a.cmml">⁢</mo><mrow id="A1.E16.m1.41.41.5.38.35.25.25.1.1.1.1.1.1.2" xref="A1.E16.m1.39.39.3.cmml"><mo id="A1.E16.m1.17.17.17.17.17.17" stretchy="false" xref="A1.E16.m1.39.39.3a.cmml">(</mo><mi id="A1.E16.m1.18.18.18.18.18.18" xref="A1.E16.m1.18.18.18.18.18.18.cmml">s</mi><mo id="A1.E16.m1.19.19.19.19.19.19" stretchy="false" xref="A1.E16.m1.39.39.3a.cmml">)</mo></mrow></mrow><mo id="A1.E16.m1.20.20.20.20.20.20" xref="A1.E16.m1.39.39.3a.cmml">,</mo><mi id="A1.E16.m1.21.21.21.21.21.21" xref="A1.E16.m1.21.21.21.21.21.21.cmml">a</mi><mo id="A1.E16.m1.22.22.22.22.22.22" stretchy="false" xref="A1.E16.m1.39.39.3a.cmml">)</mo></mrow></mrow></mrow><mo id="A1.E16.m1.23.23.23.23.23.23" stretchy="false" xref="A1.E16.m1.39.39.3a.cmml">|</mo></mrow></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="A1.E16.m1.42.42.6c" xref="A1.E16.m1.39.39.3.cmml"><mrow id="A1.E16.m1.42.42.6.39.36.11" xref="A1.E16.m1.39.39.3.cmml"><mi id="A1.E16.m1.42.42.6.39.36.11.12" xref="A1.E16.m1.39.39.3a.cmml"></mi><mo id="A1.E16.m1.24.24.24.24.1.1" xref="A1.E16.m1.24.24.24.24.1.1.cmml">≤</mo><mrow id="A1.E16.m1.42.42.6.39.36.11.11" xref="A1.E16.m1.39.39.3.cmml"><mover accent="true" id="A1.E16.m1.25.25.25.25.2.2" xref="A1.E16.m1.25.25.25.25.2.2.cmml"><mi id="A1.E16.m1.25.25.25.25.2.2.2" xref="A1.E16.m1.25.25.25.25.2.2.2.cmml">d</mi><mo id="A1.E16.m1.25.25.25.25.2.2.1" xref="A1.E16.m1.25.25.25.25.2.2.1.cmml">~</mo></mover><mo id="A1.E16.m1.42.42.6.39.36.11.11.2" xref="A1.E16.m1.39.39.3a.cmml">⁢</mo><mrow id="A1.E16.m1.42.42.6.39.36.11.11.1.1" xref="A1.E16.m1.39.39.3.cmml"><mo id="A1.E16.m1.26.26.26.26.3.3" stretchy="false" xref="A1.E16.m1.39.39.3a.cmml">(</mo><mi id="A1.E16.m1.27.27.27.27.4.4" xref="A1.E16.m1.27.27.27.27.4.4.cmml">s</mi><mo id="A1.E16.m1.28.28.28.28.5.5" xref="A1.E16.m1.39.39.3a.cmml">,</mo><mrow id="A1.E16.m1.42.42.6.39.36.11.11.1.1.1" xref="A1.E16.m1.39.39.3.cmml"><mi id="A1.E16.m1.29.29.29.29.6.6" xref="A1.E16.m1.29.29.29.29.6.6.cmml">ϕ</mi><mo id="A1.E16.m1.42.42.6.39.36.11.11.1.1.1.1" xref="A1.E16.m1.39.39.3a.cmml">⁢</mo><mrow id="A1.E16.m1.42.42.6.39.36.11.11.1.1.1.2" xref="A1.E16.m1.39.39.3.cmml"><mo id="A1.E16.m1.30.30.30.30.7.7" stretchy="false" xref="A1.E16.m1.39.39.3a.cmml">(</mo><mi id="A1.E16.m1.31.31.31.31.8.8" xref="A1.E16.m1.31.31.31.31.8.8.cmml">s</mi><mo id="A1.E16.m1.32.32.32.32.9.9" stretchy="false" xref="A1.E16.m1.39.39.3a.cmml">)</mo></mrow></mrow><mo id="A1.E16.m1.33.33.33.33.10.10" stretchy="false" xref="A1.E16.m1.39.39.3a.cmml">)</mo></mrow></mrow></mrow></mtd></mtr><mtr id="A1.E16.m1.42.42.6d" xref="A1.E16.m1.39.39.3.cmml"><mtd id="A1.E16.m1.42.42.6e" xref="A1.E16.m1.39.39.3a.cmml"></mtd><mtd class="ltx_align_left" columnalign="left" id="A1.E16.m1.42.42.6f" xref="A1.E16.m1.39.39.3.cmml"><mrow id="A1.E16.m1.36.36.36.3.3" xref="A1.E16.m1.39.39.3.cmml"><mi id="A1.E16.m1.36.36.36.3.3.4" xref="A1.E16.m1.39.39.3a.cmml"></mi><mo id="A1.E16.m1.34.34.34.1.1.1" xref="A1.E16.m1.34.34.34.1.1.1.cmml">≤</mo><mrow id="A1.E16.m1.36.36.36.3.3.5" xref="A1.E16.m1.39.39.3.cmml"><mn id="A1.E16.m1.35.35.35.2.2.2" xref="A1.E16.m1.35.35.35.2.2.2.cmml">2</mn><mo id="A1.E16.m1.36.36.36.3.3.5.1" xref="A1.E16.m1.39.39.3a.cmml">⁢</mo><mi id="A1.E16.m1.36.36.36.3.3.3" xref="A1.E16.m1.36.36.36.3.3.3.cmml">ϵ</mi></mrow></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="A1.E16.m1.42b"><apply id="A1.E16.m1.39.39.3.cmml" xref="A1.E16.m1.42.42.6"><and id="A1.E16.m1.39.39.3a.cmml" xref="A1.E16.m1.1.1.1.1.1.1"></and><apply id="A1.E16.m1.39.39.3b.cmml" xref="A1.E16.m1.42.42.6"><leq id="A1.E16.m1.24.24.24.24.1.1.cmml" xref="A1.E16.m1.24.24.24.24.1.1"></leq><apply id="A1.E16.m1.38.38.2.2.cmml" xref="A1.E16.m1.42.42.6"><times id="A1.E16.m1.38.38.2.2.3.cmml" xref="A1.E16.m1.1.1.1.1.1.1"></times><apply id="A1.E16.m1.37.37.1.1.1.1.1.cmml" xref="A1.E16.m1.42.42.6"><minus id="A1.E16.m1.3.3.3.3.3.3.cmml" xref="A1.E16.m1.3.3.3.3.3.3"></minus><cn id="A1.E16.m1.2.2.2.2.2.2.cmml" type="integer" xref="A1.E16.m1.2.2.2.2.2.2">1</cn><ci id="A1.E16.m1.4.4.4.4.4.4.cmml" xref="A1.E16.m1.4.4.4.4.4.4">𝑐</ci></apply><apply id="A1.E16.m1.38.38.2.2.2.2.cmml" xref="A1.E16.m1.42.42.6"><abs id="A1.E16.m1.38.38.2.2.2.2.1.cmml" xref="A1.E16.m1.42.42.6"></abs><apply id="A1.E16.m1.38.38.2.2.2.1.1.cmml" xref="A1.E16.m1.42.42.6"><minus id="A1.E16.m1.13.13.13.13.13.13.cmml" xref="A1.E16.m1.13.13.13.13.13.13"></minus><apply id="A1.E16.m1.38.38.2.2.2.1.1.3.cmml" xref="A1.E16.m1.42.42.6"><times id="A1.E16.m1.38.38.2.2.2.1.1.3.1.cmml" xref="A1.E16.m1.42.42.6"></times><ci id="A1.E16.m1.7.7.7.7.7.7.cmml" xref="A1.E16.m1.7.7.7.7.7.7">𝑅</ci><interval closure="open" id="A1.E16.m1.38.38.2.2.2.1.1.3.3.cmml" xref="A1.E16.m1.42.42.6"><ci id="A1.E16.m1.9.9.9.9.9.9.cmml" xref="A1.E16.m1.9.9.9.9.9.9">𝑠</ci><ci id="A1.E16.m1.11.11.11.11.11.11.cmml" xref="A1.E16.m1.11.11.11.11.11.11">𝑎</ci></interval></apply><apply id="A1.E16.m1.38.38.2.2.2.1.1.1.cmml" xref="A1.E16.m1.42.42.6"><times id="A1.E16.m1.38.38.2.2.2.1.1.1.2.cmml" xref="A1.E16.m1.42.42.6"></times><ci id="A1.E16.m1.14.14.14.14.14.14.cmml" xref="A1.E16.m1.14.14.14.14.14.14">𝑅</ci><interval closure="open" id="A1.E16.m1.38.38.2.2.2.1.1.1.1.2.cmml" xref="A1.E16.m1.42.42.6"><apply id="A1.E16.m1.38.38.2.2.2.1.1.1.1.1.1.cmml" xref="A1.E16.m1.42.42.6"><times id="A1.E16.m1.38.38.2.2.2.1.1.1.1.1.1.1.cmml" xref="A1.E16.m1.42.42.6"></times><ci id="A1.E16.m1.16.16.16.16.16.16.cmml" xref="A1.E16.m1.16.16.16.16.16.16">italic-ϕ</ci><ci id="A1.E16.m1.18.18.18.18.18.18.cmml" xref="A1.E16.m1.18.18.18.18.18.18">𝑠</ci></apply><ci id="A1.E16.m1.21.21.21.21.21.21.cmml" xref="A1.E16.m1.21.21.21.21.21.21">𝑎</ci></interval></apply></apply></apply></apply><apply id="A1.E16.m1.39.39.3.3.cmml" xref="A1.E16.m1.42.42.6"><times id="A1.E16.m1.39.39.3.3.2.cmml" xref="A1.E16.m1.1.1.1.1.1.1"></times><apply id="A1.E16.m1.25.25.25.25.2.2.cmml" xref="A1.E16.m1.25.25.25.25.2.2"><ci id="A1.E16.m1.25.25.25.25.2.2.1.cmml" xref="A1.E16.m1.25.25.25.25.2.2.1">~</ci><ci id="A1.E16.m1.25.25.25.25.2.2.2.cmml" xref="A1.E16.m1.25.25.25.25.2.2.2">𝑑</ci></apply><interval closure="open" id="A1.E16.m1.39.39.3.3.1.2.cmml" xref="A1.E16.m1.42.42.6"><ci id="A1.E16.m1.27.27.27.27.4.4.cmml" xref="A1.E16.m1.27.27.27.27.4.4">𝑠</ci><apply id="A1.E16.m1.39.39.3.3.1.1.1.cmml" xref="A1.E16.m1.42.42.6"><times id="A1.E16.m1.39.39.3.3.1.1.1.1.cmml" xref="A1.E16.m1.42.42.6"></times><ci id="A1.E16.m1.29.29.29.29.6.6.cmml" xref="A1.E16.m1.29.29.29.29.6.6">italic-ϕ</ci><ci id="A1.E16.m1.31.31.31.31.8.8.cmml" xref="A1.E16.m1.31.31.31.31.8.8">𝑠</ci></apply></interval></apply></apply><apply id="A1.E16.m1.39.39.3c.cmml" xref="A1.E16.m1.42.42.6"><leq id="A1.E16.m1.34.34.34.1.1.1.cmml" xref="A1.E16.m1.34.34.34.1.1.1"></leq><share href="https://arxiv.org/html/2410.04553v1#A1.E16.m1.39.39.3.3.cmml" id="A1.E16.m1.39.39.3d.cmml" xref="A1.E16.m1.1.1.1.1.1.1"></share><apply id="A1.E16.m1.39.39.3.7.cmml" xref="A1.E16.m1.42.42.6"><times id="A1.E16.m1.39.39.3.7.1.cmml" xref="A1.E16.m1.1.1.1.1.1.1"></times><cn id="A1.E16.m1.35.35.35.2.2.2.cmml" type="integer" xref="A1.E16.m1.35.35.35.2.2.2">2</cn><ci id="A1.E16.m1.36.36.36.3.3.3.cmml" xref="A1.E16.m1.36.36.36.3.3.3">italic-ϵ</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E16.m1.42c">\begin{split}(1-c)|R(s,a)-R(\phi(s),a)|&amp;\leq\tilde{d}(s,\phi(s))\\
&amp;\leq 2\epsilon\end{split}</annotation><annotation encoding="application/x-llamapun" id="A1.E16.m1.42d">start_ROW start_CELL ( 1 - italic_c ) | italic_R ( italic_s , italic_a ) - italic_R ( italic_ϕ ( italic_s ) , italic_a ) | end_CELL start_CELL ≤ over~ start_ARG italic_d end_ARG ( italic_s , italic_ϕ ( italic_s ) ) end_CELL end_ROW start_ROW start_CELL end_CELL start_CELL ≤ 2 italic_ϵ end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(16)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="Thmlem1.1.p1.3">∎</p>
</div>
</div>
</div>
<div class="ltx_theorem ltx_theorem_thm" id="Thmthm3a">
<h6 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span class="ltx_text ltx_font_bold" id="Thmthm3a.1.1.1">Theorem 3</span></span><span class="ltx_text ltx_font_bold" id="Thmthm3a.2.2">.</span>
</h6>
<div class="ltx_para" id="Thmthm3a.p1">
<p class="ltx_p" id="Thmthm3a.p1.8">Consider a trajectory <math alttext="\tau=(s_{0},a_{0},s_{1},a_{1},\dots,a_{H-1},s_{H})" class="ltx_Math" display="inline" id="Thmthm3a.p1.1.m1.7"><semantics id="Thmthm3a.p1.1.m1.7a"><mrow id="Thmthm3a.p1.1.m1.7.7" xref="Thmthm3a.p1.1.m1.7.7.cmml"><mi id="Thmthm3a.p1.1.m1.7.7.8" xref="Thmthm3a.p1.1.m1.7.7.8.cmml">τ</mi><mo id="Thmthm3a.p1.1.m1.7.7.7" xref="Thmthm3a.p1.1.m1.7.7.7.cmml">=</mo><mrow id="Thmthm3a.p1.1.m1.7.7.6.6" xref="Thmthm3a.p1.1.m1.7.7.6.7.cmml"><mo id="Thmthm3a.p1.1.m1.7.7.6.6.7" stretchy="false" xref="Thmthm3a.p1.1.m1.7.7.6.7.cmml">(</mo><msub id="Thmthm3a.p1.1.m1.2.2.1.1.1" xref="Thmthm3a.p1.1.m1.2.2.1.1.1.cmml"><mi id="Thmthm3a.p1.1.m1.2.2.1.1.1.2" xref="Thmthm3a.p1.1.m1.2.2.1.1.1.2.cmml">s</mi><mn id="Thmthm3a.p1.1.m1.2.2.1.1.1.3" xref="Thmthm3a.p1.1.m1.2.2.1.1.1.3.cmml">0</mn></msub><mo id="Thmthm3a.p1.1.m1.7.7.6.6.8" xref="Thmthm3a.p1.1.m1.7.7.6.7.cmml">,</mo><msub id="Thmthm3a.p1.1.m1.3.3.2.2.2" xref="Thmthm3a.p1.1.m1.3.3.2.2.2.cmml"><mi id="Thmthm3a.p1.1.m1.3.3.2.2.2.2" xref="Thmthm3a.p1.1.m1.3.3.2.2.2.2.cmml">a</mi><mn id="Thmthm3a.p1.1.m1.3.3.2.2.2.3" xref="Thmthm3a.p1.1.m1.3.3.2.2.2.3.cmml">0</mn></msub><mo id="Thmthm3a.p1.1.m1.7.7.6.6.9" xref="Thmthm3a.p1.1.m1.7.7.6.7.cmml">,</mo><msub id="Thmthm3a.p1.1.m1.4.4.3.3.3" xref="Thmthm3a.p1.1.m1.4.4.3.3.3.cmml"><mi id="Thmthm3a.p1.1.m1.4.4.3.3.3.2" xref="Thmthm3a.p1.1.m1.4.4.3.3.3.2.cmml">s</mi><mn id="Thmthm3a.p1.1.m1.4.4.3.3.3.3" xref="Thmthm3a.p1.1.m1.4.4.3.3.3.3.cmml">1</mn></msub><mo id="Thmthm3a.p1.1.m1.7.7.6.6.10" xref="Thmthm3a.p1.1.m1.7.7.6.7.cmml">,</mo><msub id="Thmthm3a.p1.1.m1.5.5.4.4.4" xref="Thmthm3a.p1.1.m1.5.5.4.4.4.cmml"><mi id="Thmthm3a.p1.1.m1.5.5.4.4.4.2" xref="Thmthm3a.p1.1.m1.5.5.4.4.4.2.cmml">a</mi><mn id="Thmthm3a.p1.1.m1.5.5.4.4.4.3" xref="Thmthm3a.p1.1.m1.5.5.4.4.4.3.cmml">1</mn></msub><mo id="Thmthm3a.p1.1.m1.7.7.6.6.11" xref="Thmthm3a.p1.1.m1.7.7.6.7.cmml">,</mo><mi id="Thmthm3a.p1.1.m1.1.1" mathvariant="normal" xref="Thmthm3a.p1.1.m1.1.1.cmml">…</mi><mo id="Thmthm3a.p1.1.m1.7.7.6.6.12" xref="Thmthm3a.p1.1.m1.7.7.6.7.cmml">,</mo><msub id="Thmthm3a.p1.1.m1.6.6.5.5.5" xref="Thmthm3a.p1.1.m1.6.6.5.5.5.cmml"><mi id="Thmthm3a.p1.1.m1.6.6.5.5.5.2" xref="Thmthm3a.p1.1.m1.6.6.5.5.5.2.cmml">a</mi><mrow id="Thmthm3a.p1.1.m1.6.6.5.5.5.3" xref="Thmthm3a.p1.1.m1.6.6.5.5.5.3.cmml"><mi id="Thmthm3a.p1.1.m1.6.6.5.5.5.3.2" xref="Thmthm3a.p1.1.m1.6.6.5.5.5.3.2.cmml">H</mi><mo id="Thmthm3a.p1.1.m1.6.6.5.5.5.3.1" xref="Thmthm3a.p1.1.m1.6.6.5.5.5.3.1.cmml">−</mo><mn id="Thmthm3a.p1.1.m1.6.6.5.5.5.3.3" xref="Thmthm3a.p1.1.m1.6.6.5.5.5.3.3.cmml">1</mn></mrow></msub><mo id="Thmthm3a.p1.1.m1.7.7.6.6.13" xref="Thmthm3a.p1.1.m1.7.7.6.7.cmml">,</mo><msub id="Thmthm3a.p1.1.m1.7.7.6.6.6" xref="Thmthm3a.p1.1.m1.7.7.6.6.6.cmml"><mi id="Thmthm3a.p1.1.m1.7.7.6.6.6.2" xref="Thmthm3a.p1.1.m1.7.7.6.6.6.2.cmml">s</mi><mi id="Thmthm3a.p1.1.m1.7.7.6.6.6.3" xref="Thmthm3a.p1.1.m1.7.7.6.6.6.3.cmml">H</mi></msub><mo id="Thmthm3a.p1.1.m1.7.7.6.6.14" stretchy="false" xref="Thmthm3a.p1.1.m1.7.7.6.7.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmthm3a.p1.1.m1.7b"><apply id="Thmthm3a.p1.1.m1.7.7.cmml" xref="Thmthm3a.p1.1.m1.7.7"><eq id="Thmthm3a.p1.1.m1.7.7.7.cmml" xref="Thmthm3a.p1.1.m1.7.7.7"></eq><ci id="Thmthm3a.p1.1.m1.7.7.8.cmml" xref="Thmthm3a.p1.1.m1.7.7.8">𝜏</ci><vector id="Thmthm3a.p1.1.m1.7.7.6.7.cmml" xref="Thmthm3a.p1.1.m1.7.7.6.6"><apply id="Thmthm3a.p1.1.m1.2.2.1.1.1.cmml" xref="Thmthm3a.p1.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="Thmthm3a.p1.1.m1.2.2.1.1.1.1.cmml" xref="Thmthm3a.p1.1.m1.2.2.1.1.1">subscript</csymbol><ci id="Thmthm3a.p1.1.m1.2.2.1.1.1.2.cmml" xref="Thmthm3a.p1.1.m1.2.2.1.1.1.2">𝑠</ci><cn id="Thmthm3a.p1.1.m1.2.2.1.1.1.3.cmml" type="integer" xref="Thmthm3a.p1.1.m1.2.2.1.1.1.3">0</cn></apply><apply id="Thmthm3a.p1.1.m1.3.3.2.2.2.cmml" xref="Thmthm3a.p1.1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="Thmthm3a.p1.1.m1.3.3.2.2.2.1.cmml" xref="Thmthm3a.p1.1.m1.3.3.2.2.2">subscript</csymbol><ci id="Thmthm3a.p1.1.m1.3.3.2.2.2.2.cmml" xref="Thmthm3a.p1.1.m1.3.3.2.2.2.2">𝑎</ci><cn id="Thmthm3a.p1.1.m1.3.3.2.2.2.3.cmml" type="integer" xref="Thmthm3a.p1.1.m1.3.3.2.2.2.3">0</cn></apply><apply id="Thmthm3a.p1.1.m1.4.4.3.3.3.cmml" xref="Thmthm3a.p1.1.m1.4.4.3.3.3"><csymbol cd="ambiguous" id="Thmthm3a.p1.1.m1.4.4.3.3.3.1.cmml" xref="Thmthm3a.p1.1.m1.4.4.3.3.3">subscript</csymbol><ci id="Thmthm3a.p1.1.m1.4.4.3.3.3.2.cmml" xref="Thmthm3a.p1.1.m1.4.4.3.3.3.2">𝑠</ci><cn id="Thmthm3a.p1.1.m1.4.4.3.3.3.3.cmml" type="integer" xref="Thmthm3a.p1.1.m1.4.4.3.3.3.3">1</cn></apply><apply id="Thmthm3a.p1.1.m1.5.5.4.4.4.cmml" xref="Thmthm3a.p1.1.m1.5.5.4.4.4"><csymbol cd="ambiguous" id="Thmthm3a.p1.1.m1.5.5.4.4.4.1.cmml" xref="Thmthm3a.p1.1.m1.5.5.4.4.4">subscript</csymbol><ci id="Thmthm3a.p1.1.m1.5.5.4.4.4.2.cmml" xref="Thmthm3a.p1.1.m1.5.5.4.4.4.2">𝑎</ci><cn id="Thmthm3a.p1.1.m1.5.5.4.4.4.3.cmml" type="integer" xref="Thmthm3a.p1.1.m1.5.5.4.4.4.3">1</cn></apply><ci id="Thmthm3a.p1.1.m1.1.1.cmml" xref="Thmthm3a.p1.1.m1.1.1">…</ci><apply id="Thmthm3a.p1.1.m1.6.6.5.5.5.cmml" xref="Thmthm3a.p1.1.m1.6.6.5.5.5"><csymbol cd="ambiguous" id="Thmthm3a.p1.1.m1.6.6.5.5.5.1.cmml" xref="Thmthm3a.p1.1.m1.6.6.5.5.5">subscript</csymbol><ci id="Thmthm3a.p1.1.m1.6.6.5.5.5.2.cmml" xref="Thmthm3a.p1.1.m1.6.6.5.5.5.2">𝑎</ci><apply id="Thmthm3a.p1.1.m1.6.6.5.5.5.3.cmml" xref="Thmthm3a.p1.1.m1.6.6.5.5.5.3"><minus id="Thmthm3a.p1.1.m1.6.6.5.5.5.3.1.cmml" xref="Thmthm3a.p1.1.m1.6.6.5.5.5.3.1"></minus><ci id="Thmthm3a.p1.1.m1.6.6.5.5.5.3.2.cmml" xref="Thmthm3a.p1.1.m1.6.6.5.5.5.3.2">𝐻</ci><cn id="Thmthm3a.p1.1.m1.6.6.5.5.5.3.3.cmml" type="integer" xref="Thmthm3a.p1.1.m1.6.6.5.5.5.3.3">1</cn></apply></apply><apply id="Thmthm3a.p1.1.m1.7.7.6.6.6.cmml" xref="Thmthm3a.p1.1.m1.7.7.6.6.6"><csymbol cd="ambiguous" id="Thmthm3a.p1.1.m1.7.7.6.6.6.1.cmml" xref="Thmthm3a.p1.1.m1.7.7.6.6.6">subscript</csymbol><ci id="Thmthm3a.p1.1.m1.7.7.6.6.6.2.cmml" xref="Thmthm3a.p1.1.m1.7.7.6.6.6.2">𝑠</ci><ci id="Thmthm3a.p1.1.m1.7.7.6.6.6.3.cmml" xref="Thmthm3a.p1.1.m1.7.7.6.6.6.3">𝐻</ci></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmthm3a.p1.1.m1.7c">\tau=(s_{0},a_{0},s_{1},a_{1},\dots,a_{H-1},s_{H})</annotation><annotation encoding="application/x-llamapun" id="Thmthm3a.p1.1.m1.7d">italic_τ = ( italic_s start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , italic_a start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , italic_s start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_a start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_a start_POSTSUBSCRIPT italic_H - 1 end_POSTSUBSCRIPT , italic_s start_POSTSUBSCRIPT italic_H end_POSTSUBSCRIPT )</annotation></semantics></math> in the original state space <math alttext="{\mathcal{S}}" class="ltx_Math" display="inline" id="Thmthm3a.p1.2.m2.1"><semantics id="Thmthm3a.p1.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="Thmthm3a.p1.2.m2.1.1" xref="Thmthm3a.p1.2.m2.1.1.cmml">𝒮</mi><annotation-xml encoding="MathML-Content" id="Thmthm3a.p1.2.m2.1b"><ci id="Thmthm3a.p1.2.m2.1.1.cmml" xref="Thmthm3a.p1.2.m2.1.1">𝒮</ci></annotation-xml><annotation encoding="application/x-tex" id="Thmthm3a.p1.2.m2.1c">{\mathcal{S}}</annotation><annotation encoding="application/x-llamapun" id="Thmthm3a.p1.2.m2.1d">caligraphic_S</annotation></semantics></math>, and its corresponding encoded trajectory <math alttext="\phi(\tau)=(z_{0},a_{0},z_{1},a_{1},\dots,a_{H-1},z_{H})" class="ltx_Math" display="inline" id="Thmthm3a.p1.3.m3.8"><semantics id="Thmthm3a.p1.3.m3.8a"><mrow id="Thmthm3a.p1.3.m3.8.8" xref="Thmthm3a.p1.3.m3.8.8.cmml"><mrow id="Thmthm3a.p1.3.m3.8.8.8" xref="Thmthm3a.p1.3.m3.8.8.8.cmml"><mi id="Thmthm3a.p1.3.m3.8.8.8.2" xref="Thmthm3a.p1.3.m3.8.8.8.2.cmml">ϕ</mi><mo id="Thmthm3a.p1.3.m3.8.8.8.1" xref="Thmthm3a.p1.3.m3.8.8.8.1.cmml">⁢</mo><mrow id="Thmthm3a.p1.3.m3.8.8.8.3.2" xref="Thmthm3a.p1.3.m3.8.8.8.cmml"><mo id="Thmthm3a.p1.3.m3.8.8.8.3.2.1" stretchy="false" xref="Thmthm3a.p1.3.m3.8.8.8.cmml">(</mo><mi id="Thmthm3a.p1.3.m3.1.1" xref="Thmthm3a.p1.3.m3.1.1.cmml">τ</mi><mo id="Thmthm3a.p1.3.m3.8.8.8.3.2.2" stretchy="false" xref="Thmthm3a.p1.3.m3.8.8.8.cmml">)</mo></mrow></mrow><mo id="Thmthm3a.p1.3.m3.8.8.7" xref="Thmthm3a.p1.3.m3.8.8.7.cmml">=</mo><mrow id="Thmthm3a.p1.3.m3.8.8.6.6" xref="Thmthm3a.p1.3.m3.8.8.6.7.cmml"><mo id="Thmthm3a.p1.3.m3.8.8.6.6.7" stretchy="false" xref="Thmthm3a.p1.3.m3.8.8.6.7.cmml">(</mo><msub id="Thmthm3a.p1.3.m3.3.3.1.1.1" xref="Thmthm3a.p1.3.m3.3.3.1.1.1.cmml"><mi id="Thmthm3a.p1.3.m3.3.3.1.1.1.2" xref="Thmthm3a.p1.3.m3.3.3.1.1.1.2.cmml">z</mi><mn id="Thmthm3a.p1.3.m3.3.3.1.1.1.3" xref="Thmthm3a.p1.3.m3.3.3.1.1.1.3.cmml">0</mn></msub><mo id="Thmthm3a.p1.3.m3.8.8.6.6.8" xref="Thmthm3a.p1.3.m3.8.8.6.7.cmml">,</mo><msub id="Thmthm3a.p1.3.m3.4.4.2.2.2" xref="Thmthm3a.p1.3.m3.4.4.2.2.2.cmml"><mi id="Thmthm3a.p1.3.m3.4.4.2.2.2.2" xref="Thmthm3a.p1.3.m3.4.4.2.2.2.2.cmml">a</mi><mn id="Thmthm3a.p1.3.m3.4.4.2.2.2.3" xref="Thmthm3a.p1.3.m3.4.4.2.2.2.3.cmml">0</mn></msub><mo id="Thmthm3a.p1.3.m3.8.8.6.6.9" xref="Thmthm3a.p1.3.m3.8.8.6.7.cmml">,</mo><msub id="Thmthm3a.p1.3.m3.5.5.3.3.3" xref="Thmthm3a.p1.3.m3.5.5.3.3.3.cmml"><mi id="Thmthm3a.p1.3.m3.5.5.3.3.3.2" xref="Thmthm3a.p1.3.m3.5.5.3.3.3.2.cmml">z</mi><mn id="Thmthm3a.p1.3.m3.5.5.3.3.3.3" xref="Thmthm3a.p1.3.m3.5.5.3.3.3.3.cmml">1</mn></msub><mo id="Thmthm3a.p1.3.m3.8.8.6.6.10" xref="Thmthm3a.p1.3.m3.8.8.6.7.cmml">,</mo><msub id="Thmthm3a.p1.3.m3.6.6.4.4.4" xref="Thmthm3a.p1.3.m3.6.6.4.4.4.cmml"><mi id="Thmthm3a.p1.3.m3.6.6.4.4.4.2" xref="Thmthm3a.p1.3.m3.6.6.4.4.4.2.cmml">a</mi><mn id="Thmthm3a.p1.3.m3.6.6.4.4.4.3" xref="Thmthm3a.p1.3.m3.6.6.4.4.4.3.cmml">1</mn></msub><mo id="Thmthm3a.p1.3.m3.8.8.6.6.11" xref="Thmthm3a.p1.3.m3.8.8.6.7.cmml">,</mo><mi id="Thmthm3a.p1.3.m3.2.2" mathvariant="normal" xref="Thmthm3a.p1.3.m3.2.2.cmml">…</mi><mo id="Thmthm3a.p1.3.m3.8.8.6.6.12" xref="Thmthm3a.p1.3.m3.8.8.6.7.cmml">,</mo><msub id="Thmthm3a.p1.3.m3.7.7.5.5.5" xref="Thmthm3a.p1.3.m3.7.7.5.5.5.cmml"><mi id="Thmthm3a.p1.3.m3.7.7.5.5.5.2" xref="Thmthm3a.p1.3.m3.7.7.5.5.5.2.cmml">a</mi><mrow id="Thmthm3a.p1.3.m3.7.7.5.5.5.3" xref="Thmthm3a.p1.3.m3.7.7.5.5.5.3.cmml"><mi id="Thmthm3a.p1.3.m3.7.7.5.5.5.3.2" xref="Thmthm3a.p1.3.m3.7.7.5.5.5.3.2.cmml">H</mi><mo id="Thmthm3a.p1.3.m3.7.7.5.5.5.3.1" xref="Thmthm3a.p1.3.m3.7.7.5.5.5.3.1.cmml">−</mo><mn id="Thmthm3a.p1.3.m3.7.7.5.5.5.3.3" xref="Thmthm3a.p1.3.m3.7.7.5.5.5.3.3.cmml">1</mn></mrow></msub><mo id="Thmthm3a.p1.3.m3.8.8.6.6.13" xref="Thmthm3a.p1.3.m3.8.8.6.7.cmml">,</mo><msub id="Thmthm3a.p1.3.m3.8.8.6.6.6" xref="Thmthm3a.p1.3.m3.8.8.6.6.6.cmml"><mi id="Thmthm3a.p1.3.m3.8.8.6.6.6.2" xref="Thmthm3a.p1.3.m3.8.8.6.6.6.2.cmml">z</mi><mi id="Thmthm3a.p1.3.m3.8.8.6.6.6.3" xref="Thmthm3a.p1.3.m3.8.8.6.6.6.3.cmml">H</mi></msub><mo id="Thmthm3a.p1.3.m3.8.8.6.6.14" stretchy="false" xref="Thmthm3a.p1.3.m3.8.8.6.7.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmthm3a.p1.3.m3.8b"><apply id="Thmthm3a.p1.3.m3.8.8.cmml" xref="Thmthm3a.p1.3.m3.8.8"><eq id="Thmthm3a.p1.3.m3.8.8.7.cmml" xref="Thmthm3a.p1.3.m3.8.8.7"></eq><apply id="Thmthm3a.p1.3.m3.8.8.8.cmml" xref="Thmthm3a.p1.3.m3.8.8.8"><times id="Thmthm3a.p1.3.m3.8.8.8.1.cmml" xref="Thmthm3a.p1.3.m3.8.8.8.1"></times><ci id="Thmthm3a.p1.3.m3.8.8.8.2.cmml" xref="Thmthm3a.p1.3.m3.8.8.8.2">italic-ϕ</ci><ci id="Thmthm3a.p1.3.m3.1.1.cmml" xref="Thmthm3a.p1.3.m3.1.1">𝜏</ci></apply><vector id="Thmthm3a.p1.3.m3.8.8.6.7.cmml" xref="Thmthm3a.p1.3.m3.8.8.6.6"><apply id="Thmthm3a.p1.3.m3.3.3.1.1.1.cmml" xref="Thmthm3a.p1.3.m3.3.3.1.1.1"><csymbol cd="ambiguous" id="Thmthm3a.p1.3.m3.3.3.1.1.1.1.cmml" xref="Thmthm3a.p1.3.m3.3.3.1.1.1">subscript</csymbol><ci id="Thmthm3a.p1.3.m3.3.3.1.1.1.2.cmml" xref="Thmthm3a.p1.3.m3.3.3.1.1.1.2">𝑧</ci><cn id="Thmthm3a.p1.3.m3.3.3.1.1.1.3.cmml" type="integer" xref="Thmthm3a.p1.3.m3.3.3.1.1.1.3">0</cn></apply><apply id="Thmthm3a.p1.3.m3.4.4.2.2.2.cmml" xref="Thmthm3a.p1.3.m3.4.4.2.2.2"><csymbol cd="ambiguous" id="Thmthm3a.p1.3.m3.4.4.2.2.2.1.cmml" xref="Thmthm3a.p1.3.m3.4.4.2.2.2">subscript</csymbol><ci id="Thmthm3a.p1.3.m3.4.4.2.2.2.2.cmml" xref="Thmthm3a.p1.3.m3.4.4.2.2.2.2">𝑎</ci><cn id="Thmthm3a.p1.3.m3.4.4.2.2.2.3.cmml" type="integer" xref="Thmthm3a.p1.3.m3.4.4.2.2.2.3">0</cn></apply><apply id="Thmthm3a.p1.3.m3.5.5.3.3.3.cmml" xref="Thmthm3a.p1.3.m3.5.5.3.3.3"><csymbol cd="ambiguous" id="Thmthm3a.p1.3.m3.5.5.3.3.3.1.cmml" xref="Thmthm3a.p1.3.m3.5.5.3.3.3">subscript</csymbol><ci id="Thmthm3a.p1.3.m3.5.5.3.3.3.2.cmml" xref="Thmthm3a.p1.3.m3.5.5.3.3.3.2">𝑧</ci><cn id="Thmthm3a.p1.3.m3.5.5.3.3.3.3.cmml" type="integer" xref="Thmthm3a.p1.3.m3.5.5.3.3.3.3">1</cn></apply><apply id="Thmthm3a.p1.3.m3.6.6.4.4.4.cmml" xref="Thmthm3a.p1.3.m3.6.6.4.4.4"><csymbol cd="ambiguous" id="Thmthm3a.p1.3.m3.6.6.4.4.4.1.cmml" xref="Thmthm3a.p1.3.m3.6.6.4.4.4">subscript</csymbol><ci id="Thmthm3a.p1.3.m3.6.6.4.4.4.2.cmml" xref="Thmthm3a.p1.3.m3.6.6.4.4.4.2">𝑎</ci><cn id="Thmthm3a.p1.3.m3.6.6.4.4.4.3.cmml" type="integer" xref="Thmthm3a.p1.3.m3.6.6.4.4.4.3">1</cn></apply><ci id="Thmthm3a.p1.3.m3.2.2.cmml" xref="Thmthm3a.p1.3.m3.2.2">…</ci><apply id="Thmthm3a.p1.3.m3.7.7.5.5.5.cmml" xref="Thmthm3a.p1.3.m3.7.7.5.5.5"><csymbol cd="ambiguous" id="Thmthm3a.p1.3.m3.7.7.5.5.5.1.cmml" xref="Thmthm3a.p1.3.m3.7.7.5.5.5">subscript</csymbol><ci id="Thmthm3a.p1.3.m3.7.7.5.5.5.2.cmml" xref="Thmthm3a.p1.3.m3.7.7.5.5.5.2">𝑎</ci><apply id="Thmthm3a.p1.3.m3.7.7.5.5.5.3.cmml" xref="Thmthm3a.p1.3.m3.7.7.5.5.5.3"><minus id="Thmthm3a.p1.3.m3.7.7.5.5.5.3.1.cmml" xref="Thmthm3a.p1.3.m3.7.7.5.5.5.3.1"></minus><ci id="Thmthm3a.p1.3.m3.7.7.5.5.5.3.2.cmml" xref="Thmthm3a.p1.3.m3.7.7.5.5.5.3.2">𝐻</ci><cn id="Thmthm3a.p1.3.m3.7.7.5.5.5.3.3.cmml" type="integer" xref="Thmthm3a.p1.3.m3.7.7.5.5.5.3.3">1</cn></apply></apply><apply id="Thmthm3a.p1.3.m3.8.8.6.6.6.cmml" xref="Thmthm3a.p1.3.m3.8.8.6.6.6"><csymbol cd="ambiguous" id="Thmthm3a.p1.3.m3.8.8.6.6.6.1.cmml" xref="Thmthm3a.p1.3.m3.8.8.6.6.6">subscript</csymbol><ci id="Thmthm3a.p1.3.m3.8.8.6.6.6.2.cmml" xref="Thmthm3a.p1.3.m3.8.8.6.6.6.2">𝑧</ci><ci id="Thmthm3a.p1.3.m3.8.8.6.6.6.3.cmml" xref="Thmthm3a.p1.3.m3.8.8.6.6.6.3">𝐻</ci></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmthm3a.p1.3.m3.8c">\phi(\tau)=(z_{0},a_{0},z_{1},a_{1},\dots,a_{H-1},z_{H})</annotation><annotation encoding="application/x-llamapun" id="Thmthm3a.p1.3.m3.8d">italic_ϕ ( italic_τ ) = ( italic_z start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , italic_a start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , italic_z start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_a start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_a start_POSTSUBSCRIPT italic_H - 1 end_POSTSUBSCRIPT , italic_z start_POSTSUBSCRIPT italic_H end_POSTSUBSCRIPT )</annotation></semantics></math>, where <math alttext="a_{k}\sim\pi^{*}(\cdot|s_{k})" class="ltx_math_unparsed" display="inline" id="Thmthm3a.p1.4.m4.1"><semantics id="Thmthm3a.p1.4.m4.1a"><mrow id="Thmthm3a.p1.4.m4.1b"><msub id="Thmthm3a.p1.4.m4.1.1"><mi id="Thmthm3a.p1.4.m4.1.1.2">a</mi><mi id="Thmthm3a.p1.4.m4.1.1.3">k</mi></msub><mo id="Thmthm3a.p1.4.m4.1.2">∼</mo><msup id="Thmthm3a.p1.4.m4.1.3"><mi id="Thmthm3a.p1.4.m4.1.3.2">π</mi><mo id="Thmthm3a.p1.4.m4.1.3.3">∗</mo></msup><mrow id="Thmthm3a.p1.4.m4.1.4"><mo id="Thmthm3a.p1.4.m4.1.4.1" stretchy="false">(</mo><mo id="Thmthm3a.p1.4.m4.1.4.2" lspace="0em" rspace="0em">⋅</mo><mo fence="false" id="Thmthm3a.p1.4.m4.1.4.3" rspace="0.167em" stretchy="false">|</mo><msub id="Thmthm3a.p1.4.m4.1.4.4"><mi id="Thmthm3a.p1.4.m4.1.4.4.2">s</mi><mi id="Thmthm3a.p1.4.m4.1.4.4.3">k</mi></msub><mo id="Thmthm3a.p1.4.m4.1.4.5" stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="Thmthm3a.p1.4.m4.1c">a_{k}\sim\pi^{*}(\cdot|s_{k})</annotation><annotation encoding="application/x-llamapun" id="Thmthm3a.p1.4.m4.1d">italic_a start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ∼ italic_π start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ( ⋅ | italic_s start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT )</annotation></semantics></math> and <math alttext="z_{k}=\phi(s_{k})" class="ltx_Math" display="inline" id="Thmthm3a.p1.5.m5.1"><semantics id="Thmthm3a.p1.5.m5.1a"><mrow id="Thmthm3a.p1.5.m5.1.1" xref="Thmthm3a.p1.5.m5.1.1.cmml"><msub id="Thmthm3a.p1.5.m5.1.1.3" xref="Thmthm3a.p1.5.m5.1.1.3.cmml"><mi id="Thmthm3a.p1.5.m5.1.1.3.2" xref="Thmthm3a.p1.5.m5.1.1.3.2.cmml">z</mi><mi id="Thmthm3a.p1.5.m5.1.1.3.3" xref="Thmthm3a.p1.5.m5.1.1.3.3.cmml">k</mi></msub><mo id="Thmthm3a.p1.5.m5.1.1.2" xref="Thmthm3a.p1.5.m5.1.1.2.cmml">=</mo><mrow id="Thmthm3a.p1.5.m5.1.1.1" xref="Thmthm3a.p1.5.m5.1.1.1.cmml"><mi id="Thmthm3a.p1.5.m5.1.1.1.3" xref="Thmthm3a.p1.5.m5.1.1.1.3.cmml">ϕ</mi><mo id="Thmthm3a.p1.5.m5.1.1.1.2" xref="Thmthm3a.p1.5.m5.1.1.1.2.cmml">⁢</mo><mrow id="Thmthm3a.p1.5.m5.1.1.1.1.1" xref="Thmthm3a.p1.5.m5.1.1.1.1.1.1.cmml"><mo id="Thmthm3a.p1.5.m5.1.1.1.1.1.2" stretchy="false" xref="Thmthm3a.p1.5.m5.1.1.1.1.1.1.cmml">(</mo><msub id="Thmthm3a.p1.5.m5.1.1.1.1.1.1" xref="Thmthm3a.p1.5.m5.1.1.1.1.1.1.cmml"><mi id="Thmthm3a.p1.5.m5.1.1.1.1.1.1.2" xref="Thmthm3a.p1.5.m5.1.1.1.1.1.1.2.cmml">s</mi><mi id="Thmthm3a.p1.5.m5.1.1.1.1.1.1.3" xref="Thmthm3a.p1.5.m5.1.1.1.1.1.1.3.cmml">k</mi></msub><mo id="Thmthm3a.p1.5.m5.1.1.1.1.1.3" stretchy="false" xref="Thmthm3a.p1.5.m5.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmthm3a.p1.5.m5.1b"><apply id="Thmthm3a.p1.5.m5.1.1.cmml" xref="Thmthm3a.p1.5.m5.1.1"><eq id="Thmthm3a.p1.5.m5.1.1.2.cmml" xref="Thmthm3a.p1.5.m5.1.1.2"></eq><apply id="Thmthm3a.p1.5.m5.1.1.3.cmml" xref="Thmthm3a.p1.5.m5.1.1.3"><csymbol cd="ambiguous" id="Thmthm3a.p1.5.m5.1.1.3.1.cmml" xref="Thmthm3a.p1.5.m5.1.1.3">subscript</csymbol><ci id="Thmthm3a.p1.5.m5.1.1.3.2.cmml" xref="Thmthm3a.p1.5.m5.1.1.3.2">𝑧</ci><ci id="Thmthm3a.p1.5.m5.1.1.3.3.cmml" xref="Thmthm3a.p1.5.m5.1.1.3.3">𝑘</ci></apply><apply id="Thmthm3a.p1.5.m5.1.1.1.cmml" xref="Thmthm3a.p1.5.m5.1.1.1"><times id="Thmthm3a.p1.5.m5.1.1.1.2.cmml" xref="Thmthm3a.p1.5.m5.1.1.1.2"></times><ci id="Thmthm3a.p1.5.m5.1.1.1.3.cmml" xref="Thmthm3a.p1.5.m5.1.1.1.3">italic-ϕ</ci><apply id="Thmthm3a.p1.5.m5.1.1.1.1.1.1.cmml" xref="Thmthm3a.p1.5.m5.1.1.1.1.1"><csymbol cd="ambiguous" id="Thmthm3a.p1.5.m5.1.1.1.1.1.1.1.cmml" xref="Thmthm3a.p1.5.m5.1.1.1.1.1">subscript</csymbol><ci id="Thmthm3a.p1.5.m5.1.1.1.1.1.1.2.cmml" xref="Thmthm3a.p1.5.m5.1.1.1.1.1.1.2">𝑠</ci><ci id="Thmthm3a.p1.5.m5.1.1.1.1.1.1.3.cmml" xref="Thmthm3a.p1.5.m5.1.1.1.1.1.1.3">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmthm3a.p1.5.m5.1c">z_{k}=\phi(s_{k})</annotation><annotation encoding="application/x-llamapun" id="Thmthm3a.p1.5.m5.1d">italic_z start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT = italic_ϕ ( italic_s start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT )</annotation></semantics></math>, with <math alttext="\phi" class="ltx_Math" display="inline" id="Thmthm3a.p1.6.m6.1"><semantics id="Thmthm3a.p1.6.m6.1a"><mi id="Thmthm3a.p1.6.m6.1.1" xref="Thmthm3a.p1.6.m6.1.1.cmml">ϕ</mi><annotation-xml encoding="MathML-Content" id="Thmthm3a.p1.6.m6.1b"><ci id="Thmthm3a.p1.6.m6.1.1.cmml" xref="Thmthm3a.p1.6.m6.1.1">italic-ϕ</ci></annotation-xml><annotation encoding="application/x-tex" id="Thmthm3a.p1.6.m6.1c">\phi</annotation><annotation encoding="application/x-llamapun" id="Thmthm3a.p1.6.m6.1d">italic_ϕ</annotation></semantics></math> defined in Theorem <a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#Thmthm2" title="Theorem 2. ‣ 4.2 Theoretical Analysis ‣ 4 Bisimulation metric for model predictive control ‣ Bisimulation metric for Model Predictive Control"><span class="ltx_text ltx_ref_tag">2</span></a>.
Under the assumption that both the reward model and dynamics model have no approximation error, the cumulative rewards <math alttext="\mathbf{S}(\tau)=\mathbb{E}_{\tau}\left[\gamma^{H}V^{*}(s_{H})+\sum_{h=0}^{H-1%
}\gamma^{h}R(s_{h},a_{h})\right]" class="ltx_Math" display="inline" id="Thmthm3a.p1.7.m7.2"><semantics id="Thmthm3a.p1.7.m7.2a"><mrow id="Thmthm3a.p1.7.m7.2.2" xref="Thmthm3a.p1.7.m7.2.2.cmml"><mrow id="Thmthm3a.p1.7.m7.2.2.3" xref="Thmthm3a.p1.7.m7.2.2.3.cmml"><mi id="Thmthm3a.p1.7.m7.2.2.3.2" xref="Thmthm3a.p1.7.m7.2.2.3.2.cmml">𝐒</mi><mo id="Thmthm3a.p1.7.m7.2.2.3.1" xref="Thmthm3a.p1.7.m7.2.2.3.1.cmml">⁢</mo><mrow id="Thmthm3a.p1.7.m7.2.2.3.3.2" xref="Thmthm3a.p1.7.m7.2.2.3.cmml"><mo id="Thmthm3a.p1.7.m7.2.2.3.3.2.1" stretchy="false" xref="Thmthm3a.p1.7.m7.2.2.3.cmml">(</mo><mi id="Thmthm3a.p1.7.m7.1.1" xref="Thmthm3a.p1.7.m7.1.1.cmml">τ</mi><mo id="Thmthm3a.p1.7.m7.2.2.3.3.2.2" stretchy="false" xref="Thmthm3a.p1.7.m7.2.2.3.cmml">)</mo></mrow></mrow><mo id="Thmthm3a.p1.7.m7.2.2.2" xref="Thmthm3a.p1.7.m7.2.2.2.cmml">=</mo><mrow id="Thmthm3a.p1.7.m7.2.2.1" xref="Thmthm3a.p1.7.m7.2.2.1.cmml"><msub id="Thmthm3a.p1.7.m7.2.2.1.3" xref="Thmthm3a.p1.7.m7.2.2.1.3.cmml"><mi id="Thmthm3a.p1.7.m7.2.2.1.3.2" xref="Thmthm3a.p1.7.m7.2.2.1.3.2.cmml">𝔼</mi><mi id="Thmthm3a.p1.7.m7.2.2.1.3.3" xref="Thmthm3a.p1.7.m7.2.2.1.3.3.cmml">τ</mi></msub><mo id="Thmthm3a.p1.7.m7.2.2.1.2" xref="Thmthm3a.p1.7.m7.2.2.1.2.cmml">⁢</mo><mrow id="Thmthm3a.p1.7.m7.2.2.1.1.1" xref="Thmthm3a.p1.7.m7.2.2.1.1.2.cmml"><mo id="Thmthm3a.p1.7.m7.2.2.1.1.1.2" xref="Thmthm3a.p1.7.m7.2.2.1.1.2.1.cmml">[</mo><mrow id="Thmthm3a.p1.7.m7.2.2.1.1.1.1" xref="Thmthm3a.p1.7.m7.2.2.1.1.1.1.cmml"><mrow id="Thmthm3a.p1.7.m7.2.2.1.1.1.1.1" xref="Thmthm3a.p1.7.m7.2.2.1.1.1.1.1.cmml"><msup id="Thmthm3a.p1.7.m7.2.2.1.1.1.1.1.3" xref="Thmthm3a.p1.7.m7.2.2.1.1.1.1.1.3.cmml"><mi id="Thmthm3a.p1.7.m7.2.2.1.1.1.1.1.3.2" xref="Thmthm3a.p1.7.m7.2.2.1.1.1.1.1.3.2.cmml">γ</mi><mi id="Thmthm3a.p1.7.m7.2.2.1.1.1.1.1.3.3" xref="Thmthm3a.p1.7.m7.2.2.1.1.1.1.1.3.3.cmml">H</mi></msup><mo id="Thmthm3a.p1.7.m7.2.2.1.1.1.1.1.2" xref="Thmthm3a.p1.7.m7.2.2.1.1.1.1.1.2.cmml">⁢</mo><msup id="Thmthm3a.p1.7.m7.2.2.1.1.1.1.1.4" xref="Thmthm3a.p1.7.m7.2.2.1.1.1.1.1.4.cmml"><mi id="Thmthm3a.p1.7.m7.2.2.1.1.1.1.1.4.2" xref="Thmthm3a.p1.7.m7.2.2.1.1.1.1.1.4.2.cmml">V</mi><mo id="Thmthm3a.p1.7.m7.2.2.1.1.1.1.1.4.3" xref="Thmthm3a.p1.7.m7.2.2.1.1.1.1.1.4.3.cmml">∗</mo></msup><mo id="Thmthm3a.p1.7.m7.2.2.1.1.1.1.1.2a" xref="Thmthm3a.p1.7.m7.2.2.1.1.1.1.1.2.cmml">⁢</mo><mrow id="Thmthm3a.p1.7.m7.2.2.1.1.1.1.1.1.1" xref="Thmthm3a.p1.7.m7.2.2.1.1.1.1.1.1.1.1.cmml"><mo id="Thmthm3a.p1.7.m7.2.2.1.1.1.1.1.1.1.2" stretchy="false" xref="Thmthm3a.p1.7.m7.2.2.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="Thmthm3a.p1.7.m7.2.2.1.1.1.1.1.1.1.1" xref="Thmthm3a.p1.7.m7.2.2.1.1.1.1.1.1.1.1.cmml"><mi id="Thmthm3a.p1.7.m7.2.2.1.1.1.1.1.1.1.1.2" xref="Thmthm3a.p1.7.m7.2.2.1.1.1.1.1.1.1.1.2.cmml">s</mi><mi id="Thmthm3a.p1.7.m7.2.2.1.1.1.1.1.1.1.1.3" xref="Thmthm3a.p1.7.m7.2.2.1.1.1.1.1.1.1.1.3.cmml">H</mi></msub><mo id="Thmthm3a.p1.7.m7.2.2.1.1.1.1.1.1.1.3" stretchy="false" xref="Thmthm3a.p1.7.m7.2.2.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="Thmthm3a.p1.7.m7.2.2.1.1.1.1.4" rspace="0.055em" xref="Thmthm3a.p1.7.m7.2.2.1.1.1.1.4.cmml">+</mo><mrow id="Thmthm3a.p1.7.m7.2.2.1.1.1.1.3" xref="Thmthm3a.p1.7.m7.2.2.1.1.1.1.3.cmml"><msubsup id="Thmthm3a.p1.7.m7.2.2.1.1.1.1.3.3" xref="Thmthm3a.p1.7.m7.2.2.1.1.1.1.3.3.cmml"><mo id="Thmthm3a.p1.7.m7.2.2.1.1.1.1.3.3.2.2" xref="Thmthm3a.p1.7.m7.2.2.1.1.1.1.3.3.2.2.cmml">∑</mo><mrow id="Thmthm3a.p1.7.m7.2.2.1.1.1.1.3.3.2.3" xref="Thmthm3a.p1.7.m7.2.2.1.1.1.1.3.3.2.3.cmml"><mi id="Thmthm3a.p1.7.m7.2.2.1.1.1.1.3.3.2.3.2" xref="Thmthm3a.p1.7.m7.2.2.1.1.1.1.3.3.2.3.2.cmml">h</mi><mo id="Thmthm3a.p1.7.m7.2.2.1.1.1.1.3.3.2.3.1" xref="Thmthm3a.p1.7.m7.2.2.1.1.1.1.3.3.2.3.1.cmml">=</mo><mn id="Thmthm3a.p1.7.m7.2.2.1.1.1.1.3.3.2.3.3" xref="Thmthm3a.p1.7.m7.2.2.1.1.1.1.3.3.2.3.3.cmml">0</mn></mrow><mrow id="Thmthm3a.p1.7.m7.2.2.1.1.1.1.3.3.3" xref="Thmthm3a.p1.7.m7.2.2.1.1.1.1.3.3.3.cmml"><mi id="Thmthm3a.p1.7.m7.2.2.1.1.1.1.3.3.3.2" xref="Thmthm3a.p1.7.m7.2.2.1.1.1.1.3.3.3.2.cmml">H</mi><mo id="Thmthm3a.p1.7.m7.2.2.1.1.1.1.3.3.3.1" xref="Thmthm3a.p1.7.m7.2.2.1.1.1.1.3.3.3.1.cmml">−</mo><mn id="Thmthm3a.p1.7.m7.2.2.1.1.1.1.3.3.3.3" xref="Thmthm3a.p1.7.m7.2.2.1.1.1.1.3.3.3.3.cmml">1</mn></mrow></msubsup><mrow id="Thmthm3a.p1.7.m7.2.2.1.1.1.1.3.2" xref="Thmthm3a.p1.7.m7.2.2.1.1.1.1.3.2.cmml"><msup id="Thmthm3a.p1.7.m7.2.2.1.1.1.1.3.2.4" xref="Thmthm3a.p1.7.m7.2.2.1.1.1.1.3.2.4.cmml"><mi id="Thmthm3a.p1.7.m7.2.2.1.1.1.1.3.2.4.2" xref="Thmthm3a.p1.7.m7.2.2.1.1.1.1.3.2.4.2.cmml">γ</mi><mi id="Thmthm3a.p1.7.m7.2.2.1.1.1.1.3.2.4.3" xref="Thmthm3a.p1.7.m7.2.2.1.1.1.1.3.2.4.3.cmml">h</mi></msup><mo id="Thmthm3a.p1.7.m7.2.2.1.1.1.1.3.2.3" xref="Thmthm3a.p1.7.m7.2.2.1.1.1.1.3.2.3.cmml">⁢</mo><mi id="Thmthm3a.p1.7.m7.2.2.1.1.1.1.3.2.5" xref="Thmthm3a.p1.7.m7.2.2.1.1.1.1.3.2.5.cmml">R</mi><mo id="Thmthm3a.p1.7.m7.2.2.1.1.1.1.3.2.3a" xref="Thmthm3a.p1.7.m7.2.2.1.1.1.1.3.2.3.cmml">⁢</mo><mrow id="Thmthm3a.p1.7.m7.2.2.1.1.1.1.3.2.2.2" xref="Thmthm3a.p1.7.m7.2.2.1.1.1.1.3.2.2.3.cmml"><mo id="Thmthm3a.p1.7.m7.2.2.1.1.1.1.3.2.2.2.3" stretchy="false" xref="Thmthm3a.p1.7.m7.2.2.1.1.1.1.3.2.2.3.cmml">(</mo><msub id="Thmthm3a.p1.7.m7.2.2.1.1.1.1.2.1.1.1.1" xref="Thmthm3a.p1.7.m7.2.2.1.1.1.1.2.1.1.1.1.cmml"><mi id="Thmthm3a.p1.7.m7.2.2.1.1.1.1.2.1.1.1.1.2" xref="Thmthm3a.p1.7.m7.2.2.1.1.1.1.2.1.1.1.1.2.cmml">s</mi><mi id="Thmthm3a.p1.7.m7.2.2.1.1.1.1.2.1.1.1.1.3" xref="Thmthm3a.p1.7.m7.2.2.1.1.1.1.2.1.1.1.1.3.cmml">h</mi></msub><mo id="Thmthm3a.p1.7.m7.2.2.1.1.1.1.3.2.2.2.4" xref="Thmthm3a.p1.7.m7.2.2.1.1.1.1.3.2.2.3.cmml">,</mo><msub id="Thmthm3a.p1.7.m7.2.2.1.1.1.1.3.2.2.2.2" xref="Thmthm3a.p1.7.m7.2.2.1.1.1.1.3.2.2.2.2.cmml"><mi id="Thmthm3a.p1.7.m7.2.2.1.1.1.1.3.2.2.2.2.2" xref="Thmthm3a.p1.7.m7.2.2.1.1.1.1.3.2.2.2.2.2.cmml">a</mi><mi id="Thmthm3a.p1.7.m7.2.2.1.1.1.1.3.2.2.2.2.3" xref="Thmthm3a.p1.7.m7.2.2.1.1.1.1.3.2.2.2.2.3.cmml">h</mi></msub><mo id="Thmthm3a.p1.7.m7.2.2.1.1.1.1.3.2.2.2.5" stretchy="false" xref="Thmthm3a.p1.7.m7.2.2.1.1.1.1.3.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="Thmthm3a.p1.7.m7.2.2.1.1.1.3" xref="Thmthm3a.p1.7.m7.2.2.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmthm3a.p1.7.m7.2b"><apply id="Thmthm3a.p1.7.m7.2.2.cmml" xref="Thmthm3a.p1.7.m7.2.2"><eq id="Thmthm3a.p1.7.m7.2.2.2.cmml" xref="Thmthm3a.p1.7.m7.2.2.2"></eq><apply id="Thmthm3a.p1.7.m7.2.2.3.cmml" xref="Thmthm3a.p1.7.m7.2.2.3"><times id="Thmthm3a.p1.7.m7.2.2.3.1.cmml" xref="Thmthm3a.p1.7.m7.2.2.3.1"></times><ci id="Thmthm3a.p1.7.m7.2.2.3.2.cmml" xref="Thmthm3a.p1.7.m7.2.2.3.2">𝐒</ci><ci id="Thmthm3a.p1.7.m7.1.1.cmml" xref="Thmthm3a.p1.7.m7.1.1">𝜏</ci></apply><apply id="Thmthm3a.p1.7.m7.2.2.1.cmml" xref="Thmthm3a.p1.7.m7.2.2.1"><times id="Thmthm3a.p1.7.m7.2.2.1.2.cmml" xref="Thmthm3a.p1.7.m7.2.2.1.2"></times><apply id="Thmthm3a.p1.7.m7.2.2.1.3.cmml" xref="Thmthm3a.p1.7.m7.2.2.1.3"><csymbol cd="ambiguous" id="Thmthm3a.p1.7.m7.2.2.1.3.1.cmml" xref="Thmthm3a.p1.7.m7.2.2.1.3">subscript</csymbol><ci id="Thmthm3a.p1.7.m7.2.2.1.3.2.cmml" xref="Thmthm3a.p1.7.m7.2.2.1.3.2">𝔼</ci><ci id="Thmthm3a.p1.7.m7.2.2.1.3.3.cmml" xref="Thmthm3a.p1.7.m7.2.2.1.3.3">𝜏</ci></apply><apply id="Thmthm3a.p1.7.m7.2.2.1.1.2.cmml" xref="Thmthm3a.p1.7.m7.2.2.1.1.1"><csymbol cd="latexml" id="Thmthm3a.p1.7.m7.2.2.1.1.2.1.cmml" xref="Thmthm3a.p1.7.m7.2.2.1.1.1.2">delimited-[]</csymbol><apply id="Thmthm3a.p1.7.m7.2.2.1.1.1.1.cmml" xref="Thmthm3a.p1.7.m7.2.2.1.1.1.1"><plus id="Thmthm3a.p1.7.m7.2.2.1.1.1.1.4.cmml" xref="Thmthm3a.p1.7.m7.2.2.1.1.1.1.4"></plus><apply id="Thmthm3a.p1.7.m7.2.2.1.1.1.1.1.cmml" xref="Thmthm3a.p1.7.m7.2.2.1.1.1.1.1"><times id="Thmthm3a.p1.7.m7.2.2.1.1.1.1.1.2.cmml" xref="Thmthm3a.p1.7.m7.2.2.1.1.1.1.1.2"></times><apply id="Thmthm3a.p1.7.m7.2.2.1.1.1.1.1.3.cmml" xref="Thmthm3a.p1.7.m7.2.2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="Thmthm3a.p1.7.m7.2.2.1.1.1.1.1.3.1.cmml" xref="Thmthm3a.p1.7.m7.2.2.1.1.1.1.1.3">superscript</csymbol><ci id="Thmthm3a.p1.7.m7.2.2.1.1.1.1.1.3.2.cmml" xref="Thmthm3a.p1.7.m7.2.2.1.1.1.1.1.3.2">𝛾</ci><ci id="Thmthm3a.p1.7.m7.2.2.1.1.1.1.1.3.3.cmml" xref="Thmthm3a.p1.7.m7.2.2.1.1.1.1.1.3.3">𝐻</ci></apply><apply id="Thmthm3a.p1.7.m7.2.2.1.1.1.1.1.4.cmml" xref="Thmthm3a.p1.7.m7.2.2.1.1.1.1.1.4"><csymbol cd="ambiguous" id="Thmthm3a.p1.7.m7.2.2.1.1.1.1.1.4.1.cmml" xref="Thmthm3a.p1.7.m7.2.2.1.1.1.1.1.4">superscript</csymbol><ci id="Thmthm3a.p1.7.m7.2.2.1.1.1.1.1.4.2.cmml" xref="Thmthm3a.p1.7.m7.2.2.1.1.1.1.1.4.2">𝑉</ci><times id="Thmthm3a.p1.7.m7.2.2.1.1.1.1.1.4.3.cmml" xref="Thmthm3a.p1.7.m7.2.2.1.1.1.1.1.4.3"></times></apply><apply id="Thmthm3a.p1.7.m7.2.2.1.1.1.1.1.1.1.1.cmml" xref="Thmthm3a.p1.7.m7.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="Thmthm3a.p1.7.m7.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="Thmthm3a.p1.7.m7.2.2.1.1.1.1.1.1.1">subscript</csymbol><ci id="Thmthm3a.p1.7.m7.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="Thmthm3a.p1.7.m7.2.2.1.1.1.1.1.1.1.1.2">𝑠</ci><ci id="Thmthm3a.p1.7.m7.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="Thmthm3a.p1.7.m7.2.2.1.1.1.1.1.1.1.1.3">𝐻</ci></apply></apply><apply id="Thmthm3a.p1.7.m7.2.2.1.1.1.1.3.cmml" xref="Thmthm3a.p1.7.m7.2.2.1.1.1.1.3"><apply id="Thmthm3a.p1.7.m7.2.2.1.1.1.1.3.3.cmml" xref="Thmthm3a.p1.7.m7.2.2.1.1.1.1.3.3"><csymbol cd="ambiguous" id="Thmthm3a.p1.7.m7.2.2.1.1.1.1.3.3.1.cmml" xref="Thmthm3a.p1.7.m7.2.2.1.1.1.1.3.3">superscript</csymbol><apply id="Thmthm3a.p1.7.m7.2.2.1.1.1.1.3.3.2.cmml" xref="Thmthm3a.p1.7.m7.2.2.1.1.1.1.3.3"><csymbol cd="ambiguous" id="Thmthm3a.p1.7.m7.2.2.1.1.1.1.3.3.2.1.cmml" xref="Thmthm3a.p1.7.m7.2.2.1.1.1.1.3.3">subscript</csymbol><sum id="Thmthm3a.p1.7.m7.2.2.1.1.1.1.3.3.2.2.cmml" xref="Thmthm3a.p1.7.m7.2.2.1.1.1.1.3.3.2.2"></sum><apply id="Thmthm3a.p1.7.m7.2.2.1.1.1.1.3.3.2.3.cmml" xref="Thmthm3a.p1.7.m7.2.2.1.1.1.1.3.3.2.3"><eq id="Thmthm3a.p1.7.m7.2.2.1.1.1.1.3.3.2.3.1.cmml" xref="Thmthm3a.p1.7.m7.2.2.1.1.1.1.3.3.2.3.1"></eq><ci id="Thmthm3a.p1.7.m7.2.2.1.1.1.1.3.3.2.3.2.cmml" xref="Thmthm3a.p1.7.m7.2.2.1.1.1.1.3.3.2.3.2">ℎ</ci><cn id="Thmthm3a.p1.7.m7.2.2.1.1.1.1.3.3.2.3.3.cmml" type="integer" xref="Thmthm3a.p1.7.m7.2.2.1.1.1.1.3.3.2.3.3">0</cn></apply></apply><apply id="Thmthm3a.p1.7.m7.2.2.1.1.1.1.3.3.3.cmml" xref="Thmthm3a.p1.7.m7.2.2.1.1.1.1.3.3.3"><minus id="Thmthm3a.p1.7.m7.2.2.1.1.1.1.3.3.3.1.cmml" xref="Thmthm3a.p1.7.m7.2.2.1.1.1.1.3.3.3.1"></minus><ci id="Thmthm3a.p1.7.m7.2.2.1.1.1.1.3.3.3.2.cmml" xref="Thmthm3a.p1.7.m7.2.2.1.1.1.1.3.3.3.2">𝐻</ci><cn id="Thmthm3a.p1.7.m7.2.2.1.1.1.1.3.3.3.3.cmml" type="integer" xref="Thmthm3a.p1.7.m7.2.2.1.1.1.1.3.3.3.3">1</cn></apply></apply><apply id="Thmthm3a.p1.7.m7.2.2.1.1.1.1.3.2.cmml" xref="Thmthm3a.p1.7.m7.2.2.1.1.1.1.3.2"><times id="Thmthm3a.p1.7.m7.2.2.1.1.1.1.3.2.3.cmml" xref="Thmthm3a.p1.7.m7.2.2.1.1.1.1.3.2.3"></times><apply id="Thmthm3a.p1.7.m7.2.2.1.1.1.1.3.2.4.cmml" xref="Thmthm3a.p1.7.m7.2.2.1.1.1.1.3.2.4"><csymbol cd="ambiguous" id="Thmthm3a.p1.7.m7.2.2.1.1.1.1.3.2.4.1.cmml" xref="Thmthm3a.p1.7.m7.2.2.1.1.1.1.3.2.4">superscript</csymbol><ci id="Thmthm3a.p1.7.m7.2.2.1.1.1.1.3.2.4.2.cmml" xref="Thmthm3a.p1.7.m7.2.2.1.1.1.1.3.2.4.2">𝛾</ci><ci id="Thmthm3a.p1.7.m7.2.2.1.1.1.1.3.2.4.3.cmml" xref="Thmthm3a.p1.7.m7.2.2.1.1.1.1.3.2.4.3">ℎ</ci></apply><ci id="Thmthm3a.p1.7.m7.2.2.1.1.1.1.3.2.5.cmml" xref="Thmthm3a.p1.7.m7.2.2.1.1.1.1.3.2.5">𝑅</ci><interval closure="open" id="Thmthm3a.p1.7.m7.2.2.1.1.1.1.3.2.2.3.cmml" xref="Thmthm3a.p1.7.m7.2.2.1.1.1.1.3.2.2.2"><apply id="Thmthm3a.p1.7.m7.2.2.1.1.1.1.2.1.1.1.1.cmml" xref="Thmthm3a.p1.7.m7.2.2.1.1.1.1.2.1.1.1.1"><csymbol cd="ambiguous" id="Thmthm3a.p1.7.m7.2.2.1.1.1.1.2.1.1.1.1.1.cmml" xref="Thmthm3a.p1.7.m7.2.2.1.1.1.1.2.1.1.1.1">subscript</csymbol><ci id="Thmthm3a.p1.7.m7.2.2.1.1.1.1.2.1.1.1.1.2.cmml" xref="Thmthm3a.p1.7.m7.2.2.1.1.1.1.2.1.1.1.1.2">𝑠</ci><ci id="Thmthm3a.p1.7.m7.2.2.1.1.1.1.2.1.1.1.1.3.cmml" xref="Thmthm3a.p1.7.m7.2.2.1.1.1.1.2.1.1.1.1.3">ℎ</ci></apply><apply id="Thmthm3a.p1.7.m7.2.2.1.1.1.1.3.2.2.2.2.cmml" xref="Thmthm3a.p1.7.m7.2.2.1.1.1.1.3.2.2.2.2"><csymbol cd="ambiguous" id="Thmthm3a.p1.7.m7.2.2.1.1.1.1.3.2.2.2.2.1.cmml" xref="Thmthm3a.p1.7.m7.2.2.1.1.1.1.3.2.2.2.2">subscript</csymbol><ci id="Thmthm3a.p1.7.m7.2.2.1.1.1.1.3.2.2.2.2.2.cmml" xref="Thmthm3a.p1.7.m7.2.2.1.1.1.1.3.2.2.2.2.2">𝑎</ci><ci id="Thmthm3a.p1.7.m7.2.2.1.1.1.1.3.2.2.2.2.3.cmml" xref="Thmthm3a.p1.7.m7.2.2.1.1.1.1.3.2.2.2.2.3">ℎ</ci></apply></interval></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmthm3a.p1.7.m7.2c">\mathbf{S}(\tau)=\mathbb{E}_{\tau}\left[\gamma^{H}V^{*}(s_{H})+\sum_{h=0}^{H-1%
}\gamma^{h}R(s_{h},a_{h})\right]</annotation><annotation encoding="application/x-llamapun" id="Thmthm3a.p1.7.m7.2d">bold_S ( italic_τ ) = blackboard_E start_POSTSUBSCRIPT italic_τ end_POSTSUBSCRIPT [ italic_γ start_POSTSUPERSCRIPT italic_H end_POSTSUPERSCRIPT italic_V start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ( italic_s start_POSTSUBSCRIPT italic_H end_POSTSUBSCRIPT ) + ∑ start_POSTSUBSCRIPT italic_h = 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_H - 1 end_POSTSUPERSCRIPT italic_γ start_POSTSUPERSCRIPT italic_h end_POSTSUPERSCRIPT italic_R ( italic_s start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT , italic_a start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT ) ]</annotation></semantics></math> and <math alttext="\mathbf{S}(\phi(\tau))=\mathbb{E}_{\tau}\left[\gamma^{H}V^{*}(\phi(s_{H}))+%
\sum_{h=0}^{H-1}\gamma^{h}R(\phi(s_{h}),a_{h})\right]" class="ltx_Math" display="inline" id="Thmthm3a.p1.8.m8.3"><semantics id="Thmthm3a.p1.8.m8.3a"><mrow id="Thmthm3a.p1.8.m8.3.3" xref="Thmthm3a.p1.8.m8.3.3.cmml"><mrow id="Thmthm3a.p1.8.m8.2.2.1" xref="Thmthm3a.p1.8.m8.2.2.1.cmml"><mi id="Thmthm3a.p1.8.m8.2.2.1.3" xref="Thmthm3a.p1.8.m8.2.2.1.3.cmml">𝐒</mi><mo id="Thmthm3a.p1.8.m8.2.2.1.2" xref="Thmthm3a.p1.8.m8.2.2.1.2.cmml">⁢</mo><mrow id="Thmthm3a.p1.8.m8.2.2.1.1.1" xref="Thmthm3a.p1.8.m8.2.2.1.1.1.1.cmml"><mo id="Thmthm3a.p1.8.m8.2.2.1.1.1.2" stretchy="false" xref="Thmthm3a.p1.8.m8.2.2.1.1.1.1.cmml">(</mo><mrow id="Thmthm3a.p1.8.m8.2.2.1.1.1.1" xref="Thmthm3a.p1.8.m8.2.2.1.1.1.1.cmml"><mi id="Thmthm3a.p1.8.m8.2.2.1.1.1.1.2" xref="Thmthm3a.p1.8.m8.2.2.1.1.1.1.2.cmml">ϕ</mi><mo id="Thmthm3a.p1.8.m8.2.2.1.1.1.1.1" xref="Thmthm3a.p1.8.m8.2.2.1.1.1.1.1.cmml">⁢</mo><mrow id="Thmthm3a.p1.8.m8.2.2.1.1.1.1.3.2" xref="Thmthm3a.p1.8.m8.2.2.1.1.1.1.cmml"><mo id="Thmthm3a.p1.8.m8.2.2.1.1.1.1.3.2.1" stretchy="false" xref="Thmthm3a.p1.8.m8.2.2.1.1.1.1.cmml">(</mo><mi id="Thmthm3a.p1.8.m8.1.1" xref="Thmthm3a.p1.8.m8.1.1.cmml">τ</mi><mo id="Thmthm3a.p1.8.m8.2.2.1.1.1.1.3.2.2" stretchy="false" xref="Thmthm3a.p1.8.m8.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="Thmthm3a.p1.8.m8.2.2.1.1.1.3" stretchy="false" xref="Thmthm3a.p1.8.m8.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="Thmthm3a.p1.8.m8.3.3.3" xref="Thmthm3a.p1.8.m8.3.3.3.cmml">=</mo><mrow id="Thmthm3a.p1.8.m8.3.3.2" xref="Thmthm3a.p1.8.m8.3.3.2.cmml"><msub id="Thmthm3a.p1.8.m8.3.3.2.3" xref="Thmthm3a.p1.8.m8.3.3.2.3.cmml"><mi id="Thmthm3a.p1.8.m8.3.3.2.3.2" xref="Thmthm3a.p1.8.m8.3.3.2.3.2.cmml">𝔼</mi><mi id="Thmthm3a.p1.8.m8.3.3.2.3.3" xref="Thmthm3a.p1.8.m8.3.3.2.3.3.cmml">τ</mi></msub><mo id="Thmthm3a.p1.8.m8.3.3.2.2" xref="Thmthm3a.p1.8.m8.3.3.2.2.cmml">⁢</mo><mrow id="Thmthm3a.p1.8.m8.3.3.2.1.1" xref="Thmthm3a.p1.8.m8.3.3.2.1.2.cmml"><mo id="Thmthm3a.p1.8.m8.3.3.2.1.1.2" xref="Thmthm3a.p1.8.m8.3.3.2.1.2.1.cmml">[</mo><mrow id="Thmthm3a.p1.8.m8.3.3.2.1.1.1" xref="Thmthm3a.p1.8.m8.3.3.2.1.1.1.cmml"><mrow id="Thmthm3a.p1.8.m8.3.3.2.1.1.1.1" xref="Thmthm3a.p1.8.m8.3.3.2.1.1.1.1.cmml"><msup id="Thmthm3a.p1.8.m8.3.3.2.1.1.1.1.3" xref="Thmthm3a.p1.8.m8.3.3.2.1.1.1.1.3.cmml"><mi id="Thmthm3a.p1.8.m8.3.3.2.1.1.1.1.3.2" xref="Thmthm3a.p1.8.m8.3.3.2.1.1.1.1.3.2.cmml">γ</mi><mi id="Thmthm3a.p1.8.m8.3.3.2.1.1.1.1.3.3" xref="Thmthm3a.p1.8.m8.3.3.2.1.1.1.1.3.3.cmml">H</mi></msup><mo id="Thmthm3a.p1.8.m8.3.3.2.1.1.1.1.2" xref="Thmthm3a.p1.8.m8.3.3.2.1.1.1.1.2.cmml">⁢</mo><msup id="Thmthm3a.p1.8.m8.3.3.2.1.1.1.1.4" xref="Thmthm3a.p1.8.m8.3.3.2.1.1.1.1.4.cmml"><mi id="Thmthm3a.p1.8.m8.3.3.2.1.1.1.1.4.2" xref="Thmthm3a.p1.8.m8.3.3.2.1.1.1.1.4.2.cmml">V</mi><mo id="Thmthm3a.p1.8.m8.3.3.2.1.1.1.1.4.3" xref="Thmthm3a.p1.8.m8.3.3.2.1.1.1.1.4.3.cmml">∗</mo></msup><mo id="Thmthm3a.p1.8.m8.3.3.2.1.1.1.1.2a" xref="Thmthm3a.p1.8.m8.3.3.2.1.1.1.1.2.cmml">⁢</mo><mrow id="Thmthm3a.p1.8.m8.3.3.2.1.1.1.1.1.1" xref="Thmthm3a.p1.8.m8.3.3.2.1.1.1.1.1.1.1.cmml"><mo id="Thmthm3a.p1.8.m8.3.3.2.1.1.1.1.1.1.2" stretchy="false" xref="Thmthm3a.p1.8.m8.3.3.2.1.1.1.1.1.1.1.cmml">(</mo><mrow id="Thmthm3a.p1.8.m8.3.3.2.1.1.1.1.1.1.1" xref="Thmthm3a.p1.8.m8.3.3.2.1.1.1.1.1.1.1.cmml"><mi id="Thmthm3a.p1.8.m8.3.3.2.1.1.1.1.1.1.1.3" xref="Thmthm3a.p1.8.m8.3.3.2.1.1.1.1.1.1.1.3.cmml">ϕ</mi><mo id="Thmthm3a.p1.8.m8.3.3.2.1.1.1.1.1.1.1.2" xref="Thmthm3a.p1.8.m8.3.3.2.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="Thmthm3a.p1.8.m8.3.3.2.1.1.1.1.1.1.1.1.1" xref="Thmthm3a.p1.8.m8.3.3.2.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="Thmthm3a.p1.8.m8.3.3.2.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="Thmthm3a.p1.8.m8.3.3.2.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="Thmthm3a.p1.8.m8.3.3.2.1.1.1.1.1.1.1.1.1.1" xref="Thmthm3a.p1.8.m8.3.3.2.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="Thmthm3a.p1.8.m8.3.3.2.1.1.1.1.1.1.1.1.1.1.2" xref="Thmthm3a.p1.8.m8.3.3.2.1.1.1.1.1.1.1.1.1.1.2.cmml">s</mi><mi id="Thmthm3a.p1.8.m8.3.3.2.1.1.1.1.1.1.1.1.1.1.3" xref="Thmthm3a.p1.8.m8.3.3.2.1.1.1.1.1.1.1.1.1.1.3.cmml">H</mi></msub><mo id="Thmthm3a.p1.8.m8.3.3.2.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="Thmthm3a.p1.8.m8.3.3.2.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="Thmthm3a.p1.8.m8.3.3.2.1.1.1.1.1.1.3" stretchy="false" xref="Thmthm3a.p1.8.m8.3.3.2.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="Thmthm3a.p1.8.m8.3.3.2.1.1.1.4" rspace="0.055em" xref="Thmthm3a.p1.8.m8.3.3.2.1.1.1.4.cmml">+</mo><mrow id="Thmthm3a.p1.8.m8.3.3.2.1.1.1.3" xref="Thmthm3a.p1.8.m8.3.3.2.1.1.1.3.cmml"><msubsup id="Thmthm3a.p1.8.m8.3.3.2.1.1.1.3.3" xref="Thmthm3a.p1.8.m8.3.3.2.1.1.1.3.3.cmml"><mo id="Thmthm3a.p1.8.m8.3.3.2.1.1.1.3.3.2.2" xref="Thmthm3a.p1.8.m8.3.3.2.1.1.1.3.3.2.2.cmml">∑</mo><mrow id="Thmthm3a.p1.8.m8.3.3.2.1.1.1.3.3.2.3" xref="Thmthm3a.p1.8.m8.3.3.2.1.1.1.3.3.2.3.cmml"><mi id="Thmthm3a.p1.8.m8.3.3.2.1.1.1.3.3.2.3.2" xref="Thmthm3a.p1.8.m8.3.3.2.1.1.1.3.3.2.3.2.cmml">h</mi><mo id="Thmthm3a.p1.8.m8.3.3.2.1.1.1.3.3.2.3.1" xref="Thmthm3a.p1.8.m8.3.3.2.1.1.1.3.3.2.3.1.cmml">=</mo><mn id="Thmthm3a.p1.8.m8.3.3.2.1.1.1.3.3.2.3.3" xref="Thmthm3a.p1.8.m8.3.3.2.1.1.1.3.3.2.3.3.cmml">0</mn></mrow><mrow id="Thmthm3a.p1.8.m8.3.3.2.1.1.1.3.3.3" xref="Thmthm3a.p1.8.m8.3.3.2.1.1.1.3.3.3.cmml"><mi id="Thmthm3a.p1.8.m8.3.3.2.1.1.1.3.3.3.2" xref="Thmthm3a.p1.8.m8.3.3.2.1.1.1.3.3.3.2.cmml">H</mi><mo id="Thmthm3a.p1.8.m8.3.3.2.1.1.1.3.3.3.1" xref="Thmthm3a.p1.8.m8.3.3.2.1.1.1.3.3.3.1.cmml">−</mo><mn id="Thmthm3a.p1.8.m8.3.3.2.1.1.1.3.3.3.3" xref="Thmthm3a.p1.8.m8.3.3.2.1.1.1.3.3.3.3.cmml">1</mn></mrow></msubsup><mrow id="Thmthm3a.p1.8.m8.3.3.2.1.1.1.3.2" xref="Thmthm3a.p1.8.m8.3.3.2.1.1.1.3.2.cmml"><msup id="Thmthm3a.p1.8.m8.3.3.2.1.1.1.3.2.4" xref="Thmthm3a.p1.8.m8.3.3.2.1.1.1.3.2.4.cmml"><mi id="Thmthm3a.p1.8.m8.3.3.2.1.1.1.3.2.4.2" xref="Thmthm3a.p1.8.m8.3.3.2.1.1.1.3.2.4.2.cmml">γ</mi><mi id="Thmthm3a.p1.8.m8.3.3.2.1.1.1.3.2.4.3" xref="Thmthm3a.p1.8.m8.3.3.2.1.1.1.3.2.4.3.cmml">h</mi></msup><mo id="Thmthm3a.p1.8.m8.3.3.2.1.1.1.3.2.3" xref="Thmthm3a.p1.8.m8.3.3.2.1.1.1.3.2.3.cmml">⁢</mo><mi id="Thmthm3a.p1.8.m8.3.3.2.1.1.1.3.2.5" xref="Thmthm3a.p1.8.m8.3.3.2.1.1.1.3.2.5.cmml">R</mi><mo id="Thmthm3a.p1.8.m8.3.3.2.1.1.1.3.2.3a" xref="Thmthm3a.p1.8.m8.3.3.2.1.1.1.3.2.3.cmml">⁢</mo><mrow id="Thmthm3a.p1.8.m8.3.3.2.1.1.1.3.2.2.2" xref="Thmthm3a.p1.8.m8.3.3.2.1.1.1.3.2.2.3.cmml"><mo id="Thmthm3a.p1.8.m8.3.3.2.1.1.1.3.2.2.2.3" stretchy="false" xref="Thmthm3a.p1.8.m8.3.3.2.1.1.1.3.2.2.3.cmml">(</mo><mrow id="Thmthm3a.p1.8.m8.3.3.2.1.1.1.2.1.1.1.1" xref="Thmthm3a.p1.8.m8.3.3.2.1.1.1.2.1.1.1.1.cmml"><mi id="Thmthm3a.p1.8.m8.3.3.2.1.1.1.2.1.1.1.1.3" xref="Thmthm3a.p1.8.m8.3.3.2.1.1.1.2.1.1.1.1.3.cmml">ϕ</mi><mo id="Thmthm3a.p1.8.m8.3.3.2.1.1.1.2.1.1.1.1.2" xref="Thmthm3a.p1.8.m8.3.3.2.1.1.1.2.1.1.1.1.2.cmml">⁢</mo><mrow id="Thmthm3a.p1.8.m8.3.3.2.1.1.1.2.1.1.1.1.1.1" xref="Thmthm3a.p1.8.m8.3.3.2.1.1.1.2.1.1.1.1.1.1.1.cmml"><mo id="Thmthm3a.p1.8.m8.3.3.2.1.1.1.2.1.1.1.1.1.1.2" stretchy="false" xref="Thmthm3a.p1.8.m8.3.3.2.1.1.1.2.1.1.1.1.1.1.1.cmml">(</mo><msub id="Thmthm3a.p1.8.m8.3.3.2.1.1.1.2.1.1.1.1.1.1.1" xref="Thmthm3a.p1.8.m8.3.3.2.1.1.1.2.1.1.1.1.1.1.1.cmml"><mi id="Thmthm3a.p1.8.m8.3.3.2.1.1.1.2.1.1.1.1.1.1.1.2" xref="Thmthm3a.p1.8.m8.3.3.2.1.1.1.2.1.1.1.1.1.1.1.2.cmml">s</mi><mi id="Thmthm3a.p1.8.m8.3.3.2.1.1.1.2.1.1.1.1.1.1.1.3" xref="Thmthm3a.p1.8.m8.3.3.2.1.1.1.2.1.1.1.1.1.1.1.3.cmml">h</mi></msub><mo id="Thmthm3a.p1.8.m8.3.3.2.1.1.1.2.1.1.1.1.1.1.3" stretchy="false" xref="Thmthm3a.p1.8.m8.3.3.2.1.1.1.2.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="Thmthm3a.p1.8.m8.3.3.2.1.1.1.3.2.2.2.4" xref="Thmthm3a.p1.8.m8.3.3.2.1.1.1.3.2.2.3.cmml">,</mo><msub id="Thmthm3a.p1.8.m8.3.3.2.1.1.1.3.2.2.2.2" xref="Thmthm3a.p1.8.m8.3.3.2.1.1.1.3.2.2.2.2.cmml"><mi id="Thmthm3a.p1.8.m8.3.3.2.1.1.1.3.2.2.2.2.2" xref="Thmthm3a.p1.8.m8.3.3.2.1.1.1.3.2.2.2.2.2.cmml">a</mi><mi id="Thmthm3a.p1.8.m8.3.3.2.1.1.1.3.2.2.2.2.3" xref="Thmthm3a.p1.8.m8.3.3.2.1.1.1.3.2.2.2.2.3.cmml">h</mi></msub><mo id="Thmthm3a.p1.8.m8.3.3.2.1.1.1.3.2.2.2.5" stretchy="false" xref="Thmthm3a.p1.8.m8.3.3.2.1.1.1.3.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="Thmthm3a.p1.8.m8.3.3.2.1.1.3" xref="Thmthm3a.p1.8.m8.3.3.2.1.2.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmthm3a.p1.8.m8.3b"><apply id="Thmthm3a.p1.8.m8.3.3.cmml" xref="Thmthm3a.p1.8.m8.3.3"><eq id="Thmthm3a.p1.8.m8.3.3.3.cmml" xref="Thmthm3a.p1.8.m8.3.3.3"></eq><apply id="Thmthm3a.p1.8.m8.2.2.1.cmml" xref="Thmthm3a.p1.8.m8.2.2.1"><times id="Thmthm3a.p1.8.m8.2.2.1.2.cmml" xref="Thmthm3a.p1.8.m8.2.2.1.2"></times><ci id="Thmthm3a.p1.8.m8.2.2.1.3.cmml" xref="Thmthm3a.p1.8.m8.2.2.1.3">𝐒</ci><apply id="Thmthm3a.p1.8.m8.2.2.1.1.1.1.cmml" xref="Thmthm3a.p1.8.m8.2.2.1.1.1"><times id="Thmthm3a.p1.8.m8.2.2.1.1.1.1.1.cmml" xref="Thmthm3a.p1.8.m8.2.2.1.1.1.1.1"></times><ci id="Thmthm3a.p1.8.m8.2.2.1.1.1.1.2.cmml" xref="Thmthm3a.p1.8.m8.2.2.1.1.1.1.2">italic-ϕ</ci><ci id="Thmthm3a.p1.8.m8.1.1.cmml" xref="Thmthm3a.p1.8.m8.1.1">𝜏</ci></apply></apply><apply id="Thmthm3a.p1.8.m8.3.3.2.cmml" xref="Thmthm3a.p1.8.m8.3.3.2"><times id="Thmthm3a.p1.8.m8.3.3.2.2.cmml" xref="Thmthm3a.p1.8.m8.3.3.2.2"></times><apply id="Thmthm3a.p1.8.m8.3.3.2.3.cmml" xref="Thmthm3a.p1.8.m8.3.3.2.3"><csymbol cd="ambiguous" id="Thmthm3a.p1.8.m8.3.3.2.3.1.cmml" xref="Thmthm3a.p1.8.m8.3.3.2.3">subscript</csymbol><ci id="Thmthm3a.p1.8.m8.3.3.2.3.2.cmml" xref="Thmthm3a.p1.8.m8.3.3.2.3.2">𝔼</ci><ci id="Thmthm3a.p1.8.m8.3.3.2.3.3.cmml" xref="Thmthm3a.p1.8.m8.3.3.2.3.3">𝜏</ci></apply><apply id="Thmthm3a.p1.8.m8.3.3.2.1.2.cmml" xref="Thmthm3a.p1.8.m8.3.3.2.1.1"><csymbol cd="latexml" id="Thmthm3a.p1.8.m8.3.3.2.1.2.1.cmml" xref="Thmthm3a.p1.8.m8.3.3.2.1.1.2">delimited-[]</csymbol><apply id="Thmthm3a.p1.8.m8.3.3.2.1.1.1.cmml" xref="Thmthm3a.p1.8.m8.3.3.2.1.1.1"><plus id="Thmthm3a.p1.8.m8.3.3.2.1.1.1.4.cmml" xref="Thmthm3a.p1.8.m8.3.3.2.1.1.1.4"></plus><apply id="Thmthm3a.p1.8.m8.3.3.2.1.1.1.1.cmml" xref="Thmthm3a.p1.8.m8.3.3.2.1.1.1.1"><times id="Thmthm3a.p1.8.m8.3.3.2.1.1.1.1.2.cmml" xref="Thmthm3a.p1.8.m8.3.3.2.1.1.1.1.2"></times><apply id="Thmthm3a.p1.8.m8.3.3.2.1.1.1.1.3.cmml" xref="Thmthm3a.p1.8.m8.3.3.2.1.1.1.1.3"><csymbol cd="ambiguous" id="Thmthm3a.p1.8.m8.3.3.2.1.1.1.1.3.1.cmml" xref="Thmthm3a.p1.8.m8.3.3.2.1.1.1.1.3">superscript</csymbol><ci id="Thmthm3a.p1.8.m8.3.3.2.1.1.1.1.3.2.cmml" xref="Thmthm3a.p1.8.m8.3.3.2.1.1.1.1.3.2">𝛾</ci><ci id="Thmthm3a.p1.8.m8.3.3.2.1.1.1.1.3.3.cmml" xref="Thmthm3a.p1.8.m8.3.3.2.1.1.1.1.3.3">𝐻</ci></apply><apply id="Thmthm3a.p1.8.m8.3.3.2.1.1.1.1.4.cmml" xref="Thmthm3a.p1.8.m8.3.3.2.1.1.1.1.4"><csymbol cd="ambiguous" id="Thmthm3a.p1.8.m8.3.3.2.1.1.1.1.4.1.cmml" xref="Thmthm3a.p1.8.m8.3.3.2.1.1.1.1.4">superscript</csymbol><ci id="Thmthm3a.p1.8.m8.3.3.2.1.1.1.1.4.2.cmml" xref="Thmthm3a.p1.8.m8.3.3.2.1.1.1.1.4.2">𝑉</ci><times id="Thmthm3a.p1.8.m8.3.3.2.1.1.1.1.4.3.cmml" xref="Thmthm3a.p1.8.m8.3.3.2.1.1.1.1.4.3"></times></apply><apply id="Thmthm3a.p1.8.m8.3.3.2.1.1.1.1.1.1.1.cmml" xref="Thmthm3a.p1.8.m8.3.3.2.1.1.1.1.1.1"><times id="Thmthm3a.p1.8.m8.3.3.2.1.1.1.1.1.1.1.2.cmml" xref="Thmthm3a.p1.8.m8.3.3.2.1.1.1.1.1.1.1.2"></times><ci id="Thmthm3a.p1.8.m8.3.3.2.1.1.1.1.1.1.1.3.cmml" xref="Thmthm3a.p1.8.m8.3.3.2.1.1.1.1.1.1.1.3">italic-ϕ</ci><apply id="Thmthm3a.p1.8.m8.3.3.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="Thmthm3a.p1.8.m8.3.3.2.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="Thmthm3a.p1.8.m8.3.3.2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="Thmthm3a.p1.8.m8.3.3.2.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="Thmthm3a.p1.8.m8.3.3.2.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="Thmthm3a.p1.8.m8.3.3.2.1.1.1.1.1.1.1.1.1.1.2">𝑠</ci><ci id="Thmthm3a.p1.8.m8.3.3.2.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="Thmthm3a.p1.8.m8.3.3.2.1.1.1.1.1.1.1.1.1.1.3">𝐻</ci></apply></apply></apply><apply id="Thmthm3a.p1.8.m8.3.3.2.1.1.1.3.cmml" xref="Thmthm3a.p1.8.m8.3.3.2.1.1.1.3"><apply id="Thmthm3a.p1.8.m8.3.3.2.1.1.1.3.3.cmml" xref="Thmthm3a.p1.8.m8.3.3.2.1.1.1.3.3"><csymbol cd="ambiguous" id="Thmthm3a.p1.8.m8.3.3.2.1.1.1.3.3.1.cmml" xref="Thmthm3a.p1.8.m8.3.3.2.1.1.1.3.3">superscript</csymbol><apply id="Thmthm3a.p1.8.m8.3.3.2.1.1.1.3.3.2.cmml" xref="Thmthm3a.p1.8.m8.3.3.2.1.1.1.3.3"><csymbol cd="ambiguous" id="Thmthm3a.p1.8.m8.3.3.2.1.1.1.3.3.2.1.cmml" xref="Thmthm3a.p1.8.m8.3.3.2.1.1.1.3.3">subscript</csymbol><sum id="Thmthm3a.p1.8.m8.3.3.2.1.1.1.3.3.2.2.cmml" xref="Thmthm3a.p1.8.m8.3.3.2.1.1.1.3.3.2.2"></sum><apply id="Thmthm3a.p1.8.m8.3.3.2.1.1.1.3.3.2.3.cmml" xref="Thmthm3a.p1.8.m8.3.3.2.1.1.1.3.3.2.3"><eq id="Thmthm3a.p1.8.m8.3.3.2.1.1.1.3.3.2.3.1.cmml" xref="Thmthm3a.p1.8.m8.3.3.2.1.1.1.3.3.2.3.1"></eq><ci id="Thmthm3a.p1.8.m8.3.3.2.1.1.1.3.3.2.3.2.cmml" xref="Thmthm3a.p1.8.m8.3.3.2.1.1.1.3.3.2.3.2">ℎ</ci><cn id="Thmthm3a.p1.8.m8.3.3.2.1.1.1.3.3.2.3.3.cmml" type="integer" xref="Thmthm3a.p1.8.m8.3.3.2.1.1.1.3.3.2.3.3">0</cn></apply></apply><apply id="Thmthm3a.p1.8.m8.3.3.2.1.1.1.3.3.3.cmml" xref="Thmthm3a.p1.8.m8.3.3.2.1.1.1.3.3.3"><minus id="Thmthm3a.p1.8.m8.3.3.2.1.1.1.3.3.3.1.cmml" xref="Thmthm3a.p1.8.m8.3.3.2.1.1.1.3.3.3.1"></minus><ci id="Thmthm3a.p1.8.m8.3.3.2.1.1.1.3.3.3.2.cmml" xref="Thmthm3a.p1.8.m8.3.3.2.1.1.1.3.3.3.2">𝐻</ci><cn id="Thmthm3a.p1.8.m8.3.3.2.1.1.1.3.3.3.3.cmml" type="integer" xref="Thmthm3a.p1.8.m8.3.3.2.1.1.1.3.3.3.3">1</cn></apply></apply><apply id="Thmthm3a.p1.8.m8.3.3.2.1.1.1.3.2.cmml" xref="Thmthm3a.p1.8.m8.3.3.2.1.1.1.3.2"><times id="Thmthm3a.p1.8.m8.3.3.2.1.1.1.3.2.3.cmml" xref="Thmthm3a.p1.8.m8.3.3.2.1.1.1.3.2.3"></times><apply id="Thmthm3a.p1.8.m8.3.3.2.1.1.1.3.2.4.cmml" xref="Thmthm3a.p1.8.m8.3.3.2.1.1.1.3.2.4"><csymbol cd="ambiguous" id="Thmthm3a.p1.8.m8.3.3.2.1.1.1.3.2.4.1.cmml" xref="Thmthm3a.p1.8.m8.3.3.2.1.1.1.3.2.4">superscript</csymbol><ci id="Thmthm3a.p1.8.m8.3.3.2.1.1.1.3.2.4.2.cmml" xref="Thmthm3a.p1.8.m8.3.3.2.1.1.1.3.2.4.2">𝛾</ci><ci id="Thmthm3a.p1.8.m8.3.3.2.1.1.1.3.2.4.3.cmml" xref="Thmthm3a.p1.8.m8.3.3.2.1.1.1.3.2.4.3">ℎ</ci></apply><ci id="Thmthm3a.p1.8.m8.3.3.2.1.1.1.3.2.5.cmml" xref="Thmthm3a.p1.8.m8.3.3.2.1.1.1.3.2.5">𝑅</ci><interval closure="open" id="Thmthm3a.p1.8.m8.3.3.2.1.1.1.3.2.2.3.cmml" xref="Thmthm3a.p1.8.m8.3.3.2.1.1.1.3.2.2.2"><apply id="Thmthm3a.p1.8.m8.3.3.2.1.1.1.2.1.1.1.1.cmml" xref="Thmthm3a.p1.8.m8.3.3.2.1.1.1.2.1.1.1.1"><times id="Thmthm3a.p1.8.m8.3.3.2.1.1.1.2.1.1.1.1.2.cmml" xref="Thmthm3a.p1.8.m8.3.3.2.1.1.1.2.1.1.1.1.2"></times><ci id="Thmthm3a.p1.8.m8.3.3.2.1.1.1.2.1.1.1.1.3.cmml" xref="Thmthm3a.p1.8.m8.3.3.2.1.1.1.2.1.1.1.1.3">italic-ϕ</ci><apply id="Thmthm3a.p1.8.m8.3.3.2.1.1.1.2.1.1.1.1.1.1.1.cmml" xref="Thmthm3a.p1.8.m8.3.3.2.1.1.1.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="Thmthm3a.p1.8.m8.3.3.2.1.1.1.2.1.1.1.1.1.1.1.1.cmml" xref="Thmthm3a.p1.8.m8.3.3.2.1.1.1.2.1.1.1.1.1.1">subscript</csymbol><ci id="Thmthm3a.p1.8.m8.3.3.2.1.1.1.2.1.1.1.1.1.1.1.2.cmml" xref="Thmthm3a.p1.8.m8.3.3.2.1.1.1.2.1.1.1.1.1.1.1.2">𝑠</ci><ci id="Thmthm3a.p1.8.m8.3.3.2.1.1.1.2.1.1.1.1.1.1.1.3.cmml" xref="Thmthm3a.p1.8.m8.3.3.2.1.1.1.2.1.1.1.1.1.1.1.3">ℎ</ci></apply></apply><apply id="Thmthm3a.p1.8.m8.3.3.2.1.1.1.3.2.2.2.2.cmml" xref="Thmthm3a.p1.8.m8.3.3.2.1.1.1.3.2.2.2.2"><csymbol cd="ambiguous" id="Thmthm3a.p1.8.m8.3.3.2.1.1.1.3.2.2.2.2.1.cmml" xref="Thmthm3a.p1.8.m8.3.3.2.1.1.1.3.2.2.2.2">subscript</csymbol><ci id="Thmthm3a.p1.8.m8.3.3.2.1.1.1.3.2.2.2.2.2.cmml" xref="Thmthm3a.p1.8.m8.3.3.2.1.1.1.3.2.2.2.2.2">𝑎</ci><ci id="Thmthm3a.p1.8.m8.3.3.2.1.1.1.3.2.2.2.2.3.cmml" xref="Thmthm3a.p1.8.m8.3.3.2.1.1.1.3.2.2.2.2.3">ℎ</ci></apply></interval></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmthm3a.p1.8.m8.3c">\mathbf{S}(\phi(\tau))=\mathbb{E}_{\tau}\left[\gamma^{H}V^{*}(\phi(s_{H}))+%
\sum_{h=0}^{H-1}\gamma^{h}R(\phi(s_{h}),a_{h})\right]</annotation><annotation encoding="application/x-llamapun" id="Thmthm3a.p1.8.m8.3d">bold_S ( italic_ϕ ( italic_τ ) ) = blackboard_E start_POSTSUBSCRIPT italic_τ end_POSTSUBSCRIPT [ italic_γ start_POSTSUPERSCRIPT italic_H end_POSTSUPERSCRIPT italic_V start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ( italic_ϕ ( italic_s start_POSTSUBSCRIPT italic_H end_POSTSUBSCRIPT ) ) + ∑ start_POSTSUBSCRIPT italic_h = 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_H - 1 end_POSTSUPERSCRIPT italic_γ start_POSTSUPERSCRIPT italic_h end_POSTSUPERSCRIPT italic_R ( italic_ϕ ( italic_s start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT ) , italic_a start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT ) ]</annotation></semantics></math> can be bounded as follows.</p>
<table class="ltx_equation ltx_eqn_table" id="A1.E17">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="|\mathbf{S}(\tau)-\mathbf{S}(\phi(\tau))|\leq\frac{2\gamma^{H}(\epsilon+{%
\mathcal{L}})}{(1-\gamma)(1-c)}+\frac{2\epsilon(1-\gamma^{H-1})}{(1-\gamma)(1-%
c)}" class="ltx_Math" display="block" id="A1.E17.m1.9"><semantics id="A1.E17.m1.9a"><mrow id="A1.E17.m1.9.9" xref="A1.E17.m1.9.9.cmml"><mrow id="A1.E17.m1.9.9.1.1" xref="A1.E17.m1.9.9.1.2.cmml"><mo id="A1.E17.m1.9.9.1.1.2" stretchy="false" xref="A1.E17.m1.9.9.1.2.1.cmml">|</mo><mrow id="A1.E17.m1.9.9.1.1.1" xref="A1.E17.m1.9.9.1.1.1.cmml"><mrow id="A1.E17.m1.9.9.1.1.1.3" xref="A1.E17.m1.9.9.1.1.1.3.cmml"><mi id="A1.E17.m1.9.9.1.1.1.3.2" xref="A1.E17.m1.9.9.1.1.1.3.2.cmml">𝐒</mi><mo id="A1.E17.m1.9.9.1.1.1.3.1" xref="A1.E17.m1.9.9.1.1.1.3.1.cmml">⁢</mo><mrow id="A1.E17.m1.9.9.1.1.1.3.3.2" xref="A1.E17.m1.9.9.1.1.1.3.cmml"><mo id="A1.E17.m1.9.9.1.1.1.3.3.2.1" stretchy="false" xref="A1.E17.m1.9.9.1.1.1.3.cmml">(</mo><mi id="A1.E17.m1.7.7" xref="A1.E17.m1.7.7.cmml">τ</mi><mo id="A1.E17.m1.9.9.1.1.1.3.3.2.2" stretchy="false" xref="A1.E17.m1.9.9.1.1.1.3.cmml">)</mo></mrow></mrow><mo id="A1.E17.m1.9.9.1.1.1.2" xref="A1.E17.m1.9.9.1.1.1.2.cmml">−</mo><mrow id="A1.E17.m1.9.9.1.1.1.1" xref="A1.E17.m1.9.9.1.1.1.1.cmml"><mi id="A1.E17.m1.9.9.1.1.1.1.3" xref="A1.E17.m1.9.9.1.1.1.1.3.cmml">𝐒</mi><mo id="A1.E17.m1.9.9.1.1.1.1.2" xref="A1.E17.m1.9.9.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.E17.m1.9.9.1.1.1.1.1.1" xref="A1.E17.m1.9.9.1.1.1.1.1.1.1.cmml"><mo id="A1.E17.m1.9.9.1.1.1.1.1.1.2" stretchy="false" xref="A1.E17.m1.9.9.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.E17.m1.9.9.1.1.1.1.1.1.1" xref="A1.E17.m1.9.9.1.1.1.1.1.1.1.cmml"><mi id="A1.E17.m1.9.9.1.1.1.1.1.1.1.2" xref="A1.E17.m1.9.9.1.1.1.1.1.1.1.2.cmml">ϕ</mi><mo id="A1.E17.m1.9.9.1.1.1.1.1.1.1.1" xref="A1.E17.m1.9.9.1.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="A1.E17.m1.9.9.1.1.1.1.1.1.1.3.2" xref="A1.E17.m1.9.9.1.1.1.1.1.1.1.cmml"><mo id="A1.E17.m1.9.9.1.1.1.1.1.1.1.3.2.1" stretchy="false" xref="A1.E17.m1.9.9.1.1.1.1.1.1.1.cmml">(</mo><mi id="A1.E17.m1.8.8" xref="A1.E17.m1.8.8.cmml">τ</mi><mo id="A1.E17.m1.9.9.1.1.1.1.1.1.1.3.2.2" stretchy="false" xref="A1.E17.m1.9.9.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E17.m1.9.9.1.1.1.1.1.1.3" stretchy="false" xref="A1.E17.m1.9.9.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="A1.E17.m1.9.9.1.1.3" stretchy="false" xref="A1.E17.m1.9.9.1.2.1.cmml">|</mo></mrow><mo id="A1.E17.m1.9.9.2" xref="A1.E17.m1.9.9.2.cmml">≤</mo><mrow id="A1.E17.m1.9.9.3" xref="A1.E17.m1.9.9.3.cmml"><mfrac id="A1.E17.m1.3.3" xref="A1.E17.m1.3.3.cmml"><mrow id="A1.E17.m1.1.1.1" xref="A1.E17.m1.1.1.1.cmml"><mn id="A1.E17.m1.1.1.1.3" xref="A1.E17.m1.1.1.1.3.cmml">2</mn><mo id="A1.E17.m1.1.1.1.2" xref="A1.E17.m1.1.1.1.2.cmml">⁢</mo><msup id="A1.E17.m1.1.1.1.4" xref="A1.E17.m1.1.1.1.4.cmml"><mi id="A1.E17.m1.1.1.1.4.2" xref="A1.E17.m1.1.1.1.4.2.cmml">γ</mi><mi id="A1.E17.m1.1.1.1.4.3" xref="A1.E17.m1.1.1.1.4.3.cmml">H</mi></msup><mo id="A1.E17.m1.1.1.1.2a" xref="A1.E17.m1.1.1.1.2.cmml">⁢</mo><mrow id="A1.E17.m1.1.1.1.1.1" xref="A1.E17.m1.1.1.1.1.1.1.cmml"><mo id="A1.E17.m1.1.1.1.1.1.2" stretchy="false" xref="A1.E17.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.E17.m1.1.1.1.1.1.1" xref="A1.E17.m1.1.1.1.1.1.1.cmml"><mi id="A1.E17.m1.1.1.1.1.1.1.2" xref="A1.E17.m1.1.1.1.1.1.1.2.cmml">ϵ</mi><mo id="A1.E17.m1.1.1.1.1.1.1.1" xref="A1.E17.m1.1.1.1.1.1.1.1.cmml">+</mo><mi class="ltx_font_mathcaligraphic" id="A1.E17.m1.1.1.1.1.1.1.3" xref="A1.E17.m1.1.1.1.1.1.1.3.cmml">ℒ</mi></mrow><mo id="A1.E17.m1.1.1.1.1.1.3" stretchy="false" xref="A1.E17.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="A1.E17.m1.3.3.3" xref="A1.E17.m1.3.3.3.cmml"><mrow id="A1.E17.m1.2.2.2.1.1" xref="A1.E17.m1.2.2.2.1.1.1.cmml"><mo id="A1.E17.m1.2.2.2.1.1.2" stretchy="false" xref="A1.E17.m1.2.2.2.1.1.1.cmml">(</mo><mrow id="A1.E17.m1.2.2.2.1.1.1" xref="A1.E17.m1.2.2.2.1.1.1.cmml"><mn id="A1.E17.m1.2.2.2.1.1.1.2" xref="A1.E17.m1.2.2.2.1.1.1.2.cmml">1</mn><mo id="A1.E17.m1.2.2.2.1.1.1.1" xref="A1.E17.m1.2.2.2.1.1.1.1.cmml">−</mo><mi id="A1.E17.m1.2.2.2.1.1.1.3" xref="A1.E17.m1.2.2.2.1.1.1.3.cmml">γ</mi></mrow><mo id="A1.E17.m1.2.2.2.1.1.3" stretchy="false" xref="A1.E17.m1.2.2.2.1.1.1.cmml">)</mo></mrow><mo id="A1.E17.m1.3.3.3.3" xref="A1.E17.m1.3.3.3.3.cmml">⁢</mo><mrow id="A1.E17.m1.3.3.3.2.1" xref="A1.E17.m1.3.3.3.2.1.1.cmml"><mo id="A1.E17.m1.3.3.3.2.1.2" stretchy="false" xref="A1.E17.m1.3.3.3.2.1.1.cmml">(</mo><mrow id="A1.E17.m1.3.3.3.2.1.1" xref="A1.E17.m1.3.3.3.2.1.1.cmml"><mn id="A1.E17.m1.3.3.3.2.1.1.2" xref="A1.E17.m1.3.3.3.2.1.1.2.cmml">1</mn><mo id="A1.E17.m1.3.3.3.2.1.1.1" xref="A1.E17.m1.3.3.3.2.1.1.1.cmml">−</mo><mi id="A1.E17.m1.3.3.3.2.1.1.3" xref="A1.E17.m1.3.3.3.2.1.1.3.cmml">c</mi></mrow><mo id="A1.E17.m1.3.3.3.2.1.3" stretchy="false" xref="A1.E17.m1.3.3.3.2.1.1.cmml">)</mo></mrow></mrow></mfrac><mo id="A1.E17.m1.9.9.3.1" xref="A1.E17.m1.9.9.3.1.cmml">+</mo><mfrac id="A1.E17.m1.6.6" xref="A1.E17.m1.6.6.cmml"><mrow id="A1.E17.m1.4.4.1" xref="A1.E17.m1.4.4.1.cmml"><mn id="A1.E17.m1.4.4.1.3" xref="A1.E17.m1.4.4.1.3.cmml">2</mn><mo id="A1.E17.m1.4.4.1.2" xref="A1.E17.m1.4.4.1.2.cmml">⁢</mo><mi id="A1.E17.m1.4.4.1.4" xref="A1.E17.m1.4.4.1.4.cmml">ϵ</mi><mo id="A1.E17.m1.4.4.1.2a" xref="A1.E17.m1.4.4.1.2.cmml">⁢</mo><mrow id="A1.E17.m1.4.4.1.1.1" xref="A1.E17.m1.4.4.1.1.1.1.cmml"><mo id="A1.E17.m1.4.4.1.1.1.2" stretchy="false" xref="A1.E17.m1.4.4.1.1.1.1.cmml">(</mo><mrow id="A1.E17.m1.4.4.1.1.1.1" xref="A1.E17.m1.4.4.1.1.1.1.cmml"><mn id="A1.E17.m1.4.4.1.1.1.1.2" xref="A1.E17.m1.4.4.1.1.1.1.2.cmml">1</mn><mo id="A1.E17.m1.4.4.1.1.1.1.1" xref="A1.E17.m1.4.4.1.1.1.1.1.cmml">−</mo><msup id="A1.E17.m1.4.4.1.1.1.1.3" xref="A1.E17.m1.4.4.1.1.1.1.3.cmml"><mi id="A1.E17.m1.4.4.1.1.1.1.3.2" xref="A1.E17.m1.4.4.1.1.1.1.3.2.cmml">γ</mi><mrow id="A1.E17.m1.4.4.1.1.1.1.3.3" xref="A1.E17.m1.4.4.1.1.1.1.3.3.cmml"><mi id="A1.E17.m1.4.4.1.1.1.1.3.3.2" xref="A1.E17.m1.4.4.1.1.1.1.3.3.2.cmml">H</mi><mo id="A1.E17.m1.4.4.1.1.1.1.3.3.1" xref="A1.E17.m1.4.4.1.1.1.1.3.3.1.cmml">−</mo><mn id="A1.E17.m1.4.4.1.1.1.1.3.3.3" xref="A1.E17.m1.4.4.1.1.1.1.3.3.3.cmml">1</mn></mrow></msup></mrow><mo id="A1.E17.m1.4.4.1.1.1.3" stretchy="false" xref="A1.E17.m1.4.4.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="A1.E17.m1.6.6.3" xref="A1.E17.m1.6.6.3.cmml"><mrow id="A1.E17.m1.5.5.2.1.1" xref="A1.E17.m1.5.5.2.1.1.1.cmml"><mo id="A1.E17.m1.5.5.2.1.1.2" stretchy="false" xref="A1.E17.m1.5.5.2.1.1.1.cmml">(</mo><mrow id="A1.E17.m1.5.5.2.1.1.1" xref="A1.E17.m1.5.5.2.1.1.1.cmml"><mn id="A1.E17.m1.5.5.2.1.1.1.2" xref="A1.E17.m1.5.5.2.1.1.1.2.cmml">1</mn><mo id="A1.E17.m1.5.5.2.1.1.1.1" xref="A1.E17.m1.5.5.2.1.1.1.1.cmml">−</mo><mi id="A1.E17.m1.5.5.2.1.1.1.3" xref="A1.E17.m1.5.5.2.1.1.1.3.cmml">γ</mi></mrow><mo id="A1.E17.m1.5.5.2.1.1.3" stretchy="false" xref="A1.E17.m1.5.5.2.1.1.1.cmml">)</mo></mrow><mo id="A1.E17.m1.6.6.3.3" xref="A1.E17.m1.6.6.3.3.cmml">⁢</mo><mrow id="A1.E17.m1.6.6.3.2.1" xref="A1.E17.m1.6.6.3.2.1.1.cmml"><mo id="A1.E17.m1.6.6.3.2.1.2" stretchy="false" xref="A1.E17.m1.6.6.3.2.1.1.cmml">(</mo><mrow id="A1.E17.m1.6.6.3.2.1.1" xref="A1.E17.m1.6.6.3.2.1.1.cmml"><mn id="A1.E17.m1.6.6.3.2.1.1.2" xref="A1.E17.m1.6.6.3.2.1.1.2.cmml">1</mn><mo id="A1.E17.m1.6.6.3.2.1.1.1" xref="A1.E17.m1.6.6.3.2.1.1.1.cmml">−</mo><mi id="A1.E17.m1.6.6.3.2.1.1.3" xref="A1.E17.m1.6.6.3.2.1.1.3.cmml">c</mi></mrow><mo id="A1.E17.m1.6.6.3.2.1.3" stretchy="false" xref="A1.E17.m1.6.6.3.2.1.1.cmml">)</mo></mrow></mrow></mfrac></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E17.m1.9b"><apply id="A1.E17.m1.9.9.cmml" xref="A1.E17.m1.9.9"><leq id="A1.E17.m1.9.9.2.cmml" xref="A1.E17.m1.9.9.2"></leq><apply id="A1.E17.m1.9.9.1.2.cmml" xref="A1.E17.m1.9.9.1.1"><abs id="A1.E17.m1.9.9.1.2.1.cmml" xref="A1.E17.m1.9.9.1.1.2"></abs><apply id="A1.E17.m1.9.9.1.1.1.cmml" xref="A1.E17.m1.9.9.1.1.1"><minus id="A1.E17.m1.9.9.1.1.1.2.cmml" xref="A1.E17.m1.9.9.1.1.1.2"></minus><apply id="A1.E17.m1.9.9.1.1.1.3.cmml" xref="A1.E17.m1.9.9.1.1.1.3"><times id="A1.E17.m1.9.9.1.1.1.3.1.cmml" xref="A1.E17.m1.9.9.1.1.1.3.1"></times><ci id="A1.E17.m1.9.9.1.1.1.3.2.cmml" xref="A1.E17.m1.9.9.1.1.1.3.2">𝐒</ci><ci id="A1.E17.m1.7.7.cmml" xref="A1.E17.m1.7.7">𝜏</ci></apply><apply id="A1.E17.m1.9.9.1.1.1.1.cmml" xref="A1.E17.m1.9.9.1.1.1.1"><times id="A1.E17.m1.9.9.1.1.1.1.2.cmml" xref="A1.E17.m1.9.9.1.1.1.1.2"></times><ci id="A1.E17.m1.9.9.1.1.1.1.3.cmml" xref="A1.E17.m1.9.9.1.1.1.1.3">𝐒</ci><apply id="A1.E17.m1.9.9.1.1.1.1.1.1.1.cmml" xref="A1.E17.m1.9.9.1.1.1.1.1.1"><times id="A1.E17.m1.9.9.1.1.1.1.1.1.1.1.cmml" xref="A1.E17.m1.9.9.1.1.1.1.1.1.1.1"></times><ci id="A1.E17.m1.9.9.1.1.1.1.1.1.1.2.cmml" xref="A1.E17.m1.9.9.1.1.1.1.1.1.1.2">italic-ϕ</ci><ci id="A1.E17.m1.8.8.cmml" xref="A1.E17.m1.8.8">𝜏</ci></apply></apply></apply></apply><apply id="A1.E17.m1.9.9.3.cmml" xref="A1.E17.m1.9.9.3"><plus id="A1.E17.m1.9.9.3.1.cmml" xref="A1.E17.m1.9.9.3.1"></plus><apply id="A1.E17.m1.3.3.cmml" xref="A1.E17.m1.3.3"><divide id="A1.E17.m1.3.3.4.cmml" xref="A1.E17.m1.3.3"></divide><apply id="A1.E17.m1.1.1.1.cmml" xref="A1.E17.m1.1.1.1"><times id="A1.E17.m1.1.1.1.2.cmml" xref="A1.E17.m1.1.1.1.2"></times><cn id="A1.E17.m1.1.1.1.3.cmml" type="integer" xref="A1.E17.m1.1.1.1.3">2</cn><apply id="A1.E17.m1.1.1.1.4.cmml" xref="A1.E17.m1.1.1.1.4"><csymbol cd="ambiguous" id="A1.E17.m1.1.1.1.4.1.cmml" xref="A1.E17.m1.1.1.1.4">superscript</csymbol><ci id="A1.E17.m1.1.1.1.4.2.cmml" xref="A1.E17.m1.1.1.1.4.2">𝛾</ci><ci id="A1.E17.m1.1.1.1.4.3.cmml" xref="A1.E17.m1.1.1.1.4.3">𝐻</ci></apply><apply id="A1.E17.m1.1.1.1.1.1.1.cmml" xref="A1.E17.m1.1.1.1.1.1"><plus id="A1.E17.m1.1.1.1.1.1.1.1.cmml" xref="A1.E17.m1.1.1.1.1.1.1.1"></plus><ci id="A1.E17.m1.1.1.1.1.1.1.2.cmml" xref="A1.E17.m1.1.1.1.1.1.1.2">italic-ϵ</ci><ci id="A1.E17.m1.1.1.1.1.1.1.3.cmml" xref="A1.E17.m1.1.1.1.1.1.1.3">ℒ</ci></apply></apply><apply id="A1.E17.m1.3.3.3.cmml" xref="A1.E17.m1.3.3.3"><times id="A1.E17.m1.3.3.3.3.cmml" xref="A1.E17.m1.3.3.3.3"></times><apply id="A1.E17.m1.2.2.2.1.1.1.cmml" xref="A1.E17.m1.2.2.2.1.1"><minus id="A1.E17.m1.2.2.2.1.1.1.1.cmml" xref="A1.E17.m1.2.2.2.1.1.1.1"></minus><cn id="A1.E17.m1.2.2.2.1.1.1.2.cmml" type="integer" xref="A1.E17.m1.2.2.2.1.1.1.2">1</cn><ci id="A1.E17.m1.2.2.2.1.1.1.3.cmml" xref="A1.E17.m1.2.2.2.1.1.1.3">𝛾</ci></apply><apply id="A1.E17.m1.3.3.3.2.1.1.cmml" xref="A1.E17.m1.3.3.3.2.1"><minus id="A1.E17.m1.3.3.3.2.1.1.1.cmml" xref="A1.E17.m1.3.3.3.2.1.1.1"></minus><cn id="A1.E17.m1.3.3.3.2.1.1.2.cmml" type="integer" xref="A1.E17.m1.3.3.3.2.1.1.2">1</cn><ci id="A1.E17.m1.3.3.3.2.1.1.3.cmml" xref="A1.E17.m1.3.3.3.2.1.1.3">𝑐</ci></apply></apply></apply><apply id="A1.E17.m1.6.6.cmml" xref="A1.E17.m1.6.6"><divide id="A1.E17.m1.6.6.4.cmml" xref="A1.E17.m1.6.6"></divide><apply id="A1.E17.m1.4.4.1.cmml" xref="A1.E17.m1.4.4.1"><times id="A1.E17.m1.4.4.1.2.cmml" xref="A1.E17.m1.4.4.1.2"></times><cn id="A1.E17.m1.4.4.1.3.cmml" type="integer" xref="A1.E17.m1.4.4.1.3">2</cn><ci id="A1.E17.m1.4.4.1.4.cmml" xref="A1.E17.m1.4.4.1.4">italic-ϵ</ci><apply id="A1.E17.m1.4.4.1.1.1.1.cmml" xref="A1.E17.m1.4.4.1.1.1"><minus id="A1.E17.m1.4.4.1.1.1.1.1.cmml" xref="A1.E17.m1.4.4.1.1.1.1.1"></minus><cn id="A1.E17.m1.4.4.1.1.1.1.2.cmml" type="integer" xref="A1.E17.m1.4.4.1.1.1.1.2">1</cn><apply id="A1.E17.m1.4.4.1.1.1.1.3.cmml" xref="A1.E17.m1.4.4.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.E17.m1.4.4.1.1.1.1.3.1.cmml" xref="A1.E17.m1.4.4.1.1.1.1.3">superscript</csymbol><ci id="A1.E17.m1.4.4.1.1.1.1.3.2.cmml" xref="A1.E17.m1.4.4.1.1.1.1.3.2">𝛾</ci><apply id="A1.E17.m1.4.4.1.1.1.1.3.3.cmml" xref="A1.E17.m1.4.4.1.1.1.1.3.3"><minus id="A1.E17.m1.4.4.1.1.1.1.3.3.1.cmml" xref="A1.E17.m1.4.4.1.1.1.1.3.3.1"></minus><ci id="A1.E17.m1.4.4.1.1.1.1.3.3.2.cmml" xref="A1.E17.m1.4.4.1.1.1.1.3.3.2">𝐻</ci><cn id="A1.E17.m1.4.4.1.1.1.1.3.3.3.cmml" type="integer" xref="A1.E17.m1.4.4.1.1.1.1.3.3.3">1</cn></apply></apply></apply></apply><apply id="A1.E17.m1.6.6.3.cmml" xref="A1.E17.m1.6.6.3"><times id="A1.E17.m1.6.6.3.3.cmml" xref="A1.E17.m1.6.6.3.3"></times><apply id="A1.E17.m1.5.5.2.1.1.1.cmml" xref="A1.E17.m1.5.5.2.1.1"><minus id="A1.E17.m1.5.5.2.1.1.1.1.cmml" xref="A1.E17.m1.5.5.2.1.1.1.1"></minus><cn id="A1.E17.m1.5.5.2.1.1.1.2.cmml" type="integer" xref="A1.E17.m1.5.5.2.1.1.1.2">1</cn><ci id="A1.E17.m1.5.5.2.1.1.1.3.cmml" xref="A1.E17.m1.5.5.2.1.1.1.3">𝛾</ci></apply><apply id="A1.E17.m1.6.6.3.2.1.1.cmml" xref="A1.E17.m1.6.6.3.2.1"><minus id="A1.E17.m1.6.6.3.2.1.1.1.cmml" xref="A1.E17.m1.6.6.3.2.1.1.1"></minus><cn id="A1.E17.m1.6.6.3.2.1.1.2.cmml" type="integer" xref="A1.E17.m1.6.6.3.2.1.1.2">1</cn><ci id="A1.E17.m1.6.6.3.2.1.1.3.cmml" xref="A1.E17.m1.6.6.3.2.1.1.3">𝑐</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E17.m1.9c">|\mathbf{S}(\tau)-\mathbf{S}(\phi(\tau))|\leq\frac{2\gamma^{H}(\epsilon+{%
\mathcal{L}})}{(1-\gamma)(1-c)}+\frac{2\epsilon(1-\gamma^{H-1})}{(1-\gamma)(1-%
c)}</annotation><annotation encoding="application/x-llamapun" id="A1.E17.m1.9d">| bold_S ( italic_τ ) - bold_S ( italic_ϕ ( italic_τ ) ) | ≤ divide start_ARG 2 italic_γ start_POSTSUPERSCRIPT italic_H end_POSTSUPERSCRIPT ( italic_ϵ + caligraphic_L ) end_ARG start_ARG ( 1 - italic_γ ) ( 1 - italic_c ) end_ARG + divide start_ARG 2 italic_ϵ ( 1 - italic_γ start_POSTSUPERSCRIPT italic_H - 1 end_POSTSUPERSCRIPT ) end_ARG start_ARG ( 1 - italic_γ ) ( 1 - italic_c ) end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(17)</span></td>
</tr></tbody>
</table>
</div>
</div>
<div class="ltx_proof" id="A1.1">
<h6 class="ltx_title ltx_runin ltx_font_italic ltx_title_proof">Proof.</h6>
<div class="ltx_para" id="A1.1.p1">
<p class="ltx_p" id="A1.1.p1.2">Simply calculating the difference between <math alttext="\mathbf{S}(\tau)" class="ltx_Math" display="inline" id="A1.1.p1.1.m1.1"><semantics id="A1.1.p1.1.m1.1a"><mrow id="A1.1.p1.1.m1.1.2" xref="A1.1.p1.1.m1.1.2.cmml"><mi id="A1.1.p1.1.m1.1.2.2" xref="A1.1.p1.1.m1.1.2.2.cmml">𝐒</mi><mo id="A1.1.p1.1.m1.1.2.1" xref="A1.1.p1.1.m1.1.2.1.cmml">⁢</mo><mrow id="A1.1.p1.1.m1.1.2.3.2" xref="A1.1.p1.1.m1.1.2.cmml"><mo id="A1.1.p1.1.m1.1.2.3.2.1" stretchy="false" xref="A1.1.p1.1.m1.1.2.cmml">(</mo><mi id="A1.1.p1.1.m1.1.1" xref="A1.1.p1.1.m1.1.1.cmml">τ</mi><mo id="A1.1.p1.1.m1.1.2.3.2.2" stretchy="false" xref="A1.1.p1.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.1.p1.1.m1.1b"><apply id="A1.1.p1.1.m1.1.2.cmml" xref="A1.1.p1.1.m1.1.2"><times id="A1.1.p1.1.m1.1.2.1.cmml" xref="A1.1.p1.1.m1.1.2.1"></times><ci id="A1.1.p1.1.m1.1.2.2.cmml" xref="A1.1.p1.1.m1.1.2.2">𝐒</ci><ci id="A1.1.p1.1.m1.1.1.cmml" xref="A1.1.p1.1.m1.1.1">𝜏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.1.p1.1.m1.1c">\mathbf{S}(\tau)</annotation><annotation encoding="application/x-llamapun" id="A1.1.p1.1.m1.1d">bold_S ( italic_τ )</annotation></semantics></math> and <math alttext="\mathbf{S}(\phi(\tau)" class="ltx_math_unparsed" display="inline" id="A1.1.p1.2.m2.1"><semantics id="A1.1.p1.2.m2.1a"><mrow id="A1.1.p1.2.m2.1b"><mi id="A1.1.p1.2.m2.1.2">𝐒</mi><mrow id="A1.1.p1.2.m2.1.3"><mo id="A1.1.p1.2.m2.1.3.1" stretchy="false">(</mo><mi id="A1.1.p1.2.m2.1.3.2">ϕ</mi><mrow id="A1.1.p1.2.m2.1.3.3"><mo id="A1.1.p1.2.m2.1.3.3.1" stretchy="false">(</mo><mi id="A1.1.p1.2.m2.1.1">τ</mi><mo id="A1.1.p1.2.m2.1.3.3.2" stretchy="false">)</mo></mrow></mrow></mrow><annotation encoding="application/x-tex" id="A1.1.p1.2.m2.1c">\mathbf{S}(\phi(\tau)</annotation><annotation encoding="application/x-llamapun" id="A1.1.p1.2.m2.1d">bold_S ( italic_ϕ ( italic_τ )</annotation></semantics></math></p>
<table class="ltx_equation ltx_eqn_table" id="A1.E18">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\begin{split}\left|\mathbf{S}(\tau)-\mathbf{S}(\phi(\tau))\right|&amp;=\left|%
\mathbb{E}_{\tau}\left[\gamma^{H}\left(V^{*}(s_{H})-V^{*}(\phi(s_{H}))\right)+%
\sum_{h=0}^{H-1}\gamma^{h}(R(s_{h},a_{h})-R(\phi(s_{h}),a_{h}))\right]\right|%
\\
&amp;=\left|\mathbb{E}_{\tau}\left[\gamma^{H}\left(V^{*}(s_{H})-V^{*}(\phi(s_{H}))%
\right)\right]+\mathbb{E}_{\tau}\left[\sum_{h=0}^{H-1}\gamma^{h}(R(s_{h},a_{h}%
)-R(\phi(s_{h}),a_{h}))\right]\right|\\
&amp;\leq\left\lvert\mathbb{E}_{\tau}\left[\gamma^{H}\left(V^{*}(s_{H})-V^{*}(\phi%
(s_{H}))\right)\right]\right\rvert+\left|\mathbb{E}_{\tau}\left[\sum_{h=0}^{H-%
1}\gamma^{h}(R(s_{h},a_{h})-R(\phi(s_{h}),a_{h}))\right]\right|\\
&amp;\hskip 227.62204pt\text{(Triangle inequality)}\\
&amp;\leq\mathbb{E}_{\tau}\left[\gamma^{H}\left\lvert V^{*}(s_{H})-V^{*}(\phi(s_{H%
}))\right\rvert\right]+\mathbb{E}_{\tau}\left[\sum_{h=0}^{H-1}\gamma^{h}\left%
\lvert R(s_{h},a_{h})-R(\phi(s_{h}),a_{h})\right\rvert\right]\\
&amp;\hskip 227.62204pt\text{(Jensen's inequality)}\\
&amp;=\gamma^{H}\mathbb{E}_{\tau}\left[\left\lvert V^{*}(s_{H})-V^{*}(\phi(s_{H}))%
\right\rvert\right]+\sum_{h=0}^{H-1}\gamma^{h}\mathbb{E}_{\tau}\left[\left%
\lvert R(s_{h},a_{h})-R(\phi(s_{h}),a_{h})\right\rvert\right]\\
&amp;\leq\frac{2\gamma^{H}(\epsilon+{\mathcal{L}})}{(1-\gamma)(1-c)}+\frac{2%
\epsilon}{1-c}\sum_{h=0}^{H-1}\gamma^{h}\quad\text{(From Theorem~{}\ref{thm:%
optimal-value-bound} and Lemma~{}\ref{cor:reward-bound})}\\
&amp;\leq\frac{2\gamma^{H}(\epsilon+{\mathcal{L}})}{(1-\gamma)(1-c)}+\frac{2%
\epsilon(1-\gamma^{H-1})}{(1-\gamma)(1-c)}\end{split}" class="ltx_Math" display="block" id="A1.E18.m1.331"><semantics id="A1.E18.m1.331a"><mtable columnspacing="0pt" displaystyle="true" id="A1.E18.m1.331.331.12" rowspacing="0pt"><mtr id="A1.E18.m1.331.331.12a"><mtd class="ltx_align_right" columnalign="right" id="A1.E18.m1.331.331.12b"><mrow id="A1.E18.m1.322.322.3.320.70.15.15"><mo id="A1.E18.m1.1.1.1.1.1.1" xref="A1.E18.m1.321.321.2.3.cmml">|</mo><mrow id="A1.E18.m1.322.322.3.320.70.15.15.1"><mrow id="A1.E18.m1.322.322.3.320.70.15.15.1.2"><mi id="A1.E18.m1.2.2.2.2.2.2" xref="A1.E18.m1.2.2.2.2.2.2.cmml">𝐒</mi><mo id="A1.E18.m1.322.322.3.320.70.15.15.1.2.1" xref="A1.E18.m1.321.321.2.3.cmml">⁢</mo><mrow id="A1.E18.m1.322.322.3.320.70.15.15.1.2.2"><mo id="A1.E18.m1.3.3.3.3.3.3" stretchy="false" xref="A1.E18.m1.321.321.2.3.cmml">(</mo><mi id="A1.E18.m1.4.4.4.4.4.4" xref="A1.E18.m1.4.4.4.4.4.4.cmml">τ</mi><mo id="A1.E18.m1.5.5.5.5.5.5" stretchy="false" xref="A1.E18.m1.321.321.2.3.cmml">)</mo></mrow></mrow><mo id="A1.E18.m1.6.6.6.6.6.6" xref="A1.E18.m1.6.6.6.6.6.6.cmml">−</mo><mrow id="A1.E18.m1.322.322.3.320.70.15.15.1.1"><mi id="A1.E18.m1.7.7.7.7.7.7" xref="A1.E18.m1.7.7.7.7.7.7.cmml">𝐒</mi><mo id="A1.E18.m1.322.322.3.320.70.15.15.1.1.2" xref="A1.E18.m1.321.321.2.3.cmml">⁢</mo><mrow id="A1.E18.m1.322.322.3.320.70.15.15.1.1.1.1"><mo id="A1.E18.m1.8.8.8.8.8.8" stretchy="false" xref="A1.E18.m1.321.321.2.3.cmml">(</mo><mrow id="A1.E18.m1.322.322.3.320.70.15.15.1.1.1.1.1"><mi id="A1.E18.m1.9.9.9.9.9.9" xref="A1.E18.m1.9.9.9.9.9.9.cmml">ϕ</mi><mo id="A1.E18.m1.322.322.3.320.70.15.15.1.1.1.1.1.1" xref="A1.E18.m1.321.321.2.3.cmml">⁢</mo><mrow id="A1.E18.m1.322.322.3.320.70.15.15.1.1.1.1.1.2"><mo id="A1.E18.m1.10.10.10.10.10.10" stretchy="false" xref="A1.E18.m1.321.321.2.3.cmml">(</mo><mi id="A1.E18.m1.11.11.11.11.11.11" xref="A1.E18.m1.11.11.11.11.11.11.cmml">τ</mi><mo id="A1.E18.m1.12.12.12.12.12.12" stretchy="false" xref="A1.E18.m1.321.321.2.3.cmml">)</mo></mrow></mrow><mo id="A1.E18.m1.13.13.13.13.13.13" stretchy="false" xref="A1.E18.m1.321.321.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="A1.E18.m1.14.14.14.14.14.14" xref="A1.E18.m1.321.321.2.3.cmml">|</mo></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="A1.E18.m1.331.331.12c"><mrow id="A1.E18.m1.323.323.4.321.71.56"><mi id="A1.E18.m1.323.323.4.321.71.56.57" xref="A1.E18.m1.321.321.2.3.cmml"></mi><mo id="A1.E18.m1.15.15.15.15.1.1" xref="A1.E18.m1.15.15.15.15.1.1.cmml">=</mo><mrow id="A1.E18.m1.323.323.4.321.71.56.56.1"><mo id="A1.E18.m1.16.16.16.16.2.2" xref="A1.E18.m1.321.321.2.3.cmml">|</mo><mrow id="A1.E18.m1.323.323.4.321.71.56.56.1.1"><msub id="A1.E18.m1.323.323.4.321.71.56.56.1.1.3"><mi id="A1.E18.m1.17.17.17.17.3.3" xref="A1.E18.m1.17.17.17.17.3.3.cmml">𝔼</mi><mi id="A1.E18.m1.18.18.18.18.4.4.1" xref="A1.E18.m1.18.18.18.18.4.4.1.cmml">τ</mi></msub><mo id="A1.E18.m1.323.323.4.321.71.56.56.1.1.2" xref="A1.E18.m1.321.321.2.3.cmml">⁢</mo><mrow id="A1.E18.m1.323.323.4.321.71.56.56.1.1.1.1"><mo id="A1.E18.m1.19.19.19.19.5.5" xref="A1.E18.m1.321.321.2.3.cmml">[</mo><mrow id="A1.E18.m1.323.323.4.321.71.56.56.1.1.1.1.1"><mrow id="A1.E18.m1.323.323.4.321.71.56.56.1.1.1.1.1.1"><msup id="A1.E18.m1.323.323.4.321.71.56.56.1.1.1.1.1.1.3"><mi id="A1.E18.m1.20.20.20.20.6.6" xref="A1.E18.m1.20.20.20.20.6.6.cmml">γ</mi><mi id="A1.E18.m1.21.21.21.21.7.7.1" xref="A1.E18.m1.21.21.21.21.7.7.1.cmml">H</mi></msup><mo id="A1.E18.m1.323.323.4.321.71.56.56.1.1.1.1.1.1.2" xref="A1.E18.m1.321.321.2.3.cmml">⁢</mo><mrow id="A1.E18.m1.323.323.4.321.71.56.56.1.1.1.1.1.1.1.1"><mo id="A1.E18.m1.22.22.22.22.8.8" xref="A1.E18.m1.321.321.2.3.cmml">(</mo><mrow id="A1.E18.m1.323.323.4.321.71.56.56.1.1.1.1.1.1.1.1.1"><mrow id="A1.E18.m1.323.323.4.321.71.56.56.1.1.1.1.1.1.1.1.1.1"><msup id="A1.E18.m1.323.323.4.321.71.56.56.1.1.1.1.1.1.1.1.1.1.3"><mi id="A1.E18.m1.23.23.23.23.9.9" xref="A1.E18.m1.23.23.23.23.9.9.cmml">V</mi><mo id="A1.E18.m1.24.24.24.24.10.10.1" xref="A1.E18.m1.24.24.24.24.10.10.1.cmml">∗</mo></msup><mo id="A1.E18.m1.323.323.4.321.71.56.56.1.1.1.1.1.1.1.1.1.1.2" xref="A1.E18.m1.321.321.2.3.cmml">⁢</mo><mrow id="A1.E18.m1.323.323.4.321.71.56.56.1.1.1.1.1.1.1.1.1.1.1.1"><mo id="A1.E18.m1.25.25.25.25.11.11" stretchy="false" xref="A1.E18.m1.321.321.2.3.cmml">(</mo><msub id="A1.E18.m1.323.323.4.321.71.56.56.1.1.1.1.1.1.1.1.1.1.1.1.1"><mi id="A1.E18.m1.26.26.26.26.12.12" xref="A1.E18.m1.26.26.26.26.12.12.cmml">s</mi><mi id="A1.E18.m1.27.27.27.27.13.13.1" xref="A1.E18.m1.27.27.27.27.13.13.1.cmml">H</mi></msub><mo id="A1.E18.m1.28.28.28.28.14.14" stretchy="false" xref="A1.E18.m1.321.321.2.3.cmml">)</mo></mrow></mrow><mo id="A1.E18.m1.29.29.29.29.15.15" xref="A1.E18.m1.29.29.29.29.15.15.cmml">−</mo><mrow id="A1.E18.m1.323.323.4.321.71.56.56.1.1.1.1.1.1.1.1.1.2"><msup id="A1.E18.m1.323.323.4.321.71.56.56.1.1.1.1.1.1.1.1.1.2.3"><mi id="A1.E18.m1.30.30.30.30.16.16" xref="A1.E18.m1.30.30.30.30.16.16.cmml">V</mi><mo id="A1.E18.m1.31.31.31.31.17.17.1" xref="A1.E18.m1.31.31.31.31.17.17.1.cmml">∗</mo></msup><mo id="A1.E18.m1.323.323.4.321.71.56.56.1.1.1.1.1.1.1.1.1.2.2" xref="A1.E18.m1.321.321.2.3.cmml">⁢</mo><mrow id="A1.E18.m1.323.323.4.321.71.56.56.1.1.1.1.1.1.1.1.1.2.1.1"><mo id="A1.E18.m1.32.32.32.32.18.18" stretchy="false" xref="A1.E18.m1.321.321.2.3.cmml">(</mo><mrow id="A1.E18.m1.323.323.4.321.71.56.56.1.1.1.1.1.1.1.1.1.2.1.1.1"><mi id="A1.E18.m1.33.33.33.33.19.19" xref="A1.E18.m1.33.33.33.33.19.19.cmml">ϕ</mi><mo id="A1.E18.m1.323.323.4.321.71.56.56.1.1.1.1.1.1.1.1.1.2.1.1.1.2" xref="A1.E18.m1.321.321.2.3.cmml">⁢</mo><mrow id="A1.E18.m1.323.323.4.321.71.56.56.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1"><mo id="A1.E18.m1.34.34.34.34.20.20" stretchy="false" xref="A1.E18.m1.321.321.2.3.cmml">(</mo><msub id="A1.E18.m1.323.323.4.321.71.56.56.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1"><mi id="A1.E18.m1.35.35.35.35.21.21" xref="A1.E18.m1.35.35.35.35.21.21.cmml">s</mi><mi id="A1.E18.m1.36.36.36.36.22.22.1" xref="A1.E18.m1.36.36.36.36.22.22.1.cmml">H</mi></msub><mo id="A1.E18.m1.37.37.37.37.23.23" stretchy="false" xref="A1.E18.m1.321.321.2.3.cmml">)</mo></mrow></mrow><mo id="A1.E18.m1.38.38.38.38.24.24" stretchy="false" xref="A1.E18.m1.321.321.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="A1.E18.m1.39.39.39.39.25.25" xref="A1.E18.m1.321.321.2.3.cmml">)</mo></mrow></mrow><mo id="A1.E18.m1.40.40.40.40.26.26" rspace="0.055em" xref="A1.E18.m1.40.40.40.40.26.26.cmml">+</mo><mrow id="A1.E18.m1.323.323.4.321.71.56.56.1.1.1.1.1.2"><munderover id="A1.E18.m1.323.323.4.321.71.56.56.1.1.1.1.1.2.2"><mo id="A1.E18.m1.41.41.41.41.27.27" movablelimits="false" xref="A1.E18.m1.41.41.41.41.27.27.cmml">∑</mo><mrow id="A1.E18.m1.42.42.42.42.28.28.1" xref="A1.E18.m1.42.42.42.42.28.28.1.cmml"><mi id="A1.E18.m1.42.42.42.42.28.28.1.2" xref="A1.E18.m1.42.42.42.42.28.28.1.2.cmml">h</mi><mo id="A1.E18.m1.42.42.42.42.28.28.1.1" xref="A1.E18.m1.42.42.42.42.28.28.1.1.cmml">=</mo><mn id="A1.E18.m1.42.42.42.42.28.28.1.3" xref="A1.E18.m1.42.42.42.42.28.28.1.3.cmml">0</mn></mrow><mrow id="A1.E18.m1.43.43.43.43.29.29.1" xref="A1.E18.m1.43.43.43.43.29.29.1.cmml"><mi id="A1.E18.m1.43.43.43.43.29.29.1.2" xref="A1.E18.m1.43.43.43.43.29.29.1.2.cmml">H</mi><mo id="A1.E18.m1.43.43.43.43.29.29.1.1" xref="A1.E18.m1.43.43.43.43.29.29.1.1.cmml">−</mo><mn id="A1.E18.m1.43.43.43.43.29.29.1.3" xref="A1.E18.m1.43.43.43.43.29.29.1.3.cmml">1</mn></mrow></munderover><mrow id="A1.E18.m1.323.323.4.321.71.56.56.1.1.1.1.1.2.1"><msup id="A1.E18.m1.323.323.4.321.71.56.56.1.1.1.1.1.2.1.3"><mi id="A1.E18.m1.44.44.44.44.30.30" xref="A1.E18.m1.44.44.44.44.30.30.cmml">γ</mi><mi id="A1.E18.m1.45.45.45.45.31.31.1" xref="A1.E18.m1.45.45.45.45.31.31.1.cmml">h</mi></msup><mo id="A1.E18.m1.323.323.4.321.71.56.56.1.1.1.1.1.2.1.2" xref="A1.E18.m1.321.321.2.3.cmml">⁢</mo><mrow id="A1.E18.m1.323.323.4.321.71.56.56.1.1.1.1.1.2.1.1.1"><mo id="A1.E18.m1.46.46.46.46.32.32" stretchy="false" xref="A1.E18.m1.321.321.2.3.cmml">(</mo><mrow id="A1.E18.m1.323.323.4.321.71.56.56.1.1.1.1.1.2.1.1.1.1"><mrow id="A1.E18.m1.323.323.4.321.71.56.56.1.1.1.1.1.2.1.1.1.1.2"><mi id="A1.E18.m1.47.47.47.47.33.33" xref="A1.E18.m1.47.47.47.47.33.33.cmml">R</mi><mo id="A1.E18.m1.323.323.4.321.71.56.56.1.1.1.1.1.2.1.1.1.1.2.3" xref="A1.E18.m1.321.321.2.3.cmml">⁢</mo><mrow id="A1.E18.m1.323.323.4.321.71.56.56.1.1.1.1.1.2.1.1.1.1.2.2.2"><mo id="A1.E18.m1.48.48.48.48.34.34" stretchy="false" xref="A1.E18.m1.321.321.2.3.cmml">(</mo><msub id="A1.E18.m1.323.323.4.321.71.56.56.1.1.1.1.1.2.1.1.1.1.1.1.1.1"><mi id="A1.E18.m1.49.49.49.49.35.35" xref="A1.E18.m1.49.49.49.49.35.35.cmml">s</mi><mi id="A1.E18.m1.50.50.50.50.36.36.1" xref="A1.E18.m1.50.50.50.50.36.36.1.cmml">h</mi></msub><mo id="A1.E18.m1.51.51.51.51.37.37" xref="A1.E18.m1.321.321.2.3.cmml">,</mo><msub id="A1.E18.m1.323.323.4.321.71.56.56.1.1.1.1.1.2.1.1.1.1.2.2.2.2"><mi id="A1.E18.m1.52.52.52.52.38.38" xref="A1.E18.m1.52.52.52.52.38.38.cmml">a</mi><mi id="A1.E18.m1.53.53.53.53.39.39.1" xref="A1.E18.m1.53.53.53.53.39.39.1.cmml">h</mi></msub><mo id="A1.E18.m1.54.54.54.54.40.40" stretchy="false" xref="A1.E18.m1.321.321.2.3.cmml">)</mo></mrow></mrow><mo id="A1.E18.m1.55.55.55.55.41.41" xref="A1.E18.m1.55.55.55.55.41.41.cmml">−</mo><mrow id="A1.E18.m1.323.323.4.321.71.56.56.1.1.1.1.1.2.1.1.1.1.4"><mi id="A1.E18.m1.56.56.56.56.42.42" xref="A1.E18.m1.56.56.56.56.42.42.cmml">R</mi><mo id="A1.E18.m1.323.323.4.321.71.56.56.1.1.1.1.1.2.1.1.1.1.4.3" xref="A1.E18.m1.321.321.2.3.cmml">⁢</mo><mrow id="A1.E18.m1.323.323.4.321.71.56.56.1.1.1.1.1.2.1.1.1.1.4.2.2"><mo id="A1.E18.m1.57.57.57.57.43.43" stretchy="false" xref="A1.E18.m1.321.321.2.3.cmml">(</mo><mrow id="A1.E18.m1.323.323.4.321.71.56.56.1.1.1.1.1.2.1.1.1.1.3.1.1.1"><mi id="A1.E18.m1.58.58.58.58.44.44" xref="A1.E18.m1.58.58.58.58.44.44.cmml">ϕ</mi><mo id="A1.E18.m1.323.323.4.321.71.56.56.1.1.1.1.1.2.1.1.1.1.3.1.1.1.2" xref="A1.E18.m1.321.321.2.3.cmml">⁢</mo><mrow id="A1.E18.m1.323.323.4.321.71.56.56.1.1.1.1.1.2.1.1.1.1.3.1.1.1.1.1"><mo id="A1.E18.m1.59.59.59.59.45.45" stretchy="false" xref="A1.E18.m1.321.321.2.3.cmml">(</mo><msub id="A1.E18.m1.323.323.4.321.71.56.56.1.1.1.1.1.2.1.1.1.1.3.1.1.1.1.1.1"><mi id="A1.E18.m1.60.60.60.60.46.46" xref="A1.E18.m1.60.60.60.60.46.46.cmml">s</mi><mi id="A1.E18.m1.61.61.61.61.47.47.1" xref="A1.E18.m1.61.61.61.61.47.47.1.cmml">h</mi></msub><mo id="A1.E18.m1.62.62.62.62.48.48" stretchy="false" xref="A1.E18.m1.321.321.2.3.cmml">)</mo></mrow></mrow><mo id="A1.E18.m1.63.63.63.63.49.49" xref="A1.E18.m1.321.321.2.3.cmml">,</mo><msub id="A1.E18.m1.323.323.4.321.71.56.56.1.1.1.1.1.2.1.1.1.1.4.2.2.2"><mi id="A1.E18.m1.64.64.64.64.50.50" xref="A1.E18.m1.64.64.64.64.50.50.cmml">a</mi><mi id="A1.E18.m1.65.65.65.65.51.51.1" xref="A1.E18.m1.65.65.65.65.51.51.1.cmml">h</mi></msub><mo id="A1.E18.m1.66.66.66.66.52.52" stretchy="false" xref="A1.E18.m1.321.321.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="A1.E18.m1.67.67.67.67.53.53" stretchy="false" xref="A1.E18.m1.321.321.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="A1.E18.m1.68.68.68.68.54.54" xref="A1.E18.m1.321.321.2.3.cmml">]</mo></mrow></mrow><mo id="A1.E18.m1.69.69.69.69.55.55" xref="A1.E18.m1.321.321.2.3.cmml">|</mo></mrow></mrow></mtd></mtr><mtr id="A1.E18.m1.331.331.12d"><mtd id="A1.E18.m1.331.331.12e" xref="A1.E18.m1.321.321.2.3.cmml"></mtd><mtd class="ltx_align_left" columnalign="left" id="A1.E18.m1.331.331.12f"><mrow id="A1.E18.m1.324.324.5.322.60.60"><mi id="A1.E18.m1.324.324.5.322.60.60.61" xref="A1.E18.m1.321.321.2.3.cmml"></mi><mo id="A1.E18.m1.70.70.70.1.1.1" xref="A1.E18.m1.70.70.70.1.1.1.cmml">=</mo><mrow id="A1.E18.m1.324.324.5.322.60.60.60.1"><mo id="A1.E18.m1.71.71.71.2.2.2" xref="A1.E18.m1.321.321.2.3.cmml">|</mo><mrow id="A1.E18.m1.324.324.5.322.60.60.60.1.1"><mrow id="A1.E18.m1.324.324.5.322.60.60.60.1.1.1"><msub id="A1.E18.m1.324.324.5.322.60.60.60.1.1.1.3"><mi id="A1.E18.m1.72.72.72.3.3.3" xref="A1.E18.m1.72.72.72.3.3.3.cmml">𝔼</mi><mi id="A1.E18.m1.73.73.73.4.4.4.1" xref="A1.E18.m1.73.73.73.4.4.4.1.cmml">τ</mi></msub><mo id="A1.E18.m1.324.324.5.322.60.60.60.1.1.1.2" xref="A1.E18.m1.321.321.2.3.cmml">⁢</mo><mrow id="A1.E18.m1.324.324.5.322.60.60.60.1.1.1.1.1"><mo id="A1.E18.m1.74.74.74.5.5.5" xref="A1.E18.m1.321.321.2.3.cmml">[</mo><mrow id="A1.E18.m1.324.324.5.322.60.60.60.1.1.1.1.1.1"><msup id="A1.E18.m1.324.324.5.322.60.60.60.1.1.1.1.1.1.3"><mi id="A1.E18.m1.75.75.75.6.6.6" xref="A1.E18.m1.75.75.75.6.6.6.cmml">γ</mi><mi id="A1.E18.m1.76.76.76.7.7.7.1" xref="A1.E18.m1.76.76.76.7.7.7.1.cmml">H</mi></msup><mo id="A1.E18.m1.324.324.5.322.60.60.60.1.1.1.1.1.1.2" xref="A1.E18.m1.321.321.2.3.cmml">⁢</mo><mrow id="A1.E18.m1.324.324.5.322.60.60.60.1.1.1.1.1.1.1.1"><mo id="A1.E18.m1.77.77.77.8.8.8" xref="A1.E18.m1.321.321.2.3.cmml">(</mo><mrow id="A1.E18.m1.324.324.5.322.60.60.60.1.1.1.1.1.1.1.1.1"><mrow id="A1.E18.m1.324.324.5.322.60.60.60.1.1.1.1.1.1.1.1.1.1"><msup id="A1.E18.m1.324.324.5.322.60.60.60.1.1.1.1.1.1.1.1.1.1.3"><mi id="A1.E18.m1.78.78.78.9.9.9" xref="A1.E18.m1.78.78.78.9.9.9.cmml">V</mi><mo id="A1.E18.m1.79.79.79.10.10.10.1" xref="A1.E18.m1.79.79.79.10.10.10.1.cmml">∗</mo></msup><mo id="A1.E18.m1.324.324.5.322.60.60.60.1.1.1.1.1.1.1.1.1.1.2" xref="A1.E18.m1.321.321.2.3.cmml">⁢</mo><mrow id="A1.E18.m1.324.324.5.322.60.60.60.1.1.1.1.1.1.1.1.1.1.1.1"><mo id="A1.E18.m1.80.80.80.11.11.11" stretchy="false" xref="A1.E18.m1.321.321.2.3.cmml">(</mo><msub id="A1.E18.m1.324.324.5.322.60.60.60.1.1.1.1.1.1.1.1.1.1.1.1.1"><mi id="A1.E18.m1.81.81.81.12.12.12" xref="A1.E18.m1.81.81.81.12.12.12.cmml">s</mi><mi id="A1.E18.m1.82.82.82.13.13.13.1" xref="A1.E18.m1.82.82.82.13.13.13.1.cmml">H</mi></msub><mo id="A1.E18.m1.83.83.83.14.14.14" stretchy="false" xref="A1.E18.m1.321.321.2.3.cmml">)</mo></mrow></mrow><mo id="A1.E18.m1.84.84.84.15.15.15" xref="A1.E18.m1.84.84.84.15.15.15.cmml">−</mo><mrow id="A1.E18.m1.324.324.5.322.60.60.60.1.1.1.1.1.1.1.1.1.2"><msup id="A1.E18.m1.324.324.5.322.60.60.60.1.1.1.1.1.1.1.1.1.2.3"><mi id="A1.E18.m1.85.85.85.16.16.16" xref="A1.E18.m1.85.85.85.16.16.16.cmml">V</mi><mo id="A1.E18.m1.86.86.86.17.17.17.1" xref="A1.E18.m1.86.86.86.17.17.17.1.cmml">∗</mo></msup><mo id="A1.E18.m1.324.324.5.322.60.60.60.1.1.1.1.1.1.1.1.1.2.2" xref="A1.E18.m1.321.321.2.3.cmml">⁢</mo><mrow id="A1.E18.m1.324.324.5.322.60.60.60.1.1.1.1.1.1.1.1.1.2.1.1"><mo id="A1.E18.m1.87.87.87.18.18.18" stretchy="false" xref="A1.E18.m1.321.321.2.3.cmml">(</mo><mrow id="A1.E18.m1.324.324.5.322.60.60.60.1.1.1.1.1.1.1.1.1.2.1.1.1"><mi id="A1.E18.m1.88.88.88.19.19.19" xref="A1.E18.m1.88.88.88.19.19.19.cmml">ϕ</mi><mo id="A1.E18.m1.324.324.5.322.60.60.60.1.1.1.1.1.1.1.1.1.2.1.1.1.2" xref="A1.E18.m1.321.321.2.3.cmml">⁢</mo><mrow id="A1.E18.m1.324.324.5.322.60.60.60.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1"><mo id="A1.E18.m1.89.89.89.20.20.20" stretchy="false" xref="A1.E18.m1.321.321.2.3.cmml">(</mo><msub id="A1.E18.m1.324.324.5.322.60.60.60.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1"><mi id="A1.E18.m1.90.90.90.21.21.21" xref="A1.E18.m1.90.90.90.21.21.21.cmml">s</mi><mi id="A1.E18.m1.91.91.91.22.22.22.1" xref="A1.E18.m1.91.91.91.22.22.22.1.cmml">H</mi></msub><mo id="A1.E18.m1.92.92.92.23.23.23" stretchy="false" xref="A1.E18.m1.321.321.2.3.cmml">)</mo></mrow></mrow><mo id="A1.E18.m1.93.93.93.24.24.24" stretchy="false" xref="A1.E18.m1.321.321.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="A1.E18.m1.94.94.94.25.25.25" xref="A1.E18.m1.321.321.2.3.cmml">)</mo></mrow></mrow><mo id="A1.E18.m1.95.95.95.26.26.26" xref="A1.E18.m1.321.321.2.3.cmml">]</mo></mrow></mrow><mo id="A1.E18.m1.96.96.96.27.27.27" xref="A1.E18.m1.96.96.96.27.27.27.cmml">+</mo><mrow id="A1.E18.m1.324.324.5.322.60.60.60.1.1.2"><msub id="A1.E18.m1.324.324.5.322.60.60.60.1.1.2.3"><mi id="A1.E18.m1.97.97.97.28.28.28" xref="A1.E18.m1.97.97.97.28.28.28.cmml">𝔼</mi><mi id="A1.E18.m1.98.98.98.29.29.29.1" xref="A1.E18.m1.98.98.98.29.29.29.1.cmml">τ</mi></msub><mo id="A1.E18.m1.324.324.5.322.60.60.60.1.1.2.2" xref="A1.E18.m1.321.321.2.3.cmml">⁢</mo><mrow id="A1.E18.m1.324.324.5.322.60.60.60.1.1.2.1.1"><mo id="A1.E18.m1.99.99.99.30.30.30" xref="A1.E18.m1.321.321.2.3.cmml">[</mo><mrow id="A1.E18.m1.324.324.5.322.60.60.60.1.1.2.1.1.1"><munderover id="A1.E18.m1.324.324.5.322.60.60.60.1.1.2.1.1.1.2"><mo id="A1.E18.m1.100.100.100.31.31.31" lspace="0em" movablelimits="false" xref="A1.E18.m1.100.100.100.31.31.31.cmml">∑</mo><mrow id="A1.E18.m1.101.101.101.32.32.32.1" xref="A1.E18.m1.101.101.101.32.32.32.1.cmml"><mi id="A1.E18.m1.101.101.101.32.32.32.1.2" xref="A1.E18.m1.101.101.101.32.32.32.1.2.cmml">h</mi><mo id="A1.E18.m1.101.101.101.32.32.32.1.1" xref="A1.E18.m1.101.101.101.32.32.32.1.1.cmml">=</mo><mn id="A1.E18.m1.101.101.101.32.32.32.1.3" xref="A1.E18.m1.101.101.101.32.32.32.1.3.cmml">0</mn></mrow><mrow id="A1.E18.m1.102.102.102.33.33.33.1" xref="A1.E18.m1.102.102.102.33.33.33.1.cmml"><mi id="A1.E18.m1.102.102.102.33.33.33.1.2" xref="A1.E18.m1.102.102.102.33.33.33.1.2.cmml">H</mi><mo id="A1.E18.m1.102.102.102.33.33.33.1.1" xref="A1.E18.m1.102.102.102.33.33.33.1.1.cmml">−</mo><mn id="A1.E18.m1.102.102.102.33.33.33.1.3" xref="A1.E18.m1.102.102.102.33.33.33.1.3.cmml">1</mn></mrow></munderover><mrow id="A1.E18.m1.324.324.5.322.60.60.60.1.1.2.1.1.1.1"><msup id="A1.E18.m1.324.324.5.322.60.60.60.1.1.2.1.1.1.1.3"><mi id="A1.E18.m1.103.103.103.34.34.34" xref="A1.E18.m1.103.103.103.34.34.34.cmml">γ</mi><mi id="A1.E18.m1.104.104.104.35.35.35.1" xref="A1.E18.m1.104.104.104.35.35.35.1.cmml">h</mi></msup><mo id="A1.E18.m1.324.324.5.322.60.60.60.1.1.2.1.1.1.1.2" xref="A1.E18.m1.321.321.2.3.cmml">⁢</mo><mrow id="A1.E18.m1.324.324.5.322.60.60.60.1.1.2.1.1.1.1.1.1"><mo id="A1.E18.m1.105.105.105.36.36.36" stretchy="false" xref="A1.E18.m1.321.321.2.3.cmml">(</mo><mrow id="A1.E18.m1.324.324.5.322.60.60.60.1.1.2.1.1.1.1.1.1.1"><mrow id="A1.E18.m1.324.324.5.322.60.60.60.1.1.2.1.1.1.1.1.1.1.2"><mi id="A1.E18.m1.106.106.106.37.37.37" xref="A1.E18.m1.106.106.106.37.37.37.cmml">R</mi><mo id="A1.E18.m1.324.324.5.322.60.60.60.1.1.2.1.1.1.1.1.1.1.2.3" xref="A1.E18.m1.321.321.2.3.cmml">⁢</mo><mrow id="A1.E18.m1.324.324.5.322.60.60.60.1.1.2.1.1.1.1.1.1.1.2.2.2"><mo id="A1.E18.m1.107.107.107.38.38.38" stretchy="false" xref="A1.E18.m1.321.321.2.3.cmml">(</mo><msub id="A1.E18.m1.324.324.5.322.60.60.60.1.1.2.1.1.1.1.1.1.1.1.1.1.1"><mi id="A1.E18.m1.108.108.108.39.39.39" xref="A1.E18.m1.108.108.108.39.39.39.cmml">s</mi><mi id="A1.E18.m1.109.109.109.40.40.40.1" xref="A1.E18.m1.109.109.109.40.40.40.1.cmml">h</mi></msub><mo id="A1.E18.m1.110.110.110.41.41.41" xref="A1.E18.m1.321.321.2.3.cmml">,</mo><msub id="A1.E18.m1.324.324.5.322.60.60.60.1.1.2.1.1.1.1.1.1.1.2.2.2.2"><mi id="A1.E18.m1.111.111.111.42.42.42" xref="A1.E18.m1.111.111.111.42.42.42.cmml">a</mi><mi id="A1.E18.m1.112.112.112.43.43.43.1" xref="A1.E18.m1.112.112.112.43.43.43.1.cmml">h</mi></msub><mo id="A1.E18.m1.113.113.113.44.44.44" stretchy="false" xref="A1.E18.m1.321.321.2.3.cmml">)</mo></mrow></mrow><mo id="A1.E18.m1.114.114.114.45.45.45" xref="A1.E18.m1.114.114.114.45.45.45.cmml">−</mo><mrow id="A1.E18.m1.324.324.5.322.60.60.60.1.1.2.1.1.1.1.1.1.1.4"><mi id="A1.E18.m1.115.115.115.46.46.46" xref="A1.E18.m1.115.115.115.46.46.46.cmml">R</mi><mo id="A1.E18.m1.324.324.5.322.60.60.60.1.1.2.1.1.1.1.1.1.1.4.3" xref="A1.E18.m1.321.321.2.3.cmml">⁢</mo><mrow id="A1.E18.m1.324.324.5.322.60.60.60.1.1.2.1.1.1.1.1.1.1.4.2.2"><mo id="A1.E18.m1.116.116.116.47.47.47" stretchy="false" xref="A1.E18.m1.321.321.2.3.cmml">(</mo><mrow id="A1.E18.m1.324.324.5.322.60.60.60.1.1.2.1.1.1.1.1.1.1.3.1.1.1"><mi id="A1.E18.m1.117.117.117.48.48.48" xref="A1.E18.m1.117.117.117.48.48.48.cmml">ϕ</mi><mo id="A1.E18.m1.324.324.5.322.60.60.60.1.1.2.1.1.1.1.1.1.1.3.1.1.1.2" xref="A1.E18.m1.321.321.2.3.cmml">⁢</mo><mrow id="A1.E18.m1.324.324.5.322.60.60.60.1.1.2.1.1.1.1.1.1.1.3.1.1.1.1.1"><mo id="A1.E18.m1.118.118.118.49.49.49" stretchy="false" xref="A1.E18.m1.321.321.2.3.cmml">(</mo><msub id="A1.E18.m1.324.324.5.322.60.60.60.1.1.2.1.1.1.1.1.1.1.3.1.1.1.1.1.1"><mi id="A1.E18.m1.119.119.119.50.50.50" xref="A1.E18.m1.119.119.119.50.50.50.cmml">s</mi><mi id="A1.E18.m1.120.120.120.51.51.51.1" xref="A1.E18.m1.120.120.120.51.51.51.1.cmml">h</mi></msub><mo id="A1.E18.m1.121.121.121.52.52.52" stretchy="false" xref="A1.E18.m1.321.321.2.3.cmml">)</mo></mrow></mrow><mo id="A1.E18.m1.122.122.122.53.53.53" xref="A1.E18.m1.321.321.2.3.cmml">,</mo><msub id="A1.E18.m1.324.324.5.322.60.60.60.1.1.2.1.1.1.1.1.1.1.4.2.2.2"><mi id="A1.E18.m1.123.123.123.54.54.54" xref="A1.E18.m1.123.123.123.54.54.54.cmml">a</mi><mi id="A1.E18.m1.124.124.124.55.55.55.1" xref="A1.E18.m1.124.124.124.55.55.55.1.cmml">h</mi></msub><mo id="A1.E18.m1.125.125.125.56.56.56" stretchy="false" xref="A1.E18.m1.321.321.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="A1.E18.m1.126.126.126.57.57.57" stretchy="false" xref="A1.E18.m1.321.321.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="A1.E18.m1.127.127.127.58.58.58" xref="A1.E18.m1.321.321.2.3.cmml">]</mo></mrow></mrow></mrow><mo id="A1.E18.m1.128.128.128.59.59.59" xref="A1.E18.m1.321.321.2.3.cmml">|</mo></mrow></mrow></mtd></mtr><mtr id="A1.E18.m1.331.331.12g"><mtd id="A1.E18.m1.331.331.12h" xref="A1.E18.m1.321.321.2.3.cmml"></mtd><mtd class="ltx_align_left" columnalign="left" id="A1.E18.m1.331.331.12i"><mrow id="A1.E18.m1.326.326.7.324.63.63"><mi id="A1.E18.m1.326.326.7.324.63.63.64" xref="A1.E18.m1.321.321.2.3.cmml"></mi><mo id="A1.E18.m1.129.129.129.1.1.1" xref="A1.E18.m1.129.129.129.1.1.1.cmml">≤</mo><mrow id="A1.E18.m1.326.326.7.324.63.63.63"><mrow id="A1.E18.m1.325.325.6.323.62.62.62.1.1"><mo id="A1.E18.m1.130.130.130.2.2.2" xref="A1.E18.m1.321.321.2.3.cmml">|</mo><mrow id="A1.E18.m1.325.325.6.323.62.62.62.1.1.1"><msub id="A1.E18.m1.325.325.6.323.62.62.62.1.1.1.3"><mi id="A1.E18.m1.131.131.131.3.3.3" xref="A1.E18.m1.131.131.131.3.3.3.cmml">𝔼</mi><mi id="A1.E18.m1.132.132.132.4.4.4.1" xref="A1.E18.m1.132.132.132.4.4.4.1.cmml">τ</mi></msub><mo id="A1.E18.m1.325.325.6.323.62.62.62.1.1.1.2" xref="A1.E18.m1.321.321.2.3.cmml">⁢</mo><mrow id="A1.E18.m1.325.325.6.323.62.62.62.1.1.1.1.1"><mo id="A1.E18.m1.133.133.133.5.5.5" xref="A1.E18.m1.321.321.2.3.cmml">[</mo><mrow id="A1.E18.m1.325.325.6.323.62.62.62.1.1.1.1.1.1"><msup id="A1.E18.m1.325.325.6.323.62.62.62.1.1.1.1.1.1.3"><mi id="A1.E18.m1.134.134.134.6.6.6" xref="A1.E18.m1.134.134.134.6.6.6.cmml">γ</mi><mi id="A1.E18.m1.135.135.135.7.7.7.1" xref="A1.E18.m1.135.135.135.7.7.7.1.cmml">H</mi></msup><mo id="A1.E18.m1.325.325.6.323.62.62.62.1.1.1.1.1.1.2" xref="A1.E18.m1.321.321.2.3.cmml">⁢</mo><mrow id="A1.E18.m1.325.325.6.323.62.62.62.1.1.1.1.1.1.1.1"><mo id="A1.E18.m1.136.136.136.8.8.8" xref="A1.E18.m1.321.321.2.3.cmml">(</mo><mrow id="A1.E18.m1.325.325.6.323.62.62.62.1.1.1.1.1.1.1.1.1"><mrow id="A1.E18.m1.325.325.6.323.62.62.62.1.1.1.1.1.1.1.1.1.1"><msup id="A1.E18.m1.325.325.6.323.62.62.62.1.1.1.1.1.1.1.1.1.1.3"><mi id="A1.E18.m1.137.137.137.9.9.9" xref="A1.E18.m1.137.137.137.9.9.9.cmml">V</mi><mo id="A1.E18.m1.138.138.138.10.10.10.1" xref="A1.E18.m1.138.138.138.10.10.10.1.cmml">∗</mo></msup><mo id="A1.E18.m1.325.325.6.323.62.62.62.1.1.1.1.1.1.1.1.1.1.2" xref="A1.E18.m1.321.321.2.3.cmml">⁢</mo><mrow id="A1.E18.m1.325.325.6.323.62.62.62.1.1.1.1.1.1.1.1.1.1.1.1"><mo id="A1.E18.m1.139.139.139.11.11.11" stretchy="false" xref="A1.E18.m1.321.321.2.3.cmml">(</mo><msub id="A1.E18.m1.325.325.6.323.62.62.62.1.1.1.1.1.1.1.1.1.1.1.1.1"><mi id="A1.E18.m1.140.140.140.12.12.12" xref="A1.E18.m1.140.140.140.12.12.12.cmml">s</mi><mi id="A1.E18.m1.141.141.141.13.13.13.1" xref="A1.E18.m1.141.141.141.13.13.13.1.cmml">H</mi></msub><mo id="A1.E18.m1.142.142.142.14.14.14" stretchy="false" xref="A1.E18.m1.321.321.2.3.cmml">)</mo></mrow></mrow><mo id="A1.E18.m1.143.143.143.15.15.15" xref="A1.E18.m1.143.143.143.15.15.15.cmml">−</mo><mrow id="A1.E18.m1.325.325.6.323.62.62.62.1.1.1.1.1.1.1.1.1.2"><msup id="A1.E18.m1.325.325.6.323.62.62.62.1.1.1.1.1.1.1.1.1.2.3"><mi id="A1.E18.m1.144.144.144.16.16.16" xref="A1.E18.m1.144.144.144.16.16.16.cmml">V</mi><mo id="A1.E18.m1.145.145.145.17.17.17.1" xref="A1.E18.m1.145.145.145.17.17.17.1.cmml">∗</mo></msup><mo id="A1.E18.m1.325.325.6.323.62.62.62.1.1.1.1.1.1.1.1.1.2.2" xref="A1.E18.m1.321.321.2.3.cmml">⁢</mo><mrow id="A1.E18.m1.325.325.6.323.62.62.62.1.1.1.1.1.1.1.1.1.2.1.1"><mo id="A1.E18.m1.146.146.146.18.18.18" stretchy="false" xref="A1.E18.m1.321.321.2.3.cmml">(</mo><mrow id="A1.E18.m1.325.325.6.323.62.62.62.1.1.1.1.1.1.1.1.1.2.1.1.1"><mi id="A1.E18.m1.147.147.147.19.19.19" xref="A1.E18.m1.147.147.147.19.19.19.cmml">ϕ</mi><mo id="A1.E18.m1.325.325.6.323.62.62.62.1.1.1.1.1.1.1.1.1.2.1.1.1.2" xref="A1.E18.m1.321.321.2.3.cmml">⁢</mo><mrow id="A1.E18.m1.325.325.6.323.62.62.62.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1"><mo id="A1.E18.m1.148.148.148.20.20.20" stretchy="false" xref="A1.E18.m1.321.321.2.3.cmml">(</mo><msub id="A1.E18.m1.325.325.6.323.62.62.62.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1"><mi id="A1.E18.m1.149.149.149.21.21.21" xref="A1.E18.m1.149.149.149.21.21.21.cmml">s</mi><mi id="A1.E18.m1.150.150.150.22.22.22.1" xref="A1.E18.m1.150.150.150.22.22.22.1.cmml">H</mi></msub><mo id="A1.E18.m1.151.151.151.23.23.23" stretchy="false" xref="A1.E18.m1.321.321.2.3.cmml">)</mo></mrow></mrow><mo id="A1.E18.m1.152.152.152.24.24.24" stretchy="false" xref="A1.E18.m1.321.321.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="A1.E18.m1.153.153.153.25.25.25" xref="A1.E18.m1.321.321.2.3.cmml">)</mo></mrow></mrow><mo id="A1.E18.m1.154.154.154.26.26.26" xref="A1.E18.m1.321.321.2.3.cmml">]</mo></mrow></mrow><mo id="A1.E18.m1.155.155.155.27.27.27" xref="A1.E18.m1.321.321.2.3.cmml">|</mo></mrow><mo id="A1.E18.m1.156.156.156.28.28.28" xref="A1.E18.m1.156.156.156.28.28.28.cmml">+</mo><mrow id="A1.E18.m1.326.326.7.324.63.63.63.2.1"><mo id="A1.E18.m1.157.157.157.29.29.29" xref="A1.E18.m1.321.321.2.3.cmml">|</mo><mrow id="A1.E18.m1.326.326.7.324.63.63.63.2.1.1"><msub id="A1.E18.m1.326.326.7.324.63.63.63.2.1.1.3"><mi id="A1.E18.m1.158.158.158.30.30.30" xref="A1.E18.m1.158.158.158.30.30.30.cmml">𝔼</mi><mi id="A1.E18.m1.159.159.159.31.31.31.1" xref="A1.E18.m1.159.159.159.31.31.31.1.cmml">τ</mi></msub><mo id="A1.E18.m1.326.326.7.324.63.63.63.2.1.1.2" xref="A1.E18.m1.321.321.2.3.cmml">⁢</mo><mrow id="A1.E18.m1.326.326.7.324.63.63.63.2.1.1.1.1"><mo id="A1.E18.m1.160.160.160.32.32.32" xref="A1.E18.m1.321.321.2.3.cmml">[</mo><mrow id="A1.E18.m1.326.326.7.324.63.63.63.2.1.1.1.1.1"><munderover id="A1.E18.m1.326.326.7.324.63.63.63.2.1.1.1.1.1.2"><mo id="A1.E18.m1.161.161.161.33.33.33" lspace="0em" movablelimits="false" xref="A1.E18.m1.161.161.161.33.33.33.cmml">∑</mo><mrow id="A1.E18.m1.162.162.162.34.34.34.1" xref="A1.E18.m1.162.162.162.34.34.34.1.cmml"><mi id="A1.E18.m1.162.162.162.34.34.34.1.2" xref="A1.E18.m1.162.162.162.34.34.34.1.2.cmml">h</mi><mo id="A1.E18.m1.162.162.162.34.34.34.1.1" xref="A1.E18.m1.162.162.162.34.34.34.1.1.cmml">=</mo><mn id="A1.E18.m1.162.162.162.34.34.34.1.3" xref="A1.E18.m1.162.162.162.34.34.34.1.3.cmml">0</mn></mrow><mrow id="A1.E18.m1.163.163.163.35.35.35.1" xref="A1.E18.m1.163.163.163.35.35.35.1.cmml"><mi id="A1.E18.m1.163.163.163.35.35.35.1.2" xref="A1.E18.m1.163.163.163.35.35.35.1.2.cmml">H</mi><mo id="A1.E18.m1.163.163.163.35.35.35.1.1" xref="A1.E18.m1.163.163.163.35.35.35.1.1.cmml">−</mo><mn id="A1.E18.m1.163.163.163.35.35.35.1.3" xref="A1.E18.m1.163.163.163.35.35.35.1.3.cmml">1</mn></mrow></munderover><mrow id="A1.E18.m1.326.326.7.324.63.63.63.2.1.1.1.1.1.1"><msup id="A1.E18.m1.326.326.7.324.63.63.63.2.1.1.1.1.1.1.3"><mi id="A1.E18.m1.164.164.164.36.36.36" xref="A1.E18.m1.164.164.164.36.36.36.cmml">γ</mi><mi id="A1.E18.m1.165.165.165.37.37.37.1" xref="A1.E18.m1.165.165.165.37.37.37.1.cmml">h</mi></msup><mo id="A1.E18.m1.326.326.7.324.63.63.63.2.1.1.1.1.1.1.2" xref="A1.E18.m1.321.321.2.3.cmml">⁢</mo><mrow id="A1.E18.m1.326.326.7.324.63.63.63.2.1.1.1.1.1.1.1.1"><mo id="A1.E18.m1.166.166.166.38.38.38" stretchy="false" xref="A1.E18.m1.321.321.2.3.cmml">(</mo><mrow id="A1.E18.m1.326.326.7.324.63.63.63.2.1.1.1.1.1.1.1.1.1"><mrow id="A1.E18.m1.326.326.7.324.63.63.63.2.1.1.1.1.1.1.1.1.1.2"><mi id="A1.E18.m1.167.167.167.39.39.39" xref="A1.E18.m1.167.167.167.39.39.39.cmml">R</mi><mo id="A1.E18.m1.326.326.7.324.63.63.63.2.1.1.1.1.1.1.1.1.1.2.3" xref="A1.E18.m1.321.321.2.3.cmml">⁢</mo><mrow id="A1.E18.m1.326.326.7.324.63.63.63.2.1.1.1.1.1.1.1.1.1.2.2.2"><mo id="A1.E18.m1.168.168.168.40.40.40" stretchy="false" xref="A1.E18.m1.321.321.2.3.cmml">(</mo><msub id="A1.E18.m1.326.326.7.324.63.63.63.2.1.1.1.1.1.1.1.1.1.1.1.1.1"><mi id="A1.E18.m1.169.169.169.41.41.41" xref="A1.E18.m1.169.169.169.41.41.41.cmml">s</mi><mi id="A1.E18.m1.170.170.170.42.42.42.1" xref="A1.E18.m1.170.170.170.42.42.42.1.cmml">h</mi></msub><mo id="A1.E18.m1.171.171.171.43.43.43" xref="A1.E18.m1.321.321.2.3.cmml">,</mo><msub id="A1.E18.m1.326.326.7.324.63.63.63.2.1.1.1.1.1.1.1.1.1.2.2.2.2"><mi id="A1.E18.m1.172.172.172.44.44.44" xref="A1.E18.m1.172.172.172.44.44.44.cmml">a</mi><mi id="A1.E18.m1.173.173.173.45.45.45.1" xref="A1.E18.m1.173.173.173.45.45.45.1.cmml">h</mi></msub><mo id="A1.E18.m1.174.174.174.46.46.46" stretchy="false" xref="A1.E18.m1.321.321.2.3.cmml">)</mo></mrow></mrow><mo id="A1.E18.m1.175.175.175.47.47.47" xref="A1.E18.m1.175.175.175.47.47.47.cmml">−</mo><mrow id="A1.E18.m1.326.326.7.324.63.63.63.2.1.1.1.1.1.1.1.1.1.4"><mi id="A1.E18.m1.176.176.176.48.48.48" xref="A1.E18.m1.176.176.176.48.48.48.cmml">R</mi><mo id="A1.E18.m1.326.326.7.324.63.63.63.2.1.1.1.1.1.1.1.1.1.4.3" xref="A1.E18.m1.321.321.2.3.cmml">⁢</mo><mrow id="A1.E18.m1.326.326.7.324.63.63.63.2.1.1.1.1.1.1.1.1.1.4.2.2"><mo id="A1.E18.m1.177.177.177.49.49.49" stretchy="false" xref="A1.E18.m1.321.321.2.3.cmml">(</mo><mrow id="A1.E18.m1.326.326.7.324.63.63.63.2.1.1.1.1.1.1.1.1.1.3.1.1.1"><mi id="A1.E18.m1.178.178.178.50.50.50" xref="A1.E18.m1.178.178.178.50.50.50.cmml">ϕ</mi><mo id="A1.E18.m1.326.326.7.324.63.63.63.2.1.1.1.1.1.1.1.1.1.3.1.1.1.2" xref="A1.E18.m1.321.321.2.3.cmml">⁢</mo><mrow id="A1.E18.m1.326.326.7.324.63.63.63.2.1.1.1.1.1.1.1.1.1.3.1.1.1.1.1"><mo id="A1.E18.m1.179.179.179.51.51.51" stretchy="false" xref="A1.E18.m1.321.321.2.3.cmml">(</mo><msub id="A1.E18.m1.326.326.7.324.63.63.63.2.1.1.1.1.1.1.1.1.1.3.1.1.1.1.1.1"><mi id="A1.E18.m1.180.180.180.52.52.52" xref="A1.E18.m1.180.180.180.52.52.52.cmml">s</mi><mi id="A1.E18.m1.181.181.181.53.53.53.1" xref="A1.E18.m1.181.181.181.53.53.53.1.cmml">h</mi></msub><mo id="A1.E18.m1.182.182.182.54.54.54" stretchy="false" xref="A1.E18.m1.321.321.2.3.cmml">)</mo></mrow></mrow><mo id="A1.E18.m1.183.183.183.55.55.55" xref="A1.E18.m1.321.321.2.3.cmml">,</mo><msub id="A1.E18.m1.326.326.7.324.63.63.63.2.1.1.1.1.1.1.1.1.1.4.2.2.2"><mi id="A1.E18.m1.184.184.184.56.56.56" xref="A1.E18.m1.184.184.184.56.56.56.cmml">a</mi><mi id="A1.E18.m1.185.185.185.57.57.57.1" xref="A1.E18.m1.185.185.185.57.57.57.1.cmml">h</mi></msub><mo id="A1.E18.m1.186.186.186.58.58.58" stretchy="false" xref="A1.E18.m1.321.321.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="A1.E18.m1.187.187.187.59.59.59" stretchy="false" xref="A1.E18.m1.321.321.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="A1.E18.m1.188.188.188.60.60.60" xref="A1.E18.m1.321.321.2.3.cmml">]</mo></mrow></mrow><mo id="A1.E18.m1.189.189.189.61.61.61" xref="A1.E18.m1.321.321.2.3.cmml">|</mo></mrow></mrow></mrow></mtd></mtr><mtr id="A1.E18.m1.331.331.12j"><mtd id="A1.E18.m1.331.331.12k" xref="A1.E18.m1.321.321.2.3.cmml"></mtd><mtd class="ltx_align_left" columnalign="left" id="A1.E18.m1.331.331.12l"><mtext id="A1.E18.m1.190.190.190.1.1.1" xref="A1.E18.m1.190.190.190.1.1.1a.cmml">(Triangle inequality)</mtext></mtd></mtr><mtr id="A1.E18.m1.331.331.12m"><mtd id="A1.E18.m1.331.331.12n" xref="A1.E18.m1.321.321.2.3.cmml"></mtd><mtd class="ltx_align_left" columnalign="left" id="A1.E18.m1.331.331.12o"><mrow id="A1.E18.m1.328.328.9.326.59.59"><mi id="A1.E18.m1.328.328.9.326.59.59.60" xref="A1.E18.m1.321.321.2.3.cmml"></mi><mo id="A1.E18.m1.191.191.191.1.1.1" xref="A1.E18.m1.191.191.191.1.1.1.cmml">≤</mo><mrow id="A1.E18.m1.328.328.9.326.59.59.59"><mrow id="A1.E18.m1.327.327.8.325.58.58.58.1"><msub id="A1.E18.m1.327.327.8.325.58.58.58.1.3"><mi id="A1.E18.m1.192.192.192.2.2.2" xref="A1.E18.m1.192.192.192.2.2.2.cmml">𝔼</mi><mi id="A1.E18.m1.193.193.193.3.3.3.1" xref="A1.E18.m1.193.193.193.3.3.3.1.cmml">τ</mi></msub><mo id="A1.E18.m1.327.327.8.325.58.58.58.1.2" xref="A1.E18.m1.321.321.2.3.cmml">⁢</mo><mrow id="A1.E18.m1.327.327.8.325.58.58.58.1.1.1"><mo id="A1.E18.m1.194.194.194.4.4.4" xref="A1.E18.m1.321.321.2.3.cmml">[</mo><mrow id="A1.E18.m1.327.327.8.325.58.58.58.1.1.1.1"><msup id="A1.E18.m1.327.327.8.325.58.58.58.1.1.1.1.3"><mi id="A1.E18.m1.195.195.195.5.5.5" xref="A1.E18.m1.195.195.195.5.5.5.cmml">γ</mi><mi id="A1.E18.m1.196.196.196.6.6.6.1" xref="A1.E18.m1.196.196.196.6.6.6.1.cmml">H</mi></msup><mo id="A1.E18.m1.327.327.8.325.58.58.58.1.1.1.1.2" xref="A1.E18.m1.321.321.2.3.cmml">⁢</mo><mrow id="A1.E18.m1.327.327.8.325.58.58.58.1.1.1.1.1.1"><mo id="A1.E18.m1.197.197.197.7.7.7" xref="A1.E18.m1.321.321.2.3.cmml">|</mo><mrow id="A1.E18.m1.327.327.8.325.58.58.58.1.1.1.1.1.1.1"><mrow id="A1.E18.m1.327.327.8.325.58.58.58.1.1.1.1.1.1.1.1"><msup id="A1.E18.m1.327.327.8.325.58.58.58.1.1.1.1.1.1.1.1.3"><mi id="A1.E18.m1.198.198.198.8.8.8" xref="A1.E18.m1.198.198.198.8.8.8.cmml">V</mi><mo id="A1.E18.m1.199.199.199.9.9.9.1" xref="A1.E18.m1.199.199.199.9.9.9.1.cmml">∗</mo></msup><mo id="A1.E18.m1.327.327.8.325.58.58.58.1.1.1.1.1.1.1.1.2" xref="A1.E18.m1.321.321.2.3.cmml">⁢</mo><mrow id="A1.E18.m1.327.327.8.325.58.58.58.1.1.1.1.1.1.1.1.1.1"><mo id="A1.E18.m1.200.200.200.10.10.10" stretchy="false" xref="A1.E18.m1.321.321.2.3.cmml">(</mo><msub id="A1.E18.m1.327.327.8.325.58.58.58.1.1.1.1.1.1.1.1.1.1.1"><mi id="A1.E18.m1.201.201.201.11.11.11" xref="A1.E18.m1.201.201.201.11.11.11.cmml">s</mi><mi id="A1.E18.m1.202.202.202.12.12.12.1" xref="A1.E18.m1.202.202.202.12.12.12.1.cmml">H</mi></msub><mo id="A1.E18.m1.203.203.203.13.13.13" stretchy="false" xref="A1.E18.m1.321.321.2.3.cmml">)</mo></mrow></mrow><mo id="A1.E18.m1.204.204.204.14.14.14" xref="A1.E18.m1.204.204.204.14.14.14.cmml">−</mo><mrow id="A1.E18.m1.327.327.8.325.58.58.58.1.1.1.1.1.1.1.2"><msup id="A1.E18.m1.327.327.8.325.58.58.58.1.1.1.1.1.1.1.2.3"><mi id="A1.E18.m1.205.205.205.15.15.15" xref="A1.E18.m1.205.205.205.15.15.15.cmml">V</mi><mo id="A1.E18.m1.206.206.206.16.16.16.1" xref="A1.E18.m1.206.206.206.16.16.16.1.cmml">∗</mo></msup><mo id="A1.E18.m1.327.327.8.325.58.58.58.1.1.1.1.1.1.1.2.2" xref="A1.E18.m1.321.321.2.3.cmml">⁢</mo><mrow id="A1.E18.m1.327.327.8.325.58.58.58.1.1.1.1.1.1.1.2.1.1"><mo id="A1.E18.m1.207.207.207.17.17.17" stretchy="false" xref="A1.E18.m1.321.321.2.3.cmml">(</mo><mrow id="A1.E18.m1.327.327.8.325.58.58.58.1.1.1.1.1.1.1.2.1.1.1"><mi id="A1.E18.m1.208.208.208.18.18.18" xref="A1.E18.m1.208.208.208.18.18.18.cmml">ϕ</mi><mo id="A1.E18.m1.327.327.8.325.58.58.58.1.1.1.1.1.1.1.2.1.1.1.2" xref="A1.E18.m1.321.321.2.3.cmml">⁢</mo><mrow id="A1.E18.m1.327.327.8.325.58.58.58.1.1.1.1.1.1.1.2.1.1.1.1.1"><mo id="A1.E18.m1.209.209.209.19.19.19" stretchy="false" xref="A1.E18.m1.321.321.2.3.cmml">(</mo><msub id="A1.E18.m1.327.327.8.325.58.58.58.1.1.1.1.1.1.1.2.1.1.1.1.1.1"><mi id="A1.E18.m1.210.210.210.20.20.20" xref="A1.E18.m1.210.210.210.20.20.20.cmml">s</mi><mi id="A1.E18.m1.211.211.211.21.21.21.1" xref="A1.E18.m1.211.211.211.21.21.21.1.cmml">H</mi></msub><mo id="A1.E18.m1.212.212.212.22.22.22" stretchy="false" xref="A1.E18.m1.321.321.2.3.cmml">)</mo></mrow></mrow><mo id="A1.E18.m1.213.213.213.23.23.23" stretchy="false" xref="A1.E18.m1.321.321.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="A1.E18.m1.214.214.214.24.24.24" xref="A1.E18.m1.321.321.2.3.cmml">|</mo></mrow></mrow><mo id="A1.E18.m1.215.215.215.25.25.25" xref="A1.E18.m1.321.321.2.3.cmml">]</mo></mrow></mrow><mo id="A1.E18.m1.216.216.216.26.26.26" xref="A1.E18.m1.216.216.216.26.26.26.cmml">+</mo><mrow id="A1.E18.m1.328.328.9.326.59.59.59.2"><msub id="A1.E18.m1.328.328.9.326.59.59.59.2.3"><mi id="A1.E18.m1.217.217.217.27.27.27" xref="A1.E18.m1.217.217.217.27.27.27.cmml">𝔼</mi><mi id="A1.E18.m1.218.218.218.28.28.28.1" xref="A1.E18.m1.218.218.218.28.28.28.1.cmml">τ</mi></msub><mo id="A1.E18.m1.328.328.9.326.59.59.59.2.2" xref="A1.E18.m1.321.321.2.3.cmml">⁢</mo><mrow id="A1.E18.m1.328.328.9.326.59.59.59.2.1.1"><mo id="A1.E18.m1.219.219.219.29.29.29" xref="A1.E18.m1.321.321.2.3.cmml">[</mo><mrow id="A1.E18.m1.328.328.9.326.59.59.59.2.1.1.1"><munderover id="A1.E18.m1.328.328.9.326.59.59.59.2.1.1.1.2"><mo id="A1.E18.m1.220.220.220.30.30.30" lspace="0em" movablelimits="false" xref="A1.E18.m1.220.220.220.30.30.30.cmml">∑</mo><mrow id="A1.E18.m1.221.221.221.31.31.31.1" xref="A1.E18.m1.221.221.221.31.31.31.1.cmml"><mi id="A1.E18.m1.221.221.221.31.31.31.1.2" xref="A1.E18.m1.221.221.221.31.31.31.1.2.cmml">h</mi><mo id="A1.E18.m1.221.221.221.31.31.31.1.1" xref="A1.E18.m1.221.221.221.31.31.31.1.1.cmml">=</mo><mn id="A1.E18.m1.221.221.221.31.31.31.1.3" xref="A1.E18.m1.221.221.221.31.31.31.1.3.cmml">0</mn></mrow><mrow id="A1.E18.m1.222.222.222.32.32.32.1" xref="A1.E18.m1.222.222.222.32.32.32.1.cmml"><mi id="A1.E18.m1.222.222.222.32.32.32.1.2" xref="A1.E18.m1.222.222.222.32.32.32.1.2.cmml">H</mi><mo id="A1.E18.m1.222.222.222.32.32.32.1.1" xref="A1.E18.m1.222.222.222.32.32.32.1.1.cmml">−</mo><mn id="A1.E18.m1.222.222.222.32.32.32.1.3" xref="A1.E18.m1.222.222.222.32.32.32.1.3.cmml">1</mn></mrow></munderover><mrow id="A1.E18.m1.328.328.9.326.59.59.59.2.1.1.1.1"><msup id="A1.E18.m1.328.328.9.326.59.59.59.2.1.1.1.1.3"><mi id="A1.E18.m1.223.223.223.33.33.33" xref="A1.E18.m1.223.223.223.33.33.33.cmml">γ</mi><mi id="A1.E18.m1.224.224.224.34.34.34.1" xref="A1.E18.m1.224.224.224.34.34.34.1.cmml">h</mi></msup><mo id="A1.E18.m1.328.328.9.326.59.59.59.2.1.1.1.1.2" xref="A1.E18.m1.321.321.2.3.cmml">⁢</mo><mrow id="A1.E18.m1.328.328.9.326.59.59.59.2.1.1.1.1.1.1"><mo id="A1.E18.m1.225.225.225.35.35.35" xref="A1.E18.m1.321.321.2.3.cmml">|</mo><mrow id="A1.E18.m1.328.328.9.326.59.59.59.2.1.1.1.1.1.1.1"><mrow id="A1.E18.m1.328.328.9.326.59.59.59.2.1.1.1.1.1.1.1.2"><mi id="A1.E18.m1.226.226.226.36.36.36" xref="A1.E18.m1.226.226.226.36.36.36.cmml">R</mi><mo id="A1.E18.m1.328.328.9.326.59.59.59.2.1.1.1.1.1.1.1.2.3" xref="A1.E18.m1.321.321.2.3.cmml">⁢</mo><mrow id="A1.E18.m1.328.328.9.326.59.59.59.2.1.1.1.1.1.1.1.2.2.2"><mo id="A1.E18.m1.227.227.227.37.37.37" stretchy="false" xref="A1.E18.m1.321.321.2.3.cmml">(</mo><msub id="A1.E18.m1.328.328.9.326.59.59.59.2.1.1.1.1.1.1.1.1.1.1.1"><mi id="A1.E18.m1.228.228.228.38.38.38" xref="A1.E18.m1.228.228.228.38.38.38.cmml">s</mi><mi id="A1.E18.m1.229.229.229.39.39.39.1" xref="A1.E18.m1.229.229.229.39.39.39.1.cmml">h</mi></msub><mo id="A1.E18.m1.230.230.230.40.40.40" xref="A1.E18.m1.321.321.2.3.cmml">,</mo><msub id="A1.E18.m1.328.328.9.326.59.59.59.2.1.1.1.1.1.1.1.2.2.2.2"><mi id="A1.E18.m1.231.231.231.41.41.41" xref="A1.E18.m1.231.231.231.41.41.41.cmml">a</mi><mi id="A1.E18.m1.232.232.232.42.42.42.1" xref="A1.E18.m1.232.232.232.42.42.42.1.cmml">h</mi></msub><mo id="A1.E18.m1.233.233.233.43.43.43" stretchy="false" xref="A1.E18.m1.321.321.2.3.cmml">)</mo></mrow></mrow><mo id="A1.E18.m1.234.234.234.44.44.44" xref="A1.E18.m1.234.234.234.44.44.44.cmml">−</mo><mrow id="A1.E18.m1.328.328.9.326.59.59.59.2.1.1.1.1.1.1.1.4"><mi id="A1.E18.m1.235.235.235.45.45.45" xref="A1.E18.m1.235.235.235.45.45.45.cmml">R</mi><mo id="A1.E18.m1.328.328.9.326.59.59.59.2.1.1.1.1.1.1.1.4.3" xref="A1.E18.m1.321.321.2.3.cmml">⁢</mo><mrow id="A1.E18.m1.328.328.9.326.59.59.59.2.1.1.1.1.1.1.1.4.2.2"><mo id="A1.E18.m1.236.236.236.46.46.46" stretchy="false" xref="A1.E18.m1.321.321.2.3.cmml">(</mo><mrow id="A1.E18.m1.328.328.9.326.59.59.59.2.1.1.1.1.1.1.1.3.1.1.1"><mi id="A1.E18.m1.237.237.237.47.47.47" xref="A1.E18.m1.237.237.237.47.47.47.cmml">ϕ</mi><mo id="A1.E18.m1.328.328.9.326.59.59.59.2.1.1.1.1.1.1.1.3.1.1.1.2" xref="A1.E18.m1.321.321.2.3.cmml">⁢</mo><mrow id="A1.E18.m1.328.328.9.326.59.59.59.2.1.1.1.1.1.1.1.3.1.1.1.1.1"><mo id="A1.E18.m1.238.238.238.48.48.48" stretchy="false" xref="A1.E18.m1.321.321.2.3.cmml">(</mo><msub id="A1.E18.m1.328.328.9.326.59.59.59.2.1.1.1.1.1.1.1.3.1.1.1.1.1.1"><mi id="A1.E18.m1.239.239.239.49.49.49" xref="A1.E18.m1.239.239.239.49.49.49.cmml">s</mi><mi id="A1.E18.m1.240.240.240.50.50.50.1" xref="A1.E18.m1.240.240.240.50.50.50.1.cmml">h</mi></msub><mo id="A1.E18.m1.241.241.241.51.51.51" stretchy="false" xref="A1.E18.m1.321.321.2.3.cmml">)</mo></mrow></mrow><mo id="A1.E18.m1.242.242.242.52.52.52" xref="A1.E18.m1.321.321.2.3.cmml">,</mo><msub id="A1.E18.m1.328.328.9.326.59.59.59.2.1.1.1.1.1.1.1.4.2.2.2"><mi id="A1.E18.m1.243.243.243.53.53.53" xref="A1.E18.m1.243.243.243.53.53.53.cmml">a</mi><mi id="A1.E18.m1.244.244.244.54.54.54.1" xref="A1.E18.m1.244.244.244.54.54.54.1.cmml">h</mi></msub><mo id="A1.E18.m1.245.245.245.55.55.55" stretchy="false" xref="A1.E18.m1.321.321.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="A1.E18.m1.246.246.246.56.56.56" xref="A1.E18.m1.321.321.2.3.cmml">|</mo></mrow></mrow></mrow><mo id="A1.E18.m1.247.247.247.57.57.57" xref="A1.E18.m1.321.321.2.3.cmml">]</mo></mrow></mrow></mrow></mrow></mtd></mtr><mtr id="A1.E18.m1.331.331.12p"><mtd id="A1.E18.m1.331.331.12q" xref="A1.E18.m1.321.321.2.3.cmml"></mtd><mtd class="ltx_align_left" columnalign="left" id="A1.E18.m1.331.331.12r"><mtext id="A1.E18.m1.248.248.248.1.1.1" xref="A1.E18.m1.248.248.248.1.1.1a.cmml">(Jensen’s inequality)</mtext></mtd></mtr><mtr id="A1.E18.m1.331.331.12s"><mtd id="A1.E18.m1.331.331.12t" xref="A1.E18.m1.321.321.2.3.cmml"></mtd><mtd class="ltx_align_left" columnalign="left" id="A1.E18.m1.331.331.12u"><mrow id="A1.E18.m1.330.330.11.328.59.59"><mi id="A1.E18.m1.330.330.11.328.59.59.60" xref="A1.E18.m1.321.321.2.3.cmml"></mi><mo id="A1.E18.m1.249.249.249.1.1.1" xref="A1.E18.m1.249.249.249.1.1.1.cmml">=</mo><mrow id="A1.E18.m1.330.330.11.328.59.59.59"><mrow id="A1.E18.m1.329.329.10.327.58.58.58.1"><msup id="A1.E18.m1.329.329.10.327.58.58.58.1.3"><mi id="A1.E18.m1.250.250.250.2.2.2" xref="A1.E18.m1.250.250.250.2.2.2.cmml">γ</mi><mi id="A1.E18.m1.251.251.251.3.3.3.1" xref="A1.E18.m1.251.251.251.3.3.3.1.cmml">H</mi></msup><mo id="A1.E18.m1.329.329.10.327.58.58.58.1.2" xref="A1.E18.m1.321.321.2.3.cmml">⁢</mo><msub id="A1.E18.m1.329.329.10.327.58.58.58.1.4"><mi id="A1.E18.m1.252.252.252.4.4.4" xref="A1.E18.m1.252.252.252.4.4.4.cmml">𝔼</mi><mi id="A1.E18.m1.253.253.253.5.5.5.1" xref="A1.E18.m1.253.253.253.5.5.5.1.cmml">τ</mi></msub><mo id="A1.E18.m1.329.329.10.327.58.58.58.1.2a" xref="A1.E18.m1.321.321.2.3.cmml">⁢</mo><mrow id="A1.E18.m1.329.329.10.327.58.58.58.1.1.1"><mo id="A1.E18.m1.254.254.254.6.6.6" xref="A1.E18.m1.321.321.2.3.cmml">[</mo><mrow id="A1.E18.m1.329.329.10.327.58.58.58.1.1.1.1"><mo id="A1.E18.m1.255.255.255.7.7.7" xref="A1.E18.m1.321.321.2.3.cmml">|</mo><mrow id="A1.E18.m1.329.329.10.327.58.58.58.1.1.1.1.1.1"><mrow id="A1.E18.m1.329.329.10.327.58.58.58.1.1.1.1.1.1.1"><msup id="A1.E18.m1.329.329.10.327.58.58.58.1.1.1.1.1.1.1.3"><mi id="A1.E18.m1.256.256.256.8.8.8" xref="A1.E18.m1.256.256.256.8.8.8.cmml">V</mi><mo id="A1.E18.m1.257.257.257.9.9.9.1" xref="A1.E18.m1.257.257.257.9.9.9.1.cmml">∗</mo></msup><mo id="A1.E18.m1.329.329.10.327.58.58.58.1.1.1.1.1.1.1.2" xref="A1.E18.m1.321.321.2.3.cmml">⁢</mo><mrow id="A1.E18.m1.329.329.10.327.58.58.58.1.1.1.1.1.1.1.1.1"><mo id="A1.E18.m1.258.258.258.10.10.10" stretchy="false" xref="A1.E18.m1.321.321.2.3.cmml">(</mo><msub id="A1.E18.m1.329.329.10.327.58.58.58.1.1.1.1.1.1.1.1.1.1"><mi id="A1.E18.m1.259.259.259.11.11.11" xref="A1.E18.m1.259.259.259.11.11.11.cmml">s</mi><mi id="A1.E18.m1.260.260.260.12.12.12.1" xref="A1.E18.m1.260.260.260.12.12.12.1.cmml">H</mi></msub><mo id="A1.E18.m1.261.261.261.13.13.13" stretchy="false" xref="A1.E18.m1.321.321.2.3.cmml">)</mo></mrow></mrow><mo id="A1.E18.m1.262.262.262.14.14.14" xref="A1.E18.m1.262.262.262.14.14.14.cmml">−</mo><mrow id="A1.E18.m1.329.329.10.327.58.58.58.1.1.1.1.1.1.2"><msup id="A1.E18.m1.329.329.10.327.58.58.58.1.1.1.1.1.1.2.3"><mi id="A1.E18.m1.263.263.263.15.15.15" xref="A1.E18.m1.263.263.263.15.15.15.cmml">V</mi><mo id="A1.E18.m1.264.264.264.16.16.16.1" xref="A1.E18.m1.264.264.264.16.16.16.1.cmml">∗</mo></msup><mo id="A1.E18.m1.329.329.10.327.58.58.58.1.1.1.1.1.1.2.2" xref="A1.E18.m1.321.321.2.3.cmml">⁢</mo><mrow id="A1.E18.m1.329.329.10.327.58.58.58.1.1.1.1.1.1.2.1.1"><mo id="A1.E18.m1.265.265.265.17.17.17" stretchy="false" xref="A1.E18.m1.321.321.2.3.cmml">(</mo><mrow id="A1.E18.m1.329.329.10.327.58.58.58.1.1.1.1.1.1.2.1.1.1"><mi id="A1.E18.m1.266.266.266.18.18.18" xref="A1.E18.m1.266.266.266.18.18.18.cmml">ϕ</mi><mo id="A1.E18.m1.329.329.10.327.58.58.58.1.1.1.1.1.1.2.1.1.1.2" xref="A1.E18.m1.321.321.2.3.cmml">⁢</mo><mrow id="A1.E18.m1.329.329.10.327.58.58.58.1.1.1.1.1.1.2.1.1.1.1.1"><mo id="A1.E18.m1.267.267.267.19.19.19" stretchy="false" xref="A1.E18.m1.321.321.2.3.cmml">(</mo><msub id="A1.E18.m1.329.329.10.327.58.58.58.1.1.1.1.1.1.2.1.1.1.1.1.1"><mi id="A1.E18.m1.268.268.268.20.20.20" xref="A1.E18.m1.268.268.268.20.20.20.cmml">s</mi><mi id="A1.E18.m1.269.269.269.21.21.21.1" xref="A1.E18.m1.269.269.269.21.21.21.1.cmml">H</mi></msub><mo id="A1.E18.m1.270.270.270.22.22.22" stretchy="false" xref="A1.E18.m1.321.321.2.3.cmml">)</mo></mrow></mrow><mo id="A1.E18.m1.271.271.271.23.23.23" stretchy="false" xref="A1.E18.m1.321.321.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="A1.E18.m1.272.272.272.24.24.24" xref="A1.E18.m1.321.321.2.3.cmml">|</mo></mrow><mo id="A1.E18.m1.273.273.273.25.25.25" xref="A1.E18.m1.321.321.2.3.cmml">]</mo></mrow></mrow><mo id="A1.E18.m1.274.274.274.26.26.26" rspace="0.055em" xref="A1.E18.m1.274.274.274.26.26.26.cmml">+</mo><mrow id="A1.E18.m1.330.330.11.328.59.59.59.2"><munderover id="A1.E18.m1.330.330.11.328.59.59.59.2.2"><mo id="A1.E18.m1.275.275.275.27.27.27" movablelimits="false" xref="A1.E18.m1.275.275.275.27.27.27.cmml">∑</mo><mrow id="A1.E18.m1.276.276.276.28.28.28.1" xref="A1.E18.m1.276.276.276.28.28.28.1.cmml"><mi id="A1.E18.m1.276.276.276.28.28.28.1.2" xref="A1.E18.m1.276.276.276.28.28.28.1.2.cmml">h</mi><mo id="A1.E18.m1.276.276.276.28.28.28.1.1" xref="A1.E18.m1.276.276.276.28.28.28.1.1.cmml">=</mo><mn id="A1.E18.m1.276.276.276.28.28.28.1.3" xref="A1.E18.m1.276.276.276.28.28.28.1.3.cmml">0</mn></mrow><mrow id="A1.E18.m1.277.277.277.29.29.29.1" xref="A1.E18.m1.277.277.277.29.29.29.1.cmml"><mi id="A1.E18.m1.277.277.277.29.29.29.1.2" xref="A1.E18.m1.277.277.277.29.29.29.1.2.cmml">H</mi><mo id="A1.E18.m1.277.277.277.29.29.29.1.1" xref="A1.E18.m1.277.277.277.29.29.29.1.1.cmml">−</mo><mn id="A1.E18.m1.277.277.277.29.29.29.1.3" xref="A1.E18.m1.277.277.277.29.29.29.1.3.cmml">1</mn></mrow></munderover><mrow id="A1.E18.m1.330.330.11.328.59.59.59.2.1"><msup id="A1.E18.m1.330.330.11.328.59.59.59.2.1.3"><mi id="A1.E18.m1.278.278.278.30.30.30" xref="A1.E18.m1.278.278.278.30.30.30.cmml">γ</mi><mi id="A1.E18.m1.279.279.279.31.31.31.1" xref="A1.E18.m1.279.279.279.31.31.31.1.cmml">h</mi></msup><mo id="A1.E18.m1.330.330.11.328.59.59.59.2.1.2" xref="A1.E18.m1.321.321.2.3.cmml">⁢</mo><msub id="A1.E18.m1.330.330.11.328.59.59.59.2.1.4"><mi id="A1.E18.m1.280.280.280.32.32.32" xref="A1.E18.m1.280.280.280.32.32.32.cmml">𝔼</mi><mi id="A1.E18.m1.281.281.281.33.33.33.1" xref="A1.E18.m1.281.281.281.33.33.33.1.cmml">τ</mi></msub><mo id="A1.E18.m1.330.330.11.328.59.59.59.2.1.2a" xref="A1.E18.m1.321.321.2.3.cmml">⁢</mo><mrow id="A1.E18.m1.330.330.11.328.59.59.59.2.1.1.1"><mo id="A1.E18.m1.282.282.282.34.34.34" xref="A1.E18.m1.321.321.2.3.cmml">[</mo><mrow id="A1.E18.m1.330.330.11.328.59.59.59.2.1.1.1.1"><mo id="A1.E18.m1.283.283.283.35.35.35" xref="A1.E18.m1.321.321.2.3.cmml">|</mo><mrow id="A1.E18.m1.330.330.11.328.59.59.59.2.1.1.1.1.1.1"><mrow id="A1.E18.m1.330.330.11.328.59.59.59.2.1.1.1.1.1.1.2"><mi id="A1.E18.m1.284.284.284.36.36.36" xref="A1.E18.m1.284.284.284.36.36.36.cmml">R</mi><mo id="A1.E18.m1.330.330.11.328.59.59.59.2.1.1.1.1.1.1.2.3" xref="A1.E18.m1.321.321.2.3.cmml">⁢</mo><mrow id="A1.E18.m1.330.330.11.328.59.59.59.2.1.1.1.1.1.1.2.2.2"><mo id="A1.E18.m1.285.285.285.37.37.37" stretchy="false" xref="A1.E18.m1.321.321.2.3.cmml">(</mo><msub id="A1.E18.m1.330.330.11.328.59.59.59.2.1.1.1.1.1.1.1.1.1.1"><mi id="A1.E18.m1.286.286.286.38.38.38" xref="A1.E18.m1.286.286.286.38.38.38.cmml">s</mi><mi id="A1.E18.m1.287.287.287.39.39.39.1" xref="A1.E18.m1.287.287.287.39.39.39.1.cmml">h</mi></msub><mo id="A1.E18.m1.288.288.288.40.40.40" xref="A1.E18.m1.321.321.2.3.cmml">,</mo><msub id="A1.E18.m1.330.330.11.328.59.59.59.2.1.1.1.1.1.1.2.2.2.2"><mi id="A1.E18.m1.289.289.289.41.41.41" xref="A1.E18.m1.289.289.289.41.41.41.cmml">a</mi><mi id="A1.E18.m1.290.290.290.42.42.42.1" xref="A1.E18.m1.290.290.290.42.42.42.1.cmml">h</mi></msub><mo id="A1.E18.m1.291.291.291.43.43.43" stretchy="false" xref="A1.E18.m1.321.321.2.3.cmml">)</mo></mrow></mrow><mo id="A1.E18.m1.292.292.292.44.44.44" xref="A1.E18.m1.292.292.292.44.44.44.cmml">−</mo><mrow id="A1.E18.m1.330.330.11.328.59.59.59.2.1.1.1.1.1.1.4"><mi id="A1.E18.m1.293.293.293.45.45.45" xref="A1.E18.m1.293.293.293.45.45.45.cmml">R</mi><mo id="A1.E18.m1.330.330.11.328.59.59.59.2.1.1.1.1.1.1.4.3" xref="A1.E18.m1.321.321.2.3.cmml">⁢</mo><mrow id="A1.E18.m1.330.330.11.328.59.59.59.2.1.1.1.1.1.1.4.2.2"><mo id="A1.E18.m1.294.294.294.46.46.46" stretchy="false" xref="A1.E18.m1.321.321.2.3.cmml">(</mo><mrow id="A1.E18.m1.330.330.11.328.59.59.59.2.1.1.1.1.1.1.3.1.1.1"><mi id="A1.E18.m1.295.295.295.47.47.47" xref="A1.E18.m1.295.295.295.47.47.47.cmml">ϕ</mi><mo id="A1.E18.m1.330.330.11.328.59.59.59.2.1.1.1.1.1.1.3.1.1.1.2" xref="A1.E18.m1.321.321.2.3.cmml">⁢</mo><mrow id="A1.E18.m1.330.330.11.328.59.59.59.2.1.1.1.1.1.1.3.1.1.1.1.1"><mo id="A1.E18.m1.296.296.296.48.48.48" stretchy="false" xref="A1.E18.m1.321.321.2.3.cmml">(</mo><msub id="A1.E18.m1.330.330.11.328.59.59.59.2.1.1.1.1.1.1.3.1.1.1.1.1.1"><mi id="A1.E18.m1.297.297.297.49.49.49" xref="A1.E18.m1.297.297.297.49.49.49.cmml">s</mi><mi id="A1.E18.m1.298.298.298.50.50.50.1" xref="A1.E18.m1.298.298.298.50.50.50.1.cmml">h</mi></msub><mo id="A1.E18.m1.299.299.299.51.51.51" stretchy="false" xref="A1.E18.m1.321.321.2.3.cmml">)</mo></mrow></mrow><mo id="A1.E18.m1.300.300.300.52.52.52" xref="A1.E18.m1.321.321.2.3.cmml">,</mo><msub id="A1.E18.m1.330.330.11.328.59.59.59.2.1.1.1.1.1.1.4.2.2.2"><mi id="A1.E18.m1.301.301.301.53.53.53" xref="A1.E18.m1.301.301.301.53.53.53.cmml">a</mi><mi id="A1.E18.m1.302.302.302.54.54.54.1" xref="A1.E18.m1.302.302.302.54.54.54.1.cmml">h</mi></msub><mo id="A1.E18.m1.303.303.303.55.55.55" stretchy="false" xref="A1.E18.m1.321.321.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="A1.E18.m1.304.304.304.56.56.56" xref="A1.E18.m1.321.321.2.3.cmml">|</mo></mrow><mo id="A1.E18.m1.305.305.305.57.57.57" xref="A1.E18.m1.321.321.2.3.cmml">]</mo></mrow></mrow></mrow></mrow></mrow></mtd></mtr><mtr id="A1.E18.m1.331.331.12v"><mtd id="A1.E18.m1.331.331.12w" xref="A1.E18.m1.321.321.2.3.cmml"></mtd><mtd class="ltx_align_left" columnalign="left" id="A1.E18.m1.331.331.12x"><mrow id="A1.E18.m1.331.331.12.329.11.11"><mi id="A1.E18.m1.331.331.12.329.11.11.12" xref="A1.E18.m1.321.321.2.3.cmml"></mi><mo id="A1.E18.m1.306.306.306.1.1.1" xref="A1.E18.m1.306.306.306.1.1.1.cmml">≤</mo><mrow id="A1.E18.m1.331.331.12.329.11.11.11.1"><mrow id="A1.E18.m1.331.331.12.329.11.11.11.1.1"><mfrac id="A1.E18.m1.307.307.307.2.2.2" xref="A1.E18.m1.307.307.307.2.2.2.cmml"><mrow id="A1.E18.m1.307.307.307.2.2.2.1" xref="A1.E18.m1.307.307.307.2.2.2.1.cmml"><mn id="A1.E18.m1.307.307.307.2.2.2.1.3" xref="A1.E18.m1.307.307.307.2.2.2.1.3.cmml">2</mn><mo id="A1.E18.m1.307.307.307.2.2.2.1.2" xref="A1.E18.m1.307.307.307.2.2.2.1.2.cmml">⁢</mo><msup id="A1.E18.m1.307.307.307.2.2.2.1.4" xref="A1.E18.m1.307.307.307.2.2.2.1.4.cmml"><mi id="A1.E18.m1.307.307.307.2.2.2.1.4.2" xref="A1.E18.m1.307.307.307.2.2.2.1.4.2.cmml">γ</mi><mi id="A1.E18.m1.307.307.307.2.2.2.1.4.3" xref="A1.E18.m1.307.307.307.2.2.2.1.4.3.cmml">H</mi></msup><mo id="A1.E18.m1.307.307.307.2.2.2.1.2a" xref="A1.E18.m1.307.307.307.2.2.2.1.2.cmml">⁢</mo><mrow id="A1.E18.m1.307.307.307.2.2.2.1.1.1" xref="A1.E18.m1.307.307.307.2.2.2.1.1.1.1.cmml"><mo id="A1.E18.m1.307.307.307.2.2.2.1.1.1.2" stretchy="false" xref="A1.E18.m1.307.307.307.2.2.2.1.1.1.1.cmml">(</mo><mrow id="A1.E18.m1.307.307.307.2.2.2.1.1.1.1" xref="A1.E18.m1.307.307.307.2.2.2.1.1.1.1.cmml"><mi id="A1.E18.m1.307.307.307.2.2.2.1.1.1.1.2" xref="A1.E18.m1.307.307.307.2.2.2.1.1.1.1.2.cmml">ϵ</mi><mo id="A1.E18.m1.307.307.307.2.2.2.1.1.1.1.1" xref="A1.E18.m1.307.307.307.2.2.2.1.1.1.1.1.cmml">+</mo><mi class="ltx_font_mathcaligraphic" id="A1.E18.m1.307.307.307.2.2.2.1.1.1.1.3" xref="A1.E18.m1.307.307.307.2.2.2.1.1.1.1.3.cmml">ℒ</mi></mrow><mo id="A1.E18.m1.307.307.307.2.2.2.1.1.1.3" stretchy="false" xref="A1.E18.m1.307.307.307.2.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="A1.E18.m1.307.307.307.2.2.2.3" xref="A1.E18.m1.307.307.307.2.2.2.3.cmml"><mrow id="A1.E18.m1.307.307.307.2.2.2.2.1.1" xref="A1.E18.m1.307.307.307.2.2.2.2.1.1.1.cmml"><mo id="A1.E18.m1.307.307.307.2.2.2.2.1.1.2" stretchy="false" xref="A1.E18.m1.307.307.307.2.2.2.2.1.1.1.cmml">(</mo><mrow id="A1.E18.m1.307.307.307.2.2.2.2.1.1.1" xref="A1.E18.m1.307.307.307.2.2.2.2.1.1.1.cmml"><mn id="A1.E18.m1.307.307.307.2.2.2.2.1.1.1.2" xref="A1.E18.m1.307.307.307.2.2.2.2.1.1.1.2.cmml">1</mn><mo id="A1.E18.m1.307.307.307.2.2.2.2.1.1.1.1" xref="A1.E18.m1.307.307.307.2.2.2.2.1.1.1.1.cmml">−</mo><mi id="A1.E18.m1.307.307.307.2.2.2.2.1.1.1.3" xref="A1.E18.m1.307.307.307.2.2.2.2.1.1.1.3.cmml">γ</mi></mrow><mo id="A1.E18.m1.307.307.307.2.2.2.2.1.1.3" stretchy="false" xref="A1.E18.m1.307.307.307.2.2.2.2.1.1.1.cmml">)</mo></mrow><mo id="A1.E18.m1.307.307.307.2.2.2.3.3" xref="A1.E18.m1.307.307.307.2.2.2.3.3.cmml">⁢</mo><mrow id="A1.E18.m1.307.307.307.2.2.2.3.2.1" xref="A1.E18.m1.307.307.307.2.2.2.3.2.1.1.cmml"><mo id="A1.E18.m1.307.307.307.2.2.2.3.2.1.2" stretchy="false" xref="A1.E18.m1.307.307.307.2.2.2.3.2.1.1.cmml">(</mo><mrow id="A1.E18.m1.307.307.307.2.2.2.3.2.1.1" xref="A1.E18.m1.307.307.307.2.2.2.3.2.1.1.cmml"><mn id="A1.E18.m1.307.307.307.2.2.2.3.2.1.1.2" xref="A1.E18.m1.307.307.307.2.2.2.3.2.1.1.2.cmml">1</mn><mo id="A1.E18.m1.307.307.307.2.2.2.3.2.1.1.1" xref="A1.E18.m1.307.307.307.2.2.2.3.2.1.1.1.cmml">−</mo><mi id="A1.E18.m1.307.307.307.2.2.2.3.2.1.1.3" xref="A1.E18.m1.307.307.307.2.2.2.3.2.1.1.3.cmml">c</mi></mrow><mo id="A1.E18.m1.307.307.307.2.2.2.3.2.1.3" stretchy="false" xref="A1.E18.m1.307.307.307.2.2.2.3.2.1.1.cmml">)</mo></mrow></mrow></mfrac><mo id="A1.E18.m1.308.308.308.3.3.3" xref="A1.E18.m1.308.308.308.3.3.3.cmml">+</mo><mrow id="A1.E18.m1.331.331.12.329.11.11.11.1.1.1"><mfrac id="A1.E18.m1.309.309.309.4.4.4" xref="A1.E18.m1.309.309.309.4.4.4.cmml"><mrow id="A1.E18.m1.309.309.309.4.4.4.2" xref="A1.E18.m1.309.309.309.4.4.4.2.cmml"><mn id="A1.E18.m1.309.309.309.4.4.4.2.2" xref="A1.E18.m1.309.309.309.4.4.4.2.2.cmml">2</mn><mo id="A1.E18.m1.309.309.309.4.4.4.2.1" xref="A1.E18.m1.309.309.309.4.4.4.2.1.cmml">⁢</mo><mi id="A1.E18.m1.309.309.309.4.4.4.2.3" xref="A1.E18.m1.309.309.309.4.4.4.2.3.cmml">ϵ</mi></mrow><mrow id="A1.E18.m1.309.309.309.4.4.4.3" xref="A1.E18.m1.309.309.309.4.4.4.3.cmml"><mn id="A1.E18.m1.309.309.309.4.4.4.3.2" xref="A1.E18.m1.309.309.309.4.4.4.3.2.cmml">1</mn><mo id="A1.E18.m1.309.309.309.4.4.4.3.1" xref="A1.E18.m1.309.309.309.4.4.4.3.1.cmml">−</mo><mi id="A1.E18.m1.309.309.309.4.4.4.3.3" xref="A1.E18.m1.309.309.309.4.4.4.3.3.cmml">c</mi></mrow></mfrac><mo id="A1.E18.m1.331.331.12.329.11.11.11.1.1.1.1" xref="A1.E18.m1.321.321.2.3.cmml">⁢</mo><mrow id="A1.E18.m1.331.331.12.329.11.11.11.1.1.1.2"><munderover id="A1.E18.m1.331.331.12.329.11.11.11.1.1.1.2.1"><mo id="A1.E18.m1.310.310.310.5.5.5" movablelimits="false" xref="A1.E18.m1.310.310.310.5.5.5.cmml">∑</mo><mrow id="A1.E18.m1.311.311.311.6.6.6.1" xref="A1.E18.m1.311.311.311.6.6.6.1.cmml"><mi id="A1.E18.m1.311.311.311.6.6.6.1.2" xref="A1.E18.m1.311.311.311.6.6.6.1.2.cmml">h</mi><mo id="A1.E18.m1.311.311.311.6.6.6.1.1" xref="A1.E18.m1.311.311.311.6.6.6.1.1.cmml">=</mo><mn id="A1.E18.m1.311.311.311.6.6.6.1.3" xref="A1.E18.m1.311.311.311.6.6.6.1.3.cmml">0</mn></mrow><mrow id="A1.E18.m1.312.312.312.7.7.7.1" xref="A1.E18.m1.312.312.312.7.7.7.1.cmml"><mi id="A1.E18.m1.312.312.312.7.7.7.1.2" xref="A1.E18.m1.312.312.312.7.7.7.1.2.cmml">H</mi><mo id="A1.E18.m1.312.312.312.7.7.7.1.1" xref="A1.E18.m1.312.312.312.7.7.7.1.1.cmml">−</mo><mn id="A1.E18.m1.312.312.312.7.7.7.1.3" xref="A1.E18.m1.312.312.312.7.7.7.1.3.cmml">1</mn></mrow></munderover><msup id="A1.E18.m1.331.331.12.329.11.11.11.1.1.1.2.2"><mi id="A1.E18.m1.313.313.313.8.8.8" xref="A1.E18.m1.313.313.313.8.8.8.cmml">γ</mi><mi id="A1.E18.m1.314.314.314.9.9.9.1" xref="A1.E18.m1.314.314.314.9.9.9.1.cmml">h</mi></msup></mrow></mrow></mrow><mspace id="A1.E18.m1.331.331.12.329.11.11.11.1.2" width="1em" xref="A1.E18.m1.321.321.2.3.cmml"></mspace><mrow id="A1.E18.m1.315.315.315.10.10.10" xref="A1.E18.m1.315.315.315.10.10.10j.cmml"><mtext id="A1.E18.m1.315.315.315.10.10.10a" xref="A1.E18.m1.315.315.315.10.10.10j.cmml">(From Theorem </mtext><mtext id="A1.E18.m1.315.315.315.10.10.10b" xref="A1.E18.m1.315.315.315.10.10.10j.cmml"><a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#Thmthm2" title="Theorem 2. ‣ 4.2 Theoretical Analysis ‣ 4 Bisimulation metric for model predictive control ‣ Bisimulation metric for Model Predictive Control"><span class="ltx_text ltx_ref_tag">2</span></a></mtext><mtext id="A1.E18.m1.315.315.315.10.10.10e" xref="A1.E18.m1.315.315.315.10.10.10j.cmml"> and Lemma </mtext><mtext id="A1.E18.m1.315.315.315.10.10.10f" xref="A1.E18.m1.315.315.315.10.10.10j.cmml"><a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#Thmlem1" title="Lemma 1. ‣ Appendix A Proof of Theorem 3 ‣ Bisimulation metric for Model Predictive Control"><span class="ltx_text ltx_ref_tag">1</span></a></mtext><mtext id="A1.E18.m1.315.315.315.10.10.10i" xref="A1.E18.m1.315.315.315.10.10.10j.cmml">)</mtext></mrow></mrow></mrow></mtd></mtr><mtr id="A1.E18.m1.331.331.12y"><mtd id="A1.E18.m1.331.331.12z" xref="A1.E18.m1.321.321.2.3.cmml"></mtd><mtd class="ltx_align_left" columnalign="left" id="A1.E18.m1.331.331.12aa"><mrow id="A1.E18.m1.319.319.319.4.4"><mi id="A1.E18.m1.319.319.319.4.4.5" xref="A1.E18.m1.321.321.2.3.cmml"></mi><mo id="A1.E18.m1.316.316.316.1.1.1" xref="A1.E18.m1.316.316.316.1.1.1.cmml">≤</mo><mrow id="A1.E18.m1.319.319.319.4.4.6"><mfrac id="A1.E18.m1.317.317.317.2.2.2" xref="A1.E18.m1.317.317.317.2.2.2.cmml"><mrow id="A1.E18.m1.317.317.317.2.2.2.1" xref="A1.E18.m1.317.317.317.2.2.2.1.cmml"><mn id="A1.E18.m1.317.317.317.2.2.2.1.3" xref="A1.E18.m1.317.317.317.2.2.2.1.3.cmml">2</mn><mo id="A1.E18.m1.317.317.317.2.2.2.1.2" xref="A1.E18.m1.317.317.317.2.2.2.1.2.cmml">⁢</mo><msup id="A1.E18.m1.317.317.317.2.2.2.1.4" xref="A1.E18.m1.317.317.317.2.2.2.1.4.cmml"><mi id="A1.E18.m1.317.317.317.2.2.2.1.4.2" xref="A1.E18.m1.317.317.317.2.2.2.1.4.2.cmml">γ</mi><mi id="A1.E18.m1.317.317.317.2.2.2.1.4.3" xref="A1.E18.m1.317.317.317.2.2.2.1.4.3.cmml">H</mi></msup><mo id="A1.E18.m1.317.317.317.2.2.2.1.2a" xref="A1.E18.m1.317.317.317.2.2.2.1.2.cmml">⁢</mo><mrow id="A1.E18.m1.317.317.317.2.2.2.1.1.1" xref="A1.E18.m1.317.317.317.2.2.2.1.1.1.1.cmml"><mo id="A1.E18.m1.317.317.317.2.2.2.1.1.1.2" stretchy="false" xref="A1.E18.m1.317.317.317.2.2.2.1.1.1.1.cmml">(</mo><mrow id="A1.E18.m1.317.317.317.2.2.2.1.1.1.1" xref="A1.E18.m1.317.317.317.2.2.2.1.1.1.1.cmml"><mi id="A1.E18.m1.317.317.317.2.2.2.1.1.1.1.2" xref="A1.E18.m1.317.317.317.2.2.2.1.1.1.1.2.cmml">ϵ</mi><mo id="A1.E18.m1.317.317.317.2.2.2.1.1.1.1.1" xref="A1.E18.m1.317.317.317.2.2.2.1.1.1.1.1.cmml">+</mo><mi class="ltx_font_mathcaligraphic" id="A1.E18.m1.317.317.317.2.2.2.1.1.1.1.3" xref="A1.E18.m1.317.317.317.2.2.2.1.1.1.1.3.cmml">ℒ</mi></mrow><mo id="A1.E18.m1.317.317.317.2.2.2.1.1.1.3" stretchy="false" xref="A1.E18.m1.317.317.317.2.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="A1.E18.m1.317.317.317.2.2.2.3" xref="A1.E18.m1.317.317.317.2.2.2.3.cmml"><mrow id="A1.E18.m1.317.317.317.2.2.2.2.1.1" xref="A1.E18.m1.317.317.317.2.2.2.2.1.1.1.cmml"><mo id="A1.E18.m1.317.317.317.2.2.2.2.1.1.2" stretchy="false" xref="A1.E18.m1.317.317.317.2.2.2.2.1.1.1.cmml">(</mo><mrow id="A1.E18.m1.317.317.317.2.2.2.2.1.1.1" xref="A1.E18.m1.317.317.317.2.2.2.2.1.1.1.cmml"><mn id="A1.E18.m1.317.317.317.2.2.2.2.1.1.1.2" xref="A1.E18.m1.317.317.317.2.2.2.2.1.1.1.2.cmml">1</mn><mo id="A1.E18.m1.317.317.317.2.2.2.2.1.1.1.1" xref="A1.E18.m1.317.317.317.2.2.2.2.1.1.1.1.cmml">−</mo><mi id="A1.E18.m1.317.317.317.2.2.2.2.1.1.1.3" xref="A1.E18.m1.317.317.317.2.2.2.2.1.1.1.3.cmml">γ</mi></mrow><mo id="A1.E18.m1.317.317.317.2.2.2.2.1.1.3" stretchy="false" xref="A1.E18.m1.317.317.317.2.2.2.2.1.1.1.cmml">)</mo></mrow><mo id="A1.E18.m1.317.317.317.2.2.2.3.3" xref="A1.E18.m1.317.317.317.2.2.2.3.3.cmml">⁢</mo><mrow id="A1.E18.m1.317.317.317.2.2.2.3.2.1" xref="A1.E18.m1.317.317.317.2.2.2.3.2.1.1.cmml"><mo id="A1.E18.m1.317.317.317.2.2.2.3.2.1.2" stretchy="false" xref="A1.E18.m1.317.317.317.2.2.2.3.2.1.1.cmml">(</mo><mrow id="A1.E18.m1.317.317.317.2.2.2.3.2.1.1" xref="A1.E18.m1.317.317.317.2.2.2.3.2.1.1.cmml"><mn id="A1.E18.m1.317.317.317.2.2.2.3.2.1.1.2" xref="A1.E18.m1.317.317.317.2.2.2.3.2.1.1.2.cmml">1</mn><mo id="A1.E18.m1.317.317.317.2.2.2.3.2.1.1.1" xref="A1.E18.m1.317.317.317.2.2.2.3.2.1.1.1.cmml">−</mo><mi id="A1.E18.m1.317.317.317.2.2.2.3.2.1.1.3" xref="A1.E18.m1.317.317.317.2.2.2.3.2.1.1.3.cmml">c</mi></mrow><mo id="A1.E18.m1.317.317.317.2.2.2.3.2.1.3" stretchy="false" xref="A1.E18.m1.317.317.317.2.2.2.3.2.1.1.cmml">)</mo></mrow></mrow></mfrac><mo id="A1.E18.m1.318.318.318.3.3.3" xref="A1.E18.m1.318.318.318.3.3.3.cmml">+</mo><mfrac id="A1.E18.m1.319.319.319.4.4.4" xref="A1.E18.m1.319.319.319.4.4.4.cmml"><mrow id="A1.E18.m1.319.319.319.4.4.4.1" xref="A1.E18.m1.319.319.319.4.4.4.1.cmml"><mn id="A1.E18.m1.319.319.319.4.4.4.1.3" xref="A1.E18.m1.319.319.319.4.4.4.1.3.cmml">2</mn><mo id="A1.E18.m1.319.319.319.4.4.4.1.2" xref="A1.E18.m1.319.319.319.4.4.4.1.2.cmml">⁢</mo><mi id="A1.E18.m1.319.319.319.4.4.4.1.4" xref="A1.E18.m1.319.319.319.4.4.4.1.4.cmml">ϵ</mi><mo id="A1.E18.m1.319.319.319.4.4.4.1.2a" xref="A1.E18.m1.319.319.319.4.4.4.1.2.cmml">⁢</mo><mrow id="A1.E18.m1.319.319.319.4.4.4.1.1.1" xref="A1.E18.m1.319.319.319.4.4.4.1.1.1.1.cmml"><mo id="A1.E18.m1.319.319.319.4.4.4.1.1.1.2" stretchy="false" xref="A1.E18.m1.319.319.319.4.4.4.1.1.1.1.cmml">(</mo><mrow id="A1.E18.m1.319.319.319.4.4.4.1.1.1.1" xref="A1.E18.m1.319.319.319.4.4.4.1.1.1.1.cmml"><mn id="A1.E18.m1.319.319.319.4.4.4.1.1.1.1.2" xref="A1.E18.m1.319.319.319.4.4.4.1.1.1.1.2.cmml">1</mn><mo id="A1.E18.m1.319.319.319.4.4.4.1.1.1.1.1" xref="A1.E18.m1.319.319.319.4.4.4.1.1.1.1.1.cmml">−</mo><msup id="A1.E18.m1.319.319.319.4.4.4.1.1.1.1.3" xref="A1.E18.m1.319.319.319.4.4.4.1.1.1.1.3.cmml"><mi id="A1.E18.m1.319.319.319.4.4.4.1.1.1.1.3.2" xref="A1.E18.m1.319.319.319.4.4.4.1.1.1.1.3.2.cmml">γ</mi><mrow id="A1.E18.m1.319.319.319.4.4.4.1.1.1.1.3.3" xref="A1.E18.m1.319.319.319.4.4.4.1.1.1.1.3.3.cmml"><mi id="A1.E18.m1.319.319.319.4.4.4.1.1.1.1.3.3.2" xref="A1.E18.m1.319.319.319.4.4.4.1.1.1.1.3.3.2.cmml">H</mi><mo id="A1.E18.m1.319.319.319.4.4.4.1.1.1.1.3.3.1" xref="A1.E18.m1.319.319.319.4.4.4.1.1.1.1.3.3.1.cmml">−</mo><mn id="A1.E18.m1.319.319.319.4.4.4.1.1.1.1.3.3.3" xref="A1.E18.m1.319.319.319.4.4.4.1.1.1.1.3.3.3.cmml">1</mn></mrow></msup></mrow><mo id="A1.E18.m1.319.319.319.4.4.4.1.1.1.3" stretchy="false" xref="A1.E18.m1.319.319.319.4.4.4.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="A1.E18.m1.319.319.319.4.4.4.3" xref="A1.E18.m1.319.319.319.4.4.4.3.cmml"><mrow id="A1.E18.m1.319.319.319.4.4.4.2.1.1" xref="A1.E18.m1.319.319.319.4.4.4.2.1.1.1.cmml"><mo id="A1.E18.m1.319.319.319.4.4.4.2.1.1.2" stretchy="false" xref="A1.E18.m1.319.319.319.4.4.4.2.1.1.1.cmml">(</mo><mrow id="A1.E18.m1.319.319.319.4.4.4.2.1.1.1" xref="A1.E18.m1.319.319.319.4.4.4.2.1.1.1.cmml"><mn id="A1.E18.m1.319.319.319.4.4.4.2.1.1.1.2" xref="A1.E18.m1.319.319.319.4.4.4.2.1.1.1.2.cmml">1</mn><mo id="A1.E18.m1.319.319.319.4.4.4.2.1.1.1.1" xref="A1.E18.m1.319.319.319.4.4.4.2.1.1.1.1.cmml">−</mo><mi id="A1.E18.m1.319.319.319.4.4.4.2.1.1.1.3" xref="A1.E18.m1.319.319.319.4.4.4.2.1.1.1.3.cmml">γ</mi></mrow><mo id="A1.E18.m1.319.319.319.4.4.4.2.1.1.3" stretchy="false" xref="A1.E18.m1.319.319.319.4.4.4.2.1.1.1.cmml">)</mo></mrow><mo id="A1.E18.m1.319.319.319.4.4.4.3.3" xref="A1.E18.m1.319.319.319.4.4.4.3.3.cmml">⁢</mo><mrow id="A1.E18.m1.319.319.319.4.4.4.3.2.1" xref="A1.E18.m1.319.319.319.4.4.4.3.2.1.1.cmml"><mo id="A1.E18.m1.319.319.319.4.4.4.3.2.1.2" stretchy="false" xref="A1.E18.m1.319.319.319.4.4.4.3.2.1.1.cmml">(</mo><mrow id="A1.E18.m1.319.319.319.4.4.4.3.2.1.1" xref="A1.E18.m1.319.319.319.4.4.4.3.2.1.1.cmml"><mn id="A1.E18.m1.319.319.319.4.4.4.3.2.1.1.2" xref="A1.E18.m1.319.319.319.4.4.4.3.2.1.1.2.cmml">1</mn><mo id="A1.E18.m1.319.319.319.4.4.4.3.2.1.1.1" xref="A1.E18.m1.319.319.319.4.4.4.3.2.1.1.1.cmml">−</mo><mi id="A1.E18.m1.319.319.319.4.4.4.3.2.1.1.3" xref="A1.E18.m1.319.319.319.4.4.4.3.2.1.1.3.cmml">c</mi></mrow><mo id="A1.E18.m1.319.319.319.4.4.4.3.2.1.3" stretchy="false" xref="A1.E18.m1.319.319.319.4.4.4.3.2.1.1.cmml">)</mo></mrow></mrow></mfrac></mrow></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="A1.E18.m1.331b"><apply id="A1.E18.m1.321.321.2.3.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E18.m1.321.321.2.3a.cmml" xref="A1.E18.m1.1.1.1.1.1.1">formulae-sequence</csymbol><apply id="A1.E18.m1.320.320.1.1.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><and id="A1.E18.m1.320.320.1.1.1a.cmml" xref="A1.E18.m1.1.1.1.1.1.1"></and><apply id="A1.E18.m1.320.320.1.1.1b.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><eq id="A1.E18.m1.15.15.15.15.1.1.cmml" xref="A1.E18.m1.15.15.15.15.1.1"></eq><apply id="A1.E18.m1.320.320.1.1.1.1.2.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><abs id="A1.E18.m1.320.320.1.1.1.1.2.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1"></abs><apply id="A1.E18.m1.320.320.1.1.1.1.1.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><minus id="A1.E18.m1.6.6.6.6.6.6.cmml" xref="A1.E18.m1.6.6.6.6.6.6"></minus><apply id="A1.E18.m1.320.320.1.1.1.1.1.1.3.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><times id="A1.E18.m1.320.320.1.1.1.1.1.1.3.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1"></times><ci id="A1.E18.m1.2.2.2.2.2.2.cmml" xref="A1.E18.m1.2.2.2.2.2.2">𝐒</ci><ci id="A1.E18.m1.4.4.4.4.4.4.cmml" xref="A1.E18.m1.4.4.4.4.4.4">𝜏</ci></apply><apply id="A1.E18.m1.320.320.1.1.1.1.1.1.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><times id="A1.E18.m1.320.320.1.1.1.1.1.1.1.2.cmml" xref="A1.E18.m1.1.1.1.1.1.1"></times><ci id="A1.E18.m1.7.7.7.7.7.7.cmml" xref="A1.E18.m1.7.7.7.7.7.7">𝐒</ci><apply id="A1.E18.m1.320.320.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><times id="A1.E18.m1.320.320.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1"></times><ci id="A1.E18.m1.9.9.9.9.9.9.cmml" xref="A1.E18.m1.9.9.9.9.9.9">italic-ϕ</ci><ci id="A1.E18.m1.11.11.11.11.11.11.cmml" xref="A1.E18.m1.11.11.11.11.11.11">𝜏</ci></apply></apply></apply></apply><apply id="A1.E18.m1.320.320.1.1.1.2.2.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><abs id="A1.E18.m1.320.320.1.1.1.2.2.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1"></abs><apply id="A1.E18.m1.320.320.1.1.1.2.1.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><times id="A1.E18.m1.320.320.1.1.1.2.1.1.2.cmml" xref="A1.E18.m1.1.1.1.1.1.1"></times><apply id="A1.E18.m1.320.320.1.1.1.2.1.1.3.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E18.m1.320.320.1.1.1.2.1.1.3.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.E18.m1.17.17.17.17.3.3.cmml" xref="A1.E18.m1.17.17.17.17.3.3">𝔼</ci><ci id="A1.E18.m1.18.18.18.18.4.4.1.cmml" xref="A1.E18.m1.18.18.18.18.4.4.1">𝜏</ci></apply><apply id="A1.E18.m1.320.320.1.1.1.2.1.1.1.2.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><csymbol cd="latexml" id="A1.E18.m1.320.320.1.1.1.2.1.1.1.2.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1">delimited-[]</csymbol><apply id="A1.E18.m1.320.320.1.1.1.2.1.1.1.1.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><plus id="A1.E18.m1.40.40.40.40.26.26.cmml" xref="A1.E18.m1.40.40.40.40.26.26"></plus><apply id="A1.E18.m1.320.320.1.1.1.2.1.1.1.1.1.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><times id="A1.E18.m1.320.320.1.1.1.2.1.1.1.1.1.1.2.cmml" xref="A1.E18.m1.1.1.1.1.1.1"></times><apply id="A1.E18.m1.320.320.1.1.1.2.1.1.1.1.1.1.3.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E18.m1.320.320.1.1.1.2.1.1.1.1.1.1.3.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1">superscript</csymbol><ci id="A1.E18.m1.20.20.20.20.6.6.cmml" xref="A1.E18.m1.20.20.20.20.6.6">𝛾</ci><ci id="A1.E18.m1.21.21.21.21.7.7.1.cmml" xref="A1.E18.m1.21.21.21.21.7.7.1">𝐻</ci></apply><apply id="A1.E18.m1.320.320.1.1.1.2.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><minus id="A1.E18.m1.29.29.29.29.15.15.cmml" xref="A1.E18.m1.29.29.29.29.15.15"></minus><apply id="A1.E18.m1.320.320.1.1.1.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><times id="A1.E18.m1.320.320.1.1.1.2.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E18.m1.1.1.1.1.1.1"></times><apply id="A1.E18.m1.320.320.1.1.1.2.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E18.m1.320.320.1.1.1.2.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1">superscript</csymbol><ci id="A1.E18.m1.23.23.23.23.9.9.cmml" xref="A1.E18.m1.23.23.23.23.9.9">𝑉</ci><times id="A1.E18.m1.24.24.24.24.10.10.1.cmml" xref="A1.E18.m1.24.24.24.24.10.10.1"></times></apply><apply id="A1.E18.m1.320.320.1.1.1.2.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E18.m1.320.320.1.1.1.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.E18.m1.26.26.26.26.12.12.cmml" xref="A1.E18.m1.26.26.26.26.12.12">𝑠</ci><ci id="A1.E18.m1.27.27.27.27.13.13.1.cmml" xref="A1.E18.m1.27.27.27.27.13.13.1">𝐻</ci></apply></apply><apply id="A1.E18.m1.320.320.1.1.1.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><times id="A1.E18.m1.320.320.1.1.1.2.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="A1.E18.m1.1.1.1.1.1.1"></times><apply id="A1.E18.m1.320.320.1.1.1.2.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E18.m1.320.320.1.1.1.2.1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1">superscript</csymbol><ci id="A1.E18.m1.30.30.30.30.16.16.cmml" xref="A1.E18.m1.30.30.30.30.16.16">𝑉</ci><times id="A1.E18.m1.31.31.31.31.17.17.1.cmml" xref="A1.E18.m1.31.31.31.31.17.17.1"></times></apply><apply id="A1.E18.m1.320.320.1.1.1.2.1.1.1.1.1.1.1.1.1.2.1.1.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><times id="A1.E18.m1.320.320.1.1.1.2.1.1.1.1.1.1.1.1.1.2.1.1.1.2.cmml" xref="A1.E18.m1.1.1.1.1.1.1"></times><ci id="A1.E18.m1.33.33.33.33.19.19.cmml" xref="A1.E18.m1.33.33.33.33.19.19">italic-ϕ</ci><apply id="A1.E18.m1.320.320.1.1.1.2.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E18.m1.320.320.1.1.1.2.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.E18.m1.35.35.35.35.21.21.cmml" xref="A1.E18.m1.35.35.35.35.21.21">𝑠</ci><ci id="A1.E18.m1.36.36.36.36.22.22.1.cmml" xref="A1.E18.m1.36.36.36.36.22.22.1">𝐻</ci></apply></apply></apply></apply></apply><apply id="A1.E18.m1.320.320.1.1.1.2.1.1.1.1.1.2.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><apply id="A1.E18.m1.320.320.1.1.1.2.1.1.1.1.1.2.2.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E18.m1.320.320.1.1.1.2.1.1.1.1.1.2.2.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1">superscript</csymbol><apply id="A1.E18.m1.320.320.1.1.1.2.1.1.1.1.1.2.2.2.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E18.m1.320.320.1.1.1.2.1.1.1.1.1.2.2.2.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1">subscript</csymbol><sum id="A1.E18.m1.41.41.41.41.27.27.cmml" xref="A1.E18.m1.41.41.41.41.27.27"></sum><apply id="A1.E18.m1.42.42.42.42.28.28.1.cmml" xref="A1.E18.m1.42.42.42.42.28.28.1"><eq id="A1.E18.m1.42.42.42.42.28.28.1.1.cmml" xref="A1.E18.m1.42.42.42.42.28.28.1.1"></eq><ci id="A1.E18.m1.42.42.42.42.28.28.1.2.cmml" xref="A1.E18.m1.42.42.42.42.28.28.1.2">ℎ</ci><cn id="A1.E18.m1.42.42.42.42.28.28.1.3.cmml" type="integer" xref="A1.E18.m1.42.42.42.42.28.28.1.3">0</cn></apply></apply><apply id="A1.E18.m1.43.43.43.43.29.29.1.cmml" xref="A1.E18.m1.43.43.43.43.29.29.1"><minus id="A1.E18.m1.43.43.43.43.29.29.1.1.cmml" xref="A1.E18.m1.43.43.43.43.29.29.1.1"></minus><ci id="A1.E18.m1.43.43.43.43.29.29.1.2.cmml" xref="A1.E18.m1.43.43.43.43.29.29.1.2">𝐻</ci><cn id="A1.E18.m1.43.43.43.43.29.29.1.3.cmml" type="integer" xref="A1.E18.m1.43.43.43.43.29.29.1.3">1</cn></apply></apply><apply id="A1.E18.m1.320.320.1.1.1.2.1.1.1.1.1.2.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><times id="A1.E18.m1.320.320.1.1.1.2.1.1.1.1.1.2.1.2.cmml" xref="A1.E18.m1.1.1.1.1.1.1"></times><apply id="A1.E18.m1.320.320.1.1.1.2.1.1.1.1.1.2.1.3.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E18.m1.320.320.1.1.1.2.1.1.1.1.1.2.1.3.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1">superscript</csymbol><ci id="A1.E18.m1.44.44.44.44.30.30.cmml" xref="A1.E18.m1.44.44.44.44.30.30">𝛾</ci><ci id="A1.E18.m1.45.45.45.45.31.31.1.cmml" xref="A1.E18.m1.45.45.45.45.31.31.1">ℎ</ci></apply><apply id="A1.E18.m1.320.320.1.1.1.2.1.1.1.1.1.2.1.1.1.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><minus id="A1.E18.m1.55.55.55.55.41.41.cmml" xref="A1.E18.m1.55.55.55.55.41.41"></minus><apply id="A1.E18.m1.320.320.1.1.1.2.1.1.1.1.1.2.1.1.1.1.2.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><times id="A1.E18.m1.320.320.1.1.1.2.1.1.1.1.1.2.1.1.1.1.2.3.cmml" xref="A1.E18.m1.1.1.1.1.1.1"></times><ci id="A1.E18.m1.47.47.47.47.33.33.cmml" xref="A1.E18.m1.47.47.47.47.33.33">𝑅</ci><interval closure="open" id="A1.E18.m1.320.320.1.1.1.2.1.1.1.1.1.2.1.1.1.1.2.2.3.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><apply id="A1.E18.m1.320.320.1.1.1.2.1.1.1.1.1.2.1.1.1.1.1.1.1.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E18.m1.320.320.1.1.1.2.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.E18.m1.49.49.49.49.35.35.cmml" xref="A1.E18.m1.49.49.49.49.35.35">𝑠</ci><ci id="A1.E18.m1.50.50.50.50.36.36.1.cmml" xref="A1.E18.m1.50.50.50.50.36.36.1">ℎ</ci></apply><apply id="A1.E18.m1.320.320.1.1.1.2.1.1.1.1.1.2.1.1.1.1.2.2.2.2.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E18.m1.320.320.1.1.1.2.1.1.1.1.1.2.1.1.1.1.2.2.2.2.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.E18.m1.52.52.52.52.38.38.cmml" xref="A1.E18.m1.52.52.52.52.38.38">𝑎</ci><ci id="A1.E18.m1.53.53.53.53.39.39.1.cmml" xref="A1.E18.m1.53.53.53.53.39.39.1">ℎ</ci></apply></interval></apply><apply id="A1.E18.m1.320.320.1.1.1.2.1.1.1.1.1.2.1.1.1.1.4.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><times id="A1.E18.m1.320.320.1.1.1.2.1.1.1.1.1.2.1.1.1.1.4.3.cmml" xref="A1.E18.m1.1.1.1.1.1.1"></times><ci id="A1.E18.m1.56.56.56.56.42.42.cmml" xref="A1.E18.m1.56.56.56.56.42.42">𝑅</ci><interval closure="open" id="A1.E18.m1.320.320.1.1.1.2.1.1.1.1.1.2.1.1.1.1.4.2.3.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><apply id="A1.E18.m1.320.320.1.1.1.2.1.1.1.1.1.2.1.1.1.1.3.1.1.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><times id="A1.E18.m1.320.320.1.1.1.2.1.1.1.1.1.2.1.1.1.1.3.1.1.1.2.cmml" xref="A1.E18.m1.1.1.1.1.1.1"></times><ci id="A1.E18.m1.58.58.58.58.44.44.cmml" xref="A1.E18.m1.58.58.58.58.44.44">italic-ϕ</ci><apply id="A1.E18.m1.320.320.1.1.1.2.1.1.1.1.1.2.1.1.1.1.3.1.1.1.1.1.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E18.m1.320.320.1.1.1.2.1.1.1.1.1.2.1.1.1.1.3.1.1.1.1.1.1.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.E18.m1.60.60.60.60.46.46.cmml" xref="A1.E18.m1.60.60.60.60.46.46">𝑠</ci><ci id="A1.E18.m1.61.61.61.61.47.47.1.cmml" xref="A1.E18.m1.61.61.61.61.47.47.1">ℎ</ci></apply></apply><apply id="A1.E18.m1.320.320.1.1.1.2.1.1.1.1.1.2.1.1.1.1.4.2.2.2.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E18.m1.320.320.1.1.1.2.1.1.1.1.1.2.1.1.1.1.4.2.2.2.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.E18.m1.64.64.64.64.50.50.cmml" xref="A1.E18.m1.64.64.64.64.50.50">𝑎</ci><ci id="A1.E18.m1.65.65.65.65.51.51.1.cmml" xref="A1.E18.m1.65.65.65.65.51.51.1">ℎ</ci></apply></interval></apply></apply></apply></apply></apply></apply></apply></apply></apply><apply id="A1.E18.m1.320.320.1.1.1c.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><eq id="A1.E18.m1.70.70.70.1.1.1.cmml" xref="A1.E18.m1.70.70.70.1.1.1"></eq><share href="https://arxiv.org/html/2410.04553v1#A1.E18.m1.320.320.1.1.1.2.cmml" id="A1.E18.m1.320.320.1.1.1d.cmml" xref="A1.E18.m1.1.1.1.1.1.1"></share><apply id="A1.E18.m1.320.320.1.1.1.3.2.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><abs id="A1.E18.m1.320.320.1.1.1.3.2.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1"></abs><apply id="A1.E18.m1.320.320.1.1.1.3.1.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><plus id="A1.E18.m1.96.96.96.27.27.27.cmml" xref="A1.E18.m1.96.96.96.27.27.27"></plus><apply id="A1.E18.m1.320.320.1.1.1.3.1.1.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><times id="A1.E18.m1.320.320.1.1.1.3.1.1.1.2.cmml" xref="A1.E18.m1.1.1.1.1.1.1"></times><apply id="A1.E18.m1.320.320.1.1.1.3.1.1.1.3.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E18.m1.320.320.1.1.1.3.1.1.1.3.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.E18.m1.72.72.72.3.3.3.cmml" xref="A1.E18.m1.72.72.72.3.3.3">𝔼</ci><ci id="A1.E18.m1.73.73.73.4.4.4.1.cmml" xref="A1.E18.m1.73.73.73.4.4.4.1">𝜏</ci></apply><apply id="A1.E18.m1.320.320.1.1.1.3.1.1.1.1.2.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><csymbol cd="latexml" id="A1.E18.m1.320.320.1.1.1.3.1.1.1.1.2.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1">delimited-[]</csymbol><apply id="A1.E18.m1.320.320.1.1.1.3.1.1.1.1.1.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><times id="A1.E18.m1.320.320.1.1.1.3.1.1.1.1.1.1.2.cmml" xref="A1.E18.m1.1.1.1.1.1.1"></times><apply id="A1.E18.m1.320.320.1.1.1.3.1.1.1.1.1.1.3.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E18.m1.320.320.1.1.1.3.1.1.1.1.1.1.3.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1">superscript</csymbol><ci id="A1.E18.m1.75.75.75.6.6.6.cmml" xref="A1.E18.m1.75.75.75.6.6.6">𝛾</ci><ci id="A1.E18.m1.76.76.76.7.7.7.1.cmml" xref="A1.E18.m1.76.76.76.7.7.7.1">𝐻</ci></apply><apply id="A1.E18.m1.320.320.1.1.1.3.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><minus id="A1.E18.m1.84.84.84.15.15.15.cmml" xref="A1.E18.m1.84.84.84.15.15.15"></minus><apply id="A1.E18.m1.320.320.1.1.1.3.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><times id="A1.E18.m1.320.320.1.1.1.3.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E18.m1.1.1.1.1.1.1"></times><apply id="A1.E18.m1.320.320.1.1.1.3.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E18.m1.320.320.1.1.1.3.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1">superscript</csymbol><ci id="A1.E18.m1.78.78.78.9.9.9.cmml" xref="A1.E18.m1.78.78.78.9.9.9">𝑉</ci><times id="A1.E18.m1.79.79.79.10.10.10.1.cmml" xref="A1.E18.m1.79.79.79.10.10.10.1"></times></apply><apply id="A1.E18.m1.320.320.1.1.1.3.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E18.m1.320.320.1.1.1.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.E18.m1.81.81.81.12.12.12.cmml" xref="A1.E18.m1.81.81.81.12.12.12">𝑠</ci><ci id="A1.E18.m1.82.82.82.13.13.13.1.cmml" xref="A1.E18.m1.82.82.82.13.13.13.1">𝐻</ci></apply></apply><apply id="A1.E18.m1.320.320.1.1.1.3.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><times id="A1.E18.m1.320.320.1.1.1.3.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="A1.E18.m1.1.1.1.1.1.1"></times><apply id="A1.E18.m1.320.320.1.1.1.3.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E18.m1.320.320.1.1.1.3.1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1">superscript</csymbol><ci id="A1.E18.m1.85.85.85.16.16.16.cmml" xref="A1.E18.m1.85.85.85.16.16.16">𝑉</ci><times id="A1.E18.m1.86.86.86.17.17.17.1.cmml" xref="A1.E18.m1.86.86.86.17.17.17.1"></times></apply><apply id="A1.E18.m1.320.320.1.1.1.3.1.1.1.1.1.1.1.1.1.2.1.1.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><times id="A1.E18.m1.320.320.1.1.1.3.1.1.1.1.1.1.1.1.1.2.1.1.1.2.cmml" xref="A1.E18.m1.1.1.1.1.1.1"></times><ci id="A1.E18.m1.88.88.88.19.19.19.cmml" xref="A1.E18.m1.88.88.88.19.19.19">italic-ϕ</ci><apply id="A1.E18.m1.320.320.1.1.1.3.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E18.m1.320.320.1.1.1.3.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.E18.m1.90.90.90.21.21.21.cmml" xref="A1.E18.m1.90.90.90.21.21.21">𝑠</ci><ci id="A1.E18.m1.91.91.91.22.22.22.1.cmml" xref="A1.E18.m1.91.91.91.22.22.22.1">𝐻</ci></apply></apply></apply></apply></apply></apply></apply><apply id="A1.E18.m1.320.320.1.1.1.3.1.1.2.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><times id="A1.E18.m1.320.320.1.1.1.3.1.1.2.2.cmml" xref="A1.E18.m1.1.1.1.1.1.1"></times><apply id="A1.E18.m1.320.320.1.1.1.3.1.1.2.3.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E18.m1.320.320.1.1.1.3.1.1.2.3.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.E18.m1.97.97.97.28.28.28.cmml" xref="A1.E18.m1.97.97.97.28.28.28">𝔼</ci><ci id="A1.E18.m1.98.98.98.29.29.29.1.cmml" xref="A1.E18.m1.98.98.98.29.29.29.1">𝜏</ci></apply><apply id="A1.E18.m1.320.320.1.1.1.3.1.1.2.1.2.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><csymbol cd="latexml" id="A1.E18.m1.320.320.1.1.1.3.1.1.2.1.2.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1">delimited-[]</csymbol><apply id="A1.E18.m1.320.320.1.1.1.3.1.1.2.1.1.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><apply id="A1.E18.m1.320.320.1.1.1.3.1.1.2.1.1.1.2.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E18.m1.320.320.1.1.1.3.1.1.2.1.1.1.2.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1">superscript</csymbol><apply id="A1.E18.m1.320.320.1.1.1.3.1.1.2.1.1.1.2.2.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E18.m1.320.320.1.1.1.3.1.1.2.1.1.1.2.2.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1">subscript</csymbol><sum id="A1.E18.m1.100.100.100.31.31.31.cmml" xref="A1.E18.m1.100.100.100.31.31.31"></sum><apply id="A1.E18.m1.101.101.101.32.32.32.1.cmml" xref="A1.E18.m1.101.101.101.32.32.32.1"><eq id="A1.E18.m1.101.101.101.32.32.32.1.1.cmml" xref="A1.E18.m1.101.101.101.32.32.32.1.1"></eq><ci id="A1.E18.m1.101.101.101.32.32.32.1.2.cmml" xref="A1.E18.m1.101.101.101.32.32.32.1.2">ℎ</ci><cn id="A1.E18.m1.101.101.101.32.32.32.1.3.cmml" type="integer" xref="A1.E18.m1.101.101.101.32.32.32.1.3">0</cn></apply></apply><apply id="A1.E18.m1.102.102.102.33.33.33.1.cmml" xref="A1.E18.m1.102.102.102.33.33.33.1"><minus id="A1.E18.m1.102.102.102.33.33.33.1.1.cmml" xref="A1.E18.m1.102.102.102.33.33.33.1.1"></minus><ci id="A1.E18.m1.102.102.102.33.33.33.1.2.cmml" xref="A1.E18.m1.102.102.102.33.33.33.1.2">𝐻</ci><cn id="A1.E18.m1.102.102.102.33.33.33.1.3.cmml" type="integer" xref="A1.E18.m1.102.102.102.33.33.33.1.3">1</cn></apply></apply><apply id="A1.E18.m1.320.320.1.1.1.3.1.1.2.1.1.1.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><times id="A1.E18.m1.320.320.1.1.1.3.1.1.2.1.1.1.1.2.cmml" xref="A1.E18.m1.1.1.1.1.1.1"></times><apply id="A1.E18.m1.320.320.1.1.1.3.1.1.2.1.1.1.1.3.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E18.m1.320.320.1.1.1.3.1.1.2.1.1.1.1.3.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1">superscript</csymbol><ci id="A1.E18.m1.103.103.103.34.34.34.cmml" xref="A1.E18.m1.103.103.103.34.34.34">𝛾</ci><ci id="A1.E18.m1.104.104.104.35.35.35.1.cmml" xref="A1.E18.m1.104.104.104.35.35.35.1">ℎ</ci></apply><apply id="A1.E18.m1.320.320.1.1.1.3.1.1.2.1.1.1.1.1.1.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><minus id="A1.E18.m1.114.114.114.45.45.45.cmml" xref="A1.E18.m1.114.114.114.45.45.45"></minus><apply id="A1.E18.m1.320.320.1.1.1.3.1.1.2.1.1.1.1.1.1.1.2.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><times id="A1.E18.m1.320.320.1.1.1.3.1.1.2.1.1.1.1.1.1.1.2.3.cmml" xref="A1.E18.m1.1.1.1.1.1.1"></times><ci id="A1.E18.m1.106.106.106.37.37.37.cmml" xref="A1.E18.m1.106.106.106.37.37.37">𝑅</ci><interval closure="open" id="A1.E18.m1.320.320.1.1.1.3.1.1.2.1.1.1.1.1.1.1.2.2.3.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><apply id="A1.E18.m1.320.320.1.1.1.3.1.1.2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E18.m1.320.320.1.1.1.3.1.1.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.E18.m1.108.108.108.39.39.39.cmml" xref="A1.E18.m1.108.108.108.39.39.39">𝑠</ci><ci id="A1.E18.m1.109.109.109.40.40.40.1.cmml" xref="A1.E18.m1.109.109.109.40.40.40.1">ℎ</ci></apply><apply id="A1.E18.m1.320.320.1.1.1.3.1.1.2.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E18.m1.320.320.1.1.1.3.1.1.2.1.1.1.1.1.1.1.2.2.2.2.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.E18.m1.111.111.111.42.42.42.cmml" xref="A1.E18.m1.111.111.111.42.42.42">𝑎</ci><ci id="A1.E18.m1.112.112.112.43.43.43.1.cmml" xref="A1.E18.m1.112.112.112.43.43.43.1">ℎ</ci></apply></interval></apply><apply id="A1.E18.m1.320.320.1.1.1.3.1.1.2.1.1.1.1.1.1.1.4.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><times id="A1.E18.m1.320.320.1.1.1.3.1.1.2.1.1.1.1.1.1.1.4.3.cmml" xref="A1.E18.m1.1.1.1.1.1.1"></times><ci id="A1.E18.m1.115.115.115.46.46.46.cmml" xref="A1.E18.m1.115.115.115.46.46.46">𝑅</ci><interval closure="open" id="A1.E18.m1.320.320.1.1.1.3.1.1.2.1.1.1.1.1.1.1.4.2.3.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><apply id="A1.E18.m1.320.320.1.1.1.3.1.1.2.1.1.1.1.1.1.1.3.1.1.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><times id="A1.E18.m1.320.320.1.1.1.3.1.1.2.1.1.1.1.1.1.1.3.1.1.1.2.cmml" xref="A1.E18.m1.1.1.1.1.1.1"></times><ci id="A1.E18.m1.117.117.117.48.48.48.cmml" xref="A1.E18.m1.117.117.117.48.48.48">italic-ϕ</ci><apply id="A1.E18.m1.320.320.1.1.1.3.1.1.2.1.1.1.1.1.1.1.3.1.1.1.1.1.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E18.m1.320.320.1.1.1.3.1.1.2.1.1.1.1.1.1.1.3.1.1.1.1.1.1.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.E18.m1.119.119.119.50.50.50.cmml" xref="A1.E18.m1.119.119.119.50.50.50">𝑠</ci><ci id="A1.E18.m1.120.120.120.51.51.51.1.cmml" xref="A1.E18.m1.120.120.120.51.51.51.1">ℎ</ci></apply></apply><apply id="A1.E18.m1.320.320.1.1.1.3.1.1.2.1.1.1.1.1.1.1.4.2.2.2.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E18.m1.320.320.1.1.1.3.1.1.2.1.1.1.1.1.1.1.4.2.2.2.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.E18.m1.123.123.123.54.54.54.cmml" xref="A1.E18.m1.123.123.123.54.54.54">𝑎</ci><ci id="A1.E18.m1.124.124.124.55.55.55.1.cmml" xref="A1.E18.m1.124.124.124.55.55.55.1">ℎ</ci></apply></interval></apply></apply></apply></apply></apply></apply></apply></apply></apply><apply id="A1.E18.m1.320.320.1.1.1e.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><leq id="A1.E18.m1.129.129.129.1.1.1.cmml" xref="A1.E18.m1.129.129.129.1.1.1"></leq><share href="https://arxiv.org/html/2410.04553v1#A1.E18.m1.320.320.1.1.1.3.cmml" id="A1.E18.m1.320.320.1.1.1f.cmml" xref="A1.E18.m1.1.1.1.1.1.1"></share><apply id="A1.E18.m1.320.320.1.1.1.5.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><plus id="A1.E18.m1.156.156.156.28.28.28.cmml" xref="A1.E18.m1.156.156.156.28.28.28"></plus><apply id="A1.E18.m1.320.320.1.1.1.4.1.2.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><abs id="A1.E18.m1.320.320.1.1.1.4.1.2.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1"></abs><apply id="A1.E18.m1.320.320.1.1.1.4.1.1.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><times id="A1.E18.m1.320.320.1.1.1.4.1.1.1.2.cmml" xref="A1.E18.m1.1.1.1.1.1.1"></times><apply id="A1.E18.m1.320.320.1.1.1.4.1.1.1.3.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E18.m1.320.320.1.1.1.4.1.1.1.3.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.E18.m1.131.131.131.3.3.3.cmml" xref="A1.E18.m1.131.131.131.3.3.3">𝔼</ci><ci id="A1.E18.m1.132.132.132.4.4.4.1.cmml" xref="A1.E18.m1.132.132.132.4.4.4.1">𝜏</ci></apply><apply id="A1.E18.m1.320.320.1.1.1.4.1.1.1.1.2.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><csymbol cd="latexml" id="A1.E18.m1.320.320.1.1.1.4.1.1.1.1.2.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1">delimited-[]</csymbol><apply id="A1.E18.m1.320.320.1.1.1.4.1.1.1.1.1.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><times id="A1.E18.m1.320.320.1.1.1.4.1.1.1.1.1.1.2.cmml" xref="A1.E18.m1.1.1.1.1.1.1"></times><apply id="A1.E18.m1.320.320.1.1.1.4.1.1.1.1.1.1.3.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E18.m1.320.320.1.1.1.4.1.1.1.1.1.1.3.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1">superscript</csymbol><ci id="A1.E18.m1.134.134.134.6.6.6.cmml" xref="A1.E18.m1.134.134.134.6.6.6">𝛾</ci><ci id="A1.E18.m1.135.135.135.7.7.7.1.cmml" xref="A1.E18.m1.135.135.135.7.7.7.1">𝐻</ci></apply><apply id="A1.E18.m1.320.320.1.1.1.4.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><minus id="A1.E18.m1.143.143.143.15.15.15.cmml" xref="A1.E18.m1.143.143.143.15.15.15"></minus><apply id="A1.E18.m1.320.320.1.1.1.4.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><times id="A1.E18.m1.320.320.1.1.1.4.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E18.m1.1.1.1.1.1.1"></times><apply id="A1.E18.m1.320.320.1.1.1.4.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E18.m1.320.320.1.1.1.4.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1">superscript</csymbol><ci id="A1.E18.m1.137.137.137.9.9.9.cmml" xref="A1.E18.m1.137.137.137.9.9.9">𝑉</ci><times id="A1.E18.m1.138.138.138.10.10.10.1.cmml" xref="A1.E18.m1.138.138.138.10.10.10.1"></times></apply><apply id="A1.E18.m1.320.320.1.1.1.4.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E18.m1.320.320.1.1.1.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.E18.m1.140.140.140.12.12.12.cmml" xref="A1.E18.m1.140.140.140.12.12.12">𝑠</ci><ci id="A1.E18.m1.141.141.141.13.13.13.1.cmml" xref="A1.E18.m1.141.141.141.13.13.13.1">𝐻</ci></apply></apply><apply id="A1.E18.m1.320.320.1.1.1.4.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><times id="A1.E18.m1.320.320.1.1.1.4.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="A1.E18.m1.1.1.1.1.1.1"></times><apply id="A1.E18.m1.320.320.1.1.1.4.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E18.m1.320.320.1.1.1.4.1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1">superscript</csymbol><ci id="A1.E18.m1.144.144.144.16.16.16.cmml" xref="A1.E18.m1.144.144.144.16.16.16">𝑉</ci><times id="A1.E18.m1.145.145.145.17.17.17.1.cmml" xref="A1.E18.m1.145.145.145.17.17.17.1"></times></apply><apply id="A1.E18.m1.320.320.1.1.1.4.1.1.1.1.1.1.1.1.1.2.1.1.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><times id="A1.E18.m1.320.320.1.1.1.4.1.1.1.1.1.1.1.1.1.2.1.1.1.2.cmml" xref="A1.E18.m1.1.1.1.1.1.1"></times><ci id="A1.E18.m1.147.147.147.19.19.19.cmml" xref="A1.E18.m1.147.147.147.19.19.19">italic-ϕ</ci><apply id="A1.E18.m1.320.320.1.1.1.4.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E18.m1.320.320.1.1.1.4.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.E18.m1.149.149.149.21.21.21.cmml" xref="A1.E18.m1.149.149.149.21.21.21">𝑠</ci><ci id="A1.E18.m1.150.150.150.22.22.22.1.cmml" xref="A1.E18.m1.150.150.150.22.22.22.1">𝐻</ci></apply></apply></apply></apply></apply></apply></apply></apply><apply id="A1.E18.m1.320.320.1.1.1.5.2.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><times id="A1.E18.m1.320.320.1.1.1.5.2.2.cmml" xref="A1.E18.m1.1.1.1.1.1.1"></times><apply id="A1.E18.m1.320.320.1.1.1.5.2.1.2.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><abs id="A1.E18.m1.320.320.1.1.1.5.2.1.2.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1"></abs><apply id="A1.E18.m1.320.320.1.1.1.5.2.1.1.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><times id="A1.E18.m1.320.320.1.1.1.5.2.1.1.1.2.cmml" xref="A1.E18.m1.1.1.1.1.1.1"></times><apply id="A1.E18.m1.320.320.1.1.1.5.2.1.1.1.3.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E18.m1.320.320.1.1.1.5.2.1.1.1.3.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.E18.m1.158.158.158.30.30.30.cmml" xref="A1.E18.m1.158.158.158.30.30.30">𝔼</ci><ci id="A1.E18.m1.159.159.159.31.31.31.1.cmml" xref="A1.E18.m1.159.159.159.31.31.31.1">𝜏</ci></apply><apply id="A1.E18.m1.320.320.1.1.1.5.2.1.1.1.1.2.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><csymbol cd="latexml" id="A1.E18.m1.320.320.1.1.1.5.2.1.1.1.1.2.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1">delimited-[]</csymbol><apply id="A1.E18.m1.320.320.1.1.1.5.2.1.1.1.1.1.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><apply id="A1.E18.m1.320.320.1.1.1.5.2.1.1.1.1.1.1.2.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E18.m1.320.320.1.1.1.5.2.1.1.1.1.1.1.2.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1">superscript</csymbol><apply id="A1.E18.m1.320.320.1.1.1.5.2.1.1.1.1.1.1.2.2.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E18.m1.320.320.1.1.1.5.2.1.1.1.1.1.1.2.2.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1">subscript</csymbol><sum id="A1.E18.m1.161.161.161.33.33.33.cmml" xref="A1.E18.m1.161.161.161.33.33.33"></sum><apply id="A1.E18.m1.162.162.162.34.34.34.1.cmml" xref="A1.E18.m1.162.162.162.34.34.34.1"><eq id="A1.E18.m1.162.162.162.34.34.34.1.1.cmml" xref="A1.E18.m1.162.162.162.34.34.34.1.1"></eq><ci id="A1.E18.m1.162.162.162.34.34.34.1.2.cmml" xref="A1.E18.m1.162.162.162.34.34.34.1.2">ℎ</ci><cn id="A1.E18.m1.162.162.162.34.34.34.1.3.cmml" type="integer" xref="A1.E18.m1.162.162.162.34.34.34.1.3">0</cn></apply></apply><apply id="A1.E18.m1.163.163.163.35.35.35.1.cmml" xref="A1.E18.m1.163.163.163.35.35.35.1"><minus id="A1.E18.m1.163.163.163.35.35.35.1.1.cmml" xref="A1.E18.m1.163.163.163.35.35.35.1.1"></minus><ci id="A1.E18.m1.163.163.163.35.35.35.1.2.cmml" xref="A1.E18.m1.163.163.163.35.35.35.1.2">𝐻</ci><cn id="A1.E18.m1.163.163.163.35.35.35.1.3.cmml" type="integer" xref="A1.E18.m1.163.163.163.35.35.35.1.3">1</cn></apply></apply><apply id="A1.E18.m1.320.320.1.1.1.5.2.1.1.1.1.1.1.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><times id="A1.E18.m1.320.320.1.1.1.5.2.1.1.1.1.1.1.1.2.cmml" xref="A1.E18.m1.1.1.1.1.1.1"></times><apply id="A1.E18.m1.320.320.1.1.1.5.2.1.1.1.1.1.1.1.3.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E18.m1.320.320.1.1.1.5.2.1.1.1.1.1.1.1.3.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1">superscript</csymbol><ci id="A1.E18.m1.164.164.164.36.36.36.cmml" xref="A1.E18.m1.164.164.164.36.36.36">𝛾</ci><ci id="A1.E18.m1.165.165.165.37.37.37.1.cmml" xref="A1.E18.m1.165.165.165.37.37.37.1">ℎ</ci></apply><apply id="A1.E18.m1.320.320.1.1.1.5.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><minus id="A1.E18.m1.175.175.175.47.47.47.cmml" xref="A1.E18.m1.175.175.175.47.47.47"></minus><apply id="A1.E18.m1.320.320.1.1.1.5.2.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><times id="A1.E18.m1.320.320.1.1.1.5.2.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="A1.E18.m1.1.1.1.1.1.1"></times><ci id="A1.E18.m1.167.167.167.39.39.39.cmml" xref="A1.E18.m1.167.167.167.39.39.39">𝑅</ci><interval closure="open" id="A1.E18.m1.320.320.1.1.1.5.2.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><apply id="A1.E18.m1.320.320.1.1.1.5.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E18.m1.320.320.1.1.1.5.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.E18.m1.169.169.169.41.41.41.cmml" xref="A1.E18.m1.169.169.169.41.41.41">𝑠</ci><ci id="A1.E18.m1.170.170.170.42.42.42.1.cmml" xref="A1.E18.m1.170.170.170.42.42.42.1">ℎ</ci></apply><apply id="A1.E18.m1.320.320.1.1.1.5.2.1.1.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E18.m1.320.320.1.1.1.5.2.1.1.1.1.1.1.1.1.1.1.2.2.2.2.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.E18.m1.172.172.172.44.44.44.cmml" xref="A1.E18.m1.172.172.172.44.44.44">𝑎</ci><ci id="A1.E18.m1.173.173.173.45.45.45.1.cmml" xref="A1.E18.m1.173.173.173.45.45.45.1">ℎ</ci></apply></interval></apply><apply id="A1.E18.m1.320.320.1.1.1.5.2.1.1.1.1.1.1.1.1.1.1.4.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><times id="A1.E18.m1.320.320.1.1.1.5.2.1.1.1.1.1.1.1.1.1.1.4.3.cmml" xref="A1.E18.m1.1.1.1.1.1.1"></times><ci id="A1.E18.m1.176.176.176.48.48.48.cmml" xref="A1.E18.m1.176.176.176.48.48.48">𝑅</ci><interval closure="open" id="A1.E18.m1.320.320.1.1.1.5.2.1.1.1.1.1.1.1.1.1.1.4.2.3.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><apply id="A1.E18.m1.320.320.1.1.1.5.2.1.1.1.1.1.1.1.1.1.1.3.1.1.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><times id="A1.E18.m1.320.320.1.1.1.5.2.1.1.1.1.1.1.1.1.1.1.3.1.1.1.2.cmml" xref="A1.E18.m1.1.1.1.1.1.1"></times><ci id="A1.E18.m1.178.178.178.50.50.50.cmml" xref="A1.E18.m1.178.178.178.50.50.50">italic-ϕ</ci><apply id="A1.E18.m1.320.320.1.1.1.5.2.1.1.1.1.1.1.1.1.1.1.3.1.1.1.1.1.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E18.m1.320.320.1.1.1.5.2.1.1.1.1.1.1.1.1.1.1.3.1.1.1.1.1.1.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.E18.m1.180.180.180.52.52.52.cmml" xref="A1.E18.m1.180.180.180.52.52.52">𝑠</ci><ci id="A1.E18.m1.181.181.181.53.53.53.1.cmml" xref="A1.E18.m1.181.181.181.53.53.53.1">ℎ</ci></apply></apply><apply id="A1.E18.m1.320.320.1.1.1.5.2.1.1.1.1.1.1.1.1.1.1.4.2.2.2.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E18.m1.320.320.1.1.1.5.2.1.1.1.1.1.1.1.1.1.1.4.2.2.2.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.E18.m1.184.184.184.56.56.56.cmml" xref="A1.E18.m1.184.184.184.56.56.56">𝑎</ci><ci id="A1.E18.m1.185.185.185.57.57.57.1.cmml" xref="A1.E18.m1.185.185.185.57.57.57.1">ℎ</ci></apply></interval></apply></apply></apply></apply></apply></apply></apply><ci id="A1.E18.m1.190.190.190.1.1.1a.cmml" xref="A1.E18.m1.190.190.190.1.1.1"><mtext id="A1.E18.m1.190.190.190.1.1.1.cmml" xref="A1.E18.m1.190.190.190.1.1.1">(Triangle inequality)</mtext></ci></apply></apply></apply><apply id="A1.E18.m1.320.320.1.1.1g.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><leq id="A1.E18.m1.191.191.191.1.1.1.cmml" xref="A1.E18.m1.191.191.191.1.1.1"></leq><share href="https://arxiv.org/html/2410.04553v1#A1.E18.m1.320.320.1.1.1.5.cmml" id="A1.E18.m1.320.320.1.1.1h.cmml" xref="A1.E18.m1.1.1.1.1.1.1"></share><apply id="A1.E18.m1.320.320.1.1.1.7.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><plus id="A1.E18.m1.216.216.216.26.26.26.cmml" xref="A1.E18.m1.216.216.216.26.26.26"></plus><apply id="A1.E18.m1.320.320.1.1.1.6.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><times id="A1.E18.m1.320.320.1.1.1.6.1.2.cmml" xref="A1.E18.m1.1.1.1.1.1.1"></times><apply id="A1.E18.m1.320.320.1.1.1.6.1.3.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E18.m1.320.320.1.1.1.6.1.3.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.E18.m1.192.192.192.2.2.2.cmml" xref="A1.E18.m1.192.192.192.2.2.2">𝔼</ci><ci id="A1.E18.m1.193.193.193.3.3.3.1.cmml" xref="A1.E18.m1.193.193.193.3.3.3.1">𝜏</ci></apply><apply id="A1.E18.m1.320.320.1.1.1.6.1.1.2.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><csymbol cd="latexml" id="A1.E18.m1.320.320.1.1.1.6.1.1.2.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1">delimited-[]</csymbol><apply id="A1.E18.m1.320.320.1.1.1.6.1.1.1.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><times id="A1.E18.m1.320.320.1.1.1.6.1.1.1.1.2.cmml" xref="A1.E18.m1.1.1.1.1.1.1"></times><apply id="A1.E18.m1.320.320.1.1.1.6.1.1.1.1.3.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E18.m1.320.320.1.1.1.6.1.1.1.1.3.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1">superscript</csymbol><ci id="A1.E18.m1.195.195.195.5.5.5.cmml" xref="A1.E18.m1.195.195.195.5.5.5">𝛾</ci><ci id="A1.E18.m1.196.196.196.6.6.6.1.cmml" xref="A1.E18.m1.196.196.196.6.6.6.1">𝐻</ci></apply><apply id="A1.E18.m1.320.320.1.1.1.6.1.1.1.1.1.2.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><abs id="A1.E18.m1.320.320.1.1.1.6.1.1.1.1.1.2.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1"></abs><apply id="A1.E18.m1.320.320.1.1.1.6.1.1.1.1.1.1.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><minus id="A1.E18.m1.204.204.204.14.14.14.cmml" xref="A1.E18.m1.204.204.204.14.14.14"></minus><apply id="A1.E18.m1.320.320.1.1.1.6.1.1.1.1.1.1.1.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><times id="A1.E18.m1.320.320.1.1.1.6.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E18.m1.1.1.1.1.1.1"></times><apply id="A1.E18.m1.320.320.1.1.1.6.1.1.1.1.1.1.1.1.3.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E18.m1.320.320.1.1.1.6.1.1.1.1.1.1.1.1.3.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1">superscript</csymbol><ci id="A1.E18.m1.198.198.198.8.8.8.cmml" xref="A1.E18.m1.198.198.198.8.8.8">𝑉</ci><times id="A1.E18.m1.199.199.199.9.9.9.1.cmml" xref="A1.E18.m1.199.199.199.9.9.9.1"></times></apply><apply id="A1.E18.m1.320.320.1.1.1.6.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E18.m1.320.320.1.1.1.6.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.E18.m1.201.201.201.11.11.11.cmml" xref="A1.E18.m1.201.201.201.11.11.11">𝑠</ci><ci id="A1.E18.m1.202.202.202.12.12.12.1.cmml" xref="A1.E18.m1.202.202.202.12.12.12.1">𝐻</ci></apply></apply><apply id="A1.E18.m1.320.320.1.1.1.6.1.1.1.1.1.1.1.2.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><times id="A1.E18.m1.320.320.1.1.1.6.1.1.1.1.1.1.1.2.2.cmml" xref="A1.E18.m1.1.1.1.1.1.1"></times><apply id="A1.E18.m1.320.320.1.1.1.6.1.1.1.1.1.1.1.2.3.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E18.m1.320.320.1.1.1.6.1.1.1.1.1.1.1.2.3.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1">superscript</csymbol><ci id="A1.E18.m1.205.205.205.15.15.15.cmml" xref="A1.E18.m1.205.205.205.15.15.15">𝑉</ci><times id="A1.E18.m1.206.206.206.16.16.16.1.cmml" xref="A1.E18.m1.206.206.206.16.16.16.1"></times></apply><apply id="A1.E18.m1.320.320.1.1.1.6.1.1.1.1.1.1.1.2.1.1.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><times id="A1.E18.m1.320.320.1.1.1.6.1.1.1.1.1.1.1.2.1.1.1.2.cmml" xref="A1.E18.m1.1.1.1.1.1.1"></times><ci id="A1.E18.m1.208.208.208.18.18.18.cmml" xref="A1.E18.m1.208.208.208.18.18.18">italic-ϕ</ci><apply id="A1.E18.m1.320.320.1.1.1.6.1.1.1.1.1.1.1.2.1.1.1.1.1.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E18.m1.320.320.1.1.1.6.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.E18.m1.210.210.210.20.20.20.cmml" xref="A1.E18.m1.210.210.210.20.20.20">𝑠</ci><ci id="A1.E18.m1.211.211.211.21.21.21.1.cmml" xref="A1.E18.m1.211.211.211.21.21.21.1">𝐻</ci></apply></apply></apply></apply></apply></apply></apply></apply><apply id="A1.E18.m1.320.320.1.1.1.7.2.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><times id="A1.E18.m1.320.320.1.1.1.7.2.2.cmml" xref="A1.E18.m1.1.1.1.1.1.1"></times><apply id="A1.E18.m1.320.320.1.1.1.7.2.3.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E18.m1.320.320.1.1.1.7.2.3.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.E18.m1.217.217.217.27.27.27.cmml" xref="A1.E18.m1.217.217.217.27.27.27">𝔼</ci><ci id="A1.E18.m1.218.218.218.28.28.28.1.cmml" xref="A1.E18.m1.218.218.218.28.28.28.1">𝜏</ci></apply><apply id="A1.E18.m1.320.320.1.1.1.7.2.1.2.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><csymbol cd="latexml" id="A1.E18.m1.320.320.1.1.1.7.2.1.2.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1">delimited-[]</csymbol><apply id="A1.E18.m1.320.320.1.1.1.7.2.1.1.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><apply id="A1.E18.m1.320.320.1.1.1.7.2.1.1.1.2.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E18.m1.320.320.1.1.1.7.2.1.1.1.2.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1">superscript</csymbol><apply id="A1.E18.m1.320.320.1.1.1.7.2.1.1.1.2.2.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E18.m1.320.320.1.1.1.7.2.1.1.1.2.2.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1">subscript</csymbol><sum id="A1.E18.m1.220.220.220.30.30.30.cmml" xref="A1.E18.m1.220.220.220.30.30.30"></sum><apply id="A1.E18.m1.221.221.221.31.31.31.1.cmml" xref="A1.E18.m1.221.221.221.31.31.31.1"><eq id="A1.E18.m1.221.221.221.31.31.31.1.1.cmml" xref="A1.E18.m1.221.221.221.31.31.31.1.1"></eq><ci id="A1.E18.m1.221.221.221.31.31.31.1.2.cmml" xref="A1.E18.m1.221.221.221.31.31.31.1.2">ℎ</ci><cn id="A1.E18.m1.221.221.221.31.31.31.1.3.cmml" type="integer" xref="A1.E18.m1.221.221.221.31.31.31.1.3">0</cn></apply></apply><apply id="A1.E18.m1.222.222.222.32.32.32.1.cmml" xref="A1.E18.m1.222.222.222.32.32.32.1"><minus id="A1.E18.m1.222.222.222.32.32.32.1.1.cmml" xref="A1.E18.m1.222.222.222.32.32.32.1.1"></minus><ci id="A1.E18.m1.222.222.222.32.32.32.1.2.cmml" xref="A1.E18.m1.222.222.222.32.32.32.1.2">𝐻</ci><cn id="A1.E18.m1.222.222.222.32.32.32.1.3.cmml" type="integer" xref="A1.E18.m1.222.222.222.32.32.32.1.3">1</cn></apply></apply><apply id="A1.E18.m1.320.320.1.1.1.7.2.1.1.1.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><times id="A1.E18.m1.320.320.1.1.1.7.2.1.1.1.1.2.cmml" xref="A1.E18.m1.1.1.1.1.1.1"></times><apply id="A1.E18.m1.320.320.1.1.1.7.2.1.1.1.1.3.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E18.m1.320.320.1.1.1.7.2.1.1.1.1.3.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1">superscript</csymbol><ci id="A1.E18.m1.223.223.223.33.33.33.cmml" xref="A1.E18.m1.223.223.223.33.33.33">𝛾</ci><ci id="A1.E18.m1.224.224.224.34.34.34.1.cmml" xref="A1.E18.m1.224.224.224.34.34.34.1">ℎ</ci></apply><apply id="A1.E18.m1.320.320.1.1.1.7.2.1.1.1.1.1.2.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><abs id="A1.E18.m1.320.320.1.1.1.7.2.1.1.1.1.1.2.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1"></abs><apply id="A1.E18.m1.320.320.1.1.1.7.2.1.1.1.1.1.1.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><minus id="A1.E18.m1.234.234.234.44.44.44.cmml" xref="A1.E18.m1.234.234.234.44.44.44"></minus><apply id="A1.E18.m1.320.320.1.1.1.7.2.1.1.1.1.1.1.1.2.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><times id="A1.E18.m1.320.320.1.1.1.7.2.1.1.1.1.1.1.1.2.3.cmml" xref="A1.E18.m1.1.1.1.1.1.1"></times><ci id="A1.E18.m1.226.226.226.36.36.36.cmml" xref="A1.E18.m1.226.226.226.36.36.36">𝑅</ci><interval closure="open" id="A1.E18.m1.320.320.1.1.1.7.2.1.1.1.1.1.1.1.2.2.3.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><apply id="A1.E18.m1.320.320.1.1.1.7.2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E18.m1.320.320.1.1.1.7.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.E18.m1.228.228.228.38.38.38.cmml" xref="A1.E18.m1.228.228.228.38.38.38">𝑠</ci><ci id="A1.E18.m1.229.229.229.39.39.39.1.cmml" xref="A1.E18.m1.229.229.229.39.39.39.1">ℎ</ci></apply><apply id="A1.E18.m1.320.320.1.1.1.7.2.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E18.m1.320.320.1.1.1.7.2.1.1.1.1.1.1.1.2.2.2.2.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.E18.m1.231.231.231.41.41.41.cmml" xref="A1.E18.m1.231.231.231.41.41.41">𝑎</ci><ci id="A1.E18.m1.232.232.232.42.42.42.1.cmml" xref="A1.E18.m1.232.232.232.42.42.42.1">ℎ</ci></apply></interval></apply><apply id="A1.E18.m1.320.320.1.1.1.7.2.1.1.1.1.1.1.1.4.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><times id="A1.E18.m1.320.320.1.1.1.7.2.1.1.1.1.1.1.1.4.3.cmml" xref="A1.E18.m1.1.1.1.1.1.1"></times><ci id="A1.E18.m1.235.235.235.45.45.45.cmml" xref="A1.E18.m1.235.235.235.45.45.45">𝑅</ci><interval closure="open" id="A1.E18.m1.320.320.1.1.1.7.2.1.1.1.1.1.1.1.4.2.3.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><apply id="A1.E18.m1.320.320.1.1.1.7.2.1.1.1.1.1.1.1.3.1.1.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><times id="A1.E18.m1.320.320.1.1.1.7.2.1.1.1.1.1.1.1.3.1.1.1.2.cmml" xref="A1.E18.m1.1.1.1.1.1.1"></times><ci id="A1.E18.m1.237.237.237.47.47.47.cmml" xref="A1.E18.m1.237.237.237.47.47.47">italic-ϕ</ci><apply id="A1.E18.m1.320.320.1.1.1.7.2.1.1.1.1.1.1.1.3.1.1.1.1.1.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E18.m1.320.320.1.1.1.7.2.1.1.1.1.1.1.1.3.1.1.1.1.1.1.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.E18.m1.239.239.239.49.49.49.cmml" xref="A1.E18.m1.239.239.239.49.49.49">𝑠</ci><ci id="A1.E18.m1.240.240.240.50.50.50.1.cmml" xref="A1.E18.m1.240.240.240.50.50.50.1">ℎ</ci></apply></apply><apply id="A1.E18.m1.320.320.1.1.1.7.2.1.1.1.1.1.1.1.4.2.2.2.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E18.m1.320.320.1.1.1.7.2.1.1.1.1.1.1.1.4.2.2.2.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.E18.m1.243.243.243.53.53.53.cmml" xref="A1.E18.m1.243.243.243.53.53.53">𝑎</ci><ci id="A1.E18.m1.244.244.244.54.54.54.1.cmml" xref="A1.E18.m1.244.244.244.54.54.54.1">ℎ</ci></apply></interval></apply></apply></apply></apply></apply></apply><ci id="A1.E18.m1.248.248.248.1.1.1a.cmml" xref="A1.E18.m1.248.248.248.1.1.1"><mtext id="A1.E18.m1.248.248.248.1.1.1.cmml" xref="A1.E18.m1.248.248.248.1.1.1">(Jensen’s inequality)</mtext></ci></apply></apply></apply><apply id="A1.E18.m1.320.320.1.1.1i.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><eq id="A1.E18.m1.249.249.249.1.1.1.cmml" xref="A1.E18.m1.249.249.249.1.1.1"></eq><share href="https://arxiv.org/html/2410.04553v1#A1.E18.m1.320.320.1.1.1.7.cmml" id="A1.E18.m1.320.320.1.1.1j.cmml" xref="A1.E18.m1.1.1.1.1.1.1"></share><apply id="A1.E18.m1.320.320.1.1.1.9.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><plus id="A1.E18.m1.274.274.274.26.26.26.cmml" xref="A1.E18.m1.274.274.274.26.26.26"></plus><apply id="A1.E18.m1.320.320.1.1.1.8.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><times id="A1.E18.m1.320.320.1.1.1.8.1.2.cmml" xref="A1.E18.m1.1.1.1.1.1.1"></times><apply id="A1.E18.m1.320.320.1.1.1.8.1.3.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E18.m1.320.320.1.1.1.8.1.3.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1">superscript</csymbol><ci id="A1.E18.m1.250.250.250.2.2.2.cmml" xref="A1.E18.m1.250.250.250.2.2.2">𝛾</ci><ci id="A1.E18.m1.251.251.251.3.3.3.1.cmml" xref="A1.E18.m1.251.251.251.3.3.3.1">𝐻</ci></apply><apply id="A1.E18.m1.320.320.1.1.1.8.1.4.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E18.m1.320.320.1.1.1.8.1.4.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.E18.m1.252.252.252.4.4.4.cmml" xref="A1.E18.m1.252.252.252.4.4.4">𝔼</ci><ci id="A1.E18.m1.253.253.253.5.5.5.1.cmml" xref="A1.E18.m1.253.253.253.5.5.5.1">𝜏</ci></apply><apply id="A1.E18.m1.320.320.1.1.1.8.1.1.2.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><csymbol cd="latexml" id="A1.E18.m1.320.320.1.1.1.8.1.1.2.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1">delimited-[]</csymbol><apply id="A1.E18.m1.320.320.1.1.1.8.1.1.1.1.2.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><abs id="A1.E18.m1.320.320.1.1.1.8.1.1.1.1.2.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1"></abs><apply id="A1.E18.m1.320.320.1.1.1.8.1.1.1.1.1.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><minus id="A1.E18.m1.262.262.262.14.14.14.cmml" xref="A1.E18.m1.262.262.262.14.14.14"></minus><apply id="A1.E18.m1.320.320.1.1.1.8.1.1.1.1.1.1.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><times id="A1.E18.m1.320.320.1.1.1.8.1.1.1.1.1.1.1.2.cmml" xref="A1.E18.m1.1.1.1.1.1.1"></times><apply id="A1.E18.m1.320.320.1.1.1.8.1.1.1.1.1.1.1.3.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E18.m1.320.320.1.1.1.8.1.1.1.1.1.1.1.3.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1">superscript</csymbol><ci id="A1.E18.m1.256.256.256.8.8.8.cmml" xref="A1.E18.m1.256.256.256.8.8.8">𝑉</ci><times id="A1.E18.m1.257.257.257.9.9.9.1.cmml" xref="A1.E18.m1.257.257.257.9.9.9.1"></times></apply><apply id="A1.E18.m1.320.320.1.1.1.8.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E18.m1.320.320.1.1.1.8.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.E18.m1.259.259.259.11.11.11.cmml" xref="A1.E18.m1.259.259.259.11.11.11">𝑠</ci><ci id="A1.E18.m1.260.260.260.12.12.12.1.cmml" xref="A1.E18.m1.260.260.260.12.12.12.1">𝐻</ci></apply></apply><apply id="A1.E18.m1.320.320.1.1.1.8.1.1.1.1.1.1.2.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><times id="A1.E18.m1.320.320.1.1.1.8.1.1.1.1.1.1.2.2.cmml" xref="A1.E18.m1.1.1.1.1.1.1"></times><apply id="A1.E18.m1.320.320.1.1.1.8.1.1.1.1.1.1.2.3.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E18.m1.320.320.1.1.1.8.1.1.1.1.1.1.2.3.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1">superscript</csymbol><ci id="A1.E18.m1.263.263.263.15.15.15.cmml" xref="A1.E18.m1.263.263.263.15.15.15">𝑉</ci><times id="A1.E18.m1.264.264.264.16.16.16.1.cmml" xref="A1.E18.m1.264.264.264.16.16.16.1"></times></apply><apply id="A1.E18.m1.320.320.1.1.1.8.1.1.1.1.1.1.2.1.1.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><times id="A1.E18.m1.320.320.1.1.1.8.1.1.1.1.1.1.2.1.1.1.2.cmml" xref="A1.E18.m1.1.1.1.1.1.1"></times><ci id="A1.E18.m1.266.266.266.18.18.18.cmml" xref="A1.E18.m1.266.266.266.18.18.18">italic-ϕ</ci><apply id="A1.E18.m1.320.320.1.1.1.8.1.1.1.1.1.1.2.1.1.1.1.1.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E18.m1.320.320.1.1.1.8.1.1.1.1.1.1.2.1.1.1.1.1.1.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.E18.m1.268.268.268.20.20.20.cmml" xref="A1.E18.m1.268.268.268.20.20.20">𝑠</ci><ci id="A1.E18.m1.269.269.269.21.21.21.1.cmml" xref="A1.E18.m1.269.269.269.21.21.21.1">𝐻</ci></apply></apply></apply></apply></apply></apply></apply><apply id="A1.E18.m1.320.320.1.1.1.9.2.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><apply id="A1.E18.m1.320.320.1.1.1.9.2.2.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E18.m1.320.320.1.1.1.9.2.2.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1">superscript</csymbol><apply id="A1.E18.m1.320.320.1.1.1.9.2.2.2.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E18.m1.320.320.1.1.1.9.2.2.2.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1">subscript</csymbol><sum id="A1.E18.m1.275.275.275.27.27.27.cmml" xref="A1.E18.m1.275.275.275.27.27.27"></sum><apply id="A1.E18.m1.276.276.276.28.28.28.1.cmml" xref="A1.E18.m1.276.276.276.28.28.28.1"><eq id="A1.E18.m1.276.276.276.28.28.28.1.1.cmml" xref="A1.E18.m1.276.276.276.28.28.28.1.1"></eq><ci id="A1.E18.m1.276.276.276.28.28.28.1.2.cmml" xref="A1.E18.m1.276.276.276.28.28.28.1.2">ℎ</ci><cn id="A1.E18.m1.276.276.276.28.28.28.1.3.cmml" type="integer" xref="A1.E18.m1.276.276.276.28.28.28.1.3">0</cn></apply></apply><apply id="A1.E18.m1.277.277.277.29.29.29.1.cmml" xref="A1.E18.m1.277.277.277.29.29.29.1"><minus id="A1.E18.m1.277.277.277.29.29.29.1.1.cmml" xref="A1.E18.m1.277.277.277.29.29.29.1.1"></minus><ci id="A1.E18.m1.277.277.277.29.29.29.1.2.cmml" xref="A1.E18.m1.277.277.277.29.29.29.1.2">𝐻</ci><cn id="A1.E18.m1.277.277.277.29.29.29.1.3.cmml" type="integer" xref="A1.E18.m1.277.277.277.29.29.29.1.3">1</cn></apply></apply><apply id="A1.E18.m1.320.320.1.1.1.9.2.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><times id="A1.E18.m1.320.320.1.1.1.9.2.1.2.cmml" xref="A1.E18.m1.1.1.1.1.1.1"></times><apply id="A1.E18.m1.320.320.1.1.1.9.2.1.3.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E18.m1.320.320.1.1.1.9.2.1.3.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1">superscript</csymbol><ci id="A1.E18.m1.278.278.278.30.30.30.cmml" xref="A1.E18.m1.278.278.278.30.30.30">𝛾</ci><ci id="A1.E18.m1.279.279.279.31.31.31.1.cmml" xref="A1.E18.m1.279.279.279.31.31.31.1">ℎ</ci></apply><apply id="A1.E18.m1.320.320.1.1.1.9.2.1.4.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E18.m1.320.320.1.1.1.9.2.1.4.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.E18.m1.280.280.280.32.32.32.cmml" xref="A1.E18.m1.280.280.280.32.32.32">𝔼</ci><ci id="A1.E18.m1.281.281.281.33.33.33.1.cmml" xref="A1.E18.m1.281.281.281.33.33.33.1">𝜏</ci></apply><apply id="A1.E18.m1.320.320.1.1.1.9.2.1.1.2.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><csymbol cd="latexml" id="A1.E18.m1.320.320.1.1.1.9.2.1.1.2.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1">delimited-[]</csymbol><apply id="A1.E18.m1.320.320.1.1.1.9.2.1.1.1.1.2.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><abs id="A1.E18.m1.320.320.1.1.1.9.2.1.1.1.1.2.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1"></abs><apply id="A1.E18.m1.320.320.1.1.1.9.2.1.1.1.1.1.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><minus id="A1.E18.m1.292.292.292.44.44.44.cmml" xref="A1.E18.m1.292.292.292.44.44.44"></minus><apply id="A1.E18.m1.320.320.1.1.1.9.2.1.1.1.1.1.1.2.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><times id="A1.E18.m1.320.320.1.1.1.9.2.1.1.1.1.1.1.2.3.cmml" xref="A1.E18.m1.1.1.1.1.1.1"></times><ci id="A1.E18.m1.284.284.284.36.36.36.cmml" xref="A1.E18.m1.284.284.284.36.36.36">𝑅</ci><interval closure="open" id="A1.E18.m1.320.320.1.1.1.9.2.1.1.1.1.1.1.2.2.3.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><apply id="A1.E18.m1.320.320.1.1.1.9.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E18.m1.320.320.1.1.1.9.2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.E18.m1.286.286.286.38.38.38.cmml" xref="A1.E18.m1.286.286.286.38.38.38">𝑠</ci><ci id="A1.E18.m1.287.287.287.39.39.39.1.cmml" xref="A1.E18.m1.287.287.287.39.39.39.1">ℎ</ci></apply><apply id="A1.E18.m1.320.320.1.1.1.9.2.1.1.1.1.1.1.2.2.2.2.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E18.m1.320.320.1.1.1.9.2.1.1.1.1.1.1.2.2.2.2.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.E18.m1.289.289.289.41.41.41.cmml" xref="A1.E18.m1.289.289.289.41.41.41">𝑎</ci><ci id="A1.E18.m1.290.290.290.42.42.42.1.cmml" xref="A1.E18.m1.290.290.290.42.42.42.1">ℎ</ci></apply></interval></apply><apply id="A1.E18.m1.320.320.1.1.1.9.2.1.1.1.1.1.1.4.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><times id="A1.E18.m1.320.320.1.1.1.9.2.1.1.1.1.1.1.4.3.cmml" xref="A1.E18.m1.1.1.1.1.1.1"></times><ci id="A1.E18.m1.293.293.293.45.45.45.cmml" xref="A1.E18.m1.293.293.293.45.45.45">𝑅</ci><interval closure="open" id="A1.E18.m1.320.320.1.1.1.9.2.1.1.1.1.1.1.4.2.3.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><apply id="A1.E18.m1.320.320.1.1.1.9.2.1.1.1.1.1.1.3.1.1.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><times id="A1.E18.m1.320.320.1.1.1.9.2.1.1.1.1.1.1.3.1.1.1.2.cmml" xref="A1.E18.m1.1.1.1.1.1.1"></times><ci id="A1.E18.m1.295.295.295.47.47.47.cmml" xref="A1.E18.m1.295.295.295.47.47.47">italic-ϕ</ci><apply id="A1.E18.m1.320.320.1.1.1.9.2.1.1.1.1.1.1.3.1.1.1.1.1.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E18.m1.320.320.1.1.1.9.2.1.1.1.1.1.1.3.1.1.1.1.1.1.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.E18.m1.297.297.297.49.49.49.cmml" xref="A1.E18.m1.297.297.297.49.49.49">𝑠</ci><ci id="A1.E18.m1.298.298.298.50.50.50.1.cmml" xref="A1.E18.m1.298.298.298.50.50.50.1">ℎ</ci></apply></apply><apply id="A1.E18.m1.320.320.1.1.1.9.2.1.1.1.1.1.1.4.2.2.2.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E18.m1.320.320.1.1.1.9.2.1.1.1.1.1.1.4.2.2.2.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.E18.m1.301.301.301.53.53.53.cmml" xref="A1.E18.m1.301.301.301.53.53.53">𝑎</ci><ci id="A1.E18.m1.302.302.302.54.54.54.1.cmml" xref="A1.E18.m1.302.302.302.54.54.54.1">ℎ</ci></apply></interval></apply></apply></apply></apply></apply></apply></apply></apply><apply id="A1.E18.m1.320.320.1.1.1k.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><leq id="A1.E18.m1.306.306.306.1.1.1.cmml" xref="A1.E18.m1.306.306.306.1.1.1"></leq><share href="https://arxiv.org/html/2410.04553v1#A1.E18.m1.320.320.1.1.1.9.cmml" id="A1.E18.m1.320.320.1.1.1l.cmml" xref="A1.E18.m1.1.1.1.1.1.1"></share><apply id="A1.E18.m1.320.320.1.1.1.17.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><plus id="A1.E18.m1.308.308.308.3.3.3.cmml" xref="A1.E18.m1.308.308.308.3.3.3"></plus><apply id="A1.E18.m1.307.307.307.2.2.2.cmml" xref="A1.E18.m1.307.307.307.2.2.2"><divide id="A1.E18.m1.307.307.307.2.2.2.4.cmml" xref="A1.E18.m1.307.307.307.2.2.2"></divide><apply id="A1.E18.m1.307.307.307.2.2.2.1.cmml" xref="A1.E18.m1.307.307.307.2.2.2.1"><times id="A1.E18.m1.307.307.307.2.2.2.1.2.cmml" xref="A1.E18.m1.307.307.307.2.2.2.1.2"></times><cn id="A1.E18.m1.307.307.307.2.2.2.1.3.cmml" type="integer" xref="A1.E18.m1.307.307.307.2.2.2.1.3">2</cn><apply id="A1.E18.m1.307.307.307.2.2.2.1.4.cmml" xref="A1.E18.m1.307.307.307.2.2.2.1.4"><csymbol cd="ambiguous" id="A1.E18.m1.307.307.307.2.2.2.1.4.1.cmml" xref="A1.E18.m1.307.307.307.2.2.2.1.4">superscript</csymbol><ci id="A1.E18.m1.307.307.307.2.2.2.1.4.2.cmml" xref="A1.E18.m1.307.307.307.2.2.2.1.4.2">𝛾</ci><ci id="A1.E18.m1.307.307.307.2.2.2.1.4.3.cmml" xref="A1.E18.m1.307.307.307.2.2.2.1.4.3">𝐻</ci></apply><apply id="A1.E18.m1.307.307.307.2.2.2.1.1.1.1.cmml" xref="A1.E18.m1.307.307.307.2.2.2.1.1.1"><plus id="A1.E18.m1.307.307.307.2.2.2.1.1.1.1.1.cmml" xref="A1.E18.m1.307.307.307.2.2.2.1.1.1.1.1"></plus><ci id="A1.E18.m1.307.307.307.2.2.2.1.1.1.1.2.cmml" xref="A1.E18.m1.307.307.307.2.2.2.1.1.1.1.2">italic-ϵ</ci><ci id="A1.E18.m1.307.307.307.2.2.2.1.1.1.1.3.cmml" xref="A1.E18.m1.307.307.307.2.2.2.1.1.1.1.3">ℒ</ci></apply></apply><apply id="A1.E18.m1.307.307.307.2.2.2.3.cmml" xref="A1.E18.m1.307.307.307.2.2.2.3"><times id="A1.E18.m1.307.307.307.2.2.2.3.3.cmml" xref="A1.E18.m1.307.307.307.2.2.2.3.3"></times><apply id="A1.E18.m1.307.307.307.2.2.2.2.1.1.1.cmml" xref="A1.E18.m1.307.307.307.2.2.2.2.1.1"><minus id="A1.E18.m1.307.307.307.2.2.2.2.1.1.1.1.cmml" xref="A1.E18.m1.307.307.307.2.2.2.2.1.1.1.1"></minus><cn id="A1.E18.m1.307.307.307.2.2.2.2.1.1.1.2.cmml" type="integer" xref="A1.E18.m1.307.307.307.2.2.2.2.1.1.1.2">1</cn><ci id="A1.E18.m1.307.307.307.2.2.2.2.1.1.1.3.cmml" xref="A1.E18.m1.307.307.307.2.2.2.2.1.1.1.3">𝛾</ci></apply><apply id="A1.E18.m1.307.307.307.2.2.2.3.2.1.1.cmml" xref="A1.E18.m1.307.307.307.2.2.2.3.2.1"><minus id="A1.E18.m1.307.307.307.2.2.2.3.2.1.1.1.cmml" xref="A1.E18.m1.307.307.307.2.2.2.3.2.1.1.1"></minus><cn id="A1.E18.m1.307.307.307.2.2.2.3.2.1.1.2.cmml" type="integer" xref="A1.E18.m1.307.307.307.2.2.2.3.2.1.1.2">1</cn><ci id="A1.E18.m1.307.307.307.2.2.2.3.2.1.1.3.cmml" xref="A1.E18.m1.307.307.307.2.2.2.3.2.1.1.3">𝑐</ci></apply></apply></apply><apply id="A1.E18.m1.320.320.1.1.1.17.3.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><times id="A1.E18.m1.320.320.1.1.1.17.3.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1"></times><apply id="A1.E18.m1.309.309.309.4.4.4.cmml" xref="A1.E18.m1.309.309.309.4.4.4"><divide id="A1.E18.m1.309.309.309.4.4.4.1.cmml" xref="A1.E18.m1.309.309.309.4.4.4"></divide><apply id="A1.E18.m1.309.309.309.4.4.4.2.cmml" xref="A1.E18.m1.309.309.309.4.4.4.2"><times id="A1.E18.m1.309.309.309.4.4.4.2.1.cmml" xref="A1.E18.m1.309.309.309.4.4.4.2.1"></times><cn id="A1.E18.m1.309.309.309.4.4.4.2.2.cmml" type="integer" xref="A1.E18.m1.309.309.309.4.4.4.2.2">2</cn><ci id="A1.E18.m1.309.309.309.4.4.4.2.3.cmml" xref="A1.E18.m1.309.309.309.4.4.4.2.3">italic-ϵ</ci></apply><apply id="A1.E18.m1.309.309.309.4.4.4.3.cmml" xref="A1.E18.m1.309.309.309.4.4.4.3"><minus id="A1.E18.m1.309.309.309.4.4.4.3.1.cmml" xref="A1.E18.m1.309.309.309.4.4.4.3.1"></minus><cn id="A1.E18.m1.309.309.309.4.4.4.3.2.cmml" type="integer" xref="A1.E18.m1.309.309.309.4.4.4.3.2">1</cn><ci id="A1.E18.m1.309.309.309.4.4.4.3.3.cmml" xref="A1.E18.m1.309.309.309.4.4.4.3.3">𝑐</ci></apply></apply><apply id="A1.E18.m1.320.320.1.1.1.17.3.3.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><apply id="A1.E18.m1.320.320.1.1.1.17.3.3.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E18.m1.320.320.1.1.1.17.3.3.1.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1">superscript</csymbol><apply id="A1.E18.m1.320.320.1.1.1.17.3.3.1.2.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E18.m1.320.320.1.1.1.17.3.3.1.2.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1">subscript</csymbol><sum id="A1.E18.m1.310.310.310.5.5.5.cmml" xref="A1.E18.m1.310.310.310.5.5.5"></sum><apply id="A1.E18.m1.311.311.311.6.6.6.1.cmml" xref="A1.E18.m1.311.311.311.6.6.6.1"><eq id="A1.E18.m1.311.311.311.6.6.6.1.1.cmml" xref="A1.E18.m1.311.311.311.6.6.6.1.1"></eq><ci id="A1.E18.m1.311.311.311.6.6.6.1.2.cmml" xref="A1.E18.m1.311.311.311.6.6.6.1.2">ℎ</ci><cn id="A1.E18.m1.311.311.311.6.6.6.1.3.cmml" type="integer" xref="A1.E18.m1.311.311.311.6.6.6.1.3">0</cn></apply></apply><apply id="A1.E18.m1.312.312.312.7.7.7.1.cmml" xref="A1.E18.m1.312.312.312.7.7.7.1"><minus id="A1.E18.m1.312.312.312.7.7.7.1.1.cmml" xref="A1.E18.m1.312.312.312.7.7.7.1.1"></minus><ci id="A1.E18.m1.312.312.312.7.7.7.1.2.cmml" xref="A1.E18.m1.312.312.312.7.7.7.1.2">𝐻</ci><cn id="A1.E18.m1.312.312.312.7.7.7.1.3.cmml" type="integer" xref="A1.E18.m1.312.312.312.7.7.7.1.3">1</cn></apply></apply><apply id="A1.E18.m1.320.320.1.1.1.17.3.3.2.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E18.m1.320.320.1.1.1.17.3.3.2.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1">superscript</csymbol><ci id="A1.E18.m1.313.313.313.8.8.8.cmml" xref="A1.E18.m1.313.313.313.8.8.8">𝛾</ci><ci id="A1.E18.m1.314.314.314.9.9.9.1.cmml" xref="A1.E18.m1.314.314.314.9.9.9.1">ℎ</ci></apply></apply></apply></apply></apply></apply><apply id="A1.E18.m1.321.321.2.2.2.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><leq id="A1.E18.m1.316.316.316.1.1.1.cmml" xref="A1.E18.m1.316.316.316.1.1.1"></leq><ci id="A1.E18.m1.315.315.315.10.10.10j.cmml" xref="A1.E18.m1.315.315.315.10.10.10"><mrow id="A1.E18.m1.315.315.315.10.10.10.cmml" xref="A1.E18.m1.315.315.315.10.10.10"><mtext id="A1.E18.m1.315.315.315.10.10.10a.cmml" xref="A1.E18.m1.315.315.315.10.10.10">(From Theorem </mtext><mtext id="A1.E18.m1.315.315.315.10.10.10b.cmml" xref="A1.E18.m1.315.315.315.10.10.10"><a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#Thmthm2" title="Theorem 2. ‣ 4.2 Theoretical Analysis ‣ 4 Bisimulation metric for model predictive control ‣ Bisimulation metric for Model Predictive Control"><span class="ltx_text ltx_ref_tag">2</span></a></mtext><mtext id="A1.E18.m1.315.315.315.10.10.10e.cmml" xref="A1.E18.m1.315.315.315.10.10.10"> and Lemma </mtext><mtext id="A1.E18.m1.315.315.315.10.10.10f.cmml" xref="A1.E18.m1.315.315.315.10.10.10"><a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#Thmlem1" title="Lemma 1. ‣ Appendix A Proof of Theorem 3 ‣ Bisimulation metric for Model Predictive Control"><span class="ltx_text ltx_ref_tag">1</span></a></mtext><mtext id="A1.E18.m1.315.315.315.10.10.10i.cmml" xref="A1.E18.m1.315.315.315.10.10.10">)</mtext></mrow></ci><apply id="A1.E18.m1.321.321.2.2.2.3.cmml" xref="A1.E18.m1.1.1.1.1.1.1"><plus id="A1.E18.m1.318.318.318.3.3.3.cmml" xref="A1.E18.m1.318.318.318.3.3.3"></plus><apply id="A1.E18.m1.317.317.317.2.2.2.cmml" xref="A1.E18.m1.317.317.317.2.2.2"><divide id="A1.E18.m1.317.317.317.2.2.2.4.cmml" xref="A1.E18.m1.317.317.317.2.2.2"></divide><apply id="A1.E18.m1.317.317.317.2.2.2.1.cmml" xref="A1.E18.m1.317.317.317.2.2.2.1"><times id="A1.E18.m1.317.317.317.2.2.2.1.2.cmml" xref="A1.E18.m1.317.317.317.2.2.2.1.2"></times><cn id="A1.E18.m1.317.317.317.2.2.2.1.3.cmml" type="integer" xref="A1.E18.m1.317.317.317.2.2.2.1.3">2</cn><apply id="A1.E18.m1.317.317.317.2.2.2.1.4.cmml" xref="A1.E18.m1.317.317.317.2.2.2.1.4"><csymbol cd="ambiguous" id="A1.E18.m1.317.317.317.2.2.2.1.4.1.cmml" xref="A1.E18.m1.317.317.317.2.2.2.1.4">superscript</csymbol><ci id="A1.E18.m1.317.317.317.2.2.2.1.4.2.cmml" xref="A1.E18.m1.317.317.317.2.2.2.1.4.2">𝛾</ci><ci id="A1.E18.m1.317.317.317.2.2.2.1.4.3.cmml" xref="A1.E18.m1.317.317.317.2.2.2.1.4.3">𝐻</ci></apply><apply id="A1.E18.m1.317.317.317.2.2.2.1.1.1.1.cmml" xref="A1.E18.m1.317.317.317.2.2.2.1.1.1"><plus id="A1.E18.m1.317.317.317.2.2.2.1.1.1.1.1.cmml" xref="A1.E18.m1.317.317.317.2.2.2.1.1.1.1.1"></plus><ci id="A1.E18.m1.317.317.317.2.2.2.1.1.1.1.2.cmml" xref="A1.E18.m1.317.317.317.2.2.2.1.1.1.1.2">italic-ϵ</ci><ci id="A1.E18.m1.317.317.317.2.2.2.1.1.1.1.3.cmml" xref="A1.E18.m1.317.317.317.2.2.2.1.1.1.1.3">ℒ</ci></apply></apply><apply id="A1.E18.m1.317.317.317.2.2.2.3.cmml" xref="A1.E18.m1.317.317.317.2.2.2.3"><times id="A1.E18.m1.317.317.317.2.2.2.3.3.cmml" xref="A1.E18.m1.317.317.317.2.2.2.3.3"></times><apply id="A1.E18.m1.317.317.317.2.2.2.2.1.1.1.cmml" xref="A1.E18.m1.317.317.317.2.2.2.2.1.1"><minus id="A1.E18.m1.317.317.317.2.2.2.2.1.1.1.1.cmml" xref="A1.E18.m1.317.317.317.2.2.2.2.1.1.1.1"></minus><cn id="A1.E18.m1.317.317.317.2.2.2.2.1.1.1.2.cmml" type="integer" xref="A1.E18.m1.317.317.317.2.2.2.2.1.1.1.2">1</cn><ci id="A1.E18.m1.317.317.317.2.2.2.2.1.1.1.3.cmml" xref="A1.E18.m1.317.317.317.2.2.2.2.1.1.1.3">𝛾</ci></apply><apply id="A1.E18.m1.317.317.317.2.2.2.3.2.1.1.cmml" xref="A1.E18.m1.317.317.317.2.2.2.3.2.1"><minus id="A1.E18.m1.317.317.317.2.2.2.3.2.1.1.1.cmml" xref="A1.E18.m1.317.317.317.2.2.2.3.2.1.1.1"></minus><cn id="A1.E18.m1.317.317.317.2.2.2.3.2.1.1.2.cmml" type="integer" xref="A1.E18.m1.317.317.317.2.2.2.3.2.1.1.2">1</cn><ci id="A1.E18.m1.317.317.317.2.2.2.3.2.1.1.3.cmml" xref="A1.E18.m1.317.317.317.2.2.2.3.2.1.1.3">𝑐</ci></apply></apply></apply><apply id="A1.E18.m1.319.319.319.4.4.4.cmml" xref="A1.E18.m1.319.319.319.4.4.4"><divide id="A1.E18.m1.319.319.319.4.4.4.4.cmml" xref="A1.E18.m1.319.319.319.4.4.4"></divide><apply id="A1.E18.m1.319.319.319.4.4.4.1.cmml" xref="A1.E18.m1.319.319.319.4.4.4.1"><times id="A1.E18.m1.319.319.319.4.4.4.1.2.cmml" xref="A1.E18.m1.319.319.319.4.4.4.1.2"></times><cn id="A1.E18.m1.319.319.319.4.4.4.1.3.cmml" type="integer" xref="A1.E18.m1.319.319.319.4.4.4.1.3">2</cn><ci id="A1.E18.m1.319.319.319.4.4.4.1.4.cmml" xref="A1.E18.m1.319.319.319.4.4.4.1.4">italic-ϵ</ci><apply id="A1.E18.m1.319.319.319.4.4.4.1.1.1.1.cmml" xref="A1.E18.m1.319.319.319.4.4.4.1.1.1"><minus id="A1.E18.m1.319.319.319.4.4.4.1.1.1.1.1.cmml" xref="A1.E18.m1.319.319.319.4.4.4.1.1.1.1.1"></minus><cn id="A1.E18.m1.319.319.319.4.4.4.1.1.1.1.2.cmml" type="integer" xref="A1.E18.m1.319.319.319.4.4.4.1.1.1.1.2">1</cn><apply id="A1.E18.m1.319.319.319.4.4.4.1.1.1.1.3.cmml" xref="A1.E18.m1.319.319.319.4.4.4.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.E18.m1.319.319.319.4.4.4.1.1.1.1.3.1.cmml" xref="A1.E18.m1.319.319.319.4.4.4.1.1.1.1.3">superscript</csymbol><ci id="A1.E18.m1.319.319.319.4.4.4.1.1.1.1.3.2.cmml" xref="A1.E18.m1.319.319.319.4.4.4.1.1.1.1.3.2">𝛾</ci><apply id="A1.E18.m1.319.319.319.4.4.4.1.1.1.1.3.3.cmml" xref="A1.E18.m1.319.319.319.4.4.4.1.1.1.1.3.3"><minus id="A1.E18.m1.319.319.319.4.4.4.1.1.1.1.3.3.1.cmml" xref="A1.E18.m1.319.319.319.4.4.4.1.1.1.1.3.3.1"></minus><ci id="A1.E18.m1.319.319.319.4.4.4.1.1.1.1.3.3.2.cmml" xref="A1.E18.m1.319.319.319.4.4.4.1.1.1.1.3.3.2">𝐻</ci><cn id="A1.E18.m1.319.319.319.4.4.4.1.1.1.1.3.3.3.cmml" type="integer" xref="A1.E18.m1.319.319.319.4.4.4.1.1.1.1.3.3.3">1</cn></apply></apply></apply></apply><apply id="A1.E18.m1.319.319.319.4.4.4.3.cmml" xref="A1.E18.m1.319.319.319.4.4.4.3"><times id="A1.E18.m1.319.319.319.4.4.4.3.3.cmml" xref="A1.E18.m1.319.319.319.4.4.4.3.3"></times><apply id="A1.E18.m1.319.319.319.4.4.4.2.1.1.1.cmml" xref="A1.E18.m1.319.319.319.4.4.4.2.1.1"><minus id="A1.E18.m1.319.319.319.4.4.4.2.1.1.1.1.cmml" xref="A1.E18.m1.319.319.319.4.4.4.2.1.1.1.1"></minus><cn id="A1.E18.m1.319.319.319.4.4.4.2.1.1.1.2.cmml" type="integer" xref="A1.E18.m1.319.319.319.4.4.4.2.1.1.1.2">1</cn><ci id="A1.E18.m1.319.319.319.4.4.4.2.1.1.1.3.cmml" xref="A1.E18.m1.319.319.319.4.4.4.2.1.1.1.3">𝛾</ci></apply><apply id="A1.E18.m1.319.319.319.4.4.4.3.2.1.1.cmml" xref="A1.E18.m1.319.319.319.4.4.4.3.2.1"><minus id="A1.E18.m1.319.319.319.4.4.4.3.2.1.1.1.cmml" xref="A1.E18.m1.319.319.319.4.4.4.3.2.1.1.1"></minus><cn id="A1.E18.m1.319.319.319.4.4.4.3.2.1.1.2.cmml" type="integer" xref="A1.E18.m1.319.319.319.4.4.4.3.2.1.1.2">1</cn><ci id="A1.E18.m1.319.319.319.4.4.4.3.2.1.1.3.cmml" xref="A1.E18.m1.319.319.319.4.4.4.3.2.1.1.3">𝑐</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E18.m1.331c">\begin{split}\left|\mathbf{S}(\tau)-\mathbf{S}(\phi(\tau))\right|&amp;=\left|%
\mathbb{E}_{\tau}\left[\gamma^{H}\left(V^{*}(s_{H})-V^{*}(\phi(s_{H}))\right)+%
\sum_{h=0}^{H-1}\gamma^{h}(R(s_{h},a_{h})-R(\phi(s_{h}),a_{h}))\right]\right|%
\\
&amp;=\left|\mathbb{E}_{\tau}\left[\gamma^{H}\left(V^{*}(s_{H})-V^{*}(\phi(s_{H}))%
\right)\right]+\mathbb{E}_{\tau}\left[\sum_{h=0}^{H-1}\gamma^{h}(R(s_{h},a_{h}%
)-R(\phi(s_{h}),a_{h}))\right]\right|\\
&amp;\leq\left\lvert\mathbb{E}_{\tau}\left[\gamma^{H}\left(V^{*}(s_{H})-V^{*}(\phi%
(s_{H}))\right)\right]\right\rvert+\left|\mathbb{E}_{\tau}\left[\sum_{h=0}^{H-%
1}\gamma^{h}(R(s_{h},a_{h})-R(\phi(s_{h}),a_{h}))\right]\right|\\
&amp;\hskip 227.62204pt\text{(Triangle inequality)}\\
&amp;\leq\mathbb{E}_{\tau}\left[\gamma^{H}\left\lvert V^{*}(s_{H})-V^{*}(\phi(s_{H%
}))\right\rvert\right]+\mathbb{E}_{\tau}\left[\sum_{h=0}^{H-1}\gamma^{h}\left%
\lvert R(s_{h},a_{h})-R(\phi(s_{h}),a_{h})\right\rvert\right]\\
&amp;\hskip 227.62204pt\text{(Jensen's inequality)}\\
&amp;=\gamma^{H}\mathbb{E}_{\tau}\left[\left\lvert V^{*}(s_{H})-V^{*}(\phi(s_{H}))%
\right\rvert\right]+\sum_{h=0}^{H-1}\gamma^{h}\mathbb{E}_{\tau}\left[\left%
\lvert R(s_{h},a_{h})-R(\phi(s_{h}),a_{h})\right\rvert\right]\\
&amp;\leq\frac{2\gamma^{H}(\epsilon+{\mathcal{L}})}{(1-\gamma)(1-c)}+\frac{2%
\epsilon}{1-c}\sum_{h=0}^{H-1}\gamma^{h}\quad\text{(From Theorem~{}\ref{thm:%
optimal-value-bound} and Lemma~{}\ref{cor:reward-bound})}\\
&amp;\leq\frac{2\gamma^{H}(\epsilon+{\mathcal{L}})}{(1-\gamma)(1-c)}+\frac{2%
\epsilon(1-\gamma^{H-1})}{(1-\gamma)(1-c)}\end{split}</annotation><annotation encoding="application/x-llamapun" id="A1.E18.m1.331d">start_ROW start_CELL | bold_S ( italic_τ ) - bold_S ( italic_ϕ ( italic_τ ) ) | end_CELL start_CELL = | blackboard_E start_POSTSUBSCRIPT italic_τ end_POSTSUBSCRIPT [ italic_γ start_POSTSUPERSCRIPT italic_H end_POSTSUPERSCRIPT ( italic_V start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ( italic_s start_POSTSUBSCRIPT italic_H end_POSTSUBSCRIPT ) - italic_V start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ( italic_ϕ ( italic_s start_POSTSUBSCRIPT italic_H end_POSTSUBSCRIPT ) ) ) + ∑ start_POSTSUBSCRIPT italic_h = 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_H - 1 end_POSTSUPERSCRIPT italic_γ start_POSTSUPERSCRIPT italic_h end_POSTSUPERSCRIPT ( italic_R ( italic_s start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT , italic_a start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT ) - italic_R ( italic_ϕ ( italic_s start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT ) , italic_a start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT ) ) ] | end_CELL end_ROW start_ROW start_CELL end_CELL start_CELL = | blackboard_E start_POSTSUBSCRIPT italic_τ end_POSTSUBSCRIPT [ italic_γ start_POSTSUPERSCRIPT italic_H end_POSTSUPERSCRIPT ( italic_V start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ( italic_s start_POSTSUBSCRIPT italic_H end_POSTSUBSCRIPT ) - italic_V start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ( italic_ϕ ( italic_s start_POSTSUBSCRIPT italic_H end_POSTSUBSCRIPT ) ) ) ] + blackboard_E start_POSTSUBSCRIPT italic_τ end_POSTSUBSCRIPT [ ∑ start_POSTSUBSCRIPT italic_h = 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_H - 1 end_POSTSUPERSCRIPT italic_γ start_POSTSUPERSCRIPT italic_h end_POSTSUPERSCRIPT ( italic_R ( italic_s start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT , italic_a start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT ) - italic_R ( italic_ϕ ( italic_s start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT ) , italic_a start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT ) ) ] | end_CELL end_ROW start_ROW start_CELL end_CELL start_CELL ≤ | blackboard_E start_POSTSUBSCRIPT italic_τ end_POSTSUBSCRIPT [ italic_γ start_POSTSUPERSCRIPT italic_H end_POSTSUPERSCRIPT ( italic_V start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ( italic_s start_POSTSUBSCRIPT italic_H end_POSTSUBSCRIPT ) - italic_V start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ( italic_ϕ ( italic_s start_POSTSUBSCRIPT italic_H end_POSTSUBSCRIPT ) ) ) ] | + | blackboard_E start_POSTSUBSCRIPT italic_τ end_POSTSUBSCRIPT [ ∑ start_POSTSUBSCRIPT italic_h = 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_H - 1 end_POSTSUPERSCRIPT italic_γ start_POSTSUPERSCRIPT italic_h end_POSTSUPERSCRIPT ( italic_R ( italic_s start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT , italic_a start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT ) - italic_R ( italic_ϕ ( italic_s start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT ) , italic_a start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT ) ) ] | end_CELL end_ROW start_ROW start_CELL end_CELL start_CELL (Triangle inequality) end_CELL end_ROW start_ROW start_CELL end_CELL start_CELL ≤ blackboard_E start_POSTSUBSCRIPT italic_τ end_POSTSUBSCRIPT [ italic_γ start_POSTSUPERSCRIPT italic_H end_POSTSUPERSCRIPT | italic_V start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ( italic_s start_POSTSUBSCRIPT italic_H end_POSTSUBSCRIPT ) - italic_V start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ( italic_ϕ ( italic_s start_POSTSUBSCRIPT italic_H end_POSTSUBSCRIPT ) ) | ] + blackboard_E start_POSTSUBSCRIPT italic_τ end_POSTSUBSCRIPT [ ∑ start_POSTSUBSCRIPT italic_h = 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_H - 1 end_POSTSUPERSCRIPT italic_γ start_POSTSUPERSCRIPT italic_h end_POSTSUPERSCRIPT | italic_R ( italic_s start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT , italic_a start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT ) - italic_R ( italic_ϕ ( italic_s start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT ) , italic_a start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT ) | ] end_CELL end_ROW start_ROW start_CELL end_CELL start_CELL (Jensen’s inequality) end_CELL end_ROW start_ROW start_CELL end_CELL start_CELL = italic_γ start_POSTSUPERSCRIPT italic_H end_POSTSUPERSCRIPT blackboard_E start_POSTSUBSCRIPT italic_τ end_POSTSUBSCRIPT [ | italic_V start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ( italic_s start_POSTSUBSCRIPT italic_H end_POSTSUBSCRIPT ) - italic_V start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ( italic_ϕ ( italic_s start_POSTSUBSCRIPT italic_H end_POSTSUBSCRIPT ) ) | ] + ∑ start_POSTSUBSCRIPT italic_h = 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_H - 1 end_POSTSUPERSCRIPT italic_γ start_POSTSUPERSCRIPT italic_h end_POSTSUPERSCRIPT blackboard_E start_POSTSUBSCRIPT italic_τ end_POSTSUBSCRIPT [ | italic_R ( italic_s start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT , italic_a start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT ) - italic_R ( italic_ϕ ( italic_s start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT ) , italic_a start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT ) | ] end_CELL end_ROW start_ROW start_CELL end_CELL start_CELL ≤ divide start_ARG 2 italic_γ start_POSTSUPERSCRIPT italic_H end_POSTSUPERSCRIPT ( italic_ϵ + caligraphic_L ) end_ARG start_ARG ( 1 - italic_γ ) ( 1 - italic_c ) end_ARG + divide start_ARG 2 italic_ϵ end_ARG start_ARG 1 - italic_c end_ARG ∑ start_POSTSUBSCRIPT italic_h = 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_H - 1 end_POSTSUPERSCRIPT italic_γ start_POSTSUPERSCRIPT italic_h end_POSTSUPERSCRIPT (From Theorem and Lemma ) end_CELL end_ROW start_ROW start_CELL end_CELL start_CELL ≤ divide start_ARG 2 italic_γ start_POSTSUPERSCRIPT italic_H end_POSTSUPERSCRIPT ( italic_ϵ + caligraphic_L ) end_ARG start_ARG ( 1 - italic_γ ) ( 1 - italic_c ) end_ARG + divide start_ARG 2 italic_ϵ ( 1 - italic_γ start_POSTSUPERSCRIPT italic_H - 1 end_POSTSUPERSCRIPT ) end_ARG start_ARG ( 1 - italic_γ ) ( 1 - italic_c ) end_ARG end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(18)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A1.1.p1.3">∎</p>
</div>
</div>
</section>
<section class="ltx_appendix" id="A2">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>Additional Experimental Results</h2>
<section class="ltx_subsection" id="A2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.1 </span>All state-based tasks result</h3>
<figure class="ltx_figure" id="A2.F6"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_portrait" height="771" id="A2.F6.g1" src="extracted/5905356/figures/all_state_result.png" width="521"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6: </span>State-based tasks result from DMControl Suite. Performance comparison on 26 DM Control tasks with state input. At each evaluation step, the episode return is computed over 10 episodes. The results are averaged over 3 seeds, with shaded regions representing the standard deviation.</figcaption>
</figure>
</section>
<section class="ltx_subsection" id="A2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.2 </span>Computational Time</h3>
<div class="ltx_para ltx_noindent" id="A2.SS2.p1">
<p class="ltx_p" id="A2.SS2.p1.1">Table. <a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#A2.T1" title="Table 1 ‣ B.2 Computational Time ‣ Appendix B Additional Experimental Results ‣ Bisimulation metric for Model Predictive Control"><span class="ltx_text ltx_ref_tag">1</span></a> shows the computational time of BS-MPC and TD-MPC. We use RTX-4090 for our experiments.</p>
</div>
<figure class="ltx_table" id="A2.T1">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1: </span>Computational time between BS-MPC and TD-MPC in state-based tasks. The table shows how many hours the training takes.</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A2.T1.1">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A2.T1.1.1.1">
<td class="ltx_td ltx_border_tt" id="A2.T1.1.1.1.1"></td>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="A2.T1.1.1.1.2"><span class="ltx_text ltx_font_bold" id="A2.T1.1.1.1.2.1">Cartpole-Swingup</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="A2.T1.1.1.1.3"><span class="ltx_text ltx_font_bold" id="A2.T1.1.1.1.3.1">Cheetah-run</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="A2.T1.1.1.1.4"><span class="ltx_text ltx_font_bold" id="A2.T1.1.1.1.4.1">Finger-Spin</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="A2.T1.1.1.1.5"><span class="ltx_text ltx_font_bold" id="A2.T1.1.1.1.5.1">Walker-run</span></th>
</tr>
<tr class="ltx_tr" id="A2.T1.1.2.2">
<td class="ltx_td ltx_align_left ltx_border_t" id="A2.T1.1.2.2.1">BS-MPC</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A2.T1.1.2.2.2"><span class="ltx_text ltx_font_bold" id="A2.T1.1.2.2.2.1">2.0</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A2.T1.1.2.2.3"><span class="ltx_text ltx_font_bold" id="A2.T1.1.2.2.3.1">4.0</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A2.T1.1.2.2.4"><span class="ltx_text ltx_font_bold" id="A2.T1.1.2.2.4.1">8.3</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A2.T1.1.2.2.5"><span class="ltx_text ltx_font_bold" id="A2.T1.1.2.2.5.1">8.3</span></td>
</tr>
<tr class="ltx_tr" id="A2.T1.1.3.3">
<td class="ltx_td ltx_align_left ltx_border_bb" id="A2.T1.1.3.3.1">TD-MPC</td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="A2.T1.1.3.3.2">2.4</td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="A2.T1.1.3.3.3">4.8</td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="A2.T1.1.3.3.4">10.0</td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="A2.T1.1.3.3.5">10.1</td>
</tr>
</tbody>
</table>
</figure>
</section>
<section class="ltx_subsection" id="A2.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.3 </span>Detailed analysis for the failure of TD-MPC</h3>
<div class="ltx_para ltx_noindent" id="A2.SS3.p1">
<p class="ltx_p" id="A2.SS3.p1.1">In this section, we analyze the reason why TD-MPC failed to achieve the same performance as BS-MPC in our experiments. First, we look at the losses of both BS-MPC and TD-MPC in the Humanoid-Walk environment. Fig <a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#A2.F7" title="Figure 7 ‣ B.3 Detailed analysis for the failure of TD-MPC ‣ Appendix B Additional Experimental Results ‣ Bisimulation metric for Model Predictive Control"><span class="ltx_text ltx_ref_tag">7</span></a> shows the average value of each loss over the batches. From this image, it can be observed that the consistency loss in TD-MPC gradually increases and diverges. In contrast, BS-MPC has much smaller values for every component, resulting in more stable performance. One possible cause is that TD-MPC fails to learn the encoder, leading to large errors, which in turn result in the failure to train the latent dynamics model properly. BS-MPC, on the contrary, has explicit encoder loss in its objective function, thus enabling it to actively update the encoder. Fig <a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#A2.F8" title="Figure 8 ‣ B.3 Detailed analysis for the failure of TD-MPC ‣ Appendix B Additional Experimental Results ‣ Bisimulation metric for Model Predictive Control"><span class="ltx_text ltx_ref_tag">8</span></a> shows the learned Q values and gradient norm of the objective function. As it shows, TD-MPC is vulnerable to exploding gradients, which leads to the divergence of the loss. Moreover, the learned Q values drop significantly when the gradient norm explodes.</p>
</div>
<figure class="ltx_figure" id="A2.F7"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="162" id="A2.F7.g1" src="extracted/5905356/figures/humanoid_walk_loss_analysis.png" width="521"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 7: </span>Comparative analysis of loss components between BS-MPC and TD-MPC across training steps in Humanoid-walk environment. Each graph presents different loss types—consistency loss, reward loss, value loss, encoder loss, and total loss—plotted against training steps. Note that TD-MPC does not have encoder loss, and it only exists in BS-MPC. See Eq. <a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#S4.E8" title="In Objective function ‣ 4.1 Bisimulation Metric for Model Predictive Control ‣ 4 Bisimulation metric for model predictive control ‣ Bisimulation metric for Model Predictive Control"><span class="ltx_text ltx_ref_tag">8</span></a> for more details.</figcaption>
</figure>
<figure class="ltx_figure" id="A2.F8"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="170" id="A2.F8.g1" src="extracted/5905356/figures/humanoid_walk_q_analysis.png" width="291"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 8: </span>Average values of the learned Q functions and gradient norm of the loss function between BS-MPC and TD-MPC across training steps in Humanoid-walk environment.</figcaption>
</figure>
</section>
</section>
<section class="ltx_appendix" id="A3">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix C </span>BS-MPC training algorithm flow</h2>
<div class="ltx_para ltx_noindent" id="A3.p1">
<p class="ltx_p" id="A3.p1.1">The training algorithm flow is described in Algorithm. <a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#alg1" title="Algorithm 1 ‣ Appendix C BS-MPC training algorithm flow ‣ Bisimulation metric for Model Predictive Control"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<figure class="ltx_figure" id="A3.fig1">
<figure class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top" id="alg1">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="alg1.6.1.1">Algorithm 1</span> </span> BS-MPC (Model training)</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel" id="alg1.4"><span class="ltx_text ltx_font_bold" id="alg1.4.1">Require:</span> <math alttext="\theta=[\theta^{h},\theta^{R},\theta^{Q},\theta^{d}],\psi" class="ltx_Math" display="inline" id="alg1.1.m1.2"><semantics id="alg1.1.m1.2a"><mrow id="alg1.1.m1.2.2" xref="alg1.1.m1.2.2.cmml"><mi id="alg1.1.m1.2.2.3" xref="alg1.1.m1.2.2.3.cmml">θ</mi><mo id="alg1.1.m1.2.2.2" xref="alg1.1.m1.2.2.2.cmml">=</mo><mrow id="alg1.1.m1.2.2.1.1" xref="alg1.1.m1.2.2.1.2.cmml"><mrow id="alg1.1.m1.2.2.1.1.1.4" xref="alg1.1.m1.2.2.1.1.1.5.cmml"><mo id="alg1.1.m1.2.2.1.1.1.4.5" stretchy="false" xref="alg1.1.m1.2.2.1.1.1.5.cmml">[</mo><msup id="alg1.1.m1.2.2.1.1.1.1.1" xref="alg1.1.m1.2.2.1.1.1.1.1.cmml"><mi id="alg1.1.m1.2.2.1.1.1.1.1.2" xref="alg1.1.m1.2.2.1.1.1.1.1.2.cmml">θ</mi><mi id="alg1.1.m1.2.2.1.1.1.1.1.3" xref="alg1.1.m1.2.2.1.1.1.1.1.3.cmml">h</mi></msup><mo id="alg1.1.m1.2.2.1.1.1.4.6" xref="alg1.1.m1.2.2.1.1.1.5.cmml">,</mo><msup id="alg1.1.m1.2.2.1.1.1.2.2" xref="alg1.1.m1.2.2.1.1.1.2.2.cmml"><mi id="alg1.1.m1.2.2.1.1.1.2.2.2" xref="alg1.1.m1.2.2.1.1.1.2.2.2.cmml">θ</mi><mi id="alg1.1.m1.2.2.1.1.1.2.2.3" xref="alg1.1.m1.2.2.1.1.1.2.2.3.cmml">R</mi></msup><mo id="alg1.1.m1.2.2.1.1.1.4.7" xref="alg1.1.m1.2.2.1.1.1.5.cmml">,</mo><msup id="alg1.1.m1.2.2.1.1.1.3.3" xref="alg1.1.m1.2.2.1.1.1.3.3.cmml"><mi id="alg1.1.m1.2.2.1.1.1.3.3.2" xref="alg1.1.m1.2.2.1.1.1.3.3.2.cmml">θ</mi><mi id="alg1.1.m1.2.2.1.1.1.3.3.3" xref="alg1.1.m1.2.2.1.1.1.3.3.3.cmml">Q</mi></msup><mo id="alg1.1.m1.2.2.1.1.1.4.8" xref="alg1.1.m1.2.2.1.1.1.5.cmml">,</mo><msup id="alg1.1.m1.2.2.1.1.1.4.4" xref="alg1.1.m1.2.2.1.1.1.4.4.cmml"><mi id="alg1.1.m1.2.2.1.1.1.4.4.2" xref="alg1.1.m1.2.2.1.1.1.4.4.2.cmml">θ</mi><mi id="alg1.1.m1.2.2.1.1.1.4.4.3" xref="alg1.1.m1.2.2.1.1.1.4.4.3.cmml">d</mi></msup><mo id="alg1.1.m1.2.2.1.1.1.4.9" stretchy="false" xref="alg1.1.m1.2.2.1.1.1.5.cmml">]</mo></mrow><mo id="alg1.1.m1.2.2.1.1.2" xref="alg1.1.m1.2.2.1.2.cmml">,</mo><mi id="alg1.1.m1.1.1" xref="alg1.1.m1.1.1.cmml">ψ</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.1.m1.2b"><apply id="alg1.1.m1.2.2.cmml" xref="alg1.1.m1.2.2"><eq id="alg1.1.m1.2.2.2.cmml" xref="alg1.1.m1.2.2.2"></eq><ci id="alg1.1.m1.2.2.3.cmml" xref="alg1.1.m1.2.2.3">𝜃</ci><list id="alg1.1.m1.2.2.1.2.cmml" xref="alg1.1.m1.2.2.1.1"><list id="alg1.1.m1.2.2.1.1.1.5.cmml" xref="alg1.1.m1.2.2.1.1.1.4"><apply id="alg1.1.m1.2.2.1.1.1.1.1.cmml" xref="alg1.1.m1.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.1.m1.2.2.1.1.1.1.1.1.cmml" xref="alg1.1.m1.2.2.1.1.1.1.1">superscript</csymbol><ci id="alg1.1.m1.2.2.1.1.1.1.1.2.cmml" xref="alg1.1.m1.2.2.1.1.1.1.1.2">𝜃</ci><ci id="alg1.1.m1.2.2.1.1.1.1.1.3.cmml" xref="alg1.1.m1.2.2.1.1.1.1.1.3">ℎ</ci></apply><apply id="alg1.1.m1.2.2.1.1.1.2.2.cmml" xref="alg1.1.m1.2.2.1.1.1.2.2"><csymbol cd="ambiguous" id="alg1.1.m1.2.2.1.1.1.2.2.1.cmml" xref="alg1.1.m1.2.2.1.1.1.2.2">superscript</csymbol><ci id="alg1.1.m1.2.2.1.1.1.2.2.2.cmml" xref="alg1.1.m1.2.2.1.1.1.2.2.2">𝜃</ci><ci id="alg1.1.m1.2.2.1.1.1.2.2.3.cmml" xref="alg1.1.m1.2.2.1.1.1.2.2.3">𝑅</ci></apply><apply id="alg1.1.m1.2.2.1.1.1.3.3.cmml" xref="alg1.1.m1.2.2.1.1.1.3.3"><csymbol cd="ambiguous" id="alg1.1.m1.2.2.1.1.1.3.3.1.cmml" xref="alg1.1.m1.2.2.1.1.1.3.3">superscript</csymbol><ci id="alg1.1.m1.2.2.1.1.1.3.3.2.cmml" xref="alg1.1.m1.2.2.1.1.1.3.3.2">𝜃</ci><ci id="alg1.1.m1.2.2.1.1.1.3.3.3.cmml" xref="alg1.1.m1.2.2.1.1.1.3.3.3">𝑄</ci></apply><apply id="alg1.1.m1.2.2.1.1.1.4.4.cmml" xref="alg1.1.m1.2.2.1.1.1.4.4"><csymbol cd="ambiguous" id="alg1.1.m1.2.2.1.1.1.4.4.1.cmml" xref="alg1.1.m1.2.2.1.1.1.4.4">superscript</csymbol><ci id="alg1.1.m1.2.2.1.1.1.4.4.2.cmml" xref="alg1.1.m1.2.2.1.1.1.4.4.2">𝜃</ci><ci id="alg1.1.m1.2.2.1.1.1.4.4.3.cmml" xref="alg1.1.m1.2.2.1.1.1.4.4.3">𝑑</ci></apply></list><ci id="alg1.1.m1.1.1.cmml" xref="alg1.1.m1.1.1">𝜓</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.1.m1.2c">\theta=[\theta^{h},\theta^{R},\theta^{Q},\theta^{d}],\psi</annotation><annotation encoding="application/x-llamapun" id="alg1.1.m1.2d">italic_θ = [ italic_θ start_POSTSUPERSCRIPT italic_h end_POSTSUPERSCRIPT , italic_θ start_POSTSUPERSCRIPT italic_R end_POSTSUPERSCRIPT , italic_θ start_POSTSUPERSCRIPT italic_Q end_POSTSUPERSCRIPT , italic_θ start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT ] , italic_ψ</annotation></semantics></math>: randomly initialized network parameters, 
<br class="ltx_break"/>             Episode Length <math alttext="L" class="ltx_Math" display="inline" id="alg1.2.m2.1"><semantics id="alg1.2.m2.1a"><mi id="alg1.2.m2.1.1" xref="alg1.2.m2.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="alg1.2.m2.1b"><ci id="alg1.2.m2.1.1.cmml" xref="alg1.2.m2.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.2.m2.1c">L</annotation><annotation encoding="application/x-llamapun" id="alg1.2.m2.1d">italic_L</annotation></semantics></math>, Number of parameter update <math alttext="K" class="ltx_Math" display="inline" id="alg1.3.m3.1"><semantics id="alg1.3.m3.1a"><mi id="alg1.3.m3.1.1" xref="alg1.3.m3.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="alg1.3.m3.1b"><ci id="alg1.3.m3.1.1.cmml" xref="alg1.3.m3.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.3.m3.1c">K</annotation><annotation encoding="application/x-llamapun" id="alg1.3.m3.1d">italic_K</annotation></semantics></math>, Buffer <math alttext="\mathcal{B}" class="ltx_Math" display="inline" id="alg1.4.m4.1"><semantics id="alg1.4.m4.1a"><mi class="ltx_font_mathcaligraphic" id="alg1.4.m4.1.1" xref="alg1.4.m4.1.1.cmml">ℬ</mi><annotation-xml encoding="MathML-Content" id="alg1.4.m4.1b"><ci id="alg1.4.m4.1.1.cmml" xref="alg1.4.m4.1.1">ℬ</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.4.m4.1c">\mathcal{B}</annotation><annotation encoding="application/x-llamapun" id="alg1.4.m4.1d">caligraphic_B</annotation></semantics></math>
<br class="ltx_break"/></p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<div class="ltx_listing ltx_figure_panel ltx_listing" id="alg1.7">
<div class="ltx_listingline" id="alg1.l1">
<span class="ltx_tag ltx_tag_listingline">1:</span>  <span class="ltx_text ltx_font_bold" id="alg1.l1.1">while</span> the training is not complete <span class="ltx_text ltx_font_bold" id="alg1.l1.2">do</span>
</div>
<div class="ltx_listingline" id="alg1.l2">
<span class="ltx_tag ltx_tag_listingline">2:</span>     <span class="ltx_text ltx_font_italic" id="alg1.l2.1">// Collect episode</span>
</div>
<div class="ltx_listingline" id="alg1.l3">
<span class="ltx_tag ltx_tag_listingline">3:</span>     <span class="ltx_text ltx_font_bold" id="alg1.l3.1">for</span> <math alttext="t=0\dots L" class="ltx_Math" display="inline" id="alg1.l3.m1.1"><semantics id="alg1.l3.m1.1a"><mrow id="alg1.l3.m1.1.1" xref="alg1.l3.m1.1.1.cmml"><mi id="alg1.l3.m1.1.1.2" xref="alg1.l3.m1.1.1.2.cmml">t</mi><mo id="alg1.l3.m1.1.1.1" xref="alg1.l3.m1.1.1.1.cmml">=</mo><mrow id="alg1.l3.m1.1.1.3" xref="alg1.l3.m1.1.1.3.cmml"><mn id="alg1.l3.m1.1.1.3.2" xref="alg1.l3.m1.1.1.3.2.cmml">0</mn><mo id="alg1.l3.m1.1.1.3.1" xref="alg1.l3.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l3.m1.1.1.3.3" mathvariant="normal" xref="alg1.l3.m1.1.1.3.3.cmml">…</mi><mo id="alg1.l3.m1.1.1.3.1a" xref="alg1.l3.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l3.m1.1.1.3.4" xref="alg1.l3.m1.1.1.3.4.cmml">L</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l3.m1.1b"><apply id="alg1.l3.m1.1.1.cmml" xref="alg1.l3.m1.1.1"><eq id="alg1.l3.m1.1.1.1.cmml" xref="alg1.l3.m1.1.1.1"></eq><ci id="alg1.l3.m1.1.1.2.cmml" xref="alg1.l3.m1.1.1.2">𝑡</ci><apply id="alg1.l3.m1.1.1.3.cmml" xref="alg1.l3.m1.1.1.3"><times id="alg1.l3.m1.1.1.3.1.cmml" xref="alg1.l3.m1.1.1.3.1"></times><cn id="alg1.l3.m1.1.1.3.2.cmml" type="integer" xref="alg1.l3.m1.1.1.3.2">0</cn><ci id="alg1.l3.m1.1.1.3.3.cmml" xref="alg1.l3.m1.1.1.3.3">…</ci><ci id="alg1.l3.m1.1.1.3.4.cmml" xref="alg1.l3.m1.1.1.3.4">𝐿</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m1.1c">t=0\dots L</annotation><annotation encoding="application/x-llamapun" id="alg1.l3.m1.1d">italic_t = 0 … italic_L</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="alg1.l3.2">do</span>
</div>
<div class="ltx_listingline" id="alg1.l4">
<span class="ltx_tag ltx_tag_listingline">4:</span>        <math alttext="a_{t}\sim\textit{BSMPC}(h_{\theta^{h}}(s_{t}))" class="ltx_Math" display="inline" id="alg1.l4.m1.1"><semantics id="alg1.l4.m1.1a"><mrow id="alg1.l4.m1.1.1" xref="alg1.l4.m1.1.1.cmml"><msub id="alg1.l4.m1.1.1.3" xref="alg1.l4.m1.1.1.3.cmml"><mi id="alg1.l4.m1.1.1.3.2" xref="alg1.l4.m1.1.1.3.2.cmml">a</mi><mi id="alg1.l4.m1.1.1.3.3" xref="alg1.l4.m1.1.1.3.3.cmml">t</mi></msub><mo id="alg1.l4.m1.1.1.2" xref="alg1.l4.m1.1.1.2.cmml">∼</mo><mrow id="alg1.l4.m1.1.1.1" xref="alg1.l4.m1.1.1.1.cmml"><mtext class="ltx_mathvariant_italic" id="alg1.l4.m1.1.1.1.3" xref="alg1.l4.m1.1.1.1.3a.cmml">BSMPC</mtext><mo id="alg1.l4.m1.1.1.1.2" xref="alg1.l4.m1.1.1.1.2.cmml">⁢</mo><mrow id="alg1.l4.m1.1.1.1.1.1" xref="alg1.l4.m1.1.1.1.1.1.1.cmml"><mo id="alg1.l4.m1.1.1.1.1.1.2" stretchy="false" xref="alg1.l4.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="alg1.l4.m1.1.1.1.1.1.1" xref="alg1.l4.m1.1.1.1.1.1.1.cmml"><msub id="alg1.l4.m1.1.1.1.1.1.1.3" xref="alg1.l4.m1.1.1.1.1.1.1.3.cmml"><mi id="alg1.l4.m1.1.1.1.1.1.1.3.2" xref="alg1.l4.m1.1.1.1.1.1.1.3.2.cmml">h</mi><msup id="alg1.l4.m1.1.1.1.1.1.1.3.3" xref="alg1.l4.m1.1.1.1.1.1.1.3.3.cmml"><mi id="alg1.l4.m1.1.1.1.1.1.1.3.3.2" xref="alg1.l4.m1.1.1.1.1.1.1.3.3.2.cmml">θ</mi><mi id="alg1.l4.m1.1.1.1.1.1.1.3.3.3" xref="alg1.l4.m1.1.1.1.1.1.1.3.3.3.cmml">h</mi></msup></msub><mo id="alg1.l4.m1.1.1.1.1.1.1.2" xref="alg1.l4.m1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="alg1.l4.m1.1.1.1.1.1.1.1.1" xref="alg1.l4.m1.1.1.1.1.1.1.1.1.1.cmml"><mo id="alg1.l4.m1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="alg1.l4.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="alg1.l4.m1.1.1.1.1.1.1.1.1.1" xref="alg1.l4.m1.1.1.1.1.1.1.1.1.1.cmml"><mi id="alg1.l4.m1.1.1.1.1.1.1.1.1.1.2" xref="alg1.l4.m1.1.1.1.1.1.1.1.1.1.2.cmml">s</mi><mi id="alg1.l4.m1.1.1.1.1.1.1.1.1.1.3" xref="alg1.l4.m1.1.1.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="alg1.l4.m1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="alg1.l4.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="alg1.l4.m1.1.1.1.1.1.3" stretchy="false" xref="alg1.l4.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l4.m1.1b"><apply id="alg1.l4.m1.1.1.cmml" xref="alg1.l4.m1.1.1"><csymbol cd="latexml" id="alg1.l4.m1.1.1.2.cmml" xref="alg1.l4.m1.1.1.2">similar-to</csymbol><apply id="alg1.l4.m1.1.1.3.cmml" xref="alg1.l4.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l4.m1.1.1.3.1.cmml" xref="alg1.l4.m1.1.1.3">subscript</csymbol><ci id="alg1.l4.m1.1.1.3.2.cmml" xref="alg1.l4.m1.1.1.3.2">𝑎</ci><ci id="alg1.l4.m1.1.1.3.3.cmml" xref="alg1.l4.m1.1.1.3.3">𝑡</ci></apply><apply id="alg1.l4.m1.1.1.1.cmml" xref="alg1.l4.m1.1.1.1"><times id="alg1.l4.m1.1.1.1.2.cmml" xref="alg1.l4.m1.1.1.1.2"></times><ci id="alg1.l4.m1.1.1.1.3a.cmml" xref="alg1.l4.m1.1.1.1.3"><mtext class="ltx_mathvariant_italic" id="alg1.l4.m1.1.1.1.3.cmml" xref="alg1.l4.m1.1.1.1.3">BSMPC</mtext></ci><apply id="alg1.l4.m1.1.1.1.1.1.1.cmml" xref="alg1.l4.m1.1.1.1.1.1"><times id="alg1.l4.m1.1.1.1.1.1.1.2.cmml" xref="alg1.l4.m1.1.1.1.1.1.1.2"></times><apply id="alg1.l4.m1.1.1.1.1.1.1.3.cmml" xref="alg1.l4.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l4.m1.1.1.1.1.1.1.3.1.cmml" xref="alg1.l4.m1.1.1.1.1.1.1.3">subscript</csymbol><ci id="alg1.l4.m1.1.1.1.1.1.1.3.2.cmml" xref="alg1.l4.m1.1.1.1.1.1.1.3.2">ℎ</ci><apply id="alg1.l4.m1.1.1.1.1.1.1.3.3.cmml" xref="alg1.l4.m1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="alg1.l4.m1.1.1.1.1.1.1.3.3.1.cmml" xref="alg1.l4.m1.1.1.1.1.1.1.3.3">superscript</csymbol><ci id="alg1.l4.m1.1.1.1.1.1.1.3.3.2.cmml" xref="alg1.l4.m1.1.1.1.1.1.1.3.3.2">𝜃</ci><ci id="alg1.l4.m1.1.1.1.1.1.1.3.3.3.cmml" xref="alg1.l4.m1.1.1.1.1.1.1.3.3.3">ℎ</ci></apply></apply><apply id="alg1.l4.m1.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l4.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l4.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l4.m1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l4.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l4.m1.1.1.1.1.1.1.1.1.1.2">𝑠</ci><ci id="alg1.l4.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l4.m1.1.1.1.1.1.1.1.1.1.3">𝑡</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m1.1c">a_{t}\sim\textit{BSMPC}(h_{\theta^{h}}(s_{t}))</annotation><annotation encoding="application/x-llamapun" id="alg1.l4.m1.1d">italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∼ BSMPC ( italic_h start_POSTSUBSCRIPT italic_θ start_POSTSUPERSCRIPT italic_h end_POSTSUPERSCRIPT end_POSTSUBSCRIPT ( italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) )</annotation></semantics></math> {Compute action with BS-MPC}

</div>
<div class="ltx_listingline" id="alg1.l5">
<span class="ltx_tag ltx_tag_listingline">5:</span>        <math alttext="(s_{t+1},r_{t})\sim{\mathcal{P}}(s_{t},a_{t}),\mathcal{R}(s_{t},a_{t})" class="ltx_Math" display="inline" id="alg1.l5.m1.4"><semantics id="alg1.l5.m1.4a"><mrow id="alg1.l5.m1.4.4" xref="alg1.l5.m1.4.4.cmml"><mrow id="alg1.l5.m1.2.2.2.2" xref="alg1.l5.m1.2.2.2.3.cmml"><mo id="alg1.l5.m1.2.2.2.2.3" stretchy="false" xref="alg1.l5.m1.2.2.2.3.cmml">(</mo><msub id="alg1.l5.m1.1.1.1.1.1" xref="alg1.l5.m1.1.1.1.1.1.cmml"><mi id="alg1.l5.m1.1.1.1.1.1.2" xref="alg1.l5.m1.1.1.1.1.1.2.cmml">s</mi><mrow id="alg1.l5.m1.1.1.1.1.1.3" xref="alg1.l5.m1.1.1.1.1.1.3.cmml"><mi id="alg1.l5.m1.1.1.1.1.1.3.2" xref="alg1.l5.m1.1.1.1.1.1.3.2.cmml">t</mi><mo id="alg1.l5.m1.1.1.1.1.1.3.1" xref="alg1.l5.m1.1.1.1.1.1.3.1.cmml">+</mo><mn id="alg1.l5.m1.1.1.1.1.1.3.3" xref="alg1.l5.m1.1.1.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="alg1.l5.m1.2.2.2.2.4" xref="alg1.l5.m1.2.2.2.3.cmml">,</mo><msub id="alg1.l5.m1.2.2.2.2.2" xref="alg1.l5.m1.2.2.2.2.2.cmml"><mi id="alg1.l5.m1.2.2.2.2.2.2" xref="alg1.l5.m1.2.2.2.2.2.2.cmml">r</mi><mi id="alg1.l5.m1.2.2.2.2.2.3" xref="alg1.l5.m1.2.2.2.2.2.3.cmml">t</mi></msub><mo id="alg1.l5.m1.2.2.2.2.5" stretchy="false" xref="alg1.l5.m1.2.2.2.3.cmml">)</mo></mrow><mo id="alg1.l5.m1.4.4.5" xref="alg1.l5.m1.4.4.5.cmml">∼</mo><mrow id="alg1.l5.m1.4.4.4.2" xref="alg1.l5.m1.4.4.4.3.cmml"><mrow id="alg1.l5.m1.3.3.3.1.1" xref="alg1.l5.m1.3.3.3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l5.m1.3.3.3.1.1.4" xref="alg1.l5.m1.3.3.3.1.1.4.cmml">𝒫</mi><mo id="alg1.l5.m1.3.3.3.1.1.3" xref="alg1.l5.m1.3.3.3.1.1.3.cmml">⁢</mo><mrow id="alg1.l5.m1.3.3.3.1.1.2.2" xref="alg1.l5.m1.3.3.3.1.1.2.3.cmml"><mo id="alg1.l5.m1.3.3.3.1.1.2.2.3" stretchy="false" xref="alg1.l5.m1.3.3.3.1.1.2.3.cmml">(</mo><msub id="alg1.l5.m1.3.3.3.1.1.1.1.1" xref="alg1.l5.m1.3.3.3.1.1.1.1.1.cmml"><mi id="alg1.l5.m1.3.3.3.1.1.1.1.1.2" xref="alg1.l5.m1.3.3.3.1.1.1.1.1.2.cmml">s</mi><mi id="alg1.l5.m1.3.3.3.1.1.1.1.1.3" xref="alg1.l5.m1.3.3.3.1.1.1.1.1.3.cmml">t</mi></msub><mo id="alg1.l5.m1.3.3.3.1.1.2.2.4" xref="alg1.l5.m1.3.3.3.1.1.2.3.cmml">,</mo><msub id="alg1.l5.m1.3.3.3.1.1.2.2.2" xref="alg1.l5.m1.3.3.3.1.1.2.2.2.cmml"><mi id="alg1.l5.m1.3.3.3.1.1.2.2.2.2" xref="alg1.l5.m1.3.3.3.1.1.2.2.2.2.cmml">a</mi><mi id="alg1.l5.m1.3.3.3.1.1.2.2.2.3" xref="alg1.l5.m1.3.3.3.1.1.2.2.2.3.cmml">t</mi></msub><mo id="alg1.l5.m1.3.3.3.1.1.2.2.5" stretchy="false" xref="alg1.l5.m1.3.3.3.1.1.2.3.cmml">)</mo></mrow></mrow><mo id="alg1.l5.m1.4.4.4.2.3" xref="alg1.l5.m1.4.4.4.3.cmml">,</mo><mrow id="alg1.l5.m1.4.4.4.2.2" xref="alg1.l5.m1.4.4.4.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l5.m1.4.4.4.2.2.4" xref="alg1.l5.m1.4.4.4.2.2.4.cmml">ℛ</mi><mo id="alg1.l5.m1.4.4.4.2.2.3" xref="alg1.l5.m1.4.4.4.2.2.3.cmml">⁢</mo><mrow id="alg1.l5.m1.4.4.4.2.2.2.2" xref="alg1.l5.m1.4.4.4.2.2.2.3.cmml"><mo id="alg1.l5.m1.4.4.4.2.2.2.2.3" stretchy="false" xref="alg1.l5.m1.4.4.4.2.2.2.3.cmml">(</mo><msub id="alg1.l5.m1.4.4.4.2.2.1.1.1" xref="alg1.l5.m1.4.4.4.2.2.1.1.1.cmml"><mi id="alg1.l5.m1.4.4.4.2.2.1.1.1.2" xref="alg1.l5.m1.4.4.4.2.2.1.1.1.2.cmml">s</mi><mi id="alg1.l5.m1.4.4.4.2.2.1.1.1.3" xref="alg1.l5.m1.4.4.4.2.2.1.1.1.3.cmml">t</mi></msub><mo id="alg1.l5.m1.4.4.4.2.2.2.2.4" xref="alg1.l5.m1.4.4.4.2.2.2.3.cmml">,</mo><msub id="alg1.l5.m1.4.4.4.2.2.2.2.2" xref="alg1.l5.m1.4.4.4.2.2.2.2.2.cmml"><mi id="alg1.l5.m1.4.4.4.2.2.2.2.2.2" xref="alg1.l5.m1.4.4.4.2.2.2.2.2.2.cmml">a</mi><mi id="alg1.l5.m1.4.4.4.2.2.2.2.2.3" xref="alg1.l5.m1.4.4.4.2.2.2.2.2.3.cmml">t</mi></msub><mo id="alg1.l5.m1.4.4.4.2.2.2.2.5" stretchy="false" xref="alg1.l5.m1.4.4.4.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l5.m1.4b"><apply id="alg1.l5.m1.4.4.cmml" xref="alg1.l5.m1.4.4"><csymbol cd="latexml" id="alg1.l5.m1.4.4.5.cmml" xref="alg1.l5.m1.4.4.5">similar-to</csymbol><interval closure="open" id="alg1.l5.m1.2.2.2.3.cmml" xref="alg1.l5.m1.2.2.2.2"><apply id="alg1.l5.m1.1.1.1.1.1.cmml" xref="alg1.l5.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l5.m1.1.1.1.1.1.1.cmml" xref="alg1.l5.m1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l5.m1.1.1.1.1.1.2.cmml" xref="alg1.l5.m1.1.1.1.1.1.2">𝑠</ci><apply id="alg1.l5.m1.1.1.1.1.1.3.cmml" xref="alg1.l5.m1.1.1.1.1.1.3"><plus id="alg1.l5.m1.1.1.1.1.1.3.1.cmml" xref="alg1.l5.m1.1.1.1.1.1.3.1"></plus><ci id="alg1.l5.m1.1.1.1.1.1.3.2.cmml" xref="alg1.l5.m1.1.1.1.1.1.3.2">𝑡</ci><cn id="alg1.l5.m1.1.1.1.1.1.3.3.cmml" type="integer" xref="alg1.l5.m1.1.1.1.1.1.3.3">1</cn></apply></apply><apply id="alg1.l5.m1.2.2.2.2.2.cmml" xref="alg1.l5.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l5.m1.2.2.2.2.2.1.cmml" xref="alg1.l5.m1.2.2.2.2.2">subscript</csymbol><ci id="alg1.l5.m1.2.2.2.2.2.2.cmml" xref="alg1.l5.m1.2.2.2.2.2.2">𝑟</ci><ci id="alg1.l5.m1.2.2.2.2.2.3.cmml" xref="alg1.l5.m1.2.2.2.2.2.3">𝑡</ci></apply></interval><list id="alg1.l5.m1.4.4.4.3.cmml" xref="alg1.l5.m1.4.4.4.2"><apply id="alg1.l5.m1.3.3.3.1.1.cmml" xref="alg1.l5.m1.3.3.3.1.1"><times id="alg1.l5.m1.3.3.3.1.1.3.cmml" xref="alg1.l5.m1.3.3.3.1.1.3"></times><ci id="alg1.l5.m1.3.3.3.1.1.4.cmml" xref="alg1.l5.m1.3.3.3.1.1.4">𝒫</ci><interval closure="open" id="alg1.l5.m1.3.3.3.1.1.2.3.cmml" xref="alg1.l5.m1.3.3.3.1.1.2.2"><apply id="alg1.l5.m1.3.3.3.1.1.1.1.1.cmml" xref="alg1.l5.m1.3.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l5.m1.3.3.3.1.1.1.1.1.1.cmml" xref="alg1.l5.m1.3.3.3.1.1.1.1.1">subscript</csymbol><ci id="alg1.l5.m1.3.3.3.1.1.1.1.1.2.cmml" xref="alg1.l5.m1.3.3.3.1.1.1.1.1.2">𝑠</ci><ci id="alg1.l5.m1.3.3.3.1.1.1.1.1.3.cmml" xref="alg1.l5.m1.3.3.3.1.1.1.1.1.3">𝑡</ci></apply><apply id="alg1.l5.m1.3.3.3.1.1.2.2.2.cmml" xref="alg1.l5.m1.3.3.3.1.1.2.2.2"><csymbol cd="ambiguous" id="alg1.l5.m1.3.3.3.1.1.2.2.2.1.cmml" xref="alg1.l5.m1.3.3.3.1.1.2.2.2">subscript</csymbol><ci id="alg1.l5.m1.3.3.3.1.1.2.2.2.2.cmml" xref="alg1.l5.m1.3.3.3.1.1.2.2.2.2">𝑎</ci><ci id="alg1.l5.m1.3.3.3.1.1.2.2.2.3.cmml" xref="alg1.l5.m1.3.3.3.1.1.2.2.2.3">𝑡</ci></apply></interval></apply><apply id="alg1.l5.m1.4.4.4.2.2.cmml" xref="alg1.l5.m1.4.4.4.2.2"><times id="alg1.l5.m1.4.4.4.2.2.3.cmml" xref="alg1.l5.m1.4.4.4.2.2.3"></times><ci id="alg1.l5.m1.4.4.4.2.2.4.cmml" xref="alg1.l5.m1.4.4.4.2.2.4">ℛ</ci><interval closure="open" id="alg1.l5.m1.4.4.4.2.2.2.3.cmml" xref="alg1.l5.m1.4.4.4.2.2.2.2"><apply id="alg1.l5.m1.4.4.4.2.2.1.1.1.cmml" xref="alg1.l5.m1.4.4.4.2.2.1.1.1"><csymbol cd="ambiguous" id="alg1.l5.m1.4.4.4.2.2.1.1.1.1.cmml" xref="alg1.l5.m1.4.4.4.2.2.1.1.1">subscript</csymbol><ci id="alg1.l5.m1.4.4.4.2.2.1.1.1.2.cmml" xref="alg1.l5.m1.4.4.4.2.2.1.1.1.2">𝑠</ci><ci id="alg1.l5.m1.4.4.4.2.2.1.1.1.3.cmml" xref="alg1.l5.m1.4.4.4.2.2.1.1.1.3">𝑡</ci></apply><apply id="alg1.l5.m1.4.4.4.2.2.2.2.2.cmml" xref="alg1.l5.m1.4.4.4.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l5.m1.4.4.4.2.2.2.2.2.1.cmml" xref="alg1.l5.m1.4.4.4.2.2.2.2.2">subscript</csymbol><ci id="alg1.l5.m1.4.4.4.2.2.2.2.2.2.cmml" xref="alg1.l5.m1.4.4.4.2.2.2.2.2.2">𝑎</ci><ci id="alg1.l5.m1.4.4.4.2.2.2.2.2.3.cmml" xref="alg1.l5.m1.4.4.4.2.2.2.2.2.3">𝑡</ci></apply></interval></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m1.4c">(s_{t+1},r_{t})\sim{\mathcal{P}}(s_{t},a_{t}),\mathcal{R}(s_{t},a_{t})</annotation><annotation encoding="application/x-llamapun" id="alg1.l5.m1.4d">( italic_s start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT , italic_r start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) ∼ caligraphic_P ( italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) , caligraphic_R ( italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math> {Execute action against the environment}

</div>
<div class="ltx_listingline" id="alg1.l6">
<span class="ltx_tag ltx_tag_listingline">6:</span>        <math alttext="\mathcal{B}\leftarrow\mathcal{B}\cup(s_{t},a_{t},r_{t},s_{t+1})" class="ltx_Math" display="inline" id="alg1.l6.m1.4"><semantics id="alg1.l6.m1.4a"><mrow id="alg1.l6.m1.4.4" xref="alg1.l6.m1.4.4.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l6.m1.4.4.6" xref="alg1.l6.m1.4.4.6.cmml">ℬ</mi><mo id="alg1.l6.m1.4.4.5" stretchy="false" xref="alg1.l6.m1.4.4.5.cmml">←</mo><mrow id="alg1.l6.m1.4.4.4" xref="alg1.l6.m1.4.4.4.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l6.m1.4.4.4.6" xref="alg1.l6.m1.4.4.4.6.cmml">ℬ</mi><mo id="alg1.l6.m1.4.4.4.5" xref="alg1.l6.m1.4.4.4.5.cmml">∪</mo><mrow id="alg1.l6.m1.4.4.4.4.4" xref="alg1.l6.m1.4.4.4.4.5.cmml"><mo id="alg1.l6.m1.4.4.4.4.4.5" stretchy="false" xref="alg1.l6.m1.4.4.4.4.5.cmml">(</mo><msub id="alg1.l6.m1.1.1.1.1.1.1" xref="alg1.l6.m1.1.1.1.1.1.1.cmml"><mi id="alg1.l6.m1.1.1.1.1.1.1.2" xref="alg1.l6.m1.1.1.1.1.1.1.2.cmml">s</mi><mi id="alg1.l6.m1.1.1.1.1.1.1.3" xref="alg1.l6.m1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="alg1.l6.m1.4.4.4.4.4.6" xref="alg1.l6.m1.4.4.4.4.5.cmml">,</mo><msub id="alg1.l6.m1.2.2.2.2.2.2" xref="alg1.l6.m1.2.2.2.2.2.2.cmml"><mi id="alg1.l6.m1.2.2.2.2.2.2.2" xref="alg1.l6.m1.2.2.2.2.2.2.2.cmml">a</mi><mi id="alg1.l6.m1.2.2.2.2.2.2.3" xref="alg1.l6.m1.2.2.2.2.2.2.3.cmml">t</mi></msub><mo id="alg1.l6.m1.4.4.4.4.4.7" xref="alg1.l6.m1.4.4.4.4.5.cmml">,</mo><msub id="alg1.l6.m1.3.3.3.3.3.3" xref="alg1.l6.m1.3.3.3.3.3.3.cmml"><mi id="alg1.l6.m1.3.3.3.3.3.3.2" xref="alg1.l6.m1.3.3.3.3.3.3.2.cmml">r</mi><mi id="alg1.l6.m1.3.3.3.3.3.3.3" xref="alg1.l6.m1.3.3.3.3.3.3.3.cmml">t</mi></msub><mo id="alg1.l6.m1.4.4.4.4.4.8" xref="alg1.l6.m1.4.4.4.4.5.cmml">,</mo><msub id="alg1.l6.m1.4.4.4.4.4.4" xref="alg1.l6.m1.4.4.4.4.4.4.cmml"><mi id="alg1.l6.m1.4.4.4.4.4.4.2" xref="alg1.l6.m1.4.4.4.4.4.4.2.cmml">s</mi><mrow id="alg1.l6.m1.4.4.4.4.4.4.3" xref="alg1.l6.m1.4.4.4.4.4.4.3.cmml"><mi id="alg1.l6.m1.4.4.4.4.4.4.3.2" xref="alg1.l6.m1.4.4.4.4.4.4.3.2.cmml">t</mi><mo id="alg1.l6.m1.4.4.4.4.4.4.3.1" xref="alg1.l6.m1.4.4.4.4.4.4.3.1.cmml">+</mo><mn id="alg1.l6.m1.4.4.4.4.4.4.3.3" xref="alg1.l6.m1.4.4.4.4.4.4.3.3.cmml">1</mn></mrow></msub><mo id="alg1.l6.m1.4.4.4.4.4.9" stretchy="false" xref="alg1.l6.m1.4.4.4.4.5.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l6.m1.4b"><apply id="alg1.l6.m1.4.4.cmml" xref="alg1.l6.m1.4.4"><ci id="alg1.l6.m1.4.4.5.cmml" xref="alg1.l6.m1.4.4.5">←</ci><ci id="alg1.l6.m1.4.4.6.cmml" xref="alg1.l6.m1.4.4.6">ℬ</ci><apply id="alg1.l6.m1.4.4.4.cmml" xref="alg1.l6.m1.4.4.4"><union id="alg1.l6.m1.4.4.4.5.cmml" xref="alg1.l6.m1.4.4.4.5"></union><ci id="alg1.l6.m1.4.4.4.6.cmml" xref="alg1.l6.m1.4.4.4.6">ℬ</ci><vector id="alg1.l6.m1.4.4.4.4.5.cmml" xref="alg1.l6.m1.4.4.4.4.4"><apply id="alg1.l6.m1.1.1.1.1.1.1.cmml" xref="alg1.l6.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l6.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l6.m1.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l6.m1.1.1.1.1.1.1.2.cmml" xref="alg1.l6.m1.1.1.1.1.1.1.2">𝑠</ci><ci id="alg1.l6.m1.1.1.1.1.1.1.3.cmml" xref="alg1.l6.m1.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="alg1.l6.m1.2.2.2.2.2.2.cmml" xref="alg1.l6.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l6.m1.2.2.2.2.2.2.1.cmml" xref="alg1.l6.m1.2.2.2.2.2.2">subscript</csymbol><ci id="alg1.l6.m1.2.2.2.2.2.2.2.cmml" xref="alg1.l6.m1.2.2.2.2.2.2.2">𝑎</ci><ci id="alg1.l6.m1.2.2.2.2.2.2.3.cmml" xref="alg1.l6.m1.2.2.2.2.2.2.3">𝑡</ci></apply><apply id="alg1.l6.m1.3.3.3.3.3.3.cmml" xref="alg1.l6.m1.3.3.3.3.3.3"><csymbol cd="ambiguous" id="alg1.l6.m1.3.3.3.3.3.3.1.cmml" xref="alg1.l6.m1.3.3.3.3.3.3">subscript</csymbol><ci id="alg1.l6.m1.3.3.3.3.3.3.2.cmml" xref="alg1.l6.m1.3.3.3.3.3.3.2">𝑟</ci><ci id="alg1.l6.m1.3.3.3.3.3.3.3.cmml" xref="alg1.l6.m1.3.3.3.3.3.3.3">𝑡</ci></apply><apply id="alg1.l6.m1.4.4.4.4.4.4.cmml" xref="alg1.l6.m1.4.4.4.4.4.4"><csymbol cd="ambiguous" id="alg1.l6.m1.4.4.4.4.4.4.1.cmml" xref="alg1.l6.m1.4.4.4.4.4.4">subscript</csymbol><ci id="alg1.l6.m1.4.4.4.4.4.4.2.cmml" xref="alg1.l6.m1.4.4.4.4.4.4.2">𝑠</ci><apply id="alg1.l6.m1.4.4.4.4.4.4.3.cmml" xref="alg1.l6.m1.4.4.4.4.4.4.3"><plus id="alg1.l6.m1.4.4.4.4.4.4.3.1.cmml" xref="alg1.l6.m1.4.4.4.4.4.4.3.1"></plus><ci id="alg1.l6.m1.4.4.4.4.4.4.3.2.cmml" xref="alg1.l6.m1.4.4.4.4.4.4.3.2">𝑡</ci><cn id="alg1.l6.m1.4.4.4.4.4.4.3.3.cmml" type="integer" xref="alg1.l6.m1.4.4.4.4.4.4.3.3">1</cn></apply></apply></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m1.4c">\mathcal{B}\leftarrow\mathcal{B}\cup(s_{t},a_{t},r_{t},s_{t+1})</annotation><annotation encoding="application/x-llamapun" id="alg1.l6.m1.4d">caligraphic_B ← caligraphic_B ∪ ( italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_r start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_s start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT )</annotation></semantics></math> {Add to buffer}

</div>
<div class="ltx_listingline" id="alg1.l7">
<span class="ltx_tag ltx_tag_listingline">7:</span>     <span class="ltx_text ltx_font_bold" id="alg1.l7.1">end</span> <span class="ltx_text ltx_font_bold" id="alg1.l7.2">for</span>
</div>
<div class="ltx_listingline" id="alg1.l8">
<span class="ltx_tag ltx_tag_listingline">8:</span>     <span class="ltx_text ltx_font_italic" id="alg1.l8.1">// Update model parameters</span>
</div>
<div class="ltx_listingline" id="alg1.l9">
<span class="ltx_tag ltx_tag_listingline">9:</span>     <math alttext="\theta_{0}=\theta" class="ltx_Math" display="inline" id="alg1.l9.m1.1"><semantics id="alg1.l9.m1.1a"><mrow id="alg1.l9.m1.1.1" xref="alg1.l9.m1.1.1.cmml"><msub id="alg1.l9.m1.1.1.2" xref="alg1.l9.m1.1.1.2.cmml"><mi id="alg1.l9.m1.1.1.2.2" xref="alg1.l9.m1.1.1.2.2.cmml">θ</mi><mn id="alg1.l9.m1.1.1.2.3" xref="alg1.l9.m1.1.1.2.3.cmml">0</mn></msub><mo id="alg1.l9.m1.1.1.1" xref="alg1.l9.m1.1.1.1.cmml">=</mo><mi id="alg1.l9.m1.1.1.3" xref="alg1.l9.m1.1.1.3.cmml">θ</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l9.m1.1b"><apply id="alg1.l9.m1.1.1.cmml" xref="alg1.l9.m1.1.1"><eq id="alg1.l9.m1.1.1.1.cmml" xref="alg1.l9.m1.1.1.1"></eq><apply id="alg1.l9.m1.1.1.2.cmml" xref="alg1.l9.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l9.m1.1.1.2.1.cmml" xref="alg1.l9.m1.1.1.2">subscript</csymbol><ci id="alg1.l9.m1.1.1.2.2.cmml" xref="alg1.l9.m1.1.1.2.2">𝜃</ci><cn id="alg1.l9.m1.1.1.2.3.cmml" type="integer" xref="alg1.l9.m1.1.1.2.3">0</cn></apply><ci id="alg1.l9.m1.1.1.3.cmml" xref="alg1.l9.m1.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m1.1c">\theta_{0}=\theta</annotation><annotation encoding="application/x-llamapun" id="alg1.l9.m1.1d">italic_θ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT = italic_θ</annotation></semantics></math> {Initialize <math alttext="\theta_{0}" class="ltx_Math" display="inline" id="alg1.l9.m2.1"><semantics id="alg1.l9.m2.1a"><msub id="alg1.l9.m2.1.1" xref="alg1.l9.m2.1.1.cmml"><mi id="alg1.l9.m2.1.1.2" xref="alg1.l9.m2.1.1.2.cmml">θ</mi><mn id="alg1.l9.m2.1.1.3" xref="alg1.l9.m2.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="alg1.l9.m2.1b"><apply id="alg1.l9.m2.1.1.cmml" xref="alg1.l9.m2.1.1"><csymbol cd="ambiguous" id="alg1.l9.m2.1.1.1.cmml" xref="alg1.l9.m2.1.1">subscript</csymbol><ci id="alg1.l9.m2.1.1.2.cmml" xref="alg1.l9.m2.1.1.2">𝜃</ci><cn id="alg1.l9.m2.1.1.3.cmml" type="integer" xref="alg1.l9.m2.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m2.1c">\theta_{0}</annotation><annotation encoding="application/x-llamapun" id="alg1.l9.m2.1d">italic_θ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math> with current parameter}

</div>
<div class="ltx_listingline" id="alg1.l10">
<span class="ltx_tag ltx_tag_listingline">10:</span>     <span class="ltx_text ltx_font_bold" id="alg1.l10.1">for</span> <math alttext="k=0\dots K" class="ltx_Math" display="inline" id="alg1.l10.m1.1"><semantics id="alg1.l10.m1.1a"><mrow id="alg1.l10.m1.1.1" xref="alg1.l10.m1.1.1.cmml"><mi id="alg1.l10.m1.1.1.2" xref="alg1.l10.m1.1.1.2.cmml">k</mi><mo id="alg1.l10.m1.1.1.1" xref="alg1.l10.m1.1.1.1.cmml">=</mo><mrow id="alg1.l10.m1.1.1.3" xref="alg1.l10.m1.1.1.3.cmml"><mn id="alg1.l10.m1.1.1.3.2" xref="alg1.l10.m1.1.1.3.2.cmml">0</mn><mo id="alg1.l10.m1.1.1.3.1" xref="alg1.l10.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l10.m1.1.1.3.3" mathvariant="normal" xref="alg1.l10.m1.1.1.3.3.cmml">…</mi><mo id="alg1.l10.m1.1.1.3.1a" xref="alg1.l10.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l10.m1.1.1.3.4" xref="alg1.l10.m1.1.1.3.4.cmml">K</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l10.m1.1b"><apply id="alg1.l10.m1.1.1.cmml" xref="alg1.l10.m1.1.1"><eq id="alg1.l10.m1.1.1.1.cmml" xref="alg1.l10.m1.1.1.1"></eq><ci id="alg1.l10.m1.1.1.2.cmml" xref="alg1.l10.m1.1.1.2">𝑘</ci><apply id="alg1.l10.m1.1.1.3.cmml" xref="alg1.l10.m1.1.1.3"><times id="alg1.l10.m1.1.1.3.1.cmml" xref="alg1.l10.m1.1.1.3.1"></times><cn id="alg1.l10.m1.1.1.3.2.cmml" type="integer" xref="alg1.l10.m1.1.1.3.2">0</cn><ci id="alg1.l10.m1.1.1.3.3.cmml" xref="alg1.l10.m1.1.1.3.3">…</ci><ci id="alg1.l10.m1.1.1.3.4.cmml" xref="alg1.l10.m1.1.1.3.4">𝐾</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m1.1c">k=0\dots K</annotation><annotation encoding="application/x-llamapun" id="alg1.l10.m1.1d">italic_k = 0 … italic_K</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="alg1.l10.2">do</span>
</div>
<div class="ltx_listingline" id="alg1.l11">
<span class="ltx_tag ltx_tag_listingline">11:</span>        <math alttext="\{s_{t:t+H+1},a_{t:t+H},r_{t:t+H}\}\sim\mathcal{B}" class="ltx_Math" display="inline" id="alg1.l11.m1.3"><semantics id="alg1.l11.m1.3a"><mrow id="alg1.l11.m1.3.3" xref="alg1.l11.m1.3.3.cmml"><mrow id="alg1.l11.m1.3.3.3.3" xref="alg1.l11.m1.3.3.3.4.cmml"><mo id="alg1.l11.m1.3.3.3.3.4" stretchy="false" xref="alg1.l11.m1.3.3.3.4.cmml">{</mo><msub id="alg1.l11.m1.1.1.1.1.1" xref="alg1.l11.m1.1.1.1.1.1.cmml"><mi id="alg1.l11.m1.1.1.1.1.1.2" xref="alg1.l11.m1.1.1.1.1.1.2.cmml">s</mi><mrow id="alg1.l11.m1.1.1.1.1.1.3" xref="alg1.l11.m1.1.1.1.1.1.3.cmml"><mi id="alg1.l11.m1.1.1.1.1.1.3.2" xref="alg1.l11.m1.1.1.1.1.1.3.2.cmml">t</mi><mo id="alg1.l11.m1.1.1.1.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="alg1.l11.m1.1.1.1.1.1.3.1.cmml">:</mo><mrow id="alg1.l11.m1.1.1.1.1.1.3.3" xref="alg1.l11.m1.1.1.1.1.1.3.3.cmml"><mi id="alg1.l11.m1.1.1.1.1.1.3.3.2" xref="alg1.l11.m1.1.1.1.1.1.3.3.2.cmml">t</mi><mo id="alg1.l11.m1.1.1.1.1.1.3.3.1" xref="alg1.l11.m1.1.1.1.1.1.3.3.1.cmml">+</mo><mi id="alg1.l11.m1.1.1.1.1.1.3.3.3" xref="alg1.l11.m1.1.1.1.1.1.3.3.3.cmml">H</mi><mo id="alg1.l11.m1.1.1.1.1.1.3.3.1a" xref="alg1.l11.m1.1.1.1.1.1.3.3.1.cmml">+</mo><mn id="alg1.l11.m1.1.1.1.1.1.3.3.4" xref="alg1.l11.m1.1.1.1.1.1.3.3.4.cmml">1</mn></mrow></mrow></msub><mo id="alg1.l11.m1.3.3.3.3.5" xref="alg1.l11.m1.3.3.3.4.cmml">,</mo><msub id="alg1.l11.m1.2.2.2.2.2" xref="alg1.l11.m1.2.2.2.2.2.cmml"><mi id="alg1.l11.m1.2.2.2.2.2.2" xref="alg1.l11.m1.2.2.2.2.2.2.cmml">a</mi><mrow id="alg1.l11.m1.2.2.2.2.2.3" xref="alg1.l11.m1.2.2.2.2.2.3.cmml"><mi id="alg1.l11.m1.2.2.2.2.2.3.2" xref="alg1.l11.m1.2.2.2.2.2.3.2.cmml">t</mi><mo id="alg1.l11.m1.2.2.2.2.2.3.1" lspace="0.278em" rspace="0.278em" xref="alg1.l11.m1.2.2.2.2.2.3.1.cmml">:</mo><mrow id="alg1.l11.m1.2.2.2.2.2.3.3" xref="alg1.l11.m1.2.2.2.2.2.3.3.cmml"><mi id="alg1.l11.m1.2.2.2.2.2.3.3.2" xref="alg1.l11.m1.2.2.2.2.2.3.3.2.cmml">t</mi><mo id="alg1.l11.m1.2.2.2.2.2.3.3.1" xref="alg1.l11.m1.2.2.2.2.2.3.3.1.cmml">+</mo><mi id="alg1.l11.m1.2.2.2.2.2.3.3.3" xref="alg1.l11.m1.2.2.2.2.2.3.3.3.cmml">H</mi></mrow></mrow></msub><mo id="alg1.l11.m1.3.3.3.3.6" xref="alg1.l11.m1.3.3.3.4.cmml">,</mo><msub id="alg1.l11.m1.3.3.3.3.3" xref="alg1.l11.m1.3.3.3.3.3.cmml"><mi id="alg1.l11.m1.3.3.3.3.3.2" xref="alg1.l11.m1.3.3.3.3.3.2.cmml">r</mi><mrow id="alg1.l11.m1.3.3.3.3.3.3" xref="alg1.l11.m1.3.3.3.3.3.3.cmml"><mi id="alg1.l11.m1.3.3.3.3.3.3.2" xref="alg1.l11.m1.3.3.3.3.3.3.2.cmml">t</mi><mo id="alg1.l11.m1.3.3.3.3.3.3.1" lspace="0.278em" rspace="0.278em" xref="alg1.l11.m1.3.3.3.3.3.3.1.cmml">:</mo><mrow id="alg1.l11.m1.3.3.3.3.3.3.3" xref="alg1.l11.m1.3.3.3.3.3.3.3.cmml"><mi id="alg1.l11.m1.3.3.3.3.3.3.3.2" xref="alg1.l11.m1.3.3.3.3.3.3.3.2.cmml">t</mi><mo id="alg1.l11.m1.3.3.3.3.3.3.3.1" xref="alg1.l11.m1.3.3.3.3.3.3.3.1.cmml">+</mo><mi id="alg1.l11.m1.3.3.3.3.3.3.3.3" xref="alg1.l11.m1.3.3.3.3.3.3.3.3.cmml">H</mi></mrow></mrow></msub><mo id="alg1.l11.m1.3.3.3.3.7" stretchy="false" xref="alg1.l11.m1.3.3.3.4.cmml">}</mo></mrow><mo id="alg1.l11.m1.3.3.4" xref="alg1.l11.m1.3.3.4.cmml">∼</mo><mi class="ltx_font_mathcaligraphic" id="alg1.l11.m1.3.3.5" xref="alg1.l11.m1.3.3.5.cmml">ℬ</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l11.m1.3b"><apply id="alg1.l11.m1.3.3.cmml" xref="alg1.l11.m1.3.3"><csymbol cd="latexml" id="alg1.l11.m1.3.3.4.cmml" xref="alg1.l11.m1.3.3.4">similar-to</csymbol><set id="alg1.l11.m1.3.3.3.4.cmml" xref="alg1.l11.m1.3.3.3.3"><apply id="alg1.l11.m1.1.1.1.1.1.cmml" xref="alg1.l11.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l11.m1.1.1.1.1.1.1.cmml" xref="alg1.l11.m1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l11.m1.1.1.1.1.1.2.cmml" xref="alg1.l11.m1.1.1.1.1.1.2">𝑠</ci><apply id="alg1.l11.m1.1.1.1.1.1.3.cmml" xref="alg1.l11.m1.1.1.1.1.1.3"><ci id="alg1.l11.m1.1.1.1.1.1.3.1.cmml" xref="alg1.l11.m1.1.1.1.1.1.3.1">:</ci><ci id="alg1.l11.m1.1.1.1.1.1.3.2.cmml" xref="alg1.l11.m1.1.1.1.1.1.3.2">𝑡</ci><apply id="alg1.l11.m1.1.1.1.1.1.3.3.cmml" xref="alg1.l11.m1.1.1.1.1.1.3.3"><plus id="alg1.l11.m1.1.1.1.1.1.3.3.1.cmml" xref="alg1.l11.m1.1.1.1.1.1.3.3.1"></plus><ci id="alg1.l11.m1.1.1.1.1.1.3.3.2.cmml" xref="alg1.l11.m1.1.1.1.1.1.3.3.2">𝑡</ci><ci id="alg1.l11.m1.1.1.1.1.1.3.3.3.cmml" xref="alg1.l11.m1.1.1.1.1.1.3.3.3">𝐻</ci><cn id="alg1.l11.m1.1.1.1.1.1.3.3.4.cmml" type="integer" xref="alg1.l11.m1.1.1.1.1.1.3.3.4">1</cn></apply></apply></apply><apply id="alg1.l11.m1.2.2.2.2.2.cmml" xref="alg1.l11.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l11.m1.2.2.2.2.2.1.cmml" xref="alg1.l11.m1.2.2.2.2.2">subscript</csymbol><ci id="alg1.l11.m1.2.2.2.2.2.2.cmml" xref="alg1.l11.m1.2.2.2.2.2.2">𝑎</ci><apply id="alg1.l11.m1.2.2.2.2.2.3.cmml" xref="alg1.l11.m1.2.2.2.2.2.3"><ci id="alg1.l11.m1.2.2.2.2.2.3.1.cmml" xref="alg1.l11.m1.2.2.2.2.2.3.1">:</ci><ci id="alg1.l11.m1.2.2.2.2.2.3.2.cmml" xref="alg1.l11.m1.2.2.2.2.2.3.2">𝑡</ci><apply id="alg1.l11.m1.2.2.2.2.2.3.3.cmml" xref="alg1.l11.m1.2.2.2.2.2.3.3"><plus id="alg1.l11.m1.2.2.2.2.2.3.3.1.cmml" xref="alg1.l11.m1.2.2.2.2.2.3.3.1"></plus><ci id="alg1.l11.m1.2.2.2.2.2.3.3.2.cmml" xref="alg1.l11.m1.2.2.2.2.2.3.3.2">𝑡</ci><ci id="alg1.l11.m1.2.2.2.2.2.3.3.3.cmml" xref="alg1.l11.m1.2.2.2.2.2.3.3.3">𝐻</ci></apply></apply></apply><apply id="alg1.l11.m1.3.3.3.3.3.cmml" xref="alg1.l11.m1.3.3.3.3.3"><csymbol cd="ambiguous" id="alg1.l11.m1.3.3.3.3.3.1.cmml" xref="alg1.l11.m1.3.3.3.3.3">subscript</csymbol><ci id="alg1.l11.m1.3.3.3.3.3.2.cmml" xref="alg1.l11.m1.3.3.3.3.3.2">𝑟</ci><apply id="alg1.l11.m1.3.3.3.3.3.3.cmml" xref="alg1.l11.m1.3.3.3.3.3.3"><ci id="alg1.l11.m1.3.3.3.3.3.3.1.cmml" xref="alg1.l11.m1.3.3.3.3.3.3.1">:</ci><ci id="alg1.l11.m1.3.3.3.3.3.3.2.cmml" xref="alg1.l11.m1.3.3.3.3.3.3.2">𝑡</ci><apply id="alg1.l11.m1.3.3.3.3.3.3.3.cmml" xref="alg1.l11.m1.3.3.3.3.3.3.3"><plus id="alg1.l11.m1.3.3.3.3.3.3.3.1.cmml" xref="alg1.l11.m1.3.3.3.3.3.3.3.1"></plus><ci id="alg1.l11.m1.3.3.3.3.3.3.3.2.cmml" xref="alg1.l11.m1.3.3.3.3.3.3.3.2">𝑡</ci><ci id="alg1.l11.m1.3.3.3.3.3.3.3.3.cmml" xref="alg1.l11.m1.3.3.3.3.3.3.3.3">𝐻</ci></apply></apply></apply></set><ci id="alg1.l11.m1.3.3.5.cmml" xref="alg1.l11.m1.3.3.5">ℬ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l11.m1.3c">\{s_{t:t+H+1},a_{t:t+H},r_{t:t+H}\}\sim\mathcal{B}</annotation><annotation encoding="application/x-llamapun" id="alg1.l11.m1.3d">{ italic_s start_POSTSUBSCRIPT italic_t : italic_t + italic_H + 1 end_POSTSUBSCRIPT , italic_a start_POSTSUBSCRIPT italic_t : italic_t + italic_H end_POSTSUBSCRIPT , italic_r start_POSTSUBSCRIPT italic_t : italic_t + italic_H end_POSTSUBSCRIPT } ∼ caligraphic_B</annotation></semantics></math> {Sample a trajectory with horizon <math alttext="H" class="ltx_Math" display="inline" id="alg1.l11.m2.1"><semantics id="alg1.l11.m2.1a"><mi id="alg1.l11.m2.1.1" xref="alg1.l11.m2.1.1.cmml">H</mi><annotation-xml encoding="MathML-Content" id="alg1.l11.m2.1b"><ci id="alg1.l11.m2.1.1.cmml" xref="alg1.l11.m2.1.1">𝐻</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l11.m2.1c">H</annotation><annotation encoding="application/x-llamapun" id="alg1.l11.m2.1d">italic_H</annotation></semantics></math> from the buffer <math alttext="\mathcal{B}" class="ltx_Math" display="inline" id="alg1.l11.m3.1"><semantics id="alg1.l11.m3.1a"><mi class="ltx_font_mathcaligraphic" id="alg1.l11.m3.1.1" xref="alg1.l11.m3.1.1.cmml">ℬ</mi><annotation-xml encoding="MathML-Content" id="alg1.l11.m3.1b"><ci id="alg1.l11.m3.1.1.cmml" xref="alg1.l11.m3.1.1">ℬ</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l11.m3.1c">\mathcal{B}</annotation><annotation encoding="application/x-llamapun" id="alg1.l11.m3.1d">caligraphic_B</annotation></semantics></math>}

</div>
<div class="ltx_listingline" id="alg1.l12">
<span class="ltx_tag ltx_tag_listingline">12:</span>        <math alttext="z_{t:t+H+1}=h_{\theta^{h}_{k}}(s_{t:t+H+1})" class="ltx_Math" display="inline" id="alg1.l12.m1.1"><semantics id="alg1.l12.m1.1a"><mrow id="alg1.l12.m1.1.1" xref="alg1.l12.m1.1.1.cmml"><msub id="alg1.l12.m1.1.1.3" xref="alg1.l12.m1.1.1.3.cmml"><mi id="alg1.l12.m1.1.1.3.2" xref="alg1.l12.m1.1.1.3.2.cmml">z</mi><mrow id="alg1.l12.m1.1.1.3.3" xref="alg1.l12.m1.1.1.3.3.cmml"><mi id="alg1.l12.m1.1.1.3.3.2" xref="alg1.l12.m1.1.1.3.3.2.cmml">t</mi><mo id="alg1.l12.m1.1.1.3.3.1" lspace="0.278em" rspace="0.278em" xref="alg1.l12.m1.1.1.3.3.1.cmml">:</mo><mrow id="alg1.l12.m1.1.1.3.3.3" xref="alg1.l12.m1.1.1.3.3.3.cmml"><mi id="alg1.l12.m1.1.1.3.3.3.2" xref="alg1.l12.m1.1.1.3.3.3.2.cmml">t</mi><mo id="alg1.l12.m1.1.1.3.3.3.1" xref="alg1.l12.m1.1.1.3.3.3.1.cmml">+</mo><mi id="alg1.l12.m1.1.1.3.3.3.3" xref="alg1.l12.m1.1.1.3.3.3.3.cmml">H</mi><mo id="alg1.l12.m1.1.1.3.3.3.1a" xref="alg1.l12.m1.1.1.3.3.3.1.cmml">+</mo><mn id="alg1.l12.m1.1.1.3.3.3.4" xref="alg1.l12.m1.1.1.3.3.3.4.cmml">1</mn></mrow></mrow></msub><mo id="alg1.l12.m1.1.1.2" xref="alg1.l12.m1.1.1.2.cmml">=</mo><mrow id="alg1.l12.m1.1.1.1" xref="alg1.l12.m1.1.1.1.cmml"><msub id="alg1.l12.m1.1.1.1.3" xref="alg1.l12.m1.1.1.1.3.cmml"><mi id="alg1.l12.m1.1.1.1.3.2" xref="alg1.l12.m1.1.1.1.3.2.cmml">h</mi><msubsup id="alg1.l12.m1.1.1.1.3.3" xref="alg1.l12.m1.1.1.1.3.3.cmml"><mi id="alg1.l12.m1.1.1.1.3.3.2.2" xref="alg1.l12.m1.1.1.1.3.3.2.2.cmml">θ</mi><mi id="alg1.l12.m1.1.1.1.3.3.3" xref="alg1.l12.m1.1.1.1.3.3.3.cmml">k</mi><mi id="alg1.l12.m1.1.1.1.3.3.2.3" xref="alg1.l12.m1.1.1.1.3.3.2.3.cmml">h</mi></msubsup></msub><mo id="alg1.l12.m1.1.1.1.2" xref="alg1.l12.m1.1.1.1.2.cmml">⁢</mo><mrow id="alg1.l12.m1.1.1.1.1.1" xref="alg1.l12.m1.1.1.1.1.1.1.cmml"><mo id="alg1.l12.m1.1.1.1.1.1.2" stretchy="false" xref="alg1.l12.m1.1.1.1.1.1.1.cmml">(</mo><msub id="alg1.l12.m1.1.1.1.1.1.1" xref="alg1.l12.m1.1.1.1.1.1.1.cmml"><mi id="alg1.l12.m1.1.1.1.1.1.1.2" xref="alg1.l12.m1.1.1.1.1.1.1.2.cmml">s</mi><mrow id="alg1.l12.m1.1.1.1.1.1.1.3" xref="alg1.l12.m1.1.1.1.1.1.1.3.cmml"><mi id="alg1.l12.m1.1.1.1.1.1.1.3.2" xref="alg1.l12.m1.1.1.1.1.1.1.3.2.cmml">t</mi><mo id="alg1.l12.m1.1.1.1.1.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="alg1.l12.m1.1.1.1.1.1.1.3.1.cmml">:</mo><mrow id="alg1.l12.m1.1.1.1.1.1.1.3.3" xref="alg1.l12.m1.1.1.1.1.1.1.3.3.cmml"><mi id="alg1.l12.m1.1.1.1.1.1.1.3.3.2" xref="alg1.l12.m1.1.1.1.1.1.1.3.3.2.cmml">t</mi><mo id="alg1.l12.m1.1.1.1.1.1.1.3.3.1" xref="alg1.l12.m1.1.1.1.1.1.1.3.3.1.cmml">+</mo><mi id="alg1.l12.m1.1.1.1.1.1.1.3.3.3" xref="alg1.l12.m1.1.1.1.1.1.1.3.3.3.cmml">H</mi><mo id="alg1.l12.m1.1.1.1.1.1.1.3.3.1a" xref="alg1.l12.m1.1.1.1.1.1.1.3.3.1.cmml">+</mo><mn id="alg1.l12.m1.1.1.1.1.1.1.3.3.4" xref="alg1.l12.m1.1.1.1.1.1.1.3.3.4.cmml">1</mn></mrow></mrow></msub><mo id="alg1.l12.m1.1.1.1.1.1.3" stretchy="false" xref="alg1.l12.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l12.m1.1b"><apply id="alg1.l12.m1.1.1.cmml" xref="alg1.l12.m1.1.1"><eq id="alg1.l12.m1.1.1.2.cmml" xref="alg1.l12.m1.1.1.2"></eq><apply id="alg1.l12.m1.1.1.3.cmml" xref="alg1.l12.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l12.m1.1.1.3.1.cmml" xref="alg1.l12.m1.1.1.3">subscript</csymbol><ci id="alg1.l12.m1.1.1.3.2.cmml" xref="alg1.l12.m1.1.1.3.2">𝑧</ci><apply id="alg1.l12.m1.1.1.3.3.cmml" xref="alg1.l12.m1.1.1.3.3"><ci id="alg1.l12.m1.1.1.3.3.1.cmml" xref="alg1.l12.m1.1.1.3.3.1">:</ci><ci id="alg1.l12.m1.1.1.3.3.2.cmml" xref="alg1.l12.m1.1.1.3.3.2">𝑡</ci><apply id="alg1.l12.m1.1.1.3.3.3.cmml" xref="alg1.l12.m1.1.1.3.3.3"><plus id="alg1.l12.m1.1.1.3.3.3.1.cmml" xref="alg1.l12.m1.1.1.3.3.3.1"></plus><ci id="alg1.l12.m1.1.1.3.3.3.2.cmml" xref="alg1.l12.m1.1.1.3.3.3.2">𝑡</ci><ci id="alg1.l12.m1.1.1.3.3.3.3.cmml" xref="alg1.l12.m1.1.1.3.3.3.3">𝐻</ci><cn id="alg1.l12.m1.1.1.3.3.3.4.cmml" type="integer" xref="alg1.l12.m1.1.1.3.3.3.4">1</cn></apply></apply></apply><apply id="alg1.l12.m1.1.1.1.cmml" xref="alg1.l12.m1.1.1.1"><times id="alg1.l12.m1.1.1.1.2.cmml" xref="alg1.l12.m1.1.1.1.2"></times><apply id="alg1.l12.m1.1.1.1.3.cmml" xref="alg1.l12.m1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l12.m1.1.1.1.3.1.cmml" xref="alg1.l12.m1.1.1.1.3">subscript</csymbol><ci id="alg1.l12.m1.1.1.1.3.2.cmml" xref="alg1.l12.m1.1.1.1.3.2">ℎ</ci><apply id="alg1.l12.m1.1.1.1.3.3.cmml" xref="alg1.l12.m1.1.1.1.3.3"><csymbol cd="ambiguous" id="alg1.l12.m1.1.1.1.3.3.1.cmml" xref="alg1.l12.m1.1.1.1.3.3">subscript</csymbol><apply id="alg1.l12.m1.1.1.1.3.3.2.cmml" xref="alg1.l12.m1.1.1.1.3.3"><csymbol cd="ambiguous" id="alg1.l12.m1.1.1.1.3.3.2.1.cmml" xref="alg1.l12.m1.1.1.1.3.3">superscript</csymbol><ci id="alg1.l12.m1.1.1.1.3.3.2.2.cmml" xref="alg1.l12.m1.1.1.1.3.3.2.2">𝜃</ci><ci id="alg1.l12.m1.1.1.1.3.3.2.3.cmml" xref="alg1.l12.m1.1.1.1.3.3.2.3">ℎ</ci></apply><ci id="alg1.l12.m1.1.1.1.3.3.3.cmml" xref="alg1.l12.m1.1.1.1.3.3.3">𝑘</ci></apply></apply><apply id="alg1.l12.m1.1.1.1.1.1.1.cmml" xref="alg1.l12.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l12.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l12.m1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l12.m1.1.1.1.1.1.1.2.cmml" xref="alg1.l12.m1.1.1.1.1.1.1.2">𝑠</ci><apply id="alg1.l12.m1.1.1.1.1.1.1.3.cmml" xref="alg1.l12.m1.1.1.1.1.1.1.3"><ci id="alg1.l12.m1.1.1.1.1.1.1.3.1.cmml" xref="alg1.l12.m1.1.1.1.1.1.1.3.1">:</ci><ci id="alg1.l12.m1.1.1.1.1.1.1.3.2.cmml" xref="alg1.l12.m1.1.1.1.1.1.1.3.2">𝑡</ci><apply id="alg1.l12.m1.1.1.1.1.1.1.3.3.cmml" xref="alg1.l12.m1.1.1.1.1.1.1.3.3"><plus id="alg1.l12.m1.1.1.1.1.1.1.3.3.1.cmml" xref="alg1.l12.m1.1.1.1.1.1.1.3.3.1"></plus><ci id="alg1.l12.m1.1.1.1.1.1.1.3.3.2.cmml" xref="alg1.l12.m1.1.1.1.1.1.1.3.3.2">𝑡</ci><ci id="alg1.l12.m1.1.1.1.1.1.1.3.3.3.cmml" xref="alg1.l12.m1.1.1.1.1.1.1.3.3.3">𝐻</ci><cn id="alg1.l12.m1.1.1.1.1.1.1.3.3.4.cmml" type="integer" xref="alg1.l12.m1.1.1.1.1.1.1.3.3.4">1</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l12.m1.1c">z_{t:t+H+1}=h_{\theta^{h}_{k}}(s_{t:t+H+1})</annotation><annotation encoding="application/x-llamapun" id="alg1.l12.m1.1d">italic_z start_POSTSUBSCRIPT italic_t : italic_t + italic_H + 1 end_POSTSUBSCRIPT = italic_h start_POSTSUBSCRIPT italic_θ start_POSTSUPERSCRIPT italic_h end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( italic_s start_POSTSUBSCRIPT italic_t : italic_t + italic_H + 1 end_POSTSUBSCRIPT )</annotation></semantics></math> {Encode all observations with online encoder}

</div>
<div class="ltx_listingline" id="alg1.l13">
<span class="ltx_tag ltx_tag_listingline">13:</span>        <math alttext="\hat{r}_{t:t+H}=R_{\theta^{R}_{k}}(z_{t:t+H},a_{t:t+H})" class="ltx_Math" display="inline" id="alg1.l13.m1.2"><semantics id="alg1.l13.m1.2a"><mrow id="alg1.l13.m1.2.2" xref="alg1.l13.m1.2.2.cmml"><msub id="alg1.l13.m1.2.2.4" xref="alg1.l13.m1.2.2.4.cmml"><mover accent="true" id="alg1.l13.m1.2.2.4.2" xref="alg1.l13.m1.2.2.4.2.cmml"><mi id="alg1.l13.m1.2.2.4.2.2" xref="alg1.l13.m1.2.2.4.2.2.cmml">r</mi><mo id="alg1.l13.m1.2.2.4.2.1" xref="alg1.l13.m1.2.2.4.2.1.cmml">^</mo></mover><mrow id="alg1.l13.m1.2.2.4.3" xref="alg1.l13.m1.2.2.4.3.cmml"><mi id="alg1.l13.m1.2.2.4.3.2" xref="alg1.l13.m1.2.2.4.3.2.cmml">t</mi><mo id="alg1.l13.m1.2.2.4.3.1" lspace="0.278em" rspace="0.278em" xref="alg1.l13.m1.2.2.4.3.1.cmml">:</mo><mrow id="alg1.l13.m1.2.2.4.3.3" xref="alg1.l13.m1.2.2.4.3.3.cmml"><mi id="alg1.l13.m1.2.2.4.3.3.2" xref="alg1.l13.m1.2.2.4.3.3.2.cmml">t</mi><mo id="alg1.l13.m1.2.2.4.3.3.1" xref="alg1.l13.m1.2.2.4.3.3.1.cmml">+</mo><mi id="alg1.l13.m1.2.2.4.3.3.3" xref="alg1.l13.m1.2.2.4.3.3.3.cmml">H</mi></mrow></mrow></msub><mo id="alg1.l13.m1.2.2.3" xref="alg1.l13.m1.2.2.3.cmml">=</mo><mrow id="alg1.l13.m1.2.2.2" xref="alg1.l13.m1.2.2.2.cmml"><msub id="alg1.l13.m1.2.2.2.4" xref="alg1.l13.m1.2.2.2.4.cmml"><mi id="alg1.l13.m1.2.2.2.4.2" xref="alg1.l13.m1.2.2.2.4.2.cmml">R</mi><msubsup id="alg1.l13.m1.2.2.2.4.3" xref="alg1.l13.m1.2.2.2.4.3.cmml"><mi id="alg1.l13.m1.2.2.2.4.3.2.2" xref="alg1.l13.m1.2.2.2.4.3.2.2.cmml">θ</mi><mi id="alg1.l13.m1.2.2.2.4.3.3" xref="alg1.l13.m1.2.2.2.4.3.3.cmml">k</mi><mi id="alg1.l13.m1.2.2.2.4.3.2.3" xref="alg1.l13.m1.2.2.2.4.3.2.3.cmml">R</mi></msubsup></msub><mo id="alg1.l13.m1.2.2.2.3" xref="alg1.l13.m1.2.2.2.3.cmml">⁢</mo><mrow id="alg1.l13.m1.2.2.2.2.2" xref="alg1.l13.m1.2.2.2.2.3.cmml"><mo id="alg1.l13.m1.2.2.2.2.2.3" stretchy="false" xref="alg1.l13.m1.2.2.2.2.3.cmml">(</mo><msub id="alg1.l13.m1.1.1.1.1.1.1" xref="alg1.l13.m1.1.1.1.1.1.1.cmml"><mi id="alg1.l13.m1.1.1.1.1.1.1.2" xref="alg1.l13.m1.1.1.1.1.1.1.2.cmml">z</mi><mrow id="alg1.l13.m1.1.1.1.1.1.1.3" xref="alg1.l13.m1.1.1.1.1.1.1.3.cmml"><mi id="alg1.l13.m1.1.1.1.1.1.1.3.2" xref="alg1.l13.m1.1.1.1.1.1.1.3.2.cmml">t</mi><mo id="alg1.l13.m1.1.1.1.1.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="alg1.l13.m1.1.1.1.1.1.1.3.1.cmml">:</mo><mrow id="alg1.l13.m1.1.1.1.1.1.1.3.3" xref="alg1.l13.m1.1.1.1.1.1.1.3.3.cmml"><mi id="alg1.l13.m1.1.1.1.1.1.1.3.3.2" xref="alg1.l13.m1.1.1.1.1.1.1.3.3.2.cmml">t</mi><mo id="alg1.l13.m1.1.1.1.1.1.1.3.3.1" xref="alg1.l13.m1.1.1.1.1.1.1.3.3.1.cmml">+</mo><mi id="alg1.l13.m1.1.1.1.1.1.1.3.3.3" xref="alg1.l13.m1.1.1.1.1.1.1.3.3.3.cmml">H</mi></mrow></mrow></msub><mo id="alg1.l13.m1.2.2.2.2.2.4" xref="alg1.l13.m1.2.2.2.2.3.cmml">,</mo><msub id="alg1.l13.m1.2.2.2.2.2.2" xref="alg1.l13.m1.2.2.2.2.2.2.cmml"><mi id="alg1.l13.m1.2.2.2.2.2.2.2" xref="alg1.l13.m1.2.2.2.2.2.2.2.cmml">a</mi><mrow id="alg1.l13.m1.2.2.2.2.2.2.3" xref="alg1.l13.m1.2.2.2.2.2.2.3.cmml"><mi id="alg1.l13.m1.2.2.2.2.2.2.3.2" xref="alg1.l13.m1.2.2.2.2.2.2.3.2.cmml">t</mi><mo id="alg1.l13.m1.2.2.2.2.2.2.3.1" lspace="0.278em" rspace="0.278em" xref="alg1.l13.m1.2.2.2.2.2.2.3.1.cmml">:</mo><mrow id="alg1.l13.m1.2.2.2.2.2.2.3.3" xref="alg1.l13.m1.2.2.2.2.2.2.3.3.cmml"><mi id="alg1.l13.m1.2.2.2.2.2.2.3.3.2" xref="alg1.l13.m1.2.2.2.2.2.2.3.3.2.cmml">t</mi><mo id="alg1.l13.m1.2.2.2.2.2.2.3.3.1" xref="alg1.l13.m1.2.2.2.2.2.2.3.3.1.cmml">+</mo><mi id="alg1.l13.m1.2.2.2.2.2.2.3.3.3" xref="alg1.l13.m1.2.2.2.2.2.2.3.3.3.cmml">H</mi></mrow></mrow></msub><mo id="alg1.l13.m1.2.2.2.2.2.5" stretchy="false" xref="alg1.l13.m1.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l13.m1.2b"><apply id="alg1.l13.m1.2.2.cmml" xref="alg1.l13.m1.2.2"><eq id="alg1.l13.m1.2.2.3.cmml" xref="alg1.l13.m1.2.2.3"></eq><apply id="alg1.l13.m1.2.2.4.cmml" xref="alg1.l13.m1.2.2.4"><csymbol cd="ambiguous" id="alg1.l13.m1.2.2.4.1.cmml" xref="alg1.l13.m1.2.2.4">subscript</csymbol><apply id="alg1.l13.m1.2.2.4.2.cmml" xref="alg1.l13.m1.2.2.4.2"><ci id="alg1.l13.m1.2.2.4.2.1.cmml" xref="alg1.l13.m1.2.2.4.2.1">^</ci><ci id="alg1.l13.m1.2.2.4.2.2.cmml" xref="alg1.l13.m1.2.2.4.2.2">𝑟</ci></apply><apply id="alg1.l13.m1.2.2.4.3.cmml" xref="alg1.l13.m1.2.2.4.3"><ci id="alg1.l13.m1.2.2.4.3.1.cmml" xref="alg1.l13.m1.2.2.4.3.1">:</ci><ci id="alg1.l13.m1.2.2.4.3.2.cmml" xref="alg1.l13.m1.2.2.4.3.2">𝑡</ci><apply id="alg1.l13.m1.2.2.4.3.3.cmml" xref="alg1.l13.m1.2.2.4.3.3"><plus id="alg1.l13.m1.2.2.4.3.3.1.cmml" xref="alg1.l13.m1.2.2.4.3.3.1"></plus><ci id="alg1.l13.m1.2.2.4.3.3.2.cmml" xref="alg1.l13.m1.2.2.4.3.3.2">𝑡</ci><ci id="alg1.l13.m1.2.2.4.3.3.3.cmml" xref="alg1.l13.m1.2.2.4.3.3.3">𝐻</ci></apply></apply></apply><apply id="alg1.l13.m1.2.2.2.cmml" xref="alg1.l13.m1.2.2.2"><times id="alg1.l13.m1.2.2.2.3.cmml" xref="alg1.l13.m1.2.2.2.3"></times><apply id="alg1.l13.m1.2.2.2.4.cmml" xref="alg1.l13.m1.2.2.2.4"><csymbol cd="ambiguous" id="alg1.l13.m1.2.2.2.4.1.cmml" xref="alg1.l13.m1.2.2.2.4">subscript</csymbol><ci id="alg1.l13.m1.2.2.2.4.2.cmml" xref="alg1.l13.m1.2.2.2.4.2">𝑅</ci><apply id="alg1.l13.m1.2.2.2.4.3.cmml" xref="alg1.l13.m1.2.2.2.4.3"><csymbol cd="ambiguous" id="alg1.l13.m1.2.2.2.4.3.1.cmml" xref="alg1.l13.m1.2.2.2.4.3">subscript</csymbol><apply id="alg1.l13.m1.2.2.2.4.3.2.cmml" xref="alg1.l13.m1.2.2.2.4.3"><csymbol cd="ambiguous" id="alg1.l13.m1.2.2.2.4.3.2.1.cmml" xref="alg1.l13.m1.2.2.2.4.3">superscript</csymbol><ci id="alg1.l13.m1.2.2.2.4.3.2.2.cmml" xref="alg1.l13.m1.2.2.2.4.3.2.2">𝜃</ci><ci id="alg1.l13.m1.2.2.2.4.3.2.3.cmml" xref="alg1.l13.m1.2.2.2.4.3.2.3">𝑅</ci></apply><ci id="alg1.l13.m1.2.2.2.4.3.3.cmml" xref="alg1.l13.m1.2.2.2.4.3.3">𝑘</ci></apply></apply><interval closure="open" id="alg1.l13.m1.2.2.2.2.3.cmml" xref="alg1.l13.m1.2.2.2.2.2"><apply id="alg1.l13.m1.1.1.1.1.1.1.cmml" xref="alg1.l13.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l13.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l13.m1.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l13.m1.1.1.1.1.1.1.2.cmml" xref="alg1.l13.m1.1.1.1.1.1.1.2">𝑧</ci><apply id="alg1.l13.m1.1.1.1.1.1.1.3.cmml" xref="alg1.l13.m1.1.1.1.1.1.1.3"><ci id="alg1.l13.m1.1.1.1.1.1.1.3.1.cmml" xref="alg1.l13.m1.1.1.1.1.1.1.3.1">:</ci><ci id="alg1.l13.m1.1.1.1.1.1.1.3.2.cmml" xref="alg1.l13.m1.1.1.1.1.1.1.3.2">𝑡</ci><apply id="alg1.l13.m1.1.1.1.1.1.1.3.3.cmml" xref="alg1.l13.m1.1.1.1.1.1.1.3.3"><plus id="alg1.l13.m1.1.1.1.1.1.1.3.3.1.cmml" xref="alg1.l13.m1.1.1.1.1.1.1.3.3.1"></plus><ci id="alg1.l13.m1.1.1.1.1.1.1.3.3.2.cmml" xref="alg1.l13.m1.1.1.1.1.1.1.3.3.2">𝑡</ci><ci id="alg1.l13.m1.1.1.1.1.1.1.3.3.3.cmml" xref="alg1.l13.m1.1.1.1.1.1.1.3.3.3">𝐻</ci></apply></apply></apply><apply id="alg1.l13.m1.2.2.2.2.2.2.cmml" xref="alg1.l13.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l13.m1.2.2.2.2.2.2.1.cmml" xref="alg1.l13.m1.2.2.2.2.2.2">subscript</csymbol><ci id="alg1.l13.m1.2.2.2.2.2.2.2.cmml" xref="alg1.l13.m1.2.2.2.2.2.2.2">𝑎</ci><apply id="alg1.l13.m1.2.2.2.2.2.2.3.cmml" xref="alg1.l13.m1.2.2.2.2.2.2.3"><ci id="alg1.l13.m1.2.2.2.2.2.2.3.1.cmml" xref="alg1.l13.m1.2.2.2.2.2.2.3.1">:</ci><ci id="alg1.l13.m1.2.2.2.2.2.2.3.2.cmml" xref="alg1.l13.m1.2.2.2.2.2.2.3.2">𝑡</ci><apply id="alg1.l13.m1.2.2.2.2.2.2.3.3.cmml" xref="alg1.l13.m1.2.2.2.2.2.2.3.3"><plus id="alg1.l13.m1.2.2.2.2.2.2.3.3.1.cmml" xref="alg1.l13.m1.2.2.2.2.2.2.3.3.1"></plus><ci id="alg1.l13.m1.2.2.2.2.2.2.3.3.2.cmml" xref="alg1.l13.m1.2.2.2.2.2.2.3.3.2">𝑡</ci><ci id="alg1.l13.m1.2.2.2.2.2.2.3.3.3.cmml" xref="alg1.l13.m1.2.2.2.2.2.2.3.3.3">𝐻</ci></apply></apply></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l13.m1.2c">\hat{r}_{t:t+H}=R_{\theta^{R}_{k}}(z_{t:t+H},a_{t:t+H})</annotation><annotation encoding="application/x-llamapun" id="alg1.l13.m1.2d">over^ start_ARG italic_r end_ARG start_POSTSUBSCRIPT italic_t : italic_t + italic_H end_POSTSUBSCRIPT = italic_R start_POSTSUBSCRIPT italic_θ start_POSTSUPERSCRIPT italic_R end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( italic_z start_POSTSUBSCRIPT italic_t : italic_t + italic_H end_POSTSUBSCRIPT , italic_a start_POSTSUBSCRIPT italic_t : italic_t + italic_H end_POSTSUBSCRIPT )</annotation></semantics></math> {Estimated rewards}

</div>
<div class="ltx_listingline" id="alg1.l14">
<span class="ltx_tag ltx_tag_listingline">14:</span>        <math alttext="\hat{Q}_{t:t+H}=Q_{\theta^{Q}_{k}}(z_{t:t+H},a_{t:t+H})" class="ltx_Math" display="inline" id="alg1.l14.m1.2"><semantics id="alg1.l14.m1.2a"><mrow id="alg1.l14.m1.2.2" xref="alg1.l14.m1.2.2.cmml"><msub id="alg1.l14.m1.2.2.4" xref="alg1.l14.m1.2.2.4.cmml"><mover accent="true" id="alg1.l14.m1.2.2.4.2" xref="alg1.l14.m1.2.2.4.2.cmml"><mi id="alg1.l14.m1.2.2.4.2.2" xref="alg1.l14.m1.2.2.4.2.2.cmml">Q</mi><mo id="alg1.l14.m1.2.2.4.2.1" xref="alg1.l14.m1.2.2.4.2.1.cmml">^</mo></mover><mrow id="alg1.l14.m1.2.2.4.3" xref="alg1.l14.m1.2.2.4.3.cmml"><mi id="alg1.l14.m1.2.2.4.3.2" xref="alg1.l14.m1.2.2.4.3.2.cmml">t</mi><mo id="alg1.l14.m1.2.2.4.3.1" lspace="0.278em" rspace="0.278em" xref="alg1.l14.m1.2.2.4.3.1.cmml">:</mo><mrow id="alg1.l14.m1.2.2.4.3.3" xref="alg1.l14.m1.2.2.4.3.3.cmml"><mi id="alg1.l14.m1.2.2.4.3.3.2" xref="alg1.l14.m1.2.2.4.3.3.2.cmml">t</mi><mo id="alg1.l14.m1.2.2.4.3.3.1" xref="alg1.l14.m1.2.2.4.3.3.1.cmml">+</mo><mi id="alg1.l14.m1.2.2.4.3.3.3" xref="alg1.l14.m1.2.2.4.3.3.3.cmml">H</mi></mrow></mrow></msub><mo id="alg1.l14.m1.2.2.3" xref="alg1.l14.m1.2.2.3.cmml">=</mo><mrow id="alg1.l14.m1.2.2.2" xref="alg1.l14.m1.2.2.2.cmml"><msub id="alg1.l14.m1.2.2.2.4" xref="alg1.l14.m1.2.2.2.4.cmml"><mi id="alg1.l14.m1.2.2.2.4.2" xref="alg1.l14.m1.2.2.2.4.2.cmml">Q</mi><msubsup id="alg1.l14.m1.2.2.2.4.3" xref="alg1.l14.m1.2.2.2.4.3.cmml"><mi id="alg1.l14.m1.2.2.2.4.3.2.2" xref="alg1.l14.m1.2.2.2.4.3.2.2.cmml">θ</mi><mi id="alg1.l14.m1.2.2.2.4.3.3" xref="alg1.l14.m1.2.2.2.4.3.3.cmml">k</mi><mi id="alg1.l14.m1.2.2.2.4.3.2.3" xref="alg1.l14.m1.2.2.2.4.3.2.3.cmml">Q</mi></msubsup></msub><mo id="alg1.l14.m1.2.2.2.3" xref="alg1.l14.m1.2.2.2.3.cmml">⁢</mo><mrow id="alg1.l14.m1.2.2.2.2.2" xref="alg1.l14.m1.2.2.2.2.3.cmml"><mo id="alg1.l14.m1.2.2.2.2.2.3" stretchy="false" xref="alg1.l14.m1.2.2.2.2.3.cmml">(</mo><msub id="alg1.l14.m1.1.1.1.1.1.1" xref="alg1.l14.m1.1.1.1.1.1.1.cmml"><mi id="alg1.l14.m1.1.1.1.1.1.1.2" xref="alg1.l14.m1.1.1.1.1.1.1.2.cmml">z</mi><mrow id="alg1.l14.m1.1.1.1.1.1.1.3" xref="alg1.l14.m1.1.1.1.1.1.1.3.cmml"><mi id="alg1.l14.m1.1.1.1.1.1.1.3.2" xref="alg1.l14.m1.1.1.1.1.1.1.3.2.cmml">t</mi><mo id="alg1.l14.m1.1.1.1.1.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="alg1.l14.m1.1.1.1.1.1.1.3.1.cmml">:</mo><mrow id="alg1.l14.m1.1.1.1.1.1.1.3.3" xref="alg1.l14.m1.1.1.1.1.1.1.3.3.cmml"><mi id="alg1.l14.m1.1.1.1.1.1.1.3.3.2" xref="alg1.l14.m1.1.1.1.1.1.1.3.3.2.cmml">t</mi><mo id="alg1.l14.m1.1.1.1.1.1.1.3.3.1" xref="alg1.l14.m1.1.1.1.1.1.1.3.3.1.cmml">+</mo><mi id="alg1.l14.m1.1.1.1.1.1.1.3.3.3" xref="alg1.l14.m1.1.1.1.1.1.1.3.3.3.cmml">H</mi></mrow></mrow></msub><mo id="alg1.l14.m1.2.2.2.2.2.4" xref="alg1.l14.m1.2.2.2.2.3.cmml">,</mo><msub id="alg1.l14.m1.2.2.2.2.2.2" xref="alg1.l14.m1.2.2.2.2.2.2.cmml"><mi id="alg1.l14.m1.2.2.2.2.2.2.2" xref="alg1.l14.m1.2.2.2.2.2.2.2.cmml">a</mi><mrow id="alg1.l14.m1.2.2.2.2.2.2.3" xref="alg1.l14.m1.2.2.2.2.2.2.3.cmml"><mi id="alg1.l14.m1.2.2.2.2.2.2.3.2" xref="alg1.l14.m1.2.2.2.2.2.2.3.2.cmml">t</mi><mo id="alg1.l14.m1.2.2.2.2.2.2.3.1" lspace="0.278em" rspace="0.278em" xref="alg1.l14.m1.2.2.2.2.2.2.3.1.cmml">:</mo><mrow id="alg1.l14.m1.2.2.2.2.2.2.3.3" xref="alg1.l14.m1.2.2.2.2.2.2.3.3.cmml"><mi id="alg1.l14.m1.2.2.2.2.2.2.3.3.2" xref="alg1.l14.m1.2.2.2.2.2.2.3.3.2.cmml">t</mi><mo id="alg1.l14.m1.2.2.2.2.2.2.3.3.1" xref="alg1.l14.m1.2.2.2.2.2.2.3.3.1.cmml">+</mo><mi id="alg1.l14.m1.2.2.2.2.2.2.3.3.3" xref="alg1.l14.m1.2.2.2.2.2.2.3.3.3.cmml">H</mi></mrow></mrow></msub><mo id="alg1.l14.m1.2.2.2.2.2.5" stretchy="false" xref="alg1.l14.m1.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l14.m1.2b"><apply id="alg1.l14.m1.2.2.cmml" xref="alg1.l14.m1.2.2"><eq id="alg1.l14.m1.2.2.3.cmml" xref="alg1.l14.m1.2.2.3"></eq><apply id="alg1.l14.m1.2.2.4.cmml" xref="alg1.l14.m1.2.2.4"><csymbol cd="ambiguous" id="alg1.l14.m1.2.2.4.1.cmml" xref="alg1.l14.m1.2.2.4">subscript</csymbol><apply id="alg1.l14.m1.2.2.4.2.cmml" xref="alg1.l14.m1.2.2.4.2"><ci id="alg1.l14.m1.2.2.4.2.1.cmml" xref="alg1.l14.m1.2.2.4.2.1">^</ci><ci id="alg1.l14.m1.2.2.4.2.2.cmml" xref="alg1.l14.m1.2.2.4.2.2">𝑄</ci></apply><apply id="alg1.l14.m1.2.2.4.3.cmml" xref="alg1.l14.m1.2.2.4.3"><ci id="alg1.l14.m1.2.2.4.3.1.cmml" xref="alg1.l14.m1.2.2.4.3.1">:</ci><ci id="alg1.l14.m1.2.2.4.3.2.cmml" xref="alg1.l14.m1.2.2.4.3.2">𝑡</ci><apply id="alg1.l14.m1.2.2.4.3.3.cmml" xref="alg1.l14.m1.2.2.4.3.3"><plus id="alg1.l14.m1.2.2.4.3.3.1.cmml" xref="alg1.l14.m1.2.2.4.3.3.1"></plus><ci id="alg1.l14.m1.2.2.4.3.3.2.cmml" xref="alg1.l14.m1.2.2.4.3.3.2">𝑡</ci><ci id="alg1.l14.m1.2.2.4.3.3.3.cmml" xref="alg1.l14.m1.2.2.4.3.3.3">𝐻</ci></apply></apply></apply><apply id="alg1.l14.m1.2.2.2.cmml" xref="alg1.l14.m1.2.2.2"><times id="alg1.l14.m1.2.2.2.3.cmml" xref="alg1.l14.m1.2.2.2.3"></times><apply id="alg1.l14.m1.2.2.2.4.cmml" xref="alg1.l14.m1.2.2.2.4"><csymbol cd="ambiguous" id="alg1.l14.m1.2.2.2.4.1.cmml" xref="alg1.l14.m1.2.2.2.4">subscript</csymbol><ci id="alg1.l14.m1.2.2.2.4.2.cmml" xref="alg1.l14.m1.2.2.2.4.2">𝑄</ci><apply id="alg1.l14.m1.2.2.2.4.3.cmml" xref="alg1.l14.m1.2.2.2.4.3"><csymbol cd="ambiguous" id="alg1.l14.m1.2.2.2.4.3.1.cmml" xref="alg1.l14.m1.2.2.2.4.3">subscript</csymbol><apply id="alg1.l14.m1.2.2.2.4.3.2.cmml" xref="alg1.l14.m1.2.2.2.4.3"><csymbol cd="ambiguous" id="alg1.l14.m1.2.2.2.4.3.2.1.cmml" xref="alg1.l14.m1.2.2.2.4.3">superscript</csymbol><ci id="alg1.l14.m1.2.2.2.4.3.2.2.cmml" xref="alg1.l14.m1.2.2.2.4.3.2.2">𝜃</ci><ci id="alg1.l14.m1.2.2.2.4.3.2.3.cmml" xref="alg1.l14.m1.2.2.2.4.3.2.3">𝑄</ci></apply><ci id="alg1.l14.m1.2.2.2.4.3.3.cmml" xref="alg1.l14.m1.2.2.2.4.3.3">𝑘</ci></apply></apply><interval closure="open" id="alg1.l14.m1.2.2.2.2.3.cmml" xref="alg1.l14.m1.2.2.2.2.2"><apply id="alg1.l14.m1.1.1.1.1.1.1.cmml" xref="alg1.l14.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l14.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l14.m1.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l14.m1.1.1.1.1.1.1.2.cmml" xref="alg1.l14.m1.1.1.1.1.1.1.2">𝑧</ci><apply id="alg1.l14.m1.1.1.1.1.1.1.3.cmml" xref="alg1.l14.m1.1.1.1.1.1.1.3"><ci id="alg1.l14.m1.1.1.1.1.1.1.3.1.cmml" xref="alg1.l14.m1.1.1.1.1.1.1.3.1">:</ci><ci id="alg1.l14.m1.1.1.1.1.1.1.3.2.cmml" xref="alg1.l14.m1.1.1.1.1.1.1.3.2">𝑡</ci><apply id="alg1.l14.m1.1.1.1.1.1.1.3.3.cmml" xref="alg1.l14.m1.1.1.1.1.1.1.3.3"><plus id="alg1.l14.m1.1.1.1.1.1.1.3.3.1.cmml" xref="alg1.l14.m1.1.1.1.1.1.1.3.3.1"></plus><ci id="alg1.l14.m1.1.1.1.1.1.1.3.3.2.cmml" xref="alg1.l14.m1.1.1.1.1.1.1.3.3.2">𝑡</ci><ci id="alg1.l14.m1.1.1.1.1.1.1.3.3.3.cmml" xref="alg1.l14.m1.1.1.1.1.1.1.3.3.3">𝐻</ci></apply></apply></apply><apply id="alg1.l14.m1.2.2.2.2.2.2.cmml" xref="alg1.l14.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l14.m1.2.2.2.2.2.2.1.cmml" xref="alg1.l14.m1.2.2.2.2.2.2">subscript</csymbol><ci id="alg1.l14.m1.2.2.2.2.2.2.2.cmml" xref="alg1.l14.m1.2.2.2.2.2.2.2">𝑎</ci><apply id="alg1.l14.m1.2.2.2.2.2.2.3.cmml" xref="alg1.l14.m1.2.2.2.2.2.2.3"><ci id="alg1.l14.m1.2.2.2.2.2.2.3.1.cmml" xref="alg1.l14.m1.2.2.2.2.2.2.3.1">:</ci><ci id="alg1.l14.m1.2.2.2.2.2.2.3.2.cmml" xref="alg1.l14.m1.2.2.2.2.2.2.3.2">𝑡</ci><apply id="alg1.l14.m1.2.2.2.2.2.2.3.3.cmml" xref="alg1.l14.m1.2.2.2.2.2.2.3.3"><plus id="alg1.l14.m1.2.2.2.2.2.2.3.3.1.cmml" xref="alg1.l14.m1.2.2.2.2.2.2.3.3.1"></plus><ci id="alg1.l14.m1.2.2.2.2.2.2.3.3.2.cmml" xref="alg1.l14.m1.2.2.2.2.2.2.3.3.2">𝑡</ci><ci id="alg1.l14.m1.2.2.2.2.2.2.3.3.3.cmml" xref="alg1.l14.m1.2.2.2.2.2.2.3.3.3">𝐻</ci></apply></apply></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l14.m1.2c">\hat{Q}_{t:t+H}=Q_{\theta^{Q}_{k}}(z_{t:t+H},a_{t:t+H})</annotation><annotation encoding="application/x-llamapun" id="alg1.l14.m1.2d">over^ start_ARG italic_Q end_ARG start_POSTSUBSCRIPT italic_t : italic_t + italic_H end_POSTSUBSCRIPT = italic_Q start_POSTSUBSCRIPT italic_θ start_POSTSUPERSCRIPT italic_Q end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( italic_z start_POSTSUBSCRIPT italic_t : italic_t + italic_H end_POSTSUBSCRIPT , italic_a start_POSTSUBSCRIPT italic_t : italic_t + italic_H end_POSTSUBSCRIPT )</annotation></semantics></math> {Estimated state-action value}

</div>
<div class="ltx_listingline" id="alg1.l15">
<span class="ltx_tag ltx_tag_listingline">15:</span>        <math alttext="\hat{z}_{t+1:t+H+1}=d_{\theta^{d}_{k}}(z_{t:t+H},a_{t:t+H})" class="ltx_Math" display="inline" id="alg1.l15.m1.2"><semantics id="alg1.l15.m1.2a"><mrow id="alg1.l15.m1.2.2" xref="alg1.l15.m1.2.2.cmml"><msub id="alg1.l15.m1.2.2.4" xref="alg1.l15.m1.2.2.4.cmml"><mover accent="true" id="alg1.l15.m1.2.2.4.2" xref="alg1.l15.m1.2.2.4.2.cmml"><mi id="alg1.l15.m1.2.2.4.2.2" xref="alg1.l15.m1.2.2.4.2.2.cmml">z</mi><mo id="alg1.l15.m1.2.2.4.2.1" xref="alg1.l15.m1.2.2.4.2.1.cmml">^</mo></mover><mrow id="alg1.l15.m1.2.2.4.3" xref="alg1.l15.m1.2.2.4.3.cmml"><mrow id="alg1.l15.m1.2.2.4.3.2" xref="alg1.l15.m1.2.2.4.3.2.cmml"><mi id="alg1.l15.m1.2.2.4.3.2.2" xref="alg1.l15.m1.2.2.4.3.2.2.cmml">t</mi><mo id="alg1.l15.m1.2.2.4.3.2.1" xref="alg1.l15.m1.2.2.4.3.2.1.cmml">+</mo><mn id="alg1.l15.m1.2.2.4.3.2.3" xref="alg1.l15.m1.2.2.4.3.2.3.cmml">1</mn></mrow><mo id="alg1.l15.m1.2.2.4.3.1" lspace="0.278em" rspace="0.278em" xref="alg1.l15.m1.2.2.4.3.1.cmml">:</mo><mrow id="alg1.l15.m1.2.2.4.3.3" xref="alg1.l15.m1.2.2.4.3.3.cmml"><mi id="alg1.l15.m1.2.2.4.3.3.2" xref="alg1.l15.m1.2.2.4.3.3.2.cmml">t</mi><mo id="alg1.l15.m1.2.2.4.3.3.1" xref="alg1.l15.m1.2.2.4.3.3.1.cmml">+</mo><mi id="alg1.l15.m1.2.2.4.3.3.3" xref="alg1.l15.m1.2.2.4.3.3.3.cmml">H</mi><mo id="alg1.l15.m1.2.2.4.3.3.1a" xref="alg1.l15.m1.2.2.4.3.3.1.cmml">+</mo><mn id="alg1.l15.m1.2.2.4.3.3.4" xref="alg1.l15.m1.2.2.4.3.3.4.cmml">1</mn></mrow></mrow></msub><mo id="alg1.l15.m1.2.2.3" xref="alg1.l15.m1.2.2.3.cmml">=</mo><mrow id="alg1.l15.m1.2.2.2" xref="alg1.l15.m1.2.2.2.cmml"><msub id="alg1.l15.m1.2.2.2.4" xref="alg1.l15.m1.2.2.2.4.cmml"><mi id="alg1.l15.m1.2.2.2.4.2" xref="alg1.l15.m1.2.2.2.4.2.cmml">d</mi><msubsup id="alg1.l15.m1.2.2.2.4.3" xref="alg1.l15.m1.2.2.2.4.3.cmml"><mi id="alg1.l15.m1.2.2.2.4.3.2.2" xref="alg1.l15.m1.2.2.2.4.3.2.2.cmml">θ</mi><mi id="alg1.l15.m1.2.2.2.4.3.3" xref="alg1.l15.m1.2.2.2.4.3.3.cmml">k</mi><mi id="alg1.l15.m1.2.2.2.4.3.2.3" xref="alg1.l15.m1.2.2.2.4.3.2.3.cmml">d</mi></msubsup></msub><mo id="alg1.l15.m1.2.2.2.3" xref="alg1.l15.m1.2.2.2.3.cmml">⁢</mo><mrow id="alg1.l15.m1.2.2.2.2.2" xref="alg1.l15.m1.2.2.2.2.3.cmml"><mo id="alg1.l15.m1.2.2.2.2.2.3" stretchy="false" xref="alg1.l15.m1.2.2.2.2.3.cmml">(</mo><msub id="alg1.l15.m1.1.1.1.1.1.1" xref="alg1.l15.m1.1.1.1.1.1.1.cmml"><mi id="alg1.l15.m1.1.1.1.1.1.1.2" xref="alg1.l15.m1.1.1.1.1.1.1.2.cmml">z</mi><mrow id="alg1.l15.m1.1.1.1.1.1.1.3" xref="alg1.l15.m1.1.1.1.1.1.1.3.cmml"><mi id="alg1.l15.m1.1.1.1.1.1.1.3.2" xref="alg1.l15.m1.1.1.1.1.1.1.3.2.cmml">t</mi><mo id="alg1.l15.m1.1.1.1.1.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="alg1.l15.m1.1.1.1.1.1.1.3.1.cmml">:</mo><mrow id="alg1.l15.m1.1.1.1.1.1.1.3.3" xref="alg1.l15.m1.1.1.1.1.1.1.3.3.cmml"><mi id="alg1.l15.m1.1.1.1.1.1.1.3.3.2" xref="alg1.l15.m1.1.1.1.1.1.1.3.3.2.cmml">t</mi><mo id="alg1.l15.m1.1.1.1.1.1.1.3.3.1" xref="alg1.l15.m1.1.1.1.1.1.1.3.3.1.cmml">+</mo><mi id="alg1.l15.m1.1.1.1.1.1.1.3.3.3" xref="alg1.l15.m1.1.1.1.1.1.1.3.3.3.cmml">H</mi></mrow></mrow></msub><mo id="alg1.l15.m1.2.2.2.2.2.4" xref="alg1.l15.m1.2.2.2.2.3.cmml">,</mo><msub id="alg1.l15.m1.2.2.2.2.2.2" xref="alg1.l15.m1.2.2.2.2.2.2.cmml"><mi id="alg1.l15.m1.2.2.2.2.2.2.2" xref="alg1.l15.m1.2.2.2.2.2.2.2.cmml">a</mi><mrow id="alg1.l15.m1.2.2.2.2.2.2.3" xref="alg1.l15.m1.2.2.2.2.2.2.3.cmml"><mi id="alg1.l15.m1.2.2.2.2.2.2.3.2" xref="alg1.l15.m1.2.2.2.2.2.2.3.2.cmml">t</mi><mo id="alg1.l15.m1.2.2.2.2.2.2.3.1" lspace="0.278em" rspace="0.278em" xref="alg1.l15.m1.2.2.2.2.2.2.3.1.cmml">:</mo><mrow id="alg1.l15.m1.2.2.2.2.2.2.3.3" xref="alg1.l15.m1.2.2.2.2.2.2.3.3.cmml"><mi id="alg1.l15.m1.2.2.2.2.2.2.3.3.2" xref="alg1.l15.m1.2.2.2.2.2.2.3.3.2.cmml">t</mi><mo id="alg1.l15.m1.2.2.2.2.2.2.3.3.1" xref="alg1.l15.m1.2.2.2.2.2.2.3.3.1.cmml">+</mo><mi id="alg1.l15.m1.2.2.2.2.2.2.3.3.3" xref="alg1.l15.m1.2.2.2.2.2.2.3.3.3.cmml">H</mi></mrow></mrow></msub><mo id="alg1.l15.m1.2.2.2.2.2.5" stretchy="false" xref="alg1.l15.m1.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l15.m1.2b"><apply id="alg1.l15.m1.2.2.cmml" xref="alg1.l15.m1.2.2"><eq id="alg1.l15.m1.2.2.3.cmml" xref="alg1.l15.m1.2.2.3"></eq><apply id="alg1.l15.m1.2.2.4.cmml" xref="alg1.l15.m1.2.2.4"><csymbol cd="ambiguous" id="alg1.l15.m1.2.2.4.1.cmml" xref="alg1.l15.m1.2.2.4">subscript</csymbol><apply id="alg1.l15.m1.2.2.4.2.cmml" xref="alg1.l15.m1.2.2.4.2"><ci id="alg1.l15.m1.2.2.4.2.1.cmml" xref="alg1.l15.m1.2.2.4.2.1">^</ci><ci id="alg1.l15.m1.2.2.4.2.2.cmml" xref="alg1.l15.m1.2.2.4.2.2">𝑧</ci></apply><apply id="alg1.l15.m1.2.2.4.3.cmml" xref="alg1.l15.m1.2.2.4.3"><ci id="alg1.l15.m1.2.2.4.3.1.cmml" xref="alg1.l15.m1.2.2.4.3.1">:</ci><apply id="alg1.l15.m1.2.2.4.3.2.cmml" xref="alg1.l15.m1.2.2.4.3.2"><plus id="alg1.l15.m1.2.2.4.3.2.1.cmml" xref="alg1.l15.m1.2.2.4.3.2.1"></plus><ci id="alg1.l15.m1.2.2.4.3.2.2.cmml" xref="alg1.l15.m1.2.2.4.3.2.2">𝑡</ci><cn id="alg1.l15.m1.2.2.4.3.2.3.cmml" type="integer" xref="alg1.l15.m1.2.2.4.3.2.3">1</cn></apply><apply id="alg1.l15.m1.2.2.4.3.3.cmml" xref="alg1.l15.m1.2.2.4.3.3"><plus id="alg1.l15.m1.2.2.4.3.3.1.cmml" xref="alg1.l15.m1.2.2.4.3.3.1"></plus><ci id="alg1.l15.m1.2.2.4.3.3.2.cmml" xref="alg1.l15.m1.2.2.4.3.3.2">𝑡</ci><ci id="alg1.l15.m1.2.2.4.3.3.3.cmml" xref="alg1.l15.m1.2.2.4.3.3.3">𝐻</ci><cn id="alg1.l15.m1.2.2.4.3.3.4.cmml" type="integer" xref="alg1.l15.m1.2.2.4.3.3.4">1</cn></apply></apply></apply><apply id="alg1.l15.m1.2.2.2.cmml" xref="alg1.l15.m1.2.2.2"><times id="alg1.l15.m1.2.2.2.3.cmml" xref="alg1.l15.m1.2.2.2.3"></times><apply id="alg1.l15.m1.2.2.2.4.cmml" xref="alg1.l15.m1.2.2.2.4"><csymbol cd="ambiguous" id="alg1.l15.m1.2.2.2.4.1.cmml" xref="alg1.l15.m1.2.2.2.4">subscript</csymbol><ci id="alg1.l15.m1.2.2.2.4.2.cmml" xref="alg1.l15.m1.2.2.2.4.2">𝑑</ci><apply id="alg1.l15.m1.2.2.2.4.3.cmml" xref="alg1.l15.m1.2.2.2.4.3"><csymbol cd="ambiguous" id="alg1.l15.m1.2.2.2.4.3.1.cmml" xref="alg1.l15.m1.2.2.2.4.3">subscript</csymbol><apply id="alg1.l15.m1.2.2.2.4.3.2.cmml" xref="alg1.l15.m1.2.2.2.4.3"><csymbol cd="ambiguous" id="alg1.l15.m1.2.2.2.4.3.2.1.cmml" xref="alg1.l15.m1.2.2.2.4.3">superscript</csymbol><ci id="alg1.l15.m1.2.2.2.4.3.2.2.cmml" xref="alg1.l15.m1.2.2.2.4.3.2.2">𝜃</ci><ci id="alg1.l15.m1.2.2.2.4.3.2.3.cmml" xref="alg1.l15.m1.2.2.2.4.3.2.3">𝑑</ci></apply><ci id="alg1.l15.m1.2.2.2.4.3.3.cmml" xref="alg1.l15.m1.2.2.2.4.3.3">𝑘</ci></apply></apply><interval closure="open" id="alg1.l15.m1.2.2.2.2.3.cmml" xref="alg1.l15.m1.2.2.2.2.2"><apply id="alg1.l15.m1.1.1.1.1.1.1.cmml" xref="alg1.l15.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l15.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l15.m1.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l15.m1.1.1.1.1.1.1.2.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.2">𝑧</ci><apply id="alg1.l15.m1.1.1.1.1.1.1.3.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.3"><ci id="alg1.l15.m1.1.1.1.1.1.1.3.1.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.3.1">:</ci><ci id="alg1.l15.m1.1.1.1.1.1.1.3.2.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.3.2">𝑡</ci><apply id="alg1.l15.m1.1.1.1.1.1.1.3.3.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.3.3"><plus id="alg1.l15.m1.1.1.1.1.1.1.3.3.1.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.3.3.1"></plus><ci id="alg1.l15.m1.1.1.1.1.1.1.3.3.2.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.3.3.2">𝑡</ci><ci id="alg1.l15.m1.1.1.1.1.1.1.3.3.3.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.3.3.3">𝐻</ci></apply></apply></apply><apply id="alg1.l15.m1.2.2.2.2.2.2.cmml" xref="alg1.l15.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l15.m1.2.2.2.2.2.2.1.cmml" xref="alg1.l15.m1.2.2.2.2.2.2">subscript</csymbol><ci id="alg1.l15.m1.2.2.2.2.2.2.2.cmml" xref="alg1.l15.m1.2.2.2.2.2.2.2">𝑎</ci><apply id="alg1.l15.m1.2.2.2.2.2.2.3.cmml" xref="alg1.l15.m1.2.2.2.2.2.2.3"><ci id="alg1.l15.m1.2.2.2.2.2.2.3.1.cmml" xref="alg1.l15.m1.2.2.2.2.2.2.3.1">:</ci><ci id="alg1.l15.m1.2.2.2.2.2.2.3.2.cmml" xref="alg1.l15.m1.2.2.2.2.2.2.3.2">𝑡</ci><apply id="alg1.l15.m1.2.2.2.2.2.2.3.3.cmml" xref="alg1.l15.m1.2.2.2.2.2.2.3.3"><plus id="alg1.l15.m1.2.2.2.2.2.2.3.3.1.cmml" xref="alg1.l15.m1.2.2.2.2.2.2.3.3.1"></plus><ci id="alg1.l15.m1.2.2.2.2.2.2.3.3.2.cmml" xref="alg1.l15.m1.2.2.2.2.2.2.3.3.2">𝑡</ci><ci id="alg1.l15.m1.2.2.2.2.2.2.3.3.3.cmml" xref="alg1.l15.m1.2.2.2.2.2.2.3.3.3">𝐻</ci></apply></apply></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l15.m1.2c">\hat{z}_{t+1:t+H+1}=d_{\theta^{d}_{k}}(z_{t:t+H},a_{t:t+H})</annotation><annotation encoding="application/x-llamapun" id="alg1.l15.m1.2d">over^ start_ARG italic_z end_ARG start_POSTSUBSCRIPT italic_t + 1 : italic_t + italic_H + 1 end_POSTSUBSCRIPT = italic_d start_POSTSUBSCRIPT italic_θ start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( italic_z start_POSTSUBSCRIPT italic_t : italic_t + italic_H end_POSTSUBSCRIPT , italic_a start_POSTSUBSCRIPT italic_t : italic_t + italic_H end_POSTSUBSCRIPT )</annotation></semantics></math> {Estimated next latent state}

</div>
<div class="ltx_listingline" id="alg1.l16">
<span class="ltx_tag ltx_tag_listingline">16:</span>        <math alttext="\theta_{k+1}=\arg\min_{\theta_{k}}{\mathcal{L}}(\theta_{k})" class="ltx_Math" display="inline" id="alg1.l16.m1.1"><semantics id="alg1.l16.m1.1a"><mrow id="alg1.l16.m1.1.1" xref="alg1.l16.m1.1.1.cmml"><msub id="alg1.l16.m1.1.1.3" xref="alg1.l16.m1.1.1.3.cmml"><mi id="alg1.l16.m1.1.1.3.2" xref="alg1.l16.m1.1.1.3.2.cmml">θ</mi><mrow id="alg1.l16.m1.1.1.3.3" xref="alg1.l16.m1.1.1.3.3.cmml"><mi id="alg1.l16.m1.1.1.3.3.2" xref="alg1.l16.m1.1.1.3.3.2.cmml">k</mi><mo id="alg1.l16.m1.1.1.3.3.1" xref="alg1.l16.m1.1.1.3.3.1.cmml">+</mo><mn id="alg1.l16.m1.1.1.3.3.3" xref="alg1.l16.m1.1.1.3.3.3.cmml">1</mn></mrow></msub><mo id="alg1.l16.m1.1.1.2" xref="alg1.l16.m1.1.1.2.cmml">=</mo><mrow id="alg1.l16.m1.1.1.1" xref="alg1.l16.m1.1.1.1.cmml"><mrow id="alg1.l16.m1.1.1.1.3" xref="alg1.l16.m1.1.1.1.3.cmml"><mi id="alg1.l16.m1.1.1.1.3.1" xref="alg1.l16.m1.1.1.1.3.1.cmml">arg</mi><mo id="alg1.l16.m1.1.1.1.3a" lspace="0.167em" xref="alg1.l16.m1.1.1.1.3.cmml">⁡</mo><mrow id="alg1.l16.m1.1.1.1.3.2" xref="alg1.l16.m1.1.1.1.3.2.cmml"><msub id="alg1.l16.m1.1.1.1.3.2.1" xref="alg1.l16.m1.1.1.1.3.2.1.cmml"><mi id="alg1.l16.m1.1.1.1.3.2.1.2" xref="alg1.l16.m1.1.1.1.3.2.1.2.cmml">min</mi><msub id="alg1.l16.m1.1.1.1.3.2.1.3" xref="alg1.l16.m1.1.1.1.3.2.1.3.cmml"><mi id="alg1.l16.m1.1.1.1.3.2.1.3.2" xref="alg1.l16.m1.1.1.1.3.2.1.3.2.cmml">θ</mi><mi id="alg1.l16.m1.1.1.1.3.2.1.3.3" xref="alg1.l16.m1.1.1.1.3.2.1.3.3.cmml">k</mi></msub></msub><mo id="alg1.l16.m1.1.1.1.3.2a" lspace="0.167em" xref="alg1.l16.m1.1.1.1.3.2.cmml">⁡</mo><mi class="ltx_font_mathcaligraphic" id="alg1.l16.m1.1.1.1.3.2.2" xref="alg1.l16.m1.1.1.1.3.2.2.cmml">ℒ</mi></mrow></mrow><mo id="alg1.l16.m1.1.1.1.2" xref="alg1.l16.m1.1.1.1.2.cmml">⁢</mo><mrow id="alg1.l16.m1.1.1.1.1.1" xref="alg1.l16.m1.1.1.1.1.1.1.cmml"><mo id="alg1.l16.m1.1.1.1.1.1.2" stretchy="false" xref="alg1.l16.m1.1.1.1.1.1.1.cmml">(</mo><msub id="alg1.l16.m1.1.1.1.1.1.1" xref="alg1.l16.m1.1.1.1.1.1.1.cmml"><mi id="alg1.l16.m1.1.1.1.1.1.1.2" xref="alg1.l16.m1.1.1.1.1.1.1.2.cmml">θ</mi><mi id="alg1.l16.m1.1.1.1.1.1.1.3" xref="alg1.l16.m1.1.1.1.1.1.1.3.cmml">k</mi></msub><mo id="alg1.l16.m1.1.1.1.1.1.3" stretchy="false" xref="alg1.l16.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l16.m1.1b"><apply id="alg1.l16.m1.1.1.cmml" xref="alg1.l16.m1.1.1"><eq id="alg1.l16.m1.1.1.2.cmml" xref="alg1.l16.m1.1.1.2"></eq><apply id="alg1.l16.m1.1.1.3.cmml" xref="alg1.l16.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l16.m1.1.1.3.1.cmml" xref="alg1.l16.m1.1.1.3">subscript</csymbol><ci id="alg1.l16.m1.1.1.3.2.cmml" xref="alg1.l16.m1.1.1.3.2">𝜃</ci><apply id="alg1.l16.m1.1.1.3.3.cmml" xref="alg1.l16.m1.1.1.3.3"><plus id="alg1.l16.m1.1.1.3.3.1.cmml" xref="alg1.l16.m1.1.1.3.3.1"></plus><ci id="alg1.l16.m1.1.1.3.3.2.cmml" xref="alg1.l16.m1.1.1.3.3.2">𝑘</ci><cn id="alg1.l16.m1.1.1.3.3.3.cmml" type="integer" xref="alg1.l16.m1.1.1.3.3.3">1</cn></apply></apply><apply id="alg1.l16.m1.1.1.1.cmml" xref="alg1.l16.m1.1.1.1"><times id="alg1.l16.m1.1.1.1.2.cmml" xref="alg1.l16.m1.1.1.1.2"></times><apply id="alg1.l16.m1.1.1.1.3.cmml" xref="alg1.l16.m1.1.1.1.3"><arg id="alg1.l16.m1.1.1.1.3.1.cmml" xref="alg1.l16.m1.1.1.1.3.1"></arg><apply id="alg1.l16.m1.1.1.1.3.2.cmml" xref="alg1.l16.m1.1.1.1.3.2"><apply id="alg1.l16.m1.1.1.1.3.2.1.cmml" xref="alg1.l16.m1.1.1.1.3.2.1"><csymbol cd="ambiguous" id="alg1.l16.m1.1.1.1.3.2.1.1.cmml" xref="alg1.l16.m1.1.1.1.3.2.1">subscript</csymbol><min id="alg1.l16.m1.1.1.1.3.2.1.2.cmml" xref="alg1.l16.m1.1.1.1.3.2.1.2"></min><apply id="alg1.l16.m1.1.1.1.3.2.1.3.cmml" xref="alg1.l16.m1.1.1.1.3.2.1.3"><csymbol cd="ambiguous" id="alg1.l16.m1.1.1.1.3.2.1.3.1.cmml" xref="alg1.l16.m1.1.1.1.3.2.1.3">subscript</csymbol><ci id="alg1.l16.m1.1.1.1.3.2.1.3.2.cmml" xref="alg1.l16.m1.1.1.1.3.2.1.3.2">𝜃</ci><ci id="alg1.l16.m1.1.1.1.3.2.1.3.3.cmml" xref="alg1.l16.m1.1.1.1.3.2.1.3.3">𝑘</ci></apply></apply><ci id="alg1.l16.m1.1.1.1.3.2.2.cmml" xref="alg1.l16.m1.1.1.1.3.2.2">ℒ</ci></apply></apply><apply id="alg1.l16.m1.1.1.1.1.1.1.cmml" xref="alg1.l16.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l16.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l16.m1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l16.m1.1.1.1.1.1.1.2.cmml" xref="alg1.l16.m1.1.1.1.1.1.1.2">𝜃</ci><ci id="alg1.l16.m1.1.1.1.1.1.1.3.cmml" xref="alg1.l16.m1.1.1.1.1.1.1.3">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l16.m1.1c">\theta_{k+1}=\arg\min_{\theta_{k}}{\mathcal{L}}(\theta_{k})</annotation><annotation encoding="application/x-llamapun" id="alg1.l16.m1.1d">italic_θ start_POSTSUBSCRIPT italic_k + 1 end_POSTSUBSCRIPT = roman_arg roman_min start_POSTSUBSCRIPT italic_θ start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_POSTSUBSCRIPT caligraphic_L ( italic_θ start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT )</annotation></semantics></math> {Update <math alttext="\theta_{k}" class="ltx_Math" display="inline" id="alg1.l16.m2.1"><semantics id="alg1.l16.m2.1a"><msub id="alg1.l16.m2.1.1" xref="alg1.l16.m2.1.1.cmml"><mi id="alg1.l16.m2.1.1.2" xref="alg1.l16.m2.1.1.2.cmml">θ</mi><mi id="alg1.l16.m2.1.1.3" xref="alg1.l16.m2.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l16.m2.1b"><apply id="alg1.l16.m2.1.1.cmml" xref="alg1.l16.m2.1.1"><csymbol cd="ambiguous" id="alg1.l16.m2.1.1.1.cmml" xref="alg1.l16.m2.1.1">subscript</csymbol><ci id="alg1.l16.m2.1.1.2.cmml" xref="alg1.l16.m2.1.1.2">𝜃</ci><ci id="alg1.l16.m2.1.1.3.cmml" xref="alg1.l16.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l16.m2.1c">\theta_{k}</annotation><annotation encoding="application/x-llamapun" id="alg1.l16.m2.1d">italic_θ start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> by minimizing Eq. <a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#S4.E7" title="In Objective function ‣ 4.1 Bisimulation Metric for Model Predictive Control ‣ 4 Bisimulation metric for model predictive control ‣ Bisimulation metric for Model Predictive Control"><span class="ltx_text ltx_ref_tag">7</span></a>}

</div>
<div class="ltx_listingline" id="alg1.l17">
<span class="ltx_tag ltx_tag_listingline">17:</span>        <math alttext="\psi_{k+1}=\arg\min_{\psi_{k}}{\mathcal{J}}_{\pi}(\psi_{k})" class="ltx_Math" display="inline" id="alg1.l17.m1.1"><semantics id="alg1.l17.m1.1a"><mrow id="alg1.l17.m1.1.1" xref="alg1.l17.m1.1.1.cmml"><msub id="alg1.l17.m1.1.1.3" xref="alg1.l17.m1.1.1.3.cmml"><mi id="alg1.l17.m1.1.1.3.2" xref="alg1.l17.m1.1.1.3.2.cmml">ψ</mi><mrow id="alg1.l17.m1.1.1.3.3" xref="alg1.l17.m1.1.1.3.3.cmml"><mi id="alg1.l17.m1.1.1.3.3.2" xref="alg1.l17.m1.1.1.3.3.2.cmml">k</mi><mo id="alg1.l17.m1.1.1.3.3.1" xref="alg1.l17.m1.1.1.3.3.1.cmml">+</mo><mn id="alg1.l17.m1.1.1.3.3.3" xref="alg1.l17.m1.1.1.3.3.3.cmml">1</mn></mrow></msub><mo id="alg1.l17.m1.1.1.2" xref="alg1.l17.m1.1.1.2.cmml">=</mo><mrow id="alg1.l17.m1.1.1.1" xref="alg1.l17.m1.1.1.1.cmml"><mrow id="alg1.l17.m1.1.1.1.3" xref="alg1.l17.m1.1.1.1.3.cmml"><mi id="alg1.l17.m1.1.1.1.3.1" xref="alg1.l17.m1.1.1.1.3.1.cmml">arg</mi><mo id="alg1.l17.m1.1.1.1.3a" lspace="0.167em" xref="alg1.l17.m1.1.1.1.3.cmml">⁡</mo><mrow id="alg1.l17.m1.1.1.1.3.2" xref="alg1.l17.m1.1.1.1.3.2.cmml"><msub id="alg1.l17.m1.1.1.1.3.2.1" xref="alg1.l17.m1.1.1.1.3.2.1.cmml"><mi id="alg1.l17.m1.1.1.1.3.2.1.2" xref="alg1.l17.m1.1.1.1.3.2.1.2.cmml">min</mi><msub id="alg1.l17.m1.1.1.1.3.2.1.3" xref="alg1.l17.m1.1.1.1.3.2.1.3.cmml"><mi id="alg1.l17.m1.1.1.1.3.2.1.3.2" xref="alg1.l17.m1.1.1.1.3.2.1.3.2.cmml">ψ</mi><mi id="alg1.l17.m1.1.1.1.3.2.1.3.3" xref="alg1.l17.m1.1.1.1.3.2.1.3.3.cmml">k</mi></msub></msub><mo id="alg1.l17.m1.1.1.1.3.2a" lspace="0.167em" xref="alg1.l17.m1.1.1.1.3.2.cmml">⁡</mo><msub id="alg1.l17.m1.1.1.1.3.2.2" xref="alg1.l17.m1.1.1.1.3.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l17.m1.1.1.1.3.2.2.2" xref="alg1.l17.m1.1.1.1.3.2.2.2.cmml">𝒥</mi><mi id="alg1.l17.m1.1.1.1.3.2.2.3" xref="alg1.l17.m1.1.1.1.3.2.2.3.cmml">π</mi></msub></mrow></mrow><mo id="alg1.l17.m1.1.1.1.2" xref="alg1.l17.m1.1.1.1.2.cmml">⁢</mo><mrow id="alg1.l17.m1.1.1.1.1.1" xref="alg1.l17.m1.1.1.1.1.1.1.cmml"><mo id="alg1.l17.m1.1.1.1.1.1.2" stretchy="false" xref="alg1.l17.m1.1.1.1.1.1.1.cmml">(</mo><msub id="alg1.l17.m1.1.1.1.1.1.1" xref="alg1.l17.m1.1.1.1.1.1.1.cmml"><mi id="alg1.l17.m1.1.1.1.1.1.1.2" xref="alg1.l17.m1.1.1.1.1.1.1.2.cmml">ψ</mi><mi id="alg1.l17.m1.1.1.1.1.1.1.3" xref="alg1.l17.m1.1.1.1.1.1.1.3.cmml">k</mi></msub><mo id="alg1.l17.m1.1.1.1.1.1.3" stretchy="false" xref="alg1.l17.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l17.m1.1b"><apply id="alg1.l17.m1.1.1.cmml" xref="alg1.l17.m1.1.1"><eq id="alg1.l17.m1.1.1.2.cmml" xref="alg1.l17.m1.1.1.2"></eq><apply id="alg1.l17.m1.1.1.3.cmml" xref="alg1.l17.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l17.m1.1.1.3.1.cmml" xref="alg1.l17.m1.1.1.3">subscript</csymbol><ci id="alg1.l17.m1.1.1.3.2.cmml" xref="alg1.l17.m1.1.1.3.2">𝜓</ci><apply id="alg1.l17.m1.1.1.3.3.cmml" xref="alg1.l17.m1.1.1.3.3"><plus id="alg1.l17.m1.1.1.3.3.1.cmml" xref="alg1.l17.m1.1.1.3.3.1"></plus><ci id="alg1.l17.m1.1.1.3.3.2.cmml" xref="alg1.l17.m1.1.1.3.3.2">𝑘</ci><cn id="alg1.l17.m1.1.1.3.3.3.cmml" type="integer" xref="alg1.l17.m1.1.1.3.3.3">1</cn></apply></apply><apply id="alg1.l17.m1.1.1.1.cmml" xref="alg1.l17.m1.1.1.1"><times id="alg1.l17.m1.1.1.1.2.cmml" xref="alg1.l17.m1.1.1.1.2"></times><apply id="alg1.l17.m1.1.1.1.3.cmml" xref="alg1.l17.m1.1.1.1.3"><arg id="alg1.l17.m1.1.1.1.3.1.cmml" xref="alg1.l17.m1.1.1.1.3.1"></arg><apply id="alg1.l17.m1.1.1.1.3.2.cmml" xref="alg1.l17.m1.1.1.1.3.2"><apply id="alg1.l17.m1.1.1.1.3.2.1.cmml" xref="alg1.l17.m1.1.1.1.3.2.1"><csymbol cd="ambiguous" id="alg1.l17.m1.1.1.1.3.2.1.1.cmml" xref="alg1.l17.m1.1.1.1.3.2.1">subscript</csymbol><min id="alg1.l17.m1.1.1.1.3.2.1.2.cmml" xref="alg1.l17.m1.1.1.1.3.2.1.2"></min><apply id="alg1.l17.m1.1.1.1.3.2.1.3.cmml" xref="alg1.l17.m1.1.1.1.3.2.1.3"><csymbol cd="ambiguous" id="alg1.l17.m1.1.1.1.3.2.1.3.1.cmml" xref="alg1.l17.m1.1.1.1.3.2.1.3">subscript</csymbol><ci id="alg1.l17.m1.1.1.1.3.2.1.3.2.cmml" xref="alg1.l17.m1.1.1.1.3.2.1.3.2">𝜓</ci><ci id="alg1.l17.m1.1.1.1.3.2.1.3.3.cmml" xref="alg1.l17.m1.1.1.1.3.2.1.3.3">𝑘</ci></apply></apply><apply id="alg1.l17.m1.1.1.1.3.2.2.cmml" xref="alg1.l17.m1.1.1.1.3.2.2"><csymbol cd="ambiguous" id="alg1.l17.m1.1.1.1.3.2.2.1.cmml" xref="alg1.l17.m1.1.1.1.3.2.2">subscript</csymbol><ci id="alg1.l17.m1.1.1.1.3.2.2.2.cmml" xref="alg1.l17.m1.1.1.1.3.2.2.2">𝒥</ci><ci id="alg1.l17.m1.1.1.1.3.2.2.3.cmml" xref="alg1.l17.m1.1.1.1.3.2.2.3">𝜋</ci></apply></apply></apply><apply id="alg1.l17.m1.1.1.1.1.1.1.cmml" xref="alg1.l17.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l17.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l17.m1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l17.m1.1.1.1.1.1.1.2.cmml" xref="alg1.l17.m1.1.1.1.1.1.1.2">𝜓</ci><ci id="alg1.l17.m1.1.1.1.1.1.1.3.cmml" xref="alg1.l17.m1.1.1.1.1.1.1.3">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l17.m1.1c">\psi_{k+1}=\arg\min_{\psi_{k}}{\mathcal{J}}_{\pi}(\psi_{k})</annotation><annotation encoding="application/x-llamapun" id="alg1.l17.m1.1d">italic_ψ start_POSTSUBSCRIPT italic_k + 1 end_POSTSUBSCRIPT = roman_arg roman_min start_POSTSUBSCRIPT italic_ψ start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_POSTSUBSCRIPT caligraphic_J start_POSTSUBSCRIPT italic_π end_POSTSUBSCRIPT ( italic_ψ start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT )</annotation></semantics></math> {Update <math alttext="\psi_{k}" class="ltx_Math" display="inline" id="alg1.l17.m2.1"><semantics id="alg1.l17.m2.1a"><msub id="alg1.l17.m2.1.1" xref="alg1.l17.m2.1.1.cmml"><mi id="alg1.l17.m2.1.1.2" xref="alg1.l17.m2.1.1.2.cmml">ψ</mi><mi id="alg1.l17.m2.1.1.3" xref="alg1.l17.m2.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l17.m2.1b"><apply id="alg1.l17.m2.1.1.cmml" xref="alg1.l17.m2.1.1"><csymbol cd="ambiguous" id="alg1.l17.m2.1.1.1.cmml" xref="alg1.l17.m2.1.1">subscript</csymbol><ci id="alg1.l17.m2.1.1.2.cmml" xref="alg1.l17.m2.1.1.2">𝜓</ci><ci id="alg1.l17.m2.1.1.3.cmml" xref="alg1.l17.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l17.m2.1c">\psi_{k}</annotation><annotation encoding="application/x-llamapun" id="alg1.l17.m2.1d">italic_ψ start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> by minimizing Eq. <a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#S4.E9" title="In Objective function ‣ 4.1 Bisimulation Metric for Model Predictive Control ‣ 4 Bisimulation metric for model predictive control ‣ Bisimulation metric for Model Predictive Control"><span class="ltx_text ltx_ref_tag">9</span></a>}

</div>
<div class="ltx_listingline" id="alg1.l18">
<span class="ltx_tag ltx_tag_listingline">18:</span>     <span class="ltx_text ltx_font_bold" id="alg1.l18.1">end</span> <span class="ltx_text ltx_font_bold" id="alg1.l18.2">for</span>
</div>
<div class="ltx_listingline" id="alg1.l19">
<span class="ltx_tag ltx_tag_listingline">19:</span>     <math alttext="\theta=\theta_{K+1}" class="ltx_Math" display="inline" id="alg1.l19.m1.1"><semantics id="alg1.l19.m1.1a"><mrow id="alg1.l19.m1.1.1" xref="alg1.l19.m1.1.1.cmml"><mi id="alg1.l19.m1.1.1.2" xref="alg1.l19.m1.1.1.2.cmml">θ</mi><mo id="alg1.l19.m1.1.1.1" xref="alg1.l19.m1.1.1.1.cmml">=</mo><msub id="alg1.l19.m1.1.1.3" xref="alg1.l19.m1.1.1.3.cmml"><mi id="alg1.l19.m1.1.1.3.2" xref="alg1.l19.m1.1.1.3.2.cmml">θ</mi><mrow id="alg1.l19.m1.1.1.3.3" xref="alg1.l19.m1.1.1.3.3.cmml"><mi id="alg1.l19.m1.1.1.3.3.2" xref="alg1.l19.m1.1.1.3.3.2.cmml">K</mi><mo id="alg1.l19.m1.1.1.3.3.1" xref="alg1.l19.m1.1.1.3.3.1.cmml">+</mo><mn id="alg1.l19.m1.1.1.3.3.3" xref="alg1.l19.m1.1.1.3.3.3.cmml">1</mn></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l19.m1.1b"><apply id="alg1.l19.m1.1.1.cmml" xref="alg1.l19.m1.1.1"><eq id="alg1.l19.m1.1.1.1.cmml" xref="alg1.l19.m1.1.1.1"></eq><ci id="alg1.l19.m1.1.1.2.cmml" xref="alg1.l19.m1.1.1.2">𝜃</ci><apply id="alg1.l19.m1.1.1.3.cmml" xref="alg1.l19.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l19.m1.1.1.3.1.cmml" xref="alg1.l19.m1.1.1.3">subscript</csymbol><ci id="alg1.l19.m1.1.1.3.2.cmml" xref="alg1.l19.m1.1.1.3.2">𝜃</ci><apply id="alg1.l19.m1.1.1.3.3.cmml" xref="alg1.l19.m1.1.1.3.3"><plus id="alg1.l19.m1.1.1.3.3.1.cmml" xref="alg1.l19.m1.1.1.3.3.1"></plus><ci id="alg1.l19.m1.1.1.3.3.2.cmml" xref="alg1.l19.m1.1.1.3.3.2">𝐾</ci><cn id="alg1.l19.m1.1.1.3.3.3.cmml" type="integer" xref="alg1.l19.m1.1.1.3.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l19.m1.1c">\theta=\theta_{K+1}</annotation><annotation encoding="application/x-llamapun" id="alg1.l19.m1.1d">italic_θ = italic_θ start_POSTSUBSCRIPT italic_K + 1 end_POSTSUBSCRIPT</annotation></semantics></math> {Update current parameter}

</div>
<div class="ltx_listingline" id="alg1.l20">
<span class="ltx_tag ltx_tag_listingline">20:</span>  <span class="ltx_text ltx_font_bold" id="alg1.l20.1">end</span> <span class="ltx_text ltx_font_bold" id="alg1.l20.2">while</span>
</div>
</div>
</div>
</div>
</figure>
</figure>
</section>
<section class="ltx_appendix" id="A4">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix D </span>BS-MPC vs TD-MPC2</h2>
<div class="ltx_para ltx_noindent" id="A4.p1">
<p class="ltx_p" id="A4.p1.1">TD-MPC2 <cite class="ltx_cite ltx_citemacro_citep">(Hansen et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#bib.bib16" title="">2024</a>)</cite> is the successor of TD-MPC <cite class="ltx_cite ltx_citemacro_cite">Hansen et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#bib.bib17" title="">2022</a>)</cite>, and it modifies the architecture by increasing the model size and adapting distributional reinforcement learning to its cost function. Although it fixes some open problems in TD-MPC, it still suffers from long calculation time due to the model size expansion. Moreover, it has less theoretical background to support the encoder validity.</p>
</div>
<div class="ltx_para ltx_noindent" id="A4.p2">
<p class="ltx_p" id="A4.p2.1">We compare BS-MPC with TD-MPC2 on both state-based and image-based tasks from the DMControl suite. Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#A4.F9" title="Figure 9 ‣ Appendix D BS-MPC vs TD-MPC2 ‣ Bisimulation metric for Model Predictive Control"><span class="ltx_text ltx_ref_tag">9</span></a> shows the results for state-based tasks. Both BS-MPC and TD-MPC2 resolve the issue of performance divergence observed in TD-MPC; however, TD-MPC2 requires significantly more parameters and employs more complex model architectures.
Fig <a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#A4.F10" title="Figure 10 ‣ Appendix D BS-MPC vs TD-MPC2 ‣ Bisimulation metric for Model Predictive Control"><span class="ltx_text ltx_ref_tag">10</span></a> shows the results for image-based tasks. Although TD-MPC2 converges faster than BS-MPC in some tasks (e.g., quadruped-run and walker-run), BS-MPC achieves comparable or slightly better overall performance.
In these experiments, we use the same number of parameters and model architecture as in TD-MPC.</p>
</div>
<figure class="ltx_figure" id="A4.F9"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="263" id="A4.F9.g1" src="extracted/5905356/figures/tdmpc2_state_result.png" width="521"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 9: </span>Comparison with TD-MPC2 in state-based tasks from DMControl Suite. Results for TD-MPC2 are obtained from their official repository. The results are averaged over 3 seeds, with shaded regions representing the standard deviation. The first picture shows the average performance across 26 continuous control tasks from DM Control environment.</figcaption>
</figure>
<figure class="ltx_figure" id="A4.F10"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="168" id="A4.F10.g1" src="extracted/5905356/figures/tdmpc2_image_result.png" width="521"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 10: </span>Comparison with TD-MPC2 in image-based tasks from DMControl Suite. Results for TD-MPC2 are obtained from their official repository. The results are averaged over 3 seeds, with shaded regions representing the standard deviation.</figcaption>
</figure>
</section>
<section class="ltx_appendix" id="A5">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix E </span>Implementation Details</h2>
<div class="ltx_para ltx_noindent" id="A5.p1">
<p class="ltx_p" id="A5.p1.1">Here we give details about the hyper-parameters and model architectures.</p>
</div>
<section class="ltx_subsection" id="A5.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">E.1 </span>Hyperparameters</h3>
<div class="ltx_para ltx_noindent" id="A5.SS1.p1">
<p class="ltx_p" id="A5.SS1.p1.1"><span class="ltx_text ltx_font_bold" id="A5.SS1.p1.1.1">Shared Parameters</span>: First, we outline the parameters that are common to both TD-MPC and BS-MPC. They are described in Table. <a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#A5.T2" title="Table 2 ‣ E.1 Hyperparameters ‣ Appendix E Implementation Details ‣ Bisimulation metric for Model Predictive Control"><span class="ltx_text ltx_ref_tag">2</span></a>.</p>
</div>
<figure class="ltx_table" id="A5.T2">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 2: </span>Hyperparameters used for TD-MPC and BS-MPC in the experiment.</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A5.T2.15">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A5.T2.15.16.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt" id="A5.T2.15.16.1.1"><span class="ltx_text ltx_font_bold" id="A5.T2.15.16.1.1.1">Hyperparameter</span></th>
<td class="ltx_td ltx_align_left ltx_border_tt" id="A5.T2.15.16.1.2"><span class="ltx_text ltx_font_bold" id="A5.T2.15.16.1.2.1">Value</span></td>
</tr>
<tr class="ltx_tr" id="A5.T2.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="A5.T2.1.1.1">Discount factor (<math alttext="\gamma" class="ltx_Math" display="inline" id="A5.T2.1.1.1.m1.1"><semantics id="A5.T2.1.1.1.m1.1a"><mi id="A5.T2.1.1.1.m1.1.1" xref="A5.T2.1.1.1.m1.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="A5.T2.1.1.1.m1.1b"><ci id="A5.T2.1.1.1.m1.1.1.cmml" xref="A5.T2.1.1.1.m1.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="A5.T2.1.1.1.m1.1c">\gamma</annotation><annotation encoding="application/x-llamapun" id="A5.T2.1.1.1.m1.1d">italic_γ</annotation></semantics></math>)</th>
<td class="ltx_td ltx_align_left ltx_border_t" id="A5.T2.1.1.2">0.99</td>
</tr>
<tr class="ltx_tr" id="A5.T2.15.17.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A5.T2.15.17.2.1">Seed steps</th>
<td class="ltx_td ltx_align_left" id="A5.T2.15.17.2.2">5,000</td>
</tr>
<tr class="ltx_tr" id="A5.T2.15.18.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A5.T2.15.18.3.1">Replay buffer size</th>
<td class="ltx_td ltx_align_left" id="A5.T2.15.18.3.2">1,000,000 (state-based tasks)</td>
</tr>
<tr class="ltx_tr" id="A5.T2.15.19.4">
<th class="ltx_td ltx_th ltx_th_row" id="A5.T2.15.19.4.1"></th>
<td class="ltx_td ltx_align_left" id="A5.T2.15.19.4.2">100,000 (image-based tasks)</td>
</tr>
<tr class="ltx_tr" id="A5.T2.15.20.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A5.T2.15.20.5.1">Sampling technique</th>
<td class="ltx_td ltx_align_left" id="A5.T2.15.20.5.2">Uniform Sampling</td>
</tr>
<tr class="ltx_tr" id="A5.T2.2.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A5.T2.2.2.1">Planning horizon (<math alttext="H" class="ltx_Math" display="inline" id="A5.T2.2.2.1.m1.1"><semantics id="A5.T2.2.2.1.m1.1a"><mi id="A5.T2.2.2.1.m1.1.1" xref="A5.T2.2.2.1.m1.1.1.cmml">H</mi><annotation-xml encoding="MathML-Content" id="A5.T2.2.2.1.m1.1b"><ci id="A5.T2.2.2.1.m1.1.1.cmml" xref="A5.T2.2.2.1.m1.1.1">𝐻</ci></annotation-xml><annotation encoding="application/x-tex" id="A5.T2.2.2.1.m1.1c">H</annotation><annotation encoding="application/x-llamapun" id="A5.T2.2.2.1.m1.1d">italic_H</annotation></semantics></math>)</th>
<td class="ltx_td ltx_align_left" id="A5.T2.2.2.2">5</td>
</tr>
<tr class="ltx_tr" id="A5.T2.3.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A5.T2.3.3.1">Initial parameters (<math alttext="\mu^{0},\sigma^{0}" class="ltx_Math" display="inline" id="A5.T2.3.3.1.m1.2"><semantics id="A5.T2.3.3.1.m1.2a"><mrow id="A5.T2.3.3.1.m1.2.2.2" xref="A5.T2.3.3.1.m1.2.2.3.cmml"><msup id="A5.T2.3.3.1.m1.1.1.1.1" xref="A5.T2.3.3.1.m1.1.1.1.1.cmml"><mi id="A5.T2.3.3.1.m1.1.1.1.1.2" xref="A5.T2.3.3.1.m1.1.1.1.1.2.cmml">μ</mi><mn id="A5.T2.3.3.1.m1.1.1.1.1.3" xref="A5.T2.3.3.1.m1.1.1.1.1.3.cmml">0</mn></msup><mo id="A5.T2.3.3.1.m1.2.2.2.3" xref="A5.T2.3.3.1.m1.2.2.3.cmml">,</mo><msup id="A5.T2.3.3.1.m1.2.2.2.2" xref="A5.T2.3.3.1.m1.2.2.2.2.cmml"><mi id="A5.T2.3.3.1.m1.2.2.2.2.2" xref="A5.T2.3.3.1.m1.2.2.2.2.2.cmml">σ</mi><mn id="A5.T2.3.3.1.m1.2.2.2.2.3" xref="A5.T2.3.3.1.m1.2.2.2.2.3.cmml">0</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="A5.T2.3.3.1.m1.2b"><list id="A5.T2.3.3.1.m1.2.2.3.cmml" xref="A5.T2.3.3.1.m1.2.2.2"><apply id="A5.T2.3.3.1.m1.1.1.1.1.cmml" xref="A5.T2.3.3.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="A5.T2.3.3.1.m1.1.1.1.1.1.cmml" xref="A5.T2.3.3.1.m1.1.1.1.1">superscript</csymbol><ci id="A5.T2.3.3.1.m1.1.1.1.1.2.cmml" xref="A5.T2.3.3.1.m1.1.1.1.1.2">𝜇</ci><cn id="A5.T2.3.3.1.m1.1.1.1.1.3.cmml" type="integer" xref="A5.T2.3.3.1.m1.1.1.1.1.3">0</cn></apply><apply id="A5.T2.3.3.1.m1.2.2.2.2.cmml" xref="A5.T2.3.3.1.m1.2.2.2.2"><csymbol cd="ambiguous" id="A5.T2.3.3.1.m1.2.2.2.2.1.cmml" xref="A5.T2.3.3.1.m1.2.2.2.2">superscript</csymbol><ci id="A5.T2.3.3.1.m1.2.2.2.2.2.cmml" xref="A5.T2.3.3.1.m1.2.2.2.2.2">𝜎</ci><cn id="A5.T2.3.3.1.m1.2.2.2.2.3.cmml" type="integer" xref="A5.T2.3.3.1.m1.2.2.2.2.3">0</cn></apply></list></annotation-xml><annotation encoding="application/x-tex" id="A5.T2.3.3.1.m1.2c">\mu^{0},\sigma^{0}</annotation><annotation encoding="application/x-llamapun" id="A5.T2.3.3.1.m1.2d">italic_μ start_POSTSUPERSCRIPT 0 end_POSTSUPERSCRIPT , italic_σ start_POSTSUPERSCRIPT 0 end_POSTSUPERSCRIPT</annotation></semantics></math>)</th>
<td class="ltx_td ltx_align_left" id="A5.T2.3.3.2">(0, 2)</td>
</tr>
<tr class="ltx_tr" id="A5.T2.15.21.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A5.T2.15.21.6.1">Population size</th>
<td class="ltx_td ltx_align_left" id="A5.T2.15.21.6.2">512</td>
</tr>
<tr class="ltx_tr" id="A5.T2.15.22.7">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A5.T2.15.22.7.1">Elite fraction</th>
<td class="ltx_td ltx_align_left" id="A5.T2.15.22.7.2">64</td>
</tr>
<tr class="ltx_tr" id="A5.T2.15.23.8">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A5.T2.15.23.8.1">MPPI Update Iterations</th>
<td class="ltx_td ltx_align_left" id="A5.T2.15.23.8.2">12 (Humanoid, Dog)</td>
</tr>
<tr class="ltx_tr" id="A5.T2.15.24.9">
<th class="ltx_td ltx_th ltx_th_row" id="A5.T2.15.24.9.1"></th>
<td class="ltx_td ltx_align_left" id="A5.T2.15.24.9.2">6 (otherwise)</td>
</tr>
<tr class="ltx_tr" id="A5.T2.15.25.10">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A5.T2.15.25.10.1">Policy fraction</th>
<td class="ltx_td ltx_align_left" id="A5.T2.15.25.10.2">5%</td>
</tr>
<tr class="ltx_tr" id="A5.T2.15.26.11">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A5.T2.15.26.11.1">Number of particles</th>
<td class="ltx_td ltx_align_left" id="A5.T2.15.26.11.2">1</td>
</tr>
<tr class="ltx_tr" id="A5.T2.4.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A5.T2.4.4.1">Temperature (<math alttext="\tau" class="ltx_Math" display="inline" id="A5.T2.4.4.1.m1.1"><semantics id="A5.T2.4.4.1.m1.1a"><mi id="A5.T2.4.4.1.m1.1.1" xref="A5.T2.4.4.1.m1.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="A5.T2.4.4.1.m1.1b"><ci id="A5.T2.4.4.1.m1.1.1.cmml" xref="A5.T2.4.4.1.m1.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="A5.T2.4.4.1.m1.1c">\tau</annotation><annotation encoding="application/x-llamapun" id="A5.T2.4.4.1.m1.1d">italic_τ</annotation></semantics></math>)</th>
<td class="ltx_td ltx_align_left" id="A5.T2.4.4.2">0.5</td>
</tr>
<tr class="ltx_tr" id="A5.T2.15.27.12">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A5.T2.15.27.12.1">Latent dimension</th>
<td class="ltx_td ltx_align_left" id="A5.T2.15.27.12.2">100 (Humanoid, Dog)</td>
</tr>
<tr class="ltx_tr" id="A5.T2.15.28.13">
<th class="ltx_td ltx_th ltx_th_row" id="A5.T2.15.28.13.1"></th>
<td class="ltx_td ltx_align_left" id="A5.T2.15.28.13.2">50 (otherwise)</td>
</tr>
<tr class="ltx_tr" id="A5.T2.15.29.14">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A5.T2.15.29.14.1">Learning rate</th>
<td class="ltx_td ltx_align_left" id="A5.T2.15.29.14.2">3e-4 (pixels)</td>
</tr>
<tr class="ltx_tr" id="A5.T2.15.30.15">
<th class="ltx_td ltx_th ltx_th_row" id="A5.T2.15.30.15.1"></th>
<td class="ltx_td ltx_align_left" id="A5.T2.15.30.15.2">1e-3 (otherwise)</td>
</tr>
<tr class="ltx_tr" id="A5.T2.6.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A5.T2.5.5.1">Optimizer (<math alttext="\theta" class="ltx_Math" display="inline" id="A5.T2.5.5.1.m1.1"><semantics id="A5.T2.5.5.1.m1.1a"><mi id="A5.T2.5.5.1.m1.1.1" xref="A5.T2.5.5.1.m1.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="A5.T2.5.5.1.m1.1b"><ci id="A5.T2.5.5.1.m1.1.1.cmml" xref="A5.T2.5.5.1.m1.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="A5.T2.5.5.1.m1.1c">\theta</annotation><annotation encoding="application/x-llamapun" id="A5.T2.5.5.1.m1.1d">italic_θ</annotation></semantics></math>)</th>
<td class="ltx_td ltx_align_left" id="A5.T2.6.6.2">Adam (<math alttext="\beta_{1}=0.9,\beta_{2}=0.999" class="ltx_Math" display="inline" id="A5.T2.6.6.2.m1.2"><semantics id="A5.T2.6.6.2.m1.2a"><mrow id="A5.T2.6.6.2.m1.2.2.2" xref="A5.T2.6.6.2.m1.2.2.3.cmml"><mrow id="A5.T2.6.6.2.m1.1.1.1.1" xref="A5.T2.6.6.2.m1.1.1.1.1.cmml"><msub id="A5.T2.6.6.2.m1.1.1.1.1.2" xref="A5.T2.6.6.2.m1.1.1.1.1.2.cmml"><mi id="A5.T2.6.6.2.m1.1.1.1.1.2.2" xref="A5.T2.6.6.2.m1.1.1.1.1.2.2.cmml">β</mi><mn id="A5.T2.6.6.2.m1.1.1.1.1.2.3" xref="A5.T2.6.6.2.m1.1.1.1.1.2.3.cmml">1</mn></msub><mo id="A5.T2.6.6.2.m1.1.1.1.1.1" xref="A5.T2.6.6.2.m1.1.1.1.1.1.cmml">=</mo><mn id="A5.T2.6.6.2.m1.1.1.1.1.3" xref="A5.T2.6.6.2.m1.1.1.1.1.3.cmml">0.9</mn></mrow><mo id="A5.T2.6.6.2.m1.2.2.2.3" xref="A5.T2.6.6.2.m1.2.2.3a.cmml">,</mo><mrow id="A5.T2.6.6.2.m1.2.2.2.2" xref="A5.T2.6.6.2.m1.2.2.2.2.cmml"><msub id="A5.T2.6.6.2.m1.2.2.2.2.2" xref="A5.T2.6.6.2.m1.2.2.2.2.2.cmml"><mi id="A5.T2.6.6.2.m1.2.2.2.2.2.2" xref="A5.T2.6.6.2.m1.2.2.2.2.2.2.cmml">β</mi><mn id="A5.T2.6.6.2.m1.2.2.2.2.2.3" xref="A5.T2.6.6.2.m1.2.2.2.2.2.3.cmml">2</mn></msub><mo id="A5.T2.6.6.2.m1.2.2.2.2.1" xref="A5.T2.6.6.2.m1.2.2.2.2.1.cmml">=</mo><mn id="A5.T2.6.6.2.m1.2.2.2.2.3" xref="A5.T2.6.6.2.m1.2.2.2.2.3.cmml">0.999</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="A5.T2.6.6.2.m1.2b"><apply id="A5.T2.6.6.2.m1.2.2.3.cmml" xref="A5.T2.6.6.2.m1.2.2.2"><csymbol cd="ambiguous" id="A5.T2.6.6.2.m1.2.2.3a.cmml" xref="A5.T2.6.6.2.m1.2.2.2.3">formulae-sequence</csymbol><apply id="A5.T2.6.6.2.m1.1.1.1.1.cmml" xref="A5.T2.6.6.2.m1.1.1.1.1"><eq id="A5.T2.6.6.2.m1.1.1.1.1.1.cmml" xref="A5.T2.6.6.2.m1.1.1.1.1.1"></eq><apply id="A5.T2.6.6.2.m1.1.1.1.1.2.cmml" xref="A5.T2.6.6.2.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="A5.T2.6.6.2.m1.1.1.1.1.2.1.cmml" xref="A5.T2.6.6.2.m1.1.1.1.1.2">subscript</csymbol><ci id="A5.T2.6.6.2.m1.1.1.1.1.2.2.cmml" xref="A5.T2.6.6.2.m1.1.1.1.1.2.2">𝛽</ci><cn id="A5.T2.6.6.2.m1.1.1.1.1.2.3.cmml" type="integer" xref="A5.T2.6.6.2.m1.1.1.1.1.2.3">1</cn></apply><cn id="A5.T2.6.6.2.m1.1.1.1.1.3.cmml" type="float" xref="A5.T2.6.6.2.m1.1.1.1.1.3">0.9</cn></apply><apply id="A5.T2.6.6.2.m1.2.2.2.2.cmml" xref="A5.T2.6.6.2.m1.2.2.2.2"><eq id="A5.T2.6.6.2.m1.2.2.2.2.1.cmml" xref="A5.T2.6.6.2.m1.2.2.2.2.1"></eq><apply id="A5.T2.6.6.2.m1.2.2.2.2.2.cmml" xref="A5.T2.6.6.2.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="A5.T2.6.6.2.m1.2.2.2.2.2.1.cmml" xref="A5.T2.6.6.2.m1.2.2.2.2.2">subscript</csymbol><ci id="A5.T2.6.6.2.m1.2.2.2.2.2.2.cmml" xref="A5.T2.6.6.2.m1.2.2.2.2.2.2">𝛽</ci><cn id="A5.T2.6.6.2.m1.2.2.2.2.2.3.cmml" type="integer" xref="A5.T2.6.6.2.m1.2.2.2.2.2.3">2</cn></apply><cn id="A5.T2.6.6.2.m1.2.2.2.2.3.cmml" type="float" xref="A5.T2.6.6.2.m1.2.2.2.2.3">0.999</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.T2.6.6.2.m1.2c">\beta_{1}=0.9,\beta_{2}=0.999</annotation><annotation encoding="application/x-llamapun" id="A5.T2.6.6.2.m1.2d">italic_β start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT = 0.9 , italic_β start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT = 0.999</annotation></semantics></math>)</td>
</tr>
<tr class="ltx_tr" id="A5.T2.7.7">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A5.T2.7.7.1">Temporal coefficient (<math alttext="\lambda" class="ltx_Math" display="inline" id="A5.T2.7.7.1.m1.1"><semantics id="A5.T2.7.7.1.m1.1a"><mi id="A5.T2.7.7.1.m1.1.1" xref="A5.T2.7.7.1.m1.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="A5.T2.7.7.1.m1.1b"><ci id="A5.T2.7.7.1.m1.1.1.cmml" xref="A5.T2.7.7.1.m1.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="A5.T2.7.7.1.m1.1c">\lambda</annotation><annotation encoding="application/x-llamapun" id="A5.T2.7.7.1.m1.1d">italic_λ</annotation></semantics></math>)</th>
<td class="ltx_td ltx_align_left" id="A5.T2.7.7.2">0.5</td>
</tr>
<tr class="ltx_tr" id="A5.T2.8.8">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A5.T2.8.8.1">Reward loss coefficient (<math alttext="c_{1}" class="ltx_Math" display="inline" id="A5.T2.8.8.1.m1.1"><semantics id="A5.T2.8.8.1.m1.1a"><msub id="A5.T2.8.8.1.m1.1.1" xref="A5.T2.8.8.1.m1.1.1.cmml"><mi id="A5.T2.8.8.1.m1.1.1.2" xref="A5.T2.8.8.1.m1.1.1.2.cmml">c</mi><mn id="A5.T2.8.8.1.m1.1.1.3" xref="A5.T2.8.8.1.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="A5.T2.8.8.1.m1.1b"><apply id="A5.T2.8.8.1.m1.1.1.cmml" xref="A5.T2.8.8.1.m1.1.1"><csymbol cd="ambiguous" id="A5.T2.8.8.1.m1.1.1.1.cmml" xref="A5.T2.8.8.1.m1.1.1">subscript</csymbol><ci id="A5.T2.8.8.1.m1.1.1.2.cmml" xref="A5.T2.8.8.1.m1.1.1.2">𝑐</ci><cn id="A5.T2.8.8.1.m1.1.1.3.cmml" type="integer" xref="A5.T2.8.8.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.T2.8.8.1.m1.1c">c_{1}</annotation><annotation encoding="application/x-llamapun" id="A5.T2.8.8.1.m1.1d">italic_c start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math>)</th>
<td class="ltx_td ltx_align_left" id="A5.T2.8.8.2">0.5</td>
</tr>
<tr class="ltx_tr" id="A5.T2.9.9">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A5.T2.9.9.1">Value loss coefficient (<math alttext="c_{2}" class="ltx_Math" display="inline" id="A5.T2.9.9.1.m1.1"><semantics id="A5.T2.9.9.1.m1.1a"><msub id="A5.T2.9.9.1.m1.1.1" xref="A5.T2.9.9.1.m1.1.1.cmml"><mi id="A5.T2.9.9.1.m1.1.1.2" xref="A5.T2.9.9.1.m1.1.1.2.cmml">c</mi><mn id="A5.T2.9.9.1.m1.1.1.3" xref="A5.T2.9.9.1.m1.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="A5.T2.9.9.1.m1.1b"><apply id="A5.T2.9.9.1.m1.1.1.cmml" xref="A5.T2.9.9.1.m1.1.1"><csymbol cd="ambiguous" id="A5.T2.9.9.1.m1.1.1.1.cmml" xref="A5.T2.9.9.1.m1.1.1">subscript</csymbol><ci id="A5.T2.9.9.1.m1.1.1.2.cmml" xref="A5.T2.9.9.1.m1.1.1.2">𝑐</ci><cn id="A5.T2.9.9.1.m1.1.1.3.cmml" type="integer" xref="A5.T2.9.9.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.T2.9.9.1.m1.1c">c_{2}</annotation><annotation encoding="application/x-llamapun" id="A5.T2.9.9.1.m1.1d">italic_c start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>)</th>
<td class="ltx_td ltx_align_left" id="A5.T2.9.9.2">0.1</td>
</tr>
<tr class="ltx_tr" id="A5.T2.10.10">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A5.T2.10.10.1">Consistency loss coefficient (<math alttext="c_{3}" class="ltx_Math" display="inline" id="A5.T2.10.10.1.m1.1"><semantics id="A5.T2.10.10.1.m1.1a"><msub id="A5.T2.10.10.1.m1.1.1" xref="A5.T2.10.10.1.m1.1.1.cmml"><mi id="A5.T2.10.10.1.m1.1.1.2" xref="A5.T2.10.10.1.m1.1.1.2.cmml">c</mi><mn id="A5.T2.10.10.1.m1.1.1.3" xref="A5.T2.10.10.1.m1.1.1.3.cmml">3</mn></msub><annotation-xml encoding="MathML-Content" id="A5.T2.10.10.1.m1.1b"><apply id="A5.T2.10.10.1.m1.1.1.cmml" xref="A5.T2.10.10.1.m1.1.1"><csymbol cd="ambiguous" id="A5.T2.10.10.1.m1.1.1.1.cmml" xref="A5.T2.10.10.1.m1.1.1">subscript</csymbol><ci id="A5.T2.10.10.1.m1.1.1.2.cmml" xref="A5.T2.10.10.1.m1.1.1.2">𝑐</ci><cn id="A5.T2.10.10.1.m1.1.1.3.cmml" type="integer" xref="A5.T2.10.10.1.m1.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.T2.10.10.1.m1.1c">c_{3}</annotation><annotation encoding="application/x-llamapun" id="A5.T2.10.10.1.m1.1d">italic_c start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT</annotation></semantics></math>)</th>
<td class="ltx_td ltx_align_left" id="A5.T2.10.10.2">0.5</td>
</tr>
<tr class="ltx_tr" id="A5.T2.12.12">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A5.T2.11.11.1">Exploration schedule (<math alttext="\epsilon" class="ltx_Math" display="inline" id="A5.T2.11.11.1.m1.1"><semantics id="A5.T2.11.11.1.m1.1a"><mi id="A5.T2.11.11.1.m1.1.1" xref="A5.T2.11.11.1.m1.1.1.cmml">ϵ</mi><annotation-xml encoding="MathML-Content" id="A5.T2.11.11.1.m1.1b"><ci id="A5.T2.11.11.1.m1.1.1.cmml" xref="A5.T2.11.11.1.m1.1.1">italic-ϵ</ci></annotation-xml><annotation encoding="application/x-tex" id="A5.T2.11.11.1.m1.1c">\epsilon</annotation><annotation encoding="application/x-llamapun" id="A5.T2.11.11.1.m1.1d">italic_ϵ</annotation></semantics></math>)</th>
<td class="ltx_td ltx_align_left" id="A5.T2.12.12.2">0.5 <math alttext="\to" class="ltx_Math" display="inline" id="A5.T2.12.12.2.m1.1"><semantics id="A5.T2.12.12.2.m1.1a"><mo id="A5.T2.12.12.2.m1.1.1" stretchy="false" xref="A5.T2.12.12.2.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="A5.T2.12.12.2.m1.1b"><ci id="A5.T2.12.12.2.m1.1.1.cmml" xref="A5.T2.12.12.2.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="A5.T2.12.12.2.m1.1c">\to</annotation><annotation encoding="application/x-llamapun" id="A5.T2.12.12.2.m1.1d">→</annotation></semantics></math> 0.05 (25k steps)</td>
</tr>
<tr class="ltx_tr" id="A5.T2.13.13">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A5.T2.13.13.2">Planning horizon schedule</th>
<td class="ltx_td ltx_align_left" id="A5.T2.13.13.1">1 <math alttext="\to" class="ltx_Math" display="inline" id="A5.T2.13.13.1.m1.1"><semantics id="A5.T2.13.13.1.m1.1a"><mo id="A5.T2.13.13.1.m1.1.1" stretchy="false" xref="A5.T2.13.13.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="A5.T2.13.13.1.m1.1b"><ci id="A5.T2.13.13.1.m1.1.1.cmml" xref="A5.T2.13.13.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="A5.T2.13.13.1.m1.1c">\to</annotation><annotation encoding="application/x-llamapun" id="A5.T2.13.13.1.m1.1d">→</annotation></semantics></math> 5 (25k steps)</td>
</tr>
<tr class="ltx_tr" id="A5.T2.15.31.16">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A5.T2.15.31.16.1">Batch size</th>
<td class="ltx_td ltx_align_left" id="A5.T2.15.31.16.2">512 (State-based tasks)</td>
</tr>
<tr class="ltx_tr" id="A5.T2.15.32.17">
<th class="ltx_td ltx_th ltx_th_row" id="A5.T2.15.32.17.1"></th>
<td class="ltx_td ltx_align_left" id="A5.T2.15.32.17.2">256 (Image-based tasks)</td>
</tr>
<tr class="ltx_tr" id="A5.T2.14.14">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A5.T2.14.14.1">Momentum coefficient (<math alttext="\zeta" class="ltx_Math" display="inline" id="A5.T2.14.14.1.m1.1"><semantics id="A5.T2.14.14.1.m1.1a"><mi id="A5.T2.14.14.1.m1.1.1" xref="A5.T2.14.14.1.m1.1.1.cmml">ζ</mi><annotation-xml encoding="MathML-Content" id="A5.T2.14.14.1.m1.1b"><ci id="A5.T2.14.14.1.m1.1.1.cmml" xref="A5.T2.14.14.1.m1.1.1">𝜁</ci></annotation-xml><annotation encoding="application/x-tex" id="A5.T2.14.14.1.m1.1c">\zeta</annotation><annotation encoding="application/x-llamapun" id="A5.T2.14.14.1.m1.1d">italic_ζ</annotation></semantics></math>)</th>
<td class="ltx_td ltx_align_left" id="A5.T2.14.14.2">0.99</td>
</tr>
<tr class="ltx_tr" id="A5.T2.15.33.18">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A5.T2.15.33.18.1">Steps per gradient update</th>
<td class="ltx_td ltx_align_left" id="A5.T2.15.33.18.2">1</td>
</tr>
<tr class="ltx_tr" id="A5.T2.15.15">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="A5.T2.15.15.1">Target parameter <math alttext="\bar{\theta}" class="ltx_Math" display="inline" id="A5.T2.15.15.1.m1.1"><semantics id="A5.T2.15.15.1.m1.1a"><mover accent="true" id="A5.T2.15.15.1.m1.1.1" xref="A5.T2.15.15.1.m1.1.1.cmml"><mi id="A5.T2.15.15.1.m1.1.1.2" xref="A5.T2.15.15.1.m1.1.1.2.cmml">θ</mi><mo id="A5.T2.15.15.1.m1.1.1.1" xref="A5.T2.15.15.1.m1.1.1.1.cmml">¯</mo></mover><annotation-xml encoding="MathML-Content" id="A5.T2.15.15.1.m1.1b"><apply id="A5.T2.15.15.1.m1.1.1.cmml" xref="A5.T2.15.15.1.m1.1.1"><ci id="A5.T2.15.15.1.m1.1.1.1.cmml" xref="A5.T2.15.15.1.m1.1.1.1">¯</ci><ci id="A5.T2.15.15.1.m1.1.1.2.cmml" xref="A5.T2.15.15.1.m1.1.1.2">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.T2.15.15.1.m1.1c">\bar{\theta}</annotation><annotation encoding="application/x-llamapun" id="A5.T2.15.15.1.m1.1d">over¯ start_ARG italic_θ end_ARG</annotation></semantics></math> update frequency</th>
<td class="ltx_td ltx_align_left ltx_border_bb" id="A5.T2.15.15.2">2</td>
</tr>
</tbody>
</table>
</figure>
<div class="ltx_para ltx_noindent" id="A5.SS1.p2">
<p class="ltx_p" id="A5.SS1.p2.3"><span class="ltx_text ltx_font_bold" id="A5.SS1.p2.3.1">BS-MPC specific parameters</span>: Next, we list the parameter that is used for tuning the weight for bisimulation metric loss <math alttext="(c_{4})" class="ltx_Math" display="inline" id="A5.SS1.p2.1.m1.1"><semantics id="A5.SS1.p2.1.m1.1a"><mrow id="A5.SS1.p2.1.m1.1.1.1" xref="A5.SS1.p2.1.m1.1.1.1.1.cmml"><mo id="A5.SS1.p2.1.m1.1.1.1.2" stretchy="false" xref="A5.SS1.p2.1.m1.1.1.1.1.cmml">(</mo><msub id="A5.SS1.p2.1.m1.1.1.1.1" xref="A5.SS1.p2.1.m1.1.1.1.1.cmml"><mi id="A5.SS1.p2.1.m1.1.1.1.1.2" xref="A5.SS1.p2.1.m1.1.1.1.1.2.cmml">c</mi><mn id="A5.SS1.p2.1.m1.1.1.1.1.3" xref="A5.SS1.p2.1.m1.1.1.1.1.3.cmml">4</mn></msub><mo id="A5.SS1.p2.1.m1.1.1.1.3" stretchy="false" xref="A5.SS1.p2.1.m1.1.1.1.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="A5.SS1.p2.1.m1.1b"><apply id="A5.SS1.p2.1.m1.1.1.1.1.cmml" xref="A5.SS1.p2.1.m1.1.1.1"><csymbol cd="ambiguous" id="A5.SS1.p2.1.m1.1.1.1.1.1.cmml" xref="A5.SS1.p2.1.m1.1.1.1">subscript</csymbol><ci id="A5.SS1.p2.1.m1.1.1.1.1.2.cmml" xref="A5.SS1.p2.1.m1.1.1.1.1.2">𝑐</ci><cn id="A5.SS1.p2.1.m1.1.1.1.1.3.cmml" type="integer" xref="A5.SS1.p2.1.m1.1.1.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.SS1.p2.1.m1.1c">(c_{4})</annotation><annotation encoding="application/x-llamapun" id="A5.SS1.p2.1.m1.1d">( italic_c start_POSTSUBSCRIPT 4 end_POSTSUBSCRIPT )</annotation></semantics></math>.
We change the value based on the environment and tune the weighting coefficient <math alttext="c_{4}" class="ltx_Math" display="inline" id="A5.SS1.p2.2.m2.1"><semantics id="A5.SS1.p2.2.m2.1a"><msub id="A5.SS1.p2.2.m2.1.1" xref="A5.SS1.p2.2.m2.1.1.cmml"><mi id="A5.SS1.p2.2.m2.1.1.2" xref="A5.SS1.p2.2.m2.1.1.2.cmml">c</mi><mn id="A5.SS1.p2.2.m2.1.1.3" xref="A5.SS1.p2.2.m2.1.1.3.cmml">4</mn></msub><annotation-xml encoding="MathML-Content" id="A5.SS1.p2.2.m2.1b"><apply id="A5.SS1.p2.2.m2.1.1.cmml" xref="A5.SS1.p2.2.m2.1.1"><csymbol cd="ambiguous" id="A5.SS1.p2.2.m2.1.1.1.cmml" xref="A5.SS1.p2.2.m2.1.1">subscript</csymbol><ci id="A5.SS1.p2.2.m2.1.1.2.cmml" xref="A5.SS1.p2.2.m2.1.1.2">𝑐</ci><cn id="A5.SS1.p2.2.m2.1.1.3.cmml" type="integer" xref="A5.SS1.p2.2.m2.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.SS1.p2.2.m2.1c">c_{4}</annotation><annotation encoding="application/x-llamapun" id="A5.SS1.p2.2.m2.1d">italic_c start_POSTSUBSCRIPT 4 end_POSTSUBSCRIPT</annotation></semantics></math> across <math alttext="{10^{-8},0.0001,0.001,0.01,0.1,0.5}" class="ltx_Math" display="inline" id="A5.SS1.p2.3.m3.6"><semantics id="A5.SS1.p2.3.m3.6a"><mrow id="A5.SS1.p2.3.m3.6.6.1" xref="A5.SS1.p2.3.m3.6.6.2.cmml"><msup id="A5.SS1.p2.3.m3.6.6.1.1" xref="A5.SS1.p2.3.m3.6.6.1.1.cmml"><mn id="A5.SS1.p2.3.m3.6.6.1.1.2" xref="A5.SS1.p2.3.m3.6.6.1.1.2.cmml">10</mn><mrow id="A5.SS1.p2.3.m3.6.6.1.1.3" xref="A5.SS1.p2.3.m3.6.6.1.1.3.cmml"><mo id="A5.SS1.p2.3.m3.6.6.1.1.3a" xref="A5.SS1.p2.3.m3.6.6.1.1.3.cmml">−</mo><mn id="A5.SS1.p2.3.m3.6.6.1.1.3.2" xref="A5.SS1.p2.3.m3.6.6.1.1.3.2.cmml">8</mn></mrow></msup><mo id="A5.SS1.p2.3.m3.6.6.1.2" xref="A5.SS1.p2.3.m3.6.6.2.cmml">,</mo><mn id="A5.SS1.p2.3.m3.1.1" xref="A5.SS1.p2.3.m3.1.1.cmml">0.0001</mn><mo id="A5.SS1.p2.3.m3.6.6.1.3" xref="A5.SS1.p2.3.m3.6.6.2.cmml">,</mo><mn id="A5.SS1.p2.3.m3.2.2" xref="A5.SS1.p2.3.m3.2.2.cmml">0.001</mn><mo id="A5.SS1.p2.3.m3.6.6.1.4" xref="A5.SS1.p2.3.m3.6.6.2.cmml">,</mo><mn id="A5.SS1.p2.3.m3.3.3" xref="A5.SS1.p2.3.m3.3.3.cmml">0.01</mn><mo id="A5.SS1.p2.3.m3.6.6.1.5" xref="A5.SS1.p2.3.m3.6.6.2.cmml">,</mo><mn id="A5.SS1.p2.3.m3.4.4" xref="A5.SS1.p2.3.m3.4.4.cmml">0.1</mn><mo id="A5.SS1.p2.3.m3.6.6.1.6" xref="A5.SS1.p2.3.m3.6.6.2.cmml">,</mo><mn id="A5.SS1.p2.3.m3.5.5" xref="A5.SS1.p2.3.m3.5.5.cmml">0.5</mn></mrow><annotation-xml encoding="MathML-Content" id="A5.SS1.p2.3.m3.6b"><list id="A5.SS1.p2.3.m3.6.6.2.cmml" xref="A5.SS1.p2.3.m3.6.6.1"><apply id="A5.SS1.p2.3.m3.6.6.1.1.cmml" xref="A5.SS1.p2.3.m3.6.6.1.1"><csymbol cd="ambiguous" id="A5.SS1.p2.3.m3.6.6.1.1.1.cmml" xref="A5.SS1.p2.3.m3.6.6.1.1">superscript</csymbol><cn id="A5.SS1.p2.3.m3.6.6.1.1.2.cmml" type="integer" xref="A5.SS1.p2.3.m3.6.6.1.1.2">10</cn><apply id="A5.SS1.p2.3.m3.6.6.1.1.3.cmml" xref="A5.SS1.p2.3.m3.6.6.1.1.3"><minus id="A5.SS1.p2.3.m3.6.6.1.1.3.1.cmml" xref="A5.SS1.p2.3.m3.6.6.1.1.3"></minus><cn id="A5.SS1.p2.3.m3.6.6.1.1.3.2.cmml" type="integer" xref="A5.SS1.p2.3.m3.6.6.1.1.3.2">8</cn></apply></apply><cn id="A5.SS1.p2.3.m3.1.1.cmml" type="float" xref="A5.SS1.p2.3.m3.1.1">0.0001</cn><cn id="A5.SS1.p2.3.m3.2.2.cmml" type="float" xref="A5.SS1.p2.3.m3.2.2">0.001</cn><cn id="A5.SS1.p2.3.m3.3.3.cmml" type="float" xref="A5.SS1.p2.3.m3.3.3">0.01</cn><cn id="A5.SS1.p2.3.m3.4.4.cmml" type="float" xref="A5.SS1.p2.3.m3.4.4">0.1</cn><cn id="A5.SS1.p2.3.m3.5.5.cmml" type="float" xref="A5.SS1.p2.3.m3.5.5">0.5</cn></list></annotation-xml><annotation encoding="application/x-tex" id="A5.SS1.p2.3.m3.6c">{10^{-8},0.0001,0.001,0.01,0.1,0.5}</annotation><annotation encoding="application/x-llamapun" id="A5.SS1.p2.3.m3.6d">10 start_POSTSUPERSCRIPT - 8 end_POSTSUPERSCRIPT , 0.0001 , 0.001 , 0.01 , 0.1 , 0.5</annotation></semantics></math> with grid search.
All of the numbers are listed in Table. <a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#A5.T3" title="Table 3 ‣ E.1 Hyperparameters ‣ Appendix E Implementation Details ‣ Bisimulation metric for Model Predictive Control"><span class="ltx_text ltx_ref_tag">3</span></a>.</p>
</div>
<figure class="ltx_table" id="A5.T3">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 3: </span>Bisimulation metric parameter used in the experiment.</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A5.T3.2">
<thead class="ltx_thead">
<tr class="ltx_tr" id="A5.T3.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="A5.T3.1.1.2"><span class="ltx_text ltx_font_bold" id="A5.T3.1.1.2.1">Environment</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="A5.T3.1.1.1">
<span class="ltx_text ltx_font_bold" id="A5.T3.1.1.1.1">Value</span> (<math alttext="c_{4}" class="ltx_Math" display="inline" id="A5.T3.1.1.1.m1.1"><semantics id="A5.T3.1.1.1.m1.1a"><msub id="A5.T3.1.1.1.m1.1.1" xref="A5.T3.1.1.1.m1.1.1.cmml"><mi id="A5.T3.1.1.1.m1.1.1.2" xref="A5.T3.1.1.1.m1.1.1.2.cmml">c</mi><mn id="A5.T3.1.1.1.m1.1.1.3" xref="A5.T3.1.1.1.m1.1.1.3.cmml">4</mn></msub><annotation-xml encoding="MathML-Content" id="A5.T3.1.1.1.m1.1b"><apply id="A5.T3.1.1.1.m1.1.1.cmml" xref="A5.T3.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="A5.T3.1.1.1.m1.1.1.1.cmml" xref="A5.T3.1.1.1.m1.1.1">subscript</csymbol><ci id="A5.T3.1.1.1.m1.1.1.2.cmml" xref="A5.T3.1.1.1.m1.1.1.2">𝑐</ci><cn id="A5.T3.1.1.1.m1.1.1.3.cmml" type="integer" xref="A5.T3.1.1.1.m1.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.T3.1.1.1.m1.1c">c_{4}</annotation><annotation encoding="application/x-llamapun" id="A5.T3.1.1.1.m1.1d">italic_c start_POSTSUBSCRIPT 4 end_POSTSUBSCRIPT</annotation></semantics></math>)</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A5.T3.2.3.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="A5.T3.2.3.1.1">Acrobot</th>
<td class="ltx_td ltx_align_left ltx_border_t" id="A5.T3.2.3.1.2">0.0001</td>
</tr>
<tr class="ltx_tr" id="A5.T3.2.4.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A5.T3.2.4.2.1">Cartpole</th>
<td class="ltx_td ltx_align_left" id="A5.T3.2.4.2.2">0.5</td>
</tr>
<tr class="ltx_tr" id="A5.T3.2.5.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A5.T3.2.5.3.1">Cheetah</th>
<td class="ltx_td ltx_align_left" id="A5.T3.2.5.3.2">0.001</td>
</tr>
<tr class="ltx_tr" id="A5.T3.2.6.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A5.T3.2.6.4.1">Cup</th>
<td class="ltx_td ltx_align_left" id="A5.T3.2.6.4.2">0.5</td>
</tr>
<tr class="ltx_tr" id="A5.T3.2.7.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A5.T3.2.7.5.1">Finger</th>
<td class="ltx_td ltx_align_left" id="A5.T3.2.7.5.2">0.001</td>
</tr>
<tr class="ltx_tr" id="A5.T3.2.8.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A5.T3.2.8.6.1">Fish</th>
<td class="ltx_td ltx_align_left" id="A5.T3.2.8.6.2">0.001</td>
</tr>
<tr class="ltx_tr" id="A5.T3.2.9.7">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A5.T3.2.9.7.1">Hopper</th>
<td class="ltx_td ltx_align_left" id="A5.T3.2.9.7.2">0.1</td>
</tr>
<tr class="ltx_tr" id="A5.T3.2.10.8">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A5.T3.2.10.8.1">Humanoid</th>
<td class="ltx_td ltx_align_left" id="A5.T3.2.10.8.2">0.001</td>
</tr>
<tr class="ltx_tr" id="A5.T3.2.11.9">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A5.T3.2.11.9.1">Pendulum</th>
<td class="ltx_td ltx_align_left" id="A5.T3.2.11.9.2">0.01</td>
</tr>
<tr class="ltx_tr" id="A5.T3.2.12.10">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A5.T3.2.12.10.1">Quadruped</th>
<td class="ltx_td ltx_align_left" id="A5.T3.2.12.10.2">0.1</td>
</tr>
<tr class="ltx_tr" id="A5.T3.2.13.11">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A5.T3.2.13.11.1">Reacher</th>
<td class="ltx_td ltx_align_left" id="A5.T3.2.13.11.2">0.01</td>
</tr>
<tr class="ltx_tr" id="A5.T3.2.14.12">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A5.T3.2.14.12.1">Walker</th>
<td class="ltx_td ltx_align_left" id="A5.T3.2.14.12.2">0.001</td>
</tr>
<tr class="ltx_tr" id="A5.T3.2.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="A5.T3.2.2.2">Dog</th>
<td class="ltx_td ltx_align_left ltx_border_bb" id="A5.T3.2.2.1"><math alttext="10^{-8}" class="ltx_Math" display="inline" id="A5.T3.2.2.1.m1.1"><semantics id="A5.T3.2.2.1.m1.1a"><msup id="A5.T3.2.2.1.m1.1.1" xref="A5.T3.2.2.1.m1.1.1.cmml"><mn id="A5.T3.2.2.1.m1.1.1.2" xref="A5.T3.2.2.1.m1.1.1.2.cmml">10</mn><mrow id="A5.T3.2.2.1.m1.1.1.3" xref="A5.T3.2.2.1.m1.1.1.3.cmml"><mo id="A5.T3.2.2.1.m1.1.1.3a" xref="A5.T3.2.2.1.m1.1.1.3.cmml">−</mo><mn id="A5.T3.2.2.1.m1.1.1.3.2" xref="A5.T3.2.2.1.m1.1.1.3.2.cmml">8</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="A5.T3.2.2.1.m1.1b"><apply id="A5.T3.2.2.1.m1.1.1.cmml" xref="A5.T3.2.2.1.m1.1.1"><csymbol cd="ambiguous" id="A5.T3.2.2.1.m1.1.1.1.cmml" xref="A5.T3.2.2.1.m1.1.1">superscript</csymbol><cn id="A5.T3.2.2.1.m1.1.1.2.cmml" type="integer" xref="A5.T3.2.2.1.m1.1.1.2">10</cn><apply id="A5.T3.2.2.1.m1.1.1.3.cmml" xref="A5.T3.2.2.1.m1.1.1.3"><minus id="A5.T3.2.2.1.m1.1.1.3.1.cmml" xref="A5.T3.2.2.1.m1.1.1.3"></minus><cn id="A5.T3.2.2.1.m1.1.1.3.2.cmml" type="integer" xref="A5.T3.2.2.1.m1.1.1.3.2">8</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.T3.2.2.1.m1.1c">10^{-8}</annotation><annotation encoding="application/x-llamapun" id="A5.T3.2.2.1.m1.1d">10 start_POSTSUPERSCRIPT - 8 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
</tr>
</tbody>
</table>
</figure>
</section>
<section class="ltx_subsection" id="A5.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">E.2 </span>Model Architecture</h3>
<div class="ltx_para ltx_noindent" id="A5.SS2.p1">
<p class="ltx_p" id="A5.SS2.p1.4">In our experiments, both BS-MPC and TD-MPC utilize the same model architecture and the number of trainable parameters. We employ multi-layer perceptrons (MLPs) to represent the underlying environment models <math alttext="{\mathcal{P}}" class="ltx_Math" display="inline" id="A5.SS2.p1.1.m1.1"><semantics id="A5.SS2.p1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="A5.SS2.p1.1.m1.1.1" xref="A5.SS2.p1.1.m1.1.1.cmml">𝒫</mi><annotation-xml encoding="MathML-Content" id="A5.SS2.p1.1.m1.1b"><ci id="A5.SS2.p1.1.m1.1.1.cmml" xref="A5.SS2.p1.1.m1.1.1">𝒫</ci></annotation-xml><annotation encoding="application/x-tex" id="A5.SS2.p1.1.m1.1c">{\mathcal{P}}</annotation><annotation encoding="application/x-llamapun" id="A5.SS2.p1.1.m1.1d">caligraphic_P</annotation></semantics></math> and <math alttext="{\mathcal{R}}" class="ltx_Math" display="inline" id="A5.SS2.p1.2.m2.1"><semantics id="A5.SS2.p1.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="A5.SS2.p1.2.m2.1.1" xref="A5.SS2.p1.2.m2.1.1.cmml">ℛ</mi><annotation-xml encoding="MathML-Content" id="A5.SS2.p1.2.m2.1b"><ci id="A5.SS2.p1.2.m2.1.1.cmml" xref="A5.SS2.p1.2.m2.1.1">ℛ</ci></annotation-xml><annotation encoding="application/x-tex" id="A5.SS2.p1.2.m2.1c">{\mathcal{R}}</annotation><annotation encoding="application/x-llamapun" id="A5.SS2.p1.2.m2.1d">caligraphic_R</annotation></semantics></math>, the state-action value function <math alttext="Q" class="ltx_Math" display="inline" id="A5.SS2.p1.3.m3.1"><semantics id="A5.SS2.p1.3.m3.1a"><mi id="A5.SS2.p1.3.m3.1.1" xref="A5.SS2.p1.3.m3.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="A5.SS2.p1.3.m3.1b"><ci id="A5.SS2.p1.3.m3.1.1.cmml" xref="A5.SS2.p1.3.m3.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="A5.SS2.p1.3.m3.1c">Q</annotation><annotation encoding="application/x-llamapun" id="A5.SS2.p1.3.m3.1d">italic_Q</annotation></semantics></math>, and the policy <math alttext="\pi" class="ltx_Math" display="inline" id="A5.SS2.p1.4.m4.1"><semantics id="A5.SS2.p1.4.m4.1a"><mi id="A5.SS2.p1.4.m4.1.1" xref="A5.SS2.p1.4.m4.1.1.cmml">π</mi><annotation-xml encoding="MathML-Content" id="A5.SS2.p1.4.m4.1b"><ci id="A5.SS2.p1.4.m4.1.1.cmml" xref="A5.SS2.p1.4.m4.1.1">𝜋</ci></annotation-xml><annotation encoding="application/x-tex" id="A5.SS2.p1.4.m4.1c">\pi</annotation><annotation encoding="application/x-llamapun" id="A5.SS2.p1.4.m4.1d">italic_π</annotation></semantics></math>. The architecture details are shown in Table. <a class="ltx_ref" href="https://arxiv.org/html/2410.04553v1#A5.T4" title="Table 4 ‣ E.2 Model Architecture ‣ Appendix E Implementation Details ‣ Bisimulation metric for Model Predictive Control"><span class="ltx_text ltx_ref_tag">4</span></a>. More details can be found in our official code.</p>
</div>
<figure class="ltx_table" id="A5.T4">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 4: </span>Model Architecture used in the experiment.</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A5.T4.4">
<thead class="ltx_thead">
<tr class="ltx_tr" id="A5.T4.4.5.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="A5.T4.4.5.1.1">Models</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="A5.T4.4.5.1.2">Number of Layers</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="A5.T4.4.5.1.3">Hidden Dim</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="A5.T4.4.5.1.4">Activation</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A5.T4.1.1">
<td class="ltx_td ltx_align_left ltx_border_t" id="A5.T4.1.1.1">Latent Model Dynamics <math alttext="{\mathcal{P}}" class="ltx_Math" display="inline" id="A5.T4.1.1.1.m1.1"><semantics id="A5.T4.1.1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="A5.T4.1.1.1.m1.1.1" xref="A5.T4.1.1.1.m1.1.1.cmml">𝒫</mi><annotation-xml encoding="MathML-Content" id="A5.T4.1.1.1.m1.1b"><ci id="A5.T4.1.1.1.m1.1.1.cmml" xref="A5.T4.1.1.1.m1.1.1">𝒫</ci></annotation-xml><annotation encoding="application/x-tex" id="A5.T4.1.1.1.m1.1c">{\mathcal{P}}</annotation><annotation encoding="application/x-llamapun" id="A5.T4.1.1.1.m1.1d">caligraphic_P</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A5.T4.1.1.2">3</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A5.T4.1.1.3">512</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A5.T4.1.1.4">ELU</td>
</tr>
<tr class="ltx_tr" id="A5.T4.2.2">
<td class="ltx_td ltx_align_left" id="A5.T4.2.2.1">Reward Model <math alttext="{\mathcal{R}}" class="ltx_Math" display="inline" id="A5.T4.2.2.1.m1.1"><semantics id="A5.T4.2.2.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="A5.T4.2.2.1.m1.1.1" xref="A5.T4.2.2.1.m1.1.1.cmml">ℛ</mi><annotation-xml encoding="MathML-Content" id="A5.T4.2.2.1.m1.1b"><ci id="A5.T4.2.2.1.m1.1.1.cmml" xref="A5.T4.2.2.1.m1.1.1">ℛ</ci></annotation-xml><annotation encoding="application/x-tex" id="A5.T4.2.2.1.m1.1c">{\mathcal{R}}</annotation><annotation encoding="application/x-llamapun" id="A5.T4.2.2.1.m1.1d">caligraphic_R</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_left" id="A5.T4.2.2.2">3</td>
<td class="ltx_td ltx_align_left" id="A5.T4.2.2.3">512</td>
<td class="ltx_td ltx_align_left" id="A5.T4.2.2.4">ELU</td>
</tr>
<tr class="ltx_tr" id="A5.T4.3.3">
<td class="ltx_td ltx_align_left" id="A5.T4.3.3.1">State-action value function <math alttext="Q" class="ltx_Math" display="inline" id="A5.T4.3.3.1.m1.1"><semantics id="A5.T4.3.3.1.m1.1a"><mi id="A5.T4.3.3.1.m1.1.1" xref="A5.T4.3.3.1.m1.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="A5.T4.3.3.1.m1.1b"><ci id="A5.T4.3.3.1.m1.1.1.cmml" xref="A5.T4.3.3.1.m1.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="A5.T4.3.3.1.m1.1c">Q</annotation><annotation encoding="application/x-llamapun" id="A5.T4.3.3.1.m1.1d">italic_Q</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_left" id="A5.T4.3.3.2">3</td>
<td class="ltx_td ltx_align_left" id="A5.T4.3.3.3">512</td>
<td class="ltx_td ltx_align_left" id="A5.T4.3.3.4">ELU + LayerNorm</td>
</tr>
<tr class="ltx_tr" id="A5.T4.4.4">
<td class="ltx_td ltx_align_left ltx_border_bb" id="A5.T4.4.4.1">Policy <math alttext="\pi" class="ltx_Math" display="inline" id="A5.T4.4.4.1.m1.1"><semantics id="A5.T4.4.4.1.m1.1a"><mi id="A5.T4.4.4.1.m1.1.1" xref="A5.T4.4.4.1.m1.1.1.cmml">π</mi><annotation-xml encoding="MathML-Content" id="A5.T4.4.4.1.m1.1b"><ci id="A5.T4.4.4.1.m1.1.1.cmml" xref="A5.T4.4.4.1.m1.1.1">𝜋</ci></annotation-xml><annotation encoding="application/x-tex" id="A5.T4.4.4.1.m1.1c">\pi</annotation><annotation encoding="application/x-llamapun" id="A5.T4.4.4.1.m1.1d">italic_π</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="A5.T4.4.4.2">3</td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="A5.T4.4.4.3">512</td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="A5.T4.4.4.4">ELU</td>
</tr>
</tbody>
</table>
</figure>
</section>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Sun Oct  6 17:12:28 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
