<!DOCTYPE html><html lang="en" data-theme="light"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<title>Linear Transformer Topological Masking with Graph Random Features</title>
<!--Generated on Fri Oct  4 14:25:23 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css">
<link href="https://arxiv.org/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css">
<link href="https://arxiv.org/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css">
<link href="https://arxiv.org/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css">




<base href="https://arxiv.org/html/2410.03462v1/"><link rel="stylesheet" href="https://use.typekit.net/rwr5zpx.css"><link rel="icon" type="image/png" href="https://static.arxiv.org/static/browse/0.3.4/images/icons/favicon-16x16.png" sizes="16x16"><link rel="icon" type="image/png" href="https://static.arxiv.org/static/browse/0.3.4/images/icons/favicon-32x32.png" sizes="32x32"></head>
<body><header class="mob_header">
    <div class="html-header-logo">
      <a href="https://arxiv.org/">
        <img alt="logo" class="logomark" role="presentation" width="100" src="https://services.dev.arxiv.org/html/static/arxiv-logomark-small-white.svg">
        <span class="sr-only">Back to arXiv</span>
      </a>
    </div>

    <!--TOC, dark mode, links-->
    <div class="html-header-nav">
      <!--back to abstract-->
      
        <a class="nav-link ar5iv-footer-button hover-effect" aria-label="Back to abstract page" href="https://arxiv.org/abs/2410.03462v1">
        <svg xmlns="http://www.w3.org/2000/svg" height="1.25em" viewBox="0 0 512 512" fill="#ffffff" aria-hidden="true">
            <path d="M502.6 278.6c12.5-12.5 12.5-32.8 0-45.3l-128-128c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L402.7 224 192 224c-17.7 0-32 14.3-32 32s14.3 32 32 32l210.7 0-73.4 73.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l128-128zM160 96c17.7 0 32-14.3 32-32s-14.3-32-32-32L96 32C43 32 0 75 0 128L0 384c0 53 43 96 96 96l64 0c17.7 0 32-14.3 32-32s-14.3-32-32-32l-64 0c-17.7 0-32-14.3-32-32l0-256c0-17.7 14.3-32 32-32l64 0z"></path>
        </svg>
        </a>
      <!--dark mode-->
      <a class="ar5iv-toggle-color-scheme" title="Toggle dark/light mode" aria-label="System preference">
        <label id="automatic-tog" class="toggle-icon" title="Switch to light mode" for="__palette_3">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9h-1.9M20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69m-9.15 3.96h2.3L12 9l-1.15 3.65Z"></path></svg>
        </label>
        
        
      </a>
      <!--nav-->
      <button class="navbar-toggler ar5iv-footer-button" type="button" data-bs-theme="dark" data-bs-toggle="collapse" aria-expanded="false" data-bs-target=".ltx_page_main >.ltx_TOC.mobile" aria-controls="navbarSupportedContent" aria-label="Toggle navigation" style="border:none; margin-right: 0em;">
        <svg xmlns="http://www.w3.org/2000/svg" height="1.25em" viewBox="0 0 448 512" aria-hidden="true" role="img" fill="#ffffff"><path d="M0 96C0 78.3 14.3 64 32 64H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32C14.3 128 0 113.7 0 96zM0 256c0-17.7 14.3-32 32-32H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32c-17.7 0-32-14.3-32-32zM448 416c0 17.7-14.3 32-32 32H32c-17.7 0-32-14.3-32-32s14.3-32 32-32H416c17.7 0 32 14.3 32 32z"></path></svg>
      </button>
    </div>
    </header><header class="desktop_header">
    <div class="html-header-logo">
      <a href="https://arxiv.org/">
          <img alt="logo" class="logo" role="presentation" width="100" src="https://services.dev.arxiv.org/html/static/arxiv-logo-one-color-white.svg">
          <span class="sr-only">Back to arXiv</span>
      </a>
    </div>
    <div class="html-header-message" role="banner">
        <p>This is <strong>experimental HTML</strong> to improve accessibility. We invite you to report rendering errors. <span class="sr-only">Use Alt+Y to toggle on accessible reporting links and Alt+Shift+Y to toggle off.</span> Learn more <a href="https://info.arxiv.org/about/accessible_HTML.html" target="_blank">about this project</a> and <a href="https://info.arxiv.org/help/submit_latex_best_practices.html" target="_blank">help improve conversions</a>.
        </p>
    </div>
    <nav class="html-header-nav">
      <a class="ar5iv-footer-button hover-effect" href="https://info.arxiv.org/about/accessible_HTML.html" target="_blank">Why HTML?</a>
      <a class="ar5iv-footer-button hover-effect" target="_blank" href="https://arxiv.org/html/2410.03462v1/#myForm">Report Issue</a>
      <a class="ar5iv-footer-button hover-effect" href="https://arxiv.org/abs/2410.03462v1">Back to Abstract</a>
      <a class="ar5iv-footer-button hover-effect" href="https://arxiv.org/pdf/2410.03462v1" target="_blank">Download PDF</a>
      <a class="ar5iv-toggle-color-scheme" title="Toggle dark/light mode">
        <label id="automatic-tog" class="toggle-icon" title="Switch to light mode" for="__palette_3">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9h-1.9M20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69m-9.15 3.96h2.3L12 9l-1.15 3.65Z"></path></svg>
        </label>
        
        
      </a>
    </nav></header>

<div class="ltx_page_main" id="main">
<nav class="ltx_TOC active" aria-labelledby="toc_header"><h2 id="toc_header" class="sr-only">Table of Contents</h2>

      <div id="listIcon" type="button" class="hide">
          <svg width="17px" height="17px" viewBox="0 0 512 512" style="pointer-events: none;">
          <path d="M40 48C26.7 48 16 58.7 16 72v48c0 13.3 10.7 24 24 24H88c13.3 0 24-10.7 24-24V72c0-13.3-10.7-24-24-24H40zM192 64c-17.7 0-32 14.3-32 32s14.3 32 32 32H480c17.7 0 32-14.3 32-32s-14.3-32-32-32H192zm0 160c-17.7 0-32 14.3-32 32s14.3 32 32 32H480c17.7 0 32-14.3 32-32s-14.3-32-32-32H192zm0 160c-17.7 0-32 14.3-32 32s14.3 32 32 32H480c17.7 0 32-14.3 32-32s-14.3-32-32-32H192zM16 232v48c0 13.3 10.7 24 24 24H88c13.3 0 24-10.7 24-24V232c0-13.3-10.7-24-24-24H40c-13.3 0-24 10.7-24 24zM40 368c-13.3 0-24 10.7-24 24v48c0 13.3 10.7 24 24 24H88c13.3 0 24-10.7 24-24V392c0-13.3-10.7-24-24-24H40z"></path>
          </svg>
      </div>
      <div id="arrowIcon" type="button">
          <svg width="17px" height="17px" viewBox="0 0 448 512" style="pointer-events: none;">
          <path d="M9.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.2 288 416 288c17.7 0 32-14.3 32-32s-14.3-32-32-32l-306.7 0L214.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160z"></path>
          </svg>
      </div><ol class="ltx_toclist"><li class="ltx_tocentry ltx_tocentry_section">
    <a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#abstract" title="Abstract">
      <span class="ltx_text ltx_ref_title">
        <span class="ltx_tag ltx_tag_ref"></span>
        Abstract
      </span>
    </a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#S1" title="In Linear Transformer Topological Masking with Graph Random Features"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#S2" title="In Linear Transformer Topological Masking with Graph Random Features"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Preliminaries</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#S3" title="In Linear Transformer Topological Masking with Graph Random Features"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Towards linear topological masking</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#S3.SS1" title="In 3 Towards linear topological masking ‣ Linear Transformer Topological Masking with Graph Random Features"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Graph node kernels as topological masks</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#S3.SS2" title="In 3 Towards linear topological masking ‣ Linear Transformer Topological Masking with Graph Random Features"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>Implicit masking with graph features</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#S3.SS3" title="In 3 Towards linear topological masking ‣ Linear Transformer Topological Masking with Graph Random Features"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3 </span>Faster implicit masking with graph <span class="ltx_text ltx_framed ltx_framed_underline">random</span> features</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#S3.SS4" title="In 3 Towards linear topological masking ‣ Linear Transformer Topological Masking with Graph Random Features"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.4 </span>Novel theoretical results for GRFs: sharp estimators with sparse features</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#S3.SS5" title="In 3 Towards linear topological masking ‣ Linear Transformer Topological Masking with Graph Random Features"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.5 </span>Algorithm and intuitive picture</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#S4" title="In Linear Transformer Topological Masking with Graph Random Features"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Experiments</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#S5" title="In Linear Transformer Topological Masking with Graph Random Features"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Conclusion</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#S6" title="In Linear Transformer Topological Masking with Graph Random Features"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6 </span>Ethics and reproducibility</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#S7" title="In Linear Transformer Topological Masking with Graph Random Features"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">7 </span>Contributions and acknowledgements</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#A1" title="In Linear Transformer Topological Masking with Graph Random Features"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A </span>Proofs</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#A1.SS1" title="In Appendix A Proofs ‣ Linear Transformer Topological Masking with Graph Random Features"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.1 </span>Proof of Remark <span class="ltx_text ltx_ref_tag">3.1</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#A1.SS2" title="In Appendix A Proofs ‣ Linear Transformer Topological Masking with Graph Random Features"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.2 </span>Proof of Thm.&nbsp;<span class="ltx_text ltx_ref_tag">3.1</span> (novel)</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#A2" title="In Linear Transformer Topological Masking with Graph Random Features"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B </span>Extended discussion on related work</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#A3" title="In Linear Transformer Topological Masking with Graph Random Features"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">C </span>Further experiments and details</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#A3.SS1" title="In Appendix C Further experiments and details ‣ Linear Transformer Topological Masking with Graph Random Features"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">C.1 </span>Architectures, hyperparameters and training details</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#A3.SS2" title="In Appendix C Further experiments and details ‣ Linear Transformer Topological Masking with Graph Random Features"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">C.2 </span>ViT ablations</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#A3.SS3" title="In Appendix C Further experiments and details ‣ Linear Transformer Topological Masking with Graph Random Features"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">C.3 </span>HD-VPD experimental details</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#A3.SS4" title="In Appendix C Further experiments and details ‣ Linear Transformer Topological Masking with Graph Random Features"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">C.4 </span>ViViT: topological masking for video data</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#A4" title="In Linear Transformer Topological Masking with Graph Random Features"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">D </span>Asymmetric graph random features</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
    <a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#bib" title="References">
      <span class="ltx_text ltx_ref_title">
        <span class="ltx_tag ltx_tag_ref"></span>
        References
      </span>
    </a></li></ol></nav>

<div class="ltx_page_content"><div class="package-alerts ltx_document" role="status" aria-label="Conversion errors have been found">
      <button aria-label="Dismiss alert">
          <span aria-hidden="true"><svg role="presentation" width="20" height="20" viewBox="0 0 44 44" aria-hidden="true" focusable="false">
          <path d="M0.549989 4.44999L4.44999 0.549988L43.45 39.55L39.55 43.45L0.549989 4.44999Z"></path>
          <path d="M39.55 0.549988L43.45 4.44999L4.44999 43.45L0.549988 39.55L39.55 0.549988Z"></path>
          </svg></span>
      </button>
      <p>HTML conversions <a href="https://info.dev.arxiv.org/about/accessibility_html_error_messages.html" target="_blank">sometimes display errors</a> due to content that did not convert correctly from the source. This paper uses the following packages that are not yet supported by the HTML conversion tool. Feedback on these issues are not necessary; they are known and are being worked on.</p>
          <ul arial-label="Unsupported packages used in this paper">
              <li>failed: layouts</li><li>failed: anyfontsize</li><li>failed: eqnarray</li><li>failed: tensor</li><li>failed: tikz-network</li><li>failed: tikz-feynman</li>
          </ul>
      <p>Authors: achieve the best HTML results from your LaTeX submissions by following these <a href="https://info.arxiv.org/help/submit_latex_best_practices.html" target="_blank">best practices</a>.</p>
    </div><div id="target-section" class="section"><a id="license-tr" href="https://info.arxiv.org/help/license/index.html#licenses-available">License: CC BY 4.0</a><div id="watermark-tr">arXiv:2410.03462v1 [cs.LG] 04 Oct 2024</div></div>
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Linear Transformer Topological Masking with Graph Random Features</h1><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Isaac Reid&nbsp;&nbsp;<sup class="ltx_sup" id="id23.20.id1"><span class="ltx_text ltx_font_italic" id="id23.20.id1.1">1,2</span></sup>, Avinava Dubey<sup class="ltx_sup" id="id24.21.id2">2</sup>, Deepali Jain<sup class="ltx_sup" id="id25.22.id3">2</sup>, Will Whitney<sup class="ltx_sup" id="id26.23.id4">2</sup>, Amr Ahmed<sup class="ltx_sup" id="id27.24.id5">2</sup>, 
<br class="ltx_break"><span class="ltx_text ltx_font_bold" id="id10.10.5">Joshua Ainslie<sup class="ltx_sup" id="id10.10.5.1"><span class="ltx_text ltx_font_medium" id="id10.10.5.1.1">2</span></sup>, Alex Bewley<sup class="ltx_sup" id="id10.10.5.2"><span class="ltx_text ltx_font_medium" id="id10.10.5.2.1">2</span></sup>, Mithun Jacob<sup class="ltx_sup" id="id10.10.5.3"><span class="ltx_text ltx_font_medium" id="id10.10.5.3.1">2</span></sup>, Aranyak Mehta<sup class="ltx_sup" id="id10.10.5.4"><span class="ltx_text ltx_font_medium" id="id10.10.5.4.1">2</span></sup>, David Rendleman<sup class="ltx_sup" id="id10.10.5.5"><span class="ltx_text ltx_font_medium" id="id10.10.5.5.1">2</span></sup>,</span>
<br class="ltx_break"><span class="ltx_text ltx_font_bold" id="id14.14.9">Connor Schenck<sup class="ltx_sup" id="id14.14.9.1"><span class="ltx_text ltx_font_medium" id="id14.14.9.1.1">2</span></sup>, Richard E. Turner<sup class="ltx_sup" id="id14.14.9.2"><span class="ltx_text ltx_font_medium" id="id14.14.9.2.1">1</span></sup>, René Wagner<sup class="ltx_sup" id="id14.14.9.3"><span class="ltx_text ltx_font_medium" id="id14.14.9.3.1">2</span></sup>, Adrian Weller<sup class="ltx_sup" id="id14.14.9.4"><span class="ltx_text ltx_font_medium ltx_font_italic" id="id14.14.9.4.1">1,3</span></sup>,</span>
<br class="ltx_break"><span class="ltx_text ltx_font_bold" id="id15.15.10">Krzysztof Choromanski<sup class="ltx_sup" id="id15.15.10.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="id15.15.10.1.1">2,4</span></sup></span>
<br class="ltx_break"><sup class="ltx_sup" id="id28.25.id6">1</sup>University of Cambridge, <sup class="ltx_sup" id="id29.26.id7">2</sup>Google, <sup class="ltx_sup" id="id30.27.id8">3</sup>Alan Turing Institute, <sup class="ltx_sup" id="id31.28.id9">4</sup>Columbia University
</span><span class="ltx_author_notes">Work completed as a student researcher.</span></span>
</div><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_abstract" id="abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<p class="ltx_p" id="id22.3">When training transformers on graph-structured data, incorporating information about the underlying topology is crucial for good performance.
<em class="ltx_emph ltx_font_italic" id="id22.3.1">Topological masking</em>, a type of relative position encoding, achieves this by upweighting or downweighting attention depending on the relationship between the query and keys in a graph.
In this paper, we propose to parameterise topological masks as a <em class="ltx_emph ltx_font_italic" id="id22.3.2">learnable function of a weighted adjacency matrix</em> – a novel, flexible approach which incorporates a strong structural inductive bias.
By approximating this mask with <em class="ltx_emph ltx_font_italic" id="id22.3.3">graph random features</em> (for which we prove the first known concentration bounds), we show how this can be made fully compatible with linear attention, preserving <math alttext="\mathcal{O}(N)" class="ltx_Math" display="inline" id="id20.1.m1.1"><semantics id="id20.1.m1.1a"><mrow id="id20.1.m1.1.2" xref="id20.1.m1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="id20.1.m1.1.2.2" xref="id20.1.m1.1.2.2.cmml">𝒪</mi><mo id="id20.1.m1.1.2.1" xref="id20.1.m1.1.2.1.cmml">⁢</mo><mrow id="id20.1.m1.1.2.3.2" xref="id20.1.m1.1.2.cmml"><mo id="id20.1.m1.1.2.3.2.1" stretchy="false" xref="id20.1.m1.1.2.cmml">(</mo><mi id="id20.1.m1.1.1" xref="id20.1.m1.1.1.cmml">N</mi><mo id="id20.1.m1.1.2.3.2.2" stretchy="false" xref="id20.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="id20.1.m1.1b"><apply id="id20.1.m1.1.2.cmml" xref="id20.1.m1.1.2"><times id="id20.1.m1.1.2.1.cmml" xref="id20.1.m1.1.2.1"></times><ci id="id20.1.m1.1.2.2.cmml" xref="id20.1.m1.1.2.2">𝒪</ci><ci id="id20.1.m1.1.1.cmml" xref="id20.1.m1.1.1">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="id20.1.m1.1c">\mathcal{O}(N)</annotation><annotation encoding="application/x-llamapun" id="id20.1.m1.1d">caligraphic_O ( italic_N )</annotation></semantics></math> time and space complexity with respect to the number of input tokens.
The fastest previous alternative was <math alttext="\mathcal{O}(N\log N)" class="ltx_Math" display="inline" id="id21.2.m2.1"><semantics id="id21.2.m2.1a"><mrow id="id21.2.m2.1.1" xref="id21.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="id21.2.m2.1.1.3" xref="id21.2.m2.1.1.3.cmml">𝒪</mi><mo id="id21.2.m2.1.1.2" xref="id21.2.m2.1.1.2.cmml">⁢</mo><mrow id="id21.2.m2.1.1.1.1" xref="id21.2.m2.1.1.1.1.1.cmml"><mo id="id21.2.m2.1.1.1.1.2" stretchy="false" xref="id21.2.m2.1.1.1.1.1.cmml">(</mo><mrow id="id21.2.m2.1.1.1.1.1" xref="id21.2.m2.1.1.1.1.1.cmml"><mi id="id21.2.m2.1.1.1.1.1.2" xref="id21.2.m2.1.1.1.1.1.2.cmml">N</mi><mo id="id21.2.m2.1.1.1.1.1.1" lspace="0.167em" xref="id21.2.m2.1.1.1.1.1.1.cmml">⁢</mo><mrow id="id21.2.m2.1.1.1.1.1.3" xref="id21.2.m2.1.1.1.1.1.3.cmml"><mi id="id21.2.m2.1.1.1.1.1.3.1" xref="id21.2.m2.1.1.1.1.1.3.1.cmml">log</mi><mo id="id21.2.m2.1.1.1.1.1.3a" lspace="0.167em" xref="id21.2.m2.1.1.1.1.1.3.cmml">⁡</mo><mi id="id21.2.m2.1.1.1.1.1.3.2" xref="id21.2.m2.1.1.1.1.1.3.2.cmml">N</mi></mrow></mrow><mo id="id21.2.m2.1.1.1.1.3" stretchy="false" xref="id21.2.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="id21.2.m2.1b"><apply id="id21.2.m2.1.1.cmml" xref="id21.2.m2.1.1"><times id="id21.2.m2.1.1.2.cmml" xref="id21.2.m2.1.1.2"></times><ci id="id21.2.m2.1.1.3.cmml" xref="id21.2.m2.1.1.3">𝒪</ci><apply id="id21.2.m2.1.1.1.1.1.cmml" xref="id21.2.m2.1.1.1.1"><times id="id21.2.m2.1.1.1.1.1.1.cmml" xref="id21.2.m2.1.1.1.1.1.1"></times><ci id="id21.2.m2.1.1.1.1.1.2.cmml" xref="id21.2.m2.1.1.1.1.1.2">𝑁</ci><apply id="id21.2.m2.1.1.1.1.1.3.cmml" xref="id21.2.m2.1.1.1.1.1.3"><log id="id21.2.m2.1.1.1.1.1.3.1.cmml" xref="id21.2.m2.1.1.1.1.1.3.1"></log><ci id="id21.2.m2.1.1.1.1.1.3.2.cmml" xref="id21.2.m2.1.1.1.1.1.3.2">𝑁</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="id21.2.m2.1c">\mathcal{O}(N\log N)</annotation><annotation encoding="application/x-llamapun" id="id21.2.m2.1d">caligraphic_O ( italic_N roman_log italic_N )</annotation></semantics></math> and only suitable for specific graphs.
Our efficient masking algorithms provide strong performance gains for tasks on image and point cloud data, including with <math alttext=">30" class="ltx_Math" display="inline" id="id22.3.m3.1"><semantics id="id22.3.m3.1a"><mrow id="id22.3.m3.1.1" xref="id22.3.m3.1.1.cmml"><mi id="id22.3.m3.1.1.2" xref="id22.3.m3.1.1.2.cmml"></mi><mo id="id22.3.m3.1.1.1" xref="id22.3.m3.1.1.1.cmml">&gt;</mo><mn id="id22.3.m3.1.1.3" xref="id22.3.m3.1.1.3.cmml">30</mn></mrow><annotation-xml encoding="MathML-Content" id="id22.3.m3.1b"><apply id="id22.3.m3.1.1.cmml" xref="id22.3.m3.1.1"><gt id="id22.3.m3.1.1.1.cmml" xref="id22.3.m3.1.1.1"></gt><csymbol cd="latexml" id="id22.3.m3.1.1.2.cmml" xref="id22.3.m3.1.1.2">absent</csymbol><cn id="id22.3.m3.1.1.3.cmml" type="integer" xref="id22.3.m3.1.1.3">30</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="id22.3.m3.1c">&gt;30</annotation><annotation encoding="application/x-llamapun" id="id22.3.m3.1d">&gt; 30</annotation></semantics></math>k nodes.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S1.p1">
<p class="ltx_p" id="S1.p1.3">Across data modalities, transformers have emerged as a leading machine learning architecture <cite class="ltx_cite ltx_citemacro_citep">(Vaswani, <a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#bib.bib35" title="">2017</a>; Dosovitskiy et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#bib.bib13" title="">2020</a>; Arnab et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#bib.bib1" title="">2021</a>)</cite>.
They derive their success from modelling complex dependencies between the tokens using an <em class="ltx_emph ltx_font_italic" id="S1.p1.3.1">attention mechanism</em>.
However, in its vanilla instantiation the transformer is a set function, meaning it is invariant to permutation of its inputs.
This is often undesireable; e.g.&nbsp;words tend to be arranged in a particular sequence, and graph nodes are connected to a particular set of neighbours.
Therefore, it has become standard to modify the attention matrix depending on any underlying structure, building in inductive bias.
For instance, <em class="ltx_emph ltx_font_italic" id="S1.p1.3.2">causal attention</em> applies a triangular binary mask to ensure that tokens only attend to preceding elements of the sequence <cite class="ltx_cite ltx_citemacro_citep">(Yang et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#bib.bib42" title="">2019</a>)</cite>.
Meanwhile, <em class="ltx_emph ltx_font_italic" id="S1.p1.3.3">relative position encoding</em> (RPE) captures the spatial relationship between the tokens <cite class="ltx_cite ltx_citemacro_citep">(Shaw et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#bib.bib32" title="">2018</a>)</cite>.
In some cases, the queries and keys can be arranged in a graph <math alttext="\mathcal{G}" class="ltx_Math" display="inline" id="S1.p1.1.m1.1"><semantics id="S1.p1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S1.p1.1.m1.1.1" xref="S1.p1.1.m1.1.1.cmml">𝒢</mi><annotation-xml encoding="MathML-Content" id="S1.p1.1.m1.1b"><ci id="S1.p1.1.m1.1.1.cmml" xref="S1.p1.1.m1.1.1">𝒢</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p1.1.m1.1c">\mathcal{G}</annotation><annotation encoding="application/x-llamapun" id="S1.p1.1.m1.1d">caligraphic_G</annotation></semantics></math> and a function <math alttext="\mathbf{M}(\mathcal{G})" class="ltx_Math" display="inline" id="S1.p1.2.m2.1"><semantics id="S1.p1.2.m2.1a"><mrow id="S1.p1.2.m2.1.2" xref="S1.p1.2.m2.1.2.cmml"><mi id="S1.p1.2.m2.1.2.2" xref="S1.p1.2.m2.1.2.2.cmml">𝐌</mi><mo id="S1.p1.2.m2.1.2.1" xref="S1.p1.2.m2.1.2.1.cmml">⁢</mo><mrow id="S1.p1.2.m2.1.2.3.2" xref="S1.p1.2.m2.1.2.cmml"><mo id="S1.p1.2.m2.1.2.3.2.1" stretchy="false" xref="S1.p1.2.m2.1.2.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S1.p1.2.m2.1.1" xref="S1.p1.2.m2.1.1.cmml">𝒢</mi><mo id="S1.p1.2.m2.1.2.3.2.2" stretchy="false" xref="S1.p1.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.p1.2.m2.1b"><apply id="S1.p1.2.m2.1.2.cmml" xref="S1.p1.2.m2.1.2"><times id="S1.p1.2.m2.1.2.1.cmml" xref="S1.p1.2.m2.1.2.1"></times><ci id="S1.p1.2.m2.1.2.2.cmml" xref="S1.p1.2.m2.1.2.2">𝐌</ci><ci id="S1.p1.2.m2.1.1.cmml" xref="S1.p1.2.m2.1.1">𝒢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p1.2.m2.1c">\mathbf{M}(\mathcal{G})</annotation><annotation encoding="application/x-llamapun" id="S1.p1.2.m2.1d">bold_M ( caligraphic_G )</annotation></semantics></math> can be used to modulate the transformer attention.
This is referred to as <em class="ltx_emph ltx_font_italic" id="S1.p1.3.4">topological masking</em> <cite class="ltx_cite ltx_citemacro_citep">(Choromanski et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#bib.bib7" title="">2022</a>)</cite>.
It provides a powerful avenue for incorporating structural inductive bias from <math alttext="\mathcal{G}" class="ltx_Math" display="inline" id="S1.p1.3.m3.1"><semantics id="S1.p1.3.m3.1a"><mi class="ltx_font_mathcaligraphic" id="S1.p1.3.m3.1.1" xref="S1.p1.3.m3.1.1.cmml">𝒢</mi><annotation-xml encoding="MathML-Content" id="S1.p1.3.m3.1b"><ci id="S1.p1.3.m3.1.1.cmml" xref="S1.p1.3.m3.1.1">𝒢</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p1.3.m3.1c">\mathcal{G}</annotation><annotation encoding="application/x-llamapun" id="S1.p1.3.m3.1d">caligraphic_G</annotation></semantics></math> into transformers, in some cases closing the performance gap with the best-customised graph neural networks <cite class="ltx_cite ltx_citemacro_citep">(Ying et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#bib.bib43" title="">2021</a>)</cite>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S1.p2">
<p class="ltx_p" id="S1.p2.12"><span class="ltx_text ltx_font_bold" id="S1.p2.12.2">Topological masking of low-rank attention.</span>
Topological masking is simple when the attention is full-rank.
In this case, the entire attention matrix <math alttext="\mathbf{A}\in\mathbb{R}^{N\times N}" class="ltx_Math" display="inline" id="S1.p2.1.m1.1"><semantics id="S1.p2.1.m1.1a"><mrow id="S1.p2.1.m1.1.1" xref="S1.p2.1.m1.1.1.cmml"><mi id="S1.p2.1.m1.1.1.2" xref="S1.p2.1.m1.1.1.2.cmml">𝐀</mi><mo id="S1.p2.1.m1.1.1.1" xref="S1.p2.1.m1.1.1.1.cmml">∈</mo><msup id="S1.p2.1.m1.1.1.3" xref="S1.p2.1.m1.1.1.3.cmml"><mi id="S1.p2.1.m1.1.1.3.2" xref="S1.p2.1.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S1.p2.1.m1.1.1.3.3" xref="S1.p2.1.m1.1.1.3.3.cmml"><mi id="S1.p2.1.m1.1.1.3.3.2" xref="S1.p2.1.m1.1.1.3.3.2.cmml">N</mi><mo id="S1.p2.1.m1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S1.p2.1.m1.1.1.3.3.1.cmml">×</mo><mi id="S1.p2.1.m1.1.1.3.3.3" xref="S1.p2.1.m1.1.1.3.3.3.cmml">N</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S1.p2.1.m1.1b"><apply id="S1.p2.1.m1.1.1.cmml" xref="S1.p2.1.m1.1.1"><in id="S1.p2.1.m1.1.1.1.cmml" xref="S1.p2.1.m1.1.1.1"></in><ci id="S1.p2.1.m1.1.1.2.cmml" xref="S1.p2.1.m1.1.1.2">𝐀</ci><apply id="S1.p2.1.m1.1.1.3.cmml" xref="S1.p2.1.m1.1.1.3"><csymbol cd="ambiguous" id="S1.p2.1.m1.1.1.3.1.cmml" xref="S1.p2.1.m1.1.1.3">superscript</csymbol><ci id="S1.p2.1.m1.1.1.3.2.cmml" xref="S1.p2.1.m1.1.1.3.2">ℝ</ci><apply id="S1.p2.1.m1.1.1.3.3.cmml" xref="S1.p2.1.m1.1.1.3.3"><times id="S1.p2.1.m1.1.1.3.3.1.cmml" xref="S1.p2.1.m1.1.1.3.3.1"></times><ci id="S1.p2.1.m1.1.1.3.3.2.cmml" xref="S1.p2.1.m1.1.1.3.3.2">𝑁</ci><ci id="S1.p2.1.m1.1.1.3.3.3.cmml" xref="S1.p2.1.m1.1.1.3.3.3">𝑁</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p2.1.m1.1c">\mathbf{A}\in\mathbb{R}^{N\times N}</annotation><annotation encoding="application/x-llamapun" id="S1.p2.1.m1.1d">bold_A ∈ blackboard_R start_POSTSUPERSCRIPT italic_N × italic_N end_POSTSUPERSCRIPT</annotation></semantics></math> (with <math alttext="N" class="ltx_Math" display="inline" id="S1.p2.2.m2.1"><semantics id="S1.p2.2.m2.1a"><mi id="S1.p2.2.m2.1.1" xref="S1.p2.2.m2.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S1.p2.2.m2.1b"><ci id="S1.p2.2.m2.1.1.cmml" xref="S1.p2.2.m2.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p2.2.m2.1c">N</annotation><annotation encoding="application/x-llamapun" id="S1.p2.2.m2.1d">italic_N</annotation></semantics></math> the number of input tokens) is materialised in memory, so its individual entries <math alttext="\mathbf{A}_{ij}" class="ltx_Math" display="inline" id="S1.p2.3.m3.1"><semantics id="S1.p2.3.m3.1a"><msub id="S1.p2.3.m3.1.1" xref="S1.p2.3.m3.1.1.cmml"><mi id="S1.p2.3.m3.1.1.2" xref="S1.p2.3.m3.1.1.2.cmml">𝐀</mi><mrow id="S1.p2.3.m3.1.1.3" xref="S1.p2.3.m3.1.1.3.cmml"><mi id="S1.p2.3.m3.1.1.3.2" xref="S1.p2.3.m3.1.1.3.2.cmml">i</mi><mo id="S1.p2.3.m3.1.1.3.1" xref="S1.p2.3.m3.1.1.3.1.cmml">⁢</mo><mi id="S1.p2.3.m3.1.1.3.3" xref="S1.p2.3.m3.1.1.3.3.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S1.p2.3.m3.1b"><apply id="S1.p2.3.m3.1.1.cmml" xref="S1.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S1.p2.3.m3.1.1.1.cmml" xref="S1.p2.3.m3.1.1">subscript</csymbol><ci id="S1.p2.3.m3.1.1.2.cmml" xref="S1.p2.3.m3.1.1.2">𝐀</ci><apply id="S1.p2.3.m3.1.1.3.cmml" xref="S1.p2.3.m3.1.1.3"><times id="S1.p2.3.m3.1.1.3.1.cmml" xref="S1.p2.3.m3.1.1.3.1"></times><ci id="S1.p2.3.m3.1.1.3.2.cmml" xref="S1.p2.3.m3.1.1.3.2">𝑖</ci><ci id="S1.p2.3.m3.1.1.3.3.cmml" xref="S1.p2.3.m3.1.1.3.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p2.3.m3.1c">\mathbf{A}_{ij}</annotation><annotation encoding="application/x-llamapun" id="S1.p2.3.m3.1d">bold_A start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT</annotation></semantics></math> can be pointwise multiplied by a (fixed or learnable) mask <math alttext="\mathbf{M}(\mathcal{G})_{ij}" class="ltx_Math" display="inline" id="S1.p2.4.m4.1"><semantics id="S1.p2.4.m4.1a"><mrow id="S1.p2.4.m4.1.2" xref="S1.p2.4.m4.1.2.cmml"><mi id="S1.p2.4.m4.1.2.2" xref="S1.p2.4.m4.1.2.2.cmml">𝐌</mi><mo id="S1.p2.4.m4.1.2.1" xref="S1.p2.4.m4.1.2.1.cmml">⁢</mo><msub id="S1.p2.4.m4.1.2.3" xref="S1.p2.4.m4.1.2.3.cmml"><mrow id="S1.p2.4.m4.1.2.3.2.2" xref="S1.p2.4.m4.1.2.3.cmml"><mo id="S1.p2.4.m4.1.2.3.2.2.1" stretchy="false" xref="S1.p2.4.m4.1.2.3.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S1.p2.4.m4.1.1" xref="S1.p2.4.m4.1.1.cmml">𝒢</mi><mo id="S1.p2.4.m4.1.2.3.2.2.2" stretchy="false" xref="S1.p2.4.m4.1.2.3.cmml">)</mo></mrow><mrow id="S1.p2.4.m4.1.2.3.3" xref="S1.p2.4.m4.1.2.3.3.cmml"><mi id="S1.p2.4.m4.1.2.3.3.2" xref="S1.p2.4.m4.1.2.3.3.2.cmml">i</mi><mo id="S1.p2.4.m4.1.2.3.3.1" xref="S1.p2.4.m4.1.2.3.3.1.cmml">⁢</mo><mi id="S1.p2.4.m4.1.2.3.3.3" xref="S1.p2.4.m4.1.2.3.3.3.cmml">j</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S1.p2.4.m4.1b"><apply id="S1.p2.4.m4.1.2.cmml" xref="S1.p2.4.m4.1.2"><times id="S1.p2.4.m4.1.2.1.cmml" xref="S1.p2.4.m4.1.2.1"></times><ci id="S1.p2.4.m4.1.2.2.cmml" xref="S1.p2.4.m4.1.2.2">𝐌</ci><apply id="S1.p2.4.m4.1.2.3.cmml" xref="S1.p2.4.m4.1.2.3"><csymbol cd="ambiguous" id="S1.p2.4.m4.1.2.3.1.cmml" xref="S1.p2.4.m4.1.2.3">subscript</csymbol><ci id="S1.p2.4.m4.1.1.cmml" xref="S1.p2.4.m4.1.1">𝒢</ci><apply id="S1.p2.4.m4.1.2.3.3.cmml" xref="S1.p2.4.m4.1.2.3.3"><times id="S1.p2.4.m4.1.2.3.3.1.cmml" xref="S1.p2.4.m4.1.2.3.3.1"></times><ci id="S1.p2.4.m4.1.2.3.3.2.cmml" xref="S1.p2.4.m4.1.2.3.3.2">𝑖</ci><ci id="S1.p2.4.m4.1.2.3.3.3.cmml" xref="S1.p2.4.m4.1.2.3.3.3">𝑗</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p2.4.m4.1c">\mathbf{M}(\mathcal{G})_{ij}</annotation><annotation encoding="application/x-llamapun" id="S1.p2.4.m4.1d">bold_M ( caligraphic_G ) start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT</annotation></semantics></math>.
But full-rank attention famously incurs a quadratic <math alttext="\mathcal{O}(N^{2})" class="ltx_Math" display="inline" id="S1.p2.5.m5.1"><semantics id="S1.p2.5.m5.1a"><mrow id="S1.p2.5.m5.1.1" xref="S1.p2.5.m5.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S1.p2.5.m5.1.1.3" xref="S1.p2.5.m5.1.1.3.cmml">𝒪</mi><mo id="S1.p2.5.m5.1.1.2" xref="S1.p2.5.m5.1.1.2.cmml">⁢</mo><mrow id="S1.p2.5.m5.1.1.1.1" xref="S1.p2.5.m5.1.1.1.1.1.cmml"><mo id="S1.p2.5.m5.1.1.1.1.2" stretchy="false" xref="S1.p2.5.m5.1.1.1.1.1.cmml">(</mo><msup id="S1.p2.5.m5.1.1.1.1.1" xref="S1.p2.5.m5.1.1.1.1.1.cmml"><mi id="S1.p2.5.m5.1.1.1.1.1.2" xref="S1.p2.5.m5.1.1.1.1.1.2.cmml">N</mi><mn id="S1.p2.5.m5.1.1.1.1.1.3" xref="S1.p2.5.m5.1.1.1.1.1.3.cmml">2</mn></msup><mo id="S1.p2.5.m5.1.1.1.1.3" stretchy="false" xref="S1.p2.5.m5.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.p2.5.m5.1b"><apply id="S1.p2.5.m5.1.1.cmml" xref="S1.p2.5.m5.1.1"><times id="S1.p2.5.m5.1.1.2.cmml" xref="S1.p2.5.m5.1.1.2"></times><ci id="S1.p2.5.m5.1.1.3.cmml" xref="S1.p2.5.m5.1.1.3">𝒪</ci><apply id="S1.p2.5.m5.1.1.1.1.1.cmml" xref="S1.p2.5.m5.1.1.1.1"><csymbol cd="ambiguous" id="S1.p2.5.m5.1.1.1.1.1.1.cmml" xref="S1.p2.5.m5.1.1.1.1">superscript</csymbol><ci id="S1.p2.5.m5.1.1.1.1.1.2.cmml" xref="S1.p2.5.m5.1.1.1.1.1.2">𝑁</ci><cn id="S1.p2.5.m5.1.1.1.1.1.3.cmml" type="integer" xref="S1.p2.5.m5.1.1.1.1.1.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p2.5.m5.1c">\mathcal{O}(N^{2})</annotation><annotation encoding="application/x-llamapun" id="S1.p2.5.m5.1d">caligraphic_O ( italic_N start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT )</annotation></semantics></math> space and time complexity cost, which may become prohibitive on large inputs.
This has motivated a number of <em class="ltx_emph ltx_font_italic" id="S1.p2.12.3">low-rank decompositions</em> of <math alttext="\mathbf{A}" class="ltx_Math" display="inline" id="S1.p2.6.m6.1"><semantics id="S1.p2.6.m6.1a"><mi id="S1.p2.6.m6.1.1" xref="S1.p2.6.m6.1.1.cmml">𝐀</mi><annotation-xml encoding="MathML-Content" id="S1.p2.6.m6.1b"><ci id="S1.p2.6.m6.1.1.cmml" xref="S1.p2.6.m6.1.1">𝐀</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p2.6.m6.1c">\mathbf{A}</annotation><annotation encoding="application/x-llamapun" id="S1.p2.6.m6.1d">bold_A</annotation></semantics></math>.
These improve scalability by avoiding computing <math alttext="\mathbf{A}" class="ltx_Math" display="inline" id="S1.p2.7.m7.1"><semantics id="S1.p2.7.m7.1a"><mi id="S1.p2.7.m7.1.1" xref="S1.p2.7.m7.1.1.cmml">𝐀</mi><annotation-xml encoding="MathML-Content" id="S1.p2.7.m7.1b"><ci id="S1.p2.7.m7.1.1.cmml" xref="S1.p2.7.m7.1.1">𝐀</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p2.7.m7.1c">\mathbf{A}</annotation><annotation encoding="application/x-llamapun" id="S1.p2.7.m7.1d">bold_A</annotation></semantics></math> explicitly, instead doing so implicitly in feature space.
The question of how to perform topological masking in the low-rank setting is challenging and not fully solved.
Previously proposed algorithms are limited to inexpressive functions <math alttext="\mathbf{M}" class="ltx_Math" display="inline" id="S1.p2.8.m8.1"><semantics id="S1.p2.8.m8.1a"><mi id="S1.p2.8.m8.1.1" xref="S1.p2.8.m8.1.1.cmml">𝐌</mi><annotation-xml encoding="MathML-Content" id="S1.p2.8.m8.1b"><ci id="S1.p2.8.m8.1.1.cmml" xref="S1.p2.8.m8.1.1">𝐌</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p2.8.m8.1c">\mathbf{M}</annotation><annotation encoding="application/x-llamapun" id="S1.p2.8.m8.1d">bold_M</annotation></semantics></math> and restricted classes of graphs <math alttext="\mathcal{G}" class="ltx_Math" display="inline" id="S1.p2.9.m9.1"><semantics id="S1.p2.9.m9.1a"><mi class="ltx_font_mathcaligraphic" id="S1.p2.9.m9.1.1" xref="S1.p2.9.m9.1.1.cmml">𝒢</mi><annotation-xml encoding="MathML-Content" id="S1.p2.9.m9.1b"><ci id="S1.p2.9.m9.1.1.cmml" xref="S1.p2.9.m9.1.1">𝒢</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p2.9.m9.1c">\mathcal{G}</annotation><annotation encoding="application/x-llamapun" id="S1.p2.9.m9.1d">caligraphic_G</annotation></semantics></math> (e.g.&nbsp;trees and grids), and are often <math alttext="\mathcal{O}(N\log N)" class="ltx_Math" display="inline" id="S1.p2.10.m10.1"><semantics id="S1.p2.10.m10.1a"><mrow id="S1.p2.10.m10.1.1" xref="S1.p2.10.m10.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S1.p2.10.m10.1.1.3" xref="S1.p2.10.m10.1.1.3.cmml">𝒪</mi><mo id="S1.p2.10.m10.1.1.2" xref="S1.p2.10.m10.1.1.2.cmml">⁢</mo><mrow id="S1.p2.10.m10.1.1.1.1" xref="S1.p2.10.m10.1.1.1.1.1.cmml"><mo id="S1.p2.10.m10.1.1.1.1.2" stretchy="false" xref="S1.p2.10.m10.1.1.1.1.1.cmml">(</mo><mrow id="S1.p2.10.m10.1.1.1.1.1" xref="S1.p2.10.m10.1.1.1.1.1.cmml"><mi id="S1.p2.10.m10.1.1.1.1.1.2" xref="S1.p2.10.m10.1.1.1.1.1.2.cmml">N</mi><mo id="S1.p2.10.m10.1.1.1.1.1.1" lspace="0.167em" xref="S1.p2.10.m10.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S1.p2.10.m10.1.1.1.1.1.3" xref="S1.p2.10.m10.1.1.1.1.1.3.cmml"><mi id="S1.p2.10.m10.1.1.1.1.1.3.1" xref="S1.p2.10.m10.1.1.1.1.1.3.1.cmml">log</mi><mo id="S1.p2.10.m10.1.1.1.1.1.3a" lspace="0.167em" xref="S1.p2.10.m10.1.1.1.1.1.3.cmml">⁡</mo><mi id="S1.p2.10.m10.1.1.1.1.1.3.2" xref="S1.p2.10.m10.1.1.1.1.1.3.2.cmml">N</mi></mrow></mrow><mo id="S1.p2.10.m10.1.1.1.1.3" stretchy="false" xref="S1.p2.10.m10.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.p2.10.m10.1b"><apply id="S1.p2.10.m10.1.1.cmml" xref="S1.p2.10.m10.1.1"><times id="S1.p2.10.m10.1.1.2.cmml" xref="S1.p2.10.m10.1.1.2"></times><ci id="S1.p2.10.m10.1.1.3.cmml" xref="S1.p2.10.m10.1.1.3">𝒪</ci><apply id="S1.p2.10.m10.1.1.1.1.1.cmml" xref="S1.p2.10.m10.1.1.1.1"><times id="S1.p2.10.m10.1.1.1.1.1.1.cmml" xref="S1.p2.10.m10.1.1.1.1.1.1"></times><ci id="S1.p2.10.m10.1.1.1.1.1.2.cmml" xref="S1.p2.10.m10.1.1.1.1.1.2">𝑁</ci><apply id="S1.p2.10.m10.1.1.1.1.1.3.cmml" xref="S1.p2.10.m10.1.1.1.1.1.3"><log id="S1.p2.10.m10.1.1.1.1.1.3.1.cmml" xref="S1.p2.10.m10.1.1.1.1.1.3.1"></log><ci id="S1.p2.10.m10.1.1.1.1.1.3.2.cmml" xref="S1.p2.10.m10.1.1.1.1.1.3.2">𝑁</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p2.10.m10.1c">\mathcal{O}(N\log N)</annotation><annotation encoding="application/x-llamapun" id="S1.p2.10.m10.1d">caligraphic_O ( italic_N roman_log italic_N )</annotation></semantics></math> time complexity rather than <math alttext="\mathcal{O}(N)" class="ltx_Math" display="inline" id="S1.p2.11.m11.1"><semantics id="S1.p2.11.m11.1a"><mrow id="S1.p2.11.m11.1.2" xref="S1.p2.11.m11.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S1.p2.11.m11.1.2.2" xref="S1.p2.11.m11.1.2.2.cmml">𝒪</mi><mo id="S1.p2.11.m11.1.2.1" xref="S1.p2.11.m11.1.2.1.cmml">⁢</mo><mrow id="S1.p2.11.m11.1.2.3.2" xref="S1.p2.11.m11.1.2.cmml"><mo id="S1.p2.11.m11.1.2.3.2.1" stretchy="false" xref="S1.p2.11.m11.1.2.cmml">(</mo><mi id="S1.p2.11.m11.1.1" xref="S1.p2.11.m11.1.1.cmml">N</mi><mo id="S1.p2.11.m11.1.2.3.2.2" stretchy="false" xref="S1.p2.11.m11.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.p2.11.m11.1b"><apply id="S1.p2.11.m11.1.2.cmml" xref="S1.p2.11.m11.1.2"><times id="S1.p2.11.m11.1.2.1.cmml" xref="S1.p2.11.m11.1.2.1"></times><ci id="S1.p2.11.m11.1.2.2.cmml" xref="S1.p2.11.m11.1.2.2">𝒪</ci><ci id="S1.p2.11.m11.1.1.cmml" xref="S1.p2.11.m11.1.1">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p2.11.m11.1c">\mathcal{O}(N)</annotation><annotation encoding="application/x-llamapun" id="S1.p2.11.m11.1d">caligraphic_O ( italic_N )</annotation></semantics></math> <cite class="ltx_cite ltx_citemacro_citep">(App.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#A2" title="Appendix B Extended discussion on related work ‣ Linear Transformer Topological Masking with Graph Random Features"><span class="ltx_text ltx_ref_tag">B</span></a>; Choromanski et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#bib.bib7" title="">2022</a>; Liutkus et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#bib.bib21" title="">2021</a>)</cite>.
Addressing these shortcomings is the chief focus of this manuscript.
Our central question is:
<em class="ltx_emph ltx_font_italic" id="S1.p2.12.1">how can we implement efficient yet flexible topological (graph-based) masking of transformer attention, in the low-rank setting where <math alttext="\mathbf{A}" class="ltx_Math" display="inline" id="S1.p2.12.1.m1.1"><semantics id="S1.p2.12.1.m1.1a"><mi id="S1.p2.12.1.m1.1.1" xref="S1.p2.12.1.m1.1.1.cmml">𝐀</mi><annotation-xml encoding="MathML-Content" id="S1.p2.12.1.m1.1b"><ci id="S1.p2.12.1.m1.1.1.cmml" xref="S1.p2.12.1.m1.1.1">𝐀</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p2.12.1.m1.1c">\mathbf{A}</annotation><annotation encoding="application/x-llamapun" id="S1.p2.12.1.m1.1d">bold_A</annotation></semantics></math> is never explicitly instantiated?</em></p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S1.p3">
<p class="ltx_p" id="S1.p3.1"><span class="ltx_text ltx_font_bold" id="S1.p3.1.1">Graph random features.</span>
To answer the question posed above, we propose to use <em class="ltx_emph ltx_font_italic" id="S1.p3.1.2">graph random features</em> (GRFs) <cite class="ltx_cite ltx_citemacro_citep">(Choromanski, <a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#bib.bib8" title="">2023</a>; Reid et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#bib.bib29" title="">2024b</a>)</cite>.
GRFs are sparse, randomised vectors whose dot product gives an unbiased estimate of arbitrary functions of a weighted adjacency matrix, a class that captures the structure of <math alttext="\mathcal{G}" class="ltx_Math" display="inline" id="S1.p3.1.m1.1"><semantics id="S1.p3.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S1.p3.1.m1.1.1" xref="S1.p3.1.m1.1.1.cmml">𝒢</mi><annotation-xml encoding="MathML-Content" id="S1.p3.1.m1.1b"><ci id="S1.p3.1.m1.1.1.cmml" xref="S1.p3.1.m1.1.1">𝒢</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.1.m1.1c">\mathcal{G}</annotation><annotation encoding="application/x-llamapun" id="S1.p3.1.m1.1d">caligraphic_G</annotation></semantics></math> and is popular in classical graph-based machine learning <cite class="ltx_cite ltx_citemacro_citep">(Smola and Kondor, <a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#bib.bib33" title="">2003</a>; Kondor and Lafferty, <a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#bib.bib19" title="">2002</a>)</cite>. GRFs have been used for approximate kernelised node clustering and in scalable graph-based Gaussian processes <cite class="ltx_cite ltx_citemacro_citep">(Reid et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#bib.bib26" title="">2023a</a>; <a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#bib.bib30" title="">2024c</a>)</cite>, but never before in transformers.
Advancing understanding of the convergence properties of GRFs is another key goal of this work.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S1.p4">
<p class="ltx_p" id="S1.p4.2"><span class="ltx_text ltx_font_bold" id="S1.p4.2.1">Our contributions.</span> We present the first known <math alttext="\mathcal{O}(N)" class="ltx_Math" display="inline" id="S1.p4.1.m1.1"><semantics id="S1.p4.1.m1.1a"><mrow id="S1.p4.1.m1.1.2" xref="S1.p4.1.m1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S1.p4.1.m1.1.2.2" xref="S1.p4.1.m1.1.2.2.cmml">𝒪</mi><mo id="S1.p4.1.m1.1.2.1" xref="S1.p4.1.m1.1.2.1.cmml">⁢</mo><mrow id="S1.p4.1.m1.1.2.3.2" xref="S1.p4.1.m1.1.2.cmml"><mo id="S1.p4.1.m1.1.2.3.2.1" stretchy="false" xref="S1.p4.1.m1.1.2.cmml">(</mo><mi id="S1.p4.1.m1.1.1" xref="S1.p4.1.m1.1.1.cmml">N</mi><mo id="S1.p4.1.m1.1.2.3.2.2" stretchy="false" xref="S1.p4.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.p4.1.m1.1b"><apply id="S1.p4.1.m1.1.2.cmml" xref="S1.p4.1.m1.1.2"><times id="S1.p4.1.m1.1.2.1.cmml" xref="S1.p4.1.m1.1.2.1"></times><ci id="S1.p4.1.m1.1.2.2.cmml" xref="S1.p4.1.m1.1.2.2">𝒪</ci><ci id="S1.p4.1.m1.1.1.cmml" xref="S1.p4.1.m1.1.1">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.1.m1.1c">\mathcal{O}(N)</annotation><annotation encoding="application/x-llamapun" id="S1.p4.1.m1.1d">caligraphic_O ( italic_N )</annotation></semantics></math> algorithm for topological masking of linear attention transformers with general <math alttext="\mathcal{G}" class="ltx_Math" display="inline" id="S1.p4.2.m2.1"><semantics id="S1.p4.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S1.p4.2.m2.1.1" xref="S1.p4.2.m2.1.1.cmml">𝒢</mi><annotation-xml encoding="MathML-Content" id="S1.p4.2.m2.1b"><ci id="S1.p4.2.m2.1.1.cmml" xref="S1.p4.2.m2.1.1">𝒢</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.2.m2.1c">\mathcal{G}</annotation><annotation encoding="application/x-llamapun" id="S1.p4.2.m2.1d">caligraphic_G</annotation></semantics></math>, using graph random features (Fig.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Linear Transformer Topological Masking with Graph Random Features"><span class="ltx_text ltx_ref_tag">1</span></a>).</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<ol class="ltx_enumerate" id="S1.I1">
<li class="ltx_item" id="S1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span>
<div class="ltx_para" id="S1.I1.i1.p1">
<p class="ltx_p" id="S1.I1.i1.p1.1">We propose to modulate the transformer attention mechanism with a <em class="ltx_emph ltx_font_italic" id="S1.I1.i1.p1.1.1">learnable function of a weighted adjacency matrix</em> – a simple, general topological masking trick which brings a strong inductive bias and substantial improvements to predictive performance.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="S1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span>
<div class="ltx_para" id="S1.I1.i2.p1">
<p class="ltx_p" id="S1.I1.i2.p1.1">For scalability, we replace the exact, deterministic mask with a sparse, stochastic estimate constructed using <em class="ltx_emph ltx_font_italic" id="S1.I1.i2.p1.1.1">graph random features</em> (GRFs). We use a novel exponential concentration bound to prove that our method is linear time and space complexity with respect to input size, the first known algorithm with this property.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="S1.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">3.</span>
<div class="ltx_para ltx_noindent" id="S1.I1.i3.p1">
<p class="ltx_p" id="S1.I1.i3.p1.1">We demonstrate strong accuracy gains on image data, as well as for modelling the dynamics of massive point clouds (<math alttext=">30" class="ltx_Math" display="inline" id="S1.I1.i3.p1.1.m1.1"><semantics id="S1.I1.i3.p1.1.m1.1a"><mrow id="S1.I1.i3.p1.1.m1.1.1" xref="S1.I1.i3.p1.1.m1.1.1.cmml"><mi id="S1.I1.i3.p1.1.m1.1.1.2" xref="S1.I1.i3.p1.1.m1.1.1.2.cmml"></mi><mo id="S1.I1.i3.p1.1.m1.1.1.1" xref="S1.I1.i3.p1.1.m1.1.1.1.cmml">&gt;</mo><mn id="S1.I1.i3.p1.1.m1.1.1.3" xref="S1.I1.i3.p1.1.m1.1.1.3.cmml">30</mn></mrow><annotation-xml encoding="MathML-Content" id="S1.I1.i3.p1.1.m1.1b"><apply id="S1.I1.i3.p1.1.m1.1.1.cmml" xref="S1.I1.i3.p1.1.m1.1.1"><gt id="S1.I1.i3.p1.1.m1.1.1.1.cmml" xref="S1.I1.i3.p1.1.m1.1.1.1"></gt><csymbol cd="latexml" id="S1.I1.i3.p1.1.m1.1.1.2.cmml" xref="S1.I1.i3.p1.1.m1.1.1.2">absent</csymbol><cn id="S1.I1.i3.p1.1.m1.1.1.3.cmml" type="integer" xref="S1.I1.i3.p1.1.m1.1.1.3">30</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.I1.i3.p1.1.m1.1c">&gt;30</annotation><annotation encoding="application/x-llamapun" id="S1.I1.i3.p1.1.m1.1d">&gt; 30</annotation></semantics></math>k particles) in robotics applications where efficiency is essential.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
</ol>
</div>
<figure class="ltx_figure" id="S1.F1"><svg class="ltx_picture ltx_centering" height="188.56" id="S1.F1.pic1" overflow="visible" version="1.1" width="330.53"><g transform="translate(0,188.56) matrix(1 0 0 -1 0 0) translate(107.74,0) translate(0,193.31)"><g fill="#000000" stroke="#000000" stroke-width="0.8pt"><g fill="#000000" stroke="#000000" transform="matrix(0.75 0.0 0.0 0.75 -23.52 -15.41)"><foreignObject height="9.61" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="63.11"><span class="ltx_text ltx_font_bold" id="S1.F1.pic1.28.28.28.28.1.1">Unmasked</span></foreignObject></g><g fill="#000000" stroke="#000000" transform="matrix(0.75 0.0 0.0 0.75 -7.96 -30.15)"><foreignObject height="12.45" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="21.24"><math alttext="\perp\mathcal{G}" class="ltx_Math" display="inline" id="S1.F1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1"><semantics id="S1.F1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1a"><mrow id="S1.F1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1" xref="S1.F1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml"><mi id="S1.F1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2" xref="S1.F1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.cmml"></mi><mo id="S1.F1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.1" xref="S1.F1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.cmml">⟂</mo><mi class="ltx_font_mathcaligraphic" id="S1.F1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3" xref="S1.F1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3.cmml">𝒢</mi></mrow><annotation-xml encoding="MathML-Content" id="S1.F1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1b"><apply id="S1.F1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S1.F1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1"><csymbol cd="latexml" id="S1.F1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.cmml" xref="S1.F1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.1">perpendicular-to</csymbol><csymbol cd="latexml" id="S1.F1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.cmml" xref="S1.F1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2">absent</csymbol><ci id="S1.F1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3.cmml" xref="S1.F1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3">𝒢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1c">\perp\mathcal{G}</annotation><annotation encoding="application/x-llamapun" id="S1.F1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1d">⟂ caligraphic_G</annotation></semantics></math></foreignObject></g><g fill="#000000" stroke="#000000" transform="matrix(0.75 0.0 0.0 0.75 126.52 -15.41)"><foreignObject height="9.61" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="46.2"><span class="ltx_text ltx_font_bold" id="S1.F1.pic1.29.29.29.29.1.1">Masked</span></foreignObject></g><g fill="#000000" stroke="#000000" transform="matrix(0.75 0.0 0.0 0.75 135.59 -31.1)"><foreignObject height="9.46" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="21.62"><math alttext="\sim\mathcal{G}" class="ltx_Math" display="inline" id="S1.F1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.1"><semantics id="S1.F1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.1a"><mrow id="S1.F1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.1.1" xref="S1.F1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.1.1.cmml"><mi id="S1.F1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.1.1.2" xref="S1.F1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.1.1.2.cmml"></mi><mo id="S1.F1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.1.1.1" xref="S1.F1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.1.1.1.cmml">∼</mo><mi class="ltx_font_mathcaligraphic" id="S1.F1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.1.1.3" xref="S1.F1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.1.1.3.cmml">𝒢</mi></mrow><annotation-xml encoding="MathML-Content" id="S1.F1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.1b"><apply id="S1.F1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S1.F1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.1.1"><csymbol cd="latexml" id="S1.F1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.1.1.1.cmml" xref="S1.F1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.1.1.1">similar-to</csymbol><csymbol cd="latexml" id="S1.F1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.1.1.2.cmml" xref="S1.F1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.1.1.2">absent</csymbol><ci id="S1.F1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.1.1.3.cmml" xref="S1.F1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.1.1.3">𝒢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.1c">\sim\mathcal{G}</annotation><annotation encoding="application/x-llamapun" id="S1.F1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.1d">∼ caligraphic_G</annotation></semantics></math></foreignObject></g><g color="#808080" fill="#808080" stroke="#808080" transform="matrix(0.75 0.0 0.0 0.75 67.81 -14.41)"><foreignObject height="8" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="10.76"><math alttext="<" class="ltx_Math" display="inline" id="S1.F1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.m1.1"><semantics id="S1.F1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.m1.1a"><mo id="S1.F1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.m1.1.1" xref="S1.F1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml">&lt;</mo><annotation-xml encoding="MathML-Content" id="S1.F1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.m1.1b"><lt id="S1.F1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S1.F1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.m1.1.1"></lt></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.m1.1c">&lt;</annotation><annotation encoding="application/x-llamapun" id="S1.F1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.m1.1d">&lt;</annotation></semantics></math></foreignObject></g><g fill="#000000" stroke="#000000" transform="matrix(0.75 0.0 0.0 0.75 -104.29 -81.33)"><foreignObject height="12.3" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="47.12"><span class="ltx_text ltx_font_bold" id="S1.F1.pic1.30.30.30.30.1.1">Regular</span></foreignObject></g><g fill="#000000" stroke="#000000" transform="matrix(0.75 0.0 0.0 0.75 -100.87 -97.67)"><foreignObject height="15.41" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="38.02"><math alttext="\mathcal{O}(N^{2})" class="ltx_Math" display="inline" id="S1.F1.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.m1.1"><semantics id="S1.F1.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.m1.1a"><mrow id="S1.F1.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.m1.1.1" xref="S1.F1.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S1.F1.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.m1.1.1.3" xref="S1.F1.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.m1.1.1.3.cmml">𝒪</mi><mo id="S1.F1.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.m1.1.1.2" xref="S1.F1.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.m1.1.1.2.cmml">⁢</mo><mrow id="S1.F1.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.m1.1.1.1.1" xref="S1.F1.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.cmml"><mo id="S1.F1.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.2" stretchy="false" xref="S1.F1.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.cmml">(</mo><msup id="S1.F1.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1" xref="S1.F1.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.cmml"><mi id="S1.F1.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.2" xref="S1.F1.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.2.cmml">N</mi><mn id="S1.F1.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.3" xref="S1.F1.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.3.cmml">2</mn></msup><mo id="S1.F1.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.3" stretchy="false" xref="S1.F1.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.F1.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.m1.1b"><apply id="S1.F1.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S1.F1.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.m1.1.1"><times id="S1.F1.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.m1.1.1.2.cmml" xref="S1.F1.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.m1.1.1.2"></times><ci id="S1.F1.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.m1.1.1.3.cmml" xref="S1.F1.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.m1.1.1.3">𝒪</ci><apply id="S1.F1.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.cmml" xref="S1.F1.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S1.F1.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.1.cmml" xref="S1.F1.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.m1.1.1.1.1">superscript</csymbol><ci id="S1.F1.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.2.cmml" xref="S1.F1.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.2">𝑁</ci><cn id="S1.F1.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.3.cmml" type="integer" xref="S1.F1.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.m1.1c">\mathcal{O}(N^{2})</annotation><annotation encoding="application/x-llamapun" id="S1.F1.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.m1.1d">caligraphic_O ( italic_N start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT )</annotation></semantics></math></foreignObject></g><g fill="#000000" stroke="#000000" transform="matrix(0.75 0.0 0.0 0.75 -101.11 -159.06)"><foreignObject height="9.46" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="38.67"><span class="ltx_text ltx_font_bold" id="S1.F1.pic1.31.31.31.31.1.1">Linear</span></foreignObject></g><g fill="#000000" stroke="#000000" transform="matrix(0.75 0.0 0.0 0.75 -99.42 -173.85)"><foreignObject height="13.84" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="34.15"><math alttext="\mathcal{O}(N)" class="ltx_Math" display="inline" id="S1.F1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.m1.1"><semantics id="S1.F1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.m1.1a"><mrow id="S1.F1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.m1.1.2" xref="S1.F1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.m1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S1.F1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.m1.1.2.2" xref="S1.F1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.m1.1.2.2.cmml">𝒪</mi><mo id="S1.F1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.m1.1.2.1" xref="S1.F1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.m1.1.2.1.cmml">⁢</mo><mrow id="S1.F1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.m1.1.2.3.2" xref="S1.F1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.m1.1.2.cmml"><mo id="S1.F1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.m1.1.2.3.2.1" stretchy="false" xref="S1.F1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.m1.1.2.cmml">(</mo><mi id="S1.F1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.m1.1.1" xref="S1.F1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.m1.1.1.cmml">N</mi><mo id="S1.F1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.m1.1.2.3.2.2" stretchy="false" xref="S1.F1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.F1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.m1.1b"><apply id="S1.F1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.m1.1.2.cmml" xref="S1.F1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.m1.1.2"><times id="S1.F1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.m1.1.2.1.cmml" xref="S1.F1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.m1.1.2.1"></times><ci id="S1.F1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.m1.1.2.2.cmml" xref="S1.F1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.m1.1.2.2">𝒪</ci><ci id="S1.F1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S1.F1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.m1.1.1">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.m1.1c">\mathcal{O}(N)</annotation><annotation encoding="application/x-llamapun" id="S1.F1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.m1.1d">caligraphic_O ( italic_N )</annotation></semantics></math></foreignObject></g><g color="#808080" fill="#808080" stroke="#808080" transform="matrix(1.0 0.0 0.0 1.0 -96.7 -126.78)"><foreignObject height="9.46" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="20.18"><math alttext="\overset{\mathbb{E}}{=}" class="ltx_Math" display="inline" id="S1.F1.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.1.m1.1"><semantics id="S1.F1.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.1.m1.1a"><mover accent="true" id="S1.F1.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.1.m1.1.1" xref="S1.F1.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml"><mo id="S1.F1.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2" xref="S1.F1.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.cmml">=</mo><mo id="S1.F1.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.1" xref="S1.F1.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.cmml">𝔼</mo></mover><annotation-xml encoding="MathML-Content" id="S1.F1.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.1.m1.1b"><apply id="S1.F1.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S1.F1.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.1.m1.1.1"><ci id="S1.F1.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.cmml" xref="S1.F1.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.1">𝔼</ci><eq id="S1.F1.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.cmml" xref="S1.F1.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2"></eq></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.1.m1.1c">\overset{\mathbb{E}}{=}</annotation><annotation encoding="application/x-llamapun" id="S1.F1.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.1.m1.1d">overblackboard_E start_ARG = end_ARG</annotation></semantics></math></foreignObject></g><g stroke-width="0.5pt"><path d="M -35.43 -98.43 M -35.43 -98.43 L -35.43 -55.12 L 7.87 -55.12 L 7.87 -98.43 Z M 7.87 -55.12" style="fill:none"></path></g><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 -18.97 -81.5)"><foreignObject height="9.46" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="10.38"><span class="ltx_text" id="S1.F1.pic1.32.32.32.32.1.1">A</span></foreignObject></g><g stroke-width="0.5pt"><path d="M 13.78 -98.43 M 13.78 -98.43 L 13.78 -55.12 L 35.43 -55.12 L 35.43 -98.43 Z M 35.43 -55.12" style="fill:none"></path></g><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 19.42 -81.5)"><foreignObject height="9.46" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="10.38"><span class="ltx_text" id="S1.F1.pic1.33.33.33.33.1.1">V</span></foreignObject></g><g color="#808080" fill="#808080" stroke="#808080" transform="matrix(0.6 0.0 0.0 0.6 -17.57 -52.05)"><foreignObject height="9.46" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="12.63"><math alttext="N" class="ltx_Math" display="inline" id="S1.F1.pic1.7.7.7.7.7.7.7.7.7.7.7.7.7.1.1.1.1.1.1.1.1.1.1.1.1.m1.1"><semantics id="S1.F1.pic1.7.7.7.7.7.7.7.7.7.7.7.7.7.1.1.1.1.1.1.1.1.1.1.1.1.m1.1a"><mi id="S1.F1.pic1.7.7.7.7.7.7.7.7.7.7.7.7.7.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1" xref="S1.F1.pic1.7.7.7.7.7.7.7.7.7.7.7.7.7.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S1.F1.pic1.7.7.7.7.7.7.7.7.7.7.7.7.7.1.1.1.1.1.1.1.1.1.1.1.1.m1.1b"><ci id="S1.F1.pic1.7.7.7.7.7.7.7.7.7.7.7.7.7.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S1.F1.pic1.7.7.7.7.7.7.7.7.7.7.7.7.7.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.pic1.7.7.7.7.7.7.7.7.7.7.7.7.7.1.1.1.1.1.1.1.1.1.1.1.1.m1.1c">N</annotation><annotation encoding="application/x-llamapun" id="S1.F1.pic1.7.7.7.7.7.7.7.7.7.7.7.7.7.1.1.1.1.1.1.1.1.1.1.1.1.m1.1d">italic_N</annotation></semantics></math></foreignObject></g><g color="#808080" fill="#808080" stroke="#808080" transform="matrix(0.6 0.0 0.0 0.6 21.46 -52.1)"><foreignObject height="9.61" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="7.2"><math alttext="d" class="ltx_Math" display="inline" id="S1.F1.pic1.8.8.8.8.8.8.8.8.8.8.8.8.8.2.1.1.1.1.1.1.1.1.1.1.1.m1.1"><semantics id="S1.F1.pic1.8.8.8.8.8.8.8.8.8.8.8.8.8.2.1.1.1.1.1.1.1.1.1.1.1.m1.1a"><mi id="S1.F1.pic1.8.8.8.8.8.8.8.8.8.8.8.8.8.2.1.1.1.1.1.1.1.1.1.1.1.m1.1.1" xref="S1.F1.pic1.8.8.8.8.8.8.8.8.8.8.8.8.8.2.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S1.F1.pic1.8.8.8.8.8.8.8.8.8.8.8.8.8.2.1.1.1.1.1.1.1.1.1.1.1.m1.1b"><ci id="S1.F1.pic1.8.8.8.8.8.8.8.8.8.8.8.8.8.2.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S1.F1.pic1.8.8.8.8.8.8.8.8.8.8.8.8.8.2.1.1.1.1.1.1.1.1.1.1.1.m1.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.pic1.8.8.8.8.8.8.8.8.8.8.8.8.8.2.1.1.1.1.1.1.1.1.1.1.1.m1.1c">d</annotation><annotation encoding="application/x-llamapun" id="S1.F1.pic1.8.8.8.8.8.8.8.8.8.8.8.8.8.2.1.1.1.1.1.1.1.1.1.1.1.m1.1d">italic_d</annotation></semantics></math></foreignObject></g><g color="#808080" fill="#808080" stroke="#808080" transform="matrix(0.6 0.0 0.0 0.6 -45.13 -79.61)"><foreignObject height="9.46" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="12.63"><math alttext="N" class="ltx_Math" display="inline" id="S1.F1.pic1.9.9.9.9.9.9.9.9.9.9.9.9.9.3.1.1.1.1.1.1.1.1.1.1.1.m1.1"><semantics id="S1.F1.pic1.9.9.9.9.9.9.9.9.9.9.9.9.9.3.1.1.1.1.1.1.1.1.1.1.1.m1.1a"><mi id="S1.F1.pic1.9.9.9.9.9.9.9.9.9.9.9.9.9.3.1.1.1.1.1.1.1.1.1.1.1.m1.1.1" xref="S1.F1.pic1.9.9.9.9.9.9.9.9.9.9.9.9.9.3.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S1.F1.pic1.9.9.9.9.9.9.9.9.9.9.9.9.9.3.1.1.1.1.1.1.1.1.1.1.1.m1.1b"><ci id="S1.F1.pic1.9.9.9.9.9.9.9.9.9.9.9.9.9.3.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S1.F1.pic1.9.9.9.9.9.9.9.9.9.9.9.9.9.3.1.1.1.1.1.1.1.1.1.1.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.pic1.9.9.9.9.9.9.9.9.9.9.9.9.9.3.1.1.1.1.1.1.1.1.1.1.1.m1.1c">N</annotation><annotation encoding="application/x-llamapun" id="S1.F1.pic1.9.9.9.9.9.9.9.9.9.9.9.9.9.3.1.1.1.1.1.1.1.1.1.1.1.m1.1d">italic_N</annotation></semantics></math></foreignObject></g><g stroke-width="0.5pt"><path d="M -51.18 -177.17 M -51.18 -177.17 L -51.18 -133.86 L -29.53 -133.86 L -29.53 -177.17 Z M -29.53 -133.86" style="fill:none"></path></g><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 -48.36 -158.16)"><foreignObject height="13.61" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="16.02"><math alttext="\Phi_{\textrm{Q}}" class="ltx_Math" display="inline" id="S1.F1.pic1.10.10.10.10.10.10.10.10.10.10.10.10.10.1.1.1.1.1.1.1.1.1.1.m1.1"><semantics id="S1.F1.pic1.10.10.10.10.10.10.10.10.10.10.10.10.10.1.1.1.1.1.1.1.1.1.1.m1.1a"><msub id="S1.F1.pic1.10.10.10.10.10.10.10.10.10.10.10.10.10.1.1.1.1.1.1.1.1.1.1.m1.1.1" xref="S1.F1.pic1.10.10.10.10.10.10.10.10.10.10.10.10.10.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml"><mi id="S1.F1.pic1.10.10.10.10.10.10.10.10.10.10.10.10.10.1.1.1.1.1.1.1.1.1.1.m1.1.1.2" mathvariant="normal" xref="S1.F1.pic1.10.10.10.10.10.10.10.10.10.10.10.10.10.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.cmml">Φ</mi><mtext id="S1.F1.pic1.10.10.10.10.10.10.10.10.10.10.10.10.10.1.1.1.1.1.1.1.1.1.1.m1.1.1.3" xref="S1.F1.pic1.10.10.10.10.10.10.10.10.10.10.10.10.10.1.1.1.1.1.1.1.1.1.1.m1.1.1.3a.cmml">Q</mtext></msub><annotation-xml encoding="MathML-Content" id="S1.F1.pic1.10.10.10.10.10.10.10.10.10.10.10.10.10.1.1.1.1.1.1.1.1.1.1.m1.1b"><apply id="S1.F1.pic1.10.10.10.10.10.10.10.10.10.10.10.10.10.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S1.F1.pic1.10.10.10.10.10.10.10.10.10.10.10.10.10.1.1.1.1.1.1.1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S1.F1.pic1.10.10.10.10.10.10.10.10.10.10.10.10.10.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.cmml" xref="S1.F1.pic1.10.10.10.10.10.10.10.10.10.10.10.10.10.1.1.1.1.1.1.1.1.1.1.m1.1.1">subscript</csymbol><ci id="S1.F1.pic1.10.10.10.10.10.10.10.10.10.10.10.10.10.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.cmml" xref="S1.F1.pic1.10.10.10.10.10.10.10.10.10.10.10.10.10.1.1.1.1.1.1.1.1.1.1.m1.1.1.2">Φ</ci><ci id="S1.F1.pic1.10.10.10.10.10.10.10.10.10.10.10.10.10.1.1.1.1.1.1.1.1.1.1.m1.1.1.3a.cmml" xref="S1.F1.pic1.10.10.10.10.10.10.10.10.10.10.10.10.10.1.1.1.1.1.1.1.1.1.1.m1.1.1.3"><mtext id="S1.F1.pic1.10.10.10.10.10.10.10.10.10.10.10.10.10.1.1.1.1.1.1.1.1.1.1.m1.1.1.3.cmml" mathsize="70%" xref="S1.F1.pic1.10.10.10.10.10.10.10.10.10.10.10.10.10.1.1.1.1.1.1.1.1.1.1.m1.1.1.3">Q</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.pic1.10.10.10.10.10.10.10.10.10.10.10.10.10.1.1.1.1.1.1.1.1.1.1.m1.1c">\Phi_{\textrm{Q}}</annotation><annotation encoding="application/x-llamapun" id="S1.F1.pic1.10.10.10.10.10.10.10.10.10.10.10.10.10.1.1.1.1.1.1.1.1.1.1.m1.1d">roman_Φ start_POSTSUBSCRIPT Q end_POSTSUBSCRIPT</annotation></semantics></math></foreignObject></g><g stroke-width="0.5pt"><path d="M -21.65 -167.32 M -21.65 -167.32 L -21.65 -145.67 L 21.65 -145.67 L 21.65 -167.32 Z M 21.65 -145.67" style="fill:none"></path></g><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 -8.01 -159.9)"><foreignObject height="12.1" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="16.02"><math alttext="\Phi_{\textrm{K}}" class="ltx_Math" display="inline" id="S1.F1.pic1.11.11.11.11.11.11.11.11.11.11.11.11.11.2.1.1.1.1.1.1.1.1.1.m1.1"><semantics id="S1.F1.pic1.11.11.11.11.11.11.11.11.11.11.11.11.11.2.1.1.1.1.1.1.1.1.1.m1.1a"><msub id="S1.F1.pic1.11.11.11.11.11.11.11.11.11.11.11.11.11.2.1.1.1.1.1.1.1.1.1.m1.1.1" xref="S1.F1.pic1.11.11.11.11.11.11.11.11.11.11.11.11.11.2.1.1.1.1.1.1.1.1.1.m1.1.1.cmml"><mi id="S1.F1.pic1.11.11.11.11.11.11.11.11.11.11.11.11.11.2.1.1.1.1.1.1.1.1.1.m1.1.1.2" mathvariant="normal" xref="S1.F1.pic1.11.11.11.11.11.11.11.11.11.11.11.11.11.2.1.1.1.1.1.1.1.1.1.m1.1.1.2.cmml">Φ</mi><mtext id="S1.F1.pic1.11.11.11.11.11.11.11.11.11.11.11.11.11.2.1.1.1.1.1.1.1.1.1.m1.1.1.3" xref="S1.F1.pic1.11.11.11.11.11.11.11.11.11.11.11.11.11.2.1.1.1.1.1.1.1.1.1.m1.1.1.3a.cmml">K</mtext></msub><annotation-xml encoding="MathML-Content" id="S1.F1.pic1.11.11.11.11.11.11.11.11.11.11.11.11.11.2.1.1.1.1.1.1.1.1.1.m1.1b"><apply id="S1.F1.pic1.11.11.11.11.11.11.11.11.11.11.11.11.11.2.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S1.F1.pic1.11.11.11.11.11.11.11.11.11.11.11.11.11.2.1.1.1.1.1.1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S1.F1.pic1.11.11.11.11.11.11.11.11.11.11.11.11.11.2.1.1.1.1.1.1.1.1.1.m1.1.1.1.cmml" xref="S1.F1.pic1.11.11.11.11.11.11.11.11.11.11.11.11.11.2.1.1.1.1.1.1.1.1.1.m1.1.1">subscript</csymbol><ci id="S1.F1.pic1.11.11.11.11.11.11.11.11.11.11.11.11.11.2.1.1.1.1.1.1.1.1.1.m1.1.1.2.cmml" xref="S1.F1.pic1.11.11.11.11.11.11.11.11.11.11.11.11.11.2.1.1.1.1.1.1.1.1.1.m1.1.1.2">Φ</ci><ci id="S1.F1.pic1.11.11.11.11.11.11.11.11.11.11.11.11.11.2.1.1.1.1.1.1.1.1.1.m1.1.1.3a.cmml" xref="S1.F1.pic1.11.11.11.11.11.11.11.11.11.11.11.11.11.2.1.1.1.1.1.1.1.1.1.m1.1.1.3"><mtext id="S1.F1.pic1.11.11.11.11.11.11.11.11.11.11.11.11.11.2.1.1.1.1.1.1.1.1.1.m1.1.1.3.cmml" mathsize="70%" xref="S1.F1.pic1.11.11.11.11.11.11.11.11.11.11.11.11.11.2.1.1.1.1.1.1.1.1.1.m1.1.1.3">K</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.pic1.11.11.11.11.11.11.11.11.11.11.11.11.11.2.1.1.1.1.1.1.1.1.1.m1.1c">\Phi_{\textrm{K}}</annotation><annotation encoding="application/x-llamapun" id="S1.F1.pic1.11.11.11.11.11.11.11.11.11.11.11.11.11.2.1.1.1.1.1.1.1.1.1.m1.1d">roman_Φ start_POSTSUBSCRIPT K end_POSTSUBSCRIPT</annotation></semantics></math></foreignObject></g><g stroke-width="0.5pt"><path d="M 27.56 -177.17 M 27.56 -177.17 L 27.56 -133.86 L 49.21 -133.86 L 49.21 -177.17 Z M 49.21 -133.86" style="fill:none"></path></g><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 33.2 -160.24)"><foreignObject height="9.46" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="10.38"><span class="ltx_text" id="S1.F1.pic1.34.34.34.34.1.1">V</span></foreignObject></g><g stroke-width="0.56906pt"><path d="M -21.65 -127.95 C -27.56 -137.8 -27.56 -177.17 -21.65 -187.01" style="fill:none"></path></g><g stroke-width="0.56906pt"><path d="M 51.18 -127.95 C 57.09 -137.8 57.09 -177.17 51.18 -187.01" style="fill:none"></path></g><g color="#808080" fill="#808080" stroke="#808080" transform="matrix(0.6 0.0 0.0 0.6 -43.01 -129.74)"><foreignObject height="5.96" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="12.15"><math alttext="m" class="ltx_Math" display="inline" id="S1.F1.pic1.12.12.12.12.12.12.12.12.12.12.12.12.12.3.1.1.1.1.1.1.1.1.1.1.1.m1.1"><semantics id="S1.F1.pic1.12.12.12.12.12.12.12.12.12.12.12.12.12.3.1.1.1.1.1.1.1.1.1.1.1.m1.1a"><mi id="S1.F1.pic1.12.12.12.12.12.12.12.12.12.12.12.12.12.3.1.1.1.1.1.1.1.1.1.1.1.m1.1.1" xref="S1.F1.pic1.12.12.12.12.12.12.12.12.12.12.12.12.12.3.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S1.F1.pic1.12.12.12.12.12.12.12.12.12.12.12.12.12.3.1.1.1.1.1.1.1.1.1.1.1.m1.1b"><ci id="S1.F1.pic1.12.12.12.12.12.12.12.12.12.12.12.12.12.3.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S1.F1.pic1.12.12.12.12.12.12.12.12.12.12.12.12.12.3.1.1.1.1.1.1.1.1.1.1.1.m1.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.pic1.12.12.12.12.12.12.12.12.12.12.12.12.12.3.1.1.1.1.1.1.1.1.1.1.1.m1.1c">m</annotation><annotation encoding="application/x-llamapun" id="S1.F1.pic1.12.12.12.12.12.12.12.12.12.12.12.12.12.3.1.1.1.1.1.1.1.1.1.1.1.m1.1d">italic_m</annotation></semantics></math></foreignObject></g><g color="#808080" fill="#808080" stroke="#808080" transform="matrix(0.6 0.0 0.0 0.6 -61.86 -158.35)"><foreignObject height="9.46" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="12.63"><math alttext="N" class="ltx_Math" display="inline" id="S1.F1.pic1.13.13.13.13.13.13.13.13.13.13.13.13.13.4.1.1.1.1.1.1.1.1.1.1.1.m1.1"><semantics id="S1.F1.pic1.13.13.13.13.13.13.13.13.13.13.13.13.13.4.1.1.1.1.1.1.1.1.1.1.1.m1.1a"><mi id="S1.F1.pic1.13.13.13.13.13.13.13.13.13.13.13.13.13.4.1.1.1.1.1.1.1.1.1.1.1.m1.1.1" xref="S1.F1.pic1.13.13.13.13.13.13.13.13.13.13.13.13.13.4.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S1.F1.pic1.13.13.13.13.13.13.13.13.13.13.13.13.13.4.1.1.1.1.1.1.1.1.1.1.1.m1.1b"><ci id="S1.F1.pic1.13.13.13.13.13.13.13.13.13.13.13.13.13.4.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S1.F1.pic1.13.13.13.13.13.13.13.13.13.13.13.13.13.4.1.1.1.1.1.1.1.1.1.1.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.pic1.13.13.13.13.13.13.13.13.13.13.13.13.13.4.1.1.1.1.1.1.1.1.1.1.1.m1.1c">N</annotation><annotation encoding="application/x-llamapun" id="S1.F1.pic1.13.13.13.13.13.13.13.13.13.13.13.13.13.4.1.1.1.1.1.1.1.1.1.1.1.m1.1d">italic_N</annotation></semantics></math></foreignObject></g><g color="#808080" fill="#808080" stroke="#808080" transform="matrix(0.6 0.0 0.0 0.6 35.24 -130.84)"><foreignObject height="9.61" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="7.2"><math alttext="d" class="ltx_Math" display="inline" id="S1.F1.pic1.14.14.14.14.14.14.14.14.14.14.14.14.14.5.1.1.1.1.1.1.1.1.1.1.1.m1.1"><semantics id="S1.F1.pic1.14.14.14.14.14.14.14.14.14.14.14.14.14.5.1.1.1.1.1.1.1.1.1.1.1.m1.1a"><mi id="S1.F1.pic1.14.14.14.14.14.14.14.14.14.14.14.14.14.5.1.1.1.1.1.1.1.1.1.1.1.m1.1.1" xref="S1.F1.pic1.14.14.14.14.14.14.14.14.14.14.14.14.14.5.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S1.F1.pic1.14.14.14.14.14.14.14.14.14.14.14.14.14.5.1.1.1.1.1.1.1.1.1.1.1.m1.1b"><ci id="S1.F1.pic1.14.14.14.14.14.14.14.14.14.14.14.14.14.5.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S1.F1.pic1.14.14.14.14.14.14.14.14.14.14.14.14.14.5.1.1.1.1.1.1.1.1.1.1.1.m1.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.pic1.14.14.14.14.14.14.14.14.14.14.14.14.14.5.1.1.1.1.1.1.1.1.1.1.1.m1.1c">d</annotation><annotation encoding="application/x-llamapun" id="S1.F1.pic1.14.14.14.14.14.14.14.14.14.14.14.14.14.5.1.1.1.1.1.1.1.1.1.1.1.m1.1d">italic_d</annotation></semantics></math></foreignObject></g><g color="#808080" fill="#808080" stroke="#808080" transform="matrix(0.6 0.0 0.0 0.6 -3.79 -130.79)"><foreignObject height="9.46" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="12.63"><math alttext="N" class="ltx_Math" display="inline" id="S1.F1.pic1.15.15.15.15.15.15.15.15.15.15.15.15.15.6.1.1.1.1.1.1.1.1.1.1.1.m1.1"><semantics id="S1.F1.pic1.15.15.15.15.15.15.15.15.15.15.15.15.15.6.1.1.1.1.1.1.1.1.1.1.1.m1.1a"><mi id="S1.F1.pic1.15.15.15.15.15.15.15.15.15.15.15.15.15.6.1.1.1.1.1.1.1.1.1.1.1.m1.1.1" xref="S1.F1.pic1.15.15.15.15.15.15.15.15.15.15.15.15.15.6.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S1.F1.pic1.15.15.15.15.15.15.15.15.15.15.15.15.15.6.1.1.1.1.1.1.1.1.1.1.1.m1.1b"><ci id="S1.F1.pic1.15.15.15.15.15.15.15.15.15.15.15.15.15.6.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S1.F1.pic1.15.15.15.15.15.15.15.15.15.15.15.15.15.6.1.1.1.1.1.1.1.1.1.1.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.pic1.15.15.15.15.15.15.15.15.15.15.15.15.15.6.1.1.1.1.1.1.1.1.1.1.1.m1.1c">N</annotation><annotation encoding="application/x-llamapun" id="S1.F1.pic1.15.15.15.15.15.15.15.15.15.15.15.15.15.6.1.1.1.1.1.1.1.1.1.1.1.m1.1d">italic_N</annotation></semantics></math></foreignObject></g><g stroke-width="0.5pt"><path d="M 82.68 -98.43 M 82.68 -98.43 L 82.68 -55.12 L 125.98 -55.12 L 125.98 -98.43 Z M 125.98 -55.12" style="fill:none"></path></g><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 99.14 -81.5)"><foreignObject height="9.46" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="10.38"><span class="ltx_text" id="S1.F1.pic1.35.35.35.35.1.1">A</span></foreignObject></g><g stroke-width="0.5pt"><path d="M 141.73 -98.43 M 141.73 -98.43 L 141.73 -55.12 L 185.04 -55.12 L 185.04 -98.43 Z M 185.04 -55.12" style="fill:none"></path></g><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 146.23 -80.23)"><foreignObject height="13.84" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="34.3"><math alttext="\textrm{M}(\mathcal{G})" class="ltx_Math" display="inline" id="S1.F1.pic1.16.16.16.16.16.16.16.16.16.16.16.16.16.1.1.1.1.1.1.1.1.1.1.m1.1"><semantics id="S1.F1.pic1.16.16.16.16.16.16.16.16.16.16.16.16.16.1.1.1.1.1.1.1.1.1.1.m1.1a"><mrow id="S1.F1.pic1.16.16.16.16.16.16.16.16.16.16.16.16.16.1.1.1.1.1.1.1.1.1.1.m1.1.2" xref="S1.F1.pic1.16.16.16.16.16.16.16.16.16.16.16.16.16.1.1.1.1.1.1.1.1.1.1.m1.1.2.cmml"><mtext id="S1.F1.pic1.16.16.16.16.16.16.16.16.16.16.16.16.16.1.1.1.1.1.1.1.1.1.1.m1.1.2.2" xref="S1.F1.pic1.16.16.16.16.16.16.16.16.16.16.16.16.16.1.1.1.1.1.1.1.1.1.1.m1.1.2.2a.cmml">M</mtext><mo id="S1.F1.pic1.16.16.16.16.16.16.16.16.16.16.16.16.16.1.1.1.1.1.1.1.1.1.1.m1.1.2.1" xref="S1.F1.pic1.16.16.16.16.16.16.16.16.16.16.16.16.16.1.1.1.1.1.1.1.1.1.1.m1.1.2.1.cmml">⁢</mo><mrow id="S1.F1.pic1.16.16.16.16.16.16.16.16.16.16.16.16.16.1.1.1.1.1.1.1.1.1.1.m1.1.2.3.2" xref="S1.F1.pic1.16.16.16.16.16.16.16.16.16.16.16.16.16.1.1.1.1.1.1.1.1.1.1.m1.1.2.cmml"><mo id="S1.F1.pic1.16.16.16.16.16.16.16.16.16.16.16.16.16.1.1.1.1.1.1.1.1.1.1.m1.1.2.3.2.1" stretchy="false" xref="S1.F1.pic1.16.16.16.16.16.16.16.16.16.16.16.16.16.1.1.1.1.1.1.1.1.1.1.m1.1.2.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S1.F1.pic1.16.16.16.16.16.16.16.16.16.16.16.16.16.1.1.1.1.1.1.1.1.1.1.m1.1.1" xref="S1.F1.pic1.16.16.16.16.16.16.16.16.16.16.16.16.16.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml">𝒢</mi><mo id="S1.F1.pic1.16.16.16.16.16.16.16.16.16.16.16.16.16.1.1.1.1.1.1.1.1.1.1.m1.1.2.3.2.2" stretchy="false" xref="S1.F1.pic1.16.16.16.16.16.16.16.16.16.16.16.16.16.1.1.1.1.1.1.1.1.1.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.F1.pic1.16.16.16.16.16.16.16.16.16.16.16.16.16.1.1.1.1.1.1.1.1.1.1.m1.1b"><apply id="S1.F1.pic1.16.16.16.16.16.16.16.16.16.16.16.16.16.1.1.1.1.1.1.1.1.1.1.m1.1.2.cmml" xref="S1.F1.pic1.16.16.16.16.16.16.16.16.16.16.16.16.16.1.1.1.1.1.1.1.1.1.1.m1.1.2"><times id="S1.F1.pic1.16.16.16.16.16.16.16.16.16.16.16.16.16.1.1.1.1.1.1.1.1.1.1.m1.1.2.1.cmml" xref="S1.F1.pic1.16.16.16.16.16.16.16.16.16.16.16.16.16.1.1.1.1.1.1.1.1.1.1.m1.1.2.1"></times><ci id="S1.F1.pic1.16.16.16.16.16.16.16.16.16.16.16.16.16.1.1.1.1.1.1.1.1.1.1.m1.1.2.2a.cmml" xref="S1.F1.pic1.16.16.16.16.16.16.16.16.16.16.16.16.16.1.1.1.1.1.1.1.1.1.1.m1.1.2.2"><mtext id="S1.F1.pic1.16.16.16.16.16.16.16.16.16.16.16.16.16.1.1.1.1.1.1.1.1.1.1.m1.1.2.2.cmml" xref="S1.F1.pic1.16.16.16.16.16.16.16.16.16.16.16.16.16.1.1.1.1.1.1.1.1.1.1.m1.1.2.2">M</mtext></ci><ci id="S1.F1.pic1.16.16.16.16.16.16.16.16.16.16.16.16.16.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S1.F1.pic1.16.16.16.16.16.16.16.16.16.16.16.16.16.1.1.1.1.1.1.1.1.1.1.m1.1.1">𝒢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.pic1.16.16.16.16.16.16.16.16.16.16.16.16.16.1.1.1.1.1.1.1.1.1.1.m1.1c">\textrm{M}(\mathcal{G})</annotation><annotation encoding="application/x-llamapun" id="S1.F1.pic1.16.16.16.16.16.16.16.16.16.16.16.16.16.1.1.1.1.1.1.1.1.1.1.m1.1d">M ( caligraphic_G )</annotation></semantics></math></foreignObject></g><g fill="#000000" stroke="#000000" transform="matrix(1.25 0.0 0.0 1.25 127.13 -81.1)"><foreignObject height="9.22" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="10.76"><math alttext="\odot" class="ltx_Math" display="inline" id="S1.F1.pic1.17.17.17.17.17.17.17.17.17.17.17.17.17.2.1.1.1.1.1.1.1.1.1.m1.1"><semantics id="S1.F1.pic1.17.17.17.17.17.17.17.17.17.17.17.17.17.2.1.1.1.1.1.1.1.1.1.m1.1a"><mo id="S1.F1.pic1.17.17.17.17.17.17.17.17.17.17.17.17.17.2.1.1.1.1.1.1.1.1.1.m1.1.1" xref="S1.F1.pic1.17.17.17.17.17.17.17.17.17.17.17.17.17.2.1.1.1.1.1.1.1.1.1.m1.1.1.cmml">⊙</mo><annotation-xml encoding="MathML-Content" id="S1.F1.pic1.17.17.17.17.17.17.17.17.17.17.17.17.17.2.1.1.1.1.1.1.1.1.1.m1.1b"><csymbol cd="latexml" id="S1.F1.pic1.17.17.17.17.17.17.17.17.17.17.17.17.17.2.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S1.F1.pic1.17.17.17.17.17.17.17.17.17.17.17.17.17.2.1.1.1.1.1.1.1.1.1.m1.1.1">direct-product</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.pic1.17.17.17.17.17.17.17.17.17.17.17.17.17.2.1.1.1.1.1.1.1.1.1.m1.1c">\odot</annotation><annotation encoding="application/x-llamapun" id="S1.F1.pic1.17.17.17.17.17.17.17.17.17.17.17.17.17.2.1.1.1.1.1.1.1.1.1.m1.1d">⊙</annotation></semantics></math></foreignObject></g><g stroke-width="0.56906pt"><path d="M 80.71 -49.21 C 74.8 -59.06 74.8 -98.43 80.71 -108.27" style="fill:none"></path></g><g stroke-width="0.56906pt"><path d="M 187.01 -49.21 C 192.91 -59.06 192.91 -98.43 187.01 -108.27" style="fill:none"></path></g><g stroke-width="0.5pt"><path d="M 200.79 -98.43 M 200.79 -98.43 L 200.79 -55.12 L 222.44 -55.12 L 222.44 -98.43 Z M 222.44 -55.12" style="fill:none"></path></g><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 206.43 -81.5)"><foreignObject height="9.46" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="10.38"><span class="ltx_text" id="S1.F1.pic1.36.36.36.36.1.1">V</span></foreignObject></g><g color="#808080" fill="#808080" stroke="#808080" transform="matrix(0.6 0.0 0.0 0.6 100.54 -52.05)"><foreignObject height="9.46" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="12.63"><math alttext="N" class="ltx_Math" display="inline" id="S1.F1.pic1.18.18.18.18.18.18.18.18.18.18.18.18.18.3.1.1.1.1.1.1.1.1.1.1.1.m1.1"><semantics id="S1.F1.pic1.18.18.18.18.18.18.18.18.18.18.18.18.18.3.1.1.1.1.1.1.1.1.1.1.1.m1.1a"><mi id="S1.F1.pic1.18.18.18.18.18.18.18.18.18.18.18.18.18.3.1.1.1.1.1.1.1.1.1.1.1.m1.1.1" xref="S1.F1.pic1.18.18.18.18.18.18.18.18.18.18.18.18.18.3.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S1.F1.pic1.18.18.18.18.18.18.18.18.18.18.18.18.18.3.1.1.1.1.1.1.1.1.1.1.1.m1.1b"><ci id="S1.F1.pic1.18.18.18.18.18.18.18.18.18.18.18.18.18.3.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S1.F1.pic1.18.18.18.18.18.18.18.18.18.18.18.18.18.3.1.1.1.1.1.1.1.1.1.1.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.pic1.18.18.18.18.18.18.18.18.18.18.18.18.18.3.1.1.1.1.1.1.1.1.1.1.1.m1.1c">N</annotation><annotation encoding="application/x-llamapun" id="S1.F1.pic1.18.18.18.18.18.18.18.18.18.18.18.18.18.3.1.1.1.1.1.1.1.1.1.1.1.m1.1d">italic_N</annotation></semantics></math></foreignObject></g><g color="#808080" fill="#808080" stroke="#808080" transform="matrix(0.6 0.0 0.0 0.6 159.6 -52.05)"><foreignObject height="9.46" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="12.63"><math alttext="N" class="ltx_Math" display="inline" id="S1.F1.pic1.19.19.19.19.19.19.19.19.19.19.19.19.19.4.1.1.1.1.1.1.1.1.1.1.1.m1.1"><semantics id="S1.F1.pic1.19.19.19.19.19.19.19.19.19.19.19.19.19.4.1.1.1.1.1.1.1.1.1.1.1.m1.1a"><mi id="S1.F1.pic1.19.19.19.19.19.19.19.19.19.19.19.19.19.4.1.1.1.1.1.1.1.1.1.1.1.m1.1.1" xref="S1.F1.pic1.19.19.19.19.19.19.19.19.19.19.19.19.19.4.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S1.F1.pic1.19.19.19.19.19.19.19.19.19.19.19.19.19.4.1.1.1.1.1.1.1.1.1.1.1.m1.1b"><ci id="S1.F1.pic1.19.19.19.19.19.19.19.19.19.19.19.19.19.4.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S1.F1.pic1.19.19.19.19.19.19.19.19.19.19.19.19.19.4.1.1.1.1.1.1.1.1.1.1.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.pic1.19.19.19.19.19.19.19.19.19.19.19.19.19.4.1.1.1.1.1.1.1.1.1.1.1.m1.1c">N</annotation><annotation encoding="application/x-llamapun" id="S1.F1.pic1.19.19.19.19.19.19.19.19.19.19.19.19.19.4.1.1.1.1.1.1.1.1.1.1.1.m1.1d">italic_N</annotation></semantics></math></foreignObject></g><g color="#808080" fill="#808080" stroke="#808080" transform="matrix(0.6 0.0 0.0 0.6 65.11 -79.61)"><foreignObject height="9.46" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="12.63"><math alttext="N" class="ltx_Math" display="inline" id="S1.F1.pic1.20.20.20.20.20.20.20.20.20.20.20.20.20.5.1.1.1.1.1.1.1.1.1.1.1.m1.1"><semantics id="S1.F1.pic1.20.20.20.20.20.20.20.20.20.20.20.20.20.5.1.1.1.1.1.1.1.1.1.1.1.m1.1a"><mi id="S1.F1.pic1.20.20.20.20.20.20.20.20.20.20.20.20.20.5.1.1.1.1.1.1.1.1.1.1.1.m1.1.1" xref="S1.F1.pic1.20.20.20.20.20.20.20.20.20.20.20.20.20.5.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S1.F1.pic1.20.20.20.20.20.20.20.20.20.20.20.20.20.5.1.1.1.1.1.1.1.1.1.1.1.m1.1b"><ci id="S1.F1.pic1.20.20.20.20.20.20.20.20.20.20.20.20.20.5.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S1.F1.pic1.20.20.20.20.20.20.20.20.20.20.20.20.20.5.1.1.1.1.1.1.1.1.1.1.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.pic1.20.20.20.20.20.20.20.20.20.20.20.20.20.5.1.1.1.1.1.1.1.1.1.1.1.m1.1c">N</annotation><annotation encoding="application/x-llamapun" id="S1.F1.pic1.20.20.20.20.20.20.20.20.20.20.20.20.20.5.1.1.1.1.1.1.1.1.1.1.1.m1.1d">italic_N</annotation></semantics></math></foreignObject></g><g color="#808080" fill="#808080" stroke="#808080" transform="matrix(0.6 0.0 0.0 0.6 208.47 -52.1)"><foreignObject height="9.61" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="7.2"><math alttext="d" class="ltx_Math" display="inline" id="S1.F1.pic1.21.21.21.21.21.21.21.21.21.21.21.21.21.6.1.1.1.1.1.1.1.1.1.1.1.m1.1"><semantics id="S1.F1.pic1.21.21.21.21.21.21.21.21.21.21.21.21.21.6.1.1.1.1.1.1.1.1.1.1.1.m1.1a"><mi id="S1.F1.pic1.21.21.21.21.21.21.21.21.21.21.21.21.21.6.1.1.1.1.1.1.1.1.1.1.1.m1.1.1" xref="S1.F1.pic1.21.21.21.21.21.21.21.21.21.21.21.21.21.6.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S1.F1.pic1.21.21.21.21.21.21.21.21.21.21.21.21.21.6.1.1.1.1.1.1.1.1.1.1.1.m1.1b"><ci id="S1.F1.pic1.21.21.21.21.21.21.21.21.21.21.21.21.21.6.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S1.F1.pic1.21.21.21.21.21.21.21.21.21.21.21.21.21.6.1.1.1.1.1.1.1.1.1.1.1.m1.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.pic1.21.21.21.21.21.21.21.21.21.21.21.21.21.6.1.1.1.1.1.1.1.1.1.1.1.m1.1c">d</annotation><annotation encoding="application/x-llamapun" id="S1.F1.pic1.21.21.21.21.21.21.21.21.21.21.21.21.21.6.1.1.1.1.1.1.1.1.1.1.1.m1.1d">italic_d</annotation></semantics></math></foreignObject></g><g stroke-width="0.5pt"><path d="M 94.49 -177.17 M 94.49 -177.17 L 94.49 -133.86 L 126.97 -133.86 L 126.97 -177.17 Z M 126.97 -133.86" style="fill:none"></path></g><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 100.25 -158.43)"><foreignObject height="14.15" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="21.95"><math alttext="\widehat{\Phi}_{\textrm{Q},\mathcal{G}}" class="ltx_Math" display="inline" id="S1.F1.pic1.22.22.22.22.22.22.22.22.22.22.22.22.22.1.1.1.1.1.1.1.1.1.1.m1.2"><semantics id="S1.F1.pic1.22.22.22.22.22.22.22.22.22.22.22.22.22.1.1.1.1.1.1.1.1.1.1.m1.2a"><msub id="S1.F1.pic1.22.22.22.22.22.22.22.22.22.22.22.22.22.1.1.1.1.1.1.1.1.1.1.m1.2.3" xref="S1.F1.pic1.22.22.22.22.22.22.22.22.22.22.22.22.22.1.1.1.1.1.1.1.1.1.1.m1.2.3.cmml"><mover accent="true" id="S1.F1.pic1.22.22.22.22.22.22.22.22.22.22.22.22.22.1.1.1.1.1.1.1.1.1.1.m1.2.3.2" xref="S1.F1.pic1.22.22.22.22.22.22.22.22.22.22.22.22.22.1.1.1.1.1.1.1.1.1.1.m1.2.3.2.cmml"><mi id="S1.F1.pic1.22.22.22.22.22.22.22.22.22.22.22.22.22.1.1.1.1.1.1.1.1.1.1.m1.2.3.2.2" mathvariant="normal" xref="S1.F1.pic1.22.22.22.22.22.22.22.22.22.22.22.22.22.1.1.1.1.1.1.1.1.1.1.m1.2.3.2.2.cmml">Φ</mi><mo id="S1.F1.pic1.22.22.22.22.22.22.22.22.22.22.22.22.22.1.1.1.1.1.1.1.1.1.1.m1.2.3.2.1" xref="S1.F1.pic1.22.22.22.22.22.22.22.22.22.22.22.22.22.1.1.1.1.1.1.1.1.1.1.m1.2.3.2.1.cmml">^</mo></mover><mrow id="S1.F1.pic1.22.22.22.22.22.22.22.22.22.22.22.22.22.1.1.1.1.1.1.1.1.1.1.m1.2.2.2.4" xref="S1.F1.pic1.22.22.22.22.22.22.22.22.22.22.22.22.22.1.1.1.1.1.1.1.1.1.1.m1.2.2.2.3.cmml"><mtext id="S1.F1.pic1.22.22.22.22.22.22.22.22.22.22.22.22.22.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1" xref="S1.F1.pic1.22.22.22.22.22.22.22.22.22.22.22.22.22.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1a.cmml">Q</mtext><mo id="S1.F1.pic1.22.22.22.22.22.22.22.22.22.22.22.22.22.1.1.1.1.1.1.1.1.1.1.m1.2.2.2.4.1" xref="S1.F1.pic1.22.22.22.22.22.22.22.22.22.22.22.22.22.1.1.1.1.1.1.1.1.1.1.m1.2.2.2.3.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S1.F1.pic1.22.22.22.22.22.22.22.22.22.22.22.22.22.1.1.1.1.1.1.1.1.1.1.m1.2.2.2.2" xref="S1.F1.pic1.22.22.22.22.22.22.22.22.22.22.22.22.22.1.1.1.1.1.1.1.1.1.1.m1.2.2.2.2.cmml">𝒢</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S1.F1.pic1.22.22.22.22.22.22.22.22.22.22.22.22.22.1.1.1.1.1.1.1.1.1.1.m1.2b"><apply id="S1.F1.pic1.22.22.22.22.22.22.22.22.22.22.22.22.22.1.1.1.1.1.1.1.1.1.1.m1.2.3.cmml" xref="S1.F1.pic1.22.22.22.22.22.22.22.22.22.22.22.22.22.1.1.1.1.1.1.1.1.1.1.m1.2.3"><csymbol cd="ambiguous" id="S1.F1.pic1.22.22.22.22.22.22.22.22.22.22.22.22.22.1.1.1.1.1.1.1.1.1.1.m1.2.3.1.cmml" xref="S1.F1.pic1.22.22.22.22.22.22.22.22.22.22.22.22.22.1.1.1.1.1.1.1.1.1.1.m1.2.3">subscript</csymbol><apply id="S1.F1.pic1.22.22.22.22.22.22.22.22.22.22.22.22.22.1.1.1.1.1.1.1.1.1.1.m1.2.3.2.cmml" xref="S1.F1.pic1.22.22.22.22.22.22.22.22.22.22.22.22.22.1.1.1.1.1.1.1.1.1.1.m1.2.3.2"><ci id="S1.F1.pic1.22.22.22.22.22.22.22.22.22.22.22.22.22.1.1.1.1.1.1.1.1.1.1.m1.2.3.2.1.cmml" xref="S1.F1.pic1.22.22.22.22.22.22.22.22.22.22.22.22.22.1.1.1.1.1.1.1.1.1.1.m1.2.3.2.1">^</ci><ci id="S1.F1.pic1.22.22.22.22.22.22.22.22.22.22.22.22.22.1.1.1.1.1.1.1.1.1.1.m1.2.3.2.2.cmml" xref="S1.F1.pic1.22.22.22.22.22.22.22.22.22.22.22.22.22.1.1.1.1.1.1.1.1.1.1.m1.2.3.2.2">Φ</ci></apply><list id="S1.F1.pic1.22.22.22.22.22.22.22.22.22.22.22.22.22.1.1.1.1.1.1.1.1.1.1.m1.2.2.2.3.cmml" xref="S1.F1.pic1.22.22.22.22.22.22.22.22.22.22.22.22.22.1.1.1.1.1.1.1.1.1.1.m1.2.2.2.4"><ci id="S1.F1.pic1.22.22.22.22.22.22.22.22.22.22.22.22.22.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1a.cmml" xref="S1.F1.pic1.22.22.22.22.22.22.22.22.22.22.22.22.22.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1"><mtext id="S1.F1.pic1.22.22.22.22.22.22.22.22.22.22.22.22.22.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.cmml" mathsize="70%" xref="S1.F1.pic1.22.22.22.22.22.22.22.22.22.22.22.22.22.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1">Q</mtext></ci><ci id="S1.F1.pic1.22.22.22.22.22.22.22.22.22.22.22.22.22.1.1.1.1.1.1.1.1.1.1.m1.2.2.2.2.cmml" xref="S1.F1.pic1.22.22.22.22.22.22.22.22.22.22.22.22.22.1.1.1.1.1.1.1.1.1.1.m1.2.2.2.2">𝒢</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.pic1.22.22.22.22.22.22.22.22.22.22.22.22.22.1.1.1.1.1.1.1.1.1.1.m1.2c">\widehat{\Phi}_{\textrm{Q},\mathcal{G}}</annotation><annotation encoding="application/x-llamapun" id="S1.F1.pic1.22.22.22.22.22.22.22.22.22.22.22.22.22.1.1.1.1.1.1.1.1.1.1.m1.2d">over^ start_ARG roman_Φ end_ARG start_POSTSUBSCRIPT Q , caligraphic_G end_POSTSUBSCRIPT</annotation></semantics></math></foreignObject></g><g stroke-width="0.5pt"><path d="M 133.86 -171.26 M 133.86 -171.26 L 133.86 -138.78 L 177.17 -138.78 L 177.17 -171.26 Z M 177.17 -138.78" style="fill:none"></path></g><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 143.55 -158.43)"><foreignObject height="14.15" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="21.95"><math alttext="\widehat{\Phi}_{\textrm{K},\mathcal{G}}" class="ltx_Math" display="inline" id="S1.F1.pic1.23.23.23.23.23.23.23.23.23.23.23.23.23.2.1.1.1.1.1.1.1.1.1.m1.2"><semantics id="S1.F1.pic1.23.23.23.23.23.23.23.23.23.23.23.23.23.2.1.1.1.1.1.1.1.1.1.m1.2a"><msub id="S1.F1.pic1.23.23.23.23.23.23.23.23.23.23.23.23.23.2.1.1.1.1.1.1.1.1.1.m1.2.3" xref="S1.F1.pic1.23.23.23.23.23.23.23.23.23.23.23.23.23.2.1.1.1.1.1.1.1.1.1.m1.2.3.cmml"><mover accent="true" id="S1.F1.pic1.23.23.23.23.23.23.23.23.23.23.23.23.23.2.1.1.1.1.1.1.1.1.1.m1.2.3.2" xref="S1.F1.pic1.23.23.23.23.23.23.23.23.23.23.23.23.23.2.1.1.1.1.1.1.1.1.1.m1.2.3.2.cmml"><mi id="S1.F1.pic1.23.23.23.23.23.23.23.23.23.23.23.23.23.2.1.1.1.1.1.1.1.1.1.m1.2.3.2.2" mathvariant="normal" xref="S1.F1.pic1.23.23.23.23.23.23.23.23.23.23.23.23.23.2.1.1.1.1.1.1.1.1.1.m1.2.3.2.2.cmml">Φ</mi><mo id="S1.F1.pic1.23.23.23.23.23.23.23.23.23.23.23.23.23.2.1.1.1.1.1.1.1.1.1.m1.2.3.2.1" xref="S1.F1.pic1.23.23.23.23.23.23.23.23.23.23.23.23.23.2.1.1.1.1.1.1.1.1.1.m1.2.3.2.1.cmml">^</mo></mover><mrow id="S1.F1.pic1.23.23.23.23.23.23.23.23.23.23.23.23.23.2.1.1.1.1.1.1.1.1.1.m1.2.2.2.4" xref="S1.F1.pic1.23.23.23.23.23.23.23.23.23.23.23.23.23.2.1.1.1.1.1.1.1.1.1.m1.2.2.2.3.cmml"><mtext id="S1.F1.pic1.23.23.23.23.23.23.23.23.23.23.23.23.23.2.1.1.1.1.1.1.1.1.1.m1.1.1.1.1" xref="S1.F1.pic1.23.23.23.23.23.23.23.23.23.23.23.23.23.2.1.1.1.1.1.1.1.1.1.m1.1.1.1.1a.cmml">K</mtext><mo id="S1.F1.pic1.23.23.23.23.23.23.23.23.23.23.23.23.23.2.1.1.1.1.1.1.1.1.1.m1.2.2.2.4.1" xref="S1.F1.pic1.23.23.23.23.23.23.23.23.23.23.23.23.23.2.1.1.1.1.1.1.1.1.1.m1.2.2.2.3.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S1.F1.pic1.23.23.23.23.23.23.23.23.23.23.23.23.23.2.1.1.1.1.1.1.1.1.1.m1.2.2.2.2" xref="S1.F1.pic1.23.23.23.23.23.23.23.23.23.23.23.23.23.2.1.1.1.1.1.1.1.1.1.m1.2.2.2.2.cmml">𝒢</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S1.F1.pic1.23.23.23.23.23.23.23.23.23.23.23.23.23.2.1.1.1.1.1.1.1.1.1.m1.2b"><apply id="S1.F1.pic1.23.23.23.23.23.23.23.23.23.23.23.23.23.2.1.1.1.1.1.1.1.1.1.m1.2.3.cmml" xref="S1.F1.pic1.23.23.23.23.23.23.23.23.23.23.23.23.23.2.1.1.1.1.1.1.1.1.1.m1.2.3"><csymbol cd="ambiguous" id="S1.F1.pic1.23.23.23.23.23.23.23.23.23.23.23.23.23.2.1.1.1.1.1.1.1.1.1.m1.2.3.1.cmml" xref="S1.F1.pic1.23.23.23.23.23.23.23.23.23.23.23.23.23.2.1.1.1.1.1.1.1.1.1.m1.2.3">subscript</csymbol><apply id="S1.F1.pic1.23.23.23.23.23.23.23.23.23.23.23.23.23.2.1.1.1.1.1.1.1.1.1.m1.2.3.2.cmml" xref="S1.F1.pic1.23.23.23.23.23.23.23.23.23.23.23.23.23.2.1.1.1.1.1.1.1.1.1.m1.2.3.2"><ci id="S1.F1.pic1.23.23.23.23.23.23.23.23.23.23.23.23.23.2.1.1.1.1.1.1.1.1.1.m1.2.3.2.1.cmml" xref="S1.F1.pic1.23.23.23.23.23.23.23.23.23.23.23.23.23.2.1.1.1.1.1.1.1.1.1.m1.2.3.2.1">^</ci><ci id="S1.F1.pic1.23.23.23.23.23.23.23.23.23.23.23.23.23.2.1.1.1.1.1.1.1.1.1.m1.2.3.2.2.cmml" xref="S1.F1.pic1.23.23.23.23.23.23.23.23.23.23.23.23.23.2.1.1.1.1.1.1.1.1.1.m1.2.3.2.2">Φ</ci></apply><list id="S1.F1.pic1.23.23.23.23.23.23.23.23.23.23.23.23.23.2.1.1.1.1.1.1.1.1.1.m1.2.2.2.3.cmml" xref="S1.F1.pic1.23.23.23.23.23.23.23.23.23.23.23.23.23.2.1.1.1.1.1.1.1.1.1.m1.2.2.2.4"><ci id="S1.F1.pic1.23.23.23.23.23.23.23.23.23.23.23.23.23.2.1.1.1.1.1.1.1.1.1.m1.1.1.1.1a.cmml" xref="S1.F1.pic1.23.23.23.23.23.23.23.23.23.23.23.23.23.2.1.1.1.1.1.1.1.1.1.m1.1.1.1.1"><mtext id="S1.F1.pic1.23.23.23.23.23.23.23.23.23.23.23.23.23.2.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.cmml" mathsize="70%" xref="S1.F1.pic1.23.23.23.23.23.23.23.23.23.23.23.23.23.2.1.1.1.1.1.1.1.1.1.m1.1.1.1.1">K</mtext></ci><ci id="S1.F1.pic1.23.23.23.23.23.23.23.23.23.23.23.23.23.2.1.1.1.1.1.1.1.1.1.m1.2.2.2.2.cmml" xref="S1.F1.pic1.23.23.23.23.23.23.23.23.23.23.23.23.23.2.1.1.1.1.1.1.1.1.1.m1.2.2.2.2">𝒢</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.pic1.23.23.23.23.23.23.23.23.23.23.23.23.23.2.1.1.1.1.1.1.1.1.1.m1.2c">\widehat{\Phi}_{\textrm{K},\mathcal{G}}</annotation><annotation encoding="application/x-llamapun" id="S1.F1.pic1.23.23.23.23.23.23.23.23.23.23.23.23.23.2.1.1.1.1.1.1.1.1.1.m1.2d">over^ start_ARG roman_Φ end_ARG start_POSTSUBSCRIPT K , caligraphic_G end_POSTSUBSCRIPT</annotation></semantics></math></foreignObject></g><g stroke-width="0.5pt"><path d="M 183.07 -177.17 M 183.07 -177.17 L 183.07 -133.86 L 204.72 -133.86 L 204.72 -177.17 Z M 204.72 -133.86" style="fill:none"></path></g><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 188.71 -160.24)"><foreignObject height="9.46" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="10.38"><span class="ltx_text" id="S1.F1.pic1.37.37.37.37.1.1">V</span></foreignObject></g><g stroke-width="0.56906pt"><path d="M 133.86 -127.95 C 127.95 -137.8 127.95 -177.17 133.86 -187.01" style="fill:none"></path></g><g stroke-width="0.56906pt"><path d="M 206.69 -127.95 C 212.6 -137.8 212.6 -177.17 206.69 -187.01" style="fill:none"></path></g><g color="#808080" fill="#808080" stroke="#808080" transform="matrix(0.6 0.0 0.0 0.6 83.81 -158.35)"><foreignObject height="9.46" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="12.63"><math alttext="N" class="ltx_Math" display="inline" id="S1.F1.pic1.24.24.24.24.24.24.24.24.24.24.24.24.24.3.1.1.1.1.1.1.1.1.1.1.1.m1.1"><semantics id="S1.F1.pic1.24.24.24.24.24.24.24.24.24.24.24.24.24.3.1.1.1.1.1.1.1.1.1.1.1.m1.1a"><mi id="S1.F1.pic1.24.24.24.24.24.24.24.24.24.24.24.24.24.3.1.1.1.1.1.1.1.1.1.1.1.m1.1.1" xref="S1.F1.pic1.24.24.24.24.24.24.24.24.24.24.24.24.24.3.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S1.F1.pic1.24.24.24.24.24.24.24.24.24.24.24.24.24.3.1.1.1.1.1.1.1.1.1.1.1.m1.1b"><ci id="S1.F1.pic1.24.24.24.24.24.24.24.24.24.24.24.24.24.3.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S1.F1.pic1.24.24.24.24.24.24.24.24.24.24.24.24.24.3.1.1.1.1.1.1.1.1.1.1.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.pic1.24.24.24.24.24.24.24.24.24.24.24.24.24.3.1.1.1.1.1.1.1.1.1.1.1.m1.1c">N</annotation><annotation encoding="application/x-llamapun" id="S1.F1.pic1.24.24.24.24.24.24.24.24.24.24.24.24.24.3.1.1.1.1.1.1.1.1.1.1.1.m1.1d">italic_N</annotation></semantics></math></foreignObject></g><g color="#808080" fill="#808080" stroke="#808080" transform="matrix(0.6 0.0 0.0 0.6 95.06 -130.03)"><foreignObject height="9.46" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="29.39"><math alttext="Nm" class="ltx_Math" display="inline" id="S1.F1.pic1.25.25.25.25.25.25.25.25.25.25.25.25.25.4.1.1.1.1.1.1.1.1.1.1.1.m1.1"><semantics id="S1.F1.pic1.25.25.25.25.25.25.25.25.25.25.25.25.25.4.1.1.1.1.1.1.1.1.1.1.1.m1.1a"><mrow id="S1.F1.pic1.25.25.25.25.25.25.25.25.25.25.25.25.25.4.1.1.1.1.1.1.1.1.1.1.1.m1.1.1" xref="S1.F1.pic1.25.25.25.25.25.25.25.25.25.25.25.25.25.4.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml"><mi id="S1.F1.pic1.25.25.25.25.25.25.25.25.25.25.25.25.25.4.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2" xref="S1.F1.pic1.25.25.25.25.25.25.25.25.25.25.25.25.25.4.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.cmml">N</mi><mo id="S1.F1.pic1.25.25.25.25.25.25.25.25.25.25.25.25.25.4.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.1" xref="S1.F1.pic1.25.25.25.25.25.25.25.25.25.25.25.25.25.4.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.cmml">⁢</mo><mi id="S1.F1.pic1.25.25.25.25.25.25.25.25.25.25.25.25.25.4.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3" xref="S1.F1.pic1.25.25.25.25.25.25.25.25.25.25.25.25.25.4.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3.cmml">m</mi></mrow><annotation-xml encoding="MathML-Content" id="S1.F1.pic1.25.25.25.25.25.25.25.25.25.25.25.25.25.4.1.1.1.1.1.1.1.1.1.1.1.m1.1b"><apply id="S1.F1.pic1.25.25.25.25.25.25.25.25.25.25.25.25.25.4.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S1.F1.pic1.25.25.25.25.25.25.25.25.25.25.25.25.25.4.1.1.1.1.1.1.1.1.1.1.1.m1.1.1"><times id="S1.F1.pic1.25.25.25.25.25.25.25.25.25.25.25.25.25.4.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.cmml" xref="S1.F1.pic1.25.25.25.25.25.25.25.25.25.25.25.25.25.4.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.1"></times><ci id="S1.F1.pic1.25.25.25.25.25.25.25.25.25.25.25.25.25.4.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.cmml" xref="S1.F1.pic1.25.25.25.25.25.25.25.25.25.25.25.25.25.4.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2">𝑁</ci><ci id="S1.F1.pic1.25.25.25.25.25.25.25.25.25.25.25.25.25.4.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3.cmml" xref="S1.F1.pic1.25.25.25.25.25.25.25.25.25.25.25.25.25.4.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.pic1.25.25.25.25.25.25.25.25.25.25.25.25.25.4.1.1.1.1.1.1.1.1.1.1.1.m1.1c">Nm</annotation><annotation encoding="application/x-llamapun" id="S1.F1.pic1.25.25.25.25.25.25.25.25.25.25.25.25.25.4.1.1.1.1.1.1.1.1.1.1.1.m1.1d">italic_N italic_m</annotation></semantics></math><span class="ltx_text" id="S1.F1.pic1.38.38.38.38.2.1"> (sp.)</span></foreignObject></g><g color="#808080" fill="#808080" stroke="#808080" transform="matrix(0.6 0.0 0.0 0.6 190.75 -130.84)"><foreignObject height="9.61" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="7.2"><math alttext="d" class="ltx_Math" display="inline" id="S1.F1.pic1.26.26.26.26.26.26.26.26.26.26.26.26.26.5.1.1.1.1.1.1.1.1.1.1.1.m1.1"><semantics id="S1.F1.pic1.26.26.26.26.26.26.26.26.26.26.26.26.26.5.1.1.1.1.1.1.1.1.1.1.1.m1.1a"><mi id="S1.F1.pic1.26.26.26.26.26.26.26.26.26.26.26.26.26.5.1.1.1.1.1.1.1.1.1.1.1.m1.1.1" xref="S1.F1.pic1.26.26.26.26.26.26.26.26.26.26.26.26.26.5.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S1.F1.pic1.26.26.26.26.26.26.26.26.26.26.26.26.26.5.1.1.1.1.1.1.1.1.1.1.1.m1.1b"><ci id="S1.F1.pic1.26.26.26.26.26.26.26.26.26.26.26.26.26.5.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S1.F1.pic1.26.26.26.26.26.26.26.26.26.26.26.26.26.5.1.1.1.1.1.1.1.1.1.1.1.m1.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.pic1.26.26.26.26.26.26.26.26.26.26.26.26.26.5.1.1.1.1.1.1.1.1.1.1.1.m1.1c">d</annotation><annotation encoding="application/x-llamapun" id="S1.F1.pic1.26.26.26.26.26.26.26.26.26.26.26.26.26.5.1.1.1.1.1.1.1.1.1.1.1.m1.1d">italic_d</annotation></semantics></math></foreignObject></g><g color="#808080" fill="#808080" stroke="#808080" transform="matrix(0.6 0.0 0.0 0.6 151.72 -130.79)"><foreignObject height="9.46" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="12.63"><math alttext="N" class="ltx_Math" display="inline" id="S1.F1.pic1.27.27.27.27.27.27.27.27.27.27.27.27.27.6.1.1.1.1.1.1.1.1.1.1.1.m1.1"><semantics id="S1.F1.pic1.27.27.27.27.27.27.27.27.27.27.27.27.27.6.1.1.1.1.1.1.1.1.1.1.1.m1.1a"><mi id="S1.F1.pic1.27.27.27.27.27.27.27.27.27.27.27.27.27.6.1.1.1.1.1.1.1.1.1.1.1.m1.1.1" xref="S1.F1.pic1.27.27.27.27.27.27.27.27.27.27.27.27.27.6.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S1.F1.pic1.27.27.27.27.27.27.27.27.27.27.27.27.27.6.1.1.1.1.1.1.1.1.1.1.1.m1.1b"><ci id="S1.F1.pic1.27.27.27.27.27.27.27.27.27.27.27.27.27.6.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S1.F1.pic1.27.27.27.27.27.27.27.27.27.27.27.27.27.6.1.1.1.1.1.1.1.1.1.1.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.pic1.27.27.27.27.27.27.27.27.27.27.27.27.27.6.1.1.1.1.1.1.1.1.1.1.1.m1.1c">N</annotation><annotation encoding="application/x-llamapun" id="S1.F1.pic1.27.27.27.27.27.27.27.27.27.27.27.27.27.6.1.1.1.1.1.1.1.1.1.1.1.m1.1d">italic_N</annotation></semantics></math></foreignObject></g></g><g color="#0000FF" fill="#0000FF" stroke="#0000FF" stroke-dasharray="3.0pt,3.0pt" stroke-dashoffset="0.0pt" stroke-width="0.56906pt"><path d="M 78.74 -192.91 M 78.74 -192.91 L 78.74 -114.17 L 218.5 -114.17 L 218.5 -192.91 Z M 218.5 -114.17" style="fill:none"></path></g></g></svg><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Schematic overview.
Regular attention is <math alttext="\mathcal{O}(N^{2})" class="ltx_Math" display="inline" id="S1.F1.9.m1.1"><semantics id="S1.F1.9.m1.1b"><mrow id="S1.F1.9.m1.1.1" xref="S1.F1.9.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S1.F1.9.m1.1.1.3" xref="S1.F1.9.m1.1.1.3.cmml">𝒪</mi><mo id="S1.F1.9.m1.1.1.2" xref="S1.F1.9.m1.1.1.2.cmml">⁢</mo><mrow id="S1.F1.9.m1.1.1.1.1" xref="S1.F1.9.m1.1.1.1.1.1.cmml"><mo id="S1.F1.9.m1.1.1.1.1.2" stretchy="false" xref="S1.F1.9.m1.1.1.1.1.1.cmml">(</mo><msup id="S1.F1.9.m1.1.1.1.1.1" xref="S1.F1.9.m1.1.1.1.1.1.cmml"><mi id="S1.F1.9.m1.1.1.1.1.1.2" xref="S1.F1.9.m1.1.1.1.1.1.2.cmml">N</mi><mn id="S1.F1.9.m1.1.1.1.1.1.3" xref="S1.F1.9.m1.1.1.1.1.1.3.cmml">2</mn></msup><mo id="S1.F1.9.m1.1.1.1.1.3" stretchy="false" xref="S1.F1.9.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.F1.9.m1.1c"><apply id="S1.F1.9.m1.1.1.cmml" xref="S1.F1.9.m1.1.1"><times id="S1.F1.9.m1.1.1.2.cmml" xref="S1.F1.9.m1.1.1.2"></times><ci id="S1.F1.9.m1.1.1.3.cmml" xref="S1.F1.9.m1.1.1.3">𝒪</ci><apply id="S1.F1.9.m1.1.1.1.1.1.cmml" xref="S1.F1.9.m1.1.1.1.1"><csymbol cd="ambiguous" id="S1.F1.9.m1.1.1.1.1.1.1.cmml" xref="S1.F1.9.m1.1.1.1.1">superscript</csymbol><ci id="S1.F1.9.m1.1.1.1.1.1.2.cmml" xref="S1.F1.9.m1.1.1.1.1.1.2">𝑁</ci><cn id="S1.F1.9.m1.1.1.1.1.1.3.cmml" type="integer" xref="S1.F1.9.m1.1.1.1.1.1.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.9.m1.1d">\mathcal{O}(N^{2})</annotation><annotation encoding="application/x-llamapun" id="S1.F1.9.m1.1e">caligraphic_O ( italic_N start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT )</annotation></semantics></math>, with <math alttext="N" class="ltx_Math" display="inline" id="S1.F1.10.m2.1"><semantics id="S1.F1.10.m2.1b"><mi id="S1.F1.10.m2.1.1" xref="S1.F1.10.m2.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S1.F1.10.m2.1c"><ci id="S1.F1.10.m2.1.1.cmml" xref="S1.F1.10.m2.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.10.m2.1d">N</annotation><annotation encoding="application/x-llamapun" id="S1.F1.10.m2.1e">italic_N</annotation></semantics></math> the number of input tokens. Topological masking modulates <math alttext="\mathbf{A}" class="ltx_Math" display="inline" id="S1.F1.11.m3.1"><semantics id="S1.F1.11.m3.1b"><mi id="S1.F1.11.m3.1.1" xref="S1.F1.11.m3.1.1.cmml">𝐀</mi><annotation-xml encoding="MathML-Content" id="S1.F1.11.m3.1c"><ci id="S1.F1.11.m3.1.1.cmml" xref="S1.F1.11.m3.1.1">𝐀</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.11.m3.1d">\mathbf{A}</annotation><annotation encoding="application/x-llamapun" id="S1.F1.11.m3.1e">bold_A</annotation></semantics></math> by a graph function <math alttext="\mathbf{M}(\mathcal{G})" class="ltx_Math" display="inline" id="S1.F1.12.m4.1"><semantics id="S1.F1.12.m4.1b"><mrow id="S1.F1.12.m4.1.2" xref="S1.F1.12.m4.1.2.cmml"><mi id="S1.F1.12.m4.1.2.2" xref="S1.F1.12.m4.1.2.2.cmml">𝐌</mi><mo id="S1.F1.12.m4.1.2.1" xref="S1.F1.12.m4.1.2.1.cmml">⁢</mo><mrow id="S1.F1.12.m4.1.2.3.2" xref="S1.F1.12.m4.1.2.cmml"><mo id="S1.F1.12.m4.1.2.3.2.1" stretchy="false" xref="S1.F1.12.m4.1.2.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S1.F1.12.m4.1.1" xref="S1.F1.12.m4.1.1.cmml">𝒢</mi><mo id="S1.F1.12.m4.1.2.3.2.2" stretchy="false" xref="S1.F1.12.m4.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.F1.12.m4.1c"><apply id="S1.F1.12.m4.1.2.cmml" xref="S1.F1.12.m4.1.2"><times id="S1.F1.12.m4.1.2.1.cmml" xref="S1.F1.12.m4.1.2.1"></times><ci id="S1.F1.12.m4.1.2.2.cmml" xref="S1.F1.12.m4.1.2.2">𝐌</ci><ci id="S1.F1.12.m4.1.1.cmml" xref="S1.F1.12.m4.1.1">𝒢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.12.m4.1d">\mathbf{M}(\mathcal{G})</annotation><annotation encoding="application/x-llamapun" id="S1.F1.12.m4.1e">bold_M ( caligraphic_G )</annotation></semantics></math>, improving predictive performance.
Linear attention reduces the time complexity to <math alttext="\mathcal{O}(N)" class="ltx_Math" display="inline" id="S1.F1.13.m5.1"><semantics id="S1.F1.13.m5.1b"><mrow id="S1.F1.13.m5.1.2" xref="S1.F1.13.m5.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S1.F1.13.m5.1.2.2" xref="S1.F1.13.m5.1.2.2.cmml">𝒪</mi><mo id="S1.F1.13.m5.1.2.1" xref="S1.F1.13.m5.1.2.1.cmml">⁢</mo><mrow id="S1.F1.13.m5.1.2.3.2" xref="S1.F1.13.m5.1.2.cmml"><mo id="S1.F1.13.m5.1.2.3.2.1" stretchy="false" xref="S1.F1.13.m5.1.2.cmml">(</mo><mi id="S1.F1.13.m5.1.1" xref="S1.F1.13.m5.1.1.cmml">N</mi><mo id="S1.F1.13.m5.1.2.3.2.2" stretchy="false" xref="S1.F1.13.m5.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.F1.13.m5.1c"><apply id="S1.F1.13.m5.1.2.cmml" xref="S1.F1.13.m5.1.2"><times id="S1.F1.13.m5.1.2.1.cmml" xref="S1.F1.13.m5.1.2.1"></times><ci id="S1.F1.13.m5.1.2.2.cmml" xref="S1.F1.13.m5.1.2.2">𝒪</ci><ci id="S1.F1.13.m5.1.1.cmml" xref="S1.F1.13.m5.1.1">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.13.m5.1d">\mathcal{O}(N)</annotation><annotation encoding="application/x-llamapun" id="S1.F1.13.m5.1e">caligraphic_O ( italic_N )</annotation></semantics></math> by leveraging a low-rank decomposition.
Our contribution (<span class="ltx_text" id="S1.F1.19.1" style="color:#0000FF;">blue</span>) is <em class="ltx_emph ltx_font_italic" id="S1.F1.20.2">the first algorithm to achieve both</em> – <math alttext="\mathcal{O}(N)" class="ltx_Math" display="inline" id="S1.F1.14.m6.1"><semantics id="S1.F1.14.m6.1b"><mrow id="S1.F1.14.m6.1.2" xref="S1.F1.14.m6.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S1.F1.14.m6.1.2.2" xref="S1.F1.14.m6.1.2.2.cmml">𝒪</mi><mo id="S1.F1.14.m6.1.2.1" xref="S1.F1.14.m6.1.2.1.cmml">⁢</mo><mrow id="S1.F1.14.m6.1.2.3.2" xref="S1.F1.14.m6.1.2.cmml"><mo id="S1.F1.14.m6.1.2.3.2.1" stretchy="false" xref="S1.F1.14.m6.1.2.cmml">(</mo><mi id="S1.F1.14.m6.1.1" xref="S1.F1.14.m6.1.1.cmml">N</mi><mo id="S1.F1.14.m6.1.2.3.2.2" stretchy="false" xref="S1.F1.14.m6.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.F1.14.m6.1c"><apply id="S1.F1.14.m6.1.2.cmml" xref="S1.F1.14.m6.1.2"><times id="S1.F1.14.m6.1.2.1.cmml" xref="S1.F1.14.m6.1.2.1"></times><ci id="S1.F1.14.m6.1.2.2.cmml" xref="S1.F1.14.m6.1.2.2">𝒪</ci><ci id="S1.F1.14.m6.1.1.cmml" xref="S1.F1.14.m6.1.1">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.14.m6.1d">\mathcal{O}(N)</annotation><annotation encoding="application/x-llamapun" id="S1.F1.14.m6.1e">caligraphic_O ( italic_N )</annotation></semantics></math> topological masking of low-rank attention – by approximating <math alttext="\mathbf{M}(\mathcal{G})" class="ltx_Math" display="inline" id="S1.F1.15.m7.1"><semantics id="S1.F1.15.m7.1b"><mrow id="S1.F1.15.m7.1.2" xref="S1.F1.15.m7.1.2.cmml"><mi id="S1.F1.15.m7.1.2.2" xref="S1.F1.15.m7.1.2.2.cmml">𝐌</mi><mo id="S1.F1.15.m7.1.2.1" xref="S1.F1.15.m7.1.2.1.cmml">⁢</mo><mrow id="S1.F1.15.m7.1.2.3.2" xref="S1.F1.15.m7.1.2.cmml"><mo id="S1.F1.15.m7.1.2.3.2.1" stretchy="false" xref="S1.F1.15.m7.1.2.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S1.F1.15.m7.1.1" xref="S1.F1.15.m7.1.1.cmml">𝒢</mi><mo id="S1.F1.15.m7.1.2.3.2.2" stretchy="false" xref="S1.F1.15.m7.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.F1.15.m7.1c"><apply id="S1.F1.15.m7.1.2.cmml" xref="S1.F1.15.m7.1.2"><times id="S1.F1.15.m7.1.2.1.cmml" xref="S1.F1.15.m7.1.2.1"></times><ci id="S1.F1.15.m7.1.2.2.cmml" xref="S1.F1.15.m7.1.2.2">𝐌</ci><ci id="S1.F1.15.m7.1.1.cmml" xref="S1.F1.15.m7.1.1">𝒢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.15.m7.1d">\mathbf{M}(\mathcal{G})</annotation><annotation encoding="application/x-llamapun" id="S1.F1.15.m7.1e">bold_M ( caligraphic_G )</annotation></semantics></math> with graph random features (GRFs).
GRFs are sparse vectors (denoted ‘sp.’) computed by sampling random walks, constructed so that <math alttext="\mathbb{E}(\widehat{\mathbf{\Phi}}_{\mathbf{Q},\mathcal{G}}\widehat{\mathbf{%
\Phi}}_{\mathbf{K},\mathcal{G}}^{\top})=\mathbf{A}\odot\mathbf{M}(\mathcal{G})" class="ltx_Math" display="inline" id="S1.F1.16.m8.6"><semantics id="S1.F1.16.m8.6b"><mrow id="S1.F1.16.m8.6.6" xref="S1.F1.16.m8.6.6.cmml"><mrow id="S1.F1.16.m8.6.6.1" xref="S1.F1.16.m8.6.6.1.cmml"><mi id="S1.F1.16.m8.6.6.1.3" xref="S1.F1.16.m8.6.6.1.3.cmml">𝔼</mi><mo id="S1.F1.16.m8.6.6.1.2" xref="S1.F1.16.m8.6.6.1.2.cmml">⁢</mo><mrow id="S1.F1.16.m8.6.6.1.1.1" xref="S1.F1.16.m8.6.6.1.1.1.1.cmml"><mo id="S1.F1.16.m8.6.6.1.1.1.2" stretchy="false" xref="S1.F1.16.m8.6.6.1.1.1.1.cmml">(</mo><mrow id="S1.F1.16.m8.6.6.1.1.1.1" xref="S1.F1.16.m8.6.6.1.1.1.1.cmml"><msub id="S1.F1.16.m8.6.6.1.1.1.1.2" xref="S1.F1.16.m8.6.6.1.1.1.1.2.cmml"><mover accent="true" id="S1.F1.16.m8.6.6.1.1.1.1.2.2" xref="S1.F1.16.m8.6.6.1.1.1.1.2.2.cmml"><mi id="S1.F1.16.m8.6.6.1.1.1.1.2.2.2" xref="S1.F1.16.m8.6.6.1.1.1.1.2.2.2.cmml">𝚽</mi><mo id="S1.F1.16.m8.6.6.1.1.1.1.2.2.1" xref="S1.F1.16.m8.6.6.1.1.1.1.2.2.1.cmml">^</mo></mover><mrow id="S1.F1.16.m8.2.2.2.4" xref="S1.F1.16.m8.2.2.2.3.cmml"><mi id="S1.F1.16.m8.1.1.1.1" xref="S1.F1.16.m8.1.1.1.1.cmml">𝐐</mi><mo id="S1.F1.16.m8.2.2.2.4.1" xref="S1.F1.16.m8.2.2.2.3.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S1.F1.16.m8.2.2.2.2" xref="S1.F1.16.m8.2.2.2.2.cmml">𝒢</mi></mrow></msub><mo id="S1.F1.16.m8.6.6.1.1.1.1.1" xref="S1.F1.16.m8.6.6.1.1.1.1.1.cmml">⁢</mo><msubsup id="S1.F1.16.m8.6.6.1.1.1.1.3" xref="S1.F1.16.m8.6.6.1.1.1.1.3.cmml"><mover accent="true" id="S1.F1.16.m8.6.6.1.1.1.1.3.2.2" xref="S1.F1.16.m8.6.6.1.1.1.1.3.2.2.cmml"><mi id="S1.F1.16.m8.6.6.1.1.1.1.3.2.2.2" xref="S1.F1.16.m8.6.6.1.1.1.1.3.2.2.2.cmml">𝚽</mi><mo id="S1.F1.16.m8.6.6.1.1.1.1.3.2.2.1" xref="S1.F1.16.m8.6.6.1.1.1.1.3.2.2.1.cmml">^</mo></mover><mrow id="S1.F1.16.m8.4.4.2.4" xref="S1.F1.16.m8.4.4.2.3.cmml"><mi id="S1.F1.16.m8.3.3.1.1" xref="S1.F1.16.m8.3.3.1.1.cmml">𝐊</mi><mo id="S1.F1.16.m8.4.4.2.4.1" xref="S1.F1.16.m8.4.4.2.3.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S1.F1.16.m8.4.4.2.2" xref="S1.F1.16.m8.4.4.2.2.cmml">𝒢</mi></mrow><mo id="S1.F1.16.m8.6.6.1.1.1.1.3.3" xref="S1.F1.16.m8.6.6.1.1.1.1.3.3.cmml">⊤</mo></msubsup></mrow><mo id="S1.F1.16.m8.6.6.1.1.1.3" stretchy="false" xref="S1.F1.16.m8.6.6.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S1.F1.16.m8.6.6.2" xref="S1.F1.16.m8.6.6.2.cmml">=</mo><mrow id="S1.F1.16.m8.6.6.3" xref="S1.F1.16.m8.6.6.3.cmml"><mrow id="S1.F1.16.m8.6.6.3.2" xref="S1.F1.16.m8.6.6.3.2.cmml"><mi id="S1.F1.16.m8.6.6.3.2.2" xref="S1.F1.16.m8.6.6.3.2.2.cmml">𝐀</mi><mo id="S1.F1.16.m8.6.6.3.2.1" lspace="0.222em" rspace="0.222em" xref="S1.F1.16.m8.6.6.3.2.1.cmml">⊙</mo><mi id="S1.F1.16.m8.6.6.3.2.3" xref="S1.F1.16.m8.6.6.3.2.3.cmml">𝐌</mi></mrow><mo id="S1.F1.16.m8.6.6.3.1" xref="S1.F1.16.m8.6.6.3.1.cmml">⁢</mo><mrow id="S1.F1.16.m8.6.6.3.3.2" xref="S1.F1.16.m8.6.6.3.cmml"><mo id="S1.F1.16.m8.6.6.3.3.2.1" stretchy="false" xref="S1.F1.16.m8.6.6.3.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S1.F1.16.m8.5.5" xref="S1.F1.16.m8.5.5.cmml">𝒢</mi><mo id="S1.F1.16.m8.6.6.3.3.2.2" stretchy="false" xref="S1.F1.16.m8.6.6.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.F1.16.m8.6c"><apply id="S1.F1.16.m8.6.6.cmml" xref="S1.F1.16.m8.6.6"><eq id="S1.F1.16.m8.6.6.2.cmml" xref="S1.F1.16.m8.6.6.2"></eq><apply id="S1.F1.16.m8.6.6.1.cmml" xref="S1.F1.16.m8.6.6.1"><times id="S1.F1.16.m8.6.6.1.2.cmml" xref="S1.F1.16.m8.6.6.1.2"></times><ci id="S1.F1.16.m8.6.6.1.3.cmml" xref="S1.F1.16.m8.6.6.1.3">𝔼</ci><apply id="S1.F1.16.m8.6.6.1.1.1.1.cmml" xref="S1.F1.16.m8.6.6.1.1.1"><times id="S1.F1.16.m8.6.6.1.1.1.1.1.cmml" xref="S1.F1.16.m8.6.6.1.1.1.1.1"></times><apply id="S1.F1.16.m8.6.6.1.1.1.1.2.cmml" xref="S1.F1.16.m8.6.6.1.1.1.1.2"><csymbol cd="ambiguous" id="S1.F1.16.m8.6.6.1.1.1.1.2.1.cmml" xref="S1.F1.16.m8.6.6.1.1.1.1.2">subscript</csymbol><apply id="S1.F1.16.m8.6.6.1.1.1.1.2.2.cmml" xref="S1.F1.16.m8.6.6.1.1.1.1.2.2"><ci id="S1.F1.16.m8.6.6.1.1.1.1.2.2.1.cmml" xref="S1.F1.16.m8.6.6.1.1.1.1.2.2.1">^</ci><ci id="S1.F1.16.m8.6.6.1.1.1.1.2.2.2.cmml" xref="S1.F1.16.m8.6.6.1.1.1.1.2.2.2">𝚽</ci></apply><list id="S1.F1.16.m8.2.2.2.3.cmml" xref="S1.F1.16.m8.2.2.2.4"><ci id="S1.F1.16.m8.1.1.1.1.cmml" xref="S1.F1.16.m8.1.1.1.1">𝐐</ci><ci id="S1.F1.16.m8.2.2.2.2.cmml" xref="S1.F1.16.m8.2.2.2.2">𝒢</ci></list></apply><apply id="S1.F1.16.m8.6.6.1.1.1.1.3.cmml" xref="S1.F1.16.m8.6.6.1.1.1.1.3"><csymbol cd="ambiguous" id="S1.F1.16.m8.6.6.1.1.1.1.3.1.cmml" xref="S1.F1.16.m8.6.6.1.1.1.1.3">superscript</csymbol><apply id="S1.F1.16.m8.6.6.1.1.1.1.3.2.cmml" xref="S1.F1.16.m8.6.6.1.1.1.1.3"><csymbol cd="ambiguous" id="S1.F1.16.m8.6.6.1.1.1.1.3.2.1.cmml" xref="S1.F1.16.m8.6.6.1.1.1.1.3">subscript</csymbol><apply id="S1.F1.16.m8.6.6.1.1.1.1.3.2.2.cmml" xref="S1.F1.16.m8.6.6.1.1.1.1.3.2.2"><ci id="S1.F1.16.m8.6.6.1.1.1.1.3.2.2.1.cmml" xref="S1.F1.16.m8.6.6.1.1.1.1.3.2.2.1">^</ci><ci id="S1.F1.16.m8.6.6.1.1.1.1.3.2.2.2.cmml" xref="S1.F1.16.m8.6.6.1.1.1.1.3.2.2.2">𝚽</ci></apply><list id="S1.F1.16.m8.4.4.2.3.cmml" xref="S1.F1.16.m8.4.4.2.4"><ci id="S1.F1.16.m8.3.3.1.1.cmml" xref="S1.F1.16.m8.3.3.1.1">𝐊</ci><ci id="S1.F1.16.m8.4.4.2.2.cmml" xref="S1.F1.16.m8.4.4.2.2">𝒢</ci></list></apply><csymbol cd="latexml" id="S1.F1.16.m8.6.6.1.1.1.1.3.3.cmml" xref="S1.F1.16.m8.6.6.1.1.1.1.3.3">top</csymbol></apply></apply></apply><apply id="S1.F1.16.m8.6.6.3.cmml" xref="S1.F1.16.m8.6.6.3"><times id="S1.F1.16.m8.6.6.3.1.cmml" xref="S1.F1.16.m8.6.6.3.1"></times><apply id="S1.F1.16.m8.6.6.3.2.cmml" xref="S1.F1.16.m8.6.6.3.2"><csymbol cd="latexml" id="S1.F1.16.m8.6.6.3.2.1.cmml" xref="S1.F1.16.m8.6.6.3.2.1">direct-product</csymbol><ci id="S1.F1.16.m8.6.6.3.2.2.cmml" xref="S1.F1.16.m8.6.6.3.2.2">𝐀</ci><ci id="S1.F1.16.m8.6.6.3.2.3.cmml" xref="S1.F1.16.m8.6.6.3.2.3">𝐌</ci></apply><ci id="S1.F1.16.m8.5.5.cmml" xref="S1.F1.16.m8.5.5">𝒢</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.16.m8.6d">\mathbb{E}(\widehat{\mathbf{\Phi}}_{\mathbf{Q},\mathcal{G}}\widehat{\mathbf{%
\Phi}}_{\mathbf{K},\mathcal{G}}^{\top})=\mathbf{A}\odot\mathbf{M}(\mathcal{G})</annotation><annotation encoding="application/x-llamapun" id="S1.F1.16.m8.6e">blackboard_E ( over^ start_ARG bold_Φ end_ARG start_POSTSUBSCRIPT bold_Q , caligraphic_G end_POSTSUBSCRIPT over^ start_ARG bold_Φ end_ARG start_POSTSUBSCRIPT bold_K , caligraphic_G end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT ) = bold_A ⊙ bold_M ( caligraphic_G )</annotation></semantics></math> with strong concentration properties (Thm.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#S3.Thmtheorem1" title="Theorem 3.1 (GRF exponential concentration bounds). ‣ 3.4 Novel theoretical results for GRFs: sharp estimators with sparse features ‣ 3 Towards linear topological masking ‣ Linear Transformer Topological Masking with Graph Random Features"><span class="ltx_text ltx_ref_tag">3.1</span></a>).</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Preliminaries</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S2.p1">
<p class="ltx_p" id="S2.p1.6"><span class="ltx_text ltx_font_bold" id="S2.p1.6.1">Masked attention.</span>
Denote by <math alttext="N" class="ltx_Math" display="inline" id="S2.p1.1.m1.1"><semantics id="S2.p1.1.m1.1a"><mi id="S2.p1.1.m1.1.1" xref="S2.p1.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S2.p1.1.m1.1b"><ci id="S2.p1.1.m1.1.1.cmml" xref="S2.p1.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.1.m1.1c">N</annotation><annotation encoding="application/x-llamapun" id="S2.p1.1.m1.1d">italic_N</annotation></semantics></math> the number of input tokens and <math alttext="d" class="ltx_Math" display="inline" id="S2.p1.2.m2.1"><semantics id="S2.p1.2.m2.1a"><mi id="S2.p1.2.m2.1.1" xref="S2.p1.2.m2.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S2.p1.2.m2.1b"><ci id="S2.p1.2.m2.1.1.cmml" xref="S2.p1.2.m2.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.2.m2.1c">d</annotation><annotation encoding="application/x-llamapun" id="S2.p1.2.m2.1d">italic_d</annotation></semantics></math> the dimensionality of their latent representations.
Consider matrices <math alttext="\mathbf{Q},\mathbf{K},\mathbf{V}\in\mathbb{R}^{N\times d}" class="ltx_Math" display="inline" id="S2.p1.3.m3.3"><semantics id="S2.p1.3.m3.3a"><mrow id="S2.p1.3.m3.3.4" xref="S2.p1.3.m3.3.4.cmml"><mrow id="S2.p1.3.m3.3.4.2.2" xref="S2.p1.3.m3.3.4.2.1.cmml"><mi id="S2.p1.3.m3.1.1" xref="S2.p1.3.m3.1.1.cmml">𝐐</mi><mo id="S2.p1.3.m3.3.4.2.2.1" xref="S2.p1.3.m3.3.4.2.1.cmml">,</mo><mi id="S2.p1.3.m3.2.2" xref="S2.p1.3.m3.2.2.cmml">𝐊</mi><mo id="S2.p1.3.m3.3.4.2.2.2" xref="S2.p1.3.m3.3.4.2.1.cmml">,</mo><mi id="S2.p1.3.m3.3.3" xref="S2.p1.3.m3.3.3.cmml">𝐕</mi></mrow><mo id="S2.p1.3.m3.3.4.1" xref="S2.p1.3.m3.3.4.1.cmml">∈</mo><msup id="S2.p1.3.m3.3.4.3" xref="S2.p1.3.m3.3.4.3.cmml"><mi id="S2.p1.3.m3.3.4.3.2" xref="S2.p1.3.m3.3.4.3.2.cmml">ℝ</mi><mrow id="S2.p1.3.m3.3.4.3.3" xref="S2.p1.3.m3.3.4.3.3.cmml"><mi id="S2.p1.3.m3.3.4.3.3.2" xref="S2.p1.3.m3.3.4.3.3.2.cmml">N</mi><mo id="S2.p1.3.m3.3.4.3.3.1" lspace="0.222em" rspace="0.222em" xref="S2.p1.3.m3.3.4.3.3.1.cmml">×</mo><mi id="S2.p1.3.m3.3.4.3.3.3" xref="S2.p1.3.m3.3.4.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.3.m3.3b"><apply id="S2.p1.3.m3.3.4.cmml" xref="S2.p1.3.m3.3.4"><in id="S2.p1.3.m3.3.4.1.cmml" xref="S2.p1.3.m3.3.4.1"></in><list id="S2.p1.3.m3.3.4.2.1.cmml" xref="S2.p1.3.m3.3.4.2.2"><ci id="S2.p1.3.m3.1.1.cmml" xref="S2.p1.3.m3.1.1">𝐐</ci><ci id="S2.p1.3.m3.2.2.cmml" xref="S2.p1.3.m3.2.2">𝐊</ci><ci id="S2.p1.3.m3.3.3.cmml" xref="S2.p1.3.m3.3.3">𝐕</ci></list><apply id="S2.p1.3.m3.3.4.3.cmml" xref="S2.p1.3.m3.3.4.3"><csymbol cd="ambiguous" id="S2.p1.3.m3.3.4.3.1.cmml" xref="S2.p1.3.m3.3.4.3">superscript</csymbol><ci id="S2.p1.3.m3.3.4.3.2.cmml" xref="S2.p1.3.m3.3.4.3.2">ℝ</ci><apply id="S2.p1.3.m3.3.4.3.3.cmml" xref="S2.p1.3.m3.3.4.3.3"><times id="S2.p1.3.m3.3.4.3.3.1.cmml" xref="S2.p1.3.m3.3.4.3.3.1"></times><ci id="S2.p1.3.m3.3.4.3.3.2.cmml" xref="S2.p1.3.m3.3.4.3.3.2">𝑁</ci><ci id="S2.p1.3.m3.3.4.3.3.3.cmml" xref="S2.p1.3.m3.3.4.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.3.m3.3c">\mathbf{Q},\mathbf{K},\mathbf{V}\in\mathbb{R}^{N\times d}</annotation><annotation encoding="application/x-llamapun" id="S2.p1.3.m3.3d">bold_Q , bold_K , bold_V ∈ blackboard_R start_POSTSUPERSCRIPT italic_N × italic_d end_POSTSUPERSCRIPT</annotation></semantics></math> whose rows are given by the query (<math alttext="\{\bm{q}_{i}\}_{i=1}^{N}" class="ltx_Math" display="inline" id="S2.p1.4.m4.1"><semantics id="S2.p1.4.m4.1a"><msubsup id="S2.p1.4.m4.1.1" xref="S2.p1.4.m4.1.1.cmml"><mrow id="S2.p1.4.m4.1.1.1.1.1" xref="S2.p1.4.m4.1.1.1.1.2.cmml"><mo id="S2.p1.4.m4.1.1.1.1.1.2" stretchy="false" xref="S2.p1.4.m4.1.1.1.1.2.cmml">{</mo><msub id="S2.p1.4.m4.1.1.1.1.1.1" xref="S2.p1.4.m4.1.1.1.1.1.1.cmml"><mi id="S2.p1.4.m4.1.1.1.1.1.1.2" xref="S2.p1.4.m4.1.1.1.1.1.1.2.cmml">𝒒</mi><mi id="S2.p1.4.m4.1.1.1.1.1.1.3" xref="S2.p1.4.m4.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S2.p1.4.m4.1.1.1.1.1.3" stretchy="false" xref="S2.p1.4.m4.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S2.p1.4.m4.1.1.1.3" xref="S2.p1.4.m4.1.1.1.3.cmml"><mi id="S2.p1.4.m4.1.1.1.3.2" xref="S2.p1.4.m4.1.1.1.3.2.cmml">i</mi><mo id="S2.p1.4.m4.1.1.1.3.1" xref="S2.p1.4.m4.1.1.1.3.1.cmml">=</mo><mn id="S2.p1.4.m4.1.1.1.3.3" xref="S2.p1.4.m4.1.1.1.3.3.cmml">1</mn></mrow><mi id="S2.p1.4.m4.1.1.3" xref="S2.p1.4.m4.1.1.3.cmml">N</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.p1.4.m4.1b"><apply id="S2.p1.4.m4.1.1.cmml" xref="S2.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S2.p1.4.m4.1.1.2.cmml" xref="S2.p1.4.m4.1.1">superscript</csymbol><apply id="S2.p1.4.m4.1.1.1.cmml" xref="S2.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S2.p1.4.m4.1.1.1.2.cmml" xref="S2.p1.4.m4.1.1">subscript</csymbol><set id="S2.p1.4.m4.1.1.1.1.2.cmml" xref="S2.p1.4.m4.1.1.1.1.1"><apply id="S2.p1.4.m4.1.1.1.1.1.1.cmml" xref="S2.p1.4.m4.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.p1.4.m4.1.1.1.1.1.1.1.cmml" xref="S2.p1.4.m4.1.1.1.1.1.1">subscript</csymbol><ci id="S2.p1.4.m4.1.1.1.1.1.1.2.cmml" xref="S2.p1.4.m4.1.1.1.1.1.1.2">𝒒</ci><ci id="S2.p1.4.m4.1.1.1.1.1.1.3.cmml" xref="S2.p1.4.m4.1.1.1.1.1.1.3">𝑖</ci></apply></set><apply id="S2.p1.4.m4.1.1.1.3.cmml" xref="S2.p1.4.m4.1.1.1.3"><eq id="S2.p1.4.m4.1.1.1.3.1.cmml" xref="S2.p1.4.m4.1.1.1.3.1"></eq><ci id="S2.p1.4.m4.1.1.1.3.2.cmml" xref="S2.p1.4.m4.1.1.1.3.2">𝑖</ci><cn id="S2.p1.4.m4.1.1.1.3.3.cmml" type="integer" xref="S2.p1.4.m4.1.1.1.3.3">1</cn></apply></apply><ci id="S2.p1.4.m4.1.1.3.cmml" xref="S2.p1.4.m4.1.1.3">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.4.m4.1c">\{\bm{q}_{i}\}_{i=1}^{N}</annotation><annotation encoding="application/x-llamapun" id="S2.p1.4.m4.1d">{ bold_italic_q start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT } start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT</annotation></semantics></math>), key (<math alttext="\{\bm{k}_{i}\}_{i=1}^{N}" class="ltx_Math" display="inline" id="S2.p1.5.m5.1"><semantics id="S2.p1.5.m5.1a"><msubsup id="S2.p1.5.m5.1.1" xref="S2.p1.5.m5.1.1.cmml"><mrow id="S2.p1.5.m5.1.1.1.1.1" xref="S2.p1.5.m5.1.1.1.1.2.cmml"><mo id="S2.p1.5.m5.1.1.1.1.1.2" stretchy="false" xref="S2.p1.5.m5.1.1.1.1.2.cmml">{</mo><msub id="S2.p1.5.m5.1.1.1.1.1.1" xref="S2.p1.5.m5.1.1.1.1.1.1.cmml"><mi id="S2.p1.5.m5.1.1.1.1.1.1.2" xref="S2.p1.5.m5.1.1.1.1.1.1.2.cmml">𝒌</mi><mi id="S2.p1.5.m5.1.1.1.1.1.1.3" xref="S2.p1.5.m5.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S2.p1.5.m5.1.1.1.1.1.3" stretchy="false" xref="S2.p1.5.m5.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S2.p1.5.m5.1.1.1.3" xref="S2.p1.5.m5.1.1.1.3.cmml"><mi id="S2.p1.5.m5.1.1.1.3.2" xref="S2.p1.5.m5.1.1.1.3.2.cmml">i</mi><mo id="S2.p1.5.m5.1.1.1.3.1" xref="S2.p1.5.m5.1.1.1.3.1.cmml">=</mo><mn id="S2.p1.5.m5.1.1.1.3.3" xref="S2.p1.5.m5.1.1.1.3.3.cmml">1</mn></mrow><mi id="S2.p1.5.m5.1.1.3" xref="S2.p1.5.m5.1.1.3.cmml">N</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.p1.5.m5.1b"><apply id="S2.p1.5.m5.1.1.cmml" xref="S2.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S2.p1.5.m5.1.1.2.cmml" xref="S2.p1.5.m5.1.1">superscript</csymbol><apply id="S2.p1.5.m5.1.1.1.cmml" xref="S2.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S2.p1.5.m5.1.1.1.2.cmml" xref="S2.p1.5.m5.1.1">subscript</csymbol><set id="S2.p1.5.m5.1.1.1.1.2.cmml" xref="S2.p1.5.m5.1.1.1.1.1"><apply id="S2.p1.5.m5.1.1.1.1.1.1.cmml" xref="S2.p1.5.m5.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.p1.5.m5.1.1.1.1.1.1.1.cmml" xref="S2.p1.5.m5.1.1.1.1.1.1">subscript</csymbol><ci id="S2.p1.5.m5.1.1.1.1.1.1.2.cmml" xref="S2.p1.5.m5.1.1.1.1.1.1.2">𝒌</ci><ci id="S2.p1.5.m5.1.1.1.1.1.1.3.cmml" xref="S2.p1.5.m5.1.1.1.1.1.1.3">𝑖</ci></apply></set><apply id="S2.p1.5.m5.1.1.1.3.cmml" xref="S2.p1.5.m5.1.1.1.3"><eq id="S2.p1.5.m5.1.1.1.3.1.cmml" xref="S2.p1.5.m5.1.1.1.3.1"></eq><ci id="S2.p1.5.m5.1.1.1.3.2.cmml" xref="S2.p1.5.m5.1.1.1.3.2">𝑖</ci><cn id="S2.p1.5.m5.1.1.1.3.3.cmml" type="integer" xref="S2.p1.5.m5.1.1.1.3.3">1</cn></apply></apply><ci id="S2.p1.5.m5.1.1.3.cmml" xref="S2.p1.5.m5.1.1.3">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.5.m5.1c">\{\bm{k}_{i}\}_{i=1}^{N}</annotation><annotation encoding="application/x-llamapun" id="S2.p1.5.m5.1d">{ bold_italic_k start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT } start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT</annotation></semantics></math>) and value vectors (<math alttext="\{\bm{v}_{i}\}_{i=1}^{N}" class="ltx_Math" display="inline" id="S2.p1.6.m6.1"><semantics id="S2.p1.6.m6.1a"><msubsup id="S2.p1.6.m6.1.1" xref="S2.p1.6.m6.1.1.cmml"><mrow id="S2.p1.6.m6.1.1.1.1.1" xref="S2.p1.6.m6.1.1.1.1.2.cmml"><mo id="S2.p1.6.m6.1.1.1.1.1.2" stretchy="false" xref="S2.p1.6.m6.1.1.1.1.2.cmml">{</mo><msub id="S2.p1.6.m6.1.1.1.1.1.1" xref="S2.p1.6.m6.1.1.1.1.1.1.cmml"><mi id="S2.p1.6.m6.1.1.1.1.1.1.2" xref="S2.p1.6.m6.1.1.1.1.1.1.2.cmml">𝒗</mi><mi id="S2.p1.6.m6.1.1.1.1.1.1.3" xref="S2.p1.6.m6.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S2.p1.6.m6.1.1.1.1.1.3" stretchy="false" xref="S2.p1.6.m6.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S2.p1.6.m6.1.1.1.3" xref="S2.p1.6.m6.1.1.1.3.cmml"><mi id="S2.p1.6.m6.1.1.1.3.2" xref="S2.p1.6.m6.1.1.1.3.2.cmml">i</mi><mo id="S2.p1.6.m6.1.1.1.3.1" xref="S2.p1.6.m6.1.1.1.3.1.cmml">=</mo><mn id="S2.p1.6.m6.1.1.1.3.3" xref="S2.p1.6.m6.1.1.1.3.3.cmml">1</mn></mrow><mi id="S2.p1.6.m6.1.1.3" xref="S2.p1.6.m6.1.1.3.cmml">N</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.p1.6.m6.1b"><apply id="S2.p1.6.m6.1.1.cmml" xref="S2.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S2.p1.6.m6.1.1.2.cmml" xref="S2.p1.6.m6.1.1">superscript</csymbol><apply id="S2.p1.6.m6.1.1.1.cmml" xref="S2.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S2.p1.6.m6.1.1.1.2.cmml" xref="S2.p1.6.m6.1.1">subscript</csymbol><set id="S2.p1.6.m6.1.1.1.1.2.cmml" xref="S2.p1.6.m6.1.1.1.1.1"><apply id="S2.p1.6.m6.1.1.1.1.1.1.cmml" xref="S2.p1.6.m6.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.p1.6.m6.1.1.1.1.1.1.1.cmml" xref="S2.p1.6.m6.1.1.1.1.1.1">subscript</csymbol><ci id="S2.p1.6.m6.1.1.1.1.1.1.2.cmml" xref="S2.p1.6.m6.1.1.1.1.1.1.2">𝒗</ci><ci id="S2.p1.6.m6.1.1.1.1.1.1.3.cmml" xref="S2.p1.6.m6.1.1.1.1.1.1.3">𝑖</ci></apply></set><apply id="S2.p1.6.m6.1.1.1.3.cmml" xref="S2.p1.6.m6.1.1.1.3"><eq id="S2.p1.6.m6.1.1.1.3.1.cmml" xref="S2.p1.6.m6.1.1.1.3.1"></eq><ci id="S2.p1.6.m6.1.1.1.3.2.cmml" xref="S2.p1.6.m6.1.1.1.3.2">𝑖</ci><cn id="S2.p1.6.m6.1.1.1.3.3.cmml" type="integer" xref="S2.p1.6.m6.1.1.1.3.3">1</cn></apply></apply><ci id="S2.p1.6.m6.1.1.3.cmml" xref="S2.p1.6.m6.1.1.3">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.6.m6.1c">\{\bm{v}_{i}\}_{i=1}^{N}</annotation><annotation encoding="application/x-llamapun" id="S2.p1.6.m6.1d">{ bold_italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT } start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT</annotation></semantics></math>) respectively.
The <em class="ltx_emph ltx_font_italic" id="S2.p1.6.2">attention mechanism</em>, a basic processing unit of the transformer, can be written:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equation ltx_eqn_table" id="S2.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\textrm{Att}(\mathbf{Q},\mathbf{K},\mathbf{V})\coloneqq\mathbf{D}^{-1}\mathbf{%
A}\mathbf{V},\quad\mathbf{A}\coloneqq\mathcal{K}(\mathbf{Q},\mathbf{K}),\quad%
\mathbf{D}\coloneqq\mathbf{A}\mathbf{1}_{N}." class="ltx_Math" display="block" id="S2.E1.m1.6"><semantics id="S2.E1.m1.6a"><mrow id="S2.E1.m1.6.6.1"><mrow id="S2.E1.m1.6.6.1.1.2" xref="S2.E1.m1.6.6.1.1.3.cmml"><mrow id="S2.E1.m1.6.6.1.1.1.1" xref="S2.E1.m1.6.6.1.1.1.1.cmml"><mrow id="S2.E1.m1.6.6.1.1.1.1.2" xref="S2.E1.m1.6.6.1.1.1.1.2.cmml"><mtext id="S2.E1.m1.6.6.1.1.1.1.2.2" xref="S2.E1.m1.6.6.1.1.1.1.2.2a.cmml">Att</mtext><mo id="S2.E1.m1.6.6.1.1.1.1.2.1" xref="S2.E1.m1.6.6.1.1.1.1.2.1.cmml">⁢</mo><mrow id="S2.E1.m1.6.6.1.1.1.1.2.3.2" xref="S2.E1.m1.6.6.1.1.1.1.2.3.1.cmml"><mo id="S2.E1.m1.6.6.1.1.1.1.2.3.2.1" stretchy="false" xref="S2.E1.m1.6.6.1.1.1.1.2.3.1.cmml">(</mo><mi id="S2.E1.m1.1.1" xref="S2.E1.m1.1.1.cmml">𝐐</mi><mo id="S2.E1.m1.6.6.1.1.1.1.2.3.2.2" xref="S2.E1.m1.6.6.1.1.1.1.2.3.1.cmml">,</mo><mi id="S2.E1.m1.2.2" xref="S2.E1.m1.2.2.cmml">𝐊</mi><mo id="S2.E1.m1.6.6.1.1.1.1.2.3.2.3" xref="S2.E1.m1.6.6.1.1.1.1.2.3.1.cmml">,</mo><mi id="S2.E1.m1.3.3" xref="S2.E1.m1.3.3.cmml">𝐕</mi><mo id="S2.E1.m1.6.6.1.1.1.1.2.3.2.4" stretchy="false" xref="S2.E1.m1.6.6.1.1.1.1.2.3.1.cmml">)</mo></mrow></mrow><mo id="S2.E1.m1.6.6.1.1.1.1.1" xref="S2.E1.m1.6.6.1.1.1.1.1.cmml">≔</mo><mrow id="S2.E1.m1.6.6.1.1.1.1.3" xref="S2.E1.m1.6.6.1.1.1.1.3.cmml"><msup id="S2.E1.m1.6.6.1.1.1.1.3.2" xref="S2.E1.m1.6.6.1.1.1.1.3.2.cmml"><mi id="S2.E1.m1.6.6.1.1.1.1.3.2.2" xref="S2.E1.m1.6.6.1.1.1.1.3.2.2.cmml">𝐃</mi><mrow id="S2.E1.m1.6.6.1.1.1.1.3.2.3" xref="S2.E1.m1.6.6.1.1.1.1.3.2.3.cmml"><mo id="S2.E1.m1.6.6.1.1.1.1.3.2.3a" xref="S2.E1.m1.6.6.1.1.1.1.3.2.3.cmml">−</mo><mn id="S2.E1.m1.6.6.1.1.1.1.3.2.3.2" xref="S2.E1.m1.6.6.1.1.1.1.3.2.3.2.cmml">1</mn></mrow></msup><mo id="S2.E1.m1.6.6.1.1.1.1.3.1" xref="S2.E1.m1.6.6.1.1.1.1.3.1.cmml">⁢</mo><mi id="S2.E1.m1.6.6.1.1.1.1.3.3" xref="S2.E1.m1.6.6.1.1.1.1.3.3.cmml">𝐀𝐕</mi></mrow></mrow><mo id="S2.E1.m1.6.6.1.1.2.3" rspace="1.167em" xref="S2.E1.m1.6.6.1.1.3a.cmml">,</mo><mrow id="S2.E1.m1.6.6.1.1.2.2.2" xref="S2.E1.m1.6.6.1.1.2.2.3.cmml"><mrow id="S2.E1.m1.6.6.1.1.2.2.1.1" xref="S2.E1.m1.6.6.1.1.2.2.1.1.cmml"><mi id="S2.E1.m1.6.6.1.1.2.2.1.1.2" xref="S2.E1.m1.6.6.1.1.2.2.1.1.2.cmml">𝐀</mi><mo id="S2.E1.m1.6.6.1.1.2.2.1.1.1" xref="S2.E1.m1.6.6.1.1.2.2.1.1.1.cmml">≔</mo><mrow id="S2.E1.m1.6.6.1.1.2.2.1.1.3" xref="S2.E1.m1.6.6.1.1.2.2.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E1.m1.6.6.1.1.2.2.1.1.3.2" xref="S2.E1.m1.6.6.1.1.2.2.1.1.3.2.cmml">𝒦</mi><mo id="S2.E1.m1.6.6.1.1.2.2.1.1.3.1" xref="S2.E1.m1.6.6.1.1.2.2.1.1.3.1.cmml">⁢</mo><mrow id="S2.E1.m1.6.6.1.1.2.2.1.1.3.3.2" xref="S2.E1.m1.6.6.1.1.2.2.1.1.3.3.1.cmml"><mo id="S2.E1.m1.6.6.1.1.2.2.1.1.3.3.2.1" stretchy="false" xref="S2.E1.m1.6.6.1.1.2.2.1.1.3.3.1.cmml">(</mo><mi id="S2.E1.m1.4.4" xref="S2.E1.m1.4.4.cmml">𝐐</mi><mo id="S2.E1.m1.6.6.1.1.2.2.1.1.3.3.2.2" xref="S2.E1.m1.6.6.1.1.2.2.1.1.3.3.1.cmml">,</mo><mi id="S2.E1.m1.5.5" xref="S2.E1.m1.5.5.cmml">𝐊</mi><mo id="S2.E1.m1.6.6.1.1.2.2.1.1.3.3.2.3" stretchy="false" xref="S2.E1.m1.6.6.1.1.2.2.1.1.3.3.1.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E1.m1.6.6.1.1.2.2.2.3" rspace="1.167em" xref="S2.E1.m1.6.6.1.1.2.2.3a.cmml">,</mo><mrow id="S2.E1.m1.6.6.1.1.2.2.2.2" xref="S2.E1.m1.6.6.1.1.2.2.2.2.cmml"><mi id="S2.E1.m1.6.6.1.1.2.2.2.2.2" xref="S2.E1.m1.6.6.1.1.2.2.2.2.2.cmml">𝐃</mi><mo id="S2.E1.m1.6.6.1.1.2.2.2.2.1" xref="S2.E1.m1.6.6.1.1.2.2.2.2.1.cmml">≔</mo><msub id="S2.E1.m1.6.6.1.1.2.2.2.2.3" xref="S2.E1.m1.6.6.1.1.2.2.2.2.3.cmml"><mi id="S2.E1.m1.6.6.1.1.2.2.2.2.3.2" xref="S2.E1.m1.6.6.1.1.2.2.2.2.3.2.cmml">𝐀𝟏</mi><mi id="S2.E1.m1.6.6.1.1.2.2.2.2.3.3" xref="S2.E1.m1.6.6.1.1.2.2.2.2.3.3.cmml">N</mi></msub></mrow></mrow></mrow><mo id="S2.E1.m1.6.6.1.2" lspace="0em">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E1.m1.6b"><apply id="S2.E1.m1.6.6.1.1.3.cmml" xref="S2.E1.m1.6.6.1.1.2"><csymbol cd="ambiguous" id="S2.E1.m1.6.6.1.1.3a.cmml" xref="S2.E1.m1.6.6.1.1.2.3">formulae-sequence</csymbol><apply id="S2.E1.m1.6.6.1.1.1.1.cmml" xref="S2.E1.m1.6.6.1.1.1.1"><ci id="S2.E1.m1.6.6.1.1.1.1.1.cmml" xref="S2.E1.m1.6.6.1.1.1.1.1">≔</ci><apply id="S2.E1.m1.6.6.1.1.1.1.2.cmml" xref="S2.E1.m1.6.6.1.1.1.1.2"><times id="S2.E1.m1.6.6.1.1.1.1.2.1.cmml" xref="S2.E1.m1.6.6.1.1.1.1.2.1"></times><ci id="S2.E1.m1.6.6.1.1.1.1.2.2a.cmml" xref="S2.E1.m1.6.6.1.1.1.1.2.2"><mtext id="S2.E1.m1.6.6.1.1.1.1.2.2.cmml" xref="S2.E1.m1.6.6.1.1.1.1.2.2">Att</mtext></ci><vector id="S2.E1.m1.6.6.1.1.1.1.2.3.1.cmml" xref="S2.E1.m1.6.6.1.1.1.1.2.3.2"><ci id="S2.E1.m1.1.1.cmml" xref="S2.E1.m1.1.1">𝐐</ci><ci id="S2.E1.m1.2.2.cmml" xref="S2.E1.m1.2.2">𝐊</ci><ci id="S2.E1.m1.3.3.cmml" xref="S2.E1.m1.3.3">𝐕</ci></vector></apply><apply id="S2.E1.m1.6.6.1.1.1.1.3.cmml" xref="S2.E1.m1.6.6.1.1.1.1.3"><times id="S2.E1.m1.6.6.1.1.1.1.3.1.cmml" xref="S2.E1.m1.6.6.1.1.1.1.3.1"></times><apply id="S2.E1.m1.6.6.1.1.1.1.3.2.cmml" xref="S2.E1.m1.6.6.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S2.E1.m1.6.6.1.1.1.1.3.2.1.cmml" xref="S2.E1.m1.6.6.1.1.1.1.3.2">superscript</csymbol><ci id="S2.E1.m1.6.6.1.1.1.1.3.2.2.cmml" xref="S2.E1.m1.6.6.1.1.1.1.3.2.2">𝐃</ci><apply id="S2.E1.m1.6.6.1.1.1.1.3.2.3.cmml" xref="S2.E1.m1.6.6.1.1.1.1.3.2.3"><minus id="S2.E1.m1.6.6.1.1.1.1.3.2.3.1.cmml" xref="S2.E1.m1.6.6.1.1.1.1.3.2.3"></minus><cn id="S2.E1.m1.6.6.1.1.1.1.3.2.3.2.cmml" type="integer" xref="S2.E1.m1.6.6.1.1.1.1.3.2.3.2">1</cn></apply></apply><ci id="S2.E1.m1.6.6.1.1.1.1.3.3.cmml" xref="S2.E1.m1.6.6.1.1.1.1.3.3">𝐀𝐕</ci></apply></apply><apply id="S2.E1.m1.6.6.1.1.2.2.3.cmml" xref="S2.E1.m1.6.6.1.1.2.2.2"><csymbol cd="ambiguous" id="S2.E1.m1.6.6.1.1.2.2.3a.cmml" xref="S2.E1.m1.6.6.1.1.2.2.2.3">formulae-sequence</csymbol><apply id="S2.E1.m1.6.6.1.1.2.2.1.1.cmml" xref="S2.E1.m1.6.6.1.1.2.2.1.1"><ci id="S2.E1.m1.6.6.1.1.2.2.1.1.1.cmml" xref="S2.E1.m1.6.6.1.1.2.2.1.1.1">≔</ci><ci id="S2.E1.m1.6.6.1.1.2.2.1.1.2.cmml" xref="S2.E1.m1.6.6.1.1.2.2.1.1.2">𝐀</ci><apply id="S2.E1.m1.6.6.1.1.2.2.1.1.3.cmml" xref="S2.E1.m1.6.6.1.1.2.2.1.1.3"><times id="S2.E1.m1.6.6.1.1.2.2.1.1.3.1.cmml" xref="S2.E1.m1.6.6.1.1.2.2.1.1.3.1"></times><ci id="S2.E1.m1.6.6.1.1.2.2.1.1.3.2.cmml" xref="S2.E1.m1.6.6.1.1.2.2.1.1.3.2">𝒦</ci><interval closure="open" id="S2.E1.m1.6.6.1.1.2.2.1.1.3.3.1.cmml" xref="S2.E1.m1.6.6.1.1.2.2.1.1.3.3.2"><ci id="S2.E1.m1.4.4.cmml" xref="S2.E1.m1.4.4">𝐐</ci><ci id="S2.E1.m1.5.5.cmml" xref="S2.E1.m1.5.5">𝐊</ci></interval></apply></apply><apply id="S2.E1.m1.6.6.1.1.2.2.2.2.cmml" xref="S2.E1.m1.6.6.1.1.2.2.2.2"><ci id="S2.E1.m1.6.6.1.1.2.2.2.2.1.cmml" xref="S2.E1.m1.6.6.1.1.2.2.2.2.1">≔</ci><ci id="S2.E1.m1.6.6.1.1.2.2.2.2.2.cmml" xref="S2.E1.m1.6.6.1.1.2.2.2.2.2">𝐃</ci><apply id="S2.E1.m1.6.6.1.1.2.2.2.2.3.cmml" xref="S2.E1.m1.6.6.1.1.2.2.2.2.3"><csymbol cd="ambiguous" id="S2.E1.m1.6.6.1.1.2.2.2.2.3.1.cmml" xref="S2.E1.m1.6.6.1.1.2.2.2.2.3">subscript</csymbol><ci id="S2.E1.m1.6.6.1.1.2.2.2.2.3.2.cmml" xref="S2.E1.m1.6.6.1.1.2.2.2.2.3.2">𝐀𝟏</ci><ci id="S2.E1.m1.6.6.1.1.2.2.2.2.3.3.cmml" xref="S2.E1.m1.6.6.1.1.2.2.2.2.3.3">𝑁</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1.m1.6c">\textrm{Att}(\mathbf{Q},\mathbf{K},\mathbf{V})\coloneqq\mathbf{D}^{-1}\mathbf{%
A}\mathbf{V},\quad\mathbf{A}\coloneqq\mathcal{K}(\mathbf{Q},\mathbf{K}),\quad%
\mathbf{D}\coloneqq\mathbf{A}\mathbf{1}_{N}.</annotation><annotation encoding="application/x-llamapun" id="S2.E1.m1.6d">Att ( bold_Q , bold_K , bold_V ) ≔ bold_D start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT bold_AV , bold_A ≔ caligraphic_K ( bold_Q , bold_K ) , bold_D ≔ bold_A1 start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.p1.10">Here, the function <math alttext="\mathcal{K}" class="ltx_Math" display="inline" id="S2.p1.7.m1.1"><semantics id="S2.p1.7.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S2.p1.7.m1.1.1" xref="S2.p1.7.m1.1.1.cmml">𝒦</mi><annotation-xml encoding="MathML-Content" id="S2.p1.7.m1.1b"><ci id="S2.p1.7.m1.1.1.cmml" xref="S2.p1.7.m1.1.1">𝒦</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.7.m1.1c">\mathcal{K}</annotation><annotation encoding="application/x-llamapun" id="S2.p1.7.m1.1d">caligraphic_K</annotation></semantics></math> assigns a similarity score to each query-key pair and <math alttext="\mathbf{1}_{N}\coloneqq[1]_{i=1}^{N}\in\mathbb{R}^{N}" class="ltx_Math" display="inline" id="S2.p1.8.m2.1"><semantics id="S2.p1.8.m2.1a"><mrow id="S2.p1.8.m2.1.2" xref="S2.p1.8.m2.1.2.cmml"><msub id="S2.p1.8.m2.1.2.2" xref="S2.p1.8.m2.1.2.2.cmml"><mn id="S2.p1.8.m2.1.2.2.2" xref="S2.p1.8.m2.1.2.2.2.cmml">𝟏</mn><mi id="S2.p1.8.m2.1.2.2.3" xref="S2.p1.8.m2.1.2.2.3.cmml">N</mi></msub><mo id="S2.p1.8.m2.1.2.3" xref="S2.p1.8.m2.1.2.3.cmml">≔</mo><msubsup id="S2.p1.8.m2.1.2.4" xref="S2.p1.8.m2.1.2.4.cmml"><mrow id="S2.p1.8.m2.1.2.4.2.2.2" xref="S2.p1.8.m2.1.2.4.2.2.1.cmml"><mo id="S2.p1.8.m2.1.2.4.2.2.2.1" stretchy="false" xref="S2.p1.8.m2.1.2.4.2.2.1.1.cmml">[</mo><mn id="S2.p1.8.m2.1.1" xref="S2.p1.8.m2.1.1.cmml">1</mn><mo id="S2.p1.8.m2.1.2.4.2.2.2.2" stretchy="false" xref="S2.p1.8.m2.1.2.4.2.2.1.1.cmml">]</mo></mrow><mrow id="S2.p1.8.m2.1.2.4.2.3" xref="S2.p1.8.m2.1.2.4.2.3.cmml"><mi id="S2.p1.8.m2.1.2.4.2.3.2" xref="S2.p1.8.m2.1.2.4.2.3.2.cmml">i</mi><mo id="S2.p1.8.m2.1.2.4.2.3.1" xref="S2.p1.8.m2.1.2.4.2.3.1.cmml">=</mo><mn id="S2.p1.8.m2.1.2.4.2.3.3" xref="S2.p1.8.m2.1.2.4.2.3.3.cmml">1</mn></mrow><mi id="S2.p1.8.m2.1.2.4.3" xref="S2.p1.8.m2.1.2.4.3.cmml">N</mi></msubsup><mo id="S2.p1.8.m2.1.2.5" xref="S2.p1.8.m2.1.2.5.cmml">∈</mo><msup id="S2.p1.8.m2.1.2.6" xref="S2.p1.8.m2.1.2.6.cmml"><mi id="S2.p1.8.m2.1.2.6.2" xref="S2.p1.8.m2.1.2.6.2.cmml">ℝ</mi><mi id="S2.p1.8.m2.1.2.6.3" xref="S2.p1.8.m2.1.2.6.3.cmml">N</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.8.m2.1b"><apply id="S2.p1.8.m2.1.2.cmml" xref="S2.p1.8.m2.1.2"><and id="S2.p1.8.m2.1.2a.cmml" xref="S2.p1.8.m2.1.2"></and><apply id="S2.p1.8.m2.1.2b.cmml" xref="S2.p1.8.m2.1.2"><ci id="S2.p1.8.m2.1.2.3.cmml" xref="S2.p1.8.m2.1.2.3">≔</ci><apply id="S2.p1.8.m2.1.2.2.cmml" xref="S2.p1.8.m2.1.2.2"><csymbol cd="ambiguous" id="S2.p1.8.m2.1.2.2.1.cmml" xref="S2.p1.8.m2.1.2.2">subscript</csymbol><cn id="S2.p1.8.m2.1.2.2.2.cmml" type="integer" xref="S2.p1.8.m2.1.2.2.2">1</cn><ci id="S2.p1.8.m2.1.2.2.3.cmml" xref="S2.p1.8.m2.1.2.2.3">𝑁</ci></apply><apply id="S2.p1.8.m2.1.2.4.cmml" xref="S2.p1.8.m2.1.2.4"><csymbol cd="ambiguous" id="S2.p1.8.m2.1.2.4.1.cmml" xref="S2.p1.8.m2.1.2.4">superscript</csymbol><apply id="S2.p1.8.m2.1.2.4.2.cmml" xref="S2.p1.8.m2.1.2.4"><csymbol cd="ambiguous" id="S2.p1.8.m2.1.2.4.2.1.cmml" xref="S2.p1.8.m2.1.2.4">subscript</csymbol><apply id="S2.p1.8.m2.1.2.4.2.2.1.cmml" xref="S2.p1.8.m2.1.2.4.2.2.2"><csymbol cd="latexml" id="S2.p1.8.m2.1.2.4.2.2.1.1.cmml" xref="S2.p1.8.m2.1.2.4.2.2.2.1">delimited-[]</csymbol><cn id="S2.p1.8.m2.1.1.cmml" type="integer" xref="S2.p1.8.m2.1.1">1</cn></apply><apply id="S2.p1.8.m2.1.2.4.2.3.cmml" xref="S2.p1.8.m2.1.2.4.2.3"><eq id="S2.p1.8.m2.1.2.4.2.3.1.cmml" xref="S2.p1.8.m2.1.2.4.2.3.1"></eq><ci id="S2.p1.8.m2.1.2.4.2.3.2.cmml" xref="S2.p1.8.m2.1.2.4.2.3.2">𝑖</ci><cn id="S2.p1.8.m2.1.2.4.2.3.3.cmml" type="integer" xref="S2.p1.8.m2.1.2.4.2.3.3">1</cn></apply></apply><ci id="S2.p1.8.m2.1.2.4.3.cmml" xref="S2.p1.8.m2.1.2.4.3">𝑁</ci></apply></apply><apply id="S2.p1.8.m2.1.2c.cmml" xref="S2.p1.8.m2.1.2"><in id="S2.p1.8.m2.1.2.5.cmml" xref="S2.p1.8.m2.1.2.5"></in><share href="https://arxiv.org/html/2410.03462v1#S2.p1.8.m2.1.2.4.cmml" id="S2.p1.8.m2.1.2d.cmml" xref="S2.p1.8.m2.1.2"></share><apply id="S2.p1.8.m2.1.2.6.cmml" xref="S2.p1.8.m2.1.2.6"><csymbol cd="ambiguous" id="S2.p1.8.m2.1.2.6.1.cmml" xref="S2.p1.8.m2.1.2.6">superscript</csymbol><ci id="S2.p1.8.m2.1.2.6.2.cmml" xref="S2.p1.8.m2.1.2.6.2">ℝ</ci><ci id="S2.p1.8.m2.1.2.6.3.cmml" xref="S2.p1.8.m2.1.2.6.3">𝑁</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.8.m2.1c">\mathbf{1}_{N}\coloneqq[1]_{i=1}^{N}\in\mathbb{R}^{N}</annotation><annotation encoding="application/x-llamapun" id="S2.p1.8.m2.1d">bold_1 start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ≔ [ 1 ] start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT</annotation></semantics></math>.
For regular softmax attention, one simply takes <math alttext="\mathcal{K}(\mathbf{Q},\mathbf{K})_{ij}=\exp(\bm{q}_{i}^{\top}\bm{k}_{j})" class="ltx_Math" display="inline" id="S2.p1.9.m3.4"><semantics id="S2.p1.9.m3.4a"><mrow id="S2.p1.9.m3.4.4" xref="S2.p1.9.m3.4.4.cmml"><mrow id="S2.p1.9.m3.4.4.3" xref="S2.p1.9.m3.4.4.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p1.9.m3.4.4.3.2" xref="S2.p1.9.m3.4.4.3.2.cmml">𝒦</mi><mo id="S2.p1.9.m3.4.4.3.1" xref="S2.p1.9.m3.4.4.3.1.cmml">⁢</mo><msub id="S2.p1.9.m3.4.4.3.3" xref="S2.p1.9.m3.4.4.3.3.cmml"><mrow id="S2.p1.9.m3.4.4.3.3.2.2" xref="S2.p1.9.m3.4.4.3.3.2.1.cmml"><mo id="S2.p1.9.m3.4.4.3.3.2.2.1" stretchy="false" xref="S2.p1.9.m3.4.4.3.3.2.1.cmml">(</mo><mi id="S2.p1.9.m3.1.1" xref="S2.p1.9.m3.1.1.cmml">𝐐</mi><mo id="S2.p1.9.m3.4.4.3.3.2.2.2" xref="S2.p1.9.m3.4.4.3.3.2.1.cmml">,</mo><mi id="S2.p1.9.m3.2.2" xref="S2.p1.9.m3.2.2.cmml">𝐊</mi><mo id="S2.p1.9.m3.4.4.3.3.2.2.3" stretchy="false" xref="S2.p1.9.m3.4.4.3.3.2.1.cmml">)</mo></mrow><mrow id="S2.p1.9.m3.4.4.3.3.3" xref="S2.p1.9.m3.4.4.3.3.3.cmml"><mi id="S2.p1.9.m3.4.4.3.3.3.2" xref="S2.p1.9.m3.4.4.3.3.3.2.cmml">i</mi><mo id="S2.p1.9.m3.4.4.3.3.3.1" xref="S2.p1.9.m3.4.4.3.3.3.1.cmml">⁢</mo><mi id="S2.p1.9.m3.4.4.3.3.3.3" xref="S2.p1.9.m3.4.4.3.3.3.3.cmml">j</mi></mrow></msub></mrow><mo id="S2.p1.9.m3.4.4.2" xref="S2.p1.9.m3.4.4.2.cmml">=</mo><mrow id="S2.p1.9.m3.4.4.1.1" xref="S2.p1.9.m3.4.4.1.2.cmml"><mi id="S2.p1.9.m3.3.3" xref="S2.p1.9.m3.3.3.cmml">exp</mi><mo id="S2.p1.9.m3.4.4.1.1a" xref="S2.p1.9.m3.4.4.1.2.cmml">⁡</mo><mrow id="S2.p1.9.m3.4.4.1.1.1" xref="S2.p1.9.m3.4.4.1.2.cmml"><mo id="S2.p1.9.m3.4.4.1.1.1.2" stretchy="false" xref="S2.p1.9.m3.4.4.1.2.cmml">(</mo><mrow id="S2.p1.9.m3.4.4.1.1.1.1" xref="S2.p1.9.m3.4.4.1.1.1.1.cmml"><msubsup id="S2.p1.9.m3.4.4.1.1.1.1.2" xref="S2.p1.9.m3.4.4.1.1.1.1.2.cmml"><mi id="S2.p1.9.m3.4.4.1.1.1.1.2.2.2" xref="S2.p1.9.m3.4.4.1.1.1.1.2.2.2.cmml">𝒒</mi><mi id="S2.p1.9.m3.4.4.1.1.1.1.2.2.3" xref="S2.p1.9.m3.4.4.1.1.1.1.2.2.3.cmml">i</mi><mo id="S2.p1.9.m3.4.4.1.1.1.1.2.3" xref="S2.p1.9.m3.4.4.1.1.1.1.2.3.cmml">⊤</mo></msubsup><mo id="S2.p1.9.m3.4.4.1.1.1.1.1" xref="S2.p1.9.m3.4.4.1.1.1.1.1.cmml">⁢</mo><msub id="S2.p1.9.m3.4.4.1.1.1.1.3" xref="S2.p1.9.m3.4.4.1.1.1.1.3.cmml"><mi id="S2.p1.9.m3.4.4.1.1.1.1.3.2" xref="S2.p1.9.m3.4.4.1.1.1.1.3.2.cmml">𝒌</mi><mi id="S2.p1.9.m3.4.4.1.1.1.1.3.3" xref="S2.p1.9.m3.4.4.1.1.1.1.3.3.cmml">j</mi></msub></mrow><mo id="S2.p1.9.m3.4.4.1.1.1.3" stretchy="false" xref="S2.p1.9.m3.4.4.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.9.m3.4b"><apply id="S2.p1.9.m3.4.4.cmml" xref="S2.p1.9.m3.4.4"><eq id="S2.p1.9.m3.4.4.2.cmml" xref="S2.p1.9.m3.4.4.2"></eq><apply id="S2.p1.9.m3.4.4.3.cmml" xref="S2.p1.9.m3.4.4.3"><times id="S2.p1.9.m3.4.4.3.1.cmml" xref="S2.p1.9.m3.4.4.3.1"></times><ci id="S2.p1.9.m3.4.4.3.2.cmml" xref="S2.p1.9.m3.4.4.3.2">𝒦</ci><apply id="S2.p1.9.m3.4.4.3.3.cmml" xref="S2.p1.9.m3.4.4.3.3"><csymbol cd="ambiguous" id="S2.p1.9.m3.4.4.3.3.1.cmml" xref="S2.p1.9.m3.4.4.3.3">subscript</csymbol><interval closure="open" id="S2.p1.9.m3.4.4.3.3.2.1.cmml" xref="S2.p1.9.m3.4.4.3.3.2.2"><ci id="S2.p1.9.m3.1.1.cmml" xref="S2.p1.9.m3.1.1">𝐐</ci><ci id="S2.p1.9.m3.2.2.cmml" xref="S2.p1.9.m3.2.2">𝐊</ci></interval><apply id="S2.p1.9.m3.4.4.3.3.3.cmml" xref="S2.p1.9.m3.4.4.3.3.3"><times id="S2.p1.9.m3.4.4.3.3.3.1.cmml" xref="S2.p1.9.m3.4.4.3.3.3.1"></times><ci id="S2.p1.9.m3.4.4.3.3.3.2.cmml" xref="S2.p1.9.m3.4.4.3.3.3.2">𝑖</ci><ci id="S2.p1.9.m3.4.4.3.3.3.3.cmml" xref="S2.p1.9.m3.4.4.3.3.3.3">𝑗</ci></apply></apply></apply><apply id="S2.p1.9.m3.4.4.1.2.cmml" xref="S2.p1.9.m3.4.4.1.1"><exp id="S2.p1.9.m3.3.3.cmml" xref="S2.p1.9.m3.3.3"></exp><apply id="S2.p1.9.m3.4.4.1.1.1.1.cmml" xref="S2.p1.9.m3.4.4.1.1.1.1"><times id="S2.p1.9.m3.4.4.1.1.1.1.1.cmml" xref="S2.p1.9.m3.4.4.1.1.1.1.1"></times><apply id="S2.p1.9.m3.4.4.1.1.1.1.2.cmml" xref="S2.p1.9.m3.4.4.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.p1.9.m3.4.4.1.1.1.1.2.1.cmml" xref="S2.p1.9.m3.4.4.1.1.1.1.2">superscript</csymbol><apply id="S2.p1.9.m3.4.4.1.1.1.1.2.2.cmml" xref="S2.p1.9.m3.4.4.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.p1.9.m3.4.4.1.1.1.1.2.2.1.cmml" xref="S2.p1.9.m3.4.4.1.1.1.1.2">subscript</csymbol><ci id="S2.p1.9.m3.4.4.1.1.1.1.2.2.2.cmml" xref="S2.p1.9.m3.4.4.1.1.1.1.2.2.2">𝒒</ci><ci id="S2.p1.9.m3.4.4.1.1.1.1.2.2.3.cmml" xref="S2.p1.9.m3.4.4.1.1.1.1.2.2.3">𝑖</ci></apply><csymbol cd="latexml" id="S2.p1.9.m3.4.4.1.1.1.1.2.3.cmml" xref="S2.p1.9.m3.4.4.1.1.1.1.2.3">top</csymbol></apply><apply id="S2.p1.9.m3.4.4.1.1.1.1.3.cmml" xref="S2.p1.9.m3.4.4.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.p1.9.m3.4.4.1.1.1.1.3.1.cmml" xref="S2.p1.9.m3.4.4.1.1.1.1.3">subscript</csymbol><ci id="S2.p1.9.m3.4.4.1.1.1.1.3.2.cmml" xref="S2.p1.9.m3.4.4.1.1.1.1.3.2">𝒌</ci><ci id="S2.p1.9.m3.4.4.1.1.1.1.3.3.cmml" xref="S2.p1.9.m3.4.4.1.1.1.1.3.3">𝑗</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.9.m3.4c">\mathcal{K}(\mathbf{Q},\mathbf{K})_{ij}=\exp(\bm{q}_{i}^{\top}\bm{k}_{j})</annotation><annotation encoding="application/x-llamapun" id="S2.p1.9.m3.4d">caligraphic_K ( bold_Q , bold_K ) start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT = roman_exp ( bold_italic_q start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT bold_italic_k start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT )</annotation></semantics></math>, optionally also normalising by <math alttext="d" class="ltx_Math" display="inline" id="S2.p1.10.m4.1"><semantics id="S2.p1.10.m4.1a"><mi id="S2.p1.10.m4.1.1" xref="S2.p1.10.m4.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S2.p1.10.m4.1b"><ci id="S2.p1.10.m4.1.1.cmml" xref="S2.p1.10.m4.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.10.m4.1c">d</annotation><annotation encoding="application/x-llamapun" id="S2.p1.10.m4.1d">italic_d</annotation></semantics></math>.
To incorporate <em class="ltx_emph ltx_font_italic" id="S2.p1.10.1">masking</em>, we make the modification</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equation ltx_eqn_table" id="S2.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{A}_{\mathbf{M}}\coloneqq\mathbf{M}\odot\mathcal{K}(\mathbf{Q},\mathbf{%
K})," class="ltx_Math" display="block" id="S2.E2.m1.3"><semantics id="S2.E2.m1.3a"><mrow id="S2.E2.m1.3.3.1" xref="S2.E2.m1.3.3.1.1.cmml"><mrow id="S2.E2.m1.3.3.1.1" xref="S2.E2.m1.3.3.1.1.cmml"><msub id="S2.E2.m1.3.3.1.1.2" xref="S2.E2.m1.3.3.1.1.2.cmml"><mi id="S2.E2.m1.3.3.1.1.2.2" xref="S2.E2.m1.3.3.1.1.2.2.cmml">𝐀</mi><mi id="S2.E2.m1.3.3.1.1.2.3" xref="S2.E2.m1.3.3.1.1.2.3.cmml">𝐌</mi></msub><mo id="S2.E2.m1.3.3.1.1.1" xref="S2.E2.m1.3.3.1.1.1.cmml">≔</mo><mrow id="S2.E2.m1.3.3.1.1.3" xref="S2.E2.m1.3.3.1.1.3.cmml"><mrow id="S2.E2.m1.3.3.1.1.3.2" xref="S2.E2.m1.3.3.1.1.3.2.cmml"><mi id="S2.E2.m1.3.3.1.1.3.2.2" xref="S2.E2.m1.3.3.1.1.3.2.2.cmml">𝐌</mi><mo id="S2.E2.m1.3.3.1.1.3.2.1" lspace="0.222em" rspace="0.222em" xref="S2.E2.m1.3.3.1.1.3.2.1.cmml">⊙</mo><mi class="ltx_font_mathcaligraphic" id="S2.E2.m1.3.3.1.1.3.2.3" xref="S2.E2.m1.3.3.1.1.3.2.3.cmml">𝒦</mi></mrow><mo id="S2.E2.m1.3.3.1.1.3.1" xref="S2.E2.m1.3.3.1.1.3.1.cmml">⁢</mo><mrow id="S2.E2.m1.3.3.1.1.3.3.2" xref="S2.E2.m1.3.3.1.1.3.3.1.cmml"><mo id="S2.E2.m1.3.3.1.1.3.3.2.1" stretchy="false" xref="S2.E2.m1.3.3.1.1.3.3.1.cmml">(</mo><mi id="S2.E2.m1.1.1" xref="S2.E2.m1.1.1.cmml">𝐐</mi><mo id="S2.E2.m1.3.3.1.1.3.3.2.2" xref="S2.E2.m1.3.3.1.1.3.3.1.cmml">,</mo><mi id="S2.E2.m1.2.2" xref="S2.E2.m1.2.2.cmml">𝐊</mi><mo id="S2.E2.m1.3.3.1.1.3.3.2.3" stretchy="false" xref="S2.E2.m1.3.3.1.1.3.3.1.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E2.m1.3.3.1.2" xref="S2.E2.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E2.m1.3b"><apply id="S2.E2.m1.3.3.1.1.cmml" xref="S2.E2.m1.3.3.1"><ci id="S2.E2.m1.3.3.1.1.1.cmml" xref="S2.E2.m1.3.3.1.1.1">≔</ci><apply id="S2.E2.m1.3.3.1.1.2.cmml" xref="S2.E2.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="S2.E2.m1.3.3.1.1.2.1.cmml" xref="S2.E2.m1.3.3.1.1.2">subscript</csymbol><ci id="S2.E2.m1.3.3.1.1.2.2.cmml" xref="S2.E2.m1.3.3.1.1.2.2">𝐀</ci><ci id="S2.E2.m1.3.3.1.1.2.3.cmml" xref="S2.E2.m1.3.3.1.1.2.3">𝐌</ci></apply><apply id="S2.E2.m1.3.3.1.1.3.cmml" xref="S2.E2.m1.3.3.1.1.3"><times id="S2.E2.m1.3.3.1.1.3.1.cmml" xref="S2.E2.m1.3.3.1.1.3.1"></times><apply id="S2.E2.m1.3.3.1.1.3.2.cmml" xref="S2.E2.m1.3.3.1.1.3.2"><csymbol cd="latexml" id="S2.E2.m1.3.3.1.1.3.2.1.cmml" xref="S2.E2.m1.3.3.1.1.3.2.1">direct-product</csymbol><ci id="S2.E2.m1.3.3.1.1.3.2.2.cmml" xref="S2.E2.m1.3.3.1.1.3.2.2">𝐌</ci><ci id="S2.E2.m1.3.3.1.1.3.2.3.cmml" xref="S2.E2.m1.3.3.1.1.3.2.3">𝒦</ci></apply><interval closure="open" id="S2.E2.m1.3.3.1.1.3.3.1.cmml" xref="S2.E2.m1.3.3.1.1.3.3.2"><ci id="S2.E2.m1.1.1.cmml" xref="S2.E2.m1.1.1">𝐐</ci><ci id="S2.E2.m1.2.2.cmml" xref="S2.E2.m1.2.2">𝐊</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2.m1.3c">\mathbf{A}_{\mathbf{M}}\coloneqq\mathbf{M}\odot\mathcal{K}(\mathbf{Q},\mathbf{%
K}),</annotation><annotation encoding="application/x-llamapun" id="S2.E2.m1.3d">bold_A start_POSTSUBSCRIPT bold_M end_POSTSUBSCRIPT ≔ bold_M ⊙ caligraphic_K ( bold_Q , bold_K ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.p1.15">where <math alttext="\mathbf{M}\in\mathbb{R}^{N\times N}" class="ltx_Math" display="inline" id="S2.p1.11.m1.1"><semantics id="S2.p1.11.m1.1a"><mrow id="S2.p1.11.m1.1.1" xref="S2.p1.11.m1.1.1.cmml"><mi id="S2.p1.11.m1.1.1.2" xref="S2.p1.11.m1.1.1.2.cmml">𝐌</mi><mo id="S2.p1.11.m1.1.1.1" xref="S2.p1.11.m1.1.1.1.cmml">∈</mo><msup id="S2.p1.11.m1.1.1.3" xref="S2.p1.11.m1.1.1.3.cmml"><mi id="S2.p1.11.m1.1.1.3.2" xref="S2.p1.11.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S2.p1.11.m1.1.1.3.3" xref="S2.p1.11.m1.1.1.3.3.cmml"><mi id="S2.p1.11.m1.1.1.3.3.2" xref="S2.p1.11.m1.1.1.3.3.2.cmml">N</mi><mo id="S2.p1.11.m1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S2.p1.11.m1.1.1.3.3.1.cmml">×</mo><mi id="S2.p1.11.m1.1.1.3.3.3" xref="S2.p1.11.m1.1.1.3.3.3.cmml">N</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.11.m1.1b"><apply id="S2.p1.11.m1.1.1.cmml" xref="S2.p1.11.m1.1.1"><in id="S2.p1.11.m1.1.1.1.cmml" xref="S2.p1.11.m1.1.1.1"></in><ci id="S2.p1.11.m1.1.1.2.cmml" xref="S2.p1.11.m1.1.1.2">𝐌</ci><apply id="S2.p1.11.m1.1.1.3.cmml" xref="S2.p1.11.m1.1.1.3"><csymbol cd="ambiguous" id="S2.p1.11.m1.1.1.3.1.cmml" xref="S2.p1.11.m1.1.1.3">superscript</csymbol><ci id="S2.p1.11.m1.1.1.3.2.cmml" xref="S2.p1.11.m1.1.1.3.2">ℝ</ci><apply id="S2.p1.11.m1.1.1.3.3.cmml" xref="S2.p1.11.m1.1.1.3.3"><times id="S2.p1.11.m1.1.1.3.3.1.cmml" xref="S2.p1.11.m1.1.1.3.3.1"></times><ci id="S2.p1.11.m1.1.1.3.3.2.cmml" xref="S2.p1.11.m1.1.1.3.3.2">𝑁</ci><ci id="S2.p1.11.m1.1.1.3.3.3.cmml" xref="S2.p1.11.m1.1.1.3.3.3">𝑁</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.11.m1.1c">\mathbf{M}\in\mathbb{R}^{N\times N}</annotation><annotation encoding="application/x-llamapun" id="S2.p1.11.m1.1d">bold_M ∈ blackboard_R start_POSTSUPERSCRIPT italic_N × italic_N end_POSTSUPERSCRIPT</annotation></semantics></math> is a (hard or soft) <em class="ltx_emph ltx_font_italic" id="S2.p1.15.1">masking matrix</em> and <math alttext="\odot" class="ltx_Math" display="inline" id="S2.p1.12.m2.1"><semantics id="S2.p1.12.m2.1a"><mo id="S2.p1.12.m2.1.1" xref="S2.p1.12.m2.1.1.cmml">⊙</mo><annotation-xml encoding="MathML-Content" id="S2.p1.12.m2.1b"><csymbol cd="latexml" id="S2.p1.12.m2.1.1.cmml" xref="S2.p1.12.m2.1.1">direct-product</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.12.m2.1c">\odot</annotation><annotation encoding="application/x-llamapun" id="S2.p1.12.m2.1d">⊙</annotation></semantics></math> denotes the Hadamard (element-wise) product.
For softmax, this is equivalent to adding a bias term <math alttext="b_{ij}\coloneqq\log\mathbf{M}_{ij}" class="ltx_Math" display="inline" id="S2.p1.13.m3.1"><semantics id="S2.p1.13.m3.1a"><mrow id="S2.p1.13.m3.1.1" xref="S2.p1.13.m3.1.1.cmml"><msub id="S2.p1.13.m3.1.1.2" xref="S2.p1.13.m3.1.1.2.cmml"><mi id="S2.p1.13.m3.1.1.2.2" xref="S2.p1.13.m3.1.1.2.2.cmml">b</mi><mrow id="S2.p1.13.m3.1.1.2.3" xref="S2.p1.13.m3.1.1.2.3.cmml"><mi id="S2.p1.13.m3.1.1.2.3.2" xref="S2.p1.13.m3.1.1.2.3.2.cmml">i</mi><mo id="S2.p1.13.m3.1.1.2.3.1" xref="S2.p1.13.m3.1.1.2.3.1.cmml">⁢</mo><mi id="S2.p1.13.m3.1.1.2.3.3" xref="S2.p1.13.m3.1.1.2.3.3.cmml">j</mi></mrow></msub><mo id="S2.p1.13.m3.1.1.1" xref="S2.p1.13.m3.1.1.1.cmml">≔</mo><mrow id="S2.p1.13.m3.1.1.3" xref="S2.p1.13.m3.1.1.3.cmml"><mi id="S2.p1.13.m3.1.1.3.1" xref="S2.p1.13.m3.1.1.3.1.cmml">log</mi><mo id="S2.p1.13.m3.1.1.3a" lspace="0.167em" xref="S2.p1.13.m3.1.1.3.cmml">⁡</mo><msub id="S2.p1.13.m3.1.1.3.2" xref="S2.p1.13.m3.1.1.3.2.cmml"><mi id="S2.p1.13.m3.1.1.3.2.2" xref="S2.p1.13.m3.1.1.3.2.2.cmml">𝐌</mi><mrow id="S2.p1.13.m3.1.1.3.2.3" xref="S2.p1.13.m3.1.1.3.2.3.cmml"><mi id="S2.p1.13.m3.1.1.3.2.3.2" xref="S2.p1.13.m3.1.1.3.2.3.2.cmml">i</mi><mo id="S2.p1.13.m3.1.1.3.2.3.1" xref="S2.p1.13.m3.1.1.3.2.3.1.cmml">⁢</mo><mi id="S2.p1.13.m3.1.1.3.2.3.3" xref="S2.p1.13.m3.1.1.3.2.3.3.cmml">j</mi></mrow></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.13.m3.1b"><apply id="S2.p1.13.m3.1.1.cmml" xref="S2.p1.13.m3.1.1"><ci id="S2.p1.13.m3.1.1.1.cmml" xref="S2.p1.13.m3.1.1.1">≔</ci><apply id="S2.p1.13.m3.1.1.2.cmml" xref="S2.p1.13.m3.1.1.2"><csymbol cd="ambiguous" id="S2.p1.13.m3.1.1.2.1.cmml" xref="S2.p1.13.m3.1.1.2">subscript</csymbol><ci id="S2.p1.13.m3.1.1.2.2.cmml" xref="S2.p1.13.m3.1.1.2.2">𝑏</ci><apply id="S2.p1.13.m3.1.1.2.3.cmml" xref="S2.p1.13.m3.1.1.2.3"><times id="S2.p1.13.m3.1.1.2.3.1.cmml" xref="S2.p1.13.m3.1.1.2.3.1"></times><ci id="S2.p1.13.m3.1.1.2.3.2.cmml" xref="S2.p1.13.m3.1.1.2.3.2">𝑖</ci><ci id="S2.p1.13.m3.1.1.2.3.3.cmml" xref="S2.p1.13.m3.1.1.2.3.3">𝑗</ci></apply></apply><apply id="S2.p1.13.m3.1.1.3.cmml" xref="S2.p1.13.m3.1.1.3"><log id="S2.p1.13.m3.1.1.3.1.cmml" xref="S2.p1.13.m3.1.1.3.1"></log><apply id="S2.p1.13.m3.1.1.3.2.cmml" xref="S2.p1.13.m3.1.1.3.2"><csymbol cd="ambiguous" id="S2.p1.13.m3.1.1.3.2.1.cmml" xref="S2.p1.13.m3.1.1.3.2">subscript</csymbol><ci id="S2.p1.13.m3.1.1.3.2.2.cmml" xref="S2.p1.13.m3.1.1.3.2.2">𝐌</ci><apply id="S2.p1.13.m3.1.1.3.2.3.cmml" xref="S2.p1.13.m3.1.1.3.2.3"><times id="S2.p1.13.m3.1.1.3.2.3.1.cmml" xref="S2.p1.13.m3.1.1.3.2.3.1"></times><ci id="S2.p1.13.m3.1.1.3.2.3.2.cmml" xref="S2.p1.13.m3.1.1.3.2.3.2">𝑖</ci><ci id="S2.p1.13.m3.1.1.3.2.3.3.cmml" xref="S2.p1.13.m3.1.1.3.2.3.3">𝑗</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.13.m3.1c">b_{ij}\coloneqq\log\mathbf{M}_{ij}</annotation><annotation encoding="application/x-llamapun" id="S2.p1.13.m3.1d">italic_b start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT ≔ roman_log bold_M start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT</annotation></semantics></math> to <math alttext="\bm{q}_{i}^{\top}\bm{k}_{j}" class="ltx_Math" display="inline" id="S2.p1.14.m4.1"><semantics id="S2.p1.14.m4.1a"><mrow id="S2.p1.14.m4.1.1" xref="S2.p1.14.m4.1.1.cmml"><msubsup id="S2.p1.14.m4.1.1.2" xref="S2.p1.14.m4.1.1.2.cmml"><mi id="S2.p1.14.m4.1.1.2.2.2" xref="S2.p1.14.m4.1.1.2.2.2.cmml">𝒒</mi><mi id="S2.p1.14.m4.1.1.2.2.3" xref="S2.p1.14.m4.1.1.2.2.3.cmml">i</mi><mo id="S2.p1.14.m4.1.1.2.3" xref="S2.p1.14.m4.1.1.2.3.cmml">⊤</mo></msubsup><mo id="S2.p1.14.m4.1.1.1" xref="S2.p1.14.m4.1.1.1.cmml">⁢</mo><msub id="S2.p1.14.m4.1.1.3" xref="S2.p1.14.m4.1.1.3.cmml"><mi id="S2.p1.14.m4.1.1.3.2" xref="S2.p1.14.m4.1.1.3.2.cmml">𝒌</mi><mi id="S2.p1.14.m4.1.1.3.3" xref="S2.p1.14.m4.1.1.3.3.cmml">j</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.14.m4.1b"><apply id="S2.p1.14.m4.1.1.cmml" xref="S2.p1.14.m4.1.1"><times id="S2.p1.14.m4.1.1.1.cmml" xref="S2.p1.14.m4.1.1.1"></times><apply id="S2.p1.14.m4.1.1.2.cmml" xref="S2.p1.14.m4.1.1.2"><csymbol cd="ambiguous" id="S2.p1.14.m4.1.1.2.1.cmml" xref="S2.p1.14.m4.1.1.2">superscript</csymbol><apply id="S2.p1.14.m4.1.1.2.2.cmml" xref="S2.p1.14.m4.1.1.2"><csymbol cd="ambiguous" id="S2.p1.14.m4.1.1.2.2.1.cmml" xref="S2.p1.14.m4.1.1.2">subscript</csymbol><ci id="S2.p1.14.m4.1.1.2.2.2.cmml" xref="S2.p1.14.m4.1.1.2.2.2">𝒒</ci><ci id="S2.p1.14.m4.1.1.2.2.3.cmml" xref="S2.p1.14.m4.1.1.2.2.3">𝑖</ci></apply><csymbol cd="latexml" id="S2.p1.14.m4.1.1.2.3.cmml" xref="S2.p1.14.m4.1.1.2.3">top</csymbol></apply><apply id="S2.p1.14.m4.1.1.3.cmml" xref="S2.p1.14.m4.1.1.3"><csymbol cd="ambiguous" id="S2.p1.14.m4.1.1.3.1.cmml" xref="S2.p1.14.m4.1.1.3">subscript</csymbol><ci id="S2.p1.14.m4.1.1.3.2.cmml" xref="S2.p1.14.m4.1.1.3.2">𝒌</ci><ci id="S2.p1.14.m4.1.1.3.3.cmml" xref="S2.p1.14.m4.1.1.3.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.14.m4.1c">\bm{q}_{i}^{\top}\bm{k}_{j}</annotation><annotation encoding="application/x-llamapun" id="S2.p1.14.m4.1d">bold_italic_q start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT bold_italic_k start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> before exponentiating.
As remarked in Sec.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#S1" title="1 Introduction ‣ Linear Transformer Topological Masking with Graph Random Features"><span class="ltx_text ltx_ref_tag">1</span></a>, this can be used to enforce causality or as a relative position encoding (RPE) <cite class="ltx_cite ltx_citemacro_citep">(Shaw et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#bib.bib32" title="">2018</a>)</cite>. Taking <math alttext="\mathbf{M}(\mathcal{G})" class="ltx_Math" display="inline" id="S2.p1.15.m5.1"><semantics id="S2.p1.15.m5.1a"><mrow id="S2.p1.15.m5.1.2" xref="S2.p1.15.m5.1.2.cmml"><mi id="S2.p1.15.m5.1.2.2" xref="S2.p1.15.m5.1.2.2.cmml">𝐌</mi><mo id="S2.p1.15.m5.1.2.1" xref="S2.p1.15.m5.1.2.1.cmml">⁢</mo><mrow id="S2.p1.15.m5.1.2.3.2" xref="S2.p1.15.m5.1.2.cmml"><mo id="S2.p1.15.m5.1.2.3.2.1" stretchy="false" xref="S2.p1.15.m5.1.2.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S2.p1.15.m5.1.1" xref="S2.p1.15.m5.1.1.cmml">𝒢</mi><mo id="S2.p1.15.m5.1.2.3.2.2" stretchy="false" xref="S2.p1.15.m5.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.15.m5.1b"><apply id="S2.p1.15.m5.1.2.cmml" xref="S2.p1.15.m5.1.2"><times id="S2.p1.15.m5.1.2.1.cmml" xref="S2.p1.15.m5.1.2.1"></times><ci id="S2.p1.15.m5.1.2.2.cmml" xref="S2.p1.15.m5.1.2.2">𝐌</ci><ci id="S2.p1.15.m5.1.1.cmml" xref="S2.p1.15.m5.1.1">𝒢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.15.m5.1c">\mathbf{M}(\mathcal{G})</annotation><annotation encoding="application/x-llamapun" id="S2.p1.15.m5.1d">bold_M ( caligraphic_G )</annotation></semantics></math> so that attention is modulated by a function of the underlying graph structure is called <em class="ltx_emph ltx_font_italic" id="S2.p1.15.2">topological masking</em>.
Topological masking is <em class="ltx_emph ltx_font_italic" id="S2.p1.15.3">not</em> just a mechanism to sparsify attention for efficiency gains; its goal is to incorporate topological signal from the underlying graph, improving predictive performance via a useful inductive bias.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S2.p2">
<p class="ltx_p" id="S2.p2.8"><span class="ltx_text ltx_font_bold" id="S2.p2.8.1">Improving efficiency with low-rank attention.</span>
The time-complexity of Eq.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#S2.E1" title="In 2 Preliminaries ‣ Linear Transformer Topological Masking with Graph Random Features"><span class="ltx_text ltx_ref_tag">1</span></a> is <math alttext="\mathcal{O}(N^{2})" class="ltx_Math" display="inline" id="S2.p2.1.m1.1"><semantics id="S2.p2.1.m1.1a"><mrow id="S2.p2.1.m1.1.1" xref="S2.p2.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p2.1.m1.1.1.3" xref="S2.p2.1.m1.1.1.3.cmml">𝒪</mi><mo id="S2.p2.1.m1.1.1.2" xref="S2.p2.1.m1.1.1.2.cmml">⁢</mo><mrow id="S2.p2.1.m1.1.1.1.1" xref="S2.p2.1.m1.1.1.1.1.1.cmml"><mo id="S2.p2.1.m1.1.1.1.1.2" stretchy="false" xref="S2.p2.1.m1.1.1.1.1.1.cmml">(</mo><msup id="S2.p2.1.m1.1.1.1.1.1" xref="S2.p2.1.m1.1.1.1.1.1.cmml"><mi id="S2.p2.1.m1.1.1.1.1.1.2" xref="S2.p2.1.m1.1.1.1.1.1.2.cmml">N</mi><mn id="S2.p2.1.m1.1.1.1.1.1.3" xref="S2.p2.1.m1.1.1.1.1.1.3.cmml">2</mn></msup><mo id="S2.p2.1.m1.1.1.1.1.3" stretchy="false" xref="S2.p2.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p2.1.m1.1b"><apply id="S2.p2.1.m1.1.1.cmml" xref="S2.p2.1.m1.1.1"><times id="S2.p2.1.m1.1.1.2.cmml" xref="S2.p2.1.m1.1.1.2"></times><ci id="S2.p2.1.m1.1.1.3.cmml" xref="S2.p2.1.m1.1.1.3">𝒪</ci><apply id="S2.p2.1.m1.1.1.1.1.1.cmml" xref="S2.p2.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S2.p2.1.m1.1.1.1.1.1.1.cmml" xref="S2.p2.1.m1.1.1.1.1">superscript</csymbol><ci id="S2.p2.1.m1.1.1.1.1.1.2.cmml" xref="S2.p2.1.m1.1.1.1.1.1.2">𝑁</ci><cn id="S2.p2.1.m1.1.1.1.1.1.3.cmml" type="integer" xref="S2.p2.1.m1.1.1.1.1.1.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.1.m1.1c">\mathcal{O}(N^{2})</annotation><annotation encoding="application/x-llamapun" id="S2.p2.1.m1.1d">caligraphic_O ( italic_N start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT )</annotation></semantics></math>, which famously limits the ability of regular transformers to scale to long inputs.
A leading approach to mitigate this and recover <math alttext="\mathcal{O}(N)" class="ltx_Math" display="inline" id="S2.p2.2.m2.1"><semantics id="S2.p2.2.m2.1a"><mrow id="S2.p2.2.m2.1.2" xref="S2.p2.2.m2.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p2.2.m2.1.2.2" xref="S2.p2.2.m2.1.2.2.cmml">𝒪</mi><mo id="S2.p2.2.m2.1.2.1" xref="S2.p2.2.m2.1.2.1.cmml">⁢</mo><mrow id="S2.p2.2.m2.1.2.3.2" xref="S2.p2.2.m2.1.2.cmml"><mo id="S2.p2.2.m2.1.2.3.2.1" stretchy="false" xref="S2.p2.2.m2.1.2.cmml">(</mo><mi id="S2.p2.2.m2.1.1" xref="S2.p2.2.m2.1.1.cmml">N</mi><mo id="S2.p2.2.m2.1.2.3.2.2" stretchy="false" xref="S2.p2.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p2.2.m2.1b"><apply id="S2.p2.2.m2.1.2.cmml" xref="S2.p2.2.m2.1.2"><times id="S2.p2.2.m2.1.2.1.cmml" xref="S2.p2.2.m2.1.2.1"></times><ci id="S2.p2.2.m2.1.2.2.cmml" xref="S2.p2.2.m2.1.2.2">𝒪</ci><ci id="S2.p2.2.m2.1.1.cmml" xref="S2.p2.2.m2.1.1">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.2.m2.1c">\mathcal{O}(N)</annotation><annotation encoding="application/x-llamapun" id="S2.p2.2.m2.1d">caligraphic_O ( italic_N )</annotation></semantics></math> complexity is <em class="ltx_emph ltx_font_italic" id="S2.p2.8.2">linear</em> or <em class="ltx_emph ltx_font_italic" id="S2.p2.8.3">low-rank attention</em> <cite class="ltx_cite ltx_citemacro_citep">(Katharopoulos et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#bib.bib16" title="">2020</a>; Choromanski et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#bib.bib5" title="">2020</a>)</cite>.
This takes a feature mapping <math alttext="\phi:\mathbb{R}^{d}\to\mathbb{R}^{m}" class="ltx_Math" display="inline" id="S2.p2.3.m3.1"><semantics id="S2.p2.3.m3.1a"><mrow id="S2.p2.3.m3.1.1" xref="S2.p2.3.m3.1.1.cmml"><mi id="S2.p2.3.m3.1.1.2" xref="S2.p2.3.m3.1.1.2.cmml">ϕ</mi><mo id="S2.p2.3.m3.1.1.1" lspace="0.278em" rspace="0.278em" xref="S2.p2.3.m3.1.1.1.cmml">:</mo><mrow id="S2.p2.3.m3.1.1.3" xref="S2.p2.3.m3.1.1.3.cmml"><msup id="S2.p2.3.m3.1.1.3.2" xref="S2.p2.3.m3.1.1.3.2.cmml"><mi id="S2.p2.3.m3.1.1.3.2.2" xref="S2.p2.3.m3.1.1.3.2.2.cmml">ℝ</mi><mi id="S2.p2.3.m3.1.1.3.2.3" xref="S2.p2.3.m3.1.1.3.2.3.cmml">d</mi></msup><mo id="S2.p2.3.m3.1.1.3.1" stretchy="false" xref="S2.p2.3.m3.1.1.3.1.cmml">→</mo><msup id="S2.p2.3.m3.1.1.3.3" xref="S2.p2.3.m3.1.1.3.3.cmml"><mi id="S2.p2.3.m3.1.1.3.3.2" xref="S2.p2.3.m3.1.1.3.3.2.cmml">ℝ</mi><mi id="S2.p2.3.m3.1.1.3.3.3" xref="S2.p2.3.m3.1.1.3.3.3.cmml">m</mi></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p2.3.m3.1b"><apply id="S2.p2.3.m3.1.1.cmml" xref="S2.p2.3.m3.1.1"><ci id="S2.p2.3.m3.1.1.1.cmml" xref="S2.p2.3.m3.1.1.1">:</ci><ci id="S2.p2.3.m3.1.1.2.cmml" xref="S2.p2.3.m3.1.1.2">italic-ϕ</ci><apply id="S2.p2.3.m3.1.1.3.cmml" xref="S2.p2.3.m3.1.1.3"><ci id="S2.p2.3.m3.1.1.3.1.cmml" xref="S2.p2.3.m3.1.1.3.1">→</ci><apply id="S2.p2.3.m3.1.1.3.2.cmml" xref="S2.p2.3.m3.1.1.3.2"><csymbol cd="ambiguous" id="S2.p2.3.m3.1.1.3.2.1.cmml" xref="S2.p2.3.m3.1.1.3.2">superscript</csymbol><ci id="S2.p2.3.m3.1.1.3.2.2.cmml" xref="S2.p2.3.m3.1.1.3.2.2">ℝ</ci><ci id="S2.p2.3.m3.1.1.3.2.3.cmml" xref="S2.p2.3.m3.1.1.3.2.3">𝑑</ci></apply><apply id="S2.p2.3.m3.1.1.3.3.cmml" xref="S2.p2.3.m3.1.1.3.3"><csymbol cd="ambiguous" id="S2.p2.3.m3.1.1.3.3.1.cmml" xref="S2.p2.3.m3.1.1.3.3">superscript</csymbol><ci id="S2.p2.3.m3.1.1.3.3.2.cmml" xref="S2.p2.3.m3.1.1.3.3.2">ℝ</ci><ci id="S2.p2.3.m3.1.1.3.3.3.cmml" xref="S2.p2.3.m3.1.1.3.3.3">𝑚</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.3.m3.1c">\phi:\mathbb{R}^{d}\to\mathbb{R}^{m}</annotation><annotation encoding="application/x-llamapun" id="S2.p2.3.m3.1d">italic_ϕ : blackboard_R start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT → blackboard_R start_POSTSUPERSCRIPT italic_m end_POSTSUPERSCRIPT</annotation></semantics></math> with <math alttext="m\ll N" class="ltx_Math" display="inline" id="S2.p2.4.m4.1"><semantics id="S2.p2.4.m4.1a"><mrow id="S2.p2.4.m4.1.1" xref="S2.p2.4.m4.1.1.cmml"><mi id="S2.p2.4.m4.1.1.2" xref="S2.p2.4.m4.1.1.2.cmml">m</mi><mo id="S2.p2.4.m4.1.1.1" xref="S2.p2.4.m4.1.1.1.cmml">≪</mo><mi id="S2.p2.4.m4.1.1.3" xref="S2.p2.4.m4.1.1.3.cmml">N</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.p2.4.m4.1b"><apply id="S2.p2.4.m4.1.1.cmml" xref="S2.p2.4.m4.1.1"><csymbol cd="latexml" id="S2.p2.4.m4.1.1.1.cmml" xref="S2.p2.4.m4.1.1.1">much-less-than</csymbol><ci id="S2.p2.4.m4.1.1.2.cmml" xref="S2.p2.4.m4.1.1.2">𝑚</ci><ci id="S2.p2.4.m4.1.1.3.cmml" xref="S2.p2.4.m4.1.1.3">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.4.m4.1c">m\ll N</annotation><annotation encoding="application/x-llamapun" id="S2.p2.4.m4.1d">italic_m ≪ italic_N</annotation></semantics></math> and constructs the matrices <math alttext="\mathbf{\Phi}_{\mathbf{Q}}\coloneqq[\phi(\mathbf{q}_{i})]_{i=1}^{N}" class="ltx_Math" display="inline" id="S2.p2.5.m5.1"><semantics id="S2.p2.5.m5.1a"><mrow id="S2.p2.5.m5.1.1" xref="S2.p2.5.m5.1.1.cmml"><msub id="S2.p2.5.m5.1.1.3" xref="S2.p2.5.m5.1.1.3.cmml"><mi id="S2.p2.5.m5.1.1.3.2" xref="S2.p2.5.m5.1.1.3.2.cmml">𝚽</mi><mi id="S2.p2.5.m5.1.1.3.3" xref="S2.p2.5.m5.1.1.3.3.cmml">𝐐</mi></msub><mo id="S2.p2.5.m5.1.1.2" xref="S2.p2.5.m5.1.1.2.cmml">≔</mo><msubsup id="S2.p2.5.m5.1.1.1" xref="S2.p2.5.m5.1.1.1.cmml"><mrow id="S2.p2.5.m5.1.1.1.1.1.1" xref="S2.p2.5.m5.1.1.1.1.1.2.cmml"><mo id="S2.p2.5.m5.1.1.1.1.1.1.2" stretchy="false" xref="S2.p2.5.m5.1.1.1.1.1.2.1.cmml">[</mo><mrow id="S2.p2.5.m5.1.1.1.1.1.1.1" xref="S2.p2.5.m5.1.1.1.1.1.1.1.cmml"><mi id="S2.p2.5.m5.1.1.1.1.1.1.1.3" xref="S2.p2.5.m5.1.1.1.1.1.1.1.3.cmml">ϕ</mi><mo id="S2.p2.5.m5.1.1.1.1.1.1.1.2" xref="S2.p2.5.m5.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.p2.5.m5.1.1.1.1.1.1.1.1.1" xref="S2.p2.5.m5.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S2.p2.5.m5.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S2.p2.5.m5.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S2.p2.5.m5.1.1.1.1.1.1.1.1.1.1" xref="S2.p2.5.m5.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.p2.5.m5.1.1.1.1.1.1.1.1.1.1.2" xref="S2.p2.5.m5.1.1.1.1.1.1.1.1.1.1.2.cmml">𝐪</mi><mi id="S2.p2.5.m5.1.1.1.1.1.1.1.1.1.1.3" xref="S2.p2.5.m5.1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S2.p2.5.m5.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S2.p2.5.m5.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.p2.5.m5.1.1.1.1.1.1.3" stretchy="false" xref="S2.p2.5.m5.1.1.1.1.1.2.1.cmml">]</mo></mrow><mrow id="S2.p2.5.m5.1.1.1.1.3" xref="S2.p2.5.m5.1.1.1.1.3.cmml"><mi id="S2.p2.5.m5.1.1.1.1.3.2" xref="S2.p2.5.m5.1.1.1.1.3.2.cmml">i</mi><mo id="S2.p2.5.m5.1.1.1.1.3.1" xref="S2.p2.5.m5.1.1.1.1.3.1.cmml">=</mo><mn id="S2.p2.5.m5.1.1.1.1.3.3" xref="S2.p2.5.m5.1.1.1.1.3.3.cmml">1</mn></mrow><mi id="S2.p2.5.m5.1.1.1.3" xref="S2.p2.5.m5.1.1.1.3.cmml">N</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S2.p2.5.m5.1b"><apply id="S2.p2.5.m5.1.1.cmml" xref="S2.p2.5.m5.1.1"><ci id="S2.p2.5.m5.1.1.2.cmml" xref="S2.p2.5.m5.1.1.2">≔</ci><apply id="S2.p2.5.m5.1.1.3.cmml" xref="S2.p2.5.m5.1.1.3"><csymbol cd="ambiguous" id="S2.p2.5.m5.1.1.3.1.cmml" xref="S2.p2.5.m5.1.1.3">subscript</csymbol><ci id="S2.p2.5.m5.1.1.3.2.cmml" xref="S2.p2.5.m5.1.1.3.2">𝚽</ci><ci id="S2.p2.5.m5.1.1.3.3.cmml" xref="S2.p2.5.m5.1.1.3.3">𝐐</ci></apply><apply id="S2.p2.5.m5.1.1.1.cmml" xref="S2.p2.5.m5.1.1.1"><csymbol cd="ambiguous" id="S2.p2.5.m5.1.1.1.2.cmml" xref="S2.p2.5.m5.1.1.1">superscript</csymbol><apply id="S2.p2.5.m5.1.1.1.1.cmml" xref="S2.p2.5.m5.1.1.1"><csymbol cd="ambiguous" id="S2.p2.5.m5.1.1.1.1.2.cmml" xref="S2.p2.5.m5.1.1.1">subscript</csymbol><apply id="S2.p2.5.m5.1.1.1.1.1.2.cmml" xref="S2.p2.5.m5.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.p2.5.m5.1.1.1.1.1.2.1.cmml" xref="S2.p2.5.m5.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S2.p2.5.m5.1.1.1.1.1.1.1.cmml" xref="S2.p2.5.m5.1.1.1.1.1.1.1"><times id="S2.p2.5.m5.1.1.1.1.1.1.1.2.cmml" xref="S2.p2.5.m5.1.1.1.1.1.1.1.2"></times><ci id="S2.p2.5.m5.1.1.1.1.1.1.1.3.cmml" xref="S2.p2.5.m5.1.1.1.1.1.1.1.3">italic-ϕ</ci><apply id="S2.p2.5.m5.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.p2.5.m5.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.p2.5.m5.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.p2.5.m5.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.p2.5.m5.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.p2.5.m5.1.1.1.1.1.1.1.1.1.1.2">𝐪</ci><ci id="S2.p2.5.m5.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.p2.5.m5.1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply></apply><apply id="S2.p2.5.m5.1.1.1.1.3.cmml" xref="S2.p2.5.m5.1.1.1.1.3"><eq id="S2.p2.5.m5.1.1.1.1.3.1.cmml" xref="S2.p2.5.m5.1.1.1.1.3.1"></eq><ci id="S2.p2.5.m5.1.1.1.1.3.2.cmml" xref="S2.p2.5.m5.1.1.1.1.3.2">𝑖</ci><cn id="S2.p2.5.m5.1.1.1.1.3.3.cmml" type="integer" xref="S2.p2.5.m5.1.1.1.1.3.3">1</cn></apply></apply><ci id="S2.p2.5.m5.1.1.1.3.cmml" xref="S2.p2.5.m5.1.1.1.3">𝑁</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.5.m5.1c">\mathbf{\Phi}_{\mathbf{Q}}\coloneqq[\phi(\mathbf{q}_{i})]_{i=1}^{N}</annotation><annotation encoding="application/x-llamapun" id="S2.p2.5.m5.1d">bold_Φ start_POSTSUBSCRIPT bold_Q end_POSTSUBSCRIPT ≔ [ italic_ϕ ( bold_q start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) ] start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="\mathbf{\Phi}_{\mathbf{K}}\coloneqq[\phi(\mathbf{k}_{i})]_{i=1}^{N}" class="ltx_Math" display="inline" id="S2.p2.6.m6.1"><semantics id="S2.p2.6.m6.1a"><mrow id="S2.p2.6.m6.1.1" xref="S2.p2.6.m6.1.1.cmml"><msub id="S2.p2.6.m6.1.1.3" xref="S2.p2.6.m6.1.1.3.cmml"><mi id="S2.p2.6.m6.1.1.3.2" xref="S2.p2.6.m6.1.1.3.2.cmml">𝚽</mi><mi id="S2.p2.6.m6.1.1.3.3" xref="S2.p2.6.m6.1.1.3.3.cmml">𝐊</mi></msub><mo id="S2.p2.6.m6.1.1.2" xref="S2.p2.6.m6.1.1.2.cmml">≔</mo><msubsup id="S2.p2.6.m6.1.1.1" xref="S2.p2.6.m6.1.1.1.cmml"><mrow id="S2.p2.6.m6.1.1.1.1.1.1" xref="S2.p2.6.m6.1.1.1.1.1.2.cmml"><mo id="S2.p2.6.m6.1.1.1.1.1.1.2" stretchy="false" xref="S2.p2.6.m6.1.1.1.1.1.2.1.cmml">[</mo><mrow id="S2.p2.6.m6.1.1.1.1.1.1.1" xref="S2.p2.6.m6.1.1.1.1.1.1.1.cmml"><mi id="S2.p2.6.m6.1.1.1.1.1.1.1.3" xref="S2.p2.6.m6.1.1.1.1.1.1.1.3.cmml">ϕ</mi><mo id="S2.p2.6.m6.1.1.1.1.1.1.1.2" xref="S2.p2.6.m6.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.p2.6.m6.1.1.1.1.1.1.1.1.1" xref="S2.p2.6.m6.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S2.p2.6.m6.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S2.p2.6.m6.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S2.p2.6.m6.1.1.1.1.1.1.1.1.1.1" xref="S2.p2.6.m6.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.p2.6.m6.1.1.1.1.1.1.1.1.1.1.2" xref="S2.p2.6.m6.1.1.1.1.1.1.1.1.1.1.2.cmml">𝐤</mi><mi id="S2.p2.6.m6.1.1.1.1.1.1.1.1.1.1.3" xref="S2.p2.6.m6.1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S2.p2.6.m6.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S2.p2.6.m6.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.p2.6.m6.1.1.1.1.1.1.3" stretchy="false" xref="S2.p2.6.m6.1.1.1.1.1.2.1.cmml">]</mo></mrow><mrow id="S2.p2.6.m6.1.1.1.1.3" xref="S2.p2.6.m6.1.1.1.1.3.cmml"><mi id="S2.p2.6.m6.1.1.1.1.3.2" xref="S2.p2.6.m6.1.1.1.1.3.2.cmml">i</mi><mo id="S2.p2.6.m6.1.1.1.1.3.1" xref="S2.p2.6.m6.1.1.1.1.3.1.cmml">=</mo><mn id="S2.p2.6.m6.1.1.1.1.3.3" xref="S2.p2.6.m6.1.1.1.1.3.3.cmml">1</mn></mrow><mi id="S2.p2.6.m6.1.1.1.3" xref="S2.p2.6.m6.1.1.1.3.cmml">N</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S2.p2.6.m6.1b"><apply id="S2.p2.6.m6.1.1.cmml" xref="S2.p2.6.m6.1.1"><ci id="S2.p2.6.m6.1.1.2.cmml" xref="S2.p2.6.m6.1.1.2">≔</ci><apply id="S2.p2.6.m6.1.1.3.cmml" xref="S2.p2.6.m6.1.1.3"><csymbol cd="ambiguous" id="S2.p2.6.m6.1.1.3.1.cmml" xref="S2.p2.6.m6.1.1.3">subscript</csymbol><ci id="S2.p2.6.m6.1.1.3.2.cmml" xref="S2.p2.6.m6.1.1.3.2">𝚽</ci><ci id="S2.p2.6.m6.1.1.3.3.cmml" xref="S2.p2.6.m6.1.1.3.3">𝐊</ci></apply><apply id="S2.p2.6.m6.1.1.1.cmml" xref="S2.p2.6.m6.1.1.1"><csymbol cd="ambiguous" id="S2.p2.6.m6.1.1.1.2.cmml" xref="S2.p2.6.m6.1.1.1">superscript</csymbol><apply id="S2.p2.6.m6.1.1.1.1.cmml" xref="S2.p2.6.m6.1.1.1"><csymbol cd="ambiguous" id="S2.p2.6.m6.1.1.1.1.2.cmml" xref="S2.p2.6.m6.1.1.1">subscript</csymbol><apply id="S2.p2.6.m6.1.1.1.1.1.2.cmml" xref="S2.p2.6.m6.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.p2.6.m6.1.1.1.1.1.2.1.cmml" xref="S2.p2.6.m6.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S2.p2.6.m6.1.1.1.1.1.1.1.cmml" xref="S2.p2.6.m6.1.1.1.1.1.1.1"><times id="S2.p2.6.m6.1.1.1.1.1.1.1.2.cmml" xref="S2.p2.6.m6.1.1.1.1.1.1.1.2"></times><ci id="S2.p2.6.m6.1.1.1.1.1.1.1.3.cmml" xref="S2.p2.6.m6.1.1.1.1.1.1.1.3">italic-ϕ</ci><apply id="S2.p2.6.m6.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.p2.6.m6.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.p2.6.m6.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.p2.6.m6.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.p2.6.m6.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.p2.6.m6.1.1.1.1.1.1.1.1.1.1.2">𝐤</ci><ci id="S2.p2.6.m6.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.p2.6.m6.1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply></apply><apply id="S2.p2.6.m6.1.1.1.1.3.cmml" xref="S2.p2.6.m6.1.1.1.1.3"><eq id="S2.p2.6.m6.1.1.1.1.3.1.cmml" xref="S2.p2.6.m6.1.1.1.1.3.1"></eq><ci id="S2.p2.6.m6.1.1.1.1.3.2.cmml" xref="S2.p2.6.m6.1.1.1.1.3.2">𝑖</ci><cn id="S2.p2.6.m6.1.1.1.1.3.3.cmml" type="integer" xref="S2.p2.6.m6.1.1.1.1.3.3">1</cn></apply></apply><ci id="S2.p2.6.m6.1.1.1.3.cmml" xref="S2.p2.6.m6.1.1.1.3">𝑁</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.6.m6.1c">\mathbf{\Phi}_{\mathbf{K}}\coloneqq[\phi(\mathbf{k}_{i})]_{i=1}^{N}</annotation><annotation encoding="application/x-llamapun" id="S2.p2.6.m6.1d">bold_Φ start_POSTSUBSCRIPT bold_K end_POSTSUBSCRIPT ≔ [ italic_ϕ ( bold_k start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) ] start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT</annotation></semantics></math>, where <math alttext="\mathbf{\Phi}_{\mathbf{Q},\mathbf{K}}\in\mathbb{R}^{N\times m}" class="ltx_Math" display="inline" id="S2.p2.7.m7.2"><semantics id="S2.p2.7.m7.2a"><mrow id="S2.p2.7.m7.2.3" xref="S2.p2.7.m7.2.3.cmml"><msub id="S2.p2.7.m7.2.3.2" xref="S2.p2.7.m7.2.3.2.cmml"><mi id="S2.p2.7.m7.2.3.2.2" xref="S2.p2.7.m7.2.3.2.2.cmml">𝚽</mi><mrow id="S2.p2.7.m7.2.2.2.4" xref="S2.p2.7.m7.2.2.2.3.cmml"><mi id="S2.p2.7.m7.1.1.1.1" xref="S2.p2.7.m7.1.1.1.1.cmml">𝐐</mi><mo id="S2.p2.7.m7.2.2.2.4.1" xref="S2.p2.7.m7.2.2.2.3.cmml">,</mo><mi id="S2.p2.7.m7.2.2.2.2" xref="S2.p2.7.m7.2.2.2.2.cmml">𝐊</mi></mrow></msub><mo id="S2.p2.7.m7.2.3.1" xref="S2.p2.7.m7.2.3.1.cmml">∈</mo><msup id="S2.p2.7.m7.2.3.3" xref="S2.p2.7.m7.2.3.3.cmml"><mi id="S2.p2.7.m7.2.3.3.2" xref="S2.p2.7.m7.2.3.3.2.cmml">ℝ</mi><mrow id="S2.p2.7.m7.2.3.3.3" xref="S2.p2.7.m7.2.3.3.3.cmml"><mi id="S2.p2.7.m7.2.3.3.3.2" xref="S2.p2.7.m7.2.3.3.3.2.cmml">N</mi><mo id="S2.p2.7.m7.2.3.3.3.1" lspace="0.222em" rspace="0.222em" xref="S2.p2.7.m7.2.3.3.3.1.cmml">×</mo><mi id="S2.p2.7.m7.2.3.3.3.3" xref="S2.p2.7.m7.2.3.3.3.3.cmml">m</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.p2.7.m7.2b"><apply id="S2.p2.7.m7.2.3.cmml" xref="S2.p2.7.m7.2.3"><in id="S2.p2.7.m7.2.3.1.cmml" xref="S2.p2.7.m7.2.3.1"></in><apply id="S2.p2.7.m7.2.3.2.cmml" xref="S2.p2.7.m7.2.3.2"><csymbol cd="ambiguous" id="S2.p2.7.m7.2.3.2.1.cmml" xref="S2.p2.7.m7.2.3.2">subscript</csymbol><ci id="S2.p2.7.m7.2.3.2.2.cmml" xref="S2.p2.7.m7.2.3.2.2">𝚽</ci><list id="S2.p2.7.m7.2.2.2.3.cmml" xref="S2.p2.7.m7.2.2.2.4"><ci id="S2.p2.7.m7.1.1.1.1.cmml" xref="S2.p2.7.m7.1.1.1.1">𝐐</ci><ci id="S2.p2.7.m7.2.2.2.2.cmml" xref="S2.p2.7.m7.2.2.2.2">𝐊</ci></list></apply><apply id="S2.p2.7.m7.2.3.3.cmml" xref="S2.p2.7.m7.2.3.3"><csymbol cd="ambiguous" id="S2.p2.7.m7.2.3.3.1.cmml" xref="S2.p2.7.m7.2.3.3">superscript</csymbol><ci id="S2.p2.7.m7.2.3.3.2.cmml" xref="S2.p2.7.m7.2.3.3.2">ℝ</ci><apply id="S2.p2.7.m7.2.3.3.3.cmml" xref="S2.p2.7.m7.2.3.3.3"><times id="S2.p2.7.m7.2.3.3.3.1.cmml" xref="S2.p2.7.m7.2.3.3.3.1"></times><ci id="S2.p2.7.m7.2.3.3.3.2.cmml" xref="S2.p2.7.m7.2.3.3.3.2">𝑁</ci><ci id="S2.p2.7.m7.2.3.3.3.3.cmml" xref="S2.p2.7.m7.2.3.3.3.3">𝑚</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.7.m7.2c">\mathbf{\Phi}_{\mathbf{Q},\mathbf{K}}\in\mathbb{R}^{N\times m}</annotation><annotation encoding="application/x-llamapun" id="S2.p2.7.m7.2d">bold_Φ start_POSTSUBSCRIPT bold_Q , bold_K end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_N × italic_m end_POSTSUPERSCRIPT</annotation></semantics></math>.
One then defines <math alttext="\mathcal{K}_{\textrm{LR}}(\mathbf{Q},\mathbf{K})\coloneqq\mathbf{\Phi}_{%
\mathbf{Q}}\mathbf{\Phi}_{\mathbf{K}}^{\top}" class="ltx_Math" display="inline" id="S2.p2.8.m8.2"><semantics id="S2.p2.8.m8.2a"><mrow id="S2.p2.8.m8.2.3" xref="S2.p2.8.m8.2.3.cmml"><mrow id="S2.p2.8.m8.2.3.2" xref="S2.p2.8.m8.2.3.2.cmml"><msub id="S2.p2.8.m8.2.3.2.2" xref="S2.p2.8.m8.2.3.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p2.8.m8.2.3.2.2.2" xref="S2.p2.8.m8.2.3.2.2.2.cmml">𝒦</mi><mtext id="S2.p2.8.m8.2.3.2.2.3" xref="S2.p2.8.m8.2.3.2.2.3a.cmml">LR</mtext></msub><mo id="S2.p2.8.m8.2.3.2.1" xref="S2.p2.8.m8.2.3.2.1.cmml">⁢</mo><mrow id="S2.p2.8.m8.2.3.2.3.2" xref="S2.p2.8.m8.2.3.2.3.1.cmml"><mo id="S2.p2.8.m8.2.3.2.3.2.1" stretchy="false" xref="S2.p2.8.m8.2.3.2.3.1.cmml">(</mo><mi id="S2.p2.8.m8.1.1" xref="S2.p2.8.m8.1.1.cmml">𝐐</mi><mo id="S2.p2.8.m8.2.3.2.3.2.2" xref="S2.p2.8.m8.2.3.2.3.1.cmml">,</mo><mi id="S2.p2.8.m8.2.2" xref="S2.p2.8.m8.2.2.cmml">𝐊</mi><mo id="S2.p2.8.m8.2.3.2.3.2.3" stretchy="false" xref="S2.p2.8.m8.2.3.2.3.1.cmml">)</mo></mrow></mrow><mo id="S2.p2.8.m8.2.3.1" xref="S2.p2.8.m8.2.3.1.cmml">≔</mo><mrow id="S2.p2.8.m8.2.3.3" xref="S2.p2.8.m8.2.3.3.cmml"><msub id="S2.p2.8.m8.2.3.3.2" xref="S2.p2.8.m8.2.3.3.2.cmml"><mi id="S2.p2.8.m8.2.3.3.2.2" xref="S2.p2.8.m8.2.3.3.2.2.cmml">𝚽</mi><mi id="S2.p2.8.m8.2.3.3.2.3" xref="S2.p2.8.m8.2.3.3.2.3.cmml">𝐐</mi></msub><mo id="S2.p2.8.m8.2.3.3.1" xref="S2.p2.8.m8.2.3.3.1.cmml">⁢</mo><msubsup id="S2.p2.8.m8.2.3.3.3" xref="S2.p2.8.m8.2.3.3.3.cmml"><mi id="S2.p2.8.m8.2.3.3.3.2.2" xref="S2.p2.8.m8.2.3.3.3.2.2.cmml">𝚽</mi><mi id="S2.p2.8.m8.2.3.3.3.2.3" xref="S2.p2.8.m8.2.3.3.3.2.3.cmml">𝐊</mi><mo id="S2.p2.8.m8.2.3.3.3.3" xref="S2.p2.8.m8.2.3.3.3.3.cmml">⊤</mo></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p2.8.m8.2b"><apply id="S2.p2.8.m8.2.3.cmml" xref="S2.p2.8.m8.2.3"><ci id="S2.p2.8.m8.2.3.1.cmml" xref="S2.p2.8.m8.2.3.1">≔</ci><apply id="S2.p2.8.m8.2.3.2.cmml" xref="S2.p2.8.m8.2.3.2"><times id="S2.p2.8.m8.2.3.2.1.cmml" xref="S2.p2.8.m8.2.3.2.1"></times><apply id="S2.p2.8.m8.2.3.2.2.cmml" xref="S2.p2.8.m8.2.3.2.2"><csymbol cd="ambiguous" id="S2.p2.8.m8.2.3.2.2.1.cmml" xref="S2.p2.8.m8.2.3.2.2">subscript</csymbol><ci id="S2.p2.8.m8.2.3.2.2.2.cmml" xref="S2.p2.8.m8.2.3.2.2.2">𝒦</ci><ci id="S2.p2.8.m8.2.3.2.2.3a.cmml" xref="S2.p2.8.m8.2.3.2.2.3"><mtext id="S2.p2.8.m8.2.3.2.2.3.cmml" mathsize="70%" xref="S2.p2.8.m8.2.3.2.2.3">LR</mtext></ci></apply><interval closure="open" id="S2.p2.8.m8.2.3.2.3.1.cmml" xref="S2.p2.8.m8.2.3.2.3.2"><ci id="S2.p2.8.m8.1.1.cmml" xref="S2.p2.8.m8.1.1">𝐐</ci><ci id="S2.p2.8.m8.2.2.cmml" xref="S2.p2.8.m8.2.2">𝐊</ci></interval></apply><apply id="S2.p2.8.m8.2.3.3.cmml" xref="S2.p2.8.m8.2.3.3"><times id="S2.p2.8.m8.2.3.3.1.cmml" xref="S2.p2.8.m8.2.3.3.1"></times><apply id="S2.p2.8.m8.2.3.3.2.cmml" xref="S2.p2.8.m8.2.3.3.2"><csymbol cd="ambiguous" id="S2.p2.8.m8.2.3.3.2.1.cmml" xref="S2.p2.8.m8.2.3.3.2">subscript</csymbol><ci id="S2.p2.8.m8.2.3.3.2.2.cmml" xref="S2.p2.8.m8.2.3.3.2.2">𝚽</ci><ci id="S2.p2.8.m8.2.3.3.2.3.cmml" xref="S2.p2.8.m8.2.3.3.2.3">𝐐</ci></apply><apply id="S2.p2.8.m8.2.3.3.3.cmml" xref="S2.p2.8.m8.2.3.3.3"><csymbol cd="ambiguous" id="S2.p2.8.m8.2.3.3.3.1.cmml" xref="S2.p2.8.m8.2.3.3.3">superscript</csymbol><apply id="S2.p2.8.m8.2.3.3.3.2.cmml" xref="S2.p2.8.m8.2.3.3.3"><csymbol cd="ambiguous" id="S2.p2.8.m8.2.3.3.3.2.1.cmml" xref="S2.p2.8.m8.2.3.3.3">subscript</csymbol><ci id="S2.p2.8.m8.2.3.3.3.2.2.cmml" xref="S2.p2.8.m8.2.3.3.3.2.2">𝚽</ci><ci id="S2.p2.8.m8.2.3.3.3.2.3.cmml" xref="S2.p2.8.m8.2.3.3.3.2.3">𝐊</ci></apply><csymbol cd="latexml" id="S2.p2.8.m8.2.3.3.3.3.cmml" xref="S2.p2.8.m8.2.3.3.3.3">top</csymbol></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.8.m8.2c">\mathcal{K}_{\textrm{LR}}(\mathbf{Q},\mathbf{K})\coloneqq\mathbf{\Phi}_{%
\mathbf{Q}}\mathbf{\Phi}_{\mathbf{K}}^{\top}</annotation><annotation encoding="application/x-llamapun" id="S2.p2.8.m8.2d">caligraphic_K start_POSTSUBSCRIPT LR end_POSTSUBSCRIPT ( bold_Q , bold_K ) ≔ bold_Φ start_POSTSUBSCRIPT bold_Q end_POSTSUBSCRIPT bold_Φ start_POSTSUBSCRIPT bold_K end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT</annotation></semantics></math> and computes</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equation ltx_eqn_table" id="S2.E3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\textrm{Att}_{\textrm{LR}}(\mathbf{Q},\mathbf{K},\mathbf{V})\coloneqq\mathbf{D%
}^{-1}\left(\mathbf{\Phi}_{\mathbf{Q}}\left(\mathbf{\Phi}_{\mathbf{K}}^{\top}%
\mathbf{V}\right)\right),\quad\mathbf{D}\coloneqq\mathbf{\Phi}_{\mathbf{Q}}%
\left(\mathbf{\Phi}_{\mathbf{K}}^{\top}\mathbf{1}_{N}\right)," class="ltx_Math" display="block" id="S2.E3.m1.4"><semantics id="S2.E3.m1.4a"><mrow id="S2.E3.m1.4.4.1"><mrow id="S2.E3.m1.4.4.1.1.2" xref="S2.E3.m1.4.4.1.1.3.cmml"><mrow id="S2.E3.m1.4.4.1.1.1.1" xref="S2.E3.m1.4.4.1.1.1.1.cmml"><mrow id="S2.E3.m1.4.4.1.1.1.1.3" xref="S2.E3.m1.4.4.1.1.1.1.3.cmml"><msub id="S2.E3.m1.4.4.1.1.1.1.3.2" xref="S2.E3.m1.4.4.1.1.1.1.3.2.cmml"><mtext id="S2.E3.m1.4.4.1.1.1.1.3.2.2" xref="S2.E3.m1.4.4.1.1.1.1.3.2.2a.cmml">Att</mtext><mtext id="S2.E3.m1.4.4.1.1.1.1.3.2.3" xref="S2.E3.m1.4.4.1.1.1.1.3.2.3a.cmml">LR</mtext></msub><mo id="S2.E3.m1.4.4.1.1.1.1.3.1" xref="S2.E3.m1.4.4.1.1.1.1.3.1.cmml">⁢</mo><mrow id="S2.E3.m1.4.4.1.1.1.1.3.3.2" xref="S2.E3.m1.4.4.1.1.1.1.3.3.1.cmml"><mo id="S2.E3.m1.4.4.1.1.1.1.3.3.2.1" stretchy="false" xref="S2.E3.m1.4.4.1.1.1.1.3.3.1.cmml">(</mo><mi id="S2.E3.m1.1.1" xref="S2.E3.m1.1.1.cmml">𝐐</mi><mo id="S2.E3.m1.4.4.1.1.1.1.3.3.2.2" xref="S2.E3.m1.4.4.1.1.1.1.3.3.1.cmml">,</mo><mi id="S2.E3.m1.2.2" xref="S2.E3.m1.2.2.cmml">𝐊</mi><mo id="S2.E3.m1.4.4.1.1.1.1.3.3.2.3" xref="S2.E3.m1.4.4.1.1.1.1.3.3.1.cmml">,</mo><mi id="S2.E3.m1.3.3" xref="S2.E3.m1.3.3.cmml">𝐕</mi><mo id="S2.E3.m1.4.4.1.1.1.1.3.3.2.4" stretchy="false" xref="S2.E3.m1.4.4.1.1.1.1.3.3.1.cmml">)</mo></mrow></mrow><mo id="S2.E3.m1.4.4.1.1.1.1.2" xref="S2.E3.m1.4.4.1.1.1.1.2.cmml">≔</mo><mrow id="S2.E3.m1.4.4.1.1.1.1.1" xref="S2.E3.m1.4.4.1.1.1.1.1.cmml"><msup id="S2.E3.m1.4.4.1.1.1.1.1.3" xref="S2.E3.m1.4.4.1.1.1.1.1.3.cmml"><mi id="S2.E3.m1.4.4.1.1.1.1.1.3.2" xref="S2.E3.m1.4.4.1.1.1.1.1.3.2.cmml">𝐃</mi><mrow id="S2.E3.m1.4.4.1.1.1.1.1.3.3" xref="S2.E3.m1.4.4.1.1.1.1.1.3.3.cmml"><mo id="S2.E3.m1.4.4.1.1.1.1.1.3.3a" xref="S2.E3.m1.4.4.1.1.1.1.1.3.3.cmml">−</mo><mn id="S2.E3.m1.4.4.1.1.1.1.1.3.3.2" xref="S2.E3.m1.4.4.1.1.1.1.1.3.3.2.cmml">1</mn></mrow></msup><mo id="S2.E3.m1.4.4.1.1.1.1.1.2" xref="S2.E3.m1.4.4.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E3.m1.4.4.1.1.1.1.1.1.1" xref="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.cmml"><mo id="S2.E3.m1.4.4.1.1.1.1.1.1.1.2" xref="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E3.m1.4.4.1.1.1.1.1.1.1.1" xref="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.cmml"><msub id="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.3" xref="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.3.cmml"><mi id="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.3.2" xref="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.3.2.cmml">𝚽</mi><mi id="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.3.3" xref="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.3.3.cmml">𝐐</mi></msub><mo id="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.2" xref="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.1.1" xref="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.cmml"><msubsup id="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.2.2" xref="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml">𝚽</mi><mi id="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.2.3" xref="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml">𝐊</mi><mo id="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">⊤</mo></msubsup><mo id="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.3.cmml">𝐕</mi></mrow><mo id="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E3.m1.4.4.1.1.1.1.1.1.1.3" xref="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E3.m1.4.4.1.1.2.3" rspace="1.167em" xref="S2.E3.m1.4.4.1.1.3a.cmml">,</mo><mrow id="S2.E3.m1.4.4.1.1.2.2" xref="S2.E3.m1.4.4.1.1.2.2.cmml"><mi id="S2.E3.m1.4.4.1.1.2.2.3" xref="S2.E3.m1.4.4.1.1.2.2.3.cmml">𝐃</mi><mo id="S2.E3.m1.4.4.1.1.2.2.2" xref="S2.E3.m1.4.4.1.1.2.2.2.cmml">≔</mo><mrow id="S2.E3.m1.4.4.1.1.2.2.1" xref="S2.E3.m1.4.4.1.1.2.2.1.cmml"><msub id="S2.E3.m1.4.4.1.1.2.2.1.3" xref="S2.E3.m1.4.4.1.1.2.2.1.3.cmml"><mi id="S2.E3.m1.4.4.1.1.2.2.1.3.2" xref="S2.E3.m1.4.4.1.1.2.2.1.3.2.cmml">𝚽</mi><mi id="S2.E3.m1.4.4.1.1.2.2.1.3.3" xref="S2.E3.m1.4.4.1.1.2.2.1.3.3.cmml">𝐐</mi></msub><mo id="S2.E3.m1.4.4.1.1.2.2.1.2" xref="S2.E3.m1.4.4.1.1.2.2.1.2.cmml">⁢</mo><mrow id="S2.E3.m1.4.4.1.1.2.2.1.1.1" xref="S2.E3.m1.4.4.1.1.2.2.1.1.1.1.cmml"><mo id="S2.E3.m1.4.4.1.1.2.2.1.1.1.2" xref="S2.E3.m1.4.4.1.1.2.2.1.1.1.1.cmml">(</mo><mrow id="S2.E3.m1.4.4.1.1.2.2.1.1.1.1" xref="S2.E3.m1.4.4.1.1.2.2.1.1.1.1.cmml"><msubsup id="S2.E3.m1.4.4.1.1.2.2.1.1.1.1.2" xref="S2.E3.m1.4.4.1.1.2.2.1.1.1.1.2.cmml"><mi id="S2.E3.m1.4.4.1.1.2.2.1.1.1.1.2.2.2" xref="S2.E3.m1.4.4.1.1.2.2.1.1.1.1.2.2.2.cmml">𝚽</mi><mi id="S2.E3.m1.4.4.1.1.2.2.1.1.1.1.2.2.3" xref="S2.E3.m1.4.4.1.1.2.2.1.1.1.1.2.2.3.cmml">𝐊</mi><mo id="S2.E3.m1.4.4.1.1.2.2.1.1.1.1.2.3" xref="S2.E3.m1.4.4.1.1.2.2.1.1.1.1.2.3.cmml">⊤</mo></msubsup><mo id="S2.E3.m1.4.4.1.1.2.2.1.1.1.1.1" xref="S2.E3.m1.4.4.1.1.2.2.1.1.1.1.1.cmml">⁢</mo><msub id="S2.E3.m1.4.4.1.1.2.2.1.1.1.1.3" xref="S2.E3.m1.4.4.1.1.2.2.1.1.1.1.3.cmml"><mn id="S2.E3.m1.4.4.1.1.2.2.1.1.1.1.3.2" xref="S2.E3.m1.4.4.1.1.2.2.1.1.1.1.3.2.cmml">𝟏</mn><mi id="S2.E3.m1.4.4.1.1.2.2.1.1.1.1.3.3" xref="S2.E3.m1.4.4.1.1.2.2.1.1.1.1.3.3.cmml">N</mi></msub></mrow><mo id="S2.E3.m1.4.4.1.1.2.2.1.1.1.3" xref="S2.E3.m1.4.4.1.1.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S2.E3.m1.4.4.1.2">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E3.m1.4b"><apply id="S2.E3.m1.4.4.1.1.3.cmml" xref="S2.E3.m1.4.4.1.1.2"><csymbol cd="ambiguous" id="S2.E3.m1.4.4.1.1.3a.cmml" xref="S2.E3.m1.4.4.1.1.2.3">formulae-sequence</csymbol><apply id="S2.E3.m1.4.4.1.1.1.1.cmml" xref="S2.E3.m1.4.4.1.1.1.1"><ci id="S2.E3.m1.4.4.1.1.1.1.2.cmml" xref="S2.E3.m1.4.4.1.1.1.1.2">≔</ci><apply id="S2.E3.m1.4.4.1.1.1.1.3.cmml" xref="S2.E3.m1.4.4.1.1.1.1.3"><times id="S2.E3.m1.4.4.1.1.1.1.3.1.cmml" xref="S2.E3.m1.4.4.1.1.1.1.3.1"></times><apply id="S2.E3.m1.4.4.1.1.1.1.3.2.cmml" xref="S2.E3.m1.4.4.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S2.E3.m1.4.4.1.1.1.1.3.2.1.cmml" xref="S2.E3.m1.4.4.1.1.1.1.3.2">subscript</csymbol><ci id="S2.E3.m1.4.4.1.1.1.1.3.2.2a.cmml" xref="S2.E3.m1.4.4.1.1.1.1.3.2.2"><mtext id="S2.E3.m1.4.4.1.1.1.1.3.2.2.cmml" xref="S2.E3.m1.4.4.1.1.1.1.3.2.2">Att</mtext></ci><ci id="S2.E3.m1.4.4.1.1.1.1.3.2.3a.cmml" xref="S2.E3.m1.4.4.1.1.1.1.3.2.3"><mtext id="S2.E3.m1.4.4.1.1.1.1.3.2.3.cmml" mathsize="70%" xref="S2.E3.m1.4.4.1.1.1.1.3.2.3">LR</mtext></ci></apply><vector id="S2.E3.m1.4.4.1.1.1.1.3.3.1.cmml" xref="S2.E3.m1.4.4.1.1.1.1.3.3.2"><ci id="S2.E3.m1.1.1.cmml" xref="S2.E3.m1.1.1">𝐐</ci><ci id="S2.E3.m1.2.2.cmml" xref="S2.E3.m1.2.2">𝐊</ci><ci id="S2.E3.m1.3.3.cmml" xref="S2.E3.m1.3.3">𝐕</ci></vector></apply><apply id="S2.E3.m1.4.4.1.1.1.1.1.cmml" xref="S2.E3.m1.4.4.1.1.1.1.1"><times id="S2.E3.m1.4.4.1.1.1.1.1.2.cmml" xref="S2.E3.m1.4.4.1.1.1.1.1.2"></times><apply id="S2.E3.m1.4.4.1.1.1.1.1.3.cmml" xref="S2.E3.m1.4.4.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E3.m1.4.4.1.1.1.1.1.3.1.cmml" xref="S2.E3.m1.4.4.1.1.1.1.1.3">superscript</csymbol><ci id="S2.E3.m1.4.4.1.1.1.1.1.3.2.cmml" xref="S2.E3.m1.4.4.1.1.1.1.1.3.2">𝐃</ci><apply id="S2.E3.m1.4.4.1.1.1.1.1.3.3.cmml" xref="S2.E3.m1.4.4.1.1.1.1.1.3.3"><minus id="S2.E3.m1.4.4.1.1.1.1.1.3.3.1.cmml" xref="S2.E3.m1.4.4.1.1.1.1.1.3.3"></minus><cn id="S2.E3.m1.4.4.1.1.1.1.1.3.3.2.cmml" type="integer" xref="S2.E3.m1.4.4.1.1.1.1.1.3.3.2">1</cn></apply></apply><apply id="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.4.4.1.1.1.1.1.1.1"><times id="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.2"></times><apply id="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.3.2">𝚽</ci><ci id="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.3.3.cmml" xref="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.3.3">𝐐</ci></apply><apply id="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.1.1"><times id="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1"></times><apply id="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2">superscript</csymbol><apply id="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.2.2">𝚽</ci><ci id="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.2.3">𝐊</ci></apply><csymbol cd="latexml" id="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.3">top</csymbol></apply><ci id="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.3">𝐕</ci></apply></apply></apply></apply><apply id="S2.E3.m1.4.4.1.1.2.2.cmml" xref="S2.E3.m1.4.4.1.1.2.2"><ci id="S2.E3.m1.4.4.1.1.2.2.2.cmml" xref="S2.E3.m1.4.4.1.1.2.2.2">≔</ci><ci id="S2.E3.m1.4.4.1.1.2.2.3.cmml" xref="S2.E3.m1.4.4.1.1.2.2.3">𝐃</ci><apply id="S2.E3.m1.4.4.1.1.2.2.1.cmml" xref="S2.E3.m1.4.4.1.1.2.2.1"><times id="S2.E3.m1.4.4.1.1.2.2.1.2.cmml" xref="S2.E3.m1.4.4.1.1.2.2.1.2"></times><apply id="S2.E3.m1.4.4.1.1.2.2.1.3.cmml" xref="S2.E3.m1.4.4.1.1.2.2.1.3"><csymbol cd="ambiguous" id="S2.E3.m1.4.4.1.1.2.2.1.3.1.cmml" xref="S2.E3.m1.4.4.1.1.2.2.1.3">subscript</csymbol><ci id="S2.E3.m1.4.4.1.1.2.2.1.3.2.cmml" xref="S2.E3.m1.4.4.1.1.2.2.1.3.2">𝚽</ci><ci id="S2.E3.m1.4.4.1.1.2.2.1.3.3.cmml" xref="S2.E3.m1.4.4.1.1.2.2.1.3.3">𝐐</ci></apply><apply id="S2.E3.m1.4.4.1.1.2.2.1.1.1.1.cmml" xref="S2.E3.m1.4.4.1.1.2.2.1.1.1"><times id="S2.E3.m1.4.4.1.1.2.2.1.1.1.1.1.cmml" xref="S2.E3.m1.4.4.1.1.2.2.1.1.1.1.1"></times><apply id="S2.E3.m1.4.4.1.1.2.2.1.1.1.1.2.cmml" xref="S2.E3.m1.4.4.1.1.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E3.m1.4.4.1.1.2.2.1.1.1.1.2.1.cmml" xref="S2.E3.m1.4.4.1.1.2.2.1.1.1.1.2">superscript</csymbol><apply id="S2.E3.m1.4.4.1.1.2.2.1.1.1.1.2.2.cmml" xref="S2.E3.m1.4.4.1.1.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E3.m1.4.4.1.1.2.2.1.1.1.1.2.2.1.cmml" xref="S2.E3.m1.4.4.1.1.2.2.1.1.1.1.2">subscript</csymbol><ci id="S2.E3.m1.4.4.1.1.2.2.1.1.1.1.2.2.2.cmml" xref="S2.E3.m1.4.4.1.1.2.2.1.1.1.1.2.2.2">𝚽</ci><ci id="S2.E3.m1.4.4.1.1.2.2.1.1.1.1.2.2.3.cmml" xref="S2.E3.m1.4.4.1.1.2.2.1.1.1.1.2.2.3">𝐊</ci></apply><csymbol cd="latexml" id="S2.E3.m1.4.4.1.1.2.2.1.1.1.1.2.3.cmml" xref="S2.E3.m1.4.4.1.1.2.2.1.1.1.1.2.3">top</csymbol></apply><apply id="S2.E3.m1.4.4.1.1.2.2.1.1.1.1.3.cmml" xref="S2.E3.m1.4.4.1.1.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E3.m1.4.4.1.1.2.2.1.1.1.1.3.1.cmml" xref="S2.E3.m1.4.4.1.1.2.2.1.1.1.1.3">subscript</csymbol><cn id="S2.E3.m1.4.4.1.1.2.2.1.1.1.1.3.2.cmml" type="integer" xref="S2.E3.m1.4.4.1.1.2.2.1.1.1.1.3.2">1</cn><ci id="S2.E3.m1.4.4.1.1.2.2.1.1.1.1.3.3.cmml" xref="S2.E3.m1.4.4.1.1.2.2.1.1.1.1.3.3">𝑁</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E3.m1.4c">\textrm{Att}_{\textrm{LR}}(\mathbf{Q},\mathbf{K},\mathbf{V})\coloneqq\mathbf{D%
}^{-1}\left(\mathbf{\Phi}_{\mathbf{Q}}\left(\mathbf{\Phi}_{\mathbf{K}}^{\top}%
\mathbf{V}\right)\right),\quad\mathbf{D}\coloneqq\mathbf{\Phi}_{\mathbf{Q}}%
\left(\mathbf{\Phi}_{\mathbf{K}}^{\top}\mathbf{1}_{N}\right),</annotation><annotation encoding="application/x-llamapun" id="S2.E3.m1.4d">Att start_POSTSUBSCRIPT LR end_POSTSUBSCRIPT ( bold_Q , bold_K , bold_V ) ≔ bold_D start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ( bold_Φ start_POSTSUBSCRIPT bold_Q end_POSTSUBSCRIPT ( bold_Φ start_POSTSUBSCRIPT bold_K end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT bold_V ) ) , bold_D ≔ bold_Φ start_POSTSUBSCRIPT bold_Q end_POSTSUBSCRIPT ( bold_Φ start_POSTSUBSCRIPT bold_K end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT bold_1 start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.p2.11">where the parentheses show the order of computation.
Exploiting associativity, the time complexity is reduced to <math alttext="\mathcal{O}(Nmd)" class="ltx_Math" display="inline" id="S2.p2.9.m1.1"><semantics id="S2.p2.9.m1.1a"><mrow id="S2.p2.9.m1.1.1" xref="S2.p2.9.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p2.9.m1.1.1.3" xref="S2.p2.9.m1.1.1.3.cmml">𝒪</mi><mo id="S2.p2.9.m1.1.1.2" xref="S2.p2.9.m1.1.1.2.cmml">⁢</mo><mrow id="S2.p2.9.m1.1.1.1.1" xref="S2.p2.9.m1.1.1.1.1.1.cmml"><mo id="S2.p2.9.m1.1.1.1.1.2" stretchy="false" xref="S2.p2.9.m1.1.1.1.1.1.cmml">(</mo><mrow id="S2.p2.9.m1.1.1.1.1.1" xref="S2.p2.9.m1.1.1.1.1.1.cmml"><mi id="S2.p2.9.m1.1.1.1.1.1.2" xref="S2.p2.9.m1.1.1.1.1.1.2.cmml">N</mi><mo id="S2.p2.9.m1.1.1.1.1.1.1" xref="S2.p2.9.m1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S2.p2.9.m1.1.1.1.1.1.3" xref="S2.p2.9.m1.1.1.1.1.1.3.cmml">m</mi><mo id="S2.p2.9.m1.1.1.1.1.1.1a" xref="S2.p2.9.m1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S2.p2.9.m1.1.1.1.1.1.4" xref="S2.p2.9.m1.1.1.1.1.1.4.cmml">d</mi></mrow><mo id="S2.p2.9.m1.1.1.1.1.3" stretchy="false" xref="S2.p2.9.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p2.9.m1.1b"><apply id="S2.p2.9.m1.1.1.cmml" xref="S2.p2.9.m1.1.1"><times id="S2.p2.9.m1.1.1.2.cmml" xref="S2.p2.9.m1.1.1.2"></times><ci id="S2.p2.9.m1.1.1.3.cmml" xref="S2.p2.9.m1.1.1.3">𝒪</ci><apply id="S2.p2.9.m1.1.1.1.1.1.cmml" xref="S2.p2.9.m1.1.1.1.1"><times id="S2.p2.9.m1.1.1.1.1.1.1.cmml" xref="S2.p2.9.m1.1.1.1.1.1.1"></times><ci id="S2.p2.9.m1.1.1.1.1.1.2.cmml" xref="S2.p2.9.m1.1.1.1.1.1.2">𝑁</ci><ci id="S2.p2.9.m1.1.1.1.1.1.3.cmml" xref="S2.p2.9.m1.1.1.1.1.1.3">𝑚</ci><ci id="S2.p2.9.m1.1.1.1.1.1.4.cmml" xref="S2.p2.9.m1.1.1.1.1.1.4">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.9.m1.1c">\mathcal{O}(Nmd)</annotation><annotation encoding="application/x-llamapun" id="S2.p2.9.m1.1d">caligraphic_O ( italic_N italic_m italic_d )</annotation></semantics></math>, albeit usually with some sacrifice in performance compared to full-rank softmax attention.
Different choices of feature maps <math alttext="\phi" class="ltx_Math" display="inline" id="S2.p2.10.m2.1"><semantics id="S2.p2.10.m2.1a"><mi id="S2.p2.10.m2.1.1" xref="S2.p2.10.m2.1.1.cmml">ϕ</mi><annotation-xml encoding="MathML-Content" id="S2.p2.10.m2.1b"><ci id="S2.p2.10.m2.1.1.cmml" xref="S2.p2.10.m2.1.1">italic-ϕ</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.10.m2.1c">\phi</annotation><annotation encoding="application/x-llamapun" id="S2.p2.10.m2.1d">italic_ϕ</annotation></semantics></math> exist; for example, one can take a <em class="ltx_emph ltx_font_italic" id="S2.p2.11.1">random feature map</em> that provides a Monte Carlo estimate of the softmax kernel <cite class="ltx_cite ltx_citemacro_citep">(Performer; Choromanski et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#bib.bib5" title="">2020</a>; <a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#bib.bib6" title="">2021</a>; Likhosherstov et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#bib.bib20" title="">2024</a>)</cite>, or a deterministic nonlinearity like <math alttext="\textrm{elu}(x)+x" class="ltx_Math" display="inline" id="S2.p2.11.m3.1"><semantics id="S2.p2.11.m3.1a"><mrow id="S2.p2.11.m3.1.2" xref="S2.p2.11.m3.1.2.cmml"><mrow id="S2.p2.11.m3.1.2.2" xref="S2.p2.11.m3.1.2.2.cmml"><mtext id="S2.p2.11.m3.1.2.2.2" xref="S2.p2.11.m3.1.2.2.2a.cmml">elu</mtext><mo id="S2.p2.11.m3.1.2.2.1" xref="S2.p2.11.m3.1.2.2.1.cmml">⁢</mo><mrow id="S2.p2.11.m3.1.2.2.3.2" xref="S2.p2.11.m3.1.2.2.cmml"><mo id="S2.p2.11.m3.1.2.2.3.2.1" stretchy="false" xref="S2.p2.11.m3.1.2.2.cmml">(</mo><mi id="S2.p2.11.m3.1.1" xref="S2.p2.11.m3.1.1.cmml">x</mi><mo id="S2.p2.11.m3.1.2.2.3.2.2" stretchy="false" xref="S2.p2.11.m3.1.2.2.cmml">)</mo></mrow></mrow><mo id="S2.p2.11.m3.1.2.1" xref="S2.p2.11.m3.1.2.1.cmml">+</mo><mi id="S2.p2.11.m3.1.2.3" xref="S2.p2.11.m3.1.2.3.cmml">x</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.p2.11.m3.1b"><apply id="S2.p2.11.m3.1.2.cmml" xref="S2.p2.11.m3.1.2"><plus id="S2.p2.11.m3.1.2.1.cmml" xref="S2.p2.11.m3.1.2.1"></plus><apply id="S2.p2.11.m3.1.2.2.cmml" xref="S2.p2.11.m3.1.2.2"><times id="S2.p2.11.m3.1.2.2.1.cmml" xref="S2.p2.11.m3.1.2.2.1"></times><ci id="S2.p2.11.m3.1.2.2.2a.cmml" xref="S2.p2.11.m3.1.2.2.2"><mtext id="S2.p2.11.m3.1.2.2.2.cmml" xref="S2.p2.11.m3.1.2.2.2">elu</mtext></ci><ci id="S2.p2.11.m3.1.1.cmml" xref="S2.p2.11.m3.1.1">𝑥</ci></apply><ci id="S2.p2.11.m3.1.2.3.cmml" xref="S2.p2.11.m3.1.2.3">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.11.m3.1c">\textrm{elu}(x)+x</annotation><annotation encoding="application/x-llamapun" id="S2.p2.11.m3.1d">elu ( italic_x ) + italic_x</annotation></semantics></math> <cite class="ltx_cite ltx_citemacro_citep">(linear transformer; Katharopoulos et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#bib.bib16" title="">2020</a>)</cite>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S2.p3">
<p class="ltx_p" id="S2.p3.9"><span class="ltx_text ltx_font_bold" id="S2.p3.9.1">Efficient masking of low-rank attention.</span>
As Eq.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#S2.E3" title="In 2 Preliminaries ‣ Linear Transformer Topological Masking with Graph Random Features"><span class="ltx_text ltx_ref_tag">3</span></a> suggests, low-rank attention derives its speed from avoiding computing <math alttext="\mathbf{A}=\mathcal{K}_{\textrm{LR}}(\mathbf{Q},\mathbf{K})" class="ltx_Math" display="inline" id="S2.p3.1.m1.2"><semantics id="S2.p3.1.m1.2a"><mrow id="S2.p3.1.m1.2.3" xref="S2.p3.1.m1.2.3.cmml"><mi id="S2.p3.1.m1.2.3.2" xref="S2.p3.1.m1.2.3.2.cmml">𝐀</mi><mo id="S2.p3.1.m1.2.3.1" xref="S2.p3.1.m1.2.3.1.cmml">=</mo><mrow id="S2.p3.1.m1.2.3.3" xref="S2.p3.1.m1.2.3.3.cmml"><msub id="S2.p3.1.m1.2.3.3.2" xref="S2.p3.1.m1.2.3.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p3.1.m1.2.3.3.2.2" xref="S2.p3.1.m1.2.3.3.2.2.cmml">𝒦</mi><mtext id="S2.p3.1.m1.2.3.3.2.3" xref="S2.p3.1.m1.2.3.3.2.3a.cmml">LR</mtext></msub><mo id="S2.p3.1.m1.2.3.3.1" xref="S2.p3.1.m1.2.3.3.1.cmml">⁢</mo><mrow id="S2.p3.1.m1.2.3.3.3.2" xref="S2.p3.1.m1.2.3.3.3.1.cmml"><mo id="S2.p3.1.m1.2.3.3.3.2.1" stretchy="false" xref="S2.p3.1.m1.2.3.3.3.1.cmml">(</mo><mi id="S2.p3.1.m1.1.1" xref="S2.p3.1.m1.1.1.cmml">𝐐</mi><mo id="S2.p3.1.m1.2.3.3.3.2.2" xref="S2.p3.1.m1.2.3.3.3.1.cmml">,</mo><mi id="S2.p3.1.m1.2.2" xref="S2.p3.1.m1.2.2.cmml">𝐊</mi><mo id="S2.p3.1.m1.2.3.3.3.2.3" stretchy="false" xref="S2.p3.1.m1.2.3.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p3.1.m1.2b"><apply id="S2.p3.1.m1.2.3.cmml" xref="S2.p3.1.m1.2.3"><eq id="S2.p3.1.m1.2.3.1.cmml" xref="S2.p3.1.m1.2.3.1"></eq><ci id="S2.p3.1.m1.2.3.2.cmml" xref="S2.p3.1.m1.2.3.2">𝐀</ci><apply id="S2.p3.1.m1.2.3.3.cmml" xref="S2.p3.1.m1.2.3.3"><times id="S2.p3.1.m1.2.3.3.1.cmml" xref="S2.p3.1.m1.2.3.3.1"></times><apply id="S2.p3.1.m1.2.3.3.2.cmml" xref="S2.p3.1.m1.2.3.3.2"><csymbol cd="ambiguous" id="S2.p3.1.m1.2.3.3.2.1.cmml" xref="S2.p3.1.m1.2.3.3.2">subscript</csymbol><ci id="S2.p3.1.m1.2.3.3.2.2.cmml" xref="S2.p3.1.m1.2.3.3.2.2">𝒦</ci><ci id="S2.p3.1.m1.2.3.3.2.3a.cmml" xref="S2.p3.1.m1.2.3.3.2.3"><mtext id="S2.p3.1.m1.2.3.3.2.3.cmml" mathsize="70%" xref="S2.p3.1.m1.2.3.3.2.3">LR</mtext></ci></apply><interval closure="open" id="S2.p3.1.m1.2.3.3.3.1.cmml" xref="S2.p3.1.m1.2.3.3.3.2"><ci id="S2.p3.1.m1.1.1.cmml" xref="S2.p3.1.m1.1.1">𝐐</ci><ci id="S2.p3.1.m1.2.2.cmml" xref="S2.p3.1.m1.2.2">𝐊</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.1.m1.2c">\mathbf{A}=\mathcal{K}_{\textrm{LR}}(\mathbf{Q},\mathbf{K})</annotation><annotation encoding="application/x-llamapun" id="S2.p3.1.m1.2d">bold_A = caligraphic_K start_POSTSUBSCRIPT LR end_POSTSUBSCRIPT ( bold_Q , bold_K )</annotation></semantics></math> explicitly, preferring to evaluate faster products like <math alttext="\mathbf{\Phi}_{\mathbf{K}}^{\top}\mathbf{V}" class="ltx_Math" display="inline" id="S2.p3.2.m2.1"><semantics id="S2.p3.2.m2.1a"><mrow id="S2.p3.2.m2.1.1" xref="S2.p3.2.m2.1.1.cmml"><msubsup id="S2.p3.2.m2.1.1.2" xref="S2.p3.2.m2.1.1.2.cmml"><mi id="S2.p3.2.m2.1.1.2.2.2" xref="S2.p3.2.m2.1.1.2.2.2.cmml">𝚽</mi><mi id="S2.p3.2.m2.1.1.2.2.3" xref="S2.p3.2.m2.1.1.2.2.3.cmml">𝐊</mi><mo id="S2.p3.2.m2.1.1.2.3" xref="S2.p3.2.m2.1.1.2.3.cmml">⊤</mo></msubsup><mo id="S2.p3.2.m2.1.1.1" xref="S2.p3.2.m2.1.1.1.cmml">⁢</mo><mi id="S2.p3.2.m2.1.1.3" xref="S2.p3.2.m2.1.1.3.cmml">𝐕</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.p3.2.m2.1b"><apply id="S2.p3.2.m2.1.1.cmml" xref="S2.p3.2.m2.1.1"><times id="S2.p3.2.m2.1.1.1.cmml" xref="S2.p3.2.m2.1.1.1"></times><apply id="S2.p3.2.m2.1.1.2.cmml" xref="S2.p3.2.m2.1.1.2"><csymbol cd="ambiguous" id="S2.p3.2.m2.1.1.2.1.cmml" xref="S2.p3.2.m2.1.1.2">superscript</csymbol><apply id="S2.p3.2.m2.1.1.2.2.cmml" xref="S2.p3.2.m2.1.1.2"><csymbol cd="ambiguous" id="S2.p3.2.m2.1.1.2.2.1.cmml" xref="S2.p3.2.m2.1.1.2">subscript</csymbol><ci id="S2.p3.2.m2.1.1.2.2.2.cmml" xref="S2.p3.2.m2.1.1.2.2.2">𝚽</ci><ci id="S2.p3.2.m2.1.1.2.2.3.cmml" xref="S2.p3.2.m2.1.1.2.2.3">𝐊</ci></apply><csymbol cd="latexml" id="S2.p3.2.m2.1.1.2.3.cmml" xref="S2.p3.2.m2.1.1.2.3">top</csymbol></apply><ci id="S2.p3.2.m2.1.1.3.cmml" xref="S2.p3.2.m2.1.1.3">𝐕</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.2.m2.1c">\mathbf{\Phi}_{\mathbf{K}}^{\top}\mathbf{V}</annotation><annotation encoding="application/x-llamapun" id="S2.p3.2.m2.1d">bold_Φ start_POSTSUBSCRIPT bold_K end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT bold_V</annotation></semantics></math> and <math alttext="\mathbf{\Phi}_{\mathbf{K}}^{\top}\mathbf{1}_{N}" class="ltx_Math" display="inline" id="S2.p3.3.m3.1"><semantics id="S2.p3.3.m3.1a"><mrow id="S2.p3.3.m3.1.1" xref="S2.p3.3.m3.1.1.cmml"><msubsup id="S2.p3.3.m3.1.1.2" xref="S2.p3.3.m3.1.1.2.cmml"><mi id="S2.p3.3.m3.1.1.2.2.2" xref="S2.p3.3.m3.1.1.2.2.2.cmml">𝚽</mi><mi id="S2.p3.3.m3.1.1.2.2.3" xref="S2.p3.3.m3.1.1.2.2.3.cmml">𝐊</mi><mo id="S2.p3.3.m3.1.1.2.3" xref="S2.p3.3.m3.1.1.2.3.cmml">⊤</mo></msubsup><mo id="S2.p3.3.m3.1.1.1" xref="S2.p3.3.m3.1.1.1.cmml">⁢</mo><msub id="S2.p3.3.m3.1.1.3" xref="S2.p3.3.m3.1.1.3.cmml"><mn id="S2.p3.3.m3.1.1.3.2" xref="S2.p3.3.m3.1.1.3.2.cmml">𝟏</mn><mi id="S2.p3.3.m3.1.1.3.3" xref="S2.p3.3.m3.1.1.3.3.cmml">N</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S2.p3.3.m3.1b"><apply id="S2.p3.3.m3.1.1.cmml" xref="S2.p3.3.m3.1.1"><times id="S2.p3.3.m3.1.1.1.cmml" xref="S2.p3.3.m3.1.1.1"></times><apply id="S2.p3.3.m3.1.1.2.cmml" xref="S2.p3.3.m3.1.1.2"><csymbol cd="ambiguous" id="S2.p3.3.m3.1.1.2.1.cmml" xref="S2.p3.3.m3.1.1.2">superscript</csymbol><apply id="S2.p3.3.m3.1.1.2.2.cmml" xref="S2.p3.3.m3.1.1.2"><csymbol cd="ambiguous" id="S2.p3.3.m3.1.1.2.2.1.cmml" xref="S2.p3.3.m3.1.1.2">subscript</csymbol><ci id="S2.p3.3.m3.1.1.2.2.2.cmml" xref="S2.p3.3.m3.1.1.2.2.2">𝚽</ci><ci id="S2.p3.3.m3.1.1.2.2.3.cmml" xref="S2.p3.3.m3.1.1.2.2.3">𝐊</ci></apply><csymbol cd="latexml" id="S2.p3.3.m3.1.1.2.3.cmml" xref="S2.p3.3.m3.1.1.2.3">top</csymbol></apply><apply id="S2.p3.3.m3.1.1.3.cmml" xref="S2.p3.3.m3.1.1.3"><csymbol cd="ambiguous" id="S2.p3.3.m3.1.1.3.1.cmml" xref="S2.p3.3.m3.1.1.3">subscript</csymbol><cn id="S2.p3.3.m3.1.1.3.2.cmml" type="integer" xref="S2.p3.3.m3.1.1.3.2">1</cn><ci id="S2.p3.3.m3.1.1.3.3.cmml" xref="S2.p3.3.m3.1.1.3.3">𝑁</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.3.m3.1c">\mathbf{\Phi}_{\mathbf{K}}^{\top}\mathbf{1}_{N}</annotation><annotation encoding="application/x-llamapun" id="S2.p3.3.m3.1d">bold_Φ start_POSTSUBSCRIPT bold_K end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT bold_1 start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT</annotation></semantics></math> first and use them to weight the query features <math alttext="\mathbf{\Phi}_{\mathbf{Q}}" class="ltx_Math" display="inline" id="S2.p3.4.m4.1"><semantics id="S2.p3.4.m4.1a"><msub id="S2.p3.4.m4.1.1" xref="S2.p3.4.m4.1.1.cmml"><mi id="S2.p3.4.m4.1.1.2" xref="S2.p3.4.m4.1.1.2.cmml">𝚽</mi><mi id="S2.p3.4.m4.1.1.3" xref="S2.p3.4.m4.1.1.3.cmml">𝐐</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p3.4.m4.1b"><apply id="S2.p3.4.m4.1.1.cmml" xref="S2.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S2.p3.4.m4.1.1.1.cmml" xref="S2.p3.4.m4.1.1">subscript</csymbol><ci id="S2.p3.4.m4.1.1.2.cmml" xref="S2.p3.4.m4.1.1.2">𝚽</ci><ci id="S2.p3.4.m4.1.1.3.cmml" xref="S2.p3.4.m4.1.1.3">𝐐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.4.m4.1c">\mathbf{\Phi}_{\mathbf{Q}}</annotation><annotation encoding="application/x-llamapun" id="S2.p3.4.m4.1d">bold_Φ start_POSTSUBSCRIPT bold_Q end_POSTSUBSCRIPT</annotation></semantics></math>.
This makes the direct Hadamard product implementation of masking in Eq.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#S2.E2" title="In 2 Preliminaries ‣ Linear Transformer Topological Masking with Graph Random Features"><span class="ltx_text ltx_ref_tag">2</span></a> impossible: if the matrix <math alttext="\mathbf{A}" class="ltx_Math" display="inline" id="S2.p3.5.m5.1"><semantics id="S2.p3.5.m5.1a"><mi id="S2.p3.5.m5.1.1" xref="S2.p3.5.m5.1.1.cmml">𝐀</mi><annotation-xml encoding="MathML-Content" id="S2.p3.5.m5.1b"><ci id="S2.p3.5.m5.1.1.cmml" xref="S2.p3.5.m5.1.1">𝐀</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.5.m5.1c">\mathbf{A}</annotation><annotation encoding="application/x-llamapun" id="S2.p3.5.m5.1d">bold_A</annotation></semantics></math> is never explicitly materialised in memory, one cannot pointwise multiply each of its elements.
Algorithms have been proposed to mask <em class="ltx_emph ltx_font_italic" id="S2.p3.9.2">implicitly</em> (without instantiating <math alttext="\mathbf{A}" class="ltx_Math" display="inline" id="S2.p3.6.m6.1"><semantics id="S2.p3.6.m6.1a"><mi id="S2.p3.6.m6.1.1" xref="S2.p3.6.m6.1.1.cmml">𝐀</mi><annotation-xml encoding="MathML-Content" id="S2.p3.6.m6.1b"><ci id="S2.p3.6.m6.1.1.cmml" xref="S2.p3.6.m6.1.1">𝐀</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.6.m6.1c">\mathbf{A}</annotation><annotation encoding="application/x-llamapun" id="S2.p3.6.m6.1d">bold_A</annotation></semantics></math> or <math alttext="\mathbf{M}" class="ltx_Math" display="inline" id="S2.p3.7.m7.1"><semantics id="S2.p3.7.m7.1a"><mi id="S2.p3.7.m7.1.1" xref="S2.p3.7.m7.1.1.cmml">𝐌</mi><annotation-xml encoding="MathML-Content" id="S2.p3.7.m7.1b"><ci id="S2.p3.7.m7.1.1.cmml" xref="S2.p3.7.m7.1.1">𝐌</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.7.m7.1c">\mathbf{M}</annotation><annotation encoding="application/x-llamapun" id="S2.p3.7.m7.1d">bold_M</annotation></semantics></math>) in very simple cases, e.g.&nbsp;causal masking <cite class="ltx_cite ltx_citemacro_citep">(Choromanski et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#bib.bib5" title="">2020</a>)</cite> or one-dimensional RPE <cite class="ltx_cite ltx_citemacro_citep">(Liutkus et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#bib.bib21" title="">2021</a>; Luo et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#bib.bib23" title="">2021</a>)</cite>.
Subquadratic implicit masking is also possible when <math alttext="\mathbf{M}" class="ltx_Math" display="inline" id="S2.p3.8.m8.1"><semantics id="S2.p3.8.m8.1a"><mi id="S2.p3.8.m8.1.1" xref="S2.p3.8.m8.1.1.cmml">𝐌</mi><annotation-xml encoding="MathML-Content" id="S2.p3.8.m8.1b"><ci id="S2.p3.8.m8.1.1.cmml" xref="S2.p3.8.m8.1.1">𝐌</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.8.m8.1c">\mathbf{M}</annotation><annotation encoding="application/x-llamapun" id="S2.p3.8.m8.1d">bold_M</annotation></semantics></math> is very structured: e.g.&nbsp;functions of shortest path distance on grid graphs and trees <cite class="ltx_cite ltx_citemacro_citep">(Choromanski et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#bib.bib7" title="">2022</a>)</cite>, or of the degrees of the pair of input nodes <cite class="ltx_cite ltx_citemacro_citep">(Chen et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#bib.bib4" title="">2024</a>)</cite>.
See App.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#A2" title="Appendix B Extended discussion on related work ‣ Linear Transformer Topological Masking with Graph Random Features"><span class="ltx_text ltx_ref_tag">B</span></a> for a review.
However, an <math alttext="\mathcal{O}(N)" class="ltx_Math" display="inline" id="S2.p3.9.m9.1"><semantics id="S2.p3.9.m9.1a"><mrow id="S2.p3.9.m9.1.2" xref="S2.p3.9.m9.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p3.9.m9.1.2.2" xref="S2.p3.9.m9.1.2.2.cmml">𝒪</mi><mo id="S2.p3.9.m9.1.2.1" xref="S2.p3.9.m9.1.2.1.cmml">⁢</mo><mrow id="S2.p3.9.m9.1.2.3.2" xref="S2.p3.9.m9.1.2.cmml"><mo id="S2.p3.9.m9.1.2.3.2.1" stretchy="false" xref="S2.p3.9.m9.1.2.cmml">(</mo><mi id="S2.p3.9.m9.1.1" xref="S2.p3.9.m9.1.1.cmml">N</mi><mo id="S2.p3.9.m9.1.2.3.2.2" stretchy="false" xref="S2.p3.9.m9.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p3.9.m9.1b"><apply id="S2.p3.9.m9.1.2.cmml" xref="S2.p3.9.m9.1.2"><times id="S2.p3.9.m9.1.2.1.cmml" xref="S2.p3.9.m9.1.2.1"></times><ci id="S2.p3.9.m9.1.2.2.cmml" xref="S2.p3.9.m9.1.2.2">𝒪</ci><ci id="S2.p3.9.m9.1.1.cmml" xref="S2.p3.9.m9.1.1">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.9.m9.1c">\mathcal{O}(N)</annotation><annotation encoding="application/x-llamapun" id="S2.p3.9.m9.1d">caligraphic_O ( italic_N )</annotation></semantics></math> algorithm capable of masking with flexible functions on general graphs has, until now, remained out of reach.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S2.p4">
<p class="ltx_p" id="S2.p4.4"><span class="ltx_text ltx_font_bold" id="S2.p4.4.1">Remainder of manuscript.</span> In <span class="ltx_text ltx_font_bold" id="S2.p4.4.2">Sec.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#S3.SS1" title="3.1 Graph node kernels as topological masks ‣ 3 Towards linear topological masking ‣ Linear Transformer Topological Masking with Graph Random Features"><span class="ltx_text ltx_ref_tag">3.1</span></a></span> we parameterise topological masks <math alttext="\mathbf{M}(\mathcal{G})" class="ltx_Math" display="inline" id="S2.p4.1.m1.1"><semantics id="S2.p4.1.m1.1a"><mrow id="S2.p4.1.m1.1.2" xref="S2.p4.1.m1.1.2.cmml"><mi id="S2.p4.1.m1.1.2.2" xref="S2.p4.1.m1.1.2.2.cmml">𝐌</mi><mo id="S2.p4.1.m1.1.2.1" xref="S2.p4.1.m1.1.2.1.cmml">⁢</mo><mrow id="S2.p4.1.m1.1.2.3.2" xref="S2.p4.1.m1.1.2.cmml"><mo id="S2.p4.1.m1.1.2.3.2.1" stretchy="false" xref="S2.p4.1.m1.1.2.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S2.p4.1.m1.1.1" xref="S2.p4.1.m1.1.1.cmml">𝒢</mi><mo id="S2.p4.1.m1.1.2.3.2.2" stretchy="false" xref="S2.p4.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p4.1.m1.1b"><apply id="S2.p4.1.m1.1.2.cmml" xref="S2.p4.1.m1.1.2"><times id="S2.p4.1.m1.1.2.1.cmml" xref="S2.p4.1.m1.1.2.1"></times><ci id="S2.p4.1.m1.1.2.2.cmml" xref="S2.p4.1.m1.1.2.2">𝐌</ci><ci id="S2.p4.1.m1.1.1.cmml" xref="S2.p4.1.m1.1.1">𝒢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p4.1.m1.1c">\mathbf{M}(\mathcal{G})</annotation><annotation encoding="application/x-llamapun" id="S2.p4.1.m1.1d">bold_M ( caligraphic_G )</annotation></semantics></math> as learnable functions of weighted adjacency matrices, which incorporates strong structural inductive bias into attention and boosts performance.
<span class="ltx_text ltx_font_bold" id="S2.p4.4.3">Sec.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#S3.SS2" title="3.2 Implicit masking with graph features ‣ 3 Towards linear topological masking ‣ Linear Transformer Topological Masking with Graph Random Features"><span class="ltx_text ltx_ref_tag">3.2</span></a></span> shows how this can be implemented <em class="ltx_emph ltx_font_italic" id="S2.p4.4.4">implicitly</em>, without instantiating <math alttext="\mathbf{A}" class="ltx_Math" display="inline" id="S2.p4.2.m2.1"><semantics id="S2.p4.2.m2.1a"><mi id="S2.p4.2.m2.1.1" xref="S2.p4.2.m2.1.1.cmml">𝐀</mi><annotation-xml encoding="MathML-Content" id="S2.p4.2.m2.1b"><ci id="S2.p4.2.m2.1.1.cmml" xref="S2.p4.2.m2.1.1">𝐀</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p4.2.m2.1c">\mathbf{A}</annotation><annotation encoding="application/x-llamapun" id="S2.p4.2.m2.1d">bold_A</annotation></semantics></math> or <math alttext="\mathbf{M}" class="ltx_Math" display="inline" id="S2.p4.3.m3.1"><semantics id="S2.p4.3.m3.1a"><mi id="S2.p4.3.m3.1.1" xref="S2.p4.3.m3.1.1.cmml">𝐌</mi><annotation-xml encoding="MathML-Content" id="S2.p4.3.m3.1b"><ci id="S2.p4.3.m3.1.1.cmml" xref="S2.p4.3.m3.1.1">𝐌</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p4.3.m3.1c">\mathbf{M}</annotation><annotation encoding="application/x-llamapun" id="S2.p4.3.m3.1d">bold_M</annotation></semantics></math> in memory.
<span class="ltx_text ltx_font_bold" id="S2.p4.4.5">Sec.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#S3.SS3" title="3.3 Faster implicit masking with graph random features ‣ 3 Towards linear topological masking ‣ Linear Transformer Topological Masking with Graph Random Features"><span class="ltx_text ltx_ref_tag">3.3</span></a></span> offers a faster stochastic alternative using GRFs, which we prove is <math alttext="\mathcal{O}(N)" class="ltx_Math" display="inline" id="S2.p4.4.m4.1"><semantics id="S2.p4.4.m4.1a"><mrow id="S2.p4.4.m4.1.2" xref="S2.p4.4.m4.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p4.4.m4.1.2.2" xref="S2.p4.4.m4.1.2.2.cmml">𝒪</mi><mo id="S2.p4.4.m4.1.2.1" xref="S2.p4.4.m4.1.2.1.cmml">⁢</mo><mrow id="S2.p4.4.m4.1.2.3.2" xref="S2.p4.4.m4.1.2.cmml"><mo id="S2.p4.4.m4.1.2.3.2.1" stretchy="false" xref="S2.p4.4.m4.1.2.cmml">(</mo><mi id="S2.p4.4.m4.1.1" xref="S2.p4.4.m4.1.1.cmml">N</mi><mo id="S2.p4.4.m4.1.2.3.2.2" stretchy="false" xref="S2.p4.4.m4.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p4.4.m4.1b"><apply id="S2.p4.4.m4.1.2.cmml" xref="S2.p4.4.m4.1.2"><times id="S2.p4.4.m4.1.2.1.cmml" xref="S2.p4.4.m4.1.2.1"></times><ci id="S2.p4.4.m4.1.2.2.cmml" xref="S2.p4.4.m4.1.2.2">𝒪</ci><ci id="S2.p4.4.m4.1.1.cmml" xref="S2.p4.4.m4.1.1">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p4.4.m4.1c">\mathcal{O}(N)</annotation><annotation encoding="application/x-llamapun" id="S2.p4.4.m4.1d">caligraphic_O ( italic_N )</annotation></semantics></math> time and space complexity.
<span class="ltx_text ltx_font_bold" id="S2.p4.4.6">Sec.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#S4" title="4 Experiments ‣ Linear Transformer Topological Masking with Graph Random Features"><span class="ltx_text ltx_ref_tag">4</span></a></span> gives experimental evaluations across data modalities, including images and point clouds.
The <span class="ltx_text ltx_font_bold" id="S2.p4.4.7">Appendices</span> present proofs and extra details too long for the main text, and extended discussion about related work.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Towards linear topological masking</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S3.p1">
<p class="ltx_p" id="S3.p1.9">This section details our main results.
Consider an undirected graph <math alttext="\mathcal{G}(\mathcal{N},\mathcal{E})" class="ltx_Math" display="inline" id="S3.p1.1.m1.2"><semantics id="S3.p1.1.m1.2a"><mrow id="S3.p1.1.m1.2.3" xref="S3.p1.1.m1.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p1.1.m1.2.3.2" xref="S3.p1.1.m1.2.3.2.cmml">𝒢</mi><mo id="S3.p1.1.m1.2.3.1" xref="S3.p1.1.m1.2.3.1.cmml">⁢</mo><mrow id="S3.p1.1.m1.2.3.3.2" xref="S3.p1.1.m1.2.3.3.1.cmml"><mo id="S3.p1.1.m1.2.3.3.2.1" stretchy="false" xref="S3.p1.1.m1.2.3.3.1.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S3.p1.1.m1.1.1" xref="S3.p1.1.m1.1.1.cmml">𝒩</mi><mo id="S3.p1.1.m1.2.3.3.2.2" xref="S3.p1.1.m1.2.3.3.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S3.p1.1.m1.2.2" xref="S3.p1.1.m1.2.2.cmml">ℰ</mi><mo id="S3.p1.1.m1.2.3.3.2.3" stretchy="false" xref="S3.p1.1.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.1.m1.2b"><apply id="S3.p1.1.m1.2.3.cmml" xref="S3.p1.1.m1.2.3"><times id="S3.p1.1.m1.2.3.1.cmml" xref="S3.p1.1.m1.2.3.1"></times><ci id="S3.p1.1.m1.2.3.2.cmml" xref="S3.p1.1.m1.2.3.2">𝒢</ci><interval closure="open" id="S3.p1.1.m1.2.3.3.1.cmml" xref="S3.p1.1.m1.2.3.3.2"><ci id="S3.p1.1.m1.1.1.cmml" xref="S3.p1.1.m1.1.1">𝒩</ci><ci id="S3.p1.1.m1.2.2.cmml" xref="S3.p1.1.m1.2.2">ℰ</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.1.m1.2c">\mathcal{G}(\mathcal{N},\mathcal{E})</annotation><annotation encoding="application/x-llamapun" id="S3.p1.1.m1.2d">caligraphic_G ( caligraphic_N , caligraphic_E )</annotation></semantics></math> where <math alttext="\mathcal{N}\coloneqq\{v_{1},...,v_{N}\}" class="ltx_Math" display="inline" id="S3.p1.2.m2.3"><semantics id="S3.p1.2.m2.3a"><mrow id="S3.p1.2.m2.3.3" xref="S3.p1.2.m2.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p1.2.m2.3.3.4" xref="S3.p1.2.m2.3.3.4.cmml">𝒩</mi><mo id="S3.p1.2.m2.3.3.3" xref="S3.p1.2.m2.3.3.3.cmml">≔</mo><mrow id="S3.p1.2.m2.3.3.2.2" xref="S3.p1.2.m2.3.3.2.3.cmml"><mo id="S3.p1.2.m2.3.3.2.2.3" stretchy="false" xref="S3.p1.2.m2.3.3.2.3.cmml">{</mo><msub id="S3.p1.2.m2.2.2.1.1.1" xref="S3.p1.2.m2.2.2.1.1.1.cmml"><mi id="S3.p1.2.m2.2.2.1.1.1.2" xref="S3.p1.2.m2.2.2.1.1.1.2.cmml">v</mi><mn id="S3.p1.2.m2.2.2.1.1.1.3" xref="S3.p1.2.m2.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.p1.2.m2.3.3.2.2.4" xref="S3.p1.2.m2.3.3.2.3.cmml">,</mo><mi id="S3.p1.2.m2.1.1" mathvariant="normal" xref="S3.p1.2.m2.1.1.cmml">…</mi><mo id="S3.p1.2.m2.3.3.2.2.5" xref="S3.p1.2.m2.3.3.2.3.cmml">,</mo><msub id="S3.p1.2.m2.3.3.2.2.2" xref="S3.p1.2.m2.3.3.2.2.2.cmml"><mi id="S3.p1.2.m2.3.3.2.2.2.2" xref="S3.p1.2.m2.3.3.2.2.2.2.cmml">v</mi><mi id="S3.p1.2.m2.3.3.2.2.2.3" xref="S3.p1.2.m2.3.3.2.2.2.3.cmml">N</mi></msub><mo id="S3.p1.2.m2.3.3.2.2.6" stretchy="false" xref="S3.p1.2.m2.3.3.2.3.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.2.m2.3b"><apply id="S3.p1.2.m2.3.3.cmml" xref="S3.p1.2.m2.3.3"><ci id="S3.p1.2.m2.3.3.3.cmml" xref="S3.p1.2.m2.3.3.3">≔</ci><ci id="S3.p1.2.m2.3.3.4.cmml" xref="S3.p1.2.m2.3.3.4">𝒩</ci><set id="S3.p1.2.m2.3.3.2.3.cmml" xref="S3.p1.2.m2.3.3.2.2"><apply id="S3.p1.2.m2.2.2.1.1.1.cmml" xref="S3.p1.2.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.p1.2.m2.2.2.1.1.1.1.cmml" xref="S3.p1.2.m2.2.2.1.1.1">subscript</csymbol><ci id="S3.p1.2.m2.2.2.1.1.1.2.cmml" xref="S3.p1.2.m2.2.2.1.1.1.2">𝑣</ci><cn id="S3.p1.2.m2.2.2.1.1.1.3.cmml" type="integer" xref="S3.p1.2.m2.2.2.1.1.1.3">1</cn></apply><ci id="S3.p1.2.m2.1.1.cmml" xref="S3.p1.2.m2.1.1">…</ci><apply id="S3.p1.2.m2.3.3.2.2.2.cmml" xref="S3.p1.2.m2.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.p1.2.m2.3.3.2.2.2.1.cmml" xref="S3.p1.2.m2.3.3.2.2.2">subscript</csymbol><ci id="S3.p1.2.m2.3.3.2.2.2.2.cmml" xref="S3.p1.2.m2.3.3.2.2.2.2">𝑣</ci><ci id="S3.p1.2.m2.3.3.2.2.2.3.cmml" xref="S3.p1.2.m2.3.3.2.2.2.3">𝑁</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.2.m2.3c">\mathcal{N}\coloneqq\{v_{1},...,v_{N}\}</annotation><annotation encoding="application/x-llamapun" id="S3.p1.2.m2.3d">caligraphic_N ≔ { italic_v start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_v start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT }</annotation></semantics></math> is the set of nodes and <math alttext="\mathcal{E}" class="ltx_Math" display="inline" id="S3.p1.3.m3.1"><semantics id="S3.p1.3.m3.1a"><mi class="ltx_font_mathcaligraphic" id="S3.p1.3.m3.1.1" xref="S3.p1.3.m3.1.1.cmml">ℰ</mi><annotation-xml encoding="MathML-Content" id="S3.p1.3.m3.1b"><ci id="S3.p1.3.m3.1.1.cmml" xref="S3.p1.3.m3.1.1">ℰ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.3.m3.1c">\mathcal{E}</annotation><annotation encoding="application/x-llamapun" id="S3.p1.3.m3.1d">caligraphic_E</annotation></semantics></math> is the set of edges, with <math alttext="(v_{i},v_{j})\in\mathcal{E}" class="ltx_Math" display="inline" id="S3.p1.4.m4.2"><semantics id="S3.p1.4.m4.2a"><mrow id="S3.p1.4.m4.2.2" xref="S3.p1.4.m4.2.2.cmml"><mrow id="S3.p1.4.m4.2.2.2.2" xref="S3.p1.4.m4.2.2.2.3.cmml"><mo id="S3.p1.4.m4.2.2.2.2.3" stretchy="false" xref="S3.p1.4.m4.2.2.2.3.cmml">(</mo><msub id="S3.p1.4.m4.1.1.1.1.1" xref="S3.p1.4.m4.1.1.1.1.1.cmml"><mi id="S3.p1.4.m4.1.1.1.1.1.2" xref="S3.p1.4.m4.1.1.1.1.1.2.cmml">v</mi><mi id="S3.p1.4.m4.1.1.1.1.1.3" xref="S3.p1.4.m4.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.p1.4.m4.2.2.2.2.4" xref="S3.p1.4.m4.2.2.2.3.cmml">,</mo><msub id="S3.p1.4.m4.2.2.2.2.2" xref="S3.p1.4.m4.2.2.2.2.2.cmml"><mi id="S3.p1.4.m4.2.2.2.2.2.2" xref="S3.p1.4.m4.2.2.2.2.2.2.cmml">v</mi><mi id="S3.p1.4.m4.2.2.2.2.2.3" xref="S3.p1.4.m4.2.2.2.2.2.3.cmml">j</mi></msub><mo id="S3.p1.4.m4.2.2.2.2.5" stretchy="false" xref="S3.p1.4.m4.2.2.2.3.cmml">)</mo></mrow><mo id="S3.p1.4.m4.2.2.3" xref="S3.p1.4.m4.2.2.3.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.p1.4.m4.2.2.4" xref="S3.p1.4.m4.2.2.4.cmml">ℰ</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.4.m4.2b"><apply id="S3.p1.4.m4.2.2.cmml" xref="S3.p1.4.m4.2.2"><in id="S3.p1.4.m4.2.2.3.cmml" xref="S3.p1.4.m4.2.2.3"></in><interval closure="open" id="S3.p1.4.m4.2.2.2.3.cmml" xref="S3.p1.4.m4.2.2.2.2"><apply id="S3.p1.4.m4.1.1.1.1.1.cmml" xref="S3.p1.4.m4.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.p1.4.m4.1.1.1.1.1.1.cmml" xref="S3.p1.4.m4.1.1.1.1.1">subscript</csymbol><ci id="S3.p1.4.m4.1.1.1.1.1.2.cmml" xref="S3.p1.4.m4.1.1.1.1.1.2">𝑣</ci><ci id="S3.p1.4.m4.1.1.1.1.1.3.cmml" xref="S3.p1.4.m4.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.p1.4.m4.2.2.2.2.2.cmml" xref="S3.p1.4.m4.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.p1.4.m4.2.2.2.2.2.1.cmml" xref="S3.p1.4.m4.2.2.2.2.2">subscript</csymbol><ci id="S3.p1.4.m4.2.2.2.2.2.2.cmml" xref="S3.p1.4.m4.2.2.2.2.2.2">𝑣</ci><ci id="S3.p1.4.m4.2.2.2.2.2.3.cmml" xref="S3.p1.4.m4.2.2.2.2.2.3">𝑗</ci></apply></interval><ci id="S3.p1.4.m4.2.2.4.cmml" xref="S3.p1.4.m4.2.2.4">ℰ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.4.m4.2c">(v_{i},v_{j})\in\mathcal{E}</annotation><annotation encoding="application/x-llamapun" id="S3.p1.4.m4.2d">( italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) ∈ caligraphic_E</annotation></semantics></math> if and only if there exists an edge between <math alttext="v_{i}" class="ltx_Math" display="inline" id="S3.p1.5.m5.1"><semantics id="S3.p1.5.m5.1a"><msub id="S3.p1.5.m5.1.1" xref="S3.p1.5.m5.1.1.cmml"><mi id="S3.p1.5.m5.1.1.2" xref="S3.p1.5.m5.1.1.2.cmml">v</mi><mi id="S3.p1.5.m5.1.1.3" xref="S3.p1.5.m5.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p1.5.m5.1b"><apply id="S3.p1.5.m5.1.1.cmml" xref="S3.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.p1.5.m5.1.1.1.cmml" xref="S3.p1.5.m5.1.1">subscript</csymbol><ci id="S3.p1.5.m5.1.1.2.cmml" xref="S3.p1.5.m5.1.1.2">𝑣</ci><ci id="S3.p1.5.m5.1.1.3.cmml" xref="S3.p1.5.m5.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.5.m5.1c">v_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.p1.5.m5.1d">italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="v_{j}" class="ltx_Math" display="inline" id="S3.p1.6.m6.1"><semantics id="S3.p1.6.m6.1a"><msub id="S3.p1.6.m6.1.1" xref="S3.p1.6.m6.1.1.cmml"><mi id="S3.p1.6.m6.1.1.2" xref="S3.p1.6.m6.1.1.2.cmml">v</mi><mi id="S3.p1.6.m6.1.1.3" xref="S3.p1.6.m6.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p1.6.m6.1b"><apply id="S3.p1.6.m6.1.1.cmml" xref="S3.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S3.p1.6.m6.1.1.1.cmml" xref="S3.p1.6.m6.1.1">subscript</csymbol><ci id="S3.p1.6.m6.1.1.2.cmml" xref="S3.p1.6.m6.1.1.2">𝑣</ci><ci id="S3.p1.6.m6.1.1.3.cmml" xref="S3.p1.6.m6.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.6.m6.1c">v_{j}</annotation><annotation encoding="application/x-llamapun" id="S3.p1.6.m6.1d">italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> in <math alttext="\mathcal{G}" class="ltx_Math" display="inline" id="S3.p1.7.m7.1"><semantics id="S3.p1.7.m7.1a"><mi class="ltx_font_mathcaligraphic" id="S3.p1.7.m7.1.1" xref="S3.p1.7.m7.1.1.cmml">𝒢</mi><annotation-xml encoding="MathML-Content" id="S3.p1.7.m7.1b"><ci id="S3.p1.7.m7.1.1.cmml" xref="S3.p1.7.m7.1.1">𝒢</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.7.m7.1c">\mathcal{G}</annotation><annotation encoding="application/x-llamapun" id="S3.p1.7.m7.1d">caligraphic_G</annotation></semantics></math>.
The size of the graph <math alttext="N" class="ltx_Math" display="inline" id="S3.p1.8.m8.1"><semantics id="S3.p1.8.m8.1a"><mi id="S3.p1.8.m8.1.1" xref="S3.p1.8.m8.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.p1.8.m8.1b"><ci id="S3.p1.8.m8.1.1.cmml" xref="S3.p1.8.m8.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.8.m8.1c">N</annotation><annotation encoding="application/x-llamapun" id="S3.p1.8.m8.1d">italic_N</annotation></semantics></math> corresponds to the number of tokens.
Denote by <math alttext="\mathbf{M}(\mathcal{G})\in\mathbb{R}^{N\times N}" class="ltx_Math" display="inline" id="S3.p1.9.m9.1"><semantics id="S3.p1.9.m9.1a"><mrow id="S3.p1.9.m9.1.2" xref="S3.p1.9.m9.1.2.cmml"><mrow id="S3.p1.9.m9.1.2.2" xref="S3.p1.9.m9.1.2.2.cmml"><mi id="S3.p1.9.m9.1.2.2.2" xref="S3.p1.9.m9.1.2.2.2.cmml">𝐌</mi><mo id="S3.p1.9.m9.1.2.2.1" xref="S3.p1.9.m9.1.2.2.1.cmml">⁢</mo><mrow id="S3.p1.9.m9.1.2.2.3.2" xref="S3.p1.9.m9.1.2.2.cmml"><mo id="S3.p1.9.m9.1.2.2.3.2.1" stretchy="false" xref="S3.p1.9.m9.1.2.2.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S3.p1.9.m9.1.1" xref="S3.p1.9.m9.1.1.cmml">𝒢</mi><mo id="S3.p1.9.m9.1.2.2.3.2.2" stretchy="false" xref="S3.p1.9.m9.1.2.2.cmml">)</mo></mrow></mrow><mo id="S3.p1.9.m9.1.2.1" xref="S3.p1.9.m9.1.2.1.cmml">∈</mo><msup id="S3.p1.9.m9.1.2.3" xref="S3.p1.9.m9.1.2.3.cmml"><mi id="S3.p1.9.m9.1.2.3.2" xref="S3.p1.9.m9.1.2.3.2.cmml">ℝ</mi><mrow id="S3.p1.9.m9.1.2.3.3" xref="S3.p1.9.m9.1.2.3.3.cmml"><mi id="S3.p1.9.m9.1.2.3.3.2" xref="S3.p1.9.m9.1.2.3.3.2.cmml">N</mi><mo id="S3.p1.9.m9.1.2.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.p1.9.m9.1.2.3.3.1.cmml">×</mo><mi id="S3.p1.9.m9.1.2.3.3.3" xref="S3.p1.9.m9.1.2.3.3.3.cmml">N</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.9.m9.1b"><apply id="S3.p1.9.m9.1.2.cmml" xref="S3.p1.9.m9.1.2"><in id="S3.p1.9.m9.1.2.1.cmml" xref="S3.p1.9.m9.1.2.1"></in><apply id="S3.p1.9.m9.1.2.2.cmml" xref="S3.p1.9.m9.1.2.2"><times id="S3.p1.9.m9.1.2.2.1.cmml" xref="S3.p1.9.m9.1.2.2.1"></times><ci id="S3.p1.9.m9.1.2.2.2.cmml" xref="S3.p1.9.m9.1.2.2.2">𝐌</ci><ci id="S3.p1.9.m9.1.1.cmml" xref="S3.p1.9.m9.1.1">𝒢</ci></apply><apply id="S3.p1.9.m9.1.2.3.cmml" xref="S3.p1.9.m9.1.2.3"><csymbol cd="ambiguous" id="S3.p1.9.m9.1.2.3.1.cmml" xref="S3.p1.9.m9.1.2.3">superscript</csymbol><ci id="S3.p1.9.m9.1.2.3.2.cmml" xref="S3.p1.9.m9.1.2.3.2">ℝ</ci><apply id="S3.p1.9.m9.1.2.3.3.cmml" xref="S3.p1.9.m9.1.2.3.3"><times id="S3.p1.9.m9.1.2.3.3.1.cmml" xref="S3.p1.9.m9.1.2.3.3.1"></times><ci id="S3.p1.9.m9.1.2.3.3.2.cmml" xref="S3.p1.9.m9.1.2.3.3.2">𝑁</ci><ci id="S3.p1.9.m9.1.2.3.3.3.cmml" xref="S3.p1.9.m9.1.2.3.3.3">𝑁</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.9.m9.1c">\mathbf{M}(\mathcal{G})\in\mathbb{R}^{N\times N}</annotation><annotation encoding="application/x-llamapun" id="S3.p1.9.m9.1d">bold_M ( caligraphic_G ) ∈ blackboard_R start_POSTSUPERSCRIPT italic_N × italic_N end_POSTSUPERSCRIPT</annotation></semantics></math> the topological masking matrix.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Graph node kernels as topological masks</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.4">As remarked above, a common choice for <math alttext="\mathbf{M}(\mathcal{G})_{ij}" class="ltx_Math" display="inline" id="S3.SS1.p1.1.m1.1"><semantics id="S3.SS1.p1.1.m1.1a"><mrow id="S3.SS1.p1.1.m1.1.2" xref="S3.SS1.p1.1.m1.1.2.cmml"><mi id="S3.SS1.p1.1.m1.1.2.2" xref="S3.SS1.p1.1.m1.1.2.2.cmml">𝐌</mi><mo id="S3.SS1.p1.1.m1.1.2.1" xref="S3.SS1.p1.1.m1.1.2.1.cmml">⁢</mo><msub id="S3.SS1.p1.1.m1.1.2.3" xref="S3.SS1.p1.1.m1.1.2.3.cmml"><mrow id="S3.SS1.p1.1.m1.1.2.3.2.2" xref="S3.SS1.p1.1.m1.1.2.3.cmml"><mo id="S3.SS1.p1.1.m1.1.2.3.2.2.1" stretchy="false" xref="S3.SS1.p1.1.m1.1.2.3.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml">𝒢</mi><mo id="S3.SS1.p1.1.m1.1.2.3.2.2.2" stretchy="false" xref="S3.SS1.p1.1.m1.1.2.3.cmml">)</mo></mrow><mrow id="S3.SS1.p1.1.m1.1.2.3.3" xref="S3.SS1.p1.1.m1.1.2.3.3.cmml"><mi id="S3.SS1.p1.1.m1.1.2.3.3.2" xref="S3.SS1.p1.1.m1.1.2.3.3.2.cmml">i</mi><mo id="S3.SS1.p1.1.m1.1.2.3.3.1" xref="S3.SS1.p1.1.m1.1.2.3.3.1.cmml">⁢</mo><mi id="S3.SS1.p1.1.m1.1.2.3.3.3" xref="S3.SS1.p1.1.m1.1.2.3.3.3.cmml">j</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><apply id="S3.SS1.p1.1.m1.1.2.cmml" xref="S3.SS1.p1.1.m1.1.2"><times id="S3.SS1.p1.1.m1.1.2.1.cmml" xref="S3.SS1.p1.1.m1.1.2.1"></times><ci id="S3.SS1.p1.1.m1.1.2.2.cmml" xref="S3.SS1.p1.1.m1.1.2.2">𝐌</ci><apply id="S3.SS1.p1.1.m1.1.2.3.cmml" xref="S3.SS1.p1.1.m1.1.2.3"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.1.2.3.1.cmml" xref="S3.SS1.p1.1.m1.1.2.3">subscript</csymbol><ci id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">𝒢</ci><apply id="S3.SS1.p1.1.m1.1.2.3.3.cmml" xref="S3.SS1.p1.1.m1.1.2.3.3"><times id="S3.SS1.p1.1.m1.1.2.3.3.1.cmml" xref="S3.SS1.p1.1.m1.1.2.3.3.1"></times><ci id="S3.SS1.p1.1.m1.1.2.3.3.2.cmml" xref="S3.SS1.p1.1.m1.1.2.3.3.2">𝑖</ci><ci id="S3.SS1.p1.1.m1.1.2.3.3.3.cmml" xref="S3.SS1.p1.1.m1.1.2.3.3.3">𝑗</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">\mathbf{M}(\mathcal{G})_{ij}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.1.m1.1d">bold_M ( caligraphic_G ) start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT</annotation></semantics></math> is a function of the shortest path distance between nodes <math alttext="v_{i}" class="ltx_Math" display="inline" id="S3.SS1.p1.2.m2.1"><semantics id="S3.SS1.p1.2.m2.1a"><msub id="S3.SS1.p1.2.m2.1.1" xref="S3.SS1.p1.2.m2.1.1.cmml"><mi id="S3.SS1.p1.2.m2.1.1.2" xref="S3.SS1.p1.2.m2.1.1.2.cmml">v</mi><mi id="S3.SS1.p1.2.m2.1.1.3" xref="S3.SS1.p1.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.1b"><apply id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.1.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS1.p1.2.m2.1.1.2.cmml" xref="S3.SS1.p1.2.m2.1.1.2">𝑣</ci><ci id="S3.SS1.p1.2.m2.1.1.3.cmml" xref="S3.SS1.p1.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.1c">v_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.2.m2.1d">italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="v_{j}" class="ltx_Math" display="inline" id="S3.SS1.p1.3.m3.1"><semantics id="S3.SS1.p1.3.m3.1a"><msub id="S3.SS1.p1.3.m3.1.1" xref="S3.SS1.p1.3.m3.1.1.cmml"><mi id="S3.SS1.p1.3.m3.1.1.2" xref="S3.SS1.p1.3.m3.1.1.2.cmml">v</mi><mi id="S3.SS1.p1.3.m3.1.1.3" xref="S3.SS1.p1.3.m3.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.1b"><apply id="S3.SS1.p1.3.m3.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.1.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS1.p1.3.m3.1.1.2.cmml" xref="S3.SS1.p1.3.m3.1.1.2">𝑣</ci><ci id="S3.SS1.p1.3.m3.1.1.3.cmml" xref="S3.SS1.p1.3.m3.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.1c">v_{j}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.3.m3.1d">italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> <cite class="ltx_cite ltx_citemacro_citep">(Ying et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#bib.bib43" title="">2021</a>)</cite>.
Though effective at improving performance, this requires computation for every pair of nodes so it cannot straightforwardly be applied to low-rank attention in a scalable way – except for special structured <math alttext="\mathcal{G}" class="ltx_Math" display="inline" id="S3.SS1.p1.4.m4.1"><semantics id="S3.SS1.p1.4.m4.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.4.m4.1.1" xref="S3.SS1.p1.4.m4.1.1.cmml">𝒢</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m4.1b"><ci id="S3.SS1.p1.4.m4.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1">𝒢</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m4.1c">\mathcal{G}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.4.m4.1d">caligraphic_G</annotation></semantics></math> where the mask becomes simple <cite class="ltx_cite ltx_citemacro_citep">(Choromanski et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#bib.bib7" title="">2022</a>)</cite>. Shortest path distances are also very sensitive to changes like the addition or removal of edges, and need access to the whole graph upfront.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS1.p2">
<p class="ltx_p" id="S3.SS1.p2.4"><span class="ltx_text ltx_font_bold" id="S3.SS1.p2.4.1">A new topological mask: graph node kernels.</span> 
Given that we intend <math alttext="\mathbf{M}(\mathcal{G})_{ij}" class="ltx_Math" display="inline" id="S3.SS1.p2.1.m1.1"><semantics id="S3.SS1.p2.1.m1.1a"><mrow id="S3.SS1.p2.1.m1.1.2" xref="S3.SS1.p2.1.m1.1.2.cmml"><mi id="S3.SS1.p2.1.m1.1.2.2" xref="S3.SS1.p2.1.m1.1.2.2.cmml">𝐌</mi><mo id="S3.SS1.p2.1.m1.1.2.1" xref="S3.SS1.p2.1.m1.1.2.1.cmml">⁢</mo><msub id="S3.SS1.p2.1.m1.1.2.3" xref="S3.SS1.p2.1.m1.1.2.3.cmml"><mrow id="S3.SS1.p2.1.m1.1.2.3.2.2" xref="S3.SS1.p2.1.m1.1.2.3.cmml"><mo id="S3.SS1.p2.1.m1.1.2.3.2.2.1" stretchy="false" xref="S3.SS1.p2.1.m1.1.2.3.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.1.m1.1.1" xref="S3.SS1.p2.1.m1.1.1.cmml">𝒢</mi><mo id="S3.SS1.p2.1.m1.1.2.3.2.2.2" stretchy="false" xref="S3.SS1.p2.1.m1.1.2.3.cmml">)</mo></mrow><mrow id="S3.SS1.p2.1.m1.1.2.3.3" xref="S3.SS1.p2.1.m1.1.2.3.3.cmml"><mi id="S3.SS1.p2.1.m1.1.2.3.3.2" xref="S3.SS1.p2.1.m1.1.2.3.3.2.cmml">i</mi><mo id="S3.SS1.p2.1.m1.1.2.3.3.1" xref="S3.SS1.p2.1.m1.1.2.3.3.1.cmml">⁢</mo><mi id="S3.SS1.p2.1.m1.1.2.3.3.3" xref="S3.SS1.p2.1.m1.1.2.3.3.3.cmml">j</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.1b"><apply id="S3.SS1.p2.1.m1.1.2.cmml" xref="S3.SS1.p2.1.m1.1.2"><times id="S3.SS1.p2.1.m1.1.2.1.cmml" xref="S3.SS1.p2.1.m1.1.2.1"></times><ci id="S3.SS1.p2.1.m1.1.2.2.cmml" xref="S3.SS1.p2.1.m1.1.2.2">𝐌</ci><apply id="S3.SS1.p2.1.m1.1.2.3.cmml" xref="S3.SS1.p2.1.m1.1.2.3"><csymbol cd="ambiguous" id="S3.SS1.p2.1.m1.1.2.3.1.cmml" xref="S3.SS1.p2.1.m1.1.2.3">subscript</csymbol><ci id="S3.SS1.p2.1.m1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1">𝒢</ci><apply id="S3.SS1.p2.1.m1.1.2.3.3.cmml" xref="S3.SS1.p2.1.m1.1.2.3.3"><times id="S3.SS1.p2.1.m1.1.2.3.3.1.cmml" xref="S3.SS1.p2.1.m1.1.2.3.3.1"></times><ci id="S3.SS1.p2.1.m1.1.2.3.3.2.cmml" xref="S3.SS1.p2.1.m1.1.2.3.3.2">𝑖</ci><ci id="S3.SS1.p2.1.m1.1.2.3.3.3.cmml" xref="S3.SS1.p2.1.m1.1.2.3.3.3">𝑗</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.1c">\mathbf{M}(\mathcal{G})_{ij}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.1.m1.1d">bold_M ( caligraphic_G ) start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT</annotation></semantics></math> to quantify some sense of topological similarity between <math alttext="v_{i}" class="ltx_Math" display="inline" id="S3.SS1.p2.2.m2.1"><semantics id="S3.SS1.p2.2.m2.1a"><msub id="S3.SS1.p2.2.m2.1.1" xref="S3.SS1.p2.2.m2.1.1.cmml"><mi id="S3.SS1.p2.2.m2.1.1.2" xref="S3.SS1.p2.2.m2.1.1.2.cmml">v</mi><mi id="S3.SS1.p2.2.m2.1.1.3" xref="S3.SS1.p2.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.2.m2.1b"><apply id="S3.SS1.p2.2.m2.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.2.m2.1.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1">subscript</csymbol><ci id="S3.SS1.p2.2.m2.1.1.2.cmml" xref="S3.SS1.p2.2.m2.1.1.2">𝑣</ci><ci id="S3.SS1.p2.2.m2.1.1.3.cmml" xref="S3.SS1.p2.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.2.m2.1c">v_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.2.m2.1d">italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="v_{j}" class="ltx_Math" display="inline" id="S3.SS1.p2.3.m3.1"><semantics id="S3.SS1.p2.3.m3.1a"><msub id="S3.SS1.p2.3.m3.1.1" xref="S3.SS1.p2.3.m3.1.1.cmml"><mi id="S3.SS1.p2.3.m3.1.1.2" xref="S3.SS1.p2.3.m3.1.1.2.cmml">v</mi><mi id="S3.SS1.p2.3.m3.1.1.3" xref="S3.SS1.p2.3.m3.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.3.m3.1b"><apply id="S3.SS1.p2.3.m3.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.3.m3.1.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1">subscript</csymbol><ci id="S3.SS1.p2.3.m3.1.1.2.cmml" xref="S3.SS1.p2.3.m3.1.1.2">𝑣</ci><ci id="S3.SS1.p2.3.m3.1.1.3.cmml" xref="S3.SS1.p2.3.m3.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.3.m3.1c">v_{j}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.3.m3.1d">italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math>, a more principled choice may be <em class="ltx_emph ltx_font_italic" id="S3.SS1.p2.4.2">graph node kernels</em>: positive definite, symmetric functions <math alttext="k:\mathcal{N}\times\mathcal{N}\to\mathbb{R}" class="ltx_Math" display="inline" id="S3.SS1.p2.4.m4.1"><semantics id="S3.SS1.p2.4.m4.1a"><mrow id="S3.SS1.p2.4.m4.1.1" xref="S3.SS1.p2.4.m4.1.1.cmml"><mi id="S3.SS1.p2.4.m4.1.1.2" xref="S3.SS1.p2.4.m4.1.1.2.cmml">k</mi><mo id="S3.SS1.p2.4.m4.1.1.1" lspace="0.278em" rspace="0.278em" xref="S3.SS1.p2.4.m4.1.1.1.cmml">:</mo><mrow id="S3.SS1.p2.4.m4.1.1.3" xref="S3.SS1.p2.4.m4.1.1.3.cmml"><mrow id="S3.SS1.p2.4.m4.1.1.3.2" xref="S3.SS1.p2.4.m4.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.4.m4.1.1.3.2.2" xref="S3.SS1.p2.4.m4.1.1.3.2.2.cmml">𝒩</mi><mo id="S3.SS1.p2.4.m4.1.1.3.2.1" lspace="0.222em" rspace="0.222em" xref="S3.SS1.p2.4.m4.1.1.3.2.1.cmml">×</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.4.m4.1.1.3.2.3" xref="S3.SS1.p2.4.m4.1.1.3.2.3.cmml">𝒩</mi></mrow><mo id="S3.SS1.p2.4.m4.1.1.3.1" stretchy="false" xref="S3.SS1.p2.4.m4.1.1.3.1.cmml">→</mo><mi id="S3.SS1.p2.4.m4.1.1.3.3" xref="S3.SS1.p2.4.m4.1.1.3.3.cmml">ℝ</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.4.m4.1b"><apply id="S3.SS1.p2.4.m4.1.1.cmml" xref="S3.SS1.p2.4.m4.1.1"><ci id="S3.SS1.p2.4.m4.1.1.1.cmml" xref="S3.SS1.p2.4.m4.1.1.1">:</ci><ci id="S3.SS1.p2.4.m4.1.1.2.cmml" xref="S3.SS1.p2.4.m4.1.1.2">𝑘</ci><apply id="S3.SS1.p2.4.m4.1.1.3.cmml" xref="S3.SS1.p2.4.m4.1.1.3"><ci id="S3.SS1.p2.4.m4.1.1.3.1.cmml" xref="S3.SS1.p2.4.m4.1.1.3.1">→</ci><apply id="S3.SS1.p2.4.m4.1.1.3.2.cmml" xref="S3.SS1.p2.4.m4.1.1.3.2"><times id="S3.SS1.p2.4.m4.1.1.3.2.1.cmml" xref="S3.SS1.p2.4.m4.1.1.3.2.1"></times><ci id="S3.SS1.p2.4.m4.1.1.3.2.2.cmml" xref="S3.SS1.p2.4.m4.1.1.3.2.2">𝒩</ci><ci id="S3.SS1.p2.4.m4.1.1.3.2.3.cmml" xref="S3.SS1.p2.4.m4.1.1.3.2.3">𝒩</ci></apply><ci id="S3.SS1.p2.4.m4.1.1.3.3.cmml" xref="S3.SS1.p2.4.m4.1.1.3.3">ℝ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.4.m4.1c">k:\mathcal{N}\times\mathcal{N}\to\mathbb{R}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.4.m4.1d">italic_k : caligraphic_N × caligraphic_N → blackboard_R</annotation></semantics></math> mapping from pairs of graph nodes to real numbers.
These are widely used in bioinformatics <cite class="ltx_cite ltx_citemacro_citep">(Borgwardt et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#bib.bib2" title="">2005</a>)</cite>, community detection <cite class="ltx_cite ltx_citemacro_citep">(Kloster and Gleich, <a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#bib.bib18" title="">2014</a>)</cite> and recommender systems <cite class="ltx_cite ltx_citemacro_citep">(Yajima, <a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#bib.bib41" title="">2006</a>)</cite>, with more recent applications in manifold learning for deep generative modelling <cite class="ltx_cite ltx_citemacro_citep">(Zhou et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#bib.bib46" title="">2020</a>)</cite> and solving single- and multiple-source shortest path problems <cite class="ltx_cite ltx_citemacro_citep">(Crane et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#bib.bib9" title="">2017</a>)</cite>.
They are also used to model the covariance function in geometric Gaussian processes <cite class="ltx_cite ltx_citemacro_citep">(Zhi et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#bib.bib44" title="">2023</a>; Borovitskiy et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#bib.bib3" title="">2021</a>)</cite>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS1.p3">
<p class="ltx_p" id="S3.SS1.p3.7">Graph node kernels are often parameterised as follows.
Let <math alttext="\mathbf{W}\in\mathbb{R}^{N\times N}" class="ltx_Math" display="inline" id="S3.SS1.p3.1.m1.1"><semantics id="S3.SS1.p3.1.m1.1a"><mrow id="S3.SS1.p3.1.m1.1.1" xref="S3.SS1.p3.1.m1.1.1.cmml"><mi id="S3.SS1.p3.1.m1.1.1.2" xref="S3.SS1.p3.1.m1.1.1.2.cmml">𝐖</mi><mo id="S3.SS1.p3.1.m1.1.1.1" xref="S3.SS1.p3.1.m1.1.1.1.cmml">∈</mo><msup id="S3.SS1.p3.1.m1.1.1.3" xref="S3.SS1.p3.1.m1.1.1.3.cmml"><mi id="S3.SS1.p3.1.m1.1.1.3.2" xref="S3.SS1.p3.1.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS1.p3.1.m1.1.1.3.3" xref="S3.SS1.p3.1.m1.1.1.3.3.cmml"><mi id="S3.SS1.p3.1.m1.1.1.3.3.2" xref="S3.SS1.p3.1.m1.1.1.3.3.2.cmml">N</mi><mo id="S3.SS1.p3.1.m1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS1.p3.1.m1.1.1.3.3.1.cmml">×</mo><mi id="S3.SS1.p3.1.m1.1.1.3.3.3" xref="S3.SS1.p3.1.m1.1.1.3.3.3.cmml">N</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.1.m1.1b"><apply id="S3.SS1.p3.1.m1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1"><in id="S3.SS1.p3.1.m1.1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1.1"></in><ci id="S3.SS1.p3.1.m1.1.1.2.cmml" xref="S3.SS1.p3.1.m1.1.1.2">𝐖</ci><apply id="S3.SS1.p3.1.m1.1.1.3.cmml" xref="S3.SS1.p3.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p3.1.m1.1.1.3.1.cmml" xref="S3.SS1.p3.1.m1.1.1.3">superscript</csymbol><ci id="S3.SS1.p3.1.m1.1.1.3.2.cmml" xref="S3.SS1.p3.1.m1.1.1.3.2">ℝ</ci><apply id="S3.SS1.p3.1.m1.1.1.3.3.cmml" xref="S3.SS1.p3.1.m1.1.1.3.3"><times id="S3.SS1.p3.1.m1.1.1.3.3.1.cmml" xref="S3.SS1.p3.1.m1.1.1.3.3.1"></times><ci id="S3.SS1.p3.1.m1.1.1.3.3.2.cmml" xref="S3.SS1.p3.1.m1.1.1.3.3.2">𝑁</ci><ci id="S3.SS1.p3.1.m1.1.1.3.3.3.cmml" xref="S3.SS1.p3.1.m1.1.1.3.3.3">𝑁</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.1.m1.1c">\mathbf{W}\in\mathbb{R}^{N\times N}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.1.m1.1d">bold_W ∈ blackboard_R start_POSTSUPERSCRIPT italic_N × italic_N end_POSTSUPERSCRIPT</annotation></semantics></math> be a <em class="ltx_emph ltx_font_italic" id="S3.SS1.p3.7.1">weighted adjacency matrix</em>, so that <math alttext="\mathbf{W}\coloneqq[w_{ij}]_{i,j\in\mathcal{N}}" class="ltx_Math" display="inline" id="S3.SS1.p3.2.m2.3"><semantics id="S3.SS1.p3.2.m2.3a"><mrow id="S3.SS1.p3.2.m2.3.3" xref="S3.SS1.p3.2.m2.3.3.cmml"><mi id="S3.SS1.p3.2.m2.3.3.3" xref="S3.SS1.p3.2.m2.3.3.3.cmml">𝐖</mi><mo id="S3.SS1.p3.2.m2.3.3.2" xref="S3.SS1.p3.2.m2.3.3.2.cmml">≔</mo><msub id="S3.SS1.p3.2.m2.3.3.1" xref="S3.SS1.p3.2.m2.3.3.1.cmml"><mrow id="S3.SS1.p3.2.m2.3.3.1.1.1" xref="S3.SS1.p3.2.m2.3.3.1.1.2.cmml"><mo id="S3.SS1.p3.2.m2.3.3.1.1.1.2" stretchy="false" xref="S3.SS1.p3.2.m2.3.3.1.1.2.1.cmml">[</mo><msub id="S3.SS1.p3.2.m2.3.3.1.1.1.1" xref="S3.SS1.p3.2.m2.3.3.1.1.1.1.cmml"><mi id="S3.SS1.p3.2.m2.3.3.1.1.1.1.2" xref="S3.SS1.p3.2.m2.3.3.1.1.1.1.2.cmml">w</mi><mrow id="S3.SS1.p3.2.m2.3.3.1.1.1.1.3" xref="S3.SS1.p3.2.m2.3.3.1.1.1.1.3.cmml"><mi id="S3.SS1.p3.2.m2.3.3.1.1.1.1.3.2" xref="S3.SS1.p3.2.m2.3.3.1.1.1.1.3.2.cmml">i</mi><mo id="S3.SS1.p3.2.m2.3.3.1.1.1.1.3.1" xref="S3.SS1.p3.2.m2.3.3.1.1.1.1.3.1.cmml">⁢</mo><mi id="S3.SS1.p3.2.m2.3.3.1.1.1.1.3.3" xref="S3.SS1.p3.2.m2.3.3.1.1.1.1.3.3.cmml">j</mi></mrow></msub><mo id="S3.SS1.p3.2.m2.3.3.1.1.1.3" stretchy="false" xref="S3.SS1.p3.2.m2.3.3.1.1.2.1.cmml">]</mo></mrow><mrow id="S3.SS1.p3.2.m2.2.2.2" xref="S3.SS1.p3.2.m2.2.2.2.cmml"><mrow id="S3.SS1.p3.2.m2.2.2.2.4.2" xref="S3.SS1.p3.2.m2.2.2.2.4.1.cmml"><mi id="S3.SS1.p3.2.m2.1.1.1.1" xref="S3.SS1.p3.2.m2.1.1.1.1.cmml">i</mi><mo id="S3.SS1.p3.2.m2.2.2.2.4.2.1" xref="S3.SS1.p3.2.m2.2.2.2.4.1.cmml">,</mo><mi id="S3.SS1.p3.2.m2.2.2.2.2" xref="S3.SS1.p3.2.m2.2.2.2.2.cmml">j</mi></mrow><mo id="S3.SS1.p3.2.m2.2.2.2.3" xref="S3.SS1.p3.2.m2.2.2.2.3.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p3.2.m2.2.2.2.5" xref="S3.SS1.p3.2.m2.2.2.2.5.cmml">𝒩</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.2.m2.3b"><apply id="S3.SS1.p3.2.m2.3.3.cmml" xref="S3.SS1.p3.2.m2.3.3"><ci id="S3.SS1.p3.2.m2.3.3.2.cmml" xref="S3.SS1.p3.2.m2.3.3.2">≔</ci><ci id="S3.SS1.p3.2.m2.3.3.3.cmml" xref="S3.SS1.p3.2.m2.3.3.3">𝐖</ci><apply id="S3.SS1.p3.2.m2.3.3.1.cmml" xref="S3.SS1.p3.2.m2.3.3.1"><csymbol cd="ambiguous" id="S3.SS1.p3.2.m2.3.3.1.2.cmml" xref="S3.SS1.p3.2.m2.3.3.1">subscript</csymbol><apply id="S3.SS1.p3.2.m2.3.3.1.1.2.cmml" xref="S3.SS1.p3.2.m2.3.3.1.1.1"><csymbol cd="latexml" id="S3.SS1.p3.2.m2.3.3.1.1.2.1.cmml" xref="S3.SS1.p3.2.m2.3.3.1.1.1.2">delimited-[]</csymbol><apply id="S3.SS1.p3.2.m2.3.3.1.1.1.1.cmml" xref="S3.SS1.p3.2.m2.3.3.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.2.m2.3.3.1.1.1.1.1.cmml" xref="S3.SS1.p3.2.m2.3.3.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p3.2.m2.3.3.1.1.1.1.2.cmml" xref="S3.SS1.p3.2.m2.3.3.1.1.1.1.2">𝑤</ci><apply id="S3.SS1.p3.2.m2.3.3.1.1.1.1.3.cmml" xref="S3.SS1.p3.2.m2.3.3.1.1.1.1.3"><times id="S3.SS1.p3.2.m2.3.3.1.1.1.1.3.1.cmml" xref="S3.SS1.p3.2.m2.3.3.1.1.1.1.3.1"></times><ci id="S3.SS1.p3.2.m2.3.3.1.1.1.1.3.2.cmml" xref="S3.SS1.p3.2.m2.3.3.1.1.1.1.3.2">𝑖</ci><ci id="S3.SS1.p3.2.m2.3.3.1.1.1.1.3.3.cmml" xref="S3.SS1.p3.2.m2.3.3.1.1.1.1.3.3">𝑗</ci></apply></apply></apply><apply id="S3.SS1.p3.2.m2.2.2.2.cmml" xref="S3.SS1.p3.2.m2.2.2.2"><in id="S3.SS1.p3.2.m2.2.2.2.3.cmml" xref="S3.SS1.p3.2.m2.2.2.2.3"></in><list id="S3.SS1.p3.2.m2.2.2.2.4.1.cmml" xref="S3.SS1.p3.2.m2.2.2.2.4.2"><ci id="S3.SS1.p3.2.m2.1.1.1.1.cmml" xref="S3.SS1.p3.2.m2.1.1.1.1">𝑖</ci><ci id="S3.SS1.p3.2.m2.2.2.2.2.cmml" xref="S3.SS1.p3.2.m2.2.2.2.2">𝑗</ci></list><ci id="S3.SS1.p3.2.m2.2.2.2.5.cmml" xref="S3.SS1.p3.2.m2.2.2.2.5">𝒩</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.2.m2.3c">\mathbf{W}\coloneqq[w_{ij}]_{i,j\in\mathcal{N}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.2.m2.3d">bold_W ≔ [ italic_w start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT ] start_POSTSUBSCRIPT italic_i , italic_j ∈ caligraphic_N end_POSTSUBSCRIPT</annotation></semantics></math> with <math alttext="w_{ij}" class="ltx_Math" display="inline" id="S3.SS1.p3.3.m3.1"><semantics id="S3.SS1.p3.3.m3.1a"><msub id="S3.SS1.p3.3.m3.1.1" xref="S3.SS1.p3.3.m3.1.1.cmml"><mi id="S3.SS1.p3.3.m3.1.1.2" xref="S3.SS1.p3.3.m3.1.1.2.cmml">w</mi><mrow id="S3.SS1.p3.3.m3.1.1.3" xref="S3.SS1.p3.3.m3.1.1.3.cmml"><mi id="S3.SS1.p3.3.m3.1.1.3.2" xref="S3.SS1.p3.3.m3.1.1.3.2.cmml">i</mi><mo id="S3.SS1.p3.3.m3.1.1.3.1" xref="S3.SS1.p3.3.m3.1.1.3.1.cmml">⁢</mo><mi id="S3.SS1.p3.3.m3.1.1.3.3" xref="S3.SS1.p3.3.m3.1.1.3.3.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.3.m3.1b"><apply id="S3.SS1.p3.3.m3.1.1.cmml" xref="S3.SS1.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.3.m3.1.1.1.cmml" xref="S3.SS1.p3.3.m3.1.1">subscript</csymbol><ci id="S3.SS1.p3.3.m3.1.1.2.cmml" xref="S3.SS1.p3.3.m3.1.1.2">𝑤</ci><apply id="S3.SS1.p3.3.m3.1.1.3.cmml" xref="S3.SS1.p3.3.m3.1.1.3"><times id="S3.SS1.p3.3.m3.1.1.3.1.cmml" xref="S3.SS1.p3.3.m3.1.1.3.1"></times><ci id="S3.SS1.p3.3.m3.1.1.3.2.cmml" xref="S3.SS1.p3.3.m3.1.1.3.2">𝑖</ci><ci id="S3.SS1.p3.3.m3.1.1.3.3.cmml" xref="S3.SS1.p3.3.m3.1.1.3.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.3.m3.1c">w_{ij}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.3.m3.1d">italic_w start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT</annotation></semantics></math> nonzero if and only if <math alttext="(v_{i},v_{j})\in\mathcal{E}" class="ltx_Math" display="inline" id="S3.SS1.p3.4.m4.2"><semantics id="S3.SS1.p3.4.m4.2a"><mrow id="S3.SS1.p3.4.m4.2.2" xref="S3.SS1.p3.4.m4.2.2.cmml"><mrow id="S3.SS1.p3.4.m4.2.2.2.2" xref="S3.SS1.p3.4.m4.2.2.2.3.cmml"><mo id="S3.SS1.p3.4.m4.2.2.2.2.3" stretchy="false" xref="S3.SS1.p3.4.m4.2.2.2.3.cmml">(</mo><msub id="S3.SS1.p3.4.m4.1.1.1.1.1" xref="S3.SS1.p3.4.m4.1.1.1.1.1.cmml"><mi id="S3.SS1.p3.4.m4.1.1.1.1.1.2" xref="S3.SS1.p3.4.m4.1.1.1.1.1.2.cmml">v</mi><mi id="S3.SS1.p3.4.m4.1.1.1.1.1.3" xref="S3.SS1.p3.4.m4.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS1.p3.4.m4.2.2.2.2.4" xref="S3.SS1.p3.4.m4.2.2.2.3.cmml">,</mo><msub id="S3.SS1.p3.4.m4.2.2.2.2.2" xref="S3.SS1.p3.4.m4.2.2.2.2.2.cmml"><mi id="S3.SS1.p3.4.m4.2.2.2.2.2.2" xref="S3.SS1.p3.4.m4.2.2.2.2.2.2.cmml">v</mi><mi id="S3.SS1.p3.4.m4.2.2.2.2.2.3" xref="S3.SS1.p3.4.m4.2.2.2.2.2.3.cmml">j</mi></msub><mo id="S3.SS1.p3.4.m4.2.2.2.2.5" stretchy="false" xref="S3.SS1.p3.4.m4.2.2.2.3.cmml">)</mo></mrow><mo id="S3.SS1.p3.4.m4.2.2.3" xref="S3.SS1.p3.4.m4.2.2.3.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p3.4.m4.2.2.4" xref="S3.SS1.p3.4.m4.2.2.4.cmml">ℰ</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.4.m4.2b"><apply id="S3.SS1.p3.4.m4.2.2.cmml" xref="S3.SS1.p3.4.m4.2.2"><in id="S3.SS1.p3.4.m4.2.2.3.cmml" xref="S3.SS1.p3.4.m4.2.2.3"></in><interval closure="open" id="S3.SS1.p3.4.m4.2.2.2.3.cmml" xref="S3.SS1.p3.4.m4.2.2.2.2"><apply id="S3.SS1.p3.4.m4.1.1.1.1.1.cmml" xref="S3.SS1.p3.4.m4.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.4.m4.1.1.1.1.1.1.cmml" xref="S3.SS1.p3.4.m4.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p3.4.m4.1.1.1.1.1.2.cmml" xref="S3.SS1.p3.4.m4.1.1.1.1.1.2">𝑣</ci><ci id="S3.SS1.p3.4.m4.1.1.1.1.1.3.cmml" xref="S3.SS1.p3.4.m4.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.SS1.p3.4.m4.2.2.2.2.2.cmml" xref="S3.SS1.p3.4.m4.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p3.4.m4.2.2.2.2.2.1.cmml" xref="S3.SS1.p3.4.m4.2.2.2.2.2">subscript</csymbol><ci id="S3.SS1.p3.4.m4.2.2.2.2.2.2.cmml" xref="S3.SS1.p3.4.m4.2.2.2.2.2.2">𝑣</ci><ci id="S3.SS1.p3.4.m4.2.2.2.2.2.3.cmml" xref="S3.SS1.p3.4.m4.2.2.2.2.2.3">𝑗</ci></apply></interval><ci id="S3.SS1.p3.4.m4.2.2.4.cmml" xref="S3.SS1.p3.4.m4.2.2.4">ℰ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.4.m4.2c">(v_{i},v_{j})\in\mathcal{E}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.4.m4.2d">( italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) ∈ caligraphic_E</annotation></semantics></math>. A common choice is <math alttext="w_{ij}=1/\sqrt{d_{i}d_{j}}" class="ltx_Math" display="inline" id="S3.SS1.p3.5.m5.1"><semantics id="S3.SS1.p3.5.m5.1a"><mrow id="S3.SS1.p3.5.m5.1.1" xref="S3.SS1.p3.5.m5.1.1.cmml"><msub id="S3.SS1.p3.5.m5.1.1.2" xref="S3.SS1.p3.5.m5.1.1.2.cmml"><mi id="S3.SS1.p3.5.m5.1.1.2.2" xref="S3.SS1.p3.5.m5.1.1.2.2.cmml">w</mi><mrow id="S3.SS1.p3.5.m5.1.1.2.3" xref="S3.SS1.p3.5.m5.1.1.2.3.cmml"><mi id="S3.SS1.p3.5.m5.1.1.2.3.2" xref="S3.SS1.p3.5.m5.1.1.2.3.2.cmml">i</mi><mo id="S3.SS1.p3.5.m5.1.1.2.3.1" xref="S3.SS1.p3.5.m5.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS1.p3.5.m5.1.1.2.3.3" xref="S3.SS1.p3.5.m5.1.1.2.3.3.cmml">j</mi></mrow></msub><mo id="S3.SS1.p3.5.m5.1.1.1" xref="S3.SS1.p3.5.m5.1.1.1.cmml">=</mo><mrow id="S3.SS1.p3.5.m5.1.1.3" xref="S3.SS1.p3.5.m5.1.1.3.cmml"><mn id="S3.SS1.p3.5.m5.1.1.3.2" xref="S3.SS1.p3.5.m5.1.1.3.2.cmml">1</mn><mo id="S3.SS1.p3.5.m5.1.1.3.1" xref="S3.SS1.p3.5.m5.1.1.3.1.cmml">/</mo><msqrt id="S3.SS1.p3.5.m5.1.1.3.3" xref="S3.SS1.p3.5.m5.1.1.3.3.cmml"><mrow id="S3.SS1.p3.5.m5.1.1.3.3.2" xref="S3.SS1.p3.5.m5.1.1.3.3.2.cmml"><msub id="S3.SS1.p3.5.m5.1.1.3.3.2.2" xref="S3.SS1.p3.5.m5.1.1.3.3.2.2.cmml"><mi id="S3.SS1.p3.5.m5.1.1.3.3.2.2.2" xref="S3.SS1.p3.5.m5.1.1.3.3.2.2.2.cmml">d</mi><mi id="S3.SS1.p3.5.m5.1.1.3.3.2.2.3" xref="S3.SS1.p3.5.m5.1.1.3.3.2.2.3.cmml">i</mi></msub><mo id="S3.SS1.p3.5.m5.1.1.3.3.2.1" xref="S3.SS1.p3.5.m5.1.1.3.3.2.1.cmml">⁢</mo><msub id="S3.SS1.p3.5.m5.1.1.3.3.2.3" xref="S3.SS1.p3.5.m5.1.1.3.3.2.3.cmml"><mi id="S3.SS1.p3.5.m5.1.1.3.3.2.3.2" xref="S3.SS1.p3.5.m5.1.1.3.3.2.3.2.cmml">d</mi><mi id="S3.SS1.p3.5.m5.1.1.3.3.2.3.3" xref="S3.SS1.p3.5.m5.1.1.3.3.2.3.3.cmml">j</mi></msub></mrow></msqrt></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.5.m5.1b"><apply id="S3.SS1.p3.5.m5.1.1.cmml" xref="S3.SS1.p3.5.m5.1.1"><eq id="S3.SS1.p3.5.m5.1.1.1.cmml" xref="S3.SS1.p3.5.m5.1.1.1"></eq><apply id="S3.SS1.p3.5.m5.1.1.2.cmml" xref="S3.SS1.p3.5.m5.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p3.5.m5.1.1.2.1.cmml" xref="S3.SS1.p3.5.m5.1.1.2">subscript</csymbol><ci id="S3.SS1.p3.5.m5.1.1.2.2.cmml" xref="S3.SS1.p3.5.m5.1.1.2.2">𝑤</ci><apply id="S3.SS1.p3.5.m5.1.1.2.3.cmml" xref="S3.SS1.p3.5.m5.1.1.2.3"><times id="S3.SS1.p3.5.m5.1.1.2.3.1.cmml" xref="S3.SS1.p3.5.m5.1.1.2.3.1"></times><ci id="S3.SS1.p3.5.m5.1.1.2.3.2.cmml" xref="S3.SS1.p3.5.m5.1.1.2.3.2">𝑖</ci><ci id="S3.SS1.p3.5.m5.1.1.2.3.3.cmml" xref="S3.SS1.p3.5.m5.1.1.2.3.3">𝑗</ci></apply></apply><apply id="S3.SS1.p3.5.m5.1.1.3.cmml" xref="S3.SS1.p3.5.m5.1.1.3"><divide id="S3.SS1.p3.5.m5.1.1.3.1.cmml" xref="S3.SS1.p3.5.m5.1.1.3.1"></divide><cn id="S3.SS1.p3.5.m5.1.1.3.2.cmml" type="integer" xref="S3.SS1.p3.5.m5.1.1.3.2">1</cn><apply id="S3.SS1.p3.5.m5.1.1.3.3.cmml" xref="S3.SS1.p3.5.m5.1.1.3.3"><root id="S3.SS1.p3.5.m5.1.1.3.3a.cmml" xref="S3.SS1.p3.5.m5.1.1.3.3"></root><apply id="S3.SS1.p3.5.m5.1.1.3.3.2.cmml" xref="S3.SS1.p3.5.m5.1.1.3.3.2"><times id="S3.SS1.p3.5.m5.1.1.3.3.2.1.cmml" xref="S3.SS1.p3.5.m5.1.1.3.3.2.1"></times><apply id="S3.SS1.p3.5.m5.1.1.3.3.2.2.cmml" xref="S3.SS1.p3.5.m5.1.1.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS1.p3.5.m5.1.1.3.3.2.2.1.cmml" xref="S3.SS1.p3.5.m5.1.1.3.3.2.2">subscript</csymbol><ci id="S3.SS1.p3.5.m5.1.1.3.3.2.2.2.cmml" xref="S3.SS1.p3.5.m5.1.1.3.3.2.2.2">𝑑</ci><ci id="S3.SS1.p3.5.m5.1.1.3.3.2.2.3.cmml" xref="S3.SS1.p3.5.m5.1.1.3.3.2.2.3">𝑖</ci></apply><apply id="S3.SS1.p3.5.m5.1.1.3.3.2.3.cmml" xref="S3.SS1.p3.5.m5.1.1.3.3.2.3"><csymbol cd="ambiguous" id="S3.SS1.p3.5.m5.1.1.3.3.2.3.1.cmml" xref="S3.SS1.p3.5.m5.1.1.3.3.2.3">subscript</csymbol><ci id="S3.SS1.p3.5.m5.1.1.3.3.2.3.2.cmml" xref="S3.SS1.p3.5.m5.1.1.3.3.2.3.2">𝑑</ci><ci id="S3.SS1.p3.5.m5.1.1.3.3.2.3.3.cmml" xref="S3.SS1.p3.5.m5.1.1.3.3.2.3.3">𝑗</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.5.m5.1c">w_{ij}=1/\sqrt{d_{i}d_{j}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.5.m5.1d">italic_w start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT = 1 / square-root start_ARG italic_d start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT italic_d start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_ARG</annotation></semantics></math>, with <math alttext="d_{i}" class="ltx_Math" display="inline" id="S3.SS1.p3.6.m6.1"><semantics id="S3.SS1.p3.6.m6.1a"><msub id="S3.SS1.p3.6.m6.1.1" xref="S3.SS1.p3.6.m6.1.1.cmml"><mi id="S3.SS1.p3.6.m6.1.1.2" xref="S3.SS1.p3.6.m6.1.1.2.cmml">d</mi><mi id="S3.SS1.p3.6.m6.1.1.3" xref="S3.SS1.p3.6.m6.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.6.m6.1b"><apply id="S3.SS1.p3.6.m6.1.1.cmml" xref="S3.SS1.p3.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.6.m6.1.1.1.cmml" xref="S3.SS1.p3.6.m6.1.1">subscript</csymbol><ci id="S3.SS1.p3.6.m6.1.1.2.cmml" xref="S3.SS1.p3.6.m6.1.1.2">𝑑</ci><ci id="S3.SS1.p3.6.m6.1.1.3.cmml" xref="S3.SS1.p3.6.m6.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.6.m6.1c">d_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.6.m6.1d">italic_d start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> the degree of <math alttext="v_{i}" class="ltx_Math" display="inline" id="S3.SS1.p3.7.m7.1"><semantics id="S3.SS1.p3.7.m7.1a"><msub id="S3.SS1.p3.7.m7.1.1" xref="S3.SS1.p3.7.m7.1.1.cmml"><mi id="S3.SS1.p3.7.m7.1.1.2" xref="S3.SS1.p3.7.m7.1.1.2.cmml">v</mi><mi id="S3.SS1.p3.7.m7.1.1.3" xref="S3.SS1.p3.7.m7.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.7.m7.1b"><apply id="S3.SS1.p3.7.m7.1.1.cmml" xref="S3.SS1.p3.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.7.m7.1.1.1.cmml" xref="S3.SS1.p3.7.m7.1.1">subscript</csymbol><ci id="S3.SS1.p3.7.m7.1.1.2.cmml" xref="S3.SS1.p3.7.m7.1.1.2">𝑣</ci><ci id="S3.SS1.p3.7.m7.1.1.3.cmml" xref="S3.SS1.p3.7.m7.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.7.m7.1c">v_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.7.m7.1d">italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>.
Then consider the power series</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equation ltx_eqn_table" id="S3.E4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{M}_{\alpha}(\mathcal{G})\coloneqq\sum_{k=0}^{\infty}\alpha_{k}\mathbf{%
W}^{k}" class="ltx_Math" display="block" id="S3.E4.m1.1"><semantics id="S3.E4.m1.1a"><mrow id="S3.E4.m1.1.2" xref="S3.E4.m1.1.2.cmml"><mrow id="S3.E4.m1.1.2.2" xref="S3.E4.m1.1.2.2.cmml"><msub id="S3.E4.m1.1.2.2.2" xref="S3.E4.m1.1.2.2.2.cmml"><mi id="S3.E4.m1.1.2.2.2.2" xref="S3.E4.m1.1.2.2.2.2.cmml">𝐌</mi><mi id="S3.E4.m1.1.2.2.2.3" xref="S3.E4.m1.1.2.2.2.3.cmml">α</mi></msub><mo id="S3.E4.m1.1.2.2.1" xref="S3.E4.m1.1.2.2.1.cmml">⁢</mo><mrow id="S3.E4.m1.1.2.2.3.2" xref="S3.E4.m1.1.2.2.cmml"><mo id="S3.E4.m1.1.2.2.3.2.1" stretchy="false" xref="S3.E4.m1.1.2.2.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.1.1" xref="S3.E4.m1.1.1.cmml">𝒢</mi><mo id="S3.E4.m1.1.2.2.3.2.2" stretchy="false" xref="S3.E4.m1.1.2.2.cmml">)</mo></mrow></mrow><mo id="S3.E4.m1.1.2.1" rspace="0.111em" xref="S3.E4.m1.1.2.1.cmml">≔</mo><mrow id="S3.E4.m1.1.2.3" xref="S3.E4.m1.1.2.3.cmml"><munderover id="S3.E4.m1.1.2.3.1" xref="S3.E4.m1.1.2.3.1.cmml"><mo id="S3.E4.m1.1.2.3.1.2.2" movablelimits="false" xref="S3.E4.m1.1.2.3.1.2.2.cmml">∑</mo><mrow id="S3.E4.m1.1.2.3.1.2.3" xref="S3.E4.m1.1.2.3.1.2.3.cmml"><mi id="S3.E4.m1.1.2.3.1.2.3.2" xref="S3.E4.m1.1.2.3.1.2.3.2.cmml">k</mi><mo id="S3.E4.m1.1.2.3.1.2.3.1" xref="S3.E4.m1.1.2.3.1.2.3.1.cmml">=</mo><mn id="S3.E4.m1.1.2.3.1.2.3.3" xref="S3.E4.m1.1.2.3.1.2.3.3.cmml">0</mn></mrow><mi id="S3.E4.m1.1.2.3.1.3" mathvariant="normal" xref="S3.E4.m1.1.2.3.1.3.cmml">∞</mi></munderover><mrow id="S3.E4.m1.1.2.3.2" xref="S3.E4.m1.1.2.3.2.cmml"><msub id="S3.E4.m1.1.2.3.2.2" xref="S3.E4.m1.1.2.3.2.2.cmml"><mi id="S3.E4.m1.1.2.3.2.2.2" xref="S3.E4.m1.1.2.3.2.2.2.cmml">α</mi><mi id="S3.E4.m1.1.2.3.2.2.3" xref="S3.E4.m1.1.2.3.2.2.3.cmml">k</mi></msub><mo id="S3.E4.m1.1.2.3.2.1" xref="S3.E4.m1.1.2.3.2.1.cmml">⁢</mo><msup id="S3.E4.m1.1.2.3.2.3" xref="S3.E4.m1.1.2.3.2.3.cmml"><mi id="S3.E4.m1.1.2.3.2.3.2" xref="S3.E4.m1.1.2.3.2.3.2.cmml">𝐖</mi><mi id="S3.E4.m1.1.2.3.2.3.3" xref="S3.E4.m1.1.2.3.2.3.3.cmml">k</mi></msup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.1b"><apply id="S3.E4.m1.1.2.cmml" xref="S3.E4.m1.1.2"><ci id="S3.E4.m1.1.2.1.cmml" xref="S3.E4.m1.1.2.1">≔</ci><apply id="S3.E4.m1.1.2.2.cmml" xref="S3.E4.m1.1.2.2"><times id="S3.E4.m1.1.2.2.1.cmml" xref="S3.E4.m1.1.2.2.1"></times><apply id="S3.E4.m1.1.2.2.2.cmml" xref="S3.E4.m1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.1.2.2.2.1.cmml" xref="S3.E4.m1.1.2.2.2">subscript</csymbol><ci id="S3.E4.m1.1.2.2.2.2.cmml" xref="S3.E4.m1.1.2.2.2.2">𝐌</ci><ci id="S3.E4.m1.1.2.2.2.3.cmml" xref="S3.E4.m1.1.2.2.2.3">𝛼</ci></apply><ci id="S3.E4.m1.1.1.cmml" xref="S3.E4.m1.1.1">𝒢</ci></apply><apply id="S3.E4.m1.1.2.3.cmml" xref="S3.E4.m1.1.2.3"><apply id="S3.E4.m1.1.2.3.1.cmml" xref="S3.E4.m1.1.2.3.1"><csymbol cd="ambiguous" id="S3.E4.m1.1.2.3.1.1.cmml" xref="S3.E4.m1.1.2.3.1">superscript</csymbol><apply id="S3.E4.m1.1.2.3.1.2.cmml" xref="S3.E4.m1.1.2.3.1"><csymbol cd="ambiguous" id="S3.E4.m1.1.2.3.1.2.1.cmml" xref="S3.E4.m1.1.2.3.1">subscript</csymbol><sum id="S3.E4.m1.1.2.3.1.2.2.cmml" xref="S3.E4.m1.1.2.3.1.2.2"></sum><apply id="S3.E4.m1.1.2.3.1.2.3.cmml" xref="S3.E4.m1.1.2.3.1.2.3"><eq id="S3.E4.m1.1.2.3.1.2.3.1.cmml" xref="S3.E4.m1.1.2.3.1.2.3.1"></eq><ci id="S3.E4.m1.1.2.3.1.2.3.2.cmml" xref="S3.E4.m1.1.2.3.1.2.3.2">𝑘</ci><cn id="S3.E4.m1.1.2.3.1.2.3.3.cmml" type="integer" xref="S3.E4.m1.1.2.3.1.2.3.3">0</cn></apply></apply><infinity id="S3.E4.m1.1.2.3.1.3.cmml" xref="S3.E4.m1.1.2.3.1.3"></infinity></apply><apply id="S3.E4.m1.1.2.3.2.cmml" xref="S3.E4.m1.1.2.3.2"><times id="S3.E4.m1.1.2.3.2.1.cmml" xref="S3.E4.m1.1.2.3.2.1"></times><apply id="S3.E4.m1.1.2.3.2.2.cmml" xref="S3.E4.m1.1.2.3.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.1.2.3.2.2.1.cmml" xref="S3.E4.m1.1.2.3.2.2">subscript</csymbol><ci id="S3.E4.m1.1.2.3.2.2.2.cmml" xref="S3.E4.m1.1.2.3.2.2.2">𝛼</ci><ci id="S3.E4.m1.1.2.3.2.2.3.cmml" xref="S3.E4.m1.1.2.3.2.2.3">𝑘</ci></apply><apply id="S3.E4.m1.1.2.3.2.3.cmml" xref="S3.E4.m1.1.2.3.2.3"><csymbol cd="ambiguous" id="S3.E4.m1.1.2.3.2.3.1.cmml" xref="S3.E4.m1.1.2.3.2.3">superscript</csymbol><ci id="S3.E4.m1.1.2.3.2.3.2.cmml" xref="S3.E4.m1.1.2.3.2.3.2">𝐖</ci><ci id="S3.E4.m1.1.2.3.2.3.3.cmml" xref="S3.E4.m1.1.2.3.2.3.3">𝑘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.1c">\mathbf{M}_{\alpha}(\mathcal{G})\coloneqq\sum_{k=0}^{\infty}\alpha_{k}\mathbf{%
W}^{k}</annotation><annotation encoding="application/x-llamapun" id="S3.E4.m1.1d">bold_M start_POSTSUBSCRIPT italic_α end_POSTSUBSCRIPT ( caligraphic_G ) ≔ ∑ start_POSTSUBSCRIPT italic_k = 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∞ end_POSTSUPERSCRIPT italic_α start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT bold_W start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS1.p3.14">where <math alttext="(\alpha_{k})_{k=0}^{\infty}\subset\mathbb{R}" class="ltx_Math" display="inline" id="S3.SS1.p3.8.m1.1"><semantics id="S3.SS1.p3.8.m1.1a"><mrow id="S3.SS1.p3.8.m1.1.1" xref="S3.SS1.p3.8.m1.1.1.cmml"><msubsup id="S3.SS1.p3.8.m1.1.1.1" xref="S3.SS1.p3.8.m1.1.1.1.cmml"><mrow id="S3.SS1.p3.8.m1.1.1.1.1.1.1" xref="S3.SS1.p3.8.m1.1.1.1.1.1.1.1.cmml"><mo id="S3.SS1.p3.8.m1.1.1.1.1.1.1.2" stretchy="false" xref="S3.SS1.p3.8.m1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.SS1.p3.8.m1.1.1.1.1.1.1.1" xref="S3.SS1.p3.8.m1.1.1.1.1.1.1.1.cmml"><mi id="S3.SS1.p3.8.m1.1.1.1.1.1.1.1.2" xref="S3.SS1.p3.8.m1.1.1.1.1.1.1.1.2.cmml">α</mi><mi id="S3.SS1.p3.8.m1.1.1.1.1.1.1.1.3" xref="S3.SS1.p3.8.m1.1.1.1.1.1.1.1.3.cmml">k</mi></msub><mo id="S3.SS1.p3.8.m1.1.1.1.1.1.1.3" stretchy="false" xref="S3.SS1.p3.8.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mrow id="S3.SS1.p3.8.m1.1.1.1.1.3" xref="S3.SS1.p3.8.m1.1.1.1.1.3.cmml"><mi id="S3.SS1.p3.8.m1.1.1.1.1.3.2" xref="S3.SS1.p3.8.m1.1.1.1.1.3.2.cmml">k</mi><mo id="S3.SS1.p3.8.m1.1.1.1.1.3.1" xref="S3.SS1.p3.8.m1.1.1.1.1.3.1.cmml">=</mo><mn id="S3.SS1.p3.8.m1.1.1.1.1.3.3" xref="S3.SS1.p3.8.m1.1.1.1.1.3.3.cmml">0</mn></mrow><mi id="S3.SS1.p3.8.m1.1.1.1.3" mathvariant="normal" xref="S3.SS1.p3.8.m1.1.1.1.3.cmml">∞</mi></msubsup><mo id="S3.SS1.p3.8.m1.1.1.2" xref="S3.SS1.p3.8.m1.1.1.2.cmml">⊂</mo><mi id="S3.SS1.p3.8.m1.1.1.3" xref="S3.SS1.p3.8.m1.1.1.3.cmml">ℝ</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.8.m1.1b"><apply id="S3.SS1.p3.8.m1.1.1.cmml" xref="S3.SS1.p3.8.m1.1.1"><subset id="S3.SS1.p3.8.m1.1.1.2.cmml" xref="S3.SS1.p3.8.m1.1.1.2"></subset><apply id="S3.SS1.p3.8.m1.1.1.1.cmml" xref="S3.SS1.p3.8.m1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.8.m1.1.1.1.2.cmml" xref="S3.SS1.p3.8.m1.1.1.1">superscript</csymbol><apply id="S3.SS1.p3.8.m1.1.1.1.1.cmml" xref="S3.SS1.p3.8.m1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.8.m1.1.1.1.1.2.cmml" xref="S3.SS1.p3.8.m1.1.1.1">subscript</csymbol><apply id="S3.SS1.p3.8.m1.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p3.8.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.8.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p3.8.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p3.8.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.SS1.p3.8.m1.1.1.1.1.1.1.1.2">𝛼</ci><ci id="S3.SS1.p3.8.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.SS1.p3.8.m1.1.1.1.1.1.1.1.3">𝑘</ci></apply><apply id="S3.SS1.p3.8.m1.1.1.1.1.3.cmml" xref="S3.SS1.p3.8.m1.1.1.1.1.3"><eq id="S3.SS1.p3.8.m1.1.1.1.1.3.1.cmml" xref="S3.SS1.p3.8.m1.1.1.1.1.3.1"></eq><ci id="S3.SS1.p3.8.m1.1.1.1.1.3.2.cmml" xref="S3.SS1.p3.8.m1.1.1.1.1.3.2">𝑘</ci><cn id="S3.SS1.p3.8.m1.1.1.1.1.3.3.cmml" type="integer" xref="S3.SS1.p3.8.m1.1.1.1.1.3.3">0</cn></apply></apply><infinity id="S3.SS1.p3.8.m1.1.1.1.3.cmml" xref="S3.SS1.p3.8.m1.1.1.1.3"></infinity></apply><ci id="S3.SS1.p3.8.m1.1.1.3.cmml" xref="S3.SS1.p3.8.m1.1.1.3">ℝ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.8.m1.1c">(\alpha_{k})_{k=0}^{\infty}\subset\mathbb{R}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.8.m1.1d">( italic_α start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ) start_POSTSUBSCRIPT italic_k = 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∞ end_POSTSUPERSCRIPT ⊂ blackboard_R</annotation></semantics></math> is a set of real-valued Taylor coefficients.
This is positive definite if and only if <math alttext="\sum_{k=0}^{\infty}\alpha_{k}\lambda_{i}^{k}>0\hskip 1.99997pt\forall\hskip 1.%
99997pt\lambda_{i}\in\Lambda(\mathbf{W})" class="ltx_Math" display="inline" id="S3.SS1.p3.9.m2.1"><semantics id="S3.SS1.p3.9.m2.1a"><mrow id="S3.SS1.p3.9.m2.1.2" xref="S3.SS1.p3.9.m2.1.2.cmml"><mrow id="S3.SS1.p3.9.m2.1.2.2" xref="S3.SS1.p3.9.m2.1.2.2.cmml"><msubsup id="S3.SS1.p3.9.m2.1.2.2.1" xref="S3.SS1.p3.9.m2.1.2.2.1.cmml"><mo id="S3.SS1.p3.9.m2.1.2.2.1.2.2" xref="S3.SS1.p3.9.m2.1.2.2.1.2.2.cmml">∑</mo><mrow id="S3.SS1.p3.9.m2.1.2.2.1.2.3" xref="S3.SS1.p3.9.m2.1.2.2.1.2.3.cmml"><mi id="S3.SS1.p3.9.m2.1.2.2.1.2.3.2" xref="S3.SS1.p3.9.m2.1.2.2.1.2.3.2.cmml">k</mi><mo id="S3.SS1.p3.9.m2.1.2.2.1.2.3.1" xref="S3.SS1.p3.9.m2.1.2.2.1.2.3.1.cmml">=</mo><mn id="S3.SS1.p3.9.m2.1.2.2.1.2.3.3" xref="S3.SS1.p3.9.m2.1.2.2.1.2.3.3.cmml">0</mn></mrow><mi id="S3.SS1.p3.9.m2.1.2.2.1.3" mathvariant="normal" xref="S3.SS1.p3.9.m2.1.2.2.1.3.cmml">∞</mi></msubsup><mrow id="S3.SS1.p3.9.m2.1.2.2.2" xref="S3.SS1.p3.9.m2.1.2.2.2.cmml"><msub id="S3.SS1.p3.9.m2.1.2.2.2.2" xref="S3.SS1.p3.9.m2.1.2.2.2.2.cmml"><mi id="S3.SS1.p3.9.m2.1.2.2.2.2.2" xref="S3.SS1.p3.9.m2.1.2.2.2.2.2.cmml">α</mi><mi id="S3.SS1.p3.9.m2.1.2.2.2.2.3" xref="S3.SS1.p3.9.m2.1.2.2.2.2.3.cmml">k</mi></msub><mo id="S3.SS1.p3.9.m2.1.2.2.2.1" xref="S3.SS1.p3.9.m2.1.2.2.2.1.cmml">⁢</mo><msubsup id="S3.SS1.p3.9.m2.1.2.2.2.3" xref="S3.SS1.p3.9.m2.1.2.2.2.3.cmml"><mi id="S3.SS1.p3.9.m2.1.2.2.2.3.2.2" xref="S3.SS1.p3.9.m2.1.2.2.2.3.2.2.cmml">λ</mi><mi id="S3.SS1.p3.9.m2.1.2.2.2.3.2.3" xref="S3.SS1.p3.9.m2.1.2.2.2.3.2.3.cmml">i</mi><mi id="S3.SS1.p3.9.m2.1.2.2.2.3.3" xref="S3.SS1.p3.9.m2.1.2.2.2.3.3.cmml">k</mi></msubsup></mrow></mrow><mo id="S3.SS1.p3.9.m2.1.2.3" xref="S3.SS1.p3.9.m2.1.2.3.cmml">&gt;</mo><mrow id="S3.SS1.p3.9.m2.1.2.4" xref="S3.SS1.p3.9.m2.1.2.4.cmml"><mn id="S3.SS1.p3.9.m2.1.2.4.2" xref="S3.SS1.p3.9.m2.1.2.4.2.cmml">0</mn><mo id="S3.SS1.p3.9.m2.1.2.4.1" lspace="0.367em" xref="S3.SS1.p3.9.m2.1.2.4.1.cmml">⁢</mo><mrow id="S3.SS1.p3.9.m2.1.2.4.3" xref="S3.SS1.p3.9.m2.1.2.4.3.cmml"><mo id="S3.SS1.p3.9.m2.1.2.4.3.1" rspace="0.367em" xref="S3.SS1.p3.9.m2.1.2.4.3.1.cmml">∀</mo><msub id="S3.SS1.p3.9.m2.1.2.4.3.2" xref="S3.SS1.p3.9.m2.1.2.4.3.2.cmml"><mi id="S3.SS1.p3.9.m2.1.2.4.3.2.2" xref="S3.SS1.p3.9.m2.1.2.4.3.2.2.cmml">λ</mi><mi id="S3.SS1.p3.9.m2.1.2.4.3.2.3" xref="S3.SS1.p3.9.m2.1.2.4.3.2.3.cmml">i</mi></msub></mrow></mrow><mo id="S3.SS1.p3.9.m2.1.2.5" xref="S3.SS1.p3.9.m2.1.2.5.cmml">∈</mo><mrow id="S3.SS1.p3.9.m2.1.2.6" xref="S3.SS1.p3.9.m2.1.2.6.cmml"><mi id="S3.SS1.p3.9.m2.1.2.6.2" mathvariant="normal" xref="S3.SS1.p3.9.m2.1.2.6.2.cmml">Λ</mi><mo id="S3.SS1.p3.9.m2.1.2.6.1" xref="S3.SS1.p3.9.m2.1.2.6.1.cmml">⁢</mo><mrow id="S3.SS1.p3.9.m2.1.2.6.3.2" xref="S3.SS1.p3.9.m2.1.2.6.cmml"><mo id="S3.SS1.p3.9.m2.1.2.6.3.2.1" stretchy="false" xref="S3.SS1.p3.9.m2.1.2.6.cmml">(</mo><mi id="S3.SS1.p3.9.m2.1.1" xref="S3.SS1.p3.9.m2.1.1.cmml">𝐖</mi><mo id="S3.SS1.p3.9.m2.1.2.6.3.2.2" stretchy="false" xref="S3.SS1.p3.9.m2.1.2.6.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.9.m2.1b"><apply id="S3.SS1.p3.9.m2.1.2.cmml" xref="S3.SS1.p3.9.m2.1.2"><and id="S3.SS1.p3.9.m2.1.2a.cmml" xref="S3.SS1.p3.9.m2.1.2"></and><apply id="S3.SS1.p3.9.m2.1.2b.cmml" xref="S3.SS1.p3.9.m2.1.2"><gt id="S3.SS1.p3.9.m2.1.2.3.cmml" xref="S3.SS1.p3.9.m2.1.2.3"></gt><apply id="S3.SS1.p3.9.m2.1.2.2.cmml" xref="S3.SS1.p3.9.m2.1.2.2"><apply id="S3.SS1.p3.9.m2.1.2.2.1.cmml" xref="S3.SS1.p3.9.m2.1.2.2.1"><csymbol cd="ambiguous" id="S3.SS1.p3.9.m2.1.2.2.1.1.cmml" xref="S3.SS1.p3.9.m2.1.2.2.1">superscript</csymbol><apply id="S3.SS1.p3.9.m2.1.2.2.1.2.cmml" xref="S3.SS1.p3.9.m2.1.2.2.1"><csymbol cd="ambiguous" id="S3.SS1.p3.9.m2.1.2.2.1.2.1.cmml" xref="S3.SS1.p3.9.m2.1.2.2.1">subscript</csymbol><sum id="S3.SS1.p3.9.m2.1.2.2.1.2.2.cmml" xref="S3.SS1.p3.9.m2.1.2.2.1.2.2"></sum><apply id="S3.SS1.p3.9.m2.1.2.2.1.2.3.cmml" xref="S3.SS1.p3.9.m2.1.2.2.1.2.3"><eq id="S3.SS1.p3.9.m2.1.2.2.1.2.3.1.cmml" xref="S3.SS1.p3.9.m2.1.2.2.1.2.3.1"></eq><ci id="S3.SS1.p3.9.m2.1.2.2.1.2.3.2.cmml" xref="S3.SS1.p3.9.m2.1.2.2.1.2.3.2">𝑘</ci><cn id="S3.SS1.p3.9.m2.1.2.2.1.2.3.3.cmml" type="integer" xref="S3.SS1.p3.9.m2.1.2.2.1.2.3.3">0</cn></apply></apply><infinity id="S3.SS1.p3.9.m2.1.2.2.1.3.cmml" xref="S3.SS1.p3.9.m2.1.2.2.1.3"></infinity></apply><apply id="S3.SS1.p3.9.m2.1.2.2.2.cmml" xref="S3.SS1.p3.9.m2.1.2.2.2"><times id="S3.SS1.p3.9.m2.1.2.2.2.1.cmml" xref="S3.SS1.p3.9.m2.1.2.2.2.1"></times><apply id="S3.SS1.p3.9.m2.1.2.2.2.2.cmml" xref="S3.SS1.p3.9.m2.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p3.9.m2.1.2.2.2.2.1.cmml" xref="S3.SS1.p3.9.m2.1.2.2.2.2">subscript</csymbol><ci id="S3.SS1.p3.9.m2.1.2.2.2.2.2.cmml" xref="S3.SS1.p3.9.m2.1.2.2.2.2.2">𝛼</ci><ci id="S3.SS1.p3.9.m2.1.2.2.2.2.3.cmml" xref="S3.SS1.p3.9.m2.1.2.2.2.2.3">𝑘</ci></apply><apply id="S3.SS1.p3.9.m2.1.2.2.2.3.cmml" xref="S3.SS1.p3.9.m2.1.2.2.2.3"><csymbol cd="ambiguous" id="S3.SS1.p3.9.m2.1.2.2.2.3.1.cmml" xref="S3.SS1.p3.9.m2.1.2.2.2.3">superscript</csymbol><apply id="S3.SS1.p3.9.m2.1.2.2.2.3.2.cmml" xref="S3.SS1.p3.9.m2.1.2.2.2.3"><csymbol cd="ambiguous" id="S3.SS1.p3.9.m2.1.2.2.2.3.2.1.cmml" xref="S3.SS1.p3.9.m2.1.2.2.2.3">subscript</csymbol><ci id="S3.SS1.p3.9.m2.1.2.2.2.3.2.2.cmml" xref="S3.SS1.p3.9.m2.1.2.2.2.3.2.2">𝜆</ci><ci id="S3.SS1.p3.9.m2.1.2.2.2.3.2.3.cmml" xref="S3.SS1.p3.9.m2.1.2.2.2.3.2.3">𝑖</ci></apply><ci id="S3.SS1.p3.9.m2.1.2.2.2.3.3.cmml" xref="S3.SS1.p3.9.m2.1.2.2.2.3.3">𝑘</ci></apply></apply></apply><apply id="S3.SS1.p3.9.m2.1.2.4.cmml" xref="S3.SS1.p3.9.m2.1.2.4"><times id="S3.SS1.p3.9.m2.1.2.4.1.cmml" xref="S3.SS1.p3.9.m2.1.2.4.1"></times><cn id="S3.SS1.p3.9.m2.1.2.4.2.cmml" type="integer" xref="S3.SS1.p3.9.m2.1.2.4.2">0</cn><apply id="S3.SS1.p3.9.m2.1.2.4.3.cmml" xref="S3.SS1.p3.9.m2.1.2.4.3"><csymbol cd="latexml" id="S3.SS1.p3.9.m2.1.2.4.3.1.cmml" xref="S3.SS1.p3.9.m2.1.2.4.3.1">for-all</csymbol><apply id="S3.SS1.p3.9.m2.1.2.4.3.2.cmml" xref="S3.SS1.p3.9.m2.1.2.4.3.2"><csymbol cd="ambiguous" id="S3.SS1.p3.9.m2.1.2.4.3.2.1.cmml" xref="S3.SS1.p3.9.m2.1.2.4.3.2">subscript</csymbol><ci id="S3.SS1.p3.9.m2.1.2.4.3.2.2.cmml" xref="S3.SS1.p3.9.m2.1.2.4.3.2.2">𝜆</ci><ci id="S3.SS1.p3.9.m2.1.2.4.3.2.3.cmml" xref="S3.SS1.p3.9.m2.1.2.4.3.2.3">𝑖</ci></apply></apply></apply></apply><apply id="S3.SS1.p3.9.m2.1.2c.cmml" xref="S3.SS1.p3.9.m2.1.2"><in id="S3.SS1.p3.9.m2.1.2.5.cmml" xref="S3.SS1.p3.9.m2.1.2.5"></in><share href="https://arxiv.org/html/2410.03462v1#S3.SS1.p3.9.m2.1.2.4.cmml" id="S3.SS1.p3.9.m2.1.2d.cmml" xref="S3.SS1.p3.9.m2.1.2"></share><apply id="S3.SS1.p3.9.m2.1.2.6.cmml" xref="S3.SS1.p3.9.m2.1.2.6"><times id="S3.SS1.p3.9.m2.1.2.6.1.cmml" xref="S3.SS1.p3.9.m2.1.2.6.1"></times><ci id="S3.SS1.p3.9.m2.1.2.6.2.cmml" xref="S3.SS1.p3.9.m2.1.2.6.2">Λ</ci><ci id="S3.SS1.p3.9.m2.1.1.cmml" xref="S3.SS1.p3.9.m2.1.1">𝐖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.9.m2.1c">\sum_{k=0}^{\infty}\alpha_{k}\lambda_{i}^{k}&gt;0\hskip 1.99997pt\forall\hskip 1.%
99997pt\lambda_{i}\in\Lambda(\mathbf{W})</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.9.m2.1d">∑ start_POSTSUBSCRIPT italic_k = 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∞ end_POSTSUPERSCRIPT italic_α start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT italic_λ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT &gt; 0 ∀ italic_λ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∈ roman_Λ ( bold_W )</annotation></semantics></math>, where <math alttext="\Lambda(\mathbf{W})" class="ltx_Math" display="inline" id="S3.SS1.p3.10.m3.1"><semantics id="S3.SS1.p3.10.m3.1a"><mrow id="S3.SS1.p3.10.m3.1.2" xref="S3.SS1.p3.10.m3.1.2.cmml"><mi id="S3.SS1.p3.10.m3.1.2.2" mathvariant="normal" xref="S3.SS1.p3.10.m3.1.2.2.cmml">Λ</mi><mo id="S3.SS1.p3.10.m3.1.2.1" xref="S3.SS1.p3.10.m3.1.2.1.cmml">⁢</mo><mrow id="S3.SS1.p3.10.m3.1.2.3.2" xref="S3.SS1.p3.10.m3.1.2.cmml"><mo id="S3.SS1.p3.10.m3.1.2.3.2.1" stretchy="false" xref="S3.SS1.p3.10.m3.1.2.cmml">(</mo><mi id="S3.SS1.p3.10.m3.1.1" xref="S3.SS1.p3.10.m3.1.1.cmml">𝐖</mi><mo id="S3.SS1.p3.10.m3.1.2.3.2.2" stretchy="false" xref="S3.SS1.p3.10.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.10.m3.1b"><apply id="S3.SS1.p3.10.m3.1.2.cmml" xref="S3.SS1.p3.10.m3.1.2"><times id="S3.SS1.p3.10.m3.1.2.1.cmml" xref="S3.SS1.p3.10.m3.1.2.1"></times><ci id="S3.SS1.p3.10.m3.1.2.2.cmml" xref="S3.SS1.p3.10.m3.1.2.2">Λ</ci><ci id="S3.SS1.p3.10.m3.1.1.cmml" xref="S3.SS1.p3.10.m3.1.1">𝐖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.10.m3.1c">\Lambda(\mathbf{W})</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.10.m3.1d">roman_Λ ( bold_W )</annotation></semantics></math> denotes the set of eigenvalues of <math alttext="\mathbf{W}" class="ltx_Math" display="inline" id="S3.SS1.p3.11.m4.1"><semantics id="S3.SS1.p3.11.m4.1a"><mi id="S3.SS1.p3.11.m4.1.1" xref="S3.SS1.p3.11.m4.1.1.cmml">𝐖</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.11.m4.1b"><ci id="S3.SS1.p3.11.m4.1.1.cmml" xref="S3.SS1.p3.11.m4.1.1">𝐖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.11.m4.1c">\mathbf{W}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.11.m4.1d">bold_W</annotation></semantics></math>.
With different choices for <math alttext="(\alpha_{k})_{k=0}^{\infty}" class="ltx_Math" display="inline" id="S3.SS1.p3.12.m5.1"><semantics id="S3.SS1.p3.12.m5.1a"><msubsup id="S3.SS1.p3.12.m5.1.1" xref="S3.SS1.p3.12.m5.1.1.cmml"><mrow id="S3.SS1.p3.12.m5.1.1.1.1.1" xref="S3.SS1.p3.12.m5.1.1.1.1.1.1.cmml"><mo id="S3.SS1.p3.12.m5.1.1.1.1.1.2" stretchy="false" xref="S3.SS1.p3.12.m5.1.1.1.1.1.1.cmml">(</mo><msub id="S3.SS1.p3.12.m5.1.1.1.1.1.1" xref="S3.SS1.p3.12.m5.1.1.1.1.1.1.cmml"><mi id="S3.SS1.p3.12.m5.1.1.1.1.1.1.2" xref="S3.SS1.p3.12.m5.1.1.1.1.1.1.2.cmml">α</mi><mi id="S3.SS1.p3.12.m5.1.1.1.1.1.1.3" xref="S3.SS1.p3.12.m5.1.1.1.1.1.1.3.cmml">k</mi></msub><mo id="S3.SS1.p3.12.m5.1.1.1.1.1.3" stretchy="false" xref="S3.SS1.p3.12.m5.1.1.1.1.1.1.cmml">)</mo></mrow><mrow id="S3.SS1.p3.12.m5.1.1.1.3" xref="S3.SS1.p3.12.m5.1.1.1.3.cmml"><mi id="S3.SS1.p3.12.m5.1.1.1.3.2" xref="S3.SS1.p3.12.m5.1.1.1.3.2.cmml">k</mi><mo id="S3.SS1.p3.12.m5.1.1.1.3.1" xref="S3.SS1.p3.12.m5.1.1.1.3.1.cmml">=</mo><mn id="S3.SS1.p3.12.m5.1.1.1.3.3" xref="S3.SS1.p3.12.m5.1.1.1.3.3.cmml">0</mn></mrow><mi id="S3.SS1.p3.12.m5.1.1.3" mathvariant="normal" xref="S3.SS1.p3.12.m5.1.1.3.cmml">∞</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.12.m5.1b"><apply id="S3.SS1.p3.12.m5.1.1.cmml" xref="S3.SS1.p3.12.m5.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.12.m5.1.1.2.cmml" xref="S3.SS1.p3.12.m5.1.1">superscript</csymbol><apply id="S3.SS1.p3.12.m5.1.1.1.cmml" xref="S3.SS1.p3.12.m5.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.12.m5.1.1.1.2.cmml" xref="S3.SS1.p3.12.m5.1.1">subscript</csymbol><apply id="S3.SS1.p3.12.m5.1.1.1.1.1.1.cmml" xref="S3.SS1.p3.12.m5.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.12.m5.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p3.12.m5.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p3.12.m5.1.1.1.1.1.1.2.cmml" xref="S3.SS1.p3.12.m5.1.1.1.1.1.1.2">𝛼</ci><ci id="S3.SS1.p3.12.m5.1.1.1.1.1.1.3.cmml" xref="S3.SS1.p3.12.m5.1.1.1.1.1.1.3">𝑘</ci></apply><apply id="S3.SS1.p3.12.m5.1.1.1.3.cmml" xref="S3.SS1.p3.12.m5.1.1.1.3"><eq id="S3.SS1.p3.12.m5.1.1.1.3.1.cmml" xref="S3.SS1.p3.12.m5.1.1.1.3.1"></eq><ci id="S3.SS1.p3.12.m5.1.1.1.3.2.cmml" xref="S3.SS1.p3.12.m5.1.1.1.3.2">𝑘</ci><cn id="S3.SS1.p3.12.m5.1.1.1.3.3.cmml" type="integer" xref="S3.SS1.p3.12.m5.1.1.1.3.3">0</cn></apply></apply><infinity id="S3.SS1.p3.12.m5.1.1.3.cmml" xref="S3.SS1.p3.12.m5.1.1.3"></infinity></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.12.m5.1c">(\alpha_{k})_{k=0}^{\infty}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.12.m5.1d">( italic_α start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ) start_POSTSUBSCRIPT italic_k = 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∞ end_POSTSUPERSCRIPT</annotation></semantics></math>, Eq.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#S3.E4" title="In 3.1 Graph node kernels as topological masks ‣ 3 Towards linear topological masking ‣ Linear Transformer Topological Masking with Graph Random Features"><span class="ltx_text ltx_ref_tag">4</span></a> includes many of the most popular graph node kernels in the literature, e.g.&nbsp;heat, diffusion, cosine and <math alttext="p" class="ltx_Math" display="inline" id="S3.SS1.p3.13.m6.1"><semantics id="S3.SS1.p3.13.m6.1a"><mi id="S3.SS1.p3.13.m6.1.1" xref="S3.SS1.p3.13.m6.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.13.m6.1b"><ci id="S3.SS1.p3.13.m6.1.1.cmml" xref="S3.SS1.p3.13.m6.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.13.m6.1c">p</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.13.m6.1d">italic_p</annotation></semantics></math>-step random walk.
Kernel learning can be implemented by optimising <math alttext="\alpha_{k}" class="ltx_Math" display="inline" id="S3.SS1.p3.14.m7.1"><semantics id="S3.SS1.p3.14.m7.1a"><msub id="S3.SS1.p3.14.m7.1.1" xref="S3.SS1.p3.14.m7.1.1.cmml"><mi id="S3.SS1.p3.14.m7.1.1.2" xref="S3.SS1.p3.14.m7.1.1.2.cmml">α</mi><mi id="S3.SS1.p3.14.m7.1.1.3" xref="S3.SS1.p3.14.m7.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.14.m7.1b"><apply id="S3.SS1.p3.14.m7.1.1.cmml" xref="S3.SS1.p3.14.m7.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.14.m7.1.1.1.cmml" xref="S3.SS1.p3.14.m7.1.1">subscript</csymbol><ci id="S3.SS1.p3.14.m7.1.1.2.cmml" xref="S3.SS1.p3.14.m7.1.1.2">𝛼</ci><ci id="S3.SS1.p3.14.m7.1.1.3.cmml" xref="S3.SS1.p3.14.m7.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.14.m7.1c">\alpha_{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.14.m7.1d">italic_α start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> <cite class="ltx_cite ltx_citemacro_citep">(Reid et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#bib.bib29" title="">2024b</a>; Zhi et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#bib.bib44" title="">2023</a>)</cite>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS1.p4">
<p class="ltx_p" id="S3.SS1.p4.2">Eq.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#S3.E4" title="In 3.1 Graph node kernels as topological masks ‣ 3 Towards linear topological masking ‣ Linear Transformer Topological Masking with Graph Random Features"><span class="ltx_text ltx_ref_tag">4</span></a> provides a very effective parameterisation for topological attention masks, striking the right balance between flexibility and hard-coded structural inductive bias.
In Sec.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#S4" title="4 Experiments ‣ Linear Transformer Topological Masking with Graph Random Features"><span class="ltx_text ltx_ref_tag">4</span></a> we will show that it boosts performance compared to unmasked attention.
However, explicitly computing <math alttext="\mathbf{M}_{\alpha}(\mathcal{G})\in\mathbb{R}^{N\times N}" class="ltx_Math" display="inline" id="S3.SS1.p4.1.m1.1"><semantics id="S3.SS1.p4.1.m1.1a"><mrow id="S3.SS1.p4.1.m1.1.2" xref="S3.SS1.p4.1.m1.1.2.cmml"><mrow id="S3.SS1.p4.1.m1.1.2.2" xref="S3.SS1.p4.1.m1.1.2.2.cmml"><msub id="S3.SS1.p4.1.m1.1.2.2.2" xref="S3.SS1.p4.1.m1.1.2.2.2.cmml"><mi id="S3.SS1.p4.1.m1.1.2.2.2.2" xref="S3.SS1.p4.1.m1.1.2.2.2.2.cmml">𝐌</mi><mi id="S3.SS1.p4.1.m1.1.2.2.2.3" xref="S3.SS1.p4.1.m1.1.2.2.2.3.cmml">α</mi></msub><mo id="S3.SS1.p4.1.m1.1.2.2.1" xref="S3.SS1.p4.1.m1.1.2.2.1.cmml">⁢</mo><mrow id="S3.SS1.p4.1.m1.1.2.2.3.2" xref="S3.SS1.p4.1.m1.1.2.2.cmml"><mo id="S3.SS1.p4.1.m1.1.2.2.3.2.1" stretchy="false" xref="S3.SS1.p4.1.m1.1.2.2.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p4.1.m1.1.1" xref="S3.SS1.p4.1.m1.1.1.cmml">𝒢</mi><mo id="S3.SS1.p4.1.m1.1.2.2.3.2.2" stretchy="false" xref="S3.SS1.p4.1.m1.1.2.2.cmml">)</mo></mrow></mrow><mo id="S3.SS1.p4.1.m1.1.2.1" xref="S3.SS1.p4.1.m1.1.2.1.cmml">∈</mo><msup id="S3.SS1.p4.1.m1.1.2.3" xref="S3.SS1.p4.1.m1.1.2.3.cmml"><mi id="S3.SS1.p4.1.m1.1.2.3.2" xref="S3.SS1.p4.1.m1.1.2.3.2.cmml">ℝ</mi><mrow id="S3.SS1.p4.1.m1.1.2.3.3" xref="S3.SS1.p4.1.m1.1.2.3.3.cmml"><mi id="S3.SS1.p4.1.m1.1.2.3.3.2" xref="S3.SS1.p4.1.m1.1.2.3.3.2.cmml">N</mi><mo id="S3.SS1.p4.1.m1.1.2.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS1.p4.1.m1.1.2.3.3.1.cmml">×</mo><mi id="S3.SS1.p4.1.m1.1.2.3.3.3" xref="S3.SS1.p4.1.m1.1.2.3.3.3.cmml">N</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.1.m1.1b"><apply id="S3.SS1.p4.1.m1.1.2.cmml" xref="S3.SS1.p4.1.m1.1.2"><in id="S3.SS1.p4.1.m1.1.2.1.cmml" xref="S3.SS1.p4.1.m1.1.2.1"></in><apply id="S3.SS1.p4.1.m1.1.2.2.cmml" xref="S3.SS1.p4.1.m1.1.2.2"><times id="S3.SS1.p4.1.m1.1.2.2.1.cmml" xref="S3.SS1.p4.1.m1.1.2.2.1"></times><apply id="S3.SS1.p4.1.m1.1.2.2.2.cmml" xref="S3.SS1.p4.1.m1.1.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p4.1.m1.1.2.2.2.1.cmml" xref="S3.SS1.p4.1.m1.1.2.2.2">subscript</csymbol><ci id="S3.SS1.p4.1.m1.1.2.2.2.2.cmml" xref="S3.SS1.p4.1.m1.1.2.2.2.2">𝐌</ci><ci id="S3.SS1.p4.1.m1.1.2.2.2.3.cmml" xref="S3.SS1.p4.1.m1.1.2.2.2.3">𝛼</ci></apply><ci id="S3.SS1.p4.1.m1.1.1.cmml" xref="S3.SS1.p4.1.m1.1.1">𝒢</ci></apply><apply id="S3.SS1.p4.1.m1.1.2.3.cmml" xref="S3.SS1.p4.1.m1.1.2.3"><csymbol cd="ambiguous" id="S3.SS1.p4.1.m1.1.2.3.1.cmml" xref="S3.SS1.p4.1.m1.1.2.3">superscript</csymbol><ci id="S3.SS1.p4.1.m1.1.2.3.2.cmml" xref="S3.SS1.p4.1.m1.1.2.3.2">ℝ</ci><apply id="S3.SS1.p4.1.m1.1.2.3.3.cmml" xref="S3.SS1.p4.1.m1.1.2.3.3"><times id="S3.SS1.p4.1.m1.1.2.3.3.1.cmml" xref="S3.SS1.p4.1.m1.1.2.3.3.1"></times><ci id="S3.SS1.p4.1.m1.1.2.3.3.2.cmml" xref="S3.SS1.p4.1.m1.1.2.3.3.2">𝑁</ci><ci id="S3.SS1.p4.1.m1.1.2.3.3.3.cmml" xref="S3.SS1.p4.1.m1.1.2.3.3.3">𝑁</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.1.m1.1c">\mathbf{M}_{\alpha}(\mathcal{G})\in\mathbb{R}^{N\times N}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p4.1.m1.1d">bold_M start_POSTSUBSCRIPT italic_α end_POSTSUBSCRIPT ( caligraphic_G ) ∈ blackboard_R start_POSTSUPERSCRIPT italic_N × italic_N end_POSTSUPERSCRIPT</annotation></semantics></math> and storing it in memory is incompatible with <math alttext="\mathcal{O}(N)" class="ltx_Math" display="inline" id="S3.SS1.p4.2.m2.1"><semantics id="S3.SS1.p4.2.m2.1a"><mrow id="S3.SS1.p4.2.m2.1.2" xref="S3.SS1.p4.2.m2.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p4.2.m2.1.2.2" xref="S3.SS1.p4.2.m2.1.2.2.cmml">𝒪</mi><mo id="S3.SS1.p4.2.m2.1.2.1" xref="S3.SS1.p4.2.m2.1.2.1.cmml">⁢</mo><mrow id="S3.SS1.p4.2.m2.1.2.3.2" xref="S3.SS1.p4.2.m2.1.2.cmml"><mo id="S3.SS1.p4.2.m2.1.2.3.2.1" stretchy="false" xref="S3.SS1.p4.2.m2.1.2.cmml">(</mo><mi id="S3.SS1.p4.2.m2.1.1" xref="S3.SS1.p4.2.m2.1.1.cmml">N</mi><mo id="S3.SS1.p4.2.m2.1.2.3.2.2" stretchy="false" xref="S3.SS1.p4.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.2.m2.1b"><apply id="S3.SS1.p4.2.m2.1.2.cmml" xref="S3.SS1.p4.2.m2.1.2"><times id="S3.SS1.p4.2.m2.1.2.1.cmml" xref="S3.SS1.p4.2.m2.1.2.1"></times><ci id="S3.SS1.p4.2.m2.1.2.2.cmml" xref="S3.SS1.p4.2.m2.1.2.2">𝒪</ci><ci id="S3.SS1.p4.2.m2.1.1.cmml" xref="S3.SS1.p4.2.m2.1.1">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.2.m2.1c">\mathcal{O}(N)</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p4.2.m2.1d">caligraphic_O ( italic_N )</annotation></semantics></math> low-rank attention.
The next section will show how this can be avoided by masking <em class="ltx_emph ltx_font_italic" id="S3.SS1.p4.2.1">implicitly</em>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Implicit masking with graph features</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.3">Linear attention is fast because it replaces softmax attention <math alttext="\exp(\mathbf{q}_{i}^{\top}\mathbf{k}_{j})" class="ltx_Math" display="inline" id="S3.SS2.p1.1.m1.2"><semantics id="S3.SS2.p1.1.m1.2a"><mrow id="S3.SS2.p1.1.m1.2.2.1" xref="S3.SS2.p1.1.m1.2.2.2.cmml"><mi id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml">exp</mi><mo id="S3.SS2.p1.1.m1.2.2.1a" xref="S3.SS2.p1.1.m1.2.2.2.cmml">⁡</mo><mrow id="S3.SS2.p1.1.m1.2.2.1.1" xref="S3.SS2.p1.1.m1.2.2.2.cmml"><mo id="S3.SS2.p1.1.m1.2.2.1.1.2" stretchy="false" xref="S3.SS2.p1.1.m1.2.2.2.cmml">(</mo><mrow id="S3.SS2.p1.1.m1.2.2.1.1.1" xref="S3.SS2.p1.1.m1.2.2.1.1.1.cmml"><msubsup id="S3.SS2.p1.1.m1.2.2.1.1.1.2" xref="S3.SS2.p1.1.m1.2.2.1.1.1.2.cmml"><mi id="S3.SS2.p1.1.m1.2.2.1.1.1.2.2.2" xref="S3.SS2.p1.1.m1.2.2.1.1.1.2.2.2.cmml">𝐪</mi><mi id="S3.SS2.p1.1.m1.2.2.1.1.1.2.2.3" xref="S3.SS2.p1.1.m1.2.2.1.1.1.2.2.3.cmml">i</mi><mo id="S3.SS2.p1.1.m1.2.2.1.1.1.2.3" xref="S3.SS2.p1.1.m1.2.2.1.1.1.2.3.cmml">⊤</mo></msubsup><mo id="S3.SS2.p1.1.m1.2.2.1.1.1.1" xref="S3.SS2.p1.1.m1.2.2.1.1.1.1.cmml">⁢</mo><msub id="S3.SS2.p1.1.m1.2.2.1.1.1.3" xref="S3.SS2.p1.1.m1.2.2.1.1.1.3.cmml"><mi id="S3.SS2.p1.1.m1.2.2.1.1.1.3.2" xref="S3.SS2.p1.1.m1.2.2.1.1.1.3.2.cmml">𝐤</mi><mi id="S3.SS2.p1.1.m1.2.2.1.1.1.3.3" xref="S3.SS2.p1.1.m1.2.2.1.1.1.3.3.cmml">j</mi></msub></mrow><mo id="S3.SS2.p1.1.m1.2.2.1.1.3" stretchy="false" xref="S3.SS2.p1.1.m1.2.2.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.2b"><apply id="S3.SS2.p1.1.m1.2.2.2.cmml" xref="S3.SS2.p1.1.m1.2.2.1"><exp id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1"></exp><apply id="S3.SS2.p1.1.m1.2.2.1.1.1.cmml" xref="S3.SS2.p1.1.m1.2.2.1.1.1"><times id="S3.SS2.p1.1.m1.2.2.1.1.1.1.cmml" xref="S3.SS2.p1.1.m1.2.2.1.1.1.1"></times><apply id="S3.SS2.p1.1.m1.2.2.1.1.1.2.cmml" xref="S3.SS2.p1.1.m1.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.2.2.1.1.1.2.1.cmml" xref="S3.SS2.p1.1.m1.2.2.1.1.1.2">superscript</csymbol><apply id="S3.SS2.p1.1.m1.2.2.1.1.1.2.2.cmml" xref="S3.SS2.p1.1.m1.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.2.2.1.1.1.2.2.1.cmml" xref="S3.SS2.p1.1.m1.2.2.1.1.1.2">subscript</csymbol><ci id="S3.SS2.p1.1.m1.2.2.1.1.1.2.2.2.cmml" xref="S3.SS2.p1.1.m1.2.2.1.1.1.2.2.2">𝐪</ci><ci id="S3.SS2.p1.1.m1.2.2.1.1.1.2.2.3.cmml" xref="S3.SS2.p1.1.m1.2.2.1.1.1.2.2.3">𝑖</ci></apply><csymbol cd="latexml" id="S3.SS2.p1.1.m1.2.2.1.1.1.2.3.cmml" xref="S3.SS2.p1.1.m1.2.2.1.1.1.2.3">top</csymbol></apply><apply id="S3.SS2.p1.1.m1.2.2.1.1.1.3.cmml" xref="S3.SS2.p1.1.m1.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.2.2.1.1.1.3.1.cmml" xref="S3.SS2.p1.1.m1.2.2.1.1.1.3">subscript</csymbol><ci id="S3.SS2.p1.1.m1.2.2.1.1.1.3.2.cmml" xref="S3.SS2.p1.1.m1.2.2.1.1.1.3.2">𝐤</ci><ci id="S3.SS2.p1.1.m1.2.2.1.1.1.3.3.cmml" xref="S3.SS2.p1.1.m1.2.2.1.1.1.3.3">𝑗</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.2c">\exp(\mathbf{q}_{i}^{\top}\mathbf{k}_{j})</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.1.m1.2d">roman_exp ( bold_q start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT bold_k start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT )</annotation></semantics></math> with a ‘featurised’ alternative <math alttext="\phi(\mathbf{q}_{i})^{\top}\phi(\mathbf{k}_{j})" class="ltx_Math" display="inline" id="S3.SS2.p1.2.m2.2"><semantics id="S3.SS2.p1.2.m2.2a"><mrow id="S3.SS2.p1.2.m2.2.2" xref="S3.SS2.p1.2.m2.2.2.cmml"><mi id="S3.SS2.p1.2.m2.2.2.4" xref="S3.SS2.p1.2.m2.2.2.4.cmml">ϕ</mi><mo id="S3.SS2.p1.2.m2.2.2.3" xref="S3.SS2.p1.2.m2.2.2.3.cmml">⁢</mo><msup id="S3.SS2.p1.2.m2.1.1.1" xref="S3.SS2.p1.2.m2.1.1.1.cmml"><mrow id="S3.SS2.p1.2.m2.1.1.1.1.1" xref="S3.SS2.p1.2.m2.1.1.1.1.1.1.cmml"><mo id="S3.SS2.p1.2.m2.1.1.1.1.1.2" stretchy="false" xref="S3.SS2.p1.2.m2.1.1.1.1.1.1.cmml">(</mo><msub id="S3.SS2.p1.2.m2.1.1.1.1.1.1" xref="S3.SS2.p1.2.m2.1.1.1.1.1.1.cmml"><mi id="S3.SS2.p1.2.m2.1.1.1.1.1.1.2" xref="S3.SS2.p1.2.m2.1.1.1.1.1.1.2.cmml">𝐪</mi><mi id="S3.SS2.p1.2.m2.1.1.1.1.1.1.3" xref="S3.SS2.p1.2.m2.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS2.p1.2.m2.1.1.1.1.1.3" stretchy="false" xref="S3.SS2.p1.2.m2.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.SS2.p1.2.m2.1.1.1.3" xref="S3.SS2.p1.2.m2.1.1.1.3.cmml">⊤</mo></msup><mo id="S3.SS2.p1.2.m2.2.2.3a" xref="S3.SS2.p1.2.m2.2.2.3.cmml">⁢</mo><mi id="S3.SS2.p1.2.m2.2.2.5" xref="S3.SS2.p1.2.m2.2.2.5.cmml">ϕ</mi><mo id="S3.SS2.p1.2.m2.2.2.3b" xref="S3.SS2.p1.2.m2.2.2.3.cmml">⁢</mo><mrow id="S3.SS2.p1.2.m2.2.2.2.1" xref="S3.SS2.p1.2.m2.2.2.2.1.1.cmml"><mo id="S3.SS2.p1.2.m2.2.2.2.1.2" stretchy="false" xref="S3.SS2.p1.2.m2.2.2.2.1.1.cmml">(</mo><msub id="S3.SS2.p1.2.m2.2.2.2.1.1" xref="S3.SS2.p1.2.m2.2.2.2.1.1.cmml"><mi id="S3.SS2.p1.2.m2.2.2.2.1.1.2" xref="S3.SS2.p1.2.m2.2.2.2.1.1.2.cmml">𝐤</mi><mi id="S3.SS2.p1.2.m2.2.2.2.1.1.3" xref="S3.SS2.p1.2.m2.2.2.2.1.1.3.cmml">j</mi></msub><mo id="S3.SS2.p1.2.m2.2.2.2.1.3" stretchy="false" xref="S3.SS2.p1.2.m2.2.2.2.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.2b"><apply id="S3.SS2.p1.2.m2.2.2.cmml" xref="S3.SS2.p1.2.m2.2.2"><times id="S3.SS2.p1.2.m2.2.2.3.cmml" xref="S3.SS2.p1.2.m2.2.2.3"></times><ci id="S3.SS2.p1.2.m2.2.2.4.cmml" xref="S3.SS2.p1.2.m2.2.2.4">italic-ϕ</ci><apply id="S3.SS2.p1.2.m2.1.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.1.1.1.2.cmml" xref="S3.SS2.p1.2.m2.1.1.1">superscript</csymbol><apply id="S3.SS2.p1.2.m2.1.1.1.1.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.p1.2.m2.1.1.1.1.1.1.2.cmml" xref="S3.SS2.p1.2.m2.1.1.1.1.1.1.2">𝐪</ci><ci id="S3.SS2.p1.2.m2.1.1.1.1.1.1.3.cmml" xref="S3.SS2.p1.2.m2.1.1.1.1.1.1.3">𝑖</ci></apply><csymbol cd="latexml" id="S3.SS2.p1.2.m2.1.1.1.3.cmml" xref="S3.SS2.p1.2.m2.1.1.1.3">top</csymbol></apply><ci id="S3.SS2.p1.2.m2.2.2.5.cmml" xref="S3.SS2.p1.2.m2.2.2.5">italic-ϕ</ci><apply id="S3.SS2.p1.2.m2.2.2.2.1.1.cmml" xref="S3.SS2.p1.2.m2.2.2.2.1"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.2.2.2.1.1.1.cmml" xref="S3.SS2.p1.2.m2.2.2.2.1">subscript</csymbol><ci id="S3.SS2.p1.2.m2.2.2.2.1.1.2.cmml" xref="S3.SS2.p1.2.m2.2.2.2.1.1.2">𝐤</ci><ci id="S3.SS2.p1.2.m2.2.2.2.1.1.3.cmml" xref="S3.SS2.p1.2.m2.2.2.2.1.1.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.2c">\phi(\mathbf{q}_{i})^{\top}\phi(\mathbf{k}_{j})</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.2.m2.2d">italic_ϕ ( bold_q start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT italic_ϕ ( bold_k start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT )</annotation></semantics></math>. Can we do the same for <math alttext="\mathbf{M}_{\alpha}(\mathcal{G})" class="ltx_Math" display="inline" id="S3.SS2.p1.3.m3.1"><semantics id="S3.SS2.p1.3.m3.1a"><mrow id="S3.SS2.p1.3.m3.1.2" xref="S3.SS2.p1.3.m3.1.2.cmml"><msub id="S3.SS2.p1.3.m3.1.2.2" xref="S3.SS2.p1.3.m3.1.2.2.cmml"><mi id="S3.SS2.p1.3.m3.1.2.2.2" xref="S3.SS2.p1.3.m3.1.2.2.2.cmml">𝐌</mi><mi id="S3.SS2.p1.3.m3.1.2.2.3" xref="S3.SS2.p1.3.m3.1.2.2.3.cmml">α</mi></msub><mo id="S3.SS2.p1.3.m3.1.2.1" xref="S3.SS2.p1.3.m3.1.2.1.cmml">⁢</mo><mrow id="S3.SS2.p1.3.m3.1.2.3.2" xref="S3.SS2.p1.3.m3.1.2.cmml"><mo id="S3.SS2.p1.3.m3.1.2.3.2.1" stretchy="false" xref="S3.SS2.p1.3.m3.1.2.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.3.m3.1.1" xref="S3.SS2.p1.3.m3.1.1.cmml">𝒢</mi><mo id="S3.SS2.p1.3.m3.1.2.3.2.2" stretchy="false" xref="S3.SS2.p1.3.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.3.m3.1b"><apply id="S3.SS2.p1.3.m3.1.2.cmml" xref="S3.SS2.p1.3.m3.1.2"><times id="S3.SS2.p1.3.m3.1.2.1.cmml" xref="S3.SS2.p1.3.m3.1.2.1"></times><apply id="S3.SS2.p1.3.m3.1.2.2.cmml" xref="S3.SS2.p1.3.m3.1.2.2"><csymbol cd="ambiguous" id="S3.SS2.p1.3.m3.1.2.2.1.cmml" xref="S3.SS2.p1.3.m3.1.2.2">subscript</csymbol><ci id="S3.SS2.p1.3.m3.1.2.2.2.cmml" xref="S3.SS2.p1.3.m3.1.2.2.2">𝐌</ci><ci id="S3.SS2.p1.3.m3.1.2.2.3.cmml" xref="S3.SS2.p1.3.m3.1.2.2.3">𝛼</ci></apply><ci id="S3.SS2.p1.3.m3.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1">𝒢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.3.m3.1c">\mathbf{M}_{\alpha}(\mathcal{G})</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.3.m3.1d">bold_M start_POSTSUBSCRIPT italic_α end_POSTSUBSCRIPT ( caligraphic_G )</annotation></semantics></math>?
The following is true.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_theorem ltx_theorem_remark" id="S3.Thmremark1">
<h6 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span class="ltx_text ltx_font_bold" id="S3.Thmremark1.2.1.1">Remark 3.1</span></span><span class="ltx_text ltx_font_bold" id="S3.Thmremark1.3.2"> </span>(Explicit <math alttext="N" class="ltx_Math" display="inline" id="S3.Thmremark1.1.m1.1"><semantics id="S3.Thmremark1.1.m1.1b"><mi id="S3.Thmremark1.1.m1.1.1" xref="S3.Thmremark1.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.Thmremark1.1.m1.1c"><ci id="S3.Thmremark1.1.m1.1.1.cmml" xref="S3.Thmremark1.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmremark1.1.m1.1d">N</annotation><annotation encoding="application/x-llamapun" id="S3.Thmremark1.1.m1.1e">italic_N</annotation></semantics></math>-dimensional features for graph node kernels <cite class="ltx_cite ltx_citemacro_citep">(Reid et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#bib.bib29" title="">2024b</a>)</cite>)<span class="ltx_text ltx_font_bold" id="S3.Thmremark1.4.3">.</span>
</h6><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S3.Thmremark1.p1">
<p class="ltx_p" id="S3.Thmremark1.p1.6"><span class="ltx_text ltx_font_italic" id="S3.Thmremark1.p1.6.6">Let <math alttext="(f_{k})_{k=0}^{\infty}\subset\mathbb{R}" class="ltx_Math" display="inline" id="S3.Thmremark1.p1.1.1.m1.1"><semantics id="S3.Thmremark1.p1.1.1.m1.1a"><mrow id="S3.Thmremark1.p1.1.1.m1.1.1" xref="S3.Thmremark1.p1.1.1.m1.1.1.cmml"><msubsup id="S3.Thmremark1.p1.1.1.m1.1.1.1" xref="S3.Thmremark1.p1.1.1.m1.1.1.1.cmml"><mrow id="S3.Thmremark1.p1.1.1.m1.1.1.1.1.1.1" xref="S3.Thmremark1.p1.1.1.m1.1.1.1.1.1.1.1.cmml"><mo id="S3.Thmremark1.p1.1.1.m1.1.1.1.1.1.1.2" stretchy="false" xref="S3.Thmremark1.p1.1.1.m1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.Thmremark1.p1.1.1.m1.1.1.1.1.1.1.1" xref="S3.Thmremark1.p1.1.1.m1.1.1.1.1.1.1.1.cmml"><mi id="S3.Thmremark1.p1.1.1.m1.1.1.1.1.1.1.1.2" xref="S3.Thmremark1.p1.1.1.m1.1.1.1.1.1.1.1.2.cmml">f</mi><mi id="S3.Thmremark1.p1.1.1.m1.1.1.1.1.1.1.1.3" xref="S3.Thmremark1.p1.1.1.m1.1.1.1.1.1.1.1.3.cmml">k</mi></msub><mo id="S3.Thmremark1.p1.1.1.m1.1.1.1.1.1.1.3" stretchy="false" xref="S3.Thmremark1.p1.1.1.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mrow id="S3.Thmremark1.p1.1.1.m1.1.1.1.1.3" xref="S3.Thmremark1.p1.1.1.m1.1.1.1.1.3.cmml"><mi id="S3.Thmremark1.p1.1.1.m1.1.1.1.1.3.2" xref="S3.Thmremark1.p1.1.1.m1.1.1.1.1.3.2.cmml">k</mi><mo id="S3.Thmremark1.p1.1.1.m1.1.1.1.1.3.1" xref="S3.Thmremark1.p1.1.1.m1.1.1.1.1.3.1.cmml">=</mo><mn id="S3.Thmremark1.p1.1.1.m1.1.1.1.1.3.3" xref="S3.Thmremark1.p1.1.1.m1.1.1.1.1.3.3.cmml">0</mn></mrow><mi id="S3.Thmremark1.p1.1.1.m1.1.1.1.3" mathvariant="normal" xref="S3.Thmremark1.p1.1.1.m1.1.1.1.3.cmml">∞</mi></msubsup><mo id="S3.Thmremark1.p1.1.1.m1.1.1.2" xref="S3.Thmremark1.p1.1.1.m1.1.1.2.cmml">⊂</mo><mi id="S3.Thmremark1.p1.1.1.m1.1.1.3" xref="S3.Thmremark1.p1.1.1.m1.1.1.3.cmml">ℝ</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.Thmremark1.p1.1.1.m1.1b"><apply id="S3.Thmremark1.p1.1.1.m1.1.1.cmml" xref="S3.Thmremark1.p1.1.1.m1.1.1"><subset id="S3.Thmremark1.p1.1.1.m1.1.1.2.cmml" xref="S3.Thmremark1.p1.1.1.m1.1.1.2"></subset><apply id="S3.Thmremark1.p1.1.1.m1.1.1.1.cmml" xref="S3.Thmremark1.p1.1.1.m1.1.1.1"><csymbol cd="ambiguous" id="S3.Thmremark1.p1.1.1.m1.1.1.1.2.cmml" xref="S3.Thmremark1.p1.1.1.m1.1.1.1">superscript</csymbol><apply id="S3.Thmremark1.p1.1.1.m1.1.1.1.1.cmml" xref="S3.Thmremark1.p1.1.1.m1.1.1.1"><csymbol cd="ambiguous" id="S3.Thmremark1.p1.1.1.m1.1.1.1.1.2.cmml" xref="S3.Thmremark1.p1.1.1.m1.1.1.1">subscript</csymbol><apply id="S3.Thmremark1.p1.1.1.m1.1.1.1.1.1.1.1.cmml" xref="S3.Thmremark1.p1.1.1.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Thmremark1.p1.1.1.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.Thmremark1.p1.1.1.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.Thmremark1.p1.1.1.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.Thmremark1.p1.1.1.m1.1.1.1.1.1.1.1.2">𝑓</ci><ci id="S3.Thmremark1.p1.1.1.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.Thmremark1.p1.1.1.m1.1.1.1.1.1.1.1.3">𝑘</ci></apply><apply id="S3.Thmremark1.p1.1.1.m1.1.1.1.1.3.cmml" xref="S3.Thmremark1.p1.1.1.m1.1.1.1.1.3"><eq id="S3.Thmremark1.p1.1.1.m1.1.1.1.1.3.1.cmml" xref="S3.Thmremark1.p1.1.1.m1.1.1.1.1.3.1"></eq><ci id="S3.Thmremark1.p1.1.1.m1.1.1.1.1.3.2.cmml" xref="S3.Thmremark1.p1.1.1.m1.1.1.1.1.3.2">𝑘</ci><cn id="S3.Thmremark1.p1.1.1.m1.1.1.1.1.3.3.cmml" type="integer" xref="S3.Thmremark1.p1.1.1.m1.1.1.1.1.3.3">0</cn></apply></apply><infinity id="S3.Thmremark1.p1.1.1.m1.1.1.1.3.cmml" xref="S3.Thmremark1.p1.1.1.m1.1.1.1.3"></infinity></apply><ci id="S3.Thmremark1.p1.1.1.m1.1.1.3.cmml" xref="S3.Thmremark1.p1.1.1.m1.1.1.3">ℝ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmremark1.p1.1.1.m1.1c">(f_{k})_{k=0}^{\infty}\subset\mathbb{R}</annotation><annotation encoding="application/x-llamapun" id="S3.Thmremark1.p1.1.1.m1.1d">( italic_f start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ) start_POSTSUBSCRIPT italic_k = 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∞ end_POSTSUPERSCRIPT ⊂ blackboard_R</annotation></semantics></math> denote the deconvolution of <math alttext="(\alpha_{k})_{k=0}^{\infty}" class="ltx_Math" display="inline" id="S3.Thmremark1.p1.2.2.m2.1"><semantics id="S3.Thmremark1.p1.2.2.m2.1a"><msubsup id="S3.Thmremark1.p1.2.2.m2.1.1" xref="S3.Thmremark1.p1.2.2.m2.1.1.cmml"><mrow id="S3.Thmremark1.p1.2.2.m2.1.1.1.1.1" xref="S3.Thmremark1.p1.2.2.m2.1.1.1.1.1.1.cmml"><mo id="S3.Thmremark1.p1.2.2.m2.1.1.1.1.1.2" stretchy="false" xref="S3.Thmremark1.p1.2.2.m2.1.1.1.1.1.1.cmml">(</mo><msub id="S3.Thmremark1.p1.2.2.m2.1.1.1.1.1.1" xref="S3.Thmremark1.p1.2.2.m2.1.1.1.1.1.1.cmml"><mi id="S3.Thmremark1.p1.2.2.m2.1.1.1.1.1.1.2" xref="S3.Thmremark1.p1.2.2.m2.1.1.1.1.1.1.2.cmml">α</mi><mi id="S3.Thmremark1.p1.2.2.m2.1.1.1.1.1.1.3" xref="S3.Thmremark1.p1.2.2.m2.1.1.1.1.1.1.3.cmml">k</mi></msub><mo id="S3.Thmremark1.p1.2.2.m2.1.1.1.1.1.3" stretchy="false" xref="S3.Thmremark1.p1.2.2.m2.1.1.1.1.1.1.cmml">)</mo></mrow><mrow id="S3.Thmremark1.p1.2.2.m2.1.1.1.3" xref="S3.Thmremark1.p1.2.2.m2.1.1.1.3.cmml"><mi id="S3.Thmremark1.p1.2.2.m2.1.1.1.3.2" xref="S3.Thmremark1.p1.2.2.m2.1.1.1.3.2.cmml">k</mi><mo id="S3.Thmremark1.p1.2.2.m2.1.1.1.3.1" xref="S3.Thmremark1.p1.2.2.m2.1.1.1.3.1.cmml">=</mo><mn id="S3.Thmremark1.p1.2.2.m2.1.1.1.3.3" xref="S3.Thmremark1.p1.2.2.m2.1.1.1.3.3.cmml">0</mn></mrow><mi id="S3.Thmremark1.p1.2.2.m2.1.1.3" mathvariant="normal" xref="S3.Thmremark1.p1.2.2.m2.1.1.3.cmml">∞</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.Thmremark1.p1.2.2.m2.1b"><apply id="S3.Thmremark1.p1.2.2.m2.1.1.cmml" xref="S3.Thmremark1.p1.2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.Thmremark1.p1.2.2.m2.1.1.2.cmml" xref="S3.Thmremark1.p1.2.2.m2.1.1">superscript</csymbol><apply id="S3.Thmremark1.p1.2.2.m2.1.1.1.cmml" xref="S3.Thmremark1.p1.2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.Thmremark1.p1.2.2.m2.1.1.1.2.cmml" xref="S3.Thmremark1.p1.2.2.m2.1.1">subscript</csymbol><apply id="S3.Thmremark1.p1.2.2.m2.1.1.1.1.1.1.cmml" xref="S3.Thmremark1.p1.2.2.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Thmremark1.p1.2.2.m2.1.1.1.1.1.1.1.cmml" xref="S3.Thmremark1.p1.2.2.m2.1.1.1.1.1">subscript</csymbol><ci id="S3.Thmremark1.p1.2.2.m2.1.1.1.1.1.1.2.cmml" xref="S3.Thmremark1.p1.2.2.m2.1.1.1.1.1.1.2">𝛼</ci><ci id="S3.Thmremark1.p1.2.2.m2.1.1.1.1.1.1.3.cmml" xref="S3.Thmremark1.p1.2.2.m2.1.1.1.1.1.1.3">𝑘</ci></apply><apply id="S3.Thmremark1.p1.2.2.m2.1.1.1.3.cmml" xref="S3.Thmremark1.p1.2.2.m2.1.1.1.3"><eq id="S3.Thmremark1.p1.2.2.m2.1.1.1.3.1.cmml" xref="S3.Thmremark1.p1.2.2.m2.1.1.1.3.1"></eq><ci id="S3.Thmremark1.p1.2.2.m2.1.1.1.3.2.cmml" xref="S3.Thmremark1.p1.2.2.m2.1.1.1.3.2">𝑘</ci><cn id="S3.Thmremark1.p1.2.2.m2.1.1.1.3.3.cmml" type="integer" xref="S3.Thmremark1.p1.2.2.m2.1.1.1.3.3">0</cn></apply></apply><infinity id="S3.Thmremark1.p1.2.2.m2.1.1.3.cmml" xref="S3.Thmremark1.p1.2.2.m2.1.1.3"></infinity></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmremark1.p1.2.2.m2.1c">(\alpha_{k})_{k=0}^{\infty}</annotation><annotation encoding="application/x-llamapun" id="S3.Thmremark1.p1.2.2.m2.1d">( italic_α start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ) start_POSTSUBSCRIPT italic_k = 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∞ end_POSTSUPERSCRIPT</annotation></semantics></math>, i.e.&nbsp;<math alttext="\sum_{p=0}^{k}f_{p}f_{k-p}=\alpha_{k}\hskip 5.0pt\forall\hskip 5.0ptk" class="ltx_Math" display="inline" id="S3.Thmremark1.p1.3.3.m3.1"><semantics id="S3.Thmremark1.p1.3.3.m3.1a"><mrow id="S3.Thmremark1.p1.3.3.m3.1.1" xref="S3.Thmremark1.p1.3.3.m3.1.1.cmml"><mrow id="S3.Thmremark1.p1.3.3.m3.1.1.2" xref="S3.Thmremark1.p1.3.3.m3.1.1.2.cmml"><msubsup id="S3.Thmremark1.p1.3.3.m3.1.1.2.1" xref="S3.Thmremark1.p1.3.3.m3.1.1.2.1.cmml"><mo id="S3.Thmremark1.p1.3.3.m3.1.1.2.1.2.2" xref="S3.Thmremark1.p1.3.3.m3.1.1.2.1.2.2.cmml">∑</mo><mrow id="S3.Thmremark1.p1.3.3.m3.1.1.2.1.2.3" xref="S3.Thmremark1.p1.3.3.m3.1.1.2.1.2.3.cmml"><mi id="S3.Thmremark1.p1.3.3.m3.1.1.2.1.2.3.2" xref="S3.Thmremark1.p1.3.3.m3.1.1.2.1.2.3.2.cmml">p</mi><mo id="S3.Thmremark1.p1.3.3.m3.1.1.2.1.2.3.1" xref="S3.Thmremark1.p1.3.3.m3.1.1.2.1.2.3.1.cmml">=</mo><mn id="S3.Thmremark1.p1.3.3.m3.1.1.2.1.2.3.3" xref="S3.Thmremark1.p1.3.3.m3.1.1.2.1.2.3.3.cmml">0</mn></mrow><mi id="S3.Thmremark1.p1.3.3.m3.1.1.2.1.3" xref="S3.Thmremark1.p1.3.3.m3.1.1.2.1.3.cmml">k</mi></msubsup><mrow id="S3.Thmremark1.p1.3.3.m3.1.1.2.2" xref="S3.Thmremark1.p1.3.3.m3.1.1.2.2.cmml"><msub id="S3.Thmremark1.p1.3.3.m3.1.1.2.2.2" xref="S3.Thmremark1.p1.3.3.m3.1.1.2.2.2.cmml"><mi id="S3.Thmremark1.p1.3.3.m3.1.1.2.2.2.2" xref="S3.Thmremark1.p1.3.3.m3.1.1.2.2.2.2.cmml">f</mi><mi id="S3.Thmremark1.p1.3.3.m3.1.1.2.2.2.3" xref="S3.Thmremark1.p1.3.3.m3.1.1.2.2.2.3.cmml">p</mi></msub><mo id="S3.Thmremark1.p1.3.3.m3.1.1.2.2.1" xref="S3.Thmremark1.p1.3.3.m3.1.1.2.2.1.cmml">⁢</mo><msub id="S3.Thmremark1.p1.3.3.m3.1.1.2.2.3" xref="S3.Thmremark1.p1.3.3.m3.1.1.2.2.3.cmml"><mi id="S3.Thmremark1.p1.3.3.m3.1.1.2.2.3.2" xref="S3.Thmremark1.p1.3.3.m3.1.1.2.2.3.2.cmml">f</mi><mrow id="S3.Thmremark1.p1.3.3.m3.1.1.2.2.3.3" xref="S3.Thmremark1.p1.3.3.m3.1.1.2.2.3.3.cmml"><mi id="S3.Thmremark1.p1.3.3.m3.1.1.2.2.3.3.2" xref="S3.Thmremark1.p1.3.3.m3.1.1.2.2.3.3.2.cmml">k</mi><mo id="S3.Thmremark1.p1.3.3.m3.1.1.2.2.3.3.1" xref="S3.Thmremark1.p1.3.3.m3.1.1.2.2.3.3.1.cmml">−</mo><mi id="S3.Thmremark1.p1.3.3.m3.1.1.2.2.3.3.3" xref="S3.Thmremark1.p1.3.3.m3.1.1.2.2.3.3.3.cmml">p</mi></mrow></msub></mrow></mrow><mo id="S3.Thmremark1.p1.3.3.m3.1.1.1" xref="S3.Thmremark1.p1.3.3.m3.1.1.1.cmml">=</mo><mrow id="S3.Thmremark1.p1.3.3.m3.1.1.3" xref="S3.Thmremark1.p1.3.3.m3.1.1.3.cmml"><msub id="S3.Thmremark1.p1.3.3.m3.1.1.3.2" xref="S3.Thmremark1.p1.3.3.m3.1.1.3.2.cmml"><mi id="S3.Thmremark1.p1.3.3.m3.1.1.3.2.2" xref="S3.Thmremark1.p1.3.3.m3.1.1.3.2.2.cmml">α</mi><mi id="S3.Thmremark1.p1.3.3.m3.1.1.3.2.3" xref="S3.Thmremark1.p1.3.3.m3.1.1.3.2.3.cmml">k</mi></msub><mo id="S3.Thmremark1.p1.3.3.m3.1.1.3.1" lspace="0.167em" xref="S3.Thmremark1.p1.3.3.m3.1.1.3.1.cmml">⁢</mo><mrow id="S3.Thmremark1.p1.3.3.m3.1.1.3.3" xref="S3.Thmremark1.p1.3.3.m3.1.1.3.3.cmml"><mo id="S3.Thmremark1.p1.3.3.m3.1.1.3.3.1" rspace="0.667em" xref="S3.Thmremark1.p1.3.3.m3.1.1.3.3.1.cmml">∀</mo><mi id="S3.Thmremark1.p1.3.3.m3.1.1.3.3.2" xref="S3.Thmremark1.p1.3.3.m3.1.1.3.3.2.cmml">k</mi></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Thmremark1.p1.3.3.m3.1b"><apply id="S3.Thmremark1.p1.3.3.m3.1.1.cmml" xref="S3.Thmremark1.p1.3.3.m3.1.1"><eq id="S3.Thmremark1.p1.3.3.m3.1.1.1.cmml" xref="S3.Thmremark1.p1.3.3.m3.1.1.1"></eq><apply id="S3.Thmremark1.p1.3.3.m3.1.1.2.cmml" xref="S3.Thmremark1.p1.3.3.m3.1.1.2"><apply id="S3.Thmremark1.p1.3.3.m3.1.1.2.1.cmml" xref="S3.Thmremark1.p1.3.3.m3.1.1.2.1"><csymbol cd="ambiguous" id="S3.Thmremark1.p1.3.3.m3.1.1.2.1.1.cmml" xref="S3.Thmremark1.p1.3.3.m3.1.1.2.1">superscript</csymbol><apply id="S3.Thmremark1.p1.3.3.m3.1.1.2.1.2.cmml" xref="S3.Thmremark1.p1.3.3.m3.1.1.2.1"><csymbol cd="ambiguous" id="S3.Thmremark1.p1.3.3.m3.1.1.2.1.2.1.cmml" xref="S3.Thmremark1.p1.3.3.m3.1.1.2.1">subscript</csymbol><sum id="S3.Thmremark1.p1.3.3.m3.1.1.2.1.2.2.cmml" xref="S3.Thmremark1.p1.3.3.m3.1.1.2.1.2.2"></sum><apply id="S3.Thmremark1.p1.3.3.m3.1.1.2.1.2.3.cmml" xref="S3.Thmremark1.p1.3.3.m3.1.1.2.1.2.3"><eq id="S3.Thmremark1.p1.3.3.m3.1.1.2.1.2.3.1.cmml" xref="S3.Thmremark1.p1.3.3.m3.1.1.2.1.2.3.1"></eq><ci id="S3.Thmremark1.p1.3.3.m3.1.1.2.1.2.3.2.cmml" xref="S3.Thmremark1.p1.3.3.m3.1.1.2.1.2.3.2">𝑝</ci><cn id="S3.Thmremark1.p1.3.3.m3.1.1.2.1.2.3.3.cmml" type="integer" xref="S3.Thmremark1.p1.3.3.m3.1.1.2.1.2.3.3">0</cn></apply></apply><ci id="S3.Thmremark1.p1.3.3.m3.1.1.2.1.3.cmml" xref="S3.Thmremark1.p1.3.3.m3.1.1.2.1.3">𝑘</ci></apply><apply id="S3.Thmremark1.p1.3.3.m3.1.1.2.2.cmml" xref="S3.Thmremark1.p1.3.3.m3.1.1.2.2"><times id="S3.Thmremark1.p1.3.3.m3.1.1.2.2.1.cmml" xref="S3.Thmremark1.p1.3.3.m3.1.1.2.2.1"></times><apply id="S3.Thmremark1.p1.3.3.m3.1.1.2.2.2.cmml" xref="S3.Thmremark1.p1.3.3.m3.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.Thmremark1.p1.3.3.m3.1.1.2.2.2.1.cmml" xref="S3.Thmremark1.p1.3.3.m3.1.1.2.2.2">subscript</csymbol><ci id="S3.Thmremark1.p1.3.3.m3.1.1.2.2.2.2.cmml" xref="S3.Thmremark1.p1.3.3.m3.1.1.2.2.2.2">𝑓</ci><ci id="S3.Thmremark1.p1.3.3.m3.1.1.2.2.2.3.cmml" xref="S3.Thmremark1.p1.3.3.m3.1.1.2.2.2.3">𝑝</ci></apply><apply id="S3.Thmremark1.p1.3.3.m3.1.1.2.2.3.cmml" xref="S3.Thmremark1.p1.3.3.m3.1.1.2.2.3"><csymbol cd="ambiguous" id="S3.Thmremark1.p1.3.3.m3.1.1.2.2.3.1.cmml" xref="S3.Thmremark1.p1.3.3.m3.1.1.2.2.3">subscript</csymbol><ci id="S3.Thmremark1.p1.3.3.m3.1.1.2.2.3.2.cmml" xref="S3.Thmremark1.p1.3.3.m3.1.1.2.2.3.2">𝑓</ci><apply id="S3.Thmremark1.p1.3.3.m3.1.1.2.2.3.3.cmml" xref="S3.Thmremark1.p1.3.3.m3.1.1.2.2.3.3"><minus id="S3.Thmremark1.p1.3.3.m3.1.1.2.2.3.3.1.cmml" xref="S3.Thmremark1.p1.3.3.m3.1.1.2.2.3.3.1"></minus><ci id="S3.Thmremark1.p1.3.3.m3.1.1.2.2.3.3.2.cmml" xref="S3.Thmremark1.p1.3.3.m3.1.1.2.2.3.3.2">𝑘</ci><ci id="S3.Thmremark1.p1.3.3.m3.1.1.2.2.3.3.3.cmml" xref="S3.Thmremark1.p1.3.3.m3.1.1.2.2.3.3.3">𝑝</ci></apply></apply></apply></apply><apply id="S3.Thmremark1.p1.3.3.m3.1.1.3.cmml" xref="S3.Thmremark1.p1.3.3.m3.1.1.3"><times id="S3.Thmremark1.p1.3.3.m3.1.1.3.1.cmml" xref="S3.Thmremark1.p1.3.3.m3.1.1.3.1"></times><apply id="S3.Thmremark1.p1.3.3.m3.1.1.3.2.cmml" xref="S3.Thmremark1.p1.3.3.m3.1.1.3.2"><csymbol cd="ambiguous" id="S3.Thmremark1.p1.3.3.m3.1.1.3.2.1.cmml" xref="S3.Thmremark1.p1.3.3.m3.1.1.3.2">subscript</csymbol><ci id="S3.Thmremark1.p1.3.3.m3.1.1.3.2.2.cmml" xref="S3.Thmremark1.p1.3.3.m3.1.1.3.2.2">𝛼</ci><ci id="S3.Thmremark1.p1.3.3.m3.1.1.3.2.3.cmml" xref="S3.Thmremark1.p1.3.3.m3.1.1.3.2.3">𝑘</ci></apply><apply id="S3.Thmremark1.p1.3.3.m3.1.1.3.3.cmml" xref="S3.Thmremark1.p1.3.3.m3.1.1.3.3"><csymbol cd="latexml" id="S3.Thmremark1.p1.3.3.m3.1.1.3.3.1.cmml" xref="S3.Thmremark1.p1.3.3.m3.1.1.3.3.1">for-all</csymbol><ci id="S3.Thmremark1.p1.3.3.m3.1.1.3.3.2.cmml" xref="S3.Thmremark1.p1.3.3.m3.1.1.3.3.2">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmremark1.p1.3.3.m3.1c">\sum_{p=0}^{k}f_{p}f_{k-p}=\alpha_{k}\hskip 5.0pt\forall\hskip 5.0ptk</annotation><annotation encoding="application/x-llamapun" id="S3.Thmremark1.p1.3.3.m3.1d">∑ start_POSTSUBSCRIPT italic_p = 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT italic_f start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT italic_f start_POSTSUBSCRIPT italic_k - italic_p end_POSTSUBSCRIPT = italic_α start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ∀ italic_k</annotation></semantics></math>.
There exists a feature matrix <math alttext="\mathbf{\Phi}_{\mathcal{G}}\in\mathbb{R}^{N\times N}" class="ltx_Math" display="inline" id="S3.Thmremark1.p1.4.4.m4.1"><semantics id="S3.Thmremark1.p1.4.4.m4.1a"><mrow id="S3.Thmremark1.p1.4.4.m4.1.1" xref="S3.Thmremark1.p1.4.4.m4.1.1.cmml"><msub id="S3.Thmremark1.p1.4.4.m4.1.1.2" xref="S3.Thmremark1.p1.4.4.m4.1.1.2.cmml"><mi id="S3.Thmremark1.p1.4.4.m4.1.1.2.2" xref="S3.Thmremark1.p1.4.4.m4.1.1.2.2.cmml">𝚽</mi><mi class="ltx_font_mathcaligraphic" id="S3.Thmremark1.p1.4.4.m4.1.1.2.3" xref="S3.Thmremark1.p1.4.4.m4.1.1.2.3.cmml">𝒢</mi></msub><mo id="S3.Thmremark1.p1.4.4.m4.1.1.1" xref="S3.Thmremark1.p1.4.4.m4.1.1.1.cmml">∈</mo><msup id="S3.Thmremark1.p1.4.4.m4.1.1.3" xref="S3.Thmremark1.p1.4.4.m4.1.1.3.cmml"><mi id="S3.Thmremark1.p1.4.4.m4.1.1.3.2" xref="S3.Thmremark1.p1.4.4.m4.1.1.3.2.cmml">ℝ</mi><mrow id="S3.Thmremark1.p1.4.4.m4.1.1.3.3" xref="S3.Thmremark1.p1.4.4.m4.1.1.3.3.cmml"><mi id="S3.Thmremark1.p1.4.4.m4.1.1.3.3.2" xref="S3.Thmremark1.p1.4.4.m4.1.1.3.3.2.cmml">N</mi><mo id="S3.Thmremark1.p1.4.4.m4.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.Thmremark1.p1.4.4.m4.1.1.3.3.1.cmml">×</mo><mi id="S3.Thmremark1.p1.4.4.m4.1.1.3.3.3" xref="S3.Thmremark1.p1.4.4.m4.1.1.3.3.3.cmml">N</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.Thmremark1.p1.4.4.m4.1b"><apply id="S3.Thmremark1.p1.4.4.m4.1.1.cmml" xref="S3.Thmremark1.p1.4.4.m4.1.1"><in id="S3.Thmremark1.p1.4.4.m4.1.1.1.cmml" xref="S3.Thmremark1.p1.4.4.m4.1.1.1"></in><apply id="S3.Thmremark1.p1.4.4.m4.1.1.2.cmml" xref="S3.Thmremark1.p1.4.4.m4.1.1.2"><csymbol cd="ambiguous" id="S3.Thmremark1.p1.4.4.m4.1.1.2.1.cmml" xref="S3.Thmremark1.p1.4.4.m4.1.1.2">subscript</csymbol><ci id="S3.Thmremark1.p1.4.4.m4.1.1.2.2.cmml" xref="S3.Thmremark1.p1.4.4.m4.1.1.2.2">𝚽</ci><ci id="S3.Thmremark1.p1.4.4.m4.1.1.2.3.cmml" xref="S3.Thmremark1.p1.4.4.m4.1.1.2.3">𝒢</ci></apply><apply id="S3.Thmremark1.p1.4.4.m4.1.1.3.cmml" xref="S3.Thmremark1.p1.4.4.m4.1.1.3"><csymbol cd="ambiguous" id="S3.Thmremark1.p1.4.4.m4.1.1.3.1.cmml" xref="S3.Thmremark1.p1.4.4.m4.1.1.3">superscript</csymbol><ci id="S3.Thmremark1.p1.4.4.m4.1.1.3.2.cmml" xref="S3.Thmremark1.p1.4.4.m4.1.1.3.2">ℝ</ci><apply id="S3.Thmremark1.p1.4.4.m4.1.1.3.3.cmml" xref="S3.Thmremark1.p1.4.4.m4.1.1.3.3"><times id="S3.Thmremark1.p1.4.4.m4.1.1.3.3.1.cmml" xref="S3.Thmremark1.p1.4.4.m4.1.1.3.3.1"></times><ci id="S3.Thmremark1.p1.4.4.m4.1.1.3.3.2.cmml" xref="S3.Thmremark1.p1.4.4.m4.1.1.3.3.2">𝑁</ci><ci id="S3.Thmremark1.p1.4.4.m4.1.1.3.3.3.cmml" xref="S3.Thmremark1.p1.4.4.m4.1.1.3.3.3">𝑁</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmremark1.p1.4.4.m4.1c">\mathbf{\Phi}_{\mathcal{G}}\in\mathbb{R}^{N\times N}</annotation><annotation encoding="application/x-llamapun" id="S3.Thmremark1.p1.4.4.m4.1d">bold_Φ start_POSTSUBSCRIPT caligraphic_G end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_N × italic_N end_POSTSUPERSCRIPT</annotation></semantics></math> satisfying
<math alttext="\mathbf{M}_{\alpha}(\mathcal{G})=\mathbf{\Phi}_{\mathcal{G}}\mathbf{\Phi}_{%
\mathcal{G}}^{\top}" class="ltx_Math" display="inline" id="S3.Thmremark1.p1.5.5.m5.1"><semantics id="S3.Thmremark1.p1.5.5.m5.1a"><mrow id="S3.Thmremark1.p1.5.5.m5.1.2" xref="S3.Thmremark1.p1.5.5.m5.1.2.cmml"><mrow id="S3.Thmremark1.p1.5.5.m5.1.2.2" xref="S3.Thmremark1.p1.5.5.m5.1.2.2.cmml"><msub id="S3.Thmremark1.p1.5.5.m5.1.2.2.2" xref="S3.Thmremark1.p1.5.5.m5.1.2.2.2.cmml"><mi id="S3.Thmremark1.p1.5.5.m5.1.2.2.2.2" xref="S3.Thmremark1.p1.5.5.m5.1.2.2.2.2.cmml">𝐌</mi><mi id="S3.Thmremark1.p1.5.5.m5.1.2.2.2.3" xref="S3.Thmremark1.p1.5.5.m5.1.2.2.2.3.cmml">α</mi></msub><mo id="S3.Thmremark1.p1.5.5.m5.1.2.2.1" xref="S3.Thmremark1.p1.5.5.m5.1.2.2.1.cmml">⁢</mo><mrow id="S3.Thmremark1.p1.5.5.m5.1.2.2.3.2" xref="S3.Thmremark1.p1.5.5.m5.1.2.2.cmml"><mo id="S3.Thmremark1.p1.5.5.m5.1.2.2.3.2.1" stretchy="false" xref="S3.Thmremark1.p1.5.5.m5.1.2.2.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S3.Thmremark1.p1.5.5.m5.1.1" xref="S3.Thmremark1.p1.5.5.m5.1.1.cmml">𝒢</mi><mo id="S3.Thmremark1.p1.5.5.m5.1.2.2.3.2.2" stretchy="false" xref="S3.Thmremark1.p1.5.5.m5.1.2.2.cmml">)</mo></mrow></mrow><mo id="S3.Thmremark1.p1.5.5.m5.1.2.1" xref="S3.Thmremark1.p1.5.5.m5.1.2.1.cmml">=</mo><mrow id="S3.Thmremark1.p1.5.5.m5.1.2.3" xref="S3.Thmremark1.p1.5.5.m5.1.2.3.cmml"><msub id="S3.Thmremark1.p1.5.5.m5.1.2.3.2" xref="S3.Thmremark1.p1.5.5.m5.1.2.3.2.cmml"><mi id="S3.Thmremark1.p1.5.5.m5.1.2.3.2.2" xref="S3.Thmremark1.p1.5.5.m5.1.2.3.2.2.cmml">𝚽</mi><mi class="ltx_font_mathcaligraphic" id="S3.Thmremark1.p1.5.5.m5.1.2.3.2.3" xref="S3.Thmremark1.p1.5.5.m5.1.2.3.2.3.cmml">𝒢</mi></msub><mo id="S3.Thmremark1.p1.5.5.m5.1.2.3.1" xref="S3.Thmremark1.p1.5.5.m5.1.2.3.1.cmml">⁢</mo><msubsup id="S3.Thmremark1.p1.5.5.m5.1.2.3.3" xref="S3.Thmremark1.p1.5.5.m5.1.2.3.3.cmml"><mi id="S3.Thmremark1.p1.5.5.m5.1.2.3.3.2.2" xref="S3.Thmremark1.p1.5.5.m5.1.2.3.3.2.2.cmml">𝚽</mi><mi class="ltx_font_mathcaligraphic" id="S3.Thmremark1.p1.5.5.m5.1.2.3.3.2.3" xref="S3.Thmremark1.p1.5.5.m5.1.2.3.3.2.3.cmml">𝒢</mi><mo id="S3.Thmremark1.p1.5.5.m5.1.2.3.3.3" xref="S3.Thmremark1.p1.5.5.m5.1.2.3.3.3.cmml">⊤</mo></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Thmremark1.p1.5.5.m5.1b"><apply id="S3.Thmremark1.p1.5.5.m5.1.2.cmml" xref="S3.Thmremark1.p1.5.5.m5.1.2"><eq id="S3.Thmremark1.p1.5.5.m5.1.2.1.cmml" xref="S3.Thmremark1.p1.5.5.m5.1.2.1"></eq><apply id="S3.Thmremark1.p1.5.5.m5.1.2.2.cmml" xref="S3.Thmremark1.p1.5.5.m5.1.2.2"><times id="S3.Thmremark1.p1.5.5.m5.1.2.2.1.cmml" xref="S3.Thmremark1.p1.5.5.m5.1.2.2.1"></times><apply id="S3.Thmremark1.p1.5.5.m5.1.2.2.2.cmml" xref="S3.Thmremark1.p1.5.5.m5.1.2.2.2"><csymbol cd="ambiguous" id="S3.Thmremark1.p1.5.5.m5.1.2.2.2.1.cmml" xref="S3.Thmremark1.p1.5.5.m5.1.2.2.2">subscript</csymbol><ci id="S3.Thmremark1.p1.5.5.m5.1.2.2.2.2.cmml" xref="S3.Thmremark1.p1.5.5.m5.1.2.2.2.2">𝐌</ci><ci id="S3.Thmremark1.p1.5.5.m5.1.2.2.2.3.cmml" xref="S3.Thmremark1.p1.5.5.m5.1.2.2.2.3">𝛼</ci></apply><ci id="S3.Thmremark1.p1.5.5.m5.1.1.cmml" xref="S3.Thmremark1.p1.5.5.m5.1.1">𝒢</ci></apply><apply id="S3.Thmremark1.p1.5.5.m5.1.2.3.cmml" xref="S3.Thmremark1.p1.5.5.m5.1.2.3"><times id="S3.Thmremark1.p1.5.5.m5.1.2.3.1.cmml" xref="S3.Thmremark1.p1.5.5.m5.1.2.3.1"></times><apply id="S3.Thmremark1.p1.5.5.m5.1.2.3.2.cmml" xref="S3.Thmremark1.p1.5.5.m5.1.2.3.2"><csymbol cd="ambiguous" id="S3.Thmremark1.p1.5.5.m5.1.2.3.2.1.cmml" xref="S3.Thmremark1.p1.5.5.m5.1.2.3.2">subscript</csymbol><ci id="S3.Thmremark1.p1.5.5.m5.1.2.3.2.2.cmml" xref="S3.Thmremark1.p1.5.5.m5.1.2.3.2.2">𝚽</ci><ci id="S3.Thmremark1.p1.5.5.m5.1.2.3.2.3.cmml" xref="S3.Thmremark1.p1.5.5.m5.1.2.3.2.3">𝒢</ci></apply><apply id="S3.Thmremark1.p1.5.5.m5.1.2.3.3.cmml" xref="S3.Thmremark1.p1.5.5.m5.1.2.3.3"><csymbol cd="ambiguous" id="S3.Thmremark1.p1.5.5.m5.1.2.3.3.1.cmml" xref="S3.Thmremark1.p1.5.5.m5.1.2.3.3">superscript</csymbol><apply id="S3.Thmremark1.p1.5.5.m5.1.2.3.3.2.cmml" xref="S3.Thmremark1.p1.5.5.m5.1.2.3.3"><csymbol cd="ambiguous" id="S3.Thmremark1.p1.5.5.m5.1.2.3.3.2.1.cmml" xref="S3.Thmremark1.p1.5.5.m5.1.2.3.3">subscript</csymbol><ci id="S3.Thmremark1.p1.5.5.m5.1.2.3.3.2.2.cmml" xref="S3.Thmremark1.p1.5.5.m5.1.2.3.3.2.2">𝚽</ci><ci id="S3.Thmremark1.p1.5.5.m5.1.2.3.3.2.3.cmml" xref="S3.Thmremark1.p1.5.5.m5.1.2.3.3.2.3">𝒢</ci></apply><csymbol cd="latexml" id="S3.Thmremark1.p1.5.5.m5.1.2.3.3.3.cmml" xref="S3.Thmremark1.p1.5.5.m5.1.2.3.3.3">top</csymbol></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmremark1.p1.5.5.m5.1c">\mathbf{M}_{\alpha}(\mathcal{G})=\mathbf{\Phi}_{\mathcal{G}}\mathbf{\Phi}_{%
\mathcal{G}}^{\top}</annotation><annotation encoding="application/x-llamapun" id="S3.Thmremark1.p1.5.5.m5.1d">bold_M start_POSTSUBSCRIPT italic_α end_POSTSUBSCRIPT ( caligraphic_G ) = bold_Φ start_POSTSUBSCRIPT caligraphic_G end_POSTSUBSCRIPT bold_Φ start_POSTSUBSCRIPT caligraphic_G end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT</annotation></semantics></math>,
given by <math alttext="\mathbf{\Phi}_{\mathcal{G}}\coloneqq\sum_{k=0}^{\infty}f_{k}\mathbf{W}^{k}." class="ltx_Math" display="inline" id="S3.Thmremark1.p1.6.6.m6.1"><semantics id="S3.Thmremark1.p1.6.6.m6.1a"><mrow id="S3.Thmremark1.p1.6.6.m6.1.1.1" xref="S3.Thmremark1.p1.6.6.m6.1.1.1.1.cmml"><mrow id="S3.Thmremark1.p1.6.6.m6.1.1.1.1" xref="S3.Thmremark1.p1.6.6.m6.1.1.1.1.cmml"><msub id="S3.Thmremark1.p1.6.6.m6.1.1.1.1.2" xref="S3.Thmremark1.p1.6.6.m6.1.1.1.1.2.cmml"><mi id="S3.Thmremark1.p1.6.6.m6.1.1.1.1.2.2" xref="S3.Thmremark1.p1.6.6.m6.1.1.1.1.2.2.cmml">𝚽</mi><mi class="ltx_font_mathcaligraphic" id="S3.Thmremark1.p1.6.6.m6.1.1.1.1.2.3" xref="S3.Thmremark1.p1.6.6.m6.1.1.1.1.2.3.cmml">𝒢</mi></msub><mo id="S3.Thmremark1.p1.6.6.m6.1.1.1.1.1" rspace="0.111em" xref="S3.Thmremark1.p1.6.6.m6.1.1.1.1.1.cmml">≔</mo><mrow id="S3.Thmremark1.p1.6.6.m6.1.1.1.1.3" xref="S3.Thmremark1.p1.6.6.m6.1.1.1.1.3.cmml"><msubsup id="S3.Thmremark1.p1.6.6.m6.1.1.1.1.3.1" xref="S3.Thmremark1.p1.6.6.m6.1.1.1.1.3.1.cmml"><mo id="S3.Thmremark1.p1.6.6.m6.1.1.1.1.3.1.2.2" xref="S3.Thmremark1.p1.6.6.m6.1.1.1.1.3.1.2.2.cmml">∑</mo><mrow id="S3.Thmremark1.p1.6.6.m6.1.1.1.1.3.1.2.3" xref="S3.Thmremark1.p1.6.6.m6.1.1.1.1.3.1.2.3.cmml"><mi id="S3.Thmremark1.p1.6.6.m6.1.1.1.1.3.1.2.3.2" xref="S3.Thmremark1.p1.6.6.m6.1.1.1.1.3.1.2.3.2.cmml">k</mi><mo id="S3.Thmremark1.p1.6.6.m6.1.1.1.1.3.1.2.3.1" xref="S3.Thmremark1.p1.6.6.m6.1.1.1.1.3.1.2.3.1.cmml">=</mo><mn id="S3.Thmremark1.p1.6.6.m6.1.1.1.1.3.1.2.3.3" xref="S3.Thmremark1.p1.6.6.m6.1.1.1.1.3.1.2.3.3.cmml">0</mn></mrow><mi id="S3.Thmremark1.p1.6.6.m6.1.1.1.1.3.1.3" mathvariant="normal" xref="S3.Thmremark1.p1.6.6.m6.1.1.1.1.3.1.3.cmml">∞</mi></msubsup><mrow id="S3.Thmremark1.p1.6.6.m6.1.1.1.1.3.2" xref="S3.Thmremark1.p1.6.6.m6.1.1.1.1.3.2.cmml"><msub id="S3.Thmremark1.p1.6.6.m6.1.1.1.1.3.2.2" xref="S3.Thmremark1.p1.6.6.m6.1.1.1.1.3.2.2.cmml"><mi id="S3.Thmremark1.p1.6.6.m6.1.1.1.1.3.2.2.2" xref="S3.Thmremark1.p1.6.6.m6.1.1.1.1.3.2.2.2.cmml">f</mi><mi id="S3.Thmremark1.p1.6.6.m6.1.1.1.1.3.2.2.3" xref="S3.Thmremark1.p1.6.6.m6.1.1.1.1.3.2.2.3.cmml">k</mi></msub><mo id="S3.Thmremark1.p1.6.6.m6.1.1.1.1.3.2.1" xref="S3.Thmremark1.p1.6.6.m6.1.1.1.1.3.2.1.cmml">⁢</mo><msup id="S3.Thmremark1.p1.6.6.m6.1.1.1.1.3.2.3" xref="S3.Thmremark1.p1.6.6.m6.1.1.1.1.3.2.3.cmml"><mi id="S3.Thmremark1.p1.6.6.m6.1.1.1.1.3.2.3.2" xref="S3.Thmremark1.p1.6.6.m6.1.1.1.1.3.2.3.2.cmml">𝐖</mi><mi id="S3.Thmremark1.p1.6.6.m6.1.1.1.1.3.2.3.3" xref="S3.Thmremark1.p1.6.6.m6.1.1.1.1.3.2.3.3.cmml">k</mi></msup></mrow></mrow></mrow><mo id="S3.Thmremark1.p1.6.6.m6.1.1.1.2" lspace="0em" xref="S3.Thmremark1.p1.6.6.m6.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.Thmremark1.p1.6.6.m6.1b"><apply id="S3.Thmremark1.p1.6.6.m6.1.1.1.1.cmml" xref="S3.Thmremark1.p1.6.6.m6.1.1.1"><ci id="S3.Thmremark1.p1.6.6.m6.1.1.1.1.1.cmml" xref="S3.Thmremark1.p1.6.6.m6.1.1.1.1.1">≔</ci><apply id="S3.Thmremark1.p1.6.6.m6.1.1.1.1.2.cmml" xref="S3.Thmremark1.p1.6.6.m6.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.Thmremark1.p1.6.6.m6.1.1.1.1.2.1.cmml" xref="S3.Thmremark1.p1.6.6.m6.1.1.1.1.2">subscript</csymbol><ci id="S3.Thmremark1.p1.6.6.m6.1.1.1.1.2.2.cmml" xref="S3.Thmremark1.p1.6.6.m6.1.1.1.1.2.2">𝚽</ci><ci id="S3.Thmremark1.p1.6.6.m6.1.1.1.1.2.3.cmml" xref="S3.Thmremark1.p1.6.6.m6.1.1.1.1.2.3">𝒢</ci></apply><apply id="S3.Thmremark1.p1.6.6.m6.1.1.1.1.3.cmml" xref="S3.Thmremark1.p1.6.6.m6.1.1.1.1.3"><apply id="S3.Thmremark1.p1.6.6.m6.1.1.1.1.3.1.cmml" xref="S3.Thmremark1.p1.6.6.m6.1.1.1.1.3.1"><csymbol cd="ambiguous" id="S3.Thmremark1.p1.6.6.m6.1.1.1.1.3.1.1.cmml" xref="S3.Thmremark1.p1.6.6.m6.1.1.1.1.3.1">superscript</csymbol><apply id="S3.Thmremark1.p1.6.6.m6.1.1.1.1.3.1.2.cmml" xref="S3.Thmremark1.p1.6.6.m6.1.1.1.1.3.1"><csymbol cd="ambiguous" id="S3.Thmremark1.p1.6.6.m6.1.1.1.1.3.1.2.1.cmml" xref="S3.Thmremark1.p1.6.6.m6.1.1.1.1.3.1">subscript</csymbol><sum id="S3.Thmremark1.p1.6.6.m6.1.1.1.1.3.1.2.2.cmml" xref="S3.Thmremark1.p1.6.6.m6.1.1.1.1.3.1.2.2"></sum><apply id="S3.Thmremark1.p1.6.6.m6.1.1.1.1.3.1.2.3.cmml" xref="S3.Thmremark1.p1.6.6.m6.1.1.1.1.3.1.2.3"><eq id="S3.Thmremark1.p1.6.6.m6.1.1.1.1.3.1.2.3.1.cmml" xref="S3.Thmremark1.p1.6.6.m6.1.1.1.1.3.1.2.3.1"></eq><ci id="S3.Thmremark1.p1.6.6.m6.1.1.1.1.3.1.2.3.2.cmml" xref="S3.Thmremark1.p1.6.6.m6.1.1.1.1.3.1.2.3.2">𝑘</ci><cn id="S3.Thmremark1.p1.6.6.m6.1.1.1.1.3.1.2.3.3.cmml" type="integer" xref="S3.Thmremark1.p1.6.6.m6.1.1.1.1.3.1.2.3.3">0</cn></apply></apply><infinity id="S3.Thmremark1.p1.6.6.m6.1.1.1.1.3.1.3.cmml" xref="S3.Thmremark1.p1.6.6.m6.1.1.1.1.3.1.3"></infinity></apply><apply id="S3.Thmremark1.p1.6.6.m6.1.1.1.1.3.2.cmml" xref="S3.Thmremark1.p1.6.6.m6.1.1.1.1.3.2"><times id="S3.Thmremark1.p1.6.6.m6.1.1.1.1.3.2.1.cmml" xref="S3.Thmremark1.p1.6.6.m6.1.1.1.1.3.2.1"></times><apply id="S3.Thmremark1.p1.6.6.m6.1.1.1.1.3.2.2.cmml" xref="S3.Thmremark1.p1.6.6.m6.1.1.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.Thmremark1.p1.6.6.m6.1.1.1.1.3.2.2.1.cmml" xref="S3.Thmremark1.p1.6.6.m6.1.1.1.1.3.2.2">subscript</csymbol><ci id="S3.Thmremark1.p1.6.6.m6.1.1.1.1.3.2.2.2.cmml" xref="S3.Thmremark1.p1.6.6.m6.1.1.1.1.3.2.2.2">𝑓</ci><ci id="S3.Thmremark1.p1.6.6.m6.1.1.1.1.3.2.2.3.cmml" xref="S3.Thmremark1.p1.6.6.m6.1.1.1.1.3.2.2.3">𝑘</ci></apply><apply id="S3.Thmremark1.p1.6.6.m6.1.1.1.1.3.2.3.cmml" xref="S3.Thmremark1.p1.6.6.m6.1.1.1.1.3.2.3"><csymbol cd="ambiguous" id="S3.Thmremark1.p1.6.6.m6.1.1.1.1.3.2.3.1.cmml" xref="S3.Thmremark1.p1.6.6.m6.1.1.1.1.3.2.3">superscript</csymbol><ci id="S3.Thmremark1.p1.6.6.m6.1.1.1.1.3.2.3.2.cmml" xref="S3.Thmremark1.p1.6.6.m6.1.1.1.1.3.2.3.2">𝐖</ci><ci id="S3.Thmremark1.p1.6.6.m6.1.1.1.1.3.2.3.3.cmml" xref="S3.Thmremark1.p1.6.6.m6.1.1.1.1.3.2.3.3">𝑘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmremark1.p1.6.6.m6.1c">\mathbf{\Phi}_{\mathcal{G}}\coloneqq\sum_{k=0}^{\infty}f_{k}\mathbf{W}^{k}.</annotation><annotation encoding="application/x-llamapun" id="S3.Thmremark1.p1.6.6.m6.1d">bold_Φ start_POSTSUBSCRIPT caligraphic_G end_POSTSUBSCRIPT ≔ ∑ start_POSTSUBSCRIPT italic_k = 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∞ end_POSTSUPERSCRIPT italic_f start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT bold_W start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT .</annotation></semantics></math></span></p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS2.p2">
<p class="ltx_p" id="S3.SS2.p2.4">This is can be shown in a few lines of algebra; see App.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#A1.SS1" title="A.1 Proof of Remark 3.1 ‣ Appendix A Proofs ‣ Linear Transformer Topological Masking with Graph Random Features"><span class="ltx_text ltx_ref_tag">A.1</span></a>.
We refer to the rows of the feature matrix <math alttext="\mathbf{\Phi}_{\mathcal{G}}" class="ltx_Math" display="inline" id="S3.SS2.p2.1.m1.1"><semantics id="S3.SS2.p2.1.m1.1a"><msub id="S3.SS2.p2.1.m1.1.1" xref="S3.SS2.p2.1.m1.1.1.cmml"><mi id="S3.SS2.p2.1.m1.1.1.2" xref="S3.SS2.p2.1.m1.1.1.2.cmml">𝚽</mi><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p2.1.m1.1.1.3" xref="S3.SS2.p2.1.m1.1.1.3.cmml">𝒢</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.1.m1.1b"><apply id="S3.SS2.p2.1.m1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.1.m1.1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.p2.1.m1.1.1.2.cmml" xref="S3.SS2.p2.1.m1.1.1.2">𝚽</ci><ci id="S3.SS2.p2.1.m1.1.1.3.cmml" xref="S3.SS2.p2.1.m1.1.1.3">𝒢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.1.m1.1c">\mathbf{\Phi}_{\mathcal{G}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.1.m1.1d">bold_Φ start_POSTSUBSCRIPT caligraphic_G end_POSTSUBSCRIPT</annotation></semantics></math> as <em class="ltx_emph ltx_font_italic" id="S3.SS2.p2.4.1">graph features</em>, letting <math alttext="\mathbf{\Phi}_{\mathcal{G}}\eqqcolon[\phi_{\mathcal{G}}(v_{i})]_{i=1}^{N}" class="ltx_Math" display="inline" id="S3.SS2.p2.2.m2.1"><semantics id="S3.SS2.p2.2.m2.1a"><mrow id="S3.SS2.p2.2.m2.1.1" xref="S3.SS2.p2.2.m2.1.1.cmml"><msub id="S3.SS2.p2.2.m2.1.1.3" xref="S3.SS2.p2.2.m2.1.1.3.cmml"><mi id="S3.SS2.p2.2.m2.1.1.3.2" xref="S3.SS2.p2.2.m2.1.1.3.2.cmml">𝚽</mi><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p2.2.m2.1.1.3.3" xref="S3.SS2.p2.2.m2.1.1.3.3.cmml">𝒢</mi></msub><mo id="S3.SS2.p2.2.m2.1.1.2" xref="S3.SS2.p2.2.m2.1.1.2.cmml">≕</mo><msubsup id="S3.SS2.p2.2.m2.1.1.1" xref="S3.SS2.p2.2.m2.1.1.1.cmml"><mrow id="S3.SS2.p2.2.m2.1.1.1.1.1.1" xref="S3.SS2.p2.2.m2.1.1.1.1.1.2.cmml"><mo id="S3.SS2.p2.2.m2.1.1.1.1.1.1.2" stretchy="false" xref="S3.SS2.p2.2.m2.1.1.1.1.1.2.1.cmml">[</mo><mrow id="S3.SS2.p2.2.m2.1.1.1.1.1.1.1" xref="S3.SS2.p2.2.m2.1.1.1.1.1.1.1.cmml"><msub id="S3.SS2.p2.2.m2.1.1.1.1.1.1.1.3" xref="S3.SS2.p2.2.m2.1.1.1.1.1.1.1.3.cmml"><mi id="S3.SS2.p2.2.m2.1.1.1.1.1.1.1.3.2" xref="S3.SS2.p2.2.m2.1.1.1.1.1.1.1.3.2.cmml">ϕ</mi><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p2.2.m2.1.1.1.1.1.1.1.3.3" xref="S3.SS2.p2.2.m2.1.1.1.1.1.1.1.3.3.cmml">𝒢</mi></msub><mo id="S3.SS2.p2.2.m2.1.1.1.1.1.1.1.2" xref="S3.SS2.p2.2.m2.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.SS2.p2.2.m2.1.1.1.1.1.1.1.1.1" xref="S3.SS2.p2.2.m2.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.SS2.p2.2.m2.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.SS2.p2.2.m2.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.SS2.p2.2.m2.1.1.1.1.1.1.1.1.1.1" xref="S3.SS2.p2.2.m2.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.SS2.p2.2.m2.1.1.1.1.1.1.1.1.1.1.2" xref="S3.SS2.p2.2.m2.1.1.1.1.1.1.1.1.1.1.2.cmml">v</mi><mi id="S3.SS2.p2.2.m2.1.1.1.1.1.1.1.1.1.1.3" xref="S3.SS2.p2.2.m2.1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS2.p2.2.m2.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.SS2.p2.2.m2.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS2.p2.2.m2.1.1.1.1.1.1.3" stretchy="false" xref="S3.SS2.p2.2.m2.1.1.1.1.1.2.1.cmml">]</mo></mrow><mrow id="S3.SS2.p2.2.m2.1.1.1.1.3" xref="S3.SS2.p2.2.m2.1.1.1.1.3.cmml"><mi id="S3.SS2.p2.2.m2.1.1.1.1.3.2" xref="S3.SS2.p2.2.m2.1.1.1.1.3.2.cmml">i</mi><mo id="S3.SS2.p2.2.m2.1.1.1.1.3.1" xref="S3.SS2.p2.2.m2.1.1.1.1.3.1.cmml">=</mo><mn id="S3.SS2.p2.2.m2.1.1.1.1.3.3" xref="S3.SS2.p2.2.m2.1.1.1.1.3.3.cmml">1</mn></mrow><mi id="S3.SS2.p2.2.m2.1.1.1.3" xref="S3.SS2.p2.2.m2.1.1.1.3.cmml">N</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.2.m2.1b"><apply id="S3.SS2.p2.2.m2.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1"><ci id="S3.SS2.p2.2.m2.1.1.2.cmml" xref="S3.SS2.p2.2.m2.1.1.2">≕</ci><apply id="S3.SS2.p2.2.m2.1.1.3.cmml" xref="S3.SS2.p2.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p2.2.m2.1.1.3.1.cmml" xref="S3.SS2.p2.2.m2.1.1.3">subscript</csymbol><ci id="S3.SS2.p2.2.m2.1.1.3.2.cmml" xref="S3.SS2.p2.2.m2.1.1.3.2">𝚽</ci><ci id="S3.SS2.p2.2.m2.1.1.3.3.cmml" xref="S3.SS2.p2.2.m2.1.1.3.3">𝒢</ci></apply><apply id="S3.SS2.p2.2.m2.1.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.2.m2.1.1.1.2.cmml" xref="S3.SS2.p2.2.m2.1.1.1">superscript</csymbol><apply id="S3.SS2.p2.2.m2.1.1.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.2.m2.1.1.1.1.2.cmml" xref="S3.SS2.p2.2.m2.1.1.1">subscript</csymbol><apply id="S3.SS2.p2.2.m2.1.1.1.1.1.2.cmml" xref="S3.SS2.p2.2.m2.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.SS2.p2.2.m2.1.1.1.1.1.2.1.cmml" xref="S3.SS2.p2.2.m2.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.SS2.p2.2.m2.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1.1.1.1.1.1"><times id="S3.SS2.p2.2.m2.1.1.1.1.1.1.1.2.cmml" xref="S3.SS2.p2.2.m2.1.1.1.1.1.1.1.2"></times><apply id="S3.SS2.p2.2.m2.1.1.1.1.1.1.1.3.cmml" xref="S3.SS2.p2.2.m2.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p2.2.m2.1.1.1.1.1.1.1.3.1.cmml" xref="S3.SS2.p2.2.m2.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS2.p2.2.m2.1.1.1.1.1.1.1.3.2.cmml" xref="S3.SS2.p2.2.m2.1.1.1.1.1.1.1.3.2">italic-ϕ</ci><ci id="S3.SS2.p2.2.m2.1.1.1.1.1.1.1.3.3.cmml" xref="S3.SS2.p2.2.m2.1.1.1.1.1.1.1.3.3">𝒢</ci></apply><apply id="S3.SS2.p2.2.m2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.2.m2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.p2.2.m2.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.SS2.p2.2.m2.1.1.1.1.1.1.1.1.1.1.2">𝑣</ci><ci id="S3.SS2.p2.2.m2.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.SS2.p2.2.m2.1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply></apply><apply id="S3.SS2.p2.2.m2.1.1.1.1.3.cmml" xref="S3.SS2.p2.2.m2.1.1.1.1.3"><eq id="S3.SS2.p2.2.m2.1.1.1.1.3.1.cmml" xref="S3.SS2.p2.2.m2.1.1.1.1.3.1"></eq><ci id="S3.SS2.p2.2.m2.1.1.1.1.3.2.cmml" xref="S3.SS2.p2.2.m2.1.1.1.1.3.2">𝑖</ci><cn id="S3.SS2.p2.2.m2.1.1.1.1.3.3.cmml" type="integer" xref="S3.SS2.p2.2.m2.1.1.1.1.3.3">1</cn></apply></apply><ci id="S3.SS2.p2.2.m2.1.1.1.3.cmml" xref="S3.SS2.p2.2.m2.1.1.1.3">𝑁</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.2.m2.1c">\mathbf{\Phi}_{\mathcal{G}}\eqqcolon[\phi_{\mathcal{G}}(v_{i})]_{i=1}^{N}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.2.m2.1d">bold_Φ start_POSTSUBSCRIPT caligraphic_G end_POSTSUBSCRIPT ≕ [ italic_ϕ start_POSTSUBSCRIPT caligraphic_G end_POSTSUBSCRIPT ( italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) ] start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT</annotation></semantics></math> with <math alttext="\phi_{\mathcal{G}}(v_{i})\in\mathbb{R}^{N}" class="ltx_Math" display="inline" id="S3.SS2.p2.3.m3.1"><semantics id="S3.SS2.p2.3.m3.1a"><mrow id="S3.SS2.p2.3.m3.1.1" xref="S3.SS2.p2.3.m3.1.1.cmml"><mrow id="S3.SS2.p2.3.m3.1.1.1" xref="S3.SS2.p2.3.m3.1.1.1.cmml"><msub id="S3.SS2.p2.3.m3.1.1.1.3" xref="S3.SS2.p2.3.m3.1.1.1.3.cmml"><mi id="S3.SS2.p2.3.m3.1.1.1.3.2" xref="S3.SS2.p2.3.m3.1.1.1.3.2.cmml">ϕ</mi><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p2.3.m3.1.1.1.3.3" xref="S3.SS2.p2.3.m3.1.1.1.3.3.cmml">𝒢</mi></msub><mo id="S3.SS2.p2.3.m3.1.1.1.2" xref="S3.SS2.p2.3.m3.1.1.1.2.cmml">⁢</mo><mrow id="S3.SS2.p2.3.m3.1.1.1.1.1" xref="S3.SS2.p2.3.m3.1.1.1.1.1.1.cmml"><mo id="S3.SS2.p2.3.m3.1.1.1.1.1.2" stretchy="false" xref="S3.SS2.p2.3.m3.1.1.1.1.1.1.cmml">(</mo><msub id="S3.SS2.p2.3.m3.1.1.1.1.1.1" xref="S3.SS2.p2.3.m3.1.1.1.1.1.1.cmml"><mi id="S3.SS2.p2.3.m3.1.1.1.1.1.1.2" xref="S3.SS2.p2.3.m3.1.1.1.1.1.1.2.cmml">v</mi><mi id="S3.SS2.p2.3.m3.1.1.1.1.1.1.3" xref="S3.SS2.p2.3.m3.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS2.p2.3.m3.1.1.1.1.1.3" stretchy="false" xref="S3.SS2.p2.3.m3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS2.p2.3.m3.1.1.2" xref="S3.SS2.p2.3.m3.1.1.2.cmml">∈</mo><msup id="S3.SS2.p2.3.m3.1.1.3" xref="S3.SS2.p2.3.m3.1.1.3.cmml"><mi id="S3.SS2.p2.3.m3.1.1.3.2" xref="S3.SS2.p2.3.m3.1.1.3.2.cmml">ℝ</mi><mi id="S3.SS2.p2.3.m3.1.1.3.3" xref="S3.SS2.p2.3.m3.1.1.3.3.cmml">N</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.3.m3.1b"><apply id="S3.SS2.p2.3.m3.1.1.cmml" xref="S3.SS2.p2.3.m3.1.1"><in id="S3.SS2.p2.3.m3.1.1.2.cmml" xref="S3.SS2.p2.3.m3.1.1.2"></in><apply id="S3.SS2.p2.3.m3.1.1.1.cmml" xref="S3.SS2.p2.3.m3.1.1.1"><times id="S3.SS2.p2.3.m3.1.1.1.2.cmml" xref="S3.SS2.p2.3.m3.1.1.1.2"></times><apply id="S3.SS2.p2.3.m3.1.1.1.3.cmml" xref="S3.SS2.p2.3.m3.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p2.3.m3.1.1.1.3.1.cmml" xref="S3.SS2.p2.3.m3.1.1.1.3">subscript</csymbol><ci id="S3.SS2.p2.3.m3.1.1.1.3.2.cmml" xref="S3.SS2.p2.3.m3.1.1.1.3.2">italic-ϕ</ci><ci id="S3.SS2.p2.3.m3.1.1.1.3.3.cmml" xref="S3.SS2.p2.3.m3.1.1.1.3.3">𝒢</ci></apply><apply id="S3.SS2.p2.3.m3.1.1.1.1.1.1.cmml" xref="S3.SS2.p2.3.m3.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.3.m3.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p2.3.m3.1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.p2.3.m3.1.1.1.1.1.1.2.cmml" xref="S3.SS2.p2.3.m3.1.1.1.1.1.1.2">𝑣</ci><ci id="S3.SS2.p2.3.m3.1.1.1.1.1.1.3.cmml" xref="S3.SS2.p2.3.m3.1.1.1.1.1.1.3">𝑖</ci></apply></apply><apply id="S3.SS2.p2.3.m3.1.1.3.cmml" xref="S3.SS2.p2.3.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p2.3.m3.1.1.3.1.cmml" xref="S3.SS2.p2.3.m3.1.1.3">superscript</csymbol><ci id="S3.SS2.p2.3.m3.1.1.3.2.cmml" xref="S3.SS2.p2.3.m3.1.1.3.2">ℝ</ci><ci id="S3.SS2.p2.3.m3.1.1.3.3.cmml" xref="S3.SS2.p2.3.m3.1.1.3.3">𝑁</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.3.m3.1c">\phi_{\mathcal{G}}(v_{i})\in\mathbb{R}^{N}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.3.m3.1d">italic_ϕ start_POSTSUBSCRIPT caligraphic_G end_POSTSUBSCRIPT ( italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) ∈ blackboard_R start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT</annotation></semantics></math> the graph feature of node <math alttext="v_{i}" class="ltx_Math" display="inline" id="S3.SS2.p2.4.m4.1"><semantics id="S3.SS2.p2.4.m4.1a"><msub id="S3.SS2.p2.4.m4.1.1" xref="S3.SS2.p2.4.m4.1.1.cmml"><mi id="S3.SS2.p2.4.m4.1.1.2" xref="S3.SS2.p2.4.m4.1.1.2.cmml">v</mi><mi id="S3.SS2.p2.4.m4.1.1.3" xref="S3.SS2.p2.4.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.4.m4.1b"><apply id="S3.SS2.p2.4.m4.1.1.cmml" xref="S3.SS2.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.4.m4.1.1.1.cmml" xref="S3.SS2.p2.4.m4.1.1">subscript</csymbol><ci id="S3.SS2.p2.4.m4.1.1.2.cmml" xref="S3.SS2.p2.4.m4.1.1.2">𝑣</ci><ci id="S3.SS2.p2.4.m4.1.1.3.cmml" xref="S3.SS2.p2.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.4.m4.1c">v_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.4.m4.1d">italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>.
For every kernel there trivially exists a feature map <cite class="ltx_cite ltx_citemacro_citep">(Gretton, <a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#bib.bib14" title="">2013</a>)</cite>, but unusually in this case it is finite-dimensional and admits a simple closed form.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS2.p3">
<p class="ltx_p" id="S3.SS2.p3.10">Let <math alttext="\otimes:\mathbb{R}^{m}\times\mathbb{R}^{N}\to\mathbb{R}^{m\times N}" class="ltx_math_unparsed" display="inline" id="S3.SS2.p3.1.m1.2"><semantics id="S3.SS2.p3.1.m1.2a"><mrow id="S3.SS2.p3.1.m1.2b"><mo id="S3.SS2.p3.1.m1.1.1" rspace="0em">⊗</mo><mo id="S3.SS2.p3.1.m1.2.2" rspace="0.278em">:</mo><msup id="S3.SS2.p3.1.m1.2.3"><mi id="S3.SS2.p3.1.m1.2.3.2">ℝ</mi><mi id="S3.SS2.p3.1.m1.2.3.3">m</mi></msup><mo id="S3.SS2.p3.1.m1.2.4" lspace="0.222em" rspace="0.222em">×</mo><msup id="S3.SS2.p3.1.m1.2.5"><mi id="S3.SS2.p3.1.m1.2.5.2">ℝ</mi><mi id="S3.SS2.p3.1.m1.2.5.3">N</mi></msup><mo id="S3.SS2.p3.1.m1.2.6" stretchy="false">→</mo><msup id="S3.SS2.p3.1.m1.2.7"><mi id="S3.SS2.p3.1.m1.2.7.2">ℝ</mi><mrow id="S3.SS2.p3.1.m1.2.7.3"><mi id="S3.SS2.p3.1.m1.2.7.3.2">m</mi><mo id="S3.SS2.p3.1.m1.2.7.3.1" lspace="0.222em" rspace="0.222em">×</mo><mi id="S3.SS2.p3.1.m1.2.7.3.3">N</mi></mrow></msup></mrow><annotation encoding="application/x-tex" id="S3.SS2.p3.1.m1.2c">\otimes:\mathbb{R}^{m}\times\mathbb{R}^{N}\to\mathbb{R}^{m\times N}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.1.m1.2d">⊗ : blackboard_R start_POSTSUPERSCRIPT italic_m end_POSTSUPERSCRIPT × blackboard_R start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT → blackboard_R start_POSTSUPERSCRIPT italic_m × italic_N end_POSTSUPERSCRIPT</annotation></semantics></math> denote the <em class="ltx_emph ltx_font_italic" id="S3.SS2.p3.10.1">outer product</em> which maps a pair of vectors to a matrix, and <math alttext="\textrm{vec}:\mathbb{R}^{m\times N}\to\mathbb{R}^{mN}" class="ltx_Math" display="inline" id="S3.SS2.p3.2.m2.1"><semantics id="S3.SS2.p3.2.m2.1a"><mrow id="S3.SS2.p3.2.m2.1.1" xref="S3.SS2.p3.2.m2.1.1.cmml"><mtext id="S3.SS2.p3.2.m2.1.1.2" xref="S3.SS2.p3.2.m2.1.1.2a.cmml">vec</mtext><mo id="S3.SS2.p3.2.m2.1.1.1" lspace="0.278em" rspace="0.278em" xref="S3.SS2.p3.2.m2.1.1.1.cmml">:</mo><mrow id="S3.SS2.p3.2.m2.1.1.3" xref="S3.SS2.p3.2.m2.1.1.3.cmml"><msup id="S3.SS2.p3.2.m2.1.1.3.2" xref="S3.SS2.p3.2.m2.1.1.3.2.cmml"><mi id="S3.SS2.p3.2.m2.1.1.3.2.2" xref="S3.SS2.p3.2.m2.1.1.3.2.2.cmml">ℝ</mi><mrow id="S3.SS2.p3.2.m2.1.1.3.2.3" xref="S3.SS2.p3.2.m2.1.1.3.2.3.cmml"><mi id="S3.SS2.p3.2.m2.1.1.3.2.3.2" xref="S3.SS2.p3.2.m2.1.1.3.2.3.2.cmml">m</mi><mo id="S3.SS2.p3.2.m2.1.1.3.2.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS2.p3.2.m2.1.1.3.2.3.1.cmml">×</mo><mi id="S3.SS2.p3.2.m2.1.1.3.2.3.3" xref="S3.SS2.p3.2.m2.1.1.3.2.3.3.cmml">N</mi></mrow></msup><mo id="S3.SS2.p3.2.m2.1.1.3.1" stretchy="false" xref="S3.SS2.p3.2.m2.1.1.3.1.cmml">→</mo><msup id="S3.SS2.p3.2.m2.1.1.3.3" xref="S3.SS2.p3.2.m2.1.1.3.3.cmml"><mi id="S3.SS2.p3.2.m2.1.1.3.3.2" xref="S3.SS2.p3.2.m2.1.1.3.3.2.cmml">ℝ</mi><mrow id="S3.SS2.p3.2.m2.1.1.3.3.3" xref="S3.SS2.p3.2.m2.1.1.3.3.3.cmml"><mi id="S3.SS2.p3.2.m2.1.1.3.3.3.2" xref="S3.SS2.p3.2.m2.1.1.3.3.3.2.cmml">m</mi><mo id="S3.SS2.p3.2.m2.1.1.3.3.3.1" xref="S3.SS2.p3.2.m2.1.1.3.3.3.1.cmml">⁢</mo><mi id="S3.SS2.p3.2.m2.1.1.3.3.3.3" xref="S3.SS2.p3.2.m2.1.1.3.3.3.3.cmml">N</mi></mrow></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.2.m2.1b"><apply id="S3.SS2.p3.2.m2.1.1.cmml" xref="S3.SS2.p3.2.m2.1.1"><ci id="S3.SS2.p3.2.m2.1.1.1.cmml" xref="S3.SS2.p3.2.m2.1.1.1">:</ci><ci id="S3.SS2.p3.2.m2.1.1.2a.cmml" xref="S3.SS2.p3.2.m2.1.1.2"><mtext id="S3.SS2.p3.2.m2.1.1.2.cmml" xref="S3.SS2.p3.2.m2.1.1.2">vec</mtext></ci><apply id="S3.SS2.p3.2.m2.1.1.3.cmml" xref="S3.SS2.p3.2.m2.1.1.3"><ci id="S3.SS2.p3.2.m2.1.1.3.1.cmml" xref="S3.SS2.p3.2.m2.1.1.3.1">→</ci><apply id="S3.SS2.p3.2.m2.1.1.3.2.cmml" xref="S3.SS2.p3.2.m2.1.1.3.2"><csymbol cd="ambiguous" id="S3.SS2.p3.2.m2.1.1.3.2.1.cmml" xref="S3.SS2.p3.2.m2.1.1.3.2">superscript</csymbol><ci id="S3.SS2.p3.2.m2.1.1.3.2.2.cmml" xref="S3.SS2.p3.2.m2.1.1.3.2.2">ℝ</ci><apply id="S3.SS2.p3.2.m2.1.1.3.2.3.cmml" xref="S3.SS2.p3.2.m2.1.1.3.2.3"><times id="S3.SS2.p3.2.m2.1.1.3.2.3.1.cmml" xref="S3.SS2.p3.2.m2.1.1.3.2.3.1"></times><ci id="S3.SS2.p3.2.m2.1.1.3.2.3.2.cmml" xref="S3.SS2.p3.2.m2.1.1.3.2.3.2">𝑚</ci><ci id="S3.SS2.p3.2.m2.1.1.3.2.3.3.cmml" xref="S3.SS2.p3.2.m2.1.1.3.2.3.3">𝑁</ci></apply></apply><apply id="S3.SS2.p3.2.m2.1.1.3.3.cmml" xref="S3.SS2.p3.2.m2.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS2.p3.2.m2.1.1.3.3.1.cmml" xref="S3.SS2.p3.2.m2.1.1.3.3">superscript</csymbol><ci id="S3.SS2.p3.2.m2.1.1.3.3.2.cmml" xref="S3.SS2.p3.2.m2.1.1.3.3.2">ℝ</ci><apply id="S3.SS2.p3.2.m2.1.1.3.3.3.cmml" xref="S3.SS2.p3.2.m2.1.1.3.3.3"><times id="S3.SS2.p3.2.m2.1.1.3.3.3.1.cmml" xref="S3.SS2.p3.2.m2.1.1.3.3.3.1"></times><ci id="S3.SS2.p3.2.m2.1.1.3.3.3.2.cmml" xref="S3.SS2.p3.2.m2.1.1.3.3.3.2">𝑚</ci><ci id="S3.SS2.p3.2.m2.1.1.3.3.3.3.cmml" xref="S3.SS2.p3.2.m2.1.1.3.3.3.3">𝑁</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.2.m2.1c">\textrm{vec}:\mathbb{R}^{m\times N}\to\mathbb{R}^{mN}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.2.m2.1d">vec : blackboard_R start_POSTSUPERSCRIPT italic_m × italic_N end_POSTSUPERSCRIPT → blackboard_R start_POSTSUPERSCRIPT italic_m italic_N end_POSTSUPERSCRIPT</annotation></semantics></math> denote the <em class="ltx_emph ltx_font_italic" id="S3.SS2.p3.10.2">vectorising</em> operation that flattens a matrix into a vector.
Then <math alttext="\phi(\mathbf{q}_{i})\otimes\phi_{\mathcal{G}}(v_{i})" class="ltx_Math" display="inline" id="S3.SS2.p3.3.m3.2"><semantics id="S3.SS2.p3.3.m3.2a"><mrow id="S3.SS2.p3.3.m3.2.2" xref="S3.SS2.p3.3.m3.2.2.cmml"><mrow id="S3.SS2.p3.3.m3.1.1.1" xref="S3.SS2.p3.3.m3.1.1.1.cmml"><mrow id="S3.SS2.p3.3.m3.1.1.1.1" xref="S3.SS2.p3.3.m3.1.1.1.1.cmml"><mi id="S3.SS2.p3.3.m3.1.1.1.1.3" xref="S3.SS2.p3.3.m3.1.1.1.1.3.cmml">ϕ</mi><mo id="S3.SS2.p3.3.m3.1.1.1.1.2" xref="S3.SS2.p3.3.m3.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.SS2.p3.3.m3.1.1.1.1.1.1" xref="S3.SS2.p3.3.m3.1.1.1.1.1.1.1.cmml"><mo id="S3.SS2.p3.3.m3.1.1.1.1.1.1.2" stretchy="false" xref="S3.SS2.p3.3.m3.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.SS2.p3.3.m3.1.1.1.1.1.1.1" xref="S3.SS2.p3.3.m3.1.1.1.1.1.1.1.cmml"><mi id="S3.SS2.p3.3.m3.1.1.1.1.1.1.1.2" xref="S3.SS2.p3.3.m3.1.1.1.1.1.1.1.2.cmml">𝐪</mi><mi id="S3.SS2.p3.3.m3.1.1.1.1.1.1.1.3" xref="S3.SS2.p3.3.m3.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS2.p3.3.m3.1.1.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="S3.SS2.p3.3.m3.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS2.p3.3.m3.1.1.1.2" rspace="0.222em" xref="S3.SS2.p3.3.m3.1.1.1.2.cmml">⊗</mo><msub id="S3.SS2.p3.3.m3.1.1.1.3" xref="S3.SS2.p3.3.m3.1.1.1.3.cmml"><mi id="S3.SS2.p3.3.m3.1.1.1.3.2" xref="S3.SS2.p3.3.m3.1.1.1.3.2.cmml">ϕ</mi><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p3.3.m3.1.1.1.3.3" xref="S3.SS2.p3.3.m3.1.1.1.3.3.cmml">𝒢</mi></msub></mrow><mo id="S3.SS2.p3.3.m3.2.2.3" xref="S3.SS2.p3.3.m3.2.2.3.cmml">⁢</mo><mrow id="S3.SS2.p3.3.m3.2.2.2.1" xref="S3.SS2.p3.3.m3.2.2.2.1.1.cmml"><mo id="S3.SS2.p3.3.m3.2.2.2.1.2" stretchy="false" xref="S3.SS2.p3.3.m3.2.2.2.1.1.cmml">(</mo><msub id="S3.SS2.p3.3.m3.2.2.2.1.1" xref="S3.SS2.p3.3.m3.2.2.2.1.1.cmml"><mi id="S3.SS2.p3.3.m3.2.2.2.1.1.2" xref="S3.SS2.p3.3.m3.2.2.2.1.1.2.cmml">v</mi><mi id="S3.SS2.p3.3.m3.2.2.2.1.1.3" xref="S3.SS2.p3.3.m3.2.2.2.1.1.3.cmml">i</mi></msub><mo id="S3.SS2.p3.3.m3.2.2.2.1.3" stretchy="false" xref="S3.SS2.p3.3.m3.2.2.2.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.3.m3.2b"><apply id="S3.SS2.p3.3.m3.2.2.cmml" xref="S3.SS2.p3.3.m3.2.2"><times id="S3.SS2.p3.3.m3.2.2.3.cmml" xref="S3.SS2.p3.3.m3.2.2.3"></times><apply id="S3.SS2.p3.3.m3.1.1.1.cmml" xref="S3.SS2.p3.3.m3.1.1.1"><csymbol cd="latexml" id="S3.SS2.p3.3.m3.1.1.1.2.cmml" xref="S3.SS2.p3.3.m3.1.1.1.2">tensor-product</csymbol><apply id="S3.SS2.p3.3.m3.1.1.1.1.cmml" xref="S3.SS2.p3.3.m3.1.1.1.1"><times id="S3.SS2.p3.3.m3.1.1.1.1.2.cmml" xref="S3.SS2.p3.3.m3.1.1.1.1.2"></times><ci id="S3.SS2.p3.3.m3.1.1.1.1.3.cmml" xref="S3.SS2.p3.3.m3.1.1.1.1.3">italic-ϕ</ci><apply id="S3.SS2.p3.3.m3.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p3.3.m3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.3.m3.1.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p3.3.m3.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.p3.3.m3.1.1.1.1.1.1.1.2.cmml" xref="S3.SS2.p3.3.m3.1.1.1.1.1.1.1.2">𝐪</ci><ci id="S3.SS2.p3.3.m3.1.1.1.1.1.1.1.3.cmml" xref="S3.SS2.p3.3.m3.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply><apply id="S3.SS2.p3.3.m3.1.1.1.3.cmml" xref="S3.SS2.p3.3.m3.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p3.3.m3.1.1.1.3.1.cmml" xref="S3.SS2.p3.3.m3.1.1.1.3">subscript</csymbol><ci id="S3.SS2.p3.3.m3.1.1.1.3.2.cmml" xref="S3.SS2.p3.3.m3.1.1.1.3.2">italic-ϕ</ci><ci id="S3.SS2.p3.3.m3.1.1.1.3.3.cmml" xref="S3.SS2.p3.3.m3.1.1.1.3.3">𝒢</ci></apply></apply><apply id="S3.SS2.p3.3.m3.2.2.2.1.1.cmml" xref="S3.SS2.p3.3.m3.2.2.2.1"><csymbol cd="ambiguous" id="S3.SS2.p3.3.m3.2.2.2.1.1.1.cmml" xref="S3.SS2.p3.3.m3.2.2.2.1">subscript</csymbol><ci id="S3.SS2.p3.3.m3.2.2.2.1.1.2.cmml" xref="S3.SS2.p3.3.m3.2.2.2.1.1.2">𝑣</ci><ci id="S3.SS2.p3.3.m3.2.2.2.1.1.3.cmml" xref="S3.SS2.p3.3.m3.2.2.2.1.1.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.3.m3.2c">\phi(\mathbf{q}_{i})\otimes\phi_{\mathcal{G}}(v_{i})</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.3.m3.2d">italic_ϕ ( bold_q start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) ⊗ italic_ϕ start_POSTSUBSCRIPT caligraphic_G end_POSTSUBSCRIPT ( italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT )</annotation></semantics></math> is an <math alttext="m\times N" class="ltx_Math" display="inline" id="S3.SS2.p3.4.m4.1"><semantics id="S3.SS2.p3.4.m4.1a"><mrow id="S3.SS2.p3.4.m4.1.1" xref="S3.SS2.p3.4.m4.1.1.cmml"><mi id="S3.SS2.p3.4.m4.1.1.2" xref="S3.SS2.p3.4.m4.1.1.2.cmml">m</mi><mo id="S3.SS2.p3.4.m4.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.SS2.p3.4.m4.1.1.1.cmml">×</mo><mi id="S3.SS2.p3.4.m4.1.1.3" xref="S3.SS2.p3.4.m4.1.1.3.cmml">N</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.4.m4.1b"><apply id="S3.SS2.p3.4.m4.1.1.cmml" xref="S3.SS2.p3.4.m4.1.1"><times id="S3.SS2.p3.4.m4.1.1.1.cmml" xref="S3.SS2.p3.4.m4.1.1.1"></times><ci id="S3.SS2.p3.4.m4.1.1.2.cmml" xref="S3.SS2.p3.4.m4.1.1.2">𝑚</ci><ci id="S3.SS2.p3.4.m4.1.1.3.cmml" xref="S3.SS2.p3.4.m4.1.1.3">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.4.m4.1c">m\times N</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.4.m4.1d">italic_m × italic_N</annotation></semantics></math> matrix whose <math alttext="jk" class="ltx_Math" display="inline" id="S3.SS2.p3.5.m5.1"><semantics id="S3.SS2.p3.5.m5.1a"><mrow id="S3.SS2.p3.5.m5.1.1" xref="S3.SS2.p3.5.m5.1.1.cmml"><mi id="S3.SS2.p3.5.m5.1.1.2" xref="S3.SS2.p3.5.m5.1.1.2.cmml">j</mi><mo id="S3.SS2.p3.5.m5.1.1.1" xref="S3.SS2.p3.5.m5.1.1.1.cmml">⁢</mo><mi id="S3.SS2.p3.5.m5.1.1.3" xref="S3.SS2.p3.5.m5.1.1.3.cmml">k</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.5.m5.1b"><apply id="S3.SS2.p3.5.m5.1.1.cmml" xref="S3.SS2.p3.5.m5.1.1"><times id="S3.SS2.p3.5.m5.1.1.1.cmml" xref="S3.SS2.p3.5.m5.1.1.1"></times><ci id="S3.SS2.p3.5.m5.1.1.2.cmml" xref="S3.SS2.p3.5.m5.1.1.2">𝑗</ci><ci id="S3.SS2.p3.5.m5.1.1.3.cmml" xref="S3.SS2.p3.5.m5.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.5.m5.1c">jk</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.5.m5.1d">italic_j italic_k</annotation></semantics></math>th element is <math alttext="\phi(\mathbf{q}_{i})_{j}\phi_{\mathcal{G}}(v_{i})_{k}" class="ltx_Math" display="inline" id="S3.SS2.p3.6.m6.2"><semantics id="S3.SS2.p3.6.m6.2a"><mrow id="S3.SS2.p3.6.m6.2.2" xref="S3.SS2.p3.6.m6.2.2.cmml"><mi id="S3.SS2.p3.6.m6.2.2.4" xref="S3.SS2.p3.6.m6.2.2.4.cmml">ϕ</mi><mo id="S3.SS2.p3.6.m6.2.2.3" xref="S3.SS2.p3.6.m6.2.2.3.cmml">⁢</mo><msub id="S3.SS2.p3.6.m6.1.1.1" xref="S3.SS2.p3.6.m6.1.1.1.cmml"><mrow id="S3.SS2.p3.6.m6.1.1.1.1.1" xref="S3.SS2.p3.6.m6.1.1.1.1.1.1.cmml"><mo id="S3.SS2.p3.6.m6.1.1.1.1.1.2" stretchy="false" xref="S3.SS2.p3.6.m6.1.1.1.1.1.1.cmml">(</mo><msub id="S3.SS2.p3.6.m6.1.1.1.1.1.1" xref="S3.SS2.p3.6.m6.1.1.1.1.1.1.cmml"><mi id="S3.SS2.p3.6.m6.1.1.1.1.1.1.2" xref="S3.SS2.p3.6.m6.1.1.1.1.1.1.2.cmml">𝐪</mi><mi id="S3.SS2.p3.6.m6.1.1.1.1.1.1.3" xref="S3.SS2.p3.6.m6.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS2.p3.6.m6.1.1.1.1.1.3" stretchy="false" xref="S3.SS2.p3.6.m6.1.1.1.1.1.1.cmml">)</mo></mrow><mi id="S3.SS2.p3.6.m6.1.1.1.3" xref="S3.SS2.p3.6.m6.1.1.1.3.cmml">j</mi></msub><mo id="S3.SS2.p3.6.m6.2.2.3a" xref="S3.SS2.p3.6.m6.2.2.3.cmml">⁢</mo><msub id="S3.SS2.p3.6.m6.2.2.5" xref="S3.SS2.p3.6.m6.2.2.5.cmml"><mi id="S3.SS2.p3.6.m6.2.2.5.2" xref="S3.SS2.p3.6.m6.2.2.5.2.cmml">ϕ</mi><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p3.6.m6.2.2.5.3" xref="S3.SS2.p3.6.m6.2.2.5.3.cmml">𝒢</mi></msub><mo id="S3.SS2.p3.6.m6.2.2.3b" xref="S3.SS2.p3.6.m6.2.2.3.cmml">⁢</mo><msub id="S3.SS2.p3.6.m6.2.2.2" xref="S3.SS2.p3.6.m6.2.2.2.cmml"><mrow id="S3.SS2.p3.6.m6.2.2.2.1.1" xref="S3.SS2.p3.6.m6.2.2.2.1.1.1.cmml"><mo id="S3.SS2.p3.6.m6.2.2.2.1.1.2" stretchy="false" xref="S3.SS2.p3.6.m6.2.2.2.1.1.1.cmml">(</mo><msub id="S3.SS2.p3.6.m6.2.2.2.1.1.1" xref="S3.SS2.p3.6.m6.2.2.2.1.1.1.cmml"><mi id="S3.SS2.p3.6.m6.2.2.2.1.1.1.2" xref="S3.SS2.p3.6.m6.2.2.2.1.1.1.2.cmml">v</mi><mi id="S3.SS2.p3.6.m6.2.2.2.1.1.1.3" xref="S3.SS2.p3.6.m6.2.2.2.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS2.p3.6.m6.2.2.2.1.1.3" stretchy="false" xref="S3.SS2.p3.6.m6.2.2.2.1.1.1.cmml">)</mo></mrow><mi id="S3.SS2.p3.6.m6.2.2.2.3" xref="S3.SS2.p3.6.m6.2.2.2.3.cmml">k</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.6.m6.2b"><apply id="S3.SS2.p3.6.m6.2.2.cmml" xref="S3.SS2.p3.6.m6.2.2"><times id="S3.SS2.p3.6.m6.2.2.3.cmml" xref="S3.SS2.p3.6.m6.2.2.3"></times><ci id="S3.SS2.p3.6.m6.2.2.4.cmml" xref="S3.SS2.p3.6.m6.2.2.4">italic-ϕ</ci><apply id="S3.SS2.p3.6.m6.1.1.1.cmml" xref="S3.SS2.p3.6.m6.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.6.m6.1.1.1.2.cmml" xref="S3.SS2.p3.6.m6.1.1.1">subscript</csymbol><apply id="S3.SS2.p3.6.m6.1.1.1.1.1.1.cmml" xref="S3.SS2.p3.6.m6.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.6.m6.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p3.6.m6.1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.p3.6.m6.1.1.1.1.1.1.2.cmml" xref="S3.SS2.p3.6.m6.1.1.1.1.1.1.2">𝐪</ci><ci id="S3.SS2.p3.6.m6.1.1.1.1.1.1.3.cmml" xref="S3.SS2.p3.6.m6.1.1.1.1.1.1.3">𝑖</ci></apply><ci id="S3.SS2.p3.6.m6.1.1.1.3.cmml" xref="S3.SS2.p3.6.m6.1.1.1.3">𝑗</ci></apply><apply id="S3.SS2.p3.6.m6.2.2.5.cmml" xref="S3.SS2.p3.6.m6.2.2.5"><csymbol cd="ambiguous" id="S3.SS2.p3.6.m6.2.2.5.1.cmml" xref="S3.SS2.p3.6.m6.2.2.5">subscript</csymbol><ci id="S3.SS2.p3.6.m6.2.2.5.2.cmml" xref="S3.SS2.p3.6.m6.2.2.5.2">italic-ϕ</ci><ci id="S3.SS2.p3.6.m6.2.2.5.3.cmml" xref="S3.SS2.p3.6.m6.2.2.5.3">𝒢</ci></apply><apply id="S3.SS2.p3.6.m6.2.2.2.cmml" xref="S3.SS2.p3.6.m6.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p3.6.m6.2.2.2.2.cmml" xref="S3.SS2.p3.6.m6.2.2.2">subscript</csymbol><apply id="S3.SS2.p3.6.m6.2.2.2.1.1.1.cmml" xref="S3.SS2.p3.6.m6.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.6.m6.2.2.2.1.1.1.1.cmml" xref="S3.SS2.p3.6.m6.2.2.2.1.1">subscript</csymbol><ci id="S3.SS2.p3.6.m6.2.2.2.1.1.1.2.cmml" xref="S3.SS2.p3.6.m6.2.2.2.1.1.1.2">𝑣</ci><ci id="S3.SS2.p3.6.m6.2.2.2.1.1.1.3.cmml" xref="S3.SS2.p3.6.m6.2.2.2.1.1.1.3">𝑖</ci></apply><ci id="S3.SS2.p3.6.m6.2.2.2.3.cmml" xref="S3.SS2.p3.6.m6.2.2.2.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.6.m6.2c">\phi(\mathbf{q}_{i})_{j}\phi_{\mathcal{G}}(v_{i})_{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.6.m6.2d">italic_ϕ ( bold_q start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT italic_ϕ start_POSTSUBSCRIPT caligraphic_G end_POSTSUBSCRIPT ( italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math>, and <math alttext="\mathrm{vec}\left(\phi(\mathbf{q}_{i})\otimes\phi_{\mathcal{G}}(v_{i})\right)" class="ltx_Math" display="inline" id="S3.SS2.p3.7.m7.1"><semantics id="S3.SS2.p3.7.m7.1a"><mrow id="S3.SS2.p3.7.m7.1.1" xref="S3.SS2.p3.7.m7.1.1.cmml"><mi id="S3.SS2.p3.7.m7.1.1.3" xref="S3.SS2.p3.7.m7.1.1.3.cmml">vec</mi><mo id="S3.SS2.p3.7.m7.1.1.2" xref="S3.SS2.p3.7.m7.1.1.2.cmml">⁢</mo><mrow id="S3.SS2.p3.7.m7.1.1.1.1" xref="S3.SS2.p3.7.m7.1.1.1.1.1.cmml"><mo id="S3.SS2.p3.7.m7.1.1.1.1.2" xref="S3.SS2.p3.7.m7.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.p3.7.m7.1.1.1.1.1" xref="S3.SS2.p3.7.m7.1.1.1.1.1.cmml"><mrow id="S3.SS2.p3.7.m7.1.1.1.1.1.1" xref="S3.SS2.p3.7.m7.1.1.1.1.1.1.cmml"><mrow id="S3.SS2.p3.7.m7.1.1.1.1.1.1.1" xref="S3.SS2.p3.7.m7.1.1.1.1.1.1.1.cmml"><mi id="S3.SS2.p3.7.m7.1.1.1.1.1.1.1.3" xref="S3.SS2.p3.7.m7.1.1.1.1.1.1.1.3.cmml">ϕ</mi><mo id="S3.SS2.p3.7.m7.1.1.1.1.1.1.1.2" xref="S3.SS2.p3.7.m7.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.SS2.p3.7.m7.1.1.1.1.1.1.1.1.1" xref="S3.SS2.p3.7.m7.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.SS2.p3.7.m7.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.SS2.p3.7.m7.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.SS2.p3.7.m7.1.1.1.1.1.1.1.1.1.1" xref="S3.SS2.p3.7.m7.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.SS2.p3.7.m7.1.1.1.1.1.1.1.1.1.1.2" xref="S3.SS2.p3.7.m7.1.1.1.1.1.1.1.1.1.1.2.cmml">𝐪</mi><mi id="S3.SS2.p3.7.m7.1.1.1.1.1.1.1.1.1.1.3" xref="S3.SS2.p3.7.m7.1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS2.p3.7.m7.1.1.1.1.1.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="S3.SS2.p3.7.m7.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS2.p3.7.m7.1.1.1.1.1.1.2" rspace="0.222em" xref="S3.SS2.p3.7.m7.1.1.1.1.1.1.2.cmml">⊗</mo><msub id="S3.SS2.p3.7.m7.1.1.1.1.1.1.3" xref="S3.SS2.p3.7.m7.1.1.1.1.1.1.3.cmml"><mi id="S3.SS2.p3.7.m7.1.1.1.1.1.1.3.2" xref="S3.SS2.p3.7.m7.1.1.1.1.1.1.3.2.cmml">ϕ</mi><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p3.7.m7.1.1.1.1.1.1.3.3" xref="S3.SS2.p3.7.m7.1.1.1.1.1.1.3.3.cmml">𝒢</mi></msub></mrow><mo id="S3.SS2.p3.7.m7.1.1.1.1.1.3" xref="S3.SS2.p3.7.m7.1.1.1.1.1.3.cmml">⁢</mo><mrow id="S3.SS2.p3.7.m7.1.1.1.1.1.2.1" xref="S3.SS2.p3.7.m7.1.1.1.1.1.2.1.1.cmml"><mo id="S3.SS2.p3.7.m7.1.1.1.1.1.2.1.2" stretchy="false" xref="S3.SS2.p3.7.m7.1.1.1.1.1.2.1.1.cmml">(</mo><msub id="S3.SS2.p3.7.m7.1.1.1.1.1.2.1.1" xref="S3.SS2.p3.7.m7.1.1.1.1.1.2.1.1.cmml"><mi id="S3.SS2.p3.7.m7.1.1.1.1.1.2.1.1.2" xref="S3.SS2.p3.7.m7.1.1.1.1.1.2.1.1.2.cmml">v</mi><mi id="S3.SS2.p3.7.m7.1.1.1.1.1.2.1.1.3" xref="S3.SS2.p3.7.m7.1.1.1.1.1.2.1.1.3.cmml">i</mi></msub><mo id="S3.SS2.p3.7.m7.1.1.1.1.1.2.1.3" stretchy="false" xref="S3.SS2.p3.7.m7.1.1.1.1.1.2.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS2.p3.7.m7.1.1.1.1.3" xref="S3.SS2.p3.7.m7.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.7.m7.1b"><apply id="S3.SS2.p3.7.m7.1.1.cmml" xref="S3.SS2.p3.7.m7.1.1"><times id="S3.SS2.p3.7.m7.1.1.2.cmml" xref="S3.SS2.p3.7.m7.1.1.2"></times><ci id="S3.SS2.p3.7.m7.1.1.3.cmml" xref="S3.SS2.p3.7.m7.1.1.3">vec</ci><apply id="S3.SS2.p3.7.m7.1.1.1.1.1.cmml" xref="S3.SS2.p3.7.m7.1.1.1.1"><times id="S3.SS2.p3.7.m7.1.1.1.1.1.3.cmml" xref="S3.SS2.p3.7.m7.1.1.1.1.1.3"></times><apply id="S3.SS2.p3.7.m7.1.1.1.1.1.1.cmml" xref="S3.SS2.p3.7.m7.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.SS2.p3.7.m7.1.1.1.1.1.1.2.cmml" xref="S3.SS2.p3.7.m7.1.1.1.1.1.1.2">tensor-product</csymbol><apply id="S3.SS2.p3.7.m7.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p3.7.m7.1.1.1.1.1.1.1"><times id="S3.SS2.p3.7.m7.1.1.1.1.1.1.1.2.cmml" xref="S3.SS2.p3.7.m7.1.1.1.1.1.1.1.2"></times><ci id="S3.SS2.p3.7.m7.1.1.1.1.1.1.1.3.cmml" xref="S3.SS2.p3.7.m7.1.1.1.1.1.1.1.3">italic-ϕ</ci><apply id="S3.SS2.p3.7.m7.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p3.7.m7.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.7.m7.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p3.7.m7.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.p3.7.m7.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.SS2.p3.7.m7.1.1.1.1.1.1.1.1.1.1.2">𝐪</ci><ci id="S3.SS2.p3.7.m7.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.SS2.p3.7.m7.1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply><apply id="S3.SS2.p3.7.m7.1.1.1.1.1.1.3.cmml" xref="S3.SS2.p3.7.m7.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p3.7.m7.1.1.1.1.1.1.3.1.cmml" xref="S3.SS2.p3.7.m7.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS2.p3.7.m7.1.1.1.1.1.1.3.2.cmml" xref="S3.SS2.p3.7.m7.1.1.1.1.1.1.3.2">italic-ϕ</ci><ci id="S3.SS2.p3.7.m7.1.1.1.1.1.1.3.3.cmml" xref="S3.SS2.p3.7.m7.1.1.1.1.1.1.3.3">𝒢</ci></apply></apply><apply id="S3.SS2.p3.7.m7.1.1.1.1.1.2.1.1.cmml" xref="S3.SS2.p3.7.m7.1.1.1.1.1.2.1"><csymbol cd="ambiguous" id="S3.SS2.p3.7.m7.1.1.1.1.1.2.1.1.1.cmml" xref="S3.SS2.p3.7.m7.1.1.1.1.1.2.1">subscript</csymbol><ci id="S3.SS2.p3.7.m7.1.1.1.1.1.2.1.1.2.cmml" xref="S3.SS2.p3.7.m7.1.1.1.1.1.2.1.1.2">𝑣</ci><ci id="S3.SS2.p3.7.m7.1.1.1.1.1.2.1.1.3.cmml" xref="S3.SS2.p3.7.m7.1.1.1.1.1.2.1.1.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.7.m7.1c">\mathrm{vec}\left(\phi(\mathbf{q}_{i})\otimes\phi_{\mathcal{G}}(v_{i})\right)</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.7.m7.1d">roman_vec ( italic_ϕ ( bold_q start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) ⊗ italic_ϕ start_POSTSUBSCRIPT caligraphic_G end_POSTSUBSCRIPT ( italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) )</annotation></semantics></math> is an <math alttext="mN" class="ltx_Math" display="inline" id="S3.SS2.p3.8.m8.1"><semantics id="S3.SS2.p3.8.m8.1a"><mrow id="S3.SS2.p3.8.m8.1.1" xref="S3.SS2.p3.8.m8.1.1.cmml"><mi id="S3.SS2.p3.8.m8.1.1.2" xref="S3.SS2.p3.8.m8.1.1.2.cmml">m</mi><mo id="S3.SS2.p3.8.m8.1.1.1" xref="S3.SS2.p3.8.m8.1.1.1.cmml">⁢</mo><mi id="S3.SS2.p3.8.m8.1.1.3" xref="S3.SS2.p3.8.m8.1.1.3.cmml">N</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.8.m8.1b"><apply id="S3.SS2.p3.8.m8.1.1.cmml" xref="S3.SS2.p3.8.m8.1.1"><times id="S3.SS2.p3.8.m8.1.1.1.cmml" xref="S3.SS2.p3.8.m8.1.1.1"></times><ci id="S3.SS2.p3.8.m8.1.1.2.cmml" xref="S3.SS2.p3.8.m8.1.1.2">𝑚</ci><ci id="S3.SS2.p3.8.m8.1.1.3.cmml" xref="S3.SS2.p3.8.m8.1.1.3">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.8.m8.1c">mN</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.8.m8.1d">italic_m italic_N</annotation></semantics></math>-dimensional vector whose <math alttext="(N(j-1)+k)" class="ltx_Math" display="inline" id="S3.SS2.p3.9.m9.1"><semantics id="S3.SS2.p3.9.m9.1a"><mrow id="S3.SS2.p3.9.m9.1.1.1" xref="S3.SS2.p3.9.m9.1.1.1.1.cmml"><mo id="S3.SS2.p3.9.m9.1.1.1.2" stretchy="false" xref="S3.SS2.p3.9.m9.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.p3.9.m9.1.1.1.1" xref="S3.SS2.p3.9.m9.1.1.1.1.cmml"><mrow id="S3.SS2.p3.9.m9.1.1.1.1.1" xref="S3.SS2.p3.9.m9.1.1.1.1.1.cmml"><mi id="S3.SS2.p3.9.m9.1.1.1.1.1.3" xref="S3.SS2.p3.9.m9.1.1.1.1.1.3.cmml">N</mi><mo id="S3.SS2.p3.9.m9.1.1.1.1.1.2" xref="S3.SS2.p3.9.m9.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.SS2.p3.9.m9.1.1.1.1.1.1.1" xref="S3.SS2.p3.9.m9.1.1.1.1.1.1.1.1.cmml"><mo id="S3.SS2.p3.9.m9.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.SS2.p3.9.m9.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.p3.9.m9.1.1.1.1.1.1.1.1" xref="S3.SS2.p3.9.m9.1.1.1.1.1.1.1.1.cmml"><mi id="S3.SS2.p3.9.m9.1.1.1.1.1.1.1.1.2" xref="S3.SS2.p3.9.m9.1.1.1.1.1.1.1.1.2.cmml">j</mi><mo id="S3.SS2.p3.9.m9.1.1.1.1.1.1.1.1.1" xref="S3.SS2.p3.9.m9.1.1.1.1.1.1.1.1.1.cmml">−</mo><mn id="S3.SS2.p3.9.m9.1.1.1.1.1.1.1.1.3" xref="S3.SS2.p3.9.m9.1.1.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S3.SS2.p3.9.m9.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.SS2.p3.9.m9.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS2.p3.9.m9.1.1.1.1.2" xref="S3.SS2.p3.9.m9.1.1.1.1.2.cmml">+</mo><mi id="S3.SS2.p3.9.m9.1.1.1.1.3" xref="S3.SS2.p3.9.m9.1.1.1.1.3.cmml">k</mi></mrow><mo id="S3.SS2.p3.9.m9.1.1.1.3" stretchy="false" xref="S3.SS2.p3.9.m9.1.1.1.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.9.m9.1b"><apply id="S3.SS2.p3.9.m9.1.1.1.1.cmml" xref="S3.SS2.p3.9.m9.1.1.1"><plus id="S3.SS2.p3.9.m9.1.1.1.1.2.cmml" xref="S3.SS2.p3.9.m9.1.1.1.1.2"></plus><apply id="S3.SS2.p3.9.m9.1.1.1.1.1.cmml" xref="S3.SS2.p3.9.m9.1.1.1.1.1"><times id="S3.SS2.p3.9.m9.1.1.1.1.1.2.cmml" xref="S3.SS2.p3.9.m9.1.1.1.1.1.2"></times><ci id="S3.SS2.p3.9.m9.1.1.1.1.1.3.cmml" xref="S3.SS2.p3.9.m9.1.1.1.1.1.3">𝑁</ci><apply id="S3.SS2.p3.9.m9.1.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p3.9.m9.1.1.1.1.1.1.1"><minus id="S3.SS2.p3.9.m9.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p3.9.m9.1.1.1.1.1.1.1.1.1"></minus><ci id="S3.SS2.p3.9.m9.1.1.1.1.1.1.1.1.2.cmml" xref="S3.SS2.p3.9.m9.1.1.1.1.1.1.1.1.2">𝑗</ci><cn id="S3.SS2.p3.9.m9.1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S3.SS2.p3.9.m9.1.1.1.1.1.1.1.1.3">1</cn></apply></apply><ci id="S3.SS2.p3.9.m9.1.1.1.1.3.cmml" xref="S3.SS2.p3.9.m9.1.1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.9.m9.1c">(N(j-1)+k)</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.9.m9.1d">( italic_N ( italic_j - 1 ) + italic_k )</annotation></semantics></math>th entry is <math alttext="\phi(\mathbf{q}_{i})_{j}\phi_{\mathcal{G}}(v_{i})_{k}" class="ltx_Math" display="inline" id="S3.SS2.p3.10.m10.2"><semantics id="S3.SS2.p3.10.m10.2a"><mrow id="S3.SS2.p3.10.m10.2.2" xref="S3.SS2.p3.10.m10.2.2.cmml"><mi id="S3.SS2.p3.10.m10.2.2.4" xref="S3.SS2.p3.10.m10.2.2.4.cmml">ϕ</mi><mo id="S3.SS2.p3.10.m10.2.2.3" xref="S3.SS2.p3.10.m10.2.2.3.cmml">⁢</mo><msub id="S3.SS2.p3.10.m10.1.1.1" xref="S3.SS2.p3.10.m10.1.1.1.cmml"><mrow id="S3.SS2.p3.10.m10.1.1.1.1.1" xref="S3.SS2.p3.10.m10.1.1.1.1.1.1.cmml"><mo id="S3.SS2.p3.10.m10.1.1.1.1.1.2" stretchy="false" xref="S3.SS2.p3.10.m10.1.1.1.1.1.1.cmml">(</mo><msub id="S3.SS2.p3.10.m10.1.1.1.1.1.1" xref="S3.SS2.p3.10.m10.1.1.1.1.1.1.cmml"><mi id="S3.SS2.p3.10.m10.1.1.1.1.1.1.2" xref="S3.SS2.p3.10.m10.1.1.1.1.1.1.2.cmml">𝐪</mi><mi id="S3.SS2.p3.10.m10.1.1.1.1.1.1.3" xref="S3.SS2.p3.10.m10.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS2.p3.10.m10.1.1.1.1.1.3" stretchy="false" xref="S3.SS2.p3.10.m10.1.1.1.1.1.1.cmml">)</mo></mrow><mi id="S3.SS2.p3.10.m10.1.1.1.3" xref="S3.SS2.p3.10.m10.1.1.1.3.cmml">j</mi></msub><mo id="S3.SS2.p3.10.m10.2.2.3a" xref="S3.SS2.p3.10.m10.2.2.3.cmml">⁢</mo><msub id="S3.SS2.p3.10.m10.2.2.5" xref="S3.SS2.p3.10.m10.2.2.5.cmml"><mi id="S3.SS2.p3.10.m10.2.2.5.2" xref="S3.SS2.p3.10.m10.2.2.5.2.cmml">ϕ</mi><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p3.10.m10.2.2.5.3" xref="S3.SS2.p3.10.m10.2.2.5.3.cmml">𝒢</mi></msub><mo id="S3.SS2.p3.10.m10.2.2.3b" xref="S3.SS2.p3.10.m10.2.2.3.cmml">⁢</mo><msub id="S3.SS2.p3.10.m10.2.2.2" xref="S3.SS2.p3.10.m10.2.2.2.cmml"><mrow id="S3.SS2.p3.10.m10.2.2.2.1.1" xref="S3.SS2.p3.10.m10.2.2.2.1.1.1.cmml"><mo id="S3.SS2.p3.10.m10.2.2.2.1.1.2" stretchy="false" xref="S3.SS2.p3.10.m10.2.2.2.1.1.1.cmml">(</mo><msub id="S3.SS2.p3.10.m10.2.2.2.1.1.1" xref="S3.SS2.p3.10.m10.2.2.2.1.1.1.cmml"><mi id="S3.SS2.p3.10.m10.2.2.2.1.1.1.2" xref="S3.SS2.p3.10.m10.2.2.2.1.1.1.2.cmml">v</mi><mi id="S3.SS2.p3.10.m10.2.2.2.1.1.1.3" xref="S3.SS2.p3.10.m10.2.2.2.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS2.p3.10.m10.2.2.2.1.1.3" stretchy="false" xref="S3.SS2.p3.10.m10.2.2.2.1.1.1.cmml">)</mo></mrow><mi id="S3.SS2.p3.10.m10.2.2.2.3" xref="S3.SS2.p3.10.m10.2.2.2.3.cmml">k</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.10.m10.2b"><apply id="S3.SS2.p3.10.m10.2.2.cmml" xref="S3.SS2.p3.10.m10.2.2"><times id="S3.SS2.p3.10.m10.2.2.3.cmml" xref="S3.SS2.p3.10.m10.2.2.3"></times><ci id="S3.SS2.p3.10.m10.2.2.4.cmml" xref="S3.SS2.p3.10.m10.2.2.4">italic-ϕ</ci><apply id="S3.SS2.p3.10.m10.1.1.1.cmml" xref="S3.SS2.p3.10.m10.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.10.m10.1.1.1.2.cmml" xref="S3.SS2.p3.10.m10.1.1.1">subscript</csymbol><apply id="S3.SS2.p3.10.m10.1.1.1.1.1.1.cmml" xref="S3.SS2.p3.10.m10.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.10.m10.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p3.10.m10.1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.p3.10.m10.1.1.1.1.1.1.2.cmml" xref="S3.SS2.p3.10.m10.1.1.1.1.1.1.2">𝐪</ci><ci id="S3.SS2.p3.10.m10.1.1.1.1.1.1.3.cmml" xref="S3.SS2.p3.10.m10.1.1.1.1.1.1.3">𝑖</ci></apply><ci id="S3.SS2.p3.10.m10.1.1.1.3.cmml" xref="S3.SS2.p3.10.m10.1.1.1.3">𝑗</ci></apply><apply id="S3.SS2.p3.10.m10.2.2.5.cmml" xref="S3.SS2.p3.10.m10.2.2.5"><csymbol cd="ambiguous" id="S3.SS2.p3.10.m10.2.2.5.1.cmml" xref="S3.SS2.p3.10.m10.2.2.5">subscript</csymbol><ci id="S3.SS2.p3.10.m10.2.2.5.2.cmml" xref="S3.SS2.p3.10.m10.2.2.5.2">italic-ϕ</ci><ci id="S3.SS2.p3.10.m10.2.2.5.3.cmml" xref="S3.SS2.p3.10.m10.2.2.5.3">𝒢</ci></apply><apply id="S3.SS2.p3.10.m10.2.2.2.cmml" xref="S3.SS2.p3.10.m10.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p3.10.m10.2.2.2.2.cmml" xref="S3.SS2.p3.10.m10.2.2.2">subscript</csymbol><apply id="S3.SS2.p3.10.m10.2.2.2.1.1.1.cmml" xref="S3.SS2.p3.10.m10.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.10.m10.2.2.2.1.1.1.1.cmml" xref="S3.SS2.p3.10.m10.2.2.2.1.1">subscript</csymbol><ci id="S3.SS2.p3.10.m10.2.2.2.1.1.1.2.cmml" xref="S3.SS2.p3.10.m10.2.2.2.1.1.1.2">𝑣</ci><ci id="S3.SS2.p3.10.m10.2.2.2.1.1.1.3.cmml" xref="S3.SS2.p3.10.m10.2.2.2.1.1.1.3">𝑖</ci></apply><ci id="S3.SS2.p3.10.m10.2.2.2.3.cmml" xref="S3.SS2.p3.10.m10.2.2.2.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.10.m10.2c">\phi(\mathbf{q}_{i})_{j}\phi_{\mathcal{G}}(v_{i})_{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.10.m10.2d">italic_ϕ ( bold_q start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT italic_ϕ start_POSTSUBSCRIPT caligraphic_G end_POSTSUBSCRIPT ( italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math>.
Observe the following:<span class="ltx_note ltx_role_footnote" id="footnote1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>Recall the old adage: the dot product of outer products is the product of dot products.</span></span></span></p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equation ltx_eqn_table" id="S3.E5">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\begin{multlined}\mathrm{vec}\left(\phi(\mathbf{q}_{i})\otimes\phi_{\mathcal{G%
}}(v_{i})\right)^{\top}\mathrm{vec}\left(\phi(\mathbf{k}_{j})\otimes\phi_{%
\mathcal{G}}(v_{j})\right)=\sum_{s=1}^{mN}\mathrm{vec}\left(\phi(\mathbf{q}_{i%
})\otimes\phi_{\mathcal{G}}(v_{i})\right)_{s}\mathrm{vec}\left(\phi(\mathbf{k}%
_{j})\otimes\phi_{\mathcal{G}}(v_{j})\right)_{s}\vspace{-3mm}\\
=\sum_{k=1}^{m}\sum_{l=1}^{N}\phi(\mathbf{q}_{i})_{k}\phi_{\mathcal{G}}(v_{i})%
_{l}\phi(\mathbf{k}_{j})_{k}\phi_{\mathcal{G}}(v_{j})_{l}=\left(\phi(\mathbf{q%
}_{i})^{\top}\phi(\mathbf{k}_{j})\right)\left(\phi_{\mathcal{G}}(v_{i})^{\top}%
\phi_{\mathcal{G}}(v_{j})\right)={\mathcal{K}_{\textrm{LR}}}_{ij}{\mathbf{M}_{%
\alpha}}_{ij}.\end{multlined}\mathrm{vec}\left(\phi(\mathbf{q}_{i})\otimes\phi%
_{\mathcal{G}}(v_{i})\right)^{\top}\mathrm{vec}\left(\phi(\mathbf{k}_{j})%
\otimes\phi_{\mathcal{G}}(v_{j})\right)=\sum_{s=1}^{mN}\mathrm{vec}\left(\phi(%
\mathbf{q}_{i})\otimes\phi_{\mathcal{G}}(v_{i})\right)_{s}\mathrm{vec}\left(%
\phi(\mathbf{k}_{j})\otimes\phi_{\mathcal{G}}(v_{j})\right)_{s}\vspace{-3mm}\\
=\sum_{k=1}^{m}\sum_{l=1}^{N}\phi(\mathbf{q}_{i})_{k}\phi_{\mathcal{G}}(v_{i})%
_{l}\phi(\mathbf{k}_{j})_{k}\phi_{\mathcal{G}}(v_{j})_{l}=\left(\phi(\mathbf{q%
}_{i})^{\top}\phi(\mathbf{k}_{j})\right)\left(\phi_{\mathcal{G}}(v_{i})^{\top}%
\phi_{\mathcal{G}}(v_{j})\right)={\mathcal{K}_{\textrm{LR}}}_{ij}{\mathbf{M}_{%
\alpha}}_{ij}." class="ltx_Math" display="block" id="S3.E5.m1.143"><semantics id="S3.E5.m1.143a"><mtable displaystyle="true" id="S3.E5.m1.143.143.6" rowspacing="0pt"><mtr id="S3.E5.m1.143.143.6a"><mtd class="ltx_align_left" columnalign="left" id="S3.E5.m1.143.143.6b"><mrow id="S3.E5.m1.142.142.5.141.71.71"><mrow id="S3.E5.m1.140.140.3.139.69.69.69"><mi id="S3.E5.m1.1.1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.1.1.cmml">vec</mi><mo id="S3.E5.m1.140.140.3.139.69.69.69.3" xref="S3.E5.m1.138.138.1.1.1.cmml">⁢</mo><msup id="S3.E5.m1.139.139.2.138.68.68.68.1"><mrow id="S3.E5.m1.139.139.2.138.68.68.68.1.1.1"><mo id="S3.E5.m1.2.2.2.2.2.2" xref="S3.E5.m1.138.138.1.1.1.cmml">(</mo><mrow id="S3.E5.m1.139.139.2.138.68.68.68.1.1.1.1"><mrow id="S3.E5.m1.139.139.2.138.68.68.68.1.1.1.1.1"><mrow id="S3.E5.m1.139.139.2.138.68.68.68.1.1.1.1.1.1"><mi id="S3.E5.m1.3.3.3.3.3.3" xref="S3.E5.m1.3.3.3.3.3.3.cmml">ϕ</mi><mo id="S3.E5.m1.139.139.2.138.68.68.68.1.1.1.1.1.1.2" xref="S3.E5.m1.138.138.1.1.1.cmml">⁢</mo><mrow id="S3.E5.m1.139.139.2.138.68.68.68.1.1.1.1.1.1.1.1"><mo id="S3.E5.m1.4.4.4.4.4.4" stretchy="false" xref="S3.E5.m1.138.138.1.1.1.cmml">(</mo><msub id="S3.E5.m1.139.139.2.138.68.68.68.1.1.1.1.1.1.1.1.1"><mi id="S3.E5.m1.5.5.5.5.5.5" xref="S3.E5.m1.5.5.5.5.5.5.cmml">𝐪</mi><mi id="S3.E5.m1.6.6.6.6.6.6.1" xref="S3.E5.m1.6.6.6.6.6.6.1.cmml">i</mi></msub><mo id="S3.E5.m1.7.7.7.7.7.7" rspace="0.055em" stretchy="false" xref="S3.E5.m1.138.138.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E5.m1.8.8.8.8.8.8" rspace="0.222em" xref="S3.E5.m1.8.8.8.8.8.8.cmml">⊗</mo><msub id="S3.E5.m1.139.139.2.138.68.68.68.1.1.1.1.1.2"><mi id="S3.E5.m1.9.9.9.9.9.9" xref="S3.E5.m1.9.9.9.9.9.9.cmml">ϕ</mi><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.10.10.10.10.10.10.1" xref="S3.E5.m1.10.10.10.10.10.10.1.cmml">𝒢</mi></msub></mrow><mo id="S3.E5.m1.139.139.2.138.68.68.68.1.1.1.1.3" xref="S3.E5.m1.138.138.1.1.1.cmml">⁢</mo><mrow id="S3.E5.m1.139.139.2.138.68.68.68.1.1.1.1.2.1"><mo id="S3.E5.m1.11.11.11.11.11.11" stretchy="false" xref="S3.E5.m1.138.138.1.1.1.cmml">(</mo><msub id="S3.E5.m1.139.139.2.138.68.68.68.1.1.1.1.2.1.1"><mi id="S3.E5.m1.12.12.12.12.12.12" xref="S3.E5.m1.12.12.12.12.12.12.cmml">v</mi><mi id="S3.E5.m1.13.13.13.13.13.13.1" xref="S3.E5.m1.13.13.13.13.13.13.1.cmml">i</mi></msub><mo id="S3.E5.m1.14.14.14.14.14.14" stretchy="false" xref="S3.E5.m1.138.138.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E5.m1.15.15.15.15.15.15" xref="S3.E5.m1.138.138.1.1.1.cmml">)</mo></mrow><mo id="S3.E5.m1.16.16.16.16.16.16.1" xref="S3.E5.m1.16.16.16.16.16.16.1.cmml">⊤</mo></msup><mo id="S3.E5.m1.140.140.3.139.69.69.69.3a" xref="S3.E5.m1.138.138.1.1.1.cmml">⁢</mo><mi id="S3.E5.m1.17.17.17.17.17.17" xref="S3.E5.m1.17.17.17.17.17.17.cmml">vec</mi><mo id="S3.E5.m1.140.140.3.139.69.69.69.3b" xref="S3.E5.m1.138.138.1.1.1.cmml">⁢</mo><mrow id="S3.E5.m1.140.140.3.139.69.69.69.2.1"><mo id="S3.E5.m1.18.18.18.18.18.18" xref="S3.E5.m1.138.138.1.1.1.cmml">(</mo><mrow id="S3.E5.m1.140.140.3.139.69.69.69.2.1.1"><mrow id="S3.E5.m1.140.140.3.139.69.69.69.2.1.1.1"><mrow id="S3.E5.m1.140.140.3.139.69.69.69.2.1.1.1.1"><mi id="S3.E5.m1.19.19.19.19.19.19" xref="S3.E5.m1.19.19.19.19.19.19.cmml">ϕ</mi><mo id="S3.E5.m1.140.140.3.139.69.69.69.2.1.1.1.1.2" xref="S3.E5.m1.138.138.1.1.1.cmml">⁢</mo><mrow id="S3.E5.m1.140.140.3.139.69.69.69.2.1.1.1.1.1.1"><mo id="S3.E5.m1.20.20.20.20.20.20" stretchy="false" xref="S3.E5.m1.138.138.1.1.1.cmml">(</mo><msub id="S3.E5.m1.140.140.3.139.69.69.69.2.1.1.1.1.1.1.1"><mi id="S3.E5.m1.21.21.21.21.21.21" xref="S3.E5.m1.21.21.21.21.21.21.cmml">𝐤</mi><mi id="S3.E5.m1.22.22.22.22.22.22.1" xref="S3.E5.m1.22.22.22.22.22.22.1.cmml">j</mi></msub><mo id="S3.E5.m1.23.23.23.23.23.23" rspace="0.055em" stretchy="false" xref="S3.E5.m1.138.138.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E5.m1.24.24.24.24.24.24" rspace="0.222em" xref="S3.E5.m1.24.24.24.24.24.24.cmml">⊗</mo><msub id="S3.E5.m1.140.140.3.139.69.69.69.2.1.1.1.2"><mi id="S3.E5.m1.25.25.25.25.25.25" xref="S3.E5.m1.25.25.25.25.25.25.cmml">ϕ</mi><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.26.26.26.26.26.26.1" xref="S3.E5.m1.26.26.26.26.26.26.1.cmml">𝒢</mi></msub></mrow><mo id="S3.E5.m1.140.140.3.139.69.69.69.2.1.1.3" xref="S3.E5.m1.138.138.1.1.1.cmml">⁢</mo><mrow id="S3.E5.m1.140.140.3.139.69.69.69.2.1.1.2.1"><mo id="S3.E5.m1.27.27.27.27.27.27" stretchy="false" xref="S3.E5.m1.138.138.1.1.1.cmml">(</mo><msub id="S3.E5.m1.140.140.3.139.69.69.69.2.1.1.2.1.1"><mi id="S3.E5.m1.28.28.28.28.28.28" xref="S3.E5.m1.28.28.28.28.28.28.cmml">v</mi><mi id="S3.E5.m1.29.29.29.29.29.29.1" xref="S3.E5.m1.29.29.29.29.29.29.1.cmml">j</mi></msub><mo id="S3.E5.m1.30.30.30.30.30.30" stretchy="false" xref="S3.E5.m1.138.138.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E5.m1.31.31.31.31.31.31" xref="S3.E5.m1.138.138.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E5.m1.32.32.32.32.32.32" rspace="0.111em" xref="S3.E5.m1.32.32.32.32.32.32.cmml">=</mo><mrow id="S3.E5.m1.142.142.5.141.71.71.71"><munderover id="S3.E5.m1.142.142.5.141.71.71.71.3"><mo id="S3.E5.m1.33.33.33.33.33.33" movablelimits="false" xref="S3.E5.m1.33.33.33.33.33.33.cmml">∑</mo><mrow id="S3.E5.m1.34.34.34.34.34.34.1" xref="S3.E5.m1.34.34.34.34.34.34.1.cmml"><mi id="S3.E5.m1.34.34.34.34.34.34.1.2" xref="S3.E5.m1.34.34.34.34.34.34.1.2.cmml">s</mi><mo id="S3.E5.m1.34.34.34.34.34.34.1.1" xref="S3.E5.m1.34.34.34.34.34.34.1.1.cmml">=</mo><mn id="S3.E5.m1.34.34.34.34.34.34.1.3" xref="S3.E5.m1.34.34.34.34.34.34.1.3.cmml">1</mn></mrow><mrow id="S3.E5.m1.35.35.35.35.35.35.1" xref="S3.E5.m1.35.35.35.35.35.35.1.cmml"><mi id="S3.E5.m1.35.35.35.35.35.35.1.2" xref="S3.E5.m1.35.35.35.35.35.35.1.2.cmml">m</mi><mo id="S3.E5.m1.35.35.35.35.35.35.1.1" xref="S3.E5.m1.35.35.35.35.35.35.1.1.cmml">⁢</mo><mi id="S3.E5.m1.35.35.35.35.35.35.1.3" xref="S3.E5.m1.35.35.35.35.35.35.1.3.cmml">N</mi></mrow></munderover><mrow id="S3.E5.m1.142.142.5.141.71.71.71.2"><mi id="S3.E5.m1.36.36.36.36.36.36" xref="S3.E5.m1.36.36.36.36.36.36.cmml">vec</mi><mo id="S3.E5.m1.142.142.5.141.71.71.71.2.3" xref="S3.E5.m1.138.138.1.1.1.cmml">⁢</mo><msub id="S3.E5.m1.141.141.4.140.70.70.70.1.1"><mrow id="S3.E5.m1.141.141.4.140.70.70.70.1.1.1.1"><mo id="S3.E5.m1.37.37.37.37.37.37" xref="S3.E5.m1.138.138.1.1.1.cmml">(</mo><mrow id="S3.E5.m1.141.141.4.140.70.70.70.1.1.1.1.1"><mrow id="S3.E5.m1.141.141.4.140.70.70.70.1.1.1.1.1.1"><mrow id="S3.E5.m1.141.141.4.140.70.70.70.1.1.1.1.1.1.1"><mi id="S3.E5.m1.38.38.38.38.38.38" xref="S3.E5.m1.38.38.38.38.38.38.cmml">ϕ</mi><mo id="S3.E5.m1.141.141.4.140.70.70.70.1.1.1.1.1.1.1.2" xref="S3.E5.m1.138.138.1.1.1.cmml">⁢</mo><mrow id="S3.E5.m1.141.141.4.140.70.70.70.1.1.1.1.1.1.1.1.1"><mo id="S3.E5.m1.39.39.39.39.39.39" stretchy="false" xref="S3.E5.m1.138.138.1.1.1.cmml">(</mo><msub id="S3.E5.m1.141.141.4.140.70.70.70.1.1.1.1.1.1.1.1.1.1"><mi id="S3.E5.m1.40.40.40.40.40.40" xref="S3.E5.m1.40.40.40.40.40.40.cmml">𝐪</mi><mi id="S3.E5.m1.41.41.41.41.41.41.1" xref="S3.E5.m1.41.41.41.41.41.41.1.cmml">i</mi></msub><mo id="S3.E5.m1.42.42.42.42.42.42" rspace="0.055em" stretchy="false" xref="S3.E5.m1.138.138.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E5.m1.43.43.43.43.43.43" rspace="0.222em" xref="S3.E5.m1.43.43.43.43.43.43.cmml">⊗</mo><msub id="S3.E5.m1.141.141.4.140.70.70.70.1.1.1.1.1.1.2"><mi id="S3.E5.m1.44.44.44.44.44.44" xref="S3.E5.m1.44.44.44.44.44.44.cmml">ϕ</mi><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.45.45.45.45.45.45.1" xref="S3.E5.m1.45.45.45.45.45.45.1.cmml">𝒢</mi></msub></mrow><mo id="S3.E5.m1.141.141.4.140.70.70.70.1.1.1.1.1.3" xref="S3.E5.m1.138.138.1.1.1.cmml">⁢</mo><mrow id="S3.E5.m1.141.141.4.140.70.70.70.1.1.1.1.1.2.1"><mo id="S3.E5.m1.46.46.46.46.46.46" stretchy="false" xref="S3.E5.m1.138.138.1.1.1.cmml">(</mo><msub id="S3.E5.m1.141.141.4.140.70.70.70.1.1.1.1.1.2.1.1"><mi id="S3.E5.m1.47.47.47.47.47.47" xref="S3.E5.m1.47.47.47.47.47.47.cmml">v</mi><mi id="S3.E5.m1.48.48.48.48.48.48.1" xref="S3.E5.m1.48.48.48.48.48.48.1.cmml">i</mi></msub><mo id="S3.E5.m1.49.49.49.49.49.49" stretchy="false" xref="S3.E5.m1.138.138.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E5.m1.50.50.50.50.50.50" xref="S3.E5.m1.138.138.1.1.1.cmml">)</mo></mrow><mi id="S3.E5.m1.51.51.51.51.51.51.1" xref="S3.E5.m1.51.51.51.51.51.51.1.cmml">s</mi></msub><mo id="S3.E5.m1.142.142.5.141.71.71.71.2.3a" xref="S3.E5.m1.138.138.1.1.1.cmml">⁢</mo><mi id="S3.E5.m1.52.52.52.52.52.52" xref="S3.E5.m1.52.52.52.52.52.52.cmml">vec</mi><mo id="S3.E5.m1.142.142.5.141.71.71.71.2.3b" xref="S3.E5.m1.138.138.1.1.1.cmml">⁢</mo><msub id="S3.E5.m1.142.142.5.141.71.71.71.2.2"><mrow id="S3.E5.m1.142.142.5.141.71.71.71.2.2.1.1"><mo id="S3.E5.m1.53.53.53.53.53.53" xref="S3.E5.m1.138.138.1.1.1.cmml">(</mo><mrow id="S3.E5.m1.142.142.5.141.71.71.71.2.2.1.1.1"><mrow id="S3.E5.m1.142.142.5.141.71.71.71.2.2.1.1.1.1"><mrow id="S3.E5.m1.142.142.5.141.71.71.71.2.2.1.1.1.1.1"><mi id="S3.E5.m1.54.54.54.54.54.54" xref="S3.E5.m1.54.54.54.54.54.54.cmml">ϕ</mi><mo id="S3.E5.m1.142.142.5.141.71.71.71.2.2.1.1.1.1.1.2" xref="S3.E5.m1.138.138.1.1.1.cmml">⁢</mo><mrow id="S3.E5.m1.142.142.5.141.71.71.71.2.2.1.1.1.1.1.1.1"><mo id="S3.E5.m1.55.55.55.55.55.55" stretchy="false" xref="S3.E5.m1.138.138.1.1.1.cmml">(</mo><msub id="S3.E5.m1.142.142.5.141.71.71.71.2.2.1.1.1.1.1.1.1.1"><mi id="S3.E5.m1.56.56.56.56.56.56" xref="S3.E5.m1.56.56.56.56.56.56.cmml">𝐤</mi><mi id="S3.E5.m1.57.57.57.57.57.57.1" xref="S3.E5.m1.57.57.57.57.57.57.1.cmml">j</mi></msub><mo id="S3.E5.m1.58.58.58.58.58.58" rspace="0.055em" stretchy="false" xref="S3.E5.m1.138.138.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E5.m1.59.59.59.59.59.59" rspace="0.222em" xref="S3.E5.m1.59.59.59.59.59.59.cmml">⊗</mo><msub id="S3.E5.m1.142.142.5.141.71.71.71.2.2.1.1.1.1.2"><mi id="S3.E5.m1.60.60.60.60.60.60" xref="S3.E5.m1.60.60.60.60.60.60.cmml">ϕ</mi><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.61.61.61.61.61.61.1" xref="S3.E5.m1.61.61.61.61.61.61.1.cmml">𝒢</mi></msub></mrow><mo id="S3.E5.m1.142.142.5.141.71.71.71.2.2.1.1.1.3" xref="S3.E5.m1.138.138.1.1.1.cmml">⁢</mo><mrow id="S3.E5.m1.142.142.5.141.71.71.71.2.2.1.1.1.2.1"><mo id="S3.E5.m1.62.62.62.62.62.62" stretchy="false" xref="S3.E5.m1.138.138.1.1.1.cmml">(</mo><msub id="S3.E5.m1.142.142.5.141.71.71.71.2.2.1.1.1.2.1.1"><mi id="S3.E5.m1.63.63.63.63.63.63" xref="S3.E5.m1.63.63.63.63.63.63.cmml">v</mi><mi id="S3.E5.m1.64.64.64.64.64.64.1" xref="S3.E5.m1.64.64.64.64.64.64.1.cmml">j</mi></msub><mo id="S3.E5.m1.65.65.65.65.65.65" stretchy="false" xref="S3.E5.m1.138.138.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E5.m1.66.66.66.66.66.66" xref="S3.E5.m1.138.138.1.1.1.cmml">)</mo></mrow><mi id="S3.E5.m1.67.67.67.67.67.67.1" xref="S3.E5.m1.67.67.67.67.67.67.1.cmml">s</mi></msub></mrow></mrow></mrow></mtd></mtr><mtr id="S3.E5.m1.143.143.6c"><mtd class="ltx_align_right" columnalign="right" id="S3.E5.m1.143.143.6d"><mrow id="S3.E5.m1.143.143.6.142.71.71.71"><mrow id="S3.E5.m1.143.143.6.142.71.71.71.1"><mi id="S3.E5.m1.143.143.6.142.71.71.71.1.8" xref="S3.E5.m1.138.138.1.1.1.cmml"></mi><mo id="S3.E5.m1.68.68.68.1.1.1" rspace="0.111em" xref="S3.E5.m1.68.68.68.1.1.1.cmml">=</mo><mrow id="S3.E5.m1.143.143.6.142.71.71.71.1.4"><munderover id="S3.E5.m1.143.143.6.142.71.71.71.1.4.5"><mo id="S3.E5.m1.69.69.69.2.2.2" movablelimits="false" rspace="0em" xref="S3.E5.m1.69.69.69.2.2.2.cmml">∑</mo><mrow id="S3.E5.m1.70.70.70.3.3.3.1" xref="S3.E5.m1.70.70.70.3.3.3.1.cmml"><mi id="S3.E5.m1.70.70.70.3.3.3.1.2" xref="S3.E5.m1.70.70.70.3.3.3.1.2.cmml">k</mi><mo id="S3.E5.m1.70.70.70.3.3.3.1.1" xref="S3.E5.m1.70.70.70.3.3.3.1.1.cmml">=</mo><mn id="S3.E5.m1.70.70.70.3.3.3.1.3" xref="S3.E5.m1.70.70.70.3.3.3.1.3.cmml">1</mn></mrow><mi id="S3.E5.m1.71.71.71.4.4.4.1" xref="S3.E5.m1.71.71.71.4.4.4.1.cmml">m</mi></munderover><mrow id="S3.E5.m1.143.143.6.142.71.71.71.1.4.4"><munderover id="S3.E5.m1.143.143.6.142.71.71.71.1.4.4.5"><mo id="S3.E5.m1.72.72.72.5.5.5" movablelimits="false" xref="S3.E5.m1.72.72.72.5.5.5.cmml">∑</mo><mrow id="S3.E5.m1.73.73.73.6.6.6.1" xref="S3.E5.m1.73.73.73.6.6.6.1.cmml"><mi id="S3.E5.m1.73.73.73.6.6.6.1.2" xref="S3.E5.m1.73.73.73.6.6.6.1.2.cmml">l</mi><mo id="S3.E5.m1.73.73.73.6.6.6.1.1" xref="S3.E5.m1.73.73.73.6.6.6.1.1.cmml">=</mo><mn id="S3.E5.m1.73.73.73.6.6.6.1.3" xref="S3.E5.m1.73.73.73.6.6.6.1.3.cmml">1</mn></mrow><mi id="S3.E5.m1.74.74.74.7.7.7.1" xref="S3.E5.m1.74.74.74.7.7.7.1.cmml">N</mi></munderover><mrow id="S3.E5.m1.143.143.6.142.71.71.71.1.4.4.4"><mi id="S3.E5.m1.75.75.75.8.8.8" xref="S3.E5.m1.75.75.75.8.8.8.cmml">ϕ</mi><mo id="S3.E5.m1.143.143.6.142.71.71.71.1.4.4.4.5" xref="S3.E5.m1.138.138.1.1.1.cmml">⁢</mo><msub id="S3.E5.m1.143.143.6.142.71.71.71.1.1.1.1.1"><mrow id="S3.E5.m1.143.143.6.142.71.71.71.1.1.1.1.1.1.1"><mo id="S3.E5.m1.76.76.76.9.9.9" stretchy="false" xref="S3.E5.m1.138.138.1.1.1.cmml">(</mo><msub id="S3.E5.m1.143.143.6.142.71.71.71.1.1.1.1.1.1.1.1"><mi id="S3.E5.m1.77.77.77.10.10.10" xref="S3.E5.m1.77.77.77.10.10.10.cmml">𝐪</mi><mi id="S3.E5.m1.78.78.78.11.11.11.1" xref="S3.E5.m1.78.78.78.11.11.11.1.cmml">i</mi></msub><mo id="S3.E5.m1.79.79.79.12.12.12" stretchy="false" xref="S3.E5.m1.138.138.1.1.1.cmml">)</mo></mrow><mi id="S3.E5.m1.80.80.80.13.13.13.1" xref="S3.E5.m1.80.80.80.13.13.13.1.cmml">k</mi></msub><mo id="S3.E5.m1.143.143.6.142.71.71.71.1.4.4.4.5a" xref="S3.E5.m1.138.138.1.1.1.cmml">⁢</mo><msub id="S3.E5.m1.143.143.6.142.71.71.71.1.4.4.4.6"><mi id="S3.E5.m1.81.81.81.14.14.14" xref="S3.E5.m1.81.81.81.14.14.14.cmml">ϕ</mi><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.82.82.82.15.15.15.1" xref="S3.E5.m1.82.82.82.15.15.15.1.cmml">𝒢</mi></msub><mo id="S3.E5.m1.143.143.6.142.71.71.71.1.4.4.4.5b" xref="S3.E5.m1.138.138.1.1.1.cmml">⁢</mo><msub id="S3.E5.m1.143.143.6.142.71.71.71.1.2.2.2.2"><mrow id="S3.E5.m1.143.143.6.142.71.71.71.1.2.2.2.2.1.1"><mo id="S3.E5.m1.83.83.83.16.16.16" stretchy="false" xref="S3.E5.m1.138.138.1.1.1.cmml">(</mo><msub id="S3.E5.m1.143.143.6.142.71.71.71.1.2.2.2.2.1.1.1"><mi id="S3.E5.m1.84.84.84.17.17.17" xref="S3.E5.m1.84.84.84.17.17.17.cmml">v</mi><mi id="S3.E5.m1.85.85.85.18.18.18.1" xref="S3.E5.m1.85.85.85.18.18.18.1.cmml">i</mi></msub><mo id="S3.E5.m1.86.86.86.19.19.19" stretchy="false" xref="S3.E5.m1.138.138.1.1.1.cmml">)</mo></mrow><mi id="S3.E5.m1.87.87.87.20.20.20.1" xref="S3.E5.m1.87.87.87.20.20.20.1.cmml">l</mi></msub><mo id="S3.E5.m1.143.143.6.142.71.71.71.1.4.4.4.5c" xref="S3.E5.m1.138.138.1.1.1.cmml">⁢</mo><mi id="S3.E5.m1.88.88.88.21.21.21" xref="S3.E5.m1.88.88.88.21.21.21.cmml">ϕ</mi><mo id="S3.E5.m1.143.143.6.142.71.71.71.1.4.4.4.5d" xref="S3.E5.m1.138.138.1.1.1.cmml">⁢</mo><msub id="S3.E5.m1.143.143.6.142.71.71.71.1.3.3.3.3"><mrow id="S3.E5.m1.143.143.6.142.71.71.71.1.3.3.3.3.1.1"><mo id="S3.E5.m1.89.89.89.22.22.22" stretchy="false" xref="S3.E5.m1.138.138.1.1.1.cmml">(</mo><msub id="S3.E5.m1.143.143.6.142.71.71.71.1.3.3.3.3.1.1.1"><mi id="S3.E5.m1.90.90.90.23.23.23" xref="S3.E5.m1.90.90.90.23.23.23.cmml">𝐤</mi><mi id="S3.E5.m1.91.91.91.24.24.24.1" xref="S3.E5.m1.91.91.91.24.24.24.1.cmml">j</mi></msub><mo id="S3.E5.m1.92.92.92.25.25.25" stretchy="false" xref="S3.E5.m1.138.138.1.1.1.cmml">)</mo></mrow><mi id="S3.E5.m1.93.93.93.26.26.26.1" xref="S3.E5.m1.93.93.93.26.26.26.1.cmml">k</mi></msub><mo id="S3.E5.m1.143.143.6.142.71.71.71.1.4.4.4.5e" xref="S3.E5.m1.138.138.1.1.1.cmml">⁢</mo><msub id="S3.E5.m1.143.143.6.142.71.71.71.1.4.4.4.7"><mi id="S3.E5.m1.94.94.94.27.27.27" xref="S3.E5.m1.94.94.94.27.27.27.cmml">ϕ</mi><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.95.95.95.28.28.28.1" xref="S3.E5.m1.95.95.95.28.28.28.1.cmml">𝒢</mi></msub><mo id="S3.E5.m1.143.143.6.142.71.71.71.1.4.4.4.5f" xref="S3.E5.m1.138.138.1.1.1.cmml">⁢</mo><msub id="S3.E5.m1.143.143.6.142.71.71.71.1.4.4.4.4"><mrow id="S3.E5.m1.143.143.6.142.71.71.71.1.4.4.4.4.1.1"><mo id="S3.E5.m1.96.96.96.29.29.29" stretchy="false" xref="S3.E5.m1.138.138.1.1.1.cmml">(</mo><msub id="S3.E5.m1.143.143.6.142.71.71.71.1.4.4.4.4.1.1.1"><mi id="S3.E5.m1.97.97.97.30.30.30" xref="S3.E5.m1.97.97.97.30.30.30.cmml">v</mi><mi id="S3.E5.m1.98.98.98.31.31.31.1" xref="S3.E5.m1.98.98.98.31.31.31.1.cmml">j</mi></msub><mo id="S3.E5.m1.99.99.99.32.32.32" stretchy="false" xref="S3.E5.m1.138.138.1.1.1.cmml">)</mo></mrow><mi id="S3.E5.m1.100.100.100.33.33.33.1" xref="S3.E5.m1.100.100.100.33.33.33.1.cmml">l</mi></msub></mrow></mrow></mrow><mo id="S3.E5.m1.101.101.101.34.34.34" xref="S3.E5.m1.101.101.101.34.34.34.cmml">=</mo><mrow id="S3.E5.m1.143.143.6.142.71.71.71.1.6"><mrow id="S3.E5.m1.143.143.6.142.71.71.71.1.5.1.1"><mo id="S3.E5.m1.102.102.102.35.35.35" xref="S3.E5.m1.138.138.1.1.1.cmml">(</mo><mrow id="S3.E5.m1.143.143.6.142.71.71.71.1.5.1.1.1"><mi id="S3.E5.m1.103.103.103.36.36.36" xref="S3.E5.m1.103.103.103.36.36.36.cmml">ϕ</mi><mo id="S3.E5.m1.143.143.6.142.71.71.71.1.5.1.1.1.3" xref="S3.E5.m1.138.138.1.1.1.cmml">⁢</mo><msup id="S3.E5.m1.143.143.6.142.71.71.71.1.5.1.1.1.1"><mrow id="S3.E5.m1.143.143.6.142.71.71.71.1.5.1.1.1.1.1.1"><mo id="S3.E5.m1.104.104.104.37.37.37" stretchy="false" xref="S3.E5.m1.138.138.1.1.1.cmml">(</mo><msub id="S3.E5.m1.143.143.6.142.71.71.71.1.5.1.1.1.1.1.1.1"><mi id="S3.E5.m1.105.105.105.38.38.38" xref="S3.E5.m1.105.105.105.38.38.38.cmml">𝐪</mi><mi id="S3.E5.m1.106.106.106.39.39.39.1" xref="S3.E5.m1.106.106.106.39.39.39.1.cmml">i</mi></msub><mo id="S3.E5.m1.107.107.107.40.40.40" stretchy="false" xref="S3.E5.m1.138.138.1.1.1.cmml">)</mo></mrow><mo id="S3.E5.m1.108.108.108.41.41.41.1" xref="S3.E5.m1.108.108.108.41.41.41.1.cmml">⊤</mo></msup><mo id="S3.E5.m1.143.143.6.142.71.71.71.1.5.1.1.1.3a" xref="S3.E5.m1.138.138.1.1.1.cmml">⁢</mo><mi id="S3.E5.m1.109.109.109.42.42.42" xref="S3.E5.m1.109.109.109.42.42.42.cmml">ϕ</mi><mo id="S3.E5.m1.143.143.6.142.71.71.71.1.5.1.1.1.3b" xref="S3.E5.m1.138.138.1.1.1.cmml">⁢</mo><mrow id="S3.E5.m1.143.143.6.142.71.71.71.1.5.1.1.1.2.1"><mo id="S3.E5.m1.110.110.110.43.43.43" stretchy="false" xref="S3.E5.m1.138.138.1.1.1.cmml">(</mo><msub id="S3.E5.m1.143.143.6.142.71.71.71.1.5.1.1.1.2.1.1"><mi id="S3.E5.m1.111.111.111.44.44.44" xref="S3.E5.m1.111.111.111.44.44.44.cmml">𝐤</mi><mi id="S3.E5.m1.112.112.112.45.45.45.1" xref="S3.E5.m1.112.112.112.45.45.45.1.cmml">j</mi></msub><mo id="S3.E5.m1.113.113.113.46.46.46" stretchy="false" xref="S3.E5.m1.138.138.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E5.m1.114.114.114.47.47.47" xref="S3.E5.m1.138.138.1.1.1.cmml">)</mo></mrow><mo id="S3.E5.m1.143.143.6.142.71.71.71.1.6.3" xref="S3.E5.m1.138.138.1.1.1.cmml">⁢</mo><mrow id="S3.E5.m1.143.143.6.142.71.71.71.1.6.2.1"><mo id="S3.E5.m1.115.115.115.48.48.48" xref="S3.E5.m1.138.138.1.1.1.cmml">(</mo><mrow id="S3.E5.m1.143.143.6.142.71.71.71.1.6.2.1.1"><msub id="S3.E5.m1.143.143.6.142.71.71.71.1.6.2.1.1.4"><mi id="S3.E5.m1.116.116.116.49.49.49" xref="S3.E5.m1.116.116.116.49.49.49.cmml">ϕ</mi><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.117.117.117.50.50.50.1" xref="S3.E5.m1.117.117.117.50.50.50.1.cmml">𝒢</mi></msub><mo id="S3.E5.m1.143.143.6.142.71.71.71.1.6.2.1.1.3" xref="S3.E5.m1.138.138.1.1.1.cmml">⁢</mo><msup id="S3.E5.m1.143.143.6.142.71.71.71.1.6.2.1.1.1"><mrow id="S3.E5.m1.143.143.6.142.71.71.71.1.6.2.1.1.1.1.1"><mo id="S3.E5.m1.118.118.118.51.51.51" stretchy="false" xref="S3.E5.m1.138.138.1.1.1.cmml">(</mo><msub id="S3.E5.m1.143.143.6.142.71.71.71.1.6.2.1.1.1.1.1.1"><mi id="S3.E5.m1.119.119.119.52.52.52" xref="S3.E5.m1.119.119.119.52.52.52.cmml">v</mi><mi id="S3.E5.m1.120.120.120.53.53.53.1" xref="S3.E5.m1.120.120.120.53.53.53.1.cmml">i</mi></msub><mo id="S3.E5.m1.121.121.121.54.54.54" stretchy="false" xref="S3.E5.m1.138.138.1.1.1.cmml">)</mo></mrow><mo id="S3.E5.m1.122.122.122.55.55.55.1" xref="S3.E5.m1.122.122.122.55.55.55.1.cmml">⊤</mo></msup><mo id="S3.E5.m1.143.143.6.142.71.71.71.1.6.2.1.1.3a" xref="S3.E5.m1.138.138.1.1.1.cmml">⁢</mo><msub id="S3.E5.m1.143.143.6.142.71.71.71.1.6.2.1.1.5"><mi id="S3.E5.m1.123.123.123.56.56.56" xref="S3.E5.m1.123.123.123.56.56.56.cmml">ϕ</mi><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.124.124.124.57.57.57.1" xref="S3.E5.m1.124.124.124.57.57.57.1.cmml">𝒢</mi></msub><mo id="S3.E5.m1.143.143.6.142.71.71.71.1.6.2.1.1.3b" xref="S3.E5.m1.138.138.1.1.1.cmml">⁢</mo><mrow id="S3.E5.m1.143.143.6.142.71.71.71.1.6.2.1.1.2.1"><mo id="S3.E5.m1.125.125.125.58.58.58" stretchy="false" xref="S3.E5.m1.138.138.1.1.1.cmml">(</mo><msub id="S3.E5.m1.143.143.6.142.71.71.71.1.6.2.1.1.2.1.1"><mi id="S3.E5.m1.126.126.126.59.59.59" xref="S3.E5.m1.126.126.126.59.59.59.cmml">v</mi><mi id="S3.E5.m1.127.127.127.60.60.60.1" xref="S3.E5.m1.127.127.127.60.60.60.1.cmml">j</mi></msub><mo id="S3.E5.m1.128.128.128.61.61.61" stretchy="false" xref="S3.E5.m1.138.138.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E5.m1.129.129.129.62.62.62" xref="S3.E5.m1.138.138.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E5.m1.130.130.130.63.63.63" xref="S3.E5.m1.130.130.130.63.63.63.cmml">=</mo><mrow id="S3.E5.m1.143.143.6.142.71.71.71.1.9"><mmultiscripts id="S3.E5.m1.143.143.6.142.71.71.71.1.9.2"><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.131.131.131.64.64.64" xref="S3.E5.m1.131.131.131.64.64.64.cmml">𝒦</mi><mtext id="S3.E5.m1.132.132.132.65.65.65.1" xref="S3.E5.m1.132.132.132.65.65.65.1a.cmml">LR</mtext><mrow id="S3.E5.m1.143.143.6.142.71.71.71.1.9.2a" xref="S3.E5.m1.138.138.1.1.1.cmml"></mrow><mrow id="S3.E5.m1.133.133.133.66.66.66.1" xref="S3.E5.m1.133.133.133.66.66.66.1.cmml"><mi id="S3.E5.m1.133.133.133.66.66.66.1.2" xref="S3.E5.m1.133.133.133.66.66.66.1.2.cmml">i</mi><mo id="S3.E5.m1.133.133.133.66.66.66.1.1" xref="S3.E5.m1.133.133.133.66.66.66.1.1.cmml">⁢</mo><mi id="S3.E5.m1.133.133.133.66.66.66.1.3" xref="S3.E5.m1.133.133.133.66.66.66.1.3.cmml">j</mi></mrow><mrow id="S3.E5.m1.143.143.6.142.71.71.71.1.9.2b" xref="S3.E5.m1.138.138.1.1.1.cmml"></mrow></mmultiscripts><mo id="S3.E5.m1.143.143.6.142.71.71.71.1.9.1" xref="S3.E5.m1.138.138.1.1.1.cmml">⁢</mo><mmultiscripts id="S3.E5.m1.143.143.6.142.71.71.71.1.9.3"><mi id="S3.E5.m1.134.134.134.67.67.67" xref="S3.E5.m1.134.134.134.67.67.67.cmml">𝐌</mi><mi id="S3.E5.m1.135.135.135.68.68.68.1" xref="S3.E5.m1.135.135.135.68.68.68.1.cmml">α</mi><mrow id="S3.E5.m1.143.143.6.142.71.71.71.1.9.3a" xref="S3.E5.m1.138.138.1.1.1.cmml"></mrow><mrow id="S3.E5.m1.136.136.136.69.69.69.1" xref="S3.E5.m1.136.136.136.69.69.69.1.cmml"><mi id="S3.E5.m1.136.136.136.69.69.69.1.2" xref="S3.E5.m1.136.136.136.69.69.69.1.2.cmml">i</mi><mo id="S3.E5.m1.136.136.136.69.69.69.1.1" xref="S3.E5.m1.136.136.136.69.69.69.1.1.cmml">⁢</mo><mi id="S3.E5.m1.136.136.136.69.69.69.1.3" xref="S3.E5.m1.136.136.136.69.69.69.1.3.cmml">j</mi></mrow><mrow id="S3.E5.m1.143.143.6.142.71.71.71.1.9.3b" xref="S3.E5.m1.138.138.1.1.1.cmml"></mrow></mmultiscripts></mrow></mrow><mo id="S3.E5.m1.137.137.137.70.70.70" lspace="0em" xref="S3.E5.m1.138.138.1.1.1.cmml">.</mo></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S3.E5.m1.143b"><apply id="S3.E5.m1.138.138.1.1.1.cmml" xref="S3.E5.m1.140.140.3.139.69.69.69.3"><and id="S3.E5.m1.138.138.1.1.1a.cmml" xref="S3.E5.m1.140.140.3.139.69.69.69.3"></and><apply id="S3.E5.m1.138.138.1.1.1b.cmml" xref="S3.E5.m1.140.140.3.139.69.69.69.3"><eq id="S3.E5.m1.32.32.32.32.32.32.cmml" xref="S3.E5.m1.32.32.32.32.32.32"></eq><apply id="S3.E5.m1.138.138.1.1.1.2.cmml" xref="S3.E5.m1.140.140.3.139.69.69.69.3"><times id="S3.E5.m1.138.138.1.1.1.2.3.cmml" xref="S3.E5.m1.140.140.3.139.69.69.69.3"></times><ci id="S3.E5.m1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1">vec</ci><apply id="S3.E5.m1.138.138.1.1.1.1.1.cmml" xref="S3.E5.m1.140.140.3.139.69.69.69.3"><csymbol cd="ambiguous" id="S3.E5.m1.138.138.1.1.1.1.1.2.cmml" xref="S3.E5.m1.140.140.3.139.69.69.69.3">superscript</csymbol><apply id="S3.E5.m1.138.138.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.140.140.3.139.69.69.69.3"><times id="S3.E5.m1.138.138.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E5.m1.140.140.3.139.69.69.69.3"></times><apply id="S3.E5.m1.138.138.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.140.140.3.139.69.69.69.3"><csymbol cd="latexml" id="S3.E5.m1.8.8.8.8.8.8.cmml" xref="S3.E5.m1.8.8.8.8.8.8">tensor-product</csymbol><apply id="S3.E5.m1.138.138.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.140.140.3.139.69.69.69.3"><times id="S3.E5.m1.138.138.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.140.140.3.139.69.69.69.3"></times><ci id="S3.E5.m1.3.3.3.3.3.3.cmml" xref="S3.E5.m1.3.3.3.3.3.3">italic-ϕ</ci><apply id="S3.E5.m1.138.138.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.140.140.3.139.69.69.69.3"><csymbol cd="ambiguous" id="S3.E5.m1.138.138.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.140.140.3.139.69.69.69.3">subscript</csymbol><ci id="S3.E5.m1.5.5.5.5.5.5.cmml" xref="S3.E5.m1.5.5.5.5.5.5">𝐪</ci><ci id="S3.E5.m1.6.6.6.6.6.6.1.cmml" xref="S3.E5.m1.6.6.6.6.6.6.1">𝑖</ci></apply></apply><apply id="S3.E5.m1.138.138.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E5.m1.140.140.3.139.69.69.69.3"><csymbol cd="ambiguous" id="S3.E5.m1.138.138.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E5.m1.140.140.3.139.69.69.69.3">subscript</csymbol><ci id="S3.E5.m1.9.9.9.9.9.9.cmml" xref="S3.E5.m1.9.9.9.9.9.9">italic-ϕ</ci><ci id="S3.E5.m1.10.10.10.10.10.10.1.cmml" xref="S3.E5.m1.10.10.10.10.10.10.1">𝒢</ci></apply></apply><apply id="S3.E5.m1.138.138.1.1.1.1.1.1.1.1.2.1.1.cmml" xref="S3.E5.m1.140.140.3.139.69.69.69.3"><csymbol cd="ambiguous" id="S3.E5.m1.138.138.1.1.1.1.1.1.1.1.2.1.1.1.cmml" xref="S3.E5.m1.140.140.3.139.69.69.69.3">subscript</csymbol><ci id="S3.E5.m1.12.12.12.12.12.12.cmml" xref="S3.E5.m1.12.12.12.12.12.12">𝑣</ci><ci id="S3.E5.m1.13.13.13.13.13.13.1.cmml" xref="S3.E5.m1.13.13.13.13.13.13.1">𝑖</ci></apply></apply><csymbol cd="latexml" id="S3.E5.m1.16.16.16.16.16.16.1.cmml" xref="S3.E5.m1.16.16.16.16.16.16.1">top</csymbol></apply><ci id="S3.E5.m1.17.17.17.17.17.17.cmml" xref="S3.E5.m1.17.17.17.17.17.17">vec</ci><apply id="S3.E5.m1.138.138.1.1.1.2.2.1.1.cmml" xref="S3.E5.m1.140.140.3.139.69.69.69.3"><times id="S3.E5.m1.138.138.1.1.1.2.2.1.1.3.cmml" xref="S3.E5.m1.140.140.3.139.69.69.69.3"></times><apply id="S3.E5.m1.138.138.1.1.1.2.2.1.1.1.cmml" xref="S3.E5.m1.140.140.3.139.69.69.69.3"><csymbol cd="latexml" id="S3.E5.m1.24.24.24.24.24.24.cmml" xref="S3.E5.m1.24.24.24.24.24.24">tensor-product</csymbol><apply id="S3.E5.m1.138.138.1.1.1.2.2.1.1.1.1.cmml" xref="S3.E5.m1.140.140.3.139.69.69.69.3"><times id="S3.E5.m1.138.138.1.1.1.2.2.1.1.1.1.2.cmml" xref="S3.E5.m1.140.140.3.139.69.69.69.3"></times><ci id="S3.E5.m1.19.19.19.19.19.19.cmml" xref="S3.E5.m1.19.19.19.19.19.19">italic-ϕ</ci><apply id="S3.E5.m1.138.138.1.1.1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.140.140.3.139.69.69.69.3"><csymbol cd="ambiguous" id="S3.E5.m1.138.138.1.1.1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.140.140.3.139.69.69.69.3">subscript</csymbol><ci id="S3.E5.m1.21.21.21.21.21.21.cmml" xref="S3.E5.m1.21.21.21.21.21.21">𝐤</ci><ci id="S3.E5.m1.22.22.22.22.22.22.1.cmml" xref="S3.E5.m1.22.22.22.22.22.22.1">𝑗</ci></apply></apply><apply id="S3.E5.m1.138.138.1.1.1.2.2.1.1.1.3.cmml" xref="S3.E5.m1.140.140.3.139.69.69.69.3"><csymbol cd="ambiguous" id="S3.E5.m1.138.138.1.1.1.2.2.1.1.1.3.1.cmml" xref="S3.E5.m1.140.140.3.139.69.69.69.3">subscript</csymbol><ci id="S3.E5.m1.25.25.25.25.25.25.cmml" xref="S3.E5.m1.25.25.25.25.25.25">italic-ϕ</ci><ci id="S3.E5.m1.26.26.26.26.26.26.1.cmml" xref="S3.E5.m1.26.26.26.26.26.26.1">𝒢</ci></apply></apply><apply id="S3.E5.m1.138.138.1.1.1.2.2.1.1.2.1.1.cmml" xref="S3.E5.m1.140.140.3.139.69.69.69.3"><csymbol cd="ambiguous" id="S3.E5.m1.138.138.1.1.1.2.2.1.1.2.1.1.1.cmml" xref="S3.E5.m1.140.140.3.139.69.69.69.3">subscript</csymbol><ci id="S3.E5.m1.28.28.28.28.28.28.cmml" xref="S3.E5.m1.28.28.28.28.28.28">𝑣</ci><ci id="S3.E5.m1.29.29.29.29.29.29.1.cmml" xref="S3.E5.m1.29.29.29.29.29.29.1">𝑗</ci></apply></apply></apply><apply id="S3.E5.m1.138.138.1.1.1.4.cmml" xref="S3.E5.m1.140.140.3.139.69.69.69.3"><apply id="S3.E5.m1.138.138.1.1.1.4.3.cmml" xref="S3.E5.m1.140.140.3.139.69.69.69.3"><csymbol cd="ambiguous" id="S3.E5.m1.138.138.1.1.1.4.3.1.cmml" xref="S3.E5.m1.140.140.3.139.69.69.69.3">superscript</csymbol><apply id="S3.E5.m1.138.138.1.1.1.4.3.2.cmml" xref="S3.E5.m1.140.140.3.139.69.69.69.3"><csymbol cd="ambiguous" id="S3.E5.m1.138.138.1.1.1.4.3.2.1.cmml" xref="S3.E5.m1.140.140.3.139.69.69.69.3">subscript</csymbol><sum id="S3.E5.m1.33.33.33.33.33.33.cmml" xref="S3.E5.m1.33.33.33.33.33.33"></sum><apply id="S3.E5.m1.34.34.34.34.34.34.1.cmml" xref="S3.E5.m1.34.34.34.34.34.34.1"><eq id="S3.E5.m1.34.34.34.34.34.34.1.1.cmml" xref="S3.E5.m1.34.34.34.34.34.34.1.1"></eq><ci id="S3.E5.m1.34.34.34.34.34.34.1.2.cmml" xref="S3.E5.m1.34.34.34.34.34.34.1.2">𝑠</ci><cn id="S3.E5.m1.34.34.34.34.34.34.1.3.cmml" type="integer" xref="S3.E5.m1.34.34.34.34.34.34.1.3">1</cn></apply></apply><apply id="S3.E5.m1.35.35.35.35.35.35.1.cmml" xref="S3.E5.m1.35.35.35.35.35.35.1"><times id="S3.E5.m1.35.35.35.35.35.35.1.1.cmml" xref="S3.E5.m1.35.35.35.35.35.35.1.1"></times><ci id="S3.E5.m1.35.35.35.35.35.35.1.2.cmml" xref="S3.E5.m1.35.35.35.35.35.35.1.2">𝑚</ci><ci id="S3.E5.m1.35.35.35.35.35.35.1.3.cmml" xref="S3.E5.m1.35.35.35.35.35.35.1.3">𝑁</ci></apply></apply><apply id="S3.E5.m1.138.138.1.1.1.4.2.cmml" xref="S3.E5.m1.140.140.3.139.69.69.69.3"><times id="S3.E5.m1.138.138.1.1.1.4.2.3.cmml" xref="S3.E5.m1.140.140.3.139.69.69.69.3"></times><ci id="S3.E5.m1.36.36.36.36.36.36.cmml" xref="S3.E5.m1.36.36.36.36.36.36">vec</ci><apply id="S3.E5.m1.138.138.1.1.1.3.1.1.cmml" xref="S3.E5.m1.140.140.3.139.69.69.69.3"><csymbol cd="ambiguous" id="S3.E5.m1.138.138.1.1.1.3.1.1.2.cmml" xref="S3.E5.m1.140.140.3.139.69.69.69.3">subscript</csymbol><apply id="S3.E5.m1.138.138.1.1.1.3.1.1.1.1.1.cmml" xref="S3.E5.m1.140.140.3.139.69.69.69.3"><times id="S3.E5.m1.138.138.1.1.1.3.1.1.1.1.1.3.cmml" xref="S3.E5.m1.140.140.3.139.69.69.69.3"></times><apply id="S3.E5.m1.138.138.1.1.1.3.1.1.1.1.1.1.cmml" xref="S3.E5.m1.140.140.3.139.69.69.69.3"><csymbol cd="latexml" id="S3.E5.m1.43.43.43.43.43.43.cmml" xref="S3.E5.m1.43.43.43.43.43.43">tensor-product</csymbol><apply id="S3.E5.m1.138.138.1.1.1.3.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.140.140.3.139.69.69.69.3"><times id="S3.E5.m1.138.138.1.1.1.3.1.1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.140.140.3.139.69.69.69.3"></times><ci id="S3.E5.m1.38.38.38.38.38.38.cmml" xref="S3.E5.m1.38.38.38.38.38.38">italic-ϕ</ci><apply id="S3.E5.m1.138.138.1.1.1.3.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.140.140.3.139.69.69.69.3"><csymbol cd="ambiguous" id="S3.E5.m1.138.138.1.1.1.3.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.140.140.3.139.69.69.69.3">subscript</csymbol><ci id="S3.E5.m1.40.40.40.40.40.40.cmml" xref="S3.E5.m1.40.40.40.40.40.40">𝐪</ci><ci id="S3.E5.m1.41.41.41.41.41.41.1.cmml" xref="S3.E5.m1.41.41.41.41.41.41.1">𝑖</ci></apply></apply><apply id="S3.E5.m1.138.138.1.1.1.3.1.1.1.1.1.1.3.cmml" xref="S3.E5.m1.140.140.3.139.69.69.69.3"><csymbol cd="ambiguous" id="S3.E5.m1.138.138.1.1.1.3.1.1.1.1.1.1.3.1.cmml" xref="S3.E5.m1.140.140.3.139.69.69.69.3">subscript</csymbol><ci id="S3.E5.m1.44.44.44.44.44.44.cmml" xref="S3.E5.m1.44.44.44.44.44.44">italic-ϕ</ci><ci id="S3.E5.m1.45.45.45.45.45.45.1.cmml" xref="S3.E5.m1.45.45.45.45.45.45.1">𝒢</ci></apply></apply><apply id="S3.E5.m1.138.138.1.1.1.3.1.1.1.1.1.2.1.1.cmml" xref="S3.E5.m1.140.140.3.139.69.69.69.3"><csymbol cd="ambiguous" id="S3.E5.m1.138.138.1.1.1.3.1.1.1.1.1.2.1.1.1.cmml" xref="S3.E5.m1.140.140.3.139.69.69.69.3">subscript</csymbol><ci id="S3.E5.m1.47.47.47.47.47.47.cmml" xref="S3.E5.m1.47.47.47.47.47.47">𝑣</ci><ci id="S3.E5.m1.48.48.48.48.48.48.1.cmml" xref="S3.E5.m1.48.48.48.48.48.48.1">𝑖</ci></apply></apply><ci id="S3.E5.m1.51.51.51.51.51.51.1.cmml" xref="S3.E5.m1.51.51.51.51.51.51.1">𝑠</ci></apply><ci id="S3.E5.m1.52.52.52.52.52.52.cmml" xref="S3.E5.m1.52.52.52.52.52.52">vec</ci><apply id="S3.E5.m1.138.138.1.1.1.4.2.2.cmml" xref="S3.E5.m1.140.140.3.139.69.69.69.3"><csymbol cd="ambiguous" id="S3.E5.m1.138.138.1.1.1.4.2.2.2.cmml" xref="S3.E5.m1.140.140.3.139.69.69.69.3">subscript</csymbol><apply id="S3.E5.m1.138.138.1.1.1.4.2.2.1.1.1.cmml" xref="S3.E5.m1.140.140.3.139.69.69.69.3"><times id="S3.E5.m1.138.138.1.1.1.4.2.2.1.1.1.3.cmml" xref="S3.E5.m1.140.140.3.139.69.69.69.3"></times><apply id="S3.E5.m1.138.138.1.1.1.4.2.2.1.1.1.1.cmml" xref="S3.E5.m1.140.140.3.139.69.69.69.3"><csymbol cd="latexml" id="S3.E5.m1.59.59.59.59.59.59.cmml" xref="S3.E5.m1.59.59.59.59.59.59">tensor-product</csymbol><apply id="S3.E5.m1.138.138.1.1.1.4.2.2.1.1.1.1.1.cmml" xref="S3.E5.m1.140.140.3.139.69.69.69.3"><times id="S3.E5.m1.138.138.1.1.1.4.2.2.1.1.1.1.1.2.cmml" xref="S3.E5.m1.140.140.3.139.69.69.69.3"></times><ci id="S3.E5.m1.54.54.54.54.54.54.cmml" xref="S3.E5.m1.54.54.54.54.54.54">italic-ϕ</ci><apply id="S3.E5.m1.138.138.1.1.1.4.2.2.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.140.140.3.139.69.69.69.3"><csymbol cd="ambiguous" id="S3.E5.m1.138.138.1.1.1.4.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.140.140.3.139.69.69.69.3">subscript</csymbol><ci id="S3.E5.m1.56.56.56.56.56.56.cmml" xref="S3.E5.m1.56.56.56.56.56.56">𝐤</ci><ci id="S3.E5.m1.57.57.57.57.57.57.1.cmml" xref="S3.E5.m1.57.57.57.57.57.57.1">𝑗</ci></apply></apply><apply id="S3.E5.m1.138.138.1.1.1.4.2.2.1.1.1.1.3.cmml" xref="S3.E5.m1.140.140.3.139.69.69.69.3"><csymbol cd="ambiguous" id="S3.E5.m1.138.138.1.1.1.4.2.2.1.1.1.1.3.1.cmml" xref="S3.E5.m1.140.140.3.139.69.69.69.3">subscript</csymbol><ci id="S3.E5.m1.60.60.60.60.60.60.cmml" xref="S3.E5.m1.60.60.60.60.60.60">italic-ϕ</ci><ci id="S3.E5.m1.61.61.61.61.61.61.1.cmml" xref="S3.E5.m1.61.61.61.61.61.61.1">𝒢</ci></apply></apply><apply id="S3.E5.m1.138.138.1.1.1.4.2.2.1.1.1.2.1.1.cmml" xref="S3.E5.m1.140.140.3.139.69.69.69.3"><csymbol cd="ambiguous" id="S3.E5.m1.138.138.1.1.1.4.2.2.1.1.1.2.1.1.1.cmml" xref="S3.E5.m1.140.140.3.139.69.69.69.3">subscript</csymbol><ci id="S3.E5.m1.63.63.63.63.63.63.cmml" xref="S3.E5.m1.63.63.63.63.63.63">𝑣</ci><ci id="S3.E5.m1.64.64.64.64.64.64.1.cmml" xref="S3.E5.m1.64.64.64.64.64.64.1">𝑗</ci></apply></apply><ci id="S3.E5.m1.67.67.67.67.67.67.1.cmml" xref="S3.E5.m1.67.67.67.67.67.67.1">𝑠</ci></apply></apply></apply></apply><apply id="S3.E5.m1.138.138.1.1.1c.cmml" xref="S3.E5.m1.140.140.3.139.69.69.69.3"><eq id="S3.E5.m1.68.68.68.1.1.1.cmml" xref="S3.E5.m1.68.68.68.1.1.1"></eq><share href="https://arxiv.org/html/2410.03462v1#S3.E5.m1.138.138.1.1.1.4.cmml" id="S3.E5.m1.138.138.1.1.1d.cmml" xref="S3.E5.m1.140.140.3.139.69.69.69.3"></share><apply id="S3.E5.m1.138.138.1.1.1.8.cmml" xref="S3.E5.m1.140.140.3.139.69.69.69.3"><apply id="S3.E5.m1.138.138.1.1.1.8.5.cmml" xref="S3.E5.m1.140.140.3.139.69.69.69.3"><csymbol cd="ambiguous" id="S3.E5.m1.138.138.1.1.1.8.5.1.cmml" xref="S3.E5.m1.140.140.3.139.69.69.69.3">superscript</csymbol><apply id="S3.E5.m1.138.138.1.1.1.8.5.2.cmml" xref="S3.E5.m1.140.140.3.139.69.69.69.3"><csymbol cd="ambiguous" id="S3.E5.m1.138.138.1.1.1.8.5.2.1.cmml" xref="S3.E5.m1.140.140.3.139.69.69.69.3">subscript</csymbol><sum id="S3.E5.m1.69.69.69.2.2.2.cmml" xref="S3.E5.m1.69.69.69.2.2.2"></sum><apply id="S3.E5.m1.70.70.70.3.3.3.1.cmml" xref="S3.E5.m1.70.70.70.3.3.3.1"><eq id="S3.E5.m1.70.70.70.3.3.3.1.1.cmml" xref="S3.E5.m1.70.70.70.3.3.3.1.1"></eq><ci id="S3.E5.m1.70.70.70.3.3.3.1.2.cmml" xref="S3.E5.m1.70.70.70.3.3.3.1.2">𝑘</ci><cn id="S3.E5.m1.70.70.70.3.3.3.1.3.cmml" type="integer" xref="S3.E5.m1.70.70.70.3.3.3.1.3">1</cn></apply></apply><ci id="S3.E5.m1.71.71.71.4.4.4.1.cmml" xref="S3.E5.m1.71.71.71.4.4.4.1">𝑚</ci></apply><apply id="S3.E5.m1.138.138.1.1.1.8.4.cmml" xref="S3.E5.m1.140.140.3.139.69.69.69.3"><apply id="S3.E5.m1.138.138.1.1.1.8.4.5.cmml" xref="S3.E5.m1.140.140.3.139.69.69.69.3"><csymbol cd="ambiguous" id="S3.E5.m1.138.138.1.1.1.8.4.5.1.cmml" xref="S3.E5.m1.140.140.3.139.69.69.69.3">superscript</csymbol><apply id="S3.E5.m1.138.138.1.1.1.8.4.5.2.cmml" xref="S3.E5.m1.140.140.3.139.69.69.69.3"><csymbol cd="ambiguous" id="S3.E5.m1.138.138.1.1.1.8.4.5.2.1.cmml" xref="S3.E5.m1.140.140.3.139.69.69.69.3">subscript</csymbol><sum id="S3.E5.m1.72.72.72.5.5.5.cmml" xref="S3.E5.m1.72.72.72.5.5.5"></sum><apply id="S3.E5.m1.73.73.73.6.6.6.1.cmml" xref="S3.E5.m1.73.73.73.6.6.6.1"><eq id="S3.E5.m1.73.73.73.6.6.6.1.1.cmml" xref="S3.E5.m1.73.73.73.6.6.6.1.1"></eq><ci id="S3.E5.m1.73.73.73.6.6.6.1.2.cmml" xref="S3.E5.m1.73.73.73.6.6.6.1.2">𝑙</ci><cn id="S3.E5.m1.73.73.73.6.6.6.1.3.cmml" type="integer" xref="S3.E5.m1.73.73.73.6.6.6.1.3">1</cn></apply></apply><ci id="S3.E5.m1.74.74.74.7.7.7.1.cmml" xref="S3.E5.m1.74.74.74.7.7.7.1">𝑁</ci></apply><apply id="S3.E5.m1.138.138.1.1.1.8.4.4.cmml" xref="S3.E5.m1.140.140.3.139.69.69.69.3"><times id="S3.E5.m1.138.138.1.1.1.8.4.4.5.cmml" xref="S3.E5.m1.140.140.3.139.69.69.69.3"></times><ci id="S3.E5.m1.75.75.75.8.8.8.cmml" xref="S3.E5.m1.75.75.75.8.8.8">italic-ϕ</ci><apply id="S3.E5.m1.138.138.1.1.1.5.1.1.1.cmml" xref="S3.E5.m1.140.140.3.139.69.69.69.3"><csymbol cd="ambiguous" id="S3.E5.m1.138.138.1.1.1.5.1.1.1.2.cmml" xref="S3.E5.m1.140.140.3.139.69.69.69.3">subscript</csymbol><apply id="S3.E5.m1.138.138.1.1.1.5.1.1.1.1.1.1.cmml" xref="S3.E5.m1.140.140.3.139.69.69.69.3"><csymbol cd="ambiguous" id="S3.E5.m1.138.138.1.1.1.5.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.140.140.3.139.69.69.69.3">subscript</csymbol><ci id="S3.E5.m1.77.77.77.10.10.10.cmml" xref="S3.E5.m1.77.77.77.10.10.10">𝐪</ci><ci id="S3.E5.m1.78.78.78.11.11.11.1.cmml" xref="S3.E5.m1.78.78.78.11.11.11.1">𝑖</ci></apply><ci id="S3.E5.m1.80.80.80.13.13.13.1.cmml" xref="S3.E5.m1.80.80.80.13.13.13.1">𝑘</ci></apply><apply id="S3.E5.m1.138.138.1.1.1.8.4.4.7.cmml" xref="S3.E5.m1.140.140.3.139.69.69.69.3"><csymbol cd="ambiguous" id="S3.E5.m1.138.138.1.1.1.8.4.4.7.1.cmml" xref="S3.E5.m1.140.140.3.139.69.69.69.3">subscript</csymbol><ci id="S3.E5.m1.81.81.81.14.14.14.cmml" xref="S3.E5.m1.81.81.81.14.14.14">italic-ϕ</ci><ci id="S3.E5.m1.82.82.82.15.15.15.1.cmml" xref="S3.E5.m1.82.82.82.15.15.15.1">𝒢</ci></apply><apply id="S3.E5.m1.138.138.1.1.1.6.2.2.2.cmml" xref="S3.E5.m1.140.140.3.139.69.69.69.3"><csymbol cd="ambiguous" id="S3.E5.m1.138.138.1.1.1.6.2.2.2.2.cmml" xref="S3.E5.m1.140.140.3.139.69.69.69.3">subscript</csymbol><apply id="S3.E5.m1.138.138.1.1.1.6.2.2.2.1.1.1.cmml" xref="S3.E5.m1.140.140.3.139.69.69.69.3"><csymbol cd="ambiguous" id="S3.E5.m1.138.138.1.1.1.6.2.2.2.1.1.1.1.cmml" xref="S3.E5.m1.140.140.3.139.69.69.69.3">subscript</csymbol><ci id="S3.E5.m1.84.84.84.17.17.17.cmml" xref="S3.E5.m1.84.84.84.17.17.17">𝑣</ci><ci id="S3.E5.m1.85.85.85.18.18.18.1.cmml" xref="S3.E5.m1.85.85.85.18.18.18.1">𝑖</ci></apply><ci id="S3.E5.m1.87.87.87.20.20.20.1.cmml" xref="S3.E5.m1.87.87.87.20.20.20.1">𝑙</ci></apply><ci id="S3.E5.m1.88.88.88.21.21.21.cmml" xref="S3.E5.m1.88.88.88.21.21.21">italic-ϕ</ci><apply id="S3.E5.m1.138.138.1.1.1.7.3.3.3.cmml" xref="S3.E5.m1.140.140.3.139.69.69.69.3"><csymbol cd="ambiguous" id="S3.E5.m1.138.138.1.1.1.7.3.3.3.2.cmml" xref="S3.E5.m1.140.140.3.139.69.69.69.3">subscript</csymbol><apply id="S3.E5.m1.138.138.1.1.1.7.3.3.3.1.1.1.cmml" xref="S3.E5.m1.140.140.3.139.69.69.69.3"><csymbol cd="ambiguous" id="S3.E5.m1.138.138.1.1.1.7.3.3.3.1.1.1.1.cmml" xref="S3.E5.m1.140.140.3.139.69.69.69.3">subscript</csymbol><ci id="S3.E5.m1.90.90.90.23.23.23.cmml" xref="S3.E5.m1.90.90.90.23.23.23">𝐤</ci><ci id="S3.E5.m1.91.91.91.24.24.24.1.cmml" xref="S3.E5.m1.91.91.91.24.24.24.1">𝑗</ci></apply><ci id="S3.E5.m1.93.93.93.26.26.26.1.cmml" xref="S3.E5.m1.93.93.93.26.26.26.1">𝑘</ci></apply><apply id="S3.E5.m1.138.138.1.1.1.8.4.4.9.cmml" xref="S3.E5.m1.140.140.3.139.69.69.69.3"><csymbol cd="ambiguous" id="S3.E5.m1.138.138.1.1.1.8.4.4.9.1.cmml" xref="S3.E5.m1.140.140.3.139.69.69.69.3">subscript</csymbol><ci id="S3.E5.m1.94.94.94.27.27.27.cmml" xref="S3.E5.m1.94.94.94.27.27.27">italic-ϕ</ci><ci id="S3.E5.m1.95.95.95.28.28.28.1.cmml" xref="S3.E5.m1.95.95.95.28.28.28.1">𝒢</ci></apply><apply id="S3.E5.m1.138.138.1.1.1.8.4.4.4.cmml" xref="S3.E5.m1.140.140.3.139.69.69.69.3"><csymbol cd="ambiguous" id="S3.E5.m1.138.138.1.1.1.8.4.4.4.2.cmml" xref="S3.E5.m1.140.140.3.139.69.69.69.3">subscript</csymbol><apply id="S3.E5.m1.138.138.1.1.1.8.4.4.4.1.1.1.cmml" xref="S3.E5.m1.140.140.3.139.69.69.69.3"><csymbol cd="ambiguous" id="S3.E5.m1.138.138.1.1.1.8.4.4.4.1.1.1.1.cmml" xref="S3.E5.m1.140.140.3.139.69.69.69.3">subscript</csymbol><ci id="S3.E5.m1.97.97.97.30.30.30.cmml" xref="S3.E5.m1.97.97.97.30.30.30">𝑣</ci><ci id="S3.E5.m1.98.98.98.31.31.31.1.cmml" xref="S3.E5.m1.98.98.98.31.31.31.1">𝑗</ci></apply><ci id="S3.E5.m1.100.100.100.33.33.33.1.cmml" xref="S3.E5.m1.100.100.100.33.33.33.1">𝑙</ci></apply></apply></apply></apply></apply><apply id="S3.E5.m1.138.138.1.1.1e.cmml" xref="S3.E5.m1.140.140.3.139.69.69.69.3"><eq id="S3.E5.m1.101.101.101.34.34.34.cmml" xref="S3.E5.m1.101.101.101.34.34.34"></eq><share href="https://arxiv.org/html/2410.03462v1#S3.E5.m1.138.138.1.1.1.8.cmml" id="S3.E5.m1.138.138.1.1.1f.cmml" xref="S3.E5.m1.140.140.3.139.69.69.69.3"></share><apply id="S3.E5.m1.138.138.1.1.1.10.cmml" xref="S3.E5.m1.140.140.3.139.69.69.69.3"><times id="S3.E5.m1.138.138.1.1.1.10.3.cmml" xref="S3.E5.m1.140.140.3.139.69.69.69.3"></times><apply id="S3.E5.m1.138.138.1.1.1.9.1.1.1.cmml" xref="S3.E5.m1.140.140.3.139.69.69.69.3"><times id="S3.E5.m1.138.138.1.1.1.9.1.1.1.3.cmml" xref="S3.E5.m1.140.140.3.139.69.69.69.3"></times><ci id="S3.E5.m1.103.103.103.36.36.36.cmml" xref="S3.E5.m1.103.103.103.36.36.36">italic-ϕ</ci><apply id="S3.E5.m1.138.138.1.1.1.9.1.1.1.1.cmml" xref="S3.E5.m1.140.140.3.139.69.69.69.3"><csymbol cd="ambiguous" id="S3.E5.m1.138.138.1.1.1.9.1.1.1.1.2.cmml" xref="S3.E5.m1.140.140.3.139.69.69.69.3">superscript</csymbol><apply id="S3.E5.m1.138.138.1.1.1.9.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.140.140.3.139.69.69.69.3"><csymbol cd="ambiguous" id="S3.E5.m1.138.138.1.1.1.9.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.140.140.3.139.69.69.69.3">subscript</csymbol><ci id="S3.E5.m1.105.105.105.38.38.38.cmml" xref="S3.E5.m1.105.105.105.38.38.38">𝐪</ci><ci id="S3.E5.m1.106.106.106.39.39.39.1.cmml" xref="S3.E5.m1.106.106.106.39.39.39.1">𝑖</ci></apply><csymbol cd="latexml" id="S3.E5.m1.108.108.108.41.41.41.1.cmml" xref="S3.E5.m1.108.108.108.41.41.41.1">top</csymbol></apply><ci id="S3.E5.m1.109.109.109.42.42.42.cmml" xref="S3.E5.m1.109.109.109.42.42.42">italic-ϕ</ci><apply id="S3.E5.m1.138.138.1.1.1.9.1.1.1.2.1.1.cmml" xref="S3.E5.m1.140.140.3.139.69.69.69.3"><csymbol cd="ambiguous" id="S3.E5.m1.138.138.1.1.1.9.1.1.1.2.1.1.1.cmml" xref="S3.E5.m1.140.140.3.139.69.69.69.3">subscript</csymbol><ci id="S3.E5.m1.111.111.111.44.44.44.cmml" xref="S3.E5.m1.111.111.111.44.44.44">𝐤</ci><ci id="S3.E5.m1.112.112.112.45.45.45.1.cmml" xref="S3.E5.m1.112.112.112.45.45.45.1">𝑗</ci></apply></apply><apply id="S3.E5.m1.138.138.1.1.1.10.2.1.1.cmml" xref="S3.E5.m1.140.140.3.139.69.69.69.3"><times id="S3.E5.m1.138.138.1.1.1.10.2.1.1.3.cmml" xref="S3.E5.m1.140.140.3.139.69.69.69.3"></times><apply id="S3.E5.m1.138.138.1.1.1.10.2.1.1.4.cmml" xref="S3.E5.m1.140.140.3.139.69.69.69.3"><csymbol cd="ambiguous" id="S3.E5.m1.138.138.1.1.1.10.2.1.1.4.1.cmml" xref="S3.E5.m1.140.140.3.139.69.69.69.3">subscript</csymbol><ci id="S3.E5.m1.116.116.116.49.49.49.cmml" xref="S3.E5.m1.116.116.116.49.49.49">italic-ϕ</ci><ci id="S3.E5.m1.117.117.117.50.50.50.1.cmml" xref="S3.E5.m1.117.117.117.50.50.50.1">𝒢</ci></apply><apply id="S3.E5.m1.138.138.1.1.1.10.2.1.1.1.cmml" xref="S3.E5.m1.140.140.3.139.69.69.69.3"><csymbol cd="ambiguous" id="S3.E5.m1.138.138.1.1.1.10.2.1.1.1.2.cmml" xref="S3.E5.m1.140.140.3.139.69.69.69.3">superscript</csymbol><apply id="S3.E5.m1.138.138.1.1.1.10.2.1.1.1.1.1.1.cmml" xref="S3.E5.m1.140.140.3.139.69.69.69.3"><csymbol cd="ambiguous" id="S3.E5.m1.138.138.1.1.1.10.2.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.140.140.3.139.69.69.69.3">subscript</csymbol><ci id="S3.E5.m1.119.119.119.52.52.52.cmml" xref="S3.E5.m1.119.119.119.52.52.52">𝑣</ci><ci id="S3.E5.m1.120.120.120.53.53.53.1.cmml" xref="S3.E5.m1.120.120.120.53.53.53.1">𝑖</ci></apply><csymbol cd="latexml" id="S3.E5.m1.122.122.122.55.55.55.1.cmml" xref="S3.E5.m1.122.122.122.55.55.55.1">top</csymbol></apply><apply id="S3.E5.m1.138.138.1.1.1.10.2.1.1.5.cmml" xref="S3.E5.m1.140.140.3.139.69.69.69.3"><csymbol cd="ambiguous" id="S3.E5.m1.138.138.1.1.1.10.2.1.1.5.1.cmml" xref="S3.E5.m1.140.140.3.139.69.69.69.3">subscript</csymbol><ci id="S3.E5.m1.123.123.123.56.56.56.cmml" xref="S3.E5.m1.123.123.123.56.56.56">italic-ϕ</ci><ci id="S3.E5.m1.124.124.124.57.57.57.1.cmml" xref="S3.E5.m1.124.124.124.57.57.57.1">𝒢</ci></apply><apply id="S3.E5.m1.138.138.1.1.1.10.2.1.1.2.1.1.cmml" xref="S3.E5.m1.140.140.3.139.69.69.69.3"><csymbol cd="ambiguous" id="S3.E5.m1.138.138.1.1.1.10.2.1.1.2.1.1.1.cmml" xref="S3.E5.m1.140.140.3.139.69.69.69.3">subscript</csymbol><ci id="S3.E5.m1.126.126.126.59.59.59.cmml" xref="S3.E5.m1.126.126.126.59.59.59">𝑣</ci><ci id="S3.E5.m1.127.127.127.60.60.60.1.cmml" xref="S3.E5.m1.127.127.127.60.60.60.1">𝑗</ci></apply></apply></apply></apply><apply id="S3.E5.m1.138.138.1.1.1g.cmml" xref="S3.E5.m1.140.140.3.139.69.69.69.3"><eq id="S3.E5.m1.130.130.130.63.63.63.cmml" xref="S3.E5.m1.130.130.130.63.63.63"></eq><share href="https://arxiv.org/html/2410.03462v1#S3.E5.m1.138.138.1.1.1.10.cmml" id="S3.E5.m1.138.138.1.1.1h.cmml" xref="S3.E5.m1.140.140.3.139.69.69.69.3"></share><apply id="S3.E5.m1.138.138.1.1.1.16.cmml" xref="S3.E5.m1.140.140.3.139.69.69.69.3"><times id="S3.E5.m1.138.138.1.1.1.16.1.cmml" xref="S3.E5.m1.140.140.3.139.69.69.69.3"></times><apply id="S3.E5.m1.138.138.1.1.1.16.2.cmml" xref="S3.E5.m1.140.140.3.139.69.69.69.3"><csymbol cd="ambiguous" id="S3.E5.m1.138.138.1.1.1.16.2.1.cmml" xref="S3.E5.m1.140.140.3.139.69.69.69.3">subscript</csymbol><apply id="S3.E5.m1.138.138.1.1.1.16.2.2.cmml" xref="S3.E5.m1.140.140.3.139.69.69.69.3"><csymbol cd="ambiguous" id="S3.E5.m1.138.138.1.1.1.16.2.2.1.cmml" xref="S3.E5.m1.140.140.3.139.69.69.69.3">subscript</csymbol><ci id="S3.E5.m1.131.131.131.64.64.64.cmml" xref="S3.E5.m1.131.131.131.64.64.64">𝒦</ci><ci id="S3.E5.m1.132.132.132.65.65.65.1a.cmml" xref="S3.E5.m1.132.132.132.65.65.65.1"><mtext id="S3.E5.m1.132.132.132.65.65.65.1.cmml" mathsize="70%" xref="S3.E5.m1.132.132.132.65.65.65.1">LR</mtext></ci></apply><apply id="S3.E5.m1.133.133.133.66.66.66.1.cmml" xref="S3.E5.m1.133.133.133.66.66.66.1"><times id="S3.E5.m1.133.133.133.66.66.66.1.1.cmml" xref="S3.E5.m1.133.133.133.66.66.66.1.1"></times><ci id="S3.E5.m1.133.133.133.66.66.66.1.2.cmml" xref="S3.E5.m1.133.133.133.66.66.66.1.2">𝑖</ci><ci id="S3.E5.m1.133.133.133.66.66.66.1.3.cmml" xref="S3.E5.m1.133.133.133.66.66.66.1.3">𝑗</ci></apply></apply><apply id="S3.E5.m1.138.138.1.1.1.16.3.cmml" xref="S3.E5.m1.140.140.3.139.69.69.69.3"><csymbol cd="ambiguous" id="S3.E5.m1.138.138.1.1.1.16.3.1.cmml" xref="S3.E5.m1.140.140.3.139.69.69.69.3">subscript</csymbol><apply id="S3.E5.m1.138.138.1.1.1.16.3.2.cmml" xref="S3.E5.m1.140.140.3.139.69.69.69.3"><csymbol cd="ambiguous" id="S3.E5.m1.138.138.1.1.1.16.3.2.1.cmml" xref="S3.E5.m1.140.140.3.139.69.69.69.3">subscript</csymbol><ci id="S3.E5.m1.134.134.134.67.67.67.cmml" xref="S3.E5.m1.134.134.134.67.67.67">𝐌</ci><ci id="S3.E5.m1.135.135.135.68.68.68.1.cmml" xref="S3.E5.m1.135.135.135.68.68.68.1">𝛼</ci></apply><apply id="S3.E5.m1.136.136.136.69.69.69.1.cmml" xref="S3.E5.m1.136.136.136.69.69.69.1"><times id="S3.E5.m1.136.136.136.69.69.69.1.1.cmml" xref="S3.E5.m1.136.136.136.69.69.69.1.1"></times><ci id="S3.E5.m1.136.136.136.69.69.69.1.2.cmml" xref="S3.E5.m1.136.136.136.69.69.69.1.2">𝑖</ci><ci id="S3.E5.m1.136.136.136.69.69.69.1.3.cmml" xref="S3.E5.m1.136.136.136.69.69.69.1.3">𝑗</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.143c">\begin{multlined}\mathrm{vec}\left(\phi(\mathbf{q}_{i})\otimes\phi_{\mathcal{G%
}}(v_{i})\right)^{\top}\mathrm{vec}\left(\phi(\mathbf{k}_{j})\otimes\phi_{%
\mathcal{G}}(v_{j})\right)=\sum_{s=1}^{mN}\mathrm{vec}\left(\phi(\mathbf{q}_{i%
})\otimes\phi_{\mathcal{G}}(v_{i})\right)_{s}\mathrm{vec}\left(\phi(\mathbf{k}%
_{j})\otimes\phi_{\mathcal{G}}(v_{j})\right)_{s}\vspace{-3mm}\\
=\sum_{k=1}^{m}\sum_{l=1}^{N}\phi(\mathbf{q}_{i})_{k}\phi_{\mathcal{G}}(v_{i})%
_{l}\phi(\mathbf{k}_{j})_{k}\phi_{\mathcal{G}}(v_{j})_{l}=\left(\phi(\mathbf{q%
}_{i})^{\top}\phi(\mathbf{k}_{j})\right)\left(\phi_{\mathcal{G}}(v_{i})^{\top}%
\phi_{\mathcal{G}}(v_{j})\right)={\mathcal{K}_{\textrm{LR}}}_{ij}{\mathbf{M}_{%
\alpha}}_{ij}.\end{multlined}\mathrm{vec}\left(\phi(\mathbf{q}_{i})\otimes\phi%
_{\mathcal{G}}(v_{i})\right)^{\top}\mathrm{vec}\left(\phi(\mathbf{k}_{j})%
\otimes\phi_{\mathcal{G}}(v_{j})\right)=\sum_{s=1}^{mN}\mathrm{vec}\left(\phi(%
\mathbf{q}_{i})\otimes\phi_{\mathcal{G}}(v_{i})\right)_{s}\mathrm{vec}\left(%
\phi(\mathbf{k}_{j})\otimes\phi_{\mathcal{G}}(v_{j})\right)_{s}\vspace{-3mm}\\
=\sum_{k=1}^{m}\sum_{l=1}^{N}\phi(\mathbf{q}_{i})_{k}\phi_{\mathcal{G}}(v_{i})%
_{l}\phi(\mathbf{k}_{j})_{k}\phi_{\mathcal{G}}(v_{j})_{l}=\left(\phi(\mathbf{q%
}_{i})^{\top}\phi(\mathbf{k}_{j})\right)\left(\phi_{\mathcal{G}}(v_{i})^{\top}%
\phi_{\mathcal{G}}(v_{j})\right)={\mathcal{K}_{\textrm{LR}}}_{ij}{\mathbf{M}_{%
\alpha}}_{ij}.</annotation><annotation encoding="application/x-llamapun" id="S3.E5.m1.143d">start_ROW start_CELL roman_vec ( italic_ϕ ( bold_q start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) ⊗ italic_ϕ start_POSTSUBSCRIPT caligraphic_G end_POSTSUBSCRIPT ( italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) ) start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT roman_vec ( italic_ϕ ( bold_k start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) ⊗ italic_ϕ start_POSTSUBSCRIPT caligraphic_G end_POSTSUBSCRIPT ( italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) ) = ∑ start_POSTSUBSCRIPT italic_s = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_m italic_N end_POSTSUPERSCRIPT roman_vec ( italic_ϕ ( bold_q start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) ⊗ italic_ϕ start_POSTSUBSCRIPT caligraphic_G end_POSTSUBSCRIPT ( italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) ) start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT roman_vec ( italic_ϕ ( bold_k start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) ⊗ italic_ϕ start_POSTSUBSCRIPT caligraphic_G end_POSTSUBSCRIPT ( italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) ) start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT end_CELL end_ROW start_ROW start_CELL = ∑ start_POSTSUBSCRIPT italic_k = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_m end_POSTSUPERSCRIPT ∑ start_POSTSUBSCRIPT italic_l = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT italic_ϕ ( bold_q start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT italic_ϕ start_POSTSUBSCRIPT caligraphic_G end_POSTSUBSCRIPT ( italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT italic_ϕ ( bold_k start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT italic_ϕ start_POSTSUBSCRIPT caligraphic_G end_POSTSUBSCRIPT ( italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT = ( italic_ϕ ( bold_q start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT italic_ϕ ( bold_k start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) ) ( italic_ϕ start_POSTSUBSCRIPT caligraphic_G end_POSTSUBSCRIPT ( italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT italic_ϕ start_POSTSUBSCRIPT caligraphic_G end_POSTSUBSCRIPT ( italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) ) = caligraphic_K start_POSTSUBSCRIPT LR end_POSTSUBSCRIPT start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT bold_M start_POSTSUBSCRIPT italic_α end_POSTSUBSCRIPT start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT . end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.p3.13">Hence, taking <math alttext="\{\mathrm{vec}\left(\phi(\left\{\mathbf{q}_{i},\mathbf{k}_{i}\right\})\otimes%
\phi_{\mathcal{G}}(v_{i})\right)\}_{v_{i}\in\mathcal{N}}\subset\mathbb{R}^{mN}" class="ltx_Math" display="inline" id="S3.SS2.p3.11.m1.1"><semantics id="S3.SS2.p3.11.m1.1a"><mrow id="S3.SS2.p3.11.m1.1.1" xref="S3.SS2.p3.11.m1.1.1.cmml"><msub id="S3.SS2.p3.11.m1.1.1.1" xref="S3.SS2.p3.11.m1.1.1.1.cmml"><mrow id="S3.SS2.p3.11.m1.1.1.1.1.1" xref="S3.SS2.p3.11.m1.1.1.1.1.2.cmml"><mo id="S3.SS2.p3.11.m1.1.1.1.1.1.2" stretchy="false" xref="S3.SS2.p3.11.m1.1.1.1.1.2.cmml">{</mo><mrow id="S3.SS2.p3.11.m1.1.1.1.1.1.1" xref="S3.SS2.p3.11.m1.1.1.1.1.1.1.cmml"><mi id="S3.SS2.p3.11.m1.1.1.1.1.1.1.3" xref="S3.SS2.p3.11.m1.1.1.1.1.1.1.3.cmml">vec</mi><mo id="S3.SS2.p3.11.m1.1.1.1.1.1.1.2" xref="S3.SS2.p3.11.m1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.SS2.p3.11.m1.1.1.1.1.1.1.1.1" xref="S3.SS2.p3.11.m1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.SS2.p3.11.m1.1.1.1.1.1.1.1.1.2" xref="S3.SS2.p3.11.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.p3.11.m1.1.1.1.1.1.1.1.1.1" xref="S3.SS2.p3.11.m1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="S3.SS2.p3.11.m1.1.1.1.1.1.1.1.1.1.1" xref="S3.SS2.p3.11.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="S3.SS2.p3.11.m1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.SS2.p3.11.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.SS2.p3.11.m1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.SS2.p3.11.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">ϕ</mi><mo id="S3.SS2.p3.11.m1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.SS2.p3.11.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.SS2.p3.11.m1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.SS2.p3.11.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.SS2.p3.11.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.SS2.p3.11.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.p3.11.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.SS2.p3.11.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mo id="S3.SS2.p3.11.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.SS2.p3.11.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">{</mo><msub id="S3.SS2.p3.11.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.SS2.p3.11.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.SS2.p3.11.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.SS2.p3.11.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">𝐪</mi><mi id="S3.SS2.p3.11.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.SS2.p3.11.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS2.p3.11.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.4" xref="S3.SS2.p3.11.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">,</mo><msub id="S3.SS2.p3.11.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.SS2.p3.11.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml"><mi id="S3.SS2.p3.11.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2" xref="S3.SS2.p3.11.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml">𝐤</mi><mi id="S3.SS2.p3.11.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3" xref="S3.SS2.p3.11.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml">i</mi></msub><mo id="S3.SS2.p3.11.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.5" xref="S3.SS2.p3.11.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">}</mo></mrow><mo id="S3.SS2.p3.11.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="S3.SS2.p3.11.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS2.p3.11.m1.1.1.1.1.1.1.1.1.1.1.2" rspace="0.222em" xref="S3.SS2.p3.11.m1.1.1.1.1.1.1.1.1.1.1.2.cmml">⊗</mo><msub id="S3.SS2.p3.11.m1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.SS2.p3.11.m1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.SS2.p3.11.m1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.SS2.p3.11.m1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">ϕ</mi><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p3.11.m1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.SS2.p3.11.m1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">𝒢</mi></msub></mrow><mo id="S3.SS2.p3.11.m1.1.1.1.1.1.1.1.1.1.3" xref="S3.SS2.p3.11.m1.1.1.1.1.1.1.1.1.1.3.cmml">⁢</mo><mrow id="S3.SS2.p3.11.m1.1.1.1.1.1.1.1.1.1.2.1" xref="S3.SS2.p3.11.m1.1.1.1.1.1.1.1.1.1.2.1.1.cmml"><mo id="S3.SS2.p3.11.m1.1.1.1.1.1.1.1.1.1.2.1.2" stretchy="false" xref="S3.SS2.p3.11.m1.1.1.1.1.1.1.1.1.1.2.1.1.cmml">(</mo><msub id="S3.SS2.p3.11.m1.1.1.1.1.1.1.1.1.1.2.1.1" xref="S3.SS2.p3.11.m1.1.1.1.1.1.1.1.1.1.2.1.1.cmml"><mi id="S3.SS2.p3.11.m1.1.1.1.1.1.1.1.1.1.2.1.1.2" xref="S3.SS2.p3.11.m1.1.1.1.1.1.1.1.1.1.2.1.1.2.cmml">v</mi><mi id="S3.SS2.p3.11.m1.1.1.1.1.1.1.1.1.1.2.1.1.3" xref="S3.SS2.p3.11.m1.1.1.1.1.1.1.1.1.1.2.1.1.3.cmml">i</mi></msub><mo id="S3.SS2.p3.11.m1.1.1.1.1.1.1.1.1.1.2.1.3" stretchy="false" xref="S3.SS2.p3.11.m1.1.1.1.1.1.1.1.1.1.2.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS2.p3.11.m1.1.1.1.1.1.1.1.1.3" xref="S3.SS2.p3.11.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS2.p3.11.m1.1.1.1.1.1.3" stretchy="false" xref="S3.SS2.p3.11.m1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S3.SS2.p3.11.m1.1.1.1.3" xref="S3.SS2.p3.11.m1.1.1.1.3.cmml"><msub id="S3.SS2.p3.11.m1.1.1.1.3.2" xref="S3.SS2.p3.11.m1.1.1.1.3.2.cmml"><mi id="S3.SS2.p3.11.m1.1.1.1.3.2.2" xref="S3.SS2.p3.11.m1.1.1.1.3.2.2.cmml">v</mi><mi id="S3.SS2.p3.11.m1.1.1.1.3.2.3" xref="S3.SS2.p3.11.m1.1.1.1.3.2.3.cmml">i</mi></msub><mo id="S3.SS2.p3.11.m1.1.1.1.3.1" xref="S3.SS2.p3.11.m1.1.1.1.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p3.11.m1.1.1.1.3.3" xref="S3.SS2.p3.11.m1.1.1.1.3.3.cmml">𝒩</mi></mrow></msub><mo id="S3.SS2.p3.11.m1.1.1.2" xref="S3.SS2.p3.11.m1.1.1.2.cmml">⊂</mo><msup id="S3.SS2.p3.11.m1.1.1.3" xref="S3.SS2.p3.11.m1.1.1.3.cmml"><mi id="S3.SS2.p3.11.m1.1.1.3.2" xref="S3.SS2.p3.11.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS2.p3.11.m1.1.1.3.3" xref="S3.SS2.p3.11.m1.1.1.3.3.cmml"><mi id="S3.SS2.p3.11.m1.1.1.3.3.2" xref="S3.SS2.p3.11.m1.1.1.3.3.2.cmml">m</mi><mo id="S3.SS2.p3.11.m1.1.1.3.3.1" xref="S3.SS2.p3.11.m1.1.1.3.3.1.cmml">⁢</mo><mi id="S3.SS2.p3.11.m1.1.1.3.3.3" xref="S3.SS2.p3.11.m1.1.1.3.3.3.cmml">N</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.11.m1.1b"><apply id="S3.SS2.p3.11.m1.1.1.cmml" xref="S3.SS2.p3.11.m1.1.1"><subset id="S3.SS2.p3.11.m1.1.1.2.cmml" xref="S3.SS2.p3.11.m1.1.1.2"></subset><apply id="S3.SS2.p3.11.m1.1.1.1.cmml" xref="S3.SS2.p3.11.m1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.11.m1.1.1.1.2.cmml" xref="S3.SS2.p3.11.m1.1.1.1">subscript</csymbol><set id="S3.SS2.p3.11.m1.1.1.1.1.2.cmml" xref="S3.SS2.p3.11.m1.1.1.1.1.1"><apply id="S3.SS2.p3.11.m1.1.1.1.1.1.1.cmml" xref="S3.SS2.p3.11.m1.1.1.1.1.1.1"><times id="S3.SS2.p3.11.m1.1.1.1.1.1.1.2.cmml" xref="S3.SS2.p3.11.m1.1.1.1.1.1.1.2"></times><ci id="S3.SS2.p3.11.m1.1.1.1.1.1.1.3.cmml" xref="S3.SS2.p3.11.m1.1.1.1.1.1.1.3">vec</ci><apply id="S3.SS2.p3.11.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p3.11.m1.1.1.1.1.1.1.1.1"><times id="S3.SS2.p3.11.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.SS2.p3.11.m1.1.1.1.1.1.1.1.1.1.3"></times><apply id="S3.SS2.p3.11.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p3.11.m1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.SS2.p3.11.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.SS2.p3.11.m1.1.1.1.1.1.1.1.1.1.1.2">tensor-product</csymbol><apply id="S3.SS2.p3.11.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p3.11.m1.1.1.1.1.1.1.1.1.1.1.1"><times id="S3.SS2.p3.11.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.SS2.p3.11.m1.1.1.1.1.1.1.1.1.1.1.1.2"></times><ci id="S3.SS2.p3.11.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.SS2.p3.11.m1.1.1.1.1.1.1.1.1.1.1.1.3">italic-ϕ</ci><set id="S3.SS2.p3.11.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.SS2.p3.11.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2"><apply id="S3.SS2.p3.11.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p3.11.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.11.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p3.11.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.p3.11.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.SS2.p3.11.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2">𝐪</ci><ci id="S3.SS2.p3.11.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.SS2.p3.11.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.SS2.p3.11.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.SS2.p3.11.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.SS2.p3.11.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.SS2.p3.11.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S3.SS2.p3.11.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.SS2.p3.11.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2">𝐤</ci><ci id="S3.SS2.p3.11.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.SS2.p3.11.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3">𝑖</ci></apply></set></apply><apply id="S3.SS2.p3.11.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.SS2.p3.11.m1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p3.11.m1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.SS2.p3.11.m1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS2.p3.11.m1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.SS2.p3.11.m1.1.1.1.1.1.1.1.1.1.1.3.2">italic-ϕ</ci><ci id="S3.SS2.p3.11.m1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.SS2.p3.11.m1.1.1.1.1.1.1.1.1.1.1.3.3">𝒢</ci></apply></apply><apply id="S3.SS2.p3.11.m1.1.1.1.1.1.1.1.1.1.2.1.1.cmml" xref="S3.SS2.p3.11.m1.1.1.1.1.1.1.1.1.1.2.1"><csymbol cd="ambiguous" id="S3.SS2.p3.11.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.cmml" xref="S3.SS2.p3.11.m1.1.1.1.1.1.1.1.1.1.2.1">subscript</csymbol><ci id="S3.SS2.p3.11.m1.1.1.1.1.1.1.1.1.1.2.1.1.2.cmml" xref="S3.SS2.p3.11.m1.1.1.1.1.1.1.1.1.1.2.1.1.2">𝑣</ci><ci id="S3.SS2.p3.11.m1.1.1.1.1.1.1.1.1.1.2.1.1.3.cmml" xref="S3.SS2.p3.11.m1.1.1.1.1.1.1.1.1.1.2.1.1.3">𝑖</ci></apply></apply></apply></set><apply id="S3.SS2.p3.11.m1.1.1.1.3.cmml" xref="S3.SS2.p3.11.m1.1.1.1.3"><in id="S3.SS2.p3.11.m1.1.1.1.3.1.cmml" xref="S3.SS2.p3.11.m1.1.1.1.3.1"></in><apply id="S3.SS2.p3.11.m1.1.1.1.3.2.cmml" xref="S3.SS2.p3.11.m1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.SS2.p3.11.m1.1.1.1.3.2.1.cmml" xref="S3.SS2.p3.11.m1.1.1.1.3.2">subscript</csymbol><ci id="S3.SS2.p3.11.m1.1.1.1.3.2.2.cmml" xref="S3.SS2.p3.11.m1.1.1.1.3.2.2">𝑣</ci><ci id="S3.SS2.p3.11.m1.1.1.1.3.2.3.cmml" xref="S3.SS2.p3.11.m1.1.1.1.3.2.3">𝑖</ci></apply><ci id="S3.SS2.p3.11.m1.1.1.1.3.3.cmml" xref="S3.SS2.p3.11.m1.1.1.1.3.3">𝒩</ci></apply></apply><apply id="S3.SS2.p3.11.m1.1.1.3.cmml" xref="S3.SS2.p3.11.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p3.11.m1.1.1.3.1.cmml" xref="S3.SS2.p3.11.m1.1.1.3">superscript</csymbol><ci id="S3.SS2.p3.11.m1.1.1.3.2.cmml" xref="S3.SS2.p3.11.m1.1.1.3.2">ℝ</ci><apply id="S3.SS2.p3.11.m1.1.1.3.3.cmml" xref="S3.SS2.p3.11.m1.1.1.3.3"><times id="S3.SS2.p3.11.m1.1.1.3.3.1.cmml" xref="S3.SS2.p3.11.m1.1.1.3.3.1"></times><ci id="S3.SS2.p3.11.m1.1.1.3.3.2.cmml" xref="S3.SS2.p3.11.m1.1.1.3.3.2">𝑚</ci><ci id="S3.SS2.p3.11.m1.1.1.3.3.3.cmml" xref="S3.SS2.p3.11.m1.1.1.3.3.3">𝑁</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.11.m1.1c">\{\mathrm{vec}\left(\phi(\left\{\mathbf{q}_{i},\mathbf{k}_{i}\right\})\otimes%
\phi_{\mathcal{G}}(v_{i})\right)\}_{v_{i}\in\mathcal{N}}\subset\mathbb{R}^{mN}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.11.m1.1d">{ roman_vec ( italic_ϕ ( { bold_q start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , bold_k start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT } ) ⊗ italic_ϕ start_POSTSUBSCRIPT caligraphic_G end_POSTSUBSCRIPT ( italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) ) } start_POSTSUBSCRIPT italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∈ caligraphic_N end_POSTSUBSCRIPT ⊂ blackboard_R start_POSTSUPERSCRIPT italic_m italic_N end_POSTSUPERSCRIPT</annotation></semantics></math> as features, we can compute masked attention implicitly, without materialising <math alttext="\mathbf{A}" class="ltx_Math" display="inline" id="S3.SS2.p3.12.m2.1"><semantics id="S3.SS2.p3.12.m2.1a"><mi id="S3.SS2.p3.12.m2.1.1" xref="S3.SS2.p3.12.m2.1.1.cmml">𝐀</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.12.m2.1b"><ci id="S3.SS2.p3.12.m2.1.1.cmml" xref="S3.SS2.p3.12.m2.1.1">𝐀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.12.m2.1c">\mathbf{A}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.12.m2.1d">bold_A</annotation></semantics></math> and <math alttext="\mathbf{M}_{\alpha}" class="ltx_Math" display="inline" id="S3.SS2.p3.13.m3.1"><semantics id="S3.SS2.p3.13.m3.1a"><msub id="S3.SS2.p3.13.m3.1.1" xref="S3.SS2.p3.13.m3.1.1.cmml"><mi id="S3.SS2.p3.13.m3.1.1.2" xref="S3.SS2.p3.13.m3.1.1.2.cmml">𝐌</mi><mi id="S3.SS2.p3.13.m3.1.1.3" xref="S3.SS2.p3.13.m3.1.1.3.cmml">α</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.13.m3.1b"><apply id="S3.SS2.p3.13.m3.1.1.cmml" xref="S3.SS2.p3.13.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.13.m3.1.1.1.cmml" xref="S3.SS2.p3.13.m3.1.1">subscript</csymbol><ci id="S3.SS2.p3.13.m3.1.1.2.cmml" xref="S3.SS2.p3.13.m3.1.1.2">𝐌</ci><ci id="S3.SS2.p3.13.m3.1.1.3.cmml" xref="S3.SS2.p3.13.m3.1.1.3">𝛼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.13.m3.1c">\mathbf{M}_{\alpha}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.13.m3.1d">bold_M start_POSTSUBSCRIPT italic_α end_POSTSUBSCRIPT</annotation></semantics></math>.
Concretely, we have that:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equation ltx_eqn_table" id="S3.E6">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{\Phi}_{\mathbf{Q},\mathcal{G}}\mathbf{\Phi}_{\mathbf{K},\mathcal{G}}^{%
\top}=\mathcal{K}_{\textrm{LR}}\odot\mathbf{M}_{\alpha}\quad\textrm{if}\quad%
\mathbf{\Phi}_{\{\mathbf{Q},\mathbf{K}\},\mathcal{G}}\coloneqq\left[\mathrm{%
vec}\left(\phi(\left\{\mathbf{q}_{i},\mathbf{k}_{i}\right\})\otimes\phi_{%
\mathcal{G}}(v_{i})\right)\right]_{i=1}^{N}\in\mathbb{R}^{N\times Nm}." class="ltx_Math" display="block" id="S3.E6.m1.10"><semantics id="S3.E6.m1.10a"><mrow id="S3.E6.m1.10.10.1"><mrow id="S3.E6.m1.10.10.1.1.2" xref="S3.E6.m1.10.10.1.1.3.cmml"><mrow id="S3.E6.m1.10.10.1.1.1.1" xref="S3.E6.m1.10.10.1.1.1.1.cmml"><mrow id="S3.E6.m1.10.10.1.1.1.1.3" xref="S3.E6.m1.10.10.1.1.1.1.3.cmml"><msub id="S3.E6.m1.10.10.1.1.1.1.3.2" xref="S3.E6.m1.10.10.1.1.1.1.3.2.cmml"><mi id="S3.E6.m1.10.10.1.1.1.1.3.2.2" xref="S3.E6.m1.10.10.1.1.1.1.3.2.2.cmml">𝚽</mi><mrow id="S3.E6.m1.2.2.2.4" xref="S3.E6.m1.2.2.2.3.cmml"><mi id="S3.E6.m1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.cmml">𝐐</mi><mo id="S3.E6.m1.2.2.2.4.1" xref="S3.E6.m1.2.2.2.3.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S3.E6.m1.2.2.2.2" xref="S3.E6.m1.2.2.2.2.cmml">𝒢</mi></mrow></msub><mo id="S3.E6.m1.10.10.1.1.1.1.3.1" xref="S3.E6.m1.10.10.1.1.1.1.3.1.cmml">⁢</mo><msubsup id="S3.E6.m1.10.10.1.1.1.1.3.3" xref="S3.E6.m1.10.10.1.1.1.1.3.3.cmml"><mi id="S3.E6.m1.10.10.1.1.1.1.3.3.2.2" xref="S3.E6.m1.10.10.1.1.1.1.3.3.2.2.cmml">𝚽</mi><mrow id="S3.E6.m1.4.4.2.4" xref="S3.E6.m1.4.4.2.3.cmml"><mi id="S3.E6.m1.3.3.1.1" xref="S3.E6.m1.3.3.1.1.cmml">𝐊</mi><mo id="S3.E6.m1.4.4.2.4.1" xref="S3.E6.m1.4.4.2.3.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S3.E6.m1.4.4.2.2" xref="S3.E6.m1.4.4.2.2.cmml">𝒢</mi></mrow><mo id="S3.E6.m1.10.10.1.1.1.1.3.3.3" xref="S3.E6.m1.10.10.1.1.1.1.3.3.3.cmml">⊤</mo></msubsup></mrow><mo id="S3.E6.m1.10.10.1.1.1.1.2" xref="S3.E6.m1.10.10.1.1.1.1.2.cmml">=</mo><mrow id="S3.E6.m1.10.10.1.1.1.1.1.1" xref="S3.E6.m1.10.10.1.1.1.1.1.2.cmml"><mrow id="S3.E6.m1.10.10.1.1.1.1.1.1.1" xref="S3.E6.m1.10.10.1.1.1.1.1.1.1.cmml"><msub id="S3.E6.m1.10.10.1.1.1.1.1.1.1.2" xref="S3.E6.m1.10.10.1.1.1.1.1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E6.m1.10.10.1.1.1.1.1.1.1.2.2" xref="S3.E6.m1.10.10.1.1.1.1.1.1.1.2.2.cmml">𝒦</mi><mtext id="S3.E6.m1.10.10.1.1.1.1.1.1.1.2.3" xref="S3.E6.m1.10.10.1.1.1.1.1.1.1.2.3a.cmml">LR</mtext></msub><mo id="S3.E6.m1.10.10.1.1.1.1.1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.E6.m1.10.10.1.1.1.1.1.1.1.1.cmml">⊙</mo><msub id="S3.E6.m1.10.10.1.1.1.1.1.1.1.3" xref="S3.E6.m1.10.10.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E6.m1.10.10.1.1.1.1.1.1.1.3.2" xref="S3.E6.m1.10.10.1.1.1.1.1.1.1.3.2.cmml">𝐌</mi><mi id="S3.E6.m1.10.10.1.1.1.1.1.1.1.3.3" xref="S3.E6.m1.10.10.1.1.1.1.1.1.1.3.3.cmml">α</mi></msub></mrow><mspace id="S3.E6.m1.10.10.1.1.1.1.1.1.2" width="1em" xref="S3.E6.m1.10.10.1.1.1.1.1.2.cmml"></mspace><mtext id="S3.E6.m1.9.9" xref="S3.E6.m1.9.9a.cmml">if</mtext></mrow></mrow><mspace id="S3.E6.m1.10.10.1.1.2.3" width="1em" xref="S3.E6.m1.10.10.1.1.3a.cmml"></mspace><mrow id="S3.E6.m1.10.10.1.1.2.2" xref="S3.E6.m1.10.10.1.1.2.2.cmml"><msub id="S3.E6.m1.10.10.1.1.2.2.3" xref="S3.E6.m1.10.10.1.1.2.2.3.cmml"><mi id="S3.E6.m1.10.10.1.1.2.2.3.2" xref="S3.E6.m1.10.10.1.1.2.2.3.2.cmml">𝚽</mi><mrow id="S3.E6.m1.8.8.4.4" xref="S3.E6.m1.8.8.4.5.cmml"><mrow id="S3.E6.m1.8.8.4.4.1.2" xref="S3.E6.m1.8.8.4.4.1.1.cmml"><mo id="S3.E6.m1.8.8.4.4.1.2.1" stretchy="false" xref="S3.E6.m1.8.8.4.4.1.1.cmml">{</mo><mi id="S3.E6.m1.5.5.1.1" xref="S3.E6.m1.5.5.1.1.cmml">𝐐</mi><mo id="S3.E6.m1.8.8.4.4.1.2.2" xref="S3.E6.m1.8.8.4.4.1.1.cmml">,</mo><mi id="S3.E6.m1.6.6.2.2" xref="S3.E6.m1.6.6.2.2.cmml">𝐊</mi><mo id="S3.E6.m1.8.8.4.4.1.2.3" stretchy="false" xref="S3.E6.m1.8.8.4.4.1.1.cmml">}</mo></mrow><mo id="S3.E6.m1.8.8.4.4.2" xref="S3.E6.m1.8.8.4.5.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S3.E6.m1.7.7.3.3" xref="S3.E6.m1.7.7.3.3.cmml">𝒢</mi></mrow></msub><mo id="S3.E6.m1.10.10.1.1.2.2.4" xref="S3.E6.m1.10.10.1.1.2.2.4.cmml">≔</mo><msubsup id="S3.E6.m1.10.10.1.1.2.2.1" xref="S3.E6.m1.10.10.1.1.2.2.1.cmml"><mrow id="S3.E6.m1.10.10.1.1.2.2.1.1.1.1" xref="S3.E6.m1.10.10.1.1.2.2.1.1.1.2.cmml"><mo id="S3.E6.m1.10.10.1.1.2.2.1.1.1.1.2" xref="S3.E6.m1.10.10.1.1.2.2.1.1.1.2.1.cmml">[</mo><mrow id="S3.E6.m1.10.10.1.1.2.2.1.1.1.1.1" xref="S3.E6.m1.10.10.1.1.2.2.1.1.1.1.1.cmml"><mi id="S3.E6.m1.10.10.1.1.2.2.1.1.1.1.1.3" xref="S3.E6.m1.10.10.1.1.2.2.1.1.1.1.1.3.cmml">vec</mi><mo id="S3.E6.m1.10.10.1.1.2.2.1.1.1.1.1.2" xref="S3.E6.m1.10.10.1.1.2.2.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E6.m1.10.10.1.1.2.2.1.1.1.1.1.1.1" xref="S3.E6.m1.10.10.1.1.2.2.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E6.m1.10.10.1.1.2.2.1.1.1.1.1.1.1.2" xref="S3.E6.m1.10.10.1.1.2.2.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E6.m1.10.10.1.1.2.2.1.1.1.1.1.1.1.1" xref="S3.E6.m1.10.10.1.1.2.2.1.1.1.1.1.1.1.1.cmml"><mrow id="S3.E6.m1.10.10.1.1.2.2.1.1.1.1.1.1.1.1.1" xref="S3.E6.m1.10.10.1.1.2.2.1.1.1.1.1.1.1.1.1.cmml"><mrow id="S3.E6.m1.10.10.1.1.2.2.1.1.1.1.1.1.1.1.1.1" xref="S3.E6.m1.10.10.1.1.2.2.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E6.m1.10.10.1.1.2.2.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E6.m1.10.10.1.1.2.2.1.1.1.1.1.1.1.1.1.1.3.cmml">ϕ</mi><mo id="S3.E6.m1.10.10.1.1.2.2.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E6.m1.10.10.1.1.2.2.1.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E6.m1.10.10.1.1.2.2.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E6.m1.10.10.1.1.2.2.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E6.m1.10.10.1.1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E6.m1.10.10.1.1.2.2.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E6.m1.10.10.1.1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E6.m1.10.10.1.1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mo id="S3.E6.m1.10.10.1.1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E6.m1.10.10.1.1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">{</mo><msub id="S3.E6.m1.10.10.1.1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E6.m1.10.10.1.1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E6.m1.10.10.1.1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E6.m1.10.10.1.1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">𝐪</mi><mi id="S3.E6.m1.10.10.1.1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E6.m1.10.10.1.1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E6.m1.10.10.1.1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.2.4" xref="S3.E6.m1.10.10.1.1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">,</mo><msub id="S3.E6.m1.10.10.1.1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E6.m1.10.10.1.1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml"><mi id="S3.E6.m1.10.10.1.1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2" xref="S3.E6.m1.10.10.1.1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml">𝐤</mi><mi id="S3.E6.m1.10.10.1.1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3" xref="S3.E6.m1.10.10.1.1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml">i</mi></msub><mo id="S3.E6.m1.10.10.1.1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.2.5" xref="S3.E6.m1.10.10.1.1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">}</mo></mrow><mo id="S3.E6.m1.10.10.1.1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="S3.E6.m1.10.10.1.1.2.2.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E6.m1.10.10.1.1.2.2.1.1.1.1.1.1.1.1.1.2" rspace="0.222em" xref="S3.E6.m1.10.10.1.1.2.2.1.1.1.1.1.1.1.1.1.2.cmml">⊗</mo><msub id="S3.E6.m1.10.10.1.1.2.2.1.1.1.1.1.1.1.1.1.3" xref="S3.E6.m1.10.10.1.1.2.2.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E6.m1.10.10.1.1.2.2.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E6.m1.10.10.1.1.2.2.1.1.1.1.1.1.1.1.1.3.2.cmml">ϕ</mi><mi class="ltx_font_mathcaligraphic" id="S3.E6.m1.10.10.1.1.2.2.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E6.m1.10.10.1.1.2.2.1.1.1.1.1.1.1.1.1.3.3.cmml">𝒢</mi></msub></mrow><mo id="S3.E6.m1.10.10.1.1.2.2.1.1.1.1.1.1.1.1.3" xref="S3.E6.m1.10.10.1.1.2.2.1.1.1.1.1.1.1.1.3.cmml">⁢</mo><mrow id="S3.E6.m1.10.10.1.1.2.2.1.1.1.1.1.1.1.1.2.1" xref="S3.E6.m1.10.10.1.1.2.2.1.1.1.1.1.1.1.1.2.1.1.cmml"><mo id="S3.E6.m1.10.10.1.1.2.2.1.1.1.1.1.1.1.1.2.1.2" stretchy="false" xref="S3.E6.m1.10.10.1.1.2.2.1.1.1.1.1.1.1.1.2.1.1.cmml">(</mo><msub id="S3.E6.m1.10.10.1.1.2.2.1.1.1.1.1.1.1.1.2.1.1" xref="S3.E6.m1.10.10.1.1.2.2.1.1.1.1.1.1.1.1.2.1.1.cmml"><mi id="S3.E6.m1.10.10.1.1.2.2.1.1.1.1.1.1.1.1.2.1.1.2" xref="S3.E6.m1.10.10.1.1.2.2.1.1.1.1.1.1.1.1.2.1.1.2.cmml">v</mi><mi id="S3.E6.m1.10.10.1.1.2.2.1.1.1.1.1.1.1.1.2.1.1.3" xref="S3.E6.m1.10.10.1.1.2.2.1.1.1.1.1.1.1.1.2.1.1.3.cmml">i</mi></msub><mo id="S3.E6.m1.10.10.1.1.2.2.1.1.1.1.1.1.1.1.2.1.3" stretchy="false" xref="S3.E6.m1.10.10.1.1.2.2.1.1.1.1.1.1.1.1.2.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E6.m1.10.10.1.1.2.2.1.1.1.1.1.1.1.3" xref="S3.E6.m1.10.10.1.1.2.2.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E6.m1.10.10.1.1.2.2.1.1.1.1.3" xref="S3.E6.m1.10.10.1.1.2.2.1.1.1.2.1.cmml">]</mo></mrow><mrow id="S3.E6.m1.10.10.1.1.2.2.1.1.3" xref="S3.E6.m1.10.10.1.1.2.2.1.1.3.cmml"><mi id="S3.E6.m1.10.10.1.1.2.2.1.1.3.2" xref="S3.E6.m1.10.10.1.1.2.2.1.1.3.2.cmml">i</mi><mo id="S3.E6.m1.10.10.1.1.2.2.1.1.3.1" xref="S3.E6.m1.10.10.1.1.2.2.1.1.3.1.cmml">=</mo><mn id="S3.E6.m1.10.10.1.1.2.2.1.1.3.3" xref="S3.E6.m1.10.10.1.1.2.2.1.1.3.3.cmml">1</mn></mrow><mi id="S3.E6.m1.10.10.1.1.2.2.1.3" xref="S3.E6.m1.10.10.1.1.2.2.1.3.cmml">N</mi></msubsup><mo id="S3.E6.m1.10.10.1.1.2.2.5" xref="S3.E6.m1.10.10.1.1.2.2.5.cmml">∈</mo><msup id="S3.E6.m1.10.10.1.1.2.2.6" xref="S3.E6.m1.10.10.1.1.2.2.6.cmml"><mi id="S3.E6.m1.10.10.1.1.2.2.6.2" xref="S3.E6.m1.10.10.1.1.2.2.6.2.cmml">ℝ</mi><mrow id="S3.E6.m1.10.10.1.1.2.2.6.3" xref="S3.E6.m1.10.10.1.1.2.2.6.3.cmml"><mrow id="S3.E6.m1.10.10.1.1.2.2.6.3.2" xref="S3.E6.m1.10.10.1.1.2.2.6.3.2.cmml"><mi id="S3.E6.m1.10.10.1.1.2.2.6.3.2.2" xref="S3.E6.m1.10.10.1.1.2.2.6.3.2.2.cmml">N</mi><mo id="S3.E6.m1.10.10.1.1.2.2.6.3.2.1" lspace="0.222em" rspace="0.222em" xref="S3.E6.m1.10.10.1.1.2.2.6.3.2.1.cmml">×</mo><mi id="S3.E6.m1.10.10.1.1.2.2.6.3.2.3" xref="S3.E6.m1.10.10.1.1.2.2.6.3.2.3.cmml">N</mi></mrow><mo id="S3.E6.m1.10.10.1.1.2.2.6.3.1" xref="S3.E6.m1.10.10.1.1.2.2.6.3.1.cmml">⁢</mo><mi id="S3.E6.m1.10.10.1.1.2.2.6.3.3" xref="S3.E6.m1.10.10.1.1.2.2.6.3.3.cmml">m</mi></mrow></msup></mrow></mrow><mo id="S3.E6.m1.10.10.1.2" lspace="0em">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E6.m1.10b"><apply id="S3.E6.m1.10.10.1.1.3.cmml" xref="S3.E6.m1.10.10.1.1.2"><csymbol cd="ambiguous" id="S3.E6.m1.10.10.1.1.3a.cmml" xref="S3.E6.m1.10.10.1.1.2.3">formulae-sequence</csymbol><apply id="S3.E6.m1.10.10.1.1.1.1.cmml" xref="S3.E6.m1.10.10.1.1.1.1"><eq id="S3.E6.m1.10.10.1.1.1.1.2.cmml" xref="S3.E6.m1.10.10.1.1.1.1.2"></eq><apply id="S3.E6.m1.10.10.1.1.1.1.3.cmml" xref="S3.E6.m1.10.10.1.1.1.1.3"><times id="S3.E6.m1.10.10.1.1.1.1.3.1.cmml" xref="S3.E6.m1.10.10.1.1.1.1.3.1"></times><apply id="S3.E6.m1.10.10.1.1.1.1.3.2.cmml" xref="S3.E6.m1.10.10.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E6.m1.10.10.1.1.1.1.3.2.1.cmml" xref="S3.E6.m1.10.10.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E6.m1.10.10.1.1.1.1.3.2.2.cmml" xref="S3.E6.m1.10.10.1.1.1.1.3.2.2">𝚽</ci><list id="S3.E6.m1.2.2.2.3.cmml" xref="S3.E6.m1.2.2.2.4"><ci id="S3.E6.m1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1">𝐐</ci><ci id="S3.E6.m1.2.2.2.2.cmml" xref="S3.E6.m1.2.2.2.2">𝒢</ci></list></apply><apply id="S3.E6.m1.10.10.1.1.1.1.3.3.cmml" xref="S3.E6.m1.10.10.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E6.m1.10.10.1.1.1.1.3.3.1.cmml" xref="S3.E6.m1.10.10.1.1.1.1.3.3">superscript</csymbol><apply id="S3.E6.m1.10.10.1.1.1.1.3.3.2.cmml" xref="S3.E6.m1.10.10.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E6.m1.10.10.1.1.1.1.3.3.2.1.cmml" xref="S3.E6.m1.10.10.1.1.1.1.3.3">subscript</csymbol><ci id="S3.E6.m1.10.10.1.1.1.1.3.3.2.2.cmml" xref="S3.E6.m1.10.10.1.1.1.1.3.3.2.2">𝚽</ci><list id="S3.E6.m1.4.4.2.3.cmml" xref="S3.E6.m1.4.4.2.4"><ci id="S3.E6.m1.3.3.1.1.cmml" xref="S3.E6.m1.3.3.1.1">𝐊</ci><ci id="S3.E6.m1.4.4.2.2.cmml" xref="S3.E6.m1.4.4.2.2">𝒢</ci></list></apply><csymbol cd="latexml" id="S3.E6.m1.10.10.1.1.1.1.3.3.3.cmml" xref="S3.E6.m1.10.10.1.1.1.1.3.3.3">top</csymbol></apply></apply><list id="S3.E6.m1.10.10.1.1.1.1.1.2.cmml" xref="S3.E6.m1.10.10.1.1.1.1.1.1"><apply id="S3.E6.m1.10.10.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.10.10.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E6.m1.10.10.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.10.10.1.1.1.1.1.1.1.1">direct-product</csymbol><apply id="S3.E6.m1.10.10.1.1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.10.10.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E6.m1.10.10.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E6.m1.10.10.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E6.m1.10.10.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E6.m1.10.10.1.1.1.1.1.1.1.2.2">𝒦</ci><ci id="S3.E6.m1.10.10.1.1.1.1.1.1.1.2.3a.cmml" xref="S3.E6.m1.10.10.1.1.1.1.1.1.1.2.3"><mtext id="S3.E6.m1.10.10.1.1.1.1.1.1.1.2.3.cmml" mathsize="70%" xref="S3.E6.m1.10.10.1.1.1.1.1.1.1.2.3">LR</mtext></ci></apply><apply id="S3.E6.m1.10.10.1.1.1.1.1.1.1.3.cmml" xref="S3.E6.m1.10.10.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.10.10.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E6.m1.10.10.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E6.m1.10.10.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E6.m1.10.10.1.1.1.1.1.1.1.3.2">𝐌</ci><ci id="S3.E6.m1.10.10.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E6.m1.10.10.1.1.1.1.1.1.1.3.3">𝛼</ci></apply></apply><ci id="S3.E6.m1.9.9a.cmml" xref="S3.E6.m1.9.9"><mtext id="S3.E6.m1.9.9.cmml" xref="S3.E6.m1.9.9">if</mtext></ci></list></apply><apply id="S3.E6.m1.10.10.1.1.2.2.cmml" xref="S3.E6.m1.10.10.1.1.2.2"><and id="S3.E6.m1.10.10.1.1.2.2a.cmml" xref="S3.E6.m1.10.10.1.1.2.2"></and><apply id="S3.E6.m1.10.10.1.1.2.2b.cmml" xref="S3.E6.m1.10.10.1.1.2.2"><ci id="S3.E6.m1.10.10.1.1.2.2.4.cmml" xref="S3.E6.m1.10.10.1.1.2.2.4">≔</ci><apply id="S3.E6.m1.10.10.1.1.2.2.3.cmml" xref="S3.E6.m1.10.10.1.1.2.2.3"><csymbol cd="ambiguous" id="S3.E6.m1.10.10.1.1.2.2.3.1.cmml" xref="S3.E6.m1.10.10.1.1.2.2.3">subscript</csymbol><ci id="S3.E6.m1.10.10.1.1.2.2.3.2.cmml" xref="S3.E6.m1.10.10.1.1.2.2.3.2">𝚽</ci><list id="S3.E6.m1.8.8.4.5.cmml" xref="S3.E6.m1.8.8.4.4"><set id="S3.E6.m1.8.8.4.4.1.1.cmml" xref="S3.E6.m1.8.8.4.4.1.2"><ci id="S3.E6.m1.5.5.1.1.cmml" xref="S3.E6.m1.5.5.1.1">𝐐</ci><ci id="S3.E6.m1.6.6.2.2.cmml" xref="S3.E6.m1.6.6.2.2">𝐊</ci></set><ci id="S3.E6.m1.7.7.3.3.cmml" xref="S3.E6.m1.7.7.3.3">𝒢</ci></list></apply><apply id="S3.E6.m1.10.10.1.1.2.2.1.cmml" xref="S3.E6.m1.10.10.1.1.2.2.1"><csymbol cd="ambiguous" id="S3.E6.m1.10.10.1.1.2.2.1.2.cmml" xref="S3.E6.m1.10.10.1.1.2.2.1">superscript</csymbol><apply id="S3.E6.m1.10.10.1.1.2.2.1.1.cmml" xref="S3.E6.m1.10.10.1.1.2.2.1"><csymbol cd="ambiguous" id="S3.E6.m1.10.10.1.1.2.2.1.1.2.cmml" xref="S3.E6.m1.10.10.1.1.2.2.1">subscript</csymbol><apply id="S3.E6.m1.10.10.1.1.2.2.1.1.1.2.cmml" xref="S3.E6.m1.10.10.1.1.2.2.1.1.1.1"><csymbol cd="latexml" id="S3.E6.m1.10.10.1.1.2.2.1.1.1.2.1.cmml" xref="S3.E6.m1.10.10.1.1.2.2.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.E6.m1.10.10.1.1.2.2.1.1.1.1.1.cmml" xref="S3.E6.m1.10.10.1.1.2.2.1.1.1.1.1"><times id="S3.E6.m1.10.10.1.1.2.2.1.1.1.1.1.2.cmml" xref="S3.E6.m1.10.10.1.1.2.2.1.1.1.1.1.2"></times><ci id="S3.E6.m1.10.10.1.1.2.2.1.1.1.1.1.3.cmml" xref="S3.E6.m1.10.10.1.1.2.2.1.1.1.1.1.3">vec</ci><apply id="S3.E6.m1.10.10.1.1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.10.10.1.1.2.2.1.1.1.1.1.1.1"><times id="S3.E6.m1.10.10.1.1.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E6.m1.10.10.1.1.2.2.1.1.1.1.1.1.1.1.3"></times><apply id="S3.E6.m1.10.10.1.1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.10.10.1.1.2.2.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E6.m1.10.10.1.1.2.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.10.10.1.1.2.2.1.1.1.1.1.1.1.1.1.2">tensor-product</csymbol><apply id="S3.E6.m1.10.10.1.1.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.10.10.1.1.2.2.1.1.1.1.1.1.1.1.1.1"><times id="S3.E6.m1.10.10.1.1.2.2.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.10.10.1.1.2.2.1.1.1.1.1.1.1.1.1.1.2"></times><ci id="S3.E6.m1.10.10.1.1.2.2.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E6.m1.10.10.1.1.2.2.1.1.1.1.1.1.1.1.1.1.3">italic-ϕ</ci><set id="S3.E6.m1.10.10.1.1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E6.m1.10.10.1.1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.2"><apply id="S3.E6.m1.10.10.1.1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.10.10.1.1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.10.10.1.1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.10.10.1.1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E6.m1.10.10.1.1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.10.10.1.1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2">𝐪</ci><ci id="S3.E6.m1.10.10.1.1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E6.m1.10.10.1.1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.E6.m1.10.10.1.1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E6.m1.10.10.1.1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E6.m1.10.10.1.1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E6.m1.10.10.1.1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S3.E6.m1.10.10.1.1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E6.m1.10.10.1.1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2">𝐤</ci><ci id="S3.E6.m1.10.10.1.1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E6.m1.10.10.1.1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3">𝑖</ci></apply></set></apply><apply id="S3.E6.m1.10.10.1.1.2.2.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E6.m1.10.10.1.1.2.2.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.10.10.1.1.2.2.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E6.m1.10.10.1.1.2.2.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E6.m1.10.10.1.1.2.2.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E6.m1.10.10.1.1.2.2.1.1.1.1.1.1.1.1.1.3.2">italic-ϕ</ci><ci id="S3.E6.m1.10.10.1.1.2.2.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E6.m1.10.10.1.1.2.2.1.1.1.1.1.1.1.1.1.3.3">𝒢</ci></apply></apply><apply id="S3.E6.m1.10.10.1.1.2.2.1.1.1.1.1.1.1.1.2.1.1.cmml" xref="S3.E6.m1.10.10.1.1.2.2.1.1.1.1.1.1.1.1.2.1"><csymbol cd="ambiguous" id="S3.E6.m1.10.10.1.1.2.2.1.1.1.1.1.1.1.1.2.1.1.1.cmml" xref="S3.E6.m1.10.10.1.1.2.2.1.1.1.1.1.1.1.1.2.1">subscript</csymbol><ci id="S3.E6.m1.10.10.1.1.2.2.1.1.1.1.1.1.1.1.2.1.1.2.cmml" xref="S3.E6.m1.10.10.1.1.2.2.1.1.1.1.1.1.1.1.2.1.1.2">𝑣</ci><ci id="S3.E6.m1.10.10.1.1.2.2.1.1.1.1.1.1.1.1.2.1.1.3.cmml" xref="S3.E6.m1.10.10.1.1.2.2.1.1.1.1.1.1.1.1.2.1.1.3">𝑖</ci></apply></apply></apply></apply><apply id="S3.E6.m1.10.10.1.1.2.2.1.1.3.cmml" xref="S3.E6.m1.10.10.1.1.2.2.1.1.3"><eq id="S3.E6.m1.10.10.1.1.2.2.1.1.3.1.cmml" xref="S3.E6.m1.10.10.1.1.2.2.1.1.3.1"></eq><ci id="S3.E6.m1.10.10.1.1.2.2.1.1.3.2.cmml" xref="S3.E6.m1.10.10.1.1.2.2.1.1.3.2">𝑖</ci><cn id="S3.E6.m1.10.10.1.1.2.2.1.1.3.3.cmml" type="integer" xref="S3.E6.m1.10.10.1.1.2.2.1.1.3.3">1</cn></apply></apply><ci id="S3.E6.m1.10.10.1.1.2.2.1.3.cmml" xref="S3.E6.m1.10.10.1.1.2.2.1.3">𝑁</ci></apply></apply><apply id="S3.E6.m1.10.10.1.1.2.2c.cmml" xref="S3.E6.m1.10.10.1.1.2.2"><in id="S3.E6.m1.10.10.1.1.2.2.5.cmml" xref="S3.E6.m1.10.10.1.1.2.2.5"></in><share href="https://arxiv.org/html/2410.03462v1#S3.E6.m1.10.10.1.1.2.2.1.cmml" id="S3.E6.m1.10.10.1.1.2.2d.cmml" xref="S3.E6.m1.10.10.1.1.2.2"></share><apply id="S3.E6.m1.10.10.1.1.2.2.6.cmml" xref="S3.E6.m1.10.10.1.1.2.2.6"><csymbol cd="ambiguous" id="S3.E6.m1.10.10.1.1.2.2.6.1.cmml" xref="S3.E6.m1.10.10.1.1.2.2.6">superscript</csymbol><ci id="S3.E6.m1.10.10.1.1.2.2.6.2.cmml" xref="S3.E6.m1.10.10.1.1.2.2.6.2">ℝ</ci><apply id="S3.E6.m1.10.10.1.1.2.2.6.3.cmml" xref="S3.E6.m1.10.10.1.1.2.2.6.3"><times id="S3.E6.m1.10.10.1.1.2.2.6.3.1.cmml" xref="S3.E6.m1.10.10.1.1.2.2.6.3.1"></times><apply id="S3.E6.m1.10.10.1.1.2.2.6.3.2.cmml" xref="S3.E6.m1.10.10.1.1.2.2.6.3.2"><times id="S3.E6.m1.10.10.1.1.2.2.6.3.2.1.cmml" xref="S3.E6.m1.10.10.1.1.2.2.6.3.2.1"></times><ci id="S3.E6.m1.10.10.1.1.2.2.6.3.2.2.cmml" xref="S3.E6.m1.10.10.1.1.2.2.6.3.2.2">𝑁</ci><ci id="S3.E6.m1.10.10.1.1.2.2.6.3.2.3.cmml" xref="S3.E6.m1.10.10.1.1.2.2.6.3.2.3">𝑁</ci></apply><ci id="S3.E6.m1.10.10.1.1.2.2.6.3.3.cmml" xref="S3.E6.m1.10.10.1.1.2.2.6.3.3">𝑚</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m1.10c">\mathbf{\Phi}_{\mathbf{Q},\mathcal{G}}\mathbf{\Phi}_{\mathbf{K},\mathcal{G}}^{%
\top}=\mathcal{K}_{\textrm{LR}}\odot\mathbf{M}_{\alpha}\quad\textrm{if}\quad%
\mathbf{\Phi}_{\{\mathbf{Q},\mathbf{K}\},\mathcal{G}}\coloneqq\left[\mathrm{%
vec}\left(\phi(\left\{\mathbf{q}_{i},\mathbf{k}_{i}\right\})\otimes\phi_{%
\mathcal{G}}(v_{i})\right)\right]_{i=1}^{N}\in\mathbb{R}^{N\times Nm}.</annotation><annotation encoding="application/x-llamapun" id="S3.E6.m1.10d">bold_Φ start_POSTSUBSCRIPT bold_Q , caligraphic_G end_POSTSUBSCRIPT bold_Φ start_POSTSUBSCRIPT bold_K , caligraphic_G end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT = caligraphic_K start_POSTSUBSCRIPT LR end_POSTSUBSCRIPT ⊙ bold_M start_POSTSUBSCRIPT italic_α end_POSTSUBSCRIPT if bold_Φ start_POSTSUBSCRIPT { bold_Q , bold_K } , caligraphic_G end_POSTSUBSCRIPT ≔ [ roman_vec ( italic_ϕ ( { bold_q start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , bold_k start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT } ) ⊗ italic_ϕ start_POSTSUBSCRIPT caligraphic_G end_POSTSUBSCRIPT ( italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) ) ] start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_N × italic_N italic_m end_POSTSUPERSCRIPT .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.p3.14">Masked low-rank attention can then be computed using <math alttext="\mathbf{\Phi}_{\{\mathbf{Q},\mathbf{K}\},\mathcal{G}}" class="ltx_Math" display="inline" id="S3.SS2.p3.14.m1.4"><semantics id="S3.SS2.p3.14.m1.4a"><msub id="S3.SS2.p3.14.m1.4.5" xref="S3.SS2.p3.14.m1.4.5.cmml"><mi id="S3.SS2.p3.14.m1.4.5.2" xref="S3.SS2.p3.14.m1.4.5.2.cmml">𝚽</mi><mrow id="S3.SS2.p3.14.m1.4.4.4.4" xref="S3.SS2.p3.14.m1.4.4.4.5.cmml"><mrow id="S3.SS2.p3.14.m1.4.4.4.4.1.2" xref="S3.SS2.p3.14.m1.4.4.4.4.1.1.cmml"><mo id="S3.SS2.p3.14.m1.4.4.4.4.1.2.1" stretchy="false" xref="S3.SS2.p3.14.m1.4.4.4.4.1.1.cmml">{</mo><mi id="S3.SS2.p3.14.m1.1.1.1.1" xref="S3.SS2.p3.14.m1.1.1.1.1.cmml">𝐐</mi><mo id="S3.SS2.p3.14.m1.4.4.4.4.1.2.2" xref="S3.SS2.p3.14.m1.4.4.4.4.1.1.cmml">,</mo><mi id="S3.SS2.p3.14.m1.2.2.2.2" xref="S3.SS2.p3.14.m1.2.2.2.2.cmml">𝐊</mi><mo id="S3.SS2.p3.14.m1.4.4.4.4.1.2.3" stretchy="false" xref="S3.SS2.p3.14.m1.4.4.4.4.1.1.cmml">}</mo></mrow><mo id="S3.SS2.p3.14.m1.4.4.4.4.2" xref="S3.SS2.p3.14.m1.4.4.4.5.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p3.14.m1.3.3.3.3" xref="S3.SS2.p3.14.m1.3.3.3.3.cmml">𝒢</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.14.m1.4b"><apply id="S3.SS2.p3.14.m1.4.5.cmml" xref="S3.SS2.p3.14.m1.4.5"><csymbol cd="ambiguous" id="S3.SS2.p3.14.m1.4.5.1.cmml" xref="S3.SS2.p3.14.m1.4.5">subscript</csymbol><ci id="S3.SS2.p3.14.m1.4.5.2.cmml" xref="S3.SS2.p3.14.m1.4.5.2">𝚽</ci><list id="S3.SS2.p3.14.m1.4.4.4.5.cmml" xref="S3.SS2.p3.14.m1.4.4.4.4"><set id="S3.SS2.p3.14.m1.4.4.4.4.1.1.cmml" xref="S3.SS2.p3.14.m1.4.4.4.4.1.2"><ci id="S3.SS2.p3.14.m1.1.1.1.1.cmml" xref="S3.SS2.p3.14.m1.1.1.1.1">𝐐</ci><ci id="S3.SS2.p3.14.m1.2.2.2.2.cmml" xref="S3.SS2.p3.14.m1.2.2.2.2">𝐊</ci></set><ci id="S3.SS2.p3.14.m1.3.3.3.3.cmml" xref="S3.SS2.p3.14.m1.3.3.3.3">𝒢</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.14.m1.4c">\mathbf{\Phi}_{\{\mathbf{Q},\mathbf{K}\},\mathcal{G}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.14.m1.4d">bold_Φ start_POSTSUBSCRIPT { bold_Q , bold_K } , caligraphic_G end_POSTSUBSCRIPT</annotation></semantics></math> as the feature matrices:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equation ltx_eqn_table" id="S3.E7">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\textrm{Att}_{\textrm{LR},\mathbf{M}}(\mathbf{Q},\mathbf{K},\mathbf{V},%
\mathcal{G})\coloneqq\mathbf{D}^{-1}\left(\mathbf{\Phi}_{\mathbf{Q},\mathcal{G%
}}\left(\mathbf{\Phi}_{\mathbf{K},\mathcal{G}}^{\top}\mathbf{V}\right)\right),%
\quad\mathbf{D}\coloneqq\mathbf{\Phi}_{\mathbf{Q},\mathcal{G}}\left(\mathbf{%
\Phi}_{\mathbf{K},\mathcal{G}}^{\top}\mathbf{1}_{N}\right)." class="ltx_Math" display="block" id="S3.E7.m1.15"><semantics id="S3.E7.m1.15a"><mrow id="S3.E7.m1.15.15.1"><mrow id="S3.E7.m1.15.15.1.1.2" xref="S3.E7.m1.15.15.1.1.3.cmml"><mrow id="S3.E7.m1.15.15.1.1.1.1" xref="S3.E7.m1.15.15.1.1.1.1.cmml"><mrow id="S3.E7.m1.15.15.1.1.1.1.3" xref="S3.E7.m1.15.15.1.1.1.1.3.cmml"><msub id="S3.E7.m1.15.15.1.1.1.1.3.2" xref="S3.E7.m1.15.15.1.1.1.1.3.2.cmml"><mtext id="S3.E7.m1.15.15.1.1.1.1.3.2.2" xref="S3.E7.m1.15.15.1.1.1.1.3.2.2a.cmml">Att</mtext><mrow id="S3.E7.m1.2.2.2.4" xref="S3.E7.m1.2.2.2.3.cmml"><mtext id="S3.E7.m1.1.1.1.1" xref="S3.E7.m1.1.1.1.1a.cmml">LR</mtext><mo id="S3.E7.m1.2.2.2.4.1" xref="S3.E7.m1.2.2.2.3.cmml">,</mo><mi id="S3.E7.m1.2.2.2.2" xref="S3.E7.m1.2.2.2.2.cmml">𝐌</mi></mrow></msub><mo id="S3.E7.m1.15.15.1.1.1.1.3.1" xref="S3.E7.m1.15.15.1.1.1.1.3.1.cmml">⁢</mo><mrow id="S3.E7.m1.15.15.1.1.1.1.3.3.2" xref="S3.E7.m1.15.15.1.1.1.1.3.3.1.cmml"><mo id="S3.E7.m1.15.15.1.1.1.1.3.3.2.1" stretchy="false" xref="S3.E7.m1.15.15.1.1.1.1.3.3.1.cmml">(</mo><mi id="S3.E7.m1.11.11" xref="S3.E7.m1.11.11.cmml">𝐐</mi><mo id="S3.E7.m1.15.15.1.1.1.1.3.3.2.2" xref="S3.E7.m1.15.15.1.1.1.1.3.3.1.cmml">,</mo><mi id="S3.E7.m1.12.12" xref="S3.E7.m1.12.12.cmml">𝐊</mi><mo id="S3.E7.m1.15.15.1.1.1.1.3.3.2.3" xref="S3.E7.m1.15.15.1.1.1.1.3.3.1.cmml">,</mo><mi id="S3.E7.m1.13.13" xref="S3.E7.m1.13.13.cmml">𝐕</mi><mo id="S3.E7.m1.15.15.1.1.1.1.3.3.2.4" xref="S3.E7.m1.15.15.1.1.1.1.3.3.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S3.E7.m1.14.14" xref="S3.E7.m1.14.14.cmml">𝒢</mi><mo id="S3.E7.m1.15.15.1.1.1.1.3.3.2.5" stretchy="false" xref="S3.E7.m1.15.15.1.1.1.1.3.3.1.cmml">)</mo></mrow></mrow><mo id="S3.E7.m1.15.15.1.1.1.1.2" xref="S3.E7.m1.15.15.1.1.1.1.2.cmml">≔</mo><mrow id="S3.E7.m1.15.15.1.1.1.1.1" xref="S3.E7.m1.15.15.1.1.1.1.1.cmml"><msup id="S3.E7.m1.15.15.1.1.1.1.1.3" xref="S3.E7.m1.15.15.1.1.1.1.1.3.cmml"><mi id="S3.E7.m1.15.15.1.1.1.1.1.3.2" xref="S3.E7.m1.15.15.1.1.1.1.1.3.2.cmml">𝐃</mi><mrow id="S3.E7.m1.15.15.1.1.1.1.1.3.3" xref="S3.E7.m1.15.15.1.1.1.1.1.3.3.cmml"><mo id="S3.E7.m1.15.15.1.1.1.1.1.3.3a" xref="S3.E7.m1.15.15.1.1.1.1.1.3.3.cmml">−</mo><mn id="S3.E7.m1.15.15.1.1.1.1.1.3.3.2" xref="S3.E7.m1.15.15.1.1.1.1.1.3.3.2.cmml">1</mn></mrow></msup><mo id="S3.E7.m1.15.15.1.1.1.1.1.2" xref="S3.E7.m1.15.15.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E7.m1.15.15.1.1.1.1.1.1.1" xref="S3.E7.m1.15.15.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E7.m1.15.15.1.1.1.1.1.1.1.2" xref="S3.E7.m1.15.15.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E7.m1.15.15.1.1.1.1.1.1.1.1" xref="S3.E7.m1.15.15.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E7.m1.15.15.1.1.1.1.1.1.1.1.3" xref="S3.E7.m1.15.15.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E7.m1.15.15.1.1.1.1.1.1.1.1.3.2" xref="S3.E7.m1.15.15.1.1.1.1.1.1.1.1.3.2.cmml">𝚽</mi><mrow id="S3.E7.m1.4.4.2.4" xref="S3.E7.m1.4.4.2.3.cmml"><mi id="S3.E7.m1.3.3.1.1" xref="S3.E7.m1.3.3.1.1.cmml">𝐐</mi><mo id="S3.E7.m1.4.4.2.4.1" xref="S3.E7.m1.4.4.2.3.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S3.E7.m1.4.4.2.2" xref="S3.E7.m1.4.4.2.2.cmml">𝒢</mi></mrow></msub><mo id="S3.E7.m1.15.15.1.1.1.1.1.1.1.1.2" xref="S3.E7.m1.15.15.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E7.m1.15.15.1.1.1.1.1.1.1.1.1.1" xref="S3.E7.m1.15.15.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E7.m1.15.15.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E7.m1.15.15.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E7.m1.15.15.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E7.m1.15.15.1.1.1.1.1.1.1.1.1.1.1.cmml"><msubsup id="S3.E7.m1.15.15.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E7.m1.15.15.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E7.m1.15.15.1.1.1.1.1.1.1.1.1.1.1.2.2.2" xref="S3.E7.m1.15.15.1.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml">𝚽</mi><mrow id="S3.E7.m1.6.6.2.4" xref="S3.E7.m1.6.6.2.3.cmml"><mi id="S3.E7.m1.5.5.1.1" xref="S3.E7.m1.5.5.1.1.cmml">𝐊</mi><mo id="S3.E7.m1.6.6.2.4.1" xref="S3.E7.m1.6.6.2.3.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S3.E7.m1.6.6.2.2" xref="S3.E7.m1.6.6.2.2.cmml">𝒢</mi></mrow><mo id="S3.E7.m1.15.15.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E7.m1.15.15.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">⊤</mo></msubsup><mo id="S3.E7.m1.15.15.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E7.m1.15.15.1.1.1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S3.E7.m1.15.15.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E7.m1.15.15.1.1.1.1.1.1.1.1.1.1.1.3.cmml">𝐕</mi></mrow><mo id="S3.E7.m1.15.15.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E7.m1.15.15.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E7.m1.15.15.1.1.1.1.1.1.1.3" xref="S3.E7.m1.15.15.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E7.m1.15.15.1.1.2.3" rspace="1.167em" xref="S3.E7.m1.15.15.1.1.3a.cmml">,</mo><mrow id="S3.E7.m1.15.15.1.1.2.2" xref="S3.E7.m1.15.15.1.1.2.2.cmml"><mi id="S3.E7.m1.15.15.1.1.2.2.3" xref="S3.E7.m1.15.15.1.1.2.2.3.cmml">𝐃</mi><mo id="S3.E7.m1.15.15.1.1.2.2.2" xref="S3.E7.m1.15.15.1.1.2.2.2.cmml">≔</mo><mrow id="S3.E7.m1.15.15.1.1.2.2.1" xref="S3.E7.m1.15.15.1.1.2.2.1.cmml"><msub id="S3.E7.m1.15.15.1.1.2.2.1.3" xref="S3.E7.m1.15.15.1.1.2.2.1.3.cmml"><mi id="S3.E7.m1.15.15.1.1.2.2.1.3.2" xref="S3.E7.m1.15.15.1.1.2.2.1.3.2.cmml">𝚽</mi><mrow id="S3.E7.m1.8.8.2.4" xref="S3.E7.m1.8.8.2.3.cmml"><mi id="S3.E7.m1.7.7.1.1" xref="S3.E7.m1.7.7.1.1.cmml">𝐐</mi><mo id="S3.E7.m1.8.8.2.4.1" xref="S3.E7.m1.8.8.2.3.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S3.E7.m1.8.8.2.2" xref="S3.E7.m1.8.8.2.2.cmml">𝒢</mi></mrow></msub><mo id="S3.E7.m1.15.15.1.1.2.2.1.2" xref="S3.E7.m1.15.15.1.1.2.2.1.2.cmml">⁢</mo><mrow id="S3.E7.m1.15.15.1.1.2.2.1.1.1" xref="S3.E7.m1.15.15.1.1.2.2.1.1.1.1.cmml"><mo id="S3.E7.m1.15.15.1.1.2.2.1.1.1.2" xref="S3.E7.m1.15.15.1.1.2.2.1.1.1.1.cmml">(</mo><mrow id="S3.E7.m1.15.15.1.1.2.2.1.1.1.1" xref="S3.E7.m1.15.15.1.1.2.2.1.1.1.1.cmml"><msubsup id="S3.E7.m1.15.15.1.1.2.2.1.1.1.1.2" xref="S3.E7.m1.15.15.1.1.2.2.1.1.1.1.2.cmml"><mi id="S3.E7.m1.15.15.1.1.2.2.1.1.1.1.2.2.2" xref="S3.E7.m1.15.15.1.1.2.2.1.1.1.1.2.2.2.cmml">𝚽</mi><mrow id="S3.E7.m1.10.10.2.4" xref="S3.E7.m1.10.10.2.3.cmml"><mi id="S3.E7.m1.9.9.1.1" xref="S3.E7.m1.9.9.1.1.cmml">𝐊</mi><mo id="S3.E7.m1.10.10.2.4.1" xref="S3.E7.m1.10.10.2.3.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S3.E7.m1.10.10.2.2" xref="S3.E7.m1.10.10.2.2.cmml">𝒢</mi></mrow><mo id="S3.E7.m1.15.15.1.1.2.2.1.1.1.1.2.3" xref="S3.E7.m1.15.15.1.1.2.2.1.1.1.1.2.3.cmml">⊤</mo></msubsup><mo id="S3.E7.m1.15.15.1.1.2.2.1.1.1.1.1" xref="S3.E7.m1.15.15.1.1.2.2.1.1.1.1.1.cmml">⁢</mo><msub id="S3.E7.m1.15.15.1.1.2.2.1.1.1.1.3" xref="S3.E7.m1.15.15.1.1.2.2.1.1.1.1.3.cmml"><mn id="S3.E7.m1.15.15.1.1.2.2.1.1.1.1.3.2" xref="S3.E7.m1.15.15.1.1.2.2.1.1.1.1.3.2.cmml">𝟏</mn><mi id="S3.E7.m1.15.15.1.1.2.2.1.1.1.1.3.3" xref="S3.E7.m1.15.15.1.1.2.2.1.1.1.1.3.3.cmml">N</mi></msub></mrow><mo id="S3.E7.m1.15.15.1.1.2.2.1.1.1.3" xref="S3.E7.m1.15.15.1.1.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E7.m1.15.15.1.2" lspace="0em">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E7.m1.15b"><apply id="S3.E7.m1.15.15.1.1.3.cmml" xref="S3.E7.m1.15.15.1.1.2"><csymbol cd="ambiguous" id="S3.E7.m1.15.15.1.1.3a.cmml" xref="S3.E7.m1.15.15.1.1.2.3">formulae-sequence</csymbol><apply id="S3.E7.m1.15.15.1.1.1.1.cmml" xref="S3.E7.m1.15.15.1.1.1.1"><ci id="S3.E7.m1.15.15.1.1.1.1.2.cmml" xref="S3.E7.m1.15.15.1.1.1.1.2">≔</ci><apply id="S3.E7.m1.15.15.1.1.1.1.3.cmml" xref="S3.E7.m1.15.15.1.1.1.1.3"><times id="S3.E7.m1.15.15.1.1.1.1.3.1.cmml" xref="S3.E7.m1.15.15.1.1.1.1.3.1"></times><apply id="S3.E7.m1.15.15.1.1.1.1.3.2.cmml" xref="S3.E7.m1.15.15.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E7.m1.15.15.1.1.1.1.3.2.1.cmml" xref="S3.E7.m1.15.15.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E7.m1.15.15.1.1.1.1.3.2.2a.cmml" xref="S3.E7.m1.15.15.1.1.1.1.3.2.2"><mtext id="S3.E7.m1.15.15.1.1.1.1.3.2.2.cmml" xref="S3.E7.m1.15.15.1.1.1.1.3.2.2">Att</mtext></ci><list id="S3.E7.m1.2.2.2.3.cmml" xref="S3.E7.m1.2.2.2.4"><ci id="S3.E7.m1.1.1.1.1a.cmml" xref="S3.E7.m1.1.1.1.1"><mtext id="S3.E7.m1.1.1.1.1.cmml" mathsize="70%" xref="S3.E7.m1.1.1.1.1">LR</mtext></ci><ci id="S3.E7.m1.2.2.2.2.cmml" xref="S3.E7.m1.2.2.2.2">𝐌</ci></list></apply><vector id="S3.E7.m1.15.15.1.1.1.1.3.3.1.cmml" xref="S3.E7.m1.15.15.1.1.1.1.3.3.2"><ci id="S3.E7.m1.11.11.cmml" xref="S3.E7.m1.11.11">𝐐</ci><ci id="S3.E7.m1.12.12.cmml" xref="S3.E7.m1.12.12">𝐊</ci><ci id="S3.E7.m1.13.13.cmml" xref="S3.E7.m1.13.13">𝐕</ci><ci id="S3.E7.m1.14.14.cmml" xref="S3.E7.m1.14.14">𝒢</ci></vector></apply><apply id="S3.E7.m1.15.15.1.1.1.1.1.cmml" xref="S3.E7.m1.15.15.1.1.1.1.1"><times id="S3.E7.m1.15.15.1.1.1.1.1.2.cmml" xref="S3.E7.m1.15.15.1.1.1.1.1.2"></times><apply id="S3.E7.m1.15.15.1.1.1.1.1.3.cmml" xref="S3.E7.m1.15.15.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E7.m1.15.15.1.1.1.1.1.3.1.cmml" xref="S3.E7.m1.15.15.1.1.1.1.1.3">superscript</csymbol><ci id="S3.E7.m1.15.15.1.1.1.1.1.3.2.cmml" xref="S3.E7.m1.15.15.1.1.1.1.1.3.2">𝐃</ci><apply id="S3.E7.m1.15.15.1.1.1.1.1.3.3.cmml" xref="S3.E7.m1.15.15.1.1.1.1.1.3.3"><minus id="S3.E7.m1.15.15.1.1.1.1.1.3.3.1.cmml" xref="S3.E7.m1.15.15.1.1.1.1.1.3.3"></minus><cn id="S3.E7.m1.15.15.1.1.1.1.1.3.3.2.cmml" type="integer" xref="S3.E7.m1.15.15.1.1.1.1.1.3.3.2">1</cn></apply></apply><apply id="S3.E7.m1.15.15.1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.15.15.1.1.1.1.1.1.1"><times id="S3.E7.m1.15.15.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E7.m1.15.15.1.1.1.1.1.1.1.1.2"></times><apply id="S3.E7.m1.15.15.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E7.m1.15.15.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E7.m1.15.15.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E7.m1.15.15.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E7.m1.15.15.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E7.m1.15.15.1.1.1.1.1.1.1.1.3.2">𝚽</ci><list id="S3.E7.m1.4.4.2.3.cmml" xref="S3.E7.m1.4.4.2.4"><ci id="S3.E7.m1.3.3.1.1.cmml" xref="S3.E7.m1.3.3.1.1">𝐐</ci><ci id="S3.E7.m1.4.4.2.2.cmml" xref="S3.E7.m1.4.4.2.2">𝒢</ci></list></apply><apply id="S3.E7.m1.15.15.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.15.15.1.1.1.1.1.1.1.1.1.1"><times id="S3.E7.m1.15.15.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.15.15.1.1.1.1.1.1.1.1.1.1.1.1"></times><apply id="S3.E7.m1.15.15.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E7.m1.15.15.1.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E7.m1.15.15.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E7.m1.15.15.1.1.1.1.1.1.1.1.1.1.1.2">superscript</csymbol><apply id="S3.E7.m1.15.15.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E7.m1.15.15.1.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E7.m1.15.15.1.1.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E7.m1.15.15.1.1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E7.m1.15.15.1.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E7.m1.15.15.1.1.1.1.1.1.1.1.1.1.1.2.2.2">𝚽</ci><list id="S3.E7.m1.6.6.2.3.cmml" xref="S3.E7.m1.6.6.2.4"><ci id="S3.E7.m1.5.5.1.1.cmml" xref="S3.E7.m1.5.5.1.1">𝐊</ci><ci id="S3.E7.m1.6.6.2.2.cmml" xref="S3.E7.m1.6.6.2.2">𝒢</ci></list></apply><csymbol cd="latexml" id="S3.E7.m1.15.15.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E7.m1.15.15.1.1.1.1.1.1.1.1.1.1.1.2.3">top</csymbol></apply><ci id="S3.E7.m1.15.15.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E7.m1.15.15.1.1.1.1.1.1.1.1.1.1.1.3">𝐕</ci></apply></apply></apply></apply><apply id="S3.E7.m1.15.15.1.1.2.2.cmml" xref="S3.E7.m1.15.15.1.1.2.2"><ci id="S3.E7.m1.15.15.1.1.2.2.2.cmml" xref="S3.E7.m1.15.15.1.1.2.2.2">≔</ci><ci id="S3.E7.m1.15.15.1.1.2.2.3.cmml" xref="S3.E7.m1.15.15.1.1.2.2.3">𝐃</ci><apply id="S3.E7.m1.15.15.1.1.2.2.1.cmml" xref="S3.E7.m1.15.15.1.1.2.2.1"><times id="S3.E7.m1.15.15.1.1.2.2.1.2.cmml" xref="S3.E7.m1.15.15.1.1.2.2.1.2"></times><apply id="S3.E7.m1.15.15.1.1.2.2.1.3.cmml" xref="S3.E7.m1.15.15.1.1.2.2.1.3"><csymbol cd="ambiguous" id="S3.E7.m1.15.15.1.1.2.2.1.3.1.cmml" xref="S3.E7.m1.15.15.1.1.2.2.1.3">subscript</csymbol><ci id="S3.E7.m1.15.15.1.1.2.2.1.3.2.cmml" xref="S3.E7.m1.15.15.1.1.2.2.1.3.2">𝚽</ci><list id="S3.E7.m1.8.8.2.3.cmml" xref="S3.E7.m1.8.8.2.4"><ci id="S3.E7.m1.7.7.1.1.cmml" xref="S3.E7.m1.7.7.1.1">𝐐</ci><ci id="S3.E7.m1.8.8.2.2.cmml" xref="S3.E7.m1.8.8.2.2">𝒢</ci></list></apply><apply id="S3.E7.m1.15.15.1.1.2.2.1.1.1.1.cmml" xref="S3.E7.m1.15.15.1.1.2.2.1.1.1"><times id="S3.E7.m1.15.15.1.1.2.2.1.1.1.1.1.cmml" xref="S3.E7.m1.15.15.1.1.2.2.1.1.1.1.1"></times><apply id="S3.E7.m1.15.15.1.1.2.2.1.1.1.1.2.cmml" xref="S3.E7.m1.15.15.1.1.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E7.m1.15.15.1.1.2.2.1.1.1.1.2.1.cmml" xref="S3.E7.m1.15.15.1.1.2.2.1.1.1.1.2">superscript</csymbol><apply id="S3.E7.m1.15.15.1.1.2.2.1.1.1.1.2.2.cmml" xref="S3.E7.m1.15.15.1.1.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E7.m1.15.15.1.1.2.2.1.1.1.1.2.2.1.cmml" xref="S3.E7.m1.15.15.1.1.2.2.1.1.1.1.2">subscript</csymbol><ci id="S3.E7.m1.15.15.1.1.2.2.1.1.1.1.2.2.2.cmml" xref="S3.E7.m1.15.15.1.1.2.2.1.1.1.1.2.2.2">𝚽</ci><list id="S3.E7.m1.10.10.2.3.cmml" xref="S3.E7.m1.10.10.2.4"><ci id="S3.E7.m1.9.9.1.1.cmml" xref="S3.E7.m1.9.9.1.1">𝐊</ci><ci id="S3.E7.m1.10.10.2.2.cmml" xref="S3.E7.m1.10.10.2.2">𝒢</ci></list></apply><csymbol cd="latexml" id="S3.E7.m1.15.15.1.1.2.2.1.1.1.1.2.3.cmml" xref="S3.E7.m1.15.15.1.1.2.2.1.1.1.1.2.3">top</csymbol></apply><apply id="S3.E7.m1.15.15.1.1.2.2.1.1.1.1.3.cmml" xref="S3.E7.m1.15.15.1.1.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E7.m1.15.15.1.1.2.2.1.1.1.1.3.1.cmml" xref="S3.E7.m1.15.15.1.1.2.2.1.1.1.1.3">subscript</csymbol><cn id="S3.E7.m1.15.15.1.1.2.2.1.1.1.1.3.2.cmml" type="integer" xref="S3.E7.m1.15.15.1.1.2.2.1.1.1.1.3.2">1</cn><ci id="S3.E7.m1.15.15.1.1.2.2.1.1.1.1.3.3.cmml" xref="S3.E7.m1.15.15.1.1.2.2.1.1.1.1.3.3">𝑁</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7.m1.15c">\textrm{Att}_{\textrm{LR},\mathbf{M}}(\mathbf{Q},\mathbf{K},\mathbf{V},%
\mathcal{G})\coloneqq\mathbf{D}^{-1}\left(\mathbf{\Phi}_{\mathbf{Q},\mathcal{G%
}}\left(\mathbf{\Phi}_{\mathbf{K},\mathcal{G}}^{\top}\mathbf{V}\right)\right),%
\quad\mathbf{D}\coloneqq\mathbf{\Phi}_{\mathbf{Q},\mathcal{G}}\left(\mathbf{%
\Phi}_{\mathbf{K},\mathcal{G}}^{\top}\mathbf{1}_{N}\right).</annotation><annotation encoding="application/x-llamapun" id="S3.E7.m1.15d">Att start_POSTSUBSCRIPT LR , bold_M end_POSTSUBSCRIPT ( bold_Q , bold_K , bold_V , caligraphic_G ) ≔ bold_D start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ( bold_Φ start_POSTSUBSCRIPT bold_Q , caligraphic_G end_POSTSUBSCRIPT ( bold_Φ start_POSTSUBSCRIPT bold_K , caligraphic_G end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT bold_V ) ) , bold_D ≔ bold_Φ start_POSTSUBSCRIPT bold_Q , caligraphic_G end_POSTSUBSCRIPT ( bold_Φ start_POSTSUBSCRIPT bold_K , caligraphic_G end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT bold_1 start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS2.p4">
<p class="ltx_p" id="S3.SS2.p4.6"><span class="ltx_text ltx_font_bold" id="S3.SS2.p4.6.1">Time complexity.</span>
Eqs <a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#S3.E6" title="In 3.2 Implicit masking with graph features ‣ 3 Towards linear topological masking ‣ Linear Transformer Topological Masking with Graph Random Features"><span class="ltx_text ltx_ref_tag">6</span></a> and <a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#S3.E7" title="In 3.2 Implicit masking with graph features ‣ 3 Towards linear topological masking ‣ Linear Transformer Topological Masking with Graph Random Features"><span class="ltx_text ltx_ref_tag">7</span></a> give a recipe for computing
masked attention implicitly in feature space, without needing to materialise <math alttext="\mathbf{A}" class="ltx_Math" display="inline" id="S3.SS2.p4.1.m1.1"><semantics id="S3.SS2.p4.1.m1.1a"><mi id="S3.SS2.p4.1.m1.1.1" xref="S3.SS2.p4.1.m1.1.1.cmml">𝐀</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.1.m1.1b"><ci id="S3.SS2.p4.1.m1.1.1.cmml" xref="S3.SS2.p4.1.m1.1.1">𝐀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.1.m1.1c">\mathbf{A}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.1.m1.1d">bold_A</annotation></semantics></math> or <math alttext="\mathbf{M}" class="ltx_Math" display="inline" id="S3.SS2.p4.2.m2.1"><semantics id="S3.SS2.p4.2.m2.1a"><mi id="S3.SS2.p4.2.m2.1.1" xref="S3.SS2.p4.2.m2.1.1.cmml">𝐌</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.2.m2.1b"><ci id="S3.SS2.p4.2.m2.1.1.cmml" xref="S3.SS2.p4.2.m2.1.1">𝐌</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.2.m2.1c">\mathbf{M}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.2.m2.1d">bold_M</annotation></semantics></math> in memory.
However, this approach relies on computing the feature matrix <math alttext="\mathbf{\Phi}_{\{\mathbf{Q},\mathbf{K}\},\mathcal{G}}\in\mathbb{R}^{N\times Nm}" class="ltx_Math" display="inline" id="S3.SS2.p4.3.m3.4"><semantics id="S3.SS2.p4.3.m3.4a"><mrow id="S3.SS2.p4.3.m3.4.5" xref="S3.SS2.p4.3.m3.4.5.cmml"><msub id="S3.SS2.p4.3.m3.4.5.2" xref="S3.SS2.p4.3.m3.4.5.2.cmml"><mi id="S3.SS2.p4.3.m3.4.5.2.2" xref="S3.SS2.p4.3.m3.4.5.2.2.cmml">𝚽</mi><mrow id="S3.SS2.p4.3.m3.4.4.4.4" xref="S3.SS2.p4.3.m3.4.4.4.5.cmml"><mrow id="S3.SS2.p4.3.m3.4.4.4.4.1.2" xref="S3.SS2.p4.3.m3.4.4.4.4.1.1.cmml"><mo id="S3.SS2.p4.3.m3.4.4.4.4.1.2.1" stretchy="false" xref="S3.SS2.p4.3.m3.4.4.4.4.1.1.cmml">{</mo><mi id="S3.SS2.p4.3.m3.1.1.1.1" xref="S3.SS2.p4.3.m3.1.1.1.1.cmml">𝐐</mi><mo id="S3.SS2.p4.3.m3.4.4.4.4.1.2.2" xref="S3.SS2.p4.3.m3.4.4.4.4.1.1.cmml">,</mo><mi id="S3.SS2.p4.3.m3.2.2.2.2" xref="S3.SS2.p4.3.m3.2.2.2.2.cmml">𝐊</mi><mo id="S3.SS2.p4.3.m3.4.4.4.4.1.2.3" stretchy="false" xref="S3.SS2.p4.3.m3.4.4.4.4.1.1.cmml">}</mo></mrow><mo id="S3.SS2.p4.3.m3.4.4.4.4.2" xref="S3.SS2.p4.3.m3.4.4.4.5.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p4.3.m3.3.3.3.3" xref="S3.SS2.p4.3.m3.3.3.3.3.cmml">𝒢</mi></mrow></msub><mo id="S3.SS2.p4.3.m3.4.5.1" xref="S3.SS2.p4.3.m3.4.5.1.cmml">∈</mo><msup id="S3.SS2.p4.3.m3.4.5.3" xref="S3.SS2.p4.3.m3.4.5.3.cmml"><mi id="S3.SS2.p4.3.m3.4.5.3.2" xref="S3.SS2.p4.3.m3.4.5.3.2.cmml">ℝ</mi><mrow id="S3.SS2.p4.3.m3.4.5.3.3" xref="S3.SS2.p4.3.m3.4.5.3.3.cmml"><mrow id="S3.SS2.p4.3.m3.4.5.3.3.2" xref="S3.SS2.p4.3.m3.4.5.3.3.2.cmml"><mi id="S3.SS2.p4.3.m3.4.5.3.3.2.2" xref="S3.SS2.p4.3.m3.4.5.3.3.2.2.cmml">N</mi><mo id="S3.SS2.p4.3.m3.4.5.3.3.2.1" lspace="0.222em" rspace="0.222em" xref="S3.SS2.p4.3.m3.4.5.3.3.2.1.cmml">×</mo><mi id="S3.SS2.p4.3.m3.4.5.3.3.2.3" xref="S3.SS2.p4.3.m3.4.5.3.3.2.3.cmml">N</mi></mrow><mo id="S3.SS2.p4.3.m3.4.5.3.3.1" xref="S3.SS2.p4.3.m3.4.5.3.3.1.cmml">⁢</mo><mi id="S3.SS2.p4.3.m3.4.5.3.3.3" xref="S3.SS2.p4.3.m3.4.5.3.3.3.cmml">m</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.3.m3.4b"><apply id="S3.SS2.p4.3.m3.4.5.cmml" xref="S3.SS2.p4.3.m3.4.5"><in id="S3.SS2.p4.3.m3.4.5.1.cmml" xref="S3.SS2.p4.3.m3.4.5.1"></in><apply id="S3.SS2.p4.3.m3.4.5.2.cmml" xref="S3.SS2.p4.3.m3.4.5.2"><csymbol cd="ambiguous" id="S3.SS2.p4.3.m3.4.5.2.1.cmml" xref="S3.SS2.p4.3.m3.4.5.2">subscript</csymbol><ci id="S3.SS2.p4.3.m3.4.5.2.2.cmml" xref="S3.SS2.p4.3.m3.4.5.2.2">𝚽</ci><list id="S3.SS2.p4.3.m3.4.4.4.5.cmml" xref="S3.SS2.p4.3.m3.4.4.4.4"><set id="S3.SS2.p4.3.m3.4.4.4.4.1.1.cmml" xref="S3.SS2.p4.3.m3.4.4.4.4.1.2"><ci id="S3.SS2.p4.3.m3.1.1.1.1.cmml" xref="S3.SS2.p4.3.m3.1.1.1.1">𝐐</ci><ci id="S3.SS2.p4.3.m3.2.2.2.2.cmml" xref="S3.SS2.p4.3.m3.2.2.2.2">𝐊</ci></set><ci id="S3.SS2.p4.3.m3.3.3.3.3.cmml" xref="S3.SS2.p4.3.m3.3.3.3.3">𝒢</ci></list></apply><apply id="S3.SS2.p4.3.m3.4.5.3.cmml" xref="S3.SS2.p4.3.m3.4.5.3"><csymbol cd="ambiguous" id="S3.SS2.p4.3.m3.4.5.3.1.cmml" xref="S3.SS2.p4.3.m3.4.5.3">superscript</csymbol><ci id="S3.SS2.p4.3.m3.4.5.3.2.cmml" xref="S3.SS2.p4.3.m3.4.5.3.2">ℝ</ci><apply id="S3.SS2.p4.3.m3.4.5.3.3.cmml" xref="S3.SS2.p4.3.m3.4.5.3.3"><times id="S3.SS2.p4.3.m3.4.5.3.3.1.cmml" xref="S3.SS2.p4.3.m3.4.5.3.3.1"></times><apply id="S3.SS2.p4.3.m3.4.5.3.3.2.cmml" xref="S3.SS2.p4.3.m3.4.5.3.3.2"><times id="S3.SS2.p4.3.m3.4.5.3.3.2.1.cmml" xref="S3.SS2.p4.3.m3.4.5.3.3.2.1"></times><ci id="S3.SS2.p4.3.m3.4.5.3.3.2.2.cmml" xref="S3.SS2.p4.3.m3.4.5.3.3.2.2">𝑁</ci><ci id="S3.SS2.p4.3.m3.4.5.3.3.2.3.cmml" xref="S3.SS2.p4.3.m3.4.5.3.3.2.3">𝑁</ci></apply><ci id="S3.SS2.p4.3.m3.4.5.3.3.3.cmml" xref="S3.SS2.p4.3.m3.4.5.3.3.3">𝑚</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.3.m3.4c">\mathbf{\Phi}_{\{\mathbf{Q},\mathbf{K}\},\mathcal{G}}\in\mathbb{R}^{N\times Nm}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.3.m3.4d">bold_Φ start_POSTSUBSCRIPT { bold_Q , bold_K } , caligraphic_G end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_N × italic_N italic_m end_POSTSUPERSCRIPT</annotation></semantics></math> and evaluating products like
<math alttext="\mathbf{\Phi}_{\mathbf{K},\mathcal{G}}^{\top}\mathbf{1}_{N}" class="ltx_Math" display="inline" id="S3.SS2.p4.4.m4.2"><semantics id="S3.SS2.p4.4.m4.2a"><mrow id="S3.SS2.p4.4.m4.2.3" xref="S3.SS2.p4.4.m4.2.3.cmml"><msubsup id="S3.SS2.p4.4.m4.2.3.2" xref="S3.SS2.p4.4.m4.2.3.2.cmml"><mi id="S3.SS2.p4.4.m4.2.3.2.2.2" xref="S3.SS2.p4.4.m4.2.3.2.2.2.cmml">𝚽</mi><mrow id="S3.SS2.p4.4.m4.2.2.2.4" xref="S3.SS2.p4.4.m4.2.2.2.3.cmml"><mi id="S3.SS2.p4.4.m4.1.1.1.1" xref="S3.SS2.p4.4.m4.1.1.1.1.cmml">𝐊</mi><mo id="S3.SS2.p4.4.m4.2.2.2.4.1" xref="S3.SS2.p4.4.m4.2.2.2.3.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p4.4.m4.2.2.2.2" xref="S3.SS2.p4.4.m4.2.2.2.2.cmml">𝒢</mi></mrow><mo id="S3.SS2.p4.4.m4.2.3.2.3" xref="S3.SS2.p4.4.m4.2.3.2.3.cmml">⊤</mo></msubsup><mo id="S3.SS2.p4.4.m4.2.3.1" xref="S3.SS2.p4.4.m4.2.3.1.cmml">⁢</mo><msub id="S3.SS2.p4.4.m4.2.3.3" xref="S3.SS2.p4.4.m4.2.3.3.cmml"><mn id="S3.SS2.p4.4.m4.2.3.3.2" xref="S3.SS2.p4.4.m4.2.3.3.2.cmml">𝟏</mn><mi id="S3.SS2.p4.4.m4.2.3.3.3" xref="S3.SS2.p4.4.m4.2.3.3.3.cmml">N</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.4.m4.2b"><apply id="S3.SS2.p4.4.m4.2.3.cmml" xref="S3.SS2.p4.4.m4.2.3"><times id="S3.SS2.p4.4.m4.2.3.1.cmml" xref="S3.SS2.p4.4.m4.2.3.1"></times><apply id="S3.SS2.p4.4.m4.2.3.2.cmml" xref="S3.SS2.p4.4.m4.2.3.2"><csymbol cd="ambiguous" id="S3.SS2.p4.4.m4.2.3.2.1.cmml" xref="S3.SS2.p4.4.m4.2.3.2">superscript</csymbol><apply id="S3.SS2.p4.4.m4.2.3.2.2.cmml" xref="S3.SS2.p4.4.m4.2.3.2"><csymbol cd="ambiguous" id="S3.SS2.p4.4.m4.2.3.2.2.1.cmml" xref="S3.SS2.p4.4.m4.2.3.2">subscript</csymbol><ci id="S3.SS2.p4.4.m4.2.3.2.2.2.cmml" xref="S3.SS2.p4.4.m4.2.3.2.2.2">𝚽</ci><list id="S3.SS2.p4.4.m4.2.2.2.3.cmml" xref="S3.SS2.p4.4.m4.2.2.2.4"><ci id="S3.SS2.p4.4.m4.1.1.1.1.cmml" xref="S3.SS2.p4.4.m4.1.1.1.1">𝐊</ci><ci id="S3.SS2.p4.4.m4.2.2.2.2.cmml" xref="S3.SS2.p4.4.m4.2.2.2.2">𝒢</ci></list></apply><csymbol cd="latexml" id="S3.SS2.p4.4.m4.2.3.2.3.cmml" xref="S3.SS2.p4.4.m4.2.3.2.3">top</csymbol></apply><apply id="S3.SS2.p4.4.m4.2.3.3.cmml" xref="S3.SS2.p4.4.m4.2.3.3"><csymbol cd="ambiguous" id="S3.SS2.p4.4.m4.2.3.3.1.cmml" xref="S3.SS2.p4.4.m4.2.3.3">subscript</csymbol><cn id="S3.SS2.p4.4.m4.2.3.3.2.cmml" type="integer" xref="S3.SS2.p4.4.m4.2.3.3.2">1</cn><ci id="S3.SS2.p4.4.m4.2.3.3.3.cmml" xref="S3.SS2.p4.4.m4.2.3.3.3">𝑁</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.4.m4.2c">\mathbf{\Phi}_{\mathbf{K},\mathcal{G}}^{\top}\mathbf{1}_{N}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.4.m4.2d">bold_Φ start_POSTSUBSCRIPT bold_K , caligraphic_G end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT bold_1 start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT</annotation></semantics></math>, which still incurs <math alttext="\mathcal{O}(N^{2})" class="ltx_Math" display="inline" id="S3.SS2.p4.5.m5.1"><semantics id="S3.SS2.p4.5.m5.1a"><mrow id="S3.SS2.p4.5.m5.1.1" xref="S3.SS2.p4.5.m5.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p4.5.m5.1.1.3" xref="S3.SS2.p4.5.m5.1.1.3.cmml">𝒪</mi><mo id="S3.SS2.p4.5.m5.1.1.2" xref="S3.SS2.p4.5.m5.1.1.2.cmml">⁢</mo><mrow id="S3.SS2.p4.5.m5.1.1.1.1" xref="S3.SS2.p4.5.m5.1.1.1.1.1.cmml"><mo id="S3.SS2.p4.5.m5.1.1.1.1.2" stretchy="false" xref="S3.SS2.p4.5.m5.1.1.1.1.1.cmml">(</mo><msup id="S3.SS2.p4.5.m5.1.1.1.1.1" xref="S3.SS2.p4.5.m5.1.1.1.1.1.cmml"><mi id="S3.SS2.p4.5.m5.1.1.1.1.1.2" xref="S3.SS2.p4.5.m5.1.1.1.1.1.2.cmml">N</mi><mn id="S3.SS2.p4.5.m5.1.1.1.1.1.3" xref="S3.SS2.p4.5.m5.1.1.1.1.1.3.cmml">2</mn></msup><mo id="S3.SS2.p4.5.m5.1.1.1.1.3" stretchy="false" xref="S3.SS2.p4.5.m5.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.5.m5.1b"><apply id="S3.SS2.p4.5.m5.1.1.cmml" xref="S3.SS2.p4.5.m5.1.1"><times id="S3.SS2.p4.5.m5.1.1.2.cmml" xref="S3.SS2.p4.5.m5.1.1.2"></times><ci id="S3.SS2.p4.5.m5.1.1.3.cmml" xref="S3.SS2.p4.5.m5.1.1.3">𝒪</ci><apply id="S3.SS2.p4.5.m5.1.1.1.1.1.cmml" xref="S3.SS2.p4.5.m5.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.5.m5.1.1.1.1.1.1.cmml" xref="S3.SS2.p4.5.m5.1.1.1.1">superscript</csymbol><ci id="S3.SS2.p4.5.m5.1.1.1.1.1.2.cmml" xref="S3.SS2.p4.5.m5.1.1.1.1.1.2">𝑁</ci><cn id="S3.SS2.p4.5.m5.1.1.1.1.1.3.cmml" type="integer" xref="S3.SS2.p4.5.m5.1.1.1.1.1.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.5.m5.1c">\mathcal{O}(N^{2})</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.5.m5.1d">caligraphic_O ( italic_N start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT )</annotation></semantics></math> space and time complexity.
For a linear masking algorithm, we must reduce this to <math alttext="\mathcal{O}(N)" class="ltx_Math" display="inline" id="S3.SS2.p4.6.m6.1"><semantics id="S3.SS2.p4.6.m6.1a"><mrow id="S3.SS2.p4.6.m6.1.2" xref="S3.SS2.p4.6.m6.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p4.6.m6.1.2.2" xref="S3.SS2.p4.6.m6.1.2.2.cmml">𝒪</mi><mo id="S3.SS2.p4.6.m6.1.2.1" xref="S3.SS2.p4.6.m6.1.2.1.cmml">⁢</mo><mrow id="S3.SS2.p4.6.m6.1.2.3.2" xref="S3.SS2.p4.6.m6.1.2.cmml"><mo id="S3.SS2.p4.6.m6.1.2.3.2.1" stretchy="false" xref="S3.SS2.p4.6.m6.1.2.cmml">(</mo><mi id="S3.SS2.p4.6.m6.1.1" xref="S3.SS2.p4.6.m6.1.1.cmml">N</mi><mo id="S3.SS2.p4.6.m6.1.2.3.2.2" stretchy="false" xref="S3.SS2.p4.6.m6.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.6.m6.1b"><apply id="S3.SS2.p4.6.m6.1.2.cmml" xref="S3.SS2.p4.6.m6.1.2"><times id="S3.SS2.p4.6.m6.1.2.1.cmml" xref="S3.SS2.p4.6.m6.1.2.1"></times><ci id="S3.SS2.p4.6.m6.1.2.2.cmml" xref="S3.SS2.p4.6.m6.1.2.2">𝒪</ci><ci id="S3.SS2.p4.6.m6.1.1.cmml" xref="S3.SS2.p4.6.m6.1.1">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.6.m6.1c">\mathcal{O}(N)</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.6.m6.1d">caligraphic_O ( italic_N )</annotation></semantics></math>.
This can be achieved by approximating the features.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_subsection" id="S3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Faster implicit masking with graph <span class="ltx_text ltx_framed ltx_framed_underline" id="S3.SS3.1.1">random</span> features</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S3.SS3.p1">
<p class="ltx_p" id="S3.SS3.p1.2">Our goal is now to replace <math alttext="\mathbf{\Phi}_{\{\mathbf{Q},\mathbf{K}\},\mathcal{G}}" class="ltx_Math" display="inline" id="S3.SS3.p1.1.m1.4"><semantics id="S3.SS3.p1.1.m1.4a"><msub id="S3.SS3.p1.1.m1.4.5" xref="S3.SS3.p1.1.m1.4.5.cmml"><mi id="S3.SS3.p1.1.m1.4.5.2" xref="S3.SS3.p1.1.m1.4.5.2.cmml">𝚽</mi><mrow id="S3.SS3.p1.1.m1.4.4.4.4" xref="S3.SS3.p1.1.m1.4.4.4.5.cmml"><mrow id="S3.SS3.p1.1.m1.4.4.4.4.1.2" xref="S3.SS3.p1.1.m1.4.4.4.4.1.1.cmml"><mo id="S3.SS3.p1.1.m1.4.4.4.4.1.2.1" stretchy="false" xref="S3.SS3.p1.1.m1.4.4.4.4.1.1.cmml">{</mo><mi id="S3.SS3.p1.1.m1.1.1.1.1" xref="S3.SS3.p1.1.m1.1.1.1.1.cmml">𝐐</mi><mo id="S3.SS3.p1.1.m1.4.4.4.4.1.2.2" xref="S3.SS3.p1.1.m1.4.4.4.4.1.1.cmml">,</mo><mi id="S3.SS3.p1.1.m1.2.2.2.2" xref="S3.SS3.p1.1.m1.2.2.2.2.cmml">𝐊</mi><mo id="S3.SS3.p1.1.m1.4.4.4.4.1.2.3" stretchy="false" xref="S3.SS3.p1.1.m1.4.4.4.4.1.1.cmml">}</mo></mrow><mo id="S3.SS3.p1.1.m1.4.4.4.4.2" xref="S3.SS3.p1.1.m1.4.4.4.5.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p1.1.m1.3.3.3.3" xref="S3.SS3.p1.1.m1.3.3.3.3.cmml">𝒢</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.1.m1.4b"><apply id="S3.SS3.p1.1.m1.4.5.cmml" xref="S3.SS3.p1.1.m1.4.5"><csymbol cd="ambiguous" id="S3.SS3.p1.1.m1.4.5.1.cmml" xref="S3.SS3.p1.1.m1.4.5">subscript</csymbol><ci id="S3.SS3.p1.1.m1.4.5.2.cmml" xref="S3.SS3.p1.1.m1.4.5.2">𝚽</ci><list id="S3.SS3.p1.1.m1.4.4.4.5.cmml" xref="S3.SS3.p1.1.m1.4.4.4.4"><set id="S3.SS3.p1.1.m1.4.4.4.4.1.1.cmml" xref="S3.SS3.p1.1.m1.4.4.4.4.1.2"><ci id="S3.SS3.p1.1.m1.1.1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1.1.1">𝐐</ci><ci id="S3.SS3.p1.1.m1.2.2.2.2.cmml" xref="S3.SS3.p1.1.m1.2.2.2.2">𝐊</ci></set><ci id="S3.SS3.p1.1.m1.3.3.3.3.cmml" xref="S3.SS3.p1.1.m1.3.3.3.3">𝒢</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.1.m1.4c">\mathbf{\Phi}_{\{\mathbf{Q},\mathbf{K}\},\mathcal{G}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.1.m1.4d">bold_Φ start_POSTSUBSCRIPT { bold_Q , bold_K } , caligraphic_G end_POSTSUBSCRIPT</annotation></semantics></math> by Monte Carlo estimates <math alttext="\widehat{\mathbf{\Phi}}_{\{\mathbf{Q},\mathbf{K}\},\mathcal{G}}" class="ltx_Math" display="inline" id="S3.SS3.p1.2.m2.4"><semantics id="S3.SS3.p1.2.m2.4a"><msub id="S3.SS3.p1.2.m2.4.5" xref="S3.SS3.p1.2.m2.4.5.cmml"><mover accent="true" id="S3.SS3.p1.2.m2.4.5.2" xref="S3.SS3.p1.2.m2.4.5.2.cmml"><mi id="S3.SS3.p1.2.m2.4.5.2.2" xref="S3.SS3.p1.2.m2.4.5.2.2.cmml">𝚽</mi><mo id="S3.SS3.p1.2.m2.4.5.2.1" xref="S3.SS3.p1.2.m2.4.5.2.1.cmml">^</mo></mover><mrow id="S3.SS3.p1.2.m2.4.4.4.4" xref="S3.SS3.p1.2.m2.4.4.4.5.cmml"><mrow id="S3.SS3.p1.2.m2.4.4.4.4.1.2" xref="S3.SS3.p1.2.m2.4.4.4.4.1.1.cmml"><mo id="S3.SS3.p1.2.m2.4.4.4.4.1.2.1" stretchy="false" xref="S3.SS3.p1.2.m2.4.4.4.4.1.1.cmml">{</mo><mi id="S3.SS3.p1.2.m2.1.1.1.1" xref="S3.SS3.p1.2.m2.1.1.1.1.cmml">𝐐</mi><mo id="S3.SS3.p1.2.m2.4.4.4.4.1.2.2" xref="S3.SS3.p1.2.m2.4.4.4.4.1.1.cmml">,</mo><mi id="S3.SS3.p1.2.m2.2.2.2.2" xref="S3.SS3.p1.2.m2.2.2.2.2.cmml">𝐊</mi><mo id="S3.SS3.p1.2.m2.4.4.4.4.1.2.3" stretchy="false" xref="S3.SS3.p1.2.m2.4.4.4.4.1.1.cmml">}</mo></mrow><mo id="S3.SS3.p1.2.m2.4.4.4.4.2" xref="S3.SS3.p1.2.m2.4.4.4.5.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p1.2.m2.3.3.3.3" xref="S3.SS3.p1.2.m2.3.3.3.3.cmml">𝒢</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.2.m2.4b"><apply id="S3.SS3.p1.2.m2.4.5.cmml" xref="S3.SS3.p1.2.m2.4.5"><csymbol cd="ambiguous" id="S3.SS3.p1.2.m2.4.5.1.cmml" xref="S3.SS3.p1.2.m2.4.5">subscript</csymbol><apply id="S3.SS3.p1.2.m2.4.5.2.cmml" xref="S3.SS3.p1.2.m2.4.5.2"><ci id="S3.SS3.p1.2.m2.4.5.2.1.cmml" xref="S3.SS3.p1.2.m2.4.5.2.1">^</ci><ci id="S3.SS3.p1.2.m2.4.5.2.2.cmml" xref="S3.SS3.p1.2.m2.4.5.2.2">𝚽</ci></apply><list id="S3.SS3.p1.2.m2.4.4.4.5.cmml" xref="S3.SS3.p1.2.m2.4.4.4.4"><set id="S3.SS3.p1.2.m2.4.4.4.4.1.1.cmml" xref="S3.SS3.p1.2.m2.4.4.4.4.1.2"><ci id="S3.SS3.p1.2.m2.1.1.1.1.cmml" xref="S3.SS3.p1.2.m2.1.1.1.1">𝐐</ci><ci id="S3.SS3.p1.2.m2.2.2.2.2.cmml" xref="S3.SS3.p1.2.m2.2.2.2.2">𝐊</ci></set><ci id="S3.SS3.p1.2.m2.3.3.3.3.cmml" xref="S3.SS3.p1.2.m2.3.3.3.3">𝒢</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.2.m2.4c">\widehat{\mathbf{\Phi}}_{\{\mathbf{Q},\mathbf{K}\},\mathcal{G}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.2.m2.4d">over^ start_ARG bold_Φ end_ARG start_POSTSUBSCRIPT { bold_Q , bold_K } , caligraphic_G end_POSTSUBSCRIPT</annotation></semantics></math> that satisfy</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equation ltx_eqn_table" id="S3.E8">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbb{E}\left(\widehat{\mathbf{\Phi}}_{\mathbf{Q},\mathcal{G}}\widehat{%
\mathbf{\Phi}}_{\mathbf{K},\mathcal{G}}^{\top}\right)=\mathbf{\Phi}_{\mathbf{Q%
},\mathcal{G}}\mathbf{\Phi}_{\mathbf{K},\mathcal{G}}^{\top}=\mathcal{K}_{%
\textrm{LR}}\odot\mathbf{M}_{\alpha},\quad\widehat{\mathbf{\Phi}}_{\mathbf{K},%
\mathcal{G}}^{\top}\bm{v}\sim\mathcal{O}(N)\hskip 2.84526pt\forall\hskip 2.845%
26pt\bm{v}\in\mathbb{R}^{N}," class="ltx_Math" display="block" id="S3.E8.m1.12"><semantics id="S3.E8.m1.12a"><mrow id="S3.E8.m1.12.12.1"><mrow id="S3.E8.m1.12.12.1.1.2" xref="S3.E8.m1.12.12.1.1.3.cmml"><mrow id="S3.E8.m1.12.12.1.1.1.1" xref="S3.E8.m1.12.12.1.1.1.1.cmml"><mrow id="S3.E8.m1.12.12.1.1.1.1.1" xref="S3.E8.m1.12.12.1.1.1.1.1.cmml"><mi id="S3.E8.m1.12.12.1.1.1.1.1.3" xref="S3.E8.m1.12.12.1.1.1.1.1.3.cmml">𝔼</mi><mo id="S3.E8.m1.12.12.1.1.1.1.1.2" xref="S3.E8.m1.12.12.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E8.m1.12.12.1.1.1.1.1.1.1" xref="S3.E8.m1.12.12.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E8.m1.12.12.1.1.1.1.1.1.1.2" xref="S3.E8.m1.12.12.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E8.m1.12.12.1.1.1.1.1.1.1.1" xref="S3.E8.m1.12.12.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E8.m1.12.12.1.1.1.1.1.1.1.1.2" xref="S3.E8.m1.12.12.1.1.1.1.1.1.1.1.2.cmml"><mover accent="true" id="S3.E8.m1.12.12.1.1.1.1.1.1.1.1.2.2" xref="S3.E8.m1.12.12.1.1.1.1.1.1.1.1.2.2.cmml"><mi id="S3.E8.m1.12.12.1.1.1.1.1.1.1.1.2.2.2" xref="S3.E8.m1.12.12.1.1.1.1.1.1.1.1.2.2.2.cmml">𝚽</mi><mo id="S3.E8.m1.12.12.1.1.1.1.1.1.1.1.2.2.1" xref="S3.E8.m1.12.12.1.1.1.1.1.1.1.1.2.2.1.cmml">^</mo></mover><mrow id="S3.E8.m1.2.2.2.4" xref="S3.E8.m1.2.2.2.3.cmml"><mi id="S3.E8.m1.1.1.1.1" xref="S3.E8.m1.1.1.1.1.cmml">𝐐</mi><mo id="S3.E8.m1.2.2.2.4.1" xref="S3.E8.m1.2.2.2.3.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S3.E8.m1.2.2.2.2" xref="S3.E8.m1.2.2.2.2.cmml">𝒢</mi></mrow></msub><mo id="S3.E8.m1.12.12.1.1.1.1.1.1.1.1.1" xref="S3.E8.m1.12.12.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><msubsup id="S3.E8.m1.12.12.1.1.1.1.1.1.1.1.3" xref="S3.E8.m1.12.12.1.1.1.1.1.1.1.1.3.cmml"><mover accent="true" id="S3.E8.m1.12.12.1.1.1.1.1.1.1.1.3.2.2" xref="S3.E8.m1.12.12.1.1.1.1.1.1.1.1.3.2.2.cmml"><mi id="S3.E8.m1.12.12.1.1.1.1.1.1.1.1.3.2.2.2" xref="S3.E8.m1.12.12.1.1.1.1.1.1.1.1.3.2.2.2.cmml">𝚽</mi><mo id="S3.E8.m1.12.12.1.1.1.1.1.1.1.1.3.2.2.1" xref="S3.E8.m1.12.12.1.1.1.1.1.1.1.1.3.2.2.1.cmml">^</mo></mover><mrow id="S3.E8.m1.4.4.2.4" xref="S3.E8.m1.4.4.2.3.cmml"><mi id="S3.E8.m1.3.3.1.1" xref="S3.E8.m1.3.3.1.1.cmml">𝐊</mi><mo id="S3.E8.m1.4.4.2.4.1" xref="S3.E8.m1.4.4.2.3.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S3.E8.m1.4.4.2.2" xref="S3.E8.m1.4.4.2.2.cmml">𝒢</mi></mrow><mo id="S3.E8.m1.12.12.1.1.1.1.1.1.1.1.3.3" xref="S3.E8.m1.12.12.1.1.1.1.1.1.1.1.3.3.cmml">⊤</mo></msubsup></mrow><mo id="S3.E8.m1.12.12.1.1.1.1.1.1.1.3" xref="S3.E8.m1.12.12.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E8.m1.12.12.1.1.1.1.3" xref="S3.E8.m1.12.12.1.1.1.1.3.cmml">=</mo><mrow id="S3.E8.m1.12.12.1.1.1.1.4" xref="S3.E8.m1.12.12.1.1.1.1.4.cmml"><msub id="S3.E8.m1.12.12.1.1.1.1.4.2" xref="S3.E8.m1.12.12.1.1.1.1.4.2.cmml"><mi id="S3.E8.m1.12.12.1.1.1.1.4.2.2" xref="S3.E8.m1.12.12.1.1.1.1.4.2.2.cmml">𝚽</mi><mrow id="S3.E8.m1.6.6.2.4" xref="S3.E8.m1.6.6.2.3.cmml"><mi id="S3.E8.m1.5.5.1.1" xref="S3.E8.m1.5.5.1.1.cmml">𝐐</mi><mo id="S3.E8.m1.6.6.2.4.1" xref="S3.E8.m1.6.6.2.3.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S3.E8.m1.6.6.2.2" xref="S3.E8.m1.6.6.2.2.cmml">𝒢</mi></mrow></msub><mo id="S3.E8.m1.12.12.1.1.1.1.4.1" xref="S3.E8.m1.12.12.1.1.1.1.4.1.cmml">⁢</mo><msubsup id="S3.E8.m1.12.12.1.1.1.1.4.3" xref="S3.E8.m1.12.12.1.1.1.1.4.3.cmml"><mi id="S3.E8.m1.12.12.1.1.1.1.4.3.2.2" xref="S3.E8.m1.12.12.1.1.1.1.4.3.2.2.cmml">𝚽</mi><mrow id="S3.E8.m1.8.8.2.4" xref="S3.E8.m1.8.8.2.3.cmml"><mi id="S3.E8.m1.7.7.1.1" xref="S3.E8.m1.7.7.1.1.cmml">𝐊</mi><mo id="S3.E8.m1.8.8.2.4.1" xref="S3.E8.m1.8.8.2.3.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S3.E8.m1.8.8.2.2" xref="S3.E8.m1.8.8.2.2.cmml">𝒢</mi></mrow><mo id="S3.E8.m1.12.12.1.1.1.1.4.3.3" xref="S3.E8.m1.12.12.1.1.1.1.4.3.3.cmml">⊤</mo></msubsup></mrow><mo id="S3.E8.m1.12.12.1.1.1.1.5" xref="S3.E8.m1.12.12.1.1.1.1.5.cmml">=</mo><mrow id="S3.E8.m1.12.12.1.1.1.1.6" xref="S3.E8.m1.12.12.1.1.1.1.6.cmml"><msub id="S3.E8.m1.12.12.1.1.1.1.6.2" xref="S3.E8.m1.12.12.1.1.1.1.6.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E8.m1.12.12.1.1.1.1.6.2.2" xref="S3.E8.m1.12.12.1.1.1.1.6.2.2.cmml">𝒦</mi><mtext id="S3.E8.m1.12.12.1.1.1.1.6.2.3" xref="S3.E8.m1.12.12.1.1.1.1.6.2.3a.cmml">LR</mtext></msub><mo id="S3.E8.m1.12.12.1.1.1.1.6.1" lspace="0.222em" rspace="0.222em" xref="S3.E8.m1.12.12.1.1.1.1.6.1.cmml">⊙</mo><msub id="S3.E8.m1.12.12.1.1.1.1.6.3" xref="S3.E8.m1.12.12.1.1.1.1.6.3.cmml"><mi id="S3.E8.m1.12.12.1.1.1.1.6.3.2" xref="S3.E8.m1.12.12.1.1.1.1.6.3.2.cmml">𝐌</mi><mi id="S3.E8.m1.12.12.1.1.1.1.6.3.3" xref="S3.E8.m1.12.12.1.1.1.1.6.3.3.cmml">α</mi></msub></mrow></mrow><mo id="S3.E8.m1.12.12.1.1.2.3" rspace="1.167em" xref="S3.E8.m1.12.12.1.1.3a.cmml">,</mo><mrow id="S3.E8.m1.12.12.1.1.2.2" xref="S3.E8.m1.12.12.1.1.2.2.cmml"><mrow id="S3.E8.m1.12.12.1.1.2.2.2" xref="S3.E8.m1.12.12.1.1.2.2.2.cmml"><msubsup id="S3.E8.m1.12.12.1.1.2.2.2.2" xref="S3.E8.m1.12.12.1.1.2.2.2.2.cmml"><mover accent="true" id="S3.E8.m1.12.12.1.1.2.2.2.2.2.2" xref="S3.E8.m1.12.12.1.1.2.2.2.2.2.2.cmml"><mi id="S3.E8.m1.12.12.1.1.2.2.2.2.2.2.2" xref="S3.E8.m1.12.12.1.1.2.2.2.2.2.2.2.cmml">𝚽</mi><mo id="S3.E8.m1.12.12.1.1.2.2.2.2.2.2.1" xref="S3.E8.m1.12.12.1.1.2.2.2.2.2.2.1.cmml">^</mo></mover><mrow id="S3.E8.m1.10.10.2.4" xref="S3.E8.m1.10.10.2.3.cmml"><mi id="S3.E8.m1.9.9.1.1" xref="S3.E8.m1.9.9.1.1.cmml">𝐊</mi><mo id="S3.E8.m1.10.10.2.4.1" xref="S3.E8.m1.10.10.2.3.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S3.E8.m1.10.10.2.2" xref="S3.E8.m1.10.10.2.2.cmml">𝒢</mi></mrow><mo id="S3.E8.m1.12.12.1.1.2.2.2.2.3" xref="S3.E8.m1.12.12.1.1.2.2.2.2.3.cmml">⊤</mo></msubsup><mo id="S3.E8.m1.12.12.1.1.2.2.2.1" xref="S3.E8.m1.12.12.1.1.2.2.2.1.cmml">⁢</mo><mi id="S3.E8.m1.12.12.1.1.2.2.2.3" xref="S3.E8.m1.12.12.1.1.2.2.2.3.cmml">𝒗</mi></mrow><mo id="S3.E8.m1.12.12.1.1.2.2.3" xref="S3.E8.m1.12.12.1.1.2.2.3.cmml">∼</mo><mrow id="S3.E8.m1.12.12.1.1.2.2.4" xref="S3.E8.m1.12.12.1.1.2.2.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E8.m1.12.12.1.1.2.2.4.2" xref="S3.E8.m1.12.12.1.1.2.2.4.2.cmml">𝒪</mi><mo id="S3.E8.m1.12.12.1.1.2.2.4.1" xref="S3.E8.m1.12.12.1.1.2.2.4.1.cmml">⁢</mo><mrow id="S3.E8.m1.12.12.1.1.2.2.4.3.2" xref="S3.E8.m1.12.12.1.1.2.2.4.cmml"><mo id="S3.E8.m1.12.12.1.1.2.2.4.3.2.1" stretchy="false" xref="S3.E8.m1.12.12.1.1.2.2.4.cmml">(</mo><mi id="S3.E8.m1.11.11" xref="S3.E8.m1.11.11.cmml">N</mi><mo id="S3.E8.m1.12.12.1.1.2.2.4.3.2.2" stretchy="false" xref="S3.E8.m1.12.12.1.1.2.2.4.cmml">)</mo></mrow><mo id="S3.E8.m1.12.12.1.1.2.2.4.1a" lspace="0.447em" xref="S3.E8.m1.12.12.1.1.2.2.4.1.cmml">⁢</mo><mrow id="S3.E8.m1.12.12.1.1.2.2.4.4" xref="S3.E8.m1.12.12.1.1.2.2.4.4.cmml"><mo id="S3.E8.m1.12.12.1.1.2.2.4.4.1" rspace="0.447em" xref="S3.E8.m1.12.12.1.1.2.2.4.4.1.cmml">∀</mo><mi id="S3.E8.m1.12.12.1.1.2.2.4.4.2" xref="S3.E8.m1.12.12.1.1.2.2.4.4.2.cmml">𝒗</mi></mrow></mrow><mo id="S3.E8.m1.12.12.1.1.2.2.5" xref="S3.E8.m1.12.12.1.1.2.2.5.cmml">∈</mo><msup id="S3.E8.m1.12.12.1.1.2.2.6" xref="S3.E8.m1.12.12.1.1.2.2.6.cmml"><mi id="S3.E8.m1.12.12.1.1.2.2.6.2" xref="S3.E8.m1.12.12.1.1.2.2.6.2.cmml">ℝ</mi><mi id="S3.E8.m1.12.12.1.1.2.2.6.3" xref="S3.E8.m1.12.12.1.1.2.2.6.3.cmml">N</mi></msup></mrow></mrow><mo id="S3.E8.m1.12.12.1.2">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E8.m1.12b"><apply id="S3.E8.m1.12.12.1.1.3.cmml" xref="S3.E8.m1.12.12.1.1.2"><csymbol cd="ambiguous" id="S3.E8.m1.12.12.1.1.3a.cmml" xref="S3.E8.m1.12.12.1.1.2.3">formulae-sequence</csymbol><apply id="S3.E8.m1.12.12.1.1.1.1.cmml" xref="S3.E8.m1.12.12.1.1.1.1"><and id="S3.E8.m1.12.12.1.1.1.1a.cmml" xref="S3.E8.m1.12.12.1.1.1.1"></and><apply id="S3.E8.m1.12.12.1.1.1.1b.cmml" xref="S3.E8.m1.12.12.1.1.1.1"><eq id="S3.E8.m1.12.12.1.1.1.1.3.cmml" xref="S3.E8.m1.12.12.1.1.1.1.3"></eq><apply id="S3.E8.m1.12.12.1.1.1.1.1.cmml" xref="S3.E8.m1.12.12.1.1.1.1.1"><times id="S3.E8.m1.12.12.1.1.1.1.1.2.cmml" xref="S3.E8.m1.12.12.1.1.1.1.1.2"></times><ci id="S3.E8.m1.12.12.1.1.1.1.1.3.cmml" xref="S3.E8.m1.12.12.1.1.1.1.1.3">𝔼</ci><apply id="S3.E8.m1.12.12.1.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.12.12.1.1.1.1.1.1.1"><times id="S3.E8.m1.12.12.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.12.12.1.1.1.1.1.1.1.1.1"></times><apply id="S3.E8.m1.12.12.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E8.m1.12.12.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E8.m1.12.12.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E8.m1.12.12.1.1.1.1.1.1.1.1.2">subscript</csymbol><apply id="S3.E8.m1.12.12.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E8.m1.12.12.1.1.1.1.1.1.1.1.2.2"><ci id="S3.E8.m1.12.12.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E8.m1.12.12.1.1.1.1.1.1.1.1.2.2.1">^</ci><ci id="S3.E8.m1.12.12.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E8.m1.12.12.1.1.1.1.1.1.1.1.2.2.2">𝚽</ci></apply><list id="S3.E8.m1.2.2.2.3.cmml" xref="S3.E8.m1.2.2.2.4"><ci id="S3.E8.m1.1.1.1.1.cmml" xref="S3.E8.m1.1.1.1.1">𝐐</ci><ci id="S3.E8.m1.2.2.2.2.cmml" xref="S3.E8.m1.2.2.2.2">𝒢</ci></list></apply><apply id="S3.E8.m1.12.12.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E8.m1.12.12.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E8.m1.12.12.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E8.m1.12.12.1.1.1.1.1.1.1.1.3">superscript</csymbol><apply id="S3.E8.m1.12.12.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E8.m1.12.12.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E8.m1.12.12.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E8.m1.12.12.1.1.1.1.1.1.1.1.3">subscript</csymbol><apply id="S3.E8.m1.12.12.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E8.m1.12.12.1.1.1.1.1.1.1.1.3.2.2"><ci id="S3.E8.m1.12.12.1.1.1.1.1.1.1.1.3.2.2.1.cmml" xref="S3.E8.m1.12.12.1.1.1.1.1.1.1.1.3.2.2.1">^</ci><ci id="S3.E8.m1.12.12.1.1.1.1.1.1.1.1.3.2.2.2.cmml" xref="S3.E8.m1.12.12.1.1.1.1.1.1.1.1.3.2.2.2">𝚽</ci></apply><list id="S3.E8.m1.4.4.2.3.cmml" xref="S3.E8.m1.4.4.2.4"><ci id="S3.E8.m1.3.3.1.1.cmml" xref="S3.E8.m1.3.3.1.1">𝐊</ci><ci id="S3.E8.m1.4.4.2.2.cmml" xref="S3.E8.m1.4.4.2.2">𝒢</ci></list></apply><csymbol cd="latexml" id="S3.E8.m1.12.12.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E8.m1.12.12.1.1.1.1.1.1.1.1.3.3">top</csymbol></apply></apply></apply><apply id="S3.E8.m1.12.12.1.1.1.1.4.cmml" xref="S3.E8.m1.12.12.1.1.1.1.4"><times id="S3.E8.m1.12.12.1.1.1.1.4.1.cmml" xref="S3.E8.m1.12.12.1.1.1.1.4.1"></times><apply id="S3.E8.m1.12.12.1.1.1.1.4.2.cmml" xref="S3.E8.m1.12.12.1.1.1.1.4.2"><csymbol cd="ambiguous" id="S3.E8.m1.12.12.1.1.1.1.4.2.1.cmml" xref="S3.E8.m1.12.12.1.1.1.1.4.2">subscript</csymbol><ci id="S3.E8.m1.12.12.1.1.1.1.4.2.2.cmml" xref="S3.E8.m1.12.12.1.1.1.1.4.2.2">𝚽</ci><list id="S3.E8.m1.6.6.2.3.cmml" xref="S3.E8.m1.6.6.2.4"><ci id="S3.E8.m1.5.5.1.1.cmml" xref="S3.E8.m1.5.5.1.1">𝐐</ci><ci id="S3.E8.m1.6.6.2.2.cmml" xref="S3.E8.m1.6.6.2.2">𝒢</ci></list></apply><apply id="S3.E8.m1.12.12.1.1.1.1.4.3.cmml" xref="S3.E8.m1.12.12.1.1.1.1.4.3"><csymbol cd="ambiguous" id="S3.E8.m1.12.12.1.1.1.1.4.3.1.cmml" xref="S3.E8.m1.12.12.1.1.1.1.4.3">superscript</csymbol><apply id="S3.E8.m1.12.12.1.1.1.1.4.3.2.cmml" xref="S3.E8.m1.12.12.1.1.1.1.4.3"><csymbol cd="ambiguous" id="S3.E8.m1.12.12.1.1.1.1.4.3.2.1.cmml" xref="S3.E8.m1.12.12.1.1.1.1.4.3">subscript</csymbol><ci id="S3.E8.m1.12.12.1.1.1.1.4.3.2.2.cmml" xref="S3.E8.m1.12.12.1.1.1.1.4.3.2.2">𝚽</ci><list id="S3.E8.m1.8.8.2.3.cmml" xref="S3.E8.m1.8.8.2.4"><ci id="S3.E8.m1.7.7.1.1.cmml" xref="S3.E8.m1.7.7.1.1">𝐊</ci><ci id="S3.E8.m1.8.8.2.2.cmml" xref="S3.E8.m1.8.8.2.2">𝒢</ci></list></apply><csymbol cd="latexml" id="S3.E8.m1.12.12.1.1.1.1.4.3.3.cmml" xref="S3.E8.m1.12.12.1.1.1.1.4.3.3">top</csymbol></apply></apply></apply><apply id="S3.E8.m1.12.12.1.1.1.1c.cmml" xref="S3.E8.m1.12.12.1.1.1.1"><eq id="S3.E8.m1.12.12.1.1.1.1.5.cmml" xref="S3.E8.m1.12.12.1.1.1.1.5"></eq><share href="https://arxiv.org/html/2410.03462v1#S3.E8.m1.12.12.1.1.1.1.4.cmml" id="S3.E8.m1.12.12.1.1.1.1d.cmml" xref="S3.E8.m1.12.12.1.1.1.1"></share><apply id="S3.E8.m1.12.12.1.1.1.1.6.cmml" xref="S3.E8.m1.12.12.1.1.1.1.6"><csymbol cd="latexml" id="S3.E8.m1.12.12.1.1.1.1.6.1.cmml" xref="S3.E8.m1.12.12.1.1.1.1.6.1">direct-product</csymbol><apply id="S3.E8.m1.12.12.1.1.1.1.6.2.cmml" xref="S3.E8.m1.12.12.1.1.1.1.6.2"><csymbol cd="ambiguous" id="S3.E8.m1.12.12.1.1.1.1.6.2.1.cmml" xref="S3.E8.m1.12.12.1.1.1.1.6.2">subscript</csymbol><ci id="S3.E8.m1.12.12.1.1.1.1.6.2.2.cmml" xref="S3.E8.m1.12.12.1.1.1.1.6.2.2">𝒦</ci><ci id="S3.E8.m1.12.12.1.1.1.1.6.2.3a.cmml" xref="S3.E8.m1.12.12.1.1.1.1.6.2.3"><mtext id="S3.E8.m1.12.12.1.1.1.1.6.2.3.cmml" mathsize="70%" xref="S3.E8.m1.12.12.1.1.1.1.6.2.3">LR</mtext></ci></apply><apply id="S3.E8.m1.12.12.1.1.1.1.6.3.cmml" xref="S3.E8.m1.12.12.1.1.1.1.6.3"><csymbol cd="ambiguous" id="S3.E8.m1.12.12.1.1.1.1.6.3.1.cmml" xref="S3.E8.m1.12.12.1.1.1.1.6.3">subscript</csymbol><ci id="S3.E8.m1.12.12.1.1.1.1.6.3.2.cmml" xref="S3.E8.m1.12.12.1.1.1.1.6.3.2">𝐌</ci><ci id="S3.E8.m1.12.12.1.1.1.1.6.3.3.cmml" xref="S3.E8.m1.12.12.1.1.1.1.6.3.3">𝛼</ci></apply></apply></apply></apply><apply id="S3.E8.m1.12.12.1.1.2.2.cmml" xref="S3.E8.m1.12.12.1.1.2.2"><and id="S3.E8.m1.12.12.1.1.2.2a.cmml" xref="S3.E8.m1.12.12.1.1.2.2"></and><apply id="S3.E8.m1.12.12.1.1.2.2b.cmml" xref="S3.E8.m1.12.12.1.1.2.2"><csymbol cd="latexml" id="S3.E8.m1.12.12.1.1.2.2.3.cmml" xref="S3.E8.m1.12.12.1.1.2.2.3">similar-to</csymbol><apply id="S3.E8.m1.12.12.1.1.2.2.2.cmml" xref="S3.E8.m1.12.12.1.1.2.2.2"><times id="S3.E8.m1.12.12.1.1.2.2.2.1.cmml" xref="S3.E8.m1.12.12.1.1.2.2.2.1"></times><apply id="S3.E8.m1.12.12.1.1.2.2.2.2.cmml" xref="S3.E8.m1.12.12.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E8.m1.12.12.1.1.2.2.2.2.1.cmml" xref="S3.E8.m1.12.12.1.1.2.2.2.2">superscript</csymbol><apply id="S3.E8.m1.12.12.1.1.2.2.2.2.2.cmml" xref="S3.E8.m1.12.12.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E8.m1.12.12.1.1.2.2.2.2.2.1.cmml" xref="S3.E8.m1.12.12.1.1.2.2.2.2">subscript</csymbol><apply id="S3.E8.m1.12.12.1.1.2.2.2.2.2.2.cmml" xref="S3.E8.m1.12.12.1.1.2.2.2.2.2.2"><ci id="S3.E8.m1.12.12.1.1.2.2.2.2.2.2.1.cmml" xref="S3.E8.m1.12.12.1.1.2.2.2.2.2.2.1">^</ci><ci id="S3.E8.m1.12.12.1.1.2.2.2.2.2.2.2.cmml" xref="S3.E8.m1.12.12.1.1.2.2.2.2.2.2.2">𝚽</ci></apply><list id="S3.E8.m1.10.10.2.3.cmml" xref="S3.E8.m1.10.10.2.4"><ci id="S3.E8.m1.9.9.1.1.cmml" xref="S3.E8.m1.9.9.1.1">𝐊</ci><ci id="S3.E8.m1.10.10.2.2.cmml" xref="S3.E8.m1.10.10.2.2">𝒢</ci></list></apply><csymbol cd="latexml" id="S3.E8.m1.12.12.1.1.2.2.2.2.3.cmml" xref="S3.E8.m1.12.12.1.1.2.2.2.2.3">top</csymbol></apply><ci id="S3.E8.m1.12.12.1.1.2.2.2.3.cmml" xref="S3.E8.m1.12.12.1.1.2.2.2.3">𝒗</ci></apply><apply id="S3.E8.m1.12.12.1.1.2.2.4.cmml" xref="S3.E8.m1.12.12.1.1.2.2.4"><times id="S3.E8.m1.12.12.1.1.2.2.4.1.cmml" xref="S3.E8.m1.12.12.1.1.2.2.4.1"></times><ci id="S3.E8.m1.12.12.1.1.2.2.4.2.cmml" xref="S3.E8.m1.12.12.1.1.2.2.4.2">𝒪</ci><ci id="S3.E8.m1.11.11.cmml" xref="S3.E8.m1.11.11">𝑁</ci><apply id="S3.E8.m1.12.12.1.1.2.2.4.4.cmml" xref="S3.E8.m1.12.12.1.1.2.2.4.4"><csymbol cd="latexml" id="S3.E8.m1.12.12.1.1.2.2.4.4.1.cmml" xref="S3.E8.m1.12.12.1.1.2.2.4.4.1">for-all</csymbol><ci id="S3.E8.m1.12.12.1.1.2.2.4.4.2.cmml" xref="S3.E8.m1.12.12.1.1.2.2.4.4.2">𝒗</ci></apply></apply></apply><apply id="S3.E8.m1.12.12.1.1.2.2c.cmml" xref="S3.E8.m1.12.12.1.1.2.2"><in id="S3.E8.m1.12.12.1.1.2.2.5.cmml" xref="S3.E8.m1.12.12.1.1.2.2.5"></in><share href="https://arxiv.org/html/2410.03462v1#S3.E8.m1.12.12.1.1.2.2.4.cmml" id="S3.E8.m1.12.12.1.1.2.2d.cmml" xref="S3.E8.m1.12.12.1.1.2.2"></share><apply id="S3.E8.m1.12.12.1.1.2.2.6.cmml" xref="S3.E8.m1.12.12.1.1.2.2.6"><csymbol cd="ambiguous" id="S3.E8.m1.12.12.1.1.2.2.6.1.cmml" xref="S3.E8.m1.12.12.1.1.2.2.6">superscript</csymbol><ci id="S3.E8.m1.12.12.1.1.2.2.6.2.cmml" xref="S3.E8.m1.12.12.1.1.2.2.6.2">ℝ</ci><ci id="S3.E8.m1.12.12.1.1.2.2.6.3.cmml" xref="S3.E8.m1.12.12.1.1.2.2.6.3">𝑁</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E8.m1.12c">\mathbb{E}\left(\widehat{\mathbf{\Phi}}_{\mathbf{Q},\mathcal{G}}\widehat{%
\mathbf{\Phi}}_{\mathbf{K},\mathcal{G}}^{\top}\right)=\mathbf{\Phi}_{\mathbf{Q%
},\mathcal{G}}\mathbf{\Phi}_{\mathbf{K},\mathcal{G}}^{\top}=\mathcal{K}_{%
\textrm{LR}}\odot\mathbf{M}_{\alpha},\quad\widehat{\mathbf{\Phi}}_{\mathbf{K},%
\mathcal{G}}^{\top}\bm{v}\sim\mathcal{O}(N)\hskip 2.84526pt\forall\hskip 2.845%
26pt\bm{v}\in\mathbb{R}^{N},</annotation><annotation encoding="application/x-llamapun" id="S3.E8.m1.12d">blackboard_E ( over^ start_ARG bold_Φ end_ARG start_POSTSUBSCRIPT bold_Q , caligraphic_G end_POSTSUBSCRIPT over^ start_ARG bold_Φ end_ARG start_POSTSUBSCRIPT bold_K , caligraphic_G end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT ) = bold_Φ start_POSTSUBSCRIPT bold_Q , caligraphic_G end_POSTSUBSCRIPT bold_Φ start_POSTSUBSCRIPT bold_K , caligraphic_G end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT = caligraphic_K start_POSTSUBSCRIPT LR end_POSTSUBSCRIPT ⊙ bold_M start_POSTSUBSCRIPT italic_α end_POSTSUBSCRIPT , over^ start_ARG bold_Φ end_ARG start_POSTSUBSCRIPT bold_K , caligraphic_G end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT bold_italic_v ∼ caligraphic_O ( italic_N ) ∀ bold_italic_v ∈ blackboard_R start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.p1.3">meaning we apply the desired topological mask in expectation but in linear time.
This can be achieved using <em class="ltx_emph ltx_font_italic" id="S3.SS3.p1.3.1">graph random features</em> (GRFs) <cite class="ltx_cite ltx_citemacro_citep">(Choromanski, <a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#bib.bib8" title="">2023</a>; Reid et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#bib.bib29" title="">2024b</a>)</cite>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS3.p2">
<p class="ltx_p" id="S3.SS3.p2.13">At a high-level, GRFs can be understood as follows.
From Remark <a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#S3.Thmremark1" title="Remark 3.1 (Explicit 𝑁-dimensional features for graph node kernels (Reid et al., 2024b)). ‣ 3.2 Implicit masking with graph features ‣ 3 Towards linear topological masking ‣ Linear Transformer Topological Masking with Graph Random Features"><span class="ltx_text ltx_ref_tag">3.1</span></a>, the graph feature for node <math alttext="v_{i}" class="ltx_Math" display="inline" id="S3.SS3.p2.1.m1.1"><semantics id="S3.SS3.p2.1.m1.1a"><msub id="S3.SS3.p2.1.m1.1.1" xref="S3.SS3.p2.1.m1.1.1.cmml"><mi id="S3.SS3.p2.1.m1.1.1.2" xref="S3.SS3.p2.1.m1.1.1.2.cmml">v</mi><mi id="S3.SS3.p2.1.m1.1.1.3" xref="S3.SS3.p2.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.1.m1.1b"><apply id="S3.SS3.p2.1.m1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.1.m1.1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1">subscript</csymbol><ci id="S3.SS3.p2.1.m1.1.1.2.cmml" xref="S3.SS3.p2.1.m1.1.1.2">𝑣</ci><ci id="S3.SS3.p2.1.m1.1.1.3.cmml" xref="S3.SS3.p2.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.1.m1.1c">v_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.1.m1.1d">italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> is given by <math alttext="\phi_{\mathcal{G}}(v_{i})\coloneqq[\sum_{k=0}^{\infty}f_{k}\mathbf{W}^{k}_{ij}%
]_{j=1}^{N}" class="ltx_Math" display="inline" id="S3.SS3.p2.2.m2.2"><semantics id="S3.SS3.p2.2.m2.2a"><mrow id="S3.SS3.p2.2.m2.2.2" xref="S3.SS3.p2.2.m2.2.2.cmml"><mrow id="S3.SS3.p2.2.m2.1.1.1" xref="S3.SS3.p2.2.m2.1.1.1.cmml"><msub id="S3.SS3.p2.2.m2.1.1.1.3" xref="S3.SS3.p2.2.m2.1.1.1.3.cmml"><mi id="S3.SS3.p2.2.m2.1.1.1.3.2" xref="S3.SS3.p2.2.m2.1.1.1.3.2.cmml">ϕ</mi><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p2.2.m2.1.1.1.3.3" xref="S3.SS3.p2.2.m2.1.1.1.3.3.cmml">𝒢</mi></msub><mo id="S3.SS3.p2.2.m2.1.1.1.2" xref="S3.SS3.p2.2.m2.1.1.1.2.cmml">⁢</mo><mrow id="S3.SS3.p2.2.m2.1.1.1.1.1" xref="S3.SS3.p2.2.m2.1.1.1.1.1.1.cmml"><mo id="S3.SS3.p2.2.m2.1.1.1.1.1.2" stretchy="false" xref="S3.SS3.p2.2.m2.1.1.1.1.1.1.cmml">(</mo><msub id="S3.SS3.p2.2.m2.1.1.1.1.1.1" xref="S3.SS3.p2.2.m2.1.1.1.1.1.1.cmml"><mi id="S3.SS3.p2.2.m2.1.1.1.1.1.1.2" xref="S3.SS3.p2.2.m2.1.1.1.1.1.1.2.cmml">v</mi><mi id="S3.SS3.p2.2.m2.1.1.1.1.1.1.3" xref="S3.SS3.p2.2.m2.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS3.p2.2.m2.1.1.1.1.1.3" stretchy="false" xref="S3.SS3.p2.2.m2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS3.p2.2.m2.2.2.3" xref="S3.SS3.p2.2.m2.2.2.3.cmml">≔</mo><msubsup id="S3.SS3.p2.2.m2.2.2.2" xref="S3.SS3.p2.2.m2.2.2.2.cmml"><mrow id="S3.SS3.p2.2.m2.2.2.2.1.1.1" xref="S3.SS3.p2.2.m2.2.2.2.1.1.2.cmml"><mo id="S3.SS3.p2.2.m2.2.2.2.1.1.1.2" stretchy="false" xref="S3.SS3.p2.2.m2.2.2.2.1.1.2.1.cmml">[</mo><mrow id="S3.SS3.p2.2.m2.2.2.2.1.1.1.1" xref="S3.SS3.p2.2.m2.2.2.2.1.1.1.1.cmml"><msubsup id="S3.SS3.p2.2.m2.2.2.2.1.1.1.1.1" xref="S3.SS3.p2.2.m2.2.2.2.1.1.1.1.1.cmml"><mo id="S3.SS3.p2.2.m2.2.2.2.1.1.1.1.1.2.2" lspace="0em" xref="S3.SS3.p2.2.m2.2.2.2.1.1.1.1.1.2.2.cmml">∑</mo><mrow id="S3.SS3.p2.2.m2.2.2.2.1.1.1.1.1.2.3" xref="S3.SS3.p2.2.m2.2.2.2.1.1.1.1.1.2.3.cmml"><mi id="S3.SS3.p2.2.m2.2.2.2.1.1.1.1.1.2.3.2" xref="S3.SS3.p2.2.m2.2.2.2.1.1.1.1.1.2.3.2.cmml">k</mi><mo id="S3.SS3.p2.2.m2.2.2.2.1.1.1.1.1.2.3.1" xref="S3.SS3.p2.2.m2.2.2.2.1.1.1.1.1.2.3.1.cmml">=</mo><mn id="S3.SS3.p2.2.m2.2.2.2.1.1.1.1.1.2.3.3" xref="S3.SS3.p2.2.m2.2.2.2.1.1.1.1.1.2.3.3.cmml">0</mn></mrow><mi id="S3.SS3.p2.2.m2.2.2.2.1.1.1.1.1.3" mathvariant="normal" xref="S3.SS3.p2.2.m2.2.2.2.1.1.1.1.1.3.cmml">∞</mi></msubsup><mrow id="S3.SS3.p2.2.m2.2.2.2.1.1.1.1.2" xref="S3.SS3.p2.2.m2.2.2.2.1.1.1.1.2.cmml"><msub id="S3.SS3.p2.2.m2.2.2.2.1.1.1.1.2.2" xref="S3.SS3.p2.2.m2.2.2.2.1.1.1.1.2.2.cmml"><mi id="S3.SS3.p2.2.m2.2.2.2.1.1.1.1.2.2.2" xref="S3.SS3.p2.2.m2.2.2.2.1.1.1.1.2.2.2.cmml">f</mi><mi id="S3.SS3.p2.2.m2.2.2.2.1.1.1.1.2.2.3" xref="S3.SS3.p2.2.m2.2.2.2.1.1.1.1.2.2.3.cmml">k</mi></msub><mo id="S3.SS3.p2.2.m2.2.2.2.1.1.1.1.2.1" xref="S3.SS3.p2.2.m2.2.2.2.1.1.1.1.2.1.cmml">⁢</mo><msubsup id="S3.SS3.p2.2.m2.2.2.2.1.1.1.1.2.3" xref="S3.SS3.p2.2.m2.2.2.2.1.1.1.1.2.3.cmml"><mi id="S3.SS3.p2.2.m2.2.2.2.1.1.1.1.2.3.2.2" xref="S3.SS3.p2.2.m2.2.2.2.1.1.1.1.2.3.2.2.cmml">𝐖</mi><mrow id="S3.SS3.p2.2.m2.2.2.2.1.1.1.1.2.3.3" xref="S3.SS3.p2.2.m2.2.2.2.1.1.1.1.2.3.3.cmml"><mi id="S3.SS3.p2.2.m2.2.2.2.1.1.1.1.2.3.3.2" xref="S3.SS3.p2.2.m2.2.2.2.1.1.1.1.2.3.3.2.cmml">i</mi><mo id="S3.SS3.p2.2.m2.2.2.2.1.1.1.1.2.3.3.1" xref="S3.SS3.p2.2.m2.2.2.2.1.1.1.1.2.3.3.1.cmml">⁢</mo><mi id="S3.SS3.p2.2.m2.2.2.2.1.1.1.1.2.3.3.3" xref="S3.SS3.p2.2.m2.2.2.2.1.1.1.1.2.3.3.3.cmml">j</mi></mrow><mi id="S3.SS3.p2.2.m2.2.2.2.1.1.1.1.2.3.2.3" xref="S3.SS3.p2.2.m2.2.2.2.1.1.1.1.2.3.2.3.cmml">k</mi></msubsup></mrow></mrow><mo id="S3.SS3.p2.2.m2.2.2.2.1.1.1.3" stretchy="false" xref="S3.SS3.p2.2.m2.2.2.2.1.1.2.1.cmml">]</mo></mrow><mrow id="S3.SS3.p2.2.m2.2.2.2.1.3" xref="S3.SS3.p2.2.m2.2.2.2.1.3.cmml"><mi id="S3.SS3.p2.2.m2.2.2.2.1.3.2" xref="S3.SS3.p2.2.m2.2.2.2.1.3.2.cmml">j</mi><mo id="S3.SS3.p2.2.m2.2.2.2.1.3.1" xref="S3.SS3.p2.2.m2.2.2.2.1.3.1.cmml">=</mo><mn id="S3.SS3.p2.2.m2.2.2.2.1.3.3" xref="S3.SS3.p2.2.m2.2.2.2.1.3.3.cmml">1</mn></mrow><mi id="S3.SS3.p2.2.m2.2.2.2.3" xref="S3.SS3.p2.2.m2.2.2.2.3.cmml">N</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.2.m2.2b"><apply id="S3.SS3.p2.2.m2.2.2.cmml" xref="S3.SS3.p2.2.m2.2.2"><ci id="S3.SS3.p2.2.m2.2.2.3.cmml" xref="S3.SS3.p2.2.m2.2.2.3">≔</ci><apply id="S3.SS3.p2.2.m2.1.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1.1"><times id="S3.SS3.p2.2.m2.1.1.1.2.cmml" xref="S3.SS3.p2.2.m2.1.1.1.2"></times><apply id="S3.SS3.p2.2.m2.1.1.1.3.cmml" xref="S3.SS3.p2.2.m2.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p2.2.m2.1.1.1.3.1.cmml" xref="S3.SS3.p2.2.m2.1.1.1.3">subscript</csymbol><ci id="S3.SS3.p2.2.m2.1.1.1.3.2.cmml" xref="S3.SS3.p2.2.m2.1.1.1.3.2">italic-ϕ</ci><ci id="S3.SS3.p2.2.m2.1.1.1.3.3.cmml" xref="S3.SS3.p2.2.m2.1.1.1.3.3">𝒢</ci></apply><apply id="S3.SS3.p2.2.m2.1.1.1.1.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.2.m2.1.1.1.1.1.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1.1.1.1">subscript</csymbol><ci id="S3.SS3.p2.2.m2.1.1.1.1.1.1.2.cmml" xref="S3.SS3.p2.2.m2.1.1.1.1.1.1.2">𝑣</ci><ci id="S3.SS3.p2.2.m2.1.1.1.1.1.1.3.cmml" xref="S3.SS3.p2.2.m2.1.1.1.1.1.1.3">𝑖</ci></apply></apply><apply id="S3.SS3.p2.2.m2.2.2.2.cmml" xref="S3.SS3.p2.2.m2.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.p2.2.m2.2.2.2.2.cmml" xref="S3.SS3.p2.2.m2.2.2.2">superscript</csymbol><apply id="S3.SS3.p2.2.m2.2.2.2.1.cmml" xref="S3.SS3.p2.2.m2.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.p2.2.m2.2.2.2.1.2.cmml" xref="S3.SS3.p2.2.m2.2.2.2">subscript</csymbol><apply id="S3.SS3.p2.2.m2.2.2.2.1.1.2.cmml" xref="S3.SS3.p2.2.m2.2.2.2.1.1.1"><csymbol cd="latexml" id="S3.SS3.p2.2.m2.2.2.2.1.1.2.1.cmml" xref="S3.SS3.p2.2.m2.2.2.2.1.1.1.2">delimited-[]</csymbol><apply id="S3.SS3.p2.2.m2.2.2.2.1.1.1.1.cmml" xref="S3.SS3.p2.2.m2.2.2.2.1.1.1.1"><apply id="S3.SS3.p2.2.m2.2.2.2.1.1.1.1.1.cmml" xref="S3.SS3.p2.2.m2.2.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.2.m2.2.2.2.1.1.1.1.1.1.cmml" xref="S3.SS3.p2.2.m2.2.2.2.1.1.1.1.1">superscript</csymbol><apply id="S3.SS3.p2.2.m2.2.2.2.1.1.1.1.1.2.cmml" xref="S3.SS3.p2.2.m2.2.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.2.m2.2.2.2.1.1.1.1.1.2.1.cmml" xref="S3.SS3.p2.2.m2.2.2.2.1.1.1.1.1">subscript</csymbol><sum id="S3.SS3.p2.2.m2.2.2.2.1.1.1.1.1.2.2.cmml" xref="S3.SS3.p2.2.m2.2.2.2.1.1.1.1.1.2.2"></sum><apply id="S3.SS3.p2.2.m2.2.2.2.1.1.1.1.1.2.3.cmml" xref="S3.SS3.p2.2.m2.2.2.2.1.1.1.1.1.2.3"><eq id="S3.SS3.p2.2.m2.2.2.2.1.1.1.1.1.2.3.1.cmml" xref="S3.SS3.p2.2.m2.2.2.2.1.1.1.1.1.2.3.1"></eq><ci id="S3.SS3.p2.2.m2.2.2.2.1.1.1.1.1.2.3.2.cmml" xref="S3.SS3.p2.2.m2.2.2.2.1.1.1.1.1.2.3.2">𝑘</ci><cn id="S3.SS3.p2.2.m2.2.2.2.1.1.1.1.1.2.3.3.cmml" type="integer" xref="S3.SS3.p2.2.m2.2.2.2.1.1.1.1.1.2.3.3">0</cn></apply></apply><infinity id="S3.SS3.p2.2.m2.2.2.2.1.1.1.1.1.3.cmml" xref="S3.SS3.p2.2.m2.2.2.2.1.1.1.1.1.3"></infinity></apply><apply id="S3.SS3.p2.2.m2.2.2.2.1.1.1.1.2.cmml" xref="S3.SS3.p2.2.m2.2.2.2.1.1.1.1.2"><times id="S3.SS3.p2.2.m2.2.2.2.1.1.1.1.2.1.cmml" xref="S3.SS3.p2.2.m2.2.2.2.1.1.1.1.2.1"></times><apply id="S3.SS3.p2.2.m2.2.2.2.1.1.1.1.2.2.cmml" xref="S3.SS3.p2.2.m2.2.2.2.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.SS3.p2.2.m2.2.2.2.1.1.1.1.2.2.1.cmml" xref="S3.SS3.p2.2.m2.2.2.2.1.1.1.1.2.2">subscript</csymbol><ci id="S3.SS3.p2.2.m2.2.2.2.1.1.1.1.2.2.2.cmml" xref="S3.SS3.p2.2.m2.2.2.2.1.1.1.1.2.2.2">𝑓</ci><ci id="S3.SS3.p2.2.m2.2.2.2.1.1.1.1.2.2.3.cmml" xref="S3.SS3.p2.2.m2.2.2.2.1.1.1.1.2.2.3">𝑘</ci></apply><apply id="S3.SS3.p2.2.m2.2.2.2.1.1.1.1.2.3.cmml" xref="S3.SS3.p2.2.m2.2.2.2.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.SS3.p2.2.m2.2.2.2.1.1.1.1.2.3.1.cmml" xref="S3.SS3.p2.2.m2.2.2.2.1.1.1.1.2.3">subscript</csymbol><apply id="S3.SS3.p2.2.m2.2.2.2.1.1.1.1.2.3.2.cmml" xref="S3.SS3.p2.2.m2.2.2.2.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.SS3.p2.2.m2.2.2.2.1.1.1.1.2.3.2.1.cmml" xref="S3.SS3.p2.2.m2.2.2.2.1.1.1.1.2.3">superscript</csymbol><ci id="S3.SS3.p2.2.m2.2.2.2.1.1.1.1.2.3.2.2.cmml" xref="S3.SS3.p2.2.m2.2.2.2.1.1.1.1.2.3.2.2">𝐖</ci><ci id="S3.SS3.p2.2.m2.2.2.2.1.1.1.1.2.3.2.3.cmml" xref="S3.SS3.p2.2.m2.2.2.2.1.1.1.1.2.3.2.3">𝑘</ci></apply><apply id="S3.SS3.p2.2.m2.2.2.2.1.1.1.1.2.3.3.cmml" xref="S3.SS3.p2.2.m2.2.2.2.1.1.1.1.2.3.3"><times id="S3.SS3.p2.2.m2.2.2.2.1.1.1.1.2.3.3.1.cmml" xref="S3.SS3.p2.2.m2.2.2.2.1.1.1.1.2.3.3.1"></times><ci id="S3.SS3.p2.2.m2.2.2.2.1.1.1.1.2.3.3.2.cmml" xref="S3.SS3.p2.2.m2.2.2.2.1.1.1.1.2.3.3.2">𝑖</ci><ci id="S3.SS3.p2.2.m2.2.2.2.1.1.1.1.2.3.3.3.cmml" xref="S3.SS3.p2.2.m2.2.2.2.1.1.1.1.2.3.3.3">𝑗</ci></apply></apply></apply></apply></apply><apply id="S3.SS3.p2.2.m2.2.2.2.1.3.cmml" xref="S3.SS3.p2.2.m2.2.2.2.1.3"><eq id="S3.SS3.p2.2.m2.2.2.2.1.3.1.cmml" xref="S3.SS3.p2.2.m2.2.2.2.1.3.1"></eq><ci id="S3.SS3.p2.2.m2.2.2.2.1.3.2.cmml" xref="S3.SS3.p2.2.m2.2.2.2.1.3.2">𝑗</ci><cn id="S3.SS3.p2.2.m2.2.2.2.1.3.3.cmml" type="integer" xref="S3.SS3.p2.2.m2.2.2.2.1.3.3">1</cn></apply></apply><ci id="S3.SS3.p2.2.m2.2.2.2.3.cmml" xref="S3.SS3.p2.2.m2.2.2.2.3">𝑁</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.2.m2.2c">\phi_{\mathcal{G}}(v_{i})\coloneqq[\sum_{k=0}^{\infty}f_{k}\mathbf{W}^{k}_{ij}%
]_{j=1}^{N}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.2.m2.2d">italic_ϕ start_POSTSUBSCRIPT caligraphic_G end_POSTSUBSCRIPT ( italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) ≔ [ ∑ start_POSTSUBSCRIPT italic_k = 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∞ end_POSTSUPERSCRIPT italic_f start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT bold_W start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT ] start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT</annotation></semantics></math>.
Since <math alttext="\mathbf{W}" class="ltx_Math" display="inline" id="S3.SS3.p2.3.m3.1"><semantics id="S3.SS3.p2.3.m3.1a"><mi id="S3.SS3.p2.3.m3.1.1" xref="S3.SS3.p2.3.m3.1.1.cmml">𝐖</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.3.m3.1b"><ci id="S3.SS3.p2.3.m3.1.1.cmml" xref="S3.SS3.p2.3.m3.1.1">𝐖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.3.m3.1c">\mathbf{W}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.3.m3.1d">bold_W</annotation></semantics></math> is an adjacency matrix, <math alttext="\mathbf{W}^{k}_{ij}" class="ltx_Math" display="inline" id="S3.SS3.p2.4.m4.1"><semantics id="S3.SS3.p2.4.m4.1a"><msubsup id="S3.SS3.p2.4.m4.1.1" xref="S3.SS3.p2.4.m4.1.1.cmml"><mi id="S3.SS3.p2.4.m4.1.1.2.2" xref="S3.SS3.p2.4.m4.1.1.2.2.cmml">𝐖</mi><mrow id="S3.SS3.p2.4.m4.1.1.3" xref="S3.SS3.p2.4.m4.1.1.3.cmml"><mi id="S3.SS3.p2.4.m4.1.1.3.2" xref="S3.SS3.p2.4.m4.1.1.3.2.cmml">i</mi><mo id="S3.SS3.p2.4.m4.1.1.3.1" xref="S3.SS3.p2.4.m4.1.1.3.1.cmml">⁢</mo><mi id="S3.SS3.p2.4.m4.1.1.3.3" xref="S3.SS3.p2.4.m4.1.1.3.3.cmml">j</mi></mrow><mi id="S3.SS3.p2.4.m4.1.1.2.3" xref="S3.SS3.p2.4.m4.1.1.2.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.4.m4.1b"><apply id="S3.SS3.p2.4.m4.1.1.cmml" xref="S3.SS3.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.4.m4.1.1.1.cmml" xref="S3.SS3.p2.4.m4.1.1">subscript</csymbol><apply id="S3.SS3.p2.4.m4.1.1.2.cmml" xref="S3.SS3.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.4.m4.1.1.2.1.cmml" xref="S3.SS3.p2.4.m4.1.1">superscript</csymbol><ci id="S3.SS3.p2.4.m4.1.1.2.2.cmml" xref="S3.SS3.p2.4.m4.1.1.2.2">𝐖</ci><ci id="S3.SS3.p2.4.m4.1.1.2.3.cmml" xref="S3.SS3.p2.4.m4.1.1.2.3">𝑘</ci></apply><apply id="S3.SS3.p2.4.m4.1.1.3.cmml" xref="S3.SS3.p2.4.m4.1.1.3"><times id="S3.SS3.p2.4.m4.1.1.3.1.cmml" xref="S3.SS3.p2.4.m4.1.1.3.1"></times><ci id="S3.SS3.p2.4.m4.1.1.3.2.cmml" xref="S3.SS3.p2.4.m4.1.1.3.2">𝑖</ci><ci id="S3.SS3.p2.4.m4.1.1.3.3.cmml" xref="S3.SS3.p2.4.m4.1.1.3.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.4.m4.1c">\mathbf{W}^{k}_{ij}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.4.m4.1d">bold_W start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT</annotation></semantics></math> counts the number of graph walks of length <math alttext="k" class="ltx_Math" display="inline" id="S3.SS3.p2.5.m5.1"><semantics id="S3.SS3.p2.5.m5.1a"><mi id="S3.SS3.p2.5.m5.1.1" xref="S3.SS3.p2.5.m5.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.5.m5.1b"><ci id="S3.SS3.p2.5.m5.1.1.cmml" xref="S3.SS3.p2.5.m5.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.5.m5.1c">k</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.5.m5.1d">italic_k</annotation></semantics></math> between nodes <math alttext="i" class="ltx_Math" display="inline" id="S3.SS3.p2.6.m6.1"><semantics id="S3.SS3.p2.6.m6.1a"><mi id="S3.SS3.p2.6.m6.1.1" xref="S3.SS3.p2.6.m6.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.6.m6.1b"><ci id="S3.SS3.p2.6.m6.1.1.cmml" xref="S3.SS3.p2.6.m6.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.6.m6.1c">i</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.6.m6.1d">italic_i</annotation></semantics></math> and <math alttext="j" class="ltx_Math" display="inline" id="S3.SS3.p2.7.m7.1"><semantics id="S3.SS3.p2.7.m7.1a"><mi id="S3.SS3.p2.7.m7.1.1" xref="S3.SS3.p2.7.m7.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.7.m7.1b"><ci id="S3.SS3.p2.7.m7.1.1.cmml" xref="S3.SS3.p2.7.m7.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.7.m7.1c">j</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.7.m7.1d">italic_j</annotation></semantics></math>, weighted by the product of traversed edge weights.
So <math alttext="\phi_{\mathcal{G}}(v_{i})_{j}" class="ltx_Math" display="inline" id="S3.SS3.p2.8.m8.1"><semantics id="S3.SS3.p2.8.m8.1a"><mrow id="S3.SS3.p2.8.m8.1.1" xref="S3.SS3.p2.8.m8.1.1.cmml"><msub id="S3.SS3.p2.8.m8.1.1.3" xref="S3.SS3.p2.8.m8.1.1.3.cmml"><mi id="S3.SS3.p2.8.m8.1.1.3.2" xref="S3.SS3.p2.8.m8.1.1.3.2.cmml">ϕ</mi><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p2.8.m8.1.1.3.3" xref="S3.SS3.p2.8.m8.1.1.3.3.cmml">𝒢</mi></msub><mo id="S3.SS3.p2.8.m8.1.1.2" xref="S3.SS3.p2.8.m8.1.1.2.cmml">⁢</mo><msub id="S3.SS3.p2.8.m8.1.1.1" xref="S3.SS3.p2.8.m8.1.1.1.cmml"><mrow id="S3.SS3.p2.8.m8.1.1.1.1.1" xref="S3.SS3.p2.8.m8.1.1.1.1.1.1.cmml"><mo id="S3.SS3.p2.8.m8.1.1.1.1.1.2" stretchy="false" xref="S3.SS3.p2.8.m8.1.1.1.1.1.1.cmml">(</mo><msub id="S3.SS3.p2.8.m8.1.1.1.1.1.1" xref="S3.SS3.p2.8.m8.1.1.1.1.1.1.cmml"><mi id="S3.SS3.p2.8.m8.1.1.1.1.1.1.2" xref="S3.SS3.p2.8.m8.1.1.1.1.1.1.2.cmml">v</mi><mi id="S3.SS3.p2.8.m8.1.1.1.1.1.1.3" xref="S3.SS3.p2.8.m8.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS3.p2.8.m8.1.1.1.1.1.3" stretchy="false" xref="S3.SS3.p2.8.m8.1.1.1.1.1.1.cmml">)</mo></mrow><mi id="S3.SS3.p2.8.m8.1.1.1.3" xref="S3.SS3.p2.8.m8.1.1.1.3.cmml">j</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.8.m8.1b"><apply id="S3.SS3.p2.8.m8.1.1.cmml" xref="S3.SS3.p2.8.m8.1.1"><times id="S3.SS3.p2.8.m8.1.1.2.cmml" xref="S3.SS3.p2.8.m8.1.1.2"></times><apply id="S3.SS3.p2.8.m8.1.1.3.cmml" xref="S3.SS3.p2.8.m8.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p2.8.m8.1.1.3.1.cmml" xref="S3.SS3.p2.8.m8.1.1.3">subscript</csymbol><ci id="S3.SS3.p2.8.m8.1.1.3.2.cmml" xref="S3.SS3.p2.8.m8.1.1.3.2">italic-ϕ</ci><ci id="S3.SS3.p2.8.m8.1.1.3.3.cmml" xref="S3.SS3.p2.8.m8.1.1.3.3">𝒢</ci></apply><apply id="S3.SS3.p2.8.m8.1.1.1.cmml" xref="S3.SS3.p2.8.m8.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.8.m8.1.1.1.2.cmml" xref="S3.SS3.p2.8.m8.1.1.1">subscript</csymbol><apply id="S3.SS3.p2.8.m8.1.1.1.1.1.1.cmml" xref="S3.SS3.p2.8.m8.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.8.m8.1.1.1.1.1.1.1.cmml" xref="S3.SS3.p2.8.m8.1.1.1.1.1">subscript</csymbol><ci id="S3.SS3.p2.8.m8.1.1.1.1.1.1.2.cmml" xref="S3.SS3.p2.8.m8.1.1.1.1.1.1.2">𝑣</ci><ci id="S3.SS3.p2.8.m8.1.1.1.1.1.1.3.cmml" xref="S3.SS3.p2.8.m8.1.1.1.1.1.1.3">𝑖</ci></apply><ci id="S3.SS3.p2.8.m8.1.1.1.3.cmml" xref="S3.SS3.p2.8.m8.1.1.1.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.8.m8.1c">\phi_{\mathcal{G}}(v_{i})_{j}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.8.m8.1d">italic_ϕ start_POSTSUBSCRIPT caligraphic_G end_POSTSUBSCRIPT ( italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> can be interpreted as a weighted sum over <em class="ltx_emph ltx_font_italic" id="S3.SS3.p2.13.1">all</em> walks of any length between nodes <math alttext="v_{i}" class="ltx_Math" display="inline" id="S3.SS3.p2.9.m9.1"><semantics id="S3.SS3.p2.9.m9.1a"><msub id="S3.SS3.p2.9.m9.1.1" xref="S3.SS3.p2.9.m9.1.1.cmml"><mi id="S3.SS3.p2.9.m9.1.1.2" xref="S3.SS3.p2.9.m9.1.1.2.cmml">v</mi><mi id="S3.SS3.p2.9.m9.1.1.3" xref="S3.SS3.p2.9.m9.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.9.m9.1b"><apply id="S3.SS3.p2.9.m9.1.1.cmml" xref="S3.SS3.p2.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.9.m9.1.1.1.cmml" xref="S3.SS3.p2.9.m9.1.1">subscript</csymbol><ci id="S3.SS3.p2.9.m9.1.1.2.cmml" xref="S3.SS3.p2.9.m9.1.1.2">𝑣</ci><ci id="S3.SS3.p2.9.m9.1.1.3.cmml" xref="S3.SS3.p2.9.m9.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.9.m9.1c">v_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.9.m9.1d">italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="v_{j}" class="ltx_Math" display="inline" id="S3.SS3.p2.10.m10.1"><semantics id="S3.SS3.p2.10.m10.1a"><msub id="S3.SS3.p2.10.m10.1.1" xref="S3.SS3.p2.10.m10.1.1.cmml"><mi id="S3.SS3.p2.10.m10.1.1.2" xref="S3.SS3.p2.10.m10.1.1.2.cmml">v</mi><mi id="S3.SS3.p2.10.m10.1.1.3" xref="S3.SS3.p2.10.m10.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.10.m10.1b"><apply id="S3.SS3.p2.10.m10.1.1.cmml" xref="S3.SS3.p2.10.m10.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.10.m10.1.1.1.cmml" xref="S3.SS3.p2.10.m10.1.1">subscript</csymbol><ci id="S3.SS3.p2.10.m10.1.1.2.cmml" xref="S3.SS3.p2.10.m10.1.1.2">𝑣</ci><ci id="S3.SS3.p2.10.m10.1.1.3.cmml" xref="S3.SS3.p2.10.m10.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.10.m10.1c">v_{j}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.10.m10.1d">italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math>, with
longer contributions suppressed since edge weights are at most <math alttext="1" class="ltx_Math" display="inline" id="S3.SS3.p2.11.m11.1"><semantics id="S3.SS3.p2.11.m11.1a"><mn id="S3.SS3.p2.11.m11.1.1" xref="S3.SS3.p2.11.m11.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.11.m11.1b"><cn id="S3.SS3.p2.11.m11.1.1.cmml" type="integer" xref="S3.SS3.p2.11.m11.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.11.m11.1c">1</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.11.m11.1d">1</annotation></semantics></math> (by normalisation of <math alttext="\mathbf{W}" class="ltx_Math" display="inline" id="S3.SS3.p2.12.m12.1"><semantics id="S3.SS3.p2.12.m12.1a"><mi id="S3.SS3.p2.12.m12.1.1" xref="S3.SS3.p2.12.m12.1.1.cmml">𝐖</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.12.m12.1b"><ci id="S3.SS3.p2.12.m12.1.1.cmml" xref="S3.SS3.p2.12.m12.1.1">𝐖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.12.m12.1c">\mathbf{W}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.12.m12.1d">bold_W</annotation></semantics></math>).
GRFs apply importance sampling, approximating this infinite sum by a Monte Carlo estimate <math alttext="\widehat{\phi}_{\mathcal{G}}(v_{i})" class="ltx_Math" display="inline" id="S3.SS3.p2.13.m13.1"><semantics id="S3.SS3.p2.13.m13.1a"><mrow id="S3.SS3.p2.13.m13.1.1" xref="S3.SS3.p2.13.m13.1.1.cmml"><msub id="S3.SS3.p2.13.m13.1.1.3" xref="S3.SS3.p2.13.m13.1.1.3.cmml"><mover accent="true" id="S3.SS3.p2.13.m13.1.1.3.2" xref="S3.SS3.p2.13.m13.1.1.3.2.cmml"><mi id="S3.SS3.p2.13.m13.1.1.3.2.2" xref="S3.SS3.p2.13.m13.1.1.3.2.2.cmml">ϕ</mi><mo id="S3.SS3.p2.13.m13.1.1.3.2.1" xref="S3.SS3.p2.13.m13.1.1.3.2.1.cmml">^</mo></mover><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p2.13.m13.1.1.3.3" xref="S3.SS3.p2.13.m13.1.1.3.3.cmml">𝒢</mi></msub><mo id="S3.SS3.p2.13.m13.1.1.2" xref="S3.SS3.p2.13.m13.1.1.2.cmml">⁢</mo><mrow id="S3.SS3.p2.13.m13.1.1.1.1" xref="S3.SS3.p2.13.m13.1.1.1.1.1.cmml"><mo id="S3.SS3.p2.13.m13.1.1.1.1.2" stretchy="false" xref="S3.SS3.p2.13.m13.1.1.1.1.1.cmml">(</mo><msub id="S3.SS3.p2.13.m13.1.1.1.1.1" xref="S3.SS3.p2.13.m13.1.1.1.1.1.cmml"><mi id="S3.SS3.p2.13.m13.1.1.1.1.1.2" xref="S3.SS3.p2.13.m13.1.1.1.1.1.2.cmml">v</mi><mi id="S3.SS3.p2.13.m13.1.1.1.1.1.3" xref="S3.SS3.p2.13.m13.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS3.p2.13.m13.1.1.1.1.3" stretchy="false" xref="S3.SS3.p2.13.m13.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.13.m13.1b"><apply id="S3.SS3.p2.13.m13.1.1.cmml" xref="S3.SS3.p2.13.m13.1.1"><times id="S3.SS3.p2.13.m13.1.1.2.cmml" xref="S3.SS3.p2.13.m13.1.1.2"></times><apply id="S3.SS3.p2.13.m13.1.1.3.cmml" xref="S3.SS3.p2.13.m13.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p2.13.m13.1.1.3.1.cmml" xref="S3.SS3.p2.13.m13.1.1.3">subscript</csymbol><apply id="S3.SS3.p2.13.m13.1.1.3.2.cmml" xref="S3.SS3.p2.13.m13.1.1.3.2"><ci id="S3.SS3.p2.13.m13.1.1.3.2.1.cmml" xref="S3.SS3.p2.13.m13.1.1.3.2.1">^</ci><ci id="S3.SS3.p2.13.m13.1.1.3.2.2.cmml" xref="S3.SS3.p2.13.m13.1.1.3.2.2">italic-ϕ</ci></apply><ci id="S3.SS3.p2.13.m13.1.1.3.3.cmml" xref="S3.SS3.p2.13.m13.1.1.3.3">𝒢</ci></apply><apply id="S3.SS3.p2.13.m13.1.1.1.1.1.cmml" xref="S3.SS3.p2.13.m13.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.13.m13.1.1.1.1.1.1.cmml" xref="S3.SS3.p2.13.m13.1.1.1.1">subscript</csymbol><ci id="S3.SS3.p2.13.m13.1.1.1.1.1.2.cmml" xref="S3.SS3.p2.13.m13.1.1.1.1.1.2">𝑣</ci><ci id="S3.SS3.p2.13.m13.1.1.1.1.1.3.cmml" xref="S3.SS3.p2.13.m13.1.1.1.1.1.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.13.m13.1c">\widehat{\phi}_{\mathcal{G}}(v_{i})</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.13.m13.1d">over^ start_ARG italic_ϕ end_ARG start_POSTSUBSCRIPT caligraphic_G end_POSTSUBSCRIPT ( italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT )</annotation></semantics></math> using random walks.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS3.p3">
<p class="ltx_p" id="S3.SS3.p3.10"><span class="ltx_text ltx_font_bold" id="S3.SS3.p3.10.1">Using GRFs.</span> Concretely, to build the GRF <math alttext="\widehat{\phi}_{\mathcal{G}}(v_{i})" class="ltx_Math" display="inline" id="S3.SS3.p3.1.m1.1"><semantics id="S3.SS3.p3.1.m1.1a"><mrow id="S3.SS3.p3.1.m1.1.1" xref="S3.SS3.p3.1.m1.1.1.cmml"><msub id="S3.SS3.p3.1.m1.1.1.3" xref="S3.SS3.p3.1.m1.1.1.3.cmml"><mover accent="true" id="S3.SS3.p3.1.m1.1.1.3.2" xref="S3.SS3.p3.1.m1.1.1.3.2.cmml"><mi id="S3.SS3.p3.1.m1.1.1.3.2.2" xref="S3.SS3.p3.1.m1.1.1.3.2.2.cmml">ϕ</mi><mo id="S3.SS3.p3.1.m1.1.1.3.2.1" xref="S3.SS3.p3.1.m1.1.1.3.2.1.cmml">^</mo></mover><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p3.1.m1.1.1.3.3" xref="S3.SS3.p3.1.m1.1.1.3.3.cmml">𝒢</mi></msub><mo id="S3.SS3.p3.1.m1.1.1.2" xref="S3.SS3.p3.1.m1.1.1.2.cmml">⁢</mo><mrow id="S3.SS3.p3.1.m1.1.1.1.1" xref="S3.SS3.p3.1.m1.1.1.1.1.1.cmml"><mo id="S3.SS3.p3.1.m1.1.1.1.1.2" stretchy="false" xref="S3.SS3.p3.1.m1.1.1.1.1.1.cmml">(</mo><msub id="S3.SS3.p3.1.m1.1.1.1.1.1" xref="S3.SS3.p3.1.m1.1.1.1.1.1.cmml"><mi id="S3.SS3.p3.1.m1.1.1.1.1.1.2" xref="S3.SS3.p3.1.m1.1.1.1.1.1.2.cmml">v</mi><mi id="S3.SS3.p3.1.m1.1.1.1.1.1.3" xref="S3.SS3.p3.1.m1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS3.p3.1.m1.1.1.1.1.3" stretchy="false" xref="S3.SS3.p3.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.1.m1.1b"><apply id="S3.SS3.p3.1.m1.1.1.cmml" xref="S3.SS3.p3.1.m1.1.1"><times id="S3.SS3.p3.1.m1.1.1.2.cmml" xref="S3.SS3.p3.1.m1.1.1.2"></times><apply id="S3.SS3.p3.1.m1.1.1.3.cmml" xref="S3.SS3.p3.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p3.1.m1.1.1.3.1.cmml" xref="S3.SS3.p3.1.m1.1.1.3">subscript</csymbol><apply id="S3.SS3.p3.1.m1.1.1.3.2.cmml" xref="S3.SS3.p3.1.m1.1.1.3.2"><ci id="S3.SS3.p3.1.m1.1.1.3.2.1.cmml" xref="S3.SS3.p3.1.m1.1.1.3.2.1">^</ci><ci id="S3.SS3.p3.1.m1.1.1.3.2.2.cmml" xref="S3.SS3.p3.1.m1.1.1.3.2.2">italic-ϕ</ci></apply><ci id="S3.SS3.p3.1.m1.1.1.3.3.cmml" xref="S3.SS3.p3.1.m1.1.1.3.3">𝒢</ci></apply><apply id="S3.SS3.p3.1.m1.1.1.1.1.1.cmml" xref="S3.SS3.p3.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS3.p3.1.m1.1.1.1.1">subscript</csymbol><ci id="S3.SS3.p3.1.m1.1.1.1.1.1.2.cmml" xref="S3.SS3.p3.1.m1.1.1.1.1.1.2">𝑣</ci><ci id="S3.SS3.p3.1.m1.1.1.1.1.1.3.cmml" xref="S3.SS3.p3.1.m1.1.1.1.1.1.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.1.m1.1c">\widehat{\phi}_{\mathcal{G}}(v_{i})</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.1.m1.1d">over^ start_ARG italic_ϕ end_ARG start_POSTSUBSCRIPT caligraphic_G end_POSTSUBSCRIPT ( italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT )</annotation></semantics></math> one samples <math alttext="n" class="ltx_Math" display="inline" id="S3.SS3.p3.2.m2.1"><semantics id="S3.SS3.p3.2.m2.1a"><mi id="S3.SS3.p3.2.m2.1.1" xref="S3.SS3.p3.2.m2.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.2.m2.1b"><ci id="S3.SS3.p3.2.m2.1.1.cmml" xref="S3.SS3.p3.2.m2.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.2.m2.1c">n</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.2.m2.1d">italic_n</annotation></semantics></math> random walks <math alttext="\{\omega^{(i)}_{k}\}_{k=1}^{n}\subset\Omega" class="ltx_Math" display="inline" id="S3.SS3.p3.3.m3.2"><semantics id="S3.SS3.p3.3.m3.2a"><mrow id="S3.SS3.p3.3.m3.2.2" xref="S3.SS3.p3.3.m3.2.2.cmml"><msubsup id="S3.SS3.p3.3.m3.2.2.1" xref="S3.SS3.p3.3.m3.2.2.1.cmml"><mrow id="S3.SS3.p3.3.m3.2.2.1.1.1.1" xref="S3.SS3.p3.3.m3.2.2.1.1.1.2.cmml"><mo id="S3.SS3.p3.3.m3.2.2.1.1.1.1.2" stretchy="false" xref="S3.SS3.p3.3.m3.2.2.1.1.1.2.cmml">{</mo><msubsup id="S3.SS3.p3.3.m3.2.2.1.1.1.1.1" xref="S3.SS3.p3.3.m3.2.2.1.1.1.1.1.cmml"><mi id="S3.SS3.p3.3.m3.2.2.1.1.1.1.1.2.2" xref="S3.SS3.p3.3.m3.2.2.1.1.1.1.1.2.2.cmml">ω</mi><mi id="S3.SS3.p3.3.m3.2.2.1.1.1.1.1.3" xref="S3.SS3.p3.3.m3.2.2.1.1.1.1.1.3.cmml">k</mi><mrow id="S3.SS3.p3.3.m3.1.1.1.3" xref="S3.SS3.p3.3.m3.2.2.1.1.1.1.1.cmml"><mo id="S3.SS3.p3.3.m3.1.1.1.3.1" stretchy="false" xref="S3.SS3.p3.3.m3.2.2.1.1.1.1.1.cmml">(</mo><mi id="S3.SS3.p3.3.m3.1.1.1.1" xref="S3.SS3.p3.3.m3.1.1.1.1.cmml">i</mi><mo id="S3.SS3.p3.3.m3.1.1.1.3.2" stretchy="false" xref="S3.SS3.p3.3.m3.2.2.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S3.SS3.p3.3.m3.2.2.1.1.1.1.3" stretchy="false" xref="S3.SS3.p3.3.m3.2.2.1.1.1.2.cmml">}</mo></mrow><mrow id="S3.SS3.p3.3.m3.2.2.1.1.3" xref="S3.SS3.p3.3.m3.2.2.1.1.3.cmml"><mi id="S3.SS3.p3.3.m3.2.2.1.1.3.2" xref="S3.SS3.p3.3.m3.2.2.1.1.3.2.cmml">k</mi><mo id="S3.SS3.p3.3.m3.2.2.1.1.3.1" xref="S3.SS3.p3.3.m3.2.2.1.1.3.1.cmml">=</mo><mn id="S3.SS3.p3.3.m3.2.2.1.1.3.3" xref="S3.SS3.p3.3.m3.2.2.1.1.3.3.cmml">1</mn></mrow><mi id="S3.SS3.p3.3.m3.2.2.1.3" xref="S3.SS3.p3.3.m3.2.2.1.3.cmml">n</mi></msubsup><mo id="S3.SS3.p3.3.m3.2.2.2" xref="S3.SS3.p3.3.m3.2.2.2.cmml">⊂</mo><mi id="S3.SS3.p3.3.m3.2.2.3" mathvariant="normal" xref="S3.SS3.p3.3.m3.2.2.3.cmml">Ω</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.3.m3.2b"><apply id="S3.SS3.p3.3.m3.2.2.cmml" xref="S3.SS3.p3.3.m3.2.2"><subset id="S3.SS3.p3.3.m3.2.2.2.cmml" xref="S3.SS3.p3.3.m3.2.2.2"></subset><apply id="S3.SS3.p3.3.m3.2.2.1.cmml" xref="S3.SS3.p3.3.m3.2.2.1"><csymbol cd="ambiguous" id="S3.SS3.p3.3.m3.2.2.1.2.cmml" xref="S3.SS3.p3.3.m3.2.2.1">superscript</csymbol><apply id="S3.SS3.p3.3.m3.2.2.1.1.cmml" xref="S3.SS3.p3.3.m3.2.2.1"><csymbol cd="ambiguous" id="S3.SS3.p3.3.m3.2.2.1.1.2.cmml" xref="S3.SS3.p3.3.m3.2.2.1">subscript</csymbol><set id="S3.SS3.p3.3.m3.2.2.1.1.1.2.cmml" xref="S3.SS3.p3.3.m3.2.2.1.1.1.1"><apply id="S3.SS3.p3.3.m3.2.2.1.1.1.1.1.cmml" xref="S3.SS3.p3.3.m3.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.3.m3.2.2.1.1.1.1.1.1.cmml" xref="S3.SS3.p3.3.m3.2.2.1.1.1.1.1">subscript</csymbol><apply id="S3.SS3.p3.3.m3.2.2.1.1.1.1.1.2.cmml" xref="S3.SS3.p3.3.m3.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.3.m3.2.2.1.1.1.1.1.2.1.cmml" xref="S3.SS3.p3.3.m3.2.2.1.1.1.1.1">superscript</csymbol><ci id="S3.SS3.p3.3.m3.2.2.1.1.1.1.1.2.2.cmml" xref="S3.SS3.p3.3.m3.2.2.1.1.1.1.1.2.2">𝜔</ci><ci id="S3.SS3.p3.3.m3.1.1.1.1.cmml" xref="S3.SS3.p3.3.m3.1.1.1.1">𝑖</ci></apply><ci id="S3.SS3.p3.3.m3.2.2.1.1.1.1.1.3.cmml" xref="S3.SS3.p3.3.m3.2.2.1.1.1.1.1.3">𝑘</ci></apply></set><apply id="S3.SS3.p3.3.m3.2.2.1.1.3.cmml" xref="S3.SS3.p3.3.m3.2.2.1.1.3"><eq id="S3.SS3.p3.3.m3.2.2.1.1.3.1.cmml" xref="S3.SS3.p3.3.m3.2.2.1.1.3.1"></eq><ci id="S3.SS3.p3.3.m3.2.2.1.1.3.2.cmml" xref="S3.SS3.p3.3.m3.2.2.1.1.3.2">𝑘</ci><cn id="S3.SS3.p3.3.m3.2.2.1.1.3.3.cmml" type="integer" xref="S3.SS3.p3.3.m3.2.2.1.1.3.3">1</cn></apply></apply><ci id="S3.SS3.p3.3.m3.2.2.1.3.cmml" xref="S3.SS3.p3.3.m3.2.2.1.3">𝑛</ci></apply><ci id="S3.SS3.p3.3.m3.2.2.3.cmml" xref="S3.SS3.p3.3.m3.2.2.3">Ω</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.3.m3.2c">\{\omega^{(i)}_{k}\}_{k=1}^{n}\subset\Omega</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.3.m3.2d">{ italic_ω start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT } start_POSTSUBSCRIPT italic_k = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT ⊂ roman_Ω</annotation></semantics></math> out of node <math alttext="v_{i}" class="ltx_Math" display="inline" id="S3.SS3.p3.4.m4.1"><semantics id="S3.SS3.p3.4.m4.1a"><msub id="S3.SS3.p3.4.m4.1.1" xref="S3.SS3.p3.4.m4.1.1.cmml"><mi id="S3.SS3.p3.4.m4.1.1.2" xref="S3.SS3.p3.4.m4.1.1.2.cmml">v</mi><mi id="S3.SS3.p3.4.m4.1.1.3" xref="S3.SS3.p3.4.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.4.m4.1b"><apply id="S3.SS3.p3.4.m4.1.1.cmml" xref="S3.SS3.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.4.m4.1.1.1.cmml" xref="S3.SS3.p3.4.m4.1.1">subscript</csymbol><ci id="S3.SS3.p3.4.m4.1.1.2.cmml" xref="S3.SS3.p3.4.m4.1.1.2">𝑣</ci><ci id="S3.SS3.p3.4.m4.1.1.3.cmml" xref="S3.SS3.p3.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.4.m4.1c">v_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.4.m4.1d">italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>, where <math alttext="\Omega\coloneqq\left\{(v_{i})_{i=1}^{l}\,|\,v_{i}\in\mathcal{N},(v_{i},v_{i+1}%
)\in\mathcal{E},l\in\mathbb{N}\right\}" class="ltx_Math" display="inline" id="S3.SS3.p3.5.m5.2"><semantics id="S3.SS3.p3.5.m5.2a"><mrow id="S3.SS3.p3.5.m5.2.2" xref="S3.SS3.p3.5.m5.2.2.cmml"><mi id="S3.SS3.p3.5.m5.2.2.4" mathvariant="normal" xref="S3.SS3.p3.5.m5.2.2.4.cmml">Ω</mi><mo id="S3.SS3.p3.5.m5.2.2.3" xref="S3.SS3.p3.5.m5.2.2.3.cmml">≔</mo><mrow id="S3.SS3.p3.5.m5.2.2.2.2" xref="S3.SS3.p3.5.m5.2.2.2.3.cmml"><mo id="S3.SS3.p3.5.m5.2.2.2.2.3" xref="S3.SS3.p3.5.m5.2.2.2.3.1.cmml">{</mo><msubsup id="S3.SS3.p3.5.m5.1.1.1.1.1" xref="S3.SS3.p3.5.m5.1.1.1.1.1.cmml"><mrow id="S3.SS3.p3.5.m5.1.1.1.1.1.1.1.1" xref="S3.SS3.p3.5.m5.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.SS3.p3.5.m5.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.SS3.p3.5.m5.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.SS3.p3.5.m5.1.1.1.1.1.1.1.1.1" xref="S3.SS3.p3.5.m5.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.SS3.p3.5.m5.1.1.1.1.1.1.1.1.1.2" xref="S3.SS3.p3.5.m5.1.1.1.1.1.1.1.1.1.2.cmml">v</mi><mi id="S3.SS3.p3.5.m5.1.1.1.1.1.1.1.1.1.3" xref="S3.SS3.p3.5.m5.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS3.p3.5.m5.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.SS3.p3.5.m5.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mrow id="S3.SS3.p3.5.m5.1.1.1.1.1.1.3" xref="S3.SS3.p3.5.m5.1.1.1.1.1.1.3.cmml"><mi id="S3.SS3.p3.5.m5.1.1.1.1.1.1.3.2" xref="S3.SS3.p3.5.m5.1.1.1.1.1.1.3.2.cmml">i</mi><mo id="S3.SS3.p3.5.m5.1.1.1.1.1.1.3.1" xref="S3.SS3.p3.5.m5.1.1.1.1.1.1.3.1.cmml">=</mo><mn id="S3.SS3.p3.5.m5.1.1.1.1.1.1.3.3" xref="S3.SS3.p3.5.m5.1.1.1.1.1.1.3.3.cmml">1</mn></mrow><mi id="S3.SS3.p3.5.m5.1.1.1.1.1.3" xref="S3.SS3.p3.5.m5.1.1.1.1.1.3.cmml">l</mi></msubsup><mo id="S3.SS3.p3.5.m5.2.2.2.2.4" lspace="0em" rspace="0.170em" xref="S3.SS3.p3.5.m5.2.2.2.3.1.cmml">|</mo><mrow id="S3.SS3.p3.5.m5.2.2.2.2.2.2" xref="S3.SS3.p3.5.m5.2.2.2.2.2.3.cmml"><mrow id="S3.SS3.p3.5.m5.2.2.2.2.2.1.1" xref="S3.SS3.p3.5.m5.2.2.2.2.2.1.1.cmml"><msub id="S3.SS3.p3.5.m5.2.2.2.2.2.1.1.2" xref="S3.SS3.p3.5.m5.2.2.2.2.2.1.1.2.cmml"><mi id="S3.SS3.p3.5.m5.2.2.2.2.2.1.1.2.2" xref="S3.SS3.p3.5.m5.2.2.2.2.2.1.1.2.2.cmml">v</mi><mi id="S3.SS3.p3.5.m5.2.2.2.2.2.1.1.2.3" xref="S3.SS3.p3.5.m5.2.2.2.2.2.1.1.2.3.cmml">i</mi></msub><mo id="S3.SS3.p3.5.m5.2.2.2.2.2.1.1.1" xref="S3.SS3.p3.5.m5.2.2.2.2.2.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p3.5.m5.2.2.2.2.2.1.1.3" xref="S3.SS3.p3.5.m5.2.2.2.2.2.1.1.3.cmml">𝒩</mi></mrow><mo id="S3.SS3.p3.5.m5.2.2.2.2.2.2.3" xref="S3.SS3.p3.5.m5.2.2.2.2.2.3a.cmml">,</mo><mrow id="S3.SS3.p3.5.m5.2.2.2.2.2.2.2.2" xref="S3.SS3.p3.5.m5.2.2.2.2.2.2.2.3.cmml"><mrow id="S3.SS3.p3.5.m5.2.2.2.2.2.2.2.1.1" xref="S3.SS3.p3.5.m5.2.2.2.2.2.2.2.1.1.cmml"><mrow id="S3.SS3.p3.5.m5.2.2.2.2.2.2.2.1.1.2.2" xref="S3.SS3.p3.5.m5.2.2.2.2.2.2.2.1.1.2.3.cmml"><mo id="S3.SS3.p3.5.m5.2.2.2.2.2.2.2.1.1.2.2.3" stretchy="false" xref="S3.SS3.p3.5.m5.2.2.2.2.2.2.2.1.1.2.3.cmml">(</mo><msub id="S3.SS3.p3.5.m5.2.2.2.2.2.2.2.1.1.1.1.1" xref="S3.SS3.p3.5.m5.2.2.2.2.2.2.2.1.1.1.1.1.cmml"><mi id="S3.SS3.p3.5.m5.2.2.2.2.2.2.2.1.1.1.1.1.2" xref="S3.SS3.p3.5.m5.2.2.2.2.2.2.2.1.1.1.1.1.2.cmml">v</mi><mi id="S3.SS3.p3.5.m5.2.2.2.2.2.2.2.1.1.1.1.1.3" xref="S3.SS3.p3.5.m5.2.2.2.2.2.2.2.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS3.p3.5.m5.2.2.2.2.2.2.2.1.1.2.2.4" xref="S3.SS3.p3.5.m5.2.2.2.2.2.2.2.1.1.2.3.cmml">,</mo><msub id="S3.SS3.p3.5.m5.2.2.2.2.2.2.2.1.1.2.2.2" xref="S3.SS3.p3.5.m5.2.2.2.2.2.2.2.1.1.2.2.2.cmml"><mi id="S3.SS3.p3.5.m5.2.2.2.2.2.2.2.1.1.2.2.2.2" xref="S3.SS3.p3.5.m5.2.2.2.2.2.2.2.1.1.2.2.2.2.cmml">v</mi><mrow id="S3.SS3.p3.5.m5.2.2.2.2.2.2.2.1.1.2.2.2.3" xref="S3.SS3.p3.5.m5.2.2.2.2.2.2.2.1.1.2.2.2.3.cmml"><mi id="S3.SS3.p3.5.m5.2.2.2.2.2.2.2.1.1.2.2.2.3.2" xref="S3.SS3.p3.5.m5.2.2.2.2.2.2.2.1.1.2.2.2.3.2.cmml">i</mi><mo id="S3.SS3.p3.5.m5.2.2.2.2.2.2.2.1.1.2.2.2.3.1" xref="S3.SS3.p3.5.m5.2.2.2.2.2.2.2.1.1.2.2.2.3.1.cmml">+</mo><mn id="S3.SS3.p3.5.m5.2.2.2.2.2.2.2.1.1.2.2.2.3.3" xref="S3.SS3.p3.5.m5.2.2.2.2.2.2.2.1.1.2.2.2.3.3.cmml">1</mn></mrow></msub><mo id="S3.SS3.p3.5.m5.2.2.2.2.2.2.2.1.1.2.2.5" stretchy="false" xref="S3.SS3.p3.5.m5.2.2.2.2.2.2.2.1.1.2.3.cmml">)</mo></mrow><mo id="S3.SS3.p3.5.m5.2.2.2.2.2.2.2.1.1.3" xref="S3.SS3.p3.5.m5.2.2.2.2.2.2.2.1.1.3.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p3.5.m5.2.2.2.2.2.2.2.1.1.4" xref="S3.SS3.p3.5.m5.2.2.2.2.2.2.2.1.1.4.cmml">ℰ</mi></mrow><mo id="S3.SS3.p3.5.m5.2.2.2.2.2.2.2.2.3" xref="S3.SS3.p3.5.m5.2.2.2.2.2.2.2.3a.cmml">,</mo><mrow id="S3.SS3.p3.5.m5.2.2.2.2.2.2.2.2.2" xref="S3.SS3.p3.5.m5.2.2.2.2.2.2.2.2.2.cmml"><mi id="S3.SS3.p3.5.m5.2.2.2.2.2.2.2.2.2.2" xref="S3.SS3.p3.5.m5.2.2.2.2.2.2.2.2.2.2.cmml">l</mi><mo id="S3.SS3.p3.5.m5.2.2.2.2.2.2.2.2.2.1" xref="S3.SS3.p3.5.m5.2.2.2.2.2.2.2.2.2.1.cmml">∈</mo><mi id="S3.SS3.p3.5.m5.2.2.2.2.2.2.2.2.2.3" xref="S3.SS3.p3.5.m5.2.2.2.2.2.2.2.2.2.3.cmml">ℕ</mi></mrow></mrow></mrow><mo id="S3.SS3.p3.5.m5.2.2.2.2.5" xref="S3.SS3.p3.5.m5.2.2.2.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.5.m5.2b"><apply id="S3.SS3.p3.5.m5.2.2.cmml" xref="S3.SS3.p3.5.m5.2.2"><ci id="S3.SS3.p3.5.m5.2.2.3.cmml" xref="S3.SS3.p3.5.m5.2.2.3">≔</ci><ci id="S3.SS3.p3.5.m5.2.2.4.cmml" xref="S3.SS3.p3.5.m5.2.2.4">Ω</ci><apply id="S3.SS3.p3.5.m5.2.2.2.3.cmml" xref="S3.SS3.p3.5.m5.2.2.2.2"><csymbol cd="latexml" id="S3.SS3.p3.5.m5.2.2.2.3.1.cmml" xref="S3.SS3.p3.5.m5.2.2.2.2.3">conditional-set</csymbol><apply id="S3.SS3.p3.5.m5.1.1.1.1.1.cmml" xref="S3.SS3.p3.5.m5.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.5.m5.1.1.1.1.1.2.cmml" xref="S3.SS3.p3.5.m5.1.1.1.1.1">superscript</csymbol><apply id="S3.SS3.p3.5.m5.1.1.1.1.1.1.cmml" xref="S3.SS3.p3.5.m5.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.5.m5.1.1.1.1.1.1.2.cmml" xref="S3.SS3.p3.5.m5.1.1.1.1.1">subscript</csymbol><apply id="S3.SS3.p3.5.m5.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS3.p3.5.m5.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.5.m5.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS3.p3.5.m5.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS3.p3.5.m5.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.SS3.p3.5.m5.1.1.1.1.1.1.1.1.1.2">𝑣</ci><ci id="S3.SS3.p3.5.m5.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.SS3.p3.5.m5.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.SS3.p3.5.m5.1.1.1.1.1.1.3.cmml" xref="S3.SS3.p3.5.m5.1.1.1.1.1.1.3"><eq id="S3.SS3.p3.5.m5.1.1.1.1.1.1.3.1.cmml" xref="S3.SS3.p3.5.m5.1.1.1.1.1.1.3.1"></eq><ci id="S3.SS3.p3.5.m5.1.1.1.1.1.1.3.2.cmml" xref="S3.SS3.p3.5.m5.1.1.1.1.1.1.3.2">𝑖</ci><cn id="S3.SS3.p3.5.m5.1.1.1.1.1.1.3.3.cmml" type="integer" xref="S3.SS3.p3.5.m5.1.1.1.1.1.1.3.3">1</cn></apply></apply><ci id="S3.SS3.p3.5.m5.1.1.1.1.1.3.cmml" xref="S3.SS3.p3.5.m5.1.1.1.1.1.3">𝑙</ci></apply><apply id="S3.SS3.p3.5.m5.2.2.2.2.2.3.cmml" xref="S3.SS3.p3.5.m5.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.p3.5.m5.2.2.2.2.2.3a.cmml" xref="S3.SS3.p3.5.m5.2.2.2.2.2.2.3">formulae-sequence</csymbol><apply id="S3.SS3.p3.5.m5.2.2.2.2.2.1.1.cmml" xref="S3.SS3.p3.5.m5.2.2.2.2.2.1.1"><in id="S3.SS3.p3.5.m5.2.2.2.2.2.1.1.1.cmml" xref="S3.SS3.p3.5.m5.2.2.2.2.2.1.1.1"></in><apply id="S3.SS3.p3.5.m5.2.2.2.2.2.1.1.2.cmml" xref="S3.SS3.p3.5.m5.2.2.2.2.2.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p3.5.m5.2.2.2.2.2.1.1.2.1.cmml" xref="S3.SS3.p3.5.m5.2.2.2.2.2.1.1.2">subscript</csymbol><ci id="S3.SS3.p3.5.m5.2.2.2.2.2.1.1.2.2.cmml" xref="S3.SS3.p3.5.m5.2.2.2.2.2.1.1.2.2">𝑣</ci><ci id="S3.SS3.p3.5.m5.2.2.2.2.2.1.1.2.3.cmml" xref="S3.SS3.p3.5.m5.2.2.2.2.2.1.1.2.3">𝑖</ci></apply><ci id="S3.SS3.p3.5.m5.2.2.2.2.2.1.1.3.cmml" xref="S3.SS3.p3.5.m5.2.2.2.2.2.1.1.3">𝒩</ci></apply><apply id="S3.SS3.p3.5.m5.2.2.2.2.2.2.2.3.cmml" xref="S3.SS3.p3.5.m5.2.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.p3.5.m5.2.2.2.2.2.2.2.3a.cmml" xref="S3.SS3.p3.5.m5.2.2.2.2.2.2.2.2.3">formulae-sequence</csymbol><apply id="S3.SS3.p3.5.m5.2.2.2.2.2.2.2.1.1.cmml" xref="S3.SS3.p3.5.m5.2.2.2.2.2.2.2.1.1"><in id="S3.SS3.p3.5.m5.2.2.2.2.2.2.2.1.1.3.cmml" xref="S3.SS3.p3.5.m5.2.2.2.2.2.2.2.1.1.3"></in><interval closure="open" id="S3.SS3.p3.5.m5.2.2.2.2.2.2.2.1.1.2.3.cmml" xref="S3.SS3.p3.5.m5.2.2.2.2.2.2.2.1.1.2.2"><apply id="S3.SS3.p3.5.m5.2.2.2.2.2.2.2.1.1.1.1.1.cmml" xref="S3.SS3.p3.5.m5.2.2.2.2.2.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.5.m5.2.2.2.2.2.2.2.1.1.1.1.1.1.cmml" xref="S3.SS3.p3.5.m5.2.2.2.2.2.2.2.1.1.1.1.1">subscript</csymbol><ci id="S3.SS3.p3.5.m5.2.2.2.2.2.2.2.1.1.1.1.1.2.cmml" xref="S3.SS3.p3.5.m5.2.2.2.2.2.2.2.1.1.1.1.1.2">𝑣</ci><ci id="S3.SS3.p3.5.m5.2.2.2.2.2.2.2.1.1.1.1.1.3.cmml" xref="S3.SS3.p3.5.m5.2.2.2.2.2.2.2.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.SS3.p3.5.m5.2.2.2.2.2.2.2.1.1.2.2.2.cmml" xref="S3.SS3.p3.5.m5.2.2.2.2.2.2.2.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.p3.5.m5.2.2.2.2.2.2.2.1.1.2.2.2.1.cmml" xref="S3.SS3.p3.5.m5.2.2.2.2.2.2.2.1.1.2.2.2">subscript</csymbol><ci id="S3.SS3.p3.5.m5.2.2.2.2.2.2.2.1.1.2.2.2.2.cmml" xref="S3.SS3.p3.5.m5.2.2.2.2.2.2.2.1.1.2.2.2.2">𝑣</ci><apply id="S3.SS3.p3.5.m5.2.2.2.2.2.2.2.1.1.2.2.2.3.cmml" xref="S3.SS3.p3.5.m5.2.2.2.2.2.2.2.1.1.2.2.2.3"><plus id="S3.SS3.p3.5.m5.2.2.2.2.2.2.2.1.1.2.2.2.3.1.cmml" xref="S3.SS3.p3.5.m5.2.2.2.2.2.2.2.1.1.2.2.2.3.1"></plus><ci id="S3.SS3.p3.5.m5.2.2.2.2.2.2.2.1.1.2.2.2.3.2.cmml" xref="S3.SS3.p3.5.m5.2.2.2.2.2.2.2.1.1.2.2.2.3.2">𝑖</ci><cn id="S3.SS3.p3.5.m5.2.2.2.2.2.2.2.1.1.2.2.2.3.3.cmml" type="integer" xref="S3.SS3.p3.5.m5.2.2.2.2.2.2.2.1.1.2.2.2.3.3">1</cn></apply></apply></interval><ci id="S3.SS3.p3.5.m5.2.2.2.2.2.2.2.1.1.4.cmml" xref="S3.SS3.p3.5.m5.2.2.2.2.2.2.2.1.1.4">ℰ</ci></apply><apply id="S3.SS3.p3.5.m5.2.2.2.2.2.2.2.2.2.cmml" xref="S3.SS3.p3.5.m5.2.2.2.2.2.2.2.2.2"><in id="S3.SS3.p3.5.m5.2.2.2.2.2.2.2.2.2.1.cmml" xref="S3.SS3.p3.5.m5.2.2.2.2.2.2.2.2.2.1"></in><ci id="S3.SS3.p3.5.m5.2.2.2.2.2.2.2.2.2.2.cmml" xref="S3.SS3.p3.5.m5.2.2.2.2.2.2.2.2.2.2">𝑙</ci><ci id="S3.SS3.p3.5.m5.2.2.2.2.2.2.2.2.2.3.cmml" xref="S3.SS3.p3.5.m5.2.2.2.2.2.2.2.2.2.3">ℕ</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.5.m5.2c">\Omega\coloneqq\left\{(v_{i})_{i=1}^{l}\,|\,v_{i}\in\mathcal{N},(v_{i},v_{i+1}%
)\in\mathcal{E},l\in\mathbb{N}\right\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.5.m5.2d">roman_Ω ≔ { ( italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT | italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∈ caligraphic_N , ( italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_v start_POSTSUBSCRIPT italic_i + 1 end_POSTSUBSCRIPT ) ∈ caligraphic_E , italic_l ∈ blackboard_N }</annotation></semantics></math> is the set of all walks.
Denote by <math alttext="p(\omega)" class="ltx_Math" display="inline" id="S3.SS3.p3.6.m6.1"><semantics id="S3.SS3.p3.6.m6.1a"><mrow id="S3.SS3.p3.6.m6.1.2" xref="S3.SS3.p3.6.m6.1.2.cmml"><mi id="S3.SS3.p3.6.m6.1.2.2" xref="S3.SS3.p3.6.m6.1.2.2.cmml">p</mi><mo id="S3.SS3.p3.6.m6.1.2.1" xref="S3.SS3.p3.6.m6.1.2.1.cmml">⁢</mo><mrow id="S3.SS3.p3.6.m6.1.2.3.2" xref="S3.SS3.p3.6.m6.1.2.cmml"><mo id="S3.SS3.p3.6.m6.1.2.3.2.1" stretchy="false" xref="S3.SS3.p3.6.m6.1.2.cmml">(</mo><mi id="S3.SS3.p3.6.m6.1.1" xref="S3.SS3.p3.6.m6.1.1.cmml">ω</mi><mo id="S3.SS3.p3.6.m6.1.2.3.2.2" stretchy="false" xref="S3.SS3.p3.6.m6.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.6.m6.1b"><apply id="S3.SS3.p3.6.m6.1.2.cmml" xref="S3.SS3.p3.6.m6.1.2"><times id="S3.SS3.p3.6.m6.1.2.1.cmml" xref="S3.SS3.p3.6.m6.1.2.1"></times><ci id="S3.SS3.p3.6.m6.1.2.2.cmml" xref="S3.SS3.p3.6.m6.1.2.2">𝑝</ci><ci id="S3.SS3.p3.6.m6.1.1.cmml" xref="S3.SS3.p3.6.m6.1.1">𝜔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.6.m6.1c">p(\omega)</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.6.m6.1d">italic_p ( italic_ω )</annotation></semantics></math> the probability of walk <math alttext="\omega" class="ltx_Math" display="inline" id="S3.SS3.p3.7.m7.1"><semantics id="S3.SS3.p3.7.m7.1a"><mi id="S3.SS3.p3.7.m7.1.1" xref="S3.SS3.p3.7.m7.1.1.cmml">ω</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.7.m7.1b"><ci id="S3.SS3.p3.7.m7.1.1.cmml" xref="S3.SS3.p3.7.m7.1.1">𝜔</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.7.m7.1c">\omega</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.7.m7.1d">italic_ω</annotation></semantics></math> which is known from the sampling mechanism.
<math alttext="p(\omega)" class="ltx_Math" display="inline" id="S3.SS3.p3.8.m8.1"><semantics id="S3.SS3.p3.8.m8.1a"><mrow id="S3.SS3.p3.8.m8.1.2" xref="S3.SS3.p3.8.m8.1.2.cmml"><mi id="S3.SS3.p3.8.m8.1.2.2" xref="S3.SS3.p3.8.m8.1.2.2.cmml">p</mi><mo id="S3.SS3.p3.8.m8.1.2.1" xref="S3.SS3.p3.8.m8.1.2.1.cmml">⁢</mo><mrow id="S3.SS3.p3.8.m8.1.2.3.2" xref="S3.SS3.p3.8.m8.1.2.cmml"><mo id="S3.SS3.p3.8.m8.1.2.3.2.1" stretchy="false" xref="S3.SS3.p3.8.m8.1.2.cmml">(</mo><mi id="S3.SS3.p3.8.m8.1.1" xref="S3.SS3.p3.8.m8.1.1.cmml">ω</mi><mo id="S3.SS3.p3.8.m8.1.2.3.2.2" stretchy="false" xref="S3.SS3.p3.8.m8.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.8.m8.1b"><apply id="S3.SS3.p3.8.m8.1.2.cmml" xref="S3.SS3.p3.8.m8.1.2"><times id="S3.SS3.p3.8.m8.1.2.1.cmml" xref="S3.SS3.p3.8.m8.1.2.1"></times><ci id="S3.SS3.p3.8.m8.1.2.2.cmml" xref="S3.SS3.p3.8.m8.1.2.2">𝑝</ci><ci id="S3.SS3.p3.8.m8.1.1.cmml" xref="S3.SS3.p3.8.m8.1.1">𝜔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.8.m8.1c">p(\omega)</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.8.m8.1d">italic_p ( italic_ω )</annotation></semantics></math> is typically chosen so that walks randomly halt, prioritising sampling lower powers of <math alttext="\mathbf{W}" class="ltx_Math" display="inline" id="S3.SS3.p3.9.m9.1"><semantics id="S3.SS3.p3.9.m9.1a"><mi id="S3.SS3.p3.9.m9.1.1" xref="S3.SS3.p3.9.m9.1.1.cmml">𝐖</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.9.m9.1b"><ci id="S3.SS3.p3.9.m9.1.1.cmml" xref="S3.SS3.p3.9.m9.1.1">𝐖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.9.m9.1c">\mathbf{W}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.9.m9.1d">bold_W</annotation></semantics></math> that contribute more to the kernel.
Let <math alttext="\widetilde{\omega}:\Omega\to\mathbb{R}" class="ltx_Math" display="inline" id="S3.SS3.p3.10.m10.1"><semantics id="S3.SS3.p3.10.m10.1a"><mrow id="S3.SS3.p3.10.m10.1.1" xref="S3.SS3.p3.10.m10.1.1.cmml"><mover accent="true" id="S3.SS3.p3.10.m10.1.1.2" xref="S3.SS3.p3.10.m10.1.1.2.cmml"><mi id="S3.SS3.p3.10.m10.1.1.2.2" xref="S3.SS3.p3.10.m10.1.1.2.2.cmml">ω</mi><mo id="S3.SS3.p3.10.m10.1.1.2.1" xref="S3.SS3.p3.10.m10.1.1.2.1.cmml">~</mo></mover><mo id="S3.SS3.p3.10.m10.1.1.1" lspace="0.278em" rspace="0.278em" xref="S3.SS3.p3.10.m10.1.1.1.cmml">:</mo><mrow id="S3.SS3.p3.10.m10.1.1.3" xref="S3.SS3.p3.10.m10.1.1.3.cmml"><mi id="S3.SS3.p3.10.m10.1.1.3.2" mathvariant="normal" xref="S3.SS3.p3.10.m10.1.1.3.2.cmml">Ω</mi><mo id="S3.SS3.p3.10.m10.1.1.3.1" stretchy="false" xref="S3.SS3.p3.10.m10.1.1.3.1.cmml">→</mo><mi id="S3.SS3.p3.10.m10.1.1.3.3" xref="S3.SS3.p3.10.m10.1.1.3.3.cmml">ℝ</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.10.m10.1b"><apply id="S3.SS3.p3.10.m10.1.1.cmml" xref="S3.SS3.p3.10.m10.1.1"><ci id="S3.SS3.p3.10.m10.1.1.1.cmml" xref="S3.SS3.p3.10.m10.1.1.1">:</ci><apply id="S3.SS3.p3.10.m10.1.1.2.cmml" xref="S3.SS3.p3.10.m10.1.1.2"><ci id="S3.SS3.p3.10.m10.1.1.2.1.cmml" xref="S3.SS3.p3.10.m10.1.1.2.1">~</ci><ci id="S3.SS3.p3.10.m10.1.1.2.2.cmml" xref="S3.SS3.p3.10.m10.1.1.2.2">𝜔</ci></apply><apply id="S3.SS3.p3.10.m10.1.1.3.cmml" xref="S3.SS3.p3.10.m10.1.1.3"><ci id="S3.SS3.p3.10.m10.1.1.3.1.cmml" xref="S3.SS3.p3.10.m10.1.1.3.1">→</ci><ci id="S3.SS3.p3.10.m10.1.1.3.2.cmml" xref="S3.SS3.p3.10.m10.1.1.3.2">Ω</ci><ci id="S3.SS3.p3.10.m10.1.1.3.3.cmml" xref="S3.SS3.p3.10.m10.1.1.3.3">ℝ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.10.m10.1c">\widetilde{\omega}:\Omega\to\mathbb{R}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.10.m10.1d">over~ start_ARG italic_ω end_ARG : roman_Ω → blackboard_R</annotation></semantics></math> be a function computing the product of traversed edge weights,</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equation ltx_eqn_table" id="S3.E9">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\vspace{-1.5mm}\widetilde{\omega}(\omega)\coloneqq\left\{\prod_{i=1}^{\textrm{%
len}(\omega)}\mathbf{W}_{\omega[i]\omega[i+1]}\textrm{ if }\textrm{len}(\omega%
)>1,\quad 1\textrm{ otherwise}\right\}," class="ltx_Math" display="block" id="S3.E9.m1.7"><semantics id="S3.E9.m1.7a"><mrow id="S3.E9.m1.7.7.1" xref="S3.E9.m1.7.7.1.1.cmml"><mrow id="S3.E9.m1.7.7.1.1" xref="S3.E9.m1.7.7.1.1.cmml"><mrow id="S3.E9.m1.7.7.1.1.3" xref="S3.E9.m1.7.7.1.1.3.cmml"><mover accent="true" id="S3.E9.m1.7.7.1.1.3.2" xref="S3.E9.m1.7.7.1.1.3.2.cmml"><mi id="S3.E9.m1.7.7.1.1.3.2.2" xref="S3.E9.m1.7.7.1.1.3.2.2.cmml">ω</mi><mo id="S3.E9.m1.7.7.1.1.3.2.1" xref="S3.E9.m1.7.7.1.1.3.2.1.cmml">~</mo></mover><mo id="S3.E9.m1.7.7.1.1.3.1" xref="S3.E9.m1.7.7.1.1.3.1.cmml">⁢</mo><mrow id="S3.E9.m1.7.7.1.1.3.3.2" xref="S3.E9.m1.7.7.1.1.3.cmml"><mo id="S3.E9.m1.7.7.1.1.3.3.2.1" stretchy="false" xref="S3.E9.m1.7.7.1.1.3.cmml">(</mo><mi id="S3.E9.m1.4.4" xref="S3.E9.m1.4.4.cmml">ω</mi><mo id="S3.E9.m1.7.7.1.1.3.3.2.2" stretchy="false" xref="S3.E9.m1.7.7.1.1.3.cmml">)</mo></mrow></mrow><mo id="S3.E9.m1.7.7.1.1.2" xref="S3.E9.m1.7.7.1.1.2.cmml">≔</mo><mrow id="S3.E9.m1.7.7.1.1.1.1" xref="S3.E9.m1.7.7.1.1.1.2.cmml"><mo id="S3.E9.m1.7.7.1.1.1.1.2" xref="S3.E9.m1.7.7.1.1.1.2.cmml">{</mo><mrow id="S3.E9.m1.7.7.1.1.1.1.1" xref="S3.E9.m1.7.7.1.1.1.1.1.cmml"><mrow id="S3.E9.m1.7.7.1.1.1.1.1.3" xref="S3.E9.m1.7.7.1.1.1.1.1.3.cmml"><munderover id="S3.E9.m1.7.7.1.1.1.1.1.3.1" xref="S3.E9.m1.7.7.1.1.1.1.1.3.1.cmml"><mo id="S3.E9.m1.7.7.1.1.1.1.1.3.1.2.2" lspace="0em" movablelimits="false" xref="S3.E9.m1.7.7.1.1.1.1.1.3.1.2.2.cmml">∏</mo><mrow id="S3.E9.m1.7.7.1.1.1.1.1.3.1.2.3" xref="S3.E9.m1.7.7.1.1.1.1.1.3.1.2.3.cmml"><mi id="S3.E9.m1.7.7.1.1.1.1.1.3.1.2.3.2" xref="S3.E9.m1.7.7.1.1.1.1.1.3.1.2.3.2.cmml">i</mi><mo id="S3.E9.m1.7.7.1.1.1.1.1.3.1.2.3.1" xref="S3.E9.m1.7.7.1.1.1.1.1.3.1.2.3.1.cmml">=</mo><mn id="S3.E9.m1.7.7.1.1.1.1.1.3.1.2.3.3" xref="S3.E9.m1.7.7.1.1.1.1.1.3.1.2.3.3.cmml">1</mn></mrow><mrow id="S3.E9.m1.1.1.1" xref="S3.E9.m1.1.1.1.cmml"><mtext id="S3.E9.m1.1.1.1.3" xref="S3.E9.m1.1.1.1.3a.cmml">len</mtext><mo id="S3.E9.m1.1.1.1.2" xref="S3.E9.m1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E9.m1.1.1.1.4.2" xref="S3.E9.m1.1.1.1.cmml"><mo id="S3.E9.m1.1.1.1.4.2.1" stretchy="false" xref="S3.E9.m1.1.1.1.cmml">(</mo><mi id="S3.E9.m1.1.1.1.1" xref="S3.E9.m1.1.1.1.1.cmml">ω</mi><mo id="S3.E9.m1.1.1.1.4.2.2" stretchy="false" xref="S3.E9.m1.1.1.1.cmml">)</mo></mrow></mrow></munderover><mrow id="S3.E9.m1.7.7.1.1.1.1.1.3.2" xref="S3.E9.m1.7.7.1.1.1.1.1.3.2.cmml"><msub id="S3.E9.m1.7.7.1.1.1.1.1.3.2.2" xref="S3.E9.m1.7.7.1.1.1.1.1.3.2.2.cmml"><mi id="S3.E9.m1.7.7.1.1.1.1.1.3.2.2.2" xref="S3.E9.m1.7.7.1.1.1.1.1.3.2.2.2.cmml">𝐖</mi><mrow id="S3.E9.m1.3.3.2" xref="S3.E9.m1.3.3.2.cmml"><mi id="S3.E9.m1.3.3.2.4" xref="S3.E9.m1.3.3.2.4.cmml">ω</mi><mo id="S3.E9.m1.3.3.2.3" xref="S3.E9.m1.3.3.2.3.cmml">⁢</mo><mrow id="S3.E9.m1.3.3.2.5.2" xref="S3.E9.m1.3.3.2.5.1.cmml"><mo id="S3.E9.m1.3.3.2.5.2.1" stretchy="false" xref="S3.E9.m1.3.3.2.5.1.1.cmml">[</mo><mi id="S3.E9.m1.2.2.1.1" xref="S3.E9.m1.2.2.1.1.cmml">i</mi><mo id="S3.E9.m1.3.3.2.5.2.2" stretchy="false" xref="S3.E9.m1.3.3.2.5.1.1.cmml">]</mo></mrow><mo id="S3.E9.m1.3.3.2.3a" xref="S3.E9.m1.3.3.2.3.cmml">⁢</mo><mi id="S3.E9.m1.3.3.2.6" xref="S3.E9.m1.3.3.2.6.cmml">ω</mi><mo id="S3.E9.m1.3.3.2.3b" xref="S3.E9.m1.3.3.2.3.cmml">⁢</mo><mrow id="S3.E9.m1.3.3.2.2.1" xref="S3.E9.m1.3.3.2.2.2.cmml"><mo id="S3.E9.m1.3.3.2.2.1.2" stretchy="false" xref="S3.E9.m1.3.3.2.2.2.1.cmml">[</mo><mrow id="S3.E9.m1.3.3.2.2.1.1" xref="S3.E9.m1.3.3.2.2.1.1.cmml"><mi id="S3.E9.m1.3.3.2.2.1.1.2" xref="S3.E9.m1.3.3.2.2.1.1.2.cmml">i</mi><mo id="S3.E9.m1.3.3.2.2.1.1.1" xref="S3.E9.m1.3.3.2.2.1.1.1.cmml">+</mo><mn id="S3.E9.m1.3.3.2.2.1.1.3" xref="S3.E9.m1.3.3.2.2.1.1.3.cmml">1</mn></mrow><mo id="S3.E9.m1.3.3.2.2.1.3" stretchy="false" xref="S3.E9.m1.3.3.2.2.2.1.cmml">]</mo></mrow></mrow></msub><mo id="S3.E9.m1.7.7.1.1.1.1.1.3.2.1" xref="S3.E9.m1.7.7.1.1.1.1.1.3.2.1.cmml">⁢</mo><mrow id="S3.E9.m1.7.7.1.1.1.1.1.3.2.3" xref="S3.E9.m1.7.7.1.1.1.1.1.3.2.3c.cmml"><mtext id="S3.E9.m1.7.7.1.1.1.1.1.3.2.3a" xref="S3.E9.m1.7.7.1.1.1.1.1.3.2.3c.cmml">&nbsp;if&nbsp;</mtext><mtext id="S3.E9.m1.7.7.1.1.1.1.1.3.2.3b" xref="S3.E9.m1.7.7.1.1.1.1.1.3.2.3c.cmml">len</mtext></mrow><mo id="S3.E9.m1.7.7.1.1.1.1.1.3.2.1a" xref="S3.E9.m1.7.7.1.1.1.1.1.3.2.1.cmml">⁢</mo><mrow id="S3.E9.m1.7.7.1.1.1.1.1.3.2.4.2" xref="S3.E9.m1.7.7.1.1.1.1.1.3.2.cmml"><mo id="S3.E9.m1.7.7.1.1.1.1.1.3.2.4.2.1" stretchy="false" xref="S3.E9.m1.7.7.1.1.1.1.1.3.2.cmml">(</mo><mi id="S3.E9.m1.5.5" xref="S3.E9.m1.5.5.cmml">ω</mi><mo id="S3.E9.m1.7.7.1.1.1.1.1.3.2.4.2.2" stretchy="false" xref="S3.E9.m1.7.7.1.1.1.1.1.3.2.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E9.m1.7.7.1.1.1.1.1.2" xref="S3.E9.m1.7.7.1.1.1.1.1.2.cmml">&gt;</mo><mrow id="S3.E9.m1.7.7.1.1.1.1.1.1.1" xref="S3.E9.m1.7.7.1.1.1.1.1.1.2.cmml"><mn id="S3.E9.m1.6.6" xref="S3.E9.m1.6.6.cmml">1</mn><mo id="S3.E9.m1.7.7.1.1.1.1.1.1.1.2" rspace="1.167em" xref="S3.E9.m1.7.7.1.1.1.1.1.1.2.cmml">,</mo><mrow id="S3.E9.m1.7.7.1.1.1.1.1.1.1.1" xref="S3.E9.m1.7.7.1.1.1.1.1.1.1.1.cmml"><mn id="S3.E9.m1.7.7.1.1.1.1.1.1.1.1.2" xref="S3.E9.m1.7.7.1.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="S3.E9.m1.7.7.1.1.1.1.1.1.1.1.1" xref="S3.E9.m1.7.7.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mtext id="S3.E9.m1.7.7.1.1.1.1.1.1.1.1.3" xref="S3.E9.m1.7.7.1.1.1.1.1.1.1.1.3a.cmml">&nbsp;otherwise</mtext></mrow></mrow></mrow><mo id="S3.E9.m1.7.7.1.1.1.1.3" xref="S3.E9.m1.7.7.1.1.1.2.cmml">}</mo></mrow></mrow><mo id="S3.E9.m1.7.7.1.2" xref="S3.E9.m1.7.7.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E9.m1.7b"><apply id="S3.E9.m1.7.7.1.1.cmml" xref="S3.E9.m1.7.7.1"><ci id="S3.E9.m1.7.7.1.1.2.cmml" xref="S3.E9.m1.7.7.1.1.2">≔</ci><apply id="S3.E9.m1.7.7.1.1.3.cmml" xref="S3.E9.m1.7.7.1.1.3"><times id="S3.E9.m1.7.7.1.1.3.1.cmml" xref="S3.E9.m1.7.7.1.1.3.1"></times><apply id="S3.E9.m1.7.7.1.1.3.2.cmml" xref="S3.E9.m1.7.7.1.1.3.2"><ci id="S3.E9.m1.7.7.1.1.3.2.1.cmml" xref="S3.E9.m1.7.7.1.1.3.2.1">~</ci><ci id="S3.E9.m1.7.7.1.1.3.2.2.cmml" xref="S3.E9.m1.7.7.1.1.3.2.2">𝜔</ci></apply><ci id="S3.E9.m1.4.4.cmml" xref="S3.E9.m1.4.4">𝜔</ci></apply><set id="S3.E9.m1.7.7.1.1.1.2.cmml" xref="S3.E9.m1.7.7.1.1.1.1"><apply id="S3.E9.m1.7.7.1.1.1.1.1.cmml" xref="S3.E9.m1.7.7.1.1.1.1.1"><gt id="S3.E9.m1.7.7.1.1.1.1.1.2.cmml" xref="S3.E9.m1.7.7.1.1.1.1.1.2"></gt><apply id="S3.E9.m1.7.7.1.1.1.1.1.3.cmml" xref="S3.E9.m1.7.7.1.1.1.1.1.3"><apply id="S3.E9.m1.7.7.1.1.1.1.1.3.1.cmml" xref="S3.E9.m1.7.7.1.1.1.1.1.3.1"><csymbol cd="ambiguous" id="S3.E9.m1.7.7.1.1.1.1.1.3.1.1.cmml" xref="S3.E9.m1.7.7.1.1.1.1.1.3.1">superscript</csymbol><apply id="S3.E9.m1.7.7.1.1.1.1.1.3.1.2.cmml" xref="S3.E9.m1.7.7.1.1.1.1.1.3.1"><csymbol cd="ambiguous" id="S3.E9.m1.7.7.1.1.1.1.1.3.1.2.1.cmml" xref="S3.E9.m1.7.7.1.1.1.1.1.3.1">subscript</csymbol><csymbol cd="latexml" id="S3.E9.m1.7.7.1.1.1.1.1.3.1.2.2.cmml" xref="S3.E9.m1.7.7.1.1.1.1.1.3.1.2.2">product</csymbol><apply id="S3.E9.m1.7.7.1.1.1.1.1.3.1.2.3.cmml" xref="S3.E9.m1.7.7.1.1.1.1.1.3.1.2.3"><eq id="S3.E9.m1.7.7.1.1.1.1.1.3.1.2.3.1.cmml" xref="S3.E9.m1.7.7.1.1.1.1.1.3.1.2.3.1"></eq><ci id="S3.E9.m1.7.7.1.1.1.1.1.3.1.2.3.2.cmml" xref="S3.E9.m1.7.7.1.1.1.1.1.3.1.2.3.2">𝑖</ci><cn id="S3.E9.m1.7.7.1.1.1.1.1.3.1.2.3.3.cmml" type="integer" xref="S3.E9.m1.7.7.1.1.1.1.1.3.1.2.3.3">1</cn></apply></apply><apply id="S3.E9.m1.1.1.1.cmml" xref="S3.E9.m1.1.1.1"><times id="S3.E9.m1.1.1.1.2.cmml" xref="S3.E9.m1.1.1.1.2"></times><ci id="S3.E9.m1.1.1.1.3a.cmml" xref="S3.E9.m1.1.1.1.3"><mtext id="S3.E9.m1.1.1.1.3.cmml" mathsize="70%" xref="S3.E9.m1.1.1.1.3">len</mtext></ci><ci id="S3.E9.m1.1.1.1.1.cmml" xref="S3.E9.m1.1.1.1.1">𝜔</ci></apply></apply><apply id="S3.E9.m1.7.7.1.1.1.1.1.3.2.cmml" xref="S3.E9.m1.7.7.1.1.1.1.1.3.2"><times id="S3.E9.m1.7.7.1.1.1.1.1.3.2.1.cmml" xref="S3.E9.m1.7.7.1.1.1.1.1.3.2.1"></times><apply id="S3.E9.m1.7.7.1.1.1.1.1.3.2.2.cmml" xref="S3.E9.m1.7.7.1.1.1.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.E9.m1.7.7.1.1.1.1.1.3.2.2.1.cmml" xref="S3.E9.m1.7.7.1.1.1.1.1.3.2.2">subscript</csymbol><ci id="S3.E9.m1.7.7.1.1.1.1.1.3.2.2.2.cmml" xref="S3.E9.m1.7.7.1.1.1.1.1.3.2.2.2">𝐖</ci><apply id="S3.E9.m1.3.3.2.cmml" xref="S3.E9.m1.3.3.2"><times id="S3.E9.m1.3.3.2.3.cmml" xref="S3.E9.m1.3.3.2.3"></times><ci id="S3.E9.m1.3.3.2.4.cmml" xref="S3.E9.m1.3.3.2.4">𝜔</ci><apply id="S3.E9.m1.3.3.2.5.1.cmml" xref="S3.E9.m1.3.3.2.5.2"><csymbol cd="latexml" id="S3.E9.m1.3.3.2.5.1.1.cmml" xref="S3.E9.m1.3.3.2.5.2.1">delimited-[]</csymbol><ci id="S3.E9.m1.2.2.1.1.cmml" xref="S3.E9.m1.2.2.1.1">𝑖</ci></apply><ci id="S3.E9.m1.3.3.2.6.cmml" xref="S3.E9.m1.3.3.2.6">𝜔</ci><apply id="S3.E9.m1.3.3.2.2.2.cmml" xref="S3.E9.m1.3.3.2.2.1"><csymbol cd="latexml" id="S3.E9.m1.3.3.2.2.2.1.cmml" xref="S3.E9.m1.3.3.2.2.1.2">delimited-[]</csymbol><apply id="S3.E9.m1.3.3.2.2.1.1.cmml" xref="S3.E9.m1.3.3.2.2.1.1"><plus id="S3.E9.m1.3.3.2.2.1.1.1.cmml" xref="S3.E9.m1.3.3.2.2.1.1.1"></plus><ci id="S3.E9.m1.3.3.2.2.1.1.2.cmml" xref="S3.E9.m1.3.3.2.2.1.1.2">𝑖</ci><cn id="S3.E9.m1.3.3.2.2.1.1.3.cmml" type="integer" xref="S3.E9.m1.3.3.2.2.1.1.3">1</cn></apply></apply></apply></apply><ci id="S3.E9.m1.7.7.1.1.1.1.1.3.2.3c.cmml" xref="S3.E9.m1.7.7.1.1.1.1.1.3.2.3"><mrow id="S3.E9.m1.7.7.1.1.1.1.1.3.2.3.cmml" xref="S3.E9.m1.7.7.1.1.1.1.1.3.2.3"><mtext id="S3.E9.m1.7.7.1.1.1.1.1.3.2.3a.cmml" xref="S3.E9.m1.7.7.1.1.1.1.1.3.2.3">&nbsp;if&nbsp;</mtext><mtext id="S3.E9.m1.7.7.1.1.1.1.1.3.2.3b.cmml" xref="S3.E9.m1.7.7.1.1.1.1.1.3.2.3">len</mtext></mrow></ci><ci id="S3.E9.m1.5.5.cmml" xref="S3.E9.m1.5.5">𝜔</ci></apply></apply><list id="S3.E9.m1.7.7.1.1.1.1.1.1.2.cmml" xref="S3.E9.m1.7.7.1.1.1.1.1.1.1"><cn id="S3.E9.m1.6.6.cmml" type="integer" xref="S3.E9.m1.6.6">1</cn><apply id="S3.E9.m1.7.7.1.1.1.1.1.1.1.1.cmml" xref="S3.E9.m1.7.7.1.1.1.1.1.1.1.1"><times id="S3.E9.m1.7.7.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E9.m1.7.7.1.1.1.1.1.1.1.1.1"></times><cn id="S3.E9.m1.7.7.1.1.1.1.1.1.1.1.2.cmml" type="integer" xref="S3.E9.m1.7.7.1.1.1.1.1.1.1.1.2">1</cn><ci id="S3.E9.m1.7.7.1.1.1.1.1.1.1.1.3a.cmml" xref="S3.E9.m1.7.7.1.1.1.1.1.1.1.1.3"><mtext id="S3.E9.m1.7.7.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E9.m1.7.7.1.1.1.1.1.1.1.1.3">&nbsp;otherwise</mtext></ci></apply></list></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E9.m1.7c">\vspace{-1.5mm}\widetilde{\omega}(\omega)\coloneqq\left\{\prod_{i=1}^{\textrm{%
len}(\omega)}\mathbf{W}_{\omega[i]\omega[i+1]}\textrm{ if }\textrm{len}(\omega%
)&gt;1,\quad 1\textrm{ otherwise}\right\},</annotation><annotation encoding="application/x-llamapun" id="S3.E9.m1.7d">over~ start_ARG italic_ω end_ARG ( italic_ω ) ≔ { ∏ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT len ( italic_ω ) end_POSTSUPERSCRIPT bold_W start_POSTSUBSCRIPT italic_ω [ italic_i ] italic_ω [ italic_i + 1 ] end_POSTSUBSCRIPT if roman_len ( italic_ω ) &gt; 1 , 1 otherwise } ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.p3.13">where <math alttext="\textrm{len}(\omega)" class="ltx_Math" display="inline" id="S3.SS3.p3.11.m1.1"><semantics id="S3.SS3.p3.11.m1.1a"><mrow id="S3.SS3.p3.11.m1.1.2" xref="S3.SS3.p3.11.m1.1.2.cmml"><mtext id="S3.SS3.p3.11.m1.1.2.2" xref="S3.SS3.p3.11.m1.1.2.2a.cmml">len</mtext><mo id="S3.SS3.p3.11.m1.1.2.1" xref="S3.SS3.p3.11.m1.1.2.1.cmml">⁢</mo><mrow id="S3.SS3.p3.11.m1.1.2.3.2" xref="S3.SS3.p3.11.m1.1.2.cmml"><mo id="S3.SS3.p3.11.m1.1.2.3.2.1" stretchy="false" xref="S3.SS3.p3.11.m1.1.2.cmml">(</mo><mi id="S3.SS3.p3.11.m1.1.1" xref="S3.SS3.p3.11.m1.1.1.cmml">ω</mi><mo id="S3.SS3.p3.11.m1.1.2.3.2.2" stretchy="false" xref="S3.SS3.p3.11.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.11.m1.1b"><apply id="S3.SS3.p3.11.m1.1.2.cmml" xref="S3.SS3.p3.11.m1.1.2"><times id="S3.SS3.p3.11.m1.1.2.1.cmml" xref="S3.SS3.p3.11.m1.1.2.1"></times><ci id="S3.SS3.p3.11.m1.1.2.2a.cmml" xref="S3.SS3.p3.11.m1.1.2.2"><mtext id="S3.SS3.p3.11.m1.1.2.2.cmml" xref="S3.SS3.p3.11.m1.1.2.2">len</mtext></ci><ci id="S3.SS3.p3.11.m1.1.1.cmml" xref="S3.SS3.p3.11.m1.1.1">𝜔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.11.m1.1c">\textrm{len}(\omega)</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.11.m1.1d">len ( italic_ω )</annotation></semantics></math> is the number of hops and <math alttext="\omega[i]" class="ltx_Math" display="inline" id="S3.SS3.p3.12.m2.1"><semantics id="S3.SS3.p3.12.m2.1a"><mrow id="S3.SS3.p3.12.m2.1.2" xref="S3.SS3.p3.12.m2.1.2.cmml"><mi id="S3.SS3.p3.12.m2.1.2.2" xref="S3.SS3.p3.12.m2.1.2.2.cmml">ω</mi><mo id="S3.SS3.p3.12.m2.1.2.1" xref="S3.SS3.p3.12.m2.1.2.1.cmml">⁢</mo><mrow id="S3.SS3.p3.12.m2.1.2.3.2" xref="S3.SS3.p3.12.m2.1.2.3.1.cmml"><mo id="S3.SS3.p3.12.m2.1.2.3.2.1" stretchy="false" xref="S3.SS3.p3.12.m2.1.2.3.1.1.cmml">[</mo><mi id="S3.SS3.p3.12.m2.1.1" xref="S3.SS3.p3.12.m2.1.1.cmml">i</mi><mo id="S3.SS3.p3.12.m2.1.2.3.2.2" stretchy="false" xref="S3.SS3.p3.12.m2.1.2.3.1.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.12.m2.1b"><apply id="S3.SS3.p3.12.m2.1.2.cmml" xref="S3.SS3.p3.12.m2.1.2"><times id="S3.SS3.p3.12.m2.1.2.1.cmml" xref="S3.SS3.p3.12.m2.1.2.1"></times><ci id="S3.SS3.p3.12.m2.1.2.2.cmml" xref="S3.SS3.p3.12.m2.1.2.2">𝜔</ci><apply id="S3.SS3.p3.12.m2.1.2.3.1.cmml" xref="S3.SS3.p3.12.m2.1.2.3.2"><csymbol cd="latexml" id="S3.SS3.p3.12.m2.1.2.3.1.1.cmml" xref="S3.SS3.p3.12.m2.1.2.3.2.1">delimited-[]</csymbol><ci id="S3.SS3.p3.12.m2.1.1.cmml" xref="S3.SS3.p3.12.m2.1.1">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.12.m2.1c">\omega[i]</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.12.m2.1d">italic_ω [ italic_i ]</annotation></semantics></math> is the node visited at the <math alttext="i" class="ltx_Math" display="inline" id="S3.SS3.p3.13.m3.1"><semantics id="S3.SS3.p3.13.m3.1a"><mi id="S3.SS3.p3.13.m3.1.1" xref="S3.SS3.p3.13.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.13.m3.1b"><ci id="S3.SS3.p3.13.m3.1.1.cmml" xref="S3.SS3.p3.13.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.13.m3.1c">i</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.13.m3.1d">italic_i</annotation></semantics></math>th timestep. Then:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equation ltx_eqn_table" id="S3.E10">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\widehat{\phi}_{\mathcal{G}}(v_{i})_{q}\coloneqq\frac{1}{n}\sum_{k=1}^{n}\sum_%
{\omega_{iq}\in\Omega_{iq}}\frac{\widetilde{\omega}(\omega_{iq})f_{\textrm{len%
}(\omega_{iq})}}{p(\omega_{iq})}\mathbb{I}(\omega_{iq}\textrm{ prefix subwalk %
of }\omega_{k}^{(i)}),\quad q=1,...,N," class="ltx_Math" display="block" id="S3.E10.m1.8"><semantics id="S3.E10.m1.8a"><mrow id="S3.E10.m1.8.8.1"><mrow id="S3.E10.m1.8.8.1.1.2" xref="S3.E10.m1.8.8.1.1.3.cmml"><mrow id="S3.E10.m1.8.8.1.1.1.1" xref="S3.E10.m1.8.8.1.1.1.1.cmml"><mrow id="S3.E10.m1.8.8.1.1.1.1.1" xref="S3.E10.m1.8.8.1.1.1.1.1.cmml"><msub id="S3.E10.m1.8.8.1.1.1.1.1.3" xref="S3.E10.m1.8.8.1.1.1.1.1.3.cmml"><mover accent="true" id="S3.E10.m1.8.8.1.1.1.1.1.3.2" xref="S3.E10.m1.8.8.1.1.1.1.1.3.2.cmml"><mi id="S3.E10.m1.8.8.1.1.1.1.1.3.2.2" xref="S3.E10.m1.8.8.1.1.1.1.1.3.2.2.cmml">ϕ</mi><mo id="S3.E10.m1.8.8.1.1.1.1.1.3.2.1" xref="S3.E10.m1.8.8.1.1.1.1.1.3.2.1.cmml">^</mo></mover><mi class="ltx_font_mathcaligraphic" id="S3.E10.m1.8.8.1.1.1.1.1.3.3" xref="S3.E10.m1.8.8.1.1.1.1.1.3.3.cmml">𝒢</mi></msub><mo id="S3.E10.m1.8.8.1.1.1.1.1.2" xref="S3.E10.m1.8.8.1.1.1.1.1.2.cmml">⁢</mo><msub id="S3.E10.m1.8.8.1.1.1.1.1.1" xref="S3.E10.m1.8.8.1.1.1.1.1.1.cmml"><mrow id="S3.E10.m1.8.8.1.1.1.1.1.1.1.1" xref="S3.E10.m1.8.8.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E10.m1.8.8.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E10.m1.8.8.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E10.m1.8.8.1.1.1.1.1.1.1.1.1" xref="S3.E10.m1.8.8.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E10.m1.8.8.1.1.1.1.1.1.1.1.1.2" xref="S3.E10.m1.8.8.1.1.1.1.1.1.1.1.1.2.cmml">v</mi><mi id="S3.E10.m1.8.8.1.1.1.1.1.1.1.1.1.3" xref="S3.E10.m1.8.8.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E10.m1.8.8.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E10.m1.8.8.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mi id="S3.E10.m1.8.8.1.1.1.1.1.1.3" xref="S3.E10.m1.8.8.1.1.1.1.1.1.3.cmml">q</mi></msub></mrow><mo id="S3.E10.m1.8.8.1.1.1.1.3" xref="S3.E10.m1.8.8.1.1.1.1.3.cmml">≔</mo><mrow id="S3.E10.m1.8.8.1.1.1.1.2" xref="S3.E10.m1.8.8.1.1.1.1.2.cmml"><mfrac id="S3.E10.m1.8.8.1.1.1.1.2.3" xref="S3.E10.m1.8.8.1.1.1.1.2.3.cmml"><mn id="S3.E10.m1.8.8.1.1.1.1.2.3.2" xref="S3.E10.m1.8.8.1.1.1.1.2.3.2.cmml">1</mn><mi id="S3.E10.m1.8.8.1.1.1.1.2.3.3" xref="S3.E10.m1.8.8.1.1.1.1.2.3.3.cmml">n</mi></mfrac><mo id="S3.E10.m1.8.8.1.1.1.1.2.2" xref="S3.E10.m1.8.8.1.1.1.1.2.2.cmml">⁢</mo><mrow id="S3.E10.m1.8.8.1.1.1.1.2.1" xref="S3.E10.m1.8.8.1.1.1.1.2.1.cmml"><munderover id="S3.E10.m1.8.8.1.1.1.1.2.1.2" xref="S3.E10.m1.8.8.1.1.1.1.2.1.2.cmml"><mo id="S3.E10.m1.8.8.1.1.1.1.2.1.2.2.2" movablelimits="false" rspace="0em" xref="S3.E10.m1.8.8.1.1.1.1.2.1.2.2.2.cmml">∑</mo><mrow id="S3.E10.m1.8.8.1.1.1.1.2.1.2.2.3" xref="S3.E10.m1.8.8.1.1.1.1.2.1.2.2.3.cmml"><mi id="S3.E10.m1.8.8.1.1.1.1.2.1.2.2.3.2" xref="S3.E10.m1.8.8.1.1.1.1.2.1.2.2.3.2.cmml">k</mi><mo id="S3.E10.m1.8.8.1.1.1.1.2.1.2.2.3.1" xref="S3.E10.m1.8.8.1.1.1.1.2.1.2.2.3.1.cmml">=</mo><mn id="S3.E10.m1.8.8.1.1.1.1.2.1.2.2.3.3" xref="S3.E10.m1.8.8.1.1.1.1.2.1.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E10.m1.8.8.1.1.1.1.2.1.2.3" xref="S3.E10.m1.8.8.1.1.1.1.2.1.2.3.cmml">n</mi></munderover><mrow id="S3.E10.m1.8.8.1.1.1.1.2.1.1" xref="S3.E10.m1.8.8.1.1.1.1.2.1.1.cmml"><munder id="S3.E10.m1.8.8.1.1.1.1.2.1.1.2" xref="S3.E10.m1.8.8.1.1.1.1.2.1.1.2.cmml"><mo id="S3.E10.m1.8.8.1.1.1.1.2.1.1.2.2" movablelimits="false" xref="S3.E10.m1.8.8.1.1.1.1.2.1.1.2.2.cmml">∑</mo><mrow id="S3.E10.m1.8.8.1.1.1.1.2.1.1.2.3" xref="S3.E10.m1.8.8.1.1.1.1.2.1.1.2.3.cmml"><msub id="S3.E10.m1.8.8.1.1.1.1.2.1.1.2.3.2" xref="S3.E10.m1.8.8.1.1.1.1.2.1.1.2.3.2.cmml"><mi id="S3.E10.m1.8.8.1.1.1.1.2.1.1.2.3.2.2" xref="S3.E10.m1.8.8.1.1.1.1.2.1.1.2.3.2.2.cmml">ω</mi><mrow id="S3.E10.m1.8.8.1.1.1.1.2.1.1.2.3.2.3" xref="S3.E10.m1.8.8.1.1.1.1.2.1.1.2.3.2.3.cmml"><mi id="S3.E10.m1.8.8.1.1.1.1.2.1.1.2.3.2.3.2" xref="S3.E10.m1.8.8.1.1.1.1.2.1.1.2.3.2.3.2.cmml">i</mi><mo id="S3.E10.m1.8.8.1.1.1.1.2.1.1.2.3.2.3.1" xref="S3.E10.m1.8.8.1.1.1.1.2.1.1.2.3.2.3.1.cmml">⁢</mo><mi id="S3.E10.m1.8.8.1.1.1.1.2.1.1.2.3.2.3.3" xref="S3.E10.m1.8.8.1.1.1.1.2.1.1.2.3.2.3.3.cmml">q</mi></mrow></msub><mo id="S3.E10.m1.8.8.1.1.1.1.2.1.1.2.3.1" xref="S3.E10.m1.8.8.1.1.1.1.2.1.1.2.3.1.cmml">∈</mo><msub id="S3.E10.m1.8.8.1.1.1.1.2.1.1.2.3.3" xref="S3.E10.m1.8.8.1.1.1.1.2.1.1.2.3.3.cmml"><mi id="S3.E10.m1.8.8.1.1.1.1.2.1.1.2.3.3.2" mathvariant="normal" xref="S3.E10.m1.8.8.1.1.1.1.2.1.1.2.3.3.2.cmml">Ω</mi><mrow id="S3.E10.m1.8.8.1.1.1.1.2.1.1.2.3.3.3" xref="S3.E10.m1.8.8.1.1.1.1.2.1.1.2.3.3.3.cmml"><mi id="S3.E10.m1.8.8.1.1.1.1.2.1.1.2.3.3.3.2" xref="S3.E10.m1.8.8.1.1.1.1.2.1.1.2.3.3.3.2.cmml">i</mi><mo id="S3.E10.m1.8.8.1.1.1.1.2.1.1.2.3.3.3.1" xref="S3.E10.m1.8.8.1.1.1.1.2.1.1.2.3.3.3.1.cmml">⁢</mo><mi id="S3.E10.m1.8.8.1.1.1.1.2.1.1.2.3.3.3.3" xref="S3.E10.m1.8.8.1.1.1.1.2.1.1.2.3.3.3.3.cmml">q</mi></mrow></msub></mrow></munder><mrow id="S3.E10.m1.8.8.1.1.1.1.2.1.1.1" xref="S3.E10.m1.8.8.1.1.1.1.2.1.1.1.cmml"><mfrac id="S3.E10.m1.3.3" xref="S3.E10.m1.3.3.cmml"><mrow id="S3.E10.m1.2.2.2" xref="S3.E10.m1.2.2.2.cmml"><mover accent="true" id="S3.E10.m1.2.2.2.4" xref="S3.E10.m1.2.2.2.4.cmml"><mi id="S3.E10.m1.2.2.2.4.2" xref="S3.E10.m1.2.2.2.4.2.cmml">ω</mi><mo id="S3.E10.m1.2.2.2.4.1" xref="S3.E10.m1.2.2.2.4.1.cmml">~</mo></mover><mo id="S3.E10.m1.2.2.2.3" xref="S3.E10.m1.2.2.2.3.cmml">⁢</mo><mrow id="S3.E10.m1.2.2.2.2.1" xref="S3.E10.m1.2.2.2.2.1.1.cmml"><mo id="S3.E10.m1.2.2.2.2.1.2" stretchy="false" xref="S3.E10.m1.2.2.2.2.1.1.cmml">(</mo><msub id="S3.E10.m1.2.2.2.2.1.1" xref="S3.E10.m1.2.2.2.2.1.1.cmml"><mi id="S3.E10.m1.2.2.2.2.1.1.2" xref="S3.E10.m1.2.2.2.2.1.1.2.cmml">ω</mi><mrow id="S3.E10.m1.2.2.2.2.1.1.3" xref="S3.E10.m1.2.2.2.2.1.1.3.cmml"><mi id="S3.E10.m1.2.2.2.2.1.1.3.2" xref="S3.E10.m1.2.2.2.2.1.1.3.2.cmml">i</mi><mo id="S3.E10.m1.2.2.2.2.1.1.3.1" xref="S3.E10.m1.2.2.2.2.1.1.3.1.cmml">⁢</mo><mi id="S3.E10.m1.2.2.2.2.1.1.3.3" xref="S3.E10.m1.2.2.2.2.1.1.3.3.cmml">q</mi></mrow></msub><mo id="S3.E10.m1.2.2.2.2.1.3" stretchy="false" xref="S3.E10.m1.2.2.2.2.1.1.cmml">)</mo></mrow><mo id="S3.E10.m1.2.2.2.3a" xref="S3.E10.m1.2.2.2.3.cmml">⁢</mo><msub id="S3.E10.m1.2.2.2.5" xref="S3.E10.m1.2.2.2.5.cmml"><mi id="S3.E10.m1.2.2.2.5.2" xref="S3.E10.m1.2.2.2.5.2.cmml">f</mi><mrow id="S3.E10.m1.1.1.1.1.1" xref="S3.E10.m1.1.1.1.1.1.cmml"><mtext id="S3.E10.m1.1.1.1.1.1.3" xref="S3.E10.m1.1.1.1.1.1.3a.cmml">len</mtext><mo id="S3.E10.m1.1.1.1.1.1.2" xref="S3.E10.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E10.m1.1.1.1.1.1.1.1" xref="S3.E10.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E10.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E10.m1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E10.m1.1.1.1.1.1.1.1.1" xref="S3.E10.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E10.m1.1.1.1.1.1.1.1.1.2" xref="S3.E10.m1.1.1.1.1.1.1.1.1.2.cmml">ω</mi><mrow id="S3.E10.m1.1.1.1.1.1.1.1.1.3" xref="S3.E10.m1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E10.m1.1.1.1.1.1.1.1.1.3.2" xref="S3.E10.m1.1.1.1.1.1.1.1.1.3.2.cmml">i</mi><mo id="S3.E10.m1.1.1.1.1.1.1.1.1.3.1" xref="S3.E10.m1.1.1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S3.E10.m1.1.1.1.1.1.1.1.1.3.3" xref="S3.E10.m1.1.1.1.1.1.1.1.1.3.3.cmml">q</mi></mrow></msub><mo id="S3.E10.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E10.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></msub></mrow><mrow id="S3.E10.m1.3.3.3" xref="S3.E10.m1.3.3.3.cmml"><mi id="S3.E10.m1.3.3.3.3" xref="S3.E10.m1.3.3.3.3.cmml">p</mi><mo id="S3.E10.m1.3.3.3.2" xref="S3.E10.m1.3.3.3.2.cmml">⁢</mo><mrow id="S3.E10.m1.3.3.3.1.1" xref="S3.E10.m1.3.3.3.1.1.1.cmml"><mo id="S3.E10.m1.3.3.3.1.1.2" stretchy="false" xref="S3.E10.m1.3.3.3.1.1.1.cmml">(</mo><msub id="S3.E10.m1.3.3.3.1.1.1" xref="S3.E10.m1.3.3.3.1.1.1.cmml"><mi id="S3.E10.m1.3.3.3.1.1.1.2" xref="S3.E10.m1.3.3.3.1.1.1.2.cmml">ω</mi><mrow id="S3.E10.m1.3.3.3.1.1.1.3" xref="S3.E10.m1.3.3.3.1.1.1.3.cmml"><mi id="S3.E10.m1.3.3.3.1.1.1.3.2" xref="S3.E10.m1.3.3.3.1.1.1.3.2.cmml">i</mi><mo id="S3.E10.m1.3.3.3.1.1.1.3.1" xref="S3.E10.m1.3.3.3.1.1.1.3.1.cmml">⁢</mo><mi id="S3.E10.m1.3.3.3.1.1.1.3.3" xref="S3.E10.m1.3.3.3.1.1.1.3.3.cmml">q</mi></mrow></msub><mo id="S3.E10.m1.3.3.3.1.1.3" stretchy="false" xref="S3.E10.m1.3.3.3.1.1.1.cmml">)</mo></mrow></mrow></mfrac><mo id="S3.E10.m1.8.8.1.1.1.1.2.1.1.1.2" xref="S3.E10.m1.8.8.1.1.1.1.2.1.1.1.2.cmml">⁢</mo><mi id="S3.E10.m1.8.8.1.1.1.1.2.1.1.1.3" xref="S3.E10.m1.8.8.1.1.1.1.2.1.1.1.3.cmml">𝕀</mi><mo id="S3.E10.m1.8.8.1.1.1.1.2.1.1.1.2a" xref="S3.E10.m1.8.8.1.1.1.1.2.1.1.1.2.cmml">⁢</mo><mrow id="S3.E10.m1.8.8.1.1.1.1.2.1.1.1.1.1" xref="S3.E10.m1.8.8.1.1.1.1.2.1.1.1.1.1.1.cmml"><mo id="S3.E10.m1.8.8.1.1.1.1.2.1.1.1.1.1.2" stretchy="false" xref="S3.E10.m1.8.8.1.1.1.1.2.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E10.m1.8.8.1.1.1.1.2.1.1.1.1.1.1" xref="S3.E10.m1.8.8.1.1.1.1.2.1.1.1.1.1.1.cmml"><msub id="S3.E10.m1.8.8.1.1.1.1.2.1.1.1.1.1.1.2" xref="S3.E10.m1.8.8.1.1.1.1.2.1.1.1.1.1.1.2.cmml"><mi id="S3.E10.m1.8.8.1.1.1.1.2.1.1.1.1.1.1.2.2" xref="S3.E10.m1.8.8.1.1.1.1.2.1.1.1.1.1.1.2.2.cmml">ω</mi><mrow id="S3.E10.m1.8.8.1.1.1.1.2.1.1.1.1.1.1.2.3" xref="S3.E10.m1.8.8.1.1.1.1.2.1.1.1.1.1.1.2.3.cmml"><mi id="S3.E10.m1.8.8.1.1.1.1.2.1.1.1.1.1.1.2.3.2" xref="S3.E10.m1.8.8.1.1.1.1.2.1.1.1.1.1.1.2.3.2.cmml">i</mi><mo id="S3.E10.m1.8.8.1.1.1.1.2.1.1.1.1.1.1.2.3.1" xref="S3.E10.m1.8.8.1.1.1.1.2.1.1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.E10.m1.8.8.1.1.1.1.2.1.1.1.1.1.1.2.3.3" xref="S3.E10.m1.8.8.1.1.1.1.2.1.1.1.1.1.1.2.3.3.cmml">q</mi></mrow></msub><mo id="S3.E10.m1.8.8.1.1.1.1.2.1.1.1.1.1.1.1" xref="S3.E10.m1.8.8.1.1.1.1.2.1.1.1.1.1.1.1.cmml">⁢</mo><mtext id="S3.E10.m1.8.8.1.1.1.1.2.1.1.1.1.1.1.3" xref="S3.E10.m1.8.8.1.1.1.1.2.1.1.1.1.1.1.3a.cmml">&nbsp;prefix subwalk of&nbsp;</mtext><mo id="S3.E10.m1.8.8.1.1.1.1.2.1.1.1.1.1.1.1a" xref="S3.E10.m1.8.8.1.1.1.1.2.1.1.1.1.1.1.1.cmml">⁢</mo><msubsup id="S3.E10.m1.8.8.1.1.1.1.2.1.1.1.1.1.1.4" xref="S3.E10.m1.8.8.1.1.1.1.2.1.1.1.1.1.1.4.cmml"><mi id="S3.E10.m1.8.8.1.1.1.1.2.1.1.1.1.1.1.4.2.2" xref="S3.E10.m1.8.8.1.1.1.1.2.1.1.1.1.1.1.4.2.2.cmml">ω</mi><mi id="S3.E10.m1.8.8.1.1.1.1.2.1.1.1.1.1.1.4.2.3" xref="S3.E10.m1.8.8.1.1.1.1.2.1.1.1.1.1.1.4.2.3.cmml">k</mi><mrow id="S3.E10.m1.4.4.1.3" xref="S3.E10.m1.8.8.1.1.1.1.2.1.1.1.1.1.1.4.cmml"><mo id="S3.E10.m1.4.4.1.3.1" stretchy="false" xref="S3.E10.m1.8.8.1.1.1.1.2.1.1.1.1.1.1.4.cmml">(</mo><mi id="S3.E10.m1.4.4.1.1" xref="S3.E10.m1.4.4.1.1.cmml">i</mi><mo id="S3.E10.m1.4.4.1.3.2" stretchy="false" xref="S3.E10.m1.8.8.1.1.1.1.2.1.1.1.1.1.1.4.cmml">)</mo></mrow></msubsup></mrow><mo id="S3.E10.m1.8.8.1.1.1.1.2.1.1.1.1.1.3" stretchy="false" xref="S3.E10.m1.8.8.1.1.1.1.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mrow><mo id="S3.E10.m1.8.8.1.1.2.3" rspace="1.167em" xref="S3.E10.m1.8.8.1.1.3a.cmml">,</mo><mrow id="S3.E10.m1.8.8.1.1.2.2" xref="S3.E10.m1.8.8.1.1.2.2.cmml"><mi id="S3.E10.m1.8.8.1.1.2.2.2" xref="S3.E10.m1.8.8.1.1.2.2.2.cmml">q</mi><mo id="S3.E10.m1.8.8.1.1.2.2.1" xref="S3.E10.m1.8.8.1.1.2.2.1.cmml">=</mo><mrow id="S3.E10.m1.8.8.1.1.2.2.3.2" xref="S3.E10.m1.8.8.1.1.2.2.3.1.cmml"><mn id="S3.E10.m1.5.5" xref="S3.E10.m1.5.5.cmml">1</mn><mo id="S3.E10.m1.8.8.1.1.2.2.3.2.1" xref="S3.E10.m1.8.8.1.1.2.2.3.1.cmml">,</mo><mi id="S3.E10.m1.6.6" mathvariant="normal" xref="S3.E10.m1.6.6.cmml">…</mi><mo id="S3.E10.m1.8.8.1.1.2.2.3.2.2" xref="S3.E10.m1.8.8.1.1.2.2.3.1.cmml">,</mo><mi id="S3.E10.m1.7.7" xref="S3.E10.m1.7.7.cmml">N</mi></mrow></mrow></mrow><mo id="S3.E10.m1.8.8.1.2">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E10.m1.8b"><apply id="S3.E10.m1.8.8.1.1.3.cmml" xref="S3.E10.m1.8.8.1.1.2"><csymbol cd="ambiguous" id="S3.E10.m1.8.8.1.1.3a.cmml" xref="S3.E10.m1.8.8.1.1.2.3">formulae-sequence</csymbol><apply id="S3.E10.m1.8.8.1.1.1.1.cmml" xref="S3.E10.m1.8.8.1.1.1.1"><ci id="S3.E10.m1.8.8.1.1.1.1.3.cmml" xref="S3.E10.m1.8.8.1.1.1.1.3">≔</ci><apply id="S3.E10.m1.8.8.1.1.1.1.1.cmml" xref="S3.E10.m1.8.8.1.1.1.1.1"><times id="S3.E10.m1.8.8.1.1.1.1.1.2.cmml" xref="S3.E10.m1.8.8.1.1.1.1.1.2"></times><apply id="S3.E10.m1.8.8.1.1.1.1.1.3.cmml" xref="S3.E10.m1.8.8.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E10.m1.8.8.1.1.1.1.1.3.1.cmml" xref="S3.E10.m1.8.8.1.1.1.1.1.3">subscript</csymbol><apply id="S3.E10.m1.8.8.1.1.1.1.1.3.2.cmml" xref="S3.E10.m1.8.8.1.1.1.1.1.3.2"><ci id="S3.E10.m1.8.8.1.1.1.1.1.3.2.1.cmml" xref="S3.E10.m1.8.8.1.1.1.1.1.3.2.1">^</ci><ci id="S3.E10.m1.8.8.1.1.1.1.1.3.2.2.cmml" xref="S3.E10.m1.8.8.1.1.1.1.1.3.2.2">italic-ϕ</ci></apply><ci id="S3.E10.m1.8.8.1.1.1.1.1.3.3.cmml" xref="S3.E10.m1.8.8.1.1.1.1.1.3.3">𝒢</ci></apply><apply id="S3.E10.m1.8.8.1.1.1.1.1.1.cmml" xref="S3.E10.m1.8.8.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E10.m1.8.8.1.1.1.1.1.1.2.cmml" xref="S3.E10.m1.8.8.1.1.1.1.1.1">subscript</csymbol><apply id="S3.E10.m1.8.8.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E10.m1.8.8.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E10.m1.8.8.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E10.m1.8.8.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E10.m1.8.8.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E10.m1.8.8.1.1.1.1.1.1.1.1.1.2">𝑣</ci><ci id="S3.E10.m1.8.8.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E10.m1.8.8.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><ci id="S3.E10.m1.8.8.1.1.1.1.1.1.3.cmml" xref="S3.E10.m1.8.8.1.1.1.1.1.1.3">𝑞</ci></apply></apply><apply id="S3.E10.m1.8.8.1.1.1.1.2.cmml" xref="S3.E10.m1.8.8.1.1.1.1.2"><times id="S3.E10.m1.8.8.1.1.1.1.2.2.cmml" xref="S3.E10.m1.8.8.1.1.1.1.2.2"></times><apply id="S3.E10.m1.8.8.1.1.1.1.2.3.cmml" xref="S3.E10.m1.8.8.1.1.1.1.2.3"><divide id="S3.E10.m1.8.8.1.1.1.1.2.3.1.cmml" xref="S3.E10.m1.8.8.1.1.1.1.2.3"></divide><cn id="S3.E10.m1.8.8.1.1.1.1.2.3.2.cmml" type="integer" xref="S3.E10.m1.8.8.1.1.1.1.2.3.2">1</cn><ci id="S3.E10.m1.8.8.1.1.1.1.2.3.3.cmml" xref="S3.E10.m1.8.8.1.1.1.1.2.3.3">𝑛</ci></apply><apply id="S3.E10.m1.8.8.1.1.1.1.2.1.cmml" xref="S3.E10.m1.8.8.1.1.1.1.2.1"><apply id="S3.E10.m1.8.8.1.1.1.1.2.1.2.cmml" xref="S3.E10.m1.8.8.1.1.1.1.2.1.2"><csymbol cd="ambiguous" id="S3.E10.m1.8.8.1.1.1.1.2.1.2.1.cmml" xref="S3.E10.m1.8.8.1.1.1.1.2.1.2">superscript</csymbol><apply id="S3.E10.m1.8.8.1.1.1.1.2.1.2.2.cmml" xref="S3.E10.m1.8.8.1.1.1.1.2.1.2"><csymbol cd="ambiguous" id="S3.E10.m1.8.8.1.1.1.1.2.1.2.2.1.cmml" xref="S3.E10.m1.8.8.1.1.1.1.2.1.2">subscript</csymbol><sum id="S3.E10.m1.8.8.1.1.1.1.2.1.2.2.2.cmml" xref="S3.E10.m1.8.8.1.1.1.1.2.1.2.2.2"></sum><apply id="S3.E10.m1.8.8.1.1.1.1.2.1.2.2.3.cmml" xref="S3.E10.m1.8.8.1.1.1.1.2.1.2.2.3"><eq id="S3.E10.m1.8.8.1.1.1.1.2.1.2.2.3.1.cmml" xref="S3.E10.m1.8.8.1.1.1.1.2.1.2.2.3.1"></eq><ci id="S3.E10.m1.8.8.1.1.1.1.2.1.2.2.3.2.cmml" xref="S3.E10.m1.8.8.1.1.1.1.2.1.2.2.3.2">𝑘</ci><cn id="S3.E10.m1.8.8.1.1.1.1.2.1.2.2.3.3.cmml" type="integer" xref="S3.E10.m1.8.8.1.1.1.1.2.1.2.2.3.3">1</cn></apply></apply><ci id="S3.E10.m1.8.8.1.1.1.1.2.1.2.3.cmml" xref="S3.E10.m1.8.8.1.1.1.1.2.1.2.3">𝑛</ci></apply><apply id="S3.E10.m1.8.8.1.1.1.1.2.1.1.cmml" xref="S3.E10.m1.8.8.1.1.1.1.2.1.1"><apply id="S3.E10.m1.8.8.1.1.1.1.2.1.1.2.cmml" xref="S3.E10.m1.8.8.1.1.1.1.2.1.1.2"><csymbol cd="ambiguous" id="S3.E10.m1.8.8.1.1.1.1.2.1.1.2.1.cmml" xref="S3.E10.m1.8.8.1.1.1.1.2.1.1.2">subscript</csymbol><sum id="S3.E10.m1.8.8.1.1.1.1.2.1.1.2.2.cmml" xref="S3.E10.m1.8.8.1.1.1.1.2.1.1.2.2"></sum><apply id="S3.E10.m1.8.8.1.1.1.1.2.1.1.2.3.cmml" xref="S3.E10.m1.8.8.1.1.1.1.2.1.1.2.3"><in id="S3.E10.m1.8.8.1.1.1.1.2.1.1.2.3.1.cmml" xref="S3.E10.m1.8.8.1.1.1.1.2.1.1.2.3.1"></in><apply id="S3.E10.m1.8.8.1.1.1.1.2.1.1.2.3.2.cmml" xref="S3.E10.m1.8.8.1.1.1.1.2.1.1.2.3.2"><csymbol cd="ambiguous" id="S3.E10.m1.8.8.1.1.1.1.2.1.1.2.3.2.1.cmml" xref="S3.E10.m1.8.8.1.1.1.1.2.1.1.2.3.2">subscript</csymbol><ci id="S3.E10.m1.8.8.1.1.1.1.2.1.1.2.3.2.2.cmml" xref="S3.E10.m1.8.8.1.1.1.1.2.1.1.2.3.2.2">𝜔</ci><apply id="S3.E10.m1.8.8.1.1.1.1.2.1.1.2.3.2.3.cmml" xref="S3.E10.m1.8.8.1.1.1.1.2.1.1.2.3.2.3"><times id="S3.E10.m1.8.8.1.1.1.1.2.1.1.2.3.2.3.1.cmml" xref="S3.E10.m1.8.8.1.1.1.1.2.1.1.2.3.2.3.1"></times><ci id="S3.E10.m1.8.8.1.1.1.1.2.1.1.2.3.2.3.2.cmml" xref="S3.E10.m1.8.8.1.1.1.1.2.1.1.2.3.2.3.2">𝑖</ci><ci id="S3.E10.m1.8.8.1.1.1.1.2.1.1.2.3.2.3.3.cmml" xref="S3.E10.m1.8.8.1.1.1.1.2.1.1.2.3.2.3.3">𝑞</ci></apply></apply><apply id="S3.E10.m1.8.8.1.1.1.1.2.1.1.2.3.3.cmml" xref="S3.E10.m1.8.8.1.1.1.1.2.1.1.2.3.3"><csymbol cd="ambiguous" id="S3.E10.m1.8.8.1.1.1.1.2.1.1.2.3.3.1.cmml" xref="S3.E10.m1.8.8.1.1.1.1.2.1.1.2.3.3">subscript</csymbol><ci id="S3.E10.m1.8.8.1.1.1.1.2.1.1.2.3.3.2.cmml" xref="S3.E10.m1.8.8.1.1.1.1.2.1.1.2.3.3.2">Ω</ci><apply id="S3.E10.m1.8.8.1.1.1.1.2.1.1.2.3.3.3.cmml" xref="S3.E10.m1.8.8.1.1.1.1.2.1.1.2.3.3.3"><times id="S3.E10.m1.8.8.1.1.1.1.2.1.1.2.3.3.3.1.cmml" xref="S3.E10.m1.8.8.1.1.1.1.2.1.1.2.3.3.3.1"></times><ci id="S3.E10.m1.8.8.1.1.1.1.2.1.1.2.3.3.3.2.cmml" xref="S3.E10.m1.8.8.1.1.1.1.2.1.1.2.3.3.3.2">𝑖</ci><ci id="S3.E10.m1.8.8.1.1.1.1.2.1.1.2.3.3.3.3.cmml" xref="S3.E10.m1.8.8.1.1.1.1.2.1.1.2.3.3.3.3">𝑞</ci></apply></apply></apply></apply><apply id="S3.E10.m1.8.8.1.1.1.1.2.1.1.1.cmml" xref="S3.E10.m1.8.8.1.1.1.1.2.1.1.1"><times id="S3.E10.m1.8.8.1.1.1.1.2.1.1.1.2.cmml" xref="S3.E10.m1.8.8.1.1.1.1.2.1.1.1.2"></times><apply id="S3.E10.m1.3.3.cmml" xref="S3.E10.m1.3.3"><divide id="S3.E10.m1.3.3.4.cmml" xref="S3.E10.m1.3.3"></divide><apply id="S3.E10.m1.2.2.2.cmml" xref="S3.E10.m1.2.2.2"><times id="S3.E10.m1.2.2.2.3.cmml" xref="S3.E10.m1.2.2.2.3"></times><apply id="S3.E10.m1.2.2.2.4.cmml" xref="S3.E10.m1.2.2.2.4"><ci id="S3.E10.m1.2.2.2.4.1.cmml" xref="S3.E10.m1.2.2.2.4.1">~</ci><ci id="S3.E10.m1.2.2.2.4.2.cmml" xref="S3.E10.m1.2.2.2.4.2">𝜔</ci></apply><apply id="S3.E10.m1.2.2.2.2.1.1.cmml" xref="S3.E10.m1.2.2.2.2.1"><csymbol cd="ambiguous" id="S3.E10.m1.2.2.2.2.1.1.1.cmml" xref="S3.E10.m1.2.2.2.2.1">subscript</csymbol><ci id="S3.E10.m1.2.2.2.2.1.1.2.cmml" xref="S3.E10.m1.2.2.2.2.1.1.2">𝜔</ci><apply id="S3.E10.m1.2.2.2.2.1.1.3.cmml" xref="S3.E10.m1.2.2.2.2.1.1.3"><times id="S3.E10.m1.2.2.2.2.1.1.3.1.cmml" xref="S3.E10.m1.2.2.2.2.1.1.3.1"></times><ci id="S3.E10.m1.2.2.2.2.1.1.3.2.cmml" xref="S3.E10.m1.2.2.2.2.1.1.3.2">𝑖</ci><ci id="S3.E10.m1.2.2.2.2.1.1.3.3.cmml" xref="S3.E10.m1.2.2.2.2.1.1.3.3">𝑞</ci></apply></apply><apply id="S3.E10.m1.2.2.2.5.cmml" xref="S3.E10.m1.2.2.2.5"><csymbol cd="ambiguous" id="S3.E10.m1.2.2.2.5.1.cmml" xref="S3.E10.m1.2.2.2.5">subscript</csymbol><ci id="S3.E10.m1.2.2.2.5.2.cmml" xref="S3.E10.m1.2.2.2.5.2">𝑓</ci><apply id="S3.E10.m1.1.1.1.1.1.cmml" xref="S3.E10.m1.1.1.1.1.1"><times id="S3.E10.m1.1.1.1.1.1.2.cmml" xref="S3.E10.m1.1.1.1.1.1.2"></times><ci id="S3.E10.m1.1.1.1.1.1.3a.cmml" xref="S3.E10.m1.1.1.1.1.1.3"><mtext id="S3.E10.m1.1.1.1.1.1.3.cmml" mathsize="70%" xref="S3.E10.m1.1.1.1.1.1.3">len</mtext></ci><apply id="S3.E10.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E10.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E10.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E10.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E10.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E10.m1.1.1.1.1.1.1.1.1.2">𝜔</ci><apply id="S3.E10.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E10.m1.1.1.1.1.1.1.1.1.3"><times id="S3.E10.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E10.m1.1.1.1.1.1.1.1.1.3.1"></times><ci id="S3.E10.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E10.m1.1.1.1.1.1.1.1.1.3.2">𝑖</ci><ci id="S3.E10.m1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E10.m1.1.1.1.1.1.1.1.1.3.3">𝑞</ci></apply></apply></apply></apply></apply><apply id="S3.E10.m1.3.3.3.cmml" xref="S3.E10.m1.3.3.3"><times id="S3.E10.m1.3.3.3.2.cmml" xref="S3.E10.m1.3.3.3.2"></times><ci id="S3.E10.m1.3.3.3.3.cmml" xref="S3.E10.m1.3.3.3.3">𝑝</ci><apply id="S3.E10.m1.3.3.3.1.1.1.cmml" xref="S3.E10.m1.3.3.3.1.1"><csymbol cd="ambiguous" id="S3.E10.m1.3.3.3.1.1.1.1.cmml" xref="S3.E10.m1.3.3.3.1.1">subscript</csymbol><ci id="S3.E10.m1.3.3.3.1.1.1.2.cmml" xref="S3.E10.m1.3.3.3.1.1.1.2">𝜔</ci><apply id="S3.E10.m1.3.3.3.1.1.1.3.cmml" xref="S3.E10.m1.3.3.3.1.1.1.3"><times id="S3.E10.m1.3.3.3.1.1.1.3.1.cmml" xref="S3.E10.m1.3.3.3.1.1.1.3.1"></times><ci id="S3.E10.m1.3.3.3.1.1.1.3.2.cmml" xref="S3.E10.m1.3.3.3.1.1.1.3.2">𝑖</ci><ci id="S3.E10.m1.3.3.3.1.1.1.3.3.cmml" xref="S3.E10.m1.3.3.3.1.1.1.3.3">𝑞</ci></apply></apply></apply></apply><ci id="S3.E10.m1.8.8.1.1.1.1.2.1.1.1.3.cmml" xref="S3.E10.m1.8.8.1.1.1.1.2.1.1.1.3">𝕀</ci><apply id="S3.E10.m1.8.8.1.1.1.1.2.1.1.1.1.1.1.cmml" xref="S3.E10.m1.8.8.1.1.1.1.2.1.1.1.1.1"><times id="S3.E10.m1.8.8.1.1.1.1.2.1.1.1.1.1.1.1.cmml" xref="S3.E10.m1.8.8.1.1.1.1.2.1.1.1.1.1.1.1"></times><apply id="S3.E10.m1.8.8.1.1.1.1.2.1.1.1.1.1.1.2.cmml" xref="S3.E10.m1.8.8.1.1.1.1.2.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E10.m1.8.8.1.1.1.1.2.1.1.1.1.1.1.2.1.cmml" xref="S3.E10.m1.8.8.1.1.1.1.2.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E10.m1.8.8.1.1.1.1.2.1.1.1.1.1.1.2.2.cmml" xref="S3.E10.m1.8.8.1.1.1.1.2.1.1.1.1.1.1.2.2">𝜔</ci><apply id="S3.E10.m1.8.8.1.1.1.1.2.1.1.1.1.1.1.2.3.cmml" xref="S3.E10.m1.8.8.1.1.1.1.2.1.1.1.1.1.1.2.3"><times id="S3.E10.m1.8.8.1.1.1.1.2.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E10.m1.8.8.1.1.1.1.2.1.1.1.1.1.1.2.3.1"></times><ci id="S3.E10.m1.8.8.1.1.1.1.2.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E10.m1.8.8.1.1.1.1.2.1.1.1.1.1.1.2.3.2">𝑖</ci><ci id="S3.E10.m1.8.8.1.1.1.1.2.1.1.1.1.1.1.2.3.3.cmml" xref="S3.E10.m1.8.8.1.1.1.1.2.1.1.1.1.1.1.2.3.3">𝑞</ci></apply></apply><ci id="S3.E10.m1.8.8.1.1.1.1.2.1.1.1.1.1.1.3a.cmml" xref="S3.E10.m1.8.8.1.1.1.1.2.1.1.1.1.1.1.3"><mtext id="S3.E10.m1.8.8.1.1.1.1.2.1.1.1.1.1.1.3.cmml" xref="S3.E10.m1.8.8.1.1.1.1.2.1.1.1.1.1.1.3">&nbsp;prefix subwalk of&nbsp;</mtext></ci><apply id="S3.E10.m1.8.8.1.1.1.1.2.1.1.1.1.1.1.4.cmml" xref="S3.E10.m1.8.8.1.1.1.1.2.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E10.m1.8.8.1.1.1.1.2.1.1.1.1.1.1.4.1.cmml" xref="S3.E10.m1.8.8.1.1.1.1.2.1.1.1.1.1.1.4">superscript</csymbol><apply id="S3.E10.m1.8.8.1.1.1.1.2.1.1.1.1.1.1.4.2.cmml" xref="S3.E10.m1.8.8.1.1.1.1.2.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E10.m1.8.8.1.1.1.1.2.1.1.1.1.1.1.4.2.1.cmml" xref="S3.E10.m1.8.8.1.1.1.1.2.1.1.1.1.1.1.4">subscript</csymbol><ci id="S3.E10.m1.8.8.1.1.1.1.2.1.1.1.1.1.1.4.2.2.cmml" xref="S3.E10.m1.8.8.1.1.1.1.2.1.1.1.1.1.1.4.2.2">𝜔</ci><ci id="S3.E10.m1.8.8.1.1.1.1.2.1.1.1.1.1.1.4.2.3.cmml" xref="S3.E10.m1.8.8.1.1.1.1.2.1.1.1.1.1.1.4.2.3">𝑘</ci></apply><ci id="S3.E10.m1.4.4.1.1.cmml" xref="S3.E10.m1.4.4.1.1">𝑖</ci></apply></apply></apply></apply></apply></apply></apply><apply id="S3.E10.m1.8.8.1.1.2.2.cmml" xref="S3.E10.m1.8.8.1.1.2.2"><eq id="S3.E10.m1.8.8.1.1.2.2.1.cmml" xref="S3.E10.m1.8.8.1.1.2.2.1"></eq><ci id="S3.E10.m1.8.8.1.1.2.2.2.cmml" xref="S3.E10.m1.8.8.1.1.2.2.2">𝑞</ci><list id="S3.E10.m1.8.8.1.1.2.2.3.1.cmml" xref="S3.E10.m1.8.8.1.1.2.2.3.2"><cn id="S3.E10.m1.5.5.cmml" type="integer" xref="S3.E10.m1.5.5">1</cn><ci id="S3.E10.m1.6.6.cmml" xref="S3.E10.m1.6.6">…</ci><ci id="S3.E10.m1.7.7.cmml" xref="S3.E10.m1.7.7">𝑁</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E10.m1.8c">\widehat{\phi}_{\mathcal{G}}(v_{i})_{q}\coloneqq\frac{1}{n}\sum_{k=1}^{n}\sum_%
{\omega_{iq}\in\Omega_{iq}}\frac{\widetilde{\omega}(\omega_{iq})f_{\textrm{len%
}(\omega_{iq})}}{p(\omega_{iq})}\mathbb{I}(\omega_{iq}\textrm{ prefix subwalk %
of }\omega_{k}^{(i)}),\quad q=1,...,N,</annotation><annotation encoding="application/x-llamapun" id="S3.E10.m1.8d">over^ start_ARG italic_ϕ end_ARG start_POSTSUBSCRIPT caligraphic_G end_POSTSUBSCRIPT ( italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT ≔ divide start_ARG 1 end_ARG start_ARG italic_n end_ARG ∑ start_POSTSUBSCRIPT italic_k = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT ∑ start_POSTSUBSCRIPT italic_ω start_POSTSUBSCRIPT italic_i italic_q end_POSTSUBSCRIPT ∈ roman_Ω start_POSTSUBSCRIPT italic_i italic_q end_POSTSUBSCRIPT end_POSTSUBSCRIPT divide start_ARG over~ start_ARG italic_ω end_ARG ( italic_ω start_POSTSUBSCRIPT italic_i italic_q end_POSTSUBSCRIPT ) italic_f start_POSTSUBSCRIPT len ( italic_ω start_POSTSUBSCRIPT italic_i italic_q end_POSTSUBSCRIPT ) end_POSTSUBSCRIPT end_ARG start_ARG italic_p ( italic_ω start_POSTSUBSCRIPT italic_i italic_q end_POSTSUBSCRIPT ) end_ARG blackboard_I ( italic_ω start_POSTSUBSCRIPT italic_i italic_q end_POSTSUBSCRIPT prefix subwalk of italic_ω start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT ) , italic_q = 1 , … , italic_N ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.p3.24">where <math alttext="\Omega_{iq}" class="ltx_Math" display="inline" id="S3.SS3.p3.14.m1.1"><semantics id="S3.SS3.p3.14.m1.1a"><msub id="S3.SS3.p3.14.m1.1.1" xref="S3.SS3.p3.14.m1.1.1.cmml"><mi id="S3.SS3.p3.14.m1.1.1.2" mathvariant="normal" xref="S3.SS3.p3.14.m1.1.1.2.cmml">Ω</mi><mrow id="S3.SS3.p3.14.m1.1.1.3" xref="S3.SS3.p3.14.m1.1.1.3.cmml"><mi id="S3.SS3.p3.14.m1.1.1.3.2" xref="S3.SS3.p3.14.m1.1.1.3.2.cmml">i</mi><mo id="S3.SS3.p3.14.m1.1.1.3.1" xref="S3.SS3.p3.14.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.SS3.p3.14.m1.1.1.3.3" xref="S3.SS3.p3.14.m1.1.1.3.3.cmml">q</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.14.m1.1b"><apply id="S3.SS3.p3.14.m1.1.1.cmml" xref="S3.SS3.p3.14.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.14.m1.1.1.1.cmml" xref="S3.SS3.p3.14.m1.1.1">subscript</csymbol><ci id="S3.SS3.p3.14.m1.1.1.2.cmml" xref="S3.SS3.p3.14.m1.1.1.2">Ω</ci><apply id="S3.SS3.p3.14.m1.1.1.3.cmml" xref="S3.SS3.p3.14.m1.1.1.3"><times id="S3.SS3.p3.14.m1.1.1.3.1.cmml" xref="S3.SS3.p3.14.m1.1.1.3.1"></times><ci id="S3.SS3.p3.14.m1.1.1.3.2.cmml" xref="S3.SS3.p3.14.m1.1.1.3.2">𝑖</ci><ci id="S3.SS3.p3.14.m1.1.1.3.3.cmml" xref="S3.SS3.p3.14.m1.1.1.3.3">𝑞</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.14.m1.1c">\Omega_{iq}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.14.m1.1d">roman_Ω start_POSTSUBSCRIPT italic_i italic_q end_POSTSUBSCRIPT</annotation></semantics></math> denotes the set of all walks between nodes <math alttext="v_{i}" class="ltx_Math" display="inline" id="S3.SS3.p3.15.m2.1"><semantics id="S3.SS3.p3.15.m2.1a"><msub id="S3.SS3.p3.15.m2.1.1" xref="S3.SS3.p3.15.m2.1.1.cmml"><mi id="S3.SS3.p3.15.m2.1.1.2" xref="S3.SS3.p3.15.m2.1.1.2.cmml">v</mi><mi id="S3.SS3.p3.15.m2.1.1.3" xref="S3.SS3.p3.15.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.15.m2.1b"><apply id="S3.SS3.p3.15.m2.1.1.cmml" xref="S3.SS3.p3.15.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.15.m2.1.1.1.cmml" xref="S3.SS3.p3.15.m2.1.1">subscript</csymbol><ci id="S3.SS3.p3.15.m2.1.1.2.cmml" xref="S3.SS3.p3.15.m2.1.1.2">𝑣</ci><ci id="S3.SS3.p3.15.m2.1.1.3.cmml" xref="S3.SS3.p3.15.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.15.m2.1c">v_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.15.m2.1d">italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="v_{q}" class="ltx_Math" display="inline" id="S3.SS3.p3.16.m3.1"><semantics id="S3.SS3.p3.16.m3.1a"><msub id="S3.SS3.p3.16.m3.1.1" xref="S3.SS3.p3.16.m3.1.1.cmml"><mi id="S3.SS3.p3.16.m3.1.1.2" xref="S3.SS3.p3.16.m3.1.1.2.cmml">v</mi><mi id="S3.SS3.p3.16.m3.1.1.3" xref="S3.SS3.p3.16.m3.1.1.3.cmml">q</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.16.m3.1b"><apply id="S3.SS3.p3.16.m3.1.1.cmml" xref="S3.SS3.p3.16.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.16.m3.1.1.1.cmml" xref="S3.SS3.p3.16.m3.1.1">subscript</csymbol><ci id="S3.SS3.p3.16.m3.1.1.2.cmml" xref="S3.SS3.p3.16.m3.1.1.2">𝑣</ci><ci id="S3.SS3.p3.16.m3.1.1.3.cmml" xref="S3.SS3.p3.16.m3.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.16.m3.1c">v_{q}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.16.m3.1d">italic_v start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT</annotation></semantics></math>, of which <math alttext="\omega_{iq}" class="ltx_Math" display="inline" id="S3.SS3.p3.17.m4.1"><semantics id="S3.SS3.p3.17.m4.1a"><msub id="S3.SS3.p3.17.m4.1.1" xref="S3.SS3.p3.17.m4.1.1.cmml"><mi id="S3.SS3.p3.17.m4.1.1.2" xref="S3.SS3.p3.17.m4.1.1.2.cmml">ω</mi><mrow id="S3.SS3.p3.17.m4.1.1.3" xref="S3.SS3.p3.17.m4.1.1.3.cmml"><mi id="S3.SS3.p3.17.m4.1.1.3.2" xref="S3.SS3.p3.17.m4.1.1.3.2.cmml">i</mi><mo id="S3.SS3.p3.17.m4.1.1.3.1" xref="S3.SS3.p3.17.m4.1.1.3.1.cmml">⁢</mo><mi id="S3.SS3.p3.17.m4.1.1.3.3" xref="S3.SS3.p3.17.m4.1.1.3.3.cmml">q</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.17.m4.1b"><apply id="S3.SS3.p3.17.m4.1.1.cmml" xref="S3.SS3.p3.17.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.17.m4.1.1.1.cmml" xref="S3.SS3.p3.17.m4.1.1">subscript</csymbol><ci id="S3.SS3.p3.17.m4.1.1.2.cmml" xref="S3.SS3.p3.17.m4.1.1.2">𝜔</ci><apply id="S3.SS3.p3.17.m4.1.1.3.cmml" xref="S3.SS3.p3.17.m4.1.1.3"><times id="S3.SS3.p3.17.m4.1.1.3.1.cmml" xref="S3.SS3.p3.17.m4.1.1.3.1"></times><ci id="S3.SS3.p3.17.m4.1.1.3.2.cmml" xref="S3.SS3.p3.17.m4.1.1.3.2">𝑖</ci><ci id="S3.SS3.p3.17.m4.1.1.3.3.cmml" xref="S3.SS3.p3.17.m4.1.1.3.3">𝑞</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.17.m4.1c">\omega_{iq}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.17.m4.1d">italic_ω start_POSTSUBSCRIPT italic_i italic_q end_POSTSUBSCRIPT</annotation></semantics></math> is a member.
‘Prefix subwalk’ means that the walk <math alttext="\omega_{k}^{(i)}" class="ltx_Math" display="inline" id="S3.SS3.p3.18.m5.1"><semantics id="S3.SS3.p3.18.m5.1a"><msubsup id="S3.SS3.p3.18.m5.1.2" xref="S3.SS3.p3.18.m5.1.2.cmml"><mi id="S3.SS3.p3.18.m5.1.2.2.2" xref="S3.SS3.p3.18.m5.1.2.2.2.cmml">ω</mi><mi id="S3.SS3.p3.18.m5.1.2.2.3" xref="S3.SS3.p3.18.m5.1.2.2.3.cmml">k</mi><mrow id="S3.SS3.p3.18.m5.1.1.1.3" xref="S3.SS3.p3.18.m5.1.2.cmml"><mo id="S3.SS3.p3.18.m5.1.1.1.3.1" stretchy="false" xref="S3.SS3.p3.18.m5.1.2.cmml">(</mo><mi id="S3.SS3.p3.18.m5.1.1.1.1" xref="S3.SS3.p3.18.m5.1.1.1.1.cmml">i</mi><mo id="S3.SS3.p3.18.m5.1.1.1.3.2" stretchy="false" xref="S3.SS3.p3.18.m5.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.18.m5.1b"><apply id="S3.SS3.p3.18.m5.1.2.cmml" xref="S3.SS3.p3.18.m5.1.2"><csymbol cd="ambiguous" id="S3.SS3.p3.18.m5.1.2.1.cmml" xref="S3.SS3.p3.18.m5.1.2">superscript</csymbol><apply id="S3.SS3.p3.18.m5.1.2.2.cmml" xref="S3.SS3.p3.18.m5.1.2"><csymbol cd="ambiguous" id="S3.SS3.p3.18.m5.1.2.2.1.cmml" xref="S3.SS3.p3.18.m5.1.2">subscript</csymbol><ci id="S3.SS3.p3.18.m5.1.2.2.2.cmml" xref="S3.SS3.p3.18.m5.1.2.2.2">𝜔</ci><ci id="S3.SS3.p3.18.m5.1.2.2.3.cmml" xref="S3.SS3.p3.18.m5.1.2.2.3">𝑘</ci></apply><ci id="S3.SS3.p3.18.m5.1.1.1.1.cmml" xref="S3.SS3.p3.18.m5.1.1.1.1">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.18.m5.1c">\omega_{k}^{(i)}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.18.m5.1d">italic_ω start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT</annotation></semantics></math> beginning at node <math alttext="v_{i}" class="ltx_Math" display="inline" id="S3.SS3.p3.19.m6.1"><semantics id="S3.SS3.p3.19.m6.1a"><msub id="S3.SS3.p3.19.m6.1.1" xref="S3.SS3.p3.19.m6.1.1.cmml"><mi id="S3.SS3.p3.19.m6.1.1.2" xref="S3.SS3.p3.19.m6.1.1.2.cmml">v</mi><mi id="S3.SS3.p3.19.m6.1.1.3" xref="S3.SS3.p3.19.m6.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.19.m6.1b"><apply id="S3.SS3.p3.19.m6.1.1.cmml" xref="S3.SS3.p3.19.m6.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.19.m6.1.1.1.cmml" xref="S3.SS3.p3.19.m6.1.1">subscript</csymbol><ci id="S3.SS3.p3.19.m6.1.1.2.cmml" xref="S3.SS3.p3.19.m6.1.1.2">𝑣</ci><ci id="S3.SS3.p3.19.m6.1.1.3.cmml" xref="S3.SS3.p3.19.m6.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.19.m6.1c">v_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.19.m6.1d">italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> initially follows the sequence of nodes <math alttext="\omega_{iq}" class="ltx_Math" display="inline" id="S3.SS3.p3.20.m7.1"><semantics id="S3.SS3.p3.20.m7.1a"><msub id="S3.SS3.p3.20.m7.1.1" xref="S3.SS3.p3.20.m7.1.1.cmml"><mi id="S3.SS3.p3.20.m7.1.1.2" xref="S3.SS3.p3.20.m7.1.1.2.cmml">ω</mi><mrow id="S3.SS3.p3.20.m7.1.1.3" xref="S3.SS3.p3.20.m7.1.1.3.cmml"><mi id="S3.SS3.p3.20.m7.1.1.3.2" xref="S3.SS3.p3.20.m7.1.1.3.2.cmml">i</mi><mo id="S3.SS3.p3.20.m7.1.1.3.1" xref="S3.SS3.p3.20.m7.1.1.3.1.cmml">⁢</mo><mi id="S3.SS3.p3.20.m7.1.1.3.3" xref="S3.SS3.p3.20.m7.1.1.3.3.cmml">q</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.20.m7.1b"><apply id="S3.SS3.p3.20.m7.1.1.cmml" xref="S3.SS3.p3.20.m7.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.20.m7.1.1.1.cmml" xref="S3.SS3.p3.20.m7.1.1">subscript</csymbol><ci id="S3.SS3.p3.20.m7.1.1.2.cmml" xref="S3.SS3.p3.20.m7.1.1.2">𝜔</ci><apply id="S3.SS3.p3.20.m7.1.1.3.cmml" xref="S3.SS3.p3.20.m7.1.1.3"><times id="S3.SS3.p3.20.m7.1.1.3.1.cmml" xref="S3.SS3.p3.20.m7.1.1.3.1"></times><ci id="S3.SS3.p3.20.m7.1.1.3.2.cmml" xref="S3.SS3.p3.20.m7.1.1.3.2">𝑖</ci><ci id="S3.SS3.p3.20.m7.1.1.3.3.cmml" xref="S3.SS3.p3.20.m7.1.1.3.3">𝑞</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.20.m7.1c">\omega_{iq}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.20.m7.1d">italic_ω start_POSTSUBSCRIPT italic_i italic_q end_POSTSUBSCRIPT</annotation></semantics></math>, then optionally continues.
This complicated notation belies a very simple algorithm: one simulates <math alttext="n" class="ltx_Math" display="inline" id="S3.SS3.p3.21.m8.1"><semantics id="S3.SS3.p3.21.m8.1a"><mi id="S3.SS3.p3.21.m8.1.1" xref="S3.SS3.p3.21.m8.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.21.m8.1b"><ci id="S3.SS3.p3.21.m8.1.1.cmml" xref="S3.SS3.p3.21.m8.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.21.m8.1c">n</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.21.m8.1d">italic_n</annotation></semantics></math> random walks out of node <math alttext="v_{i}" class="ltx_Math" display="inline" id="S3.SS3.p3.22.m9.1"><semantics id="S3.SS3.p3.22.m9.1a"><msub id="S3.SS3.p3.22.m9.1.1" xref="S3.SS3.p3.22.m9.1.1.cmml"><mi id="S3.SS3.p3.22.m9.1.1.2" xref="S3.SS3.p3.22.m9.1.1.2.cmml">v</mi><mi id="S3.SS3.p3.22.m9.1.1.3" xref="S3.SS3.p3.22.m9.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.22.m9.1b"><apply id="S3.SS3.p3.22.m9.1.1.cmml" xref="S3.SS3.p3.22.m9.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.22.m9.1.1.1.cmml" xref="S3.SS3.p3.22.m9.1.1">subscript</csymbol><ci id="S3.SS3.p3.22.m9.1.1.2.cmml" xref="S3.SS3.p3.22.m9.1.1.2">𝑣</ci><ci id="S3.SS3.p3.22.m9.1.1.3.cmml" xref="S3.SS3.p3.22.m9.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.22.m9.1c">v_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.22.m9.1d">italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>.
At every visited node, one adds a contribution to the corresponding GRF coordinate that depends on 1) the product of traversed edge weights, 2) the probability of the subwalk and 3) the function <math alttext="f" class="ltx_Math" display="inline" id="S3.SS3.p3.23.m10.1"><semantics id="S3.SS3.p3.23.m10.1a"><mi id="S3.SS3.p3.23.m10.1.1" xref="S3.SS3.p3.23.m10.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.23.m10.1b"><ci id="S3.SS3.p3.23.m10.1.1.cmml" xref="S3.SS3.p3.23.m10.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.23.m10.1c">f</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.23.m10.1d">italic_f</annotation></semantics></math>.
The result is normalised by dividing by the number of walks <math alttext="n" class="ltx_Math" display="inline" id="S3.SS3.p3.24.m11.1"><semantics id="S3.SS3.p3.24.m11.1a"><mi id="S3.SS3.p3.24.m11.1.1" xref="S3.SS3.p3.24.m11.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.24.m11.1b"><ci id="S3.SS3.p3.24.m11.1.1.cmml" xref="S3.SS3.p3.24.m11.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.24.m11.1c">n</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.24.m11.1d">italic_n</annotation></semantics></math>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS3.p4">
<p class="ltx_p" id="S3.SS3.p4.7">GRFs give unbiased approximation of graph node kernels: <math alttext="\mathbb{E}[\widehat{\phi}_{\mathcal{G}}(v_{i})^{\top}\widehat{\phi}_{\mathcal{%
G}}(v_{j})]={\mathbf{M}_{\alpha}}_{ij}." class="ltx_Math" display="inline" id="S3.SS3.p4.1.m1.1"><semantics id="S3.SS3.p4.1.m1.1a"><mrow id="S3.SS3.p4.1.m1.1.1.1" xref="S3.SS3.p4.1.m1.1.1.1.1.cmml"><mrow id="S3.SS3.p4.1.m1.1.1.1.1" xref="S3.SS3.p4.1.m1.1.1.1.1.cmml"><mrow id="S3.SS3.p4.1.m1.1.1.1.1.1" xref="S3.SS3.p4.1.m1.1.1.1.1.1.cmml"><mi id="S3.SS3.p4.1.m1.1.1.1.1.1.3" xref="S3.SS3.p4.1.m1.1.1.1.1.1.3.cmml">𝔼</mi><mo id="S3.SS3.p4.1.m1.1.1.1.1.1.2" xref="S3.SS3.p4.1.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.SS3.p4.1.m1.1.1.1.1.1.1.1" xref="S3.SS3.p4.1.m1.1.1.1.1.1.1.2.cmml"><mo id="S3.SS3.p4.1.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.SS3.p4.1.m1.1.1.1.1.1.1.2.1.cmml">[</mo><mrow id="S3.SS3.p4.1.m1.1.1.1.1.1.1.1.1" xref="S3.SS3.p4.1.m1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.SS3.p4.1.m1.1.1.1.1.1.1.1.1.4" xref="S3.SS3.p4.1.m1.1.1.1.1.1.1.1.1.4.cmml"><mover accent="true" id="S3.SS3.p4.1.m1.1.1.1.1.1.1.1.1.4.2" xref="S3.SS3.p4.1.m1.1.1.1.1.1.1.1.1.4.2.cmml"><mi id="S3.SS3.p4.1.m1.1.1.1.1.1.1.1.1.4.2.2" xref="S3.SS3.p4.1.m1.1.1.1.1.1.1.1.1.4.2.2.cmml">ϕ</mi><mo id="S3.SS3.p4.1.m1.1.1.1.1.1.1.1.1.4.2.1" xref="S3.SS3.p4.1.m1.1.1.1.1.1.1.1.1.4.2.1.cmml">^</mo></mover><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p4.1.m1.1.1.1.1.1.1.1.1.4.3" xref="S3.SS3.p4.1.m1.1.1.1.1.1.1.1.1.4.3.cmml">𝒢</mi></msub><mo id="S3.SS3.p4.1.m1.1.1.1.1.1.1.1.1.3" xref="S3.SS3.p4.1.m1.1.1.1.1.1.1.1.1.3.cmml">⁢</mo><msup id="S3.SS3.p4.1.m1.1.1.1.1.1.1.1.1.1" xref="S3.SS3.p4.1.m1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="S3.SS3.p4.1.m1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.SS3.p4.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.SS3.p4.1.m1.1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.SS3.p4.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.SS3.p4.1.m1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.SS3.p4.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.SS3.p4.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.SS3.p4.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">v</mi><mi id="S3.SS3.p4.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.SS3.p4.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS3.p4.1.m1.1.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.SS3.p4.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.SS3.p4.1.m1.1.1.1.1.1.1.1.1.1.3" xref="S3.SS3.p4.1.m1.1.1.1.1.1.1.1.1.1.3.cmml">⊤</mo></msup><mo id="S3.SS3.p4.1.m1.1.1.1.1.1.1.1.1.3a" xref="S3.SS3.p4.1.m1.1.1.1.1.1.1.1.1.3.cmml">⁢</mo><msub id="S3.SS3.p4.1.m1.1.1.1.1.1.1.1.1.5" xref="S3.SS3.p4.1.m1.1.1.1.1.1.1.1.1.5.cmml"><mover accent="true" id="S3.SS3.p4.1.m1.1.1.1.1.1.1.1.1.5.2" xref="S3.SS3.p4.1.m1.1.1.1.1.1.1.1.1.5.2.cmml"><mi id="S3.SS3.p4.1.m1.1.1.1.1.1.1.1.1.5.2.2" xref="S3.SS3.p4.1.m1.1.1.1.1.1.1.1.1.5.2.2.cmml">ϕ</mi><mo id="S3.SS3.p4.1.m1.1.1.1.1.1.1.1.1.5.2.1" xref="S3.SS3.p4.1.m1.1.1.1.1.1.1.1.1.5.2.1.cmml">^</mo></mover><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p4.1.m1.1.1.1.1.1.1.1.1.5.3" xref="S3.SS3.p4.1.m1.1.1.1.1.1.1.1.1.5.3.cmml">𝒢</mi></msub><mo id="S3.SS3.p4.1.m1.1.1.1.1.1.1.1.1.3b" xref="S3.SS3.p4.1.m1.1.1.1.1.1.1.1.1.3.cmml">⁢</mo><mrow id="S3.SS3.p4.1.m1.1.1.1.1.1.1.1.1.2.1" xref="S3.SS3.p4.1.m1.1.1.1.1.1.1.1.1.2.1.1.cmml"><mo id="S3.SS3.p4.1.m1.1.1.1.1.1.1.1.1.2.1.2" stretchy="false" xref="S3.SS3.p4.1.m1.1.1.1.1.1.1.1.1.2.1.1.cmml">(</mo><msub id="S3.SS3.p4.1.m1.1.1.1.1.1.1.1.1.2.1.1" xref="S3.SS3.p4.1.m1.1.1.1.1.1.1.1.1.2.1.1.cmml"><mi id="S3.SS3.p4.1.m1.1.1.1.1.1.1.1.1.2.1.1.2" xref="S3.SS3.p4.1.m1.1.1.1.1.1.1.1.1.2.1.1.2.cmml">v</mi><mi id="S3.SS3.p4.1.m1.1.1.1.1.1.1.1.1.2.1.1.3" xref="S3.SS3.p4.1.m1.1.1.1.1.1.1.1.1.2.1.1.3.cmml">j</mi></msub><mo id="S3.SS3.p4.1.m1.1.1.1.1.1.1.1.1.2.1.3" stretchy="false" xref="S3.SS3.p4.1.m1.1.1.1.1.1.1.1.1.2.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS3.p4.1.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.SS3.p4.1.m1.1.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="S3.SS3.p4.1.m1.1.1.1.1.2" xref="S3.SS3.p4.1.m1.1.1.1.1.2.cmml">=</mo><mmultiscripts id="S3.SS3.p4.1.m1.1.1.1.1.3" xref="S3.SS3.p4.1.m1.1.1.1.1.3.cmml"><mi id="S3.SS3.p4.1.m1.1.1.1.1.3.2.2" xref="S3.SS3.p4.1.m1.1.1.1.1.3.2.2.cmml">𝐌</mi><mi id="S3.SS3.p4.1.m1.1.1.1.1.3.2.3" xref="S3.SS3.p4.1.m1.1.1.1.1.3.2.3.cmml">α</mi><mrow id="S3.SS3.p4.1.m1.1.1.1.1.3a" xref="S3.SS3.p4.1.m1.1.1.1.1.3.cmml"></mrow><mrow id="S3.SS3.p4.1.m1.1.1.1.1.3.3" xref="S3.SS3.p4.1.m1.1.1.1.1.3.3.cmml"><mi id="S3.SS3.p4.1.m1.1.1.1.1.3.3.2" xref="S3.SS3.p4.1.m1.1.1.1.1.3.3.2.cmml">i</mi><mo id="S3.SS3.p4.1.m1.1.1.1.1.3.3.1" xref="S3.SS3.p4.1.m1.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="S3.SS3.p4.1.m1.1.1.1.1.3.3.3" xref="S3.SS3.p4.1.m1.1.1.1.1.3.3.3.cmml">j</mi></mrow><mrow id="S3.SS3.p4.1.m1.1.1.1.1.3b" xref="S3.SS3.p4.1.m1.1.1.1.1.3.cmml"></mrow></mmultiscripts></mrow><mo id="S3.SS3.p4.1.m1.1.1.1.2" lspace="0em" xref="S3.SS3.p4.1.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.1.m1.1b"><apply id="S3.SS3.p4.1.m1.1.1.1.1.cmml" xref="S3.SS3.p4.1.m1.1.1.1"><eq id="S3.SS3.p4.1.m1.1.1.1.1.2.cmml" xref="S3.SS3.p4.1.m1.1.1.1.1.2"></eq><apply id="S3.SS3.p4.1.m1.1.1.1.1.1.cmml" xref="S3.SS3.p4.1.m1.1.1.1.1.1"><times id="S3.SS3.p4.1.m1.1.1.1.1.1.2.cmml" xref="S3.SS3.p4.1.m1.1.1.1.1.1.2"></times><ci id="S3.SS3.p4.1.m1.1.1.1.1.1.3.cmml" xref="S3.SS3.p4.1.m1.1.1.1.1.1.3">𝔼</ci><apply id="S3.SS3.p4.1.m1.1.1.1.1.1.1.2.cmml" xref="S3.SS3.p4.1.m1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.SS3.p4.1.m1.1.1.1.1.1.1.2.1.cmml" xref="S3.SS3.p4.1.m1.1.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.SS3.p4.1.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS3.p4.1.m1.1.1.1.1.1.1.1.1"><times id="S3.SS3.p4.1.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.SS3.p4.1.m1.1.1.1.1.1.1.1.1.3"></times><apply id="S3.SS3.p4.1.m1.1.1.1.1.1.1.1.1.4.cmml" xref="S3.SS3.p4.1.m1.1.1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.SS3.p4.1.m1.1.1.1.1.1.1.1.1.4.1.cmml" xref="S3.SS3.p4.1.m1.1.1.1.1.1.1.1.1.4">subscript</csymbol><apply id="S3.SS3.p4.1.m1.1.1.1.1.1.1.1.1.4.2.cmml" xref="S3.SS3.p4.1.m1.1.1.1.1.1.1.1.1.4.2"><ci id="S3.SS3.p4.1.m1.1.1.1.1.1.1.1.1.4.2.1.cmml" xref="S3.SS3.p4.1.m1.1.1.1.1.1.1.1.1.4.2.1">^</ci><ci id="S3.SS3.p4.1.m1.1.1.1.1.1.1.1.1.4.2.2.cmml" xref="S3.SS3.p4.1.m1.1.1.1.1.1.1.1.1.4.2.2">italic-ϕ</ci></apply><ci id="S3.SS3.p4.1.m1.1.1.1.1.1.1.1.1.4.3.cmml" xref="S3.SS3.p4.1.m1.1.1.1.1.1.1.1.1.4.3">𝒢</ci></apply><apply id="S3.SS3.p4.1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS3.p4.1.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p4.1.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.SS3.p4.1.m1.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.SS3.p4.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS3.p4.1.m1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p4.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS3.p4.1.m1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS3.p4.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.SS3.p4.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2">𝑣</ci><ci id="S3.SS3.p4.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.SS3.p4.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><csymbol cd="latexml" id="S3.SS3.p4.1.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.SS3.p4.1.m1.1.1.1.1.1.1.1.1.1.3">top</csymbol></apply><apply id="S3.SS3.p4.1.m1.1.1.1.1.1.1.1.1.5.cmml" xref="S3.SS3.p4.1.m1.1.1.1.1.1.1.1.1.5"><csymbol cd="ambiguous" id="S3.SS3.p4.1.m1.1.1.1.1.1.1.1.1.5.1.cmml" xref="S3.SS3.p4.1.m1.1.1.1.1.1.1.1.1.5">subscript</csymbol><apply id="S3.SS3.p4.1.m1.1.1.1.1.1.1.1.1.5.2.cmml" xref="S3.SS3.p4.1.m1.1.1.1.1.1.1.1.1.5.2"><ci id="S3.SS3.p4.1.m1.1.1.1.1.1.1.1.1.5.2.1.cmml" xref="S3.SS3.p4.1.m1.1.1.1.1.1.1.1.1.5.2.1">^</ci><ci id="S3.SS3.p4.1.m1.1.1.1.1.1.1.1.1.5.2.2.cmml" xref="S3.SS3.p4.1.m1.1.1.1.1.1.1.1.1.5.2.2">italic-ϕ</ci></apply><ci id="S3.SS3.p4.1.m1.1.1.1.1.1.1.1.1.5.3.cmml" xref="S3.SS3.p4.1.m1.1.1.1.1.1.1.1.1.5.3">𝒢</ci></apply><apply id="S3.SS3.p4.1.m1.1.1.1.1.1.1.1.1.2.1.1.cmml" xref="S3.SS3.p4.1.m1.1.1.1.1.1.1.1.1.2.1"><csymbol cd="ambiguous" id="S3.SS3.p4.1.m1.1.1.1.1.1.1.1.1.2.1.1.1.cmml" xref="S3.SS3.p4.1.m1.1.1.1.1.1.1.1.1.2.1">subscript</csymbol><ci id="S3.SS3.p4.1.m1.1.1.1.1.1.1.1.1.2.1.1.2.cmml" xref="S3.SS3.p4.1.m1.1.1.1.1.1.1.1.1.2.1.1.2">𝑣</ci><ci id="S3.SS3.p4.1.m1.1.1.1.1.1.1.1.1.2.1.1.3.cmml" xref="S3.SS3.p4.1.m1.1.1.1.1.1.1.1.1.2.1.1.3">𝑗</ci></apply></apply></apply></apply><apply id="S3.SS3.p4.1.m1.1.1.1.1.3.cmml" xref="S3.SS3.p4.1.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p4.1.m1.1.1.1.1.3.1.cmml" xref="S3.SS3.p4.1.m1.1.1.1.1.3">subscript</csymbol><apply id="S3.SS3.p4.1.m1.1.1.1.1.3.2.cmml" xref="S3.SS3.p4.1.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p4.1.m1.1.1.1.1.3.2.1.cmml" xref="S3.SS3.p4.1.m1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS3.p4.1.m1.1.1.1.1.3.2.2.cmml" xref="S3.SS3.p4.1.m1.1.1.1.1.3.2.2">𝐌</ci><ci id="S3.SS3.p4.1.m1.1.1.1.1.3.2.3.cmml" xref="S3.SS3.p4.1.m1.1.1.1.1.3.2.3">𝛼</ci></apply><apply id="S3.SS3.p4.1.m1.1.1.1.1.3.3.cmml" xref="S3.SS3.p4.1.m1.1.1.1.1.3.3"><times id="S3.SS3.p4.1.m1.1.1.1.1.3.3.1.cmml" xref="S3.SS3.p4.1.m1.1.1.1.1.3.3.1"></times><ci id="S3.SS3.p4.1.m1.1.1.1.1.3.3.2.cmml" xref="S3.SS3.p4.1.m1.1.1.1.1.3.3.2">𝑖</ci><ci id="S3.SS3.p4.1.m1.1.1.1.1.3.3.3.cmml" xref="S3.SS3.p4.1.m1.1.1.1.1.3.3.3">𝑗</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.1.m1.1c">\mathbb{E}[\widehat{\phi}_{\mathcal{G}}(v_{i})^{\top}\widehat{\phi}_{\mathcal{%
G}}(v_{j})]={\mathbf{M}_{\alpha}}_{ij}.</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p4.1.m1.1d">blackboard_E [ over^ start_ARG italic_ϕ end_ARG start_POSTSUBSCRIPT caligraphic_G end_POSTSUBSCRIPT ( italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT over^ start_ARG italic_ϕ end_ARG start_POSTSUBSCRIPT caligraphic_G end_POSTSUBSCRIPT ( italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) ] = bold_M start_POSTSUBSCRIPT italic_α end_POSTSUBSCRIPT start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT .</annotation></semantics></math>
This follows because <math alttext="\mathbb{E}[\mathbb{I}(\omega_{iq}\textrm{ prefix subwalk of }\omega_{k}^{(i)})%
]=p(\omega_{iq})" class="ltx_Math" display="inline" id="S3.SS3.p4.2.m2.3"><semantics id="S3.SS3.p4.2.m2.3a"><mrow id="S3.SS3.p4.2.m2.3.3" xref="S3.SS3.p4.2.m2.3.3.cmml"><mrow id="S3.SS3.p4.2.m2.2.2.1" xref="S3.SS3.p4.2.m2.2.2.1.cmml"><mi id="S3.SS3.p4.2.m2.2.2.1.3" xref="S3.SS3.p4.2.m2.2.2.1.3.cmml">𝔼</mi><mo id="S3.SS3.p4.2.m2.2.2.1.2" xref="S3.SS3.p4.2.m2.2.2.1.2.cmml">⁢</mo><mrow id="S3.SS3.p4.2.m2.2.2.1.1.1" xref="S3.SS3.p4.2.m2.2.2.1.1.2.cmml"><mo id="S3.SS3.p4.2.m2.2.2.1.1.1.2" stretchy="false" xref="S3.SS3.p4.2.m2.2.2.1.1.2.1.cmml">[</mo><mrow id="S3.SS3.p4.2.m2.2.2.1.1.1.1" xref="S3.SS3.p4.2.m2.2.2.1.1.1.1.cmml"><mi id="S3.SS3.p4.2.m2.2.2.1.1.1.1.3" xref="S3.SS3.p4.2.m2.2.2.1.1.1.1.3.cmml">𝕀</mi><mo id="S3.SS3.p4.2.m2.2.2.1.1.1.1.2" xref="S3.SS3.p4.2.m2.2.2.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.SS3.p4.2.m2.2.2.1.1.1.1.1.1" xref="S3.SS3.p4.2.m2.2.2.1.1.1.1.1.1.1.cmml"><mo id="S3.SS3.p4.2.m2.2.2.1.1.1.1.1.1.2" stretchy="false" xref="S3.SS3.p4.2.m2.2.2.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS3.p4.2.m2.2.2.1.1.1.1.1.1.1" xref="S3.SS3.p4.2.m2.2.2.1.1.1.1.1.1.1.cmml"><msub id="S3.SS3.p4.2.m2.2.2.1.1.1.1.1.1.1.2" xref="S3.SS3.p4.2.m2.2.2.1.1.1.1.1.1.1.2.cmml"><mi id="S3.SS3.p4.2.m2.2.2.1.1.1.1.1.1.1.2.2" xref="S3.SS3.p4.2.m2.2.2.1.1.1.1.1.1.1.2.2.cmml">ω</mi><mrow id="S3.SS3.p4.2.m2.2.2.1.1.1.1.1.1.1.2.3" xref="S3.SS3.p4.2.m2.2.2.1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.SS3.p4.2.m2.2.2.1.1.1.1.1.1.1.2.3.2" xref="S3.SS3.p4.2.m2.2.2.1.1.1.1.1.1.1.2.3.2.cmml">i</mi><mo id="S3.SS3.p4.2.m2.2.2.1.1.1.1.1.1.1.2.3.1" xref="S3.SS3.p4.2.m2.2.2.1.1.1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS3.p4.2.m2.2.2.1.1.1.1.1.1.1.2.3.3" xref="S3.SS3.p4.2.m2.2.2.1.1.1.1.1.1.1.2.3.3.cmml">q</mi></mrow></msub><mo id="S3.SS3.p4.2.m2.2.2.1.1.1.1.1.1.1.1" xref="S3.SS3.p4.2.m2.2.2.1.1.1.1.1.1.1.1.cmml">⁢</mo><mtext id="S3.SS3.p4.2.m2.2.2.1.1.1.1.1.1.1.3" xref="S3.SS3.p4.2.m2.2.2.1.1.1.1.1.1.1.3a.cmml">&nbsp;prefix subwalk of&nbsp;</mtext><mo id="S3.SS3.p4.2.m2.2.2.1.1.1.1.1.1.1.1a" xref="S3.SS3.p4.2.m2.2.2.1.1.1.1.1.1.1.1.cmml">⁢</mo><msubsup id="S3.SS3.p4.2.m2.2.2.1.1.1.1.1.1.1.4" xref="S3.SS3.p4.2.m2.2.2.1.1.1.1.1.1.1.4.cmml"><mi id="S3.SS3.p4.2.m2.2.2.1.1.1.1.1.1.1.4.2.2" xref="S3.SS3.p4.2.m2.2.2.1.1.1.1.1.1.1.4.2.2.cmml">ω</mi><mi id="S3.SS3.p4.2.m2.2.2.1.1.1.1.1.1.1.4.2.3" xref="S3.SS3.p4.2.m2.2.2.1.1.1.1.1.1.1.4.2.3.cmml">k</mi><mrow id="S3.SS3.p4.2.m2.1.1.1.3" xref="S3.SS3.p4.2.m2.2.2.1.1.1.1.1.1.1.4.cmml"><mo id="S3.SS3.p4.2.m2.1.1.1.3.1" stretchy="false" xref="S3.SS3.p4.2.m2.2.2.1.1.1.1.1.1.1.4.cmml">(</mo><mi id="S3.SS3.p4.2.m2.1.1.1.1" xref="S3.SS3.p4.2.m2.1.1.1.1.cmml">i</mi><mo id="S3.SS3.p4.2.m2.1.1.1.3.2" stretchy="false" xref="S3.SS3.p4.2.m2.2.2.1.1.1.1.1.1.1.4.cmml">)</mo></mrow></msubsup></mrow><mo id="S3.SS3.p4.2.m2.2.2.1.1.1.1.1.1.3" stretchy="false" xref="S3.SS3.p4.2.m2.2.2.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS3.p4.2.m2.2.2.1.1.1.3" stretchy="false" xref="S3.SS3.p4.2.m2.2.2.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="S3.SS3.p4.2.m2.3.3.3" xref="S3.SS3.p4.2.m2.3.3.3.cmml">=</mo><mrow id="S3.SS3.p4.2.m2.3.3.2" xref="S3.SS3.p4.2.m2.3.3.2.cmml"><mi id="S3.SS3.p4.2.m2.3.3.2.3" xref="S3.SS3.p4.2.m2.3.3.2.3.cmml">p</mi><mo id="S3.SS3.p4.2.m2.3.3.2.2" xref="S3.SS3.p4.2.m2.3.3.2.2.cmml">⁢</mo><mrow id="S3.SS3.p4.2.m2.3.3.2.1.1" xref="S3.SS3.p4.2.m2.3.3.2.1.1.1.cmml"><mo id="S3.SS3.p4.2.m2.3.3.2.1.1.2" stretchy="false" xref="S3.SS3.p4.2.m2.3.3.2.1.1.1.cmml">(</mo><msub id="S3.SS3.p4.2.m2.3.3.2.1.1.1" xref="S3.SS3.p4.2.m2.3.3.2.1.1.1.cmml"><mi id="S3.SS3.p4.2.m2.3.3.2.1.1.1.2" xref="S3.SS3.p4.2.m2.3.3.2.1.1.1.2.cmml">ω</mi><mrow id="S3.SS3.p4.2.m2.3.3.2.1.1.1.3" xref="S3.SS3.p4.2.m2.3.3.2.1.1.1.3.cmml"><mi id="S3.SS3.p4.2.m2.3.3.2.1.1.1.3.2" xref="S3.SS3.p4.2.m2.3.3.2.1.1.1.3.2.cmml">i</mi><mo id="S3.SS3.p4.2.m2.3.3.2.1.1.1.3.1" xref="S3.SS3.p4.2.m2.3.3.2.1.1.1.3.1.cmml">⁢</mo><mi id="S3.SS3.p4.2.m2.3.3.2.1.1.1.3.3" xref="S3.SS3.p4.2.m2.3.3.2.1.1.1.3.3.cmml">q</mi></mrow></msub><mo id="S3.SS3.p4.2.m2.3.3.2.1.1.3" stretchy="false" xref="S3.SS3.p4.2.m2.3.3.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.2.m2.3b"><apply id="S3.SS3.p4.2.m2.3.3.cmml" xref="S3.SS3.p4.2.m2.3.3"><eq id="S3.SS3.p4.2.m2.3.3.3.cmml" xref="S3.SS3.p4.2.m2.3.3.3"></eq><apply id="S3.SS3.p4.2.m2.2.2.1.cmml" xref="S3.SS3.p4.2.m2.2.2.1"><times id="S3.SS3.p4.2.m2.2.2.1.2.cmml" xref="S3.SS3.p4.2.m2.2.2.1.2"></times><ci id="S3.SS3.p4.2.m2.2.2.1.3.cmml" xref="S3.SS3.p4.2.m2.2.2.1.3">𝔼</ci><apply id="S3.SS3.p4.2.m2.2.2.1.1.2.cmml" xref="S3.SS3.p4.2.m2.2.2.1.1.1"><csymbol cd="latexml" id="S3.SS3.p4.2.m2.2.2.1.1.2.1.cmml" xref="S3.SS3.p4.2.m2.2.2.1.1.1.2">delimited-[]</csymbol><apply id="S3.SS3.p4.2.m2.2.2.1.1.1.1.cmml" xref="S3.SS3.p4.2.m2.2.2.1.1.1.1"><times id="S3.SS3.p4.2.m2.2.2.1.1.1.1.2.cmml" xref="S3.SS3.p4.2.m2.2.2.1.1.1.1.2"></times><ci id="S3.SS3.p4.2.m2.2.2.1.1.1.1.3.cmml" xref="S3.SS3.p4.2.m2.2.2.1.1.1.1.3">𝕀</ci><apply id="S3.SS3.p4.2.m2.2.2.1.1.1.1.1.1.1.cmml" xref="S3.SS3.p4.2.m2.2.2.1.1.1.1.1.1"><times id="S3.SS3.p4.2.m2.2.2.1.1.1.1.1.1.1.1.cmml" xref="S3.SS3.p4.2.m2.2.2.1.1.1.1.1.1.1.1"></times><apply id="S3.SS3.p4.2.m2.2.2.1.1.1.1.1.1.1.2.cmml" xref="S3.SS3.p4.2.m2.2.2.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p4.2.m2.2.2.1.1.1.1.1.1.1.2.1.cmml" xref="S3.SS3.p4.2.m2.2.2.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.SS3.p4.2.m2.2.2.1.1.1.1.1.1.1.2.2.cmml" xref="S3.SS3.p4.2.m2.2.2.1.1.1.1.1.1.1.2.2">𝜔</ci><apply id="S3.SS3.p4.2.m2.2.2.1.1.1.1.1.1.1.2.3.cmml" xref="S3.SS3.p4.2.m2.2.2.1.1.1.1.1.1.1.2.3"><times id="S3.SS3.p4.2.m2.2.2.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.SS3.p4.2.m2.2.2.1.1.1.1.1.1.1.2.3.1"></times><ci id="S3.SS3.p4.2.m2.2.2.1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.SS3.p4.2.m2.2.2.1.1.1.1.1.1.1.2.3.2">𝑖</ci><ci id="S3.SS3.p4.2.m2.2.2.1.1.1.1.1.1.1.2.3.3.cmml" xref="S3.SS3.p4.2.m2.2.2.1.1.1.1.1.1.1.2.3.3">𝑞</ci></apply></apply><ci id="S3.SS3.p4.2.m2.2.2.1.1.1.1.1.1.1.3a.cmml" xref="S3.SS3.p4.2.m2.2.2.1.1.1.1.1.1.1.3"><mtext id="S3.SS3.p4.2.m2.2.2.1.1.1.1.1.1.1.3.cmml" xref="S3.SS3.p4.2.m2.2.2.1.1.1.1.1.1.1.3">&nbsp;prefix subwalk of&nbsp;</mtext></ci><apply id="S3.SS3.p4.2.m2.2.2.1.1.1.1.1.1.1.4.cmml" xref="S3.SS3.p4.2.m2.2.2.1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.SS3.p4.2.m2.2.2.1.1.1.1.1.1.1.4.1.cmml" xref="S3.SS3.p4.2.m2.2.2.1.1.1.1.1.1.1.4">superscript</csymbol><apply id="S3.SS3.p4.2.m2.2.2.1.1.1.1.1.1.1.4.2.cmml" xref="S3.SS3.p4.2.m2.2.2.1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.SS3.p4.2.m2.2.2.1.1.1.1.1.1.1.4.2.1.cmml" xref="S3.SS3.p4.2.m2.2.2.1.1.1.1.1.1.1.4">subscript</csymbol><ci id="S3.SS3.p4.2.m2.2.2.1.1.1.1.1.1.1.4.2.2.cmml" xref="S3.SS3.p4.2.m2.2.2.1.1.1.1.1.1.1.4.2.2">𝜔</ci><ci id="S3.SS3.p4.2.m2.2.2.1.1.1.1.1.1.1.4.2.3.cmml" xref="S3.SS3.p4.2.m2.2.2.1.1.1.1.1.1.1.4.2.3">𝑘</ci></apply><ci id="S3.SS3.p4.2.m2.1.1.1.1.cmml" xref="S3.SS3.p4.2.m2.1.1.1.1">𝑖</ci></apply></apply></apply></apply></apply><apply id="S3.SS3.p4.2.m2.3.3.2.cmml" xref="S3.SS3.p4.2.m2.3.3.2"><times id="S3.SS3.p4.2.m2.3.3.2.2.cmml" xref="S3.SS3.p4.2.m2.3.3.2.2"></times><ci id="S3.SS3.p4.2.m2.3.3.2.3.cmml" xref="S3.SS3.p4.2.m2.3.3.2.3">𝑝</ci><apply id="S3.SS3.p4.2.m2.3.3.2.1.1.1.cmml" xref="S3.SS3.p4.2.m2.3.3.2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p4.2.m2.3.3.2.1.1.1.1.cmml" xref="S3.SS3.p4.2.m2.3.3.2.1.1">subscript</csymbol><ci id="S3.SS3.p4.2.m2.3.3.2.1.1.1.2.cmml" xref="S3.SS3.p4.2.m2.3.3.2.1.1.1.2">𝜔</ci><apply id="S3.SS3.p4.2.m2.3.3.2.1.1.1.3.cmml" xref="S3.SS3.p4.2.m2.3.3.2.1.1.1.3"><times id="S3.SS3.p4.2.m2.3.3.2.1.1.1.3.1.cmml" xref="S3.SS3.p4.2.m2.3.3.2.1.1.1.3.1"></times><ci id="S3.SS3.p4.2.m2.3.3.2.1.1.1.3.2.cmml" xref="S3.SS3.p4.2.m2.3.3.2.1.1.1.3.2">𝑖</ci><ci id="S3.SS3.p4.2.m2.3.3.2.1.1.1.3.3.cmml" xref="S3.SS3.p4.2.m2.3.3.2.1.1.1.3.3">𝑞</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.2.m2.3c">\mathbb{E}[\mathbb{I}(\omega_{iq}\textrm{ prefix subwalk of }\omega_{k}^{(i)})%
]=p(\omega_{iq})</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p4.2.m2.3d">blackboard_E [ blackboard_I ( italic_ω start_POSTSUBSCRIPT italic_i italic_q end_POSTSUBSCRIPT prefix subwalk of italic_ω start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT ) ] = italic_p ( italic_ω start_POSTSUBSCRIPT italic_i italic_q end_POSTSUBSCRIPT )</annotation></semantics></math>.
Unbiasedness is one of our required properties; we also need <math alttext="\widehat{\mathbf{\Phi}}_{\{\mathbf{Q},\mathbf{K}\},\mathcal{G}}" class="ltx_Math" display="inline" id="S3.SS3.p4.3.m3.4"><semantics id="S3.SS3.p4.3.m3.4a"><msub id="S3.SS3.p4.3.m3.4.5" xref="S3.SS3.p4.3.m3.4.5.cmml"><mover accent="true" id="S3.SS3.p4.3.m3.4.5.2" xref="S3.SS3.p4.3.m3.4.5.2.cmml"><mi id="S3.SS3.p4.3.m3.4.5.2.2" xref="S3.SS3.p4.3.m3.4.5.2.2.cmml">𝚽</mi><mo id="S3.SS3.p4.3.m3.4.5.2.1" xref="S3.SS3.p4.3.m3.4.5.2.1.cmml">^</mo></mover><mrow id="S3.SS3.p4.3.m3.4.4.4.4" xref="S3.SS3.p4.3.m3.4.4.4.5.cmml"><mrow id="S3.SS3.p4.3.m3.4.4.4.4.1.2" xref="S3.SS3.p4.3.m3.4.4.4.4.1.1.cmml"><mo id="S3.SS3.p4.3.m3.4.4.4.4.1.2.1" stretchy="false" xref="S3.SS3.p4.3.m3.4.4.4.4.1.1.cmml">{</mo><mi id="S3.SS3.p4.3.m3.1.1.1.1" xref="S3.SS3.p4.3.m3.1.1.1.1.cmml">𝐐</mi><mo id="S3.SS3.p4.3.m3.4.4.4.4.1.2.2" xref="S3.SS3.p4.3.m3.4.4.4.4.1.1.cmml">,</mo><mi id="S3.SS3.p4.3.m3.2.2.2.2" xref="S3.SS3.p4.3.m3.2.2.2.2.cmml">𝐊</mi><mo id="S3.SS3.p4.3.m3.4.4.4.4.1.2.3" stretchy="false" xref="S3.SS3.p4.3.m3.4.4.4.4.1.1.cmml">}</mo></mrow><mo id="S3.SS3.p4.3.m3.4.4.4.4.2" xref="S3.SS3.p4.3.m3.4.4.4.5.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p4.3.m3.3.3.3.3" xref="S3.SS3.p4.3.m3.3.3.3.3.cmml">𝒢</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.3.m3.4b"><apply id="S3.SS3.p4.3.m3.4.5.cmml" xref="S3.SS3.p4.3.m3.4.5"><csymbol cd="ambiguous" id="S3.SS3.p4.3.m3.4.5.1.cmml" xref="S3.SS3.p4.3.m3.4.5">subscript</csymbol><apply id="S3.SS3.p4.3.m3.4.5.2.cmml" xref="S3.SS3.p4.3.m3.4.5.2"><ci id="S3.SS3.p4.3.m3.4.5.2.1.cmml" xref="S3.SS3.p4.3.m3.4.5.2.1">^</ci><ci id="S3.SS3.p4.3.m3.4.5.2.2.cmml" xref="S3.SS3.p4.3.m3.4.5.2.2">𝚽</ci></apply><list id="S3.SS3.p4.3.m3.4.4.4.5.cmml" xref="S3.SS3.p4.3.m3.4.4.4.4"><set id="S3.SS3.p4.3.m3.4.4.4.4.1.1.cmml" xref="S3.SS3.p4.3.m3.4.4.4.4.1.2"><ci id="S3.SS3.p4.3.m3.1.1.1.1.cmml" xref="S3.SS3.p4.3.m3.1.1.1.1">𝐐</ci><ci id="S3.SS3.p4.3.m3.2.2.2.2.cmml" xref="S3.SS3.p4.3.m3.2.2.2.2">𝐊</ci></set><ci id="S3.SS3.p4.3.m3.3.3.3.3.cmml" xref="S3.SS3.p4.3.m3.3.3.3.3">𝒢</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.3.m3.4c">\widehat{\mathbf{\Phi}}_{\{\mathbf{Q},\mathbf{K}\},\mathcal{G}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p4.3.m3.4d">over^ start_ARG bold_Φ end_ARG start_POSTSUBSCRIPT { bold_Q , bold_K } , caligraphic_G end_POSTSUBSCRIPT</annotation></semantics></math> to support <math alttext="\mathcal{O}(N)" class="ltx_Math" display="inline" id="S3.SS3.p4.4.m4.1"><semantics id="S3.SS3.p4.4.m4.1a"><mrow id="S3.SS3.p4.4.m4.1.2" xref="S3.SS3.p4.4.m4.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p4.4.m4.1.2.2" xref="S3.SS3.p4.4.m4.1.2.2.cmml">𝒪</mi><mo id="S3.SS3.p4.4.m4.1.2.1" xref="S3.SS3.p4.4.m4.1.2.1.cmml">⁢</mo><mrow id="S3.SS3.p4.4.m4.1.2.3.2" xref="S3.SS3.p4.4.m4.1.2.cmml"><mo id="S3.SS3.p4.4.m4.1.2.3.2.1" stretchy="false" xref="S3.SS3.p4.4.m4.1.2.cmml">(</mo><mi id="S3.SS3.p4.4.m4.1.1" xref="S3.SS3.p4.4.m4.1.1.cmml">N</mi><mo id="S3.SS3.p4.4.m4.1.2.3.2.2" stretchy="false" xref="S3.SS3.p4.4.m4.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.4.m4.1b"><apply id="S3.SS3.p4.4.m4.1.2.cmml" xref="S3.SS3.p4.4.m4.1.2"><times id="S3.SS3.p4.4.m4.1.2.1.cmml" xref="S3.SS3.p4.4.m4.1.2.1"></times><ci id="S3.SS3.p4.4.m4.1.2.2.cmml" xref="S3.SS3.p4.4.m4.1.2.2">𝒪</ci><ci id="S3.SS3.p4.4.m4.1.1.cmml" xref="S3.SS3.p4.4.m4.1.1">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.4.m4.1c">\mathcal{O}(N)</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p4.4.m4.1d">caligraphic_O ( italic_N )</annotation></semantics></math> matrix-vector multiplication.
We will show this by providing the first known proof that GRFs are <em class="ltx_emph ltx_font_italic" id="S3.SS3.p4.7.1">sparse</em>: <math alttext="\widehat{\phi}(v_{i})" class="ltx_Math" display="inline" id="S3.SS3.p4.5.m5.1"><semantics id="S3.SS3.p4.5.m5.1a"><mrow id="S3.SS3.p4.5.m5.1.1" xref="S3.SS3.p4.5.m5.1.1.cmml"><mover accent="true" id="S3.SS3.p4.5.m5.1.1.3" xref="S3.SS3.p4.5.m5.1.1.3.cmml"><mi id="S3.SS3.p4.5.m5.1.1.3.2" xref="S3.SS3.p4.5.m5.1.1.3.2.cmml">ϕ</mi><mo id="S3.SS3.p4.5.m5.1.1.3.1" xref="S3.SS3.p4.5.m5.1.1.3.1.cmml">^</mo></mover><mo id="S3.SS3.p4.5.m5.1.1.2" xref="S3.SS3.p4.5.m5.1.1.2.cmml">⁢</mo><mrow id="S3.SS3.p4.5.m5.1.1.1.1" xref="S3.SS3.p4.5.m5.1.1.1.1.1.cmml"><mo id="S3.SS3.p4.5.m5.1.1.1.1.2" stretchy="false" xref="S3.SS3.p4.5.m5.1.1.1.1.1.cmml">(</mo><msub id="S3.SS3.p4.5.m5.1.1.1.1.1" xref="S3.SS3.p4.5.m5.1.1.1.1.1.cmml"><mi id="S3.SS3.p4.5.m5.1.1.1.1.1.2" xref="S3.SS3.p4.5.m5.1.1.1.1.1.2.cmml">v</mi><mi id="S3.SS3.p4.5.m5.1.1.1.1.1.3" xref="S3.SS3.p4.5.m5.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS3.p4.5.m5.1.1.1.1.3" stretchy="false" xref="S3.SS3.p4.5.m5.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.5.m5.1b"><apply id="S3.SS3.p4.5.m5.1.1.cmml" xref="S3.SS3.p4.5.m5.1.1"><times id="S3.SS3.p4.5.m5.1.1.2.cmml" xref="S3.SS3.p4.5.m5.1.1.2"></times><apply id="S3.SS3.p4.5.m5.1.1.3.cmml" xref="S3.SS3.p4.5.m5.1.1.3"><ci id="S3.SS3.p4.5.m5.1.1.3.1.cmml" xref="S3.SS3.p4.5.m5.1.1.3.1">^</ci><ci id="S3.SS3.p4.5.m5.1.1.3.2.cmml" xref="S3.SS3.p4.5.m5.1.1.3.2">italic-ϕ</ci></apply><apply id="S3.SS3.p4.5.m5.1.1.1.1.1.cmml" xref="S3.SS3.p4.5.m5.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p4.5.m5.1.1.1.1.1.1.cmml" xref="S3.SS3.p4.5.m5.1.1.1.1">subscript</csymbol><ci id="S3.SS3.p4.5.m5.1.1.1.1.1.2.cmml" xref="S3.SS3.p4.5.m5.1.1.1.1.1.2">𝑣</ci><ci id="S3.SS3.p4.5.m5.1.1.1.1.1.3.cmml" xref="S3.SS3.p4.5.m5.1.1.1.1.1.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.5.m5.1c">\widehat{\phi}(v_{i})</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p4.5.m5.1d">over^ start_ARG italic_ϕ end_ARG ( italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT )</annotation></semantics></math> has <math alttext="\mathcal{O}(1)" class="ltx_Math" display="inline" id="S3.SS3.p4.6.m6.1"><semantics id="S3.SS3.p4.6.m6.1a"><mrow id="S3.SS3.p4.6.m6.1.2" xref="S3.SS3.p4.6.m6.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p4.6.m6.1.2.2" xref="S3.SS3.p4.6.m6.1.2.2.cmml">𝒪</mi><mo id="S3.SS3.p4.6.m6.1.2.1" xref="S3.SS3.p4.6.m6.1.2.1.cmml">⁢</mo><mrow id="S3.SS3.p4.6.m6.1.2.3.2" xref="S3.SS3.p4.6.m6.1.2.cmml"><mo id="S3.SS3.p4.6.m6.1.2.3.2.1" stretchy="false" xref="S3.SS3.p4.6.m6.1.2.cmml">(</mo><mn id="S3.SS3.p4.6.m6.1.1" xref="S3.SS3.p4.6.m6.1.1.cmml">1</mn><mo id="S3.SS3.p4.6.m6.1.2.3.2.2" stretchy="false" xref="S3.SS3.p4.6.m6.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.6.m6.1b"><apply id="S3.SS3.p4.6.m6.1.2.cmml" xref="S3.SS3.p4.6.m6.1.2"><times id="S3.SS3.p4.6.m6.1.2.1.cmml" xref="S3.SS3.p4.6.m6.1.2.1"></times><ci id="S3.SS3.p4.6.m6.1.2.2.cmml" xref="S3.SS3.p4.6.m6.1.2.2">𝒪</ci><cn id="S3.SS3.p4.6.m6.1.1.cmml" type="integer" xref="S3.SS3.p4.6.m6.1.1">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.6.m6.1c">\mathcal{O}(1)</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p4.6.m6.1d">caligraphic_O ( 1 )</annotation></semantics></math> nonzero entries <math alttext="\hskip 1.99997pt\forall\hskip 1.99997ptv_{i}\in\mathcal{N}" class="ltx_Math" display="inline" id="S3.SS3.p4.7.m7.1"><semantics id="S3.SS3.p4.7.m7.1a"><mrow id="S3.SS3.p4.7.m7.1.1" xref="S3.SS3.p4.7.m7.1.1.cmml"><mrow id="S3.SS3.p4.7.m7.1.1.2" xref="S3.SS3.p4.7.m7.1.1.2.cmml"><mo id="S3.SS3.p4.7.m7.1.1.2.1" rspace="0.367em" xref="S3.SS3.p4.7.m7.1.1.2.1.cmml">∀</mo><msub id="S3.SS3.p4.7.m7.1.1.2.2" xref="S3.SS3.p4.7.m7.1.1.2.2.cmml"><mi id="S3.SS3.p4.7.m7.1.1.2.2.2" xref="S3.SS3.p4.7.m7.1.1.2.2.2.cmml">v</mi><mi id="S3.SS3.p4.7.m7.1.1.2.2.3" xref="S3.SS3.p4.7.m7.1.1.2.2.3.cmml">i</mi></msub></mrow><mo id="S3.SS3.p4.7.m7.1.1.1" xref="S3.SS3.p4.7.m7.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p4.7.m7.1.1.3" xref="S3.SS3.p4.7.m7.1.1.3.cmml">𝒩</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.7.m7.1b"><apply id="S3.SS3.p4.7.m7.1.1.cmml" xref="S3.SS3.p4.7.m7.1.1"><in id="S3.SS3.p4.7.m7.1.1.1.cmml" xref="S3.SS3.p4.7.m7.1.1.1"></in><apply id="S3.SS3.p4.7.m7.1.1.2.cmml" xref="S3.SS3.p4.7.m7.1.1.2"><csymbol cd="latexml" id="S3.SS3.p4.7.m7.1.1.2.1.cmml" xref="S3.SS3.p4.7.m7.1.1.2.1">for-all</csymbol><apply id="S3.SS3.p4.7.m7.1.1.2.2.cmml" xref="S3.SS3.p4.7.m7.1.1.2.2"><csymbol cd="ambiguous" id="S3.SS3.p4.7.m7.1.1.2.2.1.cmml" xref="S3.SS3.p4.7.m7.1.1.2.2">subscript</csymbol><ci id="S3.SS3.p4.7.m7.1.1.2.2.2.cmml" xref="S3.SS3.p4.7.m7.1.1.2.2.2">𝑣</ci><ci id="S3.SS3.p4.7.m7.1.1.2.2.3.cmml" xref="S3.SS3.p4.7.m7.1.1.2.2.3">𝑖</ci></apply></apply><ci id="S3.SS3.p4.7.m7.1.1.3.cmml" xref="S3.SS3.p4.7.m7.1.1.3">𝒩</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.7.m7.1c">\hskip 1.99997pt\forall\hskip 1.99997ptv_{i}\in\mathcal{N}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p4.7.m7.1d">∀ italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∈ caligraphic_N</annotation></semantics></math>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_subsection" id="S3.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.4 </span>Novel theoretical results for GRFs: sharp estimators with sparse features</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S3.SS4.p1">
<p class="ltx_p" id="S3.SS4.p1.7">It is intuitive that GRFs are sparse.
The walk sampler <math alttext="p(\omega)" class="ltx_Math" display="inline" id="S3.SS4.p1.1.m1.1"><semantics id="S3.SS4.p1.1.m1.1a"><mrow id="S3.SS4.p1.1.m1.1.2" xref="S3.SS4.p1.1.m1.1.2.cmml"><mi id="S3.SS4.p1.1.m1.1.2.2" xref="S3.SS4.p1.1.m1.1.2.2.cmml">p</mi><mo id="S3.SS4.p1.1.m1.1.2.1" xref="S3.SS4.p1.1.m1.1.2.1.cmml">⁢</mo><mrow id="S3.SS4.p1.1.m1.1.2.3.2" xref="S3.SS4.p1.1.m1.1.2.cmml"><mo id="S3.SS4.p1.1.m1.1.2.3.2.1" stretchy="false" xref="S3.SS4.p1.1.m1.1.2.cmml">(</mo><mi id="S3.SS4.p1.1.m1.1.1" xref="S3.SS4.p1.1.m1.1.1.cmml">ω</mi><mo id="S3.SS4.p1.1.m1.1.2.3.2.2" stretchy="false" xref="S3.SS4.p1.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.1.m1.1b"><apply id="S3.SS4.p1.1.m1.1.2.cmml" xref="S3.SS4.p1.1.m1.1.2"><times id="S3.SS4.p1.1.m1.1.2.1.cmml" xref="S3.SS4.p1.1.m1.1.2.1"></times><ci id="S3.SS4.p1.1.m1.1.2.2.cmml" xref="S3.SS4.p1.1.m1.1.2.2">𝑝</ci><ci id="S3.SS4.p1.1.m1.1.1.cmml" xref="S3.SS4.p1.1.m1.1.1">𝜔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.1.m1.1c">p(\omega)</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.1.m1.1d">italic_p ( italic_ω )</annotation></semantics></math> is chosen so that walks are short, e.g.&nbsp;taking simple random walks with geometrically distributed lengths.
From Eq.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#S3.E10" title="In 3.3 Faster implicit masking with graph random features ‣ 3 Towards linear topological masking ‣ Linear Transformer Topological Masking with Graph Random Features"><span class="ltx_text ltx_ref_tag">10</span></a>, this means that <math alttext="\widehat{\phi}_{\mathcal{G}}(v_{i})" class="ltx_Math" display="inline" id="S3.SS4.p1.2.m2.1"><semantics id="S3.SS4.p1.2.m2.1a"><mrow id="S3.SS4.p1.2.m2.1.1" xref="S3.SS4.p1.2.m2.1.1.cmml"><msub id="S3.SS4.p1.2.m2.1.1.3" xref="S3.SS4.p1.2.m2.1.1.3.cmml"><mover accent="true" id="S3.SS4.p1.2.m2.1.1.3.2" xref="S3.SS4.p1.2.m2.1.1.3.2.cmml"><mi id="S3.SS4.p1.2.m2.1.1.3.2.2" xref="S3.SS4.p1.2.m2.1.1.3.2.2.cmml">ϕ</mi><mo id="S3.SS4.p1.2.m2.1.1.3.2.1" xref="S3.SS4.p1.2.m2.1.1.3.2.1.cmml">^</mo></mover><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p1.2.m2.1.1.3.3" xref="S3.SS4.p1.2.m2.1.1.3.3.cmml">𝒢</mi></msub><mo id="S3.SS4.p1.2.m2.1.1.2" xref="S3.SS4.p1.2.m2.1.1.2.cmml">⁢</mo><mrow id="S3.SS4.p1.2.m2.1.1.1.1" xref="S3.SS4.p1.2.m2.1.1.1.1.1.cmml"><mo id="S3.SS4.p1.2.m2.1.1.1.1.2" stretchy="false" xref="S3.SS4.p1.2.m2.1.1.1.1.1.cmml">(</mo><msub id="S3.SS4.p1.2.m2.1.1.1.1.1" xref="S3.SS4.p1.2.m2.1.1.1.1.1.cmml"><mi id="S3.SS4.p1.2.m2.1.1.1.1.1.2" xref="S3.SS4.p1.2.m2.1.1.1.1.1.2.cmml">v</mi><mi id="S3.SS4.p1.2.m2.1.1.1.1.1.3" xref="S3.SS4.p1.2.m2.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS4.p1.2.m2.1.1.1.1.3" stretchy="false" xref="S3.SS4.p1.2.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.2.m2.1b"><apply id="S3.SS4.p1.2.m2.1.1.cmml" xref="S3.SS4.p1.2.m2.1.1"><times id="S3.SS4.p1.2.m2.1.1.2.cmml" xref="S3.SS4.p1.2.m2.1.1.2"></times><apply id="S3.SS4.p1.2.m2.1.1.3.cmml" xref="S3.SS4.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.p1.2.m2.1.1.3.1.cmml" xref="S3.SS4.p1.2.m2.1.1.3">subscript</csymbol><apply id="S3.SS4.p1.2.m2.1.1.3.2.cmml" xref="S3.SS4.p1.2.m2.1.1.3.2"><ci id="S3.SS4.p1.2.m2.1.1.3.2.1.cmml" xref="S3.SS4.p1.2.m2.1.1.3.2.1">^</ci><ci id="S3.SS4.p1.2.m2.1.1.3.2.2.cmml" xref="S3.SS4.p1.2.m2.1.1.3.2.2">italic-ϕ</ci></apply><ci id="S3.SS4.p1.2.m2.1.1.3.3.cmml" xref="S3.SS4.p1.2.m2.1.1.3.3">𝒢</ci></apply><apply id="S3.SS4.p1.2.m2.1.1.1.1.1.cmml" xref="S3.SS4.p1.2.m2.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.2.m2.1.1.1.1.1.1.cmml" xref="S3.SS4.p1.2.m2.1.1.1.1">subscript</csymbol><ci id="S3.SS4.p1.2.m2.1.1.1.1.1.2.cmml" xref="S3.SS4.p1.2.m2.1.1.1.1.1.2">𝑣</ci><ci id="S3.SS4.p1.2.m2.1.1.1.1.1.3.cmml" xref="S3.SS4.p1.2.m2.1.1.1.1.1.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.2.m2.1c">\widehat{\phi}_{\mathcal{G}}(v_{i})</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.2.m2.1d">over^ start_ARG italic_ϕ end_ARG start_POSTSUBSCRIPT caligraphic_G end_POSTSUBSCRIPT ( italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT )</annotation></semantics></math> is only nonzero at nodes ‘close’ to <math alttext="v_{i}" class="ltx_Math" display="inline" id="S3.SS4.p1.3.m3.1"><semantics id="S3.SS4.p1.3.m3.1a"><msub id="S3.SS4.p1.3.m3.1.1" xref="S3.SS4.p1.3.m3.1.1.cmml"><mi id="S3.SS4.p1.3.m3.1.1.2" xref="S3.SS4.p1.3.m3.1.1.2.cmml">v</mi><mi id="S3.SS4.p1.3.m3.1.1.3" xref="S3.SS4.p1.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.3.m3.1b"><apply id="S3.SS4.p1.3.m3.1.1.cmml" xref="S3.SS4.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.3.m3.1.1.1.cmml" xref="S3.SS4.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS4.p1.3.m3.1.1.2.cmml" xref="S3.SS4.p1.3.m3.1.1.2">𝑣</ci><ci id="S3.SS4.p1.3.m3.1.1.3.cmml" xref="S3.SS4.p1.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.3.m3.1c">v_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.3.m3.1d">italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>. Most of its entries are <math alttext="0" class="ltx_Math" display="inline" id="S3.SS4.p1.4.m4.1"><semantics id="S3.SS4.p1.4.m4.1a"><mn id="S3.SS4.p1.4.m4.1.1" xref="S3.SS4.p1.4.m4.1.1.cmml">0</mn><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.4.m4.1b"><cn id="S3.SS4.p1.4.m4.1.1.cmml" type="integer" xref="S3.SS4.p1.4.m4.1.1">0</cn></annotation-xml></semantics></math>.
However, to prove that <math alttext="\widehat{\mathbf{\Phi}}_{\{\mathbf{Q},\mathbf{K}\}\mathcal{G}}" class="ltx_Math" display="inline" id="S3.SS4.p1.5.m5.2"><semantics id="S3.SS4.p1.5.m5.2a"><msub id="S3.SS4.p1.5.m5.2.3" xref="S3.SS4.p1.5.m5.2.3.cmml"><mover accent="true" id="S3.SS4.p1.5.m5.2.3.2" xref="S3.SS4.p1.5.m5.2.3.2.cmml"><mi id="S3.SS4.p1.5.m5.2.3.2.2" xref="S3.SS4.p1.5.m5.2.3.2.2.cmml">𝚽</mi><mo id="S3.SS4.p1.5.m5.2.3.2.1" xref="S3.SS4.p1.5.m5.2.3.2.1.cmml">^</mo></mover><mrow id="S3.SS4.p1.5.m5.2.2.2" xref="S3.SS4.p1.5.m5.2.2.2.cmml"><mrow id="S3.SS4.p1.5.m5.2.2.2.4.2" xref="S3.SS4.p1.5.m5.2.2.2.4.1.cmml"><mo id="S3.SS4.p1.5.m5.2.2.2.4.2.1" stretchy="false" xref="S3.SS4.p1.5.m5.2.2.2.4.1.cmml">{</mo><mi id="S3.SS4.p1.5.m5.1.1.1.1" xref="S3.SS4.p1.5.m5.1.1.1.1.cmml">𝐐</mi><mo id="S3.SS4.p1.5.m5.2.2.2.4.2.2" xref="S3.SS4.p1.5.m5.2.2.2.4.1.cmml">,</mo><mi id="S3.SS4.p1.5.m5.2.2.2.2" xref="S3.SS4.p1.5.m5.2.2.2.2.cmml">𝐊</mi><mo id="S3.SS4.p1.5.m5.2.2.2.4.2.3" stretchy="false" xref="S3.SS4.p1.5.m5.2.2.2.4.1.cmml">}</mo></mrow><mo id="S3.SS4.p1.5.m5.2.2.2.3" xref="S3.SS4.p1.5.m5.2.2.2.3.cmml">⁢</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p1.5.m5.2.2.2.5" xref="S3.SS4.p1.5.m5.2.2.2.5.cmml">𝒢</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.5.m5.2b"><apply id="S3.SS4.p1.5.m5.2.3.cmml" xref="S3.SS4.p1.5.m5.2.3"><csymbol cd="ambiguous" id="S3.SS4.p1.5.m5.2.3.1.cmml" xref="S3.SS4.p1.5.m5.2.3">subscript</csymbol><apply id="S3.SS4.p1.5.m5.2.3.2.cmml" xref="S3.SS4.p1.5.m5.2.3.2"><ci id="S3.SS4.p1.5.m5.2.3.2.1.cmml" xref="S3.SS4.p1.5.m5.2.3.2.1">^</ci><ci id="S3.SS4.p1.5.m5.2.3.2.2.cmml" xref="S3.SS4.p1.5.m5.2.3.2.2">𝚽</ci></apply><apply id="S3.SS4.p1.5.m5.2.2.2.cmml" xref="S3.SS4.p1.5.m5.2.2.2"><times id="S3.SS4.p1.5.m5.2.2.2.3.cmml" xref="S3.SS4.p1.5.m5.2.2.2.3"></times><set id="S3.SS4.p1.5.m5.2.2.2.4.1.cmml" xref="S3.SS4.p1.5.m5.2.2.2.4.2"><ci id="S3.SS4.p1.5.m5.1.1.1.1.cmml" xref="S3.SS4.p1.5.m5.1.1.1.1">𝐐</ci><ci id="S3.SS4.p1.5.m5.2.2.2.2.cmml" xref="S3.SS4.p1.5.m5.2.2.2.2">𝐊</ci></set><ci id="S3.SS4.p1.5.m5.2.2.2.5.cmml" xref="S3.SS4.p1.5.m5.2.2.2.5">𝒢</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.5.m5.2c">\widehat{\mathbf{\Phi}}_{\{\mathbf{Q},\mathbf{K}\}\mathcal{G}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.5.m5.2d">over^ start_ARG bold_Φ end_ARG start_POSTSUBSCRIPT { bold_Q , bold_K } caligraphic_G end_POSTSUBSCRIPT</annotation></semantics></math> supports <math alttext="\mathcal{O}(N)" class="ltx_Math" display="inline" id="S3.SS4.p1.6.m6.1"><semantics id="S3.SS4.p1.6.m6.1a"><mrow id="S3.SS4.p1.6.m6.1.2" xref="S3.SS4.p1.6.m6.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p1.6.m6.1.2.2" xref="S3.SS4.p1.6.m6.1.2.2.cmml">𝒪</mi><mo id="S3.SS4.p1.6.m6.1.2.1" xref="S3.SS4.p1.6.m6.1.2.1.cmml">⁢</mo><mrow id="S3.SS4.p1.6.m6.1.2.3.2" xref="S3.SS4.p1.6.m6.1.2.cmml"><mo id="S3.SS4.p1.6.m6.1.2.3.2.1" stretchy="false" xref="S3.SS4.p1.6.m6.1.2.cmml">(</mo><mi id="S3.SS4.p1.6.m6.1.1" xref="S3.SS4.p1.6.m6.1.1.cmml">N</mi><mo id="S3.SS4.p1.6.m6.1.2.3.2.2" stretchy="false" xref="S3.SS4.p1.6.m6.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.6.m6.1b"><apply id="S3.SS4.p1.6.m6.1.2.cmml" xref="S3.SS4.p1.6.m6.1.2"><times id="S3.SS4.p1.6.m6.1.2.1.cmml" xref="S3.SS4.p1.6.m6.1.2.1"></times><ci id="S3.SS4.p1.6.m6.1.2.2.cmml" xref="S3.SS4.p1.6.m6.1.2.2">𝒪</ci><ci id="S3.SS4.p1.6.m6.1.1.cmml" xref="S3.SS4.p1.6.m6.1.1">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.6.m6.1c">\mathcal{O}(N)</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.6.m6.1d">caligraphic_O ( italic_N )</annotation></semantics></math> matrix-vector multiplication we need to rigorously relate this to the quality of approximation of <math alttext="\mathbf{M}_{\alpha}(\mathcal{G})" class="ltx_Math" display="inline" id="S3.SS4.p1.7.m7.1"><semantics id="S3.SS4.p1.7.m7.1a"><mrow id="S3.SS4.p1.7.m7.1.2" xref="S3.SS4.p1.7.m7.1.2.cmml"><msub id="S3.SS4.p1.7.m7.1.2.2" xref="S3.SS4.p1.7.m7.1.2.2.cmml"><mi id="S3.SS4.p1.7.m7.1.2.2.2" xref="S3.SS4.p1.7.m7.1.2.2.2.cmml">𝐌</mi><mi id="S3.SS4.p1.7.m7.1.2.2.3" xref="S3.SS4.p1.7.m7.1.2.2.3.cmml">α</mi></msub><mo id="S3.SS4.p1.7.m7.1.2.1" xref="S3.SS4.p1.7.m7.1.2.1.cmml">⁢</mo><mrow id="S3.SS4.p1.7.m7.1.2.3.2" xref="S3.SS4.p1.7.m7.1.2.cmml"><mo id="S3.SS4.p1.7.m7.1.2.3.2.1" stretchy="false" xref="S3.SS4.p1.7.m7.1.2.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p1.7.m7.1.1" xref="S3.SS4.p1.7.m7.1.1.cmml">𝒢</mi><mo id="S3.SS4.p1.7.m7.1.2.3.2.2" stretchy="false" xref="S3.SS4.p1.7.m7.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.7.m7.1b"><apply id="S3.SS4.p1.7.m7.1.2.cmml" xref="S3.SS4.p1.7.m7.1.2"><times id="S3.SS4.p1.7.m7.1.2.1.cmml" xref="S3.SS4.p1.7.m7.1.2.1"></times><apply id="S3.SS4.p1.7.m7.1.2.2.cmml" xref="S3.SS4.p1.7.m7.1.2.2"><csymbol cd="ambiguous" id="S3.SS4.p1.7.m7.1.2.2.1.cmml" xref="S3.SS4.p1.7.m7.1.2.2">subscript</csymbol><ci id="S3.SS4.p1.7.m7.1.2.2.2.cmml" xref="S3.SS4.p1.7.m7.1.2.2.2">𝐌</ci><ci id="S3.SS4.p1.7.m7.1.2.2.3.cmml" xref="S3.SS4.p1.7.m7.1.2.2.3">𝛼</ci></apply><ci id="S3.SS4.p1.7.m7.1.1.cmml" xref="S3.SS4.p1.7.m7.1.1">𝒢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.7.m7.1c">\mathbf{M}_{\alpha}(\mathcal{G})</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.7.m7.1d">bold_M start_POSTSUBSCRIPT italic_α end_POSTSUBSCRIPT ( caligraphic_G )</annotation></semantics></math>.
This requires concentration inequalities for GRFs, but no such bounds were previously known. The following result is novel.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_theorem ltx_theorem_theorem" id="S3.Thmtheorem1">
<h6 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span class="ltx_text ltx_font_bold" id="S3.Thmtheorem1.1.1.1">Theorem 3.1</span></span><span class="ltx_text ltx_font_bold" id="S3.Thmtheorem1.2.2"> </span>(GRF exponential concentration bounds)<span class="ltx_text ltx_font_bold" id="S3.Thmtheorem1.3.3">.</span>
</h6><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S3.Thmtheorem1.p1">
<p class="ltx_p" id="S3.Thmtheorem1.p1.14"><span class="ltx_text ltx_font_italic" id="S3.Thmtheorem1.p1.14.14">Consider a graph <math alttext="\mathcal{G}" class="ltx_Math" display="inline" id="S3.Thmtheorem1.p1.1.1.m1.1"><semantics id="S3.Thmtheorem1.p1.1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.Thmtheorem1.p1.1.1.m1.1.1" xref="S3.Thmtheorem1.p1.1.1.m1.1.1.cmml">𝒢</mi><annotation-xml encoding="MathML-Content" id="S3.Thmtheorem1.p1.1.1.m1.1b"><ci id="S3.Thmtheorem1.p1.1.1.m1.1.1.cmml" xref="S3.Thmtheorem1.p1.1.1.m1.1.1">𝒢</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmtheorem1.p1.1.1.m1.1c">\mathcal{G}</annotation><annotation encoding="application/x-llamapun" id="S3.Thmtheorem1.p1.1.1.m1.1d">caligraphic_G</annotation></semantics></math> with adjacency matrix <math alttext="\mathbf{W}" class="ltx_Math" display="inline" id="S3.Thmtheorem1.p1.2.2.m2.1"><semantics id="S3.Thmtheorem1.p1.2.2.m2.1a"><mi id="S3.Thmtheorem1.p1.2.2.m2.1.1" xref="S3.Thmtheorem1.p1.2.2.m2.1.1.cmml">𝐖</mi><annotation-xml encoding="MathML-Content" id="S3.Thmtheorem1.p1.2.2.m2.1b"><ci id="S3.Thmtheorem1.p1.2.2.m2.1.1.cmml" xref="S3.Thmtheorem1.p1.2.2.m2.1.1">𝐖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmtheorem1.p1.2.2.m2.1c">\mathbf{W}</annotation><annotation encoding="application/x-llamapun" id="S3.Thmtheorem1.p1.2.2.m2.1d">bold_W</annotation></semantics></math> and node degrees <math alttext="\{d_{i}\}_{v_{i}\in\mathcal{N}}" class="ltx_Math" display="inline" id="S3.Thmtheorem1.p1.3.3.m3.1"><semantics id="S3.Thmtheorem1.p1.3.3.m3.1a"><msub id="S3.Thmtheorem1.p1.3.3.m3.1.1" xref="S3.Thmtheorem1.p1.3.3.m3.1.1.cmml"><mrow id="S3.Thmtheorem1.p1.3.3.m3.1.1.1.1" xref="S3.Thmtheorem1.p1.3.3.m3.1.1.1.2.cmml"><mo id="S3.Thmtheorem1.p1.3.3.m3.1.1.1.1.2" stretchy="false" xref="S3.Thmtheorem1.p1.3.3.m3.1.1.1.2.cmml">{</mo><msub id="S3.Thmtheorem1.p1.3.3.m3.1.1.1.1.1" xref="S3.Thmtheorem1.p1.3.3.m3.1.1.1.1.1.cmml"><mi id="S3.Thmtheorem1.p1.3.3.m3.1.1.1.1.1.2" xref="S3.Thmtheorem1.p1.3.3.m3.1.1.1.1.1.2.cmml">d</mi><mi id="S3.Thmtheorem1.p1.3.3.m3.1.1.1.1.1.3" xref="S3.Thmtheorem1.p1.3.3.m3.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.Thmtheorem1.p1.3.3.m3.1.1.1.1.3" stretchy="false" xref="S3.Thmtheorem1.p1.3.3.m3.1.1.1.2.cmml">}</mo></mrow><mrow id="S3.Thmtheorem1.p1.3.3.m3.1.1.3" xref="S3.Thmtheorem1.p1.3.3.m3.1.1.3.cmml"><msub id="S3.Thmtheorem1.p1.3.3.m3.1.1.3.2" xref="S3.Thmtheorem1.p1.3.3.m3.1.1.3.2.cmml"><mi id="S3.Thmtheorem1.p1.3.3.m3.1.1.3.2.2" xref="S3.Thmtheorem1.p1.3.3.m3.1.1.3.2.2.cmml">v</mi><mi id="S3.Thmtheorem1.p1.3.3.m3.1.1.3.2.3" xref="S3.Thmtheorem1.p1.3.3.m3.1.1.3.2.3.cmml">i</mi></msub><mo id="S3.Thmtheorem1.p1.3.3.m3.1.1.3.1" xref="S3.Thmtheorem1.p1.3.3.m3.1.1.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.Thmtheorem1.p1.3.3.m3.1.1.3.3" xref="S3.Thmtheorem1.p1.3.3.m3.1.1.3.3.cmml">𝒩</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.Thmtheorem1.p1.3.3.m3.1b"><apply id="S3.Thmtheorem1.p1.3.3.m3.1.1.cmml" xref="S3.Thmtheorem1.p1.3.3.m3.1.1"><csymbol cd="ambiguous" id="S3.Thmtheorem1.p1.3.3.m3.1.1.2.cmml" xref="S3.Thmtheorem1.p1.3.3.m3.1.1">subscript</csymbol><set id="S3.Thmtheorem1.p1.3.3.m3.1.1.1.2.cmml" xref="S3.Thmtheorem1.p1.3.3.m3.1.1.1.1"><apply id="S3.Thmtheorem1.p1.3.3.m3.1.1.1.1.1.cmml" xref="S3.Thmtheorem1.p1.3.3.m3.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Thmtheorem1.p1.3.3.m3.1.1.1.1.1.1.cmml" xref="S3.Thmtheorem1.p1.3.3.m3.1.1.1.1.1">subscript</csymbol><ci id="S3.Thmtheorem1.p1.3.3.m3.1.1.1.1.1.2.cmml" xref="S3.Thmtheorem1.p1.3.3.m3.1.1.1.1.1.2">𝑑</ci><ci id="S3.Thmtheorem1.p1.3.3.m3.1.1.1.1.1.3.cmml" xref="S3.Thmtheorem1.p1.3.3.m3.1.1.1.1.1.3">𝑖</ci></apply></set><apply id="S3.Thmtheorem1.p1.3.3.m3.1.1.3.cmml" xref="S3.Thmtheorem1.p1.3.3.m3.1.1.3"><in id="S3.Thmtheorem1.p1.3.3.m3.1.1.3.1.cmml" xref="S3.Thmtheorem1.p1.3.3.m3.1.1.3.1"></in><apply id="S3.Thmtheorem1.p1.3.3.m3.1.1.3.2.cmml" xref="S3.Thmtheorem1.p1.3.3.m3.1.1.3.2"><csymbol cd="ambiguous" id="S3.Thmtheorem1.p1.3.3.m3.1.1.3.2.1.cmml" xref="S3.Thmtheorem1.p1.3.3.m3.1.1.3.2">subscript</csymbol><ci id="S3.Thmtheorem1.p1.3.3.m3.1.1.3.2.2.cmml" xref="S3.Thmtheorem1.p1.3.3.m3.1.1.3.2.2">𝑣</ci><ci id="S3.Thmtheorem1.p1.3.3.m3.1.1.3.2.3.cmml" xref="S3.Thmtheorem1.p1.3.3.m3.1.1.3.2.3">𝑖</ci></apply><ci id="S3.Thmtheorem1.p1.3.3.m3.1.1.3.3.cmml" xref="S3.Thmtheorem1.p1.3.3.m3.1.1.3.3">𝒩</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmtheorem1.p1.3.3.m3.1c">\{d_{i}\}_{v_{i}\in\mathcal{N}}</annotation><annotation encoding="application/x-llamapun" id="S3.Thmtheorem1.p1.3.3.m3.1d">{ italic_d start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT } start_POSTSUBSCRIPT italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∈ caligraphic_N end_POSTSUBSCRIPT</annotation></semantics></math>.
Suppose we construct GRFs <math alttext="\{\widehat{\phi}_{\mathcal{G}}(v_{i})\}_{v_{i}\in\mathcal{G}}" class="ltx_Math" display="inline" id="S3.Thmtheorem1.p1.4.4.m4.1"><semantics id="S3.Thmtheorem1.p1.4.4.m4.1a"><msub id="S3.Thmtheorem1.p1.4.4.m4.1.1" xref="S3.Thmtheorem1.p1.4.4.m4.1.1.cmml"><mrow id="S3.Thmtheorem1.p1.4.4.m4.1.1.1.1" xref="S3.Thmtheorem1.p1.4.4.m4.1.1.1.2.cmml"><mo id="S3.Thmtheorem1.p1.4.4.m4.1.1.1.1.2" stretchy="false" xref="S3.Thmtheorem1.p1.4.4.m4.1.1.1.2.cmml">{</mo><mrow id="S3.Thmtheorem1.p1.4.4.m4.1.1.1.1.1" xref="S3.Thmtheorem1.p1.4.4.m4.1.1.1.1.1.cmml"><msub id="S3.Thmtheorem1.p1.4.4.m4.1.1.1.1.1.3" xref="S3.Thmtheorem1.p1.4.4.m4.1.1.1.1.1.3.cmml"><mover accent="true" id="S3.Thmtheorem1.p1.4.4.m4.1.1.1.1.1.3.2" xref="S3.Thmtheorem1.p1.4.4.m4.1.1.1.1.1.3.2.cmml"><mi id="S3.Thmtheorem1.p1.4.4.m4.1.1.1.1.1.3.2.2" xref="S3.Thmtheorem1.p1.4.4.m4.1.1.1.1.1.3.2.2.cmml">ϕ</mi><mo id="S3.Thmtheorem1.p1.4.4.m4.1.1.1.1.1.3.2.1" xref="S3.Thmtheorem1.p1.4.4.m4.1.1.1.1.1.3.2.1.cmml">^</mo></mover><mi class="ltx_font_mathcaligraphic" id="S3.Thmtheorem1.p1.4.4.m4.1.1.1.1.1.3.3" xref="S3.Thmtheorem1.p1.4.4.m4.1.1.1.1.1.3.3.cmml">𝒢</mi></msub><mo id="S3.Thmtheorem1.p1.4.4.m4.1.1.1.1.1.2" xref="S3.Thmtheorem1.p1.4.4.m4.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.Thmtheorem1.p1.4.4.m4.1.1.1.1.1.1.1" xref="S3.Thmtheorem1.p1.4.4.m4.1.1.1.1.1.1.1.1.cmml"><mo id="S3.Thmtheorem1.p1.4.4.m4.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.Thmtheorem1.p1.4.4.m4.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.Thmtheorem1.p1.4.4.m4.1.1.1.1.1.1.1.1" xref="S3.Thmtheorem1.p1.4.4.m4.1.1.1.1.1.1.1.1.cmml"><mi id="S3.Thmtheorem1.p1.4.4.m4.1.1.1.1.1.1.1.1.2" xref="S3.Thmtheorem1.p1.4.4.m4.1.1.1.1.1.1.1.1.2.cmml">v</mi><mi id="S3.Thmtheorem1.p1.4.4.m4.1.1.1.1.1.1.1.1.3" xref="S3.Thmtheorem1.p1.4.4.m4.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.Thmtheorem1.p1.4.4.m4.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.Thmtheorem1.p1.4.4.m4.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.Thmtheorem1.p1.4.4.m4.1.1.1.1.3" stretchy="false" xref="S3.Thmtheorem1.p1.4.4.m4.1.1.1.2.cmml">}</mo></mrow><mrow id="S3.Thmtheorem1.p1.4.4.m4.1.1.3" xref="S3.Thmtheorem1.p1.4.4.m4.1.1.3.cmml"><msub id="S3.Thmtheorem1.p1.4.4.m4.1.1.3.2" xref="S3.Thmtheorem1.p1.4.4.m4.1.1.3.2.cmml"><mi id="S3.Thmtheorem1.p1.4.4.m4.1.1.3.2.2" xref="S3.Thmtheorem1.p1.4.4.m4.1.1.3.2.2.cmml">v</mi><mi id="S3.Thmtheorem1.p1.4.4.m4.1.1.3.2.3" xref="S3.Thmtheorem1.p1.4.4.m4.1.1.3.2.3.cmml">i</mi></msub><mo id="S3.Thmtheorem1.p1.4.4.m4.1.1.3.1" xref="S3.Thmtheorem1.p1.4.4.m4.1.1.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.Thmtheorem1.p1.4.4.m4.1.1.3.3" xref="S3.Thmtheorem1.p1.4.4.m4.1.1.3.3.cmml">𝒢</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.Thmtheorem1.p1.4.4.m4.1b"><apply id="S3.Thmtheorem1.p1.4.4.m4.1.1.cmml" xref="S3.Thmtheorem1.p1.4.4.m4.1.1"><csymbol cd="ambiguous" id="S3.Thmtheorem1.p1.4.4.m4.1.1.2.cmml" xref="S3.Thmtheorem1.p1.4.4.m4.1.1">subscript</csymbol><set id="S3.Thmtheorem1.p1.4.4.m4.1.1.1.2.cmml" xref="S3.Thmtheorem1.p1.4.4.m4.1.1.1.1"><apply id="S3.Thmtheorem1.p1.4.4.m4.1.1.1.1.1.cmml" xref="S3.Thmtheorem1.p1.4.4.m4.1.1.1.1.1"><times id="S3.Thmtheorem1.p1.4.4.m4.1.1.1.1.1.2.cmml" xref="S3.Thmtheorem1.p1.4.4.m4.1.1.1.1.1.2"></times><apply id="S3.Thmtheorem1.p1.4.4.m4.1.1.1.1.1.3.cmml" xref="S3.Thmtheorem1.p1.4.4.m4.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.Thmtheorem1.p1.4.4.m4.1.1.1.1.1.3.1.cmml" xref="S3.Thmtheorem1.p1.4.4.m4.1.1.1.1.1.3">subscript</csymbol><apply id="S3.Thmtheorem1.p1.4.4.m4.1.1.1.1.1.3.2.cmml" xref="S3.Thmtheorem1.p1.4.4.m4.1.1.1.1.1.3.2"><ci id="S3.Thmtheorem1.p1.4.4.m4.1.1.1.1.1.3.2.1.cmml" xref="S3.Thmtheorem1.p1.4.4.m4.1.1.1.1.1.3.2.1">^</ci><ci id="S3.Thmtheorem1.p1.4.4.m4.1.1.1.1.1.3.2.2.cmml" xref="S3.Thmtheorem1.p1.4.4.m4.1.1.1.1.1.3.2.2">italic-ϕ</ci></apply><ci id="S3.Thmtheorem1.p1.4.4.m4.1.1.1.1.1.3.3.cmml" xref="S3.Thmtheorem1.p1.4.4.m4.1.1.1.1.1.3.3">𝒢</ci></apply><apply id="S3.Thmtheorem1.p1.4.4.m4.1.1.1.1.1.1.1.1.cmml" xref="S3.Thmtheorem1.p1.4.4.m4.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Thmtheorem1.p1.4.4.m4.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Thmtheorem1.p1.4.4.m4.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.Thmtheorem1.p1.4.4.m4.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Thmtheorem1.p1.4.4.m4.1.1.1.1.1.1.1.1.2">𝑣</ci><ci id="S3.Thmtheorem1.p1.4.4.m4.1.1.1.1.1.1.1.1.3.cmml" xref="S3.Thmtheorem1.p1.4.4.m4.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply></set><apply id="S3.Thmtheorem1.p1.4.4.m4.1.1.3.cmml" xref="S3.Thmtheorem1.p1.4.4.m4.1.1.3"><in id="S3.Thmtheorem1.p1.4.4.m4.1.1.3.1.cmml" xref="S3.Thmtheorem1.p1.4.4.m4.1.1.3.1"></in><apply id="S3.Thmtheorem1.p1.4.4.m4.1.1.3.2.cmml" xref="S3.Thmtheorem1.p1.4.4.m4.1.1.3.2"><csymbol cd="ambiguous" id="S3.Thmtheorem1.p1.4.4.m4.1.1.3.2.1.cmml" xref="S3.Thmtheorem1.p1.4.4.m4.1.1.3.2">subscript</csymbol><ci id="S3.Thmtheorem1.p1.4.4.m4.1.1.3.2.2.cmml" xref="S3.Thmtheorem1.p1.4.4.m4.1.1.3.2.2">𝑣</ci><ci id="S3.Thmtheorem1.p1.4.4.m4.1.1.3.2.3.cmml" xref="S3.Thmtheorem1.p1.4.4.m4.1.1.3.2.3">𝑖</ci></apply><ci id="S3.Thmtheorem1.p1.4.4.m4.1.1.3.3.cmml" xref="S3.Thmtheorem1.p1.4.4.m4.1.1.3.3">𝒢</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmtheorem1.p1.4.4.m4.1c">\{\widehat{\phi}_{\mathcal{G}}(v_{i})\}_{v_{i}\in\mathcal{G}}</annotation><annotation encoding="application/x-llamapun" id="S3.Thmtheorem1.p1.4.4.m4.1d">{ over^ start_ARG italic_ϕ end_ARG start_POSTSUBSCRIPT caligraphic_G end_POSTSUBSCRIPT ( italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) } start_POSTSUBSCRIPT italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∈ caligraphic_G end_POSTSUBSCRIPT</annotation></semantics></math> by sampling <math alttext="n" class="ltx_Math" display="inline" id="S3.Thmtheorem1.p1.5.5.m5.1"><semantics id="S3.Thmtheorem1.p1.5.5.m5.1a"><mi id="S3.Thmtheorem1.p1.5.5.m5.1.1" xref="S3.Thmtheorem1.p1.5.5.m5.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S3.Thmtheorem1.p1.5.5.m5.1b"><ci id="S3.Thmtheorem1.p1.5.5.m5.1.1.cmml" xref="S3.Thmtheorem1.p1.5.5.m5.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmtheorem1.p1.5.5.m5.1c">n</annotation><annotation encoding="application/x-llamapun" id="S3.Thmtheorem1.p1.5.5.m5.1d">italic_n</annotation></semantics></math> random walks <math alttext="\{\omega_{k}^{(i)}\}_{v_{i}\in\mathcal{N},\hskip 1.39998ptk\in[\![1,n]\!]}" class="ltx_Math" display="inline" id="S3.Thmtheorem1.p1.6.6.m6.6"><semantics id="S3.Thmtheorem1.p1.6.6.m6.6a"><msub id="S3.Thmtheorem1.p1.6.6.m6.6.6" xref="S3.Thmtheorem1.p1.6.6.m6.6.6.cmml"><mrow id="S3.Thmtheorem1.p1.6.6.m6.6.6.1.1" xref="S3.Thmtheorem1.p1.6.6.m6.6.6.1.2.cmml"><mo id="S3.Thmtheorem1.p1.6.6.m6.6.6.1.1.2" stretchy="false" xref="S3.Thmtheorem1.p1.6.6.m6.6.6.1.2.cmml">{</mo><msubsup id="S3.Thmtheorem1.p1.6.6.m6.6.6.1.1.1" xref="S3.Thmtheorem1.p1.6.6.m6.6.6.1.1.1.cmml"><mi id="S3.Thmtheorem1.p1.6.6.m6.6.6.1.1.1.2.2" xref="S3.Thmtheorem1.p1.6.6.m6.6.6.1.1.1.2.2.cmml">ω</mi><mi id="S3.Thmtheorem1.p1.6.6.m6.6.6.1.1.1.2.3" xref="S3.Thmtheorem1.p1.6.6.m6.6.6.1.1.1.2.3.cmml">k</mi><mrow id="S3.Thmtheorem1.p1.6.6.m6.1.1.1.3" xref="S3.Thmtheorem1.p1.6.6.m6.6.6.1.1.1.cmml"><mo id="S3.Thmtheorem1.p1.6.6.m6.1.1.1.3.1" stretchy="false" xref="S3.Thmtheorem1.p1.6.6.m6.6.6.1.1.1.cmml">(</mo><mi id="S3.Thmtheorem1.p1.6.6.m6.1.1.1.1" xref="S3.Thmtheorem1.p1.6.6.m6.1.1.1.1.cmml">i</mi><mo id="S3.Thmtheorem1.p1.6.6.m6.1.1.1.3.2" stretchy="false" xref="S3.Thmtheorem1.p1.6.6.m6.6.6.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S3.Thmtheorem1.p1.6.6.m6.6.6.1.1.3" stretchy="false" xref="S3.Thmtheorem1.p1.6.6.m6.6.6.1.2.cmml">}</mo></mrow><mrow id="S3.Thmtheorem1.p1.6.6.m6.5.5.4.4" xref="S3.Thmtheorem1.p1.6.6.m6.5.5.4.5.cmml"><mrow id="S3.Thmtheorem1.p1.6.6.m6.4.4.3.3.1" xref="S3.Thmtheorem1.p1.6.6.m6.4.4.3.3.1.cmml"><msub id="S3.Thmtheorem1.p1.6.6.m6.4.4.3.3.1.2" xref="S3.Thmtheorem1.p1.6.6.m6.4.4.3.3.1.2.cmml"><mi id="S3.Thmtheorem1.p1.6.6.m6.4.4.3.3.1.2.2" xref="S3.Thmtheorem1.p1.6.6.m6.4.4.3.3.1.2.2.cmml">v</mi><mi id="S3.Thmtheorem1.p1.6.6.m6.4.4.3.3.1.2.3" xref="S3.Thmtheorem1.p1.6.6.m6.4.4.3.3.1.2.3.cmml">i</mi></msub><mo id="S3.Thmtheorem1.p1.6.6.m6.4.4.3.3.1.1" xref="S3.Thmtheorem1.p1.6.6.m6.4.4.3.3.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.Thmtheorem1.p1.6.6.m6.4.4.3.3.1.3" xref="S3.Thmtheorem1.p1.6.6.m6.4.4.3.3.1.3.cmml">𝒩</mi></mrow><mo id="S3.Thmtheorem1.p1.6.6.m6.5.5.4.4.3" rspace="0.307em" xref="S3.Thmtheorem1.p1.6.6.m6.5.5.4.5a.cmml">,</mo><mrow id="S3.Thmtheorem1.p1.6.6.m6.5.5.4.4.2" xref="S3.Thmtheorem1.p1.6.6.m6.5.5.4.4.2.cmml"><mi id="S3.Thmtheorem1.p1.6.6.m6.5.5.4.4.2.3" xref="S3.Thmtheorem1.p1.6.6.m6.5.5.4.4.2.3.cmml">k</mi><mo id="S3.Thmtheorem1.p1.6.6.m6.5.5.4.4.2.2" xref="S3.Thmtheorem1.p1.6.6.m6.5.5.4.4.2.2.cmml">∈</mo><mrow id="S3.Thmtheorem1.p1.6.6.m6.5.5.4.4.2.1.1" xref="S3.Thmtheorem1.p1.6.6.m6.5.5.4.4.2.1.2.cmml"><mpadded width="0.247em"><mo id="S3.Thmtheorem1.p1.6.6.m6.5.5.4.4.2.1.1.2" stretchy="false" xref="S3.Thmtheorem1.p1.6.6.m6.5.5.4.4.2.1.2.1.cmml">[</mo></mpadded><mrow id="S3.Thmtheorem1.p1.6.6.m6.5.5.4.4.2.1.1.1.2" xref="S3.Thmtheorem1.p1.6.6.m6.5.5.4.4.2.1.1.1.1.cmml"><mo id="S3.Thmtheorem1.p1.6.6.m6.5.5.4.4.2.1.1.1.2.1" stretchy="false" xref="S3.Thmtheorem1.p1.6.6.m6.5.5.4.4.2.1.1.1.1.cmml">[</mo><mn id="S3.Thmtheorem1.p1.6.6.m6.2.2.1.1" xref="S3.Thmtheorem1.p1.6.6.m6.2.2.1.1.cmml">1</mn><mo id="S3.Thmtheorem1.p1.6.6.m6.5.5.4.4.2.1.1.1.2.2" xref="S3.Thmtheorem1.p1.6.6.m6.5.5.4.4.2.1.1.1.1.cmml">,</mo><mi id="S3.Thmtheorem1.p1.6.6.m6.3.3.2.2" xref="S3.Thmtheorem1.p1.6.6.m6.3.3.2.2.cmml">n</mi><mpadded width="0.247em"><mo id="S3.Thmtheorem1.p1.6.6.m6.5.5.4.4.2.1.1.1.2.3" stretchy="false" xref="S3.Thmtheorem1.p1.6.6.m6.5.5.4.4.2.1.1.1.1.cmml">]</mo></mpadded></mrow><mo id="S3.Thmtheorem1.p1.6.6.m6.5.5.4.4.2.1.1.3" stretchy="false" xref="S3.Thmtheorem1.p1.6.6.m6.5.5.4.4.2.1.2.1.cmml">]</mo></mrow></mrow></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.Thmtheorem1.p1.6.6.m6.6b"><apply id="S3.Thmtheorem1.p1.6.6.m6.6.6.cmml" xref="S3.Thmtheorem1.p1.6.6.m6.6.6"><csymbol cd="ambiguous" id="S3.Thmtheorem1.p1.6.6.m6.6.6.2.cmml" xref="S3.Thmtheorem1.p1.6.6.m6.6.6">subscript</csymbol><set id="S3.Thmtheorem1.p1.6.6.m6.6.6.1.2.cmml" xref="S3.Thmtheorem1.p1.6.6.m6.6.6.1.1"><apply id="S3.Thmtheorem1.p1.6.6.m6.6.6.1.1.1.cmml" xref="S3.Thmtheorem1.p1.6.6.m6.6.6.1.1.1"><csymbol cd="ambiguous" id="S3.Thmtheorem1.p1.6.6.m6.6.6.1.1.1.1.cmml" xref="S3.Thmtheorem1.p1.6.6.m6.6.6.1.1.1">superscript</csymbol><apply id="S3.Thmtheorem1.p1.6.6.m6.6.6.1.1.1.2.cmml" xref="S3.Thmtheorem1.p1.6.6.m6.6.6.1.1.1"><csymbol cd="ambiguous" id="S3.Thmtheorem1.p1.6.6.m6.6.6.1.1.1.2.1.cmml" xref="S3.Thmtheorem1.p1.6.6.m6.6.6.1.1.1">subscript</csymbol><ci id="S3.Thmtheorem1.p1.6.6.m6.6.6.1.1.1.2.2.cmml" xref="S3.Thmtheorem1.p1.6.6.m6.6.6.1.1.1.2.2">𝜔</ci><ci id="S3.Thmtheorem1.p1.6.6.m6.6.6.1.1.1.2.3.cmml" xref="S3.Thmtheorem1.p1.6.6.m6.6.6.1.1.1.2.3">𝑘</ci></apply><ci id="S3.Thmtheorem1.p1.6.6.m6.1.1.1.1.cmml" xref="S3.Thmtheorem1.p1.6.6.m6.1.1.1.1">𝑖</ci></apply></set><apply id="S3.Thmtheorem1.p1.6.6.m6.5.5.4.5.cmml" xref="S3.Thmtheorem1.p1.6.6.m6.5.5.4.4"><csymbol cd="ambiguous" id="S3.Thmtheorem1.p1.6.6.m6.5.5.4.5a.cmml" xref="S3.Thmtheorem1.p1.6.6.m6.5.5.4.4.3">formulae-sequence</csymbol><apply id="S3.Thmtheorem1.p1.6.6.m6.4.4.3.3.1.cmml" xref="S3.Thmtheorem1.p1.6.6.m6.4.4.3.3.1"><in id="S3.Thmtheorem1.p1.6.6.m6.4.4.3.3.1.1.cmml" xref="S3.Thmtheorem1.p1.6.6.m6.4.4.3.3.1.1"></in><apply id="S3.Thmtheorem1.p1.6.6.m6.4.4.3.3.1.2.cmml" xref="S3.Thmtheorem1.p1.6.6.m6.4.4.3.3.1.2"><csymbol cd="ambiguous" id="S3.Thmtheorem1.p1.6.6.m6.4.4.3.3.1.2.1.cmml" xref="S3.Thmtheorem1.p1.6.6.m6.4.4.3.3.1.2">subscript</csymbol><ci id="S3.Thmtheorem1.p1.6.6.m6.4.4.3.3.1.2.2.cmml" xref="S3.Thmtheorem1.p1.6.6.m6.4.4.3.3.1.2.2">𝑣</ci><ci id="S3.Thmtheorem1.p1.6.6.m6.4.4.3.3.1.2.3.cmml" xref="S3.Thmtheorem1.p1.6.6.m6.4.4.3.3.1.2.3">𝑖</ci></apply><ci id="S3.Thmtheorem1.p1.6.6.m6.4.4.3.3.1.3.cmml" xref="S3.Thmtheorem1.p1.6.6.m6.4.4.3.3.1.3">𝒩</ci></apply><apply id="S3.Thmtheorem1.p1.6.6.m6.5.5.4.4.2.cmml" xref="S3.Thmtheorem1.p1.6.6.m6.5.5.4.4.2"><in id="S3.Thmtheorem1.p1.6.6.m6.5.5.4.4.2.2.cmml" xref="S3.Thmtheorem1.p1.6.6.m6.5.5.4.4.2.2"></in><ci id="S3.Thmtheorem1.p1.6.6.m6.5.5.4.4.2.3.cmml" xref="S3.Thmtheorem1.p1.6.6.m6.5.5.4.4.2.3">𝑘</ci><apply id="S3.Thmtheorem1.p1.6.6.m6.5.5.4.4.2.1.2.cmml" xref="S3.Thmtheorem1.p1.6.6.m6.5.5.4.4.2.1.1"><csymbol cd="latexml" id="S3.Thmtheorem1.p1.6.6.m6.5.5.4.4.2.1.2.1.cmml" xref="S3.Thmtheorem1.p1.6.6.m6.5.5.4.4.2.1.1.2">delimited-[]</csymbol><interval closure="closed" id="S3.Thmtheorem1.p1.6.6.m6.5.5.4.4.2.1.1.1.1.cmml" xref="S3.Thmtheorem1.p1.6.6.m6.5.5.4.4.2.1.1.1.2"><cn id="S3.Thmtheorem1.p1.6.6.m6.2.2.1.1.cmml" type="integer" xref="S3.Thmtheorem1.p1.6.6.m6.2.2.1.1">1</cn><ci id="S3.Thmtheorem1.p1.6.6.m6.3.3.2.2.cmml" xref="S3.Thmtheorem1.p1.6.6.m6.3.3.2.2">𝑛</ci></interval></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmtheorem1.p1.6.6.m6.6c">\{\omega_{k}^{(i)}\}_{v_{i}\in\mathcal{N},\hskip 1.39998ptk\in[\![1,n]\!]}</annotation><annotation encoding="application/x-llamapun" id="S3.Thmtheorem1.p1.6.6.m6.6d">{ italic_ω start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT } start_POSTSUBSCRIPT italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∈ caligraphic_N , italic_k ∈ [ [ 1 , italic_n ] ] end_POSTSUBSCRIPT</annotation></semantics></math> with geometrically distributed lengths, terminating with probability <math alttext="p_{\textrm{halt}}" class="ltx_Math" display="inline" id="S3.Thmtheorem1.p1.7.7.m7.1"><semantics id="S3.Thmtheorem1.p1.7.7.m7.1a"><msub id="S3.Thmtheorem1.p1.7.7.m7.1.1" xref="S3.Thmtheorem1.p1.7.7.m7.1.1.cmml"><mi id="S3.Thmtheorem1.p1.7.7.m7.1.1.2" xref="S3.Thmtheorem1.p1.7.7.m7.1.1.2.cmml">p</mi><mtext class="ltx_mathvariant_italic" id="S3.Thmtheorem1.p1.7.7.m7.1.1.3" xref="S3.Thmtheorem1.p1.7.7.m7.1.1.3a.cmml">halt</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.Thmtheorem1.p1.7.7.m7.1b"><apply id="S3.Thmtheorem1.p1.7.7.m7.1.1.cmml" xref="S3.Thmtheorem1.p1.7.7.m7.1.1"><csymbol cd="ambiguous" id="S3.Thmtheorem1.p1.7.7.m7.1.1.1.cmml" xref="S3.Thmtheorem1.p1.7.7.m7.1.1">subscript</csymbol><ci id="S3.Thmtheorem1.p1.7.7.m7.1.1.2.cmml" xref="S3.Thmtheorem1.p1.7.7.m7.1.1.2">𝑝</ci><ci id="S3.Thmtheorem1.p1.7.7.m7.1.1.3a.cmml" xref="S3.Thmtheorem1.p1.7.7.m7.1.1.3"><mtext class="ltx_mathvariant_italic" id="S3.Thmtheorem1.p1.7.7.m7.1.1.3.cmml" mathsize="70%" xref="S3.Thmtheorem1.p1.7.7.m7.1.1.3">halt</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmtheorem1.p1.7.7.m7.1c">p_{\textrm{halt}}</annotation><annotation encoding="application/x-llamapun" id="S3.Thmtheorem1.p1.7.7.m7.1d">italic_p start_POSTSUBSCRIPT halt end_POSTSUBSCRIPT</annotation></semantics></math> at each timestep.
Let
<math alttext="c\coloneqq\sum_{k=0}^{\infty}|f_{k}|(\max_{v_{i},v_{j}\in\mathcal{N}}\frac{|%
\mathbf{W}_{ij}|d_{i}}{1-p_{\textrm{halt}}})^{k}." class="ltx_Math" display="inline" id="S3.Thmtheorem1.p1.8.8.m8.4"><semantics id="S3.Thmtheorem1.p1.8.8.m8.4a"><mrow id="S3.Thmtheorem1.p1.8.8.m8.4.4.1" xref="S3.Thmtheorem1.p1.8.8.m8.4.4.1.1.cmml"><mrow id="S3.Thmtheorem1.p1.8.8.m8.4.4.1.1" xref="S3.Thmtheorem1.p1.8.8.m8.4.4.1.1.cmml"><mi id="S3.Thmtheorem1.p1.8.8.m8.4.4.1.1.4" xref="S3.Thmtheorem1.p1.8.8.m8.4.4.1.1.4.cmml">c</mi><mo id="S3.Thmtheorem1.p1.8.8.m8.4.4.1.1.3" rspace="0.111em" xref="S3.Thmtheorem1.p1.8.8.m8.4.4.1.1.3.cmml">≔</mo><mrow id="S3.Thmtheorem1.p1.8.8.m8.4.4.1.1.2" xref="S3.Thmtheorem1.p1.8.8.m8.4.4.1.1.2.cmml"><msubsup id="S3.Thmtheorem1.p1.8.8.m8.4.4.1.1.2.3" xref="S3.Thmtheorem1.p1.8.8.m8.4.4.1.1.2.3.cmml"><mo id="S3.Thmtheorem1.p1.8.8.m8.4.4.1.1.2.3.2.2" rspace="0em" xref="S3.Thmtheorem1.p1.8.8.m8.4.4.1.1.2.3.2.2.cmml">∑</mo><mrow id="S3.Thmtheorem1.p1.8.8.m8.4.4.1.1.2.3.2.3" xref="S3.Thmtheorem1.p1.8.8.m8.4.4.1.1.2.3.2.3.cmml"><mi id="S3.Thmtheorem1.p1.8.8.m8.4.4.1.1.2.3.2.3.2" xref="S3.Thmtheorem1.p1.8.8.m8.4.4.1.1.2.3.2.3.2.cmml">k</mi><mo id="S3.Thmtheorem1.p1.8.8.m8.4.4.1.1.2.3.2.3.1" xref="S3.Thmtheorem1.p1.8.8.m8.4.4.1.1.2.3.2.3.1.cmml">=</mo><mn id="S3.Thmtheorem1.p1.8.8.m8.4.4.1.1.2.3.2.3.3" xref="S3.Thmtheorem1.p1.8.8.m8.4.4.1.1.2.3.2.3.3.cmml">0</mn></mrow><mi id="S3.Thmtheorem1.p1.8.8.m8.4.4.1.1.2.3.3" mathvariant="normal" xref="S3.Thmtheorem1.p1.8.8.m8.4.4.1.1.2.3.3.cmml">∞</mi></msubsup><mrow id="S3.Thmtheorem1.p1.8.8.m8.4.4.1.1.2.2" xref="S3.Thmtheorem1.p1.8.8.m8.4.4.1.1.2.2.cmml"><mrow id="S3.Thmtheorem1.p1.8.8.m8.4.4.1.1.1.1.1.1" xref="S3.Thmtheorem1.p1.8.8.m8.4.4.1.1.1.1.1.2.cmml"><mo id="S3.Thmtheorem1.p1.8.8.m8.4.4.1.1.1.1.1.1.2" stretchy="false" xref="S3.Thmtheorem1.p1.8.8.m8.4.4.1.1.1.1.1.2.1.cmml">|</mo><msub id="S3.Thmtheorem1.p1.8.8.m8.4.4.1.1.1.1.1.1.1" xref="S3.Thmtheorem1.p1.8.8.m8.4.4.1.1.1.1.1.1.1.cmml"><mi id="S3.Thmtheorem1.p1.8.8.m8.4.4.1.1.1.1.1.1.1.2" xref="S3.Thmtheorem1.p1.8.8.m8.4.4.1.1.1.1.1.1.1.2.cmml">f</mi><mi id="S3.Thmtheorem1.p1.8.8.m8.4.4.1.1.1.1.1.1.1.3" xref="S3.Thmtheorem1.p1.8.8.m8.4.4.1.1.1.1.1.1.1.3.cmml">k</mi></msub><mo id="S3.Thmtheorem1.p1.8.8.m8.4.4.1.1.1.1.1.1.3" stretchy="false" xref="S3.Thmtheorem1.p1.8.8.m8.4.4.1.1.1.1.1.2.1.cmml">|</mo></mrow><mo id="S3.Thmtheorem1.p1.8.8.m8.4.4.1.1.2.2.3" xref="S3.Thmtheorem1.p1.8.8.m8.4.4.1.1.2.2.3.cmml">⁢</mo><msup id="S3.Thmtheorem1.p1.8.8.m8.4.4.1.1.2.2.2" xref="S3.Thmtheorem1.p1.8.8.m8.4.4.1.1.2.2.2.cmml"><mrow id="S3.Thmtheorem1.p1.8.8.m8.4.4.1.1.2.2.2.1.1" xref="S3.Thmtheorem1.p1.8.8.m8.4.4.1.1.2.2.2.1.1.1.cmml"><mo id="S3.Thmtheorem1.p1.8.8.m8.4.4.1.1.2.2.2.1.1.2" stretchy="false" xref="S3.Thmtheorem1.p1.8.8.m8.4.4.1.1.2.2.2.1.1.1.cmml">(</mo><mrow id="S3.Thmtheorem1.p1.8.8.m8.4.4.1.1.2.2.2.1.1.1" xref="S3.Thmtheorem1.p1.8.8.m8.4.4.1.1.2.2.2.1.1.1.cmml"><msub id="S3.Thmtheorem1.p1.8.8.m8.4.4.1.1.2.2.2.1.1.1.1" xref="S3.Thmtheorem1.p1.8.8.m8.4.4.1.1.2.2.2.1.1.1.1.cmml"><mi id="S3.Thmtheorem1.p1.8.8.m8.4.4.1.1.2.2.2.1.1.1.1.2" xref="S3.Thmtheorem1.p1.8.8.m8.4.4.1.1.2.2.2.1.1.1.1.2.cmml">max</mi><mrow id="S3.Thmtheorem1.p1.8.8.m8.2.2.2" xref="S3.Thmtheorem1.p1.8.8.m8.2.2.2.cmml"><mrow id="S3.Thmtheorem1.p1.8.8.m8.2.2.2.2.2" xref="S3.Thmtheorem1.p1.8.8.m8.2.2.2.2.3.cmml"><msub id="S3.Thmtheorem1.p1.8.8.m8.1.1.1.1.1.1" xref="S3.Thmtheorem1.p1.8.8.m8.1.1.1.1.1.1.cmml"><mi id="S3.Thmtheorem1.p1.8.8.m8.1.1.1.1.1.1.2" xref="S3.Thmtheorem1.p1.8.8.m8.1.1.1.1.1.1.2.cmml">v</mi><mi id="S3.Thmtheorem1.p1.8.8.m8.1.1.1.1.1.1.3" xref="S3.Thmtheorem1.p1.8.8.m8.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.Thmtheorem1.p1.8.8.m8.2.2.2.2.2.3" xref="S3.Thmtheorem1.p1.8.8.m8.2.2.2.2.3.cmml">,</mo><msub id="S3.Thmtheorem1.p1.8.8.m8.2.2.2.2.2.2" xref="S3.Thmtheorem1.p1.8.8.m8.2.2.2.2.2.2.cmml"><mi id="S3.Thmtheorem1.p1.8.8.m8.2.2.2.2.2.2.2" xref="S3.Thmtheorem1.p1.8.8.m8.2.2.2.2.2.2.2.cmml">v</mi><mi id="S3.Thmtheorem1.p1.8.8.m8.2.2.2.2.2.2.3" xref="S3.Thmtheorem1.p1.8.8.m8.2.2.2.2.2.2.3.cmml">j</mi></msub></mrow><mo id="S3.Thmtheorem1.p1.8.8.m8.2.2.2.3" xref="S3.Thmtheorem1.p1.8.8.m8.2.2.2.3.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.Thmtheorem1.p1.8.8.m8.2.2.2.4" xref="S3.Thmtheorem1.p1.8.8.m8.2.2.2.4.cmml">𝒩</mi></mrow></msub><mo id="S3.Thmtheorem1.p1.8.8.m8.4.4.1.1.2.2.2.1.1.1a" lspace="0.167em" xref="S3.Thmtheorem1.p1.8.8.m8.4.4.1.1.2.2.2.1.1.1.cmml">⁡</mo><mfrac id="S3.Thmtheorem1.p1.8.8.m8.3.3" xref="S3.Thmtheorem1.p1.8.8.m8.3.3.cmml"><mrow id="S3.Thmtheorem1.p1.8.8.m8.3.3.1" xref="S3.Thmtheorem1.p1.8.8.m8.3.3.1.cmml"><mrow id="S3.Thmtheorem1.p1.8.8.m8.3.3.1.1.1" xref="S3.Thmtheorem1.p1.8.8.m8.3.3.1.1.2.cmml"><mo id="S3.Thmtheorem1.p1.8.8.m8.3.3.1.1.1.2" stretchy="false" xref="S3.Thmtheorem1.p1.8.8.m8.3.3.1.1.2.1.cmml">|</mo><msub id="S3.Thmtheorem1.p1.8.8.m8.3.3.1.1.1.1" xref="S3.Thmtheorem1.p1.8.8.m8.3.3.1.1.1.1.cmml"><mi id="S3.Thmtheorem1.p1.8.8.m8.3.3.1.1.1.1.2" xref="S3.Thmtheorem1.p1.8.8.m8.3.3.1.1.1.1.2.cmml">𝐖</mi><mrow id="S3.Thmtheorem1.p1.8.8.m8.3.3.1.1.1.1.3" xref="S3.Thmtheorem1.p1.8.8.m8.3.3.1.1.1.1.3.cmml"><mi id="S3.Thmtheorem1.p1.8.8.m8.3.3.1.1.1.1.3.2" xref="S3.Thmtheorem1.p1.8.8.m8.3.3.1.1.1.1.3.2.cmml">i</mi><mo id="S3.Thmtheorem1.p1.8.8.m8.3.3.1.1.1.1.3.1" xref="S3.Thmtheorem1.p1.8.8.m8.3.3.1.1.1.1.3.1.cmml">⁢</mo><mi id="S3.Thmtheorem1.p1.8.8.m8.3.3.1.1.1.1.3.3" xref="S3.Thmtheorem1.p1.8.8.m8.3.3.1.1.1.1.3.3.cmml">j</mi></mrow></msub><mo id="S3.Thmtheorem1.p1.8.8.m8.3.3.1.1.1.3" stretchy="false" xref="S3.Thmtheorem1.p1.8.8.m8.3.3.1.1.2.1.cmml">|</mo></mrow><mo id="S3.Thmtheorem1.p1.8.8.m8.3.3.1.2" xref="S3.Thmtheorem1.p1.8.8.m8.3.3.1.2.cmml">⁢</mo><msub id="S3.Thmtheorem1.p1.8.8.m8.3.3.1.3" xref="S3.Thmtheorem1.p1.8.8.m8.3.3.1.3.cmml"><mi id="S3.Thmtheorem1.p1.8.8.m8.3.3.1.3.2" xref="S3.Thmtheorem1.p1.8.8.m8.3.3.1.3.2.cmml">d</mi><mi id="S3.Thmtheorem1.p1.8.8.m8.3.3.1.3.3" xref="S3.Thmtheorem1.p1.8.8.m8.3.3.1.3.3.cmml">i</mi></msub></mrow><mrow id="S3.Thmtheorem1.p1.8.8.m8.3.3.3" xref="S3.Thmtheorem1.p1.8.8.m8.3.3.3.cmml"><mn id="S3.Thmtheorem1.p1.8.8.m8.3.3.3.2" xref="S3.Thmtheorem1.p1.8.8.m8.3.3.3.2.cmml">1</mn><mo id="S3.Thmtheorem1.p1.8.8.m8.3.3.3.1" xref="S3.Thmtheorem1.p1.8.8.m8.3.3.3.1.cmml">−</mo><msub id="S3.Thmtheorem1.p1.8.8.m8.3.3.3.3" xref="S3.Thmtheorem1.p1.8.8.m8.3.3.3.3.cmml"><mi id="S3.Thmtheorem1.p1.8.8.m8.3.3.3.3.2" xref="S3.Thmtheorem1.p1.8.8.m8.3.3.3.3.2.cmml">p</mi><mtext class="ltx_mathvariant_italic" id="S3.Thmtheorem1.p1.8.8.m8.3.3.3.3.3" xref="S3.Thmtheorem1.p1.8.8.m8.3.3.3.3.3a.cmml">halt</mtext></msub></mrow></mfrac></mrow><mo id="S3.Thmtheorem1.p1.8.8.m8.4.4.1.1.2.2.2.1.1.3" stretchy="false" xref="S3.Thmtheorem1.p1.8.8.m8.4.4.1.1.2.2.2.1.1.1.cmml">)</mo></mrow><mi id="S3.Thmtheorem1.p1.8.8.m8.4.4.1.1.2.2.2.3" xref="S3.Thmtheorem1.p1.8.8.m8.4.4.1.1.2.2.2.3.cmml">k</mi></msup></mrow></mrow></mrow><mo id="S3.Thmtheorem1.p1.8.8.m8.4.4.1.2" lspace="0em" xref="S3.Thmtheorem1.p1.8.8.m8.4.4.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.Thmtheorem1.p1.8.8.m8.4b"><apply id="S3.Thmtheorem1.p1.8.8.m8.4.4.1.1.cmml" xref="S3.Thmtheorem1.p1.8.8.m8.4.4.1"><ci id="S3.Thmtheorem1.p1.8.8.m8.4.4.1.1.3.cmml" xref="S3.Thmtheorem1.p1.8.8.m8.4.4.1.1.3">≔</ci><ci id="S3.Thmtheorem1.p1.8.8.m8.4.4.1.1.4.cmml" xref="S3.Thmtheorem1.p1.8.8.m8.4.4.1.1.4">𝑐</ci><apply id="S3.Thmtheorem1.p1.8.8.m8.4.4.1.1.2.cmml" xref="S3.Thmtheorem1.p1.8.8.m8.4.4.1.1.2"><apply id="S3.Thmtheorem1.p1.8.8.m8.4.4.1.1.2.3.cmml" xref="S3.Thmtheorem1.p1.8.8.m8.4.4.1.1.2.3"><csymbol cd="ambiguous" id="S3.Thmtheorem1.p1.8.8.m8.4.4.1.1.2.3.1.cmml" xref="S3.Thmtheorem1.p1.8.8.m8.4.4.1.1.2.3">superscript</csymbol><apply id="S3.Thmtheorem1.p1.8.8.m8.4.4.1.1.2.3.2.cmml" xref="S3.Thmtheorem1.p1.8.8.m8.4.4.1.1.2.3"><csymbol cd="ambiguous" id="S3.Thmtheorem1.p1.8.8.m8.4.4.1.1.2.3.2.1.cmml" xref="S3.Thmtheorem1.p1.8.8.m8.4.4.1.1.2.3">subscript</csymbol><sum id="S3.Thmtheorem1.p1.8.8.m8.4.4.1.1.2.3.2.2.cmml" xref="S3.Thmtheorem1.p1.8.8.m8.4.4.1.1.2.3.2.2"></sum><apply id="S3.Thmtheorem1.p1.8.8.m8.4.4.1.1.2.3.2.3.cmml" xref="S3.Thmtheorem1.p1.8.8.m8.4.4.1.1.2.3.2.3"><eq id="S3.Thmtheorem1.p1.8.8.m8.4.4.1.1.2.3.2.3.1.cmml" xref="S3.Thmtheorem1.p1.8.8.m8.4.4.1.1.2.3.2.3.1"></eq><ci id="S3.Thmtheorem1.p1.8.8.m8.4.4.1.1.2.3.2.3.2.cmml" xref="S3.Thmtheorem1.p1.8.8.m8.4.4.1.1.2.3.2.3.2">𝑘</ci><cn id="S3.Thmtheorem1.p1.8.8.m8.4.4.1.1.2.3.2.3.3.cmml" type="integer" xref="S3.Thmtheorem1.p1.8.8.m8.4.4.1.1.2.3.2.3.3">0</cn></apply></apply><infinity id="S3.Thmtheorem1.p1.8.8.m8.4.4.1.1.2.3.3.cmml" xref="S3.Thmtheorem1.p1.8.8.m8.4.4.1.1.2.3.3"></infinity></apply><apply id="S3.Thmtheorem1.p1.8.8.m8.4.4.1.1.2.2.cmml" xref="S3.Thmtheorem1.p1.8.8.m8.4.4.1.1.2.2"><times id="S3.Thmtheorem1.p1.8.8.m8.4.4.1.1.2.2.3.cmml" xref="S3.Thmtheorem1.p1.8.8.m8.4.4.1.1.2.2.3"></times><apply id="S3.Thmtheorem1.p1.8.8.m8.4.4.1.1.1.1.1.2.cmml" xref="S3.Thmtheorem1.p1.8.8.m8.4.4.1.1.1.1.1.1"><abs id="S3.Thmtheorem1.p1.8.8.m8.4.4.1.1.1.1.1.2.1.cmml" xref="S3.Thmtheorem1.p1.8.8.m8.4.4.1.1.1.1.1.1.2"></abs><apply id="S3.Thmtheorem1.p1.8.8.m8.4.4.1.1.1.1.1.1.1.cmml" xref="S3.Thmtheorem1.p1.8.8.m8.4.4.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Thmtheorem1.p1.8.8.m8.4.4.1.1.1.1.1.1.1.1.cmml" xref="S3.Thmtheorem1.p1.8.8.m8.4.4.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.Thmtheorem1.p1.8.8.m8.4.4.1.1.1.1.1.1.1.2.cmml" xref="S3.Thmtheorem1.p1.8.8.m8.4.4.1.1.1.1.1.1.1.2">𝑓</ci><ci id="S3.Thmtheorem1.p1.8.8.m8.4.4.1.1.1.1.1.1.1.3.cmml" xref="S3.Thmtheorem1.p1.8.8.m8.4.4.1.1.1.1.1.1.1.3">𝑘</ci></apply></apply><apply id="S3.Thmtheorem1.p1.8.8.m8.4.4.1.1.2.2.2.cmml" xref="S3.Thmtheorem1.p1.8.8.m8.4.4.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.Thmtheorem1.p1.8.8.m8.4.4.1.1.2.2.2.2.cmml" xref="S3.Thmtheorem1.p1.8.8.m8.4.4.1.1.2.2.2">superscript</csymbol><apply id="S3.Thmtheorem1.p1.8.8.m8.4.4.1.1.2.2.2.1.1.1.cmml" xref="S3.Thmtheorem1.p1.8.8.m8.4.4.1.1.2.2.2.1.1"><apply id="S3.Thmtheorem1.p1.8.8.m8.4.4.1.1.2.2.2.1.1.1.1.cmml" xref="S3.Thmtheorem1.p1.8.8.m8.4.4.1.1.2.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.Thmtheorem1.p1.8.8.m8.4.4.1.1.2.2.2.1.1.1.1.1.cmml" xref="S3.Thmtheorem1.p1.8.8.m8.4.4.1.1.2.2.2.1.1.1.1">subscript</csymbol><max id="S3.Thmtheorem1.p1.8.8.m8.4.4.1.1.2.2.2.1.1.1.1.2.cmml" xref="S3.Thmtheorem1.p1.8.8.m8.4.4.1.1.2.2.2.1.1.1.1.2"></max><apply id="S3.Thmtheorem1.p1.8.8.m8.2.2.2.cmml" xref="S3.Thmtheorem1.p1.8.8.m8.2.2.2"><in id="S3.Thmtheorem1.p1.8.8.m8.2.2.2.3.cmml" xref="S3.Thmtheorem1.p1.8.8.m8.2.2.2.3"></in><list id="S3.Thmtheorem1.p1.8.8.m8.2.2.2.2.3.cmml" xref="S3.Thmtheorem1.p1.8.8.m8.2.2.2.2.2"><apply id="S3.Thmtheorem1.p1.8.8.m8.1.1.1.1.1.1.cmml" xref="S3.Thmtheorem1.p1.8.8.m8.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Thmtheorem1.p1.8.8.m8.1.1.1.1.1.1.1.cmml" xref="S3.Thmtheorem1.p1.8.8.m8.1.1.1.1.1.1">subscript</csymbol><ci id="S3.Thmtheorem1.p1.8.8.m8.1.1.1.1.1.1.2.cmml" xref="S3.Thmtheorem1.p1.8.8.m8.1.1.1.1.1.1.2">𝑣</ci><ci id="S3.Thmtheorem1.p1.8.8.m8.1.1.1.1.1.1.3.cmml" xref="S3.Thmtheorem1.p1.8.8.m8.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.Thmtheorem1.p1.8.8.m8.2.2.2.2.2.2.cmml" xref="S3.Thmtheorem1.p1.8.8.m8.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.Thmtheorem1.p1.8.8.m8.2.2.2.2.2.2.1.cmml" xref="S3.Thmtheorem1.p1.8.8.m8.2.2.2.2.2.2">subscript</csymbol><ci id="S3.Thmtheorem1.p1.8.8.m8.2.2.2.2.2.2.2.cmml" xref="S3.Thmtheorem1.p1.8.8.m8.2.2.2.2.2.2.2">𝑣</ci><ci id="S3.Thmtheorem1.p1.8.8.m8.2.2.2.2.2.2.3.cmml" xref="S3.Thmtheorem1.p1.8.8.m8.2.2.2.2.2.2.3">𝑗</ci></apply></list><ci id="S3.Thmtheorem1.p1.8.8.m8.2.2.2.4.cmml" xref="S3.Thmtheorem1.p1.8.8.m8.2.2.2.4">𝒩</ci></apply></apply><apply id="S3.Thmtheorem1.p1.8.8.m8.3.3.cmml" xref="S3.Thmtheorem1.p1.8.8.m8.3.3"><divide id="S3.Thmtheorem1.p1.8.8.m8.3.3.2.cmml" xref="S3.Thmtheorem1.p1.8.8.m8.3.3"></divide><apply id="S3.Thmtheorem1.p1.8.8.m8.3.3.1.cmml" xref="S3.Thmtheorem1.p1.8.8.m8.3.3.1"><times id="S3.Thmtheorem1.p1.8.8.m8.3.3.1.2.cmml" xref="S3.Thmtheorem1.p1.8.8.m8.3.3.1.2"></times><apply id="S3.Thmtheorem1.p1.8.8.m8.3.3.1.1.2.cmml" xref="S3.Thmtheorem1.p1.8.8.m8.3.3.1.1.1"><abs id="S3.Thmtheorem1.p1.8.8.m8.3.3.1.1.2.1.cmml" xref="S3.Thmtheorem1.p1.8.8.m8.3.3.1.1.1.2"></abs><apply id="S3.Thmtheorem1.p1.8.8.m8.3.3.1.1.1.1.cmml" xref="S3.Thmtheorem1.p1.8.8.m8.3.3.1.1.1.1"><csymbol cd="ambiguous" id="S3.Thmtheorem1.p1.8.8.m8.3.3.1.1.1.1.1.cmml" xref="S3.Thmtheorem1.p1.8.8.m8.3.3.1.1.1.1">subscript</csymbol><ci id="S3.Thmtheorem1.p1.8.8.m8.3.3.1.1.1.1.2.cmml" xref="S3.Thmtheorem1.p1.8.8.m8.3.3.1.1.1.1.2">𝐖</ci><apply id="S3.Thmtheorem1.p1.8.8.m8.3.3.1.1.1.1.3.cmml" xref="S3.Thmtheorem1.p1.8.8.m8.3.3.1.1.1.1.3"><times id="S3.Thmtheorem1.p1.8.8.m8.3.3.1.1.1.1.3.1.cmml" xref="S3.Thmtheorem1.p1.8.8.m8.3.3.1.1.1.1.3.1"></times><ci id="S3.Thmtheorem1.p1.8.8.m8.3.3.1.1.1.1.3.2.cmml" xref="S3.Thmtheorem1.p1.8.8.m8.3.3.1.1.1.1.3.2">𝑖</ci><ci id="S3.Thmtheorem1.p1.8.8.m8.3.3.1.1.1.1.3.3.cmml" xref="S3.Thmtheorem1.p1.8.8.m8.3.3.1.1.1.1.3.3">𝑗</ci></apply></apply></apply><apply id="S3.Thmtheorem1.p1.8.8.m8.3.3.1.3.cmml" xref="S3.Thmtheorem1.p1.8.8.m8.3.3.1.3"><csymbol cd="ambiguous" id="S3.Thmtheorem1.p1.8.8.m8.3.3.1.3.1.cmml" xref="S3.Thmtheorem1.p1.8.8.m8.3.3.1.3">subscript</csymbol><ci id="S3.Thmtheorem1.p1.8.8.m8.3.3.1.3.2.cmml" xref="S3.Thmtheorem1.p1.8.8.m8.3.3.1.3.2">𝑑</ci><ci id="S3.Thmtheorem1.p1.8.8.m8.3.3.1.3.3.cmml" xref="S3.Thmtheorem1.p1.8.8.m8.3.3.1.3.3">𝑖</ci></apply></apply><apply id="S3.Thmtheorem1.p1.8.8.m8.3.3.3.cmml" xref="S3.Thmtheorem1.p1.8.8.m8.3.3.3"><minus id="S3.Thmtheorem1.p1.8.8.m8.3.3.3.1.cmml" xref="S3.Thmtheorem1.p1.8.8.m8.3.3.3.1"></minus><cn id="S3.Thmtheorem1.p1.8.8.m8.3.3.3.2.cmml" type="integer" xref="S3.Thmtheorem1.p1.8.8.m8.3.3.3.2">1</cn><apply id="S3.Thmtheorem1.p1.8.8.m8.3.3.3.3.cmml" xref="S3.Thmtheorem1.p1.8.8.m8.3.3.3.3"><csymbol cd="ambiguous" id="S3.Thmtheorem1.p1.8.8.m8.3.3.3.3.1.cmml" xref="S3.Thmtheorem1.p1.8.8.m8.3.3.3.3">subscript</csymbol><ci id="S3.Thmtheorem1.p1.8.8.m8.3.3.3.3.2.cmml" xref="S3.Thmtheorem1.p1.8.8.m8.3.3.3.3.2">𝑝</ci><ci id="S3.Thmtheorem1.p1.8.8.m8.3.3.3.3.3a.cmml" xref="S3.Thmtheorem1.p1.8.8.m8.3.3.3.3.3"><mtext class="ltx_mathvariant_italic" id="S3.Thmtheorem1.p1.8.8.m8.3.3.3.3.3.cmml" mathsize="50%" xref="S3.Thmtheorem1.p1.8.8.m8.3.3.3.3.3">halt</mtext></ci></apply></apply></apply></apply><ci id="S3.Thmtheorem1.p1.8.8.m8.4.4.1.1.2.2.2.3.cmml" xref="S3.Thmtheorem1.p1.8.8.m8.4.4.1.1.2.2.2.3">𝑘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmtheorem1.p1.8.8.m8.4c">c\coloneqq\sum_{k=0}^{\infty}|f_{k}|(\max_{v_{i},v_{j}\in\mathcal{N}}\frac{|%
\mathbf{W}_{ij}|d_{i}}{1-p_{\textrm{halt}}})^{k}.</annotation><annotation encoding="application/x-llamapun" id="S3.Thmtheorem1.p1.8.8.m8.4d">italic_c ≔ ∑ start_POSTSUBSCRIPT italic_k = 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∞ end_POSTSUPERSCRIPT | italic_f start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT | ( roman_max start_POSTSUBSCRIPT italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ∈ caligraphic_N end_POSTSUBSCRIPT divide start_ARG | bold_W start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT | italic_d start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_ARG start_ARG 1 - italic_p start_POSTSUBSCRIPT halt end_POSTSUBSCRIPT end_ARG ) start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT .</annotation></semantics></math>
Suppose <math alttext="c" class="ltx_Math" display="inline" id="S3.Thmtheorem1.p1.9.9.m9.1"><semantics id="S3.Thmtheorem1.p1.9.9.m9.1a"><mi id="S3.Thmtheorem1.p1.9.9.m9.1.1" xref="S3.Thmtheorem1.p1.9.9.m9.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S3.Thmtheorem1.p1.9.9.m9.1b"><ci id="S3.Thmtheorem1.p1.9.9.m9.1.1.cmml" xref="S3.Thmtheorem1.p1.9.9.m9.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmtheorem1.p1.9.9.m9.1c">c</annotation><annotation encoding="application/x-llamapun" id="S3.Thmtheorem1.p1.9.9.m9.1d">italic_c</annotation></semantics></math> is finite, which is guaranteed e.g.&nbsp;for bounded <math alttext="f" class="ltx_Math" display="inline" id="S3.Thmtheorem1.p1.10.10.m10.1"><semantics id="S3.Thmtheorem1.p1.10.10.m10.1a"><mi id="S3.Thmtheorem1.p1.10.10.m10.1.1" xref="S3.Thmtheorem1.p1.10.10.m10.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="S3.Thmtheorem1.p1.10.10.m10.1b"><ci id="S3.Thmtheorem1.p1.10.10.m10.1.1.cmml" xref="S3.Thmtheorem1.p1.10.10.m10.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmtheorem1.p1.10.10.m10.1c">f</annotation><annotation encoding="application/x-llamapun" id="S3.Thmtheorem1.p1.10.10.m10.1d">italic_f</annotation></semantics></math> and suitably normalised <math alttext="\mathbf{W}" class="ltx_Math" display="inline" id="S3.Thmtheorem1.p1.11.11.m11.1"><semantics id="S3.Thmtheorem1.p1.11.11.m11.1a"><mi id="S3.Thmtheorem1.p1.11.11.m11.1.1" xref="S3.Thmtheorem1.p1.11.11.m11.1.1.cmml">𝐖</mi><annotation-xml encoding="MathML-Content" id="S3.Thmtheorem1.p1.11.11.m11.1b"><ci id="S3.Thmtheorem1.p1.11.11.m11.1.1.cmml" xref="S3.Thmtheorem1.p1.11.11.m11.1.1">𝐖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmtheorem1.p1.11.11.m11.1c">\mathbf{W}</annotation><annotation encoding="application/x-llamapun" id="S3.Thmtheorem1.p1.11.11.m11.1d">bold_W</annotation></semantics></math>, or if there exists some <math alttext="i_{\textrm{max}}\in\mathbb{N}" class="ltx_Math" display="inline" id="S3.Thmtheorem1.p1.12.12.m12.1"><semantics id="S3.Thmtheorem1.p1.12.12.m12.1a"><mrow id="S3.Thmtheorem1.p1.12.12.m12.1.1" xref="S3.Thmtheorem1.p1.12.12.m12.1.1.cmml"><msub id="S3.Thmtheorem1.p1.12.12.m12.1.1.2" xref="S3.Thmtheorem1.p1.12.12.m12.1.1.2.cmml"><mi id="S3.Thmtheorem1.p1.12.12.m12.1.1.2.2" xref="S3.Thmtheorem1.p1.12.12.m12.1.1.2.2.cmml">i</mi><mtext class="ltx_mathvariant_italic" id="S3.Thmtheorem1.p1.12.12.m12.1.1.2.3" xref="S3.Thmtheorem1.p1.12.12.m12.1.1.2.3a.cmml">max</mtext></msub><mo id="S3.Thmtheorem1.p1.12.12.m12.1.1.1" xref="S3.Thmtheorem1.p1.12.12.m12.1.1.1.cmml">∈</mo><mi id="S3.Thmtheorem1.p1.12.12.m12.1.1.3" xref="S3.Thmtheorem1.p1.12.12.m12.1.1.3.cmml">ℕ</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.Thmtheorem1.p1.12.12.m12.1b"><apply id="S3.Thmtheorem1.p1.12.12.m12.1.1.cmml" xref="S3.Thmtheorem1.p1.12.12.m12.1.1"><in id="S3.Thmtheorem1.p1.12.12.m12.1.1.1.cmml" xref="S3.Thmtheorem1.p1.12.12.m12.1.1.1"></in><apply id="S3.Thmtheorem1.p1.12.12.m12.1.1.2.cmml" xref="S3.Thmtheorem1.p1.12.12.m12.1.1.2"><csymbol cd="ambiguous" id="S3.Thmtheorem1.p1.12.12.m12.1.1.2.1.cmml" xref="S3.Thmtheorem1.p1.12.12.m12.1.1.2">subscript</csymbol><ci id="S3.Thmtheorem1.p1.12.12.m12.1.1.2.2.cmml" xref="S3.Thmtheorem1.p1.12.12.m12.1.1.2.2">𝑖</ci><ci id="S3.Thmtheorem1.p1.12.12.m12.1.1.2.3a.cmml" xref="S3.Thmtheorem1.p1.12.12.m12.1.1.2.3"><mtext class="ltx_mathvariant_italic" id="S3.Thmtheorem1.p1.12.12.m12.1.1.2.3.cmml" mathsize="70%" xref="S3.Thmtheorem1.p1.12.12.m12.1.1.2.3">max</mtext></ci></apply><ci id="S3.Thmtheorem1.p1.12.12.m12.1.1.3.cmml" xref="S3.Thmtheorem1.p1.12.12.m12.1.1.3">ℕ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmtheorem1.p1.12.12.m12.1c">i_{\textrm{max}}\in\mathbb{N}</annotation><annotation encoding="application/x-llamapun" id="S3.Thmtheorem1.p1.12.12.m12.1d">italic_i start_POSTSUBSCRIPT max end_POSTSUBSCRIPT ∈ blackboard_N</annotation></semantics></math> such that <math alttext="f_{i}" class="ltx_Math" display="inline" id="S3.Thmtheorem1.p1.13.13.m13.1"><semantics id="S3.Thmtheorem1.p1.13.13.m13.1a"><msub id="S3.Thmtheorem1.p1.13.13.m13.1.1" xref="S3.Thmtheorem1.p1.13.13.m13.1.1.cmml"><mi id="S3.Thmtheorem1.p1.13.13.m13.1.1.2" xref="S3.Thmtheorem1.p1.13.13.m13.1.1.2.cmml">f</mi><mi id="S3.Thmtheorem1.p1.13.13.m13.1.1.3" xref="S3.Thmtheorem1.p1.13.13.m13.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.Thmtheorem1.p1.13.13.m13.1b"><apply id="S3.Thmtheorem1.p1.13.13.m13.1.1.cmml" xref="S3.Thmtheorem1.p1.13.13.m13.1.1"><csymbol cd="ambiguous" id="S3.Thmtheorem1.p1.13.13.m13.1.1.1.cmml" xref="S3.Thmtheorem1.p1.13.13.m13.1.1">subscript</csymbol><ci id="S3.Thmtheorem1.p1.13.13.m13.1.1.2.cmml" xref="S3.Thmtheorem1.p1.13.13.m13.1.1.2">𝑓</ci><ci id="S3.Thmtheorem1.p1.13.13.m13.1.1.3.cmml" xref="S3.Thmtheorem1.p1.13.13.m13.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmtheorem1.p1.13.13.m13.1c">f_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.Thmtheorem1.p1.13.13.m13.1d">italic_f start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> vanishes for all <math alttext="i>i_{\textrm{max}}" class="ltx_Math" display="inline" id="S3.Thmtheorem1.p1.14.14.m14.1"><semantics id="S3.Thmtheorem1.p1.14.14.m14.1a"><mrow id="S3.Thmtheorem1.p1.14.14.m14.1.1" xref="S3.Thmtheorem1.p1.14.14.m14.1.1.cmml"><mi id="S3.Thmtheorem1.p1.14.14.m14.1.1.2" xref="S3.Thmtheorem1.p1.14.14.m14.1.1.2.cmml">i</mi><mo id="S3.Thmtheorem1.p1.14.14.m14.1.1.1" xref="S3.Thmtheorem1.p1.14.14.m14.1.1.1.cmml">&gt;</mo><msub id="S3.Thmtheorem1.p1.14.14.m14.1.1.3" xref="S3.Thmtheorem1.p1.14.14.m14.1.1.3.cmml"><mi id="S3.Thmtheorem1.p1.14.14.m14.1.1.3.2" xref="S3.Thmtheorem1.p1.14.14.m14.1.1.3.2.cmml">i</mi><mtext class="ltx_mathvariant_italic" id="S3.Thmtheorem1.p1.14.14.m14.1.1.3.3" xref="S3.Thmtheorem1.p1.14.14.m14.1.1.3.3a.cmml">max</mtext></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.Thmtheorem1.p1.14.14.m14.1b"><apply id="S3.Thmtheorem1.p1.14.14.m14.1.1.cmml" xref="S3.Thmtheorem1.p1.14.14.m14.1.1"><gt id="S3.Thmtheorem1.p1.14.14.m14.1.1.1.cmml" xref="S3.Thmtheorem1.p1.14.14.m14.1.1.1"></gt><ci id="S3.Thmtheorem1.p1.14.14.m14.1.1.2.cmml" xref="S3.Thmtheorem1.p1.14.14.m14.1.1.2">𝑖</ci><apply id="S3.Thmtheorem1.p1.14.14.m14.1.1.3.cmml" xref="S3.Thmtheorem1.p1.14.14.m14.1.1.3"><csymbol cd="ambiguous" id="S3.Thmtheorem1.p1.14.14.m14.1.1.3.1.cmml" xref="S3.Thmtheorem1.p1.14.14.m14.1.1.3">subscript</csymbol><ci id="S3.Thmtheorem1.p1.14.14.m14.1.1.3.2.cmml" xref="S3.Thmtheorem1.p1.14.14.m14.1.1.3.2">𝑖</ci><ci id="S3.Thmtheorem1.p1.14.14.m14.1.1.3.3a.cmml" xref="S3.Thmtheorem1.p1.14.14.m14.1.1.3.3"><mtext class="ltx_mathvariant_italic" id="S3.Thmtheorem1.p1.14.14.m14.1.1.3.3.cmml" mathsize="70%" xref="S3.Thmtheorem1.p1.14.14.m14.1.1.3.3">max</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmtheorem1.p1.14.14.m14.1c">i&gt;i_{\textrm{max}}</annotation><annotation encoding="application/x-llamapun" id="S3.Thmtheorem1.p1.14.14.m14.1d">italic_i &gt; italic_i start_POSTSUBSCRIPT max end_POSTSUBSCRIPT</annotation></semantics></math> (see App.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#A1.SS2" title="A.2 Proof of Thm. 3.1 (novel) ‣ Appendix A Proofs ‣ Linear Transformer Topological Masking with Graph Random Features"><span class="ltx_text ltx_ref_tag">A.2</span></a>).
Then:</span></p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equation ltx_eqn_table" id="S3.E11">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\textrm{\emph{Pr}}\left(|\widehat{\phi}_{\mathcal{G}}(v_{i})^{\top}\widehat{%
\phi}_{\mathcal{G}}(v_{j})-{\mathbf{M}_{\alpha}}_{ij}|>t\right)\leq 2\exp\left%
(-\frac{t^{2}n^{3}}{2(2n-1)^{2}c^{4}}\right)." class="ltx_Math" display="block" id="S3.E11.m1.3"><semantics id="S3.E11.m1.3a"><mrow id="S3.E11.m1.3.3.1" xref="S3.E11.m1.3.3.1.1.cmml"><mrow id="S3.E11.m1.3.3.1.1" xref="S3.E11.m1.3.3.1.1.cmml"><mrow id="S3.E11.m1.3.3.1.1.1" xref="S3.E11.m1.3.3.1.1.1.cmml"><mtext id="S3.E11.m1.3.3.1.1.1.3" xref="S3.E11.m1.3.3.1.1.1.3a.cmml">Pr</mtext><mo id="S3.E11.m1.3.3.1.1.1.2" xref="S3.E11.m1.3.3.1.1.1.2.cmml">⁢</mo><mrow id="S3.E11.m1.3.3.1.1.1.1.1" xref="S3.E11.m1.3.3.1.1.1.1.1.1.cmml"><mo id="S3.E11.m1.3.3.1.1.1.1.1.2" xref="S3.E11.m1.3.3.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E11.m1.3.3.1.1.1.1.1.1" xref="S3.E11.m1.3.3.1.1.1.1.1.1.cmml"><mrow id="S3.E11.m1.3.3.1.1.1.1.1.1.1.1" xref="S3.E11.m1.3.3.1.1.1.1.1.1.1.2.cmml"><mo id="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E11.m1.3.3.1.1.1.1.1.1.1.2.1.cmml">|</mo><mrow id="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1" xref="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.cmml"><mrow id="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.2" xref="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.2.cmml"><msub id="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.2.4" xref="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.2.4.cmml"><mover accent="true" id="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.2.4.2" xref="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.2.4.2.cmml"><mi id="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.2.4.2.2" xref="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.2.4.2.2.cmml">ϕ</mi><mo id="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.2.4.2.1" xref="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.2.4.2.1.cmml">^</mo></mover><mi class="ltx_font_mathcaligraphic" id="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.2.4.3" xref="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.2.4.3.cmml">𝒢</mi></msub><mo id="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.2.3.cmml">⁢</mo><msup id="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">v</mi><mi id="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.cmml">⊤</mo></msup><mo id="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.2.3a" xref="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.2.3.cmml">⁢</mo><msub id="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.2.5" xref="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.2.5.cmml"><mover accent="true" id="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.2.5.2" xref="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.2.5.2.cmml"><mi id="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.2.5.2.2" xref="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.2.5.2.2.cmml">ϕ</mi><mo id="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.2.5.2.1" xref="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.2.5.2.1.cmml">^</mo></mover><mi class="ltx_font_mathcaligraphic" id="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.2.5.3" xref="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.2.5.3.cmml">𝒢</mi></msub><mo id="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.2.3b" xref="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.2.3.cmml">⁢</mo><mrow id="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.1" xref="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.1.1.cmml"><mo id="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.1.2" stretchy="false" xref="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.1.1.cmml">(</mo><msub id="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.1.1" xref="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.1.1.cmml"><mi id="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.1.1.2" xref="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.1.1.2.cmml">v</mi><mi id="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.1.1.3" xref="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.1.1.3.cmml">j</mi></msub><mo id="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.1.3" stretchy="false" xref="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.3" xref="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.3.cmml">−</mo><mmultiscripts id="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.4" xref="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.4.cmml"><mi id="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.4.2.2" xref="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.4.2.2.cmml">𝐌</mi><mi id="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.4.2.3" xref="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.4.2.3.cmml">α</mi><mrow id="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.4a" xref="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.4.cmml"></mrow><mrow id="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.4.3" xref="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.4.3.cmml"><mi id="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.4.3.2" xref="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.4.3.2.cmml">i</mi><mo id="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.4.3.1" xref="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.4.3.1.cmml">⁢</mo><mi id="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.4.3.3" xref="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.4.3.3.cmml">j</mi></mrow><mrow id="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.4b" xref="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.4.cmml"></mrow></mmultiscripts></mrow><mo id="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E11.m1.3.3.1.1.1.1.1.1.1.2.1.cmml">|</mo></mrow><mo id="S3.E11.m1.3.3.1.1.1.1.1.1.2" xref="S3.E11.m1.3.3.1.1.1.1.1.1.2.cmml">&gt;</mo><mi id="S3.E11.m1.3.3.1.1.1.1.1.1.3" xref="S3.E11.m1.3.3.1.1.1.1.1.1.3.cmml">t</mi></mrow><mo id="S3.E11.m1.3.3.1.1.1.1.1.3" xref="S3.E11.m1.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E11.m1.3.3.1.1.3" xref="S3.E11.m1.3.3.1.1.3.cmml">≤</mo><mrow id="S3.E11.m1.3.3.1.1.2" xref="S3.E11.m1.3.3.1.1.2.cmml"><mn id="S3.E11.m1.3.3.1.1.2.3" xref="S3.E11.m1.3.3.1.1.2.3.cmml">2</mn><mo id="S3.E11.m1.3.3.1.1.2.2" lspace="0.167em" xref="S3.E11.m1.3.3.1.1.2.2.cmml">⁢</mo><mrow id="S3.E11.m1.3.3.1.1.2.1.1" xref="S3.E11.m1.3.3.1.1.2.1.2.cmml"><mi id="S3.E11.m1.2.2" xref="S3.E11.m1.2.2.cmml">exp</mi><mo id="S3.E11.m1.3.3.1.1.2.1.1a" xref="S3.E11.m1.3.3.1.1.2.1.2.cmml">⁡</mo><mrow id="S3.E11.m1.3.3.1.1.2.1.1.1" xref="S3.E11.m1.3.3.1.1.2.1.2.cmml"><mo id="S3.E11.m1.3.3.1.1.2.1.1.1.2" xref="S3.E11.m1.3.3.1.1.2.1.2.cmml">(</mo><mrow id="S3.E11.m1.3.3.1.1.2.1.1.1.1" xref="S3.E11.m1.3.3.1.1.2.1.1.1.1.cmml"><mo id="S3.E11.m1.3.3.1.1.2.1.1.1.1a" xref="S3.E11.m1.3.3.1.1.2.1.1.1.1.cmml">−</mo><mfrac id="S3.E11.m1.1.1" xref="S3.E11.m1.1.1.cmml"><mrow id="S3.E11.m1.1.1.3" xref="S3.E11.m1.1.1.3.cmml"><msup id="S3.E11.m1.1.1.3.2" xref="S3.E11.m1.1.1.3.2.cmml"><mi id="S3.E11.m1.1.1.3.2.2" xref="S3.E11.m1.1.1.3.2.2.cmml">t</mi><mn id="S3.E11.m1.1.1.3.2.3" xref="S3.E11.m1.1.1.3.2.3.cmml">2</mn></msup><mo id="S3.E11.m1.1.1.3.1" xref="S3.E11.m1.1.1.3.1.cmml">⁢</mo><msup id="S3.E11.m1.1.1.3.3" xref="S3.E11.m1.1.1.3.3.cmml"><mi id="S3.E11.m1.1.1.3.3.2" xref="S3.E11.m1.1.1.3.3.2.cmml">n</mi><mn id="S3.E11.m1.1.1.3.3.3" xref="S3.E11.m1.1.1.3.3.3.cmml">3</mn></msup></mrow><mrow id="S3.E11.m1.1.1.1" xref="S3.E11.m1.1.1.1.cmml"><mn id="S3.E11.m1.1.1.1.3" xref="S3.E11.m1.1.1.1.3.cmml">2</mn><mo id="S3.E11.m1.1.1.1.2" xref="S3.E11.m1.1.1.1.2.cmml">⁢</mo><msup id="S3.E11.m1.1.1.1.1" xref="S3.E11.m1.1.1.1.1.cmml"><mrow id="S3.E11.m1.1.1.1.1.1.1" xref="S3.E11.m1.1.1.1.1.1.1.1.cmml"><mo id="S3.E11.m1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E11.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E11.m1.1.1.1.1.1.1.1" xref="S3.E11.m1.1.1.1.1.1.1.1.cmml"><mrow id="S3.E11.m1.1.1.1.1.1.1.1.2" xref="S3.E11.m1.1.1.1.1.1.1.1.2.cmml"><mn id="S3.E11.m1.1.1.1.1.1.1.1.2.2" xref="S3.E11.m1.1.1.1.1.1.1.1.2.2.cmml">2</mn><mo id="S3.E11.m1.1.1.1.1.1.1.1.2.1" xref="S3.E11.m1.1.1.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="S3.E11.m1.1.1.1.1.1.1.1.2.3" xref="S3.E11.m1.1.1.1.1.1.1.1.2.3.cmml">n</mi></mrow><mo id="S3.E11.m1.1.1.1.1.1.1.1.1" xref="S3.E11.m1.1.1.1.1.1.1.1.1.cmml">−</mo><mn id="S3.E11.m1.1.1.1.1.1.1.1.3" xref="S3.E11.m1.1.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S3.E11.m1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E11.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mn id="S3.E11.m1.1.1.1.1.3" xref="S3.E11.m1.1.1.1.1.3.cmml">2</mn></msup><mo id="S3.E11.m1.1.1.1.2a" xref="S3.E11.m1.1.1.1.2.cmml">⁢</mo><msup id="S3.E11.m1.1.1.1.4" xref="S3.E11.m1.1.1.1.4.cmml"><mi id="S3.E11.m1.1.1.1.4.2" xref="S3.E11.m1.1.1.1.4.2.cmml">c</mi><mn id="S3.E11.m1.1.1.1.4.3" xref="S3.E11.m1.1.1.1.4.3.cmml">4</mn></msup></mrow></mfrac></mrow><mo id="S3.E11.m1.3.3.1.1.2.1.1.1.3" xref="S3.E11.m1.3.3.1.1.2.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E11.m1.3.3.1.2" lspace="0em" xref="S3.E11.m1.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E11.m1.3b"><apply id="S3.E11.m1.3.3.1.1.cmml" xref="S3.E11.m1.3.3.1"><leq id="S3.E11.m1.3.3.1.1.3.cmml" xref="S3.E11.m1.3.3.1.1.3"></leq><apply id="S3.E11.m1.3.3.1.1.1.cmml" xref="S3.E11.m1.3.3.1.1.1"><times id="S3.E11.m1.3.3.1.1.1.2.cmml" xref="S3.E11.m1.3.3.1.1.1.2"></times><ci id="S3.E11.m1.3.3.1.1.1.3a.cmml" xref="S3.E11.m1.3.3.1.1.1.3"><mtext id="S3.E11.m1.3.3.1.1.1.3.cmml" xref="S3.E11.m1.3.3.1.1.1.3">Pr</mtext></ci><apply id="S3.E11.m1.3.3.1.1.1.1.1.1.cmml" xref="S3.E11.m1.3.3.1.1.1.1.1"><gt id="S3.E11.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S3.E11.m1.3.3.1.1.1.1.1.1.2"></gt><apply id="S3.E11.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="S3.E11.m1.3.3.1.1.1.1.1.1.1.1"><abs id="S3.E11.m1.3.3.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.2"></abs><apply id="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1"><minus id="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.3"></minus><apply id="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.2"><times id="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.2.3"></times><apply id="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.2.4.cmml" xref="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.2.4"><csymbol cd="ambiguous" id="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.2.4.1.cmml" xref="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.2.4">subscript</csymbol><apply id="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.2.4.2.cmml" xref="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.2.4.2"><ci id="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.2.4.2.1.cmml" xref="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.2.4.2.1">^</ci><ci id="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.2.4.2.2.cmml" xref="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.2.4.2.2">italic-ϕ</ci></apply><ci id="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.2.4.3.cmml" xref="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.2.4.3">𝒢</ci></apply><apply id="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2">𝑣</ci><ci id="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><csymbol cd="latexml" id="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3">top</csymbol></apply><apply id="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.2.5.cmml" xref="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.2.5"><csymbol cd="ambiguous" id="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.2.5.1.cmml" xref="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.2.5">subscript</csymbol><apply id="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.2.5.2.cmml" xref="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.2.5.2"><ci id="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.2.5.2.1.cmml" xref="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.2.5.2.1">^</ci><ci id="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.2.5.2.2.cmml" xref="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.2.5.2.2">italic-ϕ</ci></apply><ci id="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.2.5.3.cmml" xref="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.2.5.3">𝒢</ci></apply><apply id="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.1.1.cmml" xref="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.1"><csymbol cd="ambiguous" id="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.1.1.1.cmml" xref="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.1">subscript</csymbol><ci id="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.1.1.2.cmml" xref="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.1.1.2">𝑣</ci><ci id="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.1.1.3.cmml" xref="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.1.1.3">𝑗</ci></apply></apply><apply id="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.4.cmml" xref="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.4.1.cmml" xref="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.4">subscript</csymbol><apply id="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.4.2.cmml" xref="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.4.2.1.cmml" xref="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.4">subscript</csymbol><ci id="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.4.2.2.cmml" xref="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.4.2.2">𝐌</ci><ci id="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.4.2.3.cmml" xref="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.4.2.3">𝛼</ci></apply><apply id="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.4.3.cmml" xref="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.4.3"><times id="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.4.3.1.cmml" xref="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.4.3.1"></times><ci id="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.4.3.2.cmml" xref="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.4.3.2">𝑖</ci><ci id="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.4.3.3.cmml" xref="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.4.3.3">𝑗</ci></apply></apply></apply></apply><ci id="S3.E11.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S3.E11.m1.3.3.1.1.1.1.1.1.3">𝑡</ci></apply></apply><apply id="S3.E11.m1.3.3.1.1.2.cmml" xref="S3.E11.m1.3.3.1.1.2"><times id="S3.E11.m1.3.3.1.1.2.2.cmml" xref="S3.E11.m1.3.3.1.1.2.2"></times><cn id="S3.E11.m1.3.3.1.1.2.3.cmml" type="integer" xref="S3.E11.m1.3.3.1.1.2.3">2</cn><apply id="S3.E11.m1.3.3.1.1.2.1.2.cmml" xref="S3.E11.m1.3.3.1.1.2.1.1"><exp id="S3.E11.m1.2.2.cmml" xref="S3.E11.m1.2.2"></exp><apply id="S3.E11.m1.3.3.1.1.2.1.1.1.1.cmml" xref="S3.E11.m1.3.3.1.1.2.1.1.1.1"><minus id="S3.E11.m1.3.3.1.1.2.1.1.1.1.1.cmml" xref="S3.E11.m1.3.3.1.1.2.1.1.1.1"></minus><apply id="S3.E11.m1.1.1.cmml" xref="S3.E11.m1.1.1"><divide id="S3.E11.m1.1.1.2.cmml" xref="S3.E11.m1.1.1"></divide><apply id="S3.E11.m1.1.1.3.cmml" xref="S3.E11.m1.1.1.3"><times id="S3.E11.m1.1.1.3.1.cmml" xref="S3.E11.m1.1.1.3.1"></times><apply id="S3.E11.m1.1.1.3.2.cmml" xref="S3.E11.m1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E11.m1.1.1.3.2.1.cmml" xref="S3.E11.m1.1.1.3.2">superscript</csymbol><ci id="S3.E11.m1.1.1.3.2.2.cmml" xref="S3.E11.m1.1.1.3.2.2">𝑡</ci><cn id="S3.E11.m1.1.1.3.2.3.cmml" type="integer" xref="S3.E11.m1.1.1.3.2.3">2</cn></apply><apply id="S3.E11.m1.1.1.3.3.cmml" xref="S3.E11.m1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E11.m1.1.1.3.3.1.cmml" xref="S3.E11.m1.1.1.3.3">superscript</csymbol><ci id="S3.E11.m1.1.1.3.3.2.cmml" xref="S3.E11.m1.1.1.3.3.2">𝑛</ci><cn id="S3.E11.m1.1.1.3.3.3.cmml" type="integer" xref="S3.E11.m1.1.1.3.3.3">3</cn></apply></apply><apply id="S3.E11.m1.1.1.1.cmml" xref="S3.E11.m1.1.1.1"><times id="S3.E11.m1.1.1.1.2.cmml" xref="S3.E11.m1.1.1.1.2"></times><cn id="S3.E11.m1.1.1.1.3.cmml" type="integer" xref="S3.E11.m1.1.1.1.3">2</cn><apply id="S3.E11.m1.1.1.1.1.cmml" xref="S3.E11.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E11.m1.1.1.1.1.2.cmml" xref="S3.E11.m1.1.1.1.1">superscript</csymbol><apply id="S3.E11.m1.1.1.1.1.1.1.1.cmml" xref="S3.E11.m1.1.1.1.1.1.1"><minus id="S3.E11.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E11.m1.1.1.1.1.1.1.1.1"></minus><apply id="S3.E11.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.E11.m1.1.1.1.1.1.1.1.2"><times id="S3.E11.m1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E11.m1.1.1.1.1.1.1.1.2.1"></times><cn id="S3.E11.m1.1.1.1.1.1.1.1.2.2.cmml" type="integer" xref="S3.E11.m1.1.1.1.1.1.1.1.2.2">2</cn><ci id="S3.E11.m1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E11.m1.1.1.1.1.1.1.1.2.3">𝑛</ci></apply><cn id="S3.E11.m1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S3.E11.m1.1.1.1.1.1.1.1.3">1</cn></apply><cn id="S3.E11.m1.1.1.1.1.3.cmml" type="integer" xref="S3.E11.m1.1.1.1.1.3">2</cn></apply><apply id="S3.E11.m1.1.1.1.4.cmml" xref="S3.E11.m1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E11.m1.1.1.1.4.1.cmml" xref="S3.E11.m1.1.1.1.4">superscript</csymbol><ci id="S3.E11.m1.1.1.1.4.2.cmml" xref="S3.E11.m1.1.1.1.4.2">𝑐</ci><cn id="S3.E11.m1.1.1.1.4.3.cmml" type="integer" xref="S3.E11.m1.1.1.1.4.3">4</cn></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E11.m1.3c">\textrm{\emph{Pr}}\left(|\widehat{\phi}_{\mathcal{G}}(v_{i})^{\top}\widehat{%
\phi}_{\mathcal{G}}(v_{j})-{\mathbf{M}_{\alpha}}_{ij}|&gt;t\right)\leq 2\exp\left%
(-\frac{t^{2}n^{3}}{2(2n-1)^{2}c^{4}}\right).</annotation><annotation encoding="application/x-llamapun" id="S3.E11.m1.3d">Pr ( | over^ start_ARG italic_ϕ end_ARG start_POSTSUBSCRIPT caligraphic_G end_POSTSUBSCRIPT ( italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT over^ start_ARG italic_ϕ end_ARG start_POSTSUBSCRIPT caligraphic_G end_POSTSUBSCRIPT ( italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) - bold_M start_POSTSUBSCRIPT italic_α end_POSTSUBSCRIPT start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT | &gt; italic_t ) ≤ 2 roman_exp ( - divide start_ARG italic_t start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT italic_n start_POSTSUPERSCRIPT 3 end_POSTSUPERSCRIPT end_ARG start_ARG 2 ( 2 italic_n - 1 ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT italic_c start_POSTSUPERSCRIPT 4 end_POSTSUPERSCRIPT end_ARG ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(11)</span></td>
</tr></tbody>
</table>
</div>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS4.p2">
<p class="ltx_p" id="S3.SS4.p2.11"><em class="ltx_emph ltx_font_italic" id="S3.SS4.p2.11.1">Proof sketch.</em> Full details are in App.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#A1.SS2" title="A.2 Proof of Thm. 3.1 (novel) ‣ Appendix A Proofs ‣ Linear Transformer Topological Masking with Graph Random Features"><span class="ltx_text ltx_ref_tag">A.2</span></a>; here, we provide an overview.
Treat each pair of random walks <math alttext="X_{k}\coloneqq(\omega_{k}^{(i)},\omega_{k}^{(j)})\in\Omega\times\Omega" class="ltx_Math" display="inline" id="S3.SS4.p2.1.m1.4"><semantics id="S3.SS4.p2.1.m1.4a"><mrow id="S3.SS4.p2.1.m1.4.4" xref="S3.SS4.p2.1.m1.4.4.cmml"><msub id="S3.SS4.p2.1.m1.4.4.4" xref="S3.SS4.p2.1.m1.4.4.4.cmml"><mi id="S3.SS4.p2.1.m1.4.4.4.2" xref="S3.SS4.p2.1.m1.4.4.4.2.cmml">X</mi><mi id="S3.SS4.p2.1.m1.4.4.4.3" xref="S3.SS4.p2.1.m1.4.4.4.3.cmml">k</mi></msub><mo id="S3.SS4.p2.1.m1.4.4.5" xref="S3.SS4.p2.1.m1.4.4.5.cmml">≔</mo><mrow id="S3.SS4.p2.1.m1.4.4.2.2" xref="S3.SS4.p2.1.m1.4.4.2.3.cmml"><mo id="S3.SS4.p2.1.m1.4.4.2.2.3" stretchy="false" xref="S3.SS4.p2.1.m1.4.4.2.3.cmml">(</mo><msubsup id="S3.SS4.p2.1.m1.3.3.1.1.1" xref="S3.SS4.p2.1.m1.3.3.1.1.1.cmml"><mi id="S3.SS4.p2.1.m1.3.3.1.1.1.2.2" xref="S3.SS4.p2.1.m1.3.3.1.1.1.2.2.cmml">ω</mi><mi id="S3.SS4.p2.1.m1.3.3.1.1.1.2.3" xref="S3.SS4.p2.1.m1.3.3.1.1.1.2.3.cmml">k</mi><mrow id="S3.SS4.p2.1.m1.1.1.1.3" xref="S3.SS4.p2.1.m1.3.3.1.1.1.cmml"><mo id="S3.SS4.p2.1.m1.1.1.1.3.1" stretchy="false" xref="S3.SS4.p2.1.m1.3.3.1.1.1.cmml">(</mo><mi id="S3.SS4.p2.1.m1.1.1.1.1" xref="S3.SS4.p2.1.m1.1.1.1.1.cmml">i</mi><mo id="S3.SS4.p2.1.m1.1.1.1.3.2" stretchy="false" xref="S3.SS4.p2.1.m1.3.3.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S3.SS4.p2.1.m1.4.4.2.2.4" xref="S3.SS4.p2.1.m1.4.4.2.3.cmml">,</mo><msubsup id="S3.SS4.p2.1.m1.4.4.2.2.2" xref="S3.SS4.p2.1.m1.4.4.2.2.2.cmml"><mi id="S3.SS4.p2.1.m1.4.4.2.2.2.2.2" xref="S3.SS4.p2.1.m1.4.4.2.2.2.2.2.cmml">ω</mi><mi id="S3.SS4.p2.1.m1.4.4.2.2.2.2.3" xref="S3.SS4.p2.1.m1.4.4.2.2.2.2.3.cmml">k</mi><mrow id="S3.SS4.p2.1.m1.2.2.1.3" xref="S3.SS4.p2.1.m1.4.4.2.2.2.cmml"><mo id="S3.SS4.p2.1.m1.2.2.1.3.1" stretchy="false" xref="S3.SS4.p2.1.m1.4.4.2.2.2.cmml">(</mo><mi id="S3.SS4.p2.1.m1.2.2.1.1" xref="S3.SS4.p2.1.m1.2.2.1.1.cmml">j</mi><mo id="S3.SS4.p2.1.m1.2.2.1.3.2" stretchy="false" xref="S3.SS4.p2.1.m1.4.4.2.2.2.cmml">)</mo></mrow></msubsup><mo id="S3.SS4.p2.1.m1.4.4.2.2.5" stretchy="false" xref="S3.SS4.p2.1.m1.4.4.2.3.cmml">)</mo></mrow><mo id="S3.SS4.p2.1.m1.4.4.6" xref="S3.SS4.p2.1.m1.4.4.6.cmml">∈</mo><mrow id="S3.SS4.p2.1.m1.4.4.7" xref="S3.SS4.p2.1.m1.4.4.7.cmml"><mi id="S3.SS4.p2.1.m1.4.4.7.2" mathvariant="normal" xref="S3.SS4.p2.1.m1.4.4.7.2.cmml">Ω</mi><mo id="S3.SS4.p2.1.m1.4.4.7.1" lspace="0.222em" rspace="0.222em" xref="S3.SS4.p2.1.m1.4.4.7.1.cmml">×</mo><mi id="S3.SS4.p2.1.m1.4.4.7.3" mathvariant="normal" xref="S3.SS4.p2.1.m1.4.4.7.3.cmml">Ω</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.1.m1.4b"><apply id="S3.SS4.p2.1.m1.4.4.cmml" xref="S3.SS4.p2.1.m1.4.4"><and id="S3.SS4.p2.1.m1.4.4a.cmml" xref="S3.SS4.p2.1.m1.4.4"></and><apply id="S3.SS4.p2.1.m1.4.4b.cmml" xref="S3.SS4.p2.1.m1.4.4"><ci id="S3.SS4.p2.1.m1.4.4.5.cmml" xref="S3.SS4.p2.1.m1.4.4.5">≔</ci><apply id="S3.SS4.p2.1.m1.4.4.4.cmml" xref="S3.SS4.p2.1.m1.4.4.4"><csymbol cd="ambiguous" id="S3.SS4.p2.1.m1.4.4.4.1.cmml" xref="S3.SS4.p2.1.m1.4.4.4">subscript</csymbol><ci id="S3.SS4.p2.1.m1.4.4.4.2.cmml" xref="S3.SS4.p2.1.m1.4.4.4.2">𝑋</ci><ci id="S3.SS4.p2.1.m1.4.4.4.3.cmml" xref="S3.SS4.p2.1.m1.4.4.4.3">𝑘</ci></apply><interval closure="open" id="S3.SS4.p2.1.m1.4.4.2.3.cmml" xref="S3.SS4.p2.1.m1.4.4.2.2"><apply id="S3.SS4.p2.1.m1.3.3.1.1.1.cmml" xref="S3.SS4.p2.1.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p2.1.m1.3.3.1.1.1.1.cmml" xref="S3.SS4.p2.1.m1.3.3.1.1.1">superscript</csymbol><apply id="S3.SS4.p2.1.m1.3.3.1.1.1.2.cmml" xref="S3.SS4.p2.1.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p2.1.m1.3.3.1.1.1.2.1.cmml" xref="S3.SS4.p2.1.m1.3.3.1.1.1">subscript</csymbol><ci id="S3.SS4.p2.1.m1.3.3.1.1.1.2.2.cmml" xref="S3.SS4.p2.1.m1.3.3.1.1.1.2.2">𝜔</ci><ci id="S3.SS4.p2.1.m1.3.3.1.1.1.2.3.cmml" xref="S3.SS4.p2.1.m1.3.3.1.1.1.2.3">𝑘</ci></apply><ci id="S3.SS4.p2.1.m1.1.1.1.1.cmml" xref="S3.SS4.p2.1.m1.1.1.1.1">𝑖</ci></apply><apply id="S3.SS4.p2.1.m1.4.4.2.2.2.cmml" xref="S3.SS4.p2.1.m1.4.4.2.2.2"><csymbol cd="ambiguous" id="S3.SS4.p2.1.m1.4.4.2.2.2.1.cmml" xref="S3.SS4.p2.1.m1.4.4.2.2.2">superscript</csymbol><apply id="S3.SS4.p2.1.m1.4.4.2.2.2.2.cmml" xref="S3.SS4.p2.1.m1.4.4.2.2.2"><csymbol cd="ambiguous" id="S3.SS4.p2.1.m1.4.4.2.2.2.2.1.cmml" xref="S3.SS4.p2.1.m1.4.4.2.2.2">subscript</csymbol><ci id="S3.SS4.p2.1.m1.4.4.2.2.2.2.2.cmml" xref="S3.SS4.p2.1.m1.4.4.2.2.2.2.2">𝜔</ci><ci id="S3.SS4.p2.1.m1.4.4.2.2.2.2.3.cmml" xref="S3.SS4.p2.1.m1.4.4.2.2.2.2.3">𝑘</ci></apply><ci id="S3.SS4.p2.1.m1.2.2.1.1.cmml" xref="S3.SS4.p2.1.m1.2.2.1.1">𝑗</ci></apply></interval></apply><apply id="S3.SS4.p2.1.m1.4.4c.cmml" xref="S3.SS4.p2.1.m1.4.4"><in id="S3.SS4.p2.1.m1.4.4.6.cmml" xref="S3.SS4.p2.1.m1.4.4.6"></in><share href="https://arxiv.org/html/2410.03462v1#S3.SS4.p2.1.m1.4.4.2.cmml" id="S3.SS4.p2.1.m1.4.4d.cmml" xref="S3.SS4.p2.1.m1.4.4"></share><apply id="S3.SS4.p2.1.m1.4.4.7.cmml" xref="S3.SS4.p2.1.m1.4.4.7"><times id="S3.SS4.p2.1.m1.4.4.7.1.cmml" xref="S3.SS4.p2.1.m1.4.4.7.1"></times><ci id="S3.SS4.p2.1.m1.4.4.7.2.cmml" xref="S3.SS4.p2.1.m1.4.4.7.2">Ω</ci><ci id="S3.SS4.p2.1.m1.4.4.7.3.cmml" xref="S3.SS4.p2.1.m1.4.4.7.3">Ω</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.1.m1.4c">X_{k}\coloneqq(\omega_{k}^{(i)},\omega_{k}^{(j)})\in\Omega\times\Omega</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p2.1.m1.4d">italic_X start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ≔ ( italic_ω start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT , italic_ω start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_j ) end_POSTSUPERSCRIPT ) ∈ roman_Ω × roman_Ω</annotation></semantics></math>, simulated out of nodes <math alttext="v_{i}" class="ltx_Math" display="inline" id="S3.SS4.p2.2.m2.1"><semantics id="S3.SS4.p2.2.m2.1a"><msub id="S3.SS4.p2.2.m2.1.1" xref="S3.SS4.p2.2.m2.1.1.cmml"><mi id="S3.SS4.p2.2.m2.1.1.2" xref="S3.SS4.p2.2.m2.1.1.2.cmml">v</mi><mi id="S3.SS4.p2.2.m2.1.1.3" xref="S3.SS4.p2.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.2.m2.1b"><apply id="S3.SS4.p2.2.m2.1.1.cmml" xref="S3.SS4.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS4.p2.2.m2.1.1.1.cmml" xref="S3.SS4.p2.2.m2.1.1">subscript</csymbol><ci id="S3.SS4.p2.2.m2.1.1.2.cmml" xref="S3.SS4.p2.2.m2.1.1.2">𝑣</ci><ci id="S3.SS4.p2.2.m2.1.1.3.cmml" xref="S3.SS4.p2.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.2.m2.1c">v_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p2.2.m2.1d">italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="v_{j}" class="ltx_Math" display="inline" id="S3.SS4.p2.3.m3.1"><semantics id="S3.SS4.p2.3.m3.1a"><msub id="S3.SS4.p2.3.m3.1.1" xref="S3.SS4.p2.3.m3.1.1.cmml"><mi id="S3.SS4.p2.3.m3.1.1.2" xref="S3.SS4.p2.3.m3.1.1.2.cmml">v</mi><mi id="S3.SS4.p2.3.m3.1.1.3" xref="S3.SS4.p2.3.m3.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.3.m3.1b"><apply id="S3.SS4.p2.3.m3.1.1.cmml" xref="S3.SS4.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS4.p2.3.m3.1.1.1.cmml" xref="S3.SS4.p2.3.m3.1.1">subscript</csymbol><ci id="S3.SS4.p2.3.m3.1.1.2.cmml" xref="S3.SS4.p2.3.m3.1.1.2">𝑣</ci><ci id="S3.SS4.p2.3.m3.1.1.3.cmml" xref="S3.SS4.p2.3.m3.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.3.m3.1c">v_{j}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p2.3.m3.1d">italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> respectively, as a random variable.
Let <math alttext="k\in[\![1,n]\!]" class="ltx_Math" display="inline" id="S3.SS4.p2.4.m4.3"><semantics id="S3.SS4.p2.4.m4.3a"><mrow id="S3.SS4.p2.4.m4.3.3" xref="S3.SS4.p2.4.m4.3.3.cmml"><mi id="S3.SS4.p2.4.m4.3.3.3" xref="S3.SS4.p2.4.m4.3.3.3.cmml">k</mi><mo id="S3.SS4.p2.4.m4.3.3.2" xref="S3.SS4.p2.4.m4.3.3.2.cmml">∈</mo><mrow id="S3.SS4.p2.4.m4.3.3.1.1" xref="S3.SS4.p2.4.m4.3.3.1.2.cmml"><mpadded width="0.247em"><mo id="S3.SS4.p2.4.m4.3.3.1.1.2" stretchy="false" xref="S3.SS4.p2.4.m4.3.3.1.2.1.cmml">[</mo></mpadded><mrow id="S3.SS4.p2.4.m4.3.3.1.1.1.2" xref="S3.SS4.p2.4.m4.3.3.1.1.1.1.cmml"><mo id="S3.SS4.p2.4.m4.3.3.1.1.1.2.1" stretchy="false" xref="S3.SS4.p2.4.m4.3.3.1.1.1.1.cmml">[</mo><mn id="S3.SS4.p2.4.m4.1.1" xref="S3.SS4.p2.4.m4.1.1.cmml">1</mn><mo id="S3.SS4.p2.4.m4.3.3.1.1.1.2.2" xref="S3.SS4.p2.4.m4.3.3.1.1.1.1.cmml">,</mo><mi id="S3.SS4.p2.4.m4.2.2" xref="S3.SS4.p2.4.m4.2.2.cmml">n</mi><mpadded width="0.247em"><mo id="S3.SS4.p2.4.m4.3.3.1.1.1.2.3" stretchy="false" xref="S3.SS4.p2.4.m4.3.3.1.1.1.1.cmml">]</mo></mpadded></mrow><mo id="S3.SS4.p2.4.m4.3.3.1.1.3" stretchy="false" xref="S3.SS4.p2.4.m4.3.3.1.2.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.4.m4.3b"><apply id="S3.SS4.p2.4.m4.3.3.cmml" xref="S3.SS4.p2.4.m4.3.3"><in id="S3.SS4.p2.4.m4.3.3.2.cmml" xref="S3.SS4.p2.4.m4.3.3.2"></in><ci id="S3.SS4.p2.4.m4.3.3.3.cmml" xref="S3.SS4.p2.4.m4.3.3.3">𝑘</ci><apply id="S3.SS4.p2.4.m4.3.3.1.2.cmml" xref="S3.SS4.p2.4.m4.3.3.1.1"><csymbol cd="latexml" id="S3.SS4.p2.4.m4.3.3.1.2.1.cmml" xref="S3.SS4.p2.4.m4.3.3.1.1.2">delimited-[]</csymbol><interval closure="closed" id="S3.SS4.p2.4.m4.3.3.1.1.1.1.cmml" xref="S3.SS4.p2.4.m4.3.3.1.1.1.2"><cn id="S3.SS4.p2.4.m4.1.1.cmml" type="integer" xref="S3.SS4.p2.4.m4.1.1">1</cn><ci id="S3.SS4.p2.4.m4.2.2.cmml" xref="S3.SS4.p2.4.m4.2.2">𝑛</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.4.m4.3c">k\in[\![1,n]\!]</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p2.4.m4.3d">italic_k ∈ [ [ 1 , italic_n ] ]</annotation></semantics></math> so we sample <math alttext="n" class="ltx_Math" display="inline" id="S3.SS4.p2.5.m5.1"><semantics id="S3.SS4.p2.5.m5.1a"><mi id="S3.SS4.p2.5.m5.1.1" xref="S3.SS4.p2.5.m5.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.5.m5.1b"><ci id="S3.SS4.p2.5.m5.1.1.cmml" xref="S3.SS4.p2.5.m5.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.5.m5.1c">n</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p2.5.m5.1d">italic_n</annotation></semantics></math> such pairs of walks in total.
Consider modifying one of the pairs of walks.
If <math alttext="c" class="ltx_Math" display="inline" id="S3.SS4.p2.6.m6.1"><semantics id="S3.SS4.p2.6.m6.1a"><mi id="S3.SS4.p2.6.m6.1.1" xref="S3.SS4.p2.6.m6.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.6.m6.1b"><ci id="S3.SS4.p2.6.m6.1.1.cmml" xref="S3.SS4.p2.6.m6.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.6.m6.1c">c</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p2.6.m6.1d">italic_c</annotation></semantics></math> is finite, the maximum load it is capable of depositing is finite so we can bound the <math alttext="L_{1}" class="ltx_Math" display="inline" id="S3.SS4.p2.7.m7.1"><semantics id="S3.SS4.p2.7.m7.1a"><msub id="S3.SS4.p2.7.m7.1.1" xref="S3.SS4.p2.7.m7.1.1.cmml"><mi id="S3.SS4.p2.7.m7.1.1.2" xref="S3.SS4.p2.7.m7.1.1.2.cmml">L</mi><mn id="S3.SS4.p2.7.m7.1.1.3" xref="S3.SS4.p2.7.m7.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.7.m7.1b"><apply id="S3.SS4.p2.7.m7.1.1.cmml" xref="S3.SS4.p2.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS4.p2.7.m7.1.1.1.cmml" xref="S3.SS4.p2.7.m7.1.1">subscript</csymbol><ci id="S3.SS4.p2.7.m7.1.1.2.cmml" xref="S3.SS4.p2.7.m7.1.1.2">𝐿</ci><cn id="S3.SS4.p2.7.m7.1.1.3.cmml" type="integer" xref="S3.SS4.p2.7.m7.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.7.m7.1c">L_{1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p2.7.m7.1d">italic_L start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math>-norm of the contribution made to <math alttext="\widehat{\phi}_{\mathcal{G}}(v_{i})" class="ltx_Math" display="inline" id="S3.SS4.p2.8.m8.1"><semantics id="S3.SS4.p2.8.m8.1a"><mrow id="S3.SS4.p2.8.m8.1.1" xref="S3.SS4.p2.8.m8.1.1.cmml"><msub id="S3.SS4.p2.8.m8.1.1.3" xref="S3.SS4.p2.8.m8.1.1.3.cmml"><mover accent="true" id="S3.SS4.p2.8.m8.1.1.3.2" xref="S3.SS4.p2.8.m8.1.1.3.2.cmml"><mi id="S3.SS4.p2.8.m8.1.1.3.2.2" xref="S3.SS4.p2.8.m8.1.1.3.2.2.cmml">ϕ</mi><mo id="S3.SS4.p2.8.m8.1.1.3.2.1" xref="S3.SS4.p2.8.m8.1.1.3.2.1.cmml">^</mo></mover><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p2.8.m8.1.1.3.3" xref="S3.SS4.p2.8.m8.1.1.3.3.cmml">𝒢</mi></msub><mo id="S3.SS4.p2.8.m8.1.1.2" xref="S3.SS4.p2.8.m8.1.1.2.cmml">⁢</mo><mrow id="S3.SS4.p2.8.m8.1.1.1.1" xref="S3.SS4.p2.8.m8.1.1.1.1.1.cmml"><mo id="S3.SS4.p2.8.m8.1.1.1.1.2" stretchy="false" xref="S3.SS4.p2.8.m8.1.1.1.1.1.cmml">(</mo><msub id="S3.SS4.p2.8.m8.1.1.1.1.1" xref="S3.SS4.p2.8.m8.1.1.1.1.1.cmml"><mi id="S3.SS4.p2.8.m8.1.1.1.1.1.2" xref="S3.SS4.p2.8.m8.1.1.1.1.1.2.cmml">v</mi><mi id="S3.SS4.p2.8.m8.1.1.1.1.1.3" xref="S3.SS4.p2.8.m8.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS4.p2.8.m8.1.1.1.1.3" stretchy="false" xref="S3.SS4.p2.8.m8.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.8.m8.1b"><apply id="S3.SS4.p2.8.m8.1.1.cmml" xref="S3.SS4.p2.8.m8.1.1"><times id="S3.SS4.p2.8.m8.1.1.2.cmml" xref="S3.SS4.p2.8.m8.1.1.2"></times><apply id="S3.SS4.p2.8.m8.1.1.3.cmml" xref="S3.SS4.p2.8.m8.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.p2.8.m8.1.1.3.1.cmml" xref="S3.SS4.p2.8.m8.1.1.3">subscript</csymbol><apply id="S3.SS4.p2.8.m8.1.1.3.2.cmml" xref="S3.SS4.p2.8.m8.1.1.3.2"><ci id="S3.SS4.p2.8.m8.1.1.3.2.1.cmml" xref="S3.SS4.p2.8.m8.1.1.3.2.1">^</ci><ci id="S3.SS4.p2.8.m8.1.1.3.2.2.cmml" xref="S3.SS4.p2.8.m8.1.1.3.2.2">italic-ϕ</ci></apply><ci id="S3.SS4.p2.8.m8.1.1.3.3.cmml" xref="S3.SS4.p2.8.m8.1.1.3.3">𝒢</ci></apply><apply id="S3.SS4.p2.8.m8.1.1.1.1.1.cmml" xref="S3.SS4.p2.8.m8.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p2.8.m8.1.1.1.1.1.1.cmml" xref="S3.SS4.p2.8.m8.1.1.1.1">subscript</csymbol><ci id="S3.SS4.p2.8.m8.1.1.1.1.1.2.cmml" xref="S3.SS4.p2.8.m8.1.1.1.1.1.2">𝑣</ci><ci id="S3.SS4.p2.8.m8.1.1.1.1.1.3.cmml" xref="S3.SS4.p2.8.m8.1.1.1.1.1.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.8.m8.1c">\widehat{\phi}_{\mathcal{G}}(v_{i})</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p2.8.m8.1d">over^ start_ARG italic_ϕ end_ARG start_POSTSUBSCRIPT caligraphic_G end_POSTSUBSCRIPT ( italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT )</annotation></semantics></math> and <math alttext="\widehat{\phi}_{\mathcal{G}}(v_{j})" class="ltx_Math" display="inline" id="S3.SS4.p2.9.m9.1"><semantics id="S3.SS4.p2.9.m9.1a"><mrow id="S3.SS4.p2.9.m9.1.1" xref="S3.SS4.p2.9.m9.1.1.cmml"><msub id="S3.SS4.p2.9.m9.1.1.3" xref="S3.SS4.p2.9.m9.1.1.3.cmml"><mover accent="true" id="S3.SS4.p2.9.m9.1.1.3.2" xref="S3.SS4.p2.9.m9.1.1.3.2.cmml"><mi id="S3.SS4.p2.9.m9.1.1.3.2.2" xref="S3.SS4.p2.9.m9.1.1.3.2.2.cmml">ϕ</mi><mo id="S3.SS4.p2.9.m9.1.1.3.2.1" xref="S3.SS4.p2.9.m9.1.1.3.2.1.cmml">^</mo></mover><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p2.9.m9.1.1.3.3" xref="S3.SS4.p2.9.m9.1.1.3.3.cmml">𝒢</mi></msub><mo id="S3.SS4.p2.9.m9.1.1.2" xref="S3.SS4.p2.9.m9.1.1.2.cmml">⁢</mo><mrow id="S3.SS4.p2.9.m9.1.1.1.1" xref="S3.SS4.p2.9.m9.1.1.1.1.1.cmml"><mo id="S3.SS4.p2.9.m9.1.1.1.1.2" stretchy="false" xref="S3.SS4.p2.9.m9.1.1.1.1.1.cmml">(</mo><msub id="S3.SS4.p2.9.m9.1.1.1.1.1" xref="S3.SS4.p2.9.m9.1.1.1.1.1.cmml"><mi id="S3.SS4.p2.9.m9.1.1.1.1.1.2" xref="S3.SS4.p2.9.m9.1.1.1.1.1.2.cmml">v</mi><mi id="S3.SS4.p2.9.m9.1.1.1.1.1.3" xref="S3.SS4.p2.9.m9.1.1.1.1.1.3.cmml">j</mi></msub><mo id="S3.SS4.p2.9.m9.1.1.1.1.3" stretchy="false" xref="S3.SS4.p2.9.m9.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.9.m9.1b"><apply id="S3.SS4.p2.9.m9.1.1.cmml" xref="S3.SS4.p2.9.m9.1.1"><times id="S3.SS4.p2.9.m9.1.1.2.cmml" xref="S3.SS4.p2.9.m9.1.1.2"></times><apply id="S3.SS4.p2.9.m9.1.1.3.cmml" xref="S3.SS4.p2.9.m9.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.p2.9.m9.1.1.3.1.cmml" xref="S3.SS4.p2.9.m9.1.1.3">subscript</csymbol><apply id="S3.SS4.p2.9.m9.1.1.3.2.cmml" xref="S3.SS4.p2.9.m9.1.1.3.2"><ci id="S3.SS4.p2.9.m9.1.1.3.2.1.cmml" xref="S3.SS4.p2.9.m9.1.1.3.2.1">^</ci><ci id="S3.SS4.p2.9.m9.1.1.3.2.2.cmml" xref="S3.SS4.p2.9.m9.1.1.3.2.2">italic-ϕ</ci></apply><ci id="S3.SS4.p2.9.m9.1.1.3.3.cmml" xref="S3.SS4.p2.9.m9.1.1.3.3">𝒢</ci></apply><apply id="S3.SS4.p2.9.m9.1.1.1.1.1.cmml" xref="S3.SS4.p2.9.m9.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p2.9.m9.1.1.1.1.1.1.cmml" xref="S3.SS4.p2.9.m9.1.1.1.1">subscript</csymbol><ci id="S3.SS4.p2.9.m9.1.1.1.1.1.2.cmml" xref="S3.SS4.p2.9.m9.1.1.1.1.1.2">𝑣</ci><ci id="S3.SS4.p2.9.m9.1.1.1.1.1.3.cmml" xref="S3.SS4.p2.9.m9.1.1.1.1.1.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.9.m9.1c">\widehat{\phi}_{\mathcal{G}}(v_{j})</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p2.9.m9.1d">over^ start_ARG italic_ϕ end_ARG start_POSTSUBSCRIPT caligraphic_G end_POSTSUBSCRIPT ( italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT )</annotation></semantics></math>.
This allows us to bound the change in the estimator <math alttext="\widehat{\phi}_{\mathcal{G}}(v_{i})^{\top}\widehat{\phi}_{\mathcal{G}}(v_{j})" class="ltx_Math" display="inline" id="S3.SS4.p2.10.m10.2"><semantics id="S3.SS4.p2.10.m10.2a"><mrow id="S3.SS4.p2.10.m10.2.2" xref="S3.SS4.p2.10.m10.2.2.cmml"><msub id="S3.SS4.p2.10.m10.2.2.4" xref="S3.SS4.p2.10.m10.2.2.4.cmml"><mover accent="true" id="S3.SS4.p2.10.m10.2.2.4.2" xref="S3.SS4.p2.10.m10.2.2.4.2.cmml"><mi id="S3.SS4.p2.10.m10.2.2.4.2.2" xref="S3.SS4.p2.10.m10.2.2.4.2.2.cmml">ϕ</mi><mo id="S3.SS4.p2.10.m10.2.2.4.2.1" xref="S3.SS4.p2.10.m10.2.2.4.2.1.cmml">^</mo></mover><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p2.10.m10.2.2.4.3" xref="S3.SS4.p2.10.m10.2.2.4.3.cmml">𝒢</mi></msub><mo id="S3.SS4.p2.10.m10.2.2.3" xref="S3.SS4.p2.10.m10.2.2.3.cmml">⁢</mo><msup id="S3.SS4.p2.10.m10.1.1.1" xref="S3.SS4.p2.10.m10.1.1.1.cmml"><mrow id="S3.SS4.p2.10.m10.1.1.1.1.1" xref="S3.SS4.p2.10.m10.1.1.1.1.1.1.cmml"><mo id="S3.SS4.p2.10.m10.1.1.1.1.1.2" stretchy="false" xref="S3.SS4.p2.10.m10.1.1.1.1.1.1.cmml">(</mo><msub id="S3.SS4.p2.10.m10.1.1.1.1.1.1" xref="S3.SS4.p2.10.m10.1.1.1.1.1.1.cmml"><mi id="S3.SS4.p2.10.m10.1.1.1.1.1.1.2" xref="S3.SS4.p2.10.m10.1.1.1.1.1.1.2.cmml">v</mi><mi id="S3.SS4.p2.10.m10.1.1.1.1.1.1.3" xref="S3.SS4.p2.10.m10.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS4.p2.10.m10.1.1.1.1.1.3" stretchy="false" xref="S3.SS4.p2.10.m10.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.SS4.p2.10.m10.1.1.1.3" xref="S3.SS4.p2.10.m10.1.1.1.3.cmml">⊤</mo></msup><mo id="S3.SS4.p2.10.m10.2.2.3a" xref="S3.SS4.p2.10.m10.2.2.3.cmml">⁢</mo><msub id="S3.SS4.p2.10.m10.2.2.5" xref="S3.SS4.p2.10.m10.2.2.5.cmml"><mover accent="true" id="S3.SS4.p2.10.m10.2.2.5.2" xref="S3.SS4.p2.10.m10.2.2.5.2.cmml"><mi id="S3.SS4.p2.10.m10.2.2.5.2.2" xref="S3.SS4.p2.10.m10.2.2.5.2.2.cmml">ϕ</mi><mo id="S3.SS4.p2.10.m10.2.2.5.2.1" xref="S3.SS4.p2.10.m10.2.2.5.2.1.cmml">^</mo></mover><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p2.10.m10.2.2.5.3" xref="S3.SS4.p2.10.m10.2.2.5.3.cmml">𝒢</mi></msub><mo id="S3.SS4.p2.10.m10.2.2.3b" xref="S3.SS4.p2.10.m10.2.2.3.cmml">⁢</mo><mrow id="S3.SS4.p2.10.m10.2.2.2.1" xref="S3.SS4.p2.10.m10.2.2.2.1.1.cmml"><mo id="S3.SS4.p2.10.m10.2.2.2.1.2" stretchy="false" xref="S3.SS4.p2.10.m10.2.2.2.1.1.cmml">(</mo><msub id="S3.SS4.p2.10.m10.2.2.2.1.1" xref="S3.SS4.p2.10.m10.2.2.2.1.1.cmml"><mi id="S3.SS4.p2.10.m10.2.2.2.1.1.2" xref="S3.SS4.p2.10.m10.2.2.2.1.1.2.cmml">v</mi><mi id="S3.SS4.p2.10.m10.2.2.2.1.1.3" xref="S3.SS4.p2.10.m10.2.2.2.1.1.3.cmml">j</mi></msub><mo id="S3.SS4.p2.10.m10.2.2.2.1.3" stretchy="false" xref="S3.SS4.p2.10.m10.2.2.2.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.10.m10.2b"><apply id="S3.SS4.p2.10.m10.2.2.cmml" xref="S3.SS4.p2.10.m10.2.2"><times id="S3.SS4.p2.10.m10.2.2.3.cmml" xref="S3.SS4.p2.10.m10.2.2.3"></times><apply id="S3.SS4.p2.10.m10.2.2.4.cmml" xref="S3.SS4.p2.10.m10.2.2.4"><csymbol cd="ambiguous" id="S3.SS4.p2.10.m10.2.2.4.1.cmml" xref="S3.SS4.p2.10.m10.2.2.4">subscript</csymbol><apply id="S3.SS4.p2.10.m10.2.2.4.2.cmml" xref="S3.SS4.p2.10.m10.2.2.4.2"><ci id="S3.SS4.p2.10.m10.2.2.4.2.1.cmml" xref="S3.SS4.p2.10.m10.2.2.4.2.1">^</ci><ci id="S3.SS4.p2.10.m10.2.2.4.2.2.cmml" xref="S3.SS4.p2.10.m10.2.2.4.2.2">italic-ϕ</ci></apply><ci id="S3.SS4.p2.10.m10.2.2.4.3.cmml" xref="S3.SS4.p2.10.m10.2.2.4.3">𝒢</ci></apply><apply id="S3.SS4.p2.10.m10.1.1.1.cmml" xref="S3.SS4.p2.10.m10.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p2.10.m10.1.1.1.2.cmml" xref="S3.SS4.p2.10.m10.1.1.1">superscript</csymbol><apply id="S3.SS4.p2.10.m10.1.1.1.1.1.1.cmml" xref="S3.SS4.p2.10.m10.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p2.10.m10.1.1.1.1.1.1.1.cmml" xref="S3.SS4.p2.10.m10.1.1.1.1.1">subscript</csymbol><ci id="S3.SS4.p2.10.m10.1.1.1.1.1.1.2.cmml" xref="S3.SS4.p2.10.m10.1.1.1.1.1.1.2">𝑣</ci><ci id="S3.SS4.p2.10.m10.1.1.1.1.1.1.3.cmml" xref="S3.SS4.p2.10.m10.1.1.1.1.1.1.3">𝑖</ci></apply><csymbol cd="latexml" id="S3.SS4.p2.10.m10.1.1.1.3.cmml" xref="S3.SS4.p2.10.m10.1.1.1.3">top</csymbol></apply><apply id="S3.SS4.p2.10.m10.2.2.5.cmml" xref="S3.SS4.p2.10.m10.2.2.5"><csymbol cd="ambiguous" id="S3.SS4.p2.10.m10.2.2.5.1.cmml" xref="S3.SS4.p2.10.m10.2.2.5">subscript</csymbol><apply id="S3.SS4.p2.10.m10.2.2.5.2.cmml" xref="S3.SS4.p2.10.m10.2.2.5.2"><ci id="S3.SS4.p2.10.m10.2.2.5.2.1.cmml" xref="S3.SS4.p2.10.m10.2.2.5.2.1">^</ci><ci id="S3.SS4.p2.10.m10.2.2.5.2.2.cmml" xref="S3.SS4.p2.10.m10.2.2.5.2.2">italic-ϕ</ci></apply><ci id="S3.SS4.p2.10.m10.2.2.5.3.cmml" xref="S3.SS4.p2.10.m10.2.2.5.3">𝒢</ci></apply><apply id="S3.SS4.p2.10.m10.2.2.2.1.1.cmml" xref="S3.SS4.p2.10.m10.2.2.2.1"><csymbol cd="ambiguous" id="S3.SS4.p2.10.m10.2.2.2.1.1.1.cmml" xref="S3.SS4.p2.10.m10.2.2.2.1">subscript</csymbol><ci id="S3.SS4.p2.10.m10.2.2.2.1.1.2.cmml" xref="S3.SS4.p2.10.m10.2.2.2.1.1.2">𝑣</ci><ci id="S3.SS4.p2.10.m10.2.2.2.1.1.3.cmml" xref="S3.SS4.p2.10.m10.2.2.2.1.1.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.10.m10.2c">\widehat{\phi}_{\mathcal{G}}(v_{i})^{\top}\widehat{\phi}_{\mathcal{G}}(v_{j})</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p2.10.m10.2d">over^ start_ARG italic_ϕ end_ARG start_POSTSUBSCRIPT caligraphic_G end_POSTSUBSCRIPT ( italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT over^ start_ARG italic_ϕ end_ARG start_POSTSUBSCRIPT caligraphic_G end_POSTSUBSCRIPT ( italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT )</annotation></semantics></math> if <math alttext="X_{k}" class="ltx_Math" display="inline" id="S3.SS4.p2.11.m11.1"><semantics id="S3.SS4.p2.11.m11.1a"><msub id="S3.SS4.p2.11.m11.1.1" xref="S3.SS4.p2.11.m11.1.1.cmml"><mi id="S3.SS4.p2.11.m11.1.1.2" xref="S3.SS4.p2.11.m11.1.1.2.cmml">X</mi><mi id="S3.SS4.p2.11.m11.1.1.3" xref="S3.SS4.p2.11.m11.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.11.m11.1b"><apply id="S3.SS4.p2.11.m11.1.1.cmml" xref="S3.SS4.p2.11.m11.1.1"><csymbol cd="ambiguous" id="S3.SS4.p2.11.m11.1.1.1.cmml" xref="S3.SS4.p2.11.m11.1.1">subscript</csymbol><ci id="S3.SS4.p2.11.m11.1.1.2.cmml" xref="S3.SS4.p2.11.m11.1.1.2">𝑋</ci><ci id="S3.SS4.p2.11.m11.1.1.3.cmml" xref="S3.SS4.p2.11.m11.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.11.m11.1c">X_{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p2.11.m11.1d">italic_X start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> is modified.
Applying McDiarmid’s inequality, the result follows. ∎</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="S3.SS4.p3">
<p class="ltx_p" id="S3.SS4.p3.5">Thm <a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#S3.Thmtheorem1" title="Theorem 3.1 (GRF exponential concentration bounds). ‣ 3.4 Novel theoretical results for GRFs: sharp estimators with sparse features ‣ 3 Towards linear topological masking ‣ Linear Transformer Topological Masking with Graph Random Features"><span class="ltx_text ltx_ref_tag">3.1</span></a> provides an exponential bound on the probability of a topological mask estimate deviating from its true value.
Moreover, assuming that <math alttext="c" class="ltx_Math" display="inline" id="S3.SS4.p3.1.m1.1"><semantics id="S3.SS4.p3.1.m1.1a"><mi id="S3.SS4.p3.1.m1.1.1" xref="S3.SS4.p3.1.m1.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.1.m1.1b"><ci id="S3.SS4.p3.1.m1.1.1.cmml" xref="S3.SS4.p3.1.m1.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.1.m1.1c">c</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p3.1.m1.1d">italic_c</annotation></semantics></math> remains constant (i.e.&nbsp;we fix a maximum edge weight and node degree as the graph grows), this probability is <em class="ltx_emph ltx_font_italic" id="S3.SS4.p3.2.1">independent of the number of nodes <math alttext="N" class="ltx_Math" display="inline" id="S3.SS4.p3.2.1.m1.1"><semantics id="S3.SS4.p3.2.1.m1.1a"><mi id="S3.SS4.p3.2.1.m1.1.1" xref="S3.SS4.p3.2.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.2.1.m1.1b"><ci id="S3.SS4.p3.2.1.m1.1.1.cmml" xref="S3.SS4.p3.2.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.2.1.m1.1c">N</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p3.2.1.m1.1d">italic_N</annotation></semantics></math></em>.
Therefore, if we fix <math alttext="t" class="ltx_Math" display="inline" id="S3.SS4.p3.3.m2.1"><semantics id="S3.SS4.p3.3.m2.1a"><mi id="S3.SS4.p3.3.m2.1.1" xref="S3.SS4.p3.3.m2.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.3.m2.1b"><ci id="S3.SS4.p3.3.m2.1.1.cmml" xref="S3.SS4.p3.3.m2.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.3.m2.1c">t</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p3.3.m2.1d">italic_t</annotation></semantics></math> and the probability <span class="ltx_text ltx_markedasmath" id="S3.SS4.p3.5.2">Pr</span>, we can solve for the minimum number of walkers <math alttext="n" class="ltx_Math" display="inline" id="S3.SS4.p3.5.m4.1"><semantics id="S3.SS4.p3.5.m4.1a"><mi id="S3.SS4.p3.5.m4.1.1" xref="S3.SS4.p3.5.m4.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.5.m4.1b"><ci id="S3.SS4.p3.5.m4.1.1.cmml" xref="S3.SS4.p3.5.m4.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.5.m4.1c">n</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p3.5.m4.1d">italic_n</annotation></semantics></math> to guarantee a good mask estimate with high probability, independent of graph size.
Now observe the following.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_theorem ltx_theorem_lemma" id="S3.Thmtheorem2">
<h6 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span class="ltx_text ltx_font_bold" id="S3.Thmtheorem2.1.1.1">Lemma 3.2</span></span><span class="ltx_text ltx_font_bold" id="S3.Thmtheorem2.2.2"> </span>(GRF sparsity)<span class="ltx_text ltx_font_bold" id="S3.Thmtheorem2.3.3">.</span>
</h6><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S3.Thmtheorem2.p1">
<p class="ltx_p" id="S3.Thmtheorem2.p1.6"><span class="ltx_text ltx_font_italic" id="S3.Thmtheorem2.p1.6.6">Consider a graph random feature <math alttext="\widehat{\phi}_{\mathcal{G}}(v_{i})" class="ltx_Math" display="inline" id="S3.Thmtheorem2.p1.1.1.m1.1"><semantics id="S3.Thmtheorem2.p1.1.1.m1.1a"><mrow id="S3.Thmtheorem2.p1.1.1.m1.1.1" xref="S3.Thmtheorem2.p1.1.1.m1.1.1.cmml"><msub id="S3.Thmtheorem2.p1.1.1.m1.1.1.3" xref="S3.Thmtheorem2.p1.1.1.m1.1.1.3.cmml"><mover accent="true" id="S3.Thmtheorem2.p1.1.1.m1.1.1.3.2" xref="S3.Thmtheorem2.p1.1.1.m1.1.1.3.2.cmml"><mi id="S3.Thmtheorem2.p1.1.1.m1.1.1.3.2.2" xref="S3.Thmtheorem2.p1.1.1.m1.1.1.3.2.2.cmml">ϕ</mi><mo id="S3.Thmtheorem2.p1.1.1.m1.1.1.3.2.1" xref="S3.Thmtheorem2.p1.1.1.m1.1.1.3.2.1.cmml">^</mo></mover><mi class="ltx_font_mathcaligraphic" id="S3.Thmtheorem2.p1.1.1.m1.1.1.3.3" xref="S3.Thmtheorem2.p1.1.1.m1.1.1.3.3.cmml">𝒢</mi></msub><mo id="S3.Thmtheorem2.p1.1.1.m1.1.1.2" xref="S3.Thmtheorem2.p1.1.1.m1.1.1.2.cmml">⁢</mo><mrow id="S3.Thmtheorem2.p1.1.1.m1.1.1.1.1" xref="S3.Thmtheorem2.p1.1.1.m1.1.1.1.1.1.cmml"><mo id="S3.Thmtheorem2.p1.1.1.m1.1.1.1.1.2" stretchy="false" xref="S3.Thmtheorem2.p1.1.1.m1.1.1.1.1.1.cmml">(</mo><msub id="S3.Thmtheorem2.p1.1.1.m1.1.1.1.1.1" xref="S3.Thmtheorem2.p1.1.1.m1.1.1.1.1.1.cmml"><mi id="S3.Thmtheorem2.p1.1.1.m1.1.1.1.1.1.2" xref="S3.Thmtheorem2.p1.1.1.m1.1.1.1.1.1.2.cmml">v</mi><mi id="S3.Thmtheorem2.p1.1.1.m1.1.1.1.1.1.3" xref="S3.Thmtheorem2.p1.1.1.m1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.Thmtheorem2.p1.1.1.m1.1.1.1.1.3" stretchy="false" xref="S3.Thmtheorem2.p1.1.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Thmtheorem2.p1.1.1.m1.1b"><apply id="S3.Thmtheorem2.p1.1.1.m1.1.1.cmml" xref="S3.Thmtheorem2.p1.1.1.m1.1.1"><times id="S3.Thmtheorem2.p1.1.1.m1.1.1.2.cmml" xref="S3.Thmtheorem2.p1.1.1.m1.1.1.2"></times><apply id="S3.Thmtheorem2.p1.1.1.m1.1.1.3.cmml" xref="S3.Thmtheorem2.p1.1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.Thmtheorem2.p1.1.1.m1.1.1.3.1.cmml" xref="S3.Thmtheorem2.p1.1.1.m1.1.1.3">subscript</csymbol><apply id="S3.Thmtheorem2.p1.1.1.m1.1.1.3.2.cmml" xref="S3.Thmtheorem2.p1.1.1.m1.1.1.3.2"><ci id="S3.Thmtheorem2.p1.1.1.m1.1.1.3.2.1.cmml" xref="S3.Thmtheorem2.p1.1.1.m1.1.1.3.2.1">^</ci><ci id="S3.Thmtheorem2.p1.1.1.m1.1.1.3.2.2.cmml" xref="S3.Thmtheorem2.p1.1.1.m1.1.1.3.2.2">italic-ϕ</ci></apply><ci id="S3.Thmtheorem2.p1.1.1.m1.1.1.3.3.cmml" xref="S3.Thmtheorem2.p1.1.1.m1.1.1.3.3">𝒢</ci></apply><apply id="S3.Thmtheorem2.p1.1.1.m1.1.1.1.1.1.cmml" xref="S3.Thmtheorem2.p1.1.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Thmtheorem2.p1.1.1.m1.1.1.1.1.1.1.cmml" xref="S3.Thmtheorem2.p1.1.1.m1.1.1.1.1">subscript</csymbol><ci id="S3.Thmtheorem2.p1.1.1.m1.1.1.1.1.1.2.cmml" xref="S3.Thmtheorem2.p1.1.1.m1.1.1.1.1.1.2">𝑣</ci><ci id="S3.Thmtheorem2.p1.1.1.m1.1.1.1.1.1.3.cmml" xref="S3.Thmtheorem2.p1.1.1.m1.1.1.1.1.1.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmtheorem2.p1.1.1.m1.1c">\widehat{\phi}_{\mathcal{G}}(v_{i})</annotation><annotation encoding="application/x-llamapun" id="S3.Thmtheorem2.p1.1.1.m1.1d">over^ start_ARG italic_ϕ end_ARG start_POSTSUBSCRIPT caligraphic_G end_POSTSUBSCRIPT ( italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT )</annotation></semantics></math> constructed using <math alttext="m" class="ltx_Math" display="inline" id="S3.Thmtheorem2.p1.2.2.m2.1"><semantics id="S3.Thmtheorem2.p1.2.2.m2.1a"><mi id="S3.Thmtheorem2.p1.2.2.m2.1.1" xref="S3.Thmtheorem2.p1.2.2.m2.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S3.Thmtheorem2.p1.2.2.m2.1b"><ci id="S3.Thmtheorem2.p1.2.2.m2.1.1.cmml" xref="S3.Thmtheorem2.p1.2.2.m2.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmtheorem2.p1.2.2.m2.1c">m</annotation><annotation encoding="application/x-llamapun" id="S3.Thmtheorem2.p1.2.2.m2.1d">italic_m</annotation></semantics></math> random walkers each terminating with probability <math alttext="p_{\textrm{halt}}" class="ltx_Math" display="inline" id="S3.Thmtheorem2.p1.3.3.m3.1"><semantics id="S3.Thmtheorem2.p1.3.3.m3.1a"><msub id="S3.Thmtheorem2.p1.3.3.m3.1.1" xref="S3.Thmtheorem2.p1.3.3.m3.1.1.cmml"><mi id="S3.Thmtheorem2.p1.3.3.m3.1.1.2" xref="S3.Thmtheorem2.p1.3.3.m3.1.1.2.cmml">p</mi><mtext class="ltx_mathvariant_italic" id="S3.Thmtheorem2.p1.3.3.m3.1.1.3" xref="S3.Thmtheorem2.p1.3.3.m3.1.1.3a.cmml">halt</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.Thmtheorem2.p1.3.3.m3.1b"><apply id="S3.Thmtheorem2.p1.3.3.m3.1.1.cmml" xref="S3.Thmtheorem2.p1.3.3.m3.1.1"><csymbol cd="ambiguous" id="S3.Thmtheorem2.p1.3.3.m3.1.1.1.cmml" xref="S3.Thmtheorem2.p1.3.3.m3.1.1">subscript</csymbol><ci id="S3.Thmtheorem2.p1.3.3.m3.1.1.2.cmml" xref="S3.Thmtheorem2.p1.3.3.m3.1.1.2">𝑝</ci><ci id="S3.Thmtheorem2.p1.3.3.m3.1.1.3a.cmml" xref="S3.Thmtheorem2.p1.3.3.m3.1.1.3"><mtext class="ltx_mathvariant_italic" id="S3.Thmtheorem2.p1.3.3.m3.1.1.3.cmml" mathsize="70%" xref="S3.Thmtheorem2.p1.3.3.m3.1.1.3">halt</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmtheorem2.p1.3.3.m3.1c">p_{\textrm{halt}}</annotation><annotation encoding="application/x-llamapun" id="S3.Thmtheorem2.p1.3.3.m3.1d">italic_p start_POSTSUBSCRIPT halt end_POSTSUBSCRIPT</annotation></semantics></math> at every timestep.
With probability at least <math alttext="1-\delta" class="ltx_Math" display="inline" id="S3.Thmtheorem2.p1.4.4.m4.1"><semantics id="S3.Thmtheorem2.p1.4.4.m4.1a"><mrow id="S3.Thmtheorem2.p1.4.4.m4.1.1" xref="S3.Thmtheorem2.p1.4.4.m4.1.1.cmml"><mn id="S3.Thmtheorem2.p1.4.4.m4.1.1.2" xref="S3.Thmtheorem2.p1.4.4.m4.1.1.2.cmml">1</mn><mo id="S3.Thmtheorem2.p1.4.4.m4.1.1.1" xref="S3.Thmtheorem2.p1.4.4.m4.1.1.1.cmml">−</mo><mi id="S3.Thmtheorem2.p1.4.4.m4.1.1.3" xref="S3.Thmtheorem2.p1.4.4.m4.1.1.3.cmml">δ</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.Thmtheorem2.p1.4.4.m4.1b"><apply id="S3.Thmtheorem2.p1.4.4.m4.1.1.cmml" xref="S3.Thmtheorem2.p1.4.4.m4.1.1"><minus id="S3.Thmtheorem2.p1.4.4.m4.1.1.1.cmml" xref="S3.Thmtheorem2.p1.4.4.m4.1.1.1"></minus><cn id="S3.Thmtheorem2.p1.4.4.m4.1.1.2.cmml" type="integer" xref="S3.Thmtheorem2.p1.4.4.m4.1.1.2">1</cn><ci id="S3.Thmtheorem2.p1.4.4.m4.1.1.3.cmml" xref="S3.Thmtheorem2.p1.4.4.m4.1.1.3">𝛿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmtheorem2.p1.4.4.m4.1c">1-\delta</annotation><annotation encoding="application/x-llamapun" id="S3.Thmtheorem2.p1.4.4.m4.1d">1 - italic_δ</annotation></semantics></math>, <math alttext="\widehat{\phi}_{\mathcal{G}}(v_{i})" class="ltx_Math" display="inline" id="S3.Thmtheorem2.p1.5.5.m5.1"><semantics id="S3.Thmtheorem2.p1.5.5.m5.1a"><mrow id="S3.Thmtheorem2.p1.5.5.m5.1.1" xref="S3.Thmtheorem2.p1.5.5.m5.1.1.cmml"><msub id="S3.Thmtheorem2.p1.5.5.m5.1.1.3" xref="S3.Thmtheorem2.p1.5.5.m5.1.1.3.cmml"><mover accent="true" id="S3.Thmtheorem2.p1.5.5.m5.1.1.3.2" xref="S3.Thmtheorem2.p1.5.5.m5.1.1.3.2.cmml"><mi id="S3.Thmtheorem2.p1.5.5.m5.1.1.3.2.2" xref="S3.Thmtheorem2.p1.5.5.m5.1.1.3.2.2.cmml">ϕ</mi><mo id="S3.Thmtheorem2.p1.5.5.m5.1.1.3.2.1" xref="S3.Thmtheorem2.p1.5.5.m5.1.1.3.2.1.cmml">^</mo></mover><mi class="ltx_font_mathcaligraphic" id="S3.Thmtheorem2.p1.5.5.m5.1.1.3.3" xref="S3.Thmtheorem2.p1.5.5.m5.1.1.3.3.cmml">𝒢</mi></msub><mo id="S3.Thmtheorem2.p1.5.5.m5.1.1.2" xref="S3.Thmtheorem2.p1.5.5.m5.1.1.2.cmml">⁢</mo><mrow id="S3.Thmtheorem2.p1.5.5.m5.1.1.1.1" xref="S3.Thmtheorem2.p1.5.5.m5.1.1.1.1.1.cmml"><mo id="S3.Thmtheorem2.p1.5.5.m5.1.1.1.1.2" stretchy="false" xref="S3.Thmtheorem2.p1.5.5.m5.1.1.1.1.1.cmml">(</mo><msub id="S3.Thmtheorem2.p1.5.5.m5.1.1.1.1.1" xref="S3.Thmtheorem2.p1.5.5.m5.1.1.1.1.1.cmml"><mi id="S3.Thmtheorem2.p1.5.5.m5.1.1.1.1.1.2" xref="S3.Thmtheorem2.p1.5.5.m5.1.1.1.1.1.2.cmml">v</mi><mi id="S3.Thmtheorem2.p1.5.5.m5.1.1.1.1.1.3" xref="S3.Thmtheorem2.p1.5.5.m5.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.Thmtheorem2.p1.5.5.m5.1.1.1.1.3" stretchy="false" xref="S3.Thmtheorem2.p1.5.5.m5.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Thmtheorem2.p1.5.5.m5.1b"><apply id="S3.Thmtheorem2.p1.5.5.m5.1.1.cmml" xref="S3.Thmtheorem2.p1.5.5.m5.1.1"><times id="S3.Thmtheorem2.p1.5.5.m5.1.1.2.cmml" xref="S3.Thmtheorem2.p1.5.5.m5.1.1.2"></times><apply id="S3.Thmtheorem2.p1.5.5.m5.1.1.3.cmml" xref="S3.Thmtheorem2.p1.5.5.m5.1.1.3"><csymbol cd="ambiguous" id="S3.Thmtheorem2.p1.5.5.m5.1.1.3.1.cmml" xref="S3.Thmtheorem2.p1.5.5.m5.1.1.3">subscript</csymbol><apply id="S3.Thmtheorem2.p1.5.5.m5.1.1.3.2.cmml" xref="S3.Thmtheorem2.p1.5.5.m5.1.1.3.2"><ci id="S3.Thmtheorem2.p1.5.5.m5.1.1.3.2.1.cmml" xref="S3.Thmtheorem2.p1.5.5.m5.1.1.3.2.1">^</ci><ci id="S3.Thmtheorem2.p1.5.5.m5.1.1.3.2.2.cmml" xref="S3.Thmtheorem2.p1.5.5.m5.1.1.3.2.2">italic-ϕ</ci></apply><ci id="S3.Thmtheorem2.p1.5.5.m5.1.1.3.3.cmml" xref="S3.Thmtheorem2.p1.5.5.m5.1.1.3.3">𝒢</ci></apply><apply id="S3.Thmtheorem2.p1.5.5.m5.1.1.1.1.1.cmml" xref="S3.Thmtheorem2.p1.5.5.m5.1.1.1.1"><csymbol cd="ambiguous" id="S3.Thmtheorem2.p1.5.5.m5.1.1.1.1.1.1.cmml" xref="S3.Thmtheorem2.p1.5.5.m5.1.1.1.1">subscript</csymbol><ci id="S3.Thmtheorem2.p1.5.5.m5.1.1.1.1.1.2.cmml" xref="S3.Thmtheorem2.p1.5.5.m5.1.1.1.1.1.2">𝑣</ci><ci id="S3.Thmtheorem2.p1.5.5.m5.1.1.1.1.1.3.cmml" xref="S3.Thmtheorem2.p1.5.5.m5.1.1.1.1.1.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmtheorem2.p1.5.5.m5.1c">\widehat{\phi}_{\mathcal{G}}(v_{i})</annotation><annotation encoding="application/x-llamapun" id="S3.Thmtheorem2.p1.5.5.m5.1d">over^ start_ARG italic_ϕ end_ARG start_POSTSUBSCRIPT caligraphic_G end_POSTSUBSCRIPT ( italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT )</annotation></semantics></math> will have <math alttext="n\log(1-(1-\delta)^{1/n})\log(1-p_{\textrm{halt}})^{-1}" class="ltx_math_unparsed" display="inline" id="S3.Thmtheorem2.p1.6.6.m6.2"><semantics id="S3.Thmtheorem2.p1.6.6.m6.2a"><mrow id="S3.Thmtheorem2.p1.6.6.m6.2b"><mi id="S3.Thmtheorem2.p1.6.6.m6.2.3">n</mi><mi id="S3.Thmtheorem2.p1.6.6.m6.1.1">log</mi><mrow id="S3.Thmtheorem2.p1.6.6.m6.2.4"><mo id="S3.Thmtheorem2.p1.6.6.m6.2.4.1" stretchy="false">(</mo><mn id="S3.Thmtheorem2.p1.6.6.m6.2.4.2">1</mn><mo id="S3.Thmtheorem2.p1.6.6.m6.2.4.3">−</mo><msup id="S3.Thmtheorem2.p1.6.6.m6.2.4.4"><mrow id="S3.Thmtheorem2.p1.6.6.m6.2.4.4.2"><mo id="S3.Thmtheorem2.p1.6.6.m6.2.4.4.2.1" stretchy="false">(</mo><mn id="S3.Thmtheorem2.p1.6.6.m6.2.4.4.2.2">1</mn><mo id="S3.Thmtheorem2.p1.6.6.m6.2.4.4.2.3">−</mo><mi id="S3.Thmtheorem2.p1.6.6.m6.2.4.4.2.4">δ</mi><mo id="S3.Thmtheorem2.p1.6.6.m6.2.4.4.2.5" stretchy="false">)</mo></mrow><mrow id="S3.Thmtheorem2.p1.6.6.m6.2.4.4.3"><mn id="S3.Thmtheorem2.p1.6.6.m6.2.4.4.3.2">1</mn><mo id="S3.Thmtheorem2.p1.6.6.m6.2.4.4.3.1">/</mo><mi id="S3.Thmtheorem2.p1.6.6.m6.2.4.4.3.3">n</mi></mrow></msup><mo id="S3.Thmtheorem2.p1.6.6.m6.2.4.5" rspace="0.167em" stretchy="false">)</mo></mrow><mi id="S3.Thmtheorem2.p1.6.6.m6.2.2">log</mi><msup id="S3.Thmtheorem2.p1.6.6.m6.2.5"><mrow id="S3.Thmtheorem2.p1.6.6.m6.2.5.2"><mo id="S3.Thmtheorem2.p1.6.6.m6.2.5.2.1" stretchy="false">(</mo><mn id="S3.Thmtheorem2.p1.6.6.m6.2.5.2.2">1</mn><mo id="S3.Thmtheorem2.p1.6.6.m6.2.5.2.3">−</mo><msub id="S3.Thmtheorem2.p1.6.6.m6.2.5.2.4"><mi id="S3.Thmtheorem2.p1.6.6.m6.2.5.2.4.2">p</mi><mtext class="ltx_mathvariant_italic" id="S3.Thmtheorem2.p1.6.6.m6.2.5.2.4.3">halt</mtext></msub><mo id="S3.Thmtheorem2.p1.6.6.m6.2.5.2.5" stretchy="false">)</mo></mrow><mrow id="S3.Thmtheorem2.p1.6.6.m6.2.5.3"><mo id="S3.Thmtheorem2.p1.6.6.m6.2.5.3a">−</mo><mn id="S3.Thmtheorem2.p1.6.6.m6.2.5.3.2">1</mn></mrow></msup></mrow><annotation encoding="application/x-tex" id="S3.Thmtheorem2.p1.6.6.m6.2c">n\log(1-(1-\delta)^{1/n})\log(1-p_{\textrm{halt}})^{-1}</annotation><annotation encoding="application/x-llamapun" id="S3.Thmtheorem2.p1.6.6.m6.2d">italic_n roman_log ( 1 - ( 1 - italic_δ ) start_POSTSUPERSCRIPT 1 / italic_n end_POSTSUPERSCRIPT ) roman_log ( 1 - italic_p start_POSTSUBSCRIPT halt end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT</annotation></semantics></math> or fewer nonzero entries.</span></p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS4.p4">
<p class="ltx_p" id="S3.SS4.p4.9"><em class="ltx_emph ltx_font_italic" id="S3.SS4.p4.9.1">Proof.</em>
Since the walk lengths are geometrically distributed, the probability that a single walk is of length <math alttext="b" class="ltx_Math" display="inline" id="S3.SS4.p4.1.m1.1"><semantics id="S3.SS4.p4.1.m1.1a"><mi id="S3.SS4.p4.1.m1.1.1" xref="S3.SS4.p4.1.m1.1.1.cmml">b</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p4.1.m1.1b"><ci id="S3.SS4.p4.1.m1.1.1.cmml" xref="S3.SS4.p4.1.m1.1.1">𝑏</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p4.1.m1.1c">b</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p4.1.m1.1d">italic_b</annotation></semantics></math> or shorter is <math alttext="1-(1-p_{\textrm{halt}})^{b}" class="ltx_Math" display="inline" id="S3.SS4.p4.2.m2.1"><semantics id="S3.SS4.p4.2.m2.1a"><mrow id="S3.SS4.p4.2.m2.1.1" xref="S3.SS4.p4.2.m2.1.1.cmml"><mn id="S3.SS4.p4.2.m2.1.1.3" xref="S3.SS4.p4.2.m2.1.1.3.cmml">1</mn><mo id="S3.SS4.p4.2.m2.1.1.2" xref="S3.SS4.p4.2.m2.1.1.2.cmml">−</mo><msup id="S3.SS4.p4.2.m2.1.1.1" xref="S3.SS4.p4.2.m2.1.1.1.cmml"><mrow id="S3.SS4.p4.2.m2.1.1.1.1.1" xref="S3.SS4.p4.2.m2.1.1.1.1.1.1.cmml"><mo id="S3.SS4.p4.2.m2.1.1.1.1.1.2" stretchy="false" xref="S3.SS4.p4.2.m2.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS4.p4.2.m2.1.1.1.1.1.1" xref="S3.SS4.p4.2.m2.1.1.1.1.1.1.cmml"><mn id="S3.SS4.p4.2.m2.1.1.1.1.1.1.2" xref="S3.SS4.p4.2.m2.1.1.1.1.1.1.2.cmml">1</mn><mo id="S3.SS4.p4.2.m2.1.1.1.1.1.1.1" xref="S3.SS4.p4.2.m2.1.1.1.1.1.1.1.cmml">−</mo><msub id="S3.SS4.p4.2.m2.1.1.1.1.1.1.3" xref="S3.SS4.p4.2.m2.1.1.1.1.1.1.3.cmml"><mi id="S3.SS4.p4.2.m2.1.1.1.1.1.1.3.2" xref="S3.SS4.p4.2.m2.1.1.1.1.1.1.3.2.cmml">p</mi><mtext id="S3.SS4.p4.2.m2.1.1.1.1.1.1.3.3" xref="S3.SS4.p4.2.m2.1.1.1.1.1.1.3.3a.cmml">halt</mtext></msub></mrow><mo id="S3.SS4.p4.2.m2.1.1.1.1.1.3" stretchy="false" xref="S3.SS4.p4.2.m2.1.1.1.1.1.1.cmml">)</mo></mrow><mi id="S3.SS4.p4.2.m2.1.1.1.3" xref="S3.SS4.p4.2.m2.1.1.1.3.cmml">b</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p4.2.m2.1b"><apply id="S3.SS4.p4.2.m2.1.1.cmml" xref="S3.SS4.p4.2.m2.1.1"><minus id="S3.SS4.p4.2.m2.1.1.2.cmml" xref="S3.SS4.p4.2.m2.1.1.2"></minus><cn id="S3.SS4.p4.2.m2.1.1.3.cmml" type="integer" xref="S3.SS4.p4.2.m2.1.1.3">1</cn><apply id="S3.SS4.p4.2.m2.1.1.1.cmml" xref="S3.SS4.p4.2.m2.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p4.2.m2.1.1.1.2.cmml" xref="S3.SS4.p4.2.m2.1.1.1">superscript</csymbol><apply id="S3.SS4.p4.2.m2.1.1.1.1.1.1.cmml" xref="S3.SS4.p4.2.m2.1.1.1.1.1"><minus id="S3.SS4.p4.2.m2.1.1.1.1.1.1.1.cmml" xref="S3.SS4.p4.2.m2.1.1.1.1.1.1.1"></minus><cn id="S3.SS4.p4.2.m2.1.1.1.1.1.1.2.cmml" type="integer" xref="S3.SS4.p4.2.m2.1.1.1.1.1.1.2">1</cn><apply id="S3.SS4.p4.2.m2.1.1.1.1.1.1.3.cmml" xref="S3.SS4.p4.2.m2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.p4.2.m2.1.1.1.1.1.1.3.1.cmml" xref="S3.SS4.p4.2.m2.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS4.p4.2.m2.1.1.1.1.1.1.3.2.cmml" xref="S3.SS4.p4.2.m2.1.1.1.1.1.1.3.2">𝑝</ci><ci id="S3.SS4.p4.2.m2.1.1.1.1.1.1.3.3a.cmml" xref="S3.SS4.p4.2.m2.1.1.1.1.1.1.3.3"><mtext id="S3.SS4.p4.2.m2.1.1.1.1.1.1.3.3.cmml" mathsize="70%" xref="S3.SS4.p4.2.m2.1.1.1.1.1.1.3.3">halt</mtext></ci></apply></apply><ci id="S3.SS4.p4.2.m2.1.1.1.3.cmml" xref="S3.SS4.p4.2.m2.1.1.1.3">𝑏</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p4.2.m2.1c">1-(1-p_{\textrm{halt}})^{b}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p4.2.m2.1d">1 - ( 1 - italic_p start_POSTSUBSCRIPT halt end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT italic_b end_POSTSUPERSCRIPT</annotation></semantics></math>.
<math alttext="n" class="ltx_Math" display="inline" id="S3.SS4.p4.3.m3.1"><semantics id="S3.SS4.p4.3.m3.1a"><mi id="S3.SS4.p4.3.m3.1.1" xref="S3.SS4.p4.3.m3.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p4.3.m3.1b"><ci id="S3.SS4.p4.3.m3.1.1.cmml" xref="S3.SS4.p4.3.m3.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p4.3.m3.1c">n</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p4.3.m3.1d">italic_n</annotation></semantics></math> independent walkers are all <math alttext="b" class="ltx_Math" display="inline" id="S3.SS4.p4.4.m4.1"><semantics id="S3.SS4.p4.4.m4.1a"><mi id="S3.SS4.p4.4.m4.1.1" xref="S3.SS4.p4.4.m4.1.1.cmml">b</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p4.4.m4.1b"><ci id="S3.SS4.p4.4.m4.1.1.cmml" xref="S3.SS4.p4.4.m4.1.1">𝑏</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p4.4.m4.1c">b</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p4.4.m4.1d">italic_b</annotation></semantics></math> or shorter with probability <math alttext="\left(1-(1-p_{\textrm{halt}})^{b}\right)^{n}" class="ltx_Math" display="inline" id="S3.SS4.p4.5.m5.1"><semantics id="S3.SS4.p4.5.m5.1a"><msup id="S3.SS4.p4.5.m5.1.1" xref="S3.SS4.p4.5.m5.1.1.cmml"><mrow id="S3.SS4.p4.5.m5.1.1.1.1" xref="S3.SS4.p4.5.m5.1.1.1.1.1.cmml"><mo id="S3.SS4.p4.5.m5.1.1.1.1.2" xref="S3.SS4.p4.5.m5.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS4.p4.5.m5.1.1.1.1.1" xref="S3.SS4.p4.5.m5.1.1.1.1.1.cmml"><mn id="S3.SS4.p4.5.m5.1.1.1.1.1.3" xref="S3.SS4.p4.5.m5.1.1.1.1.1.3.cmml">1</mn><mo id="S3.SS4.p4.5.m5.1.1.1.1.1.2" xref="S3.SS4.p4.5.m5.1.1.1.1.1.2.cmml">−</mo><msup id="S3.SS4.p4.5.m5.1.1.1.1.1.1" xref="S3.SS4.p4.5.m5.1.1.1.1.1.1.cmml"><mrow id="S3.SS4.p4.5.m5.1.1.1.1.1.1.1.1" xref="S3.SS4.p4.5.m5.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.SS4.p4.5.m5.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.SS4.p4.5.m5.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS4.p4.5.m5.1.1.1.1.1.1.1.1.1" xref="S3.SS4.p4.5.m5.1.1.1.1.1.1.1.1.1.cmml"><mn id="S3.SS4.p4.5.m5.1.1.1.1.1.1.1.1.1.2" xref="S3.SS4.p4.5.m5.1.1.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="S3.SS4.p4.5.m5.1.1.1.1.1.1.1.1.1.1" xref="S3.SS4.p4.5.m5.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><msub id="S3.SS4.p4.5.m5.1.1.1.1.1.1.1.1.1.3" xref="S3.SS4.p4.5.m5.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.SS4.p4.5.m5.1.1.1.1.1.1.1.1.1.3.2" xref="S3.SS4.p4.5.m5.1.1.1.1.1.1.1.1.1.3.2.cmml">p</mi><mtext id="S3.SS4.p4.5.m5.1.1.1.1.1.1.1.1.1.3.3" xref="S3.SS4.p4.5.m5.1.1.1.1.1.1.1.1.1.3.3a.cmml">halt</mtext></msub></mrow><mo id="S3.SS4.p4.5.m5.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.SS4.p4.5.m5.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mi id="S3.SS4.p4.5.m5.1.1.1.1.1.1.3" xref="S3.SS4.p4.5.m5.1.1.1.1.1.1.3.cmml">b</mi></msup></mrow><mo id="S3.SS4.p4.5.m5.1.1.1.1.3" xref="S3.SS4.p4.5.m5.1.1.1.1.1.cmml">)</mo></mrow><mi id="S3.SS4.p4.5.m5.1.1.3" xref="S3.SS4.p4.5.m5.1.1.3.cmml">n</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS4.p4.5.m5.1b"><apply id="S3.SS4.p4.5.m5.1.1.cmml" xref="S3.SS4.p4.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS4.p4.5.m5.1.1.2.cmml" xref="S3.SS4.p4.5.m5.1.1">superscript</csymbol><apply id="S3.SS4.p4.5.m5.1.1.1.1.1.cmml" xref="S3.SS4.p4.5.m5.1.1.1.1"><minus id="S3.SS4.p4.5.m5.1.1.1.1.1.2.cmml" xref="S3.SS4.p4.5.m5.1.1.1.1.1.2"></minus><cn id="S3.SS4.p4.5.m5.1.1.1.1.1.3.cmml" type="integer" xref="S3.SS4.p4.5.m5.1.1.1.1.1.3">1</cn><apply id="S3.SS4.p4.5.m5.1.1.1.1.1.1.cmml" xref="S3.SS4.p4.5.m5.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p4.5.m5.1.1.1.1.1.1.2.cmml" xref="S3.SS4.p4.5.m5.1.1.1.1.1.1">superscript</csymbol><apply id="S3.SS4.p4.5.m5.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS4.p4.5.m5.1.1.1.1.1.1.1.1"><minus id="S3.SS4.p4.5.m5.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS4.p4.5.m5.1.1.1.1.1.1.1.1.1.1"></minus><cn id="S3.SS4.p4.5.m5.1.1.1.1.1.1.1.1.1.2.cmml" type="integer" xref="S3.SS4.p4.5.m5.1.1.1.1.1.1.1.1.1.2">1</cn><apply id="S3.SS4.p4.5.m5.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.SS4.p4.5.m5.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.p4.5.m5.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.SS4.p4.5.m5.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS4.p4.5.m5.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.SS4.p4.5.m5.1.1.1.1.1.1.1.1.1.3.2">𝑝</ci><ci id="S3.SS4.p4.5.m5.1.1.1.1.1.1.1.1.1.3.3a.cmml" xref="S3.SS4.p4.5.m5.1.1.1.1.1.1.1.1.1.3.3"><mtext id="S3.SS4.p4.5.m5.1.1.1.1.1.1.1.1.1.3.3.cmml" mathsize="70%" xref="S3.SS4.p4.5.m5.1.1.1.1.1.1.1.1.1.3.3">halt</mtext></ci></apply></apply><ci id="S3.SS4.p4.5.m5.1.1.1.1.1.1.3.cmml" xref="S3.SS4.p4.5.m5.1.1.1.1.1.1.3">𝑏</ci></apply></apply><ci id="S3.SS4.p4.5.m5.1.1.3.cmml" xref="S3.SS4.p4.5.m5.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p4.5.m5.1c">\left(1-(1-p_{\textrm{halt}})^{b}\right)^{n}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p4.5.m5.1d">( 1 - ( 1 - italic_p start_POSTSUBSCRIPT halt end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT italic_b end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT</annotation></semantics></math>.
Let this be equal to <math alttext="1-\delta" class="ltx_Math" display="inline" id="S3.SS4.p4.6.m6.1"><semantics id="S3.SS4.p4.6.m6.1a"><mrow id="S3.SS4.p4.6.m6.1.1" xref="S3.SS4.p4.6.m6.1.1.cmml"><mn id="S3.SS4.p4.6.m6.1.1.2" xref="S3.SS4.p4.6.m6.1.1.2.cmml">1</mn><mo id="S3.SS4.p4.6.m6.1.1.1" xref="S3.SS4.p4.6.m6.1.1.1.cmml">−</mo><mi id="S3.SS4.p4.6.m6.1.1.3" xref="S3.SS4.p4.6.m6.1.1.3.cmml">δ</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p4.6.m6.1b"><apply id="S3.SS4.p4.6.m6.1.1.cmml" xref="S3.SS4.p4.6.m6.1.1"><minus id="S3.SS4.p4.6.m6.1.1.1.cmml" xref="S3.SS4.p4.6.m6.1.1.1"></minus><cn id="S3.SS4.p4.6.m6.1.1.2.cmml" type="integer" xref="S3.SS4.p4.6.m6.1.1.2">1</cn><ci id="S3.SS4.p4.6.m6.1.1.3.cmml" xref="S3.SS4.p4.6.m6.1.1.3">𝛿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p4.6.m6.1c">1-\delta</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p4.6.m6.1d">1 - italic_δ</annotation></semantics></math> and solve for <math alttext="b" class="ltx_Math" display="inline" id="S3.SS4.p4.7.m7.1"><semantics id="S3.SS4.p4.7.m7.1a"><mi id="S3.SS4.p4.7.m7.1.1" xref="S3.SS4.p4.7.m7.1.1.cmml">b</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p4.7.m7.1b"><ci id="S3.SS4.p4.7.m7.1.1.cmml" xref="S3.SS4.p4.7.m7.1.1">𝑏</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p4.7.m7.1c">b</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p4.7.m7.1d">italic_b</annotation></semantics></math>.
At most <math alttext="bn" class="ltx_Math" display="inline" id="S3.SS4.p4.8.m8.1"><semantics id="S3.SS4.p4.8.m8.1a"><mrow id="S3.SS4.p4.8.m8.1.1" xref="S3.SS4.p4.8.m8.1.1.cmml"><mi id="S3.SS4.p4.8.m8.1.1.2" xref="S3.SS4.p4.8.m8.1.1.2.cmml">b</mi><mo id="S3.SS4.p4.8.m8.1.1.1" xref="S3.SS4.p4.8.m8.1.1.1.cmml">⁢</mo><mi id="S3.SS4.p4.8.m8.1.1.3" xref="S3.SS4.p4.8.m8.1.1.3.cmml">n</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p4.8.m8.1b"><apply id="S3.SS4.p4.8.m8.1.1.cmml" xref="S3.SS4.p4.8.m8.1.1"><times id="S3.SS4.p4.8.m8.1.1.1.cmml" xref="S3.SS4.p4.8.m8.1.1.1"></times><ci id="S3.SS4.p4.8.m8.1.1.2.cmml" xref="S3.SS4.p4.8.m8.1.1.2">𝑏</ci><ci id="S3.SS4.p4.8.m8.1.1.3.cmml" xref="S3.SS4.p4.8.m8.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p4.8.m8.1c">bn</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p4.8.m8.1d">italic_b italic_n</annotation></semantics></math> entries of <math alttext="\widehat{\phi}_{\mathcal{G}}(v_{i})" class="ltx_Math" display="inline" id="S3.SS4.p4.9.m9.1"><semantics id="S3.SS4.p4.9.m9.1a"><mrow id="S3.SS4.p4.9.m9.1.1" xref="S3.SS4.p4.9.m9.1.1.cmml"><msub id="S3.SS4.p4.9.m9.1.1.3" xref="S3.SS4.p4.9.m9.1.1.3.cmml"><mover accent="true" id="S3.SS4.p4.9.m9.1.1.3.2" xref="S3.SS4.p4.9.m9.1.1.3.2.cmml"><mi id="S3.SS4.p4.9.m9.1.1.3.2.2" xref="S3.SS4.p4.9.m9.1.1.3.2.2.cmml">ϕ</mi><mo id="S3.SS4.p4.9.m9.1.1.3.2.1" xref="S3.SS4.p4.9.m9.1.1.3.2.1.cmml">^</mo></mover><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p4.9.m9.1.1.3.3" xref="S3.SS4.p4.9.m9.1.1.3.3.cmml">𝒢</mi></msub><mo id="S3.SS4.p4.9.m9.1.1.2" xref="S3.SS4.p4.9.m9.1.1.2.cmml">⁢</mo><mrow id="S3.SS4.p4.9.m9.1.1.1.1" xref="S3.SS4.p4.9.m9.1.1.1.1.1.cmml"><mo id="S3.SS4.p4.9.m9.1.1.1.1.2" stretchy="false" xref="S3.SS4.p4.9.m9.1.1.1.1.1.cmml">(</mo><msub id="S3.SS4.p4.9.m9.1.1.1.1.1" xref="S3.SS4.p4.9.m9.1.1.1.1.1.cmml"><mi id="S3.SS4.p4.9.m9.1.1.1.1.1.2" xref="S3.SS4.p4.9.m9.1.1.1.1.1.2.cmml">v</mi><mi id="S3.SS4.p4.9.m9.1.1.1.1.1.3" xref="S3.SS4.p4.9.m9.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS4.p4.9.m9.1.1.1.1.3" stretchy="false" xref="S3.SS4.p4.9.m9.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p4.9.m9.1b"><apply id="S3.SS4.p4.9.m9.1.1.cmml" xref="S3.SS4.p4.9.m9.1.1"><times id="S3.SS4.p4.9.m9.1.1.2.cmml" xref="S3.SS4.p4.9.m9.1.1.2"></times><apply id="S3.SS4.p4.9.m9.1.1.3.cmml" xref="S3.SS4.p4.9.m9.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.p4.9.m9.1.1.3.1.cmml" xref="S3.SS4.p4.9.m9.1.1.3">subscript</csymbol><apply id="S3.SS4.p4.9.m9.1.1.3.2.cmml" xref="S3.SS4.p4.9.m9.1.1.3.2"><ci id="S3.SS4.p4.9.m9.1.1.3.2.1.cmml" xref="S3.SS4.p4.9.m9.1.1.3.2.1">^</ci><ci id="S3.SS4.p4.9.m9.1.1.3.2.2.cmml" xref="S3.SS4.p4.9.m9.1.1.3.2.2">italic-ϕ</ci></apply><ci id="S3.SS4.p4.9.m9.1.1.3.3.cmml" xref="S3.SS4.p4.9.m9.1.1.3.3">𝒢</ci></apply><apply id="S3.SS4.p4.9.m9.1.1.1.1.1.cmml" xref="S3.SS4.p4.9.m9.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p4.9.m9.1.1.1.1.1.1.cmml" xref="S3.SS4.p4.9.m9.1.1.1.1">subscript</csymbol><ci id="S3.SS4.p4.9.m9.1.1.1.1.1.2.cmml" xref="S3.SS4.p4.9.m9.1.1.1.1.1.2">𝑣</ci><ci id="S3.SS4.p4.9.m9.1.1.1.1.1.3.cmml" xref="S3.SS4.p4.9.m9.1.1.1.1.1.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p4.9.m9.1c">\widehat{\phi}_{\mathcal{G}}(v_{i})</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p4.9.m9.1d">over^ start_ARG italic_ϕ end_ARG start_POSTSUBSCRIPT caligraphic_G end_POSTSUBSCRIPT ( italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT )</annotation></semantics></math> can then be nonzero, so the sparsity guarantee follows. ∎</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="S3.SS4.p5">
<p class="ltx_p" id="S3.SS4.p5.2">Lemma <a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#S3.Thmtheorem2" title="Lemma 3.2 (GRF sparsity). ‣ 3.4 Novel theoretical results for GRFs: sharp estimators with sparse features ‣ 3 Towards linear topological masking ‣ Linear Transformer Topological Masking with Graph Random Features"><span class="ltx_text ltx_ref_tag">3.2</span></a> means that, if we fix the number of walkers <math alttext="n" class="ltx_Math" display="inline" id="S3.SS4.p5.1.m1.1"><semantics id="S3.SS4.p5.1.m1.1a"><mi id="S3.SS4.p5.1.m1.1.1" xref="S3.SS4.p5.1.m1.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p5.1.m1.1b"><ci id="S3.SS4.p5.1.m1.1.1.cmml" xref="S3.SS4.p5.1.m1.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p5.1.m1.1c">n</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p5.1.m1.1d">italic_n</annotation></semantics></math> (e.g.&nbsp;using the bound in Eq.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#S3.E11" title="In Theorem 3.1 (GRF exponential concentration bounds). ‣ 3.4 Novel theoretical results for GRFs: sharp estimators with sparse features ‣ 3 Towards linear topological masking ‣ Linear Transformer Topological Masking with Graph Random Features"><span class="ltx_text ltx_ref_tag">11</span></a>), we can also bound GRF sparsity with high probability.
Crucially: the number of nonzero GRF entries is independent of the graph size <math alttext="N" class="ltx_Math" display="inline" id="S3.SS4.p5.2.m2.1"><semantics id="S3.SS4.p5.2.m2.1a"><mi id="S3.SS4.p5.2.m2.1.1" xref="S3.SS4.p5.2.m2.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p5.2.m2.1b"><ci id="S3.SS4.p5.2.m2.1.1.cmml" xref="S3.SS4.p5.2.m2.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p5.2.m2.1c">N</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p5.2.m2.1d">italic_N</annotation></semantics></math>.
We conclude the following.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_theorem ltx_theorem_corollary" id="S3.Thmtheorem3">
<h6 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span class="ltx_text ltx_font_bold" id="S3.Thmtheorem3.2.1.1">Corollary 3.3</span></span><span class="ltx_text ltx_font_bold" id="S3.Thmtheorem3.3.2"> </span>(GRFs implement <math alttext="\mathcal{O}(N)" class="ltx_Math" display="inline" id="S3.Thmtheorem3.1.m1.1"><semantics id="S3.Thmtheorem3.1.m1.1b"><mrow id="S3.Thmtheorem3.1.m1.1.2" xref="S3.Thmtheorem3.1.m1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.Thmtheorem3.1.m1.1.2.2" xref="S3.Thmtheorem3.1.m1.1.2.2.cmml">𝒪</mi><mo id="S3.Thmtheorem3.1.m1.1.2.1" xref="S3.Thmtheorem3.1.m1.1.2.1.cmml">⁢</mo><mrow id="S3.Thmtheorem3.1.m1.1.2.3.2" xref="S3.Thmtheorem3.1.m1.1.2.cmml"><mo id="S3.Thmtheorem3.1.m1.1.2.3.2.1" stretchy="false" xref="S3.Thmtheorem3.1.m1.1.2.cmml">(</mo><mi id="S3.Thmtheorem3.1.m1.1.1" xref="S3.Thmtheorem3.1.m1.1.1.cmml">N</mi><mo id="S3.Thmtheorem3.1.m1.1.2.3.2.2" stretchy="false" xref="S3.Thmtheorem3.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Thmtheorem3.1.m1.1c"><apply id="S3.Thmtheorem3.1.m1.1.2.cmml" xref="S3.Thmtheorem3.1.m1.1.2"><times id="S3.Thmtheorem3.1.m1.1.2.1.cmml" xref="S3.Thmtheorem3.1.m1.1.2.1"></times><ci id="S3.Thmtheorem3.1.m1.1.2.2.cmml" xref="S3.Thmtheorem3.1.m1.1.2.2">𝒪</ci><ci id="S3.Thmtheorem3.1.m1.1.1.cmml" xref="S3.Thmtheorem3.1.m1.1.1">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmtheorem3.1.m1.1d">\mathcal{O}(N)</annotation><annotation encoding="application/x-llamapun" id="S3.Thmtheorem3.1.m1.1e">caligraphic_O ( italic_N )</annotation></semantics></math> topological masking)<span class="ltx_text ltx_font_bold" id="S3.Thmtheorem3.4.3">.</span>
</h6><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S3.Thmtheorem3.p1">
<p class="ltx_p" id="S3.Thmtheorem3.p1.10"><span class="ltx_text ltx_font_italic" id="S3.Thmtheorem3.p1.10.10">Suppose we construct a set of graph random features <math alttext="\{\widehat{\phi}_{\mathcal{G}}(v_{i})\}_{v_{i}\in\mathcal{N}}" class="ltx_Math" display="inline" id="S3.Thmtheorem3.p1.1.1.m1.1"><semantics id="S3.Thmtheorem3.p1.1.1.m1.1a"><msub id="S3.Thmtheorem3.p1.1.1.m1.1.1" xref="S3.Thmtheorem3.p1.1.1.m1.1.1.cmml"><mrow id="S3.Thmtheorem3.p1.1.1.m1.1.1.1.1" xref="S3.Thmtheorem3.p1.1.1.m1.1.1.1.2.cmml"><mo id="S3.Thmtheorem3.p1.1.1.m1.1.1.1.1.2" stretchy="false" xref="S3.Thmtheorem3.p1.1.1.m1.1.1.1.2.cmml">{</mo><mrow id="S3.Thmtheorem3.p1.1.1.m1.1.1.1.1.1" xref="S3.Thmtheorem3.p1.1.1.m1.1.1.1.1.1.cmml"><msub id="S3.Thmtheorem3.p1.1.1.m1.1.1.1.1.1.3" xref="S3.Thmtheorem3.p1.1.1.m1.1.1.1.1.1.3.cmml"><mover accent="true" id="S3.Thmtheorem3.p1.1.1.m1.1.1.1.1.1.3.2" xref="S3.Thmtheorem3.p1.1.1.m1.1.1.1.1.1.3.2.cmml"><mi id="S3.Thmtheorem3.p1.1.1.m1.1.1.1.1.1.3.2.2" xref="S3.Thmtheorem3.p1.1.1.m1.1.1.1.1.1.3.2.2.cmml">ϕ</mi><mo id="S3.Thmtheorem3.p1.1.1.m1.1.1.1.1.1.3.2.1" xref="S3.Thmtheorem3.p1.1.1.m1.1.1.1.1.1.3.2.1.cmml">^</mo></mover><mi class="ltx_font_mathcaligraphic" id="S3.Thmtheorem3.p1.1.1.m1.1.1.1.1.1.3.3" xref="S3.Thmtheorem3.p1.1.1.m1.1.1.1.1.1.3.3.cmml">𝒢</mi></msub><mo id="S3.Thmtheorem3.p1.1.1.m1.1.1.1.1.1.2" xref="S3.Thmtheorem3.p1.1.1.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.Thmtheorem3.p1.1.1.m1.1.1.1.1.1.1.1" xref="S3.Thmtheorem3.p1.1.1.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.Thmtheorem3.p1.1.1.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.Thmtheorem3.p1.1.1.m1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.Thmtheorem3.p1.1.1.m1.1.1.1.1.1.1.1.1" xref="S3.Thmtheorem3.p1.1.1.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.Thmtheorem3.p1.1.1.m1.1.1.1.1.1.1.1.1.2" xref="S3.Thmtheorem3.p1.1.1.m1.1.1.1.1.1.1.1.1.2.cmml">v</mi><mi id="S3.Thmtheorem3.p1.1.1.m1.1.1.1.1.1.1.1.1.3" xref="S3.Thmtheorem3.p1.1.1.m1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.Thmtheorem3.p1.1.1.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.Thmtheorem3.p1.1.1.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.Thmtheorem3.p1.1.1.m1.1.1.1.1.3" stretchy="false" xref="S3.Thmtheorem3.p1.1.1.m1.1.1.1.2.cmml">}</mo></mrow><mrow id="S3.Thmtheorem3.p1.1.1.m1.1.1.3" xref="S3.Thmtheorem3.p1.1.1.m1.1.1.3.cmml"><msub id="S3.Thmtheorem3.p1.1.1.m1.1.1.3.2" xref="S3.Thmtheorem3.p1.1.1.m1.1.1.3.2.cmml"><mi id="S3.Thmtheorem3.p1.1.1.m1.1.1.3.2.2" xref="S3.Thmtheorem3.p1.1.1.m1.1.1.3.2.2.cmml">v</mi><mi id="S3.Thmtheorem3.p1.1.1.m1.1.1.3.2.3" xref="S3.Thmtheorem3.p1.1.1.m1.1.1.3.2.3.cmml">i</mi></msub><mo id="S3.Thmtheorem3.p1.1.1.m1.1.1.3.1" xref="S3.Thmtheorem3.p1.1.1.m1.1.1.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.Thmtheorem3.p1.1.1.m1.1.1.3.3" xref="S3.Thmtheorem3.p1.1.1.m1.1.1.3.3.cmml">𝒩</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.Thmtheorem3.p1.1.1.m1.1b"><apply id="S3.Thmtheorem3.p1.1.1.m1.1.1.cmml" xref="S3.Thmtheorem3.p1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.Thmtheorem3.p1.1.1.m1.1.1.2.cmml" xref="S3.Thmtheorem3.p1.1.1.m1.1.1">subscript</csymbol><set id="S3.Thmtheorem3.p1.1.1.m1.1.1.1.2.cmml" xref="S3.Thmtheorem3.p1.1.1.m1.1.1.1.1"><apply id="S3.Thmtheorem3.p1.1.1.m1.1.1.1.1.1.cmml" xref="S3.Thmtheorem3.p1.1.1.m1.1.1.1.1.1"><times id="S3.Thmtheorem3.p1.1.1.m1.1.1.1.1.1.2.cmml" xref="S3.Thmtheorem3.p1.1.1.m1.1.1.1.1.1.2"></times><apply id="S3.Thmtheorem3.p1.1.1.m1.1.1.1.1.1.3.cmml" xref="S3.Thmtheorem3.p1.1.1.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.Thmtheorem3.p1.1.1.m1.1.1.1.1.1.3.1.cmml" xref="S3.Thmtheorem3.p1.1.1.m1.1.1.1.1.1.3">subscript</csymbol><apply id="S3.Thmtheorem3.p1.1.1.m1.1.1.1.1.1.3.2.cmml" xref="S3.Thmtheorem3.p1.1.1.m1.1.1.1.1.1.3.2"><ci id="S3.Thmtheorem3.p1.1.1.m1.1.1.1.1.1.3.2.1.cmml" xref="S3.Thmtheorem3.p1.1.1.m1.1.1.1.1.1.3.2.1">^</ci><ci id="S3.Thmtheorem3.p1.1.1.m1.1.1.1.1.1.3.2.2.cmml" xref="S3.Thmtheorem3.p1.1.1.m1.1.1.1.1.1.3.2.2">italic-ϕ</ci></apply><ci id="S3.Thmtheorem3.p1.1.1.m1.1.1.1.1.1.3.3.cmml" xref="S3.Thmtheorem3.p1.1.1.m1.1.1.1.1.1.3.3">𝒢</ci></apply><apply id="S3.Thmtheorem3.p1.1.1.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.Thmtheorem3.p1.1.1.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Thmtheorem3.p1.1.1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Thmtheorem3.p1.1.1.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.Thmtheorem3.p1.1.1.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Thmtheorem3.p1.1.1.m1.1.1.1.1.1.1.1.1.2">𝑣</ci><ci id="S3.Thmtheorem3.p1.1.1.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.Thmtheorem3.p1.1.1.m1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply></set><apply id="S3.Thmtheorem3.p1.1.1.m1.1.1.3.cmml" xref="S3.Thmtheorem3.p1.1.1.m1.1.1.3"><in id="S3.Thmtheorem3.p1.1.1.m1.1.1.3.1.cmml" xref="S3.Thmtheorem3.p1.1.1.m1.1.1.3.1"></in><apply id="S3.Thmtheorem3.p1.1.1.m1.1.1.3.2.cmml" xref="S3.Thmtheorem3.p1.1.1.m1.1.1.3.2"><csymbol cd="ambiguous" id="S3.Thmtheorem3.p1.1.1.m1.1.1.3.2.1.cmml" xref="S3.Thmtheorem3.p1.1.1.m1.1.1.3.2">subscript</csymbol><ci id="S3.Thmtheorem3.p1.1.1.m1.1.1.3.2.2.cmml" xref="S3.Thmtheorem3.p1.1.1.m1.1.1.3.2.2">𝑣</ci><ci id="S3.Thmtheorem3.p1.1.1.m1.1.1.3.2.3.cmml" xref="S3.Thmtheorem3.p1.1.1.m1.1.1.3.2.3">𝑖</ci></apply><ci id="S3.Thmtheorem3.p1.1.1.m1.1.1.3.3.cmml" xref="S3.Thmtheorem3.p1.1.1.m1.1.1.3.3">𝒩</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmtheorem3.p1.1.1.m1.1c">\{\widehat{\phi}_{\mathcal{G}}(v_{i})\}_{v_{i}\in\mathcal{N}}</annotation><annotation encoding="application/x-llamapun" id="S3.Thmtheorem3.p1.1.1.m1.1d">{ over^ start_ARG italic_ϕ end_ARG start_POSTSUBSCRIPT caligraphic_G end_POSTSUBSCRIPT ( italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) } start_POSTSUBSCRIPT italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∈ caligraphic_N end_POSTSUBSCRIPT</annotation></semantics></math>, choosing the number of walkers <math alttext="n" class="ltx_Math" display="inline" id="S3.Thmtheorem3.p1.2.2.m2.1"><semantics id="S3.Thmtheorem3.p1.2.2.m2.1a"><mi id="S3.Thmtheorem3.p1.2.2.m2.1.1" xref="S3.Thmtheorem3.p1.2.2.m2.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S3.Thmtheorem3.p1.2.2.m2.1b"><ci id="S3.Thmtheorem3.p1.2.2.m2.1.1.cmml" xref="S3.Thmtheorem3.p1.2.2.m2.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmtheorem3.p1.2.2.m2.1c">n</annotation><annotation encoding="application/x-llamapun" id="S3.Thmtheorem3.p1.2.2.m2.1d">italic_n</annotation></semantics></math> as described above with <math alttext="c" class="ltx_Math" display="inline" id="S3.Thmtheorem3.p1.3.3.m3.1"><semantics id="S3.Thmtheorem3.p1.3.3.m3.1a"><mi id="S3.Thmtheorem3.p1.3.3.m3.1.1" xref="S3.Thmtheorem3.p1.3.3.m3.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S3.Thmtheorem3.p1.3.3.m3.1b"><ci id="S3.Thmtheorem3.p1.3.3.m3.1.1.cmml" xref="S3.Thmtheorem3.p1.3.3.m3.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmtheorem3.p1.3.3.m3.1c">c</annotation><annotation encoding="application/x-llamapun" id="S3.Thmtheorem3.p1.3.3.m3.1d">italic_c</annotation></semantics></math>, <math alttext="p_{\textrm{halt}}" class="ltx_Math" display="inline" id="S3.Thmtheorem3.p1.4.4.m4.1"><semantics id="S3.Thmtheorem3.p1.4.4.m4.1a"><msub id="S3.Thmtheorem3.p1.4.4.m4.1.1" xref="S3.Thmtheorem3.p1.4.4.m4.1.1.cmml"><mi id="S3.Thmtheorem3.p1.4.4.m4.1.1.2" xref="S3.Thmtheorem3.p1.4.4.m4.1.1.2.cmml">p</mi><mtext class="ltx_mathvariant_italic" id="S3.Thmtheorem3.p1.4.4.m4.1.1.3" xref="S3.Thmtheorem3.p1.4.4.m4.1.1.3a.cmml">halt</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.Thmtheorem3.p1.4.4.m4.1b"><apply id="S3.Thmtheorem3.p1.4.4.m4.1.1.cmml" xref="S3.Thmtheorem3.p1.4.4.m4.1.1"><csymbol cd="ambiguous" id="S3.Thmtheorem3.p1.4.4.m4.1.1.1.cmml" xref="S3.Thmtheorem3.p1.4.4.m4.1.1">subscript</csymbol><ci id="S3.Thmtheorem3.p1.4.4.m4.1.1.2.cmml" xref="S3.Thmtheorem3.p1.4.4.m4.1.1.2">𝑝</ci><ci id="S3.Thmtheorem3.p1.4.4.m4.1.1.3a.cmml" xref="S3.Thmtheorem3.p1.4.4.m4.1.1.3"><mtext class="ltx_mathvariant_italic" id="S3.Thmtheorem3.p1.4.4.m4.1.1.3.cmml" mathsize="70%" xref="S3.Thmtheorem3.p1.4.4.m4.1.1.3">halt</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmtheorem3.p1.4.4.m4.1c">p_{\textrm{halt}}</annotation><annotation encoding="application/x-llamapun" id="S3.Thmtheorem3.p1.4.4.m4.1d">italic_p start_POSTSUBSCRIPT halt end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="\delta" class="ltx_Math" display="inline" id="S3.Thmtheorem3.p1.5.5.m5.1"><semantics id="S3.Thmtheorem3.p1.5.5.m5.1a"><mi id="S3.Thmtheorem3.p1.5.5.m5.1.1" xref="S3.Thmtheorem3.p1.5.5.m5.1.1.cmml">δ</mi><annotation-xml encoding="MathML-Content" id="S3.Thmtheorem3.p1.5.5.m5.1b"><ci id="S3.Thmtheorem3.p1.5.5.m5.1.1.cmml" xref="S3.Thmtheorem3.p1.5.5.m5.1.1">𝛿</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmtheorem3.p1.5.5.m5.1c">\delta</annotation><annotation encoding="application/x-llamapun" id="S3.Thmtheorem3.p1.5.5.m5.1d">italic_δ</annotation></semantics></math>, <math alttext="t" class="ltx_Math" display="inline" id="S3.Thmtheorem3.p1.6.6.m6.1"><semantics id="S3.Thmtheorem3.p1.6.6.m6.1a"><mi id="S3.Thmtheorem3.p1.6.6.m6.1.1" xref="S3.Thmtheorem3.p1.6.6.m6.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.Thmtheorem3.p1.6.6.m6.1b"><ci id="S3.Thmtheorem3.p1.6.6.m6.1.1.cmml" xref="S3.Thmtheorem3.p1.6.6.m6.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmtheorem3.p1.6.6.m6.1c">t</annotation><annotation encoding="application/x-llamapun" id="S3.Thmtheorem3.p1.6.6.m6.1d">italic_t</annotation></semantics></math> and the deviation probability <math alttext="\textrm{\emph{Pr}}\left(|\phi_{\textrm{\emph{GRF}}}(v_{i})^{\top}\phi_{\textrm%
{\emph{GRF}}}(v_{j})-{\mathbf{M}_{\alpha}}_{ij}|>t\right)" class="ltx_Math" display="inline" id="S3.Thmtheorem3.p1.7.7.m7.1"><semantics id="S3.Thmtheorem3.p1.7.7.m7.1a"><mrow id="S3.Thmtheorem3.p1.7.7.m7.1.1" xref="S3.Thmtheorem3.p1.7.7.m7.1.1.cmml"><mtext id="S3.Thmtheorem3.p1.7.7.m7.1.1.3" xref="S3.Thmtheorem3.p1.7.7.m7.1.1.3b.cmml"><em class="ltx_emph ltx_font_upright" id="S3.Thmtheorem3.p1.7.7.m7.1.1.3.1nest">Pr</em></mtext><mo id="S3.Thmtheorem3.p1.7.7.m7.1.1.2" xref="S3.Thmtheorem3.p1.7.7.m7.1.1.2.cmml">⁢</mo><mrow id="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1" xref="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.cmml"><mo id="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.2" xref="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.cmml">(</mo><mrow id="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1" xref="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.cmml"><mrow id="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1" xref="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.2.cmml"><mo id="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.2.1.cmml">|</mo><mrow id="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1" xref="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.cmml"><mrow id="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.2" xref="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.2.cmml"><msub id="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.2.4" xref="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.2.4.cmml"><mi id="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.2.4.2" xref="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.2.4.2.cmml">ϕ</mi><mtext id="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.2.4.3" xref="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.2.4.3b.cmml"><em class="ltx_emph ltx_font_upright" id="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.2.4.3.1nest" style="font-size:70%;">GRF</em></mtext></msub><mo id="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.2.3" xref="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.2.3.cmml">⁢</mo><msup id="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.1.1" xref="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">v</mi><mi id="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.1.1.3" xref="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.1.1.3.cmml">⊤</mo></msup><mo id="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.2.3a" xref="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.2.3.cmml">⁢</mo><msub id="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.2.5" xref="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.2.5.cmml"><mi id="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.2.5.2" xref="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.2.5.2.cmml">ϕ</mi><mtext id="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.2.5.3" xref="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.2.5.3b.cmml"><em class="ltx_emph ltx_font_upright" id="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.2.5.3.1nest" style="font-size:70%;">GRF</em></mtext></msub><mo id="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.2.3b" xref="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.2.3.cmml">⁢</mo><mrow id="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.2.2.1" xref="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.2.2.1.1.cmml"><mo id="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.2.2.1.2" stretchy="false" xref="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.2.2.1.1.cmml">(</mo><msub id="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.2.2.1.1" xref="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.2.2.1.1.cmml"><mi id="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.2.2.1.1.2" xref="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.2.2.1.1.2.cmml">v</mi><mi id="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.2.2.1.1.3" xref="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.2.2.1.1.3.cmml">j</mi></msub><mo id="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.2.2.1.3" stretchy="false" xref="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.2.2.1.1.cmml">)</mo></mrow></mrow><mo id="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.3" xref="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.3.cmml">−</mo><mmultiscripts id="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.4" xref="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.4.cmml"><mi id="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.4.2.2" xref="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.4.2.2.cmml">𝐌</mi><mi id="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.4.2.3" xref="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.4.2.3.cmml">α</mi><mrow id="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.4a" xref="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.4.cmml"></mrow><mrow id="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.4.3" xref="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.4.3.cmml"><mi id="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.4.3.2" xref="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.4.3.2.cmml">i</mi><mo id="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.4.3.1" xref="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.4.3.1.cmml">⁢</mo><mi id="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.4.3.3" xref="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.4.3.3.cmml">j</mi></mrow><mrow id="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.4b" xref="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.4.cmml"></mrow></mmultiscripts></mrow><mo id="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.2.1.cmml">|</mo></mrow><mo id="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.2" xref="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.2.cmml">&gt;</mo><mi id="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.3" xref="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.3.cmml">t</mi></mrow><mo id="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.3" xref="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Thmtheorem3.p1.7.7.m7.1b"><apply id="S3.Thmtheorem3.p1.7.7.m7.1.1.cmml" xref="S3.Thmtheorem3.p1.7.7.m7.1.1"><times id="S3.Thmtheorem3.p1.7.7.m7.1.1.2.cmml" xref="S3.Thmtheorem3.p1.7.7.m7.1.1.2"></times><ci id="S3.Thmtheorem3.p1.7.7.m7.1.1.3b.cmml" xref="S3.Thmtheorem3.p1.7.7.m7.1.1.3"><mtext id="S3.Thmtheorem3.p1.7.7.m7.1.1.3.cmml" xref="S3.Thmtheorem3.p1.7.7.m7.1.1.3"><em class="ltx_emph ltx_font_upright" id="S3.Thmtheorem3.p1.7.7.m7.1.1.3.1anest">Pr</em></mtext></ci><apply id="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.cmml" xref="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1"><gt id="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.2.cmml" xref="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.2"></gt><apply id="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.2.cmml" xref="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1"><abs id="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.2.1.cmml" xref="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.2"></abs><apply id="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.cmml" xref="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1"><minus id="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.3.cmml" xref="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.3"></minus><apply id="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.2"><times id="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.2.3"></times><apply id="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.2.4.cmml" xref="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.2.4"><csymbol cd="ambiguous" id="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.2.4.1.cmml" xref="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.2.4">subscript</csymbol><ci id="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.2.4.2.cmml" xref="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.2.4.2">italic-ϕ</ci><ci id="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.2.4.3b.cmml" xref="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.2.4.3"><mtext id="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.2.4.3.cmml" mathsize="70%" xref="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.2.4.3"><em class="ltx_emph ltx_font_upright" id="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.2.4.3.1anest" style="font-size:70%;">GRF</em></mtext></ci></apply><apply id="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.1.1.1.1.1.2">𝑣</ci><ci id="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><csymbol cd="latexml" id="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.1.1.3">top</csymbol></apply><apply id="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.2.5.cmml" xref="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.2.5"><csymbol cd="ambiguous" id="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.2.5.1.cmml" xref="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.2.5">subscript</csymbol><ci id="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.2.5.2.cmml" xref="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.2.5.2">italic-ϕ</ci><ci id="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.2.5.3b.cmml" xref="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.2.5.3"><mtext id="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.2.5.3.cmml" mathsize="70%" xref="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.2.5.3"><em class="ltx_emph ltx_font_upright" id="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.2.5.3.1anest" style="font-size:70%;">GRF</em></mtext></ci></apply><apply id="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.2.2.1.1.cmml" xref="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.2.2.1"><csymbol cd="ambiguous" id="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.2.2.1.1.1.cmml" xref="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.2.2.1">subscript</csymbol><ci id="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.2.2.1.1.2.cmml" xref="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.2.2.1.1.2">𝑣</ci><ci id="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.2.2.1.1.3.cmml" xref="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.2.2.1.1.3">𝑗</ci></apply></apply><apply id="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.4.cmml" xref="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.4.1.cmml" xref="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.4">subscript</csymbol><apply id="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.4.2.cmml" xref="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.4.2.1.cmml" xref="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.4">subscript</csymbol><ci id="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.4.2.2.cmml" xref="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.4.2.2">𝐌</ci><ci id="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.4.2.3.cmml" xref="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.4.2.3">𝛼</ci></apply><apply id="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.4.3.cmml" xref="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.4.3"><times id="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.4.3.1.cmml" xref="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.4.3.1"></times><ci id="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.4.3.2.cmml" xref="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.4.3.2">𝑖</ci><ci id="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.4.3.3.cmml" xref="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.1.1.1.4.3.3">𝑗</ci></apply></apply></apply></apply><ci id="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.3.cmml" xref="S3.Thmtheorem3.p1.7.7.m7.1.1.1.1.1.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmtheorem3.p1.7.7.m7.1c">\textrm{\emph{Pr}}\left(|\phi_{\textrm{\emph{GRF}}}(v_{i})^{\top}\phi_{\textrm%
{\emph{GRF}}}(v_{j})-{\mathbf{M}_{\alpha}}_{ij}|&gt;t\right)</annotation><annotation encoding="application/x-llamapun" id="S3.Thmtheorem3.p1.7.7.m7.1d">Pr ( | italic_ϕ start_POSTSUBSCRIPT GRF end_POSTSUBSCRIPT ( italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT italic_ϕ start_POSTSUBSCRIPT GRF end_POSTSUBSCRIPT ( italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) - bold_M start_POSTSUBSCRIPT italic_α end_POSTSUBSCRIPT start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT | &gt; italic_t )</annotation></semantics></math> fixed as hyperparameters.
Then the number of nonzero entries in <math alttext="\widehat{\mathbf{\Phi}}_{\{\mathbf{Q},\mathbf{K}\},\mathcal{G}}\in\mathbb{R}^{%
N\times Nm}" class="ltx_Math" display="inline" id="S3.Thmtheorem3.p1.8.8.m8.4"><semantics id="S3.Thmtheorem3.p1.8.8.m8.4a"><mrow id="S3.Thmtheorem3.p1.8.8.m8.4.5" xref="S3.Thmtheorem3.p1.8.8.m8.4.5.cmml"><msub id="S3.Thmtheorem3.p1.8.8.m8.4.5.2" xref="S3.Thmtheorem3.p1.8.8.m8.4.5.2.cmml"><mover accent="true" id="S3.Thmtheorem3.p1.8.8.m8.4.5.2.2" xref="S3.Thmtheorem3.p1.8.8.m8.4.5.2.2.cmml"><mi id="S3.Thmtheorem3.p1.8.8.m8.4.5.2.2.2" xref="S3.Thmtheorem3.p1.8.8.m8.4.5.2.2.2.cmml">𝚽</mi><mo id="S3.Thmtheorem3.p1.8.8.m8.4.5.2.2.1" xref="S3.Thmtheorem3.p1.8.8.m8.4.5.2.2.1.cmml">^</mo></mover><mrow id="S3.Thmtheorem3.p1.8.8.m8.4.4.4.4" xref="S3.Thmtheorem3.p1.8.8.m8.4.4.4.5.cmml"><mrow id="S3.Thmtheorem3.p1.8.8.m8.4.4.4.4.1.2" xref="S3.Thmtheorem3.p1.8.8.m8.4.4.4.4.1.1.cmml"><mo id="S3.Thmtheorem3.p1.8.8.m8.4.4.4.4.1.2.1" stretchy="false" xref="S3.Thmtheorem3.p1.8.8.m8.4.4.4.4.1.1.cmml">{</mo><mi id="S3.Thmtheorem3.p1.8.8.m8.1.1.1.1" xref="S3.Thmtheorem3.p1.8.8.m8.1.1.1.1.cmml">𝐐</mi><mo id="S3.Thmtheorem3.p1.8.8.m8.4.4.4.4.1.2.2" xref="S3.Thmtheorem3.p1.8.8.m8.4.4.4.4.1.1.cmml">,</mo><mi id="S3.Thmtheorem3.p1.8.8.m8.2.2.2.2" xref="S3.Thmtheorem3.p1.8.8.m8.2.2.2.2.cmml">𝐊</mi><mo id="S3.Thmtheorem3.p1.8.8.m8.4.4.4.4.1.2.3" stretchy="false" xref="S3.Thmtheorem3.p1.8.8.m8.4.4.4.4.1.1.cmml">}</mo></mrow><mo id="S3.Thmtheorem3.p1.8.8.m8.4.4.4.4.2" xref="S3.Thmtheorem3.p1.8.8.m8.4.4.4.5.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S3.Thmtheorem3.p1.8.8.m8.3.3.3.3" xref="S3.Thmtheorem3.p1.8.8.m8.3.3.3.3.cmml">𝒢</mi></mrow></msub><mo id="S3.Thmtheorem3.p1.8.8.m8.4.5.1" xref="S3.Thmtheorem3.p1.8.8.m8.4.5.1.cmml">∈</mo><msup id="S3.Thmtheorem3.p1.8.8.m8.4.5.3" xref="S3.Thmtheorem3.p1.8.8.m8.4.5.3.cmml"><mi id="S3.Thmtheorem3.p1.8.8.m8.4.5.3.2" xref="S3.Thmtheorem3.p1.8.8.m8.4.5.3.2.cmml">ℝ</mi><mrow id="S3.Thmtheorem3.p1.8.8.m8.4.5.3.3" xref="S3.Thmtheorem3.p1.8.8.m8.4.5.3.3.cmml"><mrow id="S3.Thmtheorem3.p1.8.8.m8.4.5.3.3.2" xref="S3.Thmtheorem3.p1.8.8.m8.4.5.3.3.2.cmml"><mi id="S3.Thmtheorem3.p1.8.8.m8.4.5.3.3.2.2" xref="S3.Thmtheorem3.p1.8.8.m8.4.5.3.3.2.2.cmml">N</mi><mo id="S3.Thmtheorem3.p1.8.8.m8.4.5.3.3.2.1" lspace="0.222em" rspace="0.222em" xref="S3.Thmtheorem3.p1.8.8.m8.4.5.3.3.2.1.cmml">×</mo><mi id="S3.Thmtheorem3.p1.8.8.m8.4.5.3.3.2.3" xref="S3.Thmtheorem3.p1.8.8.m8.4.5.3.3.2.3.cmml">N</mi></mrow><mo id="S3.Thmtheorem3.p1.8.8.m8.4.5.3.3.1" xref="S3.Thmtheorem3.p1.8.8.m8.4.5.3.3.1.cmml">⁢</mo><mi id="S3.Thmtheorem3.p1.8.8.m8.4.5.3.3.3" xref="S3.Thmtheorem3.p1.8.8.m8.4.5.3.3.3.cmml">m</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.Thmtheorem3.p1.8.8.m8.4b"><apply id="S3.Thmtheorem3.p1.8.8.m8.4.5.cmml" xref="S3.Thmtheorem3.p1.8.8.m8.4.5"><in id="S3.Thmtheorem3.p1.8.8.m8.4.5.1.cmml" xref="S3.Thmtheorem3.p1.8.8.m8.4.5.1"></in><apply id="S3.Thmtheorem3.p1.8.8.m8.4.5.2.cmml" xref="S3.Thmtheorem3.p1.8.8.m8.4.5.2"><csymbol cd="ambiguous" id="S3.Thmtheorem3.p1.8.8.m8.4.5.2.1.cmml" xref="S3.Thmtheorem3.p1.8.8.m8.4.5.2">subscript</csymbol><apply id="S3.Thmtheorem3.p1.8.8.m8.4.5.2.2.cmml" xref="S3.Thmtheorem3.p1.8.8.m8.4.5.2.2"><ci id="S3.Thmtheorem3.p1.8.8.m8.4.5.2.2.1.cmml" xref="S3.Thmtheorem3.p1.8.8.m8.4.5.2.2.1">^</ci><ci id="S3.Thmtheorem3.p1.8.8.m8.4.5.2.2.2.cmml" xref="S3.Thmtheorem3.p1.8.8.m8.4.5.2.2.2">𝚽</ci></apply><list id="S3.Thmtheorem3.p1.8.8.m8.4.4.4.5.cmml" xref="S3.Thmtheorem3.p1.8.8.m8.4.4.4.4"><set id="S3.Thmtheorem3.p1.8.8.m8.4.4.4.4.1.1.cmml" xref="S3.Thmtheorem3.p1.8.8.m8.4.4.4.4.1.2"><ci id="S3.Thmtheorem3.p1.8.8.m8.1.1.1.1.cmml" xref="S3.Thmtheorem3.p1.8.8.m8.1.1.1.1">𝐐</ci><ci id="S3.Thmtheorem3.p1.8.8.m8.2.2.2.2.cmml" xref="S3.Thmtheorem3.p1.8.8.m8.2.2.2.2">𝐊</ci></set><ci id="S3.Thmtheorem3.p1.8.8.m8.3.3.3.3.cmml" xref="S3.Thmtheorem3.p1.8.8.m8.3.3.3.3">𝒢</ci></list></apply><apply id="S3.Thmtheorem3.p1.8.8.m8.4.5.3.cmml" xref="S3.Thmtheorem3.p1.8.8.m8.4.5.3"><csymbol cd="ambiguous" id="S3.Thmtheorem3.p1.8.8.m8.4.5.3.1.cmml" xref="S3.Thmtheorem3.p1.8.8.m8.4.5.3">superscript</csymbol><ci id="S3.Thmtheorem3.p1.8.8.m8.4.5.3.2.cmml" xref="S3.Thmtheorem3.p1.8.8.m8.4.5.3.2">ℝ</ci><apply id="S3.Thmtheorem3.p1.8.8.m8.4.5.3.3.cmml" xref="S3.Thmtheorem3.p1.8.8.m8.4.5.3.3"><times id="S3.Thmtheorem3.p1.8.8.m8.4.5.3.3.1.cmml" xref="S3.Thmtheorem3.p1.8.8.m8.4.5.3.3.1"></times><apply id="S3.Thmtheorem3.p1.8.8.m8.4.5.3.3.2.cmml" xref="S3.Thmtheorem3.p1.8.8.m8.4.5.3.3.2"><times id="S3.Thmtheorem3.p1.8.8.m8.4.5.3.3.2.1.cmml" xref="S3.Thmtheorem3.p1.8.8.m8.4.5.3.3.2.1"></times><ci id="S3.Thmtheorem3.p1.8.8.m8.4.5.3.3.2.2.cmml" xref="S3.Thmtheorem3.p1.8.8.m8.4.5.3.3.2.2">𝑁</ci><ci id="S3.Thmtheorem3.p1.8.8.m8.4.5.3.3.2.3.cmml" xref="S3.Thmtheorem3.p1.8.8.m8.4.5.3.3.2.3">𝑁</ci></apply><ci id="S3.Thmtheorem3.p1.8.8.m8.4.5.3.3.3.cmml" xref="S3.Thmtheorem3.p1.8.8.m8.4.5.3.3.3">𝑚</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmtheorem3.p1.8.8.m8.4c">\widehat{\mathbf{\Phi}}_{\{\mathbf{Q},\mathbf{K}\},\mathcal{G}}\in\mathbb{R}^{%
N\times Nm}</annotation><annotation encoding="application/x-llamapun" id="S3.Thmtheorem3.p1.8.8.m8.4d">over^ start_ARG bold_Φ end_ARG start_POSTSUBSCRIPT { bold_Q , bold_K } , caligraphic_G end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_N × italic_N italic_m end_POSTSUPERSCRIPT</annotation></semantics></math> is <em class="ltx_emph ltx_font_upright" id="S3.Thmtheorem3.p1.10.10.2">linear</em> in <math alttext="N" class="ltx_Math" display="inline" id="S3.Thmtheorem3.p1.9.9.m9.1"><semantics id="S3.Thmtheorem3.p1.9.9.m9.1a"><mi id="S3.Thmtheorem3.p1.9.9.m9.1.1" xref="S3.Thmtheorem3.p1.9.9.m9.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.Thmtheorem3.p1.9.9.m9.1b"><ci id="S3.Thmtheorem3.p1.9.9.m9.1.1.cmml" xref="S3.Thmtheorem3.p1.9.9.m9.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmtheorem3.p1.9.9.m9.1c">N</annotation><annotation encoding="application/x-llamapun" id="S3.Thmtheorem3.p1.9.9.m9.1d">italic_N</annotation></semantics></math>, which means that <span class="ltx_text ltx_font_bold" id="S3.Thmtheorem3.p1.10.10.1">topological masking is implemented with <math alttext="\mathcal{O}(N)" class="ltx_Math" display="inline" id="S3.Thmtheorem3.p1.10.10.1.m1.1"><semantics id="S3.Thmtheorem3.p1.10.10.1.m1.1a"><mrow id="S3.Thmtheorem3.p1.10.10.1.m1.1.2" xref="S3.Thmtheorem3.p1.10.10.1.m1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.Thmtheorem3.p1.10.10.1.m1.1.2.2" xref="S3.Thmtheorem3.p1.10.10.1.m1.1.2.2.cmml">𝒪</mi><mo id="S3.Thmtheorem3.p1.10.10.1.m1.1.2.1" xref="S3.Thmtheorem3.p1.10.10.1.m1.1.2.1.cmml">⁢</mo><mrow id="S3.Thmtheorem3.p1.10.10.1.m1.1.2.3.2" xref="S3.Thmtheorem3.p1.10.10.1.m1.1.2.cmml"><mo id="S3.Thmtheorem3.p1.10.10.1.m1.1.2.3.2.1" stretchy="false" xref="S3.Thmtheorem3.p1.10.10.1.m1.1.2.cmml">(</mo><mi id="S3.Thmtheorem3.p1.10.10.1.m1.1.1" mathvariant="normal" xref="S3.Thmtheorem3.p1.10.10.1.m1.1.1.cmml">N</mi><mo id="S3.Thmtheorem3.p1.10.10.1.m1.1.2.3.2.2" stretchy="false" xref="S3.Thmtheorem3.p1.10.10.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Thmtheorem3.p1.10.10.1.m1.1b"><apply id="S3.Thmtheorem3.p1.10.10.1.m1.1.2.cmml" xref="S3.Thmtheorem3.p1.10.10.1.m1.1.2"><times id="S3.Thmtheorem3.p1.10.10.1.m1.1.2.1.cmml" xref="S3.Thmtheorem3.p1.10.10.1.m1.1.2.1"></times><ci id="S3.Thmtheorem3.p1.10.10.1.m1.1.2.2.cmml" xref="S3.Thmtheorem3.p1.10.10.1.m1.1.2.2">𝒪</ci><ci id="S3.Thmtheorem3.p1.10.10.1.m1.1.1.cmml" xref="S3.Thmtheorem3.p1.10.10.1.m1.1.1">N</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmtheorem3.p1.10.10.1.m1.1c">\mathcal{O}(N)</annotation><annotation encoding="application/x-llamapun" id="S3.Thmtheorem3.p1.10.10.1.m1.1d">caligraphic_O ( italic_N )</annotation></semantics></math> time complexity</span>.</span></p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS4.p6">
<p class="ltx_p" id="S3.SS4.p6.12"><em class="ltx_emph ltx_font_italic" id="S3.SS4.p6.12.1">Proof.</em> Lemma <a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#S3.Thmtheorem2" title="Lemma 3.2 (GRF sparsity). ‣ 3.4 Novel theoretical results for GRFs: sharp estimators with sparse features ‣ 3 Towards linear topological masking ‣ Linear Transformer Topological Masking with Graph Random Features"><span class="ltx_text ltx_ref_tag">3.2</span></a> shows that the number of nonzero entries in <math alttext="\widehat{\phi}_{\mathcal{G}}(v_{i})" class="ltx_Math" display="inline" id="S3.SS4.p6.1.m1.1"><semantics id="S3.SS4.p6.1.m1.1a"><mrow id="S3.SS4.p6.1.m1.1.1" xref="S3.SS4.p6.1.m1.1.1.cmml"><msub id="S3.SS4.p6.1.m1.1.1.3" xref="S3.SS4.p6.1.m1.1.1.3.cmml"><mover accent="true" id="S3.SS4.p6.1.m1.1.1.3.2" xref="S3.SS4.p6.1.m1.1.1.3.2.cmml"><mi id="S3.SS4.p6.1.m1.1.1.3.2.2" xref="S3.SS4.p6.1.m1.1.1.3.2.2.cmml">ϕ</mi><mo id="S3.SS4.p6.1.m1.1.1.3.2.1" xref="S3.SS4.p6.1.m1.1.1.3.2.1.cmml">^</mo></mover><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p6.1.m1.1.1.3.3" xref="S3.SS4.p6.1.m1.1.1.3.3.cmml">𝒢</mi></msub><mo id="S3.SS4.p6.1.m1.1.1.2" xref="S3.SS4.p6.1.m1.1.1.2.cmml">⁢</mo><mrow id="S3.SS4.p6.1.m1.1.1.1.1" xref="S3.SS4.p6.1.m1.1.1.1.1.1.cmml"><mo id="S3.SS4.p6.1.m1.1.1.1.1.2" stretchy="false" xref="S3.SS4.p6.1.m1.1.1.1.1.1.cmml">(</mo><msub id="S3.SS4.p6.1.m1.1.1.1.1.1" xref="S3.SS4.p6.1.m1.1.1.1.1.1.cmml"><mi id="S3.SS4.p6.1.m1.1.1.1.1.1.2" xref="S3.SS4.p6.1.m1.1.1.1.1.1.2.cmml">v</mi><mi id="S3.SS4.p6.1.m1.1.1.1.1.1.3" xref="S3.SS4.p6.1.m1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS4.p6.1.m1.1.1.1.1.3" stretchy="false" xref="S3.SS4.p6.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p6.1.m1.1b"><apply id="S3.SS4.p6.1.m1.1.1.cmml" xref="S3.SS4.p6.1.m1.1.1"><times id="S3.SS4.p6.1.m1.1.1.2.cmml" xref="S3.SS4.p6.1.m1.1.1.2"></times><apply id="S3.SS4.p6.1.m1.1.1.3.cmml" xref="S3.SS4.p6.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.p6.1.m1.1.1.3.1.cmml" xref="S3.SS4.p6.1.m1.1.1.3">subscript</csymbol><apply id="S3.SS4.p6.1.m1.1.1.3.2.cmml" xref="S3.SS4.p6.1.m1.1.1.3.2"><ci id="S3.SS4.p6.1.m1.1.1.3.2.1.cmml" xref="S3.SS4.p6.1.m1.1.1.3.2.1">^</ci><ci id="S3.SS4.p6.1.m1.1.1.3.2.2.cmml" xref="S3.SS4.p6.1.m1.1.1.3.2.2">italic-ϕ</ci></apply><ci id="S3.SS4.p6.1.m1.1.1.3.3.cmml" xref="S3.SS4.p6.1.m1.1.1.3.3">𝒢</ci></apply><apply id="S3.SS4.p6.1.m1.1.1.1.1.1.cmml" xref="S3.SS4.p6.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p6.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS4.p6.1.m1.1.1.1.1">subscript</csymbol><ci id="S3.SS4.p6.1.m1.1.1.1.1.1.2.cmml" xref="S3.SS4.p6.1.m1.1.1.1.1.1.2">𝑣</ci><ci id="S3.SS4.p6.1.m1.1.1.1.1.1.3.cmml" xref="S3.SS4.p6.1.m1.1.1.1.1.1.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p6.1.m1.1c">\widehat{\phi}_{\mathcal{G}}(v_{i})</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p6.1.m1.1d">over^ start_ARG italic_ϕ end_ARG start_POSTSUBSCRIPT caligraphic_G end_POSTSUBSCRIPT ( italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT )</annotation></semantics></math> is independent of the number of nodes <math alttext="N" class="ltx_Math" display="inline" id="S3.SS4.p6.2.m2.1"><semantics id="S3.SS4.p6.2.m2.1a"><mi id="S3.SS4.p6.2.m2.1.1" xref="S3.SS4.p6.2.m2.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p6.2.m2.1b"><ci id="S3.SS4.p6.2.m2.1.1.cmml" xref="S3.SS4.p6.2.m2.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p6.2.m2.1c">N</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p6.2.m2.1d">italic_N</annotation></semantics></math>.
This must also be true of <math alttext="\textrm{vec}(\phi(\mathbf{k}_{i})\otimes\widehat{\phi}_{\mathcal{G}}(v_{i}))" class="ltx_Math" display="inline" id="S3.SS4.p6.3.m3.1"><semantics id="S3.SS4.p6.3.m3.1a"><mrow id="S3.SS4.p6.3.m3.1.1" xref="S3.SS4.p6.3.m3.1.1.cmml"><mtext id="S3.SS4.p6.3.m3.1.1.3" xref="S3.SS4.p6.3.m3.1.1.3a.cmml">vec</mtext><mo id="S3.SS4.p6.3.m3.1.1.2" xref="S3.SS4.p6.3.m3.1.1.2.cmml">⁢</mo><mrow id="S3.SS4.p6.3.m3.1.1.1.1" xref="S3.SS4.p6.3.m3.1.1.1.1.1.cmml"><mo id="S3.SS4.p6.3.m3.1.1.1.1.2" stretchy="false" xref="S3.SS4.p6.3.m3.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS4.p6.3.m3.1.1.1.1.1" xref="S3.SS4.p6.3.m3.1.1.1.1.1.cmml"><mrow id="S3.SS4.p6.3.m3.1.1.1.1.1.1" xref="S3.SS4.p6.3.m3.1.1.1.1.1.1.cmml"><mrow id="S3.SS4.p6.3.m3.1.1.1.1.1.1.1" xref="S3.SS4.p6.3.m3.1.1.1.1.1.1.1.cmml"><mi id="S3.SS4.p6.3.m3.1.1.1.1.1.1.1.3" xref="S3.SS4.p6.3.m3.1.1.1.1.1.1.1.3.cmml">ϕ</mi><mo id="S3.SS4.p6.3.m3.1.1.1.1.1.1.1.2" xref="S3.SS4.p6.3.m3.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.SS4.p6.3.m3.1.1.1.1.1.1.1.1.1" xref="S3.SS4.p6.3.m3.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.SS4.p6.3.m3.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.SS4.p6.3.m3.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.SS4.p6.3.m3.1.1.1.1.1.1.1.1.1.1" xref="S3.SS4.p6.3.m3.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.SS4.p6.3.m3.1.1.1.1.1.1.1.1.1.1.2" xref="S3.SS4.p6.3.m3.1.1.1.1.1.1.1.1.1.1.2.cmml">𝐤</mi><mi id="S3.SS4.p6.3.m3.1.1.1.1.1.1.1.1.1.1.3" xref="S3.SS4.p6.3.m3.1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS4.p6.3.m3.1.1.1.1.1.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="S3.SS4.p6.3.m3.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS4.p6.3.m3.1.1.1.1.1.1.2" rspace="0.222em" xref="S3.SS4.p6.3.m3.1.1.1.1.1.1.2.cmml">⊗</mo><msub id="S3.SS4.p6.3.m3.1.1.1.1.1.1.3" xref="S3.SS4.p6.3.m3.1.1.1.1.1.1.3.cmml"><mover accent="true" id="S3.SS4.p6.3.m3.1.1.1.1.1.1.3.2" xref="S3.SS4.p6.3.m3.1.1.1.1.1.1.3.2.cmml"><mi id="S3.SS4.p6.3.m3.1.1.1.1.1.1.3.2.2" xref="S3.SS4.p6.3.m3.1.1.1.1.1.1.3.2.2.cmml">ϕ</mi><mo id="S3.SS4.p6.3.m3.1.1.1.1.1.1.3.2.1" xref="S3.SS4.p6.3.m3.1.1.1.1.1.1.3.2.1.cmml">^</mo></mover><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p6.3.m3.1.1.1.1.1.1.3.3" xref="S3.SS4.p6.3.m3.1.1.1.1.1.1.3.3.cmml">𝒢</mi></msub></mrow><mo id="S3.SS4.p6.3.m3.1.1.1.1.1.3" xref="S3.SS4.p6.3.m3.1.1.1.1.1.3.cmml">⁢</mo><mrow id="S3.SS4.p6.3.m3.1.1.1.1.1.2.1" xref="S3.SS4.p6.3.m3.1.1.1.1.1.2.1.1.cmml"><mo id="S3.SS4.p6.3.m3.1.1.1.1.1.2.1.2" stretchy="false" xref="S3.SS4.p6.3.m3.1.1.1.1.1.2.1.1.cmml">(</mo><msub id="S3.SS4.p6.3.m3.1.1.1.1.1.2.1.1" xref="S3.SS4.p6.3.m3.1.1.1.1.1.2.1.1.cmml"><mi id="S3.SS4.p6.3.m3.1.1.1.1.1.2.1.1.2" xref="S3.SS4.p6.3.m3.1.1.1.1.1.2.1.1.2.cmml">v</mi><mi id="S3.SS4.p6.3.m3.1.1.1.1.1.2.1.1.3" xref="S3.SS4.p6.3.m3.1.1.1.1.1.2.1.1.3.cmml">i</mi></msub><mo id="S3.SS4.p6.3.m3.1.1.1.1.1.2.1.3" stretchy="false" xref="S3.SS4.p6.3.m3.1.1.1.1.1.2.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS4.p6.3.m3.1.1.1.1.3" stretchy="false" xref="S3.SS4.p6.3.m3.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p6.3.m3.1b"><apply id="S3.SS4.p6.3.m3.1.1.cmml" xref="S3.SS4.p6.3.m3.1.1"><times id="S3.SS4.p6.3.m3.1.1.2.cmml" xref="S3.SS4.p6.3.m3.1.1.2"></times><ci id="S3.SS4.p6.3.m3.1.1.3a.cmml" xref="S3.SS4.p6.3.m3.1.1.3"><mtext id="S3.SS4.p6.3.m3.1.1.3.cmml" xref="S3.SS4.p6.3.m3.1.1.3">vec</mtext></ci><apply id="S3.SS4.p6.3.m3.1.1.1.1.1.cmml" xref="S3.SS4.p6.3.m3.1.1.1.1"><times id="S3.SS4.p6.3.m3.1.1.1.1.1.3.cmml" xref="S3.SS4.p6.3.m3.1.1.1.1.1.3"></times><apply id="S3.SS4.p6.3.m3.1.1.1.1.1.1.cmml" xref="S3.SS4.p6.3.m3.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.SS4.p6.3.m3.1.1.1.1.1.1.2.cmml" xref="S3.SS4.p6.3.m3.1.1.1.1.1.1.2">tensor-product</csymbol><apply id="S3.SS4.p6.3.m3.1.1.1.1.1.1.1.cmml" xref="S3.SS4.p6.3.m3.1.1.1.1.1.1.1"><times id="S3.SS4.p6.3.m3.1.1.1.1.1.1.1.2.cmml" xref="S3.SS4.p6.3.m3.1.1.1.1.1.1.1.2"></times><ci id="S3.SS4.p6.3.m3.1.1.1.1.1.1.1.3.cmml" xref="S3.SS4.p6.3.m3.1.1.1.1.1.1.1.3">italic-ϕ</ci><apply id="S3.SS4.p6.3.m3.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS4.p6.3.m3.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p6.3.m3.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS4.p6.3.m3.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS4.p6.3.m3.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.SS4.p6.3.m3.1.1.1.1.1.1.1.1.1.1.2">𝐤</ci><ci id="S3.SS4.p6.3.m3.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.SS4.p6.3.m3.1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply><apply id="S3.SS4.p6.3.m3.1.1.1.1.1.1.3.cmml" xref="S3.SS4.p6.3.m3.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.p6.3.m3.1.1.1.1.1.1.3.1.cmml" xref="S3.SS4.p6.3.m3.1.1.1.1.1.1.3">subscript</csymbol><apply id="S3.SS4.p6.3.m3.1.1.1.1.1.1.3.2.cmml" xref="S3.SS4.p6.3.m3.1.1.1.1.1.1.3.2"><ci id="S3.SS4.p6.3.m3.1.1.1.1.1.1.3.2.1.cmml" xref="S3.SS4.p6.3.m3.1.1.1.1.1.1.3.2.1">^</ci><ci id="S3.SS4.p6.3.m3.1.1.1.1.1.1.3.2.2.cmml" xref="S3.SS4.p6.3.m3.1.1.1.1.1.1.3.2.2">italic-ϕ</ci></apply><ci id="S3.SS4.p6.3.m3.1.1.1.1.1.1.3.3.cmml" xref="S3.SS4.p6.3.m3.1.1.1.1.1.1.3.3">𝒢</ci></apply></apply><apply id="S3.SS4.p6.3.m3.1.1.1.1.1.2.1.1.cmml" xref="S3.SS4.p6.3.m3.1.1.1.1.1.2.1"><csymbol cd="ambiguous" id="S3.SS4.p6.3.m3.1.1.1.1.1.2.1.1.1.cmml" xref="S3.SS4.p6.3.m3.1.1.1.1.1.2.1">subscript</csymbol><ci id="S3.SS4.p6.3.m3.1.1.1.1.1.2.1.1.2.cmml" xref="S3.SS4.p6.3.m3.1.1.1.1.1.2.1.1.2">𝑣</ci><ci id="S3.SS4.p6.3.m3.1.1.1.1.1.2.1.1.3.cmml" xref="S3.SS4.p6.3.m3.1.1.1.1.1.2.1.1.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p6.3.m3.1c">\textrm{vec}(\phi(\mathbf{k}_{i})\otimes\widehat{\phi}_{\mathcal{G}}(v_{i}))</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p6.3.m3.1d">vec ( italic_ϕ ( bold_k start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) ⊗ over^ start_ARG italic_ϕ end_ARG start_POSTSUBSCRIPT caligraphic_G end_POSTSUBSCRIPT ( italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) )</annotation></semantics></math>, so the number of nonzero entries in <math alttext="\widehat{\mathbf{\Phi}}_{\mathbf{K},\mathcal{G}}\coloneqq[\mathrm{vec}(\phi(%
\mathbf{k}_{i})\otimes\widehat{\phi}_{\mathcal{G}}(v_{i}))]_{i=1}^{N}" class="ltx_Math" display="inline" id="S3.SS4.p6.4.m4.3"><semantics id="S3.SS4.p6.4.m4.3a"><mrow id="S3.SS4.p6.4.m4.3.3" xref="S3.SS4.p6.4.m4.3.3.cmml"><msub id="S3.SS4.p6.4.m4.3.3.3" xref="S3.SS4.p6.4.m4.3.3.3.cmml"><mover accent="true" id="S3.SS4.p6.4.m4.3.3.3.2" xref="S3.SS4.p6.4.m4.3.3.3.2.cmml"><mi id="S3.SS4.p6.4.m4.3.3.3.2.2" xref="S3.SS4.p6.4.m4.3.3.3.2.2.cmml">𝚽</mi><mo id="S3.SS4.p6.4.m4.3.3.3.2.1" xref="S3.SS4.p6.4.m4.3.3.3.2.1.cmml">^</mo></mover><mrow id="S3.SS4.p6.4.m4.2.2.2.4" xref="S3.SS4.p6.4.m4.2.2.2.3.cmml"><mi id="S3.SS4.p6.4.m4.1.1.1.1" xref="S3.SS4.p6.4.m4.1.1.1.1.cmml">𝐊</mi><mo id="S3.SS4.p6.4.m4.2.2.2.4.1" xref="S3.SS4.p6.4.m4.2.2.2.3.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p6.4.m4.2.2.2.2" xref="S3.SS4.p6.4.m4.2.2.2.2.cmml">𝒢</mi></mrow></msub><mo id="S3.SS4.p6.4.m4.3.3.2" xref="S3.SS4.p6.4.m4.3.3.2.cmml">≔</mo><msubsup id="S3.SS4.p6.4.m4.3.3.1" xref="S3.SS4.p6.4.m4.3.3.1.cmml"><mrow id="S3.SS4.p6.4.m4.3.3.1.1.1.1" xref="S3.SS4.p6.4.m4.3.3.1.1.1.2.cmml"><mo id="S3.SS4.p6.4.m4.3.3.1.1.1.1.2" stretchy="false" xref="S3.SS4.p6.4.m4.3.3.1.1.1.2.1.cmml">[</mo><mrow id="S3.SS4.p6.4.m4.3.3.1.1.1.1.1" xref="S3.SS4.p6.4.m4.3.3.1.1.1.1.1.cmml"><mi id="S3.SS4.p6.4.m4.3.3.1.1.1.1.1.3" xref="S3.SS4.p6.4.m4.3.3.1.1.1.1.1.3.cmml">vec</mi><mo id="S3.SS4.p6.4.m4.3.3.1.1.1.1.1.2" xref="S3.SS4.p6.4.m4.3.3.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.SS4.p6.4.m4.3.3.1.1.1.1.1.1.1" xref="S3.SS4.p6.4.m4.3.3.1.1.1.1.1.1.1.1.cmml"><mo id="S3.SS4.p6.4.m4.3.3.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.SS4.p6.4.m4.3.3.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS4.p6.4.m4.3.3.1.1.1.1.1.1.1.1" xref="S3.SS4.p6.4.m4.3.3.1.1.1.1.1.1.1.1.cmml"><mrow id="S3.SS4.p6.4.m4.3.3.1.1.1.1.1.1.1.1.1" xref="S3.SS4.p6.4.m4.3.3.1.1.1.1.1.1.1.1.1.cmml"><mrow id="S3.SS4.p6.4.m4.3.3.1.1.1.1.1.1.1.1.1.1" xref="S3.SS4.p6.4.m4.3.3.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.SS4.p6.4.m4.3.3.1.1.1.1.1.1.1.1.1.1.3" xref="S3.SS4.p6.4.m4.3.3.1.1.1.1.1.1.1.1.1.1.3.cmml">ϕ</mi><mo id="S3.SS4.p6.4.m4.3.3.1.1.1.1.1.1.1.1.1.1.2" xref="S3.SS4.p6.4.m4.3.3.1.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.SS4.p6.4.m4.3.3.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.SS4.p6.4.m4.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.SS4.p6.4.m4.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.SS4.p6.4.m4.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.SS4.p6.4.m4.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.SS4.p6.4.m4.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.SS4.p6.4.m4.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.SS4.p6.4.m4.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">𝐤</mi><mi id="S3.SS4.p6.4.m4.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.SS4.p6.4.m4.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS4.p6.4.m4.3.3.1.1.1.1.1.1.1.1.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="S3.SS4.p6.4.m4.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS4.p6.4.m4.3.3.1.1.1.1.1.1.1.1.1.2" rspace="0.222em" xref="S3.SS4.p6.4.m4.3.3.1.1.1.1.1.1.1.1.1.2.cmml">⊗</mo><msub id="S3.SS4.p6.4.m4.3.3.1.1.1.1.1.1.1.1.1.3" xref="S3.SS4.p6.4.m4.3.3.1.1.1.1.1.1.1.1.1.3.cmml"><mover accent="true" id="S3.SS4.p6.4.m4.3.3.1.1.1.1.1.1.1.1.1.3.2" xref="S3.SS4.p6.4.m4.3.3.1.1.1.1.1.1.1.1.1.3.2.cmml"><mi id="S3.SS4.p6.4.m4.3.3.1.1.1.1.1.1.1.1.1.3.2.2" xref="S3.SS4.p6.4.m4.3.3.1.1.1.1.1.1.1.1.1.3.2.2.cmml">ϕ</mi><mo id="S3.SS4.p6.4.m4.3.3.1.1.1.1.1.1.1.1.1.3.2.1" xref="S3.SS4.p6.4.m4.3.3.1.1.1.1.1.1.1.1.1.3.2.1.cmml">^</mo></mover><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p6.4.m4.3.3.1.1.1.1.1.1.1.1.1.3.3" xref="S3.SS4.p6.4.m4.3.3.1.1.1.1.1.1.1.1.1.3.3.cmml">𝒢</mi></msub></mrow><mo id="S3.SS4.p6.4.m4.3.3.1.1.1.1.1.1.1.1.3" xref="S3.SS4.p6.4.m4.3.3.1.1.1.1.1.1.1.1.3.cmml">⁢</mo><mrow id="S3.SS4.p6.4.m4.3.3.1.1.1.1.1.1.1.1.2.1" xref="S3.SS4.p6.4.m4.3.3.1.1.1.1.1.1.1.1.2.1.1.cmml"><mo id="S3.SS4.p6.4.m4.3.3.1.1.1.1.1.1.1.1.2.1.2" stretchy="false" xref="S3.SS4.p6.4.m4.3.3.1.1.1.1.1.1.1.1.2.1.1.cmml">(</mo><msub id="S3.SS4.p6.4.m4.3.3.1.1.1.1.1.1.1.1.2.1.1" xref="S3.SS4.p6.4.m4.3.3.1.1.1.1.1.1.1.1.2.1.1.cmml"><mi id="S3.SS4.p6.4.m4.3.3.1.1.1.1.1.1.1.1.2.1.1.2" xref="S3.SS4.p6.4.m4.3.3.1.1.1.1.1.1.1.1.2.1.1.2.cmml">v</mi><mi id="S3.SS4.p6.4.m4.3.3.1.1.1.1.1.1.1.1.2.1.1.3" xref="S3.SS4.p6.4.m4.3.3.1.1.1.1.1.1.1.1.2.1.1.3.cmml">i</mi></msub><mo id="S3.SS4.p6.4.m4.3.3.1.1.1.1.1.1.1.1.2.1.3" stretchy="false" xref="S3.SS4.p6.4.m4.3.3.1.1.1.1.1.1.1.1.2.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS4.p6.4.m4.3.3.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.SS4.p6.4.m4.3.3.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS4.p6.4.m4.3.3.1.1.1.1.3" stretchy="false" xref="S3.SS4.p6.4.m4.3.3.1.1.1.2.1.cmml">]</mo></mrow><mrow id="S3.SS4.p6.4.m4.3.3.1.1.3" xref="S3.SS4.p6.4.m4.3.3.1.1.3.cmml"><mi id="S3.SS4.p6.4.m4.3.3.1.1.3.2" xref="S3.SS4.p6.4.m4.3.3.1.1.3.2.cmml">i</mi><mo id="S3.SS4.p6.4.m4.3.3.1.1.3.1" xref="S3.SS4.p6.4.m4.3.3.1.1.3.1.cmml">=</mo><mn id="S3.SS4.p6.4.m4.3.3.1.1.3.3" xref="S3.SS4.p6.4.m4.3.3.1.1.3.3.cmml">1</mn></mrow><mi id="S3.SS4.p6.4.m4.3.3.1.3" xref="S3.SS4.p6.4.m4.3.3.1.3.cmml">N</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p6.4.m4.3b"><apply id="S3.SS4.p6.4.m4.3.3.cmml" xref="S3.SS4.p6.4.m4.3.3"><ci id="S3.SS4.p6.4.m4.3.3.2.cmml" xref="S3.SS4.p6.4.m4.3.3.2">≔</ci><apply id="S3.SS4.p6.4.m4.3.3.3.cmml" xref="S3.SS4.p6.4.m4.3.3.3"><csymbol cd="ambiguous" id="S3.SS4.p6.4.m4.3.3.3.1.cmml" xref="S3.SS4.p6.4.m4.3.3.3">subscript</csymbol><apply id="S3.SS4.p6.4.m4.3.3.3.2.cmml" xref="S3.SS4.p6.4.m4.3.3.3.2"><ci id="S3.SS4.p6.4.m4.3.3.3.2.1.cmml" xref="S3.SS4.p6.4.m4.3.3.3.2.1">^</ci><ci id="S3.SS4.p6.4.m4.3.3.3.2.2.cmml" xref="S3.SS4.p6.4.m4.3.3.3.2.2">𝚽</ci></apply><list id="S3.SS4.p6.4.m4.2.2.2.3.cmml" xref="S3.SS4.p6.4.m4.2.2.2.4"><ci id="S3.SS4.p6.4.m4.1.1.1.1.cmml" xref="S3.SS4.p6.4.m4.1.1.1.1">𝐊</ci><ci id="S3.SS4.p6.4.m4.2.2.2.2.cmml" xref="S3.SS4.p6.4.m4.2.2.2.2">𝒢</ci></list></apply><apply id="S3.SS4.p6.4.m4.3.3.1.cmml" xref="S3.SS4.p6.4.m4.3.3.1"><csymbol cd="ambiguous" id="S3.SS4.p6.4.m4.3.3.1.2.cmml" xref="S3.SS4.p6.4.m4.3.3.1">superscript</csymbol><apply id="S3.SS4.p6.4.m4.3.3.1.1.cmml" xref="S3.SS4.p6.4.m4.3.3.1"><csymbol cd="ambiguous" id="S3.SS4.p6.4.m4.3.3.1.1.2.cmml" xref="S3.SS4.p6.4.m4.3.3.1">subscript</csymbol><apply id="S3.SS4.p6.4.m4.3.3.1.1.1.2.cmml" xref="S3.SS4.p6.4.m4.3.3.1.1.1.1"><csymbol cd="latexml" id="S3.SS4.p6.4.m4.3.3.1.1.1.2.1.cmml" xref="S3.SS4.p6.4.m4.3.3.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.SS4.p6.4.m4.3.3.1.1.1.1.1.cmml" xref="S3.SS4.p6.4.m4.3.3.1.1.1.1.1"><times id="S3.SS4.p6.4.m4.3.3.1.1.1.1.1.2.cmml" xref="S3.SS4.p6.4.m4.3.3.1.1.1.1.1.2"></times><ci id="S3.SS4.p6.4.m4.3.3.1.1.1.1.1.3.cmml" xref="S3.SS4.p6.4.m4.3.3.1.1.1.1.1.3">vec</ci><apply id="S3.SS4.p6.4.m4.3.3.1.1.1.1.1.1.1.1.cmml" xref="S3.SS4.p6.4.m4.3.3.1.1.1.1.1.1.1"><times id="S3.SS4.p6.4.m4.3.3.1.1.1.1.1.1.1.1.3.cmml" xref="S3.SS4.p6.4.m4.3.3.1.1.1.1.1.1.1.1.3"></times><apply id="S3.SS4.p6.4.m4.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS4.p6.4.m4.3.3.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.SS4.p6.4.m4.3.3.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.SS4.p6.4.m4.3.3.1.1.1.1.1.1.1.1.1.2">tensor-product</csymbol><apply id="S3.SS4.p6.4.m4.3.3.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS4.p6.4.m4.3.3.1.1.1.1.1.1.1.1.1.1"><times id="S3.SS4.p6.4.m4.3.3.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.SS4.p6.4.m4.3.3.1.1.1.1.1.1.1.1.1.1.2"></times><ci id="S3.SS4.p6.4.m4.3.3.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.SS4.p6.4.m4.3.3.1.1.1.1.1.1.1.1.1.1.3">italic-ϕ</ci><apply id="S3.SS4.p6.4.m4.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS4.p6.4.m4.3.3.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p6.4.m4.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS4.p6.4.m4.3.3.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS4.p6.4.m4.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.SS4.p6.4.m4.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.2">𝐤</ci><ci id="S3.SS4.p6.4.m4.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.SS4.p6.4.m4.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply><apply id="S3.SS4.p6.4.m4.3.3.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.SS4.p6.4.m4.3.3.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.p6.4.m4.3.3.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.SS4.p6.4.m4.3.3.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><apply id="S3.SS4.p6.4.m4.3.3.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.SS4.p6.4.m4.3.3.1.1.1.1.1.1.1.1.1.3.2"><ci id="S3.SS4.p6.4.m4.3.3.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.SS4.p6.4.m4.3.3.1.1.1.1.1.1.1.1.1.3.2.1">^</ci><ci id="S3.SS4.p6.4.m4.3.3.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.SS4.p6.4.m4.3.3.1.1.1.1.1.1.1.1.1.3.2.2">italic-ϕ</ci></apply><ci id="S3.SS4.p6.4.m4.3.3.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.SS4.p6.4.m4.3.3.1.1.1.1.1.1.1.1.1.3.3">𝒢</ci></apply></apply><apply id="S3.SS4.p6.4.m4.3.3.1.1.1.1.1.1.1.1.2.1.1.cmml" xref="S3.SS4.p6.4.m4.3.3.1.1.1.1.1.1.1.1.2.1"><csymbol cd="ambiguous" id="S3.SS4.p6.4.m4.3.3.1.1.1.1.1.1.1.1.2.1.1.1.cmml" xref="S3.SS4.p6.4.m4.3.3.1.1.1.1.1.1.1.1.2.1">subscript</csymbol><ci id="S3.SS4.p6.4.m4.3.3.1.1.1.1.1.1.1.1.2.1.1.2.cmml" xref="S3.SS4.p6.4.m4.3.3.1.1.1.1.1.1.1.1.2.1.1.2">𝑣</ci><ci id="S3.SS4.p6.4.m4.3.3.1.1.1.1.1.1.1.1.2.1.1.3.cmml" xref="S3.SS4.p6.4.m4.3.3.1.1.1.1.1.1.1.1.2.1.1.3">𝑖</ci></apply></apply></apply></apply><apply id="S3.SS4.p6.4.m4.3.3.1.1.3.cmml" xref="S3.SS4.p6.4.m4.3.3.1.1.3"><eq id="S3.SS4.p6.4.m4.3.3.1.1.3.1.cmml" xref="S3.SS4.p6.4.m4.3.3.1.1.3.1"></eq><ci id="S3.SS4.p6.4.m4.3.3.1.1.3.2.cmml" xref="S3.SS4.p6.4.m4.3.3.1.1.3.2">𝑖</ci><cn id="S3.SS4.p6.4.m4.3.3.1.1.3.3.cmml" type="integer" xref="S3.SS4.p6.4.m4.3.3.1.1.3.3">1</cn></apply></apply><ci id="S3.SS4.p6.4.m4.3.3.1.3.cmml" xref="S3.SS4.p6.4.m4.3.3.1.3">𝑁</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p6.4.m4.3c">\widehat{\mathbf{\Phi}}_{\mathbf{K},\mathcal{G}}\coloneqq[\mathrm{vec}(\phi(%
\mathbf{k}_{i})\otimes\widehat{\phi}_{\mathcal{G}}(v_{i}))]_{i=1}^{N}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p6.4.m4.3d">over^ start_ARG bold_Φ end_ARG start_POSTSUBSCRIPT bold_K , caligraphic_G end_POSTSUBSCRIPT ≔ [ roman_vec ( italic_ϕ ( bold_k start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) ⊗ over^ start_ARG italic_ϕ end_ARG start_POSTSUBSCRIPT caligraphic_G end_POSTSUBSCRIPT ( italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) ) ] start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT</annotation></semantics></math> is proportional to <math alttext="N" class="ltx_Math" display="inline" id="S3.SS4.p6.5.m5.1"><semantics id="S3.SS4.p6.5.m5.1a"><mi id="S3.SS4.p6.5.m5.1.1" xref="S3.SS4.p6.5.m5.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p6.5.m5.1b"><ci id="S3.SS4.p6.5.m5.1.1.cmml" xref="S3.SS4.p6.5.m5.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p6.5.m5.1c">N</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p6.5.m5.1d">italic_N</annotation></semantics></math>.
The same holds for the equivalent matrix for the queries, <math alttext="\smash{\widehat{\mathbf{\Phi}}_{\mathbf{Q},\mathcal{G}}}" class="ltx_Math" display="inline" id="S3.SS4.p6.6.m6.2"><semantics id="S3.SS4.p6.6.m6.2a"><msub id="S3.SS4.p6.6.m6.2.3" xref="S3.SS4.p6.6.m6.2.3.cmml"><mover accent="true" id="S3.SS4.p6.6.m6.2.3.2" xref="S3.SS4.p6.6.m6.2.3.2.cmml"><mi id="S3.SS4.p6.6.m6.2.3.2.2" xref="S3.SS4.p6.6.m6.2.3.2.2.cmml">𝚽</mi><mo id="S3.SS4.p6.6.m6.2.3.2.1" xref="S3.SS4.p6.6.m6.2.3.2.1.cmml">^</mo></mover><mrow id="S3.SS4.p6.6.m6.2.2.2.4" xref="S3.SS4.p6.6.m6.2.2.2.3.cmml"><mi id="S3.SS4.p6.6.m6.1.1.1.1" xref="S3.SS4.p6.6.m6.1.1.1.1.cmml">𝐐</mi><mo id="S3.SS4.p6.6.m6.2.2.2.4.1" xref="S3.SS4.p6.6.m6.2.2.2.3.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p6.6.m6.2.2.2.2" xref="S3.SS4.p6.6.m6.2.2.2.2.cmml">𝒢</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p6.6.m6.2b"><apply id="S3.SS4.p6.6.m6.2.3.cmml" xref="S3.SS4.p6.6.m6.2.3"><csymbol cd="ambiguous" id="S3.SS4.p6.6.m6.2.3.1.cmml" xref="S3.SS4.p6.6.m6.2.3">subscript</csymbol><apply id="S3.SS4.p6.6.m6.2.3.2.cmml" xref="S3.SS4.p6.6.m6.2.3.2"><ci id="S3.SS4.p6.6.m6.2.3.2.1.cmml" xref="S3.SS4.p6.6.m6.2.3.2.1">^</ci><ci id="S3.SS4.p6.6.m6.2.3.2.2.cmml" xref="S3.SS4.p6.6.m6.2.3.2.2">𝚽</ci></apply><list id="S3.SS4.p6.6.m6.2.2.2.3.cmml" xref="S3.SS4.p6.6.m6.2.2.2.4"><ci id="S3.SS4.p6.6.m6.1.1.1.1.cmml" xref="S3.SS4.p6.6.m6.1.1.1.1">𝐐</ci><ci id="S3.SS4.p6.6.m6.2.2.2.2.cmml" xref="S3.SS4.p6.6.m6.2.2.2.2">𝒢</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p6.6.m6.2c">\smash{\widehat{\mathbf{\Phi}}_{\mathbf{Q},\mathcal{G}}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p6.6.m6.2d">over^ start_ARG bold_Φ end_ARG start_POSTSUBSCRIPT bold_Q , caligraphic_G end_POSTSUBSCRIPT</annotation></semantics></math>.
The time complexity of the sparse matrix-matrix multiplication <math alttext="\widehat{\mathbf{\Phi}}_{\mathbf{K},\mathcal{G}}^{\top}\mathbf{V}" class="ltx_Math" display="inline" id="S3.SS4.p6.7.m7.2"><semantics id="S3.SS4.p6.7.m7.2a"><mrow id="S3.SS4.p6.7.m7.2.3" xref="S3.SS4.p6.7.m7.2.3.cmml"><msubsup id="S3.SS4.p6.7.m7.2.3.2" xref="S3.SS4.p6.7.m7.2.3.2.cmml"><mover accent="true" id="S3.SS4.p6.7.m7.2.3.2.2.2" xref="S3.SS4.p6.7.m7.2.3.2.2.2.cmml"><mi id="S3.SS4.p6.7.m7.2.3.2.2.2.2" xref="S3.SS4.p6.7.m7.2.3.2.2.2.2.cmml">𝚽</mi><mo id="S3.SS4.p6.7.m7.2.3.2.2.2.1" xref="S3.SS4.p6.7.m7.2.3.2.2.2.1.cmml">^</mo></mover><mrow id="S3.SS4.p6.7.m7.2.2.2.4" xref="S3.SS4.p6.7.m7.2.2.2.3.cmml"><mi id="S3.SS4.p6.7.m7.1.1.1.1" xref="S3.SS4.p6.7.m7.1.1.1.1.cmml">𝐊</mi><mo id="S3.SS4.p6.7.m7.2.2.2.4.1" xref="S3.SS4.p6.7.m7.2.2.2.3.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p6.7.m7.2.2.2.2" xref="S3.SS4.p6.7.m7.2.2.2.2.cmml">𝒢</mi></mrow><mo id="S3.SS4.p6.7.m7.2.3.2.3" xref="S3.SS4.p6.7.m7.2.3.2.3.cmml">⊤</mo></msubsup><mo id="S3.SS4.p6.7.m7.2.3.1" xref="S3.SS4.p6.7.m7.2.3.1.cmml">⁢</mo><mi id="S3.SS4.p6.7.m7.2.3.3" xref="S3.SS4.p6.7.m7.2.3.3.cmml">𝐕</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p6.7.m7.2b"><apply id="S3.SS4.p6.7.m7.2.3.cmml" xref="S3.SS4.p6.7.m7.2.3"><times id="S3.SS4.p6.7.m7.2.3.1.cmml" xref="S3.SS4.p6.7.m7.2.3.1"></times><apply id="S3.SS4.p6.7.m7.2.3.2.cmml" xref="S3.SS4.p6.7.m7.2.3.2"><csymbol cd="ambiguous" id="S3.SS4.p6.7.m7.2.3.2.1.cmml" xref="S3.SS4.p6.7.m7.2.3.2">superscript</csymbol><apply id="S3.SS4.p6.7.m7.2.3.2.2.cmml" xref="S3.SS4.p6.7.m7.2.3.2"><csymbol cd="ambiguous" id="S3.SS4.p6.7.m7.2.3.2.2.1.cmml" xref="S3.SS4.p6.7.m7.2.3.2">subscript</csymbol><apply id="S3.SS4.p6.7.m7.2.3.2.2.2.cmml" xref="S3.SS4.p6.7.m7.2.3.2.2.2"><ci id="S3.SS4.p6.7.m7.2.3.2.2.2.1.cmml" xref="S3.SS4.p6.7.m7.2.3.2.2.2.1">^</ci><ci id="S3.SS4.p6.7.m7.2.3.2.2.2.2.cmml" xref="S3.SS4.p6.7.m7.2.3.2.2.2.2">𝚽</ci></apply><list id="S3.SS4.p6.7.m7.2.2.2.3.cmml" xref="S3.SS4.p6.7.m7.2.2.2.4"><ci id="S3.SS4.p6.7.m7.1.1.1.1.cmml" xref="S3.SS4.p6.7.m7.1.1.1.1">𝐊</ci><ci id="S3.SS4.p6.7.m7.2.2.2.2.cmml" xref="S3.SS4.p6.7.m7.2.2.2.2">𝒢</ci></list></apply><csymbol cd="latexml" id="S3.SS4.p6.7.m7.2.3.2.3.cmml" xref="S3.SS4.p6.7.m7.2.3.2.3">top</csymbol></apply><ci id="S3.SS4.p6.7.m7.2.3.3.cmml" xref="S3.SS4.p6.7.m7.2.3.3">𝐕</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p6.7.m7.2c">\widehat{\mathbf{\Phi}}_{\mathbf{K},\mathcal{G}}^{\top}\mathbf{V}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p6.7.m7.2d">over^ start_ARG bold_Φ end_ARG start_POSTSUBSCRIPT bold_K , caligraphic_G end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT bold_V</annotation></semantics></math> is <math alttext="\mathcal{O}(Nmd)" class="ltx_Math" display="inline" id="S3.SS4.p6.8.m8.1"><semantics id="S3.SS4.p6.8.m8.1a"><mrow id="S3.SS4.p6.8.m8.1.1" xref="S3.SS4.p6.8.m8.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p6.8.m8.1.1.3" xref="S3.SS4.p6.8.m8.1.1.3.cmml">𝒪</mi><mo id="S3.SS4.p6.8.m8.1.1.2" xref="S3.SS4.p6.8.m8.1.1.2.cmml">⁢</mo><mrow id="S3.SS4.p6.8.m8.1.1.1.1" xref="S3.SS4.p6.8.m8.1.1.1.1.1.cmml"><mo id="S3.SS4.p6.8.m8.1.1.1.1.2" stretchy="false" xref="S3.SS4.p6.8.m8.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS4.p6.8.m8.1.1.1.1.1" xref="S3.SS4.p6.8.m8.1.1.1.1.1.cmml"><mi id="S3.SS4.p6.8.m8.1.1.1.1.1.2" xref="S3.SS4.p6.8.m8.1.1.1.1.1.2.cmml">N</mi><mo id="S3.SS4.p6.8.m8.1.1.1.1.1.1" xref="S3.SS4.p6.8.m8.1.1.1.1.1.1.cmml">⁢</mo><mi id="S3.SS4.p6.8.m8.1.1.1.1.1.3" xref="S3.SS4.p6.8.m8.1.1.1.1.1.3.cmml">m</mi><mo id="S3.SS4.p6.8.m8.1.1.1.1.1.1a" xref="S3.SS4.p6.8.m8.1.1.1.1.1.1.cmml">⁢</mo><mi id="S3.SS4.p6.8.m8.1.1.1.1.1.4" xref="S3.SS4.p6.8.m8.1.1.1.1.1.4.cmml">d</mi></mrow><mo id="S3.SS4.p6.8.m8.1.1.1.1.3" stretchy="false" xref="S3.SS4.p6.8.m8.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p6.8.m8.1b"><apply id="S3.SS4.p6.8.m8.1.1.cmml" xref="S3.SS4.p6.8.m8.1.1"><times id="S3.SS4.p6.8.m8.1.1.2.cmml" xref="S3.SS4.p6.8.m8.1.1.2"></times><ci id="S3.SS4.p6.8.m8.1.1.3.cmml" xref="S3.SS4.p6.8.m8.1.1.3">𝒪</ci><apply id="S3.SS4.p6.8.m8.1.1.1.1.1.cmml" xref="S3.SS4.p6.8.m8.1.1.1.1"><times id="S3.SS4.p6.8.m8.1.1.1.1.1.1.cmml" xref="S3.SS4.p6.8.m8.1.1.1.1.1.1"></times><ci id="S3.SS4.p6.8.m8.1.1.1.1.1.2.cmml" xref="S3.SS4.p6.8.m8.1.1.1.1.1.2">𝑁</ci><ci id="S3.SS4.p6.8.m8.1.1.1.1.1.3.cmml" xref="S3.SS4.p6.8.m8.1.1.1.1.1.3">𝑚</ci><ci id="S3.SS4.p6.8.m8.1.1.1.1.1.4.cmml" xref="S3.SS4.p6.8.m8.1.1.1.1.1.4">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p6.8.m8.1c">\mathcal{O}(Nmd)</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p6.8.m8.1d">caligraphic_O ( italic_N italic_m italic_d )</annotation></semantics></math> and <math alttext="\widehat{\mathbf{\Phi}}_{\mathbf{K},\mathcal{G}}^{\top}\mathbf{1}_{N}" class="ltx_Math" display="inline" id="S3.SS4.p6.9.m9.2"><semantics id="S3.SS4.p6.9.m9.2a"><mrow id="S3.SS4.p6.9.m9.2.3" xref="S3.SS4.p6.9.m9.2.3.cmml"><msubsup id="S3.SS4.p6.9.m9.2.3.2" xref="S3.SS4.p6.9.m9.2.3.2.cmml"><mover accent="true" id="S3.SS4.p6.9.m9.2.3.2.2.2" xref="S3.SS4.p6.9.m9.2.3.2.2.2.cmml"><mi id="S3.SS4.p6.9.m9.2.3.2.2.2.2" xref="S3.SS4.p6.9.m9.2.3.2.2.2.2.cmml">𝚽</mi><mo id="S3.SS4.p6.9.m9.2.3.2.2.2.1" xref="S3.SS4.p6.9.m9.2.3.2.2.2.1.cmml">^</mo></mover><mrow id="S3.SS4.p6.9.m9.2.2.2.4" xref="S3.SS4.p6.9.m9.2.2.2.3.cmml"><mi id="S3.SS4.p6.9.m9.1.1.1.1" xref="S3.SS4.p6.9.m9.1.1.1.1.cmml">𝐊</mi><mo id="S3.SS4.p6.9.m9.2.2.2.4.1" xref="S3.SS4.p6.9.m9.2.2.2.3.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p6.9.m9.2.2.2.2" xref="S3.SS4.p6.9.m9.2.2.2.2.cmml">𝒢</mi></mrow><mo id="S3.SS4.p6.9.m9.2.3.2.3" xref="S3.SS4.p6.9.m9.2.3.2.3.cmml">⊤</mo></msubsup><mo id="S3.SS4.p6.9.m9.2.3.1" xref="S3.SS4.p6.9.m9.2.3.1.cmml">⁢</mo><msub id="S3.SS4.p6.9.m9.2.3.3" xref="S3.SS4.p6.9.m9.2.3.3.cmml"><mn id="S3.SS4.p6.9.m9.2.3.3.2" xref="S3.SS4.p6.9.m9.2.3.3.2.cmml">𝟏</mn><mi id="S3.SS4.p6.9.m9.2.3.3.3" xref="S3.SS4.p6.9.m9.2.3.3.3.cmml">N</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p6.9.m9.2b"><apply id="S3.SS4.p6.9.m9.2.3.cmml" xref="S3.SS4.p6.9.m9.2.3"><times id="S3.SS4.p6.9.m9.2.3.1.cmml" xref="S3.SS4.p6.9.m9.2.3.1"></times><apply id="S3.SS4.p6.9.m9.2.3.2.cmml" xref="S3.SS4.p6.9.m9.2.3.2"><csymbol cd="ambiguous" id="S3.SS4.p6.9.m9.2.3.2.1.cmml" xref="S3.SS4.p6.9.m9.2.3.2">superscript</csymbol><apply id="S3.SS4.p6.9.m9.2.3.2.2.cmml" xref="S3.SS4.p6.9.m9.2.3.2"><csymbol cd="ambiguous" id="S3.SS4.p6.9.m9.2.3.2.2.1.cmml" xref="S3.SS4.p6.9.m9.2.3.2">subscript</csymbol><apply id="S3.SS4.p6.9.m9.2.3.2.2.2.cmml" xref="S3.SS4.p6.9.m9.2.3.2.2.2"><ci id="S3.SS4.p6.9.m9.2.3.2.2.2.1.cmml" xref="S3.SS4.p6.9.m9.2.3.2.2.2.1">^</ci><ci id="S3.SS4.p6.9.m9.2.3.2.2.2.2.cmml" xref="S3.SS4.p6.9.m9.2.3.2.2.2.2">𝚽</ci></apply><list id="S3.SS4.p6.9.m9.2.2.2.3.cmml" xref="S3.SS4.p6.9.m9.2.2.2.4"><ci id="S3.SS4.p6.9.m9.1.1.1.1.cmml" xref="S3.SS4.p6.9.m9.1.1.1.1">𝐊</ci><ci id="S3.SS4.p6.9.m9.2.2.2.2.cmml" xref="S3.SS4.p6.9.m9.2.2.2.2">𝒢</ci></list></apply><csymbol cd="latexml" id="S3.SS4.p6.9.m9.2.3.2.3.cmml" xref="S3.SS4.p6.9.m9.2.3.2.3">top</csymbol></apply><apply id="S3.SS4.p6.9.m9.2.3.3.cmml" xref="S3.SS4.p6.9.m9.2.3.3"><csymbol cd="ambiguous" id="S3.SS4.p6.9.m9.2.3.3.1.cmml" xref="S3.SS4.p6.9.m9.2.3.3">subscript</csymbol><cn id="S3.SS4.p6.9.m9.2.3.3.2.cmml" type="integer" xref="S3.SS4.p6.9.m9.2.3.3.2">1</cn><ci id="S3.SS4.p6.9.m9.2.3.3.3.cmml" xref="S3.SS4.p6.9.m9.2.3.3.3">𝑁</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p6.9.m9.2c">\widehat{\mathbf{\Phi}}_{\mathbf{K},\mathcal{G}}^{\top}\mathbf{1}_{N}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p6.9.m9.2d">over^ start_ARG bold_Φ end_ARG start_POSTSUBSCRIPT bold_K , caligraphic_G end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT bold_1 start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT</annotation></semantics></math> is <math alttext="\mathcal{O}(Nm)" class="ltx_Math" display="inline" id="S3.SS4.p6.10.m10.1"><semantics id="S3.SS4.p6.10.m10.1a"><mrow id="S3.SS4.p6.10.m10.1.1" xref="S3.SS4.p6.10.m10.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p6.10.m10.1.1.3" xref="S3.SS4.p6.10.m10.1.1.3.cmml">𝒪</mi><mo id="S3.SS4.p6.10.m10.1.1.2" xref="S3.SS4.p6.10.m10.1.1.2.cmml">⁢</mo><mrow id="S3.SS4.p6.10.m10.1.1.1.1" xref="S3.SS4.p6.10.m10.1.1.1.1.1.cmml"><mo id="S3.SS4.p6.10.m10.1.1.1.1.2" stretchy="false" xref="S3.SS4.p6.10.m10.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS4.p6.10.m10.1.1.1.1.1" xref="S3.SS4.p6.10.m10.1.1.1.1.1.cmml"><mi id="S3.SS4.p6.10.m10.1.1.1.1.1.2" xref="S3.SS4.p6.10.m10.1.1.1.1.1.2.cmml">N</mi><mo id="S3.SS4.p6.10.m10.1.1.1.1.1.1" xref="S3.SS4.p6.10.m10.1.1.1.1.1.1.cmml">⁢</mo><mi id="S3.SS4.p6.10.m10.1.1.1.1.1.3" xref="S3.SS4.p6.10.m10.1.1.1.1.1.3.cmml">m</mi></mrow><mo id="S3.SS4.p6.10.m10.1.1.1.1.3" stretchy="false" xref="S3.SS4.p6.10.m10.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p6.10.m10.1b"><apply id="S3.SS4.p6.10.m10.1.1.cmml" xref="S3.SS4.p6.10.m10.1.1"><times id="S3.SS4.p6.10.m10.1.1.2.cmml" xref="S3.SS4.p6.10.m10.1.1.2"></times><ci id="S3.SS4.p6.10.m10.1.1.3.cmml" xref="S3.SS4.p6.10.m10.1.1.3">𝒪</ci><apply id="S3.SS4.p6.10.m10.1.1.1.1.1.cmml" xref="S3.SS4.p6.10.m10.1.1.1.1"><times id="S3.SS4.p6.10.m10.1.1.1.1.1.1.cmml" xref="S3.SS4.p6.10.m10.1.1.1.1.1.1"></times><ci id="S3.SS4.p6.10.m10.1.1.1.1.1.2.cmml" xref="S3.SS4.p6.10.m10.1.1.1.1.1.2">𝑁</ci><ci id="S3.SS4.p6.10.m10.1.1.1.1.1.3.cmml" xref="S3.SS4.p6.10.m10.1.1.1.1.1.3">𝑚</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p6.10.m10.1c">\mathcal{O}(Nm)</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p6.10.m10.1d">caligraphic_O ( italic_N italic_m )</annotation></semantics></math>.
Both these time complexities are linear in <math alttext="N" class="ltx_Math" display="inline" id="S3.SS4.p6.11.m11.1"><semantics id="S3.SS4.p6.11.m11.1a"><mi id="S3.SS4.p6.11.m11.1.1" xref="S3.SS4.p6.11.m11.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p6.11.m11.1b"><ci id="S3.SS4.p6.11.m11.1.1.cmml" xref="S3.SS4.p6.11.m11.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p6.11.m11.1c">N</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p6.11.m11.1d">italic_N</annotation></semantics></math>.
This is also the case for the subsequent computations involving <math alttext="\widehat{\mathbf{\Phi}}_{\mathbf{Q},\mathcal{G}}" class="ltx_Math" display="inline" id="S3.SS4.p6.12.m12.2"><semantics id="S3.SS4.p6.12.m12.2a"><msub id="S3.SS4.p6.12.m12.2.3" xref="S3.SS4.p6.12.m12.2.3.cmml"><mover accent="true" id="S3.SS4.p6.12.m12.2.3.2" xref="S3.SS4.p6.12.m12.2.3.2.cmml"><mi id="S3.SS4.p6.12.m12.2.3.2.2" xref="S3.SS4.p6.12.m12.2.3.2.2.cmml">𝚽</mi><mo id="S3.SS4.p6.12.m12.2.3.2.1" xref="S3.SS4.p6.12.m12.2.3.2.1.cmml">^</mo></mover><mrow id="S3.SS4.p6.12.m12.2.2.2.4" xref="S3.SS4.p6.12.m12.2.2.2.3.cmml"><mi id="S3.SS4.p6.12.m12.1.1.1.1" xref="S3.SS4.p6.12.m12.1.1.1.1.cmml">𝐐</mi><mo id="S3.SS4.p6.12.m12.2.2.2.4.1" xref="S3.SS4.p6.12.m12.2.2.2.3.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p6.12.m12.2.2.2.2" xref="S3.SS4.p6.12.m12.2.2.2.2.cmml">𝒢</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p6.12.m12.2b"><apply id="S3.SS4.p6.12.m12.2.3.cmml" xref="S3.SS4.p6.12.m12.2.3"><csymbol cd="ambiguous" id="S3.SS4.p6.12.m12.2.3.1.cmml" xref="S3.SS4.p6.12.m12.2.3">subscript</csymbol><apply id="S3.SS4.p6.12.m12.2.3.2.cmml" xref="S3.SS4.p6.12.m12.2.3.2"><ci id="S3.SS4.p6.12.m12.2.3.2.1.cmml" xref="S3.SS4.p6.12.m12.2.3.2.1">^</ci><ci id="S3.SS4.p6.12.m12.2.3.2.2.cmml" xref="S3.SS4.p6.12.m12.2.3.2.2">𝚽</ci></apply><list id="S3.SS4.p6.12.m12.2.2.2.3.cmml" xref="S3.SS4.p6.12.m12.2.2.2.4"><ci id="S3.SS4.p6.12.m12.1.1.1.1.cmml" xref="S3.SS4.p6.12.m12.1.1.1.1">𝐐</ci><ci id="S3.SS4.p6.12.m12.2.2.2.2.cmml" xref="S3.SS4.p6.12.m12.2.2.2.2">𝒢</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p6.12.m12.2c">\widehat{\mathbf{\Phi}}_{\mathbf{Q},\mathcal{G}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p6.12.m12.2d">over^ start_ARG bold_Φ end_ARG start_POSTSUBSCRIPT bold_Q , caligraphic_G end_POSTSUBSCRIPT</annotation></semantics></math>.
∎</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS4.p7">
<p class="ltx_p" id="S3.SS4.p7.6"><span class="ltx_text ltx_font_bold" id="S3.SS4.p7.6.1">Further comments on theoretical results.</span>
We have provided the first concentration bounds for GRFs and quantification of the tradeoff between sparsity and kernel approximation quality.
These results may be of interest independent from topological masking, e.g.&nbsp;for applications in scalable geometric Gaussian processes <cite class="ltx_cite ltx_citemacro_citep">(Reid et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#bib.bib30" title="">2024c</a>; Borovitskiy et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#bib.bib3" title="">2021</a>)</cite>.
Thm.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#S3.Thmtheorem1" title="Theorem 3.1 (GRF exponential concentration bounds). ‣ 3.4 Novel theoretical results for GRFs: sharp estimators with sparse features ‣ 3 Towards linear topological masking ‣ Linear Transformer Topological Masking with Graph Random Features"><span class="ltx_text ltx_ref_tag">3.1</span></a> is <span class="ltx_text ltx_font_bold" id="S3.SS4.p7.6.2">remarkably general</span>, requiring only the modest assumption about <math alttext="\mathcal{G}" class="ltx_Math" display="inline" id="S3.SS4.p7.1.m1.1"><semantics id="S3.SS4.p7.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p7.1.m1.1.1" xref="S3.SS4.p7.1.m1.1.1.cmml">𝒢</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p7.1.m1.1b"><ci id="S3.SS4.p7.1.m1.1.1.cmml" xref="S3.SS4.p7.1.m1.1.1">𝒢</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p7.1.m1.1c">\mathcal{G}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p7.1.m1.1d">caligraphic_G</annotation></semantics></math> and <math alttext="f" class="ltx_Math" display="inline" id="S3.SS4.p7.2.m2.1"><semantics id="S3.SS4.p7.2.m2.1a"><mi id="S3.SS4.p7.2.m2.1.1" xref="S3.SS4.p7.2.m2.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p7.2.m2.1b"><ci id="S3.SS4.p7.2.m2.1.1.cmml" xref="S3.SS4.p7.2.m2.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p7.2.m2.1c">f</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p7.2.m2.1d">italic_f</annotation></semantics></math> that <math alttext="c" class="ltx_Math" display="inline" id="S3.SS4.p7.3.m3.1"><semantics id="S3.SS4.p7.3.m3.1a"><mi id="S3.SS4.p7.3.m3.1.1" xref="S3.SS4.p7.3.m3.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p7.3.m3.1b"><ci id="S3.SS4.p7.3.m3.1.1.cmml" xref="S3.SS4.p7.3.m3.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p7.3.m3.1c">c</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p7.3.m3.1d">italic_c</annotation></semantics></math> is finite.
To guarantee <math alttext="\mathcal{O}(N)" class="ltx_Math" display="inline" id="S3.SS4.p7.4.m4.1"><semantics id="S3.SS4.p7.4.m4.1a"><mrow id="S3.SS4.p7.4.m4.1.2" xref="S3.SS4.p7.4.m4.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p7.4.m4.1.2.2" xref="S3.SS4.p7.4.m4.1.2.2.cmml">𝒪</mi><mo id="S3.SS4.p7.4.m4.1.2.1" xref="S3.SS4.p7.4.m4.1.2.1.cmml">⁢</mo><mrow id="S3.SS4.p7.4.m4.1.2.3.2" xref="S3.SS4.p7.4.m4.1.2.cmml"><mo id="S3.SS4.p7.4.m4.1.2.3.2.1" stretchy="false" xref="S3.SS4.p7.4.m4.1.2.cmml">(</mo><mi id="S3.SS4.p7.4.m4.1.1" xref="S3.SS4.p7.4.m4.1.1.cmml">N</mi><mo id="S3.SS4.p7.4.m4.1.2.3.2.2" stretchy="false" xref="S3.SS4.p7.4.m4.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p7.4.m4.1b"><apply id="S3.SS4.p7.4.m4.1.2.cmml" xref="S3.SS4.p7.4.m4.1.2"><times id="S3.SS4.p7.4.m4.1.2.1.cmml" xref="S3.SS4.p7.4.m4.1.2.1"></times><ci id="S3.SS4.p7.4.m4.1.2.2.cmml" xref="S3.SS4.p7.4.m4.1.2.2">𝒪</ci><ci id="S3.SS4.p7.4.m4.1.1.cmml" xref="S3.SS4.p7.4.m4.1.1">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p7.4.m4.1c">\mathcal{O}(N)</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p7.4.m4.1d">caligraphic_O ( italic_N )</annotation></semantics></math> scaling we assume that <math alttext="c" class="ltx_Math" display="inline" id="S3.SS4.p7.5.m5.1"><semantics id="S3.SS4.p7.5.m5.1a"><mi id="S3.SS4.p7.5.m5.1.1" xref="S3.SS4.p7.5.m5.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p7.5.m5.1b"><ci id="S3.SS4.p7.5.m5.1.1.cmml" xref="S3.SS4.p7.5.m5.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p7.5.m5.1c">c</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p7.5.m5.1d">italic_c</annotation></semantics></math> is fixed as <math alttext="\mathcal{G}" class="ltx_Math" display="inline" id="S3.SS4.p7.6.m6.1"><semantics id="S3.SS4.p7.6.m6.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p7.6.m6.1.1" xref="S3.SS4.p7.6.m6.1.1.cmml">𝒢</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p7.6.m6.1b"><ci id="S3.SS4.p7.6.m6.1.1.cmml" xref="S3.SS4.p7.6.m6.1.1">𝒢</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p7.6.m6.1c">\mathcal{G}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p7.6.m6.1d">caligraphic_G</annotation></semantics></math> changes, which is guaranteed by e.g.&nbsp;fixed maximum node degree and edge weight.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_subsection" id="S3.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.5 </span>Algorithm and intuitive picture</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S3.SS5.p1">
<p class="ltx_p" id="S3.SS5.p1.4">Alg.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#alg1" title="Algorithm 1 ‣ 3.5 Algorithm and intuitive picture ‣ 3 Towards linear topological masking ‣ Linear Transformer Topological Masking with Graph Random Features"><span class="ltx_text ltx_ref_tag">1</span></a> presents our method.
The results of Secs <a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#S3.SS1" title="3.1 Graph node kernels as topological masks ‣ 3 Towards linear topological masking ‣ Linear Transformer Topological Masking with Graph Random Features"><span class="ltx_text ltx_ref_tag">3.1</span></a>-<a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#S3.SS4" title="3.4 Novel theoretical results for GRFs: sharp estimators with sparse features ‣ 3 Towards linear topological masking ‣ Linear Transformer Topological Masking with Graph Random Features"><span class="ltx_text ltx_ref_tag">3.4</span></a> can be intuitively understood as follows (see Fig.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#S3.F2" title="Figure 2 ‣ 3.5 Algorithm and intuitive picture ‣ 3 Towards linear topological masking ‣ Linear Transformer Topological Masking with Graph Random Features"><span class="ltx_text ltx_ref_tag">2</span></a> for an overview).
Graph node kernels, which compute an infinite weighted sum of walks between pairs of input nodes, provide an effective RPE mechanism for transformers.
They capture the topological relationship between queries and keys. Using graph features, we can implement this implicitly, without needing to actually materialise the mask matrix.
Replacing these dense features by graph <em class="ltx_emph ltx_font_italic" id="S3.SS5.p1.4.1">random</em> features, a sparse approximation, we can reduce the cost of implicit masking to <math alttext="\mathcal{O}(N)" class="ltx_Math" display="inline" id="S3.SS5.p1.1.m1.1"><semantics id="S3.SS5.p1.1.m1.1a"><mrow id="S3.SS5.p1.1.m1.1.2" xref="S3.SS5.p1.1.m1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS5.p1.1.m1.1.2.2" xref="S3.SS5.p1.1.m1.1.2.2.cmml">𝒪</mi><mo id="S3.SS5.p1.1.m1.1.2.1" xref="S3.SS5.p1.1.m1.1.2.1.cmml">⁢</mo><mrow id="S3.SS5.p1.1.m1.1.2.3.2" xref="S3.SS5.p1.1.m1.1.2.cmml"><mo id="S3.SS5.p1.1.m1.1.2.3.2.1" stretchy="false" xref="S3.SS5.p1.1.m1.1.2.cmml">(</mo><mi id="S3.SS5.p1.1.m1.1.1" xref="S3.SS5.p1.1.m1.1.1.cmml">N</mi><mo id="S3.SS5.p1.1.m1.1.2.3.2.2" stretchy="false" xref="S3.SS5.p1.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS5.p1.1.m1.1b"><apply id="S3.SS5.p1.1.m1.1.2.cmml" xref="S3.SS5.p1.1.m1.1.2"><times id="S3.SS5.p1.1.m1.1.2.1.cmml" xref="S3.SS5.p1.1.m1.1.2.1"></times><ci id="S3.SS5.p1.1.m1.1.2.2.cmml" xref="S3.SS5.p1.1.m1.1.2.2">𝒪</ci><ci id="S3.SS5.p1.1.m1.1.1.cmml" xref="S3.SS5.p1.1.m1.1.1">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p1.1.m1.1c">\mathcal{O}(N)</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p1.1.m1.1d">caligraphic_O ( italic_N )</annotation></semantics></math> with low performance loss.
Eq.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#S3.E11" title="In Theorem 3.1 (GRF exponential concentration bounds). ‣ 3.4 Novel theoretical results for GRFs: sharp estimators with sparse features ‣ 3 Towards linear topological masking ‣ Linear Transformer Topological Masking with Graph Random Features"><span class="ltx_text ltx_ref_tag">11</span></a> gives a remarkably tight bound on the quality of mask estimation.
Physically, masking with GRFs means that nodes <math alttext="v_{i}" class="ltx_Math" display="inline" id="S3.SS5.p1.2.m2.1"><semantics id="S3.SS5.p1.2.m2.1a"><msub id="S3.SS5.p1.2.m2.1.1" xref="S3.SS5.p1.2.m2.1.1.cmml"><mi id="S3.SS5.p1.2.m2.1.1.2" xref="S3.SS5.p1.2.m2.1.1.2.cmml">v</mi><mi id="S3.SS5.p1.2.m2.1.1.3" xref="S3.SS5.p1.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS5.p1.2.m2.1b"><apply id="S3.SS5.p1.2.m2.1.1.cmml" xref="S3.SS5.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS5.p1.2.m2.1.1.1.cmml" xref="S3.SS5.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS5.p1.2.m2.1.1.2.cmml" xref="S3.SS5.p1.2.m2.1.1.2">𝑣</ci><ci id="S3.SS5.p1.2.m2.1.1.3.cmml" xref="S3.SS5.p1.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p1.2.m2.1c">v_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p1.2.m2.1d">italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="v_{j}" class="ltx_Math" display="inline" id="S3.SS5.p1.3.m3.1"><semantics id="S3.SS5.p1.3.m3.1a"><msub id="S3.SS5.p1.3.m3.1.1" xref="S3.SS5.p1.3.m3.1.1.cmml"><mi id="S3.SS5.p1.3.m3.1.1.2" xref="S3.SS5.p1.3.m3.1.1.2.cmml">v</mi><mi id="S3.SS5.p1.3.m3.1.1.3" xref="S3.SS5.p1.3.m3.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS5.p1.3.m3.1b"><apply id="S3.SS5.p1.3.m3.1.1.cmml" xref="S3.SS5.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS5.p1.3.m3.1.1.1.cmml" xref="S3.SS5.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS5.p1.3.m3.1.1.2.cmml" xref="S3.SS5.p1.3.m3.1.1.2">𝑣</ci><ci id="S3.SS5.p1.3.m3.1.1.3.cmml" xref="S3.SS5.p1.3.m3.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p1.3.m3.1c">v_{j}</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p1.3.m3.1d">italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> only attend to one another if members of their respective ensembles of random walks <em class="ltx_emph ltx_font_italic" id="S3.SS5.p1.4.2">hit</em>, such that they visit some of the same nodes.
This incorporates a strong structural inductive bias from <math alttext="\mathcal{G}" class="ltx_Math" display="inline" id="S3.SS5.p1.4.m4.1"><semantics id="S3.SS5.p1.4.m4.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS5.p1.4.m4.1.1" xref="S3.SS5.p1.4.m4.1.1.cmml">𝒢</mi><annotation-xml encoding="MathML-Content" id="S3.SS5.p1.4.m4.1b"><ci id="S3.SS5.p1.4.m4.1.1.cmml" xref="S3.SS5.p1.4.m4.1.1">𝒢</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p1.4.m4.1c">\mathcal{G}</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p1.4.m4.1d">caligraphic_G</annotation></semantics></math>.
It upweights crucial interactions between nearby nodes, whilst also sampling longer-range attention with lower probability.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_figure" id="S3.F2"><svg class="ltx_picture ltx_centering" height="176.49" id="S3.F2.pic1" overflow="visible" version="1.1" width="472.22"><g transform="translate(0,176.49) matrix(1 0 0 -1 0 0) translate(154.8,0) translate(0,3.54)"><g color="#B3B3B3" fill="#B3B3B3" stroke="#B3B3B3" stroke-width="0.5pt"><path d="M -125.44 117.45 L -110.34 107.05" style="fill:none"></path></g><g color="#B3B3B3" fill="#B3B3B3" stroke="#B3B3B3" stroke-width="0.5pt"><path d="M -138.34 89.69 L -111.06 100.6" style="fill:none"></path></g><g color="#B3B3B3" fill="#B3B3B3" stroke="#B3B3B3" stroke-width="0.5pt"><path d="M -142.18 93.52 L -133.64 114.97" style="fill:none"></path></g><g color="#B3B3B3" fill="#B3B3B3" stroke="#B3B3B3" stroke-width="0.5pt"><path d="M -105.04 82.32 L -104.8 96.28" style="fill:none"></path></g><g color="#B3B3B3" fill="#B3B3B3" stroke="#B3B3B3" stroke-width="0.5pt"><path d="M -111.74 77.4 L -138.13 85.2" style="fill:none"></path></g><g color="#B3B3B3" fill="#B3B3B3" stroke="#B3B3B3" stroke-width="0.5pt"><path d="M -78.99 144.19 L -101.04 108.97" style="fill:none"></path></g><g color="#B3B3B3" fill="#B3B3B3" stroke="#B3B3B3" stroke-width="0.5pt"><path d="M -61.22 95.12 L -97.93 101.9" style="fill:none"></path></g><g color="#B3B3B3" fill="#B3B3B3" stroke="#B3B3B3" stroke-width="0.5pt"><path d="M -61.53 118.87 L -98.23 105.5" style="fill:none"></path></g><g color="#B3B3B3" fill="#B3B3B3" stroke="#B3B3B3" stroke-width="0.5pt"><path d="M -59.03 126.83 L -71.4 144.4" style="fill:none"></path></g><g color="#B3B3B3" fill="#B3B3B3" stroke="#B3B3B3" stroke-width="0.5pt"><path d="M -54.93 114.35 L -54.62 100.74" style="fill:none"></path></g><g color="#B3B3B3" fill="#B3B3B3" stroke="#B3B3B3" stroke-width="0.5pt"><path d="M -109.11 115 L -107.09 109.59" style="fill:none"></path></g><g color="#B3B3B3" fill="#B3B3B3" stroke="#B3B3B3" stroke-width="0.5pt"><path d="M -118.39 121.4 L -124.23 121.38" style="fill:none"></path></g><g color="#B3B3B3" fill="#B3B3B3" stroke="#B3B3B3" stroke-width="0.5pt"><path d="M -116.3 116.5 L -139.94 92.08" style="fill:none"></path></g><g color="#B3B3B3" fill="#B3B3B3" stroke="#B3B3B3" stroke-width="0.5pt"><path d="M -142.69 70.96 L -109.92 98.71" style="fill:none"></path></g><g color="#B3B3B3" fill="#B3B3B3" stroke="#B3B3B3" stroke-width="0.5pt"><path d="M -146.88 73.31 L -145.78 80.35" style="fill:none"></path></g><g color="#FF0000" fill="#FF0000" stroke="#FF0000" stroke-width="1.2pt"><path d="M -142.18 93.52 L -133.64 114.97 M -124.23 121.38 L -118.39 121.4" style="fill:none"></path><g transform="matrix(0.37004 0.92902 -0.92902 0.37004 -138.69 102.27)"><path d="M 4.43 0 L -2.66 3.54 L 0 0 L -2.66 -3.54" style="stroke:none"></path></g><g transform="matrix(0.99998 0.00453 -0.00453 0.99998 -125.15 121.37)"><path d="M 4.43 0 L -2.66 3.54 L 0 0 L -2.66 -3.54" style="stroke:none"></path></g></g><g color="#FF0000" fill="#FF0000" stroke="#FF0000" stroke-width="1.2pt"><path d="M -145.78 80.35 L -146.88 73.31" style="fill:none"></path><g transform="matrix(-0.15393 -0.98808 0.98808 -0.15393 -145.76 80.5)"><path d="M 4.43 0 L -2.66 3.54 L 0 0 L -2.66 -3.54" style="stroke:none"></path></g></g><g color="#FF0000" fill="#FF0000" stroke="#FF0000" stroke-width="1.2pt"><path d="M -138.13 85.2 L -111.74 77.4 M -105.04 82.32 L -104.8 96.28" style="fill:none"></path><g transform="matrix(0.95905 -0.28326 0.28326 0.95905 -126.54 81.77)"><path d="M 4.43 0 L -2.66 3.54 L 0 0 L -2.66 -3.54" style="stroke:none"></path></g><g transform="matrix(0.01704 0.99985 -0.99985 0.01704 -104.97 86.27)"><path d="M 4.43 0 L -2.66 3.54 L 0 0 L -2.66 -3.54" style="stroke:none"></path></g></g><g color="#0000FF" fill="#0000FF" stroke="#0000FF" stroke-width="1.2pt"><path d="M -71.4 144.4 L -59.03 126.83 M -54.93 114.35 L -54.62 100.74" style="fill:none"></path><g transform="matrix(0.57558 -0.81775 0.81775 0.57558 -66.53 137.48)"><path d="M 4.43 0 L -2.66 3.54 L 0 0 L -2.66 -3.54" style="stroke:none"></path></g><g transform="matrix(0.02232 -0.99976 0.99976 0.02232 -54.84 110.61)"><path d="M 4.43 0 L -2.66 3.54 L 0 0 L -2.66 -3.54" style="stroke:none"></path></g></g><g color="#0000FF" fill="#0000FF" stroke="#0000FF" stroke-width="1.2pt"><path d="M -72.95 143.57 L -56.86 100.31" style="fill:none"></path><g transform="matrix(0.34859 -0.93729 0.93729 0.34859 -64.84 121.77)"><path d="M 4.43 0 L -2.66 3.54 L 0 0 L -2.66 -3.54" style="stroke:none"></path></g></g><g color="#0000FF" fill="#0000FF" stroke="#0000FF" stroke-width="1.2pt"><path d="M -78.99 144.19 L -101.04 108.97 M -110.34 107.05 L -125.44 117.45" style="fill:none"></path><g transform="matrix(-0.5306 -0.84763 0.84763 -0.5306 -89.87 126.81)"><path d="M 4.43 0 L -2.66 3.54 L 0 0 L -2.66 -3.54" style="stroke:none"></path></g><g transform="matrix(-0.82355 0.56725 -0.56725 -0.82355 -115.75 110.78)"><path d="M 4.43 0 L -2.66 3.54 L 0 0 L -2.66 -3.54" style="stroke:none"></path></g></g><g fill="#000000" stroke="#000000"><g stroke-width="0.4pt"><g fill="#000000"><path d="M -19.69 64.96 M -19.69 64.96 L -19.69 70.87 L -13.78 70.87 L -13.78 64.96 Z M -13.78 70.87" style="stroke:none"></path></g><g fill="#000000"><path d="M -19.69 70.87 M -19.69 70.87 L -19.69 76.77 L -13.78 76.77 L -13.78 70.87 Z M -13.78 76.77" style="stroke:none"></path></g><g fill="#000000"><path d="M -19.69 76.77 M -19.69 76.77 L -19.69 82.68 L -13.78 82.68 L -13.78 76.77 Z M -13.78 82.68" style="stroke:none"></path></g><g fill="#000000"><path d="M -19.69 82.68 M -19.69 82.68 L -19.69 88.58 L -13.78 88.58 L -13.78 82.68 Z M -13.78 88.58" style="stroke:none"></path></g><g fill="#000000"><path d="M -19.69 88.58 M -19.69 88.58 L -19.69 94.49 L -13.78 94.49 L -13.78 88.58 Z M -13.78 94.49" style="stroke:none"></path></g><g fill="#000000"><path d="M -19.69 94.49 M -19.69 94.49 L -19.69 100.39 L -13.78 100.39 L -13.78 94.49 Z M -13.78 100.39" style="stroke:none"></path></g><g fill="#000000"><path d="M -19.69 100.39 M -19.69 100.39 L -19.69 106.3 L -13.78 106.3 L -13.78 100.39 Z M -13.78 106.3" style="stroke:none"></path></g><g fill="#000000"><path d="M -19.69 106.3 M -19.69 106.3 L -19.69 112.2 L -13.78 112.2 L -13.78 106.3 Z M -13.78 112.2" style="stroke:none"></path></g><g fill="#000000"><path d="M -13.78 59.06 M -13.78 59.06 L -13.78 64.96 L -7.87 64.96 L -7.87 59.06 Z M -7.87 64.96" style="stroke:none"></path></g><g fill="#000000"><path d="M -13.78 70.87 M -13.78 70.87 L -13.78 76.77 L -7.87 76.77 L -7.87 70.87 Z M -7.87 76.77" style="stroke:none"></path></g><g fill="#000000"><path d="M -13.78 100.39 M -13.78 100.39 L -13.78 106.3 L -7.87 106.3 L -7.87 100.39 Z M -7.87 106.3" style="stroke:none"></path></g><g fill="#000000"><path d="M -7.87 59.06 M -7.87 59.06 L -7.87 64.96 L -1.97 64.96 L -1.97 59.06 Z M -1.97 64.96" style="stroke:none"></path></g><g fill="#000000"><path d="M -7.87 64.96 M -7.87 64.96 L -7.87 70.87 L -1.97 70.87 L -1.97 64.96 Z M -1.97 70.87" style="stroke:none"></path></g><g fill="#000000"><path d="M -7.87 76.77 M -7.87 76.77 L -7.87 82.68 L -1.97 82.68 L -1.97 76.77 Z M -1.97 82.68" style="stroke:none"></path></g><g fill="#000000"><path d="M -7.87 100.39 M -7.87 100.39 L -7.87 106.3 L -1.97 106.3 L -1.97 100.39 Z M -1.97 106.3" style="stroke:none"></path></g><g fill="#000000"><path d="M -7.87 106.3 M -7.87 106.3 L -7.87 112.2 L -1.97 112.2 L -1.97 106.3 Z M -1.97 112.2" style="stroke:none"></path></g><g fill="#000000"><path d="M -1.97 59.06 M -1.97 59.06 L -1.97 64.96 L 3.94 64.96 L 3.94 59.06 Z M 3.94 64.96" style="stroke:none"></path></g><g fill="#000000"><path d="M -1.97 70.87 M -1.97 70.87 L -1.97 76.77 L 3.94 76.77 L 3.94 70.87 Z M 3.94 76.77" style="stroke:none"></path></g><g fill="#000000"><path d="M 3.94 59.06 M 3.94 59.06 L 3.94 64.96 L 9.84 64.96 L 9.84 59.06 Z M 9.84 64.96" style="stroke:none"></path></g><g fill="#000000"><path d="M 3.94 94.49 M 3.94 94.49 L 3.94 100.39 L 9.84 100.39 L 9.84 94.49 Z M 9.84 100.39" style="stroke:none"></path></g><g fill="#000000"><path d="M 9.84 59.06 M 9.84 59.06 L 9.84 64.96 L 15.75 64.96 L 15.75 59.06 Z M 15.75 64.96" style="stroke:none"></path></g><g fill="#000000"><path d="M 9.84 94.49 M 9.84 94.49 L 9.84 100.39 L 15.75 100.39 L 15.75 94.49 Z M 15.75 100.39" style="stroke:none"></path></g><g fill="#000000"><path d="M 15.75 59.06 M 15.75 59.06 L 15.75 64.96 L 21.65 64.96 L 21.65 59.06 Z M 21.65 64.96" style="stroke:none"></path></g><g fill="#000000"><path d="M 15.75 88.58 M 15.75 88.58 L 15.75 94.49 L 21.65 94.49 L 21.65 88.58 Z M 21.65 94.49" style="stroke:none"></path></g><g fill="#000000"><path d="M 15.75 82.68 M 15.75 82.68 L 15.75 88.58 L 21.65 88.58 L 21.65 82.68 Z M 21.65 88.58" style="stroke:none"></path></g><g fill="#000000"><path d="M 21.65 59.06 M 21.65 59.06 L 21.65 64.96 L 27.56 64.96 L 27.56 59.06 Z M 27.56 64.96" style="stroke:none"></path></g><g fill="#000000"><path d="M 21.65 64.96 M 21.65 64.96 L 21.65 70.87 L 27.56 70.87 L 27.56 64.96 Z M 27.56 70.87" style="stroke:none"></path></g><g fill="#000000"><path d="M 21.65 70.87 M 21.65 70.87 L 21.65 76.77 L 27.56 76.77 L 27.56 70.87 Z M 27.56 76.77" style="stroke:none"></path></g><g fill="#000000"><path d="M 27.56 59.06 M 27.56 59.06 L 27.56 64.96 L 33.46 64.96 L 33.46 59.06 Z M 33.46 64.96" style="stroke:none"></path></g><g fill="#000000"><path d="M 27.56 70.87 M 27.56 70.87 L 27.56 76.77 L 33.46 76.77 L 33.46 70.87 Z M 33.46 76.77" style="stroke:none"></path></g><g color="#000000" fill="#000000" stroke="#000000" stroke-width="0.5pt"><path d="M -19.69 59.06 M -19.69 59.06 L 33.46 59.06 M -19.69 64.96 L 33.46 64.96 M -19.69 70.87 L 33.46 70.87 M -19.69 76.77 L 33.46 76.77 M -19.69 82.68 L 33.46 82.68 M -19.69 88.58 L 33.46 88.58 M -19.69 94.49 L 33.46 94.49 M -19.69 100.39 L 33.46 100.39 M -19.69 106.3 L 33.46 106.3 M -19.69 112.2 L 33.46 112.2 M -19.69 59.06 L -19.69 112.2 M -13.78 59.06 L -13.78 112.2 M -7.87 59.06 L -7.87 112.2 M -1.97 59.06 L -1.97 112.2 M 3.94 59.06 L 3.94 112.2 M 9.84 59.06 L 9.84 112.2 M 15.75 59.06 L 15.75 112.2 M 21.65 59.06 L 21.65 112.2 M 27.56 59.06 L 27.56 112.2 M 33.46 59.06 L 33.46 112.2 M 33.46 112.2" style="fill:none"></path></g><g fill="#000000" stroke="#000000" transform="matrix(0.75 0.0 0.0 0.75 2.54 43.7)"><foreignObject height="9.46" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="14.22"><math alttext="\mathbf{W}" class="ltx_Math" display="inline" id="S3.F2.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1"><semantics id="S3.F2.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1a"><mi id="S3.F2.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1" xref="S3.F2.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml">𝐖</mi><annotation-xml encoding="MathML-Content" id="S3.F2.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1b"><ci id="S3.F2.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S3.F2.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1">𝐖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1c">\mathbf{W}</annotation><annotation encoding="application/x-llamapun" id="S3.F2.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1d">bold_W</annotation></semantics></math></foreignObject></g><g fill="#000000" stroke="#000000" transform="matrix(0.75 0.0 0.0 0.75 -94.62 43.7)"><foreignObject height="9.46" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="10.86"><math alttext="\mathcal{G}" class="ltx_Math" display="inline" id="S3.F2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.1"><semantics id="S3.F2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.F2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.1.1" xref="S3.F2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.1.1.cmml">𝒢</mi><annotation-xml encoding="MathML-Content" id="S3.F2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.1b"><ci id="S3.F2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S3.F2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.1.1">𝒢</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.1c">\mathcal{G}</annotation><annotation encoding="application/x-llamapun" id="S3.F2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.1d">caligraphic_G</annotation></semantics></math></foreignObject></g><g fill="#000000"><path d="M 59.06 59.06 M 59.06 59.06 L 59.06 64.96 L 64.96 64.96 L 64.96 59.06 Z M 64.96 64.96" style="stroke:none"></path></g><g fill="#404040"><path d="M 59.06 64.96 M 59.06 64.96 L 59.06 70.87 L 64.96 70.87 L 64.96 64.96 Z M 64.96 70.87" style="stroke:none"></path></g><g fill="#404040"><path d="M 59.06 70.87 M 59.06 70.87 L 59.06 76.77 L 64.96 76.77 L 64.96 70.87 Z M 64.96 76.77" style="stroke:none"></path></g><g fill="#404040"><path d="M 59.06 76.77 M 59.06 76.77 L 59.06 82.68 L 64.96 82.68 L 64.96 76.77 Z M 64.96 82.68" style="stroke:none"></path></g><g fill="#404040"><path d="M 59.06 82.68 M 59.06 82.68 L 59.06 88.58 L 64.96 88.58 L 64.96 82.68 Z M 64.96 88.58" style="stroke:none"></path></g><g fill="#404040"><path d="M 59.06 88.58 M 59.06 88.58 L 59.06 94.49 L 64.96 94.49 L 64.96 88.58 Z M 64.96 94.49" style="stroke:none"></path></g><g fill="#404040"><path d="M 59.06 94.49 M 59.06 94.49 L 59.06 100.39 L 64.96 100.39 L 64.96 94.49 Z M 64.96 100.39" style="stroke:none"></path></g><g fill="#404040"><path d="M 59.06 100.39 M 59.06 100.39 L 59.06 106.3 L 64.96 106.3 L 64.96 100.39 Z M 64.96 106.3" style="stroke:none"></path></g><g fill="#404040"><path d="M 59.06 106.3 M 59.06 106.3 L 59.06 112.2 L 64.96 112.2 L 64.96 106.3 Z M 64.96 112.2" style="stroke:none"></path></g><g fill="#404040"><path d="M 64.96 59.06 M 64.96 59.06 L 64.96 64.96 L 70.87 64.96 L 70.87 59.06 Z M 70.87 64.96" style="stroke:none"></path></g><g fill="#000000"><path d="M 64.96 64.96 M 64.96 64.96 L 64.96 70.87 L 70.87 70.87 L 70.87 64.96 Z M 70.87 70.87" style="stroke:none"></path></g><g fill="#404040"><path d="M 64.96 70.87 M 64.96 70.87 L 64.96 76.77 L 70.87 76.77 L 70.87 70.87 Z M 70.87 76.77" style="stroke:none"></path></g><g fill="#8C8C8C"><path d="M 64.96 76.77 M 64.96 76.77 L 64.96 82.68 L 70.87 82.68 L 70.87 76.77 Z M 70.87 82.68" style="stroke:none"></path></g><g fill="#A6A6A6"><path d="M 64.96 82.68 M 64.96 82.68 L 64.96 88.58 L 70.87 88.58 L 70.87 82.68 Z M 70.87 88.58" style="stroke:none"></path></g><g fill="#BFBFBF"><path d="M 64.96 88.58 M 64.96 88.58 L 64.96 94.49 L 70.87 94.49 L 70.87 88.58 Z M 70.87 94.49" style="stroke:none"></path></g><g fill="#BFBFBF"><path d="M 64.96 94.49 M 64.96 94.49 L 64.96 100.39 L 70.87 100.39 L 70.87 94.49 Z M 70.87 100.39" style="stroke:none"></path></g><g fill="#404040"><path d="M 64.96 100.39 M 64.96 100.39 L 64.96 106.3 L 70.87 106.3 L 70.87 100.39 Z M 70.87 106.3" style="stroke:none"></path></g><g fill="#BFBFBF"><path d="M 64.96 106.3 M 64.96 106.3 L 64.96 112.2 L 70.87 112.2 L 70.87 106.3 Z M 70.87 112.2" style="stroke:none"></path></g><g fill="#404040"><path d="M 70.87 59.06 M 70.87 59.06 L 70.87 64.96 L 76.77 64.96 L 76.77 59.06 Z M 76.77 64.96" style="stroke:none"></path></g><g fill="#404040"><path d="M 70.87 64.96 M 70.87 64.96 L 70.87 70.87 L 76.77 70.87 L 76.77 64.96 Z M 76.77 70.87" style="stroke:none"></path></g><g fill="#000000"><path d="M 70.87 70.87 M 70.87 70.87 L 70.87 76.77 L 76.77 76.77 L 76.77 70.87 Z M 76.77 76.77" style="stroke:none"></path></g><g fill="#404040"><path d="M 70.87 76.77 M 70.87 76.77 L 70.87 82.68 L 76.77 82.68 L 76.77 76.77 Z M 76.77 82.68" style="stroke:none"></path></g><g fill="#808080"><path d="M 70.87 82.68 M 70.87 82.68 L 70.87 88.58 L 76.77 88.58 L 76.77 82.68 Z M 76.77 88.58" style="stroke:none"></path></g><g fill="#BFBFBF"><path d="M 70.87 88.58 M 70.87 88.58 L 70.87 94.49 L 76.77 94.49 L 76.77 88.58 Z M 76.77 94.49" style="stroke:none"></path></g><g fill="#D9D9D9"><path d="M 70.87 94.49 M 70.87 94.49 L 70.87 100.39 L 76.77 100.39 L 76.77 94.49 Z M 76.77 100.39" style="stroke:none"></path></g><g fill="#404040"><path d="M 70.87 100.39 M 70.87 100.39 L 70.87 106.3 L 76.77 106.3 L 76.77 100.39 Z M 76.77 106.3" style="stroke:none"></path></g><g fill="#404040"><path d="M 70.87 106.3 M 70.87 106.3 L 70.87 112.2 L 76.77 112.2 L 76.77 106.3 Z M 76.77 112.2" style="stroke:none"></path></g><g fill="#404040"><path d="M 76.77 59.06 M 76.77 59.06 L 76.77 64.96 L 82.68 64.96 L 82.68 59.06 Z M 82.68 64.96" style="stroke:none"></path></g><g fill="#8C8C8C"><path d="M 76.77 64.96 M 76.77 64.96 L 76.77 70.87 L 82.68 70.87 L 82.68 64.96 Z M 82.68 70.87" style="stroke:none"></path></g><g fill="#404040"><path d="M 76.77 70.87 M 76.77 70.87 L 76.77 76.77 L 82.68 76.77 L 82.68 70.87 Z M 82.68 76.77" style="stroke:none"></path></g><g fill="#000000"><path d="M 76.77 76.77 M 76.77 76.77 L 76.77 82.68 L 82.68 82.68 L 82.68 76.77 Z M 82.68 82.68" style="stroke:none"></path></g><g fill="#8C8C8C"><path d="M 76.77 82.68 M 76.77 82.68 L 76.77 88.58 L 82.68 88.58 L 82.68 82.68 Z M 82.68 88.58" style="stroke:none"></path></g><g fill="#D9D9D9"><path d="M 76.77 88.58 M 76.77 88.58 L 76.77 94.49 L 82.68 94.49 L 82.68 88.58 Z M 82.68 94.49" style="stroke:none"></path></g><g fill="#BFBFBF"><path d="M 76.77 94.49 M 76.77 94.49 L 76.77 100.39 L 82.68 100.39 L 82.68 94.49 Z M 82.68 100.39" style="stroke:none"></path></g><g fill="#BFBFBF"><path d="M 76.77 100.39 M 76.77 100.39 L 76.77 106.3 L 82.68 106.3 L 82.68 100.39 Z M 82.68 106.3" style="stroke:none"></path></g><g fill="#BFBFBF"><path d="M 76.77 106.3 M 76.77 106.3 L 76.77 112.2 L 82.68 112.2 L 82.68 106.3 Z M 82.68 112.2" style="stroke:none"></path></g><g fill="#404040"><path d="M 82.68 59.06 M 82.68 59.06 L 82.68 64.96 L 88.58 64.96 L 88.58 59.06 Z M 88.58 64.96" style="stroke:none"></path></g><g fill="#A6A6A6"><path d="M 82.68 64.96 M 82.68 64.96 L 82.68 70.87 L 88.58 70.87 L 88.58 64.96 Z M 88.58 70.87" style="stroke:none"></path></g><g fill="#808080"><path d="M 82.68 70.87 M 82.68 70.87 L 82.68 76.77 L 88.58 76.77 L 88.58 70.87 Z M 88.58 76.77" style="stroke:none"></path></g><g fill="#8C8C8C"><path d="M 82.68 76.77 M 82.68 76.77 L 82.68 82.68 L 88.58 82.68 L 88.58 76.77 Z M 88.58 82.68" style="stroke:none"></path></g><g fill="#000000"><path d="M 82.68 82.68 M 82.68 82.68 L 82.68 88.58 L 88.58 88.58 L 88.58 82.68 Z M 88.58 88.58" style="stroke:none"></path></g><g fill="#A6A6A6"><path d="M 82.68 88.58 M 82.68 88.58 L 82.68 94.49 L 88.58 94.49 L 88.58 88.58 Z M 88.58 94.49" style="stroke:none"></path></g><g fill="#404040"><path d="M 82.68 94.49 M 82.68 94.49 L 82.68 100.39 L 88.58 100.39 L 88.58 94.49 Z M 88.58 100.39" style="stroke:none"></path></g><g fill="#D9D9D9"><path d="M 82.68 100.39 M 82.68 100.39 L 82.68 106.3 L 88.58 106.3 L 88.58 100.39 Z M 88.58 106.3" style="stroke:none"></path></g><g fill="#8C8C8C"><path d="M 82.68 106.3 M 82.68 106.3 L 82.68 112.2 L 88.58 112.2 L 88.58 106.3 Z M 88.58 112.2" style="stroke:none"></path></g><g fill="#404040"><path d="M 88.58 59.06 M 88.58 59.06 L 88.58 64.96 L 94.49 64.96 L 94.49 59.06 Z M 94.49 64.96" style="stroke:none"></path></g><g fill="#BFBFBF"><path d="M 88.58 64.96 M 88.58 64.96 L 88.58 70.87 L 94.49 70.87 L 94.49 64.96 Z M 94.49 70.87" style="stroke:none"></path></g><g fill="#BFBFBF"><path d="M 88.58 70.87 M 88.58 70.87 L 88.58 76.77 L 94.49 76.77 L 94.49 70.87 Z M 94.49 76.77" style="stroke:none"></path></g><g fill="#D9D9D9"><path d="M 88.58 76.77 M 88.58 76.77 L 88.58 82.68 L 94.49 82.68 L 94.49 76.77 Z M 94.49 82.68" style="stroke:none"></path></g><g fill="#A6A6A6"><path d="M 88.58 82.68 M 88.58 82.68 L 88.58 88.58 L 94.49 88.58 L 94.49 82.68 Z M 94.49 88.58" style="stroke:none"></path></g><g fill="#000000"><path d="M 88.58 88.58 M 88.58 88.58 L 88.58 94.49 L 94.49 94.49 L 94.49 88.58 Z M 94.49 94.49" style="stroke:none"></path></g><g fill="#404040"><path d="M 88.58 94.49 M 88.58 94.49 L 88.58 100.39 L 94.49 100.39 L 94.49 94.49 Z M 94.49 100.39" style="stroke:none"></path></g><g fill="#BFBFBF"><path d="M 88.58 100.39 M 88.58 100.39 L 88.58 106.3 L 94.49 106.3 L 94.49 100.39 Z M 94.49 106.3" style="stroke:none"></path></g><g fill="#595959"><path d="M 88.58 106.3 M 88.58 106.3 L 88.58 112.2 L 94.49 112.2 L 94.49 106.3 Z M 94.49 112.2" style="stroke:none"></path></g><g fill="#404040"><path d="M 94.49 59.06 M 94.49 59.06 L 94.49 64.96 L 100.39 64.96 L 100.39 59.06 Z M 100.39 64.96" style="stroke:none"></path></g><g fill="#BFBFBF"><path d="M 94.49 64.96 M 94.49 64.96 L 94.49 70.87 L 100.39 70.87 L 100.39 64.96 Z M 100.39 70.87" style="stroke:none"></path></g><g fill="#D9D9D9"><path d="M 94.49 70.87 M 94.49 70.87 L 94.49 76.77 L 100.39 76.77 L 100.39 70.87 Z M 100.39 76.77" style="stroke:none"></path></g><g fill="#BFBFBF"><path d="M 94.49 76.77 M 94.49 76.77 L 94.49 82.68 L 100.39 82.68 L 100.39 76.77 Z M 100.39 82.68" style="stroke:none"></path></g><g fill="#404040"><path d="M 94.49 88.58 M 94.49 88.58 L 94.49 94.49 L 100.39 94.49 L 100.39 88.58 Z M 100.39 94.49" style="stroke:none"></path></g><g fill="#404040"><path d="M 94.49 82.68 M 94.49 82.68 L 94.49 88.58 L 100.39 88.58 L 100.39 82.68 Z M 100.39 88.58" style="stroke:none"></path></g><g fill="#000000"><path d="M 94.49 94.49 M 94.49 94.49 L 94.49 100.39 L 100.39 100.39 L 100.39 94.49 Z M 100.39 100.39" style="stroke:none"></path></g><g fill="#D9D9D9"><path d="M 94.49 100.39 M 94.49 100.39 L 94.49 106.3 L 100.39 106.3 L 100.39 100.39 Z M 100.39 106.3" style="stroke:none"></path></g><g fill="#BFBFBF"><path d="M 94.49 106.3 M 94.49 106.3 L 94.49 112.2 L 100.39 112.2 L 100.39 106.3 Z M 100.39 112.2" style="stroke:none"></path></g><g fill="#404040"><path d="M 100.39 59.06 M 100.39 59.06 L 100.39 64.96 L 106.3 64.96 L 106.3 59.06 Z M 106.3 64.96" style="stroke:none"></path></g><g fill="#404040"><path d="M 100.39 64.96 M 100.39 64.96 L 100.39 70.87 L 106.3 70.87 L 106.3 64.96 Z M 106.3 70.87" style="stroke:none"></path></g><g fill="#404040"><path d="M 100.39 70.87 M 100.39 70.87 L 100.39 76.77 L 106.3 76.77 L 106.3 70.87 Z M 106.3 76.77" style="stroke:none"></path></g><g fill="#BFBFBF"><path d="M 100.39 76.77 M 100.39 76.77 L 100.39 82.68 L 106.3 82.68 L 106.3 76.77 Z M 106.3 82.68" style="stroke:none"></path></g><g fill="#D9D9D9"><path d="M 100.39 82.68 M 100.39 82.68 L 100.39 88.58 L 106.3 88.58 L 106.3 82.68 Z M 106.3 88.58" style="stroke:none"></path></g><g fill="#BFBFBF"><path d="M 100.39 88.58 M 100.39 88.58 L 100.39 94.49 L 106.3 94.49 L 106.3 88.58 Z M 106.3 94.49" style="stroke:none"></path></g><g fill="#D9D9D9"><path d="M 100.39 94.49 M 100.39 94.49 L 100.39 100.39 L 106.3 100.39 L 106.3 94.49 Z M 106.3 100.39" style="stroke:none"></path></g><g fill="#000000"><path d="M 100.39 100.39 M 100.39 100.39 L 100.39 106.3 L 106.3 106.3 L 106.3 100.39 Z M 106.3 106.3" style="stroke:none"></path></g><g fill="#404040"><path d="M 106.3 59.06 M 106.3 59.06 L 106.3 64.96 L 112.2 64.96 L 112.2 59.06 Z M 112.2 64.96" style="stroke:none"></path></g><g fill="#BFBFBF"><path d="M 106.3 64.96 M 106.3 64.96 L 106.3 70.87 L 112.2 70.87 L 112.2 64.96 Z M 112.2 70.87" style="stroke:none"></path></g><g fill="#404040"><path d="M 106.3 70.87 M 106.3 70.87 L 106.3 76.77 L 112.2 76.77 L 112.2 70.87 Z M 112.2 76.77" style="stroke:none"></path></g><g fill="#BFBFBF"><path d="M 106.3 76.77 M 106.3 76.77 L 106.3 82.68 L 112.2 82.68 L 112.2 76.77 Z M 112.2 82.68" style="stroke:none"></path></g><g fill="#8C8C8C"><path d="M 106.3 82.68 M 106.3 82.68 L 106.3 88.58 L 112.2 88.58 L 112.2 82.68 Z M 112.2 88.58" style="stroke:none"></path></g><g fill="#595959"><path d="M 106.3 88.58 M 106.3 88.58 L 106.3 94.49 L 112.2 94.49 L 112.2 88.58 Z M 112.2 94.49" style="stroke:none"></path></g><g fill="#BFBFBF"><path d="M 106.3 94.49 M 106.3 94.49 L 106.3 100.39 L 112.2 100.39 L 112.2 94.49 Z M 112.2 100.39" style="stroke:none"></path></g><g fill="#000000"><path d="M 106.3 106.3 M 106.3 106.3 L 106.3 112.2 L 112.2 112.2 L 112.2 106.3 Z M 112.2 112.2" style="stroke:none"></path></g><g color="#000000" fill="#000000" stroke="#000000" stroke-width="0.5pt"><path d="M 59.06 59.06 M 59.06 59.06 L 112.2 59.06 M 59.06 64.96 L 112.2 64.96 M 59.06 70.87 L 112.2 70.87 M 59.06 76.77 L 112.2 76.77 M 59.06 82.68 L 112.2 82.68 M 59.06 88.58 L 112.2 88.58 M 59.06 94.49 L 112.2 94.49 M 59.06 100.39 L 112.2 100.39 M 59.06 106.3 L 112.2 106.3 M 59.06 112.2 L 112.2 112.2 M 59.06 59.06 L 59.06 112.2 M 64.96 59.06 L 64.96 112.2 M 70.87 59.06 L 70.87 112.2 M 76.77 59.06 L 76.77 112.2 M 82.68 59.06 L 82.68 112.2 M 88.58 59.06 L 88.58 112.2 M 94.49 59.06 L 94.49 112.2 M 100.39 59.06 L 100.39 112.2 M 106.3 59.06 L 106.3 112.2 M 112.2 59.06 L 112.2 112.2 M 112.2 112.2" style="fill:none"></path></g><g color="#E67456" fill="#E67456" stroke="#E67456" stroke-width="1.42264pt"><path d="M 70.87 82.68 M 70.87 82.68 L 70.87 88.58 L 76.77 88.58 L 76.77 82.68 Z M 76.77 88.58" style="fill:none"></path></g><g color="#E67456" fill="#E67456" stroke="#E67456" stroke-width="1.42264pt"><path d="M 82.68 70.87 M 82.68 70.87 L 82.68 76.77 L 88.58 76.77 L 88.58 70.87 Z M 88.58 76.77" style="fill:none"></path></g><g fill="#000000" stroke="#000000" transform="matrix(0.75 0.0 0.0 0.75 44.13 47.93)"><foreignObject height="25.85" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="113.3"><math alttext="\mathbf{M}_{\alpha}(\mathcal{G})=\sum_{i=0}^{\infty}\alpha_{i}\mathbf{W}^{i}" class="ltx_Math" display="inline" id="S3.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.m1.1"><semantics id="S3.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.m1.1a"><mrow id="S3.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.m1.1.2" xref="S3.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.m1.1.2.cmml"><mrow id="S3.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.m1.1.2.2" xref="S3.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.m1.1.2.2.cmml"><msub id="S3.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.m1.1.2.2.2" xref="S3.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.m1.1.2.2.2.cmml"><mi id="S3.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.m1.1.2.2.2.2" xref="S3.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.m1.1.2.2.2.2.cmml">𝐌</mi><mi id="S3.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.m1.1.2.2.2.3" xref="S3.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.m1.1.2.2.2.3.cmml">α</mi></msub><mo id="S3.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.m1.1.2.2.1" xref="S3.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.m1.1.2.2.1.cmml">⁢</mo><mrow id="S3.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.m1.1.2.2.3.2" xref="S3.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.m1.1.2.2.cmml"><mo id="S3.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.m1.1.2.2.3.2.1" stretchy="false" xref="S3.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.m1.1.2.2.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S3.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.m1.1.1" xref="S3.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml">𝒢</mi><mo id="S3.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.m1.1.2.2.3.2.2" stretchy="false" xref="S3.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.m1.1.2.2.cmml">)</mo></mrow></mrow><mo id="S3.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.m1.1.2.1" rspace="0.111em" xref="S3.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.m1.1.2.1.cmml">=</mo><mrow id="S3.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.m1.1.2.3" xref="S3.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.m1.1.2.3.cmml"><msubsup id="S3.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.m1.1.2.3.1" xref="S3.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.m1.1.2.3.1.cmml"><mo id="S3.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.m1.1.2.3.1.2.2" xref="S3.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.m1.1.2.3.1.2.2.cmml">∑</mo><mrow id="S3.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.m1.1.2.3.1.2.3" xref="S3.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.m1.1.2.3.1.2.3.cmml"><mi id="S3.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.m1.1.2.3.1.2.3.2" xref="S3.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.m1.1.2.3.1.2.3.2.cmml">i</mi><mo id="S3.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.m1.1.2.3.1.2.3.1" xref="S3.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.m1.1.2.3.1.2.3.1.cmml">=</mo><mn id="S3.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.m1.1.2.3.1.2.3.3" xref="S3.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.m1.1.2.3.1.2.3.3.cmml">0</mn></mrow><mi id="S3.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.m1.1.2.3.1.3" mathvariant="normal" xref="S3.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.m1.1.2.3.1.3.cmml">∞</mi></msubsup><mrow id="S3.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.m1.1.2.3.2" xref="S3.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.m1.1.2.3.2.cmml"><msub id="S3.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.m1.1.2.3.2.2" xref="S3.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.m1.1.2.3.2.2.cmml"><mi id="S3.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.m1.1.2.3.2.2.2" xref="S3.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.m1.1.2.3.2.2.2.cmml">α</mi><mi id="S3.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.m1.1.2.3.2.2.3" xref="S3.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.m1.1.2.3.2.2.3.cmml">i</mi></msub><mo id="S3.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.m1.1.2.3.2.1" xref="S3.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.m1.1.2.3.2.1.cmml">⁢</mo><msup id="S3.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.m1.1.2.3.2.3" xref="S3.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.m1.1.2.3.2.3.cmml"><mi id="S3.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.m1.1.2.3.2.3.2" xref="S3.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.m1.1.2.3.2.3.2.cmml">𝐖</mi><mi id="S3.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.m1.1.2.3.2.3.3" xref="S3.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.m1.1.2.3.2.3.3.cmml">i</mi></msup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.m1.1b"><apply id="S3.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.m1.1.2.cmml" xref="S3.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.m1.1.2"><eq id="S3.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.m1.1.2.1.cmml" xref="S3.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.m1.1.2.1"></eq><apply id="S3.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.m1.1.2.2.cmml" xref="S3.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.m1.1.2.2"><times id="S3.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.m1.1.2.2.1.cmml" xref="S3.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.m1.1.2.2.1"></times><apply id="S3.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.m1.1.2.2.2.cmml" xref="S3.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.m1.1.2.2.2"><csymbol cd="ambiguous" id="S3.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.m1.1.2.2.2.1.cmml" xref="S3.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.m1.1.2.2.2">subscript</csymbol><ci id="S3.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.m1.1.2.2.2.2.cmml" xref="S3.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.m1.1.2.2.2.2">𝐌</ci><ci id="S3.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.m1.1.2.2.2.3.cmml" xref="S3.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.m1.1.2.2.2.3">𝛼</ci></apply><ci id="S3.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S3.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.m1.1.1">𝒢</ci></apply><apply id="S3.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.m1.1.2.3.cmml" xref="S3.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.m1.1.2.3"><apply id="S3.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.m1.1.2.3.1.cmml" xref="S3.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.m1.1.2.3.1"><csymbol cd="ambiguous" id="S3.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.m1.1.2.3.1.1.cmml" xref="S3.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.m1.1.2.3.1">superscript</csymbol><apply id="S3.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.m1.1.2.3.1.2.cmml" xref="S3.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.m1.1.2.3.1"><csymbol cd="ambiguous" id="S3.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.m1.1.2.3.1.2.1.cmml" xref="S3.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.m1.1.2.3.1">subscript</csymbol><sum id="S3.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.m1.1.2.3.1.2.2.cmml" xref="S3.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.m1.1.2.3.1.2.2"></sum><apply id="S3.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.m1.1.2.3.1.2.3.cmml" xref="S3.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.m1.1.2.3.1.2.3"><eq id="S3.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.m1.1.2.3.1.2.3.1.cmml" xref="S3.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.m1.1.2.3.1.2.3.1"></eq><ci id="S3.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.m1.1.2.3.1.2.3.2.cmml" xref="S3.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.m1.1.2.3.1.2.3.2">𝑖</ci><cn id="S3.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.m1.1.2.3.1.2.3.3.cmml" type="integer" xref="S3.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.m1.1.2.3.1.2.3.3">0</cn></apply></apply><infinity id="S3.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.m1.1.2.3.1.3.cmml" xref="S3.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.m1.1.2.3.1.3"></infinity></apply><apply id="S3.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.m1.1.2.3.2.cmml" xref="S3.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.m1.1.2.3.2"><times id="S3.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.m1.1.2.3.2.1.cmml" xref="S3.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.m1.1.2.3.2.1"></times><apply id="S3.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.m1.1.2.3.2.2.cmml" xref="S3.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.m1.1.2.3.2.2"><csymbol cd="ambiguous" id="S3.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.m1.1.2.3.2.2.1.cmml" xref="S3.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.m1.1.2.3.2.2">subscript</csymbol><ci id="S3.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.m1.1.2.3.2.2.2.cmml" xref="S3.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.m1.1.2.3.2.2.2">𝛼</ci><ci id="S3.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.m1.1.2.3.2.2.3.cmml" xref="S3.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.m1.1.2.3.2.2.3">𝑖</ci></apply><apply id="S3.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.m1.1.2.3.2.3.cmml" xref="S3.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.m1.1.2.3.2.3"><csymbol cd="ambiguous" id="S3.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.m1.1.2.3.2.3.1.cmml" xref="S3.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.m1.1.2.3.2.3">superscript</csymbol><ci id="S3.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.m1.1.2.3.2.3.2.cmml" xref="S3.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.m1.1.2.3.2.3.2">𝐖</ci><ci id="S3.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.m1.1.2.3.2.3.3.cmml" xref="S3.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.m1.1.2.3.2.3.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.m1.1c">\mathbf{M}_{\alpha}(\mathcal{G})=\sum_{i=0}^{\infty}\alpha_{i}\mathbf{W}^{i}</annotation><annotation encoding="application/x-llamapun" id="S3.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.m1.1d">bold_M start_POSTSUBSCRIPT italic_α end_POSTSUBSCRIPT ( caligraphic_G ) = ∑ start_POSTSUBSCRIPT italic_i = 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∞ end_POSTSUPERSCRIPT italic_α start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT bold_W start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT</annotation></semantics></math></foreignObject></g><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 -20.57 157.96)"><foreignObject height="13.84" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="49.01"><math alttext="\widehat{\phi}_{\mathcal{G}}(v_{i})=" class="ltx_Math" display="inline" id="S3.F2.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.m1.1"><semantics id="S3.F2.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.m1.1a"><mrow id="S3.F2.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.m1.1.1" xref="S3.F2.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml"><mrow id="S3.F2.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.m1.1.1.1" xref="S3.F2.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.cmml"><msub id="S3.F2.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.3" xref="S3.F2.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.3.cmml"><mover accent="true" id="S3.F2.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.3.2" xref="S3.F2.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.3.2.cmml"><mi id="S3.F2.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.3.2.2" xref="S3.F2.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.3.2.2.cmml">ϕ</mi><mo id="S3.F2.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.3.2.1" xref="S3.F2.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.3.2.1.cmml">^</mo></mover><mi class="ltx_font_mathcaligraphic" id="S3.F2.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.3.3" xref="S3.F2.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.3.3.cmml">𝒢</mi></msub><mo id="S3.F2.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.2" xref="S3.F2.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.2.cmml">⁢</mo><mrow id="S3.F2.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1" xref="S3.F2.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.1.cmml"><mo id="S3.F2.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.2" stretchy="false" xref="S3.F2.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.F2.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.1" xref="S3.F2.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.1.cmml"><mi id="S3.F2.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.1.2" xref="S3.F2.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.1.2.cmml">v</mi><mi id="S3.F2.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.1.3" xref="S3.F2.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.F2.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.3" stretchy="false" xref="S3.F2.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.F2.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.m1.1.1.2" xref="S3.F2.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.cmml">=</mo><mi id="S3.F2.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.m1.1.1.3" xref="S3.F2.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="S3.F2.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.m1.1b"><apply id="S3.F2.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S3.F2.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.m1.1.1"><eq id="S3.F2.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.cmml" xref="S3.F2.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.m1.1.1.2"></eq><apply id="S3.F2.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.cmml" xref="S3.F2.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.m1.1.1.1"><times id="S3.F2.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.2.cmml" xref="S3.F2.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.2"></times><apply id="S3.F2.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.3.cmml" xref="S3.F2.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.3"><csymbol cd="ambiguous" id="S3.F2.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.3.1.cmml" xref="S3.F2.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.3">subscript</csymbol><apply id="S3.F2.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.3.2.cmml" xref="S3.F2.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.3.2"><ci id="S3.F2.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.3.2.1.cmml" xref="S3.F2.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.3.2.1">^</ci><ci id="S3.F2.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.3.2.2.cmml" xref="S3.F2.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.3.2.2">italic-ϕ</ci></apply><ci id="S3.F2.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.3.3.cmml" xref="S3.F2.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.3.3">𝒢</ci></apply><apply id="S3.F2.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.1.cmml" xref="S3.F2.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.F2.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.1.1.cmml" xref="S3.F2.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1">subscript</csymbol><ci id="S3.F2.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.1.2.cmml" xref="S3.F2.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.1.2">𝑣</ci><ci id="S3.F2.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.1.3.cmml" xref="S3.F2.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.1.3">𝑖</ci></apply></apply><csymbol cd="latexml" id="S3.F2.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.m1.1.1.3.cmml" xref="S3.F2.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.m1.1c">\widehat{\phi}_{\mathcal{G}}(v_{i})=</annotation><annotation encoding="application/x-llamapun" id="S3.F2.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.m1.1d">over^ start_ARG italic_ϕ end_ARG start_POSTSUBSCRIPT caligraphic_G end_POSTSUBSCRIPT ( italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) =</annotation></semantics></math></foreignObject></g><g fill="#FF0000"><path d="M 59.06 157.48 M 59.06 157.48 L 59.06 165.35 L 66.93 165.35 L 66.93 157.48 Z M 66.93 165.35" style="stroke:none"></path></g><g fill="#FF8080"><path d="M 51.18 157.48 M 51.18 157.48 L 51.18 165.35 L 59.06 165.35 L 59.06 157.48 Z M 59.06 165.35" style="stroke:none"></path></g><g fill="#FF8080"><path d="M 66.93 157.48 M 66.93 157.48 L 66.93 165.35 L 74.8 165.35 L 74.8 157.48 Z M 74.8 165.35" style="stroke:none"></path></g><g fill="#FF8080"><path d="M 106.3 157.48 M 106.3 157.48 L 106.3 165.35 L 114.17 165.35 L 114.17 157.48 Z M 114.17 165.35" style="stroke:none"></path></g><g fill="#FFBFBF"><path d="M 98.43 157.48 M 98.43 157.48 L 98.43 165.35 L 106.3 165.35 L 106.3 157.48 Z M 106.3 165.35" style="stroke:none"></path></g><g fill="#FFCCCC"><path d="M 43.31 157.48 M 43.31 157.48 L 43.31 165.35 L 51.18 165.35 L 51.18 157.48 Z M 51.18 165.35" style="stroke:none"></path></g><g color="#000000" fill="#000000" stroke="#000000" stroke-width="0.5pt"><path d="M 43.31 157.48 M 43.31 157.48 L 114.17 157.48 M 43.31 165.34 L 114.17 165.34 M 43.31 157.48 L 43.31 165.35 M 51.18 157.48 L 51.18 165.35 M 59.06 157.48 L 59.06 165.35 M 66.93 157.48 L 66.93 165.35 M 74.8 157.48 L 74.8 165.35 M 82.68 157.48 L 82.68 165.35 M 90.55 157.48 L 90.55 165.35 M 98.42 157.48 L 98.42 165.35 M 106.3 157.48 L 106.3 165.35 M 114.17 157.48 L 114.17 165.35 M 114.17 165.35" style="fill:none"></path></g><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 -21.05 138.57)"><foreignObject height="14.44" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="49.97"><math alttext="\widehat{\phi}_{\mathcal{G}}(v_{j})=" class="ltx_Math" display="inline" id="S3.F2.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.m1.1"><semantics id="S3.F2.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.m1.1a"><mrow id="S3.F2.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.m1.1.1" xref="S3.F2.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml"><mrow id="S3.F2.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.m1.1.1.1" xref="S3.F2.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.cmml"><msub id="S3.F2.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.3" xref="S3.F2.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.3.cmml"><mover accent="true" id="S3.F2.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.3.2" xref="S3.F2.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.3.2.cmml"><mi id="S3.F2.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.3.2.2" xref="S3.F2.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.3.2.2.cmml">ϕ</mi><mo id="S3.F2.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.3.2.1" xref="S3.F2.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.3.2.1.cmml">^</mo></mover><mi class="ltx_font_mathcaligraphic" id="S3.F2.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.3.3" xref="S3.F2.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.3.3.cmml">𝒢</mi></msub><mo id="S3.F2.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.2" xref="S3.F2.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.2.cmml">⁢</mo><mrow id="S3.F2.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1" xref="S3.F2.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.1.cmml"><mo id="S3.F2.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.2" stretchy="false" xref="S3.F2.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.F2.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.1" xref="S3.F2.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.1.cmml"><mi id="S3.F2.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.1.2" xref="S3.F2.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.1.2.cmml">v</mi><mi id="S3.F2.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.1.3" xref="S3.F2.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.1.3.cmml">j</mi></msub><mo id="S3.F2.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.3" stretchy="false" xref="S3.F2.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.F2.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.m1.1.1.2" xref="S3.F2.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.cmml">=</mo><mi id="S3.F2.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.m1.1.1.3" xref="S3.F2.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="S3.F2.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.m1.1b"><apply id="S3.F2.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S3.F2.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.m1.1.1"><eq id="S3.F2.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.cmml" xref="S3.F2.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.m1.1.1.2"></eq><apply id="S3.F2.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.cmml" xref="S3.F2.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.m1.1.1.1"><times id="S3.F2.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.2.cmml" xref="S3.F2.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.2"></times><apply id="S3.F2.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.3.cmml" xref="S3.F2.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.3"><csymbol cd="ambiguous" id="S3.F2.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.3.1.cmml" xref="S3.F2.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.3">subscript</csymbol><apply id="S3.F2.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.3.2.cmml" xref="S3.F2.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.3.2"><ci id="S3.F2.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.3.2.1.cmml" xref="S3.F2.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.3.2.1">^</ci><ci id="S3.F2.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.3.2.2.cmml" xref="S3.F2.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.3.2.2">italic-ϕ</ci></apply><ci id="S3.F2.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.3.3.cmml" xref="S3.F2.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.3.3">𝒢</ci></apply><apply id="S3.F2.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.1.cmml" xref="S3.F2.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.F2.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.1.1.cmml" xref="S3.F2.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1">subscript</csymbol><ci id="S3.F2.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.1.2.cmml" xref="S3.F2.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.1.2">𝑣</ci><ci id="S3.F2.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.1.3.cmml" xref="S3.F2.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.1.3">𝑗</ci></apply></apply><csymbol cd="latexml" id="S3.F2.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.m1.1.1.3.cmml" xref="S3.F2.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.m1.1c">\widehat{\phi}_{\mathcal{G}}(v_{j})=</annotation><annotation encoding="application/x-llamapun" id="S3.F2.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.m1.1d">over^ start_ARG italic_ϕ end_ARG start_POSTSUBSCRIPT caligraphic_G end_POSTSUBSCRIPT ( italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) =</annotation></semantics></math></foreignObject></g><g fill="#0000FF"><path d="M 74.8 137.8 M 74.8 137.8 L 74.8 145.67 L 82.68 145.67 L 82.68 137.8 Z M 82.68 145.67" style="stroke:none"></path></g><g fill="#6666FF"><path d="M 90.55 137.8 M 90.55 137.8 L 90.55 145.67 L 98.43 145.67 L 98.43 137.8 Z M 98.43 145.67" style="stroke:none"></path></g><g fill="#8080FF"><path d="M 82.68 137.8 M 82.68 137.8 L 82.68 145.67 L 90.55 145.67 L 90.55 137.8 Z M 90.55 145.67" style="stroke:none"></path></g><g fill="#8080FF"><path d="M 43.31 137.8 M 43.31 137.8 L 43.31 145.67 L 51.18 145.67 L 51.18 137.8 Z M 51.18 145.67" style="stroke:none"></path></g><g fill="#BFBFFF"><path d="M 51.18 137.8 M 51.18 137.8 L 51.18 145.67 L 59.06 145.67 L 59.06 137.8 Z M 59.06 145.67" style="stroke:none"></path></g><g color="#000000" fill="#000000" stroke="#000000" stroke-width="0.5pt"><path d="M 43.31 137.8 M 43.31 137.8 L 114.17 137.8 M 43.31 145.66 L 114.17 145.66 M 43.31 137.8 L 43.31 145.67 M 51.18 137.8 L 51.18 145.67 M 59.06 137.8 L 59.06 145.67 M 66.93 137.8 L 66.93 145.67 M 74.8 137.8 L 74.8 145.67 M 82.68 137.8 L 82.68 145.67 M 90.55 137.8 L 90.55 145.67 M 98.42 137.8 L 98.42 145.67 M 106.3 137.8 L 106.3 145.67 M 114.17 137.8 L 114.17 145.67 M 114.17 145.67" style="fill:none"></path></g><g stroke-width="0.71132pt"><path d="M 145.67 163.39 M 145.67 163.39 L 145.67 64.96 L 316.93 64.96 L 316.93 163.39 Z M 316.93 64.96" style="fill:none"></path></g><g fill="#000000" stroke="#000000" transform="matrix(0.75 0.0 0.0 0.75 190.18 150.17)"><foreignObject height="17.13" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="112.28"><math alttext="\mathbf{A}_{ij}=\mathbb{E}\left(\phi(\bm{q}_{i})^{\top}\phi(\bm{k}_{j})\right)" class="ltx_Math" display="inline" id="S3.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.m1.1"><semantics id="S3.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.m1.1a"><mrow id="S3.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.m1.1.1" xref="S3.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml"><msub id="S3.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.m1.1.1.3" xref="S3.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.m1.1.1.3.cmml"><mi id="S3.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.m1.1.1.3.2" xref="S3.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.m1.1.1.3.2.cmml">𝐀</mi><mrow id="S3.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.m1.1.1.3.3" xref="S3.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.m1.1.1.3.3.cmml"><mi id="S3.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.m1.1.1.3.3.2" xref="S3.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.m1.1.1.3.3.2.cmml">i</mi><mo id="S3.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.m1.1.1.3.3.1" xref="S3.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.m1.1.1.3.3.1.cmml">⁢</mo><mi id="S3.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.m1.1.1.3.3.3" xref="S3.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.m1.1.1.3.3.3.cmml">j</mi></mrow></msub><mo id="S3.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.m1.1.1.2" xref="S3.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.cmml">=</mo><mrow id="S3.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.m1.1.1.1" xref="S3.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.cmml"><mi id="S3.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.3" xref="S3.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.3.cmml">𝔼</mi><mo id="S3.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.2" xref="S3.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.2.cmml">⁢</mo><mrow id="S3.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1" xref="S3.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.1.cmml"><mo id="S3.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.2" xref="S3.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.1" xref="S3.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.1.cmml"><mi id="S3.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.1.4" xref="S3.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.1.4.cmml">ϕ</mi><mo id="S3.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.1.3" xref="S3.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.1.3.cmml">⁢</mo><msup id="S3.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.1.1" xref="S3.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.1.1.cmml"><mrow id="S3.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1" xref="S3.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1" xref="S3.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.cmml">𝒒</mi><mi id="S3.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.1.1.3" xref="S3.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.1.1.3.cmml">⊤</mo></msup><mo id="S3.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.1.3a" xref="S3.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.1.3.cmml">⁢</mo><mi id="S3.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.1.5" xref="S3.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.1.5.cmml">ϕ</mi><mo id="S3.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.1.3b" xref="S3.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.1.3.cmml">⁢</mo><mrow id="S3.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.1.2.1" xref="S3.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.1.2.1.1.cmml"><mo id="S3.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.1.2.1.2" stretchy="false" xref="S3.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.1.2.1.1.cmml">(</mo><msub id="S3.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.1.2.1.1" xref="S3.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.1.2.1.1.cmml"><mi id="S3.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.1.2.1.1.2" xref="S3.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.1.2.1.1.2.cmml">𝒌</mi><mi id="S3.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.1.2.1.1.3" xref="S3.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.1.2.1.1.3.cmml">j</mi></msub><mo id="S3.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.1.2.1.3" stretchy="false" xref="S3.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.1.2.1.1.cmml">)</mo></mrow></mrow><mo id="S3.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.3" xref="S3.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.m1.1b"><apply id="S3.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S3.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.m1.1.1"><eq id="S3.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.cmml" xref="S3.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.m1.1.1.2"></eq><apply id="S3.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.m1.1.1.3.cmml" xref="S3.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.m1.1.1.3.1.cmml" xref="S3.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.m1.1.1.3">subscript</csymbol><ci id="S3.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.m1.1.1.3.2.cmml" xref="S3.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.m1.1.1.3.2">𝐀</ci><apply id="S3.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.m1.1.1.3.3.cmml" xref="S3.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.m1.1.1.3.3"><times id="S3.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.m1.1.1.3.3.1.cmml" xref="S3.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.m1.1.1.3.3.1"></times><ci id="S3.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.m1.1.1.3.3.2.cmml" xref="S3.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.m1.1.1.3.3.2">𝑖</ci><ci id="S3.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.m1.1.1.3.3.3.cmml" xref="S3.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.m1.1.1.3.3.3">𝑗</ci></apply></apply><apply id="S3.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.cmml" xref="S3.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.m1.1.1.1"><times id="S3.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.2.cmml" xref="S3.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.2"></times><ci id="S3.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.3.cmml" xref="S3.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.3">𝔼</ci><apply id="S3.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.1.cmml" xref="S3.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1"><times id="S3.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.1.3.cmml" xref="S3.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.1.3"></times><ci id="S3.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.1.4.cmml" xref="S3.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.1.4">italic-ϕ</ci><apply id="S3.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.1.1.cmml" xref="S3.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.2">𝒒</ci><ci id="S3.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><csymbol cd="latexml" id="S3.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.1.1.3">top</csymbol></apply><ci id="S3.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.1.5.cmml" xref="S3.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.1.5">italic-ϕ</ci><apply id="S3.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.1.2.1.1.cmml" xref="S3.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.1.2.1"><csymbol cd="ambiguous" id="S3.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.1.2.1.1.1.cmml" xref="S3.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.1.2.1">subscript</csymbol><ci id="S3.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.1.2.1.1.2.cmml" xref="S3.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.1.2.1.1.2">𝒌</ci><ci id="S3.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.1.2.1.1.3.cmml" xref="S3.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.1.2.1.1.3">𝑗</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.m1.1c">\mathbf{A}_{ij}=\mathbb{E}\left(\phi(\bm{q}_{i})^{\top}\phi(\bm{k}_{j})\right)</annotation><annotation encoding="application/x-llamapun" id="S3.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.1.m1.1d">bold_A start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT = blackboard_E ( italic_ϕ ( bold_italic_q start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT italic_ϕ ( bold_italic_k start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) )</annotation></semantics></math></foreignObject></g><g fill="#000000" stroke="#000000" transform="matrix(0.75 0.0 0.0 0.75 181.26 122.61)"><foreignObject height="17.13" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="136.07"><math alttext="\mathbf{M}_{\alpha ij}=\mathbb{E}\left(\widehat{\phi}_{\mathcal{G}}(v_{i})^{%
\top}\widehat{\phi}_{\mathcal{G}}(v_{j}))\right)" class="ltx_math_unparsed" display="inline" id="S3.F2.pic1.7.7.7.7.7.7.7.7.7.7.7.7.7.7.2.1.1.1.1.1.1.1.1.1.m1.1"><semantics id="S3.F2.pic1.7.7.7.7.7.7.7.7.7.7.7.7.7.7.2.1.1.1.1.1.1.1.1.1.m1.1a"><mrow id="S3.F2.pic1.7.7.7.7.7.7.7.7.7.7.7.7.7.7.2.1.1.1.1.1.1.1.1.1.m1.1b"><msub id="S3.F2.pic1.7.7.7.7.7.7.7.7.7.7.7.7.7.7.2.1.1.1.1.1.1.1.1.1.m1.1.1"><mi id="S3.F2.pic1.7.7.7.7.7.7.7.7.7.7.7.7.7.7.2.1.1.1.1.1.1.1.1.1.m1.1.1.2">𝐌</mi><mrow id="S3.F2.pic1.7.7.7.7.7.7.7.7.7.7.7.7.7.7.2.1.1.1.1.1.1.1.1.1.m1.1.1.3"><mi id="S3.F2.pic1.7.7.7.7.7.7.7.7.7.7.7.7.7.7.2.1.1.1.1.1.1.1.1.1.m1.1.1.3.2">α</mi><mo id="S3.F2.pic1.7.7.7.7.7.7.7.7.7.7.7.7.7.7.2.1.1.1.1.1.1.1.1.1.m1.1.1.3.1">⁢</mo><mi id="S3.F2.pic1.7.7.7.7.7.7.7.7.7.7.7.7.7.7.2.1.1.1.1.1.1.1.1.1.m1.1.1.3.3">i</mi><mo id="S3.F2.pic1.7.7.7.7.7.7.7.7.7.7.7.7.7.7.2.1.1.1.1.1.1.1.1.1.m1.1.1.3.1a">⁢</mo><mi id="S3.F2.pic1.7.7.7.7.7.7.7.7.7.7.7.7.7.7.2.1.1.1.1.1.1.1.1.1.m1.1.1.3.4">j</mi></mrow></msub><mo id="S3.F2.pic1.7.7.7.7.7.7.7.7.7.7.7.7.7.7.2.1.1.1.1.1.1.1.1.1.m1.1.2">=</mo><mi id="S3.F2.pic1.7.7.7.7.7.7.7.7.7.7.7.7.7.7.2.1.1.1.1.1.1.1.1.1.m1.1.3">𝔼</mi><mrow id="S3.F2.pic1.7.7.7.7.7.7.7.7.7.7.7.7.7.7.2.1.1.1.1.1.1.1.1.1.m1.1.4"><mo id="S3.F2.pic1.7.7.7.7.7.7.7.7.7.7.7.7.7.7.2.1.1.1.1.1.1.1.1.1.m1.1.4.1">(</mo><msub id="S3.F2.pic1.7.7.7.7.7.7.7.7.7.7.7.7.7.7.2.1.1.1.1.1.1.1.1.1.m1.1.4.2"><mover accent="true" id="S3.F2.pic1.7.7.7.7.7.7.7.7.7.7.7.7.7.7.2.1.1.1.1.1.1.1.1.1.m1.1.4.2.2"><mi id="S3.F2.pic1.7.7.7.7.7.7.7.7.7.7.7.7.7.7.2.1.1.1.1.1.1.1.1.1.m1.1.4.2.2.2">ϕ</mi><mo id="S3.F2.pic1.7.7.7.7.7.7.7.7.7.7.7.7.7.7.2.1.1.1.1.1.1.1.1.1.m1.1.4.2.2.1">^</mo></mover><mi class="ltx_font_mathcaligraphic" id="S3.F2.pic1.7.7.7.7.7.7.7.7.7.7.7.7.7.7.2.1.1.1.1.1.1.1.1.1.m1.1.4.2.3">𝒢</mi></msub><msup id="S3.F2.pic1.7.7.7.7.7.7.7.7.7.7.7.7.7.7.2.1.1.1.1.1.1.1.1.1.m1.1.4.3"><mrow id="S3.F2.pic1.7.7.7.7.7.7.7.7.7.7.7.7.7.7.2.1.1.1.1.1.1.1.1.1.m1.1.4.3.2"><mo id="S3.F2.pic1.7.7.7.7.7.7.7.7.7.7.7.7.7.7.2.1.1.1.1.1.1.1.1.1.m1.1.4.3.2.1" stretchy="false">(</mo><msub id="S3.F2.pic1.7.7.7.7.7.7.7.7.7.7.7.7.7.7.2.1.1.1.1.1.1.1.1.1.m1.1.4.3.2.2"><mi id="S3.F2.pic1.7.7.7.7.7.7.7.7.7.7.7.7.7.7.2.1.1.1.1.1.1.1.1.1.m1.1.4.3.2.2.2">v</mi><mi id="S3.F2.pic1.7.7.7.7.7.7.7.7.7.7.7.7.7.7.2.1.1.1.1.1.1.1.1.1.m1.1.4.3.2.2.3">i</mi></msub><mo id="S3.F2.pic1.7.7.7.7.7.7.7.7.7.7.7.7.7.7.2.1.1.1.1.1.1.1.1.1.m1.1.4.3.2.3" stretchy="false">)</mo></mrow><mo id="S3.F2.pic1.7.7.7.7.7.7.7.7.7.7.7.7.7.7.2.1.1.1.1.1.1.1.1.1.m1.1.4.3.3">⊤</mo></msup><msub id="S3.F2.pic1.7.7.7.7.7.7.7.7.7.7.7.7.7.7.2.1.1.1.1.1.1.1.1.1.m1.1.4.4"><mover accent="true" id="S3.F2.pic1.7.7.7.7.7.7.7.7.7.7.7.7.7.7.2.1.1.1.1.1.1.1.1.1.m1.1.4.4.2"><mi id="S3.F2.pic1.7.7.7.7.7.7.7.7.7.7.7.7.7.7.2.1.1.1.1.1.1.1.1.1.m1.1.4.4.2.2">ϕ</mi><mo id="S3.F2.pic1.7.7.7.7.7.7.7.7.7.7.7.7.7.7.2.1.1.1.1.1.1.1.1.1.m1.1.4.4.2.1">^</mo></mover><mi class="ltx_font_mathcaligraphic" id="S3.F2.pic1.7.7.7.7.7.7.7.7.7.7.7.7.7.7.2.1.1.1.1.1.1.1.1.1.m1.1.4.4.3">𝒢</mi></msub><mrow id="S3.F2.pic1.7.7.7.7.7.7.7.7.7.7.7.7.7.7.2.1.1.1.1.1.1.1.1.1.m1.1.4.5"><mo id="S3.F2.pic1.7.7.7.7.7.7.7.7.7.7.7.7.7.7.2.1.1.1.1.1.1.1.1.1.m1.1.4.5.1" stretchy="false">(</mo><msub id="S3.F2.pic1.7.7.7.7.7.7.7.7.7.7.7.7.7.7.2.1.1.1.1.1.1.1.1.1.m1.1.4.5.2"><mi id="S3.F2.pic1.7.7.7.7.7.7.7.7.7.7.7.7.7.7.2.1.1.1.1.1.1.1.1.1.m1.1.4.5.2.2">v</mi><mi id="S3.F2.pic1.7.7.7.7.7.7.7.7.7.7.7.7.7.7.2.1.1.1.1.1.1.1.1.1.m1.1.4.5.2.3">j</mi></msub><mo id="S3.F2.pic1.7.7.7.7.7.7.7.7.7.7.7.7.7.7.2.1.1.1.1.1.1.1.1.1.m1.1.4.5.3" stretchy="false">)</mo></mrow><mo id="S3.F2.pic1.7.7.7.7.7.7.7.7.7.7.7.7.7.7.2.1.1.1.1.1.1.1.1.1.m1.1.4.6" stretchy="false">)</mo></mrow><mo id="S3.F2.pic1.7.7.7.7.7.7.7.7.7.7.7.7.7.7.2.1.1.1.1.1.1.1.1.1.m1.1.5">)</mo></mrow><annotation encoding="application/x-tex" id="S3.F2.pic1.7.7.7.7.7.7.7.7.7.7.7.7.7.7.2.1.1.1.1.1.1.1.1.1.m1.1c">\mathbf{M}_{\alpha ij}=\mathbb{E}\left(\widehat{\phi}_{\mathcal{G}}(v_{i})^{%
\top}\widehat{\phi}_{\mathcal{G}}(v_{j}))\right)</annotation><annotation encoding="application/x-llamapun" id="S3.F2.pic1.7.7.7.7.7.7.7.7.7.7.7.7.7.7.2.1.1.1.1.1.1.1.1.1.m1.1d">bold_M start_POSTSUBSCRIPT italic_α italic_i italic_j end_POSTSUBSCRIPT = blackboard_E ( over^ start_ARG italic_ϕ end_ARG start_POSTSUBSCRIPT caligraphic_G end_POSTSUBSCRIPT ( italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT over^ start_ARG italic_ϕ end_ARG start_POSTSUBSCRIPT caligraphic_G end_POSTSUBSCRIPT ( italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) ) )</annotation></semantics></math></foreignObject></g><g fill="#000000" stroke="#000000" transform="matrix(0.75 0.0 0.0 0.75 164.95 95.05)"><foreignObject height="17.13" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="179.55"><math alttext="\mathbf{A}_{ij}\mathbf{M}_{\alpha ij}=\mathbb{E}\left(\textrm{vec}\left[\phi(%
\bm{q}_{i})\otimes\widehat{\phi}_{\mathcal{G}}(v_{i})\right]^{\top}\right." class="ltx_math_unparsed" display="inline" id="S3.F2.pic1.8.8.8.8.8.8.8.8.8.8.8.8.8.8.3.1.1.1.1.1.1.1.1.1.m1.1"><semantics id="S3.F2.pic1.8.8.8.8.8.8.8.8.8.8.8.8.8.8.3.1.1.1.1.1.1.1.1.1.m1.1a"><mrow id="S3.F2.pic1.8.8.8.8.8.8.8.8.8.8.8.8.8.8.3.1.1.1.1.1.1.1.1.1.m1.1b"><msub id="S3.F2.pic1.8.8.8.8.8.8.8.8.8.8.8.8.8.8.3.1.1.1.1.1.1.1.1.1.m1.1.1"><mi id="S3.F2.pic1.8.8.8.8.8.8.8.8.8.8.8.8.8.8.3.1.1.1.1.1.1.1.1.1.m1.1.1.2">𝐀</mi><mrow id="S3.F2.pic1.8.8.8.8.8.8.8.8.8.8.8.8.8.8.3.1.1.1.1.1.1.1.1.1.m1.1.1.3"><mi id="S3.F2.pic1.8.8.8.8.8.8.8.8.8.8.8.8.8.8.3.1.1.1.1.1.1.1.1.1.m1.1.1.3.2">i</mi><mo id="S3.F2.pic1.8.8.8.8.8.8.8.8.8.8.8.8.8.8.3.1.1.1.1.1.1.1.1.1.m1.1.1.3.1">⁢</mo><mi id="S3.F2.pic1.8.8.8.8.8.8.8.8.8.8.8.8.8.8.3.1.1.1.1.1.1.1.1.1.m1.1.1.3.3">j</mi></mrow></msub><msub id="S3.F2.pic1.8.8.8.8.8.8.8.8.8.8.8.8.8.8.3.1.1.1.1.1.1.1.1.1.m1.1.2"><mi id="S3.F2.pic1.8.8.8.8.8.8.8.8.8.8.8.8.8.8.3.1.1.1.1.1.1.1.1.1.m1.1.2.2">𝐌</mi><mrow id="S3.F2.pic1.8.8.8.8.8.8.8.8.8.8.8.8.8.8.3.1.1.1.1.1.1.1.1.1.m1.1.2.3"><mi id="S3.F2.pic1.8.8.8.8.8.8.8.8.8.8.8.8.8.8.3.1.1.1.1.1.1.1.1.1.m1.1.2.3.2">α</mi><mo id="S3.F2.pic1.8.8.8.8.8.8.8.8.8.8.8.8.8.8.3.1.1.1.1.1.1.1.1.1.m1.1.2.3.1">⁢</mo><mi id="S3.F2.pic1.8.8.8.8.8.8.8.8.8.8.8.8.8.8.3.1.1.1.1.1.1.1.1.1.m1.1.2.3.3">i</mi><mo id="S3.F2.pic1.8.8.8.8.8.8.8.8.8.8.8.8.8.8.3.1.1.1.1.1.1.1.1.1.m1.1.2.3.1a">⁢</mo><mi id="S3.F2.pic1.8.8.8.8.8.8.8.8.8.8.8.8.8.8.3.1.1.1.1.1.1.1.1.1.m1.1.2.3.4">j</mi></mrow></msub><mo id="S3.F2.pic1.8.8.8.8.8.8.8.8.8.8.8.8.8.8.3.1.1.1.1.1.1.1.1.1.m1.1.3">=</mo><mi id="S3.F2.pic1.8.8.8.8.8.8.8.8.8.8.8.8.8.8.3.1.1.1.1.1.1.1.1.1.m1.1.4">𝔼</mi><mrow id="S3.F2.pic1.8.8.8.8.8.8.8.8.8.8.8.8.8.8.3.1.1.1.1.1.1.1.1.1.m1.1.5"><mo id="S3.F2.pic1.8.8.8.8.8.8.8.8.8.8.8.8.8.8.3.1.1.1.1.1.1.1.1.1.m1.1.5.1">(</mo><mtext id="S3.F2.pic1.8.8.8.8.8.8.8.8.8.8.8.8.8.8.3.1.1.1.1.1.1.1.1.1.m1.1.5.2">vec</mtext><msup id="S3.F2.pic1.8.8.8.8.8.8.8.8.8.8.8.8.8.8.3.1.1.1.1.1.1.1.1.1.m1.1.5.3"><mrow id="S3.F2.pic1.8.8.8.8.8.8.8.8.8.8.8.8.8.8.3.1.1.1.1.1.1.1.1.1.m1.1.5.3.2"><mo id="S3.F2.pic1.8.8.8.8.8.8.8.8.8.8.8.8.8.8.3.1.1.1.1.1.1.1.1.1.m1.1.5.3.2.1">[</mo><mi id="S3.F2.pic1.8.8.8.8.8.8.8.8.8.8.8.8.8.8.3.1.1.1.1.1.1.1.1.1.m1.1.5.3.2.2">ϕ</mi><mrow id="S3.F2.pic1.8.8.8.8.8.8.8.8.8.8.8.8.8.8.3.1.1.1.1.1.1.1.1.1.m1.1.5.3.2.3"><mo id="S3.F2.pic1.8.8.8.8.8.8.8.8.8.8.8.8.8.8.3.1.1.1.1.1.1.1.1.1.m1.1.5.3.2.3.1" stretchy="false">(</mo><msub id="S3.F2.pic1.8.8.8.8.8.8.8.8.8.8.8.8.8.8.3.1.1.1.1.1.1.1.1.1.m1.1.5.3.2.3.2"><mi id="S3.F2.pic1.8.8.8.8.8.8.8.8.8.8.8.8.8.8.3.1.1.1.1.1.1.1.1.1.m1.1.5.3.2.3.2.2">𝒒</mi><mi id="S3.F2.pic1.8.8.8.8.8.8.8.8.8.8.8.8.8.8.3.1.1.1.1.1.1.1.1.1.m1.1.5.3.2.3.2.3">i</mi></msub><mo id="S3.F2.pic1.8.8.8.8.8.8.8.8.8.8.8.8.8.8.3.1.1.1.1.1.1.1.1.1.m1.1.5.3.2.3.3" rspace="0.055em" stretchy="false">)</mo></mrow><mo id="S3.F2.pic1.8.8.8.8.8.8.8.8.8.8.8.8.8.8.3.1.1.1.1.1.1.1.1.1.m1.1.5.3.2.4" rspace="0.222em">⊗</mo><msub id="S3.F2.pic1.8.8.8.8.8.8.8.8.8.8.8.8.8.8.3.1.1.1.1.1.1.1.1.1.m1.1.5.3.2.5"><mover accent="true" id="S3.F2.pic1.8.8.8.8.8.8.8.8.8.8.8.8.8.8.3.1.1.1.1.1.1.1.1.1.m1.1.5.3.2.5.2"><mi id="S3.F2.pic1.8.8.8.8.8.8.8.8.8.8.8.8.8.8.3.1.1.1.1.1.1.1.1.1.m1.1.5.3.2.5.2.2">ϕ</mi><mo id="S3.F2.pic1.8.8.8.8.8.8.8.8.8.8.8.8.8.8.3.1.1.1.1.1.1.1.1.1.m1.1.5.3.2.5.2.1">^</mo></mover><mi class="ltx_font_mathcaligraphic" id="S3.F2.pic1.8.8.8.8.8.8.8.8.8.8.8.8.8.8.3.1.1.1.1.1.1.1.1.1.m1.1.5.3.2.5.3">𝒢</mi></msub><mrow id="S3.F2.pic1.8.8.8.8.8.8.8.8.8.8.8.8.8.8.3.1.1.1.1.1.1.1.1.1.m1.1.5.3.2.6"><mo id="S3.F2.pic1.8.8.8.8.8.8.8.8.8.8.8.8.8.8.3.1.1.1.1.1.1.1.1.1.m1.1.5.3.2.6.1" stretchy="false">(</mo><msub id="S3.F2.pic1.8.8.8.8.8.8.8.8.8.8.8.8.8.8.3.1.1.1.1.1.1.1.1.1.m1.1.5.3.2.6.2"><mi id="S3.F2.pic1.8.8.8.8.8.8.8.8.8.8.8.8.8.8.3.1.1.1.1.1.1.1.1.1.m1.1.5.3.2.6.2.2">v</mi><mi id="S3.F2.pic1.8.8.8.8.8.8.8.8.8.8.8.8.8.8.3.1.1.1.1.1.1.1.1.1.m1.1.5.3.2.6.2.3">i</mi></msub><mo id="S3.F2.pic1.8.8.8.8.8.8.8.8.8.8.8.8.8.8.3.1.1.1.1.1.1.1.1.1.m1.1.5.3.2.6.3" stretchy="false">)</mo></mrow><mo id="S3.F2.pic1.8.8.8.8.8.8.8.8.8.8.8.8.8.8.3.1.1.1.1.1.1.1.1.1.m1.1.5.3.2.7">]</mo></mrow><mo id="S3.F2.pic1.8.8.8.8.8.8.8.8.8.8.8.8.8.8.3.1.1.1.1.1.1.1.1.1.m1.1.5.3.3">⊤</mo></msup></mrow></mrow><annotation encoding="application/x-tex" id="S3.F2.pic1.8.8.8.8.8.8.8.8.8.8.8.8.8.8.3.1.1.1.1.1.1.1.1.1.m1.1c">\mathbf{A}_{ij}\mathbf{M}_{\alpha ij}=\mathbb{E}\left(\textrm{vec}\left[\phi(%
\bm{q}_{i})\otimes\widehat{\phi}_{\mathcal{G}}(v_{i})\right]^{\top}\right.</annotation><annotation encoding="application/x-llamapun" id="S3.F2.pic1.8.8.8.8.8.8.8.8.8.8.8.8.8.8.3.1.1.1.1.1.1.1.1.1.m1.1d">bold_A start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT bold_M start_POSTSUBSCRIPT italic_α italic_i italic_j end_POSTSUBSCRIPT = blackboard_E ( vec [ italic_ϕ ( bold_italic_q start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) ⊗ over^ start_ARG italic_ϕ end_ARG start_POSTSUBSCRIPT caligraphic_G end_POSTSUBSCRIPT ( italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) ] start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT</annotation></semantics></math></foreignObject></g><g fill="#000000" stroke="#000000" transform="matrix(0.75 0.0 0.0 0.75 188.93 76.37)"><foreignObject height="14.44" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="115.62"><math alttext="\left.\textrm{vec}\left[\phi(\bm{k}_{j})\otimes\widehat{\phi}_{\mathcal{G}}(v_%
{j})\right]\right)" class="ltx_math_unparsed" display="inline" id="S3.F2.pic1.9.9.9.9.9.9.9.9.9.9.9.9.9.9.4.1.1.1.1.1.1.1.1.1.m1.1"><semantics id="S3.F2.pic1.9.9.9.9.9.9.9.9.9.9.9.9.9.9.4.1.1.1.1.1.1.1.1.1.m1.1a"><mrow id="S3.F2.pic1.9.9.9.9.9.9.9.9.9.9.9.9.9.9.4.1.1.1.1.1.1.1.1.1.m1.1b"><mtext id="S3.F2.pic1.9.9.9.9.9.9.9.9.9.9.9.9.9.9.4.1.1.1.1.1.1.1.1.1.m1.1.1">vec</mtext><mrow id="S3.F2.pic1.9.9.9.9.9.9.9.9.9.9.9.9.9.9.4.1.1.1.1.1.1.1.1.1.m1.1.2"><mo id="S3.F2.pic1.9.9.9.9.9.9.9.9.9.9.9.9.9.9.4.1.1.1.1.1.1.1.1.1.m1.1.2.1">[</mo><mi id="S3.F2.pic1.9.9.9.9.9.9.9.9.9.9.9.9.9.9.4.1.1.1.1.1.1.1.1.1.m1.1.2.2">ϕ</mi><mrow id="S3.F2.pic1.9.9.9.9.9.9.9.9.9.9.9.9.9.9.4.1.1.1.1.1.1.1.1.1.m1.1.2.3"><mo id="S3.F2.pic1.9.9.9.9.9.9.9.9.9.9.9.9.9.9.4.1.1.1.1.1.1.1.1.1.m1.1.2.3.1" stretchy="false">(</mo><msub id="S3.F2.pic1.9.9.9.9.9.9.9.9.9.9.9.9.9.9.4.1.1.1.1.1.1.1.1.1.m1.1.2.3.2"><mi id="S3.F2.pic1.9.9.9.9.9.9.9.9.9.9.9.9.9.9.4.1.1.1.1.1.1.1.1.1.m1.1.2.3.2.2">𝒌</mi><mi id="S3.F2.pic1.9.9.9.9.9.9.9.9.9.9.9.9.9.9.4.1.1.1.1.1.1.1.1.1.m1.1.2.3.2.3">j</mi></msub><mo id="S3.F2.pic1.9.9.9.9.9.9.9.9.9.9.9.9.9.9.4.1.1.1.1.1.1.1.1.1.m1.1.2.3.3" rspace="0.055em" stretchy="false">)</mo></mrow><mo id="S3.F2.pic1.9.9.9.9.9.9.9.9.9.9.9.9.9.9.4.1.1.1.1.1.1.1.1.1.m1.1.2.4" rspace="0.222em">⊗</mo><msub id="S3.F2.pic1.9.9.9.9.9.9.9.9.9.9.9.9.9.9.4.1.1.1.1.1.1.1.1.1.m1.1.2.5"><mover accent="true" id="S3.F2.pic1.9.9.9.9.9.9.9.9.9.9.9.9.9.9.4.1.1.1.1.1.1.1.1.1.m1.1.2.5.2"><mi id="S3.F2.pic1.9.9.9.9.9.9.9.9.9.9.9.9.9.9.4.1.1.1.1.1.1.1.1.1.m1.1.2.5.2.2">ϕ</mi><mo id="S3.F2.pic1.9.9.9.9.9.9.9.9.9.9.9.9.9.9.4.1.1.1.1.1.1.1.1.1.m1.1.2.5.2.1">^</mo></mover><mi class="ltx_font_mathcaligraphic" id="S3.F2.pic1.9.9.9.9.9.9.9.9.9.9.9.9.9.9.4.1.1.1.1.1.1.1.1.1.m1.1.2.5.3">𝒢</mi></msub><mrow id="S3.F2.pic1.9.9.9.9.9.9.9.9.9.9.9.9.9.9.4.1.1.1.1.1.1.1.1.1.m1.1.2.6"><mo id="S3.F2.pic1.9.9.9.9.9.9.9.9.9.9.9.9.9.9.4.1.1.1.1.1.1.1.1.1.m1.1.2.6.1" stretchy="false">(</mo><msub id="S3.F2.pic1.9.9.9.9.9.9.9.9.9.9.9.9.9.9.4.1.1.1.1.1.1.1.1.1.m1.1.2.6.2"><mi id="S3.F2.pic1.9.9.9.9.9.9.9.9.9.9.9.9.9.9.4.1.1.1.1.1.1.1.1.1.m1.1.2.6.2.2">v</mi><mi id="S3.F2.pic1.9.9.9.9.9.9.9.9.9.9.9.9.9.9.4.1.1.1.1.1.1.1.1.1.m1.1.2.6.2.3">j</mi></msub><mo id="S3.F2.pic1.9.9.9.9.9.9.9.9.9.9.9.9.9.9.4.1.1.1.1.1.1.1.1.1.m1.1.2.6.3" stretchy="false">)</mo></mrow><mo id="S3.F2.pic1.9.9.9.9.9.9.9.9.9.9.9.9.9.9.4.1.1.1.1.1.1.1.1.1.m1.1.2.7">]</mo></mrow><mo id="S3.F2.pic1.9.9.9.9.9.9.9.9.9.9.9.9.9.9.4.1.1.1.1.1.1.1.1.1.m1.1.3">)</mo></mrow><annotation encoding="application/x-tex" id="S3.F2.pic1.9.9.9.9.9.9.9.9.9.9.9.9.9.9.4.1.1.1.1.1.1.1.1.1.m1.1c">\left.\textrm{vec}\left[\phi(\bm{k}_{j})\otimes\widehat{\phi}_{\mathcal{G}}(v_%
{j})\right]\right)</annotation><annotation encoding="application/x-llamapun" id="S3.F2.pic1.9.9.9.9.9.9.9.9.9.9.9.9.9.9.4.1.1.1.1.1.1.1.1.1.m1.1d">vec [ italic_ϕ ( bold_italic_k start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) ⊗ over^ start_ARG italic_ϕ end_ARG start_POSTSUBSCRIPT caligraphic_G end_POSTSUBSCRIPT ( italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) ] )</annotation></semantics></math></foreignObject></g></g><g fill="#FFFFFF" stroke-width="0.5pt"><path d="M -98.16 103.15 C -98.16 106.75 -101.08 109.67 -104.68 109.67 C -108.28 109.67 -111.2 106.75 -111.2 103.15 C -111.2 99.55 -108.28 96.63 -104.68 96.63 C -101.08 96.63 -98.16 99.55 -98.16 103.15 Z M -104.68 103.15"></path></g><g fill="#FFFFFF" stroke-width="0.5pt"><path d="M -124.57 121.35 C -124.57 124.95 -127.49 127.87 -131.1 127.87 C -134.7 127.87 -137.62 124.95 -137.62 121.35 C -137.62 117.74 -134.7 114.82 -131.1 114.82 C -127.49 114.82 -124.57 117.74 -124.57 121.35 Z M -131.1 121.35"></path></g><g fill="#FFFFFF" stroke-width="0.5pt"><path d="M -138.2 87.14 C -138.2 90.74 -141.12 93.66 -144.72 93.66 C -148.32 93.66 -151.24 90.74 -151.24 87.14 C -151.24 83.54 -148.32 80.62 -144.72 80.62 C -141.12 80.62 -138.2 83.54 -138.2 87.14 Z M -144.72 87.14"></path></g><g fill="#FFFFFF" stroke-width="0.5pt"><path d="M -98.63 75.45 C -98.63 79.06 -101.55 81.98 -105.15 81.98 C -108.76 81.98 -111.68 79.06 -111.68 75.45 C -111.68 71.85 -108.76 68.93 -105.15 68.93 C -101.55 68.93 -98.63 71.85 -98.63 75.45 Z M -105.15 75.45"></path></g><g fill="#FFFFFF" stroke-width="0.5pt"><path d="M -68.83 150.01 C -68.83 153.61 -71.75 156.53 -75.35 156.53 C -78.95 156.53 -81.87 153.61 -81.87 150.01 C -81.87 146.41 -78.95 143.49 -75.35 143.49 C -71.75 143.49 -68.83 146.41 -68.83 150.01 Z M -75.35 150.01"></path></g><g fill="#FFFFFF" stroke-width="0.5pt"><path d="M -47.95 93.87 C -47.95 97.48 -50.87 100.4 -54.47 100.4 C -58.07 100.4 -60.99 97.48 -60.99 93.87 C -60.99 90.27 -58.07 87.35 -54.47 87.35 C -50.87 87.35 -47.95 90.27 -47.95 93.87 Z M -54.47 93.87"></path></g><g fill="#FFFFFF" stroke-width="0.5pt"><path d="M -48.56 121.22 C -48.56 124.82 -51.48 127.74 -55.08 127.74 C -58.68 127.74 -61.6 124.82 -61.6 121.22 C -61.6 117.61 -58.68 114.69 -55.08 114.69 C -51.48 114.69 -48.56 117.61 -48.56 121.22 Z M -55.08 121.22"></path></g><g fill="#FFFFFF" stroke-width="0.5pt"><path d="M -105 121.44 C -105 125.04 -107.92 127.96 -111.52 127.96 C -115.12 127.96 -118.04 125.04 -118.04 121.44 C -118.04 117.83 -115.12 114.91 -111.52 114.91 C -107.92 114.91 -105 117.83 -105 121.44 Z M -111.52 121.44"></path></g><g fill="#FFFFFF" stroke-width="0.5pt"><path d="M -141.41 66.52 C -141.41 70.12 -144.33 73.04 -147.93 73.04 C -151.54 73.04 -154.46 70.12 -154.46 66.52 C -154.46 62.92 -151.54 60 -147.93 60 C -144.33 60 -141.41 62.92 -141.41 66.52 Z M -147.93 66.52"></path></g><g stroke-width="0.4pt"><g fill="#000000" stroke="#000000" transform="matrix(0.75 0.0 0.0 0.75 -148.42 85.87)"><foreignObject height="8.51" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="9.87"><math alttext="v_{i}" class="ltx_Math" display="inline" id="S3.F2.pic1.11.11.11.11.11.11.11.11.11.11.2.2.1.1.1.1.1.1.1.1.1.m1.1"><semantics id="S3.F2.pic1.11.11.11.11.11.11.11.11.11.11.2.2.1.1.1.1.1.1.1.1.1.m1.1a"><msub id="S3.F2.pic1.11.11.11.11.11.11.11.11.11.11.2.2.1.1.1.1.1.1.1.1.1.m1.1.1" xref="S3.F2.pic1.11.11.11.11.11.11.11.11.11.11.2.2.1.1.1.1.1.1.1.1.1.m1.1.1.cmml"><mi id="S3.F2.pic1.11.11.11.11.11.11.11.11.11.11.2.2.1.1.1.1.1.1.1.1.1.m1.1.1.2" xref="S3.F2.pic1.11.11.11.11.11.11.11.11.11.11.2.2.1.1.1.1.1.1.1.1.1.m1.1.1.2.cmml">v</mi><mi id="S3.F2.pic1.11.11.11.11.11.11.11.11.11.11.2.2.1.1.1.1.1.1.1.1.1.m1.1.1.3" xref="S3.F2.pic1.11.11.11.11.11.11.11.11.11.11.2.2.1.1.1.1.1.1.1.1.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.F2.pic1.11.11.11.11.11.11.11.11.11.11.2.2.1.1.1.1.1.1.1.1.1.m1.1b"><apply id="S3.F2.pic1.11.11.11.11.11.11.11.11.11.11.2.2.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S3.F2.pic1.11.11.11.11.11.11.11.11.11.11.2.2.1.1.1.1.1.1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.F2.pic1.11.11.11.11.11.11.11.11.11.11.2.2.1.1.1.1.1.1.1.1.1.m1.1.1.1.cmml" xref="S3.F2.pic1.11.11.11.11.11.11.11.11.11.11.2.2.1.1.1.1.1.1.1.1.1.m1.1.1">subscript</csymbol><ci id="S3.F2.pic1.11.11.11.11.11.11.11.11.11.11.2.2.1.1.1.1.1.1.1.1.1.m1.1.1.2.cmml" xref="S3.F2.pic1.11.11.11.11.11.11.11.11.11.11.2.2.1.1.1.1.1.1.1.1.1.m1.1.1.2">𝑣</ci><ci id="S3.F2.pic1.11.11.11.11.11.11.11.11.11.11.2.2.1.1.1.1.1.1.1.1.1.m1.1.1.3.cmml" xref="S3.F2.pic1.11.11.11.11.11.11.11.11.11.11.2.2.1.1.1.1.1.1.1.1.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.pic1.11.11.11.11.11.11.11.11.11.11.2.2.1.1.1.1.1.1.1.1.1.m1.1c">v_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.F2.pic1.11.11.11.11.11.11.11.11.11.11.2.2.1.1.1.1.1.1.1.1.1.m1.1d">italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math></foreignObject></g><g fill="#000000" stroke="#000000" transform="matrix(0.75 0.0 0.0 0.75 -79.41 149.3)"><foreignObject height="10.02" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="10.84"><math alttext="v_{j}" class="ltx_Math" display="inline" id="S3.F2.pic1.12.12.12.12.12.12.12.12.12.12.3.3.1.1.1.1.1.1.1.1.1.m1.1"><semantics id="S3.F2.pic1.12.12.12.12.12.12.12.12.12.12.3.3.1.1.1.1.1.1.1.1.1.m1.1a"><msub id="S3.F2.pic1.12.12.12.12.12.12.12.12.12.12.3.3.1.1.1.1.1.1.1.1.1.m1.1.1" xref="S3.F2.pic1.12.12.12.12.12.12.12.12.12.12.3.3.1.1.1.1.1.1.1.1.1.m1.1.1.cmml"><mi id="S3.F2.pic1.12.12.12.12.12.12.12.12.12.12.3.3.1.1.1.1.1.1.1.1.1.m1.1.1.2" xref="S3.F2.pic1.12.12.12.12.12.12.12.12.12.12.3.3.1.1.1.1.1.1.1.1.1.m1.1.1.2.cmml">v</mi><mi id="S3.F2.pic1.12.12.12.12.12.12.12.12.12.12.3.3.1.1.1.1.1.1.1.1.1.m1.1.1.3" xref="S3.F2.pic1.12.12.12.12.12.12.12.12.12.12.3.3.1.1.1.1.1.1.1.1.1.m1.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.F2.pic1.12.12.12.12.12.12.12.12.12.12.3.3.1.1.1.1.1.1.1.1.1.m1.1b"><apply id="S3.F2.pic1.12.12.12.12.12.12.12.12.12.12.3.3.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S3.F2.pic1.12.12.12.12.12.12.12.12.12.12.3.3.1.1.1.1.1.1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.F2.pic1.12.12.12.12.12.12.12.12.12.12.3.3.1.1.1.1.1.1.1.1.1.m1.1.1.1.cmml" xref="S3.F2.pic1.12.12.12.12.12.12.12.12.12.12.3.3.1.1.1.1.1.1.1.1.1.m1.1.1">subscript</csymbol><ci id="S3.F2.pic1.12.12.12.12.12.12.12.12.12.12.3.3.1.1.1.1.1.1.1.1.1.m1.1.1.2.cmml" xref="S3.F2.pic1.12.12.12.12.12.12.12.12.12.12.3.3.1.1.1.1.1.1.1.1.1.m1.1.1.2">𝑣</ci><ci id="S3.F2.pic1.12.12.12.12.12.12.12.12.12.12.3.3.1.1.1.1.1.1.1.1.1.m1.1.1.3.cmml" xref="S3.F2.pic1.12.12.12.12.12.12.12.12.12.12.3.3.1.1.1.1.1.1.1.1.1.m1.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.pic1.12.12.12.12.12.12.12.12.12.12.3.3.1.1.1.1.1.1.1.1.1.m1.1c">v_{j}</annotation><annotation encoding="application/x-llamapun" id="S3.F2.pic1.12.12.12.12.12.12.12.12.12.12.3.3.1.1.1.1.1.1.1.1.1.m1.1d">italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math></foreignObject></g></g></g></g></svg><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>Visual overview.
A graph <math alttext="\mathcal{G}" class="ltx_Math" display="inline" id="S3.F2.11.m1.1"><semantics id="S3.F2.11.m1.1b"><mi class="ltx_font_mathcaligraphic" id="S3.F2.11.m1.1.1" xref="S3.F2.11.m1.1.1.cmml">𝒢</mi><annotation-xml encoding="MathML-Content" id="S3.F2.11.m1.1c"><ci id="S3.F2.11.m1.1.1.cmml" xref="S3.F2.11.m1.1.1">𝒢</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.11.m1.1d">\mathcal{G}</annotation><annotation encoding="application/x-llamapun" id="S3.F2.11.m1.1e">caligraphic_G</annotation></semantics></math> (left) has a weighted adjacency matrix <math alttext="\mathbf{W}" class="ltx_Math" display="inline" id="S3.F2.12.m2.1"><semantics id="S3.F2.12.m2.1b"><mi id="S3.F2.12.m2.1.1" xref="S3.F2.12.m2.1.1.cmml">𝐖</mi><annotation-xml encoding="MathML-Content" id="S3.F2.12.m2.1c"><ci id="S3.F2.12.m2.1.1.cmml" xref="S3.F2.12.m2.1.1">𝐖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.12.m2.1d">\mathbf{W}</annotation><annotation encoding="application/x-llamapun" id="S3.F2.12.m2.1e">bold_W</annotation></semantics></math> (centre left).
A learnable power series <math alttext="\mathbf{M}_{\alpha}(\mathcal{G})\coloneqq\sum_{i=0}^{\infty}\alpha_{i}\mathbf{%
W}^{i}" class="ltx_Math" display="inline" id="S3.F2.13.m3.1"><semantics id="S3.F2.13.m3.1b"><mrow id="S3.F2.13.m3.1.2" xref="S3.F2.13.m3.1.2.cmml"><mrow id="S3.F2.13.m3.1.2.2" xref="S3.F2.13.m3.1.2.2.cmml"><msub id="S3.F2.13.m3.1.2.2.2" xref="S3.F2.13.m3.1.2.2.2.cmml"><mi id="S3.F2.13.m3.1.2.2.2.2" xref="S3.F2.13.m3.1.2.2.2.2.cmml">𝐌</mi><mi id="S3.F2.13.m3.1.2.2.2.3" xref="S3.F2.13.m3.1.2.2.2.3.cmml">α</mi></msub><mo id="S3.F2.13.m3.1.2.2.1" xref="S3.F2.13.m3.1.2.2.1.cmml">⁢</mo><mrow id="S3.F2.13.m3.1.2.2.3.2" xref="S3.F2.13.m3.1.2.2.cmml"><mo id="S3.F2.13.m3.1.2.2.3.2.1" stretchy="false" xref="S3.F2.13.m3.1.2.2.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S3.F2.13.m3.1.1" xref="S3.F2.13.m3.1.1.cmml">𝒢</mi><mo id="S3.F2.13.m3.1.2.2.3.2.2" stretchy="false" xref="S3.F2.13.m3.1.2.2.cmml">)</mo></mrow></mrow><mo id="S3.F2.13.m3.1.2.1" rspace="0.111em" xref="S3.F2.13.m3.1.2.1.cmml">≔</mo><mrow id="S3.F2.13.m3.1.2.3" xref="S3.F2.13.m3.1.2.3.cmml"><msubsup id="S3.F2.13.m3.1.2.3.1" xref="S3.F2.13.m3.1.2.3.1.cmml"><mo id="S3.F2.13.m3.1.2.3.1.2.2" xref="S3.F2.13.m3.1.2.3.1.2.2.cmml">∑</mo><mrow id="S3.F2.13.m3.1.2.3.1.2.3" xref="S3.F2.13.m3.1.2.3.1.2.3.cmml"><mi id="S3.F2.13.m3.1.2.3.1.2.3.2" xref="S3.F2.13.m3.1.2.3.1.2.3.2.cmml">i</mi><mo id="S3.F2.13.m3.1.2.3.1.2.3.1" xref="S3.F2.13.m3.1.2.3.1.2.3.1.cmml">=</mo><mn id="S3.F2.13.m3.1.2.3.1.2.3.3" xref="S3.F2.13.m3.1.2.3.1.2.3.3.cmml">0</mn></mrow><mi id="S3.F2.13.m3.1.2.3.1.3" mathvariant="normal" xref="S3.F2.13.m3.1.2.3.1.3.cmml">∞</mi></msubsup><mrow id="S3.F2.13.m3.1.2.3.2" xref="S3.F2.13.m3.1.2.3.2.cmml"><msub id="S3.F2.13.m3.1.2.3.2.2" xref="S3.F2.13.m3.1.2.3.2.2.cmml"><mi id="S3.F2.13.m3.1.2.3.2.2.2" xref="S3.F2.13.m3.1.2.3.2.2.2.cmml">α</mi><mi id="S3.F2.13.m3.1.2.3.2.2.3" xref="S3.F2.13.m3.1.2.3.2.2.3.cmml">i</mi></msub><mo id="S3.F2.13.m3.1.2.3.2.1" xref="S3.F2.13.m3.1.2.3.2.1.cmml">⁢</mo><msup id="S3.F2.13.m3.1.2.3.2.3" xref="S3.F2.13.m3.1.2.3.2.3.cmml"><mi id="S3.F2.13.m3.1.2.3.2.3.2" xref="S3.F2.13.m3.1.2.3.2.3.2.cmml">𝐖</mi><mi id="S3.F2.13.m3.1.2.3.2.3.3" xref="S3.F2.13.m3.1.2.3.2.3.3.cmml">i</mi></msup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.F2.13.m3.1c"><apply id="S3.F2.13.m3.1.2.cmml" xref="S3.F2.13.m3.1.2"><ci id="S3.F2.13.m3.1.2.1.cmml" xref="S3.F2.13.m3.1.2.1">≔</ci><apply id="S3.F2.13.m3.1.2.2.cmml" xref="S3.F2.13.m3.1.2.2"><times id="S3.F2.13.m3.1.2.2.1.cmml" xref="S3.F2.13.m3.1.2.2.1"></times><apply id="S3.F2.13.m3.1.2.2.2.cmml" xref="S3.F2.13.m3.1.2.2.2"><csymbol cd="ambiguous" id="S3.F2.13.m3.1.2.2.2.1.cmml" xref="S3.F2.13.m3.1.2.2.2">subscript</csymbol><ci id="S3.F2.13.m3.1.2.2.2.2.cmml" xref="S3.F2.13.m3.1.2.2.2.2">𝐌</ci><ci id="S3.F2.13.m3.1.2.2.2.3.cmml" xref="S3.F2.13.m3.1.2.2.2.3">𝛼</ci></apply><ci id="S3.F2.13.m3.1.1.cmml" xref="S3.F2.13.m3.1.1">𝒢</ci></apply><apply id="S3.F2.13.m3.1.2.3.cmml" xref="S3.F2.13.m3.1.2.3"><apply id="S3.F2.13.m3.1.2.3.1.cmml" xref="S3.F2.13.m3.1.2.3.1"><csymbol cd="ambiguous" id="S3.F2.13.m3.1.2.3.1.1.cmml" xref="S3.F2.13.m3.1.2.3.1">superscript</csymbol><apply id="S3.F2.13.m3.1.2.3.1.2.cmml" xref="S3.F2.13.m3.1.2.3.1"><csymbol cd="ambiguous" id="S3.F2.13.m3.1.2.3.1.2.1.cmml" xref="S3.F2.13.m3.1.2.3.1">subscript</csymbol><sum id="S3.F2.13.m3.1.2.3.1.2.2.cmml" xref="S3.F2.13.m3.1.2.3.1.2.2"></sum><apply id="S3.F2.13.m3.1.2.3.1.2.3.cmml" xref="S3.F2.13.m3.1.2.3.1.2.3"><eq id="S3.F2.13.m3.1.2.3.1.2.3.1.cmml" xref="S3.F2.13.m3.1.2.3.1.2.3.1"></eq><ci id="S3.F2.13.m3.1.2.3.1.2.3.2.cmml" xref="S3.F2.13.m3.1.2.3.1.2.3.2">𝑖</ci><cn id="S3.F2.13.m3.1.2.3.1.2.3.3.cmml" type="integer" xref="S3.F2.13.m3.1.2.3.1.2.3.3">0</cn></apply></apply><infinity id="S3.F2.13.m3.1.2.3.1.3.cmml" xref="S3.F2.13.m3.1.2.3.1.3"></infinity></apply><apply id="S3.F2.13.m3.1.2.3.2.cmml" xref="S3.F2.13.m3.1.2.3.2"><times id="S3.F2.13.m3.1.2.3.2.1.cmml" xref="S3.F2.13.m3.1.2.3.2.1"></times><apply id="S3.F2.13.m3.1.2.3.2.2.cmml" xref="S3.F2.13.m3.1.2.3.2.2"><csymbol cd="ambiguous" id="S3.F2.13.m3.1.2.3.2.2.1.cmml" xref="S3.F2.13.m3.1.2.3.2.2">subscript</csymbol><ci id="S3.F2.13.m3.1.2.3.2.2.2.cmml" xref="S3.F2.13.m3.1.2.3.2.2.2">𝛼</ci><ci id="S3.F2.13.m3.1.2.3.2.2.3.cmml" xref="S3.F2.13.m3.1.2.3.2.2.3">𝑖</ci></apply><apply id="S3.F2.13.m3.1.2.3.2.3.cmml" xref="S3.F2.13.m3.1.2.3.2.3"><csymbol cd="ambiguous" id="S3.F2.13.m3.1.2.3.2.3.1.cmml" xref="S3.F2.13.m3.1.2.3.2.3">superscript</csymbol><ci id="S3.F2.13.m3.1.2.3.2.3.2.cmml" xref="S3.F2.13.m3.1.2.3.2.3.2">𝐖</ci><ci id="S3.F2.13.m3.1.2.3.2.3.3.cmml" xref="S3.F2.13.m3.1.2.3.2.3.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.13.m3.1d">\mathbf{M}_{\alpha}(\mathcal{G})\coloneqq\sum_{i=0}^{\infty}\alpha_{i}\mathbf{%
W}^{i}</annotation><annotation encoding="application/x-llamapun" id="S3.F2.13.m3.1e">bold_M start_POSTSUBSCRIPT italic_α end_POSTSUBSCRIPT ( caligraphic_G ) ≔ ∑ start_POSTSUBSCRIPT italic_i = 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∞ end_POSTSUPERSCRIPT italic_α start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT bold_W start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT</annotation></semantics></math> is an effective topological mask or graph RPE (centre right).
<math alttext="\mathbf{M}_{\alpha}(\mathcal{G})" class="ltx_Math" display="inline" id="S3.F2.14.m4.1"><semantics id="S3.F2.14.m4.1b"><mrow id="S3.F2.14.m4.1.2" xref="S3.F2.14.m4.1.2.cmml"><msub id="S3.F2.14.m4.1.2.2" xref="S3.F2.14.m4.1.2.2.cmml"><mi id="S3.F2.14.m4.1.2.2.2" xref="S3.F2.14.m4.1.2.2.2.cmml">𝐌</mi><mi id="S3.F2.14.m4.1.2.2.3" xref="S3.F2.14.m4.1.2.2.3.cmml">α</mi></msub><mo id="S3.F2.14.m4.1.2.1" xref="S3.F2.14.m4.1.2.1.cmml">⁢</mo><mrow id="S3.F2.14.m4.1.2.3.2" xref="S3.F2.14.m4.1.2.cmml"><mo id="S3.F2.14.m4.1.2.3.2.1" stretchy="false" xref="S3.F2.14.m4.1.2.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S3.F2.14.m4.1.1" xref="S3.F2.14.m4.1.1.cmml">𝒢</mi><mo id="S3.F2.14.m4.1.2.3.2.2" stretchy="false" xref="S3.F2.14.m4.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.F2.14.m4.1c"><apply id="S3.F2.14.m4.1.2.cmml" xref="S3.F2.14.m4.1.2"><times id="S3.F2.14.m4.1.2.1.cmml" xref="S3.F2.14.m4.1.2.1"></times><apply id="S3.F2.14.m4.1.2.2.cmml" xref="S3.F2.14.m4.1.2.2"><csymbol cd="ambiguous" id="S3.F2.14.m4.1.2.2.1.cmml" xref="S3.F2.14.m4.1.2.2">subscript</csymbol><ci id="S3.F2.14.m4.1.2.2.2.cmml" xref="S3.F2.14.m4.1.2.2.2">𝐌</ci><ci id="S3.F2.14.m4.1.2.2.3.cmml" xref="S3.F2.14.m4.1.2.2.3">𝛼</ci></apply><ci id="S3.F2.14.m4.1.1.cmml" xref="S3.F2.14.m4.1.1">𝒢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.14.m4.1d">\mathbf{M}_{\alpha}(\mathcal{G})</annotation><annotation encoding="application/x-llamapun" id="S3.F2.14.m4.1e">bold_M start_POSTSUBSCRIPT italic_α end_POSTSUBSCRIPT ( caligraphic_G )</annotation></semantics></math> can be efficiently approximated using graph random features (centre top), which perform importance sampling of halting random walks.
The feature <math alttext="\widehat{\phi}_{\mathcal{G}}(v_{i})" class="ltx_Math" display="inline" id="S3.F2.15.m5.1"><semantics id="S3.F2.15.m5.1b"><mrow id="S3.F2.15.m5.1.1" xref="S3.F2.15.m5.1.1.cmml"><msub id="S3.F2.15.m5.1.1.3" xref="S3.F2.15.m5.1.1.3.cmml"><mover accent="true" id="S3.F2.15.m5.1.1.3.2" xref="S3.F2.15.m5.1.1.3.2.cmml"><mi id="S3.F2.15.m5.1.1.3.2.2" xref="S3.F2.15.m5.1.1.3.2.2.cmml">ϕ</mi><mo id="S3.F2.15.m5.1.1.3.2.1" xref="S3.F2.15.m5.1.1.3.2.1.cmml">^</mo></mover><mi class="ltx_font_mathcaligraphic" id="S3.F2.15.m5.1.1.3.3" xref="S3.F2.15.m5.1.1.3.3.cmml">𝒢</mi></msub><mo id="S3.F2.15.m5.1.1.2" xref="S3.F2.15.m5.1.1.2.cmml">⁢</mo><mrow id="S3.F2.15.m5.1.1.1.1" xref="S3.F2.15.m5.1.1.1.1.1.cmml"><mo id="S3.F2.15.m5.1.1.1.1.2" stretchy="false" xref="S3.F2.15.m5.1.1.1.1.1.cmml">(</mo><msub id="S3.F2.15.m5.1.1.1.1.1" xref="S3.F2.15.m5.1.1.1.1.1.cmml"><mi id="S3.F2.15.m5.1.1.1.1.1.2" xref="S3.F2.15.m5.1.1.1.1.1.2.cmml">v</mi><mi id="S3.F2.15.m5.1.1.1.1.1.3" xref="S3.F2.15.m5.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.F2.15.m5.1.1.1.1.3" stretchy="false" xref="S3.F2.15.m5.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.F2.15.m5.1c"><apply id="S3.F2.15.m5.1.1.cmml" xref="S3.F2.15.m5.1.1"><times id="S3.F2.15.m5.1.1.2.cmml" xref="S3.F2.15.m5.1.1.2"></times><apply id="S3.F2.15.m5.1.1.3.cmml" xref="S3.F2.15.m5.1.1.3"><csymbol cd="ambiguous" id="S3.F2.15.m5.1.1.3.1.cmml" xref="S3.F2.15.m5.1.1.3">subscript</csymbol><apply id="S3.F2.15.m5.1.1.3.2.cmml" xref="S3.F2.15.m5.1.1.3.2"><ci id="S3.F2.15.m5.1.1.3.2.1.cmml" xref="S3.F2.15.m5.1.1.3.2.1">^</ci><ci id="S3.F2.15.m5.1.1.3.2.2.cmml" xref="S3.F2.15.m5.1.1.3.2.2">italic-ϕ</ci></apply><ci id="S3.F2.15.m5.1.1.3.3.cmml" xref="S3.F2.15.m5.1.1.3.3">𝒢</ci></apply><apply id="S3.F2.15.m5.1.1.1.1.1.cmml" xref="S3.F2.15.m5.1.1.1.1"><csymbol cd="ambiguous" id="S3.F2.15.m5.1.1.1.1.1.1.cmml" xref="S3.F2.15.m5.1.1.1.1">subscript</csymbol><ci id="S3.F2.15.m5.1.1.1.1.1.2.cmml" xref="S3.F2.15.m5.1.1.1.1.1.2">𝑣</ci><ci id="S3.F2.15.m5.1.1.1.1.1.3.cmml" xref="S3.F2.15.m5.1.1.1.1.1.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.15.m5.1d">\widehat{\phi}_{\mathcal{G}}(v_{i})</annotation><annotation encoding="application/x-llamapun" id="S3.F2.15.m5.1e">over^ start_ARG italic_ϕ end_ARG start_POSTSUBSCRIPT caligraphic_G end_POSTSUBSCRIPT ( italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT )</annotation></semantics></math> is only nonzero at entries visited by the ensemble of walks beginning at <math alttext="v_{i}" class="ltx_Math" display="inline" id="S3.F2.16.m6.1"><semantics id="S3.F2.16.m6.1b"><msub id="S3.F2.16.m6.1.1" xref="S3.F2.16.m6.1.1.cmml"><mi id="S3.F2.16.m6.1.1.2" xref="S3.F2.16.m6.1.1.2.cmml">v</mi><mi id="S3.F2.16.m6.1.1.3" xref="S3.F2.16.m6.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.F2.16.m6.1c"><apply id="S3.F2.16.m6.1.1.cmml" xref="S3.F2.16.m6.1.1"><csymbol cd="ambiguous" id="S3.F2.16.m6.1.1.1.cmml" xref="S3.F2.16.m6.1.1">subscript</csymbol><ci id="S3.F2.16.m6.1.1.2.cmml" xref="S3.F2.16.m6.1.1.2">𝑣</ci><ci id="S3.F2.16.m6.1.1.3.cmml" xref="S3.F2.16.m6.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.16.m6.1d">v_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.F2.16.m6.1e">italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>.
In Thm.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#S3.Thmtheorem1" title="Theorem 3.1 (GRF exponential concentration bounds). ‣ 3.4 Novel theoretical results for GRFs: sharp estimators with sparse features ‣ 3 Towards linear topological masking ‣ Linear Transformer Topological Masking with Graph Random Features"><span class="ltx_text ltx_ref_tag">3.1</span></a>, we prove that the number of such entries is <math alttext="\mathcal{O}(1)" class="ltx_Math" display="inline" id="S3.F2.17.m7.1"><semantics id="S3.F2.17.m7.1b"><mrow id="S3.F2.17.m7.1.2" xref="S3.F2.17.m7.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.F2.17.m7.1.2.2" xref="S3.F2.17.m7.1.2.2.cmml">𝒪</mi><mo id="S3.F2.17.m7.1.2.1" xref="S3.F2.17.m7.1.2.1.cmml">⁢</mo><mrow id="S3.F2.17.m7.1.2.3.2" xref="S3.F2.17.m7.1.2.cmml"><mo id="S3.F2.17.m7.1.2.3.2.1" stretchy="false" xref="S3.F2.17.m7.1.2.cmml">(</mo><mn id="S3.F2.17.m7.1.1" xref="S3.F2.17.m7.1.1.cmml">1</mn><mo id="S3.F2.17.m7.1.2.3.2.2" stretchy="false" xref="S3.F2.17.m7.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.F2.17.m7.1c"><apply id="S3.F2.17.m7.1.2.cmml" xref="S3.F2.17.m7.1.2"><times id="S3.F2.17.m7.1.2.1.cmml" xref="S3.F2.17.m7.1.2.1"></times><ci id="S3.F2.17.m7.1.2.2.cmml" xref="S3.F2.17.m7.1.2.2">𝒪</ci><cn id="S3.F2.17.m7.1.1.cmml" type="integer" xref="S3.F2.17.m7.1.1">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.17.m7.1d">\mathcal{O}(1)</annotation><annotation encoding="application/x-llamapun" id="S3.F2.17.m7.1e">caligraphic_O ( 1 )</annotation></semantics></math> whilst still accurately estimating <math alttext="\mathbf{M}_{\alpha}(\mathbf{W})_{ij}" class="ltx_Math" display="inline" id="S3.F2.18.m8.1"><semantics id="S3.F2.18.m8.1b"><mrow id="S3.F2.18.m8.1.2" xref="S3.F2.18.m8.1.2.cmml"><msub id="S3.F2.18.m8.1.2.2" xref="S3.F2.18.m8.1.2.2.cmml"><mi id="S3.F2.18.m8.1.2.2.2" xref="S3.F2.18.m8.1.2.2.2.cmml">𝐌</mi><mi id="S3.F2.18.m8.1.2.2.3" xref="S3.F2.18.m8.1.2.2.3.cmml">α</mi></msub><mo id="S3.F2.18.m8.1.2.1" xref="S3.F2.18.m8.1.2.1.cmml">⁢</mo><msub id="S3.F2.18.m8.1.2.3" xref="S3.F2.18.m8.1.2.3.cmml"><mrow id="S3.F2.18.m8.1.2.3.2.2" xref="S3.F2.18.m8.1.2.3.cmml"><mo id="S3.F2.18.m8.1.2.3.2.2.1" stretchy="false" xref="S3.F2.18.m8.1.2.3.cmml">(</mo><mi id="S3.F2.18.m8.1.1" xref="S3.F2.18.m8.1.1.cmml">𝐖</mi><mo id="S3.F2.18.m8.1.2.3.2.2.2" stretchy="false" xref="S3.F2.18.m8.1.2.3.cmml">)</mo></mrow><mrow id="S3.F2.18.m8.1.2.3.3" xref="S3.F2.18.m8.1.2.3.3.cmml"><mi id="S3.F2.18.m8.1.2.3.3.2" xref="S3.F2.18.m8.1.2.3.3.2.cmml">i</mi><mo id="S3.F2.18.m8.1.2.3.3.1" xref="S3.F2.18.m8.1.2.3.3.1.cmml">⁢</mo><mi id="S3.F2.18.m8.1.2.3.3.3" xref="S3.F2.18.m8.1.2.3.3.3.cmml">j</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.F2.18.m8.1c"><apply id="S3.F2.18.m8.1.2.cmml" xref="S3.F2.18.m8.1.2"><times id="S3.F2.18.m8.1.2.1.cmml" xref="S3.F2.18.m8.1.2.1"></times><apply id="S3.F2.18.m8.1.2.2.cmml" xref="S3.F2.18.m8.1.2.2"><csymbol cd="ambiguous" id="S3.F2.18.m8.1.2.2.1.cmml" xref="S3.F2.18.m8.1.2.2">subscript</csymbol><ci id="S3.F2.18.m8.1.2.2.2.cmml" xref="S3.F2.18.m8.1.2.2.2">𝐌</ci><ci id="S3.F2.18.m8.1.2.2.3.cmml" xref="S3.F2.18.m8.1.2.2.3">𝛼</ci></apply><apply id="S3.F2.18.m8.1.2.3.cmml" xref="S3.F2.18.m8.1.2.3"><csymbol cd="ambiguous" id="S3.F2.18.m8.1.2.3.1.cmml" xref="S3.F2.18.m8.1.2.3">subscript</csymbol><ci id="S3.F2.18.m8.1.1.cmml" xref="S3.F2.18.m8.1.1">𝐖</ci><apply id="S3.F2.18.m8.1.2.3.3.cmml" xref="S3.F2.18.m8.1.2.3.3"><times id="S3.F2.18.m8.1.2.3.3.1.cmml" xref="S3.F2.18.m8.1.2.3.3.1"></times><ci id="S3.F2.18.m8.1.2.3.3.2.cmml" xref="S3.F2.18.m8.1.2.3.3.2">𝑖</ci><ci id="S3.F2.18.m8.1.2.3.3.3.cmml" xref="S3.F2.18.m8.1.2.3.3.3">𝑗</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.18.m8.1d">\mathbf{M}_{\alpha}(\mathbf{W})_{ij}</annotation><annotation encoding="application/x-llamapun" id="S3.F2.18.m8.1e">bold_M start_POSTSUBSCRIPT italic_α end_POSTSUBSCRIPT ( bold_W ) start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT</annotation></semantics></math> with high probability, so GRFs are sparse.
This unlocks <math alttext="\mathcal{O}(N)" class="ltx_Math" display="inline" id="S3.F2.19.m9.1"><semantics id="S3.F2.19.m9.1b"><mrow id="S3.F2.19.m9.1.2" xref="S3.F2.19.m9.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.F2.19.m9.1.2.2" xref="S3.F2.19.m9.1.2.2.cmml">𝒪</mi><mo id="S3.F2.19.m9.1.2.1" xref="S3.F2.19.m9.1.2.1.cmml">⁢</mo><mrow id="S3.F2.19.m9.1.2.3.2" xref="S3.F2.19.m9.1.2.cmml"><mo id="S3.F2.19.m9.1.2.3.2.1" stretchy="false" xref="S3.F2.19.m9.1.2.cmml">(</mo><mi id="S3.F2.19.m9.1.1" xref="S3.F2.19.m9.1.1.cmml">N</mi><mo id="S3.F2.19.m9.1.2.3.2.2" stretchy="false" xref="S3.F2.19.m9.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.F2.19.m9.1c"><apply id="S3.F2.19.m9.1.2.cmml" xref="S3.F2.19.m9.1.2"><times id="S3.F2.19.m9.1.2.1.cmml" xref="S3.F2.19.m9.1.2.1"></times><ci id="S3.F2.19.m9.1.2.2.cmml" xref="S3.F2.19.m9.1.2.2">𝒪</ci><ci id="S3.F2.19.m9.1.1.cmml" xref="S3.F2.19.m9.1.1">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.19.m9.1d">\mathcal{O}(N)</annotation><annotation encoding="application/x-llamapun" id="S3.F2.19.m9.1e">caligraphic_O ( italic_N )</annotation></semantics></math> topological masking.
Note that <math alttext="\widehat{\phi}_{\mathcal{G}}(v_{i})^{\top}\widehat{\phi}_{\mathcal{G}}(v_{j})" class="ltx_Math" display="inline" id="S3.F2.20.m10.2"><semantics id="S3.F2.20.m10.2b"><mrow id="S3.F2.20.m10.2.2" xref="S3.F2.20.m10.2.2.cmml"><msub id="S3.F2.20.m10.2.2.4" xref="S3.F2.20.m10.2.2.4.cmml"><mover accent="true" id="S3.F2.20.m10.2.2.4.2" xref="S3.F2.20.m10.2.2.4.2.cmml"><mi id="S3.F2.20.m10.2.2.4.2.2" xref="S3.F2.20.m10.2.2.4.2.2.cmml">ϕ</mi><mo id="S3.F2.20.m10.2.2.4.2.1" xref="S3.F2.20.m10.2.2.4.2.1.cmml">^</mo></mover><mi class="ltx_font_mathcaligraphic" id="S3.F2.20.m10.2.2.4.3" xref="S3.F2.20.m10.2.2.4.3.cmml">𝒢</mi></msub><mo id="S3.F2.20.m10.2.2.3" xref="S3.F2.20.m10.2.2.3.cmml">⁢</mo><msup id="S3.F2.20.m10.1.1.1" xref="S3.F2.20.m10.1.1.1.cmml"><mrow id="S3.F2.20.m10.1.1.1.1.1" xref="S3.F2.20.m10.1.1.1.1.1.1.cmml"><mo id="S3.F2.20.m10.1.1.1.1.1.2" stretchy="false" xref="S3.F2.20.m10.1.1.1.1.1.1.cmml">(</mo><msub id="S3.F2.20.m10.1.1.1.1.1.1" xref="S3.F2.20.m10.1.1.1.1.1.1.cmml"><mi id="S3.F2.20.m10.1.1.1.1.1.1.2" xref="S3.F2.20.m10.1.1.1.1.1.1.2.cmml">v</mi><mi id="S3.F2.20.m10.1.1.1.1.1.1.3" xref="S3.F2.20.m10.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.F2.20.m10.1.1.1.1.1.3" stretchy="false" xref="S3.F2.20.m10.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.F2.20.m10.1.1.1.3" xref="S3.F2.20.m10.1.1.1.3.cmml">⊤</mo></msup><mo id="S3.F2.20.m10.2.2.3b" xref="S3.F2.20.m10.2.2.3.cmml">⁢</mo><msub id="S3.F2.20.m10.2.2.5" xref="S3.F2.20.m10.2.2.5.cmml"><mover accent="true" id="S3.F2.20.m10.2.2.5.2" xref="S3.F2.20.m10.2.2.5.2.cmml"><mi id="S3.F2.20.m10.2.2.5.2.2" xref="S3.F2.20.m10.2.2.5.2.2.cmml">ϕ</mi><mo id="S3.F2.20.m10.2.2.5.2.1" xref="S3.F2.20.m10.2.2.5.2.1.cmml">^</mo></mover><mi class="ltx_font_mathcaligraphic" id="S3.F2.20.m10.2.2.5.3" xref="S3.F2.20.m10.2.2.5.3.cmml">𝒢</mi></msub><mo id="S3.F2.20.m10.2.2.3c" xref="S3.F2.20.m10.2.2.3.cmml">⁢</mo><mrow id="S3.F2.20.m10.2.2.2.1" xref="S3.F2.20.m10.2.2.2.1.1.cmml"><mo id="S3.F2.20.m10.2.2.2.1.2" stretchy="false" xref="S3.F2.20.m10.2.2.2.1.1.cmml">(</mo><msub id="S3.F2.20.m10.2.2.2.1.1" xref="S3.F2.20.m10.2.2.2.1.1.cmml"><mi id="S3.F2.20.m10.2.2.2.1.1.2" xref="S3.F2.20.m10.2.2.2.1.1.2.cmml">v</mi><mi id="S3.F2.20.m10.2.2.2.1.1.3" xref="S3.F2.20.m10.2.2.2.1.1.3.cmml">j</mi></msub><mo id="S3.F2.20.m10.2.2.2.1.3" stretchy="false" xref="S3.F2.20.m10.2.2.2.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.F2.20.m10.2c"><apply id="S3.F2.20.m10.2.2.cmml" xref="S3.F2.20.m10.2.2"><times id="S3.F2.20.m10.2.2.3.cmml" xref="S3.F2.20.m10.2.2.3"></times><apply id="S3.F2.20.m10.2.2.4.cmml" xref="S3.F2.20.m10.2.2.4"><csymbol cd="ambiguous" id="S3.F2.20.m10.2.2.4.1.cmml" xref="S3.F2.20.m10.2.2.4">subscript</csymbol><apply id="S3.F2.20.m10.2.2.4.2.cmml" xref="S3.F2.20.m10.2.2.4.2"><ci id="S3.F2.20.m10.2.2.4.2.1.cmml" xref="S3.F2.20.m10.2.2.4.2.1">^</ci><ci id="S3.F2.20.m10.2.2.4.2.2.cmml" xref="S3.F2.20.m10.2.2.4.2.2">italic-ϕ</ci></apply><ci id="S3.F2.20.m10.2.2.4.3.cmml" xref="S3.F2.20.m10.2.2.4.3">𝒢</ci></apply><apply id="S3.F2.20.m10.1.1.1.cmml" xref="S3.F2.20.m10.1.1.1"><csymbol cd="ambiguous" id="S3.F2.20.m10.1.1.1.2.cmml" xref="S3.F2.20.m10.1.1.1">superscript</csymbol><apply id="S3.F2.20.m10.1.1.1.1.1.1.cmml" xref="S3.F2.20.m10.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.F2.20.m10.1.1.1.1.1.1.1.cmml" xref="S3.F2.20.m10.1.1.1.1.1">subscript</csymbol><ci id="S3.F2.20.m10.1.1.1.1.1.1.2.cmml" xref="S3.F2.20.m10.1.1.1.1.1.1.2">𝑣</ci><ci id="S3.F2.20.m10.1.1.1.1.1.1.3.cmml" xref="S3.F2.20.m10.1.1.1.1.1.1.3">𝑖</ci></apply><csymbol cd="latexml" id="S3.F2.20.m10.1.1.1.3.cmml" xref="S3.F2.20.m10.1.1.1.3">top</csymbol></apply><apply id="S3.F2.20.m10.2.2.5.cmml" xref="S3.F2.20.m10.2.2.5"><csymbol cd="ambiguous" id="S3.F2.20.m10.2.2.5.1.cmml" xref="S3.F2.20.m10.2.2.5">subscript</csymbol><apply id="S3.F2.20.m10.2.2.5.2.cmml" xref="S3.F2.20.m10.2.2.5.2"><ci id="S3.F2.20.m10.2.2.5.2.1.cmml" xref="S3.F2.20.m10.2.2.5.2.1">^</ci><ci id="S3.F2.20.m10.2.2.5.2.2.cmml" xref="S3.F2.20.m10.2.2.5.2.2">italic-ϕ</ci></apply><ci id="S3.F2.20.m10.2.2.5.3.cmml" xref="S3.F2.20.m10.2.2.5.3">𝒢</ci></apply><apply id="S3.F2.20.m10.2.2.2.1.1.cmml" xref="S3.F2.20.m10.2.2.2.1"><csymbol cd="ambiguous" id="S3.F2.20.m10.2.2.2.1.1.1.cmml" xref="S3.F2.20.m10.2.2.2.1">subscript</csymbol><ci id="S3.F2.20.m10.2.2.2.1.1.2.cmml" xref="S3.F2.20.m10.2.2.2.1.1.2">𝑣</ci><ci id="S3.F2.20.m10.2.2.2.1.1.3.cmml" xref="S3.F2.20.m10.2.2.2.1.1.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.20.m10.2d">\widehat{\phi}_{\mathcal{G}}(v_{i})^{\top}\widehat{\phi}_{\mathcal{G}}(v_{j})</annotation><annotation encoding="application/x-llamapun" id="S3.F2.20.m10.2e">over^ start_ARG italic_ϕ end_ARG start_POSTSUBSCRIPT caligraphic_G end_POSTSUBSCRIPT ( italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT over^ start_ARG italic_ϕ end_ARG start_POSTSUBSCRIPT caligraphic_G end_POSTSUBSCRIPT ( italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT )</annotation></semantics></math> is only nonzero if the features are nonzero at some of the same coordinates, which happens if their respective ensembles of walks ‘hit’.
This incorporates a strong structural inductive bias.
The equations on the right formalise our method mathematically.
</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S3.SS5.p2">
<p class="ltx_p" id="S3.SS5.p2.5"><span class="ltx_text ltx_font_bold" id="S3.SS5.p2.5.1">Distributed computation, expressivity and GATs.</span>
Alg.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#alg1" title="Algorithm 1 ‣ 3.5 Algorithm and intuitive picture ‣ 3 Towards linear topological masking ‣ Linear Transformer Topological Masking with Graph Random Features"><span class="ltx_text ltx_ref_tag">1</span></a> is simple to distribute for massive graphs that cannot be stored on a single machine; to simulate random walks one only needs a node’s immediate neighbours rather than all of <math alttext="\mathcal{G}" class="ltx_Math" display="inline" id="S3.SS5.p2.1.m1.1"><semantics id="S3.SS5.p2.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS5.p2.1.m1.1.1" xref="S3.SS5.p2.1.m1.1.1.cmml">𝒢</mi><annotation-xml encoding="MathML-Content" id="S3.SS5.p2.1.m1.1b"><ci id="S3.SS5.p2.1.m1.1.1.cmml" xref="S3.SS5.p2.1.m1.1.1">𝒢</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p2.1.m1.1c">\mathcal{G}</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p2.1.m1.1d">caligraphic_G</annotation></semantics></math> upfront.
This desirable property is not shared by masking algorithms that rely on the fast Fourier transform <cite class="ltx_cite ltx_citemacro_citep">(Luo et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#bib.bib23" title="">2021</a>; Choromanski et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#bib.bib7" title="">2022</a>)</cite>.
Moreover, our method can distinguish graphs identical under the <math alttext="1" class="ltx_Math" display="inline" id="S3.SS5.p2.2.m2.1"><semantics id="S3.SS5.p2.2.m2.1a"><mn id="S3.SS5.p2.2.m2.1.1" xref="S3.SS5.p2.2.m2.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="S3.SS5.p2.2.m2.1b"><cn id="S3.SS5.p2.2.m2.1.1.cmml" type="integer" xref="S3.SS5.p2.2.m2.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p2.2.m2.1c">1</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p2.2.m2.1d">1</annotation></semantics></math>-dimensional Weisfeiler Lehman graph isomorphism heuristic (with colours replaced by node features) because their adjacency matrices and hence masks differ.
In this sense, GRF transformers are <em class="ltx_emph ltx_font_italic" id="S3.SS5.p2.5.2">more expressive than standard graph neural networks and unmasked transformers</em>, which notoriously fail this test <cite class="ltx_cite ltx_citemacro_citep">(Morris et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#bib.bib25" title="">2019</a>; Xu et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#bib.bib39" title="">2019</a>)</cite>.
Finally, we remark that our algorithm can be interpreted as a stochastic extension of graph attention networks <cite class="ltx_cite ltx_citemacro_citep">(GATs; Veličković et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#bib.bib36" title="">2018</a>)</cite>, with a greater focus on linear attention and scalability.
Tokens still attend to a subset of other tokens informed by the topology of <math alttext="\mathcal{G}" class="ltx_Math" display="inline" id="S3.SS5.p2.3.m3.1"><semantics id="S3.SS5.p2.3.m3.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS5.p2.3.m3.1.1" xref="S3.SS5.p2.3.m3.1.1.cmml">𝒢</mi><annotation-xml encoding="MathML-Content" id="S3.SS5.p2.3.m3.1b"><ci id="S3.SS5.p2.3.m3.1.1.cmml" xref="S3.SS5.p2.3.m3.1.1">𝒢</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p2.3.m3.1c">\mathcal{G}</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p2.3.m3.1d">caligraphic_G</annotation></semantics></math>, but importance sampling random walks permits interactions beyond nearest-neighbour.
Incorporating learnable parameters <math alttext="(f_{i})_{i=0}^{i_{\textrm{max}}}" class="ltx_Math" display="inline" id="S3.SS5.p2.4.m4.1"><semantics id="S3.SS5.p2.4.m4.1a"><msubsup id="S3.SS5.p2.4.m4.1.1" xref="S3.SS5.p2.4.m4.1.1.cmml"><mrow id="S3.SS5.p2.4.m4.1.1.1.1.1" xref="S3.SS5.p2.4.m4.1.1.1.1.1.1.cmml"><mo id="S3.SS5.p2.4.m4.1.1.1.1.1.2" stretchy="false" xref="S3.SS5.p2.4.m4.1.1.1.1.1.1.cmml">(</mo><msub id="S3.SS5.p2.4.m4.1.1.1.1.1.1" xref="S3.SS5.p2.4.m4.1.1.1.1.1.1.cmml"><mi id="S3.SS5.p2.4.m4.1.1.1.1.1.1.2" xref="S3.SS5.p2.4.m4.1.1.1.1.1.1.2.cmml">f</mi><mi id="S3.SS5.p2.4.m4.1.1.1.1.1.1.3" xref="S3.SS5.p2.4.m4.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS5.p2.4.m4.1.1.1.1.1.3" stretchy="false" xref="S3.SS5.p2.4.m4.1.1.1.1.1.1.cmml">)</mo></mrow><mrow id="S3.SS5.p2.4.m4.1.1.1.3" xref="S3.SS5.p2.4.m4.1.1.1.3.cmml"><mi id="S3.SS5.p2.4.m4.1.1.1.3.2" xref="S3.SS5.p2.4.m4.1.1.1.3.2.cmml">i</mi><mo id="S3.SS5.p2.4.m4.1.1.1.3.1" xref="S3.SS5.p2.4.m4.1.1.1.3.1.cmml">=</mo><mn id="S3.SS5.p2.4.m4.1.1.1.3.3" xref="S3.SS5.p2.4.m4.1.1.1.3.3.cmml">0</mn></mrow><msub id="S3.SS5.p2.4.m4.1.1.3" xref="S3.SS5.p2.4.m4.1.1.3.cmml"><mi id="S3.SS5.p2.4.m4.1.1.3.2" xref="S3.SS5.p2.4.m4.1.1.3.2.cmml">i</mi><mtext id="S3.SS5.p2.4.m4.1.1.3.3" xref="S3.SS5.p2.4.m4.1.1.3.3a.cmml">max</mtext></msub></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS5.p2.4.m4.1b"><apply id="S3.SS5.p2.4.m4.1.1.cmml" xref="S3.SS5.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS5.p2.4.m4.1.1.2.cmml" xref="S3.SS5.p2.4.m4.1.1">superscript</csymbol><apply id="S3.SS5.p2.4.m4.1.1.1.cmml" xref="S3.SS5.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS5.p2.4.m4.1.1.1.2.cmml" xref="S3.SS5.p2.4.m4.1.1">subscript</csymbol><apply id="S3.SS5.p2.4.m4.1.1.1.1.1.1.cmml" xref="S3.SS5.p2.4.m4.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS5.p2.4.m4.1.1.1.1.1.1.1.cmml" xref="S3.SS5.p2.4.m4.1.1.1.1.1">subscript</csymbol><ci id="S3.SS5.p2.4.m4.1.1.1.1.1.1.2.cmml" xref="S3.SS5.p2.4.m4.1.1.1.1.1.1.2">𝑓</ci><ci id="S3.SS5.p2.4.m4.1.1.1.1.1.1.3.cmml" xref="S3.SS5.p2.4.m4.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.SS5.p2.4.m4.1.1.1.3.cmml" xref="S3.SS5.p2.4.m4.1.1.1.3"><eq id="S3.SS5.p2.4.m4.1.1.1.3.1.cmml" xref="S3.SS5.p2.4.m4.1.1.1.3.1"></eq><ci id="S3.SS5.p2.4.m4.1.1.1.3.2.cmml" xref="S3.SS5.p2.4.m4.1.1.1.3.2">𝑖</ci><cn id="S3.SS5.p2.4.m4.1.1.1.3.3.cmml" type="integer" xref="S3.SS5.p2.4.m4.1.1.1.3.3">0</cn></apply></apply><apply id="S3.SS5.p2.4.m4.1.1.3.cmml" xref="S3.SS5.p2.4.m4.1.1.3"><csymbol cd="ambiguous" id="S3.SS5.p2.4.m4.1.1.3.1.cmml" xref="S3.SS5.p2.4.m4.1.1.3">subscript</csymbol><ci id="S3.SS5.p2.4.m4.1.1.3.2.cmml" xref="S3.SS5.p2.4.m4.1.1.3.2">𝑖</ci><ci id="S3.SS5.p2.4.m4.1.1.3.3a.cmml" xref="S3.SS5.p2.4.m4.1.1.3.3"><mtext id="S3.SS5.p2.4.m4.1.1.3.3.cmml" mathsize="50%" xref="S3.SS5.p2.4.m4.1.1.3.3">max</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p2.4.m4.1c">(f_{i})_{i=0}^{i_{\textrm{max}}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p2.4.m4.1d">( italic_f start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) start_POSTSUBSCRIPT italic_i = 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i start_POSTSUBSCRIPT max end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> lets us estimate a principled function of <math alttext="\mathbf{W}" class="ltx_Math" display="inline" id="S3.SS5.p2.5.m5.1"><semantics id="S3.SS5.p2.5.m5.1a"><mi id="S3.SS5.p2.5.m5.1.1" xref="S3.SS5.p2.5.m5.1.1.cmml">𝐖</mi><annotation-xml encoding="MathML-Content" id="S3.SS5.p2.5.m5.1b"><ci id="S3.SS5.p2.5.m5.1.1.cmml" xref="S3.SS5.p2.5.m5.1.1">𝐖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p2.5.m5.1c">\mathbf{W}</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p2.5.m5.1d">bold_W</annotation></semantics></math>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top" id="alg1">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="alg1.14.1.1">Algorithm 1</span> </span> <math alttext="\mathcal{O}(N)" class="ltx_Math" display="inline" id="alg1.2.m1.1"><semantics id="alg1.2.m1.1b"><mrow id="alg1.2.m1.1.2" xref="alg1.2.m1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.2.m1.1.2.2" xref="alg1.2.m1.1.2.2.cmml">𝒪</mi><mo id="alg1.2.m1.1.2.1" xref="alg1.2.m1.1.2.1.cmml">⁢</mo><mrow id="alg1.2.m1.1.2.3.2" xref="alg1.2.m1.1.2.cmml"><mo id="alg1.2.m1.1.2.3.2.1" stretchy="false" xref="alg1.2.m1.1.2.cmml">(</mo><mi id="alg1.2.m1.1.1" xref="alg1.2.m1.1.1.cmml">N</mi><mo id="alg1.2.m1.1.2.3.2.2" stretchy="false" xref="alg1.2.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.2.m1.1c"><apply id="alg1.2.m1.1.2.cmml" xref="alg1.2.m1.1.2"><times id="alg1.2.m1.1.2.1.cmml" xref="alg1.2.m1.1.2.1"></times><ci id="alg1.2.m1.1.2.2.cmml" xref="alg1.2.m1.1.2.2">𝒪</ci><ci id="alg1.2.m1.1.1.cmml" xref="alg1.2.m1.1.1">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.2.m1.1d">\mathcal{O}(N)</annotation><annotation encoding="application/x-llamapun" id="alg1.2.m1.1e">caligraphic_O ( italic_N )</annotation></semantics></math> topologically-masked attention for general graphs</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel" id="alg1.12"><span class="ltx_text ltx_font_bold" id="alg1.12.1">Input:</span> query matrix <math alttext="\mathbf{Q}\in\mathbb{R}^{N\times d}" class="ltx_Math" display="inline" id="alg1.3.m1.1"><semantics id="alg1.3.m1.1a"><mrow id="alg1.3.m1.1.1" xref="alg1.3.m1.1.1.cmml"><mi id="alg1.3.m1.1.1.2" xref="alg1.3.m1.1.1.2.cmml">𝐐</mi><mo id="alg1.3.m1.1.1.1" xref="alg1.3.m1.1.1.1.cmml">∈</mo><msup id="alg1.3.m1.1.1.3" xref="alg1.3.m1.1.1.3.cmml"><mi id="alg1.3.m1.1.1.3.2" xref="alg1.3.m1.1.1.3.2.cmml">ℝ</mi><mrow id="alg1.3.m1.1.1.3.3" xref="alg1.3.m1.1.1.3.3.cmml"><mi id="alg1.3.m1.1.1.3.3.2" xref="alg1.3.m1.1.1.3.3.2.cmml">N</mi><mo id="alg1.3.m1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="alg1.3.m1.1.1.3.3.1.cmml">×</mo><mi id="alg1.3.m1.1.1.3.3.3" xref="alg1.3.m1.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="alg1.3.m1.1b"><apply id="alg1.3.m1.1.1.cmml" xref="alg1.3.m1.1.1"><in id="alg1.3.m1.1.1.1.cmml" xref="alg1.3.m1.1.1.1"></in><ci id="alg1.3.m1.1.1.2.cmml" xref="alg1.3.m1.1.1.2">𝐐</ci><apply id="alg1.3.m1.1.1.3.cmml" xref="alg1.3.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.3.m1.1.1.3.1.cmml" xref="alg1.3.m1.1.1.3">superscript</csymbol><ci id="alg1.3.m1.1.1.3.2.cmml" xref="alg1.3.m1.1.1.3.2">ℝ</ci><apply id="alg1.3.m1.1.1.3.3.cmml" xref="alg1.3.m1.1.1.3.3"><times id="alg1.3.m1.1.1.3.3.1.cmml" xref="alg1.3.m1.1.1.3.3.1"></times><ci id="alg1.3.m1.1.1.3.3.2.cmml" xref="alg1.3.m1.1.1.3.3.2">𝑁</ci><ci id="alg1.3.m1.1.1.3.3.3.cmml" xref="alg1.3.m1.1.1.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.3.m1.1c">\mathbf{Q}\in\mathbb{R}^{N\times d}</annotation><annotation encoding="application/x-llamapun" id="alg1.3.m1.1d">bold_Q ∈ blackboard_R start_POSTSUPERSCRIPT italic_N × italic_d end_POSTSUPERSCRIPT</annotation></semantics></math>, key matrix <math alttext="\mathbf{K}\in\mathbb{R}^{N\times d}" class="ltx_Math" display="inline" id="alg1.4.m2.1"><semantics id="alg1.4.m2.1a"><mrow id="alg1.4.m2.1.1" xref="alg1.4.m2.1.1.cmml"><mi id="alg1.4.m2.1.1.2" xref="alg1.4.m2.1.1.2.cmml">𝐊</mi><mo id="alg1.4.m2.1.1.1" xref="alg1.4.m2.1.1.1.cmml">∈</mo><msup id="alg1.4.m2.1.1.3" xref="alg1.4.m2.1.1.3.cmml"><mi id="alg1.4.m2.1.1.3.2" xref="alg1.4.m2.1.1.3.2.cmml">ℝ</mi><mrow id="alg1.4.m2.1.1.3.3" xref="alg1.4.m2.1.1.3.3.cmml"><mi id="alg1.4.m2.1.1.3.3.2" xref="alg1.4.m2.1.1.3.3.2.cmml">N</mi><mo id="alg1.4.m2.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="alg1.4.m2.1.1.3.3.1.cmml">×</mo><mi id="alg1.4.m2.1.1.3.3.3" xref="alg1.4.m2.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="alg1.4.m2.1b"><apply id="alg1.4.m2.1.1.cmml" xref="alg1.4.m2.1.1"><in id="alg1.4.m2.1.1.1.cmml" xref="alg1.4.m2.1.1.1"></in><ci id="alg1.4.m2.1.1.2.cmml" xref="alg1.4.m2.1.1.2">𝐊</ci><apply id="alg1.4.m2.1.1.3.cmml" xref="alg1.4.m2.1.1.3"><csymbol cd="ambiguous" id="alg1.4.m2.1.1.3.1.cmml" xref="alg1.4.m2.1.1.3">superscript</csymbol><ci id="alg1.4.m2.1.1.3.2.cmml" xref="alg1.4.m2.1.1.3.2">ℝ</ci><apply id="alg1.4.m2.1.1.3.3.cmml" xref="alg1.4.m2.1.1.3.3"><times id="alg1.4.m2.1.1.3.3.1.cmml" xref="alg1.4.m2.1.1.3.3.1"></times><ci id="alg1.4.m2.1.1.3.3.2.cmml" xref="alg1.4.m2.1.1.3.3.2">𝑁</ci><ci id="alg1.4.m2.1.1.3.3.3.cmml" xref="alg1.4.m2.1.1.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.4.m2.1c">\mathbf{K}\in\mathbb{R}^{N\times d}</annotation><annotation encoding="application/x-llamapun" id="alg1.4.m2.1d">bold_K ∈ blackboard_R start_POSTSUPERSCRIPT italic_N × italic_d end_POSTSUPERSCRIPT</annotation></semantics></math>, value matrix <math alttext="\mathbf{V}\in\mathbb{R}^{N\times d}" class="ltx_Math" display="inline" id="alg1.5.m3.1"><semantics id="alg1.5.m3.1a"><mrow id="alg1.5.m3.1.1" xref="alg1.5.m3.1.1.cmml"><mi id="alg1.5.m3.1.1.2" xref="alg1.5.m3.1.1.2.cmml">𝐕</mi><mo id="alg1.5.m3.1.1.1" xref="alg1.5.m3.1.1.1.cmml">∈</mo><msup id="alg1.5.m3.1.1.3" xref="alg1.5.m3.1.1.3.cmml"><mi id="alg1.5.m3.1.1.3.2" xref="alg1.5.m3.1.1.3.2.cmml">ℝ</mi><mrow id="alg1.5.m3.1.1.3.3" xref="alg1.5.m3.1.1.3.3.cmml"><mi id="alg1.5.m3.1.1.3.3.2" xref="alg1.5.m3.1.1.3.3.2.cmml">N</mi><mo id="alg1.5.m3.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="alg1.5.m3.1.1.3.3.1.cmml">×</mo><mi id="alg1.5.m3.1.1.3.3.3" xref="alg1.5.m3.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="alg1.5.m3.1b"><apply id="alg1.5.m3.1.1.cmml" xref="alg1.5.m3.1.1"><in id="alg1.5.m3.1.1.1.cmml" xref="alg1.5.m3.1.1.1"></in><ci id="alg1.5.m3.1.1.2.cmml" xref="alg1.5.m3.1.1.2">𝐕</ci><apply id="alg1.5.m3.1.1.3.cmml" xref="alg1.5.m3.1.1.3"><csymbol cd="ambiguous" id="alg1.5.m3.1.1.3.1.cmml" xref="alg1.5.m3.1.1.3">superscript</csymbol><ci id="alg1.5.m3.1.1.3.2.cmml" xref="alg1.5.m3.1.1.3.2">ℝ</ci><apply id="alg1.5.m3.1.1.3.3.cmml" xref="alg1.5.m3.1.1.3.3"><times id="alg1.5.m3.1.1.3.3.1.cmml" xref="alg1.5.m3.1.1.3.3.1"></times><ci id="alg1.5.m3.1.1.3.3.2.cmml" xref="alg1.5.m3.1.1.3.3.2">𝑁</ci><ci id="alg1.5.m3.1.1.3.3.3.cmml" xref="alg1.5.m3.1.1.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.5.m3.1c">\mathbf{V}\in\mathbb{R}^{N\times d}</annotation><annotation encoding="application/x-llamapun" id="alg1.5.m3.1d">bold_V ∈ blackboard_R start_POSTSUPERSCRIPT italic_N × italic_d end_POSTSUPERSCRIPT</annotation></semantics></math>, graph <math alttext="\mathcal{G}" class="ltx_Math" display="inline" id="alg1.6.m4.1"><semantics id="alg1.6.m4.1a"><mi class="ltx_font_mathcaligraphic" id="alg1.6.m4.1.1" xref="alg1.6.m4.1.1.cmml">𝒢</mi><annotation-xml encoding="MathML-Content" id="alg1.6.m4.1b"><ci id="alg1.6.m4.1.1.cmml" xref="alg1.6.m4.1.1">𝒢</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.6.m4.1c">\mathcal{G}</annotation><annotation encoding="application/x-llamapun" id="alg1.6.m4.1d">caligraphic_G</annotation></semantics></math> with weighted adjacency matrix <math alttext="\mathbf{W}\in\mathbb{R}^{N\times N}" class="ltx_Math" display="inline" id="alg1.7.m5.1"><semantics id="alg1.7.m5.1a"><mrow id="alg1.7.m5.1.1" xref="alg1.7.m5.1.1.cmml"><mi id="alg1.7.m5.1.1.2" xref="alg1.7.m5.1.1.2.cmml">𝐖</mi><mo id="alg1.7.m5.1.1.1" xref="alg1.7.m5.1.1.1.cmml">∈</mo><msup id="alg1.7.m5.1.1.3" xref="alg1.7.m5.1.1.3.cmml"><mi id="alg1.7.m5.1.1.3.2" xref="alg1.7.m5.1.1.3.2.cmml">ℝ</mi><mrow id="alg1.7.m5.1.1.3.3" xref="alg1.7.m5.1.1.3.3.cmml"><mi id="alg1.7.m5.1.1.3.3.2" xref="alg1.7.m5.1.1.3.3.2.cmml">N</mi><mo id="alg1.7.m5.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="alg1.7.m5.1.1.3.3.1.cmml">×</mo><mi id="alg1.7.m5.1.1.3.3.3" xref="alg1.7.m5.1.1.3.3.3.cmml">N</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="alg1.7.m5.1b"><apply id="alg1.7.m5.1.1.cmml" xref="alg1.7.m5.1.1"><in id="alg1.7.m5.1.1.1.cmml" xref="alg1.7.m5.1.1.1"></in><ci id="alg1.7.m5.1.1.2.cmml" xref="alg1.7.m5.1.1.2">𝐖</ci><apply id="alg1.7.m5.1.1.3.cmml" xref="alg1.7.m5.1.1.3"><csymbol cd="ambiguous" id="alg1.7.m5.1.1.3.1.cmml" xref="alg1.7.m5.1.1.3">superscript</csymbol><ci id="alg1.7.m5.1.1.3.2.cmml" xref="alg1.7.m5.1.1.3.2">ℝ</ci><apply id="alg1.7.m5.1.1.3.3.cmml" xref="alg1.7.m5.1.1.3.3"><times id="alg1.7.m5.1.1.3.3.1.cmml" xref="alg1.7.m5.1.1.3.3.1"></times><ci id="alg1.7.m5.1.1.3.3.2.cmml" xref="alg1.7.m5.1.1.3.3.2">𝑁</ci><ci id="alg1.7.m5.1.1.3.3.3.cmml" xref="alg1.7.m5.1.1.3.3.3">𝑁</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.7.m5.1c">\mathbf{W}\in\mathbb{R}^{N\times N}</annotation><annotation encoding="application/x-llamapun" id="alg1.7.m5.1d">bold_W ∈ blackboard_R start_POSTSUPERSCRIPT italic_N × italic_N end_POSTSUPERSCRIPT</annotation></semantics></math>, learnable mask parameters <math alttext="(f_{i})_{i=0}^{i_{\textrm{max}}}" class="ltx_Math" display="inline" id="alg1.8.m6.1"><semantics id="alg1.8.m6.1a"><msubsup id="alg1.8.m6.1.1" xref="alg1.8.m6.1.1.cmml"><mrow id="alg1.8.m6.1.1.1.1.1" xref="alg1.8.m6.1.1.1.1.1.1.cmml"><mo id="alg1.8.m6.1.1.1.1.1.2" stretchy="false" xref="alg1.8.m6.1.1.1.1.1.1.cmml">(</mo><msub id="alg1.8.m6.1.1.1.1.1.1" xref="alg1.8.m6.1.1.1.1.1.1.cmml"><mi id="alg1.8.m6.1.1.1.1.1.1.2" xref="alg1.8.m6.1.1.1.1.1.1.2.cmml">f</mi><mi id="alg1.8.m6.1.1.1.1.1.1.3" xref="alg1.8.m6.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="alg1.8.m6.1.1.1.1.1.3" stretchy="false" xref="alg1.8.m6.1.1.1.1.1.1.cmml">)</mo></mrow><mrow id="alg1.8.m6.1.1.1.3" xref="alg1.8.m6.1.1.1.3.cmml"><mi id="alg1.8.m6.1.1.1.3.2" xref="alg1.8.m6.1.1.1.3.2.cmml">i</mi><mo id="alg1.8.m6.1.1.1.3.1" xref="alg1.8.m6.1.1.1.3.1.cmml">=</mo><mn id="alg1.8.m6.1.1.1.3.3" xref="alg1.8.m6.1.1.1.3.3.cmml">0</mn></mrow><msub id="alg1.8.m6.1.1.3" xref="alg1.8.m6.1.1.3.cmml"><mi id="alg1.8.m6.1.1.3.2" xref="alg1.8.m6.1.1.3.2.cmml">i</mi><mtext id="alg1.8.m6.1.1.3.3" xref="alg1.8.m6.1.1.3.3a.cmml">max</mtext></msub></msubsup><annotation-xml encoding="MathML-Content" id="alg1.8.m6.1b"><apply id="alg1.8.m6.1.1.cmml" xref="alg1.8.m6.1.1"><csymbol cd="ambiguous" id="alg1.8.m6.1.1.2.cmml" xref="alg1.8.m6.1.1">superscript</csymbol><apply id="alg1.8.m6.1.1.1.cmml" xref="alg1.8.m6.1.1"><csymbol cd="ambiguous" id="alg1.8.m6.1.1.1.2.cmml" xref="alg1.8.m6.1.1">subscript</csymbol><apply id="alg1.8.m6.1.1.1.1.1.1.cmml" xref="alg1.8.m6.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.8.m6.1.1.1.1.1.1.1.cmml" xref="alg1.8.m6.1.1.1.1.1">subscript</csymbol><ci id="alg1.8.m6.1.1.1.1.1.1.2.cmml" xref="alg1.8.m6.1.1.1.1.1.1.2">𝑓</ci><ci id="alg1.8.m6.1.1.1.1.1.1.3.cmml" xref="alg1.8.m6.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="alg1.8.m6.1.1.1.3.cmml" xref="alg1.8.m6.1.1.1.3"><eq id="alg1.8.m6.1.1.1.3.1.cmml" xref="alg1.8.m6.1.1.1.3.1"></eq><ci id="alg1.8.m6.1.1.1.3.2.cmml" xref="alg1.8.m6.1.1.1.3.2">𝑖</ci><cn id="alg1.8.m6.1.1.1.3.3.cmml" type="integer" xref="alg1.8.m6.1.1.1.3.3">0</cn></apply></apply><apply id="alg1.8.m6.1.1.3.cmml" xref="alg1.8.m6.1.1.3"><csymbol cd="ambiguous" id="alg1.8.m6.1.1.3.1.cmml" xref="alg1.8.m6.1.1.3">subscript</csymbol><ci id="alg1.8.m6.1.1.3.2.cmml" xref="alg1.8.m6.1.1.3.2">𝑖</ci><ci id="alg1.8.m6.1.1.3.3a.cmml" xref="alg1.8.m6.1.1.3.3"><mtext id="alg1.8.m6.1.1.3.3.cmml" mathsize="50%" xref="alg1.8.m6.1.1.3.3">max</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.8.m6.1c">(f_{i})_{i=0}^{i_{\textrm{max}}}</annotation><annotation encoding="application/x-llamapun" id="alg1.8.m6.1d">( italic_f start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) start_POSTSUBSCRIPT italic_i = 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i start_POSTSUBSCRIPT max end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>, number of random walks to sample <math alttext="n\in\mathbb{N}" class="ltx_Math" display="inline" id="alg1.9.m7.1"><semantics id="alg1.9.m7.1a"><mrow id="alg1.9.m7.1.1" xref="alg1.9.m7.1.1.cmml"><mi id="alg1.9.m7.1.1.2" xref="alg1.9.m7.1.1.2.cmml">n</mi><mo id="alg1.9.m7.1.1.1" xref="alg1.9.m7.1.1.1.cmml">∈</mo><mi id="alg1.9.m7.1.1.3" xref="alg1.9.m7.1.1.3.cmml">ℕ</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.9.m7.1b"><apply id="alg1.9.m7.1.1.cmml" xref="alg1.9.m7.1.1"><in id="alg1.9.m7.1.1.1.cmml" xref="alg1.9.m7.1.1.1"></in><ci id="alg1.9.m7.1.1.2.cmml" xref="alg1.9.m7.1.1.2">𝑛</ci><ci id="alg1.9.m7.1.1.3.cmml" xref="alg1.9.m7.1.1.3">ℕ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.9.m7.1c">n\in\mathbb{N}</annotation><annotation encoding="application/x-llamapun" id="alg1.9.m7.1d">italic_n ∈ blackboard_N</annotation></semantics></math>, query/key feature map <math alttext="\phi(\cdot):\mathbb{R}^{d}\to\mathbb{R}^{m}" class="ltx_Math" display="inline" id="alg1.10.m8.1"><semantics id="alg1.10.m8.1a"><mrow id="alg1.10.m8.1.2" xref="alg1.10.m8.1.2.cmml"><mrow id="alg1.10.m8.1.2.2" xref="alg1.10.m8.1.2.2.cmml"><mi id="alg1.10.m8.1.2.2.2" xref="alg1.10.m8.1.2.2.2.cmml">ϕ</mi><mo id="alg1.10.m8.1.2.2.1" xref="alg1.10.m8.1.2.2.1.cmml">⁢</mo><mrow id="alg1.10.m8.1.2.2.3.2" xref="alg1.10.m8.1.2.2.cmml"><mo id="alg1.10.m8.1.2.2.3.2.1" stretchy="false" xref="alg1.10.m8.1.2.2.cmml">(</mo><mo id="alg1.10.m8.1.1" lspace="0em" rspace="0em" xref="alg1.10.m8.1.1.cmml">⋅</mo><mo id="alg1.10.m8.1.2.2.3.2.2" rspace="0.278em" stretchy="false" xref="alg1.10.m8.1.2.2.cmml">)</mo></mrow></mrow><mo id="alg1.10.m8.1.2.1" rspace="0.278em" xref="alg1.10.m8.1.2.1.cmml">:</mo><mrow id="alg1.10.m8.1.2.3" xref="alg1.10.m8.1.2.3.cmml"><msup id="alg1.10.m8.1.2.3.2" xref="alg1.10.m8.1.2.3.2.cmml"><mi id="alg1.10.m8.1.2.3.2.2" xref="alg1.10.m8.1.2.3.2.2.cmml">ℝ</mi><mi id="alg1.10.m8.1.2.3.2.3" xref="alg1.10.m8.1.2.3.2.3.cmml">d</mi></msup><mo id="alg1.10.m8.1.2.3.1" stretchy="false" xref="alg1.10.m8.1.2.3.1.cmml">→</mo><msup id="alg1.10.m8.1.2.3.3" xref="alg1.10.m8.1.2.3.3.cmml"><mi id="alg1.10.m8.1.2.3.3.2" xref="alg1.10.m8.1.2.3.3.2.cmml">ℝ</mi><mi id="alg1.10.m8.1.2.3.3.3" xref="alg1.10.m8.1.2.3.3.3.cmml">m</mi></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.10.m8.1b"><apply id="alg1.10.m8.1.2.cmml" xref="alg1.10.m8.1.2"><ci id="alg1.10.m8.1.2.1.cmml" xref="alg1.10.m8.1.2.1">:</ci><apply id="alg1.10.m8.1.2.2.cmml" xref="alg1.10.m8.1.2.2"><times id="alg1.10.m8.1.2.2.1.cmml" xref="alg1.10.m8.1.2.2.1"></times><ci id="alg1.10.m8.1.2.2.2.cmml" xref="alg1.10.m8.1.2.2.2">italic-ϕ</ci><ci id="alg1.10.m8.1.1.cmml" xref="alg1.10.m8.1.1">⋅</ci></apply><apply id="alg1.10.m8.1.2.3.cmml" xref="alg1.10.m8.1.2.3"><ci id="alg1.10.m8.1.2.3.1.cmml" xref="alg1.10.m8.1.2.3.1">→</ci><apply id="alg1.10.m8.1.2.3.2.cmml" xref="alg1.10.m8.1.2.3.2"><csymbol cd="ambiguous" id="alg1.10.m8.1.2.3.2.1.cmml" xref="alg1.10.m8.1.2.3.2">superscript</csymbol><ci id="alg1.10.m8.1.2.3.2.2.cmml" xref="alg1.10.m8.1.2.3.2.2">ℝ</ci><ci id="alg1.10.m8.1.2.3.2.3.cmml" xref="alg1.10.m8.1.2.3.2.3">𝑑</ci></apply><apply id="alg1.10.m8.1.2.3.3.cmml" xref="alg1.10.m8.1.2.3.3"><csymbol cd="ambiguous" id="alg1.10.m8.1.2.3.3.1.cmml" xref="alg1.10.m8.1.2.3.3">superscript</csymbol><ci id="alg1.10.m8.1.2.3.3.2.cmml" xref="alg1.10.m8.1.2.3.3.2">ℝ</ci><ci id="alg1.10.m8.1.2.3.3.3.cmml" xref="alg1.10.m8.1.2.3.3.3">𝑚</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.10.m8.1c">\phi(\cdot):\mathbb{R}^{d}\to\mathbb{R}^{m}</annotation><annotation encoding="application/x-llamapun" id="alg1.10.m8.1d">italic_ϕ ( ⋅ ) : blackboard_R start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT → blackboard_R start_POSTSUPERSCRIPT italic_m end_POSTSUPERSCRIPT</annotation></semantics></math>. 
<br class="ltx_break"><span class="ltx_text ltx_font_bold" id="alg1.12.2">Output:</span> masked attention <math alttext="\textrm{Att}_{\textrm{LR},\widehat{\mathbf{M}}}(\mathbf{Q},\mathbf{K},\mathbf{%
V},\mathcal{G})" class="ltx_Math" display="inline" id="alg1.11.m9.6"><semantics id="alg1.11.m9.6a"><mrow id="alg1.11.m9.6.7" xref="alg1.11.m9.6.7.cmml"><msub id="alg1.11.m9.6.7.2" xref="alg1.11.m9.6.7.2.cmml"><mtext id="alg1.11.m9.6.7.2.2" xref="alg1.11.m9.6.7.2.2a.cmml">Att</mtext><mrow id="alg1.11.m9.2.2.2.4" xref="alg1.11.m9.2.2.2.3.cmml"><mtext id="alg1.11.m9.1.1.1.1" xref="alg1.11.m9.1.1.1.1a.cmml">LR</mtext><mo id="alg1.11.m9.2.2.2.4.1" xref="alg1.11.m9.2.2.2.3.cmml">,</mo><mover accent="true" id="alg1.11.m9.2.2.2.2" xref="alg1.11.m9.2.2.2.2.cmml"><mi id="alg1.11.m9.2.2.2.2.2" xref="alg1.11.m9.2.2.2.2.2.cmml">𝐌</mi><mo id="alg1.11.m9.2.2.2.2.1" xref="alg1.11.m9.2.2.2.2.1.cmml">^</mo></mover></mrow></msub><mo id="alg1.11.m9.6.7.1" xref="alg1.11.m9.6.7.1.cmml">⁢</mo><mrow id="alg1.11.m9.6.7.3.2" xref="alg1.11.m9.6.7.3.1.cmml"><mo id="alg1.11.m9.6.7.3.2.1" stretchy="false" xref="alg1.11.m9.6.7.3.1.cmml">(</mo><mi id="alg1.11.m9.3.3" xref="alg1.11.m9.3.3.cmml">𝐐</mi><mo id="alg1.11.m9.6.7.3.2.2" xref="alg1.11.m9.6.7.3.1.cmml">,</mo><mi id="alg1.11.m9.4.4" xref="alg1.11.m9.4.4.cmml">𝐊</mi><mo id="alg1.11.m9.6.7.3.2.3" xref="alg1.11.m9.6.7.3.1.cmml">,</mo><mi id="alg1.11.m9.5.5" xref="alg1.11.m9.5.5.cmml">𝐕</mi><mo id="alg1.11.m9.6.7.3.2.4" xref="alg1.11.m9.6.7.3.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="alg1.11.m9.6.6" xref="alg1.11.m9.6.6.cmml">𝒢</mi><mo id="alg1.11.m9.6.7.3.2.5" stretchy="false" xref="alg1.11.m9.6.7.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.11.m9.6b"><apply id="alg1.11.m9.6.7.cmml" xref="alg1.11.m9.6.7"><times id="alg1.11.m9.6.7.1.cmml" xref="alg1.11.m9.6.7.1"></times><apply id="alg1.11.m9.6.7.2.cmml" xref="alg1.11.m9.6.7.2"><csymbol cd="ambiguous" id="alg1.11.m9.6.7.2.1.cmml" xref="alg1.11.m9.6.7.2">subscript</csymbol><ci id="alg1.11.m9.6.7.2.2a.cmml" xref="alg1.11.m9.6.7.2.2"><mtext id="alg1.11.m9.6.7.2.2.cmml" xref="alg1.11.m9.6.7.2.2">Att</mtext></ci><list id="alg1.11.m9.2.2.2.3.cmml" xref="alg1.11.m9.2.2.2.4"><ci id="alg1.11.m9.1.1.1.1a.cmml" xref="alg1.11.m9.1.1.1.1"><mtext id="alg1.11.m9.1.1.1.1.cmml" mathsize="70%" xref="alg1.11.m9.1.1.1.1">LR</mtext></ci><apply id="alg1.11.m9.2.2.2.2.cmml" xref="alg1.11.m9.2.2.2.2"><ci id="alg1.11.m9.2.2.2.2.1.cmml" xref="alg1.11.m9.2.2.2.2.1">^</ci><ci id="alg1.11.m9.2.2.2.2.2.cmml" xref="alg1.11.m9.2.2.2.2.2">𝐌</ci></apply></list></apply><vector id="alg1.11.m9.6.7.3.1.cmml" xref="alg1.11.m9.6.7.3.2"><ci id="alg1.11.m9.3.3.cmml" xref="alg1.11.m9.3.3">𝐐</ci><ci id="alg1.11.m9.4.4.cmml" xref="alg1.11.m9.4.4">𝐊</ci><ci id="alg1.11.m9.5.5.cmml" xref="alg1.11.m9.5.5">𝐕</ci><ci id="alg1.11.m9.6.6.cmml" xref="alg1.11.m9.6.6">𝒢</ci></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.11.m9.6c">\textrm{Att}_{\textrm{LR},\widehat{\mathbf{M}}}(\mathbf{Q},\mathbf{K},\mathbf{%
V},\mathcal{G})</annotation><annotation encoding="application/x-llamapun" id="alg1.11.m9.6d">Att start_POSTSUBSCRIPT LR , over^ start_ARG bold_M end_ARG end_POSTSUBSCRIPT ( bold_Q , bold_K , bold_V , caligraphic_G )</annotation></semantics></math> in <math alttext="\mathcal{O}(N)" class="ltx_Math" display="inline" id="alg1.12.m10.1"><semantics id="alg1.12.m10.1a"><mrow id="alg1.12.m10.1.2" xref="alg1.12.m10.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.12.m10.1.2.2" xref="alg1.12.m10.1.2.2.cmml">𝒪</mi><mo id="alg1.12.m10.1.2.1" xref="alg1.12.m10.1.2.1.cmml">⁢</mo><mrow id="alg1.12.m10.1.2.3.2" xref="alg1.12.m10.1.2.cmml"><mo id="alg1.12.m10.1.2.3.2.1" stretchy="false" xref="alg1.12.m10.1.2.cmml">(</mo><mi id="alg1.12.m10.1.1" xref="alg1.12.m10.1.1.cmml">N</mi><mo id="alg1.12.m10.1.2.3.2.2" stretchy="false" xref="alg1.12.m10.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.12.m10.1b"><apply id="alg1.12.m10.1.2.cmml" xref="alg1.12.m10.1.2"><times id="alg1.12.m10.1.2.1.cmml" xref="alg1.12.m10.1.2.1"></times><ci id="alg1.12.m10.1.2.2.cmml" xref="alg1.12.m10.1.2.2">𝒪</ci><ci id="alg1.12.m10.1.1.cmml" xref="alg1.12.m10.1.1">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.12.m10.1c">\mathcal{O}(N)</annotation><annotation encoding="application/x-llamapun" id="alg1.12.m10.1d">caligraphic_O ( italic_N )</annotation></semantics></math> time.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<div class="ltx_listing ltx_figure_panel ltx_listing" id="alg1.15">
<div class="ltx_listingline" id="alg1.l1">
<span class="ltx_tag ltx_tag_listingline">1:</span><em class="ltx_emph ltx_font_italic" id="alg1.l1.1">Simulate</em> <math alttext="n" class="ltx_Math" display="inline" id="alg1.l1.m1.1"><semantics id="alg1.l1.m1.1a"><mi id="alg1.l1.m1.1.1" xref="alg1.l1.m1.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m1.1b"><ci id="alg1.l1.m1.1.1.cmml" xref="alg1.l1.m1.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m1.1c">n</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m1.1d">italic_n</annotation></semantics></math> terminating random walks <math alttext="\{\omega_{k}^{(i)}\}_{k=1}^{n}" class="ltx_Math" display="inline" id="alg1.l1.m2.2"><semantics id="alg1.l1.m2.2a"><msubsup id="alg1.l1.m2.2.2" xref="alg1.l1.m2.2.2.cmml"><mrow id="alg1.l1.m2.2.2.1.1.1" xref="alg1.l1.m2.2.2.1.1.2.cmml"><mo id="alg1.l1.m2.2.2.1.1.1.2" stretchy="false" xref="alg1.l1.m2.2.2.1.1.2.cmml">{</mo><msubsup id="alg1.l1.m2.2.2.1.1.1.1" xref="alg1.l1.m2.2.2.1.1.1.1.cmml"><mi id="alg1.l1.m2.2.2.1.1.1.1.2.2" xref="alg1.l1.m2.2.2.1.1.1.1.2.2.cmml">ω</mi><mi id="alg1.l1.m2.2.2.1.1.1.1.2.3" xref="alg1.l1.m2.2.2.1.1.1.1.2.3.cmml">k</mi><mrow id="alg1.l1.m2.1.1.1.3" xref="alg1.l1.m2.2.2.1.1.1.1.cmml"><mo id="alg1.l1.m2.1.1.1.3.1" stretchy="false" xref="alg1.l1.m2.2.2.1.1.1.1.cmml">(</mo><mi id="alg1.l1.m2.1.1.1.1" xref="alg1.l1.m2.1.1.1.1.cmml">i</mi><mo id="alg1.l1.m2.1.1.1.3.2" stretchy="false" xref="alg1.l1.m2.2.2.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="alg1.l1.m2.2.2.1.1.1.3" stretchy="false" xref="alg1.l1.m2.2.2.1.1.2.cmml">}</mo></mrow><mrow id="alg1.l1.m2.2.2.1.3" xref="alg1.l1.m2.2.2.1.3.cmml"><mi id="alg1.l1.m2.2.2.1.3.2" xref="alg1.l1.m2.2.2.1.3.2.cmml">k</mi><mo id="alg1.l1.m2.2.2.1.3.1" xref="alg1.l1.m2.2.2.1.3.1.cmml">=</mo><mn id="alg1.l1.m2.2.2.1.3.3" xref="alg1.l1.m2.2.2.1.3.3.cmml">1</mn></mrow><mi id="alg1.l1.m2.2.2.3" xref="alg1.l1.m2.2.2.3.cmml">n</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l1.m2.2b"><apply id="alg1.l1.m2.2.2.cmml" xref="alg1.l1.m2.2.2"><csymbol cd="ambiguous" id="alg1.l1.m2.2.2.2.cmml" xref="alg1.l1.m2.2.2">superscript</csymbol><apply id="alg1.l1.m2.2.2.1.cmml" xref="alg1.l1.m2.2.2"><csymbol cd="ambiguous" id="alg1.l1.m2.2.2.1.2.cmml" xref="alg1.l1.m2.2.2">subscript</csymbol><set id="alg1.l1.m2.2.2.1.1.2.cmml" xref="alg1.l1.m2.2.2.1.1.1"><apply id="alg1.l1.m2.2.2.1.1.1.1.cmml" xref="alg1.l1.m2.2.2.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l1.m2.2.2.1.1.1.1.1.cmml" xref="alg1.l1.m2.2.2.1.1.1.1">superscript</csymbol><apply id="alg1.l1.m2.2.2.1.1.1.1.2.cmml" xref="alg1.l1.m2.2.2.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l1.m2.2.2.1.1.1.1.2.1.cmml" xref="alg1.l1.m2.2.2.1.1.1.1">subscript</csymbol><ci id="alg1.l1.m2.2.2.1.1.1.1.2.2.cmml" xref="alg1.l1.m2.2.2.1.1.1.1.2.2">𝜔</ci><ci id="alg1.l1.m2.2.2.1.1.1.1.2.3.cmml" xref="alg1.l1.m2.2.2.1.1.1.1.2.3">𝑘</ci></apply><ci id="alg1.l1.m2.1.1.1.1.cmml" xref="alg1.l1.m2.1.1.1.1">𝑖</ci></apply></set><apply id="alg1.l1.m2.2.2.1.3.cmml" xref="alg1.l1.m2.2.2.1.3"><eq id="alg1.l1.m2.2.2.1.3.1.cmml" xref="alg1.l1.m2.2.2.1.3.1"></eq><ci id="alg1.l1.m2.2.2.1.3.2.cmml" xref="alg1.l1.m2.2.2.1.3.2">𝑘</ci><cn id="alg1.l1.m2.2.2.1.3.3.cmml" type="integer" xref="alg1.l1.m2.2.2.1.3.3">1</cn></apply></apply><ci id="alg1.l1.m2.2.2.3.cmml" xref="alg1.l1.m2.2.2.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m2.2c">\{\omega_{k}^{(i)}\}_{k=1}^{n}</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m2.2d">{ italic_ω start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT } start_POSTSUBSCRIPT italic_k = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT</annotation></semantics></math> out of every node <math alttext="v_{i}\in\mathcal{N}" class="ltx_Math" display="inline" id="alg1.l1.m3.1"><semantics id="alg1.l1.m3.1a"><mrow id="alg1.l1.m3.1.1" xref="alg1.l1.m3.1.1.cmml"><msub id="alg1.l1.m3.1.1.2" xref="alg1.l1.m3.1.1.2.cmml"><mi id="alg1.l1.m3.1.1.2.2" xref="alg1.l1.m3.1.1.2.2.cmml">v</mi><mi id="alg1.l1.m3.1.1.2.3" xref="alg1.l1.m3.1.1.2.3.cmml">i</mi></msub><mo id="alg1.l1.m3.1.1.1" xref="alg1.l1.m3.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="alg1.l1.m3.1.1.3" xref="alg1.l1.m3.1.1.3.cmml">𝒩</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l1.m3.1b"><apply id="alg1.l1.m3.1.1.cmml" xref="alg1.l1.m3.1.1"><in id="alg1.l1.m3.1.1.1.cmml" xref="alg1.l1.m3.1.1.1"></in><apply id="alg1.l1.m3.1.1.2.cmml" xref="alg1.l1.m3.1.1.2"><csymbol cd="ambiguous" id="alg1.l1.m3.1.1.2.1.cmml" xref="alg1.l1.m3.1.1.2">subscript</csymbol><ci id="alg1.l1.m3.1.1.2.2.cmml" xref="alg1.l1.m3.1.1.2.2">𝑣</ci><ci id="alg1.l1.m3.1.1.2.3.cmml" xref="alg1.l1.m3.1.1.2.3">𝑖</ci></apply><ci id="alg1.l1.m3.1.1.3.cmml" xref="alg1.l1.m3.1.1.3">𝒩</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m3.1c">v_{i}\in\mathcal{N}</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m3.1d">italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∈ caligraphic_N</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l2">
<span class="ltx_tag ltx_tag_listingline">2:</span><em class="ltx_emph ltx_font_italic" id="alg1.l2.1">Compute</em> sparse graph random features <math alttext="\{\widehat{\phi}_{\mathcal{G}}(v_{i})\}_{v_{i}\in\mathcal{N}}\subset\mathbb{R}%
^{N}" class="ltx_Math" display="inline" id="alg1.l2.m1.1"><semantics id="alg1.l2.m1.1a"><mrow id="alg1.l2.m1.1.1" xref="alg1.l2.m1.1.1.cmml"><msub id="alg1.l2.m1.1.1.1" xref="alg1.l2.m1.1.1.1.cmml"><mrow id="alg1.l2.m1.1.1.1.1.1" xref="alg1.l2.m1.1.1.1.1.2.cmml"><mo id="alg1.l2.m1.1.1.1.1.1.2" stretchy="false" xref="alg1.l2.m1.1.1.1.1.2.cmml">{</mo><mrow id="alg1.l2.m1.1.1.1.1.1.1" xref="alg1.l2.m1.1.1.1.1.1.1.cmml"><msub id="alg1.l2.m1.1.1.1.1.1.1.3" xref="alg1.l2.m1.1.1.1.1.1.1.3.cmml"><mover accent="true" id="alg1.l2.m1.1.1.1.1.1.1.3.2" xref="alg1.l2.m1.1.1.1.1.1.1.3.2.cmml"><mi id="alg1.l2.m1.1.1.1.1.1.1.3.2.2" xref="alg1.l2.m1.1.1.1.1.1.1.3.2.2.cmml">ϕ</mi><mo id="alg1.l2.m1.1.1.1.1.1.1.3.2.1" xref="alg1.l2.m1.1.1.1.1.1.1.3.2.1.cmml">^</mo></mover><mi class="ltx_font_mathcaligraphic" id="alg1.l2.m1.1.1.1.1.1.1.3.3" xref="alg1.l2.m1.1.1.1.1.1.1.3.3.cmml">𝒢</mi></msub><mo id="alg1.l2.m1.1.1.1.1.1.1.2" xref="alg1.l2.m1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="alg1.l2.m1.1.1.1.1.1.1.1.1" xref="alg1.l2.m1.1.1.1.1.1.1.1.1.1.cmml"><mo id="alg1.l2.m1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="alg1.l2.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="alg1.l2.m1.1.1.1.1.1.1.1.1.1" xref="alg1.l2.m1.1.1.1.1.1.1.1.1.1.cmml"><mi id="alg1.l2.m1.1.1.1.1.1.1.1.1.1.2" xref="alg1.l2.m1.1.1.1.1.1.1.1.1.1.2.cmml">v</mi><mi id="alg1.l2.m1.1.1.1.1.1.1.1.1.1.3" xref="alg1.l2.m1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="alg1.l2.m1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="alg1.l2.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="alg1.l2.m1.1.1.1.1.1.3" stretchy="false" xref="alg1.l2.m1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="alg1.l2.m1.1.1.1.3" xref="alg1.l2.m1.1.1.1.3.cmml"><msub id="alg1.l2.m1.1.1.1.3.2" xref="alg1.l2.m1.1.1.1.3.2.cmml"><mi id="alg1.l2.m1.1.1.1.3.2.2" xref="alg1.l2.m1.1.1.1.3.2.2.cmml">v</mi><mi id="alg1.l2.m1.1.1.1.3.2.3" xref="alg1.l2.m1.1.1.1.3.2.3.cmml">i</mi></msub><mo id="alg1.l2.m1.1.1.1.3.1" xref="alg1.l2.m1.1.1.1.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="alg1.l2.m1.1.1.1.3.3" xref="alg1.l2.m1.1.1.1.3.3.cmml">𝒩</mi></mrow></msub><mo id="alg1.l2.m1.1.1.2" xref="alg1.l2.m1.1.1.2.cmml">⊂</mo><msup id="alg1.l2.m1.1.1.3" xref="alg1.l2.m1.1.1.3.cmml"><mi id="alg1.l2.m1.1.1.3.2" xref="alg1.l2.m1.1.1.3.2.cmml">ℝ</mi><mi id="alg1.l2.m1.1.1.3.3" xref="alg1.l2.m1.1.1.3.3.cmml">N</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="alg1.l2.m1.1b"><apply id="alg1.l2.m1.1.1.cmml" xref="alg1.l2.m1.1.1"><subset id="alg1.l2.m1.1.1.2.cmml" xref="alg1.l2.m1.1.1.2"></subset><apply id="alg1.l2.m1.1.1.1.cmml" xref="alg1.l2.m1.1.1.1"><csymbol cd="ambiguous" id="alg1.l2.m1.1.1.1.2.cmml" xref="alg1.l2.m1.1.1.1">subscript</csymbol><set id="alg1.l2.m1.1.1.1.1.2.cmml" xref="alg1.l2.m1.1.1.1.1.1"><apply id="alg1.l2.m1.1.1.1.1.1.1.cmml" xref="alg1.l2.m1.1.1.1.1.1.1"><times id="alg1.l2.m1.1.1.1.1.1.1.2.cmml" xref="alg1.l2.m1.1.1.1.1.1.1.2"></times><apply id="alg1.l2.m1.1.1.1.1.1.1.3.cmml" xref="alg1.l2.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l2.m1.1.1.1.1.1.1.3.1.cmml" xref="alg1.l2.m1.1.1.1.1.1.1.3">subscript</csymbol><apply id="alg1.l2.m1.1.1.1.1.1.1.3.2.cmml" xref="alg1.l2.m1.1.1.1.1.1.1.3.2"><ci id="alg1.l2.m1.1.1.1.1.1.1.3.2.1.cmml" xref="alg1.l2.m1.1.1.1.1.1.1.3.2.1">^</ci><ci id="alg1.l2.m1.1.1.1.1.1.1.3.2.2.cmml" xref="alg1.l2.m1.1.1.1.1.1.1.3.2.2">italic-ϕ</ci></apply><ci id="alg1.l2.m1.1.1.1.1.1.1.3.3.cmml" xref="alg1.l2.m1.1.1.1.1.1.1.3.3">𝒢</ci></apply><apply id="alg1.l2.m1.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l2.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l2.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l2.m1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l2.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l2.m1.1.1.1.1.1.1.1.1.1.2">𝑣</ci><ci id="alg1.l2.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l2.m1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply></set><apply id="alg1.l2.m1.1.1.1.3.cmml" xref="alg1.l2.m1.1.1.1.3"><in id="alg1.l2.m1.1.1.1.3.1.cmml" xref="alg1.l2.m1.1.1.1.3.1"></in><apply id="alg1.l2.m1.1.1.1.3.2.cmml" xref="alg1.l2.m1.1.1.1.3.2"><csymbol cd="ambiguous" id="alg1.l2.m1.1.1.1.3.2.1.cmml" xref="alg1.l2.m1.1.1.1.3.2">subscript</csymbol><ci id="alg1.l2.m1.1.1.1.3.2.2.cmml" xref="alg1.l2.m1.1.1.1.3.2.2">𝑣</ci><ci id="alg1.l2.m1.1.1.1.3.2.3.cmml" xref="alg1.l2.m1.1.1.1.3.2.3">𝑖</ci></apply><ci id="alg1.l2.m1.1.1.1.3.3.cmml" xref="alg1.l2.m1.1.1.1.3.3">𝒩</ci></apply></apply><apply id="alg1.l2.m1.1.1.3.cmml" xref="alg1.l2.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l2.m1.1.1.3.1.cmml" xref="alg1.l2.m1.1.1.3">superscript</csymbol><ci id="alg1.l2.m1.1.1.3.2.cmml" xref="alg1.l2.m1.1.1.3.2">ℝ</ci><ci id="alg1.l2.m1.1.1.3.3.cmml" xref="alg1.l2.m1.1.1.3.3">𝑁</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m1.1c">\{\widehat{\phi}_{\mathcal{G}}(v_{i})\}_{v_{i}\in\mathcal{N}}\subset\mathbb{R}%
^{N}</annotation><annotation encoding="application/x-llamapun" id="alg1.l2.m1.1d">{ over^ start_ARG italic_ϕ end_ARG start_POSTSUBSCRIPT caligraphic_G end_POSTSUBSCRIPT ( italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) } start_POSTSUBSCRIPT italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∈ caligraphic_N end_POSTSUBSCRIPT ⊂ blackboard_R start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT</annotation></semantics></math> using the walks <math alttext="\{\omega_{k}^{(i)}\}_{k=1}^{n}" class="ltx_Math" display="inline" id="alg1.l2.m2.2"><semantics id="alg1.l2.m2.2a"><msubsup id="alg1.l2.m2.2.2" xref="alg1.l2.m2.2.2.cmml"><mrow id="alg1.l2.m2.2.2.1.1.1" xref="alg1.l2.m2.2.2.1.1.2.cmml"><mo id="alg1.l2.m2.2.2.1.1.1.2" stretchy="false" xref="alg1.l2.m2.2.2.1.1.2.cmml">{</mo><msubsup id="alg1.l2.m2.2.2.1.1.1.1" xref="alg1.l2.m2.2.2.1.1.1.1.cmml"><mi id="alg1.l2.m2.2.2.1.1.1.1.2.2" xref="alg1.l2.m2.2.2.1.1.1.1.2.2.cmml">ω</mi><mi id="alg1.l2.m2.2.2.1.1.1.1.2.3" xref="alg1.l2.m2.2.2.1.1.1.1.2.3.cmml">k</mi><mrow id="alg1.l2.m2.1.1.1.3" xref="alg1.l2.m2.2.2.1.1.1.1.cmml"><mo id="alg1.l2.m2.1.1.1.3.1" stretchy="false" xref="alg1.l2.m2.2.2.1.1.1.1.cmml">(</mo><mi id="alg1.l2.m2.1.1.1.1" xref="alg1.l2.m2.1.1.1.1.cmml">i</mi><mo id="alg1.l2.m2.1.1.1.3.2" stretchy="false" xref="alg1.l2.m2.2.2.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="alg1.l2.m2.2.2.1.1.1.3" stretchy="false" xref="alg1.l2.m2.2.2.1.1.2.cmml">}</mo></mrow><mrow id="alg1.l2.m2.2.2.1.3" xref="alg1.l2.m2.2.2.1.3.cmml"><mi id="alg1.l2.m2.2.2.1.3.2" xref="alg1.l2.m2.2.2.1.3.2.cmml">k</mi><mo id="alg1.l2.m2.2.2.1.3.1" xref="alg1.l2.m2.2.2.1.3.1.cmml">=</mo><mn id="alg1.l2.m2.2.2.1.3.3" xref="alg1.l2.m2.2.2.1.3.3.cmml">1</mn></mrow><mi id="alg1.l2.m2.2.2.3" xref="alg1.l2.m2.2.2.3.cmml">n</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l2.m2.2b"><apply id="alg1.l2.m2.2.2.cmml" xref="alg1.l2.m2.2.2"><csymbol cd="ambiguous" id="alg1.l2.m2.2.2.2.cmml" xref="alg1.l2.m2.2.2">superscript</csymbol><apply id="alg1.l2.m2.2.2.1.cmml" xref="alg1.l2.m2.2.2"><csymbol cd="ambiguous" id="alg1.l2.m2.2.2.1.2.cmml" xref="alg1.l2.m2.2.2">subscript</csymbol><set id="alg1.l2.m2.2.2.1.1.2.cmml" xref="alg1.l2.m2.2.2.1.1.1"><apply id="alg1.l2.m2.2.2.1.1.1.1.cmml" xref="alg1.l2.m2.2.2.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l2.m2.2.2.1.1.1.1.1.cmml" xref="alg1.l2.m2.2.2.1.1.1.1">superscript</csymbol><apply id="alg1.l2.m2.2.2.1.1.1.1.2.cmml" xref="alg1.l2.m2.2.2.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l2.m2.2.2.1.1.1.1.2.1.cmml" xref="alg1.l2.m2.2.2.1.1.1.1">subscript</csymbol><ci id="alg1.l2.m2.2.2.1.1.1.1.2.2.cmml" xref="alg1.l2.m2.2.2.1.1.1.1.2.2">𝜔</ci><ci id="alg1.l2.m2.2.2.1.1.1.1.2.3.cmml" xref="alg1.l2.m2.2.2.1.1.1.1.2.3">𝑘</ci></apply><ci id="alg1.l2.m2.1.1.1.1.cmml" xref="alg1.l2.m2.1.1.1.1">𝑖</ci></apply></set><apply id="alg1.l2.m2.2.2.1.3.cmml" xref="alg1.l2.m2.2.2.1.3"><eq id="alg1.l2.m2.2.2.1.3.1.cmml" xref="alg1.l2.m2.2.2.1.3.1"></eq><ci id="alg1.l2.m2.2.2.1.3.2.cmml" xref="alg1.l2.m2.2.2.1.3.2">𝑘</ci><cn id="alg1.l2.m2.2.2.1.3.3.cmml" type="integer" xref="alg1.l2.m2.2.2.1.3.3">1</cn></apply></apply><ci id="alg1.l2.m2.2.2.3.cmml" xref="alg1.l2.m2.2.2.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m2.2c">\{\omega_{k}^{(i)}\}_{k=1}^{n}</annotation><annotation encoding="application/x-llamapun" id="alg1.l2.m2.2d">{ italic_ω start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT } start_POSTSUBSCRIPT italic_k = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT</annotation></semantics></math> and learnable mask parameters <math alttext="(f_{i})_{i=0}^{i_{\textrm{max}}}" class="ltx_Math" display="inline" id="alg1.l2.m3.1"><semantics id="alg1.l2.m3.1a"><msubsup id="alg1.l2.m3.1.1" xref="alg1.l2.m3.1.1.cmml"><mrow id="alg1.l2.m3.1.1.1.1.1" xref="alg1.l2.m3.1.1.1.1.1.1.cmml"><mo id="alg1.l2.m3.1.1.1.1.1.2" stretchy="false" xref="alg1.l2.m3.1.1.1.1.1.1.cmml">(</mo><msub id="alg1.l2.m3.1.1.1.1.1.1" xref="alg1.l2.m3.1.1.1.1.1.1.cmml"><mi id="alg1.l2.m3.1.1.1.1.1.1.2" xref="alg1.l2.m3.1.1.1.1.1.1.2.cmml">f</mi><mi id="alg1.l2.m3.1.1.1.1.1.1.3" xref="alg1.l2.m3.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="alg1.l2.m3.1.1.1.1.1.3" stretchy="false" xref="alg1.l2.m3.1.1.1.1.1.1.cmml">)</mo></mrow><mrow id="alg1.l2.m3.1.1.1.3" xref="alg1.l2.m3.1.1.1.3.cmml"><mi id="alg1.l2.m3.1.1.1.3.2" xref="alg1.l2.m3.1.1.1.3.2.cmml">i</mi><mo id="alg1.l2.m3.1.1.1.3.1" xref="alg1.l2.m3.1.1.1.3.1.cmml">=</mo><mn id="alg1.l2.m3.1.1.1.3.3" xref="alg1.l2.m3.1.1.1.3.3.cmml">0</mn></mrow><msub id="alg1.l2.m3.1.1.3" xref="alg1.l2.m3.1.1.3.cmml"><mi id="alg1.l2.m3.1.1.3.2" xref="alg1.l2.m3.1.1.3.2.cmml">i</mi><mtext id="alg1.l2.m3.1.1.3.3" xref="alg1.l2.m3.1.1.3.3a.cmml">max</mtext></msub></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l2.m3.1b"><apply id="alg1.l2.m3.1.1.cmml" xref="alg1.l2.m3.1.1"><csymbol cd="ambiguous" id="alg1.l2.m3.1.1.2.cmml" xref="alg1.l2.m3.1.1">superscript</csymbol><apply id="alg1.l2.m3.1.1.1.cmml" xref="alg1.l2.m3.1.1"><csymbol cd="ambiguous" id="alg1.l2.m3.1.1.1.2.cmml" xref="alg1.l2.m3.1.1">subscript</csymbol><apply id="alg1.l2.m3.1.1.1.1.1.1.cmml" xref="alg1.l2.m3.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l2.m3.1.1.1.1.1.1.1.cmml" xref="alg1.l2.m3.1.1.1.1.1">subscript</csymbol><ci id="alg1.l2.m3.1.1.1.1.1.1.2.cmml" xref="alg1.l2.m3.1.1.1.1.1.1.2">𝑓</ci><ci id="alg1.l2.m3.1.1.1.1.1.1.3.cmml" xref="alg1.l2.m3.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="alg1.l2.m3.1.1.1.3.cmml" xref="alg1.l2.m3.1.1.1.3"><eq id="alg1.l2.m3.1.1.1.3.1.cmml" xref="alg1.l2.m3.1.1.1.3.1"></eq><ci id="alg1.l2.m3.1.1.1.3.2.cmml" xref="alg1.l2.m3.1.1.1.3.2">𝑖</ci><cn id="alg1.l2.m3.1.1.1.3.3.cmml" type="integer" xref="alg1.l2.m3.1.1.1.3.3">0</cn></apply></apply><apply id="alg1.l2.m3.1.1.3.cmml" xref="alg1.l2.m3.1.1.3"><csymbol cd="ambiguous" id="alg1.l2.m3.1.1.3.1.cmml" xref="alg1.l2.m3.1.1.3">subscript</csymbol><ci id="alg1.l2.m3.1.1.3.2.cmml" xref="alg1.l2.m3.1.1.3.2">𝑖</ci><ci id="alg1.l2.m3.1.1.3.3a.cmml" xref="alg1.l2.m3.1.1.3.3"><mtext id="alg1.l2.m3.1.1.3.3.cmml" mathsize="50%" xref="alg1.l2.m3.1.1.3.3">max</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m3.1c">(f_{i})_{i=0}^{i_{\textrm{max}}}</annotation><annotation encoding="application/x-llamapun" id="alg1.l2.m3.1d">( italic_f start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) start_POSTSUBSCRIPT italic_i = 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i start_POSTSUBSCRIPT max end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l3">
<span class="ltx_tag ltx_tag_listingline">3:</span><em class="ltx_emph ltx_font_italic" id="alg1.l3.1">Compute</em> the query and key features <math alttext="\{\phi(\mathbf{q}_{i})\}_{i=1}^{N}" class="ltx_Math" display="inline" id="alg1.l3.m1.1"><semantics id="alg1.l3.m1.1a"><msubsup id="alg1.l3.m1.1.1" xref="alg1.l3.m1.1.1.cmml"><mrow id="alg1.l3.m1.1.1.1.1.1" xref="alg1.l3.m1.1.1.1.1.2.cmml"><mo id="alg1.l3.m1.1.1.1.1.1.2" stretchy="false" xref="alg1.l3.m1.1.1.1.1.2.cmml">{</mo><mrow id="alg1.l3.m1.1.1.1.1.1.1" xref="alg1.l3.m1.1.1.1.1.1.1.cmml"><mi id="alg1.l3.m1.1.1.1.1.1.1.3" xref="alg1.l3.m1.1.1.1.1.1.1.3.cmml">ϕ</mi><mo id="alg1.l3.m1.1.1.1.1.1.1.2" xref="alg1.l3.m1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="alg1.l3.m1.1.1.1.1.1.1.1.1" xref="alg1.l3.m1.1.1.1.1.1.1.1.1.1.cmml"><mo id="alg1.l3.m1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="alg1.l3.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="alg1.l3.m1.1.1.1.1.1.1.1.1.1" xref="alg1.l3.m1.1.1.1.1.1.1.1.1.1.cmml"><mi id="alg1.l3.m1.1.1.1.1.1.1.1.1.1.2" xref="alg1.l3.m1.1.1.1.1.1.1.1.1.1.2.cmml">𝐪</mi><mi id="alg1.l3.m1.1.1.1.1.1.1.1.1.1.3" xref="alg1.l3.m1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="alg1.l3.m1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="alg1.l3.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="alg1.l3.m1.1.1.1.1.1.3" stretchy="false" xref="alg1.l3.m1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="alg1.l3.m1.1.1.1.3" xref="alg1.l3.m1.1.1.1.3.cmml"><mi id="alg1.l3.m1.1.1.1.3.2" xref="alg1.l3.m1.1.1.1.3.2.cmml">i</mi><mo id="alg1.l3.m1.1.1.1.3.1" xref="alg1.l3.m1.1.1.1.3.1.cmml">=</mo><mn id="alg1.l3.m1.1.1.1.3.3" xref="alg1.l3.m1.1.1.1.3.3.cmml">1</mn></mrow><mi id="alg1.l3.m1.1.1.3" xref="alg1.l3.m1.1.1.3.cmml">N</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l3.m1.1b"><apply id="alg1.l3.m1.1.1.cmml" xref="alg1.l3.m1.1.1"><csymbol cd="ambiguous" id="alg1.l3.m1.1.1.2.cmml" xref="alg1.l3.m1.1.1">superscript</csymbol><apply id="alg1.l3.m1.1.1.1.cmml" xref="alg1.l3.m1.1.1"><csymbol cd="ambiguous" id="alg1.l3.m1.1.1.1.2.cmml" xref="alg1.l3.m1.1.1">subscript</csymbol><set id="alg1.l3.m1.1.1.1.1.2.cmml" xref="alg1.l3.m1.1.1.1.1.1"><apply id="alg1.l3.m1.1.1.1.1.1.1.cmml" xref="alg1.l3.m1.1.1.1.1.1.1"><times id="alg1.l3.m1.1.1.1.1.1.1.2.cmml" xref="alg1.l3.m1.1.1.1.1.1.1.2"></times><ci id="alg1.l3.m1.1.1.1.1.1.1.3.cmml" xref="alg1.l3.m1.1.1.1.1.1.1.3">italic-ϕ</ci><apply id="alg1.l3.m1.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l3.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l3.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l3.m1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l3.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l3.m1.1.1.1.1.1.1.1.1.1.2">𝐪</ci><ci id="alg1.l3.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l3.m1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply></set><apply id="alg1.l3.m1.1.1.1.3.cmml" xref="alg1.l3.m1.1.1.1.3"><eq id="alg1.l3.m1.1.1.1.3.1.cmml" xref="alg1.l3.m1.1.1.1.3.1"></eq><ci id="alg1.l3.m1.1.1.1.3.2.cmml" xref="alg1.l3.m1.1.1.1.3.2">𝑖</ci><cn id="alg1.l3.m1.1.1.1.3.3.cmml" type="integer" xref="alg1.l3.m1.1.1.1.3.3">1</cn></apply></apply><ci id="alg1.l3.m1.1.1.3.cmml" xref="alg1.l3.m1.1.1.3">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m1.1c">\{\phi(\mathbf{q}_{i})\}_{i=1}^{N}</annotation><annotation encoding="application/x-llamapun" id="alg1.l3.m1.1d">{ italic_ϕ ( bold_q start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) } start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT</annotation></semantics></math>, <math alttext="\{\phi(\mathbf{k}_{i})\}_{i=1}^{N}" class="ltx_Math" display="inline" id="alg1.l3.m2.1"><semantics id="alg1.l3.m2.1a"><msubsup id="alg1.l3.m2.1.1" xref="alg1.l3.m2.1.1.cmml"><mrow id="alg1.l3.m2.1.1.1.1.1" xref="alg1.l3.m2.1.1.1.1.2.cmml"><mo id="alg1.l3.m2.1.1.1.1.1.2" stretchy="false" xref="alg1.l3.m2.1.1.1.1.2.cmml">{</mo><mrow id="alg1.l3.m2.1.1.1.1.1.1" xref="alg1.l3.m2.1.1.1.1.1.1.cmml"><mi id="alg1.l3.m2.1.1.1.1.1.1.3" xref="alg1.l3.m2.1.1.1.1.1.1.3.cmml">ϕ</mi><mo id="alg1.l3.m2.1.1.1.1.1.1.2" xref="alg1.l3.m2.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="alg1.l3.m2.1.1.1.1.1.1.1.1" xref="alg1.l3.m2.1.1.1.1.1.1.1.1.1.cmml"><mo id="alg1.l3.m2.1.1.1.1.1.1.1.1.2" stretchy="false" xref="alg1.l3.m2.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="alg1.l3.m2.1.1.1.1.1.1.1.1.1" xref="alg1.l3.m2.1.1.1.1.1.1.1.1.1.cmml"><mi id="alg1.l3.m2.1.1.1.1.1.1.1.1.1.2" xref="alg1.l3.m2.1.1.1.1.1.1.1.1.1.2.cmml">𝐤</mi><mi id="alg1.l3.m2.1.1.1.1.1.1.1.1.1.3" xref="alg1.l3.m2.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="alg1.l3.m2.1.1.1.1.1.1.1.1.3" stretchy="false" xref="alg1.l3.m2.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="alg1.l3.m2.1.1.1.1.1.3" stretchy="false" xref="alg1.l3.m2.1.1.1.1.2.cmml">}</mo></mrow><mrow id="alg1.l3.m2.1.1.1.3" xref="alg1.l3.m2.1.1.1.3.cmml"><mi id="alg1.l3.m2.1.1.1.3.2" xref="alg1.l3.m2.1.1.1.3.2.cmml">i</mi><mo id="alg1.l3.m2.1.1.1.3.1" xref="alg1.l3.m2.1.1.1.3.1.cmml">=</mo><mn id="alg1.l3.m2.1.1.1.3.3" xref="alg1.l3.m2.1.1.1.3.3.cmml">1</mn></mrow><mi id="alg1.l3.m2.1.1.3" xref="alg1.l3.m2.1.1.3.cmml">N</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l3.m2.1b"><apply id="alg1.l3.m2.1.1.cmml" xref="alg1.l3.m2.1.1"><csymbol cd="ambiguous" id="alg1.l3.m2.1.1.2.cmml" xref="alg1.l3.m2.1.1">superscript</csymbol><apply id="alg1.l3.m2.1.1.1.cmml" xref="alg1.l3.m2.1.1"><csymbol cd="ambiguous" id="alg1.l3.m2.1.1.1.2.cmml" xref="alg1.l3.m2.1.1">subscript</csymbol><set id="alg1.l3.m2.1.1.1.1.2.cmml" xref="alg1.l3.m2.1.1.1.1.1"><apply id="alg1.l3.m2.1.1.1.1.1.1.cmml" xref="alg1.l3.m2.1.1.1.1.1.1"><times id="alg1.l3.m2.1.1.1.1.1.1.2.cmml" xref="alg1.l3.m2.1.1.1.1.1.1.2"></times><ci id="alg1.l3.m2.1.1.1.1.1.1.3.cmml" xref="alg1.l3.m2.1.1.1.1.1.1.3">italic-ϕ</ci><apply id="alg1.l3.m2.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l3.m2.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l3.m2.1.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l3.m2.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l3.m2.1.1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l3.m2.1.1.1.1.1.1.1.1.1.2">𝐤</ci><ci id="alg1.l3.m2.1.1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l3.m2.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply></set><apply id="alg1.l3.m2.1.1.1.3.cmml" xref="alg1.l3.m2.1.1.1.3"><eq id="alg1.l3.m2.1.1.1.3.1.cmml" xref="alg1.l3.m2.1.1.1.3.1"></eq><ci id="alg1.l3.m2.1.1.1.3.2.cmml" xref="alg1.l3.m2.1.1.1.3.2">𝑖</ci><cn id="alg1.l3.m2.1.1.1.3.3.cmml" type="integer" xref="alg1.l3.m2.1.1.1.3.3">1</cn></apply></apply><ci id="alg1.l3.m2.1.1.3.cmml" xref="alg1.l3.m2.1.1.3">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m2.1c">\{\phi(\mathbf{k}_{i})\}_{i=1}^{N}</annotation><annotation encoding="application/x-llamapun" id="alg1.l3.m2.1d">{ italic_ϕ ( bold_k start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) } start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT</annotation></semantics></math>, with <math alttext="\phi" class="ltx_Math" display="inline" id="alg1.l3.m3.1"><semantics id="alg1.l3.m3.1a"><mi id="alg1.l3.m3.1.1" xref="alg1.l3.m3.1.1.cmml">ϕ</mi><annotation-xml encoding="MathML-Content" id="alg1.l3.m3.1b"><ci id="alg1.l3.m3.1.1.cmml" xref="alg1.l3.m3.1.1">italic-ϕ</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m3.1c">\phi</annotation><annotation encoding="application/x-llamapun" id="alg1.l3.m3.1d">italic_ϕ</annotation></semantics></math> the chosen linear-attention nonlinearity (e.g.&nbsp;<math alttext="\textrm{elu}(x)+x" class="ltx_Math" display="inline" id="alg1.l3.m4.1"><semantics id="alg1.l3.m4.1a"><mrow id="alg1.l3.m4.1.2" xref="alg1.l3.m4.1.2.cmml"><mrow id="alg1.l3.m4.1.2.2" xref="alg1.l3.m4.1.2.2.cmml"><mtext id="alg1.l3.m4.1.2.2.2" xref="alg1.l3.m4.1.2.2.2a.cmml">elu</mtext><mo id="alg1.l3.m4.1.2.2.1" xref="alg1.l3.m4.1.2.2.1.cmml">⁢</mo><mrow id="alg1.l3.m4.1.2.2.3.2" xref="alg1.l3.m4.1.2.2.cmml"><mo id="alg1.l3.m4.1.2.2.3.2.1" stretchy="false" xref="alg1.l3.m4.1.2.2.cmml">(</mo><mi id="alg1.l3.m4.1.1" xref="alg1.l3.m4.1.1.cmml">x</mi><mo id="alg1.l3.m4.1.2.2.3.2.2" stretchy="false" xref="alg1.l3.m4.1.2.2.cmml">)</mo></mrow></mrow><mo id="alg1.l3.m4.1.2.1" xref="alg1.l3.m4.1.2.1.cmml">+</mo><mi id="alg1.l3.m4.1.2.3" xref="alg1.l3.m4.1.2.3.cmml">x</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l3.m4.1b"><apply id="alg1.l3.m4.1.2.cmml" xref="alg1.l3.m4.1.2"><plus id="alg1.l3.m4.1.2.1.cmml" xref="alg1.l3.m4.1.2.1"></plus><apply id="alg1.l3.m4.1.2.2.cmml" xref="alg1.l3.m4.1.2.2"><times id="alg1.l3.m4.1.2.2.1.cmml" xref="alg1.l3.m4.1.2.2.1"></times><ci id="alg1.l3.m4.1.2.2.2a.cmml" xref="alg1.l3.m4.1.2.2.2"><mtext id="alg1.l3.m4.1.2.2.2.cmml" xref="alg1.l3.m4.1.2.2.2">elu</mtext></ci><ci id="alg1.l3.m4.1.1.cmml" xref="alg1.l3.m4.1.1">𝑥</ci></apply><ci id="alg1.l3.m4.1.2.3.cmml" xref="alg1.l3.m4.1.2.3">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m4.1c">\textrm{elu}(x)+x</annotation><annotation encoding="application/x-llamapun" id="alg1.l3.m4.1d">elu ( italic_x ) + italic_x</annotation></semantics></math> <cite class="ltx_cite ltx_citemacro_citep">(Katharopoulos et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#bib.bib16" title="">2020</a>)</cite> or a Monte Carlo estimate of softmax <cite class="ltx_cite ltx_citemacro_citep">(Choromanski et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#bib.bib5" title="">2020</a>)</cite>)

</div>
<div class="ltx_listingline" id="alg1.l4">
<span class="ltx_tag ltx_tag_listingline">4:</span><em class="ltx_emph ltx_font_italic" id="alg1.l4.1">Combine</em> the query/key features and graph features into a sparse topology-enhanced feature matrix, <math alttext="\widehat{\mathbf{\Phi}}_{\{\mathbf{Q},\mathbf{K}\},\mathcal{G}}\coloneqq[%
\mathrm{vec}(\phi(\left\{\mathbf{q}_{i},\mathbf{k}_{i}\right\})\otimes\widehat%
{\phi}_{\mathcal{G}}(v_{i}))]_{i=1}^{N}\in\mathbb{R}^{N\times Nm}" class="ltx_Math" display="inline" id="alg1.l4.m1.5"><semantics id="alg1.l4.m1.5a"><mrow id="alg1.l4.m1.5.5" xref="alg1.l4.m1.5.5.cmml"><msub id="alg1.l4.m1.5.5.3" xref="alg1.l4.m1.5.5.3.cmml"><mover accent="true" id="alg1.l4.m1.5.5.3.2" xref="alg1.l4.m1.5.5.3.2.cmml"><mi id="alg1.l4.m1.5.5.3.2.2" xref="alg1.l4.m1.5.5.3.2.2.cmml">𝚽</mi><mo id="alg1.l4.m1.5.5.3.2.1" xref="alg1.l4.m1.5.5.3.2.1.cmml">^</mo></mover><mrow id="alg1.l4.m1.4.4.4.4" xref="alg1.l4.m1.4.4.4.5.cmml"><mrow id="alg1.l4.m1.4.4.4.4.1.2" xref="alg1.l4.m1.4.4.4.4.1.1.cmml"><mo id="alg1.l4.m1.4.4.4.4.1.2.1" stretchy="false" xref="alg1.l4.m1.4.4.4.4.1.1.cmml">{</mo><mi id="alg1.l4.m1.1.1.1.1" xref="alg1.l4.m1.1.1.1.1.cmml">𝐐</mi><mo id="alg1.l4.m1.4.4.4.4.1.2.2" xref="alg1.l4.m1.4.4.4.4.1.1.cmml">,</mo><mi id="alg1.l4.m1.2.2.2.2" xref="alg1.l4.m1.2.2.2.2.cmml">𝐊</mi><mo id="alg1.l4.m1.4.4.4.4.1.2.3" stretchy="false" xref="alg1.l4.m1.4.4.4.4.1.1.cmml">}</mo></mrow><mo id="alg1.l4.m1.4.4.4.4.2" xref="alg1.l4.m1.4.4.4.5.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="alg1.l4.m1.3.3.3.3" xref="alg1.l4.m1.3.3.3.3.cmml">𝒢</mi></mrow></msub><mo id="alg1.l4.m1.5.5.4" xref="alg1.l4.m1.5.5.4.cmml">≔</mo><msubsup id="alg1.l4.m1.5.5.1" xref="alg1.l4.m1.5.5.1.cmml"><mrow id="alg1.l4.m1.5.5.1.1.1.1" xref="alg1.l4.m1.5.5.1.1.1.2.cmml"><mo id="alg1.l4.m1.5.5.1.1.1.1.2" stretchy="false" xref="alg1.l4.m1.5.5.1.1.1.2.1.cmml">[</mo><mrow id="alg1.l4.m1.5.5.1.1.1.1.1" xref="alg1.l4.m1.5.5.1.1.1.1.1.cmml"><mi id="alg1.l4.m1.5.5.1.1.1.1.1.3" xref="alg1.l4.m1.5.5.1.1.1.1.1.3.cmml">vec</mi><mo id="alg1.l4.m1.5.5.1.1.1.1.1.2" xref="alg1.l4.m1.5.5.1.1.1.1.1.2.cmml">⁢</mo><mrow id="alg1.l4.m1.5.5.1.1.1.1.1.1.1" xref="alg1.l4.m1.5.5.1.1.1.1.1.1.1.1.cmml"><mo id="alg1.l4.m1.5.5.1.1.1.1.1.1.1.2" stretchy="false" xref="alg1.l4.m1.5.5.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="alg1.l4.m1.5.5.1.1.1.1.1.1.1.1" xref="alg1.l4.m1.5.5.1.1.1.1.1.1.1.1.cmml"><mrow id="alg1.l4.m1.5.5.1.1.1.1.1.1.1.1.1" xref="alg1.l4.m1.5.5.1.1.1.1.1.1.1.1.1.cmml"><mrow id="alg1.l4.m1.5.5.1.1.1.1.1.1.1.1.1.1" xref="alg1.l4.m1.5.5.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="alg1.l4.m1.5.5.1.1.1.1.1.1.1.1.1.1.3" xref="alg1.l4.m1.5.5.1.1.1.1.1.1.1.1.1.1.3.cmml">ϕ</mi><mo id="alg1.l4.m1.5.5.1.1.1.1.1.1.1.1.1.1.2" xref="alg1.l4.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="alg1.l4.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1" xref="alg1.l4.m1.5.5.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="alg1.l4.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="alg1.l4.m1.5.5.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="alg1.l4.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="alg1.l4.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mo id="alg1.l4.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="alg1.l4.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">{</mo><msub id="alg1.l4.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="alg1.l4.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="alg1.l4.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="alg1.l4.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">𝐪</mi><mi id="alg1.l4.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="alg1.l4.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="alg1.l4.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.2.4" xref="alg1.l4.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">,</mo><msub id="alg1.l4.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="alg1.l4.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml"><mi id="alg1.l4.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2" xref="alg1.l4.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml">𝐤</mi><mi id="alg1.l4.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3" xref="alg1.l4.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml">i</mi></msub><mo id="alg1.l4.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.2.5" xref="alg1.l4.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">}</mo></mrow><mo id="alg1.l4.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="alg1.l4.m1.5.5.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="alg1.l4.m1.5.5.1.1.1.1.1.1.1.1.1.2" rspace="0.222em" xref="alg1.l4.m1.5.5.1.1.1.1.1.1.1.1.1.2.cmml">⊗</mo><msub id="alg1.l4.m1.5.5.1.1.1.1.1.1.1.1.1.3" xref="alg1.l4.m1.5.5.1.1.1.1.1.1.1.1.1.3.cmml"><mover accent="true" id="alg1.l4.m1.5.5.1.1.1.1.1.1.1.1.1.3.2" xref="alg1.l4.m1.5.5.1.1.1.1.1.1.1.1.1.3.2.cmml"><mi id="alg1.l4.m1.5.5.1.1.1.1.1.1.1.1.1.3.2.2" xref="alg1.l4.m1.5.5.1.1.1.1.1.1.1.1.1.3.2.2.cmml">ϕ</mi><mo id="alg1.l4.m1.5.5.1.1.1.1.1.1.1.1.1.3.2.1" xref="alg1.l4.m1.5.5.1.1.1.1.1.1.1.1.1.3.2.1.cmml">^</mo></mover><mi class="ltx_font_mathcaligraphic" id="alg1.l4.m1.5.5.1.1.1.1.1.1.1.1.1.3.3" xref="alg1.l4.m1.5.5.1.1.1.1.1.1.1.1.1.3.3.cmml">𝒢</mi></msub></mrow><mo id="alg1.l4.m1.5.5.1.1.1.1.1.1.1.1.3" xref="alg1.l4.m1.5.5.1.1.1.1.1.1.1.1.3.cmml">⁢</mo><mrow id="alg1.l4.m1.5.5.1.1.1.1.1.1.1.1.2.1" xref="alg1.l4.m1.5.5.1.1.1.1.1.1.1.1.2.1.1.cmml"><mo id="alg1.l4.m1.5.5.1.1.1.1.1.1.1.1.2.1.2" stretchy="false" xref="alg1.l4.m1.5.5.1.1.1.1.1.1.1.1.2.1.1.cmml">(</mo><msub id="alg1.l4.m1.5.5.1.1.1.1.1.1.1.1.2.1.1" xref="alg1.l4.m1.5.5.1.1.1.1.1.1.1.1.2.1.1.cmml"><mi id="alg1.l4.m1.5.5.1.1.1.1.1.1.1.1.2.1.1.2" xref="alg1.l4.m1.5.5.1.1.1.1.1.1.1.1.2.1.1.2.cmml">v</mi><mi id="alg1.l4.m1.5.5.1.1.1.1.1.1.1.1.2.1.1.3" xref="alg1.l4.m1.5.5.1.1.1.1.1.1.1.1.2.1.1.3.cmml">i</mi></msub><mo id="alg1.l4.m1.5.5.1.1.1.1.1.1.1.1.2.1.3" stretchy="false" xref="alg1.l4.m1.5.5.1.1.1.1.1.1.1.1.2.1.1.cmml">)</mo></mrow></mrow><mo id="alg1.l4.m1.5.5.1.1.1.1.1.1.1.3" stretchy="false" xref="alg1.l4.m1.5.5.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="alg1.l4.m1.5.5.1.1.1.1.3" stretchy="false" xref="alg1.l4.m1.5.5.1.1.1.2.1.cmml">]</mo></mrow><mrow id="alg1.l4.m1.5.5.1.1.3" xref="alg1.l4.m1.5.5.1.1.3.cmml"><mi id="alg1.l4.m1.5.5.1.1.3.2" xref="alg1.l4.m1.5.5.1.1.3.2.cmml">i</mi><mo id="alg1.l4.m1.5.5.1.1.3.1" xref="alg1.l4.m1.5.5.1.1.3.1.cmml">=</mo><mn id="alg1.l4.m1.5.5.1.1.3.3" xref="alg1.l4.m1.5.5.1.1.3.3.cmml">1</mn></mrow><mi id="alg1.l4.m1.5.5.1.3" xref="alg1.l4.m1.5.5.1.3.cmml">N</mi></msubsup><mo id="alg1.l4.m1.5.5.5" xref="alg1.l4.m1.5.5.5.cmml">∈</mo><msup id="alg1.l4.m1.5.5.6" xref="alg1.l4.m1.5.5.6.cmml"><mi id="alg1.l4.m1.5.5.6.2" xref="alg1.l4.m1.5.5.6.2.cmml">ℝ</mi><mrow id="alg1.l4.m1.5.5.6.3" xref="alg1.l4.m1.5.5.6.3.cmml"><mrow id="alg1.l4.m1.5.5.6.3.2" xref="alg1.l4.m1.5.5.6.3.2.cmml"><mi id="alg1.l4.m1.5.5.6.3.2.2" xref="alg1.l4.m1.5.5.6.3.2.2.cmml">N</mi><mo id="alg1.l4.m1.5.5.6.3.2.1" lspace="0.222em" rspace="0.222em" xref="alg1.l4.m1.5.5.6.3.2.1.cmml">×</mo><mi id="alg1.l4.m1.5.5.6.3.2.3" xref="alg1.l4.m1.5.5.6.3.2.3.cmml">N</mi></mrow><mo id="alg1.l4.m1.5.5.6.3.1" xref="alg1.l4.m1.5.5.6.3.1.cmml">⁢</mo><mi id="alg1.l4.m1.5.5.6.3.3" xref="alg1.l4.m1.5.5.6.3.3.cmml">m</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="alg1.l4.m1.5b"><apply id="alg1.l4.m1.5.5.cmml" xref="alg1.l4.m1.5.5"><and id="alg1.l4.m1.5.5a.cmml" xref="alg1.l4.m1.5.5"></and><apply id="alg1.l4.m1.5.5b.cmml" xref="alg1.l4.m1.5.5"><ci id="alg1.l4.m1.5.5.4.cmml" xref="alg1.l4.m1.5.5.4">≔</ci><apply id="alg1.l4.m1.5.5.3.cmml" xref="alg1.l4.m1.5.5.3"><csymbol cd="ambiguous" id="alg1.l4.m1.5.5.3.1.cmml" xref="alg1.l4.m1.5.5.3">subscript</csymbol><apply id="alg1.l4.m1.5.5.3.2.cmml" xref="alg1.l4.m1.5.5.3.2"><ci id="alg1.l4.m1.5.5.3.2.1.cmml" xref="alg1.l4.m1.5.5.3.2.1">^</ci><ci id="alg1.l4.m1.5.5.3.2.2.cmml" xref="alg1.l4.m1.5.5.3.2.2">𝚽</ci></apply><list id="alg1.l4.m1.4.4.4.5.cmml" xref="alg1.l4.m1.4.4.4.4"><set id="alg1.l4.m1.4.4.4.4.1.1.cmml" xref="alg1.l4.m1.4.4.4.4.1.2"><ci id="alg1.l4.m1.1.1.1.1.cmml" xref="alg1.l4.m1.1.1.1.1">𝐐</ci><ci id="alg1.l4.m1.2.2.2.2.cmml" xref="alg1.l4.m1.2.2.2.2">𝐊</ci></set><ci id="alg1.l4.m1.3.3.3.3.cmml" xref="alg1.l4.m1.3.3.3.3">𝒢</ci></list></apply><apply id="alg1.l4.m1.5.5.1.cmml" xref="alg1.l4.m1.5.5.1"><csymbol cd="ambiguous" id="alg1.l4.m1.5.5.1.2.cmml" xref="alg1.l4.m1.5.5.1">superscript</csymbol><apply id="alg1.l4.m1.5.5.1.1.cmml" xref="alg1.l4.m1.5.5.1"><csymbol cd="ambiguous" id="alg1.l4.m1.5.5.1.1.2.cmml" xref="alg1.l4.m1.5.5.1">subscript</csymbol><apply id="alg1.l4.m1.5.5.1.1.1.2.cmml" xref="alg1.l4.m1.5.5.1.1.1.1"><csymbol cd="latexml" id="alg1.l4.m1.5.5.1.1.1.2.1.cmml" xref="alg1.l4.m1.5.5.1.1.1.1.2">delimited-[]</csymbol><apply id="alg1.l4.m1.5.5.1.1.1.1.1.cmml" xref="alg1.l4.m1.5.5.1.1.1.1.1"><times id="alg1.l4.m1.5.5.1.1.1.1.1.2.cmml" xref="alg1.l4.m1.5.5.1.1.1.1.1.2"></times><ci id="alg1.l4.m1.5.5.1.1.1.1.1.3.cmml" xref="alg1.l4.m1.5.5.1.1.1.1.1.3">vec</ci><apply id="alg1.l4.m1.5.5.1.1.1.1.1.1.1.1.cmml" xref="alg1.l4.m1.5.5.1.1.1.1.1.1.1"><times id="alg1.l4.m1.5.5.1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l4.m1.5.5.1.1.1.1.1.1.1.1.3"></times><apply id="alg1.l4.m1.5.5.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l4.m1.5.5.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="alg1.l4.m1.5.5.1.1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l4.m1.5.5.1.1.1.1.1.1.1.1.1.2">tensor-product</csymbol><apply id="alg1.l4.m1.5.5.1.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l4.m1.5.5.1.1.1.1.1.1.1.1.1.1"><times id="alg1.l4.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l4.m1.5.5.1.1.1.1.1.1.1.1.1.1.2"></times><ci id="alg1.l4.m1.5.5.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l4.m1.5.5.1.1.1.1.1.1.1.1.1.1.3">italic-ϕ</ci><set id="alg1.l4.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l4.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.2"><apply id="alg1.l4.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l4.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l4.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l4.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l4.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l4.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2">𝐪</ci><ci id="alg1.l4.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l4.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="alg1.l4.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="alg1.l4.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="alg1.l4.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="alg1.l4.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="alg1.l4.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="alg1.l4.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2">𝐤</ci><ci id="alg1.l4.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="alg1.l4.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3">𝑖</ci></apply></set></apply><apply id="alg1.l4.m1.5.5.1.1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l4.m1.5.5.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l4.m1.5.5.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="alg1.l4.m1.5.5.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><apply id="alg1.l4.m1.5.5.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="alg1.l4.m1.5.5.1.1.1.1.1.1.1.1.1.3.2"><ci id="alg1.l4.m1.5.5.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="alg1.l4.m1.5.5.1.1.1.1.1.1.1.1.1.3.2.1">^</ci><ci id="alg1.l4.m1.5.5.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="alg1.l4.m1.5.5.1.1.1.1.1.1.1.1.1.3.2.2">italic-ϕ</ci></apply><ci id="alg1.l4.m1.5.5.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="alg1.l4.m1.5.5.1.1.1.1.1.1.1.1.1.3.3">𝒢</ci></apply></apply><apply id="alg1.l4.m1.5.5.1.1.1.1.1.1.1.1.2.1.1.cmml" xref="alg1.l4.m1.5.5.1.1.1.1.1.1.1.1.2.1"><csymbol cd="ambiguous" id="alg1.l4.m1.5.5.1.1.1.1.1.1.1.1.2.1.1.1.cmml" xref="alg1.l4.m1.5.5.1.1.1.1.1.1.1.1.2.1">subscript</csymbol><ci id="alg1.l4.m1.5.5.1.1.1.1.1.1.1.1.2.1.1.2.cmml" xref="alg1.l4.m1.5.5.1.1.1.1.1.1.1.1.2.1.1.2">𝑣</ci><ci id="alg1.l4.m1.5.5.1.1.1.1.1.1.1.1.2.1.1.3.cmml" xref="alg1.l4.m1.5.5.1.1.1.1.1.1.1.1.2.1.1.3">𝑖</ci></apply></apply></apply></apply><apply id="alg1.l4.m1.5.5.1.1.3.cmml" xref="alg1.l4.m1.5.5.1.1.3"><eq id="alg1.l4.m1.5.5.1.1.3.1.cmml" xref="alg1.l4.m1.5.5.1.1.3.1"></eq><ci id="alg1.l4.m1.5.5.1.1.3.2.cmml" xref="alg1.l4.m1.5.5.1.1.3.2">𝑖</ci><cn id="alg1.l4.m1.5.5.1.1.3.3.cmml" type="integer" xref="alg1.l4.m1.5.5.1.1.3.3">1</cn></apply></apply><ci id="alg1.l4.m1.5.5.1.3.cmml" xref="alg1.l4.m1.5.5.1.3">𝑁</ci></apply></apply><apply id="alg1.l4.m1.5.5c.cmml" xref="alg1.l4.m1.5.5"><in id="alg1.l4.m1.5.5.5.cmml" xref="alg1.l4.m1.5.5.5"></in><share href="https://arxiv.org/html/2410.03462v1#alg1.l4.m1.5.5.1.cmml" id="alg1.l4.m1.5.5d.cmml" xref="alg1.l4.m1.5.5"></share><apply id="alg1.l4.m1.5.5.6.cmml" xref="alg1.l4.m1.5.5.6"><csymbol cd="ambiguous" id="alg1.l4.m1.5.5.6.1.cmml" xref="alg1.l4.m1.5.5.6">superscript</csymbol><ci id="alg1.l4.m1.5.5.6.2.cmml" xref="alg1.l4.m1.5.5.6.2">ℝ</ci><apply id="alg1.l4.m1.5.5.6.3.cmml" xref="alg1.l4.m1.5.5.6.3"><times id="alg1.l4.m1.5.5.6.3.1.cmml" xref="alg1.l4.m1.5.5.6.3.1"></times><apply id="alg1.l4.m1.5.5.6.3.2.cmml" xref="alg1.l4.m1.5.5.6.3.2"><times id="alg1.l4.m1.5.5.6.3.2.1.cmml" xref="alg1.l4.m1.5.5.6.3.2.1"></times><ci id="alg1.l4.m1.5.5.6.3.2.2.cmml" xref="alg1.l4.m1.5.5.6.3.2.2">𝑁</ci><ci id="alg1.l4.m1.5.5.6.3.2.3.cmml" xref="alg1.l4.m1.5.5.6.3.2.3">𝑁</ci></apply><ci id="alg1.l4.m1.5.5.6.3.3.cmml" xref="alg1.l4.m1.5.5.6.3.3">𝑚</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m1.5c">\widehat{\mathbf{\Phi}}_{\{\mathbf{Q},\mathbf{K}\},\mathcal{G}}\coloneqq[%
\mathrm{vec}(\phi(\left\{\mathbf{q}_{i},\mathbf{k}_{i}\right\})\otimes\widehat%
{\phi}_{\mathcal{G}}(v_{i}))]_{i=1}^{N}\in\mathbb{R}^{N\times Nm}</annotation><annotation encoding="application/x-llamapun" id="alg1.l4.m1.5d">over^ start_ARG bold_Φ end_ARG start_POSTSUBSCRIPT { bold_Q , bold_K } , caligraphic_G end_POSTSUBSCRIPT ≔ [ roman_vec ( italic_ϕ ( { bold_q start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , bold_k start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT } ) ⊗ over^ start_ARG italic_ϕ end_ARG start_POSTSUBSCRIPT caligraphic_G end_POSTSUBSCRIPT ( italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) ) ] start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_N × italic_N italic_m end_POSTSUPERSCRIPT</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l5">
<span class="ltx_tag ltx_tag_listingline">5:</span><em class="ltx_emph ltx_font_italic" id="alg1.l5.1">Compute</em> low-rank attention with topological masking in <math alttext="\mathcal{O}(N)" class="ltx_Math" display="inline" id="alg1.l5.m1.1"><semantics id="alg1.l5.m1.1a"><mrow id="alg1.l5.m1.1.2" xref="alg1.l5.m1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l5.m1.1.2.2" xref="alg1.l5.m1.1.2.2.cmml">𝒪</mi><mo id="alg1.l5.m1.1.2.1" xref="alg1.l5.m1.1.2.1.cmml">⁢</mo><mrow id="alg1.l5.m1.1.2.3.2" xref="alg1.l5.m1.1.2.cmml"><mo id="alg1.l5.m1.1.2.3.2.1" stretchy="false" xref="alg1.l5.m1.1.2.cmml">(</mo><mi id="alg1.l5.m1.1.1" xref="alg1.l5.m1.1.1.cmml">N</mi><mo id="alg1.l5.m1.1.2.3.2.2" stretchy="false" xref="alg1.l5.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l5.m1.1b"><apply id="alg1.l5.m1.1.2.cmml" xref="alg1.l5.m1.1.2"><times id="alg1.l5.m1.1.2.1.cmml" xref="alg1.l5.m1.1.2.1"></times><ci id="alg1.l5.m1.1.2.2.cmml" xref="alg1.l5.m1.1.2.2">𝒪</ci><ci id="alg1.l5.m1.1.1.cmml" xref="alg1.l5.m1.1.1">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m1.1c">\mathcal{O}(N)</annotation><annotation encoding="application/x-llamapun" id="alg1.l5.m1.1d">caligraphic_O ( italic_N )</annotation></semantics></math> time by 

<table class="ltx_equation ltx_eqn_table" id="S3.E12">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\textrm{Att}_{\textrm{LR},\widehat{\mathbf{M}}}(\mathbf{Q},\mathbf{K},\mathbf{%
V},\mathcal{G})\coloneqq\mathbf{D}^{-1}\left(\widehat{\mathbf{\Phi}}_{\mathbf{%
Q},\mathcal{G}}\left(\widehat{\mathbf{\Phi}}_{\mathbf{K},\mathcal{G}}^{\top}%
\mathbf{V}\right)\right),\quad\mathbf{D}\coloneqq\widehat{\mathbf{\Phi}}_{%
\mathbf{Q},\mathcal{G}}\left(\widehat{\mathbf{\Phi}}_{\mathbf{K},\mathcal{G}}^%
{\top}\mathbf{1}_{N}\right).\vspace{-1mm}" class="ltx_Math" display="block" id="S3.E12.m1.15"><semantics id="S3.E12.m1.15a"><mrow id="S3.E12.m1.15.15.1"><mrow id="S3.E12.m1.15.15.1.1.2" xref="S3.E12.m1.15.15.1.1.3.cmml"><mrow id="S3.E12.m1.15.15.1.1.1.1" xref="S3.E12.m1.15.15.1.1.1.1.cmml"><mrow id="S3.E12.m1.15.15.1.1.1.1.3" xref="S3.E12.m1.15.15.1.1.1.1.3.cmml"><msub id="S3.E12.m1.15.15.1.1.1.1.3.2" xref="S3.E12.m1.15.15.1.1.1.1.3.2.cmml"><mtext id="S3.E12.m1.15.15.1.1.1.1.3.2.2" xref="S3.E12.m1.15.15.1.1.1.1.3.2.2a.cmml">Att</mtext><mrow id="S3.E12.m1.2.2.2.4" xref="S3.E12.m1.2.2.2.3.cmml"><mtext id="S3.E12.m1.1.1.1.1" xref="S3.E12.m1.1.1.1.1a.cmml">LR</mtext><mo id="S3.E12.m1.2.2.2.4.1" xref="S3.E12.m1.2.2.2.3.cmml">,</mo><mover accent="true" id="S3.E12.m1.2.2.2.2" xref="S3.E12.m1.2.2.2.2.cmml"><mi id="S3.E12.m1.2.2.2.2.2" xref="S3.E12.m1.2.2.2.2.2.cmml">𝐌</mi><mo id="S3.E12.m1.2.2.2.2.1" xref="S3.E12.m1.2.2.2.2.1.cmml">^</mo></mover></mrow></msub><mo id="S3.E12.m1.15.15.1.1.1.1.3.1" xref="S3.E12.m1.15.15.1.1.1.1.3.1.cmml">⁢</mo><mrow id="S3.E12.m1.15.15.1.1.1.1.3.3.2" xref="S3.E12.m1.15.15.1.1.1.1.3.3.1.cmml"><mo id="S3.E12.m1.15.15.1.1.1.1.3.3.2.1" stretchy="false" xref="S3.E12.m1.15.15.1.1.1.1.3.3.1.cmml">(</mo><mi id="S3.E12.m1.11.11" xref="S3.E12.m1.11.11.cmml">𝐐</mi><mo id="S3.E12.m1.15.15.1.1.1.1.3.3.2.2" xref="S3.E12.m1.15.15.1.1.1.1.3.3.1.cmml">,</mo><mi id="S3.E12.m1.12.12" xref="S3.E12.m1.12.12.cmml">𝐊</mi><mo id="S3.E12.m1.15.15.1.1.1.1.3.3.2.3" xref="S3.E12.m1.15.15.1.1.1.1.3.3.1.cmml">,</mo><mi id="S3.E12.m1.13.13" xref="S3.E12.m1.13.13.cmml">𝐕</mi><mo id="S3.E12.m1.15.15.1.1.1.1.3.3.2.4" xref="S3.E12.m1.15.15.1.1.1.1.3.3.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S3.E12.m1.14.14" xref="S3.E12.m1.14.14.cmml">𝒢</mi><mo id="S3.E12.m1.15.15.1.1.1.1.3.3.2.5" stretchy="false" xref="S3.E12.m1.15.15.1.1.1.1.3.3.1.cmml">)</mo></mrow></mrow><mo id="S3.E12.m1.15.15.1.1.1.1.2" xref="S3.E12.m1.15.15.1.1.1.1.2.cmml">≔</mo><mrow id="S3.E12.m1.15.15.1.1.1.1.1" xref="S3.E12.m1.15.15.1.1.1.1.1.cmml"><msup id="S3.E12.m1.15.15.1.1.1.1.1.3" xref="S3.E12.m1.15.15.1.1.1.1.1.3.cmml"><mi id="S3.E12.m1.15.15.1.1.1.1.1.3.2" xref="S3.E12.m1.15.15.1.1.1.1.1.3.2.cmml">𝐃</mi><mrow id="S3.E12.m1.15.15.1.1.1.1.1.3.3" xref="S3.E12.m1.15.15.1.1.1.1.1.3.3.cmml"><mo id="S3.E12.m1.15.15.1.1.1.1.1.3.3a" xref="S3.E12.m1.15.15.1.1.1.1.1.3.3.cmml">−</mo><mn id="S3.E12.m1.15.15.1.1.1.1.1.3.3.2" xref="S3.E12.m1.15.15.1.1.1.1.1.3.3.2.cmml">1</mn></mrow></msup><mo id="S3.E12.m1.15.15.1.1.1.1.1.2" xref="S3.E12.m1.15.15.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E12.m1.15.15.1.1.1.1.1.1.1" xref="S3.E12.m1.15.15.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E12.m1.15.15.1.1.1.1.1.1.1.2" xref="S3.E12.m1.15.15.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E12.m1.15.15.1.1.1.1.1.1.1.1" xref="S3.E12.m1.15.15.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E12.m1.15.15.1.1.1.1.1.1.1.1.3" xref="S3.E12.m1.15.15.1.1.1.1.1.1.1.1.3.cmml"><mover accent="true" id="S3.E12.m1.15.15.1.1.1.1.1.1.1.1.3.2" xref="S3.E12.m1.15.15.1.1.1.1.1.1.1.1.3.2.cmml"><mi id="S3.E12.m1.15.15.1.1.1.1.1.1.1.1.3.2.2" xref="S3.E12.m1.15.15.1.1.1.1.1.1.1.1.3.2.2.cmml">𝚽</mi><mo id="S3.E12.m1.15.15.1.1.1.1.1.1.1.1.3.2.1" xref="S3.E12.m1.15.15.1.1.1.1.1.1.1.1.3.2.1.cmml">^</mo></mover><mrow id="S3.E12.m1.4.4.2.4" xref="S3.E12.m1.4.4.2.3.cmml"><mi id="S3.E12.m1.3.3.1.1" xref="S3.E12.m1.3.3.1.1.cmml">𝐐</mi><mo id="S3.E12.m1.4.4.2.4.1" xref="S3.E12.m1.4.4.2.3.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S3.E12.m1.4.4.2.2" xref="S3.E12.m1.4.4.2.2.cmml">𝒢</mi></mrow></msub><mo id="S3.E12.m1.15.15.1.1.1.1.1.1.1.1.2" xref="S3.E12.m1.15.15.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E12.m1.15.15.1.1.1.1.1.1.1.1.1.1" xref="S3.E12.m1.15.15.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E12.m1.15.15.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E12.m1.15.15.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E12.m1.15.15.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E12.m1.15.15.1.1.1.1.1.1.1.1.1.1.1.cmml"><msubsup id="S3.E12.m1.15.15.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E12.m1.15.15.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mover accent="true" id="S3.E12.m1.15.15.1.1.1.1.1.1.1.1.1.1.1.2.2.2" xref="S3.E12.m1.15.15.1.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml"><mi id="S3.E12.m1.15.15.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2" xref="S3.E12.m1.15.15.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2.cmml">𝚽</mi><mo id="S3.E12.m1.15.15.1.1.1.1.1.1.1.1.1.1.1.2.2.2.1" xref="S3.E12.m1.15.15.1.1.1.1.1.1.1.1.1.1.1.2.2.2.1.cmml">^</mo></mover><mrow id="S3.E12.m1.6.6.2.4" xref="S3.E12.m1.6.6.2.3.cmml"><mi id="S3.E12.m1.5.5.1.1" xref="S3.E12.m1.5.5.1.1.cmml">𝐊</mi><mo id="S3.E12.m1.6.6.2.4.1" xref="S3.E12.m1.6.6.2.3.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S3.E12.m1.6.6.2.2" xref="S3.E12.m1.6.6.2.2.cmml">𝒢</mi></mrow><mo id="S3.E12.m1.15.15.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E12.m1.15.15.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">⊤</mo></msubsup><mo id="S3.E12.m1.15.15.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E12.m1.15.15.1.1.1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S3.E12.m1.15.15.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E12.m1.15.15.1.1.1.1.1.1.1.1.1.1.1.3.cmml">𝐕</mi></mrow><mo id="S3.E12.m1.15.15.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E12.m1.15.15.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E12.m1.15.15.1.1.1.1.1.1.1.3" xref="S3.E12.m1.15.15.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E12.m1.15.15.1.1.2.3" rspace="1.167em" xref="S3.E12.m1.15.15.1.1.3a.cmml">,</mo><mrow id="S3.E12.m1.15.15.1.1.2.2" xref="S3.E12.m1.15.15.1.1.2.2.cmml"><mi id="S3.E12.m1.15.15.1.1.2.2.3" xref="S3.E12.m1.15.15.1.1.2.2.3.cmml">𝐃</mi><mo id="S3.E12.m1.15.15.1.1.2.2.2" xref="S3.E12.m1.15.15.1.1.2.2.2.cmml">≔</mo><mrow id="S3.E12.m1.15.15.1.1.2.2.1" xref="S3.E12.m1.15.15.1.1.2.2.1.cmml"><msub id="S3.E12.m1.15.15.1.1.2.2.1.3" xref="S3.E12.m1.15.15.1.1.2.2.1.3.cmml"><mover accent="true" id="S3.E12.m1.15.15.1.1.2.2.1.3.2" xref="S3.E12.m1.15.15.1.1.2.2.1.3.2.cmml"><mi id="S3.E12.m1.15.15.1.1.2.2.1.3.2.2" xref="S3.E12.m1.15.15.1.1.2.2.1.3.2.2.cmml">𝚽</mi><mo id="S3.E12.m1.15.15.1.1.2.2.1.3.2.1" xref="S3.E12.m1.15.15.1.1.2.2.1.3.2.1.cmml">^</mo></mover><mrow id="S3.E12.m1.8.8.2.4" xref="S3.E12.m1.8.8.2.3.cmml"><mi id="S3.E12.m1.7.7.1.1" xref="S3.E12.m1.7.7.1.1.cmml">𝐐</mi><mo id="S3.E12.m1.8.8.2.4.1" xref="S3.E12.m1.8.8.2.3.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S3.E12.m1.8.8.2.2" xref="S3.E12.m1.8.8.2.2.cmml">𝒢</mi></mrow></msub><mo id="S3.E12.m1.15.15.1.1.2.2.1.2" xref="S3.E12.m1.15.15.1.1.2.2.1.2.cmml">⁢</mo><mrow id="S3.E12.m1.15.15.1.1.2.2.1.1.1" xref="S3.E12.m1.15.15.1.1.2.2.1.1.1.1.cmml"><mo id="S3.E12.m1.15.15.1.1.2.2.1.1.1.2" xref="S3.E12.m1.15.15.1.1.2.2.1.1.1.1.cmml">(</mo><mrow id="S3.E12.m1.15.15.1.1.2.2.1.1.1.1" xref="S3.E12.m1.15.15.1.1.2.2.1.1.1.1.cmml"><msubsup id="S3.E12.m1.15.15.1.1.2.2.1.1.1.1.2" xref="S3.E12.m1.15.15.1.1.2.2.1.1.1.1.2.cmml"><mover accent="true" id="S3.E12.m1.15.15.1.1.2.2.1.1.1.1.2.2.2" xref="S3.E12.m1.15.15.1.1.2.2.1.1.1.1.2.2.2.cmml"><mi id="S3.E12.m1.15.15.1.1.2.2.1.1.1.1.2.2.2.2" xref="S3.E12.m1.15.15.1.1.2.2.1.1.1.1.2.2.2.2.cmml">𝚽</mi><mo id="S3.E12.m1.15.15.1.1.2.2.1.1.1.1.2.2.2.1" xref="S3.E12.m1.15.15.1.1.2.2.1.1.1.1.2.2.2.1.cmml">^</mo></mover><mrow id="S3.E12.m1.10.10.2.4" xref="S3.E12.m1.10.10.2.3.cmml"><mi id="S3.E12.m1.9.9.1.1" xref="S3.E12.m1.9.9.1.1.cmml">𝐊</mi><mo id="S3.E12.m1.10.10.2.4.1" xref="S3.E12.m1.10.10.2.3.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S3.E12.m1.10.10.2.2" xref="S3.E12.m1.10.10.2.2.cmml">𝒢</mi></mrow><mo id="S3.E12.m1.15.15.1.1.2.2.1.1.1.1.2.3" xref="S3.E12.m1.15.15.1.1.2.2.1.1.1.1.2.3.cmml">⊤</mo></msubsup><mo id="S3.E12.m1.15.15.1.1.2.2.1.1.1.1.1" xref="S3.E12.m1.15.15.1.1.2.2.1.1.1.1.1.cmml">⁢</mo><msub id="S3.E12.m1.15.15.1.1.2.2.1.1.1.1.3" xref="S3.E12.m1.15.15.1.1.2.2.1.1.1.1.3.cmml"><mn id="S3.E12.m1.15.15.1.1.2.2.1.1.1.1.3.2" xref="S3.E12.m1.15.15.1.1.2.2.1.1.1.1.3.2.cmml">𝟏</mn><mi id="S3.E12.m1.15.15.1.1.2.2.1.1.1.1.3.3" xref="S3.E12.m1.15.15.1.1.2.2.1.1.1.1.3.3.cmml">N</mi></msub></mrow><mo id="S3.E12.m1.15.15.1.1.2.2.1.1.1.3" xref="S3.E12.m1.15.15.1.1.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E12.m1.15.15.1.2" lspace="0em">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E12.m1.15b"><apply id="S3.E12.m1.15.15.1.1.3.cmml" xref="S3.E12.m1.15.15.1.1.2"><csymbol cd="ambiguous" id="S3.E12.m1.15.15.1.1.3a.cmml" xref="S3.E12.m1.15.15.1.1.2.3">formulae-sequence</csymbol><apply id="S3.E12.m1.15.15.1.1.1.1.cmml" xref="S3.E12.m1.15.15.1.1.1.1"><ci id="S3.E12.m1.15.15.1.1.1.1.2.cmml" xref="S3.E12.m1.15.15.1.1.1.1.2">≔</ci><apply id="S3.E12.m1.15.15.1.1.1.1.3.cmml" xref="S3.E12.m1.15.15.1.1.1.1.3"><times id="S3.E12.m1.15.15.1.1.1.1.3.1.cmml" xref="S3.E12.m1.15.15.1.1.1.1.3.1"></times><apply id="S3.E12.m1.15.15.1.1.1.1.3.2.cmml" xref="S3.E12.m1.15.15.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E12.m1.15.15.1.1.1.1.3.2.1.cmml" xref="S3.E12.m1.15.15.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E12.m1.15.15.1.1.1.1.3.2.2a.cmml" xref="S3.E12.m1.15.15.1.1.1.1.3.2.2"><mtext id="S3.E12.m1.15.15.1.1.1.1.3.2.2.cmml" xref="S3.E12.m1.15.15.1.1.1.1.3.2.2">Att</mtext></ci><list id="S3.E12.m1.2.2.2.3.cmml" xref="S3.E12.m1.2.2.2.4"><ci id="S3.E12.m1.1.1.1.1a.cmml" xref="S3.E12.m1.1.1.1.1"><mtext id="S3.E12.m1.1.1.1.1.cmml" mathsize="70%" xref="S3.E12.m1.1.1.1.1">LR</mtext></ci><apply id="S3.E12.m1.2.2.2.2.cmml" xref="S3.E12.m1.2.2.2.2"><ci id="S3.E12.m1.2.2.2.2.1.cmml" xref="S3.E12.m1.2.2.2.2.1">^</ci><ci id="S3.E12.m1.2.2.2.2.2.cmml" xref="S3.E12.m1.2.2.2.2.2">𝐌</ci></apply></list></apply><vector id="S3.E12.m1.15.15.1.1.1.1.3.3.1.cmml" xref="S3.E12.m1.15.15.1.1.1.1.3.3.2"><ci id="S3.E12.m1.11.11.cmml" xref="S3.E12.m1.11.11">𝐐</ci><ci id="S3.E12.m1.12.12.cmml" xref="S3.E12.m1.12.12">𝐊</ci><ci id="S3.E12.m1.13.13.cmml" xref="S3.E12.m1.13.13">𝐕</ci><ci id="S3.E12.m1.14.14.cmml" xref="S3.E12.m1.14.14">𝒢</ci></vector></apply><apply id="S3.E12.m1.15.15.1.1.1.1.1.cmml" xref="S3.E12.m1.15.15.1.1.1.1.1"><times id="S3.E12.m1.15.15.1.1.1.1.1.2.cmml" xref="S3.E12.m1.15.15.1.1.1.1.1.2"></times><apply id="S3.E12.m1.15.15.1.1.1.1.1.3.cmml" xref="S3.E12.m1.15.15.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E12.m1.15.15.1.1.1.1.1.3.1.cmml" xref="S3.E12.m1.15.15.1.1.1.1.1.3">superscript</csymbol><ci id="S3.E12.m1.15.15.1.1.1.1.1.3.2.cmml" xref="S3.E12.m1.15.15.1.1.1.1.1.3.2">𝐃</ci><apply id="S3.E12.m1.15.15.1.1.1.1.1.3.3.cmml" xref="S3.E12.m1.15.15.1.1.1.1.1.3.3"><minus id="S3.E12.m1.15.15.1.1.1.1.1.3.3.1.cmml" xref="S3.E12.m1.15.15.1.1.1.1.1.3.3"></minus><cn id="S3.E12.m1.15.15.1.1.1.1.1.3.3.2.cmml" type="integer" xref="S3.E12.m1.15.15.1.1.1.1.1.3.3.2">1</cn></apply></apply><apply id="S3.E12.m1.15.15.1.1.1.1.1.1.1.1.cmml" xref="S3.E12.m1.15.15.1.1.1.1.1.1.1"><times id="S3.E12.m1.15.15.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E12.m1.15.15.1.1.1.1.1.1.1.1.2"></times><apply id="S3.E12.m1.15.15.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E12.m1.15.15.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E12.m1.15.15.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E12.m1.15.15.1.1.1.1.1.1.1.1.3">subscript</csymbol><apply id="S3.E12.m1.15.15.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E12.m1.15.15.1.1.1.1.1.1.1.1.3.2"><ci id="S3.E12.m1.15.15.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E12.m1.15.15.1.1.1.1.1.1.1.1.3.2.1">^</ci><ci id="S3.E12.m1.15.15.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E12.m1.15.15.1.1.1.1.1.1.1.1.3.2.2">𝚽</ci></apply><list id="S3.E12.m1.4.4.2.3.cmml" xref="S3.E12.m1.4.4.2.4"><ci id="S3.E12.m1.3.3.1.1.cmml" xref="S3.E12.m1.3.3.1.1">𝐐</ci><ci id="S3.E12.m1.4.4.2.2.cmml" xref="S3.E12.m1.4.4.2.2">𝒢</ci></list></apply><apply id="S3.E12.m1.15.15.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E12.m1.15.15.1.1.1.1.1.1.1.1.1.1"><times id="S3.E12.m1.15.15.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E12.m1.15.15.1.1.1.1.1.1.1.1.1.1.1.1"></times><apply id="S3.E12.m1.15.15.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E12.m1.15.15.1.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E12.m1.15.15.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E12.m1.15.15.1.1.1.1.1.1.1.1.1.1.1.2">superscript</csymbol><apply id="S3.E12.m1.15.15.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E12.m1.15.15.1.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E12.m1.15.15.1.1.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E12.m1.15.15.1.1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><apply id="S3.E12.m1.15.15.1.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E12.m1.15.15.1.1.1.1.1.1.1.1.1.1.1.2.2.2"><ci id="S3.E12.m1.15.15.1.1.1.1.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S3.E12.m1.15.15.1.1.1.1.1.1.1.1.1.1.1.2.2.2.1">^</ci><ci id="S3.E12.m1.15.15.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E12.m1.15.15.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2">𝚽</ci></apply><list id="S3.E12.m1.6.6.2.3.cmml" xref="S3.E12.m1.6.6.2.4"><ci id="S3.E12.m1.5.5.1.1.cmml" xref="S3.E12.m1.5.5.1.1">𝐊</ci><ci id="S3.E12.m1.6.6.2.2.cmml" xref="S3.E12.m1.6.6.2.2">𝒢</ci></list></apply><csymbol cd="latexml" id="S3.E12.m1.15.15.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E12.m1.15.15.1.1.1.1.1.1.1.1.1.1.1.2.3">top</csymbol></apply><ci id="S3.E12.m1.15.15.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E12.m1.15.15.1.1.1.1.1.1.1.1.1.1.1.3">𝐕</ci></apply></apply></apply></apply><apply id="S3.E12.m1.15.15.1.1.2.2.cmml" xref="S3.E12.m1.15.15.1.1.2.2"><ci id="S3.E12.m1.15.15.1.1.2.2.2.cmml" xref="S3.E12.m1.15.15.1.1.2.2.2">≔</ci><ci id="S3.E12.m1.15.15.1.1.2.2.3.cmml" xref="S3.E12.m1.15.15.1.1.2.2.3">𝐃</ci><apply id="S3.E12.m1.15.15.1.1.2.2.1.cmml" xref="S3.E12.m1.15.15.1.1.2.2.1"><times id="S3.E12.m1.15.15.1.1.2.2.1.2.cmml" xref="S3.E12.m1.15.15.1.1.2.2.1.2"></times><apply id="S3.E12.m1.15.15.1.1.2.2.1.3.cmml" xref="S3.E12.m1.15.15.1.1.2.2.1.3"><csymbol cd="ambiguous" id="S3.E12.m1.15.15.1.1.2.2.1.3.1.cmml" xref="S3.E12.m1.15.15.1.1.2.2.1.3">subscript</csymbol><apply id="S3.E12.m1.15.15.1.1.2.2.1.3.2.cmml" xref="S3.E12.m1.15.15.1.1.2.2.1.3.2"><ci id="S3.E12.m1.15.15.1.1.2.2.1.3.2.1.cmml" xref="S3.E12.m1.15.15.1.1.2.2.1.3.2.1">^</ci><ci id="S3.E12.m1.15.15.1.1.2.2.1.3.2.2.cmml" xref="S3.E12.m1.15.15.1.1.2.2.1.3.2.2">𝚽</ci></apply><list id="S3.E12.m1.8.8.2.3.cmml" xref="S3.E12.m1.8.8.2.4"><ci id="S3.E12.m1.7.7.1.1.cmml" xref="S3.E12.m1.7.7.1.1">𝐐</ci><ci id="S3.E12.m1.8.8.2.2.cmml" xref="S3.E12.m1.8.8.2.2">𝒢</ci></list></apply><apply id="S3.E12.m1.15.15.1.1.2.2.1.1.1.1.cmml" xref="S3.E12.m1.15.15.1.1.2.2.1.1.1"><times id="S3.E12.m1.15.15.1.1.2.2.1.1.1.1.1.cmml" xref="S3.E12.m1.15.15.1.1.2.2.1.1.1.1.1"></times><apply id="S3.E12.m1.15.15.1.1.2.2.1.1.1.1.2.cmml" xref="S3.E12.m1.15.15.1.1.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E12.m1.15.15.1.1.2.2.1.1.1.1.2.1.cmml" xref="S3.E12.m1.15.15.1.1.2.2.1.1.1.1.2">superscript</csymbol><apply id="S3.E12.m1.15.15.1.1.2.2.1.1.1.1.2.2.cmml" xref="S3.E12.m1.15.15.1.1.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E12.m1.15.15.1.1.2.2.1.1.1.1.2.2.1.cmml" xref="S3.E12.m1.15.15.1.1.2.2.1.1.1.1.2">subscript</csymbol><apply id="S3.E12.m1.15.15.1.1.2.2.1.1.1.1.2.2.2.cmml" xref="S3.E12.m1.15.15.1.1.2.2.1.1.1.1.2.2.2"><ci id="S3.E12.m1.15.15.1.1.2.2.1.1.1.1.2.2.2.1.cmml" xref="S3.E12.m1.15.15.1.1.2.2.1.1.1.1.2.2.2.1">^</ci><ci id="S3.E12.m1.15.15.1.1.2.2.1.1.1.1.2.2.2.2.cmml" xref="S3.E12.m1.15.15.1.1.2.2.1.1.1.1.2.2.2.2">𝚽</ci></apply><list id="S3.E12.m1.10.10.2.3.cmml" xref="S3.E12.m1.10.10.2.4"><ci id="S3.E12.m1.9.9.1.1.cmml" xref="S3.E12.m1.9.9.1.1">𝐊</ci><ci id="S3.E12.m1.10.10.2.2.cmml" xref="S3.E12.m1.10.10.2.2">𝒢</ci></list></apply><csymbol cd="latexml" id="S3.E12.m1.15.15.1.1.2.2.1.1.1.1.2.3.cmml" xref="S3.E12.m1.15.15.1.1.2.2.1.1.1.1.2.3">top</csymbol></apply><apply id="S3.E12.m1.15.15.1.1.2.2.1.1.1.1.3.cmml" xref="S3.E12.m1.15.15.1.1.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E12.m1.15.15.1.1.2.2.1.1.1.1.3.1.cmml" xref="S3.E12.m1.15.15.1.1.2.2.1.1.1.1.3">subscript</csymbol><cn id="S3.E12.m1.15.15.1.1.2.2.1.1.1.1.3.2.cmml" type="integer" xref="S3.E12.m1.15.15.1.1.2.2.1.1.1.1.3.2">1</cn><ci id="S3.E12.m1.15.15.1.1.2.2.1.1.1.1.3.3.cmml" xref="S3.E12.m1.15.15.1.1.2.2.1.1.1.1.3.3">𝑁</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E12.m1.15c">\textrm{Att}_{\textrm{LR},\widehat{\mathbf{M}}}(\mathbf{Q},\mathbf{K},\mathbf{%
V},\mathcal{G})\coloneqq\mathbf{D}^{-1}\left(\widehat{\mathbf{\Phi}}_{\mathbf{%
Q},\mathcal{G}}\left(\widehat{\mathbf{\Phi}}_{\mathbf{K},\mathcal{G}}^{\top}%
\mathbf{V}\right)\right),\quad\mathbf{D}\coloneqq\widehat{\mathbf{\Phi}}_{%
\mathbf{Q},\mathcal{G}}\left(\widehat{\mathbf{\Phi}}_{\mathbf{K},\mathcal{G}}^%
{\top}\mathbf{1}_{N}\right).\vspace{-1mm}</annotation><annotation encoding="application/x-llamapun" id="S3.E12.m1.15d">Att start_POSTSUBSCRIPT LR , over^ start_ARG bold_M end_ARG end_POSTSUBSCRIPT ( bold_Q , bold_K , bold_V , caligraphic_G ) ≔ bold_D start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ( over^ start_ARG bold_Φ end_ARG start_POSTSUBSCRIPT bold_Q , caligraphic_G end_POSTSUBSCRIPT ( over^ start_ARG bold_Φ end_ARG start_POSTSUBSCRIPT bold_K , caligraphic_G end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT bold_V ) ) , bold_D ≔ over^ start_ARG bold_Φ end_ARG start_POSTSUBSCRIPT bold_Q , caligraphic_G end_POSTSUBSCRIPT ( over^ start_ARG bold_Φ end_ARG start_POSTSUBSCRIPT bold_K , caligraphic_G end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT bold_1 start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(12)</span></td>
</tr></tbody>
</table>
</div>
</div>
</div>
</div>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Experiments</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S4.p1">
<p class="ltx_p" id="S4.p1.1">In this section, we test our algorithms for topological masking with GRFs.
We consider data modalities with different graph topologies: images and point clouds.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_figure ltx_align_floatright" id="S4.F3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="516" id="S4.F3.g1" src="https://arxiv.org/html/2410.03462v1/x1.png" width="665">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>Number of FLOPs vs. number of graph nodes for softmax attention, linear attention, and linear attention with GRF topological masking (<span class="ltx_text" id="S4.F3.2.1" style="color:#0000FF;">ours</span>).</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S4.p2">
<p class="ltx_p" id="S4.p2.11"><span class="ltx_text ltx_font_bold" id="S4.p2.11.1">Time complexity.</span>
For a hardware-agnostic comparison, we first compute the total number of FLOPs for evaluating (i) unmasked softmax, (ii) unmasked linear and (iii) GRF-masked linear attention for graphs of different sizes <math alttext="N" class="ltx_Math" display="inline" id="S4.p2.1.m1.1"><semantics id="S4.p2.1.m1.1a"><mi id="S4.p2.1.m1.1.1" xref="S4.p2.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S4.p2.1.m1.1b"><ci id="S4.p2.1.m1.1.1.cmml" xref="S4.p2.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.1.m1.1c">N</annotation><annotation encoding="application/x-llamapun" id="S4.p2.1.m1.1d">italic_N</annotation></semantics></math>.
Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#S4.F3" title="Figure 3 ‣ 4 Experiments ‣ Linear Transformer Topological Masking with Graph Random Features"><span class="ltx_text ltx_ref_tag">3</span></a> shows the results.
For concreteness we use <math alttext="1" class="ltx_Math" display="inline" id="S4.p2.2.m2.1"><semantics id="S4.p2.2.m2.1a"><mn id="S4.p2.2.m2.1.1" xref="S4.p2.2.m2.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="S4.p2.2.m2.1b"><cn id="S4.p2.2.m2.1.1.cmml" type="integer" xref="S4.p2.2.m2.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.2.m2.1c">1</annotation><annotation encoding="application/x-llamapun" id="S4.p2.2.m2.1d">1</annotation></semantics></math>-dimensional grid graphs, though the theoretical results in Sec.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#S3.SS4" title="3.4 Novel theoretical results for GRFs: sharp estimators with sparse features ‣ 3 Towards linear topological masking ‣ Linear Transformer Topological Masking with Graph Random Features"><span class="ltx_text ltx_ref_tag">3.4</span></a> are independent of <math alttext="\mathcal{G}" class="ltx_Math" display="inline" id="S4.p2.3.m3.1"><semantics id="S4.p2.3.m3.1a"><mi class="ltx_font_mathcaligraphic" id="S4.p2.3.m3.1.1" xref="S4.p2.3.m3.1.1.cmml">𝒢</mi><annotation-xml encoding="MathML-Content" id="S4.p2.3.m3.1b"><ci id="S4.p2.3.m3.1.1.cmml" xref="S4.p2.3.m3.1.1">𝒢</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.3.m3.1c">\mathcal{G}</annotation><annotation encoding="application/x-llamapun" id="S4.p2.3.m3.1d">caligraphic_G</annotation></semantics></math> (provided <math alttext="c" class="ltx_Math" display="inline" id="S4.p2.4.m4.1"><semantics id="S4.p2.4.m4.1a"><mi id="S4.p2.4.m4.1.1" xref="S4.p2.4.m4.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S4.p2.4.m4.1b"><ci id="S4.p2.4.m4.1.1.cmml" xref="S4.p2.4.m4.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.4.m4.1c">c</annotation><annotation encoding="application/x-llamapun" id="S4.p2.4.m4.1d">italic_c</annotation></semantics></math> is upper bounded).
We take <math alttext="n=4" class="ltx_Math" display="inline" id="S4.p2.5.m5.1"><semantics id="S4.p2.5.m5.1a"><mrow id="S4.p2.5.m5.1.1" xref="S4.p2.5.m5.1.1.cmml"><mi id="S4.p2.5.m5.1.1.2" xref="S4.p2.5.m5.1.1.2.cmml">n</mi><mo id="S4.p2.5.m5.1.1.1" xref="S4.p2.5.m5.1.1.1.cmml">=</mo><mn id="S4.p2.5.m5.1.1.3" xref="S4.p2.5.m5.1.1.3.cmml">4</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.p2.5.m5.1b"><apply id="S4.p2.5.m5.1.1.cmml" xref="S4.p2.5.m5.1.1"><eq id="S4.p2.5.m5.1.1.1.cmml" xref="S4.p2.5.m5.1.1.1"></eq><ci id="S4.p2.5.m5.1.1.2.cmml" xref="S4.p2.5.m5.1.1.2">𝑛</ci><cn id="S4.p2.5.m5.1.1.3.cmml" type="integer" xref="S4.p2.5.m5.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.5.m5.1c">n=4</annotation><annotation encoding="application/x-llamapun" id="S4.p2.5.m5.1d">italic_n = 4</annotation></semantics></math> random walkers per node with termination probability <math alttext="p_{\textrm{halt}}=0.5" class="ltx_Math" display="inline" id="S4.p2.6.m6.1"><semantics id="S4.p2.6.m6.1a"><mrow id="S4.p2.6.m6.1.1" xref="S4.p2.6.m6.1.1.cmml"><msub id="S4.p2.6.m6.1.1.2" xref="S4.p2.6.m6.1.1.2.cmml"><mi id="S4.p2.6.m6.1.1.2.2" xref="S4.p2.6.m6.1.1.2.2.cmml">p</mi><mtext id="S4.p2.6.m6.1.1.2.3" xref="S4.p2.6.m6.1.1.2.3a.cmml">halt</mtext></msub><mo id="S4.p2.6.m6.1.1.1" xref="S4.p2.6.m6.1.1.1.cmml">=</mo><mn id="S4.p2.6.m6.1.1.3" xref="S4.p2.6.m6.1.1.3.cmml">0.5</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.p2.6.m6.1b"><apply id="S4.p2.6.m6.1.1.cmml" xref="S4.p2.6.m6.1.1"><eq id="S4.p2.6.m6.1.1.1.cmml" xref="S4.p2.6.m6.1.1.1"></eq><apply id="S4.p2.6.m6.1.1.2.cmml" xref="S4.p2.6.m6.1.1.2"><csymbol cd="ambiguous" id="S4.p2.6.m6.1.1.2.1.cmml" xref="S4.p2.6.m6.1.1.2">subscript</csymbol><ci id="S4.p2.6.m6.1.1.2.2.cmml" xref="S4.p2.6.m6.1.1.2.2">𝑝</ci><ci id="S4.p2.6.m6.1.1.2.3a.cmml" xref="S4.p2.6.m6.1.1.2.3"><mtext id="S4.p2.6.m6.1.1.2.3.cmml" mathsize="70%" xref="S4.p2.6.m6.1.1.2.3">halt</mtext></ci></apply><cn id="S4.p2.6.m6.1.1.3.cmml" type="float" xref="S4.p2.6.m6.1.1.3">0.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.6.m6.1c">p_{\textrm{halt}}=0.5</annotation><annotation encoding="application/x-llamapun" id="S4.p2.6.m6.1d">italic_p start_POSTSUBSCRIPT halt end_POSTSUBSCRIPT = 0.5</annotation></semantics></math>.
The latent dimension is <math alttext="d=8" class="ltx_Math" display="inline" id="S4.p2.7.m7.1"><semantics id="S4.p2.7.m7.1a"><mrow id="S4.p2.7.m7.1.1" xref="S4.p2.7.m7.1.1.cmml"><mi id="S4.p2.7.m7.1.1.2" xref="S4.p2.7.m7.1.1.2.cmml">d</mi><mo id="S4.p2.7.m7.1.1.1" xref="S4.p2.7.m7.1.1.1.cmml">=</mo><mn id="S4.p2.7.m7.1.1.3" xref="S4.p2.7.m7.1.1.3.cmml">8</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.p2.7.m7.1b"><apply id="S4.p2.7.m7.1.1.cmml" xref="S4.p2.7.m7.1.1"><eq id="S4.p2.7.m7.1.1.1.cmml" xref="S4.p2.7.m7.1.1.1"></eq><ci id="S4.p2.7.m7.1.1.2.cmml" xref="S4.p2.7.m7.1.1.2">𝑑</ci><cn id="S4.p2.7.m7.1.1.3.cmml" type="integer" xref="S4.p2.7.m7.1.1.3">8</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.7.m7.1c">d=8</annotation><annotation encoding="application/x-llamapun" id="S4.p2.7.m7.1d">italic_d = 8</annotation></semantics></math> and the feature size is <math alttext="m=8" class="ltx_Math" display="inline" id="S4.p2.8.m8.1"><semantics id="S4.p2.8.m8.1a"><mrow id="S4.p2.8.m8.1.1" xref="S4.p2.8.m8.1.1.cmml"><mi id="S4.p2.8.m8.1.1.2" xref="S4.p2.8.m8.1.1.2.cmml">m</mi><mo id="S4.p2.8.m8.1.1.1" xref="S4.p2.8.m8.1.1.1.cmml">=</mo><mn id="S4.p2.8.m8.1.1.3" xref="S4.p2.8.m8.1.1.3.cmml">8</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.p2.8.m8.1b"><apply id="S4.p2.8.m8.1.1.cmml" xref="S4.p2.8.m8.1.1"><eq id="S4.p2.8.m8.1.1.1.cmml" xref="S4.p2.8.m8.1.1.1"></eq><ci id="S4.p2.8.m8.1.1.2.cmml" xref="S4.p2.8.m8.1.1.2">𝑚</ci><cn id="S4.p2.8.m8.1.1.3.cmml" type="integer" xref="S4.p2.8.m8.1.1.3">8</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.8.m8.1c">m=8</annotation><annotation encoding="application/x-llamapun" id="S4.p2.8.m8.1d">italic_m = 8</annotation></semantics></math>. In the masked case we show the <em class="ltx_emph ltx_font_italic" id="S4.p2.11.2">mean</em> number of FLOPs over <math alttext="10" class="ltx_Math" display="inline" id="S4.p2.9.m9.1"><semantics id="S4.p2.9.m9.1a"><mn id="S4.p2.9.m9.1.1" xref="S4.p2.9.m9.1.1.cmml">10</mn><annotation-xml encoding="MathML-Content" id="S4.p2.9.m9.1b"><cn id="S4.p2.9.m9.1.1.cmml" type="integer" xref="S4.p2.9.m9.1.1">10</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.9.m9.1c">10</annotation><annotation encoding="application/x-llamapun" id="S4.p2.9.m9.1d">10</annotation></semantics></math> seeds since GRF sparsity is itself a random variable.
As anticipated, the time complexity of our mechanism is <math alttext="\mathcal{O}(N)" class="ltx_Math" display="inline" id="S4.p2.10.m10.1"><semantics id="S4.p2.10.m10.1a"><mrow id="S4.p2.10.m10.1.2" xref="S4.p2.10.m10.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.p2.10.m10.1.2.2" xref="S4.p2.10.m10.1.2.2.cmml">𝒪</mi><mo id="S4.p2.10.m10.1.2.1" xref="S4.p2.10.m10.1.2.1.cmml">⁢</mo><mrow id="S4.p2.10.m10.1.2.3.2" xref="S4.p2.10.m10.1.2.cmml"><mo id="S4.p2.10.m10.1.2.3.2.1" stretchy="false" xref="S4.p2.10.m10.1.2.cmml">(</mo><mi id="S4.p2.10.m10.1.1" xref="S4.p2.10.m10.1.1.cmml">N</mi><mo id="S4.p2.10.m10.1.2.3.2.2" stretchy="false" xref="S4.p2.10.m10.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p2.10.m10.1b"><apply id="S4.p2.10.m10.1.2.cmml" xref="S4.p2.10.m10.1.2"><times id="S4.p2.10.m10.1.2.1.cmml" xref="S4.p2.10.m10.1.2.1"></times><ci id="S4.p2.10.m10.1.2.2.cmml" xref="S4.p2.10.m10.1.2.2">𝒪</ci><ci id="S4.p2.10.m10.1.1.cmml" xref="S4.p2.10.m10.1.1">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.10.m10.1c">\mathcal{O}(N)</annotation><annotation encoding="application/x-llamapun" id="S4.p2.10.m10.1d">caligraphic_O ( italic_N )</annotation></semantics></math>; there is a constant multiplicative cost for topological masking.
We clearly improve upon the time complexity of <math alttext="\mathcal{O}(N^{2})" class="ltx_Math" display="inline" id="S4.p2.11.m11.1"><semantics id="S4.p2.11.m11.1a"><mrow id="S4.p2.11.m11.1.1" xref="S4.p2.11.m11.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.p2.11.m11.1.1.3" xref="S4.p2.11.m11.1.1.3.cmml">𝒪</mi><mo id="S4.p2.11.m11.1.1.2" xref="S4.p2.11.m11.1.1.2.cmml">⁢</mo><mrow id="S4.p2.11.m11.1.1.1.1" xref="S4.p2.11.m11.1.1.1.1.1.cmml"><mo id="S4.p2.11.m11.1.1.1.1.2" stretchy="false" xref="S4.p2.11.m11.1.1.1.1.1.cmml">(</mo><msup id="S4.p2.11.m11.1.1.1.1.1" xref="S4.p2.11.m11.1.1.1.1.1.cmml"><mi id="S4.p2.11.m11.1.1.1.1.1.2" xref="S4.p2.11.m11.1.1.1.1.1.2.cmml">N</mi><mn id="S4.p2.11.m11.1.1.1.1.1.3" xref="S4.p2.11.m11.1.1.1.1.1.3.cmml">2</mn></msup><mo id="S4.p2.11.m11.1.1.1.1.3" stretchy="false" xref="S4.p2.11.m11.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p2.11.m11.1b"><apply id="S4.p2.11.m11.1.1.cmml" xref="S4.p2.11.m11.1.1"><times id="S4.p2.11.m11.1.1.2.cmml" xref="S4.p2.11.m11.1.1.2"></times><ci id="S4.p2.11.m11.1.1.3.cmml" xref="S4.p2.11.m11.1.1.3">𝒪</ci><apply id="S4.p2.11.m11.1.1.1.1.1.cmml" xref="S4.p2.11.m11.1.1.1.1"><csymbol cd="ambiguous" id="S4.p2.11.m11.1.1.1.1.1.1.cmml" xref="S4.p2.11.m11.1.1.1.1">superscript</csymbol><ci id="S4.p2.11.m11.1.1.1.1.1.2.cmml" xref="S4.p2.11.m11.1.1.1.1.1.2">𝑁</ci><cn id="S4.p2.11.m11.1.1.1.1.1.3.cmml" type="integer" xref="S4.p2.11.m11.1.1.1.1.1.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.11.m11.1c">\mathcal{O}(N^{2})</annotation><annotation encoding="application/x-llamapun" id="S4.p2.11.m11.1d">caligraphic_O ( italic_N start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT )</annotation></semantics></math> softmax attention.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S4.p3">
<p class="ltx_p" id="S4.p3.4"><span class="ltx_text ltx_font_bold" id="S4.p3.4.1">ViTs: grid graphs and image data.</span>
Next, we use our topological masking algorithm to improve the vision transformer <cite class="ltx_cite ltx_citemacro_citep">(ViT;  Dosovitskiy et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#bib.bib13" title="">2020</a>)</cite>.
The underlying graph <math alttext="\mathcal{G}" class="ltx_Math" display="inline" id="S4.p3.1.m1.1"><semantics id="S4.p3.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S4.p3.1.m1.1.1" xref="S4.p3.1.m1.1.1.cmml">𝒢</mi><annotation-xml encoding="MathML-Content" id="S4.p3.1.m1.1b"><ci id="S4.p3.1.m1.1.1.cmml" xref="S4.p3.1.m1.1.1">𝒢</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.1.m1.1c">\mathcal{G}</annotation><annotation encoding="application/x-llamapun" id="S4.p3.1.m1.1d">caligraphic_G</annotation></semantics></math> is a square grid of size <span class="ltx_text ltx_lst_identifier ltx_lstlisting ltx_font_typewriter" id="S4.p3.4.2">num_x_patches</span> <math alttext="\times" class="ltx_Math" display="inline" id="S4.p3.2.m2.1"><semantics id="S4.p3.2.m2.1a"><mo id="S4.p3.2.m2.1.1" xref="S4.p3.2.m2.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.p3.2.m2.1b"><times id="S4.p3.2.m2.1.1.cmml" xref="S4.p3.2.m2.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.2.m2.1c">\times</annotation><annotation encoding="application/x-llamapun" id="S4.p3.2.m2.1d">×</annotation></semantics></math> <span class="ltx_text ltx_lst_identifier ltx_lstlisting ltx_font_typewriter" id="S4.p3.4.3">num_y_patches</span>, with nodes connected by an edge if they are neighbours in <math alttext="x" class="ltx_Math" display="inline" id="S4.p3.3.m3.1"><semantics id="S4.p3.3.m3.1a"><mi id="S4.p3.3.m3.1.1" xref="S4.p3.3.m3.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S4.p3.3.m3.1b"><ci id="S4.p3.3.m3.1.1.cmml" xref="S4.p3.3.m3.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.3.m3.1c">x</annotation><annotation encoding="application/x-llamapun" id="S4.p3.3.m3.1d">italic_x</annotation></semantics></math> or <math alttext="y" class="ltx_Math" display="inline" id="S4.p3.4.m4.1"><semantics id="S4.p3.4.m4.1a"><mi id="S4.p3.4.m4.1.1" xref="S4.p3.4.m4.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S4.p3.4.m4.1b"><ci id="S4.p3.4.m4.1.1.cmml" xref="S4.p3.4.m4.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.4.m4.1c">y</annotation><annotation encoding="application/x-llamapun" id="S4.p3.4.m4.1d">italic_y</annotation></semantics></math>.
Since the graph is fixed, random walks can be pre-computed and frozen for each attention head and layer before training and inference. Full architectural and training details are in App.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#A3" title="Appendix C Further experiments and details ‣ Linear Transformer Topological Masking with Graph Random Features"><span class="ltx_text ltx_ref_tag">C</span></a>.
All our ViT models also endow tokens with learned additive absolute position embeddings.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="S4.p4">
<p class="ltx_p" id="S4.p4.8">Table <a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#S4.T1" title="Table 1 ‣ 4 Experiments ‣ Linear Transformer Topological Masking with Graph Random Features"><span class="ltx_text ltx_ref_tag">1</span></a> shows the final test accuracies for ImageNet <cite class="ltx_cite ltx_citemacro_citep">(Deng et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#bib.bib11" title="">2009</a>)</cite>, iNaturalist2021 <cite class="ltx_cite ltx_citemacro_citep">(Horn et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#bib.bib15" title="">2018</a>)</cite> and Places365 <cite class="ltx_cite ltx_citemacro_citep">(Zhou et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#bib.bib45" title="">2018</a>)</cite>.
For the <em class="ltx_emph ltx_font_italic" id="S4.p4.8.1">slow</em> (superlinear) variants, we include (i) unmasked softmax and (ii) Toeplitz-masked linear <cite class="ltx_cite ltx_citemacro_citep">(Choromanski et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#bib.bib7" title="">2022</a>)</cite> attention.
Toeplitz can only be used for this specific, structured graph topology.
We also include (iii) <math alttext="\mathbf{M}_{\alpha}(\mathcal{G})" class="ltx_Math" display="inline" id="S4.p4.1.m1.1"><semantics id="S4.p4.1.m1.1a"><mrow id="S4.p4.1.m1.1.2" xref="S4.p4.1.m1.1.2.cmml"><msub id="S4.p4.1.m1.1.2.2" xref="S4.p4.1.m1.1.2.2.cmml"><mi id="S4.p4.1.m1.1.2.2.2" xref="S4.p4.1.m1.1.2.2.2.cmml">𝐌</mi><mi id="S4.p4.1.m1.1.2.2.3" xref="S4.p4.1.m1.1.2.2.3.cmml">α</mi></msub><mo id="S4.p4.1.m1.1.2.1" xref="S4.p4.1.m1.1.2.1.cmml">⁢</mo><mrow id="S4.p4.1.m1.1.2.3.2" xref="S4.p4.1.m1.1.2.cmml"><mo id="S4.p4.1.m1.1.2.3.2.1" stretchy="false" xref="S4.p4.1.m1.1.2.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S4.p4.1.m1.1.1" xref="S4.p4.1.m1.1.1.cmml">𝒢</mi><mo id="S4.p4.1.m1.1.2.3.2.2" stretchy="false" xref="S4.p4.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p4.1.m1.1b"><apply id="S4.p4.1.m1.1.2.cmml" xref="S4.p4.1.m1.1.2"><times id="S4.p4.1.m1.1.2.1.cmml" xref="S4.p4.1.m1.1.2.1"></times><apply id="S4.p4.1.m1.1.2.2.cmml" xref="S4.p4.1.m1.1.2.2"><csymbol cd="ambiguous" id="S4.p4.1.m1.1.2.2.1.cmml" xref="S4.p4.1.m1.1.2.2">subscript</csymbol><ci id="S4.p4.1.m1.1.2.2.2.cmml" xref="S4.p4.1.m1.1.2.2.2">𝐌</ci><ci id="S4.p4.1.m1.1.2.2.3.cmml" xref="S4.p4.1.m1.1.2.2.3">𝛼</ci></apply><ci id="S4.p4.1.m1.1.1.cmml" xref="S4.p4.1.m1.1.1">𝒢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.1.m1.1c">\mathbf{M}_{\alpha}(\mathcal{G})</annotation><annotation encoding="application/x-llamapun" id="S4.p4.1.m1.1d">bold_M start_POSTSUBSCRIPT italic_α end_POSTSUBSCRIPT ( caligraphic_G )</annotation></semantics></math>-masked linear, which takes an explicit power series in <math alttext="\mathbf{W}" class="ltx_Math" display="inline" id="S4.p4.2.m2.1"><semantics id="S4.p4.2.m2.1a"><mi id="S4.p4.2.m2.1.1" xref="S4.p4.2.m2.1.1.cmml">𝐖</mi><annotation-xml encoding="MathML-Content" id="S4.p4.2.m2.1b"><ci id="S4.p4.2.m2.1.1.cmml" xref="S4.p4.2.m2.1.1">𝐖</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.2.m2.1c">\mathbf{W}</annotation><annotation encoding="application/x-llamapun" id="S4.p4.2.m2.1d">bold_W</annotation></semantics></math> (Eq.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#S3.E4" title="In 3.1 Graph node kernels as topological masks ‣ 3 Towards linear topological masking ‣ Linear Transformer Topological Masking with Graph Random Features"><span class="ltx_text ltx_ref_tag">4</span></a>) to directly modulate the <math alttext="N\times N" class="ltx_Math" display="inline" id="S4.p4.3.m3.1"><semantics id="S4.p4.3.m3.1a"><mrow id="S4.p4.3.m3.1.1" xref="S4.p4.3.m3.1.1.cmml"><mi id="S4.p4.3.m3.1.1.2" xref="S4.p4.3.m3.1.1.2.cmml">N</mi><mo id="S4.p4.3.m3.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.p4.3.m3.1.1.1.cmml">×</mo><mi id="S4.p4.3.m3.1.1.3" xref="S4.p4.3.m3.1.1.3.cmml">N</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.p4.3.m3.1b"><apply id="S4.p4.3.m3.1.1.cmml" xref="S4.p4.3.m3.1.1"><times id="S4.p4.3.m3.1.1.1.cmml" xref="S4.p4.3.m3.1.1.1"></times><ci id="S4.p4.3.m3.1.1.2.cmml" xref="S4.p4.3.m3.1.1.2">𝑁</ci><ci id="S4.p4.3.m3.1.1.3.cmml" xref="S4.p4.3.m3.1.1.3">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.3.m3.1c">N\times N</annotation><annotation encoding="application/x-llamapun" id="S4.p4.3.m3.1d">italic_N × italic_N</annotation></semantics></math> attention matrix.
This is equal to our Monte Carlo GRFs algorithm in the <math alttext="n\to\infty" class="ltx_Math" display="inline" id="S4.p4.4.m4.1"><semantics id="S4.p4.4.m4.1a"><mrow id="S4.p4.4.m4.1.1" xref="S4.p4.4.m4.1.1.cmml"><mi id="S4.p4.4.m4.1.1.2" xref="S4.p4.4.m4.1.1.2.cmml">n</mi><mo id="S4.p4.4.m4.1.1.1" stretchy="false" xref="S4.p4.4.m4.1.1.1.cmml">→</mo><mi id="S4.p4.4.m4.1.1.3" mathvariant="normal" xref="S4.p4.4.m4.1.1.3.cmml">∞</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.p4.4.m4.1b"><apply id="S4.p4.4.m4.1.1.cmml" xref="S4.p4.4.m4.1.1"><ci id="S4.p4.4.m4.1.1.1.cmml" xref="S4.p4.4.m4.1.1.1">→</ci><ci id="S4.p4.4.m4.1.1.2.cmml" xref="S4.p4.4.m4.1.1.2">𝑛</ci><infinity id="S4.p4.4.m4.1.1.3.cmml" xref="S4.p4.4.m4.1.1.3"></infinity></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.4.m4.1c">n\to\infty</annotation><annotation encoding="application/x-llamapun" id="S4.p4.4.m4.1d">italic_n → ∞</annotation></semantics></math> limit, so it indicates the asymptotic performance of GRFs with very many random walkers.
For the <em class="ltx_emph ltx_font_italic" id="S4.p4.8.2">fast</em> (linear) variants, we include (iv) unmasked linear and (v) GRF-masked linear attention.
Our algorithm gives strong improvements above the unmasked baseline, by <math alttext="\mathbf{+3.7\%}" class="ltx_Math" display="inline" id="S4.p4.5.m5.1"><semantics id="S4.p4.5.m5.1a"><mrow id="S4.p4.5.m5.1.1" xref="S4.p4.5.m5.1.1.cmml"><mo id="S4.p4.5.m5.1.1a" xref="S4.p4.5.m5.1.1.cmml">+</mo><mrow id="S4.p4.5.m5.1.1.2" xref="S4.p4.5.m5.1.1.2.cmml"><mn class="ltx_mathvariant_bold" id="S4.p4.5.m5.1.1.2.2" mathvariant="bold" xref="S4.p4.5.m5.1.1.2.2.cmml">3.7</mn><mo id="S4.p4.5.m5.1.1.2.1" xref="S4.p4.5.m5.1.1.2.1.cmml">%</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p4.5.m5.1b"><apply id="S4.p4.5.m5.1.1.cmml" xref="S4.p4.5.m5.1.1"><plus id="S4.p4.5.m5.1.1.1.cmml" xref="S4.p4.5.m5.1.1"></plus><apply id="S4.p4.5.m5.1.1.2.cmml" xref="S4.p4.5.m5.1.1.2"><csymbol cd="latexml" id="S4.p4.5.m5.1.1.2.1.cmml" xref="S4.p4.5.m5.1.1.2.1">percent</csymbol><cn id="S4.p4.5.m5.1.1.2.2.cmml" type="float" xref="S4.p4.5.m5.1.1.2.2">3.7</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.5.m5.1c">\mathbf{+3.7\%}</annotation><annotation encoding="application/x-llamapun" id="S4.p4.5.m5.1d">+ bold_3.7 %</annotation></semantics></math>, <math alttext="\mathbf{+2.2\%}" class="ltx_Math" display="inline" id="S4.p4.6.m6.1"><semantics id="S4.p4.6.m6.1a"><mrow id="S4.p4.6.m6.1.1" xref="S4.p4.6.m6.1.1.cmml"><mo id="S4.p4.6.m6.1.1a" xref="S4.p4.6.m6.1.1.cmml">+</mo><mrow id="S4.p4.6.m6.1.1.2" xref="S4.p4.6.m6.1.1.2.cmml"><mn class="ltx_mathvariant_bold" id="S4.p4.6.m6.1.1.2.2" mathvariant="bold" xref="S4.p4.6.m6.1.1.2.2.cmml">2.2</mn><mo id="S4.p4.6.m6.1.1.2.1" xref="S4.p4.6.m6.1.1.2.1.cmml">%</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p4.6.m6.1b"><apply id="S4.p4.6.m6.1.1.cmml" xref="S4.p4.6.m6.1.1"><plus id="S4.p4.6.m6.1.1.1.cmml" xref="S4.p4.6.m6.1.1"></plus><apply id="S4.p4.6.m6.1.1.2.cmml" xref="S4.p4.6.m6.1.1.2"><csymbol cd="latexml" id="S4.p4.6.m6.1.1.2.1.cmml" xref="S4.p4.6.m6.1.1.2.1">percent</csymbol><cn id="S4.p4.6.m6.1.1.2.2.cmml" type="float" xref="S4.p4.6.m6.1.1.2.2">2.2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.6.m6.1c">\mathbf{+2.2\%}</annotation><annotation encoding="application/x-llamapun" id="S4.p4.6.m6.1d">+ bold_2.2 %</annotation></semantics></math> and <math alttext="\mathbf{+0.5\%}" class="ltx_Math" display="inline" id="S4.p4.7.m7.1"><semantics id="S4.p4.7.m7.1a"><mrow id="S4.p4.7.m7.1.1" xref="S4.p4.7.m7.1.1.cmml"><mo id="S4.p4.7.m7.1.1a" xref="S4.p4.7.m7.1.1.cmml">+</mo><mrow id="S4.p4.7.m7.1.1.2" xref="S4.p4.7.m7.1.1.2.cmml"><mn class="ltx_mathvariant_bold" id="S4.p4.7.m7.1.1.2.2" mathvariant="bold" xref="S4.p4.7.m7.1.1.2.2.cmml">0.5</mn><mo id="S4.p4.7.m7.1.1.2.1" xref="S4.p4.7.m7.1.1.2.1.cmml">%</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p4.7.m7.1b"><apply id="S4.p4.7.m7.1.1.cmml" xref="S4.p4.7.m7.1.1"><plus id="S4.p4.7.m7.1.1.1.cmml" xref="S4.p4.7.m7.1.1"></plus><apply id="S4.p4.7.m7.1.1.2.cmml" xref="S4.p4.7.m7.1.1.2"><csymbol cd="latexml" id="S4.p4.7.m7.1.1.2.1.cmml" xref="S4.p4.7.m7.1.1.2.1">percent</csymbol><cn id="S4.p4.7.m7.1.1.2.2.cmml" type="float" xref="S4.p4.7.m7.1.1.2.2">0.5</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.7.m7.1c">\mathbf{+0.5\%}</annotation><annotation encoding="application/x-llamapun" id="S4.p4.7.m7.1d">+ bold_0.5 %</annotation></semantics></math> respectively.
Remarkably, it is competitive with much more expensive variants: GRFs often match or beat Toeplitz.
For ImageNet and iNaturalist2021, it even substantially narrows the gap with <math alttext="\mathcal{O}(N^{2})" class="ltx_Math" display="inline" id="S4.p4.8.m8.1"><semantics id="S4.p4.8.m8.1a"><mrow id="S4.p4.8.m8.1.1" xref="S4.p4.8.m8.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.p4.8.m8.1.1.3" xref="S4.p4.8.m8.1.1.3.cmml">𝒪</mi><mo id="S4.p4.8.m8.1.1.2" xref="S4.p4.8.m8.1.1.2.cmml">⁢</mo><mrow id="S4.p4.8.m8.1.1.1.1" xref="S4.p4.8.m8.1.1.1.1.1.cmml"><mo id="S4.p4.8.m8.1.1.1.1.2" stretchy="false" xref="S4.p4.8.m8.1.1.1.1.1.cmml">(</mo><msup id="S4.p4.8.m8.1.1.1.1.1" xref="S4.p4.8.m8.1.1.1.1.1.cmml"><mi id="S4.p4.8.m8.1.1.1.1.1.2" xref="S4.p4.8.m8.1.1.1.1.1.2.cmml">N</mi><mn id="S4.p4.8.m8.1.1.1.1.1.3" xref="S4.p4.8.m8.1.1.1.1.1.3.cmml">2</mn></msup><mo id="S4.p4.8.m8.1.1.1.1.3" stretchy="false" xref="S4.p4.8.m8.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p4.8.m8.1b"><apply id="S4.p4.8.m8.1.1.cmml" xref="S4.p4.8.m8.1.1"><times id="S4.p4.8.m8.1.1.2.cmml" xref="S4.p4.8.m8.1.1.2"></times><ci id="S4.p4.8.m8.1.1.3.cmml" xref="S4.p4.8.m8.1.1.3">𝒪</ci><apply id="S4.p4.8.m8.1.1.1.1.1.cmml" xref="S4.p4.8.m8.1.1.1.1"><csymbol cd="ambiguous" id="S4.p4.8.m8.1.1.1.1.1.1.cmml" xref="S4.p4.8.m8.1.1.1.1">superscript</csymbol><ci id="S4.p4.8.m8.1.1.1.1.1.2.cmml" xref="S4.p4.8.m8.1.1.1.1.1.2">𝑁</ci><cn id="S4.p4.8.m8.1.1.1.1.1.3.cmml" type="integer" xref="S4.p4.8.m8.1.1.1.1.1.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.8.m8.1c">\mathcal{O}(N^{2})</annotation><annotation encoding="application/x-llamapun" id="S4.p4.8.m8.1d">caligraphic_O ( italic_N start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT )</annotation></semantics></math> softmax.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_table" id="S4.T1">
<table class="ltx_tabular ltx_centering ltx_align_middle" id="S4.T1.6">
<tbody><tr class="ltx_tr" id="S4.T1.6.7">
<td class="ltx_td ltx_border_tt" id="S4.T1.6.7.1"></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S4.T1.6.7.2">Variant</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S4.T1.6.7.3">Time comp.</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S4.T1.6.7.4">ImageNet</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S4.T1.6.7.5">iNaturalist2021</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T1.6.7.6">Places365 (Small)</td>
</tr>
<tr class="ltx_tr" id="S4.T1.6.8">
<td class="ltx_td" id="S4.T1.6.8.1"></td>
<td class="ltx_td ltx_border_r" id="S4.T1.6.8.2"></td>
<td class="ltx_td ltx_border_r" id="S4.T1.6.8.3"></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.6.8.4">1M</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.6.8.5">2.7M</td>
<td class="ltx_td ltx_align_center" id="S4.T1.6.8.6">1.8M</td>
</tr>
<tr class="ltx_tr" id="S4.T1.1.1">
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.2" rowspan="3"><span class="ltx_text" id="S4.T1.1.1.2.1">
<span class="ltx_inline-block ltx_transformed_outer" id="S4.T1.1.1.2.1.1" style="width:6.8pt;height:36.3pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:36.3pt;transform:translate(-14.71pt,-14.71pt) rotate(-90deg) ;">
<span class="ltx_p" id="S4.T1.1.1.2.1.1.1"><span class="ltx_text" id="S4.T1.1.1.2.1.1.1.1" style="color:#666666;">SLOW</span></span>
</span></span></span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T1.1.1.3">Unmasked softmax</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T1.1.1.1"><math alttext="\mathcal{O}(N^{2})" class="ltx_Math" display="inline" id="S4.T1.1.1.1.m1.1"><semantics id="S4.T1.1.1.1.m1.1a"><mrow id="S4.T1.1.1.1.m1.1.1" xref="S4.T1.1.1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.T1.1.1.1.m1.1.1.3" xref="S4.T1.1.1.1.m1.1.1.3.cmml">𝒪</mi><mo id="S4.T1.1.1.1.m1.1.1.2" xref="S4.T1.1.1.1.m1.1.1.2.cmml">⁢</mo><mrow id="S4.T1.1.1.1.m1.1.1.1.1" xref="S4.T1.1.1.1.m1.1.1.1.1.1.cmml"><mo id="S4.T1.1.1.1.m1.1.1.1.1.2" stretchy="false" xref="S4.T1.1.1.1.m1.1.1.1.1.1.cmml">(</mo><msup id="S4.T1.1.1.1.m1.1.1.1.1.1" xref="S4.T1.1.1.1.m1.1.1.1.1.1.cmml"><mi id="S4.T1.1.1.1.m1.1.1.1.1.1.2" xref="S4.T1.1.1.1.m1.1.1.1.1.1.2.cmml">N</mi><mn id="S4.T1.1.1.1.m1.1.1.1.1.1.3" xref="S4.T1.1.1.1.m1.1.1.1.1.1.3.cmml">2</mn></msup><mo id="S4.T1.1.1.1.m1.1.1.1.1.3" stretchy="false" xref="S4.T1.1.1.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.1.1.1.m1.1b"><apply id="S4.T1.1.1.1.m1.1.1.cmml" xref="S4.T1.1.1.1.m1.1.1"><times id="S4.T1.1.1.1.m1.1.1.2.cmml" xref="S4.T1.1.1.1.m1.1.1.2"></times><ci id="S4.T1.1.1.1.m1.1.1.3.cmml" xref="S4.T1.1.1.1.m1.1.1.3">𝒪</ci><apply id="S4.T1.1.1.1.m1.1.1.1.1.1.cmml" xref="S4.T1.1.1.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S4.T1.1.1.1.m1.1.1.1.1.1.1.cmml" xref="S4.T1.1.1.1.m1.1.1.1.1">superscript</csymbol><ci id="S4.T1.1.1.1.m1.1.1.1.1.1.2.cmml" xref="S4.T1.1.1.1.m1.1.1.1.1.1.2">𝑁</ci><cn id="S4.T1.1.1.1.m1.1.1.1.1.1.3.cmml" type="integer" xref="S4.T1.1.1.1.m1.1.1.1.1.1.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.1.1.1.m1.1c">\mathcal{O}(N^{2})</annotation><annotation encoding="application/x-llamapun" id="S4.T1.1.1.1.m1.1d">caligraphic_O ( italic_N start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT )</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T1.1.1.4">0.741</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T1.1.1.5">0.699</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.6">0.567</td>
</tr>
<tr class="ltx_tr" id="S4.T1.2.2">
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.2.2.2">Toeplitz-masked linear</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.2.2.1"><math alttext="\mathcal{O}(N\log N)" class="ltx_Math" display="inline" id="S4.T1.2.2.1.m1.1"><semantics id="S4.T1.2.2.1.m1.1a"><mrow id="S4.T1.2.2.1.m1.1.1" xref="S4.T1.2.2.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.T1.2.2.1.m1.1.1.3" xref="S4.T1.2.2.1.m1.1.1.3.cmml">𝒪</mi><mo id="S4.T1.2.2.1.m1.1.1.2" xref="S4.T1.2.2.1.m1.1.1.2.cmml">⁢</mo><mrow id="S4.T1.2.2.1.m1.1.1.1.1" xref="S4.T1.2.2.1.m1.1.1.1.1.1.cmml"><mo id="S4.T1.2.2.1.m1.1.1.1.1.2" stretchy="false" xref="S4.T1.2.2.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S4.T1.2.2.1.m1.1.1.1.1.1" xref="S4.T1.2.2.1.m1.1.1.1.1.1.cmml"><mi id="S4.T1.2.2.1.m1.1.1.1.1.1.2" xref="S4.T1.2.2.1.m1.1.1.1.1.1.2.cmml">N</mi><mo id="S4.T1.2.2.1.m1.1.1.1.1.1.1" lspace="0.167em" xref="S4.T1.2.2.1.m1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S4.T1.2.2.1.m1.1.1.1.1.1.3" xref="S4.T1.2.2.1.m1.1.1.1.1.1.3.cmml"><mi id="S4.T1.2.2.1.m1.1.1.1.1.1.3.1" xref="S4.T1.2.2.1.m1.1.1.1.1.1.3.1.cmml">log</mi><mo id="S4.T1.2.2.1.m1.1.1.1.1.1.3a" lspace="0.167em" xref="S4.T1.2.2.1.m1.1.1.1.1.1.3.cmml">⁡</mo><mi id="S4.T1.2.2.1.m1.1.1.1.1.1.3.2" xref="S4.T1.2.2.1.m1.1.1.1.1.1.3.2.cmml">N</mi></mrow></mrow><mo id="S4.T1.2.2.1.m1.1.1.1.1.3" stretchy="false" xref="S4.T1.2.2.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.2.2.1.m1.1b"><apply id="S4.T1.2.2.1.m1.1.1.cmml" xref="S4.T1.2.2.1.m1.1.1"><times id="S4.T1.2.2.1.m1.1.1.2.cmml" xref="S4.T1.2.2.1.m1.1.1.2"></times><ci id="S4.T1.2.2.1.m1.1.1.3.cmml" xref="S4.T1.2.2.1.m1.1.1.3">𝒪</ci><apply id="S4.T1.2.2.1.m1.1.1.1.1.1.cmml" xref="S4.T1.2.2.1.m1.1.1.1.1"><times id="S4.T1.2.2.1.m1.1.1.1.1.1.1.cmml" xref="S4.T1.2.2.1.m1.1.1.1.1.1.1"></times><ci id="S4.T1.2.2.1.m1.1.1.1.1.1.2.cmml" xref="S4.T1.2.2.1.m1.1.1.1.1.1.2">𝑁</ci><apply id="S4.T1.2.2.1.m1.1.1.1.1.1.3.cmml" xref="S4.T1.2.2.1.m1.1.1.1.1.1.3"><log id="S4.T1.2.2.1.m1.1.1.1.1.1.3.1.cmml" xref="S4.T1.2.2.1.m1.1.1.1.1.1.3.1"></log><ci id="S4.T1.2.2.1.m1.1.1.1.1.1.3.2.cmml" xref="S4.T1.2.2.1.m1.1.1.1.1.1.3.2">𝑁</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.2.2.1.m1.1c">\mathcal{O}(N\log N)</annotation><annotation encoding="application/x-llamapun" id="S4.T1.2.2.1.m1.1d">caligraphic_O ( italic_N roman_log italic_N )</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.2.2.3">0.733</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.2.2.4">0.674</td>
<td class="ltx_td ltx_align_center" id="S4.T1.2.2.5">0.550</td>
</tr>
<tr class="ltx_tr" id="S4.T1.4.4">
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.3.3.1">
<math alttext="\mathbf{M}_{\alpha}(\mathcal{G})" class="ltx_Math" display="inline" id="S4.T1.3.3.1.m1.1"><semantics id="S4.T1.3.3.1.m1.1a"><mrow id="S4.T1.3.3.1.m1.1.2" xref="S4.T1.3.3.1.m1.1.2.cmml"><msub id="S4.T1.3.3.1.m1.1.2.2" xref="S4.T1.3.3.1.m1.1.2.2.cmml"><mi id="S4.T1.3.3.1.m1.1.2.2.2" xref="S4.T1.3.3.1.m1.1.2.2.2.cmml">𝐌</mi><mi id="S4.T1.3.3.1.m1.1.2.2.3" xref="S4.T1.3.3.1.m1.1.2.2.3.cmml">α</mi></msub><mo id="S4.T1.3.3.1.m1.1.2.1" xref="S4.T1.3.3.1.m1.1.2.1.cmml">⁢</mo><mrow id="S4.T1.3.3.1.m1.1.2.3.2" xref="S4.T1.3.3.1.m1.1.2.cmml"><mo id="S4.T1.3.3.1.m1.1.2.3.2.1" stretchy="false" xref="S4.T1.3.3.1.m1.1.2.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S4.T1.3.3.1.m1.1.1" xref="S4.T1.3.3.1.m1.1.1.cmml">𝒢</mi><mo id="S4.T1.3.3.1.m1.1.2.3.2.2" stretchy="false" xref="S4.T1.3.3.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.3.3.1.m1.1b"><apply id="S4.T1.3.3.1.m1.1.2.cmml" xref="S4.T1.3.3.1.m1.1.2"><times id="S4.T1.3.3.1.m1.1.2.1.cmml" xref="S4.T1.3.3.1.m1.1.2.1"></times><apply id="S4.T1.3.3.1.m1.1.2.2.cmml" xref="S4.T1.3.3.1.m1.1.2.2"><csymbol cd="ambiguous" id="S4.T1.3.3.1.m1.1.2.2.1.cmml" xref="S4.T1.3.3.1.m1.1.2.2">subscript</csymbol><ci id="S4.T1.3.3.1.m1.1.2.2.2.cmml" xref="S4.T1.3.3.1.m1.1.2.2.2">𝐌</ci><ci id="S4.T1.3.3.1.m1.1.2.2.3.cmml" xref="S4.T1.3.3.1.m1.1.2.2.3">𝛼</ci></apply><ci id="S4.T1.3.3.1.m1.1.1.cmml" xref="S4.T1.3.3.1.m1.1.1">𝒢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.3.3.1.m1.1c">\mathbf{M}_{\alpha}(\mathcal{G})</annotation><annotation encoding="application/x-llamapun" id="S4.T1.3.3.1.m1.1d">bold_M start_POSTSUBSCRIPT italic_α end_POSTSUBSCRIPT ( caligraphic_G )</annotation></semantics></math><span class="ltx_text ltx_font_bold" id="S4.T1.3.3.1.1">-masked linear</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.4.4.2"><math alttext="\mathcal{O}(N^{2})" class="ltx_Math" display="inline" id="S4.T1.4.4.2.m1.1"><semantics id="S4.T1.4.4.2.m1.1a"><mrow id="S4.T1.4.4.2.m1.1.1" xref="S4.T1.4.4.2.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.T1.4.4.2.m1.1.1.3" xref="S4.T1.4.4.2.m1.1.1.3.cmml">𝒪</mi><mo id="S4.T1.4.4.2.m1.1.1.2" xref="S4.T1.4.4.2.m1.1.1.2.cmml">⁢</mo><mrow id="S4.T1.4.4.2.m1.1.1.1.1" xref="S4.T1.4.4.2.m1.1.1.1.1.1.cmml"><mo id="S4.T1.4.4.2.m1.1.1.1.1.2" stretchy="false" xref="S4.T1.4.4.2.m1.1.1.1.1.1.cmml">(</mo><msup id="S4.T1.4.4.2.m1.1.1.1.1.1" xref="S4.T1.4.4.2.m1.1.1.1.1.1.cmml"><mi id="S4.T1.4.4.2.m1.1.1.1.1.1.2" xref="S4.T1.4.4.2.m1.1.1.1.1.1.2.cmml">N</mi><mn id="S4.T1.4.4.2.m1.1.1.1.1.1.3" xref="S4.T1.4.4.2.m1.1.1.1.1.1.3.cmml">2</mn></msup><mo id="S4.T1.4.4.2.m1.1.1.1.1.3" stretchy="false" xref="S4.T1.4.4.2.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.4.4.2.m1.1b"><apply id="S4.T1.4.4.2.m1.1.1.cmml" xref="S4.T1.4.4.2.m1.1.1"><times id="S4.T1.4.4.2.m1.1.1.2.cmml" xref="S4.T1.4.4.2.m1.1.1.2"></times><ci id="S4.T1.4.4.2.m1.1.1.3.cmml" xref="S4.T1.4.4.2.m1.1.1.3">𝒪</ci><apply id="S4.T1.4.4.2.m1.1.1.1.1.1.cmml" xref="S4.T1.4.4.2.m1.1.1.1.1"><csymbol cd="ambiguous" id="S4.T1.4.4.2.m1.1.1.1.1.1.1.cmml" xref="S4.T1.4.4.2.m1.1.1.1.1">superscript</csymbol><ci id="S4.T1.4.4.2.m1.1.1.1.1.1.2.cmml" xref="S4.T1.4.4.2.m1.1.1.1.1.1.2">𝑁</ci><cn id="S4.T1.4.4.2.m1.1.1.1.1.1.3.cmml" type="integer" xref="S4.T1.4.4.2.m1.1.1.1.1.1.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.4.4.2.m1.1c">\mathcal{O}(N^{2})</annotation><annotation encoding="application/x-llamapun" id="S4.T1.4.4.2.m1.1d">caligraphic_O ( italic_N start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT )</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.4.4.3">0.741</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.4.4.4">0.692</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.4.5">0.551</td>
</tr>
<tr class="ltx_tr" id="S4.T1.5.5">
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T1.5.5.2" rowspan="2"><span class="ltx_text" id="S4.T1.5.5.2.1">
<span class="ltx_inline-block ltx_transformed_outer" id="S4.T1.5.5.2.1.1" style="width:6.8pt;height:32.4pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:32.4pt;transform:translate(-12.76pt,-12.76pt) rotate(-90deg) ;">
<span class="ltx_p" id="S4.T1.5.5.2.1.1.1"><span class="ltx_text" id="S4.T1.5.5.2.1.1.1.1" style="color:#666666;">FAST</span></span>
</span></span></span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T1.5.5.3">Unmasked linear</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T1.5.5.1"><math alttext="\mathcal{O}(N)" class="ltx_Math" display="inline" id="S4.T1.5.5.1.m1.1"><semantics id="S4.T1.5.5.1.m1.1a"><mrow id="S4.T1.5.5.1.m1.1.2" xref="S4.T1.5.5.1.m1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.T1.5.5.1.m1.1.2.2" xref="S4.T1.5.5.1.m1.1.2.2.cmml">𝒪</mi><mo id="S4.T1.5.5.1.m1.1.2.1" xref="S4.T1.5.5.1.m1.1.2.1.cmml">⁢</mo><mrow id="S4.T1.5.5.1.m1.1.2.3.2" xref="S4.T1.5.5.1.m1.1.2.cmml"><mo id="S4.T1.5.5.1.m1.1.2.3.2.1" stretchy="false" xref="S4.T1.5.5.1.m1.1.2.cmml">(</mo><mi id="S4.T1.5.5.1.m1.1.1" xref="S4.T1.5.5.1.m1.1.1.cmml">N</mi><mo id="S4.T1.5.5.1.m1.1.2.3.2.2" stretchy="false" xref="S4.T1.5.5.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.5.5.1.m1.1b"><apply id="S4.T1.5.5.1.m1.1.2.cmml" xref="S4.T1.5.5.1.m1.1.2"><times id="S4.T1.5.5.1.m1.1.2.1.cmml" xref="S4.T1.5.5.1.m1.1.2.1"></times><ci id="S4.T1.5.5.1.m1.1.2.2.cmml" xref="S4.T1.5.5.1.m1.1.2.2">𝒪</ci><ci id="S4.T1.5.5.1.m1.1.1.cmml" xref="S4.T1.5.5.1.m1.1.1">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.5.5.1.m1.1c">\mathcal{O}(N)</annotation><annotation encoding="application/x-llamapun" id="S4.T1.5.5.1.m1.1d">caligraphic_O ( italic_N )</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T1.5.5.4">0.693</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T1.5.5.5">0.667</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.5.5.6">0.543</td>
</tr>
<tr class="ltx_tr" id="S4.T1.6.6">
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S4.T1.6.6.2"><span class="ltx_text ltx_font_bold" id="S4.T1.6.6.2.1">GRF-masked linear</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S4.T1.6.6.1"><math alttext="\mathcal{O}(N)" class="ltx_Math" display="inline" id="S4.T1.6.6.1.m1.1"><semantics id="S4.T1.6.6.1.m1.1a"><mrow id="S4.T1.6.6.1.m1.1.2" xref="S4.T1.6.6.1.m1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.T1.6.6.1.m1.1.2.2" xref="S4.T1.6.6.1.m1.1.2.2.cmml">𝒪</mi><mo id="S4.T1.6.6.1.m1.1.2.1" xref="S4.T1.6.6.1.m1.1.2.1.cmml">⁢</mo><mrow id="S4.T1.6.6.1.m1.1.2.3.2" xref="S4.T1.6.6.1.m1.1.2.cmml"><mo id="S4.T1.6.6.1.m1.1.2.3.2.1" stretchy="false" xref="S4.T1.6.6.1.m1.1.2.cmml">(</mo><mi id="S4.T1.6.6.1.m1.1.1" xref="S4.T1.6.6.1.m1.1.1.cmml">N</mi><mo id="S4.T1.6.6.1.m1.1.2.3.2.2" stretchy="false" xref="S4.T1.6.6.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.6.6.1.m1.1b"><apply id="S4.T1.6.6.1.m1.1.2.cmml" xref="S4.T1.6.6.1.m1.1.2"><times id="S4.T1.6.6.1.m1.1.2.1.cmml" xref="S4.T1.6.6.1.m1.1.2.1"></times><ci id="S4.T1.6.6.1.m1.1.2.2.cmml" xref="S4.T1.6.6.1.m1.1.2.2">𝒪</ci><ci id="S4.T1.6.6.1.m1.1.1.cmml" xref="S4.T1.6.6.1.m1.1.1">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.6.6.1.m1.1c">\mathcal{O}(N)</annotation><annotation encoding="application/x-llamapun" id="S4.T1.6.6.1.m1.1d">caligraphic_O ( italic_N )</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S4.T1.6.6.3"><span class="ltx_text ltx_font_bold" id="S4.T1.6.6.3.1">0.730</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S4.T1.6.6.4"><span class="ltx_text ltx_font_bold" id="S4.T1.6.6.4.1">0.689</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.6.6.5"><span class="ltx_text ltx_font_bold" id="S4.T1.6.6.5.1">0.548</span></td>
</tr>
</tbody></table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1: </span>Final transformer test accuracies across attention masking variants and datasets.
Our algorithms are shown in <span class="ltx_text ltx_font_bold" id="S4.T1.10.2">bold</span>.
Topological masking with GRFs is the <span class="ltx_text ltx_font_bold" id="S4.T1.8.1">best <math alttext="\mathcal{O}(N)" class="ltx_Math" display="inline" id="S4.T1.8.1.m1.1"><semantics id="S4.T1.8.1.m1.1b"><mrow id="S4.T1.8.1.m1.1.2" xref="S4.T1.8.1.m1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.T1.8.1.m1.1.2.2" xref="S4.T1.8.1.m1.1.2.2.cmml">𝒪</mi><mo id="S4.T1.8.1.m1.1.2.1" xref="S4.T1.8.1.m1.1.2.1.cmml">⁢</mo><mrow id="S4.T1.8.1.m1.1.2.3.2" xref="S4.T1.8.1.m1.1.2.cmml"><mo id="S4.T1.8.1.m1.1.2.3.2.1" stretchy="false" xref="S4.T1.8.1.m1.1.2.cmml">(</mo><mi id="S4.T1.8.1.m1.1.1" xref="S4.T1.8.1.m1.1.1.cmml">N</mi><mo id="S4.T1.8.1.m1.1.2.3.2.2" stretchy="false" xref="S4.T1.8.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.8.1.m1.1c"><apply id="S4.T1.8.1.m1.1.2.cmml" xref="S4.T1.8.1.m1.1.2"><times id="S4.T1.8.1.m1.1.2.1.cmml" xref="S4.T1.8.1.m1.1.2.1"></times><ci id="S4.T1.8.1.m1.1.2.2.cmml" xref="S4.T1.8.1.m1.1.2.2">𝒪</ci><ci id="S4.T1.8.1.m1.1.1.cmml" xref="S4.T1.8.1.m1.1.1">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.8.1.m1.1d">\mathcal{O}(N)</annotation><annotation encoding="application/x-llamapun" id="S4.T1.8.1.m1.1e">caligraphic_O ( italic_N )</annotation></semantics></math> mechanism</span>, matching or beating more expensive alternatives.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S4.p5">
<p class="ltx_p" id="S4.p5.5"><span class="ltx_text ltx_font_bold" id="S4.p5.5.1">Ablation studies.</span>
In App.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#A3.SS2" title="C.2 ViT ablations ‣ Appendix C Further experiments and details ‣ Linear Transformer Topological Masking with Graph Random Features"><span class="ltx_text ltx_ref_tag">C.2</span></a>, we perform ablation studies for the ViT experiments.
We find that predictive performance improves with the number of walkers <math alttext="n" class="ltx_Math" display="inline" id="S4.p5.1.m1.1"><semantics id="S4.p5.1.m1.1a"><mi id="S4.p5.1.m1.1.1" xref="S4.p5.1.m1.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S4.p5.1.m1.1b"><ci id="S4.p5.1.m1.1.1.cmml" xref="S4.p5.1.m1.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p5.1.m1.1c">n</annotation><annotation encoding="application/x-llamapun" id="S4.p5.1.m1.1d">italic_n</annotation></semantics></math> because the accuracy of the Monte Carlo estimate <math alttext="\widehat{\mathbf{M}}_{\alpha}(\mathcal{G})" class="ltx_Math" display="inline" id="S4.p5.2.m2.1"><semantics id="S4.p5.2.m2.1a"><mrow id="S4.p5.2.m2.1.2" xref="S4.p5.2.m2.1.2.cmml"><msub id="S4.p5.2.m2.1.2.2" xref="S4.p5.2.m2.1.2.2.cmml"><mover accent="true" id="S4.p5.2.m2.1.2.2.2" xref="S4.p5.2.m2.1.2.2.2.cmml"><mi id="S4.p5.2.m2.1.2.2.2.2" xref="S4.p5.2.m2.1.2.2.2.2.cmml">𝐌</mi><mo id="S4.p5.2.m2.1.2.2.2.1" xref="S4.p5.2.m2.1.2.2.2.1.cmml">^</mo></mover><mi id="S4.p5.2.m2.1.2.2.3" xref="S4.p5.2.m2.1.2.2.3.cmml">α</mi></msub><mo id="S4.p5.2.m2.1.2.1" xref="S4.p5.2.m2.1.2.1.cmml">⁢</mo><mrow id="S4.p5.2.m2.1.2.3.2" xref="S4.p5.2.m2.1.2.cmml"><mo id="S4.p5.2.m2.1.2.3.2.1" stretchy="false" xref="S4.p5.2.m2.1.2.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S4.p5.2.m2.1.1" xref="S4.p5.2.m2.1.1.cmml">𝒢</mi><mo id="S4.p5.2.m2.1.2.3.2.2" stretchy="false" xref="S4.p5.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p5.2.m2.1b"><apply id="S4.p5.2.m2.1.2.cmml" xref="S4.p5.2.m2.1.2"><times id="S4.p5.2.m2.1.2.1.cmml" xref="S4.p5.2.m2.1.2.1"></times><apply id="S4.p5.2.m2.1.2.2.cmml" xref="S4.p5.2.m2.1.2.2"><csymbol cd="ambiguous" id="S4.p5.2.m2.1.2.2.1.cmml" xref="S4.p5.2.m2.1.2.2">subscript</csymbol><apply id="S4.p5.2.m2.1.2.2.2.cmml" xref="S4.p5.2.m2.1.2.2.2"><ci id="S4.p5.2.m2.1.2.2.2.1.cmml" xref="S4.p5.2.m2.1.2.2.2.1">^</ci><ci id="S4.p5.2.m2.1.2.2.2.2.cmml" xref="S4.p5.2.m2.1.2.2.2.2">𝐌</ci></apply><ci id="S4.p5.2.m2.1.2.2.3.cmml" xref="S4.p5.2.m2.1.2.2.3">𝛼</ci></apply><ci id="S4.p5.2.m2.1.1.cmml" xref="S4.p5.2.m2.1.1">𝒢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p5.2.m2.1c">\widehat{\mathbf{M}}_{\alpha}(\mathcal{G})</annotation><annotation encoding="application/x-llamapun" id="S4.p5.2.m2.1d">over^ start_ARG bold_M end_ARG start_POSTSUBSCRIPT italic_α end_POSTSUBSCRIPT ( caligraphic_G )</annotation></semantics></math> increases.
Moreover, importance sampling walks is crucial; if we fail to upweight improbable walks, the gains vanish.
Lastly, the inductive bias from parameterising <math alttext="\mathbf{M}_{\alpha}(\mathcal{G})" class="ltx_Math" display="inline" id="S4.p5.3.m3.1"><semantics id="S4.p5.3.m3.1a"><mrow id="S4.p5.3.m3.1.2" xref="S4.p5.3.m3.1.2.cmml"><msub id="S4.p5.3.m3.1.2.2" xref="S4.p5.3.m3.1.2.2.cmml"><mi id="S4.p5.3.m3.1.2.2.2" xref="S4.p5.3.m3.1.2.2.2.cmml">𝐌</mi><mi id="S4.p5.3.m3.1.2.2.3" xref="S4.p5.3.m3.1.2.2.3.cmml">α</mi></msub><mo id="S4.p5.3.m3.1.2.1" xref="S4.p5.3.m3.1.2.1.cmml">⁢</mo><mrow id="S4.p5.3.m3.1.2.3.2" xref="S4.p5.3.m3.1.2.cmml"><mo id="S4.p5.3.m3.1.2.3.2.1" stretchy="false" xref="S4.p5.3.m3.1.2.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S4.p5.3.m3.1.1" xref="S4.p5.3.m3.1.1.cmml">𝒢</mi><mo id="S4.p5.3.m3.1.2.3.2.2" stretchy="false" xref="S4.p5.3.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p5.3.m3.1b"><apply id="S4.p5.3.m3.1.2.cmml" xref="S4.p5.3.m3.1.2"><times id="S4.p5.3.m3.1.2.1.cmml" xref="S4.p5.3.m3.1.2.1"></times><apply id="S4.p5.3.m3.1.2.2.cmml" xref="S4.p5.3.m3.1.2.2"><csymbol cd="ambiguous" id="S4.p5.3.m3.1.2.2.1.cmml" xref="S4.p5.3.m3.1.2.2">subscript</csymbol><ci id="S4.p5.3.m3.1.2.2.2.cmml" xref="S4.p5.3.m3.1.2.2.2">𝐌</ci><ci id="S4.p5.3.m3.1.2.2.3.cmml" xref="S4.p5.3.m3.1.2.2.3">𝛼</ci></apply><ci id="S4.p5.3.m3.1.1.cmml" xref="S4.p5.3.m3.1.1">𝒢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p5.3.m3.1c">\mathbf{M}_{\alpha}(\mathcal{G})</annotation><annotation encoding="application/x-llamapun" id="S4.p5.3.m3.1d">bold_M start_POSTSUBSCRIPT italic_α end_POSTSUBSCRIPT ( caligraphic_G )</annotation></semantics></math> as a function of <math alttext="\mathbf{W}" class="ltx_Math" display="inline" id="S4.p5.4.m4.1"><semantics id="S4.p5.4.m4.1a"><mi id="S4.p5.4.m4.1.1" xref="S4.p5.4.m4.1.1.cmml">𝐖</mi><annotation-xml encoding="MathML-Content" id="S4.p5.4.m4.1b"><ci id="S4.p5.4.m4.1.1.cmml" xref="S4.p5.4.m4.1.1">𝐖</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p5.4.m4.1c">\mathbf{W}</annotation><annotation encoding="application/x-llamapun" id="S4.p5.4.m4.1d">bold_W</annotation></semantics></math> is key.
Fully learnable graph features of the same dimensionality <math alttext="N" class="ltx_Math" display="inline" id="S4.p5.5.m5.1"><semantics id="S4.p5.5.m5.1a"><mi id="S4.p5.5.m5.1.1" xref="S4.p5.5.m5.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S4.p5.5.m5.1b"><ci id="S4.p5.5.m5.1.1.cmml" xref="S4.p5.5.m5.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p5.5.m5.1c">N</annotation><annotation encoding="application/x-llamapun" id="S4.p5.5.m5.1d">italic_N</annotation></semantics></math>, an impractical and expensive alternative to our method, give much smaller gains.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S4.p6">
<p class="ltx_p" id="S4.p6.1"><span class="ltx_text ltx_font_bold" id="S4.p6.1.1">PCTs: predicting particle dynamics for robotics.</span>
As a final task, we use our algorithm to model <em class="ltx_emph ltx_font_italic" id="S4.p6.1.2">high-density visual particle dynamics</em> <cite class="ltx_cite ltx_citemacro_citep">(HD-VPD;  Whitney et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#bib.bib37" title="">2023</a>; <a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#bib.bib38" title="">2024</a>)</cite>, predicting the physical evolution of scenes involving a bi-manual robot using a point cloud transformer (PCT).
Images from a pair of cameras are unprojected to a set of 3D particles.
Their interactions, conditioned on specific robot actions, are modelled by a dynamics network.
We predict updates to the latent point cloud, render the result to an image with a conditional NeRF <cite class="ltx_cite ltx_citemacro_citep">(Mildenhall et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#bib.bib24" title="">2021</a>)</cite>, and train end-to-end with video prediction loss.
Such learned dynamics models are attracting growing interest in robotics as a more flexible alternative to physical simulators, but to scale to the massive point clouds needed for detailed predictions efficiency and effective structural inductive biases are key.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S4.p7">
<p class="ltx_p" id="S4.p7.2">For the dynamics network, we use an <em class="ltx_emph ltx_font_italic" id="S4.p7.2.1">Interlacer</em>: a PCT which alternates unmasked linear attention and message passing-style updates between neighbouring particles <cite class="ltx_cite ltx_citemacro_citep">(Whitney et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#bib.bib38" title="">2024</a>)</cite>.
This architecture is twice as fast as GNNs with the same prediction quality, and can handle <math alttext="4\times" class="ltx_math_unparsed" display="inline" id="S4.p7.1.m1.1"><semantics id="S4.p7.1.m1.1a"><mrow id="S4.p7.1.m1.1b"><mn id="S4.p7.1.m1.1.1">4</mn><mo id="S4.p7.1.m1.1.2" lspace="0.222em">×</mo></mrow><annotation encoding="application/x-tex" id="S4.p7.1.m1.1c">4\times</annotation><annotation encoding="application/x-llamapun" id="S4.p7.1.m1.1d">4 ×</annotation></semantics></math> bigger point clouds.
To test the ability of GRFs to efficiently capture local topological structure, we replace message passing by GRF-masked linear attention, taking query/key features <math alttext="\phi(\cdot)=\textrm{ReLU}(\cdot)" class="ltx_Math" display="inline" id="S4.p7.2.m2.2"><semantics id="S4.p7.2.m2.2a"><mrow id="S4.p7.2.m2.2.3" xref="S4.p7.2.m2.2.3.cmml"><mrow id="S4.p7.2.m2.2.3.2" xref="S4.p7.2.m2.2.3.2.cmml"><mi id="S4.p7.2.m2.2.3.2.2" xref="S4.p7.2.m2.2.3.2.2.cmml">ϕ</mi><mo id="S4.p7.2.m2.2.3.2.1" xref="S4.p7.2.m2.2.3.2.1.cmml">⁢</mo><mrow id="S4.p7.2.m2.2.3.2.3.2" xref="S4.p7.2.m2.2.3.2.cmml"><mo id="S4.p7.2.m2.2.3.2.3.2.1" stretchy="false" xref="S4.p7.2.m2.2.3.2.cmml">(</mo><mo id="S4.p7.2.m2.1.1" lspace="0em" rspace="0em" xref="S4.p7.2.m2.1.1.cmml">⋅</mo><mo id="S4.p7.2.m2.2.3.2.3.2.2" stretchy="false" xref="S4.p7.2.m2.2.3.2.cmml">)</mo></mrow></mrow><mo id="S4.p7.2.m2.2.3.1" xref="S4.p7.2.m2.2.3.1.cmml">=</mo><mrow id="S4.p7.2.m2.2.3.3" xref="S4.p7.2.m2.2.3.3.cmml"><mtext id="S4.p7.2.m2.2.3.3.2" xref="S4.p7.2.m2.2.3.3.2a.cmml">ReLU</mtext><mo id="S4.p7.2.m2.2.3.3.1" xref="S4.p7.2.m2.2.3.3.1.cmml">⁢</mo><mrow id="S4.p7.2.m2.2.3.3.3.2" xref="S4.p7.2.m2.2.3.3.cmml"><mo id="S4.p7.2.m2.2.3.3.3.2.1" stretchy="false" xref="S4.p7.2.m2.2.3.3.cmml">(</mo><mo id="S4.p7.2.m2.2.2" lspace="0em" rspace="0em" xref="S4.p7.2.m2.2.2.cmml">⋅</mo><mo id="S4.p7.2.m2.2.3.3.3.2.2" stretchy="false" xref="S4.p7.2.m2.2.3.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p7.2.m2.2b"><apply id="S4.p7.2.m2.2.3.cmml" xref="S4.p7.2.m2.2.3"><eq id="S4.p7.2.m2.2.3.1.cmml" xref="S4.p7.2.m2.2.3.1"></eq><apply id="S4.p7.2.m2.2.3.2.cmml" xref="S4.p7.2.m2.2.3.2"><times id="S4.p7.2.m2.2.3.2.1.cmml" xref="S4.p7.2.m2.2.3.2.1"></times><ci id="S4.p7.2.m2.2.3.2.2.cmml" xref="S4.p7.2.m2.2.3.2.2">italic-ϕ</ci><ci id="S4.p7.2.m2.1.1.cmml" xref="S4.p7.2.m2.1.1">⋅</ci></apply><apply id="S4.p7.2.m2.2.3.3.cmml" xref="S4.p7.2.m2.2.3.3"><times id="S4.p7.2.m2.2.3.3.1.cmml" xref="S4.p7.2.m2.2.3.3.1"></times><ci id="S4.p7.2.m2.2.3.3.2a.cmml" xref="S4.p7.2.m2.2.3.3.2"><mtext id="S4.p7.2.m2.2.3.3.2.cmml" xref="S4.p7.2.m2.2.3.3.2">ReLU</mtext></ci><ci id="S4.p7.2.m2.2.2.cmml" xref="S4.p7.2.m2.2.2">⋅</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p7.2.m2.2c">\phi(\cdot)=\textrm{ReLU}(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S4.p7.2.m2.2d">italic_ϕ ( ⋅ ) = ReLU ( ⋅ )</annotation></semantics></math>.
Implementation details for HD-VPD, including the robotic arm and camera configurations, are the same as reported by <cite class="ltx_cite ltx_citemacro_citet">Whitney et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#bib.bib38" title="">2024</a>)</cite>; see App.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#A3.SS3" title="C.3 HD-VPD experimental details ‣ Appendix C Further experiments and details ‣ Linear Transformer Topological Masking with Graph Random Features"><span class="ltx_text ltx_ref_tag">C.3</span></a> for discussion.
To disambiguate, we will refer to our model as the <em class="ltx_emph ltx_font_italic" id="S4.p7.2.2">GRF Interlacer</em> and Whitney et al.’s as the <em class="ltx_emph ltx_font_italic" id="S4.p7.2.3">message passing (MP) Interlacer</em>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_figure" id="S4.F4">
<table class="ltx_tabular ltx_centering ltx_align_middle" id="S4.F4.30">
<tbody><tr class="ltx_tr" id="S4.F4.6.6">
<td class="ltx_td ltx_align_right ltx_border_tt" id="S4.F4.6.6.7" style="padding:-1pt 2.0pt;">
<span class="ltx_text" id="S4.F4.6.6.7.1"></span> <span class="ltx_text" id="S4.F4.6.6.7.2">
<span class="ltx_tabular ltx_align_middle" id="S4.F4.6.6.7.2.1">
<span class="ltx_tr" id="S4.F4.6.6.7.2.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S4.F4.6.6.7.2.1.1.1" style="padding:-1pt 2.0pt;"><em class="ltx_emph ltx_font_italic" id="S4.F4.6.6.7.2.1.1.1.1">Groundtruth</em></span></span>
<span class="ltx_tr" id="S4.F4.6.6.7.2.1.2">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S4.F4.6.6.7.2.1.2.1" style="padding:-1pt 2.0pt;"><em class="ltx_emph ltx_font_italic" id="S4.F4.6.6.7.2.1.2.1.1">video frame</em></span></span>
</span></span><span class="ltx_text" id="S4.F4.6.6.7.3"></span>   <span class="ltx_rule" style="width:0.8pt;background:black;display:inline-block;">&nbsp;</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.F4.1.1.1" style="padding:-1pt 2.0pt;">
<span class="ltx_ERROR undefined" id="S4.F4.1.1.1.1">\adjustbox</span>valign=m<img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="45" id="S4.F4.1.1.1.g1" src="https://arxiv.org/html/2410.03462v1/extracted/5899751/iclr2024/final_renderings/2/00001.jpg" width="59">
</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.F4.2.2.2" style="padding:-1pt 2.0pt;">
<span class="ltx_ERROR undefined" id="S4.F4.2.2.2.1">\adjustbox</span>valign=m<img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="44" id="S4.F4.2.2.2.g1" src="https://arxiv.org/html/2410.03462v1/extracted/5899751/iclr2024/final_renderings/2/00005.jpg" width="59">
</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S4.F4.3.3.3" style="padding:-1pt 2.0pt;">
<span class="ltx_ERROR undefined" id="S4.F4.3.3.3.1">\adjustbox</span>valign=m<img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="45" id="S4.F4.3.3.3.g1" src="https://arxiv.org/html/2410.03462v1/extracted/5899751/iclr2024/final_renderings/2/00006.jpg" width="59">
</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.F4.4.4.4" style="padding:-1pt 2.0pt;">
<span class="ltx_ERROR undefined" id="S4.F4.4.4.4.1">\adjustbox</span>valign=m<img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="45" id="S4.F4.4.4.4.g1" src="https://arxiv.org/html/2410.03462v1/extracted/5899751/iclr2024/final_renderings/1/00001.jpg" width="59">
</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.F4.5.5.5" style="padding:-1pt 2.0pt;">
<span class="ltx_ERROR undefined" id="S4.F4.5.5.5.1">\adjustbox</span>valign=m<img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="45" id="S4.F4.5.5.5.g1" src="https://arxiv.org/html/2410.03462v1/extracted/5899751/iclr2024/final_renderings/1/00004.jpg" width="59">
</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.F4.6.6.6" style="padding:-1pt 2.0pt;">
<span class="ltx_ERROR undefined" id="S4.F4.6.6.6.1">\adjustbox</span>valign=m<img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="45" id="S4.F4.6.6.6.g1" src="https://arxiv.org/html/2410.03462v1/extracted/5899751/iclr2024/final_renderings/1/00005.jpg" width="59">
</td>
</tr>
<tr class="ltx_tr" id="S4.F4.12.12">
<td class="ltx_td ltx_align_right" id="S4.F4.12.12.7" style="padding:-1pt 2.0pt;">
<span class="ltx_text" id="S4.F4.12.12.7.1"></span> <span class="ltx_text" id="S4.F4.12.12.7.2">
<span class="ltx_tabular ltx_align_middle" id="S4.F4.12.12.7.2.1">
<span class="ltx_tr" id="S4.F4.12.12.7.2.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S4.F4.12.12.7.2.1.1.1" style="padding:-1pt 2.0pt;"><em class="ltx_emph ltx_font_italic" id="S4.F4.12.12.7.2.1.1.1.1">GRF Interlacer</em></span></span>
<span class="ltx_tr" id="S4.F4.12.12.7.2.1.2">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S4.F4.12.12.7.2.1.2.1" style="padding:-1pt 2.0pt;"><em class="ltx_emph ltx_font_italic" id="S4.F4.12.12.7.2.1.2.1.1">prediction</em></span></span>
</span></span><span class="ltx_text" id="S4.F4.12.12.7.3"></span>   <span class="ltx_rule" style="width:0.8pt;background:black;display:inline-block;">&nbsp;</span>
</td>
<td class="ltx_td ltx_align_center" id="S4.F4.7.7.1" style="padding:-1pt 2.0pt;">
<span class="ltx_ERROR undefined" id="S4.F4.7.7.1.1">\adjustbox</span>valign=m<img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="45" id="S4.F4.7.7.1.g1" src="https://arxiv.org/html/2410.03462v1/extracted/5899751/iclr2024/final_renderings/2/00001_1.jpg" width="59">
</td>
<td class="ltx_td ltx_align_center" id="S4.F4.8.8.2" style="padding:-1pt 2.0pt;">
<span class="ltx_ERROR undefined" id="S4.F4.8.8.2.1">\adjustbox</span>valign=m<img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="45" id="S4.F4.8.8.2.g1" src="https://arxiv.org/html/2410.03462v1/extracted/5899751/iclr2024/final_renderings/2/00005_1.jpg" width="59">
</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.F4.9.9.3" style="padding:-1pt 2.0pt;">
<span class="ltx_ERROR undefined" id="S4.F4.9.9.3.1">\adjustbox</span>valign=m<img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="44" id="S4.F4.9.9.3.g1" src="https://arxiv.org/html/2410.03462v1/extracted/5899751/iclr2024/final_renderings/2/00006_1.jpg" width="59">
</td>
<td class="ltx_td ltx_align_center" id="S4.F4.10.10.4" style="padding:-1pt 2.0pt;">
<span class="ltx_ERROR undefined" id="S4.F4.10.10.4.1">\adjustbox</span>valign=m<img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="45" id="S4.F4.10.10.4.g1" src="https://arxiv.org/html/2410.03462v1/extracted/5899751/iclr2024/final_renderings/1/00001_1.jpg" width="59">
</td>
<td class="ltx_td ltx_align_center" id="S4.F4.11.11.5" style="padding:-1pt 2.0pt;">
<span class="ltx_ERROR undefined" id="S4.F4.11.11.5.1">\adjustbox</span>valign=m<img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="45" id="S4.F4.11.11.5.g1" src="https://arxiv.org/html/2410.03462v1/extracted/5899751/iclr2024/final_renderings/1/00004_1.jpg" width="59">
</td>
<td class="ltx_td ltx_align_center" id="S4.F4.12.12.6" style="padding:-1pt 2.0pt;">
<span class="ltx_ERROR undefined" id="S4.F4.12.12.6.1">\adjustbox</span>valign=m<img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="45" id="S4.F4.12.12.6.g1" src="https://arxiv.org/html/2410.03462v1/extracted/5899751/iclr2024/final_renderings/1/00005_1.jpg" width="59">
</td>
</tr>
<tr class="ltx_tr" id="S4.F4.18.18">
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.F4.18.18.7" style="padding:-1pt 2.0pt;">
<span class="ltx_text" id="S4.F4.18.18.7.1"></span> <span class="ltx_text" id="S4.F4.18.18.7.2">
<span class="ltx_tabular ltx_align_middle" id="S4.F4.18.18.7.2.1">
<span class="ltx_tr" id="S4.F4.18.18.7.2.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S4.F4.18.18.7.2.1.1.1" style="padding:-1pt 2.0pt;"><em class="ltx_emph ltx_font_italic" id="S4.F4.18.18.7.2.1.1.1.1">Groundtruth</em></span></span>
<span class="ltx_tr" id="S4.F4.18.18.7.2.1.2">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S4.F4.18.18.7.2.1.2.1" style="padding:-1pt 2.0pt;"><em class="ltx_emph ltx_font_italic" id="S4.F4.18.18.7.2.1.2.1.1">video frame</em></span></span>
</span></span><span class="ltx_text" id="S4.F4.18.18.7.3"></span>   <span class="ltx_rule" style="width:0.8pt;background:black;display:inline-block;">&nbsp;</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.F4.13.13.1" style="padding:-1pt 2.0pt;">
<span class="ltx_ERROR undefined" id="S4.F4.13.13.1.1">\adjustbox</span>valign=m<img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="44" id="S4.F4.13.13.1.g1" src="https://arxiv.org/html/2410.03462v1/extracted/5899751/iclr2024/final_renderings/3/00001.jpg" width="59">
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.F4.14.14.2" style="padding:-1pt 2.0pt;">
<span class="ltx_ERROR undefined" id="S4.F4.14.14.2.1">\adjustbox</span>valign=m<img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="44" id="S4.F4.14.14.2.g1" src="https://arxiv.org/html/2410.03462v1/extracted/5899751/iclr2024/final_renderings/3/00003.jpg" width="59">
</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.F4.15.15.3" style="padding:-1pt 2.0pt;">
<span class="ltx_ERROR undefined" id="S4.F4.15.15.3.1">\adjustbox</span>valign=m<img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="44" id="S4.F4.15.15.3.g1" src="https://arxiv.org/html/2410.03462v1/extracted/5899751/iclr2024/final_renderings/3/00005.jpg" width="59">
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.F4.16.16.4" style="padding:-1pt 2.0pt;">
<span class="ltx_ERROR undefined" id="S4.F4.16.16.4.1">\adjustbox</span>valign=m<img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="44" id="S4.F4.16.16.4.g1" src="https://arxiv.org/html/2410.03462v1/extracted/5899751/iclr2024/final_renderings/4/00001.jpg" width="59">
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.F4.17.17.5" style="padding:-1pt 2.0pt;">
<span class="ltx_ERROR undefined" id="S4.F4.17.17.5.1">\adjustbox</span>valign=m<img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="45" id="S4.F4.17.17.5.g1" src="https://arxiv.org/html/2410.03462v1/extracted/5899751/iclr2024/final_renderings/4/00004.jpg" width="59">
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.F4.18.18.6" style="padding:-1pt 2.0pt;">
<span class="ltx_ERROR undefined" id="S4.F4.18.18.6.1">\adjustbox</span>valign=m<img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="45" id="S4.F4.18.18.6.g1" src="https://arxiv.org/html/2410.03462v1/extracted/5899751/iclr2024/final_renderings/4/00005.jpg" width="59">
</td>
</tr>
<tr class="ltx_tr" id="S4.F4.24.24">
<td class="ltx_td ltx_align_right" id="S4.F4.24.24.7" style="padding:-1pt 2.0pt;">
<span class="ltx_text" id="S4.F4.24.24.7.1"></span> <span class="ltx_text" id="S4.F4.24.24.7.2">
<span class="ltx_tabular ltx_align_middle" id="S4.F4.24.24.7.2.1">
<span class="ltx_tr" id="S4.F4.24.24.7.2.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S4.F4.24.24.7.2.1.1.1" style="padding:-1pt 2.0pt;"><em class="ltx_emph ltx_font_italic" id="S4.F4.24.24.7.2.1.1.1.1">GRF Interlacer</em></span></span>
<span class="ltx_tr" id="S4.F4.24.24.7.2.1.2">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S4.F4.24.24.7.2.1.2.1" style="padding:-1pt 2.0pt;"><em class="ltx_emph ltx_font_italic" id="S4.F4.24.24.7.2.1.2.1.1">prediction</em></span></span>
</span></span><span class="ltx_text" id="S4.F4.24.24.7.3"></span>   <span class="ltx_rule" style="width:0.8pt;background:black;display:inline-block;">&nbsp;</span>
</td>
<td class="ltx_td ltx_align_center" id="S4.F4.19.19.1" style="padding:-1pt 2.0pt;">
<span class="ltx_ERROR undefined" id="S4.F4.19.19.1.1">\adjustbox</span>valign=m<img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="44" id="S4.F4.19.19.1.g1" src="https://arxiv.org/html/2410.03462v1/extracted/5899751/iclr2024/final_renderings/3/00001_1.jpg" width="59">
</td>
<td class="ltx_td ltx_align_center" id="S4.F4.20.20.2" style="padding:-1pt 2.0pt;">
<span class="ltx_ERROR undefined" id="S4.F4.20.20.2.1">\adjustbox</span>valign=m<img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="43" id="S4.F4.20.20.2.g1" src="https://arxiv.org/html/2410.03462v1/extracted/5899751/iclr2024/final_renderings/3/00003_1.jpg" width="59">
</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.F4.21.21.3" style="padding:-1pt 2.0pt;">
<span class="ltx_ERROR undefined" id="S4.F4.21.21.3.1">\adjustbox</span>valign=m<img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="44" id="S4.F4.21.21.3.g1" src="https://arxiv.org/html/2410.03462v1/extracted/5899751/iclr2024/final_renderings/3/00005_1.jpg" width="59">
</td>
<td class="ltx_td ltx_align_center" id="S4.F4.22.22.4" style="padding:-1pt 2.0pt;">
<span class="ltx_ERROR undefined" id="S4.F4.22.22.4.1">\adjustbox</span>valign=m<img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="44" id="S4.F4.22.22.4.g1" src="https://arxiv.org/html/2410.03462v1/extracted/5899751/iclr2024/final_renderings/4/00001_1.jpg" width="59">
</td>
<td class="ltx_td ltx_align_center" id="S4.F4.23.23.5" style="padding:-1pt 2.0pt;">
<span class="ltx_ERROR undefined" id="S4.F4.23.23.5.1">\adjustbox</span>valign=m<img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="44" id="S4.F4.23.23.5.g1" src="https://arxiv.org/html/2410.03462v1/extracted/5899751/iclr2024/final_renderings/4/00004_1.jpg" width="59">
</td>
<td class="ltx_td ltx_align_center" id="S4.F4.24.24.6" style="padding:-1pt 2.0pt;">
<span class="ltx_ERROR undefined" id="S4.F4.24.24.6.1">\adjustbox</span>valign=m<img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="44" id="S4.F4.24.24.6.g1" src="https://arxiv.org/html/2410.03462v1/extracted/5899751/iclr2024/final_renderings/4/00005_1.jpg" width="59">
</td>
</tr>
<tr class="ltx_tr" id="S4.F4.30.30">
<td class="ltx_td ltx_align_right ltx_border_bb ltx_border_t" id="S4.F4.30.30.7" style="padding:-1pt 2.0pt;">
<span class="ltx_text" id="S4.F4.30.30.7.1"></span> <span class="ltx_text" id="S4.F4.30.30.7.2">
<span class="ltx_tabular ltx_align_middle" id="S4.F4.30.30.7.2.1">
<span class="ltx_tr" id="S4.F4.30.30.7.2.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S4.F4.30.30.7.2.1.1.1" style="padding:-1pt 2.0pt;"><em class="ltx_emph ltx_font_italic" id="S4.F4.30.30.7.2.1.1.1.1">Timestep</em></span></span>
</span></span><span class="ltx_text" id="S4.F4.30.30.7.3"></span>   <span class="ltx_rule" style="width:0.8pt;background:black;display:inline-block;">&nbsp;</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.F4.25.25.1" style="padding:-1pt 2.0pt;"><math alttext="t" class="ltx_Math" display="inline" id="S4.F4.25.25.1.m1.1"><semantics id="S4.F4.25.25.1.m1.1a"><mi id="S4.F4.25.25.1.m1.1.1" xref="S4.F4.25.25.1.m1.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S4.F4.25.25.1.m1.1b"><ci id="S4.F4.25.25.1.m1.1.1.cmml" xref="S4.F4.25.25.1.m1.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F4.25.25.1.m1.1c">t</annotation><annotation encoding="application/x-llamapun" id="S4.F4.25.25.1.m1.1d">italic_t</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.F4.26.26.2" style="padding:-1pt 2.0pt;"><math alttext="t+\Delta t" class="ltx_Math" display="inline" id="S4.F4.26.26.2.m1.1"><semantics id="S4.F4.26.26.2.m1.1a"><mrow id="S4.F4.26.26.2.m1.1.1" xref="S4.F4.26.26.2.m1.1.1.cmml"><mi id="S4.F4.26.26.2.m1.1.1.2" xref="S4.F4.26.26.2.m1.1.1.2.cmml">t</mi><mo id="S4.F4.26.26.2.m1.1.1.1" xref="S4.F4.26.26.2.m1.1.1.1.cmml">+</mo><mrow id="S4.F4.26.26.2.m1.1.1.3" xref="S4.F4.26.26.2.m1.1.1.3.cmml"><mi id="S4.F4.26.26.2.m1.1.1.3.2" mathvariant="normal" xref="S4.F4.26.26.2.m1.1.1.3.2.cmml">Δ</mi><mo id="S4.F4.26.26.2.m1.1.1.3.1" xref="S4.F4.26.26.2.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.F4.26.26.2.m1.1.1.3.3" xref="S4.F4.26.26.2.m1.1.1.3.3.cmml">t</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.F4.26.26.2.m1.1b"><apply id="S4.F4.26.26.2.m1.1.1.cmml" xref="S4.F4.26.26.2.m1.1.1"><plus id="S4.F4.26.26.2.m1.1.1.1.cmml" xref="S4.F4.26.26.2.m1.1.1.1"></plus><ci id="S4.F4.26.26.2.m1.1.1.2.cmml" xref="S4.F4.26.26.2.m1.1.1.2">𝑡</ci><apply id="S4.F4.26.26.2.m1.1.1.3.cmml" xref="S4.F4.26.26.2.m1.1.1.3"><times id="S4.F4.26.26.2.m1.1.1.3.1.cmml" xref="S4.F4.26.26.2.m1.1.1.3.1"></times><ci id="S4.F4.26.26.2.m1.1.1.3.2.cmml" xref="S4.F4.26.26.2.m1.1.1.3.2">Δ</ci><ci id="S4.F4.26.26.2.m1.1.1.3.3.cmml" xref="S4.F4.26.26.2.m1.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F4.26.26.2.m1.1c">t+\Delta t</annotation><annotation encoding="application/x-llamapun" id="S4.F4.26.26.2.m1.1d">italic_t + roman_Δ italic_t</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t" id="S4.F4.27.27.3" style="padding:-1pt 2.0pt;"><math alttext="t+2\Delta t" class="ltx_Math" display="inline" id="S4.F4.27.27.3.m1.1"><semantics id="S4.F4.27.27.3.m1.1a"><mrow id="S4.F4.27.27.3.m1.1.1" xref="S4.F4.27.27.3.m1.1.1.cmml"><mi id="S4.F4.27.27.3.m1.1.1.2" xref="S4.F4.27.27.3.m1.1.1.2.cmml">t</mi><mo id="S4.F4.27.27.3.m1.1.1.1" xref="S4.F4.27.27.3.m1.1.1.1.cmml">+</mo><mrow id="S4.F4.27.27.3.m1.1.1.3" xref="S4.F4.27.27.3.m1.1.1.3.cmml"><mn id="S4.F4.27.27.3.m1.1.1.3.2" xref="S4.F4.27.27.3.m1.1.1.3.2.cmml">2</mn><mo id="S4.F4.27.27.3.m1.1.1.3.1" xref="S4.F4.27.27.3.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.F4.27.27.3.m1.1.1.3.3" mathvariant="normal" xref="S4.F4.27.27.3.m1.1.1.3.3.cmml">Δ</mi><mo id="S4.F4.27.27.3.m1.1.1.3.1a" xref="S4.F4.27.27.3.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.F4.27.27.3.m1.1.1.3.4" xref="S4.F4.27.27.3.m1.1.1.3.4.cmml">t</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.F4.27.27.3.m1.1b"><apply id="S4.F4.27.27.3.m1.1.1.cmml" xref="S4.F4.27.27.3.m1.1.1"><plus id="S4.F4.27.27.3.m1.1.1.1.cmml" xref="S4.F4.27.27.3.m1.1.1.1"></plus><ci id="S4.F4.27.27.3.m1.1.1.2.cmml" xref="S4.F4.27.27.3.m1.1.1.2">𝑡</ci><apply id="S4.F4.27.27.3.m1.1.1.3.cmml" xref="S4.F4.27.27.3.m1.1.1.3"><times id="S4.F4.27.27.3.m1.1.1.3.1.cmml" xref="S4.F4.27.27.3.m1.1.1.3.1"></times><cn id="S4.F4.27.27.3.m1.1.1.3.2.cmml" type="integer" xref="S4.F4.27.27.3.m1.1.1.3.2">2</cn><ci id="S4.F4.27.27.3.m1.1.1.3.3.cmml" xref="S4.F4.27.27.3.m1.1.1.3.3">Δ</ci><ci id="S4.F4.27.27.3.m1.1.1.3.4.cmml" xref="S4.F4.27.27.3.m1.1.1.3.4">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F4.27.27.3.m1.1c">t+2\Delta t</annotation><annotation encoding="application/x-llamapun" id="S4.F4.27.27.3.m1.1d">italic_t + 2 roman_Δ italic_t</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.F4.28.28.4" style="padding:-1pt 2.0pt;"><math alttext="t" class="ltx_Math" display="inline" id="S4.F4.28.28.4.m1.1"><semantics id="S4.F4.28.28.4.m1.1a"><mi id="S4.F4.28.28.4.m1.1.1" xref="S4.F4.28.28.4.m1.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S4.F4.28.28.4.m1.1b"><ci id="S4.F4.28.28.4.m1.1.1.cmml" xref="S4.F4.28.28.4.m1.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F4.28.28.4.m1.1c">t</annotation><annotation encoding="application/x-llamapun" id="S4.F4.28.28.4.m1.1d">italic_t</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.F4.29.29.5" style="padding:-1pt 2.0pt;"><math alttext="t+\Delta t" class="ltx_Math" display="inline" id="S4.F4.29.29.5.m1.1"><semantics id="S4.F4.29.29.5.m1.1a"><mrow id="S4.F4.29.29.5.m1.1.1" xref="S4.F4.29.29.5.m1.1.1.cmml"><mi id="S4.F4.29.29.5.m1.1.1.2" xref="S4.F4.29.29.5.m1.1.1.2.cmml">t</mi><mo id="S4.F4.29.29.5.m1.1.1.1" xref="S4.F4.29.29.5.m1.1.1.1.cmml">+</mo><mrow id="S4.F4.29.29.5.m1.1.1.3" xref="S4.F4.29.29.5.m1.1.1.3.cmml"><mi id="S4.F4.29.29.5.m1.1.1.3.2" mathvariant="normal" xref="S4.F4.29.29.5.m1.1.1.3.2.cmml">Δ</mi><mo id="S4.F4.29.29.5.m1.1.1.3.1" xref="S4.F4.29.29.5.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.F4.29.29.5.m1.1.1.3.3" xref="S4.F4.29.29.5.m1.1.1.3.3.cmml">t</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.F4.29.29.5.m1.1b"><apply id="S4.F4.29.29.5.m1.1.1.cmml" xref="S4.F4.29.29.5.m1.1.1"><plus id="S4.F4.29.29.5.m1.1.1.1.cmml" xref="S4.F4.29.29.5.m1.1.1.1"></plus><ci id="S4.F4.29.29.5.m1.1.1.2.cmml" xref="S4.F4.29.29.5.m1.1.1.2">𝑡</ci><apply id="S4.F4.29.29.5.m1.1.1.3.cmml" xref="S4.F4.29.29.5.m1.1.1.3"><times id="S4.F4.29.29.5.m1.1.1.3.1.cmml" xref="S4.F4.29.29.5.m1.1.1.3.1"></times><ci id="S4.F4.29.29.5.m1.1.1.3.2.cmml" xref="S4.F4.29.29.5.m1.1.1.3.2">Δ</ci><ci id="S4.F4.29.29.5.m1.1.1.3.3.cmml" xref="S4.F4.29.29.5.m1.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F4.29.29.5.m1.1c">t+\Delta t</annotation><annotation encoding="application/x-llamapun" id="S4.F4.29.29.5.m1.1d">italic_t + roman_Δ italic_t</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.F4.30.30.6" style="padding:-1pt 2.0pt;"><math alttext="t+2\Delta t" class="ltx_Math" display="inline" id="S4.F4.30.30.6.m1.1"><semantics id="S4.F4.30.30.6.m1.1a"><mrow id="S4.F4.30.30.6.m1.1.1" xref="S4.F4.30.30.6.m1.1.1.cmml"><mi id="S4.F4.30.30.6.m1.1.1.2" xref="S4.F4.30.30.6.m1.1.1.2.cmml">t</mi><mo id="S4.F4.30.30.6.m1.1.1.1" xref="S4.F4.30.30.6.m1.1.1.1.cmml">+</mo><mrow id="S4.F4.30.30.6.m1.1.1.3" xref="S4.F4.30.30.6.m1.1.1.3.cmml"><mn id="S4.F4.30.30.6.m1.1.1.3.2" xref="S4.F4.30.30.6.m1.1.1.3.2.cmml">2</mn><mo id="S4.F4.30.30.6.m1.1.1.3.1" xref="S4.F4.30.30.6.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.F4.30.30.6.m1.1.1.3.3" mathvariant="normal" xref="S4.F4.30.30.6.m1.1.1.3.3.cmml">Δ</mi><mo id="S4.F4.30.30.6.m1.1.1.3.1a" xref="S4.F4.30.30.6.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.F4.30.30.6.m1.1.1.3.4" xref="S4.F4.30.30.6.m1.1.1.3.4.cmml">t</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.F4.30.30.6.m1.1b"><apply id="S4.F4.30.30.6.m1.1.1.cmml" xref="S4.F4.30.30.6.m1.1.1"><plus id="S4.F4.30.30.6.m1.1.1.1.cmml" xref="S4.F4.30.30.6.m1.1.1.1"></plus><ci id="S4.F4.30.30.6.m1.1.1.2.cmml" xref="S4.F4.30.30.6.m1.1.1.2">𝑡</ci><apply id="S4.F4.30.30.6.m1.1.1.3.cmml" xref="S4.F4.30.30.6.m1.1.1.3"><times id="S4.F4.30.30.6.m1.1.1.3.1.cmml" xref="S4.F4.30.30.6.m1.1.1.3.1"></times><cn id="S4.F4.30.30.6.m1.1.1.3.2.cmml" type="integer" xref="S4.F4.30.30.6.m1.1.1.3.2">2</cn><ci id="S4.F4.30.30.6.m1.1.1.3.3.cmml" xref="S4.F4.30.30.6.m1.1.1.3.3">Δ</ci><ci id="S4.F4.30.30.6.m1.1.1.3.4.cmml" xref="S4.F4.30.30.6.m1.1.1.3.4">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F4.30.30.6.m1.1c">t+2\Delta t</annotation><annotation encoding="application/x-llamapun" id="S4.F4.30.30.6.m1.1d">italic_t + 2 roman_Δ italic_t</annotation></semantics></math></td>
</tr>
</tbody></table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>Rendered rollouts. NeRF renderings of the predictive dynamics of a bimanual Kuka robot, conditioned on the initial scene and sequence of robot actions.
We show four tasks: using a dustpan and brush, lifting a can, moving a green block, and dropping a can.
GRF Interlacers model point cloud dynamics more accurately, so the predicted frame rendings are closer to the ground truth.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_figure ltx_align_floatright" id="S4.F5"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="581" id="S4.F5.g1" src="https://arxiv.org/html/2410.03462v1/x2.png" width="813">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>Accuracy comparison.
Structural similarity index measure (SSIM) between ground truth camera frames and predictive NeRF renderings after <math alttext="100" class="ltx_Math" display="inline" id="S4.F5.2.m1.1"><semantics id="S4.F5.2.m1.1b"><mn id="S4.F5.2.m1.1.1" xref="S4.F5.2.m1.1.1.cmml">100</mn><annotation-xml encoding="MathML-Content" id="S4.F5.2.m1.1c"><cn id="S4.F5.2.m1.1.1.cmml" type="integer" xref="S4.F5.2.m1.1.1">100</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.F5.2.m1.1d">100</annotation><annotation encoding="application/x-llamapun" id="S4.F5.2.m1.1e">100</annotation></semantics></math>k training steps, plotted against rollout timestep. Higher is better.
GRFs improve the accuracy of dynamics prediction compared to the baselines.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S4.p8">
<p class="ltx_p" id="S4.p8.7">In contrast to our previous experiments, for HD-VPD the underlying graph <math alttext="\mathcal{G}" class="ltx_Math" display="inline" id="S4.p8.1.m1.1"><semantics id="S4.p8.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S4.p8.1.m1.1.1" xref="S4.p8.1.m1.1.1.cmml">𝒢</mi><annotation-xml encoding="MathML-Content" id="S4.p8.1.m1.1b"><ci id="S4.p8.1.m1.1.1.cmml" xref="S4.p8.1.m1.1.1">𝒢</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p8.1.m1.1c">\mathcal{G}</annotation><annotation encoding="application/x-llamapun" id="S4.p8.1.m1.1d">caligraphic_G</annotation></semantics></math> is no longer fixed so walks cannot be pre-computed.
Instead, we construct them on the fly, using an approximate <math alttext="k" class="ltx_Math" display="inline" id="S4.p8.2.m2.1"><semantics id="S4.p8.2.m2.1a"><mi id="S4.p8.2.m2.1.1" xref="S4.p8.2.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.p8.2.m2.1b"><ci id="S4.p8.2.m2.1.1.cmml" xref="S4.p8.2.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p8.2.m2.1c">k</annotation><annotation encoding="application/x-llamapun" id="S4.p8.2.m2.1d">italic_k</annotation></semantics></math>-nearest neighbours solver to get adjacency lists of length <math alttext="k=3" class="ltx_Math" display="inline" id="S4.p8.3.m3.1"><semantics id="S4.p8.3.m3.1a"><mrow id="S4.p8.3.m3.1.1" xref="S4.p8.3.m3.1.1.cmml"><mi id="S4.p8.3.m3.1.1.2" xref="S4.p8.3.m3.1.1.2.cmml">k</mi><mo id="S4.p8.3.m3.1.1.1" xref="S4.p8.3.m3.1.1.1.cmml">=</mo><mn id="S4.p8.3.m3.1.1.3" xref="S4.p8.3.m3.1.1.3.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.p8.3.m3.1b"><apply id="S4.p8.3.m3.1.1.cmml" xref="S4.p8.3.m3.1.1"><eq id="S4.p8.3.m3.1.1.1.cmml" xref="S4.p8.3.m3.1.1.1"></eq><ci id="S4.p8.3.m3.1.1.2.cmml" xref="S4.p8.3.m3.1.1.2">𝑘</ci><cn id="S4.p8.3.m3.1.1.3.cmml" type="integer" xref="S4.p8.3.m3.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p8.3.m3.1c">k=3</annotation><annotation encoding="application/x-llamapun" id="S4.p8.3.m3.1d">italic_k = 3</annotation></semantics></math> for each node.
We use repelling random walks for variance reduction <cite class="ltx_cite ltx_citemacro_citep">(Reid et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#bib.bib28" title="">2024a</a>)</cite>, sampling <math alttext="3" class="ltx_Math" display="inline" id="S4.p8.4.m4.1"><semantics id="S4.p8.4.m4.1a"><mn id="S4.p8.4.m4.1.1" xref="S4.p8.4.m4.1.1.cmml">3</mn><annotation-xml encoding="MathML-Content" id="S4.p8.4.m4.1b"><cn id="S4.p8.4.m4.1.1.cmml" type="integer" xref="S4.p8.4.m4.1.1">3</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.p8.4.m4.1c">3</annotation><annotation encoding="application/x-llamapun" id="S4.p8.4.m4.1d">3</annotation></semantics></math> hops.
For easy integration with existing Interlacer code, we use <em class="ltx_emph ltx_font_italic" id="S4.p8.7.1">asymmetric</em> GRFs <cite class="ltx_cite ltx_citemacro_citep">(App.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#A4" title="Appendix D Asymmetric graph random features ‣ Linear Transformer Topological Masking with Graph Random Features"><span class="ltx_text ltx_ref_tag">D</span></a>; Reid et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#bib.bib29" title="">2024b</a>)</cite>.
We consider point clouds with <math alttext="N=32768" class="ltx_Math" display="inline" id="S4.p8.5.m5.1"><semantics id="S4.p8.5.m5.1a"><mrow id="S4.p8.5.m5.1.1" xref="S4.p8.5.m5.1.1.cmml"><mi id="S4.p8.5.m5.1.1.2" xref="S4.p8.5.m5.1.1.2.cmml">N</mi><mo id="S4.p8.5.m5.1.1.1" xref="S4.p8.5.m5.1.1.1.cmml">=</mo><mn id="S4.p8.5.m5.1.1.3" xref="S4.p8.5.m5.1.1.3.cmml">32768</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.p8.5.m5.1b"><apply id="S4.p8.5.m5.1.1.cmml" xref="S4.p8.5.m5.1.1"><eq id="S4.p8.5.m5.1.1.1.cmml" xref="S4.p8.5.m5.1.1.1"></eq><ci id="S4.p8.5.m5.1.1.2.cmml" xref="S4.p8.5.m5.1.1.2">𝑁</ci><cn id="S4.p8.5.m5.1.1.3.cmml" type="integer" xref="S4.p8.5.m5.1.1.3">32768</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p8.5.m5.1c">N=32768</annotation><annotation encoding="application/x-llamapun" id="S4.p8.5.m5.1d">italic_N = 32768</annotation></semantics></math> particles, which is too many to explicitly instantiate <math alttext="\mathbf{A}" class="ltx_Math" display="inline" id="S4.p8.6.m6.1"><semantics id="S4.p8.6.m6.1a"><mi id="S4.p8.6.m6.1.1" xref="S4.p8.6.m6.1.1.cmml">𝐀</mi><annotation-xml encoding="MathML-Content" id="S4.p8.6.m6.1b"><ci id="S4.p8.6.m6.1.1.cmml" xref="S4.p8.6.m6.1.1">𝐀</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p8.6.m6.1c">\mathbf{A}</annotation><annotation encoding="application/x-llamapun" id="S4.p8.6.m6.1d">bold_A</annotation></semantics></math> or <math alttext="\mathbf{M}" class="ltx_Math" display="inline" id="S4.p8.7.m7.1"><semantics id="S4.p8.7.m7.1a"><mi id="S4.p8.7.m7.1.1" xref="S4.p8.7.m7.1.1.cmml">𝐌</mi><annotation-xml encoding="MathML-Content" id="S4.p8.7.m7.1b"><ci id="S4.p8.7.m7.1.1.cmml" xref="S4.p8.7.m7.1.1">𝐌</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p8.7.m7.1c">\mathbf{M}</annotation><annotation encoding="application/x-llamapun" id="S4.p8.7.m7.1d">bold_M</annotation></semantics></math> in memory.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S4.p9">
<p class="ltx_p" id="S4.p9.1">Fig.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#S4.F4" title="Figure 4 ‣ 4 Experiments ‣ Linear Transformer Topological Masking with Graph Random Features"><span class="ltx_text ltx_ref_tag">4</span></a> shows example NeRF renderings of test set predictive dynamics for four rollouts.
Since the model is deterministic, predictions blur with long time horizons.
Incorporating a diffusion head <cite class="ltx_cite ltx_citemacro_citep">(Song et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#bib.bib34" title="">2020</a>)</cite> is left to future work.
Fig.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#S4.F5" title="Figure 5 ‣ 4 Experiments ‣ Linear Transformer Topological Masking with Graph Random Features"><span class="ltx_text ltx_ref_tag">5</span></a> shows predicted video frame accuracy (image SSIM) vs. rollout timestep for each model.
GRFs outperform the vanilla transformer and MP Interlacer baselines, modelling the particle dynamics more faithfully.
We include examples of predictive videos in the supplementary material.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Conclusion</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S5.p1">
<p class="ltx_p" id="S5.p1.1">We have presented the first linear algorithm for transformer topological masking on general graphs, based on sampling random walks.
It uses graph random features, for which we have proved the first known concentration inequalities and sparsity guarantees.
Our algorithm brings strong performance gains across data modalities, including on massive point clouds with <math alttext=">30" class="ltx_Math" display="inline" id="S5.p1.1.m1.1"><semantics id="S5.p1.1.m1.1a"><mrow id="S5.p1.1.m1.1.1" xref="S5.p1.1.m1.1.1.cmml"><mi id="S5.p1.1.m1.1.1.2" xref="S5.p1.1.m1.1.1.2.cmml"></mi><mo id="S5.p1.1.m1.1.1.1" xref="S5.p1.1.m1.1.1.1.cmml">&gt;</mo><mn id="S5.p1.1.m1.1.1.3" xref="S5.p1.1.m1.1.1.3.cmml">30</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.p1.1.m1.1b"><apply id="S5.p1.1.m1.1.1.cmml" xref="S5.p1.1.m1.1.1"><gt id="S5.p1.1.m1.1.1.1.cmml" xref="S5.p1.1.m1.1.1.1"></gt><csymbol cd="latexml" id="S5.p1.1.m1.1.1.2.cmml" xref="S5.p1.1.m1.1.1.2">absent</csymbol><cn id="S5.p1.1.m1.1.1.3.cmml" type="integer" xref="S5.p1.1.m1.1.1.3">30</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p1.1.m1.1c">&gt;30</annotation><annotation encoding="application/x-llamapun" id="S5.p1.1.m1.1d">&gt; 30</annotation></semantics></math>k particles for which computational efficiency is essential.
Future work might include improving hardware and libraries for high-dimensional sparse linear algebra to fully benefit from the guaranteed complexity improvements, and investigating whether dimensionality reduction techniques like the Johnson-Lindenstrauss transform <cite class="ltx_cite ltx_citemacro_citep">(Dasgupta et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#bib.bib10" title="">2010</a>)</cite> can be applied to GRFs for further speedups.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
<section class="ltx_section" id="S6">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Ethics and reproducibility</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S6.p1">
<p class="ltx_p" id="S6.p1.1"><span class="ltx_text ltx_font_bold" id="S6.p1.1.1">Ethics statement</span>: Our work is foundational with no immediate ethical concerns apparent to us.
However, increases in scalability provided by improvements to efficient transformers could exacerbate existing and incipient risks of machine learning, from bad actors or as unintended consequences.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S6.p2">
<p class="ltx_p" id="S6.p2.1"><span class="ltx_text ltx_font_bold" id="S6.p2.1.1">Reproducibility statement</span>:
We have made every effort to ensure the work’s reproducibility.
The core algorithm is presented clearly in Alg.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#alg1" title="Algorithm 1 ‣ 3.5 Algorithm and intuitive picture ‣ 3 Towards linear topological masking ‣ Linear Transformer Topological Masking with Graph Random Features"><span class="ltx_text ltx_ref_tag">1</span></a>.
Theoretical results are proved with accompanying assumptions in Sec.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#S3.SS4" title="3.4 Novel theoretical results for GRFs: sharp estimators with sparse features ‣ 3 Towards linear topological masking ‣ Linear Transformer Topological Masking with Graph Random Features"><span class="ltx_text ltx_ref_tag">3.4</span></a> and App.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#A1.SS2" title="A.2 Proof of Thm. 3.1 (novel) ‣ Appendix A Proofs ‣ Linear Transformer Topological Masking with Graph Random Features"><span class="ltx_text ltx_ref_tag">A.2</span></a>.
Proof sketches are also included for clarity.
We will make source code available once accepted.
Apart from the robotics dataset, all datasets are standard and freely available online.
Exhaustive experimental details about the training and architectures are reported in App.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#A3" title="Appendix C Further experiments and details ‣ Linear Transformer Topological Masking with Graph Random Features"><span class="ltx_text ltx_ref_tag">C</span></a>; see especially Table <a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#A3.T2" title="Table 2 ‣ C.1 Architectures, hyperparameters and training details ‣ Appendix C Further experiments and details ‣ Linear Transformer Topological Masking with Graph Random Features"><span class="ltx_text ltx_ref_tag">2</span></a>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_section" id="S7">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">7 </span>Contributions and acknowledgements</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S7.p1">
<p class="ltx_p" id="S7.p1.1"><span class="ltx_text ltx_font_bold" id="S7.p1.1.1">Relative contributions.</span>
IR and KC conceptualised the project and co-designed the algorithms.
IR proved the theoretical results, implemented the GRFs code, ran the Interlacer experiments and wrote the text.
KAD was crucially involved throughout, running the ViT and ViViT experiments and guiding the project’s direction.
DJ and WW helped set up the Interlacer experiments.
AA, JA, AB, MJ, AM, DR, CS, RT, RW and AW provided thoughtful feedback on the project and manuscript, helped set up experimental infrastructure, and made Cambridge and Google great places to work.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S7.p2">
<p class="ltx_p" id="S7.p2.1"><span class="ltx_text ltx_font_bold" id="S7.p2.1.1">Acknowledgements and funding.</span>
IR acknowledges support from a Trinity College External Studentship.
This work was completed whilst employed as a student researcher at Google.
IR sincerely thanks Silvio Lattanzi for making this possible.
RET is supported by Google, Amazon, ARM, Improbable and an EPSRC grant EP/T005386/1.
AW acknowledges support from a Turing AI fellowship under grant EP/V025279/1 and the Leverhulme Trust via CFI.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Arnab et&nbsp;al. (2021)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Anurag Arnab, Mostafa Dehghani, Georg Heigold, Chen Sun, Mario Lučić, and Cordelia Schmid.

</span>
<span class="ltx_bibblock">Vivit: A video vision transformer.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib1.1.1">Proceedings of the IEEE/CVF international conference on computer vision</em>, pages 6836–6846, 2021.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.48550/arXiv.2103.15691" title="">https://doi.org/10.48550/arXiv.2103.15691</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Borgwardt et&nbsp;al. (2005)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Karsten&nbsp;M Borgwardt, Cheng&nbsp;Soon Ong, Stefan Schönauer, SVN Vishwanathan, Alex&nbsp;J Smola, and Hans-Peter Kriegel.

</span>
<span class="ltx_bibblock">Protein function prediction via graph kernels.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib2.1.1">Bioinformatics</em>, 21(suppl_1):i47–i56, 2005.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1093/bioinformatics/bti1007" title="">https://doi.org/10.1093/bioinformatics/bti1007</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Borovitskiy et&nbsp;al. (2021)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Viacheslav Borovitskiy, Iskander Azangulov, Alexander Terenin, Peter Mostowsky, Marc Deisenroth, and Nicolas Durrande.

</span>
<span class="ltx_bibblock">Matérn gaussian processes on graphs.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib3.1.1">International Conference on Artificial Intelligence and Statistics</em>, pages 2593–2601. PMLR, 2021.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.48550/arXiv.2010.15538" title="">https://doi.org/10.48550/arXiv.2010.15538</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et&nbsp;al. (2024)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Huiyuan Chen, Zhe Xu, Chin-Chia&nbsp;Michael Yeh, Vivian Lai, Yan Zheng, Minghua Xu, and Hanghang Tong.

</span>
<span class="ltx_bibblock">Masked graph transformer for large-scale recommendation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib4.1.1">Proceedings of the 47th International ACM SIGIR Conference on Research and Development in Information Retrieval</em>, pages 2502–2506, 2024.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3626772.3657971" title="">https://doi.org/10.1145/3626772.3657971</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Choromanski et&nbsp;al. (2020)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Krzysztof Choromanski, Valerii Likhosherstov, David Dohan, Xingyou Song, Andreea Gane, Tamas Sarlos, Peter Hawkins, Jared Davis, Afroz Mohiuddin, Lukasz Kaiser, et&nbsp;al.

</span>
<span class="ltx_bibblock">Rethinking attention with performers.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib5.1.1">arXiv preprint arXiv:2009.14794</em>, 2020.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.48550/arXiv.2009.14794" title="">https://doi.org/10.48550/arXiv.2009.14794</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Choromanski et&nbsp;al. (2021)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Krzysztof Choromanski, Haoxian Chen, Han Lin, Yuanzhe Ma, Arijit Sehanobish, Deepali Jain, Michael&nbsp;S Ryoo, Jake Varley, Andy Zeng, Valerii Likhosherstov, et&nbsp;al.

</span>
<span class="ltx_bibblock">Hybrid random features.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib6.1.1">arXiv preprint arXiv:2110.04367</em>, 2021.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.48550/arXiv.2110.04367" title="">https://doi.org/10.48550/arXiv.2110.04367</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Choromanski et&nbsp;al. (2022)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Krzysztof Choromanski, Han Lin, Haoxian Chen, Tianyi Zhang, Arijit Sehanobish, Valerii Likhosherstov, Jack Parker-Holder, Tamas Sarlos, Adrian Weller, and Thomas Weingarten.

</span>
<span class="ltx_bibblock">From block-toeplitz matrices to differential equations on graphs: towards a general theory for scalable masked transformers.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib7.1.1">International Conference on Machine Learning</em>, pages 3962–3983. PMLR, 2022.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.48550/arXiv.2107.07999" title="">https://doi.org/10.48550/arXiv.2107.07999</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Choromanski (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Krzysztof&nbsp;Marcin Choromanski.

</span>
<span class="ltx_bibblock">Taming graph kernels with random features.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib8.1.1">International Conference on Machine Learning</em>, pages 5964–5977. PMLR, 2023.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.48550/arXiv.2305.00156" title="">https://doi.org/10.48550/arXiv.2305.00156</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Crane et&nbsp;al. (2017)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Keenan Crane, Clarisse Weischedel, and Max Wardetzky.

</span>
<span class="ltx_bibblock">The heat method for distance computation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib9.1.1">Communications of the ACM</em>, 60(11):90–99, 2017.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://dl.acm.org/doi/10.1145/3131280" title="">https://dl.acm.org/doi/10.1145/3131280</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dasgupta et&nbsp;al. (2010)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Anirban Dasgupta, Ravi Kumar, and Tamás Sarlós.

</span>
<span class="ltx_bibblock">A sparse johnson: Lindenstrauss transform.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib10.1.1">Proceedings of the forty-second ACM symposium on Theory of computing</em>, pages 341–350, 2010.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/1806689.1806737" title="">https://doi.org/10.1145/1806689.1806737</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Deng et&nbsp;al. (2009)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Jia Deng, Wei Dong, Richard Socher, Li-Jia Li, Kai Li, and Li&nbsp;Fei-Fei.

</span>
<span class="ltx_bibblock">Imagenet: A large-scale hierarchical image database.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib11.1.1">2009 IEEE conference on computer vision and pattern recognition</em>, pages 248–255. Ieee, 2009.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1109/CVPR.2009.5206848" title="">https://doi.org/10.1109/CVPR.2009.5206848</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Doob (1940)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Joseph&nbsp;L Doob.

</span>
<span class="ltx_bibblock">Regularity properties of certain families of chance variables.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib12.1.1">Transactions of the American Mathematical Society</em>, 47(3):455–486, 1940.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dosovitskiy et&nbsp;al. (2020)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Alexey Dosovitskiy, Lucas Beyer, Alexander Kolesnikov, Dirk Weissenborn, Xiaohua Zhai, Thomas Unterthiner, Mostafa Dehghani, Matthias Minderer, Georg Heigold, Sylvain Gelly, et&nbsp;al.

</span>
<span class="ltx_bibblock">An image is worth 16x16 words: Transformers for image recognition at scale.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib13.1.1">arXiv preprint arXiv:2010.11929</em>, 2020.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.48550/arXiv.2010.11929" title="">https://doi.org/10.48550/arXiv.2010.11929</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gretton (2013)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Arthur Gretton.

</span>
<span class="ltx_bibblock">Introduction to rkhs, and some simple kernel algorithms.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib14.1.1">Adv. Top. Mach. Learn. Lecture Conducted from University College London</em>, 16(5-3):2, 2013.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://www.gatsby.ucl.ac.uk/~gretton/coursefiles/lecture4_introToRKHS.pdf" title="">https://www.gatsby.ucl.ac.uk/~gretton/coursefiles/lecture4_introToRKHS.pdf</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Horn et&nbsp;al. (2018)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Grant&nbsp;Van Horn, Oisin&nbsp;Mac Aodha, Yang Song, Yin Cui, Chen Sun, Alexander Shepard, Hartwig Adam, Pietro Perona, and Serge&nbsp;J. Belongie.

</span>
<span class="ltx_bibblock">The inaturalist species classification and detection dataset.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib15.1.1">2018 IEEE Conference on Computer Vision and Pattern Recognition, CVPR 2018, Salt Lake City, UT, USA, June 18-22, 2018</em>, pages 8769–8778. Computer Vision Foundation / IEEE Computer Society, 2018.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.1109/CVPR.2018.00914</span>.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="http://openaccess.thecvf.com/content_cvpr_2018/html/Van_Horn_The_INaturalist_Species_CVPR_2018_paper.html" title="">http://openaccess.thecvf.com/content_cvpr_2018/html/Van_Horn_The_INaturalist_Species_CVPR_2018_paper.html</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Katharopoulos et&nbsp;al. (2020)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Angelos Katharopoulos, Apoorv Vyas, Nikolaos Pappas, and François Fleuret.

</span>
<span class="ltx_bibblock">Transformers are rnns: Fast autoregressive transformers with linear attention.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib16.1.1">International conference on machine learning</em>, pages 5156–5165. PMLR, 2020.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.48550/arXiv.2006.16236" title="">https://doi.org/10.48550/arXiv.2006.16236</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kay et&nbsp;al. (2017)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Will Kay, Joao Carreira, Karen Simonyan, Brian Zhang, Chloe Hillier, Sudheendra Vijayanarasimhan, Fabio Viola, Tim Green, Trevor Back, Paul Natsev, et&nbsp;al.

</span>
<span class="ltx_bibblock">The kinetics human action video dataset.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib17.1.1">arXiv preprint arXiv:1705.06950</em>, 2017.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.48550/arXiv.1705.06950" title="">https://doi.org/10.48550/arXiv.1705.06950</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kloster and Gleich (2014)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Kyle Kloster and David&nbsp;F Gleich.

</span>
<span class="ltx_bibblock">Heat kernel based community detection.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib18.1.1">Proceedings of the 20th ACM SIGKDD international conference on Knowledge discovery and data mining</em>, pages 1386–1395, 2014.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.48550/arXiv.1403.3148" title="">https://doi.org/10.48550/arXiv.1403.3148</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kondor and Lafferty (2002)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Risi&nbsp;Imre Kondor and John Lafferty.

</span>
<span class="ltx_bibblock">Diffusion kernels on graphs and other discrete structures.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib19.1.1">Proceedings of the 19th international conference on machine learning</em>, volume 2002, pages 315–322, 2002.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://www.ml.cmu.edu/research/dap-papers/kondor-diffusion-kernels.pdf" title="">https://www.ml.cmu.edu/research/dap-papers/kondor-diffusion-kernels.pdf</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Likhosherstov et&nbsp;al. (2024)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Valerii Likhosherstov, Krzysztof&nbsp;M Choromanski, Kumar&nbsp;Avinava Dubey, Frederick Liu, Tamas Sarlos, and Adrian Weller.

</span>
<span class="ltx_bibblock">Dense-exponential random features: sharp positive estimators of the gaussian kernel.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib20.1.1">Advances in Neural Information Processing Systems</em>, 36, 2024.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://dl.acm.org/doi/10.5555/3666122.3666168" title="">https://dl.acm.org/doi/10.5555/3666122.3666168</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liutkus et&nbsp;al. (2021)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Antoine Liutkus, Ondřej Cıfka, Shih-Lun Wu, Umut Simsekli, Yi-Hsuan Yang, and Gael Richard.

</span>
<span class="ltx_bibblock">Relative positional encoding for transformers with linear complexity.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib21.1.1">International Conference on Machine Learning</em>, pages 7067–7079. PMLR, 2021.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.48550/arXiv.2105.08399" title="">https://doi.org/10.48550/arXiv.2105.08399</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Loshchilov (2017)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
I&nbsp;Loshchilov.

</span>
<span class="ltx_bibblock">Decoupled weight decay regularization.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib22.1.1">arXiv preprint arXiv:1711.05101</em>, 2017.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.48550/arXiv.1711.05101" title="">https://doi.org/10.48550/arXiv.1711.05101</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Luo et&nbsp;al. (2021)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Shengjie Luo, Shanda Li, Tianle Cai, Di&nbsp;He, Dinglan Peng, Shuxin Zheng, Guolin Ke, Liwei Wang, and Tie-Yan Liu.

</span>
<span class="ltx_bibblock">Stable, fast and accurate: Kernelized attention with relative positional encoding.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib23.1.1">Advances in Neural Information Processing Systems</em>, 34:22795–22807, 2021.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.48550/arXiv.2106.12566" title="">https://doi.org/10.48550/arXiv.2106.12566</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mildenhall et&nbsp;al. (2021)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Ben Mildenhall, Pratul&nbsp;P Srinivasan, Matthew Tancik, Jonathan&nbsp;T Barron, Ravi Ramamoorthi, and Ren Ng.

</span>
<span class="ltx_bibblock">Nerf: Representing scenes as neural radiance fields for view synthesis.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib24.1.1">Communications of the ACM</em>, 65(1):99–106, 2021.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.48550/arXiv.2003.08934" title="">https://doi.org/10.48550/arXiv.2003.08934</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Morris et&nbsp;al. (2019)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Christopher Morris, Martin Ritzert, Matthias Fey, William&nbsp;L Hamilton, Jan&nbsp;Eric Lenssen, Gaurav Rattan, and Martin Grohe.

</span>
<span class="ltx_bibblock">Weisfeiler and leman go neural: Higher-order graph neural networks.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib25.1.1">Proceedings of the AAAI conference on artificial intelligence</em>, volume&nbsp;33, pages 4602–4609, 2019.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.48550/arXiv.1810.02244" title="">https://doi.org/10.48550/arXiv.1810.02244</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Reid et&nbsp;al. (2023a)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Isaac Reid, Krzysztof Choromanski, and Adrian Weller.

</span>
<span class="ltx_bibblock">Quasi-monte carlo graph random features.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib26.1.1">arXiv preprint arXiv:2305.12470</em>, 2023a.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.48550/arXiv.2305.12470" title="">https://doi.org/10.48550/arXiv.2305.12470</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Reid et&nbsp;al. (2023b)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Isaac Reid, Krzysztof&nbsp;Marcin Choromanski, Valerii Likhosherstov, and Adrian Weller.

</span>
<span class="ltx_bibblock">Simplex random features.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib27.1.1">International Conference on Machine Learning</em>, pages 28864–28888. PMLR, 2023b.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.48550/arXiv.2301.13856" title="">https://doi.org/10.48550/arXiv.2301.13856</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Reid et&nbsp;al. (2024a)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Isaac Reid, Eli Berger, Krzysztof Choromanski, and Adrian Weller.

</span>
<span class="ltx_bibblock">Repelling random walks.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib28.1.1">International Conference on Learning Representations</em>, 2024a.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.48550/arXiv.2310.04854" title="">https://doi.org/10.48550/arXiv.2310.04854</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Reid et&nbsp;al. (2024b)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Isaac Reid, Krzysztof Choromanski, Eli Berger, and Adrian Weller.

</span>
<span class="ltx_bibblock">General graph random features.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib29.1.1">International Conference on Learning Representations</em>, 2024b.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.48550/arXiv.2310.04859" title="">https://doi.org/10.48550/arXiv.2310.04859</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Reid et&nbsp;al. (2024c)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Isaac Reid, Stratis Markou, Krzysztof Choromanski, Richard&nbsp;E Turner, and Adrian Weller.

</span>
<span class="ltx_bibblock">Variance-reducing couplings for random features: Perspectives from optimal transport.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib30.1.1">arXiv preprint arXiv:2405.16541</em>, 2024c.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.48550/arXiv.2405.16541" title="">https://doi.org/10.48550/arXiv.2405.16541</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ronneberger et&nbsp;al. (2015)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Olaf Ronneberger, Philipp Fischer, and Thomas Brox.

</span>
<span class="ltx_bibblock">U-net: Convolutional networks for biomedical image segmentation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib31.1.1">Medical image computing and computer-assisted intervention–MICCAI 2015: 18th international conference, Munich, Germany, October 5-9, 2015, proceedings, part III 18</em>, pages 234–241. Springer, 2015.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.48550/arXiv.1505.04597" title="">https://doi.org/10.48550/arXiv.1505.04597</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shaw et&nbsp;al. (2018)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Peter Shaw, Jakob Uszkoreit, and Ashish Vaswani.

</span>
<span class="ltx_bibblock">Self-attention with relative position representations.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib32.1.1">arXiv preprint arXiv:1803.02155</em>, 2018.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.48550/arXiv.1803.02155" title="">https://doi.org/10.48550/arXiv.1803.02155</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Smola and Kondor (2003)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Alexander&nbsp;J Smola and Risi Kondor.

</span>
<span class="ltx_bibblock">Kernels and regularization on graphs.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib33.1.1">Learning Theory and Kernel Machines: 16th Annual Conference on Learning Theory and 7th Kernel Workshop, COLT/Kernel 2003, Washington, DC, USA, August 24-27, 2003. Proceedings</em>, pages 144–158. Springer, 2003.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://people.cs.uchicago.edu/~risi/papers/SmolaKondor.pdf" title="">https://people.cs.uchicago.edu/~risi/papers/SmolaKondor.pdf</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Song et&nbsp;al. (2020)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Yang Song, Jascha Sohl-Dickstein, Diederik&nbsp;P Kingma, Abhishek Kumar, Stefano Ermon, and Ben Poole.

</span>
<span class="ltx_bibblock">Score-based generative modeling through stochastic differential equations.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib34.1.1">arXiv preprint arXiv:2011.13456</em>, 2020.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.48550/arXiv.2011.13456" title="">https://doi.org/10.48550/arXiv.2011.13456</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Vaswani (2017)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
A&nbsp;Vaswani.

</span>
<span class="ltx_bibblock">Attention is all you need.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib35.1.1">Advances in Neural Information Processing Systems</em>, 2017.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.48550/arXiv.1706.03762" title="">https://doi.org/10.48550/arXiv.1706.03762</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Veličković et&nbsp;al. (2018)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Petar Veličković, Guillem Cucurull, Arantxa Casanova, Adriana Romero, Pietro Liò, and Yoshua Bengio.

</span>
<span class="ltx_bibblock">Graph Attention Networks.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib36.1.1">International Conference on Learning Representations</em>, 2018.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.48550/arXiv.1710.10903" title="">https://doi.org/10.48550/arXiv.1710.10903</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Whitney et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
William&nbsp;F Whitney, Tatiana Lopez-Guevara, Tobias Pfaff, Yulia Rubanova, Thomas Kipf, Kimberly Stachenfeld, and Kelsey&nbsp;R Allen.

</span>
<span class="ltx_bibblock">Learning 3d particle-based simulators from rgb-d videos.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib37.1.1">arXiv preprint arXiv:2312.05359</em>, 2023.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.48550/arXiv.2312.05359" title="">https://doi.org/10.48550/arXiv.2312.05359</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Whitney et&nbsp;al. (2024)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
William&nbsp;F Whitney, Jacob Varley, Deepali Jain, Krzysztof Choromanski, Sumeet Singh, and Vikas Sindhwani.

</span>
<span class="ltx_bibblock">Modeling the real world with high-density visual particle dynamics.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib38.1.1">arXiv preprint arXiv:2406.19800</em>, 2024.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.48550/arXiv.2406.19800" title="">https://doi.org/10.48550/arXiv.2406.19800</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib39">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xu et&nbsp;al. (2019)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Keyulu Xu, Weihua Hu, Jure Leskovec, and Stefanie Jegelka.

</span>
<span class="ltx_bibblock">How powerful are graph neural networks?

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib39.1.1">arXiv preprint arXiv:1810.00826</em>, 2019.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.48550/arXiv.1810.00826" title="">https://doi.org/10.48550/arXiv.1810.00826</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib40">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xu et&nbsp;al. (2022)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Qiangeng Xu, Zexiang Xu, Julien Philip, Sai Bi, Zhixin Shu, Kalyan Sunkavalli, and Ulrich Neumann.

</span>
<span class="ltx_bibblock">Point-nerf: Point-based neural radiance fields.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib40.1.1">Proceedings of the IEEE/CVF conference on computer vision and pattern recognition</em>, pages 5438–5448, 2022.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.48550/arXiv.2201.08845" title="">https://doi.org/10.48550/arXiv.2201.08845</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib41">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yajima (2006)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Yasutoshi Yajima.

</span>
<span class="ltx_bibblock">One-class support vector machines for recommendation tasks.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib41.1.1">Pacific-Asia Conference on Knowledge Discovery and Data Mining</em>, pages 230–239. Springer, 2006.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1007/11731139_28" title="">https://doi.org/10.1007/11731139_28</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib42">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yang et&nbsp;al. (2019)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Zhilin Yang, Zihang Dai, Yiming Yang, Jaime Carbonell, Russ&nbsp;R Salakhutdinov, and Quoc&nbsp;V Le.

</span>
<span class="ltx_bibblock">Xlnet: Generalized autoregressive pretraining for language understanding.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib42.1.1">Advances in neural information processing systems</em>, 32, 2019.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.48550/arXiv.1906.08237" title="">https://doi.org/10.48550/arXiv.1906.08237</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib43">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ying et&nbsp;al. (2021)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Chengxuan Ying, Tianle Cai, Shengjie Luo, Shuxin Zheng, Guolin Ke, Di&nbsp;He, Yanming Shen, and Tie-Yan Liu.

</span>
<span class="ltx_bibblock">Do transformers really perform badly for graph representation?

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib43.1.1">Advances in Neural Information Processing Systems</em>, 34:28877–28888, 2021.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.48550/arXiv.2106.05234" title="">https://doi.org/10.48550/arXiv.2106.05234</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib44">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhi et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Yin-Cong Zhi, Yin&nbsp;Cheng Ng, and Xiaowen Dong.

</span>
<span class="ltx_bibblock">Gaussian processes on graphs via spectral kernel learning.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib44.1.1">IEEE Transactions on Signal and Information Processing over Networks</em>, 9:304–314, 2023.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.48550/arXiv.2006.07361" title="">https://doi.org/10.48550/arXiv.2006.07361</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib45">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhou et&nbsp;al. (2018)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Bolei Zhou, Àgata Lapedriza, Aditya Khosla, Aude Oliva, and Antonio Torralba.

</span>
<span class="ltx_bibblock">Places: A 10 million image database for scene recognition.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib45.1.1">IEEE Trans. Pattern Anal. Mach. Intell.</em>, 40(6):1452–1464, 2018.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.1109/TPAMI.2017.2723009</span>.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1109/TPAMI.2017.2723009" title="">https://doi.org/10.1109/TPAMI.2017.2723009</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib46">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhou et&nbsp;al. (2020)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Yufan Zhou, Changyou Chen, and Jinhui Xu.

</span>
<span class="ltx_bibblock">Learning manifold implicitly via explicit heat-kernel learning.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib46.1.1">Advances in Neural Information Processing Systems</em>, 33:477–487, 2020.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.48550/arXiv.2010.01761" title="">https://doi.org/10.48550/arXiv.2010.01761</a>.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<section class="ltx_appendix" id="A1">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Proofs</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<section class="ltx_subsection" id="A1.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.1 </span>Proof of Remark <a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#S3.Thmremark1" title="Remark 3.1 (Explicit 𝑁-dimensional features for graph node kernels (Reid et al., 2024b)). ‣ 3.2 Implicit masking with graph features ‣ 3 Towards linear topological masking ‣ Linear Transformer Topological Masking with Graph Random Features"><span class="ltx_text ltx_ref_tag">3.1</span></a>
</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="A1.SS1.p1">
<p class="ltx_p" id="A1.SS1.p1.8">This result was presented by <cite class="ltx_cite ltx_citemacro_citet">Reid et&nbsp;al. [<a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#bib.bib29" title="">2024b</a>]</cite>; a short demonstration is included below for the reader’s convenience.
Observe that</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equation ltx_eqn_table" id="A1.E13">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\begin{multlined}\mathbf{M}_{\alpha}(\mathcal{G})_{ij}\coloneqq\sum_{k=0}^{%
\infty}\alpha_{k}\mathbf{W}^{k}_{ij}\overset{(1)}{=}\sum_{v=1}^{N}\sum_{k=0}^{%
\infty}\alpha_{k}\mathbf{W}^{k-p}_{iv}\mathbf{W}^{p}_{vj}\overset{(2)}{=}\sum_%
{v=1}^{N}\sum_{k=0}^{\infty}\sum_{p=0}^{k}f_{k-p}f_{p}\mathbf{W}^{k-p}_{iv}%
\mathbf{W}^{p}_{vj}\\
\overset{(3)}{=}\sum_{v=1}^{N}\left(\sum_{k_{1}=0}^{\infty}f_{k_{1}}\mathbf{W}%
^{k_{1}}_{iv}\right)\left(\sum_{k_{2}=0}^{\infty}f_{k_{2}}\mathbf{W}^{k_{2}}_{%
jv}\right)^{\top}\overset{(4)}{=}\mathbf{\Phi}_{\mathcal{G}}\mathbf{\Phi}_{%
\mathcal{G}}^{\top}\end{multlined}\mathbf{M}_{\alpha}(\mathcal{G})_{ij}%
\coloneqq\sum_{k=0}^{\infty}\alpha_{k}\mathbf{W}^{k}_{ij}\overset{(1)}{=}\sum_%
{v=1}^{N}\sum_{k=0}^{\infty}\alpha_{k}\mathbf{W}^{k-p}_{iv}\mathbf{W}^{p}_{vj}%
\overset{(2)}{=}\sum_{v=1}^{N}\sum_{k=0}^{\infty}\sum_{p=0}^{k}f_{k-p}f_{p}%
\mathbf{W}^{k-p}_{iv}\mathbf{W}^{p}_{vj}\\
\overset{(3)}{=}\sum_{v=1}^{N}\left(\sum_{k_{1}=0}^{\infty}f_{k_{1}}\mathbf{W}%
^{k_{1}}_{iv}\right)\left(\sum_{k_{2}=0}^{\infty}f_{k_{2}}\mathbf{W}^{k_{2}}_{%
jv}\right)^{\top}\overset{(4)}{=}\mathbf{\Phi}_{\mathcal{G}}\mathbf{\Phi}_{%
\mathcal{G}}^{\top}" class="ltx_Math" display="block" id="A1.E13.m1.85"><semantics id="A1.E13.m1.85a"><mtable displaystyle="true" id="A1.E13.m1.85.85.4" rowspacing="0pt" xref="A1.E13.m1.83.83.2.cmml"><mtr id="A1.E13.m1.85.85.4a" xref="A1.E13.m1.83.83.2.cmml"><mtd class="ltx_align_left" columnalign="left" id="A1.E13.m1.85.85.4b" xref="A1.E13.m1.83.83.2.cmml"><mrow id="A1.E13.m1.50.50.50.50.50" xref="A1.E13.m1.83.83.2.cmml"><mrow id="A1.E13.m1.50.50.50.50.50.51" xref="A1.E13.m1.83.83.2.cmml"><msub id="A1.E13.m1.50.50.50.50.50.51.2" xref="A1.E13.m1.83.83.2.cmml"><mi id="A1.E13.m1.1.1.1.1.1.1" xref="A1.E13.m1.1.1.1.1.1.1.cmml">𝐌</mi><mi id="A1.E13.m1.2.2.2.2.2.2.1" xref="A1.E13.m1.2.2.2.2.2.2.1.cmml">α</mi></msub><mo id="A1.E13.m1.50.50.50.50.50.51.1" xref="A1.E13.m1.83.83.2.cmml">⁢</mo><msub id="A1.E13.m1.50.50.50.50.50.51.3" xref="A1.E13.m1.83.83.2.cmml"><mrow id="A1.E13.m1.50.50.50.50.50.51.3.2" xref="A1.E13.m1.83.83.2.cmml"><mo id="A1.E13.m1.3.3.3.3.3.3" stretchy="false" xref="A1.E13.m1.83.83.2.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="A1.E13.m1.4.4.4.4.4.4" xref="A1.E13.m1.4.4.4.4.4.4.cmml">𝒢</mi><mo id="A1.E13.m1.5.5.5.5.5.5" stretchy="false" xref="A1.E13.m1.83.83.2.cmml">)</mo></mrow><mrow id="A1.E13.m1.6.6.6.6.6.6.1" xref="A1.E13.m1.6.6.6.6.6.6.1.cmml"><mi id="A1.E13.m1.6.6.6.6.6.6.1.2" xref="A1.E13.m1.6.6.6.6.6.6.1.2.cmml">i</mi><mo id="A1.E13.m1.6.6.6.6.6.6.1.1" xref="A1.E13.m1.6.6.6.6.6.6.1.1.cmml">⁢</mo><mi id="A1.E13.m1.6.6.6.6.6.6.1.3" xref="A1.E13.m1.6.6.6.6.6.6.1.3.cmml">j</mi></mrow></msub></mrow><mo id="A1.E13.m1.7.7.7.7.7.7" rspace="0.111em" xref="A1.E13.m1.7.7.7.7.7.7.cmml">≔</mo><mrow id="A1.E13.m1.50.50.50.50.50.52" xref="A1.E13.m1.83.83.2.cmml"><munderover id="A1.E13.m1.50.50.50.50.50.52.1" xref="A1.E13.m1.83.83.2.cmml"><mo id="A1.E13.m1.8.8.8.8.8.8" movablelimits="false" xref="A1.E13.m1.8.8.8.8.8.8.cmml">∑</mo><mrow id="A1.E13.m1.9.9.9.9.9.9.1" xref="A1.E13.m1.9.9.9.9.9.9.1.cmml"><mi id="A1.E13.m1.9.9.9.9.9.9.1.2" xref="A1.E13.m1.9.9.9.9.9.9.1.2.cmml">k</mi><mo id="A1.E13.m1.9.9.9.9.9.9.1.1" xref="A1.E13.m1.9.9.9.9.9.9.1.1.cmml">=</mo><mn id="A1.E13.m1.9.9.9.9.9.9.1.3" xref="A1.E13.m1.9.9.9.9.9.9.1.3.cmml">0</mn></mrow><mi id="A1.E13.m1.10.10.10.10.10.10.1" mathvariant="normal" xref="A1.E13.m1.10.10.10.10.10.10.1.cmml">∞</mi></munderover><mrow id="A1.E13.m1.50.50.50.50.50.52.2" xref="A1.E13.m1.83.83.2.cmml"><msub id="A1.E13.m1.50.50.50.50.50.52.2.2" xref="A1.E13.m1.83.83.2.cmml"><mi id="A1.E13.m1.11.11.11.11.11.11" xref="A1.E13.m1.11.11.11.11.11.11.cmml">α</mi><mi id="A1.E13.m1.12.12.12.12.12.12.1" xref="A1.E13.m1.12.12.12.12.12.12.1.cmml">k</mi></msub><mo id="A1.E13.m1.50.50.50.50.50.52.2.1" xref="A1.E13.m1.83.83.2.cmml">⁢</mo><msubsup id="A1.E13.m1.50.50.50.50.50.52.2.3" xref="A1.E13.m1.83.83.2.cmml"><mi id="A1.E13.m1.13.13.13.13.13.13" xref="A1.E13.m1.13.13.13.13.13.13.cmml">𝐖</mi><mrow id="A1.E13.m1.15.15.15.15.15.15.1" xref="A1.E13.m1.15.15.15.15.15.15.1.cmml"><mi id="A1.E13.m1.15.15.15.15.15.15.1.2" xref="A1.E13.m1.15.15.15.15.15.15.1.2.cmml">i</mi><mo id="A1.E13.m1.15.15.15.15.15.15.1.1" xref="A1.E13.m1.15.15.15.15.15.15.1.1.cmml">⁢</mo><mi id="A1.E13.m1.15.15.15.15.15.15.1.3" xref="A1.E13.m1.15.15.15.15.15.15.1.3.cmml">j</mi></mrow><mi id="A1.E13.m1.14.14.14.14.14.14.1" xref="A1.E13.m1.14.14.14.14.14.14.1.cmml">k</mi></msubsup><mo id="A1.E13.m1.50.50.50.50.50.52.2.1a" xref="A1.E13.m1.83.83.2.cmml">⁢</mo><mover accent="true" id="A1.E13.m1.16.16.16.16.16.16" xref="A1.E13.m1.16.16.16.16.16.16.cmml"><mo id="A1.E13.m1.16.16.16.16.16.16.2" xref="A1.E13.m1.16.16.16.16.16.16.2.cmml">=</mo><mrow id="A1.E13.m1.16.16.16.16.16.16.1.3" xref="A1.E13.m1.16.16.16.16.16.16.cmml"><mo id="A1.E13.m1.16.16.16.16.16.16.1.3.1" stretchy="false" xref="A1.E13.m1.16.16.16.16.16.16.cmml">(</mo><mn id="A1.E13.m1.16.16.16.16.16.16.1.1" xref="A1.E13.m1.16.16.16.16.16.16.1.1.cmml">1</mn><mo id="A1.E13.m1.16.16.16.16.16.16.1.3.2" stretchy="false" xref="A1.E13.m1.16.16.16.16.16.16.cmml">)</mo></mrow></mover><mo id="A1.E13.m1.50.50.50.50.50.52.2.1b" lspace="0.278em" xref="A1.E13.m1.83.83.2.cmml">⁢</mo><mrow id="A1.E13.m1.50.50.50.50.50.52.2.4" xref="A1.E13.m1.83.83.2.cmml"><munderover id="A1.E13.m1.50.50.50.50.50.52.2.4.1" xref="A1.E13.m1.83.83.2.cmml"><mo id="A1.E13.m1.17.17.17.17.17.17" movablelimits="false" rspace="0em" xref="A1.E13.m1.17.17.17.17.17.17.cmml">∑</mo><mrow id="A1.E13.m1.18.18.18.18.18.18.1" xref="A1.E13.m1.18.18.18.18.18.18.1.cmml"><mi id="A1.E13.m1.18.18.18.18.18.18.1.2" xref="A1.E13.m1.18.18.18.18.18.18.1.2.cmml">v</mi><mo id="A1.E13.m1.18.18.18.18.18.18.1.1" xref="A1.E13.m1.18.18.18.18.18.18.1.1.cmml">=</mo><mn id="A1.E13.m1.18.18.18.18.18.18.1.3" xref="A1.E13.m1.18.18.18.18.18.18.1.3.cmml">1</mn></mrow><mi id="A1.E13.m1.19.19.19.19.19.19.1" xref="A1.E13.m1.19.19.19.19.19.19.1.cmml">N</mi></munderover><mrow id="A1.E13.m1.50.50.50.50.50.52.2.4.2" xref="A1.E13.m1.83.83.2.cmml"><munderover id="A1.E13.m1.50.50.50.50.50.52.2.4.2.1" xref="A1.E13.m1.83.83.2.cmml"><mo id="A1.E13.m1.20.20.20.20.20.20" movablelimits="false" xref="A1.E13.m1.20.20.20.20.20.20.cmml">∑</mo><mrow id="A1.E13.m1.21.21.21.21.21.21.1" xref="A1.E13.m1.21.21.21.21.21.21.1.cmml"><mi id="A1.E13.m1.21.21.21.21.21.21.1.2" xref="A1.E13.m1.21.21.21.21.21.21.1.2.cmml">k</mi><mo id="A1.E13.m1.21.21.21.21.21.21.1.1" xref="A1.E13.m1.21.21.21.21.21.21.1.1.cmml">=</mo><mn id="A1.E13.m1.21.21.21.21.21.21.1.3" xref="A1.E13.m1.21.21.21.21.21.21.1.3.cmml">0</mn></mrow><mi id="A1.E13.m1.22.22.22.22.22.22.1" mathvariant="normal" xref="A1.E13.m1.22.22.22.22.22.22.1.cmml">∞</mi></munderover><mrow id="A1.E13.m1.50.50.50.50.50.52.2.4.2.2" xref="A1.E13.m1.83.83.2.cmml"><msub id="A1.E13.m1.50.50.50.50.50.52.2.4.2.2.2" xref="A1.E13.m1.83.83.2.cmml"><mi id="A1.E13.m1.23.23.23.23.23.23" xref="A1.E13.m1.23.23.23.23.23.23.cmml">α</mi><mi id="A1.E13.m1.24.24.24.24.24.24.1" xref="A1.E13.m1.24.24.24.24.24.24.1.cmml">k</mi></msub><mo id="A1.E13.m1.50.50.50.50.50.52.2.4.2.2.1" xref="A1.E13.m1.83.83.2.cmml">⁢</mo><msubsup id="A1.E13.m1.50.50.50.50.50.52.2.4.2.2.3" xref="A1.E13.m1.83.83.2.cmml"><mi id="A1.E13.m1.25.25.25.25.25.25" xref="A1.E13.m1.25.25.25.25.25.25.cmml">𝐖</mi><mrow id="A1.E13.m1.27.27.27.27.27.27.1" xref="A1.E13.m1.27.27.27.27.27.27.1.cmml"><mi id="A1.E13.m1.27.27.27.27.27.27.1.2" xref="A1.E13.m1.27.27.27.27.27.27.1.2.cmml">i</mi><mo id="A1.E13.m1.27.27.27.27.27.27.1.1" xref="A1.E13.m1.27.27.27.27.27.27.1.1.cmml">⁢</mo><mi id="A1.E13.m1.27.27.27.27.27.27.1.3" xref="A1.E13.m1.27.27.27.27.27.27.1.3.cmml">v</mi></mrow><mrow id="A1.E13.m1.26.26.26.26.26.26.1" xref="A1.E13.m1.26.26.26.26.26.26.1.cmml"><mi id="A1.E13.m1.26.26.26.26.26.26.1.2" xref="A1.E13.m1.26.26.26.26.26.26.1.2.cmml">k</mi><mo id="A1.E13.m1.26.26.26.26.26.26.1.1" xref="A1.E13.m1.26.26.26.26.26.26.1.1.cmml">−</mo><mi id="A1.E13.m1.26.26.26.26.26.26.1.3" xref="A1.E13.m1.26.26.26.26.26.26.1.3.cmml">p</mi></mrow></msubsup><mo id="A1.E13.m1.50.50.50.50.50.52.2.4.2.2.1a" xref="A1.E13.m1.83.83.2.cmml">⁢</mo><msubsup id="A1.E13.m1.50.50.50.50.50.52.2.4.2.2.4" xref="A1.E13.m1.83.83.2.cmml"><mi id="A1.E13.m1.28.28.28.28.28.28" xref="A1.E13.m1.28.28.28.28.28.28.cmml">𝐖</mi><mrow id="A1.E13.m1.30.30.30.30.30.30.1" xref="A1.E13.m1.30.30.30.30.30.30.1.cmml"><mi id="A1.E13.m1.30.30.30.30.30.30.1.2" xref="A1.E13.m1.30.30.30.30.30.30.1.2.cmml">v</mi><mo id="A1.E13.m1.30.30.30.30.30.30.1.1" xref="A1.E13.m1.30.30.30.30.30.30.1.1.cmml">⁢</mo><mi id="A1.E13.m1.30.30.30.30.30.30.1.3" xref="A1.E13.m1.30.30.30.30.30.30.1.3.cmml">j</mi></mrow><mi id="A1.E13.m1.29.29.29.29.29.29.1" xref="A1.E13.m1.29.29.29.29.29.29.1.cmml">p</mi></msubsup><mo id="A1.E13.m1.50.50.50.50.50.52.2.4.2.2.1b" xref="A1.E13.m1.83.83.2.cmml">⁢</mo><mover accent="true" id="A1.E13.m1.31.31.31.31.31.31" xref="A1.E13.m1.31.31.31.31.31.31.cmml"><mo id="A1.E13.m1.31.31.31.31.31.31.2" xref="A1.E13.m1.31.31.31.31.31.31.2.cmml">=</mo><mrow id="A1.E13.m1.31.31.31.31.31.31.1.3" xref="A1.E13.m1.31.31.31.31.31.31.cmml"><mo id="A1.E13.m1.31.31.31.31.31.31.1.3.1" stretchy="false" xref="A1.E13.m1.31.31.31.31.31.31.cmml">(</mo><mn id="A1.E13.m1.31.31.31.31.31.31.1.1" xref="A1.E13.m1.31.31.31.31.31.31.1.1.cmml">2</mn><mo id="A1.E13.m1.31.31.31.31.31.31.1.3.2" stretchy="false" xref="A1.E13.m1.31.31.31.31.31.31.cmml">)</mo></mrow></mover><mo id="A1.E13.m1.50.50.50.50.50.52.2.4.2.2.1c" lspace="0.278em" xref="A1.E13.m1.83.83.2.cmml">⁢</mo><mrow id="A1.E13.m1.50.50.50.50.50.52.2.4.2.2.5" xref="A1.E13.m1.83.83.2.cmml"><munderover id="A1.E13.m1.50.50.50.50.50.52.2.4.2.2.5.1" xref="A1.E13.m1.83.83.2.cmml"><mo id="A1.E13.m1.32.32.32.32.32.32" movablelimits="false" rspace="0em" xref="A1.E13.m1.32.32.32.32.32.32.cmml">∑</mo><mrow id="A1.E13.m1.33.33.33.33.33.33.1" xref="A1.E13.m1.33.33.33.33.33.33.1.cmml"><mi id="A1.E13.m1.33.33.33.33.33.33.1.2" xref="A1.E13.m1.33.33.33.33.33.33.1.2.cmml">v</mi><mo id="A1.E13.m1.33.33.33.33.33.33.1.1" xref="A1.E13.m1.33.33.33.33.33.33.1.1.cmml">=</mo><mn id="A1.E13.m1.33.33.33.33.33.33.1.3" xref="A1.E13.m1.33.33.33.33.33.33.1.3.cmml">1</mn></mrow><mi id="A1.E13.m1.34.34.34.34.34.34.1" xref="A1.E13.m1.34.34.34.34.34.34.1.cmml">N</mi></munderover><mrow id="A1.E13.m1.50.50.50.50.50.52.2.4.2.2.5.2" xref="A1.E13.m1.83.83.2.cmml"><munderover id="A1.E13.m1.50.50.50.50.50.52.2.4.2.2.5.2.1" xref="A1.E13.m1.83.83.2.cmml"><mo id="A1.E13.m1.35.35.35.35.35.35" movablelimits="false" rspace="0em" xref="A1.E13.m1.35.35.35.35.35.35.cmml">∑</mo><mrow id="A1.E13.m1.36.36.36.36.36.36.1" xref="A1.E13.m1.36.36.36.36.36.36.1.cmml"><mi id="A1.E13.m1.36.36.36.36.36.36.1.2" xref="A1.E13.m1.36.36.36.36.36.36.1.2.cmml">k</mi><mo id="A1.E13.m1.36.36.36.36.36.36.1.1" xref="A1.E13.m1.36.36.36.36.36.36.1.1.cmml">=</mo><mn id="A1.E13.m1.36.36.36.36.36.36.1.3" xref="A1.E13.m1.36.36.36.36.36.36.1.3.cmml">0</mn></mrow><mi id="A1.E13.m1.37.37.37.37.37.37.1" mathvariant="normal" xref="A1.E13.m1.37.37.37.37.37.37.1.cmml">∞</mi></munderover><mrow id="A1.E13.m1.50.50.50.50.50.52.2.4.2.2.5.2.2" xref="A1.E13.m1.83.83.2.cmml"><munderover id="A1.E13.m1.50.50.50.50.50.52.2.4.2.2.5.2.2.1" xref="A1.E13.m1.83.83.2.cmml"><mo id="A1.E13.m1.38.38.38.38.38.38" movablelimits="false" xref="A1.E13.m1.38.38.38.38.38.38.cmml">∑</mo><mrow id="A1.E13.m1.39.39.39.39.39.39.1" xref="A1.E13.m1.39.39.39.39.39.39.1.cmml"><mi id="A1.E13.m1.39.39.39.39.39.39.1.2" xref="A1.E13.m1.39.39.39.39.39.39.1.2.cmml">p</mi><mo id="A1.E13.m1.39.39.39.39.39.39.1.1" xref="A1.E13.m1.39.39.39.39.39.39.1.1.cmml">=</mo><mn id="A1.E13.m1.39.39.39.39.39.39.1.3" xref="A1.E13.m1.39.39.39.39.39.39.1.3.cmml">0</mn></mrow><mi id="A1.E13.m1.40.40.40.40.40.40.1" xref="A1.E13.m1.40.40.40.40.40.40.1.cmml">k</mi></munderover><mrow id="A1.E13.m1.50.50.50.50.50.52.2.4.2.2.5.2.2.2" xref="A1.E13.m1.83.83.2.cmml"><msub id="A1.E13.m1.50.50.50.50.50.52.2.4.2.2.5.2.2.2.2" xref="A1.E13.m1.83.83.2.cmml"><mi id="A1.E13.m1.41.41.41.41.41.41" xref="A1.E13.m1.41.41.41.41.41.41.cmml">f</mi><mrow id="A1.E13.m1.42.42.42.42.42.42.1" xref="A1.E13.m1.42.42.42.42.42.42.1.cmml"><mi id="A1.E13.m1.42.42.42.42.42.42.1.2" xref="A1.E13.m1.42.42.42.42.42.42.1.2.cmml">k</mi><mo id="A1.E13.m1.42.42.42.42.42.42.1.1" xref="A1.E13.m1.42.42.42.42.42.42.1.1.cmml">−</mo><mi id="A1.E13.m1.42.42.42.42.42.42.1.3" xref="A1.E13.m1.42.42.42.42.42.42.1.3.cmml">p</mi></mrow></msub><mo id="A1.E13.m1.50.50.50.50.50.52.2.4.2.2.5.2.2.2.1" xref="A1.E13.m1.83.83.2.cmml">⁢</mo><msub id="A1.E13.m1.50.50.50.50.50.52.2.4.2.2.5.2.2.2.3" xref="A1.E13.m1.83.83.2.cmml"><mi id="A1.E13.m1.43.43.43.43.43.43" xref="A1.E13.m1.43.43.43.43.43.43.cmml">f</mi><mi id="A1.E13.m1.44.44.44.44.44.44.1" xref="A1.E13.m1.44.44.44.44.44.44.1.cmml">p</mi></msub><mo id="A1.E13.m1.50.50.50.50.50.52.2.4.2.2.5.2.2.2.1a" xref="A1.E13.m1.83.83.2.cmml">⁢</mo><msubsup id="A1.E13.m1.50.50.50.50.50.52.2.4.2.2.5.2.2.2.4" xref="A1.E13.m1.83.83.2.cmml"><mi id="A1.E13.m1.45.45.45.45.45.45" xref="A1.E13.m1.45.45.45.45.45.45.cmml">𝐖</mi><mrow id="A1.E13.m1.47.47.47.47.47.47.1" xref="A1.E13.m1.47.47.47.47.47.47.1.cmml"><mi id="A1.E13.m1.47.47.47.47.47.47.1.2" xref="A1.E13.m1.47.47.47.47.47.47.1.2.cmml">i</mi><mo id="A1.E13.m1.47.47.47.47.47.47.1.1" xref="A1.E13.m1.47.47.47.47.47.47.1.1.cmml">⁢</mo><mi id="A1.E13.m1.47.47.47.47.47.47.1.3" xref="A1.E13.m1.47.47.47.47.47.47.1.3.cmml">v</mi></mrow><mrow id="A1.E13.m1.46.46.46.46.46.46.1" xref="A1.E13.m1.46.46.46.46.46.46.1.cmml"><mi id="A1.E13.m1.46.46.46.46.46.46.1.2" xref="A1.E13.m1.46.46.46.46.46.46.1.2.cmml">k</mi><mo id="A1.E13.m1.46.46.46.46.46.46.1.1" xref="A1.E13.m1.46.46.46.46.46.46.1.1.cmml">−</mo><mi id="A1.E13.m1.46.46.46.46.46.46.1.3" xref="A1.E13.m1.46.46.46.46.46.46.1.3.cmml">p</mi></mrow></msubsup><mo id="A1.E13.m1.50.50.50.50.50.52.2.4.2.2.5.2.2.2.1b" xref="A1.E13.m1.83.83.2.cmml">⁢</mo><msubsup id="A1.E13.m1.50.50.50.50.50.52.2.4.2.2.5.2.2.2.5" xref="A1.E13.m1.83.83.2.cmml"><mi id="A1.E13.m1.48.48.48.48.48.48" xref="A1.E13.m1.48.48.48.48.48.48.cmml">𝐖</mi><mrow id="A1.E13.m1.50.50.50.50.50.50.1" xref="A1.E13.m1.50.50.50.50.50.50.1.cmml"><mi id="A1.E13.m1.50.50.50.50.50.50.1.2" xref="A1.E13.m1.50.50.50.50.50.50.1.2.cmml">v</mi><mo id="A1.E13.m1.50.50.50.50.50.50.1.1" xref="A1.E13.m1.50.50.50.50.50.50.1.1.cmml">⁢</mo><mi id="A1.E13.m1.50.50.50.50.50.50.1.3" xref="A1.E13.m1.50.50.50.50.50.50.1.3.cmml">j</mi></mrow><mi id="A1.E13.m1.49.49.49.49.49.49.1" xref="A1.E13.m1.49.49.49.49.49.49.1.cmml">p</mi></msubsup></mrow></mrow></mrow></mrow></mrow></mrow></mrow></mrow></mrow></mrow></mtd></mtr><mtr id="A1.E13.m1.85.85.4c" xref="A1.E13.m1.83.83.2.cmml"><mtd class="ltx_align_right" columnalign="right" id="A1.E13.m1.85.85.4d" xref="A1.E13.m1.83.83.2.cmml"><mrow id="A1.E13.m1.85.85.4.83.33.33" xref="A1.E13.m1.83.83.2.cmml"><mover accent="true" id="A1.E13.m1.51.51.51.1.1.1" xref="A1.E13.m1.51.51.51.1.1.1.cmml"><mo id="A1.E13.m1.51.51.51.1.1.1.2" xref="A1.E13.m1.51.51.51.1.1.1.2.cmml">=</mo><mrow id="A1.E13.m1.51.51.51.1.1.1.1.3" xref="A1.E13.m1.51.51.51.1.1.1.cmml"><mo id="A1.E13.m1.51.51.51.1.1.1.1.3.1" stretchy="false" xref="A1.E13.m1.51.51.51.1.1.1.cmml">(</mo><mn id="A1.E13.m1.51.51.51.1.1.1.1.1" xref="A1.E13.m1.51.51.51.1.1.1.1.1.cmml">3</mn><mo id="A1.E13.m1.51.51.51.1.1.1.1.3.2" stretchy="false" xref="A1.E13.m1.51.51.51.1.1.1.cmml">)</mo></mrow></mover><mo id="A1.E13.m1.85.85.4.83.33.33.34" lspace="0.278em" xref="A1.E13.m1.83.83.2.cmml">⁢</mo><mrow id="A1.E13.m1.85.85.4.83.33.33.33" xref="A1.E13.m1.83.83.2.cmml"><munderover id="A1.E13.m1.85.85.4.83.33.33.33.3" xref="A1.E13.m1.83.83.2.cmml"><mo id="A1.E13.m1.52.52.52.2.2.2" movablelimits="false" rspace="0em" xref="A1.E13.m1.52.52.52.2.2.2.cmml">∑</mo><mrow id="A1.E13.m1.53.53.53.3.3.3.1" xref="A1.E13.m1.53.53.53.3.3.3.1.cmml"><mi id="A1.E13.m1.53.53.53.3.3.3.1.2" xref="A1.E13.m1.53.53.53.3.3.3.1.2.cmml">v</mi><mo id="A1.E13.m1.53.53.53.3.3.3.1.1" xref="A1.E13.m1.53.53.53.3.3.3.1.1.cmml">=</mo><mn id="A1.E13.m1.53.53.53.3.3.3.1.3" xref="A1.E13.m1.53.53.53.3.3.3.1.3.cmml">1</mn></mrow><mi id="A1.E13.m1.54.54.54.4.4.4.1" xref="A1.E13.m1.54.54.54.4.4.4.1.cmml">N</mi></munderover><mrow id="A1.E13.m1.85.85.4.83.33.33.33.2" xref="A1.E13.m1.83.83.2.cmml"><mrow id="A1.E13.m1.84.84.3.82.32.32.32.1.1.1" xref="A1.E13.m1.83.83.2.cmml"><mo id="A1.E13.m1.55.55.55.5.5.5" xref="A1.E13.m1.83.83.2.cmml">(</mo><mrow id="A1.E13.m1.84.84.3.82.32.32.32.1.1.1.1" xref="A1.E13.m1.83.83.2.cmml"><munderover id="A1.E13.m1.84.84.3.82.32.32.32.1.1.1.1.1" xref="A1.E13.m1.83.83.2.cmml"><mo id="A1.E13.m1.56.56.56.6.6.6" lspace="0em" movablelimits="false" xref="A1.E13.m1.56.56.56.6.6.6.cmml">∑</mo><mrow id="A1.E13.m1.57.57.57.7.7.7.1" xref="A1.E13.m1.57.57.57.7.7.7.1.cmml"><msub id="A1.E13.m1.57.57.57.7.7.7.1.2" xref="A1.E13.m1.57.57.57.7.7.7.1.2.cmml"><mi id="A1.E13.m1.57.57.57.7.7.7.1.2.2" xref="A1.E13.m1.57.57.57.7.7.7.1.2.2.cmml">k</mi><mn id="A1.E13.m1.57.57.57.7.7.7.1.2.3" xref="A1.E13.m1.57.57.57.7.7.7.1.2.3.cmml">1</mn></msub><mo id="A1.E13.m1.57.57.57.7.7.7.1.1" xref="A1.E13.m1.57.57.57.7.7.7.1.1.cmml">=</mo><mn id="A1.E13.m1.57.57.57.7.7.7.1.3" xref="A1.E13.m1.57.57.57.7.7.7.1.3.cmml">0</mn></mrow><mi id="A1.E13.m1.58.58.58.8.8.8.1" mathvariant="normal" xref="A1.E13.m1.58.58.58.8.8.8.1.cmml">∞</mi></munderover><mrow id="A1.E13.m1.84.84.3.82.32.32.32.1.1.1.1.2" xref="A1.E13.m1.83.83.2.cmml"><msub id="A1.E13.m1.84.84.3.82.32.32.32.1.1.1.1.2.2" xref="A1.E13.m1.83.83.2.cmml"><mi id="A1.E13.m1.59.59.59.9.9.9" xref="A1.E13.m1.59.59.59.9.9.9.cmml">f</mi><msub id="A1.E13.m1.60.60.60.10.10.10.1" xref="A1.E13.m1.60.60.60.10.10.10.1.cmml"><mi id="A1.E13.m1.60.60.60.10.10.10.1.2" xref="A1.E13.m1.60.60.60.10.10.10.1.2.cmml">k</mi><mn id="A1.E13.m1.60.60.60.10.10.10.1.3" xref="A1.E13.m1.60.60.60.10.10.10.1.3.cmml">1</mn></msub></msub><mo id="A1.E13.m1.84.84.3.82.32.32.32.1.1.1.1.2.1" xref="A1.E13.m1.83.83.2.cmml">⁢</mo><msubsup id="A1.E13.m1.84.84.3.82.32.32.32.1.1.1.1.2.3" xref="A1.E13.m1.83.83.2.cmml"><mi id="A1.E13.m1.61.61.61.11.11.11" xref="A1.E13.m1.61.61.61.11.11.11.cmml">𝐖</mi><mrow id="A1.E13.m1.63.63.63.13.13.13.1" xref="A1.E13.m1.63.63.63.13.13.13.1.cmml"><mi id="A1.E13.m1.63.63.63.13.13.13.1.2" xref="A1.E13.m1.63.63.63.13.13.13.1.2.cmml">i</mi><mo id="A1.E13.m1.63.63.63.13.13.13.1.1" xref="A1.E13.m1.63.63.63.13.13.13.1.1.cmml">⁢</mo><mi id="A1.E13.m1.63.63.63.13.13.13.1.3" xref="A1.E13.m1.63.63.63.13.13.13.1.3.cmml">v</mi></mrow><msub id="A1.E13.m1.62.62.62.12.12.12.1" xref="A1.E13.m1.62.62.62.12.12.12.1.cmml"><mi id="A1.E13.m1.62.62.62.12.12.12.1.2" xref="A1.E13.m1.62.62.62.12.12.12.1.2.cmml">k</mi><mn id="A1.E13.m1.62.62.62.12.12.12.1.3" xref="A1.E13.m1.62.62.62.12.12.12.1.3.cmml">1</mn></msub></msubsup></mrow></mrow><mo id="A1.E13.m1.64.64.64.14.14.14" xref="A1.E13.m1.83.83.2.cmml">)</mo></mrow><mo id="A1.E13.m1.85.85.4.83.33.33.33.2.3" xref="A1.E13.m1.83.83.2.cmml">⁢</mo><msup id="A1.E13.m1.85.85.4.83.33.33.33.2.2" xref="A1.E13.m1.83.83.2.cmml"><mrow id="A1.E13.m1.85.85.4.83.33.33.33.2.2.1.1" xref="A1.E13.m1.83.83.2.cmml"><mo id="A1.E13.m1.65.65.65.15.15.15" xref="A1.E13.m1.83.83.2.cmml">(</mo><mrow id="A1.E13.m1.85.85.4.83.33.33.33.2.2.1.1.1" xref="A1.E13.m1.83.83.2.cmml"><munderover id="A1.E13.m1.85.85.4.83.33.33.33.2.2.1.1.1.1" xref="A1.E13.m1.83.83.2.cmml"><mo id="A1.E13.m1.66.66.66.16.16.16" lspace="0em" movablelimits="false" xref="A1.E13.m1.66.66.66.16.16.16.cmml">∑</mo><mrow id="A1.E13.m1.67.67.67.17.17.17.1" xref="A1.E13.m1.67.67.67.17.17.17.1.cmml"><msub id="A1.E13.m1.67.67.67.17.17.17.1.2" xref="A1.E13.m1.67.67.67.17.17.17.1.2.cmml"><mi id="A1.E13.m1.67.67.67.17.17.17.1.2.2" xref="A1.E13.m1.67.67.67.17.17.17.1.2.2.cmml">k</mi><mn id="A1.E13.m1.67.67.67.17.17.17.1.2.3" xref="A1.E13.m1.67.67.67.17.17.17.1.2.3.cmml">2</mn></msub><mo id="A1.E13.m1.67.67.67.17.17.17.1.1" xref="A1.E13.m1.67.67.67.17.17.17.1.1.cmml">=</mo><mn id="A1.E13.m1.67.67.67.17.17.17.1.3" xref="A1.E13.m1.67.67.67.17.17.17.1.3.cmml">0</mn></mrow><mi id="A1.E13.m1.68.68.68.18.18.18.1" mathvariant="normal" xref="A1.E13.m1.68.68.68.18.18.18.1.cmml">∞</mi></munderover><mrow id="A1.E13.m1.85.85.4.83.33.33.33.2.2.1.1.1.2" xref="A1.E13.m1.83.83.2.cmml"><msub id="A1.E13.m1.85.85.4.83.33.33.33.2.2.1.1.1.2.2" xref="A1.E13.m1.83.83.2.cmml"><mi id="A1.E13.m1.69.69.69.19.19.19" xref="A1.E13.m1.69.69.69.19.19.19.cmml">f</mi><msub id="A1.E13.m1.70.70.70.20.20.20.1" xref="A1.E13.m1.70.70.70.20.20.20.1.cmml"><mi id="A1.E13.m1.70.70.70.20.20.20.1.2" xref="A1.E13.m1.70.70.70.20.20.20.1.2.cmml">k</mi><mn id="A1.E13.m1.70.70.70.20.20.20.1.3" xref="A1.E13.m1.70.70.70.20.20.20.1.3.cmml">2</mn></msub></msub><mo id="A1.E13.m1.85.85.4.83.33.33.33.2.2.1.1.1.2.1" xref="A1.E13.m1.83.83.2.cmml">⁢</mo><msubsup id="A1.E13.m1.85.85.4.83.33.33.33.2.2.1.1.1.2.3" xref="A1.E13.m1.83.83.2.cmml"><mi id="A1.E13.m1.71.71.71.21.21.21" xref="A1.E13.m1.71.71.71.21.21.21.cmml">𝐖</mi><mrow id="A1.E13.m1.73.73.73.23.23.23.1" xref="A1.E13.m1.73.73.73.23.23.23.1.cmml"><mi id="A1.E13.m1.73.73.73.23.23.23.1.2" xref="A1.E13.m1.73.73.73.23.23.23.1.2.cmml">j</mi><mo id="A1.E13.m1.73.73.73.23.23.23.1.1" xref="A1.E13.m1.73.73.73.23.23.23.1.1.cmml">⁢</mo><mi id="A1.E13.m1.73.73.73.23.23.23.1.3" xref="A1.E13.m1.73.73.73.23.23.23.1.3.cmml">v</mi></mrow><msub id="A1.E13.m1.72.72.72.22.22.22.1" xref="A1.E13.m1.72.72.72.22.22.22.1.cmml"><mi id="A1.E13.m1.72.72.72.22.22.22.1.2" xref="A1.E13.m1.72.72.72.22.22.22.1.2.cmml">k</mi><mn id="A1.E13.m1.72.72.72.22.22.22.1.3" xref="A1.E13.m1.72.72.72.22.22.22.1.3.cmml">2</mn></msub></msubsup></mrow></mrow><mo id="A1.E13.m1.74.74.74.24.24.24" xref="A1.E13.m1.83.83.2.cmml">)</mo></mrow><mo id="A1.E13.m1.75.75.75.25.25.25.1" xref="A1.E13.m1.75.75.75.25.25.25.1.cmml">⊤</mo></msup><mo id="A1.E13.m1.85.85.4.83.33.33.33.2.3a" xref="A1.E13.m1.83.83.2.cmml">⁢</mo><mover accent="true" id="A1.E13.m1.76.76.76.26.26.26" xref="A1.E13.m1.76.76.76.26.26.26.cmml"><mo id="A1.E13.m1.76.76.76.26.26.26.2" xref="A1.E13.m1.76.76.76.26.26.26.2.cmml">=</mo><mrow id="A1.E13.m1.76.76.76.26.26.26.1.3" xref="A1.E13.m1.76.76.76.26.26.26.cmml"><mo id="A1.E13.m1.76.76.76.26.26.26.1.3.1" stretchy="false" xref="A1.E13.m1.76.76.76.26.26.26.cmml">(</mo><mn id="A1.E13.m1.76.76.76.26.26.26.1.1" xref="A1.E13.m1.76.76.76.26.26.26.1.1.cmml">4</mn><mo id="A1.E13.m1.76.76.76.26.26.26.1.3.2" stretchy="false" xref="A1.E13.m1.76.76.76.26.26.26.cmml">)</mo></mrow></mover><mo id="A1.E13.m1.85.85.4.83.33.33.33.2.3b" xref="A1.E13.m1.83.83.2.cmml">⁢</mo><msub id="A1.E13.m1.85.85.4.83.33.33.33.2.4" xref="A1.E13.m1.83.83.2.cmml"><mi id="A1.E13.m1.77.77.77.27.27.27" xref="A1.E13.m1.77.77.77.27.27.27.cmml">𝚽</mi><mi class="ltx_font_mathcaligraphic" id="A1.E13.m1.78.78.78.28.28.28.1" xref="A1.E13.m1.78.78.78.28.28.28.1.cmml">𝒢</mi></msub><mo id="A1.E13.m1.85.85.4.83.33.33.33.2.3c" xref="A1.E13.m1.83.83.2.cmml">⁢</mo><msubsup id="A1.E13.m1.85.85.4.83.33.33.33.2.5" xref="A1.E13.m1.83.83.2.cmml"><mi id="A1.E13.m1.79.79.79.29.29.29" xref="A1.E13.m1.79.79.79.29.29.29.cmml">𝚽</mi><mi class="ltx_font_mathcaligraphic" id="A1.E13.m1.80.80.80.30.30.30.1" xref="A1.E13.m1.80.80.80.30.30.30.1.cmml">𝒢</mi><mo id="A1.E13.m1.81.81.81.31.31.31.1" xref="A1.E13.m1.81.81.81.31.31.31.1.cmml">⊤</mo></msubsup></mrow></mrow></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="A1.E13.m1.85b"><apply id="A1.E13.m1.83.83.2.cmml" xref="A1.E13.m1.85.85.4"><ci id="A1.E13.m1.7.7.7.7.7.7.cmml" xref="A1.E13.m1.7.7.7.7.7.7">≔</ci><apply id="A1.E13.m1.83.83.2.4.cmml" xref="A1.E13.m1.85.85.4"><times id="A1.E13.m1.83.83.2.4.1.cmml" xref="A1.E13.m1.85.85.4"></times><apply id="A1.E13.m1.83.83.2.4.2.cmml" xref="A1.E13.m1.85.85.4"><csymbol cd="ambiguous" id="A1.E13.m1.83.83.2.4.2.1.cmml" xref="A1.E13.m1.85.85.4">subscript</csymbol><ci id="A1.E13.m1.1.1.1.1.1.1.cmml" xref="A1.E13.m1.1.1.1.1.1.1">𝐌</ci><ci id="A1.E13.m1.2.2.2.2.2.2.1.cmml" xref="A1.E13.m1.2.2.2.2.2.2.1">𝛼</ci></apply><apply id="A1.E13.m1.83.83.2.4.3.cmml" xref="A1.E13.m1.85.85.4"><csymbol cd="ambiguous" id="A1.E13.m1.83.83.2.4.3.1.cmml" xref="A1.E13.m1.85.85.4">subscript</csymbol><ci id="A1.E13.m1.4.4.4.4.4.4.cmml" xref="A1.E13.m1.4.4.4.4.4.4">𝒢</ci><apply id="A1.E13.m1.6.6.6.6.6.6.1.cmml" xref="A1.E13.m1.6.6.6.6.6.6.1"><times id="A1.E13.m1.6.6.6.6.6.6.1.1.cmml" xref="A1.E13.m1.6.6.6.6.6.6.1.1"></times><ci id="A1.E13.m1.6.6.6.6.6.6.1.2.cmml" xref="A1.E13.m1.6.6.6.6.6.6.1.2">𝑖</ci><ci id="A1.E13.m1.6.6.6.6.6.6.1.3.cmml" xref="A1.E13.m1.6.6.6.6.6.6.1.3">𝑗</ci></apply></apply></apply><apply id="A1.E13.m1.83.83.2.2.cmml" xref="A1.E13.m1.85.85.4"><apply id="A1.E13.m1.83.83.2.2.3.cmml" xref="A1.E13.m1.85.85.4"><csymbol cd="ambiguous" id="A1.E13.m1.83.83.2.2.3.1.cmml" xref="A1.E13.m1.85.85.4">superscript</csymbol><apply id="A1.E13.m1.83.83.2.2.3.2.cmml" xref="A1.E13.m1.85.85.4"><csymbol cd="ambiguous" id="A1.E13.m1.83.83.2.2.3.2.1.cmml" xref="A1.E13.m1.85.85.4">subscript</csymbol><sum id="A1.E13.m1.8.8.8.8.8.8.cmml" xref="A1.E13.m1.8.8.8.8.8.8"></sum><apply id="A1.E13.m1.9.9.9.9.9.9.1.cmml" xref="A1.E13.m1.9.9.9.9.9.9.1"><eq id="A1.E13.m1.9.9.9.9.9.9.1.1.cmml" xref="A1.E13.m1.9.9.9.9.9.9.1.1"></eq><ci id="A1.E13.m1.9.9.9.9.9.9.1.2.cmml" xref="A1.E13.m1.9.9.9.9.9.9.1.2">𝑘</ci><cn id="A1.E13.m1.9.9.9.9.9.9.1.3.cmml" type="integer" xref="A1.E13.m1.9.9.9.9.9.9.1.3">0</cn></apply></apply><infinity id="A1.E13.m1.10.10.10.10.10.10.1.cmml" xref="A1.E13.m1.10.10.10.10.10.10.1"></infinity></apply><apply id="A1.E13.m1.83.83.2.2.2.cmml" xref="A1.E13.m1.85.85.4"><times id="A1.E13.m1.83.83.2.2.2.3.cmml" xref="A1.E13.m1.85.85.4"></times><apply id="A1.E13.m1.83.83.2.2.2.4.cmml" xref="A1.E13.m1.85.85.4"><csymbol cd="ambiguous" id="A1.E13.m1.83.83.2.2.2.4.1.cmml" xref="A1.E13.m1.85.85.4">subscript</csymbol><ci id="A1.E13.m1.11.11.11.11.11.11.cmml" xref="A1.E13.m1.11.11.11.11.11.11">𝛼</ci><ci id="A1.E13.m1.12.12.12.12.12.12.1.cmml" xref="A1.E13.m1.12.12.12.12.12.12.1">𝑘</ci></apply><apply id="A1.E13.m1.83.83.2.2.2.5.cmml" xref="A1.E13.m1.85.85.4"><csymbol cd="ambiguous" id="A1.E13.m1.83.83.2.2.2.5.1.cmml" xref="A1.E13.m1.85.85.4">subscript</csymbol><apply id="A1.E13.m1.83.83.2.2.2.5.2.cmml" xref="A1.E13.m1.85.85.4"><csymbol cd="ambiguous" id="A1.E13.m1.83.83.2.2.2.5.2.1.cmml" xref="A1.E13.m1.85.85.4">superscript</csymbol><ci id="A1.E13.m1.13.13.13.13.13.13.cmml" xref="A1.E13.m1.13.13.13.13.13.13">𝐖</ci><ci id="A1.E13.m1.14.14.14.14.14.14.1.cmml" xref="A1.E13.m1.14.14.14.14.14.14.1">𝑘</ci></apply><apply id="A1.E13.m1.15.15.15.15.15.15.1.cmml" xref="A1.E13.m1.15.15.15.15.15.15.1"><times id="A1.E13.m1.15.15.15.15.15.15.1.1.cmml" xref="A1.E13.m1.15.15.15.15.15.15.1.1"></times><ci id="A1.E13.m1.15.15.15.15.15.15.1.2.cmml" xref="A1.E13.m1.15.15.15.15.15.15.1.2">𝑖</ci><ci id="A1.E13.m1.15.15.15.15.15.15.1.3.cmml" xref="A1.E13.m1.15.15.15.15.15.15.1.3">𝑗</ci></apply></apply><apply id="A1.E13.m1.16.16.16.16.16.16.cmml" xref="A1.E13.m1.16.16.16.16.16.16"><cn id="A1.E13.m1.16.16.16.16.16.16.1.1.cmml" type="integer" xref="A1.E13.m1.16.16.16.16.16.16.1.1">1</cn><eq id="A1.E13.m1.16.16.16.16.16.16.2.cmml" xref="A1.E13.m1.16.16.16.16.16.16.2"></eq></apply><apply id="A1.E13.m1.83.83.2.2.2.2.cmml" xref="A1.E13.m1.85.85.4"><apply id="A1.E13.m1.83.83.2.2.2.2.3.cmml" xref="A1.E13.m1.85.85.4"><csymbol cd="ambiguous" id="A1.E13.m1.83.83.2.2.2.2.3.1.cmml" xref="A1.E13.m1.85.85.4">superscript</csymbol><apply id="A1.E13.m1.83.83.2.2.2.2.3.2.cmml" xref="A1.E13.m1.85.85.4"><csymbol cd="ambiguous" id="A1.E13.m1.83.83.2.2.2.2.3.2.1.cmml" xref="A1.E13.m1.85.85.4">subscript</csymbol><sum id="A1.E13.m1.17.17.17.17.17.17.cmml" xref="A1.E13.m1.17.17.17.17.17.17"></sum><apply id="A1.E13.m1.18.18.18.18.18.18.1.cmml" xref="A1.E13.m1.18.18.18.18.18.18.1"><eq id="A1.E13.m1.18.18.18.18.18.18.1.1.cmml" xref="A1.E13.m1.18.18.18.18.18.18.1.1"></eq><ci id="A1.E13.m1.18.18.18.18.18.18.1.2.cmml" xref="A1.E13.m1.18.18.18.18.18.18.1.2">𝑣</ci><cn id="A1.E13.m1.18.18.18.18.18.18.1.3.cmml" type="integer" xref="A1.E13.m1.18.18.18.18.18.18.1.3">1</cn></apply></apply><ci id="A1.E13.m1.19.19.19.19.19.19.1.cmml" xref="A1.E13.m1.19.19.19.19.19.19.1">𝑁</ci></apply><apply id="A1.E13.m1.83.83.2.2.2.2.2.cmml" xref="A1.E13.m1.85.85.4"><apply id="A1.E13.m1.83.83.2.2.2.2.2.3.cmml" xref="A1.E13.m1.85.85.4"><csymbol cd="ambiguous" id="A1.E13.m1.83.83.2.2.2.2.2.3.1.cmml" xref="A1.E13.m1.85.85.4">superscript</csymbol><apply id="A1.E13.m1.83.83.2.2.2.2.2.3.2.cmml" xref="A1.E13.m1.85.85.4"><csymbol cd="ambiguous" id="A1.E13.m1.83.83.2.2.2.2.2.3.2.1.cmml" xref="A1.E13.m1.85.85.4">subscript</csymbol><sum id="A1.E13.m1.20.20.20.20.20.20.cmml" xref="A1.E13.m1.20.20.20.20.20.20"></sum><apply id="A1.E13.m1.21.21.21.21.21.21.1.cmml" xref="A1.E13.m1.21.21.21.21.21.21.1"><eq id="A1.E13.m1.21.21.21.21.21.21.1.1.cmml" xref="A1.E13.m1.21.21.21.21.21.21.1.1"></eq><ci id="A1.E13.m1.21.21.21.21.21.21.1.2.cmml" xref="A1.E13.m1.21.21.21.21.21.21.1.2">𝑘</ci><cn id="A1.E13.m1.21.21.21.21.21.21.1.3.cmml" type="integer" xref="A1.E13.m1.21.21.21.21.21.21.1.3">0</cn></apply></apply><infinity id="A1.E13.m1.22.22.22.22.22.22.1.cmml" xref="A1.E13.m1.22.22.22.22.22.22.1"></infinity></apply><apply id="A1.E13.m1.83.83.2.2.2.2.2.2.cmml" xref="A1.E13.m1.85.85.4"><times id="A1.E13.m1.83.83.2.2.2.2.2.2.3.cmml" xref="A1.E13.m1.85.85.4"></times><apply id="A1.E13.m1.83.83.2.2.2.2.2.2.4.cmml" xref="A1.E13.m1.85.85.4"><csymbol cd="ambiguous" id="A1.E13.m1.83.83.2.2.2.2.2.2.4.1.cmml" xref="A1.E13.m1.85.85.4">subscript</csymbol><ci id="A1.E13.m1.23.23.23.23.23.23.cmml" xref="A1.E13.m1.23.23.23.23.23.23">𝛼</ci><ci id="A1.E13.m1.24.24.24.24.24.24.1.cmml" xref="A1.E13.m1.24.24.24.24.24.24.1">𝑘</ci></apply><apply id="A1.E13.m1.83.83.2.2.2.2.2.2.5.cmml" xref="A1.E13.m1.85.85.4"><csymbol cd="ambiguous" id="A1.E13.m1.83.83.2.2.2.2.2.2.5.1.cmml" xref="A1.E13.m1.85.85.4">subscript</csymbol><apply id="A1.E13.m1.83.83.2.2.2.2.2.2.5.2.cmml" xref="A1.E13.m1.85.85.4"><csymbol cd="ambiguous" id="A1.E13.m1.83.83.2.2.2.2.2.2.5.2.1.cmml" xref="A1.E13.m1.85.85.4">superscript</csymbol><ci id="A1.E13.m1.25.25.25.25.25.25.cmml" xref="A1.E13.m1.25.25.25.25.25.25">𝐖</ci><apply id="A1.E13.m1.26.26.26.26.26.26.1.cmml" xref="A1.E13.m1.26.26.26.26.26.26.1"><minus id="A1.E13.m1.26.26.26.26.26.26.1.1.cmml" xref="A1.E13.m1.26.26.26.26.26.26.1.1"></minus><ci id="A1.E13.m1.26.26.26.26.26.26.1.2.cmml" xref="A1.E13.m1.26.26.26.26.26.26.1.2">𝑘</ci><ci id="A1.E13.m1.26.26.26.26.26.26.1.3.cmml" xref="A1.E13.m1.26.26.26.26.26.26.1.3">𝑝</ci></apply></apply><apply id="A1.E13.m1.27.27.27.27.27.27.1.cmml" xref="A1.E13.m1.27.27.27.27.27.27.1"><times id="A1.E13.m1.27.27.27.27.27.27.1.1.cmml" xref="A1.E13.m1.27.27.27.27.27.27.1.1"></times><ci id="A1.E13.m1.27.27.27.27.27.27.1.2.cmml" xref="A1.E13.m1.27.27.27.27.27.27.1.2">𝑖</ci><ci id="A1.E13.m1.27.27.27.27.27.27.1.3.cmml" xref="A1.E13.m1.27.27.27.27.27.27.1.3">𝑣</ci></apply></apply><apply id="A1.E13.m1.83.83.2.2.2.2.2.2.6.cmml" xref="A1.E13.m1.85.85.4"><csymbol cd="ambiguous" id="A1.E13.m1.83.83.2.2.2.2.2.2.6.1.cmml" xref="A1.E13.m1.85.85.4">subscript</csymbol><apply id="A1.E13.m1.83.83.2.2.2.2.2.2.6.2.cmml" xref="A1.E13.m1.85.85.4"><csymbol cd="ambiguous" id="A1.E13.m1.83.83.2.2.2.2.2.2.6.2.1.cmml" xref="A1.E13.m1.85.85.4">superscript</csymbol><ci id="A1.E13.m1.28.28.28.28.28.28.cmml" xref="A1.E13.m1.28.28.28.28.28.28">𝐖</ci><ci id="A1.E13.m1.29.29.29.29.29.29.1.cmml" xref="A1.E13.m1.29.29.29.29.29.29.1">𝑝</ci></apply><apply id="A1.E13.m1.30.30.30.30.30.30.1.cmml" xref="A1.E13.m1.30.30.30.30.30.30.1"><times id="A1.E13.m1.30.30.30.30.30.30.1.1.cmml" xref="A1.E13.m1.30.30.30.30.30.30.1.1"></times><ci id="A1.E13.m1.30.30.30.30.30.30.1.2.cmml" xref="A1.E13.m1.30.30.30.30.30.30.1.2">𝑣</ci><ci id="A1.E13.m1.30.30.30.30.30.30.1.3.cmml" xref="A1.E13.m1.30.30.30.30.30.30.1.3">𝑗</ci></apply></apply><apply id="A1.E13.m1.31.31.31.31.31.31.cmml" xref="A1.E13.m1.31.31.31.31.31.31"><cn id="A1.E13.m1.31.31.31.31.31.31.1.1.cmml" type="integer" xref="A1.E13.m1.31.31.31.31.31.31.1.1">2</cn><eq id="A1.E13.m1.31.31.31.31.31.31.2.cmml" xref="A1.E13.m1.31.31.31.31.31.31.2"></eq></apply><apply id="A1.E13.m1.83.83.2.2.2.2.2.2.2.cmml" xref="A1.E13.m1.85.85.4"><apply id="A1.E13.m1.83.83.2.2.2.2.2.2.2.3.cmml" xref="A1.E13.m1.85.85.4"><csymbol cd="ambiguous" id="A1.E13.m1.83.83.2.2.2.2.2.2.2.3.1.cmml" xref="A1.E13.m1.85.85.4">superscript</csymbol><apply id="A1.E13.m1.83.83.2.2.2.2.2.2.2.3.2.cmml" xref="A1.E13.m1.85.85.4"><csymbol cd="ambiguous" id="A1.E13.m1.83.83.2.2.2.2.2.2.2.3.2.1.cmml" xref="A1.E13.m1.85.85.4">subscript</csymbol><sum id="A1.E13.m1.32.32.32.32.32.32.cmml" xref="A1.E13.m1.32.32.32.32.32.32"></sum><apply id="A1.E13.m1.33.33.33.33.33.33.1.cmml" xref="A1.E13.m1.33.33.33.33.33.33.1"><eq id="A1.E13.m1.33.33.33.33.33.33.1.1.cmml" xref="A1.E13.m1.33.33.33.33.33.33.1.1"></eq><ci id="A1.E13.m1.33.33.33.33.33.33.1.2.cmml" xref="A1.E13.m1.33.33.33.33.33.33.1.2">𝑣</ci><cn id="A1.E13.m1.33.33.33.33.33.33.1.3.cmml" type="integer" xref="A1.E13.m1.33.33.33.33.33.33.1.3">1</cn></apply></apply><ci id="A1.E13.m1.34.34.34.34.34.34.1.cmml" xref="A1.E13.m1.34.34.34.34.34.34.1">𝑁</ci></apply><apply id="A1.E13.m1.83.83.2.2.2.2.2.2.2.2.cmml" xref="A1.E13.m1.85.85.4"><apply id="A1.E13.m1.83.83.2.2.2.2.2.2.2.2.3.cmml" xref="A1.E13.m1.85.85.4"><csymbol cd="ambiguous" id="A1.E13.m1.83.83.2.2.2.2.2.2.2.2.3.1.cmml" xref="A1.E13.m1.85.85.4">superscript</csymbol><apply id="A1.E13.m1.83.83.2.2.2.2.2.2.2.2.3.2.cmml" xref="A1.E13.m1.85.85.4"><csymbol cd="ambiguous" id="A1.E13.m1.83.83.2.2.2.2.2.2.2.2.3.2.1.cmml" xref="A1.E13.m1.85.85.4">subscript</csymbol><sum id="A1.E13.m1.35.35.35.35.35.35.cmml" xref="A1.E13.m1.35.35.35.35.35.35"></sum><apply id="A1.E13.m1.36.36.36.36.36.36.1.cmml" xref="A1.E13.m1.36.36.36.36.36.36.1"><eq id="A1.E13.m1.36.36.36.36.36.36.1.1.cmml" xref="A1.E13.m1.36.36.36.36.36.36.1.1"></eq><ci id="A1.E13.m1.36.36.36.36.36.36.1.2.cmml" xref="A1.E13.m1.36.36.36.36.36.36.1.2">𝑘</ci><cn id="A1.E13.m1.36.36.36.36.36.36.1.3.cmml" type="integer" xref="A1.E13.m1.36.36.36.36.36.36.1.3">0</cn></apply></apply><infinity id="A1.E13.m1.37.37.37.37.37.37.1.cmml" xref="A1.E13.m1.37.37.37.37.37.37.1"></infinity></apply><apply id="A1.E13.m1.83.83.2.2.2.2.2.2.2.2.2.cmml" xref="A1.E13.m1.85.85.4"><apply id="A1.E13.m1.83.83.2.2.2.2.2.2.2.2.2.3.cmml" xref="A1.E13.m1.85.85.4"><csymbol cd="ambiguous" id="A1.E13.m1.83.83.2.2.2.2.2.2.2.2.2.3.1.cmml" xref="A1.E13.m1.85.85.4">superscript</csymbol><apply id="A1.E13.m1.83.83.2.2.2.2.2.2.2.2.2.3.2.cmml" xref="A1.E13.m1.85.85.4"><csymbol cd="ambiguous" id="A1.E13.m1.83.83.2.2.2.2.2.2.2.2.2.3.2.1.cmml" xref="A1.E13.m1.85.85.4">subscript</csymbol><sum id="A1.E13.m1.38.38.38.38.38.38.cmml" xref="A1.E13.m1.38.38.38.38.38.38"></sum><apply id="A1.E13.m1.39.39.39.39.39.39.1.cmml" xref="A1.E13.m1.39.39.39.39.39.39.1"><eq id="A1.E13.m1.39.39.39.39.39.39.1.1.cmml" xref="A1.E13.m1.39.39.39.39.39.39.1.1"></eq><ci id="A1.E13.m1.39.39.39.39.39.39.1.2.cmml" xref="A1.E13.m1.39.39.39.39.39.39.1.2">𝑝</ci><cn id="A1.E13.m1.39.39.39.39.39.39.1.3.cmml" type="integer" xref="A1.E13.m1.39.39.39.39.39.39.1.3">0</cn></apply></apply><ci id="A1.E13.m1.40.40.40.40.40.40.1.cmml" xref="A1.E13.m1.40.40.40.40.40.40.1">𝑘</ci></apply><apply id="A1.E13.m1.83.83.2.2.2.2.2.2.2.2.2.2.cmml" xref="A1.E13.m1.85.85.4"><times id="A1.E13.m1.83.83.2.2.2.2.2.2.2.2.2.2.3.cmml" xref="A1.E13.m1.85.85.4"></times><apply id="A1.E13.m1.83.83.2.2.2.2.2.2.2.2.2.2.4.cmml" xref="A1.E13.m1.85.85.4"><csymbol cd="ambiguous" id="A1.E13.m1.83.83.2.2.2.2.2.2.2.2.2.2.4.1.cmml" xref="A1.E13.m1.85.85.4">subscript</csymbol><ci id="A1.E13.m1.41.41.41.41.41.41.cmml" xref="A1.E13.m1.41.41.41.41.41.41">𝑓</ci><apply id="A1.E13.m1.42.42.42.42.42.42.1.cmml" xref="A1.E13.m1.42.42.42.42.42.42.1"><minus id="A1.E13.m1.42.42.42.42.42.42.1.1.cmml" xref="A1.E13.m1.42.42.42.42.42.42.1.1"></minus><ci id="A1.E13.m1.42.42.42.42.42.42.1.2.cmml" xref="A1.E13.m1.42.42.42.42.42.42.1.2">𝑘</ci><ci id="A1.E13.m1.42.42.42.42.42.42.1.3.cmml" xref="A1.E13.m1.42.42.42.42.42.42.1.3">𝑝</ci></apply></apply><apply id="A1.E13.m1.83.83.2.2.2.2.2.2.2.2.2.2.5.cmml" xref="A1.E13.m1.85.85.4"><csymbol cd="ambiguous" id="A1.E13.m1.83.83.2.2.2.2.2.2.2.2.2.2.5.1.cmml" xref="A1.E13.m1.85.85.4">subscript</csymbol><ci id="A1.E13.m1.43.43.43.43.43.43.cmml" xref="A1.E13.m1.43.43.43.43.43.43">𝑓</ci><ci id="A1.E13.m1.44.44.44.44.44.44.1.cmml" xref="A1.E13.m1.44.44.44.44.44.44.1">𝑝</ci></apply><apply id="A1.E13.m1.83.83.2.2.2.2.2.2.2.2.2.2.6.cmml" xref="A1.E13.m1.85.85.4"><csymbol cd="ambiguous" id="A1.E13.m1.83.83.2.2.2.2.2.2.2.2.2.2.6.1.cmml" xref="A1.E13.m1.85.85.4">subscript</csymbol><apply id="A1.E13.m1.83.83.2.2.2.2.2.2.2.2.2.2.6.2.cmml" xref="A1.E13.m1.85.85.4"><csymbol cd="ambiguous" id="A1.E13.m1.83.83.2.2.2.2.2.2.2.2.2.2.6.2.1.cmml" xref="A1.E13.m1.85.85.4">superscript</csymbol><ci id="A1.E13.m1.45.45.45.45.45.45.cmml" xref="A1.E13.m1.45.45.45.45.45.45">𝐖</ci><apply id="A1.E13.m1.46.46.46.46.46.46.1.cmml" xref="A1.E13.m1.46.46.46.46.46.46.1"><minus id="A1.E13.m1.46.46.46.46.46.46.1.1.cmml" xref="A1.E13.m1.46.46.46.46.46.46.1.1"></minus><ci id="A1.E13.m1.46.46.46.46.46.46.1.2.cmml" xref="A1.E13.m1.46.46.46.46.46.46.1.2">𝑘</ci><ci id="A1.E13.m1.46.46.46.46.46.46.1.3.cmml" xref="A1.E13.m1.46.46.46.46.46.46.1.3">𝑝</ci></apply></apply><apply id="A1.E13.m1.47.47.47.47.47.47.1.cmml" xref="A1.E13.m1.47.47.47.47.47.47.1"><times id="A1.E13.m1.47.47.47.47.47.47.1.1.cmml" xref="A1.E13.m1.47.47.47.47.47.47.1.1"></times><ci id="A1.E13.m1.47.47.47.47.47.47.1.2.cmml" xref="A1.E13.m1.47.47.47.47.47.47.1.2">𝑖</ci><ci id="A1.E13.m1.47.47.47.47.47.47.1.3.cmml" xref="A1.E13.m1.47.47.47.47.47.47.1.3">𝑣</ci></apply></apply><apply id="A1.E13.m1.83.83.2.2.2.2.2.2.2.2.2.2.7.cmml" xref="A1.E13.m1.85.85.4"><csymbol cd="ambiguous" id="A1.E13.m1.83.83.2.2.2.2.2.2.2.2.2.2.7.1.cmml" xref="A1.E13.m1.85.85.4">subscript</csymbol><apply id="A1.E13.m1.83.83.2.2.2.2.2.2.2.2.2.2.7.2.cmml" xref="A1.E13.m1.85.85.4"><csymbol cd="ambiguous" id="A1.E13.m1.83.83.2.2.2.2.2.2.2.2.2.2.7.2.1.cmml" xref="A1.E13.m1.85.85.4">superscript</csymbol><ci id="A1.E13.m1.48.48.48.48.48.48.cmml" xref="A1.E13.m1.48.48.48.48.48.48">𝐖</ci><ci id="A1.E13.m1.49.49.49.49.49.49.1.cmml" xref="A1.E13.m1.49.49.49.49.49.49.1">𝑝</ci></apply><apply id="A1.E13.m1.50.50.50.50.50.50.1.cmml" xref="A1.E13.m1.50.50.50.50.50.50.1"><times id="A1.E13.m1.50.50.50.50.50.50.1.1.cmml" xref="A1.E13.m1.50.50.50.50.50.50.1.1"></times><ci id="A1.E13.m1.50.50.50.50.50.50.1.2.cmml" xref="A1.E13.m1.50.50.50.50.50.50.1.2">𝑣</ci><ci id="A1.E13.m1.50.50.50.50.50.50.1.3.cmml" xref="A1.E13.m1.50.50.50.50.50.50.1.3">𝑗</ci></apply></apply><apply id="A1.E13.m1.51.51.51.1.1.1.cmml" xref="A1.E13.m1.51.51.51.1.1.1"><cn id="A1.E13.m1.51.51.51.1.1.1.1.1.cmml" type="integer" xref="A1.E13.m1.51.51.51.1.1.1.1.1">3</cn><eq id="A1.E13.m1.51.51.51.1.1.1.2.cmml" xref="A1.E13.m1.51.51.51.1.1.1.2"></eq></apply><apply id="A1.E13.m1.83.83.2.2.2.2.2.2.2.2.2.2.2.cmml" xref="A1.E13.m1.85.85.4"><apply id="A1.E13.m1.83.83.2.2.2.2.2.2.2.2.2.2.2.3.cmml" xref="A1.E13.m1.85.85.4"><csymbol cd="ambiguous" id="A1.E13.m1.83.83.2.2.2.2.2.2.2.2.2.2.2.3.1.cmml" xref="A1.E13.m1.85.85.4">superscript</csymbol><apply id="A1.E13.m1.83.83.2.2.2.2.2.2.2.2.2.2.2.3.2.cmml" xref="A1.E13.m1.85.85.4"><csymbol cd="ambiguous" id="A1.E13.m1.83.83.2.2.2.2.2.2.2.2.2.2.2.3.2.1.cmml" xref="A1.E13.m1.85.85.4">subscript</csymbol><sum id="A1.E13.m1.52.52.52.2.2.2.cmml" xref="A1.E13.m1.52.52.52.2.2.2"></sum><apply id="A1.E13.m1.53.53.53.3.3.3.1.cmml" xref="A1.E13.m1.53.53.53.3.3.3.1"><eq id="A1.E13.m1.53.53.53.3.3.3.1.1.cmml" xref="A1.E13.m1.53.53.53.3.3.3.1.1"></eq><ci id="A1.E13.m1.53.53.53.3.3.3.1.2.cmml" xref="A1.E13.m1.53.53.53.3.3.3.1.2">𝑣</ci><cn id="A1.E13.m1.53.53.53.3.3.3.1.3.cmml" type="integer" xref="A1.E13.m1.53.53.53.3.3.3.1.3">1</cn></apply></apply><ci id="A1.E13.m1.54.54.54.4.4.4.1.cmml" xref="A1.E13.m1.54.54.54.4.4.4.1">𝑁</ci></apply><apply id="A1.E13.m1.83.83.2.2.2.2.2.2.2.2.2.2.2.2.cmml" xref="A1.E13.m1.85.85.4"><times id="A1.E13.m1.83.83.2.2.2.2.2.2.2.2.2.2.2.2.3.cmml" xref="A1.E13.m1.85.85.4"></times><apply id="A1.E13.m1.82.82.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E13.m1.85.85.4"><apply id="A1.E13.m1.82.82.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E13.m1.85.85.4"><csymbol cd="ambiguous" id="A1.E13.m1.82.82.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E13.m1.85.85.4">superscript</csymbol><apply id="A1.E13.m1.82.82.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E13.m1.85.85.4"><csymbol cd="ambiguous" id="A1.E13.m1.82.82.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="A1.E13.m1.85.85.4">subscript</csymbol><sum id="A1.E13.m1.56.56.56.6.6.6.cmml" xref="A1.E13.m1.56.56.56.6.6.6"></sum><apply id="A1.E13.m1.57.57.57.7.7.7.1.cmml" xref="A1.E13.m1.57.57.57.7.7.7.1"><eq id="A1.E13.m1.57.57.57.7.7.7.1.1.cmml" xref="A1.E13.m1.57.57.57.7.7.7.1.1"></eq><apply id="A1.E13.m1.57.57.57.7.7.7.1.2.cmml" xref="A1.E13.m1.57.57.57.7.7.7.1.2"><csymbol cd="ambiguous" id="A1.E13.m1.57.57.57.7.7.7.1.2.1.cmml" xref="A1.E13.m1.57.57.57.7.7.7.1.2">subscript</csymbol><ci id="A1.E13.m1.57.57.57.7.7.7.1.2.2.cmml" xref="A1.E13.m1.57.57.57.7.7.7.1.2.2">𝑘</ci><cn id="A1.E13.m1.57.57.57.7.7.7.1.2.3.cmml" type="integer" xref="A1.E13.m1.57.57.57.7.7.7.1.2.3">1</cn></apply><cn id="A1.E13.m1.57.57.57.7.7.7.1.3.cmml" type="integer" xref="A1.E13.m1.57.57.57.7.7.7.1.3">0</cn></apply></apply><infinity id="A1.E13.m1.58.58.58.8.8.8.1.cmml" xref="A1.E13.m1.58.58.58.8.8.8.1"></infinity></apply><apply id="A1.E13.m1.82.82.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E13.m1.85.85.4"><times id="A1.E13.m1.82.82.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="A1.E13.m1.85.85.4"></times><apply id="A1.E13.m1.82.82.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="A1.E13.m1.85.85.4"><csymbol cd="ambiguous" id="A1.E13.m1.82.82.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="A1.E13.m1.85.85.4">subscript</csymbol><ci id="A1.E13.m1.59.59.59.9.9.9.cmml" xref="A1.E13.m1.59.59.59.9.9.9">𝑓</ci><apply id="A1.E13.m1.60.60.60.10.10.10.1.cmml" xref="A1.E13.m1.60.60.60.10.10.10.1"><csymbol cd="ambiguous" id="A1.E13.m1.60.60.60.10.10.10.1.1.cmml" xref="A1.E13.m1.60.60.60.10.10.10.1">subscript</csymbol><ci id="A1.E13.m1.60.60.60.10.10.10.1.2.cmml" xref="A1.E13.m1.60.60.60.10.10.10.1.2">𝑘</ci><cn id="A1.E13.m1.60.60.60.10.10.10.1.3.cmml" type="integer" xref="A1.E13.m1.60.60.60.10.10.10.1.3">1</cn></apply></apply><apply id="A1.E13.m1.82.82.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="A1.E13.m1.85.85.4"><csymbol cd="ambiguous" id="A1.E13.m1.82.82.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="A1.E13.m1.85.85.4">subscript</csymbol><apply id="A1.E13.m1.82.82.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="A1.E13.m1.85.85.4"><csymbol cd="ambiguous" id="A1.E13.m1.82.82.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.2.1.cmml" xref="A1.E13.m1.85.85.4">superscript</csymbol><ci id="A1.E13.m1.61.61.61.11.11.11.cmml" xref="A1.E13.m1.61.61.61.11.11.11">𝐖</ci><apply id="A1.E13.m1.62.62.62.12.12.12.1.cmml" xref="A1.E13.m1.62.62.62.12.12.12.1"><csymbol cd="ambiguous" id="A1.E13.m1.62.62.62.12.12.12.1.1.cmml" xref="A1.E13.m1.62.62.62.12.12.12.1">subscript</csymbol><ci id="A1.E13.m1.62.62.62.12.12.12.1.2.cmml" xref="A1.E13.m1.62.62.62.12.12.12.1.2">𝑘</ci><cn id="A1.E13.m1.62.62.62.12.12.12.1.3.cmml" type="integer" xref="A1.E13.m1.62.62.62.12.12.12.1.3">1</cn></apply></apply><apply id="A1.E13.m1.63.63.63.13.13.13.1.cmml" xref="A1.E13.m1.63.63.63.13.13.13.1"><times id="A1.E13.m1.63.63.63.13.13.13.1.1.cmml" xref="A1.E13.m1.63.63.63.13.13.13.1.1"></times><ci id="A1.E13.m1.63.63.63.13.13.13.1.2.cmml" xref="A1.E13.m1.63.63.63.13.13.13.1.2">𝑖</ci><ci id="A1.E13.m1.63.63.63.13.13.13.1.3.cmml" xref="A1.E13.m1.63.63.63.13.13.13.1.3">𝑣</ci></apply></apply></apply></apply><apply id="A1.E13.m1.83.83.2.2.2.2.2.2.2.2.2.2.2.2.2.cmml" xref="A1.E13.m1.85.85.4"><csymbol cd="ambiguous" id="A1.E13.m1.83.83.2.2.2.2.2.2.2.2.2.2.2.2.2.2.cmml" xref="A1.E13.m1.85.85.4">superscript</csymbol><apply id="A1.E13.m1.83.83.2.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.cmml" xref="A1.E13.m1.85.85.4"><apply id="A1.E13.m1.83.83.2.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.cmml" xref="A1.E13.m1.85.85.4"><csymbol cd="ambiguous" id="A1.E13.m1.83.83.2.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.cmml" xref="A1.E13.m1.85.85.4">superscript</csymbol><apply id="A1.E13.m1.83.83.2.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.2.cmml" xref="A1.E13.m1.85.85.4"><csymbol cd="ambiguous" id="A1.E13.m1.83.83.2.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.2.1.cmml" xref="A1.E13.m1.85.85.4">subscript</csymbol><sum id="A1.E13.m1.66.66.66.16.16.16.cmml" xref="A1.E13.m1.66.66.66.16.16.16"></sum><apply id="A1.E13.m1.67.67.67.17.17.17.1.cmml" xref="A1.E13.m1.67.67.67.17.17.17.1"><eq id="A1.E13.m1.67.67.67.17.17.17.1.1.cmml" xref="A1.E13.m1.67.67.67.17.17.17.1.1"></eq><apply id="A1.E13.m1.67.67.67.17.17.17.1.2.cmml" xref="A1.E13.m1.67.67.67.17.17.17.1.2"><csymbol cd="ambiguous" id="A1.E13.m1.67.67.67.17.17.17.1.2.1.cmml" xref="A1.E13.m1.67.67.67.17.17.17.1.2">subscript</csymbol><ci id="A1.E13.m1.67.67.67.17.17.17.1.2.2.cmml" xref="A1.E13.m1.67.67.67.17.17.17.1.2.2">𝑘</ci><cn id="A1.E13.m1.67.67.67.17.17.17.1.2.3.cmml" type="integer" xref="A1.E13.m1.67.67.67.17.17.17.1.2.3">2</cn></apply><cn id="A1.E13.m1.67.67.67.17.17.17.1.3.cmml" type="integer" xref="A1.E13.m1.67.67.67.17.17.17.1.3">0</cn></apply></apply><infinity id="A1.E13.m1.68.68.68.18.18.18.1.cmml" xref="A1.E13.m1.68.68.68.18.18.18.1"></infinity></apply><apply id="A1.E13.m1.83.83.2.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.2.cmml" xref="A1.E13.m1.85.85.4"><times id="A1.E13.m1.83.83.2.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.2.1.cmml" xref="A1.E13.m1.85.85.4"></times><apply id="A1.E13.m1.83.83.2.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.2.2.cmml" xref="A1.E13.m1.85.85.4"><csymbol cd="ambiguous" id="A1.E13.m1.83.83.2.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.2.2.1.cmml" xref="A1.E13.m1.85.85.4">subscript</csymbol><ci id="A1.E13.m1.69.69.69.19.19.19.cmml" xref="A1.E13.m1.69.69.69.19.19.19">𝑓</ci><apply id="A1.E13.m1.70.70.70.20.20.20.1.cmml" xref="A1.E13.m1.70.70.70.20.20.20.1"><csymbol cd="ambiguous" id="A1.E13.m1.70.70.70.20.20.20.1.1.cmml" xref="A1.E13.m1.70.70.70.20.20.20.1">subscript</csymbol><ci id="A1.E13.m1.70.70.70.20.20.20.1.2.cmml" xref="A1.E13.m1.70.70.70.20.20.20.1.2">𝑘</ci><cn id="A1.E13.m1.70.70.70.20.20.20.1.3.cmml" type="integer" xref="A1.E13.m1.70.70.70.20.20.20.1.3">2</cn></apply></apply><apply id="A1.E13.m1.83.83.2.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.2.3.cmml" xref="A1.E13.m1.85.85.4"><csymbol cd="ambiguous" id="A1.E13.m1.83.83.2.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.2.3.1.cmml" xref="A1.E13.m1.85.85.4">subscript</csymbol><apply id="A1.E13.m1.83.83.2.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.2.3.2.cmml" xref="A1.E13.m1.85.85.4"><csymbol cd="ambiguous" id="A1.E13.m1.83.83.2.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.2.3.2.1.cmml" xref="A1.E13.m1.85.85.4">superscript</csymbol><ci id="A1.E13.m1.71.71.71.21.21.21.cmml" xref="A1.E13.m1.71.71.71.21.21.21">𝐖</ci><apply id="A1.E13.m1.72.72.72.22.22.22.1.cmml" xref="A1.E13.m1.72.72.72.22.22.22.1"><csymbol cd="ambiguous" id="A1.E13.m1.72.72.72.22.22.22.1.1.cmml" xref="A1.E13.m1.72.72.72.22.22.22.1">subscript</csymbol><ci id="A1.E13.m1.72.72.72.22.22.22.1.2.cmml" xref="A1.E13.m1.72.72.72.22.22.22.1.2">𝑘</ci><cn id="A1.E13.m1.72.72.72.22.22.22.1.3.cmml" type="integer" xref="A1.E13.m1.72.72.72.22.22.22.1.3">2</cn></apply></apply><apply id="A1.E13.m1.73.73.73.23.23.23.1.cmml" xref="A1.E13.m1.73.73.73.23.23.23.1"><times id="A1.E13.m1.73.73.73.23.23.23.1.1.cmml" xref="A1.E13.m1.73.73.73.23.23.23.1.1"></times><ci id="A1.E13.m1.73.73.73.23.23.23.1.2.cmml" xref="A1.E13.m1.73.73.73.23.23.23.1.2">𝑗</ci><ci id="A1.E13.m1.73.73.73.23.23.23.1.3.cmml" xref="A1.E13.m1.73.73.73.23.23.23.1.3">𝑣</ci></apply></apply></apply></apply><csymbol cd="latexml" id="A1.E13.m1.75.75.75.25.25.25.1.cmml" xref="A1.E13.m1.75.75.75.25.25.25.1">top</csymbol></apply><apply id="A1.E13.m1.76.76.76.26.26.26.cmml" xref="A1.E13.m1.76.76.76.26.26.26"><cn id="A1.E13.m1.76.76.76.26.26.26.1.1.cmml" type="integer" xref="A1.E13.m1.76.76.76.26.26.26.1.1">4</cn><eq id="A1.E13.m1.76.76.76.26.26.26.2.cmml" xref="A1.E13.m1.76.76.76.26.26.26.2"></eq></apply><apply id="A1.E13.m1.83.83.2.2.2.2.2.2.2.2.2.2.2.2.5.cmml" xref="A1.E13.m1.85.85.4"><csymbol cd="ambiguous" id="A1.E13.m1.83.83.2.2.2.2.2.2.2.2.2.2.2.2.5.1.cmml" xref="A1.E13.m1.85.85.4">subscript</csymbol><ci id="A1.E13.m1.77.77.77.27.27.27.cmml" xref="A1.E13.m1.77.77.77.27.27.27">𝚽</ci><ci id="A1.E13.m1.78.78.78.28.28.28.1.cmml" xref="A1.E13.m1.78.78.78.28.28.28.1">𝒢</ci></apply><apply id="A1.E13.m1.83.83.2.2.2.2.2.2.2.2.2.2.2.2.6.cmml" xref="A1.E13.m1.85.85.4"><csymbol cd="ambiguous" id="A1.E13.m1.83.83.2.2.2.2.2.2.2.2.2.2.2.2.6.1.cmml" xref="A1.E13.m1.85.85.4">superscript</csymbol><apply id="A1.E13.m1.83.83.2.2.2.2.2.2.2.2.2.2.2.2.6.2.cmml" xref="A1.E13.m1.85.85.4"><csymbol cd="ambiguous" id="A1.E13.m1.83.83.2.2.2.2.2.2.2.2.2.2.2.2.6.2.1.cmml" xref="A1.E13.m1.85.85.4">subscript</csymbol><ci id="A1.E13.m1.79.79.79.29.29.29.cmml" xref="A1.E13.m1.79.79.79.29.29.29">𝚽</ci><ci id="A1.E13.m1.80.80.80.30.30.30.1.cmml" xref="A1.E13.m1.80.80.80.30.30.30.1">𝒢</ci></apply><csymbol cd="latexml" id="A1.E13.m1.81.81.81.31.31.31.1.cmml" xref="A1.E13.m1.81.81.81.31.31.31.1">top</csymbol></apply></apply></apply></apply></apply></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E13.m1.85c">\begin{multlined}\mathbf{M}_{\alpha}(\mathcal{G})_{ij}\coloneqq\sum_{k=0}^{%
\infty}\alpha_{k}\mathbf{W}^{k}_{ij}\overset{(1)}{=}\sum_{v=1}^{N}\sum_{k=0}^{%
\infty}\alpha_{k}\mathbf{W}^{k-p}_{iv}\mathbf{W}^{p}_{vj}\overset{(2)}{=}\sum_%
{v=1}^{N}\sum_{k=0}^{\infty}\sum_{p=0}^{k}f_{k-p}f_{p}\mathbf{W}^{k-p}_{iv}%
\mathbf{W}^{p}_{vj}\\
\overset{(3)}{=}\sum_{v=1}^{N}\left(\sum_{k_{1}=0}^{\infty}f_{k_{1}}\mathbf{W}%
^{k_{1}}_{iv}\right)\left(\sum_{k_{2}=0}^{\infty}f_{k_{2}}\mathbf{W}^{k_{2}}_{%
jv}\right)^{\top}\overset{(4)}{=}\mathbf{\Phi}_{\mathcal{G}}\mathbf{\Phi}_{%
\mathcal{G}}^{\top}\end{multlined}\mathbf{M}_{\alpha}(\mathcal{G})_{ij}%
\coloneqq\sum_{k=0}^{\infty}\alpha_{k}\mathbf{W}^{k}_{ij}\overset{(1)}{=}\sum_%
{v=1}^{N}\sum_{k=0}^{\infty}\alpha_{k}\mathbf{W}^{k-p}_{iv}\mathbf{W}^{p}_{vj}%
\overset{(2)}{=}\sum_{v=1}^{N}\sum_{k=0}^{\infty}\sum_{p=0}^{k}f_{k-p}f_{p}%
\mathbf{W}^{k-p}_{iv}\mathbf{W}^{p}_{vj}\\
\overset{(3)}{=}\sum_{v=1}^{N}\left(\sum_{k_{1}=0}^{\infty}f_{k_{1}}\mathbf{W}%
^{k_{1}}_{iv}\right)\left(\sum_{k_{2}=0}^{\infty}f_{k_{2}}\mathbf{W}^{k_{2}}_{%
jv}\right)^{\top}\overset{(4)}{=}\mathbf{\Phi}_{\mathcal{G}}\mathbf{\Phi}_{%
\mathcal{G}}^{\top}</annotation><annotation encoding="application/x-llamapun" id="A1.E13.m1.85d">start_ROW start_CELL bold_M start_POSTSUBSCRIPT italic_α end_POSTSUBSCRIPT ( caligraphic_G ) start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT ≔ ∑ start_POSTSUBSCRIPT italic_k = 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∞ end_POSTSUPERSCRIPT italic_α start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT bold_W start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT start_OVERACCENT ( 1 ) end_OVERACCENT start_ARG = end_ARG ∑ start_POSTSUBSCRIPT italic_v = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT ∑ start_POSTSUBSCRIPT italic_k = 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∞ end_POSTSUPERSCRIPT italic_α start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT bold_W start_POSTSUPERSCRIPT italic_k - italic_p end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i italic_v end_POSTSUBSCRIPT bold_W start_POSTSUPERSCRIPT italic_p end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_v italic_j end_POSTSUBSCRIPT start_OVERACCENT ( 2 ) end_OVERACCENT start_ARG = end_ARG ∑ start_POSTSUBSCRIPT italic_v = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT ∑ start_POSTSUBSCRIPT italic_k = 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∞ end_POSTSUPERSCRIPT ∑ start_POSTSUBSCRIPT italic_p = 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT italic_f start_POSTSUBSCRIPT italic_k - italic_p end_POSTSUBSCRIPT italic_f start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT bold_W start_POSTSUPERSCRIPT italic_k - italic_p end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i italic_v end_POSTSUBSCRIPT bold_W start_POSTSUPERSCRIPT italic_p end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_v italic_j end_POSTSUBSCRIPT end_CELL end_ROW start_ROW start_CELL start_OVERACCENT ( 3 ) end_OVERACCENT start_ARG = end_ARG ∑ start_POSTSUBSCRIPT italic_v = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT ( ∑ start_POSTSUBSCRIPT italic_k start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT = 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∞ end_POSTSUPERSCRIPT italic_f start_POSTSUBSCRIPT italic_k start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT bold_W start_POSTSUPERSCRIPT italic_k start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i italic_v end_POSTSUBSCRIPT ) ( ∑ start_POSTSUBSCRIPT italic_k start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT = 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∞ end_POSTSUPERSCRIPT italic_f start_POSTSUBSCRIPT italic_k start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT bold_W start_POSTSUPERSCRIPT italic_k start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_j italic_v end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT start_OVERACCENT ( 4 ) end_OVERACCENT start_ARG = end_ARG bold_Φ start_POSTSUBSCRIPT caligraphic_G end_POSTSUBSCRIPT bold_Φ start_POSTSUBSCRIPT caligraphic_G end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(13)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A1.SS1.p1.7">where <math alttext="\mathbf{\Phi}_{\mathcal{G}}\coloneqq\sum_{k=0}^{\infty}f_{k}\mathbf{W}^{k}" class="ltx_Math" display="inline" id="A1.SS1.p1.1.m1.1"><semantics id="A1.SS1.p1.1.m1.1a"><mrow id="A1.SS1.p1.1.m1.1.1" xref="A1.SS1.p1.1.m1.1.1.cmml"><msub id="A1.SS1.p1.1.m1.1.1.2" xref="A1.SS1.p1.1.m1.1.1.2.cmml"><mi id="A1.SS1.p1.1.m1.1.1.2.2" xref="A1.SS1.p1.1.m1.1.1.2.2.cmml">𝚽</mi><mi class="ltx_font_mathcaligraphic" id="A1.SS1.p1.1.m1.1.1.2.3" xref="A1.SS1.p1.1.m1.1.1.2.3.cmml">𝒢</mi></msub><mo id="A1.SS1.p1.1.m1.1.1.1" rspace="0.111em" xref="A1.SS1.p1.1.m1.1.1.1.cmml">≔</mo><mrow id="A1.SS1.p1.1.m1.1.1.3" xref="A1.SS1.p1.1.m1.1.1.3.cmml"><msubsup id="A1.SS1.p1.1.m1.1.1.3.1" xref="A1.SS1.p1.1.m1.1.1.3.1.cmml"><mo id="A1.SS1.p1.1.m1.1.1.3.1.2.2" xref="A1.SS1.p1.1.m1.1.1.3.1.2.2.cmml">∑</mo><mrow id="A1.SS1.p1.1.m1.1.1.3.1.2.3" xref="A1.SS1.p1.1.m1.1.1.3.1.2.3.cmml"><mi id="A1.SS1.p1.1.m1.1.1.3.1.2.3.2" xref="A1.SS1.p1.1.m1.1.1.3.1.2.3.2.cmml">k</mi><mo id="A1.SS1.p1.1.m1.1.1.3.1.2.3.1" xref="A1.SS1.p1.1.m1.1.1.3.1.2.3.1.cmml">=</mo><mn id="A1.SS1.p1.1.m1.1.1.3.1.2.3.3" xref="A1.SS1.p1.1.m1.1.1.3.1.2.3.3.cmml">0</mn></mrow><mi id="A1.SS1.p1.1.m1.1.1.3.1.3" mathvariant="normal" xref="A1.SS1.p1.1.m1.1.1.3.1.3.cmml">∞</mi></msubsup><mrow id="A1.SS1.p1.1.m1.1.1.3.2" xref="A1.SS1.p1.1.m1.1.1.3.2.cmml"><msub id="A1.SS1.p1.1.m1.1.1.3.2.2" xref="A1.SS1.p1.1.m1.1.1.3.2.2.cmml"><mi id="A1.SS1.p1.1.m1.1.1.3.2.2.2" xref="A1.SS1.p1.1.m1.1.1.3.2.2.2.cmml">f</mi><mi id="A1.SS1.p1.1.m1.1.1.3.2.2.3" xref="A1.SS1.p1.1.m1.1.1.3.2.2.3.cmml">k</mi></msub><mo id="A1.SS1.p1.1.m1.1.1.3.2.1" xref="A1.SS1.p1.1.m1.1.1.3.2.1.cmml">⁢</mo><msup id="A1.SS1.p1.1.m1.1.1.3.2.3" xref="A1.SS1.p1.1.m1.1.1.3.2.3.cmml"><mi id="A1.SS1.p1.1.m1.1.1.3.2.3.2" xref="A1.SS1.p1.1.m1.1.1.3.2.3.2.cmml">𝐖</mi><mi id="A1.SS1.p1.1.m1.1.1.3.2.3.3" xref="A1.SS1.p1.1.m1.1.1.3.2.3.3.cmml">k</mi></msup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.1.m1.1b"><apply id="A1.SS1.p1.1.m1.1.1.cmml" xref="A1.SS1.p1.1.m1.1.1"><ci id="A1.SS1.p1.1.m1.1.1.1.cmml" xref="A1.SS1.p1.1.m1.1.1.1">≔</ci><apply id="A1.SS1.p1.1.m1.1.1.2.cmml" xref="A1.SS1.p1.1.m1.1.1.2"><csymbol cd="ambiguous" id="A1.SS1.p1.1.m1.1.1.2.1.cmml" xref="A1.SS1.p1.1.m1.1.1.2">subscript</csymbol><ci id="A1.SS1.p1.1.m1.1.1.2.2.cmml" xref="A1.SS1.p1.1.m1.1.1.2.2">𝚽</ci><ci id="A1.SS1.p1.1.m1.1.1.2.3.cmml" xref="A1.SS1.p1.1.m1.1.1.2.3">𝒢</ci></apply><apply id="A1.SS1.p1.1.m1.1.1.3.cmml" xref="A1.SS1.p1.1.m1.1.1.3"><apply id="A1.SS1.p1.1.m1.1.1.3.1.cmml" xref="A1.SS1.p1.1.m1.1.1.3.1"><csymbol cd="ambiguous" id="A1.SS1.p1.1.m1.1.1.3.1.1.cmml" xref="A1.SS1.p1.1.m1.1.1.3.1">superscript</csymbol><apply id="A1.SS1.p1.1.m1.1.1.3.1.2.cmml" xref="A1.SS1.p1.1.m1.1.1.3.1"><csymbol cd="ambiguous" id="A1.SS1.p1.1.m1.1.1.3.1.2.1.cmml" xref="A1.SS1.p1.1.m1.1.1.3.1">subscript</csymbol><sum id="A1.SS1.p1.1.m1.1.1.3.1.2.2.cmml" xref="A1.SS1.p1.1.m1.1.1.3.1.2.2"></sum><apply id="A1.SS1.p1.1.m1.1.1.3.1.2.3.cmml" xref="A1.SS1.p1.1.m1.1.1.3.1.2.3"><eq id="A1.SS1.p1.1.m1.1.1.3.1.2.3.1.cmml" xref="A1.SS1.p1.1.m1.1.1.3.1.2.3.1"></eq><ci id="A1.SS1.p1.1.m1.1.1.3.1.2.3.2.cmml" xref="A1.SS1.p1.1.m1.1.1.3.1.2.3.2">𝑘</ci><cn id="A1.SS1.p1.1.m1.1.1.3.1.2.3.3.cmml" type="integer" xref="A1.SS1.p1.1.m1.1.1.3.1.2.3.3">0</cn></apply></apply><infinity id="A1.SS1.p1.1.m1.1.1.3.1.3.cmml" xref="A1.SS1.p1.1.m1.1.1.3.1.3"></infinity></apply><apply id="A1.SS1.p1.1.m1.1.1.3.2.cmml" xref="A1.SS1.p1.1.m1.1.1.3.2"><times id="A1.SS1.p1.1.m1.1.1.3.2.1.cmml" xref="A1.SS1.p1.1.m1.1.1.3.2.1"></times><apply id="A1.SS1.p1.1.m1.1.1.3.2.2.cmml" xref="A1.SS1.p1.1.m1.1.1.3.2.2"><csymbol cd="ambiguous" id="A1.SS1.p1.1.m1.1.1.3.2.2.1.cmml" xref="A1.SS1.p1.1.m1.1.1.3.2.2">subscript</csymbol><ci id="A1.SS1.p1.1.m1.1.1.3.2.2.2.cmml" xref="A1.SS1.p1.1.m1.1.1.3.2.2.2">𝑓</ci><ci id="A1.SS1.p1.1.m1.1.1.3.2.2.3.cmml" xref="A1.SS1.p1.1.m1.1.1.3.2.2.3">𝑘</ci></apply><apply id="A1.SS1.p1.1.m1.1.1.3.2.3.cmml" xref="A1.SS1.p1.1.m1.1.1.3.2.3"><csymbol cd="ambiguous" id="A1.SS1.p1.1.m1.1.1.3.2.3.1.cmml" xref="A1.SS1.p1.1.m1.1.1.3.2.3">superscript</csymbol><ci id="A1.SS1.p1.1.m1.1.1.3.2.3.2.cmml" xref="A1.SS1.p1.1.m1.1.1.3.2.3.2">𝐖</ci><ci id="A1.SS1.p1.1.m1.1.1.3.2.3.3.cmml" xref="A1.SS1.p1.1.m1.1.1.3.2.3.3">𝑘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.1.m1.1c">\mathbf{\Phi}_{\mathcal{G}}\coloneqq\sum_{k=0}^{\infty}f_{k}\mathbf{W}^{k}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p1.1.m1.1d">bold_Φ start_POSTSUBSCRIPT caligraphic_G end_POSTSUBSCRIPT ≔ ∑ start_POSTSUBSCRIPT italic_k = 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∞ end_POSTSUPERSCRIPT italic_f start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT bold_W start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT</annotation></semantics></math>.
Here, step (1) splits the <math alttext="\mathbf{W}^{k}" class="ltx_Math" display="inline" id="A1.SS1.p1.2.m2.1"><semantics id="A1.SS1.p1.2.m2.1a"><msup id="A1.SS1.p1.2.m2.1.1" xref="A1.SS1.p1.2.m2.1.1.cmml"><mi id="A1.SS1.p1.2.m2.1.1.2" xref="A1.SS1.p1.2.m2.1.1.2.cmml">𝐖</mi><mi id="A1.SS1.p1.2.m2.1.1.3" xref="A1.SS1.p1.2.m2.1.1.3.cmml">k</mi></msup><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.2.m2.1b"><apply id="A1.SS1.p1.2.m2.1.1.cmml" xref="A1.SS1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="A1.SS1.p1.2.m2.1.1.1.cmml" xref="A1.SS1.p1.2.m2.1.1">superscript</csymbol><ci id="A1.SS1.p1.2.m2.1.1.2.cmml" xref="A1.SS1.p1.2.m2.1.1.2">𝐖</ci><ci id="A1.SS1.p1.2.m2.1.1.3.cmml" xref="A1.SS1.p1.2.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.2.m2.1c">\mathbf{W}^{k}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p1.2.m2.1d">bold_W start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT</annotation></semantics></math> into a product of <math alttext="\mathbf{W}^{k-p}" class="ltx_Math" display="inline" id="A1.SS1.p1.3.m3.1"><semantics id="A1.SS1.p1.3.m3.1a"><msup id="A1.SS1.p1.3.m3.1.1" xref="A1.SS1.p1.3.m3.1.1.cmml"><mi id="A1.SS1.p1.3.m3.1.1.2" xref="A1.SS1.p1.3.m3.1.1.2.cmml">𝐖</mi><mrow id="A1.SS1.p1.3.m3.1.1.3" xref="A1.SS1.p1.3.m3.1.1.3.cmml"><mi id="A1.SS1.p1.3.m3.1.1.3.2" xref="A1.SS1.p1.3.m3.1.1.3.2.cmml">k</mi><mo id="A1.SS1.p1.3.m3.1.1.3.1" xref="A1.SS1.p1.3.m3.1.1.3.1.cmml">−</mo><mi id="A1.SS1.p1.3.m3.1.1.3.3" xref="A1.SS1.p1.3.m3.1.1.3.3.cmml">p</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.3.m3.1b"><apply id="A1.SS1.p1.3.m3.1.1.cmml" xref="A1.SS1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="A1.SS1.p1.3.m3.1.1.1.cmml" xref="A1.SS1.p1.3.m3.1.1">superscript</csymbol><ci id="A1.SS1.p1.3.m3.1.1.2.cmml" xref="A1.SS1.p1.3.m3.1.1.2">𝐖</ci><apply id="A1.SS1.p1.3.m3.1.1.3.cmml" xref="A1.SS1.p1.3.m3.1.1.3"><minus id="A1.SS1.p1.3.m3.1.1.3.1.cmml" xref="A1.SS1.p1.3.m3.1.1.3.1"></minus><ci id="A1.SS1.p1.3.m3.1.1.3.2.cmml" xref="A1.SS1.p1.3.m3.1.1.3.2">𝑘</ci><ci id="A1.SS1.p1.3.m3.1.1.3.3.cmml" xref="A1.SS1.p1.3.m3.1.1.3.3">𝑝</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.3.m3.1c">\mathbf{W}^{k-p}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p1.3.m3.1d">bold_W start_POSTSUPERSCRIPT italic_k - italic_p end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="\mathbf{W}^{p}" class="ltx_Math" display="inline" id="A1.SS1.p1.4.m4.1"><semantics id="A1.SS1.p1.4.m4.1a"><msup id="A1.SS1.p1.4.m4.1.1" xref="A1.SS1.p1.4.m4.1.1.cmml"><mi id="A1.SS1.p1.4.m4.1.1.2" xref="A1.SS1.p1.4.m4.1.1.2.cmml">𝐖</mi><mi id="A1.SS1.p1.4.m4.1.1.3" xref="A1.SS1.p1.4.m4.1.1.3.cmml">p</mi></msup><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.4.m4.1b"><apply id="A1.SS1.p1.4.m4.1.1.cmml" xref="A1.SS1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="A1.SS1.p1.4.m4.1.1.1.cmml" xref="A1.SS1.p1.4.m4.1.1">superscript</csymbol><ci id="A1.SS1.p1.4.m4.1.1.2.cmml" xref="A1.SS1.p1.4.m4.1.1.2">𝐖</ci><ci id="A1.SS1.p1.4.m4.1.1.3.cmml" xref="A1.SS1.p1.4.m4.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.4.m4.1c">\mathbf{W}^{p}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p1.4.m4.1d">bold_W start_POSTSUPERSCRIPT italic_p end_POSTSUPERSCRIPT</annotation></semantics></math> with <math alttext="p\in\mathbb{N}" class="ltx_Math" display="inline" id="A1.SS1.p1.5.m5.1"><semantics id="A1.SS1.p1.5.m5.1a"><mrow id="A1.SS1.p1.5.m5.1.1" xref="A1.SS1.p1.5.m5.1.1.cmml"><mi id="A1.SS1.p1.5.m5.1.1.2" xref="A1.SS1.p1.5.m5.1.1.2.cmml">p</mi><mo id="A1.SS1.p1.5.m5.1.1.1" xref="A1.SS1.p1.5.m5.1.1.1.cmml">∈</mo><mi id="A1.SS1.p1.5.m5.1.1.3" xref="A1.SS1.p1.5.m5.1.1.3.cmml">ℕ</mi></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.5.m5.1b"><apply id="A1.SS1.p1.5.m5.1.1.cmml" xref="A1.SS1.p1.5.m5.1.1"><in id="A1.SS1.p1.5.m5.1.1.1.cmml" xref="A1.SS1.p1.5.m5.1.1.1"></in><ci id="A1.SS1.p1.5.m5.1.1.2.cmml" xref="A1.SS1.p1.5.m5.1.1.2">𝑝</ci><ci id="A1.SS1.p1.5.m5.1.1.3.cmml" xref="A1.SS1.p1.5.m5.1.1.3">ℕ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.5.m5.1c">p\in\mathbb{N}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p1.5.m5.1d">italic_p ∈ blackboard_N</annotation></semantics></math>; step (2) replaces <math alttext="\alpha_{k}" class="ltx_Math" display="inline" id="A1.SS1.p1.6.m6.1"><semantics id="A1.SS1.p1.6.m6.1a"><msub id="A1.SS1.p1.6.m6.1.1" xref="A1.SS1.p1.6.m6.1.1.cmml"><mi id="A1.SS1.p1.6.m6.1.1.2" xref="A1.SS1.p1.6.m6.1.1.2.cmml">α</mi><mi id="A1.SS1.p1.6.m6.1.1.3" xref="A1.SS1.p1.6.m6.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.6.m6.1b"><apply id="A1.SS1.p1.6.m6.1.1.cmml" xref="A1.SS1.p1.6.m6.1.1"><csymbol cd="ambiguous" id="A1.SS1.p1.6.m6.1.1.1.cmml" xref="A1.SS1.p1.6.m6.1.1">subscript</csymbol><ci id="A1.SS1.p1.6.m6.1.1.2.cmml" xref="A1.SS1.p1.6.m6.1.1.2">𝛼</ci><ci id="A1.SS1.p1.6.m6.1.1.3.cmml" xref="A1.SS1.p1.6.m6.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.6.m6.1c">\alpha_{k}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p1.6.m6.1d">italic_α start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> by the convolution <math alttext="\alpha_{k}\eqqcolon\sum_{p=0}^{k}f_{p}f_{k-p}" class="ltx_Math" display="inline" id="A1.SS1.p1.7.m7.1"><semantics id="A1.SS1.p1.7.m7.1a"><mrow id="A1.SS1.p1.7.m7.1.1" xref="A1.SS1.p1.7.m7.1.1.cmml"><msub id="A1.SS1.p1.7.m7.1.1.2" xref="A1.SS1.p1.7.m7.1.1.2.cmml"><mi id="A1.SS1.p1.7.m7.1.1.2.2" xref="A1.SS1.p1.7.m7.1.1.2.2.cmml">α</mi><mi id="A1.SS1.p1.7.m7.1.1.2.3" xref="A1.SS1.p1.7.m7.1.1.2.3.cmml">k</mi></msub><mo id="A1.SS1.p1.7.m7.1.1.1" rspace="0.111em" xref="A1.SS1.p1.7.m7.1.1.1.cmml">≕</mo><mrow id="A1.SS1.p1.7.m7.1.1.3" xref="A1.SS1.p1.7.m7.1.1.3.cmml"><msubsup id="A1.SS1.p1.7.m7.1.1.3.1" xref="A1.SS1.p1.7.m7.1.1.3.1.cmml"><mo id="A1.SS1.p1.7.m7.1.1.3.1.2.2" xref="A1.SS1.p1.7.m7.1.1.3.1.2.2.cmml">∑</mo><mrow id="A1.SS1.p1.7.m7.1.1.3.1.2.3" xref="A1.SS1.p1.7.m7.1.1.3.1.2.3.cmml"><mi id="A1.SS1.p1.7.m7.1.1.3.1.2.3.2" xref="A1.SS1.p1.7.m7.1.1.3.1.2.3.2.cmml">p</mi><mo id="A1.SS1.p1.7.m7.1.1.3.1.2.3.1" xref="A1.SS1.p1.7.m7.1.1.3.1.2.3.1.cmml">=</mo><mn id="A1.SS1.p1.7.m7.1.1.3.1.2.3.3" xref="A1.SS1.p1.7.m7.1.1.3.1.2.3.3.cmml">0</mn></mrow><mi id="A1.SS1.p1.7.m7.1.1.3.1.3" xref="A1.SS1.p1.7.m7.1.1.3.1.3.cmml">k</mi></msubsup><mrow id="A1.SS1.p1.7.m7.1.1.3.2" xref="A1.SS1.p1.7.m7.1.1.3.2.cmml"><msub id="A1.SS1.p1.7.m7.1.1.3.2.2" xref="A1.SS1.p1.7.m7.1.1.3.2.2.cmml"><mi id="A1.SS1.p1.7.m7.1.1.3.2.2.2" xref="A1.SS1.p1.7.m7.1.1.3.2.2.2.cmml">f</mi><mi id="A1.SS1.p1.7.m7.1.1.3.2.2.3" xref="A1.SS1.p1.7.m7.1.1.3.2.2.3.cmml">p</mi></msub><mo id="A1.SS1.p1.7.m7.1.1.3.2.1" xref="A1.SS1.p1.7.m7.1.1.3.2.1.cmml">⁢</mo><msub id="A1.SS1.p1.7.m7.1.1.3.2.3" xref="A1.SS1.p1.7.m7.1.1.3.2.3.cmml"><mi id="A1.SS1.p1.7.m7.1.1.3.2.3.2" xref="A1.SS1.p1.7.m7.1.1.3.2.3.2.cmml">f</mi><mrow id="A1.SS1.p1.7.m7.1.1.3.2.3.3" xref="A1.SS1.p1.7.m7.1.1.3.2.3.3.cmml"><mi id="A1.SS1.p1.7.m7.1.1.3.2.3.3.2" xref="A1.SS1.p1.7.m7.1.1.3.2.3.3.2.cmml">k</mi><mo id="A1.SS1.p1.7.m7.1.1.3.2.3.3.1" xref="A1.SS1.p1.7.m7.1.1.3.2.3.3.1.cmml">−</mo><mi id="A1.SS1.p1.7.m7.1.1.3.2.3.3.3" xref="A1.SS1.p1.7.m7.1.1.3.2.3.3.3.cmml">p</mi></mrow></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.7.m7.1b"><apply id="A1.SS1.p1.7.m7.1.1.cmml" xref="A1.SS1.p1.7.m7.1.1"><ci id="A1.SS1.p1.7.m7.1.1.1.cmml" xref="A1.SS1.p1.7.m7.1.1.1">≕</ci><apply id="A1.SS1.p1.7.m7.1.1.2.cmml" xref="A1.SS1.p1.7.m7.1.1.2"><csymbol cd="ambiguous" id="A1.SS1.p1.7.m7.1.1.2.1.cmml" xref="A1.SS1.p1.7.m7.1.1.2">subscript</csymbol><ci id="A1.SS1.p1.7.m7.1.1.2.2.cmml" xref="A1.SS1.p1.7.m7.1.1.2.2">𝛼</ci><ci id="A1.SS1.p1.7.m7.1.1.2.3.cmml" xref="A1.SS1.p1.7.m7.1.1.2.3">𝑘</ci></apply><apply id="A1.SS1.p1.7.m7.1.1.3.cmml" xref="A1.SS1.p1.7.m7.1.1.3"><apply id="A1.SS1.p1.7.m7.1.1.3.1.cmml" xref="A1.SS1.p1.7.m7.1.1.3.1"><csymbol cd="ambiguous" id="A1.SS1.p1.7.m7.1.1.3.1.1.cmml" xref="A1.SS1.p1.7.m7.1.1.3.1">superscript</csymbol><apply id="A1.SS1.p1.7.m7.1.1.3.1.2.cmml" xref="A1.SS1.p1.7.m7.1.1.3.1"><csymbol cd="ambiguous" id="A1.SS1.p1.7.m7.1.1.3.1.2.1.cmml" xref="A1.SS1.p1.7.m7.1.1.3.1">subscript</csymbol><sum id="A1.SS1.p1.7.m7.1.1.3.1.2.2.cmml" xref="A1.SS1.p1.7.m7.1.1.3.1.2.2"></sum><apply id="A1.SS1.p1.7.m7.1.1.3.1.2.3.cmml" xref="A1.SS1.p1.7.m7.1.1.3.1.2.3"><eq id="A1.SS1.p1.7.m7.1.1.3.1.2.3.1.cmml" xref="A1.SS1.p1.7.m7.1.1.3.1.2.3.1"></eq><ci id="A1.SS1.p1.7.m7.1.1.3.1.2.3.2.cmml" xref="A1.SS1.p1.7.m7.1.1.3.1.2.3.2">𝑝</ci><cn id="A1.SS1.p1.7.m7.1.1.3.1.2.3.3.cmml" type="integer" xref="A1.SS1.p1.7.m7.1.1.3.1.2.3.3">0</cn></apply></apply><ci id="A1.SS1.p1.7.m7.1.1.3.1.3.cmml" xref="A1.SS1.p1.7.m7.1.1.3.1.3">𝑘</ci></apply><apply id="A1.SS1.p1.7.m7.1.1.3.2.cmml" xref="A1.SS1.p1.7.m7.1.1.3.2"><times id="A1.SS1.p1.7.m7.1.1.3.2.1.cmml" xref="A1.SS1.p1.7.m7.1.1.3.2.1"></times><apply id="A1.SS1.p1.7.m7.1.1.3.2.2.cmml" xref="A1.SS1.p1.7.m7.1.1.3.2.2"><csymbol cd="ambiguous" id="A1.SS1.p1.7.m7.1.1.3.2.2.1.cmml" xref="A1.SS1.p1.7.m7.1.1.3.2.2">subscript</csymbol><ci id="A1.SS1.p1.7.m7.1.1.3.2.2.2.cmml" xref="A1.SS1.p1.7.m7.1.1.3.2.2.2">𝑓</ci><ci id="A1.SS1.p1.7.m7.1.1.3.2.2.3.cmml" xref="A1.SS1.p1.7.m7.1.1.3.2.2.3">𝑝</ci></apply><apply id="A1.SS1.p1.7.m7.1.1.3.2.3.cmml" xref="A1.SS1.p1.7.m7.1.1.3.2.3"><csymbol cd="ambiguous" id="A1.SS1.p1.7.m7.1.1.3.2.3.1.cmml" xref="A1.SS1.p1.7.m7.1.1.3.2.3">subscript</csymbol><ci id="A1.SS1.p1.7.m7.1.1.3.2.3.2.cmml" xref="A1.SS1.p1.7.m7.1.1.3.2.3.2">𝑓</ci><apply id="A1.SS1.p1.7.m7.1.1.3.2.3.3.cmml" xref="A1.SS1.p1.7.m7.1.1.3.2.3.3"><minus id="A1.SS1.p1.7.m7.1.1.3.2.3.3.1.cmml" xref="A1.SS1.p1.7.m7.1.1.3.2.3.3.1"></minus><ci id="A1.SS1.p1.7.m7.1.1.3.2.3.3.2.cmml" xref="A1.SS1.p1.7.m7.1.1.3.2.3.3.2">𝑘</ci><ci id="A1.SS1.p1.7.m7.1.1.3.2.3.3.3.cmml" xref="A1.SS1.p1.7.m7.1.1.3.2.3.3.3">𝑝</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.7.m7.1c">\alpha_{k}\eqqcolon\sum_{p=0}^{k}f_{p}f_{k-p}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p1.7.m7.1d">italic_α start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ≕ ∑ start_POSTSUBSCRIPT italic_p = 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT italic_f start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT italic_f start_POSTSUBSCRIPT italic_k - italic_p end_POSTSUBSCRIPT</annotation></semantics></math>; step (3) changes the summation indices; step (4) arrives at the desired form.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_subsection" id="A1.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.2 </span>Proof of Thm.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#S3.Thmtheorem1" title="Theorem 3.1 (GRF exponential concentration bounds). ‣ 3.4 Novel theoretical results for GRFs: sharp estimators with sparse features ‣ 3 Towards linear topological masking ‣ Linear Transformer Topological Masking with Graph Random Features"><span class="ltx_text ltx_ref_tag">3.1</span></a> (novel)</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="A1.SS2.p1">
<p class="ltx_p" id="A1.SS2.p1.13">The following concentration bounds are new.
Referring back to Eq.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#S3.E10" title="In 3.3 Faster implicit masking with graph random features ‣ 3 Towards linear topological masking ‣ Linear Transformer Topological Masking with Graph Random Features"><span class="ltx_text ltx_ref_tag">10</span></a>, recall that graph random features are computed by</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equation ltx_eqn_table" id="A1.E14">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\widehat{\phi}_{\mathcal{G}}(v_{i})_{q}\coloneqq\frac{1}{n}\sum_{k=1}^{n}\psi(%
\omega_{k}^{(i)})_{q},\quad q=1,...,N," class="ltx_Math" display="block" id="A1.E14.m1.5"><semantics id="A1.E14.m1.5a"><mrow id="A1.E14.m1.5.5.1"><mrow id="A1.E14.m1.5.5.1.1.2" xref="A1.E14.m1.5.5.1.1.3.cmml"><mrow id="A1.E14.m1.5.5.1.1.1.1" xref="A1.E14.m1.5.5.1.1.1.1.cmml"><mrow id="A1.E14.m1.5.5.1.1.1.1.1" xref="A1.E14.m1.5.5.1.1.1.1.1.cmml"><msub id="A1.E14.m1.5.5.1.1.1.1.1.3" xref="A1.E14.m1.5.5.1.1.1.1.1.3.cmml"><mover accent="true" id="A1.E14.m1.5.5.1.1.1.1.1.3.2" xref="A1.E14.m1.5.5.1.1.1.1.1.3.2.cmml"><mi id="A1.E14.m1.5.5.1.1.1.1.1.3.2.2" xref="A1.E14.m1.5.5.1.1.1.1.1.3.2.2.cmml">ϕ</mi><mo id="A1.E14.m1.5.5.1.1.1.1.1.3.2.1" xref="A1.E14.m1.5.5.1.1.1.1.1.3.2.1.cmml">^</mo></mover><mi class="ltx_font_mathcaligraphic" id="A1.E14.m1.5.5.1.1.1.1.1.3.3" xref="A1.E14.m1.5.5.1.1.1.1.1.3.3.cmml">𝒢</mi></msub><mo id="A1.E14.m1.5.5.1.1.1.1.1.2" xref="A1.E14.m1.5.5.1.1.1.1.1.2.cmml">⁢</mo><msub id="A1.E14.m1.5.5.1.1.1.1.1.1" xref="A1.E14.m1.5.5.1.1.1.1.1.1.cmml"><mrow id="A1.E14.m1.5.5.1.1.1.1.1.1.1.1" xref="A1.E14.m1.5.5.1.1.1.1.1.1.1.1.1.cmml"><mo id="A1.E14.m1.5.5.1.1.1.1.1.1.1.1.2" stretchy="false" xref="A1.E14.m1.5.5.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="A1.E14.m1.5.5.1.1.1.1.1.1.1.1.1" xref="A1.E14.m1.5.5.1.1.1.1.1.1.1.1.1.cmml"><mi id="A1.E14.m1.5.5.1.1.1.1.1.1.1.1.1.2" xref="A1.E14.m1.5.5.1.1.1.1.1.1.1.1.1.2.cmml">v</mi><mi id="A1.E14.m1.5.5.1.1.1.1.1.1.1.1.1.3" xref="A1.E14.m1.5.5.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="A1.E14.m1.5.5.1.1.1.1.1.1.1.1.3" stretchy="false" xref="A1.E14.m1.5.5.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mi id="A1.E14.m1.5.5.1.1.1.1.1.1.3" xref="A1.E14.m1.5.5.1.1.1.1.1.1.3.cmml">q</mi></msub></mrow><mo id="A1.E14.m1.5.5.1.1.1.1.3" xref="A1.E14.m1.5.5.1.1.1.1.3.cmml">≔</mo><mrow id="A1.E14.m1.5.5.1.1.1.1.2" xref="A1.E14.m1.5.5.1.1.1.1.2.cmml"><mfrac id="A1.E14.m1.5.5.1.1.1.1.2.3" xref="A1.E14.m1.5.5.1.1.1.1.2.3.cmml"><mn id="A1.E14.m1.5.5.1.1.1.1.2.3.2" xref="A1.E14.m1.5.5.1.1.1.1.2.3.2.cmml">1</mn><mi id="A1.E14.m1.5.5.1.1.1.1.2.3.3" xref="A1.E14.m1.5.5.1.1.1.1.2.3.3.cmml">n</mi></mfrac><mo id="A1.E14.m1.5.5.1.1.1.1.2.2" xref="A1.E14.m1.5.5.1.1.1.1.2.2.cmml">⁢</mo><mrow id="A1.E14.m1.5.5.1.1.1.1.2.1" xref="A1.E14.m1.5.5.1.1.1.1.2.1.cmml"><munderover id="A1.E14.m1.5.5.1.1.1.1.2.1.2" xref="A1.E14.m1.5.5.1.1.1.1.2.1.2.cmml"><mo id="A1.E14.m1.5.5.1.1.1.1.2.1.2.2.2" movablelimits="false" xref="A1.E14.m1.5.5.1.1.1.1.2.1.2.2.2.cmml">∑</mo><mrow id="A1.E14.m1.5.5.1.1.1.1.2.1.2.2.3" xref="A1.E14.m1.5.5.1.1.1.1.2.1.2.2.3.cmml"><mi id="A1.E14.m1.5.5.1.1.1.1.2.1.2.2.3.2" xref="A1.E14.m1.5.5.1.1.1.1.2.1.2.2.3.2.cmml">k</mi><mo id="A1.E14.m1.5.5.1.1.1.1.2.1.2.2.3.1" xref="A1.E14.m1.5.5.1.1.1.1.2.1.2.2.3.1.cmml">=</mo><mn id="A1.E14.m1.5.5.1.1.1.1.2.1.2.2.3.3" xref="A1.E14.m1.5.5.1.1.1.1.2.1.2.2.3.3.cmml">1</mn></mrow><mi id="A1.E14.m1.5.5.1.1.1.1.2.1.2.3" xref="A1.E14.m1.5.5.1.1.1.1.2.1.2.3.cmml">n</mi></munderover><mrow id="A1.E14.m1.5.5.1.1.1.1.2.1.1" xref="A1.E14.m1.5.5.1.1.1.1.2.1.1.cmml"><mi id="A1.E14.m1.5.5.1.1.1.1.2.1.1.3" xref="A1.E14.m1.5.5.1.1.1.1.2.1.1.3.cmml">ψ</mi><mo id="A1.E14.m1.5.5.1.1.1.1.2.1.1.2" xref="A1.E14.m1.5.5.1.1.1.1.2.1.1.2.cmml">⁢</mo><msub id="A1.E14.m1.5.5.1.1.1.1.2.1.1.1" xref="A1.E14.m1.5.5.1.1.1.1.2.1.1.1.cmml"><mrow id="A1.E14.m1.5.5.1.1.1.1.2.1.1.1.1.1" xref="A1.E14.m1.5.5.1.1.1.1.2.1.1.1.1.1.1.cmml"><mo id="A1.E14.m1.5.5.1.1.1.1.2.1.1.1.1.1.2" stretchy="false" xref="A1.E14.m1.5.5.1.1.1.1.2.1.1.1.1.1.1.cmml">(</mo><msubsup id="A1.E14.m1.5.5.1.1.1.1.2.1.1.1.1.1.1" xref="A1.E14.m1.5.5.1.1.1.1.2.1.1.1.1.1.1.cmml"><mi id="A1.E14.m1.5.5.1.1.1.1.2.1.1.1.1.1.1.2.2" xref="A1.E14.m1.5.5.1.1.1.1.2.1.1.1.1.1.1.2.2.cmml">ω</mi><mi id="A1.E14.m1.5.5.1.1.1.1.2.1.1.1.1.1.1.2.3" xref="A1.E14.m1.5.5.1.1.1.1.2.1.1.1.1.1.1.2.3.cmml">k</mi><mrow id="A1.E14.m1.1.1.1.3" xref="A1.E14.m1.5.5.1.1.1.1.2.1.1.1.1.1.1.cmml"><mo id="A1.E14.m1.1.1.1.3.1" stretchy="false" xref="A1.E14.m1.5.5.1.1.1.1.2.1.1.1.1.1.1.cmml">(</mo><mi id="A1.E14.m1.1.1.1.1" xref="A1.E14.m1.1.1.1.1.cmml">i</mi><mo id="A1.E14.m1.1.1.1.3.2" stretchy="false" xref="A1.E14.m1.5.5.1.1.1.1.2.1.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="A1.E14.m1.5.5.1.1.1.1.2.1.1.1.1.1.3" stretchy="false" xref="A1.E14.m1.5.5.1.1.1.1.2.1.1.1.1.1.1.cmml">)</mo></mrow><mi id="A1.E14.m1.5.5.1.1.1.1.2.1.1.1.3" xref="A1.E14.m1.5.5.1.1.1.1.2.1.1.1.3.cmml">q</mi></msub></mrow></mrow></mrow></mrow><mo id="A1.E14.m1.5.5.1.1.2.3" rspace="1.167em" xref="A1.E14.m1.5.5.1.1.3a.cmml">,</mo><mrow id="A1.E14.m1.5.5.1.1.2.2" xref="A1.E14.m1.5.5.1.1.2.2.cmml"><mi id="A1.E14.m1.5.5.1.1.2.2.2" xref="A1.E14.m1.5.5.1.1.2.2.2.cmml">q</mi><mo id="A1.E14.m1.5.5.1.1.2.2.1" xref="A1.E14.m1.5.5.1.1.2.2.1.cmml">=</mo><mrow id="A1.E14.m1.5.5.1.1.2.2.3.2" xref="A1.E14.m1.5.5.1.1.2.2.3.1.cmml"><mn id="A1.E14.m1.2.2" xref="A1.E14.m1.2.2.cmml">1</mn><mo id="A1.E14.m1.5.5.1.1.2.2.3.2.1" xref="A1.E14.m1.5.5.1.1.2.2.3.1.cmml">,</mo><mi id="A1.E14.m1.3.3" mathvariant="normal" xref="A1.E14.m1.3.3.cmml">…</mi><mo id="A1.E14.m1.5.5.1.1.2.2.3.2.2" xref="A1.E14.m1.5.5.1.1.2.2.3.1.cmml">,</mo><mi id="A1.E14.m1.4.4" xref="A1.E14.m1.4.4.cmml">N</mi></mrow></mrow></mrow><mo id="A1.E14.m1.5.5.1.2">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.E14.m1.5b"><apply id="A1.E14.m1.5.5.1.1.3.cmml" xref="A1.E14.m1.5.5.1.1.2"><csymbol cd="ambiguous" id="A1.E14.m1.5.5.1.1.3a.cmml" xref="A1.E14.m1.5.5.1.1.2.3">formulae-sequence</csymbol><apply id="A1.E14.m1.5.5.1.1.1.1.cmml" xref="A1.E14.m1.5.5.1.1.1.1"><ci id="A1.E14.m1.5.5.1.1.1.1.3.cmml" xref="A1.E14.m1.5.5.1.1.1.1.3">≔</ci><apply id="A1.E14.m1.5.5.1.1.1.1.1.cmml" xref="A1.E14.m1.5.5.1.1.1.1.1"><times id="A1.E14.m1.5.5.1.1.1.1.1.2.cmml" xref="A1.E14.m1.5.5.1.1.1.1.1.2"></times><apply id="A1.E14.m1.5.5.1.1.1.1.1.3.cmml" xref="A1.E14.m1.5.5.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.E14.m1.5.5.1.1.1.1.1.3.1.cmml" xref="A1.E14.m1.5.5.1.1.1.1.1.3">subscript</csymbol><apply id="A1.E14.m1.5.5.1.1.1.1.1.3.2.cmml" xref="A1.E14.m1.5.5.1.1.1.1.1.3.2"><ci id="A1.E14.m1.5.5.1.1.1.1.1.3.2.1.cmml" xref="A1.E14.m1.5.5.1.1.1.1.1.3.2.1">^</ci><ci id="A1.E14.m1.5.5.1.1.1.1.1.3.2.2.cmml" xref="A1.E14.m1.5.5.1.1.1.1.1.3.2.2">italic-ϕ</ci></apply><ci id="A1.E14.m1.5.5.1.1.1.1.1.3.3.cmml" xref="A1.E14.m1.5.5.1.1.1.1.1.3.3">𝒢</ci></apply><apply id="A1.E14.m1.5.5.1.1.1.1.1.1.cmml" xref="A1.E14.m1.5.5.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E14.m1.5.5.1.1.1.1.1.1.2.cmml" xref="A1.E14.m1.5.5.1.1.1.1.1.1">subscript</csymbol><apply id="A1.E14.m1.5.5.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E14.m1.5.5.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E14.m1.5.5.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E14.m1.5.5.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.E14.m1.5.5.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E14.m1.5.5.1.1.1.1.1.1.1.1.1.2">𝑣</ci><ci id="A1.E14.m1.5.5.1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.E14.m1.5.5.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><ci id="A1.E14.m1.5.5.1.1.1.1.1.1.3.cmml" xref="A1.E14.m1.5.5.1.1.1.1.1.1.3">𝑞</ci></apply></apply><apply id="A1.E14.m1.5.5.1.1.1.1.2.cmml" xref="A1.E14.m1.5.5.1.1.1.1.2"><times id="A1.E14.m1.5.5.1.1.1.1.2.2.cmml" xref="A1.E14.m1.5.5.1.1.1.1.2.2"></times><apply id="A1.E14.m1.5.5.1.1.1.1.2.3.cmml" xref="A1.E14.m1.5.5.1.1.1.1.2.3"><divide id="A1.E14.m1.5.5.1.1.1.1.2.3.1.cmml" xref="A1.E14.m1.5.5.1.1.1.1.2.3"></divide><cn id="A1.E14.m1.5.5.1.1.1.1.2.3.2.cmml" type="integer" xref="A1.E14.m1.5.5.1.1.1.1.2.3.2">1</cn><ci id="A1.E14.m1.5.5.1.1.1.1.2.3.3.cmml" xref="A1.E14.m1.5.5.1.1.1.1.2.3.3">𝑛</ci></apply><apply id="A1.E14.m1.5.5.1.1.1.1.2.1.cmml" xref="A1.E14.m1.5.5.1.1.1.1.2.1"><apply id="A1.E14.m1.5.5.1.1.1.1.2.1.2.cmml" xref="A1.E14.m1.5.5.1.1.1.1.2.1.2"><csymbol cd="ambiguous" id="A1.E14.m1.5.5.1.1.1.1.2.1.2.1.cmml" xref="A1.E14.m1.5.5.1.1.1.1.2.1.2">superscript</csymbol><apply id="A1.E14.m1.5.5.1.1.1.1.2.1.2.2.cmml" xref="A1.E14.m1.5.5.1.1.1.1.2.1.2"><csymbol cd="ambiguous" id="A1.E14.m1.5.5.1.1.1.1.2.1.2.2.1.cmml" xref="A1.E14.m1.5.5.1.1.1.1.2.1.2">subscript</csymbol><sum id="A1.E14.m1.5.5.1.1.1.1.2.1.2.2.2.cmml" xref="A1.E14.m1.5.5.1.1.1.1.2.1.2.2.2"></sum><apply id="A1.E14.m1.5.5.1.1.1.1.2.1.2.2.3.cmml" xref="A1.E14.m1.5.5.1.1.1.1.2.1.2.2.3"><eq id="A1.E14.m1.5.5.1.1.1.1.2.1.2.2.3.1.cmml" xref="A1.E14.m1.5.5.1.1.1.1.2.1.2.2.3.1"></eq><ci id="A1.E14.m1.5.5.1.1.1.1.2.1.2.2.3.2.cmml" xref="A1.E14.m1.5.5.1.1.1.1.2.1.2.2.3.2">𝑘</ci><cn id="A1.E14.m1.5.5.1.1.1.1.2.1.2.2.3.3.cmml" type="integer" xref="A1.E14.m1.5.5.1.1.1.1.2.1.2.2.3.3">1</cn></apply></apply><ci id="A1.E14.m1.5.5.1.1.1.1.2.1.2.3.cmml" xref="A1.E14.m1.5.5.1.1.1.1.2.1.2.3">𝑛</ci></apply><apply id="A1.E14.m1.5.5.1.1.1.1.2.1.1.cmml" xref="A1.E14.m1.5.5.1.1.1.1.2.1.1"><times id="A1.E14.m1.5.5.1.1.1.1.2.1.1.2.cmml" xref="A1.E14.m1.5.5.1.1.1.1.2.1.1.2"></times><ci id="A1.E14.m1.5.5.1.1.1.1.2.1.1.3.cmml" xref="A1.E14.m1.5.5.1.1.1.1.2.1.1.3">𝜓</ci><apply id="A1.E14.m1.5.5.1.1.1.1.2.1.1.1.cmml" xref="A1.E14.m1.5.5.1.1.1.1.2.1.1.1"><csymbol cd="ambiguous" id="A1.E14.m1.5.5.1.1.1.1.2.1.1.1.2.cmml" xref="A1.E14.m1.5.5.1.1.1.1.2.1.1.1">subscript</csymbol><apply id="A1.E14.m1.5.5.1.1.1.1.2.1.1.1.1.1.1.cmml" xref="A1.E14.m1.5.5.1.1.1.1.2.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E14.m1.5.5.1.1.1.1.2.1.1.1.1.1.1.1.cmml" xref="A1.E14.m1.5.5.1.1.1.1.2.1.1.1.1.1">superscript</csymbol><apply id="A1.E14.m1.5.5.1.1.1.1.2.1.1.1.1.1.1.2.cmml" xref="A1.E14.m1.5.5.1.1.1.1.2.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E14.m1.5.5.1.1.1.1.2.1.1.1.1.1.1.2.1.cmml" xref="A1.E14.m1.5.5.1.1.1.1.2.1.1.1.1.1">subscript</csymbol><ci id="A1.E14.m1.5.5.1.1.1.1.2.1.1.1.1.1.1.2.2.cmml" xref="A1.E14.m1.5.5.1.1.1.1.2.1.1.1.1.1.1.2.2">𝜔</ci><ci id="A1.E14.m1.5.5.1.1.1.1.2.1.1.1.1.1.1.2.3.cmml" xref="A1.E14.m1.5.5.1.1.1.1.2.1.1.1.1.1.1.2.3">𝑘</ci></apply><ci id="A1.E14.m1.1.1.1.1.cmml" xref="A1.E14.m1.1.1.1.1">𝑖</ci></apply><ci id="A1.E14.m1.5.5.1.1.1.1.2.1.1.1.3.cmml" xref="A1.E14.m1.5.5.1.1.1.1.2.1.1.1.3">𝑞</ci></apply></apply></apply></apply></apply><apply id="A1.E14.m1.5.5.1.1.2.2.cmml" xref="A1.E14.m1.5.5.1.1.2.2"><eq id="A1.E14.m1.5.5.1.1.2.2.1.cmml" xref="A1.E14.m1.5.5.1.1.2.2.1"></eq><ci id="A1.E14.m1.5.5.1.1.2.2.2.cmml" xref="A1.E14.m1.5.5.1.1.2.2.2">𝑞</ci><list id="A1.E14.m1.5.5.1.1.2.2.3.1.cmml" xref="A1.E14.m1.5.5.1.1.2.2.3.2"><cn id="A1.E14.m1.2.2.cmml" type="integer" xref="A1.E14.m1.2.2">1</cn><ci id="A1.E14.m1.3.3.cmml" xref="A1.E14.m1.3.3">…</ci><ci id="A1.E14.m1.4.4.cmml" xref="A1.E14.m1.4.4">𝑁</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E14.m1.5c">\widehat{\phi}_{\mathcal{G}}(v_{i})_{q}\coloneqq\frac{1}{n}\sum_{k=1}^{n}\psi(%
\omega_{k}^{(i)})_{q},\quad q=1,...,N,</annotation><annotation encoding="application/x-llamapun" id="A1.E14.m1.5d">over^ start_ARG italic_ϕ end_ARG start_POSTSUBSCRIPT caligraphic_G end_POSTSUBSCRIPT ( italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT ≔ divide start_ARG 1 end_ARG start_ARG italic_n end_ARG ∑ start_POSTSUBSCRIPT italic_k = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT italic_ψ ( italic_ω start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT ) start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT , italic_q = 1 , … , italic_N ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(14)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A1.SS2.p1.1">where we define the <em class="ltx_emph ltx_font_italic" id="A1.SS2.p1.1.1">projection vector</em> <math alttext="\psi(\cdot):\Omega\to\mathbb{R}^{N}" class="ltx_Math" display="inline" id="A1.SS2.p1.1.m1.1"><semantics id="A1.SS2.p1.1.m1.1a"><mrow id="A1.SS2.p1.1.m1.1.2" xref="A1.SS2.p1.1.m1.1.2.cmml"><mrow id="A1.SS2.p1.1.m1.1.2.2" xref="A1.SS2.p1.1.m1.1.2.2.cmml"><mi id="A1.SS2.p1.1.m1.1.2.2.2" xref="A1.SS2.p1.1.m1.1.2.2.2.cmml">ψ</mi><mo id="A1.SS2.p1.1.m1.1.2.2.1" xref="A1.SS2.p1.1.m1.1.2.2.1.cmml">⁢</mo><mrow id="A1.SS2.p1.1.m1.1.2.2.3.2" xref="A1.SS2.p1.1.m1.1.2.2.cmml"><mo id="A1.SS2.p1.1.m1.1.2.2.3.2.1" stretchy="false" xref="A1.SS2.p1.1.m1.1.2.2.cmml">(</mo><mo id="A1.SS2.p1.1.m1.1.1" lspace="0em" rspace="0em" xref="A1.SS2.p1.1.m1.1.1.cmml">⋅</mo><mo id="A1.SS2.p1.1.m1.1.2.2.3.2.2" rspace="0.278em" stretchy="false" xref="A1.SS2.p1.1.m1.1.2.2.cmml">)</mo></mrow></mrow><mo id="A1.SS2.p1.1.m1.1.2.1" rspace="0.278em" xref="A1.SS2.p1.1.m1.1.2.1.cmml">:</mo><mrow id="A1.SS2.p1.1.m1.1.2.3" xref="A1.SS2.p1.1.m1.1.2.3.cmml"><mi id="A1.SS2.p1.1.m1.1.2.3.2" mathvariant="normal" xref="A1.SS2.p1.1.m1.1.2.3.2.cmml">Ω</mi><mo id="A1.SS2.p1.1.m1.1.2.3.1" stretchy="false" xref="A1.SS2.p1.1.m1.1.2.3.1.cmml">→</mo><msup id="A1.SS2.p1.1.m1.1.2.3.3" xref="A1.SS2.p1.1.m1.1.2.3.3.cmml"><mi id="A1.SS2.p1.1.m1.1.2.3.3.2" xref="A1.SS2.p1.1.m1.1.2.3.3.2.cmml">ℝ</mi><mi id="A1.SS2.p1.1.m1.1.2.3.3.3" xref="A1.SS2.p1.1.m1.1.2.3.3.3.cmml">N</mi></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p1.1.m1.1b"><apply id="A1.SS2.p1.1.m1.1.2.cmml" xref="A1.SS2.p1.1.m1.1.2"><ci id="A1.SS2.p1.1.m1.1.2.1.cmml" xref="A1.SS2.p1.1.m1.1.2.1">:</ci><apply id="A1.SS2.p1.1.m1.1.2.2.cmml" xref="A1.SS2.p1.1.m1.1.2.2"><times id="A1.SS2.p1.1.m1.1.2.2.1.cmml" xref="A1.SS2.p1.1.m1.1.2.2.1"></times><ci id="A1.SS2.p1.1.m1.1.2.2.2.cmml" xref="A1.SS2.p1.1.m1.1.2.2.2">𝜓</ci><ci id="A1.SS2.p1.1.m1.1.1.cmml" xref="A1.SS2.p1.1.m1.1.1">⋅</ci></apply><apply id="A1.SS2.p1.1.m1.1.2.3.cmml" xref="A1.SS2.p1.1.m1.1.2.3"><ci id="A1.SS2.p1.1.m1.1.2.3.1.cmml" xref="A1.SS2.p1.1.m1.1.2.3.1">→</ci><ci id="A1.SS2.p1.1.m1.1.2.3.2.cmml" xref="A1.SS2.p1.1.m1.1.2.3.2">Ω</ci><apply id="A1.SS2.p1.1.m1.1.2.3.3.cmml" xref="A1.SS2.p1.1.m1.1.2.3.3"><csymbol cd="ambiguous" id="A1.SS2.p1.1.m1.1.2.3.3.1.cmml" xref="A1.SS2.p1.1.m1.1.2.3.3">superscript</csymbol><ci id="A1.SS2.p1.1.m1.1.2.3.3.2.cmml" xref="A1.SS2.p1.1.m1.1.2.3.3.2">ℝ</ci><ci id="A1.SS2.p1.1.m1.1.2.3.3.3.cmml" xref="A1.SS2.p1.1.m1.1.2.3.3.3">𝑁</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p1.1.m1.1c">\psi(\cdot):\Omega\to\mathbb{R}^{N}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p1.1.m1.1d">italic_ψ ( ⋅ ) : roman_Ω → blackboard_R start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT</annotation></semantics></math> such that</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equation ltx_eqn_table" id="A1.E15">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\psi(\omega_{k}^{(i)})_{q}\coloneqq\sum_{\omega_{iq}\in\Omega_{iq}}\frac{%
\widetilde{\omega}(\omega_{iq})f_{\textrm{len}(\omega_{iq})}}{p(\omega_{iq})}%
\mathbb{I}(\omega_{iq}\textrm{ prefix subwalk of }\omega_{k}^{(i)})." class="ltx_Math" display="block" id="A1.E15.m1.6"><semantics id="A1.E15.m1.6a"><mrow id="A1.E15.m1.6.6.1" xref="A1.E15.m1.6.6.1.1.cmml"><mrow id="A1.E15.m1.6.6.1.1" xref="A1.E15.m1.6.6.1.1.cmml"><mrow id="A1.E15.m1.6.6.1.1.1" xref="A1.E15.m1.6.6.1.1.1.cmml"><mi id="A1.E15.m1.6.6.1.1.1.3" xref="A1.E15.m1.6.6.1.1.1.3.cmml">ψ</mi><mo id="A1.E15.m1.6.6.1.1.1.2" xref="A1.E15.m1.6.6.1.1.1.2.cmml">⁢</mo><msub id="A1.E15.m1.6.6.1.1.1.1" xref="A1.E15.m1.6.6.1.1.1.1.cmml"><mrow id="A1.E15.m1.6.6.1.1.1.1.1.1" xref="A1.E15.m1.6.6.1.1.1.1.1.1.1.cmml"><mo id="A1.E15.m1.6.6.1.1.1.1.1.1.2" stretchy="false" xref="A1.E15.m1.6.6.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="A1.E15.m1.6.6.1.1.1.1.1.1.1" xref="A1.E15.m1.6.6.1.1.1.1.1.1.1.cmml"><mi id="A1.E15.m1.6.6.1.1.1.1.1.1.1.2.2" xref="A1.E15.m1.6.6.1.1.1.1.1.1.1.2.2.cmml">ω</mi><mi id="A1.E15.m1.6.6.1.1.1.1.1.1.1.2.3" xref="A1.E15.m1.6.6.1.1.1.1.1.1.1.2.3.cmml">k</mi><mrow id="A1.E15.m1.1.1.1.3" xref="A1.E15.m1.6.6.1.1.1.1.1.1.1.cmml"><mo id="A1.E15.m1.1.1.1.3.1" stretchy="false" xref="A1.E15.m1.6.6.1.1.1.1.1.1.1.cmml">(</mo><mi id="A1.E15.m1.1.1.1.1" xref="A1.E15.m1.1.1.1.1.cmml">i</mi><mo id="A1.E15.m1.1.1.1.3.2" stretchy="false" xref="A1.E15.m1.6.6.1.1.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="A1.E15.m1.6.6.1.1.1.1.1.1.3" stretchy="false" xref="A1.E15.m1.6.6.1.1.1.1.1.1.1.cmml">)</mo></mrow><mi id="A1.E15.m1.6.6.1.1.1.1.3" xref="A1.E15.m1.6.6.1.1.1.1.3.cmml">q</mi></msub></mrow><mo id="A1.E15.m1.6.6.1.1.3" rspace="0.111em" xref="A1.E15.m1.6.6.1.1.3.cmml">≔</mo><mrow id="A1.E15.m1.6.6.1.1.2" xref="A1.E15.m1.6.6.1.1.2.cmml"><munder id="A1.E15.m1.6.6.1.1.2.2" xref="A1.E15.m1.6.6.1.1.2.2.cmml"><mo id="A1.E15.m1.6.6.1.1.2.2.2" movablelimits="false" xref="A1.E15.m1.6.6.1.1.2.2.2.cmml">∑</mo><mrow id="A1.E15.m1.6.6.1.1.2.2.3" xref="A1.E15.m1.6.6.1.1.2.2.3.cmml"><msub id="A1.E15.m1.6.6.1.1.2.2.3.2" xref="A1.E15.m1.6.6.1.1.2.2.3.2.cmml"><mi id="A1.E15.m1.6.6.1.1.2.2.3.2.2" xref="A1.E15.m1.6.6.1.1.2.2.3.2.2.cmml">ω</mi><mrow id="A1.E15.m1.6.6.1.1.2.2.3.2.3" xref="A1.E15.m1.6.6.1.1.2.2.3.2.3.cmml"><mi id="A1.E15.m1.6.6.1.1.2.2.3.2.3.2" xref="A1.E15.m1.6.6.1.1.2.2.3.2.3.2.cmml">i</mi><mo id="A1.E15.m1.6.6.1.1.2.2.3.2.3.1" xref="A1.E15.m1.6.6.1.1.2.2.3.2.3.1.cmml">⁢</mo><mi id="A1.E15.m1.6.6.1.1.2.2.3.2.3.3" xref="A1.E15.m1.6.6.1.1.2.2.3.2.3.3.cmml">q</mi></mrow></msub><mo id="A1.E15.m1.6.6.1.1.2.2.3.1" xref="A1.E15.m1.6.6.1.1.2.2.3.1.cmml">∈</mo><msub id="A1.E15.m1.6.6.1.1.2.2.3.3" xref="A1.E15.m1.6.6.1.1.2.2.3.3.cmml"><mi id="A1.E15.m1.6.6.1.1.2.2.3.3.2" mathvariant="normal" xref="A1.E15.m1.6.6.1.1.2.2.3.3.2.cmml">Ω</mi><mrow id="A1.E15.m1.6.6.1.1.2.2.3.3.3" xref="A1.E15.m1.6.6.1.1.2.2.3.3.3.cmml"><mi id="A1.E15.m1.6.6.1.1.2.2.3.3.3.2" xref="A1.E15.m1.6.6.1.1.2.2.3.3.3.2.cmml">i</mi><mo id="A1.E15.m1.6.6.1.1.2.2.3.3.3.1" xref="A1.E15.m1.6.6.1.1.2.2.3.3.3.1.cmml">⁢</mo><mi id="A1.E15.m1.6.6.1.1.2.2.3.3.3.3" xref="A1.E15.m1.6.6.1.1.2.2.3.3.3.3.cmml">q</mi></mrow></msub></mrow></munder><mrow id="A1.E15.m1.6.6.1.1.2.1" xref="A1.E15.m1.6.6.1.1.2.1.cmml"><mfrac id="A1.E15.m1.4.4" xref="A1.E15.m1.4.4.cmml"><mrow id="A1.E15.m1.3.3.2" xref="A1.E15.m1.3.3.2.cmml"><mover accent="true" id="A1.E15.m1.3.3.2.4" xref="A1.E15.m1.3.3.2.4.cmml"><mi id="A1.E15.m1.3.3.2.4.2" xref="A1.E15.m1.3.3.2.4.2.cmml">ω</mi><mo id="A1.E15.m1.3.3.2.4.1" xref="A1.E15.m1.3.3.2.4.1.cmml">~</mo></mover><mo id="A1.E15.m1.3.3.2.3" xref="A1.E15.m1.3.3.2.3.cmml">⁢</mo><mrow id="A1.E15.m1.3.3.2.2.1" xref="A1.E15.m1.3.3.2.2.1.1.cmml"><mo id="A1.E15.m1.3.3.2.2.1.2" stretchy="false" xref="A1.E15.m1.3.3.2.2.1.1.cmml">(</mo><msub id="A1.E15.m1.3.3.2.2.1.1" xref="A1.E15.m1.3.3.2.2.1.1.cmml"><mi id="A1.E15.m1.3.3.2.2.1.1.2" xref="A1.E15.m1.3.3.2.2.1.1.2.cmml">ω</mi><mrow id="A1.E15.m1.3.3.2.2.1.1.3" xref="A1.E15.m1.3.3.2.2.1.1.3.cmml"><mi id="A1.E15.m1.3.3.2.2.1.1.3.2" xref="A1.E15.m1.3.3.2.2.1.1.3.2.cmml">i</mi><mo id="A1.E15.m1.3.3.2.2.1.1.3.1" xref="A1.E15.m1.3.3.2.2.1.1.3.1.cmml">⁢</mo><mi id="A1.E15.m1.3.3.2.2.1.1.3.3" xref="A1.E15.m1.3.3.2.2.1.1.3.3.cmml">q</mi></mrow></msub><mo id="A1.E15.m1.3.3.2.2.1.3" stretchy="false" xref="A1.E15.m1.3.3.2.2.1.1.cmml">)</mo></mrow><mo id="A1.E15.m1.3.3.2.3a" xref="A1.E15.m1.3.3.2.3.cmml">⁢</mo><msub id="A1.E15.m1.3.3.2.5" xref="A1.E15.m1.3.3.2.5.cmml"><mi id="A1.E15.m1.3.3.2.5.2" xref="A1.E15.m1.3.3.2.5.2.cmml">f</mi><mrow id="A1.E15.m1.2.2.1.1.1" xref="A1.E15.m1.2.2.1.1.1.cmml"><mtext id="A1.E15.m1.2.2.1.1.1.3" xref="A1.E15.m1.2.2.1.1.1.3a.cmml">len</mtext><mo id="A1.E15.m1.2.2.1.1.1.2" xref="A1.E15.m1.2.2.1.1.1.2.cmml">⁢</mo><mrow id="A1.E15.m1.2.2.1.1.1.1.1" xref="A1.E15.m1.2.2.1.1.1.1.1.1.cmml"><mo id="A1.E15.m1.2.2.1.1.1.1.1.2" stretchy="false" xref="A1.E15.m1.2.2.1.1.1.1.1.1.cmml">(</mo><msub id="A1.E15.m1.2.2.1.1.1.1.1.1" xref="A1.E15.m1.2.2.1.1.1.1.1.1.cmml"><mi id="A1.E15.m1.2.2.1.1.1.1.1.1.2" xref="A1.E15.m1.2.2.1.1.1.1.1.1.2.cmml">ω</mi><mrow id="A1.E15.m1.2.2.1.1.1.1.1.1.3" xref="A1.E15.m1.2.2.1.1.1.1.1.1.3.cmml"><mi id="A1.E15.m1.2.2.1.1.1.1.1.1.3.2" xref="A1.E15.m1.2.2.1.1.1.1.1.1.3.2.cmml">i</mi><mo id="A1.E15.m1.2.2.1.1.1.1.1.1.3.1" xref="A1.E15.m1.2.2.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="A1.E15.m1.2.2.1.1.1.1.1.1.3.3" xref="A1.E15.m1.2.2.1.1.1.1.1.1.3.3.cmml">q</mi></mrow></msub><mo id="A1.E15.m1.2.2.1.1.1.1.1.3" stretchy="false" xref="A1.E15.m1.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></msub></mrow><mrow id="A1.E15.m1.4.4.3" xref="A1.E15.m1.4.4.3.cmml"><mi id="A1.E15.m1.4.4.3.3" xref="A1.E15.m1.4.4.3.3.cmml">p</mi><mo id="A1.E15.m1.4.4.3.2" xref="A1.E15.m1.4.4.3.2.cmml">⁢</mo><mrow id="A1.E15.m1.4.4.3.1.1" xref="A1.E15.m1.4.4.3.1.1.1.cmml"><mo id="A1.E15.m1.4.4.3.1.1.2" stretchy="false" xref="A1.E15.m1.4.4.3.1.1.1.cmml">(</mo><msub id="A1.E15.m1.4.4.3.1.1.1" xref="A1.E15.m1.4.4.3.1.1.1.cmml"><mi id="A1.E15.m1.4.4.3.1.1.1.2" xref="A1.E15.m1.4.4.3.1.1.1.2.cmml">ω</mi><mrow id="A1.E15.m1.4.4.3.1.1.1.3" xref="A1.E15.m1.4.4.3.1.1.1.3.cmml"><mi id="A1.E15.m1.4.4.3.1.1.1.3.2" xref="A1.E15.m1.4.4.3.1.1.1.3.2.cmml">i</mi><mo id="A1.E15.m1.4.4.3.1.1.1.3.1" xref="A1.E15.m1.4.4.3.1.1.1.3.1.cmml">⁢</mo><mi id="A1.E15.m1.4.4.3.1.1.1.3.3" xref="A1.E15.m1.4.4.3.1.1.1.3.3.cmml">q</mi></mrow></msub><mo id="A1.E15.m1.4.4.3.1.1.3" stretchy="false" xref="A1.E15.m1.4.4.3.1.1.1.cmml">)</mo></mrow></mrow></mfrac><mo id="A1.E15.m1.6.6.1.1.2.1.2" xref="A1.E15.m1.6.6.1.1.2.1.2.cmml">⁢</mo><mi id="A1.E15.m1.6.6.1.1.2.1.3" xref="A1.E15.m1.6.6.1.1.2.1.3.cmml">𝕀</mi><mo id="A1.E15.m1.6.6.1.1.2.1.2a" xref="A1.E15.m1.6.6.1.1.2.1.2.cmml">⁢</mo><mrow id="A1.E15.m1.6.6.1.1.2.1.1.1" xref="A1.E15.m1.6.6.1.1.2.1.1.1.1.cmml"><mo id="A1.E15.m1.6.6.1.1.2.1.1.1.2" stretchy="false" xref="A1.E15.m1.6.6.1.1.2.1.1.1.1.cmml">(</mo><mrow id="A1.E15.m1.6.6.1.1.2.1.1.1.1" xref="A1.E15.m1.6.6.1.1.2.1.1.1.1.cmml"><msub id="A1.E15.m1.6.6.1.1.2.1.1.1.1.2" xref="A1.E15.m1.6.6.1.1.2.1.1.1.1.2.cmml"><mi id="A1.E15.m1.6.6.1.1.2.1.1.1.1.2.2" xref="A1.E15.m1.6.6.1.1.2.1.1.1.1.2.2.cmml">ω</mi><mrow id="A1.E15.m1.6.6.1.1.2.1.1.1.1.2.3" xref="A1.E15.m1.6.6.1.1.2.1.1.1.1.2.3.cmml"><mi id="A1.E15.m1.6.6.1.1.2.1.1.1.1.2.3.2" xref="A1.E15.m1.6.6.1.1.2.1.1.1.1.2.3.2.cmml">i</mi><mo id="A1.E15.m1.6.6.1.1.2.1.1.1.1.2.3.1" xref="A1.E15.m1.6.6.1.1.2.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="A1.E15.m1.6.6.1.1.2.1.1.1.1.2.3.3" xref="A1.E15.m1.6.6.1.1.2.1.1.1.1.2.3.3.cmml">q</mi></mrow></msub><mo id="A1.E15.m1.6.6.1.1.2.1.1.1.1.1" xref="A1.E15.m1.6.6.1.1.2.1.1.1.1.1.cmml">⁢</mo><mtext id="A1.E15.m1.6.6.1.1.2.1.1.1.1.3" xref="A1.E15.m1.6.6.1.1.2.1.1.1.1.3a.cmml">&nbsp;prefix subwalk of&nbsp;</mtext><mo id="A1.E15.m1.6.6.1.1.2.1.1.1.1.1a" xref="A1.E15.m1.6.6.1.1.2.1.1.1.1.1.cmml">⁢</mo><msubsup id="A1.E15.m1.6.6.1.1.2.1.1.1.1.4" xref="A1.E15.m1.6.6.1.1.2.1.1.1.1.4.cmml"><mi id="A1.E15.m1.6.6.1.1.2.1.1.1.1.4.2.2" xref="A1.E15.m1.6.6.1.1.2.1.1.1.1.4.2.2.cmml">ω</mi><mi id="A1.E15.m1.6.6.1.1.2.1.1.1.1.4.2.3" xref="A1.E15.m1.6.6.1.1.2.1.1.1.1.4.2.3.cmml">k</mi><mrow id="A1.E15.m1.5.5.1.3" xref="A1.E15.m1.6.6.1.1.2.1.1.1.1.4.cmml"><mo id="A1.E15.m1.5.5.1.3.1" stretchy="false" xref="A1.E15.m1.6.6.1.1.2.1.1.1.1.4.cmml">(</mo><mi id="A1.E15.m1.5.5.1.1" xref="A1.E15.m1.5.5.1.1.cmml">i</mi><mo id="A1.E15.m1.5.5.1.3.2" stretchy="false" xref="A1.E15.m1.6.6.1.1.2.1.1.1.1.4.cmml">)</mo></mrow></msubsup></mrow><mo id="A1.E15.m1.6.6.1.1.2.1.1.1.3" stretchy="false" xref="A1.E15.m1.6.6.1.1.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="A1.E15.m1.6.6.1.2" lspace="0em" xref="A1.E15.m1.6.6.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.E15.m1.6b"><apply id="A1.E15.m1.6.6.1.1.cmml" xref="A1.E15.m1.6.6.1"><ci id="A1.E15.m1.6.6.1.1.3.cmml" xref="A1.E15.m1.6.6.1.1.3">≔</ci><apply id="A1.E15.m1.6.6.1.1.1.cmml" xref="A1.E15.m1.6.6.1.1.1"><times id="A1.E15.m1.6.6.1.1.1.2.cmml" xref="A1.E15.m1.6.6.1.1.1.2"></times><ci id="A1.E15.m1.6.6.1.1.1.3.cmml" xref="A1.E15.m1.6.6.1.1.1.3">𝜓</ci><apply id="A1.E15.m1.6.6.1.1.1.1.cmml" xref="A1.E15.m1.6.6.1.1.1.1"><csymbol cd="ambiguous" id="A1.E15.m1.6.6.1.1.1.1.2.cmml" xref="A1.E15.m1.6.6.1.1.1.1">subscript</csymbol><apply id="A1.E15.m1.6.6.1.1.1.1.1.1.1.cmml" xref="A1.E15.m1.6.6.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E15.m1.6.6.1.1.1.1.1.1.1.1.cmml" xref="A1.E15.m1.6.6.1.1.1.1.1.1">superscript</csymbol><apply id="A1.E15.m1.6.6.1.1.1.1.1.1.1.2.cmml" xref="A1.E15.m1.6.6.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E15.m1.6.6.1.1.1.1.1.1.1.2.1.cmml" xref="A1.E15.m1.6.6.1.1.1.1.1.1">subscript</csymbol><ci id="A1.E15.m1.6.6.1.1.1.1.1.1.1.2.2.cmml" xref="A1.E15.m1.6.6.1.1.1.1.1.1.1.2.2">𝜔</ci><ci id="A1.E15.m1.6.6.1.1.1.1.1.1.1.2.3.cmml" xref="A1.E15.m1.6.6.1.1.1.1.1.1.1.2.3">𝑘</ci></apply><ci id="A1.E15.m1.1.1.1.1.cmml" xref="A1.E15.m1.1.1.1.1">𝑖</ci></apply><ci id="A1.E15.m1.6.6.1.1.1.1.3.cmml" xref="A1.E15.m1.6.6.1.1.1.1.3">𝑞</ci></apply></apply><apply id="A1.E15.m1.6.6.1.1.2.cmml" xref="A1.E15.m1.6.6.1.1.2"><apply id="A1.E15.m1.6.6.1.1.2.2.cmml" xref="A1.E15.m1.6.6.1.1.2.2"><csymbol cd="ambiguous" id="A1.E15.m1.6.6.1.1.2.2.1.cmml" xref="A1.E15.m1.6.6.1.1.2.2">subscript</csymbol><sum id="A1.E15.m1.6.6.1.1.2.2.2.cmml" xref="A1.E15.m1.6.6.1.1.2.2.2"></sum><apply id="A1.E15.m1.6.6.1.1.2.2.3.cmml" xref="A1.E15.m1.6.6.1.1.2.2.3"><in id="A1.E15.m1.6.6.1.1.2.2.3.1.cmml" xref="A1.E15.m1.6.6.1.1.2.2.3.1"></in><apply id="A1.E15.m1.6.6.1.1.2.2.3.2.cmml" xref="A1.E15.m1.6.6.1.1.2.2.3.2"><csymbol cd="ambiguous" id="A1.E15.m1.6.6.1.1.2.2.3.2.1.cmml" xref="A1.E15.m1.6.6.1.1.2.2.3.2">subscript</csymbol><ci id="A1.E15.m1.6.6.1.1.2.2.3.2.2.cmml" xref="A1.E15.m1.6.6.1.1.2.2.3.2.2">𝜔</ci><apply id="A1.E15.m1.6.6.1.1.2.2.3.2.3.cmml" xref="A1.E15.m1.6.6.1.1.2.2.3.2.3"><times id="A1.E15.m1.6.6.1.1.2.2.3.2.3.1.cmml" xref="A1.E15.m1.6.6.1.1.2.2.3.2.3.1"></times><ci id="A1.E15.m1.6.6.1.1.2.2.3.2.3.2.cmml" xref="A1.E15.m1.6.6.1.1.2.2.3.2.3.2">𝑖</ci><ci id="A1.E15.m1.6.6.1.1.2.2.3.2.3.3.cmml" xref="A1.E15.m1.6.6.1.1.2.2.3.2.3.3">𝑞</ci></apply></apply><apply id="A1.E15.m1.6.6.1.1.2.2.3.3.cmml" xref="A1.E15.m1.6.6.1.1.2.2.3.3"><csymbol cd="ambiguous" id="A1.E15.m1.6.6.1.1.2.2.3.3.1.cmml" xref="A1.E15.m1.6.6.1.1.2.2.3.3">subscript</csymbol><ci id="A1.E15.m1.6.6.1.1.2.2.3.3.2.cmml" xref="A1.E15.m1.6.6.1.1.2.2.3.3.2">Ω</ci><apply id="A1.E15.m1.6.6.1.1.2.2.3.3.3.cmml" xref="A1.E15.m1.6.6.1.1.2.2.3.3.3"><times id="A1.E15.m1.6.6.1.1.2.2.3.3.3.1.cmml" xref="A1.E15.m1.6.6.1.1.2.2.3.3.3.1"></times><ci id="A1.E15.m1.6.6.1.1.2.2.3.3.3.2.cmml" xref="A1.E15.m1.6.6.1.1.2.2.3.3.3.2">𝑖</ci><ci id="A1.E15.m1.6.6.1.1.2.2.3.3.3.3.cmml" xref="A1.E15.m1.6.6.1.1.2.2.3.3.3.3">𝑞</ci></apply></apply></apply></apply><apply id="A1.E15.m1.6.6.1.1.2.1.cmml" xref="A1.E15.m1.6.6.1.1.2.1"><times id="A1.E15.m1.6.6.1.1.2.1.2.cmml" xref="A1.E15.m1.6.6.1.1.2.1.2"></times><apply id="A1.E15.m1.4.4.cmml" xref="A1.E15.m1.4.4"><divide id="A1.E15.m1.4.4.4.cmml" xref="A1.E15.m1.4.4"></divide><apply id="A1.E15.m1.3.3.2.cmml" xref="A1.E15.m1.3.3.2"><times id="A1.E15.m1.3.3.2.3.cmml" xref="A1.E15.m1.3.3.2.3"></times><apply id="A1.E15.m1.3.3.2.4.cmml" xref="A1.E15.m1.3.3.2.4"><ci id="A1.E15.m1.3.3.2.4.1.cmml" xref="A1.E15.m1.3.3.2.4.1">~</ci><ci id="A1.E15.m1.3.3.2.4.2.cmml" xref="A1.E15.m1.3.3.2.4.2">𝜔</ci></apply><apply id="A1.E15.m1.3.3.2.2.1.1.cmml" xref="A1.E15.m1.3.3.2.2.1"><csymbol cd="ambiguous" id="A1.E15.m1.3.3.2.2.1.1.1.cmml" xref="A1.E15.m1.3.3.2.2.1">subscript</csymbol><ci id="A1.E15.m1.3.3.2.2.1.1.2.cmml" xref="A1.E15.m1.3.3.2.2.1.1.2">𝜔</ci><apply id="A1.E15.m1.3.3.2.2.1.1.3.cmml" xref="A1.E15.m1.3.3.2.2.1.1.3"><times id="A1.E15.m1.3.3.2.2.1.1.3.1.cmml" xref="A1.E15.m1.3.3.2.2.1.1.3.1"></times><ci id="A1.E15.m1.3.3.2.2.1.1.3.2.cmml" xref="A1.E15.m1.3.3.2.2.1.1.3.2">𝑖</ci><ci id="A1.E15.m1.3.3.2.2.1.1.3.3.cmml" xref="A1.E15.m1.3.3.2.2.1.1.3.3">𝑞</ci></apply></apply><apply id="A1.E15.m1.3.3.2.5.cmml" xref="A1.E15.m1.3.3.2.5"><csymbol cd="ambiguous" id="A1.E15.m1.3.3.2.5.1.cmml" xref="A1.E15.m1.3.3.2.5">subscript</csymbol><ci id="A1.E15.m1.3.3.2.5.2.cmml" xref="A1.E15.m1.3.3.2.5.2">𝑓</ci><apply id="A1.E15.m1.2.2.1.1.1.cmml" xref="A1.E15.m1.2.2.1.1.1"><times id="A1.E15.m1.2.2.1.1.1.2.cmml" xref="A1.E15.m1.2.2.1.1.1.2"></times><ci id="A1.E15.m1.2.2.1.1.1.3a.cmml" xref="A1.E15.m1.2.2.1.1.1.3"><mtext id="A1.E15.m1.2.2.1.1.1.3.cmml" mathsize="70%" xref="A1.E15.m1.2.2.1.1.1.3">len</mtext></ci><apply id="A1.E15.m1.2.2.1.1.1.1.1.1.cmml" xref="A1.E15.m1.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E15.m1.2.2.1.1.1.1.1.1.1.cmml" xref="A1.E15.m1.2.2.1.1.1.1.1">subscript</csymbol><ci id="A1.E15.m1.2.2.1.1.1.1.1.1.2.cmml" xref="A1.E15.m1.2.2.1.1.1.1.1.1.2">𝜔</ci><apply id="A1.E15.m1.2.2.1.1.1.1.1.1.3.cmml" xref="A1.E15.m1.2.2.1.1.1.1.1.1.3"><times id="A1.E15.m1.2.2.1.1.1.1.1.1.3.1.cmml" xref="A1.E15.m1.2.2.1.1.1.1.1.1.3.1"></times><ci id="A1.E15.m1.2.2.1.1.1.1.1.1.3.2.cmml" xref="A1.E15.m1.2.2.1.1.1.1.1.1.3.2">𝑖</ci><ci id="A1.E15.m1.2.2.1.1.1.1.1.1.3.3.cmml" xref="A1.E15.m1.2.2.1.1.1.1.1.1.3.3">𝑞</ci></apply></apply></apply></apply></apply><apply id="A1.E15.m1.4.4.3.cmml" xref="A1.E15.m1.4.4.3"><times id="A1.E15.m1.4.4.3.2.cmml" xref="A1.E15.m1.4.4.3.2"></times><ci id="A1.E15.m1.4.4.3.3.cmml" xref="A1.E15.m1.4.4.3.3">𝑝</ci><apply id="A1.E15.m1.4.4.3.1.1.1.cmml" xref="A1.E15.m1.4.4.3.1.1"><csymbol cd="ambiguous" id="A1.E15.m1.4.4.3.1.1.1.1.cmml" xref="A1.E15.m1.4.4.3.1.1">subscript</csymbol><ci id="A1.E15.m1.4.4.3.1.1.1.2.cmml" xref="A1.E15.m1.4.4.3.1.1.1.2">𝜔</ci><apply id="A1.E15.m1.4.4.3.1.1.1.3.cmml" xref="A1.E15.m1.4.4.3.1.1.1.3"><times id="A1.E15.m1.4.4.3.1.1.1.3.1.cmml" xref="A1.E15.m1.4.4.3.1.1.1.3.1"></times><ci id="A1.E15.m1.4.4.3.1.1.1.3.2.cmml" xref="A1.E15.m1.4.4.3.1.1.1.3.2">𝑖</ci><ci id="A1.E15.m1.4.4.3.1.1.1.3.3.cmml" xref="A1.E15.m1.4.4.3.1.1.1.3.3">𝑞</ci></apply></apply></apply></apply><ci id="A1.E15.m1.6.6.1.1.2.1.3.cmml" xref="A1.E15.m1.6.6.1.1.2.1.3">𝕀</ci><apply id="A1.E15.m1.6.6.1.1.2.1.1.1.1.cmml" xref="A1.E15.m1.6.6.1.1.2.1.1.1"><times id="A1.E15.m1.6.6.1.1.2.1.1.1.1.1.cmml" xref="A1.E15.m1.6.6.1.1.2.1.1.1.1.1"></times><apply id="A1.E15.m1.6.6.1.1.2.1.1.1.1.2.cmml" xref="A1.E15.m1.6.6.1.1.2.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.E15.m1.6.6.1.1.2.1.1.1.1.2.1.cmml" xref="A1.E15.m1.6.6.1.1.2.1.1.1.1.2">subscript</csymbol><ci id="A1.E15.m1.6.6.1.1.2.1.1.1.1.2.2.cmml" xref="A1.E15.m1.6.6.1.1.2.1.1.1.1.2.2">𝜔</ci><apply id="A1.E15.m1.6.6.1.1.2.1.1.1.1.2.3.cmml" xref="A1.E15.m1.6.6.1.1.2.1.1.1.1.2.3"><times id="A1.E15.m1.6.6.1.1.2.1.1.1.1.2.3.1.cmml" xref="A1.E15.m1.6.6.1.1.2.1.1.1.1.2.3.1"></times><ci id="A1.E15.m1.6.6.1.1.2.1.1.1.1.2.3.2.cmml" xref="A1.E15.m1.6.6.1.1.2.1.1.1.1.2.3.2">𝑖</ci><ci id="A1.E15.m1.6.6.1.1.2.1.1.1.1.2.3.3.cmml" xref="A1.E15.m1.6.6.1.1.2.1.1.1.1.2.3.3">𝑞</ci></apply></apply><ci id="A1.E15.m1.6.6.1.1.2.1.1.1.1.3a.cmml" xref="A1.E15.m1.6.6.1.1.2.1.1.1.1.3"><mtext id="A1.E15.m1.6.6.1.1.2.1.1.1.1.3.cmml" xref="A1.E15.m1.6.6.1.1.2.1.1.1.1.3">&nbsp;prefix subwalk of&nbsp;</mtext></ci><apply id="A1.E15.m1.6.6.1.1.2.1.1.1.1.4.cmml" xref="A1.E15.m1.6.6.1.1.2.1.1.1.1.4"><csymbol cd="ambiguous" id="A1.E15.m1.6.6.1.1.2.1.1.1.1.4.1.cmml" xref="A1.E15.m1.6.6.1.1.2.1.1.1.1.4">superscript</csymbol><apply id="A1.E15.m1.6.6.1.1.2.1.1.1.1.4.2.cmml" xref="A1.E15.m1.6.6.1.1.2.1.1.1.1.4"><csymbol cd="ambiguous" id="A1.E15.m1.6.6.1.1.2.1.1.1.1.4.2.1.cmml" xref="A1.E15.m1.6.6.1.1.2.1.1.1.1.4">subscript</csymbol><ci id="A1.E15.m1.6.6.1.1.2.1.1.1.1.4.2.2.cmml" xref="A1.E15.m1.6.6.1.1.2.1.1.1.1.4.2.2">𝜔</ci><ci id="A1.E15.m1.6.6.1.1.2.1.1.1.1.4.2.3.cmml" xref="A1.E15.m1.6.6.1.1.2.1.1.1.1.4.2.3">𝑘</ci></apply><ci id="A1.E15.m1.5.5.1.1.cmml" xref="A1.E15.m1.5.5.1.1">𝑖</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E15.m1.6c">\psi(\omega_{k}^{(i)})_{q}\coloneqq\sum_{\omega_{iq}\in\Omega_{iq}}\frac{%
\widetilde{\omega}(\omega_{iq})f_{\textrm{len}(\omega_{iq})}}{p(\omega_{iq})}%
\mathbb{I}(\omega_{iq}\textrm{ prefix subwalk of }\omega_{k}^{(i)}).</annotation><annotation encoding="application/x-llamapun" id="A1.E15.m1.6d">italic_ψ ( italic_ω start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT ) start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT ≔ ∑ start_POSTSUBSCRIPT italic_ω start_POSTSUBSCRIPT italic_i italic_q end_POSTSUBSCRIPT ∈ roman_Ω start_POSTSUBSCRIPT italic_i italic_q end_POSTSUBSCRIPT end_POSTSUBSCRIPT divide start_ARG over~ start_ARG italic_ω end_ARG ( italic_ω start_POSTSUBSCRIPT italic_i italic_q end_POSTSUBSCRIPT ) italic_f start_POSTSUBSCRIPT len ( italic_ω start_POSTSUBSCRIPT italic_i italic_q end_POSTSUBSCRIPT ) end_POSTSUBSCRIPT end_ARG start_ARG italic_p ( italic_ω start_POSTSUBSCRIPT italic_i italic_q end_POSTSUBSCRIPT ) end_ARG blackboard_I ( italic_ω start_POSTSUBSCRIPT italic_i italic_q end_POSTSUBSCRIPT prefix subwalk of italic_ω start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(15)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A1.SS2.p1.12"><math alttext="\Omega_{iq}" class="ltx_Math" display="inline" id="A1.SS2.p1.2.m1.1"><semantics id="A1.SS2.p1.2.m1.1a"><msub id="A1.SS2.p1.2.m1.1.1" xref="A1.SS2.p1.2.m1.1.1.cmml"><mi id="A1.SS2.p1.2.m1.1.1.2" mathvariant="normal" xref="A1.SS2.p1.2.m1.1.1.2.cmml">Ω</mi><mrow id="A1.SS2.p1.2.m1.1.1.3" xref="A1.SS2.p1.2.m1.1.1.3.cmml"><mi id="A1.SS2.p1.2.m1.1.1.3.2" xref="A1.SS2.p1.2.m1.1.1.3.2.cmml">i</mi><mo id="A1.SS2.p1.2.m1.1.1.3.1" xref="A1.SS2.p1.2.m1.1.1.3.1.cmml">⁢</mo><mi id="A1.SS2.p1.2.m1.1.1.3.3" xref="A1.SS2.p1.2.m1.1.1.3.3.cmml">q</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="A1.SS2.p1.2.m1.1b"><apply id="A1.SS2.p1.2.m1.1.1.cmml" xref="A1.SS2.p1.2.m1.1.1"><csymbol cd="ambiguous" id="A1.SS2.p1.2.m1.1.1.1.cmml" xref="A1.SS2.p1.2.m1.1.1">subscript</csymbol><ci id="A1.SS2.p1.2.m1.1.1.2.cmml" xref="A1.SS2.p1.2.m1.1.1.2">Ω</ci><apply id="A1.SS2.p1.2.m1.1.1.3.cmml" xref="A1.SS2.p1.2.m1.1.1.3"><times id="A1.SS2.p1.2.m1.1.1.3.1.cmml" xref="A1.SS2.p1.2.m1.1.1.3.1"></times><ci id="A1.SS2.p1.2.m1.1.1.3.2.cmml" xref="A1.SS2.p1.2.m1.1.1.3.2">𝑖</ci><ci id="A1.SS2.p1.2.m1.1.1.3.3.cmml" xref="A1.SS2.p1.2.m1.1.1.3.3">𝑞</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p1.2.m1.1c">\Omega_{iq}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p1.2.m1.1d">roman_Ω start_POSTSUBSCRIPT italic_i italic_q end_POSTSUBSCRIPT</annotation></semantics></math> is the set of walks between nodes <math alttext="v_{i}" class="ltx_Math" display="inline" id="A1.SS2.p1.3.m2.1"><semantics id="A1.SS2.p1.3.m2.1a"><msub id="A1.SS2.p1.3.m2.1.1" xref="A1.SS2.p1.3.m2.1.1.cmml"><mi id="A1.SS2.p1.3.m2.1.1.2" xref="A1.SS2.p1.3.m2.1.1.2.cmml">v</mi><mi id="A1.SS2.p1.3.m2.1.1.3" xref="A1.SS2.p1.3.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS2.p1.3.m2.1b"><apply id="A1.SS2.p1.3.m2.1.1.cmml" xref="A1.SS2.p1.3.m2.1.1"><csymbol cd="ambiguous" id="A1.SS2.p1.3.m2.1.1.1.cmml" xref="A1.SS2.p1.3.m2.1.1">subscript</csymbol><ci id="A1.SS2.p1.3.m2.1.1.2.cmml" xref="A1.SS2.p1.3.m2.1.1.2">𝑣</ci><ci id="A1.SS2.p1.3.m2.1.1.3.cmml" xref="A1.SS2.p1.3.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p1.3.m2.1c">v_{i}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p1.3.m2.1d">italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="v_{q}" class="ltx_Math" display="inline" id="A1.SS2.p1.4.m3.1"><semantics id="A1.SS2.p1.4.m3.1a"><msub id="A1.SS2.p1.4.m3.1.1" xref="A1.SS2.p1.4.m3.1.1.cmml"><mi id="A1.SS2.p1.4.m3.1.1.2" xref="A1.SS2.p1.4.m3.1.1.2.cmml">v</mi><mi id="A1.SS2.p1.4.m3.1.1.3" xref="A1.SS2.p1.4.m3.1.1.3.cmml">q</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS2.p1.4.m3.1b"><apply id="A1.SS2.p1.4.m3.1.1.cmml" xref="A1.SS2.p1.4.m3.1.1"><csymbol cd="ambiguous" id="A1.SS2.p1.4.m3.1.1.1.cmml" xref="A1.SS2.p1.4.m3.1.1">subscript</csymbol><ci id="A1.SS2.p1.4.m3.1.1.2.cmml" xref="A1.SS2.p1.4.m3.1.1.2">𝑣</ci><ci id="A1.SS2.p1.4.m3.1.1.3.cmml" xref="A1.SS2.p1.4.m3.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p1.4.m3.1c">v_{q}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p1.4.m3.1d">italic_v start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT</annotation></semantics></math>; <math alttext="p(\omega_{iq})" class="ltx_Math" display="inline" id="A1.SS2.p1.5.m4.1"><semantics id="A1.SS2.p1.5.m4.1a"><mrow id="A1.SS2.p1.5.m4.1.1" xref="A1.SS2.p1.5.m4.1.1.cmml"><mi id="A1.SS2.p1.5.m4.1.1.3" xref="A1.SS2.p1.5.m4.1.1.3.cmml">p</mi><mo id="A1.SS2.p1.5.m4.1.1.2" xref="A1.SS2.p1.5.m4.1.1.2.cmml">⁢</mo><mrow id="A1.SS2.p1.5.m4.1.1.1.1" xref="A1.SS2.p1.5.m4.1.1.1.1.1.cmml"><mo id="A1.SS2.p1.5.m4.1.1.1.1.2" stretchy="false" xref="A1.SS2.p1.5.m4.1.1.1.1.1.cmml">(</mo><msub id="A1.SS2.p1.5.m4.1.1.1.1.1" xref="A1.SS2.p1.5.m4.1.1.1.1.1.cmml"><mi id="A1.SS2.p1.5.m4.1.1.1.1.1.2" xref="A1.SS2.p1.5.m4.1.1.1.1.1.2.cmml">ω</mi><mrow id="A1.SS2.p1.5.m4.1.1.1.1.1.3" xref="A1.SS2.p1.5.m4.1.1.1.1.1.3.cmml"><mi id="A1.SS2.p1.5.m4.1.1.1.1.1.3.2" xref="A1.SS2.p1.5.m4.1.1.1.1.1.3.2.cmml">i</mi><mo id="A1.SS2.p1.5.m4.1.1.1.1.1.3.1" xref="A1.SS2.p1.5.m4.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="A1.SS2.p1.5.m4.1.1.1.1.1.3.3" xref="A1.SS2.p1.5.m4.1.1.1.1.1.3.3.cmml">q</mi></mrow></msub><mo id="A1.SS2.p1.5.m4.1.1.1.1.3" stretchy="false" xref="A1.SS2.p1.5.m4.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p1.5.m4.1b"><apply id="A1.SS2.p1.5.m4.1.1.cmml" xref="A1.SS2.p1.5.m4.1.1"><times id="A1.SS2.p1.5.m4.1.1.2.cmml" xref="A1.SS2.p1.5.m4.1.1.2"></times><ci id="A1.SS2.p1.5.m4.1.1.3.cmml" xref="A1.SS2.p1.5.m4.1.1.3">𝑝</ci><apply id="A1.SS2.p1.5.m4.1.1.1.1.1.cmml" xref="A1.SS2.p1.5.m4.1.1.1.1"><csymbol cd="ambiguous" id="A1.SS2.p1.5.m4.1.1.1.1.1.1.cmml" xref="A1.SS2.p1.5.m4.1.1.1.1">subscript</csymbol><ci id="A1.SS2.p1.5.m4.1.1.1.1.1.2.cmml" xref="A1.SS2.p1.5.m4.1.1.1.1.1.2">𝜔</ci><apply id="A1.SS2.p1.5.m4.1.1.1.1.1.3.cmml" xref="A1.SS2.p1.5.m4.1.1.1.1.1.3"><times id="A1.SS2.p1.5.m4.1.1.1.1.1.3.1.cmml" xref="A1.SS2.p1.5.m4.1.1.1.1.1.3.1"></times><ci id="A1.SS2.p1.5.m4.1.1.1.1.1.3.2.cmml" xref="A1.SS2.p1.5.m4.1.1.1.1.1.3.2">𝑖</ci><ci id="A1.SS2.p1.5.m4.1.1.1.1.1.3.3.cmml" xref="A1.SS2.p1.5.m4.1.1.1.1.1.3.3">𝑞</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p1.5.m4.1c">p(\omega_{iq})</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p1.5.m4.1d">italic_p ( italic_ω start_POSTSUBSCRIPT italic_i italic_q end_POSTSUBSCRIPT )</annotation></semantics></math> is the probability of a particular walk <math alttext="\omega_{iq}" class="ltx_Math" display="inline" id="A1.SS2.p1.6.m5.1"><semantics id="A1.SS2.p1.6.m5.1a"><msub id="A1.SS2.p1.6.m5.1.1" xref="A1.SS2.p1.6.m5.1.1.cmml"><mi id="A1.SS2.p1.6.m5.1.1.2" xref="A1.SS2.p1.6.m5.1.1.2.cmml">ω</mi><mrow id="A1.SS2.p1.6.m5.1.1.3" xref="A1.SS2.p1.6.m5.1.1.3.cmml"><mi id="A1.SS2.p1.6.m5.1.1.3.2" xref="A1.SS2.p1.6.m5.1.1.3.2.cmml">i</mi><mo id="A1.SS2.p1.6.m5.1.1.3.1" xref="A1.SS2.p1.6.m5.1.1.3.1.cmml">⁢</mo><mi id="A1.SS2.p1.6.m5.1.1.3.3" xref="A1.SS2.p1.6.m5.1.1.3.3.cmml">q</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="A1.SS2.p1.6.m5.1b"><apply id="A1.SS2.p1.6.m5.1.1.cmml" xref="A1.SS2.p1.6.m5.1.1"><csymbol cd="ambiguous" id="A1.SS2.p1.6.m5.1.1.1.cmml" xref="A1.SS2.p1.6.m5.1.1">subscript</csymbol><ci id="A1.SS2.p1.6.m5.1.1.2.cmml" xref="A1.SS2.p1.6.m5.1.1.2">𝜔</ci><apply id="A1.SS2.p1.6.m5.1.1.3.cmml" xref="A1.SS2.p1.6.m5.1.1.3"><times id="A1.SS2.p1.6.m5.1.1.3.1.cmml" xref="A1.SS2.p1.6.m5.1.1.3.1"></times><ci id="A1.SS2.p1.6.m5.1.1.3.2.cmml" xref="A1.SS2.p1.6.m5.1.1.3.2">𝑖</ci><ci id="A1.SS2.p1.6.m5.1.1.3.3.cmml" xref="A1.SS2.p1.6.m5.1.1.3.3">𝑞</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p1.6.m5.1c">\omega_{iq}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p1.6.m5.1d">italic_ω start_POSTSUBSCRIPT italic_i italic_q end_POSTSUBSCRIPT</annotation></semantics></math>, known from the sampling mechanism; <math alttext="\widetilde{\omega}(\omega_{iq})" class="ltx_Math" display="inline" id="A1.SS2.p1.7.m6.1"><semantics id="A1.SS2.p1.7.m6.1a"><mrow id="A1.SS2.p1.7.m6.1.1" xref="A1.SS2.p1.7.m6.1.1.cmml"><mover accent="true" id="A1.SS2.p1.7.m6.1.1.3" xref="A1.SS2.p1.7.m6.1.1.3.cmml"><mi id="A1.SS2.p1.7.m6.1.1.3.2" xref="A1.SS2.p1.7.m6.1.1.3.2.cmml">ω</mi><mo id="A1.SS2.p1.7.m6.1.1.3.1" xref="A1.SS2.p1.7.m6.1.1.3.1.cmml">~</mo></mover><mo id="A1.SS2.p1.7.m6.1.1.2" xref="A1.SS2.p1.7.m6.1.1.2.cmml">⁢</mo><mrow id="A1.SS2.p1.7.m6.1.1.1.1" xref="A1.SS2.p1.7.m6.1.1.1.1.1.cmml"><mo id="A1.SS2.p1.7.m6.1.1.1.1.2" stretchy="false" xref="A1.SS2.p1.7.m6.1.1.1.1.1.cmml">(</mo><msub id="A1.SS2.p1.7.m6.1.1.1.1.1" xref="A1.SS2.p1.7.m6.1.1.1.1.1.cmml"><mi id="A1.SS2.p1.7.m6.1.1.1.1.1.2" xref="A1.SS2.p1.7.m6.1.1.1.1.1.2.cmml">ω</mi><mrow id="A1.SS2.p1.7.m6.1.1.1.1.1.3" xref="A1.SS2.p1.7.m6.1.1.1.1.1.3.cmml"><mi id="A1.SS2.p1.7.m6.1.1.1.1.1.3.2" xref="A1.SS2.p1.7.m6.1.1.1.1.1.3.2.cmml">i</mi><mo id="A1.SS2.p1.7.m6.1.1.1.1.1.3.1" xref="A1.SS2.p1.7.m6.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="A1.SS2.p1.7.m6.1.1.1.1.1.3.3" xref="A1.SS2.p1.7.m6.1.1.1.1.1.3.3.cmml">q</mi></mrow></msub><mo id="A1.SS2.p1.7.m6.1.1.1.1.3" stretchy="false" xref="A1.SS2.p1.7.m6.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p1.7.m6.1b"><apply id="A1.SS2.p1.7.m6.1.1.cmml" xref="A1.SS2.p1.7.m6.1.1"><times id="A1.SS2.p1.7.m6.1.1.2.cmml" xref="A1.SS2.p1.7.m6.1.1.2"></times><apply id="A1.SS2.p1.7.m6.1.1.3.cmml" xref="A1.SS2.p1.7.m6.1.1.3"><ci id="A1.SS2.p1.7.m6.1.1.3.1.cmml" xref="A1.SS2.p1.7.m6.1.1.3.1">~</ci><ci id="A1.SS2.p1.7.m6.1.1.3.2.cmml" xref="A1.SS2.p1.7.m6.1.1.3.2">𝜔</ci></apply><apply id="A1.SS2.p1.7.m6.1.1.1.1.1.cmml" xref="A1.SS2.p1.7.m6.1.1.1.1"><csymbol cd="ambiguous" id="A1.SS2.p1.7.m6.1.1.1.1.1.1.cmml" xref="A1.SS2.p1.7.m6.1.1.1.1">subscript</csymbol><ci id="A1.SS2.p1.7.m6.1.1.1.1.1.2.cmml" xref="A1.SS2.p1.7.m6.1.1.1.1.1.2">𝜔</ci><apply id="A1.SS2.p1.7.m6.1.1.1.1.1.3.cmml" xref="A1.SS2.p1.7.m6.1.1.1.1.1.3"><times id="A1.SS2.p1.7.m6.1.1.1.1.1.3.1.cmml" xref="A1.SS2.p1.7.m6.1.1.1.1.1.3.1"></times><ci id="A1.SS2.p1.7.m6.1.1.1.1.1.3.2.cmml" xref="A1.SS2.p1.7.m6.1.1.1.1.1.3.2">𝑖</ci><ci id="A1.SS2.p1.7.m6.1.1.1.1.1.3.3.cmml" xref="A1.SS2.p1.7.m6.1.1.1.1.1.3.3">𝑞</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p1.7.m6.1c">\widetilde{\omega}(\omega_{iq})</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p1.7.m6.1d">over~ start_ARG italic_ω end_ARG ( italic_ω start_POSTSUBSCRIPT italic_i italic_q end_POSTSUBSCRIPT )</annotation></semantics></math> is a function that returns the product of weights of edges traversed by <math alttext="\omega_{iq}" class="ltx_Math" display="inline" id="A1.SS2.p1.8.m7.1"><semantics id="A1.SS2.p1.8.m7.1a"><msub id="A1.SS2.p1.8.m7.1.1" xref="A1.SS2.p1.8.m7.1.1.cmml"><mi id="A1.SS2.p1.8.m7.1.1.2" xref="A1.SS2.p1.8.m7.1.1.2.cmml">ω</mi><mrow id="A1.SS2.p1.8.m7.1.1.3" xref="A1.SS2.p1.8.m7.1.1.3.cmml"><mi id="A1.SS2.p1.8.m7.1.1.3.2" xref="A1.SS2.p1.8.m7.1.1.3.2.cmml">i</mi><mo id="A1.SS2.p1.8.m7.1.1.3.1" xref="A1.SS2.p1.8.m7.1.1.3.1.cmml">⁢</mo><mi id="A1.SS2.p1.8.m7.1.1.3.3" xref="A1.SS2.p1.8.m7.1.1.3.3.cmml">q</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="A1.SS2.p1.8.m7.1b"><apply id="A1.SS2.p1.8.m7.1.1.cmml" xref="A1.SS2.p1.8.m7.1.1"><csymbol cd="ambiguous" id="A1.SS2.p1.8.m7.1.1.1.cmml" xref="A1.SS2.p1.8.m7.1.1">subscript</csymbol><ci id="A1.SS2.p1.8.m7.1.1.2.cmml" xref="A1.SS2.p1.8.m7.1.1.2">𝜔</ci><apply id="A1.SS2.p1.8.m7.1.1.3.cmml" xref="A1.SS2.p1.8.m7.1.1.3"><times id="A1.SS2.p1.8.m7.1.1.3.1.cmml" xref="A1.SS2.p1.8.m7.1.1.3.1"></times><ci id="A1.SS2.p1.8.m7.1.1.3.2.cmml" xref="A1.SS2.p1.8.m7.1.1.3.2">𝑖</ci><ci id="A1.SS2.p1.8.m7.1.1.3.3.cmml" xref="A1.SS2.p1.8.m7.1.1.3.3">𝑞</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p1.8.m7.1c">\omega_{iq}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p1.8.m7.1d">italic_ω start_POSTSUBSCRIPT italic_i italic_q end_POSTSUBSCRIPT</annotation></semantics></math> (Eq.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#S3.E9" title="In 3.3 Faster implicit masking with graph random features ‣ 3 Towards linear topological masking ‣ Linear Transformer Topological Masking with Graph Random Features"><span class="ltx_text ltx_ref_tag">9</span></a>); <math alttext="\textrm{len}(\omega_{iq})" class="ltx_Math" display="inline" id="A1.SS2.p1.9.m8.1"><semantics id="A1.SS2.p1.9.m8.1a"><mrow id="A1.SS2.p1.9.m8.1.1" xref="A1.SS2.p1.9.m8.1.1.cmml"><mtext id="A1.SS2.p1.9.m8.1.1.3" xref="A1.SS2.p1.9.m8.1.1.3a.cmml">len</mtext><mo id="A1.SS2.p1.9.m8.1.1.2" xref="A1.SS2.p1.9.m8.1.1.2.cmml">⁢</mo><mrow id="A1.SS2.p1.9.m8.1.1.1.1" xref="A1.SS2.p1.9.m8.1.1.1.1.1.cmml"><mo id="A1.SS2.p1.9.m8.1.1.1.1.2" stretchy="false" xref="A1.SS2.p1.9.m8.1.1.1.1.1.cmml">(</mo><msub id="A1.SS2.p1.9.m8.1.1.1.1.1" xref="A1.SS2.p1.9.m8.1.1.1.1.1.cmml"><mi id="A1.SS2.p1.9.m8.1.1.1.1.1.2" xref="A1.SS2.p1.9.m8.1.1.1.1.1.2.cmml">ω</mi><mrow id="A1.SS2.p1.9.m8.1.1.1.1.1.3" xref="A1.SS2.p1.9.m8.1.1.1.1.1.3.cmml"><mi id="A1.SS2.p1.9.m8.1.1.1.1.1.3.2" xref="A1.SS2.p1.9.m8.1.1.1.1.1.3.2.cmml">i</mi><mo id="A1.SS2.p1.9.m8.1.1.1.1.1.3.1" xref="A1.SS2.p1.9.m8.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="A1.SS2.p1.9.m8.1.1.1.1.1.3.3" xref="A1.SS2.p1.9.m8.1.1.1.1.1.3.3.cmml">q</mi></mrow></msub><mo id="A1.SS2.p1.9.m8.1.1.1.1.3" stretchy="false" xref="A1.SS2.p1.9.m8.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p1.9.m8.1b"><apply id="A1.SS2.p1.9.m8.1.1.cmml" xref="A1.SS2.p1.9.m8.1.1"><times id="A1.SS2.p1.9.m8.1.1.2.cmml" xref="A1.SS2.p1.9.m8.1.1.2"></times><ci id="A1.SS2.p1.9.m8.1.1.3a.cmml" xref="A1.SS2.p1.9.m8.1.1.3"><mtext id="A1.SS2.p1.9.m8.1.1.3.cmml" xref="A1.SS2.p1.9.m8.1.1.3">len</mtext></ci><apply id="A1.SS2.p1.9.m8.1.1.1.1.1.cmml" xref="A1.SS2.p1.9.m8.1.1.1.1"><csymbol cd="ambiguous" id="A1.SS2.p1.9.m8.1.1.1.1.1.1.cmml" xref="A1.SS2.p1.9.m8.1.1.1.1">subscript</csymbol><ci id="A1.SS2.p1.9.m8.1.1.1.1.1.2.cmml" xref="A1.SS2.p1.9.m8.1.1.1.1.1.2">𝜔</ci><apply id="A1.SS2.p1.9.m8.1.1.1.1.1.3.cmml" xref="A1.SS2.p1.9.m8.1.1.1.1.1.3"><times id="A1.SS2.p1.9.m8.1.1.1.1.1.3.1.cmml" xref="A1.SS2.p1.9.m8.1.1.1.1.1.3.1"></times><ci id="A1.SS2.p1.9.m8.1.1.1.1.1.3.2.cmml" xref="A1.SS2.p1.9.m8.1.1.1.1.1.3.2">𝑖</ci><ci id="A1.SS2.p1.9.m8.1.1.1.1.1.3.3.cmml" xref="A1.SS2.p1.9.m8.1.1.1.1.1.3.3">𝑞</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p1.9.m8.1c">\textrm{len}(\omega_{iq})</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p1.9.m8.1d">len ( italic_ω start_POSTSUBSCRIPT italic_i italic_q end_POSTSUBSCRIPT )</annotation></semantics></math> is the length of <math alttext="\omega_{iq}" class="ltx_Math" display="inline" id="A1.SS2.p1.10.m9.1"><semantics id="A1.SS2.p1.10.m9.1a"><msub id="A1.SS2.p1.10.m9.1.1" xref="A1.SS2.p1.10.m9.1.1.cmml"><mi id="A1.SS2.p1.10.m9.1.1.2" xref="A1.SS2.p1.10.m9.1.1.2.cmml">ω</mi><mrow id="A1.SS2.p1.10.m9.1.1.3" xref="A1.SS2.p1.10.m9.1.1.3.cmml"><mi id="A1.SS2.p1.10.m9.1.1.3.2" xref="A1.SS2.p1.10.m9.1.1.3.2.cmml">i</mi><mo id="A1.SS2.p1.10.m9.1.1.3.1" xref="A1.SS2.p1.10.m9.1.1.3.1.cmml">⁢</mo><mi id="A1.SS2.p1.10.m9.1.1.3.3" xref="A1.SS2.p1.10.m9.1.1.3.3.cmml">q</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="A1.SS2.p1.10.m9.1b"><apply id="A1.SS2.p1.10.m9.1.1.cmml" xref="A1.SS2.p1.10.m9.1.1"><csymbol cd="ambiguous" id="A1.SS2.p1.10.m9.1.1.1.cmml" xref="A1.SS2.p1.10.m9.1.1">subscript</csymbol><ci id="A1.SS2.p1.10.m9.1.1.2.cmml" xref="A1.SS2.p1.10.m9.1.1.2">𝜔</ci><apply id="A1.SS2.p1.10.m9.1.1.3.cmml" xref="A1.SS2.p1.10.m9.1.1.3"><times id="A1.SS2.p1.10.m9.1.1.3.1.cmml" xref="A1.SS2.p1.10.m9.1.1.3.1"></times><ci id="A1.SS2.p1.10.m9.1.1.3.2.cmml" xref="A1.SS2.p1.10.m9.1.1.3.2">𝑖</ci><ci id="A1.SS2.p1.10.m9.1.1.3.3.cmml" xref="A1.SS2.p1.10.m9.1.1.3.3">𝑞</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p1.10.m9.1c">\omega_{iq}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p1.10.m9.1d">italic_ω start_POSTSUBSCRIPT italic_i italic_q end_POSTSUBSCRIPT</annotation></semantics></math>; and <math alttext="f:\mathbb{N}\to\mathbb{R}" class="ltx_Math" display="inline" id="A1.SS2.p1.11.m10.1"><semantics id="A1.SS2.p1.11.m10.1a"><mrow id="A1.SS2.p1.11.m10.1.1" xref="A1.SS2.p1.11.m10.1.1.cmml"><mi id="A1.SS2.p1.11.m10.1.1.2" xref="A1.SS2.p1.11.m10.1.1.2.cmml">f</mi><mo id="A1.SS2.p1.11.m10.1.1.1" lspace="0.278em" rspace="0.278em" xref="A1.SS2.p1.11.m10.1.1.1.cmml">:</mo><mrow id="A1.SS2.p1.11.m10.1.1.3" xref="A1.SS2.p1.11.m10.1.1.3.cmml"><mi id="A1.SS2.p1.11.m10.1.1.3.2" xref="A1.SS2.p1.11.m10.1.1.3.2.cmml">ℕ</mi><mo id="A1.SS2.p1.11.m10.1.1.3.1" stretchy="false" xref="A1.SS2.p1.11.m10.1.1.3.1.cmml">→</mo><mi id="A1.SS2.p1.11.m10.1.1.3.3" xref="A1.SS2.p1.11.m10.1.1.3.3.cmml">ℝ</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p1.11.m10.1b"><apply id="A1.SS2.p1.11.m10.1.1.cmml" xref="A1.SS2.p1.11.m10.1.1"><ci id="A1.SS2.p1.11.m10.1.1.1.cmml" xref="A1.SS2.p1.11.m10.1.1.1">:</ci><ci id="A1.SS2.p1.11.m10.1.1.2.cmml" xref="A1.SS2.p1.11.m10.1.1.2">𝑓</ci><apply id="A1.SS2.p1.11.m10.1.1.3.cmml" xref="A1.SS2.p1.11.m10.1.1.3"><ci id="A1.SS2.p1.11.m10.1.1.3.1.cmml" xref="A1.SS2.p1.11.m10.1.1.3.1">→</ci><ci id="A1.SS2.p1.11.m10.1.1.3.2.cmml" xref="A1.SS2.p1.11.m10.1.1.3.2">ℕ</ci><ci id="A1.SS2.p1.11.m10.1.1.3.3.cmml" xref="A1.SS2.p1.11.m10.1.1.3.3">ℝ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p1.11.m10.1c">f:\mathbb{N}\to\mathbb{R}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p1.11.m10.1d">italic_f : blackboard_N → blackboard_R</annotation></semantics></math> is a sequence of a real numbers that determines the graph node kernel to be estimated.
Following convention, we will assume that we sample random walks with <em class="ltx_emph ltx_font_italic" id="A1.SS2.p1.12.1">geometrically distributed lengths</em>, halting with probability <math alttext="p_{\textrm{halt}}" class="ltx_Math" display="inline" id="A1.SS2.p1.12.m11.1"><semantics id="A1.SS2.p1.12.m11.1a"><msub id="A1.SS2.p1.12.m11.1.1" xref="A1.SS2.p1.12.m11.1.1.cmml"><mi id="A1.SS2.p1.12.m11.1.1.2" xref="A1.SS2.p1.12.m11.1.1.2.cmml">p</mi><mtext id="A1.SS2.p1.12.m11.1.1.3" xref="A1.SS2.p1.12.m11.1.1.3a.cmml">halt</mtext></msub><annotation-xml encoding="MathML-Content" id="A1.SS2.p1.12.m11.1b"><apply id="A1.SS2.p1.12.m11.1.1.cmml" xref="A1.SS2.p1.12.m11.1.1"><csymbol cd="ambiguous" id="A1.SS2.p1.12.m11.1.1.1.cmml" xref="A1.SS2.p1.12.m11.1.1">subscript</csymbol><ci id="A1.SS2.p1.12.m11.1.1.2.cmml" xref="A1.SS2.p1.12.m11.1.1.2">𝑝</ci><ci id="A1.SS2.p1.12.m11.1.1.3a.cmml" xref="A1.SS2.p1.12.m11.1.1.3"><mtext id="A1.SS2.p1.12.m11.1.1.3.cmml" mathsize="70%" xref="A1.SS2.p1.12.m11.1.1.3">halt</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p1.12.m11.1c">p_{\textrm{halt}}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p1.12.m11.1d">italic_p start_POSTSUBSCRIPT halt end_POSTSUBSCRIPT</annotation></semantics></math> at each timestep, though in principle different importance sampling schemes are possible.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="A1.SS2.p2">
<p class="ltx_p" id="A1.SS2.p2.1">Suppose we are to estimate a single entry of the graph node kernel, <math alttext="\mathbf{M}_{\alpha}(\mathcal{G})_{ij}" class="ltx_Math" display="inline" id="A1.SS2.p2.1.m1.1"><semantics id="A1.SS2.p2.1.m1.1a"><mrow id="A1.SS2.p2.1.m1.1.2" xref="A1.SS2.p2.1.m1.1.2.cmml"><msub id="A1.SS2.p2.1.m1.1.2.2" xref="A1.SS2.p2.1.m1.1.2.2.cmml"><mi id="A1.SS2.p2.1.m1.1.2.2.2" xref="A1.SS2.p2.1.m1.1.2.2.2.cmml">𝐌</mi><mi id="A1.SS2.p2.1.m1.1.2.2.3" xref="A1.SS2.p2.1.m1.1.2.2.3.cmml">α</mi></msub><mo id="A1.SS2.p2.1.m1.1.2.1" xref="A1.SS2.p2.1.m1.1.2.1.cmml">⁢</mo><msub id="A1.SS2.p2.1.m1.1.2.3" xref="A1.SS2.p2.1.m1.1.2.3.cmml"><mrow id="A1.SS2.p2.1.m1.1.2.3.2.2" xref="A1.SS2.p2.1.m1.1.2.3.cmml"><mo id="A1.SS2.p2.1.m1.1.2.3.2.2.1" stretchy="false" xref="A1.SS2.p2.1.m1.1.2.3.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="A1.SS2.p2.1.m1.1.1" xref="A1.SS2.p2.1.m1.1.1.cmml">𝒢</mi><mo id="A1.SS2.p2.1.m1.1.2.3.2.2.2" stretchy="false" xref="A1.SS2.p2.1.m1.1.2.3.cmml">)</mo></mrow><mrow id="A1.SS2.p2.1.m1.1.2.3.3" xref="A1.SS2.p2.1.m1.1.2.3.3.cmml"><mi id="A1.SS2.p2.1.m1.1.2.3.3.2" xref="A1.SS2.p2.1.m1.1.2.3.3.2.cmml">i</mi><mo id="A1.SS2.p2.1.m1.1.2.3.3.1" xref="A1.SS2.p2.1.m1.1.2.3.3.1.cmml">⁢</mo><mi id="A1.SS2.p2.1.m1.1.2.3.3.3" xref="A1.SS2.p2.1.m1.1.2.3.3.3.cmml">j</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p2.1.m1.1b"><apply id="A1.SS2.p2.1.m1.1.2.cmml" xref="A1.SS2.p2.1.m1.1.2"><times id="A1.SS2.p2.1.m1.1.2.1.cmml" xref="A1.SS2.p2.1.m1.1.2.1"></times><apply id="A1.SS2.p2.1.m1.1.2.2.cmml" xref="A1.SS2.p2.1.m1.1.2.2"><csymbol cd="ambiguous" id="A1.SS2.p2.1.m1.1.2.2.1.cmml" xref="A1.SS2.p2.1.m1.1.2.2">subscript</csymbol><ci id="A1.SS2.p2.1.m1.1.2.2.2.cmml" xref="A1.SS2.p2.1.m1.1.2.2.2">𝐌</ci><ci id="A1.SS2.p2.1.m1.1.2.2.3.cmml" xref="A1.SS2.p2.1.m1.1.2.2.3">𝛼</ci></apply><apply id="A1.SS2.p2.1.m1.1.2.3.cmml" xref="A1.SS2.p2.1.m1.1.2.3"><csymbol cd="ambiguous" id="A1.SS2.p2.1.m1.1.2.3.1.cmml" xref="A1.SS2.p2.1.m1.1.2.3">subscript</csymbol><ci id="A1.SS2.p2.1.m1.1.1.cmml" xref="A1.SS2.p2.1.m1.1.1">𝒢</ci><apply id="A1.SS2.p2.1.m1.1.2.3.3.cmml" xref="A1.SS2.p2.1.m1.1.2.3.3"><times id="A1.SS2.p2.1.m1.1.2.3.3.1.cmml" xref="A1.SS2.p2.1.m1.1.2.3.3.1"></times><ci id="A1.SS2.p2.1.m1.1.2.3.3.2.cmml" xref="A1.SS2.p2.1.m1.1.2.3.3.2">𝑖</ci><ci id="A1.SS2.p2.1.m1.1.2.3.3.3.cmml" xref="A1.SS2.p2.1.m1.1.2.3.3.3">𝑗</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p2.1.m1.1c">\mathbf{M}_{\alpha}(\mathcal{G})_{ij}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p2.1.m1.1d">bold_M start_POSTSUBSCRIPT italic_α end_POSTSUBSCRIPT ( caligraphic_G ) start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT</annotation></semantics></math>.
We do so by taking</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equation ltx_eqn_table" id="A1.E16">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\widehat{\mathbf{M}}_{\alpha ij}\coloneqq\widehat{\phi}_{\mathcal{G}}(v_{i})^{%
\top}\widehat{\phi}_{\mathcal{G}}(v_{j})=\frac{1}{n^{2}}\sum_{k_{1}=1}^{n}\sum%
_{k_{2}=1}^{n}\psi(\omega_{k_{1}}^{(i)})^{\top}\psi(\omega_{k_{2}}^{(j)})" class="ltx_Math" display="block" id="A1.E16.m1.6"><semantics id="A1.E16.m1.6a"><mrow id="A1.E16.m1.6.6" xref="A1.E16.m1.6.6.cmml"><msub id="A1.E16.m1.6.6.6" xref="A1.E16.m1.6.6.6.cmml"><mover accent="true" id="A1.E16.m1.6.6.6.2" xref="A1.E16.m1.6.6.6.2.cmml"><mi id="A1.E16.m1.6.6.6.2.2" xref="A1.E16.m1.6.6.6.2.2.cmml">𝐌</mi><mo id="A1.E16.m1.6.6.6.2.1" xref="A1.E16.m1.6.6.6.2.1.cmml">^</mo></mover><mrow id="A1.E16.m1.6.6.6.3" xref="A1.E16.m1.6.6.6.3.cmml"><mi id="A1.E16.m1.6.6.6.3.2" xref="A1.E16.m1.6.6.6.3.2.cmml">α</mi><mo id="A1.E16.m1.6.6.6.3.1" xref="A1.E16.m1.6.6.6.3.1.cmml">⁢</mo><mi id="A1.E16.m1.6.6.6.3.3" xref="A1.E16.m1.6.6.6.3.3.cmml">i</mi><mo id="A1.E16.m1.6.6.6.3.1a" xref="A1.E16.m1.6.6.6.3.1.cmml">⁢</mo><mi id="A1.E16.m1.6.6.6.3.4" xref="A1.E16.m1.6.6.6.3.4.cmml">j</mi></mrow></msub><mo id="A1.E16.m1.6.6.7" xref="A1.E16.m1.6.6.7.cmml">≔</mo><mrow id="A1.E16.m1.4.4.2" xref="A1.E16.m1.4.4.2.cmml"><msub id="A1.E16.m1.4.4.2.4" xref="A1.E16.m1.4.4.2.4.cmml"><mover accent="true" id="A1.E16.m1.4.4.2.4.2" xref="A1.E16.m1.4.4.2.4.2.cmml"><mi id="A1.E16.m1.4.4.2.4.2.2" xref="A1.E16.m1.4.4.2.4.2.2.cmml">ϕ</mi><mo id="A1.E16.m1.4.4.2.4.2.1" xref="A1.E16.m1.4.4.2.4.2.1.cmml">^</mo></mover><mi class="ltx_font_mathcaligraphic" id="A1.E16.m1.4.4.2.4.3" xref="A1.E16.m1.4.4.2.4.3.cmml">𝒢</mi></msub><mo id="A1.E16.m1.4.4.2.3" xref="A1.E16.m1.4.4.2.3.cmml">⁢</mo><msup id="A1.E16.m1.3.3.1.1" xref="A1.E16.m1.3.3.1.1.cmml"><mrow id="A1.E16.m1.3.3.1.1.1.1" xref="A1.E16.m1.3.3.1.1.1.1.1.cmml"><mo id="A1.E16.m1.3.3.1.1.1.1.2" stretchy="false" xref="A1.E16.m1.3.3.1.1.1.1.1.cmml">(</mo><msub id="A1.E16.m1.3.3.1.1.1.1.1" xref="A1.E16.m1.3.3.1.1.1.1.1.cmml"><mi id="A1.E16.m1.3.3.1.1.1.1.1.2" xref="A1.E16.m1.3.3.1.1.1.1.1.2.cmml">v</mi><mi id="A1.E16.m1.3.3.1.1.1.1.1.3" xref="A1.E16.m1.3.3.1.1.1.1.1.3.cmml">i</mi></msub><mo id="A1.E16.m1.3.3.1.1.1.1.3" stretchy="false" xref="A1.E16.m1.3.3.1.1.1.1.1.cmml">)</mo></mrow><mo id="A1.E16.m1.3.3.1.1.3" xref="A1.E16.m1.3.3.1.1.3.cmml">⊤</mo></msup><mo id="A1.E16.m1.4.4.2.3a" xref="A1.E16.m1.4.4.2.3.cmml">⁢</mo><msub id="A1.E16.m1.4.4.2.5" xref="A1.E16.m1.4.4.2.5.cmml"><mover accent="true" id="A1.E16.m1.4.4.2.5.2" xref="A1.E16.m1.4.4.2.5.2.cmml"><mi id="A1.E16.m1.4.4.2.5.2.2" xref="A1.E16.m1.4.4.2.5.2.2.cmml">ϕ</mi><mo id="A1.E16.m1.4.4.2.5.2.1" xref="A1.E16.m1.4.4.2.5.2.1.cmml">^</mo></mover><mi class="ltx_font_mathcaligraphic" id="A1.E16.m1.4.4.2.5.3" xref="A1.E16.m1.4.4.2.5.3.cmml">𝒢</mi></msub><mo id="A1.E16.m1.4.4.2.3b" xref="A1.E16.m1.4.4.2.3.cmml">⁢</mo><mrow id="A1.E16.m1.4.4.2.2.1" xref="A1.E16.m1.4.4.2.2.1.1.cmml"><mo id="A1.E16.m1.4.4.2.2.1.2" stretchy="false" xref="A1.E16.m1.4.4.2.2.1.1.cmml">(</mo><msub id="A1.E16.m1.4.4.2.2.1.1" xref="A1.E16.m1.4.4.2.2.1.1.cmml"><mi id="A1.E16.m1.4.4.2.2.1.1.2" xref="A1.E16.m1.4.4.2.2.1.1.2.cmml">v</mi><mi id="A1.E16.m1.4.4.2.2.1.1.3" xref="A1.E16.m1.4.4.2.2.1.1.3.cmml">j</mi></msub><mo id="A1.E16.m1.4.4.2.2.1.3" stretchy="false" xref="A1.E16.m1.4.4.2.2.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E16.m1.6.6.8" xref="A1.E16.m1.6.6.8.cmml">=</mo><mrow id="A1.E16.m1.6.6.4" xref="A1.E16.m1.6.6.4.cmml"><mfrac id="A1.E16.m1.6.6.4.4" xref="A1.E16.m1.6.6.4.4.cmml"><mn id="A1.E16.m1.6.6.4.4.2" xref="A1.E16.m1.6.6.4.4.2.cmml">1</mn><msup id="A1.E16.m1.6.6.4.4.3" xref="A1.E16.m1.6.6.4.4.3.cmml"><mi id="A1.E16.m1.6.6.4.4.3.2" xref="A1.E16.m1.6.6.4.4.3.2.cmml">n</mi><mn id="A1.E16.m1.6.6.4.4.3.3" xref="A1.E16.m1.6.6.4.4.3.3.cmml">2</mn></msup></mfrac><mo id="A1.E16.m1.6.6.4.3" xref="A1.E16.m1.6.6.4.3.cmml">⁢</mo><mrow id="A1.E16.m1.6.6.4.2" xref="A1.E16.m1.6.6.4.2.cmml"><munderover id="A1.E16.m1.6.6.4.2.3" xref="A1.E16.m1.6.6.4.2.3.cmml"><mo id="A1.E16.m1.6.6.4.2.3.2.2" movablelimits="false" rspace="0em" xref="A1.E16.m1.6.6.4.2.3.2.2.cmml">∑</mo><mrow id="A1.E16.m1.6.6.4.2.3.2.3" xref="A1.E16.m1.6.6.4.2.3.2.3.cmml"><msub id="A1.E16.m1.6.6.4.2.3.2.3.2" xref="A1.E16.m1.6.6.4.2.3.2.3.2.cmml"><mi id="A1.E16.m1.6.6.4.2.3.2.3.2.2" xref="A1.E16.m1.6.6.4.2.3.2.3.2.2.cmml">k</mi><mn id="A1.E16.m1.6.6.4.2.3.2.3.2.3" xref="A1.E16.m1.6.6.4.2.3.2.3.2.3.cmml">1</mn></msub><mo id="A1.E16.m1.6.6.4.2.3.2.3.1" xref="A1.E16.m1.6.6.4.2.3.2.3.1.cmml">=</mo><mn id="A1.E16.m1.6.6.4.2.3.2.3.3" xref="A1.E16.m1.6.6.4.2.3.2.3.3.cmml">1</mn></mrow><mi id="A1.E16.m1.6.6.4.2.3.3" xref="A1.E16.m1.6.6.4.2.3.3.cmml">n</mi></munderover><mrow id="A1.E16.m1.6.6.4.2.2" xref="A1.E16.m1.6.6.4.2.2.cmml"><munderover id="A1.E16.m1.6.6.4.2.2.3" xref="A1.E16.m1.6.6.4.2.2.3.cmml"><mo id="A1.E16.m1.6.6.4.2.2.3.2.2" movablelimits="false" xref="A1.E16.m1.6.6.4.2.2.3.2.2.cmml">∑</mo><mrow id="A1.E16.m1.6.6.4.2.2.3.2.3" xref="A1.E16.m1.6.6.4.2.2.3.2.3.cmml"><msub id="A1.E16.m1.6.6.4.2.2.3.2.3.2" xref="A1.E16.m1.6.6.4.2.2.3.2.3.2.cmml"><mi id="A1.E16.m1.6.6.4.2.2.3.2.3.2.2" xref="A1.E16.m1.6.6.4.2.2.3.2.3.2.2.cmml">k</mi><mn id="A1.E16.m1.6.6.4.2.2.3.2.3.2.3" xref="A1.E16.m1.6.6.4.2.2.3.2.3.2.3.cmml">2</mn></msub><mo id="A1.E16.m1.6.6.4.2.2.3.2.3.1" xref="A1.E16.m1.6.6.4.2.2.3.2.3.1.cmml">=</mo><mn id="A1.E16.m1.6.6.4.2.2.3.2.3.3" xref="A1.E16.m1.6.6.4.2.2.3.2.3.3.cmml">1</mn></mrow><mi id="A1.E16.m1.6.6.4.2.2.3.3" xref="A1.E16.m1.6.6.4.2.2.3.3.cmml">n</mi></munderover><mrow id="A1.E16.m1.6.6.4.2.2.2" xref="A1.E16.m1.6.6.4.2.2.2.cmml"><mi id="A1.E16.m1.6.6.4.2.2.2.4" xref="A1.E16.m1.6.6.4.2.2.2.4.cmml">ψ</mi><mo id="A1.E16.m1.6.6.4.2.2.2.3" xref="A1.E16.m1.6.6.4.2.2.2.3.cmml">⁢</mo><msup id="A1.E16.m1.5.5.3.1.1.1.1" xref="A1.E16.m1.5.5.3.1.1.1.1.cmml"><mrow id="A1.E16.m1.5.5.3.1.1.1.1.1.1" xref="A1.E16.m1.5.5.3.1.1.1.1.1.1.1.cmml"><mo id="A1.E16.m1.5.5.3.1.1.1.1.1.1.2" stretchy="false" xref="A1.E16.m1.5.5.3.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="A1.E16.m1.5.5.3.1.1.1.1.1.1.1" xref="A1.E16.m1.5.5.3.1.1.1.1.1.1.1.cmml"><mi id="A1.E16.m1.5.5.3.1.1.1.1.1.1.1.2.2" xref="A1.E16.m1.5.5.3.1.1.1.1.1.1.1.2.2.cmml">ω</mi><msub id="A1.E16.m1.5.5.3.1.1.1.1.1.1.1.2.3" xref="A1.E16.m1.5.5.3.1.1.1.1.1.1.1.2.3.cmml"><mi id="A1.E16.m1.5.5.3.1.1.1.1.1.1.1.2.3.2" xref="A1.E16.m1.5.5.3.1.1.1.1.1.1.1.2.3.2.cmml">k</mi><mn id="A1.E16.m1.5.5.3.1.1.1.1.1.1.1.2.3.3" xref="A1.E16.m1.5.5.3.1.1.1.1.1.1.1.2.3.3.cmml">1</mn></msub><mrow id="A1.E16.m1.1.1.1.3" xref="A1.E16.m1.5.5.3.1.1.1.1.1.1.1.cmml"><mo id="A1.E16.m1.1.1.1.3.1" stretchy="false" xref="A1.E16.m1.5.5.3.1.1.1.1.1.1.1.cmml">(</mo><mi id="A1.E16.m1.1.1.1.1" xref="A1.E16.m1.1.1.1.1.cmml">i</mi><mo id="A1.E16.m1.1.1.1.3.2" stretchy="false" xref="A1.E16.m1.5.5.3.1.1.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="A1.E16.m1.5.5.3.1.1.1.1.1.1.3" stretchy="false" xref="A1.E16.m1.5.5.3.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="A1.E16.m1.5.5.3.1.1.1.1.3" xref="A1.E16.m1.5.5.3.1.1.1.1.3.cmml">⊤</mo></msup><mo id="A1.E16.m1.6.6.4.2.2.2.3a" xref="A1.E16.m1.6.6.4.2.2.2.3.cmml">⁢</mo><mi id="A1.E16.m1.6.6.4.2.2.2.5" xref="A1.E16.m1.6.6.4.2.2.2.5.cmml">ψ</mi><mo id="A1.E16.m1.6.6.4.2.2.2.3b" xref="A1.E16.m1.6.6.4.2.2.2.3.cmml">⁢</mo><mrow id="A1.E16.m1.6.6.4.2.2.2.2.1" xref="A1.E16.m1.6.6.4.2.2.2.2.1.1.cmml"><mo id="A1.E16.m1.6.6.4.2.2.2.2.1.2" stretchy="false" xref="A1.E16.m1.6.6.4.2.2.2.2.1.1.cmml">(</mo><msubsup id="A1.E16.m1.6.6.4.2.2.2.2.1.1" xref="A1.E16.m1.6.6.4.2.2.2.2.1.1.cmml"><mi id="A1.E16.m1.6.6.4.2.2.2.2.1.1.2.2" xref="A1.E16.m1.6.6.4.2.2.2.2.1.1.2.2.cmml">ω</mi><msub id="A1.E16.m1.6.6.4.2.2.2.2.1.1.2.3" xref="A1.E16.m1.6.6.4.2.2.2.2.1.1.2.3.cmml"><mi id="A1.E16.m1.6.6.4.2.2.2.2.1.1.2.3.2" xref="A1.E16.m1.6.6.4.2.2.2.2.1.1.2.3.2.cmml">k</mi><mn id="A1.E16.m1.6.6.4.2.2.2.2.1.1.2.3.3" xref="A1.E16.m1.6.6.4.2.2.2.2.1.1.2.3.3.cmml">2</mn></msub><mrow id="A1.E16.m1.2.2.1.3" xref="A1.E16.m1.6.6.4.2.2.2.2.1.1.cmml"><mo id="A1.E16.m1.2.2.1.3.1" stretchy="false" xref="A1.E16.m1.6.6.4.2.2.2.2.1.1.cmml">(</mo><mi id="A1.E16.m1.2.2.1.1" xref="A1.E16.m1.2.2.1.1.cmml">j</mi><mo id="A1.E16.m1.2.2.1.3.2" stretchy="false" xref="A1.E16.m1.6.6.4.2.2.2.2.1.1.cmml">)</mo></mrow></msubsup><mo id="A1.E16.m1.6.6.4.2.2.2.2.1.3" stretchy="false" xref="A1.E16.m1.6.6.4.2.2.2.2.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E16.m1.6b"><apply id="A1.E16.m1.6.6.cmml" xref="A1.E16.m1.6.6"><and id="A1.E16.m1.6.6a.cmml" xref="A1.E16.m1.6.6"></and><apply id="A1.E16.m1.6.6b.cmml" xref="A1.E16.m1.6.6"><ci id="A1.E16.m1.6.6.7.cmml" xref="A1.E16.m1.6.6.7">≔</ci><apply id="A1.E16.m1.6.6.6.cmml" xref="A1.E16.m1.6.6.6"><csymbol cd="ambiguous" id="A1.E16.m1.6.6.6.1.cmml" xref="A1.E16.m1.6.6.6">subscript</csymbol><apply id="A1.E16.m1.6.6.6.2.cmml" xref="A1.E16.m1.6.6.6.2"><ci id="A1.E16.m1.6.6.6.2.1.cmml" xref="A1.E16.m1.6.6.6.2.1">^</ci><ci id="A1.E16.m1.6.6.6.2.2.cmml" xref="A1.E16.m1.6.6.6.2.2">𝐌</ci></apply><apply id="A1.E16.m1.6.6.6.3.cmml" xref="A1.E16.m1.6.6.6.3"><times id="A1.E16.m1.6.6.6.3.1.cmml" xref="A1.E16.m1.6.6.6.3.1"></times><ci id="A1.E16.m1.6.6.6.3.2.cmml" xref="A1.E16.m1.6.6.6.3.2">𝛼</ci><ci id="A1.E16.m1.6.6.6.3.3.cmml" xref="A1.E16.m1.6.6.6.3.3">𝑖</ci><ci id="A1.E16.m1.6.6.6.3.4.cmml" xref="A1.E16.m1.6.6.6.3.4">𝑗</ci></apply></apply><apply id="A1.E16.m1.4.4.2.cmml" xref="A1.E16.m1.4.4.2"><times id="A1.E16.m1.4.4.2.3.cmml" xref="A1.E16.m1.4.4.2.3"></times><apply id="A1.E16.m1.4.4.2.4.cmml" xref="A1.E16.m1.4.4.2.4"><csymbol cd="ambiguous" id="A1.E16.m1.4.4.2.4.1.cmml" xref="A1.E16.m1.4.4.2.4">subscript</csymbol><apply id="A1.E16.m1.4.4.2.4.2.cmml" xref="A1.E16.m1.4.4.2.4.2"><ci id="A1.E16.m1.4.4.2.4.2.1.cmml" xref="A1.E16.m1.4.4.2.4.2.1">^</ci><ci id="A1.E16.m1.4.4.2.4.2.2.cmml" xref="A1.E16.m1.4.4.2.4.2.2">italic-ϕ</ci></apply><ci id="A1.E16.m1.4.4.2.4.3.cmml" xref="A1.E16.m1.4.4.2.4.3">𝒢</ci></apply><apply id="A1.E16.m1.3.3.1.1.cmml" xref="A1.E16.m1.3.3.1.1"><csymbol cd="ambiguous" id="A1.E16.m1.3.3.1.1.2.cmml" xref="A1.E16.m1.3.3.1.1">superscript</csymbol><apply id="A1.E16.m1.3.3.1.1.1.1.1.cmml" xref="A1.E16.m1.3.3.1.1.1.1"><csymbol cd="ambiguous" id="A1.E16.m1.3.3.1.1.1.1.1.1.cmml" xref="A1.E16.m1.3.3.1.1.1.1">subscript</csymbol><ci id="A1.E16.m1.3.3.1.1.1.1.1.2.cmml" xref="A1.E16.m1.3.3.1.1.1.1.1.2">𝑣</ci><ci id="A1.E16.m1.3.3.1.1.1.1.1.3.cmml" xref="A1.E16.m1.3.3.1.1.1.1.1.3">𝑖</ci></apply><csymbol cd="latexml" id="A1.E16.m1.3.3.1.1.3.cmml" xref="A1.E16.m1.3.3.1.1.3">top</csymbol></apply><apply id="A1.E16.m1.4.4.2.5.cmml" xref="A1.E16.m1.4.4.2.5"><csymbol cd="ambiguous" id="A1.E16.m1.4.4.2.5.1.cmml" xref="A1.E16.m1.4.4.2.5">subscript</csymbol><apply id="A1.E16.m1.4.4.2.5.2.cmml" xref="A1.E16.m1.4.4.2.5.2"><ci id="A1.E16.m1.4.4.2.5.2.1.cmml" xref="A1.E16.m1.4.4.2.5.2.1">^</ci><ci id="A1.E16.m1.4.4.2.5.2.2.cmml" xref="A1.E16.m1.4.4.2.5.2.2">italic-ϕ</ci></apply><ci id="A1.E16.m1.4.4.2.5.3.cmml" xref="A1.E16.m1.4.4.2.5.3">𝒢</ci></apply><apply id="A1.E16.m1.4.4.2.2.1.1.cmml" xref="A1.E16.m1.4.4.2.2.1"><csymbol cd="ambiguous" id="A1.E16.m1.4.4.2.2.1.1.1.cmml" xref="A1.E16.m1.4.4.2.2.1">subscript</csymbol><ci id="A1.E16.m1.4.4.2.2.1.1.2.cmml" xref="A1.E16.m1.4.4.2.2.1.1.2">𝑣</ci><ci id="A1.E16.m1.4.4.2.2.1.1.3.cmml" xref="A1.E16.m1.4.4.2.2.1.1.3">𝑗</ci></apply></apply></apply><apply id="A1.E16.m1.6.6c.cmml" xref="A1.E16.m1.6.6"><eq id="A1.E16.m1.6.6.8.cmml" xref="A1.E16.m1.6.6.8"></eq><share href="https://arxiv.org/html/2410.03462v1#A1.E16.m1.4.4.2.cmml" id="A1.E16.m1.6.6d.cmml" xref="A1.E16.m1.6.6"></share><apply id="A1.E16.m1.6.6.4.cmml" xref="A1.E16.m1.6.6.4"><times id="A1.E16.m1.6.6.4.3.cmml" xref="A1.E16.m1.6.6.4.3"></times><apply id="A1.E16.m1.6.6.4.4.cmml" xref="A1.E16.m1.6.6.4.4"><divide id="A1.E16.m1.6.6.4.4.1.cmml" xref="A1.E16.m1.6.6.4.4"></divide><cn id="A1.E16.m1.6.6.4.4.2.cmml" type="integer" xref="A1.E16.m1.6.6.4.4.2">1</cn><apply id="A1.E16.m1.6.6.4.4.3.cmml" xref="A1.E16.m1.6.6.4.4.3"><csymbol cd="ambiguous" id="A1.E16.m1.6.6.4.4.3.1.cmml" xref="A1.E16.m1.6.6.4.4.3">superscript</csymbol><ci id="A1.E16.m1.6.6.4.4.3.2.cmml" xref="A1.E16.m1.6.6.4.4.3.2">𝑛</ci><cn id="A1.E16.m1.6.6.4.4.3.3.cmml" type="integer" xref="A1.E16.m1.6.6.4.4.3.3">2</cn></apply></apply><apply id="A1.E16.m1.6.6.4.2.cmml" xref="A1.E16.m1.6.6.4.2"><apply id="A1.E16.m1.6.6.4.2.3.cmml" xref="A1.E16.m1.6.6.4.2.3"><csymbol cd="ambiguous" id="A1.E16.m1.6.6.4.2.3.1.cmml" xref="A1.E16.m1.6.6.4.2.3">superscript</csymbol><apply id="A1.E16.m1.6.6.4.2.3.2.cmml" xref="A1.E16.m1.6.6.4.2.3"><csymbol cd="ambiguous" id="A1.E16.m1.6.6.4.2.3.2.1.cmml" xref="A1.E16.m1.6.6.4.2.3">subscript</csymbol><sum id="A1.E16.m1.6.6.4.2.3.2.2.cmml" xref="A1.E16.m1.6.6.4.2.3.2.2"></sum><apply id="A1.E16.m1.6.6.4.2.3.2.3.cmml" xref="A1.E16.m1.6.6.4.2.3.2.3"><eq id="A1.E16.m1.6.6.4.2.3.2.3.1.cmml" xref="A1.E16.m1.6.6.4.2.3.2.3.1"></eq><apply id="A1.E16.m1.6.6.4.2.3.2.3.2.cmml" xref="A1.E16.m1.6.6.4.2.3.2.3.2"><csymbol cd="ambiguous" id="A1.E16.m1.6.6.4.2.3.2.3.2.1.cmml" xref="A1.E16.m1.6.6.4.2.3.2.3.2">subscript</csymbol><ci id="A1.E16.m1.6.6.4.2.3.2.3.2.2.cmml" xref="A1.E16.m1.6.6.4.2.3.2.3.2.2">𝑘</ci><cn id="A1.E16.m1.6.6.4.2.3.2.3.2.3.cmml" type="integer" xref="A1.E16.m1.6.6.4.2.3.2.3.2.3">1</cn></apply><cn id="A1.E16.m1.6.6.4.2.3.2.3.3.cmml" type="integer" xref="A1.E16.m1.6.6.4.2.3.2.3.3">1</cn></apply></apply><ci id="A1.E16.m1.6.6.4.2.3.3.cmml" xref="A1.E16.m1.6.6.4.2.3.3">𝑛</ci></apply><apply id="A1.E16.m1.6.6.4.2.2.cmml" xref="A1.E16.m1.6.6.4.2.2"><apply id="A1.E16.m1.6.6.4.2.2.3.cmml" xref="A1.E16.m1.6.6.4.2.2.3"><csymbol cd="ambiguous" id="A1.E16.m1.6.6.4.2.2.3.1.cmml" xref="A1.E16.m1.6.6.4.2.2.3">superscript</csymbol><apply id="A1.E16.m1.6.6.4.2.2.3.2.cmml" xref="A1.E16.m1.6.6.4.2.2.3"><csymbol cd="ambiguous" id="A1.E16.m1.6.6.4.2.2.3.2.1.cmml" xref="A1.E16.m1.6.6.4.2.2.3">subscript</csymbol><sum id="A1.E16.m1.6.6.4.2.2.3.2.2.cmml" xref="A1.E16.m1.6.6.4.2.2.3.2.2"></sum><apply id="A1.E16.m1.6.6.4.2.2.3.2.3.cmml" xref="A1.E16.m1.6.6.4.2.2.3.2.3"><eq id="A1.E16.m1.6.6.4.2.2.3.2.3.1.cmml" xref="A1.E16.m1.6.6.4.2.2.3.2.3.1"></eq><apply id="A1.E16.m1.6.6.4.2.2.3.2.3.2.cmml" xref="A1.E16.m1.6.6.4.2.2.3.2.3.2"><csymbol cd="ambiguous" id="A1.E16.m1.6.6.4.2.2.3.2.3.2.1.cmml" xref="A1.E16.m1.6.6.4.2.2.3.2.3.2">subscript</csymbol><ci id="A1.E16.m1.6.6.4.2.2.3.2.3.2.2.cmml" xref="A1.E16.m1.6.6.4.2.2.3.2.3.2.2">𝑘</ci><cn id="A1.E16.m1.6.6.4.2.2.3.2.3.2.3.cmml" type="integer" xref="A1.E16.m1.6.6.4.2.2.3.2.3.2.3">2</cn></apply><cn id="A1.E16.m1.6.6.4.2.2.3.2.3.3.cmml" type="integer" xref="A1.E16.m1.6.6.4.2.2.3.2.3.3">1</cn></apply></apply><ci id="A1.E16.m1.6.6.4.2.2.3.3.cmml" xref="A1.E16.m1.6.6.4.2.2.3.3">𝑛</ci></apply><apply id="A1.E16.m1.6.6.4.2.2.2.cmml" xref="A1.E16.m1.6.6.4.2.2.2"><times id="A1.E16.m1.6.6.4.2.2.2.3.cmml" xref="A1.E16.m1.6.6.4.2.2.2.3"></times><ci id="A1.E16.m1.6.6.4.2.2.2.4.cmml" xref="A1.E16.m1.6.6.4.2.2.2.4">𝜓</ci><apply id="A1.E16.m1.5.5.3.1.1.1.1.cmml" xref="A1.E16.m1.5.5.3.1.1.1.1"><csymbol cd="ambiguous" id="A1.E16.m1.5.5.3.1.1.1.1.2.cmml" xref="A1.E16.m1.5.5.3.1.1.1.1">superscript</csymbol><apply id="A1.E16.m1.5.5.3.1.1.1.1.1.1.1.cmml" xref="A1.E16.m1.5.5.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E16.m1.5.5.3.1.1.1.1.1.1.1.1.cmml" xref="A1.E16.m1.5.5.3.1.1.1.1.1.1">superscript</csymbol><apply id="A1.E16.m1.5.5.3.1.1.1.1.1.1.1.2.cmml" xref="A1.E16.m1.5.5.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E16.m1.5.5.3.1.1.1.1.1.1.1.2.1.cmml" xref="A1.E16.m1.5.5.3.1.1.1.1.1.1">subscript</csymbol><ci id="A1.E16.m1.5.5.3.1.1.1.1.1.1.1.2.2.cmml" xref="A1.E16.m1.5.5.3.1.1.1.1.1.1.1.2.2">𝜔</ci><apply id="A1.E16.m1.5.5.3.1.1.1.1.1.1.1.2.3.cmml" xref="A1.E16.m1.5.5.3.1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="A1.E16.m1.5.5.3.1.1.1.1.1.1.1.2.3.1.cmml" xref="A1.E16.m1.5.5.3.1.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="A1.E16.m1.5.5.3.1.1.1.1.1.1.1.2.3.2.cmml" xref="A1.E16.m1.5.5.3.1.1.1.1.1.1.1.2.3.2">𝑘</ci><cn id="A1.E16.m1.5.5.3.1.1.1.1.1.1.1.2.3.3.cmml" type="integer" xref="A1.E16.m1.5.5.3.1.1.1.1.1.1.1.2.3.3">1</cn></apply></apply><ci id="A1.E16.m1.1.1.1.1.cmml" xref="A1.E16.m1.1.1.1.1">𝑖</ci></apply><csymbol cd="latexml" id="A1.E16.m1.5.5.3.1.1.1.1.3.cmml" xref="A1.E16.m1.5.5.3.1.1.1.1.3">top</csymbol></apply><ci id="A1.E16.m1.6.6.4.2.2.2.5.cmml" xref="A1.E16.m1.6.6.4.2.2.2.5">𝜓</ci><apply id="A1.E16.m1.6.6.4.2.2.2.2.1.1.cmml" xref="A1.E16.m1.6.6.4.2.2.2.2.1"><csymbol cd="ambiguous" id="A1.E16.m1.6.6.4.2.2.2.2.1.1.1.cmml" xref="A1.E16.m1.6.6.4.2.2.2.2.1">superscript</csymbol><apply id="A1.E16.m1.6.6.4.2.2.2.2.1.1.2.cmml" xref="A1.E16.m1.6.6.4.2.2.2.2.1"><csymbol cd="ambiguous" id="A1.E16.m1.6.6.4.2.2.2.2.1.1.2.1.cmml" xref="A1.E16.m1.6.6.4.2.2.2.2.1">subscript</csymbol><ci id="A1.E16.m1.6.6.4.2.2.2.2.1.1.2.2.cmml" xref="A1.E16.m1.6.6.4.2.2.2.2.1.1.2.2">𝜔</ci><apply id="A1.E16.m1.6.6.4.2.2.2.2.1.1.2.3.cmml" xref="A1.E16.m1.6.6.4.2.2.2.2.1.1.2.3"><csymbol cd="ambiguous" id="A1.E16.m1.6.6.4.2.2.2.2.1.1.2.3.1.cmml" xref="A1.E16.m1.6.6.4.2.2.2.2.1.1.2.3">subscript</csymbol><ci id="A1.E16.m1.6.6.4.2.2.2.2.1.1.2.3.2.cmml" xref="A1.E16.m1.6.6.4.2.2.2.2.1.1.2.3.2">𝑘</ci><cn id="A1.E16.m1.6.6.4.2.2.2.2.1.1.2.3.3.cmml" type="integer" xref="A1.E16.m1.6.6.4.2.2.2.2.1.1.2.3.3">2</cn></apply></apply><ci id="A1.E16.m1.2.2.1.1.cmml" xref="A1.E16.m1.2.2.1.1">𝑗</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E16.m1.6c">\widehat{\mathbf{M}}_{\alpha ij}\coloneqq\widehat{\phi}_{\mathcal{G}}(v_{i})^{%
\top}\widehat{\phi}_{\mathcal{G}}(v_{j})=\frac{1}{n^{2}}\sum_{k_{1}=1}^{n}\sum%
_{k_{2}=1}^{n}\psi(\omega_{k_{1}}^{(i)})^{\top}\psi(\omega_{k_{2}}^{(j)})</annotation><annotation encoding="application/x-llamapun" id="A1.E16.m1.6d">over^ start_ARG bold_M end_ARG start_POSTSUBSCRIPT italic_α italic_i italic_j end_POSTSUBSCRIPT ≔ over^ start_ARG italic_ϕ end_ARG start_POSTSUBSCRIPT caligraphic_G end_POSTSUBSCRIPT ( italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT over^ start_ARG italic_ϕ end_ARG start_POSTSUBSCRIPT caligraphic_G end_POSTSUBSCRIPT ( italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) = divide start_ARG 1 end_ARG start_ARG italic_n start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG ∑ start_POSTSUBSCRIPT italic_k start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT ∑ start_POSTSUBSCRIPT italic_k start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT italic_ψ ( italic_ω start_POSTSUBSCRIPT italic_k start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT italic_ψ ( italic_ω start_POSTSUBSCRIPT italic_k start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_j ) end_POSTSUPERSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(16)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A1.SS2.p2.3">where <math alttext="\mathbb{E}(\widehat{\mathbf{M}}_{\alpha ij})={\mathbf{M}}_{\alpha ij}" class="ltx_Math" display="inline" id="A1.SS2.p2.2.m1.1"><semantics id="A1.SS2.p2.2.m1.1a"><mrow id="A1.SS2.p2.2.m1.1.1" xref="A1.SS2.p2.2.m1.1.1.cmml"><mrow id="A1.SS2.p2.2.m1.1.1.1" xref="A1.SS2.p2.2.m1.1.1.1.cmml"><mi id="A1.SS2.p2.2.m1.1.1.1.3" xref="A1.SS2.p2.2.m1.1.1.1.3.cmml">𝔼</mi><mo id="A1.SS2.p2.2.m1.1.1.1.2" xref="A1.SS2.p2.2.m1.1.1.1.2.cmml">⁢</mo><mrow id="A1.SS2.p2.2.m1.1.1.1.1.1" xref="A1.SS2.p2.2.m1.1.1.1.1.1.1.cmml"><mo id="A1.SS2.p2.2.m1.1.1.1.1.1.2" stretchy="false" xref="A1.SS2.p2.2.m1.1.1.1.1.1.1.cmml">(</mo><msub id="A1.SS2.p2.2.m1.1.1.1.1.1.1" xref="A1.SS2.p2.2.m1.1.1.1.1.1.1.cmml"><mover accent="true" id="A1.SS2.p2.2.m1.1.1.1.1.1.1.2" xref="A1.SS2.p2.2.m1.1.1.1.1.1.1.2.cmml"><mi id="A1.SS2.p2.2.m1.1.1.1.1.1.1.2.2" xref="A1.SS2.p2.2.m1.1.1.1.1.1.1.2.2.cmml">𝐌</mi><mo id="A1.SS2.p2.2.m1.1.1.1.1.1.1.2.1" xref="A1.SS2.p2.2.m1.1.1.1.1.1.1.2.1.cmml">^</mo></mover><mrow id="A1.SS2.p2.2.m1.1.1.1.1.1.1.3" xref="A1.SS2.p2.2.m1.1.1.1.1.1.1.3.cmml"><mi id="A1.SS2.p2.2.m1.1.1.1.1.1.1.3.2" xref="A1.SS2.p2.2.m1.1.1.1.1.1.1.3.2.cmml">α</mi><mo id="A1.SS2.p2.2.m1.1.1.1.1.1.1.3.1" xref="A1.SS2.p2.2.m1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="A1.SS2.p2.2.m1.1.1.1.1.1.1.3.3" xref="A1.SS2.p2.2.m1.1.1.1.1.1.1.3.3.cmml">i</mi><mo id="A1.SS2.p2.2.m1.1.1.1.1.1.1.3.1a" xref="A1.SS2.p2.2.m1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="A1.SS2.p2.2.m1.1.1.1.1.1.1.3.4" xref="A1.SS2.p2.2.m1.1.1.1.1.1.1.3.4.cmml">j</mi></mrow></msub><mo id="A1.SS2.p2.2.m1.1.1.1.1.1.3" stretchy="false" xref="A1.SS2.p2.2.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.SS2.p2.2.m1.1.1.2" xref="A1.SS2.p2.2.m1.1.1.2.cmml">=</mo><msub id="A1.SS2.p2.2.m1.1.1.3" xref="A1.SS2.p2.2.m1.1.1.3.cmml"><mi id="A1.SS2.p2.2.m1.1.1.3.2" xref="A1.SS2.p2.2.m1.1.1.3.2.cmml">𝐌</mi><mrow id="A1.SS2.p2.2.m1.1.1.3.3" xref="A1.SS2.p2.2.m1.1.1.3.3.cmml"><mi id="A1.SS2.p2.2.m1.1.1.3.3.2" xref="A1.SS2.p2.2.m1.1.1.3.3.2.cmml">α</mi><mo id="A1.SS2.p2.2.m1.1.1.3.3.1" xref="A1.SS2.p2.2.m1.1.1.3.3.1.cmml">⁢</mo><mi id="A1.SS2.p2.2.m1.1.1.3.3.3" xref="A1.SS2.p2.2.m1.1.1.3.3.3.cmml">i</mi><mo id="A1.SS2.p2.2.m1.1.1.3.3.1a" xref="A1.SS2.p2.2.m1.1.1.3.3.1.cmml">⁢</mo><mi id="A1.SS2.p2.2.m1.1.1.3.3.4" xref="A1.SS2.p2.2.m1.1.1.3.3.4.cmml">j</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p2.2.m1.1b"><apply id="A1.SS2.p2.2.m1.1.1.cmml" xref="A1.SS2.p2.2.m1.1.1"><eq id="A1.SS2.p2.2.m1.1.1.2.cmml" xref="A1.SS2.p2.2.m1.1.1.2"></eq><apply id="A1.SS2.p2.2.m1.1.1.1.cmml" xref="A1.SS2.p2.2.m1.1.1.1"><times id="A1.SS2.p2.2.m1.1.1.1.2.cmml" xref="A1.SS2.p2.2.m1.1.1.1.2"></times><ci id="A1.SS2.p2.2.m1.1.1.1.3.cmml" xref="A1.SS2.p2.2.m1.1.1.1.3">𝔼</ci><apply id="A1.SS2.p2.2.m1.1.1.1.1.1.1.cmml" xref="A1.SS2.p2.2.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.SS2.p2.2.m1.1.1.1.1.1.1.1.cmml" xref="A1.SS2.p2.2.m1.1.1.1.1.1">subscript</csymbol><apply id="A1.SS2.p2.2.m1.1.1.1.1.1.1.2.cmml" xref="A1.SS2.p2.2.m1.1.1.1.1.1.1.2"><ci id="A1.SS2.p2.2.m1.1.1.1.1.1.1.2.1.cmml" xref="A1.SS2.p2.2.m1.1.1.1.1.1.1.2.1">^</ci><ci id="A1.SS2.p2.2.m1.1.1.1.1.1.1.2.2.cmml" xref="A1.SS2.p2.2.m1.1.1.1.1.1.1.2.2">𝐌</ci></apply><apply id="A1.SS2.p2.2.m1.1.1.1.1.1.1.3.cmml" xref="A1.SS2.p2.2.m1.1.1.1.1.1.1.3"><times id="A1.SS2.p2.2.m1.1.1.1.1.1.1.3.1.cmml" xref="A1.SS2.p2.2.m1.1.1.1.1.1.1.3.1"></times><ci id="A1.SS2.p2.2.m1.1.1.1.1.1.1.3.2.cmml" xref="A1.SS2.p2.2.m1.1.1.1.1.1.1.3.2">𝛼</ci><ci id="A1.SS2.p2.2.m1.1.1.1.1.1.1.3.3.cmml" xref="A1.SS2.p2.2.m1.1.1.1.1.1.1.3.3">𝑖</ci><ci id="A1.SS2.p2.2.m1.1.1.1.1.1.1.3.4.cmml" xref="A1.SS2.p2.2.m1.1.1.1.1.1.1.3.4">𝑗</ci></apply></apply></apply><apply id="A1.SS2.p2.2.m1.1.1.3.cmml" xref="A1.SS2.p2.2.m1.1.1.3"><csymbol cd="ambiguous" id="A1.SS2.p2.2.m1.1.1.3.1.cmml" xref="A1.SS2.p2.2.m1.1.1.3">subscript</csymbol><ci id="A1.SS2.p2.2.m1.1.1.3.2.cmml" xref="A1.SS2.p2.2.m1.1.1.3.2">𝐌</ci><apply id="A1.SS2.p2.2.m1.1.1.3.3.cmml" xref="A1.SS2.p2.2.m1.1.1.3.3"><times id="A1.SS2.p2.2.m1.1.1.3.3.1.cmml" xref="A1.SS2.p2.2.m1.1.1.3.3.1"></times><ci id="A1.SS2.p2.2.m1.1.1.3.3.2.cmml" xref="A1.SS2.p2.2.m1.1.1.3.3.2">𝛼</ci><ci id="A1.SS2.p2.2.m1.1.1.3.3.3.cmml" xref="A1.SS2.p2.2.m1.1.1.3.3.3">𝑖</ci><ci id="A1.SS2.p2.2.m1.1.1.3.3.4.cmml" xref="A1.SS2.p2.2.m1.1.1.3.3.4">𝑗</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p2.2.m1.1c">\mathbb{E}(\widehat{\mathbf{M}}_{\alpha ij})={\mathbf{M}}_{\alpha ij}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p2.2.m1.1d">blackboard_E ( over^ start_ARG bold_M end_ARG start_POSTSUBSCRIPT italic_α italic_i italic_j end_POSTSUBSCRIPT ) = bold_M start_POSTSUBSCRIPT italic_α italic_i italic_j end_POSTSUBSCRIPT</annotation></semantics></math> since the estimate is unbiased.
We sample <math alttext="n" class="ltx_Math" display="inline" id="A1.SS2.p2.3.m2.1"><semantics id="A1.SS2.p2.3.m2.1a"><mi id="A1.SS2.p2.3.m2.1.1" xref="A1.SS2.p2.3.m2.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.p2.3.m2.1b"><ci id="A1.SS2.p2.3.m2.1.1.cmml" xref="A1.SS2.p2.3.m2.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p2.3.m2.1c">n</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p2.3.m2.1d">italic_n</annotation></semantics></math> independent random walks starting from every node of the graph.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="A1.SS2.p3">
<p class="ltx_p" id="A1.SS2.p3.2">Let us now consider a <em class="ltx_emph ltx_font_italic" id="A1.SS2.p3.2.1">single</em> pair of random walks from <math alttext="v_{i}" class="ltx_Math" display="inline" id="A1.SS2.p3.1.m1.1"><semantics id="A1.SS2.p3.1.m1.1a"><msub id="A1.SS2.p3.1.m1.1.1" xref="A1.SS2.p3.1.m1.1.1.cmml"><mi id="A1.SS2.p3.1.m1.1.1.2" xref="A1.SS2.p3.1.m1.1.1.2.cmml">v</mi><mi id="A1.SS2.p3.1.m1.1.1.3" xref="A1.SS2.p3.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS2.p3.1.m1.1b"><apply id="A1.SS2.p3.1.m1.1.1.cmml" xref="A1.SS2.p3.1.m1.1.1"><csymbol cd="ambiguous" id="A1.SS2.p3.1.m1.1.1.1.cmml" xref="A1.SS2.p3.1.m1.1.1">subscript</csymbol><ci id="A1.SS2.p3.1.m1.1.1.2.cmml" xref="A1.SS2.p3.1.m1.1.1.2">𝑣</ci><ci id="A1.SS2.p3.1.m1.1.1.3.cmml" xref="A1.SS2.p3.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p3.1.m1.1c">v_{i}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p3.1.m1.1d">italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="v_{j}" class="ltx_Math" display="inline" id="A1.SS2.p3.2.m2.1"><semantics id="A1.SS2.p3.2.m2.1a"><msub id="A1.SS2.p3.2.m2.1.1" xref="A1.SS2.p3.2.m2.1.1.cmml"><mi id="A1.SS2.p3.2.m2.1.1.2" xref="A1.SS2.p3.2.m2.1.1.2.cmml">v</mi><mi id="A1.SS2.p3.2.m2.1.1.3" xref="A1.SS2.p3.2.m2.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS2.p3.2.m2.1b"><apply id="A1.SS2.p3.2.m2.1.1.cmml" xref="A1.SS2.p3.2.m2.1.1"><csymbol cd="ambiguous" id="A1.SS2.p3.2.m2.1.1.1.cmml" xref="A1.SS2.p3.2.m2.1.1">subscript</csymbol><ci id="A1.SS2.p3.2.m2.1.1.2.cmml" xref="A1.SS2.p3.2.m2.1.1.2">𝑣</ci><ci id="A1.SS2.p3.2.m2.1.1.3.cmml" xref="A1.SS2.p3.2.m2.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p3.2.m2.1c">v_{j}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p3.2.m2.1d">italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> respectively.
Denote this by the random variable</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equation ltx_eqn_table" id="A1.E17">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="X_{k}\coloneqq(\omega_{k}^{(i)},\omega_{k}^{(j)})\in\Omega\times\Omega," class="ltx_Math" display="block" id="A1.E17.m1.3"><semantics id="A1.E17.m1.3a"><mrow id="A1.E17.m1.3.3.1" xref="A1.E17.m1.3.3.1.1.cmml"><mrow id="A1.E17.m1.3.3.1.1" xref="A1.E17.m1.3.3.1.1.cmml"><msub id="A1.E17.m1.3.3.1.1.4" xref="A1.E17.m1.3.3.1.1.4.cmml"><mi id="A1.E17.m1.3.3.1.1.4.2" xref="A1.E17.m1.3.3.1.1.4.2.cmml">X</mi><mi id="A1.E17.m1.3.3.1.1.4.3" xref="A1.E17.m1.3.3.1.1.4.3.cmml">k</mi></msub><mo id="A1.E17.m1.3.3.1.1.5" xref="A1.E17.m1.3.3.1.1.5.cmml">≔</mo><mrow id="A1.E17.m1.3.3.1.1.2.2" xref="A1.E17.m1.3.3.1.1.2.3.cmml"><mo id="A1.E17.m1.3.3.1.1.2.2.3" stretchy="false" xref="A1.E17.m1.3.3.1.1.2.3.cmml">(</mo><msubsup id="A1.E17.m1.3.3.1.1.1.1.1" xref="A1.E17.m1.3.3.1.1.1.1.1.cmml"><mi id="A1.E17.m1.3.3.1.1.1.1.1.2.2" xref="A1.E17.m1.3.3.1.1.1.1.1.2.2.cmml">ω</mi><mi id="A1.E17.m1.3.3.1.1.1.1.1.2.3" xref="A1.E17.m1.3.3.1.1.1.1.1.2.3.cmml">k</mi><mrow id="A1.E17.m1.1.1.1.3" xref="A1.E17.m1.3.3.1.1.1.1.1.cmml"><mo id="A1.E17.m1.1.1.1.3.1" stretchy="false" xref="A1.E17.m1.3.3.1.1.1.1.1.cmml">(</mo><mi id="A1.E17.m1.1.1.1.1" xref="A1.E17.m1.1.1.1.1.cmml">i</mi><mo id="A1.E17.m1.1.1.1.3.2" stretchy="false" xref="A1.E17.m1.3.3.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="A1.E17.m1.3.3.1.1.2.2.4" xref="A1.E17.m1.3.3.1.1.2.3.cmml">,</mo><msubsup id="A1.E17.m1.3.3.1.1.2.2.2" xref="A1.E17.m1.3.3.1.1.2.2.2.cmml"><mi id="A1.E17.m1.3.3.1.1.2.2.2.2.2" xref="A1.E17.m1.3.3.1.1.2.2.2.2.2.cmml">ω</mi><mi id="A1.E17.m1.3.3.1.1.2.2.2.2.3" xref="A1.E17.m1.3.3.1.1.2.2.2.2.3.cmml">k</mi><mrow id="A1.E17.m1.2.2.1.3" xref="A1.E17.m1.3.3.1.1.2.2.2.cmml"><mo id="A1.E17.m1.2.2.1.3.1" stretchy="false" xref="A1.E17.m1.3.3.1.1.2.2.2.cmml">(</mo><mi id="A1.E17.m1.2.2.1.1" xref="A1.E17.m1.2.2.1.1.cmml">j</mi><mo id="A1.E17.m1.2.2.1.3.2" stretchy="false" xref="A1.E17.m1.3.3.1.1.2.2.2.cmml">)</mo></mrow></msubsup><mo id="A1.E17.m1.3.3.1.1.2.2.5" stretchy="false" xref="A1.E17.m1.3.3.1.1.2.3.cmml">)</mo></mrow><mo id="A1.E17.m1.3.3.1.1.6" xref="A1.E17.m1.3.3.1.1.6.cmml">∈</mo><mrow id="A1.E17.m1.3.3.1.1.7" xref="A1.E17.m1.3.3.1.1.7.cmml"><mi id="A1.E17.m1.3.3.1.1.7.2" mathvariant="normal" xref="A1.E17.m1.3.3.1.1.7.2.cmml">Ω</mi><mo id="A1.E17.m1.3.3.1.1.7.1" lspace="0.222em" rspace="0.222em" xref="A1.E17.m1.3.3.1.1.7.1.cmml">×</mo><mi id="A1.E17.m1.3.3.1.1.7.3" mathvariant="normal" xref="A1.E17.m1.3.3.1.1.7.3.cmml">Ω</mi></mrow></mrow><mo id="A1.E17.m1.3.3.1.2" xref="A1.E17.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.E17.m1.3b"><apply id="A1.E17.m1.3.3.1.1.cmml" xref="A1.E17.m1.3.3.1"><and id="A1.E17.m1.3.3.1.1a.cmml" xref="A1.E17.m1.3.3.1"></and><apply id="A1.E17.m1.3.3.1.1b.cmml" xref="A1.E17.m1.3.3.1"><ci id="A1.E17.m1.3.3.1.1.5.cmml" xref="A1.E17.m1.3.3.1.1.5">≔</ci><apply id="A1.E17.m1.3.3.1.1.4.cmml" xref="A1.E17.m1.3.3.1.1.4"><csymbol cd="ambiguous" id="A1.E17.m1.3.3.1.1.4.1.cmml" xref="A1.E17.m1.3.3.1.1.4">subscript</csymbol><ci id="A1.E17.m1.3.3.1.1.4.2.cmml" xref="A1.E17.m1.3.3.1.1.4.2">𝑋</ci><ci id="A1.E17.m1.3.3.1.1.4.3.cmml" xref="A1.E17.m1.3.3.1.1.4.3">𝑘</ci></apply><interval closure="open" id="A1.E17.m1.3.3.1.1.2.3.cmml" xref="A1.E17.m1.3.3.1.1.2.2"><apply id="A1.E17.m1.3.3.1.1.1.1.1.cmml" xref="A1.E17.m1.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E17.m1.3.3.1.1.1.1.1.1.cmml" xref="A1.E17.m1.3.3.1.1.1.1.1">superscript</csymbol><apply id="A1.E17.m1.3.3.1.1.1.1.1.2.cmml" xref="A1.E17.m1.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E17.m1.3.3.1.1.1.1.1.2.1.cmml" xref="A1.E17.m1.3.3.1.1.1.1.1">subscript</csymbol><ci id="A1.E17.m1.3.3.1.1.1.1.1.2.2.cmml" xref="A1.E17.m1.3.3.1.1.1.1.1.2.2">𝜔</ci><ci id="A1.E17.m1.3.3.1.1.1.1.1.2.3.cmml" xref="A1.E17.m1.3.3.1.1.1.1.1.2.3">𝑘</ci></apply><ci id="A1.E17.m1.1.1.1.1.cmml" xref="A1.E17.m1.1.1.1.1">𝑖</ci></apply><apply id="A1.E17.m1.3.3.1.1.2.2.2.cmml" xref="A1.E17.m1.3.3.1.1.2.2.2"><csymbol cd="ambiguous" id="A1.E17.m1.3.3.1.1.2.2.2.1.cmml" xref="A1.E17.m1.3.3.1.1.2.2.2">superscript</csymbol><apply id="A1.E17.m1.3.3.1.1.2.2.2.2.cmml" xref="A1.E17.m1.3.3.1.1.2.2.2"><csymbol cd="ambiguous" id="A1.E17.m1.3.3.1.1.2.2.2.2.1.cmml" xref="A1.E17.m1.3.3.1.1.2.2.2">subscript</csymbol><ci id="A1.E17.m1.3.3.1.1.2.2.2.2.2.cmml" xref="A1.E17.m1.3.3.1.1.2.2.2.2.2">𝜔</ci><ci id="A1.E17.m1.3.3.1.1.2.2.2.2.3.cmml" xref="A1.E17.m1.3.3.1.1.2.2.2.2.3">𝑘</ci></apply><ci id="A1.E17.m1.2.2.1.1.cmml" xref="A1.E17.m1.2.2.1.1">𝑗</ci></apply></interval></apply><apply id="A1.E17.m1.3.3.1.1c.cmml" xref="A1.E17.m1.3.3.1"><in id="A1.E17.m1.3.3.1.1.6.cmml" xref="A1.E17.m1.3.3.1.1.6"></in><share href="https://arxiv.org/html/2410.03462v1#A1.E17.m1.3.3.1.1.2.cmml" id="A1.E17.m1.3.3.1.1d.cmml" xref="A1.E17.m1.3.3.1"></share><apply id="A1.E17.m1.3.3.1.1.7.cmml" xref="A1.E17.m1.3.3.1.1.7"><times id="A1.E17.m1.3.3.1.1.7.1.cmml" xref="A1.E17.m1.3.3.1.1.7.1"></times><ci id="A1.E17.m1.3.3.1.1.7.2.cmml" xref="A1.E17.m1.3.3.1.1.7.2">Ω</ci><ci id="A1.E17.m1.3.3.1.1.7.3.cmml" xref="A1.E17.m1.3.3.1.1.7.3">Ω</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E17.m1.3c">X_{k}\coloneqq(\omega_{k}^{(i)},\omega_{k}^{(j)})\in\Omega\times\Omega,</annotation><annotation encoding="application/x-llamapun" id="A1.E17.m1.3d">italic_X start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ≔ ( italic_ω start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT , italic_ω start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_j ) end_POSTSUPERSCRIPT ) ∈ roman_Ω × roman_Ω ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(17)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A1.SS2.p3.6">where <math alttext="n" class="ltx_Math" display="inline" id="A1.SS2.p3.3.m1.1"><semantics id="A1.SS2.p3.3.m1.1a"><mi id="A1.SS2.p3.3.m1.1.1" xref="A1.SS2.p3.3.m1.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.p3.3.m1.1b"><ci id="A1.SS2.p3.3.m1.1.1.cmml" xref="A1.SS2.p3.3.m1.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p3.3.m1.1c">n</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p3.3.m1.1d">italic_n</annotation></semantics></math> such random variables <math alttext="\{X_{k}\}_{k=1}^{n}" class="ltx_Math" display="inline" id="A1.SS2.p3.4.m2.1"><semantics id="A1.SS2.p3.4.m2.1a"><msubsup id="A1.SS2.p3.4.m2.1.1" xref="A1.SS2.p3.4.m2.1.1.cmml"><mrow id="A1.SS2.p3.4.m2.1.1.1.1.1" xref="A1.SS2.p3.4.m2.1.1.1.1.2.cmml"><mo id="A1.SS2.p3.4.m2.1.1.1.1.1.2" stretchy="false" xref="A1.SS2.p3.4.m2.1.1.1.1.2.cmml">{</mo><msub id="A1.SS2.p3.4.m2.1.1.1.1.1.1" xref="A1.SS2.p3.4.m2.1.1.1.1.1.1.cmml"><mi id="A1.SS2.p3.4.m2.1.1.1.1.1.1.2" xref="A1.SS2.p3.4.m2.1.1.1.1.1.1.2.cmml">X</mi><mi id="A1.SS2.p3.4.m2.1.1.1.1.1.1.3" xref="A1.SS2.p3.4.m2.1.1.1.1.1.1.3.cmml">k</mi></msub><mo id="A1.SS2.p3.4.m2.1.1.1.1.1.3" stretchy="false" xref="A1.SS2.p3.4.m2.1.1.1.1.2.cmml">}</mo></mrow><mrow id="A1.SS2.p3.4.m2.1.1.1.3" xref="A1.SS2.p3.4.m2.1.1.1.3.cmml"><mi id="A1.SS2.p3.4.m2.1.1.1.3.2" xref="A1.SS2.p3.4.m2.1.1.1.3.2.cmml">k</mi><mo id="A1.SS2.p3.4.m2.1.1.1.3.1" xref="A1.SS2.p3.4.m2.1.1.1.3.1.cmml">=</mo><mn id="A1.SS2.p3.4.m2.1.1.1.3.3" xref="A1.SS2.p3.4.m2.1.1.1.3.3.cmml">1</mn></mrow><mi id="A1.SS2.p3.4.m2.1.1.3" xref="A1.SS2.p3.4.m2.1.1.3.cmml">n</mi></msubsup><annotation-xml encoding="MathML-Content" id="A1.SS2.p3.4.m2.1b"><apply id="A1.SS2.p3.4.m2.1.1.cmml" xref="A1.SS2.p3.4.m2.1.1"><csymbol cd="ambiguous" id="A1.SS2.p3.4.m2.1.1.2.cmml" xref="A1.SS2.p3.4.m2.1.1">superscript</csymbol><apply id="A1.SS2.p3.4.m2.1.1.1.cmml" xref="A1.SS2.p3.4.m2.1.1"><csymbol cd="ambiguous" id="A1.SS2.p3.4.m2.1.1.1.2.cmml" xref="A1.SS2.p3.4.m2.1.1">subscript</csymbol><set id="A1.SS2.p3.4.m2.1.1.1.1.2.cmml" xref="A1.SS2.p3.4.m2.1.1.1.1.1"><apply id="A1.SS2.p3.4.m2.1.1.1.1.1.1.cmml" xref="A1.SS2.p3.4.m2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.SS2.p3.4.m2.1.1.1.1.1.1.1.cmml" xref="A1.SS2.p3.4.m2.1.1.1.1.1.1">subscript</csymbol><ci id="A1.SS2.p3.4.m2.1.1.1.1.1.1.2.cmml" xref="A1.SS2.p3.4.m2.1.1.1.1.1.1.2">𝑋</ci><ci id="A1.SS2.p3.4.m2.1.1.1.1.1.1.3.cmml" xref="A1.SS2.p3.4.m2.1.1.1.1.1.1.3">𝑘</ci></apply></set><apply id="A1.SS2.p3.4.m2.1.1.1.3.cmml" xref="A1.SS2.p3.4.m2.1.1.1.3"><eq id="A1.SS2.p3.4.m2.1.1.1.3.1.cmml" xref="A1.SS2.p3.4.m2.1.1.1.3.1"></eq><ci id="A1.SS2.p3.4.m2.1.1.1.3.2.cmml" xref="A1.SS2.p3.4.m2.1.1.1.3.2">𝑘</ci><cn id="A1.SS2.p3.4.m2.1.1.1.3.3.cmml" type="integer" xref="A1.SS2.p3.4.m2.1.1.1.3.3">1</cn></apply></apply><ci id="A1.SS2.p3.4.m2.1.1.3.cmml" xref="A1.SS2.p3.4.m2.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p3.4.m2.1c">\{X_{k}\}_{k=1}^{n}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p3.4.m2.1d">{ italic_X start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT } start_POSTSUBSCRIPT italic_k = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT</annotation></semantics></math> are used in total.
Suppose we modify <math alttext="X_{k}" class="ltx_Math" display="inline" id="A1.SS2.p3.5.m3.1"><semantics id="A1.SS2.p3.5.m3.1a"><msub id="A1.SS2.p3.5.m3.1.1" xref="A1.SS2.p3.5.m3.1.1.cmml"><mi id="A1.SS2.p3.5.m3.1.1.2" xref="A1.SS2.p3.5.m3.1.1.2.cmml">X</mi><mi id="A1.SS2.p3.5.m3.1.1.3" xref="A1.SS2.p3.5.m3.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS2.p3.5.m3.1b"><apply id="A1.SS2.p3.5.m3.1.1.cmml" xref="A1.SS2.p3.5.m3.1.1"><csymbol cd="ambiguous" id="A1.SS2.p3.5.m3.1.1.1.cmml" xref="A1.SS2.p3.5.m3.1.1">subscript</csymbol><ci id="A1.SS2.p3.5.m3.1.1.2.cmml" xref="A1.SS2.p3.5.m3.1.1.2">𝑋</ci><ci id="A1.SS2.p3.5.m3.1.1.3.cmml" xref="A1.SS2.p3.5.m3.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p3.5.m3.1c">X_{k}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p3.5.m3.1d">italic_X start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math>.
Under mild assumptions, we can prove that the change in the estimator <math alttext="|\Delta\widehat{\mathbf{M}}_{\alpha ij}|" class="ltx_Math" display="inline" id="A1.SS2.p3.6.m4.1"><semantics id="A1.SS2.p3.6.m4.1a"><mrow id="A1.SS2.p3.6.m4.1.1.1" xref="A1.SS2.p3.6.m4.1.1.2.cmml"><mo id="A1.SS2.p3.6.m4.1.1.1.2" stretchy="false" xref="A1.SS2.p3.6.m4.1.1.2.1.cmml">|</mo><mrow id="A1.SS2.p3.6.m4.1.1.1.1" xref="A1.SS2.p3.6.m4.1.1.1.1.cmml"><mi id="A1.SS2.p3.6.m4.1.1.1.1.2" mathvariant="normal" xref="A1.SS2.p3.6.m4.1.1.1.1.2.cmml">Δ</mi><mo id="A1.SS2.p3.6.m4.1.1.1.1.1" xref="A1.SS2.p3.6.m4.1.1.1.1.1.cmml">⁢</mo><msub id="A1.SS2.p3.6.m4.1.1.1.1.3" xref="A1.SS2.p3.6.m4.1.1.1.1.3.cmml"><mover accent="true" id="A1.SS2.p3.6.m4.1.1.1.1.3.2" xref="A1.SS2.p3.6.m4.1.1.1.1.3.2.cmml"><mi id="A1.SS2.p3.6.m4.1.1.1.1.3.2.2" xref="A1.SS2.p3.6.m4.1.1.1.1.3.2.2.cmml">𝐌</mi><mo id="A1.SS2.p3.6.m4.1.1.1.1.3.2.1" xref="A1.SS2.p3.6.m4.1.1.1.1.3.2.1.cmml">^</mo></mover><mrow id="A1.SS2.p3.6.m4.1.1.1.1.3.3" xref="A1.SS2.p3.6.m4.1.1.1.1.3.3.cmml"><mi id="A1.SS2.p3.6.m4.1.1.1.1.3.3.2" xref="A1.SS2.p3.6.m4.1.1.1.1.3.3.2.cmml">α</mi><mo id="A1.SS2.p3.6.m4.1.1.1.1.3.3.1" xref="A1.SS2.p3.6.m4.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="A1.SS2.p3.6.m4.1.1.1.1.3.3.3" xref="A1.SS2.p3.6.m4.1.1.1.1.3.3.3.cmml">i</mi><mo id="A1.SS2.p3.6.m4.1.1.1.1.3.3.1a" xref="A1.SS2.p3.6.m4.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="A1.SS2.p3.6.m4.1.1.1.1.3.3.4" xref="A1.SS2.p3.6.m4.1.1.1.1.3.3.4.cmml">j</mi></mrow></msub></mrow><mo id="A1.SS2.p3.6.m4.1.1.1.3" stretchy="false" xref="A1.SS2.p3.6.m4.1.1.2.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p3.6.m4.1b"><apply id="A1.SS2.p3.6.m4.1.1.2.cmml" xref="A1.SS2.p3.6.m4.1.1.1"><abs id="A1.SS2.p3.6.m4.1.1.2.1.cmml" xref="A1.SS2.p3.6.m4.1.1.1.2"></abs><apply id="A1.SS2.p3.6.m4.1.1.1.1.cmml" xref="A1.SS2.p3.6.m4.1.1.1.1"><times id="A1.SS2.p3.6.m4.1.1.1.1.1.cmml" xref="A1.SS2.p3.6.m4.1.1.1.1.1"></times><ci id="A1.SS2.p3.6.m4.1.1.1.1.2.cmml" xref="A1.SS2.p3.6.m4.1.1.1.1.2">Δ</ci><apply id="A1.SS2.p3.6.m4.1.1.1.1.3.cmml" xref="A1.SS2.p3.6.m4.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.SS2.p3.6.m4.1.1.1.1.3.1.cmml" xref="A1.SS2.p3.6.m4.1.1.1.1.3">subscript</csymbol><apply id="A1.SS2.p3.6.m4.1.1.1.1.3.2.cmml" xref="A1.SS2.p3.6.m4.1.1.1.1.3.2"><ci id="A1.SS2.p3.6.m4.1.1.1.1.3.2.1.cmml" xref="A1.SS2.p3.6.m4.1.1.1.1.3.2.1">^</ci><ci id="A1.SS2.p3.6.m4.1.1.1.1.3.2.2.cmml" xref="A1.SS2.p3.6.m4.1.1.1.1.3.2.2">𝐌</ci></apply><apply id="A1.SS2.p3.6.m4.1.1.1.1.3.3.cmml" xref="A1.SS2.p3.6.m4.1.1.1.1.3.3"><times id="A1.SS2.p3.6.m4.1.1.1.1.3.3.1.cmml" xref="A1.SS2.p3.6.m4.1.1.1.1.3.3.1"></times><ci id="A1.SS2.p3.6.m4.1.1.1.1.3.3.2.cmml" xref="A1.SS2.p3.6.m4.1.1.1.1.3.3.2">𝛼</ci><ci id="A1.SS2.p3.6.m4.1.1.1.1.3.3.3.cmml" xref="A1.SS2.p3.6.m4.1.1.1.1.3.3.3">𝑖</ci><ci id="A1.SS2.p3.6.m4.1.1.1.1.3.3.4.cmml" xref="A1.SS2.p3.6.m4.1.1.1.1.3.3.4">𝑗</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p3.6.m4.1c">|\Delta\widehat{\mathbf{M}}_{\alpha ij}|</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p3.6.m4.1d">| roman_Δ over^ start_ARG bold_M end_ARG start_POSTSUBSCRIPT italic_α italic_i italic_j end_POSTSUBSCRIPT |</annotation></semantics></math> is <em class="ltx_emph ltx_font_italic" id="A1.SS2.p3.6.1">bounded</em>, which will enable us to use derive concentration inequalities.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="A1.SS2.p4">
<p class="ltx_p" id="A1.SS2.p4.2">This can be understood as follows.
To begin, we will bound the <math alttext="L_{1}" class="ltx_Math" display="inline" id="A1.SS2.p4.1.m1.1"><semantics id="A1.SS2.p4.1.m1.1a"><msub id="A1.SS2.p4.1.m1.1.1" xref="A1.SS2.p4.1.m1.1.1.cmml"><mi id="A1.SS2.p4.1.m1.1.1.2" xref="A1.SS2.p4.1.m1.1.1.2.cmml">L</mi><mn id="A1.SS2.p4.1.m1.1.1.3" xref="A1.SS2.p4.1.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="A1.SS2.p4.1.m1.1b"><apply id="A1.SS2.p4.1.m1.1.1.cmml" xref="A1.SS2.p4.1.m1.1.1"><csymbol cd="ambiguous" id="A1.SS2.p4.1.m1.1.1.1.cmml" xref="A1.SS2.p4.1.m1.1.1">subscript</csymbol><ci id="A1.SS2.p4.1.m1.1.1.2.cmml" xref="A1.SS2.p4.1.m1.1.1.2">𝐿</ci><cn id="A1.SS2.p4.1.m1.1.1.3.cmml" type="integer" xref="A1.SS2.p4.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p4.1.m1.1c">L_{1}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p4.1.m1.1d">italic_L start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math>-norm of <math alttext="\psi(\omega_{k}^{(i)})" class="ltx_Math" display="inline" id="A1.SS2.p4.2.m2.2"><semantics id="A1.SS2.p4.2.m2.2a"><mrow id="A1.SS2.p4.2.m2.2.2" xref="A1.SS2.p4.2.m2.2.2.cmml"><mi id="A1.SS2.p4.2.m2.2.2.3" xref="A1.SS2.p4.2.m2.2.2.3.cmml">ψ</mi><mo id="A1.SS2.p4.2.m2.2.2.2" xref="A1.SS2.p4.2.m2.2.2.2.cmml">⁢</mo><mrow id="A1.SS2.p4.2.m2.2.2.1.1" xref="A1.SS2.p4.2.m2.2.2.1.1.1.cmml"><mo id="A1.SS2.p4.2.m2.2.2.1.1.2" stretchy="false" xref="A1.SS2.p4.2.m2.2.2.1.1.1.cmml">(</mo><msubsup id="A1.SS2.p4.2.m2.2.2.1.1.1" xref="A1.SS2.p4.2.m2.2.2.1.1.1.cmml"><mi id="A1.SS2.p4.2.m2.2.2.1.1.1.2.2" xref="A1.SS2.p4.2.m2.2.2.1.1.1.2.2.cmml">ω</mi><mi id="A1.SS2.p4.2.m2.2.2.1.1.1.2.3" xref="A1.SS2.p4.2.m2.2.2.1.1.1.2.3.cmml">k</mi><mrow id="A1.SS2.p4.2.m2.1.1.1.3" xref="A1.SS2.p4.2.m2.2.2.1.1.1.cmml"><mo id="A1.SS2.p4.2.m2.1.1.1.3.1" stretchy="false" xref="A1.SS2.p4.2.m2.2.2.1.1.1.cmml">(</mo><mi id="A1.SS2.p4.2.m2.1.1.1.1" xref="A1.SS2.p4.2.m2.1.1.1.1.cmml">i</mi><mo id="A1.SS2.p4.2.m2.1.1.1.3.2" stretchy="false" xref="A1.SS2.p4.2.m2.2.2.1.1.1.cmml">)</mo></mrow></msubsup><mo id="A1.SS2.p4.2.m2.2.2.1.1.3" stretchy="false" xref="A1.SS2.p4.2.m2.2.2.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p4.2.m2.2b"><apply id="A1.SS2.p4.2.m2.2.2.cmml" xref="A1.SS2.p4.2.m2.2.2"><times id="A1.SS2.p4.2.m2.2.2.2.cmml" xref="A1.SS2.p4.2.m2.2.2.2"></times><ci id="A1.SS2.p4.2.m2.2.2.3.cmml" xref="A1.SS2.p4.2.m2.2.2.3">𝜓</ci><apply id="A1.SS2.p4.2.m2.2.2.1.1.1.cmml" xref="A1.SS2.p4.2.m2.2.2.1.1"><csymbol cd="ambiguous" id="A1.SS2.p4.2.m2.2.2.1.1.1.1.cmml" xref="A1.SS2.p4.2.m2.2.2.1.1">superscript</csymbol><apply id="A1.SS2.p4.2.m2.2.2.1.1.1.2.cmml" xref="A1.SS2.p4.2.m2.2.2.1.1"><csymbol cd="ambiguous" id="A1.SS2.p4.2.m2.2.2.1.1.1.2.1.cmml" xref="A1.SS2.p4.2.m2.2.2.1.1">subscript</csymbol><ci id="A1.SS2.p4.2.m2.2.2.1.1.1.2.2.cmml" xref="A1.SS2.p4.2.m2.2.2.1.1.1.2.2">𝜔</ci><ci id="A1.SS2.p4.2.m2.2.2.1.1.1.2.3.cmml" xref="A1.SS2.p4.2.m2.2.2.1.1.1.2.3">𝑘</ci></apply><ci id="A1.SS2.p4.2.m2.1.1.1.1.cmml" xref="A1.SS2.p4.2.m2.1.1.1.1">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p4.2.m2.2c">\psi(\omega_{k}^{(i)})</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p4.2.m2.2d">italic_ψ ( italic_ω start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT )</annotation></semantics></math>.
Observe that</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equation ltx_eqn_table" id="A1.E18">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\|\psi(\omega_{k}^{(i)})\|_{1}\leq\max_{\omega_{k}^{(i)}\in\Omega}\sum_{\omega%
\textrm{ p.s. }\omega_{k}^{(i)}}\left|\frac{\widetilde{\omega}(\omega)f_{%
\textrm{len}(\omega)}}{p(\omega)}\right|\leq\sum_{k=0}^{\infty}|f_{k}|\left(%
\max_{v_{i},v_{j}\in\mathcal{N}}\frac{|\mathbf{W}_{ij}|d_{i}}{1-p_{\textrm{%
halt}}}\right)^{k}\eqqcolon c," class="ltx_Math" display="block" id="A1.E18.m1.10"><semantics id="A1.E18.m1.10a"><mrow id="A1.E18.m1.10.10.1" xref="A1.E18.m1.10.10.1.1.cmml"><mrow id="A1.E18.m1.10.10.1.1" xref="A1.E18.m1.10.10.1.1.cmml"><msub id="A1.E18.m1.10.10.1.1.1" xref="A1.E18.m1.10.10.1.1.1.cmml"><mrow id="A1.E18.m1.10.10.1.1.1.1.1" xref="A1.E18.m1.10.10.1.1.1.1.2.cmml"><mo id="A1.E18.m1.10.10.1.1.1.1.1.2" stretchy="false" xref="A1.E18.m1.10.10.1.1.1.1.2.1.cmml">‖</mo><mrow id="A1.E18.m1.10.10.1.1.1.1.1.1" xref="A1.E18.m1.10.10.1.1.1.1.1.1.cmml"><mi id="A1.E18.m1.10.10.1.1.1.1.1.1.3" xref="A1.E18.m1.10.10.1.1.1.1.1.1.3.cmml">ψ</mi><mo id="A1.E18.m1.10.10.1.1.1.1.1.1.2" xref="A1.E18.m1.10.10.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.E18.m1.10.10.1.1.1.1.1.1.1.1" xref="A1.E18.m1.10.10.1.1.1.1.1.1.1.1.1.cmml"><mo id="A1.E18.m1.10.10.1.1.1.1.1.1.1.1.2" stretchy="false" xref="A1.E18.m1.10.10.1.1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="A1.E18.m1.10.10.1.1.1.1.1.1.1.1.1" xref="A1.E18.m1.10.10.1.1.1.1.1.1.1.1.1.cmml"><mi id="A1.E18.m1.10.10.1.1.1.1.1.1.1.1.1.2.2" xref="A1.E18.m1.10.10.1.1.1.1.1.1.1.1.1.2.2.cmml">ω</mi><mi id="A1.E18.m1.10.10.1.1.1.1.1.1.1.1.1.2.3" xref="A1.E18.m1.10.10.1.1.1.1.1.1.1.1.1.2.3.cmml">k</mi><mrow id="A1.E18.m1.1.1.1.3" xref="A1.E18.m1.10.10.1.1.1.1.1.1.1.1.1.cmml"><mo id="A1.E18.m1.1.1.1.3.1" stretchy="false" xref="A1.E18.m1.10.10.1.1.1.1.1.1.1.1.1.cmml">(</mo><mi id="A1.E18.m1.1.1.1.1" xref="A1.E18.m1.1.1.1.1.cmml">i</mi><mo id="A1.E18.m1.1.1.1.3.2" stretchy="false" xref="A1.E18.m1.10.10.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="A1.E18.m1.10.10.1.1.1.1.1.1.1.1.3" stretchy="false" xref="A1.E18.m1.10.10.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E18.m1.10.10.1.1.1.1.1.3" stretchy="false" xref="A1.E18.m1.10.10.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="A1.E18.m1.10.10.1.1.1.3" xref="A1.E18.m1.10.10.1.1.1.3.cmml">1</mn></msub><mo id="A1.E18.m1.10.10.1.1.5" xref="A1.E18.m1.10.10.1.1.5.cmml">≤</mo><mrow id="A1.E18.m1.10.10.1.1.6" xref="A1.E18.m1.10.10.1.1.6.cmml"><munder id="A1.E18.m1.10.10.1.1.6.2" xref="A1.E18.m1.10.10.1.1.6.2.cmml"><mi id="A1.E18.m1.10.10.1.1.6.2.2" xref="A1.E18.m1.10.10.1.1.6.2.2.cmml">max</mi><mrow id="A1.E18.m1.2.2.1" xref="A1.E18.m1.2.2.1.cmml"><msubsup id="A1.E18.m1.2.2.1.3" xref="A1.E18.m1.2.2.1.3.cmml"><mi id="A1.E18.m1.2.2.1.3.2.2" xref="A1.E18.m1.2.2.1.3.2.2.cmml">ω</mi><mi id="A1.E18.m1.2.2.1.3.2.3" xref="A1.E18.m1.2.2.1.3.2.3.cmml">k</mi><mrow id="A1.E18.m1.2.2.1.1.1.3" xref="A1.E18.m1.2.2.1.3.cmml"><mo id="A1.E18.m1.2.2.1.1.1.3.1" stretchy="false" xref="A1.E18.m1.2.2.1.3.cmml">(</mo><mi id="A1.E18.m1.2.2.1.1.1.1" xref="A1.E18.m1.2.2.1.1.1.1.cmml">i</mi><mo id="A1.E18.m1.2.2.1.1.1.3.2" stretchy="false" xref="A1.E18.m1.2.2.1.3.cmml">)</mo></mrow></msubsup><mo id="A1.E18.m1.2.2.1.2" xref="A1.E18.m1.2.2.1.2.cmml">∈</mo><mi id="A1.E18.m1.2.2.1.4" mathvariant="normal" xref="A1.E18.m1.2.2.1.4.cmml">Ω</mi></mrow></munder><mo id="A1.E18.m1.10.10.1.1.6.1" xref="A1.E18.m1.10.10.1.1.6.1.cmml">⁢</mo><mrow id="A1.E18.m1.10.10.1.1.6.3" xref="A1.E18.m1.10.10.1.1.6.3.cmml"><munder id="A1.E18.m1.10.10.1.1.6.3.1" xref="A1.E18.m1.10.10.1.1.6.3.1.cmml"><mo id="A1.E18.m1.10.10.1.1.6.3.1.2" movablelimits="false" rspace="0em" xref="A1.E18.m1.10.10.1.1.6.3.1.2.cmml">∑</mo><mrow id="A1.E18.m1.3.3.1" xref="A1.E18.m1.3.3.1.cmml"><mi id="A1.E18.m1.3.3.1.3" xref="A1.E18.m1.3.3.1.3.cmml">ω</mi><mo id="A1.E18.m1.3.3.1.2" xref="A1.E18.m1.3.3.1.2.cmml">⁢</mo><mtext id="A1.E18.m1.3.3.1.4" xref="A1.E18.m1.3.3.1.4a.cmml">&nbsp;p.s.&nbsp;</mtext><mo id="A1.E18.m1.3.3.1.2a" xref="A1.E18.m1.3.3.1.2.cmml">⁢</mo><msubsup id="A1.E18.m1.3.3.1.5" xref="A1.E18.m1.3.3.1.5.cmml"><mi id="A1.E18.m1.3.3.1.5.2.2" xref="A1.E18.m1.3.3.1.5.2.2.cmml">ω</mi><mi id="A1.E18.m1.3.3.1.5.2.3" xref="A1.E18.m1.3.3.1.5.2.3.cmml">k</mi><mrow id="A1.E18.m1.3.3.1.1.1.3" xref="A1.E18.m1.3.3.1.5.cmml"><mo id="A1.E18.m1.3.3.1.1.1.3.1" stretchy="false" xref="A1.E18.m1.3.3.1.5.cmml">(</mo><mi id="A1.E18.m1.3.3.1.1.1.1" xref="A1.E18.m1.3.3.1.1.1.1.cmml">i</mi><mo id="A1.E18.m1.3.3.1.1.1.3.2" stretchy="false" xref="A1.E18.m1.3.3.1.5.cmml">)</mo></mrow></msubsup></mrow></munder><mrow id="A1.E18.m1.10.10.1.1.6.3.2.2" xref="A1.E18.m1.10.10.1.1.6.3.2.1.cmml"><mo id="A1.E18.m1.10.10.1.1.6.3.2.2.1" xref="A1.E18.m1.10.10.1.1.6.3.2.1.1.cmml">|</mo><mfrac id="A1.E18.m1.6.6" xref="A1.E18.m1.6.6.cmml"><mrow id="A1.E18.m1.5.5.2" xref="A1.E18.m1.5.5.2.cmml"><mover accent="true" id="A1.E18.m1.5.5.2.4" xref="A1.E18.m1.5.5.2.4.cmml"><mi id="A1.E18.m1.5.5.2.4.2" xref="A1.E18.m1.5.5.2.4.2.cmml">ω</mi><mo id="A1.E18.m1.5.5.2.4.1" xref="A1.E18.m1.5.5.2.4.1.cmml">~</mo></mover><mo id="A1.E18.m1.5.5.2.3" xref="A1.E18.m1.5.5.2.3.cmml">⁢</mo><mrow id="A1.E18.m1.5.5.2.5.2" xref="A1.E18.m1.5.5.2.cmml"><mo id="A1.E18.m1.5.5.2.5.2.1" stretchy="false" xref="A1.E18.m1.5.5.2.cmml">(</mo><mi id="A1.E18.m1.5.5.2.2" xref="A1.E18.m1.5.5.2.2.cmml">ω</mi><mo id="A1.E18.m1.5.5.2.5.2.2" stretchy="false" xref="A1.E18.m1.5.5.2.cmml">)</mo></mrow><mo id="A1.E18.m1.5.5.2.3a" xref="A1.E18.m1.5.5.2.3.cmml">⁢</mo><msub id="A1.E18.m1.5.5.2.6" xref="A1.E18.m1.5.5.2.6.cmml"><mi id="A1.E18.m1.5.5.2.6.2" xref="A1.E18.m1.5.5.2.6.2.cmml">f</mi><mrow id="A1.E18.m1.4.4.1.1.1" xref="A1.E18.m1.4.4.1.1.1.cmml"><mtext id="A1.E18.m1.4.4.1.1.1.3" xref="A1.E18.m1.4.4.1.1.1.3a.cmml">len</mtext><mo id="A1.E18.m1.4.4.1.1.1.2" xref="A1.E18.m1.4.4.1.1.1.2.cmml">⁢</mo><mrow id="A1.E18.m1.4.4.1.1.1.4.2" xref="A1.E18.m1.4.4.1.1.1.cmml"><mo id="A1.E18.m1.4.4.1.1.1.4.2.1" stretchy="false" xref="A1.E18.m1.4.4.1.1.1.cmml">(</mo><mi id="A1.E18.m1.4.4.1.1.1.1" xref="A1.E18.m1.4.4.1.1.1.1.cmml">ω</mi><mo id="A1.E18.m1.4.4.1.1.1.4.2.2" stretchy="false" xref="A1.E18.m1.4.4.1.1.1.cmml">)</mo></mrow></mrow></msub></mrow><mrow id="A1.E18.m1.6.6.3" xref="A1.E18.m1.6.6.3.cmml"><mi id="A1.E18.m1.6.6.3.3" xref="A1.E18.m1.6.6.3.3.cmml">p</mi><mo id="A1.E18.m1.6.6.3.2" xref="A1.E18.m1.6.6.3.2.cmml">⁢</mo><mrow id="A1.E18.m1.6.6.3.4.2" xref="A1.E18.m1.6.6.3.cmml"><mo id="A1.E18.m1.6.6.3.4.2.1" stretchy="false" xref="A1.E18.m1.6.6.3.cmml">(</mo><mi id="A1.E18.m1.6.6.3.1" xref="A1.E18.m1.6.6.3.1.cmml">ω</mi><mo id="A1.E18.m1.6.6.3.4.2.2" stretchy="false" xref="A1.E18.m1.6.6.3.cmml">)</mo></mrow></mrow></mfrac><mo id="A1.E18.m1.10.10.1.1.6.3.2.2.2" xref="A1.E18.m1.10.10.1.1.6.3.2.1.1.cmml">|</mo></mrow></mrow></mrow><mo id="A1.E18.m1.10.10.1.1.7" rspace="0.111em" xref="A1.E18.m1.10.10.1.1.7.cmml">≤</mo><mrow id="A1.E18.m1.10.10.1.1.3" xref="A1.E18.m1.10.10.1.1.3.cmml"><munderover id="A1.E18.m1.10.10.1.1.3.3" xref="A1.E18.m1.10.10.1.1.3.3.cmml"><mo id="A1.E18.m1.10.10.1.1.3.3.2.2" movablelimits="false" rspace="0em" xref="A1.E18.m1.10.10.1.1.3.3.2.2.cmml">∑</mo><mrow id="A1.E18.m1.10.10.1.1.3.3.2.3" xref="A1.E18.m1.10.10.1.1.3.3.2.3.cmml"><mi id="A1.E18.m1.10.10.1.1.3.3.2.3.2" xref="A1.E18.m1.10.10.1.1.3.3.2.3.2.cmml">k</mi><mo id="A1.E18.m1.10.10.1.1.3.3.2.3.1" xref="A1.E18.m1.10.10.1.1.3.3.2.3.1.cmml">=</mo><mn id="A1.E18.m1.10.10.1.1.3.3.2.3.3" xref="A1.E18.m1.10.10.1.1.3.3.2.3.3.cmml">0</mn></mrow><mi id="A1.E18.m1.10.10.1.1.3.3.3" mathvariant="normal" xref="A1.E18.m1.10.10.1.1.3.3.3.cmml">∞</mi></munderover><mrow id="A1.E18.m1.10.10.1.1.3.2" xref="A1.E18.m1.10.10.1.1.3.2.cmml"><mrow id="A1.E18.m1.10.10.1.1.2.1.1.1" xref="A1.E18.m1.10.10.1.1.2.1.1.2.cmml"><mo id="A1.E18.m1.10.10.1.1.2.1.1.1.2" stretchy="false" xref="A1.E18.m1.10.10.1.1.2.1.1.2.1.cmml">|</mo><msub id="A1.E18.m1.10.10.1.1.2.1.1.1.1" xref="A1.E18.m1.10.10.1.1.2.1.1.1.1.cmml"><mi id="A1.E18.m1.10.10.1.1.2.1.1.1.1.2" xref="A1.E18.m1.10.10.1.1.2.1.1.1.1.2.cmml">f</mi><mi id="A1.E18.m1.10.10.1.1.2.1.1.1.1.3" xref="A1.E18.m1.10.10.1.1.2.1.1.1.1.3.cmml">k</mi></msub><mo id="A1.E18.m1.10.10.1.1.2.1.1.1.3" stretchy="false" xref="A1.E18.m1.10.10.1.1.2.1.1.2.1.cmml">|</mo></mrow><mo id="A1.E18.m1.10.10.1.1.3.2.3" xref="A1.E18.m1.10.10.1.1.3.2.3.cmml">⁢</mo><msup id="A1.E18.m1.10.10.1.1.3.2.2" xref="A1.E18.m1.10.10.1.1.3.2.2.cmml"><mrow id="A1.E18.m1.10.10.1.1.3.2.2.1.1" xref="A1.E18.m1.10.10.1.1.3.2.2.1.1.1.cmml"><mo id="A1.E18.m1.10.10.1.1.3.2.2.1.1.2" xref="A1.E18.m1.10.10.1.1.3.2.2.1.1.1.cmml">(</mo><mrow id="A1.E18.m1.10.10.1.1.3.2.2.1.1.1" xref="A1.E18.m1.10.10.1.1.3.2.2.1.1.1.cmml"><munder id="A1.E18.m1.10.10.1.1.3.2.2.1.1.1.1" xref="A1.E18.m1.10.10.1.1.3.2.2.1.1.1.1.cmml"><mi id="A1.E18.m1.10.10.1.1.3.2.2.1.1.1.1.2" xref="A1.E18.m1.10.10.1.1.3.2.2.1.1.1.1.2.cmml">max</mi><mrow id="A1.E18.m1.8.8.2" xref="A1.E18.m1.8.8.2.cmml"><mrow id="A1.E18.m1.8.8.2.2.2" xref="A1.E18.m1.8.8.2.2.3.cmml"><msub id="A1.E18.m1.7.7.1.1.1.1" xref="A1.E18.m1.7.7.1.1.1.1.cmml"><mi id="A1.E18.m1.7.7.1.1.1.1.2" xref="A1.E18.m1.7.7.1.1.1.1.2.cmml">v</mi><mi id="A1.E18.m1.7.7.1.1.1.1.3" xref="A1.E18.m1.7.7.1.1.1.1.3.cmml">i</mi></msub><mo id="A1.E18.m1.8.8.2.2.2.3" xref="A1.E18.m1.8.8.2.2.3.cmml">,</mo><msub id="A1.E18.m1.8.8.2.2.2.2" xref="A1.E18.m1.8.8.2.2.2.2.cmml"><mi id="A1.E18.m1.8.8.2.2.2.2.2" xref="A1.E18.m1.8.8.2.2.2.2.2.cmml">v</mi><mi id="A1.E18.m1.8.8.2.2.2.2.3" xref="A1.E18.m1.8.8.2.2.2.2.3.cmml">j</mi></msub></mrow><mo id="A1.E18.m1.8.8.2.3" xref="A1.E18.m1.8.8.2.3.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="A1.E18.m1.8.8.2.4" xref="A1.E18.m1.8.8.2.4.cmml">𝒩</mi></mrow></munder><mo id="A1.E18.m1.10.10.1.1.3.2.2.1.1.1a" lspace="0.167em" xref="A1.E18.m1.10.10.1.1.3.2.2.1.1.1.cmml">⁡</mo><mfrac id="A1.E18.m1.9.9" xref="A1.E18.m1.9.9.cmml"><mrow id="A1.E18.m1.9.9.1" xref="A1.E18.m1.9.9.1.cmml"><mrow id="A1.E18.m1.9.9.1.1.1" xref="A1.E18.m1.9.9.1.1.2.cmml"><mo id="A1.E18.m1.9.9.1.1.1.2" stretchy="false" xref="A1.E18.m1.9.9.1.1.2.1.cmml">|</mo><msub id="A1.E18.m1.9.9.1.1.1.1" xref="A1.E18.m1.9.9.1.1.1.1.cmml"><mi id="A1.E18.m1.9.9.1.1.1.1.2" xref="A1.E18.m1.9.9.1.1.1.1.2.cmml">𝐖</mi><mrow id="A1.E18.m1.9.9.1.1.1.1.3" xref="A1.E18.m1.9.9.1.1.1.1.3.cmml"><mi id="A1.E18.m1.9.9.1.1.1.1.3.2" xref="A1.E18.m1.9.9.1.1.1.1.3.2.cmml">i</mi><mo id="A1.E18.m1.9.9.1.1.1.1.3.1" xref="A1.E18.m1.9.9.1.1.1.1.3.1.cmml">⁢</mo><mi id="A1.E18.m1.9.9.1.1.1.1.3.3" xref="A1.E18.m1.9.9.1.1.1.1.3.3.cmml">j</mi></mrow></msub><mo id="A1.E18.m1.9.9.1.1.1.3" stretchy="false" xref="A1.E18.m1.9.9.1.1.2.1.cmml">|</mo></mrow><mo id="A1.E18.m1.9.9.1.2" xref="A1.E18.m1.9.9.1.2.cmml">⁢</mo><msub id="A1.E18.m1.9.9.1.3" xref="A1.E18.m1.9.9.1.3.cmml"><mi id="A1.E18.m1.9.9.1.3.2" xref="A1.E18.m1.9.9.1.3.2.cmml">d</mi><mi id="A1.E18.m1.9.9.1.3.3" xref="A1.E18.m1.9.9.1.3.3.cmml">i</mi></msub></mrow><mrow id="A1.E18.m1.9.9.3" xref="A1.E18.m1.9.9.3.cmml"><mn id="A1.E18.m1.9.9.3.2" xref="A1.E18.m1.9.9.3.2.cmml">1</mn><mo id="A1.E18.m1.9.9.3.1" xref="A1.E18.m1.9.9.3.1.cmml">−</mo><msub id="A1.E18.m1.9.9.3.3" xref="A1.E18.m1.9.9.3.3.cmml"><mi id="A1.E18.m1.9.9.3.3.2" xref="A1.E18.m1.9.9.3.3.2.cmml">p</mi><mtext id="A1.E18.m1.9.9.3.3.3" xref="A1.E18.m1.9.9.3.3.3a.cmml">halt</mtext></msub></mrow></mfrac></mrow><mo id="A1.E18.m1.10.10.1.1.3.2.2.1.1.3" xref="A1.E18.m1.10.10.1.1.3.2.2.1.1.1.cmml">)</mo></mrow><mi id="A1.E18.m1.10.10.1.1.3.2.2.3" xref="A1.E18.m1.10.10.1.1.3.2.2.3.cmml">k</mi></msup></mrow></mrow><mo id="A1.E18.m1.10.10.1.1.8" xref="A1.E18.m1.10.10.1.1.8.cmml">≕</mo><mi id="A1.E18.m1.10.10.1.1.9" xref="A1.E18.m1.10.10.1.1.9.cmml">c</mi></mrow><mo id="A1.E18.m1.10.10.1.2" xref="A1.E18.m1.10.10.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.E18.m1.10b"><apply id="A1.E18.m1.10.10.1.1.cmml" xref="A1.E18.m1.10.10.1"><and id="A1.E18.m1.10.10.1.1a.cmml" xref="A1.E18.m1.10.10.1"></and><apply id="A1.E18.m1.10.10.1.1b.cmml" xref="A1.E18.m1.10.10.1"><leq id="A1.E18.m1.10.10.1.1.5.cmml" xref="A1.E18.m1.10.10.1.1.5"></leq><apply id="A1.E18.m1.10.10.1.1.1.cmml" xref="A1.E18.m1.10.10.1.1.1"><csymbol cd="ambiguous" id="A1.E18.m1.10.10.1.1.1.2.cmml" xref="A1.E18.m1.10.10.1.1.1">subscript</csymbol><apply id="A1.E18.m1.10.10.1.1.1.1.2.cmml" xref="A1.E18.m1.10.10.1.1.1.1.1"><csymbol cd="latexml" id="A1.E18.m1.10.10.1.1.1.1.2.1.cmml" xref="A1.E18.m1.10.10.1.1.1.1.1.2">norm</csymbol><apply id="A1.E18.m1.10.10.1.1.1.1.1.1.cmml" xref="A1.E18.m1.10.10.1.1.1.1.1.1"><times id="A1.E18.m1.10.10.1.1.1.1.1.1.2.cmml" xref="A1.E18.m1.10.10.1.1.1.1.1.1.2"></times><ci id="A1.E18.m1.10.10.1.1.1.1.1.1.3.cmml" xref="A1.E18.m1.10.10.1.1.1.1.1.1.3">𝜓</ci><apply id="A1.E18.m1.10.10.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E18.m1.10.10.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E18.m1.10.10.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E18.m1.10.10.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="A1.E18.m1.10.10.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E18.m1.10.10.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E18.m1.10.10.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="A1.E18.m1.10.10.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.E18.m1.10.10.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="A1.E18.m1.10.10.1.1.1.1.1.1.1.1.1.2.2">𝜔</ci><ci id="A1.E18.m1.10.10.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="A1.E18.m1.10.10.1.1.1.1.1.1.1.1.1.2.3">𝑘</ci></apply><ci id="A1.E18.m1.1.1.1.1.cmml" xref="A1.E18.m1.1.1.1.1">𝑖</ci></apply></apply></apply><cn id="A1.E18.m1.10.10.1.1.1.3.cmml" type="integer" xref="A1.E18.m1.10.10.1.1.1.3">1</cn></apply><apply id="A1.E18.m1.10.10.1.1.6.cmml" xref="A1.E18.m1.10.10.1.1.6"><times id="A1.E18.m1.10.10.1.1.6.1.cmml" xref="A1.E18.m1.10.10.1.1.6.1"></times><apply id="A1.E18.m1.10.10.1.1.6.2.cmml" xref="A1.E18.m1.10.10.1.1.6.2"><csymbol cd="ambiguous" id="A1.E18.m1.10.10.1.1.6.2.1.cmml" xref="A1.E18.m1.10.10.1.1.6.2">subscript</csymbol><max id="A1.E18.m1.10.10.1.1.6.2.2.cmml" xref="A1.E18.m1.10.10.1.1.6.2.2"></max><apply id="A1.E18.m1.2.2.1.cmml" xref="A1.E18.m1.2.2.1"><in id="A1.E18.m1.2.2.1.2.cmml" xref="A1.E18.m1.2.2.1.2"></in><apply id="A1.E18.m1.2.2.1.3.cmml" xref="A1.E18.m1.2.2.1.3"><csymbol cd="ambiguous" id="A1.E18.m1.2.2.1.3.1.cmml" xref="A1.E18.m1.2.2.1.3">superscript</csymbol><apply id="A1.E18.m1.2.2.1.3.2.cmml" xref="A1.E18.m1.2.2.1.3"><csymbol cd="ambiguous" id="A1.E18.m1.2.2.1.3.2.1.cmml" xref="A1.E18.m1.2.2.1.3">subscript</csymbol><ci id="A1.E18.m1.2.2.1.3.2.2.cmml" xref="A1.E18.m1.2.2.1.3.2.2">𝜔</ci><ci id="A1.E18.m1.2.2.1.3.2.3.cmml" xref="A1.E18.m1.2.2.1.3.2.3">𝑘</ci></apply><ci id="A1.E18.m1.2.2.1.1.1.1.cmml" xref="A1.E18.m1.2.2.1.1.1.1">𝑖</ci></apply><ci id="A1.E18.m1.2.2.1.4.cmml" xref="A1.E18.m1.2.2.1.4">Ω</ci></apply></apply><apply id="A1.E18.m1.10.10.1.1.6.3.cmml" xref="A1.E18.m1.10.10.1.1.6.3"><apply id="A1.E18.m1.10.10.1.1.6.3.1.cmml" xref="A1.E18.m1.10.10.1.1.6.3.1"><csymbol cd="ambiguous" id="A1.E18.m1.10.10.1.1.6.3.1.1.cmml" xref="A1.E18.m1.10.10.1.1.6.3.1">subscript</csymbol><sum id="A1.E18.m1.10.10.1.1.6.3.1.2.cmml" xref="A1.E18.m1.10.10.1.1.6.3.1.2"></sum><apply id="A1.E18.m1.3.3.1.cmml" xref="A1.E18.m1.3.3.1"><times id="A1.E18.m1.3.3.1.2.cmml" xref="A1.E18.m1.3.3.1.2"></times><ci id="A1.E18.m1.3.3.1.3.cmml" xref="A1.E18.m1.3.3.1.3">𝜔</ci><ci id="A1.E18.m1.3.3.1.4a.cmml" xref="A1.E18.m1.3.3.1.4"><mtext id="A1.E18.m1.3.3.1.4.cmml" mathsize="70%" xref="A1.E18.m1.3.3.1.4">&nbsp;p.s.&nbsp;</mtext></ci><apply id="A1.E18.m1.3.3.1.5.cmml" xref="A1.E18.m1.3.3.1.5"><csymbol cd="ambiguous" id="A1.E18.m1.3.3.1.5.1.cmml" xref="A1.E18.m1.3.3.1.5">superscript</csymbol><apply id="A1.E18.m1.3.3.1.5.2.cmml" xref="A1.E18.m1.3.3.1.5"><csymbol cd="ambiguous" id="A1.E18.m1.3.3.1.5.2.1.cmml" xref="A1.E18.m1.3.3.1.5">subscript</csymbol><ci id="A1.E18.m1.3.3.1.5.2.2.cmml" xref="A1.E18.m1.3.3.1.5.2.2">𝜔</ci><ci id="A1.E18.m1.3.3.1.5.2.3.cmml" xref="A1.E18.m1.3.3.1.5.2.3">𝑘</ci></apply><ci id="A1.E18.m1.3.3.1.1.1.1.cmml" xref="A1.E18.m1.3.3.1.1.1.1">𝑖</ci></apply></apply></apply><apply id="A1.E18.m1.10.10.1.1.6.3.2.1.cmml" xref="A1.E18.m1.10.10.1.1.6.3.2.2"><abs id="A1.E18.m1.10.10.1.1.6.3.2.1.1.cmml" xref="A1.E18.m1.10.10.1.1.6.3.2.2.1"></abs><apply id="A1.E18.m1.6.6.cmml" xref="A1.E18.m1.6.6"><divide id="A1.E18.m1.6.6.4.cmml" xref="A1.E18.m1.6.6"></divide><apply id="A1.E18.m1.5.5.2.cmml" xref="A1.E18.m1.5.5.2"><times id="A1.E18.m1.5.5.2.3.cmml" xref="A1.E18.m1.5.5.2.3"></times><apply id="A1.E18.m1.5.5.2.4.cmml" xref="A1.E18.m1.5.5.2.4"><ci id="A1.E18.m1.5.5.2.4.1.cmml" xref="A1.E18.m1.5.5.2.4.1">~</ci><ci id="A1.E18.m1.5.5.2.4.2.cmml" xref="A1.E18.m1.5.5.2.4.2">𝜔</ci></apply><ci id="A1.E18.m1.5.5.2.2.cmml" xref="A1.E18.m1.5.5.2.2">𝜔</ci><apply id="A1.E18.m1.5.5.2.6.cmml" xref="A1.E18.m1.5.5.2.6"><csymbol cd="ambiguous" id="A1.E18.m1.5.5.2.6.1.cmml" xref="A1.E18.m1.5.5.2.6">subscript</csymbol><ci id="A1.E18.m1.5.5.2.6.2.cmml" xref="A1.E18.m1.5.5.2.6.2">𝑓</ci><apply id="A1.E18.m1.4.4.1.1.1.cmml" xref="A1.E18.m1.4.4.1.1.1"><times id="A1.E18.m1.4.4.1.1.1.2.cmml" xref="A1.E18.m1.4.4.1.1.1.2"></times><ci id="A1.E18.m1.4.4.1.1.1.3a.cmml" xref="A1.E18.m1.4.4.1.1.1.3"><mtext id="A1.E18.m1.4.4.1.1.1.3.cmml" mathsize="70%" xref="A1.E18.m1.4.4.1.1.1.3">len</mtext></ci><ci id="A1.E18.m1.4.4.1.1.1.1.cmml" xref="A1.E18.m1.4.4.1.1.1.1">𝜔</ci></apply></apply></apply><apply id="A1.E18.m1.6.6.3.cmml" xref="A1.E18.m1.6.6.3"><times id="A1.E18.m1.6.6.3.2.cmml" xref="A1.E18.m1.6.6.3.2"></times><ci id="A1.E18.m1.6.6.3.3.cmml" xref="A1.E18.m1.6.6.3.3">𝑝</ci><ci id="A1.E18.m1.6.6.3.1.cmml" xref="A1.E18.m1.6.6.3.1">𝜔</ci></apply></apply></apply></apply></apply></apply><apply id="A1.E18.m1.10.10.1.1c.cmml" xref="A1.E18.m1.10.10.1"><leq id="A1.E18.m1.10.10.1.1.7.cmml" xref="A1.E18.m1.10.10.1.1.7"></leq><share href="https://arxiv.org/html/2410.03462v1#A1.E18.m1.10.10.1.1.6.cmml" id="A1.E18.m1.10.10.1.1d.cmml" xref="A1.E18.m1.10.10.1"></share><apply id="A1.E18.m1.10.10.1.1.3.cmml" xref="A1.E18.m1.10.10.1.1.3"><apply id="A1.E18.m1.10.10.1.1.3.3.cmml" xref="A1.E18.m1.10.10.1.1.3.3"><csymbol cd="ambiguous" id="A1.E18.m1.10.10.1.1.3.3.1.cmml" xref="A1.E18.m1.10.10.1.1.3.3">superscript</csymbol><apply id="A1.E18.m1.10.10.1.1.3.3.2.cmml" xref="A1.E18.m1.10.10.1.1.3.3"><csymbol cd="ambiguous" id="A1.E18.m1.10.10.1.1.3.3.2.1.cmml" xref="A1.E18.m1.10.10.1.1.3.3">subscript</csymbol><sum id="A1.E18.m1.10.10.1.1.3.3.2.2.cmml" xref="A1.E18.m1.10.10.1.1.3.3.2.2"></sum><apply id="A1.E18.m1.10.10.1.1.3.3.2.3.cmml" xref="A1.E18.m1.10.10.1.1.3.3.2.3"><eq id="A1.E18.m1.10.10.1.1.3.3.2.3.1.cmml" xref="A1.E18.m1.10.10.1.1.3.3.2.3.1"></eq><ci id="A1.E18.m1.10.10.1.1.3.3.2.3.2.cmml" xref="A1.E18.m1.10.10.1.1.3.3.2.3.2">𝑘</ci><cn id="A1.E18.m1.10.10.1.1.3.3.2.3.3.cmml" type="integer" xref="A1.E18.m1.10.10.1.1.3.3.2.3.3">0</cn></apply></apply><infinity id="A1.E18.m1.10.10.1.1.3.3.3.cmml" xref="A1.E18.m1.10.10.1.1.3.3.3"></infinity></apply><apply id="A1.E18.m1.10.10.1.1.3.2.cmml" xref="A1.E18.m1.10.10.1.1.3.2"><times id="A1.E18.m1.10.10.1.1.3.2.3.cmml" xref="A1.E18.m1.10.10.1.1.3.2.3"></times><apply id="A1.E18.m1.10.10.1.1.2.1.1.2.cmml" xref="A1.E18.m1.10.10.1.1.2.1.1.1"><abs id="A1.E18.m1.10.10.1.1.2.1.1.2.1.cmml" xref="A1.E18.m1.10.10.1.1.2.1.1.1.2"></abs><apply id="A1.E18.m1.10.10.1.1.2.1.1.1.1.cmml" xref="A1.E18.m1.10.10.1.1.2.1.1.1.1"><csymbol cd="ambiguous" id="A1.E18.m1.10.10.1.1.2.1.1.1.1.1.cmml" xref="A1.E18.m1.10.10.1.1.2.1.1.1.1">subscript</csymbol><ci id="A1.E18.m1.10.10.1.1.2.1.1.1.1.2.cmml" xref="A1.E18.m1.10.10.1.1.2.1.1.1.1.2">𝑓</ci><ci id="A1.E18.m1.10.10.1.1.2.1.1.1.1.3.cmml" xref="A1.E18.m1.10.10.1.1.2.1.1.1.1.3">𝑘</ci></apply></apply><apply id="A1.E18.m1.10.10.1.1.3.2.2.cmml" xref="A1.E18.m1.10.10.1.1.3.2.2"><csymbol cd="ambiguous" id="A1.E18.m1.10.10.1.1.3.2.2.2.cmml" xref="A1.E18.m1.10.10.1.1.3.2.2">superscript</csymbol><apply id="A1.E18.m1.10.10.1.1.3.2.2.1.1.1.cmml" xref="A1.E18.m1.10.10.1.1.3.2.2.1.1"><apply id="A1.E18.m1.10.10.1.1.3.2.2.1.1.1.1.cmml" xref="A1.E18.m1.10.10.1.1.3.2.2.1.1.1.1"><csymbol cd="ambiguous" id="A1.E18.m1.10.10.1.1.3.2.2.1.1.1.1.1.cmml" xref="A1.E18.m1.10.10.1.1.3.2.2.1.1.1.1">subscript</csymbol><max id="A1.E18.m1.10.10.1.1.3.2.2.1.1.1.1.2.cmml" xref="A1.E18.m1.10.10.1.1.3.2.2.1.1.1.1.2"></max><apply id="A1.E18.m1.8.8.2.cmml" xref="A1.E18.m1.8.8.2"><in id="A1.E18.m1.8.8.2.3.cmml" xref="A1.E18.m1.8.8.2.3"></in><list id="A1.E18.m1.8.8.2.2.3.cmml" xref="A1.E18.m1.8.8.2.2.2"><apply id="A1.E18.m1.7.7.1.1.1.1.cmml" xref="A1.E18.m1.7.7.1.1.1.1"><csymbol cd="ambiguous" id="A1.E18.m1.7.7.1.1.1.1.1.cmml" xref="A1.E18.m1.7.7.1.1.1.1">subscript</csymbol><ci id="A1.E18.m1.7.7.1.1.1.1.2.cmml" xref="A1.E18.m1.7.7.1.1.1.1.2">𝑣</ci><ci id="A1.E18.m1.7.7.1.1.1.1.3.cmml" xref="A1.E18.m1.7.7.1.1.1.1.3">𝑖</ci></apply><apply id="A1.E18.m1.8.8.2.2.2.2.cmml" xref="A1.E18.m1.8.8.2.2.2.2"><csymbol cd="ambiguous" id="A1.E18.m1.8.8.2.2.2.2.1.cmml" xref="A1.E18.m1.8.8.2.2.2.2">subscript</csymbol><ci id="A1.E18.m1.8.8.2.2.2.2.2.cmml" xref="A1.E18.m1.8.8.2.2.2.2.2">𝑣</ci><ci id="A1.E18.m1.8.8.2.2.2.2.3.cmml" xref="A1.E18.m1.8.8.2.2.2.2.3">𝑗</ci></apply></list><ci id="A1.E18.m1.8.8.2.4.cmml" xref="A1.E18.m1.8.8.2.4">𝒩</ci></apply></apply><apply id="A1.E18.m1.9.9.cmml" xref="A1.E18.m1.9.9"><divide id="A1.E18.m1.9.9.2.cmml" xref="A1.E18.m1.9.9"></divide><apply id="A1.E18.m1.9.9.1.cmml" xref="A1.E18.m1.9.9.1"><times id="A1.E18.m1.9.9.1.2.cmml" xref="A1.E18.m1.9.9.1.2"></times><apply id="A1.E18.m1.9.9.1.1.2.cmml" xref="A1.E18.m1.9.9.1.1.1"><abs id="A1.E18.m1.9.9.1.1.2.1.cmml" xref="A1.E18.m1.9.9.1.1.1.2"></abs><apply id="A1.E18.m1.9.9.1.1.1.1.cmml" xref="A1.E18.m1.9.9.1.1.1.1"><csymbol cd="ambiguous" id="A1.E18.m1.9.9.1.1.1.1.1.cmml" xref="A1.E18.m1.9.9.1.1.1.1">subscript</csymbol><ci id="A1.E18.m1.9.9.1.1.1.1.2.cmml" xref="A1.E18.m1.9.9.1.1.1.1.2">𝐖</ci><apply id="A1.E18.m1.9.9.1.1.1.1.3.cmml" xref="A1.E18.m1.9.9.1.1.1.1.3"><times id="A1.E18.m1.9.9.1.1.1.1.3.1.cmml" xref="A1.E18.m1.9.9.1.1.1.1.3.1"></times><ci id="A1.E18.m1.9.9.1.1.1.1.3.2.cmml" xref="A1.E18.m1.9.9.1.1.1.1.3.2">𝑖</ci><ci id="A1.E18.m1.9.9.1.1.1.1.3.3.cmml" xref="A1.E18.m1.9.9.1.1.1.1.3.3">𝑗</ci></apply></apply></apply><apply id="A1.E18.m1.9.9.1.3.cmml" xref="A1.E18.m1.9.9.1.3"><csymbol cd="ambiguous" id="A1.E18.m1.9.9.1.3.1.cmml" xref="A1.E18.m1.9.9.1.3">subscript</csymbol><ci id="A1.E18.m1.9.9.1.3.2.cmml" xref="A1.E18.m1.9.9.1.3.2">𝑑</ci><ci id="A1.E18.m1.9.9.1.3.3.cmml" xref="A1.E18.m1.9.9.1.3.3">𝑖</ci></apply></apply><apply id="A1.E18.m1.9.9.3.cmml" xref="A1.E18.m1.9.9.3"><minus id="A1.E18.m1.9.9.3.1.cmml" xref="A1.E18.m1.9.9.3.1"></minus><cn id="A1.E18.m1.9.9.3.2.cmml" type="integer" xref="A1.E18.m1.9.9.3.2">1</cn><apply id="A1.E18.m1.9.9.3.3.cmml" xref="A1.E18.m1.9.9.3.3"><csymbol cd="ambiguous" id="A1.E18.m1.9.9.3.3.1.cmml" xref="A1.E18.m1.9.9.3.3">subscript</csymbol><ci id="A1.E18.m1.9.9.3.3.2.cmml" xref="A1.E18.m1.9.9.3.3.2">𝑝</ci><ci id="A1.E18.m1.9.9.3.3.3a.cmml" xref="A1.E18.m1.9.9.3.3.3"><mtext id="A1.E18.m1.9.9.3.3.3.cmml" mathsize="70%" xref="A1.E18.m1.9.9.3.3.3">halt</mtext></ci></apply></apply></apply></apply><ci id="A1.E18.m1.10.10.1.1.3.2.2.3.cmml" xref="A1.E18.m1.10.10.1.1.3.2.2.3">𝑘</ci></apply></apply></apply></apply><apply id="A1.E18.m1.10.10.1.1e.cmml" xref="A1.E18.m1.10.10.1"><ci id="A1.E18.m1.10.10.1.1.8.cmml" xref="A1.E18.m1.10.10.1.1.8">≕</ci><share href="https://arxiv.org/html/2410.03462v1#A1.E18.m1.10.10.1.1.3.cmml" id="A1.E18.m1.10.10.1.1f.cmml" xref="A1.E18.m1.10.10.1"></share><ci id="A1.E18.m1.10.10.1.1.9.cmml" xref="A1.E18.m1.10.10.1.1.9">𝑐</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E18.m1.10c">\|\psi(\omega_{k}^{(i)})\|_{1}\leq\max_{\omega_{k}^{(i)}\in\Omega}\sum_{\omega%
\textrm{ p.s. }\omega_{k}^{(i)}}\left|\frac{\widetilde{\omega}(\omega)f_{%
\textrm{len}(\omega)}}{p(\omega)}\right|\leq\sum_{k=0}^{\infty}|f_{k}|\left(%
\max_{v_{i},v_{j}\in\mathcal{N}}\frac{|\mathbf{W}_{ij}|d_{i}}{1-p_{\textrm{%
halt}}}\right)^{k}\eqqcolon c,</annotation><annotation encoding="application/x-llamapun" id="A1.E18.m1.10d">∥ italic_ψ ( italic_ω start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT ) ∥ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ≤ roman_max start_POSTSUBSCRIPT italic_ω start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT ∈ roman_Ω end_POSTSUBSCRIPT ∑ start_POSTSUBSCRIPT italic_ω p.s. italic_ω start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT end_POSTSUBSCRIPT | divide start_ARG over~ start_ARG italic_ω end_ARG ( italic_ω ) italic_f start_POSTSUBSCRIPT len ( italic_ω ) end_POSTSUBSCRIPT end_ARG start_ARG italic_p ( italic_ω ) end_ARG | ≤ ∑ start_POSTSUBSCRIPT italic_k = 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∞ end_POSTSUPERSCRIPT | italic_f start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT | ( roman_max start_POSTSUBSCRIPT italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ∈ caligraphic_N end_POSTSUBSCRIPT divide start_ARG | bold_W start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT | italic_d start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_ARG start_ARG 1 - italic_p start_POSTSUBSCRIPT halt end_POSTSUBSCRIPT end_ARG ) start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT ≕ italic_c ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(18)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A1.SS2.p4.8">which corresponds to the case of an infinite length walk that happens almost never.
Here, <math alttext="\omega\textrm{ p.s. }\omega_{k}^{(i)}" class="ltx_Math" display="inline" id="A1.SS2.p4.3.m1.1"><semantics id="A1.SS2.p4.3.m1.1a"><mrow id="A1.SS2.p4.3.m1.1.2" xref="A1.SS2.p4.3.m1.1.2.cmml"><mi id="A1.SS2.p4.3.m1.1.2.2" xref="A1.SS2.p4.3.m1.1.2.2.cmml">ω</mi><mo id="A1.SS2.p4.3.m1.1.2.1" xref="A1.SS2.p4.3.m1.1.2.1.cmml">⁢</mo><mtext id="A1.SS2.p4.3.m1.1.2.3" xref="A1.SS2.p4.3.m1.1.2.3a.cmml">&nbsp;p.s.&nbsp;</mtext><mo id="A1.SS2.p4.3.m1.1.2.1a" xref="A1.SS2.p4.3.m1.1.2.1.cmml">⁢</mo><msubsup id="A1.SS2.p4.3.m1.1.2.4" xref="A1.SS2.p4.3.m1.1.2.4.cmml"><mi id="A1.SS2.p4.3.m1.1.2.4.2.2" xref="A1.SS2.p4.3.m1.1.2.4.2.2.cmml">ω</mi><mi id="A1.SS2.p4.3.m1.1.2.4.2.3" xref="A1.SS2.p4.3.m1.1.2.4.2.3.cmml">k</mi><mrow id="A1.SS2.p4.3.m1.1.1.1.3" xref="A1.SS2.p4.3.m1.1.2.4.cmml"><mo id="A1.SS2.p4.3.m1.1.1.1.3.1" stretchy="false" xref="A1.SS2.p4.3.m1.1.2.4.cmml">(</mo><mi id="A1.SS2.p4.3.m1.1.1.1.1" xref="A1.SS2.p4.3.m1.1.1.1.1.cmml">i</mi><mo id="A1.SS2.p4.3.m1.1.1.1.3.2" stretchy="false" xref="A1.SS2.p4.3.m1.1.2.4.cmml">)</mo></mrow></msubsup></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p4.3.m1.1b"><apply id="A1.SS2.p4.3.m1.1.2.cmml" xref="A1.SS2.p4.3.m1.1.2"><times id="A1.SS2.p4.3.m1.1.2.1.cmml" xref="A1.SS2.p4.3.m1.1.2.1"></times><ci id="A1.SS2.p4.3.m1.1.2.2.cmml" xref="A1.SS2.p4.3.m1.1.2.2">𝜔</ci><ci id="A1.SS2.p4.3.m1.1.2.3a.cmml" xref="A1.SS2.p4.3.m1.1.2.3"><mtext id="A1.SS2.p4.3.m1.1.2.3.cmml" xref="A1.SS2.p4.3.m1.1.2.3">&nbsp;p.s.&nbsp;</mtext></ci><apply id="A1.SS2.p4.3.m1.1.2.4.cmml" xref="A1.SS2.p4.3.m1.1.2.4"><csymbol cd="ambiguous" id="A1.SS2.p4.3.m1.1.2.4.1.cmml" xref="A1.SS2.p4.3.m1.1.2.4">superscript</csymbol><apply id="A1.SS2.p4.3.m1.1.2.4.2.cmml" xref="A1.SS2.p4.3.m1.1.2.4"><csymbol cd="ambiguous" id="A1.SS2.p4.3.m1.1.2.4.2.1.cmml" xref="A1.SS2.p4.3.m1.1.2.4">subscript</csymbol><ci id="A1.SS2.p4.3.m1.1.2.4.2.2.cmml" xref="A1.SS2.p4.3.m1.1.2.4.2.2">𝜔</ci><ci id="A1.SS2.p4.3.m1.1.2.4.2.3.cmml" xref="A1.SS2.p4.3.m1.1.2.4.2.3">𝑘</ci></apply><ci id="A1.SS2.p4.3.m1.1.1.1.1.cmml" xref="A1.SS2.p4.3.m1.1.1.1.1">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p4.3.m1.1c">\omega\textrm{ p.s. }\omega_{k}^{(i)}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p4.3.m1.1d">italic_ω p.s. italic_ω start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT</annotation></semantics></math> means that <math alttext="\omega" class="ltx_Math" display="inline" id="A1.SS2.p4.4.m2.1"><semantics id="A1.SS2.p4.4.m2.1a"><mi id="A1.SS2.p4.4.m2.1.1" xref="A1.SS2.p4.4.m2.1.1.cmml">ω</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.p4.4.m2.1b"><ci id="A1.SS2.p4.4.m2.1.1.cmml" xref="A1.SS2.p4.4.m2.1.1">𝜔</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p4.4.m2.1c">\omega</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p4.4.m2.1d">italic_ω</annotation></semantics></math> is a ‘prefix subwalk’ of <math alttext="\omega_{k}^{(i)}" class="ltx_Math" display="inline" id="A1.SS2.p4.5.m3.1"><semantics id="A1.SS2.p4.5.m3.1a"><msubsup id="A1.SS2.p4.5.m3.1.2" xref="A1.SS2.p4.5.m3.1.2.cmml"><mi id="A1.SS2.p4.5.m3.1.2.2.2" xref="A1.SS2.p4.5.m3.1.2.2.2.cmml">ω</mi><mi id="A1.SS2.p4.5.m3.1.2.2.3" xref="A1.SS2.p4.5.m3.1.2.2.3.cmml">k</mi><mrow id="A1.SS2.p4.5.m3.1.1.1.3" xref="A1.SS2.p4.5.m3.1.2.cmml"><mo id="A1.SS2.p4.5.m3.1.1.1.3.1" stretchy="false" xref="A1.SS2.p4.5.m3.1.2.cmml">(</mo><mi id="A1.SS2.p4.5.m3.1.1.1.1" xref="A1.SS2.p4.5.m3.1.1.1.1.cmml">i</mi><mo id="A1.SS2.p4.5.m3.1.1.1.3.2" stretchy="false" xref="A1.SS2.p4.5.m3.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="A1.SS2.p4.5.m3.1b"><apply id="A1.SS2.p4.5.m3.1.2.cmml" xref="A1.SS2.p4.5.m3.1.2"><csymbol cd="ambiguous" id="A1.SS2.p4.5.m3.1.2.1.cmml" xref="A1.SS2.p4.5.m3.1.2">superscript</csymbol><apply id="A1.SS2.p4.5.m3.1.2.2.cmml" xref="A1.SS2.p4.5.m3.1.2"><csymbol cd="ambiguous" id="A1.SS2.p4.5.m3.1.2.2.1.cmml" xref="A1.SS2.p4.5.m3.1.2">subscript</csymbol><ci id="A1.SS2.p4.5.m3.1.2.2.2.cmml" xref="A1.SS2.p4.5.m3.1.2.2.2">𝜔</ci><ci id="A1.SS2.p4.5.m3.1.2.2.3.cmml" xref="A1.SS2.p4.5.m3.1.2.2.3">𝑘</ci></apply><ci id="A1.SS2.p4.5.m3.1.1.1.1.cmml" xref="A1.SS2.p4.5.m3.1.1.1.1">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p4.5.m3.1c">\omega_{k}^{(i)}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p4.5.m3.1d">italic_ω start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT</annotation></semantics></math>, so the first <math alttext="\textrm{len}(\omega)" class="ltx_Math" display="inline" id="A1.SS2.p4.6.m4.1"><semantics id="A1.SS2.p4.6.m4.1a"><mrow id="A1.SS2.p4.6.m4.1.2" xref="A1.SS2.p4.6.m4.1.2.cmml"><mtext id="A1.SS2.p4.6.m4.1.2.2" xref="A1.SS2.p4.6.m4.1.2.2a.cmml">len</mtext><mo id="A1.SS2.p4.6.m4.1.2.1" xref="A1.SS2.p4.6.m4.1.2.1.cmml">⁢</mo><mrow id="A1.SS2.p4.6.m4.1.2.3.2" xref="A1.SS2.p4.6.m4.1.2.cmml"><mo id="A1.SS2.p4.6.m4.1.2.3.2.1" stretchy="false" xref="A1.SS2.p4.6.m4.1.2.cmml">(</mo><mi id="A1.SS2.p4.6.m4.1.1" xref="A1.SS2.p4.6.m4.1.1.cmml">ω</mi><mo id="A1.SS2.p4.6.m4.1.2.3.2.2" stretchy="false" xref="A1.SS2.p4.6.m4.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p4.6.m4.1b"><apply id="A1.SS2.p4.6.m4.1.2.cmml" xref="A1.SS2.p4.6.m4.1.2"><times id="A1.SS2.p4.6.m4.1.2.1.cmml" xref="A1.SS2.p4.6.m4.1.2.1"></times><ci id="A1.SS2.p4.6.m4.1.2.2a.cmml" xref="A1.SS2.p4.6.m4.1.2.2"><mtext id="A1.SS2.p4.6.m4.1.2.2.cmml" xref="A1.SS2.p4.6.m4.1.2.2">len</mtext></ci><ci id="A1.SS2.p4.6.m4.1.1.cmml" xref="A1.SS2.p4.6.m4.1.1">𝜔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p4.6.m4.1c">\textrm{len}(\omega)</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p4.6.m4.1d">len ( italic_ω )</annotation></semantics></math> nodes of <math alttext="\omega_{k}^{(i)}" class="ltx_Math" display="inline" id="A1.SS2.p4.7.m5.1"><semantics id="A1.SS2.p4.7.m5.1a"><msubsup id="A1.SS2.p4.7.m5.1.2" xref="A1.SS2.p4.7.m5.1.2.cmml"><mi id="A1.SS2.p4.7.m5.1.2.2.2" xref="A1.SS2.p4.7.m5.1.2.2.2.cmml">ω</mi><mi id="A1.SS2.p4.7.m5.1.2.2.3" xref="A1.SS2.p4.7.m5.1.2.2.3.cmml">k</mi><mrow id="A1.SS2.p4.7.m5.1.1.1.3" xref="A1.SS2.p4.7.m5.1.2.cmml"><mo id="A1.SS2.p4.7.m5.1.1.1.3.1" stretchy="false" xref="A1.SS2.p4.7.m5.1.2.cmml">(</mo><mi id="A1.SS2.p4.7.m5.1.1.1.1" xref="A1.SS2.p4.7.m5.1.1.1.1.cmml">i</mi><mo id="A1.SS2.p4.7.m5.1.1.1.3.2" stretchy="false" xref="A1.SS2.p4.7.m5.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="A1.SS2.p4.7.m5.1b"><apply id="A1.SS2.p4.7.m5.1.2.cmml" xref="A1.SS2.p4.7.m5.1.2"><csymbol cd="ambiguous" id="A1.SS2.p4.7.m5.1.2.1.cmml" xref="A1.SS2.p4.7.m5.1.2">superscript</csymbol><apply id="A1.SS2.p4.7.m5.1.2.2.cmml" xref="A1.SS2.p4.7.m5.1.2"><csymbol cd="ambiguous" id="A1.SS2.p4.7.m5.1.2.2.1.cmml" xref="A1.SS2.p4.7.m5.1.2">subscript</csymbol><ci id="A1.SS2.p4.7.m5.1.2.2.2.cmml" xref="A1.SS2.p4.7.m5.1.2.2.2">𝜔</ci><ci id="A1.SS2.p4.7.m5.1.2.2.3.cmml" xref="A1.SS2.p4.7.m5.1.2.2.3">𝑘</ci></apply><ci id="A1.SS2.p4.7.m5.1.1.1.1.cmml" xref="A1.SS2.p4.7.m5.1.1.1.1">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p4.7.m5.1c">\omega_{k}^{(i)}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p4.7.m5.1d">italic_ω start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT</annotation></semantics></math> are exactly the nodes of <math alttext="\omega" class="ltx_Math" display="inline" id="A1.SS2.p4.8.m6.1"><semantics id="A1.SS2.p4.8.m6.1a"><mi id="A1.SS2.p4.8.m6.1.1" xref="A1.SS2.p4.8.m6.1.1.cmml">ω</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.p4.8.m6.1b"><ci id="A1.SS2.p4.8.m6.1.1.cmml" xref="A1.SS2.p4.8.m6.1.1">𝜔</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p4.8.m6.1c">\omega</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p4.8.m6.1d">italic_ω</annotation></semantics></math>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="A1.SS2.p5">
<p class="ltx_p" id="A1.SS2.p5.6">Suppose that <math alttext="c" class="ltx_Math" display="inline" id="A1.SS2.p5.1.m1.1"><semantics id="A1.SS2.p5.1.m1.1a"><mi id="A1.SS2.p5.1.m1.1.1" xref="A1.SS2.p5.1.m1.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.p5.1.m1.1b"><ci id="A1.SS2.p5.1.m1.1.1.cmml" xref="A1.SS2.p5.1.m1.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p5.1.m1.1c">c</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p5.1.m1.1d">italic_c</annotation></semantics></math> is finite.
This can be guaranteed for bounded <math alttext="f" class="ltx_Math" display="inline" id="A1.SS2.p5.2.m2.1"><semantics id="A1.SS2.p5.2.m2.1a"><mi id="A1.SS2.p5.2.m2.1.1" xref="A1.SS2.p5.2.m2.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.p5.2.m2.1b"><ci id="A1.SS2.p5.2.m2.1.1.cmml" xref="A1.SS2.p5.2.m2.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p5.2.m2.1c">f</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p5.2.m2.1d">italic_f</annotation></semantics></math> by normalisation of <math alttext="\mathbf{W}" class="ltx_Math" display="inline" id="A1.SS2.p5.3.m3.1"><semantics id="A1.SS2.p5.3.m3.1a"><mi id="A1.SS2.p5.3.m3.1.1" xref="A1.SS2.p5.3.m3.1.1.cmml">𝐖</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.p5.3.m3.1b"><ci id="A1.SS2.p5.3.m3.1.1.cmml" xref="A1.SS2.p5.3.m3.1.1">𝐖</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p5.3.m3.1c">\mathbf{W}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p5.3.m3.1d">bold_W</annotation></semantics></math>, multiplying by a scalar so that <math alttext="|\max_{v_{i},v_{j}\in\mathcal{N}}\frac{\mathbf{W}_{ij}d_{i}}{1-p}|<1" class="ltx_Math" display="inline" id="A1.SS2.p5.4.m4.3"><semantics id="A1.SS2.p5.4.m4.3a"><mrow id="A1.SS2.p5.4.m4.3.3" xref="A1.SS2.p5.4.m4.3.3.cmml"><mrow id="A1.SS2.p5.4.m4.3.3.1.1" xref="A1.SS2.p5.4.m4.3.3.1.2.cmml"><mo id="A1.SS2.p5.4.m4.3.3.1.1.2" stretchy="false" xref="A1.SS2.p5.4.m4.3.3.1.2.1.cmml">|</mo><mrow id="A1.SS2.p5.4.m4.3.3.1.1.1" xref="A1.SS2.p5.4.m4.3.3.1.1.1.cmml"><msub id="A1.SS2.p5.4.m4.3.3.1.1.1.1" xref="A1.SS2.p5.4.m4.3.3.1.1.1.1.cmml"><mi id="A1.SS2.p5.4.m4.3.3.1.1.1.1.2" xref="A1.SS2.p5.4.m4.3.3.1.1.1.1.2.cmml">max</mi><mrow id="A1.SS2.p5.4.m4.2.2.2" xref="A1.SS2.p5.4.m4.2.2.2.cmml"><mrow id="A1.SS2.p5.4.m4.2.2.2.2.2" xref="A1.SS2.p5.4.m4.2.2.2.2.3.cmml"><msub id="A1.SS2.p5.4.m4.1.1.1.1.1.1" xref="A1.SS2.p5.4.m4.1.1.1.1.1.1.cmml"><mi id="A1.SS2.p5.4.m4.1.1.1.1.1.1.2" xref="A1.SS2.p5.4.m4.1.1.1.1.1.1.2.cmml">v</mi><mi id="A1.SS2.p5.4.m4.1.1.1.1.1.1.3" xref="A1.SS2.p5.4.m4.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="A1.SS2.p5.4.m4.2.2.2.2.2.3" xref="A1.SS2.p5.4.m4.2.2.2.2.3.cmml">,</mo><msub id="A1.SS2.p5.4.m4.2.2.2.2.2.2" xref="A1.SS2.p5.4.m4.2.2.2.2.2.2.cmml"><mi id="A1.SS2.p5.4.m4.2.2.2.2.2.2.2" xref="A1.SS2.p5.4.m4.2.2.2.2.2.2.2.cmml">v</mi><mi id="A1.SS2.p5.4.m4.2.2.2.2.2.2.3" xref="A1.SS2.p5.4.m4.2.2.2.2.2.2.3.cmml">j</mi></msub></mrow><mo id="A1.SS2.p5.4.m4.2.2.2.3" xref="A1.SS2.p5.4.m4.2.2.2.3.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="A1.SS2.p5.4.m4.2.2.2.4" xref="A1.SS2.p5.4.m4.2.2.2.4.cmml">𝒩</mi></mrow></msub><mo id="A1.SS2.p5.4.m4.3.3.1.1.1a" lspace="0.167em" xref="A1.SS2.p5.4.m4.3.3.1.1.1.cmml">⁡</mo><mfrac id="A1.SS2.p5.4.m4.3.3.1.1.1.2" xref="A1.SS2.p5.4.m4.3.3.1.1.1.2.cmml"><mrow id="A1.SS2.p5.4.m4.3.3.1.1.1.2.2" xref="A1.SS2.p5.4.m4.3.3.1.1.1.2.2.cmml"><msub id="A1.SS2.p5.4.m4.3.3.1.1.1.2.2.2" xref="A1.SS2.p5.4.m4.3.3.1.1.1.2.2.2.cmml"><mi id="A1.SS2.p5.4.m4.3.3.1.1.1.2.2.2.2" xref="A1.SS2.p5.4.m4.3.3.1.1.1.2.2.2.2.cmml">𝐖</mi><mrow id="A1.SS2.p5.4.m4.3.3.1.1.1.2.2.2.3" xref="A1.SS2.p5.4.m4.3.3.1.1.1.2.2.2.3.cmml"><mi id="A1.SS2.p5.4.m4.3.3.1.1.1.2.2.2.3.2" xref="A1.SS2.p5.4.m4.3.3.1.1.1.2.2.2.3.2.cmml">i</mi><mo id="A1.SS2.p5.4.m4.3.3.1.1.1.2.2.2.3.1" xref="A1.SS2.p5.4.m4.3.3.1.1.1.2.2.2.3.1.cmml">⁢</mo><mi id="A1.SS2.p5.4.m4.3.3.1.1.1.2.2.2.3.3" xref="A1.SS2.p5.4.m4.3.3.1.1.1.2.2.2.3.3.cmml">j</mi></mrow></msub><mo id="A1.SS2.p5.4.m4.3.3.1.1.1.2.2.1" xref="A1.SS2.p5.4.m4.3.3.1.1.1.2.2.1.cmml">⁢</mo><msub id="A1.SS2.p5.4.m4.3.3.1.1.1.2.2.3" xref="A1.SS2.p5.4.m4.3.3.1.1.1.2.2.3.cmml"><mi id="A1.SS2.p5.4.m4.3.3.1.1.1.2.2.3.2" xref="A1.SS2.p5.4.m4.3.3.1.1.1.2.2.3.2.cmml">d</mi><mi id="A1.SS2.p5.4.m4.3.3.1.1.1.2.2.3.3" xref="A1.SS2.p5.4.m4.3.3.1.1.1.2.2.3.3.cmml">i</mi></msub></mrow><mrow id="A1.SS2.p5.4.m4.3.3.1.1.1.2.3" xref="A1.SS2.p5.4.m4.3.3.1.1.1.2.3.cmml"><mn id="A1.SS2.p5.4.m4.3.3.1.1.1.2.3.2" xref="A1.SS2.p5.4.m4.3.3.1.1.1.2.3.2.cmml">1</mn><mo id="A1.SS2.p5.4.m4.3.3.1.1.1.2.3.1" xref="A1.SS2.p5.4.m4.3.3.1.1.1.2.3.1.cmml">−</mo><mi id="A1.SS2.p5.4.m4.3.3.1.1.1.2.3.3" xref="A1.SS2.p5.4.m4.3.3.1.1.1.2.3.3.cmml">p</mi></mrow></mfrac></mrow><mo id="A1.SS2.p5.4.m4.3.3.1.1.3" stretchy="false" xref="A1.SS2.p5.4.m4.3.3.1.2.1.cmml">|</mo></mrow><mo id="A1.SS2.p5.4.m4.3.3.2" xref="A1.SS2.p5.4.m4.3.3.2.cmml">&lt;</mo><mn id="A1.SS2.p5.4.m4.3.3.3" xref="A1.SS2.p5.4.m4.3.3.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p5.4.m4.3b"><apply id="A1.SS2.p5.4.m4.3.3.cmml" xref="A1.SS2.p5.4.m4.3.3"><lt id="A1.SS2.p5.4.m4.3.3.2.cmml" xref="A1.SS2.p5.4.m4.3.3.2"></lt><apply id="A1.SS2.p5.4.m4.3.3.1.2.cmml" xref="A1.SS2.p5.4.m4.3.3.1.1"><abs id="A1.SS2.p5.4.m4.3.3.1.2.1.cmml" xref="A1.SS2.p5.4.m4.3.3.1.1.2"></abs><apply id="A1.SS2.p5.4.m4.3.3.1.1.1.cmml" xref="A1.SS2.p5.4.m4.3.3.1.1.1"><apply id="A1.SS2.p5.4.m4.3.3.1.1.1.1.cmml" xref="A1.SS2.p5.4.m4.3.3.1.1.1.1"><csymbol cd="ambiguous" id="A1.SS2.p5.4.m4.3.3.1.1.1.1.1.cmml" xref="A1.SS2.p5.4.m4.3.3.1.1.1.1">subscript</csymbol><max id="A1.SS2.p5.4.m4.3.3.1.1.1.1.2.cmml" xref="A1.SS2.p5.4.m4.3.3.1.1.1.1.2"></max><apply id="A1.SS2.p5.4.m4.2.2.2.cmml" xref="A1.SS2.p5.4.m4.2.2.2"><in id="A1.SS2.p5.4.m4.2.2.2.3.cmml" xref="A1.SS2.p5.4.m4.2.2.2.3"></in><list id="A1.SS2.p5.4.m4.2.2.2.2.3.cmml" xref="A1.SS2.p5.4.m4.2.2.2.2.2"><apply id="A1.SS2.p5.4.m4.1.1.1.1.1.1.cmml" xref="A1.SS2.p5.4.m4.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.SS2.p5.4.m4.1.1.1.1.1.1.1.cmml" xref="A1.SS2.p5.4.m4.1.1.1.1.1.1">subscript</csymbol><ci id="A1.SS2.p5.4.m4.1.1.1.1.1.1.2.cmml" xref="A1.SS2.p5.4.m4.1.1.1.1.1.1.2">𝑣</ci><ci id="A1.SS2.p5.4.m4.1.1.1.1.1.1.3.cmml" xref="A1.SS2.p5.4.m4.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="A1.SS2.p5.4.m4.2.2.2.2.2.2.cmml" xref="A1.SS2.p5.4.m4.2.2.2.2.2.2"><csymbol cd="ambiguous" id="A1.SS2.p5.4.m4.2.2.2.2.2.2.1.cmml" xref="A1.SS2.p5.4.m4.2.2.2.2.2.2">subscript</csymbol><ci id="A1.SS2.p5.4.m4.2.2.2.2.2.2.2.cmml" xref="A1.SS2.p5.4.m4.2.2.2.2.2.2.2">𝑣</ci><ci id="A1.SS2.p5.4.m4.2.2.2.2.2.2.3.cmml" xref="A1.SS2.p5.4.m4.2.2.2.2.2.2.3">𝑗</ci></apply></list><ci id="A1.SS2.p5.4.m4.2.2.2.4.cmml" xref="A1.SS2.p5.4.m4.2.2.2.4">𝒩</ci></apply></apply><apply id="A1.SS2.p5.4.m4.3.3.1.1.1.2.cmml" xref="A1.SS2.p5.4.m4.3.3.1.1.1.2"><divide id="A1.SS2.p5.4.m4.3.3.1.1.1.2.1.cmml" xref="A1.SS2.p5.4.m4.3.3.1.1.1.2"></divide><apply id="A1.SS2.p5.4.m4.3.3.1.1.1.2.2.cmml" xref="A1.SS2.p5.4.m4.3.3.1.1.1.2.2"><times id="A1.SS2.p5.4.m4.3.3.1.1.1.2.2.1.cmml" xref="A1.SS2.p5.4.m4.3.3.1.1.1.2.2.1"></times><apply id="A1.SS2.p5.4.m4.3.3.1.1.1.2.2.2.cmml" xref="A1.SS2.p5.4.m4.3.3.1.1.1.2.2.2"><csymbol cd="ambiguous" id="A1.SS2.p5.4.m4.3.3.1.1.1.2.2.2.1.cmml" xref="A1.SS2.p5.4.m4.3.3.1.1.1.2.2.2">subscript</csymbol><ci id="A1.SS2.p5.4.m4.3.3.1.1.1.2.2.2.2.cmml" xref="A1.SS2.p5.4.m4.3.3.1.1.1.2.2.2.2">𝐖</ci><apply id="A1.SS2.p5.4.m4.3.3.1.1.1.2.2.2.3.cmml" xref="A1.SS2.p5.4.m4.3.3.1.1.1.2.2.2.3"><times id="A1.SS2.p5.4.m4.3.3.1.1.1.2.2.2.3.1.cmml" xref="A1.SS2.p5.4.m4.3.3.1.1.1.2.2.2.3.1"></times><ci id="A1.SS2.p5.4.m4.3.3.1.1.1.2.2.2.3.2.cmml" xref="A1.SS2.p5.4.m4.3.3.1.1.1.2.2.2.3.2">𝑖</ci><ci id="A1.SS2.p5.4.m4.3.3.1.1.1.2.2.2.3.3.cmml" xref="A1.SS2.p5.4.m4.3.3.1.1.1.2.2.2.3.3">𝑗</ci></apply></apply><apply id="A1.SS2.p5.4.m4.3.3.1.1.1.2.2.3.cmml" xref="A1.SS2.p5.4.m4.3.3.1.1.1.2.2.3"><csymbol cd="ambiguous" id="A1.SS2.p5.4.m4.3.3.1.1.1.2.2.3.1.cmml" xref="A1.SS2.p5.4.m4.3.3.1.1.1.2.2.3">subscript</csymbol><ci id="A1.SS2.p5.4.m4.3.3.1.1.1.2.2.3.2.cmml" xref="A1.SS2.p5.4.m4.3.3.1.1.1.2.2.3.2">𝑑</ci><ci id="A1.SS2.p5.4.m4.3.3.1.1.1.2.2.3.3.cmml" xref="A1.SS2.p5.4.m4.3.3.1.1.1.2.2.3.3">𝑖</ci></apply></apply><apply id="A1.SS2.p5.4.m4.3.3.1.1.1.2.3.cmml" xref="A1.SS2.p5.4.m4.3.3.1.1.1.2.3"><minus id="A1.SS2.p5.4.m4.3.3.1.1.1.2.3.1.cmml" xref="A1.SS2.p5.4.m4.3.3.1.1.1.2.3.1"></minus><cn id="A1.SS2.p5.4.m4.3.3.1.1.1.2.3.2.cmml" type="integer" xref="A1.SS2.p5.4.m4.3.3.1.1.1.2.3.2">1</cn><ci id="A1.SS2.p5.4.m4.3.3.1.1.1.2.3.3.cmml" xref="A1.SS2.p5.4.m4.3.3.1.1.1.2.3.3">𝑝</ci></apply></apply></apply></apply><cn id="A1.SS2.p5.4.m4.3.3.3.cmml" type="integer" xref="A1.SS2.p5.4.m4.3.3.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p5.4.m4.3c">|\max_{v_{i},v_{j}\in\mathcal{N}}\frac{\mathbf{W}_{ij}d_{i}}{1-p}|&lt;1</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p5.4.m4.3d">| roman_max start_POSTSUBSCRIPT italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ∈ caligraphic_N end_POSTSUBSCRIPT divide start_ARG bold_W start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT italic_d start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_ARG start_ARG 1 - italic_p end_ARG | &lt; 1</annotation></semantics></math>.
More pragmatically, it can be achieved by stipulating that there exists some integer <math alttext="i_{\textrm{max}}\in\mathbb{N}" class="ltx_Math" display="inline" id="A1.SS2.p5.5.m5.1"><semantics id="A1.SS2.p5.5.m5.1a"><mrow id="A1.SS2.p5.5.m5.1.1" xref="A1.SS2.p5.5.m5.1.1.cmml"><msub id="A1.SS2.p5.5.m5.1.1.2" xref="A1.SS2.p5.5.m5.1.1.2.cmml"><mi id="A1.SS2.p5.5.m5.1.1.2.2" xref="A1.SS2.p5.5.m5.1.1.2.2.cmml">i</mi><mtext id="A1.SS2.p5.5.m5.1.1.2.3" xref="A1.SS2.p5.5.m5.1.1.2.3a.cmml">max</mtext></msub><mo id="A1.SS2.p5.5.m5.1.1.1" xref="A1.SS2.p5.5.m5.1.1.1.cmml">∈</mo><mi id="A1.SS2.p5.5.m5.1.1.3" xref="A1.SS2.p5.5.m5.1.1.3.cmml">ℕ</mi></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p5.5.m5.1b"><apply id="A1.SS2.p5.5.m5.1.1.cmml" xref="A1.SS2.p5.5.m5.1.1"><in id="A1.SS2.p5.5.m5.1.1.1.cmml" xref="A1.SS2.p5.5.m5.1.1.1"></in><apply id="A1.SS2.p5.5.m5.1.1.2.cmml" xref="A1.SS2.p5.5.m5.1.1.2"><csymbol cd="ambiguous" id="A1.SS2.p5.5.m5.1.1.2.1.cmml" xref="A1.SS2.p5.5.m5.1.1.2">subscript</csymbol><ci id="A1.SS2.p5.5.m5.1.1.2.2.cmml" xref="A1.SS2.p5.5.m5.1.1.2.2">𝑖</ci><ci id="A1.SS2.p5.5.m5.1.1.2.3a.cmml" xref="A1.SS2.p5.5.m5.1.1.2.3"><mtext id="A1.SS2.p5.5.m5.1.1.2.3.cmml" mathsize="70%" xref="A1.SS2.p5.5.m5.1.1.2.3">max</mtext></ci></apply><ci id="A1.SS2.p5.5.m5.1.1.3.cmml" xref="A1.SS2.p5.5.m5.1.1.3">ℕ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p5.5.m5.1c">i_{\textrm{max}}\in\mathbb{N}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p5.5.m5.1d">italic_i start_POSTSUBSCRIPT max end_POSTSUBSCRIPT ∈ blackboard_N</annotation></semantics></math> such that <math alttext="f_{i}=0\hskip 1.99997pt\forall\hskip 1.99997pti>i_{\textrm{max}}" class="ltx_Math" display="inline" id="A1.SS2.p5.6.m6.1"><semantics id="A1.SS2.p5.6.m6.1a"><mrow id="A1.SS2.p5.6.m6.1.1" xref="A1.SS2.p5.6.m6.1.1.cmml"><msub id="A1.SS2.p5.6.m6.1.1.2" xref="A1.SS2.p5.6.m6.1.1.2.cmml"><mi id="A1.SS2.p5.6.m6.1.1.2.2" xref="A1.SS2.p5.6.m6.1.1.2.2.cmml">f</mi><mi id="A1.SS2.p5.6.m6.1.1.2.3" xref="A1.SS2.p5.6.m6.1.1.2.3.cmml">i</mi></msub><mo id="A1.SS2.p5.6.m6.1.1.3" xref="A1.SS2.p5.6.m6.1.1.3.cmml">=</mo><mrow id="A1.SS2.p5.6.m6.1.1.4" xref="A1.SS2.p5.6.m6.1.1.4.cmml"><mn id="A1.SS2.p5.6.m6.1.1.4.2" xref="A1.SS2.p5.6.m6.1.1.4.2.cmml">0</mn><mo id="A1.SS2.p5.6.m6.1.1.4.1" lspace="0.367em" xref="A1.SS2.p5.6.m6.1.1.4.1.cmml">⁢</mo><mrow id="A1.SS2.p5.6.m6.1.1.4.3" xref="A1.SS2.p5.6.m6.1.1.4.3.cmml"><mo id="A1.SS2.p5.6.m6.1.1.4.3.1" rspace="0.367em" xref="A1.SS2.p5.6.m6.1.1.4.3.1.cmml">∀</mo><mi id="A1.SS2.p5.6.m6.1.1.4.3.2" xref="A1.SS2.p5.6.m6.1.1.4.3.2.cmml">i</mi></mrow></mrow><mo id="A1.SS2.p5.6.m6.1.1.5" xref="A1.SS2.p5.6.m6.1.1.5.cmml">&gt;</mo><msub id="A1.SS2.p5.6.m6.1.1.6" xref="A1.SS2.p5.6.m6.1.1.6.cmml"><mi id="A1.SS2.p5.6.m6.1.1.6.2" xref="A1.SS2.p5.6.m6.1.1.6.2.cmml">i</mi><mtext id="A1.SS2.p5.6.m6.1.1.6.3" xref="A1.SS2.p5.6.m6.1.1.6.3a.cmml">max</mtext></msub></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p5.6.m6.1b"><apply id="A1.SS2.p5.6.m6.1.1.cmml" xref="A1.SS2.p5.6.m6.1.1"><and id="A1.SS2.p5.6.m6.1.1a.cmml" xref="A1.SS2.p5.6.m6.1.1"></and><apply id="A1.SS2.p5.6.m6.1.1b.cmml" xref="A1.SS2.p5.6.m6.1.1"><eq id="A1.SS2.p5.6.m6.1.1.3.cmml" xref="A1.SS2.p5.6.m6.1.1.3"></eq><apply id="A1.SS2.p5.6.m6.1.1.2.cmml" xref="A1.SS2.p5.6.m6.1.1.2"><csymbol cd="ambiguous" id="A1.SS2.p5.6.m6.1.1.2.1.cmml" xref="A1.SS2.p5.6.m6.1.1.2">subscript</csymbol><ci id="A1.SS2.p5.6.m6.1.1.2.2.cmml" xref="A1.SS2.p5.6.m6.1.1.2.2">𝑓</ci><ci id="A1.SS2.p5.6.m6.1.1.2.3.cmml" xref="A1.SS2.p5.6.m6.1.1.2.3">𝑖</ci></apply><apply id="A1.SS2.p5.6.m6.1.1.4.cmml" xref="A1.SS2.p5.6.m6.1.1.4"><times id="A1.SS2.p5.6.m6.1.1.4.1.cmml" xref="A1.SS2.p5.6.m6.1.1.4.1"></times><cn id="A1.SS2.p5.6.m6.1.1.4.2.cmml" type="integer" xref="A1.SS2.p5.6.m6.1.1.4.2">0</cn><apply id="A1.SS2.p5.6.m6.1.1.4.3.cmml" xref="A1.SS2.p5.6.m6.1.1.4.3"><csymbol cd="latexml" id="A1.SS2.p5.6.m6.1.1.4.3.1.cmml" xref="A1.SS2.p5.6.m6.1.1.4.3.1">for-all</csymbol><ci id="A1.SS2.p5.6.m6.1.1.4.3.2.cmml" xref="A1.SS2.p5.6.m6.1.1.4.3.2">𝑖</ci></apply></apply></apply><apply id="A1.SS2.p5.6.m6.1.1c.cmml" xref="A1.SS2.p5.6.m6.1.1"><gt id="A1.SS2.p5.6.m6.1.1.5.cmml" xref="A1.SS2.p5.6.m6.1.1.5"></gt><share href="https://arxiv.org/html/2410.03462v1#A1.SS2.p5.6.m6.1.1.4.cmml" id="A1.SS2.p5.6.m6.1.1d.cmml" xref="A1.SS2.p5.6.m6.1.1"></share><apply id="A1.SS2.p5.6.m6.1.1.6.cmml" xref="A1.SS2.p5.6.m6.1.1.6"><csymbol cd="ambiguous" id="A1.SS2.p5.6.m6.1.1.6.1.cmml" xref="A1.SS2.p5.6.m6.1.1.6">subscript</csymbol><ci id="A1.SS2.p5.6.m6.1.1.6.2.cmml" xref="A1.SS2.p5.6.m6.1.1.6.2">𝑖</ci><ci id="A1.SS2.p5.6.m6.1.1.6.3a.cmml" xref="A1.SS2.p5.6.m6.1.1.6.3"><mtext id="A1.SS2.p5.6.m6.1.1.6.3.cmml" mathsize="70%" xref="A1.SS2.p5.6.m6.1.1.6.3">max</mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p5.6.m6.1c">f_{i}=0\hskip 1.99997pt\forall\hskip 1.99997pti&gt;i_{\textrm{max}}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p5.6.m6.1d">italic_f start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = 0 ∀ italic_i &gt; italic_i start_POSTSUBSCRIPT max end_POSTSUBSCRIPT</annotation></semantics></math>, so we only consider walks up to a certain length.
This is a natural choice in experiments since we want to keep the set of learnable parameters finite.
It also coincides with the intuition that very long walks should not reflect the relationship between the nodes of a graph of finite size.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="A1.SS2.p6">
<p class="ltx_p" id="A1.SS2.p6.4">We have seen that <math alttext="0<\|\psi(\omega_{k}^{(i))}\|_{1}\leq c" class="ltx_math_unparsed" display="inline" id="A1.SS2.p6.1.m1.1"><semantics id="A1.SS2.p6.1.m1.1a"><mrow id="A1.SS2.p6.1.m1.1b"><mn id="A1.SS2.p6.1.m1.1.2">0</mn><mo id="A1.SS2.p6.1.m1.1.3" rspace="0em">&lt;</mo><mo id="A1.SS2.p6.1.m1.1.4" lspace="0em" rspace="0.167em">∥</mo><mi id="A1.SS2.p6.1.m1.1.5">ψ</mi><mrow id="A1.SS2.p6.1.m1.1.6"><mo id="A1.SS2.p6.1.m1.1.6.1" stretchy="false">(</mo><msubsup id="A1.SS2.p6.1.m1.1.6.2"><mi id="A1.SS2.p6.1.m1.1.6.2.2.2">ω</mi><mi id="A1.SS2.p6.1.m1.1.6.2.2.3">k</mi><mrow id="A1.SS2.p6.1.m1.1.1.1"><mrow id="A1.SS2.p6.1.m1.1.1.1.2"><mo id="A1.SS2.p6.1.m1.1.1.1.2.1" stretchy="false">(</mo><mi id="A1.SS2.p6.1.m1.1.1.1.1">i</mi><mo id="A1.SS2.p6.1.m1.1.1.1.2.2" stretchy="false">)</mo></mrow><mo id="A1.SS2.p6.1.m1.1.1.1.3" stretchy="false">)</mo></mrow></msubsup><msub id="A1.SS2.p6.1.m1.1.6.3"><mo id="A1.SS2.p6.1.m1.1.6.3.2" lspace="0em" rspace="0.0835em">∥</mo><mn id="A1.SS2.p6.1.m1.1.6.3.3">1</mn></msub><mo id="A1.SS2.p6.1.m1.1.6.4" lspace="0.0835em">≤</mo><mi id="A1.SS2.p6.1.m1.1.6.5">c</mi></mrow></mrow><annotation encoding="application/x-tex" id="A1.SS2.p6.1.m1.1c">0&lt;\|\psi(\omega_{k}^{(i))}\|_{1}\leq c</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p6.1.m1.1d">0 &lt; ∥ italic_ψ ( italic_ω start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) ) end_POSTSUPERSCRIPT ∥ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ≤ italic_c</annotation></semantics></math>.
It follows that <math alttext="-c^{2}\leq\psi(\omega_{k_{1}}^{(i)})^{\top}\psi(\omega_{k_{2}}^{(j)})\leq c^{2%
}\hskip 1.99997pt\forall\hskip 1.99997pt(k_{1},k_{2},i,j)" class="ltx_Math" display="inline" id="A1.SS2.p6.2.m2.8"><semantics id="A1.SS2.p6.2.m2.8a"><mrow id="A1.SS2.p6.2.m2.8.8" xref="A1.SS2.p6.2.m2.8.8.cmml"><mrow id="A1.SS2.p6.2.m2.8.8.6" xref="A1.SS2.p6.2.m2.8.8.6.cmml"><mo id="A1.SS2.p6.2.m2.8.8.6a" xref="A1.SS2.p6.2.m2.8.8.6.cmml">−</mo><msup id="A1.SS2.p6.2.m2.8.8.6.2" xref="A1.SS2.p6.2.m2.8.8.6.2.cmml"><mi id="A1.SS2.p6.2.m2.8.8.6.2.2" xref="A1.SS2.p6.2.m2.8.8.6.2.2.cmml">c</mi><mn id="A1.SS2.p6.2.m2.8.8.6.2.3" xref="A1.SS2.p6.2.m2.8.8.6.2.3.cmml">2</mn></msup></mrow><mo id="A1.SS2.p6.2.m2.8.8.7" xref="A1.SS2.p6.2.m2.8.8.7.cmml">≤</mo><mrow id="A1.SS2.p6.2.m2.6.6.2" xref="A1.SS2.p6.2.m2.6.6.2.cmml"><mi id="A1.SS2.p6.2.m2.6.6.2.4" xref="A1.SS2.p6.2.m2.6.6.2.4.cmml">ψ</mi><mo id="A1.SS2.p6.2.m2.6.6.2.3" xref="A1.SS2.p6.2.m2.6.6.2.3.cmml">⁢</mo><msup id="A1.SS2.p6.2.m2.5.5.1.1" xref="A1.SS2.p6.2.m2.5.5.1.1.cmml"><mrow id="A1.SS2.p6.2.m2.5.5.1.1.1.1" xref="A1.SS2.p6.2.m2.5.5.1.1.1.1.1.cmml"><mo id="A1.SS2.p6.2.m2.5.5.1.1.1.1.2" stretchy="false" xref="A1.SS2.p6.2.m2.5.5.1.1.1.1.1.cmml">(</mo><msubsup id="A1.SS2.p6.2.m2.5.5.1.1.1.1.1" xref="A1.SS2.p6.2.m2.5.5.1.1.1.1.1.cmml"><mi id="A1.SS2.p6.2.m2.5.5.1.1.1.1.1.2.2" xref="A1.SS2.p6.2.m2.5.5.1.1.1.1.1.2.2.cmml">ω</mi><msub id="A1.SS2.p6.2.m2.5.5.1.1.1.1.1.2.3" xref="A1.SS2.p6.2.m2.5.5.1.1.1.1.1.2.3.cmml"><mi id="A1.SS2.p6.2.m2.5.5.1.1.1.1.1.2.3.2" xref="A1.SS2.p6.2.m2.5.5.1.1.1.1.1.2.3.2.cmml">k</mi><mn id="A1.SS2.p6.2.m2.5.5.1.1.1.1.1.2.3.3" xref="A1.SS2.p6.2.m2.5.5.1.1.1.1.1.2.3.3.cmml">1</mn></msub><mrow id="A1.SS2.p6.2.m2.1.1.1.3" xref="A1.SS2.p6.2.m2.5.5.1.1.1.1.1.cmml"><mo id="A1.SS2.p6.2.m2.1.1.1.3.1" stretchy="false" xref="A1.SS2.p6.2.m2.5.5.1.1.1.1.1.cmml">(</mo><mi id="A1.SS2.p6.2.m2.1.1.1.1" xref="A1.SS2.p6.2.m2.1.1.1.1.cmml">i</mi><mo id="A1.SS2.p6.2.m2.1.1.1.3.2" stretchy="false" xref="A1.SS2.p6.2.m2.5.5.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="A1.SS2.p6.2.m2.5.5.1.1.1.1.3" stretchy="false" xref="A1.SS2.p6.2.m2.5.5.1.1.1.1.1.cmml">)</mo></mrow><mo id="A1.SS2.p6.2.m2.5.5.1.1.3" xref="A1.SS2.p6.2.m2.5.5.1.1.3.cmml">⊤</mo></msup><mo id="A1.SS2.p6.2.m2.6.6.2.3a" xref="A1.SS2.p6.2.m2.6.6.2.3.cmml">⁢</mo><mi id="A1.SS2.p6.2.m2.6.6.2.5" xref="A1.SS2.p6.2.m2.6.6.2.5.cmml">ψ</mi><mo id="A1.SS2.p6.2.m2.6.6.2.3b" xref="A1.SS2.p6.2.m2.6.6.2.3.cmml">⁢</mo><mrow id="A1.SS2.p6.2.m2.6.6.2.2.1" xref="A1.SS2.p6.2.m2.6.6.2.2.1.1.cmml"><mo id="A1.SS2.p6.2.m2.6.6.2.2.1.2" stretchy="false" xref="A1.SS2.p6.2.m2.6.6.2.2.1.1.cmml">(</mo><msubsup id="A1.SS2.p6.2.m2.6.6.2.2.1.1" xref="A1.SS2.p6.2.m2.6.6.2.2.1.1.cmml"><mi id="A1.SS2.p6.2.m2.6.6.2.2.1.1.2.2" xref="A1.SS2.p6.2.m2.6.6.2.2.1.1.2.2.cmml">ω</mi><msub id="A1.SS2.p6.2.m2.6.6.2.2.1.1.2.3" xref="A1.SS2.p6.2.m2.6.6.2.2.1.1.2.3.cmml"><mi id="A1.SS2.p6.2.m2.6.6.2.2.1.1.2.3.2" xref="A1.SS2.p6.2.m2.6.6.2.2.1.1.2.3.2.cmml">k</mi><mn id="A1.SS2.p6.2.m2.6.6.2.2.1.1.2.3.3" xref="A1.SS2.p6.2.m2.6.6.2.2.1.1.2.3.3.cmml">2</mn></msub><mrow id="A1.SS2.p6.2.m2.2.2.1.3" xref="A1.SS2.p6.2.m2.6.6.2.2.1.1.cmml"><mo id="A1.SS2.p6.2.m2.2.2.1.3.1" stretchy="false" xref="A1.SS2.p6.2.m2.6.6.2.2.1.1.cmml">(</mo><mi id="A1.SS2.p6.2.m2.2.2.1.1" xref="A1.SS2.p6.2.m2.2.2.1.1.cmml">j</mi><mo id="A1.SS2.p6.2.m2.2.2.1.3.2" stretchy="false" xref="A1.SS2.p6.2.m2.6.6.2.2.1.1.cmml">)</mo></mrow></msubsup><mo id="A1.SS2.p6.2.m2.6.6.2.2.1.3" stretchy="false" xref="A1.SS2.p6.2.m2.6.6.2.2.1.1.cmml">)</mo></mrow></mrow><mo id="A1.SS2.p6.2.m2.8.8.8" xref="A1.SS2.p6.2.m2.8.8.8.cmml">≤</mo><mrow id="A1.SS2.p6.2.m2.8.8.4" xref="A1.SS2.p6.2.m2.8.8.4.cmml"><msup id="A1.SS2.p6.2.m2.8.8.4.4" xref="A1.SS2.p6.2.m2.8.8.4.4.cmml"><mi id="A1.SS2.p6.2.m2.8.8.4.4.2" xref="A1.SS2.p6.2.m2.8.8.4.4.2.cmml">c</mi><mn id="A1.SS2.p6.2.m2.8.8.4.4.3" xref="A1.SS2.p6.2.m2.8.8.4.4.3.cmml">2</mn></msup><mo id="A1.SS2.p6.2.m2.8.8.4.3" lspace="0.167em" xref="A1.SS2.p6.2.m2.8.8.4.3.cmml">⁢</mo><mrow id="A1.SS2.p6.2.m2.8.8.4.2" xref="A1.SS2.p6.2.m2.8.8.4.2.cmml"><mo id="A1.SS2.p6.2.m2.8.8.4.2.3" rspace="0.200em" xref="A1.SS2.p6.2.m2.8.8.4.2.3.cmml">∀</mo><mrow id="A1.SS2.p6.2.m2.8.8.4.2.2.2" xref="A1.SS2.p6.2.m2.8.8.4.2.2.3.cmml"><mo id="A1.SS2.p6.2.m2.8.8.4.2.2.2.3" stretchy="false" xref="A1.SS2.p6.2.m2.8.8.4.2.2.3.cmml">(</mo><msub id="A1.SS2.p6.2.m2.7.7.3.1.1.1.1" xref="A1.SS2.p6.2.m2.7.7.3.1.1.1.1.cmml"><mi id="A1.SS2.p6.2.m2.7.7.3.1.1.1.1.2" xref="A1.SS2.p6.2.m2.7.7.3.1.1.1.1.2.cmml">k</mi><mn id="A1.SS2.p6.2.m2.7.7.3.1.1.1.1.3" xref="A1.SS2.p6.2.m2.7.7.3.1.1.1.1.3.cmml">1</mn></msub><mo id="A1.SS2.p6.2.m2.8.8.4.2.2.2.4" xref="A1.SS2.p6.2.m2.8.8.4.2.2.3.cmml">,</mo><msub id="A1.SS2.p6.2.m2.8.8.4.2.2.2.2" xref="A1.SS2.p6.2.m2.8.8.4.2.2.2.2.cmml"><mi id="A1.SS2.p6.2.m2.8.8.4.2.2.2.2.2" xref="A1.SS2.p6.2.m2.8.8.4.2.2.2.2.2.cmml">k</mi><mn id="A1.SS2.p6.2.m2.8.8.4.2.2.2.2.3" xref="A1.SS2.p6.2.m2.8.8.4.2.2.2.2.3.cmml">2</mn></msub><mo id="A1.SS2.p6.2.m2.8.8.4.2.2.2.5" xref="A1.SS2.p6.2.m2.8.8.4.2.2.3.cmml">,</mo><mi id="A1.SS2.p6.2.m2.3.3" xref="A1.SS2.p6.2.m2.3.3.cmml">i</mi><mo id="A1.SS2.p6.2.m2.8.8.4.2.2.2.6" xref="A1.SS2.p6.2.m2.8.8.4.2.2.3.cmml">,</mo><mi id="A1.SS2.p6.2.m2.4.4" xref="A1.SS2.p6.2.m2.4.4.cmml">j</mi><mo id="A1.SS2.p6.2.m2.8.8.4.2.2.2.7" stretchy="false" xref="A1.SS2.p6.2.m2.8.8.4.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p6.2.m2.8b"><apply id="A1.SS2.p6.2.m2.8.8.cmml" xref="A1.SS2.p6.2.m2.8.8"><and id="A1.SS2.p6.2.m2.8.8a.cmml" xref="A1.SS2.p6.2.m2.8.8"></and><apply id="A1.SS2.p6.2.m2.8.8b.cmml" xref="A1.SS2.p6.2.m2.8.8"><leq id="A1.SS2.p6.2.m2.8.8.7.cmml" xref="A1.SS2.p6.2.m2.8.8.7"></leq><apply id="A1.SS2.p6.2.m2.8.8.6.cmml" xref="A1.SS2.p6.2.m2.8.8.6"><minus id="A1.SS2.p6.2.m2.8.8.6.1.cmml" xref="A1.SS2.p6.2.m2.8.8.6"></minus><apply id="A1.SS2.p6.2.m2.8.8.6.2.cmml" xref="A1.SS2.p6.2.m2.8.8.6.2"><csymbol cd="ambiguous" id="A1.SS2.p6.2.m2.8.8.6.2.1.cmml" xref="A1.SS2.p6.2.m2.8.8.6.2">superscript</csymbol><ci id="A1.SS2.p6.2.m2.8.8.6.2.2.cmml" xref="A1.SS2.p6.2.m2.8.8.6.2.2">𝑐</ci><cn id="A1.SS2.p6.2.m2.8.8.6.2.3.cmml" type="integer" xref="A1.SS2.p6.2.m2.8.8.6.2.3">2</cn></apply></apply><apply id="A1.SS2.p6.2.m2.6.6.2.cmml" xref="A1.SS2.p6.2.m2.6.6.2"><times id="A1.SS2.p6.2.m2.6.6.2.3.cmml" xref="A1.SS2.p6.2.m2.6.6.2.3"></times><ci id="A1.SS2.p6.2.m2.6.6.2.4.cmml" xref="A1.SS2.p6.2.m2.6.6.2.4">𝜓</ci><apply id="A1.SS2.p6.2.m2.5.5.1.1.cmml" xref="A1.SS2.p6.2.m2.5.5.1.1"><csymbol cd="ambiguous" id="A1.SS2.p6.2.m2.5.5.1.1.2.cmml" xref="A1.SS2.p6.2.m2.5.5.1.1">superscript</csymbol><apply id="A1.SS2.p6.2.m2.5.5.1.1.1.1.1.cmml" xref="A1.SS2.p6.2.m2.5.5.1.1.1.1"><csymbol cd="ambiguous" id="A1.SS2.p6.2.m2.5.5.1.1.1.1.1.1.cmml" xref="A1.SS2.p6.2.m2.5.5.1.1.1.1">superscript</csymbol><apply id="A1.SS2.p6.2.m2.5.5.1.1.1.1.1.2.cmml" xref="A1.SS2.p6.2.m2.5.5.1.1.1.1"><csymbol cd="ambiguous" id="A1.SS2.p6.2.m2.5.5.1.1.1.1.1.2.1.cmml" xref="A1.SS2.p6.2.m2.5.5.1.1.1.1">subscript</csymbol><ci id="A1.SS2.p6.2.m2.5.5.1.1.1.1.1.2.2.cmml" xref="A1.SS2.p6.2.m2.5.5.1.1.1.1.1.2.2">𝜔</ci><apply id="A1.SS2.p6.2.m2.5.5.1.1.1.1.1.2.3.cmml" xref="A1.SS2.p6.2.m2.5.5.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="A1.SS2.p6.2.m2.5.5.1.1.1.1.1.2.3.1.cmml" xref="A1.SS2.p6.2.m2.5.5.1.1.1.1.1.2.3">subscript</csymbol><ci id="A1.SS2.p6.2.m2.5.5.1.1.1.1.1.2.3.2.cmml" xref="A1.SS2.p6.2.m2.5.5.1.1.1.1.1.2.3.2">𝑘</ci><cn id="A1.SS2.p6.2.m2.5.5.1.1.1.1.1.2.3.3.cmml" type="integer" xref="A1.SS2.p6.2.m2.5.5.1.1.1.1.1.2.3.3">1</cn></apply></apply><ci id="A1.SS2.p6.2.m2.1.1.1.1.cmml" xref="A1.SS2.p6.2.m2.1.1.1.1">𝑖</ci></apply><csymbol cd="latexml" id="A1.SS2.p6.2.m2.5.5.1.1.3.cmml" xref="A1.SS2.p6.2.m2.5.5.1.1.3">top</csymbol></apply><ci id="A1.SS2.p6.2.m2.6.6.2.5.cmml" xref="A1.SS2.p6.2.m2.6.6.2.5">𝜓</ci><apply id="A1.SS2.p6.2.m2.6.6.2.2.1.1.cmml" xref="A1.SS2.p6.2.m2.6.6.2.2.1"><csymbol cd="ambiguous" id="A1.SS2.p6.2.m2.6.6.2.2.1.1.1.cmml" xref="A1.SS2.p6.2.m2.6.6.2.2.1">superscript</csymbol><apply id="A1.SS2.p6.2.m2.6.6.2.2.1.1.2.cmml" xref="A1.SS2.p6.2.m2.6.6.2.2.1"><csymbol cd="ambiguous" id="A1.SS2.p6.2.m2.6.6.2.2.1.1.2.1.cmml" xref="A1.SS2.p6.2.m2.6.6.2.2.1">subscript</csymbol><ci id="A1.SS2.p6.2.m2.6.6.2.2.1.1.2.2.cmml" xref="A1.SS2.p6.2.m2.6.6.2.2.1.1.2.2">𝜔</ci><apply id="A1.SS2.p6.2.m2.6.6.2.2.1.1.2.3.cmml" xref="A1.SS2.p6.2.m2.6.6.2.2.1.1.2.3"><csymbol cd="ambiguous" id="A1.SS2.p6.2.m2.6.6.2.2.1.1.2.3.1.cmml" xref="A1.SS2.p6.2.m2.6.6.2.2.1.1.2.3">subscript</csymbol><ci id="A1.SS2.p6.2.m2.6.6.2.2.1.1.2.3.2.cmml" xref="A1.SS2.p6.2.m2.6.6.2.2.1.1.2.3.2">𝑘</ci><cn id="A1.SS2.p6.2.m2.6.6.2.2.1.1.2.3.3.cmml" type="integer" xref="A1.SS2.p6.2.m2.6.6.2.2.1.1.2.3.3">2</cn></apply></apply><ci id="A1.SS2.p6.2.m2.2.2.1.1.cmml" xref="A1.SS2.p6.2.m2.2.2.1.1">𝑗</ci></apply></apply></apply><apply id="A1.SS2.p6.2.m2.8.8c.cmml" xref="A1.SS2.p6.2.m2.8.8"><leq id="A1.SS2.p6.2.m2.8.8.8.cmml" xref="A1.SS2.p6.2.m2.8.8.8"></leq><share href="https://arxiv.org/html/2410.03462v1#A1.SS2.p6.2.m2.6.6.2.cmml" id="A1.SS2.p6.2.m2.8.8d.cmml" xref="A1.SS2.p6.2.m2.8.8"></share><apply id="A1.SS2.p6.2.m2.8.8.4.cmml" xref="A1.SS2.p6.2.m2.8.8.4"><times id="A1.SS2.p6.2.m2.8.8.4.3.cmml" xref="A1.SS2.p6.2.m2.8.8.4.3"></times><apply id="A1.SS2.p6.2.m2.8.8.4.4.cmml" xref="A1.SS2.p6.2.m2.8.8.4.4"><csymbol cd="ambiguous" id="A1.SS2.p6.2.m2.8.8.4.4.1.cmml" xref="A1.SS2.p6.2.m2.8.8.4.4">superscript</csymbol><ci id="A1.SS2.p6.2.m2.8.8.4.4.2.cmml" xref="A1.SS2.p6.2.m2.8.8.4.4.2">𝑐</ci><cn id="A1.SS2.p6.2.m2.8.8.4.4.3.cmml" type="integer" xref="A1.SS2.p6.2.m2.8.8.4.4.3">2</cn></apply><apply id="A1.SS2.p6.2.m2.8.8.4.2.cmml" xref="A1.SS2.p6.2.m2.8.8.4.2"><csymbol cd="latexml" id="A1.SS2.p6.2.m2.8.8.4.2.3.cmml" xref="A1.SS2.p6.2.m2.8.8.4.2.3">for-all</csymbol><vector id="A1.SS2.p6.2.m2.8.8.4.2.2.3.cmml" xref="A1.SS2.p6.2.m2.8.8.4.2.2.2"><apply id="A1.SS2.p6.2.m2.7.7.3.1.1.1.1.cmml" xref="A1.SS2.p6.2.m2.7.7.3.1.1.1.1"><csymbol cd="ambiguous" id="A1.SS2.p6.2.m2.7.7.3.1.1.1.1.1.cmml" xref="A1.SS2.p6.2.m2.7.7.3.1.1.1.1">subscript</csymbol><ci id="A1.SS2.p6.2.m2.7.7.3.1.1.1.1.2.cmml" xref="A1.SS2.p6.2.m2.7.7.3.1.1.1.1.2">𝑘</ci><cn id="A1.SS2.p6.2.m2.7.7.3.1.1.1.1.3.cmml" type="integer" xref="A1.SS2.p6.2.m2.7.7.3.1.1.1.1.3">1</cn></apply><apply id="A1.SS2.p6.2.m2.8.8.4.2.2.2.2.cmml" xref="A1.SS2.p6.2.m2.8.8.4.2.2.2.2"><csymbol cd="ambiguous" id="A1.SS2.p6.2.m2.8.8.4.2.2.2.2.1.cmml" xref="A1.SS2.p6.2.m2.8.8.4.2.2.2.2">subscript</csymbol><ci id="A1.SS2.p6.2.m2.8.8.4.2.2.2.2.2.cmml" xref="A1.SS2.p6.2.m2.8.8.4.2.2.2.2.2">𝑘</ci><cn id="A1.SS2.p6.2.m2.8.8.4.2.2.2.2.3.cmml" type="integer" xref="A1.SS2.p6.2.m2.8.8.4.2.2.2.2.3">2</cn></apply><ci id="A1.SS2.p6.2.m2.3.3.cmml" xref="A1.SS2.p6.2.m2.3.3">𝑖</ci><ci id="A1.SS2.p6.2.m2.4.4.cmml" xref="A1.SS2.p6.2.m2.4.4">𝑗</ci></vector></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p6.2.m2.8c">-c^{2}\leq\psi(\omega_{k_{1}}^{(i)})^{\top}\psi(\omega_{k_{2}}^{(j)})\leq c^{2%
}\hskip 1.99997pt\forall\hskip 1.99997pt(k_{1},k_{2},i,j)</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p6.2.m2.8d">- italic_c start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ≤ italic_ψ ( italic_ω start_POSTSUBSCRIPT italic_k start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT italic_ψ ( italic_ω start_POSTSUBSCRIPT italic_k start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_j ) end_POSTSUPERSCRIPT ) ≤ italic_c start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ∀ ( italic_k start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_k start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , italic_i , italic_j )</annotation></semantics></math>, whereupon the change in <math alttext="\widehat{\mathbf{M}}_{\alpha ij}" class="ltx_Math" display="inline" id="A1.SS2.p6.3.m3.1"><semantics id="A1.SS2.p6.3.m3.1a"><msub id="A1.SS2.p6.3.m3.1.1" xref="A1.SS2.p6.3.m3.1.1.cmml"><mover accent="true" id="A1.SS2.p6.3.m3.1.1.2" xref="A1.SS2.p6.3.m3.1.1.2.cmml"><mi id="A1.SS2.p6.3.m3.1.1.2.2" xref="A1.SS2.p6.3.m3.1.1.2.2.cmml">𝐌</mi><mo id="A1.SS2.p6.3.m3.1.1.2.1" xref="A1.SS2.p6.3.m3.1.1.2.1.cmml">^</mo></mover><mrow id="A1.SS2.p6.3.m3.1.1.3" xref="A1.SS2.p6.3.m3.1.1.3.cmml"><mi id="A1.SS2.p6.3.m3.1.1.3.2" xref="A1.SS2.p6.3.m3.1.1.3.2.cmml">α</mi><mo id="A1.SS2.p6.3.m3.1.1.3.1" xref="A1.SS2.p6.3.m3.1.1.3.1.cmml">⁢</mo><mi id="A1.SS2.p6.3.m3.1.1.3.3" xref="A1.SS2.p6.3.m3.1.1.3.3.cmml">i</mi><mo id="A1.SS2.p6.3.m3.1.1.3.1a" xref="A1.SS2.p6.3.m3.1.1.3.1.cmml">⁢</mo><mi id="A1.SS2.p6.3.m3.1.1.3.4" xref="A1.SS2.p6.3.m3.1.1.3.4.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="A1.SS2.p6.3.m3.1b"><apply id="A1.SS2.p6.3.m3.1.1.cmml" xref="A1.SS2.p6.3.m3.1.1"><csymbol cd="ambiguous" id="A1.SS2.p6.3.m3.1.1.1.cmml" xref="A1.SS2.p6.3.m3.1.1">subscript</csymbol><apply id="A1.SS2.p6.3.m3.1.1.2.cmml" xref="A1.SS2.p6.3.m3.1.1.2"><ci id="A1.SS2.p6.3.m3.1.1.2.1.cmml" xref="A1.SS2.p6.3.m3.1.1.2.1">^</ci><ci id="A1.SS2.p6.3.m3.1.1.2.2.cmml" xref="A1.SS2.p6.3.m3.1.1.2.2">𝐌</ci></apply><apply id="A1.SS2.p6.3.m3.1.1.3.cmml" xref="A1.SS2.p6.3.m3.1.1.3"><times id="A1.SS2.p6.3.m3.1.1.3.1.cmml" xref="A1.SS2.p6.3.m3.1.1.3.1"></times><ci id="A1.SS2.p6.3.m3.1.1.3.2.cmml" xref="A1.SS2.p6.3.m3.1.1.3.2">𝛼</ci><ci id="A1.SS2.p6.3.m3.1.1.3.3.cmml" xref="A1.SS2.p6.3.m3.1.1.3.3">𝑖</ci><ci id="A1.SS2.p6.3.m3.1.1.3.4.cmml" xref="A1.SS2.p6.3.m3.1.1.3.4">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p6.3.m3.1c">\widehat{\mathbf{M}}_{\alpha ij}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p6.3.m3.1d">over^ start_ARG bold_M end_ARG start_POSTSUBSCRIPT italic_α italic_i italic_j end_POSTSUBSCRIPT</annotation></semantics></math> if we modify <math alttext="X_{k}" class="ltx_Math" display="inline" id="A1.SS2.p6.4.m4.1"><semantics id="A1.SS2.p6.4.m4.1a"><msub id="A1.SS2.p6.4.m4.1.1" xref="A1.SS2.p6.4.m4.1.1.cmml"><mi id="A1.SS2.p6.4.m4.1.1.2" xref="A1.SS2.p6.4.m4.1.1.2.cmml">X</mi><mi id="A1.SS2.p6.4.m4.1.1.3" xref="A1.SS2.p6.4.m4.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS2.p6.4.m4.1b"><apply id="A1.SS2.p6.4.m4.1.1.cmml" xref="A1.SS2.p6.4.m4.1.1"><csymbol cd="ambiguous" id="A1.SS2.p6.4.m4.1.1.1.cmml" xref="A1.SS2.p6.4.m4.1.1">subscript</csymbol><ci id="A1.SS2.p6.4.m4.1.1.2.cmml" xref="A1.SS2.p6.4.m4.1.1.2">𝑋</ci><ci id="A1.SS2.p6.4.m4.1.1.3.cmml" xref="A1.SS2.p6.4.m4.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p6.4.m4.1c">X_{k}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p6.4.m4.1d">italic_X start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> obeys</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equation ltx_eqn_table" id="A1.E19">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="|\Delta\widehat{\mathbf{M}}_{\alpha ij}|\leq 2\frac{2n-1}{n^{2}}c^{2}." class="ltx_Math" display="block" id="A1.E19.m1.1"><semantics id="A1.E19.m1.1a"><mrow id="A1.E19.m1.1.1.1" xref="A1.E19.m1.1.1.1.1.cmml"><mrow id="A1.E19.m1.1.1.1.1" xref="A1.E19.m1.1.1.1.1.cmml"><mrow id="A1.E19.m1.1.1.1.1.1.1" xref="A1.E19.m1.1.1.1.1.1.2.cmml"><mo id="A1.E19.m1.1.1.1.1.1.1.2" stretchy="false" xref="A1.E19.m1.1.1.1.1.1.2.1.cmml">|</mo><mrow id="A1.E19.m1.1.1.1.1.1.1.1" xref="A1.E19.m1.1.1.1.1.1.1.1.cmml"><mi id="A1.E19.m1.1.1.1.1.1.1.1.2" mathvariant="normal" xref="A1.E19.m1.1.1.1.1.1.1.1.2.cmml">Δ</mi><mo id="A1.E19.m1.1.1.1.1.1.1.1.1" xref="A1.E19.m1.1.1.1.1.1.1.1.1.cmml">⁢</mo><msub id="A1.E19.m1.1.1.1.1.1.1.1.3" xref="A1.E19.m1.1.1.1.1.1.1.1.3.cmml"><mover accent="true" id="A1.E19.m1.1.1.1.1.1.1.1.3.2" xref="A1.E19.m1.1.1.1.1.1.1.1.3.2.cmml"><mi id="A1.E19.m1.1.1.1.1.1.1.1.3.2.2" xref="A1.E19.m1.1.1.1.1.1.1.1.3.2.2.cmml">𝐌</mi><mo id="A1.E19.m1.1.1.1.1.1.1.1.3.2.1" xref="A1.E19.m1.1.1.1.1.1.1.1.3.2.1.cmml">^</mo></mover><mrow id="A1.E19.m1.1.1.1.1.1.1.1.3.3" xref="A1.E19.m1.1.1.1.1.1.1.1.3.3.cmml"><mi id="A1.E19.m1.1.1.1.1.1.1.1.3.3.2" xref="A1.E19.m1.1.1.1.1.1.1.1.3.3.2.cmml">α</mi><mo id="A1.E19.m1.1.1.1.1.1.1.1.3.3.1" xref="A1.E19.m1.1.1.1.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="A1.E19.m1.1.1.1.1.1.1.1.3.3.3" xref="A1.E19.m1.1.1.1.1.1.1.1.3.3.3.cmml">i</mi><mo id="A1.E19.m1.1.1.1.1.1.1.1.3.3.1a" xref="A1.E19.m1.1.1.1.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="A1.E19.m1.1.1.1.1.1.1.1.3.3.4" xref="A1.E19.m1.1.1.1.1.1.1.1.3.3.4.cmml">j</mi></mrow></msub></mrow><mo id="A1.E19.m1.1.1.1.1.1.1.3" stretchy="false" xref="A1.E19.m1.1.1.1.1.1.2.1.cmml">|</mo></mrow><mo id="A1.E19.m1.1.1.1.1.2" xref="A1.E19.m1.1.1.1.1.2.cmml">≤</mo><mrow id="A1.E19.m1.1.1.1.1.3" xref="A1.E19.m1.1.1.1.1.3.cmml"><mn id="A1.E19.m1.1.1.1.1.3.2" xref="A1.E19.m1.1.1.1.1.3.2.cmml">2</mn><mo id="A1.E19.m1.1.1.1.1.3.1" xref="A1.E19.m1.1.1.1.1.3.1.cmml">⁢</mo><mfrac id="A1.E19.m1.1.1.1.1.3.3" xref="A1.E19.m1.1.1.1.1.3.3.cmml"><mrow id="A1.E19.m1.1.1.1.1.3.3.2" xref="A1.E19.m1.1.1.1.1.3.3.2.cmml"><mrow id="A1.E19.m1.1.1.1.1.3.3.2.2" xref="A1.E19.m1.1.1.1.1.3.3.2.2.cmml"><mn id="A1.E19.m1.1.1.1.1.3.3.2.2.2" xref="A1.E19.m1.1.1.1.1.3.3.2.2.2.cmml">2</mn><mo id="A1.E19.m1.1.1.1.1.3.3.2.2.1" xref="A1.E19.m1.1.1.1.1.3.3.2.2.1.cmml">⁢</mo><mi id="A1.E19.m1.1.1.1.1.3.3.2.2.3" xref="A1.E19.m1.1.1.1.1.3.3.2.2.3.cmml">n</mi></mrow><mo id="A1.E19.m1.1.1.1.1.3.3.2.1" xref="A1.E19.m1.1.1.1.1.3.3.2.1.cmml">−</mo><mn id="A1.E19.m1.1.1.1.1.3.3.2.3" xref="A1.E19.m1.1.1.1.1.3.3.2.3.cmml">1</mn></mrow><msup id="A1.E19.m1.1.1.1.1.3.3.3" xref="A1.E19.m1.1.1.1.1.3.3.3.cmml"><mi id="A1.E19.m1.1.1.1.1.3.3.3.2" xref="A1.E19.m1.1.1.1.1.3.3.3.2.cmml">n</mi><mn id="A1.E19.m1.1.1.1.1.3.3.3.3" xref="A1.E19.m1.1.1.1.1.3.3.3.3.cmml">2</mn></msup></mfrac><mo id="A1.E19.m1.1.1.1.1.3.1a" xref="A1.E19.m1.1.1.1.1.3.1.cmml">⁢</mo><msup id="A1.E19.m1.1.1.1.1.3.4" xref="A1.E19.m1.1.1.1.1.3.4.cmml"><mi id="A1.E19.m1.1.1.1.1.3.4.2" xref="A1.E19.m1.1.1.1.1.3.4.2.cmml">c</mi><mn id="A1.E19.m1.1.1.1.1.3.4.3" xref="A1.E19.m1.1.1.1.1.3.4.3.cmml">2</mn></msup></mrow></mrow><mo id="A1.E19.m1.1.1.1.2" lspace="0em" xref="A1.E19.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.E19.m1.1b"><apply id="A1.E19.m1.1.1.1.1.cmml" xref="A1.E19.m1.1.1.1"><leq id="A1.E19.m1.1.1.1.1.2.cmml" xref="A1.E19.m1.1.1.1.1.2"></leq><apply id="A1.E19.m1.1.1.1.1.1.2.cmml" xref="A1.E19.m1.1.1.1.1.1.1"><abs id="A1.E19.m1.1.1.1.1.1.2.1.cmml" xref="A1.E19.m1.1.1.1.1.1.1.2"></abs><apply id="A1.E19.m1.1.1.1.1.1.1.1.cmml" xref="A1.E19.m1.1.1.1.1.1.1.1"><times id="A1.E19.m1.1.1.1.1.1.1.1.1.cmml" xref="A1.E19.m1.1.1.1.1.1.1.1.1"></times><ci id="A1.E19.m1.1.1.1.1.1.1.1.2.cmml" xref="A1.E19.m1.1.1.1.1.1.1.1.2">Δ</ci><apply id="A1.E19.m1.1.1.1.1.1.1.1.3.cmml" xref="A1.E19.m1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.E19.m1.1.1.1.1.1.1.1.3.1.cmml" xref="A1.E19.m1.1.1.1.1.1.1.1.3">subscript</csymbol><apply id="A1.E19.m1.1.1.1.1.1.1.1.3.2.cmml" xref="A1.E19.m1.1.1.1.1.1.1.1.3.2"><ci id="A1.E19.m1.1.1.1.1.1.1.1.3.2.1.cmml" xref="A1.E19.m1.1.1.1.1.1.1.1.3.2.1">^</ci><ci id="A1.E19.m1.1.1.1.1.1.1.1.3.2.2.cmml" xref="A1.E19.m1.1.1.1.1.1.1.1.3.2.2">𝐌</ci></apply><apply id="A1.E19.m1.1.1.1.1.1.1.1.3.3.cmml" xref="A1.E19.m1.1.1.1.1.1.1.1.3.3"><times id="A1.E19.m1.1.1.1.1.1.1.1.3.3.1.cmml" xref="A1.E19.m1.1.1.1.1.1.1.1.3.3.1"></times><ci id="A1.E19.m1.1.1.1.1.1.1.1.3.3.2.cmml" xref="A1.E19.m1.1.1.1.1.1.1.1.3.3.2">𝛼</ci><ci id="A1.E19.m1.1.1.1.1.1.1.1.3.3.3.cmml" xref="A1.E19.m1.1.1.1.1.1.1.1.3.3.3">𝑖</ci><ci id="A1.E19.m1.1.1.1.1.1.1.1.3.3.4.cmml" xref="A1.E19.m1.1.1.1.1.1.1.1.3.3.4">𝑗</ci></apply></apply></apply></apply><apply id="A1.E19.m1.1.1.1.1.3.cmml" xref="A1.E19.m1.1.1.1.1.3"><times id="A1.E19.m1.1.1.1.1.3.1.cmml" xref="A1.E19.m1.1.1.1.1.3.1"></times><cn id="A1.E19.m1.1.1.1.1.3.2.cmml" type="integer" xref="A1.E19.m1.1.1.1.1.3.2">2</cn><apply id="A1.E19.m1.1.1.1.1.3.3.cmml" xref="A1.E19.m1.1.1.1.1.3.3"><divide id="A1.E19.m1.1.1.1.1.3.3.1.cmml" xref="A1.E19.m1.1.1.1.1.3.3"></divide><apply id="A1.E19.m1.1.1.1.1.3.3.2.cmml" xref="A1.E19.m1.1.1.1.1.3.3.2"><minus id="A1.E19.m1.1.1.1.1.3.3.2.1.cmml" xref="A1.E19.m1.1.1.1.1.3.3.2.1"></minus><apply id="A1.E19.m1.1.1.1.1.3.3.2.2.cmml" xref="A1.E19.m1.1.1.1.1.3.3.2.2"><times id="A1.E19.m1.1.1.1.1.3.3.2.2.1.cmml" xref="A1.E19.m1.1.1.1.1.3.3.2.2.1"></times><cn id="A1.E19.m1.1.1.1.1.3.3.2.2.2.cmml" type="integer" xref="A1.E19.m1.1.1.1.1.3.3.2.2.2">2</cn><ci id="A1.E19.m1.1.1.1.1.3.3.2.2.3.cmml" xref="A1.E19.m1.1.1.1.1.3.3.2.2.3">𝑛</ci></apply><cn id="A1.E19.m1.1.1.1.1.3.3.2.3.cmml" type="integer" xref="A1.E19.m1.1.1.1.1.3.3.2.3">1</cn></apply><apply id="A1.E19.m1.1.1.1.1.3.3.3.cmml" xref="A1.E19.m1.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="A1.E19.m1.1.1.1.1.3.3.3.1.cmml" xref="A1.E19.m1.1.1.1.1.3.3.3">superscript</csymbol><ci id="A1.E19.m1.1.1.1.1.3.3.3.2.cmml" xref="A1.E19.m1.1.1.1.1.3.3.3.2">𝑛</ci><cn id="A1.E19.m1.1.1.1.1.3.3.3.3.cmml" type="integer" xref="A1.E19.m1.1.1.1.1.3.3.3.3">2</cn></apply></apply><apply id="A1.E19.m1.1.1.1.1.3.4.cmml" xref="A1.E19.m1.1.1.1.1.3.4"><csymbol cd="ambiguous" id="A1.E19.m1.1.1.1.1.3.4.1.cmml" xref="A1.E19.m1.1.1.1.1.3.4">superscript</csymbol><ci id="A1.E19.m1.1.1.1.1.3.4.2.cmml" xref="A1.E19.m1.1.1.1.1.3.4.2">𝑐</ci><cn id="A1.E19.m1.1.1.1.1.3.4.3.cmml" type="integer" xref="A1.E19.m1.1.1.1.1.3.4.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E19.m1.1c">|\Delta\widehat{\mathbf{M}}_{\alpha ij}|\leq 2\frac{2n-1}{n^{2}}c^{2}.</annotation><annotation encoding="application/x-llamapun" id="A1.E19.m1.1d">| roman_Δ over^ start_ARG bold_M end_ARG start_POSTSUBSCRIPT italic_α italic_i italic_j end_POSTSUBSCRIPT | ≤ 2 divide start_ARG 2 italic_n - 1 end_ARG start_ARG italic_n start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG italic_c start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(19)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A1.SS2.p6.5">With straightforward application of McDiarmid’s inequality <cite class="ltx_cite ltx_citemacro_citep">[Doob, <a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#bib.bib12" title="">1940</a>]</cite>, it follows that</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equation ltx_eqn_table" id="A1.E20">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\textrm{{Pr}}\left(|\widehat{\phi}_{\mathcal{G}}(v_{i})^{\top}\widehat{\phi}_{%
\mathcal{G}}(v_{j})-{\mathbf{M}_{\alpha}}_{ij}|>t\right)\leq 2\exp\left(-\frac%
{t^{2}n^{3}}{2(2n-1)^{2}c^{4}}\right)," class="ltx_Math" display="block" id="A1.E20.m1.3"><semantics id="A1.E20.m1.3a"><mrow id="A1.E20.m1.3.3.1" xref="A1.E20.m1.3.3.1.1.cmml"><mrow id="A1.E20.m1.3.3.1.1" xref="A1.E20.m1.3.3.1.1.cmml"><mrow id="A1.E20.m1.3.3.1.1.1" xref="A1.E20.m1.3.3.1.1.1.cmml"><mtext id="A1.E20.m1.3.3.1.1.1.3" xref="A1.E20.m1.3.3.1.1.1.3a.cmml">Pr</mtext><mo id="A1.E20.m1.3.3.1.1.1.2" xref="A1.E20.m1.3.3.1.1.1.2.cmml">⁢</mo><mrow id="A1.E20.m1.3.3.1.1.1.1.1" xref="A1.E20.m1.3.3.1.1.1.1.1.1.cmml"><mo id="A1.E20.m1.3.3.1.1.1.1.1.2" xref="A1.E20.m1.3.3.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.E20.m1.3.3.1.1.1.1.1.1" xref="A1.E20.m1.3.3.1.1.1.1.1.1.cmml"><mrow id="A1.E20.m1.3.3.1.1.1.1.1.1.1.1" xref="A1.E20.m1.3.3.1.1.1.1.1.1.1.2.cmml"><mo id="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.2" stretchy="false" xref="A1.E20.m1.3.3.1.1.1.1.1.1.1.2.1.cmml">|</mo><mrow id="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1" xref="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.cmml"><mrow id="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.2" xref="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.2.cmml"><msub id="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.2.4" xref="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.2.4.cmml"><mover accent="true" id="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.2.4.2" xref="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.2.4.2.cmml"><mi id="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.2.4.2.2" xref="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.2.4.2.2.cmml">ϕ</mi><mo id="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.2.4.2.1" xref="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.2.4.2.1.cmml">^</mo></mover><mi class="ltx_font_mathcaligraphic" id="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.2.4.3" xref="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.2.4.3.cmml">𝒢</mi></msub><mo id="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.2.3" xref="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.2.3.cmml">⁢</mo><msup id="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.1.1" xref="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">v</mi><mi id="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3" xref="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.cmml">⊤</mo></msup><mo id="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.2.3a" xref="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.2.3.cmml">⁢</mo><msub id="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.2.5" xref="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.2.5.cmml"><mover accent="true" id="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.2.5.2" xref="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.2.5.2.cmml"><mi id="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.2.5.2.2" xref="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.2.5.2.2.cmml">ϕ</mi><mo id="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.2.5.2.1" xref="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.2.5.2.1.cmml">^</mo></mover><mi class="ltx_font_mathcaligraphic" id="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.2.5.3" xref="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.2.5.3.cmml">𝒢</mi></msub><mo id="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.2.3b" xref="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.2.3.cmml">⁢</mo><mrow id="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.1" xref="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.1.1.cmml"><mo id="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.1.2" stretchy="false" xref="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.1.1.cmml">(</mo><msub id="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.1.1" xref="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.1.1.cmml"><mi id="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.1.1.2" xref="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.1.1.2.cmml">v</mi><mi id="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.1.1.3" xref="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.1.1.3.cmml">j</mi></msub><mo id="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.1.3" stretchy="false" xref="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.3" xref="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.3.cmml">−</mo><mmultiscripts id="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.4" xref="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.4.cmml"><mi id="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.4.2.2" xref="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.4.2.2.cmml">𝐌</mi><mi id="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.4.2.3" xref="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.4.2.3.cmml">α</mi><mrow id="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.4a" xref="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.4.cmml"></mrow><mrow id="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.4.3" xref="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.4.3.cmml"><mi id="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.4.3.2" xref="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.4.3.2.cmml">i</mi><mo id="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.4.3.1" xref="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.4.3.1.cmml">⁢</mo><mi id="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.4.3.3" xref="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.4.3.3.cmml">j</mi></mrow><mrow id="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.4b" xref="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.4.cmml"></mrow></mmultiscripts></mrow><mo id="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.3" stretchy="false" xref="A1.E20.m1.3.3.1.1.1.1.1.1.1.2.1.cmml">|</mo></mrow><mo id="A1.E20.m1.3.3.1.1.1.1.1.1.2" xref="A1.E20.m1.3.3.1.1.1.1.1.1.2.cmml">&gt;</mo><mi id="A1.E20.m1.3.3.1.1.1.1.1.1.3" xref="A1.E20.m1.3.3.1.1.1.1.1.1.3.cmml">t</mi></mrow><mo id="A1.E20.m1.3.3.1.1.1.1.1.3" xref="A1.E20.m1.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E20.m1.3.3.1.1.3" xref="A1.E20.m1.3.3.1.1.3.cmml">≤</mo><mrow id="A1.E20.m1.3.3.1.1.2" xref="A1.E20.m1.3.3.1.1.2.cmml"><mn id="A1.E20.m1.3.3.1.1.2.3" xref="A1.E20.m1.3.3.1.1.2.3.cmml">2</mn><mo id="A1.E20.m1.3.3.1.1.2.2" lspace="0.167em" xref="A1.E20.m1.3.3.1.1.2.2.cmml">⁢</mo><mrow id="A1.E20.m1.3.3.1.1.2.1.1" xref="A1.E20.m1.3.3.1.1.2.1.2.cmml"><mi id="A1.E20.m1.2.2" xref="A1.E20.m1.2.2.cmml">exp</mi><mo id="A1.E20.m1.3.3.1.1.2.1.1a" xref="A1.E20.m1.3.3.1.1.2.1.2.cmml">⁡</mo><mrow id="A1.E20.m1.3.3.1.1.2.1.1.1" xref="A1.E20.m1.3.3.1.1.2.1.2.cmml"><mo id="A1.E20.m1.3.3.1.1.2.1.1.1.2" xref="A1.E20.m1.3.3.1.1.2.1.2.cmml">(</mo><mrow id="A1.E20.m1.3.3.1.1.2.1.1.1.1" xref="A1.E20.m1.3.3.1.1.2.1.1.1.1.cmml"><mo id="A1.E20.m1.3.3.1.1.2.1.1.1.1a" xref="A1.E20.m1.3.3.1.1.2.1.1.1.1.cmml">−</mo><mfrac id="A1.E20.m1.1.1" xref="A1.E20.m1.1.1.cmml"><mrow id="A1.E20.m1.1.1.3" xref="A1.E20.m1.1.1.3.cmml"><msup id="A1.E20.m1.1.1.3.2" xref="A1.E20.m1.1.1.3.2.cmml"><mi id="A1.E20.m1.1.1.3.2.2" xref="A1.E20.m1.1.1.3.2.2.cmml">t</mi><mn id="A1.E20.m1.1.1.3.2.3" xref="A1.E20.m1.1.1.3.2.3.cmml">2</mn></msup><mo id="A1.E20.m1.1.1.3.1" xref="A1.E20.m1.1.1.3.1.cmml">⁢</mo><msup id="A1.E20.m1.1.1.3.3" xref="A1.E20.m1.1.1.3.3.cmml"><mi id="A1.E20.m1.1.1.3.3.2" xref="A1.E20.m1.1.1.3.3.2.cmml">n</mi><mn id="A1.E20.m1.1.1.3.3.3" xref="A1.E20.m1.1.1.3.3.3.cmml">3</mn></msup></mrow><mrow id="A1.E20.m1.1.1.1" xref="A1.E20.m1.1.1.1.cmml"><mn id="A1.E20.m1.1.1.1.3" xref="A1.E20.m1.1.1.1.3.cmml">2</mn><mo id="A1.E20.m1.1.1.1.2" xref="A1.E20.m1.1.1.1.2.cmml">⁢</mo><msup id="A1.E20.m1.1.1.1.1" xref="A1.E20.m1.1.1.1.1.cmml"><mrow id="A1.E20.m1.1.1.1.1.1.1" xref="A1.E20.m1.1.1.1.1.1.1.1.cmml"><mo id="A1.E20.m1.1.1.1.1.1.1.2" stretchy="false" xref="A1.E20.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.E20.m1.1.1.1.1.1.1.1" xref="A1.E20.m1.1.1.1.1.1.1.1.cmml"><mrow id="A1.E20.m1.1.1.1.1.1.1.1.2" xref="A1.E20.m1.1.1.1.1.1.1.1.2.cmml"><mn id="A1.E20.m1.1.1.1.1.1.1.1.2.2" xref="A1.E20.m1.1.1.1.1.1.1.1.2.2.cmml">2</mn><mo id="A1.E20.m1.1.1.1.1.1.1.1.2.1" xref="A1.E20.m1.1.1.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="A1.E20.m1.1.1.1.1.1.1.1.2.3" xref="A1.E20.m1.1.1.1.1.1.1.1.2.3.cmml">n</mi></mrow><mo id="A1.E20.m1.1.1.1.1.1.1.1.1" xref="A1.E20.m1.1.1.1.1.1.1.1.1.cmml">−</mo><mn id="A1.E20.m1.1.1.1.1.1.1.1.3" xref="A1.E20.m1.1.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="A1.E20.m1.1.1.1.1.1.1.3" stretchy="false" xref="A1.E20.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mn id="A1.E20.m1.1.1.1.1.3" xref="A1.E20.m1.1.1.1.1.3.cmml">2</mn></msup><mo id="A1.E20.m1.1.1.1.2a" xref="A1.E20.m1.1.1.1.2.cmml">⁢</mo><msup id="A1.E20.m1.1.1.1.4" xref="A1.E20.m1.1.1.1.4.cmml"><mi id="A1.E20.m1.1.1.1.4.2" xref="A1.E20.m1.1.1.1.4.2.cmml">c</mi><mn id="A1.E20.m1.1.1.1.4.3" xref="A1.E20.m1.1.1.1.4.3.cmml">4</mn></msup></mrow></mfrac></mrow><mo id="A1.E20.m1.3.3.1.1.2.1.1.1.3" xref="A1.E20.m1.3.3.1.1.2.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="A1.E20.m1.3.3.1.2" xref="A1.E20.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.E20.m1.3b"><apply id="A1.E20.m1.3.3.1.1.cmml" xref="A1.E20.m1.3.3.1"><leq id="A1.E20.m1.3.3.1.1.3.cmml" xref="A1.E20.m1.3.3.1.1.3"></leq><apply id="A1.E20.m1.3.3.1.1.1.cmml" xref="A1.E20.m1.3.3.1.1.1"><times id="A1.E20.m1.3.3.1.1.1.2.cmml" xref="A1.E20.m1.3.3.1.1.1.2"></times><ci id="A1.E20.m1.3.3.1.1.1.3a.cmml" xref="A1.E20.m1.3.3.1.1.1.3"><mtext id="A1.E20.m1.3.3.1.1.1.3.cmml" xref="A1.E20.m1.3.3.1.1.1.3">Pr</mtext></ci><apply id="A1.E20.m1.3.3.1.1.1.1.1.1.cmml" xref="A1.E20.m1.3.3.1.1.1.1.1"><gt id="A1.E20.m1.3.3.1.1.1.1.1.1.2.cmml" xref="A1.E20.m1.3.3.1.1.1.1.1.1.2"></gt><apply id="A1.E20.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="A1.E20.m1.3.3.1.1.1.1.1.1.1.1"><abs id="A1.E20.m1.3.3.1.1.1.1.1.1.1.2.1.cmml" xref="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.2"></abs><apply id="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1"><minus id="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.3"></minus><apply id="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.2"><times id="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.2.3"></times><apply id="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.2.4.cmml" xref="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.2.4"><csymbol cd="ambiguous" id="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.2.4.1.cmml" xref="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.2.4">subscript</csymbol><apply id="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.2.4.2.cmml" xref="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.2.4.2"><ci id="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.2.4.2.1.cmml" xref="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.2.4.2.1">^</ci><ci id="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.2.4.2.2.cmml" xref="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.2.4.2.2">italic-ϕ</ci></apply><ci id="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.2.4.3.cmml" xref="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.2.4.3">𝒢</ci></apply><apply id="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2">𝑣</ci><ci id="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><csymbol cd="latexml" id="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3">top</csymbol></apply><apply id="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.2.5.cmml" xref="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.2.5"><csymbol cd="ambiguous" id="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.2.5.1.cmml" xref="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.2.5">subscript</csymbol><apply id="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.2.5.2.cmml" xref="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.2.5.2"><ci id="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.2.5.2.1.cmml" xref="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.2.5.2.1">^</ci><ci id="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.2.5.2.2.cmml" xref="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.2.5.2.2">italic-ϕ</ci></apply><ci id="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.2.5.3.cmml" xref="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.2.5.3">𝒢</ci></apply><apply id="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.1.1.cmml" xref="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.1"><csymbol cd="ambiguous" id="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.1.1.1.cmml" xref="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.1">subscript</csymbol><ci id="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.1.1.2.cmml" xref="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.1.1.2">𝑣</ci><ci id="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.1.1.3.cmml" xref="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.1.1.3">𝑗</ci></apply></apply><apply id="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.4.cmml" xref="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.4.1.cmml" xref="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.4">subscript</csymbol><apply id="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.4.2.cmml" xref="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.4.2.1.cmml" xref="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.4">subscript</csymbol><ci id="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.4.2.2.cmml" xref="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.4.2.2">𝐌</ci><ci id="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.4.2.3.cmml" xref="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.4.2.3">𝛼</ci></apply><apply id="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.4.3.cmml" xref="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.4.3"><times id="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.4.3.1.cmml" xref="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.4.3.1"></times><ci id="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.4.3.2.cmml" xref="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.4.3.2">𝑖</ci><ci id="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.4.3.3.cmml" xref="A1.E20.m1.3.3.1.1.1.1.1.1.1.1.1.4.3.3">𝑗</ci></apply></apply></apply></apply><ci id="A1.E20.m1.3.3.1.1.1.1.1.1.3.cmml" xref="A1.E20.m1.3.3.1.1.1.1.1.1.3">𝑡</ci></apply></apply><apply id="A1.E20.m1.3.3.1.1.2.cmml" xref="A1.E20.m1.3.3.1.1.2"><times id="A1.E20.m1.3.3.1.1.2.2.cmml" xref="A1.E20.m1.3.3.1.1.2.2"></times><cn id="A1.E20.m1.3.3.1.1.2.3.cmml" type="integer" xref="A1.E20.m1.3.3.1.1.2.3">2</cn><apply id="A1.E20.m1.3.3.1.1.2.1.2.cmml" xref="A1.E20.m1.3.3.1.1.2.1.1"><exp id="A1.E20.m1.2.2.cmml" xref="A1.E20.m1.2.2"></exp><apply id="A1.E20.m1.3.3.1.1.2.1.1.1.1.cmml" xref="A1.E20.m1.3.3.1.1.2.1.1.1.1"><minus id="A1.E20.m1.3.3.1.1.2.1.1.1.1.1.cmml" xref="A1.E20.m1.3.3.1.1.2.1.1.1.1"></minus><apply id="A1.E20.m1.1.1.cmml" xref="A1.E20.m1.1.1"><divide id="A1.E20.m1.1.1.2.cmml" xref="A1.E20.m1.1.1"></divide><apply id="A1.E20.m1.1.1.3.cmml" xref="A1.E20.m1.1.1.3"><times id="A1.E20.m1.1.1.3.1.cmml" xref="A1.E20.m1.1.1.3.1"></times><apply id="A1.E20.m1.1.1.3.2.cmml" xref="A1.E20.m1.1.1.3.2"><csymbol cd="ambiguous" id="A1.E20.m1.1.1.3.2.1.cmml" xref="A1.E20.m1.1.1.3.2">superscript</csymbol><ci id="A1.E20.m1.1.1.3.2.2.cmml" xref="A1.E20.m1.1.1.3.2.2">𝑡</ci><cn id="A1.E20.m1.1.1.3.2.3.cmml" type="integer" xref="A1.E20.m1.1.1.3.2.3">2</cn></apply><apply id="A1.E20.m1.1.1.3.3.cmml" xref="A1.E20.m1.1.1.3.3"><csymbol cd="ambiguous" id="A1.E20.m1.1.1.3.3.1.cmml" xref="A1.E20.m1.1.1.3.3">superscript</csymbol><ci id="A1.E20.m1.1.1.3.3.2.cmml" xref="A1.E20.m1.1.1.3.3.2">𝑛</ci><cn id="A1.E20.m1.1.1.3.3.3.cmml" type="integer" xref="A1.E20.m1.1.1.3.3.3">3</cn></apply></apply><apply id="A1.E20.m1.1.1.1.cmml" xref="A1.E20.m1.1.1.1"><times id="A1.E20.m1.1.1.1.2.cmml" xref="A1.E20.m1.1.1.1.2"></times><cn id="A1.E20.m1.1.1.1.3.cmml" type="integer" xref="A1.E20.m1.1.1.1.3">2</cn><apply id="A1.E20.m1.1.1.1.1.cmml" xref="A1.E20.m1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E20.m1.1.1.1.1.2.cmml" xref="A1.E20.m1.1.1.1.1">superscript</csymbol><apply id="A1.E20.m1.1.1.1.1.1.1.1.cmml" xref="A1.E20.m1.1.1.1.1.1.1"><minus id="A1.E20.m1.1.1.1.1.1.1.1.1.cmml" xref="A1.E20.m1.1.1.1.1.1.1.1.1"></minus><apply id="A1.E20.m1.1.1.1.1.1.1.1.2.cmml" xref="A1.E20.m1.1.1.1.1.1.1.1.2"><times id="A1.E20.m1.1.1.1.1.1.1.1.2.1.cmml" xref="A1.E20.m1.1.1.1.1.1.1.1.2.1"></times><cn id="A1.E20.m1.1.1.1.1.1.1.1.2.2.cmml" type="integer" xref="A1.E20.m1.1.1.1.1.1.1.1.2.2">2</cn><ci id="A1.E20.m1.1.1.1.1.1.1.1.2.3.cmml" xref="A1.E20.m1.1.1.1.1.1.1.1.2.3">𝑛</ci></apply><cn id="A1.E20.m1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="A1.E20.m1.1.1.1.1.1.1.1.3">1</cn></apply><cn id="A1.E20.m1.1.1.1.1.3.cmml" type="integer" xref="A1.E20.m1.1.1.1.1.3">2</cn></apply><apply id="A1.E20.m1.1.1.1.4.cmml" xref="A1.E20.m1.1.1.1.4"><csymbol cd="ambiguous" id="A1.E20.m1.1.1.1.4.1.cmml" xref="A1.E20.m1.1.1.1.4">superscript</csymbol><ci id="A1.E20.m1.1.1.1.4.2.cmml" xref="A1.E20.m1.1.1.1.4.2">𝑐</ci><cn id="A1.E20.m1.1.1.1.4.3.cmml" type="integer" xref="A1.E20.m1.1.1.1.4.3">4</cn></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E20.m1.3c">\textrm{{Pr}}\left(|\widehat{\phi}_{\mathcal{G}}(v_{i})^{\top}\widehat{\phi}_{%
\mathcal{G}}(v_{j})-{\mathbf{M}_{\alpha}}_{ij}|&gt;t\right)\leq 2\exp\left(-\frac%
{t^{2}n^{3}}{2(2n-1)^{2}c^{4}}\right),</annotation><annotation encoding="application/x-llamapun" id="A1.E20.m1.3d">Pr ( | over^ start_ARG italic_ϕ end_ARG start_POSTSUBSCRIPT caligraphic_G end_POSTSUBSCRIPT ( italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT over^ start_ARG italic_ϕ end_ARG start_POSTSUBSCRIPT caligraphic_G end_POSTSUBSCRIPT ( italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) - bold_M start_POSTSUBSCRIPT italic_α end_POSTSUBSCRIPT start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT | &gt; italic_t ) ≤ 2 roman_exp ( - divide start_ARG italic_t start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT italic_n start_POSTSUPERSCRIPT 3 end_POSTSUPERSCRIPT end_ARG start_ARG 2 ( 2 italic_n - 1 ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT italic_c start_POSTSUPERSCRIPT 4 end_POSTSUPERSCRIPT end_ARG ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(20)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A1.SS2.p6.6">completing the proof. ∎</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="A1.SS2.p7">
<p class="ltx_p" id="A1.SS2.p7.1">As noted in the main text, this is a remarkably general and powerful result.
It is the first known concentration inequality for GRFs.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
</section>
<section class="ltx_appendix" id="A2">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>Extended discussion on related work</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="A2.p1">
<p class="ltx_p" id="A2.p1.1">In this appendix, we give a detailed explanation of the relationship to previous work.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<ol class="ltx_enumerate" id="A2.I1">
<li class="ltx_item" id="A2.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span>
<div class="ltx_para" id="A2.I1.i1.p1">
<p class="ltx_p" id="A2.I1.i1.p1.4"><span class="ltx_text ltx_font_bold" id="A2.I1.i1.p1.4.1">Stochastic position encoding (SPE)</span> <cite class="ltx_cite ltx_citemacro_citep">[Liutkus et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#bib.bib21" title="">2021</a>]</cite>.
To our knowledge, this is the earliest RPE strategy compatible with <math alttext="\mathcal{O}(N)" class="ltx_Math" display="inline" id="A2.I1.i1.p1.1.m1.1"><semantics id="A2.I1.i1.p1.1.m1.1a"><mrow id="A2.I1.i1.p1.1.m1.1.2" xref="A2.I1.i1.p1.1.m1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="A2.I1.i1.p1.1.m1.1.2.2" xref="A2.I1.i1.p1.1.m1.1.2.2.cmml">𝒪</mi><mo id="A2.I1.i1.p1.1.m1.1.2.1" xref="A2.I1.i1.p1.1.m1.1.2.1.cmml">⁢</mo><mrow id="A2.I1.i1.p1.1.m1.1.2.3.2" xref="A2.I1.i1.p1.1.m1.1.2.cmml"><mo id="A2.I1.i1.p1.1.m1.1.2.3.2.1" stretchy="false" xref="A2.I1.i1.p1.1.m1.1.2.cmml">(</mo><mi id="A2.I1.i1.p1.1.m1.1.1" xref="A2.I1.i1.p1.1.m1.1.1.cmml">N</mi><mo id="A2.I1.i1.p1.1.m1.1.2.3.2.2" stretchy="false" xref="A2.I1.i1.p1.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.I1.i1.p1.1.m1.1b"><apply id="A2.I1.i1.p1.1.m1.1.2.cmml" xref="A2.I1.i1.p1.1.m1.1.2"><times id="A2.I1.i1.p1.1.m1.1.2.1.cmml" xref="A2.I1.i1.p1.1.m1.1.2.1"></times><ci id="A2.I1.i1.p1.1.m1.1.2.2.cmml" xref="A2.I1.i1.p1.1.m1.1.2.2">𝒪</ci><ci id="A2.I1.i1.p1.1.m1.1.1.cmml" xref="A2.I1.i1.p1.1.m1.1.1">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.I1.i1.p1.1.m1.1c">\mathcal{O}(N)</annotation><annotation encoding="application/x-llamapun" id="A2.I1.i1.p1.1.m1.1d">caligraphic_O ( italic_N )</annotation></semantics></math> transformers, incorporating information about the ‘lag’ between tokens in the linear attention setting by drawing samples from random processes with a prescribed covariance structure.
The time complexity is <math alttext="\mathcal{O}(N)" class="ltx_Math" display="inline" id="A2.I1.i1.p1.2.m2.1"><semantics id="A2.I1.i1.p1.2.m2.1a"><mrow id="A2.I1.i1.p1.2.m2.1.2" xref="A2.I1.i1.p1.2.m2.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="A2.I1.i1.p1.2.m2.1.2.2" xref="A2.I1.i1.p1.2.m2.1.2.2.cmml">𝒪</mi><mo id="A2.I1.i1.p1.2.m2.1.2.1" xref="A2.I1.i1.p1.2.m2.1.2.1.cmml">⁢</mo><mrow id="A2.I1.i1.p1.2.m2.1.2.3.2" xref="A2.I1.i1.p1.2.m2.1.2.cmml"><mo id="A2.I1.i1.p1.2.m2.1.2.3.2.1" stretchy="false" xref="A2.I1.i1.p1.2.m2.1.2.cmml">(</mo><mi id="A2.I1.i1.p1.2.m2.1.1" xref="A2.I1.i1.p1.2.m2.1.1.cmml">N</mi><mo id="A2.I1.i1.p1.2.m2.1.2.3.2.2" stretchy="false" xref="A2.I1.i1.p1.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.I1.i1.p1.2.m2.1b"><apply id="A2.I1.i1.p1.2.m2.1.2.cmml" xref="A2.I1.i1.p1.2.m2.1.2"><times id="A2.I1.i1.p1.2.m2.1.2.1.cmml" xref="A2.I1.i1.p1.2.m2.1.2.1"></times><ci id="A2.I1.i1.p1.2.m2.1.2.2.cmml" xref="A2.I1.i1.p1.2.m2.1.2.2">𝒪</ci><ci id="A2.I1.i1.p1.2.m2.1.1.cmml" xref="A2.I1.i1.p1.2.m2.1.1">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.I1.i1.p1.2.m2.1c">\mathcal{O}(N)</annotation><annotation encoding="application/x-llamapun" id="A2.I1.i1.p1.2.m2.1d">caligraphic_O ( italic_N )</annotation></semantics></math> but the method is only applicable to sequence data, i.e.&nbsp;the very special case that <math alttext="\mathcal{G}" class="ltx_Math" display="inline" id="A2.I1.i1.p1.3.m3.1"><semantics id="A2.I1.i1.p1.3.m3.1a"><mi class="ltx_font_mathcaligraphic" id="A2.I1.i1.p1.3.m3.1.1" xref="A2.I1.i1.p1.3.m3.1.1.cmml">𝒢</mi><annotation-xml encoding="MathML-Content" id="A2.I1.i1.p1.3.m3.1b"><ci id="A2.I1.i1.p1.3.m3.1.1.cmml" xref="A2.I1.i1.p1.3.m3.1.1">𝒢</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.I1.i1.p1.3.m3.1c">\mathcal{G}</annotation><annotation encoding="application/x-llamapun" id="A2.I1.i1.p1.3.m3.1d">caligraphic_G</annotation></semantics></math> is a <math alttext="1" class="ltx_Math" display="inline" id="A2.I1.i1.p1.4.m4.1"><semantics id="A2.I1.i1.p1.4.m4.1a"><mn id="A2.I1.i1.p1.4.m4.1.1" xref="A2.I1.i1.p1.4.m4.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="A2.I1.i1.p1.4.m4.1b"><cn id="A2.I1.i1.p1.4.m4.1.1.cmml" type="integer" xref="A2.I1.i1.p1.4.m4.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.I1.i1.p1.4.m4.1c">1</annotation><annotation encoding="application/x-llamapun" id="A2.I1.i1.p1.4.m4.1d">1</annotation></semantics></math>-dimensional grid.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="A2.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span>
<div class="ltx_para" id="A2.I1.i2.p1">
<p class="ltx_p" id="A2.I1.i2.p1.7"><span class="ltx_text ltx_font_bold" id="A2.I1.i2.p1.7.1">Toeplitz masks and the fast Fourier transform (FFT)</span> <cite class="ltx_cite ltx_citemacro_citep">[Luo et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#bib.bib23" title="">2021</a>]</cite>.
Again considering sequence data, suppose that RPE between a query <math alttext="\bm{q}_{i}" class="ltx_Math" display="inline" id="A2.I1.i2.p1.1.m1.1"><semantics id="A2.I1.i2.p1.1.m1.1a"><msub id="A2.I1.i2.p1.1.m1.1.1" xref="A2.I1.i2.p1.1.m1.1.1.cmml"><mi id="A2.I1.i2.p1.1.m1.1.1.2" xref="A2.I1.i2.p1.1.m1.1.1.2.cmml">𝒒</mi><mi id="A2.I1.i2.p1.1.m1.1.1.3" xref="A2.I1.i2.p1.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A2.I1.i2.p1.1.m1.1b"><apply id="A2.I1.i2.p1.1.m1.1.1.cmml" xref="A2.I1.i2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="A2.I1.i2.p1.1.m1.1.1.1.cmml" xref="A2.I1.i2.p1.1.m1.1.1">subscript</csymbol><ci id="A2.I1.i2.p1.1.m1.1.1.2.cmml" xref="A2.I1.i2.p1.1.m1.1.1.2">𝒒</ci><ci id="A2.I1.i2.p1.1.m1.1.1.3.cmml" xref="A2.I1.i2.p1.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.I1.i2.p1.1.m1.1c">\bm{q}_{i}</annotation><annotation encoding="application/x-llamapun" id="A2.I1.i2.p1.1.m1.1d">bold_italic_q start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> and a key <math alttext="\bm{k}_{j}" class="ltx_Math" display="inline" id="A2.I1.i2.p1.2.m2.1"><semantics id="A2.I1.i2.p1.2.m2.1a"><msub id="A2.I1.i2.p1.2.m2.1.1" xref="A2.I1.i2.p1.2.m2.1.1.cmml"><mi id="A2.I1.i2.p1.2.m2.1.1.2" xref="A2.I1.i2.p1.2.m2.1.1.2.cmml">𝒌</mi><mi id="A2.I1.i2.p1.2.m2.1.1.3" xref="A2.I1.i2.p1.2.m2.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="A2.I1.i2.p1.2.m2.1b"><apply id="A2.I1.i2.p1.2.m2.1.1.cmml" xref="A2.I1.i2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="A2.I1.i2.p1.2.m2.1.1.1.cmml" xref="A2.I1.i2.p1.2.m2.1.1">subscript</csymbol><ci id="A2.I1.i2.p1.2.m2.1.1.2.cmml" xref="A2.I1.i2.p1.2.m2.1.1.2">𝒌</ci><ci id="A2.I1.i2.p1.2.m2.1.1.3.cmml" xref="A2.I1.i2.p1.2.m2.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.I1.i2.p1.2.m2.1c">\bm{k}_{j}</annotation><annotation encoding="application/x-llamapun" id="A2.I1.i2.p1.2.m2.1d">bold_italic_k start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> is impemented by adding a bias term <math alttext="b_{j-i}" class="ltx_Math" display="inline" id="A2.I1.i2.p1.3.m3.1"><semantics id="A2.I1.i2.p1.3.m3.1a"><msub id="A2.I1.i2.p1.3.m3.1.1" xref="A2.I1.i2.p1.3.m3.1.1.cmml"><mi id="A2.I1.i2.p1.3.m3.1.1.2" xref="A2.I1.i2.p1.3.m3.1.1.2.cmml">b</mi><mrow id="A2.I1.i2.p1.3.m3.1.1.3" xref="A2.I1.i2.p1.3.m3.1.1.3.cmml"><mi id="A2.I1.i2.p1.3.m3.1.1.3.2" xref="A2.I1.i2.p1.3.m3.1.1.3.2.cmml">j</mi><mo id="A2.I1.i2.p1.3.m3.1.1.3.1" xref="A2.I1.i2.p1.3.m3.1.1.3.1.cmml">−</mo><mi id="A2.I1.i2.p1.3.m3.1.1.3.3" xref="A2.I1.i2.p1.3.m3.1.1.3.3.cmml">i</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="A2.I1.i2.p1.3.m3.1b"><apply id="A2.I1.i2.p1.3.m3.1.1.cmml" xref="A2.I1.i2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="A2.I1.i2.p1.3.m3.1.1.1.cmml" xref="A2.I1.i2.p1.3.m3.1.1">subscript</csymbol><ci id="A2.I1.i2.p1.3.m3.1.1.2.cmml" xref="A2.I1.i2.p1.3.m3.1.1.2">𝑏</ci><apply id="A2.I1.i2.p1.3.m3.1.1.3.cmml" xref="A2.I1.i2.p1.3.m3.1.1.3"><minus id="A2.I1.i2.p1.3.m3.1.1.3.1.cmml" xref="A2.I1.i2.p1.3.m3.1.1.3.1"></minus><ci id="A2.I1.i2.p1.3.m3.1.1.3.2.cmml" xref="A2.I1.i2.p1.3.m3.1.1.3.2">𝑗</ci><ci id="A2.I1.i2.p1.3.m3.1.1.3.3.cmml" xref="A2.I1.i2.p1.3.m3.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.I1.i2.p1.3.m3.1c">b_{j-i}</annotation><annotation encoding="application/x-llamapun" id="A2.I1.i2.p1.3.m3.1d">italic_b start_POSTSUBSCRIPT italic_j - italic_i end_POSTSUBSCRIPT</annotation></semantics></math> to the dot product before exponentiating.
Then the corresponding mask <math alttext="\mathbf{M}_{ij}=e^{b_{j-i}}" class="ltx_Math" display="inline" id="A2.I1.i2.p1.4.m4.1"><semantics id="A2.I1.i2.p1.4.m4.1a"><mrow id="A2.I1.i2.p1.4.m4.1.1" xref="A2.I1.i2.p1.4.m4.1.1.cmml"><msub id="A2.I1.i2.p1.4.m4.1.1.2" xref="A2.I1.i2.p1.4.m4.1.1.2.cmml"><mi id="A2.I1.i2.p1.4.m4.1.1.2.2" xref="A2.I1.i2.p1.4.m4.1.1.2.2.cmml">𝐌</mi><mrow id="A2.I1.i2.p1.4.m4.1.1.2.3" xref="A2.I1.i2.p1.4.m4.1.1.2.3.cmml"><mi id="A2.I1.i2.p1.4.m4.1.1.2.3.2" xref="A2.I1.i2.p1.4.m4.1.1.2.3.2.cmml">i</mi><mo id="A2.I1.i2.p1.4.m4.1.1.2.3.1" xref="A2.I1.i2.p1.4.m4.1.1.2.3.1.cmml">⁢</mo><mi id="A2.I1.i2.p1.4.m4.1.1.2.3.3" xref="A2.I1.i2.p1.4.m4.1.1.2.3.3.cmml">j</mi></mrow></msub><mo id="A2.I1.i2.p1.4.m4.1.1.1" xref="A2.I1.i2.p1.4.m4.1.1.1.cmml">=</mo><msup id="A2.I1.i2.p1.4.m4.1.1.3" xref="A2.I1.i2.p1.4.m4.1.1.3.cmml"><mi id="A2.I1.i2.p1.4.m4.1.1.3.2" xref="A2.I1.i2.p1.4.m4.1.1.3.2.cmml">e</mi><msub id="A2.I1.i2.p1.4.m4.1.1.3.3" xref="A2.I1.i2.p1.4.m4.1.1.3.3.cmml"><mi id="A2.I1.i2.p1.4.m4.1.1.3.3.2" xref="A2.I1.i2.p1.4.m4.1.1.3.3.2.cmml">b</mi><mrow id="A2.I1.i2.p1.4.m4.1.1.3.3.3" xref="A2.I1.i2.p1.4.m4.1.1.3.3.3.cmml"><mi id="A2.I1.i2.p1.4.m4.1.1.3.3.3.2" xref="A2.I1.i2.p1.4.m4.1.1.3.3.3.2.cmml">j</mi><mo id="A2.I1.i2.p1.4.m4.1.1.3.3.3.1" xref="A2.I1.i2.p1.4.m4.1.1.3.3.3.1.cmml">−</mo><mi id="A2.I1.i2.p1.4.m4.1.1.3.3.3.3" xref="A2.I1.i2.p1.4.m4.1.1.3.3.3.3.cmml">i</mi></mrow></msub></msup></mrow><annotation-xml encoding="MathML-Content" id="A2.I1.i2.p1.4.m4.1b"><apply id="A2.I1.i2.p1.4.m4.1.1.cmml" xref="A2.I1.i2.p1.4.m4.1.1"><eq id="A2.I1.i2.p1.4.m4.1.1.1.cmml" xref="A2.I1.i2.p1.4.m4.1.1.1"></eq><apply id="A2.I1.i2.p1.4.m4.1.1.2.cmml" xref="A2.I1.i2.p1.4.m4.1.1.2"><csymbol cd="ambiguous" id="A2.I1.i2.p1.4.m4.1.1.2.1.cmml" xref="A2.I1.i2.p1.4.m4.1.1.2">subscript</csymbol><ci id="A2.I1.i2.p1.4.m4.1.1.2.2.cmml" xref="A2.I1.i2.p1.4.m4.1.1.2.2">𝐌</ci><apply id="A2.I1.i2.p1.4.m4.1.1.2.3.cmml" xref="A2.I1.i2.p1.4.m4.1.1.2.3"><times id="A2.I1.i2.p1.4.m4.1.1.2.3.1.cmml" xref="A2.I1.i2.p1.4.m4.1.1.2.3.1"></times><ci id="A2.I1.i2.p1.4.m4.1.1.2.3.2.cmml" xref="A2.I1.i2.p1.4.m4.1.1.2.3.2">𝑖</ci><ci id="A2.I1.i2.p1.4.m4.1.1.2.3.3.cmml" xref="A2.I1.i2.p1.4.m4.1.1.2.3.3">𝑗</ci></apply></apply><apply id="A2.I1.i2.p1.4.m4.1.1.3.cmml" xref="A2.I1.i2.p1.4.m4.1.1.3"><csymbol cd="ambiguous" id="A2.I1.i2.p1.4.m4.1.1.3.1.cmml" xref="A2.I1.i2.p1.4.m4.1.1.3">superscript</csymbol><ci id="A2.I1.i2.p1.4.m4.1.1.3.2.cmml" xref="A2.I1.i2.p1.4.m4.1.1.3.2">𝑒</ci><apply id="A2.I1.i2.p1.4.m4.1.1.3.3.cmml" xref="A2.I1.i2.p1.4.m4.1.1.3.3"><csymbol cd="ambiguous" id="A2.I1.i2.p1.4.m4.1.1.3.3.1.cmml" xref="A2.I1.i2.p1.4.m4.1.1.3.3">subscript</csymbol><ci id="A2.I1.i2.p1.4.m4.1.1.3.3.2.cmml" xref="A2.I1.i2.p1.4.m4.1.1.3.3.2">𝑏</ci><apply id="A2.I1.i2.p1.4.m4.1.1.3.3.3.cmml" xref="A2.I1.i2.p1.4.m4.1.1.3.3.3"><minus id="A2.I1.i2.p1.4.m4.1.1.3.3.3.1.cmml" xref="A2.I1.i2.p1.4.m4.1.1.3.3.3.1"></minus><ci id="A2.I1.i2.p1.4.m4.1.1.3.3.3.2.cmml" xref="A2.I1.i2.p1.4.m4.1.1.3.3.3.2">𝑗</ci><ci id="A2.I1.i2.p1.4.m4.1.1.3.3.3.3.cmml" xref="A2.I1.i2.p1.4.m4.1.1.3.3.3.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.I1.i2.p1.4.m4.1c">\mathbf{M}_{ij}=e^{b_{j-i}}</annotation><annotation encoding="application/x-llamapun" id="A2.I1.i2.p1.4.m4.1d">bold_M start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT = italic_e start_POSTSUPERSCRIPT italic_b start_POSTSUBSCRIPT italic_j - italic_i end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> is <em class="ltx_emph ltx_font_italic" id="A2.I1.i2.p1.7.2">Toeplitz</em> (constant on all diagonals).
From numerical linear algebra, multiplying a Toeplitz matrix and a vector can be achieved with <math alttext="\mathcal{O}(N\log N)" class="ltx_Math" display="inline" id="A2.I1.i2.p1.5.m5.1"><semantics id="A2.I1.i2.p1.5.m5.1a"><mrow id="A2.I1.i2.p1.5.m5.1.1" xref="A2.I1.i2.p1.5.m5.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A2.I1.i2.p1.5.m5.1.1.3" xref="A2.I1.i2.p1.5.m5.1.1.3.cmml">𝒪</mi><mo id="A2.I1.i2.p1.5.m5.1.1.2" xref="A2.I1.i2.p1.5.m5.1.1.2.cmml">⁢</mo><mrow id="A2.I1.i2.p1.5.m5.1.1.1.1" xref="A2.I1.i2.p1.5.m5.1.1.1.1.1.cmml"><mo id="A2.I1.i2.p1.5.m5.1.1.1.1.2" stretchy="false" xref="A2.I1.i2.p1.5.m5.1.1.1.1.1.cmml">(</mo><mrow id="A2.I1.i2.p1.5.m5.1.1.1.1.1" xref="A2.I1.i2.p1.5.m5.1.1.1.1.1.cmml"><mi id="A2.I1.i2.p1.5.m5.1.1.1.1.1.2" xref="A2.I1.i2.p1.5.m5.1.1.1.1.1.2.cmml">N</mi><mo id="A2.I1.i2.p1.5.m5.1.1.1.1.1.1" lspace="0.167em" xref="A2.I1.i2.p1.5.m5.1.1.1.1.1.1.cmml">⁢</mo><mrow id="A2.I1.i2.p1.5.m5.1.1.1.1.1.3" xref="A2.I1.i2.p1.5.m5.1.1.1.1.1.3.cmml"><mi id="A2.I1.i2.p1.5.m5.1.1.1.1.1.3.1" xref="A2.I1.i2.p1.5.m5.1.1.1.1.1.3.1.cmml">log</mi><mo id="A2.I1.i2.p1.5.m5.1.1.1.1.1.3a" lspace="0.167em" xref="A2.I1.i2.p1.5.m5.1.1.1.1.1.3.cmml">⁡</mo><mi id="A2.I1.i2.p1.5.m5.1.1.1.1.1.3.2" xref="A2.I1.i2.p1.5.m5.1.1.1.1.1.3.2.cmml">N</mi></mrow></mrow><mo id="A2.I1.i2.p1.5.m5.1.1.1.1.3" stretchy="false" xref="A2.I1.i2.p1.5.m5.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.I1.i2.p1.5.m5.1b"><apply id="A2.I1.i2.p1.5.m5.1.1.cmml" xref="A2.I1.i2.p1.5.m5.1.1"><times id="A2.I1.i2.p1.5.m5.1.1.2.cmml" xref="A2.I1.i2.p1.5.m5.1.1.2"></times><ci id="A2.I1.i2.p1.5.m5.1.1.3.cmml" xref="A2.I1.i2.p1.5.m5.1.1.3">𝒪</ci><apply id="A2.I1.i2.p1.5.m5.1.1.1.1.1.cmml" xref="A2.I1.i2.p1.5.m5.1.1.1.1"><times id="A2.I1.i2.p1.5.m5.1.1.1.1.1.1.cmml" xref="A2.I1.i2.p1.5.m5.1.1.1.1.1.1"></times><ci id="A2.I1.i2.p1.5.m5.1.1.1.1.1.2.cmml" xref="A2.I1.i2.p1.5.m5.1.1.1.1.1.2">𝑁</ci><apply id="A2.I1.i2.p1.5.m5.1.1.1.1.1.3.cmml" xref="A2.I1.i2.p1.5.m5.1.1.1.1.1.3"><log id="A2.I1.i2.p1.5.m5.1.1.1.1.1.3.1.cmml" xref="A2.I1.i2.p1.5.m5.1.1.1.1.1.3.1"></log><ci id="A2.I1.i2.p1.5.m5.1.1.1.1.1.3.2.cmml" xref="A2.I1.i2.p1.5.m5.1.1.1.1.1.3.2">𝑁</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.I1.i2.p1.5.m5.1c">\mathcal{O}(N\log N)</annotation><annotation encoding="application/x-llamapun" id="A2.I1.i2.p1.5.m5.1d">caligraphic_O ( italic_N roman_log italic_N )</annotation></semantics></math> time complexity rather than <math alttext="\mathcal{O}(N^{2})" class="ltx_Math" display="inline" id="A2.I1.i2.p1.6.m6.1"><semantics id="A2.I1.i2.p1.6.m6.1a"><mrow id="A2.I1.i2.p1.6.m6.1.1" xref="A2.I1.i2.p1.6.m6.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A2.I1.i2.p1.6.m6.1.1.3" xref="A2.I1.i2.p1.6.m6.1.1.3.cmml">𝒪</mi><mo id="A2.I1.i2.p1.6.m6.1.1.2" xref="A2.I1.i2.p1.6.m6.1.1.2.cmml">⁢</mo><mrow id="A2.I1.i2.p1.6.m6.1.1.1.1" xref="A2.I1.i2.p1.6.m6.1.1.1.1.1.cmml"><mo id="A2.I1.i2.p1.6.m6.1.1.1.1.2" stretchy="false" xref="A2.I1.i2.p1.6.m6.1.1.1.1.1.cmml">(</mo><msup id="A2.I1.i2.p1.6.m6.1.1.1.1.1" xref="A2.I1.i2.p1.6.m6.1.1.1.1.1.cmml"><mi id="A2.I1.i2.p1.6.m6.1.1.1.1.1.2" xref="A2.I1.i2.p1.6.m6.1.1.1.1.1.2.cmml">N</mi><mn id="A2.I1.i2.p1.6.m6.1.1.1.1.1.3" xref="A2.I1.i2.p1.6.m6.1.1.1.1.1.3.cmml">2</mn></msup><mo id="A2.I1.i2.p1.6.m6.1.1.1.1.3" stretchy="false" xref="A2.I1.i2.p1.6.m6.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.I1.i2.p1.6.m6.1b"><apply id="A2.I1.i2.p1.6.m6.1.1.cmml" xref="A2.I1.i2.p1.6.m6.1.1"><times id="A2.I1.i2.p1.6.m6.1.1.2.cmml" xref="A2.I1.i2.p1.6.m6.1.1.2"></times><ci id="A2.I1.i2.p1.6.m6.1.1.3.cmml" xref="A2.I1.i2.p1.6.m6.1.1.3">𝒪</ci><apply id="A2.I1.i2.p1.6.m6.1.1.1.1.1.cmml" xref="A2.I1.i2.p1.6.m6.1.1.1.1"><csymbol cd="ambiguous" id="A2.I1.i2.p1.6.m6.1.1.1.1.1.1.cmml" xref="A2.I1.i2.p1.6.m6.1.1.1.1">superscript</csymbol><ci id="A2.I1.i2.p1.6.m6.1.1.1.1.1.2.cmml" xref="A2.I1.i2.p1.6.m6.1.1.1.1.1.2">𝑁</ci><cn id="A2.I1.i2.p1.6.m6.1.1.1.1.1.3.cmml" type="integer" xref="A2.I1.i2.p1.6.m6.1.1.1.1.1.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.I1.i2.p1.6.m6.1c">\mathcal{O}(N^{2})</annotation><annotation encoding="application/x-llamapun" id="A2.I1.i2.p1.6.m6.1d">caligraphic_O ( italic_N start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT )</annotation></semantics></math>, using the FFT.
This is subquadratic, though not linear, and again only specific <math alttext="\mathcal{G}" class="ltx_Math" display="inline" id="A2.I1.i2.p1.7.m7.1"><semantics id="A2.I1.i2.p1.7.m7.1a"><mi class="ltx_font_mathcaligraphic" id="A2.I1.i2.p1.7.m7.1.1" xref="A2.I1.i2.p1.7.m7.1.1.cmml">𝒢</mi><annotation-xml encoding="MathML-Content" id="A2.I1.i2.p1.7.m7.1b"><ci id="A2.I1.i2.p1.7.m7.1.1.cmml" xref="A2.I1.i2.p1.7.m7.1.1">𝒢</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.I1.i2.p1.7.m7.1c">\mathcal{G}</annotation><annotation encoding="application/x-llamapun" id="A2.I1.i2.p1.7.m7.1d">caligraphic_G</annotation></semantics></math> are considered.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="A2.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">3.</span>
<div class="ltx_para" id="A2.I1.i3.p1">
<p class="ltx_p" id="A2.I1.i3.p1.1"><span class="ltx_text ltx_font_bold" id="A2.I1.i3.p1.1.1">Graphormer</span> <cite class="ltx_cite ltx_citemacro_citep">[Ying et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#bib.bib43" title="">2021</a>]</cite>.
In this paper, positional encodings based on the shortest path distances between the nodes of the graph (spatial encoding) and their respective degrees (centrality encoding) are seen to substantially improve transformer performance, closing the gap with graph neural networks.
There is no attempt to incorporate these techniques with linear attention, but the paper provides strong evidence of the effectiveness of graph-based attention modulation (topological masking).</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="A2.I1.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">4.</span>
<div class="ltx_para" id="A2.I1.i4.p1">
<p class="ltx_p" id="A2.I1.i4.p1.1"><span class="ltx_text ltx_font_bold" id="A2.I1.i4.p1.1.1">Block Toeplitz matrices and differential equations on graphs</span> <cite class="ltx_cite ltx_citemacro_citep">[Choromanski et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#bib.bib7" title="">2022</a>]</cite>.
This paper proves that subquadratic matrix-vector multiplication is sufficient for masking to be applied efficiently, and suggests a number of algorithms to achieve this in special cases.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<ul class="ltx_itemize" id="A2.I1.i4.I1">
<li class="ltx_item" id="A2.I1.i4.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A2.I1.i4.I1.i1.p1">
<p class="ltx_p" id="A2.I1.i4.I1.i1.p1.3"><em class="ltx_emph ltx_font_italic" id="A2.I1.i4.I1.i1.p1.3.1">Block Toeplitz matrices.</em> This method extends the work of <cite class="ltx_cite ltx_citemacro_citet">Luo et&nbsp;al. [<a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#bib.bib23" title="">2021</a>]</cite> to show that the analogous mask on a more general <math alttext="d" class="ltx_Math" display="inline" id="A2.I1.i4.I1.i1.p1.1.m1.1"><semantics id="A2.I1.i4.I1.i1.p1.1.m1.1a"><mi id="A2.I1.i4.I1.i1.p1.1.m1.1.1" xref="A2.I1.i4.I1.i1.p1.1.m1.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="A2.I1.i4.I1.i1.p1.1.m1.1b"><ci id="A2.I1.i4.I1.i1.p1.1.m1.1.1.cmml" xref="A2.I1.i4.I1.i1.p1.1.m1.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.I1.i4.I1.i1.p1.1.m1.1c">d</annotation><annotation encoding="application/x-llamapun" id="A2.I1.i4.I1.i1.p1.1.m1.1d">italic_d</annotation></semantics></math>-dimensional grid is <math alttext="d" class="ltx_Math" display="inline" id="A2.I1.i4.I1.i1.p1.2.m2.1"><semantics id="A2.I1.i4.I1.i1.p1.2.m2.1a"><mi id="A2.I1.i4.I1.i1.p1.2.m2.1.1" xref="A2.I1.i4.I1.i1.p1.2.m2.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="A2.I1.i4.I1.i1.p1.2.m2.1b"><ci id="A2.I1.i4.I1.i1.p1.2.m2.1.1.cmml" xref="A2.I1.i4.I1.i1.p1.2.m2.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.I1.i4.I1.i1.p1.2.m2.1c">d</annotation><annotation encoding="application/x-llamapun" id="A2.I1.i4.I1.i1.p1.2.m2.1d">italic_d</annotation></semantics></math>-level <em class="ltx_emph ltx_font_italic" id="A2.I1.i4.I1.i1.p1.3.2">block</em> Toeplitz.
Hence, this mask parameterisation also supports <math alttext="\mathcal{O}(N\log N)" class="ltx_Math" display="inline" id="A2.I1.i4.I1.i1.p1.3.m3.1"><semantics id="A2.I1.i4.I1.i1.p1.3.m3.1a"><mrow id="A2.I1.i4.I1.i1.p1.3.m3.1.1" xref="A2.I1.i4.I1.i1.p1.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A2.I1.i4.I1.i1.p1.3.m3.1.1.3" xref="A2.I1.i4.I1.i1.p1.3.m3.1.1.3.cmml">𝒪</mi><mo id="A2.I1.i4.I1.i1.p1.3.m3.1.1.2" xref="A2.I1.i4.I1.i1.p1.3.m3.1.1.2.cmml">⁢</mo><mrow id="A2.I1.i4.I1.i1.p1.3.m3.1.1.1.1" xref="A2.I1.i4.I1.i1.p1.3.m3.1.1.1.1.1.cmml"><mo id="A2.I1.i4.I1.i1.p1.3.m3.1.1.1.1.2" stretchy="false" xref="A2.I1.i4.I1.i1.p1.3.m3.1.1.1.1.1.cmml">(</mo><mrow id="A2.I1.i4.I1.i1.p1.3.m3.1.1.1.1.1" xref="A2.I1.i4.I1.i1.p1.3.m3.1.1.1.1.1.cmml"><mi id="A2.I1.i4.I1.i1.p1.3.m3.1.1.1.1.1.2" xref="A2.I1.i4.I1.i1.p1.3.m3.1.1.1.1.1.2.cmml">N</mi><mo id="A2.I1.i4.I1.i1.p1.3.m3.1.1.1.1.1.1" lspace="0.167em" xref="A2.I1.i4.I1.i1.p1.3.m3.1.1.1.1.1.1.cmml">⁢</mo><mrow id="A2.I1.i4.I1.i1.p1.3.m3.1.1.1.1.1.3" xref="A2.I1.i4.I1.i1.p1.3.m3.1.1.1.1.1.3.cmml"><mi id="A2.I1.i4.I1.i1.p1.3.m3.1.1.1.1.1.3.1" xref="A2.I1.i4.I1.i1.p1.3.m3.1.1.1.1.1.3.1.cmml">log</mi><mo id="A2.I1.i4.I1.i1.p1.3.m3.1.1.1.1.1.3a" lspace="0.167em" xref="A2.I1.i4.I1.i1.p1.3.m3.1.1.1.1.1.3.cmml">⁡</mo><mi id="A2.I1.i4.I1.i1.p1.3.m3.1.1.1.1.1.3.2" xref="A2.I1.i4.I1.i1.p1.3.m3.1.1.1.1.1.3.2.cmml">N</mi></mrow></mrow><mo id="A2.I1.i4.I1.i1.p1.3.m3.1.1.1.1.3" stretchy="false" xref="A2.I1.i4.I1.i1.p1.3.m3.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.I1.i4.I1.i1.p1.3.m3.1b"><apply id="A2.I1.i4.I1.i1.p1.3.m3.1.1.cmml" xref="A2.I1.i4.I1.i1.p1.3.m3.1.1"><times id="A2.I1.i4.I1.i1.p1.3.m3.1.1.2.cmml" xref="A2.I1.i4.I1.i1.p1.3.m3.1.1.2"></times><ci id="A2.I1.i4.I1.i1.p1.3.m3.1.1.3.cmml" xref="A2.I1.i4.I1.i1.p1.3.m3.1.1.3">𝒪</ci><apply id="A2.I1.i4.I1.i1.p1.3.m3.1.1.1.1.1.cmml" xref="A2.I1.i4.I1.i1.p1.3.m3.1.1.1.1"><times id="A2.I1.i4.I1.i1.p1.3.m3.1.1.1.1.1.1.cmml" xref="A2.I1.i4.I1.i1.p1.3.m3.1.1.1.1.1.1"></times><ci id="A2.I1.i4.I1.i1.p1.3.m3.1.1.1.1.1.2.cmml" xref="A2.I1.i4.I1.i1.p1.3.m3.1.1.1.1.1.2">𝑁</ci><apply id="A2.I1.i4.I1.i1.p1.3.m3.1.1.1.1.1.3.cmml" xref="A2.I1.i4.I1.i1.p1.3.m3.1.1.1.1.1.3"><log id="A2.I1.i4.I1.i1.p1.3.m3.1.1.1.1.1.3.1.cmml" xref="A2.I1.i4.I1.i1.p1.3.m3.1.1.1.1.1.3.1"></log><ci id="A2.I1.i4.I1.i1.p1.3.m3.1.1.1.1.1.3.2.cmml" xref="A2.I1.i4.I1.i1.p1.3.m3.1.1.1.1.1.3.2">𝑁</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.I1.i4.I1.i1.p1.3.m3.1c">\mathcal{O}(N\log N)</annotation><annotation encoding="application/x-llamapun" id="A2.I1.i4.I1.i1.p1.3.m3.1d">caligraphic_O ( italic_N roman_log italic_N )</annotation></semantics></math> masking, but now for a slightly more general class of graphs.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="A2.I1.i4.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A2.I1.i4.I1.i2.p1">
<p class="ltx_p" id="A2.I1.i4.I1.i2.p1.7"><em class="ltx_emph ltx_font_italic" id="A2.I1.i4.I1.i2.p1.7.1">Affine mappings on forests.</em> If <math alttext="\mathcal{G}" class="ltx_Math" display="inline" id="A2.I1.i4.I1.i2.p1.1.m1.1"><semantics id="A2.I1.i4.I1.i2.p1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="A2.I1.i4.I1.i2.p1.1.m1.1.1" xref="A2.I1.i4.I1.i2.p1.1.m1.1.1.cmml">𝒢</mi><annotation-xml encoding="MathML-Content" id="A2.I1.i4.I1.i2.p1.1.m1.1b"><ci id="A2.I1.i4.I1.i2.p1.1.m1.1.1.cmml" xref="A2.I1.i4.I1.i2.p1.1.m1.1.1">𝒢</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.I1.i4.I1.i2.p1.1.m1.1c">\mathcal{G}</annotation><annotation encoding="application/x-llamapun" id="A2.I1.i4.I1.i2.p1.1.m1.1d">caligraphic_G</annotation></semantics></math> is a forest and <math alttext="\mathbf{M}_{ij}=\exp(\tau(\textrm{dist}(v_{i},v_{j})))" class="ltx_Math" display="inline" id="A2.I1.i4.I1.i2.p1.2.m2.2"><semantics id="A2.I1.i4.I1.i2.p1.2.m2.2a"><mrow id="A2.I1.i4.I1.i2.p1.2.m2.2.2" xref="A2.I1.i4.I1.i2.p1.2.m2.2.2.cmml"><msub id="A2.I1.i4.I1.i2.p1.2.m2.2.2.3" xref="A2.I1.i4.I1.i2.p1.2.m2.2.2.3.cmml"><mi id="A2.I1.i4.I1.i2.p1.2.m2.2.2.3.2" xref="A2.I1.i4.I1.i2.p1.2.m2.2.2.3.2.cmml">𝐌</mi><mrow id="A2.I1.i4.I1.i2.p1.2.m2.2.2.3.3" xref="A2.I1.i4.I1.i2.p1.2.m2.2.2.3.3.cmml"><mi id="A2.I1.i4.I1.i2.p1.2.m2.2.2.3.3.2" xref="A2.I1.i4.I1.i2.p1.2.m2.2.2.3.3.2.cmml">i</mi><mo id="A2.I1.i4.I1.i2.p1.2.m2.2.2.3.3.1" xref="A2.I1.i4.I1.i2.p1.2.m2.2.2.3.3.1.cmml">⁢</mo><mi id="A2.I1.i4.I1.i2.p1.2.m2.2.2.3.3.3" xref="A2.I1.i4.I1.i2.p1.2.m2.2.2.3.3.3.cmml">j</mi></mrow></msub><mo id="A2.I1.i4.I1.i2.p1.2.m2.2.2.2" xref="A2.I1.i4.I1.i2.p1.2.m2.2.2.2.cmml">=</mo><mrow id="A2.I1.i4.I1.i2.p1.2.m2.2.2.1.1" xref="A2.I1.i4.I1.i2.p1.2.m2.2.2.1.2.cmml"><mi id="A2.I1.i4.I1.i2.p1.2.m2.1.1" xref="A2.I1.i4.I1.i2.p1.2.m2.1.1.cmml">exp</mi><mo id="A2.I1.i4.I1.i2.p1.2.m2.2.2.1.1a" xref="A2.I1.i4.I1.i2.p1.2.m2.2.2.1.2.cmml">⁡</mo><mrow id="A2.I1.i4.I1.i2.p1.2.m2.2.2.1.1.1" xref="A2.I1.i4.I1.i2.p1.2.m2.2.2.1.2.cmml"><mo id="A2.I1.i4.I1.i2.p1.2.m2.2.2.1.1.1.2" stretchy="false" xref="A2.I1.i4.I1.i2.p1.2.m2.2.2.1.2.cmml">(</mo><mrow id="A2.I1.i4.I1.i2.p1.2.m2.2.2.1.1.1.1" xref="A2.I1.i4.I1.i2.p1.2.m2.2.2.1.1.1.1.cmml"><mi id="A2.I1.i4.I1.i2.p1.2.m2.2.2.1.1.1.1.3" xref="A2.I1.i4.I1.i2.p1.2.m2.2.2.1.1.1.1.3.cmml">τ</mi><mo id="A2.I1.i4.I1.i2.p1.2.m2.2.2.1.1.1.1.2" xref="A2.I1.i4.I1.i2.p1.2.m2.2.2.1.1.1.1.2.cmml">⁢</mo><mrow id="A2.I1.i4.I1.i2.p1.2.m2.2.2.1.1.1.1.1.1" xref="A2.I1.i4.I1.i2.p1.2.m2.2.2.1.1.1.1.1.1.1.cmml"><mo id="A2.I1.i4.I1.i2.p1.2.m2.2.2.1.1.1.1.1.1.2" stretchy="false" xref="A2.I1.i4.I1.i2.p1.2.m2.2.2.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A2.I1.i4.I1.i2.p1.2.m2.2.2.1.1.1.1.1.1.1" xref="A2.I1.i4.I1.i2.p1.2.m2.2.2.1.1.1.1.1.1.1.cmml"><mtext id="A2.I1.i4.I1.i2.p1.2.m2.2.2.1.1.1.1.1.1.1.4" xref="A2.I1.i4.I1.i2.p1.2.m2.2.2.1.1.1.1.1.1.1.4a.cmml">dist</mtext><mo id="A2.I1.i4.I1.i2.p1.2.m2.2.2.1.1.1.1.1.1.1.3" xref="A2.I1.i4.I1.i2.p1.2.m2.2.2.1.1.1.1.1.1.1.3.cmml">⁢</mo><mrow id="A2.I1.i4.I1.i2.p1.2.m2.2.2.1.1.1.1.1.1.1.2.2" xref="A2.I1.i4.I1.i2.p1.2.m2.2.2.1.1.1.1.1.1.1.2.3.cmml"><mo id="A2.I1.i4.I1.i2.p1.2.m2.2.2.1.1.1.1.1.1.1.2.2.3" stretchy="false" xref="A2.I1.i4.I1.i2.p1.2.m2.2.2.1.1.1.1.1.1.1.2.3.cmml">(</mo><msub id="A2.I1.i4.I1.i2.p1.2.m2.2.2.1.1.1.1.1.1.1.1.1.1" xref="A2.I1.i4.I1.i2.p1.2.m2.2.2.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="A2.I1.i4.I1.i2.p1.2.m2.2.2.1.1.1.1.1.1.1.1.1.1.2" xref="A2.I1.i4.I1.i2.p1.2.m2.2.2.1.1.1.1.1.1.1.1.1.1.2.cmml">v</mi><mi id="A2.I1.i4.I1.i2.p1.2.m2.2.2.1.1.1.1.1.1.1.1.1.1.3" xref="A2.I1.i4.I1.i2.p1.2.m2.2.2.1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="A2.I1.i4.I1.i2.p1.2.m2.2.2.1.1.1.1.1.1.1.2.2.4" xref="A2.I1.i4.I1.i2.p1.2.m2.2.2.1.1.1.1.1.1.1.2.3.cmml">,</mo><msub id="A2.I1.i4.I1.i2.p1.2.m2.2.2.1.1.1.1.1.1.1.2.2.2" xref="A2.I1.i4.I1.i2.p1.2.m2.2.2.1.1.1.1.1.1.1.2.2.2.cmml"><mi id="A2.I1.i4.I1.i2.p1.2.m2.2.2.1.1.1.1.1.1.1.2.2.2.2" xref="A2.I1.i4.I1.i2.p1.2.m2.2.2.1.1.1.1.1.1.1.2.2.2.2.cmml">v</mi><mi id="A2.I1.i4.I1.i2.p1.2.m2.2.2.1.1.1.1.1.1.1.2.2.2.3" xref="A2.I1.i4.I1.i2.p1.2.m2.2.2.1.1.1.1.1.1.1.2.2.2.3.cmml">j</mi></msub><mo id="A2.I1.i4.I1.i2.p1.2.m2.2.2.1.1.1.1.1.1.1.2.2.5" stretchy="false" xref="A2.I1.i4.I1.i2.p1.2.m2.2.2.1.1.1.1.1.1.1.2.3.cmml">)</mo></mrow></mrow><mo id="A2.I1.i4.I1.i2.p1.2.m2.2.2.1.1.1.1.1.1.3" stretchy="false" xref="A2.I1.i4.I1.i2.p1.2.m2.2.2.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A2.I1.i4.I1.i2.p1.2.m2.2.2.1.1.1.3" stretchy="false" xref="A2.I1.i4.I1.i2.p1.2.m2.2.2.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.I1.i4.I1.i2.p1.2.m2.2b"><apply id="A2.I1.i4.I1.i2.p1.2.m2.2.2.cmml" xref="A2.I1.i4.I1.i2.p1.2.m2.2.2"><eq id="A2.I1.i4.I1.i2.p1.2.m2.2.2.2.cmml" xref="A2.I1.i4.I1.i2.p1.2.m2.2.2.2"></eq><apply id="A2.I1.i4.I1.i2.p1.2.m2.2.2.3.cmml" xref="A2.I1.i4.I1.i2.p1.2.m2.2.2.3"><csymbol cd="ambiguous" id="A2.I1.i4.I1.i2.p1.2.m2.2.2.3.1.cmml" xref="A2.I1.i4.I1.i2.p1.2.m2.2.2.3">subscript</csymbol><ci id="A2.I1.i4.I1.i2.p1.2.m2.2.2.3.2.cmml" xref="A2.I1.i4.I1.i2.p1.2.m2.2.2.3.2">𝐌</ci><apply id="A2.I1.i4.I1.i2.p1.2.m2.2.2.3.3.cmml" xref="A2.I1.i4.I1.i2.p1.2.m2.2.2.3.3"><times id="A2.I1.i4.I1.i2.p1.2.m2.2.2.3.3.1.cmml" xref="A2.I1.i4.I1.i2.p1.2.m2.2.2.3.3.1"></times><ci id="A2.I1.i4.I1.i2.p1.2.m2.2.2.3.3.2.cmml" xref="A2.I1.i4.I1.i2.p1.2.m2.2.2.3.3.2">𝑖</ci><ci id="A2.I1.i4.I1.i2.p1.2.m2.2.2.3.3.3.cmml" xref="A2.I1.i4.I1.i2.p1.2.m2.2.2.3.3.3">𝑗</ci></apply></apply><apply id="A2.I1.i4.I1.i2.p1.2.m2.2.2.1.2.cmml" xref="A2.I1.i4.I1.i2.p1.2.m2.2.2.1.1"><exp id="A2.I1.i4.I1.i2.p1.2.m2.1.1.cmml" xref="A2.I1.i4.I1.i2.p1.2.m2.1.1"></exp><apply id="A2.I1.i4.I1.i2.p1.2.m2.2.2.1.1.1.1.cmml" xref="A2.I1.i4.I1.i2.p1.2.m2.2.2.1.1.1.1"><times id="A2.I1.i4.I1.i2.p1.2.m2.2.2.1.1.1.1.2.cmml" xref="A2.I1.i4.I1.i2.p1.2.m2.2.2.1.1.1.1.2"></times><ci id="A2.I1.i4.I1.i2.p1.2.m2.2.2.1.1.1.1.3.cmml" xref="A2.I1.i4.I1.i2.p1.2.m2.2.2.1.1.1.1.3">𝜏</ci><apply id="A2.I1.i4.I1.i2.p1.2.m2.2.2.1.1.1.1.1.1.1.cmml" xref="A2.I1.i4.I1.i2.p1.2.m2.2.2.1.1.1.1.1.1"><times id="A2.I1.i4.I1.i2.p1.2.m2.2.2.1.1.1.1.1.1.1.3.cmml" xref="A2.I1.i4.I1.i2.p1.2.m2.2.2.1.1.1.1.1.1.1.3"></times><ci id="A2.I1.i4.I1.i2.p1.2.m2.2.2.1.1.1.1.1.1.1.4a.cmml" xref="A2.I1.i4.I1.i2.p1.2.m2.2.2.1.1.1.1.1.1.1.4"><mtext id="A2.I1.i4.I1.i2.p1.2.m2.2.2.1.1.1.1.1.1.1.4.cmml" xref="A2.I1.i4.I1.i2.p1.2.m2.2.2.1.1.1.1.1.1.1.4">dist</mtext></ci><interval closure="open" id="A2.I1.i4.I1.i2.p1.2.m2.2.2.1.1.1.1.1.1.1.2.3.cmml" xref="A2.I1.i4.I1.i2.p1.2.m2.2.2.1.1.1.1.1.1.1.2.2"><apply id="A2.I1.i4.I1.i2.p1.2.m2.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="A2.I1.i4.I1.i2.p1.2.m2.2.2.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A2.I1.i4.I1.i2.p1.2.m2.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A2.I1.i4.I1.i2.p1.2.m2.2.2.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="A2.I1.i4.I1.i2.p1.2.m2.2.2.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A2.I1.i4.I1.i2.p1.2.m2.2.2.1.1.1.1.1.1.1.1.1.1.2">𝑣</ci><ci id="A2.I1.i4.I1.i2.p1.2.m2.2.2.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A2.I1.i4.I1.i2.p1.2.m2.2.2.1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="A2.I1.i4.I1.i2.p1.2.m2.2.2.1.1.1.1.1.1.1.2.2.2.cmml" xref="A2.I1.i4.I1.i2.p1.2.m2.2.2.1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="A2.I1.i4.I1.i2.p1.2.m2.2.2.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="A2.I1.i4.I1.i2.p1.2.m2.2.2.1.1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="A2.I1.i4.I1.i2.p1.2.m2.2.2.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="A2.I1.i4.I1.i2.p1.2.m2.2.2.1.1.1.1.1.1.1.2.2.2.2">𝑣</ci><ci id="A2.I1.i4.I1.i2.p1.2.m2.2.2.1.1.1.1.1.1.1.2.2.2.3.cmml" xref="A2.I1.i4.I1.i2.p1.2.m2.2.2.1.1.1.1.1.1.1.2.2.2.3">𝑗</ci></apply></interval></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.I1.i4.I1.i2.p1.2.m2.2c">\mathbf{M}_{ij}=\exp(\tau(\textrm{dist}(v_{i},v_{j})))</annotation><annotation encoding="application/x-llamapun" id="A2.I1.i4.I1.i2.p1.2.m2.2d">bold_M start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT = roman_exp ( italic_τ ( dist ( italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) ) )</annotation></semantics></math>, where <math alttext="\textrm{dist}(v_{i},v_{j})" class="ltx_Math" display="inline" id="A2.I1.i4.I1.i2.p1.3.m3.2"><semantics id="A2.I1.i4.I1.i2.p1.3.m3.2a"><mrow id="A2.I1.i4.I1.i2.p1.3.m3.2.2" xref="A2.I1.i4.I1.i2.p1.3.m3.2.2.cmml"><mtext id="A2.I1.i4.I1.i2.p1.3.m3.2.2.4" xref="A2.I1.i4.I1.i2.p1.3.m3.2.2.4a.cmml">dist</mtext><mo id="A2.I1.i4.I1.i2.p1.3.m3.2.2.3" xref="A2.I1.i4.I1.i2.p1.3.m3.2.2.3.cmml">⁢</mo><mrow id="A2.I1.i4.I1.i2.p1.3.m3.2.2.2.2" xref="A2.I1.i4.I1.i2.p1.3.m3.2.2.2.3.cmml"><mo id="A2.I1.i4.I1.i2.p1.3.m3.2.2.2.2.3" stretchy="false" xref="A2.I1.i4.I1.i2.p1.3.m3.2.2.2.3.cmml">(</mo><msub id="A2.I1.i4.I1.i2.p1.3.m3.1.1.1.1.1" xref="A2.I1.i4.I1.i2.p1.3.m3.1.1.1.1.1.cmml"><mi id="A2.I1.i4.I1.i2.p1.3.m3.1.1.1.1.1.2" xref="A2.I1.i4.I1.i2.p1.3.m3.1.1.1.1.1.2.cmml">v</mi><mi id="A2.I1.i4.I1.i2.p1.3.m3.1.1.1.1.1.3" xref="A2.I1.i4.I1.i2.p1.3.m3.1.1.1.1.1.3.cmml">i</mi></msub><mo id="A2.I1.i4.I1.i2.p1.3.m3.2.2.2.2.4" xref="A2.I1.i4.I1.i2.p1.3.m3.2.2.2.3.cmml">,</mo><msub id="A2.I1.i4.I1.i2.p1.3.m3.2.2.2.2.2" xref="A2.I1.i4.I1.i2.p1.3.m3.2.2.2.2.2.cmml"><mi id="A2.I1.i4.I1.i2.p1.3.m3.2.2.2.2.2.2" xref="A2.I1.i4.I1.i2.p1.3.m3.2.2.2.2.2.2.cmml">v</mi><mi id="A2.I1.i4.I1.i2.p1.3.m3.2.2.2.2.2.3" xref="A2.I1.i4.I1.i2.p1.3.m3.2.2.2.2.2.3.cmml">j</mi></msub><mo id="A2.I1.i4.I1.i2.p1.3.m3.2.2.2.2.5" stretchy="false" xref="A2.I1.i4.I1.i2.p1.3.m3.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.I1.i4.I1.i2.p1.3.m3.2b"><apply id="A2.I1.i4.I1.i2.p1.3.m3.2.2.cmml" xref="A2.I1.i4.I1.i2.p1.3.m3.2.2"><times id="A2.I1.i4.I1.i2.p1.3.m3.2.2.3.cmml" xref="A2.I1.i4.I1.i2.p1.3.m3.2.2.3"></times><ci id="A2.I1.i4.I1.i2.p1.3.m3.2.2.4a.cmml" xref="A2.I1.i4.I1.i2.p1.3.m3.2.2.4"><mtext id="A2.I1.i4.I1.i2.p1.3.m3.2.2.4.cmml" xref="A2.I1.i4.I1.i2.p1.3.m3.2.2.4">dist</mtext></ci><interval closure="open" id="A2.I1.i4.I1.i2.p1.3.m3.2.2.2.3.cmml" xref="A2.I1.i4.I1.i2.p1.3.m3.2.2.2.2"><apply id="A2.I1.i4.I1.i2.p1.3.m3.1.1.1.1.1.cmml" xref="A2.I1.i4.I1.i2.p1.3.m3.1.1.1.1.1"><csymbol cd="ambiguous" id="A2.I1.i4.I1.i2.p1.3.m3.1.1.1.1.1.1.cmml" xref="A2.I1.i4.I1.i2.p1.3.m3.1.1.1.1.1">subscript</csymbol><ci id="A2.I1.i4.I1.i2.p1.3.m3.1.1.1.1.1.2.cmml" xref="A2.I1.i4.I1.i2.p1.3.m3.1.1.1.1.1.2">𝑣</ci><ci id="A2.I1.i4.I1.i2.p1.3.m3.1.1.1.1.1.3.cmml" xref="A2.I1.i4.I1.i2.p1.3.m3.1.1.1.1.1.3">𝑖</ci></apply><apply id="A2.I1.i4.I1.i2.p1.3.m3.2.2.2.2.2.cmml" xref="A2.I1.i4.I1.i2.p1.3.m3.2.2.2.2.2"><csymbol cd="ambiguous" id="A2.I1.i4.I1.i2.p1.3.m3.2.2.2.2.2.1.cmml" xref="A2.I1.i4.I1.i2.p1.3.m3.2.2.2.2.2">subscript</csymbol><ci id="A2.I1.i4.I1.i2.p1.3.m3.2.2.2.2.2.2.cmml" xref="A2.I1.i4.I1.i2.p1.3.m3.2.2.2.2.2.2">𝑣</ci><ci id="A2.I1.i4.I1.i2.p1.3.m3.2.2.2.2.2.3.cmml" xref="A2.I1.i4.I1.i2.p1.3.m3.2.2.2.2.2.3">𝑗</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.I1.i4.I1.i2.p1.3.m3.2c">\textrm{dist}(v_{i},v_{j})</annotation><annotation encoding="application/x-llamapun" id="A2.I1.i4.I1.i2.p1.3.m3.2d">dist ( italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT )</annotation></semantics></math> is the shortest path distance between nodes <math alttext="v_{i}" class="ltx_Math" display="inline" id="A2.I1.i4.I1.i2.p1.4.m4.1"><semantics id="A2.I1.i4.I1.i2.p1.4.m4.1a"><msub id="A2.I1.i4.I1.i2.p1.4.m4.1.1" xref="A2.I1.i4.I1.i2.p1.4.m4.1.1.cmml"><mi id="A2.I1.i4.I1.i2.p1.4.m4.1.1.2" xref="A2.I1.i4.I1.i2.p1.4.m4.1.1.2.cmml">v</mi><mi id="A2.I1.i4.I1.i2.p1.4.m4.1.1.3" xref="A2.I1.i4.I1.i2.p1.4.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A2.I1.i4.I1.i2.p1.4.m4.1b"><apply id="A2.I1.i4.I1.i2.p1.4.m4.1.1.cmml" xref="A2.I1.i4.I1.i2.p1.4.m4.1.1"><csymbol cd="ambiguous" id="A2.I1.i4.I1.i2.p1.4.m4.1.1.1.cmml" xref="A2.I1.i4.I1.i2.p1.4.m4.1.1">subscript</csymbol><ci id="A2.I1.i4.I1.i2.p1.4.m4.1.1.2.cmml" xref="A2.I1.i4.I1.i2.p1.4.m4.1.1.2">𝑣</ci><ci id="A2.I1.i4.I1.i2.p1.4.m4.1.1.3.cmml" xref="A2.I1.i4.I1.i2.p1.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.I1.i4.I1.i2.p1.4.m4.1c">v_{i}</annotation><annotation encoding="application/x-llamapun" id="A2.I1.i4.I1.i2.p1.4.m4.1d">italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="v_{j}" class="ltx_Math" display="inline" id="A2.I1.i4.I1.i2.p1.5.m5.1"><semantics id="A2.I1.i4.I1.i2.p1.5.m5.1a"><msub id="A2.I1.i4.I1.i2.p1.5.m5.1.1" xref="A2.I1.i4.I1.i2.p1.5.m5.1.1.cmml"><mi id="A2.I1.i4.I1.i2.p1.5.m5.1.1.2" xref="A2.I1.i4.I1.i2.p1.5.m5.1.1.2.cmml">v</mi><mi id="A2.I1.i4.I1.i2.p1.5.m5.1.1.3" xref="A2.I1.i4.I1.i2.p1.5.m5.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="A2.I1.i4.I1.i2.p1.5.m5.1b"><apply id="A2.I1.i4.I1.i2.p1.5.m5.1.1.cmml" xref="A2.I1.i4.I1.i2.p1.5.m5.1.1"><csymbol cd="ambiguous" id="A2.I1.i4.I1.i2.p1.5.m5.1.1.1.cmml" xref="A2.I1.i4.I1.i2.p1.5.m5.1.1">subscript</csymbol><ci id="A2.I1.i4.I1.i2.p1.5.m5.1.1.2.cmml" xref="A2.I1.i4.I1.i2.p1.5.m5.1.1.2">𝑣</ci><ci id="A2.I1.i4.I1.i2.p1.5.m5.1.1.3.cmml" xref="A2.I1.i4.I1.i2.p1.5.m5.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.I1.i4.I1.i2.p1.5.m5.1c">v_{j}</annotation><annotation encoding="application/x-llamapun" id="A2.I1.i4.I1.i2.p1.5.m5.1d">italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\tau" class="ltx_Math" display="inline" id="A2.I1.i4.I1.i2.p1.6.m6.1"><semantics id="A2.I1.i4.I1.i2.p1.6.m6.1a"><mi id="A2.I1.i4.I1.i2.p1.6.m6.1.1" xref="A2.I1.i4.I1.i2.p1.6.m6.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="A2.I1.i4.I1.i2.p1.6.m6.1b"><ci id="A2.I1.i4.I1.i2.p1.6.m6.1.1.cmml" xref="A2.I1.i4.I1.i2.p1.6.m6.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.I1.i4.I1.i2.p1.6.m6.1c">\tau</annotation><annotation encoding="application/x-llamapun" id="A2.I1.i4.I1.i2.p1.6.m6.1d">italic_τ</annotation></semantics></math> is an affine mapping, then topological masking can be implemented in <math alttext="\mathcal{O}(N)" class="ltx_Math" display="inline" id="A2.I1.i4.I1.i2.p1.7.m7.1"><semantics id="A2.I1.i4.I1.i2.p1.7.m7.1a"><mrow id="A2.I1.i4.I1.i2.p1.7.m7.1.2" xref="A2.I1.i4.I1.i2.p1.7.m7.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="A2.I1.i4.I1.i2.p1.7.m7.1.2.2" xref="A2.I1.i4.I1.i2.p1.7.m7.1.2.2.cmml">𝒪</mi><mo id="A2.I1.i4.I1.i2.p1.7.m7.1.2.1" xref="A2.I1.i4.I1.i2.p1.7.m7.1.2.1.cmml">⁢</mo><mrow id="A2.I1.i4.I1.i2.p1.7.m7.1.2.3.2" xref="A2.I1.i4.I1.i2.p1.7.m7.1.2.cmml"><mo id="A2.I1.i4.I1.i2.p1.7.m7.1.2.3.2.1" stretchy="false" xref="A2.I1.i4.I1.i2.p1.7.m7.1.2.cmml">(</mo><mi id="A2.I1.i4.I1.i2.p1.7.m7.1.1" xref="A2.I1.i4.I1.i2.p1.7.m7.1.1.cmml">N</mi><mo id="A2.I1.i4.I1.i2.p1.7.m7.1.2.3.2.2" stretchy="false" xref="A2.I1.i4.I1.i2.p1.7.m7.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.I1.i4.I1.i2.p1.7.m7.1b"><apply id="A2.I1.i4.I1.i2.p1.7.m7.1.2.cmml" xref="A2.I1.i4.I1.i2.p1.7.m7.1.2"><times id="A2.I1.i4.I1.i2.p1.7.m7.1.2.1.cmml" xref="A2.I1.i4.I1.i2.p1.7.m7.1.2.1"></times><ci id="A2.I1.i4.I1.i2.p1.7.m7.1.2.2.cmml" xref="A2.I1.i4.I1.i2.p1.7.m7.1.2.2">𝒪</ci><ci id="A2.I1.i4.I1.i2.p1.7.m7.1.1.cmml" xref="A2.I1.i4.I1.i2.p1.7.m7.1.1">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.I1.i4.I1.i2.p1.7.m7.1c">\mathcal{O}(N)</annotation><annotation encoding="application/x-llamapun" id="A2.I1.i4.I1.i2.p1.7.m7.1d">caligraphic_O ( italic_N )</annotation></semantics></math>.
The algorithm uses dynamic programming techniques for rooted trees.
Notwithstanding its speed, the flexibility of this parameterisation is limited and only particular topologies can be treated.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="A2.I1.i4.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A2.I1.i4.I1.i3.p1">
<p class="ltx_p" id="A2.I1.i4.I1.i3.p1.3"><em class="ltx_emph ltx_font_italic" id="A2.I1.i4.I1.i3.p1.3.1">Heat kernels on hypercubes.</em> <cite class="ltx_cite ltx_citemacro_citet">Kondor and Lafferty [<a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#bib.bib19" title="">2002</a>]</cite> derived a closed form for the heat kernel on a hypercube, which also turns out give a Toeplitz mask that can be applied in <math alttext="\mathcal{O}(N\log N)" class="ltx_Math" display="inline" id="A2.I1.i4.I1.i3.p1.1.m1.1"><semantics id="A2.I1.i4.I1.i3.p1.1.m1.1a"><mrow id="A2.I1.i4.I1.i3.p1.1.m1.1.1" xref="A2.I1.i4.I1.i3.p1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A2.I1.i4.I1.i3.p1.1.m1.1.1.3" xref="A2.I1.i4.I1.i3.p1.1.m1.1.1.3.cmml">𝒪</mi><mo id="A2.I1.i4.I1.i3.p1.1.m1.1.1.2" xref="A2.I1.i4.I1.i3.p1.1.m1.1.1.2.cmml">⁢</mo><mrow id="A2.I1.i4.I1.i3.p1.1.m1.1.1.1.1" xref="A2.I1.i4.I1.i3.p1.1.m1.1.1.1.1.1.cmml"><mo id="A2.I1.i4.I1.i3.p1.1.m1.1.1.1.1.2" stretchy="false" xref="A2.I1.i4.I1.i3.p1.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="A2.I1.i4.I1.i3.p1.1.m1.1.1.1.1.1" xref="A2.I1.i4.I1.i3.p1.1.m1.1.1.1.1.1.cmml"><mi id="A2.I1.i4.I1.i3.p1.1.m1.1.1.1.1.1.2" xref="A2.I1.i4.I1.i3.p1.1.m1.1.1.1.1.1.2.cmml">N</mi><mo id="A2.I1.i4.I1.i3.p1.1.m1.1.1.1.1.1.1" lspace="0.167em" xref="A2.I1.i4.I1.i3.p1.1.m1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="A2.I1.i4.I1.i3.p1.1.m1.1.1.1.1.1.3" xref="A2.I1.i4.I1.i3.p1.1.m1.1.1.1.1.1.3.cmml"><mi id="A2.I1.i4.I1.i3.p1.1.m1.1.1.1.1.1.3.1" xref="A2.I1.i4.I1.i3.p1.1.m1.1.1.1.1.1.3.1.cmml">log</mi><mo id="A2.I1.i4.I1.i3.p1.1.m1.1.1.1.1.1.3a" lspace="0.167em" xref="A2.I1.i4.I1.i3.p1.1.m1.1.1.1.1.1.3.cmml">⁡</mo><mi id="A2.I1.i4.I1.i3.p1.1.m1.1.1.1.1.1.3.2" xref="A2.I1.i4.I1.i3.p1.1.m1.1.1.1.1.1.3.2.cmml">N</mi></mrow></mrow><mo id="A2.I1.i4.I1.i3.p1.1.m1.1.1.1.1.3" stretchy="false" xref="A2.I1.i4.I1.i3.p1.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.I1.i4.I1.i3.p1.1.m1.1b"><apply id="A2.I1.i4.I1.i3.p1.1.m1.1.1.cmml" xref="A2.I1.i4.I1.i3.p1.1.m1.1.1"><times id="A2.I1.i4.I1.i3.p1.1.m1.1.1.2.cmml" xref="A2.I1.i4.I1.i3.p1.1.m1.1.1.2"></times><ci id="A2.I1.i4.I1.i3.p1.1.m1.1.1.3.cmml" xref="A2.I1.i4.I1.i3.p1.1.m1.1.1.3">𝒪</ci><apply id="A2.I1.i4.I1.i3.p1.1.m1.1.1.1.1.1.cmml" xref="A2.I1.i4.I1.i3.p1.1.m1.1.1.1.1"><times id="A2.I1.i4.I1.i3.p1.1.m1.1.1.1.1.1.1.cmml" xref="A2.I1.i4.I1.i3.p1.1.m1.1.1.1.1.1.1"></times><ci id="A2.I1.i4.I1.i3.p1.1.m1.1.1.1.1.1.2.cmml" xref="A2.I1.i4.I1.i3.p1.1.m1.1.1.1.1.1.2">𝑁</ci><apply id="A2.I1.i4.I1.i3.p1.1.m1.1.1.1.1.1.3.cmml" xref="A2.I1.i4.I1.i3.p1.1.m1.1.1.1.1.1.3"><log id="A2.I1.i4.I1.i3.p1.1.m1.1.1.1.1.1.3.1.cmml" xref="A2.I1.i4.I1.i3.p1.1.m1.1.1.1.1.1.3.1"></log><ci id="A2.I1.i4.I1.i3.p1.1.m1.1.1.1.1.1.3.2.cmml" xref="A2.I1.i4.I1.i3.p1.1.m1.1.1.1.1.1.3.2">𝑁</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.I1.i4.I1.i3.p1.1.m1.1c">\mathcal{O}(N\log N)</annotation><annotation encoding="application/x-llamapun" id="A2.I1.i4.I1.i3.p1.1.m1.1d">caligraphic_O ( italic_N roman_log italic_N )</annotation></semantics></math>.
This is a special instantiation of our power series masks <math alttext="\mathbf{M}_{\alpha}(\mathbf{W})" class="ltx_Math" display="inline" id="A2.I1.i4.I1.i3.p1.2.m2.1"><semantics id="A2.I1.i4.I1.i3.p1.2.m2.1a"><mrow id="A2.I1.i4.I1.i3.p1.2.m2.1.2" xref="A2.I1.i4.I1.i3.p1.2.m2.1.2.cmml"><msub id="A2.I1.i4.I1.i3.p1.2.m2.1.2.2" xref="A2.I1.i4.I1.i3.p1.2.m2.1.2.2.cmml"><mi id="A2.I1.i4.I1.i3.p1.2.m2.1.2.2.2" xref="A2.I1.i4.I1.i3.p1.2.m2.1.2.2.2.cmml">𝐌</mi><mi id="A2.I1.i4.I1.i3.p1.2.m2.1.2.2.3" xref="A2.I1.i4.I1.i3.p1.2.m2.1.2.2.3.cmml">α</mi></msub><mo id="A2.I1.i4.I1.i3.p1.2.m2.1.2.1" xref="A2.I1.i4.I1.i3.p1.2.m2.1.2.1.cmml">⁢</mo><mrow id="A2.I1.i4.I1.i3.p1.2.m2.1.2.3.2" xref="A2.I1.i4.I1.i3.p1.2.m2.1.2.cmml"><mo id="A2.I1.i4.I1.i3.p1.2.m2.1.2.3.2.1" stretchy="false" xref="A2.I1.i4.I1.i3.p1.2.m2.1.2.cmml">(</mo><mi id="A2.I1.i4.I1.i3.p1.2.m2.1.1" xref="A2.I1.i4.I1.i3.p1.2.m2.1.1.cmml">𝐖</mi><mo id="A2.I1.i4.I1.i3.p1.2.m2.1.2.3.2.2" stretchy="false" xref="A2.I1.i4.I1.i3.p1.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.I1.i4.I1.i3.p1.2.m2.1b"><apply id="A2.I1.i4.I1.i3.p1.2.m2.1.2.cmml" xref="A2.I1.i4.I1.i3.p1.2.m2.1.2"><times id="A2.I1.i4.I1.i3.p1.2.m2.1.2.1.cmml" xref="A2.I1.i4.I1.i3.p1.2.m2.1.2.1"></times><apply id="A2.I1.i4.I1.i3.p1.2.m2.1.2.2.cmml" xref="A2.I1.i4.I1.i3.p1.2.m2.1.2.2"><csymbol cd="ambiguous" id="A2.I1.i4.I1.i3.p1.2.m2.1.2.2.1.cmml" xref="A2.I1.i4.I1.i3.p1.2.m2.1.2.2">subscript</csymbol><ci id="A2.I1.i4.I1.i3.p1.2.m2.1.2.2.2.cmml" xref="A2.I1.i4.I1.i3.p1.2.m2.1.2.2.2">𝐌</ci><ci id="A2.I1.i4.I1.i3.p1.2.m2.1.2.2.3.cmml" xref="A2.I1.i4.I1.i3.p1.2.m2.1.2.2.3">𝛼</ci></apply><ci id="A2.I1.i4.I1.i3.p1.2.m2.1.1.cmml" xref="A2.I1.i4.I1.i3.p1.2.m2.1.1">𝐖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.I1.i4.I1.i3.p1.2.m2.1c">\mathbf{M}_{\alpha}(\mathbf{W})</annotation><annotation encoding="application/x-llamapun" id="A2.I1.i4.I1.i3.p1.2.m2.1d">bold_M start_POSTSUBSCRIPT italic_α end_POSTSUBSCRIPT ( bold_W )</annotation></semantics></math> for a specific choice of <math alttext="\mathcal{G}" class="ltx_Math" display="inline" id="A2.I1.i4.I1.i3.p1.3.m3.1"><semantics id="A2.I1.i4.I1.i3.p1.3.m3.1a"><mi class="ltx_font_mathcaligraphic" id="A2.I1.i4.I1.i3.p1.3.m3.1.1" xref="A2.I1.i4.I1.i3.p1.3.m3.1.1.cmml">𝒢</mi><annotation-xml encoding="MathML-Content" id="A2.I1.i4.I1.i3.p1.3.m3.1b"><ci id="A2.I1.i4.I1.i3.p1.3.m3.1.1.cmml" xref="A2.I1.i4.I1.i3.p1.3.m3.1.1">𝒢</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.I1.i4.I1.i3.p1.3.m3.1c">\mathcal{G}</annotation><annotation encoding="application/x-llamapun" id="A2.I1.i4.I1.i3.p1.3.m3.1d">caligraphic_G</annotation></semantics></math>.
The authors did not empirically test heat kernels; we found them to perform very poorly compared to our more general, faster method.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="A2.I1.i4.I1.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para ltx_noindent" id="A2.I1.i4.I1.i4.p1">
<p class="ltx_p" id="A2.I1.i4.I1.i4.p1.1"><em class="ltx_emph ltx_font_italic" id="A2.I1.i4.I1.i4.p1.1.1">Random walk graph node kernels.</em>
Here, the authors define an ad-hoc graph kernel by taking the dot product between two ‘frequency vectors’, recording the nodes visited by the random walks beginning at the two nodes of interest.
This method is the closest to our approach, but with some crucial differences: (i) we use <em class="ltx_emph ltx_font_italic" id="A2.I1.i4.I1.i4.p1.1.2">importance</em> sampling of random walks, which we find to be crucial for good performance (see App.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#A3" title="Appendix C Further experiments and details ‣ Linear Transformer Topological Masking with Graph Random Features"><span class="ltx_text ltx_ref_tag">C</span></a>); (ii) we use <em class="ltx_emph ltx_font_italic" id="A2.I1.i4.I1.i4.p1.1.3">learnable</em> weights that depend of the length of random walk, permitting flexible upweighting or downweighting of longer- and shorter-range interactions; (iii) our method provides a Monte Carlo estimate of a learnable function of a weighted adjacency matrix, which enjoys certain regularisation properties <cite class="ltx_cite ltx_citemacro_citep">[Reid et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#bib.bib29" title="">2024b</a>]</cite>.
More importantly, we are able to derive strong concentration bounds that <em class="ltx_emph ltx_font_italic" id="A2.I1.i4.I1.i4.p1.1.4">prove</em> that our method is <math alttext="\mathcal{O}(N)" class="ltx_Math" display="inline" id="A2.I1.i4.I1.i4.p1.1.m1.1"><semantics id="A2.I1.i4.I1.i4.p1.1.m1.1a"><mrow id="A2.I1.i4.I1.i4.p1.1.m1.1.2" xref="A2.I1.i4.I1.i4.p1.1.m1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="A2.I1.i4.I1.i4.p1.1.m1.1.2.2" xref="A2.I1.i4.I1.i4.p1.1.m1.1.2.2.cmml">𝒪</mi><mo id="A2.I1.i4.I1.i4.p1.1.m1.1.2.1" xref="A2.I1.i4.I1.i4.p1.1.m1.1.2.1.cmml">⁢</mo><mrow id="A2.I1.i4.I1.i4.p1.1.m1.1.2.3.2" xref="A2.I1.i4.I1.i4.p1.1.m1.1.2.cmml"><mo id="A2.I1.i4.I1.i4.p1.1.m1.1.2.3.2.1" stretchy="false" xref="A2.I1.i4.I1.i4.p1.1.m1.1.2.cmml">(</mo><mi id="A2.I1.i4.I1.i4.p1.1.m1.1.1" xref="A2.I1.i4.I1.i4.p1.1.m1.1.1.cmml">N</mi><mo id="A2.I1.i4.I1.i4.p1.1.m1.1.2.3.2.2" stretchy="false" xref="A2.I1.i4.I1.i4.p1.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.I1.i4.I1.i4.p1.1.m1.1b"><apply id="A2.I1.i4.I1.i4.p1.1.m1.1.2.cmml" xref="A2.I1.i4.I1.i4.p1.1.m1.1.2"><times id="A2.I1.i4.I1.i4.p1.1.m1.1.2.1.cmml" xref="A2.I1.i4.I1.i4.p1.1.m1.1.2.1"></times><ci id="A2.I1.i4.I1.i4.p1.1.m1.1.2.2.cmml" xref="A2.I1.i4.I1.i4.p1.1.m1.1.2.2">𝒪</ci><ci id="A2.I1.i4.I1.i4.p1.1.m1.1.1.cmml" xref="A2.I1.i4.I1.i4.p1.1.m1.1.1">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.I1.i4.I1.i4.p1.1.m1.1c">\mathcal{O}(N)</annotation><annotation encoding="application/x-llamapun" id="A2.I1.i4.I1.i4.p1.1.m1.1d">caligraphic_O ( italic_N )</annotation></semantics></math>, whereas <cite class="ltx_cite ltx_citemacro_citet">Choromanski et&nbsp;al. [<a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#bib.bib7" title="">2022</a>]</cite> do not explicitly guarantee any time complexities.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
</ul>
</div>
</li>
<li class="ltx_item" id="A2.I1.i5" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">5.</span>
<div class="ltx_para" id="A2.I1.i5.p1">
<p class="ltx_p" id="A2.I1.i5.p1.5"><span class="ltx_text ltx_font_bold" id="A2.I1.i5.p1.5.1">Centrality degree encoding</span> <cite class="ltx_cite ltx_citemacro_citep">[Chen et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#bib.bib4" title="">2024</a>]</cite>.
This paper takes the mask <math alttext="\mathbf{M}_{ij}=\sin(\frac{\pi}{4}[z(d_{i})+z(d_{j})])" class="ltx_Math" display="inline" id="A2.I1.i5.p1.1.m1.2"><semantics id="A2.I1.i5.p1.1.m1.2a"><mrow id="A2.I1.i5.p1.1.m1.2.2" xref="A2.I1.i5.p1.1.m1.2.2.cmml"><msub id="A2.I1.i5.p1.1.m1.2.2.3" xref="A2.I1.i5.p1.1.m1.2.2.3.cmml"><mi id="A2.I1.i5.p1.1.m1.2.2.3.2" xref="A2.I1.i5.p1.1.m1.2.2.3.2.cmml">𝐌</mi><mrow id="A2.I1.i5.p1.1.m1.2.2.3.3" xref="A2.I1.i5.p1.1.m1.2.2.3.3.cmml"><mi id="A2.I1.i5.p1.1.m1.2.2.3.3.2" xref="A2.I1.i5.p1.1.m1.2.2.3.3.2.cmml">i</mi><mo id="A2.I1.i5.p1.1.m1.2.2.3.3.1" xref="A2.I1.i5.p1.1.m1.2.2.3.3.1.cmml">⁢</mo><mi id="A2.I1.i5.p1.1.m1.2.2.3.3.3" xref="A2.I1.i5.p1.1.m1.2.2.3.3.3.cmml">j</mi></mrow></msub><mo id="A2.I1.i5.p1.1.m1.2.2.2" xref="A2.I1.i5.p1.1.m1.2.2.2.cmml">=</mo><mrow id="A2.I1.i5.p1.1.m1.2.2.1.1" xref="A2.I1.i5.p1.1.m1.2.2.1.2.cmml"><mi id="A2.I1.i5.p1.1.m1.1.1" xref="A2.I1.i5.p1.1.m1.1.1.cmml">sin</mi><mo id="A2.I1.i5.p1.1.m1.2.2.1.1a" xref="A2.I1.i5.p1.1.m1.2.2.1.2.cmml">⁡</mo><mrow id="A2.I1.i5.p1.1.m1.2.2.1.1.1" xref="A2.I1.i5.p1.1.m1.2.2.1.2.cmml"><mo id="A2.I1.i5.p1.1.m1.2.2.1.1.1.2" stretchy="false" xref="A2.I1.i5.p1.1.m1.2.2.1.2.cmml">(</mo><mrow id="A2.I1.i5.p1.1.m1.2.2.1.1.1.1" xref="A2.I1.i5.p1.1.m1.2.2.1.1.1.1.cmml"><mfrac id="A2.I1.i5.p1.1.m1.2.2.1.1.1.1.3" xref="A2.I1.i5.p1.1.m1.2.2.1.1.1.1.3.cmml"><mi id="A2.I1.i5.p1.1.m1.2.2.1.1.1.1.3.2" xref="A2.I1.i5.p1.1.m1.2.2.1.1.1.1.3.2.cmml">π</mi><mn id="A2.I1.i5.p1.1.m1.2.2.1.1.1.1.3.3" xref="A2.I1.i5.p1.1.m1.2.2.1.1.1.1.3.3.cmml">4</mn></mfrac><mo id="A2.I1.i5.p1.1.m1.2.2.1.1.1.1.2" xref="A2.I1.i5.p1.1.m1.2.2.1.1.1.1.2.cmml">⁢</mo><mrow id="A2.I1.i5.p1.1.m1.2.2.1.1.1.1.1.1" xref="A2.I1.i5.p1.1.m1.2.2.1.1.1.1.1.2.cmml"><mo id="A2.I1.i5.p1.1.m1.2.2.1.1.1.1.1.1.2" stretchy="false" xref="A2.I1.i5.p1.1.m1.2.2.1.1.1.1.1.2.1.cmml">[</mo><mrow id="A2.I1.i5.p1.1.m1.2.2.1.1.1.1.1.1.1" xref="A2.I1.i5.p1.1.m1.2.2.1.1.1.1.1.1.1.cmml"><mrow id="A2.I1.i5.p1.1.m1.2.2.1.1.1.1.1.1.1.1" xref="A2.I1.i5.p1.1.m1.2.2.1.1.1.1.1.1.1.1.cmml"><mi id="A2.I1.i5.p1.1.m1.2.2.1.1.1.1.1.1.1.1.3" xref="A2.I1.i5.p1.1.m1.2.2.1.1.1.1.1.1.1.1.3.cmml">z</mi><mo id="A2.I1.i5.p1.1.m1.2.2.1.1.1.1.1.1.1.1.2" xref="A2.I1.i5.p1.1.m1.2.2.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A2.I1.i5.p1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1" xref="A2.I1.i5.p1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="A2.I1.i5.p1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="A2.I1.i5.p1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="A2.I1.i5.p1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1" xref="A2.I1.i5.p1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="A2.I1.i5.p1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2" xref="A2.I1.i5.p1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.cmml">d</mi><mi id="A2.I1.i5.p1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3" xref="A2.I1.i5.p1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="A2.I1.i5.p1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="A2.I1.i5.p1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A2.I1.i5.p1.1.m1.2.2.1.1.1.1.1.1.1.3" xref="A2.I1.i5.p1.1.m1.2.2.1.1.1.1.1.1.1.3.cmml">+</mo><mrow id="A2.I1.i5.p1.1.m1.2.2.1.1.1.1.1.1.1.2" xref="A2.I1.i5.p1.1.m1.2.2.1.1.1.1.1.1.1.2.cmml"><mi id="A2.I1.i5.p1.1.m1.2.2.1.1.1.1.1.1.1.2.3" xref="A2.I1.i5.p1.1.m1.2.2.1.1.1.1.1.1.1.2.3.cmml">z</mi><mo id="A2.I1.i5.p1.1.m1.2.2.1.1.1.1.1.1.1.2.2" xref="A2.I1.i5.p1.1.m1.2.2.1.1.1.1.1.1.1.2.2.cmml">⁢</mo><mrow id="A2.I1.i5.p1.1.m1.2.2.1.1.1.1.1.1.1.2.1.1" xref="A2.I1.i5.p1.1.m1.2.2.1.1.1.1.1.1.1.2.1.1.1.cmml"><mo id="A2.I1.i5.p1.1.m1.2.2.1.1.1.1.1.1.1.2.1.1.2" stretchy="false" xref="A2.I1.i5.p1.1.m1.2.2.1.1.1.1.1.1.1.2.1.1.1.cmml">(</mo><msub id="A2.I1.i5.p1.1.m1.2.2.1.1.1.1.1.1.1.2.1.1.1" xref="A2.I1.i5.p1.1.m1.2.2.1.1.1.1.1.1.1.2.1.1.1.cmml"><mi id="A2.I1.i5.p1.1.m1.2.2.1.1.1.1.1.1.1.2.1.1.1.2" xref="A2.I1.i5.p1.1.m1.2.2.1.1.1.1.1.1.1.2.1.1.1.2.cmml">d</mi><mi id="A2.I1.i5.p1.1.m1.2.2.1.1.1.1.1.1.1.2.1.1.1.3" xref="A2.I1.i5.p1.1.m1.2.2.1.1.1.1.1.1.1.2.1.1.1.3.cmml">j</mi></msub><mo id="A2.I1.i5.p1.1.m1.2.2.1.1.1.1.1.1.1.2.1.1.3" stretchy="false" xref="A2.I1.i5.p1.1.m1.2.2.1.1.1.1.1.1.1.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="A2.I1.i5.p1.1.m1.2.2.1.1.1.1.1.1.3" stretchy="false" xref="A2.I1.i5.p1.1.m1.2.2.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="A2.I1.i5.p1.1.m1.2.2.1.1.1.3" stretchy="false" xref="A2.I1.i5.p1.1.m1.2.2.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.I1.i5.p1.1.m1.2b"><apply id="A2.I1.i5.p1.1.m1.2.2.cmml" xref="A2.I1.i5.p1.1.m1.2.2"><eq id="A2.I1.i5.p1.1.m1.2.2.2.cmml" xref="A2.I1.i5.p1.1.m1.2.2.2"></eq><apply id="A2.I1.i5.p1.1.m1.2.2.3.cmml" xref="A2.I1.i5.p1.1.m1.2.2.3"><csymbol cd="ambiguous" id="A2.I1.i5.p1.1.m1.2.2.3.1.cmml" xref="A2.I1.i5.p1.1.m1.2.2.3">subscript</csymbol><ci id="A2.I1.i5.p1.1.m1.2.2.3.2.cmml" xref="A2.I1.i5.p1.1.m1.2.2.3.2">𝐌</ci><apply id="A2.I1.i5.p1.1.m1.2.2.3.3.cmml" xref="A2.I1.i5.p1.1.m1.2.2.3.3"><times id="A2.I1.i5.p1.1.m1.2.2.3.3.1.cmml" xref="A2.I1.i5.p1.1.m1.2.2.3.3.1"></times><ci id="A2.I1.i5.p1.1.m1.2.2.3.3.2.cmml" xref="A2.I1.i5.p1.1.m1.2.2.3.3.2">𝑖</ci><ci id="A2.I1.i5.p1.1.m1.2.2.3.3.3.cmml" xref="A2.I1.i5.p1.1.m1.2.2.3.3.3">𝑗</ci></apply></apply><apply id="A2.I1.i5.p1.1.m1.2.2.1.2.cmml" xref="A2.I1.i5.p1.1.m1.2.2.1.1"><sin id="A2.I1.i5.p1.1.m1.1.1.cmml" xref="A2.I1.i5.p1.1.m1.1.1"></sin><apply id="A2.I1.i5.p1.1.m1.2.2.1.1.1.1.cmml" xref="A2.I1.i5.p1.1.m1.2.2.1.1.1.1"><times id="A2.I1.i5.p1.1.m1.2.2.1.1.1.1.2.cmml" xref="A2.I1.i5.p1.1.m1.2.2.1.1.1.1.2"></times><apply id="A2.I1.i5.p1.1.m1.2.2.1.1.1.1.3.cmml" xref="A2.I1.i5.p1.1.m1.2.2.1.1.1.1.3"><divide id="A2.I1.i5.p1.1.m1.2.2.1.1.1.1.3.1.cmml" xref="A2.I1.i5.p1.1.m1.2.2.1.1.1.1.3"></divide><ci id="A2.I1.i5.p1.1.m1.2.2.1.1.1.1.3.2.cmml" xref="A2.I1.i5.p1.1.m1.2.2.1.1.1.1.3.2">𝜋</ci><cn id="A2.I1.i5.p1.1.m1.2.2.1.1.1.1.3.3.cmml" type="integer" xref="A2.I1.i5.p1.1.m1.2.2.1.1.1.1.3.3">4</cn></apply><apply id="A2.I1.i5.p1.1.m1.2.2.1.1.1.1.1.2.cmml" xref="A2.I1.i5.p1.1.m1.2.2.1.1.1.1.1.1"><csymbol cd="latexml" id="A2.I1.i5.p1.1.m1.2.2.1.1.1.1.1.2.1.cmml" xref="A2.I1.i5.p1.1.m1.2.2.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="A2.I1.i5.p1.1.m1.2.2.1.1.1.1.1.1.1.cmml" xref="A2.I1.i5.p1.1.m1.2.2.1.1.1.1.1.1.1"><plus id="A2.I1.i5.p1.1.m1.2.2.1.1.1.1.1.1.1.3.cmml" xref="A2.I1.i5.p1.1.m1.2.2.1.1.1.1.1.1.1.3"></plus><apply id="A2.I1.i5.p1.1.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="A2.I1.i5.p1.1.m1.2.2.1.1.1.1.1.1.1.1"><times id="A2.I1.i5.p1.1.m1.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="A2.I1.i5.p1.1.m1.2.2.1.1.1.1.1.1.1.1.2"></times><ci id="A2.I1.i5.p1.1.m1.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="A2.I1.i5.p1.1.m1.2.2.1.1.1.1.1.1.1.1.3">𝑧</ci><apply id="A2.I1.i5.p1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A2.I1.i5.p1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A2.I1.i5.p1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A2.I1.i5.p1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="A2.I1.i5.p1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A2.I1.i5.p1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2">𝑑</ci><ci id="A2.I1.i5.p1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A2.I1.i5.p1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply><apply id="A2.I1.i5.p1.1.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="A2.I1.i5.p1.1.m1.2.2.1.1.1.1.1.1.1.2"><times id="A2.I1.i5.p1.1.m1.2.2.1.1.1.1.1.1.1.2.2.cmml" xref="A2.I1.i5.p1.1.m1.2.2.1.1.1.1.1.1.1.2.2"></times><ci id="A2.I1.i5.p1.1.m1.2.2.1.1.1.1.1.1.1.2.3.cmml" xref="A2.I1.i5.p1.1.m1.2.2.1.1.1.1.1.1.1.2.3">𝑧</ci><apply id="A2.I1.i5.p1.1.m1.2.2.1.1.1.1.1.1.1.2.1.1.1.cmml" xref="A2.I1.i5.p1.1.m1.2.2.1.1.1.1.1.1.1.2.1.1"><csymbol cd="ambiguous" id="A2.I1.i5.p1.1.m1.2.2.1.1.1.1.1.1.1.2.1.1.1.1.cmml" xref="A2.I1.i5.p1.1.m1.2.2.1.1.1.1.1.1.1.2.1.1">subscript</csymbol><ci id="A2.I1.i5.p1.1.m1.2.2.1.1.1.1.1.1.1.2.1.1.1.2.cmml" xref="A2.I1.i5.p1.1.m1.2.2.1.1.1.1.1.1.1.2.1.1.1.2">𝑑</ci><ci id="A2.I1.i5.p1.1.m1.2.2.1.1.1.1.1.1.1.2.1.1.1.3.cmml" xref="A2.I1.i5.p1.1.m1.2.2.1.1.1.1.1.1.1.2.1.1.1.3">𝑗</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.I1.i5.p1.1.m1.2c">\mathbf{M}_{ij}=\sin(\frac{\pi}{4}[z(d_{i})+z(d_{j})])</annotation><annotation encoding="application/x-llamapun" id="A2.I1.i5.p1.1.m1.2d">bold_M start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT = roman_sin ( divide start_ARG italic_π end_ARG start_ARG 4 end_ARG [ italic_z ( italic_d start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) + italic_z ( italic_d start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) ] )</annotation></semantics></math>, where <math alttext="d_{\{i,j\}}" class="ltx_Math" display="inline" id="A2.I1.i5.p1.2.m2.2"><semantics id="A2.I1.i5.p1.2.m2.2a"><msub id="A2.I1.i5.p1.2.m2.2.3" xref="A2.I1.i5.p1.2.m2.2.3.cmml"><mi id="A2.I1.i5.p1.2.m2.2.3.2" xref="A2.I1.i5.p1.2.m2.2.3.2.cmml">d</mi><mrow id="A2.I1.i5.p1.2.m2.2.2.2.4" xref="A2.I1.i5.p1.2.m2.2.2.2.3.cmml"><mo id="A2.I1.i5.p1.2.m2.2.2.2.4.1" stretchy="false" xref="A2.I1.i5.p1.2.m2.2.2.2.3.cmml">{</mo><mi id="A2.I1.i5.p1.2.m2.1.1.1.1" xref="A2.I1.i5.p1.2.m2.1.1.1.1.cmml">i</mi><mo id="A2.I1.i5.p1.2.m2.2.2.2.4.2" xref="A2.I1.i5.p1.2.m2.2.2.2.3.cmml">,</mo><mi id="A2.I1.i5.p1.2.m2.2.2.2.2" xref="A2.I1.i5.p1.2.m2.2.2.2.2.cmml">j</mi><mo id="A2.I1.i5.p1.2.m2.2.2.2.4.3" stretchy="false" xref="A2.I1.i5.p1.2.m2.2.2.2.3.cmml">}</mo></mrow></msub><annotation-xml encoding="MathML-Content" id="A2.I1.i5.p1.2.m2.2b"><apply id="A2.I1.i5.p1.2.m2.2.3.cmml" xref="A2.I1.i5.p1.2.m2.2.3"><csymbol cd="ambiguous" id="A2.I1.i5.p1.2.m2.2.3.1.cmml" xref="A2.I1.i5.p1.2.m2.2.3">subscript</csymbol><ci id="A2.I1.i5.p1.2.m2.2.3.2.cmml" xref="A2.I1.i5.p1.2.m2.2.3.2">𝑑</ci><set id="A2.I1.i5.p1.2.m2.2.2.2.3.cmml" xref="A2.I1.i5.p1.2.m2.2.2.2.4"><ci id="A2.I1.i5.p1.2.m2.1.1.1.1.cmml" xref="A2.I1.i5.p1.2.m2.1.1.1.1">𝑖</ci><ci id="A2.I1.i5.p1.2.m2.2.2.2.2.cmml" xref="A2.I1.i5.p1.2.m2.2.2.2.2">𝑗</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.I1.i5.p1.2.m2.2c">d_{\{i,j\}}</annotation><annotation encoding="application/x-llamapun" id="A2.I1.i5.p1.2.m2.2d">italic_d start_POSTSUBSCRIPT { italic_i , italic_j } end_POSTSUBSCRIPT</annotation></semantics></math> is the degree of node <math alttext="v_{\{i,j\}}" class="ltx_Math" display="inline" id="A2.I1.i5.p1.3.m3.2"><semantics id="A2.I1.i5.p1.3.m3.2a"><msub id="A2.I1.i5.p1.3.m3.2.3" xref="A2.I1.i5.p1.3.m3.2.3.cmml"><mi id="A2.I1.i5.p1.3.m3.2.3.2" xref="A2.I1.i5.p1.3.m3.2.3.2.cmml">v</mi><mrow id="A2.I1.i5.p1.3.m3.2.2.2.4" xref="A2.I1.i5.p1.3.m3.2.2.2.3.cmml"><mo id="A2.I1.i5.p1.3.m3.2.2.2.4.1" stretchy="false" xref="A2.I1.i5.p1.3.m3.2.2.2.3.cmml">{</mo><mi id="A2.I1.i5.p1.3.m3.1.1.1.1" xref="A2.I1.i5.p1.3.m3.1.1.1.1.cmml">i</mi><mo id="A2.I1.i5.p1.3.m3.2.2.2.4.2" xref="A2.I1.i5.p1.3.m3.2.2.2.3.cmml">,</mo><mi id="A2.I1.i5.p1.3.m3.2.2.2.2" xref="A2.I1.i5.p1.3.m3.2.2.2.2.cmml">j</mi><mo id="A2.I1.i5.p1.3.m3.2.2.2.4.3" stretchy="false" xref="A2.I1.i5.p1.3.m3.2.2.2.3.cmml">}</mo></mrow></msub><annotation-xml encoding="MathML-Content" id="A2.I1.i5.p1.3.m3.2b"><apply id="A2.I1.i5.p1.3.m3.2.3.cmml" xref="A2.I1.i5.p1.3.m3.2.3"><csymbol cd="ambiguous" id="A2.I1.i5.p1.3.m3.2.3.1.cmml" xref="A2.I1.i5.p1.3.m3.2.3">subscript</csymbol><ci id="A2.I1.i5.p1.3.m3.2.3.2.cmml" xref="A2.I1.i5.p1.3.m3.2.3.2">𝑣</ci><set id="A2.I1.i5.p1.3.m3.2.2.2.3.cmml" xref="A2.I1.i5.p1.3.m3.2.2.2.4"><ci id="A2.I1.i5.p1.3.m3.1.1.1.1.cmml" xref="A2.I1.i5.p1.3.m3.1.1.1.1">𝑖</ci><ci id="A2.I1.i5.p1.3.m3.2.2.2.2.cmml" xref="A2.I1.i5.p1.3.m3.2.2.2.2">𝑗</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.I1.i5.p1.3.m3.2c">v_{\{i,j\}}</annotation><annotation encoding="application/x-llamapun" id="A2.I1.i5.p1.3.m3.2d">italic_v start_POSTSUBSCRIPT { italic_i , italic_j } end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="z:\mathbb{N}\to(0,1)" class="ltx_Math" display="inline" id="A2.I1.i5.p1.4.m4.2"><semantics id="A2.I1.i5.p1.4.m4.2a"><mrow id="A2.I1.i5.p1.4.m4.2.3" xref="A2.I1.i5.p1.4.m4.2.3.cmml"><mi id="A2.I1.i5.p1.4.m4.2.3.2" xref="A2.I1.i5.p1.4.m4.2.3.2.cmml">z</mi><mo id="A2.I1.i5.p1.4.m4.2.3.1" lspace="0.278em" rspace="0.278em" xref="A2.I1.i5.p1.4.m4.2.3.1.cmml">:</mo><mrow id="A2.I1.i5.p1.4.m4.2.3.3" xref="A2.I1.i5.p1.4.m4.2.3.3.cmml"><mi id="A2.I1.i5.p1.4.m4.2.3.3.2" xref="A2.I1.i5.p1.4.m4.2.3.3.2.cmml">ℕ</mi><mo id="A2.I1.i5.p1.4.m4.2.3.3.1" stretchy="false" xref="A2.I1.i5.p1.4.m4.2.3.3.1.cmml">→</mo><mrow id="A2.I1.i5.p1.4.m4.2.3.3.3.2" xref="A2.I1.i5.p1.4.m4.2.3.3.3.1.cmml"><mo id="A2.I1.i5.p1.4.m4.2.3.3.3.2.1" stretchy="false" xref="A2.I1.i5.p1.4.m4.2.3.3.3.1.cmml">(</mo><mn id="A2.I1.i5.p1.4.m4.1.1" xref="A2.I1.i5.p1.4.m4.1.1.cmml">0</mn><mo id="A2.I1.i5.p1.4.m4.2.3.3.3.2.2" xref="A2.I1.i5.p1.4.m4.2.3.3.3.1.cmml">,</mo><mn id="A2.I1.i5.p1.4.m4.2.2" xref="A2.I1.i5.p1.4.m4.2.2.cmml">1</mn><mo id="A2.I1.i5.p1.4.m4.2.3.3.3.2.3" stretchy="false" xref="A2.I1.i5.p1.4.m4.2.3.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.I1.i5.p1.4.m4.2b"><apply id="A2.I1.i5.p1.4.m4.2.3.cmml" xref="A2.I1.i5.p1.4.m4.2.3"><ci id="A2.I1.i5.p1.4.m4.2.3.1.cmml" xref="A2.I1.i5.p1.4.m4.2.3.1">:</ci><ci id="A2.I1.i5.p1.4.m4.2.3.2.cmml" xref="A2.I1.i5.p1.4.m4.2.3.2">𝑧</ci><apply id="A2.I1.i5.p1.4.m4.2.3.3.cmml" xref="A2.I1.i5.p1.4.m4.2.3.3"><ci id="A2.I1.i5.p1.4.m4.2.3.3.1.cmml" xref="A2.I1.i5.p1.4.m4.2.3.3.1">→</ci><ci id="A2.I1.i5.p1.4.m4.2.3.3.2.cmml" xref="A2.I1.i5.p1.4.m4.2.3.3.2">ℕ</ci><interval closure="open" id="A2.I1.i5.p1.4.m4.2.3.3.3.1.cmml" xref="A2.I1.i5.p1.4.m4.2.3.3.3.2"><cn id="A2.I1.i5.p1.4.m4.1.1.cmml" type="integer" xref="A2.I1.i5.p1.4.m4.1.1">0</cn><cn id="A2.I1.i5.p1.4.m4.2.2.cmml" type="integer" xref="A2.I1.i5.p1.4.m4.2.2">1</cn></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.I1.i5.p1.4.m4.2c">z:\mathbb{N}\to(0,1)</annotation><annotation encoding="application/x-llamapun" id="A2.I1.i5.p1.4.m4.2d">italic_z : blackboard_N → ( 0 , 1 )</annotation></semantics></math> is a learnable function thereof.
This can be implemented with linear transformers on general graphs in <math alttext="\mathcal{O}(N)" class="ltx_Math" display="inline" id="A2.I1.i5.p1.5.m5.1"><semantics id="A2.I1.i5.p1.5.m5.1a"><mrow id="A2.I1.i5.p1.5.m5.1.2" xref="A2.I1.i5.p1.5.m5.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="A2.I1.i5.p1.5.m5.1.2.2" xref="A2.I1.i5.p1.5.m5.1.2.2.cmml">𝒪</mi><mo id="A2.I1.i5.p1.5.m5.1.2.1" xref="A2.I1.i5.p1.5.m5.1.2.1.cmml">⁢</mo><mrow id="A2.I1.i5.p1.5.m5.1.2.3.2" xref="A2.I1.i5.p1.5.m5.1.2.cmml"><mo id="A2.I1.i5.p1.5.m5.1.2.3.2.1" stretchy="false" xref="A2.I1.i5.p1.5.m5.1.2.cmml">(</mo><mi id="A2.I1.i5.p1.5.m5.1.1" xref="A2.I1.i5.p1.5.m5.1.1.cmml">N</mi><mo id="A2.I1.i5.p1.5.m5.1.2.3.2.2" stretchy="false" xref="A2.I1.i5.p1.5.m5.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.I1.i5.p1.5.m5.1b"><apply id="A2.I1.i5.p1.5.m5.1.2.cmml" xref="A2.I1.i5.p1.5.m5.1.2"><times id="A2.I1.i5.p1.5.m5.1.2.1.cmml" xref="A2.I1.i5.p1.5.m5.1.2.1"></times><ci id="A2.I1.i5.p1.5.m5.1.2.2.cmml" xref="A2.I1.i5.p1.5.m5.1.2.2">𝒪</ci><ci id="A2.I1.i5.p1.5.m5.1.1.cmml" xref="A2.I1.i5.p1.5.m5.1.1">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.I1.i5.p1.5.m5.1c">\mathcal{O}(N)</annotation><annotation encoding="application/x-llamapun" id="A2.I1.i5.p1.5.m5.1d">caligraphic_O ( italic_N )</annotation></semantics></math> time complexity, but since it is completely insensitive to the relative positions of the nodes in the graph it cannot be considered a general topological masking mechanism.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="A2.I1.i6" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">6.</span>
<div class="ltx_para ltx_noindent" id="A2.I1.i6.p1">
<p class="ltx_p" id="A2.I1.i6.p1.1"><span class="ltx_text ltx_font_bold" id="A2.I1.i6.p1.1.1">Graph attention networks</span> <cite class="ltx_cite ltx_citemacro_citep">[Veličković et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#bib.bib36" title="">2018</a>]</cite>.
This seminal work incorporates masked self-attention into graph neural networks, with each node attending only to its neighbours.
The focus is on developing a convolution-style neural network for graph-structured data rather than on efficient masking of linear attention transformers.
Our mask parameterisation is more general than this hard nearest-neighbours example, but shares the finding that modulating attention by local topological structure boosts performance.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
</ol>
</div>
</section>
<section class="ltx_appendix" id="A3">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix C </span>Further experiments and details</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="A3.p1">
<p class="ltx_p" id="A3.p1.1">Here, we include extra experiments and details too long for the main text.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<section class="ltx_subsection" id="A3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">C.1 </span>Architectures, hyperparameters and training details</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="A3.SS1.p1">
<p class="ltx_p" id="A3.SS1.p1.1">Table <a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#A3.T2" title="Table 2 ‣ C.1 Architectures, hyperparameters and training details ‣ Appendix C Further experiments and details ‣ Linear Transformer Topological Masking with Graph Random Features"><span class="ltx_text ltx_ref_tag">2</span></a> gives details for the ViT experiments.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_table" id="A3.T2">
<table class="ltx_tabular ltx_centering ltx_align_middle" id="A3.T2.16">
<tbody><tr class="ltx_tr" id="A3.T2.16.17">
<td class="ltx_td ltx_border_tt" id="A3.T2.16.17.1" style="padding-left:3.0pt;padding-right:3.0pt;"></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A3.T2.16.17.2" style="padding-left:3.0pt;padding-right:3.0pt;">ImageNet</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A3.T2.16.17.3" style="padding-left:3.0pt;padding-right:3.0pt;">iNaturalist2021</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A3.T2.16.17.4" style="padding-left:3.0pt;padding-right:3.0pt;">Places365 (Small)</td>
</tr>
<tr class="ltx_tr" id="A3.T2.16.18">
<td class="ltx_td" id="A3.T2.16.18.1" style="padding-left:3.0pt;padding-right:3.0pt;"></td>
<td class="ltx_td ltx_align_center" id="A3.T2.16.18.2" style="padding-left:3.0pt;padding-right:3.0pt;">1M</td>
<td class="ltx_td ltx_align_center" id="A3.T2.16.18.3" style="padding-left:3.0pt;padding-right:3.0pt;">2.7M</td>
<td class="ltx_td ltx_align_center" id="A3.T2.16.18.4" style="padding-left:3.0pt;padding-right:3.0pt;">1.8M</td>
</tr>
<tr class="ltx_tr" id="A3.T2.16.19">
<td class="ltx_td ltx_align_center ltx_border_t" id="A3.T2.16.19.1" style="padding-left:3.0pt;padding-right:3.0pt;">Num. layers</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A3.T2.16.19.2" style="padding-left:3.0pt;padding-right:3.0pt;">12</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A3.T2.16.19.3" style="padding-left:3.0pt;padding-right:3.0pt;">12</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A3.T2.16.19.4" style="padding-left:3.0pt;padding-right:3.0pt;">12</td>
</tr>
<tr class="ltx_tr" id="A3.T2.16.20">
<td class="ltx_td ltx_align_center" id="A3.T2.16.20.1" style="padding-left:3.0pt;padding-right:3.0pt;">Num. heads</td>
<td class="ltx_td ltx_align_center" id="A3.T2.16.20.2" style="padding-left:3.0pt;padding-right:3.0pt;">12</td>
<td class="ltx_td ltx_align_center" id="A3.T2.16.20.3" style="padding-left:3.0pt;padding-right:3.0pt;">12</td>
<td class="ltx_td ltx_align_center" id="A3.T2.16.20.4" style="padding-left:3.0pt;padding-right:3.0pt;">12</td>
</tr>
<tr class="ltx_tr" id="A3.T2.3.3">
<td class="ltx_td ltx_align_center" id="A3.T2.3.3.4" style="padding-left:3.0pt;padding-right:3.0pt;">Num. patches</td>
<td class="ltx_td ltx_align_center" id="A3.T2.1.1.1" style="padding-left:3.0pt;padding-right:3.0pt;"><math alttext="16\times 16" class="ltx_Math" display="inline" id="A3.T2.1.1.1.m1.1"><semantics id="A3.T2.1.1.1.m1.1a"><mrow id="A3.T2.1.1.1.m1.1.1" xref="A3.T2.1.1.1.m1.1.1.cmml"><mn id="A3.T2.1.1.1.m1.1.1.2" xref="A3.T2.1.1.1.m1.1.1.2.cmml">16</mn><mo id="A3.T2.1.1.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="A3.T2.1.1.1.m1.1.1.1.cmml">×</mo><mn id="A3.T2.1.1.1.m1.1.1.3" xref="A3.T2.1.1.1.m1.1.1.3.cmml">16</mn></mrow><annotation-xml encoding="MathML-Content" id="A3.T2.1.1.1.m1.1b"><apply id="A3.T2.1.1.1.m1.1.1.cmml" xref="A3.T2.1.1.1.m1.1.1"><times id="A3.T2.1.1.1.m1.1.1.1.cmml" xref="A3.T2.1.1.1.m1.1.1.1"></times><cn id="A3.T2.1.1.1.m1.1.1.2.cmml" type="integer" xref="A3.T2.1.1.1.m1.1.1.2">16</cn><cn id="A3.T2.1.1.1.m1.1.1.3.cmml" type="integer" xref="A3.T2.1.1.1.m1.1.1.3">16</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.T2.1.1.1.m1.1c">16\times 16</annotation><annotation encoding="application/x-llamapun" id="A3.T2.1.1.1.m1.1d">16 × 16</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="A3.T2.2.2.2" style="padding-left:3.0pt;padding-right:3.0pt;"><math alttext="16\times 16" class="ltx_Math" display="inline" id="A3.T2.2.2.2.m1.1"><semantics id="A3.T2.2.2.2.m1.1a"><mrow id="A3.T2.2.2.2.m1.1.1" xref="A3.T2.2.2.2.m1.1.1.cmml"><mn id="A3.T2.2.2.2.m1.1.1.2" xref="A3.T2.2.2.2.m1.1.1.2.cmml">16</mn><mo id="A3.T2.2.2.2.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="A3.T2.2.2.2.m1.1.1.1.cmml">×</mo><mn id="A3.T2.2.2.2.m1.1.1.3" xref="A3.T2.2.2.2.m1.1.1.3.cmml">16</mn></mrow><annotation-xml encoding="MathML-Content" id="A3.T2.2.2.2.m1.1b"><apply id="A3.T2.2.2.2.m1.1.1.cmml" xref="A3.T2.2.2.2.m1.1.1"><times id="A3.T2.2.2.2.m1.1.1.1.cmml" xref="A3.T2.2.2.2.m1.1.1.1"></times><cn id="A3.T2.2.2.2.m1.1.1.2.cmml" type="integer" xref="A3.T2.2.2.2.m1.1.1.2">16</cn><cn id="A3.T2.2.2.2.m1.1.1.3.cmml" type="integer" xref="A3.T2.2.2.2.m1.1.1.3">16</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.T2.2.2.2.m1.1c">16\times 16</annotation><annotation encoding="application/x-llamapun" id="A3.T2.2.2.2.m1.1d">16 × 16</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="A3.T2.3.3.3" style="padding-left:3.0pt;padding-right:3.0pt;"><math alttext="16\times 16" class="ltx_Math" display="inline" id="A3.T2.3.3.3.m1.1"><semantics id="A3.T2.3.3.3.m1.1a"><mrow id="A3.T2.3.3.3.m1.1.1" xref="A3.T2.3.3.3.m1.1.1.cmml"><mn id="A3.T2.3.3.3.m1.1.1.2" xref="A3.T2.3.3.3.m1.1.1.2.cmml">16</mn><mo id="A3.T2.3.3.3.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="A3.T2.3.3.3.m1.1.1.1.cmml">×</mo><mn id="A3.T2.3.3.3.m1.1.1.3" xref="A3.T2.3.3.3.m1.1.1.3.cmml">16</mn></mrow><annotation-xml encoding="MathML-Content" id="A3.T2.3.3.3.m1.1b"><apply id="A3.T2.3.3.3.m1.1.1.cmml" xref="A3.T2.3.3.3.m1.1.1"><times id="A3.T2.3.3.3.m1.1.1.1.cmml" xref="A3.T2.3.3.3.m1.1.1.1"></times><cn id="A3.T2.3.3.3.m1.1.1.2.cmml" type="integer" xref="A3.T2.3.3.3.m1.1.1.2">16</cn><cn id="A3.T2.3.3.3.m1.1.1.3.cmml" type="integer" xref="A3.T2.3.3.3.m1.1.1.3">16</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.T2.3.3.3.m1.1c">16\times 16</annotation><annotation encoding="application/x-llamapun" id="A3.T2.3.3.3.m1.1d">16 × 16</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A3.T2.16.21">
<td class="ltx_td ltx_align_center" id="A3.T2.16.21.1" style="padding-left:3.0pt;padding-right:3.0pt;">Hidden size</td>
<td class="ltx_td ltx_align_center" id="A3.T2.16.21.2" style="padding-left:3.0pt;padding-right:3.0pt;">768</td>
<td class="ltx_td ltx_align_center" id="A3.T2.16.21.3" style="padding-left:3.0pt;padding-right:3.0pt;">768</td>
<td class="ltx_td ltx_align_center" id="A3.T2.16.21.4" style="padding-left:3.0pt;padding-right:3.0pt;">768</td>
</tr>
<tr class="ltx_tr" id="A3.T2.16.22">
<td class="ltx_td ltx_align_center" id="A3.T2.16.22.1" style="padding-left:3.0pt;padding-right:3.0pt;">MLP dim.</td>
<td class="ltx_td ltx_align_center" id="A3.T2.16.22.2" style="padding-left:3.0pt;padding-right:3.0pt;">3072</td>
<td class="ltx_td ltx_align_center" id="A3.T2.16.22.3" style="padding-left:3.0pt;padding-right:3.0pt;">3072</td>
<td class="ltx_td ltx_align_center" id="A3.T2.16.22.4" style="padding-left:3.0pt;padding-right:3.0pt;">3072</td>
</tr>
<tr class="ltx_tr" id="A3.T2.16.23">
<td class="ltx_td ltx_align_center" id="A3.T2.16.23.1" style="padding-left:3.0pt;padding-right:3.0pt;">Optimiser</td>
<td class="ltx_td ltx_align_center" id="A3.T2.16.23.2" style="padding-left:3.0pt;padding-right:3.0pt;">Adam</td>
<td class="ltx_td ltx_align_center" id="A3.T2.16.23.3" style="padding-left:3.0pt;padding-right:3.0pt;">Adam</td>
<td class="ltx_td ltx_align_center" id="A3.T2.16.23.4" style="padding-left:3.0pt;padding-right:3.0pt;">Adam</td>
</tr>
<tr class="ltx_tr" id="A3.T2.16.24">
<td class="ltx_td ltx_align_center" id="A3.T2.16.24.1" style="padding-left:3.0pt;padding-right:3.0pt;">Epochs</td>
<td class="ltx_td ltx_align_center" id="A3.T2.16.24.2" style="padding-left:3.0pt;padding-right:3.0pt;">90</td>
<td class="ltx_td ltx_align_center" id="A3.T2.16.24.3" style="padding-left:3.0pt;padding-right:3.0pt;">5</td>
<td class="ltx_td ltx_align_center" id="A3.T2.16.24.4" style="padding-left:3.0pt;padding-right:3.0pt;">5</td>
</tr>
<tr class="ltx_tr" id="A3.T2.6.6">
<td class="ltx_td ltx_align_center" id="A3.T2.6.6.4" style="padding-left:3.0pt;padding-right:3.0pt;">Base learning rate</td>
<td class="ltx_td ltx_align_center" id="A3.T2.4.4.1" style="padding-left:3.0pt;padding-right:3.0pt;"><math alttext="3\times 10^{-3}" class="ltx_Math" display="inline" id="A3.T2.4.4.1.m1.1"><semantics id="A3.T2.4.4.1.m1.1a"><mrow id="A3.T2.4.4.1.m1.1.1" xref="A3.T2.4.4.1.m1.1.1.cmml"><mn id="A3.T2.4.4.1.m1.1.1.2" xref="A3.T2.4.4.1.m1.1.1.2.cmml">3</mn><mo id="A3.T2.4.4.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="A3.T2.4.4.1.m1.1.1.1.cmml">×</mo><msup id="A3.T2.4.4.1.m1.1.1.3" xref="A3.T2.4.4.1.m1.1.1.3.cmml"><mn id="A3.T2.4.4.1.m1.1.1.3.2" xref="A3.T2.4.4.1.m1.1.1.3.2.cmml">10</mn><mrow id="A3.T2.4.4.1.m1.1.1.3.3" xref="A3.T2.4.4.1.m1.1.1.3.3.cmml"><mo id="A3.T2.4.4.1.m1.1.1.3.3a" xref="A3.T2.4.4.1.m1.1.1.3.3.cmml">−</mo><mn id="A3.T2.4.4.1.m1.1.1.3.3.2" xref="A3.T2.4.4.1.m1.1.1.3.3.2.cmml">3</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A3.T2.4.4.1.m1.1b"><apply id="A3.T2.4.4.1.m1.1.1.cmml" xref="A3.T2.4.4.1.m1.1.1"><times id="A3.T2.4.4.1.m1.1.1.1.cmml" xref="A3.T2.4.4.1.m1.1.1.1"></times><cn id="A3.T2.4.4.1.m1.1.1.2.cmml" type="integer" xref="A3.T2.4.4.1.m1.1.1.2">3</cn><apply id="A3.T2.4.4.1.m1.1.1.3.cmml" xref="A3.T2.4.4.1.m1.1.1.3"><csymbol cd="ambiguous" id="A3.T2.4.4.1.m1.1.1.3.1.cmml" xref="A3.T2.4.4.1.m1.1.1.3">superscript</csymbol><cn id="A3.T2.4.4.1.m1.1.1.3.2.cmml" type="integer" xref="A3.T2.4.4.1.m1.1.1.3.2">10</cn><apply id="A3.T2.4.4.1.m1.1.1.3.3.cmml" xref="A3.T2.4.4.1.m1.1.1.3.3"><minus id="A3.T2.4.4.1.m1.1.1.3.3.1.cmml" xref="A3.T2.4.4.1.m1.1.1.3.3"></minus><cn id="A3.T2.4.4.1.m1.1.1.3.3.2.cmml" type="integer" xref="A3.T2.4.4.1.m1.1.1.3.3.2">3</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.T2.4.4.1.m1.1c">3\times 10^{-3}</annotation><annotation encoding="application/x-llamapun" id="A3.T2.4.4.1.m1.1d">3 × 10 start_POSTSUPERSCRIPT - 3 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="A3.T2.5.5.2" style="padding-left:3.0pt;padding-right:3.0pt;"><math alttext="3\times 10^{-3}" class="ltx_Math" display="inline" id="A3.T2.5.5.2.m1.1"><semantics id="A3.T2.5.5.2.m1.1a"><mrow id="A3.T2.5.5.2.m1.1.1" xref="A3.T2.5.5.2.m1.1.1.cmml"><mn id="A3.T2.5.5.2.m1.1.1.2" xref="A3.T2.5.5.2.m1.1.1.2.cmml">3</mn><mo id="A3.T2.5.5.2.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="A3.T2.5.5.2.m1.1.1.1.cmml">×</mo><msup id="A3.T2.5.5.2.m1.1.1.3" xref="A3.T2.5.5.2.m1.1.1.3.cmml"><mn id="A3.T2.5.5.2.m1.1.1.3.2" xref="A3.T2.5.5.2.m1.1.1.3.2.cmml">10</mn><mrow id="A3.T2.5.5.2.m1.1.1.3.3" xref="A3.T2.5.5.2.m1.1.1.3.3.cmml"><mo id="A3.T2.5.5.2.m1.1.1.3.3a" xref="A3.T2.5.5.2.m1.1.1.3.3.cmml">−</mo><mn id="A3.T2.5.5.2.m1.1.1.3.3.2" xref="A3.T2.5.5.2.m1.1.1.3.3.2.cmml">3</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A3.T2.5.5.2.m1.1b"><apply id="A3.T2.5.5.2.m1.1.1.cmml" xref="A3.T2.5.5.2.m1.1.1"><times id="A3.T2.5.5.2.m1.1.1.1.cmml" xref="A3.T2.5.5.2.m1.1.1.1"></times><cn id="A3.T2.5.5.2.m1.1.1.2.cmml" type="integer" xref="A3.T2.5.5.2.m1.1.1.2">3</cn><apply id="A3.T2.5.5.2.m1.1.1.3.cmml" xref="A3.T2.5.5.2.m1.1.1.3"><csymbol cd="ambiguous" id="A3.T2.5.5.2.m1.1.1.3.1.cmml" xref="A3.T2.5.5.2.m1.1.1.3">superscript</csymbol><cn id="A3.T2.5.5.2.m1.1.1.3.2.cmml" type="integer" xref="A3.T2.5.5.2.m1.1.1.3.2">10</cn><apply id="A3.T2.5.5.2.m1.1.1.3.3.cmml" xref="A3.T2.5.5.2.m1.1.1.3.3"><minus id="A3.T2.5.5.2.m1.1.1.3.3.1.cmml" xref="A3.T2.5.5.2.m1.1.1.3.3"></minus><cn id="A3.T2.5.5.2.m1.1.1.3.3.2.cmml" type="integer" xref="A3.T2.5.5.2.m1.1.1.3.3.2">3</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.T2.5.5.2.m1.1c">3\times 10^{-3}</annotation><annotation encoding="application/x-llamapun" id="A3.T2.5.5.2.m1.1d">3 × 10 start_POSTSUPERSCRIPT - 3 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="A3.T2.6.6.3" style="padding-left:3.0pt;padding-right:3.0pt;"><math alttext="3\times 10^{-3}" class="ltx_Math" display="inline" id="A3.T2.6.6.3.m1.1"><semantics id="A3.T2.6.6.3.m1.1a"><mrow id="A3.T2.6.6.3.m1.1.1" xref="A3.T2.6.6.3.m1.1.1.cmml"><mn id="A3.T2.6.6.3.m1.1.1.2" xref="A3.T2.6.6.3.m1.1.1.2.cmml">3</mn><mo id="A3.T2.6.6.3.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="A3.T2.6.6.3.m1.1.1.1.cmml">×</mo><msup id="A3.T2.6.6.3.m1.1.1.3" xref="A3.T2.6.6.3.m1.1.1.3.cmml"><mn id="A3.T2.6.6.3.m1.1.1.3.2" xref="A3.T2.6.6.3.m1.1.1.3.2.cmml">10</mn><mrow id="A3.T2.6.6.3.m1.1.1.3.3" xref="A3.T2.6.6.3.m1.1.1.3.3.cmml"><mo id="A3.T2.6.6.3.m1.1.1.3.3a" xref="A3.T2.6.6.3.m1.1.1.3.3.cmml">−</mo><mn id="A3.T2.6.6.3.m1.1.1.3.3.2" xref="A3.T2.6.6.3.m1.1.1.3.3.2.cmml">3</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A3.T2.6.6.3.m1.1b"><apply id="A3.T2.6.6.3.m1.1.1.cmml" xref="A3.T2.6.6.3.m1.1.1"><times id="A3.T2.6.6.3.m1.1.1.1.cmml" xref="A3.T2.6.6.3.m1.1.1.1"></times><cn id="A3.T2.6.6.3.m1.1.1.2.cmml" type="integer" xref="A3.T2.6.6.3.m1.1.1.2">3</cn><apply id="A3.T2.6.6.3.m1.1.1.3.cmml" xref="A3.T2.6.6.3.m1.1.1.3"><csymbol cd="ambiguous" id="A3.T2.6.6.3.m1.1.1.3.1.cmml" xref="A3.T2.6.6.3.m1.1.1.3">superscript</csymbol><cn id="A3.T2.6.6.3.m1.1.1.3.2.cmml" type="integer" xref="A3.T2.6.6.3.m1.1.1.3.2">10</cn><apply id="A3.T2.6.6.3.m1.1.1.3.3.cmml" xref="A3.T2.6.6.3.m1.1.1.3.3"><minus id="A3.T2.6.6.3.m1.1.1.3.3.1.cmml" xref="A3.T2.6.6.3.m1.1.1.3.3"></minus><cn id="A3.T2.6.6.3.m1.1.1.3.3.2.cmml" type="integer" xref="A3.T2.6.6.3.m1.1.1.3.3.2">3</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.T2.6.6.3.m1.1c">3\times 10^{-3}</annotation><annotation encoding="application/x-llamapun" id="A3.T2.6.6.3.m1.1d">3 × 10 start_POSTSUPERSCRIPT - 3 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A3.T2.9.9">
<td class="ltx_td ltx_align_center" id="A3.T2.9.9.4" style="padding-left:3.0pt;padding-right:3.0pt;">Final learning rate</td>
<td class="ltx_td ltx_align_center" id="A3.T2.7.7.1" style="padding-left:3.0pt;padding-right:3.0pt;"><math alttext="1\times 10^{-5}" class="ltx_Math" display="inline" id="A3.T2.7.7.1.m1.1"><semantics id="A3.T2.7.7.1.m1.1a"><mrow id="A3.T2.7.7.1.m1.1.1" xref="A3.T2.7.7.1.m1.1.1.cmml"><mn id="A3.T2.7.7.1.m1.1.1.2" xref="A3.T2.7.7.1.m1.1.1.2.cmml">1</mn><mo id="A3.T2.7.7.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="A3.T2.7.7.1.m1.1.1.1.cmml">×</mo><msup id="A3.T2.7.7.1.m1.1.1.3" xref="A3.T2.7.7.1.m1.1.1.3.cmml"><mn id="A3.T2.7.7.1.m1.1.1.3.2" xref="A3.T2.7.7.1.m1.1.1.3.2.cmml">10</mn><mrow id="A3.T2.7.7.1.m1.1.1.3.3" xref="A3.T2.7.7.1.m1.1.1.3.3.cmml"><mo id="A3.T2.7.7.1.m1.1.1.3.3a" xref="A3.T2.7.7.1.m1.1.1.3.3.cmml">−</mo><mn id="A3.T2.7.7.1.m1.1.1.3.3.2" xref="A3.T2.7.7.1.m1.1.1.3.3.2.cmml">5</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A3.T2.7.7.1.m1.1b"><apply id="A3.T2.7.7.1.m1.1.1.cmml" xref="A3.T2.7.7.1.m1.1.1"><times id="A3.T2.7.7.1.m1.1.1.1.cmml" xref="A3.T2.7.7.1.m1.1.1.1"></times><cn id="A3.T2.7.7.1.m1.1.1.2.cmml" type="integer" xref="A3.T2.7.7.1.m1.1.1.2">1</cn><apply id="A3.T2.7.7.1.m1.1.1.3.cmml" xref="A3.T2.7.7.1.m1.1.1.3"><csymbol cd="ambiguous" id="A3.T2.7.7.1.m1.1.1.3.1.cmml" xref="A3.T2.7.7.1.m1.1.1.3">superscript</csymbol><cn id="A3.T2.7.7.1.m1.1.1.3.2.cmml" type="integer" xref="A3.T2.7.7.1.m1.1.1.3.2">10</cn><apply id="A3.T2.7.7.1.m1.1.1.3.3.cmml" xref="A3.T2.7.7.1.m1.1.1.3.3"><minus id="A3.T2.7.7.1.m1.1.1.3.3.1.cmml" xref="A3.T2.7.7.1.m1.1.1.3.3"></minus><cn id="A3.T2.7.7.1.m1.1.1.3.3.2.cmml" type="integer" xref="A3.T2.7.7.1.m1.1.1.3.3.2">5</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.T2.7.7.1.m1.1c">1\times 10^{-5}</annotation><annotation encoding="application/x-llamapun" id="A3.T2.7.7.1.m1.1d">1 × 10 start_POSTSUPERSCRIPT - 5 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="A3.T2.8.8.2" style="padding-left:3.0pt;padding-right:3.0pt;"><math alttext="1\times 10^{-5}" class="ltx_Math" display="inline" id="A3.T2.8.8.2.m1.1"><semantics id="A3.T2.8.8.2.m1.1a"><mrow id="A3.T2.8.8.2.m1.1.1" xref="A3.T2.8.8.2.m1.1.1.cmml"><mn id="A3.T2.8.8.2.m1.1.1.2" xref="A3.T2.8.8.2.m1.1.1.2.cmml">1</mn><mo id="A3.T2.8.8.2.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="A3.T2.8.8.2.m1.1.1.1.cmml">×</mo><msup id="A3.T2.8.8.2.m1.1.1.3" xref="A3.T2.8.8.2.m1.1.1.3.cmml"><mn id="A3.T2.8.8.2.m1.1.1.3.2" xref="A3.T2.8.8.2.m1.1.1.3.2.cmml">10</mn><mrow id="A3.T2.8.8.2.m1.1.1.3.3" xref="A3.T2.8.8.2.m1.1.1.3.3.cmml"><mo id="A3.T2.8.8.2.m1.1.1.3.3a" xref="A3.T2.8.8.2.m1.1.1.3.3.cmml">−</mo><mn id="A3.T2.8.8.2.m1.1.1.3.3.2" xref="A3.T2.8.8.2.m1.1.1.3.3.2.cmml">5</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A3.T2.8.8.2.m1.1b"><apply id="A3.T2.8.8.2.m1.1.1.cmml" xref="A3.T2.8.8.2.m1.1.1"><times id="A3.T2.8.8.2.m1.1.1.1.cmml" xref="A3.T2.8.8.2.m1.1.1.1"></times><cn id="A3.T2.8.8.2.m1.1.1.2.cmml" type="integer" xref="A3.T2.8.8.2.m1.1.1.2">1</cn><apply id="A3.T2.8.8.2.m1.1.1.3.cmml" xref="A3.T2.8.8.2.m1.1.1.3"><csymbol cd="ambiguous" id="A3.T2.8.8.2.m1.1.1.3.1.cmml" xref="A3.T2.8.8.2.m1.1.1.3">superscript</csymbol><cn id="A3.T2.8.8.2.m1.1.1.3.2.cmml" type="integer" xref="A3.T2.8.8.2.m1.1.1.3.2">10</cn><apply id="A3.T2.8.8.2.m1.1.1.3.3.cmml" xref="A3.T2.8.8.2.m1.1.1.3.3"><minus id="A3.T2.8.8.2.m1.1.1.3.3.1.cmml" xref="A3.T2.8.8.2.m1.1.1.3.3"></minus><cn id="A3.T2.8.8.2.m1.1.1.3.3.2.cmml" type="integer" xref="A3.T2.8.8.2.m1.1.1.3.3.2">5</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.T2.8.8.2.m1.1c">1\times 10^{-5}</annotation><annotation encoding="application/x-llamapun" id="A3.T2.8.8.2.m1.1d">1 × 10 start_POSTSUPERSCRIPT - 5 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="A3.T2.9.9.3" style="padding-left:3.0pt;padding-right:3.0pt;"><math alttext="1\times 10^{-5}" class="ltx_Math" display="inline" id="A3.T2.9.9.3.m1.1"><semantics id="A3.T2.9.9.3.m1.1a"><mrow id="A3.T2.9.9.3.m1.1.1" xref="A3.T2.9.9.3.m1.1.1.cmml"><mn id="A3.T2.9.9.3.m1.1.1.2" xref="A3.T2.9.9.3.m1.1.1.2.cmml">1</mn><mo id="A3.T2.9.9.3.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="A3.T2.9.9.3.m1.1.1.1.cmml">×</mo><msup id="A3.T2.9.9.3.m1.1.1.3" xref="A3.T2.9.9.3.m1.1.1.3.cmml"><mn id="A3.T2.9.9.3.m1.1.1.3.2" xref="A3.T2.9.9.3.m1.1.1.3.2.cmml">10</mn><mrow id="A3.T2.9.9.3.m1.1.1.3.3" xref="A3.T2.9.9.3.m1.1.1.3.3.cmml"><mo id="A3.T2.9.9.3.m1.1.1.3.3a" xref="A3.T2.9.9.3.m1.1.1.3.3.cmml">−</mo><mn id="A3.T2.9.9.3.m1.1.1.3.3.2" xref="A3.T2.9.9.3.m1.1.1.3.3.2.cmml">5</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A3.T2.9.9.3.m1.1b"><apply id="A3.T2.9.9.3.m1.1.1.cmml" xref="A3.T2.9.9.3.m1.1.1"><times id="A3.T2.9.9.3.m1.1.1.1.cmml" xref="A3.T2.9.9.3.m1.1.1.1"></times><cn id="A3.T2.9.9.3.m1.1.1.2.cmml" type="integer" xref="A3.T2.9.9.3.m1.1.1.2">1</cn><apply id="A3.T2.9.9.3.m1.1.1.3.cmml" xref="A3.T2.9.9.3.m1.1.1.3"><csymbol cd="ambiguous" id="A3.T2.9.9.3.m1.1.1.3.1.cmml" xref="A3.T2.9.9.3.m1.1.1.3">superscript</csymbol><cn id="A3.T2.9.9.3.m1.1.1.3.2.cmml" type="integer" xref="A3.T2.9.9.3.m1.1.1.3.2">10</cn><apply id="A3.T2.9.9.3.m1.1.1.3.3.cmml" xref="A3.T2.9.9.3.m1.1.1.3.3"><minus id="A3.T2.9.9.3.m1.1.1.3.3.1.cmml" xref="A3.T2.9.9.3.m1.1.1.3.3"></minus><cn id="A3.T2.9.9.3.m1.1.1.3.3.2.cmml" type="integer" xref="A3.T2.9.9.3.m1.1.1.3.3.2">5</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.T2.9.9.3.m1.1c">1\times 10^{-5}</annotation><annotation encoding="application/x-llamapun" id="A3.T2.9.9.3.m1.1d">1 × 10 start_POSTSUPERSCRIPT - 5 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A3.T2.10.10">
<td class="ltx_td ltx_align_center" id="A3.T2.10.10.2" style="padding-left:3.0pt;padding-right:3.0pt;">Learning rate schedule</td>
<td class="ltx_td ltx_align_center" colspan="3" id="A3.T2.10.10.1" style="padding-left:3.0pt;padding-right:3.0pt;">Linear warmup (<math alttext="10^{4}" class="ltx_Math" display="inline" id="A3.T2.10.10.1.m1.1"><semantics id="A3.T2.10.10.1.m1.1a"><msup id="A3.T2.10.10.1.m1.1.1" xref="A3.T2.10.10.1.m1.1.1.cmml"><mn id="A3.T2.10.10.1.m1.1.1.2" xref="A3.T2.10.10.1.m1.1.1.2.cmml">10</mn><mn id="A3.T2.10.10.1.m1.1.1.3" xref="A3.T2.10.10.1.m1.1.1.3.cmml">4</mn></msup><annotation-xml encoding="MathML-Content" id="A3.T2.10.10.1.m1.1b"><apply id="A3.T2.10.10.1.m1.1.1.cmml" xref="A3.T2.10.10.1.m1.1.1"><csymbol cd="ambiguous" id="A3.T2.10.10.1.m1.1.1.1.cmml" xref="A3.T2.10.10.1.m1.1.1">superscript</csymbol><cn id="A3.T2.10.10.1.m1.1.1.2.cmml" type="integer" xref="A3.T2.10.10.1.m1.1.1.2">10</cn><cn id="A3.T2.10.10.1.m1.1.1.3.cmml" type="integer" xref="A3.T2.10.10.1.m1.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.T2.10.10.1.m1.1c">10^{4}</annotation><annotation encoding="application/x-llamapun" id="A3.T2.10.10.1.m1.1d">10 start_POSTSUPERSCRIPT 4 end_POSTSUPERSCRIPT</annotation></semantics></math> steps), constant, cosine decay</td>
</tr>
<tr class="ltx_tr" id="A3.T2.16.25">
<td class="ltx_td ltx_align_center" id="A3.T2.16.25.1" style="padding-left:3.0pt;padding-right:3.0pt;">Batch size</td>
<td class="ltx_td ltx_align_center" id="A3.T2.16.25.2" style="padding-left:3.0pt;padding-right:3.0pt;">4096</td>
<td class="ltx_td ltx_align_center" id="A3.T2.16.25.3" style="padding-left:3.0pt;padding-right:3.0pt;">64</td>
<td class="ltx_td ltx_align_center" id="A3.T2.16.25.4" style="padding-left:3.0pt;padding-right:3.0pt;">64</td>
</tr>
<tr class="ltx_tr" id="A3.T2.14.14">
<td class="ltx_td ltx_align_center" id="A3.T2.11.11.1" style="padding-left:3.0pt;padding-right:3.0pt;"><math alttext="\phi(\cdot)" class="ltx_Math" display="inline" id="A3.T2.11.11.1.m1.1"><semantics id="A3.T2.11.11.1.m1.1a"><mrow id="A3.T2.11.11.1.m1.1.2" xref="A3.T2.11.11.1.m1.1.2.cmml"><mi id="A3.T2.11.11.1.m1.1.2.2" xref="A3.T2.11.11.1.m1.1.2.2.cmml">ϕ</mi><mo id="A3.T2.11.11.1.m1.1.2.1" xref="A3.T2.11.11.1.m1.1.2.1.cmml">⁢</mo><mrow id="A3.T2.11.11.1.m1.1.2.3.2" xref="A3.T2.11.11.1.m1.1.2.cmml"><mo id="A3.T2.11.11.1.m1.1.2.3.2.1" stretchy="false" xref="A3.T2.11.11.1.m1.1.2.cmml">(</mo><mo id="A3.T2.11.11.1.m1.1.1" lspace="0em" rspace="0em" xref="A3.T2.11.11.1.m1.1.1.cmml">⋅</mo><mo id="A3.T2.11.11.1.m1.1.2.3.2.2" stretchy="false" xref="A3.T2.11.11.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.T2.11.11.1.m1.1b"><apply id="A3.T2.11.11.1.m1.1.2.cmml" xref="A3.T2.11.11.1.m1.1.2"><times id="A3.T2.11.11.1.m1.1.2.1.cmml" xref="A3.T2.11.11.1.m1.1.2.1"></times><ci id="A3.T2.11.11.1.m1.1.2.2.cmml" xref="A3.T2.11.11.1.m1.1.2.2">italic-ϕ</ci><ci id="A3.T2.11.11.1.m1.1.1.cmml" xref="A3.T2.11.11.1.m1.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.T2.11.11.1.m1.1c">\phi(\cdot)</annotation><annotation encoding="application/x-llamapun" id="A3.T2.11.11.1.m1.1d">italic_ϕ ( ⋅ )</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="A3.T2.12.12.2" style="padding-left:3.0pt;padding-right:3.0pt;"><math alttext="\textrm{ReLU}(\cdot)" class="ltx_Math" display="inline" id="A3.T2.12.12.2.m1.1"><semantics id="A3.T2.12.12.2.m1.1a"><mrow id="A3.T2.12.12.2.m1.1.2" xref="A3.T2.12.12.2.m1.1.2.cmml"><mtext id="A3.T2.12.12.2.m1.1.2.2" xref="A3.T2.12.12.2.m1.1.2.2a.cmml">ReLU</mtext><mo id="A3.T2.12.12.2.m1.1.2.1" xref="A3.T2.12.12.2.m1.1.2.1.cmml">⁢</mo><mrow id="A3.T2.12.12.2.m1.1.2.3.2" xref="A3.T2.12.12.2.m1.1.2.cmml"><mo id="A3.T2.12.12.2.m1.1.2.3.2.1" stretchy="false" xref="A3.T2.12.12.2.m1.1.2.cmml">(</mo><mo id="A3.T2.12.12.2.m1.1.1" lspace="0em" rspace="0em" xref="A3.T2.12.12.2.m1.1.1.cmml">⋅</mo><mo id="A3.T2.12.12.2.m1.1.2.3.2.2" stretchy="false" xref="A3.T2.12.12.2.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.T2.12.12.2.m1.1b"><apply id="A3.T2.12.12.2.m1.1.2.cmml" xref="A3.T2.12.12.2.m1.1.2"><times id="A3.T2.12.12.2.m1.1.2.1.cmml" xref="A3.T2.12.12.2.m1.1.2.1"></times><ci id="A3.T2.12.12.2.m1.1.2.2a.cmml" xref="A3.T2.12.12.2.m1.1.2.2"><mtext id="A3.T2.12.12.2.m1.1.2.2.cmml" xref="A3.T2.12.12.2.m1.1.2.2">ReLU</mtext></ci><ci id="A3.T2.12.12.2.m1.1.1.cmml" xref="A3.T2.12.12.2.m1.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.T2.12.12.2.m1.1c">\textrm{ReLU}(\cdot)</annotation><annotation encoding="application/x-llamapun" id="A3.T2.12.12.2.m1.1d">ReLU ( ⋅ )</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="A3.T2.13.13.3" style="padding-left:3.0pt;padding-right:3.0pt;"><math alttext="\textrm{ReLU}(\cdot)" class="ltx_Math" display="inline" id="A3.T2.13.13.3.m1.1"><semantics id="A3.T2.13.13.3.m1.1a"><mrow id="A3.T2.13.13.3.m1.1.2" xref="A3.T2.13.13.3.m1.1.2.cmml"><mtext id="A3.T2.13.13.3.m1.1.2.2" xref="A3.T2.13.13.3.m1.1.2.2a.cmml">ReLU</mtext><mo id="A3.T2.13.13.3.m1.1.2.1" xref="A3.T2.13.13.3.m1.1.2.1.cmml">⁢</mo><mrow id="A3.T2.13.13.3.m1.1.2.3.2" xref="A3.T2.13.13.3.m1.1.2.cmml"><mo id="A3.T2.13.13.3.m1.1.2.3.2.1" stretchy="false" xref="A3.T2.13.13.3.m1.1.2.cmml">(</mo><mo id="A3.T2.13.13.3.m1.1.1" lspace="0em" rspace="0em" xref="A3.T2.13.13.3.m1.1.1.cmml">⋅</mo><mo id="A3.T2.13.13.3.m1.1.2.3.2.2" stretchy="false" xref="A3.T2.13.13.3.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.T2.13.13.3.m1.1b"><apply id="A3.T2.13.13.3.m1.1.2.cmml" xref="A3.T2.13.13.3.m1.1.2"><times id="A3.T2.13.13.3.m1.1.2.1.cmml" xref="A3.T2.13.13.3.m1.1.2.1"></times><ci id="A3.T2.13.13.3.m1.1.2.2a.cmml" xref="A3.T2.13.13.3.m1.1.2.2"><mtext id="A3.T2.13.13.3.m1.1.2.2.cmml" xref="A3.T2.13.13.3.m1.1.2.2">ReLU</mtext></ci><ci id="A3.T2.13.13.3.m1.1.1.cmml" xref="A3.T2.13.13.3.m1.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.T2.13.13.3.m1.1c">\textrm{ReLU}(\cdot)</annotation><annotation encoding="application/x-llamapun" id="A3.T2.13.13.3.m1.1d">ReLU ( ⋅ )</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="A3.T2.14.14.4" style="padding-left:3.0pt;padding-right:3.0pt;"><math alttext="\textrm{ReLU}(\cdot)" class="ltx_Math" display="inline" id="A3.T2.14.14.4.m1.1"><semantics id="A3.T2.14.14.4.m1.1a"><mrow id="A3.T2.14.14.4.m1.1.2" xref="A3.T2.14.14.4.m1.1.2.cmml"><mtext id="A3.T2.14.14.4.m1.1.2.2" xref="A3.T2.14.14.4.m1.1.2.2a.cmml">ReLU</mtext><mo id="A3.T2.14.14.4.m1.1.2.1" xref="A3.T2.14.14.4.m1.1.2.1.cmml">⁢</mo><mrow id="A3.T2.14.14.4.m1.1.2.3.2" xref="A3.T2.14.14.4.m1.1.2.cmml"><mo id="A3.T2.14.14.4.m1.1.2.3.2.1" stretchy="false" xref="A3.T2.14.14.4.m1.1.2.cmml">(</mo><mo id="A3.T2.14.14.4.m1.1.1" lspace="0em" rspace="0em" xref="A3.T2.14.14.4.m1.1.1.cmml">⋅</mo><mo id="A3.T2.14.14.4.m1.1.2.3.2.2" stretchy="false" xref="A3.T2.14.14.4.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.T2.14.14.4.m1.1b"><apply id="A3.T2.14.14.4.m1.1.2.cmml" xref="A3.T2.14.14.4.m1.1.2"><times id="A3.T2.14.14.4.m1.1.2.1.cmml" xref="A3.T2.14.14.4.m1.1.2.1"></times><ci id="A3.T2.14.14.4.m1.1.2.2a.cmml" xref="A3.T2.14.14.4.m1.1.2.2"><mtext id="A3.T2.14.14.4.m1.1.2.2.cmml" xref="A3.T2.14.14.4.m1.1.2.2">ReLU</mtext></ci><ci id="A3.T2.14.14.4.m1.1.1.cmml" xref="A3.T2.14.14.4.m1.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.T2.14.14.4.m1.1c">\textrm{ReLU}(\cdot)</annotation><annotation encoding="application/x-llamapun" id="A3.T2.14.14.4.m1.1d">ReLU ( ⋅ )</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A3.T2.16.26">
<td class="ltx_td ltx_align_center" id="A3.T2.16.26.1" style="padding-left:3.0pt;padding-right:3.0pt;">Pretrained?</td>
<td class="ltx_td ltx_align_center" id="A3.T2.16.26.2" style="padding-left:3.0pt;padding-right:3.0pt;">✗</td>
<td class="ltx_td ltx_align_center" id="A3.T2.16.26.3" style="padding-left:3.0pt;padding-right:3.0pt;">✓</td>
<td class="ltx_td ltx_align_center" id="A3.T2.16.26.4" style="padding-left:3.0pt;padding-right:3.0pt;">✓</td>
</tr>
<tr class="ltx_tr" id="A3.T2.16.27">
<td class="ltx_td ltx_align_center" id="A3.T2.16.27.1" style="padding-left:3.0pt;padding-right:3.0pt;">Num. walks</td>
<td class="ltx_td ltx_align_center" id="A3.T2.16.27.2" style="padding-left:3.0pt;padding-right:3.0pt;">100</td>
<td class="ltx_td ltx_align_center" id="A3.T2.16.27.3" style="padding-left:3.0pt;padding-right:3.0pt;">20</td>
<td class="ltx_td ltx_align_center" id="A3.T2.16.27.4" style="padding-left:3.0pt;padding-right:3.0pt;">20</td>
</tr>
<tr class="ltx_tr" id="A3.T2.15.15">
<td class="ltx_td ltx_align_center" id="A3.T2.15.15.1" style="padding-left:3.0pt;padding-right:3.0pt;"><math alttext="p_{\textrm{halt}}" class="ltx_Math" display="inline" id="A3.T2.15.15.1.m1.1"><semantics id="A3.T2.15.15.1.m1.1a"><msub id="A3.T2.15.15.1.m1.1.1" xref="A3.T2.15.15.1.m1.1.1.cmml"><mi id="A3.T2.15.15.1.m1.1.1.2" xref="A3.T2.15.15.1.m1.1.1.2.cmml">p</mi><mtext id="A3.T2.15.15.1.m1.1.1.3" xref="A3.T2.15.15.1.m1.1.1.3a.cmml">halt</mtext></msub><annotation-xml encoding="MathML-Content" id="A3.T2.15.15.1.m1.1b"><apply id="A3.T2.15.15.1.m1.1.1.cmml" xref="A3.T2.15.15.1.m1.1.1"><csymbol cd="ambiguous" id="A3.T2.15.15.1.m1.1.1.1.cmml" xref="A3.T2.15.15.1.m1.1.1">subscript</csymbol><ci id="A3.T2.15.15.1.m1.1.1.2.cmml" xref="A3.T2.15.15.1.m1.1.1.2">𝑝</ci><ci id="A3.T2.15.15.1.m1.1.1.3a.cmml" xref="A3.T2.15.15.1.m1.1.1.3"><mtext id="A3.T2.15.15.1.m1.1.1.3.cmml" mathsize="70%" xref="A3.T2.15.15.1.m1.1.1.3">halt</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.T2.15.15.1.m1.1c">p_{\textrm{halt}}</annotation><annotation encoding="application/x-llamapun" id="A3.T2.15.15.1.m1.1d">italic_p start_POSTSUBSCRIPT halt end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="A3.T2.15.15.2" style="padding-left:3.0pt;padding-right:3.0pt;">0.1</td>
<td class="ltx_td ltx_align_center" id="A3.T2.15.15.3" style="padding-left:3.0pt;padding-right:3.0pt;">0.1</td>
<td class="ltx_td ltx_align_center" id="A3.T2.15.15.4" style="padding-left:3.0pt;padding-right:3.0pt;">0.1</td>
</tr>
<tr class="ltx_tr" id="A3.T2.16.16">
<td class="ltx_td ltx_align_center ltx_border_bb" id="A3.T2.16.16.1" style="padding-left:3.0pt;padding-right:3.0pt;">Max. walk length (<math alttext="i_{\textrm{max}}" class="ltx_Math" display="inline" id="A3.T2.16.16.1.m1.1"><semantics id="A3.T2.16.16.1.m1.1a"><msub id="A3.T2.16.16.1.m1.1.1" xref="A3.T2.16.16.1.m1.1.1.cmml"><mi id="A3.T2.16.16.1.m1.1.1.2" xref="A3.T2.16.16.1.m1.1.1.2.cmml">i</mi><mtext id="A3.T2.16.16.1.m1.1.1.3" xref="A3.T2.16.16.1.m1.1.1.3a.cmml">max</mtext></msub><annotation-xml encoding="MathML-Content" id="A3.T2.16.16.1.m1.1b"><apply id="A3.T2.16.16.1.m1.1.1.cmml" xref="A3.T2.16.16.1.m1.1.1"><csymbol cd="ambiguous" id="A3.T2.16.16.1.m1.1.1.1.cmml" xref="A3.T2.16.16.1.m1.1.1">subscript</csymbol><ci id="A3.T2.16.16.1.m1.1.1.2.cmml" xref="A3.T2.16.16.1.m1.1.1.2">𝑖</ci><ci id="A3.T2.16.16.1.m1.1.1.3a.cmml" xref="A3.T2.16.16.1.m1.1.1.3"><mtext id="A3.T2.16.16.1.m1.1.1.3.cmml" mathsize="70%" xref="A3.T2.16.16.1.m1.1.1.3">max</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.T2.16.16.1.m1.1c">i_{\textrm{max}}</annotation><annotation encoding="application/x-llamapun" id="A3.T2.16.16.1.m1.1d">italic_i start_POSTSUBSCRIPT max end_POSTSUBSCRIPT</annotation></semantics></math>)</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A3.T2.16.16.2" style="padding-left:3.0pt;padding-right:3.0pt;">100</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A3.T2.16.16.3" style="padding-left:3.0pt;padding-right:3.0pt;">10</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A3.T2.16.16.4" style="padding-left:3.0pt;padding-right:3.0pt;">10</td>
</tr>
</tbody></table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 2: </span>Architecture, hyperparameters and training details for ViT experiments.
</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</section>
<section class="ltx_subsection" id="A3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">C.2 </span>ViT ablations</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="A3.SS2.p1">
<p class="ltx_p" id="A3.SS2.p1.1">Here, we run extra experiments to further evidence the findings reported in the main text. Unless explicitly stated, architectures and training details are as reported in Table <a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#A3.T2" title="Table 2 ‣ C.1 Architectures, hyperparameters and training details ‣ Appendix C Further experiments and details ‣ Linear Transformer Topological Masking with Graph Random Features"><span class="ltx_text ltx_ref_tag">2</span></a>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="A3.SS2.p2">
<p class="ltx_p" id="A3.SS2.p2.8"><span class="ltx_text ltx_font_bold" id="A3.SS2.p2.1.1">Number of walkers <math alttext="n" class="ltx_Math" display="inline" id="A3.SS2.p2.1.1.m1.1"><semantics id="A3.SS2.p2.1.1.m1.1a"><mi id="A3.SS2.p2.1.1.m1.1.1" xref="A3.SS2.p2.1.1.m1.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="A3.SS2.p2.1.1.m1.1b"><ci id="A3.SS2.p2.1.1.m1.1.1.cmml" xref="A3.SS2.p2.1.1.m1.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.SS2.p2.1.1.m1.1c">n</annotation><annotation encoding="application/x-llamapun" id="A3.SS2.p2.1.1.m1.1d">italic_n</annotation></semantics></math>.</span>
We construct GRFs using <math alttext="\{1,10,100,1000\}" class="ltx_Math" display="inline" id="A3.SS2.p2.2.m1.4"><semantics id="A3.SS2.p2.2.m1.4a"><mrow id="A3.SS2.p2.2.m1.4.5.2" xref="A3.SS2.p2.2.m1.4.5.1.cmml"><mo id="A3.SS2.p2.2.m1.4.5.2.1" stretchy="false" xref="A3.SS2.p2.2.m1.4.5.1.cmml">{</mo><mn id="A3.SS2.p2.2.m1.1.1" xref="A3.SS2.p2.2.m1.1.1.cmml">1</mn><mo id="A3.SS2.p2.2.m1.4.5.2.2" xref="A3.SS2.p2.2.m1.4.5.1.cmml">,</mo><mn id="A3.SS2.p2.2.m1.2.2" xref="A3.SS2.p2.2.m1.2.2.cmml">10</mn><mo id="A3.SS2.p2.2.m1.4.5.2.3" xref="A3.SS2.p2.2.m1.4.5.1.cmml">,</mo><mn id="A3.SS2.p2.2.m1.3.3" xref="A3.SS2.p2.2.m1.3.3.cmml">100</mn><mo id="A3.SS2.p2.2.m1.4.5.2.4" xref="A3.SS2.p2.2.m1.4.5.1.cmml">,</mo><mn id="A3.SS2.p2.2.m1.4.4" xref="A3.SS2.p2.2.m1.4.4.cmml">1000</mn><mo id="A3.SS2.p2.2.m1.4.5.2.5" stretchy="false" xref="A3.SS2.p2.2.m1.4.5.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="A3.SS2.p2.2.m1.4b"><set id="A3.SS2.p2.2.m1.4.5.1.cmml" xref="A3.SS2.p2.2.m1.4.5.2"><cn id="A3.SS2.p2.2.m1.1.1.cmml" type="integer" xref="A3.SS2.p2.2.m1.1.1">1</cn><cn id="A3.SS2.p2.2.m1.2.2.cmml" type="integer" xref="A3.SS2.p2.2.m1.2.2">10</cn><cn id="A3.SS2.p2.2.m1.3.3.cmml" type="integer" xref="A3.SS2.p2.2.m1.3.3">100</cn><cn id="A3.SS2.p2.2.m1.4.4.cmml" type="integer" xref="A3.SS2.p2.2.m1.4.4">1000</cn></set></annotation-xml><annotation encoding="application/x-tex" id="A3.SS2.p2.2.m1.4c">\{1,10,100,1000\}</annotation><annotation encoding="application/x-llamapun" id="A3.SS2.p2.2.m1.4d">{ 1 , 10 , 100 , 1000 }</annotation></semantics></math> walkers with a termination probability <math alttext="p_{\textrm{halt}}=0.5" class="ltx_Math" display="inline" id="A3.SS2.p2.3.m2.1"><semantics id="A3.SS2.p2.3.m2.1a"><mrow id="A3.SS2.p2.3.m2.1.1" xref="A3.SS2.p2.3.m2.1.1.cmml"><msub id="A3.SS2.p2.3.m2.1.1.2" xref="A3.SS2.p2.3.m2.1.1.2.cmml"><mi id="A3.SS2.p2.3.m2.1.1.2.2" xref="A3.SS2.p2.3.m2.1.1.2.2.cmml">p</mi><mtext id="A3.SS2.p2.3.m2.1.1.2.3" xref="A3.SS2.p2.3.m2.1.1.2.3a.cmml">halt</mtext></msub><mo id="A3.SS2.p2.3.m2.1.1.1" xref="A3.SS2.p2.3.m2.1.1.1.cmml">=</mo><mn id="A3.SS2.p2.3.m2.1.1.3" xref="A3.SS2.p2.3.m2.1.1.3.cmml">0.5</mn></mrow><annotation-xml encoding="MathML-Content" id="A3.SS2.p2.3.m2.1b"><apply id="A3.SS2.p2.3.m2.1.1.cmml" xref="A3.SS2.p2.3.m2.1.1"><eq id="A3.SS2.p2.3.m2.1.1.1.cmml" xref="A3.SS2.p2.3.m2.1.1.1"></eq><apply id="A3.SS2.p2.3.m2.1.1.2.cmml" xref="A3.SS2.p2.3.m2.1.1.2"><csymbol cd="ambiguous" id="A3.SS2.p2.3.m2.1.1.2.1.cmml" xref="A3.SS2.p2.3.m2.1.1.2">subscript</csymbol><ci id="A3.SS2.p2.3.m2.1.1.2.2.cmml" xref="A3.SS2.p2.3.m2.1.1.2.2">𝑝</ci><ci id="A3.SS2.p2.3.m2.1.1.2.3a.cmml" xref="A3.SS2.p2.3.m2.1.1.2.3"><mtext id="A3.SS2.p2.3.m2.1.1.2.3.cmml" mathsize="70%" xref="A3.SS2.p2.3.m2.1.1.2.3">halt</mtext></ci></apply><cn id="A3.SS2.p2.3.m2.1.1.3.cmml" type="float" xref="A3.SS2.p2.3.m2.1.1.3">0.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS2.p2.3.m2.1c">p_{\textrm{halt}}=0.5</annotation><annotation encoding="application/x-llamapun" id="A3.SS2.p2.3.m2.1d">italic_p start_POSTSUBSCRIPT halt end_POSTSUBSCRIPT = 0.5</annotation></semantics></math>, retraining from scratch using the respective topological masks.
See Fig.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#A3.F6" title="Figure 6 ‣ C.2 ViT ablations ‣ Appendix C Further experiments and details ‣ Linear Transformer Topological Masking with Graph Random Features"><span class="ltx_text ltx_ref_tag">6</span></a>.
Larger <math alttext="n" class="ltx_Math" display="inline" id="A3.SS2.p2.4.m3.1"><semantics id="A3.SS2.p2.4.m3.1a"><mi id="A3.SS2.p2.4.m3.1.1" xref="A3.SS2.p2.4.m3.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="A3.SS2.p2.4.m3.1b"><ci id="A3.SS2.p2.4.m3.1.1.cmml" xref="A3.SS2.p2.4.m3.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.SS2.p2.4.m3.1c">n</annotation><annotation encoding="application/x-llamapun" id="A3.SS2.p2.4.m3.1d">italic_n</annotation></semantics></math> reduces the mask variance and improves predictive performance, but also makes the features <math alttext="\{\widehat{\phi}_{\mathcal{G}}(v_{i})\}_{v_{i}\in\mathcal{N}}" class="ltx_Math" display="inline" id="A3.SS2.p2.5.m4.1"><semantics id="A3.SS2.p2.5.m4.1a"><msub id="A3.SS2.p2.5.m4.1.1" xref="A3.SS2.p2.5.m4.1.1.cmml"><mrow id="A3.SS2.p2.5.m4.1.1.1.1" xref="A3.SS2.p2.5.m4.1.1.1.2.cmml"><mo id="A3.SS2.p2.5.m4.1.1.1.1.2" stretchy="false" xref="A3.SS2.p2.5.m4.1.1.1.2.cmml">{</mo><mrow id="A3.SS2.p2.5.m4.1.1.1.1.1" xref="A3.SS2.p2.5.m4.1.1.1.1.1.cmml"><msub id="A3.SS2.p2.5.m4.1.1.1.1.1.3" xref="A3.SS2.p2.5.m4.1.1.1.1.1.3.cmml"><mover accent="true" id="A3.SS2.p2.5.m4.1.1.1.1.1.3.2" xref="A3.SS2.p2.5.m4.1.1.1.1.1.3.2.cmml"><mi id="A3.SS2.p2.5.m4.1.1.1.1.1.3.2.2" xref="A3.SS2.p2.5.m4.1.1.1.1.1.3.2.2.cmml">ϕ</mi><mo id="A3.SS2.p2.5.m4.1.1.1.1.1.3.2.1" xref="A3.SS2.p2.5.m4.1.1.1.1.1.3.2.1.cmml">^</mo></mover><mi class="ltx_font_mathcaligraphic" id="A3.SS2.p2.5.m4.1.1.1.1.1.3.3" xref="A3.SS2.p2.5.m4.1.1.1.1.1.3.3.cmml">𝒢</mi></msub><mo id="A3.SS2.p2.5.m4.1.1.1.1.1.2" xref="A3.SS2.p2.5.m4.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A3.SS2.p2.5.m4.1.1.1.1.1.1.1" xref="A3.SS2.p2.5.m4.1.1.1.1.1.1.1.1.cmml"><mo id="A3.SS2.p2.5.m4.1.1.1.1.1.1.1.2" stretchy="false" xref="A3.SS2.p2.5.m4.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="A3.SS2.p2.5.m4.1.1.1.1.1.1.1.1" xref="A3.SS2.p2.5.m4.1.1.1.1.1.1.1.1.cmml"><mi id="A3.SS2.p2.5.m4.1.1.1.1.1.1.1.1.2" xref="A3.SS2.p2.5.m4.1.1.1.1.1.1.1.1.2.cmml">v</mi><mi id="A3.SS2.p2.5.m4.1.1.1.1.1.1.1.1.3" xref="A3.SS2.p2.5.m4.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="A3.SS2.p2.5.m4.1.1.1.1.1.1.1.3" stretchy="false" xref="A3.SS2.p2.5.m4.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A3.SS2.p2.5.m4.1.1.1.1.3" stretchy="false" xref="A3.SS2.p2.5.m4.1.1.1.2.cmml">}</mo></mrow><mrow id="A3.SS2.p2.5.m4.1.1.3" xref="A3.SS2.p2.5.m4.1.1.3.cmml"><msub id="A3.SS2.p2.5.m4.1.1.3.2" xref="A3.SS2.p2.5.m4.1.1.3.2.cmml"><mi id="A3.SS2.p2.5.m4.1.1.3.2.2" xref="A3.SS2.p2.5.m4.1.1.3.2.2.cmml">v</mi><mi id="A3.SS2.p2.5.m4.1.1.3.2.3" xref="A3.SS2.p2.5.m4.1.1.3.2.3.cmml">i</mi></msub><mo id="A3.SS2.p2.5.m4.1.1.3.1" xref="A3.SS2.p2.5.m4.1.1.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="A3.SS2.p2.5.m4.1.1.3.3" xref="A3.SS2.p2.5.m4.1.1.3.3.cmml">𝒩</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="A3.SS2.p2.5.m4.1b"><apply id="A3.SS2.p2.5.m4.1.1.cmml" xref="A3.SS2.p2.5.m4.1.1"><csymbol cd="ambiguous" id="A3.SS2.p2.5.m4.1.1.2.cmml" xref="A3.SS2.p2.5.m4.1.1">subscript</csymbol><set id="A3.SS2.p2.5.m4.1.1.1.2.cmml" xref="A3.SS2.p2.5.m4.1.1.1.1"><apply id="A3.SS2.p2.5.m4.1.1.1.1.1.cmml" xref="A3.SS2.p2.5.m4.1.1.1.1.1"><times id="A3.SS2.p2.5.m4.1.1.1.1.1.2.cmml" xref="A3.SS2.p2.5.m4.1.1.1.1.1.2"></times><apply id="A3.SS2.p2.5.m4.1.1.1.1.1.3.cmml" xref="A3.SS2.p2.5.m4.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A3.SS2.p2.5.m4.1.1.1.1.1.3.1.cmml" xref="A3.SS2.p2.5.m4.1.1.1.1.1.3">subscript</csymbol><apply id="A3.SS2.p2.5.m4.1.1.1.1.1.3.2.cmml" xref="A3.SS2.p2.5.m4.1.1.1.1.1.3.2"><ci id="A3.SS2.p2.5.m4.1.1.1.1.1.3.2.1.cmml" xref="A3.SS2.p2.5.m4.1.1.1.1.1.3.2.1">^</ci><ci id="A3.SS2.p2.5.m4.1.1.1.1.1.3.2.2.cmml" xref="A3.SS2.p2.5.m4.1.1.1.1.1.3.2.2">italic-ϕ</ci></apply><ci id="A3.SS2.p2.5.m4.1.1.1.1.1.3.3.cmml" xref="A3.SS2.p2.5.m4.1.1.1.1.1.3.3">𝒢</ci></apply><apply id="A3.SS2.p2.5.m4.1.1.1.1.1.1.1.1.cmml" xref="A3.SS2.p2.5.m4.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A3.SS2.p2.5.m4.1.1.1.1.1.1.1.1.1.cmml" xref="A3.SS2.p2.5.m4.1.1.1.1.1.1.1">subscript</csymbol><ci id="A3.SS2.p2.5.m4.1.1.1.1.1.1.1.1.2.cmml" xref="A3.SS2.p2.5.m4.1.1.1.1.1.1.1.1.2">𝑣</ci><ci id="A3.SS2.p2.5.m4.1.1.1.1.1.1.1.1.3.cmml" xref="A3.SS2.p2.5.m4.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply></set><apply id="A3.SS2.p2.5.m4.1.1.3.cmml" xref="A3.SS2.p2.5.m4.1.1.3"><in id="A3.SS2.p2.5.m4.1.1.3.1.cmml" xref="A3.SS2.p2.5.m4.1.1.3.1"></in><apply id="A3.SS2.p2.5.m4.1.1.3.2.cmml" xref="A3.SS2.p2.5.m4.1.1.3.2"><csymbol cd="ambiguous" id="A3.SS2.p2.5.m4.1.1.3.2.1.cmml" xref="A3.SS2.p2.5.m4.1.1.3.2">subscript</csymbol><ci id="A3.SS2.p2.5.m4.1.1.3.2.2.cmml" xref="A3.SS2.p2.5.m4.1.1.3.2.2">𝑣</ci><ci id="A3.SS2.p2.5.m4.1.1.3.2.3.cmml" xref="A3.SS2.p2.5.m4.1.1.3.2.3">𝑖</ci></apply><ci id="A3.SS2.p2.5.m4.1.1.3.3.cmml" xref="A3.SS2.p2.5.m4.1.1.3.3">𝒩</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS2.p2.5.m4.1c">\{\widehat{\phi}_{\mathcal{G}}(v_{i})\}_{v_{i}\in\mathcal{N}}</annotation><annotation encoding="application/x-llamapun" id="A3.SS2.p2.5.m4.1d">{ over^ start_ARG italic_ϕ end_ARG start_POSTSUBSCRIPT caligraphic_G end_POSTSUBSCRIPT ( italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) } start_POSTSUBSCRIPT italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∈ caligraphic_N end_POSTSUBSCRIPT</annotation></semantics></math> less sparse so increases computational cost.
Since the estimator is unbiased, the <math alttext="n\to\infty" class="ltx_Math" display="inline" id="A3.SS2.p2.6.m5.1"><semantics id="A3.SS2.p2.6.m5.1a"><mrow id="A3.SS2.p2.6.m5.1.1" xref="A3.SS2.p2.6.m5.1.1.cmml"><mi id="A3.SS2.p2.6.m5.1.1.2" xref="A3.SS2.p2.6.m5.1.1.2.cmml">n</mi><mo id="A3.SS2.p2.6.m5.1.1.1" stretchy="false" xref="A3.SS2.p2.6.m5.1.1.1.cmml">→</mo><mi id="A3.SS2.p2.6.m5.1.1.3" mathvariant="normal" xref="A3.SS2.p2.6.m5.1.1.3.cmml">∞</mi></mrow><annotation-xml encoding="MathML-Content" id="A3.SS2.p2.6.m5.1b"><apply id="A3.SS2.p2.6.m5.1.1.cmml" xref="A3.SS2.p2.6.m5.1.1"><ci id="A3.SS2.p2.6.m5.1.1.1.cmml" xref="A3.SS2.p2.6.m5.1.1.1">→</ci><ci id="A3.SS2.p2.6.m5.1.1.2.cmml" xref="A3.SS2.p2.6.m5.1.1.2">𝑛</ci><infinity id="A3.SS2.p2.6.m5.1.1.3.cmml" xref="A3.SS2.p2.6.m5.1.1.3"></infinity></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS2.p2.6.m5.1c">n\to\infty</annotation><annotation encoding="application/x-llamapun" id="A3.SS2.p2.6.m5.1d">italic_n → ∞</annotation></semantics></math> limit gives dense features <math alttext="\{{\phi}_{\mathcal{G}}(v_{i})\}_{v_{i}\in\mathcal{N}}" class="ltx_Math" display="inline" id="A3.SS2.p2.7.m6.1"><semantics id="A3.SS2.p2.7.m6.1a"><msub id="A3.SS2.p2.7.m6.1.1" xref="A3.SS2.p2.7.m6.1.1.cmml"><mrow id="A3.SS2.p2.7.m6.1.1.1.1" xref="A3.SS2.p2.7.m6.1.1.1.2.cmml"><mo id="A3.SS2.p2.7.m6.1.1.1.1.2" stretchy="false" xref="A3.SS2.p2.7.m6.1.1.1.2.cmml">{</mo><mrow id="A3.SS2.p2.7.m6.1.1.1.1.1" xref="A3.SS2.p2.7.m6.1.1.1.1.1.cmml"><msub id="A3.SS2.p2.7.m6.1.1.1.1.1.3" xref="A3.SS2.p2.7.m6.1.1.1.1.1.3.cmml"><mi id="A3.SS2.p2.7.m6.1.1.1.1.1.3.2" xref="A3.SS2.p2.7.m6.1.1.1.1.1.3.2.cmml">ϕ</mi><mi class="ltx_font_mathcaligraphic" id="A3.SS2.p2.7.m6.1.1.1.1.1.3.3" xref="A3.SS2.p2.7.m6.1.1.1.1.1.3.3.cmml">𝒢</mi></msub><mo id="A3.SS2.p2.7.m6.1.1.1.1.1.2" xref="A3.SS2.p2.7.m6.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A3.SS2.p2.7.m6.1.1.1.1.1.1.1" xref="A3.SS2.p2.7.m6.1.1.1.1.1.1.1.1.cmml"><mo id="A3.SS2.p2.7.m6.1.1.1.1.1.1.1.2" stretchy="false" xref="A3.SS2.p2.7.m6.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="A3.SS2.p2.7.m6.1.1.1.1.1.1.1.1" xref="A3.SS2.p2.7.m6.1.1.1.1.1.1.1.1.cmml"><mi id="A3.SS2.p2.7.m6.1.1.1.1.1.1.1.1.2" xref="A3.SS2.p2.7.m6.1.1.1.1.1.1.1.1.2.cmml">v</mi><mi id="A3.SS2.p2.7.m6.1.1.1.1.1.1.1.1.3" xref="A3.SS2.p2.7.m6.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="A3.SS2.p2.7.m6.1.1.1.1.1.1.1.3" stretchy="false" xref="A3.SS2.p2.7.m6.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A3.SS2.p2.7.m6.1.1.1.1.3" stretchy="false" xref="A3.SS2.p2.7.m6.1.1.1.2.cmml">}</mo></mrow><mrow id="A3.SS2.p2.7.m6.1.1.3" xref="A3.SS2.p2.7.m6.1.1.3.cmml"><msub id="A3.SS2.p2.7.m6.1.1.3.2" xref="A3.SS2.p2.7.m6.1.1.3.2.cmml"><mi id="A3.SS2.p2.7.m6.1.1.3.2.2" xref="A3.SS2.p2.7.m6.1.1.3.2.2.cmml">v</mi><mi id="A3.SS2.p2.7.m6.1.1.3.2.3" xref="A3.SS2.p2.7.m6.1.1.3.2.3.cmml">i</mi></msub><mo id="A3.SS2.p2.7.m6.1.1.3.1" xref="A3.SS2.p2.7.m6.1.1.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="A3.SS2.p2.7.m6.1.1.3.3" xref="A3.SS2.p2.7.m6.1.1.3.3.cmml">𝒩</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="A3.SS2.p2.7.m6.1b"><apply id="A3.SS2.p2.7.m6.1.1.cmml" xref="A3.SS2.p2.7.m6.1.1"><csymbol cd="ambiguous" id="A3.SS2.p2.7.m6.1.1.2.cmml" xref="A3.SS2.p2.7.m6.1.1">subscript</csymbol><set id="A3.SS2.p2.7.m6.1.1.1.2.cmml" xref="A3.SS2.p2.7.m6.1.1.1.1"><apply id="A3.SS2.p2.7.m6.1.1.1.1.1.cmml" xref="A3.SS2.p2.7.m6.1.1.1.1.1"><times id="A3.SS2.p2.7.m6.1.1.1.1.1.2.cmml" xref="A3.SS2.p2.7.m6.1.1.1.1.1.2"></times><apply id="A3.SS2.p2.7.m6.1.1.1.1.1.3.cmml" xref="A3.SS2.p2.7.m6.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A3.SS2.p2.7.m6.1.1.1.1.1.3.1.cmml" xref="A3.SS2.p2.7.m6.1.1.1.1.1.3">subscript</csymbol><ci id="A3.SS2.p2.7.m6.1.1.1.1.1.3.2.cmml" xref="A3.SS2.p2.7.m6.1.1.1.1.1.3.2">italic-ϕ</ci><ci id="A3.SS2.p2.7.m6.1.1.1.1.1.3.3.cmml" xref="A3.SS2.p2.7.m6.1.1.1.1.1.3.3">𝒢</ci></apply><apply id="A3.SS2.p2.7.m6.1.1.1.1.1.1.1.1.cmml" xref="A3.SS2.p2.7.m6.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A3.SS2.p2.7.m6.1.1.1.1.1.1.1.1.1.cmml" xref="A3.SS2.p2.7.m6.1.1.1.1.1.1.1">subscript</csymbol><ci id="A3.SS2.p2.7.m6.1.1.1.1.1.1.1.1.2.cmml" xref="A3.SS2.p2.7.m6.1.1.1.1.1.1.1.1.2">𝑣</ci><ci id="A3.SS2.p2.7.m6.1.1.1.1.1.1.1.1.3.cmml" xref="A3.SS2.p2.7.m6.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply></set><apply id="A3.SS2.p2.7.m6.1.1.3.cmml" xref="A3.SS2.p2.7.m6.1.1.3"><in id="A3.SS2.p2.7.m6.1.1.3.1.cmml" xref="A3.SS2.p2.7.m6.1.1.3.1"></in><apply id="A3.SS2.p2.7.m6.1.1.3.2.cmml" xref="A3.SS2.p2.7.m6.1.1.3.2"><csymbol cd="ambiguous" id="A3.SS2.p2.7.m6.1.1.3.2.1.cmml" xref="A3.SS2.p2.7.m6.1.1.3.2">subscript</csymbol><ci id="A3.SS2.p2.7.m6.1.1.3.2.2.cmml" xref="A3.SS2.p2.7.m6.1.1.3.2.2">𝑣</ci><ci id="A3.SS2.p2.7.m6.1.1.3.2.3.cmml" xref="A3.SS2.p2.7.m6.1.1.3.2.3">𝑖</ci></apply><ci id="A3.SS2.p2.7.m6.1.1.3.3.cmml" xref="A3.SS2.p2.7.m6.1.1.3.3">𝒩</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS2.p2.7.m6.1c">\{{\phi}_{\mathcal{G}}(v_{i})\}_{v_{i}\in\mathcal{N}}</annotation><annotation encoding="application/x-llamapun" id="A3.SS2.p2.7.m6.1d">{ italic_ϕ start_POSTSUBSCRIPT caligraphic_G end_POSTSUBSCRIPT ( italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) } start_POSTSUBSCRIPT italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∈ caligraphic_N end_POSTSUBSCRIPT</annotation></semantics></math> whose dot product is exactly a Taylor mask <math alttext="\mathbf{M}_{\alpha}(\mathcal{G})" class="ltx_Math" display="inline" id="A3.SS2.p2.8.m7.1"><semantics id="A3.SS2.p2.8.m7.1a"><mrow id="A3.SS2.p2.8.m7.1.2" xref="A3.SS2.p2.8.m7.1.2.cmml"><msub id="A3.SS2.p2.8.m7.1.2.2" xref="A3.SS2.p2.8.m7.1.2.2.cmml"><mi id="A3.SS2.p2.8.m7.1.2.2.2" xref="A3.SS2.p2.8.m7.1.2.2.2.cmml">𝐌</mi><mi id="A3.SS2.p2.8.m7.1.2.2.3" xref="A3.SS2.p2.8.m7.1.2.2.3.cmml">α</mi></msub><mo id="A3.SS2.p2.8.m7.1.2.1" xref="A3.SS2.p2.8.m7.1.2.1.cmml">⁢</mo><mrow id="A3.SS2.p2.8.m7.1.2.3.2" xref="A3.SS2.p2.8.m7.1.2.cmml"><mo id="A3.SS2.p2.8.m7.1.2.3.2.1" stretchy="false" xref="A3.SS2.p2.8.m7.1.2.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="A3.SS2.p2.8.m7.1.1" xref="A3.SS2.p2.8.m7.1.1.cmml">𝒢</mi><mo id="A3.SS2.p2.8.m7.1.2.3.2.2" stretchy="false" xref="A3.SS2.p2.8.m7.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.SS2.p2.8.m7.1b"><apply id="A3.SS2.p2.8.m7.1.2.cmml" xref="A3.SS2.p2.8.m7.1.2"><times id="A3.SS2.p2.8.m7.1.2.1.cmml" xref="A3.SS2.p2.8.m7.1.2.1"></times><apply id="A3.SS2.p2.8.m7.1.2.2.cmml" xref="A3.SS2.p2.8.m7.1.2.2"><csymbol cd="ambiguous" id="A3.SS2.p2.8.m7.1.2.2.1.cmml" xref="A3.SS2.p2.8.m7.1.2.2">subscript</csymbol><ci id="A3.SS2.p2.8.m7.1.2.2.2.cmml" xref="A3.SS2.p2.8.m7.1.2.2.2">𝐌</ci><ci id="A3.SS2.p2.8.m7.1.2.2.3.cmml" xref="A3.SS2.p2.8.m7.1.2.2.3">𝛼</ci></apply><ci id="A3.SS2.p2.8.m7.1.1.cmml" xref="A3.SS2.p2.8.m7.1.1">𝒢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS2.p2.8.m7.1c">\mathbf{M}_{\alpha}(\mathcal{G})</annotation><annotation encoding="application/x-llamapun" id="A3.SS2.p2.8.m7.1d">bold_M start_POSTSUBSCRIPT italic_α end_POSTSUBSCRIPT ( caligraphic_G )</annotation></semantics></math>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="A3.SS2.p3">
<p class="ltx_p" id="A3.SS2.p3.3"><span class="ltx_text ltx_font_bold" id="A3.SS2.p3.3.1">Importance sampling.</span>
The crux of our approach is modulating attention by an unbiased Monte Carlo approximation of a function of a weighted adjacency matrix <math alttext="\mathbf{W}" class="ltx_Math" display="inline" id="A3.SS2.p3.1.m1.1"><semantics id="A3.SS2.p3.1.m1.1a"><mi id="A3.SS2.p3.1.m1.1.1" xref="A3.SS2.p3.1.m1.1.1.cmml">𝐖</mi><annotation-xml encoding="MathML-Content" id="A3.SS2.p3.1.m1.1b"><ci id="A3.SS2.p3.1.m1.1.1.cmml" xref="A3.SS2.p3.1.m1.1.1">𝐖</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.SS2.p3.1.m1.1c">\mathbf{W}</annotation><annotation encoding="application/x-llamapun" id="A3.SS2.p3.1.m1.1d">bold_W</annotation></semantics></math>.
Using GRFs, this involves sampling random walks which we reweight by (i) their probability under the sampling mechanism, (ii) the product of traversed edge weights <math alttext="\widetilde{\omega}(\omega)" class="ltx_Math" display="inline" id="A3.SS2.p3.2.m2.1"><semantics id="A3.SS2.p3.2.m2.1a"><mrow id="A3.SS2.p3.2.m2.1.2" xref="A3.SS2.p3.2.m2.1.2.cmml"><mover accent="true" id="A3.SS2.p3.2.m2.1.2.2" xref="A3.SS2.p3.2.m2.1.2.2.cmml"><mi id="A3.SS2.p3.2.m2.1.2.2.2" xref="A3.SS2.p3.2.m2.1.2.2.2.cmml">ω</mi><mo id="A3.SS2.p3.2.m2.1.2.2.1" xref="A3.SS2.p3.2.m2.1.2.2.1.cmml">~</mo></mover><mo id="A3.SS2.p3.2.m2.1.2.1" xref="A3.SS2.p3.2.m2.1.2.1.cmml">⁢</mo><mrow id="A3.SS2.p3.2.m2.1.2.3.2" xref="A3.SS2.p3.2.m2.1.2.cmml"><mo id="A3.SS2.p3.2.m2.1.2.3.2.1" stretchy="false" xref="A3.SS2.p3.2.m2.1.2.cmml">(</mo><mi id="A3.SS2.p3.2.m2.1.1" xref="A3.SS2.p3.2.m2.1.1.cmml">ω</mi><mo id="A3.SS2.p3.2.m2.1.2.3.2.2" stretchy="false" xref="A3.SS2.p3.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.SS2.p3.2.m2.1b"><apply id="A3.SS2.p3.2.m2.1.2.cmml" xref="A3.SS2.p3.2.m2.1.2"><times id="A3.SS2.p3.2.m2.1.2.1.cmml" xref="A3.SS2.p3.2.m2.1.2.1"></times><apply id="A3.SS2.p3.2.m2.1.2.2.cmml" xref="A3.SS2.p3.2.m2.1.2.2"><ci id="A3.SS2.p3.2.m2.1.2.2.1.cmml" xref="A3.SS2.p3.2.m2.1.2.2.1">~</ci><ci id="A3.SS2.p3.2.m2.1.2.2.2.cmml" xref="A3.SS2.p3.2.m2.1.2.2.2">𝜔</ci></apply><ci id="A3.SS2.p3.2.m2.1.1.cmml" xref="A3.SS2.p3.2.m2.1.1">𝜔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS2.p3.2.m2.1c">\widetilde{\omega}(\omega)</annotation><annotation encoding="application/x-llamapun" id="A3.SS2.p3.2.m2.1d">over~ start_ARG italic_ω end_ARG ( italic_ω )</annotation></semantics></math>, and (iii) a learnable function <math alttext="f" class="ltx_Math" display="inline" id="A3.SS2.p3.3.m3.1"><semantics id="A3.SS2.p3.3.m3.1a"><mi id="A3.SS2.p3.3.m3.1.1" xref="A3.SS2.p3.3.m3.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="A3.SS2.p3.3.m3.1b"><ci id="A3.SS2.p3.3.m3.1.1.cmml" xref="A3.SS2.p3.3.m3.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.SS2.p3.3.m3.1c">f</annotation><annotation encoding="application/x-llamapun" id="A3.SS2.p3.3.m3.1d">italic_f</annotation></semantics></math> (see Eq.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#S3.E10" title="In 3.3 Faster implicit masking with graph random features ‣ 3 Towards linear topological masking ‣ Linear Transformer Topological Masking with Graph Random Features"><span class="ltx_text ltx_ref_tag">10</span></a>).
To investigate the importance of this principled sampling mechanism, we ablate (i) and (ii) and compare with an ad-hoc empirical random walk kernel defined by the features</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equation ltx_eqn_table" id="A3.E21">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\phi_{\textrm{ad-hoc}}(v_{i})_{q}\coloneqq\frac{1}{n}\sum_{k=1}^{n}\sum_{%
\omega_{iq}\in\Omega_{iq}}f_{\textrm{len}(\omega_{iq})}\mathbb{I}(\omega_{iq}%
\textrm{ prefix subwalk of }\omega_{k}^{(i)}),\quad q=1,...,N." class="ltx_Math" display="block" id="A3.E21.m1.6"><semantics id="A3.E21.m1.6a"><mrow id="A3.E21.m1.6.6.1"><mrow id="A3.E21.m1.6.6.1.1.2" xref="A3.E21.m1.6.6.1.1.3.cmml"><mrow id="A3.E21.m1.6.6.1.1.1.1" xref="A3.E21.m1.6.6.1.1.1.1.cmml"><mrow id="A3.E21.m1.6.6.1.1.1.1.1" xref="A3.E21.m1.6.6.1.1.1.1.1.cmml"><msub id="A3.E21.m1.6.6.1.1.1.1.1.3" xref="A3.E21.m1.6.6.1.1.1.1.1.3.cmml"><mi id="A3.E21.m1.6.6.1.1.1.1.1.3.2" xref="A3.E21.m1.6.6.1.1.1.1.1.3.2.cmml">ϕ</mi><mtext id="A3.E21.m1.6.6.1.1.1.1.1.3.3" xref="A3.E21.m1.6.6.1.1.1.1.1.3.3a.cmml">ad-hoc</mtext></msub><mo id="A3.E21.m1.6.6.1.1.1.1.1.2" xref="A3.E21.m1.6.6.1.1.1.1.1.2.cmml">⁢</mo><msub id="A3.E21.m1.6.6.1.1.1.1.1.1" xref="A3.E21.m1.6.6.1.1.1.1.1.1.cmml"><mrow id="A3.E21.m1.6.6.1.1.1.1.1.1.1.1" xref="A3.E21.m1.6.6.1.1.1.1.1.1.1.1.1.cmml"><mo id="A3.E21.m1.6.6.1.1.1.1.1.1.1.1.2" stretchy="false" xref="A3.E21.m1.6.6.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="A3.E21.m1.6.6.1.1.1.1.1.1.1.1.1" xref="A3.E21.m1.6.6.1.1.1.1.1.1.1.1.1.cmml"><mi id="A3.E21.m1.6.6.1.1.1.1.1.1.1.1.1.2" xref="A3.E21.m1.6.6.1.1.1.1.1.1.1.1.1.2.cmml">v</mi><mi id="A3.E21.m1.6.6.1.1.1.1.1.1.1.1.1.3" xref="A3.E21.m1.6.6.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="A3.E21.m1.6.6.1.1.1.1.1.1.1.1.3" stretchy="false" xref="A3.E21.m1.6.6.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mi id="A3.E21.m1.6.6.1.1.1.1.1.1.3" xref="A3.E21.m1.6.6.1.1.1.1.1.1.3.cmml">q</mi></msub></mrow><mo id="A3.E21.m1.6.6.1.1.1.1.3" xref="A3.E21.m1.6.6.1.1.1.1.3.cmml">≔</mo><mrow id="A3.E21.m1.6.6.1.1.1.1.2" xref="A3.E21.m1.6.6.1.1.1.1.2.cmml"><mfrac id="A3.E21.m1.6.6.1.1.1.1.2.3" xref="A3.E21.m1.6.6.1.1.1.1.2.3.cmml"><mn id="A3.E21.m1.6.6.1.1.1.1.2.3.2" xref="A3.E21.m1.6.6.1.1.1.1.2.3.2.cmml">1</mn><mi id="A3.E21.m1.6.6.1.1.1.1.2.3.3" xref="A3.E21.m1.6.6.1.1.1.1.2.3.3.cmml">n</mi></mfrac><mo id="A3.E21.m1.6.6.1.1.1.1.2.2" xref="A3.E21.m1.6.6.1.1.1.1.2.2.cmml">⁢</mo><mrow id="A3.E21.m1.6.6.1.1.1.1.2.1" xref="A3.E21.m1.6.6.1.1.1.1.2.1.cmml"><munderover id="A3.E21.m1.6.6.1.1.1.1.2.1.2" xref="A3.E21.m1.6.6.1.1.1.1.2.1.2.cmml"><mo id="A3.E21.m1.6.6.1.1.1.1.2.1.2.2.2" movablelimits="false" rspace="0em" xref="A3.E21.m1.6.6.1.1.1.1.2.1.2.2.2.cmml">∑</mo><mrow id="A3.E21.m1.6.6.1.1.1.1.2.1.2.2.3" xref="A3.E21.m1.6.6.1.1.1.1.2.1.2.2.3.cmml"><mi id="A3.E21.m1.6.6.1.1.1.1.2.1.2.2.3.2" xref="A3.E21.m1.6.6.1.1.1.1.2.1.2.2.3.2.cmml">k</mi><mo id="A3.E21.m1.6.6.1.1.1.1.2.1.2.2.3.1" xref="A3.E21.m1.6.6.1.1.1.1.2.1.2.2.3.1.cmml">=</mo><mn id="A3.E21.m1.6.6.1.1.1.1.2.1.2.2.3.3" xref="A3.E21.m1.6.6.1.1.1.1.2.1.2.2.3.3.cmml">1</mn></mrow><mi id="A3.E21.m1.6.6.1.1.1.1.2.1.2.3" xref="A3.E21.m1.6.6.1.1.1.1.2.1.2.3.cmml">n</mi></munderover><mrow id="A3.E21.m1.6.6.1.1.1.1.2.1.1" xref="A3.E21.m1.6.6.1.1.1.1.2.1.1.cmml"><munder id="A3.E21.m1.6.6.1.1.1.1.2.1.1.2" xref="A3.E21.m1.6.6.1.1.1.1.2.1.1.2.cmml"><mo id="A3.E21.m1.6.6.1.1.1.1.2.1.1.2.2" movablelimits="false" xref="A3.E21.m1.6.6.1.1.1.1.2.1.1.2.2.cmml">∑</mo><mrow id="A3.E21.m1.6.6.1.1.1.1.2.1.1.2.3" xref="A3.E21.m1.6.6.1.1.1.1.2.1.1.2.3.cmml"><msub id="A3.E21.m1.6.6.1.1.1.1.2.1.1.2.3.2" xref="A3.E21.m1.6.6.1.1.1.1.2.1.1.2.3.2.cmml"><mi id="A3.E21.m1.6.6.1.1.1.1.2.1.1.2.3.2.2" xref="A3.E21.m1.6.6.1.1.1.1.2.1.1.2.3.2.2.cmml">ω</mi><mrow id="A3.E21.m1.6.6.1.1.1.1.2.1.1.2.3.2.3" xref="A3.E21.m1.6.6.1.1.1.1.2.1.1.2.3.2.3.cmml"><mi id="A3.E21.m1.6.6.1.1.1.1.2.1.1.2.3.2.3.2" xref="A3.E21.m1.6.6.1.1.1.1.2.1.1.2.3.2.3.2.cmml">i</mi><mo id="A3.E21.m1.6.6.1.1.1.1.2.1.1.2.3.2.3.1" xref="A3.E21.m1.6.6.1.1.1.1.2.1.1.2.3.2.3.1.cmml">⁢</mo><mi id="A3.E21.m1.6.6.1.1.1.1.2.1.1.2.3.2.3.3" xref="A3.E21.m1.6.6.1.1.1.1.2.1.1.2.3.2.3.3.cmml">q</mi></mrow></msub><mo id="A3.E21.m1.6.6.1.1.1.1.2.1.1.2.3.1" xref="A3.E21.m1.6.6.1.1.1.1.2.1.1.2.3.1.cmml">∈</mo><msub id="A3.E21.m1.6.6.1.1.1.1.2.1.1.2.3.3" xref="A3.E21.m1.6.6.1.1.1.1.2.1.1.2.3.3.cmml"><mi id="A3.E21.m1.6.6.1.1.1.1.2.1.1.2.3.3.2" mathvariant="normal" xref="A3.E21.m1.6.6.1.1.1.1.2.1.1.2.3.3.2.cmml">Ω</mi><mrow id="A3.E21.m1.6.6.1.1.1.1.2.1.1.2.3.3.3" xref="A3.E21.m1.6.6.1.1.1.1.2.1.1.2.3.3.3.cmml"><mi id="A3.E21.m1.6.6.1.1.1.1.2.1.1.2.3.3.3.2" xref="A3.E21.m1.6.6.1.1.1.1.2.1.1.2.3.3.3.2.cmml">i</mi><mo id="A3.E21.m1.6.6.1.1.1.1.2.1.1.2.3.3.3.1" xref="A3.E21.m1.6.6.1.1.1.1.2.1.1.2.3.3.3.1.cmml">⁢</mo><mi id="A3.E21.m1.6.6.1.1.1.1.2.1.1.2.3.3.3.3" xref="A3.E21.m1.6.6.1.1.1.1.2.1.1.2.3.3.3.3.cmml">q</mi></mrow></msub></mrow></munder><mrow id="A3.E21.m1.6.6.1.1.1.1.2.1.1.1" xref="A3.E21.m1.6.6.1.1.1.1.2.1.1.1.cmml"><msub id="A3.E21.m1.6.6.1.1.1.1.2.1.1.1.3" xref="A3.E21.m1.6.6.1.1.1.1.2.1.1.1.3.cmml"><mi id="A3.E21.m1.6.6.1.1.1.1.2.1.1.1.3.2" xref="A3.E21.m1.6.6.1.1.1.1.2.1.1.1.3.2.cmml">f</mi><mrow id="A3.E21.m1.1.1.1" xref="A3.E21.m1.1.1.1.cmml"><mtext id="A3.E21.m1.1.1.1.3" xref="A3.E21.m1.1.1.1.3a.cmml">len</mtext><mo id="A3.E21.m1.1.1.1.2" xref="A3.E21.m1.1.1.1.2.cmml">⁢</mo><mrow id="A3.E21.m1.1.1.1.1.1" xref="A3.E21.m1.1.1.1.1.1.1.cmml"><mo id="A3.E21.m1.1.1.1.1.1.2" stretchy="false" xref="A3.E21.m1.1.1.1.1.1.1.cmml">(</mo><msub id="A3.E21.m1.1.1.1.1.1.1" xref="A3.E21.m1.1.1.1.1.1.1.cmml"><mi id="A3.E21.m1.1.1.1.1.1.1.2" xref="A3.E21.m1.1.1.1.1.1.1.2.cmml">ω</mi><mrow id="A3.E21.m1.1.1.1.1.1.1.3" xref="A3.E21.m1.1.1.1.1.1.1.3.cmml"><mi id="A3.E21.m1.1.1.1.1.1.1.3.2" xref="A3.E21.m1.1.1.1.1.1.1.3.2.cmml">i</mi><mo id="A3.E21.m1.1.1.1.1.1.1.3.1" xref="A3.E21.m1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="A3.E21.m1.1.1.1.1.1.1.3.3" xref="A3.E21.m1.1.1.1.1.1.1.3.3.cmml">q</mi></mrow></msub><mo id="A3.E21.m1.1.1.1.1.1.3" stretchy="false" xref="A3.E21.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></msub><mo id="A3.E21.m1.6.6.1.1.1.1.2.1.1.1.2" xref="A3.E21.m1.6.6.1.1.1.1.2.1.1.1.2.cmml">⁢</mo><mi id="A3.E21.m1.6.6.1.1.1.1.2.1.1.1.4" xref="A3.E21.m1.6.6.1.1.1.1.2.1.1.1.4.cmml">𝕀</mi><mo id="A3.E21.m1.6.6.1.1.1.1.2.1.1.1.2a" xref="A3.E21.m1.6.6.1.1.1.1.2.1.1.1.2.cmml">⁢</mo><mrow id="A3.E21.m1.6.6.1.1.1.1.2.1.1.1.1.1" xref="A3.E21.m1.6.6.1.1.1.1.2.1.1.1.1.1.1.cmml"><mo id="A3.E21.m1.6.6.1.1.1.1.2.1.1.1.1.1.2" stretchy="false" xref="A3.E21.m1.6.6.1.1.1.1.2.1.1.1.1.1.1.cmml">(</mo><mrow id="A3.E21.m1.6.6.1.1.1.1.2.1.1.1.1.1.1" xref="A3.E21.m1.6.6.1.1.1.1.2.1.1.1.1.1.1.cmml"><msub id="A3.E21.m1.6.6.1.1.1.1.2.1.1.1.1.1.1.2" xref="A3.E21.m1.6.6.1.1.1.1.2.1.1.1.1.1.1.2.cmml"><mi id="A3.E21.m1.6.6.1.1.1.1.2.1.1.1.1.1.1.2.2" xref="A3.E21.m1.6.6.1.1.1.1.2.1.1.1.1.1.1.2.2.cmml">ω</mi><mrow id="A3.E21.m1.6.6.1.1.1.1.2.1.1.1.1.1.1.2.3" xref="A3.E21.m1.6.6.1.1.1.1.2.1.1.1.1.1.1.2.3.cmml"><mi id="A3.E21.m1.6.6.1.1.1.1.2.1.1.1.1.1.1.2.3.2" xref="A3.E21.m1.6.6.1.1.1.1.2.1.1.1.1.1.1.2.3.2.cmml">i</mi><mo id="A3.E21.m1.6.6.1.1.1.1.2.1.1.1.1.1.1.2.3.1" xref="A3.E21.m1.6.6.1.1.1.1.2.1.1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="A3.E21.m1.6.6.1.1.1.1.2.1.1.1.1.1.1.2.3.3" xref="A3.E21.m1.6.6.1.1.1.1.2.1.1.1.1.1.1.2.3.3.cmml">q</mi></mrow></msub><mo id="A3.E21.m1.6.6.1.1.1.1.2.1.1.1.1.1.1.1" xref="A3.E21.m1.6.6.1.1.1.1.2.1.1.1.1.1.1.1.cmml">⁢</mo><mtext id="A3.E21.m1.6.6.1.1.1.1.2.1.1.1.1.1.1.3" xref="A3.E21.m1.6.6.1.1.1.1.2.1.1.1.1.1.1.3a.cmml">&nbsp;prefix subwalk of&nbsp;</mtext><mo id="A3.E21.m1.6.6.1.1.1.1.2.1.1.1.1.1.1.1a" xref="A3.E21.m1.6.6.1.1.1.1.2.1.1.1.1.1.1.1.cmml">⁢</mo><msubsup id="A3.E21.m1.6.6.1.1.1.1.2.1.1.1.1.1.1.4" xref="A3.E21.m1.6.6.1.1.1.1.2.1.1.1.1.1.1.4.cmml"><mi id="A3.E21.m1.6.6.1.1.1.1.2.1.1.1.1.1.1.4.2.2" xref="A3.E21.m1.6.6.1.1.1.1.2.1.1.1.1.1.1.4.2.2.cmml">ω</mi><mi id="A3.E21.m1.6.6.1.1.1.1.2.1.1.1.1.1.1.4.2.3" xref="A3.E21.m1.6.6.1.1.1.1.2.1.1.1.1.1.1.4.2.3.cmml">k</mi><mrow id="A3.E21.m1.2.2.1.3" xref="A3.E21.m1.6.6.1.1.1.1.2.1.1.1.1.1.1.4.cmml"><mo id="A3.E21.m1.2.2.1.3.1" stretchy="false" xref="A3.E21.m1.6.6.1.1.1.1.2.1.1.1.1.1.1.4.cmml">(</mo><mi id="A3.E21.m1.2.2.1.1" xref="A3.E21.m1.2.2.1.1.cmml">i</mi><mo id="A3.E21.m1.2.2.1.3.2" stretchy="false" xref="A3.E21.m1.6.6.1.1.1.1.2.1.1.1.1.1.1.4.cmml">)</mo></mrow></msubsup></mrow><mo id="A3.E21.m1.6.6.1.1.1.1.2.1.1.1.1.1.3" stretchy="false" xref="A3.E21.m1.6.6.1.1.1.1.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mrow><mo id="A3.E21.m1.6.6.1.1.2.3" rspace="1.167em" xref="A3.E21.m1.6.6.1.1.3a.cmml">,</mo><mrow id="A3.E21.m1.6.6.1.1.2.2" xref="A3.E21.m1.6.6.1.1.2.2.cmml"><mi id="A3.E21.m1.6.6.1.1.2.2.2" xref="A3.E21.m1.6.6.1.1.2.2.2.cmml">q</mi><mo id="A3.E21.m1.6.6.1.1.2.2.1" xref="A3.E21.m1.6.6.1.1.2.2.1.cmml">=</mo><mrow id="A3.E21.m1.6.6.1.1.2.2.3.2" xref="A3.E21.m1.6.6.1.1.2.2.3.1.cmml"><mn id="A3.E21.m1.3.3" xref="A3.E21.m1.3.3.cmml">1</mn><mo id="A3.E21.m1.6.6.1.1.2.2.3.2.1" xref="A3.E21.m1.6.6.1.1.2.2.3.1.cmml">,</mo><mi id="A3.E21.m1.4.4" mathvariant="normal" xref="A3.E21.m1.4.4.cmml">…</mi><mo id="A3.E21.m1.6.6.1.1.2.2.3.2.2" xref="A3.E21.m1.6.6.1.1.2.2.3.1.cmml">,</mo><mi id="A3.E21.m1.5.5" xref="A3.E21.m1.5.5.cmml">N</mi></mrow></mrow></mrow><mo id="A3.E21.m1.6.6.1.2" lspace="0em">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A3.E21.m1.6b"><apply id="A3.E21.m1.6.6.1.1.3.cmml" xref="A3.E21.m1.6.6.1.1.2"><csymbol cd="ambiguous" id="A3.E21.m1.6.6.1.1.3a.cmml" xref="A3.E21.m1.6.6.1.1.2.3">formulae-sequence</csymbol><apply id="A3.E21.m1.6.6.1.1.1.1.cmml" xref="A3.E21.m1.6.6.1.1.1.1"><ci id="A3.E21.m1.6.6.1.1.1.1.3.cmml" xref="A3.E21.m1.6.6.1.1.1.1.3">≔</ci><apply id="A3.E21.m1.6.6.1.1.1.1.1.cmml" xref="A3.E21.m1.6.6.1.1.1.1.1"><times id="A3.E21.m1.6.6.1.1.1.1.1.2.cmml" xref="A3.E21.m1.6.6.1.1.1.1.1.2"></times><apply id="A3.E21.m1.6.6.1.1.1.1.1.3.cmml" xref="A3.E21.m1.6.6.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A3.E21.m1.6.6.1.1.1.1.1.3.1.cmml" xref="A3.E21.m1.6.6.1.1.1.1.1.3">subscript</csymbol><ci id="A3.E21.m1.6.6.1.1.1.1.1.3.2.cmml" xref="A3.E21.m1.6.6.1.1.1.1.1.3.2">italic-ϕ</ci><ci id="A3.E21.m1.6.6.1.1.1.1.1.3.3a.cmml" xref="A3.E21.m1.6.6.1.1.1.1.1.3.3"><mtext id="A3.E21.m1.6.6.1.1.1.1.1.3.3.cmml" mathsize="70%" xref="A3.E21.m1.6.6.1.1.1.1.1.3.3">ad-hoc</mtext></ci></apply><apply id="A3.E21.m1.6.6.1.1.1.1.1.1.cmml" xref="A3.E21.m1.6.6.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A3.E21.m1.6.6.1.1.1.1.1.1.2.cmml" xref="A3.E21.m1.6.6.1.1.1.1.1.1">subscript</csymbol><apply id="A3.E21.m1.6.6.1.1.1.1.1.1.1.1.1.cmml" xref="A3.E21.m1.6.6.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A3.E21.m1.6.6.1.1.1.1.1.1.1.1.1.1.cmml" xref="A3.E21.m1.6.6.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="A3.E21.m1.6.6.1.1.1.1.1.1.1.1.1.2.cmml" xref="A3.E21.m1.6.6.1.1.1.1.1.1.1.1.1.2">𝑣</ci><ci id="A3.E21.m1.6.6.1.1.1.1.1.1.1.1.1.3.cmml" xref="A3.E21.m1.6.6.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><ci id="A3.E21.m1.6.6.1.1.1.1.1.1.3.cmml" xref="A3.E21.m1.6.6.1.1.1.1.1.1.3">𝑞</ci></apply></apply><apply id="A3.E21.m1.6.6.1.1.1.1.2.cmml" xref="A3.E21.m1.6.6.1.1.1.1.2"><times id="A3.E21.m1.6.6.1.1.1.1.2.2.cmml" xref="A3.E21.m1.6.6.1.1.1.1.2.2"></times><apply id="A3.E21.m1.6.6.1.1.1.1.2.3.cmml" xref="A3.E21.m1.6.6.1.1.1.1.2.3"><divide id="A3.E21.m1.6.6.1.1.1.1.2.3.1.cmml" xref="A3.E21.m1.6.6.1.1.1.1.2.3"></divide><cn id="A3.E21.m1.6.6.1.1.1.1.2.3.2.cmml" type="integer" xref="A3.E21.m1.6.6.1.1.1.1.2.3.2">1</cn><ci id="A3.E21.m1.6.6.1.1.1.1.2.3.3.cmml" xref="A3.E21.m1.6.6.1.1.1.1.2.3.3">𝑛</ci></apply><apply id="A3.E21.m1.6.6.1.1.1.1.2.1.cmml" xref="A3.E21.m1.6.6.1.1.1.1.2.1"><apply id="A3.E21.m1.6.6.1.1.1.1.2.1.2.cmml" xref="A3.E21.m1.6.6.1.1.1.1.2.1.2"><csymbol cd="ambiguous" id="A3.E21.m1.6.6.1.1.1.1.2.1.2.1.cmml" xref="A3.E21.m1.6.6.1.1.1.1.2.1.2">superscript</csymbol><apply id="A3.E21.m1.6.6.1.1.1.1.2.1.2.2.cmml" xref="A3.E21.m1.6.6.1.1.1.1.2.1.2"><csymbol cd="ambiguous" id="A3.E21.m1.6.6.1.1.1.1.2.1.2.2.1.cmml" xref="A3.E21.m1.6.6.1.1.1.1.2.1.2">subscript</csymbol><sum id="A3.E21.m1.6.6.1.1.1.1.2.1.2.2.2.cmml" xref="A3.E21.m1.6.6.1.1.1.1.2.1.2.2.2"></sum><apply id="A3.E21.m1.6.6.1.1.1.1.2.1.2.2.3.cmml" xref="A3.E21.m1.6.6.1.1.1.1.2.1.2.2.3"><eq id="A3.E21.m1.6.6.1.1.1.1.2.1.2.2.3.1.cmml" xref="A3.E21.m1.6.6.1.1.1.1.2.1.2.2.3.1"></eq><ci id="A3.E21.m1.6.6.1.1.1.1.2.1.2.2.3.2.cmml" xref="A3.E21.m1.6.6.1.1.1.1.2.1.2.2.3.2">𝑘</ci><cn id="A3.E21.m1.6.6.1.1.1.1.2.1.2.2.3.3.cmml" type="integer" xref="A3.E21.m1.6.6.1.1.1.1.2.1.2.2.3.3">1</cn></apply></apply><ci id="A3.E21.m1.6.6.1.1.1.1.2.1.2.3.cmml" xref="A3.E21.m1.6.6.1.1.1.1.2.1.2.3">𝑛</ci></apply><apply id="A3.E21.m1.6.6.1.1.1.1.2.1.1.cmml" xref="A3.E21.m1.6.6.1.1.1.1.2.1.1"><apply id="A3.E21.m1.6.6.1.1.1.1.2.1.1.2.cmml" xref="A3.E21.m1.6.6.1.1.1.1.2.1.1.2"><csymbol cd="ambiguous" id="A3.E21.m1.6.6.1.1.1.1.2.1.1.2.1.cmml" xref="A3.E21.m1.6.6.1.1.1.1.2.1.1.2">subscript</csymbol><sum id="A3.E21.m1.6.6.1.1.1.1.2.1.1.2.2.cmml" xref="A3.E21.m1.6.6.1.1.1.1.2.1.1.2.2"></sum><apply id="A3.E21.m1.6.6.1.1.1.1.2.1.1.2.3.cmml" xref="A3.E21.m1.6.6.1.1.1.1.2.1.1.2.3"><in id="A3.E21.m1.6.6.1.1.1.1.2.1.1.2.3.1.cmml" xref="A3.E21.m1.6.6.1.1.1.1.2.1.1.2.3.1"></in><apply id="A3.E21.m1.6.6.1.1.1.1.2.1.1.2.3.2.cmml" xref="A3.E21.m1.6.6.1.1.1.1.2.1.1.2.3.2"><csymbol cd="ambiguous" id="A3.E21.m1.6.6.1.1.1.1.2.1.1.2.3.2.1.cmml" xref="A3.E21.m1.6.6.1.1.1.1.2.1.1.2.3.2">subscript</csymbol><ci id="A3.E21.m1.6.6.1.1.1.1.2.1.1.2.3.2.2.cmml" xref="A3.E21.m1.6.6.1.1.1.1.2.1.1.2.3.2.2">𝜔</ci><apply id="A3.E21.m1.6.6.1.1.1.1.2.1.1.2.3.2.3.cmml" xref="A3.E21.m1.6.6.1.1.1.1.2.1.1.2.3.2.3"><times id="A3.E21.m1.6.6.1.1.1.1.2.1.1.2.3.2.3.1.cmml" xref="A3.E21.m1.6.6.1.1.1.1.2.1.1.2.3.2.3.1"></times><ci id="A3.E21.m1.6.6.1.1.1.1.2.1.1.2.3.2.3.2.cmml" xref="A3.E21.m1.6.6.1.1.1.1.2.1.1.2.3.2.3.2">𝑖</ci><ci id="A3.E21.m1.6.6.1.1.1.1.2.1.1.2.3.2.3.3.cmml" xref="A3.E21.m1.6.6.1.1.1.1.2.1.1.2.3.2.3.3">𝑞</ci></apply></apply><apply id="A3.E21.m1.6.6.1.1.1.1.2.1.1.2.3.3.cmml" xref="A3.E21.m1.6.6.1.1.1.1.2.1.1.2.3.3"><csymbol cd="ambiguous" id="A3.E21.m1.6.6.1.1.1.1.2.1.1.2.3.3.1.cmml" xref="A3.E21.m1.6.6.1.1.1.1.2.1.1.2.3.3">subscript</csymbol><ci id="A3.E21.m1.6.6.1.1.1.1.2.1.1.2.3.3.2.cmml" xref="A3.E21.m1.6.6.1.1.1.1.2.1.1.2.3.3.2">Ω</ci><apply id="A3.E21.m1.6.6.1.1.1.1.2.1.1.2.3.3.3.cmml" xref="A3.E21.m1.6.6.1.1.1.1.2.1.1.2.3.3.3"><times id="A3.E21.m1.6.6.1.1.1.1.2.1.1.2.3.3.3.1.cmml" xref="A3.E21.m1.6.6.1.1.1.1.2.1.1.2.3.3.3.1"></times><ci id="A3.E21.m1.6.6.1.1.1.1.2.1.1.2.3.3.3.2.cmml" xref="A3.E21.m1.6.6.1.1.1.1.2.1.1.2.3.3.3.2">𝑖</ci><ci id="A3.E21.m1.6.6.1.1.1.1.2.1.1.2.3.3.3.3.cmml" xref="A3.E21.m1.6.6.1.1.1.1.2.1.1.2.3.3.3.3">𝑞</ci></apply></apply></apply></apply><apply id="A3.E21.m1.6.6.1.1.1.1.2.1.1.1.cmml" xref="A3.E21.m1.6.6.1.1.1.1.2.1.1.1"><times id="A3.E21.m1.6.6.1.1.1.1.2.1.1.1.2.cmml" xref="A3.E21.m1.6.6.1.1.1.1.2.1.1.1.2"></times><apply id="A3.E21.m1.6.6.1.1.1.1.2.1.1.1.3.cmml" xref="A3.E21.m1.6.6.1.1.1.1.2.1.1.1.3"><csymbol cd="ambiguous" id="A3.E21.m1.6.6.1.1.1.1.2.1.1.1.3.1.cmml" xref="A3.E21.m1.6.6.1.1.1.1.2.1.1.1.3">subscript</csymbol><ci id="A3.E21.m1.6.6.1.1.1.1.2.1.1.1.3.2.cmml" xref="A3.E21.m1.6.6.1.1.1.1.2.1.1.1.3.2">𝑓</ci><apply id="A3.E21.m1.1.1.1.cmml" xref="A3.E21.m1.1.1.1"><times id="A3.E21.m1.1.1.1.2.cmml" xref="A3.E21.m1.1.1.1.2"></times><ci id="A3.E21.m1.1.1.1.3a.cmml" xref="A3.E21.m1.1.1.1.3"><mtext id="A3.E21.m1.1.1.1.3.cmml" mathsize="70%" xref="A3.E21.m1.1.1.1.3">len</mtext></ci><apply id="A3.E21.m1.1.1.1.1.1.1.cmml" xref="A3.E21.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="A3.E21.m1.1.1.1.1.1.1.1.cmml" xref="A3.E21.m1.1.1.1.1.1">subscript</csymbol><ci id="A3.E21.m1.1.1.1.1.1.1.2.cmml" xref="A3.E21.m1.1.1.1.1.1.1.2">𝜔</ci><apply id="A3.E21.m1.1.1.1.1.1.1.3.cmml" xref="A3.E21.m1.1.1.1.1.1.1.3"><times id="A3.E21.m1.1.1.1.1.1.1.3.1.cmml" xref="A3.E21.m1.1.1.1.1.1.1.3.1"></times><ci id="A3.E21.m1.1.1.1.1.1.1.3.2.cmml" xref="A3.E21.m1.1.1.1.1.1.1.3.2">𝑖</ci><ci id="A3.E21.m1.1.1.1.1.1.1.3.3.cmml" xref="A3.E21.m1.1.1.1.1.1.1.3.3">𝑞</ci></apply></apply></apply></apply><ci id="A3.E21.m1.6.6.1.1.1.1.2.1.1.1.4.cmml" xref="A3.E21.m1.6.6.1.1.1.1.2.1.1.1.4">𝕀</ci><apply id="A3.E21.m1.6.6.1.1.1.1.2.1.1.1.1.1.1.cmml" xref="A3.E21.m1.6.6.1.1.1.1.2.1.1.1.1.1"><times id="A3.E21.m1.6.6.1.1.1.1.2.1.1.1.1.1.1.1.cmml" xref="A3.E21.m1.6.6.1.1.1.1.2.1.1.1.1.1.1.1"></times><apply id="A3.E21.m1.6.6.1.1.1.1.2.1.1.1.1.1.1.2.cmml" xref="A3.E21.m1.6.6.1.1.1.1.2.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A3.E21.m1.6.6.1.1.1.1.2.1.1.1.1.1.1.2.1.cmml" xref="A3.E21.m1.6.6.1.1.1.1.2.1.1.1.1.1.1.2">subscript</csymbol><ci id="A3.E21.m1.6.6.1.1.1.1.2.1.1.1.1.1.1.2.2.cmml" xref="A3.E21.m1.6.6.1.1.1.1.2.1.1.1.1.1.1.2.2">𝜔</ci><apply id="A3.E21.m1.6.6.1.1.1.1.2.1.1.1.1.1.1.2.3.cmml" xref="A3.E21.m1.6.6.1.1.1.1.2.1.1.1.1.1.1.2.3"><times id="A3.E21.m1.6.6.1.1.1.1.2.1.1.1.1.1.1.2.3.1.cmml" xref="A3.E21.m1.6.6.1.1.1.1.2.1.1.1.1.1.1.2.3.1"></times><ci id="A3.E21.m1.6.6.1.1.1.1.2.1.1.1.1.1.1.2.3.2.cmml" xref="A3.E21.m1.6.6.1.1.1.1.2.1.1.1.1.1.1.2.3.2">𝑖</ci><ci id="A3.E21.m1.6.6.1.1.1.1.2.1.1.1.1.1.1.2.3.3.cmml" xref="A3.E21.m1.6.6.1.1.1.1.2.1.1.1.1.1.1.2.3.3">𝑞</ci></apply></apply><ci id="A3.E21.m1.6.6.1.1.1.1.2.1.1.1.1.1.1.3a.cmml" xref="A3.E21.m1.6.6.1.1.1.1.2.1.1.1.1.1.1.3"><mtext id="A3.E21.m1.6.6.1.1.1.1.2.1.1.1.1.1.1.3.cmml" xref="A3.E21.m1.6.6.1.1.1.1.2.1.1.1.1.1.1.3">&nbsp;prefix subwalk of&nbsp;</mtext></ci><apply id="A3.E21.m1.6.6.1.1.1.1.2.1.1.1.1.1.1.4.cmml" xref="A3.E21.m1.6.6.1.1.1.1.2.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="A3.E21.m1.6.6.1.1.1.1.2.1.1.1.1.1.1.4.1.cmml" xref="A3.E21.m1.6.6.1.1.1.1.2.1.1.1.1.1.1.4">superscript</csymbol><apply id="A3.E21.m1.6.6.1.1.1.1.2.1.1.1.1.1.1.4.2.cmml" xref="A3.E21.m1.6.6.1.1.1.1.2.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="A3.E21.m1.6.6.1.1.1.1.2.1.1.1.1.1.1.4.2.1.cmml" xref="A3.E21.m1.6.6.1.1.1.1.2.1.1.1.1.1.1.4">subscript</csymbol><ci id="A3.E21.m1.6.6.1.1.1.1.2.1.1.1.1.1.1.4.2.2.cmml" xref="A3.E21.m1.6.6.1.1.1.1.2.1.1.1.1.1.1.4.2.2">𝜔</ci><ci id="A3.E21.m1.6.6.1.1.1.1.2.1.1.1.1.1.1.4.2.3.cmml" xref="A3.E21.m1.6.6.1.1.1.1.2.1.1.1.1.1.1.4.2.3">𝑘</ci></apply><ci id="A3.E21.m1.2.2.1.1.cmml" xref="A3.E21.m1.2.2.1.1">𝑖</ci></apply></apply></apply></apply></apply></apply></apply><apply id="A3.E21.m1.6.6.1.1.2.2.cmml" xref="A3.E21.m1.6.6.1.1.2.2"><eq id="A3.E21.m1.6.6.1.1.2.2.1.cmml" xref="A3.E21.m1.6.6.1.1.2.2.1"></eq><ci id="A3.E21.m1.6.6.1.1.2.2.2.cmml" xref="A3.E21.m1.6.6.1.1.2.2.2">𝑞</ci><list id="A3.E21.m1.6.6.1.1.2.2.3.1.cmml" xref="A3.E21.m1.6.6.1.1.2.2.3.2"><cn id="A3.E21.m1.3.3.cmml" type="integer" xref="A3.E21.m1.3.3">1</cn><ci id="A3.E21.m1.4.4.cmml" xref="A3.E21.m1.4.4">…</ci><ci id="A3.E21.m1.5.5.cmml" xref="A3.E21.m1.5.5">𝑁</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.E21.m1.6c">\phi_{\textrm{ad-hoc}}(v_{i})_{q}\coloneqq\frac{1}{n}\sum_{k=1}^{n}\sum_{%
\omega_{iq}\in\Omega_{iq}}f_{\textrm{len}(\omega_{iq})}\mathbb{I}(\omega_{iq}%
\textrm{ prefix subwalk of }\omega_{k}^{(i)}),\quad q=1,...,N.</annotation><annotation encoding="application/x-llamapun" id="A3.E21.m1.6d">italic_ϕ start_POSTSUBSCRIPT ad-hoc end_POSTSUBSCRIPT ( italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT ≔ divide start_ARG 1 end_ARG start_ARG italic_n end_ARG ∑ start_POSTSUBSCRIPT italic_k = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT ∑ start_POSTSUBSCRIPT italic_ω start_POSTSUBSCRIPT italic_i italic_q end_POSTSUBSCRIPT ∈ roman_Ω start_POSTSUBSCRIPT italic_i italic_q end_POSTSUBSCRIPT end_POSTSUBSCRIPT italic_f start_POSTSUBSCRIPT len ( italic_ω start_POSTSUBSCRIPT italic_i italic_q end_POSTSUBSCRIPT ) end_POSTSUBSCRIPT blackboard_I ( italic_ω start_POSTSUBSCRIPT italic_i italic_q end_POSTSUBSCRIPT prefix subwalk of italic_ω start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT ) , italic_q = 1 , … , italic_N .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(21)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A3.SS2.p3.7">Eq.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#A3.E21" title="In C.2 ViT ablations ‣ Appendix C Further experiments and details ‣ Linear Transformer Topological Masking with Graph Random Features"><span class="ltx_text ltx_ref_tag">21</span></a> still simulates random walks and records their destinations, giving an empirical measure of the overlap between respective nodes’ neighborhoods.
However, in absence of dependence on <math alttext="\widetilde{\omega}(\omega)" class="ltx_Math" display="inline" id="A3.SS2.p3.4.m1.1"><semantics id="A3.SS2.p3.4.m1.1a"><mrow id="A3.SS2.p3.4.m1.1.2" xref="A3.SS2.p3.4.m1.1.2.cmml"><mover accent="true" id="A3.SS2.p3.4.m1.1.2.2" xref="A3.SS2.p3.4.m1.1.2.2.cmml"><mi id="A3.SS2.p3.4.m1.1.2.2.2" xref="A3.SS2.p3.4.m1.1.2.2.2.cmml">ω</mi><mo id="A3.SS2.p3.4.m1.1.2.2.1" xref="A3.SS2.p3.4.m1.1.2.2.1.cmml">~</mo></mover><mo id="A3.SS2.p3.4.m1.1.2.1" xref="A3.SS2.p3.4.m1.1.2.1.cmml">⁢</mo><mrow id="A3.SS2.p3.4.m1.1.2.3.2" xref="A3.SS2.p3.4.m1.1.2.cmml"><mo id="A3.SS2.p3.4.m1.1.2.3.2.1" stretchy="false" xref="A3.SS2.p3.4.m1.1.2.cmml">(</mo><mi id="A3.SS2.p3.4.m1.1.1" xref="A3.SS2.p3.4.m1.1.1.cmml">ω</mi><mo id="A3.SS2.p3.4.m1.1.2.3.2.2" stretchy="false" xref="A3.SS2.p3.4.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.SS2.p3.4.m1.1b"><apply id="A3.SS2.p3.4.m1.1.2.cmml" xref="A3.SS2.p3.4.m1.1.2"><times id="A3.SS2.p3.4.m1.1.2.1.cmml" xref="A3.SS2.p3.4.m1.1.2.1"></times><apply id="A3.SS2.p3.4.m1.1.2.2.cmml" xref="A3.SS2.p3.4.m1.1.2.2"><ci id="A3.SS2.p3.4.m1.1.2.2.1.cmml" xref="A3.SS2.p3.4.m1.1.2.2.1">~</ci><ci id="A3.SS2.p3.4.m1.1.2.2.2.cmml" xref="A3.SS2.p3.4.m1.1.2.2.2">𝜔</ci></apply><ci id="A3.SS2.p3.4.m1.1.1.cmml" xref="A3.SS2.p3.4.m1.1.1">𝜔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS2.p3.4.m1.1c">\widetilde{\omega}(\omega)</annotation><annotation encoding="application/x-llamapun" id="A3.SS2.p3.4.m1.1d">over~ start_ARG italic_ω end_ARG ( italic_ω )</annotation></semantics></math> and <math alttext="p(\omega)" class="ltx_Math" display="inline" id="A3.SS2.p3.5.m2.1"><semantics id="A3.SS2.p3.5.m2.1a"><mrow id="A3.SS2.p3.5.m2.1.2" xref="A3.SS2.p3.5.m2.1.2.cmml"><mi id="A3.SS2.p3.5.m2.1.2.2" xref="A3.SS2.p3.5.m2.1.2.2.cmml">p</mi><mo id="A3.SS2.p3.5.m2.1.2.1" xref="A3.SS2.p3.5.m2.1.2.1.cmml">⁢</mo><mrow id="A3.SS2.p3.5.m2.1.2.3.2" xref="A3.SS2.p3.5.m2.1.2.cmml"><mo id="A3.SS2.p3.5.m2.1.2.3.2.1" stretchy="false" xref="A3.SS2.p3.5.m2.1.2.cmml">(</mo><mi id="A3.SS2.p3.5.m2.1.1" xref="A3.SS2.p3.5.m2.1.1.cmml">ω</mi><mo id="A3.SS2.p3.5.m2.1.2.3.2.2" stretchy="false" xref="A3.SS2.p3.5.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.SS2.p3.5.m2.1b"><apply id="A3.SS2.p3.5.m2.1.2.cmml" xref="A3.SS2.p3.5.m2.1.2"><times id="A3.SS2.p3.5.m2.1.2.1.cmml" xref="A3.SS2.p3.5.m2.1.2.1"></times><ci id="A3.SS2.p3.5.m2.1.2.2.cmml" xref="A3.SS2.p3.5.m2.1.2.2">𝑝</ci><ci id="A3.SS2.p3.5.m2.1.1.cmml" xref="A3.SS2.p3.5.m2.1.1">𝜔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS2.p3.5.m2.1c">p(\omega)</annotation><annotation encoding="application/x-llamapun" id="A3.SS2.p3.5.m2.1d">italic_p ( italic_ω )</annotation></semantics></math> this cannot be interpreted as a MC estimate of a function of <math alttext="\mathbf{W}" class="ltx_Math" display="inline" id="A3.SS2.p3.6.m3.1"><semantics id="A3.SS2.p3.6.m3.1a"><mi id="A3.SS2.p3.6.m3.1.1" xref="A3.SS2.p3.6.m3.1.1.cmml">𝐖</mi><annotation-xml encoding="MathML-Content" id="A3.SS2.p3.6.m3.1b"><ci id="A3.SS2.p3.6.m3.1.1.cmml" xref="A3.SS2.p3.6.m3.1.1">𝐖</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.SS2.p3.6.m3.1c">\mathbf{W}</annotation><annotation encoding="application/x-llamapun" id="A3.SS2.p3.6.m3.1d">bold_W</annotation></semantics></math>.
This is similar to the approach employed by <cite class="ltx_cite ltx_citemacro_citet">Choromanski et&nbsp;al. [<a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#bib.bib7" title="">2022</a>]</cite> but with extra learnability via <math alttext="f" class="ltx_Math" display="inline" id="A3.SS2.p3.7.m4.1"><semantics id="A3.SS2.p3.7.m4.1a"><mi id="A3.SS2.p3.7.m4.1.1" xref="A3.SS2.p3.7.m4.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="A3.SS2.p3.7.m4.1b"><ci id="A3.SS2.p3.7.m4.1.1.cmml" xref="A3.SS2.p3.7.m4.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.SS2.p3.7.m4.1c">f</annotation><annotation encoding="application/x-llamapun" id="A3.SS2.p3.7.m4.1d">italic_f</annotation></semantics></math>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="A3.SS2.p4">
<p class="ltx_p" id="A3.SS2.p4.3">Comparing ViT performance with <math alttext="n=100" class="ltx_Math" display="inline" id="A3.SS2.p4.1.m1.1"><semantics id="A3.SS2.p4.1.m1.1a"><mrow id="A3.SS2.p4.1.m1.1.1" xref="A3.SS2.p4.1.m1.1.1.cmml"><mi id="A3.SS2.p4.1.m1.1.1.2" xref="A3.SS2.p4.1.m1.1.1.2.cmml">n</mi><mo id="A3.SS2.p4.1.m1.1.1.1" xref="A3.SS2.p4.1.m1.1.1.1.cmml">=</mo><mn id="A3.SS2.p4.1.m1.1.1.3" xref="A3.SS2.p4.1.m1.1.1.3.cmml">100</mn></mrow><annotation-xml encoding="MathML-Content" id="A3.SS2.p4.1.m1.1b"><apply id="A3.SS2.p4.1.m1.1.1.cmml" xref="A3.SS2.p4.1.m1.1.1"><eq id="A3.SS2.p4.1.m1.1.1.1.cmml" xref="A3.SS2.p4.1.m1.1.1.1"></eq><ci id="A3.SS2.p4.1.m1.1.1.2.cmml" xref="A3.SS2.p4.1.m1.1.1.2">𝑛</ci><cn id="A3.SS2.p4.1.m1.1.1.3.cmml" type="integer" xref="A3.SS2.p4.1.m1.1.1.3">100</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS2.p4.1.m1.1c">n=100</annotation><annotation encoding="application/x-llamapun" id="A3.SS2.p4.1.m1.1d">italic_n = 100</annotation></semantics></math> random walks and <math alttext="p_{\textrm{halt}}=0.5" class="ltx_Math" display="inline" id="A3.SS2.p4.2.m2.1"><semantics id="A3.SS2.p4.2.m2.1a"><mrow id="A3.SS2.p4.2.m2.1.1" xref="A3.SS2.p4.2.m2.1.1.cmml"><msub id="A3.SS2.p4.2.m2.1.1.2" xref="A3.SS2.p4.2.m2.1.1.2.cmml"><mi id="A3.SS2.p4.2.m2.1.1.2.2" xref="A3.SS2.p4.2.m2.1.1.2.2.cmml">p</mi><mtext id="A3.SS2.p4.2.m2.1.1.2.3" xref="A3.SS2.p4.2.m2.1.1.2.3a.cmml">halt</mtext></msub><mo id="A3.SS2.p4.2.m2.1.1.1" xref="A3.SS2.p4.2.m2.1.1.1.cmml">=</mo><mn id="A3.SS2.p4.2.m2.1.1.3" xref="A3.SS2.p4.2.m2.1.1.3.cmml">0.5</mn></mrow><annotation-xml encoding="MathML-Content" id="A3.SS2.p4.2.m2.1b"><apply id="A3.SS2.p4.2.m2.1.1.cmml" xref="A3.SS2.p4.2.m2.1.1"><eq id="A3.SS2.p4.2.m2.1.1.1.cmml" xref="A3.SS2.p4.2.m2.1.1.1"></eq><apply id="A3.SS2.p4.2.m2.1.1.2.cmml" xref="A3.SS2.p4.2.m2.1.1.2"><csymbol cd="ambiguous" id="A3.SS2.p4.2.m2.1.1.2.1.cmml" xref="A3.SS2.p4.2.m2.1.1.2">subscript</csymbol><ci id="A3.SS2.p4.2.m2.1.1.2.2.cmml" xref="A3.SS2.p4.2.m2.1.1.2.2">𝑝</ci><ci id="A3.SS2.p4.2.m2.1.1.2.3a.cmml" xref="A3.SS2.p4.2.m2.1.1.2.3"><mtext id="A3.SS2.p4.2.m2.1.1.2.3.cmml" mathsize="70%" xref="A3.SS2.p4.2.m2.1.1.2.3">halt</mtext></ci></apply><cn id="A3.SS2.p4.2.m2.1.1.3.cmml" type="float" xref="A3.SS2.p4.2.m2.1.1.3">0.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS2.p4.2.m2.1c">p_{\textrm{halt}}=0.5</annotation><annotation encoding="application/x-llamapun" id="A3.SS2.p4.2.m2.1d">italic_p start_POSTSUBSCRIPT halt end_POSTSUBSCRIPT = 0.5</annotation></semantics></math>, the results are striking; see Table <a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#A3.T3" title="Table 3 ‣ C.2 ViT ablations ‣ Appendix C Further experiments and details ‣ Linear Transformer Topological Masking with Graph Random Features"><span class="ltx_text ltx_ref_tag">3</span></a>.
In contrast to our method, the mask defined by Eq.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#A3.E21" title="In C.2 ViT ablations ‣ Appendix C Further experiments and details ‣ Linear Transformer Topological Masking with Graph Random Features"><span class="ltx_text ltx_ref_tag">21</span></a> is <em class="ltx_emph ltx_font_italic" id="A3.SS2.p4.3.1">worse than the unmasked baseline</em>.
This shows the crucial importance of the theory in Sec.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#S3.SS4" title="3.4 Novel theoretical results for GRFs: sharp estimators with sparse features ‣ 3 Towards linear topological masking ‣ Linear Transformer Topological Masking with Graph Random Features"><span class="ltx_text ltx_ref_tag">3.4</span></a>.
Intuitively, without upweighting long, improbable walks by <math alttext="p(\omega)^{-1}" class="ltx_Math" display="inline" id="A3.SS2.p4.3.m3.1"><semantics id="A3.SS2.p4.3.m3.1a"><mrow id="A3.SS2.p4.3.m3.1.2" xref="A3.SS2.p4.3.m3.1.2.cmml"><mi id="A3.SS2.p4.3.m3.1.2.2" xref="A3.SS2.p4.3.m3.1.2.2.cmml">p</mi><mo id="A3.SS2.p4.3.m3.1.2.1" xref="A3.SS2.p4.3.m3.1.2.1.cmml">⁢</mo><msup id="A3.SS2.p4.3.m3.1.2.3" xref="A3.SS2.p4.3.m3.1.2.3.cmml"><mrow id="A3.SS2.p4.3.m3.1.2.3.2.2" xref="A3.SS2.p4.3.m3.1.2.3.cmml"><mo id="A3.SS2.p4.3.m3.1.2.3.2.2.1" stretchy="false" xref="A3.SS2.p4.3.m3.1.2.3.cmml">(</mo><mi id="A3.SS2.p4.3.m3.1.1" xref="A3.SS2.p4.3.m3.1.1.cmml">ω</mi><mo id="A3.SS2.p4.3.m3.1.2.3.2.2.2" stretchy="false" xref="A3.SS2.p4.3.m3.1.2.3.cmml">)</mo></mrow><mrow id="A3.SS2.p4.3.m3.1.2.3.3" xref="A3.SS2.p4.3.m3.1.2.3.3.cmml"><mo id="A3.SS2.p4.3.m3.1.2.3.3a" xref="A3.SS2.p4.3.m3.1.2.3.3.cmml">−</mo><mn id="A3.SS2.p4.3.m3.1.2.3.3.2" xref="A3.SS2.p4.3.m3.1.2.3.3.2.cmml">1</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A3.SS2.p4.3.m3.1b"><apply id="A3.SS2.p4.3.m3.1.2.cmml" xref="A3.SS2.p4.3.m3.1.2"><times id="A3.SS2.p4.3.m3.1.2.1.cmml" xref="A3.SS2.p4.3.m3.1.2.1"></times><ci id="A3.SS2.p4.3.m3.1.2.2.cmml" xref="A3.SS2.p4.3.m3.1.2.2">𝑝</ci><apply id="A3.SS2.p4.3.m3.1.2.3.cmml" xref="A3.SS2.p4.3.m3.1.2.3"><csymbol cd="ambiguous" id="A3.SS2.p4.3.m3.1.2.3.1.cmml" xref="A3.SS2.p4.3.m3.1.2.3">superscript</csymbol><ci id="A3.SS2.p4.3.m3.1.1.cmml" xref="A3.SS2.p4.3.m3.1.1">𝜔</ci><apply id="A3.SS2.p4.3.m3.1.2.3.3.cmml" xref="A3.SS2.p4.3.m3.1.2.3.3"><minus id="A3.SS2.p4.3.m3.1.2.3.3.1.cmml" xref="A3.SS2.p4.3.m3.1.2.3.3"></minus><cn id="A3.SS2.p4.3.m3.1.2.3.3.2.cmml" type="integer" xref="A3.SS2.p4.3.m3.1.2.3.3.2">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS2.p4.3.m3.1c">p(\omega)^{-1}</annotation><annotation encoding="application/x-llamapun" id="A3.SS2.p4.3.m3.1d">italic_p ( italic_ω ) start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT</annotation></semantics></math> it is difficult to capture long-range dependencies in the topological mask.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="A3.SS2.p5">
<p class="ltx_p" id="A3.SS2.p5.6"><span class="ltx_text ltx_font_bold" id="A3.SS2.p5.6.1">Fully learnable features.</span>
As a final check, we endow each graph with a fully learnable, dense <math alttext="N" class="ltx_Math" display="inline" id="A3.SS2.p5.1.m1.1"><semantics id="A3.SS2.p5.1.m1.1a"><mi id="A3.SS2.p5.1.m1.1.1" xref="A3.SS2.p5.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="A3.SS2.p5.1.m1.1b"><ci id="A3.SS2.p5.1.m1.1.1.cmml" xref="A3.SS2.p5.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.SS2.p5.1.m1.1c">N</annotation><annotation encoding="application/x-llamapun" id="A3.SS2.p5.1.m1.1d">italic_N</annotation></semantics></math>-dimensional feature <math alttext="\phi_{\textrm{dense, learned}}(v_{i})\in\mathbb{R}^{N}" class="ltx_Math" display="inline" id="A3.SS2.p5.2.m2.1"><semantics id="A3.SS2.p5.2.m2.1a"><mrow id="A3.SS2.p5.2.m2.1.1" xref="A3.SS2.p5.2.m2.1.1.cmml"><mrow id="A3.SS2.p5.2.m2.1.1.1" xref="A3.SS2.p5.2.m2.1.1.1.cmml"><msub id="A3.SS2.p5.2.m2.1.1.1.3" xref="A3.SS2.p5.2.m2.1.1.1.3.cmml"><mi id="A3.SS2.p5.2.m2.1.1.1.3.2" xref="A3.SS2.p5.2.m2.1.1.1.3.2.cmml">ϕ</mi><mtext id="A3.SS2.p5.2.m2.1.1.1.3.3" xref="A3.SS2.p5.2.m2.1.1.1.3.3a.cmml">dense, learned</mtext></msub><mo id="A3.SS2.p5.2.m2.1.1.1.2" xref="A3.SS2.p5.2.m2.1.1.1.2.cmml">⁢</mo><mrow id="A3.SS2.p5.2.m2.1.1.1.1.1" xref="A3.SS2.p5.2.m2.1.1.1.1.1.1.cmml"><mo id="A3.SS2.p5.2.m2.1.1.1.1.1.2" stretchy="false" xref="A3.SS2.p5.2.m2.1.1.1.1.1.1.cmml">(</mo><msub id="A3.SS2.p5.2.m2.1.1.1.1.1.1" xref="A3.SS2.p5.2.m2.1.1.1.1.1.1.cmml"><mi id="A3.SS2.p5.2.m2.1.1.1.1.1.1.2" xref="A3.SS2.p5.2.m2.1.1.1.1.1.1.2.cmml">v</mi><mi id="A3.SS2.p5.2.m2.1.1.1.1.1.1.3" xref="A3.SS2.p5.2.m2.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="A3.SS2.p5.2.m2.1.1.1.1.1.3" stretchy="false" xref="A3.SS2.p5.2.m2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A3.SS2.p5.2.m2.1.1.2" xref="A3.SS2.p5.2.m2.1.1.2.cmml">∈</mo><msup id="A3.SS2.p5.2.m2.1.1.3" xref="A3.SS2.p5.2.m2.1.1.3.cmml"><mi id="A3.SS2.p5.2.m2.1.1.3.2" xref="A3.SS2.p5.2.m2.1.1.3.2.cmml">ℝ</mi><mi id="A3.SS2.p5.2.m2.1.1.3.3" xref="A3.SS2.p5.2.m2.1.1.3.3.cmml">N</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="A3.SS2.p5.2.m2.1b"><apply id="A3.SS2.p5.2.m2.1.1.cmml" xref="A3.SS2.p5.2.m2.1.1"><in id="A3.SS2.p5.2.m2.1.1.2.cmml" xref="A3.SS2.p5.2.m2.1.1.2"></in><apply id="A3.SS2.p5.2.m2.1.1.1.cmml" xref="A3.SS2.p5.2.m2.1.1.1"><times id="A3.SS2.p5.2.m2.1.1.1.2.cmml" xref="A3.SS2.p5.2.m2.1.1.1.2"></times><apply id="A3.SS2.p5.2.m2.1.1.1.3.cmml" xref="A3.SS2.p5.2.m2.1.1.1.3"><csymbol cd="ambiguous" id="A3.SS2.p5.2.m2.1.1.1.3.1.cmml" xref="A3.SS2.p5.2.m2.1.1.1.3">subscript</csymbol><ci id="A3.SS2.p5.2.m2.1.1.1.3.2.cmml" xref="A3.SS2.p5.2.m2.1.1.1.3.2">italic-ϕ</ci><ci id="A3.SS2.p5.2.m2.1.1.1.3.3a.cmml" xref="A3.SS2.p5.2.m2.1.1.1.3.3"><mtext id="A3.SS2.p5.2.m2.1.1.1.3.3.cmml" mathsize="70%" xref="A3.SS2.p5.2.m2.1.1.1.3.3">dense, learned</mtext></ci></apply><apply id="A3.SS2.p5.2.m2.1.1.1.1.1.1.cmml" xref="A3.SS2.p5.2.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="A3.SS2.p5.2.m2.1.1.1.1.1.1.1.cmml" xref="A3.SS2.p5.2.m2.1.1.1.1.1">subscript</csymbol><ci id="A3.SS2.p5.2.m2.1.1.1.1.1.1.2.cmml" xref="A3.SS2.p5.2.m2.1.1.1.1.1.1.2">𝑣</ci><ci id="A3.SS2.p5.2.m2.1.1.1.1.1.1.3.cmml" xref="A3.SS2.p5.2.m2.1.1.1.1.1.1.3">𝑖</ci></apply></apply><apply id="A3.SS2.p5.2.m2.1.1.3.cmml" xref="A3.SS2.p5.2.m2.1.1.3"><csymbol cd="ambiguous" id="A3.SS2.p5.2.m2.1.1.3.1.cmml" xref="A3.SS2.p5.2.m2.1.1.3">superscript</csymbol><ci id="A3.SS2.p5.2.m2.1.1.3.2.cmml" xref="A3.SS2.p5.2.m2.1.1.3.2">ℝ</ci><ci id="A3.SS2.p5.2.m2.1.1.3.3.cmml" xref="A3.SS2.p5.2.m2.1.1.3.3">𝑁</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS2.p5.2.m2.1c">\phi_{\textrm{dense, learned}}(v_{i})\in\mathbb{R}^{N}</annotation><annotation encoding="application/x-llamapun" id="A3.SS2.p5.2.m2.1d">italic_ϕ start_POSTSUBSCRIPT dense, learned end_POSTSUBSCRIPT ( italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) ∈ blackboard_R start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT</annotation></semantics></math>, relaxing the parameterisation as a function of a weighted adjacency matrix <math alttext="\mathbf{M}_{\alpha}(\mathcal{G})" class="ltx_Math" display="inline" id="A3.SS2.p5.3.m3.1"><semantics id="A3.SS2.p5.3.m3.1a"><mrow id="A3.SS2.p5.3.m3.1.2" xref="A3.SS2.p5.3.m3.1.2.cmml"><msub id="A3.SS2.p5.3.m3.1.2.2" xref="A3.SS2.p5.3.m3.1.2.2.cmml"><mi id="A3.SS2.p5.3.m3.1.2.2.2" xref="A3.SS2.p5.3.m3.1.2.2.2.cmml">𝐌</mi><mi id="A3.SS2.p5.3.m3.1.2.2.3" xref="A3.SS2.p5.3.m3.1.2.2.3.cmml">α</mi></msub><mo id="A3.SS2.p5.3.m3.1.2.1" xref="A3.SS2.p5.3.m3.1.2.1.cmml">⁢</mo><mrow id="A3.SS2.p5.3.m3.1.2.3.2" xref="A3.SS2.p5.3.m3.1.2.cmml"><mo id="A3.SS2.p5.3.m3.1.2.3.2.1" stretchy="false" xref="A3.SS2.p5.3.m3.1.2.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="A3.SS2.p5.3.m3.1.1" xref="A3.SS2.p5.3.m3.1.1.cmml">𝒢</mi><mo id="A3.SS2.p5.3.m3.1.2.3.2.2" stretchy="false" xref="A3.SS2.p5.3.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.SS2.p5.3.m3.1b"><apply id="A3.SS2.p5.3.m3.1.2.cmml" xref="A3.SS2.p5.3.m3.1.2"><times id="A3.SS2.p5.3.m3.1.2.1.cmml" xref="A3.SS2.p5.3.m3.1.2.1"></times><apply id="A3.SS2.p5.3.m3.1.2.2.cmml" xref="A3.SS2.p5.3.m3.1.2.2"><csymbol cd="ambiguous" id="A3.SS2.p5.3.m3.1.2.2.1.cmml" xref="A3.SS2.p5.3.m3.1.2.2">subscript</csymbol><ci id="A3.SS2.p5.3.m3.1.2.2.2.cmml" xref="A3.SS2.p5.3.m3.1.2.2.2">𝐌</ci><ci id="A3.SS2.p5.3.m3.1.2.2.3.cmml" xref="A3.SS2.p5.3.m3.1.2.2.3">𝛼</ci></apply><ci id="A3.SS2.p5.3.m3.1.1.cmml" xref="A3.SS2.p5.3.m3.1.1">𝒢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS2.p5.3.m3.1c">\mathbf{M}_{\alpha}(\mathcal{G})</annotation><annotation encoding="application/x-llamapun" id="A3.SS2.p5.3.m3.1d">bold_M start_POSTSUBSCRIPT italic_α end_POSTSUBSCRIPT ( caligraphic_G )</annotation></semantics></math>.
This uses many more parameters and is <math alttext="\mathcal{O}(N^{2})" class="ltx_Math" display="inline" id="A3.SS2.p5.4.m4.1"><semantics id="A3.SS2.p5.4.m4.1a"><mrow id="A3.SS2.p5.4.m4.1.1" xref="A3.SS2.p5.4.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A3.SS2.p5.4.m4.1.1.3" xref="A3.SS2.p5.4.m4.1.1.3.cmml">𝒪</mi><mo id="A3.SS2.p5.4.m4.1.1.2" xref="A3.SS2.p5.4.m4.1.1.2.cmml">⁢</mo><mrow id="A3.SS2.p5.4.m4.1.1.1.1" xref="A3.SS2.p5.4.m4.1.1.1.1.1.cmml"><mo id="A3.SS2.p5.4.m4.1.1.1.1.2" stretchy="false" xref="A3.SS2.p5.4.m4.1.1.1.1.1.cmml">(</mo><msup id="A3.SS2.p5.4.m4.1.1.1.1.1" xref="A3.SS2.p5.4.m4.1.1.1.1.1.cmml"><mi id="A3.SS2.p5.4.m4.1.1.1.1.1.2" xref="A3.SS2.p5.4.m4.1.1.1.1.1.2.cmml">N</mi><mn id="A3.SS2.p5.4.m4.1.1.1.1.1.3" xref="A3.SS2.p5.4.m4.1.1.1.1.1.3.cmml">2</mn></msup><mo id="A3.SS2.p5.4.m4.1.1.1.1.3" stretchy="false" xref="A3.SS2.p5.4.m4.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.SS2.p5.4.m4.1b"><apply id="A3.SS2.p5.4.m4.1.1.cmml" xref="A3.SS2.p5.4.m4.1.1"><times id="A3.SS2.p5.4.m4.1.1.2.cmml" xref="A3.SS2.p5.4.m4.1.1.2"></times><ci id="A3.SS2.p5.4.m4.1.1.3.cmml" xref="A3.SS2.p5.4.m4.1.1.3">𝒪</ci><apply id="A3.SS2.p5.4.m4.1.1.1.1.1.cmml" xref="A3.SS2.p5.4.m4.1.1.1.1"><csymbol cd="ambiguous" id="A3.SS2.p5.4.m4.1.1.1.1.1.1.cmml" xref="A3.SS2.p5.4.m4.1.1.1.1">superscript</csymbol><ci id="A3.SS2.p5.4.m4.1.1.1.1.1.2.cmml" xref="A3.SS2.p5.4.m4.1.1.1.1.1.2">𝑁</ci><cn id="A3.SS2.p5.4.m4.1.1.1.1.1.3.cmml" type="integer" xref="A3.SS2.p5.4.m4.1.1.1.1.1.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS2.p5.4.m4.1c">\mathcal{O}(N^{2})</annotation><annotation encoding="application/x-llamapun" id="A3.SS2.p5.4.m4.1d">caligraphic_O ( italic_N start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT )</annotation></semantics></math> rather than <math alttext="\mathcal{O}(N)" class="ltx_Math" display="inline" id="A3.SS2.p5.5.m5.1"><semantics id="A3.SS2.p5.5.m5.1a"><mrow id="A3.SS2.p5.5.m5.1.2" xref="A3.SS2.p5.5.m5.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="A3.SS2.p5.5.m5.1.2.2" xref="A3.SS2.p5.5.m5.1.2.2.cmml">𝒪</mi><mo id="A3.SS2.p5.5.m5.1.2.1" xref="A3.SS2.p5.5.m5.1.2.1.cmml">⁢</mo><mrow id="A3.SS2.p5.5.m5.1.2.3.2" xref="A3.SS2.p5.5.m5.1.2.cmml"><mo id="A3.SS2.p5.5.m5.1.2.3.2.1" stretchy="false" xref="A3.SS2.p5.5.m5.1.2.cmml">(</mo><mi id="A3.SS2.p5.5.m5.1.1" xref="A3.SS2.p5.5.m5.1.1.cmml">N</mi><mo id="A3.SS2.p5.5.m5.1.2.3.2.2" stretchy="false" xref="A3.SS2.p5.5.m5.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.SS2.p5.5.m5.1b"><apply id="A3.SS2.p5.5.m5.1.2.cmml" xref="A3.SS2.p5.5.m5.1.2"><times id="A3.SS2.p5.5.m5.1.2.1.cmml" xref="A3.SS2.p5.5.m5.1.2.1"></times><ci id="A3.SS2.p5.5.m5.1.2.2.cmml" xref="A3.SS2.p5.5.m5.1.2.2">𝒪</ci><ci id="A3.SS2.p5.5.m5.1.1.cmml" xref="A3.SS2.p5.5.m5.1.1">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS2.p5.5.m5.1c">\mathcal{O}(N)</annotation><annotation encoding="application/x-llamapun" id="A3.SS2.p5.5.m5.1d">caligraphic_O ( italic_N )</annotation></semantics></math>, but it technically includes GRFs as a special case.
In making this choice we have removed all structural inductive bias from <math alttext="\mathcal{G}" class="ltx_Math" display="inline" id="A3.SS2.p5.6.m6.1"><semantics id="A3.SS2.p5.6.m6.1a"><mi class="ltx_font_mathcaligraphic" id="A3.SS2.p5.6.m6.1.1" xref="A3.SS2.p5.6.m6.1.1.cmml">𝒢</mi><annotation-xml encoding="MathML-Content" id="A3.SS2.p5.6.m6.1b"><ci id="A3.SS2.p5.6.m6.1.1.cmml" xref="A3.SS2.p5.6.m6.1.1">𝒢</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.SS2.p5.6.m6.1c">\mathcal{G}</annotation><annotation encoding="application/x-llamapun" id="A3.SS2.p5.6.m6.1d">caligraphic_G</annotation></semantics></math>, allowing the model to implicitly learn a masking kernel without any constraints (except feature dimension).
The model performs badly, providing only a very slight improvement over the unmasked linear baseline.
See Table <a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#A3.T3" title="Table 3 ‣ C.2 ViT ablations ‣ Appendix C Further experiments and details ‣ Linear Transformer Topological Masking with Graph Random Features"><span class="ltx_text ltx_ref_tag">3</span></a>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_figure ltx_minipage ltx_align_middle" id="A3.F6" style="width:198.7pt;">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 6: </span>Final test accuracy vs. number of walkers <math alttext="n" class="ltx_Math" display="inline" id="A3.F6.2.m1.1"><semantics id="A3.F6.2.m1.1b"><mi id="A3.F6.2.m1.1.1" xref="A3.F6.2.m1.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="A3.F6.2.m1.1c"><ci id="A3.F6.2.m1.1.1.cmml" xref="A3.F6.2.m1.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.F6.2.m1.1d">n</annotation><annotation encoding="application/x-llamapun" id="A3.F6.2.m1.1e">italic_n</annotation></semantics></math>.
Monte Carlo mask variance drops with the number of walks so predictions improve.</figcaption><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="515" id="A3.F6.g1" src="https://arxiv.org/html/2410.03462v1/x3.png" width="665">
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_table ltx_minipage ltx_align_middle" id="A3.T3" style="width:198.7pt;">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 3: </span>
Ablation studies. Importance sampling of random walks and mask parameterisation as a function of <math alttext="\mathbf{W}" class="ltx_Math" display="inline" id="A3.T3.2.m1.1"><semantics id="A3.T3.2.m1.1b"><mi id="A3.T3.2.m1.1.1" xref="A3.T3.2.m1.1.1.cmml">𝐖</mi><annotation-xml encoding="MathML-Content" id="A3.T3.2.m1.1c"><ci id="A3.T3.2.m1.1.1.cmml" xref="A3.T3.2.m1.1.1">𝐖</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.T3.2.m1.1d">\mathbf{W}</annotation><annotation encoding="application/x-llamapun" id="A3.T3.2.m1.1e">bold_W</annotation></semantics></math> are crucial for good performance.</figcaption>
<br class="ltx_break">
<table class="ltx_tabular ltx_centering ltx_align_middle" id="A3.T3.3">
<tbody><tr class="ltx_tr" id="A3.T3.3.1">
<td class="ltx_td ltx_align_center ltx_border_r" id="A3.T3.3.1.1" style="padding-left:3.0pt;padding-right:3.0pt;">Variant</td>
<td class="ltx_td ltx_align_center" id="A3.T3.3.1.2" style="padding-left:3.0pt;padding-right:3.0pt;">Test acc.</td>
</tr>
<tr class="ltx_tr" id="A3.T3.3.2">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A3.T3.3.2.1" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="A3.T3.3.2.1.1">GRF-masked</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A3.T3.3.2.2" style="padding-left:3.0pt;padding-right:3.0pt;">0.730</td>
</tr>
<tr class="ltx_tr" id="A3.T3.3.3">
<td class="ltx_td ltx_align_center ltx_border_r" id="A3.T3.3.3.1" style="padding-left:3.0pt;padding-right:3.0pt;">Unmasked</td>
<td class="ltx_td ltx_align_center" id="A3.T3.3.3.2" style="padding-left:3.0pt;padding-right:3.0pt;">0.693</td>
</tr>
<tr class="ltx_tr" id="A3.T3.3.4">
<td class="ltx_td ltx_align_center ltx_border_r" id="A3.T3.3.4.1" style="padding-left:3.0pt;padding-right:3.0pt;">Ad-hoc masked (Eq.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#A3.E21" title="In C.2 ViT ablations ‣ Appendix C Further experiments and details ‣ Linear Transformer Topological Masking with Graph Random Features"><span class="ltx_text ltx_ref_tag">21</span></a>)</td>
<td class="ltx_td ltx_align_center" id="A3.T3.3.4.2" style="padding-left:3.0pt;padding-right:3.0pt;">0.689</td>
</tr>
<tr class="ltx_tr" id="A3.T3.3.5">
<td class="ltx_td ltx_align_center ltx_border_r" id="A3.T3.3.5.1" style="padding-left:3.0pt;padding-right:3.0pt;">Fully learnable features</td>
<td class="ltx_td ltx_align_center" id="A3.T3.3.5.2" style="padding-left:3.0pt;padding-right:3.0pt;">0.696</td>
</tr>
</tbody></table>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</section>
<section class="ltx_subsection" id="A3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">C.3 </span>HD-VPD experimental details</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="A3.SS3.p1">
<p class="ltx_p" id="A3.SS3.p1.1">Here, we describe the high density visual particle dynamics (HD-VPD) experiment from Sec.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#S4" title="4 Experiments ‣ Linear Transformer Topological Masking with Graph Random Features"><span class="ltx_text ltx_ref_tag">4</span></a> in more detail.
The setup closely follows that of <cite class="ltx_cite ltx_citemacro_citep">[Whitney et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#bib.bib38" title="">2024</a>]</cite>, to which we direct the interested reader for an exhaustive information about hardware and modelling techniques.
We will provide a brief overview for convenience.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="A3.SS3.p2">
<p class="ltx_p" id="A3.SS3.p2.2"><span class="ltx_text ltx_font_bold" id="A3.SS3.p2.2.1">Dynamics modelling as video prediction.</span>
The HD-VPD stack involves three steps: (1) encode the input images as 3D point clouds; (2) predict updates to the point clouds, conditioned on robot actions; (3) render the predicted new state into an image.
We train end-to-end using video prediction loss.
In more detail:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<ol class="ltx_enumerate" id="A3.I1">
<li class="ltx_item" id="A3.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span>
<div class="ltx_para" id="A3.I1.i1.p1">
<p class="ltx_p" id="A3.I1.i1.p1.7"><em class="ltx_emph ltx_font_italic" id="A3.I1.i1.p1.7.1">Encode the input images.</em> The model receives two RGB-D (colour channels plus depth) images at times <math alttext="t-1" class="ltx_Math" display="inline" id="A3.I1.i1.p1.1.m1.1"><semantics id="A3.I1.i1.p1.1.m1.1a"><mrow id="A3.I1.i1.p1.1.m1.1.1" xref="A3.I1.i1.p1.1.m1.1.1.cmml"><mi id="A3.I1.i1.p1.1.m1.1.1.2" xref="A3.I1.i1.p1.1.m1.1.1.2.cmml">t</mi><mo id="A3.I1.i1.p1.1.m1.1.1.1" xref="A3.I1.i1.p1.1.m1.1.1.1.cmml">−</mo><mn id="A3.I1.i1.p1.1.m1.1.1.3" xref="A3.I1.i1.p1.1.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="A3.I1.i1.p1.1.m1.1b"><apply id="A3.I1.i1.p1.1.m1.1.1.cmml" xref="A3.I1.i1.p1.1.m1.1.1"><minus id="A3.I1.i1.p1.1.m1.1.1.1.cmml" xref="A3.I1.i1.p1.1.m1.1.1.1"></minus><ci id="A3.I1.i1.p1.1.m1.1.1.2.cmml" xref="A3.I1.i1.p1.1.m1.1.1.2">𝑡</ci><cn id="A3.I1.i1.p1.1.m1.1.1.3.cmml" type="integer" xref="A3.I1.i1.p1.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.I1.i1.p1.1.m1.1c">t-1</annotation><annotation encoding="application/x-llamapun" id="A3.I1.i1.p1.1.m1.1d">italic_t - 1</annotation></semantics></math>, <math alttext="t-2" class="ltx_Math" display="inline" id="A3.I1.i1.p1.2.m2.1"><semantics id="A3.I1.i1.p1.2.m2.1a"><mrow id="A3.I1.i1.p1.2.m2.1.1" xref="A3.I1.i1.p1.2.m2.1.1.cmml"><mi id="A3.I1.i1.p1.2.m2.1.1.2" xref="A3.I1.i1.p1.2.m2.1.1.2.cmml">t</mi><mo id="A3.I1.i1.p1.2.m2.1.1.1" xref="A3.I1.i1.p1.2.m2.1.1.1.cmml">−</mo><mn id="A3.I1.i1.p1.2.m2.1.1.3" xref="A3.I1.i1.p1.2.m2.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="A3.I1.i1.p1.2.m2.1b"><apply id="A3.I1.i1.p1.2.m2.1.1.cmml" xref="A3.I1.i1.p1.2.m2.1.1"><minus id="A3.I1.i1.p1.2.m2.1.1.1.cmml" xref="A3.I1.i1.p1.2.m2.1.1.1"></minus><ci id="A3.I1.i1.p1.2.m2.1.1.2.cmml" xref="A3.I1.i1.p1.2.m2.1.1.2">𝑡</ci><cn id="A3.I1.i1.p1.2.m2.1.1.3.cmml" type="integer" xref="A3.I1.i1.p1.2.m2.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.I1.i1.p1.2.m2.1c">t-2</annotation><annotation encoding="application/x-llamapun" id="A3.I1.i1.p1.2.m2.1d">italic_t - 2</annotation></semantics></math>.
Each RGB image is encoded into per-pixel features using a U-Net <cite class="ltx_cite ltx_citemacro_citep">[Ronneberger et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#bib.bib31" title="">2015</a>]</cite>, and unprojected using known camera intrinsics and extrinsics to a point cloud <math alttext="(\bm{x}_{i},\bm{f}_{i})_{i=1}^{N_{\textrm{pixels}}}" class="ltx_Math" display="inline" id="A3.I1.i1.p1.3.m3.2"><semantics id="A3.I1.i1.p1.3.m3.2a"><msubsup id="A3.I1.i1.p1.3.m3.2.2" xref="A3.I1.i1.p1.3.m3.2.2.cmml"><mrow id="A3.I1.i1.p1.3.m3.2.2.2.2.2" xref="A3.I1.i1.p1.3.m3.2.2.2.2.3.cmml"><mo id="A3.I1.i1.p1.3.m3.2.2.2.2.2.3" stretchy="false" xref="A3.I1.i1.p1.3.m3.2.2.2.2.3.cmml">(</mo><msub id="A3.I1.i1.p1.3.m3.1.1.1.1.1.1" xref="A3.I1.i1.p1.3.m3.1.1.1.1.1.1.cmml"><mi id="A3.I1.i1.p1.3.m3.1.1.1.1.1.1.2" xref="A3.I1.i1.p1.3.m3.1.1.1.1.1.1.2.cmml">𝒙</mi><mi id="A3.I1.i1.p1.3.m3.1.1.1.1.1.1.3" xref="A3.I1.i1.p1.3.m3.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="A3.I1.i1.p1.3.m3.2.2.2.2.2.4" xref="A3.I1.i1.p1.3.m3.2.2.2.2.3.cmml">,</mo><msub id="A3.I1.i1.p1.3.m3.2.2.2.2.2.2" xref="A3.I1.i1.p1.3.m3.2.2.2.2.2.2.cmml"><mi id="A3.I1.i1.p1.3.m3.2.2.2.2.2.2.2" xref="A3.I1.i1.p1.3.m3.2.2.2.2.2.2.2.cmml">𝒇</mi><mi id="A3.I1.i1.p1.3.m3.2.2.2.2.2.2.3" xref="A3.I1.i1.p1.3.m3.2.2.2.2.2.2.3.cmml">i</mi></msub><mo id="A3.I1.i1.p1.3.m3.2.2.2.2.2.5" stretchy="false" xref="A3.I1.i1.p1.3.m3.2.2.2.2.3.cmml">)</mo></mrow><mrow id="A3.I1.i1.p1.3.m3.2.2.2.4" xref="A3.I1.i1.p1.3.m3.2.2.2.4.cmml"><mi id="A3.I1.i1.p1.3.m3.2.2.2.4.2" xref="A3.I1.i1.p1.3.m3.2.2.2.4.2.cmml">i</mi><mo id="A3.I1.i1.p1.3.m3.2.2.2.4.1" xref="A3.I1.i1.p1.3.m3.2.2.2.4.1.cmml">=</mo><mn id="A3.I1.i1.p1.3.m3.2.2.2.4.3" xref="A3.I1.i1.p1.3.m3.2.2.2.4.3.cmml">1</mn></mrow><msub id="A3.I1.i1.p1.3.m3.2.2.4" xref="A3.I1.i1.p1.3.m3.2.2.4.cmml"><mi id="A3.I1.i1.p1.3.m3.2.2.4.2" xref="A3.I1.i1.p1.3.m3.2.2.4.2.cmml">N</mi><mtext id="A3.I1.i1.p1.3.m3.2.2.4.3" xref="A3.I1.i1.p1.3.m3.2.2.4.3a.cmml">pixels</mtext></msub></msubsup><annotation-xml encoding="MathML-Content" id="A3.I1.i1.p1.3.m3.2b"><apply id="A3.I1.i1.p1.3.m3.2.2.cmml" xref="A3.I1.i1.p1.3.m3.2.2"><csymbol cd="ambiguous" id="A3.I1.i1.p1.3.m3.2.2.3.cmml" xref="A3.I1.i1.p1.3.m3.2.2">superscript</csymbol><apply id="A3.I1.i1.p1.3.m3.2.2.2.cmml" xref="A3.I1.i1.p1.3.m3.2.2"><csymbol cd="ambiguous" id="A3.I1.i1.p1.3.m3.2.2.2.3.cmml" xref="A3.I1.i1.p1.3.m3.2.2">subscript</csymbol><interval closure="open" id="A3.I1.i1.p1.3.m3.2.2.2.2.3.cmml" xref="A3.I1.i1.p1.3.m3.2.2.2.2.2"><apply id="A3.I1.i1.p1.3.m3.1.1.1.1.1.1.cmml" xref="A3.I1.i1.p1.3.m3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A3.I1.i1.p1.3.m3.1.1.1.1.1.1.1.cmml" xref="A3.I1.i1.p1.3.m3.1.1.1.1.1.1">subscript</csymbol><ci id="A3.I1.i1.p1.3.m3.1.1.1.1.1.1.2.cmml" xref="A3.I1.i1.p1.3.m3.1.1.1.1.1.1.2">𝒙</ci><ci id="A3.I1.i1.p1.3.m3.1.1.1.1.1.1.3.cmml" xref="A3.I1.i1.p1.3.m3.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="A3.I1.i1.p1.3.m3.2.2.2.2.2.2.cmml" xref="A3.I1.i1.p1.3.m3.2.2.2.2.2.2"><csymbol cd="ambiguous" id="A3.I1.i1.p1.3.m3.2.2.2.2.2.2.1.cmml" xref="A3.I1.i1.p1.3.m3.2.2.2.2.2.2">subscript</csymbol><ci id="A3.I1.i1.p1.3.m3.2.2.2.2.2.2.2.cmml" xref="A3.I1.i1.p1.3.m3.2.2.2.2.2.2.2">𝒇</ci><ci id="A3.I1.i1.p1.3.m3.2.2.2.2.2.2.3.cmml" xref="A3.I1.i1.p1.3.m3.2.2.2.2.2.2.3">𝑖</ci></apply></interval><apply id="A3.I1.i1.p1.3.m3.2.2.2.4.cmml" xref="A3.I1.i1.p1.3.m3.2.2.2.4"><eq id="A3.I1.i1.p1.3.m3.2.2.2.4.1.cmml" xref="A3.I1.i1.p1.3.m3.2.2.2.4.1"></eq><ci id="A3.I1.i1.p1.3.m3.2.2.2.4.2.cmml" xref="A3.I1.i1.p1.3.m3.2.2.2.4.2">𝑖</ci><cn id="A3.I1.i1.p1.3.m3.2.2.2.4.3.cmml" type="integer" xref="A3.I1.i1.p1.3.m3.2.2.2.4.3">1</cn></apply></apply><apply id="A3.I1.i1.p1.3.m3.2.2.4.cmml" xref="A3.I1.i1.p1.3.m3.2.2.4"><csymbol cd="ambiguous" id="A3.I1.i1.p1.3.m3.2.2.4.1.cmml" xref="A3.I1.i1.p1.3.m3.2.2.4">subscript</csymbol><ci id="A3.I1.i1.p1.3.m3.2.2.4.2.cmml" xref="A3.I1.i1.p1.3.m3.2.2.4.2">𝑁</ci><ci id="A3.I1.i1.p1.3.m3.2.2.4.3a.cmml" xref="A3.I1.i1.p1.3.m3.2.2.4.3"><mtext id="A3.I1.i1.p1.3.m3.2.2.4.3.cmml" mathsize="50%" xref="A3.I1.i1.p1.3.m3.2.2.4.3">pixels</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.I1.i1.p1.3.m3.2c">(\bm{x}_{i},\bm{f}_{i})_{i=1}^{N_{\textrm{pixels}}}</annotation><annotation encoding="application/x-llamapun" id="A3.I1.i1.p1.3.m3.2d">( bold_italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , bold_italic_f start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N start_POSTSUBSCRIPT pixels end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> with <math alttext="\bm{x}\in\mathbb{R}^{3}" class="ltx_Math" display="inline" id="A3.I1.i1.p1.4.m4.1"><semantics id="A3.I1.i1.p1.4.m4.1a"><mrow id="A3.I1.i1.p1.4.m4.1.1" xref="A3.I1.i1.p1.4.m4.1.1.cmml"><mi id="A3.I1.i1.p1.4.m4.1.1.2" xref="A3.I1.i1.p1.4.m4.1.1.2.cmml">𝒙</mi><mo id="A3.I1.i1.p1.4.m4.1.1.1" xref="A3.I1.i1.p1.4.m4.1.1.1.cmml">∈</mo><msup id="A3.I1.i1.p1.4.m4.1.1.3" xref="A3.I1.i1.p1.4.m4.1.1.3.cmml"><mi id="A3.I1.i1.p1.4.m4.1.1.3.2" xref="A3.I1.i1.p1.4.m4.1.1.3.2.cmml">ℝ</mi><mn id="A3.I1.i1.p1.4.m4.1.1.3.3" xref="A3.I1.i1.p1.4.m4.1.1.3.3.cmml">3</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="A3.I1.i1.p1.4.m4.1b"><apply id="A3.I1.i1.p1.4.m4.1.1.cmml" xref="A3.I1.i1.p1.4.m4.1.1"><in id="A3.I1.i1.p1.4.m4.1.1.1.cmml" xref="A3.I1.i1.p1.4.m4.1.1.1"></in><ci id="A3.I1.i1.p1.4.m4.1.1.2.cmml" xref="A3.I1.i1.p1.4.m4.1.1.2">𝒙</ci><apply id="A3.I1.i1.p1.4.m4.1.1.3.cmml" xref="A3.I1.i1.p1.4.m4.1.1.3"><csymbol cd="ambiguous" id="A3.I1.i1.p1.4.m4.1.1.3.1.cmml" xref="A3.I1.i1.p1.4.m4.1.1.3">superscript</csymbol><ci id="A3.I1.i1.p1.4.m4.1.1.3.2.cmml" xref="A3.I1.i1.p1.4.m4.1.1.3.2">ℝ</ci><cn id="A3.I1.i1.p1.4.m4.1.1.3.3.cmml" type="integer" xref="A3.I1.i1.p1.4.m4.1.1.3.3">3</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.I1.i1.p1.4.m4.1c">\bm{x}\in\mathbb{R}^{3}</annotation><annotation encoding="application/x-llamapun" id="A3.I1.i1.p1.4.m4.1d">bold_italic_x ∈ blackboard_R start_POSTSUPERSCRIPT 3 end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="\bm{f}\in\mathbb{R}^{16}" class="ltx_Math" display="inline" id="A3.I1.i1.p1.5.m5.1"><semantics id="A3.I1.i1.p1.5.m5.1a"><mrow id="A3.I1.i1.p1.5.m5.1.1" xref="A3.I1.i1.p1.5.m5.1.1.cmml"><mi id="A3.I1.i1.p1.5.m5.1.1.2" xref="A3.I1.i1.p1.5.m5.1.1.2.cmml">𝒇</mi><mo id="A3.I1.i1.p1.5.m5.1.1.1" xref="A3.I1.i1.p1.5.m5.1.1.1.cmml">∈</mo><msup id="A3.I1.i1.p1.5.m5.1.1.3" xref="A3.I1.i1.p1.5.m5.1.1.3.cmml"><mi id="A3.I1.i1.p1.5.m5.1.1.3.2" xref="A3.I1.i1.p1.5.m5.1.1.3.2.cmml">ℝ</mi><mn id="A3.I1.i1.p1.5.m5.1.1.3.3" xref="A3.I1.i1.p1.5.m5.1.1.3.3.cmml">16</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="A3.I1.i1.p1.5.m5.1b"><apply id="A3.I1.i1.p1.5.m5.1.1.cmml" xref="A3.I1.i1.p1.5.m5.1.1"><in id="A3.I1.i1.p1.5.m5.1.1.1.cmml" xref="A3.I1.i1.p1.5.m5.1.1.1"></in><ci id="A3.I1.i1.p1.5.m5.1.1.2.cmml" xref="A3.I1.i1.p1.5.m5.1.1.2">𝒇</ci><apply id="A3.I1.i1.p1.5.m5.1.1.3.cmml" xref="A3.I1.i1.p1.5.m5.1.1.3"><csymbol cd="ambiguous" id="A3.I1.i1.p1.5.m5.1.1.3.1.cmml" xref="A3.I1.i1.p1.5.m5.1.1.3">superscript</csymbol><ci id="A3.I1.i1.p1.5.m5.1.1.3.2.cmml" xref="A3.I1.i1.p1.5.m5.1.1.3.2">ℝ</ci><cn id="A3.I1.i1.p1.5.m5.1.1.3.3.cmml" type="integer" xref="A3.I1.i1.p1.5.m5.1.1.3.3">16</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.I1.i1.p1.5.m5.1c">\bm{f}\in\mathbb{R}^{16}</annotation><annotation encoding="application/x-llamapun" id="A3.I1.i1.p1.5.m5.1d">bold_italic_f ∈ blackboard_R start_POSTSUPERSCRIPT 16 end_POSTSUPERSCRIPT</annotation></semantics></math>.
For every timestep, the particles across different cameras are merged and subsampled uniformly at random to get <math alttext="N=32768" class="ltx_Math" display="inline" id="A3.I1.i1.p1.6.m6.1"><semantics id="A3.I1.i1.p1.6.m6.1a"><mrow id="A3.I1.i1.p1.6.m6.1.1" xref="A3.I1.i1.p1.6.m6.1.1.cmml"><mi id="A3.I1.i1.p1.6.m6.1.1.2" xref="A3.I1.i1.p1.6.m6.1.1.2.cmml">N</mi><mo id="A3.I1.i1.p1.6.m6.1.1.1" xref="A3.I1.i1.p1.6.m6.1.1.1.cmml">=</mo><mn id="A3.I1.i1.p1.6.m6.1.1.3" xref="A3.I1.i1.p1.6.m6.1.1.3.cmml">32768</mn></mrow><annotation-xml encoding="MathML-Content" id="A3.I1.i1.p1.6.m6.1b"><apply id="A3.I1.i1.p1.6.m6.1.1.cmml" xref="A3.I1.i1.p1.6.m6.1.1"><eq id="A3.I1.i1.p1.6.m6.1.1.1.cmml" xref="A3.I1.i1.p1.6.m6.1.1.1"></eq><ci id="A3.I1.i1.p1.6.m6.1.1.2.cmml" xref="A3.I1.i1.p1.6.m6.1.1.2">𝑁</ci><cn id="A3.I1.i1.p1.6.m6.1.1.3.cmml" type="integer" xref="A3.I1.i1.p1.6.m6.1.1.3">32768</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.I1.i1.p1.6.m6.1c">N=32768</annotation><annotation encoding="application/x-llamapun" id="A3.I1.i1.p1.6.m6.1d">italic_N = 32768</annotation></semantics></math>.
The robot actions at timesteps <math alttext="\{t-2,t-1,t\}" class="ltx_Math" display="inline" id="A3.I1.i1.p1.7.m7.3"><semantics id="A3.I1.i1.p1.7.m7.3a"><mrow id="A3.I1.i1.p1.7.m7.3.3.2" xref="A3.I1.i1.p1.7.m7.3.3.3.cmml"><mo id="A3.I1.i1.p1.7.m7.3.3.2.3" stretchy="false" xref="A3.I1.i1.p1.7.m7.3.3.3.cmml">{</mo><mrow id="A3.I1.i1.p1.7.m7.2.2.1.1" xref="A3.I1.i1.p1.7.m7.2.2.1.1.cmml"><mi id="A3.I1.i1.p1.7.m7.2.2.1.1.2" xref="A3.I1.i1.p1.7.m7.2.2.1.1.2.cmml">t</mi><mo id="A3.I1.i1.p1.7.m7.2.2.1.1.1" xref="A3.I1.i1.p1.7.m7.2.2.1.1.1.cmml">−</mo><mn id="A3.I1.i1.p1.7.m7.2.2.1.1.3" xref="A3.I1.i1.p1.7.m7.2.2.1.1.3.cmml">2</mn></mrow><mo id="A3.I1.i1.p1.7.m7.3.3.2.4" xref="A3.I1.i1.p1.7.m7.3.3.3.cmml">,</mo><mrow id="A3.I1.i1.p1.7.m7.3.3.2.2" xref="A3.I1.i1.p1.7.m7.3.3.2.2.cmml"><mi id="A3.I1.i1.p1.7.m7.3.3.2.2.2" xref="A3.I1.i1.p1.7.m7.3.3.2.2.2.cmml">t</mi><mo id="A3.I1.i1.p1.7.m7.3.3.2.2.1" xref="A3.I1.i1.p1.7.m7.3.3.2.2.1.cmml">−</mo><mn id="A3.I1.i1.p1.7.m7.3.3.2.2.3" xref="A3.I1.i1.p1.7.m7.3.3.2.2.3.cmml">1</mn></mrow><mo id="A3.I1.i1.p1.7.m7.3.3.2.5" xref="A3.I1.i1.p1.7.m7.3.3.3.cmml">,</mo><mi id="A3.I1.i1.p1.7.m7.1.1" xref="A3.I1.i1.p1.7.m7.1.1.cmml">t</mi><mo id="A3.I1.i1.p1.7.m7.3.3.2.6" stretchy="false" xref="A3.I1.i1.p1.7.m7.3.3.3.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="A3.I1.i1.p1.7.m7.3b"><set id="A3.I1.i1.p1.7.m7.3.3.3.cmml" xref="A3.I1.i1.p1.7.m7.3.3.2"><apply id="A3.I1.i1.p1.7.m7.2.2.1.1.cmml" xref="A3.I1.i1.p1.7.m7.2.2.1.1"><minus id="A3.I1.i1.p1.7.m7.2.2.1.1.1.cmml" xref="A3.I1.i1.p1.7.m7.2.2.1.1.1"></minus><ci id="A3.I1.i1.p1.7.m7.2.2.1.1.2.cmml" xref="A3.I1.i1.p1.7.m7.2.2.1.1.2">𝑡</ci><cn id="A3.I1.i1.p1.7.m7.2.2.1.1.3.cmml" type="integer" xref="A3.I1.i1.p1.7.m7.2.2.1.1.3">2</cn></apply><apply id="A3.I1.i1.p1.7.m7.3.3.2.2.cmml" xref="A3.I1.i1.p1.7.m7.3.3.2.2"><minus id="A3.I1.i1.p1.7.m7.3.3.2.2.1.cmml" xref="A3.I1.i1.p1.7.m7.3.3.2.2.1"></minus><ci id="A3.I1.i1.p1.7.m7.3.3.2.2.2.cmml" xref="A3.I1.i1.p1.7.m7.3.3.2.2.2">𝑡</ci><cn id="A3.I1.i1.p1.7.m7.3.3.2.2.3.cmml" type="integer" xref="A3.I1.i1.p1.7.m7.3.3.2.2.3">1</cn></apply><ci id="A3.I1.i1.p1.7.m7.1.1.cmml" xref="A3.I1.i1.p1.7.m7.1.1">𝑡</ci></set></annotation-xml><annotation encoding="application/x-tex" id="A3.I1.i1.p1.7.m7.3c">\{t-2,t-1,t\}</annotation><annotation encoding="application/x-llamapun" id="A3.I1.i1.p1.7.m7.3d">{ italic_t - 2 , italic_t - 1 , italic_t }</annotation></semantics></math>, representing the robot joints and where they plan to move, are also encoded as <em class="ltx_emph ltx_font_italic" id="A3.I1.i1.p1.7.2">kinematic particles</em>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="A3.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span>
<div class="ltx_para" id="A3.I1.i2.p1">
<p class="ltx_p" id="A3.I1.i2.p1.2"><em class="ltx_emph ltx_font_italic" id="A3.I1.i2.p1.2.1">Predict the point cloud dynamics.</em>
With an <em class="ltx_emph ltx_font_italic" id="A3.I1.i2.p1.2.2">Interlacer</em> (see below), use the point clouds and kinematic particles to predict <math alttext="(\Delta\bm{x}_{i},\Delta\bm{f}_{i})_{i=1}^{N}" class="ltx_Math" display="inline" id="A3.I1.i2.p1.1.m1.2"><semantics id="A3.I1.i2.p1.1.m1.2a"><msubsup id="A3.I1.i2.p1.1.m1.2.2" xref="A3.I1.i2.p1.1.m1.2.2.cmml"><mrow id="A3.I1.i2.p1.1.m1.2.2.2.2.2" xref="A3.I1.i2.p1.1.m1.2.2.2.2.3.cmml"><mo id="A3.I1.i2.p1.1.m1.2.2.2.2.2.3" stretchy="false" xref="A3.I1.i2.p1.1.m1.2.2.2.2.3.cmml">(</mo><mrow id="A3.I1.i2.p1.1.m1.1.1.1.1.1.1" xref="A3.I1.i2.p1.1.m1.1.1.1.1.1.1.cmml"><mi id="A3.I1.i2.p1.1.m1.1.1.1.1.1.1.2" mathvariant="normal" xref="A3.I1.i2.p1.1.m1.1.1.1.1.1.1.2.cmml">Δ</mi><mo id="A3.I1.i2.p1.1.m1.1.1.1.1.1.1.1" xref="A3.I1.i2.p1.1.m1.1.1.1.1.1.1.1.cmml">⁢</mo><msub id="A3.I1.i2.p1.1.m1.1.1.1.1.1.1.3" xref="A3.I1.i2.p1.1.m1.1.1.1.1.1.1.3.cmml"><mi id="A3.I1.i2.p1.1.m1.1.1.1.1.1.1.3.2" xref="A3.I1.i2.p1.1.m1.1.1.1.1.1.1.3.2.cmml">𝒙</mi><mi id="A3.I1.i2.p1.1.m1.1.1.1.1.1.1.3.3" xref="A3.I1.i2.p1.1.m1.1.1.1.1.1.1.3.3.cmml">i</mi></msub></mrow><mo id="A3.I1.i2.p1.1.m1.2.2.2.2.2.4" xref="A3.I1.i2.p1.1.m1.2.2.2.2.3.cmml">,</mo><mrow id="A3.I1.i2.p1.1.m1.2.2.2.2.2.2" xref="A3.I1.i2.p1.1.m1.2.2.2.2.2.2.cmml"><mi id="A3.I1.i2.p1.1.m1.2.2.2.2.2.2.2" mathvariant="normal" xref="A3.I1.i2.p1.1.m1.2.2.2.2.2.2.2.cmml">Δ</mi><mo id="A3.I1.i2.p1.1.m1.2.2.2.2.2.2.1" xref="A3.I1.i2.p1.1.m1.2.2.2.2.2.2.1.cmml">⁢</mo><msub id="A3.I1.i2.p1.1.m1.2.2.2.2.2.2.3" xref="A3.I1.i2.p1.1.m1.2.2.2.2.2.2.3.cmml"><mi id="A3.I1.i2.p1.1.m1.2.2.2.2.2.2.3.2" xref="A3.I1.i2.p1.1.m1.2.2.2.2.2.2.3.2.cmml">𝒇</mi><mi id="A3.I1.i2.p1.1.m1.2.2.2.2.2.2.3.3" xref="A3.I1.i2.p1.1.m1.2.2.2.2.2.2.3.3.cmml">i</mi></msub></mrow><mo id="A3.I1.i2.p1.1.m1.2.2.2.2.2.5" stretchy="false" xref="A3.I1.i2.p1.1.m1.2.2.2.2.3.cmml">)</mo></mrow><mrow id="A3.I1.i2.p1.1.m1.2.2.2.4" xref="A3.I1.i2.p1.1.m1.2.2.2.4.cmml"><mi id="A3.I1.i2.p1.1.m1.2.2.2.4.2" xref="A3.I1.i2.p1.1.m1.2.2.2.4.2.cmml">i</mi><mo id="A3.I1.i2.p1.1.m1.2.2.2.4.1" xref="A3.I1.i2.p1.1.m1.2.2.2.4.1.cmml">=</mo><mn id="A3.I1.i2.p1.1.m1.2.2.2.4.3" xref="A3.I1.i2.p1.1.m1.2.2.2.4.3.cmml">1</mn></mrow><mi id="A3.I1.i2.p1.1.m1.2.2.4" xref="A3.I1.i2.p1.1.m1.2.2.4.cmml">N</mi></msubsup><annotation-xml encoding="MathML-Content" id="A3.I1.i2.p1.1.m1.2b"><apply id="A3.I1.i2.p1.1.m1.2.2.cmml" xref="A3.I1.i2.p1.1.m1.2.2"><csymbol cd="ambiguous" id="A3.I1.i2.p1.1.m1.2.2.3.cmml" xref="A3.I1.i2.p1.1.m1.2.2">superscript</csymbol><apply id="A3.I1.i2.p1.1.m1.2.2.2.cmml" xref="A3.I1.i2.p1.1.m1.2.2"><csymbol cd="ambiguous" id="A3.I1.i2.p1.1.m1.2.2.2.3.cmml" xref="A3.I1.i2.p1.1.m1.2.2">subscript</csymbol><interval closure="open" id="A3.I1.i2.p1.1.m1.2.2.2.2.3.cmml" xref="A3.I1.i2.p1.1.m1.2.2.2.2.2"><apply id="A3.I1.i2.p1.1.m1.1.1.1.1.1.1.cmml" xref="A3.I1.i2.p1.1.m1.1.1.1.1.1.1"><times id="A3.I1.i2.p1.1.m1.1.1.1.1.1.1.1.cmml" xref="A3.I1.i2.p1.1.m1.1.1.1.1.1.1.1"></times><ci id="A3.I1.i2.p1.1.m1.1.1.1.1.1.1.2.cmml" xref="A3.I1.i2.p1.1.m1.1.1.1.1.1.1.2">Δ</ci><apply id="A3.I1.i2.p1.1.m1.1.1.1.1.1.1.3.cmml" xref="A3.I1.i2.p1.1.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A3.I1.i2.p1.1.m1.1.1.1.1.1.1.3.1.cmml" xref="A3.I1.i2.p1.1.m1.1.1.1.1.1.1.3">subscript</csymbol><ci id="A3.I1.i2.p1.1.m1.1.1.1.1.1.1.3.2.cmml" xref="A3.I1.i2.p1.1.m1.1.1.1.1.1.1.3.2">𝒙</ci><ci id="A3.I1.i2.p1.1.m1.1.1.1.1.1.1.3.3.cmml" xref="A3.I1.i2.p1.1.m1.1.1.1.1.1.1.3.3">𝑖</ci></apply></apply><apply id="A3.I1.i2.p1.1.m1.2.2.2.2.2.2.cmml" xref="A3.I1.i2.p1.1.m1.2.2.2.2.2.2"><times id="A3.I1.i2.p1.1.m1.2.2.2.2.2.2.1.cmml" xref="A3.I1.i2.p1.1.m1.2.2.2.2.2.2.1"></times><ci id="A3.I1.i2.p1.1.m1.2.2.2.2.2.2.2.cmml" xref="A3.I1.i2.p1.1.m1.2.2.2.2.2.2.2">Δ</ci><apply id="A3.I1.i2.p1.1.m1.2.2.2.2.2.2.3.cmml" xref="A3.I1.i2.p1.1.m1.2.2.2.2.2.2.3"><csymbol cd="ambiguous" id="A3.I1.i2.p1.1.m1.2.2.2.2.2.2.3.1.cmml" xref="A3.I1.i2.p1.1.m1.2.2.2.2.2.2.3">subscript</csymbol><ci id="A3.I1.i2.p1.1.m1.2.2.2.2.2.2.3.2.cmml" xref="A3.I1.i2.p1.1.m1.2.2.2.2.2.2.3.2">𝒇</ci><ci id="A3.I1.i2.p1.1.m1.2.2.2.2.2.2.3.3.cmml" xref="A3.I1.i2.p1.1.m1.2.2.2.2.2.2.3.3">𝑖</ci></apply></apply></interval><apply id="A3.I1.i2.p1.1.m1.2.2.2.4.cmml" xref="A3.I1.i2.p1.1.m1.2.2.2.4"><eq id="A3.I1.i2.p1.1.m1.2.2.2.4.1.cmml" xref="A3.I1.i2.p1.1.m1.2.2.2.4.1"></eq><ci id="A3.I1.i2.p1.1.m1.2.2.2.4.2.cmml" xref="A3.I1.i2.p1.1.m1.2.2.2.4.2">𝑖</ci><cn id="A3.I1.i2.p1.1.m1.2.2.2.4.3.cmml" type="integer" xref="A3.I1.i2.p1.1.m1.2.2.2.4.3">1</cn></apply></apply><ci id="A3.I1.i2.p1.1.m1.2.2.4.cmml" xref="A3.I1.i2.p1.1.m1.2.2.4">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.I1.i2.p1.1.m1.2c">(\Delta\bm{x}_{i},\Delta\bm{f}_{i})_{i=1}^{N}</annotation><annotation encoding="application/x-llamapun" id="A3.I1.i2.p1.1.m1.2d">( roman_Δ bold_italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , roman_Δ bold_italic_f start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT</annotation></semantics></math>, and hence the updated state <math alttext="(\bm{x}_{i}^{t-1}+\Delta\bm{x}_{i},\bm{f}_{i}^{t-1}+\Delta\bm{f}_{i})_{i=1}^{N}" class="ltx_Math" display="inline" id="A3.I1.i2.p1.2.m2.2"><semantics id="A3.I1.i2.p1.2.m2.2a"><msubsup id="A3.I1.i2.p1.2.m2.2.2" xref="A3.I1.i2.p1.2.m2.2.2.cmml"><mrow id="A3.I1.i2.p1.2.m2.2.2.2.2.2" xref="A3.I1.i2.p1.2.m2.2.2.2.2.3.cmml"><mo id="A3.I1.i2.p1.2.m2.2.2.2.2.2.3" stretchy="false" xref="A3.I1.i2.p1.2.m2.2.2.2.2.3.cmml">(</mo><mrow id="A3.I1.i2.p1.2.m2.1.1.1.1.1.1" xref="A3.I1.i2.p1.2.m2.1.1.1.1.1.1.cmml"><msubsup id="A3.I1.i2.p1.2.m2.1.1.1.1.1.1.2" xref="A3.I1.i2.p1.2.m2.1.1.1.1.1.1.2.cmml"><mi id="A3.I1.i2.p1.2.m2.1.1.1.1.1.1.2.2.2" xref="A3.I1.i2.p1.2.m2.1.1.1.1.1.1.2.2.2.cmml">𝒙</mi><mi id="A3.I1.i2.p1.2.m2.1.1.1.1.1.1.2.2.3" xref="A3.I1.i2.p1.2.m2.1.1.1.1.1.1.2.2.3.cmml">i</mi><mrow id="A3.I1.i2.p1.2.m2.1.1.1.1.1.1.2.3" xref="A3.I1.i2.p1.2.m2.1.1.1.1.1.1.2.3.cmml"><mi id="A3.I1.i2.p1.2.m2.1.1.1.1.1.1.2.3.2" xref="A3.I1.i2.p1.2.m2.1.1.1.1.1.1.2.3.2.cmml">t</mi><mo id="A3.I1.i2.p1.2.m2.1.1.1.1.1.1.2.3.1" xref="A3.I1.i2.p1.2.m2.1.1.1.1.1.1.2.3.1.cmml">−</mo><mn id="A3.I1.i2.p1.2.m2.1.1.1.1.1.1.2.3.3" xref="A3.I1.i2.p1.2.m2.1.1.1.1.1.1.2.3.3.cmml">1</mn></mrow></msubsup><mo id="A3.I1.i2.p1.2.m2.1.1.1.1.1.1.1" xref="A3.I1.i2.p1.2.m2.1.1.1.1.1.1.1.cmml">+</mo><mrow id="A3.I1.i2.p1.2.m2.1.1.1.1.1.1.3" xref="A3.I1.i2.p1.2.m2.1.1.1.1.1.1.3.cmml"><mi id="A3.I1.i2.p1.2.m2.1.1.1.1.1.1.3.2" mathvariant="normal" xref="A3.I1.i2.p1.2.m2.1.1.1.1.1.1.3.2.cmml">Δ</mi><mo id="A3.I1.i2.p1.2.m2.1.1.1.1.1.1.3.1" xref="A3.I1.i2.p1.2.m2.1.1.1.1.1.1.3.1.cmml">⁢</mo><msub id="A3.I1.i2.p1.2.m2.1.1.1.1.1.1.3.3" xref="A3.I1.i2.p1.2.m2.1.1.1.1.1.1.3.3.cmml"><mi id="A3.I1.i2.p1.2.m2.1.1.1.1.1.1.3.3.2" xref="A3.I1.i2.p1.2.m2.1.1.1.1.1.1.3.3.2.cmml">𝒙</mi><mi id="A3.I1.i2.p1.2.m2.1.1.1.1.1.1.3.3.3" xref="A3.I1.i2.p1.2.m2.1.1.1.1.1.1.3.3.3.cmml">i</mi></msub></mrow></mrow><mo id="A3.I1.i2.p1.2.m2.2.2.2.2.2.4" xref="A3.I1.i2.p1.2.m2.2.2.2.2.3.cmml">,</mo><mrow id="A3.I1.i2.p1.2.m2.2.2.2.2.2.2" xref="A3.I1.i2.p1.2.m2.2.2.2.2.2.2.cmml"><msubsup id="A3.I1.i2.p1.2.m2.2.2.2.2.2.2.2" xref="A3.I1.i2.p1.2.m2.2.2.2.2.2.2.2.cmml"><mi id="A3.I1.i2.p1.2.m2.2.2.2.2.2.2.2.2.2" xref="A3.I1.i2.p1.2.m2.2.2.2.2.2.2.2.2.2.cmml">𝒇</mi><mi id="A3.I1.i2.p1.2.m2.2.2.2.2.2.2.2.2.3" xref="A3.I1.i2.p1.2.m2.2.2.2.2.2.2.2.2.3.cmml">i</mi><mrow id="A3.I1.i2.p1.2.m2.2.2.2.2.2.2.2.3" xref="A3.I1.i2.p1.2.m2.2.2.2.2.2.2.2.3.cmml"><mi id="A3.I1.i2.p1.2.m2.2.2.2.2.2.2.2.3.2" xref="A3.I1.i2.p1.2.m2.2.2.2.2.2.2.2.3.2.cmml">t</mi><mo id="A3.I1.i2.p1.2.m2.2.2.2.2.2.2.2.3.1" xref="A3.I1.i2.p1.2.m2.2.2.2.2.2.2.2.3.1.cmml">−</mo><mn id="A3.I1.i2.p1.2.m2.2.2.2.2.2.2.2.3.3" xref="A3.I1.i2.p1.2.m2.2.2.2.2.2.2.2.3.3.cmml">1</mn></mrow></msubsup><mo id="A3.I1.i2.p1.2.m2.2.2.2.2.2.2.1" xref="A3.I1.i2.p1.2.m2.2.2.2.2.2.2.1.cmml">+</mo><mrow id="A3.I1.i2.p1.2.m2.2.2.2.2.2.2.3" xref="A3.I1.i2.p1.2.m2.2.2.2.2.2.2.3.cmml"><mi id="A3.I1.i2.p1.2.m2.2.2.2.2.2.2.3.2" mathvariant="normal" xref="A3.I1.i2.p1.2.m2.2.2.2.2.2.2.3.2.cmml">Δ</mi><mo id="A3.I1.i2.p1.2.m2.2.2.2.2.2.2.3.1" xref="A3.I1.i2.p1.2.m2.2.2.2.2.2.2.3.1.cmml">⁢</mo><msub id="A3.I1.i2.p1.2.m2.2.2.2.2.2.2.3.3" xref="A3.I1.i2.p1.2.m2.2.2.2.2.2.2.3.3.cmml"><mi id="A3.I1.i2.p1.2.m2.2.2.2.2.2.2.3.3.2" xref="A3.I1.i2.p1.2.m2.2.2.2.2.2.2.3.3.2.cmml">𝒇</mi><mi id="A3.I1.i2.p1.2.m2.2.2.2.2.2.2.3.3.3" xref="A3.I1.i2.p1.2.m2.2.2.2.2.2.2.3.3.3.cmml">i</mi></msub></mrow></mrow><mo id="A3.I1.i2.p1.2.m2.2.2.2.2.2.5" stretchy="false" xref="A3.I1.i2.p1.2.m2.2.2.2.2.3.cmml">)</mo></mrow><mrow id="A3.I1.i2.p1.2.m2.2.2.2.4" xref="A3.I1.i2.p1.2.m2.2.2.2.4.cmml"><mi id="A3.I1.i2.p1.2.m2.2.2.2.4.2" xref="A3.I1.i2.p1.2.m2.2.2.2.4.2.cmml">i</mi><mo id="A3.I1.i2.p1.2.m2.2.2.2.4.1" xref="A3.I1.i2.p1.2.m2.2.2.2.4.1.cmml">=</mo><mn id="A3.I1.i2.p1.2.m2.2.2.2.4.3" xref="A3.I1.i2.p1.2.m2.2.2.2.4.3.cmml">1</mn></mrow><mi id="A3.I1.i2.p1.2.m2.2.2.4" xref="A3.I1.i2.p1.2.m2.2.2.4.cmml">N</mi></msubsup><annotation-xml encoding="MathML-Content" id="A3.I1.i2.p1.2.m2.2b"><apply id="A3.I1.i2.p1.2.m2.2.2.cmml" xref="A3.I1.i2.p1.2.m2.2.2"><csymbol cd="ambiguous" id="A3.I1.i2.p1.2.m2.2.2.3.cmml" xref="A3.I1.i2.p1.2.m2.2.2">superscript</csymbol><apply id="A3.I1.i2.p1.2.m2.2.2.2.cmml" xref="A3.I1.i2.p1.2.m2.2.2"><csymbol cd="ambiguous" id="A3.I1.i2.p1.2.m2.2.2.2.3.cmml" xref="A3.I1.i2.p1.2.m2.2.2">subscript</csymbol><interval closure="open" id="A3.I1.i2.p1.2.m2.2.2.2.2.3.cmml" xref="A3.I1.i2.p1.2.m2.2.2.2.2.2"><apply id="A3.I1.i2.p1.2.m2.1.1.1.1.1.1.cmml" xref="A3.I1.i2.p1.2.m2.1.1.1.1.1.1"><plus id="A3.I1.i2.p1.2.m2.1.1.1.1.1.1.1.cmml" xref="A3.I1.i2.p1.2.m2.1.1.1.1.1.1.1"></plus><apply id="A3.I1.i2.p1.2.m2.1.1.1.1.1.1.2.cmml" xref="A3.I1.i2.p1.2.m2.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A3.I1.i2.p1.2.m2.1.1.1.1.1.1.2.1.cmml" xref="A3.I1.i2.p1.2.m2.1.1.1.1.1.1.2">superscript</csymbol><apply id="A3.I1.i2.p1.2.m2.1.1.1.1.1.1.2.2.cmml" xref="A3.I1.i2.p1.2.m2.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A3.I1.i2.p1.2.m2.1.1.1.1.1.1.2.2.1.cmml" xref="A3.I1.i2.p1.2.m2.1.1.1.1.1.1.2">subscript</csymbol><ci id="A3.I1.i2.p1.2.m2.1.1.1.1.1.1.2.2.2.cmml" xref="A3.I1.i2.p1.2.m2.1.1.1.1.1.1.2.2.2">𝒙</ci><ci id="A3.I1.i2.p1.2.m2.1.1.1.1.1.1.2.2.3.cmml" xref="A3.I1.i2.p1.2.m2.1.1.1.1.1.1.2.2.3">𝑖</ci></apply><apply id="A3.I1.i2.p1.2.m2.1.1.1.1.1.1.2.3.cmml" xref="A3.I1.i2.p1.2.m2.1.1.1.1.1.1.2.3"><minus id="A3.I1.i2.p1.2.m2.1.1.1.1.1.1.2.3.1.cmml" xref="A3.I1.i2.p1.2.m2.1.1.1.1.1.1.2.3.1"></minus><ci id="A3.I1.i2.p1.2.m2.1.1.1.1.1.1.2.3.2.cmml" xref="A3.I1.i2.p1.2.m2.1.1.1.1.1.1.2.3.2">𝑡</ci><cn id="A3.I1.i2.p1.2.m2.1.1.1.1.1.1.2.3.3.cmml" type="integer" xref="A3.I1.i2.p1.2.m2.1.1.1.1.1.1.2.3.3">1</cn></apply></apply><apply id="A3.I1.i2.p1.2.m2.1.1.1.1.1.1.3.cmml" xref="A3.I1.i2.p1.2.m2.1.1.1.1.1.1.3"><times id="A3.I1.i2.p1.2.m2.1.1.1.1.1.1.3.1.cmml" xref="A3.I1.i2.p1.2.m2.1.1.1.1.1.1.3.1"></times><ci id="A3.I1.i2.p1.2.m2.1.1.1.1.1.1.3.2.cmml" xref="A3.I1.i2.p1.2.m2.1.1.1.1.1.1.3.2">Δ</ci><apply id="A3.I1.i2.p1.2.m2.1.1.1.1.1.1.3.3.cmml" xref="A3.I1.i2.p1.2.m2.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="A3.I1.i2.p1.2.m2.1.1.1.1.1.1.3.3.1.cmml" xref="A3.I1.i2.p1.2.m2.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="A3.I1.i2.p1.2.m2.1.1.1.1.1.1.3.3.2.cmml" xref="A3.I1.i2.p1.2.m2.1.1.1.1.1.1.3.3.2">𝒙</ci><ci id="A3.I1.i2.p1.2.m2.1.1.1.1.1.1.3.3.3.cmml" xref="A3.I1.i2.p1.2.m2.1.1.1.1.1.1.3.3.3">𝑖</ci></apply></apply></apply><apply id="A3.I1.i2.p1.2.m2.2.2.2.2.2.2.cmml" xref="A3.I1.i2.p1.2.m2.2.2.2.2.2.2"><plus id="A3.I1.i2.p1.2.m2.2.2.2.2.2.2.1.cmml" xref="A3.I1.i2.p1.2.m2.2.2.2.2.2.2.1"></plus><apply id="A3.I1.i2.p1.2.m2.2.2.2.2.2.2.2.cmml" xref="A3.I1.i2.p1.2.m2.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="A3.I1.i2.p1.2.m2.2.2.2.2.2.2.2.1.cmml" xref="A3.I1.i2.p1.2.m2.2.2.2.2.2.2.2">superscript</csymbol><apply id="A3.I1.i2.p1.2.m2.2.2.2.2.2.2.2.2.cmml" xref="A3.I1.i2.p1.2.m2.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="A3.I1.i2.p1.2.m2.2.2.2.2.2.2.2.2.1.cmml" xref="A3.I1.i2.p1.2.m2.2.2.2.2.2.2.2">subscript</csymbol><ci id="A3.I1.i2.p1.2.m2.2.2.2.2.2.2.2.2.2.cmml" xref="A3.I1.i2.p1.2.m2.2.2.2.2.2.2.2.2.2">𝒇</ci><ci id="A3.I1.i2.p1.2.m2.2.2.2.2.2.2.2.2.3.cmml" xref="A3.I1.i2.p1.2.m2.2.2.2.2.2.2.2.2.3">𝑖</ci></apply><apply id="A3.I1.i2.p1.2.m2.2.2.2.2.2.2.2.3.cmml" xref="A3.I1.i2.p1.2.m2.2.2.2.2.2.2.2.3"><minus id="A3.I1.i2.p1.2.m2.2.2.2.2.2.2.2.3.1.cmml" xref="A3.I1.i2.p1.2.m2.2.2.2.2.2.2.2.3.1"></minus><ci id="A3.I1.i2.p1.2.m2.2.2.2.2.2.2.2.3.2.cmml" xref="A3.I1.i2.p1.2.m2.2.2.2.2.2.2.2.3.2">𝑡</ci><cn id="A3.I1.i2.p1.2.m2.2.2.2.2.2.2.2.3.3.cmml" type="integer" xref="A3.I1.i2.p1.2.m2.2.2.2.2.2.2.2.3.3">1</cn></apply></apply><apply id="A3.I1.i2.p1.2.m2.2.2.2.2.2.2.3.cmml" xref="A3.I1.i2.p1.2.m2.2.2.2.2.2.2.3"><times id="A3.I1.i2.p1.2.m2.2.2.2.2.2.2.3.1.cmml" xref="A3.I1.i2.p1.2.m2.2.2.2.2.2.2.3.1"></times><ci id="A3.I1.i2.p1.2.m2.2.2.2.2.2.2.3.2.cmml" xref="A3.I1.i2.p1.2.m2.2.2.2.2.2.2.3.2">Δ</ci><apply id="A3.I1.i2.p1.2.m2.2.2.2.2.2.2.3.3.cmml" xref="A3.I1.i2.p1.2.m2.2.2.2.2.2.2.3.3"><csymbol cd="ambiguous" id="A3.I1.i2.p1.2.m2.2.2.2.2.2.2.3.3.1.cmml" xref="A3.I1.i2.p1.2.m2.2.2.2.2.2.2.3.3">subscript</csymbol><ci id="A3.I1.i2.p1.2.m2.2.2.2.2.2.2.3.3.2.cmml" xref="A3.I1.i2.p1.2.m2.2.2.2.2.2.2.3.3.2">𝒇</ci><ci id="A3.I1.i2.p1.2.m2.2.2.2.2.2.2.3.3.3.cmml" xref="A3.I1.i2.p1.2.m2.2.2.2.2.2.2.3.3.3">𝑖</ci></apply></apply></apply></interval><apply id="A3.I1.i2.p1.2.m2.2.2.2.4.cmml" xref="A3.I1.i2.p1.2.m2.2.2.2.4"><eq id="A3.I1.i2.p1.2.m2.2.2.2.4.1.cmml" xref="A3.I1.i2.p1.2.m2.2.2.2.4.1"></eq><ci id="A3.I1.i2.p1.2.m2.2.2.2.4.2.cmml" xref="A3.I1.i2.p1.2.m2.2.2.2.4.2">𝑖</ci><cn id="A3.I1.i2.p1.2.m2.2.2.2.4.3.cmml" type="integer" xref="A3.I1.i2.p1.2.m2.2.2.2.4.3">1</cn></apply></apply><ci id="A3.I1.i2.p1.2.m2.2.2.4.cmml" xref="A3.I1.i2.p1.2.m2.2.2.4">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.I1.i2.p1.2.m2.2c">(\bm{x}_{i}^{t-1}+\Delta\bm{x}_{i},\bm{f}_{i}^{t-1}+\Delta\bm{f}_{i})_{i=1}^{N}</annotation><annotation encoding="application/x-llamapun" id="A3.I1.i2.p1.2.m2.2d">( bold_italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t - 1 end_POSTSUPERSCRIPT + roman_Δ bold_italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , bold_italic_f start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t - 1 end_POSTSUPERSCRIPT + roman_Δ bold_italic_f start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT</annotation></semantics></math>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="A3.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">3.</span>
<div class="ltx_para ltx_noindent" id="A3.I1.i3.p1">
<p class="ltx_p" id="A3.I1.i3.p1.1"><em class="ltx_emph ltx_font_italic" id="A3.I1.i3.p1.1.1">Render the new state to an image.</em>
Use a ray-based renderer similar to Point-NeRF <cite class="ltx_cite ltx_citemacro_citep">[Xu et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#bib.bib40" title="">2022</a>]</cite> to render an image for the updated point cloud.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
</ol>
<p class="ltx_p" id="A3.SS3.p2.1">The dynamics model can be recursively applied to make predictions multiple rollout timesteps into the future.
To train, we sample a subset of rays to render at each timestep and compute the <math alttext="L_{2}" class="ltx_Math" display="inline" id="A3.SS3.p2.1.m1.1"><semantics id="A3.SS3.p2.1.m1.1a"><msub id="A3.SS3.p2.1.m1.1.1" xref="A3.SS3.p2.1.m1.1.1.cmml"><mi id="A3.SS3.p2.1.m1.1.1.2" xref="A3.SS3.p2.1.m1.1.1.2.cmml">L</mi><mn id="A3.SS3.p2.1.m1.1.1.3" xref="A3.SS3.p2.1.m1.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="A3.SS3.p2.1.m1.1b"><apply id="A3.SS3.p2.1.m1.1.1.cmml" xref="A3.SS3.p2.1.m1.1.1"><csymbol cd="ambiguous" id="A3.SS3.p2.1.m1.1.1.1.cmml" xref="A3.SS3.p2.1.m1.1.1">subscript</csymbol><ci id="A3.SS3.p2.1.m1.1.1.2.cmml" xref="A3.SS3.p2.1.m1.1.1.2">𝐿</ci><cn id="A3.SS3.p2.1.m1.1.1.3.cmml" type="integer" xref="A3.SS3.p2.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS3.p2.1.m1.1c">L_{2}</annotation><annotation encoding="application/x-llamapun" id="A3.SS3.p2.1.m1.1d">italic_L start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math> loss between the predicted and observed RGB values.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="A3.SS3.p3">
<p class="ltx_p" id="A3.SS3.p3.1"><span class="ltx_text ltx_font_bold" id="A3.SS3.p3.1.1">Interlacers as PCTs.</span>
The Interlacer is a type of point cloud transformer (PCT) designed to scale to tens of thousands of particles.
It alternates linear-attention transformer layers that capture global dependencies between tokens with local <em class="ltx_emph ltx_font_italic" id="A3.SS3.p3.1.2">neighbour-attender</em> layers that model fine-grained geometric structure (see Fig.&nbsp;3 by <cite class="ltx_cite ltx_citemacro_citet">Whitney et&nbsp;al. [<a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#bib.bib38" title="">2024</a>]</cite>).
This is reported to outcompete both graph neural networks and vanilla linear-attention transformers.
For the neighbour-attender, the authors use a message passing-type algorithm that updates the features of a subset of anchor particles depending on the <math alttext="k" class="ltx_Math" display="inline" id="A3.SS3.p3.1.m1.1"><semantics id="A3.SS3.p3.1.m1.1a"><mi id="A3.SS3.p3.1.m1.1.1" xref="A3.SS3.p3.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="A3.SS3.p3.1.m1.1b"><ci id="A3.SS3.p3.1.m1.1.1.cmml" xref="A3.SS3.p3.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.SS3.p3.1.m1.1c">k</annotation><annotation encoding="application/x-llamapun" id="A3.SS3.p3.1.m1.1d">italic_k</annotation></semantics></math>-nearest neighbours’ position and feature vectors, and then updates the remaining particles depending on their closest anchor.
In Sec.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#S4" title="4 Experiments ‣ Linear Transformer Topological Masking with Graph Random Features"><span class="ltx_text ltx_ref_tag">4</span></a>, we show that this can be replaced by GRF-masked linear attention. This also captures local structure and obviates expensive message passing.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="A3.SS3.p4">
<p class="ltx_p" id="A3.SS3.p4.9"><span class="ltx_text ltx_font_bold" id="A3.SS3.p4.9.1">Training and architecture details.</span>
This exactly follows App.&nbsp;E by <cite class="ltx_cite ltx_citemacro_citet">Whitney et&nbsp;al. [<a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#bib.bib38" title="">2024</a>]</cite>, apart from:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<ol class="ltx_enumerate" id="A3.I2">
<li class="ltx_item" id="A3.I2.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span>
<div class="ltx_para" id="A3.I2.i1.p1">
<p class="ltx_p" id="A3.I2.i1.p1.1">We average over <math alttext="5" class="ltx_Math" display="inline" id="A3.I2.i1.p1.1.m1.1"><semantics id="A3.I2.i1.p1.1.m1.1a"><mn id="A3.I2.i1.p1.1.m1.1.1" xref="A3.I2.i1.p1.1.m1.1.1.cmml">5</mn><annotation-xml encoding="MathML-Content" id="A3.I2.i1.p1.1.m1.1b"><cn id="A3.I2.i1.p1.1.m1.1.1.cmml" type="integer" xref="A3.I2.i1.p1.1.m1.1.1">5</cn></annotation-xml><annotation encoding="application/x-tex" id="A3.I2.i1.p1.1.m1.1c">5</annotation><annotation encoding="application/x-llamapun" id="A3.I2.i1.p1.1.m1.1d">5</annotation></semantics></math> seeds, discarding one where training does not converge.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="A3.I2.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span>
<div class="ltx_para" id="A3.I2.i2.p1">
<p class="ltx_p" id="A3.I2.i2.p1.4">For our algorithm, we use <em class="ltx_emph ltx_font_italic" id="A3.I2.i2.p1.4.1">asymmetric</em> GRFs. (Sec.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#A4" title="Appendix D Asymmetric graph random features ‣ Linear Transformer Topological Masking with Graph Random Features"><span class="ltx_text ltx_ref_tag">D</span></a>).
We use <math alttext="n=3^{3}=27" class="ltx_Math" display="inline" id="A3.I2.i2.p1.1.m1.1"><semantics id="A3.I2.i2.p1.1.m1.1a"><mrow id="A3.I2.i2.p1.1.m1.1.1" xref="A3.I2.i2.p1.1.m1.1.1.cmml"><mi id="A3.I2.i2.p1.1.m1.1.1.2" xref="A3.I2.i2.p1.1.m1.1.1.2.cmml">n</mi><mo id="A3.I2.i2.p1.1.m1.1.1.3" xref="A3.I2.i2.p1.1.m1.1.1.3.cmml">=</mo><msup id="A3.I2.i2.p1.1.m1.1.1.4" xref="A3.I2.i2.p1.1.m1.1.1.4.cmml"><mn id="A3.I2.i2.p1.1.m1.1.1.4.2" xref="A3.I2.i2.p1.1.m1.1.1.4.2.cmml">3</mn><mn id="A3.I2.i2.p1.1.m1.1.1.4.3" xref="A3.I2.i2.p1.1.m1.1.1.4.3.cmml">3</mn></msup><mo id="A3.I2.i2.p1.1.m1.1.1.5" xref="A3.I2.i2.p1.1.m1.1.1.5.cmml">=</mo><mn id="A3.I2.i2.p1.1.m1.1.1.6" xref="A3.I2.i2.p1.1.m1.1.1.6.cmml">27</mn></mrow><annotation-xml encoding="MathML-Content" id="A3.I2.i2.p1.1.m1.1b"><apply id="A3.I2.i2.p1.1.m1.1.1.cmml" xref="A3.I2.i2.p1.1.m1.1.1"><and id="A3.I2.i2.p1.1.m1.1.1a.cmml" xref="A3.I2.i2.p1.1.m1.1.1"></and><apply id="A3.I2.i2.p1.1.m1.1.1b.cmml" xref="A3.I2.i2.p1.1.m1.1.1"><eq id="A3.I2.i2.p1.1.m1.1.1.3.cmml" xref="A3.I2.i2.p1.1.m1.1.1.3"></eq><ci id="A3.I2.i2.p1.1.m1.1.1.2.cmml" xref="A3.I2.i2.p1.1.m1.1.1.2">𝑛</ci><apply id="A3.I2.i2.p1.1.m1.1.1.4.cmml" xref="A3.I2.i2.p1.1.m1.1.1.4"><csymbol cd="ambiguous" id="A3.I2.i2.p1.1.m1.1.1.4.1.cmml" xref="A3.I2.i2.p1.1.m1.1.1.4">superscript</csymbol><cn id="A3.I2.i2.p1.1.m1.1.1.4.2.cmml" type="integer" xref="A3.I2.i2.p1.1.m1.1.1.4.2">3</cn><cn id="A3.I2.i2.p1.1.m1.1.1.4.3.cmml" type="integer" xref="A3.I2.i2.p1.1.m1.1.1.4.3">3</cn></apply></apply><apply id="A3.I2.i2.p1.1.m1.1.1c.cmml" xref="A3.I2.i2.p1.1.m1.1.1"><eq id="A3.I2.i2.p1.1.m1.1.1.5.cmml" xref="A3.I2.i2.p1.1.m1.1.1.5"></eq><share href="https://arxiv.org/html/2410.03462v1#A3.I2.i2.p1.1.m1.1.1.4.cmml" id="A3.I2.i2.p1.1.m1.1.1d.cmml" xref="A3.I2.i2.p1.1.m1.1.1"></share><cn id="A3.I2.i2.p1.1.m1.1.1.6.cmml" type="integer" xref="A3.I2.i2.p1.1.m1.1.1.6">27</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.I2.i2.p1.1.m1.1c">n=3^{3}=27</annotation><annotation encoding="application/x-llamapun" id="A3.I2.i2.p1.1.m1.1d">italic_n = 3 start_POSTSUPERSCRIPT 3 end_POSTSUPERSCRIPT = 27</annotation></semantics></math> repelling random walks <cite class="ltx_cite ltx_citemacro_citep">[Reid et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#bib.bib27" title="">2023b</a>]</cite>.
Instead of terminating, we sample <math alttext="3" class="ltx_Math" display="inline" id="A3.I2.i2.p1.2.m2.1"><semantics id="A3.I2.i2.p1.2.m2.1a"><mn id="A3.I2.i2.p1.2.m2.1.1" xref="A3.I2.i2.p1.2.m2.1.1.cmml">3</mn><annotation-xml encoding="MathML-Content" id="A3.I2.i2.p1.2.m2.1b"><cn id="A3.I2.i2.p1.2.m2.1.1.cmml" type="integer" xref="A3.I2.i2.p1.2.m2.1.1">3</cn></annotation-xml><annotation encoding="application/x-tex" id="A3.I2.i2.p1.2.m2.1c">3</annotation><annotation encoding="application/x-llamapun" id="A3.I2.i2.p1.2.m2.1d">3</annotation></semantics></math> hops deterministically since the computational bottleneck is finding the <math alttext="k" class="ltx_Math" display="inline" id="A3.I2.i2.p1.3.m3.1"><semantics id="A3.I2.i2.p1.3.m3.1a"><mi id="A3.I2.i2.p1.3.m3.1.1" xref="A3.I2.i2.p1.3.m3.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="A3.I2.i2.p1.3.m3.1b"><ci id="A3.I2.i2.p1.3.m3.1.1.cmml" xref="A3.I2.i2.p1.3.m3.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.I2.i2.p1.3.m3.1c">k</annotation><annotation encoding="application/x-llamapun" id="A3.I2.i2.p1.3.m3.1d">italic_k</annotation></semantics></math>-nearest neighbours list rather than sampling lengths once it has been computed.
We take <math alttext="\phi(\cdot)=\textrm{ReLU}(\cdot)" class="ltx_Math" display="inline" id="A3.I2.i2.p1.4.m4.2"><semantics id="A3.I2.i2.p1.4.m4.2a"><mrow id="A3.I2.i2.p1.4.m4.2.3" xref="A3.I2.i2.p1.4.m4.2.3.cmml"><mrow id="A3.I2.i2.p1.4.m4.2.3.2" xref="A3.I2.i2.p1.4.m4.2.3.2.cmml"><mi id="A3.I2.i2.p1.4.m4.2.3.2.2" xref="A3.I2.i2.p1.4.m4.2.3.2.2.cmml">ϕ</mi><mo id="A3.I2.i2.p1.4.m4.2.3.2.1" xref="A3.I2.i2.p1.4.m4.2.3.2.1.cmml">⁢</mo><mrow id="A3.I2.i2.p1.4.m4.2.3.2.3.2" xref="A3.I2.i2.p1.4.m4.2.3.2.cmml"><mo id="A3.I2.i2.p1.4.m4.2.3.2.3.2.1" stretchy="false" xref="A3.I2.i2.p1.4.m4.2.3.2.cmml">(</mo><mo id="A3.I2.i2.p1.4.m4.1.1" lspace="0em" rspace="0em" xref="A3.I2.i2.p1.4.m4.1.1.cmml">⋅</mo><mo id="A3.I2.i2.p1.4.m4.2.3.2.3.2.2" stretchy="false" xref="A3.I2.i2.p1.4.m4.2.3.2.cmml">)</mo></mrow></mrow><mo id="A3.I2.i2.p1.4.m4.2.3.1" xref="A3.I2.i2.p1.4.m4.2.3.1.cmml">=</mo><mrow id="A3.I2.i2.p1.4.m4.2.3.3" xref="A3.I2.i2.p1.4.m4.2.3.3.cmml"><mtext id="A3.I2.i2.p1.4.m4.2.3.3.2" xref="A3.I2.i2.p1.4.m4.2.3.3.2a.cmml">ReLU</mtext><mo id="A3.I2.i2.p1.4.m4.2.3.3.1" xref="A3.I2.i2.p1.4.m4.2.3.3.1.cmml">⁢</mo><mrow id="A3.I2.i2.p1.4.m4.2.3.3.3.2" xref="A3.I2.i2.p1.4.m4.2.3.3.cmml"><mo id="A3.I2.i2.p1.4.m4.2.3.3.3.2.1" stretchy="false" xref="A3.I2.i2.p1.4.m4.2.3.3.cmml">(</mo><mo id="A3.I2.i2.p1.4.m4.2.2" lspace="0em" rspace="0em" xref="A3.I2.i2.p1.4.m4.2.2.cmml">⋅</mo><mo id="A3.I2.i2.p1.4.m4.2.3.3.3.2.2" stretchy="false" xref="A3.I2.i2.p1.4.m4.2.3.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.I2.i2.p1.4.m4.2b"><apply id="A3.I2.i2.p1.4.m4.2.3.cmml" xref="A3.I2.i2.p1.4.m4.2.3"><eq id="A3.I2.i2.p1.4.m4.2.3.1.cmml" xref="A3.I2.i2.p1.4.m4.2.3.1"></eq><apply id="A3.I2.i2.p1.4.m4.2.3.2.cmml" xref="A3.I2.i2.p1.4.m4.2.3.2"><times id="A3.I2.i2.p1.4.m4.2.3.2.1.cmml" xref="A3.I2.i2.p1.4.m4.2.3.2.1"></times><ci id="A3.I2.i2.p1.4.m4.2.3.2.2.cmml" xref="A3.I2.i2.p1.4.m4.2.3.2.2">italic-ϕ</ci><ci id="A3.I2.i2.p1.4.m4.1.1.cmml" xref="A3.I2.i2.p1.4.m4.1.1">⋅</ci></apply><apply id="A3.I2.i2.p1.4.m4.2.3.3.cmml" xref="A3.I2.i2.p1.4.m4.2.3.3"><times id="A3.I2.i2.p1.4.m4.2.3.3.1.cmml" xref="A3.I2.i2.p1.4.m4.2.3.3.1"></times><ci id="A3.I2.i2.p1.4.m4.2.3.3.2a.cmml" xref="A3.I2.i2.p1.4.m4.2.3.3.2"><mtext id="A3.I2.i2.p1.4.m4.2.3.3.2.cmml" xref="A3.I2.i2.p1.4.m4.2.3.3.2">ReLU</mtext></ci><ci id="A3.I2.i2.p1.4.m4.2.2.cmml" xref="A3.I2.i2.p1.4.m4.2.2">⋅</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.I2.i2.p1.4.m4.2c">\phi(\cdot)=\textrm{ReLU}(\cdot)</annotation><annotation encoding="application/x-llamapun" id="A3.I2.i2.p1.4.m4.2d">italic_ϕ ( ⋅ ) = ReLU ( ⋅ )</annotation></semantics></math> and compute GRF-masked attention with a single head, projecting the queries and keys with a dense layer.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="A3.I2.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">3.</span>
<div class="ltx_para" id="A3.I2.i3.p1">
<p class="ltx_p" id="A3.I2.i3.p1.2">To construct <math alttext="\mathcal{G}" class="ltx_Math" display="inline" id="A3.I2.i3.p1.1.m1.1"><semantics id="A3.I2.i3.p1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="A3.I2.i3.p1.1.m1.1.1" xref="A3.I2.i3.p1.1.m1.1.1.cmml">𝒢</mi><annotation-xml encoding="MathML-Content" id="A3.I2.i3.p1.1.m1.1b"><ci id="A3.I2.i3.p1.1.m1.1.1.cmml" xref="A3.I2.i3.p1.1.m1.1.1">𝒢</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.I2.i3.p1.1.m1.1c">\mathcal{G}</annotation><annotation encoding="application/x-llamapun" id="A3.I2.i3.p1.1.m1.1d">caligraphic_G</annotation></semantics></math>, we find <math alttext="k=3" class="ltx_Math" display="inline" id="A3.I2.i3.p1.2.m2.1"><semantics id="A3.I2.i3.p1.2.m2.1a"><mrow id="A3.I2.i3.p1.2.m2.1.1" xref="A3.I2.i3.p1.2.m2.1.1.cmml"><mi id="A3.I2.i3.p1.2.m2.1.1.2" xref="A3.I2.i3.p1.2.m2.1.1.2.cmml">k</mi><mo id="A3.I2.i3.p1.2.m2.1.1.1" xref="A3.I2.i3.p1.2.m2.1.1.1.cmml">=</mo><mn id="A3.I2.i3.p1.2.m2.1.1.3" xref="A3.I2.i3.p1.2.m2.1.1.3.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="A3.I2.i3.p1.2.m2.1b"><apply id="A3.I2.i3.p1.2.m2.1.1.cmml" xref="A3.I2.i3.p1.2.m2.1.1"><eq id="A3.I2.i3.p1.2.m2.1.1.1.cmml" xref="A3.I2.i3.p1.2.m2.1.1.1"></eq><ci id="A3.I2.i3.p1.2.m2.1.1.2.cmml" xref="A3.I2.i3.p1.2.m2.1.1.2">𝑘</ci><cn id="A3.I2.i3.p1.2.m2.1.1.3.cmml" type="integer" xref="A3.I2.i3.p1.2.m2.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.I2.i3.p1.2.m2.1c">k=3</annotation><annotation encoding="application/x-llamapun" id="A3.I2.i3.p1.2.m2.1d">italic_k = 3</annotation></semantics></math> neighbours for every node. This is done on the fly since the neighbours can change at every timestep.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="A3.I2.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">4.</span>
<div class="ltx_para ltx_noindent" id="A3.I2.i4.p1">
<p class="ltx_p" id="A3.I2.i4.p1.2">For Fig.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#S4.F5" title="Figure 5 ‣ 4 Experiments ‣ Linear Transformer Topological Masking with Graph Random Features"><span class="ltx_text ltx_ref_tag">5</span></a>, we train for 100k steps, using a learning rate of <math alttext="3\times 10^{-4}" class="ltx_Math" display="inline" id="A3.I2.i4.p1.1.m1.1"><semantics id="A3.I2.i4.p1.1.m1.1a"><mrow id="A3.I2.i4.p1.1.m1.1.1" xref="A3.I2.i4.p1.1.m1.1.1.cmml"><mn id="A3.I2.i4.p1.1.m1.1.1.2" xref="A3.I2.i4.p1.1.m1.1.1.2.cmml">3</mn><mo id="A3.I2.i4.p1.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="A3.I2.i4.p1.1.m1.1.1.1.cmml">×</mo><msup id="A3.I2.i4.p1.1.m1.1.1.3" xref="A3.I2.i4.p1.1.m1.1.1.3.cmml"><mn id="A3.I2.i4.p1.1.m1.1.1.3.2" xref="A3.I2.i4.p1.1.m1.1.1.3.2.cmml">10</mn><mrow id="A3.I2.i4.p1.1.m1.1.1.3.3" xref="A3.I2.i4.p1.1.m1.1.1.3.3.cmml"><mo id="A3.I2.i4.p1.1.m1.1.1.3.3a" xref="A3.I2.i4.p1.1.m1.1.1.3.3.cmml">−</mo><mn id="A3.I2.i4.p1.1.m1.1.1.3.3.2" xref="A3.I2.i4.p1.1.m1.1.1.3.3.2.cmml">4</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A3.I2.i4.p1.1.m1.1b"><apply id="A3.I2.i4.p1.1.m1.1.1.cmml" xref="A3.I2.i4.p1.1.m1.1.1"><times id="A3.I2.i4.p1.1.m1.1.1.1.cmml" xref="A3.I2.i4.p1.1.m1.1.1.1"></times><cn id="A3.I2.i4.p1.1.m1.1.1.2.cmml" type="integer" xref="A3.I2.i4.p1.1.m1.1.1.2">3</cn><apply id="A3.I2.i4.p1.1.m1.1.1.3.cmml" xref="A3.I2.i4.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="A3.I2.i4.p1.1.m1.1.1.3.1.cmml" xref="A3.I2.i4.p1.1.m1.1.1.3">superscript</csymbol><cn id="A3.I2.i4.p1.1.m1.1.1.3.2.cmml" type="integer" xref="A3.I2.i4.p1.1.m1.1.1.3.2">10</cn><apply id="A3.I2.i4.p1.1.m1.1.1.3.3.cmml" xref="A3.I2.i4.p1.1.m1.1.1.3.3"><minus id="A3.I2.i4.p1.1.m1.1.1.3.3.1.cmml" xref="A3.I2.i4.p1.1.m1.1.1.3.3"></minus><cn id="A3.I2.i4.p1.1.m1.1.1.3.3.2.cmml" type="integer" xref="A3.I2.i4.p1.1.m1.1.1.3.3.2">4</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.I2.i4.p1.1.m1.1c">3\times 10^{-4}</annotation><annotation encoding="application/x-llamapun" id="A3.I2.i4.p1.1.m1.1d">3 × 10 start_POSTSUPERSCRIPT - 4 end_POSTSUPERSCRIPT</annotation></semantics></math> until step 1000 then <math alttext="1\times 10^{-4}" class="ltx_Math" display="inline" id="A3.I2.i4.p1.2.m2.1"><semantics id="A3.I2.i4.p1.2.m2.1a"><mrow id="A3.I2.i4.p1.2.m2.1.1" xref="A3.I2.i4.p1.2.m2.1.1.cmml"><mn id="A3.I2.i4.p1.2.m2.1.1.2" xref="A3.I2.i4.p1.2.m2.1.1.2.cmml">1</mn><mo id="A3.I2.i4.p1.2.m2.1.1.1" lspace="0.222em" rspace="0.222em" xref="A3.I2.i4.p1.2.m2.1.1.1.cmml">×</mo><msup id="A3.I2.i4.p1.2.m2.1.1.3" xref="A3.I2.i4.p1.2.m2.1.1.3.cmml"><mn id="A3.I2.i4.p1.2.m2.1.1.3.2" xref="A3.I2.i4.p1.2.m2.1.1.3.2.cmml">10</mn><mrow id="A3.I2.i4.p1.2.m2.1.1.3.3" xref="A3.I2.i4.p1.2.m2.1.1.3.3.cmml"><mo id="A3.I2.i4.p1.2.m2.1.1.3.3a" xref="A3.I2.i4.p1.2.m2.1.1.3.3.cmml">−</mo><mn id="A3.I2.i4.p1.2.m2.1.1.3.3.2" xref="A3.I2.i4.p1.2.m2.1.1.3.3.2.cmml">4</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A3.I2.i4.p1.2.m2.1b"><apply id="A3.I2.i4.p1.2.m2.1.1.cmml" xref="A3.I2.i4.p1.2.m2.1.1"><times id="A3.I2.i4.p1.2.m2.1.1.1.cmml" xref="A3.I2.i4.p1.2.m2.1.1.1"></times><cn id="A3.I2.i4.p1.2.m2.1.1.2.cmml" type="integer" xref="A3.I2.i4.p1.2.m2.1.1.2">1</cn><apply id="A3.I2.i4.p1.2.m2.1.1.3.cmml" xref="A3.I2.i4.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="A3.I2.i4.p1.2.m2.1.1.3.1.cmml" xref="A3.I2.i4.p1.2.m2.1.1.3">superscript</csymbol><cn id="A3.I2.i4.p1.2.m2.1.1.3.2.cmml" type="integer" xref="A3.I2.i4.p1.2.m2.1.1.3.2">10</cn><apply id="A3.I2.i4.p1.2.m2.1.1.3.3.cmml" xref="A3.I2.i4.p1.2.m2.1.1.3.3"><minus id="A3.I2.i4.p1.2.m2.1.1.3.3.1.cmml" xref="A3.I2.i4.p1.2.m2.1.1.3.3"></minus><cn id="A3.I2.i4.p1.2.m2.1.1.3.3.2.cmml" type="integer" xref="A3.I2.i4.p1.2.m2.1.1.3.3.2">4</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.I2.i4.p1.2.m2.1c">1\times 10^{-4}</annotation><annotation encoding="application/x-llamapun" id="A3.I2.i4.p1.2.m2.1d">1 × 10 start_POSTSUPERSCRIPT - 4 end_POSTSUPERSCRIPT</annotation></semantics></math> until step 100k.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
</ol>
<p class="ltx_p" id="A3.SS3.p4.8">To enumerate some other important details: all models are trained with a batch size of 16; we use the AdamW optimiser <cite class="ltx_cite ltx_citemacro_citep">[Loshchilov, <a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#bib.bib22" title="">2017</a>]</cite> with weight decay <math alttext="10^{-3}" class="ltx_Math" display="inline" id="A3.SS3.p4.1.m1.1"><semantics id="A3.SS3.p4.1.m1.1a"><msup id="A3.SS3.p4.1.m1.1.1" xref="A3.SS3.p4.1.m1.1.1.cmml"><mn id="A3.SS3.p4.1.m1.1.1.2" xref="A3.SS3.p4.1.m1.1.1.2.cmml">10</mn><mrow id="A3.SS3.p4.1.m1.1.1.3" xref="A3.SS3.p4.1.m1.1.1.3.cmml"><mo id="A3.SS3.p4.1.m1.1.1.3a" xref="A3.SS3.p4.1.m1.1.1.3.cmml">−</mo><mn id="A3.SS3.p4.1.m1.1.1.3.2" xref="A3.SS3.p4.1.m1.1.1.3.2.cmml">3</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="A3.SS3.p4.1.m1.1b"><apply id="A3.SS3.p4.1.m1.1.1.cmml" xref="A3.SS3.p4.1.m1.1.1"><csymbol cd="ambiguous" id="A3.SS3.p4.1.m1.1.1.1.cmml" xref="A3.SS3.p4.1.m1.1.1">superscript</csymbol><cn id="A3.SS3.p4.1.m1.1.1.2.cmml" type="integer" xref="A3.SS3.p4.1.m1.1.1.2">10</cn><apply id="A3.SS3.p4.1.m1.1.1.3.cmml" xref="A3.SS3.p4.1.m1.1.1.3"><minus id="A3.SS3.p4.1.m1.1.1.3.1.cmml" xref="A3.SS3.p4.1.m1.1.1.3"></minus><cn id="A3.SS3.p4.1.m1.1.1.3.2.cmml" type="integer" xref="A3.SS3.p4.1.m1.1.1.3.2">3</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS3.p4.1.m1.1c">10^{-3}</annotation><annotation encoding="application/x-llamapun" id="A3.SS3.p4.1.m1.1d">10 start_POSTSUPERSCRIPT - 3 end_POSTSUPERSCRIPT</annotation></semantics></math>, clipping the gradient norm to 0.01; models are trained with 6 step rollouts, with losses computed on 128 sampled rays; <math alttext="\Delta\bm{x}_{i}" class="ltx_Math" display="inline" id="A3.SS3.p4.2.m2.1"><semantics id="A3.SS3.p4.2.m2.1a"><mrow id="A3.SS3.p4.2.m2.1.1" xref="A3.SS3.p4.2.m2.1.1.cmml"><mi id="A3.SS3.p4.2.m2.1.1.2" mathvariant="normal" xref="A3.SS3.p4.2.m2.1.1.2.cmml">Δ</mi><mo id="A3.SS3.p4.2.m2.1.1.1" xref="A3.SS3.p4.2.m2.1.1.1.cmml">⁢</mo><msub id="A3.SS3.p4.2.m2.1.1.3" xref="A3.SS3.p4.2.m2.1.1.3.cmml"><mi id="A3.SS3.p4.2.m2.1.1.3.2" xref="A3.SS3.p4.2.m2.1.1.3.2.cmml">𝒙</mi><mi id="A3.SS3.p4.2.m2.1.1.3.3" xref="A3.SS3.p4.2.m2.1.1.3.3.cmml">i</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="A3.SS3.p4.2.m2.1b"><apply id="A3.SS3.p4.2.m2.1.1.cmml" xref="A3.SS3.p4.2.m2.1.1"><times id="A3.SS3.p4.2.m2.1.1.1.cmml" xref="A3.SS3.p4.2.m2.1.1.1"></times><ci id="A3.SS3.p4.2.m2.1.1.2.cmml" xref="A3.SS3.p4.2.m2.1.1.2">Δ</ci><apply id="A3.SS3.p4.2.m2.1.1.3.cmml" xref="A3.SS3.p4.2.m2.1.1.3"><csymbol cd="ambiguous" id="A3.SS3.p4.2.m2.1.1.3.1.cmml" xref="A3.SS3.p4.2.m2.1.1.3">subscript</csymbol><ci id="A3.SS3.p4.2.m2.1.1.3.2.cmml" xref="A3.SS3.p4.2.m2.1.1.3.2">𝒙</ci><ci id="A3.SS3.p4.2.m2.1.1.3.3.cmml" xref="A3.SS3.p4.2.m2.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS3.p4.2.m2.1c">\Delta\bm{x}_{i}</annotation><annotation encoding="application/x-llamapun" id="A3.SS3.p4.2.m2.1d">roman_Δ bold_italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> are constrained to <math alttext="[-0.25,0.25]" class="ltx_Math" display="inline" id="A3.SS3.p4.3.m3.2"><semantics id="A3.SS3.p4.3.m3.2a"><mrow id="A3.SS3.p4.3.m3.2.2.1" xref="A3.SS3.p4.3.m3.2.2.2.cmml"><mo id="A3.SS3.p4.3.m3.2.2.1.2" stretchy="false" xref="A3.SS3.p4.3.m3.2.2.2.cmml">[</mo><mrow id="A3.SS3.p4.3.m3.2.2.1.1" xref="A3.SS3.p4.3.m3.2.2.1.1.cmml"><mo id="A3.SS3.p4.3.m3.2.2.1.1a" xref="A3.SS3.p4.3.m3.2.2.1.1.cmml">−</mo><mn id="A3.SS3.p4.3.m3.2.2.1.1.2" xref="A3.SS3.p4.3.m3.2.2.1.1.2.cmml">0.25</mn></mrow><mo id="A3.SS3.p4.3.m3.2.2.1.3" xref="A3.SS3.p4.3.m3.2.2.2.cmml">,</mo><mn id="A3.SS3.p4.3.m3.1.1" xref="A3.SS3.p4.3.m3.1.1.cmml">0.25</mn><mo id="A3.SS3.p4.3.m3.2.2.1.4" stretchy="false" xref="A3.SS3.p4.3.m3.2.2.2.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="A3.SS3.p4.3.m3.2b"><interval closure="closed" id="A3.SS3.p4.3.m3.2.2.2.cmml" xref="A3.SS3.p4.3.m3.2.2.1"><apply id="A3.SS3.p4.3.m3.2.2.1.1.cmml" xref="A3.SS3.p4.3.m3.2.2.1.1"><minus id="A3.SS3.p4.3.m3.2.2.1.1.1.cmml" xref="A3.SS3.p4.3.m3.2.2.1.1"></minus><cn id="A3.SS3.p4.3.m3.2.2.1.1.2.cmml" type="float" xref="A3.SS3.p4.3.m3.2.2.1.1.2">0.25</cn></apply><cn id="A3.SS3.p4.3.m3.1.1.cmml" type="float" xref="A3.SS3.p4.3.m3.1.1">0.25</cn></interval></annotation-xml><annotation encoding="application/x-tex" id="A3.SS3.p4.3.m3.2c">[-0.25,0.25]</annotation><annotation encoding="application/x-llamapun" id="A3.SS3.p4.3.m3.2d">[ - 0.25 , 0.25 ]</annotation></semantics></math> by a scaled <math alttext="\tanh" class="ltx_Math" display="inline" id="A3.SS3.p4.4.m4.1"><semantics id="A3.SS3.p4.4.m4.1a"><mi id="A3.SS3.p4.4.m4.1.1" xref="A3.SS3.p4.4.m4.1.1.cmml">tanh</mi><annotation-xml encoding="MathML-Content" id="A3.SS3.p4.4.m4.1b"><tanh id="A3.SS3.p4.4.m4.1.1.cmml" xref="A3.SS3.p4.4.m4.1.1"></tanh></annotation-xml><annotation encoding="application/x-tex" id="A3.SS3.p4.4.m4.1c">\tanh</annotation><annotation encoding="application/x-llamapun" id="A3.SS3.p4.4.m4.1d">roman_tanh</annotation></semantics></math> nonlinearity so particles do not move more than <math alttext="25" class="ltx_Math" display="inline" id="A3.SS3.p4.5.m5.1"><semantics id="A3.SS3.p4.5.m5.1a"><mn id="A3.SS3.p4.5.m5.1.1" xref="A3.SS3.p4.5.m5.1.1.cmml">25</mn><annotation-xml encoding="MathML-Content" id="A3.SS3.p4.5.m5.1b"><cn id="A3.SS3.p4.5.m5.1.1.cmml" type="integer" xref="A3.SS3.p4.5.m5.1.1">25</cn></annotation-xml><annotation encoding="application/x-tex" id="A3.SS3.p4.5.m5.1c">25</annotation><annotation encoding="application/x-llamapun" id="A3.SS3.p4.5.m5.1d">25</annotation></semantics></math>cm per timestep.
For the rendering, like <cite class="ltx_cite ltx_citemacro_citet">Whitney et&nbsp;al. [<a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#bib.bib38" title="">2024</a>]</cite> we use four concentric annular kernels of radii <math alttext="[0,0.01,0.02,0.05]" class="ltx_Math" display="inline" id="A3.SS3.p4.6.m6.4"><semantics id="A3.SS3.p4.6.m6.4a"><mrow id="A3.SS3.p4.6.m6.4.5.2" xref="A3.SS3.p4.6.m6.4.5.1.cmml"><mo id="A3.SS3.p4.6.m6.4.5.2.1" stretchy="false" xref="A3.SS3.p4.6.m6.4.5.1.cmml">[</mo><mn id="A3.SS3.p4.6.m6.1.1" xref="A3.SS3.p4.6.m6.1.1.cmml">0</mn><mo id="A3.SS3.p4.6.m6.4.5.2.2" xref="A3.SS3.p4.6.m6.4.5.1.cmml">,</mo><mn id="A3.SS3.p4.6.m6.2.2" xref="A3.SS3.p4.6.m6.2.2.cmml">0.01</mn><mo id="A3.SS3.p4.6.m6.4.5.2.3" xref="A3.SS3.p4.6.m6.4.5.1.cmml">,</mo><mn id="A3.SS3.p4.6.m6.3.3" xref="A3.SS3.p4.6.m6.3.3.cmml">0.02</mn><mo id="A3.SS3.p4.6.m6.4.5.2.4" xref="A3.SS3.p4.6.m6.4.5.1.cmml">,</mo><mn id="A3.SS3.p4.6.m6.4.4" xref="A3.SS3.p4.6.m6.4.4.cmml">0.05</mn><mo id="A3.SS3.p4.6.m6.4.5.2.5" stretchy="false" xref="A3.SS3.p4.6.m6.4.5.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="A3.SS3.p4.6.m6.4b"><list id="A3.SS3.p4.6.m6.4.5.1.cmml" xref="A3.SS3.p4.6.m6.4.5.2"><cn id="A3.SS3.p4.6.m6.1.1.cmml" type="integer" xref="A3.SS3.p4.6.m6.1.1">0</cn><cn id="A3.SS3.p4.6.m6.2.2.cmml" type="float" xref="A3.SS3.p4.6.m6.2.2">0.01</cn><cn id="A3.SS3.p4.6.m6.3.3.cmml" type="float" xref="A3.SS3.p4.6.m6.3.3">0.02</cn><cn id="A3.SS3.p4.6.m6.4.4.cmml" type="float" xref="A3.SS3.p4.6.m6.4.4">0.05</cn></list></annotation-xml><annotation encoding="application/x-tex" id="A3.SS3.p4.6.m6.4c">[0,0.01,0.02,0.05]</annotation><annotation encoding="application/x-llamapun" id="A3.SS3.p4.6.m6.4d">[ 0 , 0.01 , 0.02 , 0.05 ]</annotation></semantics></math> with bandwidths <math alttext="[0.01,0.01,0.01,0.05]" class="ltx_Math" display="inline" id="A3.SS3.p4.7.m7.4"><semantics id="A3.SS3.p4.7.m7.4a"><mrow id="A3.SS3.p4.7.m7.4.5.2" xref="A3.SS3.p4.7.m7.4.5.1.cmml"><mo id="A3.SS3.p4.7.m7.4.5.2.1" stretchy="false" xref="A3.SS3.p4.7.m7.4.5.1.cmml">[</mo><mn id="A3.SS3.p4.7.m7.1.1" xref="A3.SS3.p4.7.m7.1.1.cmml">0.01</mn><mo id="A3.SS3.p4.7.m7.4.5.2.2" xref="A3.SS3.p4.7.m7.4.5.1.cmml">,</mo><mn id="A3.SS3.p4.7.m7.2.2" xref="A3.SS3.p4.7.m7.2.2.cmml">0.01</mn><mo id="A3.SS3.p4.7.m7.4.5.2.3" xref="A3.SS3.p4.7.m7.4.5.1.cmml">,</mo><mn id="A3.SS3.p4.7.m7.3.3" xref="A3.SS3.p4.7.m7.3.3.cmml">0.01</mn><mo id="A3.SS3.p4.7.m7.4.5.2.4" xref="A3.SS3.p4.7.m7.4.5.1.cmml">,</mo><mn id="A3.SS3.p4.7.m7.4.4" xref="A3.SS3.p4.7.m7.4.4.cmml">0.05</mn><mo id="A3.SS3.p4.7.m7.4.5.2.5" stretchy="false" xref="A3.SS3.p4.7.m7.4.5.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="A3.SS3.p4.7.m7.4b"><list id="A3.SS3.p4.7.m7.4.5.1.cmml" xref="A3.SS3.p4.7.m7.4.5.2"><cn id="A3.SS3.p4.7.m7.1.1.cmml" type="float" xref="A3.SS3.p4.7.m7.1.1">0.01</cn><cn id="A3.SS3.p4.7.m7.2.2.cmml" type="float" xref="A3.SS3.p4.7.m7.2.2">0.01</cn><cn id="A3.SS3.p4.7.m7.3.3.cmml" type="float" xref="A3.SS3.p4.7.m7.3.3">0.01</cn><cn id="A3.SS3.p4.7.m7.4.4.cmml" type="float" xref="A3.SS3.p4.7.m7.4.4">0.05</cn></list></annotation-xml><annotation encoding="application/x-tex" id="A3.SS3.p4.7.m7.4c">[0.01,0.01,0.01,0.05]</annotation><annotation encoding="application/x-llamapun" id="A3.SS3.p4.7.m7.4d">[ 0.01 , 0.01 , 0.01 , 0.05 ]</annotation></semantics></math>, approximated using <math alttext="16" class="ltx_Math" display="inline" id="A3.SS3.p4.8.m8.1"><semantics id="A3.SS3.p4.8.m8.1a"><mn id="A3.SS3.p4.8.m8.1.1" xref="A3.SS3.p4.8.m8.1.1.cmml">16</mn><annotation-xml encoding="MathML-Content" id="A3.SS3.p4.8.m8.1b"><cn id="A3.SS3.p4.8.m8.1.1.cmml" type="integer" xref="A3.SS3.p4.8.m8.1.1">16</cn></annotation-xml><annotation encoding="application/x-tex" id="A3.SS3.p4.8.m8.1c">16</annotation><annotation encoding="application/x-llamapun" id="A3.SS3.p4.8.m8.1d">16</annotation></semantics></math> nearest neighbours.
The near plane is 0.1m and the far plane is 2m, with the background set to solid white.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_subsection" id="A3.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">C.4 </span>ViViT: topological masking for video data</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_table ltx_align_floatright" id="A3.T4">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 4: </span>ViViT test accuracies on the Kinetics benchmark.
Topological masking with GRFs boosts performance.</figcaption>
<table class="ltx_tabular ltx_centering ltx_align_middle" id="A3.T4.2">
<tbody><tr class="ltx_tr" id="A3.T4.2.3">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="A3.T4.2.3.1" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_smallcaps" id="A3.T4.2.3.1.1">Variant</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A3.T4.2.3.2" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_smallcaps" id="A3.T4.2.3.2.1">Test acc.</span></td>
</tr>
<tr class="ltx_tr" id="A3.T4.1.1">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A3.T4.1.1.2" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_smallcaps" id="A3.T4.1.1.2.1">Softmax</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A3.T4.1.1.1" style="padding-left:3.0pt;padding-right:3.0pt;"><math alttext="0.754" class="ltx_Math" display="inline" id="A3.T4.1.1.1.m1.1"><semantics id="A3.T4.1.1.1.m1.1a"><mn id="A3.T4.1.1.1.m1.1.1" xref="A3.T4.1.1.1.m1.1.1.cmml">0.754</mn><annotation-xml encoding="MathML-Content" id="A3.T4.1.1.1.m1.1b"><cn id="A3.T4.1.1.1.m1.1.1.cmml" type="float" xref="A3.T4.1.1.1.m1.1.1">0.754</cn></annotation-xml><annotation encoding="application/x-tex" id="A3.T4.1.1.1.m1.1c">0.754</annotation><annotation encoding="application/x-llamapun" id="A3.T4.1.1.1.m1.1d">0.754</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A3.T4.2.2">
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="A3.T4.2.2.2" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_smallcaps" id="A3.T4.2.2.2.1">Softmax + GRFs</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A3.T4.2.2.1" style="padding-left:3.0pt;padding-right:3.0pt;"><math alttext="0.758" class="ltx_Math" display="inline" id="A3.T4.2.2.1.m1.1"><semantics id="A3.T4.2.2.1.m1.1a"><mn id="A3.T4.2.2.1.m1.1.1" xref="A3.T4.2.2.1.m1.1.1.cmml">0.758</mn><annotation-xml encoding="MathML-Content" id="A3.T4.2.2.1.m1.1b"><cn id="A3.T4.2.2.1.m1.1.1.cmml" type="float" xref="A3.T4.2.2.1.m1.1.1">0.758</cn></annotation-xml><annotation encoding="application/x-tex" id="A3.T4.2.2.1.m1.1c">0.758</annotation><annotation encoding="application/x-llamapun" id="A3.T4.2.2.1.m1.1d">0.758</annotation></semantics></math></td>
</tr>
</tbody></table>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="A3.SS4.p1">
<p class="ltx_p" id="A3.SS4.p1.7">Here, we present preliminary results for incorporating topological masking with graph random features into video vision transformers <cite class="ltx_cite ltx_citemacro_citep">[ViViT; Arnab et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#bib.bib1" title="">2021</a>]</cite>.
Prompted by the original paper, we use a factorised encoder, where the spatial encoder follows the ViT architecture from earlier in the paper (see Sec.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#S4" title="4 Experiments ‣ Linear Transformer Topological Masking with Graph Random Features"><span class="ltx_text ltx_ref_tag">4</span></a> and App.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#A3.SS1" title="C.1 Architectures, hyperparameters and training details ‣ Appendix C Further experiments and details ‣ Linear Transformer Topological Masking with Graph Random Features"><span class="ltx_text ltx_ref_tag">C.1</span></a>) with patch size <math alttext="16\times 16\times 2" class="ltx_Math" display="inline" id="A3.SS4.p1.1.m1.1"><semantics id="A3.SS4.p1.1.m1.1a"><mrow id="A3.SS4.p1.1.m1.1.1" xref="A3.SS4.p1.1.m1.1.1.cmml"><mn id="A3.SS4.p1.1.m1.1.1.2" xref="A3.SS4.p1.1.m1.1.1.2.cmml">16</mn><mo id="A3.SS4.p1.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="A3.SS4.p1.1.m1.1.1.1.cmml">×</mo><mn id="A3.SS4.p1.1.m1.1.1.3" xref="A3.SS4.p1.1.m1.1.1.3.cmml">16</mn><mo id="A3.SS4.p1.1.m1.1.1.1a" lspace="0.222em" rspace="0.222em" xref="A3.SS4.p1.1.m1.1.1.1.cmml">×</mo><mn id="A3.SS4.p1.1.m1.1.1.4" xref="A3.SS4.p1.1.m1.1.1.4.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="A3.SS4.p1.1.m1.1b"><apply id="A3.SS4.p1.1.m1.1.1.cmml" xref="A3.SS4.p1.1.m1.1.1"><times id="A3.SS4.p1.1.m1.1.1.1.cmml" xref="A3.SS4.p1.1.m1.1.1.1"></times><cn id="A3.SS4.p1.1.m1.1.1.2.cmml" type="integer" xref="A3.SS4.p1.1.m1.1.1.2">16</cn><cn id="A3.SS4.p1.1.m1.1.1.3.cmml" type="integer" xref="A3.SS4.p1.1.m1.1.1.3">16</cn><cn id="A3.SS4.p1.1.m1.1.1.4.cmml" type="integer" xref="A3.SS4.p1.1.m1.1.1.4">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS4.p1.1.m1.1c">16\times 16\times 2</annotation><annotation encoding="application/x-llamapun" id="A3.SS4.p1.1.m1.1d">16 × 16 × 2</annotation></semantics></math>.
The final index mixes pairs of successive frames.
The temporal encoder, which subsequently models interactions between the frame-level representations, also follows this architecture but with <math alttext="4" class="ltx_Math" display="inline" id="A3.SS4.p1.2.m2.1"><semantics id="A3.SS4.p1.2.m2.1a"><mn id="A3.SS4.p1.2.m2.1.1" xref="A3.SS4.p1.2.m2.1.1.cmml">4</mn><annotation-xml encoding="MathML-Content" id="A3.SS4.p1.2.m2.1b"><cn id="A3.SS4.p1.2.m2.1.1.cmml" type="integer" xref="A3.SS4.p1.2.m2.1.1">4</cn></annotation-xml><annotation encoding="application/x-tex" id="A3.SS4.p1.2.m2.1c">4</annotation><annotation encoding="application/x-llamapun" id="A3.SS4.p1.2.m2.1d">4</annotation></semantics></math> layers instead of <math alttext="12" class="ltx_Math" display="inline" id="A3.SS4.p1.3.m3.1"><semantics id="A3.SS4.p1.3.m3.1a"><mn id="A3.SS4.p1.3.m3.1.1" xref="A3.SS4.p1.3.m3.1.1.cmml">12</mn><annotation-xml encoding="MathML-Content" id="A3.SS4.p1.3.m3.1b"><cn id="A3.SS4.p1.3.m3.1.1.cmml" type="integer" xref="A3.SS4.p1.3.m3.1.1">12</cn></annotation-xml><annotation encoding="application/x-tex" id="A3.SS4.p1.3.m3.1c">12</annotation><annotation encoding="application/x-llamapun" id="A3.SS4.p1.3.m3.1d">12</annotation></semantics></math>.
We train for <math alttext="30" class="ltx_Math" display="inline" id="A3.SS4.p1.4.m4.1"><semantics id="A3.SS4.p1.4.m4.1a"><mn id="A3.SS4.p1.4.m4.1.1" xref="A3.SS4.p1.4.m4.1.1.cmml">30</mn><annotation-xml encoding="MathML-Content" id="A3.SS4.p1.4.m4.1b"><cn id="A3.SS4.p1.4.m4.1.1.cmml" type="integer" xref="A3.SS4.p1.4.m4.1.1">30</cn></annotation-xml><annotation encoding="application/x-tex" id="A3.SS4.p1.4.m4.1c">30</annotation><annotation encoding="application/x-llamapun" id="A3.SS4.p1.4.m4.1d">30</annotation></semantics></math> epochs using the Adam optimiser, with base learning rate <math alttext="10^{-1}" class="ltx_Math" display="inline" id="A3.SS4.p1.5.m5.1"><semantics id="A3.SS4.p1.5.m5.1a"><msup id="A3.SS4.p1.5.m5.1.1" xref="A3.SS4.p1.5.m5.1.1.cmml"><mn id="A3.SS4.p1.5.m5.1.1.2" xref="A3.SS4.p1.5.m5.1.1.2.cmml">10</mn><mrow id="A3.SS4.p1.5.m5.1.1.3" xref="A3.SS4.p1.5.m5.1.1.3.cmml"><mo id="A3.SS4.p1.5.m5.1.1.3a" xref="A3.SS4.p1.5.m5.1.1.3.cmml">−</mo><mn id="A3.SS4.p1.5.m5.1.1.3.2" xref="A3.SS4.p1.5.m5.1.1.3.2.cmml">1</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="A3.SS4.p1.5.m5.1b"><apply id="A3.SS4.p1.5.m5.1.1.cmml" xref="A3.SS4.p1.5.m5.1.1"><csymbol cd="ambiguous" id="A3.SS4.p1.5.m5.1.1.1.cmml" xref="A3.SS4.p1.5.m5.1.1">superscript</csymbol><cn id="A3.SS4.p1.5.m5.1.1.2.cmml" type="integer" xref="A3.SS4.p1.5.m5.1.1.2">10</cn><apply id="A3.SS4.p1.5.m5.1.1.3.cmml" xref="A3.SS4.p1.5.m5.1.1.3"><minus id="A3.SS4.p1.5.m5.1.1.3.1.cmml" xref="A3.SS4.p1.5.m5.1.1.3"></minus><cn id="A3.SS4.p1.5.m5.1.1.3.2.cmml" type="integer" xref="A3.SS4.p1.5.m5.1.1.3.2">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS4.p1.5.m5.1c">10^{-1}</annotation><annotation encoding="application/x-llamapun" id="A3.SS4.p1.5.m5.1d">10 start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT</annotation></semantics></math> and final learning rate <math alttext="10^{-4}" class="ltx_Math" display="inline" id="A3.SS4.p1.6.m6.1"><semantics id="A3.SS4.p1.6.m6.1a"><msup id="A3.SS4.p1.6.m6.1.1" xref="A3.SS4.p1.6.m6.1.1.cmml"><mn id="A3.SS4.p1.6.m6.1.1.2" xref="A3.SS4.p1.6.m6.1.1.2.cmml">10</mn><mrow id="A3.SS4.p1.6.m6.1.1.3" xref="A3.SS4.p1.6.m6.1.1.3.cmml"><mo id="A3.SS4.p1.6.m6.1.1.3a" xref="A3.SS4.p1.6.m6.1.1.3.cmml">−</mo><mn id="A3.SS4.p1.6.m6.1.1.3.2" xref="A3.SS4.p1.6.m6.1.1.3.2.cmml">4</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="A3.SS4.p1.6.m6.1b"><apply id="A3.SS4.p1.6.m6.1.1.cmml" xref="A3.SS4.p1.6.m6.1.1"><csymbol cd="ambiguous" id="A3.SS4.p1.6.m6.1.1.1.cmml" xref="A3.SS4.p1.6.m6.1.1">superscript</csymbol><cn id="A3.SS4.p1.6.m6.1.1.2.cmml" type="integer" xref="A3.SS4.p1.6.m6.1.1.2">10</cn><apply id="A3.SS4.p1.6.m6.1.1.3.cmml" xref="A3.SS4.p1.6.m6.1.1.3"><minus id="A3.SS4.p1.6.m6.1.1.3.1.cmml" xref="A3.SS4.p1.6.m6.1.1.3"></minus><cn id="A3.SS4.p1.6.m6.1.1.3.2.cmml" type="integer" xref="A3.SS4.p1.6.m6.1.1.3.2">4</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS4.p1.6.m6.1c">10^{-4}</annotation><annotation encoding="application/x-llamapun" id="A3.SS4.p1.6.m6.1d">10 start_POSTSUPERSCRIPT - 4 end_POSTSUPERSCRIPT</annotation></semantics></math>. We take the same schedule as in Table <a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#A3.T2" title="Table 2 ‣ C.1 Architectures, hyperparameters and training details ‣ Appendix C Further experiments and details ‣ Linear Transformer Topological Masking with Graph Random Features"><span class="ltx_text ltx_ref_tag">2</span></a>.
We train and evaluate on the Kinetics 400 benchmark <cite class="ltx_cite ltx_citemacro_citep">[Kay et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#bib.bib17" title="">2017</a>]</cite>.
Table <a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#A3.T4" title="Table 4 ‣ C.4 ViViT: topological masking for video data ‣ Appendix C Further experiments and details ‣ Linear Transformer Topological Masking with Graph Random Features"><span class="ltx_text ltx_ref_tag">4</span></a> shows the results for (i) unmasked softmax attention and (ii) softmax attention with GRFs.
Topological masking boosts predictive performance by <math alttext="\mathbf{+0.4\%}" class="ltx_Math" display="inline" id="A3.SS4.p1.7.m7.1"><semantics id="A3.SS4.p1.7.m7.1a"><mrow id="A3.SS4.p1.7.m7.1.1" xref="A3.SS4.p1.7.m7.1.1.cmml"><mo id="A3.SS4.p1.7.m7.1.1a" xref="A3.SS4.p1.7.m7.1.1.cmml">+</mo><mrow id="A3.SS4.p1.7.m7.1.1.2" xref="A3.SS4.p1.7.m7.1.1.2.cmml"><mn class="ltx_mathvariant_bold" id="A3.SS4.p1.7.m7.1.1.2.2" mathvariant="bold" xref="A3.SS4.p1.7.m7.1.1.2.2.cmml">0.4</mn><mo id="A3.SS4.p1.7.m7.1.1.2.1" xref="A3.SS4.p1.7.m7.1.1.2.1.cmml">%</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.SS4.p1.7.m7.1b"><apply id="A3.SS4.p1.7.m7.1.1.cmml" xref="A3.SS4.p1.7.m7.1.1"><plus id="A3.SS4.p1.7.m7.1.1.1.cmml" xref="A3.SS4.p1.7.m7.1.1"></plus><apply id="A3.SS4.p1.7.m7.1.1.2.cmml" xref="A3.SS4.p1.7.m7.1.1.2"><csymbol cd="latexml" id="A3.SS4.p1.7.m7.1.1.2.1.cmml" xref="A3.SS4.p1.7.m7.1.1.2.1">percent</csymbol><cn id="A3.SS4.p1.7.m7.1.1.2.2.cmml" type="float" xref="A3.SS4.p1.7.m7.1.1.2.2">0.4</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS4.p1.7.m7.1c">\mathbf{+0.4\%}</annotation><annotation encoding="application/x-llamapun" id="A3.SS4.p1.7.m7.1d">+ bold_0.4 %</annotation></semantics></math>.
To our knowledge, this is the first application of topological masking to the video modality.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
</section>
<section class="ltx_appendix" id="A4">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix D </span>Asymmetric graph random features</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="A4.p1">
<p class="ltx_p" id="A4.p1.1">In this Appendix, we present a variant of our core topological masking algorithm that relaxes the assumption that the function <math alttext="f" class="ltx_Math" display="inline" id="A4.p1.1.m1.1"><semantics id="A4.p1.1.m1.1a"><mi id="A4.p1.1.m1.1.1" xref="A4.p1.1.m1.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="A4.p1.1.m1.1b"><ci id="A4.p1.1.m1.1.1.cmml" xref="A4.p1.1.m1.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.p1.1.m1.1c">f</annotation><annotation encoding="application/x-llamapun" id="A4.p1.1.m1.1d">italic_f</annotation></semantics></math> for the query and key ensembles of walkers are identical, instead using <em class="ltx_emph ltx_font_italic" id="A4.p1.1.1">asymmetric</em> graph random features.
These are believed (but not proved) to generally give higher variance mask estimates <cite class="ltx_cite ltx_citemacro_citep">[Reid et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#bib.bib29" title="">2024b</a>]</cite>, but
making a judicious choice can also bring computational and implementation benefits.
Using asymmetric GRFs for topological masking is also a novel contribution of this paper.
In Sec.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#S4" title="4 Experiments ‣ Linear Transformer Topological Masking with Graph Random Features"><span class="ltx_text ltx_ref_tag">4</span></a>, it is found to be a convenient choice for the Interlacer <cite class="ltx_cite ltx_citemacro_citep">[Whitney et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#bib.bib37" title="">2023</a>]</cite> because it can be straightforwardly swapped into existing code.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="A4.p2">
<p class="ltx_p" id="A4.p2.5"><span class="ltx_text ltx_font_bold" id="A4.p2.5.1">Asymmetric GRFs.</span>
It is straightforward to see that Eq.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#A1.E13" title="In A.1 Proof of Remark 3.1 ‣ Appendix A Proofs ‣ Linear Transformer Topological Masking with Graph Random Features"><span class="ltx_text ltx_ref_tag">13</span></a> of App.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#A1.SS1" title="A.1 Proof of Remark 3.1 ‣ Appendix A Proofs ‣ Linear Transformer Topological Masking with Graph Random Features"><span class="ltx_text ltx_ref_tag">A.1</span></a> generalises to</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equation ltx_eqn_table" id="A4.E22">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{M}_{\alpha}(\mathcal{G})_{ij}=\sum_{v=1}^{N}\left(\sum_{k_{1}=0}^{%
\infty}f_{k_{1}}^{(1)}\mathbf{W}^{k_{1}}_{iv}\right)\left(\sum_{k_{2}=0}^{%
\infty}f_{k_{2}}^{(2)}\mathbf{W}^{k_{2}}_{jv}\right)" class="ltx_Math" display="block" id="A4.E22.m1.5"><semantics id="A4.E22.m1.5a"><mrow id="A4.E22.m1.5.5" xref="A4.E22.m1.5.5.cmml"><mrow id="A4.E22.m1.5.5.4" xref="A4.E22.m1.5.5.4.cmml"><msub id="A4.E22.m1.5.5.4.2" xref="A4.E22.m1.5.5.4.2.cmml"><mi id="A4.E22.m1.5.5.4.2.2" xref="A4.E22.m1.5.5.4.2.2.cmml">𝐌</mi><mi id="A4.E22.m1.5.5.4.2.3" xref="A4.E22.m1.5.5.4.2.3.cmml">α</mi></msub><mo id="A4.E22.m1.5.5.4.1" xref="A4.E22.m1.5.5.4.1.cmml">⁢</mo><msub id="A4.E22.m1.5.5.4.3" xref="A4.E22.m1.5.5.4.3.cmml"><mrow id="A4.E22.m1.5.5.4.3.2.2" xref="A4.E22.m1.5.5.4.3.cmml"><mo id="A4.E22.m1.5.5.4.3.2.2.1" stretchy="false" xref="A4.E22.m1.5.5.4.3.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="A4.E22.m1.3.3" xref="A4.E22.m1.3.3.cmml">𝒢</mi><mo id="A4.E22.m1.5.5.4.3.2.2.2" stretchy="false" xref="A4.E22.m1.5.5.4.3.cmml">)</mo></mrow><mrow id="A4.E22.m1.5.5.4.3.3" xref="A4.E22.m1.5.5.4.3.3.cmml"><mi id="A4.E22.m1.5.5.4.3.3.2" xref="A4.E22.m1.5.5.4.3.3.2.cmml">i</mi><mo id="A4.E22.m1.5.5.4.3.3.1" xref="A4.E22.m1.5.5.4.3.3.1.cmml">⁢</mo><mi id="A4.E22.m1.5.5.4.3.3.3" xref="A4.E22.m1.5.5.4.3.3.3.cmml">j</mi></mrow></msub></mrow><mo id="A4.E22.m1.5.5.3" rspace="0.111em" xref="A4.E22.m1.5.5.3.cmml">=</mo><mrow id="A4.E22.m1.5.5.2" xref="A4.E22.m1.5.5.2.cmml"><munderover id="A4.E22.m1.5.5.2.3" xref="A4.E22.m1.5.5.2.3.cmml"><mo id="A4.E22.m1.5.5.2.3.2.2" movablelimits="false" rspace="0em" xref="A4.E22.m1.5.5.2.3.2.2.cmml">∑</mo><mrow id="A4.E22.m1.5.5.2.3.2.3" xref="A4.E22.m1.5.5.2.3.2.3.cmml"><mi id="A4.E22.m1.5.5.2.3.2.3.2" xref="A4.E22.m1.5.5.2.3.2.3.2.cmml">v</mi><mo id="A4.E22.m1.5.5.2.3.2.3.1" xref="A4.E22.m1.5.5.2.3.2.3.1.cmml">=</mo><mn id="A4.E22.m1.5.5.2.3.2.3.3" xref="A4.E22.m1.5.5.2.3.2.3.3.cmml">1</mn></mrow><mi id="A4.E22.m1.5.5.2.3.3" xref="A4.E22.m1.5.5.2.3.3.cmml">N</mi></munderover><mrow id="A4.E22.m1.5.5.2.2" xref="A4.E22.m1.5.5.2.2.cmml"><mrow id="A4.E22.m1.4.4.1.1.1.1" xref="A4.E22.m1.4.4.1.1.1.1.1.cmml"><mo id="A4.E22.m1.4.4.1.1.1.1.2" xref="A4.E22.m1.4.4.1.1.1.1.1.cmml">(</mo><mrow id="A4.E22.m1.4.4.1.1.1.1.1" xref="A4.E22.m1.4.4.1.1.1.1.1.cmml"><munderover id="A4.E22.m1.4.4.1.1.1.1.1.1" xref="A4.E22.m1.4.4.1.1.1.1.1.1.cmml"><mo id="A4.E22.m1.4.4.1.1.1.1.1.1.2.2" lspace="0em" movablelimits="false" xref="A4.E22.m1.4.4.1.1.1.1.1.1.2.2.cmml">∑</mo><mrow id="A4.E22.m1.4.4.1.1.1.1.1.1.2.3" xref="A4.E22.m1.4.4.1.1.1.1.1.1.2.3.cmml"><msub id="A4.E22.m1.4.4.1.1.1.1.1.1.2.3.2" xref="A4.E22.m1.4.4.1.1.1.1.1.1.2.3.2.cmml"><mi id="A4.E22.m1.4.4.1.1.1.1.1.1.2.3.2.2" xref="A4.E22.m1.4.4.1.1.1.1.1.1.2.3.2.2.cmml">k</mi><mn id="A4.E22.m1.4.4.1.1.1.1.1.1.2.3.2.3" xref="A4.E22.m1.4.4.1.1.1.1.1.1.2.3.2.3.cmml">1</mn></msub><mo id="A4.E22.m1.4.4.1.1.1.1.1.1.2.3.1" xref="A4.E22.m1.4.4.1.1.1.1.1.1.2.3.1.cmml">=</mo><mn id="A4.E22.m1.4.4.1.1.1.1.1.1.2.3.3" xref="A4.E22.m1.4.4.1.1.1.1.1.1.2.3.3.cmml">0</mn></mrow><mi id="A4.E22.m1.4.4.1.1.1.1.1.1.3" mathvariant="normal" xref="A4.E22.m1.4.4.1.1.1.1.1.1.3.cmml">∞</mi></munderover><mrow id="A4.E22.m1.4.4.1.1.1.1.1.2" xref="A4.E22.m1.4.4.1.1.1.1.1.2.cmml"><msubsup id="A4.E22.m1.4.4.1.1.1.1.1.2.2" xref="A4.E22.m1.4.4.1.1.1.1.1.2.2.cmml"><mi id="A4.E22.m1.4.4.1.1.1.1.1.2.2.2.2" xref="A4.E22.m1.4.4.1.1.1.1.1.2.2.2.2.cmml">f</mi><msub id="A4.E22.m1.4.4.1.1.1.1.1.2.2.2.3" xref="A4.E22.m1.4.4.1.1.1.1.1.2.2.2.3.cmml"><mi id="A4.E22.m1.4.4.1.1.1.1.1.2.2.2.3.2" xref="A4.E22.m1.4.4.1.1.1.1.1.2.2.2.3.2.cmml">k</mi><mn id="A4.E22.m1.4.4.1.1.1.1.1.2.2.2.3.3" xref="A4.E22.m1.4.4.1.1.1.1.1.2.2.2.3.3.cmml">1</mn></msub><mrow id="A4.E22.m1.1.1.1.3" xref="A4.E22.m1.4.4.1.1.1.1.1.2.2.cmml"><mo id="A4.E22.m1.1.1.1.3.1" stretchy="false" xref="A4.E22.m1.4.4.1.1.1.1.1.2.2.cmml">(</mo><mn id="A4.E22.m1.1.1.1.1" xref="A4.E22.m1.1.1.1.1.cmml">1</mn><mo id="A4.E22.m1.1.1.1.3.2" stretchy="false" xref="A4.E22.m1.4.4.1.1.1.1.1.2.2.cmml">)</mo></mrow></msubsup><mo id="A4.E22.m1.4.4.1.1.1.1.1.2.1" xref="A4.E22.m1.4.4.1.1.1.1.1.2.1.cmml">⁢</mo><msubsup id="A4.E22.m1.4.4.1.1.1.1.1.2.3" xref="A4.E22.m1.4.4.1.1.1.1.1.2.3.cmml"><mi id="A4.E22.m1.4.4.1.1.1.1.1.2.3.2.2" xref="A4.E22.m1.4.4.1.1.1.1.1.2.3.2.2.cmml">𝐖</mi><mrow id="A4.E22.m1.4.4.1.1.1.1.1.2.3.3" xref="A4.E22.m1.4.4.1.1.1.1.1.2.3.3.cmml"><mi id="A4.E22.m1.4.4.1.1.1.1.1.2.3.3.2" xref="A4.E22.m1.4.4.1.1.1.1.1.2.3.3.2.cmml">i</mi><mo id="A4.E22.m1.4.4.1.1.1.1.1.2.3.3.1" xref="A4.E22.m1.4.4.1.1.1.1.1.2.3.3.1.cmml">⁢</mo><mi id="A4.E22.m1.4.4.1.1.1.1.1.2.3.3.3" xref="A4.E22.m1.4.4.1.1.1.1.1.2.3.3.3.cmml">v</mi></mrow><msub id="A4.E22.m1.4.4.1.1.1.1.1.2.3.2.3" xref="A4.E22.m1.4.4.1.1.1.1.1.2.3.2.3.cmml"><mi id="A4.E22.m1.4.4.1.1.1.1.1.2.3.2.3.2" xref="A4.E22.m1.4.4.1.1.1.1.1.2.3.2.3.2.cmml">k</mi><mn id="A4.E22.m1.4.4.1.1.1.1.1.2.3.2.3.3" xref="A4.E22.m1.4.4.1.1.1.1.1.2.3.2.3.3.cmml">1</mn></msub></msubsup></mrow></mrow><mo id="A4.E22.m1.4.4.1.1.1.1.3" xref="A4.E22.m1.4.4.1.1.1.1.1.cmml">)</mo></mrow><mo id="A4.E22.m1.5.5.2.2.3" xref="A4.E22.m1.5.5.2.2.3.cmml">⁢</mo><mrow id="A4.E22.m1.5.5.2.2.2.1" xref="A4.E22.m1.5.5.2.2.2.1.1.cmml"><mo id="A4.E22.m1.5.5.2.2.2.1.2" xref="A4.E22.m1.5.5.2.2.2.1.1.cmml">(</mo><mrow id="A4.E22.m1.5.5.2.2.2.1.1" xref="A4.E22.m1.5.5.2.2.2.1.1.cmml"><munderover id="A4.E22.m1.5.5.2.2.2.1.1.1" xref="A4.E22.m1.5.5.2.2.2.1.1.1.cmml"><mo id="A4.E22.m1.5.5.2.2.2.1.1.1.2.2" lspace="0em" movablelimits="false" xref="A4.E22.m1.5.5.2.2.2.1.1.1.2.2.cmml">∑</mo><mrow id="A4.E22.m1.5.5.2.2.2.1.1.1.2.3" xref="A4.E22.m1.5.5.2.2.2.1.1.1.2.3.cmml"><msub id="A4.E22.m1.5.5.2.2.2.1.1.1.2.3.2" xref="A4.E22.m1.5.5.2.2.2.1.1.1.2.3.2.cmml"><mi id="A4.E22.m1.5.5.2.2.2.1.1.1.2.3.2.2" xref="A4.E22.m1.5.5.2.2.2.1.1.1.2.3.2.2.cmml">k</mi><mn id="A4.E22.m1.5.5.2.2.2.1.1.1.2.3.2.3" xref="A4.E22.m1.5.5.2.2.2.1.1.1.2.3.2.3.cmml">2</mn></msub><mo id="A4.E22.m1.5.5.2.2.2.1.1.1.2.3.1" xref="A4.E22.m1.5.5.2.2.2.1.1.1.2.3.1.cmml">=</mo><mn id="A4.E22.m1.5.5.2.2.2.1.1.1.2.3.3" xref="A4.E22.m1.5.5.2.2.2.1.1.1.2.3.3.cmml">0</mn></mrow><mi id="A4.E22.m1.5.5.2.2.2.1.1.1.3" mathvariant="normal" xref="A4.E22.m1.5.5.2.2.2.1.1.1.3.cmml">∞</mi></munderover><mrow id="A4.E22.m1.5.5.2.2.2.1.1.2" xref="A4.E22.m1.5.5.2.2.2.1.1.2.cmml"><msubsup id="A4.E22.m1.5.5.2.2.2.1.1.2.2" xref="A4.E22.m1.5.5.2.2.2.1.1.2.2.cmml"><mi id="A4.E22.m1.5.5.2.2.2.1.1.2.2.2.2" xref="A4.E22.m1.5.5.2.2.2.1.1.2.2.2.2.cmml">f</mi><msub id="A4.E22.m1.5.5.2.2.2.1.1.2.2.2.3" xref="A4.E22.m1.5.5.2.2.2.1.1.2.2.2.3.cmml"><mi id="A4.E22.m1.5.5.2.2.2.1.1.2.2.2.3.2" xref="A4.E22.m1.5.5.2.2.2.1.1.2.2.2.3.2.cmml">k</mi><mn id="A4.E22.m1.5.5.2.2.2.1.1.2.2.2.3.3" xref="A4.E22.m1.5.5.2.2.2.1.1.2.2.2.3.3.cmml">2</mn></msub><mrow id="A4.E22.m1.2.2.1.3" xref="A4.E22.m1.5.5.2.2.2.1.1.2.2.cmml"><mo id="A4.E22.m1.2.2.1.3.1" stretchy="false" xref="A4.E22.m1.5.5.2.2.2.1.1.2.2.cmml">(</mo><mn id="A4.E22.m1.2.2.1.1" xref="A4.E22.m1.2.2.1.1.cmml">2</mn><mo id="A4.E22.m1.2.2.1.3.2" stretchy="false" xref="A4.E22.m1.5.5.2.2.2.1.1.2.2.cmml">)</mo></mrow></msubsup><mo id="A4.E22.m1.5.5.2.2.2.1.1.2.1" xref="A4.E22.m1.5.5.2.2.2.1.1.2.1.cmml">⁢</mo><msubsup id="A4.E22.m1.5.5.2.2.2.1.1.2.3" xref="A4.E22.m1.5.5.2.2.2.1.1.2.3.cmml"><mi id="A4.E22.m1.5.5.2.2.2.1.1.2.3.2.2" xref="A4.E22.m1.5.5.2.2.2.1.1.2.3.2.2.cmml">𝐖</mi><mrow id="A4.E22.m1.5.5.2.2.2.1.1.2.3.3" xref="A4.E22.m1.5.5.2.2.2.1.1.2.3.3.cmml"><mi id="A4.E22.m1.5.5.2.2.2.1.1.2.3.3.2" xref="A4.E22.m1.5.5.2.2.2.1.1.2.3.3.2.cmml">j</mi><mo id="A4.E22.m1.5.5.2.2.2.1.1.2.3.3.1" xref="A4.E22.m1.5.5.2.2.2.1.1.2.3.3.1.cmml">⁢</mo><mi id="A4.E22.m1.5.5.2.2.2.1.1.2.3.3.3" xref="A4.E22.m1.5.5.2.2.2.1.1.2.3.3.3.cmml">v</mi></mrow><msub id="A4.E22.m1.5.5.2.2.2.1.1.2.3.2.3" xref="A4.E22.m1.5.5.2.2.2.1.1.2.3.2.3.cmml"><mi id="A4.E22.m1.5.5.2.2.2.1.1.2.3.2.3.2" xref="A4.E22.m1.5.5.2.2.2.1.1.2.3.2.3.2.cmml">k</mi><mn id="A4.E22.m1.5.5.2.2.2.1.1.2.3.2.3.3" xref="A4.E22.m1.5.5.2.2.2.1.1.2.3.2.3.3.cmml">2</mn></msub></msubsup></mrow></mrow><mo id="A4.E22.m1.5.5.2.2.2.1.3" xref="A4.E22.m1.5.5.2.2.2.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A4.E22.m1.5b"><apply id="A4.E22.m1.5.5.cmml" xref="A4.E22.m1.5.5"><eq id="A4.E22.m1.5.5.3.cmml" xref="A4.E22.m1.5.5.3"></eq><apply id="A4.E22.m1.5.5.4.cmml" xref="A4.E22.m1.5.5.4"><times id="A4.E22.m1.5.5.4.1.cmml" xref="A4.E22.m1.5.5.4.1"></times><apply id="A4.E22.m1.5.5.4.2.cmml" xref="A4.E22.m1.5.5.4.2"><csymbol cd="ambiguous" id="A4.E22.m1.5.5.4.2.1.cmml" xref="A4.E22.m1.5.5.4.2">subscript</csymbol><ci id="A4.E22.m1.5.5.4.2.2.cmml" xref="A4.E22.m1.5.5.4.2.2">𝐌</ci><ci id="A4.E22.m1.5.5.4.2.3.cmml" xref="A4.E22.m1.5.5.4.2.3">𝛼</ci></apply><apply id="A4.E22.m1.5.5.4.3.cmml" xref="A4.E22.m1.5.5.4.3"><csymbol cd="ambiguous" id="A4.E22.m1.5.5.4.3.1.cmml" xref="A4.E22.m1.5.5.4.3">subscript</csymbol><ci id="A4.E22.m1.3.3.cmml" xref="A4.E22.m1.3.3">𝒢</ci><apply id="A4.E22.m1.5.5.4.3.3.cmml" xref="A4.E22.m1.5.5.4.3.3"><times id="A4.E22.m1.5.5.4.3.3.1.cmml" xref="A4.E22.m1.5.5.4.3.3.1"></times><ci id="A4.E22.m1.5.5.4.3.3.2.cmml" xref="A4.E22.m1.5.5.4.3.3.2">𝑖</ci><ci id="A4.E22.m1.5.5.4.3.3.3.cmml" xref="A4.E22.m1.5.5.4.3.3.3">𝑗</ci></apply></apply></apply><apply id="A4.E22.m1.5.5.2.cmml" xref="A4.E22.m1.5.5.2"><apply id="A4.E22.m1.5.5.2.3.cmml" xref="A4.E22.m1.5.5.2.3"><csymbol cd="ambiguous" id="A4.E22.m1.5.5.2.3.1.cmml" xref="A4.E22.m1.5.5.2.3">superscript</csymbol><apply id="A4.E22.m1.5.5.2.3.2.cmml" xref="A4.E22.m1.5.5.2.3"><csymbol cd="ambiguous" id="A4.E22.m1.5.5.2.3.2.1.cmml" xref="A4.E22.m1.5.5.2.3">subscript</csymbol><sum id="A4.E22.m1.5.5.2.3.2.2.cmml" xref="A4.E22.m1.5.5.2.3.2.2"></sum><apply id="A4.E22.m1.5.5.2.3.2.3.cmml" xref="A4.E22.m1.5.5.2.3.2.3"><eq id="A4.E22.m1.5.5.2.3.2.3.1.cmml" xref="A4.E22.m1.5.5.2.3.2.3.1"></eq><ci id="A4.E22.m1.5.5.2.3.2.3.2.cmml" xref="A4.E22.m1.5.5.2.3.2.3.2">𝑣</ci><cn id="A4.E22.m1.5.5.2.3.2.3.3.cmml" type="integer" xref="A4.E22.m1.5.5.2.3.2.3.3">1</cn></apply></apply><ci id="A4.E22.m1.5.5.2.3.3.cmml" xref="A4.E22.m1.5.5.2.3.3">𝑁</ci></apply><apply id="A4.E22.m1.5.5.2.2.cmml" xref="A4.E22.m1.5.5.2.2"><times id="A4.E22.m1.5.5.2.2.3.cmml" xref="A4.E22.m1.5.5.2.2.3"></times><apply id="A4.E22.m1.4.4.1.1.1.1.1.cmml" xref="A4.E22.m1.4.4.1.1.1.1"><apply id="A4.E22.m1.4.4.1.1.1.1.1.1.cmml" xref="A4.E22.m1.4.4.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A4.E22.m1.4.4.1.1.1.1.1.1.1.cmml" xref="A4.E22.m1.4.4.1.1.1.1.1.1">superscript</csymbol><apply id="A4.E22.m1.4.4.1.1.1.1.1.1.2.cmml" xref="A4.E22.m1.4.4.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A4.E22.m1.4.4.1.1.1.1.1.1.2.1.cmml" xref="A4.E22.m1.4.4.1.1.1.1.1.1">subscript</csymbol><sum id="A4.E22.m1.4.4.1.1.1.1.1.1.2.2.cmml" xref="A4.E22.m1.4.4.1.1.1.1.1.1.2.2"></sum><apply id="A4.E22.m1.4.4.1.1.1.1.1.1.2.3.cmml" xref="A4.E22.m1.4.4.1.1.1.1.1.1.2.3"><eq id="A4.E22.m1.4.4.1.1.1.1.1.1.2.3.1.cmml" xref="A4.E22.m1.4.4.1.1.1.1.1.1.2.3.1"></eq><apply id="A4.E22.m1.4.4.1.1.1.1.1.1.2.3.2.cmml" xref="A4.E22.m1.4.4.1.1.1.1.1.1.2.3.2"><csymbol cd="ambiguous" id="A4.E22.m1.4.4.1.1.1.1.1.1.2.3.2.1.cmml" xref="A4.E22.m1.4.4.1.1.1.1.1.1.2.3.2">subscript</csymbol><ci id="A4.E22.m1.4.4.1.1.1.1.1.1.2.3.2.2.cmml" xref="A4.E22.m1.4.4.1.1.1.1.1.1.2.3.2.2">𝑘</ci><cn id="A4.E22.m1.4.4.1.1.1.1.1.1.2.3.2.3.cmml" type="integer" xref="A4.E22.m1.4.4.1.1.1.1.1.1.2.3.2.3">1</cn></apply><cn id="A4.E22.m1.4.4.1.1.1.1.1.1.2.3.3.cmml" type="integer" xref="A4.E22.m1.4.4.1.1.1.1.1.1.2.3.3">0</cn></apply></apply><infinity id="A4.E22.m1.4.4.1.1.1.1.1.1.3.cmml" xref="A4.E22.m1.4.4.1.1.1.1.1.1.3"></infinity></apply><apply id="A4.E22.m1.4.4.1.1.1.1.1.2.cmml" xref="A4.E22.m1.4.4.1.1.1.1.1.2"><times id="A4.E22.m1.4.4.1.1.1.1.1.2.1.cmml" xref="A4.E22.m1.4.4.1.1.1.1.1.2.1"></times><apply id="A4.E22.m1.4.4.1.1.1.1.1.2.2.cmml" xref="A4.E22.m1.4.4.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="A4.E22.m1.4.4.1.1.1.1.1.2.2.1.cmml" xref="A4.E22.m1.4.4.1.1.1.1.1.2.2">superscript</csymbol><apply id="A4.E22.m1.4.4.1.1.1.1.1.2.2.2.cmml" xref="A4.E22.m1.4.4.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="A4.E22.m1.4.4.1.1.1.1.1.2.2.2.1.cmml" xref="A4.E22.m1.4.4.1.1.1.1.1.2.2">subscript</csymbol><ci id="A4.E22.m1.4.4.1.1.1.1.1.2.2.2.2.cmml" xref="A4.E22.m1.4.4.1.1.1.1.1.2.2.2.2">𝑓</ci><apply id="A4.E22.m1.4.4.1.1.1.1.1.2.2.2.3.cmml" xref="A4.E22.m1.4.4.1.1.1.1.1.2.2.2.3"><csymbol cd="ambiguous" id="A4.E22.m1.4.4.1.1.1.1.1.2.2.2.3.1.cmml" xref="A4.E22.m1.4.4.1.1.1.1.1.2.2.2.3">subscript</csymbol><ci id="A4.E22.m1.4.4.1.1.1.1.1.2.2.2.3.2.cmml" xref="A4.E22.m1.4.4.1.1.1.1.1.2.2.2.3.2">𝑘</ci><cn id="A4.E22.m1.4.4.1.1.1.1.1.2.2.2.3.3.cmml" type="integer" xref="A4.E22.m1.4.4.1.1.1.1.1.2.2.2.3.3">1</cn></apply></apply><cn id="A4.E22.m1.1.1.1.1.cmml" type="integer" xref="A4.E22.m1.1.1.1.1">1</cn></apply><apply id="A4.E22.m1.4.4.1.1.1.1.1.2.3.cmml" xref="A4.E22.m1.4.4.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="A4.E22.m1.4.4.1.1.1.1.1.2.3.1.cmml" xref="A4.E22.m1.4.4.1.1.1.1.1.2.3">subscript</csymbol><apply id="A4.E22.m1.4.4.1.1.1.1.1.2.3.2.cmml" xref="A4.E22.m1.4.4.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="A4.E22.m1.4.4.1.1.1.1.1.2.3.2.1.cmml" xref="A4.E22.m1.4.4.1.1.1.1.1.2.3">superscript</csymbol><ci id="A4.E22.m1.4.4.1.1.1.1.1.2.3.2.2.cmml" xref="A4.E22.m1.4.4.1.1.1.1.1.2.3.2.2">𝐖</ci><apply id="A4.E22.m1.4.4.1.1.1.1.1.2.3.2.3.cmml" xref="A4.E22.m1.4.4.1.1.1.1.1.2.3.2.3"><csymbol cd="ambiguous" id="A4.E22.m1.4.4.1.1.1.1.1.2.3.2.3.1.cmml" xref="A4.E22.m1.4.4.1.1.1.1.1.2.3.2.3">subscript</csymbol><ci id="A4.E22.m1.4.4.1.1.1.1.1.2.3.2.3.2.cmml" xref="A4.E22.m1.4.4.1.1.1.1.1.2.3.2.3.2">𝑘</ci><cn id="A4.E22.m1.4.4.1.1.1.1.1.2.3.2.3.3.cmml" type="integer" xref="A4.E22.m1.4.4.1.1.1.1.1.2.3.2.3.3">1</cn></apply></apply><apply id="A4.E22.m1.4.4.1.1.1.1.1.2.3.3.cmml" xref="A4.E22.m1.4.4.1.1.1.1.1.2.3.3"><times id="A4.E22.m1.4.4.1.1.1.1.1.2.3.3.1.cmml" xref="A4.E22.m1.4.4.1.1.1.1.1.2.3.3.1"></times><ci id="A4.E22.m1.4.4.1.1.1.1.1.2.3.3.2.cmml" xref="A4.E22.m1.4.4.1.1.1.1.1.2.3.3.2">𝑖</ci><ci id="A4.E22.m1.4.4.1.1.1.1.1.2.3.3.3.cmml" xref="A4.E22.m1.4.4.1.1.1.1.1.2.3.3.3">𝑣</ci></apply></apply></apply></apply><apply id="A4.E22.m1.5.5.2.2.2.1.1.cmml" xref="A4.E22.m1.5.5.2.2.2.1"><apply id="A4.E22.m1.5.5.2.2.2.1.1.1.cmml" xref="A4.E22.m1.5.5.2.2.2.1.1.1"><csymbol cd="ambiguous" id="A4.E22.m1.5.5.2.2.2.1.1.1.1.cmml" xref="A4.E22.m1.5.5.2.2.2.1.1.1">superscript</csymbol><apply id="A4.E22.m1.5.5.2.2.2.1.1.1.2.cmml" xref="A4.E22.m1.5.5.2.2.2.1.1.1"><csymbol cd="ambiguous" id="A4.E22.m1.5.5.2.2.2.1.1.1.2.1.cmml" xref="A4.E22.m1.5.5.2.2.2.1.1.1">subscript</csymbol><sum id="A4.E22.m1.5.5.2.2.2.1.1.1.2.2.cmml" xref="A4.E22.m1.5.5.2.2.2.1.1.1.2.2"></sum><apply id="A4.E22.m1.5.5.2.2.2.1.1.1.2.3.cmml" xref="A4.E22.m1.5.5.2.2.2.1.1.1.2.3"><eq id="A4.E22.m1.5.5.2.2.2.1.1.1.2.3.1.cmml" xref="A4.E22.m1.5.5.2.2.2.1.1.1.2.3.1"></eq><apply id="A4.E22.m1.5.5.2.2.2.1.1.1.2.3.2.cmml" xref="A4.E22.m1.5.5.2.2.2.1.1.1.2.3.2"><csymbol cd="ambiguous" id="A4.E22.m1.5.5.2.2.2.1.1.1.2.3.2.1.cmml" xref="A4.E22.m1.5.5.2.2.2.1.1.1.2.3.2">subscript</csymbol><ci id="A4.E22.m1.5.5.2.2.2.1.1.1.2.3.2.2.cmml" xref="A4.E22.m1.5.5.2.2.2.1.1.1.2.3.2.2">𝑘</ci><cn id="A4.E22.m1.5.5.2.2.2.1.1.1.2.3.2.3.cmml" type="integer" xref="A4.E22.m1.5.5.2.2.2.1.1.1.2.3.2.3">2</cn></apply><cn id="A4.E22.m1.5.5.2.2.2.1.1.1.2.3.3.cmml" type="integer" xref="A4.E22.m1.5.5.2.2.2.1.1.1.2.3.3">0</cn></apply></apply><infinity id="A4.E22.m1.5.5.2.2.2.1.1.1.3.cmml" xref="A4.E22.m1.5.5.2.2.2.1.1.1.3"></infinity></apply><apply id="A4.E22.m1.5.5.2.2.2.1.1.2.cmml" xref="A4.E22.m1.5.5.2.2.2.1.1.2"><times id="A4.E22.m1.5.5.2.2.2.1.1.2.1.cmml" xref="A4.E22.m1.5.5.2.2.2.1.1.2.1"></times><apply id="A4.E22.m1.5.5.2.2.2.1.1.2.2.cmml" xref="A4.E22.m1.5.5.2.2.2.1.1.2.2"><csymbol cd="ambiguous" id="A4.E22.m1.5.5.2.2.2.1.1.2.2.1.cmml" xref="A4.E22.m1.5.5.2.2.2.1.1.2.2">superscript</csymbol><apply id="A4.E22.m1.5.5.2.2.2.1.1.2.2.2.cmml" xref="A4.E22.m1.5.5.2.2.2.1.1.2.2"><csymbol cd="ambiguous" id="A4.E22.m1.5.5.2.2.2.1.1.2.2.2.1.cmml" xref="A4.E22.m1.5.5.2.2.2.1.1.2.2">subscript</csymbol><ci id="A4.E22.m1.5.5.2.2.2.1.1.2.2.2.2.cmml" xref="A4.E22.m1.5.5.2.2.2.1.1.2.2.2.2">𝑓</ci><apply id="A4.E22.m1.5.5.2.2.2.1.1.2.2.2.3.cmml" xref="A4.E22.m1.5.5.2.2.2.1.1.2.2.2.3"><csymbol cd="ambiguous" id="A4.E22.m1.5.5.2.2.2.1.1.2.2.2.3.1.cmml" xref="A4.E22.m1.5.5.2.2.2.1.1.2.2.2.3">subscript</csymbol><ci id="A4.E22.m1.5.5.2.2.2.1.1.2.2.2.3.2.cmml" xref="A4.E22.m1.5.5.2.2.2.1.1.2.2.2.3.2">𝑘</ci><cn id="A4.E22.m1.5.5.2.2.2.1.1.2.2.2.3.3.cmml" type="integer" xref="A4.E22.m1.5.5.2.2.2.1.1.2.2.2.3.3">2</cn></apply></apply><cn id="A4.E22.m1.2.2.1.1.cmml" type="integer" xref="A4.E22.m1.2.2.1.1">2</cn></apply><apply id="A4.E22.m1.5.5.2.2.2.1.1.2.3.cmml" xref="A4.E22.m1.5.5.2.2.2.1.1.2.3"><csymbol cd="ambiguous" id="A4.E22.m1.5.5.2.2.2.1.1.2.3.1.cmml" xref="A4.E22.m1.5.5.2.2.2.1.1.2.3">subscript</csymbol><apply id="A4.E22.m1.5.5.2.2.2.1.1.2.3.2.cmml" xref="A4.E22.m1.5.5.2.2.2.1.1.2.3"><csymbol cd="ambiguous" id="A4.E22.m1.5.5.2.2.2.1.1.2.3.2.1.cmml" xref="A4.E22.m1.5.5.2.2.2.1.1.2.3">superscript</csymbol><ci id="A4.E22.m1.5.5.2.2.2.1.1.2.3.2.2.cmml" xref="A4.E22.m1.5.5.2.2.2.1.1.2.3.2.2">𝐖</ci><apply id="A4.E22.m1.5.5.2.2.2.1.1.2.3.2.3.cmml" xref="A4.E22.m1.5.5.2.2.2.1.1.2.3.2.3"><csymbol cd="ambiguous" id="A4.E22.m1.5.5.2.2.2.1.1.2.3.2.3.1.cmml" xref="A4.E22.m1.5.5.2.2.2.1.1.2.3.2.3">subscript</csymbol><ci id="A4.E22.m1.5.5.2.2.2.1.1.2.3.2.3.2.cmml" xref="A4.E22.m1.5.5.2.2.2.1.1.2.3.2.3.2">𝑘</ci><cn id="A4.E22.m1.5.5.2.2.2.1.1.2.3.2.3.3.cmml" type="integer" xref="A4.E22.m1.5.5.2.2.2.1.1.2.3.2.3.3">2</cn></apply></apply><apply id="A4.E22.m1.5.5.2.2.2.1.1.2.3.3.cmml" xref="A4.E22.m1.5.5.2.2.2.1.1.2.3.3"><times id="A4.E22.m1.5.5.2.2.2.1.1.2.3.3.1.cmml" xref="A4.E22.m1.5.5.2.2.2.1.1.2.3.3.1"></times><ci id="A4.E22.m1.5.5.2.2.2.1.1.2.3.3.2.cmml" xref="A4.E22.m1.5.5.2.2.2.1.1.2.3.3.2">𝑗</ci><ci id="A4.E22.m1.5.5.2.2.2.1.1.2.3.3.3.cmml" xref="A4.E22.m1.5.5.2.2.2.1.1.2.3.3.3">𝑣</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.E22.m1.5c">\mathbf{M}_{\alpha}(\mathcal{G})_{ij}=\sum_{v=1}^{N}\left(\sum_{k_{1}=0}^{%
\infty}f_{k_{1}}^{(1)}\mathbf{W}^{k_{1}}_{iv}\right)\left(\sum_{k_{2}=0}^{%
\infty}f_{k_{2}}^{(2)}\mathbf{W}^{k_{2}}_{jv}\right)</annotation><annotation encoding="application/x-llamapun" id="A4.E22.m1.5d">bold_M start_POSTSUBSCRIPT italic_α end_POSTSUBSCRIPT ( caligraphic_G ) start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT = ∑ start_POSTSUBSCRIPT italic_v = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT ( ∑ start_POSTSUBSCRIPT italic_k start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT = 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∞ end_POSTSUPERSCRIPT italic_f start_POSTSUBSCRIPT italic_k start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( 1 ) end_POSTSUPERSCRIPT bold_W start_POSTSUPERSCRIPT italic_k start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i italic_v end_POSTSUBSCRIPT ) ( ∑ start_POSTSUBSCRIPT italic_k start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT = 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∞ end_POSTSUPERSCRIPT italic_f start_POSTSUBSCRIPT italic_k start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( 2 ) end_POSTSUPERSCRIPT bold_W start_POSTSUPERSCRIPT italic_k start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_j italic_v end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(22)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A4.p2.6">if the discrete convolution</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equation ltx_eqn_table" id="A4.E23">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\sum_{p=0}^{k}f^{(1)}_{p}f^{(2)}_{k-p}=\alpha_{k}" class="ltx_Math" display="block" id="A4.E23.m1.2"><semantics id="A4.E23.m1.2a"><mrow id="A4.E23.m1.2.3" xref="A4.E23.m1.2.3.cmml"><mrow id="A4.E23.m1.2.3.2" xref="A4.E23.m1.2.3.2.cmml"><munderover id="A4.E23.m1.2.3.2.1" xref="A4.E23.m1.2.3.2.1.cmml"><mo id="A4.E23.m1.2.3.2.1.2.2" movablelimits="false" xref="A4.E23.m1.2.3.2.1.2.2.cmml">∑</mo><mrow id="A4.E23.m1.2.3.2.1.2.3" xref="A4.E23.m1.2.3.2.1.2.3.cmml"><mi id="A4.E23.m1.2.3.2.1.2.3.2" xref="A4.E23.m1.2.3.2.1.2.3.2.cmml">p</mi><mo id="A4.E23.m1.2.3.2.1.2.3.1" xref="A4.E23.m1.2.3.2.1.2.3.1.cmml">=</mo><mn id="A4.E23.m1.2.3.2.1.2.3.3" xref="A4.E23.m1.2.3.2.1.2.3.3.cmml">0</mn></mrow><mi id="A4.E23.m1.2.3.2.1.3" xref="A4.E23.m1.2.3.2.1.3.cmml">k</mi></munderover><mrow id="A4.E23.m1.2.3.2.2" xref="A4.E23.m1.2.3.2.2.cmml"><msubsup id="A4.E23.m1.2.3.2.2.2" xref="A4.E23.m1.2.3.2.2.2.cmml"><mi id="A4.E23.m1.2.3.2.2.2.2.2" xref="A4.E23.m1.2.3.2.2.2.2.2.cmml">f</mi><mi id="A4.E23.m1.2.3.2.2.2.3" xref="A4.E23.m1.2.3.2.2.2.3.cmml">p</mi><mrow id="A4.E23.m1.1.1.1.3" xref="A4.E23.m1.2.3.2.2.2.cmml"><mo id="A4.E23.m1.1.1.1.3.1" stretchy="false" xref="A4.E23.m1.2.3.2.2.2.cmml">(</mo><mn id="A4.E23.m1.1.1.1.1" xref="A4.E23.m1.1.1.1.1.cmml">1</mn><mo id="A4.E23.m1.1.1.1.3.2" stretchy="false" xref="A4.E23.m1.2.3.2.2.2.cmml">)</mo></mrow></msubsup><mo id="A4.E23.m1.2.3.2.2.1" xref="A4.E23.m1.2.3.2.2.1.cmml">⁢</mo><msubsup id="A4.E23.m1.2.3.2.2.3" xref="A4.E23.m1.2.3.2.2.3.cmml"><mi id="A4.E23.m1.2.3.2.2.3.2.2" xref="A4.E23.m1.2.3.2.2.3.2.2.cmml">f</mi><mrow id="A4.E23.m1.2.3.2.2.3.3" xref="A4.E23.m1.2.3.2.2.3.3.cmml"><mi id="A4.E23.m1.2.3.2.2.3.3.2" xref="A4.E23.m1.2.3.2.2.3.3.2.cmml">k</mi><mo id="A4.E23.m1.2.3.2.2.3.3.1" xref="A4.E23.m1.2.3.2.2.3.3.1.cmml">−</mo><mi id="A4.E23.m1.2.3.2.2.3.3.3" xref="A4.E23.m1.2.3.2.2.3.3.3.cmml">p</mi></mrow><mrow id="A4.E23.m1.2.2.1.3" xref="A4.E23.m1.2.3.2.2.3.cmml"><mo id="A4.E23.m1.2.2.1.3.1" stretchy="false" xref="A4.E23.m1.2.3.2.2.3.cmml">(</mo><mn id="A4.E23.m1.2.2.1.1" xref="A4.E23.m1.2.2.1.1.cmml">2</mn><mo id="A4.E23.m1.2.2.1.3.2" stretchy="false" xref="A4.E23.m1.2.3.2.2.3.cmml">)</mo></mrow></msubsup></mrow></mrow><mo id="A4.E23.m1.2.3.1" xref="A4.E23.m1.2.3.1.cmml">=</mo><msub id="A4.E23.m1.2.3.3" xref="A4.E23.m1.2.3.3.cmml"><mi id="A4.E23.m1.2.3.3.2" xref="A4.E23.m1.2.3.3.2.cmml">α</mi><mi id="A4.E23.m1.2.3.3.3" xref="A4.E23.m1.2.3.3.3.cmml">k</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="A4.E23.m1.2b"><apply id="A4.E23.m1.2.3.cmml" xref="A4.E23.m1.2.3"><eq id="A4.E23.m1.2.3.1.cmml" xref="A4.E23.m1.2.3.1"></eq><apply id="A4.E23.m1.2.3.2.cmml" xref="A4.E23.m1.2.3.2"><apply id="A4.E23.m1.2.3.2.1.cmml" xref="A4.E23.m1.2.3.2.1"><csymbol cd="ambiguous" id="A4.E23.m1.2.3.2.1.1.cmml" xref="A4.E23.m1.2.3.2.1">superscript</csymbol><apply id="A4.E23.m1.2.3.2.1.2.cmml" xref="A4.E23.m1.2.3.2.1"><csymbol cd="ambiguous" id="A4.E23.m1.2.3.2.1.2.1.cmml" xref="A4.E23.m1.2.3.2.1">subscript</csymbol><sum id="A4.E23.m1.2.3.2.1.2.2.cmml" xref="A4.E23.m1.2.3.2.1.2.2"></sum><apply id="A4.E23.m1.2.3.2.1.2.3.cmml" xref="A4.E23.m1.2.3.2.1.2.3"><eq id="A4.E23.m1.2.3.2.1.2.3.1.cmml" xref="A4.E23.m1.2.3.2.1.2.3.1"></eq><ci id="A4.E23.m1.2.3.2.1.2.3.2.cmml" xref="A4.E23.m1.2.3.2.1.2.3.2">𝑝</ci><cn id="A4.E23.m1.2.3.2.1.2.3.3.cmml" type="integer" xref="A4.E23.m1.2.3.2.1.2.3.3">0</cn></apply></apply><ci id="A4.E23.m1.2.3.2.1.3.cmml" xref="A4.E23.m1.2.3.2.1.3">𝑘</ci></apply><apply id="A4.E23.m1.2.3.2.2.cmml" xref="A4.E23.m1.2.3.2.2"><times id="A4.E23.m1.2.3.2.2.1.cmml" xref="A4.E23.m1.2.3.2.2.1"></times><apply id="A4.E23.m1.2.3.2.2.2.cmml" xref="A4.E23.m1.2.3.2.2.2"><csymbol cd="ambiguous" id="A4.E23.m1.2.3.2.2.2.1.cmml" xref="A4.E23.m1.2.3.2.2.2">subscript</csymbol><apply id="A4.E23.m1.2.3.2.2.2.2.cmml" xref="A4.E23.m1.2.3.2.2.2"><csymbol cd="ambiguous" id="A4.E23.m1.2.3.2.2.2.2.1.cmml" xref="A4.E23.m1.2.3.2.2.2">superscript</csymbol><ci id="A4.E23.m1.2.3.2.2.2.2.2.cmml" xref="A4.E23.m1.2.3.2.2.2.2.2">𝑓</ci><cn id="A4.E23.m1.1.1.1.1.cmml" type="integer" xref="A4.E23.m1.1.1.1.1">1</cn></apply><ci id="A4.E23.m1.2.3.2.2.2.3.cmml" xref="A4.E23.m1.2.3.2.2.2.3">𝑝</ci></apply><apply id="A4.E23.m1.2.3.2.2.3.cmml" xref="A4.E23.m1.2.3.2.2.3"><csymbol cd="ambiguous" id="A4.E23.m1.2.3.2.2.3.1.cmml" xref="A4.E23.m1.2.3.2.2.3">subscript</csymbol><apply id="A4.E23.m1.2.3.2.2.3.2.cmml" xref="A4.E23.m1.2.3.2.2.3"><csymbol cd="ambiguous" id="A4.E23.m1.2.3.2.2.3.2.1.cmml" xref="A4.E23.m1.2.3.2.2.3">superscript</csymbol><ci id="A4.E23.m1.2.3.2.2.3.2.2.cmml" xref="A4.E23.m1.2.3.2.2.3.2.2">𝑓</ci><cn id="A4.E23.m1.2.2.1.1.cmml" type="integer" xref="A4.E23.m1.2.2.1.1">2</cn></apply><apply id="A4.E23.m1.2.3.2.2.3.3.cmml" xref="A4.E23.m1.2.3.2.2.3.3"><minus id="A4.E23.m1.2.3.2.2.3.3.1.cmml" xref="A4.E23.m1.2.3.2.2.3.3.1"></minus><ci id="A4.E23.m1.2.3.2.2.3.3.2.cmml" xref="A4.E23.m1.2.3.2.2.3.3.2">𝑘</ci><ci id="A4.E23.m1.2.3.2.2.3.3.3.cmml" xref="A4.E23.m1.2.3.2.2.3.3.3">𝑝</ci></apply></apply></apply></apply><apply id="A4.E23.m1.2.3.3.cmml" xref="A4.E23.m1.2.3.3"><csymbol cd="ambiguous" id="A4.E23.m1.2.3.3.1.cmml" xref="A4.E23.m1.2.3.3">subscript</csymbol><ci id="A4.E23.m1.2.3.3.2.cmml" xref="A4.E23.m1.2.3.3.2">𝛼</ci><ci id="A4.E23.m1.2.3.3.3.cmml" xref="A4.E23.m1.2.3.3.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.E23.m1.2c">\sum_{p=0}^{k}f^{(1)}_{p}f^{(2)}_{k-p}=\alpha_{k}</annotation><annotation encoding="application/x-llamapun" id="A4.E23.m1.2d">∑ start_POSTSUBSCRIPT italic_p = 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT italic_f start_POSTSUPERSCRIPT ( 1 ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT italic_f start_POSTSUPERSCRIPT ( 2 ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_k - italic_p end_POSTSUBSCRIPT = italic_α start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(23)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A4.p2.4">holds.
We do not necessarily require that <math alttext="f^{(1)}=f^{(2)}" class="ltx_Math" display="inline" id="A4.p2.1.m1.2"><semantics id="A4.p2.1.m1.2a"><mrow id="A4.p2.1.m1.2.3" xref="A4.p2.1.m1.2.3.cmml"><msup id="A4.p2.1.m1.2.3.2" xref="A4.p2.1.m1.2.3.2.cmml"><mi id="A4.p2.1.m1.2.3.2.2" xref="A4.p2.1.m1.2.3.2.2.cmml">f</mi><mrow id="A4.p2.1.m1.1.1.1.3" xref="A4.p2.1.m1.2.3.2.cmml"><mo id="A4.p2.1.m1.1.1.1.3.1" stretchy="false" xref="A4.p2.1.m1.2.3.2.cmml">(</mo><mn id="A4.p2.1.m1.1.1.1.1" xref="A4.p2.1.m1.1.1.1.1.cmml">1</mn><mo id="A4.p2.1.m1.1.1.1.3.2" stretchy="false" xref="A4.p2.1.m1.2.3.2.cmml">)</mo></mrow></msup><mo id="A4.p2.1.m1.2.3.1" xref="A4.p2.1.m1.2.3.1.cmml">=</mo><msup id="A4.p2.1.m1.2.3.3" xref="A4.p2.1.m1.2.3.3.cmml"><mi id="A4.p2.1.m1.2.3.3.2" xref="A4.p2.1.m1.2.3.3.2.cmml">f</mi><mrow id="A4.p2.1.m1.2.2.1.3" xref="A4.p2.1.m1.2.3.3.cmml"><mo id="A4.p2.1.m1.2.2.1.3.1" stretchy="false" xref="A4.p2.1.m1.2.3.3.cmml">(</mo><mn id="A4.p2.1.m1.2.2.1.1" xref="A4.p2.1.m1.2.2.1.1.cmml">2</mn><mo id="A4.p2.1.m1.2.2.1.3.2" stretchy="false" xref="A4.p2.1.m1.2.3.3.cmml">)</mo></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A4.p2.1.m1.2b"><apply id="A4.p2.1.m1.2.3.cmml" xref="A4.p2.1.m1.2.3"><eq id="A4.p2.1.m1.2.3.1.cmml" xref="A4.p2.1.m1.2.3.1"></eq><apply id="A4.p2.1.m1.2.3.2.cmml" xref="A4.p2.1.m1.2.3.2"><csymbol cd="ambiguous" id="A4.p2.1.m1.2.3.2.1.cmml" xref="A4.p2.1.m1.2.3.2">superscript</csymbol><ci id="A4.p2.1.m1.2.3.2.2.cmml" xref="A4.p2.1.m1.2.3.2.2">𝑓</ci><cn id="A4.p2.1.m1.1.1.1.1.cmml" type="integer" xref="A4.p2.1.m1.1.1.1.1">1</cn></apply><apply id="A4.p2.1.m1.2.3.3.cmml" xref="A4.p2.1.m1.2.3.3"><csymbol cd="ambiguous" id="A4.p2.1.m1.2.3.3.1.cmml" xref="A4.p2.1.m1.2.3.3">superscript</csymbol><ci id="A4.p2.1.m1.2.3.3.2.cmml" xref="A4.p2.1.m1.2.3.3.2">𝑓</ci><cn id="A4.p2.1.m1.2.2.1.1.cmml" type="integer" xref="A4.p2.1.m1.2.2.1.1">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.p2.1.m1.2c">f^{(1)}=f^{(2)}</annotation><annotation encoding="application/x-llamapun" id="A4.p2.1.m1.2d">italic_f start_POSTSUPERSCRIPT ( 1 ) end_POSTSUPERSCRIPT = italic_f start_POSTSUPERSCRIPT ( 2 ) end_POSTSUPERSCRIPT</annotation></semantics></math>; this is a special case.
Another special case is <math alttext="f^{(2)}_{p}=\{1\textrm{ if }p=0,\hskip 1.99997pt0\textrm{ otherwise}\}" class="ltx_Math" display="inline" id="A4.p2.2.m2.3"><semantics id="A4.p2.2.m2.3a"><mrow id="A4.p2.2.m2.3.3" xref="A4.p2.2.m2.3.3.cmml"><msubsup id="A4.p2.2.m2.3.3.3" xref="A4.p2.2.m2.3.3.3.cmml"><mi id="A4.p2.2.m2.3.3.3.2.2" xref="A4.p2.2.m2.3.3.3.2.2.cmml">f</mi><mi id="A4.p2.2.m2.3.3.3.3" xref="A4.p2.2.m2.3.3.3.3.cmml">p</mi><mrow id="A4.p2.2.m2.1.1.1.3" xref="A4.p2.2.m2.3.3.3.cmml"><mo id="A4.p2.2.m2.1.1.1.3.1" stretchy="false" xref="A4.p2.2.m2.3.3.3.cmml">(</mo><mn id="A4.p2.2.m2.1.1.1.1" xref="A4.p2.2.m2.1.1.1.1.cmml">2</mn><mo id="A4.p2.2.m2.1.1.1.3.2" stretchy="false" xref="A4.p2.2.m2.3.3.3.cmml">)</mo></mrow></msubsup><mo id="A4.p2.2.m2.3.3.2" xref="A4.p2.2.m2.3.3.2.cmml">=</mo><mrow id="A4.p2.2.m2.3.3.1.1" xref="A4.p2.2.m2.3.3.1.2.cmml"><mo id="A4.p2.2.m2.3.3.1.1.2" stretchy="false" xref="A4.p2.2.m2.3.3.1.2.cmml">{</mo><mrow id="A4.p2.2.m2.3.3.1.1.1" xref="A4.p2.2.m2.3.3.1.1.1.cmml"><mrow id="A4.p2.2.m2.3.3.1.1.1.3" xref="A4.p2.2.m2.3.3.1.1.1.3.cmml"><mn id="A4.p2.2.m2.3.3.1.1.1.3.2" xref="A4.p2.2.m2.3.3.1.1.1.3.2.cmml">1</mn><mo id="A4.p2.2.m2.3.3.1.1.1.3.1" xref="A4.p2.2.m2.3.3.1.1.1.3.1.cmml">⁢</mo><mtext id="A4.p2.2.m2.3.3.1.1.1.3.3" xref="A4.p2.2.m2.3.3.1.1.1.3.3a.cmml">&nbsp;if&nbsp;</mtext><mo id="A4.p2.2.m2.3.3.1.1.1.3.1a" xref="A4.p2.2.m2.3.3.1.1.1.3.1.cmml">⁢</mo><mi id="A4.p2.2.m2.3.3.1.1.1.3.4" xref="A4.p2.2.m2.3.3.1.1.1.3.4.cmml">p</mi></mrow><mo id="A4.p2.2.m2.3.3.1.1.1.2" xref="A4.p2.2.m2.3.3.1.1.1.2.cmml">=</mo><mrow id="A4.p2.2.m2.3.3.1.1.1.1.1" xref="A4.p2.2.m2.3.3.1.1.1.1.2.cmml"><mn id="A4.p2.2.m2.2.2" xref="A4.p2.2.m2.2.2.cmml">0</mn><mo id="A4.p2.2.m2.3.3.1.1.1.1.1.2" rspace="0.367em" xref="A4.p2.2.m2.3.3.1.1.1.1.2.cmml">,</mo><mrow id="A4.p2.2.m2.3.3.1.1.1.1.1.1" xref="A4.p2.2.m2.3.3.1.1.1.1.1.1.cmml"><mn id="A4.p2.2.m2.3.3.1.1.1.1.1.1.2" xref="A4.p2.2.m2.3.3.1.1.1.1.1.1.2.cmml">0</mn><mo id="A4.p2.2.m2.3.3.1.1.1.1.1.1.1" xref="A4.p2.2.m2.3.3.1.1.1.1.1.1.1.cmml">⁢</mo><mtext id="A4.p2.2.m2.3.3.1.1.1.1.1.1.3" xref="A4.p2.2.m2.3.3.1.1.1.1.1.1.3a.cmml">&nbsp;otherwise</mtext></mrow></mrow></mrow><mo id="A4.p2.2.m2.3.3.1.1.3" stretchy="false" xref="A4.p2.2.m2.3.3.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A4.p2.2.m2.3b"><apply id="A4.p2.2.m2.3.3.cmml" xref="A4.p2.2.m2.3.3"><eq id="A4.p2.2.m2.3.3.2.cmml" xref="A4.p2.2.m2.3.3.2"></eq><apply id="A4.p2.2.m2.3.3.3.cmml" xref="A4.p2.2.m2.3.3.3"><csymbol cd="ambiguous" id="A4.p2.2.m2.3.3.3.1.cmml" xref="A4.p2.2.m2.3.3.3">subscript</csymbol><apply id="A4.p2.2.m2.3.3.3.2.cmml" xref="A4.p2.2.m2.3.3.3"><csymbol cd="ambiguous" id="A4.p2.2.m2.3.3.3.2.1.cmml" xref="A4.p2.2.m2.3.3.3">superscript</csymbol><ci id="A4.p2.2.m2.3.3.3.2.2.cmml" xref="A4.p2.2.m2.3.3.3.2.2">𝑓</ci><cn id="A4.p2.2.m2.1.1.1.1.cmml" type="integer" xref="A4.p2.2.m2.1.1.1.1">2</cn></apply><ci id="A4.p2.2.m2.3.3.3.3.cmml" xref="A4.p2.2.m2.3.3.3.3">𝑝</ci></apply><set id="A4.p2.2.m2.3.3.1.2.cmml" xref="A4.p2.2.m2.3.3.1.1"><apply id="A4.p2.2.m2.3.3.1.1.1.cmml" xref="A4.p2.2.m2.3.3.1.1.1"><eq id="A4.p2.2.m2.3.3.1.1.1.2.cmml" xref="A4.p2.2.m2.3.3.1.1.1.2"></eq><apply id="A4.p2.2.m2.3.3.1.1.1.3.cmml" xref="A4.p2.2.m2.3.3.1.1.1.3"><times id="A4.p2.2.m2.3.3.1.1.1.3.1.cmml" xref="A4.p2.2.m2.3.3.1.1.1.3.1"></times><cn id="A4.p2.2.m2.3.3.1.1.1.3.2.cmml" type="integer" xref="A4.p2.2.m2.3.3.1.1.1.3.2">1</cn><ci id="A4.p2.2.m2.3.3.1.1.1.3.3a.cmml" xref="A4.p2.2.m2.3.3.1.1.1.3.3"><mtext id="A4.p2.2.m2.3.3.1.1.1.3.3.cmml" xref="A4.p2.2.m2.3.3.1.1.1.3.3">&nbsp;if&nbsp;</mtext></ci><ci id="A4.p2.2.m2.3.3.1.1.1.3.4.cmml" xref="A4.p2.2.m2.3.3.1.1.1.3.4">𝑝</ci></apply><list id="A4.p2.2.m2.3.3.1.1.1.1.2.cmml" xref="A4.p2.2.m2.3.3.1.1.1.1.1"><cn id="A4.p2.2.m2.2.2.cmml" type="integer" xref="A4.p2.2.m2.2.2">0</cn><apply id="A4.p2.2.m2.3.3.1.1.1.1.1.1.cmml" xref="A4.p2.2.m2.3.3.1.1.1.1.1.1"><times id="A4.p2.2.m2.3.3.1.1.1.1.1.1.1.cmml" xref="A4.p2.2.m2.3.3.1.1.1.1.1.1.1"></times><cn id="A4.p2.2.m2.3.3.1.1.1.1.1.1.2.cmml" type="integer" xref="A4.p2.2.m2.3.3.1.1.1.1.1.1.2">0</cn><ci id="A4.p2.2.m2.3.3.1.1.1.1.1.1.3a.cmml" xref="A4.p2.2.m2.3.3.1.1.1.1.1.1.3"><mtext id="A4.p2.2.m2.3.3.1.1.1.1.1.1.3.cmml" xref="A4.p2.2.m2.3.3.1.1.1.1.1.1.3">&nbsp;otherwise</mtext></ci></apply></list></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.p2.2.m2.3c">f^{(2)}_{p}=\{1\textrm{ if }p=0,\hskip 1.99997pt0\textrm{ otherwise}\}</annotation><annotation encoding="application/x-llamapun" id="A4.p2.2.m2.3d">italic_f start_POSTSUPERSCRIPT ( 2 ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT = { 1 if italic_p = 0 , 0 otherwise }</annotation></semantics></math>, whereupon we need <math alttext="f_{p}^{(1)}=\alpha_{p}\hskip 1.99997pt\forall\hskip 1.99997ptp" class="ltx_Math" display="inline" id="A4.p2.3.m3.1"><semantics id="A4.p2.3.m3.1a"><mrow id="A4.p2.3.m3.1.2" xref="A4.p2.3.m3.1.2.cmml"><msubsup id="A4.p2.3.m3.1.2.2" xref="A4.p2.3.m3.1.2.2.cmml"><mi id="A4.p2.3.m3.1.2.2.2.2" xref="A4.p2.3.m3.1.2.2.2.2.cmml">f</mi><mi id="A4.p2.3.m3.1.2.2.2.3" xref="A4.p2.3.m3.1.2.2.2.3.cmml">p</mi><mrow id="A4.p2.3.m3.1.1.1.3" xref="A4.p2.3.m3.1.2.2.cmml"><mo id="A4.p2.3.m3.1.1.1.3.1" stretchy="false" xref="A4.p2.3.m3.1.2.2.cmml">(</mo><mn id="A4.p2.3.m3.1.1.1.1" xref="A4.p2.3.m3.1.1.1.1.cmml">1</mn><mo id="A4.p2.3.m3.1.1.1.3.2" stretchy="false" xref="A4.p2.3.m3.1.2.2.cmml">)</mo></mrow></msubsup><mo id="A4.p2.3.m3.1.2.1" xref="A4.p2.3.m3.1.2.1.cmml">=</mo><mrow id="A4.p2.3.m3.1.2.3" xref="A4.p2.3.m3.1.2.3.cmml"><msub id="A4.p2.3.m3.1.2.3.2" xref="A4.p2.3.m3.1.2.3.2.cmml"><mi id="A4.p2.3.m3.1.2.3.2.2" xref="A4.p2.3.m3.1.2.3.2.2.cmml">α</mi><mi id="A4.p2.3.m3.1.2.3.2.3" xref="A4.p2.3.m3.1.2.3.2.3.cmml">p</mi></msub><mo id="A4.p2.3.m3.1.2.3.1" lspace="0.167em" xref="A4.p2.3.m3.1.2.3.1.cmml">⁢</mo><mrow id="A4.p2.3.m3.1.2.3.3" xref="A4.p2.3.m3.1.2.3.3.cmml"><mo id="A4.p2.3.m3.1.2.3.3.1" rspace="0.367em" xref="A4.p2.3.m3.1.2.3.3.1.cmml">∀</mo><mi id="A4.p2.3.m3.1.2.3.3.2" xref="A4.p2.3.m3.1.2.3.3.2.cmml">p</mi></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A4.p2.3.m3.1b"><apply id="A4.p2.3.m3.1.2.cmml" xref="A4.p2.3.m3.1.2"><eq id="A4.p2.3.m3.1.2.1.cmml" xref="A4.p2.3.m3.1.2.1"></eq><apply id="A4.p2.3.m3.1.2.2.cmml" xref="A4.p2.3.m3.1.2.2"><csymbol cd="ambiguous" id="A4.p2.3.m3.1.2.2.1.cmml" xref="A4.p2.3.m3.1.2.2">superscript</csymbol><apply id="A4.p2.3.m3.1.2.2.2.cmml" xref="A4.p2.3.m3.1.2.2"><csymbol cd="ambiguous" id="A4.p2.3.m3.1.2.2.2.1.cmml" xref="A4.p2.3.m3.1.2.2">subscript</csymbol><ci id="A4.p2.3.m3.1.2.2.2.2.cmml" xref="A4.p2.3.m3.1.2.2.2.2">𝑓</ci><ci id="A4.p2.3.m3.1.2.2.2.3.cmml" xref="A4.p2.3.m3.1.2.2.2.3">𝑝</ci></apply><cn id="A4.p2.3.m3.1.1.1.1.cmml" type="integer" xref="A4.p2.3.m3.1.1.1.1">1</cn></apply><apply id="A4.p2.3.m3.1.2.3.cmml" xref="A4.p2.3.m3.1.2.3"><times id="A4.p2.3.m3.1.2.3.1.cmml" xref="A4.p2.3.m3.1.2.3.1"></times><apply id="A4.p2.3.m3.1.2.3.2.cmml" xref="A4.p2.3.m3.1.2.3.2"><csymbol cd="ambiguous" id="A4.p2.3.m3.1.2.3.2.1.cmml" xref="A4.p2.3.m3.1.2.3.2">subscript</csymbol><ci id="A4.p2.3.m3.1.2.3.2.2.cmml" xref="A4.p2.3.m3.1.2.3.2.2">𝛼</ci><ci id="A4.p2.3.m3.1.2.3.2.3.cmml" xref="A4.p2.3.m3.1.2.3.2.3">𝑝</ci></apply><apply id="A4.p2.3.m3.1.2.3.3.cmml" xref="A4.p2.3.m3.1.2.3.3"><csymbol cd="latexml" id="A4.p2.3.m3.1.2.3.3.1.cmml" xref="A4.p2.3.m3.1.2.3.3.1">for-all</csymbol><ci id="A4.p2.3.m3.1.2.3.3.2.cmml" xref="A4.p2.3.m3.1.2.3.3.2">𝑝</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.p2.3.m3.1c">f_{p}^{(1)}=\alpha_{p}\hskip 1.99997pt\forall\hskip 1.99997ptp</annotation><annotation encoding="application/x-llamapun" id="A4.p2.3.m3.1d">italic_f start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( 1 ) end_POSTSUPERSCRIPT = italic_α start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ∀ italic_p</annotation></semantics></math>.
Sampling GRFs in this manner will still give an unbiased estimate of <math alttext="\mathbf{M}_{\alpha}(\mathcal{G})_{ij}" class="ltx_Math" display="inline" id="A4.p2.4.m4.1"><semantics id="A4.p2.4.m4.1a"><mrow id="A4.p2.4.m4.1.2" xref="A4.p2.4.m4.1.2.cmml"><msub id="A4.p2.4.m4.1.2.2" xref="A4.p2.4.m4.1.2.2.cmml"><mi id="A4.p2.4.m4.1.2.2.2" xref="A4.p2.4.m4.1.2.2.2.cmml">𝐌</mi><mi id="A4.p2.4.m4.1.2.2.3" xref="A4.p2.4.m4.1.2.2.3.cmml">α</mi></msub><mo id="A4.p2.4.m4.1.2.1" xref="A4.p2.4.m4.1.2.1.cmml">⁢</mo><msub id="A4.p2.4.m4.1.2.3" xref="A4.p2.4.m4.1.2.3.cmml"><mrow id="A4.p2.4.m4.1.2.3.2.2" xref="A4.p2.4.m4.1.2.3.cmml"><mo id="A4.p2.4.m4.1.2.3.2.2.1" stretchy="false" xref="A4.p2.4.m4.1.2.3.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="A4.p2.4.m4.1.1" xref="A4.p2.4.m4.1.1.cmml">𝒢</mi><mo id="A4.p2.4.m4.1.2.3.2.2.2" stretchy="false" xref="A4.p2.4.m4.1.2.3.cmml">)</mo></mrow><mrow id="A4.p2.4.m4.1.2.3.3" xref="A4.p2.4.m4.1.2.3.3.cmml"><mi id="A4.p2.4.m4.1.2.3.3.2" xref="A4.p2.4.m4.1.2.3.3.2.cmml">i</mi><mo id="A4.p2.4.m4.1.2.3.3.1" xref="A4.p2.4.m4.1.2.3.3.1.cmml">⁢</mo><mi id="A4.p2.4.m4.1.2.3.3.3" xref="A4.p2.4.m4.1.2.3.3.3.cmml">j</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="A4.p2.4.m4.1b"><apply id="A4.p2.4.m4.1.2.cmml" xref="A4.p2.4.m4.1.2"><times id="A4.p2.4.m4.1.2.1.cmml" xref="A4.p2.4.m4.1.2.1"></times><apply id="A4.p2.4.m4.1.2.2.cmml" xref="A4.p2.4.m4.1.2.2"><csymbol cd="ambiguous" id="A4.p2.4.m4.1.2.2.1.cmml" xref="A4.p2.4.m4.1.2.2">subscript</csymbol><ci id="A4.p2.4.m4.1.2.2.2.cmml" xref="A4.p2.4.m4.1.2.2.2">𝐌</ci><ci id="A4.p2.4.m4.1.2.2.3.cmml" xref="A4.p2.4.m4.1.2.2.3">𝛼</ci></apply><apply id="A4.p2.4.m4.1.2.3.cmml" xref="A4.p2.4.m4.1.2.3"><csymbol cd="ambiguous" id="A4.p2.4.m4.1.2.3.1.cmml" xref="A4.p2.4.m4.1.2.3">subscript</csymbol><ci id="A4.p2.4.m4.1.1.cmml" xref="A4.p2.4.m4.1.1">𝒢</ci><apply id="A4.p2.4.m4.1.2.3.3.cmml" xref="A4.p2.4.m4.1.2.3.3"><times id="A4.p2.4.m4.1.2.3.3.1.cmml" xref="A4.p2.4.m4.1.2.3.3.1"></times><ci id="A4.p2.4.m4.1.2.3.3.2.cmml" xref="A4.p2.4.m4.1.2.3.3.2">𝑖</ci><ci id="A4.p2.4.m4.1.2.3.3.3.cmml" xref="A4.p2.4.m4.1.2.3.3.3">𝑗</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.p2.4.m4.1c">\mathbf{M}_{\alpha}(\mathcal{G})_{ij}</annotation><annotation encoding="application/x-llamapun" id="A4.p2.4.m4.1d">bold_M start_POSTSUBSCRIPT italic_α end_POSTSUBSCRIPT ( caligraphic_G ) start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT</annotation></semantics></math>, but with different concentration properties.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="A4.p3">
<p class="ltx_p" id="A4.p3.5"><span class="ltx_text ltx_font_bold" id="A4.p3.5.1">Computational benefits.</span>
Supposing that <math alttext="f^{(2)}_{p}=\{1\textrm{ if }p=0,\hskip 1.99997pt0\textrm{ otherwise}\}" class="ltx_Math" display="inline" id="A4.p3.1.m1.3"><semantics id="A4.p3.1.m1.3a"><mrow id="A4.p3.1.m1.3.3" xref="A4.p3.1.m1.3.3.cmml"><msubsup id="A4.p3.1.m1.3.3.3" xref="A4.p3.1.m1.3.3.3.cmml"><mi id="A4.p3.1.m1.3.3.3.2.2" xref="A4.p3.1.m1.3.3.3.2.2.cmml">f</mi><mi id="A4.p3.1.m1.3.3.3.3" xref="A4.p3.1.m1.3.3.3.3.cmml">p</mi><mrow id="A4.p3.1.m1.1.1.1.3" xref="A4.p3.1.m1.3.3.3.cmml"><mo id="A4.p3.1.m1.1.1.1.3.1" stretchy="false" xref="A4.p3.1.m1.3.3.3.cmml">(</mo><mn id="A4.p3.1.m1.1.1.1.1" xref="A4.p3.1.m1.1.1.1.1.cmml">2</mn><mo id="A4.p3.1.m1.1.1.1.3.2" stretchy="false" xref="A4.p3.1.m1.3.3.3.cmml">)</mo></mrow></msubsup><mo id="A4.p3.1.m1.3.3.2" xref="A4.p3.1.m1.3.3.2.cmml">=</mo><mrow id="A4.p3.1.m1.3.3.1.1" xref="A4.p3.1.m1.3.3.1.2.cmml"><mo id="A4.p3.1.m1.3.3.1.1.2" stretchy="false" xref="A4.p3.1.m1.3.3.1.2.cmml">{</mo><mrow id="A4.p3.1.m1.3.3.1.1.1" xref="A4.p3.1.m1.3.3.1.1.1.cmml"><mrow id="A4.p3.1.m1.3.3.1.1.1.3" xref="A4.p3.1.m1.3.3.1.1.1.3.cmml"><mn id="A4.p3.1.m1.3.3.1.1.1.3.2" xref="A4.p3.1.m1.3.3.1.1.1.3.2.cmml">1</mn><mo id="A4.p3.1.m1.3.3.1.1.1.3.1" xref="A4.p3.1.m1.3.3.1.1.1.3.1.cmml">⁢</mo><mtext id="A4.p3.1.m1.3.3.1.1.1.3.3" xref="A4.p3.1.m1.3.3.1.1.1.3.3a.cmml">&nbsp;if&nbsp;</mtext><mo id="A4.p3.1.m1.3.3.1.1.1.3.1a" xref="A4.p3.1.m1.3.3.1.1.1.3.1.cmml">⁢</mo><mi id="A4.p3.1.m1.3.3.1.1.1.3.4" xref="A4.p3.1.m1.3.3.1.1.1.3.4.cmml">p</mi></mrow><mo id="A4.p3.1.m1.3.3.1.1.1.2" xref="A4.p3.1.m1.3.3.1.1.1.2.cmml">=</mo><mrow id="A4.p3.1.m1.3.3.1.1.1.1.1" xref="A4.p3.1.m1.3.3.1.1.1.1.2.cmml"><mn id="A4.p3.1.m1.2.2" xref="A4.p3.1.m1.2.2.cmml">0</mn><mo id="A4.p3.1.m1.3.3.1.1.1.1.1.2" rspace="0.367em" xref="A4.p3.1.m1.3.3.1.1.1.1.2.cmml">,</mo><mrow id="A4.p3.1.m1.3.3.1.1.1.1.1.1" xref="A4.p3.1.m1.3.3.1.1.1.1.1.1.cmml"><mn id="A4.p3.1.m1.3.3.1.1.1.1.1.1.2" xref="A4.p3.1.m1.3.3.1.1.1.1.1.1.2.cmml">0</mn><mo id="A4.p3.1.m1.3.3.1.1.1.1.1.1.1" xref="A4.p3.1.m1.3.3.1.1.1.1.1.1.1.cmml">⁢</mo><mtext id="A4.p3.1.m1.3.3.1.1.1.1.1.1.3" xref="A4.p3.1.m1.3.3.1.1.1.1.1.1.3a.cmml">&nbsp;otherwise</mtext></mrow></mrow></mrow><mo id="A4.p3.1.m1.3.3.1.1.3" stretchy="false" xref="A4.p3.1.m1.3.3.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A4.p3.1.m1.3b"><apply id="A4.p3.1.m1.3.3.cmml" xref="A4.p3.1.m1.3.3"><eq id="A4.p3.1.m1.3.3.2.cmml" xref="A4.p3.1.m1.3.3.2"></eq><apply id="A4.p3.1.m1.3.3.3.cmml" xref="A4.p3.1.m1.3.3.3"><csymbol cd="ambiguous" id="A4.p3.1.m1.3.3.3.1.cmml" xref="A4.p3.1.m1.3.3.3">subscript</csymbol><apply id="A4.p3.1.m1.3.3.3.2.cmml" xref="A4.p3.1.m1.3.3.3"><csymbol cd="ambiguous" id="A4.p3.1.m1.3.3.3.2.1.cmml" xref="A4.p3.1.m1.3.3.3">superscript</csymbol><ci id="A4.p3.1.m1.3.3.3.2.2.cmml" xref="A4.p3.1.m1.3.3.3.2.2">𝑓</ci><cn id="A4.p3.1.m1.1.1.1.1.cmml" type="integer" xref="A4.p3.1.m1.1.1.1.1">2</cn></apply><ci id="A4.p3.1.m1.3.3.3.3.cmml" xref="A4.p3.1.m1.3.3.3.3">𝑝</ci></apply><set id="A4.p3.1.m1.3.3.1.2.cmml" xref="A4.p3.1.m1.3.3.1.1"><apply id="A4.p3.1.m1.3.3.1.1.1.cmml" xref="A4.p3.1.m1.3.3.1.1.1"><eq id="A4.p3.1.m1.3.3.1.1.1.2.cmml" xref="A4.p3.1.m1.3.3.1.1.1.2"></eq><apply id="A4.p3.1.m1.3.3.1.1.1.3.cmml" xref="A4.p3.1.m1.3.3.1.1.1.3"><times id="A4.p3.1.m1.3.3.1.1.1.3.1.cmml" xref="A4.p3.1.m1.3.3.1.1.1.3.1"></times><cn id="A4.p3.1.m1.3.3.1.1.1.3.2.cmml" type="integer" xref="A4.p3.1.m1.3.3.1.1.1.3.2">1</cn><ci id="A4.p3.1.m1.3.3.1.1.1.3.3a.cmml" xref="A4.p3.1.m1.3.3.1.1.1.3.3"><mtext id="A4.p3.1.m1.3.3.1.1.1.3.3.cmml" xref="A4.p3.1.m1.3.3.1.1.1.3.3">&nbsp;if&nbsp;</mtext></ci><ci id="A4.p3.1.m1.3.3.1.1.1.3.4.cmml" xref="A4.p3.1.m1.3.3.1.1.1.3.4">𝑝</ci></apply><list id="A4.p3.1.m1.3.3.1.1.1.1.2.cmml" xref="A4.p3.1.m1.3.3.1.1.1.1.1"><cn id="A4.p3.1.m1.2.2.cmml" type="integer" xref="A4.p3.1.m1.2.2">0</cn><apply id="A4.p3.1.m1.3.3.1.1.1.1.1.1.cmml" xref="A4.p3.1.m1.3.3.1.1.1.1.1.1"><times id="A4.p3.1.m1.3.3.1.1.1.1.1.1.1.cmml" xref="A4.p3.1.m1.3.3.1.1.1.1.1.1.1"></times><cn id="A4.p3.1.m1.3.3.1.1.1.1.1.1.2.cmml" type="integer" xref="A4.p3.1.m1.3.3.1.1.1.1.1.1.2">0</cn><ci id="A4.p3.1.m1.3.3.1.1.1.1.1.1.3a.cmml" xref="A4.p3.1.m1.3.3.1.1.1.1.1.1.3"><mtext id="A4.p3.1.m1.3.3.1.1.1.1.1.1.3.cmml" xref="A4.p3.1.m1.3.3.1.1.1.1.1.1.3">&nbsp;otherwise</mtext></ci></apply></list></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.p3.1.m1.3c">f^{(2)}_{p}=\{1\textrm{ if }p=0,\hskip 1.99997pt0\textrm{ otherwise}\}</annotation><annotation encoding="application/x-llamapun" id="A4.p3.1.m1.3d">italic_f start_POSTSUPERSCRIPT ( 2 ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT = { 1 if italic_p = 0 , 0 otherwise }</annotation></semantics></math>, <math alttext="\phi_{\mathcal{G}}^{(2)}(v_{i})_{n}=\mathbb{I}(i=n)" class="ltx_Math" display="inline" id="A4.p3.2.m2.3"><semantics id="A4.p3.2.m2.3a"><mrow id="A4.p3.2.m2.3.3" xref="A4.p3.2.m2.3.3.cmml"><mrow id="A4.p3.2.m2.2.2.1" xref="A4.p3.2.m2.2.2.1.cmml"><msubsup id="A4.p3.2.m2.2.2.1.3" xref="A4.p3.2.m2.2.2.1.3.cmml"><mi id="A4.p3.2.m2.2.2.1.3.2.2" xref="A4.p3.2.m2.2.2.1.3.2.2.cmml">ϕ</mi><mi class="ltx_font_mathcaligraphic" id="A4.p3.2.m2.2.2.1.3.2.3" xref="A4.p3.2.m2.2.2.1.3.2.3.cmml">𝒢</mi><mrow id="A4.p3.2.m2.1.1.1.3" xref="A4.p3.2.m2.2.2.1.3.cmml"><mo id="A4.p3.2.m2.1.1.1.3.1" stretchy="false" xref="A4.p3.2.m2.2.2.1.3.cmml">(</mo><mn id="A4.p3.2.m2.1.1.1.1" xref="A4.p3.2.m2.1.1.1.1.cmml">2</mn><mo id="A4.p3.2.m2.1.1.1.3.2" stretchy="false" xref="A4.p3.2.m2.2.2.1.3.cmml">)</mo></mrow></msubsup><mo id="A4.p3.2.m2.2.2.1.2" xref="A4.p3.2.m2.2.2.1.2.cmml">⁢</mo><msub id="A4.p3.2.m2.2.2.1.1" xref="A4.p3.2.m2.2.2.1.1.cmml"><mrow id="A4.p3.2.m2.2.2.1.1.1.1" xref="A4.p3.2.m2.2.2.1.1.1.1.1.cmml"><mo id="A4.p3.2.m2.2.2.1.1.1.1.2" stretchy="false" xref="A4.p3.2.m2.2.2.1.1.1.1.1.cmml">(</mo><msub id="A4.p3.2.m2.2.2.1.1.1.1.1" xref="A4.p3.2.m2.2.2.1.1.1.1.1.cmml"><mi id="A4.p3.2.m2.2.2.1.1.1.1.1.2" xref="A4.p3.2.m2.2.2.1.1.1.1.1.2.cmml">v</mi><mi id="A4.p3.2.m2.2.2.1.1.1.1.1.3" xref="A4.p3.2.m2.2.2.1.1.1.1.1.3.cmml">i</mi></msub><mo id="A4.p3.2.m2.2.2.1.1.1.1.3" stretchy="false" xref="A4.p3.2.m2.2.2.1.1.1.1.1.cmml">)</mo></mrow><mi id="A4.p3.2.m2.2.2.1.1.3" xref="A4.p3.2.m2.2.2.1.1.3.cmml">n</mi></msub></mrow><mo id="A4.p3.2.m2.3.3.3" xref="A4.p3.2.m2.3.3.3.cmml">=</mo><mrow id="A4.p3.2.m2.3.3.2" xref="A4.p3.2.m2.3.3.2.cmml"><mi id="A4.p3.2.m2.3.3.2.3" xref="A4.p3.2.m2.3.3.2.3.cmml">𝕀</mi><mo id="A4.p3.2.m2.3.3.2.2" xref="A4.p3.2.m2.3.3.2.2.cmml">⁢</mo><mrow id="A4.p3.2.m2.3.3.2.1.1" xref="A4.p3.2.m2.3.3.2.1.1.1.cmml"><mo id="A4.p3.2.m2.3.3.2.1.1.2" stretchy="false" xref="A4.p3.2.m2.3.3.2.1.1.1.cmml">(</mo><mrow id="A4.p3.2.m2.3.3.2.1.1.1" xref="A4.p3.2.m2.3.3.2.1.1.1.cmml"><mi id="A4.p3.2.m2.3.3.2.1.1.1.2" xref="A4.p3.2.m2.3.3.2.1.1.1.2.cmml">i</mi><mo id="A4.p3.2.m2.3.3.2.1.1.1.1" xref="A4.p3.2.m2.3.3.2.1.1.1.1.cmml">=</mo><mi id="A4.p3.2.m2.3.3.2.1.1.1.3" xref="A4.p3.2.m2.3.3.2.1.1.1.3.cmml">n</mi></mrow><mo id="A4.p3.2.m2.3.3.2.1.1.3" stretchy="false" xref="A4.p3.2.m2.3.3.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A4.p3.2.m2.3b"><apply id="A4.p3.2.m2.3.3.cmml" xref="A4.p3.2.m2.3.3"><eq id="A4.p3.2.m2.3.3.3.cmml" xref="A4.p3.2.m2.3.3.3"></eq><apply id="A4.p3.2.m2.2.2.1.cmml" xref="A4.p3.2.m2.2.2.1"><times id="A4.p3.2.m2.2.2.1.2.cmml" xref="A4.p3.2.m2.2.2.1.2"></times><apply id="A4.p3.2.m2.2.2.1.3.cmml" xref="A4.p3.2.m2.2.2.1.3"><csymbol cd="ambiguous" id="A4.p3.2.m2.2.2.1.3.1.cmml" xref="A4.p3.2.m2.2.2.1.3">superscript</csymbol><apply id="A4.p3.2.m2.2.2.1.3.2.cmml" xref="A4.p3.2.m2.2.2.1.3"><csymbol cd="ambiguous" id="A4.p3.2.m2.2.2.1.3.2.1.cmml" xref="A4.p3.2.m2.2.2.1.3">subscript</csymbol><ci id="A4.p3.2.m2.2.2.1.3.2.2.cmml" xref="A4.p3.2.m2.2.2.1.3.2.2">italic-ϕ</ci><ci id="A4.p3.2.m2.2.2.1.3.2.3.cmml" xref="A4.p3.2.m2.2.2.1.3.2.3">𝒢</ci></apply><cn id="A4.p3.2.m2.1.1.1.1.cmml" type="integer" xref="A4.p3.2.m2.1.1.1.1">2</cn></apply><apply id="A4.p3.2.m2.2.2.1.1.cmml" xref="A4.p3.2.m2.2.2.1.1"><csymbol cd="ambiguous" id="A4.p3.2.m2.2.2.1.1.2.cmml" xref="A4.p3.2.m2.2.2.1.1">subscript</csymbol><apply id="A4.p3.2.m2.2.2.1.1.1.1.1.cmml" xref="A4.p3.2.m2.2.2.1.1.1.1"><csymbol cd="ambiguous" id="A4.p3.2.m2.2.2.1.1.1.1.1.1.cmml" xref="A4.p3.2.m2.2.2.1.1.1.1">subscript</csymbol><ci id="A4.p3.2.m2.2.2.1.1.1.1.1.2.cmml" xref="A4.p3.2.m2.2.2.1.1.1.1.1.2">𝑣</ci><ci id="A4.p3.2.m2.2.2.1.1.1.1.1.3.cmml" xref="A4.p3.2.m2.2.2.1.1.1.1.1.3">𝑖</ci></apply><ci id="A4.p3.2.m2.2.2.1.1.3.cmml" xref="A4.p3.2.m2.2.2.1.1.3">𝑛</ci></apply></apply><apply id="A4.p3.2.m2.3.3.2.cmml" xref="A4.p3.2.m2.3.3.2"><times id="A4.p3.2.m2.3.3.2.2.cmml" xref="A4.p3.2.m2.3.3.2.2"></times><ci id="A4.p3.2.m2.3.3.2.3.cmml" xref="A4.p3.2.m2.3.3.2.3">𝕀</ci><apply id="A4.p3.2.m2.3.3.2.1.1.1.cmml" xref="A4.p3.2.m2.3.3.2.1.1"><eq id="A4.p3.2.m2.3.3.2.1.1.1.1.cmml" xref="A4.p3.2.m2.3.3.2.1.1.1.1"></eq><ci id="A4.p3.2.m2.3.3.2.1.1.1.2.cmml" xref="A4.p3.2.m2.3.3.2.1.1.1.2">𝑖</ci><ci id="A4.p3.2.m2.3.3.2.1.1.1.3.cmml" xref="A4.p3.2.m2.3.3.2.1.1.1.3">𝑛</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.p3.2.m2.3c">\phi_{\mathcal{G}}^{(2)}(v_{i})_{n}=\mathbb{I}(i=n)</annotation><annotation encoding="application/x-llamapun" id="A4.p3.2.m2.3d">italic_ϕ start_POSTSUBSCRIPT caligraphic_G end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( 2 ) end_POSTSUPERSCRIPT ( italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT = blackboard_I ( italic_i = italic_n )</annotation></semantics></math>, a one-hot vector only nonzero at the coordinate corresponding to <math alttext="v_{i}" class="ltx_Math" display="inline" id="A4.p3.3.m3.1"><semantics id="A4.p3.3.m3.1a"><msub id="A4.p3.3.m3.1.1" xref="A4.p3.3.m3.1.1.cmml"><mi id="A4.p3.3.m3.1.1.2" xref="A4.p3.3.m3.1.1.2.cmml">v</mi><mi id="A4.p3.3.m3.1.1.3" xref="A4.p3.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A4.p3.3.m3.1b"><apply id="A4.p3.3.m3.1.1.cmml" xref="A4.p3.3.m3.1.1"><csymbol cd="ambiguous" id="A4.p3.3.m3.1.1.1.cmml" xref="A4.p3.3.m3.1.1">subscript</csymbol><ci id="A4.p3.3.m3.1.1.2.cmml" xref="A4.p3.3.m3.1.1.2">𝑣</ci><ci id="A4.p3.3.m3.1.1.3.cmml" xref="A4.p3.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.p3.3.m3.1c">v_{i}</annotation><annotation encoding="application/x-llamapun" id="A4.p3.3.m3.1d">italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>.
In other words, we do not need to simulate any random walks to obtain GRFs for the keys; <math alttext="\mathbf{\Phi}_{\mathcal{G}}^{(2)}=\mathbf{I}_{N}" class="ltx_Math" display="inline" id="A4.p3.4.m4.1"><semantics id="A4.p3.4.m4.1a"><mrow id="A4.p3.4.m4.1.2" xref="A4.p3.4.m4.1.2.cmml"><msubsup id="A4.p3.4.m4.1.2.2" xref="A4.p3.4.m4.1.2.2.cmml"><mi id="A4.p3.4.m4.1.2.2.2.2" xref="A4.p3.4.m4.1.2.2.2.2.cmml">𝚽</mi><mi class="ltx_font_mathcaligraphic" id="A4.p3.4.m4.1.2.2.2.3" xref="A4.p3.4.m4.1.2.2.2.3.cmml">𝒢</mi><mrow id="A4.p3.4.m4.1.1.1.3" xref="A4.p3.4.m4.1.2.2.cmml"><mo id="A4.p3.4.m4.1.1.1.3.1" stretchy="false" xref="A4.p3.4.m4.1.2.2.cmml">(</mo><mn id="A4.p3.4.m4.1.1.1.1" xref="A4.p3.4.m4.1.1.1.1.cmml">2</mn><mo id="A4.p3.4.m4.1.1.1.3.2" stretchy="false" xref="A4.p3.4.m4.1.2.2.cmml">)</mo></mrow></msubsup><mo id="A4.p3.4.m4.1.2.1" xref="A4.p3.4.m4.1.2.1.cmml">=</mo><msub id="A4.p3.4.m4.1.2.3" xref="A4.p3.4.m4.1.2.3.cmml"><mi id="A4.p3.4.m4.1.2.3.2" xref="A4.p3.4.m4.1.2.3.2.cmml">𝐈</mi><mi id="A4.p3.4.m4.1.2.3.3" xref="A4.p3.4.m4.1.2.3.3.cmml">N</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="A4.p3.4.m4.1b"><apply id="A4.p3.4.m4.1.2.cmml" xref="A4.p3.4.m4.1.2"><eq id="A4.p3.4.m4.1.2.1.cmml" xref="A4.p3.4.m4.1.2.1"></eq><apply id="A4.p3.4.m4.1.2.2.cmml" xref="A4.p3.4.m4.1.2.2"><csymbol cd="ambiguous" id="A4.p3.4.m4.1.2.2.1.cmml" xref="A4.p3.4.m4.1.2.2">superscript</csymbol><apply id="A4.p3.4.m4.1.2.2.2.cmml" xref="A4.p3.4.m4.1.2.2"><csymbol cd="ambiguous" id="A4.p3.4.m4.1.2.2.2.1.cmml" xref="A4.p3.4.m4.1.2.2">subscript</csymbol><ci id="A4.p3.4.m4.1.2.2.2.2.cmml" xref="A4.p3.4.m4.1.2.2.2.2">𝚽</ci><ci id="A4.p3.4.m4.1.2.2.2.3.cmml" xref="A4.p3.4.m4.1.2.2.2.3">𝒢</ci></apply><cn id="A4.p3.4.m4.1.1.1.1.cmml" type="integer" xref="A4.p3.4.m4.1.1.1.1">2</cn></apply><apply id="A4.p3.4.m4.1.2.3.cmml" xref="A4.p3.4.m4.1.2.3"><csymbol cd="ambiguous" id="A4.p3.4.m4.1.2.3.1.cmml" xref="A4.p3.4.m4.1.2.3">subscript</csymbol><ci id="A4.p3.4.m4.1.2.3.2.cmml" xref="A4.p3.4.m4.1.2.3.2">𝐈</ci><ci id="A4.p3.4.m4.1.2.3.3.cmml" xref="A4.p3.4.m4.1.2.3.3">𝑁</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.p3.4.m4.1c">\mathbf{\Phi}_{\mathcal{G}}^{(2)}=\mathbf{I}_{N}</annotation><annotation encoding="application/x-llamapun" id="A4.p3.4.m4.1d">bold_Φ start_POSTSUBSCRIPT caligraphic_G end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( 2 ) end_POSTSUPERSCRIPT = bold_I start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT</annotation></semantics></math> with <math alttext="\mathbf{I}_{N}\in\mathbb{R}^{N\times N}" class="ltx_Math" display="inline" id="A4.p3.5.m5.1"><semantics id="A4.p3.5.m5.1a"><mrow id="A4.p3.5.m5.1.1" xref="A4.p3.5.m5.1.1.cmml"><msub id="A4.p3.5.m5.1.1.2" xref="A4.p3.5.m5.1.1.2.cmml"><mi id="A4.p3.5.m5.1.1.2.2" xref="A4.p3.5.m5.1.1.2.2.cmml">𝐈</mi><mi id="A4.p3.5.m5.1.1.2.3" xref="A4.p3.5.m5.1.1.2.3.cmml">N</mi></msub><mo id="A4.p3.5.m5.1.1.1" xref="A4.p3.5.m5.1.1.1.cmml">∈</mo><msup id="A4.p3.5.m5.1.1.3" xref="A4.p3.5.m5.1.1.3.cmml"><mi id="A4.p3.5.m5.1.1.3.2" xref="A4.p3.5.m5.1.1.3.2.cmml">ℝ</mi><mrow id="A4.p3.5.m5.1.1.3.3" xref="A4.p3.5.m5.1.1.3.3.cmml"><mi id="A4.p3.5.m5.1.1.3.3.2" xref="A4.p3.5.m5.1.1.3.3.2.cmml">N</mi><mo id="A4.p3.5.m5.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="A4.p3.5.m5.1.1.3.3.1.cmml">×</mo><mi id="A4.p3.5.m5.1.1.3.3.3" xref="A4.p3.5.m5.1.1.3.3.3.cmml">N</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A4.p3.5.m5.1b"><apply id="A4.p3.5.m5.1.1.cmml" xref="A4.p3.5.m5.1.1"><in id="A4.p3.5.m5.1.1.1.cmml" xref="A4.p3.5.m5.1.1.1"></in><apply id="A4.p3.5.m5.1.1.2.cmml" xref="A4.p3.5.m5.1.1.2"><csymbol cd="ambiguous" id="A4.p3.5.m5.1.1.2.1.cmml" xref="A4.p3.5.m5.1.1.2">subscript</csymbol><ci id="A4.p3.5.m5.1.1.2.2.cmml" xref="A4.p3.5.m5.1.1.2.2">𝐈</ci><ci id="A4.p3.5.m5.1.1.2.3.cmml" xref="A4.p3.5.m5.1.1.2.3">𝑁</ci></apply><apply id="A4.p3.5.m5.1.1.3.cmml" xref="A4.p3.5.m5.1.1.3"><csymbol cd="ambiguous" id="A4.p3.5.m5.1.1.3.1.cmml" xref="A4.p3.5.m5.1.1.3">superscript</csymbol><ci id="A4.p3.5.m5.1.1.3.2.cmml" xref="A4.p3.5.m5.1.1.3.2">ℝ</ci><apply id="A4.p3.5.m5.1.1.3.3.cmml" xref="A4.p3.5.m5.1.1.3.3"><times id="A4.p3.5.m5.1.1.3.3.1.cmml" xref="A4.p3.5.m5.1.1.3.3.1"></times><ci id="A4.p3.5.m5.1.1.3.3.2.cmml" xref="A4.p3.5.m5.1.1.3.3.2">𝑁</ci><ci id="A4.p3.5.m5.1.1.3.3.3.cmml" xref="A4.p3.5.m5.1.1.3.3.3">𝑁</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.p3.5.m5.1c">\mathbf{I}_{N}\in\mathbb{R}^{N\times N}</annotation><annotation encoding="application/x-llamapun" id="A4.p3.5.m5.1d">bold_I start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_N × italic_N end_POSTSUPERSCRIPT</annotation></semantics></math> the identity matrix.
It follows that</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equation ltx_eqn_table" id="A4.E24">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\widehat{\mathbf{M}}_{\alpha}(\mathcal{G})=\mathbf{\Phi}_{\mathcal{G}}^{(1)}{%
\mathbf{\Phi}_{\mathcal{G}}^{(2)}}^{\top}=\mathbf{\Phi}_{\mathcal{G}}^{(1)}%
\eqqcolon[\phi^{(1)}_{\mathcal{G}}(v_{i})]_{i=1}^{N}." class="ltx_Math" display="block" id="A4.E24.m1.6"><semantics id="A4.E24.m1.6a"><mrow id="A4.E24.m1.6.6.1" xref="A4.E24.m1.6.6.1.1.cmml"><mrow id="A4.E24.m1.6.6.1.1" xref="A4.E24.m1.6.6.1.1.cmml"><mrow id="A4.E24.m1.6.6.1.1.3" xref="A4.E24.m1.6.6.1.1.3.cmml"><msub id="A4.E24.m1.6.6.1.1.3.2" xref="A4.E24.m1.6.6.1.1.3.2.cmml"><mover accent="true" id="A4.E24.m1.6.6.1.1.3.2.2" xref="A4.E24.m1.6.6.1.1.3.2.2.cmml"><mi id="A4.E24.m1.6.6.1.1.3.2.2.2" xref="A4.E24.m1.6.6.1.1.3.2.2.2.cmml">𝐌</mi><mo id="A4.E24.m1.6.6.1.1.3.2.2.1" xref="A4.E24.m1.6.6.1.1.3.2.2.1.cmml">^</mo></mover><mi id="A4.E24.m1.6.6.1.1.3.2.3" xref="A4.E24.m1.6.6.1.1.3.2.3.cmml">α</mi></msub><mo id="A4.E24.m1.6.6.1.1.3.1" xref="A4.E24.m1.6.6.1.1.3.1.cmml">⁢</mo><mrow id="A4.E24.m1.6.6.1.1.3.3.2" xref="A4.E24.m1.6.6.1.1.3.cmml"><mo id="A4.E24.m1.6.6.1.1.3.3.2.1" stretchy="false" xref="A4.E24.m1.6.6.1.1.3.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="A4.E24.m1.5.5" xref="A4.E24.m1.5.5.cmml">𝒢</mi><mo id="A4.E24.m1.6.6.1.1.3.3.2.2" stretchy="false" xref="A4.E24.m1.6.6.1.1.3.cmml">)</mo></mrow></mrow><mo id="A4.E24.m1.6.6.1.1.4" xref="A4.E24.m1.6.6.1.1.4.cmml">=</mo><mrow id="A4.E24.m1.6.6.1.1.5" xref="A4.E24.m1.6.6.1.1.5.cmml"><msubsup id="A4.E24.m1.6.6.1.1.5.2" xref="A4.E24.m1.6.6.1.1.5.2.cmml"><mi id="A4.E24.m1.6.6.1.1.5.2.2.2" xref="A4.E24.m1.6.6.1.1.5.2.2.2.cmml">𝚽</mi><mi class="ltx_font_mathcaligraphic" id="A4.E24.m1.6.6.1.1.5.2.2.3" xref="A4.E24.m1.6.6.1.1.5.2.2.3.cmml">𝒢</mi><mrow id="A4.E24.m1.1.1.1.3" xref="A4.E24.m1.6.6.1.1.5.2.cmml"><mo id="A4.E24.m1.1.1.1.3.1" stretchy="false" xref="A4.E24.m1.6.6.1.1.5.2.cmml">(</mo><mn id="A4.E24.m1.1.1.1.1" xref="A4.E24.m1.1.1.1.1.cmml">1</mn><mo id="A4.E24.m1.1.1.1.3.2" stretchy="false" xref="A4.E24.m1.6.6.1.1.5.2.cmml">)</mo></mrow></msubsup><mo id="A4.E24.m1.6.6.1.1.5.1" xref="A4.E24.m1.6.6.1.1.5.1.cmml">⁢</mo><mmultiscripts id="A4.E24.m1.6.6.1.1.5.3" xref="A4.E24.m1.6.6.1.1.5.3.cmml"><mi id="A4.E24.m1.6.6.1.1.5.3.2.2.2" xref="A4.E24.m1.6.6.1.1.5.3.2.2.2.cmml">𝚽</mi><mi class="ltx_font_mathcaligraphic" id="A4.E24.m1.6.6.1.1.5.3.2.2.3" xref="A4.E24.m1.6.6.1.1.5.3.2.2.3.cmml">𝒢</mi><mrow id="A4.E24.m1.2.2.1.3" xref="A4.E24.m1.6.6.1.1.5.3.cmml"><mo id="A4.E24.m1.2.2.1.3.1" stretchy="false" xref="A4.E24.m1.6.6.1.1.5.3.cmml">(</mo><mn id="A4.E24.m1.2.2.1.1" xref="A4.E24.m1.2.2.1.1.cmml">2</mn><mo id="A4.E24.m1.2.2.1.3.2" stretchy="false" xref="A4.E24.m1.6.6.1.1.5.3.cmml">)</mo></mrow><mrow id="A4.E24.m1.6.6.1.1.5.3a" xref="A4.E24.m1.6.6.1.1.5.3.cmml"></mrow><mo id="A4.E24.m1.6.6.1.1.5.3.3" xref="A4.E24.m1.6.6.1.1.5.3.3.cmml">⊤</mo></mmultiscripts></mrow><mo id="A4.E24.m1.6.6.1.1.6" xref="A4.E24.m1.6.6.1.1.6.cmml">=</mo><msubsup id="A4.E24.m1.6.6.1.1.7" xref="A4.E24.m1.6.6.1.1.7.cmml"><mi id="A4.E24.m1.6.6.1.1.7.2.2" xref="A4.E24.m1.6.6.1.1.7.2.2.cmml">𝚽</mi><mi class="ltx_font_mathcaligraphic" id="A4.E24.m1.6.6.1.1.7.2.3" xref="A4.E24.m1.6.6.1.1.7.2.3.cmml">𝒢</mi><mrow id="A4.E24.m1.3.3.1.3" xref="A4.E24.m1.6.6.1.1.7.cmml"><mo id="A4.E24.m1.3.3.1.3.1" stretchy="false" xref="A4.E24.m1.6.6.1.1.7.cmml">(</mo><mn id="A4.E24.m1.3.3.1.1" xref="A4.E24.m1.3.3.1.1.cmml">1</mn><mo id="A4.E24.m1.3.3.1.3.2" stretchy="false" xref="A4.E24.m1.6.6.1.1.7.cmml">)</mo></mrow></msubsup><mo id="A4.E24.m1.6.6.1.1.8" xref="A4.E24.m1.6.6.1.1.8.cmml">≕</mo><msubsup id="A4.E24.m1.6.6.1.1.1" xref="A4.E24.m1.6.6.1.1.1.cmml"><mrow id="A4.E24.m1.6.6.1.1.1.1.1.1" xref="A4.E24.m1.6.6.1.1.1.1.1.2.cmml"><mo id="A4.E24.m1.6.6.1.1.1.1.1.1.2" stretchy="false" xref="A4.E24.m1.6.6.1.1.1.1.1.2.1.cmml">[</mo><mrow id="A4.E24.m1.6.6.1.1.1.1.1.1.1" xref="A4.E24.m1.6.6.1.1.1.1.1.1.1.cmml"><msubsup id="A4.E24.m1.6.6.1.1.1.1.1.1.1.3" xref="A4.E24.m1.6.6.1.1.1.1.1.1.1.3.cmml"><mi id="A4.E24.m1.6.6.1.1.1.1.1.1.1.3.2.2" xref="A4.E24.m1.6.6.1.1.1.1.1.1.1.3.2.2.cmml">ϕ</mi><mi class="ltx_font_mathcaligraphic" id="A4.E24.m1.6.6.1.1.1.1.1.1.1.3.3" xref="A4.E24.m1.6.6.1.1.1.1.1.1.1.3.3.cmml">𝒢</mi><mrow id="A4.E24.m1.4.4.1.3" xref="A4.E24.m1.6.6.1.1.1.1.1.1.1.3.cmml"><mo id="A4.E24.m1.4.4.1.3.1" stretchy="false" xref="A4.E24.m1.6.6.1.1.1.1.1.1.1.3.cmml">(</mo><mn id="A4.E24.m1.4.4.1.1" xref="A4.E24.m1.4.4.1.1.cmml">1</mn><mo id="A4.E24.m1.4.4.1.3.2" stretchy="false" xref="A4.E24.m1.6.6.1.1.1.1.1.1.1.3.cmml">)</mo></mrow></msubsup><mo id="A4.E24.m1.6.6.1.1.1.1.1.1.1.2" xref="A4.E24.m1.6.6.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A4.E24.m1.6.6.1.1.1.1.1.1.1.1.1" xref="A4.E24.m1.6.6.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="A4.E24.m1.6.6.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="A4.E24.m1.6.6.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="A4.E24.m1.6.6.1.1.1.1.1.1.1.1.1.1" xref="A4.E24.m1.6.6.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="A4.E24.m1.6.6.1.1.1.1.1.1.1.1.1.1.2" xref="A4.E24.m1.6.6.1.1.1.1.1.1.1.1.1.1.2.cmml">v</mi><mi id="A4.E24.m1.6.6.1.1.1.1.1.1.1.1.1.1.3" xref="A4.E24.m1.6.6.1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="A4.E24.m1.6.6.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="A4.E24.m1.6.6.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A4.E24.m1.6.6.1.1.1.1.1.1.3" stretchy="false" xref="A4.E24.m1.6.6.1.1.1.1.1.2.1.cmml">]</mo></mrow><mrow id="A4.E24.m1.6.6.1.1.1.1.3" xref="A4.E24.m1.6.6.1.1.1.1.3.cmml"><mi id="A4.E24.m1.6.6.1.1.1.1.3.2" xref="A4.E24.m1.6.6.1.1.1.1.3.2.cmml">i</mi><mo id="A4.E24.m1.6.6.1.1.1.1.3.1" xref="A4.E24.m1.6.6.1.1.1.1.3.1.cmml">=</mo><mn id="A4.E24.m1.6.6.1.1.1.1.3.3" xref="A4.E24.m1.6.6.1.1.1.1.3.3.cmml">1</mn></mrow><mi id="A4.E24.m1.6.6.1.1.1.3" xref="A4.E24.m1.6.6.1.1.1.3.cmml">N</mi></msubsup></mrow><mo id="A4.E24.m1.6.6.1.2" lspace="0em" xref="A4.E24.m1.6.6.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A4.E24.m1.6b"><apply id="A4.E24.m1.6.6.1.1.cmml" xref="A4.E24.m1.6.6.1"><and id="A4.E24.m1.6.6.1.1a.cmml" xref="A4.E24.m1.6.6.1"></and><apply id="A4.E24.m1.6.6.1.1b.cmml" xref="A4.E24.m1.6.6.1"><eq id="A4.E24.m1.6.6.1.1.4.cmml" xref="A4.E24.m1.6.6.1.1.4"></eq><apply id="A4.E24.m1.6.6.1.1.3.cmml" xref="A4.E24.m1.6.6.1.1.3"><times id="A4.E24.m1.6.6.1.1.3.1.cmml" xref="A4.E24.m1.6.6.1.1.3.1"></times><apply id="A4.E24.m1.6.6.1.1.3.2.cmml" xref="A4.E24.m1.6.6.1.1.3.2"><csymbol cd="ambiguous" id="A4.E24.m1.6.6.1.1.3.2.1.cmml" xref="A4.E24.m1.6.6.1.1.3.2">subscript</csymbol><apply id="A4.E24.m1.6.6.1.1.3.2.2.cmml" xref="A4.E24.m1.6.6.1.1.3.2.2"><ci id="A4.E24.m1.6.6.1.1.3.2.2.1.cmml" xref="A4.E24.m1.6.6.1.1.3.2.2.1">^</ci><ci id="A4.E24.m1.6.6.1.1.3.2.2.2.cmml" xref="A4.E24.m1.6.6.1.1.3.2.2.2">𝐌</ci></apply><ci id="A4.E24.m1.6.6.1.1.3.2.3.cmml" xref="A4.E24.m1.6.6.1.1.3.2.3">𝛼</ci></apply><ci id="A4.E24.m1.5.5.cmml" xref="A4.E24.m1.5.5">𝒢</ci></apply><apply id="A4.E24.m1.6.6.1.1.5.cmml" xref="A4.E24.m1.6.6.1.1.5"><times id="A4.E24.m1.6.6.1.1.5.1.cmml" xref="A4.E24.m1.6.6.1.1.5.1"></times><apply id="A4.E24.m1.6.6.1.1.5.2.cmml" xref="A4.E24.m1.6.6.1.1.5.2"><csymbol cd="ambiguous" id="A4.E24.m1.6.6.1.1.5.2.1.cmml" xref="A4.E24.m1.6.6.1.1.5.2">superscript</csymbol><apply id="A4.E24.m1.6.6.1.1.5.2.2.cmml" xref="A4.E24.m1.6.6.1.1.5.2"><csymbol cd="ambiguous" id="A4.E24.m1.6.6.1.1.5.2.2.1.cmml" xref="A4.E24.m1.6.6.1.1.5.2">subscript</csymbol><ci id="A4.E24.m1.6.6.1.1.5.2.2.2.cmml" xref="A4.E24.m1.6.6.1.1.5.2.2.2">𝚽</ci><ci id="A4.E24.m1.6.6.1.1.5.2.2.3.cmml" xref="A4.E24.m1.6.6.1.1.5.2.2.3">𝒢</ci></apply><cn id="A4.E24.m1.1.1.1.1.cmml" type="integer" xref="A4.E24.m1.1.1.1.1">1</cn></apply><apply id="A4.E24.m1.6.6.1.1.5.3.cmml" xref="A4.E24.m1.6.6.1.1.5.3"><csymbol cd="ambiguous" id="A4.E24.m1.6.6.1.1.5.3.1.cmml" xref="A4.E24.m1.6.6.1.1.5.3">superscript</csymbol><apply id="A4.E24.m1.6.6.1.1.5.3.2.cmml" xref="A4.E24.m1.6.6.1.1.5.3"><csymbol cd="ambiguous" id="A4.E24.m1.6.6.1.1.5.3.2.1.cmml" xref="A4.E24.m1.6.6.1.1.5.3">superscript</csymbol><apply id="A4.E24.m1.6.6.1.1.5.3.2.2.cmml" xref="A4.E24.m1.6.6.1.1.5.3"><csymbol cd="ambiguous" id="A4.E24.m1.6.6.1.1.5.3.2.2.1.cmml" xref="A4.E24.m1.6.6.1.1.5.3">subscript</csymbol><ci id="A4.E24.m1.6.6.1.1.5.3.2.2.2.cmml" xref="A4.E24.m1.6.6.1.1.5.3.2.2.2">𝚽</ci><ci id="A4.E24.m1.6.6.1.1.5.3.2.2.3.cmml" xref="A4.E24.m1.6.6.1.1.5.3.2.2.3">𝒢</ci></apply><cn id="A4.E24.m1.2.2.1.1.cmml" type="integer" xref="A4.E24.m1.2.2.1.1">2</cn></apply><csymbol cd="latexml" id="A4.E24.m1.6.6.1.1.5.3.3.cmml" xref="A4.E24.m1.6.6.1.1.5.3.3">top</csymbol></apply></apply></apply><apply id="A4.E24.m1.6.6.1.1c.cmml" xref="A4.E24.m1.6.6.1"><eq id="A4.E24.m1.6.6.1.1.6.cmml" xref="A4.E24.m1.6.6.1.1.6"></eq><share href="https://arxiv.org/html/2410.03462v1#A4.E24.m1.6.6.1.1.5.cmml" id="A4.E24.m1.6.6.1.1d.cmml" xref="A4.E24.m1.6.6.1"></share><apply id="A4.E24.m1.6.6.1.1.7.cmml" xref="A4.E24.m1.6.6.1.1.7"><csymbol cd="ambiguous" id="A4.E24.m1.6.6.1.1.7.1.cmml" xref="A4.E24.m1.6.6.1.1.7">superscript</csymbol><apply id="A4.E24.m1.6.6.1.1.7.2.cmml" xref="A4.E24.m1.6.6.1.1.7"><csymbol cd="ambiguous" id="A4.E24.m1.6.6.1.1.7.2.1.cmml" xref="A4.E24.m1.6.6.1.1.7">subscript</csymbol><ci id="A4.E24.m1.6.6.1.1.7.2.2.cmml" xref="A4.E24.m1.6.6.1.1.7.2.2">𝚽</ci><ci id="A4.E24.m1.6.6.1.1.7.2.3.cmml" xref="A4.E24.m1.6.6.1.1.7.2.3">𝒢</ci></apply><cn id="A4.E24.m1.3.3.1.1.cmml" type="integer" xref="A4.E24.m1.3.3.1.1">1</cn></apply></apply><apply id="A4.E24.m1.6.6.1.1e.cmml" xref="A4.E24.m1.6.6.1"><ci id="A4.E24.m1.6.6.1.1.8.cmml" xref="A4.E24.m1.6.6.1.1.8">≕</ci><share href="https://arxiv.org/html/2410.03462v1#A4.E24.m1.6.6.1.1.7.cmml" id="A4.E24.m1.6.6.1.1f.cmml" xref="A4.E24.m1.6.6.1"></share><apply id="A4.E24.m1.6.6.1.1.1.cmml" xref="A4.E24.m1.6.6.1.1.1"><csymbol cd="ambiguous" id="A4.E24.m1.6.6.1.1.1.2.cmml" xref="A4.E24.m1.6.6.1.1.1">superscript</csymbol><apply id="A4.E24.m1.6.6.1.1.1.1.cmml" xref="A4.E24.m1.6.6.1.1.1"><csymbol cd="ambiguous" id="A4.E24.m1.6.6.1.1.1.1.2.cmml" xref="A4.E24.m1.6.6.1.1.1">subscript</csymbol><apply id="A4.E24.m1.6.6.1.1.1.1.1.2.cmml" xref="A4.E24.m1.6.6.1.1.1.1.1.1"><csymbol cd="latexml" id="A4.E24.m1.6.6.1.1.1.1.1.2.1.cmml" xref="A4.E24.m1.6.6.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="A4.E24.m1.6.6.1.1.1.1.1.1.1.cmml" xref="A4.E24.m1.6.6.1.1.1.1.1.1.1"><times id="A4.E24.m1.6.6.1.1.1.1.1.1.1.2.cmml" xref="A4.E24.m1.6.6.1.1.1.1.1.1.1.2"></times><apply id="A4.E24.m1.6.6.1.1.1.1.1.1.1.3.cmml" xref="A4.E24.m1.6.6.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A4.E24.m1.6.6.1.1.1.1.1.1.1.3.1.cmml" xref="A4.E24.m1.6.6.1.1.1.1.1.1.1.3">subscript</csymbol><apply id="A4.E24.m1.6.6.1.1.1.1.1.1.1.3.2.cmml" xref="A4.E24.m1.6.6.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A4.E24.m1.6.6.1.1.1.1.1.1.1.3.2.1.cmml" xref="A4.E24.m1.6.6.1.1.1.1.1.1.1.3">superscript</csymbol><ci id="A4.E24.m1.6.6.1.1.1.1.1.1.1.3.2.2.cmml" xref="A4.E24.m1.6.6.1.1.1.1.1.1.1.3.2.2">italic-ϕ</ci><cn id="A4.E24.m1.4.4.1.1.cmml" type="integer" xref="A4.E24.m1.4.4.1.1">1</cn></apply><ci id="A4.E24.m1.6.6.1.1.1.1.1.1.1.3.3.cmml" xref="A4.E24.m1.6.6.1.1.1.1.1.1.1.3.3">𝒢</ci></apply><apply id="A4.E24.m1.6.6.1.1.1.1.1.1.1.1.1.1.cmml" xref="A4.E24.m1.6.6.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A4.E24.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A4.E24.m1.6.6.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="A4.E24.m1.6.6.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A4.E24.m1.6.6.1.1.1.1.1.1.1.1.1.1.2">𝑣</ci><ci id="A4.E24.m1.6.6.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A4.E24.m1.6.6.1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply></apply><apply id="A4.E24.m1.6.6.1.1.1.1.3.cmml" xref="A4.E24.m1.6.6.1.1.1.1.3"><eq id="A4.E24.m1.6.6.1.1.1.1.3.1.cmml" xref="A4.E24.m1.6.6.1.1.1.1.3.1"></eq><ci id="A4.E24.m1.6.6.1.1.1.1.3.2.cmml" xref="A4.E24.m1.6.6.1.1.1.1.3.2">𝑖</ci><cn id="A4.E24.m1.6.6.1.1.1.1.3.3.cmml" type="integer" xref="A4.E24.m1.6.6.1.1.1.1.3.3">1</cn></apply></apply><ci id="A4.E24.m1.6.6.1.1.1.3.cmml" xref="A4.E24.m1.6.6.1.1.1.3">𝑁</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.E24.m1.6c">\widehat{\mathbf{M}}_{\alpha}(\mathcal{G})=\mathbf{\Phi}_{\mathcal{G}}^{(1)}{%
\mathbf{\Phi}_{\mathcal{G}}^{(2)}}^{\top}=\mathbf{\Phi}_{\mathcal{G}}^{(1)}%
\eqqcolon[\phi^{(1)}_{\mathcal{G}}(v_{i})]_{i=1}^{N}.</annotation><annotation encoding="application/x-llamapun" id="A4.E24.m1.6d">over^ start_ARG bold_M end_ARG start_POSTSUBSCRIPT italic_α end_POSTSUBSCRIPT ( caligraphic_G ) = bold_Φ start_POSTSUBSCRIPT caligraphic_G end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( 1 ) end_POSTSUPERSCRIPT bold_Φ start_POSTSUBSCRIPT caligraphic_G end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( 2 ) end_POSTSUPERSCRIPT start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT = bold_Φ start_POSTSUBSCRIPT caligraphic_G end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( 1 ) end_POSTSUPERSCRIPT ≕ [ italic_ϕ start_POSTSUPERSCRIPT ( 1 ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT caligraphic_G end_POSTSUBSCRIPT ( italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) ] start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(24)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A4.p3.7">But <math alttext="\phi^{(1)}(v_{i})" class="ltx_Math" display="inline" id="A4.p3.6.m1.2"><semantics id="A4.p3.6.m1.2a"><mrow id="A4.p3.6.m1.2.2" xref="A4.p3.6.m1.2.2.cmml"><msup id="A4.p3.6.m1.2.2.3" xref="A4.p3.6.m1.2.2.3.cmml"><mi id="A4.p3.6.m1.2.2.3.2" xref="A4.p3.6.m1.2.2.3.2.cmml">ϕ</mi><mrow id="A4.p3.6.m1.1.1.1.3" xref="A4.p3.6.m1.2.2.3.cmml"><mo id="A4.p3.6.m1.1.1.1.3.1" stretchy="false" xref="A4.p3.6.m1.2.2.3.cmml">(</mo><mn id="A4.p3.6.m1.1.1.1.1" xref="A4.p3.6.m1.1.1.1.1.cmml">1</mn><mo id="A4.p3.6.m1.1.1.1.3.2" stretchy="false" xref="A4.p3.6.m1.2.2.3.cmml">)</mo></mrow></msup><mo id="A4.p3.6.m1.2.2.2" xref="A4.p3.6.m1.2.2.2.cmml">⁢</mo><mrow id="A4.p3.6.m1.2.2.1.1" xref="A4.p3.6.m1.2.2.1.1.1.cmml"><mo id="A4.p3.6.m1.2.2.1.1.2" stretchy="false" xref="A4.p3.6.m1.2.2.1.1.1.cmml">(</mo><msub id="A4.p3.6.m1.2.2.1.1.1" xref="A4.p3.6.m1.2.2.1.1.1.cmml"><mi id="A4.p3.6.m1.2.2.1.1.1.2" xref="A4.p3.6.m1.2.2.1.1.1.2.cmml">v</mi><mi id="A4.p3.6.m1.2.2.1.1.1.3" xref="A4.p3.6.m1.2.2.1.1.1.3.cmml">i</mi></msub><mo id="A4.p3.6.m1.2.2.1.1.3" stretchy="false" xref="A4.p3.6.m1.2.2.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A4.p3.6.m1.2b"><apply id="A4.p3.6.m1.2.2.cmml" xref="A4.p3.6.m1.2.2"><times id="A4.p3.6.m1.2.2.2.cmml" xref="A4.p3.6.m1.2.2.2"></times><apply id="A4.p3.6.m1.2.2.3.cmml" xref="A4.p3.6.m1.2.2.3"><csymbol cd="ambiguous" id="A4.p3.6.m1.2.2.3.1.cmml" xref="A4.p3.6.m1.2.2.3">superscript</csymbol><ci id="A4.p3.6.m1.2.2.3.2.cmml" xref="A4.p3.6.m1.2.2.3.2">italic-ϕ</ci><cn id="A4.p3.6.m1.1.1.1.1.cmml" type="integer" xref="A4.p3.6.m1.1.1.1.1">1</cn></apply><apply id="A4.p3.6.m1.2.2.1.1.1.cmml" xref="A4.p3.6.m1.2.2.1.1"><csymbol cd="ambiguous" id="A4.p3.6.m1.2.2.1.1.1.1.cmml" xref="A4.p3.6.m1.2.2.1.1">subscript</csymbol><ci id="A4.p3.6.m1.2.2.1.1.1.2.cmml" xref="A4.p3.6.m1.2.2.1.1.1.2">𝑣</ci><ci id="A4.p3.6.m1.2.2.1.1.1.3.cmml" xref="A4.p3.6.m1.2.2.1.1.1.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.p3.6.m1.2c">\phi^{(1)}(v_{i})</annotation><annotation encoding="application/x-llamapun" id="A4.p3.6.m1.2d">italic_ϕ start_POSTSUPERSCRIPT ( 1 ) end_POSTSUPERSCRIPT ( italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT )</annotation></semantics></math> is only nonzero at nodes visited by the ensemble of walkers beginning at <math alttext="v_{i}" class="ltx_Math" display="inline" id="A4.p3.7.m2.1"><semantics id="A4.p3.7.m2.1a"><msub id="A4.p3.7.m2.1.1" xref="A4.p3.7.m2.1.1.cmml"><mi id="A4.p3.7.m2.1.1.2" xref="A4.p3.7.m2.1.1.2.cmml">v</mi><mi id="A4.p3.7.m2.1.1.3" xref="A4.p3.7.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A4.p3.7.m2.1b"><apply id="A4.p3.7.m2.1.1.cmml" xref="A4.p3.7.m2.1.1"><csymbol cd="ambiguous" id="A4.p3.7.m2.1.1.1.cmml" xref="A4.p3.7.m2.1.1">subscript</csymbol><ci id="A4.p3.7.m2.1.1.2.cmml" xref="A4.p3.7.m2.1.1.2">𝑣</ci><ci id="A4.p3.7.m2.1.1.3.cmml" xref="A4.p3.7.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.p3.7.m2.1c">v_{i}</annotation><annotation encoding="application/x-llamapun" id="A4.p3.7.m2.1d">italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>.
This makes masked attention straightforward to efficiently compute, obviating the outer products and vectorisation.
Simply,</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equation ltx_eqn_table" id="A4.E25">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="(\mathbf{A}\odot\widehat{\mathbf{M}}_{\alpha}(\mathcal{G}))\mathbf{V}=(\mathbf%
{A}\odot\mathbf{\Phi}_{\mathcal{G}}^{(1)})\mathbf{V}=\left[\sum_{j=1}^{N}%
\mathbf{A}_{ij}\phi^{(1)}_{\mathcal{G}}(v_{i})_{j}\bm{v}_{j}\right]_{i=1}^{N}" class="ltx_Math" display="block" id="A4.E25.m1.6"><semantics id="A4.E25.m1.6a"><mrow id="A4.E25.m1.6.6" xref="A4.E25.m1.6.6.cmml"><mrow id="A4.E25.m1.4.4.1" xref="A4.E25.m1.4.4.1.cmml"><mrow id="A4.E25.m1.4.4.1.1.1" xref="A4.E25.m1.4.4.1.1.1.1.cmml"><mo id="A4.E25.m1.4.4.1.1.1.2" stretchy="false" xref="A4.E25.m1.4.4.1.1.1.1.cmml">(</mo><mrow id="A4.E25.m1.4.4.1.1.1.1" xref="A4.E25.m1.4.4.1.1.1.1.cmml"><mrow id="A4.E25.m1.4.4.1.1.1.1.2" xref="A4.E25.m1.4.4.1.1.1.1.2.cmml"><mi id="A4.E25.m1.4.4.1.1.1.1.2.2" xref="A4.E25.m1.4.4.1.1.1.1.2.2.cmml">𝐀</mi><mo id="A4.E25.m1.4.4.1.1.1.1.2.1" lspace="0.222em" rspace="0.222em" xref="A4.E25.m1.4.4.1.1.1.1.2.1.cmml">⊙</mo><msub id="A4.E25.m1.4.4.1.1.1.1.2.3" xref="A4.E25.m1.4.4.1.1.1.1.2.3.cmml"><mover accent="true" id="A4.E25.m1.4.4.1.1.1.1.2.3.2" xref="A4.E25.m1.4.4.1.1.1.1.2.3.2.cmml"><mi id="A4.E25.m1.4.4.1.1.1.1.2.3.2.2" xref="A4.E25.m1.4.4.1.1.1.1.2.3.2.2.cmml">𝐌</mi><mo id="A4.E25.m1.4.4.1.1.1.1.2.3.2.1" xref="A4.E25.m1.4.4.1.1.1.1.2.3.2.1.cmml">^</mo></mover><mi id="A4.E25.m1.4.4.1.1.1.1.2.3.3" xref="A4.E25.m1.4.4.1.1.1.1.2.3.3.cmml">α</mi></msub></mrow><mo id="A4.E25.m1.4.4.1.1.1.1.1" xref="A4.E25.m1.4.4.1.1.1.1.1.cmml">⁢</mo><mrow id="A4.E25.m1.4.4.1.1.1.1.3.2" xref="A4.E25.m1.4.4.1.1.1.1.cmml"><mo id="A4.E25.m1.4.4.1.1.1.1.3.2.1" stretchy="false" xref="A4.E25.m1.4.4.1.1.1.1.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="A4.E25.m1.3.3" xref="A4.E25.m1.3.3.cmml">𝒢</mi><mo id="A4.E25.m1.4.4.1.1.1.1.3.2.2" stretchy="false" xref="A4.E25.m1.4.4.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A4.E25.m1.4.4.1.1.1.3" stretchy="false" xref="A4.E25.m1.4.4.1.1.1.1.cmml">)</mo></mrow><mo id="A4.E25.m1.4.4.1.2" xref="A4.E25.m1.4.4.1.2.cmml">⁢</mo><mi id="A4.E25.m1.4.4.1.3" xref="A4.E25.m1.4.4.1.3.cmml">𝐕</mi></mrow><mo id="A4.E25.m1.6.6.5" xref="A4.E25.m1.6.6.5.cmml">=</mo><mrow id="A4.E25.m1.5.5.2" xref="A4.E25.m1.5.5.2.cmml"><mrow id="A4.E25.m1.5.5.2.1.1" xref="A4.E25.m1.5.5.2.1.1.1.cmml"><mo id="A4.E25.m1.5.5.2.1.1.2" stretchy="false" xref="A4.E25.m1.5.5.2.1.1.1.cmml">(</mo><mrow id="A4.E25.m1.5.5.2.1.1.1" xref="A4.E25.m1.5.5.2.1.1.1.cmml"><mi id="A4.E25.m1.5.5.2.1.1.1.2" xref="A4.E25.m1.5.5.2.1.1.1.2.cmml">𝐀</mi><mo id="A4.E25.m1.5.5.2.1.1.1.1" lspace="0.222em" rspace="0.222em" xref="A4.E25.m1.5.5.2.1.1.1.1.cmml">⊙</mo><msubsup id="A4.E25.m1.5.5.2.1.1.1.3" xref="A4.E25.m1.5.5.2.1.1.1.3.cmml"><mi id="A4.E25.m1.5.5.2.1.1.1.3.2.2" xref="A4.E25.m1.5.5.2.1.1.1.3.2.2.cmml">𝚽</mi><mi class="ltx_font_mathcaligraphic" id="A4.E25.m1.5.5.2.1.1.1.3.2.3" xref="A4.E25.m1.5.5.2.1.1.1.3.2.3.cmml">𝒢</mi><mrow id="A4.E25.m1.1.1.1.3" xref="A4.E25.m1.5.5.2.1.1.1.3.cmml"><mo id="A4.E25.m1.1.1.1.3.1" stretchy="false" xref="A4.E25.m1.5.5.2.1.1.1.3.cmml">(</mo><mn id="A4.E25.m1.1.1.1.1" xref="A4.E25.m1.1.1.1.1.cmml">1</mn><mo id="A4.E25.m1.1.1.1.3.2" stretchy="false" xref="A4.E25.m1.5.5.2.1.1.1.3.cmml">)</mo></mrow></msubsup></mrow><mo id="A4.E25.m1.5.5.2.1.1.3" stretchy="false" xref="A4.E25.m1.5.5.2.1.1.1.cmml">)</mo></mrow><mo id="A4.E25.m1.5.5.2.2" xref="A4.E25.m1.5.5.2.2.cmml">⁢</mo><mi id="A4.E25.m1.5.5.2.3" xref="A4.E25.m1.5.5.2.3.cmml">𝐕</mi></mrow><mo id="A4.E25.m1.6.6.6" xref="A4.E25.m1.6.6.6.cmml">=</mo><msubsup id="A4.E25.m1.6.6.3" xref="A4.E25.m1.6.6.3.cmml"><mrow id="A4.E25.m1.6.6.3.1.1.1" xref="A4.E25.m1.6.6.3.1.1.2.cmml"><mo id="A4.E25.m1.6.6.3.1.1.1.2" xref="A4.E25.m1.6.6.3.1.1.2.1.cmml">[</mo><mrow id="A4.E25.m1.6.6.3.1.1.1.1" xref="A4.E25.m1.6.6.3.1.1.1.1.cmml"><munderover id="A4.E25.m1.6.6.3.1.1.1.1.2" xref="A4.E25.m1.6.6.3.1.1.1.1.2.cmml"><mo id="A4.E25.m1.6.6.3.1.1.1.1.2.2.2" lspace="0em" movablelimits="false" xref="A4.E25.m1.6.6.3.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="A4.E25.m1.6.6.3.1.1.1.1.2.2.3" xref="A4.E25.m1.6.6.3.1.1.1.1.2.2.3.cmml"><mi id="A4.E25.m1.6.6.3.1.1.1.1.2.2.3.2" xref="A4.E25.m1.6.6.3.1.1.1.1.2.2.3.2.cmml">j</mi><mo id="A4.E25.m1.6.6.3.1.1.1.1.2.2.3.1" xref="A4.E25.m1.6.6.3.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="A4.E25.m1.6.6.3.1.1.1.1.2.2.3.3" xref="A4.E25.m1.6.6.3.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="A4.E25.m1.6.6.3.1.1.1.1.2.3" xref="A4.E25.m1.6.6.3.1.1.1.1.2.3.cmml">N</mi></munderover><mrow id="A4.E25.m1.6.6.3.1.1.1.1.1" xref="A4.E25.m1.6.6.3.1.1.1.1.1.cmml"><msub id="A4.E25.m1.6.6.3.1.1.1.1.1.3" xref="A4.E25.m1.6.6.3.1.1.1.1.1.3.cmml"><mi id="A4.E25.m1.6.6.3.1.1.1.1.1.3.2" xref="A4.E25.m1.6.6.3.1.1.1.1.1.3.2.cmml">𝐀</mi><mrow id="A4.E25.m1.6.6.3.1.1.1.1.1.3.3" xref="A4.E25.m1.6.6.3.1.1.1.1.1.3.3.cmml"><mi id="A4.E25.m1.6.6.3.1.1.1.1.1.3.3.2" xref="A4.E25.m1.6.6.3.1.1.1.1.1.3.3.2.cmml">i</mi><mo id="A4.E25.m1.6.6.3.1.1.1.1.1.3.3.1" xref="A4.E25.m1.6.6.3.1.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="A4.E25.m1.6.6.3.1.1.1.1.1.3.3.3" xref="A4.E25.m1.6.6.3.1.1.1.1.1.3.3.3.cmml">j</mi></mrow></msub><mo id="A4.E25.m1.6.6.3.1.1.1.1.1.2" xref="A4.E25.m1.6.6.3.1.1.1.1.1.2.cmml">⁢</mo><msubsup id="A4.E25.m1.6.6.3.1.1.1.1.1.4" xref="A4.E25.m1.6.6.3.1.1.1.1.1.4.cmml"><mi id="A4.E25.m1.6.6.3.1.1.1.1.1.4.2.2" xref="A4.E25.m1.6.6.3.1.1.1.1.1.4.2.2.cmml">ϕ</mi><mi class="ltx_font_mathcaligraphic" id="A4.E25.m1.6.6.3.1.1.1.1.1.4.3" xref="A4.E25.m1.6.6.3.1.1.1.1.1.4.3.cmml">𝒢</mi><mrow id="A4.E25.m1.2.2.1.3" xref="A4.E25.m1.6.6.3.1.1.1.1.1.4.cmml"><mo id="A4.E25.m1.2.2.1.3.1" stretchy="false" xref="A4.E25.m1.6.6.3.1.1.1.1.1.4.cmml">(</mo><mn id="A4.E25.m1.2.2.1.1" xref="A4.E25.m1.2.2.1.1.cmml">1</mn><mo id="A4.E25.m1.2.2.1.3.2" stretchy="false" xref="A4.E25.m1.6.6.3.1.1.1.1.1.4.cmml">)</mo></mrow></msubsup><mo id="A4.E25.m1.6.6.3.1.1.1.1.1.2a" xref="A4.E25.m1.6.6.3.1.1.1.1.1.2.cmml">⁢</mo><msub id="A4.E25.m1.6.6.3.1.1.1.1.1.1" xref="A4.E25.m1.6.6.3.1.1.1.1.1.1.cmml"><mrow id="A4.E25.m1.6.6.3.1.1.1.1.1.1.1.1" xref="A4.E25.m1.6.6.3.1.1.1.1.1.1.1.1.1.cmml"><mo id="A4.E25.m1.6.6.3.1.1.1.1.1.1.1.1.2" stretchy="false" xref="A4.E25.m1.6.6.3.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="A4.E25.m1.6.6.3.1.1.1.1.1.1.1.1.1" xref="A4.E25.m1.6.6.3.1.1.1.1.1.1.1.1.1.cmml"><mi id="A4.E25.m1.6.6.3.1.1.1.1.1.1.1.1.1.2" xref="A4.E25.m1.6.6.3.1.1.1.1.1.1.1.1.1.2.cmml">v</mi><mi id="A4.E25.m1.6.6.3.1.1.1.1.1.1.1.1.1.3" xref="A4.E25.m1.6.6.3.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="A4.E25.m1.6.6.3.1.1.1.1.1.1.1.1.3" stretchy="false" xref="A4.E25.m1.6.6.3.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mi id="A4.E25.m1.6.6.3.1.1.1.1.1.1.3" xref="A4.E25.m1.6.6.3.1.1.1.1.1.1.3.cmml">j</mi></msub><mo id="A4.E25.m1.6.6.3.1.1.1.1.1.2b" xref="A4.E25.m1.6.6.3.1.1.1.1.1.2.cmml">⁢</mo><msub id="A4.E25.m1.6.6.3.1.1.1.1.1.5" xref="A4.E25.m1.6.6.3.1.1.1.1.1.5.cmml"><mi id="A4.E25.m1.6.6.3.1.1.1.1.1.5.2" xref="A4.E25.m1.6.6.3.1.1.1.1.1.5.2.cmml">𝒗</mi><mi id="A4.E25.m1.6.6.3.1.1.1.1.1.5.3" xref="A4.E25.m1.6.6.3.1.1.1.1.1.5.3.cmml">j</mi></msub></mrow></mrow><mo id="A4.E25.m1.6.6.3.1.1.1.3" xref="A4.E25.m1.6.6.3.1.1.2.1.cmml">]</mo></mrow><mrow id="A4.E25.m1.6.6.3.1.3" xref="A4.E25.m1.6.6.3.1.3.cmml"><mi id="A4.E25.m1.6.6.3.1.3.2" xref="A4.E25.m1.6.6.3.1.3.2.cmml">i</mi><mo id="A4.E25.m1.6.6.3.1.3.1" xref="A4.E25.m1.6.6.3.1.3.1.cmml">=</mo><mn id="A4.E25.m1.6.6.3.1.3.3" xref="A4.E25.m1.6.6.3.1.3.3.cmml">1</mn></mrow><mi id="A4.E25.m1.6.6.3.3" xref="A4.E25.m1.6.6.3.3.cmml">N</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="A4.E25.m1.6b"><apply id="A4.E25.m1.6.6.cmml" xref="A4.E25.m1.6.6"><and id="A4.E25.m1.6.6a.cmml" xref="A4.E25.m1.6.6"></and><apply id="A4.E25.m1.6.6b.cmml" xref="A4.E25.m1.6.6"><eq id="A4.E25.m1.6.6.5.cmml" xref="A4.E25.m1.6.6.5"></eq><apply id="A4.E25.m1.4.4.1.cmml" xref="A4.E25.m1.4.4.1"><times id="A4.E25.m1.4.4.1.2.cmml" xref="A4.E25.m1.4.4.1.2"></times><apply id="A4.E25.m1.4.4.1.1.1.1.cmml" xref="A4.E25.m1.4.4.1.1.1"><times id="A4.E25.m1.4.4.1.1.1.1.1.cmml" xref="A4.E25.m1.4.4.1.1.1.1.1"></times><apply id="A4.E25.m1.4.4.1.1.1.1.2.cmml" xref="A4.E25.m1.4.4.1.1.1.1.2"><csymbol cd="latexml" id="A4.E25.m1.4.4.1.1.1.1.2.1.cmml" xref="A4.E25.m1.4.4.1.1.1.1.2.1">direct-product</csymbol><ci id="A4.E25.m1.4.4.1.1.1.1.2.2.cmml" xref="A4.E25.m1.4.4.1.1.1.1.2.2">𝐀</ci><apply id="A4.E25.m1.4.4.1.1.1.1.2.3.cmml" xref="A4.E25.m1.4.4.1.1.1.1.2.3"><csymbol cd="ambiguous" id="A4.E25.m1.4.4.1.1.1.1.2.3.1.cmml" xref="A4.E25.m1.4.4.1.1.1.1.2.3">subscript</csymbol><apply id="A4.E25.m1.4.4.1.1.1.1.2.3.2.cmml" xref="A4.E25.m1.4.4.1.1.1.1.2.3.2"><ci id="A4.E25.m1.4.4.1.1.1.1.2.3.2.1.cmml" xref="A4.E25.m1.4.4.1.1.1.1.2.3.2.1">^</ci><ci id="A4.E25.m1.4.4.1.1.1.1.2.3.2.2.cmml" xref="A4.E25.m1.4.4.1.1.1.1.2.3.2.2">𝐌</ci></apply><ci id="A4.E25.m1.4.4.1.1.1.1.2.3.3.cmml" xref="A4.E25.m1.4.4.1.1.1.1.2.3.3">𝛼</ci></apply></apply><ci id="A4.E25.m1.3.3.cmml" xref="A4.E25.m1.3.3">𝒢</ci></apply><ci id="A4.E25.m1.4.4.1.3.cmml" xref="A4.E25.m1.4.4.1.3">𝐕</ci></apply><apply id="A4.E25.m1.5.5.2.cmml" xref="A4.E25.m1.5.5.2"><times id="A4.E25.m1.5.5.2.2.cmml" xref="A4.E25.m1.5.5.2.2"></times><apply id="A4.E25.m1.5.5.2.1.1.1.cmml" xref="A4.E25.m1.5.5.2.1.1"><csymbol cd="latexml" id="A4.E25.m1.5.5.2.1.1.1.1.cmml" xref="A4.E25.m1.5.5.2.1.1.1.1">direct-product</csymbol><ci id="A4.E25.m1.5.5.2.1.1.1.2.cmml" xref="A4.E25.m1.5.5.2.1.1.1.2">𝐀</ci><apply id="A4.E25.m1.5.5.2.1.1.1.3.cmml" xref="A4.E25.m1.5.5.2.1.1.1.3"><csymbol cd="ambiguous" id="A4.E25.m1.5.5.2.1.1.1.3.1.cmml" xref="A4.E25.m1.5.5.2.1.1.1.3">superscript</csymbol><apply id="A4.E25.m1.5.5.2.1.1.1.3.2.cmml" xref="A4.E25.m1.5.5.2.1.1.1.3"><csymbol cd="ambiguous" id="A4.E25.m1.5.5.2.1.1.1.3.2.1.cmml" xref="A4.E25.m1.5.5.2.1.1.1.3">subscript</csymbol><ci id="A4.E25.m1.5.5.2.1.1.1.3.2.2.cmml" xref="A4.E25.m1.5.5.2.1.1.1.3.2.2">𝚽</ci><ci id="A4.E25.m1.5.5.2.1.1.1.3.2.3.cmml" xref="A4.E25.m1.5.5.2.1.1.1.3.2.3">𝒢</ci></apply><cn id="A4.E25.m1.1.1.1.1.cmml" type="integer" xref="A4.E25.m1.1.1.1.1">1</cn></apply></apply><ci id="A4.E25.m1.5.5.2.3.cmml" xref="A4.E25.m1.5.5.2.3">𝐕</ci></apply></apply><apply id="A4.E25.m1.6.6c.cmml" xref="A4.E25.m1.6.6"><eq id="A4.E25.m1.6.6.6.cmml" xref="A4.E25.m1.6.6.6"></eq><share href="https://arxiv.org/html/2410.03462v1#A4.E25.m1.5.5.2.cmml" id="A4.E25.m1.6.6d.cmml" xref="A4.E25.m1.6.6"></share><apply id="A4.E25.m1.6.6.3.cmml" xref="A4.E25.m1.6.6.3"><csymbol cd="ambiguous" id="A4.E25.m1.6.6.3.2.cmml" xref="A4.E25.m1.6.6.3">superscript</csymbol><apply id="A4.E25.m1.6.6.3.1.cmml" xref="A4.E25.m1.6.6.3"><csymbol cd="ambiguous" id="A4.E25.m1.6.6.3.1.2.cmml" xref="A4.E25.m1.6.6.3">subscript</csymbol><apply id="A4.E25.m1.6.6.3.1.1.2.cmml" xref="A4.E25.m1.6.6.3.1.1.1"><csymbol cd="latexml" id="A4.E25.m1.6.6.3.1.1.2.1.cmml" xref="A4.E25.m1.6.6.3.1.1.1.2">delimited-[]</csymbol><apply id="A4.E25.m1.6.6.3.1.1.1.1.cmml" xref="A4.E25.m1.6.6.3.1.1.1.1"><apply id="A4.E25.m1.6.6.3.1.1.1.1.2.cmml" xref="A4.E25.m1.6.6.3.1.1.1.1.2"><csymbol cd="ambiguous" id="A4.E25.m1.6.6.3.1.1.1.1.2.1.cmml" xref="A4.E25.m1.6.6.3.1.1.1.1.2">superscript</csymbol><apply id="A4.E25.m1.6.6.3.1.1.1.1.2.2.cmml" xref="A4.E25.m1.6.6.3.1.1.1.1.2"><csymbol cd="ambiguous" id="A4.E25.m1.6.6.3.1.1.1.1.2.2.1.cmml" xref="A4.E25.m1.6.6.3.1.1.1.1.2">subscript</csymbol><sum id="A4.E25.m1.6.6.3.1.1.1.1.2.2.2.cmml" xref="A4.E25.m1.6.6.3.1.1.1.1.2.2.2"></sum><apply id="A4.E25.m1.6.6.3.1.1.1.1.2.2.3.cmml" xref="A4.E25.m1.6.6.3.1.1.1.1.2.2.3"><eq id="A4.E25.m1.6.6.3.1.1.1.1.2.2.3.1.cmml" xref="A4.E25.m1.6.6.3.1.1.1.1.2.2.3.1"></eq><ci id="A4.E25.m1.6.6.3.1.1.1.1.2.2.3.2.cmml" xref="A4.E25.m1.6.6.3.1.1.1.1.2.2.3.2">𝑗</ci><cn id="A4.E25.m1.6.6.3.1.1.1.1.2.2.3.3.cmml" type="integer" xref="A4.E25.m1.6.6.3.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="A4.E25.m1.6.6.3.1.1.1.1.2.3.cmml" xref="A4.E25.m1.6.6.3.1.1.1.1.2.3">𝑁</ci></apply><apply id="A4.E25.m1.6.6.3.1.1.1.1.1.cmml" xref="A4.E25.m1.6.6.3.1.1.1.1.1"><times id="A4.E25.m1.6.6.3.1.1.1.1.1.2.cmml" xref="A4.E25.m1.6.6.3.1.1.1.1.1.2"></times><apply id="A4.E25.m1.6.6.3.1.1.1.1.1.3.cmml" xref="A4.E25.m1.6.6.3.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A4.E25.m1.6.6.3.1.1.1.1.1.3.1.cmml" xref="A4.E25.m1.6.6.3.1.1.1.1.1.3">subscript</csymbol><ci id="A4.E25.m1.6.6.3.1.1.1.1.1.3.2.cmml" xref="A4.E25.m1.6.6.3.1.1.1.1.1.3.2">𝐀</ci><apply id="A4.E25.m1.6.6.3.1.1.1.1.1.3.3.cmml" xref="A4.E25.m1.6.6.3.1.1.1.1.1.3.3"><times id="A4.E25.m1.6.6.3.1.1.1.1.1.3.3.1.cmml" xref="A4.E25.m1.6.6.3.1.1.1.1.1.3.3.1"></times><ci id="A4.E25.m1.6.6.3.1.1.1.1.1.3.3.2.cmml" xref="A4.E25.m1.6.6.3.1.1.1.1.1.3.3.2">𝑖</ci><ci id="A4.E25.m1.6.6.3.1.1.1.1.1.3.3.3.cmml" xref="A4.E25.m1.6.6.3.1.1.1.1.1.3.3.3">𝑗</ci></apply></apply><apply id="A4.E25.m1.6.6.3.1.1.1.1.1.4.cmml" xref="A4.E25.m1.6.6.3.1.1.1.1.1.4"><csymbol cd="ambiguous" id="A4.E25.m1.6.6.3.1.1.1.1.1.4.1.cmml" xref="A4.E25.m1.6.6.3.1.1.1.1.1.4">subscript</csymbol><apply id="A4.E25.m1.6.6.3.1.1.1.1.1.4.2.cmml" xref="A4.E25.m1.6.6.3.1.1.1.1.1.4"><csymbol cd="ambiguous" id="A4.E25.m1.6.6.3.1.1.1.1.1.4.2.1.cmml" xref="A4.E25.m1.6.6.3.1.1.1.1.1.4">superscript</csymbol><ci id="A4.E25.m1.6.6.3.1.1.1.1.1.4.2.2.cmml" xref="A4.E25.m1.6.6.3.1.1.1.1.1.4.2.2">italic-ϕ</ci><cn id="A4.E25.m1.2.2.1.1.cmml" type="integer" xref="A4.E25.m1.2.2.1.1">1</cn></apply><ci id="A4.E25.m1.6.6.3.1.1.1.1.1.4.3.cmml" xref="A4.E25.m1.6.6.3.1.1.1.1.1.4.3">𝒢</ci></apply><apply id="A4.E25.m1.6.6.3.1.1.1.1.1.1.cmml" xref="A4.E25.m1.6.6.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A4.E25.m1.6.6.3.1.1.1.1.1.1.2.cmml" xref="A4.E25.m1.6.6.3.1.1.1.1.1.1">subscript</csymbol><apply id="A4.E25.m1.6.6.3.1.1.1.1.1.1.1.1.1.cmml" xref="A4.E25.m1.6.6.3.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A4.E25.m1.6.6.3.1.1.1.1.1.1.1.1.1.1.cmml" xref="A4.E25.m1.6.6.3.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="A4.E25.m1.6.6.3.1.1.1.1.1.1.1.1.1.2.cmml" xref="A4.E25.m1.6.6.3.1.1.1.1.1.1.1.1.1.2">𝑣</ci><ci id="A4.E25.m1.6.6.3.1.1.1.1.1.1.1.1.1.3.cmml" xref="A4.E25.m1.6.6.3.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><ci id="A4.E25.m1.6.6.3.1.1.1.1.1.1.3.cmml" xref="A4.E25.m1.6.6.3.1.1.1.1.1.1.3">𝑗</ci></apply><apply id="A4.E25.m1.6.6.3.1.1.1.1.1.5.cmml" xref="A4.E25.m1.6.6.3.1.1.1.1.1.5"><csymbol cd="ambiguous" id="A4.E25.m1.6.6.3.1.1.1.1.1.5.1.cmml" xref="A4.E25.m1.6.6.3.1.1.1.1.1.5">subscript</csymbol><ci id="A4.E25.m1.6.6.3.1.1.1.1.1.5.2.cmml" xref="A4.E25.m1.6.6.3.1.1.1.1.1.5.2">𝒗</ci><ci id="A4.E25.m1.6.6.3.1.1.1.1.1.5.3.cmml" xref="A4.E25.m1.6.6.3.1.1.1.1.1.5.3">𝑗</ci></apply></apply></apply></apply><apply id="A4.E25.m1.6.6.3.1.3.cmml" xref="A4.E25.m1.6.6.3.1.3"><eq id="A4.E25.m1.6.6.3.1.3.1.cmml" xref="A4.E25.m1.6.6.3.1.3.1"></eq><ci id="A4.E25.m1.6.6.3.1.3.2.cmml" xref="A4.E25.m1.6.6.3.1.3.2">𝑖</ci><cn id="A4.E25.m1.6.6.3.1.3.3.cmml" type="integer" xref="A4.E25.m1.6.6.3.1.3.3">1</cn></apply></apply><ci id="A4.E25.m1.6.6.3.3.cmml" xref="A4.E25.m1.6.6.3.3">𝑁</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.E25.m1.6c">(\mathbf{A}\odot\widehat{\mathbf{M}}_{\alpha}(\mathcal{G}))\mathbf{V}=(\mathbf%
{A}\odot\mathbf{\Phi}_{\mathcal{G}}^{(1)})\mathbf{V}=\left[\sum_{j=1}^{N}%
\mathbf{A}_{ij}\phi^{(1)}_{\mathcal{G}}(v_{i})_{j}\bm{v}_{j}\right]_{i=1}^{N}</annotation><annotation encoding="application/x-llamapun" id="A4.E25.m1.6d">( bold_A ⊙ over^ start_ARG bold_M end_ARG start_POSTSUBSCRIPT italic_α end_POSTSUBSCRIPT ( caligraphic_G ) ) bold_V = ( bold_A ⊙ bold_Φ start_POSTSUBSCRIPT caligraphic_G end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( 1 ) end_POSTSUPERSCRIPT ) bold_V = [ ∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT bold_A start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT italic_ϕ start_POSTSUPERSCRIPT ( 1 ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT caligraphic_G end_POSTSUBSCRIPT ( italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT bold_italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ] start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(25)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A4.p3.13">where <math alttext="\mathbf{A}_{ij}=\exp(\bm{q}_{i}^{\top}\bm{k}_{j})" class="ltx_Math" display="inline" id="A4.p3.8.m1.2"><semantics id="A4.p3.8.m1.2a"><mrow id="A4.p3.8.m1.2.2" xref="A4.p3.8.m1.2.2.cmml"><msub id="A4.p3.8.m1.2.2.3" xref="A4.p3.8.m1.2.2.3.cmml"><mi id="A4.p3.8.m1.2.2.3.2" xref="A4.p3.8.m1.2.2.3.2.cmml">𝐀</mi><mrow id="A4.p3.8.m1.2.2.3.3" xref="A4.p3.8.m1.2.2.3.3.cmml"><mi id="A4.p3.8.m1.2.2.3.3.2" xref="A4.p3.8.m1.2.2.3.3.2.cmml">i</mi><mo id="A4.p3.8.m1.2.2.3.3.1" xref="A4.p3.8.m1.2.2.3.3.1.cmml">⁢</mo><mi id="A4.p3.8.m1.2.2.3.3.3" xref="A4.p3.8.m1.2.2.3.3.3.cmml">j</mi></mrow></msub><mo id="A4.p3.8.m1.2.2.2" xref="A4.p3.8.m1.2.2.2.cmml">=</mo><mrow id="A4.p3.8.m1.2.2.1.1" xref="A4.p3.8.m1.2.2.1.2.cmml"><mi id="A4.p3.8.m1.1.1" xref="A4.p3.8.m1.1.1.cmml">exp</mi><mo id="A4.p3.8.m1.2.2.1.1a" xref="A4.p3.8.m1.2.2.1.2.cmml">⁡</mo><mrow id="A4.p3.8.m1.2.2.1.1.1" xref="A4.p3.8.m1.2.2.1.2.cmml"><mo id="A4.p3.8.m1.2.2.1.1.1.2" stretchy="false" xref="A4.p3.8.m1.2.2.1.2.cmml">(</mo><mrow id="A4.p3.8.m1.2.2.1.1.1.1" xref="A4.p3.8.m1.2.2.1.1.1.1.cmml"><msubsup id="A4.p3.8.m1.2.2.1.1.1.1.2" xref="A4.p3.8.m1.2.2.1.1.1.1.2.cmml"><mi id="A4.p3.8.m1.2.2.1.1.1.1.2.2.2" xref="A4.p3.8.m1.2.2.1.1.1.1.2.2.2.cmml">𝒒</mi><mi id="A4.p3.8.m1.2.2.1.1.1.1.2.2.3" xref="A4.p3.8.m1.2.2.1.1.1.1.2.2.3.cmml">i</mi><mo id="A4.p3.8.m1.2.2.1.1.1.1.2.3" xref="A4.p3.8.m1.2.2.1.1.1.1.2.3.cmml">⊤</mo></msubsup><mo id="A4.p3.8.m1.2.2.1.1.1.1.1" xref="A4.p3.8.m1.2.2.1.1.1.1.1.cmml">⁢</mo><msub id="A4.p3.8.m1.2.2.1.1.1.1.3" xref="A4.p3.8.m1.2.2.1.1.1.1.3.cmml"><mi id="A4.p3.8.m1.2.2.1.1.1.1.3.2" xref="A4.p3.8.m1.2.2.1.1.1.1.3.2.cmml">𝒌</mi><mi id="A4.p3.8.m1.2.2.1.1.1.1.3.3" xref="A4.p3.8.m1.2.2.1.1.1.1.3.3.cmml">j</mi></msub></mrow><mo id="A4.p3.8.m1.2.2.1.1.1.3" stretchy="false" xref="A4.p3.8.m1.2.2.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A4.p3.8.m1.2b"><apply id="A4.p3.8.m1.2.2.cmml" xref="A4.p3.8.m1.2.2"><eq id="A4.p3.8.m1.2.2.2.cmml" xref="A4.p3.8.m1.2.2.2"></eq><apply id="A4.p3.8.m1.2.2.3.cmml" xref="A4.p3.8.m1.2.2.3"><csymbol cd="ambiguous" id="A4.p3.8.m1.2.2.3.1.cmml" xref="A4.p3.8.m1.2.2.3">subscript</csymbol><ci id="A4.p3.8.m1.2.2.3.2.cmml" xref="A4.p3.8.m1.2.2.3.2">𝐀</ci><apply id="A4.p3.8.m1.2.2.3.3.cmml" xref="A4.p3.8.m1.2.2.3.3"><times id="A4.p3.8.m1.2.2.3.3.1.cmml" xref="A4.p3.8.m1.2.2.3.3.1"></times><ci id="A4.p3.8.m1.2.2.3.3.2.cmml" xref="A4.p3.8.m1.2.2.3.3.2">𝑖</ci><ci id="A4.p3.8.m1.2.2.3.3.3.cmml" xref="A4.p3.8.m1.2.2.3.3.3">𝑗</ci></apply></apply><apply id="A4.p3.8.m1.2.2.1.2.cmml" xref="A4.p3.8.m1.2.2.1.1"><exp id="A4.p3.8.m1.1.1.cmml" xref="A4.p3.8.m1.1.1"></exp><apply id="A4.p3.8.m1.2.2.1.1.1.1.cmml" xref="A4.p3.8.m1.2.2.1.1.1.1"><times id="A4.p3.8.m1.2.2.1.1.1.1.1.cmml" xref="A4.p3.8.m1.2.2.1.1.1.1.1"></times><apply id="A4.p3.8.m1.2.2.1.1.1.1.2.cmml" xref="A4.p3.8.m1.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="A4.p3.8.m1.2.2.1.1.1.1.2.1.cmml" xref="A4.p3.8.m1.2.2.1.1.1.1.2">superscript</csymbol><apply id="A4.p3.8.m1.2.2.1.1.1.1.2.2.cmml" xref="A4.p3.8.m1.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="A4.p3.8.m1.2.2.1.1.1.1.2.2.1.cmml" xref="A4.p3.8.m1.2.2.1.1.1.1.2">subscript</csymbol><ci id="A4.p3.8.m1.2.2.1.1.1.1.2.2.2.cmml" xref="A4.p3.8.m1.2.2.1.1.1.1.2.2.2">𝒒</ci><ci id="A4.p3.8.m1.2.2.1.1.1.1.2.2.3.cmml" xref="A4.p3.8.m1.2.2.1.1.1.1.2.2.3">𝑖</ci></apply><csymbol cd="latexml" id="A4.p3.8.m1.2.2.1.1.1.1.2.3.cmml" xref="A4.p3.8.m1.2.2.1.1.1.1.2.3">top</csymbol></apply><apply id="A4.p3.8.m1.2.2.1.1.1.1.3.cmml" xref="A4.p3.8.m1.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="A4.p3.8.m1.2.2.1.1.1.1.3.1.cmml" xref="A4.p3.8.m1.2.2.1.1.1.1.3">subscript</csymbol><ci id="A4.p3.8.m1.2.2.1.1.1.1.3.2.cmml" xref="A4.p3.8.m1.2.2.1.1.1.1.3.2">𝒌</ci><ci id="A4.p3.8.m1.2.2.1.1.1.1.3.3.cmml" xref="A4.p3.8.m1.2.2.1.1.1.1.3.3">𝑗</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.p3.8.m1.2c">\mathbf{A}_{ij}=\exp(\bm{q}_{i}^{\top}\bm{k}_{j})</annotation><annotation encoding="application/x-llamapun" id="A4.p3.8.m1.2d">bold_A start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT = roman_exp ( bold_italic_q start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT bold_italic_k start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT )</annotation></semantics></math> (softmax) or <math alttext="\mathbf{A}_{ij}=\bm{q}_{i}^{\top}\bm{k}_{j}" class="ltx_Math" display="inline" id="A4.p3.9.m2.1"><semantics id="A4.p3.9.m2.1a"><mrow id="A4.p3.9.m2.1.1" xref="A4.p3.9.m2.1.1.cmml"><msub id="A4.p3.9.m2.1.1.2" xref="A4.p3.9.m2.1.1.2.cmml"><mi id="A4.p3.9.m2.1.1.2.2" xref="A4.p3.9.m2.1.1.2.2.cmml">𝐀</mi><mrow id="A4.p3.9.m2.1.1.2.3" xref="A4.p3.9.m2.1.1.2.3.cmml"><mi id="A4.p3.9.m2.1.1.2.3.2" xref="A4.p3.9.m2.1.1.2.3.2.cmml">i</mi><mo id="A4.p3.9.m2.1.1.2.3.1" xref="A4.p3.9.m2.1.1.2.3.1.cmml">⁢</mo><mi id="A4.p3.9.m2.1.1.2.3.3" xref="A4.p3.9.m2.1.1.2.3.3.cmml">j</mi></mrow></msub><mo id="A4.p3.9.m2.1.1.1" xref="A4.p3.9.m2.1.1.1.cmml">=</mo><mrow id="A4.p3.9.m2.1.1.3" xref="A4.p3.9.m2.1.1.3.cmml"><msubsup id="A4.p3.9.m2.1.1.3.2" xref="A4.p3.9.m2.1.1.3.2.cmml"><mi id="A4.p3.9.m2.1.1.3.2.2.2" xref="A4.p3.9.m2.1.1.3.2.2.2.cmml">𝒒</mi><mi id="A4.p3.9.m2.1.1.3.2.2.3" xref="A4.p3.9.m2.1.1.3.2.2.3.cmml">i</mi><mo id="A4.p3.9.m2.1.1.3.2.3" xref="A4.p3.9.m2.1.1.3.2.3.cmml">⊤</mo></msubsup><mo id="A4.p3.9.m2.1.1.3.1" xref="A4.p3.9.m2.1.1.3.1.cmml">⁢</mo><msub id="A4.p3.9.m2.1.1.3.3" xref="A4.p3.9.m2.1.1.3.3.cmml"><mi id="A4.p3.9.m2.1.1.3.3.2" xref="A4.p3.9.m2.1.1.3.3.2.cmml">𝒌</mi><mi id="A4.p3.9.m2.1.1.3.3.3" xref="A4.p3.9.m2.1.1.3.3.3.cmml">j</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="A4.p3.9.m2.1b"><apply id="A4.p3.9.m2.1.1.cmml" xref="A4.p3.9.m2.1.1"><eq id="A4.p3.9.m2.1.1.1.cmml" xref="A4.p3.9.m2.1.1.1"></eq><apply id="A4.p3.9.m2.1.1.2.cmml" xref="A4.p3.9.m2.1.1.2"><csymbol cd="ambiguous" id="A4.p3.9.m2.1.1.2.1.cmml" xref="A4.p3.9.m2.1.1.2">subscript</csymbol><ci id="A4.p3.9.m2.1.1.2.2.cmml" xref="A4.p3.9.m2.1.1.2.2">𝐀</ci><apply id="A4.p3.9.m2.1.1.2.3.cmml" xref="A4.p3.9.m2.1.1.2.3"><times id="A4.p3.9.m2.1.1.2.3.1.cmml" xref="A4.p3.9.m2.1.1.2.3.1"></times><ci id="A4.p3.9.m2.1.1.2.3.2.cmml" xref="A4.p3.9.m2.1.1.2.3.2">𝑖</ci><ci id="A4.p3.9.m2.1.1.2.3.3.cmml" xref="A4.p3.9.m2.1.1.2.3.3">𝑗</ci></apply></apply><apply id="A4.p3.9.m2.1.1.3.cmml" xref="A4.p3.9.m2.1.1.3"><times id="A4.p3.9.m2.1.1.3.1.cmml" xref="A4.p3.9.m2.1.1.3.1"></times><apply id="A4.p3.9.m2.1.1.3.2.cmml" xref="A4.p3.9.m2.1.1.3.2"><csymbol cd="ambiguous" id="A4.p3.9.m2.1.1.3.2.1.cmml" xref="A4.p3.9.m2.1.1.3.2">superscript</csymbol><apply id="A4.p3.9.m2.1.1.3.2.2.cmml" xref="A4.p3.9.m2.1.1.3.2"><csymbol cd="ambiguous" id="A4.p3.9.m2.1.1.3.2.2.1.cmml" xref="A4.p3.9.m2.1.1.3.2">subscript</csymbol><ci id="A4.p3.9.m2.1.1.3.2.2.2.cmml" xref="A4.p3.9.m2.1.1.3.2.2.2">𝒒</ci><ci id="A4.p3.9.m2.1.1.3.2.2.3.cmml" xref="A4.p3.9.m2.1.1.3.2.2.3">𝑖</ci></apply><csymbol cd="latexml" id="A4.p3.9.m2.1.1.3.2.3.cmml" xref="A4.p3.9.m2.1.1.3.2.3">top</csymbol></apply><apply id="A4.p3.9.m2.1.1.3.3.cmml" xref="A4.p3.9.m2.1.1.3.3"><csymbol cd="ambiguous" id="A4.p3.9.m2.1.1.3.3.1.cmml" xref="A4.p3.9.m2.1.1.3.3">subscript</csymbol><ci id="A4.p3.9.m2.1.1.3.3.2.cmml" xref="A4.p3.9.m2.1.1.3.3.2">𝒌</ci><ci id="A4.p3.9.m2.1.1.3.3.3.cmml" xref="A4.p3.9.m2.1.1.3.3.3">𝑗</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.p3.9.m2.1c">\mathbf{A}_{ij}=\bm{q}_{i}^{\top}\bm{k}_{j}</annotation><annotation encoding="application/x-llamapun" id="A4.p3.9.m2.1d">bold_A start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT = bold_italic_q start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT bold_italic_k start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> (linear) and <math alttext="\{\bm{v}_{j}\}_{j=1}^{N}" class="ltx_Math" display="inline" id="A4.p3.10.m3.1"><semantics id="A4.p3.10.m3.1a"><msubsup id="A4.p3.10.m3.1.1" xref="A4.p3.10.m3.1.1.cmml"><mrow id="A4.p3.10.m3.1.1.1.1.1" xref="A4.p3.10.m3.1.1.1.1.2.cmml"><mo id="A4.p3.10.m3.1.1.1.1.1.2" stretchy="false" xref="A4.p3.10.m3.1.1.1.1.2.cmml">{</mo><msub id="A4.p3.10.m3.1.1.1.1.1.1" xref="A4.p3.10.m3.1.1.1.1.1.1.cmml"><mi id="A4.p3.10.m3.1.1.1.1.1.1.2" xref="A4.p3.10.m3.1.1.1.1.1.1.2.cmml">𝒗</mi><mi id="A4.p3.10.m3.1.1.1.1.1.1.3" xref="A4.p3.10.m3.1.1.1.1.1.1.3.cmml">j</mi></msub><mo id="A4.p3.10.m3.1.1.1.1.1.3" stretchy="false" xref="A4.p3.10.m3.1.1.1.1.2.cmml">}</mo></mrow><mrow id="A4.p3.10.m3.1.1.1.3" xref="A4.p3.10.m3.1.1.1.3.cmml"><mi id="A4.p3.10.m3.1.1.1.3.2" xref="A4.p3.10.m3.1.1.1.3.2.cmml">j</mi><mo id="A4.p3.10.m3.1.1.1.3.1" xref="A4.p3.10.m3.1.1.1.3.1.cmml">=</mo><mn id="A4.p3.10.m3.1.1.1.3.3" xref="A4.p3.10.m3.1.1.1.3.3.cmml">1</mn></mrow><mi id="A4.p3.10.m3.1.1.3" xref="A4.p3.10.m3.1.1.3.cmml">N</mi></msubsup><annotation-xml encoding="MathML-Content" id="A4.p3.10.m3.1b"><apply id="A4.p3.10.m3.1.1.cmml" xref="A4.p3.10.m3.1.1"><csymbol cd="ambiguous" id="A4.p3.10.m3.1.1.2.cmml" xref="A4.p3.10.m3.1.1">superscript</csymbol><apply id="A4.p3.10.m3.1.1.1.cmml" xref="A4.p3.10.m3.1.1"><csymbol cd="ambiguous" id="A4.p3.10.m3.1.1.1.2.cmml" xref="A4.p3.10.m3.1.1">subscript</csymbol><set id="A4.p3.10.m3.1.1.1.1.2.cmml" xref="A4.p3.10.m3.1.1.1.1.1"><apply id="A4.p3.10.m3.1.1.1.1.1.1.cmml" xref="A4.p3.10.m3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A4.p3.10.m3.1.1.1.1.1.1.1.cmml" xref="A4.p3.10.m3.1.1.1.1.1.1">subscript</csymbol><ci id="A4.p3.10.m3.1.1.1.1.1.1.2.cmml" xref="A4.p3.10.m3.1.1.1.1.1.1.2">𝒗</ci><ci id="A4.p3.10.m3.1.1.1.1.1.1.3.cmml" xref="A4.p3.10.m3.1.1.1.1.1.1.3">𝑗</ci></apply></set><apply id="A4.p3.10.m3.1.1.1.3.cmml" xref="A4.p3.10.m3.1.1.1.3"><eq id="A4.p3.10.m3.1.1.1.3.1.cmml" xref="A4.p3.10.m3.1.1.1.3.1"></eq><ci id="A4.p3.10.m3.1.1.1.3.2.cmml" xref="A4.p3.10.m3.1.1.1.3.2">𝑗</ci><cn id="A4.p3.10.m3.1.1.1.3.3.cmml" type="integer" xref="A4.p3.10.m3.1.1.1.3.3">1</cn></apply></apply><ci id="A4.p3.10.m3.1.1.3.cmml" xref="A4.p3.10.m3.1.1.3">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.p3.10.m3.1c">\{\bm{v}_{j}\}_{j=1}^{N}</annotation><annotation encoding="application/x-llamapun" id="A4.p3.10.m3.1d">{ bold_italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT } start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT</annotation></semantics></math> are the value vectors.
Since <math alttext="\phi_{\mathcal{G}}^{(1)}(v_{i})" class="ltx_Math" display="inline" id="A4.p3.11.m4.2"><semantics id="A4.p3.11.m4.2a"><mrow id="A4.p3.11.m4.2.2" xref="A4.p3.11.m4.2.2.cmml"><msubsup id="A4.p3.11.m4.2.2.3" xref="A4.p3.11.m4.2.2.3.cmml"><mi id="A4.p3.11.m4.2.2.3.2.2" xref="A4.p3.11.m4.2.2.3.2.2.cmml">ϕ</mi><mi class="ltx_font_mathcaligraphic" id="A4.p3.11.m4.2.2.3.2.3" xref="A4.p3.11.m4.2.2.3.2.3.cmml">𝒢</mi><mrow id="A4.p3.11.m4.1.1.1.3" xref="A4.p3.11.m4.2.2.3.cmml"><mo id="A4.p3.11.m4.1.1.1.3.1" stretchy="false" xref="A4.p3.11.m4.2.2.3.cmml">(</mo><mn id="A4.p3.11.m4.1.1.1.1" xref="A4.p3.11.m4.1.1.1.1.cmml">1</mn><mo id="A4.p3.11.m4.1.1.1.3.2" stretchy="false" xref="A4.p3.11.m4.2.2.3.cmml">)</mo></mrow></msubsup><mo id="A4.p3.11.m4.2.2.2" xref="A4.p3.11.m4.2.2.2.cmml">⁢</mo><mrow id="A4.p3.11.m4.2.2.1.1" xref="A4.p3.11.m4.2.2.1.1.1.cmml"><mo id="A4.p3.11.m4.2.2.1.1.2" stretchy="false" xref="A4.p3.11.m4.2.2.1.1.1.cmml">(</mo><msub id="A4.p3.11.m4.2.2.1.1.1" xref="A4.p3.11.m4.2.2.1.1.1.cmml"><mi id="A4.p3.11.m4.2.2.1.1.1.2" xref="A4.p3.11.m4.2.2.1.1.1.2.cmml">v</mi><mi id="A4.p3.11.m4.2.2.1.1.1.3" xref="A4.p3.11.m4.2.2.1.1.1.3.cmml">i</mi></msub><mo id="A4.p3.11.m4.2.2.1.1.3" stretchy="false" xref="A4.p3.11.m4.2.2.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A4.p3.11.m4.2b"><apply id="A4.p3.11.m4.2.2.cmml" xref="A4.p3.11.m4.2.2"><times id="A4.p3.11.m4.2.2.2.cmml" xref="A4.p3.11.m4.2.2.2"></times><apply id="A4.p3.11.m4.2.2.3.cmml" xref="A4.p3.11.m4.2.2.3"><csymbol cd="ambiguous" id="A4.p3.11.m4.2.2.3.1.cmml" xref="A4.p3.11.m4.2.2.3">superscript</csymbol><apply id="A4.p3.11.m4.2.2.3.2.cmml" xref="A4.p3.11.m4.2.2.3"><csymbol cd="ambiguous" id="A4.p3.11.m4.2.2.3.2.1.cmml" xref="A4.p3.11.m4.2.2.3">subscript</csymbol><ci id="A4.p3.11.m4.2.2.3.2.2.cmml" xref="A4.p3.11.m4.2.2.3.2.2">italic-ϕ</ci><ci id="A4.p3.11.m4.2.2.3.2.3.cmml" xref="A4.p3.11.m4.2.2.3.2.3">𝒢</ci></apply><cn id="A4.p3.11.m4.1.1.1.1.cmml" type="integer" xref="A4.p3.11.m4.1.1.1.1">1</cn></apply><apply id="A4.p3.11.m4.2.2.1.1.1.cmml" xref="A4.p3.11.m4.2.2.1.1"><csymbol cd="ambiguous" id="A4.p3.11.m4.2.2.1.1.1.1.cmml" xref="A4.p3.11.m4.2.2.1.1">subscript</csymbol><ci id="A4.p3.11.m4.2.2.1.1.1.2.cmml" xref="A4.p3.11.m4.2.2.1.1.1.2">𝑣</ci><ci id="A4.p3.11.m4.2.2.1.1.1.3.cmml" xref="A4.p3.11.m4.2.2.1.1.1.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.p3.11.m4.2c">\phi_{\mathcal{G}}^{(1)}(v_{i})</annotation><annotation encoding="application/x-llamapun" id="A4.p3.11.m4.2d">italic_ϕ start_POSTSUBSCRIPT caligraphic_G end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( 1 ) end_POSTSUPERSCRIPT ( italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT )</annotation></semantics></math> is sparse, the sum in Eq.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#A4.E25" title="In Appendix D Asymmetric graph random features ‣ Linear Transformer Topological Masking with Graph Random Features"><span class="ltx_text ltx_ref_tag">25</span></a> is computed in constant time so attention is computed in <math alttext="\mathcal{O}(N)" class="ltx_Math" display="inline" id="A4.p3.12.m5.1"><semantics id="A4.p3.12.m5.1a"><mrow id="A4.p3.12.m5.1.2" xref="A4.p3.12.m5.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="A4.p3.12.m5.1.2.2" xref="A4.p3.12.m5.1.2.2.cmml">𝒪</mi><mo id="A4.p3.12.m5.1.2.1" xref="A4.p3.12.m5.1.2.1.cmml">⁢</mo><mrow id="A4.p3.12.m5.1.2.3.2" xref="A4.p3.12.m5.1.2.cmml"><mo id="A4.p3.12.m5.1.2.3.2.1" stretchy="false" xref="A4.p3.12.m5.1.2.cmml">(</mo><mi id="A4.p3.12.m5.1.1" xref="A4.p3.12.m5.1.1.cmml">N</mi><mo id="A4.p3.12.m5.1.2.3.2.2" stretchy="false" xref="A4.p3.12.m5.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A4.p3.12.m5.1b"><apply id="A4.p3.12.m5.1.2.cmml" xref="A4.p3.12.m5.1.2"><times id="A4.p3.12.m5.1.2.1.cmml" xref="A4.p3.12.m5.1.2.1"></times><ci id="A4.p3.12.m5.1.2.2.cmml" xref="A4.p3.12.m5.1.2.2">𝒪</ci><ci id="A4.p3.12.m5.1.1.cmml" xref="A4.p3.12.m5.1.1">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.p3.12.m5.1c">\mathcal{O}(N)</annotation><annotation encoding="application/x-llamapun" id="A4.p3.12.m5.1d">caligraphic_O ( italic_N )</annotation></semantics></math>.
Even more explicitly, for an ensemble of walks <math alttext="\{\omega_{k}^{(i)}\}_{v_{i}\in\mathcal{N},\hskip 1.39998ptk\in[\![1,n]\!]}" class="ltx_Math" display="inline" id="A4.p3.13.m6.6"><semantics id="A4.p3.13.m6.6a"><msub id="A4.p3.13.m6.6.6" xref="A4.p3.13.m6.6.6.cmml"><mrow id="A4.p3.13.m6.6.6.1.1" xref="A4.p3.13.m6.6.6.1.2.cmml"><mo id="A4.p3.13.m6.6.6.1.1.2" stretchy="false" xref="A4.p3.13.m6.6.6.1.2.cmml">{</mo><msubsup id="A4.p3.13.m6.6.6.1.1.1" xref="A4.p3.13.m6.6.6.1.1.1.cmml"><mi id="A4.p3.13.m6.6.6.1.1.1.2.2" xref="A4.p3.13.m6.6.6.1.1.1.2.2.cmml">ω</mi><mi id="A4.p3.13.m6.6.6.1.1.1.2.3" xref="A4.p3.13.m6.6.6.1.1.1.2.3.cmml">k</mi><mrow id="A4.p3.13.m6.1.1.1.3" xref="A4.p3.13.m6.6.6.1.1.1.cmml"><mo id="A4.p3.13.m6.1.1.1.3.1" stretchy="false" xref="A4.p3.13.m6.6.6.1.1.1.cmml">(</mo><mi id="A4.p3.13.m6.1.1.1.1" xref="A4.p3.13.m6.1.1.1.1.cmml">i</mi><mo id="A4.p3.13.m6.1.1.1.3.2" stretchy="false" xref="A4.p3.13.m6.6.6.1.1.1.cmml">)</mo></mrow></msubsup><mo id="A4.p3.13.m6.6.6.1.1.3" stretchy="false" xref="A4.p3.13.m6.6.6.1.2.cmml">}</mo></mrow><mrow id="A4.p3.13.m6.5.5.4.4" xref="A4.p3.13.m6.5.5.4.5.cmml"><mrow id="A4.p3.13.m6.4.4.3.3.1" xref="A4.p3.13.m6.4.4.3.3.1.cmml"><msub id="A4.p3.13.m6.4.4.3.3.1.2" xref="A4.p3.13.m6.4.4.3.3.1.2.cmml"><mi id="A4.p3.13.m6.4.4.3.3.1.2.2" xref="A4.p3.13.m6.4.4.3.3.1.2.2.cmml">v</mi><mi id="A4.p3.13.m6.4.4.3.3.1.2.3" xref="A4.p3.13.m6.4.4.3.3.1.2.3.cmml">i</mi></msub><mo id="A4.p3.13.m6.4.4.3.3.1.1" xref="A4.p3.13.m6.4.4.3.3.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="A4.p3.13.m6.4.4.3.3.1.3" xref="A4.p3.13.m6.4.4.3.3.1.3.cmml">𝒩</mi></mrow><mo id="A4.p3.13.m6.5.5.4.4.3" rspace="0.307em" xref="A4.p3.13.m6.5.5.4.5a.cmml">,</mo><mrow id="A4.p3.13.m6.5.5.4.4.2" xref="A4.p3.13.m6.5.5.4.4.2.cmml"><mi id="A4.p3.13.m6.5.5.4.4.2.3" xref="A4.p3.13.m6.5.5.4.4.2.3.cmml">k</mi><mo id="A4.p3.13.m6.5.5.4.4.2.2" xref="A4.p3.13.m6.5.5.4.4.2.2.cmml">∈</mo><mrow id="A4.p3.13.m6.5.5.4.4.2.1.1" xref="A4.p3.13.m6.5.5.4.4.2.1.2.cmml"><mpadded width="0.247em"><mo id="A4.p3.13.m6.5.5.4.4.2.1.1.2" stretchy="false" xref="A4.p3.13.m6.5.5.4.4.2.1.2.1.cmml">[</mo></mpadded><mrow id="A4.p3.13.m6.5.5.4.4.2.1.1.1.2" xref="A4.p3.13.m6.5.5.4.4.2.1.1.1.1.cmml"><mo id="A4.p3.13.m6.5.5.4.4.2.1.1.1.2.1" stretchy="false" xref="A4.p3.13.m6.5.5.4.4.2.1.1.1.1.cmml">[</mo><mn id="A4.p3.13.m6.2.2.1.1" xref="A4.p3.13.m6.2.2.1.1.cmml">1</mn><mo id="A4.p3.13.m6.5.5.4.4.2.1.1.1.2.2" xref="A4.p3.13.m6.5.5.4.4.2.1.1.1.1.cmml">,</mo><mi id="A4.p3.13.m6.3.3.2.2" xref="A4.p3.13.m6.3.3.2.2.cmml">n</mi><mpadded width="0.247em"><mo id="A4.p3.13.m6.5.5.4.4.2.1.1.1.2.3" stretchy="false" xref="A4.p3.13.m6.5.5.4.4.2.1.1.1.1.cmml">]</mo></mpadded></mrow><mo id="A4.p3.13.m6.5.5.4.4.2.1.1.3" stretchy="false" xref="A4.p3.13.m6.5.5.4.4.2.1.2.1.cmml">]</mo></mrow></mrow></mrow></msub><annotation-xml encoding="MathML-Content" id="A4.p3.13.m6.6b"><apply id="A4.p3.13.m6.6.6.cmml" xref="A4.p3.13.m6.6.6"><csymbol cd="ambiguous" id="A4.p3.13.m6.6.6.2.cmml" xref="A4.p3.13.m6.6.6">subscript</csymbol><set id="A4.p3.13.m6.6.6.1.2.cmml" xref="A4.p3.13.m6.6.6.1.1"><apply id="A4.p3.13.m6.6.6.1.1.1.cmml" xref="A4.p3.13.m6.6.6.1.1.1"><csymbol cd="ambiguous" id="A4.p3.13.m6.6.6.1.1.1.1.cmml" xref="A4.p3.13.m6.6.6.1.1.1">superscript</csymbol><apply id="A4.p3.13.m6.6.6.1.1.1.2.cmml" xref="A4.p3.13.m6.6.6.1.1.1"><csymbol cd="ambiguous" id="A4.p3.13.m6.6.6.1.1.1.2.1.cmml" xref="A4.p3.13.m6.6.6.1.1.1">subscript</csymbol><ci id="A4.p3.13.m6.6.6.1.1.1.2.2.cmml" xref="A4.p3.13.m6.6.6.1.1.1.2.2">𝜔</ci><ci id="A4.p3.13.m6.6.6.1.1.1.2.3.cmml" xref="A4.p3.13.m6.6.6.1.1.1.2.3">𝑘</ci></apply><ci id="A4.p3.13.m6.1.1.1.1.cmml" xref="A4.p3.13.m6.1.1.1.1">𝑖</ci></apply></set><apply id="A4.p3.13.m6.5.5.4.5.cmml" xref="A4.p3.13.m6.5.5.4.4"><csymbol cd="ambiguous" id="A4.p3.13.m6.5.5.4.5a.cmml" xref="A4.p3.13.m6.5.5.4.4.3">formulae-sequence</csymbol><apply id="A4.p3.13.m6.4.4.3.3.1.cmml" xref="A4.p3.13.m6.4.4.3.3.1"><in id="A4.p3.13.m6.4.4.3.3.1.1.cmml" xref="A4.p3.13.m6.4.4.3.3.1.1"></in><apply id="A4.p3.13.m6.4.4.3.3.1.2.cmml" xref="A4.p3.13.m6.4.4.3.3.1.2"><csymbol cd="ambiguous" id="A4.p3.13.m6.4.4.3.3.1.2.1.cmml" xref="A4.p3.13.m6.4.4.3.3.1.2">subscript</csymbol><ci id="A4.p3.13.m6.4.4.3.3.1.2.2.cmml" xref="A4.p3.13.m6.4.4.3.3.1.2.2">𝑣</ci><ci id="A4.p3.13.m6.4.4.3.3.1.2.3.cmml" xref="A4.p3.13.m6.4.4.3.3.1.2.3">𝑖</ci></apply><ci id="A4.p3.13.m6.4.4.3.3.1.3.cmml" xref="A4.p3.13.m6.4.4.3.3.1.3">𝒩</ci></apply><apply id="A4.p3.13.m6.5.5.4.4.2.cmml" xref="A4.p3.13.m6.5.5.4.4.2"><in id="A4.p3.13.m6.5.5.4.4.2.2.cmml" xref="A4.p3.13.m6.5.5.4.4.2.2"></in><ci id="A4.p3.13.m6.5.5.4.4.2.3.cmml" xref="A4.p3.13.m6.5.5.4.4.2.3">𝑘</ci><apply id="A4.p3.13.m6.5.5.4.4.2.1.2.cmml" xref="A4.p3.13.m6.5.5.4.4.2.1.1"><csymbol cd="latexml" id="A4.p3.13.m6.5.5.4.4.2.1.2.1.cmml" xref="A4.p3.13.m6.5.5.4.4.2.1.1.2">delimited-[]</csymbol><interval closure="closed" id="A4.p3.13.m6.5.5.4.4.2.1.1.1.1.cmml" xref="A4.p3.13.m6.5.5.4.4.2.1.1.1.2"><cn id="A4.p3.13.m6.2.2.1.1.cmml" type="integer" xref="A4.p3.13.m6.2.2.1.1">1</cn><ci id="A4.p3.13.m6.3.3.2.2.cmml" xref="A4.p3.13.m6.3.3.2.2">𝑛</ci></interval></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.p3.13.m6.6c">\{\omega_{k}^{(i)}\}_{v_{i}\in\mathcal{N},\hskip 1.39998ptk\in[\![1,n]\!]}</annotation><annotation encoding="application/x-llamapun" id="A4.p3.13.m6.6d">{ italic_ω start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT } start_POSTSUBSCRIPT italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∈ caligraphic_N , italic_k ∈ [ [ 1 , italic_n ] ] end_POSTSUBSCRIPT</annotation></semantics></math>, we can rewrite the above as</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equation ltx_eqn_table" id="A4.E26">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\left[\sum_{k=1}^{n}\sum_{\omega\textrm{ p.s. }\omega_{k}^{(i)}}\mathbf{A}_{i%
\omega[-1]}\frac{\widetilde{\omega}(\omega)f_{\textrm{len}(\omega)}}{p(\omega)%
}\bm{v}_{\omega[-1]}\right]_{i=1}^{N}" class="ltx_Math" display="block" id="A4.E26.m1.7"><semantics id="A4.E26.m1.7a"><msubsup id="A4.E26.m1.7.7" xref="A4.E26.m1.7.7.cmml"><mrow id="A4.E26.m1.7.7.1.1.1" xref="A4.E26.m1.7.7.1.1.2.cmml"><mo id="A4.E26.m1.7.7.1.1.1.2" xref="A4.E26.m1.7.7.1.1.2.1.cmml">[</mo><mrow id="A4.E26.m1.7.7.1.1.1.1" xref="A4.E26.m1.7.7.1.1.1.1.cmml"><munderover id="A4.E26.m1.7.7.1.1.1.1.1" xref="A4.E26.m1.7.7.1.1.1.1.1.cmml"><mo id="A4.E26.m1.7.7.1.1.1.1.1.2.2" lspace="0em" movablelimits="false" rspace="0em" xref="A4.E26.m1.7.7.1.1.1.1.1.2.2.cmml">∑</mo><mrow id="A4.E26.m1.7.7.1.1.1.1.1.2.3" xref="A4.E26.m1.7.7.1.1.1.1.1.2.3.cmml"><mi id="A4.E26.m1.7.7.1.1.1.1.1.2.3.2" xref="A4.E26.m1.7.7.1.1.1.1.1.2.3.2.cmml">k</mi><mo id="A4.E26.m1.7.7.1.1.1.1.1.2.3.1" xref="A4.E26.m1.7.7.1.1.1.1.1.2.3.1.cmml">=</mo><mn id="A4.E26.m1.7.7.1.1.1.1.1.2.3.3" xref="A4.E26.m1.7.7.1.1.1.1.1.2.3.3.cmml">1</mn></mrow><mi id="A4.E26.m1.7.7.1.1.1.1.1.3" xref="A4.E26.m1.7.7.1.1.1.1.1.3.cmml">n</mi></munderover><mrow id="A4.E26.m1.7.7.1.1.1.1.2" xref="A4.E26.m1.7.7.1.1.1.1.2.cmml"><munder id="A4.E26.m1.7.7.1.1.1.1.2.1" xref="A4.E26.m1.7.7.1.1.1.1.2.1.cmml"><mo id="A4.E26.m1.7.7.1.1.1.1.2.1.2" movablelimits="false" xref="A4.E26.m1.7.7.1.1.1.1.2.1.2.cmml">∑</mo><mrow id="A4.E26.m1.1.1.1" xref="A4.E26.m1.1.1.1.cmml"><mi id="A4.E26.m1.1.1.1.3" xref="A4.E26.m1.1.1.1.3.cmml">ω</mi><mo id="A4.E26.m1.1.1.1.2" xref="A4.E26.m1.1.1.1.2.cmml">⁢</mo><mtext id="A4.E26.m1.1.1.1.4" xref="A4.E26.m1.1.1.1.4a.cmml">&nbsp;p.s.&nbsp;</mtext><mo id="A4.E26.m1.1.1.1.2a" xref="A4.E26.m1.1.1.1.2.cmml">⁢</mo><msubsup id="A4.E26.m1.1.1.1.5" xref="A4.E26.m1.1.1.1.5.cmml"><mi id="A4.E26.m1.1.1.1.5.2.2" xref="A4.E26.m1.1.1.1.5.2.2.cmml">ω</mi><mi id="A4.E26.m1.1.1.1.5.2.3" xref="A4.E26.m1.1.1.1.5.2.3.cmml">k</mi><mrow id="A4.E26.m1.1.1.1.1.1.3" xref="A4.E26.m1.1.1.1.5.cmml"><mo id="A4.E26.m1.1.1.1.1.1.3.1" stretchy="false" xref="A4.E26.m1.1.1.1.5.cmml">(</mo><mi id="A4.E26.m1.1.1.1.1.1.1" xref="A4.E26.m1.1.1.1.1.1.1.cmml">i</mi><mo id="A4.E26.m1.1.1.1.1.1.3.2" stretchy="false" xref="A4.E26.m1.1.1.1.5.cmml">)</mo></mrow></msubsup></mrow></munder><mrow id="A4.E26.m1.7.7.1.1.1.1.2.2" xref="A4.E26.m1.7.7.1.1.1.1.2.2.cmml"><msub id="A4.E26.m1.7.7.1.1.1.1.2.2.2" xref="A4.E26.m1.7.7.1.1.1.1.2.2.2.cmml"><mi id="A4.E26.m1.7.7.1.1.1.1.2.2.2.2" xref="A4.E26.m1.7.7.1.1.1.1.2.2.2.2.cmml">𝐀</mi><mrow id="A4.E26.m1.2.2.1" xref="A4.E26.m1.2.2.1.cmml"><mi id="A4.E26.m1.2.2.1.3" xref="A4.E26.m1.2.2.1.3.cmml">i</mi><mo id="A4.E26.m1.2.2.1.2" xref="A4.E26.m1.2.2.1.2.cmml">⁢</mo><mi id="A4.E26.m1.2.2.1.4" xref="A4.E26.m1.2.2.1.4.cmml">ω</mi><mo id="A4.E26.m1.2.2.1.2a" xref="A4.E26.m1.2.2.1.2.cmml">⁢</mo><mrow id="A4.E26.m1.2.2.1.1.1" xref="A4.E26.m1.2.2.1.1.2.cmml"><mo id="A4.E26.m1.2.2.1.1.1.2" stretchy="false" xref="A4.E26.m1.2.2.1.1.2.1.cmml">[</mo><mrow id="A4.E26.m1.2.2.1.1.1.1" xref="A4.E26.m1.2.2.1.1.1.1.cmml"><mo id="A4.E26.m1.2.2.1.1.1.1a" xref="A4.E26.m1.2.2.1.1.1.1.cmml">−</mo><mn id="A4.E26.m1.2.2.1.1.1.1.2" xref="A4.E26.m1.2.2.1.1.1.1.2.cmml">1</mn></mrow><mo id="A4.E26.m1.2.2.1.1.1.3" stretchy="false" xref="A4.E26.m1.2.2.1.1.2.1.cmml">]</mo></mrow></mrow></msub><mo id="A4.E26.m1.7.7.1.1.1.1.2.2.1" xref="A4.E26.m1.7.7.1.1.1.1.2.2.1.cmml">⁢</mo><mfrac id="A4.E26.m1.5.5" xref="A4.E26.m1.5.5.cmml"><mrow id="A4.E26.m1.4.4.2" xref="A4.E26.m1.4.4.2.cmml"><mover accent="true" id="A4.E26.m1.4.4.2.4" xref="A4.E26.m1.4.4.2.4.cmml"><mi id="A4.E26.m1.4.4.2.4.2" xref="A4.E26.m1.4.4.2.4.2.cmml">ω</mi><mo id="A4.E26.m1.4.4.2.4.1" xref="A4.E26.m1.4.4.2.4.1.cmml">~</mo></mover><mo id="A4.E26.m1.4.4.2.3" xref="A4.E26.m1.4.4.2.3.cmml">⁢</mo><mrow id="A4.E26.m1.4.4.2.5.2" xref="A4.E26.m1.4.4.2.cmml"><mo id="A4.E26.m1.4.4.2.5.2.1" stretchy="false" xref="A4.E26.m1.4.4.2.cmml">(</mo><mi id="A4.E26.m1.4.4.2.2" xref="A4.E26.m1.4.4.2.2.cmml">ω</mi><mo id="A4.E26.m1.4.4.2.5.2.2" stretchy="false" xref="A4.E26.m1.4.4.2.cmml">)</mo></mrow><mo id="A4.E26.m1.4.4.2.3a" xref="A4.E26.m1.4.4.2.3.cmml">⁢</mo><msub id="A4.E26.m1.4.4.2.6" xref="A4.E26.m1.4.4.2.6.cmml"><mi id="A4.E26.m1.4.4.2.6.2" xref="A4.E26.m1.4.4.2.6.2.cmml">f</mi><mrow id="A4.E26.m1.3.3.1.1.1" xref="A4.E26.m1.3.3.1.1.1.cmml"><mtext id="A4.E26.m1.3.3.1.1.1.3" xref="A4.E26.m1.3.3.1.1.1.3a.cmml">len</mtext><mo id="A4.E26.m1.3.3.1.1.1.2" xref="A4.E26.m1.3.3.1.1.1.2.cmml">⁢</mo><mrow id="A4.E26.m1.3.3.1.1.1.4.2" xref="A4.E26.m1.3.3.1.1.1.cmml"><mo id="A4.E26.m1.3.3.1.1.1.4.2.1" stretchy="false" xref="A4.E26.m1.3.3.1.1.1.cmml">(</mo><mi id="A4.E26.m1.3.3.1.1.1.1" xref="A4.E26.m1.3.3.1.1.1.1.cmml">ω</mi><mo id="A4.E26.m1.3.3.1.1.1.4.2.2" stretchy="false" xref="A4.E26.m1.3.3.1.1.1.cmml">)</mo></mrow></mrow></msub></mrow><mrow id="A4.E26.m1.5.5.3" xref="A4.E26.m1.5.5.3.cmml"><mi id="A4.E26.m1.5.5.3.3" xref="A4.E26.m1.5.5.3.3.cmml">p</mi><mo id="A4.E26.m1.5.5.3.2" xref="A4.E26.m1.5.5.3.2.cmml">⁢</mo><mrow id="A4.E26.m1.5.5.3.4.2" xref="A4.E26.m1.5.5.3.cmml"><mo id="A4.E26.m1.5.5.3.4.2.1" stretchy="false" xref="A4.E26.m1.5.5.3.cmml">(</mo><mi id="A4.E26.m1.5.5.3.1" xref="A4.E26.m1.5.5.3.1.cmml">ω</mi><mo id="A4.E26.m1.5.5.3.4.2.2" stretchy="false" xref="A4.E26.m1.5.5.3.cmml">)</mo></mrow></mrow></mfrac><mo id="A4.E26.m1.7.7.1.1.1.1.2.2.1a" xref="A4.E26.m1.7.7.1.1.1.1.2.2.1.cmml">⁢</mo><msub id="A4.E26.m1.7.7.1.1.1.1.2.2.3" xref="A4.E26.m1.7.7.1.1.1.1.2.2.3.cmml"><mi id="A4.E26.m1.7.7.1.1.1.1.2.2.3.2" xref="A4.E26.m1.7.7.1.1.1.1.2.2.3.2.cmml">𝒗</mi><mrow id="A4.E26.m1.6.6.1" xref="A4.E26.m1.6.6.1.cmml"><mi id="A4.E26.m1.6.6.1.3" xref="A4.E26.m1.6.6.1.3.cmml">ω</mi><mo id="A4.E26.m1.6.6.1.2" xref="A4.E26.m1.6.6.1.2.cmml">⁢</mo><mrow id="A4.E26.m1.6.6.1.1.1" xref="A4.E26.m1.6.6.1.1.2.cmml"><mo id="A4.E26.m1.6.6.1.1.1.2" stretchy="false" xref="A4.E26.m1.6.6.1.1.2.1.cmml">[</mo><mrow id="A4.E26.m1.6.6.1.1.1.1" xref="A4.E26.m1.6.6.1.1.1.1.cmml"><mo id="A4.E26.m1.6.6.1.1.1.1a" xref="A4.E26.m1.6.6.1.1.1.1.cmml">−</mo><mn id="A4.E26.m1.6.6.1.1.1.1.2" xref="A4.E26.m1.6.6.1.1.1.1.2.cmml">1</mn></mrow><mo id="A4.E26.m1.6.6.1.1.1.3" stretchy="false" xref="A4.E26.m1.6.6.1.1.2.1.cmml">]</mo></mrow></mrow></msub></mrow></mrow></mrow><mo id="A4.E26.m1.7.7.1.1.1.3" xref="A4.E26.m1.7.7.1.1.2.1.cmml">]</mo></mrow><mrow id="A4.E26.m1.7.7.1.3" xref="A4.E26.m1.7.7.1.3.cmml"><mi id="A4.E26.m1.7.7.1.3.2" xref="A4.E26.m1.7.7.1.3.2.cmml">i</mi><mo id="A4.E26.m1.7.7.1.3.1" xref="A4.E26.m1.7.7.1.3.1.cmml">=</mo><mn id="A4.E26.m1.7.7.1.3.3" xref="A4.E26.m1.7.7.1.3.3.cmml">1</mn></mrow><mi id="A4.E26.m1.7.7.3" xref="A4.E26.m1.7.7.3.cmml">N</mi></msubsup><annotation-xml encoding="MathML-Content" id="A4.E26.m1.7b"><apply id="A4.E26.m1.7.7.cmml" xref="A4.E26.m1.7.7"><csymbol cd="ambiguous" id="A4.E26.m1.7.7.2.cmml" xref="A4.E26.m1.7.7">superscript</csymbol><apply id="A4.E26.m1.7.7.1.cmml" xref="A4.E26.m1.7.7"><csymbol cd="ambiguous" id="A4.E26.m1.7.7.1.2.cmml" xref="A4.E26.m1.7.7">subscript</csymbol><apply id="A4.E26.m1.7.7.1.1.2.cmml" xref="A4.E26.m1.7.7.1.1.1"><csymbol cd="latexml" id="A4.E26.m1.7.7.1.1.2.1.cmml" xref="A4.E26.m1.7.7.1.1.1.2">delimited-[]</csymbol><apply id="A4.E26.m1.7.7.1.1.1.1.cmml" xref="A4.E26.m1.7.7.1.1.1.1"><apply id="A4.E26.m1.7.7.1.1.1.1.1.cmml" xref="A4.E26.m1.7.7.1.1.1.1.1"><csymbol cd="ambiguous" id="A4.E26.m1.7.7.1.1.1.1.1.1.cmml" xref="A4.E26.m1.7.7.1.1.1.1.1">superscript</csymbol><apply id="A4.E26.m1.7.7.1.1.1.1.1.2.cmml" xref="A4.E26.m1.7.7.1.1.1.1.1"><csymbol cd="ambiguous" id="A4.E26.m1.7.7.1.1.1.1.1.2.1.cmml" xref="A4.E26.m1.7.7.1.1.1.1.1">subscript</csymbol><sum id="A4.E26.m1.7.7.1.1.1.1.1.2.2.cmml" xref="A4.E26.m1.7.7.1.1.1.1.1.2.2"></sum><apply id="A4.E26.m1.7.7.1.1.1.1.1.2.3.cmml" xref="A4.E26.m1.7.7.1.1.1.1.1.2.3"><eq id="A4.E26.m1.7.7.1.1.1.1.1.2.3.1.cmml" xref="A4.E26.m1.7.7.1.1.1.1.1.2.3.1"></eq><ci id="A4.E26.m1.7.7.1.1.1.1.1.2.3.2.cmml" xref="A4.E26.m1.7.7.1.1.1.1.1.2.3.2">𝑘</ci><cn id="A4.E26.m1.7.7.1.1.1.1.1.2.3.3.cmml" type="integer" xref="A4.E26.m1.7.7.1.1.1.1.1.2.3.3">1</cn></apply></apply><ci id="A4.E26.m1.7.7.1.1.1.1.1.3.cmml" xref="A4.E26.m1.7.7.1.1.1.1.1.3">𝑛</ci></apply><apply id="A4.E26.m1.7.7.1.1.1.1.2.cmml" xref="A4.E26.m1.7.7.1.1.1.1.2"><apply id="A4.E26.m1.7.7.1.1.1.1.2.1.cmml" xref="A4.E26.m1.7.7.1.1.1.1.2.1"><csymbol cd="ambiguous" id="A4.E26.m1.7.7.1.1.1.1.2.1.1.cmml" xref="A4.E26.m1.7.7.1.1.1.1.2.1">subscript</csymbol><sum id="A4.E26.m1.7.7.1.1.1.1.2.1.2.cmml" xref="A4.E26.m1.7.7.1.1.1.1.2.1.2"></sum><apply id="A4.E26.m1.1.1.1.cmml" xref="A4.E26.m1.1.1.1"><times id="A4.E26.m1.1.1.1.2.cmml" xref="A4.E26.m1.1.1.1.2"></times><ci id="A4.E26.m1.1.1.1.3.cmml" xref="A4.E26.m1.1.1.1.3">𝜔</ci><ci id="A4.E26.m1.1.1.1.4a.cmml" xref="A4.E26.m1.1.1.1.4"><mtext id="A4.E26.m1.1.1.1.4.cmml" mathsize="70%" xref="A4.E26.m1.1.1.1.4">&nbsp;p.s.&nbsp;</mtext></ci><apply id="A4.E26.m1.1.1.1.5.cmml" xref="A4.E26.m1.1.1.1.5"><csymbol cd="ambiguous" id="A4.E26.m1.1.1.1.5.1.cmml" xref="A4.E26.m1.1.1.1.5">superscript</csymbol><apply id="A4.E26.m1.1.1.1.5.2.cmml" xref="A4.E26.m1.1.1.1.5"><csymbol cd="ambiguous" id="A4.E26.m1.1.1.1.5.2.1.cmml" xref="A4.E26.m1.1.1.1.5">subscript</csymbol><ci id="A4.E26.m1.1.1.1.5.2.2.cmml" xref="A4.E26.m1.1.1.1.5.2.2">𝜔</ci><ci id="A4.E26.m1.1.1.1.5.2.3.cmml" xref="A4.E26.m1.1.1.1.5.2.3">𝑘</ci></apply><ci id="A4.E26.m1.1.1.1.1.1.1.cmml" xref="A4.E26.m1.1.1.1.1.1.1">𝑖</ci></apply></apply></apply><apply id="A4.E26.m1.7.7.1.1.1.1.2.2.cmml" xref="A4.E26.m1.7.7.1.1.1.1.2.2"><times id="A4.E26.m1.7.7.1.1.1.1.2.2.1.cmml" xref="A4.E26.m1.7.7.1.1.1.1.2.2.1"></times><apply id="A4.E26.m1.7.7.1.1.1.1.2.2.2.cmml" xref="A4.E26.m1.7.7.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="A4.E26.m1.7.7.1.1.1.1.2.2.2.1.cmml" xref="A4.E26.m1.7.7.1.1.1.1.2.2.2">subscript</csymbol><ci id="A4.E26.m1.7.7.1.1.1.1.2.2.2.2.cmml" xref="A4.E26.m1.7.7.1.1.1.1.2.2.2.2">𝐀</ci><apply id="A4.E26.m1.2.2.1.cmml" xref="A4.E26.m1.2.2.1"><times id="A4.E26.m1.2.2.1.2.cmml" xref="A4.E26.m1.2.2.1.2"></times><ci id="A4.E26.m1.2.2.1.3.cmml" xref="A4.E26.m1.2.2.1.3">𝑖</ci><ci id="A4.E26.m1.2.2.1.4.cmml" xref="A4.E26.m1.2.2.1.4">𝜔</ci><apply id="A4.E26.m1.2.2.1.1.2.cmml" xref="A4.E26.m1.2.2.1.1.1"><csymbol cd="latexml" id="A4.E26.m1.2.2.1.1.2.1.cmml" xref="A4.E26.m1.2.2.1.1.1.2">delimited-[]</csymbol><apply id="A4.E26.m1.2.2.1.1.1.1.cmml" xref="A4.E26.m1.2.2.1.1.1.1"><minus id="A4.E26.m1.2.2.1.1.1.1.1.cmml" xref="A4.E26.m1.2.2.1.1.1.1"></minus><cn id="A4.E26.m1.2.2.1.1.1.1.2.cmml" type="integer" xref="A4.E26.m1.2.2.1.1.1.1.2">1</cn></apply></apply></apply></apply><apply id="A4.E26.m1.5.5.cmml" xref="A4.E26.m1.5.5"><divide id="A4.E26.m1.5.5.4.cmml" xref="A4.E26.m1.5.5"></divide><apply id="A4.E26.m1.4.4.2.cmml" xref="A4.E26.m1.4.4.2"><times id="A4.E26.m1.4.4.2.3.cmml" xref="A4.E26.m1.4.4.2.3"></times><apply id="A4.E26.m1.4.4.2.4.cmml" xref="A4.E26.m1.4.4.2.4"><ci id="A4.E26.m1.4.4.2.4.1.cmml" xref="A4.E26.m1.4.4.2.4.1">~</ci><ci id="A4.E26.m1.4.4.2.4.2.cmml" xref="A4.E26.m1.4.4.2.4.2">𝜔</ci></apply><ci id="A4.E26.m1.4.4.2.2.cmml" xref="A4.E26.m1.4.4.2.2">𝜔</ci><apply id="A4.E26.m1.4.4.2.6.cmml" xref="A4.E26.m1.4.4.2.6"><csymbol cd="ambiguous" id="A4.E26.m1.4.4.2.6.1.cmml" xref="A4.E26.m1.4.4.2.6">subscript</csymbol><ci id="A4.E26.m1.4.4.2.6.2.cmml" xref="A4.E26.m1.4.4.2.6.2">𝑓</ci><apply id="A4.E26.m1.3.3.1.1.1.cmml" xref="A4.E26.m1.3.3.1.1.1"><times id="A4.E26.m1.3.3.1.1.1.2.cmml" xref="A4.E26.m1.3.3.1.1.1.2"></times><ci id="A4.E26.m1.3.3.1.1.1.3a.cmml" xref="A4.E26.m1.3.3.1.1.1.3"><mtext id="A4.E26.m1.3.3.1.1.1.3.cmml" mathsize="70%" xref="A4.E26.m1.3.3.1.1.1.3">len</mtext></ci><ci id="A4.E26.m1.3.3.1.1.1.1.cmml" xref="A4.E26.m1.3.3.1.1.1.1">𝜔</ci></apply></apply></apply><apply id="A4.E26.m1.5.5.3.cmml" xref="A4.E26.m1.5.5.3"><times id="A4.E26.m1.5.5.3.2.cmml" xref="A4.E26.m1.5.5.3.2"></times><ci id="A4.E26.m1.5.5.3.3.cmml" xref="A4.E26.m1.5.5.3.3">𝑝</ci><ci id="A4.E26.m1.5.5.3.1.cmml" xref="A4.E26.m1.5.5.3.1">𝜔</ci></apply></apply><apply id="A4.E26.m1.7.7.1.1.1.1.2.2.3.cmml" xref="A4.E26.m1.7.7.1.1.1.1.2.2.3"><csymbol cd="ambiguous" id="A4.E26.m1.7.7.1.1.1.1.2.2.3.1.cmml" xref="A4.E26.m1.7.7.1.1.1.1.2.2.3">subscript</csymbol><ci id="A4.E26.m1.7.7.1.1.1.1.2.2.3.2.cmml" xref="A4.E26.m1.7.7.1.1.1.1.2.2.3.2">𝒗</ci><apply id="A4.E26.m1.6.6.1.cmml" xref="A4.E26.m1.6.6.1"><times id="A4.E26.m1.6.6.1.2.cmml" xref="A4.E26.m1.6.6.1.2"></times><ci id="A4.E26.m1.6.6.1.3.cmml" xref="A4.E26.m1.6.6.1.3">𝜔</ci><apply id="A4.E26.m1.6.6.1.1.2.cmml" xref="A4.E26.m1.6.6.1.1.1"><csymbol cd="latexml" id="A4.E26.m1.6.6.1.1.2.1.cmml" xref="A4.E26.m1.6.6.1.1.1.2">delimited-[]</csymbol><apply id="A4.E26.m1.6.6.1.1.1.1.cmml" xref="A4.E26.m1.6.6.1.1.1.1"><minus id="A4.E26.m1.6.6.1.1.1.1.1.cmml" xref="A4.E26.m1.6.6.1.1.1.1"></minus><cn id="A4.E26.m1.6.6.1.1.1.1.2.cmml" type="integer" xref="A4.E26.m1.6.6.1.1.1.1.2">1</cn></apply></apply></apply></apply></apply></apply></apply></apply><apply id="A4.E26.m1.7.7.1.3.cmml" xref="A4.E26.m1.7.7.1.3"><eq id="A4.E26.m1.7.7.1.3.1.cmml" xref="A4.E26.m1.7.7.1.3.1"></eq><ci id="A4.E26.m1.7.7.1.3.2.cmml" xref="A4.E26.m1.7.7.1.3.2">𝑖</ci><cn id="A4.E26.m1.7.7.1.3.3.cmml" type="integer" xref="A4.E26.m1.7.7.1.3.3">1</cn></apply></apply><ci id="A4.E26.m1.7.7.3.cmml" xref="A4.E26.m1.7.7.3">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.E26.m1.7c">\left[\sum_{k=1}^{n}\sum_{\omega\textrm{ p.s. }\omega_{k}^{(i)}}\mathbf{A}_{i%
\omega[-1]}\frac{\widetilde{\omega}(\omega)f_{\textrm{len}(\omega)}}{p(\omega)%
}\bm{v}_{\omega[-1]}\right]_{i=1}^{N}</annotation><annotation encoding="application/x-llamapun" id="A4.E26.m1.7d">[ ∑ start_POSTSUBSCRIPT italic_k = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT ∑ start_POSTSUBSCRIPT italic_ω p.s. italic_ω start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT end_POSTSUBSCRIPT bold_A start_POSTSUBSCRIPT italic_i italic_ω [ - 1 ] end_POSTSUBSCRIPT divide start_ARG over~ start_ARG italic_ω end_ARG ( italic_ω ) italic_f start_POSTSUBSCRIPT len ( italic_ω ) end_POSTSUBSCRIPT end_ARG start_ARG italic_p ( italic_ω ) end_ARG bold_italic_v start_POSTSUBSCRIPT italic_ω [ - 1 ] end_POSTSUBSCRIPT ] start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(26)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A4.p3.18">where <math alttext="\omega[-1]" class="ltx_Math" display="inline" id="A4.p3.14.m1.1"><semantics id="A4.p3.14.m1.1a"><mrow id="A4.p3.14.m1.1.1" xref="A4.p3.14.m1.1.1.cmml"><mi id="A4.p3.14.m1.1.1.3" xref="A4.p3.14.m1.1.1.3.cmml">ω</mi><mo id="A4.p3.14.m1.1.1.2" xref="A4.p3.14.m1.1.1.2.cmml">⁢</mo><mrow id="A4.p3.14.m1.1.1.1.1" xref="A4.p3.14.m1.1.1.1.2.cmml"><mo id="A4.p3.14.m1.1.1.1.1.2" stretchy="false" xref="A4.p3.14.m1.1.1.1.2.1.cmml">[</mo><mrow id="A4.p3.14.m1.1.1.1.1.1" xref="A4.p3.14.m1.1.1.1.1.1.cmml"><mo id="A4.p3.14.m1.1.1.1.1.1a" xref="A4.p3.14.m1.1.1.1.1.1.cmml">−</mo><mn id="A4.p3.14.m1.1.1.1.1.1.2" xref="A4.p3.14.m1.1.1.1.1.1.2.cmml">1</mn></mrow><mo id="A4.p3.14.m1.1.1.1.1.3" stretchy="false" xref="A4.p3.14.m1.1.1.1.2.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A4.p3.14.m1.1b"><apply id="A4.p3.14.m1.1.1.cmml" xref="A4.p3.14.m1.1.1"><times id="A4.p3.14.m1.1.1.2.cmml" xref="A4.p3.14.m1.1.1.2"></times><ci id="A4.p3.14.m1.1.1.3.cmml" xref="A4.p3.14.m1.1.1.3">𝜔</ci><apply id="A4.p3.14.m1.1.1.1.2.cmml" xref="A4.p3.14.m1.1.1.1.1"><csymbol cd="latexml" id="A4.p3.14.m1.1.1.1.2.1.cmml" xref="A4.p3.14.m1.1.1.1.1.2">delimited-[]</csymbol><apply id="A4.p3.14.m1.1.1.1.1.1.cmml" xref="A4.p3.14.m1.1.1.1.1.1"><minus id="A4.p3.14.m1.1.1.1.1.1.1.cmml" xref="A4.p3.14.m1.1.1.1.1.1"></minus><cn id="A4.p3.14.m1.1.1.1.1.1.2.cmml" type="integer" xref="A4.p3.14.m1.1.1.1.1.1.2">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.p3.14.m1.1c">\omega[-1]</annotation><annotation encoding="application/x-llamapun" id="A4.p3.14.m1.1d">italic_ω [ - 1 ]</annotation></semantics></math> stands for the final node of the walk <math alttext="\omega" class="ltx_Math" display="inline" id="A4.p3.15.m2.1"><semantics id="A4.p3.15.m2.1a"><mi id="A4.p3.15.m2.1.1" xref="A4.p3.15.m2.1.1.cmml">ω</mi><annotation-xml encoding="MathML-Content" id="A4.p3.15.m2.1b"><ci id="A4.p3.15.m2.1.1.cmml" xref="A4.p3.15.m2.1.1">𝜔</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.p3.15.m2.1c">\omega</annotation><annotation encoding="application/x-llamapun" id="A4.p3.15.m2.1d">italic_ω</annotation></semantics></math> and p.s. means ‘prefix subwalk’ (see App.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#A1.SS2" title="A.2 Proof of Thm. 3.1 (novel) ‣ Appendix A Proofs ‣ Linear Transformer Topological Masking with Graph Random Features"><span class="ltx_text ltx_ref_tag">A.2</span></a>).
The number of FLOPs to compute attention for node <math alttext="v_{i}" class="ltx_Math" display="inline" id="A4.p3.16.m3.1"><semantics id="A4.p3.16.m3.1a"><msub id="A4.p3.16.m3.1.1" xref="A4.p3.16.m3.1.1.cmml"><mi id="A4.p3.16.m3.1.1.2" xref="A4.p3.16.m3.1.1.2.cmml">v</mi><mi id="A4.p3.16.m3.1.1.3" xref="A4.p3.16.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A4.p3.16.m3.1b"><apply id="A4.p3.16.m3.1.1.cmml" xref="A4.p3.16.m3.1.1"><csymbol cd="ambiguous" id="A4.p3.16.m3.1.1.1.cmml" xref="A4.p3.16.m3.1.1">subscript</csymbol><ci id="A4.p3.16.m3.1.1.2.cmml" xref="A4.p3.16.m3.1.1.2">𝑣</ci><ci id="A4.p3.16.m3.1.1.3.cmml" xref="A4.p3.16.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.p3.16.m3.1c">v_{i}</annotation><annotation encoding="application/x-llamapun" id="A4.p3.16.m3.1d">italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> depends on the length of all the geometrically distributed walks beginning at node <math alttext="v_{i}" class="ltx_Math" display="inline" id="A4.p3.17.m4.1"><semantics id="A4.p3.17.m4.1a"><msub id="A4.p3.17.m4.1.1" xref="A4.p3.17.m4.1.1.cmml"><mi id="A4.p3.17.m4.1.1.2" xref="A4.p3.17.m4.1.1.2.cmml">v</mi><mi id="A4.p3.17.m4.1.1.3" xref="A4.p3.17.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A4.p3.17.m4.1b"><apply id="A4.p3.17.m4.1.1.cmml" xref="A4.p3.17.m4.1.1"><csymbol cd="ambiguous" id="A4.p3.17.m4.1.1.1.cmml" xref="A4.p3.17.m4.1.1">subscript</csymbol><ci id="A4.p3.17.m4.1.1.2.cmml" xref="A4.p3.17.m4.1.1.2">𝑣</ci><ci id="A4.p3.17.m4.1.1.3.cmml" xref="A4.p3.17.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.p3.17.m4.1c">v_{i}</annotation><annotation encoding="application/x-llamapun" id="A4.p3.17.m4.1d">italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>, but we have seen that this is independent of graph size (Sec.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#S3.SS4" title="3.4 Novel theoretical results for GRFs: sharp estimators with sparse features ‣ 3 Towards linear topological masking ‣ Linear Transformer Topological Masking with Graph Random Features"><span class="ltx_text ltx_ref_tag">3.4</span></a>).
Computing the entire matrix is only <math alttext="\mathcal{O}(N)" class="ltx_Math" display="inline" id="A4.p3.18.m5.1"><semantics id="A4.p3.18.m5.1a"><mrow id="A4.p3.18.m5.1.2" xref="A4.p3.18.m5.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="A4.p3.18.m5.1.2.2" xref="A4.p3.18.m5.1.2.2.cmml">𝒪</mi><mo id="A4.p3.18.m5.1.2.1" xref="A4.p3.18.m5.1.2.1.cmml">⁢</mo><mrow id="A4.p3.18.m5.1.2.3.2" xref="A4.p3.18.m5.1.2.cmml"><mo id="A4.p3.18.m5.1.2.3.2.1" stretchy="false" xref="A4.p3.18.m5.1.2.cmml">(</mo><mi id="A4.p3.18.m5.1.1" xref="A4.p3.18.m5.1.1.cmml">N</mi><mo id="A4.p3.18.m5.1.2.3.2.2" stretchy="false" xref="A4.p3.18.m5.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A4.p3.18.m5.1b"><apply id="A4.p3.18.m5.1.2.cmml" xref="A4.p3.18.m5.1.2"><times id="A4.p3.18.m5.1.2.1.cmml" xref="A4.p3.18.m5.1.2.1"></times><ci id="A4.p3.18.m5.1.2.2.cmml" xref="A4.p3.18.m5.1.2.2">𝒪</ci><ci id="A4.p3.18.m5.1.1.cmml" xref="A4.p3.18.m5.1.1">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.p3.18.m5.1c">\mathcal{O}(N)</annotation><annotation encoding="application/x-llamapun" id="A4.p3.18.m5.1d">caligraphic_O ( italic_N )</annotation></semantics></math>.
We give pseudocode for this approach in Alg.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#alg2" title="Algorithm 2 ‣ Appendix D Asymmetric graph random features ‣ Linear Transformer Topological Masking with Graph Random Features"><span class="ltx_text ltx_ref_tag">2</span></a>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="A4.p4">
<p class="ltx_p" id="A4.p4.2"><span class="ltx_text ltx_font_bold" id="A4.p4.2.1">Benefits and limitations of asymmetric GRFs.</span>
The chief benefit of asymmetric GRFs is that Eq.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#A4.E26" title="In Appendix D Asymmetric graph random features ‣ Linear Transformer Topological Masking with Graph Random Features"><span class="ltx_text ltx_ref_tag">26</span></a> makes efficient masked attention very straightforward to compute, without relying on sparse matrix operations that may not be well-optimised in machine learning libraries.
We use it for the HD-VPD experiments because it can be easily integrated with the existing code: instead of finding each node’s (approximate) <math alttext="k" class="ltx_Math" display="inline" id="A4.p4.1.m1.1"><semantics id="A4.p4.1.m1.1a"><mi id="A4.p4.1.m1.1.1" xref="A4.p4.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="A4.p4.1.m1.1b"><ci id="A4.p4.1.m1.1.1.cmml" xref="A4.p4.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.p4.1.m1.1c">k</annotation><annotation encoding="application/x-llamapun" id="A4.p4.1.m1.1d">italic_k</annotation></semantics></math>-nearest neighbours and implementing the complicated message passing-type algorithm by <cite class="ltx_cite ltx_citemacro_citet">Whitney et&nbsp;al. [<a class="ltx_ref" href="https://arxiv.org/html/2410.03462v1#bib.bib38" title="">2024</a>]</cite>, we find the <math alttext="3" class="ltx_Math" display="inline" id="A4.p4.2.m2.1"><semantics id="A4.p4.2.m2.1a"><mn id="A4.p4.2.m2.1.1" xref="A4.p4.2.m2.1.1.cmml">3</mn><annotation-xml encoding="MathML-Content" id="A4.p4.2.m2.1b"><cn id="A4.p4.2.m2.1.1.cmml" type="integer" xref="A4.p4.2.m2.1.1">3</cn></annotation-xml><annotation encoding="application/x-tex" id="A4.p4.2.m2.1c">3</annotation><annotation encoding="application/x-llamapun" id="A4.p4.2.m2.1d">3</annotation></semantics></math>-hop neighbourhood and straightforwardly compute weighted attention with a learnable function of walk length.
The drawback is that the variance of the mask estimate with asymmetric GRFs tends to be greater, though proving this is an open problem.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top" id="alg2">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="alg2.15.1.1">Algorithm 2</span> </span> <math alttext="\mathcal{O}(N)" class="ltx_Math" display="inline" id="alg2.2.m1.1"><semantics id="alg2.2.m1.1b"><mrow id="alg2.2.m1.1.2" xref="alg2.2.m1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.2.m1.1.2.2" xref="alg2.2.m1.1.2.2.cmml">𝒪</mi><mo id="alg2.2.m1.1.2.1" xref="alg2.2.m1.1.2.1.cmml">⁢</mo><mrow id="alg2.2.m1.1.2.3.2" xref="alg2.2.m1.1.2.cmml"><mo id="alg2.2.m1.1.2.3.2.1" stretchy="false" xref="alg2.2.m1.1.2.cmml">(</mo><mi id="alg2.2.m1.1.1" xref="alg2.2.m1.1.1.cmml">N</mi><mo id="alg2.2.m1.1.2.3.2.2" stretchy="false" xref="alg2.2.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.2.m1.1c"><apply id="alg2.2.m1.1.2.cmml" xref="alg2.2.m1.1.2"><times id="alg2.2.m1.1.2.1.cmml" xref="alg2.2.m1.1.2.1"></times><ci id="alg2.2.m1.1.2.2.cmml" xref="alg2.2.m1.1.2.2">𝒪</ci><ci id="alg2.2.m1.1.1.cmml" xref="alg2.2.m1.1.1">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.2.m1.1d">\mathcal{O}(N)</annotation><annotation encoding="application/x-llamapun" id="alg2.2.m1.1e">caligraphic_O ( italic_N )</annotation></semantics></math> topological masking with <em class="ltx_emph ltx_font_italic" id="alg2.16.2">asymmetric</em> GRFs</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel" id="alg2.12"><span class="ltx_text ltx_font_bold" id="alg2.12.1">Input:</span> query matrix <math alttext="\mathbf{Q}\in\mathbb{R}^{N\times d}" class="ltx_Math" display="inline" id="alg2.3.m1.1"><semantics id="alg2.3.m1.1a"><mrow id="alg2.3.m1.1.1" xref="alg2.3.m1.1.1.cmml"><mi id="alg2.3.m1.1.1.2" xref="alg2.3.m1.1.1.2.cmml">𝐐</mi><mo id="alg2.3.m1.1.1.1" xref="alg2.3.m1.1.1.1.cmml">∈</mo><msup id="alg2.3.m1.1.1.3" xref="alg2.3.m1.1.1.3.cmml"><mi id="alg2.3.m1.1.1.3.2" xref="alg2.3.m1.1.1.3.2.cmml">ℝ</mi><mrow id="alg2.3.m1.1.1.3.3" xref="alg2.3.m1.1.1.3.3.cmml"><mi id="alg2.3.m1.1.1.3.3.2" xref="alg2.3.m1.1.1.3.3.2.cmml">N</mi><mo id="alg2.3.m1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="alg2.3.m1.1.1.3.3.1.cmml">×</mo><mi id="alg2.3.m1.1.1.3.3.3" xref="alg2.3.m1.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="alg2.3.m1.1b"><apply id="alg2.3.m1.1.1.cmml" xref="alg2.3.m1.1.1"><in id="alg2.3.m1.1.1.1.cmml" xref="alg2.3.m1.1.1.1"></in><ci id="alg2.3.m1.1.1.2.cmml" xref="alg2.3.m1.1.1.2">𝐐</ci><apply id="alg2.3.m1.1.1.3.cmml" xref="alg2.3.m1.1.1.3"><csymbol cd="ambiguous" id="alg2.3.m1.1.1.3.1.cmml" xref="alg2.3.m1.1.1.3">superscript</csymbol><ci id="alg2.3.m1.1.1.3.2.cmml" xref="alg2.3.m1.1.1.3.2">ℝ</ci><apply id="alg2.3.m1.1.1.3.3.cmml" xref="alg2.3.m1.1.1.3.3"><times id="alg2.3.m1.1.1.3.3.1.cmml" xref="alg2.3.m1.1.1.3.3.1"></times><ci id="alg2.3.m1.1.1.3.3.2.cmml" xref="alg2.3.m1.1.1.3.3.2">𝑁</ci><ci id="alg2.3.m1.1.1.3.3.3.cmml" xref="alg2.3.m1.1.1.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.3.m1.1c">\mathbf{Q}\in\mathbb{R}^{N\times d}</annotation><annotation encoding="application/x-llamapun" id="alg2.3.m1.1d">bold_Q ∈ blackboard_R start_POSTSUPERSCRIPT italic_N × italic_d end_POSTSUPERSCRIPT</annotation></semantics></math>, key matrix <math alttext="\mathbf{K}\in\mathbb{R}^{N\times d}" class="ltx_Math" display="inline" id="alg2.4.m2.1"><semantics id="alg2.4.m2.1a"><mrow id="alg2.4.m2.1.1" xref="alg2.4.m2.1.1.cmml"><mi id="alg2.4.m2.1.1.2" xref="alg2.4.m2.1.1.2.cmml">𝐊</mi><mo id="alg2.4.m2.1.1.1" xref="alg2.4.m2.1.1.1.cmml">∈</mo><msup id="alg2.4.m2.1.1.3" xref="alg2.4.m2.1.1.3.cmml"><mi id="alg2.4.m2.1.1.3.2" xref="alg2.4.m2.1.1.3.2.cmml">ℝ</mi><mrow id="alg2.4.m2.1.1.3.3" xref="alg2.4.m2.1.1.3.3.cmml"><mi id="alg2.4.m2.1.1.3.3.2" xref="alg2.4.m2.1.1.3.3.2.cmml">N</mi><mo id="alg2.4.m2.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="alg2.4.m2.1.1.3.3.1.cmml">×</mo><mi id="alg2.4.m2.1.1.3.3.3" xref="alg2.4.m2.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="alg2.4.m2.1b"><apply id="alg2.4.m2.1.1.cmml" xref="alg2.4.m2.1.1"><in id="alg2.4.m2.1.1.1.cmml" xref="alg2.4.m2.1.1.1"></in><ci id="alg2.4.m2.1.1.2.cmml" xref="alg2.4.m2.1.1.2">𝐊</ci><apply id="alg2.4.m2.1.1.3.cmml" xref="alg2.4.m2.1.1.3"><csymbol cd="ambiguous" id="alg2.4.m2.1.1.3.1.cmml" xref="alg2.4.m2.1.1.3">superscript</csymbol><ci id="alg2.4.m2.1.1.3.2.cmml" xref="alg2.4.m2.1.1.3.2">ℝ</ci><apply id="alg2.4.m2.1.1.3.3.cmml" xref="alg2.4.m2.1.1.3.3"><times id="alg2.4.m2.1.1.3.3.1.cmml" xref="alg2.4.m2.1.1.3.3.1"></times><ci id="alg2.4.m2.1.1.3.3.2.cmml" xref="alg2.4.m2.1.1.3.3.2">𝑁</ci><ci id="alg2.4.m2.1.1.3.3.3.cmml" xref="alg2.4.m2.1.1.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.4.m2.1c">\mathbf{K}\in\mathbb{R}^{N\times d}</annotation><annotation encoding="application/x-llamapun" id="alg2.4.m2.1d">bold_K ∈ blackboard_R start_POSTSUPERSCRIPT italic_N × italic_d end_POSTSUPERSCRIPT</annotation></semantics></math>, value matrix <math alttext="\mathbf{V}\in\mathbb{R}^{N\times d}" class="ltx_Math" display="inline" id="alg2.5.m3.1"><semantics id="alg2.5.m3.1a"><mrow id="alg2.5.m3.1.1" xref="alg2.5.m3.1.1.cmml"><mi id="alg2.5.m3.1.1.2" xref="alg2.5.m3.1.1.2.cmml">𝐕</mi><mo id="alg2.5.m3.1.1.1" xref="alg2.5.m3.1.1.1.cmml">∈</mo><msup id="alg2.5.m3.1.1.3" xref="alg2.5.m3.1.1.3.cmml"><mi id="alg2.5.m3.1.1.3.2" xref="alg2.5.m3.1.1.3.2.cmml">ℝ</mi><mrow id="alg2.5.m3.1.1.3.3" xref="alg2.5.m3.1.1.3.3.cmml"><mi id="alg2.5.m3.1.1.3.3.2" xref="alg2.5.m3.1.1.3.3.2.cmml">N</mi><mo id="alg2.5.m3.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="alg2.5.m3.1.1.3.3.1.cmml">×</mo><mi id="alg2.5.m3.1.1.3.3.3" xref="alg2.5.m3.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="alg2.5.m3.1b"><apply id="alg2.5.m3.1.1.cmml" xref="alg2.5.m3.1.1"><in id="alg2.5.m3.1.1.1.cmml" xref="alg2.5.m3.1.1.1"></in><ci id="alg2.5.m3.1.1.2.cmml" xref="alg2.5.m3.1.1.2">𝐕</ci><apply id="alg2.5.m3.1.1.3.cmml" xref="alg2.5.m3.1.1.3"><csymbol cd="ambiguous" id="alg2.5.m3.1.1.3.1.cmml" xref="alg2.5.m3.1.1.3">superscript</csymbol><ci id="alg2.5.m3.1.1.3.2.cmml" xref="alg2.5.m3.1.1.3.2">ℝ</ci><apply id="alg2.5.m3.1.1.3.3.cmml" xref="alg2.5.m3.1.1.3.3"><times id="alg2.5.m3.1.1.3.3.1.cmml" xref="alg2.5.m3.1.1.3.3.1"></times><ci id="alg2.5.m3.1.1.3.3.2.cmml" xref="alg2.5.m3.1.1.3.3.2">𝑁</ci><ci id="alg2.5.m3.1.1.3.3.3.cmml" xref="alg2.5.m3.1.1.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.5.m3.1c">\mathbf{V}\in\mathbb{R}^{N\times d}</annotation><annotation encoding="application/x-llamapun" id="alg2.5.m3.1d">bold_V ∈ blackboard_R start_POSTSUPERSCRIPT italic_N × italic_d end_POSTSUPERSCRIPT</annotation></semantics></math>, graph <math alttext="\mathcal{G}" class="ltx_Math" display="inline" id="alg2.6.m4.1"><semantics id="alg2.6.m4.1a"><mi class="ltx_font_mathcaligraphic" id="alg2.6.m4.1.1" xref="alg2.6.m4.1.1.cmml">𝒢</mi><annotation-xml encoding="MathML-Content" id="alg2.6.m4.1b"><ci id="alg2.6.m4.1.1.cmml" xref="alg2.6.m4.1.1">𝒢</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.6.m4.1c">\mathcal{G}</annotation><annotation encoding="application/x-llamapun" id="alg2.6.m4.1d">caligraphic_G</annotation></semantics></math> with weighted adjacency matrix <math alttext="\mathbf{W}\in\mathbb{R}^{N\times N}" class="ltx_Math" display="inline" id="alg2.7.m5.1"><semantics id="alg2.7.m5.1a"><mrow id="alg2.7.m5.1.1" xref="alg2.7.m5.1.1.cmml"><mi id="alg2.7.m5.1.1.2" xref="alg2.7.m5.1.1.2.cmml">𝐖</mi><mo id="alg2.7.m5.1.1.1" xref="alg2.7.m5.1.1.1.cmml">∈</mo><msup id="alg2.7.m5.1.1.3" xref="alg2.7.m5.1.1.3.cmml"><mi id="alg2.7.m5.1.1.3.2" xref="alg2.7.m5.1.1.3.2.cmml">ℝ</mi><mrow id="alg2.7.m5.1.1.3.3" xref="alg2.7.m5.1.1.3.3.cmml"><mi id="alg2.7.m5.1.1.3.3.2" xref="alg2.7.m5.1.1.3.3.2.cmml">N</mi><mo id="alg2.7.m5.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="alg2.7.m5.1.1.3.3.1.cmml">×</mo><mi id="alg2.7.m5.1.1.3.3.3" xref="alg2.7.m5.1.1.3.3.3.cmml">N</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="alg2.7.m5.1b"><apply id="alg2.7.m5.1.1.cmml" xref="alg2.7.m5.1.1"><in id="alg2.7.m5.1.1.1.cmml" xref="alg2.7.m5.1.1.1"></in><ci id="alg2.7.m5.1.1.2.cmml" xref="alg2.7.m5.1.1.2">𝐖</ci><apply id="alg2.7.m5.1.1.3.cmml" xref="alg2.7.m5.1.1.3"><csymbol cd="ambiguous" id="alg2.7.m5.1.1.3.1.cmml" xref="alg2.7.m5.1.1.3">superscript</csymbol><ci id="alg2.7.m5.1.1.3.2.cmml" xref="alg2.7.m5.1.1.3.2">ℝ</ci><apply id="alg2.7.m5.1.1.3.3.cmml" xref="alg2.7.m5.1.1.3.3"><times id="alg2.7.m5.1.1.3.3.1.cmml" xref="alg2.7.m5.1.1.3.3.1"></times><ci id="alg2.7.m5.1.1.3.3.2.cmml" xref="alg2.7.m5.1.1.3.3.2">𝑁</ci><ci id="alg2.7.m5.1.1.3.3.3.cmml" xref="alg2.7.m5.1.1.3.3.3">𝑁</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.7.m5.1c">\mathbf{W}\in\mathbb{R}^{N\times N}</annotation><annotation encoding="application/x-llamapun" id="alg2.7.m5.1d">bold_W ∈ blackboard_R start_POSTSUPERSCRIPT italic_N × italic_N end_POSTSUPERSCRIPT</annotation></semantics></math>, learnable mask parameters <math alttext="\{f_{i}\}_{i=0}^{i_{\textrm{max}}}" class="ltx_Math" display="inline" id="alg2.8.m6.1"><semantics id="alg2.8.m6.1a"><msubsup id="alg2.8.m6.1.1" xref="alg2.8.m6.1.1.cmml"><mrow id="alg2.8.m6.1.1.1.1.1" xref="alg2.8.m6.1.1.1.1.2.cmml"><mo id="alg2.8.m6.1.1.1.1.1.2" stretchy="false" xref="alg2.8.m6.1.1.1.1.2.cmml">{</mo><msub id="alg2.8.m6.1.1.1.1.1.1" xref="alg2.8.m6.1.1.1.1.1.1.cmml"><mi id="alg2.8.m6.1.1.1.1.1.1.2" xref="alg2.8.m6.1.1.1.1.1.1.2.cmml">f</mi><mi id="alg2.8.m6.1.1.1.1.1.1.3" xref="alg2.8.m6.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="alg2.8.m6.1.1.1.1.1.3" stretchy="false" xref="alg2.8.m6.1.1.1.1.2.cmml">}</mo></mrow><mrow id="alg2.8.m6.1.1.1.3" xref="alg2.8.m6.1.1.1.3.cmml"><mi id="alg2.8.m6.1.1.1.3.2" xref="alg2.8.m6.1.1.1.3.2.cmml">i</mi><mo id="alg2.8.m6.1.1.1.3.1" xref="alg2.8.m6.1.1.1.3.1.cmml">=</mo><mn id="alg2.8.m6.1.1.1.3.3" xref="alg2.8.m6.1.1.1.3.3.cmml">0</mn></mrow><msub id="alg2.8.m6.1.1.3" xref="alg2.8.m6.1.1.3.cmml"><mi id="alg2.8.m6.1.1.3.2" xref="alg2.8.m6.1.1.3.2.cmml">i</mi><mtext id="alg2.8.m6.1.1.3.3" xref="alg2.8.m6.1.1.3.3a.cmml">max</mtext></msub></msubsup><annotation-xml encoding="MathML-Content" id="alg2.8.m6.1b"><apply id="alg2.8.m6.1.1.cmml" xref="alg2.8.m6.1.1"><csymbol cd="ambiguous" id="alg2.8.m6.1.1.2.cmml" xref="alg2.8.m6.1.1">superscript</csymbol><apply id="alg2.8.m6.1.1.1.cmml" xref="alg2.8.m6.1.1"><csymbol cd="ambiguous" id="alg2.8.m6.1.1.1.2.cmml" xref="alg2.8.m6.1.1">subscript</csymbol><set id="alg2.8.m6.1.1.1.1.2.cmml" xref="alg2.8.m6.1.1.1.1.1"><apply id="alg2.8.m6.1.1.1.1.1.1.cmml" xref="alg2.8.m6.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.8.m6.1.1.1.1.1.1.1.cmml" xref="alg2.8.m6.1.1.1.1.1.1">subscript</csymbol><ci id="alg2.8.m6.1.1.1.1.1.1.2.cmml" xref="alg2.8.m6.1.1.1.1.1.1.2">𝑓</ci><ci id="alg2.8.m6.1.1.1.1.1.1.3.cmml" xref="alg2.8.m6.1.1.1.1.1.1.3">𝑖</ci></apply></set><apply id="alg2.8.m6.1.1.1.3.cmml" xref="alg2.8.m6.1.1.1.3"><eq id="alg2.8.m6.1.1.1.3.1.cmml" xref="alg2.8.m6.1.1.1.3.1"></eq><ci id="alg2.8.m6.1.1.1.3.2.cmml" xref="alg2.8.m6.1.1.1.3.2">𝑖</ci><cn id="alg2.8.m6.1.1.1.3.3.cmml" type="integer" xref="alg2.8.m6.1.1.1.3.3">0</cn></apply></apply><apply id="alg2.8.m6.1.1.3.cmml" xref="alg2.8.m6.1.1.3"><csymbol cd="ambiguous" id="alg2.8.m6.1.1.3.1.cmml" xref="alg2.8.m6.1.1.3">subscript</csymbol><ci id="alg2.8.m6.1.1.3.2.cmml" xref="alg2.8.m6.1.1.3.2">𝑖</ci><ci id="alg2.8.m6.1.1.3.3a.cmml" xref="alg2.8.m6.1.1.3.3"><mtext id="alg2.8.m6.1.1.3.3.cmml" mathsize="50%" xref="alg2.8.m6.1.1.3.3">max</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.8.m6.1c">\{f_{i}\}_{i=0}^{i_{\textrm{max}}}</annotation><annotation encoding="application/x-llamapun" id="alg2.8.m6.1d">{ italic_f start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT } start_POSTSUBSCRIPT italic_i = 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i start_POSTSUBSCRIPT max end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>, number of random walks to sample <math alttext="n\in\mathbb{N}" class="ltx_Math" display="inline" id="alg2.9.m7.1"><semantics id="alg2.9.m7.1a"><mrow id="alg2.9.m7.1.1" xref="alg2.9.m7.1.1.cmml"><mi id="alg2.9.m7.1.1.2" xref="alg2.9.m7.1.1.2.cmml">n</mi><mo id="alg2.9.m7.1.1.1" xref="alg2.9.m7.1.1.1.cmml">∈</mo><mi id="alg2.9.m7.1.1.3" xref="alg2.9.m7.1.1.3.cmml">ℕ</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.9.m7.1b"><apply id="alg2.9.m7.1.1.cmml" xref="alg2.9.m7.1.1"><in id="alg2.9.m7.1.1.1.cmml" xref="alg2.9.m7.1.1.1"></in><ci id="alg2.9.m7.1.1.2.cmml" xref="alg2.9.m7.1.1.2">𝑛</ci><ci id="alg2.9.m7.1.1.3.cmml" xref="alg2.9.m7.1.1.3">ℕ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.9.m7.1c">n\in\mathbb{N}</annotation><annotation encoding="application/x-llamapun" id="alg2.9.m7.1d">italic_n ∈ blackboard_N</annotation></semantics></math>, query/key feature map <math alttext="\phi(\cdot):\mathbb{R}^{d}\to\mathbb{R}^{m}" class="ltx_Math" display="inline" id="alg2.10.m8.1"><semantics id="alg2.10.m8.1a"><mrow id="alg2.10.m8.1.2" xref="alg2.10.m8.1.2.cmml"><mrow id="alg2.10.m8.1.2.2" xref="alg2.10.m8.1.2.2.cmml"><mi id="alg2.10.m8.1.2.2.2" xref="alg2.10.m8.1.2.2.2.cmml">ϕ</mi><mo id="alg2.10.m8.1.2.2.1" xref="alg2.10.m8.1.2.2.1.cmml">⁢</mo><mrow id="alg2.10.m8.1.2.2.3.2" xref="alg2.10.m8.1.2.2.cmml"><mo id="alg2.10.m8.1.2.2.3.2.1" stretchy="false" xref="alg2.10.m8.1.2.2.cmml">(</mo><mo id="alg2.10.m8.1.1" lspace="0em" rspace="0em" xref="alg2.10.m8.1.1.cmml">⋅</mo><mo id="alg2.10.m8.1.2.2.3.2.2" rspace="0.278em" stretchy="false" xref="alg2.10.m8.1.2.2.cmml">)</mo></mrow></mrow><mo id="alg2.10.m8.1.2.1" rspace="0.278em" xref="alg2.10.m8.1.2.1.cmml">:</mo><mrow id="alg2.10.m8.1.2.3" xref="alg2.10.m8.1.2.3.cmml"><msup id="alg2.10.m8.1.2.3.2" xref="alg2.10.m8.1.2.3.2.cmml"><mi id="alg2.10.m8.1.2.3.2.2" xref="alg2.10.m8.1.2.3.2.2.cmml">ℝ</mi><mi id="alg2.10.m8.1.2.3.2.3" xref="alg2.10.m8.1.2.3.2.3.cmml">d</mi></msup><mo id="alg2.10.m8.1.2.3.1" stretchy="false" xref="alg2.10.m8.1.2.3.1.cmml">→</mo><msup id="alg2.10.m8.1.2.3.3" xref="alg2.10.m8.1.2.3.3.cmml"><mi id="alg2.10.m8.1.2.3.3.2" xref="alg2.10.m8.1.2.3.3.2.cmml">ℝ</mi><mi id="alg2.10.m8.1.2.3.3.3" xref="alg2.10.m8.1.2.3.3.3.cmml">m</mi></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.10.m8.1b"><apply id="alg2.10.m8.1.2.cmml" xref="alg2.10.m8.1.2"><ci id="alg2.10.m8.1.2.1.cmml" xref="alg2.10.m8.1.2.1">:</ci><apply id="alg2.10.m8.1.2.2.cmml" xref="alg2.10.m8.1.2.2"><times id="alg2.10.m8.1.2.2.1.cmml" xref="alg2.10.m8.1.2.2.1"></times><ci id="alg2.10.m8.1.2.2.2.cmml" xref="alg2.10.m8.1.2.2.2">italic-ϕ</ci><ci id="alg2.10.m8.1.1.cmml" xref="alg2.10.m8.1.1">⋅</ci></apply><apply id="alg2.10.m8.1.2.3.cmml" xref="alg2.10.m8.1.2.3"><ci id="alg2.10.m8.1.2.3.1.cmml" xref="alg2.10.m8.1.2.3.1">→</ci><apply id="alg2.10.m8.1.2.3.2.cmml" xref="alg2.10.m8.1.2.3.2"><csymbol cd="ambiguous" id="alg2.10.m8.1.2.3.2.1.cmml" xref="alg2.10.m8.1.2.3.2">superscript</csymbol><ci id="alg2.10.m8.1.2.3.2.2.cmml" xref="alg2.10.m8.1.2.3.2.2">ℝ</ci><ci id="alg2.10.m8.1.2.3.2.3.cmml" xref="alg2.10.m8.1.2.3.2.3">𝑑</ci></apply><apply id="alg2.10.m8.1.2.3.3.cmml" xref="alg2.10.m8.1.2.3.3"><csymbol cd="ambiguous" id="alg2.10.m8.1.2.3.3.1.cmml" xref="alg2.10.m8.1.2.3.3">superscript</csymbol><ci id="alg2.10.m8.1.2.3.3.2.cmml" xref="alg2.10.m8.1.2.3.3.2">ℝ</ci><ci id="alg2.10.m8.1.2.3.3.3.cmml" xref="alg2.10.m8.1.2.3.3.3">𝑚</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.10.m8.1c">\phi(\cdot):\mathbb{R}^{d}\to\mathbb{R}^{m}</annotation><annotation encoding="application/x-llamapun" id="alg2.10.m8.1d">italic_ϕ ( ⋅ ) : blackboard_R start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT → blackboard_R start_POSTSUPERSCRIPT italic_m end_POSTSUPERSCRIPT</annotation></semantics></math>. 
<br class="ltx_break"><span class="ltx_text ltx_font_bold" id="alg2.12.2">Output:</span> masked attention <math alttext="\textrm{Att}_{\textrm{LR},\widehat{\mathbf{M}}}(\mathbf{Q},\mathbf{K},\mathbf{%
V},\mathcal{G})" class="ltx_Math" display="inline" id="alg2.11.m9.6"><semantics id="alg2.11.m9.6a"><mrow id="alg2.11.m9.6.7" xref="alg2.11.m9.6.7.cmml"><msub id="alg2.11.m9.6.7.2" xref="alg2.11.m9.6.7.2.cmml"><mtext id="alg2.11.m9.6.7.2.2" xref="alg2.11.m9.6.7.2.2a.cmml">Att</mtext><mrow id="alg2.11.m9.2.2.2.4" xref="alg2.11.m9.2.2.2.3.cmml"><mtext id="alg2.11.m9.1.1.1.1" xref="alg2.11.m9.1.1.1.1a.cmml">LR</mtext><mo id="alg2.11.m9.2.2.2.4.1" xref="alg2.11.m9.2.2.2.3.cmml">,</mo><mover accent="true" id="alg2.11.m9.2.2.2.2" xref="alg2.11.m9.2.2.2.2.cmml"><mi id="alg2.11.m9.2.2.2.2.2" xref="alg2.11.m9.2.2.2.2.2.cmml">𝐌</mi><mo id="alg2.11.m9.2.2.2.2.1" xref="alg2.11.m9.2.2.2.2.1.cmml">^</mo></mover></mrow></msub><mo id="alg2.11.m9.6.7.1" xref="alg2.11.m9.6.7.1.cmml">⁢</mo><mrow id="alg2.11.m9.6.7.3.2" xref="alg2.11.m9.6.7.3.1.cmml"><mo id="alg2.11.m9.6.7.3.2.1" stretchy="false" xref="alg2.11.m9.6.7.3.1.cmml">(</mo><mi id="alg2.11.m9.3.3" xref="alg2.11.m9.3.3.cmml">𝐐</mi><mo id="alg2.11.m9.6.7.3.2.2" xref="alg2.11.m9.6.7.3.1.cmml">,</mo><mi id="alg2.11.m9.4.4" xref="alg2.11.m9.4.4.cmml">𝐊</mi><mo id="alg2.11.m9.6.7.3.2.3" xref="alg2.11.m9.6.7.3.1.cmml">,</mo><mi id="alg2.11.m9.5.5" xref="alg2.11.m9.5.5.cmml">𝐕</mi><mo id="alg2.11.m9.6.7.3.2.4" xref="alg2.11.m9.6.7.3.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="alg2.11.m9.6.6" xref="alg2.11.m9.6.6.cmml">𝒢</mi><mo id="alg2.11.m9.6.7.3.2.5" stretchy="false" xref="alg2.11.m9.6.7.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.11.m9.6b"><apply id="alg2.11.m9.6.7.cmml" xref="alg2.11.m9.6.7"><times id="alg2.11.m9.6.7.1.cmml" xref="alg2.11.m9.6.7.1"></times><apply id="alg2.11.m9.6.7.2.cmml" xref="alg2.11.m9.6.7.2"><csymbol cd="ambiguous" id="alg2.11.m9.6.7.2.1.cmml" xref="alg2.11.m9.6.7.2">subscript</csymbol><ci id="alg2.11.m9.6.7.2.2a.cmml" xref="alg2.11.m9.6.7.2.2"><mtext id="alg2.11.m9.6.7.2.2.cmml" xref="alg2.11.m9.6.7.2.2">Att</mtext></ci><list id="alg2.11.m9.2.2.2.3.cmml" xref="alg2.11.m9.2.2.2.4"><ci id="alg2.11.m9.1.1.1.1a.cmml" xref="alg2.11.m9.1.1.1.1"><mtext id="alg2.11.m9.1.1.1.1.cmml" mathsize="70%" xref="alg2.11.m9.1.1.1.1">LR</mtext></ci><apply id="alg2.11.m9.2.2.2.2.cmml" xref="alg2.11.m9.2.2.2.2"><ci id="alg2.11.m9.2.2.2.2.1.cmml" xref="alg2.11.m9.2.2.2.2.1">^</ci><ci id="alg2.11.m9.2.2.2.2.2.cmml" xref="alg2.11.m9.2.2.2.2.2">𝐌</ci></apply></list></apply><vector id="alg2.11.m9.6.7.3.1.cmml" xref="alg2.11.m9.6.7.3.2"><ci id="alg2.11.m9.3.3.cmml" xref="alg2.11.m9.3.3">𝐐</ci><ci id="alg2.11.m9.4.4.cmml" xref="alg2.11.m9.4.4">𝐊</ci><ci id="alg2.11.m9.5.5.cmml" xref="alg2.11.m9.5.5">𝐕</ci><ci id="alg2.11.m9.6.6.cmml" xref="alg2.11.m9.6.6">𝒢</ci></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.11.m9.6c">\textrm{Att}_{\textrm{LR},\widehat{\mathbf{M}}}(\mathbf{Q},\mathbf{K},\mathbf{%
V},\mathcal{G})</annotation><annotation encoding="application/x-llamapun" id="alg2.11.m9.6d">Att start_POSTSUBSCRIPT LR , over^ start_ARG bold_M end_ARG end_POSTSUBSCRIPT ( bold_Q , bold_K , bold_V , caligraphic_G )</annotation></semantics></math> in <math alttext="\mathcal{O}(N)" class="ltx_Math" display="inline" id="alg2.12.m10.1"><semantics id="alg2.12.m10.1a"><mrow id="alg2.12.m10.1.2" xref="alg2.12.m10.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.12.m10.1.2.2" xref="alg2.12.m10.1.2.2.cmml">𝒪</mi><mo id="alg2.12.m10.1.2.1" xref="alg2.12.m10.1.2.1.cmml">⁢</mo><mrow id="alg2.12.m10.1.2.3.2" xref="alg2.12.m10.1.2.cmml"><mo id="alg2.12.m10.1.2.3.2.1" stretchy="false" xref="alg2.12.m10.1.2.cmml">(</mo><mi id="alg2.12.m10.1.1" xref="alg2.12.m10.1.1.cmml">N</mi><mo id="alg2.12.m10.1.2.3.2.2" stretchy="false" xref="alg2.12.m10.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.12.m10.1b"><apply id="alg2.12.m10.1.2.cmml" xref="alg2.12.m10.1.2"><times id="alg2.12.m10.1.2.1.cmml" xref="alg2.12.m10.1.2.1"></times><ci id="alg2.12.m10.1.2.2.cmml" xref="alg2.12.m10.1.2.2">𝒪</ci><ci id="alg2.12.m10.1.1.cmml" xref="alg2.12.m10.1.1">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.12.m10.1c">\mathcal{O}(N)</annotation><annotation encoding="application/x-llamapun" id="alg2.12.m10.1d">caligraphic_O ( italic_N )</annotation></semantics></math> time, without using sparse linear algebra libraries.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<div class="ltx_listing ltx_figure_panel ltx_listing" id="alg2.17">
<div class="ltx_listingline" id="alg2.l1">
<span class="ltx_tag ltx_tag_listingline">1:</span>Simulate <math alttext="n" class="ltx_Math" display="inline" id="alg2.l1.m1.1"><semantics id="alg2.l1.m1.1a"><mi id="alg2.l1.m1.1.1" xref="alg2.l1.m1.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="alg2.l1.m1.1b"><ci id="alg2.l1.m1.1.1.cmml" xref="alg2.l1.m1.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.m1.1c">n</annotation><annotation encoding="application/x-llamapun" id="alg2.l1.m1.1d">italic_n</annotation></semantics></math> terminating random walks <math alttext="\{\omega_{k}^{(i)}\}_{k=1}^{n}" class="ltx_Math" display="inline" id="alg2.l1.m2.2"><semantics id="alg2.l1.m2.2a"><msubsup id="alg2.l1.m2.2.2" xref="alg2.l1.m2.2.2.cmml"><mrow id="alg2.l1.m2.2.2.1.1.1" xref="alg2.l1.m2.2.2.1.1.2.cmml"><mo id="alg2.l1.m2.2.2.1.1.1.2" stretchy="false" xref="alg2.l1.m2.2.2.1.1.2.cmml">{</mo><msubsup id="alg2.l1.m2.2.2.1.1.1.1" xref="alg2.l1.m2.2.2.1.1.1.1.cmml"><mi id="alg2.l1.m2.2.2.1.1.1.1.2.2" xref="alg2.l1.m2.2.2.1.1.1.1.2.2.cmml">ω</mi><mi id="alg2.l1.m2.2.2.1.1.1.1.2.3" xref="alg2.l1.m2.2.2.1.1.1.1.2.3.cmml">k</mi><mrow id="alg2.l1.m2.1.1.1.3" xref="alg2.l1.m2.2.2.1.1.1.1.cmml"><mo id="alg2.l1.m2.1.1.1.3.1" stretchy="false" xref="alg2.l1.m2.2.2.1.1.1.1.cmml">(</mo><mi id="alg2.l1.m2.1.1.1.1" xref="alg2.l1.m2.1.1.1.1.cmml">i</mi><mo id="alg2.l1.m2.1.1.1.3.2" stretchy="false" xref="alg2.l1.m2.2.2.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="alg2.l1.m2.2.2.1.1.1.3" stretchy="false" xref="alg2.l1.m2.2.2.1.1.2.cmml">}</mo></mrow><mrow id="alg2.l1.m2.2.2.1.3" xref="alg2.l1.m2.2.2.1.3.cmml"><mi id="alg2.l1.m2.2.2.1.3.2" xref="alg2.l1.m2.2.2.1.3.2.cmml">k</mi><mo id="alg2.l1.m2.2.2.1.3.1" xref="alg2.l1.m2.2.2.1.3.1.cmml">=</mo><mn id="alg2.l1.m2.2.2.1.3.3" xref="alg2.l1.m2.2.2.1.3.3.cmml">1</mn></mrow><mi id="alg2.l1.m2.2.2.3" xref="alg2.l1.m2.2.2.3.cmml">n</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg2.l1.m2.2b"><apply id="alg2.l1.m2.2.2.cmml" xref="alg2.l1.m2.2.2"><csymbol cd="ambiguous" id="alg2.l1.m2.2.2.2.cmml" xref="alg2.l1.m2.2.2">superscript</csymbol><apply id="alg2.l1.m2.2.2.1.cmml" xref="alg2.l1.m2.2.2"><csymbol cd="ambiguous" id="alg2.l1.m2.2.2.1.2.cmml" xref="alg2.l1.m2.2.2">subscript</csymbol><set id="alg2.l1.m2.2.2.1.1.2.cmml" xref="alg2.l1.m2.2.2.1.1.1"><apply id="alg2.l1.m2.2.2.1.1.1.1.cmml" xref="alg2.l1.m2.2.2.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l1.m2.2.2.1.1.1.1.1.cmml" xref="alg2.l1.m2.2.2.1.1.1.1">superscript</csymbol><apply id="alg2.l1.m2.2.2.1.1.1.1.2.cmml" xref="alg2.l1.m2.2.2.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l1.m2.2.2.1.1.1.1.2.1.cmml" xref="alg2.l1.m2.2.2.1.1.1.1">subscript</csymbol><ci id="alg2.l1.m2.2.2.1.1.1.1.2.2.cmml" xref="alg2.l1.m2.2.2.1.1.1.1.2.2">𝜔</ci><ci id="alg2.l1.m2.2.2.1.1.1.1.2.3.cmml" xref="alg2.l1.m2.2.2.1.1.1.1.2.3">𝑘</ci></apply><ci id="alg2.l1.m2.1.1.1.1.cmml" xref="alg2.l1.m2.1.1.1.1">𝑖</ci></apply></set><apply id="alg2.l1.m2.2.2.1.3.cmml" xref="alg2.l1.m2.2.2.1.3"><eq id="alg2.l1.m2.2.2.1.3.1.cmml" xref="alg2.l1.m2.2.2.1.3.1"></eq><ci id="alg2.l1.m2.2.2.1.3.2.cmml" xref="alg2.l1.m2.2.2.1.3.2">𝑘</ci><cn id="alg2.l1.m2.2.2.1.3.3.cmml" type="integer" xref="alg2.l1.m2.2.2.1.3.3">1</cn></apply></apply><ci id="alg2.l1.m2.2.2.3.cmml" xref="alg2.l1.m2.2.2.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.m2.2c">\{\omega_{k}^{(i)}\}_{k=1}^{n}</annotation><annotation encoding="application/x-llamapun" id="alg2.l1.m2.2d">{ italic_ω start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT } start_POSTSUBSCRIPT italic_k = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT</annotation></semantics></math> out of every node <math alttext="v_{i}\in\mathcal{N}" class="ltx_Math" display="inline" id="alg2.l1.m3.1"><semantics id="alg2.l1.m3.1a"><mrow id="alg2.l1.m3.1.1" xref="alg2.l1.m3.1.1.cmml"><msub id="alg2.l1.m3.1.1.2" xref="alg2.l1.m3.1.1.2.cmml"><mi id="alg2.l1.m3.1.1.2.2" xref="alg2.l1.m3.1.1.2.2.cmml">v</mi><mi id="alg2.l1.m3.1.1.2.3" xref="alg2.l1.m3.1.1.2.3.cmml">i</mi></msub><mo id="alg2.l1.m3.1.1.1" xref="alg2.l1.m3.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="alg2.l1.m3.1.1.3" xref="alg2.l1.m3.1.1.3.cmml">𝒩</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.l1.m3.1b"><apply id="alg2.l1.m3.1.1.cmml" xref="alg2.l1.m3.1.1"><in id="alg2.l1.m3.1.1.1.cmml" xref="alg2.l1.m3.1.1.1"></in><apply id="alg2.l1.m3.1.1.2.cmml" xref="alg2.l1.m3.1.1.2"><csymbol cd="ambiguous" id="alg2.l1.m3.1.1.2.1.cmml" xref="alg2.l1.m3.1.1.2">subscript</csymbol><ci id="alg2.l1.m3.1.1.2.2.cmml" xref="alg2.l1.m3.1.1.2.2">𝑣</ci><ci id="alg2.l1.m3.1.1.2.3.cmml" xref="alg2.l1.m3.1.1.2.3">𝑖</ci></apply><ci id="alg2.l1.m3.1.1.3.cmml" xref="alg2.l1.m3.1.1.3">𝒩</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.m3.1c">v_{i}\in\mathcal{N}</annotation><annotation encoding="application/x-llamapun" id="alg2.l1.m3.1d">italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∈ caligraphic_N</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg2.l2">
<span class="ltx_tag ltx_tag_listingline">2:</span><span class="ltx_text ltx_font_bold" id="alg2.l2.1">for</span>&nbsp;<math alttext="v_{i}\in\mathcal{N}" class="ltx_Math" display="inline" id="alg2.l2.m1.1"><semantics id="alg2.l2.m1.1a"><mrow id="alg2.l2.m1.1.1" xref="alg2.l2.m1.1.1.cmml"><msub id="alg2.l2.m1.1.1.2" xref="alg2.l2.m1.1.1.2.cmml"><mi id="alg2.l2.m1.1.1.2.2" xref="alg2.l2.m1.1.1.2.2.cmml">v</mi><mi id="alg2.l2.m1.1.1.2.3" xref="alg2.l2.m1.1.1.2.3.cmml">i</mi></msub><mo id="alg2.l2.m1.1.1.1" xref="alg2.l2.m1.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="alg2.l2.m1.1.1.3" xref="alg2.l2.m1.1.1.3.cmml">𝒩</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.l2.m1.1b"><apply id="alg2.l2.m1.1.1.cmml" xref="alg2.l2.m1.1.1"><in id="alg2.l2.m1.1.1.1.cmml" xref="alg2.l2.m1.1.1.1"></in><apply id="alg2.l2.m1.1.1.2.cmml" xref="alg2.l2.m1.1.1.2"><csymbol cd="ambiguous" id="alg2.l2.m1.1.1.2.1.cmml" xref="alg2.l2.m1.1.1.2">subscript</csymbol><ci id="alg2.l2.m1.1.1.2.2.cmml" xref="alg2.l2.m1.1.1.2.2">𝑣</ci><ci id="alg2.l2.m1.1.1.2.3.cmml" xref="alg2.l2.m1.1.1.2.3">𝑖</ci></apply><ci id="alg2.l2.m1.1.1.3.cmml" xref="alg2.l2.m1.1.1.3">𝒩</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l2.m1.1c">v_{i}\in\mathcal{N}</annotation><annotation encoding="application/x-llamapun" id="alg2.l2.m1.1d">italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∈ caligraphic_N</annotation></semantics></math>&nbsp;<span class="ltx_text ltx_font_bold" id="alg2.l2.2">do</span>
</div>
<div class="ltx_listingline" id="alg2.l3">
<span class="ltx_tag ltx_tag_listingline">3:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Initialise output feature, <math alttext="\bm{f}_{i}\leftarrow\mathbf{0}_{d}" class="ltx_Math" display="inline" id="alg2.l3.m1.1"><semantics id="alg2.l3.m1.1a"><mrow id="alg2.l3.m1.1.1" xref="alg2.l3.m1.1.1.cmml"><msub id="alg2.l3.m1.1.1.2" xref="alg2.l3.m1.1.1.2.cmml"><mi id="alg2.l3.m1.1.1.2.2" xref="alg2.l3.m1.1.1.2.2.cmml">𝒇</mi><mi id="alg2.l3.m1.1.1.2.3" xref="alg2.l3.m1.1.1.2.3.cmml">i</mi></msub><mo id="alg2.l3.m1.1.1.1" stretchy="false" xref="alg2.l3.m1.1.1.1.cmml">←</mo><msub id="alg2.l3.m1.1.1.3" xref="alg2.l3.m1.1.1.3.cmml"><mn id="alg2.l3.m1.1.1.3.2" xref="alg2.l3.m1.1.1.3.2.cmml">𝟎</mn><mi id="alg2.l3.m1.1.1.3.3" xref="alg2.l3.m1.1.1.3.3.cmml">d</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="alg2.l3.m1.1b"><apply id="alg2.l3.m1.1.1.cmml" xref="alg2.l3.m1.1.1"><ci id="alg2.l3.m1.1.1.1.cmml" xref="alg2.l3.m1.1.1.1">←</ci><apply id="alg2.l3.m1.1.1.2.cmml" xref="alg2.l3.m1.1.1.2"><csymbol cd="ambiguous" id="alg2.l3.m1.1.1.2.1.cmml" xref="alg2.l3.m1.1.1.2">subscript</csymbol><ci id="alg2.l3.m1.1.1.2.2.cmml" xref="alg2.l3.m1.1.1.2.2">𝒇</ci><ci id="alg2.l3.m1.1.1.2.3.cmml" xref="alg2.l3.m1.1.1.2.3">𝑖</ci></apply><apply id="alg2.l3.m1.1.1.3.cmml" xref="alg2.l3.m1.1.1.3"><csymbol cd="ambiguous" id="alg2.l3.m1.1.1.3.1.cmml" xref="alg2.l3.m1.1.1.3">subscript</csymbol><cn id="alg2.l3.m1.1.1.3.2.cmml" type="integer" xref="alg2.l3.m1.1.1.3.2">0</cn><ci id="alg2.l3.m1.1.1.3.3.cmml" xref="alg2.l3.m1.1.1.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l3.m1.1c">\bm{f}_{i}\leftarrow\mathbf{0}_{d}</annotation><annotation encoding="application/x-llamapun" id="alg2.l3.m1.1d">bold_italic_f start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ← bold_0 start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg2.l4">
<span class="ltx_tag ltx_tag_listingline">4:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Initialise attention normalisation, <math alttext="S_{i}\leftarrow 0" class="ltx_Math" display="inline" id="alg2.l4.m1.1"><semantics id="alg2.l4.m1.1a"><mrow id="alg2.l4.m1.1.1" xref="alg2.l4.m1.1.1.cmml"><msub id="alg2.l4.m1.1.1.2" xref="alg2.l4.m1.1.1.2.cmml"><mi id="alg2.l4.m1.1.1.2.2" xref="alg2.l4.m1.1.1.2.2.cmml">S</mi><mi id="alg2.l4.m1.1.1.2.3" xref="alg2.l4.m1.1.1.2.3.cmml">i</mi></msub><mo id="alg2.l4.m1.1.1.1" stretchy="false" xref="alg2.l4.m1.1.1.1.cmml">←</mo><mn id="alg2.l4.m1.1.1.3" xref="alg2.l4.m1.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="alg2.l4.m1.1b"><apply id="alg2.l4.m1.1.1.cmml" xref="alg2.l4.m1.1.1"><ci id="alg2.l4.m1.1.1.1.cmml" xref="alg2.l4.m1.1.1.1">←</ci><apply id="alg2.l4.m1.1.1.2.cmml" xref="alg2.l4.m1.1.1.2"><csymbol cd="ambiguous" id="alg2.l4.m1.1.1.2.1.cmml" xref="alg2.l4.m1.1.1.2">subscript</csymbol><ci id="alg2.l4.m1.1.1.2.2.cmml" xref="alg2.l4.m1.1.1.2.2">𝑆</ci><ci id="alg2.l4.m1.1.1.2.3.cmml" xref="alg2.l4.m1.1.1.2.3">𝑖</ci></apply><cn id="alg2.l4.m1.1.1.3.cmml" type="integer" xref="alg2.l4.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l4.m1.1c">S_{i}\leftarrow 0</annotation><annotation encoding="application/x-llamapun" id="alg2.l4.m1.1d">italic_S start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ← 0</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg2.l5">
<span class="ltx_tag ltx_tag_listingline">5:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ltx_text ltx_font_bold" id="alg2.l5.1">for</span>&nbsp;<math alttext="\omega^{(i)}" class="ltx_Math" display="inline" id="alg2.l5.m1.1"><semantics id="alg2.l5.m1.1a"><msup id="alg2.l5.m1.1.2" xref="alg2.l5.m1.1.2.cmml"><mi id="alg2.l5.m1.1.2.2" xref="alg2.l5.m1.1.2.2.cmml">ω</mi><mrow id="alg2.l5.m1.1.1.1.3" xref="alg2.l5.m1.1.2.cmml"><mo id="alg2.l5.m1.1.1.1.3.1" stretchy="false" xref="alg2.l5.m1.1.2.cmml">(</mo><mi id="alg2.l5.m1.1.1.1.1" xref="alg2.l5.m1.1.1.1.1.cmml">i</mi><mo id="alg2.l5.m1.1.1.1.3.2" stretchy="false" xref="alg2.l5.m1.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="alg2.l5.m1.1b"><apply id="alg2.l5.m1.1.2.cmml" xref="alg2.l5.m1.1.2"><csymbol cd="ambiguous" id="alg2.l5.m1.1.2.1.cmml" xref="alg2.l5.m1.1.2">superscript</csymbol><ci id="alg2.l5.m1.1.2.2.cmml" xref="alg2.l5.m1.1.2.2">𝜔</ci><ci id="alg2.l5.m1.1.1.1.1.cmml" xref="alg2.l5.m1.1.1.1.1">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l5.m1.1c">\omega^{(i)}</annotation><annotation encoding="application/x-llamapun" id="alg2.l5.m1.1d">italic_ω start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT</annotation></semantics></math> in <math alttext="\{\omega_{k}^{(i)}\}_{k=1}^{n}" class="ltx_Math" display="inline" id="alg2.l5.m2.2"><semantics id="alg2.l5.m2.2a"><msubsup id="alg2.l5.m2.2.2" xref="alg2.l5.m2.2.2.cmml"><mrow id="alg2.l5.m2.2.2.1.1.1" xref="alg2.l5.m2.2.2.1.1.2.cmml"><mo id="alg2.l5.m2.2.2.1.1.1.2" stretchy="false" xref="alg2.l5.m2.2.2.1.1.2.cmml">{</mo><msubsup id="alg2.l5.m2.2.2.1.1.1.1" xref="alg2.l5.m2.2.2.1.1.1.1.cmml"><mi id="alg2.l5.m2.2.2.1.1.1.1.2.2" xref="alg2.l5.m2.2.2.1.1.1.1.2.2.cmml">ω</mi><mi id="alg2.l5.m2.2.2.1.1.1.1.2.3" xref="alg2.l5.m2.2.2.1.1.1.1.2.3.cmml">k</mi><mrow id="alg2.l5.m2.1.1.1.3" xref="alg2.l5.m2.2.2.1.1.1.1.cmml"><mo id="alg2.l5.m2.1.1.1.3.1" stretchy="false" xref="alg2.l5.m2.2.2.1.1.1.1.cmml">(</mo><mi id="alg2.l5.m2.1.1.1.1" xref="alg2.l5.m2.1.1.1.1.cmml">i</mi><mo id="alg2.l5.m2.1.1.1.3.2" stretchy="false" xref="alg2.l5.m2.2.2.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="alg2.l5.m2.2.2.1.1.1.3" stretchy="false" xref="alg2.l5.m2.2.2.1.1.2.cmml">}</mo></mrow><mrow id="alg2.l5.m2.2.2.1.3" xref="alg2.l5.m2.2.2.1.3.cmml"><mi id="alg2.l5.m2.2.2.1.3.2" xref="alg2.l5.m2.2.2.1.3.2.cmml">k</mi><mo id="alg2.l5.m2.2.2.1.3.1" xref="alg2.l5.m2.2.2.1.3.1.cmml">=</mo><mn id="alg2.l5.m2.2.2.1.3.3" xref="alg2.l5.m2.2.2.1.3.3.cmml">1</mn></mrow><mi id="alg2.l5.m2.2.2.3" xref="alg2.l5.m2.2.2.3.cmml">n</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg2.l5.m2.2b"><apply id="alg2.l5.m2.2.2.cmml" xref="alg2.l5.m2.2.2"><csymbol cd="ambiguous" id="alg2.l5.m2.2.2.2.cmml" xref="alg2.l5.m2.2.2">superscript</csymbol><apply id="alg2.l5.m2.2.2.1.cmml" xref="alg2.l5.m2.2.2"><csymbol cd="ambiguous" id="alg2.l5.m2.2.2.1.2.cmml" xref="alg2.l5.m2.2.2">subscript</csymbol><set id="alg2.l5.m2.2.2.1.1.2.cmml" xref="alg2.l5.m2.2.2.1.1.1"><apply id="alg2.l5.m2.2.2.1.1.1.1.cmml" xref="alg2.l5.m2.2.2.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l5.m2.2.2.1.1.1.1.1.cmml" xref="alg2.l5.m2.2.2.1.1.1.1">superscript</csymbol><apply id="alg2.l5.m2.2.2.1.1.1.1.2.cmml" xref="alg2.l5.m2.2.2.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l5.m2.2.2.1.1.1.1.2.1.cmml" xref="alg2.l5.m2.2.2.1.1.1.1">subscript</csymbol><ci id="alg2.l5.m2.2.2.1.1.1.1.2.2.cmml" xref="alg2.l5.m2.2.2.1.1.1.1.2.2">𝜔</ci><ci id="alg2.l5.m2.2.2.1.1.1.1.2.3.cmml" xref="alg2.l5.m2.2.2.1.1.1.1.2.3">𝑘</ci></apply><ci id="alg2.l5.m2.1.1.1.1.cmml" xref="alg2.l5.m2.1.1.1.1">𝑖</ci></apply></set><apply id="alg2.l5.m2.2.2.1.3.cmml" xref="alg2.l5.m2.2.2.1.3"><eq id="alg2.l5.m2.2.2.1.3.1.cmml" xref="alg2.l5.m2.2.2.1.3.1"></eq><ci id="alg2.l5.m2.2.2.1.3.2.cmml" xref="alg2.l5.m2.2.2.1.3.2">𝑘</ci><cn id="alg2.l5.m2.2.2.1.3.3.cmml" type="integer" xref="alg2.l5.m2.2.2.1.3.3">1</cn></apply></apply><ci id="alg2.l5.m2.2.2.3.cmml" xref="alg2.l5.m2.2.2.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l5.m2.2c">\{\omega_{k}^{(i)}\}_{k=1}^{n}</annotation><annotation encoding="application/x-llamapun" id="alg2.l5.m2.2d">{ italic_ω start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT } start_POSTSUBSCRIPT italic_k = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT</annotation></semantics></math>&nbsp;<span class="ltx_text ltx_font_bold" id="alg2.l5.2">do</span>
</div>
<div class="ltx_listingline" id="alg2.l6">
<span class="ltx_tag ltx_tag_listingline">6:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ltx_text ltx_font_bold" id="alg2.l6.1">for</span>&nbsp;<math alttext="(t,v_{j})" class="ltx_Math" display="inline" id="alg2.l6.m1.2"><semantics id="alg2.l6.m1.2a"><mrow id="alg2.l6.m1.2.2.1" xref="alg2.l6.m1.2.2.2.cmml"><mo id="alg2.l6.m1.2.2.1.2" stretchy="false" xref="alg2.l6.m1.2.2.2.cmml">(</mo><mi id="alg2.l6.m1.1.1" xref="alg2.l6.m1.1.1.cmml">t</mi><mo id="alg2.l6.m1.2.2.1.3" xref="alg2.l6.m1.2.2.2.cmml">,</mo><msub id="alg2.l6.m1.2.2.1.1" xref="alg2.l6.m1.2.2.1.1.cmml"><mi id="alg2.l6.m1.2.2.1.1.2" xref="alg2.l6.m1.2.2.1.1.2.cmml">v</mi><mi id="alg2.l6.m1.2.2.1.1.3" xref="alg2.l6.m1.2.2.1.1.3.cmml">j</mi></msub><mo id="alg2.l6.m1.2.2.1.4" stretchy="false" xref="alg2.l6.m1.2.2.2.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="alg2.l6.m1.2b"><interval closure="open" id="alg2.l6.m1.2.2.2.cmml" xref="alg2.l6.m1.2.2.1"><ci id="alg2.l6.m1.1.1.cmml" xref="alg2.l6.m1.1.1">𝑡</ci><apply id="alg2.l6.m1.2.2.1.1.cmml" xref="alg2.l6.m1.2.2.1.1"><csymbol cd="ambiguous" id="alg2.l6.m1.2.2.1.1.1.cmml" xref="alg2.l6.m1.2.2.1.1">subscript</csymbol><ci id="alg2.l6.m1.2.2.1.1.2.cmml" xref="alg2.l6.m1.2.2.1.1.2">𝑣</ci><ci id="alg2.l6.m1.2.2.1.1.3.cmml" xref="alg2.l6.m1.2.2.1.1.3">𝑗</ci></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="alg2.l6.m1.2c">(t,v_{j})</annotation><annotation encoding="application/x-llamapun" id="alg2.l6.m1.2d">( italic_t , italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT )</annotation></semantics></math> in enumerate(<math alttext="\omega^{(i)}" class="ltx_Math" display="inline" id="alg2.l6.m2.1"><semantics id="alg2.l6.m2.1a"><msup id="alg2.l6.m2.1.2" xref="alg2.l6.m2.1.2.cmml"><mi id="alg2.l6.m2.1.2.2" xref="alg2.l6.m2.1.2.2.cmml">ω</mi><mrow id="alg2.l6.m2.1.1.1.3" xref="alg2.l6.m2.1.2.cmml"><mo id="alg2.l6.m2.1.1.1.3.1" stretchy="false" xref="alg2.l6.m2.1.2.cmml">(</mo><mi id="alg2.l6.m2.1.1.1.1" xref="alg2.l6.m2.1.1.1.1.cmml">i</mi><mo id="alg2.l6.m2.1.1.1.3.2" stretchy="false" xref="alg2.l6.m2.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="alg2.l6.m2.1b"><apply id="alg2.l6.m2.1.2.cmml" xref="alg2.l6.m2.1.2"><csymbol cd="ambiguous" id="alg2.l6.m2.1.2.1.cmml" xref="alg2.l6.m2.1.2">superscript</csymbol><ci id="alg2.l6.m2.1.2.2.cmml" xref="alg2.l6.m2.1.2.2">𝜔</ci><ci id="alg2.l6.m2.1.1.1.1.cmml" xref="alg2.l6.m2.1.1.1.1">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l6.m2.1c">\omega^{(i)}</annotation><annotation encoding="application/x-llamapun" id="alg2.l6.m2.1d">italic_ω start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT</annotation></semantics></math>)&nbsp;<span class="ltx_text ltx_font_bold" id="alg2.l6.2">do</span>
</div>
<div class="ltx_listingline" id="alg2.l7">
<span class="ltx_tag ltx_tag_listingline">7:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<math alttext="\bm{f}_{i}" class="ltx_Math" display="inline" id="alg2.l7.m1.1"><semantics id="alg2.l7.m1.1a"><msub id="alg2.l7.m1.1.1" xref="alg2.l7.m1.1.1.cmml"><mi id="alg2.l7.m1.1.1.2" xref="alg2.l7.m1.1.1.2.cmml">𝒇</mi><mi id="alg2.l7.m1.1.1.3" xref="alg2.l7.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg2.l7.m1.1b"><apply id="alg2.l7.m1.1.1.cmml" xref="alg2.l7.m1.1.1"><csymbol cd="ambiguous" id="alg2.l7.m1.1.1.1.cmml" xref="alg2.l7.m1.1.1">subscript</csymbol><ci id="alg2.l7.m1.1.1.2.cmml" xref="alg2.l7.m1.1.1.2">𝒇</ci><ci id="alg2.l7.m1.1.1.3.cmml" xref="alg2.l7.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l7.m1.1c">\bm{f}_{i}</annotation><annotation encoding="application/x-llamapun" id="alg2.l7.m1.1d">bold_italic_f start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> += <math alttext="\phi(\bm{q}_{i})^{\top}\phi(\bm{k}_{j})\times f_{t}\times\frac{\widetilde{%
\omega}(\omega^{(i)}[:t])}{p(\omega^{(i)}[:t])}\times\bm{v}_{j}" class="ltx_math_unparsed" display="inline" id="alg2.l7.m2.4"><semantics id="alg2.l7.m2.4a"><mrow id="alg2.l7.m2.4.4"><mrow id="alg2.l7.m2.4.4.2"><mi id="alg2.l7.m2.4.4.2.4">ϕ</mi><mo id="alg2.l7.m2.4.4.2.3">⁢</mo><msup id="alg2.l7.m2.3.3.1.1"><mrow id="alg2.l7.m2.3.3.1.1.1.1"><mo id="alg2.l7.m2.3.3.1.1.1.1.2" stretchy="false">(</mo><msub id="alg2.l7.m2.3.3.1.1.1.1.1"><mi id="alg2.l7.m2.3.3.1.1.1.1.1.2">𝒒</mi><mi id="alg2.l7.m2.3.3.1.1.1.1.1.3">i</mi></msub><mo id="alg2.l7.m2.3.3.1.1.1.1.3" stretchy="false">)</mo></mrow><mo id="alg2.l7.m2.3.3.1.1.3">⊤</mo></msup><mo id="alg2.l7.m2.4.4.2.3a">⁢</mo><mi id="alg2.l7.m2.4.4.2.5">ϕ</mi><mo id="alg2.l7.m2.4.4.2.3b">⁢</mo><mrow id="alg2.l7.m2.4.4.2.2.1"><mo id="alg2.l7.m2.4.4.2.2.1.2" stretchy="false">(</mo><msub id="alg2.l7.m2.4.4.2.2.1.1"><mi id="alg2.l7.m2.4.4.2.2.1.1.2">𝒌</mi><mi id="alg2.l7.m2.4.4.2.2.1.1.3">j</mi></msub><mo id="alg2.l7.m2.4.4.2.2.1.3" rspace="0.055em" stretchy="false">)</mo></mrow></mrow><mo id="alg2.l7.m2.4.4.3" rspace="0.222em">×</mo><msub id="alg2.l7.m2.4.4.4"><mi id="alg2.l7.m2.4.4.4.2">f</mi><mi id="alg2.l7.m2.4.4.4.3">t</mi></msub><mo id="alg2.l7.m2.4.4.3a" lspace="0.222em" rspace="0.222em">×</mo><mfrac id="alg2.l7.m2.2.2"><mrow id="alg2.l7.m2.1.1.1"><mover accent="true" id="alg2.l7.m2.1.1.1.2"><mi id="alg2.l7.m2.1.1.1.2.2">ω</mi><mo id="alg2.l7.m2.1.1.1.2.1">~</mo></mover><mrow id="alg2.l7.m2.1.1.1.3"><mo id="alg2.l7.m2.1.1.1.3.1" stretchy="false">(</mo><msup id="alg2.l7.m2.1.1.1.3.2"><mi id="alg2.l7.m2.1.1.1.3.2.2">ω</mi><mrow id="alg2.l7.m2.1.1.1.1.1.3"><mo id="alg2.l7.m2.1.1.1.1.1.3.1" stretchy="false">(</mo><mi id="alg2.l7.m2.1.1.1.1.1.1">i</mi><mo id="alg2.l7.m2.1.1.1.1.1.3.2" stretchy="false">)</mo></mrow></msup><mrow id="alg2.l7.m2.1.1.1.3.3"><mo id="alg2.l7.m2.1.1.1.3.3.1" stretchy="false">[</mo><mo id="alg2.l7.m2.1.1.1.3.3.2" rspace="0.278em">:</mo><mi id="alg2.l7.m2.1.1.1.3.3.3">t</mi><mo id="alg2.l7.m2.1.1.1.3.3.4" stretchy="false">]</mo></mrow><mo id="alg2.l7.m2.1.1.1.3.4" stretchy="false">)</mo></mrow></mrow><mrow id="alg2.l7.m2.2.2.2"><mi id="alg2.l7.m2.2.2.2.2">p</mi><mrow id="alg2.l7.m2.2.2.2.3"><mo id="alg2.l7.m2.2.2.2.3.1" stretchy="false">(</mo><msup id="alg2.l7.m2.2.2.2.3.2"><mi id="alg2.l7.m2.2.2.2.3.2.2">ω</mi><mrow id="alg2.l7.m2.2.2.2.1.1.3"><mo id="alg2.l7.m2.2.2.2.1.1.3.1" stretchy="false">(</mo><mi id="alg2.l7.m2.2.2.2.1.1.1">i</mi><mo id="alg2.l7.m2.2.2.2.1.1.3.2" stretchy="false">)</mo></mrow></msup><mrow id="alg2.l7.m2.2.2.2.3.3"><mo id="alg2.l7.m2.2.2.2.3.3.1" stretchy="false">[</mo><mo id="alg2.l7.m2.2.2.2.3.3.2" rspace="0.278em">:</mo><mi id="alg2.l7.m2.2.2.2.3.3.3">t</mi><mo id="alg2.l7.m2.2.2.2.3.3.4" stretchy="false">]</mo></mrow><mo id="alg2.l7.m2.2.2.2.3.4" stretchy="false">)</mo></mrow></mrow></mfrac><mo id="alg2.l7.m2.4.4.3b" lspace="0.222em" rspace="0.222em">×</mo><msub id="alg2.l7.m2.4.4.5"><mi id="alg2.l7.m2.4.4.5.2">𝒗</mi><mi id="alg2.l7.m2.4.4.5.3">j</mi></msub></mrow><annotation encoding="application/x-tex" id="alg2.l7.m2.4b">\phi(\bm{q}_{i})^{\top}\phi(\bm{k}_{j})\times f_{t}\times\frac{\widetilde{%
\omega}(\omega^{(i)}[:t])}{p(\omega^{(i)}[:t])}\times\bm{v}_{j}</annotation><annotation encoding="application/x-llamapun" id="alg2.l7.m2.4c">italic_ϕ ( bold_italic_q start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT italic_ϕ ( bold_italic_k start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) × italic_f start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT × divide start_ARG over~ start_ARG italic_ω end_ARG ( italic_ω start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT [ : italic_t ] ) end_ARG start_ARG italic_p ( italic_ω start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT [ : italic_t ] ) end_ARG × bold_italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg2.l8">
<span class="ltx_tag ltx_tag_listingline">8:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<math alttext="S_{i}" class="ltx_Math" display="inline" id="alg2.l8.m1.1"><semantics id="alg2.l8.m1.1a"><msub id="alg2.l8.m1.1.1" xref="alg2.l8.m1.1.1.cmml"><mi id="alg2.l8.m1.1.1.2" xref="alg2.l8.m1.1.1.2.cmml">S</mi><mi id="alg2.l8.m1.1.1.3" xref="alg2.l8.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg2.l8.m1.1b"><apply id="alg2.l8.m1.1.1.cmml" xref="alg2.l8.m1.1.1"><csymbol cd="ambiguous" id="alg2.l8.m1.1.1.1.cmml" xref="alg2.l8.m1.1.1">subscript</csymbol><ci id="alg2.l8.m1.1.1.2.cmml" xref="alg2.l8.m1.1.1.2">𝑆</ci><ci id="alg2.l8.m1.1.1.3.cmml" xref="alg2.l8.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l8.m1.1c">S_{i}</annotation><annotation encoding="application/x-llamapun" id="alg2.l8.m1.1d">italic_S start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> += <math alttext="\phi(\bm{q}_{i})^{\top}\phi(\bm{k}_{j})\times f_{t}\times\frac{\widetilde{%
\omega}(\omega^{(i)}[:t])}{p(\omega^{(i)}[:t])}" class="ltx_math_unparsed" display="inline" id="alg2.l8.m2.4"><semantics id="alg2.l8.m2.4a"><mrow id="alg2.l8.m2.4.4"><mrow id="alg2.l8.m2.4.4.2"><mi id="alg2.l8.m2.4.4.2.4">ϕ</mi><mo id="alg2.l8.m2.4.4.2.3">⁢</mo><msup id="alg2.l8.m2.3.3.1.1"><mrow id="alg2.l8.m2.3.3.1.1.1.1"><mo id="alg2.l8.m2.3.3.1.1.1.1.2" stretchy="false">(</mo><msub id="alg2.l8.m2.3.3.1.1.1.1.1"><mi id="alg2.l8.m2.3.3.1.1.1.1.1.2">𝒒</mi><mi id="alg2.l8.m2.3.3.1.1.1.1.1.3">i</mi></msub><mo id="alg2.l8.m2.3.3.1.1.1.1.3" stretchy="false">)</mo></mrow><mo id="alg2.l8.m2.3.3.1.1.3">⊤</mo></msup><mo id="alg2.l8.m2.4.4.2.3a">⁢</mo><mi id="alg2.l8.m2.4.4.2.5">ϕ</mi><mo id="alg2.l8.m2.4.4.2.3b">⁢</mo><mrow id="alg2.l8.m2.4.4.2.2.1"><mo id="alg2.l8.m2.4.4.2.2.1.2" stretchy="false">(</mo><msub id="alg2.l8.m2.4.4.2.2.1.1"><mi id="alg2.l8.m2.4.4.2.2.1.1.2">𝒌</mi><mi id="alg2.l8.m2.4.4.2.2.1.1.3">j</mi></msub><mo id="alg2.l8.m2.4.4.2.2.1.3" rspace="0.055em" stretchy="false">)</mo></mrow></mrow><mo id="alg2.l8.m2.4.4.3" rspace="0.222em">×</mo><msub id="alg2.l8.m2.4.4.4"><mi id="alg2.l8.m2.4.4.4.2">f</mi><mi id="alg2.l8.m2.4.4.4.3">t</mi></msub><mo id="alg2.l8.m2.4.4.3a" lspace="0.222em" rspace="0.222em">×</mo><mfrac id="alg2.l8.m2.2.2"><mrow id="alg2.l8.m2.1.1.1"><mover accent="true" id="alg2.l8.m2.1.1.1.2"><mi id="alg2.l8.m2.1.1.1.2.2">ω</mi><mo id="alg2.l8.m2.1.1.1.2.1">~</mo></mover><mrow id="alg2.l8.m2.1.1.1.3"><mo id="alg2.l8.m2.1.1.1.3.1" stretchy="false">(</mo><msup id="alg2.l8.m2.1.1.1.3.2"><mi id="alg2.l8.m2.1.1.1.3.2.2">ω</mi><mrow id="alg2.l8.m2.1.1.1.1.1.3"><mo id="alg2.l8.m2.1.1.1.1.1.3.1" stretchy="false">(</mo><mi id="alg2.l8.m2.1.1.1.1.1.1">i</mi><mo id="alg2.l8.m2.1.1.1.1.1.3.2" stretchy="false">)</mo></mrow></msup><mrow id="alg2.l8.m2.1.1.1.3.3"><mo id="alg2.l8.m2.1.1.1.3.3.1" stretchy="false">[</mo><mo id="alg2.l8.m2.1.1.1.3.3.2" rspace="0.278em">:</mo><mi id="alg2.l8.m2.1.1.1.3.3.3">t</mi><mo id="alg2.l8.m2.1.1.1.3.3.4" stretchy="false">]</mo></mrow><mo id="alg2.l8.m2.1.1.1.3.4" stretchy="false">)</mo></mrow></mrow><mrow id="alg2.l8.m2.2.2.2"><mi id="alg2.l8.m2.2.2.2.2">p</mi><mrow id="alg2.l8.m2.2.2.2.3"><mo id="alg2.l8.m2.2.2.2.3.1" stretchy="false">(</mo><msup id="alg2.l8.m2.2.2.2.3.2"><mi id="alg2.l8.m2.2.2.2.3.2.2">ω</mi><mrow id="alg2.l8.m2.2.2.2.1.1.3"><mo id="alg2.l8.m2.2.2.2.1.1.3.1" stretchy="false">(</mo><mi id="alg2.l8.m2.2.2.2.1.1.1">i</mi><mo id="alg2.l8.m2.2.2.2.1.1.3.2" stretchy="false">)</mo></mrow></msup><mrow id="alg2.l8.m2.2.2.2.3.3"><mo id="alg2.l8.m2.2.2.2.3.3.1" stretchy="false">[</mo><mo id="alg2.l8.m2.2.2.2.3.3.2" rspace="0.278em">:</mo><mi id="alg2.l8.m2.2.2.2.3.3.3">t</mi><mo id="alg2.l8.m2.2.2.2.3.3.4" stretchy="false">]</mo></mrow><mo id="alg2.l8.m2.2.2.2.3.4" stretchy="false">)</mo></mrow></mrow></mfrac></mrow><annotation encoding="application/x-tex" id="alg2.l8.m2.4b">\phi(\bm{q}_{i})^{\top}\phi(\bm{k}_{j})\times f_{t}\times\frac{\widetilde{%
\omega}(\omega^{(i)}[:t])}{p(\omega^{(i)}[:t])}</annotation><annotation encoding="application/x-llamapun" id="alg2.l8.m2.4c">italic_ϕ ( bold_italic_q start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT italic_ϕ ( bold_italic_k start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) × italic_f start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT × divide start_ARG over~ start_ARG italic_ω end_ARG ( italic_ω start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT [ : italic_t ] ) end_ARG start_ARG italic_p ( italic_ω start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT [ : italic_t ] ) end_ARG</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg2.l9">
<span class="ltx_tag ltx_tag_listingline">9:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ltx_text ltx_font_bold" id="alg2.l9.1">end</span>&nbsp;<span class="ltx_text ltx_font_bold" id="alg2.l9.2">for</span>
</div>
<div class="ltx_listingline" id="alg2.l10">
<span class="ltx_tag ltx_tag_listingline">10:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ltx_text ltx_font_bold" id="alg2.l10.1">end</span>&nbsp;<span class="ltx_text ltx_font_bold" id="alg2.l10.2">for</span>
</div>
<div class="ltx_listingline" id="alg2.l11">
<span class="ltx_tag ltx_tag_listingline">11:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Normalise output feature, <math alttext="\bm{f}_{i}/=(S_{i}\times n)" class="ltx_math_unparsed" display="inline" id="alg2.l11.m1.1"><semantics id="alg2.l11.m1.1a"><mrow id="alg2.l11.m1.1b"><msub id="alg2.l11.m1.1.1"><mi id="alg2.l11.m1.1.1.2">𝒇</mi><mi id="alg2.l11.m1.1.1.3">i</mi></msub><mo id="alg2.l11.m1.1.2" rspace="0em">/</mo><mo id="alg2.l11.m1.1.3" lspace="0em">=</mo><mrow id="alg2.l11.m1.1.4"><mo id="alg2.l11.m1.1.4.1" stretchy="false">(</mo><msub id="alg2.l11.m1.1.4.2"><mi id="alg2.l11.m1.1.4.2.2">S</mi><mi id="alg2.l11.m1.1.4.2.3">i</mi></msub><mo id="alg2.l11.m1.1.4.3" lspace="0.222em" rspace="0.222em">×</mo><mi id="alg2.l11.m1.1.4.4">n</mi><mo id="alg2.l11.m1.1.4.5" stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="alg2.l11.m1.1c">\bm{f}_{i}/=(S_{i}\times n)</annotation><annotation encoding="application/x-llamapun" id="alg2.l11.m1.1d">bold_italic_f start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT / = ( italic_S start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT × italic_n )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg2.l12">
<span class="ltx_tag ltx_tag_listingline">12:</span><span class="ltx_text ltx_font_bold" id="alg2.l12.1">end</span>&nbsp;<span class="ltx_text ltx_font_bold" id="alg2.l12.2">for</span>
</div>
<div class="ltx_listingline" id="alg2.l13">
<span class="ltx_tag ltx_tag_listingline">13:</span>Return low-rank attention with topological masking in <math alttext="\mathcal{O}(N)" class="ltx_Math" display="inline" id="alg2.l13.m1.1"><semantics id="alg2.l13.m1.1a"><mrow id="alg2.l13.m1.1.2" xref="alg2.l13.m1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l13.m1.1.2.2" xref="alg2.l13.m1.1.2.2.cmml">𝒪</mi><mo id="alg2.l13.m1.1.2.1" xref="alg2.l13.m1.1.2.1.cmml">⁢</mo><mrow id="alg2.l13.m1.1.2.3.2" xref="alg2.l13.m1.1.2.cmml"><mo id="alg2.l13.m1.1.2.3.2.1" stretchy="false" xref="alg2.l13.m1.1.2.cmml">(</mo><mi id="alg2.l13.m1.1.1" xref="alg2.l13.m1.1.1.cmml">N</mi><mo id="alg2.l13.m1.1.2.3.2.2" stretchy="false" xref="alg2.l13.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l13.m1.1b"><apply id="alg2.l13.m1.1.2.cmml" xref="alg2.l13.m1.1.2"><times id="alg2.l13.m1.1.2.1.cmml" xref="alg2.l13.m1.1.2.1"></times><ci id="alg2.l13.m1.1.2.2.cmml" xref="alg2.l13.m1.1.2.2">𝒪</ci><ci id="alg2.l13.m1.1.1.cmml" xref="alg2.l13.m1.1.1">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l13.m1.1c">\mathcal{O}(N)</annotation><annotation encoding="application/x-llamapun" id="alg2.l13.m1.1d">caligraphic_O ( italic_N )</annotation></semantics></math> time by 

<table class="ltx_equation ltx_eqn_table" id="A4.E27">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\textrm{Att}_{\textrm{LR},\widehat{\mathbf{M}}}(\mathbf{Q},\mathbf{K},\mathbf{%
V},\mathcal{G})=\left[\bm{f}_{i}\right]_{i=1}^{N}" class="ltx_Math" display="block" id="A4.E27.m1.7"><semantics id="A4.E27.m1.7a"><mrow id="A4.E27.m1.7.7" xref="A4.E27.m1.7.7.cmml"><mrow id="A4.E27.m1.7.7.3" xref="A4.E27.m1.7.7.3.cmml"><msub id="A4.E27.m1.7.7.3.2" xref="A4.E27.m1.7.7.3.2.cmml"><mtext id="A4.E27.m1.7.7.3.2.2" xref="A4.E27.m1.7.7.3.2.2a.cmml">Att</mtext><mrow id="A4.E27.m1.2.2.2.4" xref="A4.E27.m1.2.2.2.3.cmml"><mtext id="A4.E27.m1.1.1.1.1" xref="A4.E27.m1.1.1.1.1a.cmml">LR</mtext><mo id="A4.E27.m1.2.2.2.4.1" xref="A4.E27.m1.2.2.2.3.cmml">,</mo><mover accent="true" id="A4.E27.m1.2.2.2.2" xref="A4.E27.m1.2.2.2.2.cmml"><mi id="A4.E27.m1.2.2.2.2.2" xref="A4.E27.m1.2.2.2.2.2.cmml">𝐌</mi><mo id="A4.E27.m1.2.2.2.2.1" xref="A4.E27.m1.2.2.2.2.1.cmml">^</mo></mover></mrow></msub><mo id="A4.E27.m1.7.7.3.1" xref="A4.E27.m1.7.7.3.1.cmml">⁢</mo><mrow id="A4.E27.m1.7.7.3.3.2" xref="A4.E27.m1.7.7.3.3.1.cmml"><mo id="A4.E27.m1.7.7.3.3.2.1" stretchy="false" xref="A4.E27.m1.7.7.3.3.1.cmml">(</mo><mi id="A4.E27.m1.3.3" xref="A4.E27.m1.3.3.cmml">𝐐</mi><mo id="A4.E27.m1.7.7.3.3.2.2" xref="A4.E27.m1.7.7.3.3.1.cmml">,</mo><mi id="A4.E27.m1.4.4" xref="A4.E27.m1.4.4.cmml">𝐊</mi><mo id="A4.E27.m1.7.7.3.3.2.3" xref="A4.E27.m1.7.7.3.3.1.cmml">,</mo><mi id="A4.E27.m1.5.5" xref="A4.E27.m1.5.5.cmml">𝐕</mi><mo id="A4.E27.m1.7.7.3.3.2.4" xref="A4.E27.m1.7.7.3.3.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="A4.E27.m1.6.6" xref="A4.E27.m1.6.6.cmml">𝒢</mi><mo id="A4.E27.m1.7.7.3.3.2.5" stretchy="false" xref="A4.E27.m1.7.7.3.3.1.cmml">)</mo></mrow></mrow><mo id="A4.E27.m1.7.7.2" xref="A4.E27.m1.7.7.2.cmml">=</mo><msubsup id="A4.E27.m1.7.7.1" xref="A4.E27.m1.7.7.1.cmml"><mrow id="A4.E27.m1.7.7.1.1.1.1" xref="A4.E27.m1.7.7.1.1.1.2.cmml"><mo id="A4.E27.m1.7.7.1.1.1.1.2" xref="A4.E27.m1.7.7.1.1.1.2.1.cmml">[</mo><msub id="A4.E27.m1.7.7.1.1.1.1.1" xref="A4.E27.m1.7.7.1.1.1.1.1.cmml"><mi id="A4.E27.m1.7.7.1.1.1.1.1.2" xref="A4.E27.m1.7.7.1.1.1.1.1.2.cmml">𝒇</mi><mi id="A4.E27.m1.7.7.1.1.1.1.1.3" xref="A4.E27.m1.7.7.1.1.1.1.1.3.cmml">i</mi></msub><mo id="A4.E27.m1.7.7.1.1.1.1.3" xref="A4.E27.m1.7.7.1.1.1.2.1.cmml">]</mo></mrow><mrow id="A4.E27.m1.7.7.1.1.3" xref="A4.E27.m1.7.7.1.1.3.cmml"><mi id="A4.E27.m1.7.7.1.1.3.2" xref="A4.E27.m1.7.7.1.1.3.2.cmml">i</mi><mo id="A4.E27.m1.7.7.1.1.3.1" xref="A4.E27.m1.7.7.1.1.3.1.cmml">=</mo><mn id="A4.E27.m1.7.7.1.1.3.3" xref="A4.E27.m1.7.7.1.1.3.3.cmml">1</mn></mrow><mi id="A4.E27.m1.7.7.1.3" xref="A4.E27.m1.7.7.1.3.cmml">N</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="A4.E27.m1.7b"><apply id="A4.E27.m1.7.7.cmml" xref="A4.E27.m1.7.7"><eq id="A4.E27.m1.7.7.2.cmml" xref="A4.E27.m1.7.7.2"></eq><apply id="A4.E27.m1.7.7.3.cmml" xref="A4.E27.m1.7.7.3"><times id="A4.E27.m1.7.7.3.1.cmml" xref="A4.E27.m1.7.7.3.1"></times><apply id="A4.E27.m1.7.7.3.2.cmml" xref="A4.E27.m1.7.7.3.2"><csymbol cd="ambiguous" id="A4.E27.m1.7.7.3.2.1.cmml" xref="A4.E27.m1.7.7.3.2">subscript</csymbol><ci id="A4.E27.m1.7.7.3.2.2a.cmml" xref="A4.E27.m1.7.7.3.2.2"><mtext id="A4.E27.m1.7.7.3.2.2.cmml" xref="A4.E27.m1.7.7.3.2.2">Att</mtext></ci><list id="A4.E27.m1.2.2.2.3.cmml" xref="A4.E27.m1.2.2.2.4"><ci id="A4.E27.m1.1.1.1.1a.cmml" xref="A4.E27.m1.1.1.1.1"><mtext id="A4.E27.m1.1.1.1.1.cmml" mathsize="70%" xref="A4.E27.m1.1.1.1.1">LR</mtext></ci><apply id="A4.E27.m1.2.2.2.2.cmml" xref="A4.E27.m1.2.2.2.2"><ci id="A4.E27.m1.2.2.2.2.1.cmml" xref="A4.E27.m1.2.2.2.2.1">^</ci><ci id="A4.E27.m1.2.2.2.2.2.cmml" xref="A4.E27.m1.2.2.2.2.2">𝐌</ci></apply></list></apply><vector id="A4.E27.m1.7.7.3.3.1.cmml" xref="A4.E27.m1.7.7.3.3.2"><ci id="A4.E27.m1.3.3.cmml" xref="A4.E27.m1.3.3">𝐐</ci><ci id="A4.E27.m1.4.4.cmml" xref="A4.E27.m1.4.4">𝐊</ci><ci id="A4.E27.m1.5.5.cmml" xref="A4.E27.m1.5.5">𝐕</ci><ci id="A4.E27.m1.6.6.cmml" xref="A4.E27.m1.6.6">𝒢</ci></vector></apply><apply id="A4.E27.m1.7.7.1.cmml" xref="A4.E27.m1.7.7.1"><csymbol cd="ambiguous" id="A4.E27.m1.7.7.1.2.cmml" xref="A4.E27.m1.7.7.1">superscript</csymbol><apply id="A4.E27.m1.7.7.1.1.cmml" xref="A4.E27.m1.7.7.1"><csymbol cd="ambiguous" id="A4.E27.m1.7.7.1.1.2.cmml" xref="A4.E27.m1.7.7.1">subscript</csymbol><apply id="A4.E27.m1.7.7.1.1.1.2.cmml" xref="A4.E27.m1.7.7.1.1.1.1"><csymbol cd="latexml" id="A4.E27.m1.7.7.1.1.1.2.1.cmml" xref="A4.E27.m1.7.7.1.1.1.1.2">delimited-[]</csymbol><apply id="A4.E27.m1.7.7.1.1.1.1.1.cmml" xref="A4.E27.m1.7.7.1.1.1.1.1"><csymbol cd="ambiguous" id="A4.E27.m1.7.7.1.1.1.1.1.1.cmml" xref="A4.E27.m1.7.7.1.1.1.1.1">subscript</csymbol><ci id="A4.E27.m1.7.7.1.1.1.1.1.2.cmml" xref="A4.E27.m1.7.7.1.1.1.1.1.2">𝒇</ci><ci id="A4.E27.m1.7.7.1.1.1.1.1.3.cmml" xref="A4.E27.m1.7.7.1.1.1.1.1.3">𝑖</ci></apply></apply><apply id="A4.E27.m1.7.7.1.1.3.cmml" xref="A4.E27.m1.7.7.1.1.3"><eq id="A4.E27.m1.7.7.1.1.3.1.cmml" xref="A4.E27.m1.7.7.1.1.3.1"></eq><ci id="A4.E27.m1.7.7.1.1.3.2.cmml" xref="A4.E27.m1.7.7.1.1.3.2">𝑖</ci><cn id="A4.E27.m1.7.7.1.1.3.3.cmml" type="integer" xref="A4.E27.m1.7.7.1.1.3.3">1</cn></apply></apply><ci id="A4.E27.m1.7.7.1.3.cmml" xref="A4.E27.m1.7.7.1.3">𝑁</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.E27.m1.7c">\textrm{Att}_{\textrm{LR},\widehat{\mathbf{M}}}(\mathbf{Q},\mathbf{K},\mathbf{%
V},\mathcal{G})=\left[\bm{f}_{i}\right]_{i=1}^{N}</annotation><annotation encoding="application/x-llamapun" id="A4.E27.m1.7d">Att start_POSTSUBSCRIPT LR , over^ start_ARG bold_M end_ARG end_POSTSUBSCRIPT ( bold_Q , bold_K , bold_V , caligraphic_G ) = [ bold_italic_f start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ] start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(27)</span></td>
</tr></tbody>
</table>
</div>
</div>
</div>
</div>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
</article>
</div>

</div>


<button type="button" class="btn btn-primary hover-rp-button" id="openForm">Report Issue</button><div class="modal" id="myForm" role="dialog" aria-labelledby="modal-title"><div class="modal-dialog"><form class="modal-content" id="myFormContent" enctype="multipart/form-data"><div class="modal-header" id="modal-header"><h5 class="modal-title">Report Github Issue</h5><button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button></div><div class="modal-body"><label for="form_title" id="modalTitle">Title:</label><input class="form-control" id="form_title" name="form_title" required="required" placeholder="Enter title"><label for="description" id="selectedTextModalDescription" style="display: none;">Content selection saved. Describe the issue below:</label><label for="description" id="nomralModalDescription">Description:</label><textarea class="form-control" id="description" name="description" required="required" style="height: 80px;" maxlength="500" placeholder="500 characters maximum"></textarea></div><div class="modal-footer d-flex justify-content-end"><button type="submit" class="sr-only button" id="modal-submit-sr">Submit without Github</button><button type="submit" class="btn btn-primary" id="modal-submit">Submit in Github</button></div></form></div></div><button id="small-report-button" type="button" class="btn btn-secondary btn-sm" style="background-color: rgb(179, 27, 27); position: fixed;">Report Issue for Selection</button><div class="ltx_page_footer">
        <div class="ltx_page_logo">
            Generated by
            <a href="https://math.nist.gov/~BMiller/LaTeXML/" class="ltx_LaTeXML_logo">
                <span style="letter-spacing: -0.2em; margin-right: 0.1em;">
                    L
                    <span style="font-size: 70%; position: relative; bottom: 2.2pt;">A</span>
                    T
                    <span style="position: relative; bottom: -0.4ex;">E</span>
                </span>
                <span class="ltx_font_smallcaps">xml</span>
                <img alt="[LOGO]" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==">
            </a>
        </div></div><footer id="footer" class="ltx_document">
        <div class="keyboard-glossary">
            <h2>Instructions for reporting errors</h2>
            <p>We are continuing to improve HTML versions of papers, and your feedback helps enhance accessibility and mobile support. To report errors in the HTML that will help us improve conversion and rendering, choose any of the methods listed below:</p>
            <ul>
                <li>Click the "Report Issue" button.</li>
                <li>Open a report feedback form via keyboard, use "<strong>Ctrl + ?</strong>".</li>
                <li>Make a text selection and click the "Report Issue for Selection" button near your cursor.</li>
                <li class="sr-only">You can use Alt+Y to toggle on and Alt+Shift+Y to toggle off accessible reporting links at each section.</li>
            </ul>
            <p>Our team has already identified <a class="ltx_ref" href="https://github.com/arXiv/html_feedback/issues" target="_blank">the following issues</a>. We appreciate your time reviewing and reporting rendering errors we may not have found yet. Your efforts will help us improve the HTML versions for all readers, because disability should not be a barrier to accessing research. Thank you for your continued support in championing open access for all.</p>
            <p>Have a free development cycle? Help support accessibility at arXiv! Our collaborators at LaTeXML maintain a <a class="ltx_ref" href="https://github.com/brucemiller/LaTeXML/wiki/Porting-LaTeX-packages-for-LaTeXML" target="_blank">list of packages that need conversion</a>, and welcome <a class="ltx_ref" href="https://github.com/brucemiller/LaTeXML/issues" target="_blank">developer contributions</a>.</p>
        </div>
    </footer></body></html>