<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>Federated Learning Nodes Can Reconstruct Peers’ Image Data</title>
<!--Generated on Sun Oct  6 22:37:46 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<base href="/html/2410.04661v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.04661v1#S1" title="In Federated Learning Nodes Can Reconstruct Peers’ Image Data"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.04661v1#S2" title="In Federated Learning Nodes Can Reconstruct Peers’ Image Data"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Related Work</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.04661v1#S3" title="In Federated Learning Nodes Can Reconstruct Peers’ Image Data"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Proposed Image Reconstruction Attack by Curious Clients</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04661v1#S3.SS1" title="In 3 Proposed Image Reconstruction Attack by Curious Clients ‣ Federated Learning Nodes Can Reconstruct Peers’ Image Data"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Attack Framework</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04661v1#S3.SS2" title="In 3 Proposed Image Reconstruction Attack by Curious Clients ‣ Federated Learning Nodes Can Reconstruct Peers’ Image Data"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>Direct Postprocessing for Pixel-Level Image Enhancement</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04661v1#S3.SS3" title="In 3 Proposed Image Reconstruction Attack by Curious Clients ‣ Federated Learning Nodes Can Reconstruct Peers’ Image Data"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3 </span>Masked Diffusion Enhancer: reconstruction at a semantic level</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.04661v1#S4" title="In Federated Learning Nodes Can Reconstruct Peers’ Image Data"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Experimental Results</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.04661v1#S5" title="In Federated Learning Nodes Can Reconstruct Peers’ Image Data"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Conclusions and Future Work</span></a></li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Federated Learning Nodes Can Reconstruct Peers’ Image Data</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Ethan Wilson, Kai Yue, Chau-Wai Wong, and Huaiyu Dai
<br class="ltx_break"/>Electrical and Computer Engineering,
NC State University, Raleigh, USA
</span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id1.id1">Federated learning (FL) is a privacy-preserving machine learning framework that enables multiple nodes to train models on their local data and periodically average weight updates to benefit from other nodes’ training. Each node’s goal is to collaborate with other nodes to improve the model’s performance while keeping its training data private. However, this framework does not guarantee data privacy. Prior work has shown that the gradient-sharing steps in FL can be vulnerable to data reconstruction attacks from an honest-but-curious central server. In this work, we show that an honest-but-curious node/client can also launch attacks to reconstruct peers’ image data in a centralized system, presenting a severe privacy risk. We demonstrate that a single client can silently reconstruct other clients’ private images using diluted information available within consecutive updates. We leverage state-of-the-art diffusion models to enhance the perceptual quality and recognizability of the reconstructed images, further demonstrating the risk of information leakage at a semantic level. This highlights the need for more robust privacy-preserving mechanisms that protect against silent client-side attacks during federated training.</p>
</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>
<div class="ltx_para ltx_noindent" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">Federated learning (FL) has attracted significant attention as a promising approach to privacy-preserving machine learning <cite class="ltx_cite ltx_citemacro_citep">(McMahan et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04661v1#bib.bib15" title="">2017</a>; Kairouz et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04661v1#bib.bib10" title="">2021</a>)</cite>. In this framework, a central server coordinates training by multiple clients. In each training round, the server broadcasts a shared model to a subset of clients. Each client computes a gradient by training the model on its private data and returns the gradient to the server. The server then averages all the gradients and updates the model. This approach enables each participant to benefit from a model trained on more data without sharing its own data. FL has the potential to revolutionize collaborative efforts in such real-world applications as healthcare and finance, enabling participants to train better models without compromising data privacy <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04661v1#bib.bib13" title="">2020a</a>)</cite>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">Despite the intent to protect privacy through FL, prior works have shown that an honest-but-curious central server can reconstruct a client’s training data. This is done by adjusting a dummy input to the model until its resulting gradient closely matches the gradient sent by the client <cite class="ltx_cite ltx_citemacro_citep">(Zhu et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04661v1#bib.bib26" title="">2019</a>; Geiping et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04661v1#bib.bib6" title="">2020</a>; Yue et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04661v1#bib.bib23" title="">2023</a>)</cite>. Meanwhile, studies on malicious clients have shown that a client can disrupt federated training by sending adversarial data to the server <cite class="ltx_cite ltx_citemacro_citep">(Blanchard et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04661v1#bib.bib1" title="">2017</a>; Shi et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04661v1#bib.bib17" title="">2022</a>)</cite>. However, far less attention has been given to the potential for clients to reconstruct others’ data while honestly participating in the FL network.</p>
</div>
<figure class="ltx_figure" id="S1.F1"><span class="ltx_picture ltx_centering" id="S1.F1.pic1" style="width:396.0pt;height:249.3pt;">\begin{overpic}[width=397.48499pt]{figs/Curious_Client_Block_Diagram.pdf}
\put(56.0,38.5){\text{\char 172}}
\put(92.0,38.0){\text{\char 173}}
\put(95.5,22.5){\text{\char 174}}
\put(46.0,22.5){\text{\char 175}}
\end{overpic}</span>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Overview of the proposed honest-but-curious client attack. The attacker participates in two consecutive training rounds to obtain the global model’s gradient update by <span class="ltx_text" id="S1.F1.5.1">①</span> differencing the model weights. The attacker then <span class="ltx_text" id="S1.F1.6.2">②</span> inverts the update to obtain each client’s training data. To address the challenge of recovering high-quality images from diluted information hidden in the global gradient update, the raw reconstructions are postprocessed using either <span class="ltx_text" id="S1.F1.7.3">③</span> a direct technique respecting pixel-level correctness or <span class="ltx_text" id="S1.F1.8.4">④</span> a semantic technique focusing on producing photorealistic images.</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">Our work explores the extent to which a single client can reconstruct peers’ training data while adhering to FL protocols. We introduce a novel client-to-client attack depicted in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.04661v1#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Federated Learning Nodes Can Reconstruct Peers’ Image Data"><span class="ltx_text ltx_ref_tag">1</span></a>, where the attacker exploits weight updates between consecutive training rounds to reconstruct training images. By participating in two consecutive training rounds and comparing the global model’s weights, a single client extracts the averaged gradient of all participants in the earlier round. Unlike server-side gradient inversion <cite class="ltx_cite ltx_citemacro_citep">(Zhu et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04661v1#bib.bib26" title="">2019</a>; Geiping et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04661v1#bib.bib6" title="">2020</a>; Yue et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04661v1#bib.bib23" title="">2023</a>)</cite>, this attack requires isolating individual data from a diluted mixture of gradient updates. Despite this challenge, we show that the attacker is able to reconstruct images from every other client.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">We further propose to utilize two image postprocessing techniques based on diffusion models to improve the quality and recognizability of attack’s raw reconstructed images. Our first technique uses a pretrained masked diffusion transformer (MDT) <cite class="ltx_cite ltx_citemacro_citep">(Gao et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04661v1#bib.bib5" title="">2023</a>)</cite> to generate high quality images that resemble the raw attack results on a semantic level. Our second technique uses denoising diffusion probabilistic models (DDPMs) <cite class="ltx_cite ltx_citemacro_citep">(Ho et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04661v1#bib.bib8" title="">2020</a>)</cite> to enhance the raw reconstructions at the pixel level through super resolution and denoising <cite class="ltx_cite ltx_citemacro_citep">(Kawar et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04661v1#bib.bib11" title="">2022</a>)</cite>. This paper’s contributions are threefold.</p>
<ol class="ltx_enumerate" id="S1.I1">
<li class="ltx_item" id="S1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span>
<div class="ltx_para ltx_noindent" id="S1.I1.i1.p1">
<p class="ltx_p" id="S1.I1.i1.p1.1">We demonstrate that clients participating in FedAvg <cite class="ltx_cite ltx_citemacro_citep">(McMahan et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04661v1#bib.bib15" title="">2017</a>)</cite> can exploit the model updating process to reconstruct peers’ data, which reveals a previously unrecognized privacy risk in FL.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span>
<div class="ltx_para ltx_noindent" id="S1.I1.i2.p1">
<p class="ltx_p" id="S1.I1.i2.p1.1">The proposed masked diffusion enhancer (MDE) generates sharp, high-resolution images from the low-resolution, color-aliased raw reconstructions. The generated images resemble a target image on a semantic level, preserving its geometric shape and perceptual features with photorealistic quality.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">3.</span>
<div class="ltx_para ltx_noindent" id="S1.I1.i3.p1">
<p class="ltx_p" id="S1.I1.i3.p1.1">The proposed DDPM-based image postprocessing simultaneously denoises and upsamples raw reconstructed images. This improves image resolution and object recognizability, achieving strong pixel-wise similarity to ground-truth images.</p>
</div>
</li>
</ol>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Work</h2>
<div class="ltx_para ltx_noindent" id="S2.p1">
<p class="ltx_p" id="S2.p1.1"><span class="ltx_text ltx_font_bold" id="S2.p1.1.1">Server-Side Gradient Inversion.</span>
The assumption that FL inherently protects data privacy has been challenged by studies exposing vulnerabilities to gradient inversion attacks from the central server <cite class="ltx_cite ltx_citemacro_citep">(Zhu et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04661v1#bib.bib26" title="">2019</a>; Geiping et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04661v1#bib.bib6" title="">2020</a>)</cite>. These attacks exploit the gradients shared by clients to reconstruct private training data. They revealed that by iteratively updating a dummy input to produce a gradient similar to a given target gradient, the server could generate images closely resembling the participant’s original training data. Various defense mechanisms have been proposed to protect against these attacks, including gradient compression, perturbation, and differential privacy techniques <cite class="ltx_cite ltx_citemacro_citep">(Zhang et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04661v1#bib.bib25" title="">2020</a>; Sun et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04661v1#bib.bib18" title="">2021</a>)</cite>. Despite these efforts, recent studies have shown that these defenses may not effectively prevent training data from being meaningfully reconstructed. For example, <cite class="ltx_cite ltx_citemacro_cite">Yue et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.04661v1#bib.bib23" title="">2023</a>)</cite> overcame these defense methods by leveraging latent space reconstruction and incorporating generative models to remove distortion from reconstructed images.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.p2">
<p class="ltx_p" id="S2.p2.1"><span class="ltx_text ltx_font_bold" id="S2.p2.1.1">Client-Side Model Inversion.</span>
While the majority of research has focused on server-side attacks, the potential for client-side attacks has been less examined. <cite class="ltx_cite ltx_citemacro_citet">Wu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.04661v1#bib.bib21" title="">2024</a>)</cite> investigated model inversion attacks, where a client exploits the model’s overfitting to reconstruct training data. This approach relies on manipulating the model rather than directly reconstructing other clients’ data. Similar to our work’s takeaway, their results demonstrated that clients can reconstruct peers’ images without disrupting the training process. However, due to the challenging nature of model inversion, their method produces reconstructed images far less similar to the target than those from gradient inversion attacks.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.p3">
<p class="ltx_p" id="S2.p3.1"><span class="ltx_text ltx_font_bold" id="S2.p3.1.1">Malicious Client Attacks.</span>
A parallel research direction focuses on attacks where a malicious client interferes with the FL process <cite class="ltx_cite ltx_citemacro_citep">(Blanchard et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04661v1#bib.bib1" title="">2017</a>; Shejwalkar et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04661v1#bib.bib16" title="">2022</a>)</cite>. Specifically, malicious clients can manipulate the model updates by using poisoned data or sending poisoned gradients to the server to impede convergence. Meanwhile, researchers have shown that malicious modifications can compromise privacy easily <cite class="ltx_cite ltx_citemacro_citep">(Fowl et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04661v1#bib.bib4" title="">2021</a>; Wen et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04661v1#bib.bib20" title="">2022</a>)</cite>.
While this introduces unique security challenges in FL, our attack does not disrupt the training process and is difficult to be detected by the server or other clients.</p>
</div>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Proposed Image Reconstruction Attack by Curious Clients</h2>
<div class="ltx_para ltx_noindent" id="S3.p1">
<p class="ltx_p" id="S3.p1.1">In this section, we present the gradient inversion attack, which allows an honest-but-curious client to reconstruct image data from other clients.
To enhance this reconstruction, two postprocessing methods are introduced to achieve both fine-grained quality and perceptual realism.
The first postprocessing method improves the images at the pixel level with enhanced details. The second method, built on a masked diffusion enhancer, refines the images at the semantic level and produces photorealistic reconstructions.</p>
</div>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Attack Framework</h3>
<div class="ltx_para ltx_noindent" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.1"><span class="ltx_text ltx_font_bold" id="S3.SS1.p1.1.1">Threat Model.</span> We consider an honest-but-curious client (or curious client, for simplicity) attacker.
It aims to reconstruct other clients’ training data while following the protocol of FL. The attacker does not disrupt the model training process. The curious client does not have direct access to the gradients from other clients. However, it receives an updated version of the shared model from the server at each communication round. We assume the client has sufficient computational resources to perform the optimization process during its participation in FL. Additionally, we assume as in <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04661v1#bib.bib14" title="">2020b</a>; Huang et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04661v1#bib.bib9" title="">2020</a>)</cite> that all client updates in a given round have been computed using the same learning rate, which is applied locally if each client transmits a model update, as shown in Eq. (<a class="ltx_ref" href="https://arxiv.org/html/2410.04661v1#S3.E1" title="In 3.1 Attack Framework ‣ 3 Proposed Image Reconstruction Attack by Curious Clients ‣ Federated Learning Nodes Can Reconstruct Peers’ Image Data"><span class="ltx_text ltx_ref_tag">1</span></a>). It may also be applied globally if clients transmit raw gradients to the server, as discussed in Section 4. Each client uses the same number of images for local training and the attacker knows or can guess the number of clients in each training round.
We follow the assumption of <cite class="ltx_cite ltx_citemacro_citet">Yue et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.04661v1#bib.bib23" title="">2023</a>)</cite> that each client performs full batch gradient descent during its local training and that the class labels have been analytically inverted as in <cite class="ltx_cite ltx_citemacro_citet">Yin et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.04661v1#bib.bib22" title="">2021</a>)</cite>.
We target cross-silo FL scenarios, in which a small number of clients collaborate to overcome data scarcity. For example, a group of hospitals may use FL to develop a classifier for rare diseases from CT scans, where each has limited training examples and images cannot be directly shared due to privacy concerns.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS1.p2">
<p class="ltx_p" id="S3.SS1.p2.5">Our approach to reconstructing data from the global model updates builds upon traditional gradient inversion and includes extra initialization and calculation steps to separate individual training images from the averaged global update. Our attacker engages in two consecutive rounds of FedAvg and obtains two versions of the global model parameters, <math alttext="\mathbf{W}^{(t)}" class="ltx_Math" display="inline" id="S3.SS1.p2.1.m1.1"><semantics id="S3.SS1.p2.1.m1.1a"><msup id="S3.SS1.p2.1.m1.1.2" xref="S3.SS1.p2.1.m1.1.2.cmml"><mi id="S3.SS1.p2.1.m1.1.2.2" xref="S3.SS1.p2.1.m1.1.2.2.cmml">𝐖</mi><mrow id="S3.SS1.p2.1.m1.1.1.1.3" xref="S3.SS1.p2.1.m1.1.2.cmml"><mo id="S3.SS1.p2.1.m1.1.1.1.3.1" stretchy="false" xref="S3.SS1.p2.1.m1.1.2.cmml">(</mo><mi id="S3.SS1.p2.1.m1.1.1.1.1" xref="S3.SS1.p2.1.m1.1.1.1.1.cmml">t</mi><mo id="S3.SS1.p2.1.m1.1.1.1.3.2" stretchy="false" xref="S3.SS1.p2.1.m1.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.1b"><apply id="S3.SS1.p2.1.m1.1.2.cmml" xref="S3.SS1.p2.1.m1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p2.1.m1.1.2.1.cmml" xref="S3.SS1.p2.1.m1.1.2">superscript</csymbol><ci id="S3.SS1.p2.1.m1.1.2.2.cmml" xref="S3.SS1.p2.1.m1.1.2.2">𝐖</ci><ci id="S3.SS1.p2.1.m1.1.1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1.1.1">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.1c">\mathbf{W}^{(t)}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.1.m1.1d">bold_W start_POSTSUPERSCRIPT ( italic_t ) end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="\mathbf{W}^{(t+1)}" class="ltx_Math" display="inline" id="S3.SS1.p2.2.m2.1"><semantics id="S3.SS1.p2.2.m2.1a"><msup id="S3.SS1.p2.2.m2.1.2" xref="S3.SS1.p2.2.m2.1.2.cmml"><mi id="S3.SS1.p2.2.m2.1.2.2" xref="S3.SS1.p2.2.m2.1.2.2.cmml">𝐖</mi><mrow id="S3.SS1.p2.2.m2.1.1.1.1" xref="S3.SS1.p2.2.m2.1.1.1.1.1.cmml"><mo id="S3.SS1.p2.2.m2.1.1.1.1.2" stretchy="false" xref="S3.SS1.p2.2.m2.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS1.p2.2.m2.1.1.1.1.1" xref="S3.SS1.p2.2.m2.1.1.1.1.1.cmml"><mi id="S3.SS1.p2.2.m2.1.1.1.1.1.2" xref="S3.SS1.p2.2.m2.1.1.1.1.1.2.cmml">t</mi><mo id="S3.SS1.p2.2.m2.1.1.1.1.1.1" xref="S3.SS1.p2.2.m2.1.1.1.1.1.1.cmml">+</mo><mn id="S3.SS1.p2.2.m2.1.1.1.1.1.3" xref="S3.SS1.p2.2.m2.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S3.SS1.p2.2.m2.1.1.1.1.3" stretchy="false" xref="S3.SS1.p2.2.m2.1.1.1.1.1.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.2.m2.1b"><apply id="S3.SS1.p2.2.m2.1.2.cmml" xref="S3.SS1.p2.2.m2.1.2"><csymbol cd="ambiguous" id="S3.SS1.p2.2.m2.1.2.1.cmml" xref="S3.SS1.p2.2.m2.1.2">superscript</csymbol><ci id="S3.SS1.p2.2.m2.1.2.2.cmml" xref="S3.SS1.p2.2.m2.1.2.2">𝐖</ci><apply id="S3.SS1.p2.2.m2.1.1.1.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1.1.1"><plus id="S3.SS1.p2.2.m2.1.1.1.1.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1.1.1.1.1"></plus><ci id="S3.SS1.p2.2.m2.1.1.1.1.1.2.cmml" xref="S3.SS1.p2.2.m2.1.1.1.1.1.2">𝑡</ci><cn id="S3.SS1.p2.2.m2.1.1.1.1.1.3.cmml" type="integer" xref="S3.SS1.p2.2.m2.1.1.1.1.1.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.2.m2.1c">\mathbf{W}^{(t+1)}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.2.m2.1d">bold_W start_POSTSUPERSCRIPT ( italic_t + 1 ) end_POSTSUPERSCRIPT</annotation></semantics></math>. By computing the difference between successive model weights, the attacker can infer the gradient used for the global model update: <math alttext="\mathbf{\nabla}_{\text{avg}}^{(t)}=(\mathbf{W}^{(t)}-\mathbf{W}^{(t+1)})/\eta_%
{\text{g}}^{(t)}" class="ltx_Math" display="inline" id="S3.SS1.p2.3.m3.5"><semantics id="S3.SS1.p2.3.m3.5a"><mrow id="S3.SS1.p2.3.m3.5.5" xref="S3.SS1.p2.3.m3.5.5.cmml"><msubsup id="S3.SS1.p2.3.m3.5.5.3" xref="S3.SS1.p2.3.m3.5.5.3.cmml"><mo id="S3.SS1.p2.3.m3.5.5.3.2.2" xref="S3.SS1.p2.3.m3.5.5.3.2.2.cmml">∇</mo><mtext id="S3.SS1.p2.3.m3.5.5.3.2.3" xref="S3.SS1.p2.3.m3.5.5.3.2.3a.cmml">avg</mtext><mrow id="S3.SS1.p2.3.m3.1.1.1.3" xref="S3.SS1.p2.3.m3.5.5.3.cmml"><mo id="S3.SS1.p2.3.m3.1.1.1.3.1" stretchy="false" xref="S3.SS1.p2.3.m3.5.5.3.cmml">(</mo><mi id="S3.SS1.p2.3.m3.1.1.1.1" xref="S3.SS1.p2.3.m3.1.1.1.1.cmml">t</mi><mo id="S3.SS1.p2.3.m3.1.1.1.3.2" stretchy="false" xref="S3.SS1.p2.3.m3.5.5.3.cmml">)</mo></mrow></msubsup><mo id="S3.SS1.p2.3.m3.5.5.2" xref="S3.SS1.p2.3.m3.5.5.2.cmml">=</mo><mrow id="S3.SS1.p2.3.m3.5.5.1" xref="S3.SS1.p2.3.m3.5.5.1.cmml"><mrow id="S3.SS1.p2.3.m3.5.5.1.1.1" xref="S3.SS1.p2.3.m3.5.5.1.1.1.1.cmml"><mo id="S3.SS1.p2.3.m3.5.5.1.1.1.2" stretchy="false" xref="S3.SS1.p2.3.m3.5.5.1.1.1.1.cmml">(</mo><mrow id="S3.SS1.p2.3.m3.5.5.1.1.1.1" xref="S3.SS1.p2.3.m3.5.5.1.1.1.1.cmml"><msup id="S3.SS1.p2.3.m3.5.5.1.1.1.1.2" xref="S3.SS1.p2.3.m3.5.5.1.1.1.1.2.cmml"><mi id="S3.SS1.p2.3.m3.5.5.1.1.1.1.2.2" xref="S3.SS1.p2.3.m3.5.5.1.1.1.1.2.2.cmml">𝐖</mi><mrow id="S3.SS1.p2.3.m3.2.2.1.3" xref="S3.SS1.p2.3.m3.5.5.1.1.1.1.2.cmml"><mo id="S3.SS1.p2.3.m3.2.2.1.3.1" stretchy="false" xref="S3.SS1.p2.3.m3.5.5.1.1.1.1.2.cmml">(</mo><mi id="S3.SS1.p2.3.m3.2.2.1.1" xref="S3.SS1.p2.3.m3.2.2.1.1.cmml">t</mi><mo id="S3.SS1.p2.3.m3.2.2.1.3.2" stretchy="false" xref="S3.SS1.p2.3.m3.5.5.1.1.1.1.2.cmml">)</mo></mrow></msup><mo id="S3.SS1.p2.3.m3.5.5.1.1.1.1.1" xref="S3.SS1.p2.3.m3.5.5.1.1.1.1.1.cmml">−</mo><msup id="S3.SS1.p2.3.m3.5.5.1.1.1.1.3" xref="S3.SS1.p2.3.m3.5.5.1.1.1.1.3.cmml"><mi id="S3.SS1.p2.3.m3.5.5.1.1.1.1.3.2" xref="S3.SS1.p2.3.m3.5.5.1.1.1.1.3.2.cmml">𝐖</mi><mrow id="S3.SS1.p2.3.m3.3.3.1.1" xref="S3.SS1.p2.3.m3.3.3.1.1.1.cmml"><mo id="S3.SS1.p2.3.m3.3.3.1.1.2" stretchy="false" xref="S3.SS1.p2.3.m3.3.3.1.1.1.cmml">(</mo><mrow id="S3.SS1.p2.3.m3.3.3.1.1.1" xref="S3.SS1.p2.3.m3.3.3.1.1.1.cmml"><mi id="S3.SS1.p2.3.m3.3.3.1.1.1.2" xref="S3.SS1.p2.3.m3.3.3.1.1.1.2.cmml">t</mi><mo id="S3.SS1.p2.3.m3.3.3.1.1.1.1" xref="S3.SS1.p2.3.m3.3.3.1.1.1.1.cmml">+</mo><mn id="S3.SS1.p2.3.m3.3.3.1.1.1.3" xref="S3.SS1.p2.3.m3.3.3.1.1.1.3.cmml">1</mn></mrow><mo id="S3.SS1.p2.3.m3.3.3.1.1.3" stretchy="false" xref="S3.SS1.p2.3.m3.3.3.1.1.1.cmml">)</mo></mrow></msup></mrow><mo id="S3.SS1.p2.3.m3.5.5.1.1.1.3" stretchy="false" xref="S3.SS1.p2.3.m3.5.5.1.1.1.1.cmml">)</mo></mrow><mo id="S3.SS1.p2.3.m3.5.5.1.2" xref="S3.SS1.p2.3.m3.5.5.1.2.cmml">/</mo><msubsup id="S3.SS1.p2.3.m3.5.5.1.3" xref="S3.SS1.p2.3.m3.5.5.1.3.cmml"><mi id="S3.SS1.p2.3.m3.5.5.1.3.2.2" xref="S3.SS1.p2.3.m3.5.5.1.3.2.2.cmml">η</mi><mtext id="S3.SS1.p2.3.m3.5.5.1.3.2.3" xref="S3.SS1.p2.3.m3.5.5.1.3.2.3a.cmml">g</mtext><mrow id="S3.SS1.p2.3.m3.4.4.1.3" xref="S3.SS1.p2.3.m3.5.5.1.3.cmml"><mo id="S3.SS1.p2.3.m3.4.4.1.3.1" stretchy="false" xref="S3.SS1.p2.3.m3.5.5.1.3.cmml">(</mo><mi id="S3.SS1.p2.3.m3.4.4.1.1" xref="S3.SS1.p2.3.m3.4.4.1.1.cmml">t</mi><mo id="S3.SS1.p2.3.m3.4.4.1.3.2" stretchy="false" xref="S3.SS1.p2.3.m3.5.5.1.3.cmml">)</mo></mrow></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.3.m3.5b"><apply id="S3.SS1.p2.3.m3.5.5.cmml" xref="S3.SS1.p2.3.m3.5.5"><eq id="S3.SS1.p2.3.m3.5.5.2.cmml" xref="S3.SS1.p2.3.m3.5.5.2"></eq><apply id="S3.SS1.p2.3.m3.5.5.3.cmml" xref="S3.SS1.p2.3.m3.5.5.3"><csymbol cd="ambiguous" id="S3.SS1.p2.3.m3.5.5.3.1.cmml" xref="S3.SS1.p2.3.m3.5.5.3">superscript</csymbol><apply id="S3.SS1.p2.3.m3.5.5.3.2.cmml" xref="S3.SS1.p2.3.m3.5.5.3"><csymbol cd="ambiguous" id="S3.SS1.p2.3.m3.5.5.3.2.1.cmml" xref="S3.SS1.p2.3.m3.5.5.3">subscript</csymbol><ci id="S3.SS1.p2.3.m3.5.5.3.2.2.cmml" xref="S3.SS1.p2.3.m3.5.5.3.2.2">∇</ci><ci id="S3.SS1.p2.3.m3.5.5.3.2.3a.cmml" xref="S3.SS1.p2.3.m3.5.5.3.2.3"><mtext id="S3.SS1.p2.3.m3.5.5.3.2.3.cmml" mathsize="70%" xref="S3.SS1.p2.3.m3.5.5.3.2.3">avg</mtext></ci></apply><ci id="S3.SS1.p2.3.m3.1.1.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1.1.1">𝑡</ci></apply><apply id="S3.SS1.p2.3.m3.5.5.1.cmml" xref="S3.SS1.p2.3.m3.5.5.1"><divide id="S3.SS1.p2.3.m3.5.5.1.2.cmml" xref="S3.SS1.p2.3.m3.5.5.1.2"></divide><apply id="S3.SS1.p2.3.m3.5.5.1.1.1.1.cmml" xref="S3.SS1.p2.3.m3.5.5.1.1.1"><minus id="S3.SS1.p2.3.m3.5.5.1.1.1.1.1.cmml" xref="S3.SS1.p2.3.m3.5.5.1.1.1.1.1"></minus><apply id="S3.SS1.p2.3.m3.5.5.1.1.1.1.2.cmml" xref="S3.SS1.p2.3.m3.5.5.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p2.3.m3.5.5.1.1.1.1.2.1.cmml" xref="S3.SS1.p2.3.m3.5.5.1.1.1.1.2">superscript</csymbol><ci id="S3.SS1.p2.3.m3.5.5.1.1.1.1.2.2.cmml" xref="S3.SS1.p2.3.m3.5.5.1.1.1.1.2.2">𝐖</ci><ci id="S3.SS1.p2.3.m3.2.2.1.1.cmml" xref="S3.SS1.p2.3.m3.2.2.1.1">𝑡</ci></apply><apply id="S3.SS1.p2.3.m3.5.5.1.1.1.1.3.cmml" xref="S3.SS1.p2.3.m3.5.5.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p2.3.m3.5.5.1.1.1.1.3.1.cmml" xref="S3.SS1.p2.3.m3.5.5.1.1.1.1.3">superscript</csymbol><ci id="S3.SS1.p2.3.m3.5.5.1.1.1.1.3.2.cmml" xref="S3.SS1.p2.3.m3.5.5.1.1.1.1.3.2">𝐖</ci><apply id="S3.SS1.p2.3.m3.3.3.1.1.1.cmml" xref="S3.SS1.p2.3.m3.3.3.1.1"><plus id="S3.SS1.p2.3.m3.3.3.1.1.1.1.cmml" xref="S3.SS1.p2.3.m3.3.3.1.1.1.1"></plus><ci id="S3.SS1.p2.3.m3.3.3.1.1.1.2.cmml" xref="S3.SS1.p2.3.m3.3.3.1.1.1.2">𝑡</ci><cn id="S3.SS1.p2.3.m3.3.3.1.1.1.3.cmml" type="integer" xref="S3.SS1.p2.3.m3.3.3.1.1.1.3">1</cn></apply></apply></apply><apply id="S3.SS1.p2.3.m3.5.5.1.3.cmml" xref="S3.SS1.p2.3.m3.5.5.1.3"><csymbol cd="ambiguous" id="S3.SS1.p2.3.m3.5.5.1.3.1.cmml" xref="S3.SS1.p2.3.m3.5.5.1.3">superscript</csymbol><apply id="S3.SS1.p2.3.m3.5.5.1.3.2.cmml" xref="S3.SS1.p2.3.m3.5.5.1.3"><csymbol cd="ambiguous" id="S3.SS1.p2.3.m3.5.5.1.3.2.1.cmml" xref="S3.SS1.p2.3.m3.5.5.1.3">subscript</csymbol><ci id="S3.SS1.p2.3.m3.5.5.1.3.2.2.cmml" xref="S3.SS1.p2.3.m3.5.5.1.3.2.2">𝜂</ci><ci id="S3.SS1.p2.3.m3.5.5.1.3.2.3a.cmml" xref="S3.SS1.p2.3.m3.5.5.1.3.2.3"><mtext id="S3.SS1.p2.3.m3.5.5.1.3.2.3.cmml" mathsize="70%" xref="S3.SS1.p2.3.m3.5.5.1.3.2.3">g</mtext></ci></apply><ci id="S3.SS1.p2.3.m3.4.4.1.1.cmml" xref="S3.SS1.p2.3.m3.4.4.1.1">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.3.m3.5c">\mathbf{\nabla}_{\text{avg}}^{(t)}=(\mathbf{W}^{(t)}-\mathbf{W}^{(t+1)})/\eta_%
{\text{g}}^{(t)}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.3.m3.5d">∇ start_POSTSUBSCRIPT avg end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_t ) end_POSTSUPERSCRIPT = ( bold_W start_POSTSUPERSCRIPT ( italic_t ) end_POSTSUPERSCRIPT - bold_W start_POSTSUPERSCRIPT ( italic_t + 1 ) end_POSTSUPERSCRIPT ) / italic_η start_POSTSUBSCRIPT g end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_t ) end_POSTSUPERSCRIPT</annotation></semantics></math>, where <math alttext="\eta_{\text{g}}^{(t)}" class="ltx_Math" display="inline" id="S3.SS1.p2.4.m4.1"><semantics id="S3.SS1.p2.4.m4.1a"><msubsup id="S3.SS1.p2.4.m4.1.2" xref="S3.SS1.p2.4.m4.1.2.cmml"><mi id="S3.SS1.p2.4.m4.1.2.2.2" xref="S3.SS1.p2.4.m4.1.2.2.2.cmml">η</mi><mtext id="S3.SS1.p2.4.m4.1.2.2.3" xref="S3.SS1.p2.4.m4.1.2.2.3a.cmml">g</mtext><mrow id="S3.SS1.p2.4.m4.1.1.1.3" xref="S3.SS1.p2.4.m4.1.2.cmml"><mo id="S3.SS1.p2.4.m4.1.1.1.3.1" stretchy="false" xref="S3.SS1.p2.4.m4.1.2.cmml">(</mo><mi id="S3.SS1.p2.4.m4.1.1.1.1" xref="S3.SS1.p2.4.m4.1.1.1.1.cmml">t</mi><mo id="S3.SS1.p2.4.m4.1.1.1.3.2" stretchy="false" xref="S3.SS1.p2.4.m4.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.4.m4.1b"><apply id="S3.SS1.p2.4.m4.1.2.cmml" xref="S3.SS1.p2.4.m4.1.2"><csymbol cd="ambiguous" id="S3.SS1.p2.4.m4.1.2.1.cmml" xref="S3.SS1.p2.4.m4.1.2">superscript</csymbol><apply id="S3.SS1.p2.4.m4.1.2.2.cmml" xref="S3.SS1.p2.4.m4.1.2"><csymbol cd="ambiguous" id="S3.SS1.p2.4.m4.1.2.2.1.cmml" xref="S3.SS1.p2.4.m4.1.2">subscript</csymbol><ci id="S3.SS1.p2.4.m4.1.2.2.2.cmml" xref="S3.SS1.p2.4.m4.1.2.2.2">𝜂</ci><ci id="S3.SS1.p2.4.m4.1.2.2.3a.cmml" xref="S3.SS1.p2.4.m4.1.2.2.3"><mtext id="S3.SS1.p2.4.m4.1.2.2.3.cmml" mathsize="70%" xref="S3.SS1.p2.4.m4.1.2.2.3">g</mtext></ci></apply><ci id="S3.SS1.p2.4.m4.1.1.1.1.cmml" xref="S3.SS1.p2.4.m4.1.1.1.1">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.4.m4.1c">\eta_{\text{g}}^{(t)}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.4.m4.1d">italic_η start_POSTSUBSCRIPT g end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_t ) end_POSTSUPERSCRIPT</annotation></semantics></math> is the globally-determined learning rate for round <math alttext="t" class="ltx_Math" display="inline" id="S3.SS1.p2.5.m5.1"><semantics id="S3.SS1.p2.5.m5.1a"><mi id="S3.SS1.p2.5.m5.1.1" xref="S3.SS1.p2.5.m5.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.5.m5.1b"><ci id="S3.SS1.p2.5.m5.1.1.cmml" xref="S3.SS1.p2.5.m5.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.5.m5.1c">t</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.5.m5.1d">italic_t</annotation></semantics></math>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS1.p3">
<p class="ltx_p" id="S3.SS1.p3.11">To separately reconstruct each image, our attacker initializes <math alttext="\mathbf{X}\in\mathbb{R}^{N\times C\times H\times W}" class="ltx_Math" display="inline" id="S3.SS1.p3.1.m1.1"><semantics id="S3.SS1.p3.1.m1.1a"><mrow id="S3.SS1.p3.1.m1.1.1" xref="S3.SS1.p3.1.m1.1.1.cmml"><mi id="S3.SS1.p3.1.m1.1.1.2" xref="S3.SS1.p3.1.m1.1.1.2.cmml">𝐗</mi><mo id="S3.SS1.p3.1.m1.1.1.1" xref="S3.SS1.p3.1.m1.1.1.1.cmml">∈</mo><msup id="S3.SS1.p3.1.m1.1.1.3" xref="S3.SS1.p3.1.m1.1.1.3.cmml"><mi id="S3.SS1.p3.1.m1.1.1.3.2" xref="S3.SS1.p3.1.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS1.p3.1.m1.1.1.3.3" xref="S3.SS1.p3.1.m1.1.1.3.3.cmml"><mi id="S3.SS1.p3.1.m1.1.1.3.3.2" xref="S3.SS1.p3.1.m1.1.1.3.3.2.cmml">N</mi><mo id="S3.SS1.p3.1.m1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS1.p3.1.m1.1.1.3.3.1.cmml">×</mo><mi id="S3.SS1.p3.1.m1.1.1.3.3.3" xref="S3.SS1.p3.1.m1.1.1.3.3.3.cmml">C</mi><mo id="S3.SS1.p3.1.m1.1.1.3.3.1a" lspace="0.222em" rspace="0.222em" xref="S3.SS1.p3.1.m1.1.1.3.3.1.cmml">×</mo><mi id="S3.SS1.p3.1.m1.1.1.3.3.4" xref="S3.SS1.p3.1.m1.1.1.3.3.4.cmml">H</mi><mo id="S3.SS1.p3.1.m1.1.1.3.3.1b" lspace="0.222em" rspace="0.222em" xref="S3.SS1.p3.1.m1.1.1.3.3.1.cmml">×</mo><mi id="S3.SS1.p3.1.m1.1.1.3.3.5" xref="S3.SS1.p3.1.m1.1.1.3.3.5.cmml">W</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.1.m1.1b"><apply id="S3.SS1.p3.1.m1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1"><in id="S3.SS1.p3.1.m1.1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1.1"></in><ci id="S3.SS1.p3.1.m1.1.1.2.cmml" xref="S3.SS1.p3.1.m1.1.1.2">𝐗</ci><apply id="S3.SS1.p3.1.m1.1.1.3.cmml" xref="S3.SS1.p3.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p3.1.m1.1.1.3.1.cmml" xref="S3.SS1.p3.1.m1.1.1.3">superscript</csymbol><ci id="S3.SS1.p3.1.m1.1.1.3.2.cmml" xref="S3.SS1.p3.1.m1.1.1.3.2">ℝ</ci><apply id="S3.SS1.p3.1.m1.1.1.3.3.cmml" xref="S3.SS1.p3.1.m1.1.1.3.3"><times id="S3.SS1.p3.1.m1.1.1.3.3.1.cmml" xref="S3.SS1.p3.1.m1.1.1.3.3.1"></times><ci id="S3.SS1.p3.1.m1.1.1.3.3.2.cmml" xref="S3.SS1.p3.1.m1.1.1.3.3.2">𝑁</ci><ci id="S3.SS1.p3.1.m1.1.1.3.3.3.cmml" xref="S3.SS1.p3.1.m1.1.1.3.3.3">𝐶</ci><ci id="S3.SS1.p3.1.m1.1.1.3.3.4.cmml" xref="S3.SS1.p3.1.m1.1.1.3.3.4">𝐻</ci><ci id="S3.SS1.p3.1.m1.1.1.3.3.5.cmml" xref="S3.SS1.p3.1.m1.1.1.3.3.5">𝑊</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.1.m1.1c">\mathbf{X}\in\mathbb{R}^{N\times C\times H\times W}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.1.m1.1d">bold_X ∈ blackboard_R start_POSTSUPERSCRIPT italic_N × italic_C × italic_H × italic_W end_POSTSUPERSCRIPT</annotation></semantics></math>, where <math alttext="N=K\times M" class="ltx_Math" display="inline" id="S3.SS1.p3.2.m2.1"><semantics id="S3.SS1.p3.2.m2.1a"><mrow id="S3.SS1.p3.2.m2.1.1" xref="S3.SS1.p3.2.m2.1.1.cmml"><mi id="S3.SS1.p3.2.m2.1.1.2" xref="S3.SS1.p3.2.m2.1.1.2.cmml">N</mi><mo id="S3.SS1.p3.2.m2.1.1.1" xref="S3.SS1.p3.2.m2.1.1.1.cmml">=</mo><mrow id="S3.SS1.p3.2.m2.1.1.3" xref="S3.SS1.p3.2.m2.1.1.3.cmml"><mi id="S3.SS1.p3.2.m2.1.1.3.2" xref="S3.SS1.p3.2.m2.1.1.3.2.cmml">K</mi><mo id="S3.SS1.p3.2.m2.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS1.p3.2.m2.1.1.3.1.cmml">×</mo><mi id="S3.SS1.p3.2.m2.1.1.3.3" xref="S3.SS1.p3.2.m2.1.1.3.3.cmml">M</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.2.m2.1b"><apply id="S3.SS1.p3.2.m2.1.1.cmml" xref="S3.SS1.p3.2.m2.1.1"><eq id="S3.SS1.p3.2.m2.1.1.1.cmml" xref="S3.SS1.p3.2.m2.1.1.1"></eq><ci id="S3.SS1.p3.2.m2.1.1.2.cmml" xref="S3.SS1.p3.2.m2.1.1.2">𝑁</ci><apply id="S3.SS1.p3.2.m2.1.1.3.cmml" xref="S3.SS1.p3.2.m2.1.1.3"><times id="S3.SS1.p3.2.m2.1.1.3.1.cmml" xref="S3.SS1.p3.2.m2.1.1.3.1"></times><ci id="S3.SS1.p3.2.m2.1.1.3.2.cmml" xref="S3.SS1.p3.2.m2.1.1.3.2">𝐾</ci><ci id="S3.SS1.p3.2.m2.1.1.3.3.cmml" xref="S3.SS1.p3.2.m2.1.1.3.3">𝑀</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.2.m2.1c">N=K\times M</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.2.m2.1d">italic_N = italic_K × italic_M</annotation></semantics></math> represents the total number of training examples across <math alttext="K" class="ltx_Math" display="inline" id="S3.SS1.p3.3.m3.1"><semantics id="S3.SS1.p3.3.m3.1a"><mi id="S3.SS1.p3.3.m3.1.1" xref="S3.SS1.p3.3.m3.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.3.m3.1b"><ci id="S3.SS1.p3.3.m3.1.1.cmml" xref="S3.SS1.p3.3.m3.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.3.m3.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.3.m3.1d">italic_K</annotation></semantics></math> clients with batch size <math alttext="M" class="ltx_Math" display="inline" id="S3.SS1.p3.4.m4.1"><semantics id="S3.SS1.p3.4.m4.1a"><mi id="S3.SS1.p3.4.m4.1.1" xref="S3.SS1.p3.4.m4.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.4.m4.1b"><ci id="S3.SS1.p3.4.m4.1.1.cmml" xref="S3.SS1.p3.4.m4.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.4.m4.1c">M</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.4.m4.1d">italic_M</annotation></semantics></math>. <math alttext="C" class="ltx_Math" display="inline" id="S3.SS1.p3.5.m5.1"><semantics id="S3.SS1.p3.5.m5.1a"><mi id="S3.SS1.p3.5.m5.1.1" xref="S3.SS1.p3.5.m5.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.5.m5.1b"><ci id="S3.SS1.p3.5.m5.1.1.cmml" xref="S3.SS1.p3.5.m5.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.5.m5.1c">C</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.5.m5.1d">italic_C</annotation></semantics></math>, <math alttext="H" class="ltx_Math" display="inline" id="S3.SS1.p3.6.m6.1"><semantics id="S3.SS1.p3.6.m6.1a"><mi id="S3.SS1.p3.6.m6.1.1" xref="S3.SS1.p3.6.m6.1.1.cmml">H</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.6.m6.1b"><ci id="S3.SS1.p3.6.m6.1.1.cmml" xref="S3.SS1.p3.6.m6.1.1">𝐻</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.6.m6.1c">H</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.6.m6.1d">italic_H</annotation></semantics></math>, and <math alttext="W" class="ltx_Math" display="inline" id="S3.SS1.p3.7.m7.1"><semantics id="S3.SS1.p3.7.m7.1a"><mi id="S3.SS1.p3.7.m7.1.1" xref="S3.SS1.p3.7.m7.1.1.cmml">W</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.7.m7.1b"><ci id="S3.SS1.p3.7.m7.1.1.cmml" xref="S3.SS1.p3.7.m7.1.1">𝑊</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.7.m7.1c">W</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.7.m7.1d">italic_W</annotation></semantics></math> are the number of channels, and the height and width of the target images, respectively. We note that averaging the weight updates of several clients performing full-batch gradient descent is mathematically equivalent to computing a weight update over all clients’ training images. For <math alttext="K" class="ltx_Math" display="inline" id="S3.SS1.p3.8.m8.1"><semantics id="S3.SS1.p3.8.m8.1a"><mi id="S3.SS1.p3.8.m8.1.1" xref="S3.SS1.p3.8.m8.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.8.m8.1b"><ci id="S3.SS1.p3.8.m8.1.1.cmml" xref="S3.SS1.p3.8.m8.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.8.m8.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.8.m8.1d">italic_K</annotation></semantics></math> clients, each computing a local update <math alttext="\mathbf{W}_{k}" class="ltx_Math" display="inline" id="S3.SS1.p3.9.m9.1"><semantics id="S3.SS1.p3.9.m9.1a"><msub id="S3.SS1.p3.9.m9.1.1" xref="S3.SS1.p3.9.m9.1.1.cmml"><mi id="S3.SS1.p3.9.m9.1.1.2" xref="S3.SS1.p3.9.m9.1.1.2.cmml">𝐖</mi><mi id="S3.SS1.p3.9.m9.1.1.3" xref="S3.SS1.p3.9.m9.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.9.m9.1b"><apply id="S3.SS1.p3.9.m9.1.1.cmml" xref="S3.SS1.p3.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.9.m9.1.1.1.cmml" xref="S3.SS1.p3.9.m9.1.1">subscript</csymbol><ci id="S3.SS1.p3.9.m9.1.1.2.cmml" xref="S3.SS1.p3.9.m9.1.1.2">𝐖</ci><ci id="S3.SS1.p3.9.m9.1.1.3.cmml" xref="S3.SS1.p3.9.m9.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.9.m9.1c">\mathbf{W}_{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.9.m9.1d">bold_W start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> using full-batch gradient descent over a local dataset of size <math alttext="M" class="ltx_Math" display="inline" id="S3.SS1.p3.10.m10.1"><semantics id="S3.SS1.p3.10.m10.1a"><mi id="S3.SS1.p3.10.m10.1.1" xref="S3.SS1.p3.10.m10.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.10.m10.1b"><ci id="S3.SS1.p3.10.m10.1.1.cmml" xref="S3.SS1.p3.10.m10.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.10.m10.1c">M</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.10.m10.1d">italic_M</annotation></semantics></math>, the server updates the global model’s weights by averaging the weights transmitted by each client: <math alttext="\mathbf{W}^{(t+1)}=\frac{1}{K}\sum_{k=1}^{K}\mathbf{W}_{k}^{(t+1)}" class="ltx_Math" display="inline" id="S3.SS1.p3.11.m11.2"><semantics id="S3.SS1.p3.11.m11.2a"><mrow id="S3.SS1.p3.11.m11.2.3" xref="S3.SS1.p3.11.m11.2.3.cmml"><msup id="S3.SS1.p3.11.m11.2.3.2" xref="S3.SS1.p3.11.m11.2.3.2.cmml"><mi id="S3.SS1.p3.11.m11.2.3.2.2" xref="S3.SS1.p3.11.m11.2.3.2.2.cmml">𝐖</mi><mrow id="S3.SS1.p3.11.m11.1.1.1.1" xref="S3.SS1.p3.11.m11.1.1.1.1.1.cmml"><mo id="S3.SS1.p3.11.m11.1.1.1.1.2" stretchy="false" xref="S3.SS1.p3.11.m11.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS1.p3.11.m11.1.1.1.1.1" xref="S3.SS1.p3.11.m11.1.1.1.1.1.cmml"><mi id="S3.SS1.p3.11.m11.1.1.1.1.1.2" xref="S3.SS1.p3.11.m11.1.1.1.1.1.2.cmml">t</mi><mo id="S3.SS1.p3.11.m11.1.1.1.1.1.1" xref="S3.SS1.p3.11.m11.1.1.1.1.1.1.cmml">+</mo><mn id="S3.SS1.p3.11.m11.1.1.1.1.1.3" xref="S3.SS1.p3.11.m11.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S3.SS1.p3.11.m11.1.1.1.1.3" stretchy="false" xref="S3.SS1.p3.11.m11.1.1.1.1.1.cmml">)</mo></mrow></msup><mo id="S3.SS1.p3.11.m11.2.3.1" xref="S3.SS1.p3.11.m11.2.3.1.cmml">=</mo><mrow id="S3.SS1.p3.11.m11.2.3.3" xref="S3.SS1.p3.11.m11.2.3.3.cmml"><mfrac id="S3.SS1.p3.11.m11.2.3.3.2" xref="S3.SS1.p3.11.m11.2.3.3.2.cmml"><mn id="S3.SS1.p3.11.m11.2.3.3.2.2" xref="S3.SS1.p3.11.m11.2.3.3.2.2.cmml">1</mn><mi id="S3.SS1.p3.11.m11.2.3.3.2.3" xref="S3.SS1.p3.11.m11.2.3.3.2.3.cmml">K</mi></mfrac><mo id="S3.SS1.p3.11.m11.2.3.3.1" xref="S3.SS1.p3.11.m11.2.3.3.1.cmml">⁢</mo><mrow id="S3.SS1.p3.11.m11.2.3.3.3" xref="S3.SS1.p3.11.m11.2.3.3.3.cmml"><msubsup id="S3.SS1.p3.11.m11.2.3.3.3.1" xref="S3.SS1.p3.11.m11.2.3.3.3.1.cmml"><mo id="S3.SS1.p3.11.m11.2.3.3.3.1.2.2" xref="S3.SS1.p3.11.m11.2.3.3.3.1.2.2.cmml">∑</mo><mrow id="S3.SS1.p3.11.m11.2.3.3.3.1.2.3" xref="S3.SS1.p3.11.m11.2.3.3.3.1.2.3.cmml"><mi id="S3.SS1.p3.11.m11.2.3.3.3.1.2.3.2" xref="S3.SS1.p3.11.m11.2.3.3.3.1.2.3.2.cmml">k</mi><mo id="S3.SS1.p3.11.m11.2.3.3.3.1.2.3.1" xref="S3.SS1.p3.11.m11.2.3.3.3.1.2.3.1.cmml">=</mo><mn id="S3.SS1.p3.11.m11.2.3.3.3.1.2.3.3" xref="S3.SS1.p3.11.m11.2.3.3.3.1.2.3.3.cmml">1</mn></mrow><mi id="S3.SS1.p3.11.m11.2.3.3.3.1.3" xref="S3.SS1.p3.11.m11.2.3.3.3.1.3.cmml">K</mi></msubsup><msubsup id="S3.SS1.p3.11.m11.2.3.3.3.2" xref="S3.SS1.p3.11.m11.2.3.3.3.2.cmml"><mi id="S3.SS1.p3.11.m11.2.3.3.3.2.2.2" xref="S3.SS1.p3.11.m11.2.3.3.3.2.2.2.cmml">𝐖</mi><mi id="S3.SS1.p3.11.m11.2.3.3.3.2.2.3" xref="S3.SS1.p3.11.m11.2.3.3.3.2.2.3.cmml">k</mi><mrow id="S3.SS1.p3.11.m11.2.2.1.1" xref="S3.SS1.p3.11.m11.2.2.1.1.1.cmml"><mo id="S3.SS1.p3.11.m11.2.2.1.1.2" stretchy="false" xref="S3.SS1.p3.11.m11.2.2.1.1.1.cmml">(</mo><mrow id="S3.SS1.p3.11.m11.2.2.1.1.1" xref="S3.SS1.p3.11.m11.2.2.1.1.1.cmml"><mi id="S3.SS1.p3.11.m11.2.2.1.1.1.2" xref="S3.SS1.p3.11.m11.2.2.1.1.1.2.cmml">t</mi><mo id="S3.SS1.p3.11.m11.2.2.1.1.1.1" xref="S3.SS1.p3.11.m11.2.2.1.1.1.1.cmml">+</mo><mn id="S3.SS1.p3.11.m11.2.2.1.1.1.3" xref="S3.SS1.p3.11.m11.2.2.1.1.1.3.cmml">1</mn></mrow><mo id="S3.SS1.p3.11.m11.2.2.1.1.3" stretchy="false" xref="S3.SS1.p3.11.m11.2.2.1.1.1.cmml">)</mo></mrow></msubsup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.11.m11.2b"><apply id="S3.SS1.p3.11.m11.2.3.cmml" xref="S3.SS1.p3.11.m11.2.3"><eq id="S3.SS1.p3.11.m11.2.3.1.cmml" xref="S3.SS1.p3.11.m11.2.3.1"></eq><apply id="S3.SS1.p3.11.m11.2.3.2.cmml" xref="S3.SS1.p3.11.m11.2.3.2"><csymbol cd="ambiguous" id="S3.SS1.p3.11.m11.2.3.2.1.cmml" xref="S3.SS1.p3.11.m11.2.3.2">superscript</csymbol><ci id="S3.SS1.p3.11.m11.2.3.2.2.cmml" xref="S3.SS1.p3.11.m11.2.3.2.2">𝐖</ci><apply id="S3.SS1.p3.11.m11.1.1.1.1.1.cmml" xref="S3.SS1.p3.11.m11.1.1.1.1"><plus id="S3.SS1.p3.11.m11.1.1.1.1.1.1.cmml" xref="S3.SS1.p3.11.m11.1.1.1.1.1.1"></plus><ci id="S3.SS1.p3.11.m11.1.1.1.1.1.2.cmml" xref="S3.SS1.p3.11.m11.1.1.1.1.1.2">𝑡</ci><cn id="S3.SS1.p3.11.m11.1.1.1.1.1.3.cmml" type="integer" xref="S3.SS1.p3.11.m11.1.1.1.1.1.3">1</cn></apply></apply><apply id="S3.SS1.p3.11.m11.2.3.3.cmml" xref="S3.SS1.p3.11.m11.2.3.3"><times id="S3.SS1.p3.11.m11.2.3.3.1.cmml" xref="S3.SS1.p3.11.m11.2.3.3.1"></times><apply id="S3.SS1.p3.11.m11.2.3.3.2.cmml" xref="S3.SS1.p3.11.m11.2.3.3.2"><divide id="S3.SS1.p3.11.m11.2.3.3.2.1.cmml" xref="S3.SS1.p3.11.m11.2.3.3.2"></divide><cn id="S3.SS1.p3.11.m11.2.3.3.2.2.cmml" type="integer" xref="S3.SS1.p3.11.m11.2.3.3.2.2">1</cn><ci id="S3.SS1.p3.11.m11.2.3.3.2.3.cmml" xref="S3.SS1.p3.11.m11.2.3.3.2.3">𝐾</ci></apply><apply id="S3.SS1.p3.11.m11.2.3.3.3.cmml" xref="S3.SS1.p3.11.m11.2.3.3.3"><apply id="S3.SS1.p3.11.m11.2.3.3.3.1.cmml" xref="S3.SS1.p3.11.m11.2.3.3.3.1"><csymbol cd="ambiguous" id="S3.SS1.p3.11.m11.2.3.3.3.1.1.cmml" xref="S3.SS1.p3.11.m11.2.3.3.3.1">superscript</csymbol><apply id="S3.SS1.p3.11.m11.2.3.3.3.1.2.cmml" xref="S3.SS1.p3.11.m11.2.3.3.3.1"><csymbol cd="ambiguous" id="S3.SS1.p3.11.m11.2.3.3.3.1.2.1.cmml" xref="S3.SS1.p3.11.m11.2.3.3.3.1">subscript</csymbol><sum id="S3.SS1.p3.11.m11.2.3.3.3.1.2.2.cmml" xref="S3.SS1.p3.11.m11.2.3.3.3.1.2.2"></sum><apply id="S3.SS1.p3.11.m11.2.3.3.3.1.2.3.cmml" xref="S3.SS1.p3.11.m11.2.3.3.3.1.2.3"><eq id="S3.SS1.p3.11.m11.2.3.3.3.1.2.3.1.cmml" xref="S3.SS1.p3.11.m11.2.3.3.3.1.2.3.1"></eq><ci id="S3.SS1.p3.11.m11.2.3.3.3.1.2.3.2.cmml" xref="S3.SS1.p3.11.m11.2.3.3.3.1.2.3.2">𝑘</ci><cn id="S3.SS1.p3.11.m11.2.3.3.3.1.2.3.3.cmml" type="integer" xref="S3.SS1.p3.11.m11.2.3.3.3.1.2.3.3">1</cn></apply></apply><ci id="S3.SS1.p3.11.m11.2.3.3.3.1.3.cmml" xref="S3.SS1.p3.11.m11.2.3.3.3.1.3">𝐾</ci></apply><apply id="S3.SS1.p3.11.m11.2.3.3.3.2.cmml" xref="S3.SS1.p3.11.m11.2.3.3.3.2"><csymbol cd="ambiguous" id="S3.SS1.p3.11.m11.2.3.3.3.2.1.cmml" xref="S3.SS1.p3.11.m11.2.3.3.3.2">superscript</csymbol><apply id="S3.SS1.p3.11.m11.2.3.3.3.2.2.cmml" xref="S3.SS1.p3.11.m11.2.3.3.3.2"><csymbol cd="ambiguous" id="S3.SS1.p3.11.m11.2.3.3.3.2.2.1.cmml" xref="S3.SS1.p3.11.m11.2.3.3.3.2">subscript</csymbol><ci id="S3.SS1.p3.11.m11.2.3.3.3.2.2.2.cmml" xref="S3.SS1.p3.11.m11.2.3.3.3.2.2.2">𝐖</ci><ci id="S3.SS1.p3.11.m11.2.3.3.3.2.2.3.cmml" xref="S3.SS1.p3.11.m11.2.3.3.3.2.2.3">𝑘</ci></apply><apply id="S3.SS1.p3.11.m11.2.2.1.1.1.cmml" xref="S3.SS1.p3.11.m11.2.2.1.1"><plus id="S3.SS1.p3.11.m11.2.2.1.1.1.1.cmml" xref="S3.SS1.p3.11.m11.2.2.1.1.1.1"></plus><ci id="S3.SS1.p3.11.m11.2.2.1.1.1.2.cmml" xref="S3.SS1.p3.11.m11.2.2.1.1.1.2">𝑡</ci><cn id="S3.SS1.p3.11.m11.2.2.1.1.1.3.cmml" type="integer" xref="S3.SS1.p3.11.m11.2.2.1.1.1.3">1</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.11.m11.2c">\mathbf{W}^{(t+1)}=\frac{1}{K}\sum_{k=1}^{K}\mathbf{W}_{k}^{(t+1)}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.11.m11.2d">bold_W start_POSTSUPERSCRIPT ( italic_t + 1 ) end_POSTSUPERSCRIPT = divide start_ARG 1 end_ARG start_ARG italic_K end_ARG ∑ start_POSTSUBSCRIPT italic_k = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT bold_W start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_t + 1 ) end_POSTSUPERSCRIPT</annotation></semantics></math>. For each client using full batch gradient descent, the local weight update can be expressed as:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{W}_{k}^{(t+1)}=\mathbf{W}^{(t)}-\eta_{\text{g}}\frac{1}{M}\sum_{i=1}^{%
M}f(\mathbf{W}^{(t)};\mathbf{X}_{k,i})," class="ltx_Math" display="block" id="S3.E1.m1.6"><semantics id="S3.E1.m1.6a"><mrow id="S3.E1.m1.6.6.1" xref="S3.E1.m1.6.6.1.1.cmml"><mrow id="S3.E1.m1.6.6.1.1" xref="S3.E1.m1.6.6.1.1.cmml"><msubsup id="S3.E1.m1.6.6.1.1.4" xref="S3.E1.m1.6.6.1.1.4.cmml"><mi id="S3.E1.m1.6.6.1.1.4.2.2" xref="S3.E1.m1.6.6.1.1.4.2.2.cmml">𝐖</mi><mi id="S3.E1.m1.6.6.1.1.4.2.3" xref="S3.E1.m1.6.6.1.1.4.2.3.cmml">k</mi><mrow id="S3.E1.m1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.cmml"><mo id="S3.E1.m1.1.1.1.1.2" stretchy="false" xref="S3.E1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E1.m1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.cmml"><mi id="S3.E1.m1.1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.1.2.cmml">t</mi><mo id="S3.E1.m1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.cmml">+</mo><mn id="S3.E1.m1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S3.E1.m1.1.1.1.1.3" stretchy="false" xref="S3.E1.m1.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S3.E1.m1.6.6.1.1.3" xref="S3.E1.m1.6.6.1.1.3.cmml">=</mo><mrow id="S3.E1.m1.6.6.1.1.2" xref="S3.E1.m1.6.6.1.1.2.cmml"><msup id="S3.E1.m1.6.6.1.1.2.4" xref="S3.E1.m1.6.6.1.1.2.4.cmml"><mi id="S3.E1.m1.6.6.1.1.2.4.2" xref="S3.E1.m1.6.6.1.1.2.4.2.cmml">𝐖</mi><mrow id="S3.E1.m1.2.2.1.3" xref="S3.E1.m1.6.6.1.1.2.4.cmml"><mo id="S3.E1.m1.2.2.1.3.1" stretchy="false" xref="S3.E1.m1.6.6.1.1.2.4.cmml">(</mo><mi id="S3.E1.m1.2.2.1.1" xref="S3.E1.m1.2.2.1.1.cmml">t</mi><mo id="S3.E1.m1.2.2.1.3.2" stretchy="false" xref="S3.E1.m1.6.6.1.1.2.4.cmml">)</mo></mrow></msup><mo id="S3.E1.m1.6.6.1.1.2.3" xref="S3.E1.m1.6.6.1.1.2.3.cmml">−</mo><mrow id="S3.E1.m1.6.6.1.1.2.2" xref="S3.E1.m1.6.6.1.1.2.2.cmml"><msub id="S3.E1.m1.6.6.1.1.2.2.4" xref="S3.E1.m1.6.6.1.1.2.2.4.cmml"><mi id="S3.E1.m1.6.6.1.1.2.2.4.2" xref="S3.E1.m1.6.6.1.1.2.2.4.2.cmml">η</mi><mtext id="S3.E1.m1.6.6.1.1.2.2.4.3" xref="S3.E1.m1.6.6.1.1.2.2.4.3a.cmml">g</mtext></msub><mo id="S3.E1.m1.6.6.1.1.2.2.3" xref="S3.E1.m1.6.6.1.1.2.2.3.cmml">⁢</mo><mfrac id="S3.E1.m1.6.6.1.1.2.2.5" xref="S3.E1.m1.6.6.1.1.2.2.5.cmml"><mn id="S3.E1.m1.6.6.1.1.2.2.5.2" xref="S3.E1.m1.6.6.1.1.2.2.5.2.cmml">1</mn><mi id="S3.E1.m1.6.6.1.1.2.2.5.3" xref="S3.E1.m1.6.6.1.1.2.2.5.3.cmml">M</mi></mfrac><mo id="S3.E1.m1.6.6.1.1.2.2.3a" xref="S3.E1.m1.6.6.1.1.2.2.3.cmml">⁢</mo><mrow id="S3.E1.m1.6.6.1.1.2.2.2" xref="S3.E1.m1.6.6.1.1.2.2.2.cmml"><munderover id="S3.E1.m1.6.6.1.1.2.2.2.3" xref="S3.E1.m1.6.6.1.1.2.2.2.3.cmml"><mo id="S3.E1.m1.6.6.1.1.2.2.2.3.2.2" movablelimits="false" xref="S3.E1.m1.6.6.1.1.2.2.2.3.2.2.cmml">∑</mo><mrow id="S3.E1.m1.6.6.1.1.2.2.2.3.2.3" xref="S3.E1.m1.6.6.1.1.2.2.2.3.2.3.cmml"><mi id="S3.E1.m1.6.6.1.1.2.2.2.3.2.3.2" xref="S3.E1.m1.6.6.1.1.2.2.2.3.2.3.2.cmml">i</mi><mo id="S3.E1.m1.6.6.1.1.2.2.2.3.2.3.1" xref="S3.E1.m1.6.6.1.1.2.2.2.3.2.3.1.cmml">=</mo><mn id="S3.E1.m1.6.6.1.1.2.2.2.3.2.3.3" xref="S3.E1.m1.6.6.1.1.2.2.2.3.2.3.3.cmml">1</mn></mrow><mi id="S3.E1.m1.6.6.1.1.2.2.2.3.3" xref="S3.E1.m1.6.6.1.1.2.2.2.3.3.cmml">M</mi></munderover><mrow id="S3.E1.m1.6.6.1.1.2.2.2.2" xref="S3.E1.m1.6.6.1.1.2.2.2.2.cmml"><mi id="S3.E1.m1.6.6.1.1.2.2.2.2.4" xref="S3.E1.m1.6.6.1.1.2.2.2.2.4.cmml">f</mi><mo id="S3.E1.m1.6.6.1.1.2.2.2.2.3" xref="S3.E1.m1.6.6.1.1.2.2.2.2.3.cmml">⁢</mo><mrow id="S3.E1.m1.6.6.1.1.2.2.2.2.2.2" xref="S3.E1.m1.6.6.1.1.2.2.2.2.2.3.cmml"><mo id="S3.E1.m1.6.6.1.1.2.2.2.2.2.2.3" stretchy="false" xref="S3.E1.m1.6.6.1.1.2.2.2.2.2.3.cmml">(</mo><msup id="S3.E1.m1.6.6.1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.6.6.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E1.m1.6.6.1.1.1.1.1.1.1.1.1.2" xref="S3.E1.m1.6.6.1.1.1.1.1.1.1.1.1.2.cmml">𝐖</mi><mrow id="S3.E1.m1.3.3.1.3" xref="S3.E1.m1.6.6.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E1.m1.3.3.1.3.1" stretchy="false" xref="S3.E1.m1.6.6.1.1.1.1.1.1.1.1.1.cmml">(</mo><mi id="S3.E1.m1.3.3.1.1" xref="S3.E1.m1.3.3.1.1.cmml">t</mi><mo id="S3.E1.m1.3.3.1.3.2" stretchy="false" xref="S3.E1.m1.6.6.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></msup><mo id="S3.E1.m1.6.6.1.1.2.2.2.2.2.2.4" xref="S3.E1.m1.6.6.1.1.2.2.2.2.2.3.cmml">;</mo><msub id="S3.E1.m1.6.6.1.1.2.2.2.2.2.2.2" xref="S3.E1.m1.6.6.1.1.2.2.2.2.2.2.2.cmml"><mi id="S3.E1.m1.6.6.1.1.2.2.2.2.2.2.2.2" xref="S3.E1.m1.6.6.1.1.2.2.2.2.2.2.2.2.cmml">𝐗</mi><mrow id="S3.E1.m1.5.5.2.4" xref="S3.E1.m1.5.5.2.3.cmml"><mi id="S3.E1.m1.4.4.1.1" xref="S3.E1.m1.4.4.1.1.cmml">k</mi><mo id="S3.E1.m1.5.5.2.4.1" xref="S3.E1.m1.5.5.2.3.cmml">,</mo><mi id="S3.E1.m1.5.5.2.2" xref="S3.E1.m1.5.5.2.2.cmml">i</mi></mrow></msub><mo id="S3.E1.m1.6.6.1.1.2.2.2.2.2.2.5" stretchy="false" xref="S3.E1.m1.6.6.1.1.2.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mrow><mo id="S3.E1.m1.6.6.1.2" xref="S3.E1.m1.6.6.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.6b"><apply id="S3.E1.m1.6.6.1.1.cmml" xref="S3.E1.m1.6.6.1"><eq id="S3.E1.m1.6.6.1.1.3.cmml" xref="S3.E1.m1.6.6.1.1.3"></eq><apply id="S3.E1.m1.6.6.1.1.4.cmml" xref="S3.E1.m1.6.6.1.1.4"><csymbol cd="ambiguous" id="S3.E1.m1.6.6.1.1.4.1.cmml" xref="S3.E1.m1.6.6.1.1.4">superscript</csymbol><apply id="S3.E1.m1.6.6.1.1.4.2.cmml" xref="S3.E1.m1.6.6.1.1.4"><csymbol cd="ambiguous" id="S3.E1.m1.6.6.1.1.4.2.1.cmml" xref="S3.E1.m1.6.6.1.1.4">subscript</csymbol><ci id="S3.E1.m1.6.6.1.1.4.2.2.cmml" xref="S3.E1.m1.6.6.1.1.4.2.2">𝐖</ci><ci id="S3.E1.m1.6.6.1.1.4.2.3.cmml" xref="S3.E1.m1.6.6.1.1.4.2.3">𝑘</ci></apply><apply id="S3.E1.m1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1"><plus id="S3.E1.m1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1"></plus><ci id="S3.E1.m1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.1.2">𝑡</ci><cn id="S3.E1.m1.1.1.1.1.1.3.cmml" type="integer" xref="S3.E1.m1.1.1.1.1.1.3">1</cn></apply></apply><apply id="S3.E1.m1.6.6.1.1.2.cmml" xref="S3.E1.m1.6.6.1.1.2"><minus id="S3.E1.m1.6.6.1.1.2.3.cmml" xref="S3.E1.m1.6.6.1.1.2.3"></minus><apply id="S3.E1.m1.6.6.1.1.2.4.cmml" xref="S3.E1.m1.6.6.1.1.2.4"><csymbol cd="ambiguous" id="S3.E1.m1.6.6.1.1.2.4.1.cmml" xref="S3.E1.m1.6.6.1.1.2.4">superscript</csymbol><ci id="S3.E1.m1.6.6.1.1.2.4.2.cmml" xref="S3.E1.m1.6.6.1.1.2.4.2">𝐖</ci><ci id="S3.E1.m1.2.2.1.1.cmml" xref="S3.E1.m1.2.2.1.1">𝑡</ci></apply><apply id="S3.E1.m1.6.6.1.1.2.2.cmml" xref="S3.E1.m1.6.6.1.1.2.2"><times id="S3.E1.m1.6.6.1.1.2.2.3.cmml" xref="S3.E1.m1.6.6.1.1.2.2.3"></times><apply id="S3.E1.m1.6.6.1.1.2.2.4.cmml" xref="S3.E1.m1.6.6.1.1.2.2.4"><csymbol cd="ambiguous" id="S3.E1.m1.6.6.1.1.2.2.4.1.cmml" xref="S3.E1.m1.6.6.1.1.2.2.4">subscript</csymbol><ci id="S3.E1.m1.6.6.1.1.2.2.4.2.cmml" xref="S3.E1.m1.6.6.1.1.2.2.4.2">𝜂</ci><ci id="S3.E1.m1.6.6.1.1.2.2.4.3a.cmml" xref="S3.E1.m1.6.6.1.1.2.2.4.3"><mtext id="S3.E1.m1.6.6.1.1.2.2.4.3.cmml" mathsize="70%" xref="S3.E1.m1.6.6.1.1.2.2.4.3">g</mtext></ci></apply><apply id="S3.E1.m1.6.6.1.1.2.2.5.cmml" xref="S3.E1.m1.6.6.1.1.2.2.5"><divide id="S3.E1.m1.6.6.1.1.2.2.5.1.cmml" xref="S3.E1.m1.6.6.1.1.2.2.5"></divide><cn id="S3.E1.m1.6.6.1.1.2.2.5.2.cmml" type="integer" xref="S3.E1.m1.6.6.1.1.2.2.5.2">1</cn><ci id="S3.E1.m1.6.6.1.1.2.2.5.3.cmml" xref="S3.E1.m1.6.6.1.1.2.2.5.3">𝑀</ci></apply><apply id="S3.E1.m1.6.6.1.1.2.2.2.cmml" xref="S3.E1.m1.6.6.1.1.2.2.2"><apply id="S3.E1.m1.6.6.1.1.2.2.2.3.cmml" xref="S3.E1.m1.6.6.1.1.2.2.2.3"><csymbol cd="ambiguous" id="S3.E1.m1.6.6.1.1.2.2.2.3.1.cmml" xref="S3.E1.m1.6.6.1.1.2.2.2.3">superscript</csymbol><apply id="S3.E1.m1.6.6.1.1.2.2.2.3.2.cmml" xref="S3.E1.m1.6.6.1.1.2.2.2.3"><csymbol cd="ambiguous" id="S3.E1.m1.6.6.1.1.2.2.2.3.2.1.cmml" xref="S3.E1.m1.6.6.1.1.2.2.2.3">subscript</csymbol><sum id="S3.E1.m1.6.6.1.1.2.2.2.3.2.2.cmml" xref="S3.E1.m1.6.6.1.1.2.2.2.3.2.2"></sum><apply id="S3.E1.m1.6.6.1.1.2.2.2.3.2.3.cmml" xref="S3.E1.m1.6.6.1.1.2.2.2.3.2.3"><eq id="S3.E1.m1.6.6.1.1.2.2.2.3.2.3.1.cmml" xref="S3.E1.m1.6.6.1.1.2.2.2.3.2.3.1"></eq><ci id="S3.E1.m1.6.6.1.1.2.2.2.3.2.3.2.cmml" xref="S3.E1.m1.6.6.1.1.2.2.2.3.2.3.2">𝑖</ci><cn id="S3.E1.m1.6.6.1.1.2.2.2.3.2.3.3.cmml" type="integer" xref="S3.E1.m1.6.6.1.1.2.2.2.3.2.3.3">1</cn></apply></apply><ci id="S3.E1.m1.6.6.1.1.2.2.2.3.3.cmml" xref="S3.E1.m1.6.6.1.1.2.2.2.3.3">𝑀</ci></apply><apply id="S3.E1.m1.6.6.1.1.2.2.2.2.cmml" xref="S3.E1.m1.6.6.1.1.2.2.2.2"><times id="S3.E1.m1.6.6.1.1.2.2.2.2.3.cmml" xref="S3.E1.m1.6.6.1.1.2.2.2.2.3"></times><ci id="S3.E1.m1.6.6.1.1.2.2.2.2.4.cmml" xref="S3.E1.m1.6.6.1.1.2.2.2.2.4">𝑓</ci><list id="S3.E1.m1.6.6.1.1.2.2.2.2.2.3.cmml" xref="S3.E1.m1.6.6.1.1.2.2.2.2.2.2"><apply id="S3.E1.m1.6.6.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.6.6.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.6.6.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.6.6.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E1.m1.6.6.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.6.6.1.1.1.1.1.1.1.1.1.2">𝐖</ci><ci id="S3.E1.m1.3.3.1.1.cmml" xref="S3.E1.m1.3.3.1.1">𝑡</ci></apply><apply id="S3.E1.m1.6.6.1.1.2.2.2.2.2.2.2.cmml" xref="S3.E1.m1.6.6.1.1.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.6.6.1.1.2.2.2.2.2.2.2.1.cmml" xref="S3.E1.m1.6.6.1.1.2.2.2.2.2.2.2">subscript</csymbol><ci id="S3.E1.m1.6.6.1.1.2.2.2.2.2.2.2.2.cmml" xref="S3.E1.m1.6.6.1.1.2.2.2.2.2.2.2.2">𝐗</ci><list id="S3.E1.m1.5.5.2.3.cmml" xref="S3.E1.m1.5.5.2.4"><ci id="S3.E1.m1.4.4.1.1.cmml" xref="S3.E1.m1.4.4.1.1">𝑘</ci><ci id="S3.E1.m1.5.5.2.2.cmml" xref="S3.E1.m1.5.5.2.2">𝑖</ci></list></apply></list></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.6c">\mathbf{W}_{k}^{(t+1)}=\mathbf{W}^{(t)}-\eta_{\text{g}}\frac{1}{M}\sum_{i=1}^{%
M}f(\mathbf{W}^{(t)};\mathbf{X}_{k,i}),</annotation><annotation encoding="application/x-llamapun" id="S3.E1.m1.6d">bold_W start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_t + 1 ) end_POSTSUPERSCRIPT = bold_W start_POSTSUPERSCRIPT ( italic_t ) end_POSTSUPERSCRIPT - italic_η start_POSTSUBSCRIPT g end_POSTSUBSCRIPT divide start_ARG 1 end_ARG start_ARG italic_M end_ARG ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_M end_POSTSUPERSCRIPT italic_f ( bold_W start_POSTSUPERSCRIPT ( italic_t ) end_POSTSUPERSCRIPT ; bold_X start_POSTSUBSCRIPT italic_k , italic_i end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS1.p3.18">where <math alttext="\mathbf{X}_{k,i}\in\mathbb{R}^{C\times H\times W}" class="ltx_Math" display="inline" id="S3.SS1.p3.12.m1.2"><semantics id="S3.SS1.p3.12.m1.2a"><mrow id="S3.SS1.p3.12.m1.2.3" xref="S3.SS1.p3.12.m1.2.3.cmml"><msub id="S3.SS1.p3.12.m1.2.3.2" xref="S3.SS1.p3.12.m1.2.3.2.cmml"><mi id="S3.SS1.p3.12.m1.2.3.2.2" xref="S3.SS1.p3.12.m1.2.3.2.2.cmml">𝐗</mi><mrow id="S3.SS1.p3.12.m1.2.2.2.4" xref="S3.SS1.p3.12.m1.2.2.2.3.cmml"><mi id="S3.SS1.p3.12.m1.1.1.1.1" xref="S3.SS1.p3.12.m1.1.1.1.1.cmml">k</mi><mo id="S3.SS1.p3.12.m1.2.2.2.4.1" xref="S3.SS1.p3.12.m1.2.2.2.3.cmml">,</mo><mi id="S3.SS1.p3.12.m1.2.2.2.2" xref="S3.SS1.p3.12.m1.2.2.2.2.cmml">i</mi></mrow></msub><mo id="S3.SS1.p3.12.m1.2.3.1" xref="S3.SS1.p3.12.m1.2.3.1.cmml">∈</mo><msup id="S3.SS1.p3.12.m1.2.3.3" xref="S3.SS1.p3.12.m1.2.3.3.cmml"><mi id="S3.SS1.p3.12.m1.2.3.3.2" xref="S3.SS1.p3.12.m1.2.3.3.2.cmml">ℝ</mi><mrow id="S3.SS1.p3.12.m1.2.3.3.3" xref="S3.SS1.p3.12.m1.2.3.3.3.cmml"><mi id="S3.SS1.p3.12.m1.2.3.3.3.2" xref="S3.SS1.p3.12.m1.2.3.3.3.2.cmml">C</mi><mo id="S3.SS1.p3.12.m1.2.3.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS1.p3.12.m1.2.3.3.3.1.cmml">×</mo><mi id="S3.SS1.p3.12.m1.2.3.3.3.3" xref="S3.SS1.p3.12.m1.2.3.3.3.3.cmml">H</mi><mo id="S3.SS1.p3.12.m1.2.3.3.3.1a" lspace="0.222em" rspace="0.222em" xref="S3.SS1.p3.12.m1.2.3.3.3.1.cmml">×</mo><mi id="S3.SS1.p3.12.m1.2.3.3.3.4" xref="S3.SS1.p3.12.m1.2.3.3.3.4.cmml">W</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.12.m1.2b"><apply id="S3.SS1.p3.12.m1.2.3.cmml" xref="S3.SS1.p3.12.m1.2.3"><in id="S3.SS1.p3.12.m1.2.3.1.cmml" xref="S3.SS1.p3.12.m1.2.3.1"></in><apply id="S3.SS1.p3.12.m1.2.3.2.cmml" xref="S3.SS1.p3.12.m1.2.3.2"><csymbol cd="ambiguous" id="S3.SS1.p3.12.m1.2.3.2.1.cmml" xref="S3.SS1.p3.12.m1.2.3.2">subscript</csymbol><ci id="S3.SS1.p3.12.m1.2.3.2.2.cmml" xref="S3.SS1.p3.12.m1.2.3.2.2">𝐗</ci><list id="S3.SS1.p3.12.m1.2.2.2.3.cmml" xref="S3.SS1.p3.12.m1.2.2.2.4"><ci id="S3.SS1.p3.12.m1.1.1.1.1.cmml" xref="S3.SS1.p3.12.m1.1.1.1.1">𝑘</ci><ci id="S3.SS1.p3.12.m1.2.2.2.2.cmml" xref="S3.SS1.p3.12.m1.2.2.2.2">𝑖</ci></list></apply><apply id="S3.SS1.p3.12.m1.2.3.3.cmml" xref="S3.SS1.p3.12.m1.2.3.3"><csymbol cd="ambiguous" id="S3.SS1.p3.12.m1.2.3.3.1.cmml" xref="S3.SS1.p3.12.m1.2.3.3">superscript</csymbol><ci id="S3.SS1.p3.12.m1.2.3.3.2.cmml" xref="S3.SS1.p3.12.m1.2.3.3.2">ℝ</ci><apply id="S3.SS1.p3.12.m1.2.3.3.3.cmml" xref="S3.SS1.p3.12.m1.2.3.3.3"><times id="S3.SS1.p3.12.m1.2.3.3.3.1.cmml" xref="S3.SS1.p3.12.m1.2.3.3.3.1"></times><ci id="S3.SS1.p3.12.m1.2.3.3.3.2.cmml" xref="S3.SS1.p3.12.m1.2.3.3.3.2">𝐶</ci><ci id="S3.SS1.p3.12.m1.2.3.3.3.3.cmml" xref="S3.SS1.p3.12.m1.2.3.3.3.3">𝐻</ci><ci id="S3.SS1.p3.12.m1.2.3.3.3.4.cmml" xref="S3.SS1.p3.12.m1.2.3.3.3.4">𝑊</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.12.m1.2c">\mathbf{X}_{k,i}\in\mathbb{R}^{C\times H\times W}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.12.m1.2d">bold_X start_POSTSUBSCRIPT italic_k , italic_i end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_C × italic_H × italic_W end_POSTSUPERSCRIPT</annotation></semantics></math> is the <math alttext="i" class="ltx_Math" display="inline" id="S3.SS1.p3.13.m2.1"><semantics id="S3.SS1.p3.13.m2.1a"><mi id="S3.SS1.p3.13.m2.1.1" xref="S3.SS1.p3.13.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.13.m2.1b"><ci id="S3.SS1.p3.13.m2.1.1.cmml" xref="S3.SS1.p3.13.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.13.m2.1c">i</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.13.m2.1d">italic_i</annotation></semantics></math>th input from client <math alttext="k" class="ltx_Math" display="inline" id="S3.SS1.p3.14.m3.1"><semantics id="S3.SS1.p3.14.m3.1a"><mi id="S3.SS1.p3.14.m3.1.1" xref="S3.SS1.p3.14.m3.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.14.m3.1b"><ci id="S3.SS1.p3.14.m3.1.1.cmml" xref="S3.SS1.p3.14.m3.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.14.m3.1c">k</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.14.m3.1d">italic_k</annotation></semantics></math> and <math alttext="\mathbf{W}^{(t)}" class="ltx_Math" display="inline" id="S3.SS1.p3.15.m4.1"><semantics id="S3.SS1.p3.15.m4.1a"><msup id="S3.SS1.p3.15.m4.1.2" xref="S3.SS1.p3.15.m4.1.2.cmml"><mi id="S3.SS1.p3.15.m4.1.2.2" xref="S3.SS1.p3.15.m4.1.2.2.cmml">𝐖</mi><mrow id="S3.SS1.p3.15.m4.1.1.1.3" xref="S3.SS1.p3.15.m4.1.2.cmml"><mo id="S3.SS1.p3.15.m4.1.1.1.3.1" stretchy="false" xref="S3.SS1.p3.15.m4.1.2.cmml">(</mo><mi id="S3.SS1.p3.15.m4.1.1.1.1" xref="S3.SS1.p3.15.m4.1.1.1.1.cmml">t</mi><mo id="S3.SS1.p3.15.m4.1.1.1.3.2" stretchy="false" xref="S3.SS1.p3.15.m4.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.15.m4.1b"><apply id="S3.SS1.p3.15.m4.1.2.cmml" xref="S3.SS1.p3.15.m4.1.2"><csymbol cd="ambiguous" id="S3.SS1.p3.15.m4.1.2.1.cmml" xref="S3.SS1.p3.15.m4.1.2">superscript</csymbol><ci id="S3.SS1.p3.15.m4.1.2.2.cmml" xref="S3.SS1.p3.15.m4.1.2.2">𝐖</ci><ci id="S3.SS1.p3.15.m4.1.1.1.1.cmml" xref="S3.SS1.p3.15.m4.1.1.1.1">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.15.m4.1c">\mathbf{W}^{(t)}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.15.m4.1d">bold_W start_POSTSUPERSCRIPT ( italic_t ) end_POSTSUPERSCRIPT</annotation></semantics></math> represents the model parameters at time <math alttext="t" class="ltx_Math" display="inline" id="S3.SS1.p3.16.m5.1"><semantics id="S3.SS1.p3.16.m5.1a"><mi id="S3.SS1.p3.16.m5.1.1" xref="S3.SS1.p3.16.m5.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.16.m5.1b"><ci id="S3.SS1.p3.16.m5.1.1.cmml" xref="S3.SS1.p3.16.m5.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.16.m5.1c">t</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.16.m5.1d">italic_t</annotation></semantics></math>. Substituting <math alttext="\mathbf{W}_{k}^{(t+1)}" class="ltx_Math" display="inline" id="S3.SS1.p3.17.m6.1"><semantics id="S3.SS1.p3.17.m6.1a"><msubsup id="S3.SS1.p3.17.m6.1.2" xref="S3.SS1.p3.17.m6.1.2.cmml"><mi id="S3.SS1.p3.17.m6.1.2.2.2" xref="S3.SS1.p3.17.m6.1.2.2.2.cmml">𝐖</mi><mi id="S3.SS1.p3.17.m6.1.2.2.3" xref="S3.SS1.p3.17.m6.1.2.2.3.cmml">k</mi><mrow id="S3.SS1.p3.17.m6.1.1.1.1" xref="S3.SS1.p3.17.m6.1.1.1.1.1.cmml"><mo id="S3.SS1.p3.17.m6.1.1.1.1.2" stretchy="false" xref="S3.SS1.p3.17.m6.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS1.p3.17.m6.1.1.1.1.1" xref="S3.SS1.p3.17.m6.1.1.1.1.1.cmml"><mi id="S3.SS1.p3.17.m6.1.1.1.1.1.2" xref="S3.SS1.p3.17.m6.1.1.1.1.1.2.cmml">t</mi><mo id="S3.SS1.p3.17.m6.1.1.1.1.1.1" xref="S3.SS1.p3.17.m6.1.1.1.1.1.1.cmml">+</mo><mn id="S3.SS1.p3.17.m6.1.1.1.1.1.3" xref="S3.SS1.p3.17.m6.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S3.SS1.p3.17.m6.1.1.1.1.3" stretchy="false" xref="S3.SS1.p3.17.m6.1.1.1.1.1.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.17.m6.1b"><apply id="S3.SS1.p3.17.m6.1.2.cmml" xref="S3.SS1.p3.17.m6.1.2"><csymbol cd="ambiguous" id="S3.SS1.p3.17.m6.1.2.1.cmml" xref="S3.SS1.p3.17.m6.1.2">superscript</csymbol><apply id="S3.SS1.p3.17.m6.1.2.2.cmml" xref="S3.SS1.p3.17.m6.1.2"><csymbol cd="ambiguous" id="S3.SS1.p3.17.m6.1.2.2.1.cmml" xref="S3.SS1.p3.17.m6.1.2">subscript</csymbol><ci id="S3.SS1.p3.17.m6.1.2.2.2.cmml" xref="S3.SS1.p3.17.m6.1.2.2.2">𝐖</ci><ci id="S3.SS1.p3.17.m6.1.2.2.3.cmml" xref="S3.SS1.p3.17.m6.1.2.2.3">𝑘</ci></apply><apply id="S3.SS1.p3.17.m6.1.1.1.1.1.cmml" xref="S3.SS1.p3.17.m6.1.1.1.1"><plus id="S3.SS1.p3.17.m6.1.1.1.1.1.1.cmml" xref="S3.SS1.p3.17.m6.1.1.1.1.1.1"></plus><ci id="S3.SS1.p3.17.m6.1.1.1.1.1.2.cmml" xref="S3.SS1.p3.17.m6.1.1.1.1.1.2">𝑡</ci><cn id="S3.SS1.p3.17.m6.1.1.1.1.1.3.cmml" type="integer" xref="S3.SS1.p3.17.m6.1.1.1.1.1.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.17.m6.1c">\mathbf{W}_{k}^{(t+1)}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.17.m6.1d">bold_W start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_t + 1 ) end_POSTSUPERSCRIPT</annotation></semantics></math> into the expression for <math alttext="\mathbf{W}^{(t+1)}" class="ltx_Math" display="inline" id="S3.SS1.p3.18.m7.1"><semantics id="S3.SS1.p3.18.m7.1a"><msup id="S3.SS1.p3.18.m7.1.2" xref="S3.SS1.p3.18.m7.1.2.cmml"><mi id="S3.SS1.p3.18.m7.1.2.2" xref="S3.SS1.p3.18.m7.1.2.2.cmml">𝐖</mi><mrow id="S3.SS1.p3.18.m7.1.1.1.1" xref="S3.SS1.p3.18.m7.1.1.1.1.1.cmml"><mo id="S3.SS1.p3.18.m7.1.1.1.1.2" stretchy="false" xref="S3.SS1.p3.18.m7.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS1.p3.18.m7.1.1.1.1.1" xref="S3.SS1.p3.18.m7.1.1.1.1.1.cmml"><mi id="S3.SS1.p3.18.m7.1.1.1.1.1.2" xref="S3.SS1.p3.18.m7.1.1.1.1.1.2.cmml">t</mi><mo id="S3.SS1.p3.18.m7.1.1.1.1.1.1" xref="S3.SS1.p3.18.m7.1.1.1.1.1.1.cmml">+</mo><mn id="S3.SS1.p3.18.m7.1.1.1.1.1.3" xref="S3.SS1.p3.18.m7.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S3.SS1.p3.18.m7.1.1.1.1.3" stretchy="false" xref="S3.SS1.p3.18.m7.1.1.1.1.1.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.18.m7.1b"><apply id="S3.SS1.p3.18.m7.1.2.cmml" xref="S3.SS1.p3.18.m7.1.2"><csymbol cd="ambiguous" id="S3.SS1.p3.18.m7.1.2.1.cmml" xref="S3.SS1.p3.18.m7.1.2">superscript</csymbol><ci id="S3.SS1.p3.18.m7.1.2.2.cmml" xref="S3.SS1.p3.18.m7.1.2.2">𝐖</ci><apply id="S3.SS1.p3.18.m7.1.1.1.1.1.cmml" xref="S3.SS1.p3.18.m7.1.1.1.1"><plus id="S3.SS1.p3.18.m7.1.1.1.1.1.1.cmml" xref="S3.SS1.p3.18.m7.1.1.1.1.1.1"></plus><ci id="S3.SS1.p3.18.m7.1.1.1.1.1.2.cmml" xref="S3.SS1.p3.18.m7.1.1.1.1.1.2">𝑡</ci><cn id="S3.SS1.p3.18.m7.1.1.1.1.1.3.cmml" type="integer" xref="S3.SS1.p3.18.m7.1.1.1.1.1.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.18.m7.1c">\mathbf{W}^{(t+1)}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.18.m7.1d">bold_W start_POSTSUPERSCRIPT ( italic_t + 1 ) end_POSTSUPERSCRIPT</annotation></semantics></math>, we obtain:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{W}^{(t+1)}=\frac{1}{K}\sum_{k=1}^{K}\left(\mathbf{W}^{(t)}-\eta_{\text%
{g}}\frac{1}{M}\sum_{i=1}^{M}f(\mathbf{W}^{(t)};\mathbf{X}_{k,i})\right)=%
\mathbf{W}^{(t)}-\eta_{\text{g}}\frac{1}{N}\sum_{i=1}^{N}f(\mathbf{W}^{(t)};%
\mathbf{X}_{i})," class="ltx_Math" display="block" id="S3.E2.m1.8"><semantics id="S3.E2.m1.8a"><mrow id="S3.E2.m1.8.8.1" xref="S3.E2.m1.8.8.1.1.cmml"><mrow id="S3.E2.m1.8.8.1.1" xref="S3.E2.m1.8.8.1.1.cmml"><msup id="S3.E2.m1.8.8.1.1.5" xref="S3.E2.m1.8.8.1.1.5.cmml"><mi id="S3.E2.m1.8.8.1.1.5.2" xref="S3.E2.m1.8.8.1.1.5.2.cmml">𝐖</mi><mrow id="S3.E2.m1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.cmml"><mo id="S3.E2.m1.1.1.1.1.2" stretchy="false" xref="S3.E2.m1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E2.m1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.cmml"><mi id="S3.E2.m1.1.1.1.1.1.2" xref="S3.E2.m1.1.1.1.1.1.2.cmml">t</mi><mo id="S3.E2.m1.1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.1.cmml">+</mo><mn id="S3.E2.m1.1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S3.E2.m1.1.1.1.1.3" stretchy="false" xref="S3.E2.m1.1.1.1.1.1.cmml">)</mo></mrow></msup><mo id="S3.E2.m1.8.8.1.1.6" xref="S3.E2.m1.8.8.1.1.6.cmml">=</mo><mrow id="S3.E2.m1.8.8.1.1.1" xref="S3.E2.m1.8.8.1.1.1.cmml"><mfrac id="S3.E2.m1.8.8.1.1.1.3" xref="S3.E2.m1.8.8.1.1.1.3.cmml"><mn id="S3.E2.m1.8.8.1.1.1.3.2" xref="S3.E2.m1.8.8.1.1.1.3.2.cmml">1</mn><mi id="S3.E2.m1.8.8.1.1.1.3.3" xref="S3.E2.m1.8.8.1.1.1.3.3.cmml">K</mi></mfrac><mo id="S3.E2.m1.8.8.1.1.1.2" xref="S3.E2.m1.8.8.1.1.1.2.cmml">⁢</mo><mrow id="S3.E2.m1.8.8.1.1.1.1" xref="S3.E2.m1.8.8.1.1.1.1.cmml"><munderover id="S3.E2.m1.8.8.1.1.1.1.2" xref="S3.E2.m1.8.8.1.1.1.1.2.cmml"><mo id="S3.E2.m1.8.8.1.1.1.1.2.2.2" movablelimits="false" rspace="0em" xref="S3.E2.m1.8.8.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S3.E2.m1.8.8.1.1.1.1.2.2.3" xref="S3.E2.m1.8.8.1.1.1.1.2.2.3.cmml"><mi id="S3.E2.m1.8.8.1.1.1.1.2.2.3.2" xref="S3.E2.m1.8.8.1.1.1.1.2.2.3.2.cmml">k</mi><mo id="S3.E2.m1.8.8.1.1.1.1.2.2.3.1" xref="S3.E2.m1.8.8.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S3.E2.m1.8.8.1.1.1.1.2.2.3.3" xref="S3.E2.m1.8.8.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E2.m1.8.8.1.1.1.1.2.3" xref="S3.E2.m1.8.8.1.1.1.1.2.3.cmml">K</mi></munderover><mrow id="S3.E2.m1.8.8.1.1.1.1.1.1" xref="S3.E2.m1.8.8.1.1.1.1.1.1.1.cmml"><mo id="S3.E2.m1.8.8.1.1.1.1.1.1.2" xref="S3.E2.m1.8.8.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E2.m1.8.8.1.1.1.1.1.1.1" xref="S3.E2.m1.8.8.1.1.1.1.1.1.1.cmml"><msup id="S3.E2.m1.8.8.1.1.1.1.1.1.1.4" xref="S3.E2.m1.8.8.1.1.1.1.1.1.1.4.cmml"><mi id="S3.E2.m1.8.8.1.1.1.1.1.1.1.4.2" xref="S3.E2.m1.8.8.1.1.1.1.1.1.1.4.2.cmml">𝐖</mi><mrow id="S3.E2.m1.2.2.1.3" xref="S3.E2.m1.8.8.1.1.1.1.1.1.1.4.cmml"><mo id="S3.E2.m1.2.2.1.3.1" stretchy="false" xref="S3.E2.m1.8.8.1.1.1.1.1.1.1.4.cmml">(</mo><mi id="S3.E2.m1.2.2.1.1" xref="S3.E2.m1.2.2.1.1.cmml">t</mi><mo id="S3.E2.m1.2.2.1.3.2" stretchy="false" xref="S3.E2.m1.8.8.1.1.1.1.1.1.1.4.cmml">)</mo></mrow></msup><mo id="S3.E2.m1.8.8.1.1.1.1.1.1.1.3" xref="S3.E2.m1.8.8.1.1.1.1.1.1.1.3.cmml">−</mo><mrow id="S3.E2.m1.8.8.1.1.1.1.1.1.1.2" xref="S3.E2.m1.8.8.1.1.1.1.1.1.1.2.cmml"><msub id="S3.E2.m1.8.8.1.1.1.1.1.1.1.2.4" xref="S3.E2.m1.8.8.1.1.1.1.1.1.1.2.4.cmml"><mi id="S3.E2.m1.8.8.1.1.1.1.1.1.1.2.4.2" xref="S3.E2.m1.8.8.1.1.1.1.1.1.1.2.4.2.cmml">η</mi><mtext id="S3.E2.m1.8.8.1.1.1.1.1.1.1.2.4.3" xref="S3.E2.m1.8.8.1.1.1.1.1.1.1.2.4.3a.cmml">g</mtext></msub><mo id="S3.E2.m1.8.8.1.1.1.1.1.1.1.2.3" xref="S3.E2.m1.8.8.1.1.1.1.1.1.1.2.3.cmml">⁢</mo><mfrac id="S3.E2.m1.8.8.1.1.1.1.1.1.1.2.5" xref="S3.E2.m1.8.8.1.1.1.1.1.1.1.2.5.cmml"><mn id="S3.E2.m1.8.8.1.1.1.1.1.1.1.2.5.2" xref="S3.E2.m1.8.8.1.1.1.1.1.1.1.2.5.2.cmml">1</mn><mi id="S3.E2.m1.8.8.1.1.1.1.1.1.1.2.5.3" xref="S3.E2.m1.8.8.1.1.1.1.1.1.1.2.5.3.cmml">M</mi></mfrac><mo id="S3.E2.m1.8.8.1.1.1.1.1.1.1.2.3a" xref="S3.E2.m1.8.8.1.1.1.1.1.1.1.2.3.cmml">⁢</mo><mrow id="S3.E2.m1.8.8.1.1.1.1.1.1.1.2.2" xref="S3.E2.m1.8.8.1.1.1.1.1.1.1.2.2.cmml"><munderover id="S3.E2.m1.8.8.1.1.1.1.1.1.1.2.2.3" xref="S3.E2.m1.8.8.1.1.1.1.1.1.1.2.2.3.cmml"><mo id="S3.E2.m1.8.8.1.1.1.1.1.1.1.2.2.3.2.2" movablelimits="false" xref="S3.E2.m1.8.8.1.1.1.1.1.1.1.2.2.3.2.2.cmml">∑</mo><mrow id="S3.E2.m1.8.8.1.1.1.1.1.1.1.2.2.3.2.3" xref="S3.E2.m1.8.8.1.1.1.1.1.1.1.2.2.3.2.3.cmml"><mi id="S3.E2.m1.8.8.1.1.1.1.1.1.1.2.2.3.2.3.2" xref="S3.E2.m1.8.8.1.1.1.1.1.1.1.2.2.3.2.3.2.cmml">i</mi><mo id="S3.E2.m1.8.8.1.1.1.1.1.1.1.2.2.3.2.3.1" xref="S3.E2.m1.8.8.1.1.1.1.1.1.1.2.2.3.2.3.1.cmml">=</mo><mn id="S3.E2.m1.8.8.1.1.1.1.1.1.1.2.2.3.2.3.3" xref="S3.E2.m1.8.8.1.1.1.1.1.1.1.2.2.3.2.3.3.cmml">1</mn></mrow><mi id="S3.E2.m1.8.8.1.1.1.1.1.1.1.2.2.3.3" xref="S3.E2.m1.8.8.1.1.1.1.1.1.1.2.2.3.3.cmml">M</mi></munderover><mrow id="S3.E2.m1.8.8.1.1.1.1.1.1.1.2.2.2" xref="S3.E2.m1.8.8.1.1.1.1.1.1.1.2.2.2.cmml"><mi id="S3.E2.m1.8.8.1.1.1.1.1.1.1.2.2.2.4" xref="S3.E2.m1.8.8.1.1.1.1.1.1.1.2.2.2.4.cmml">f</mi><mo id="S3.E2.m1.8.8.1.1.1.1.1.1.1.2.2.2.3" xref="S3.E2.m1.8.8.1.1.1.1.1.1.1.2.2.2.3.cmml">⁢</mo><mrow id="S3.E2.m1.8.8.1.1.1.1.1.1.1.2.2.2.2.2" xref="S3.E2.m1.8.8.1.1.1.1.1.1.1.2.2.2.2.3.cmml"><mo id="S3.E2.m1.8.8.1.1.1.1.1.1.1.2.2.2.2.2.3" stretchy="false" xref="S3.E2.m1.8.8.1.1.1.1.1.1.1.2.2.2.2.3.cmml">(</mo><msup id="S3.E2.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E2.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E2.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E2.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">𝐖</mi><mrow id="S3.E2.m1.3.3.1.3" xref="S3.E2.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E2.m1.3.3.1.3.1" stretchy="false" xref="S3.E2.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mi id="S3.E2.m1.3.3.1.1" xref="S3.E2.m1.3.3.1.1.cmml">t</mi><mo id="S3.E2.m1.3.3.1.3.2" stretchy="false" xref="S3.E2.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></msup><mo id="S3.E2.m1.8.8.1.1.1.1.1.1.1.2.2.2.2.2.4" xref="S3.E2.m1.8.8.1.1.1.1.1.1.1.2.2.2.2.3.cmml">;</mo><msub id="S3.E2.m1.8.8.1.1.1.1.1.1.1.2.2.2.2.2.2" xref="S3.E2.m1.8.8.1.1.1.1.1.1.1.2.2.2.2.2.2.cmml"><mi id="S3.E2.m1.8.8.1.1.1.1.1.1.1.2.2.2.2.2.2.2" xref="S3.E2.m1.8.8.1.1.1.1.1.1.1.2.2.2.2.2.2.2.cmml">𝐗</mi><mrow id="S3.E2.m1.5.5.2.4" xref="S3.E2.m1.5.5.2.3.cmml"><mi id="S3.E2.m1.4.4.1.1" xref="S3.E2.m1.4.4.1.1.cmml">k</mi><mo id="S3.E2.m1.5.5.2.4.1" xref="S3.E2.m1.5.5.2.3.cmml">,</mo><mi id="S3.E2.m1.5.5.2.2" xref="S3.E2.m1.5.5.2.2.cmml">i</mi></mrow></msub><mo id="S3.E2.m1.8.8.1.1.1.1.1.1.1.2.2.2.2.2.5" stretchy="false" xref="S3.E2.m1.8.8.1.1.1.1.1.1.1.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="S3.E2.m1.8.8.1.1.1.1.1.1.3" xref="S3.E2.m1.8.8.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E2.m1.8.8.1.1.7" xref="S3.E2.m1.8.8.1.1.7.cmml">=</mo><mrow id="S3.E2.m1.8.8.1.1.3" xref="S3.E2.m1.8.8.1.1.3.cmml"><msup id="S3.E2.m1.8.8.1.1.3.4" xref="S3.E2.m1.8.8.1.1.3.4.cmml"><mi id="S3.E2.m1.8.8.1.1.3.4.2" xref="S3.E2.m1.8.8.1.1.3.4.2.cmml">𝐖</mi><mrow id="S3.E2.m1.6.6.1.3" xref="S3.E2.m1.8.8.1.1.3.4.cmml"><mo id="S3.E2.m1.6.6.1.3.1" stretchy="false" xref="S3.E2.m1.8.8.1.1.3.4.cmml">(</mo><mi id="S3.E2.m1.6.6.1.1" xref="S3.E2.m1.6.6.1.1.cmml">t</mi><mo id="S3.E2.m1.6.6.1.3.2" stretchy="false" xref="S3.E2.m1.8.8.1.1.3.4.cmml">)</mo></mrow></msup><mo id="S3.E2.m1.8.8.1.1.3.3" xref="S3.E2.m1.8.8.1.1.3.3.cmml">−</mo><mrow id="S3.E2.m1.8.8.1.1.3.2" xref="S3.E2.m1.8.8.1.1.3.2.cmml"><msub id="S3.E2.m1.8.8.1.1.3.2.4" xref="S3.E2.m1.8.8.1.1.3.2.4.cmml"><mi id="S3.E2.m1.8.8.1.1.3.2.4.2" xref="S3.E2.m1.8.8.1.1.3.2.4.2.cmml">η</mi><mtext id="S3.E2.m1.8.8.1.1.3.2.4.3" xref="S3.E2.m1.8.8.1.1.3.2.4.3a.cmml">g</mtext></msub><mo id="S3.E2.m1.8.8.1.1.3.2.3" xref="S3.E2.m1.8.8.1.1.3.2.3.cmml">⁢</mo><mfrac id="S3.E2.m1.8.8.1.1.3.2.5" xref="S3.E2.m1.8.8.1.1.3.2.5.cmml"><mn id="S3.E2.m1.8.8.1.1.3.2.5.2" xref="S3.E2.m1.8.8.1.1.3.2.5.2.cmml">1</mn><mi id="S3.E2.m1.8.8.1.1.3.2.5.3" xref="S3.E2.m1.8.8.1.1.3.2.5.3.cmml">N</mi></mfrac><mo id="S3.E2.m1.8.8.1.1.3.2.3a" xref="S3.E2.m1.8.8.1.1.3.2.3.cmml">⁢</mo><mrow id="S3.E2.m1.8.8.1.1.3.2.2" xref="S3.E2.m1.8.8.1.1.3.2.2.cmml"><munderover id="S3.E2.m1.8.8.1.1.3.2.2.3" xref="S3.E2.m1.8.8.1.1.3.2.2.3.cmml"><mo id="S3.E2.m1.8.8.1.1.3.2.2.3.2.2" movablelimits="false" xref="S3.E2.m1.8.8.1.1.3.2.2.3.2.2.cmml">∑</mo><mrow id="S3.E2.m1.8.8.1.1.3.2.2.3.2.3" xref="S3.E2.m1.8.8.1.1.3.2.2.3.2.3.cmml"><mi id="S3.E2.m1.8.8.1.1.3.2.2.3.2.3.2" xref="S3.E2.m1.8.8.1.1.3.2.2.3.2.3.2.cmml">i</mi><mo id="S3.E2.m1.8.8.1.1.3.2.2.3.2.3.1" xref="S3.E2.m1.8.8.1.1.3.2.2.3.2.3.1.cmml">=</mo><mn id="S3.E2.m1.8.8.1.1.3.2.2.3.2.3.3" xref="S3.E2.m1.8.8.1.1.3.2.2.3.2.3.3.cmml">1</mn></mrow><mi id="S3.E2.m1.8.8.1.1.3.2.2.3.3" xref="S3.E2.m1.8.8.1.1.3.2.2.3.3.cmml">N</mi></munderover><mrow id="S3.E2.m1.8.8.1.1.3.2.2.2" xref="S3.E2.m1.8.8.1.1.3.2.2.2.cmml"><mi id="S3.E2.m1.8.8.1.1.3.2.2.2.4" xref="S3.E2.m1.8.8.1.1.3.2.2.2.4.cmml">f</mi><mo id="S3.E2.m1.8.8.1.1.3.2.2.2.3" xref="S3.E2.m1.8.8.1.1.3.2.2.2.3.cmml">⁢</mo><mrow id="S3.E2.m1.8.8.1.1.3.2.2.2.2.2" xref="S3.E2.m1.8.8.1.1.3.2.2.2.2.3.cmml"><mo id="S3.E2.m1.8.8.1.1.3.2.2.2.2.2.3" stretchy="false" xref="S3.E2.m1.8.8.1.1.3.2.2.2.2.3.cmml">(</mo><msup id="S3.E2.m1.8.8.1.1.2.1.1.1.1.1.1" xref="S3.E2.m1.8.8.1.1.2.1.1.1.1.1.1.cmml"><mi id="S3.E2.m1.8.8.1.1.2.1.1.1.1.1.1.2" xref="S3.E2.m1.8.8.1.1.2.1.1.1.1.1.1.2.cmml">𝐖</mi><mrow id="S3.E2.m1.7.7.1.3" xref="S3.E2.m1.8.8.1.1.2.1.1.1.1.1.1.cmml"><mo id="S3.E2.m1.7.7.1.3.1" stretchy="false" xref="S3.E2.m1.8.8.1.1.2.1.1.1.1.1.1.cmml">(</mo><mi id="S3.E2.m1.7.7.1.1" xref="S3.E2.m1.7.7.1.1.cmml">t</mi><mo id="S3.E2.m1.7.7.1.3.2" stretchy="false" xref="S3.E2.m1.8.8.1.1.2.1.1.1.1.1.1.cmml">)</mo></mrow></msup><mo id="S3.E2.m1.8.8.1.1.3.2.2.2.2.2.4" xref="S3.E2.m1.8.8.1.1.3.2.2.2.2.3.cmml">;</mo><msub id="S3.E2.m1.8.8.1.1.3.2.2.2.2.2.2" xref="S3.E2.m1.8.8.1.1.3.2.2.2.2.2.2.cmml"><mi id="S3.E2.m1.8.8.1.1.3.2.2.2.2.2.2.2" xref="S3.E2.m1.8.8.1.1.3.2.2.2.2.2.2.2.cmml">𝐗</mi><mi id="S3.E2.m1.8.8.1.1.3.2.2.2.2.2.2.3" xref="S3.E2.m1.8.8.1.1.3.2.2.2.2.2.2.3.cmml">i</mi></msub><mo id="S3.E2.m1.8.8.1.1.3.2.2.2.2.2.5" stretchy="false" xref="S3.E2.m1.8.8.1.1.3.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mrow><mo id="S3.E2.m1.8.8.1.2" xref="S3.E2.m1.8.8.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.8b"><apply id="S3.E2.m1.8.8.1.1.cmml" xref="S3.E2.m1.8.8.1"><and id="S3.E2.m1.8.8.1.1a.cmml" xref="S3.E2.m1.8.8.1"></and><apply id="S3.E2.m1.8.8.1.1b.cmml" xref="S3.E2.m1.8.8.1"><eq id="S3.E2.m1.8.8.1.1.6.cmml" xref="S3.E2.m1.8.8.1.1.6"></eq><apply id="S3.E2.m1.8.8.1.1.5.cmml" xref="S3.E2.m1.8.8.1.1.5"><csymbol cd="ambiguous" id="S3.E2.m1.8.8.1.1.5.1.cmml" xref="S3.E2.m1.8.8.1.1.5">superscript</csymbol><ci id="S3.E2.m1.8.8.1.1.5.2.cmml" xref="S3.E2.m1.8.8.1.1.5.2">𝐖</ci><apply id="S3.E2.m1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1"><plus id="S3.E2.m1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1"></plus><ci id="S3.E2.m1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.1.1.2">𝑡</ci><cn id="S3.E2.m1.1.1.1.1.1.3.cmml" type="integer" xref="S3.E2.m1.1.1.1.1.1.3">1</cn></apply></apply><apply id="S3.E2.m1.8.8.1.1.1.cmml" xref="S3.E2.m1.8.8.1.1.1"><times id="S3.E2.m1.8.8.1.1.1.2.cmml" xref="S3.E2.m1.8.8.1.1.1.2"></times><apply id="S3.E2.m1.8.8.1.1.1.3.cmml" xref="S3.E2.m1.8.8.1.1.1.3"><divide id="S3.E2.m1.8.8.1.1.1.3.1.cmml" xref="S3.E2.m1.8.8.1.1.1.3"></divide><cn id="S3.E2.m1.8.8.1.1.1.3.2.cmml" type="integer" xref="S3.E2.m1.8.8.1.1.1.3.2">1</cn><ci id="S3.E2.m1.8.8.1.1.1.3.3.cmml" xref="S3.E2.m1.8.8.1.1.1.3.3">𝐾</ci></apply><apply id="S3.E2.m1.8.8.1.1.1.1.cmml" xref="S3.E2.m1.8.8.1.1.1.1"><apply id="S3.E2.m1.8.8.1.1.1.1.2.cmml" xref="S3.E2.m1.8.8.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E2.m1.8.8.1.1.1.1.2.1.cmml" xref="S3.E2.m1.8.8.1.1.1.1.2">superscript</csymbol><apply id="S3.E2.m1.8.8.1.1.1.1.2.2.cmml" xref="S3.E2.m1.8.8.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E2.m1.8.8.1.1.1.1.2.2.1.cmml" xref="S3.E2.m1.8.8.1.1.1.1.2">subscript</csymbol><sum id="S3.E2.m1.8.8.1.1.1.1.2.2.2.cmml" xref="S3.E2.m1.8.8.1.1.1.1.2.2.2"></sum><apply id="S3.E2.m1.8.8.1.1.1.1.2.2.3.cmml" xref="S3.E2.m1.8.8.1.1.1.1.2.2.3"><eq id="S3.E2.m1.8.8.1.1.1.1.2.2.3.1.cmml" xref="S3.E2.m1.8.8.1.1.1.1.2.2.3.1"></eq><ci id="S3.E2.m1.8.8.1.1.1.1.2.2.3.2.cmml" xref="S3.E2.m1.8.8.1.1.1.1.2.2.3.2">𝑘</ci><cn id="S3.E2.m1.8.8.1.1.1.1.2.2.3.3.cmml" type="integer" xref="S3.E2.m1.8.8.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S3.E2.m1.8.8.1.1.1.1.2.3.cmml" xref="S3.E2.m1.8.8.1.1.1.1.2.3">𝐾</ci></apply><apply id="S3.E2.m1.8.8.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.8.8.1.1.1.1.1.1"><minus id="S3.E2.m1.8.8.1.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.8.8.1.1.1.1.1.1.1.3"></minus><apply id="S3.E2.m1.8.8.1.1.1.1.1.1.1.4.cmml" xref="S3.E2.m1.8.8.1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E2.m1.8.8.1.1.1.1.1.1.1.4.1.cmml" xref="S3.E2.m1.8.8.1.1.1.1.1.1.1.4">superscript</csymbol><ci id="S3.E2.m1.8.8.1.1.1.1.1.1.1.4.2.cmml" xref="S3.E2.m1.8.8.1.1.1.1.1.1.1.4.2">𝐖</ci><ci id="S3.E2.m1.2.2.1.1.cmml" xref="S3.E2.m1.2.2.1.1">𝑡</ci></apply><apply id="S3.E2.m1.8.8.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.8.8.1.1.1.1.1.1.1.2"><times id="S3.E2.m1.8.8.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E2.m1.8.8.1.1.1.1.1.1.1.2.3"></times><apply id="S3.E2.m1.8.8.1.1.1.1.1.1.1.2.4.cmml" xref="S3.E2.m1.8.8.1.1.1.1.1.1.1.2.4"><csymbol cd="ambiguous" id="S3.E2.m1.8.8.1.1.1.1.1.1.1.2.4.1.cmml" xref="S3.E2.m1.8.8.1.1.1.1.1.1.1.2.4">subscript</csymbol><ci id="S3.E2.m1.8.8.1.1.1.1.1.1.1.2.4.2.cmml" xref="S3.E2.m1.8.8.1.1.1.1.1.1.1.2.4.2">𝜂</ci><ci id="S3.E2.m1.8.8.1.1.1.1.1.1.1.2.4.3a.cmml" xref="S3.E2.m1.8.8.1.1.1.1.1.1.1.2.4.3"><mtext id="S3.E2.m1.8.8.1.1.1.1.1.1.1.2.4.3.cmml" mathsize="70%" xref="S3.E2.m1.8.8.1.1.1.1.1.1.1.2.4.3">g</mtext></ci></apply><apply id="S3.E2.m1.8.8.1.1.1.1.1.1.1.2.5.cmml" xref="S3.E2.m1.8.8.1.1.1.1.1.1.1.2.5"><divide id="S3.E2.m1.8.8.1.1.1.1.1.1.1.2.5.1.cmml" xref="S3.E2.m1.8.8.1.1.1.1.1.1.1.2.5"></divide><cn id="S3.E2.m1.8.8.1.1.1.1.1.1.1.2.5.2.cmml" type="integer" xref="S3.E2.m1.8.8.1.1.1.1.1.1.1.2.5.2">1</cn><ci id="S3.E2.m1.8.8.1.1.1.1.1.1.1.2.5.3.cmml" xref="S3.E2.m1.8.8.1.1.1.1.1.1.1.2.5.3">𝑀</ci></apply><apply id="S3.E2.m1.8.8.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E2.m1.8.8.1.1.1.1.1.1.1.2.2"><apply id="S3.E2.m1.8.8.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E2.m1.8.8.1.1.1.1.1.1.1.2.2.3"><csymbol cd="ambiguous" id="S3.E2.m1.8.8.1.1.1.1.1.1.1.2.2.3.1.cmml" xref="S3.E2.m1.8.8.1.1.1.1.1.1.1.2.2.3">superscript</csymbol><apply id="S3.E2.m1.8.8.1.1.1.1.1.1.1.2.2.3.2.cmml" xref="S3.E2.m1.8.8.1.1.1.1.1.1.1.2.2.3"><csymbol cd="ambiguous" id="S3.E2.m1.8.8.1.1.1.1.1.1.1.2.2.3.2.1.cmml" xref="S3.E2.m1.8.8.1.1.1.1.1.1.1.2.2.3">subscript</csymbol><sum id="S3.E2.m1.8.8.1.1.1.1.1.1.1.2.2.3.2.2.cmml" xref="S3.E2.m1.8.8.1.1.1.1.1.1.1.2.2.3.2.2"></sum><apply id="S3.E2.m1.8.8.1.1.1.1.1.1.1.2.2.3.2.3.cmml" xref="S3.E2.m1.8.8.1.1.1.1.1.1.1.2.2.3.2.3"><eq id="S3.E2.m1.8.8.1.1.1.1.1.1.1.2.2.3.2.3.1.cmml" xref="S3.E2.m1.8.8.1.1.1.1.1.1.1.2.2.3.2.3.1"></eq><ci id="S3.E2.m1.8.8.1.1.1.1.1.1.1.2.2.3.2.3.2.cmml" xref="S3.E2.m1.8.8.1.1.1.1.1.1.1.2.2.3.2.3.2">𝑖</ci><cn id="S3.E2.m1.8.8.1.1.1.1.1.1.1.2.2.3.2.3.3.cmml" type="integer" xref="S3.E2.m1.8.8.1.1.1.1.1.1.1.2.2.3.2.3.3">1</cn></apply></apply><ci id="S3.E2.m1.8.8.1.1.1.1.1.1.1.2.2.3.3.cmml" xref="S3.E2.m1.8.8.1.1.1.1.1.1.1.2.2.3.3">𝑀</ci></apply><apply id="S3.E2.m1.8.8.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E2.m1.8.8.1.1.1.1.1.1.1.2.2.2"><times id="S3.E2.m1.8.8.1.1.1.1.1.1.1.2.2.2.3.cmml" xref="S3.E2.m1.8.8.1.1.1.1.1.1.1.2.2.2.3"></times><ci id="S3.E2.m1.8.8.1.1.1.1.1.1.1.2.2.2.4.cmml" xref="S3.E2.m1.8.8.1.1.1.1.1.1.1.2.2.2.4">𝑓</ci><list id="S3.E2.m1.8.8.1.1.1.1.1.1.1.2.2.2.2.3.cmml" xref="S3.E2.m1.8.8.1.1.1.1.1.1.1.2.2.2.2.2"><apply id="S3.E2.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E2.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.1.2">𝐖</ci><ci id="S3.E2.m1.3.3.1.1.cmml" xref="S3.E2.m1.3.3.1.1">𝑡</ci></apply><apply id="S3.E2.m1.8.8.1.1.1.1.1.1.1.2.2.2.2.2.2.cmml" xref="S3.E2.m1.8.8.1.1.1.1.1.1.1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.8.8.1.1.1.1.1.1.1.2.2.2.2.2.2.1.cmml" xref="S3.E2.m1.8.8.1.1.1.1.1.1.1.2.2.2.2.2.2">subscript</csymbol><ci id="S3.E2.m1.8.8.1.1.1.1.1.1.1.2.2.2.2.2.2.2.cmml" xref="S3.E2.m1.8.8.1.1.1.1.1.1.1.2.2.2.2.2.2.2">𝐗</ci><list id="S3.E2.m1.5.5.2.3.cmml" xref="S3.E2.m1.5.5.2.4"><ci id="S3.E2.m1.4.4.1.1.cmml" xref="S3.E2.m1.4.4.1.1">𝑘</ci><ci id="S3.E2.m1.5.5.2.2.cmml" xref="S3.E2.m1.5.5.2.2">𝑖</ci></list></apply></list></apply></apply></apply></apply></apply></apply></apply><apply id="S3.E2.m1.8.8.1.1c.cmml" xref="S3.E2.m1.8.8.1"><eq id="S3.E2.m1.8.8.1.1.7.cmml" xref="S3.E2.m1.8.8.1.1.7"></eq><share href="https://arxiv.org/html/2410.04661v1#S3.E2.m1.8.8.1.1.1.cmml" id="S3.E2.m1.8.8.1.1d.cmml" xref="S3.E2.m1.8.8.1"></share><apply id="S3.E2.m1.8.8.1.1.3.cmml" xref="S3.E2.m1.8.8.1.1.3"><minus id="S3.E2.m1.8.8.1.1.3.3.cmml" xref="S3.E2.m1.8.8.1.1.3.3"></minus><apply id="S3.E2.m1.8.8.1.1.3.4.cmml" xref="S3.E2.m1.8.8.1.1.3.4"><csymbol cd="ambiguous" id="S3.E2.m1.8.8.1.1.3.4.1.cmml" xref="S3.E2.m1.8.8.1.1.3.4">superscript</csymbol><ci id="S3.E2.m1.8.8.1.1.3.4.2.cmml" xref="S3.E2.m1.8.8.1.1.3.4.2">𝐖</ci><ci id="S3.E2.m1.6.6.1.1.cmml" xref="S3.E2.m1.6.6.1.1">𝑡</ci></apply><apply id="S3.E2.m1.8.8.1.1.3.2.cmml" xref="S3.E2.m1.8.8.1.1.3.2"><times id="S3.E2.m1.8.8.1.1.3.2.3.cmml" xref="S3.E2.m1.8.8.1.1.3.2.3"></times><apply id="S3.E2.m1.8.8.1.1.3.2.4.cmml" xref="S3.E2.m1.8.8.1.1.3.2.4"><csymbol cd="ambiguous" id="S3.E2.m1.8.8.1.1.3.2.4.1.cmml" xref="S3.E2.m1.8.8.1.1.3.2.4">subscript</csymbol><ci id="S3.E2.m1.8.8.1.1.3.2.4.2.cmml" xref="S3.E2.m1.8.8.1.1.3.2.4.2">𝜂</ci><ci id="S3.E2.m1.8.8.1.1.3.2.4.3a.cmml" xref="S3.E2.m1.8.8.1.1.3.2.4.3"><mtext id="S3.E2.m1.8.8.1.1.3.2.4.3.cmml" mathsize="70%" xref="S3.E2.m1.8.8.1.1.3.2.4.3">g</mtext></ci></apply><apply id="S3.E2.m1.8.8.1.1.3.2.5.cmml" xref="S3.E2.m1.8.8.1.1.3.2.5"><divide id="S3.E2.m1.8.8.1.1.3.2.5.1.cmml" xref="S3.E2.m1.8.8.1.1.3.2.5"></divide><cn id="S3.E2.m1.8.8.1.1.3.2.5.2.cmml" type="integer" xref="S3.E2.m1.8.8.1.1.3.2.5.2">1</cn><ci id="S3.E2.m1.8.8.1.1.3.2.5.3.cmml" xref="S3.E2.m1.8.8.1.1.3.2.5.3">𝑁</ci></apply><apply id="S3.E2.m1.8.8.1.1.3.2.2.cmml" xref="S3.E2.m1.8.8.1.1.3.2.2"><apply id="S3.E2.m1.8.8.1.1.3.2.2.3.cmml" xref="S3.E2.m1.8.8.1.1.3.2.2.3"><csymbol cd="ambiguous" id="S3.E2.m1.8.8.1.1.3.2.2.3.1.cmml" xref="S3.E2.m1.8.8.1.1.3.2.2.3">superscript</csymbol><apply id="S3.E2.m1.8.8.1.1.3.2.2.3.2.cmml" xref="S3.E2.m1.8.8.1.1.3.2.2.3"><csymbol cd="ambiguous" id="S3.E2.m1.8.8.1.1.3.2.2.3.2.1.cmml" xref="S3.E2.m1.8.8.1.1.3.2.2.3">subscript</csymbol><sum id="S3.E2.m1.8.8.1.1.3.2.2.3.2.2.cmml" xref="S3.E2.m1.8.8.1.1.3.2.2.3.2.2"></sum><apply id="S3.E2.m1.8.8.1.1.3.2.2.3.2.3.cmml" xref="S3.E2.m1.8.8.1.1.3.2.2.3.2.3"><eq id="S3.E2.m1.8.8.1.1.3.2.2.3.2.3.1.cmml" xref="S3.E2.m1.8.8.1.1.3.2.2.3.2.3.1"></eq><ci id="S3.E2.m1.8.8.1.1.3.2.2.3.2.3.2.cmml" xref="S3.E2.m1.8.8.1.1.3.2.2.3.2.3.2">𝑖</ci><cn id="S3.E2.m1.8.8.1.1.3.2.2.3.2.3.3.cmml" type="integer" xref="S3.E2.m1.8.8.1.1.3.2.2.3.2.3.3">1</cn></apply></apply><ci id="S3.E2.m1.8.8.1.1.3.2.2.3.3.cmml" xref="S3.E2.m1.8.8.1.1.3.2.2.3.3">𝑁</ci></apply><apply id="S3.E2.m1.8.8.1.1.3.2.2.2.cmml" xref="S3.E2.m1.8.8.1.1.3.2.2.2"><times id="S3.E2.m1.8.8.1.1.3.2.2.2.3.cmml" xref="S3.E2.m1.8.8.1.1.3.2.2.2.3"></times><ci id="S3.E2.m1.8.8.1.1.3.2.2.2.4.cmml" xref="S3.E2.m1.8.8.1.1.3.2.2.2.4">𝑓</ci><list id="S3.E2.m1.8.8.1.1.3.2.2.2.2.3.cmml" xref="S3.E2.m1.8.8.1.1.3.2.2.2.2.2"><apply id="S3.E2.m1.8.8.1.1.2.1.1.1.1.1.1.cmml" xref="S3.E2.m1.8.8.1.1.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.8.8.1.1.2.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.8.8.1.1.2.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E2.m1.8.8.1.1.2.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.8.8.1.1.2.1.1.1.1.1.1.2">𝐖</ci><ci id="S3.E2.m1.7.7.1.1.cmml" xref="S3.E2.m1.7.7.1.1">𝑡</ci></apply><apply id="S3.E2.m1.8.8.1.1.3.2.2.2.2.2.2.cmml" xref="S3.E2.m1.8.8.1.1.3.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.8.8.1.1.3.2.2.2.2.2.2.1.cmml" xref="S3.E2.m1.8.8.1.1.3.2.2.2.2.2.2">subscript</csymbol><ci id="S3.E2.m1.8.8.1.1.3.2.2.2.2.2.2.2.cmml" xref="S3.E2.m1.8.8.1.1.3.2.2.2.2.2.2.2">𝐗</ci><ci id="S3.E2.m1.8.8.1.1.3.2.2.2.2.2.2.3.cmml" xref="S3.E2.m1.8.8.1.1.3.2.2.2.2.2.2.3">𝑖</ci></apply></list></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.8c">\mathbf{W}^{(t+1)}=\frac{1}{K}\sum_{k=1}^{K}\left(\mathbf{W}^{(t)}-\eta_{\text%
{g}}\frac{1}{M}\sum_{i=1}^{M}f(\mathbf{W}^{(t)};\mathbf{X}_{k,i})\right)=%
\mathbf{W}^{(t)}-\eta_{\text{g}}\frac{1}{N}\sum_{i=1}^{N}f(\mathbf{W}^{(t)};%
\mathbf{X}_{i}),</annotation><annotation encoding="application/x-llamapun" id="S3.E2.m1.8d">bold_W start_POSTSUPERSCRIPT ( italic_t + 1 ) end_POSTSUPERSCRIPT = divide start_ARG 1 end_ARG start_ARG italic_K end_ARG ∑ start_POSTSUBSCRIPT italic_k = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT ( bold_W start_POSTSUPERSCRIPT ( italic_t ) end_POSTSUPERSCRIPT - italic_η start_POSTSUBSCRIPT g end_POSTSUBSCRIPT divide start_ARG 1 end_ARG start_ARG italic_M end_ARG ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_M end_POSTSUPERSCRIPT italic_f ( bold_W start_POSTSUPERSCRIPT ( italic_t ) end_POSTSUPERSCRIPT ; bold_X start_POSTSUBSCRIPT italic_k , italic_i end_POSTSUBSCRIPT ) ) = bold_W start_POSTSUPERSCRIPT ( italic_t ) end_POSTSUPERSCRIPT - italic_η start_POSTSUBSCRIPT g end_POSTSUBSCRIPT divide start_ARG 1 end_ARG start_ARG italic_N end_ARG ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT italic_f ( bold_W start_POSTSUPERSCRIPT ( italic_t ) end_POSTSUPERSCRIPT ; bold_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS1.p3.19">where <math alttext="X_{i}" class="ltx_Math" display="inline" id="S3.SS1.p3.19.m1.1"><semantics id="S3.SS1.p3.19.m1.1a"><msub id="S3.SS1.p3.19.m1.1.1" xref="S3.SS1.p3.19.m1.1.1.cmml"><mi id="S3.SS1.p3.19.m1.1.1.2" xref="S3.SS1.p3.19.m1.1.1.2.cmml">X</mi><mi id="S3.SS1.p3.19.m1.1.1.3" xref="S3.SS1.p3.19.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.19.m1.1b"><apply id="S3.SS1.p3.19.m1.1.1.cmml" xref="S3.SS1.p3.19.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.19.m1.1.1.1.cmml" xref="S3.SS1.p3.19.m1.1.1">subscript</csymbol><ci id="S3.SS1.p3.19.m1.1.1.2.cmml" xref="S3.SS1.p3.19.m1.1.1.2">𝑋</ci><ci id="S3.SS1.p3.19.m1.1.1.3.cmml" xref="S3.SS1.p3.19.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.19.m1.1c">X_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.19.m1.1d">italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> are the inputs from the combined dataset of all clients.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS1.p4">
<p class="ltx_p" id="S3.SS1.p4.4">The attacker passes <math alttext="\mathbf{X}" class="ltx_Math" display="inline" id="S3.SS1.p4.1.m1.1"><semantics id="S3.SS1.p4.1.m1.1a"><mi id="S3.SS1.p4.1.m1.1.1" xref="S3.SS1.p4.1.m1.1.1.cmml">𝐗</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.1.m1.1b"><ci id="S3.SS1.p4.1.m1.1.1.cmml" xref="S3.SS1.p4.1.m1.1.1">𝐗</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.1.m1.1c">\mathbf{X}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p4.1.m1.1d">bold_X</annotation></semantics></math> through the global model and compares the resulting gradient update <math alttext="\nabla_{\mathbf{X}}^{(t)}\equiv f(\mathbf{W}^{(t)};\mathbf{X})" class="ltx_Math" display="inline" id="S3.SS1.p4.2.m2.4"><semantics id="S3.SS1.p4.2.m2.4a"><mrow id="S3.SS1.p4.2.m2.4.4" xref="S3.SS1.p4.2.m2.4.4.cmml"><msubsup id="S3.SS1.p4.2.m2.4.4.3" xref="S3.SS1.p4.2.m2.4.4.3.cmml"><mo id="S3.SS1.p4.2.m2.4.4.3.2.2" xref="S3.SS1.p4.2.m2.4.4.3.2.2.cmml">∇</mo><mi id="S3.SS1.p4.2.m2.4.4.3.2.3" xref="S3.SS1.p4.2.m2.4.4.3.2.3.cmml">𝐗</mi><mrow id="S3.SS1.p4.2.m2.1.1.1.3" xref="S3.SS1.p4.2.m2.4.4.3.cmml"><mo id="S3.SS1.p4.2.m2.1.1.1.3.1" stretchy="false" xref="S3.SS1.p4.2.m2.4.4.3.cmml">(</mo><mi id="S3.SS1.p4.2.m2.1.1.1.1" xref="S3.SS1.p4.2.m2.1.1.1.1.cmml">t</mi><mo id="S3.SS1.p4.2.m2.1.1.1.3.2" stretchy="false" xref="S3.SS1.p4.2.m2.4.4.3.cmml">)</mo></mrow></msubsup><mo id="S3.SS1.p4.2.m2.4.4.2" xref="S3.SS1.p4.2.m2.4.4.2.cmml">≡</mo><mrow id="S3.SS1.p4.2.m2.4.4.1" xref="S3.SS1.p4.2.m2.4.4.1.cmml"><mi id="S3.SS1.p4.2.m2.4.4.1.3" xref="S3.SS1.p4.2.m2.4.4.1.3.cmml">f</mi><mo id="S3.SS1.p4.2.m2.4.4.1.2" xref="S3.SS1.p4.2.m2.4.4.1.2.cmml">⁢</mo><mrow id="S3.SS1.p4.2.m2.4.4.1.1.1" xref="S3.SS1.p4.2.m2.4.4.1.1.2.cmml"><mo id="S3.SS1.p4.2.m2.4.4.1.1.1.2" stretchy="false" xref="S3.SS1.p4.2.m2.4.4.1.1.2.cmml">(</mo><msup id="S3.SS1.p4.2.m2.4.4.1.1.1.1" xref="S3.SS1.p4.2.m2.4.4.1.1.1.1.cmml"><mi id="S3.SS1.p4.2.m2.4.4.1.1.1.1.2" xref="S3.SS1.p4.2.m2.4.4.1.1.1.1.2.cmml">𝐖</mi><mrow id="S3.SS1.p4.2.m2.2.2.1.3" xref="S3.SS1.p4.2.m2.4.4.1.1.1.1.cmml"><mo id="S3.SS1.p4.2.m2.2.2.1.3.1" stretchy="false" xref="S3.SS1.p4.2.m2.4.4.1.1.1.1.cmml">(</mo><mi id="S3.SS1.p4.2.m2.2.2.1.1" xref="S3.SS1.p4.2.m2.2.2.1.1.cmml">t</mi><mo id="S3.SS1.p4.2.m2.2.2.1.3.2" stretchy="false" xref="S3.SS1.p4.2.m2.4.4.1.1.1.1.cmml">)</mo></mrow></msup><mo id="S3.SS1.p4.2.m2.4.4.1.1.1.3" xref="S3.SS1.p4.2.m2.4.4.1.1.2.cmml">;</mo><mi id="S3.SS1.p4.2.m2.3.3" xref="S3.SS1.p4.2.m2.3.3.cmml">𝐗</mi><mo id="S3.SS1.p4.2.m2.4.4.1.1.1.4" stretchy="false" xref="S3.SS1.p4.2.m2.4.4.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.2.m2.4b"><apply id="S3.SS1.p4.2.m2.4.4.cmml" xref="S3.SS1.p4.2.m2.4.4"><equivalent id="S3.SS1.p4.2.m2.4.4.2.cmml" xref="S3.SS1.p4.2.m2.4.4.2"></equivalent><apply id="S3.SS1.p4.2.m2.4.4.3.cmml" xref="S3.SS1.p4.2.m2.4.4.3"><csymbol cd="ambiguous" id="S3.SS1.p4.2.m2.4.4.3.1.cmml" xref="S3.SS1.p4.2.m2.4.4.3">superscript</csymbol><apply id="S3.SS1.p4.2.m2.4.4.3.2.cmml" xref="S3.SS1.p4.2.m2.4.4.3"><csymbol cd="ambiguous" id="S3.SS1.p4.2.m2.4.4.3.2.1.cmml" xref="S3.SS1.p4.2.m2.4.4.3">subscript</csymbol><ci id="S3.SS1.p4.2.m2.4.4.3.2.2.cmml" xref="S3.SS1.p4.2.m2.4.4.3.2.2">∇</ci><ci id="S3.SS1.p4.2.m2.4.4.3.2.3.cmml" xref="S3.SS1.p4.2.m2.4.4.3.2.3">𝐗</ci></apply><ci id="S3.SS1.p4.2.m2.1.1.1.1.cmml" xref="S3.SS1.p4.2.m2.1.1.1.1">𝑡</ci></apply><apply id="S3.SS1.p4.2.m2.4.4.1.cmml" xref="S3.SS1.p4.2.m2.4.4.1"><times id="S3.SS1.p4.2.m2.4.4.1.2.cmml" xref="S3.SS1.p4.2.m2.4.4.1.2"></times><ci id="S3.SS1.p4.2.m2.4.4.1.3.cmml" xref="S3.SS1.p4.2.m2.4.4.1.3">𝑓</ci><list id="S3.SS1.p4.2.m2.4.4.1.1.2.cmml" xref="S3.SS1.p4.2.m2.4.4.1.1.1"><apply id="S3.SS1.p4.2.m2.4.4.1.1.1.1.cmml" xref="S3.SS1.p4.2.m2.4.4.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p4.2.m2.4.4.1.1.1.1.1.cmml" xref="S3.SS1.p4.2.m2.4.4.1.1.1.1">superscript</csymbol><ci id="S3.SS1.p4.2.m2.4.4.1.1.1.1.2.cmml" xref="S3.SS1.p4.2.m2.4.4.1.1.1.1.2">𝐖</ci><ci id="S3.SS1.p4.2.m2.2.2.1.1.cmml" xref="S3.SS1.p4.2.m2.2.2.1.1">𝑡</ci></apply><ci id="S3.SS1.p4.2.m2.3.3.cmml" xref="S3.SS1.p4.2.m2.3.3">𝐗</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.2.m2.4c">\nabla_{\mathbf{X}}^{(t)}\equiv f(\mathbf{W}^{(t)};\mathbf{X})</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p4.2.m2.4d">∇ start_POSTSUBSCRIPT bold_X end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_t ) end_POSTSUPERSCRIPT ≡ italic_f ( bold_W start_POSTSUPERSCRIPT ( italic_t ) end_POSTSUPERSCRIPT ; bold_X )</annotation></semantics></math> to the target gradient <math alttext="\nabla_{\text{avg}}^{(t)}" class="ltx_Math" display="inline" id="S3.SS1.p4.3.m3.1"><semantics id="S3.SS1.p4.3.m3.1a"><msubsup id="S3.SS1.p4.3.m3.1.2" xref="S3.SS1.p4.3.m3.1.2.cmml"><mo id="S3.SS1.p4.3.m3.1.2.2.2" xref="S3.SS1.p4.3.m3.1.2.2.2.cmml">∇</mo><mtext id="S3.SS1.p4.3.m3.1.2.2.3" xref="S3.SS1.p4.3.m3.1.2.2.3a.cmml">avg</mtext><mrow id="S3.SS1.p4.3.m3.1.1.1.3" xref="S3.SS1.p4.3.m3.1.2.cmml"><mo id="S3.SS1.p4.3.m3.1.1.1.3.1" stretchy="false" xref="S3.SS1.p4.3.m3.1.2.cmml">(</mo><mi id="S3.SS1.p4.3.m3.1.1.1.1" xref="S3.SS1.p4.3.m3.1.1.1.1.cmml">t</mi><mo id="S3.SS1.p4.3.m3.1.1.1.3.2" stretchy="false" xref="S3.SS1.p4.3.m3.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.3.m3.1b"><apply id="S3.SS1.p4.3.m3.1.2.cmml" xref="S3.SS1.p4.3.m3.1.2"><csymbol cd="ambiguous" id="S3.SS1.p4.3.m3.1.2.1.cmml" xref="S3.SS1.p4.3.m3.1.2">superscript</csymbol><apply id="S3.SS1.p4.3.m3.1.2.2.cmml" xref="S3.SS1.p4.3.m3.1.2"><csymbol cd="ambiguous" id="S3.SS1.p4.3.m3.1.2.2.1.cmml" xref="S3.SS1.p4.3.m3.1.2">subscript</csymbol><ci id="S3.SS1.p4.3.m3.1.2.2.2.cmml" xref="S3.SS1.p4.3.m3.1.2.2.2">∇</ci><ci id="S3.SS1.p4.3.m3.1.2.2.3a.cmml" xref="S3.SS1.p4.3.m3.1.2.2.3"><mtext id="S3.SS1.p4.3.m3.1.2.2.3.cmml" mathsize="70%" xref="S3.SS1.p4.3.m3.1.2.2.3">avg</mtext></ci></apply><ci id="S3.SS1.p4.3.m3.1.1.1.1.cmml" xref="S3.SS1.p4.3.m3.1.1.1.1">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.3.m3.1c">\nabla_{\text{avg}}^{(t)}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p4.3.m3.1d">∇ start_POSTSUBSCRIPT avg end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_t ) end_POSTSUPERSCRIPT</annotation></semantics></math>. Following the gradient inversion framework, the goal is to iteratively refine <math alttext="\mathbf{X}" class="ltx_Math" display="inline" id="S3.SS1.p4.4.m4.1"><semantics id="S3.SS1.p4.4.m4.1a"><mi id="S3.SS1.p4.4.m4.1.1" xref="S3.SS1.p4.4.m4.1.1.cmml">𝐗</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.4.m4.1b"><ci id="S3.SS1.p4.4.m4.1.1.cmml" xref="S3.SS1.p4.4.m4.1.1">𝐗</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.4.m4.1c">\mathbf{X}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p4.4.m4.1d">bold_X</annotation></semantics></math> until it closely approximates the data used to compute the target gradient. The attacker solves the following optimization problem.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS1.p5">
<table class="ltx_equation ltx_eqn_table" id="S3.E3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\hat{\mathbf{X}}=\arg\min_{\mathbf{X}}\left\|f(\mathbf{W}^{(t)};\mathbf{X})-%
\nabla_{\text{avg}}^{(t)}\right\|^{2}." class="ltx_Math" display="block" id="S3.E3.m1.4"><semantics id="S3.E3.m1.4a"><mrow id="S3.E3.m1.4.4.1" xref="S3.E3.m1.4.4.1.1.cmml"><mrow id="S3.E3.m1.4.4.1.1" xref="S3.E3.m1.4.4.1.1.cmml"><mover accent="true" id="S3.E3.m1.4.4.1.1.3" xref="S3.E3.m1.4.4.1.1.3.cmml"><mi id="S3.E3.m1.4.4.1.1.3.2" xref="S3.E3.m1.4.4.1.1.3.2.cmml">𝐗</mi><mo id="S3.E3.m1.4.4.1.1.3.1" xref="S3.E3.m1.4.4.1.1.3.1.cmml">^</mo></mover><mo id="S3.E3.m1.4.4.1.1.2" xref="S3.E3.m1.4.4.1.1.2.cmml">=</mo><mrow id="S3.E3.m1.4.4.1.1.1" xref="S3.E3.m1.4.4.1.1.1.cmml"><mi id="S3.E3.m1.4.4.1.1.1.2" xref="S3.E3.m1.4.4.1.1.1.2.cmml">arg</mi><mo id="S3.E3.m1.4.4.1.1.1a" lspace="0.167em" xref="S3.E3.m1.4.4.1.1.1.cmml">⁡</mo><mrow id="S3.E3.m1.4.4.1.1.1.1" xref="S3.E3.m1.4.4.1.1.1.1.cmml"><munder id="S3.E3.m1.4.4.1.1.1.1.2" xref="S3.E3.m1.4.4.1.1.1.1.2.cmml"><mi id="S3.E3.m1.4.4.1.1.1.1.2.2" xref="S3.E3.m1.4.4.1.1.1.1.2.2.cmml">min</mi><mi id="S3.E3.m1.4.4.1.1.1.1.2.3" xref="S3.E3.m1.4.4.1.1.1.1.2.3.cmml">𝐗</mi></munder><mo id="S3.E3.m1.4.4.1.1.1.1a" xref="S3.E3.m1.4.4.1.1.1.1.cmml">⁡</mo><msup id="S3.E3.m1.4.4.1.1.1.1.1" xref="S3.E3.m1.4.4.1.1.1.1.1.cmml"><mrow id="S3.E3.m1.4.4.1.1.1.1.1.1.1" xref="S3.E3.m1.4.4.1.1.1.1.1.1.2.cmml"><mo id="S3.E3.m1.4.4.1.1.1.1.1.1.1.2" xref="S3.E3.m1.4.4.1.1.1.1.1.1.2.1.cmml">‖</mo><mrow id="S3.E3.m1.4.4.1.1.1.1.1.1.1.1" xref="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.cmml"><mrow id="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.1" xref="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.1.3" xref="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.1.3.cmml">f</mi><mo id="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.1.2" xref="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.cmml"><mo id="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.cmml">(</mo><msup id="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">𝐖</mi><mrow id="S3.E3.m1.1.1.1.3" xref="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E3.m1.1.1.1.3.1" stretchy="false" xref="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mi id="S3.E3.m1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.cmml">t</mi><mo id="S3.E3.m1.1.1.1.3.2" stretchy="false" xref="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></msup><mo id="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.cmml">;</mo><mi id="S3.E3.m1.3.3" xref="S3.E3.m1.3.3.cmml">𝐗</mi><mo id="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.4" stretchy="false" xref="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.2" xref="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.2.cmml">−</mo><msubsup id="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.3" xref="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.3.cmml"><mo id="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.3.2.2" xref="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.3.2.2.cmml">∇</mo><mtext id="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.3.2.3" xref="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.3.2.3a.cmml">avg</mtext><mrow id="S3.E3.m1.2.2.1.3" xref="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.3.cmml"><mo id="S3.E3.m1.2.2.1.3.1" stretchy="false" xref="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.3.cmml">(</mo><mi id="S3.E3.m1.2.2.1.1" xref="S3.E3.m1.2.2.1.1.cmml">t</mi><mo id="S3.E3.m1.2.2.1.3.2" stretchy="false" xref="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.3.cmml">)</mo></mrow></msubsup></mrow><mo id="S3.E3.m1.4.4.1.1.1.1.1.1.1.3" xref="S3.E3.m1.4.4.1.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S3.E3.m1.4.4.1.1.1.1.1.3" xref="S3.E3.m1.4.4.1.1.1.1.1.3.cmml">2</mn></msup></mrow></mrow></mrow><mo id="S3.E3.m1.4.4.1.2" lspace="0em" xref="S3.E3.m1.4.4.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.4b"><apply id="S3.E3.m1.4.4.1.1.cmml" xref="S3.E3.m1.4.4.1"><eq id="S3.E3.m1.4.4.1.1.2.cmml" xref="S3.E3.m1.4.4.1.1.2"></eq><apply id="S3.E3.m1.4.4.1.1.3.cmml" xref="S3.E3.m1.4.4.1.1.3"><ci id="S3.E3.m1.4.4.1.1.3.1.cmml" xref="S3.E3.m1.4.4.1.1.3.1">^</ci><ci id="S3.E3.m1.4.4.1.1.3.2.cmml" xref="S3.E3.m1.4.4.1.1.3.2">𝐗</ci></apply><apply id="S3.E3.m1.4.4.1.1.1.cmml" xref="S3.E3.m1.4.4.1.1.1"><arg id="S3.E3.m1.4.4.1.1.1.2.cmml" xref="S3.E3.m1.4.4.1.1.1.2"></arg><apply id="S3.E3.m1.4.4.1.1.1.1.cmml" xref="S3.E3.m1.4.4.1.1.1.1"><apply id="S3.E3.m1.4.4.1.1.1.1.2.cmml" xref="S3.E3.m1.4.4.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.4.4.1.1.1.1.2.1.cmml" xref="S3.E3.m1.4.4.1.1.1.1.2">subscript</csymbol><min id="S3.E3.m1.4.4.1.1.1.1.2.2.cmml" xref="S3.E3.m1.4.4.1.1.1.1.2.2"></min><ci id="S3.E3.m1.4.4.1.1.1.1.2.3.cmml" xref="S3.E3.m1.4.4.1.1.1.1.2.3">𝐗</ci></apply><apply id="S3.E3.m1.4.4.1.1.1.1.1.cmml" xref="S3.E3.m1.4.4.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.4.4.1.1.1.1.1.2.cmml" xref="S3.E3.m1.4.4.1.1.1.1.1">superscript</csymbol><apply id="S3.E3.m1.4.4.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.4.4.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E3.m1.4.4.1.1.1.1.1.1.2.1.cmml" xref="S3.E3.m1.4.4.1.1.1.1.1.1.1.2">norm</csymbol><apply id="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.4.4.1.1.1.1.1.1.1.1"><minus id="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.2"></minus><apply id="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.1"><times id="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.1.2"></times><ci id="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.1.3">𝑓</ci><list id="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1"><apply id="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.2">𝐖</ci><ci id="S3.E3.m1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1">𝑡</ci></apply><ci id="S3.E3.m1.3.3.cmml" xref="S3.E3.m1.3.3">𝐗</ci></list></apply><apply id="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.3">superscript</csymbol><apply id="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.3.2.2">∇</ci><ci id="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.3.2.3a.cmml" xref="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.3.2.3"><mtext id="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.3.2.3.cmml" mathsize="70%" xref="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.3.2.3">avg</mtext></ci></apply><ci id="S3.E3.m1.2.2.1.1.cmml" xref="S3.E3.m1.2.2.1.1">𝑡</ci></apply></apply></apply><cn id="S3.E3.m1.4.4.1.1.1.1.1.3.cmml" type="integer" xref="S3.E3.m1.4.4.1.1.1.1.1.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.4c">\hat{\mathbf{X}}=\arg\min_{\mathbf{X}}\left\|f(\mathbf{W}^{(t)};\mathbf{X})-%
\nabla_{\text{avg}}^{(t)}\right\|^{2}.</annotation><annotation encoding="application/x-llamapun" id="S3.E3.m1.4d">over^ start_ARG bold_X end_ARG = roman_arg roman_min start_POSTSUBSCRIPT bold_X end_POSTSUBSCRIPT ∥ italic_f ( bold_W start_POSTSUPERSCRIPT ( italic_t ) end_POSTSUPERSCRIPT ; bold_X ) - ∇ start_POSTSUBSCRIPT avg end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_t ) end_POSTSUPERSCRIPT ∥ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS1.p6">
<p class="ltx_p" id="S3.SS1.p6.3">Finally, the attacker applies a postprocessing function <math alttext="\phi(\cdot)" class="ltx_Math" display="inline" id="S3.SS1.p6.1.m1.1"><semantics id="S3.SS1.p6.1.m1.1a"><mrow id="S3.SS1.p6.1.m1.1.2" xref="S3.SS1.p6.1.m1.1.2.cmml"><mi id="S3.SS1.p6.1.m1.1.2.2" xref="S3.SS1.p6.1.m1.1.2.2.cmml">ϕ</mi><mo id="S3.SS1.p6.1.m1.1.2.1" xref="S3.SS1.p6.1.m1.1.2.1.cmml">⁢</mo><mrow id="S3.SS1.p6.1.m1.1.2.3.2" xref="S3.SS1.p6.1.m1.1.2.cmml"><mo id="S3.SS1.p6.1.m1.1.2.3.2.1" stretchy="false" xref="S3.SS1.p6.1.m1.1.2.cmml">(</mo><mo id="S3.SS1.p6.1.m1.1.1" lspace="0em" rspace="0em" xref="S3.SS1.p6.1.m1.1.1.cmml">⋅</mo><mo id="S3.SS1.p6.1.m1.1.2.3.2.2" stretchy="false" xref="S3.SS1.p6.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p6.1.m1.1b"><apply id="S3.SS1.p6.1.m1.1.2.cmml" xref="S3.SS1.p6.1.m1.1.2"><times id="S3.SS1.p6.1.m1.1.2.1.cmml" xref="S3.SS1.p6.1.m1.1.2.1"></times><ci id="S3.SS1.p6.1.m1.1.2.2.cmml" xref="S3.SS1.p6.1.m1.1.2.2">italic-ϕ</ci><ci id="S3.SS1.p6.1.m1.1.1.cmml" xref="S3.SS1.p6.1.m1.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p6.1.m1.1c">\phi(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p6.1.m1.1d">italic_ϕ ( ⋅ )</annotation></semantics></math> to improve the quality of the reconstructed images <math alttext="\tilde{\mathbf{X}}=\phi(\hat{\mathbf{X}})" class="ltx_Math" display="inline" id="S3.SS1.p6.2.m2.1"><semantics id="S3.SS1.p6.2.m2.1a"><mrow id="S3.SS1.p6.2.m2.1.2" xref="S3.SS1.p6.2.m2.1.2.cmml"><mover accent="true" id="S3.SS1.p6.2.m2.1.2.2" xref="S3.SS1.p6.2.m2.1.2.2.cmml"><mi id="S3.SS1.p6.2.m2.1.2.2.2" xref="S3.SS1.p6.2.m2.1.2.2.2.cmml">𝐗</mi><mo id="S3.SS1.p6.2.m2.1.2.2.1" xref="S3.SS1.p6.2.m2.1.2.2.1.cmml">~</mo></mover><mo id="S3.SS1.p6.2.m2.1.2.1" xref="S3.SS1.p6.2.m2.1.2.1.cmml">=</mo><mrow id="S3.SS1.p6.2.m2.1.2.3" xref="S3.SS1.p6.2.m2.1.2.3.cmml"><mi id="S3.SS1.p6.2.m2.1.2.3.2" xref="S3.SS1.p6.2.m2.1.2.3.2.cmml">ϕ</mi><mo id="S3.SS1.p6.2.m2.1.2.3.1" xref="S3.SS1.p6.2.m2.1.2.3.1.cmml">⁢</mo><mrow id="S3.SS1.p6.2.m2.1.2.3.3.2" xref="S3.SS1.p6.2.m2.1.1.cmml"><mo id="S3.SS1.p6.2.m2.1.2.3.3.2.1" stretchy="false" xref="S3.SS1.p6.2.m2.1.1.cmml">(</mo><mover accent="true" id="S3.SS1.p6.2.m2.1.1" xref="S3.SS1.p6.2.m2.1.1.cmml"><mi id="S3.SS1.p6.2.m2.1.1.2" xref="S3.SS1.p6.2.m2.1.1.2.cmml">𝐗</mi><mo id="S3.SS1.p6.2.m2.1.1.1" xref="S3.SS1.p6.2.m2.1.1.1.cmml">^</mo></mover><mo id="S3.SS1.p6.2.m2.1.2.3.3.2.2" stretchy="false" xref="S3.SS1.p6.2.m2.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p6.2.m2.1b"><apply id="S3.SS1.p6.2.m2.1.2.cmml" xref="S3.SS1.p6.2.m2.1.2"><eq id="S3.SS1.p6.2.m2.1.2.1.cmml" xref="S3.SS1.p6.2.m2.1.2.1"></eq><apply id="S3.SS1.p6.2.m2.1.2.2.cmml" xref="S3.SS1.p6.2.m2.1.2.2"><ci id="S3.SS1.p6.2.m2.1.2.2.1.cmml" xref="S3.SS1.p6.2.m2.1.2.2.1">~</ci><ci id="S3.SS1.p6.2.m2.1.2.2.2.cmml" xref="S3.SS1.p6.2.m2.1.2.2.2">𝐗</ci></apply><apply id="S3.SS1.p6.2.m2.1.2.3.cmml" xref="S3.SS1.p6.2.m2.1.2.3"><times id="S3.SS1.p6.2.m2.1.2.3.1.cmml" xref="S3.SS1.p6.2.m2.1.2.3.1"></times><ci id="S3.SS1.p6.2.m2.1.2.3.2.cmml" xref="S3.SS1.p6.2.m2.1.2.3.2">italic-ϕ</ci><apply id="S3.SS1.p6.2.m2.1.1.cmml" xref="S3.SS1.p6.2.m2.1.2.3.3.2"><ci id="S3.SS1.p6.2.m2.1.1.1.cmml" xref="S3.SS1.p6.2.m2.1.1.1">^</ci><ci id="S3.SS1.p6.2.m2.1.1.2.cmml" xref="S3.SS1.p6.2.m2.1.1.2">𝐗</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p6.2.m2.1c">\tilde{\mathbf{X}}=\phi(\hat{\mathbf{X}})</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p6.2.m2.1d">over~ start_ARG bold_X end_ARG = italic_ϕ ( over^ start_ARG bold_X end_ARG )</annotation></semantics></math>. This shows that a curious client attacker is able to follow an approach similar to server-side gradient inversion and obtain reconstructed data from all other clients from only two consecutive versions of the model weights. We describe below two methods of postprocessing <math alttext="\hat{\mathbf{X}}" class="ltx_Math" display="inline" id="S3.SS1.p6.3.m3.1"><semantics id="S3.SS1.p6.3.m3.1a"><mover accent="true" id="S3.SS1.p6.3.m3.1.1" xref="S3.SS1.p6.3.m3.1.1.cmml"><mi id="S3.SS1.p6.3.m3.1.1.2" xref="S3.SS1.p6.3.m3.1.1.2.cmml">𝐗</mi><mo id="S3.SS1.p6.3.m3.1.1.1" xref="S3.SS1.p6.3.m3.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS1.p6.3.m3.1b"><apply id="S3.SS1.p6.3.m3.1.1.cmml" xref="S3.SS1.p6.3.m3.1.1"><ci id="S3.SS1.p6.3.m3.1.1.1.cmml" xref="S3.SS1.p6.3.m3.1.1.1">^</ci><ci id="S3.SS1.p6.3.m3.1.1.2.cmml" xref="S3.SS1.p6.3.m3.1.1.2">𝐗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p6.3.m3.1c">\hat{\mathbf{X}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p6.3.m3.1d">over^ start_ARG bold_X end_ARG</annotation></semantics></math> to improve its quality at either a pixel or semantic level.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Direct Postprocessing for Pixel-Level Image Enhancement</h3>
<div class="ltx_para ltx_noindent" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.1">To reconstruct the target data more effectively, we introduce a direct postprocessing method that utilizes pretrained diffusion models to perform super resolution and denoising on the raw image reconstructions. The raw reconstructed images from the attack may be low-resolution or have pixel artifacts due to imperfect gradient inversion. This problem may also be more severe in our attack compared to server-side gradient inversion as the target gradient contains diluted information from multiple clients. To address this problem, we introduce a postprocessing implementation, <math alttext="\phi(\cdot)\equiv\phi_{\text{direct}}(\cdot)" class="ltx_Math" display="inline" id="S3.SS2.p1.1.m1.2"><semantics id="S3.SS2.p1.1.m1.2a"><mrow id="S3.SS2.p1.1.m1.2.3" xref="S3.SS2.p1.1.m1.2.3.cmml"><mrow id="S3.SS2.p1.1.m1.2.3.2" xref="S3.SS2.p1.1.m1.2.3.2.cmml"><mi id="S3.SS2.p1.1.m1.2.3.2.2" xref="S3.SS2.p1.1.m1.2.3.2.2.cmml">ϕ</mi><mo id="S3.SS2.p1.1.m1.2.3.2.1" xref="S3.SS2.p1.1.m1.2.3.2.1.cmml">⁢</mo><mrow id="S3.SS2.p1.1.m1.2.3.2.3.2" xref="S3.SS2.p1.1.m1.2.3.2.cmml"><mo id="S3.SS2.p1.1.m1.2.3.2.3.2.1" stretchy="false" xref="S3.SS2.p1.1.m1.2.3.2.cmml">(</mo><mo id="S3.SS2.p1.1.m1.1.1" lspace="0em" rspace="0em" xref="S3.SS2.p1.1.m1.1.1.cmml">⋅</mo><mo id="S3.SS2.p1.1.m1.2.3.2.3.2.2" stretchy="false" xref="S3.SS2.p1.1.m1.2.3.2.cmml">)</mo></mrow></mrow><mo id="S3.SS2.p1.1.m1.2.3.1" xref="S3.SS2.p1.1.m1.2.3.1.cmml">≡</mo><mrow id="S3.SS2.p1.1.m1.2.3.3" xref="S3.SS2.p1.1.m1.2.3.3.cmml"><msub id="S3.SS2.p1.1.m1.2.3.3.2" xref="S3.SS2.p1.1.m1.2.3.3.2.cmml"><mi id="S3.SS2.p1.1.m1.2.3.3.2.2" xref="S3.SS2.p1.1.m1.2.3.3.2.2.cmml">ϕ</mi><mtext id="S3.SS2.p1.1.m1.2.3.3.2.3" xref="S3.SS2.p1.1.m1.2.3.3.2.3a.cmml">direct</mtext></msub><mo id="S3.SS2.p1.1.m1.2.3.3.1" xref="S3.SS2.p1.1.m1.2.3.3.1.cmml">⁢</mo><mrow id="S3.SS2.p1.1.m1.2.3.3.3.2" xref="S3.SS2.p1.1.m1.2.3.3.cmml"><mo id="S3.SS2.p1.1.m1.2.3.3.3.2.1" stretchy="false" xref="S3.SS2.p1.1.m1.2.3.3.cmml">(</mo><mo id="S3.SS2.p1.1.m1.2.2" lspace="0em" rspace="0em" xref="S3.SS2.p1.1.m1.2.2.cmml">⋅</mo><mo id="S3.SS2.p1.1.m1.2.3.3.3.2.2" stretchy="false" xref="S3.SS2.p1.1.m1.2.3.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.2b"><apply id="S3.SS2.p1.1.m1.2.3.cmml" xref="S3.SS2.p1.1.m1.2.3"><equivalent id="S3.SS2.p1.1.m1.2.3.1.cmml" xref="S3.SS2.p1.1.m1.2.3.1"></equivalent><apply id="S3.SS2.p1.1.m1.2.3.2.cmml" xref="S3.SS2.p1.1.m1.2.3.2"><times id="S3.SS2.p1.1.m1.2.3.2.1.cmml" xref="S3.SS2.p1.1.m1.2.3.2.1"></times><ci id="S3.SS2.p1.1.m1.2.3.2.2.cmml" xref="S3.SS2.p1.1.m1.2.3.2.2">italic-ϕ</ci><ci id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1">⋅</ci></apply><apply id="S3.SS2.p1.1.m1.2.3.3.cmml" xref="S3.SS2.p1.1.m1.2.3.3"><times id="S3.SS2.p1.1.m1.2.3.3.1.cmml" xref="S3.SS2.p1.1.m1.2.3.3.1"></times><apply id="S3.SS2.p1.1.m1.2.3.3.2.cmml" xref="S3.SS2.p1.1.m1.2.3.3.2"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.2.3.3.2.1.cmml" xref="S3.SS2.p1.1.m1.2.3.3.2">subscript</csymbol><ci id="S3.SS2.p1.1.m1.2.3.3.2.2.cmml" xref="S3.SS2.p1.1.m1.2.3.3.2.2">italic-ϕ</ci><ci id="S3.SS2.p1.1.m1.2.3.3.2.3a.cmml" xref="S3.SS2.p1.1.m1.2.3.3.2.3"><mtext id="S3.SS2.p1.1.m1.2.3.3.2.3.cmml" mathsize="70%" xref="S3.SS2.p1.1.m1.2.3.3.2.3">direct</mtext></ci></apply><ci id="S3.SS2.p1.1.m1.2.2.cmml" xref="S3.SS2.p1.1.m1.2.2">⋅</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.2c">\phi(\cdot)\equiv\phi_{\text{direct}}(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.1.m1.2d">italic_ϕ ( ⋅ ) ≡ italic_ϕ start_POSTSUBSCRIPT direct end_POSTSUBSCRIPT ( ⋅ )</annotation></semantics></math> that uses pretrained diffusion models to directly postprocess the raw reconstructed images.
Diffusion models have demonstrated good performance in image generation and restoration tasks and are able to produce more realistic images with a lower likelihood of hallucination <cite class="ltx_cite ltx_citemacro_citep">(Dhariwal &amp; Nichol, <a class="ltx_ref" href="https://arxiv.org/html/2410.04661v1#bib.bib3" title="">2021</a>)</cite>. Our method follows the denoising diffusion restoration models (DDRM) framework and utilizes a pretrained DDPM <cite class="ltx_cite ltx_citemacro_citep">(Ho et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04661v1#bib.bib8" title="">2020</a>)</cite> as a backbone model. DDRM has demonstrated strong performance across various image restoration tasks, including super resolution and denoising <cite class="ltx_cite ltx_citemacro_citep">(Kawar et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04661v1#bib.bib11" title="">2022</a>)</cite>. By increasing resolution and removing noise, we aim to accurately reveal details of the ground truth images and make the reconstructions more recognizable.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Masked Diffusion Enhancer: reconstruction at a semantic level</h3>
<div class="ltx_para ltx_noindent" id="S3.SS3.p1">
<p class="ltx_p" id="S3.SS3.p1.1">In this subsection, we also introduce a method to reconstruct target images at the semantic level, <math alttext="\phi(\cdot)\equiv\phi_{\text{semantic}}(\cdot)" class="ltx_Math" display="inline" id="S3.SS3.p1.1.m1.2"><semantics id="S3.SS3.p1.1.m1.2a"><mrow id="S3.SS3.p1.1.m1.2.3" xref="S3.SS3.p1.1.m1.2.3.cmml"><mrow id="S3.SS3.p1.1.m1.2.3.2" xref="S3.SS3.p1.1.m1.2.3.2.cmml"><mi id="S3.SS3.p1.1.m1.2.3.2.2" xref="S3.SS3.p1.1.m1.2.3.2.2.cmml">ϕ</mi><mo id="S3.SS3.p1.1.m1.2.3.2.1" xref="S3.SS3.p1.1.m1.2.3.2.1.cmml">⁢</mo><mrow id="S3.SS3.p1.1.m1.2.3.2.3.2" xref="S3.SS3.p1.1.m1.2.3.2.cmml"><mo id="S3.SS3.p1.1.m1.2.3.2.3.2.1" stretchy="false" xref="S3.SS3.p1.1.m1.2.3.2.cmml">(</mo><mo id="S3.SS3.p1.1.m1.1.1" lspace="0em" rspace="0em" xref="S3.SS3.p1.1.m1.1.1.cmml">⋅</mo><mo id="S3.SS3.p1.1.m1.2.3.2.3.2.2" stretchy="false" xref="S3.SS3.p1.1.m1.2.3.2.cmml">)</mo></mrow></mrow><mo id="S3.SS3.p1.1.m1.2.3.1" xref="S3.SS3.p1.1.m1.2.3.1.cmml">≡</mo><mrow id="S3.SS3.p1.1.m1.2.3.3" xref="S3.SS3.p1.1.m1.2.3.3.cmml"><msub id="S3.SS3.p1.1.m1.2.3.3.2" xref="S3.SS3.p1.1.m1.2.3.3.2.cmml"><mi id="S3.SS3.p1.1.m1.2.3.3.2.2" xref="S3.SS3.p1.1.m1.2.3.3.2.2.cmml">ϕ</mi><mtext id="S3.SS3.p1.1.m1.2.3.3.2.3" xref="S3.SS3.p1.1.m1.2.3.3.2.3a.cmml">semantic</mtext></msub><mo id="S3.SS3.p1.1.m1.2.3.3.1" xref="S3.SS3.p1.1.m1.2.3.3.1.cmml">⁢</mo><mrow id="S3.SS3.p1.1.m1.2.3.3.3.2" xref="S3.SS3.p1.1.m1.2.3.3.cmml"><mo id="S3.SS3.p1.1.m1.2.3.3.3.2.1" stretchy="false" xref="S3.SS3.p1.1.m1.2.3.3.cmml">(</mo><mo id="S3.SS3.p1.1.m1.2.2" lspace="0em" rspace="0em" xref="S3.SS3.p1.1.m1.2.2.cmml">⋅</mo><mo id="S3.SS3.p1.1.m1.2.3.3.3.2.2" stretchy="false" xref="S3.SS3.p1.1.m1.2.3.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.1.m1.2b"><apply id="S3.SS3.p1.1.m1.2.3.cmml" xref="S3.SS3.p1.1.m1.2.3"><equivalent id="S3.SS3.p1.1.m1.2.3.1.cmml" xref="S3.SS3.p1.1.m1.2.3.1"></equivalent><apply id="S3.SS3.p1.1.m1.2.3.2.cmml" xref="S3.SS3.p1.1.m1.2.3.2"><times id="S3.SS3.p1.1.m1.2.3.2.1.cmml" xref="S3.SS3.p1.1.m1.2.3.2.1"></times><ci id="S3.SS3.p1.1.m1.2.3.2.2.cmml" xref="S3.SS3.p1.1.m1.2.3.2.2">italic-ϕ</ci><ci id="S3.SS3.p1.1.m1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1">⋅</ci></apply><apply id="S3.SS3.p1.1.m1.2.3.3.cmml" xref="S3.SS3.p1.1.m1.2.3.3"><times id="S3.SS3.p1.1.m1.2.3.3.1.cmml" xref="S3.SS3.p1.1.m1.2.3.3.1"></times><apply id="S3.SS3.p1.1.m1.2.3.3.2.cmml" xref="S3.SS3.p1.1.m1.2.3.3.2"><csymbol cd="ambiguous" id="S3.SS3.p1.1.m1.2.3.3.2.1.cmml" xref="S3.SS3.p1.1.m1.2.3.3.2">subscript</csymbol><ci id="S3.SS3.p1.1.m1.2.3.3.2.2.cmml" xref="S3.SS3.p1.1.m1.2.3.3.2.2">italic-ϕ</ci><ci id="S3.SS3.p1.1.m1.2.3.3.2.3a.cmml" xref="S3.SS3.p1.1.m1.2.3.3.2.3"><mtext id="S3.SS3.p1.1.m1.2.3.3.2.3.cmml" mathsize="70%" xref="S3.SS3.p1.1.m1.2.3.3.2.3">semantic</mtext></ci></apply><ci id="S3.SS3.p1.1.m1.2.2.cmml" xref="S3.SS3.p1.1.m1.2.2">⋅</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.1.m1.2c">\phi(\cdot)\equiv\phi_{\text{semantic}}(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.1.m1.2d">italic_ϕ ( ⋅ ) ≡ italic_ϕ start_POSTSUBSCRIPT semantic end_POSTSUBSCRIPT ( ⋅ )</annotation></semantics></math>, the masked diffusion enhancer (MDE). The goal of MDE is to generate sharp, high-resolution images from the low-resolution, color-aliased raw attack results. This approach complements the direct postprocessing technique, as the generated images resemble the raw reconstructions at the semantic level, rather than at the pixel level.
The generated images preserve the shape and perceptual features of the target image while achieving photorealistic quality.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS3.p2">
<p class="ltx_p" id="S3.SS3.p2.9"><span class="ltx_text ltx_font_bold" id="S3.SS3.p2.9.1">Backbone Model.</span> We use masked diffusion transformer (MDT) as the backbone of our reconstruction technique. MDT has been proven to achieve state-of-the-art performance in image generation <cite class="ltx_cite ltx_citemacro_citep">(Gao et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04661v1#bib.bib5" title="">2023</a>)</cite>. Due to its extensive training and flexibility, MDT has learned a complex representation of each image class that enables it to accurately reconstruct each image’s semantic features through projection onto the manifold. Following the diffusion framework, MDT generates images by starting from a Gaussian noise vector <math alttext="\mathbf{X}_{T}\sim\mathcal{N}(\textbf{\text{0}},\textbf{\text{I}})" class="ltx_Math" display="inline" id="S3.SS3.p2.1.m1.2"><semantics id="S3.SS3.p2.1.m1.2a"><mrow id="S3.SS3.p2.1.m1.2.3" xref="S3.SS3.p2.1.m1.2.3.cmml"><msub id="S3.SS3.p2.1.m1.2.3.2" xref="S3.SS3.p2.1.m1.2.3.2.cmml"><mi id="S3.SS3.p2.1.m1.2.3.2.2" xref="S3.SS3.p2.1.m1.2.3.2.2.cmml">𝐗</mi><mi id="S3.SS3.p2.1.m1.2.3.2.3" xref="S3.SS3.p2.1.m1.2.3.2.3.cmml">T</mi></msub><mo id="S3.SS3.p2.1.m1.2.3.1" xref="S3.SS3.p2.1.m1.2.3.1.cmml">∼</mo><mrow id="S3.SS3.p2.1.m1.2.3.3" xref="S3.SS3.p2.1.m1.2.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p2.1.m1.2.3.3.2" xref="S3.SS3.p2.1.m1.2.3.3.2.cmml">𝒩</mi><mo id="S3.SS3.p2.1.m1.2.3.3.1" xref="S3.SS3.p2.1.m1.2.3.3.1.cmml">⁢</mo><mrow id="S3.SS3.p2.1.m1.2.3.3.3.2" xref="S3.SS3.p2.1.m1.2.3.3.3.1.cmml"><mo id="S3.SS3.p2.1.m1.2.3.3.3.2.1" stretchy="false" xref="S3.SS3.p2.1.m1.2.3.3.3.1.cmml">(</mo><mtext class="ltx_mathvariant_bold" id="S3.SS3.p2.1.m1.1.1" xref="S3.SS3.p2.1.m1.1.1a.cmml">0</mtext><mo id="S3.SS3.p2.1.m1.2.3.3.3.2.2" xref="S3.SS3.p2.1.m1.2.3.3.3.1.cmml">,</mo><mtext class="ltx_mathvariant_bold" id="S3.SS3.p2.1.m1.2.2" xref="S3.SS3.p2.1.m1.2.2a.cmml">I</mtext><mo id="S3.SS3.p2.1.m1.2.3.3.3.2.3" stretchy="false" xref="S3.SS3.p2.1.m1.2.3.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.1.m1.2b"><apply id="S3.SS3.p2.1.m1.2.3.cmml" xref="S3.SS3.p2.1.m1.2.3"><csymbol cd="latexml" id="S3.SS3.p2.1.m1.2.3.1.cmml" xref="S3.SS3.p2.1.m1.2.3.1">similar-to</csymbol><apply id="S3.SS3.p2.1.m1.2.3.2.cmml" xref="S3.SS3.p2.1.m1.2.3.2"><csymbol cd="ambiguous" id="S3.SS3.p2.1.m1.2.3.2.1.cmml" xref="S3.SS3.p2.1.m1.2.3.2">subscript</csymbol><ci id="S3.SS3.p2.1.m1.2.3.2.2.cmml" xref="S3.SS3.p2.1.m1.2.3.2.2">𝐗</ci><ci id="S3.SS3.p2.1.m1.2.3.2.3.cmml" xref="S3.SS3.p2.1.m1.2.3.2.3">𝑇</ci></apply><apply id="S3.SS3.p2.1.m1.2.3.3.cmml" xref="S3.SS3.p2.1.m1.2.3.3"><times id="S3.SS3.p2.1.m1.2.3.3.1.cmml" xref="S3.SS3.p2.1.m1.2.3.3.1"></times><ci id="S3.SS3.p2.1.m1.2.3.3.2.cmml" xref="S3.SS3.p2.1.m1.2.3.3.2">𝒩</ci><interval closure="open" id="S3.SS3.p2.1.m1.2.3.3.3.1.cmml" xref="S3.SS3.p2.1.m1.2.3.3.3.2"><ci id="S3.SS3.p2.1.m1.1.1a.cmml" xref="S3.SS3.p2.1.m1.1.1"><mtext class="ltx_mathvariant_bold" id="S3.SS3.p2.1.m1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1">0</mtext></ci><ci id="S3.SS3.p2.1.m1.2.2a.cmml" xref="S3.SS3.p2.1.m1.2.2"><mtext class="ltx_mathvariant_bold" id="S3.SS3.p2.1.m1.2.2.cmml" xref="S3.SS3.p2.1.m1.2.2">I</mtext></ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.1.m1.2c">\mathbf{X}_{T}\sim\mathcal{N}(\textbf{\text{0}},\textbf{\text{I}})</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.1.m1.2d">bold_X start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT ∼ caligraphic_N ( 0 , I )</annotation></semantics></math>, where <math alttext="T" class="ltx_Math" display="inline" id="S3.SS3.p2.2.m2.1"><semantics id="S3.SS3.p2.2.m2.1a"><mi id="S3.SS3.p2.2.m2.1.1" xref="S3.SS3.p2.2.m2.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.2.m2.1b"><ci id="S3.SS3.p2.2.m2.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.2.m2.1c">T</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.2.m2.1d">italic_T</annotation></semantics></math> is the total number of diffusion steps. At each step <math alttext="t" class="ltx_Math" display="inline" id="S3.SS3.p2.3.m3.1"><semantics id="S3.SS3.p2.3.m3.1a"><mi id="S3.SS3.p2.3.m3.1.1" xref="S3.SS3.p2.3.m3.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.3.m3.1b"><ci id="S3.SS3.p2.3.m3.1.1.cmml" xref="S3.SS3.p2.3.m3.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.3.m3.1c">t</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.3.m3.1d">italic_t</annotation></semantics></math>, the model predicts a noise residual <math alttext="\epsilon_{\theta}(\mathbf{X}_{t})" class="ltx_Math" display="inline" id="S3.SS3.p2.4.m4.1"><semantics id="S3.SS3.p2.4.m4.1a"><mrow id="S3.SS3.p2.4.m4.1.1" xref="S3.SS3.p2.4.m4.1.1.cmml"><msub id="S3.SS3.p2.4.m4.1.1.3" xref="S3.SS3.p2.4.m4.1.1.3.cmml"><mi id="S3.SS3.p2.4.m4.1.1.3.2" xref="S3.SS3.p2.4.m4.1.1.3.2.cmml">ϵ</mi><mi id="S3.SS3.p2.4.m4.1.1.3.3" xref="S3.SS3.p2.4.m4.1.1.3.3.cmml">θ</mi></msub><mo id="S3.SS3.p2.4.m4.1.1.2" xref="S3.SS3.p2.4.m4.1.1.2.cmml">⁢</mo><mrow id="S3.SS3.p2.4.m4.1.1.1.1" xref="S3.SS3.p2.4.m4.1.1.1.1.1.cmml"><mo id="S3.SS3.p2.4.m4.1.1.1.1.2" stretchy="false" xref="S3.SS3.p2.4.m4.1.1.1.1.1.cmml">(</mo><msub id="S3.SS3.p2.4.m4.1.1.1.1.1" xref="S3.SS3.p2.4.m4.1.1.1.1.1.cmml"><mi id="S3.SS3.p2.4.m4.1.1.1.1.1.2" xref="S3.SS3.p2.4.m4.1.1.1.1.1.2.cmml">𝐗</mi><mi id="S3.SS3.p2.4.m4.1.1.1.1.1.3" xref="S3.SS3.p2.4.m4.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.SS3.p2.4.m4.1.1.1.1.3" stretchy="false" xref="S3.SS3.p2.4.m4.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.4.m4.1b"><apply id="S3.SS3.p2.4.m4.1.1.cmml" xref="S3.SS3.p2.4.m4.1.1"><times id="S3.SS3.p2.4.m4.1.1.2.cmml" xref="S3.SS3.p2.4.m4.1.1.2"></times><apply id="S3.SS3.p2.4.m4.1.1.3.cmml" xref="S3.SS3.p2.4.m4.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p2.4.m4.1.1.3.1.cmml" xref="S3.SS3.p2.4.m4.1.1.3">subscript</csymbol><ci id="S3.SS3.p2.4.m4.1.1.3.2.cmml" xref="S3.SS3.p2.4.m4.1.1.3.2">italic-ϵ</ci><ci id="S3.SS3.p2.4.m4.1.1.3.3.cmml" xref="S3.SS3.p2.4.m4.1.1.3.3">𝜃</ci></apply><apply id="S3.SS3.p2.4.m4.1.1.1.1.1.cmml" xref="S3.SS3.p2.4.m4.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.4.m4.1.1.1.1.1.1.cmml" xref="S3.SS3.p2.4.m4.1.1.1.1">subscript</csymbol><ci id="S3.SS3.p2.4.m4.1.1.1.1.1.2.cmml" xref="S3.SS3.p2.4.m4.1.1.1.1.1.2">𝐗</ci><ci id="S3.SS3.p2.4.m4.1.1.1.1.1.3.cmml" xref="S3.SS3.p2.4.m4.1.1.1.1.1.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.4.m4.1c">\epsilon_{\theta}(\mathbf{X}_{t})</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.4.m4.1d">italic_ϵ start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( bold_X start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math>, and uses it to refine the noisy image <math alttext="\mathbf{X}_{t}" class="ltx_Math" display="inline" id="S3.SS3.p2.5.m5.1"><semantics id="S3.SS3.p2.5.m5.1a"><msub id="S3.SS3.p2.5.m5.1.1" xref="S3.SS3.p2.5.m5.1.1.cmml"><mi id="S3.SS3.p2.5.m5.1.1.2" xref="S3.SS3.p2.5.m5.1.1.2.cmml">𝐗</mi><mi id="S3.SS3.p2.5.m5.1.1.3" xref="S3.SS3.p2.5.m5.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.5.m5.1b"><apply id="S3.SS3.p2.5.m5.1.1.cmml" xref="S3.SS3.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.5.m5.1.1.1.cmml" xref="S3.SS3.p2.5.m5.1.1">subscript</csymbol><ci id="S3.SS3.p2.5.m5.1.1.2.cmml" xref="S3.SS3.p2.5.m5.1.1.2">𝐗</ci><ci id="S3.SS3.p2.5.m5.1.1.3.cmml" xref="S3.SS3.p2.5.m5.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.5.m5.1c">\mathbf{X}_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.5.m5.1d">bold_X start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> to <math alttext="\mathbf{X}_{t-1}" class="ltx_Math" display="inline" id="S3.SS3.p2.6.m6.1"><semantics id="S3.SS3.p2.6.m6.1a"><msub id="S3.SS3.p2.6.m6.1.1" xref="S3.SS3.p2.6.m6.1.1.cmml"><mi id="S3.SS3.p2.6.m6.1.1.2" xref="S3.SS3.p2.6.m6.1.1.2.cmml">𝐗</mi><mrow id="S3.SS3.p2.6.m6.1.1.3" xref="S3.SS3.p2.6.m6.1.1.3.cmml"><mi id="S3.SS3.p2.6.m6.1.1.3.2" xref="S3.SS3.p2.6.m6.1.1.3.2.cmml">t</mi><mo id="S3.SS3.p2.6.m6.1.1.3.1" xref="S3.SS3.p2.6.m6.1.1.3.1.cmml">−</mo><mn id="S3.SS3.p2.6.m6.1.1.3.3" xref="S3.SS3.p2.6.m6.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.6.m6.1b"><apply id="S3.SS3.p2.6.m6.1.1.cmml" xref="S3.SS3.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.6.m6.1.1.1.cmml" xref="S3.SS3.p2.6.m6.1.1">subscript</csymbol><ci id="S3.SS3.p2.6.m6.1.1.2.cmml" xref="S3.SS3.p2.6.m6.1.1.2">𝐗</ci><apply id="S3.SS3.p2.6.m6.1.1.3.cmml" xref="S3.SS3.p2.6.m6.1.1.3"><minus id="S3.SS3.p2.6.m6.1.1.3.1.cmml" xref="S3.SS3.p2.6.m6.1.1.3.1"></minus><ci id="S3.SS3.p2.6.m6.1.1.3.2.cmml" xref="S3.SS3.p2.6.m6.1.1.3.2">𝑡</ci><cn id="S3.SS3.p2.6.m6.1.1.3.3.cmml" type="integer" xref="S3.SS3.p2.6.m6.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.6.m6.1c">\mathbf{X}_{t-1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.6.m6.1d">bold_X start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT</annotation></semantics></math>. After <math alttext="T" class="ltx_Math" display="inline" id="S3.SS3.p2.7.m7.1"><semantics id="S3.SS3.p2.7.m7.1a"><mi id="S3.SS3.p2.7.m7.1.1" xref="S3.SS3.p2.7.m7.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.7.m7.1b"><ci id="S3.SS3.p2.7.m7.1.1.cmml" xref="S3.SS3.p2.7.m7.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.7.m7.1c">T</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.7.m7.1d">italic_T</annotation></semantics></math> iterations, the initial noise vector <math alttext="\mathbf{X}_{T}" class="ltx_Math" display="inline" id="S3.SS3.p2.8.m8.1"><semantics id="S3.SS3.p2.8.m8.1a"><msub id="S3.SS3.p2.8.m8.1.1" xref="S3.SS3.p2.8.m8.1.1.cmml"><mi id="S3.SS3.p2.8.m8.1.1.2" xref="S3.SS3.p2.8.m8.1.1.2.cmml">𝐗</mi><mi id="S3.SS3.p2.8.m8.1.1.3" xref="S3.SS3.p2.8.m8.1.1.3.cmml">T</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.8.m8.1b"><apply id="S3.SS3.p2.8.m8.1.1.cmml" xref="S3.SS3.p2.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.8.m8.1.1.1.cmml" xref="S3.SS3.p2.8.m8.1.1">subscript</csymbol><ci id="S3.SS3.p2.8.m8.1.1.2.cmml" xref="S3.SS3.p2.8.m8.1.1.2">𝐗</ci><ci id="S3.SS3.p2.8.m8.1.1.3.cmml" xref="S3.SS3.p2.8.m8.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.8.m8.1c">\mathbf{X}_{T}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.8.m8.1d">bold_X start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT</annotation></semantics></math> will be transformed into a high quality image <math alttext="\mathbf{X}_{\text{0}}" class="ltx_Math" display="inline" id="S3.SS3.p2.9.m9.1"><semantics id="S3.SS3.p2.9.m9.1a"><msub id="S3.SS3.p2.9.m9.1.1" xref="S3.SS3.p2.9.m9.1.1.cmml"><mi id="S3.SS3.p2.9.m9.1.1.2" xref="S3.SS3.p2.9.m9.1.1.2.cmml">𝐗</mi><mtext id="S3.SS3.p2.9.m9.1.1.3" xref="S3.SS3.p2.9.m9.1.1.3a.cmml">0</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.9.m9.1b"><apply id="S3.SS3.p2.9.m9.1.1.cmml" xref="S3.SS3.p2.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.9.m9.1.1.1.cmml" xref="S3.SS3.p2.9.m9.1.1">subscript</csymbol><ci id="S3.SS3.p2.9.m9.1.1.2.cmml" xref="S3.SS3.p2.9.m9.1.1.2">𝐗</ci><ci id="S3.SS3.p2.9.m9.1.1.3a.cmml" xref="S3.SS3.p2.9.m9.1.1.3"><mtext id="S3.SS3.p2.9.m9.1.1.3.cmml" mathsize="70%" xref="S3.SS3.p2.9.m9.1.1.3">0</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.9.m9.1c">\mathbf{X}_{\text{0}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.9.m9.1d">bold_X start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math>. For our reconstruction technique, we leverage a pretrained MDT and freeze its model parameters throughout the process to maintain consistency in the image generation pipeline.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS3.p3">
<p class="ltx_p" id="S3.SS3.p3.5"><span class="ltx_text ltx_font_bold" id="S3.SS3.p3.5.1">Proposed Masked Diffusion Enhancer (MDE).</span> MDE optimizes the initial noise vector <math alttext="\mathbf{X}_{T}" class="ltx_Math" display="inline" id="S3.SS3.p3.1.m1.1"><semantics id="S3.SS3.p3.1.m1.1a"><msub id="S3.SS3.p3.1.m1.1.1" xref="S3.SS3.p3.1.m1.1.1.cmml"><mi id="S3.SS3.p3.1.m1.1.1.2" xref="S3.SS3.p3.1.m1.1.1.2.cmml">𝐗</mi><mi id="S3.SS3.p3.1.m1.1.1.3" xref="S3.SS3.p3.1.m1.1.1.3.cmml">T</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.1.m1.1b"><apply id="S3.SS3.p3.1.m1.1.1.cmml" xref="S3.SS3.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.1.m1.1.1.1.cmml" xref="S3.SS3.p3.1.m1.1.1">subscript</csymbol><ci id="S3.SS3.p3.1.m1.1.1.2.cmml" xref="S3.SS3.p3.1.m1.1.1.2">𝐗</ci><ci id="S3.SS3.p3.1.m1.1.1.3.cmml" xref="S3.SS3.p3.1.m1.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.1.m1.1c">\mathbf{X}_{T}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.1.m1.1d">bold_X start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT</annotation></semantics></math> to generate an image that closely matches a target image <math alttext="\hat{\mathbf{X}}" class="ltx_Math" display="inline" id="S3.SS3.p3.2.m2.1"><semantics id="S3.SS3.p3.2.m2.1a"><mover accent="true" id="S3.SS3.p3.2.m2.1.1" xref="S3.SS3.p3.2.m2.1.1.cmml"><mi id="S3.SS3.p3.2.m2.1.1.2" xref="S3.SS3.p3.2.m2.1.1.2.cmml">𝐗</mi><mo id="S3.SS3.p3.2.m2.1.1.1" xref="S3.SS3.p3.2.m2.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.2.m2.1b"><apply id="S3.SS3.p3.2.m2.1.1.cmml" xref="S3.SS3.p3.2.m2.1.1"><ci id="S3.SS3.p3.2.m2.1.1.1.cmml" xref="S3.SS3.p3.2.m2.1.1.1">^</ci><ci id="S3.SS3.p3.2.m2.1.1.2.cmml" xref="S3.SS3.p3.2.m2.1.1.2">𝐗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.2.m2.1c">\hat{\mathbf{X}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.2.m2.1d">over^ start_ARG bold_X end_ARG</annotation></semantics></math>. During optimization, the noise predictions <math alttext="\epsilon_{\theta}(\mathbf{X}_{t})" class="ltx_Math" display="inline" id="S3.SS3.p3.3.m3.1"><semantics id="S3.SS3.p3.3.m3.1a"><mrow id="S3.SS3.p3.3.m3.1.1" xref="S3.SS3.p3.3.m3.1.1.cmml"><msub id="S3.SS3.p3.3.m3.1.1.3" xref="S3.SS3.p3.3.m3.1.1.3.cmml"><mi id="S3.SS3.p3.3.m3.1.1.3.2" xref="S3.SS3.p3.3.m3.1.1.3.2.cmml">ϵ</mi><mi id="S3.SS3.p3.3.m3.1.1.3.3" xref="S3.SS3.p3.3.m3.1.1.3.3.cmml">θ</mi></msub><mo id="S3.SS3.p3.3.m3.1.1.2" xref="S3.SS3.p3.3.m3.1.1.2.cmml">⁢</mo><mrow id="S3.SS3.p3.3.m3.1.1.1.1" xref="S3.SS3.p3.3.m3.1.1.1.1.1.cmml"><mo id="S3.SS3.p3.3.m3.1.1.1.1.2" stretchy="false" xref="S3.SS3.p3.3.m3.1.1.1.1.1.cmml">(</mo><msub id="S3.SS3.p3.3.m3.1.1.1.1.1" xref="S3.SS3.p3.3.m3.1.1.1.1.1.cmml"><mi id="S3.SS3.p3.3.m3.1.1.1.1.1.2" xref="S3.SS3.p3.3.m3.1.1.1.1.1.2.cmml">𝐗</mi><mi id="S3.SS3.p3.3.m3.1.1.1.1.1.3" xref="S3.SS3.p3.3.m3.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.SS3.p3.3.m3.1.1.1.1.3" stretchy="false" xref="S3.SS3.p3.3.m3.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.3.m3.1b"><apply id="S3.SS3.p3.3.m3.1.1.cmml" xref="S3.SS3.p3.3.m3.1.1"><times id="S3.SS3.p3.3.m3.1.1.2.cmml" xref="S3.SS3.p3.3.m3.1.1.2"></times><apply id="S3.SS3.p3.3.m3.1.1.3.cmml" xref="S3.SS3.p3.3.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p3.3.m3.1.1.3.1.cmml" xref="S3.SS3.p3.3.m3.1.1.3">subscript</csymbol><ci id="S3.SS3.p3.3.m3.1.1.3.2.cmml" xref="S3.SS3.p3.3.m3.1.1.3.2">italic-ϵ</ci><ci id="S3.SS3.p3.3.m3.1.1.3.3.cmml" xref="S3.SS3.p3.3.m3.1.1.3.3">𝜃</ci></apply><apply id="S3.SS3.p3.3.m3.1.1.1.1.1.cmml" xref="S3.SS3.p3.3.m3.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.3.m3.1.1.1.1.1.1.cmml" xref="S3.SS3.p3.3.m3.1.1.1.1">subscript</csymbol><ci id="S3.SS3.p3.3.m3.1.1.1.1.1.2.cmml" xref="S3.SS3.p3.3.m3.1.1.1.1.1.2">𝐗</ci><ci id="S3.SS3.p3.3.m3.1.1.1.1.1.3.cmml" xref="S3.SS3.p3.3.m3.1.1.1.1.1.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.3.m3.1c">\epsilon_{\theta}(\mathbf{X}_{t})</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.3.m3.1d">italic_ϵ start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( bold_X start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math> at each timestep are treated as constants. The objective of MDE is to minimize the mean squared error (MSE) between the final generated image <math alttext="\mu_{\theta}(X_{T},T)" class="ltx_Math" display="inline" id="S3.SS3.p3.4.m4.2"><semantics id="S3.SS3.p3.4.m4.2a"><mrow id="S3.SS3.p3.4.m4.2.2" xref="S3.SS3.p3.4.m4.2.2.cmml"><msub id="S3.SS3.p3.4.m4.2.2.3" xref="S3.SS3.p3.4.m4.2.2.3.cmml"><mi id="S3.SS3.p3.4.m4.2.2.3.2" xref="S3.SS3.p3.4.m4.2.2.3.2.cmml">μ</mi><mi id="S3.SS3.p3.4.m4.2.2.3.3" xref="S3.SS3.p3.4.m4.2.2.3.3.cmml">θ</mi></msub><mo id="S3.SS3.p3.4.m4.2.2.2" xref="S3.SS3.p3.4.m4.2.2.2.cmml">⁢</mo><mrow id="S3.SS3.p3.4.m4.2.2.1.1" xref="S3.SS3.p3.4.m4.2.2.1.2.cmml"><mo id="S3.SS3.p3.4.m4.2.2.1.1.2" stretchy="false" xref="S3.SS3.p3.4.m4.2.2.1.2.cmml">(</mo><msub id="S3.SS3.p3.4.m4.2.2.1.1.1" xref="S3.SS3.p3.4.m4.2.2.1.1.1.cmml"><mi id="S3.SS3.p3.4.m4.2.2.1.1.1.2" xref="S3.SS3.p3.4.m4.2.2.1.1.1.2.cmml">X</mi><mi id="S3.SS3.p3.4.m4.2.2.1.1.1.3" xref="S3.SS3.p3.4.m4.2.2.1.1.1.3.cmml">T</mi></msub><mo id="S3.SS3.p3.4.m4.2.2.1.1.3" xref="S3.SS3.p3.4.m4.2.2.1.2.cmml">,</mo><mi id="S3.SS3.p3.4.m4.1.1" xref="S3.SS3.p3.4.m4.1.1.cmml">T</mi><mo id="S3.SS3.p3.4.m4.2.2.1.1.4" stretchy="false" xref="S3.SS3.p3.4.m4.2.2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.4.m4.2b"><apply id="S3.SS3.p3.4.m4.2.2.cmml" xref="S3.SS3.p3.4.m4.2.2"><times id="S3.SS3.p3.4.m4.2.2.2.cmml" xref="S3.SS3.p3.4.m4.2.2.2"></times><apply id="S3.SS3.p3.4.m4.2.2.3.cmml" xref="S3.SS3.p3.4.m4.2.2.3"><csymbol cd="ambiguous" id="S3.SS3.p3.4.m4.2.2.3.1.cmml" xref="S3.SS3.p3.4.m4.2.2.3">subscript</csymbol><ci id="S3.SS3.p3.4.m4.2.2.3.2.cmml" xref="S3.SS3.p3.4.m4.2.2.3.2">𝜇</ci><ci id="S3.SS3.p3.4.m4.2.2.3.3.cmml" xref="S3.SS3.p3.4.m4.2.2.3.3">𝜃</ci></apply><interval closure="open" id="S3.SS3.p3.4.m4.2.2.1.2.cmml" xref="S3.SS3.p3.4.m4.2.2.1.1"><apply id="S3.SS3.p3.4.m4.2.2.1.1.1.cmml" xref="S3.SS3.p3.4.m4.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.4.m4.2.2.1.1.1.1.cmml" xref="S3.SS3.p3.4.m4.2.2.1.1.1">subscript</csymbol><ci id="S3.SS3.p3.4.m4.2.2.1.1.1.2.cmml" xref="S3.SS3.p3.4.m4.2.2.1.1.1.2">𝑋</ci><ci id="S3.SS3.p3.4.m4.2.2.1.1.1.3.cmml" xref="S3.SS3.p3.4.m4.2.2.1.1.1.3">𝑇</ci></apply><ci id="S3.SS3.p3.4.m4.1.1.cmml" xref="S3.SS3.p3.4.m4.1.1">𝑇</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.4.m4.2c">\mu_{\theta}(X_{T},T)</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.4.m4.2d">italic_μ start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_X start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT , italic_T )</annotation></semantics></math> and the target image <math alttext="\hat{\mathbf{X}}" class="ltx_Math" display="inline" id="S3.SS3.p3.5.m5.1"><semantics id="S3.SS3.p3.5.m5.1a"><mover accent="true" id="S3.SS3.p3.5.m5.1.1" xref="S3.SS3.p3.5.m5.1.1.cmml"><mi id="S3.SS3.p3.5.m5.1.1.2" xref="S3.SS3.p3.5.m5.1.1.2.cmml">𝐗</mi><mo id="S3.SS3.p3.5.m5.1.1.1" xref="S3.SS3.p3.5.m5.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.5.m5.1b"><apply id="S3.SS3.p3.5.m5.1.1.cmml" xref="S3.SS3.p3.5.m5.1.1"><ci id="S3.SS3.p3.5.m5.1.1.1.cmml" xref="S3.SS3.p3.5.m5.1.1.1">^</ci><ci id="S3.SS3.p3.5.m5.1.1.2.cmml" xref="S3.SS3.p3.5.m5.1.1.2">𝐗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.5.m5.1c">\hat{\mathbf{X}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.5.m5.1d">over^ start_ARG bold_X end_ARG</annotation></semantics></math>:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\tilde{\mathbf{X}}_{T}=\arg\min_{\mathbf{X}_{T}}\left\|\mu_{\theta}(\mathbf{X}%
_{T},T)-\hat{\mathbf{X}}\right\|_{2}^{2}," class="ltx_Math" display="block" id="S3.E4.m1.2"><semantics id="S3.E4.m1.2a"><mrow id="S3.E4.m1.2.2.1" xref="S3.E4.m1.2.2.1.1.cmml"><mrow id="S3.E4.m1.2.2.1.1" xref="S3.E4.m1.2.2.1.1.cmml"><msub id="S3.E4.m1.2.2.1.1.3" xref="S3.E4.m1.2.2.1.1.3.cmml"><mover accent="true" id="S3.E4.m1.2.2.1.1.3.2" xref="S3.E4.m1.2.2.1.1.3.2.cmml"><mi id="S3.E4.m1.2.2.1.1.3.2.2" xref="S3.E4.m1.2.2.1.1.3.2.2.cmml">𝐗</mi><mo id="S3.E4.m1.2.2.1.1.3.2.1" xref="S3.E4.m1.2.2.1.1.3.2.1.cmml">~</mo></mover><mi id="S3.E4.m1.2.2.1.1.3.3" xref="S3.E4.m1.2.2.1.1.3.3.cmml">T</mi></msub><mo id="S3.E4.m1.2.2.1.1.2" xref="S3.E4.m1.2.2.1.1.2.cmml">=</mo><mrow id="S3.E4.m1.2.2.1.1.1" xref="S3.E4.m1.2.2.1.1.1.cmml"><mi id="S3.E4.m1.2.2.1.1.1.2" xref="S3.E4.m1.2.2.1.1.1.2.cmml">arg</mi><mo id="S3.E4.m1.2.2.1.1.1a" lspace="0.167em" xref="S3.E4.m1.2.2.1.1.1.cmml">⁡</mo><mrow id="S3.E4.m1.2.2.1.1.1.1" xref="S3.E4.m1.2.2.1.1.1.1.cmml"><munder id="S3.E4.m1.2.2.1.1.1.1.2" xref="S3.E4.m1.2.2.1.1.1.1.2.cmml"><mi id="S3.E4.m1.2.2.1.1.1.1.2.2" xref="S3.E4.m1.2.2.1.1.1.1.2.2.cmml">min</mi><msub id="S3.E4.m1.2.2.1.1.1.1.2.3" xref="S3.E4.m1.2.2.1.1.1.1.2.3.cmml"><mi id="S3.E4.m1.2.2.1.1.1.1.2.3.2" xref="S3.E4.m1.2.2.1.1.1.1.2.3.2.cmml">𝐗</mi><mi id="S3.E4.m1.2.2.1.1.1.1.2.3.3" xref="S3.E4.m1.2.2.1.1.1.1.2.3.3.cmml">T</mi></msub></munder><mo id="S3.E4.m1.2.2.1.1.1.1a" xref="S3.E4.m1.2.2.1.1.1.1.cmml">⁡</mo><msubsup id="S3.E4.m1.2.2.1.1.1.1.1" xref="S3.E4.m1.2.2.1.1.1.1.1.cmml"><mrow id="S3.E4.m1.2.2.1.1.1.1.1.1.1.1" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.2.cmml"><mo id="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.2" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.2.1.cmml">‖</mo><mrow id="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.1" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.1.cmml"><mrow id="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.2.cmml">μ</mi><mi id="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.3.cmml">θ</mi></msub><mo id="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mo id="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.cmml">(</mo><msub id="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">𝐗</mi><mi id="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">T</mi></msub><mo id="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.cmml">,</mo><mi id="S3.E4.m1.1.1" xref="S3.E4.m1.1.1.cmml">T</mi><mo id="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.4" stretchy="false" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.1.2" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml">−</mo><mover accent="true" id="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.1.3" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.1.3.2.cmml">𝐗</mi><mo id="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.1.3.1" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.1.3.1.cmml">^</mo></mover></mrow><mo id="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.3" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S3.E4.m1.2.2.1.1.1.1.1.1.3" xref="S3.E4.m1.2.2.1.1.1.1.1.1.3.cmml">2</mn><mn id="S3.E4.m1.2.2.1.1.1.1.1.3" xref="S3.E4.m1.2.2.1.1.1.1.1.3.cmml">2</mn></msubsup></mrow></mrow></mrow><mo id="S3.E4.m1.2.2.1.2" xref="S3.E4.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.2b"><apply id="S3.E4.m1.2.2.1.1.cmml" xref="S3.E4.m1.2.2.1"><eq id="S3.E4.m1.2.2.1.1.2.cmml" xref="S3.E4.m1.2.2.1.1.2"></eq><apply id="S3.E4.m1.2.2.1.1.3.cmml" xref="S3.E4.m1.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.1.1.3.1.cmml" xref="S3.E4.m1.2.2.1.1.3">subscript</csymbol><apply id="S3.E4.m1.2.2.1.1.3.2.cmml" xref="S3.E4.m1.2.2.1.1.3.2"><ci id="S3.E4.m1.2.2.1.1.3.2.1.cmml" xref="S3.E4.m1.2.2.1.1.3.2.1">~</ci><ci id="S3.E4.m1.2.2.1.1.3.2.2.cmml" xref="S3.E4.m1.2.2.1.1.3.2.2">𝐗</ci></apply><ci id="S3.E4.m1.2.2.1.1.3.3.cmml" xref="S3.E4.m1.2.2.1.1.3.3">𝑇</ci></apply><apply id="S3.E4.m1.2.2.1.1.1.cmml" xref="S3.E4.m1.2.2.1.1.1"><arg id="S3.E4.m1.2.2.1.1.1.2.cmml" xref="S3.E4.m1.2.2.1.1.1.2"></arg><apply id="S3.E4.m1.2.2.1.1.1.1.cmml" xref="S3.E4.m1.2.2.1.1.1.1"><apply id="S3.E4.m1.2.2.1.1.1.1.2.cmml" xref="S3.E4.m1.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.1.1.1.1.2.1.cmml" xref="S3.E4.m1.2.2.1.1.1.1.2">subscript</csymbol><min id="S3.E4.m1.2.2.1.1.1.1.2.2.cmml" xref="S3.E4.m1.2.2.1.1.1.1.2.2"></min><apply id="S3.E4.m1.2.2.1.1.1.1.2.3.cmml" xref="S3.E4.m1.2.2.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.1.1.1.1.2.3.1.cmml" xref="S3.E4.m1.2.2.1.1.1.1.2.3">subscript</csymbol><ci id="S3.E4.m1.2.2.1.1.1.1.2.3.2.cmml" xref="S3.E4.m1.2.2.1.1.1.1.2.3.2">𝐗</ci><ci id="S3.E4.m1.2.2.1.1.1.1.2.3.3.cmml" xref="S3.E4.m1.2.2.1.1.1.1.2.3.3">𝑇</ci></apply></apply><apply id="S3.E4.m1.2.2.1.1.1.1.1.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.1.1.1.1.1.2.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1">superscript</csymbol><apply id="S3.E4.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1">subscript</csymbol><apply id="S3.E4.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E4.m1.2.2.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.2">norm</csymbol><apply id="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.1"><minus id="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.1.2"></minus><apply id="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1"><times id="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.2"></times><apply id="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.2">𝜇</ci><ci id="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.3">𝜃</ci></apply><interval closure="open" id="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1"><apply id="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.2">𝐗</ci><ci id="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑇</ci></apply><ci id="S3.E4.m1.1.1.cmml" xref="S3.E4.m1.1.1">𝑇</ci></interval></apply><apply id="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.1.3"><ci id="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.1.3.1">^</ci><ci id="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.1.3.2">𝐗</ci></apply></apply></apply><cn id="S3.E4.m1.2.2.1.1.1.1.1.1.3.cmml" type="integer" xref="S3.E4.m1.2.2.1.1.1.1.1.1.3">2</cn></apply><cn id="S3.E4.m1.2.2.1.1.1.1.1.3.cmml" type="integer" xref="S3.E4.m1.2.2.1.1.1.1.1.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.2c">\tilde{\mathbf{X}}_{T}=\arg\min_{\mathbf{X}_{T}}\left\|\mu_{\theta}(\mathbf{X}%
_{T},T)-\hat{\mathbf{X}}\right\|_{2}^{2},</annotation><annotation encoding="application/x-llamapun" id="S3.E4.m1.2d">over~ start_ARG bold_X end_ARG start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT = roman_arg roman_min start_POSTSUBSCRIPT bold_X start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT end_POSTSUBSCRIPT ∥ italic_μ start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( bold_X start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT , italic_T ) - over^ start_ARG bold_X end_ARG ∥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.p3.8">where <math alttext="\mu_{\theta}(\mathbf{X}_{T},T)" class="ltx_Math" display="inline" id="S3.SS3.p3.6.m1.2"><semantics id="S3.SS3.p3.6.m1.2a"><mrow id="S3.SS3.p3.6.m1.2.2" xref="S3.SS3.p3.6.m1.2.2.cmml"><msub id="S3.SS3.p3.6.m1.2.2.3" xref="S3.SS3.p3.6.m1.2.2.3.cmml"><mi id="S3.SS3.p3.6.m1.2.2.3.2" xref="S3.SS3.p3.6.m1.2.2.3.2.cmml">μ</mi><mi id="S3.SS3.p3.6.m1.2.2.3.3" xref="S3.SS3.p3.6.m1.2.2.3.3.cmml">θ</mi></msub><mo id="S3.SS3.p3.6.m1.2.2.2" xref="S3.SS3.p3.6.m1.2.2.2.cmml">⁢</mo><mrow id="S3.SS3.p3.6.m1.2.2.1.1" xref="S3.SS3.p3.6.m1.2.2.1.2.cmml"><mo id="S3.SS3.p3.6.m1.2.2.1.1.2" stretchy="false" xref="S3.SS3.p3.6.m1.2.2.1.2.cmml">(</mo><msub id="S3.SS3.p3.6.m1.2.2.1.1.1" xref="S3.SS3.p3.6.m1.2.2.1.1.1.cmml"><mi id="S3.SS3.p3.6.m1.2.2.1.1.1.2" xref="S3.SS3.p3.6.m1.2.2.1.1.1.2.cmml">𝐗</mi><mi id="S3.SS3.p3.6.m1.2.2.1.1.1.3" xref="S3.SS3.p3.6.m1.2.2.1.1.1.3.cmml">T</mi></msub><mo id="S3.SS3.p3.6.m1.2.2.1.1.3" xref="S3.SS3.p3.6.m1.2.2.1.2.cmml">,</mo><mi id="S3.SS3.p3.6.m1.1.1" xref="S3.SS3.p3.6.m1.1.1.cmml">T</mi><mo id="S3.SS3.p3.6.m1.2.2.1.1.4" stretchy="false" xref="S3.SS3.p3.6.m1.2.2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.6.m1.2b"><apply id="S3.SS3.p3.6.m1.2.2.cmml" xref="S3.SS3.p3.6.m1.2.2"><times id="S3.SS3.p3.6.m1.2.2.2.cmml" xref="S3.SS3.p3.6.m1.2.2.2"></times><apply id="S3.SS3.p3.6.m1.2.2.3.cmml" xref="S3.SS3.p3.6.m1.2.2.3"><csymbol cd="ambiguous" id="S3.SS3.p3.6.m1.2.2.3.1.cmml" xref="S3.SS3.p3.6.m1.2.2.3">subscript</csymbol><ci id="S3.SS3.p3.6.m1.2.2.3.2.cmml" xref="S3.SS3.p3.6.m1.2.2.3.2">𝜇</ci><ci id="S3.SS3.p3.6.m1.2.2.3.3.cmml" xref="S3.SS3.p3.6.m1.2.2.3.3">𝜃</ci></apply><interval closure="open" id="S3.SS3.p3.6.m1.2.2.1.2.cmml" xref="S3.SS3.p3.6.m1.2.2.1.1"><apply id="S3.SS3.p3.6.m1.2.2.1.1.1.cmml" xref="S3.SS3.p3.6.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.6.m1.2.2.1.1.1.1.cmml" xref="S3.SS3.p3.6.m1.2.2.1.1.1">subscript</csymbol><ci id="S3.SS3.p3.6.m1.2.2.1.1.1.2.cmml" xref="S3.SS3.p3.6.m1.2.2.1.1.1.2">𝐗</ci><ci id="S3.SS3.p3.6.m1.2.2.1.1.1.3.cmml" xref="S3.SS3.p3.6.m1.2.2.1.1.1.3">𝑇</ci></apply><ci id="S3.SS3.p3.6.m1.1.1.cmml" xref="S3.SS3.p3.6.m1.1.1">𝑇</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.6.m1.2c">\mu_{\theta}(\mathbf{X}_{T},T)</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.6.m1.2d">italic_μ start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( bold_X start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT , italic_T )</annotation></semantics></math> denotes the final image produced from the initial noise vector <math alttext="\mathbf{X}_{T}" class="ltx_Math" display="inline" id="S3.SS3.p3.7.m2.1"><semantics id="S3.SS3.p3.7.m2.1a"><msub id="S3.SS3.p3.7.m2.1.1" xref="S3.SS3.p3.7.m2.1.1.cmml"><mi id="S3.SS3.p3.7.m2.1.1.2" xref="S3.SS3.p3.7.m2.1.1.2.cmml">𝐗</mi><mi id="S3.SS3.p3.7.m2.1.1.3" xref="S3.SS3.p3.7.m2.1.1.3.cmml">T</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.7.m2.1b"><apply id="S3.SS3.p3.7.m2.1.1.cmml" xref="S3.SS3.p3.7.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.7.m2.1.1.1.cmml" xref="S3.SS3.p3.7.m2.1.1">subscript</csymbol><ci id="S3.SS3.p3.7.m2.1.1.2.cmml" xref="S3.SS3.p3.7.m2.1.1.2">𝐗</ci><ci id="S3.SS3.p3.7.m2.1.1.3.cmml" xref="S3.SS3.p3.7.m2.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.7.m2.1c">\mathbf{X}_{T}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.7.m2.1d">bold_X start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT</annotation></semantics></math> after all diffusion steps.
By optimizing <math alttext="\mathbf{X}_{T}" class="ltx_Math" display="inline" id="S3.SS3.p3.8.m3.1"><semantics id="S3.SS3.p3.8.m3.1a"><msub id="S3.SS3.p3.8.m3.1.1" xref="S3.SS3.p3.8.m3.1.1.cmml"><mi id="S3.SS3.p3.8.m3.1.1.2" xref="S3.SS3.p3.8.m3.1.1.2.cmml">𝐗</mi><mi id="S3.SS3.p3.8.m3.1.1.3" xref="S3.SS3.p3.8.m3.1.1.3.cmml">T</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.8.m3.1b"><apply id="S3.SS3.p3.8.m3.1.1.cmml" xref="S3.SS3.p3.8.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.8.m3.1.1.1.cmml" xref="S3.SS3.p3.8.m3.1.1">subscript</csymbol><ci id="S3.SS3.p3.8.m3.1.1.2.cmml" xref="S3.SS3.p3.8.m3.1.1.2">𝐗</ci><ci id="S3.SS3.p3.8.m3.1.1.3.cmml" xref="S3.SS3.p3.8.m3.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.8.m3.1c">\mathbf{X}_{T}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.8.m3.1d">bold_X start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT</annotation></semantics></math> based on the loss term, we guide the model to generate images that have the same shape and perceptual features as the target image.</p>
</div>
<figure class="ltx_figure" id="S3.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="347" id="S3.F2.1.g1" src="x1.png" width="761"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>Photorealistic images reconstructed by the proposed semantic reconstruction method MDE. This diffusion-based method iteratively refines its generated image by referring to the raw reconstruction. As iterations progress, the image increasingly assumes the shape and perceptual features of the raw reconstruction. After some optimal epoch number (determined by visual inspection of the attacker), the reconstructed image strongly resembles the target at a high quality. Beyond this point, further optimization may produce blurry images due to overfitting.</figcaption>
</figure>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Experimental Results</h2>
<div class="ltx_para ltx_noindent" id="S4.p1">
<p class="ltx_p" id="S4.p1.1">This section first presents the performance of the proposed reconstruction attack in terms of image reconstruction quality against gradients averaged from multiple clients.
Factors affecting reconstruction quality, including the number of local epochs and client batch size, will be analyzed.
The postprocessing modules will be ablated to examine their benefits on image reconstruction.
The state of the art will be compared and the limitation of the proposed attack will be discussed.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.p2">
<p class="ltx_p" id="S4.p2.1"><span class="ltx_text ltx_font_bold" id="S4.p2.1.1">Experimental Conditions.</span> We evaluate our reconstruction attacks using the ImageNet <cite class="ltx_cite ltx_citemacro_citep">(Deng et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04661v1#bib.bib2" title="">2009</a>)</cite> and MNIST <cite class="ltx_cite ltx_citemacro_citep">(LeCun et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04661v1#bib.bib12" title="">1998</a>)</cite> datasets. We employ LeNet <cite class="ltx_cite ltx_citemacro_citep">(LeCun et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04661v1#bib.bib12" title="">1998</a>)</cite> and ResNet <cite class="ltx_cite ltx_citemacro_citep">(He et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04661v1#bib.bib7" title="">2016</a>)</cite> as the global models and conduct experiments under the FedAvg framework. Each client performs local training on 16 images as this batch size provides a baseline where the attack reconstructs recognizable images from the target gradient.
As more clients participate in training, the training image count from the global model’s perspective increases proportionally.
Before inverting the target gradient, the attacker encodes its dummy data through bicubic sampling to reduce the number of unknown parameters. This has been proven to save convergence time and improve image quality in gradient inversion <cite class="ltx_cite ltx_citemacro_citep">(Yue et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04661v1#bib.bib23" title="">2023</a>)</cite>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.p3">
<p class="ltx_p" id="S4.p3.1"><span class="ltx_text ltx_font_bold" id="S4.p3.1.1">Main Results.</span> Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.04661v1#S3.F2" title="Figure 2 ‣ 3.3 Masked Diffusion Enhancer: reconstruction at a semantic level ‣ 3 Proposed Image Reconstruction Attack by Curious Clients ‣ Federated Learning Nodes Can Reconstruct Peers’ Image Data"><span class="ltx_text ltx_ref_tag">2</span></a> demonstrates that MDE effectively transforms low-resolution, color-aliased raw reconstructions into sharp, high-resolution images. The model was provided with randomly selected reconstructions from an attack on a system with four clients and iteratively refined the outputs over 100 epochs. In the first epoch, the output is a random image from the target class. As optimization progresses, the generated images increasingly resemble the target. We observe that at an optimal epoch number, the output images closely match the target, preserving its geometric structure and perceptual features with photorealistic quality. This optimal point varies across target images and was determined qualitatively. Beyond this point, although the generated images continue to match the target semantically, their quality degrades, becoming blurrier. We attribute this to the model overfitting that learns the pixelation and blurriness of the target to minimize the MSE loss.</p>
</div>
<figure class="ltx_figure ltx_align_floatright" id="S4.F4"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="600" id="S4.F4.g1" src="x2.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>LPIPS of reconstructed images vs. number of clients with three different models: LeNet5, ResNet9, and ResNet18.</figcaption>
</figure>
<figure class="ltx_figure" id="S4.F3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="305" id="S4.F3.1.g1" src="x3.png" width="761"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>Pixel-level correct images reconstructed by the proposed attack before and after direct postprocessing (Section 3.2).
The second and third rows show postprocessed and raw reconstructed images. The raw reconstruction results from our attack are low-resolution and have significant color aliasing. Our direct postprocessing method increases the resolution and simultaneously denoises the images while maintaining pixel-level correctness, revealing image details that make the reconstructions easier to recognize.</figcaption>
</figure>
<div class="ltx_para" id="S4.p4">
<p class="ltx_p" id="S4.p4.2">Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.04661v1#S4.F3" title="Figure 3 ‣ 4 Experimental Results ‣ Federated Learning Nodes Can Reconstruct Peers’ Image Data"><span class="ltx_text ltx_ref_tag">3</span></a> illustrates the impact of the proposed DDPM-based direct image postprocessing in enhancing the quality of the raw reconstructions while preserving pixel-wise accuracy. The raw reconstructed images, constrained by the dummy data’s encoding, are 32<math alttext="\times" class="ltx_Math" display="inline" id="S4.p4.1.m1.1"><semantics id="S4.p4.1.m1.1a"><mo id="S4.p4.1.m1.1.1" xref="S4.p4.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.p4.1.m1.1b"><times id="S4.p4.1.m1.1.1.cmml" xref="S4.p4.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.1.m1.1c">\times</annotation><annotation encoding="application/x-llamapun" id="S4.p4.1.m1.1d">×</annotation></semantics></math>32 pixels compared to the 128<math alttext="\times" class="ltx_Math" display="inline" id="S4.p4.2.m2.1"><semantics id="S4.p4.2.m2.1a"><mo id="S4.p4.2.m2.1.1" xref="S4.p4.2.m2.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.p4.2.m2.1b"><times id="S4.p4.2.m2.1.1.cmml" xref="S4.p4.2.m2.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.2.m2.1c">\times</annotation><annotation encoding="application/x-llamapun" id="S4.p4.2.m2.1d">×</annotation></semantics></math>128 ground-truth images and exhibit pixel artifacts and color aliasing due to imperfect reconstruction. Our direct postprocessing method simultaneously performs super-resolution and denoising, addressing these quality issues. The resulting images are sharper, more recognizable, and retain details that closely match the ground truth, significantly improving resolution and object recognizability over the raw reconstructions.</p>
</div>
<figure class="ltx_figure" id="S4.F5"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="400" id="S4.F5.1.g1" src="x4.png" width="761"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>Pixel-level correct images reconstructed from the proposed honest-but-curious client-based attack. Rows 2–4 show reconstructions from gradients averaged across 2, 4, and 8 clients with 16 images per client and 3 local epochs. The images remain high quality even when the attack is performed against multiple clients.</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="S4.p5">
<p class="ltx_p" id="S4.p5.1">Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.04661v1#S4.F5" title="Figure 5 ‣ 4 Experimental Results ‣ Federated Learning Nodes Can Reconstruct Peers’ Image Data"><span class="ltx_text ltx_ref_tag">5</span></a> shows reconstructed images from attacks against systems with 2, 4, and 8 clients. As the number of clients increases, the reconstruction task becomes more difficult but we observe that our attack is still able to effectively reconstruct images from the target gradient. However, we observe a gradual decline in image reconstruction quality, measured by LPIPS <cite class="ltx_cite ltx_citemacro_citep">(Zhang et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04661v1#bib.bib24" title="">2018</a>)</cite> and SSIM <cite class="ltx_cite ltx_citemacro_citep">(Wang et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04661v1#bib.bib19" title="">2004</a>)</cite> of the reconstructed images, as shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.04661v1#S4.F4" title="Figure 4 ‣ 4 Experimental Results ‣ Federated Learning Nodes Can Reconstruct Peers’ Image Data"><span class="ltx_text ltx_ref_tag">4</span></a>.
With a larger number of clients, the initial reconstructions exhibit increasing levels of noise and color aliasing. This trend is consistent across a range of global models because the information contained within the target gradient becomes increasingly diluted as it is averaged from more clients.</p>
</div>
<figure class="ltx_figure ltx_align_floatright" id="S4.F6"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="384" id="S4.F6.g1" src="x5.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6: </span>LPIPS of reconstructed images vs. number of clients, client batch size, and local epochs. Reconstruction quality worsens with more clients and larger batch sizes.</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="S4.p6">
<p class="ltx_p" id="S4.p6.1"><span class="ltx_text ltx_font_bold" id="S4.p6.1.1">Factor Analysis.</span> Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.04661v1#S4.F6" title="Figure 6 ‣ 4 Experimental Results ‣ Federated Learning Nodes Can Reconstruct Peers’ Image Data"><span class="ltx_text ltx_ref_tag">6</span></a> reveals the effect of local epochs and client batch size on image reconstruction quality. These factors directly influence the attack’s ability to invert the target gradient.
As shown in the left plot of Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.04661v1#S4.F6" title="Figure 6 ‣ 4 Experimental Results ‣ Federated Learning Nodes Can Reconstruct Peers’ Image Data"><span class="ltx_text ltx_ref_tag">6</span></a>, larger client batch sizes lead to worse reconstruction quality. Smaller batches add variability to updates, making them more informative for the attacker, whereas larger batches smooth updates and reduce the amount of exploitable information. The right plot of Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.04661v1#S4.F6" title="Figure 6 ‣ 4 Experimental Results ‣ Federated Learning Nodes Can Reconstruct Peers’ Image Data"><span class="ltx_text ltx_ref_tag">6</span></a> shows that increasing the number of local epochs leads to worse reconstructions when the number of clients is large. More local epochs cause greater gradient averaging, which dilutes the information needed to accurately reconstruct images from the target gradient. This is particularly important because federated learning often uses more local epochs to reduce communication.</p>
</div>
<figure class="ltx_figure ltx_align_floatright" id="S4.F7"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="531" id="S4.F7.g1" src="x6.png" width="829"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 7: </span>LPIPS of reconstructed images with varying number of clients. Our direct postprocessing technique significantly improves reconstruction quality compared to the raw attack results.</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="S4.p7">
<p class="ltx_p" id="S4.p7.1"><span class="ltx_text ltx_font_bold" id="S4.p7.1.1">Ablation Study.</span> We examine how much impact the direct and semantic postprocessing blocks have on the quality of the attacker’s reconstructed images.
Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.04661v1#S4.F7" title="Figure 7 ‣ 4 Experimental Results ‣ Federated Learning Nodes Can Reconstruct Peers’ Image Data"><span class="ltx_text ltx_ref_tag">7</span></a> shows that directly postprocessing the raw reconstructed images results in a 20–30% improvement in LPIPS for systems with 2–8 clients. Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.04661v1#S4.F3" title="Figure 3 ‣ 4 Experimental Results ‣ Federated Learning Nodes Can Reconstruct Peers’ Image Data"><span class="ltx_text ltx_ref_tag">3</span></a> visually compares reconstructed images from a system with four clients before and after direct postprocessing. The raw images are low resolution and may be somewhat difficult to recognize while the postprocessed versions show much finer details and have recognizable features. This demonstrates the utility of our direct postprocessing technique in increasing the pixel-wise accuracy and recognizability of the reconstructed images.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.p8">
<p class="ltx_p" id="S4.p8.1">Additionally, Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.04661v1#S3.F2" title="Figure 2 ‣ 3.3 Masked Diffusion Enhancer: reconstruction at a semantic level ‣ 3 Proposed Image Reconstruction Attack by Curious Clients ‣ Federated Learning Nodes Can Reconstruct Peers’ Image Data"><span class="ltx_text ltx_ref_tag">2</span></a> shows the effect of postprocessing the raw reconstructed images using the proposed MDE. The final results have the same shape and perceptual features of the raw reconstructions without any pixel artifacts, color aliasing, or blurriness. However, MDE’s goal is not to achieve pixel-wise accuracy so the generated images should not be compared quantitatively to the raw reconstructions.</p>
</div>
<figure class="ltx_figure" id="S4.F8"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="214" id="S4.F8.1.g1" src="x7.png" width="761"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 8: </span>Pixel-level-correct reconstructed images from a system with 16 clients. With more clients, our reconstruction technique can reconstruct only a subset of training images with high quality, whereas others show distortion and color aliasing artifacts.</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="S4.p9">
<p class="ltx_p" id="S4.p9.1"><span class="ltx_text ltx_font_bold" id="S4.p9.1.1">Limitations.</span> Our attack struggles to reconstruct high-quality images in systems where the number of clients is large. As the information contained within the attacker’s target gradient is averaged from more clients, it becomes more difficult to reconstruct high-quality images. With more than 8 clients, we observe that some reconstructed images remain high quality while others exhibit significant degradation or are not recognizable. Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.04661v1#S4.F8" title="Figure 8 ‣ 4 Experimental Results ‣ Federated Learning Nodes Can Reconstruct Peers’ Image Data"><span class="ltx_text ltx_ref_tag">8</span></a> shows the varying quality in our reconstructed images in a system of 16 clients.</p>
</div>
<figure class="ltx_figure ltx_align_floatright" id="S4.F9"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="512" id="S4.F9.g1" src="x8.png" width="829"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 9: </span>Quality of the raw reconstructed images when the attacker incorrectly guesses the global model’s learning rate (LR). Image quality improves as the attacker guesses more correctly.</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="S4.p10">
<p class="ltx_p" id="S4.p10.2"><span class="ltx_text ltx_font_bold" id="S4.p10.2.1">Unknown Learning Rate.</span>
We assume in our experiments that the attacker knows the global learning rate <math alttext="\eta_{\text{g}}" class="ltx_Math" display="inline" id="S4.p10.1.m1.1"><semantics id="S4.p10.1.m1.1a"><msub id="S4.p10.1.m1.1.1" xref="S4.p10.1.m1.1.1.cmml"><mi id="S4.p10.1.m1.1.1.2" xref="S4.p10.1.m1.1.1.2.cmml">η</mi><mtext id="S4.p10.1.m1.1.1.3" xref="S4.p10.1.m1.1.1.3a.cmml">g</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.p10.1.m1.1b"><apply id="S4.p10.1.m1.1.1.cmml" xref="S4.p10.1.m1.1.1"><csymbol cd="ambiguous" id="S4.p10.1.m1.1.1.1.cmml" xref="S4.p10.1.m1.1.1">subscript</csymbol><ci id="S4.p10.1.m1.1.1.2.cmml" xref="S4.p10.1.m1.1.1.2">𝜂</ci><ci id="S4.p10.1.m1.1.1.3a.cmml" xref="S4.p10.1.m1.1.1.3"><mtext id="S4.p10.1.m1.1.1.3.cmml" mathsize="70%" xref="S4.p10.1.m1.1.1.3">g</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p10.1.m1.1c">\eta_{\text{g}}</annotation><annotation encoding="application/x-llamapun" id="S4.p10.1.m1.1d">italic_η start_POSTSUBSCRIPT g end_POSTSUBSCRIPT</annotation></semantics></math>. This assumption simplifies the attack but need not be true for the attack to be effective. If the learning rate is applied globally (by the central server) and the attacker’s guess differs from the true value, the target gradient will be inversely scaled by a factor of the ratio between the guessed learning rate and the true learning rate,
leading to poor reconstruction quality. For simplicity, we set the base <math alttext="\eta_{\text{g}}=1" class="ltx_Math" display="inline" id="S4.p10.2.m2.1"><semantics id="S4.p10.2.m2.1a"><mrow id="S4.p10.2.m2.1.1" xref="S4.p10.2.m2.1.1.cmml"><msub id="S4.p10.2.m2.1.1.2" xref="S4.p10.2.m2.1.1.2.cmml"><mi id="S4.p10.2.m2.1.1.2.2" xref="S4.p10.2.m2.1.1.2.2.cmml">η</mi><mtext id="S4.p10.2.m2.1.1.2.3" xref="S4.p10.2.m2.1.1.2.3a.cmml">g</mtext></msub><mo id="S4.p10.2.m2.1.1.1" xref="S4.p10.2.m2.1.1.1.cmml">=</mo><mn id="S4.p10.2.m2.1.1.3" xref="S4.p10.2.m2.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.p10.2.m2.1b"><apply id="S4.p10.2.m2.1.1.cmml" xref="S4.p10.2.m2.1.1"><eq id="S4.p10.2.m2.1.1.1.cmml" xref="S4.p10.2.m2.1.1.1"></eq><apply id="S4.p10.2.m2.1.1.2.cmml" xref="S4.p10.2.m2.1.1.2"><csymbol cd="ambiguous" id="S4.p10.2.m2.1.1.2.1.cmml" xref="S4.p10.2.m2.1.1.2">subscript</csymbol><ci id="S4.p10.2.m2.1.1.2.2.cmml" xref="S4.p10.2.m2.1.1.2.2">𝜂</ci><ci id="S4.p10.2.m2.1.1.2.3a.cmml" xref="S4.p10.2.m2.1.1.2.3"><mtext id="S4.p10.2.m2.1.1.2.3.cmml" mathsize="70%" xref="S4.p10.2.m2.1.1.2.3">g</mtext></ci></apply><cn id="S4.p10.2.m2.1.1.3.cmml" type="integer" xref="S4.p10.2.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p10.2.m2.1c">\eta_{\text{g}}=1</annotation><annotation encoding="application/x-llamapun" id="S4.p10.2.m2.1d">italic_η start_POSTSUBSCRIPT g end_POSTSUBSCRIPT = 1</annotation></semantics></math> and examine the impact on reconstruction when it is unknown to the attacker. Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.04661v1#S4.F9" title="Figure 9 ‣ 4 Experimental Results ‣ Federated Learning Nodes Can Reconstruct Peers’ Image Data"><span class="ltx_text ltx_ref_tag">9</span></a> shows that reconstruction quality degrades rapidly as the guessed and true learning rates diverge. However, within an order of magnitude of the true learning rate, the degradation follows a simple polynomial pattern. An attacker with sufficient computational resources can refine their guess over multiple iterations to improve reconstruction quality if the true learning rate is not known.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.p11">
<p class="ltx_p" id="S4.p11.1"><span class="ltx_text ltx_font_bold" id="S4.p11.1.1">Comparison to ROG and FedInverse.</span> We compare our attack method to FedInverse <cite class="ltx_cite ltx_citemacro_citep">(Wu et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04661v1#bib.bib21" title="">2024</a>)</cite> and reconstruction from obfuscated gradients (ROG) <cite class="ltx_cite ltx_citemacro_citep">(Yue et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04661v1#bib.bib23" title="">2023</a>)</cite>. To the best of our knowledge, FedInverse is the only prior work addressing honest-but-curious client attacks. Unlike our approach, which reconstructs data from gradients, FedInverse inverts the global model. Their method performs best when the model is complex and trained over many epochs, whereas our attack works best with larger gradients, typically when the model is simpler and less trained. Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.04661v1#S5.F12" title="Figure 12 ‣ 5 Conclusions and Future Work ‣ Federated Learning Nodes Can Reconstruct Peers’ Image Data"><span class="ltx_text ltx_ref_tag">12</span></a> reveals that our method reconstructs higher-quality data from a small number of clients, whereas FedInverse produced lower-quality reconstructions from a larger number of clients. FedInverse is less sensitive to the number of clients, while our approach is more sensitive. Our proposed attack can be viewed as complementary to FedInverse.</p>
</div>
<figure class="ltx_figure ltx_align_floatright" id="S4.F10"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="403" id="S4.F10.g1" src="x9.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 10: </span>LPIPS and SSIM of reconstructed images using our direct postprocessor vs. GAN postprocessing with varying number of clients. Our method results in higher LPIPS as it blurs uncertain image details, compared to sharper but potentially less accurate outputs from GANs. SSIM, less sensitive to blurring, remains comparable across both approaches.</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="S4.p12">
<p class="ltx_p" id="S4.p12.1">We compare reconstruction quality from our direct and semantic postprocessing techniques to the state-of-the-art postprocessing results achieved by <cite class="ltx_cite ltx_citemacro_citet">Yue et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.04661v1#bib.bib23" title="">2023</a>)</cite>. Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.04661v1#S5.F11" title="Figure 11 ‣ 5 Conclusions and Future Work ‣ Federated Learning Nodes Can Reconstruct Peers’ Image Data"><span class="ltx_text ltx_ref_tag">11</span></a> shows that our technique generates images that are more recognizable but often blurry because of uncertainty in the fine image details. LPIPS is designed to evaluate image quality, rather than detail accuracy, and penalizes blurriness and pixelation much more than hallucination. The left plot of Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.04661v1#S4.F10" title="Figure 10 ‣ 4 Experimental Results ‣ Federated Learning Nodes Can Reconstruct Peers’ Image Data"><span class="ltx_text ltx_ref_tag">10</span></a> shows that this results in the reconstructed images from our direct postprocessing technique having worse LPIPS than the state-of-the-art postprocessing technique. In contrast, the right plot of Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.04661v1#S4.F10" title="Figure 10 ‣ 4 Experimental Results ‣ Federated Learning Nodes Can Reconstruct Peers’ Image Data"><span class="ltx_text ltx_ref_tag">10</span></a> shows that our results achieve comparable SSIM, a metric that does not penalize blurriness as much as LPIPS.</p>
</div>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Conclusions and Future Work</h2>
<div class="ltx_para ltx_noindent" id="S5.p1">
<p class="ltx_p" id="S5.p1.1">We have demonstrated that a curious client attacker can successfully reconstruct high-quality images from a small number of clients simply by participating in two consecutive training rounds. This type of attack does not alter the training process or introduce corrupted data, making it difficult to detect by the server or other clients in the system. Our findings indicate that the attack is particularly effective when the number of participating clients is small or the available training examples are limited. This raises a significant concern for cross-silo FL, where participants collaborate specifically to overcome data scarcity <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04661v1#bib.bib13" title="">2020a</a>)</cite>. In such settings, our findings reveal a serious privacy risk, as the reconstruction of sensitive data becomes more feasible. Further research is needed to assess the robustness of more advanced FL frameworks against curious client attacks and develop effective defenses to preserve data privacy in cross-silo FL. Additionally, we assume that the attacker knows the number of participating clients and that each client performs local training on the same number of images. This simplifies the attack framework but does not need to be true. Evaluation with variable client batch sizes and where the attacker does not know the number of participating clients is a promising direction for future research.</p>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
<figure class="ltx_figure" id="S5.F11"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="304" id="S5.F11.1.g1" src="x10.png" width="761"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 11: </span>Pixel-level-correct reconstructed images using (row 2) our direct postprocessor and (row 3) ROG GAN <cite class="ltx_cite ltx_citemacro_citep">(Yue et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04661v1#bib.bib23" title="">2023</a>)</cite>. Our direct postprocessing method produces reconstructions that are more recognizable and have more accurate image details compared to the ROG GAN. However, our method also results in worse LPIPS and SSIM due to blurring.</figcaption>
</figure>
<figure class="ltx_figure" id="S5.F12"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="527" id="S5.F12.1.g1" src="x11.png" width="761"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 12: </span>(a) Evaluation on MNIST of the attack with MDE postprocessing compared to (b) the model inversion (MI) and model inversion with Hilbert–Schmidt independence criterion (MI-HSIC) approaches [reproduced from <cite class="ltx_cite ltx_citemacro_citet">Wu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.04661v1#bib.bib21" title="">2024</a>)</cite>]. Only 5 examples were provided for each method in <cite class="ltx_cite ltx_citemacro_citet">Wu et al. <a class="ltx_ref" href="https://arxiv.org/html/2410.04661v1#bib.bib21" title="">2024</a></cite>. Our reconstructed images are qualitatively more similar to the ground truth.</figcaption>
</figure>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Blanchard et al. (2017)</span>
<span class="ltx_bibblock">
Peva Blanchard, El Mahdi El Mhamdi, Rachid Guerraoui, and Julien Stainer.

</span>
<span class="ltx_bibblock">Machine learning with adversaries: Byzantine tolerant gradient descent.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib1.1.1">Advances in Neural Information Processing Systems</em>, 30, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Deng et al. (2009)</span>
<span class="ltx_bibblock">
Jia Deng, Wei Dong, Richard Socher, Li-Jia Li, Kai Li, and Li Fei-Fei.

</span>
<span class="ltx_bibblock">ImageNet: A large-scale hierarchical image database.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib2.1.1">IEEE Conference on Computer Vision and Pattern Recognition</em>, pp.  248–255, 2009.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dhariwal &amp; Nichol (2021)</span>
<span class="ltx_bibblock">
Prafulla Dhariwal and Alexander Nichol.

</span>
<span class="ltx_bibblock">Diffusion models beat GANs on image synthesis.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib3.1.1">Advances in Neural Information Processing Systems</em>, 34:8780–8794, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Fowl et al. (2021)</span>
<span class="ltx_bibblock">
Liam Fowl, Jonas Geiping, Wojtek Czaja, Micah Goldblum, and Tom Goldstein.

</span>
<span class="ltx_bibblock">Robbing the Fed: Directly obtaining private data in federated learning with modified models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib4.1.1">arXiv preprint arXiv:2110.13057</em>, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gao et al. (2023)</span>
<span class="ltx_bibblock">
Shanghua Gao, Pan Zhou, Ming-Ming Cheng, and Shuicheng Yan.

</span>
<span class="ltx_bibblock">Masked diffusion transformer is a strong image synthesizer.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib5.1.1">IEEE/CVF International Conference on Computer Vision</em>, pp.  23164–23173, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Geiping et al. (2020)</span>
<span class="ltx_bibblock">
Jonas Geiping, Hartmut Bauermeister, Hannah Dröge, and Michael Moeller.

</span>
<span class="ltx_bibblock">Inverting gradients-how easy is it to break privacy in federated learning?

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib6.1.1">Advances in Neural Information Processing Systems</em>, 33:16937–16947, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">He et al. (2016)</span>
<span class="ltx_bibblock">
Kaiming He, Xiangyu Zhang, Shaoqing Ren, and Jian Sun.

</span>
<span class="ltx_bibblock">Deep residual learning for image recognition.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib7.1.1">IEEE Conference on Computer Vision and Pattern Recognition</em>, pp.  770–778, 2016.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ho et al. (2020)</span>
<span class="ltx_bibblock">
Jonathan Ho, Ajay Jain, and Pieter Abbeel.

</span>
<span class="ltx_bibblock">Denoising diffusion probabilistic models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib8.1.1">Advances in Neural Information Processing Systems</em>, 33:6840–6851, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Huang et al. (2020)</span>
<span class="ltx_bibblock">
Li Huang, Yifeng Yin, Zeng Fu, Shifa Zhang, Hao Deng, and Dianbo Liu.

</span>
<span class="ltx_bibblock">Loadaboost: Loss-based adaboost federated machine learning with reduced computational complexity on iid and non-iid intensive care data.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib9.1.1">Plos One</em>, 15(4):e0230706, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kairouz et al. (2021)</span>
<span class="ltx_bibblock">
Peter Kairouz, H Brendan McMahan, Brendan Avent, Aurélien Bellet, Mehdi Bennis, Arjun Nitin Bhagoji, Kallista Bonawitz, Zachary Charles, Graham Cormode, Rachel Cummings, et al.

</span>
<span class="ltx_bibblock">Advances and open problems in federated learning.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib10.1.1">Foundations and Trends® in Machine Learning</em>, 14(1–2):1–210, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kawar et al. (2022)</span>
<span class="ltx_bibblock">
Bahjat Kawar, Michael Elad, Stefano Ermon, and Jiaming Song.

</span>
<span class="ltx_bibblock">Denoising diffusion restoration models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib11.1.1">Advances in Neural Information Processing Systems</em>, 35:23593–23606, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">LeCun et al. (1998)</span>
<span class="ltx_bibblock">
Yann LeCun, Léon Bottou, Yoshua Bengio, and Patrick Haffner.

</span>
<span class="ltx_bibblock">Gradient-based learning applied to document recognition.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib12.1.1">IEEE</em>, 86(11):2278–2324, 1998.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2020a)</span>
<span class="ltx_bibblock">
Li Li, Yuxi Fan, Mike Tse, and Kuo-Yi Lin.

</span>
<span class="ltx_bibblock">A review of applications in federated learning.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib13.1.1">Computers &amp; Industrial Engineering</em>, 149:106854, 2020a.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2020b)</span>
<span class="ltx_bibblock">
Xiang Li, Kaixuan Huang, Wenhao Yang, Shusen Wang, and Zhihua Zhang.

</span>
<span class="ltx_bibblock">On the convergence of FedAvg on non-iid data.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib14.1.1">International Conference on Learning Representations</em>, 2020b.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">McMahan et al. (2017)</span>
<span class="ltx_bibblock">
Brendan McMahan, Eider Moore, Daniel Ramage, Seth Hampson, and Blaise Aguera y Arcas.

</span>
<span class="ltx_bibblock">Communication-efficient learning of deep networks from decentralized data.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib15.1.1">Artificial Intelligence and Statistics</em>, pp.  1273–1282. PMLR, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shejwalkar et al. (2022)</span>
<span class="ltx_bibblock">
Virat Shejwalkar, Amir Houmansadr, Peter Kairouz, and Daniel Ramage.

</span>
<span class="ltx_bibblock">Back to the drawing board: A critical evaluation of poisoning attacks on production federated learning.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib16.1.1">IEEE Symposium on Security and Privacy</em>, pp.  1354–1371, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shi et al. (2022)</span>
<span class="ltx_bibblock">
Junyu Shi, Wei Wan, Shengshan Hu, Jianrong Lu, and Leo Yu Zhang.

</span>
<span class="ltx_bibblock">Challenges and approaches for mitigating Byzantine attacks in federated learning.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib17.1.1">IEEE International Conference on Trust, Security and Privacy in Computing and Communications (TrustCom)</em>, pp.  139–146, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sun et al. (2021)</span>
<span class="ltx_bibblock">
Jingwei Sun, Ang Li, Binghui Wang, Huanrui Yang, Hai Li, and Yiran Chen.

</span>
<span class="ltx_bibblock">Soteria: Provable defense against privacy leakage in federated learning from representation perspective.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib18.1.1">IEEE/CVF Conference on Computer Vision and Pattern Recognition</em>, pp.  9311–9319, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. (2004)</span>
<span class="ltx_bibblock">
Zhou Wang, Alan C Bovik, Hamid R Sheikh, and Eero P Simoncelli.

</span>
<span class="ltx_bibblock">Image quality assessment: from error visibility to structural similarity.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib19.1.1">IEEE Transactions on Image Processing</em>, 13(4):600–612, 2004.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wen et al. (2022)</span>
<span class="ltx_bibblock">
Yuxin Wen, Jonas A Geiping, Liam Fowl, Micah Goldblum, and Tom Goldstein.

</span>
<span class="ltx_bibblock">Fishing for user data in large-batch federated learning via gradient magnification.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib20.1.1">International Conference on Machine Learning</em>, pp.  23668–23684. PMLR, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wu et al. (2024)</span>
<span class="ltx_bibblock">
Di Wu, Jun Bai, Yiliao Song, Junjun Chen, Wei Zhou, Yong Xiang, and Atul Sajjanhar.

</span>
<span class="ltx_bibblock">FedInverse: Evaluating privacy leakage in federated learning.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib21.1.1">International Conference on Learning Representations</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yin et al. (2021)</span>
<span class="ltx_bibblock">
Hongxu Yin, Arun Mallya, Arash Vahdat, Jose M Alvarez, Jan Kautz, and Pavlo Molchanov.

</span>
<span class="ltx_bibblock">See through gradients: Image batch recovery via gradinversion.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib22.1.1">IEEE/CVF Conference on Computer Vision and Pattern Recognition</em>, pp.  16337–16346, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yue et al. (2023)</span>
<span class="ltx_bibblock">
Kai Yue, Richeng Jin, Chau-Wai Wong, Dror Baron, and Huaiyu Dai.

</span>
<span class="ltx_bibblock">Gradient obfuscation gives a false sense of security in federated learning.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib23.1.1">USENIX Security Symposium</em>, pp.  6381–6398, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al. (2018)</span>
<span class="ltx_bibblock">
Richard Zhang, Phillip Isola, Alexei A Efros, Eli Shechtman, and Oliver Wang.

</span>
<span class="ltx_bibblock">The unreasonable effectiveness of deep features as a perceptual metric.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib24.1.1">IEEE Conference on Computer Vision and Pattern Recognition</em>, pp.  586–595, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al. (2020)</span>
<span class="ltx_bibblock">
Zhen Zhang, Chaokun Chang, Haibin Lin, Yida Wang, Raman Arora, and Xin Jin.

</span>
<span class="ltx_bibblock">Is network the bottleneck of distributed training?

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib25.1.1">Workshop on Network Meets AI &amp; ML</em>, pp.  8–13, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhu et al. (2019)</span>
<span class="ltx_bibblock">
Ligeng Zhu, Zhijian Liu, and Song Han.

</span>
<span class="ltx_bibblock">Deep leakage from gradients.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib26.1.1">Advances in Neural Information Processing Systems</em>, 32, 2019.

</span>
</li>
</ul>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Sun Oct  6 22:37:46 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
