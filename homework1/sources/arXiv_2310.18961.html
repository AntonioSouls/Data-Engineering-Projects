<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2310.18961] AnomalyCLIP: Object-agnostic Prompt Learning for Zero-shot Anomaly Detection</title><meta property="og:description" content="Zero-shot anomaly detection (ZSAD) requires detection models trained using auxiliary data to detect anomalies without any training sample in a target dataset. It is a crucial task when training data is not accessible d…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="AnomalyCLIP: Object-agnostic Prompt Learning for Zero-shot Anomaly Detection">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="AnomalyCLIP: Object-agnostic Prompt Learning for Zero-shot Anomaly Detection">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2310.18961">

<!--Generated on Tue Feb 27 21:37:41 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">AnomalyCLIP: Object-agnostic Prompt Learning for Zero-shot Anomaly Detection</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname"> Qihang Zhou<sup id="id5.5.id1" class="ltx_sup">1</sup> ,
Guansong Pang<sup id="id2.2.1" class="ltx_sup">2<math id="id2.2.1.m1.1" class="ltx_Math" alttext="\ast" display="inline"><semantics id="id2.2.1.m1.1a"><mo id="id2.2.1.m1.1.1" xref="id2.2.1.m1.1.1.cmml">∗</mo><annotation-xml encoding="MathML-Content" id="id2.2.1.m1.1b"><ci id="id2.2.1.m1.1.1.cmml" xref="id2.2.1.m1.1.1">∗</ci></annotation-xml><annotation encoding="application/x-tex" id="id2.2.1.m1.1c">\ast</annotation></semantics></math></sup>,
Yu Tian<sup id="id6.6.id2" class="ltx_sup">3</sup>,
Shibo He<sup id="id3.3.2" class="ltx_sup">1<math id="id3.3.2.m1.1" class="ltx_Math" alttext="\dagger" display="inline"><semantics id="id3.3.2.m1.1a"><mo id="id3.3.2.m1.1.1" xref="id3.3.2.m1.1.1.cmml">†</mo><annotation-xml encoding="MathML-Content" id="id3.3.2.m1.1b"><ci id="id3.3.2.m1.1.1.cmml" xref="id3.3.2.m1.1.1">†</ci></annotation-xml><annotation encoding="application/x-tex" id="id3.3.2.m1.1c">\dagger</annotation></semantics></math></sup>,
Jiming Chen<sup id="id4.4.3" class="ltx_sup">1<math id="id4.4.3.m1.1" class="ltx_Math" alttext="\dagger" display="inline"><semantics id="id4.4.3.m1.1a"><mo id="id4.4.3.m1.1.1" xref="id4.4.3.m1.1.1.cmml">†</mo><annotation-xml encoding="MathML-Content" id="id4.4.3.m1.1b"><ci id="id4.4.3.m1.1.1.cmml" xref="id4.4.3.m1.1.1">†</ci></annotation-xml><annotation encoding="application/x-tex" id="id4.4.3.m1.1c">\dagger</annotation></semantics></math></sup> 
<br class="ltx_break"><sup id="id7.7.id3" class="ltx_sup">1</sup>Zhejiang University  <sup id="id8.8.id4" class="ltx_sup">2</sup> Singapore Management University  <sup id="id9.9.id5" class="ltx_sup">3</sup>Harvard University 
<br class="ltx_break"><sup id="id10.10.id6" class="ltx_sup">1</sup> <span id="id11.11.id7" class="ltx_text ltx_font_typewriter">{zqhang, s18he, cjm}@zju.edu.cn</span>  <sup id="id12.12.id8" class="ltx_sup">2</sup><span id="id13.13.id9" class="ltx_text ltx_font_typewriter">gspang@smu.edu.sg</span>  
<br class="ltx_break"><sup id="id14.14.id10" class="ltx_sup">3</sup><span id="id15.15.id11" class="ltx_text ltx_font_typewriter">ytian11@meei.harvard.edu</span>
</span><span class="ltx_author_notes">Equal contribution. <math id="id1.1.m1.1" class="ltx_Math" alttext="\dagger" display="inline"><semantics id="id1.1.m1.1a"><mo id="id1.1.m1.1.1" xref="id1.1.m1.1.1.cmml">†</mo><annotation-xml encoding="MathML-Content" id="id1.1.m1.1b"><ci id="id1.1.m1.1.1.cmml" xref="id1.1.m1.1.1">†</ci></annotation-xml><annotation encoding="application/x-tex" id="id1.1.m1.1c">\dagger</annotation></semantics></math> Corresponding authors.</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id16.id1" class="ltx_p">Zero-shot anomaly detection (ZSAD) requires detection models trained using auxiliary data to detect anomalies without any training sample in a target dataset. It is a crucial task when training data is not accessible due to various concerns, <em id="id16.id1.1" class="ltx_emph ltx_font_italic">e.g.</em>, data privacy, yet it is challenging since the models need to generalize to anomalies across different domains where the appearance of foreground objects, abnormal regions, and background features, such as defects/tumors on different products/organs, can vary significantly.
Recently large pre-trained vision-language models (VLMs), such as CLIP,
have demonstrated strong zero-shot recognition ability in various vision tasks, including anomaly detection. However, their ZSAD performance is weak since the VLMs focus more on modeling the class semantics of the foreground objects rather than the abnormality/normality in the images.
In this paper we introduce a novel approach, namely AnomalyCLIP, to adapt CLIP for accurate ZSAD across different domains. The key insight of AnomalyCLIP is to learn object-agnostic text prompts that capture generic normality and abnormality in an image regardless of its foreground objects. This allows our model to focus on the abnormal image regions rather than the object semantics, enabling generalized normality and abnormality recognition on diverse types of objects. Large-scale experiments on 17 real-world anomaly detection datasets show that AnomalyCLIP achieves superior zero-shot performance of detecting and segmenting anomalies in datasets of highly diverse class semantics from various defect inspection and medical imaging domains. Code will be made available at <a target="_blank" href="https://github.com/zqhang/AnomalyCLIP" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://github.com/zqhang/AnomalyCLIP</a>.</p>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para ltx_noindent">
<p id="S1.p1.1" class="ltx_p">Anomaly detection (AD) has been widely applied in various applications, such as industrial defect inspection <cite class="ltx_cite ltx_citemacro_citep">(Bergmann et al., <a href="#bib.bib2" title="" class="ltx_ref">2019</a>; Xie et al., <a href="#bib.bib56" title="" class="ltx_ref">2023</a>; Roth et al., <a href="#bib.bib44" title="" class="ltx_ref">2022</a>; Huang et al., <a href="#bib.bib19" title="" class="ltx_ref">2022</a>; Mou et al., <a href="#bib.bib36" title="" class="ltx_ref">2022</a>; Chen et al., <a href="#bib.bib7" title="" class="ltx_ref">2022</a>; Bergmann et al., <a href="#bib.bib3" title="" class="ltx_ref">2020</a>; Pang et al., <a href="#bib.bib37" title="" class="ltx_ref">2021a</a>; Reiss &amp; Hoshen, <a href="#bib.bib43" title="" class="ltx_ref">2023</a>; You et al., <a href="#bib.bib57" title="" class="ltx_ref">2022</a>; Liznerski et al., <a href="#bib.bib33" title="" class="ltx_ref">2020</a>; Ding et al., <a href="#bib.bib10" title="" class="ltx_ref">2022</a>; Zhou et al., <a href="#bib.bib61" title="" class="ltx_ref">2023</a>; Cao et al., <a href="#bib.bib5" title="" class="ltx_ref">2023</a>)</cite> and medical image analysis <cite class="ltx_cite ltx_citemacro_citep">(Pang et al., <a href="#bib.bib37" title="" class="ltx_ref">2021a</a>; Qin et al., <a href="#bib.bib39" title="" class="ltx_ref">2022</a>; Liu et al., <a href="#bib.bib32" title="" class="ltx_ref">2023</a>; Ding et al., <a href="#bib.bib10" title="" class="ltx_ref">2022</a>; Tian et al., <a href="#bib.bib51" title="" class="ltx_ref">2021</a>; <a href="#bib.bib52" title="" class="ltx_ref">2023</a>; Fernando et al., <a href="#bib.bib13" title="" class="ltx_ref">2021</a>)</cite>.
Existing AD approaches typically assume that training examples in a target application domain are available for learning the detection models <cite class="ltx_cite ltx_citemacro_citep">(Pang et al., <a href="#bib.bib38" title="" class="ltx_ref">2021b</a>; Ruff et al., <a href="#bib.bib45" title="" class="ltx_ref">2021</a>)</cite>. However, this assumption may not hold in various scenarios, such as i) when accessing training data violates data privacy policies (<em id="S1.p1.1.1" class="ltx_emph ltx_font_italic">e.g.</em>, to protect the sensitive information of patients), or ii) when the target domain does not have relevant training data (<em id="S1.p1.1.2" class="ltx_emph ltx_font_italic">e.g.</em>,
inspecting defects in a manufacturing line of new products). Zero-shot anomaly detection (ZSAD) is an emerging task for AD in such scenarios, to which the aforementioned AD approaches are not viable, as it requires detection models to detect anomalies without any training sample in a target dataset. Since anomalies from different application scenarios typically have substantial variations in their visual appearance, foreground objects, and background features, <em id="S1.p1.1.3" class="ltx_emph ltx_font_italic">e.g.</em>, defects on the surface of one product vs. that on the other products, lesions/tumors on different organs, or industrial defects vs. tumors/lesions in medical images, detection models with strong generalization ability w.r.t. such variations are needed for accurate ZSAD. Recently large pre-trained vision-language models (VLMs) <cite class="ltx_cite ltx_citemacro_citep">(Radford et al., <a href="#bib.bib40" title="" class="ltx_ref">2021</a>; Kirillov et al., <a href="#bib.bib27" title="" class="ltx_ref">2023</a>)</cite> have demonstrated strong zero-shot recognition ability in various vision tasks, including anomaly detection <cite class="ltx_cite ltx_citemacro_citep">(Jeong et al., <a href="#bib.bib20" title="" class="ltx_ref">2023</a>)</cite>. Particularly, being pre-trained using millions/billions of image-text pairs, CLIP <cite class="ltx_cite ltx_citemacro_citep">(Radford et al., <a href="#bib.bib40" title="" class="ltx_ref">2021</a>)</cite>
has been applied to empower various downstream tasks <cite class="ltx_cite ltx_citemacro_citep">(Zhou et al., <a href="#bib.bib60" title="" class="ltx_ref">2022b</a>; Rao et al., <a href="#bib.bib42" title="" class="ltx_ref">2022</a>; Khattak et al., <a href="#bib.bib24" title="" class="ltx_ref">2023</a>; Sain et al., <a href="#bib.bib46" title="" class="ltx_ref">2023</a>)</cite> with its strong generalization capability. WinCLIP <cite class="ltx_cite ltx_citemacro_citep">(Jeong et al., <a href="#bib.bib20" title="" class="ltx_ref">2023</a>)</cite> is a seminal work in the ZSAD line, which designs a large number of artificial text prompts to exploit the CLIP’s generalizability for ZSAD. However, the VLMs such as CLIP are primarily trained to align with the class semantics of foreground objects rather than the abnormality/normality in the images, and as a result, their generalization in understanding the visual abnormality/normality is restricted, leading to weak ZSAD performance. Further, the current prompting approaches, using either manually defined text prompts <cite class="ltx_cite ltx_citemacro_citep">(Jeong et al., <a href="#bib.bib20" title="" class="ltx_ref">2023</a>)</cite> or learnable prompts <cite class="ltx_cite ltx_citemacro_citep">(Sun et al., <a href="#bib.bib48" title="" class="ltx_ref">2022</a>; Zhou et al., <a href="#bib.bib59" title="" class="ltx_ref">2022a</a>)</cite>, often result in prompt embeddings that opt for global features for effective object semantic alignment
<cite class="ltx_cite ltx_citemacro_citep">(Zhong et al., <a href="#bib.bib58" title="" class="ltx_ref">2022</a>; Wu et al., <a href="#bib.bib55" title="" class="ltx_ref">2023</a>)</cite>, failing to capture the abnormality that often manifests in fine-grained, local features, as shown in Fig. <a href="#S1.F1.sf4" title="In Figure 1 ‣ 1 Introduction ‣ AnomalyCLIP: Object-agnostic Prompt Learning for Zero-shot Anomaly Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1d</span></a> and Fig. <a href="#S1.F1.sf5" title="In Figure 1 ‣ 1 Introduction ‣ AnomalyCLIP: Object-agnostic Prompt Learning for Zero-shot Anomaly Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1e</span></a>.
In this paper we introduce a novel approach, namely AnomalyCLIP, to adapt CLIP for accurate ZSAD across different domains. AnomalyCLIP aims to learn object-agnostic text prompts that capture generic normality and abnormality in an image regardless of its foreground objects. It first devises a simple yet universally-effective learnable prompt template for the two general classes – normality and abnormality – and then utilizes both image-level and pixel-level loss functions to learn the generic normality and abnormality globally and locally in our prompt embeddings using auxiliary data. This allows our model to focus on the abnormal image regions rather the object semantics, enabling remarkable zero-shot capability of recognizing the abnormality that has similar abnormal patterns to those in auxiliary data.
As shown in Fig. <a href="#S1.F1.sf1" title="In Figure 1 ‣ 1 Introduction ‣ AnomalyCLIP: Object-agnostic Prompt Learning for Zero-shot Anomaly Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1a</span></a> and Fig. <a href="#S1.F1.sf2" title="In Figure 1 ‣ 1 Introduction ‣ AnomalyCLIP: Object-agnostic Prompt Learning for Zero-shot Anomaly Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1b</span></a>, the foreground object semantics can be completely different in the fine-tuning auxiliary data and target data, but the anomaly patterns remain similar, <em id="S1.p1.1.4" class="ltx_emph ltx_font_italic">e.g.</em>, scratches on metal nuts and plates, the misplacement of transistors and PCB, tumors/lesions on various organ surfaces, etc. Text prompt embeddings in CLIP fail to generalize across different domains, as illustrated in Fig. <a href="#S1.F1.sf3" title="In Figure 1 ‣ 1 Introduction ‣ AnomalyCLIP: Object-agnostic Prompt Learning for Zero-shot Anomaly Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1c</span></a>, but object-agnostic prompt embeddings learned by AnomalyCLIP can effectively generalize to recognize the abnormality across different domain images in Fig. <a href="#S1.F1.sf6" title="In Figure 1 ‣ 1 Introduction ‣ AnomalyCLIP: Object-agnostic Prompt Learning for Zero-shot Anomaly Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1f</span></a>.</p>
</div>
<figure id="S1.F1" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<div id="S1.F1.1" class="ltx_inline-block ltx_figure_panel ltx_align_center ltx_transformed_outer" style="width:397.5pt;height:294.3pt;vertical-align:-171.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-13.3pt,4.1pt) scale(0.937094839282561,0.937094839282561) ;">
</span></div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S1.F1.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2310.18961/assets/x1.png" id="S1.F1.sf1.g1" class="ltx_graphics ltx_img_portrait" width="67" height="140" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S1.F1.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2310.18961/assets/x2.png" id="S1.F1.sf2.g1" class="ltx_graphics ltx_img_portrait" width="67" height="140" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S1.F1.sf3" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2310.18961/assets/x3.png" id="S1.F1.sf3.g1" class="ltx_graphics ltx_img_portrait" width="67" height="140" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(c) </span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S1.F1.sf4" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2310.18961/assets/x4.png" id="S1.F1.sf4.g1" class="ltx_graphics ltx_img_portrait" width="67" height="140" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(d) </span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S1.F1.sf5" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2310.18961/assets/x5.png" id="S1.F1.sf5.g1" class="ltx_graphics ltx_img_portrait" width="67" height="140" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(e) </span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S1.F1.sf6" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2310.18961/assets/x6.png" id="S1.F1.sf6.g1" class="ltx_graphics ltx_img_portrait" width="67" height="140" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(f) </span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Comparison of ZSAD results on (b) test data using (c) original text prompts in CLIP <cite class="ltx_cite ltx_citemacro_citep">(Radford et al., <a href="#bib.bib40" title="" class="ltx_ref">2021</a>)</cite>, (d) tailored text prompts for AD in WinCLIP <cite class="ltx_cite ltx_citemacro_citep">(Jeong et al., <a href="#bib.bib20" title="" class="ltx_ref">2023</a>)</cite>, (e) learnable text prompts for general vision tasks in CoOp <cite class="ltx_cite ltx_citemacro_citep">(Zhou et al., <a href="#bib.bib59" title="" class="ltx_ref">2022a</a>)</cite>, and (f) object-agnostic text prompts in our AnomalyCLIP. (a) presents a set of auxiliary data we can use to learn the text prompts. The results are obtained by measuring the similarity between text prompt embeddings and image embeddings. The ground-truth anomaly regions are circled in red in (a) and (b). (c), (d), and (e) suffer from poor generalization across different domains, while
our AnomalyCLIP in (f) can well generalize to anomalies in diverse types of objects from different domains.</figcaption>
</figure>
<div id="S1.p2" class="ltx_para ltx_noindent">
<p id="S1.p2.1" class="ltx_p">In summary, this paper makes the following main contributions.</p>
<ul id="S1.I1" class="ltx_itemize">
<li id="S1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i1.p1" class="ltx_para">
<p id="S1.I1.i1.p1.1" class="ltx_p">We reveal for the first time that learning object-agnostic text prompts of normality and abnormality is a simple yet effective approach for accurate ZSAD. Compared to current text prompting approaches that are primarily designed for object semantic alignment <cite class="ltx_cite ltx_citemacro_citep">(Jeong et al., <a href="#bib.bib20" title="" class="ltx_ref">2023</a>; Zhou et al., <a href="#bib.bib60" title="" class="ltx_ref">2022b</a>)</cite>, our text prompt embeddings model semantics of generic abnormality and normality, allowing object-agnostic, generalized ZSAD performance.</p>
</div>
</li>
<li id="S1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i2.p1" class="ltx_para">
<p id="S1.I1.i2.p1.1" class="ltx_p">We then introduce a novel ZSAD approach, called AnomalyCLIP, in which we utilize an object-agnostic prompt template and a glocal abnormality loss function (i.e., a combination of global and local loss functions) to learn the generic abnormality and normality prompts using auxiliary data. In doing so, AnomalyCLIP largely simplifies the prompt design and can effectively apply to different domains without requiring any change on its learned two prompts, contrasting to existing methods like WinCLIP whose effectiveness relies heavily on extensive engineering on hundreds of manually defined prompts.</p>
</div>
</li>
<li id="S1.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i3.p1" class="ltx_para ltx_noindent">
<p id="S1.I1.i3.p1.1" class="ltx_p">Comprehensive experiments on 17 datasets from various industrial and medical domains demonstrate that AnomalyCLIP achieves superior ZSAD performance of detecting and segmenting anomalies in datasets of highly diverse class semantics from defect inspection and medical imaging domains.</p>
</div>
</li>
</ul>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Preliminary</h2>

<div id="S2.p1" class="ltx_para">
<p id="S2.p1.14" class="ltx_p">CLIP consists of a text encoder and visual encoder denoted as <math id="S2.p1.1.m1.1" class="ltx_Math" alttext="T(\cdot)" display="inline"><semantics id="S2.p1.1.m1.1a"><mrow id="S2.p1.1.m1.1.2" xref="S2.p1.1.m1.1.2.cmml"><mi id="S2.p1.1.m1.1.2.2" xref="S2.p1.1.m1.1.2.2.cmml">T</mi><mo lspace="0em" rspace="0em" id="S2.p1.1.m1.1.2.1" xref="S2.p1.1.m1.1.2.1.cmml">​</mo><mrow id="S2.p1.1.m1.1.2.3.2" xref="S2.p1.1.m1.1.2.cmml"><mo stretchy="false" id="S2.p1.1.m1.1.2.3.2.1" xref="S2.p1.1.m1.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S2.p1.1.m1.1.1" xref="S2.p1.1.m1.1.1.cmml">⋅</mo><mo stretchy="false" id="S2.p1.1.m1.1.2.3.2.2" xref="S2.p1.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.1.m1.1b"><apply id="S2.p1.1.m1.1.2.cmml" xref="S2.p1.1.m1.1.2"><times id="S2.p1.1.m1.1.2.1.cmml" xref="S2.p1.1.m1.1.2.1"></times><ci id="S2.p1.1.m1.1.2.2.cmml" xref="S2.p1.1.m1.1.2.2">𝑇</ci><ci id="S2.p1.1.m1.1.1.cmml" xref="S2.p1.1.m1.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.1.m1.1c">T(\cdot)</annotation></semantics></math> and <math id="S2.p1.2.m2.1" class="ltx_Math" alttext="F(\cdot)" display="inline"><semantics id="S2.p1.2.m2.1a"><mrow id="S2.p1.2.m2.1.2" xref="S2.p1.2.m2.1.2.cmml"><mi id="S2.p1.2.m2.1.2.2" xref="S2.p1.2.m2.1.2.2.cmml">F</mi><mo lspace="0em" rspace="0em" id="S2.p1.2.m2.1.2.1" xref="S2.p1.2.m2.1.2.1.cmml">​</mo><mrow id="S2.p1.2.m2.1.2.3.2" xref="S2.p1.2.m2.1.2.cmml"><mo stretchy="false" id="S2.p1.2.m2.1.2.3.2.1" xref="S2.p1.2.m2.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S2.p1.2.m2.1.1" xref="S2.p1.2.m2.1.1.cmml">⋅</mo><mo stretchy="false" id="S2.p1.2.m2.1.2.3.2.2" xref="S2.p1.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.2.m2.1b"><apply id="S2.p1.2.m2.1.2.cmml" xref="S2.p1.2.m2.1.2"><times id="S2.p1.2.m2.1.2.1.cmml" xref="S2.p1.2.m2.1.2.1"></times><ci id="S2.p1.2.m2.1.2.2.cmml" xref="S2.p1.2.m2.1.2.2">𝐹</ci><ci id="S2.p1.2.m2.1.1.cmml" xref="S2.p1.2.m2.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.2.m2.1c">F(\cdot)</annotation></semantics></math>, respectively. Both encoders are mainstream multi-layer networks such as ViT <cite class="ltx_cite ltx_citemacro_citep">(Dosovitskiy et al., <a href="#bib.bib11" title="" class="ltx_ref">2020</a>; Vaswani et al., <a href="#bib.bib53" title="" class="ltx_ref">2017</a>)</cite>. Using text prompts is a typical way to achieve the embeddings of different classes for zero-shot recognition. Particularly, a text prompt template <math id="S2.p1.3.m3.1" class="ltx_Math" alttext="{\mathbb{G}}" display="inline"><semantics id="S2.p1.3.m3.1a"><mi id="S2.p1.3.m3.1.1" xref="S2.p1.3.m3.1.1.cmml">𝔾</mi><annotation-xml encoding="MathML-Content" id="S2.p1.3.m3.1b"><ci id="S2.p1.3.m3.1.1.cmml" xref="S2.p1.3.m3.1.1">𝔾</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.3.m3.1c">{\mathbb{G}}</annotation></semantics></math> with the class name <math id="S2.p1.4.m4.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S2.p1.4.m4.1a"><mi id="S2.p1.4.m4.1.1" xref="S2.p1.4.m4.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S2.p1.4.m4.1b"><ci id="S2.p1.4.m4.1.1.cmml" xref="S2.p1.4.m4.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.4.m4.1c">c</annotation></semantics></math> can be passed through <math id="S2.p1.5.m5.1" class="ltx_Math" alttext="T(\cdot)" display="inline"><semantics id="S2.p1.5.m5.1a"><mrow id="S2.p1.5.m5.1.2" xref="S2.p1.5.m5.1.2.cmml"><mi id="S2.p1.5.m5.1.2.2" xref="S2.p1.5.m5.1.2.2.cmml">T</mi><mo lspace="0em" rspace="0em" id="S2.p1.5.m5.1.2.1" xref="S2.p1.5.m5.1.2.1.cmml">​</mo><mrow id="S2.p1.5.m5.1.2.3.2" xref="S2.p1.5.m5.1.2.cmml"><mo stretchy="false" id="S2.p1.5.m5.1.2.3.2.1" xref="S2.p1.5.m5.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S2.p1.5.m5.1.1" xref="S2.p1.5.m5.1.1.cmml">⋅</mo><mo stretchy="false" id="S2.p1.5.m5.1.2.3.2.2" xref="S2.p1.5.m5.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.5.m5.1b"><apply id="S2.p1.5.m5.1.2.cmml" xref="S2.p1.5.m5.1.2"><times id="S2.p1.5.m5.1.2.1.cmml" xref="S2.p1.5.m5.1.2.1"></times><ci id="S2.p1.5.m5.1.2.2.cmml" xref="S2.p1.5.m5.1.2.2">𝑇</ci><ci id="S2.p1.5.m5.1.1.cmml" xref="S2.p1.5.m5.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.5.m5.1c">T(\cdot)</annotation></semantics></math> to obtain its corresponding textual embedding <math id="S2.p1.6.m6.1" class="ltx_Math" alttext="g_{c}\in\mathbb{R}^{D}" display="inline"><semantics id="S2.p1.6.m6.1a"><mrow id="S2.p1.6.m6.1.1" xref="S2.p1.6.m6.1.1.cmml"><msub id="S2.p1.6.m6.1.1.2" xref="S2.p1.6.m6.1.1.2.cmml"><mi id="S2.p1.6.m6.1.1.2.2" xref="S2.p1.6.m6.1.1.2.2.cmml">g</mi><mi id="S2.p1.6.m6.1.1.2.3" xref="S2.p1.6.m6.1.1.2.3.cmml">c</mi></msub><mo id="S2.p1.6.m6.1.1.1" xref="S2.p1.6.m6.1.1.1.cmml">∈</mo><msup id="S2.p1.6.m6.1.1.3" xref="S2.p1.6.m6.1.1.3.cmml"><mi id="S2.p1.6.m6.1.1.3.2" xref="S2.p1.6.m6.1.1.3.2.cmml">ℝ</mi><mi id="S2.p1.6.m6.1.1.3.3" xref="S2.p1.6.m6.1.1.3.3.cmml">D</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.6.m6.1b"><apply id="S2.p1.6.m6.1.1.cmml" xref="S2.p1.6.m6.1.1"><in id="S2.p1.6.m6.1.1.1.cmml" xref="S2.p1.6.m6.1.1.1"></in><apply id="S2.p1.6.m6.1.1.2.cmml" xref="S2.p1.6.m6.1.1.2"><csymbol cd="ambiguous" id="S2.p1.6.m6.1.1.2.1.cmml" xref="S2.p1.6.m6.1.1.2">subscript</csymbol><ci id="S2.p1.6.m6.1.1.2.2.cmml" xref="S2.p1.6.m6.1.1.2.2">𝑔</ci><ci id="S2.p1.6.m6.1.1.2.3.cmml" xref="S2.p1.6.m6.1.1.2.3">𝑐</ci></apply><apply id="S2.p1.6.m6.1.1.3.cmml" xref="S2.p1.6.m6.1.1.3"><csymbol cd="ambiguous" id="S2.p1.6.m6.1.1.3.1.cmml" xref="S2.p1.6.m6.1.1.3">superscript</csymbol><ci id="S2.p1.6.m6.1.1.3.2.cmml" xref="S2.p1.6.m6.1.1.3.2">ℝ</ci><ci id="S2.p1.6.m6.1.1.3.3.cmml" xref="S2.p1.6.m6.1.1.3.3">𝐷</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.6.m6.1c">g_{c}\in\mathbb{R}^{D}</annotation></semantics></math>.
The text prompt template commonly used in CLIP looks like <code id="S2.p1.14.1" class="ltx_verbatim ltx_font_typewriter">A photo of a [cls]</code>, where <code id="S2.p1.14.2" class="ltx_verbatim ltx_font_typewriter">[cls]</code> represents the target class name.
Then <math id="S2.p1.7.m7.1" class="ltx_Math" alttext="F(\cdot)" display="inline"><semantics id="S2.p1.7.m7.1a"><mrow id="S2.p1.7.m7.1.2" xref="S2.p1.7.m7.1.2.cmml"><mi id="S2.p1.7.m7.1.2.2" xref="S2.p1.7.m7.1.2.2.cmml">F</mi><mo lspace="0em" rspace="0em" id="S2.p1.7.m7.1.2.1" xref="S2.p1.7.m7.1.2.1.cmml">​</mo><mrow id="S2.p1.7.m7.1.2.3.2" xref="S2.p1.7.m7.1.2.cmml"><mo stretchy="false" id="S2.p1.7.m7.1.2.3.2.1" xref="S2.p1.7.m7.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S2.p1.7.m7.1.1" xref="S2.p1.7.m7.1.1.cmml">⋅</mo><mo stretchy="false" id="S2.p1.7.m7.1.2.3.2.2" xref="S2.p1.7.m7.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.7.m7.1b"><apply id="S2.p1.7.m7.1.2.cmml" xref="S2.p1.7.m7.1.2"><times id="S2.p1.7.m7.1.2.1.cmml" xref="S2.p1.7.m7.1.2.1"></times><ci id="S2.p1.7.m7.1.2.2.cmml" xref="S2.p1.7.m7.1.2.2">𝐹</ci><ci id="S2.p1.7.m7.1.1.cmml" xref="S2.p1.7.m7.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.7.m7.1c">F(\cdot)</annotation></semantics></math> encodes an image <math id="S2.p1.8.m8.1" class="ltx_Math" alttext="x_{i}" display="inline"><semantics id="S2.p1.8.m8.1a"><msub id="S2.p1.8.m8.1.1" xref="S2.p1.8.m8.1.1.cmml"><mi id="S2.p1.8.m8.1.1.2" xref="S2.p1.8.m8.1.1.2.cmml">x</mi><mi id="S2.p1.8.m8.1.1.3" xref="S2.p1.8.m8.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p1.8.m8.1b"><apply id="S2.p1.8.m8.1.1.cmml" xref="S2.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S2.p1.8.m8.1.1.1.cmml" xref="S2.p1.8.m8.1.1">subscript</csymbol><ci id="S2.p1.8.m8.1.1.2.cmml" xref="S2.p1.8.m8.1.1.2">𝑥</ci><ci id="S2.p1.8.m8.1.1.3.cmml" xref="S2.p1.8.m8.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.8.m8.1c">x_{i}</annotation></semantics></math> to derive visual representations, where the class token <math id="S2.p1.9.m9.1" class="ltx_Math" alttext="f_{i}\in\mathbb{R}^{D}" display="inline"><semantics id="S2.p1.9.m9.1a"><mrow id="S2.p1.9.m9.1.1" xref="S2.p1.9.m9.1.1.cmml"><msub id="S2.p1.9.m9.1.1.2" xref="S2.p1.9.m9.1.1.2.cmml"><mi id="S2.p1.9.m9.1.1.2.2" xref="S2.p1.9.m9.1.1.2.2.cmml">f</mi><mi id="S2.p1.9.m9.1.1.2.3" xref="S2.p1.9.m9.1.1.2.3.cmml">i</mi></msub><mo id="S2.p1.9.m9.1.1.1" xref="S2.p1.9.m9.1.1.1.cmml">∈</mo><msup id="S2.p1.9.m9.1.1.3" xref="S2.p1.9.m9.1.1.3.cmml"><mi id="S2.p1.9.m9.1.1.3.2" xref="S2.p1.9.m9.1.1.3.2.cmml">ℝ</mi><mi id="S2.p1.9.m9.1.1.3.3" xref="S2.p1.9.m9.1.1.3.3.cmml">D</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.9.m9.1b"><apply id="S2.p1.9.m9.1.1.cmml" xref="S2.p1.9.m9.1.1"><in id="S2.p1.9.m9.1.1.1.cmml" xref="S2.p1.9.m9.1.1.1"></in><apply id="S2.p1.9.m9.1.1.2.cmml" xref="S2.p1.9.m9.1.1.2"><csymbol cd="ambiguous" id="S2.p1.9.m9.1.1.2.1.cmml" xref="S2.p1.9.m9.1.1.2">subscript</csymbol><ci id="S2.p1.9.m9.1.1.2.2.cmml" xref="S2.p1.9.m9.1.1.2.2">𝑓</ci><ci id="S2.p1.9.m9.1.1.2.3.cmml" xref="S2.p1.9.m9.1.1.2.3">𝑖</ci></apply><apply id="S2.p1.9.m9.1.1.3.cmml" xref="S2.p1.9.m9.1.1.3"><csymbol cd="ambiguous" id="S2.p1.9.m9.1.1.3.1.cmml" xref="S2.p1.9.m9.1.1.3">superscript</csymbol><ci id="S2.p1.9.m9.1.1.3.2.cmml" xref="S2.p1.9.m9.1.1.3.2">ℝ</ci><ci id="S2.p1.9.m9.1.1.3.3.cmml" xref="S2.p1.9.m9.1.1.3.3">𝐷</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.9.m9.1c">f_{i}\in\mathbb{R}^{D}</annotation></semantics></math> is treated as its visual embedding (global visual embedding), and patch tokens <math id="S2.p1.10.m10.1" class="ltx_Math" alttext="f_{i}^{m}\in\mathbb{R}^{H\times W\times D}" display="inline"><semantics id="S2.p1.10.m10.1a"><mrow id="S2.p1.10.m10.1.1" xref="S2.p1.10.m10.1.1.cmml"><msubsup id="S2.p1.10.m10.1.1.2" xref="S2.p1.10.m10.1.1.2.cmml"><mi id="S2.p1.10.m10.1.1.2.2.2" xref="S2.p1.10.m10.1.1.2.2.2.cmml">f</mi><mi id="S2.p1.10.m10.1.1.2.2.3" xref="S2.p1.10.m10.1.1.2.2.3.cmml">i</mi><mi id="S2.p1.10.m10.1.1.2.3" xref="S2.p1.10.m10.1.1.2.3.cmml">m</mi></msubsup><mo id="S2.p1.10.m10.1.1.1" xref="S2.p1.10.m10.1.1.1.cmml">∈</mo><msup id="S2.p1.10.m10.1.1.3" xref="S2.p1.10.m10.1.1.3.cmml"><mi id="S2.p1.10.m10.1.1.3.2" xref="S2.p1.10.m10.1.1.3.2.cmml">ℝ</mi><mrow id="S2.p1.10.m10.1.1.3.3" xref="S2.p1.10.m10.1.1.3.3.cmml"><mi id="S2.p1.10.m10.1.1.3.3.2" xref="S2.p1.10.m10.1.1.3.3.2.cmml">H</mi><mo lspace="0.222em" rspace="0.222em" id="S2.p1.10.m10.1.1.3.3.1" xref="S2.p1.10.m10.1.1.3.3.1.cmml">×</mo><mi id="S2.p1.10.m10.1.1.3.3.3" xref="S2.p1.10.m10.1.1.3.3.3.cmml">W</mi><mo lspace="0.222em" rspace="0.222em" id="S2.p1.10.m10.1.1.3.3.1a" xref="S2.p1.10.m10.1.1.3.3.1.cmml">×</mo><mi id="S2.p1.10.m10.1.1.3.3.4" xref="S2.p1.10.m10.1.1.3.3.4.cmml">D</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.10.m10.1b"><apply id="S2.p1.10.m10.1.1.cmml" xref="S2.p1.10.m10.1.1"><in id="S2.p1.10.m10.1.1.1.cmml" xref="S2.p1.10.m10.1.1.1"></in><apply id="S2.p1.10.m10.1.1.2.cmml" xref="S2.p1.10.m10.1.1.2"><csymbol cd="ambiguous" id="S2.p1.10.m10.1.1.2.1.cmml" xref="S2.p1.10.m10.1.1.2">superscript</csymbol><apply id="S2.p1.10.m10.1.1.2.2.cmml" xref="S2.p1.10.m10.1.1.2"><csymbol cd="ambiguous" id="S2.p1.10.m10.1.1.2.2.1.cmml" xref="S2.p1.10.m10.1.1.2">subscript</csymbol><ci id="S2.p1.10.m10.1.1.2.2.2.cmml" xref="S2.p1.10.m10.1.1.2.2.2">𝑓</ci><ci id="S2.p1.10.m10.1.1.2.2.3.cmml" xref="S2.p1.10.m10.1.1.2.2.3">𝑖</ci></apply><ci id="S2.p1.10.m10.1.1.2.3.cmml" xref="S2.p1.10.m10.1.1.2.3">𝑚</ci></apply><apply id="S2.p1.10.m10.1.1.3.cmml" xref="S2.p1.10.m10.1.1.3"><csymbol cd="ambiguous" id="S2.p1.10.m10.1.1.3.1.cmml" xref="S2.p1.10.m10.1.1.3">superscript</csymbol><ci id="S2.p1.10.m10.1.1.3.2.cmml" xref="S2.p1.10.m10.1.1.3.2">ℝ</ci><apply id="S2.p1.10.m10.1.1.3.3.cmml" xref="S2.p1.10.m10.1.1.3.3"><times id="S2.p1.10.m10.1.1.3.3.1.cmml" xref="S2.p1.10.m10.1.1.3.3.1"></times><ci id="S2.p1.10.m10.1.1.3.3.2.cmml" xref="S2.p1.10.m10.1.1.3.3.2">𝐻</ci><ci id="S2.p1.10.m10.1.1.3.3.3.cmml" xref="S2.p1.10.m10.1.1.3.3.3">𝑊</ci><ci id="S2.p1.10.m10.1.1.3.3.4.cmml" xref="S2.p1.10.m10.1.1.3.3.4">𝐷</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.10.m10.1c">f_{i}^{m}\in\mathbb{R}^{H\times W\times D}</annotation></semantics></math> are referred to as local visual embeddings.
CLIP performs zero-shot recognition by measuring the similarity between textual and visual embeddings. In specific, given a target class set <math id="S2.p1.11.m11.1" class="ltx_Math" alttext="\mathcal{C}" display="inline"><semantics id="S2.p1.11.m11.1a"><mi class="ltx_font_mathcaligraphic" id="S2.p1.11.m11.1.1" xref="S2.p1.11.m11.1.1.cmml">𝒞</mi><annotation-xml encoding="MathML-Content" id="S2.p1.11.m11.1b"><ci id="S2.p1.11.m11.1.1.cmml" xref="S2.p1.11.m11.1.1">𝒞</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.11.m11.1c">\mathcal{C}</annotation></semantics></math> and an image <math id="S2.p1.12.m12.1" class="ltx_Math" alttext="x_{i}" display="inline"><semantics id="S2.p1.12.m12.1a"><msub id="S2.p1.12.m12.1.1" xref="S2.p1.12.m12.1.1.cmml"><mi id="S2.p1.12.m12.1.1.2" xref="S2.p1.12.m12.1.1.2.cmml">x</mi><mi id="S2.p1.12.m12.1.1.3" xref="S2.p1.12.m12.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p1.12.m12.1b"><apply id="S2.p1.12.m12.1.1.cmml" xref="S2.p1.12.m12.1.1"><csymbol cd="ambiguous" id="S2.p1.12.m12.1.1.1.cmml" xref="S2.p1.12.m12.1.1">subscript</csymbol><ci id="S2.p1.12.m12.1.1.2.cmml" xref="S2.p1.12.m12.1.1.2">𝑥</ci><ci id="S2.p1.12.m12.1.1.3.cmml" xref="S2.p1.12.m12.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.12.m12.1c">x_{i}</annotation></semantics></math>, CLIP predicts the probability of <math id="S2.p1.13.m13.1" class="ltx_Math" alttext="x_{i}" display="inline"><semantics id="S2.p1.13.m13.1a"><msub id="S2.p1.13.m13.1.1" xref="S2.p1.13.m13.1.1.cmml"><mi id="S2.p1.13.m13.1.1.2" xref="S2.p1.13.m13.1.1.2.cmml">x</mi><mi id="S2.p1.13.m13.1.1.3" xref="S2.p1.13.m13.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p1.13.m13.1b"><apply id="S2.p1.13.m13.1.1.cmml" xref="S2.p1.13.m13.1.1"><csymbol cd="ambiguous" id="S2.p1.13.m13.1.1.1.cmml" xref="S2.p1.13.m13.1.1">subscript</csymbol><ci id="S2.p1.13.m13.1.1.2.cmml" xref="S2.p1.13.m13.1.1.2">𝑥</ci><ci id="S2.p1.13.m13.1.1.3.cmml" xref="S2.p1.13.m13.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.13.m13.1c">x_{i}</annotation></semantics></math> belonging to <math id="S2.p1.14.m14.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S2.p1.14.m14.1a"><mi id="S2.p1.14.m14.1.1" xref="S2.p1.14.m14.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S2.p1.14.m14.1b"><ci id="S2.p1.14.m14.1.1.cmml" xref="S2.p1.14.m14.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.14.m14.1c">c</annotation></semantics></math> as follows:</p>
<table id="S2.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E1.m1.1" class="ltx_math_unparsed" alttext="p(y=c|x_{i})=P(g_{c},f_{i})={\frac{exp(&lt;g_{c},f_{i}&gt;/\tau)}{\sum_{c\in\mathcal{C}}exp(&lt;g_{c},f_{i}&gt;)/\tau)}}," display="block"><semantics id="S2.E1.m1.1a"><mrow id="S2.E1.m1.1.1.1"><mrow id="S2.E1.m1.1.1.1.1"><mrow id="S2.E1.m1.1.1.1.1.1"><mi id="S2.E1.m1.1.1.1.1.1.3">p</mi><mo lspace="0em" rspace="0em" id="S2.E1.m1.1.1.1.1.1.2">​</mo><mrow id="S2.E1.m1.1.1.1.1.1.1.1"><mo stretchy="false" id="S2.E1.m1.1.1.1.1.1.1.1.2">(</mo><mrow id="S2.E1.m1.1.1.1.1.1.1.1.1"><mi id="S2.E1.m1.1.1.1.1.1.1.1.1.2">y</mi><mo id="S2.E1.m1.1.1.1.1.1.1.1.1.1">=</mo><mrow id="S2.E1.m1.1.1.1.1.1.1.1.1.3"><mi id="S2.E1.m1.1.1.1.1.1.1.1.1.3.2">c</mi><mo fence="false" id="S2.E1.m1.1.1.1.1.1.1.1.1.3.1">|</mo><msub id="S2.E1.m1.1.1.1.1.1.1.1.1.3.3"><mi id="S2.E1.m1.1.1.1.1.1.1.1.1.3.3.2">x</mi><mi id="S2.E1.m1.1.1.1.1.1.1.1.1.3.3.3">i</mi></msub></mrow></mrow><mo stretchy="false" id="S2.E1.m1.1.1.1.1.1.1.1.3">)</mo></mrow></mrow><mo id="S2.E1.m1.1.1.1.1.5">=</mo><mrow id="S2.E1.m1.1.1.1.1.3"><mi id="S2.E1.m1.1.1.1.1.3.4">P</mi><mo lspace="0em" rspace="0em" id="S2.E1.m1.1.1.1.1.3.3">​</mo><mrow id="S2.E1.m1.1.1.1.1.3.2.2"><mo stretchy="false" id="S2.E1.m1.1.1.1.1.3.2.2.3">(</mo><msub id="S2.E1.m1.1.1.1.1.2.1.1.1"><mi id="S2.E1.m1.1.1.1.1.2.1.1.1.2">g</mi><mi id="S2.E1.m1.1.1.1.1.2.1.1.1.3">c</mi></msub><mo id="S2.E1.m1.1.1.1.1.3.2.2.4">,</mo><msub id="S2.E1.m1.1.1.1.1.3.2.2.2"><mi id="S2.E1.m1.1.1.1.1.3.2.2.2.2">f</mi><mi id="S2.E1.m1.1.1.1.1.3.2.2.2.3">i</mi></msub><mo stretchy="false" id="S2.E1.m1.1.1.1.1.3.2.2.5">)</mo></mrow></mrow><mo id="S2.E1.m1.1.1.1.1.6">=</mo><mfrac id="S2.E1.m1.1.1.1.1.7"><mrow id="S2.E1.m1.1.1.1.1.7.2"><mi id="S2.E1.m1.1.1.1.1.7.2.1">e</mi><mi id="S2.E1.m1.1.1.1.1.7.2.2">x</mi><mi id="S2.E1.m1.1.1.1.1.7.2.3">p</mi><mrow id="S2.E1.m1.1.1.1.1.7.2.4"><mo stretchy="false" id="S2.E1.m1.1.1.1.1.7.2.4.1">(</mo><mo lspace="0em" id="S2.E1.m1.1.1.1.1.7.2.4.2">&lt;</mo><msub id="S2.E1.m1.1.1.1.1.7.2.4.3"><mi id="S2.E1.m1.1.1.1.1.7.2.4.3.2">g</mi><mi id="S2.E1.m1.1.1.1.1.7.2.4.3.3">c</mi></msub><mo id="S2.E1.m1.1.1.1.1.7.2.4.4">,</mo><msub id="S2.E1.m1.1.1.1.1.7.2.4.5"><mi id="S2.E1.m1.1.1.1.1.7.2.4.5.2">f</mi><mi id="S2.E1.m1.1.1.1.1.7.2.4.5.3">i</mi></msub><mo rspace="0em" id="S2.E1.m1.1.1.1.1.7.2.4.6">&gt;</mo><mo lspace="0em" id="S2.E1.m1.1.1.1.1.7.2.4.7">/</mo><mi id="S2.E1.m1.1.1.1.1.7.2.4.8">τ</mi><mo stretchy="false" id="S2.E1.m1.1.1.1.1.7.2.4.9">)</mo></mrow></mrow><mrow id="S2.E1.m1.1.1.1.1.7.3"><msub id="S2.E1.m1.1.1.1.1.7.3.1"><mo id="S2.E1.m1.1.1.1.1.7.3.1.2">∑</mo><mrow id="S2.E1.m1.1.1.1.1.7.3.1.3"><mi id="S2.E1.m1.1.1.1.1.7.3.1.3.2">c</mi><mo id="S2.E1.m1.1.1.1.1.7.3.1.3.1">∈</mo><mi class="ltx_font_mathcaligraphic" id="S2.E1.m1.1.1.1.1.7.3.1.3.3">𝒞</mi></mrow></msub><mi id="S2.E1.m1.1.1.1.1.7.3.2">e</mi><mi id="S2.E1.m1.1.1.1.1.7.3.3">x</mi><mi id="S2.E1.m1.1.1.1.1.7.3.4">p</mi><mrow id="S2.E1.m1.1.1.1.1.7.3.5"><mo stretchy="false" id="S2.E1.m1.1.1.1.1.7.3.5.1">(</mo><mo lspace="0em" id="S2.E1.m1.1.1.1.1.7.3.5.2">&lt;</mo><msub id="S2.E1.m1.1.1.1.1.7.3.5.3"><mi id="S2.E1.m1.1.1.1.1.7.3.5.3.2">g</mi><mi id="S2.E1.m1.1.1.1.1.7.3.5.3.3">c</mi></msub><mo id="S2.E1.m1.1.1.1.1.7.3.5.4">,</mo><msub id="S2.E1.m1.1.1.1.1.7.3.5.5"><mi id="S2.E1.m1.1.1.1.1.7.3.5.5.2">f</mi><mi id="S2.E1.m1.1.1.1.1.7.3.5.5.3">i</mi></msub><mo rspace="0em" id="S2.E1.m1.1.1.1.1.7.3.5.6">&gt;</mo><mo stretchy="false" id="S2.E1.m1.1.1.1.1.7.3.5.7">)</mo></mrow><mo id="S2.E1.m1.1.1.1.1.7.3.6">/</mo><mi id="S2.E1.m1.1.1.1.1.7.3.7">τ</mi><mo stretchy="false" id="S2.E1.m1.1.1.1.1.7.3.8">)</mo></mrow></mfrac></mrow><mo id="S2.E1.m1.1.1.1.2">,</mo></mrow><annotation encoding="application/x-tex" id="S2.E1.m1.1b">p(y=c|x_{i})=P(g_{c},f_{i})={\frac{exp(&lt;g_{c},f_{i}&gt;/\tau)}{\sum_{c\in\mathcal{C}}exp(&lt;g_{c},f_{i}&gt;)/\tau)}},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S2.p1.22" class="ltx_p">where <math id="S2.p1.15.m1.1" class="ltx_Math" alttext="\tau" display="inline"><semantics id="S2.p1.15.m1.1a"><mi id="S2.p1.15.m1.1.1" xref="S2.p1.15.m1.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S2.p1.15.m1.1b"><ci id="S2.p1.15.m1.1.1.cmml" xref="S2.p1.15.m1.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.15.m1.1c">\tau</annotation></semantics></math> is a temperature hyperparameter, and the operator <math id="S2.p1.16.m2.1" class="ltx_math_unparsed" alttext="&lt;\cdot,\cdot&gt;" display="inline"><semantics id="S2.p1.16.m2.1a"><mrow id="S2.p1.16.m2.1b"><mo rspace="0em" id="S2.p1.16.m2.1.1">&lt;</mo><mo lspace="0em" rspace="0em" id="S2.p1.16.m2.1.2">⋅</mo><mo rspace="0em" id="S2.p1.16.m2.1.3">,</mo><mo lspace="0em" rspace="0em" id="S2.p1.16.m2.1.4">⋅</mo><mo lspace="0em" id="S2.p1.16.m2.1.5">&gt;</mo></mrow><annotation encoding="application/x-tex" id="S2.p1.16.m2.1c">&lt;\cdot,\cdot&gt;</annotation></semantics></math> represents the computation of cosine similarity. Unlike many vision tasks that involve many objects and use the name of the objects as the class name <code id="S2.p1.22.1" class="ltx_verbatim ltx_font_typewriter">[cls]</code>,
we posit that performing ZSAD tasks using CLIP should be object-agnostic, so
we propose to design two classes of text prompts (<em id="S2.p1.22.2" class="ltx_emph ltx_font_italic">i.e.</em>, normality and abnormality) and compute the possibility of these two classes according to Eq. <a href="#S2.E1" title="In 2 Preliminary ‣ AnomalyCLIP: Object-agnostic Prompt Learning for Zero-shot Anomaly Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>.
We denote the probability of being abnormal <math id="S2.p1.17.m3.2" class="ltx_Math" alttext="P(g_{a},f_{i})" display="inline"><semantics id="S2.p1.17.m3.2a"><mrow id="S2.p1.17.m3.2.2" xref="S2.p1.17.m3.2.2.cmml"><mi id="S2.p1.17.m3.2.2.4" xref="S2.p1.17.m3.2.2.4.cmml">P</mi><mo lspace="0em" rspace="0em" id="S2.p1.17.m3.2.2.3" xref="S2.p1.17.m3.2.2.3.cmml">​</mo><mrow id="S2.p1.17.m3.2.2.2.2" xref="S2.p1.17.m3.2.2.2.3.cmml"><mo stretchy="false" id="S2.p1.17.m3.2.2.2.2.3" xref="S2.p1.17.m3.2.2.2.3.cmml">(</mo><msub id="S2.p1.17.m3.1.1.1.1.1" xref="S2.p1.17.m3.1.1.1.1.1.cmml"><mi id="S2.p1.17.m3.1.1.1.1.1.2" xref="S2.p1.17.m3.1.1.1.1.1.2.cmml">g</mi><mi id="S2.p1.17.m3.1.1.1.1.1.3" xref="S2.p1.17.m3.1.1.1.1.1.3.cmml">a</mi></msub><mo id="S2.p1.17.m3.2.2.2.2.4" xref="S2.p1.17.m3.2.2.2.3.cmml">,</mo><msub id="S2.p1.17.m3.2.2.2.2.2" xref="S2.p1.17.m3.2.2.2.2.2.cmml"><mi id="S2.p1.17.m3.2.2.2.2.2.2" xref="S2.p1.17.m3.2.2.2.2.2.2.cmml">f</mi><mi id="S2.p1.17.m3.2.2.2.2.2.3" xref="S2.p1.17.m3.2.2.2.2.2.3.cmml">i</mi></msub><mo stretchy="false" id="S2.p1.17.m3.2.2.2.2.5" xref="S2.p1.17.m3.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.17.m3.2b"><apply id="S2.p1.17.m3.2.2.cmml" xref="S2.p1.17.m3.2.2"><times id="S2.p1.17.m3.2.2.3.cmml" xref="S2.p1.17.m3.2.2.3"></times><ci id="S2.p1.17.m3.2.2.4.cmml" xref="S2.p1.17.m3.2.2.4">𝑃</ci><interval closure="open" id="S2.p1.17.m3.2.2.2.3.cmml" xref="S2.p1.17.m3.2.2.2.2"><apply id="S2.p1.17.m3.1.1.1.1.1.cmml" xref="S2.p1.17.m3.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.p1.17.m3.1.1.1.1.1.1.cmml" xref="S2.p1.17.m3.1.1.1.1.1">subscript</csymbol><ci id="S2.p1.17.m3.1.1.1.1.1.2.cmml" xref="S2.p1.17.m3.1.1.1.1.1.2">𝑔</ci><ci id="S2.p1.17.m3.1.1.1.1.1.3.cmml" xref="S2.p1.17.m3.1.1.1.1.1.3">𝑎</ci></apply><apply id="S2.p1.17.m3.2.2.2.2.2.cmml" xref="S2.p1.17.m3.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.p1.17.m3.2.2.2.2.2.1.cmml" xref="S2.p1.17.m3.2.2.2.2.2">subscript</csymbol><ci id="S2.p1.17.m3.2.2.2.2.2.2.cmml" xref="S2.p1.17.m3.2.2.2.2.2.2">𝑓</ci><ci id="S2.p1.17.m3.2.2.2.2.2.3.cmml" xref="S2.p1.17.m3.2.2.2.2.2.3">𝑖</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.17.m3.2c">P(g_{a},f_{i})</annotation></semantics></math> as the anomaly score. The computation is extended from global visual embeddings to local visual embeddings to derive the corresponding segmentation maps <math id="S2.p1.18.m4.1" class="ltx_Math" alttext="S_{n}\in\mathbb{R}^{H\times W}" display="inline"><semantics id="S2.p1.18.m4.1a"><mrow id="S2.p1.18.m4.1.1" xref="S2.p1.18.m4.1.1.cmml"><msub id="S2.p1.18.m4.1.1.2" xref="S2.p1.18.m4.1.1.2.cmml"><mi id="S2.p1.18.m4.1.1.2.2" xref="S2.p1.18.m4.1.1.2.2.cmml">S</mi><mi id="S2.p1.18.m4.1.1.2.3" xref="S2.p1.18.m4.1.1.2.3.cmml">n</mi></msub><mo id="S2.p1.18.m4.1.1.1" xref="S2.p1.18.m4.1.1.1.cmml">∈</mo><msup id="S2.p1.18.m4.1.1.3" xref="S2.p1.18.m4.1.1.3.cmml"><mi id="S2.p1.18.m4.1.1.3.2" xref="S2.p1.18.m4.1.1.3.2.cmml">ℝ</mi><mrow id="S2.p1.18.m4.1.1.3.3" xref="S2.p1.18.m4.1.1.3.3.cmml"><mi id="S2.p1.18.m4.1.1.3.3.2" xref="S2.p1.18.m4.1.1.3.3.2.cmml">H</mi><mo lspace="0.222em" rspace="0.222em" id="S2.p1.18.m4.1.1.3.3.1" xref="S2.p1.18.m4.1.1.3.3.1.cmml">×</mo><mi id="S2.p1.18.m4.1.1.3.3.3" xref="S2.p1.18.m4.1.1.3.3.3.cmml">W</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.18.m4.1b"><apply id="S2.p1.18.m4.1.1.cmml" xref="S2.p1.18.m4.1.1"><in id="S2.p1.18.m4.1.1.1.cmml" xref="S2.p1.18.m4.1.1.1"></in><apply id="S2.p1.18.m4.1.1.2.cmml" xref="S2.p1.18.m4.1.1.2"><csymbol cd="ambiguous" id="S2.p1.18.m4.1.1.2.1.cmml" xref="S2.p1.18.m4.1.1.2">subscript</csymbol><ci id="S2.p1.18.m4.1.1.2.2.cmml" xref="S2.p1.18.m4.1.1.2.2">𝑆</ci><ci id="S2.p1.18.m4.1.1.2.3.cmml" xref="S2.p1.18.m4.1.1.2.3">𝑛</ci></apply><apply id="S2.p1.18.m4.1.1.3.cmml" xref="S2.p1.18.m4.1.1.3"><csymbol cd="ambiguous" id="S2.p1.18.m4.1.1.3.1.cmml" xref="S2.p1.18.m4.1.1.3">superscript</csymbol><ci id="S2.p1.18.m4.1.1.3.2.cmml" xref="S2.p1.18.m4.1.1.3.2">ℝ</ci><apply id="S2.p1.18.m4.1.1.3.3.cmml" xref="S2.p1.18.m4.1.1.3.3"><times id="S2.p1.18.m4.1.1.3.3.1.cmml" xref="S2.p1.18.m4.1.1.3.3.1"></times><ci id="S2.p1.18.m4.1.1.3.3.2.cmml" xref="S2.p1.18.m4.1.1.3.3.2">𝐻</ci><ci id="S2.p1.18.m4.1.1.3.3.3.cmml" xref="S2.p1.18.m4.1.1.3.3.3">𝑊</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.18.m4.1c">S_{n}\in\mathbb{R}^{H\times W}</annotation></semantics></math> and <math id="S2.p1.19.m5.1" class="ltx_Math" alttext="S_{a}\in\mathbb{R}^{H\times W}" display="inline"><semantics id="S2.p1.19.m5.1a"><mrow id="S2.p1.19.m5.1.1" xref="S2.p1.19.m5.1.1.cmml"><msub id="S2.p1.19.m5.1.1.2" xref="S2.p1.19.m5.1.1.2.cmml"><mi id="S2.p1.19.m5.1.1.2.2" xref="S2.p1.19.m5.1.1.2.2.cmml">S</mi><mi id="S2.p1.19.m5.1.1.2.3" xref="S2.p1.19.m5.1.1.2.3.cmml">a</mi></msub><mo id="S2.p1.19.m5.1.1.1" xref="S2.p1.19.m5.1.1.1.cmml">∈</mo><msup id="S2.p1.19.m5.1.1.3" xref="S2.p1.19.m5.1.1.3.cmml"><mi id="S2.p1.19.m5.1.1.3.2" xref="S2.p1.19.m5.1.1.3.2.cmml">ℝ</mi><mrow id="S2.p1.19.m5.1.1.3.3" xref="S2.p1.19.m5.1.1.3.3.cmml"><mi id="S2.p1.19.m5.1.1.3.3.2" xref="S2.p1.19.m5.1.1.3.3.2.cmml">H</mi><mo lspace="0.222em" rspace="0.222em" id="S2.p1.19.m5.1.1.3.3.1" xref="S2.p1.19.m5.1.1.3.3.1.cmml">×</mo><mi id="S2.p1.19.m5.1.1.3.3.3" xref="S2.p1.19.m5.1.1.3.3.3.cmml">W</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.19.m5.1b"><apply id="S2.p1.19.m5.1.1.cmml" xref="S2.p1.19.m5.1.1"><in id="S2.p1.19.m5.1.1.1.cmml" xref="S2.p1.19.m5.1.1.1"></in><apply id="S2.p1.19.m5.1.1.2.cmml" xref="S2.p1.19.m5.1.1.2"><csymbol cd="ambiguous" id="S2.p1.19.m5.1.1.2.1.cmml" xref="S2.p1.19.m5.1.1.2">subscript</csymbol><ci id="S2.p1.19.m5.1.1.2.2.cmml" xref="S2.p1.19.m5.1.1.2.2">𝑆</ci><ci id="S2.p1.19.m5.1.1.2.3.cmml" xref="S2.p1.19.m5.1.1.2.3">𝑎</ci></apply><apply id="S2.p1.19.m5.1.1.3.cmml" xref="S2.p1.19.m5.1.1.3"><csymbol cd="ambiguous" id="S2.p1.19.m5.1.1.3.1.cmml" xref="S2.p1.19.m5.1.1.3">superscript</csymbol><ci id="S2.p1.19.m5.1.1.3.2.cmml" xref="S2.p1.19.m5.1.1.3.2">ℝ</ci><apply id="S2.p1.19.m5.1.1.3.3.cmml" xref="S2.p1.19.m5.1.1.3.3"><times id="S2.p1.19.m5.1.1.3.3.1.cmml" xref="S2.p1.19.m5.1.1.3.3.1"></times><ci id="S2.p1.19.m5.1.1.3.3.2.cmml" xref="S2.p1.19.m5.1.1.3.3.2">𝐻</ci><ci id="S2.p1.19.m5.1.1.3.3.3.cmml" xref="S2.p1.19.m5.1.1.3.3.3">𝑊</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.19.m5.1c">S_{a}\in\mathbb{R}^{H\times W}</annotation></semantics></math>, where each entry <math id="S2.p1.20.m6.2" class="ltx_Math" alttext="(j,k)" display="inline"><semantics id="S2.p1.20.m6.2a"><mrow id="S2.p1.20.m6.2.3.2" xref="S2.p1.20.m6.2.3.1.cmml"><mo stretchy="false" id="S2.p1.20.m6.2.3.2.1" xref="S2.p1.20.m6.2.3.1.cmml">(</mo><mi id="S2.p1.20.m6.1.1" xref="S2.p1.20.m6.1.1.cmml">j</mi><mo id="S2.p1.20.m6.2.3.2.2" xref="S2.p1.20.m6.2.3.1.cmml">,</mo><mi id="S2.p1.20.m6.2.2" xref="S2.p1.20.m6.2.2.cmml">k</mi><mo stretchy="false" id="S2.p1.20.m6.2.3.2.3" xref="S2.p1.20.m6.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.20.m6.2b"><interval closure="open" id="S2.p1.20.m6.2.3.1.cmml" xref="S2.p1.20.m6.2.3.2"><ci id="S2.p1.20.m6.1.1.cmml" xref="S2.p1.20.m6.1.1">𝑗</ci><ci id="S2.p1.20.m6.2.2.cmml" xref="S2.p1.20.m6.2.2">𝑘</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.20.m6.2c">(j,k)</annotation></semantics></math> are computed as <math id="S2.p1.21.m7.4" class="ltx_Math" alttext="P(g_{n},f^{m(j,k)}_{i})" display="inline"><semantics id="S2.p1.21.m7.4a"><mrow id="S2.p1.21.m7.4.4" xref="S2.p1.21.m7.4.4.cmml"><mi id="S2.p1.21.m7.4.4.4" xref="S2.p1.21.m7.4.4.4.cmml">P</mi><mo lspace="0em" rspace="0em" id="S2.p1.21.m7.4.4.3" xref="S2.p1.21.m7.4.4.3.cmml">​</mo><mrow id="S2.p1.21.m7.4.4.2.2" xref="S2.p1.21.m7.4.4.2.3.cmml"><mo stretchy="false" id="S2.p1.21.m7.4.4.2.2.3" xref="S2.p1.21.m7.4.4.2.3.cmml">(</mo><msub id="S2.p1.21.m7.3.3.1.1.1" xref="S2.p1.21.m7.3.3.1.1.1.cmml"><mi id="S2.p1.21.m7.3.3.1.1.1.2" xref="S2.p1.21.m7.3.3.1.1.1.2.cmml">g</mi><mi id="S2.p1.21.m7.3.3.1.1.1.3" xref="S2.p1.21.m7.3.3.1.1.1.3.cmml">n</mi></msub><mo id="S2.p1.21.m7.4.4.2.2.4" xref="S2.p1.21.m7.4.4.2.3.cmml">,</mo><msubsup id="S2.p1.21.m7.4.4.2.2.2" xref="S2.p1.21.m7.4.4.2.2.2.cmml"><mi id="S2.p1.21.m7.4.4.2.2.2.2.2" xref="S2.p1.21.m7.4.4.2.2.2.2.2.cmml">f</mi><mi id="S2.p1.21.m7.4.4.2.2.2.3" xref="S2.p1.21.m7.4.4.2.2.2.3.cmml">i</mi><mrow id="S2.p1.21.m7.2.2.2" xref="S2.p1.21.m7.2.2.2.cmml"><mi id="S2.p1.21.m7.2.2.2.4" xref="S2.p1.21.m7.2.2.2.4.cmml">m</mi><mo lspace="0em" rspace="0em" id="S2.p1.21.m7.2.2.2.3" xref="S2.p1.21.m7.2.2.2.3.cmml">​</mo><mrow id="S2.p1.21.m7.2.2.2.5.2" xref="S2.p1.21.m7.2.2.2.5.1.cmml"><mo stretchy="false" id="S2.p1.21.m7.2.2.2.5.2.1" xref="S2.p1.21.m7.2.2.2.5.1.cmml">(</mo><mi id="S2.p1.21.m7.1.1.1.1" xref="S2.p1.21.m7.1.1.1.1.cmml">j</mi><mo id="S2.p1.21.m7.2.2.2.5.2.2" xref="S2.p1.21.m7.2.2.2.5.1.cmml">,</mo><mi id="S2.p1.21.m7.2.2.2.2" xref="S2.p1.21.m7.2.2.2.2.cmml">k</mi><mo stretchy="false" id="S2.p1.21.m7.2.2.2.5.2.3" xref="S2.p1.21.m7.2.2.2.5.1.cmml">)</mo></mrow></mrow></msubsup><mo stretchy="false" id="S2.p1.21.m7.4.4.2.2.5" xref="S2.p1.21.m7.4.4.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.21.m7.4b"><apply id="S2.p1.21.m7.4.4.cmml" xref="S2.p1.21.m7.4.4"><times id="S2.p1.21.m7.4.4.3.cmml" xref="S2.p1.21.m7.4.4.3"></times><ci id="S2.p1.21.m7.4.4.4.cmml" xref="S2.p1.21.m7.4.4.4">𝑃</ci><interval closure="open" id="S2.p1.21.m7.4.4.2.3.cmml" xref="S2.p1.21.m7.4.4.2.2"><apply id="S2.p1.21.m7.3.3.1.1.1.cmml" xref="S2.p1.21.m7.3.3.1.1.1"><csymbol cd="ambiguous" id="S2.p1.21.m7.3.3.1.1.1.1.cmml" xref="S2.p1.21.m7.3.3.1.1.1">subscript</csymbol><ci id="S2.p1.21.m7.3.3.1.1.1.2.cmml" xref="S2.p1.21.m7.3.3.1.1.1.2">𝑔</ci><ci id="S2.p1.21.m7.3.3.1.1.1.3.cmml" xref="S2.p1.21.m7.3.3.1.1.1.3">𝑛</ci></apply><apply id="S2.p1.21.m7.4.4.2.2.2.cmml" xref="S2.p1.21.m7.4.4.2.2.2"><csymbol cd="ambiguous" id="S2.p1.21.m7.4.4.2.2.2.1.cmml" xref="S2.p1.21.m7.4.4.2.2.2">subscript</csymbol><apply id="S2.p1.21.m7.4.4.2.2.2.2.cmml" xref="S2.p1.21.m7.4.4.2.2.2"><csymbol cd="ambiguous" id="S2.p1.21.m7.4.4.2.2.2.2.1.cmml" xref="S2.p1.21.m7.4.4.2.2.2">superscript</csymbol><ci id="S2.p1.21.m7.4.4.2.2.2.2.2.cmml" xref="S2.p1.21.m7.4.4.2.2.2.2.2">𝑓</ci><apply id="S2.p1.21.m7.2.2.2.cmml" xref="S2.p1.21.m7.2.2.2"><times id="S2.p1.21.m7.2.2.2.3.cmml" xref="S2.p1.21.m7.2.2.2.3"></times><ci id="S2.p1.21.m7.2.2.2.4.cmml" xref="S2.p1.21.m7.2.2.2.4">𝑚</ci><interval closure="open" id="S2.p1.21.m7.2.2.2.5.1.cmml" xref="S2.p1.21.m7.2.2.2.5.2"><ci id="S2.p1.21.m7.1.1.1.1.cmml" xref="S2.p1.21.m7.1.1.1.1">𝑗</ci><ci id="S2.p1.21.m7.2.2.2.2.cmml" xref="S2.p1.21.m7.2.2.2.2">𝑘</ci></interval></apply></apply><ci id="S2.p1.21.m7.4.4.2.2.2.3.cmml" xref="S2.p1.21.m7.4.4.2.2.2.3">𝑖</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.21.m7.4c">P(g_{n},f^{m(j,k)}_{i})</annotation></semantics></math> and <math id="S2.p1.22.m8.4" class="ltx_Math" alttext="P(g_{a},f^{m(j,k)}_{i})" display="inline"><semantics id="S2.p1.22.m8.4a"><mrow id="S2.p1.22.m8.4.4" xref="S2.p1.22.m8.4.4.cmml"><mi id="S2.p1.22.m8.4.4.4" xref="S2.p1.22.m8.4.4.4.cmml">P</mi><mo lspace="0em" rspace="0em" id="S2.p1.22.m8.4.4.3" xref="S2.p1.22.m8.4.4.3.cmml">​</mo><mrow id="S2.p1.22.m8.4.4.2.2" xref="S2.p1.22.m8.4.4.2.3.cmml"><mo stretchy="false" id="S2.p1.22.m8.4.4.2.2.3" xref="S2.p1.22.m8.4.4.2.3.cmml">(</mo><msub id="S2.p1.22.m8.3.3.1.1.1" xref="S2.p1.22.m8.3.3.1.1.1.cmml"><mi id="S2.p1.22.m8.3.3.1.1.1.2" xref="S2.p1.22.m8.3.3.1.1.1.2.cmml">g</mi><mi id="S2.p1.22.m8.3.3.1.1.1.3" xref="S2.p1.22.m8.3.3.1.1.1.3.cmml">a</mi></msub><mo id="S2.p1.22.m8.4.4.2.2.4" xref="S2.p1.22.m8.4.4.2.3.cmml">,</mo><msubsup id="S2.p1.22.m8.4.4.2.2.2" xref="S2.p1.22.m8.4.4.2.2.2.cmml"><mi id="S2.p1.22.m8.4.4.2.2.2.2.2" xref="S2.p1.22.m8.4.4.2.2.2.2.2.cmml">f</mi><mi id="S2.p1.22.m8.4.4.2.2.2.3" xref="S2.p1.22.m8.4.4.2.2.2.3.cmml">i</mi><mrow id="S2.p1.22.m8.2.2.2" xref="S2.p1.22.m8.2.2.2.cmml"><mi id="S2.p1.22.m8.2.2.2.4" xref="S2.p1.22.m8.2.2.2.4.cmml">m</mi><mo lspace="0em" rspace="0em" id="S2.p1.22.m8.2.2.2.3" xref="S2.p1.22.m8.2.2.2.3.cmml">​</mo><mrow id="S2.p1.22.m8.2.2.2.5.2" xref="S2.p1.22.m8.2.2.2.5.1.cmml"><mo stretchy="false" id="S2.p1.22.m8.2.2.2.5.2.1" xref="S2.p1.22.m8.2.2.2.5.1.cmml">(</mo><mi id="S2.p1.22.m8.1.1.1.1" xref="S2.p1.22.m8.1.1.1.1.cmml">j</mi><mo id="S2.p1.22.m8.2.2.2.5.2.2" xref="S2.p1.22.m8.2.2.2.5.1.cmml">,</mo><mi id="S2.p1.22.m8.2.2.2.2" xref="S2.p1.22.m8.2.2.2.2.cmml">k</mi><mo stretchy="false" id="S2.p1.22.m8.2.2.2.5.2.3" xref="S2.p1.22.m8.2.2.2.5.1.cmml">)</mo></mrow></mrow></msubsup><mo stretchy="false" id="S2.p1.22.m8.4.4.2.2.5" xref="S2.p1.22.m8.4.4.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.22.m8.4b"><apply id="S2.p1.22.m8.4.4.cmml" xref="S2.p1.22.m8.4.4"><times id="S2.p1.22.m8.4.4.3.cmml" xref="S2.p1.22.m8.4.4.3"></times><ci id="S2.p1.22.m8.4.4.4.cmml" xref="S2.p1.22.m8.4.4.4">𝑃</ci><interval closure="open" id="S2.p1.22.m8.4.4.2.3.cmml" xref="S2.p1.22.m8.4.4.2.2"><apply id="S2.p1.22.m8.3.3.1.1.1.cmml" xref="S2.p1.22.m8.3.3.1.1.1"><csymbol cd="ambiguous" id="S2.p1.22.m8.3.3.1.1.1.1.cmml" xref="S2.p1.22.m8.3.3.1.1.1">subscript</csymbol><ci id="S2.p1.22.m8.3.3.1.1.1.2.cmml" xref="S2.p1.22.m8.3.3.1.1.1.2">𝑔</ci><ci id="S2.p1.22.m8.3.3.1.1.1.3.cmml" xref="S2.p1.22.m8.3.3.1.1.1.3">𝑎</ci></apply><apply id="S2.p1.22.m8.4.4.2.2.2.cmml" xref="S2.p1.22.m8.4.4.2.2.2"><csymbol cd="ambiguous" id="S2.p1.22.m8.4.4.2.2.2.1.cmml" xref="S2.p1.22.m8.4.4.2.2.2">subscript</csymbol><apply id="S2.p1.22.m8.4.4.2.2.2.2.cmml" xref="S2.p1.22.m8.4.4.2.2.2"><csymbol cd="ambiguous" id="S2.p1.22.m8.4.4.2.2.2.2.1.cmml" xref="S2.p1.22.m8.4.4.2.2.2">superscript</csymbol><ci id="S2.p1.22.m8.4.4.2.2.2.2.2.cmml" xref="S2.p1.22.m8.4.4.2.2.2.2.2">𝑓</ci><apply id="S2.p1.22.m8.2.2.2.cmml" xref="S2.p1.22.m8.2.2.2"><times id="S2.p1.22.m8.2.2.2.3.cmml" xref="S2.p1.22.m8.2.2.2.3"></times><ci id="S2.p1.22.m8.2.2.2.4.cmml" xref="S2.p1.22.m8.2.2.2.4">𝑚</ci><interval closure="open" id="S2.p1.22.m8.2.2.2.5.1.cmml" xref="S2.p1.22.m8.2.2.2.5.2"><ci id="S2.p1.22.m8.1.1.1.1.cmml" xref="S2.p1.22.m8.1.1.1.1">𝑗</ci><ci id="S2.p1.22.m8.2.2.2.2.cmml" xref="S2.p1.22.m8.2.2.2.2">𝑘</ci></interval></apply></apply><ci id="S2.p1.22.m8.4.4.2.2.2.3.cmml" xref="S2.p1.22.m8.4.4.2.2.2.3">𝑖</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.22.m8.4c">P(g_{a},f^{m(j,k)}_{i})</annotation></semantics></math>.</p>
</div>
<figure id="S2.F2" class="ltx_figure"><img src="/html/2310.18961/assets/x7.png" id="S2.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="422" height="261" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>Overview of AnomalyCLIP. To adapt CLIP to ZSAD, AnomalyCLIP introduces object-agnostic text prompt templates to capture generic normality and abnormality regardless of the object semantics. Then, we introduce glocal context optimization to incorporate global and fine-grained anomaly semantics into object-agnostic text prompt learning. Finally, textual prompt tuning and DPAM are used to enable the prompt learning in the textual and local visual spaces of CLIP.</figcaption>
</figure>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>AnomalyCLIP: object-agnostic prompt learning</h2>

<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Approach overview</h3>

<div id="S3.SS1.p1" class="ltx_para ltx_noindent">
<p id="S3.SS1.p1.2" class="ltx_p">In this paper, we propose AnomalyCLIP to adapt CLIP to ZSAD via object-agnostic prompt learning. As shown in Fig. <a href="#S2.F2" title="Figure 2 ‣ 2 Preliminary ‣ AnomalyCLIP: Object-agnostic Prompt Learning for Zero-shot Anomaly Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, AnomalyCLIP first introduces object-agnostic text prompt templates, where we design two generic object-agnostic text prompt templates of <math id="S3.SS1.p1.1.m1.1" class="ltx_Math" alttext="g_{n}" display="inline"><semantics id="S3.SS1.p1.1.m1.1a"><msub id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml"><mi id="S3.SS1.p1.1.m1.1.1.2" xref="S3.SS1.p1.1.m1.1.1.2.cmml">g</mi><mi id="S3.SS1.p1.1.m1.1.1.3" xref="S3.SS1.p1.1.m1.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><apply id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS1.p1.1.m1.1.1.2.cmml" xref="S3.SS1.p1.1.m1.1.1.2">𝑔</ci><ci id="S3.SS1.p1.1.m1.1.1.3.cmml" xref="S3.SS1.p1.1.m1.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">g_{n}</annotation></semantics></math> and <math id="S3.SS1.p1.2.m2.1" class="ltx_Math" alttext="g_{a}" display="inline"><semantics id="S3.SS1.p1.2.m2.1a"><msub id="S3.SS1.p1.2.m2.1.1" xref="S3.SS1.p1.2.m2.1.1.cmml"><mi id="S3.SS1.p1.2.m2.1.1.2" xref="S3.SS1.p1.2.m2.1.1.2.cmml">g</mi><mi id="S3.SS1.p1.2.m2.1.1.3" xref="S3.SS1.p1.2.m2.1.1.3.cmml">a</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.1b"><apply id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.1.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS1.p1.2.m2.1.1.2.cmml" xref="S3.SS1.p1.2.m2.1.1.2">𝑔</ci><ci id="S3.SS1.p1.2.m2.1.1.3.cmml" xref="S3.SS1.p1.2.m2.1.1.3">𝑎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.1c">g_{a}</annotation></semantics></math> to learn generalized embedding for the normality and abnormality classes, respectively (see Sec. <a href="#S3.SS2" title="3.2 Object-agnostic text prompt design ‣ 3 AnomalyCLIP: object-agnostic prompt learning ‣ AnomalyCLIP: Object-agnostic Prompt Learning for Zero-shot Anomaly Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.2</span></a>). To learn such generic text prompt templates, we introduce global and local context optimization to incorporate global and fine-grained anomaly semantics into object-agnostic textual embedding learning. In addition, textual prompt tuning and DPAM are used to support the learning in the textual and local visual spaces of CLIP. Finally, we integrate the multiple intermediate layers to provide more local visual details. During training, all modules are jointly optimized by the combination of global and local context optimization. During inference, we quantify the misalignment of textual and global/local visual embeddings to obtain the anomaly score and anomaly score map, respectively (see Sec. <a href="#S3.SS3" title="3.3 Learning generic abnormality and normality prompts ‣ 3 AnomalyCLIP: object-agnostic prompt learning ‣ AnomalyCLIP: Object-agnostic Prompt Learning for Zero-shot Anomaly Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.3</span></a>).</p>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Object-agnostic text prompt design</h3>

<div id="S3.SS2.p1" class="ltx_para ltx_noindent">
<p id="S3.SS2.p1.4" class="ltx_p">Commonly used text prompt templates in CLIP, like <code id="S3.SS2.p1.4.1" class="ltx_verbatim ltx_font_typewriter">A photo of a [cls]</code>, primarily focus on object semantics. Consequently, they fail to generate textual embeddings that capture anomaly and normal semantics to query corresponding visual embeddings. To support the learning of anomaly-discriminative textual embeddings, we aim to incorporate prior anomaly semantics into text prompt templates. A trivial solution is to design the templates with specific anomaly types, such as <code id="S3.SS2.p1.4.2" class="ltx_verbatim ltx_font_typewriter"> A photo of a [cls] with scratches</code>
However, the pattern of anomaly is typically unknown and diverse, so it is practically difficult to list all possible anomaly types. Therefore, it is important to define text prompt templates with generic anomaly semantics. For this purpose, we can adopt the text <code id="S3.SS2.p1.4.3" class="ltx_verbatim ltx_font_typewriter">damaged [cls]</code> to cover comprehensive anomaly semantics, facilitating the detection of diverse defects such as scratches and holes. Nevertheless, utilizing such text prompt templates poses challenges in generating generic anomaly-discriminating textual embeddings. This is because CLIP’s original pre-training focuses on aligning with object semantics instead of the abnormality and normality within images. To address this limitation, we can introduce learnable text prompt templates and tune the prompts using auxiliary AD-relevant data. During the fine-tuning process, these learnable templates can incorporate both broad and detailed anomaly semantics, resulting in textual embeddings that are more discriminative between normality and abnormality. This helps avoid the need for manually defined text prompt templates that require extensive engineering <cite class="ltx_cite ltx_citemacro_citep">(Jeong et al., <a href="#bib.bib20" title="" class="ltx_ref">2023</a>)</cite>.
These text prompts are referred to as <span id="S3.SS2.p1.4.4" class="ltx_text ltx_font_bold">object-aware text prompt templates</span> and defined as follows:</p>
<table id="A6.EGx1" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.Ex1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.Ex1.m1.1" class="ltx_Math" alttext="\displaystyle g_{n}" display="inline"><semantics id="S3.Ex1.m1.1a"><msub id="S3.Ex1.m1.1.1" xref="S3.Ex1.m1.1.1.cmml"><mi id="S3.Ex1.m1.1.1.2" xref="S3.Ex1.m1.1.1.2.cmml">g</mi><mi id="S3.Ex1.m1.1.1.3" xref="S3.Ex1.m1.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="S3.Ex1.m1.1b"><apply id="S3.Ex1.m1.1.1.cmml" xref="S3.Ex1.m1.1.1"><csymbol cd="ambiguous" id="S3.Ex1.m1.1.1.1.cmml" xref="S3.Ex1.m1.1.1">subscript</csymbol><ci id="S3.Ex1.m1.1.1.2.cmml" xref="S3.Ex1.m1.1.1.2">𝑔</ci><ci id="S3.Ex1.m1.1.1.3.cmml" xref="S3.Ex1.m1.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex1.m1.1c">\displaystyle g_{n}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.Ex1.m2.4" class="ltx_Math" alttext="\displaystyle=[V_{1}][V_{2}]\dots[V_{E}][cls]" display="inline"><semantics id="S3.Ex1.m2.4a"><mrow id="S3.Ex1.m2.4.4" xref="S3.Ex1.m2.4.4.cmml"><mi id="S3.Ex1.m2.4.4.6" xref="S3.Ex1.m2.4.4.6.cmml"></mi><mo id="S3.Ex1.m2.4.4.5" xref="S3.Ex1.m2.4.4.5.cmml">=</mo><mrow id="S3.Ex1.m2.4.4.4" xref="S3.Ex1.m2.4.4.4.cmml"><mrow id="S3.Ex1.m2.1.1.1.1.1" xref="S3.Ex1.m2.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.Ex1.m2.1.1.1.1.1.2" xref="S3.Ex1.m2.1.1.1.1.2.1.cmml">[</mo><msub id="S3.Ex1.m2.1.1.1.1.1.1" xref="S3.Ex1.m2.1.1.1.1.1.1.cmml"><mi id="S3.Ex1.m2.1.1.1.1.1.1.2" xref="S3.Ex1.m2.1.1.1.1.1.1.2.cmml">V</mi><mn id="S3.Ex1.m2.1.1.1.1.1.1.3" xref="S3.Ex1.m2.1.1.1.1.1.1.3.cmml">1</mn></msub><mo stretchy="false" id="S3.Ex1.m2.1.1.1.1.1.3" xref="S3.Ex1.m2.1.1.1.1.2.1.cmml">]</mo></mrow><mo lspace="0em" rspace="0em" id="S3.Ex1.m2.4.4.4.5" xref="S3.Ex1.m2.4.4.4.5.cmml">​</mo><mrow id="S3.Ex1.m2.2.2.2.2.1" xref="S3.Ex1.m2.2.2.2.2.2.cmml"><mo stretchy="false" id="S3.Ex1.m2.2.2.2.2.1.2" xref="S3.Ex1.m2.2.2.2.2.2.1.cmml">[</mo><msub id="S3.Ex1.m2.2.2.2.2.1.1" xref="S3.Ex1.m2.2.2.2.2.1.1.cmml"><mi id="S3.Ex1.m2.2.2.2.2.1.1.2" xref="S3.Ex1.m2.2.2.2.2.1.1.2.cmml">V</mi><mn id="S3.Ex1.m2.2.2.2.2.1.1.3" xref="S3.Ex1.m2.2.2.2.2.1.1.3.cmml">2</mn></msub><mo stretchy="false" id="S3.Ex1.m2.2.2.2.2.1.3" xref="S3.Ex1.m2.2.2.2.2.2.1.cmml">]</mo></mrow><mo lspace="0em" rspace="0em" id="S3.Ex1.m2.4.4.4.5a" xref="S3.Ex1.m2.4.4.4.5.cmml">​</mo><mi mathvariant="normal" id="S3.Ex1.m2.4.4.4.6" xref="S3.Ex1.m2.4.4.4.6.cmml">…</mi><mo lspace="0em" rspace="0em" id="S3.Ex1.m2.4.4.4.5b" xref="S3.Ex1.m2.4.4.4.5.cmml">​</mo><mrow id="S3.Ex1.m2.3.3.3.3.1" xref="S3.Ex1.m2.3.3.3.3.2.cmml"><mo stretchy="false" id="S3.Ex1.m2.3.3.3.3.1.2" xref="S3.Ex1.m2.3.3.3.3.2.1.cmml">[</mo><msub id="S3.Ex1.m2.3.3.3.3.1.1" xref="S3.Ex1.m2.3.3.3.3.1.1.cmml"><mi id="S3.Ex1.m2.3.3.3.3.1.1.2" xref="S3.Ex1.m2.3.3.3.3.1.1.2.cmml">V</mi><mi id="S3.Ex1.m2.3.3.3.3.1.1.3" xref="S3.Ex1.m2.3.3.3.3.1.1.3.cmml">E</mi></msub><mo stretchy="false" id="S3.Ex1.m2.3.3.3.3.1.3" xref="S3.Ex1.m2.3.3.3.3.2.1.cmml">]</mo></mrow><mo lspace="0em" rspace="0em" id="S3.Ex1.m2.4.4.4.5c" xref="S3.Ex1.m2.4.4.4.5.cmml">​</mo><mrow id="S3.Ex1.m2.4.4.4.4.1" xref="S3.Ex1.m2.4.4.4.4.2.cmml"><mo stretchy="false" id="S3.Ex1.m2.4.4.4.4.1.2" xref="S3.Ex1.m2.4.4.4.4.2.1.cmml">[</mo><mrow id="S3.Ex1.m2.4.4.4.4.1.1" xref="S3.Ex1.m2.4.4.4.4.1.1.cmml"><mi id="S3.Ex1.m2.4.4.4.4.1.1.2" xref="S3.Ex1.m2.4.4.4.4.1.1.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.Ex1.m2.4.4.4.4.1.1.1" xref="S3.Ex1.m2.4.4.4.4.1.1.1.cmml">​</mo><mi id="S3.Ex1.m2.4.4.4.4.1.1.3" xref="S3.Ex1.m2.4.4.4.4.1.1.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.Ex1.m2.4.4.4.4.1.1.1a" xref="S3.Ex1.m2.4.4.4.4.1.1.1.cmml">​</mo><mi id="S3.Ex1.m2.4.4.4.4.1.1.4" xref="S3.Ex1.m2.4.4.4.4.1.1.4.cmml">s</mi></mrow><mo stretchy="false" id="S3.Ex1.m2.4.4.4.4.1.3" xref="S3.Ex1.m2.4.4.4.4.2.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex1.m2.4b"><apply id="S3.Ex1.m2.4.4.cmml" xref="S3.Ex1.m2.4.4"><eq id="S3.Ex1.m2.4.4.5.cmml" xref="S3.Ex1.m2.4.4.5"></eq><csymbol cd="latexml" id="S3.Ex1.m2.4.4.6.cmml" xref="S3.Ex1.m2.4.4.6">absent</csymbol><apply id="S3.Ex1.m2.4.4.4.cmml" xref="S3.Ex1.m2.4.4.4"><times id="S3.Ex1.m2.4.4.4.5.cmml" xref="S3.Ex1.m2.4.4.4.5"></times><apply id="S3.Ex1.m2.1.1.1.1.2.cmml" xref="S3.Ex1.m2.1.1.1.1.1"><csymbol cd="latexml" id="S3.Ex1.m2.1.1.1.1.2.1.cmml" xref="S3.Ex1.m2.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.Ex1.m2.1.1.1.1.1.1.cmml" xref="S3.Ex1.m2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex1.m2.1.1.1.1.1.1.1.cmml" xref="S3.Ex1.m2.1.1.1.1.1.1">subscript</csymbol><ci id="S3.Ex1.m2.1.1.1.1.1.1.2.cmml" xref="S3.Ex1.m2.1.1.1.1.1.1.2">𝑉</ci><cn type="integer" id="S3.Ex1.m2.1.1.1.1.1.1.3.cmml" xref="S3.Ex1.m2.1.1.1.1.1.1.3">1</cn></apply></apply><apply id="S3.Ex1.m2.2.2.2.2.2.cmml" xref="S3.Ex1.m2.2.2.2.2.1"><csymbol cd="latexml" id="S3.Ex1.m2.2.2.2.2.2.1.cmml" xref="S3.Ex1.m2.2.2.2.2.1.2">delimited-[]</csymbol><apply id="S3.Ex1.m2.2.2.2.2.1.1.cmml" xref="S3.Ex1.m2.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.Ex1.m2.2.2.2.2.1.1.1.cmml" xref="S3.Ex1.m2.2.2.2.2.1.1">subscript</csymbol><ci id="S3.Ex1.m2.2.2.2.2.1.1.2.cmml" xref="S3.Ex1.m2.2.2.2.2.1.1.2">𝑉</ci><cn type="integer" id="S3.Ex1.m2.2.2.2.2.1.1.3.cmml" xref="S3.Ex1.m2.2.2.2.2.1.1.3">2</cn></apply></apply><ci id="S3.Ex1.m2.4.4.4.6.cmml" xref="S3.Ex1.m2.4.4.4.6">…</ci><apply id="S3.Ex1.m2.3.3.3.3.2.cmml" xref="S3.Ex1.m2.3.3.3.3.1"><csymbol cd="latexml" id="S3.Ex1.m2.3.3.3.3.2.1.cmml" xref="S3.Ex1.m2.3.3.3.3.1.2">delimited-[]</csymbol><apply id="S3.Ex1.m2.3.3.3.3.1.1.cmml" xref="S3.Ex1.m2.3.3.3.3.1.1"><csymbol cd="ambiguous" id="S3.Ex1.m2.3.3.3.3.1.1.1.cmml" xref="S3.Ex1.m2.3.3.3.3.1.1">subscript</csymbol><ci id="S3.Ex1.m2.3.3.3.3.1.1.2.cmml" xref="S3.Ex1.m2.3.3.3.3.1.1.2">𝑉</ci><ci id="S3.Ex1.m2.3.3.3.3.1.1.3.cmml" xref="S3.Ex1.m2.3.3.3.3.1.1.3">𝐸</ci></apply></apply><apply id="S3.Ex1.m2.4.4.4.4.2.cmml" xref="S3.Ex1.m2.4.4.4.4.1"><csymbol cd="latexml" id="S3.Ex1.m2.4.4.4.4.2.1.cmml" xref="S3.Ex1.m2.4.4.4.4.1.2">delimited-[]</csymbol><apply id="S3.Ex1.m2.4.4.4.4.1.1.cmml" xref="S3.Ex1.m2.4.4.4.4.1.1"><times id="S3.Ex1.m2.4.4.4.4.1.1.1.cmml" xref="S3.Ex1.m2.4.4.4.4.1.1.1"></times><ci id="S3.Ex1.m2.4.4.4.4.1.1.2.cmml" xref="S3.Ex1.m2.4.4.4.4.1.1.2">𝑐</ci><ci id="S3.Ex1.m2.4.4.4.4.1.1.3.cmml" xref="S3.Ex1.m2.4.4.4.4.1.1.3">𝑙</ci><ci id="S3.Ex1.m2.4.4.4.4.1.1.4.cmml" xref="S3.Ex1.m2.4.4.4.4.1.1.4">𝑠</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex1.m2.4c">\displaystyle=[V_{1}][V_{2}]\dots[V_{E}][cls]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S3.Ex2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.Ex2.m1.1" class="ltx_Math" alttext="\displaystyle g_{a}" display="inline"><semantics id="S3.Ex2.m1.1a"><msub id="S3.Ex2.m1.1.1" xref="S3.Ex2.m1.1.1.cmml"><mi id="S3.Ex2.m1.1.1.2" xref="S3.Ex2.m1.1.1.2.cmml">g</mi><mi id="S3.Ex2.m1.1.1.3" xref="S3.Ex2.m1.1.1.3.cmml">a</mi></msub><annotation-xml encoding="MathML-Content" id="S3.Ex2.m1.1b"><apply id="S3.Ex2.m1.1.1.cmml" xref="S3.Ex2.m1.1.1"><csymbol cd="ambiguous" id="S3.Ex2.m1.1.1.1.cmml" xref="S3.Ex2.m1.1.1">subscript</csymbol><ci id="S3.Ex2.m1.1.1.2.cmml" xref="S3.Ex2.m1.1.1.2">𝑔</ci><ci id="S3.Ex2.m1.1.1.3.cmml" xref="S3.Ex2.m1.1.1.3">𝑎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex2.m1.1c">\displaystyle g_{a}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.Ex2.m2.1" class="ltx_Math" alttext="\displaystyle=[W_{1}][W_{2}]\dots[W_{E}][damaged][cls]," display="inline"><semantics id="S3.Ex2.m2.1a"><mrow id="S3.Ex2.m2.1.1.1" xref="S3.Ex2.m2.1.1.1.1.cmml"><mrow id="S3.Ex2.m2.1.1.1.1" xref="S3.Ex2.m2.1.1.1.1.cmml"><mi id="S3.Ex2.m2.1.1.1.1.7" xref="S3.Ex2.m2.1.1.1.1.7.cmml"></mi><mo id="S3.Ex2.m2.1.1.1.1.6" xref="S3.Ex2.m2.1.1.1.1.6.cmml">=</mo><mrow id="S3.Ex2.m2.1.1.1.1.5" xref="S3.Ex2.m2.1.1.1.1.5.cmml"><mrow id="S3.Ex2.m2.1.1.1.1.1.1.1" xref="S3.Ex2.m2.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.Ex2.m2.1.1.1.1.1.1.1.2" xref="S3.Ex2.m2.1.1.1.1.1.1.2.1.cmml">[</mo><msub id="S3.Ex2.m2.1.1.1.1.1.1.1.1" xref="S3.Ex2.m2.1.1.1.1.1.1.1.1.cmml"><mi id="S3.Ex2.m2.1.1.1.1.1.1.1.1.2" xref="S3.Ex2.m2.1.1.1.1.1.1.1.1.2.cmml">W</mi><mn id="S3.Ex2.m2.1.1.1.1.1.1.1.1.3" xref="S3.Ex2.m2.1.1.1.1.1.1.1.1.3.cmml">1</mn></msub><mo stretchy="false" id="S3.Ex2.m2.1.1.1.1.1.1.1.3" xref="S3.Ex2.m2.1.1.1.1.1.1.2.1.cmml">]</mo></mrow><mo lspace="0em" rspace="0em" id="S3.Ex2.m2.1.1.1.1.5.6" xref="S3.Ex2.m2.1.1.1.1.5.6.cmml">​</mo><mrow id="S3.Ex2.m2.1.1.1.1.2.2.1" xref="S3.Ex2.m2.1.1.1.1.2.2.2.cmml"><mo stretchy="false" id="S3.Ex2.m2.1.1.1.1.2.2.1.2" xref="S3.Ex2.m2.1.1.1.1.2.2.2.1.cmml">[</mo><msub id="S3.Ex2.m2.1.1.1.1.2.2.1.1" xref="S3.Ex2.m2.1.1.1.1.2.2.1.1.cmml"><mi id="S3.Ex2.m2.1.1.1.1.2.2.1.1.2" xref="S3.Ex2.m2.1.1.1.1.2.2.1.1.2.cmml">W</mi><mn id="S3.Ex2.m2.1.1.1.1.2.2.1.1.3" xref="S3.Ex2.m2.1.1.1.1.2.2.1.1.3.cmml">2</mn></msub><mo stretchy="false" id="S3.Ex2.m2.1.1.1.1.2.2.1.3" xref="S3.Ex2.m2.1.1.1.1.2.2.2.1.cmml">]</mo></mrow><mo lspace="0em" rspace="0em" id="S3.Ex2.m2.1.1.1.1.5.6a" xref="S3.Ex2.m2.1.1.1.1.5.6.cmml">​</mo><mi mathvariant="normal" id="S3.Ex2.m2.1.1.1.1.5.7" xref="S3.Ex2.m2.1.1.1.1.5.7.cmml">…</mi><mo lspace="0em" rspace="0em" id="S3.Ex2.m2.1.1.1.1.5.6b" xref="S3.Ex2.m2.1.1.1.1.5.6.cmml">​</mo><mrow id="S3.Ex2.m2.1.1.1.1.3.3.1" xref="S3.Ex2.m2.1.1.1.1.3.3.2.cmml"><mo stretchy="false" id="S3.Ex2.m2.1.1.1.1.3.3.1.2" xref="S3.Ex2.m2.1.1.1.1.3.3.2.1.cmml">[</mo><msub id="S3.Ex2.m2.1.1.1.1.3.3.1.1" xref="S3.Ex2.m2.1.1.1.1.3.3.1.1.cmml"><mi id="S3.Ex2.m2.1.1.1.1.3.3.1.1.2" xref="S3.Ex2.m2.1.1.1.1.3.3.1.1.2.cmml">W</mi><mi id="S3.Ex2.m2.1.1.1.1.3.3.1.1.3" xref="S3.Ex2.m2.1.1.1.1.3.3.1.1.3.cmml">E</mi></msub><mo stretchy="false" id="S3.Ex2.m2.1.1.1.1.3.3.1.3" xref="S3.Ex2.m2.1.1.1.1.3.3.2.1.cmml">]</mo></mrow><mo lspace="0em" rspace="0em" id="S3.Ex2.m2.1.1.1.1.5.6c" xref="S3.Ex2.m2.1.1.1.1.5.6.cmml">​</mo><mrow id="S3.Ex2.m2.1.1.1.1.4.4.1" xref="S3.Ex2.m2.1.1.1.1.4.4.2.cmml"><mo stretchy="false" id="S3.Ex2.m2.1.1.1.1.4.4.1.2" xref="S3.Ex2.m2.1.1.1.1.4.4.2.1.cmml">[</mo><mrow id="S3.Ex2.m2.1.1.1.1.4.4.1.1" xref="S3.Ex2.m2.1.1.1.1.4.4.1.1.cmml"><mi id="S3.Ex2.m2.1.1.1.1.4.4.1.1.2" xref="S3.Ex2.m2.1.1.1.1.4.4.1.1.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="S3.Ex2.m2.1.1.1.1.4.4.1.1.1" xref="S3.Ex2.m2.1.1.1.1.4.4.1.1.1.cmml">​</mo><mi id="S3.Ex2.m2.1.1.1.1.4.4.1.1.3" xref="S3.Ex2.m2.1.1.1.1.4.4.1.1.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.Ex2.m2.1.1.1.1.4.4.1.1.1a" xref="S3.Ex2.m2.1.1.1.1.4.4.1.1.1.cmml">​</mo><mi id="S3.Ex2.m2.1.1.1.1.4.4.1.1.4" xref="S3.Ex2.m2.1.1.1.1.4.4.1.1.4.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.Ex2.m2.1.1.1.1.4.4.1.1.1b" xref="S3.Ex2.m2.1.1.1.1.4.4.1.1.1.cmml">​</mo><mi id="S3.Ex2.m2.1.1.1.1.4.4.1.1.5" xref="S3.Ex2.m2.1.1.1.1.4.4.1.1.5.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.Ex2.m2.1.1.1.1.4.4.1.1.1c" xref="S3.Ex2.m2.1.1.1.1.4.4.1.1.1.cmml">​</mo><mi id="S3.Ex2.m2.1.1.1.1.4.4.1.1.6" xref="S3.Ex2.m2.1.1.1.1.4.4.1.1.6.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.Ex2.m2.1.1.1.1.4.4.1.1.1d" xref="S3.Ex2.m2.1.1.1.1.4.4.1.1.1.cmml">​</mo><mi id="S3.Ex2.m2.1.1.1.1.4.4.1.1.7" xref="S3.Ex2.m2.1.1.1.1.4.4.1.1.7.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.Ex2.m2.1.1.1.1.4.4.1.1.1e" xref="S3.Ex2.m2.1.1.1.1.4.4.1.1.1.cmml">​</mo><mi id="S3.Ex2.m2.1.1.1.1.4.4.1.1.8" xref="S3.Ex2.m2.1.1.1.1.4.4.1.1.8.cmml">d</mi></mrow><mo stretchy="false" id="S3.Ex2.m2.1.1.1.1.4.4.1.3" xref="S3.Ex2.m2.1.1.1.1.4.4.2.1.cmml">]</mo></mrow><mo lspace="0em" rspace="0em" id="S3.Ex2.m2.1.1.1.1.5.6d" xref="S3.Ex2.m2.1.1.1.1.5.6.cmml">​</mo><mrow id="S3.Ex2.m2.1.1.1.1.5.5.1" xref="S3.Ex2.m2.1.1.1.1.5.5.2.cmml"><mo stretchy="false" id="S3.Ex2.m2.1.1.1.1.5.5.1.2" xref="S3.Ex2.m2.1.1.1.1.5.5.2.1.cmml">[</mo><mrow id="S3.Ex2.m2.1.1.1.1.5.5.1.1" xref="S3.Ex2.m2.1.1.1.1.5.5.1.1.cmml"><mi id="S3.Ex2.m2.1.1.1.1.5.5.1.1.2" xref="S3.Ex2.m2.1.1.1.1.5.5.1.1.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.Ex2.m2.1.1.1.1.5.5.1.1.1" xref="S3.Ex2.m2.1.1.1.1.5.5.1.1.1.cmml">​</mo><mi id="S3.Ex2.m2.1.1.1.1.5.5.1.1.3" xref="S3.Ex2.m2.1.1.1.1.5.5.1.1.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.Ex2.m2.1.1.1.1.5.5.1.1.1a" xref="S3.Ex2.m2.1.1.1.1.5.5.1.1.1.cmml">​</mo><mi id="S3.Ex2.m2.1.1.1.1.5.5.1.1.4" xref="S3.Ex2.m2.1.1.1.1.5.5.1.1.4.cmml">s</mi></mrow><mo stretchy="false" id="S3.Ex2.m2.1.1.1.1.5.5.1.3" xref="S3.Ex2.m2.1.1.1.1.5.5.2.1.cmml">]</mo></mrow></mrow></mrow><mo id="S3.Ex2.m2.1.1.1.2" xref="S3.Ex2.m2.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex2.m2.1b"><apply id="S3.Ex2.m2.1.1.1.1.cmml" xref="S3.Ex2.m2.1.1.1"><eq id="S3.Ex2.m2.1.1.1.1.6.cmml" xref="S3.Ex2.m2.1.1.1.1.6"></eq><csymbol cd="latexml" id="S3.Ex2.m2.1.1.1.1.7.cmml" xref="S3.Ex2.m2.1.1.1.1.7">absent</csymbol><apply id="S3.Ex2.m2.1.1.1.1.5.cmml" xref="S3.Ex2.m2.1.1.1.1.5"><times id="S3.Ex2.m2.1.1.1.1.5.6.cmml" xref="S3.Ex2.m2.1.1.1.1.5.6"></times><apply id="S3.Ex2.m2.1.1.1.1.1.1.2.cmml" xref="S3.Ex2.m2.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.Ex2.m2.1.1.1.1.1.1.2.1.cmml" xref="S3.Ex2.m2.1.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.Ex2.m2.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex2.m2.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex2.m2.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex2.m2.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.Ex2.m2.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex2.m2.1.1.1.1.1.1.1.1.2">𝑊</ci><cn type="integer" id="S3.Ex2.m2.1.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex2.m2.1.1.1.1.1.1.1.1.3">1</cn></apply></apply><apply id="S3.Ex2.m2.1.1.1.1.2.2.2.cmml" xref="S3.Ex2.m2.1.1.1.1.2.2.1"><csymbol cd="latexml" id="S3.Ex2.m2.1.1.1.1.2.2.2.1.cmml" xref="S3.Ex2.m2.1.1.1.1.2.2.1.2">delimited-[]</csymbol><apply id="S3.Ex2.m2.1.1.1.1.2.2.1.1.cmml" xref="S3.Ex2.m2.1.1.1.1.2.2.1.1"><csymbol cd="ambiguous" id="S3.Ex2.m2.1.1.1.1.2.2.1.1.1.cmml" xref="S3.Ex2.m2.1.1.1.1.2.2.1.1">subscript</csymbol><ci id="S3.Ex2.m2.1.1.1.1.2.2.1.1.2.cmml" xref="S3.Ex2.m2.1.1.1.1.2.2.1.1.2">𝑊</ci><cn type="integer" id="S3.Ex2.m2.1.1.1.1.2.2.1.1.3.cmml" xref="S3.Ex2.m2.1.1.1.1.2.2.1.1.3">2</cn></apply></apply><ci id="S3.Ex2.m2.1.1.1.1.5.7.cmml" xref="S3.Ex2.m2.1.1.1.1.5.7">…</ci><apply id="S3.Ex2.m2.1.1.1.1.3.3.2.cmml" xref="S3.Ex2.m2.1.1.1.1.3.3.1"><csymbol cd="latexml" id="S3.Ex2.m2.1.1.1.1.3.3.2.1.cmml" xref="S3.Ex2.m2.1.1.1.1.3.3.1.2">delimited-[]</csymbol><apply id="S3.Ex2.m2.1.1.1.1.3.3.1.1.cmml" xref="S3.Ex2.m2.1.1.1.1.3.3.1.1"><csymbol cd="ambiguous" id="S3.Ex2.m2.1.1.1.1.3.3.1.1.1.cmml" xref="S3.Ex2.m2.1.1.1.1.3.3.1.1">subscript</csymbol><ci id="S3.Ex2.m2.1.1.1.1.3.3.1.1.2.cmml" xref="S3.Ex2.m2.1.1.1.1.3.3.1.1.2">𝑊</ci><ci id="S3.Ex2.m2.1.1.1.1.3.3.1.1.3.cmml" xref="S3.Ex2.m2.1.1.1.1.3.3.1.1.3">𝐸</ci></apply></apply><apply id="S3.Ex2.m2.1.1.1.1.4.4.2.cmml" xref="S3.Ex2.m2.1.1.1.1.4.4.1"><csymbol cd="latexml" id="S3.Ex2.m2.1.1.1.1.4.4.2.1.cmml" xref="S3.Ex2.m2.1.1.1.1.4.4.1.2">delimited-[]</csymbol><apply id="S3.Ex2.m2.1.1.1.1.4.4.1.1.cmml" xref="S3.Ex2.m2.1.1.1.1.4.4.1.1"><times id="S3.Ex2.m2.1.1.1.1.4.4.1.1.1.cmml" xref="S3.Ex2.m2.1.1.1.1.4.4.1.1.1"></times><ci id="S3.Ex2.m2.1.1.1.1.4.4.1.1.2.cmml" xref="S3.Ex2.m2.1.1.1.1.4.4.1.1.2">𝑑</ci><ci id="S3.Ex2.m2.1.1.1.1.4.4.1.1.3.cmml" xref="S3.Ex2.m2.1.1.1.1.4.4.1.1.3">𝑎</ci><ci id="S3.Ex2.m2.1.1.1.1.4.4.1.1.4.cmml" xref="S3.Ex2.m2.1.1.1.1.4.4.1.1.4">𝑚</ci><ci id="S3.Ex2.m2.1.1.1.1.4.4.1.1.5.cmml" xref="S3.Ex2.m2.1.1.1.1.4.4.1.1.5">𝑎</ci><ci id="S3.Ex2.m2.1.1.1.1.4.4.1.1.6.cmml" xref="S3.Ex2.m2.1.1.1.1.4.4.1.1.6">𝑔</ci><ci id="S3.Ex2.m2.1.1.1.1.4.4.1.1.7.cmml" xref="S3.Ex2.m2.1.1.1.1.4.4.1.1.7">𝑒</ci><ci id="S3.Ex2.m2.1.1.1.1.4.4.1.1.8.cmml" xref="S3.Ex2.m2.1.1.1.1.4.4.1.1.8">𝑑</ci></apply></apply><apply id="S3.Ex2.m2.1.1.1.1.5.5.2.cmml" xref="S3.Ex2.m2.1.1.1.1.5.5.1"><csymbol cd="latexml" id="S3.Ex2.m2.1.1.1.1.5.5.2.1.cmml" xref="S3.Ex2.m2.1.1.1.1.5.5.1.2">delimited-[]</csymbol><apply id="S3.Ex2.m2.1.1.1.1.5.5.1.1.cmml" xref="S3.Ex2.m2.1.1.1.1.5.5.1.1"><times id="S3.Ex2.m2.1.1.1.1.5.5.1.1.1.cmml" xref="S3.Ex2.m2.1.1.1.1.5.5.1.1.1"></times><ci id="S3.Ex2.m2.1.1.1.1.5.5.1.1.2.cmml" xref="S3.Ex2.m2.1.1.1.1.5.5.1.1.2">𝑐</ci><ci id="S3.Ex2.m2.1.1.1.1.5.5.1.1.3.cmml" xref="S3.Ex2.m2.1.1.1.1.5.5.1.1.3">𝑙</ci><ci id="S3.Ex2.m2.1.1.1.1.5.5.1.1.4.cmml" xref="S3.Ex2.m2.1.1.1.1.5.5.1.1.4">𝑠</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex2.m2.1c">\displaystyle=[W_{1}][W_{2}]\dots[W_{E}][damaged][cls],</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S3.SS2.p1.3" class="ltx_p">where <math id="S3.SS2.p1.1.m1.1" class="ltx_Math" alttext="[V]_{i}" display="inline"><semantics id="S3.SS2.p1.1.m1.1a"><msub id="S3.SS2.p1.1.m1.1.2" xref="S3.SS2.p1.1.m1.1.2.cmml"><mrow id="S3.SS2.p1.1.m1.1.2.2.2" xref="S3.SS2.p1.1.m1.1.2.2.1.cmml"><mo stretchy="false" id="S3.SS2.p1.1.m1.1.2.2.2.1" xref="S3.SS2.p1.1.m1.1.2.2.1.1.cmml">[</mo><mi id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml">V</mi><mo stretchy="false" id="S3.SS2.p1.1.m1.1.2.2.2.2" xref="S3.SS2.p1.1.m1.1.2.2.1.1.cmml">]</mo></mrow><mi id="S3.SS2.p1.1.m1.1.2.3" xref="S3.SS2.p1.1.m1.1.2.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><apply id="S3.SS2.p1.1.m1.1.2.cmml" xref="S3.SS2.p1.1.m1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.1.2.1.cmml" xref="S3.SS2.p1.1.m1.1.2">subscript</csymbol><apply id="S3.SS2.p1.1.m1.1.2.2.1.cmml" xref="S3.SS2.p1.1.m1.1.2.2.2"><csymbol cd="latexml" id="S3.SS2.p1.1.m1.1.2.2.1.1.cmml" xref="S3.SS2.p1.1.m1.1.2.2.2.1">delimited-[]</csymbol><ci id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1">𝑉</ci></apply><ci id="S3.SS2.p1.1.m1.1.2.3.cmml" xref="S3.SS2.p1.1.m1.1.2.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">[V]_{i}</annotation></semantics></math> and <math id="S3.SS2.p1.2.m2.1" class="ltx_Math" alttext="[W]_{i}" display="inline"><semantics id="S3.SS2.p1.2.m2.1a"><msub id="S3.SS2.p1.2.m2.1.2" xref="S3.SS2.p1.2.m2.1.2.cmml"><mrow id="S3.SS2.p1.2.m2.1.2.2.2" xref="S3.SS2.p1.2.m2.1.2.2.1.cmml"><mo stretchy="false" id="S3.SS2.p1.2.m2.1.2.2.2.1" xref="S3.SS2.p1.2.m2.1.2.2.1.1.cmml">[</mo><mi id="S3.SS2.p1.2.m2.1.1" xref="S3.SS2.p1.2.m2.1.1.cmml">W</mi><mo stretchy="false" id="S3.SS2.p1.2.m2.1.2.2.2.2" xref="S3.SS2.p1.2.m2.1.2.2.1.1.cmml">]</mo></mrow><mi id="S3.SS2.p1.2.m2.1.2.3" xref="S3.SS2.p1.2.m2.1.2.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.1b"><apply id="S3.SS2.p1.2.m2.1.2.cmml" xref="S3.SS2.p1.2.m2.1.2"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.1.2.1.cmml" xref="S3.SS2.p1.2.m2.1.2">subscript</csymbol><apply id="S3.SS2.p1.2.m2.1.2.2.1.cmml" xref="S3.SS2.p1.2.m2.1.2.2.2"><csymbol cd="latexml" id="S3.SS2.p1.2.m2.1.2.2.1.1.cmml" xref="S3.SS2.p1.2.m2.1.2.2.2.1">delimited-[]</csymbol><ci id="S3.SS2.p1.2.m2.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1">𝑊</ci></apply><ci id="S3.SS2.p1.2.m2.1.2.3.cmml" xref="S3.SS2.p1.2.m2.1.2.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.1c">[W]_{i}</annotation></semantics></math> (<math id="S3.SS2.p1.3.m3.3" class="ltx_Math" alttext="i\in{1,\dots,E}" display="inline"><semantics id="S3.SS2.p1.3.m3.3a"><mrow id="S3.SS2.p1.3.m3.3.4" xref="S3.SS2.p1.3.m3.3.4.cmml"><mi id="S3.SS2.p1.3.m3.3.4.2" xref="S3.SS2.p1.3.m3.3.4.2.cmml">i</mi><mo id="S3.SS2.p1.3.m3.3.4.1" xref="S3.SS2.p1.3.m3.3.4.1.cmml">∈</mo><mrow id="S3.SS2.p1.3.m3.3.4.3.2" xref="S3.SS2.p1.3.m3.3.4.3.1.cmml"><mn id="S3.SS2.p1.3.m3.1.1" xref="S3.SS2.p1.3.m3.1.1.cmml">1</mn><mo id="S3.SS2.p1.3.m3.3.4.3.2.1" xref="S3.SS2.p1.3.m3.3.4.3.1.cmml">,</mo><mi mathvariant="normal" id="S3.SS2.p1.3.m3.2.2" xref="S3.SS2.p1.3.m3.2.2.cmml">…</mi><mo id="S3.SS2.p1.3.m3.3.4.3.2.2" xref="S3.SS2.p1.3.m3.3.4.3.1.cmml">,</mo><mi id="S3.SS2.p1.3.m3.3.3" xref="S3.SS2.p1.3.m3.3.3.cmml">E</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.3.m3.3b"><apply id="S3.SS2.p1.3.m3.3.4.cmml" xref="S3.SS2.p1.3.m3.3.4"><in id="S3.SS2.p1.3.m3.3.4.1.cmml" xref="S3.SS2.p1.3.m3.3.4.1"></in><ci id="S3.SS2.p1.3.m3.3.4.2.cmml" xref="S3.SS2.p1.3.m3.3.4.2">𝑖</ci><list id="S3.SS2.p1.3.m3.3.4.3.1.cmml" xref="S3.SS2.p1.3.m3.3.4.3.2"><cn type="integer" id="S3.SS2.p1.3.m3.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1">1</cn><ci id="S3.SS2.p1.3.m3.2.2.cmml" xref="S3.SS2.p1.3.m3.2.2">…</ci><ci id="S3.SS2.p1.3.m3.3.3.cmml" xref="S3.SS2.p1.3.m3.3.3">𝐸</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.3.m3.3c">i\in{1,\dots,E}</annotation></semantics></math>) are learnable word embeddings in normality and abnormality text prompt templates, respectively.</p>
</div>
<div id="S3.SS2.p2" class="ltx_para ltx_noindent">
<p id="S3.SS2.p2.2" class="ltx_p">ZSAD tasks require models to detect anomalies in previously unseen target datasets. These datasets often exhibit significant variations in object semantics among different objects, like various defects on one product vs. another, or discrepancies between industrial defects and medical imaging tumors. However, despite these substantial differences in object semantics, the underlying anomaly patterns could be similar. For instance, anomalies like scratches on metal nuts and plates, or the misplacement of transistors and PCB, as well as tumors on the surface of various organs, can share similar anomaly patterns. We hypothesize that the key of accurate ZSAD is to identify these generic anomaly patterns regardless of the varying semantics of different objects. Therefore, the inclusion of object semantics in object-aware text prompt templates is often unnecessary for ZSAD. It can even hinder the detection of anomalies in classes that have not been seen during the learning process. More importantly, excluding the object semantics from text prompt templates allows learnable text prompt templates to focus on capturing the characteristics of anomalies themselves, rather than the objects. Motivated by this, we introduce object-agnostic prompt learning, with the aim to capture generic normality and abnormality within images regardless of the object semantics. Different from object-aware text prompt templates, as shown below, the <span id="S3.SS2.p2.2.1" class="ltx_text ltx_font_bold">object-agnostic text prompt templates</span> replace the class name in <math id="S3.SS2.p2.1.m1.1" class="ltx_Math" alttext="g_{n}" display="inline"><semantics id="S3.SS2.p2.1.m1.1a"><msub id="S3.SS2.p2.1.m1.1.1" xref="S3.SS2.p2.1.m1.1.1.cmml"><mi id="S3.SS2.p2.1.m1.1.1.2" xref="S3.SS2.p2.1.m1.1.1.2.cmml">g</mi><mi id="S3.SS2.p2.1.m1.1.1.3" xref="S3.SS2.p2.1.m1.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.1.m1.1b"><apply id="S3.SS2.p2.1.m1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.1.m1.1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.p2.1.m1.1.1.2.cmml" xref="S3.SS2.p2.1.m1.1.1.2">𝑔</ci><ci id="S3.SS2.p2.1.m1.1.1.3.cmml" xref="S3.SS2.p2.1.m1.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.1.m1.1c">g_{n}</annotation></semantics></math> and <math id="S3.SS2.p2.2.m2.1" class="ltx_Math" alttext="g_{a}" display="inline"><semantics id="S3.SS2.p2.2.m2.1a"><msub id="S3.SS2.p2.2.m2.1.1" xref="S3.SS2.p2.2.m2.1.1.cmml"><mi id="S3.SS2.p2.2.m2.1.1.2" xref="S3.SS2.p2.2.m2.1.1.2.cmml">g</mi><mi id="S3.SS2.p2.2.m2.1.1.3" xref="S3.SS2.p2.2.m2.1.1.3.cmml">a</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.2.m2.1b"><apply id="S3.SS2.p2.2.m2.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.2.m2.1.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.p2.2.m2.1.1.2.cmml" xref="S3.SS2.p2.2.m2.1.1.2">𝑔</ci><ci id="S3.SS2.p2.2.m2.1.1.3.cmml" xref="S3.SS2.p2.2.m2.1.1.3">𝑎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.2.m2.1c">g_{a}</annotation></semantics></math> with <code id="S3.SS2.p2.2.2" class="ltx_verbatim ltx_font_typewriter">object</code>, blocking out the class semantics of objects:</p>
<table id="A6.EGx2" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.Ex3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.Ex3.m1.1" class="ltx_Math" alttext="\displaystyle g_{n}" display="inline"><semantics id="S3.Ex3.m1.1a"><msub id="S3.Ex3.m1.1.1" xref="S3.Ex3.m1.1.1.cmml"><mi id="S3.Ex3.m1.1.1.2" xref="S3.Ex3.m1.1.1.2.cmml">g</mi><mi id="S3.Ex3.m1.1.1.3" xref="S3.Ex3.m1.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="S3.Ex3.m1.1b"><apply id="S3.Ex3.m1.1.1.cmml" xref="S3.Ex3.m1.1.1"><csymbol cd="ambiguous" id="S3.Ex3.m1.1.1.1.cmml" xref="S3.Ex3.m1.1.1">subscript</csymbol><ci id="S3.Ex3.m1.1.1.2.cmml" xref="S3.Ex3.m1.1.1.2">𝑔</ci><ci id="S3.Ex3.m1.1.1.3.cmml" xref="S3.Ex3.m1.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex3.m1.1c">\displaystyle g_{n}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.Ex3.m2.4" class="ltx_Math" alttext="\displaystyle=[V_{1}][V_{2}]\dots[V_{E}][object]" display="inline"><semantics id="S3.Ex3.m2.4a"><mrow id="S3.Ex3.m2.4.4" xref="S3.Ex3.m2.4.4.cmml"><mi id="S3.Ex3.m2.4.4.6" xref="S3.Ex3.m2.4.4.6.cmml"></mi><mo id="S3.Ex3.m2.4.4.5" xref="S3.Ex3.m2.4.4.5.cmml">=</mo><mrow id="S3.Ex3.m2.4.4.4" xref="S3.Ex3.m2.4.4.4.cmml"><mrow id="S3.Ex3.m2.1.1.1.1.1" xref="S3.Ex3.m2.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.Ex3.m2.1.1.1.1.1.2" xref="S3.Ex3.m2.1.1.1.1.2.1.cmml">[</mo><msub id="S3.Ex3.m2.1.1.1.1.1.1" xref="S3.Ex3.m2.1.1.1.1.1.1.cmml"><mi id="S3.Ex3.m2.1.1.1.1.1.1.2" xref="S3.Ex3.m2.1.1.1.1.1.1.2.cmml">V</mi><mn id="S3.Ex3.m2.1.1.1.1.1.1.3" xref="S3.Ex3.m2.1.1.1.1.1.1.3.cmml">1</mn></msub><mo stretchy="false" id="S3.Ex3.m2.1.1.1.1.1.3" xref="S3.Ex3.m2.1.1.1.1.2.1.cmml">]</mo></mrow><mo lspace="0em" rspace="0em" id="S3.Ex3.m2.4.4.4.5" xref="S3.Ex3.m2.4.4.4.5.cmml">​</mo><mrow id="S3.Ex3.m2.2.2.2.2.1" xref="S3.Ex3.m2.2.2.2.2.2.cmml"><mo stretchy="false" id="S3.Ex3.m2.2.2.2.2.1.2" xref="S3.Ex3.m2.2.2.2.2.2.1.cmml">[</mo><msub id="S3.Ex3.m2.2.2.2.2.1.1" xref="S3.Ex3.m2.2.2.2.2.1.1.cmml"><mi id="S3.Ex3.m2.2.2.2.2.1.1.2" xref="S3.Ex3.m2.2.2.2.2.1.1.2.cmml">V</mi><mn id="S3.Ex3.m2.2.2.2.2.1.1.3" xref="S3.Ex3.m2.2.2.2.2.1.1.3.cmml">2</mn></msub><mo stretchy="false" id="S3.Ex3.m2.2.2.2.2.1.3" xref="S3.Ex3.m2.2.2.2.2.2.1.cmml">]</mo></mrow><mo lspace="0em" rspace="0em" id="S3.Ex3.m2.4.4.4.5a" xref="S3.Ex3.m2.4.4.4.5.cmml">​</mo><mi mathvariant="normal" id="S3.Ex3.m2.4.4.4.6" xref="S3.Ex3.m2.4.4.4.6.cmml">…</mi><mo lspace="0em" rspace="0em" id="S3.Ex3.m2.4.4.4.5b" xref="S3.Ex3.m2.4.4.4.5.cmml">​</mo><mrow id="S3.Ex3.m2.3.3.3.3.1" xref="S3.Ex3.m2.3.3.3.3.2.cmml"><mo stretchy="false" id="S3.Ex3.m2.3.3.3.3.1.2" xref="S3.Ex3.m2.3.3.3.3.2.1.cmml">[</mo><msub id="S3.Ex3.m2.3.3.3.3.1.1" xref="S3.Ex3.m2.3.3.3.3.1.1.cmml"><mi id="S3.Ex3.m2.3.3.3.3.1.1.2" xref="S3.Ex3.m2.3.3.3.3.1.1.2.cmml">V</mi><mi id="S3.Ex3.m2.3.3.3.3.1.1.3" xref="S3.Ex3.m2.3.3.3.3.1.1.3.cmml">E</mi></msub><mo stretchy="false" id="S3.Ex3.m2.3.3.3.3.1.3" xref="S3.Ex3.m2.3.3.3.3.2.1.cmml">]</mo></mrow><mo lspace="0em" rspace="0em" id="S3.Ex3.m2.4.4.4.5c" xref="S3.Ex3.m2.4.4.4.5.cmml">​</mo><mrow id="S3.Ex3.m2.4.4.4.4.1" xref="S3.Ex3.m2.4.4.4.4.2.cmml"><mo stretchy="false" id="S3.Ex3.m2.4.4.4.4.1.2" xref="S3.Ex3.m2.4.4.4.4.2.1.cmml">[</mo><mrow id="S3.Ex3.m2.4.4.4.4.1.1" xref="S3.Ex3.m2.4.4.4.4.1.1.cmml"><mi id="S3.Ex3.m2.4.4.4.4.1.1.2" xref="S3.Ex3.m2.4.4.4.4.1.1.2.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.Ex3.m2.4.4.4.4.1.1.1" xref="S3.Ex3.m2.4.4.4.4.1.1.1.cmml">​</mo><mi id="S3.Ex3.m2.4.4.4.4.1.1.3" xref="S3.Ex3.m2.4.4.4.4.1.1.3.cmml">b</mi><mo lspace="0em" rspace="0em" id="S3.Ex3.m2.4.4.4.4.1.1.1a" xref="S3.Ex3.m2.4.4.4.4.1.1.1.cmml">​</mo><mi id="S3.Ex3.m2.4.4.4.4.1.1.4" xref="S3.Ex3.m2.4.4.4.4.1.1.4.cmml">j</mi><mo lspace="0em" rspace="0em" id="S3.Ex3.m2.4.4.4.4.1.1.1b" xref="S3.Ex3.m2.4.4.4.4.1.1.1.cmml">​</mo><mi id="S3.Ex3.m2.4.4.4.4.1.1.5" xref="S3.Ex3.m2.4.4.4.4.1.1.5.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.Ex3.m2.4.4.4.4.1.1.1c" xref="S3.Ex3.m2.4.4.4.4.1.1.1.cmml">​</mo><mi id="S3.Ex3.m2.4.4.4.4.1.1.6" xref="S3.Ex3.m2.4.4.4.4.1.1.6.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.Ex3.m2.4.4.4.4.1.1.1d" xref="S3.Ex3.m2.4.4.4.4.1.1.1.cmml">​</mo><mi id="S3.Ex3.m2.4.4.4.4.1.1.7" xref="S3.Ex3.m2.4.4.4.4.1.1.7.cmml">t</mi></mrow><mo stretchy="false" id="S3.Ex3.m2.4.4.4.4.1.3" xref="S3.Ex3.m2.4.4.4.4.2.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex3.m2.4b"><apply id="S3.Ex3.m2.4.4.cmml" xref="S3.Ex3.m2.4.4"><eq id="S3.Ex3.m2.4.4.5.cmml" xref="S3.Ex3.m2.4.4.5"></eq><csymbol cd="latexml" id="S3.Ex3.m2.4.4.6.cmml" xref="S3.Ex3.m2.4.4.6">absent</csymbol><apply id="S3.Ex3.m2.4.4.4.cmml" xref="S3.Ex3.m2.4.4.4"><times id="S3.Ex3.m2.4.4.4.5.cmml" xref="S3.Ex3.m2.4.4.4.5"></times><apply id="S3.Ex3.m2.1.1.1.1.2.cmml" xref="S3.Ex3.m2.1.1.1.1.1"><csymbol cd="latexml" id="S3.Ex3.m2.1.1.1.1.2.1.cmml" xref="S3.Ex3.m2.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.Ex3.m2.1.1.1.1.1.1.cmml" xref="S3.Ex3.m2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex3.m2.1.1.1.1.1.1.1.cmml" xref="S3.Ex3.m2.1.1.1.1.1.1">subscript</csymbol><ci id="S3.Ex3.m2.1.1.1.1.1.1.2.cmml" xref="S3.Ex3.m2.1.1.1.1.1.1.2">𝑉</ci><cn type="integer" id="S3.Ex3.m2.1.1.1.1.1.1.3.cmml" xref="S3.Ex3.m2.1.1.1.1.1.1.3">1</cn></apply></apply><apply id="S3.Ex3.m2.2.2.2.2.2.cmml" xref="S3.Ex3.m2.2.2.2.2.1"><csymbol cd="latexml" id="S3.Ex3.m2.2.2.2.2.2.1.cmml" xref="S3.Ex3.m2.2.2.2.2.1.2">delimited-[]</csymbol><apply id="S3.Ex3.m2.2.2.2.2.1.1.cmml" xref="S3.Ex3.m2.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.Ex3.m2.2.2.2.2.1.1.1.cmml" xref="S3.Ex3.m2.2.2.2.2.1.1">subscript</csymbol><ci id="S3.Ex3.m2.2.2.2.2.1.1.2.cmml" xref="S3.Ex3.m2.2.2.2.2.1.1.2">𝑉</ci><cn type="integer" id="S3.Ex3.m2.2.2.2.2.1.1.3.cmml" xref="S3.Ex3.m2.2.2.2.2.1.1.3">2</cn></apply></apply><ci id="S3.Ex3.m2.4.4.4.6.cmml" xref="S3.Ex3.m2.4.4.4.6">…</ci><apply id="S3.Ex3.m2.3.3.3.3.2.cmml" xref="S3.Ex3.m2.3.3.3.3.1"><csymbol cd="latexml" id="S3.Ex3.m2.3.3.3.3.2.1.cmml" xref="S3.Ex3.m2.3.3.3.3.1.2">delimited-[]</csymbol><apply id="S3.Ex3.m2.3.3.3.3.1.1.cmml" xref="S3.Ex3.m2.3.3.3.3.1.1"><csymbol cd="ambiguous" id="S3.Ex3.m2.3.3.3.3.1.1.1.cmml" xref="S3.Ex3.m2.3.3.3.3.1.1">subscript</csymbol><ci id="S3.Ex3.m2.3.3.3.3.1.1.2.cmml" xref="S3.Ex3.m2.3.3.3.3.1.1.2">𝑉</ci><ci id="S3.Ex3.m2.3.3.3.3.1.1.3.cmml" xref="S3.Ex3.m2.3.3.3.3.1.1.3">𝐸</ci></apply></apply><apply id="S3.Ex3.m2.4.4.4.4.2.cmml" xref="S3.Ex3.m2.4.4.4.4.1"><csymbol cd="latexml" id="S3.Ex3.m2.4.4.4.4.2.1.cmml" xref="S3.Ex3.m2.4.4.4.4.1.2">delimited-[]</csymbol><apply id="S3.Ex3.m2.4.4.4.4.1.1.cmml" xref="S3.Ex3.m2.4.4.4.4.1.1"><times id="S3.Ex3.m2.4.4.4.4.1.1.1.cmml" xref="S3.Ex3.m2.4.4.4.4.1.1.1"></times><ci id="S3.Ex3.m2.4.4.4.4.1.1.2.cmml" xref="S3.Ex3.m2.4.4.4.4.1.1.2">𝑜</ci><ci id="S3.Ex3.m2.4.4.4.4.1.1.3.cmml" xref="S3.Ex3.m2.4.4.4.4.1.1.3">𝑏</ci><ci id="S3.Ex3.m2.4.4.4.4.1.1.4.cmml" xref="S3.Ex3.m2.4.4.4.4.1.1.4">𝑗</ci><ci id="S3.Ex3.m2.4.4.4.4.1.1.5.cmml" xref="S3.Ex3.m2.4.4.4.4.1.1.5">𝑒</ci><ci id="S3.Ex3.m2.4.4.4.4.1.1.6.cmml" xref="S3.Ex3.m2.4.4.4.4.1.1.6">𝑐</ci><ci id="S3.Ex3.m2.4.4.4.4.1.1.7.cmml" xref="S3.Ex3.m2.4.4.4.4.1.1.7">𝑡</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex3.m2.4c">\displaystyle=[V_{1}][V_{2}]\dots[V_{E}][object]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S3.Ex4"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.Ex4.m1.1" class="ltx_Math" alttext="\displaystyle g_{a}" display="inline"><semantics id="S3.Ex4.m1.1a"><msub id="S3.Ex4.m1.1.1" xref="S3.Ex4.m1.1.1.cmml"><mi id="S3.Ex4.m1.1.1.2" xref="S3.Ex4.m1.1.1.2.cmml">g</mi><mi id="S3.Ex4.m1.1.1.3" xref="S3.Ex4.m1.1.1.3.cmml">a</mi></msub><annotation-xml encoding="MathML-Content" id="S3.Ex4.m1.1b"><apply id="S3.Ex4.m1.1.1.cmml" xref="S3.Ex4.m1.1.1"><csymbol cd="ambiguous" id="S3.Ex4.m1.1.1.1.cmml" xref="S3.Ex4.m1.1.1">subscript</csymbol><ci id="S3.Ex4.m1.1.1.2.cmml" xref="S3.Ex4.m1.1.1.2">𝑔</ci><ci id="S3.Ex4.m1.1.1.3.cmml" xref="S3.Ex4.m1.1.1.3">𝑎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex4.m1.1c">\displaystyle g_{a}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.Ex4.m2.1" class="ltx_Math" alttext="\displaystyle=[W_{1}][W_{2}]\dots[W_{E}][damaged][object]." display="inline"><semantics id="S3.Ex4.m2.1a"><mrow id="S3.Ex4.m2.1.1.1" xref="S3.Ex4.m2.1.1.1.1.cmml"><mrow id="S3.Ex4.m2.1.1.1.1" xref="S3.Ex4.m2.1.1.1.1.cmml"><mi id="S3.Ex4.m2.1.1.1.1.7" xref="S3.Ex4.m2.1.1.1.1.7.cmml"></mi><mo id="S3.Ex4.m2.1.1.1.1.6" xref="S3.Ex4.m2.1.1.1.1.6.cmml">=</mo><mrow id="S3.Ex4.m2.1.1.1.1.5" xref="S3.Ex4.m2.1.1.1.1.5.cmml"><mrow id="S3.Ex4.m2.1.1.1.1.1.1.1" xref="S3.Ex4.m2.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.Ex4.m2.1.1.1.1.1.1.1.2" xref="S3.Ex4.m2.1.1.1.1.1.1.2.1.cmml">[</mo><msub id="S3.Ex4.m2.1.1.1.1.1.1.1.1" xref="S3.Ex4.m2.1.1.1.1.1.1.1.1.cmml"><mi id="S3.Ex4.m2.1.1.1.1.1.1.1.1.2" xref="S3.Ex4.m2.1.1.1.1.1.1.1.1.2.cmml">W</mi><mn id="S3.Ex4.m2.1.1.1.1.1.1.1.1.3" xref="S3.Ex4.m2.1.1.1.1.1.1.1.1.3.cmml">1</mn></msub><mo stretchy="false" id="S3.Ex4.m2.1.1.1.1.1.1.1.3" xref="S3.Ex4.m2.1.1.1.1.1.1.2.1.cmml">]</mo></mrow><mo lspace="0em" rspace="0em" id="S3.Ex4.m2.1.1.1.1.5.6" xref="S3.Ex4.m2.1.1.1.1.5.6.cmml">​</mo><mrow id="S3.Ex4.m2.1.1.1.1.2.2.1" xref="S3.Ex4.m2.1.1.1.1.2.2.2.cmml"><mo stretchy="false" id="S3.Ex4.m2.1.1.1.1.2.2.1.2" xref="S3.Ex4.m2.1.1.1.1.2.2.2.1.cmml">[</mo><msub id="S3.Ex4.m2.1.1.1.1.2.2.1.1" xref="S3.Ex4.m2.1.1.1.1.2.2.1.1.cmml"><mi id="S3.Ex4.m2.1.1.1.1.2.2.1.1.2" xref="S3.Ex4.m2.1.1.1.1.2.2.1.1.2.cmml">W</mi><mn id="S3.Ex4.m2.1.1.1.1.2.2.1.1.3" xref="S3.Ex4.m2.1.1.1.1.2.2.1.1.3.cmml">2</mn></msub><mo stretchy="false" id="S3.Ex4.m2.1.1.1.1.2.2.1.3" xref="S3.Ex4.m2.1.1.1.1.2.2.2.1.cmml">]</mo></mrow><mo lspace="0em" rspace="0em" id="S3.Ex4.m2.1.1.1.1.5.6a" xref="S3.Ex4.m2.1.1.1.1.5.6.cmml">​</mo><mi mathvariant="normal" id="S3.Ex4.m2.1.1.1.1.5.7" xref="S3.Ex4.m2.1.1.1.1.5.7.cmml">…</mi><mo lspace="0em" rspace="0em" id="S3.Ex4.m2.1.1.1.1.5.6b" xref="S3.Ex4.m2.1.1.1.1.5.6.cmml">​</mo><mrow id="S3.Ex4.m2.1.1.1.1.3.3.1" xref="S3.Ex4.m2.1.1.1.1.3.3.2.cmml"><mo stretchy="false" id="S3.Ex4.m2.1.1.1.1.3.3.1.2" xref="S3.Ex4.m2.1.1.1.1.3.3.2.1.cmml">[</mo><msub id="S3.Ex4.m2.1.1.1.1.3.3.1.1" xref="S3.Ex4.m2.1.1.1.1.3.3.1.1.cmml"><mi id="S3.Ex4.m2.1.1.1.1.3.3.1.1.2" xref="S3.Ex4.m2.1.1.1.1.3.3.1.1.2.cmml">W</mi><mi id="S3.Ex4.m2.1.1.1.1.3.3.1.1.3" xref="S3.Ex4.m2.1.1.1.1.3.3.1.1.3.cmml">E</mi></msub><mo stretchy="false" id="S3.Ex4.m2.1.1.1.1.3.3.1.3" xref="S3.Ex4.m2.1.1.1.1.3.3.2.1.cmml">]</mo></mrow><mo lspace="0em" rspace="0em" id="S3.Ex4.m2.1.1.1.1.5.6c" xref="S3.Ex4.m2.1.1.1.1.5.6.cmml">​</mo><mrow id="S3.Ex4.m2.1.1.1.1.4.4.1" xref="S3.Ex4.m2.1.1.1.1.4.4.2.cmml"><mo stretchy="false" id="S3.Ex4.m2.1.1.1.1.4.4.1.2" xref="S3.Ex4.m2.1.1.1.1.4.4.2.1.cmml">[</mo><mrow id="S3.Ex4.m2.1.1.1.1.4.4.1.1" xref="S3.Ex4.m2.1.1.1.1.4.4.1.1.cmml"><mi id="S3.Ex4.m2.1.1.1.1.4.4.1.1.2" xref="S3.Ex4.m2.1.1.1.1.4.4.1.1.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="S3.Ex4.m2.1.1.1.1.4.4.1.1.1" xref="S3.Ex4.m2.1.1.1.1.4.4.1.1.1.cmml">​</mo><mi id="S3.Ex4.m2.1.1.1.1.4.4.1.1.3" xref="S3.Ex4.m2.1.1.1.1.4.4.1.1.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.Ex4.m2.1.1.1.1.4.4.1.1.1a" xref="S3.Ex4.m2.1.1.1.1.4.4.1.1.1.cmml">​</mo><mi id="S3.Ex4.m2.1.1.1.1.4.4.1.1.4" xref="S3.Ex4.m2.1.1.1.1.4.4.1.1.4.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.Ex4.m2.1.1.1.1.4.4.1.1.1b" xref="S3.Ex4.m2.1.1.1.1.4.4.1.1.1.cmml">​</mo><mi id="S3.Ex4.m2.1.1.1.1.4.4.1.1.5" xref="S3.Ex4.m2.1.1.1.1.4.4.1.1.5.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.Ex4.m2.1.1.1.1.4.4.1.1.1c" xref="S3.Ex4.m2.1.1.1.1.4.4.1.1.1.cmml">​</mo><mi id="S3.Ex4.m2.1.1.1.1.4.4.1.1.6" xref="S3.Ex4.m2.1.1.1.1.4.4.1.1.6.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.Ex4.m2.1.1.1.1.4.4.1.1.1d" xref="S3.Ex4.m2.1.1.1.1.4.4.1.1.1.cmml">​</mo><mi id="S3.Ex4.m2.1.1.1.1.4.4.1.1.7" xref="S3.Ex4.m2.1.1.1.1.4.4.1.1.7.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.Ex4.m2.1.1.1.1.4.4.1.1.1e" xref="S3.Ex4.m2.1.1.1.1.4.4.1.1.1.cmml">​</mo><mi id="S3.Ex4.m2.1.1.1.1.4.4.1.1.8" xref="S3.Ex4.m2.1.1.1.1.4.4.1.1.8.cmml">d</mi></mrow><mo stretchy="false" id="S3.Ex4.m2.1.1.1.1.4.4.1.3" xref="S3.Ex4.m2.1.1.1.1.4.4.2.1.cmml">]</mo></mrow><mo lspace="0em" rspace="0em" id="S3.Ex4.m2.1.1.1.1.5.6d" xref="S3.Ex4.m2.1.1.1.1.5.6.cmml">​</mo><mrow id="S3.Ex4.m2.1.1.1.1.5.5.1" xref="S3.Ex4.m2.1.1.1.1.5.5.2.cmml"><mo stretchy="false" id="S3.Ex4.m2.1.1.1.1.5.5.1.2" xref="S3.Ex4.m2.1.1.1.1.5.5.2.1.cmml">[</mo><mrow id="S3.Ex4.m2.1.1.1.1.5.5.1.1" xref="S3.Ex4.m2.1.1.1.1.5.5.1.1.cmml"><mi id="S3.Ex4.m2.1.1.1.1.5.5.1.1.2" xref="S3.Ex4.m2.1.1.1.1.5.5.1.1.2.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.Ex4.m2.1.1.1.1.5.5.1.1.1" xref="S3.Ex4.m2.1.1.1.1.5.5.1.1.1.cmml">​</mo><mi id="S3.Ex4.m2.1.1.1.1.5.5.1.1.3" xref="S3.Ex4.m2.1.1.1.1.5.5.1.1.3.cmml">b</mi><mo lspace="0em" rspace="0em" id="S3.Ex4.m2.1.1.1.1.5.5.1.1.1a" xref="S3.Ex4.m2.1.1.1.1.5.5.1.1.1.cmml">​</mo><mi id="S3.Ex4.m2.1.1.1.1.5.5.1.1.4" xref="S3.Ex4.m2.1.1.1.1.5.5.1.1.4.cmml">j</mi><mo lspace="0em" rspace="0em" id="S3.Ex4.m2.1.1.1.1.5.5.1.1.1b" xref="S3.Ex4.m2.1.1.1.1.5.5.1.1.1.cmml">​</mo><mi id="S3.Ex4.m2.1.1.1.1.5.5.1.1.5" xref="S3.Ex4.m2.1.1.1.1.5.5.1.1.5.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.Ex4.m2.1.1.1.1.5.5.1.1.1c" xref="S3.Ex4.m2.1.1.1.1.5.5.1.1.1.cmml">​</mo><mi id="S3.Ex4.m2.1.1.1.1.5.5.1.1.6" xref="S3.Ex4.m2.1.1.1.1.5.5.1.1.6.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.Ex4.m2.1.1.1.1.5.5.1.1.1d" xref="S3.Ex4.m2.1.1.1.1.5.5.1.1.1.cmml">​</mo><mi id="S3.Ex4.m2.1.1.1.1.5.5.1.1.7" xref="S3.Ex4.m2.1.1.1.1.5.5.1.1.7.cmml">t</mi></mrow><mo stretchy="false" id="S3.Ex4.m2.1.1.1.1.5.5.1.3" xref="S3.Ex4.m2.1.1.1.1.5.5.2.1.cmml">]</mo></mrow></mrow></mrow><mo lspace="0em" id="S3.Ex4.m2.1.1.1.2" xref="S3.Ex4.m2.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex4.m2.1b"><apply id="S3.Ex4.m2.1.1.1.1.cmml" xref="S3.Ex4.m2.1.1.1"><eq id="S3.Ex4.m2.1.1.1.1.6.cmml" xref="S3.Ex4.m2.1.1.1.1.6"></eq><csymbol cd="latexml" id="S3.Ex4.m2.1.1.1.1.7.cmml" xref="S3.Ex4.m2.1.1.1.1.7">absent</csymbol><apply id="S3.Ex4.m2.1.1.1.1.5.cmml" xref="S3.Ex4.m2.1.1.1.1.5"><times id="S3.Ex4.m2.1.1.1.1.5.6.cmml" xref="S3.Ex4.m2.1.1.1.1.5.6"></times><apply id="S3.Ex4.m2.1.1.1.1.1.1.2.cmml" xref="S3.Ex4.m2.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.Ex4.m2.1.1.1.1.1.1.2.1.cmml" xref="S3.Ex4.m2.1.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.Ex4.m2.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex4.m2.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex4.m2.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex4.m2.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.Ex4.m2.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex4.m2.1.1.1.1.1.1.1.1.2">𝑊</ci><cn type="integer" id="S3.Ex4.m2.1.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex4.m2.1.1.1.1.1.1.1.1.3">1</cn></apply></apply><apply id="S3.Ex4.m2.1.1.1.1.2.2.2.cmml" xref="S3.Ex4.m2.1.1.1.1.2.2.1"><csymbol cd="latexml" id="S3.Ex4.m2.1.1.1.1.2.2.2.1.cmml" xref="S3.Ex4.m2.1.1.1.1.2.2.1.2">delimited-[]</csymbol><apply id="S3.Ex4.m2.1.1.1.1.2.2.1.1.cmml" xref="S3.Ex4.m2.1.1.1.1.2.2.1.1"><csymbol cd="ambiguous" id="S3.Ex4.m2.1.1.1.1.2.2.1.1.1.cmml" xref="S3.Ex4.m2.1.1.1.1.2.2.1.1">subscript</csymbol><ci id="S3.Ex4.m2.1.1.1.1.2.2.1.1.2.cmml" xref="S3.Ex4.m2.1.1.1.1.2.2.1.1.2">𝑊</ci><cn type="integer" id="S3.Ex4.m2.1.1.1.1.2.2.1.1.3.cmml" xref="S3.Ex4.m2.1.1.1.1.2.2.1.1.3">2</cn></apply></apply><ci id="S3.Ex4.m2.1.1.1.1.5.7.cmml" xref="S3.Ex4.m2.1.1.1.1.5.7">…</ci><apply id="S3.Ex4.m2.1.1.1.1.3.3.2.cmml" xref="S3.Ex4.m2.1.1.1.1.3.3.1"><csymbol cd="latexml" id="S3.Ex4.m2.1.1.1.1.3.3.2.1.cmml" xref="S3.Ex4.m2.1.1.1.1.3.3.1.2">delimited-[]</csymbol><apply id="S3.Ex4.m2.1.1.1.1.3.3.1.1.cmml" xref="S3.Ex4.m2.1.1.1.1.3.3.1.1"><csymbol cd="ambiguous" id="S3.Ex4.m2.1.1.1.1.3.3.1.1.1.cmml" xref="S3.Ex4.m2.1.1.1.1.3.3.1.1">subscript</csymbol><ci id="S3.Ex4.m2.1.1.1.1.3.3.1.1.2.cmml" xref="S3.Ex4.m2.1.1.1.1.3.3.1.1.2">𝑊</ci><ci id="S3.Ex4.m2.1.1.1.1.3.3.1.1.3.cmml" xref="S3.Ex4.m2.1.1.1.1.3.3.1.1.3">𝐸</ci></apply></apply><apply id="S3.Ex4.m2.1.1.1.1.4.4.2.cmml" xref="S3.Ex4.m2.1.1.1.1.4.4.1"><csymbol cd="latexml" id="S3.Ex4.m2.1.1.1.1.4.4.2.1.cmml" xref="S3.Ex4.m2.1.1.1.1.4.4.1.2">delimited-[]</csymbol><apply id="S3.Ex4.m2.1.1.1.1.4.4.1.1.cmml" xref="S3.Ex4.m2.1.1.1.1.4.4.1.1"><times id="S3.Ex4.m2.1.1.1.1.4.4.1.1.1.cmml" xref="S3.Ex4.m2.1.1.1.1.4.4.1.1.1"></times><ci id="S3.Ex4.m2.1.1.1.1.4.4.1.1.2.cmml" xref="S3.Ex4.m2.1.1.1.1.4.4.1.1.2">𝑑</ci><ci id="S3.Ex4.m2.1.1.1.1.4.4.1.1.3.cmml" xref="S3.Ex4.m2.1.1.1.1.4.4.1.1.3">𝑎</ci><ci id="S3.Ex4.m2.1.1.1.1.4.4.1.1.4.cmml" xref="S3.Ex4.m2.1.1.1.1.4.4.1.1.4">𝑚</ci><ci id="S3.Ex4.m2.1.1.1.1.4.4.1.1.5.cmml" xref="S3.Ex4.m2.1.1.1.1.4.4.1.1.5">𝑎</ci><ci id="S3.Ex4.m2.1.1.1.1.4.4.1.1.6.cmml" xref="S3.Ex4.m2.1.1.1.1.4.4.1.1.6">𝑔</ci><ci id="S3.Ex4.m2.1.1.1.1.4.4.1.1.7.cmml" xref="S3.Ex4.m2.1.1.1.1.4.4.1.1.7">𝑒</ci><ci id="S3.Ex4.m2.1.1.1.1.4.4.1.1.8.cmml" xref="S3.Ex4.m2.1.1.1.1.4.4.1.1.8">𝑑</ci></apply></apply><apply id="S3.Ex4.m2.1.1.1.1.5.5.2.cmml" xref="S3.Ex4.m2.1.1.1.1.5.5.1"><csymbol cd="latexml" id="S3.Ex4.m2.1.1.1.1.5.5.2.1.cmml" xref="S3.Ex4.m2.1.1.1.1.5.5.1.2">delimited-[]</csymbol><apply id="S3.Ex4.m2.1.1.1.1.5.5.1.1.cmml" xref="S3.Ex4.m2.1.1.1.1.5.5.1.1"><times id="S3.Ex4.m2.1.1.1.1.5.5.1.1.1.cmml" xref="S3.Ex4.m2.1.1.1.1.5.5.1.1.1"></times><ci id="S3.Ex4.m2.1.1.1.1.5.5.1.1.2.cmml" xref="S3.Ex4.m2.1.1.1.1.5.5.1.1.2">𝑜</ci><ci id="S3.Ex4.m2.1.1.1.1.5.5.1.1.3.cmml" xref="S3.Ex4.m2.1.1.1.1.5.5.1.1.3">𝑏</ci><ci id="S3.Ex4.m2.1.1.1.1.5.5.1.1.4.cmml" xref="S3.Ex4.m2.1.1.1.1.5.5.1.1.4">𝑗</ci><ci id="S3.Ex4.m2.1.1.1.1.5.5.1.1.5.cmml" xref="S3.Ex4.m2.1.1.1.1.5.5.1.1.5">𝑒</ci><ci id="S3.Ex4.m2.1.1.1.1.5.5.1.1.6.cmml" xref="S3.Ex4.m2.1.1.1.1.5.5.1.1.6">𝑐</ci><ci id="S3.Ex4.m2.1.1.1.1.5.5.1.1.7.cmml" xref="S3.Ex4.m2.1.1.1.1.5.5.1.1.7">𝑡</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex4.m2.1c">\displaystyle=[W_{1}][W_{2}]\dots[W_{E}][damaged][object].</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S3.SS2.p2.3" class="ltx_p">This design empowers the object-agnostic text prompt template to learn the shared patterns of different anomalies. As a result, the generated textual embeddings are more generic and capable of identifying anomalies across diverse objects and different domains. Further, this prompt design is versatile and can be applied to different target domains without any modification, <em id="S3.SS2.p2.3.1" class="ltx_emph ltx_font_italic">e.g.</em>, requiring no knowledge about the object name or anomaly types in a target dataset.</p>
</div>
</section>
<section id="S3.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Learning generic abnormality and normality prompts</h3>

<section id="S3.SS3.SSS0.Px1" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Glocal context optimization</h5>

<div id="S3.SS3.SSS0.Px1.p1" class="ltx_para ltx_noindent">
<p id="S3.SS3.SSS0.Px1.p1.3" class="ltx_p">To effectively learn the object-agnostic text prompts, we devise a joint optimization approach that enables the normality and abnormality prompt learning from both global and local perspectives, namely global and local context optimization.
The global context optimization
aims to enforce that our object-agnostic textual embeddings are matched with the global visual embeddings of images of diverse objects. This helps effectively capture the normal/abnormal semantics from a global feature perspective. The local context optimization is introduced to enable object-agnostic text prompts to concentrate on fine-grained, local abnormal regions from <math id="S3.SS3.SSS0.Px1.p1.1.m1.1" class="ltx_Math" alttext="M" display="inline"><semantics id="S3.SS3.SSS0.Px1.p1.1.m1.1a"><mi id="S3.SS3.SSS0.Px1.p1.1.m1.1.1" xref="S3.SS3.SSS0.Px1.p1.1.m1.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p1.1.m1.1b"><ci id="S3.SS3.SSS0.Px1.p1.1.m1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.1.m1.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p1.1.m1.1c">M</annotation></semantics></math> intermediate layers of the visual encoder, in addition to the global normal/abnormal features. Formally, let <math id="S3.SS3.SSS0.Px1.p1.2.m2.1" class="ltx_Math" alttext="\mathcal{M}" display="inline"><semantics id="S3.SS3.SSS0.Px1.p1.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSS0.Px1.p1.2.m2.1.1" xref="S3.SS3.SSS0.Px1.p1.2.m2.1.1.cmml">ℳ</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p1.2.m2.1b"><ci id="S3.SS3.SSS0.Px1.p1.2.m2.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.2.m2.1.1">ℳ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p1.2.m2.1c">\mathcal{M}</annotation></semantics></math> be the set of intermediate layers used (<em id="S3.SS3.SSS0.Px1.p1.3.1" class="ltx_emph ltx_font_italic">i.e.</em>, <math id="S3.SS3.SSS0.Px1.p1.3.m3.1" class="ltx_Math" alttext="M=|\mathcal{M}|" display="inline"><semantics id="S3.SS3.SSS0.Px1.p1.3.m3.1a"><mrow id="S3.SS3.SSS0.Px1.p1.3.m3.1.2" xref="S3.SS3.SSS0.Px1.p1.3.m3.1.2.cmml"><mi id="S3.SS3.SSS0.Px1.p1.3.m3.1.2.2" xref="S3.SS3.SSS0.Px1.p1.3.m3.1.2.2.cmml">M</mi><mo id="S3.SS3.SSS0.Px1.p1.3.m3.1.2.1" xref="S3.SS3.SSS0.Px1.p1.3.m3.1.2.1.cmml">=</mo><mrow id="S3.SS3.SSS0.Px1.p1.3.m3.1.2.3.2" xref="S3.SS3.SSS0.Px1.p1.3.m3.1.2.3.1.cmml"><mo stretchy="false" id="S3.SS3.SSS0.Px1.p1.3.m3.1.2.3.2.1" xref="S3.SS3.SSS0.Px1.p1.3.m3.1.2.3.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSS0.Px1.p1.3.m3.1.1" xref="S3.SS3.SSS0.Px1.p1.3.m3.1.1.cmml">ℳ</mi><mo stretchy="false" id="S3.SS3.SSS0.Px1.p1.3.m3.1.2.3.2.2" xref="S3.SS3.SSS0.Px1.p1.3.m3.1.2.3.1.1.cmml">|</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p1.3.m3.1b"><apply id="S3.SS3.SSS0.Px1.p1.3.m3.1.2.cmml" xref="S3.SS3.SSS0.Px1.p1.3.m3.1.2"><eq id="S3.SS3.SSS0.Px1.p1.3.m3.1.2.1.cmml" xref="S3.SS3.SSS0.Px1.p1.3.m3.1.2.1"></eq><ci id="S3.SS3.SSS0.Px1.p1.3.m3.1.2.2.cmml" xref="S3.SS3.SSS0.Px1.p1.3.m3.1.2.2">𝑀</ci><apply id="S3.SS3.SSS0.Px1.p1.3.m3.1.2.3.1.cmml" xref="S3.SS3.SSS0.Px1.p1.3.m3.1.2.3.2"><abs id="S3.SS3.SSS0.Px1.p1.3.m3.1.2.3.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.3.m3.1.2.3.2.1"></abs><ci id="S3.SS3.SSS0.Px1.p1.3.m3.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.3.m3.1.1">ℳ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p1.3.m3.1c">M=|\mathcal{M}|</annotation></semantics></math>), our text prompts are learned by minimizing the following glocal loss function:</p>
<table id="A6.EGx3" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E2.m1.1" class="ltx_Math" alttext="\displaystyle L_{total}=L_{global}+\lambda\textstyle\sum_{M_{k}\in\mathcal{M}}L_{local}^{M_{k}}," display="inline"><semantics id="S3.E2.m1.1a"><mrow id="S3.E2.m1.1.1.1" xref="S3.E2.m1.1.1.1.1.cmml"><mrow id="S3.E2.m1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.cmml"><msub id="S3.E2.m1.1.1.1.1.2" xref="S3.E2.m1.1.1.1.1.2.cmml"><mi id="S3.E2.m1.1.1.1.1.2.2" xref="S3.E2.m1.1.1.1.1.2.2.cmml">L</mi><mrow id="S3.E2.m1.1.1.1.1.2.3" xref="S3.E2.m1.1.1.1.1.2.3.cmml"><mi id="S3.E2.m1.1.1.1.1.2.3.2" xref="S3.E2.m1.1.1.1.1.2.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.1.1.1.1.2.3.1" xref="S3.E2.m1.1.1.1.1.2.3.1.cmml">​</mo><mi id="S3.E2.m1.1.1.1.1.2.3.3" xref="S3.E2.m1.1.1.1.1.2.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.1.1.1.1.2.3.1a" xref="S3.E2.m1.1.1.1.1.2.3.1.cmml">​</mo><mi id="S3.E2.m1.1.1.1.1.2.3.4" xref="S3.E2.m1.1.1.1.1.2.3.4.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.1.1.1.1.2.3.1b" xref="S3.E2.m1.1.1.1.1.2.3.1.cmml">​</mo><mi id="S3.E2.m1.1.1.1.1.2.3.5" xref="S3.E2.m1.1.1.1.1.2.3.5.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.1.1.1.1.2.3.1c" xref="S3.E2.m1.1.1.1.1.2.3.1.cmml">​</mo><mi id="S3.E2.m1.1.1.1.1.2.3.6" xref="S3.E2.m1.1.1.1.1.2.3.6.cmml">l</mi></mrow></msub><mo id="S3.E2.m1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.cmml">=</mo><mrow id="S3.E2.m1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.3.cmml"><msub id="S3.E2.m1.1.1.1.1.3.2" xref="S3.E2.m1.1.1.1.1.3.2.cmml"><mi id="S3.E2.m1.1.1.1.1.3.2.2" xref="S3.E2.m1.1.1.1.1.3.2.2.cmml">L</mi><mrow id="S3.E2.m1.1.1.1.1.3.2.3" xref="S3.E2.m1.1.1.1.1.3.2.3.cmml"><mi id="S3.E2.m1.1.1.1.1.3.2.3.2" xref="S3.E2.m1.1.1.1.1.3.2.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.1.1.1.1.3.2.3.1" xref="S3.E2.m1.1.1.1.1.3.2.3.1.cmml">​</mo><mi id="S3.E2.m1.1.1.1.1.3.2.3.3" xref="S3.E2.m1.1.1.1.1.3.2.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.1.1.1.1.3.2.3.1a" xref="S3.E2.m1.1.1.1.1.3.2.3.1.cmml">​</mo><mi id="S3.E2.m1.1.1.1.1.3.2.3.4" xref="S3.E2.m1.1.1.1.1.3.2.3.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.1.1.1.1.3.2.3.1b" xref="S3.E2.m1.1.1.1.1.3.2.3.1.cmml">​</mo><mi id="S3.E2.m1.1.1.1.1.3.2.3.5" xref="S3.E2.m1.1.1.1.1.3.2.3.5.cmml">b</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.1.1.1.1.3.2.3.1c" xref="S3.E2.m1.1.1.1.1.3.2.3.1.cmml">​</mo><mi id="S3.E2.m1.1.1.1.1.3.2.3.6" xref="S3.E2.m1.1.1.1.1.3.2.3.6.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.1.1.1.1.3.2.3.1d" xref="S3.E2.m1.1.1.1.1.3.2.3.1.cmml">​</mo><mi id="S3.E2.m1.1.1.1.1.3.2.3.7" xref="S3.E2.m1.1.1.1.1.3.2.3.7.cmml">l</mi></mrow></msub><mo id="S3.E2.m1.1.1.1.1.3.1" xref="S3.E2.m1.1.1.1.1.3.1.cmml">+</mo><mrow id="S3.E2.m1.1.1.1.1.3.3" xref="S3.E2.m1.1.1.1.1.3.3.cmml"><mi id="S3.E2.m1.1.1.1.1.3.3.2" xref="S3.E2.m1.1.1.1.1.3.3.2.cmml">λ</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.1.1.1.1.3.3.1" xref="S3.E2.m1.1.1.1.1.3.3.1.cmml">​</mo><mrow id="S3.E2.m1.1.1.1.1.3.3.3" xref="S3.E2.m1.1.1.1.1.3.3.3.cmml"><msub id="S3.E2.m1.1.1.1.1.3.3.3.1" xref="S3.E2.m1.1.1.1.1.3.3.3.1.cmml"><mo id="S3.E2.m1.1.1.1.1.3.3.3.1.2" xref="S3.E2.m1.1.1.1.1.3.3.3.1.2.cmml">∑</mo><mrow id="S3.E2.m1.1.1.1.1.3.3.3.1.3" xref="S3.E2.m1.1.1.1.1.3.3.3.1.3.cmml"><msub id="S3.E2.m1.1.1.1.1.3.3.3.1.3.2" xref="S3.E2.m1.1.1.1.1.3.3.3.1.3.2.cmml"><mi id="S3.E2.m1.1.1.1.1.3.3.3.1.3.2.2" xref="S3.E2.m1.1.1.1.1.3.3.3.1.3.2.2.cmml">M</mi><mi id="S3.E2.m1.1.1.1.1.3.3.3.1.3.2.3" xref="S3.E2.m1.1.1.1.1.3.3.3.1.3.2.3.cmml">k</mi></msub><mo id="S3.E2.m1.1.1.1.1.3.3.3.1.3.1" xref="S3.E2.m1.1.1.1.1.3.3.3.1.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.E2.m1.1.1.1.1.3.3.3.1.3.3" xref="S3.E2.m1.1.1.1.1.3.3.3.1.3.3.cmml">ℳ</mi></mrow></msub><msubsup id="S3.E2.m1.1.1.1.1.3.3.3.2" xref="S3.E2.m1.1.1.1.1.3.3.3.2.cmml"><mi id="S3.E2.m1.1.1.1.1.3.3.3.2.2.2" xref="S3.E2.m1.1.1.1.1.3.3.3.2.2.2.cmml">L</mi><mrow id="S3.E2.m1.1.1.1.1.3.3.3.2.2.3" xref="S3.E2.m1.1.1.1.1.3.3.3.2.2.3.cmml"><mi id="S3.E2.m1.1.1.1.1.3.3.3.2.2.3.2" xref="S3.E2.m1.1.1.1.1.3.3.3.2.2.3.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.1.1.1.1.3.3.3.2.2.3.1" xref="S3.E2.m1.1.1.1.1.3.3.3.2.2.3.1.cmml">​</mo><mi id="S3.E2.m1.1.1.1.1.3.3.3.2.2.3.3" xref="S3.E2.m1.1.1.1.1.3.3.3.2.2.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.1.1.1.1.3.3.3.2.2.3.1a" xref="S3.E2.m1.1.1.1.1.3.3.3.2.2.3.1.cmml">​</mo><mi id="S3.E2.m1.1.1.1.1.3.3.3.2.2.3.4" xref="S3.E2.m1.1.1.1.1.3.3.3.2.2.3.4.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.1.1.1.1.3.3.3.2.2.3.1b" xref="S3.E2.m1.1.1.1.1.3.3.3.2.2.3.1.cmml">​</mo><mi id="S3.E2.m1.1.1.1.1.3.3.3.2.2.3.5" xref="S3.E2.m1.1.1.1.1.3.3.3.2.2.3.5.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.1.1.1.1.3.3.3.2.2.3.1c" xref="S3.E2.m1.1.1.1.1.3.3.3.2.2.3.1.cmml">​</mo><mi id="S3.E2.m1.1.1.1.1.3.3.3.2.2.3.6" xref="S3.E2.m1.1.1.1.1.3.3.3.2.2.3.6.cmml">l</mi></mrow><msub id="S3.E2.m1.1.1.1.1.3.3.3.2.3" xref="S3.E2.m1.1.1.1.1.3.3.3.2.3.cmml"><mi id="S3.E2.m1.1.1.1.1.3.3.3.2.3.2" xref="S3.E2.m1.1.1.1.1.3.3.3.2.3.2.cmml">M</mi><mi id="S3.E2.m1.1.1.1.1.3.3.3.2.3.3" xref="S3.E2.m1.1.1.1.1.3.3.3.2.3.3.cmml">k</mi></msub></msubsup></mrow></mrow></mrow></mrow><mo id="S3.E2.m1.1.1.1.2" xref="S3.E2.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.1b"><apply id="S3.E2.m1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1"><eq id="S3.E2.m1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1"></eq><apply id="S3.E2.m1.1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.2.1.cmml" xref="S3.E2.m1.1.1.1.1.2">subscript</csymbol><ci id="S3.E2.m1.1.1.1.1.2.2.cmml" xref="S3.E2.m1.1.1.1.1.2.2">𝐿</ci><apply id="S3.E2.m1.1.1.1.1.2.3.cmml" xref="S3.E2.m1.1.1.1.1.2.3"><times id="S3.E2.m1.1.1.1.1.2.3.1.cmml" xref="S3.E2.m1.1.1.1.1.2.3.1"></times><ci id="S3.E2.m1.1.1.1.1.2.3.2.cmml" xref="S3.E2.m1.1.1.1.1.2.3.2">𝑡</ci><ci id="S3.E2.m1.1.1.1.1.2.3.3.cmml" xref="S3.E2.m1.1.1.1.1.2.3.3">𝑜</ci><ci id="S3.E2.m1.1.1.1.1.2.3.4.cmml" xref="S3.E2.m1.1.1.1.1.2.3.4">𝑡</ci><ci id="S3.E2.m1.1.1.1.1.2.3.5.cmml" xref="S3.E2.m1.1.1.1.1.2.3.5">𝑎</ci><ci id="S3.E2.m1.1.1.1.1.2.3.6.cmml" xref="S3.E2.m1.1.1.1.1.2.3.6">𝑙</ci></apply></apply><apply id="S3.E2.m1.1.1.1.1.3.cmml" xref="S3.E2.m1.1.1.1.1.3"><plus id="S3.E2.m1.1.1.1.1.3.1.cmml" xref="S3.E2.m1.1.1.1.1.3.1"></plus><apply id="S3.E2.m1.1.1.1.1.3.2.cmml" xref="S3.E2.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.3.2.1.cmml" xref="S3.E2.m1.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E2.m1.1.1.1.1.3.2.2.cmml" xref="S3.E2.m1.1.1.1.1.3.2.2">𝐿</ci><apply id="S3.E2.m1.1.1.1.1.3.2.3.cmml" xref="S3.E2.m1.1.1.1.1.3.2.3"><times id="S3.E2.m1.1.1.1.1.3.2.3.1.cmml" xref="S3.E2.m1.1.1.1.1.3.2.3.1"></times><ci id="S3.E2.m1.1.1.1.1.3.2.3.2.cmml" xref="S3.E2.m1.1.1.1.1.3.2.3.2">𝑔</ci><ci id="S3.E2.m1.1.1.1.1.3.2.3.3.cmml" xref="S3.E2.m1.1.1.1.1.3.2.3.3">𝑙</ci><ci id="S3.E2.m1.1.1.1.1.3.2.3.4.cmml" xref="S3.E2.m1.1.1.1.1.3.2.3.4">𝑜</ci><ci id="S3.E2.m1.1.1.1.1.3.2.3.5.cmml" xref="S3.E2.m1.1.1.1.1.3.2.3.5">𝑏</ci><ci id="S3.E2.m1.1.1.1.1.3.2.3.6.cmml" xref="S3.E2.m1.1.1.1.1.3.2.3.6">𝑎</ci><ci id="S3.E2.m1.1.1.1.1.3.2.3.7.cmml" xref="S3.E2.m1.1.1.1.1.3.2.3.7">𝑙</ci></apply></apply><apply id="S3.E2.m1.1.1.1.1.3.3.cmml" xref="S3.E2.m1.1.1.1.1.3.3"><times id="S3.E2.m1.1.1.1.1.3.3.1.cmml" xref="S3.E2.m1.1.1.1.1.3.3.1"></times><ci id="S3.E2.m1.1.1.1.1.3.3.2.cmml" xref="S3.E2.m1.1.1.1.1.3.3.2">𝜆</ci><apply id="S3.E2.m1.1.1.1.1.3.3.3.cmml" xref="S3.E2.m1.1.1.1.1.3.3.3"><apply id="S3.E2.m1.1.1.1.1.3.3.3.1.cmml" xref="S3.E2.m1.1.1.1.1.3.3.3.1"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.3.3.3.1.1.cmml" xref="S3.E2.m1.1.1.1.1.3.3.3.1">subscript</csymbol><sum id="S3.E2.m1.1.1.1.1.3.3.3.1.2.cmml" xref="S3.E2.m1.1.1.1.1.3.3.3.1.2"></sum><apply id="S3.E2.m1.1.1.1.1.3.3.3.1.3.cmml" xref="S3.E2.m1.1.1.1.1.3.3.3.1.3"><in id="S3.E2.m1.1.1.1.1.3.3.3.1.3.1.cmml" xref="S3.E2.m1.1.1.1.1.3.3.3.1.3.1"></in><apply id="S3.E2.m1.1.1.1.1.3.3.3.1.3.2.cmml" xref="S3.E2.m1.1.1.1.1.3.3.3.1.3.2"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.3.3.3.1.3.2.1.cmml" xref="S3.E2.m1.1.1.1.1.3.3.3.1.3.2">subscript</csymbol><ci id="S3.E2.m1.1.1.1.1.3.3.3.1.3.2.2.cmml" xref="S3.E2.m1.1.1.1.1.3.3.3.1.3.2.2">𝑀</ci><ci id="S3.E2.m1.1.1.1.1.3.3.3.1.3.2.3.cmml" xref="S3.E2.m1.1.1.1.1.3.3.3.1.3.2.3">𝑘</ci></apply><ci id="S3.E2.m1.1.1.1.1.3.3.3.1.3.3.cmml" xref="S3.E2.m1.1.1.1.1.3.3.3.1.3.3">ℳ</ci></apply></apply><apply id="S3.E2.m1.1.1.1.1.3.3.3.2.cmml" xref="S3.E2.m1.1.1.1.1.3.3.3.2"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.3.3.3.2.1.cmml" xref="S3.E2.m1.1.1.1.1.3.3.3.2">superscript</csymbol><apply id="S3.E2.m1.1.1.1.1.3.3.3.2.2.cmml" xref="S3.E2.m1.1.1.1.1.3.3.3.2"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.3.3.3.2.2.1.cmml" xref="S3.E2.m1.1.1.1.1.3.3.3.2">subscript</csymbol><ci id="S3.E2.m1.1.1.1.1.3.3.3.2.2.2.cmml" xref="S3.E2.m1.1.1.1.1.3.3.3.2.2.2">𝐿</ci><apply id="S3.E2.m1.1.1.1.1.3.3.3.2.2.3.cmml" xref="S3.E2.m1.1.1.1.1.3.3.3.2.2.3"><times id="S3.E2.m1.1.1.1.1.3.3.3.2.2.3.1.cmml" xref="S3.E2.m1.1.1.1.1.3.3.3.2.2.3.1"></times><ci id="S3.E2.m1.1.1.1.1.3.3.3.2.2.3.2.cmml" xref="S3.E2.m1.1.1.1.1.3.3.3.2.2.3.2">𝑙</ci><ci id="S3.E2.m1.1.1.1.1.3.3.3.2.2.3.3.cmml" xref="S3.E2.m1.1.1.1.1.3.3.3.2.2.3.3">𝑜</ci><ci id="S3.E2.m1.1.1.1.1.3.3.3.2.2.3.4.cmml" xref="S3.E2.m1.1.1.1.1.3.3.3.2.2.3.4">𝑐</ci><ci id="S3.E2.m1.1.1.1.1.3.3.3.2.2.3.5.cmml" xref="S3.E2.m1.1.1.1.1.3.3.3.2.2.3.5">𝑎</ci><ci id="S3.E2.m1.1.1.1.1.3.3.3.2.2.3.6.cmml" xref="S3.E2.m1.1.1.1.1.3.3.3.2.2.3.6">𝑙</ci></apply></apply><apply id="S3.E2.m1.1.1.1.1.3.3.3.2.3.cmml" xref="S3.E2.m1.1.1.1.1.3.3.3.2.3"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.3.3.3.2.3.1.cmml" xref="S3.E2.m1.1.1.1.1.3.3.3.2.3">subscript</csymbol><ci id="S3.E2.m1.1.1.1.1.3.3.3.2.3.2.cmml" xref="S3.E2.m1.1.1.1.1.3.3.3.2.3.2">𝑀</ci><ci id="S3.E2.m1.1.1.1.1.3.3.3.2.3.3.cmml" xref="S3.E2.m1.1.1.1.1.3.3.3.2.3.3">𝑘</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.1c">\displaystyle L_{total}=L_{global}+\lambda\textstyle\sum_{M_{k}\in\mathcal{M}}L_{local}^{M_{k}},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p id="S3.SS3.SSS0.Px1.p1.8" class="ltx_p">where <math id="S3.SS3.SSS0.Px1.p1.4.m1.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="S3.SS3.SSS0.Px1.p1.4.m1.1a"><mi id="S3.SS3.SSS0.Px1.p1.4.m1.1.1" xref="S3.SS3.SSS0.Px1.p1.4.m1.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p1.4.m1.1b"><ci id="S3.SS3.SSS0.Px1.p1.4.m1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.4.m1.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p1.4.m1.1c">\lambda</annotation></semantics></math> is a hyperparameter to balance the global and local losses, <math id="S3.SS3.SSS0.Px1.p1.5.m2.1" class="ltx_Math" alttext="L_{global}" display="inline"><semantics id="S3.SS3.SSS0.Px1.p1.5.m2.1a"><msub id="S3.SS3.SSS0.Px1.p1.5.m2.1.1" xref="S3.SS3.SSS0.Px1.p1.5.m2.1.1.cmml"><mi id="S3.SS3.SSS0.Px1.p1.5.m2.1.1.2" xref="S3.SS3.SSS0.Px1.p1.5.m2.1.1.2.cmml">L</mi><mrow id="S3.SS3.SSS0.Px1.p1.5.m2.1.1.3" xref="S3.SS3.SSS0.Px1.p1.5.m2.1.1.3.cmml"><mi id="S3.SS3.SSS0.Px1.p1.5.m2.1.1.3.2" xref="S3.SS3.SSS0.Px1.p1.5.m2.1.1.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS0.Px1.p1.5.m2.1.1.3.1" xref="S3.SS3.SSS0.Px1.p1.5.m2.1.1.3.1.cmml">​</mo><mi id="S3.SS3.SSS0.Px1.p1.5.m2.1.1.3.3" xref="S3.SS3.SSS0.Px1.p1.5.m2.1.1.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS0.Px1.p1.5.m2.1.1.3.1a" xref="S3.SS3.SSS0.Px1.p1.5.m2.1.1.3.1.cmml">​</mo><mi id="S3.SS3.SSS0.Px1.p1.5.m2.1.1.3.4" xref="S3.SS3.SSS0.Px1.p1.5.m2.1.1.3.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS0.Px1.p1.5.m2.1.1.3.1b" xref="S3.SS3.SSS0.Px1.p1.5.m2.1.1.3.1.cmml">​</mo><mi id="S3.SS3.SSS0.Px1.p1.5.m2.1.1.3.5" xref="S3.SS3.SSS0.Px1.p1.5.m2.1.1.3.5.cmml">b</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS0.Px1.p1.5.m2.1.1.3.1c" xref="S3.SS3.SSS0.Px1.p1.5.m2.1.1.3.1.cmml">​</mo><mi id="S3.SS3.SSS0.Px1.p1.5.m2.1.1.3.6" xref="S3.SS3.SSS0.Px1.p1.5.m2.1.1.3.6.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS0.Px1.p1.5.m2.1.1.3.1d" xref="S3.SS3.SSS0.Px1.p1.5.m2.1.1.3.1.cmml">​</mo><mi id="S3.SS3.SSS0.Px1.p1.5.m2.1.1.3.7" xref="S3.SS3.SSS0.Px1.p1.5.m2.1.1.3.7.cmml">l</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p1.5.m2.1b"><apply id="S3.SS3.SSS0.Px1.p1.5.m2.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.5.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p1.5.m2.1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.5.m2.1.1">subscript</csymbol><ci id="S3.SS3.SSS0.Px1.p1.5.m2.1.1.2.cmml" xref="S3.SS3.SSS0.Px1.p1.5.m2.1.1.2">𝐿</ci><apply id="S3.SS3.SSS0.Px1.p1.5.m2.1.1.3.cmml" xref="S3.SS3.SSS0.Px1.p1.5.m2.1.1.3"><times id="S3.SS3.SSS0.Px1.p1.5.m2.1.1.3.1.cmml" xref="S3.SS3.SSS0.Px1.p1.5.m2.1.1.3.1"></times><ci id="S3.SS3.SSS0.Px1.p1.5.m2.1.1.3.2.cmml" xref="S3.SS3.SSS0.Px1.p1.5.m2.1.1.3.2">𝑔</ci><ci id="S3.SS3.SSS0.Px1.p1.5.m2.1.1.3.3.cmml" xref="S3.SS3.SSS0.Px1.p1.5.m2.1.1.3.3">𝑙</ci><ci id="S3.SS3.SSS0.Px1.p1.5.m2.1.1.3.4.cmml" xref="S3.SS3.SSS0.Px1.p1.5.m2.1.1.3.4">𝑜</ci><ci id="S3.SS3.SSS0.Px1.p1.5.m2.1.1.3.5.cmml" xref="S3.SS3.SSS0.Px1.p1.5.m2.1.1.3.5">𝑏</ci><ci id="S3.SS3.SSS0.Px1.p1.5.m2.1.1.3.6.cmml" xref="S3.SS3.SSS0.Px1.p1.5.m2.1.1.3.6">𝑎</ci><ci id="S3.SS3.SSS0.Px1.p1.5.m2.1.1.3.7.cmml" xref="S3.SS3.SSS0.Px1.p1.5.m2.1.1.3.7">𝑙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p1.5.m2.1c">L_{global}</annotation></semantics></math> is a cross-entropy loss that matches the cosine similarity between the object-agnostic textual embeddings and visual embeddings of normal/abnormal images from auxiliary data, and let <math id="S3.SS3.SSS0.Px1.p1.6.m3.1" class="ltx_Math" alttext="S\in\mathbb{R}^{H_{image}\times W_{image}}" display="inline"><semantics id="S3.SS3.SSS0.Px1.p1.6.m3.1a"><mrow id="S3.SS3.SSS0.Px1.p1.6.m3.1.1" xref="S3.SS3.SSS0.Px1.p1.6.m3.1.1.cmml"><mi id="S3.SS3.SSS0.Px1.p1.6.m3.1.1.2" xref="S3.SS3.SSS0.Px1.p1.6.m3.1.1.2.cmml">S</mi><mo id="S3.SS3.SSS0.Px1.p1.6.m3.1.1.1" xref="S3.SS3.SSS0.Px1.p1.6.m3.1.1.1.cmml">∈</mo><msup id="S3.SS3.SSS0.Px1.p1.6.m3.1.1.3" xref="S3.SS3.SSS0.Px1.p1.6.m3.1.1.3.cmml"><mi id="S3.SS3.SSS0.Px1.p1.6.m3.1.1.3.2" xref="S3.SS3.SSS0.Px1.p1.6.m3.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS3.SSS0.Px1.p1.6.m3.1.1.3.3" xref="S3.SS3.SSS0.Px1.p1.6.m3.1.1.3.3.cmml"><msub id="S3.SS3.SSS0.Px1.p1.6.m3.1.1.3.3.2" xref="S3.SS3.SSS0.Px1.p1.6.m3.1.1.3.3.2.cmml"><mi id="S3.SS3.SSS0.Px1.p1.6.m3.1.1.3.3.2.2" xref="S3.SS3.SSS0.Px1.p1.6.m3.1.1.3.3.2.2.cmml">H</mi><mrow id="S3.SS3.SSS0.Px1.p1.6.m3.1.1.3.3.2.3" xref="S3.SS3.SSS0.Px1.p1.6.m3.1.1.3.3.2.3.cmml"><mi id="S3.SS3.SSS0.Px1.p1.6.m3.1.1.3.3.2.3.2" xref="S3.SS3.SSS0.Px1.p1.6.m3.1.1.3.3.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS0.Px1.p1.6.m3.1.1.3.3.2.3.1" xref="S3.SS3.SSS0.Px1.p1.6.m3.1.1.3.3.2.3.1.cmml">​</mo><mi id="S3.SS3.SSS0.Px1.p1.6.m3.1.1.3.3.2.3.3" xref="S3.SS3.SSS0.Px1.p1.6.m3.1.1.3.3.2.3.3.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS0.Px1.p1.6.m3.1.1.3.3.2.3.1a" xref="S3.SS3.SSS0.Px1.p1.6.m3.1.1.3.3.2.3.1.cmml">​</mo><mi id="S3.SS3.SSS0.Px1.p1.6.m3.1.1.3.3.2.3.4" xref="S3.SS3.SSS0.Px1.p1.6.m3.1.1.3.3.2.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS0.Px1.p1.6.m3.1.1.3.3.2.3.1b" xref="S3.SS3.SSS0.Px1.p1.6.m3.1.1.3.3.2.3.1.cmml">​</mo><mi id="S3.SS3.SSS0.Px1.p1.6.m3.1.1.3.3.2.3.5" xref="S3.SS3.SSS0.Px1.p1.6.m3.1.1.3.3.2.3.5.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS0.Px1.p1.6.m3.1.1.3.3.2.3.1c" xref="S3.SS3.SSS0.Px1.p1.6.m3.1.1.3.3.2.3.1.cmml">​</mo><mi id="S3.SS3.SSS0.Px1.p1.6.m3.1.1.3.3.2.3.6" xref="S3.SS3.SSS0.Px1.p1.6.m3.1.1.3.3.2.3.6.cmml">e</mi></mrow></msub><mo lspace="0.222em" rspace="0.222em" id="S3.SS3.SSS0.Px1.p1.6.m3.1.1.3.3.1" xref="S3.SS3.SSS0.Px1.p1.6.m3.1.1.3.3.1.cmml">×</mo><msub id="S3.SS3.SSS0.Px1.p1.6.m3.1.1.3.3.3" xref="S3.SS3.SSS0.Px1.p1.6.m3.1.1.3.3.3.cmml"><mi id="S3.SS3.SSS0.Px1.p1.6.m3.1.1.3.3.3.2" xref="S3.SS3.SSS0.Px1.p1.6.m3.1.1.3.3.3.2.cmml">W</mi><mrow id="S3.SS3.SSS0.Px1.p1.6.m3.1.1.3.3.3.3" xref="S3.SS3.SSS0.Px1.p1.6.m3.1.1.3.3.3.3.cmml"><mi id="S3.SS3.SSS0.Px1.p1.6.m3.1.1.3.3.3.3.2" xref="S3.SS3.SSS0.Px1.p1.6.m3.1.1.3.3.3.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS0.Px1.p1.6.m3.1.1.3.3.3.3.1" xref="S3.SS3.SSS0.Px1.p1.6.m3.1.1.3.3.3.3.1.cmml">​</mo><mi id="S3.SS3.SSS0.Px1.p1.6.m3.1.1.3.3.3.3.3" xref="S3.SS3.SSS0.Px1.p1.6.m3.1.1.3.3.3.3.3.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS0.Px1.p1.6.m3.1.1.3.3.3.3.1a" xref="S3.SS3.SSS0.Px1.p1.6.m3.1.1.3.3.3.3.1.cmml">​</mo><mi id="S3.SS3.SSS0.Px1.p1.6.m3.1.1.3.3.3.3.4" xref="S3.SS3.SSS0.Px1.p1.6.m3.1.1.3.3.3.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS0.Px1.p1.6.m3.1.1.3.3.3.3.1b" xref="S3.SS3.SSS0.Px1.p1.6.m3.1.1.3.3.3.3.1.cmml">​</mo><mi id="S3.SS3.SSS0.Px1.p1.6.m3.1.1.3.3.3.3.5" xref="S3.SS3.SSS0.Px1.p1.6.m3.1.1.3.3.3.3.5.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS0.Px1.p1.6.m3.1.1.3.3.3.3.1c" xref="S3.SS3.SSS0.Px1.p1.6.m3.1.1.3.3.3.3.1.cmml">​</mo><mi id="S3.SS3.SSS0.Px1.p1.6.m3.1.1.3.3.3.3.6" xref="S3.SS3.SSS0.Px1.p1.6.m3.1.1.3.3.3.3.6.cmml">e</mi></mrow></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p1.6.m3.1b"><apply id="S3.SS3.SSS0.Px1.p1.6.m3.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.6.m3.1.1"><in id="S3.SS3.SSS0.Px1.p1.6.m3.1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.6.m3.1.1.1"></in><ci id="S3.SS3.SSS0.Px1.p1.6.m3.1.1.2.cmml" xref="S3.SS3.SSS0.Px1.p1.6.m3.1.1.2">𝑆</ci><apply id="S3.SS3.SSS0.Px1.p1.6.m3.1.1.3.cmml" xref="S3.SS3.SSS0.Px1.p1.6.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p1.6.m3.1.1.3.1.cmml" xref="S3.SS3.SSS0.Px1.p1.6.m3.1.1.3">superscript</csymbol><ci id="S3.SS3.SSS0.Px1.p1.6.m3.1.1.3.2.cmml" xref="S3.SS3.SSS0.Px1.p1.6.m3.1.1.3.2">ℝ</ci><apply id="S3.SS3.SSS0.Px1.p1.6.m3.1.1.3.3.cmml" xref="S3.SS3.SSS0.Px1.p1.6.m3.1.1.3.3"><times id="S3.SS3.SSS0.Px1.p1.6.m3.1.1.3.3.1.cmml" xref="S3.SS3.SSS0.Px1.p1.6.m3.1.1.3.3.1"></times><apply id="S3.SS3.SSS0.Px1.p1.6.m3.1.1.3.3.2.cmml" xref="S3.SS3.SSS0.Px1.p1.6.m3.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p1.6.m3.1.1.3.3.2.1.cmml" xref="S3.SS3.SSS0.Px1.p1.6.m3.1.1.3.3.2">subscript</csymbol><ci id="S3.SS3.SSS0.Px1.p1.6.m3.1.1.3.3.2.2.cmml" xref="S3.SS3.SSS0.Px1.p1.6.m3.1.1.3.3.2.2">𝐻</ci><apply id="S3.SS3.SSS0.Px1.p1.6.m3.1.1.3.3.2.3.cmml" xref="S3.SS3.SSS0.Px1.p1.6.m3.1.1.3.3.2.3"><times id="S3.SS3.SSS0.Px1.p1.6.m3.1.1.3.3.2.3.1.cmml" xref="S3.SS3.SSS0.Px1.p1.6.m3.1.1.3.3.2.3.1"></times><ci id="S3.SS3.SSS0.Px1.p1.6.m3.1.1.3.3.2.3.2.cmml" xref="S3.SS3.SSS0.Px1.p1.6.m3.1.1.3.3.2.3.2">𝑖</ci><ci id="S3.SS3.SSS0.Px1.p1.6.m3.1.1.3.3.2.3.3.cmml" xref="S3.SS3.SSS0.Px1.p1.6.m3.1.1.3.3.2.3.3">𝑚</ci><ci id="S3.SS3.SSS0.Px1.p1.6.m3.1.1.3.3.2.3.4.cmml" xref="S3.SS3.SSS0.Px1.p1.6.m3.1.1.3.3.2.3.4">𝑎</ci><ci id="S3.SS3.SSS0.Px1.p1.6.m3.1.1.3.3.2.3.5.cmml" xref="S3.SS3.SSS0.Px1.p1.6.m3.1.1.3.3.2.3.5">𝑔</ci><ci id="S3.SS3.SSS0.Px1.p1.6.m3.1.1.3.3.2.3.6.cmml" xref="S3.SS3.SSS0.Px1.p1.6.m3.1.1.3.3.2.3.6">𝑒</ci></apply></apply><apply id="S3.SS3.SSS0.Px1.p1.6.m3.1.1.3.3.3.cmml" xref="S3.SS3.SSS0.Px1.p1.6.m3.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p1.6.m3.1.1.3.3.3.1.cmml" xref="S3.SS3.SSS0.Px1.p1.6.m3.1.1.3.3.3">subscript</csymbol><ci id="S3.SS3.SSS0.Px1.p1.6.m3.1.1.3.3.3.2.cmml" xref="S3.SS3.SSS0.Px1.p1.6.m3.1.1.3.3.3.2">𝑊</ci><apply id="S3.SS3.SSS0.Px1.p1.6.m3.1.1.3.3.3.3.cmml" xref="S3.SS3.SSS0.Px1.p1.6.m3.1.1.3.3.3.3"><times id="S3.SS3.SSS0.Px1.p1.6.m3.1.1.3.3.3.3.1.cmml" xref="S3.SS3.SSS0.Px1.p1.6.m3.1.1.3.3.3.3.1"></times><ci id="S3.SS3.SSS0.Px1.p1.6.m3.1.1.3.3.3.3.2.cmml" xref="S3.SS3.SSS0.Px1.p1.6.m3.1.1.3.3.3.3.2">𝑖</ci><ci id="S3.SS3.SSS0.Px1.p1.6.m3.1.1.3.3.3.3.3.cmml" xref="S3.SS3.SSS0.Px1.p1.6.m3.1.1.3.3.3.3.3">𝑚</ci><ci id="S3.SS3.SSS0.Px1.p1.6.m3.1.1.3.3.3.3.4.cmml" xref="S3.SS3.SSS0.Px1.p1.6.m3.1.1.3.3.3.3.4">𝑎</ci><ci id="S3.SS3.SSS0.Px1.p1.6.m3.1.1.3.3.3.3.5.cmml" xref="S3.SS3.SSS0.Px1.p1.6.m3.1.1.3.3.3.3.5">𝑔</ci><ci id="S3.SS3.SSS0.Px1.p1.6.m3.1.1.3.3.3.3.6.cmml" xref="S3.SS3.SSS0.Px1.p1.6.m3.1.1.3.3.3.3.6">𝑒</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p1.6.m3.1c">S\in\mathbb{R}^{H_{image}\times W_{image}}</annotation></semantics></math> be the ground-truth segmentation mask, with <math id="S3.SS3.SSS0.Px1.p1.7.m4.1" class="ltx_Math" alttext="S_{ij}=1" display="inline"><semantics id="S3.SS3.SSS0.Px1.p1.7.m4.1a"><mrow id="S3.SS3.SSS0.Px1.p1.7.m4.1.1" xref="S3.SS3.SSS0.Px1.p1.7.m4.1.1.cmml"><msub id="S3.SS3.SSS0.Px1.p1.7.m4.1.1.2" xref="S3.SS3.SSS0.Px1.p1.7.m4.1.1.2.cmml"><mi id="S3.SS3.SSS0.Px1.p1.7.m4.1.1.2.2" xref="S3.SS3.SSS0.Px1.p1.7.m4.1.1.2.2.cmml">S</mi><mrow id="S3.SS3.SSS0.Px1.p1.7.m4.1.1.2.3" xref="S3.SS3.SSS0.Px1.p1.7.m4.1.1.2.3.cmml"><mi id="S3.SS3.SSS0.Px1.p1.7.m4.1.1.2.3.2" xref="S3.SS3.SSS0.Px1.p1.7.m4.1.1.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS0.Px1.p1.7.m4.1.1.2.3.1" xref="S3.SS3.SSS0.Px1.p1.7.m4.1.1.2.3.1.cmml">​</mo><mi id="S3.SS3.SSS0.Px1.p1.7.m4.1.1.2.3.3" xref="S3.SS3.SSS0.Px1.p1.7.m4.1.1.2.3.3.cmml">j</mi></mrow></msub><mo id="S3.SS3.SSS0.Px1.p1.7.m4.1.1.1" xref="S3.SS3.SSS0.Px1.p1.7.m4.1.1.1.cmml">=</mo><mn id="S3.SS3.SSS0.Px1.p1.7.m4.1.1.3" xref="S3.SS3.SSS0.Px1.p1.7.m4.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p1.7.m4.1b"><apply id="S3.SS3.SSS0.Px1.p1.7.m4.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.7.m4.1.1"><eq id="S3.SS3.SSS0.Px1.p1.7.m4.1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.7.m4.1.1.1"></eq><apply id="S3.SS3.SSS0.Px1.p1.7.m4.1.1.2.cmml" xref="S3.SS3.SSS0.Px1.p1.7.m4.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p1.7.m4.1.1.2.1.cmml" xref="S3.SS3.SSS0.Px1.p1.7.m4.1.1.2">subscript</csymbol><ci id="S3.SS3.SSS0.Px1.p1.7.m4.1.1.2.2.cmml" xref="S3.SS3.SSS0.Px1.p1.7.m4.1.1.2.2">𝑆</ci><apply id="S3.SS3.SSS0.Px1.p1.7.m4.1.1.2.3.cmml" xref="S3.SS3.SSS0.Px1.p1.7.m4.1.1.2.3"><times id="S3.SS3.SSS0.Px1.p1.7.m4.1.1.2.3.1.cmml" xref="S3.SS3.SSS0.Px1.p1.7.m4.1.1.2.3.1"></times><ci id="S3.SS3.SSS0.Px1.p1.7.m4.1.1.2.3.2.cmml" xref="S3.SS3.SSS0.Px1.p1.7.m4.1.1.2.3.2">𝑖</ci><ci id="S3.SS3.SSS0.Px1.p1.7.m4.1.1.2.3.3.cmml" xref="S3.SS3.SSS0.Px1.p1.7.m4.1.1.2.3.3">𝑗</ci></apply></apply><cn type="integer" id="S3.SS3.SSS0.Px1.p1.7.m4.1.1.3.cmml" xref="S3.SS3.SSS0.Px1.p1.7.m4.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p1.7.m4.1c">S_{ij}=1</annotation></semantics></math> if the pixel is as an anomaly and <math id="S3.SS3.SSS0.Px1.p1.8.m5.1" class="ltx_Math" alttext="S_{ij}=0" display="inline"><semantics id="S3.SS3.SSS0.Px1.p1.8.m5.1a"><mrow id="S3.SS3.SSS0.Px1.p1.8.m5.1.1" xref="S3.SS3.SSS0.Px1.p1.8.m5.1.1.cmml"><msub id="S3.SS3.SSS0.Px1.p1.8.m5.1.1.2" xref="S3.SS3.SSS0.Px1.p1.8.m5.1.1.2.cmml"><mi id="S3.SS3.SSS0.Px1.p1.8.m5.1.1.2.2" xref="S3.SS3.SSS0.Px1.p1.8.m5.1.1.2.2.cmml">S</mi><mrow id="S3.SS3.SSS0.Px1.p1.8.m5.1.1.2.3" xref="S3.SS3.SSS0.Px1.p1.8.m5.1.1.2.3.cmml"><mi id="S3.SS3.SSS0.Px1.p1.8.m5.1.1.2.3.2" xref="S3.SS3.SSS0.Px1.p1.8.m5.1.1.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS0.Px1.p1.8.m5.1.1.2.3.1" xref="S3.SS3.SSS0.Px1.p1.8.m5.1.1.2.3.1.cmml">​</mo><mi id="S3.SS3.SSS0.Px1.p1.8.m5.1.1.2.3.3" xref="S3.SS3.SSS0.Px1.p1.8.m5.1.1.2.3.3.cmml">j</mi></mrow></msub><mo id="S3.SS3.SSS0.Px1.p1.8.m5.1.1.1" xref="S3.SS3.SSS0.Px1.p1.8.m5.1.1.1.cmml">=</mo><mn id="S3.SS3.SSS0.Px1.p1.8.m5.1.1.3" xref="S3.SS3.SSS0.Px1.p1.8.m5.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p1.8.m5.1b"><apply id="S3.SS3.SSS0.Px1.p1.8.m5.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.8.m5.1.1"><eq id="S3.SS3.SSS0.Px1.p1.8.m5.1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.8.m5.1.1.1"></eq><apply id="S3.SS3.SSS0.Px1.p1.8.m5.1.1.2.cmml" xref="S3.SS3.SSS0.Px1.p1.8.m5.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p1.8.m5.1.1.2.1.cmml" xref="S3.SS3.SSS0.Px1.p1.8.m5.1.1.2">subscript</csymbol><ci id="S3.SS3.SSS0.Px1.p1.8.m5.1.1.2.2.cmml" xref="S3.SS3.SSS0.Px1.p1.8.m5.1.1.2.2">𝑆</ci><apply id="S3.SS3.SSS0.Px1.p1.8.m5.1.1.2.3.cmml" xref="S3.SS3.SSS0.Px1.p1.8.m5.1.1.2.3"><times id="S3.SS3.SSS0.Px1.p1.8.m5.1.1.2.3.1.cmml" xref="S3.SS3.SSS0.Px1.p1.8.m5.1.1.2.3.1"></times><ci id="S3.SS3.SSS0.Px1.p1.8.m5.1.1.2.3.2.cmml" xref="S3.SS3.SSS0.Px1.p1.8.m5.1.1.2.3.2">𝑖</ci><ci id="S3.SS3.SSS0.Px1.p1.8.m5.1.1.2.3.3.cmml" xref="S3.SS3.SSS0.Px1.p1.8.m5.1.1.2.3.3">𝑗</ci></apply></apply><cn type="integer" id="S3.SS3.SSS0.Px1.p1.8.m5.1.1.3.cmml" xref="S3.SS3.SSS0.Px1.p1.8.m5.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p1.8.m5.1c">S_{ij}=0</annotation></semantics></math> otherwise, then we have</p>
<table id="A6.EGx4" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.Ex5"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.Ex5.m1.9" class="ltx_Math" alttext="\displaystyle S^{(j,k)}_{n}=P(g_{n},f^{m(j,k)}_{i}),j\in[1,H],k\in[1,W]," display="inline"><semantics id="S3.Ex5.m1.9a"><mrow id="S3.Ex5.m1.9.9.1"><mrow id="S3.Ex5.m1.9.9.1.1.2" xref="S3.Ex5.m1.9.9.1.1.3.cmml"><mrow id="S3.Ex5.m1.9.9.1.1.1.1" xref="S3.Ex5.m1.9.9.1.1.1.1.cmml"><msubsup id="S3.Ex5.m1.9.9.1.1.1.1.4" xref="S3.Ex5.m1.9.9.1.1.1.1.4.cmml"><mi id="S3.Ex5.m1.9.9.1.1.1.1.4.2.2" xref="S3.Ex5.m1.9.9.1.1.1.1.4.2.2.cmml">S</mi><mi id="S3.Ex5.m1.9.9.1.1.1.1.4.3" xref="S3.Ex5.m1.9.9.1.1.1.1.4.3.cmml">n</mi><mrow id="S3.Ex5.m1.2.2.2.4" xref="S3.Ex5.m1.2.2.2.3.cmml"><mo stretchy="false" id="S3.Ex5.m1.2.2.2.4.1" xref="S3.Ex5.m1.2.2.2.3.cmml">(</mo><mi id="S3.Ex5.m1.1.1.1.1" xref="S3.Ex5.m1.1.1.1.1.cmml">j</mi><mo id="S3.Ex5.m1.2.2.2.4.2" xref="S3.Ex5.m1.2.2.2.3.cmml">,</mo><mi id="S3.Ex5.m1.2.2.2.2" xref="S3.Ex5.m1.2.2.2.2.cmml">k</mi><mo stretchy="false" id="S3.Ex5.m1.2.2.2.4.3" xref="S3.Ex5.m1.2.2.2.3.cmml">)</mo></mrow></msubsup><mo id="S3.Ex5.m1.9.9.1.1.1.1.3" xref="S3.Ex5.m1.9.9.1.1.1.1.3.cmml">=</mo><mrow id="S3.Ex5.m1.9.9.1.1.1.1.2" xref="S3.Ex5.m1.9.9.1.1.1.1.2.cmml"><mi id="S3.Ex5.m1.9.9.1.1.1.1.2.4" xref="S3.Ex5.m1.9.9.1.1.1.1.2.4.cmml">P</mi><mo lspace="0em" rspace="0em" id="S3.Ex5.m1.9.9.1.1.1.1.2.3" xref="S3.Ex5.m1.9.9.1.1.1.1.2.3.cmml">​</mo><mrow id="S3.Ex5.m1.9.9.1.1.1.1.2.2.2" xref="S3.Ex5.m1.9.9.1.1.1.1.2.2.3.cmml"><mo stretchy="false" id="S3.Ex5.m1.9.9.1.1.1.1.2.2.2.3" xref="S3.Ex5.m1.9.9.1.1.1.1.2.2.3.cmml">(</mo><msub id="S3.Ex5.m1.9.9.1.1.1.1.1.1.1.1" xref="S3.Ex5.m1.9.9.1.1.1.1.1.1.1.1.cmml"><mi id="S3.Ex5.m1.9.9.1.1.1.1.1.1.1.1.2" xref="S3.Ex5.m1.9.9.1.1.1.1.1.1.1.1.2.cmml">g</mi><mi id="S3.Ex5.m1.9.9.1.1.1.1.1.1.1.1.3" xref="S3.Ex5.m1.9.9.1.1.1.1.1.1.1.1.3.cmml">n</mi></msub><mo id="S3.Ex5.m1.9.9.1.1.1.1.2.2.2.4" xref="S3.Ex5.m1.9.9.1.1.1.1.2.2.3.cmml">,</mo><msubsup id="S3.Ex5.m1.9.9.1.1.1.1.2.2.2.2" xref="S3.Ex5.m1.9.9.1.1.1.1.2.2.2.2.cmml"><mi id="S3.Ex5.m1.9.9.1.1.1.1.2.2.2.2.2.2" xref="S3.Ex5.m1.9.9.1.1.1.1.2.2.2.2.2.2.cmml">f</mi><mi id="S3.Ex5.m1.9.9.1.1.1.1.2.2.2.2.3" xref="S3.Ex5.m1.9.9.1.1.1.1.2.2.2.2.3.cmml">i</mi><mrow id="S3.Ex5.m1.4.4.2" xref="S3.Ex5.m1.4.4.2.cmml"><mi id="S3.Ex5.m1.4.4.2.4" xref="S3.Ex5.m1.4.4.2.4.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.Ex5.m1.4.4.2.3" xref="S3.Ex5.m1.4.4.2.3.cmml">​</mo><mrow id="S3.Ex5.m1.4.4.2.5.2" xref="S3.Ex5.m1.4.4.2.5.1.cmml"><mo stretchy="false" id="S3.Ex5.m1.4.4.2.5.2.1" xref="S3.Ex5.m1.4.4.2.5.1.cmml">(</mo><mi id="S3.Ex5.m1.3.3.1.1" xref="S3.Ex5.m1.3.3.1.1.cmml">j</mi><mo id="S3.Ex5.m1.4.4.2.5.2.2" xref="S3.Ex5.m1.4.4.2.5.1.cmml">,</mo><mi id="S3.Ex5.m1.4.4.2.2" xref="S3.Ex5.m1.4.4.2.2.cmml">k</mi><mo stretchy="false" id="S3.Ex5.m1.4.4.2.5.2.3" xref="S3.Ex5.m1.4.4.2.5.1.cmml">)</mo></mrow></mrow></msubsup><mo stretchy="false" id="S3.Ex5.m1.9.9.1.1.1.1.2.2.2.5" xref="S3.Ex5.m1.9.9.1.1.1.1.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S3.Ex5.m1.9.9.1.1.2.3" xref="S3.Ex5.m1.9.9.1.1.3a.cmml">,</mo><mrow id="S3.Ex5.m1.9.9.1.1.2.2.2" xref="S3.Ex5.m1.9.9.1.1.2.2.3.cmml"><mrow id="S3.Ex5.m1.9.9.1.1.2.2.1.1" xref="S3.Ex5.m1.9.9.1.1.2.2.1.1.cmml"><mi id="S3.Ex5.m1.9.9.1.1.2.2.1.1.2" xref="S3.Ex5.m1.9.9.1.1.2.2.1.1.2.cmml">j</mi><mo id="S3.Ex5.m1.9.9.1.1.2.2.1.1.1" xref="S3.Ex5.m1.9.9.1.1.2.2.1.1.1.cmml">∈</mo><mrow id="S3.Ex5.m1.9.9.1.1.2.2.1.1.3.2" xref="S3.Ex5.m1.9.9.1.1.2.2.1.1.3.1.cmml"><mo stretchy="false" id="S3.Ex5.m1.9.9.1.1.2.2.1.1.3.2.1" xref="S3.Ex5.m1.9.9.1.1.2.2.1.1.3.1.cmml">[</mo><mn id="S3.Ex5.m1.5.5" xref="S3.Ex5.m1.5.5.cmml">1</mn><mo id="S3.Ex5.m1.9.9.1.1.2.2.1.1.3.2.2" xref="S3.Ex5.m1.9.9.1.1.2.2.1.1.3.1.cmml">,</mo><mi id="S3.Ex5.m1.6.6" xref="S3.Ex5.m1.6.6.cmml">H</mi><mo stretchy="false" id="S3.Ex5.m1.9.9.1.1.2.2.1.1.3.2.3" xref="S3.Ex5.m1.9.9.1.1.2.2.1.1.3.1.cmml">]</mo></mrow></mrow><mo id="S3.Ex5.m1.9.9.1.1.2.2.2.3" xref="S3.Ex5.m1.9.9.1.1.2.2.3a.cmml">,</mo><mrow id="S3.Ex5.m1.9.9.1.1.2.2.2.2" xref="S3.Ex5.m1.9.9.1.1.2.2.2.2.cmml"><mi id="S3.Ex5.m1.9.9.1.1.2.2.2.2.2" xref="S3.Ex5.m1.9.9.1.1.2.2.2.2.2.cmml">k</mi><mo id="S3.Ex5.m1.9.9.1.1.2.2.2.2.1" xref="S3.Ex5.m1.9.9.1.1.2.2.2.2.1.cmml">∈</mo><mrow id="S3.Ex5.m1.9.9.1.1.2.2.2.2.3.2" xref="S3.Ex5.m1.9.9.1.1.2.2.2.2.3.1.cmml"><mo stretchy="false" id="S3.Ex5.m1.9.9.1.1.2.2.2.2.3.2.1" xref="S3.Ex5.m1.9.9.1.1.2.2.2.2.3.1.cmml">[</mo><mn id="S3.Ex5.m1.7.7" xref="S3.Ex5.m1.7.7.cmml">1</mn><mo id="S3.Ex5.m1.9.9.1.1.2.2.2.2.3.2.2" xref="S3.Ex5.m1.9.9.1.1.2.2.2.2.3.1.cmml">,</mo><mi id="S3.Ex5.m1.8.8" xref="S3.Ex5.m1.8.8.cmml">W</mi><mo stretchy="false" id="S3.Ex5.m1.9.9.1.1.2.2.2.2.3.2.3" xref="S3.Ex5.m1.9.9.1.1.2.2.2.2.3.1.cmml">]</mo></mrow></mrow></mrow></mrow><mo id="S3.Ex5.m1.9.9.1.2">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex5.m1.9b"><apply id="S3.Ex5.m1.9.9.1.1.3.cmml" xref="S3.Ex5.m1.9.9.1.1.2"><csymbol cd="ambiguous" id="S3.Ex5.m1.9.9.1.1.3a.cmml" xref="S3.Ex5.m1.9.9.1.1.2.3">formulae-sequence</csymbol><apply id="S3.Ex5.m1.9.9.1.1.1.1.cmml" xref="S3.Ex5.m1.9.9.1.1.1.1"><eq id="S3.Ex5.m1.9.9.1.1.1.1.3.cmml" xref="S3.Ex5.m1.9.9.1.1.1.1.3"></eq><apply id="S3.Ex5.m1.9.9.1.1.1.1.4.cmml" xref="S3.Ex5.m1.9.9.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.Ex5.m1.9.9.1.1.1.1.4.1.cmml" xref="S3.Ex5.m1.9.9.1.1.1.1.4">subscript</csymbol><apply id="S3.Ex5.m1.9.9.1.1.1.1.4.2.cmml" xref="S3.Ex5.m1.9.9.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.Ex5.m1.9.9.1.1.1.1.4.2.1.cmml" xref="S3.Ex5.m1.9.9.1.1.1.1.4">superscript</csymbol><ci id="S3.Ex5.m1.9.9.1.1.1.1.4.2.2.cmml" xref="S3.Ex5.m1.9.9.1.1.1.1.4.2.2">𝑆</ci><interval closure="open" id="S3.Ex5.m1.2.2.2.3.cmml" xref="S3.Ex5.m1.2.2.2.4"><ci id="S3.Ex5.m1.1.1.1.1.cmml" xref="S3.Ex5.m1.1.1.1.1">𝑗</ci><ci id="S3.Ex5.m1.2.2.2.2.cmml" xref="S3.Ex5.m1.2.2.2.2">𝑘</ci></interval></apply><ci id="S3.Ex5.m1.9.9.1.1.1.1.4.3.cmml" xref="S3.Ex5.m1.9.9.1.1.1.1.4.3">𝑛</ci></apply><apply id="S3.Ex5.m1.9.9.1.1.1.1.2.cmml" xref="S3.Ex5.m1.9.9.1.1.1.1.2"><times id="S3.Ex5.m1.9.9.1.1.1.1.2.3.cmml" xref="S3.Ex5.m1.9.9.1.1.1.1.2.3"></times><ci id="S3.Ex5.m1.9.9.1.1.1.1.2.4.cmml" xref="S3.Ex5.m1.9.9.1.1.1.1.2.4">𝑃</ci><interval closure="open" id="S3.Ex5.m1.9.9.1.1.1.1.2.2.3.cmml" xref="S3.Ex5.m1.9.9.1.1.1.1.2.2.2"><apply id="S3.Ex5.m1.9.9.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex5.m1.9.9.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex5.m1.9.9.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex5.m1.9.9.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.Ex5.m1.9.9.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex5.m1.9.9.1.1.1.1.1.1.1.1.2">𝑔</ci><ci id="S3.Ex5.m1.9.9.1.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex5.m1.9.9.1.1.1.1.1.1.1.1.3">𝑛</ci></apply><apply id="S3.Ex5.m1.9.9.1.1.1.1.2.2.2.2.cmml" xref="S3.Ex5.m1.9.9.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.Ex5.m1.9.9.1.1.1.1.2.2.2.2.1.cmml" xref="S3.Ex5.m1.9.9.1.1.1.1.2.2.2.2">subscript</csymbol><apply id="S3.Ex5.m1.9.9.1.1.1.1.2.2.2.2.2.cmml" xref="S3.Ex5.m1.9.9.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.Ex5.m1.9.9.1.1.1.1.2.2.2.2.2.1.cmml" xref="S3.Ex5.m1.9.9.1.1.1.1.2.2.2.2">superscript</csymbol><ci id="S3.Ex5.m1.9.9.1.1.1.1.2.2.2.2.2.2.cmml" xref="S3.Ex5.m1.9.9.1.1.1.1.2.2.2.2.2.2">𝑓</ci><apply id="S3.Ex5.m1.4.4.2.cmml" xref="S3.Ex5.m1.4.4.2"><times id="S3.Ex5.m1.4.4.2.3.cmml" xref="S3.Ex5.m1.4.4.2.3"></times><ci id="S3.Ex5.m1.4.4.2.4.cmml" xref="S3.Ex5.m1.4.4.2.4">𝑚</ci><interval closure="open" id="S3.Ex5.m1.4.4.2.5.1.cmml" xref="S3.Ex5.m1.4.4.2.5.2"><ci id="S3.Ex5.m1.3.3.1.1.cmml" xref="S3.Ex5.m1.3.3.1.1">𝑗</ci><ci id="S3.Ex5.m1.4.4.2.2.cmml" xref="S3.Ex5.m1.4.4.2.2">𝑘</ci></interval></apply></apply><ci id="S3.Ex5.m1.9.9.1.1.1.1.2.2.2.2.3.cmml" xref="S3.Ex5.m1.9.9.1.1.1.1.2.2.2.2.3">𝑖</ci></apply></interval></apply></apply><apply id="S3.Ex5.m1.9.9.1.1.2.2.3.cmml" xref="S3.Ex5.m1.9.9.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.Ex5.m1.9.9.1.1.2.2.3a.cmml" xref="S3.Ex5.m1.9.9.1.1.2.2.2.3">formulae-sequence</csymbol><apply id="S3.Ex5.m1.9.9.1.1.2.2.1.1.cmml" xref="S3.Ex5.m1.9.9.1.1.2.2.1.1"><in id="S3.Ex5.m1.9.9.1.1.2.2.1.1.1.cmml" xref="S3.Ex5.m1.9.9.1.1.2.2.1.1.1"></in><ci id="S3.Ex5.m1.9.9.1.1.2.2.1.1.2.cmml" xref="S3.Ex5.m1.9.9.1.1.2.2.1.1.2">𝑗</ci><interval closure="closed" id="S3.Ex5.m1.9.9.1.1.2.2.1.1.3.1.cmml" xref="S3.Ex5.m1.9.9.1.1.2.2.1.1.3.2"><cn type="integer" id="S3.Ex5.m1.5.5.cmml" xref="S3.Ex5.m1.5.5">1</cn><ci id="S3.Ex5.m1.6.6.cmml" xref="S3.Ex5.m1.6.6">𝐻</ci></interval></apply><apply id="S3.Ex5.m1.9.9.1.1.2.2.2.2.cmml" xref="S3.Ex5.m1.9.9.1.1.2.2.2.2"><in id="S3.Ex5.m1.9.9.1.1.2.2.2.2.1.cmml" xref="S3.Ex5.m1.9.9.1.1.2.2.2.2.1"></in><ci id="S3.Ex5.m1.9.9.1.1.2.2.2.2.2.cmml" xref="S3.Ex5.m1.9.9.1.1.2.2.2.2.2">𝑘</ci><interval closure="closed" id="S3.Ex5.m1.9.9.1.1.2.2.2.2.3.1.cmml" xref="S3.Ex5.m1.9.9.1.1.2.2.2.2.3.2"><cn type="integer" id="S3.Ex5.m1.7.7.cmml" xref="S3.Ex5.m1.7.7">1</cn><ci id="S3.Ex5.m1.8.8.cmml" xref="S3.Ex5.m1.8.8">𝑊</ci></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex5.m1.9c">\displaystyle S^{(j,k)}_{n}=P(g_{n},f^{m(j,k)}_{i}),j\in[1,H],k\in[1,W],</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.Ex5.m2.9" class="ltx_Math" alttext="\displaystyle\quad S^{(j,k)}_{a}=P(g_{a},f^{m(j,k)}_{i}),j\in[1,H],k\in[1,W]," display="inline"><semantics id="S3.Ex5.m2.9a"><mrow id="S3.Ex5.m2.9.9.1"><mrow id="S3.Ex5.m2.9.9.1.1.2" xref="S3.Ex5.m2.9.9.1.1.3.cmml"><mrow id="S3.Ex5.m2.9.9.1.1.1.1" xref="S3.Ex5.m2.9.9.1.1.1.1.cmml"><msubsup id="S3.Ex5.m2.9.9.1.1.1.1.4" xref="S3.Ex5.m2.9.9.1.1.1.1.4.cmml"><mi id="S3.Ex5.m2.9.9.1.1.1.1.4.2.2" xref="S3.Ex5.m2.9.9.1.1.1.1.4.2.2.cmml">S</mi><mi id="S3.Ex5.m2.9.9.1.1.1.1.4.3" xref="S3.Ex5.m2.9.9.1.1.1.1.4.3.cmml">a</mi><mrow id="S3.Ex5.m2.2.2.2.4" xref="S3.Ex5.m2.2.2.2.3.cmml"><mo stretchy="false" id="S3.Ex5.m2.2.2.2.4.1" xref="S3.Ex5.m2.2.2.2.3.cmml">(</mo><mi id="S3.Ex5.m2.1.1.1.1" xref="S3.Ex5.m2.1.1.1.1.cmml">j</mi><mo id="S3.Ex5.m2.2.2.2.4.2" xref="S3.Ex5.m2.2.2.2.3.cmml">,</mo><mi id="S3.Ex5.m2.2.2.2.2" xref="S3.Ex5.m2.2.2.2.2.cmml">k</mi><mo stretchy="false" id="S3.Ex5.m2.2.2.2.4.3" xref="S3.Ex5.m2.2.2.2.3.cmml">)</mo></mrow></msubsup><mo id="S3.Ex5.m2.9.9.1.1.1.1.3" xref="S3.Ex5.m2.9.9.1.1.1.1.3.cmml">=</mo><mrow id="S3.Ex5.m2.9.9.1.1.1.1.2" xref="S3.Ex5.m2.9.9.1.1.1.1.2.cmml"><mi id="S3.Ex5.m2.9.9.1.1.1.1.2.4" xref="S3.Ex5.m2.9.9.1.1.1.1.2.4.cmml">P</mi><mo lspace="0em" rspace="0em" id="S3.Ex5.m2.9.9.1.1.1.1.2.3" xref="S3.Ex5.m2.9.9.1.1.1.1.2.3.cmml">​</mo><mrow id="S3.Ex5.m2.9.9.1.1.1.1.2.2.2" xref="S3.Ex5.m2.9.9.1.1.1.1.2.2.3.cmml"><mo stretchy="false" id="S3.Ex5.m2.9.9.1.1.1.1.2.2.2.3" xref="S3.Ex5.m2.9.9.1.1.1.1.2.2.3.cmml">(</mo><msub id="S3.Ex5.m2.9.9.1.1.1.1.1.1.1.1" xref="S3.Ex5.m2.9.9.1.1.1.1.1.1.1.1.cmml"><mi id="S3.Ex5.m2.9.9.1.1.1.1.1.1.1.1.2" xref="S3.Ex5.m2.9.9.1.1.1.1.1.1.1.1.2.cmml">g</mi><mi id="S3.Ex5.m2.9.9.1.1.1.1.1.1.1.1.3" xref="S3.Ex5.m2.9.9.1.1.1.1.1.1.1.1.3.cmml">a</mi></msub><mo id="S3.Ex5.m2.9.9.1.1.1.1.2.2.2.4" xref="S3.Ex5.m2.9.9.1.1.1.1.2.2.3.cmml">,</mo><msubsup id="S3.Ex5.m2.9.9.1.1.1.1.2.2.2.2" xref="S3.Ex5.m2.9.9.1.1.1.1.2.2.2.2.cmml"><mi id="S3.Ex5.m2.9.9.1.1.1.1.2.2.2.2.2.2" xref="S3.Ex5.m2.9.9.1.1.1.1.2.2.2.2.2.2.cmml">f</mi><mi id="S3.Ex5.m2.9.9.1.1.1.1.2.2.2.2.3" xref="S3.Ex5.m2.9.9.1.1.1.1.2.2.2.2.3.cmml">i</mi><mrow id="S3.Ex5.m2.4.4.2" xref="S3.Ex5.m2.4.4.2.cmml"><mi id="S3.Ex5.m2.4.4.2.4" xref="S3.Ex5.m2.4.4.2.4.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.Ex5.m2.4.4.2.3" xref="S3.Ex5.m2.4.4.2.3.cmml">​</mo><mrow id="S3.Ex5.m2.4.4.2.5.2" xref="S3.Ex5.m2.4.4.2.5.1.cmml"><mo stretchy="false" id="S3.Ex5.m2.4.4.2.5.2.1" xref="S3.Ex5.m2.4.4.2.5.1.cmml">(</mo><mi id="S3.Ex5.m2.3.3.1.1" xref="S3.Ex5.m2.3.3.1.1.cmml">j</mi><mo id="S3.Ex5.m2.4.4.2.5.2.2" xref="S3.Ex5.m2.4.4.2.5.1.cmml">,</mo><mi id="S3.Ex5.m2.4.4.2.2" xref="S3.Ex5.m2.4.4.2.2.cmml">k</mi><mo stretchy="false" id="S3.Ex5.m2.4.4.2.5.2.3" xref="S3.Ex5.m2.4.4.2.5.1.cmml">)</mo></mrow></mrow></msubsup><mo stretchy="false" id="S3.Ex5.m2.9.9.1.1.1.1.2.2.2.5" xref="S3.Ex5.m2.9.9.1.1.1.1.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S3.Ex5.m2.9.9.1.1.2.3" xref="S3.Ex5.m2.9.9.1.1.3a.cmml">,</mo><mrow id="S3.Ex5.m2.9.9.1.1.2.2.2" xref="S3.Ex5.m2.9.9.1.1.2.2.3.cmml"><mrow id="S3.Ex5.m2.9.9.1.1.2.2.1.1" xref="S3.Ex5.m2.9.9.1.1.2.2.1.1.cmml"><mi id="S3.Ex5.m2.9.9.1.1.2.2.1.1.2" xref="S3.Ex5.m2.9.9.1.1.2.2.1.1.2.cmml">j</mi><mo id="S3.Ex5.m2.9.9.1.1.2.2.1.1.1" xref="S3.Ex5.m2.9.9.1.1.2.2.1.1.1.cmml">∈</mo><mrow id="S3.Ex5.m2.9.9.1.1.2.2.1.1.3.2" xref="S3.Ex5.m2.9.9.1.1.2.2.1.1.3.1.cmml"><mo stretchy="false" id="S3.Ex5.m2.9.9.1.1.2.2.1.1.3.2.1" xref="S3.Ex5.m2.9.9.1.1.2.2.1.1.3.1.cmml">[</mo><mn id="S3.Ex5.m2.5.5" xref="S3.Ex5.m2.5.5.cmml">1</mn><mo id="S3.Ex5.m2.9.9.1.1.2.2.1.1.3.2.2" xref="S3.Ex5.m2.9.9.1.1.2.2.1.1.3.1.cmml">,</mo><mi id="S3.Ex5.m2.6.6" xref="S3.Ex5.m2.6.6.cmml">H</mi><mo stretchy="false" id="S3.Ex5.m2.9.9.1.1.2.2.1.1.3.2.3" xref="S3.Ex5.m2.9.9.1.1.2.2.1.1.3.1.cmml">]</mo></mrow></mrow><mo id="S3.Ex5.m2.9.9.1.1.2.2.2.3" xref="S3.Ex5.m2.9.9.1.1.2.2.3a.cmml">,</mo><mrow id="S3.Ex5.m2.9.9.1.1.2.2.2.2" xref="S3.Ex5.m2.9.9.1.1.2.2.2.2.cmml"><mi id="S3.Ex5.m2.9.9.1.1.2.2.2.2.2" xref="S3.Ex5.m2.9.9.1.1.2.2.2.2.2.cmml">k</mi><mo id="S3.Ex5.m2.9.9.1.1.2.2.2.2.1" xref="S3.Ex5.m2.9.9.1.1.2.2.2.2.1.cmml">∈</mo><mrow id="S3.Ex5.m2.9.9.1.1.2.2.2.2.3.2" xref="S3.Ex5.m2.9.9.1.1.2.2.2.2.3.1.cmml"><mo stretchy="false" id="S3.Ex5.m2.9.9.1.1.2.2.2.2.3.2.1" xref="S3.Ex5.m2.9.9.1.1.2.2.2.2.3.1.cmml">[</mo><mn id="S3.Ex5.m2.7.7" xref="S3.Ex5.m2.7.7.cmml">1</mn><mo id="S3.Ex5.m2.9.9.1.1.2.2.2.2.3.2.2" xref="S3.Ex5.m2.9.9.1.1.2.2.2.2.3.1.cmml">,</mo><mi id="S3.Ex5.m2.8.8" xref="S3.Ex5.m2.8.8.cmml">W</mi><mo stretchy="false" id="S3.Ex5.m2.9.9.1.1.2.2.2.2.3.2.3" xref="S3.Ex5.m2.9.9.1.1.2.2.2.2.3.1.cmml">]</mo></mrow></mrow></mrow></mrow><mo id="S3.Ex5.m2.9.9.1.2">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex5.m2.9b"><apply id="S3.Ex5.m2.9.9.1.1.3.cmml" xref="S3.Ex5.m2.9.9.1.1.2"><csymbol cd="ambiguous" id="S3.Ex5.m2.9.9.1.1.3a.cmml" xref="S3.Ex5.m2.9.9.1.1.2.3">formulae-sequence</csymbol><apply id="S3.Ex5.m2.9.9.1.1.1.1.cmml" xref="S3.Ex5.m2.9.9.1.1.1.1"><eq id="S3.Ex5.m2.9.9.1.1.1.1.3.cmml" xref="S3.Ex5.m2.9.9.1.1.1.1.3"></eq><apply id="S3.Ex5.m2.9.9.1.1.1.1.4.cmml" xref="S3.Ex5.m2.9.9.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.Ex5.m2.9.9.1.1.1.1.4.1.cmml" xref="S3.Ex5.m2.9.9.1.1.1.1.4">subscript</csymbol><apply id="S3.Ex5.m2.9.9.1.1.1.1.4.2.cmml" xref="S3.Ex5.m2.9.9.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.Ex5.m2.9.9.1.1.1.1.4.2.1.cmml" xref="S3.Ex5.m2.9.9.1.1.1.1.4">superscript</csymbol><ci id="S3.Ex5.m2.9.9.1.1.1.1.4.2.2.cmml" xref="S3.Ex5.m2.9.9.1.1.1.1.4.2.2">𝑆</ci><interval closure="open" id="S3.Ex5.m2.2.2.2.3.cmml" xref="S3.Ex5.m2.2.2.2.4"><ci id="S3.Ex5.m2.1.1.1.1.cmml" xref="S3.Ex5.m2.1.1.1.1">𝑗</ci><ci id="S3.Ex5.m2.2.2.2.2.cmml" xref="S3.Ex5.m2.2.2.2.2">𝑘</ci></interval></apply><ci id="S3.Ex5.m2.9.9.1.1.1.1.4.3.cmml" xref="S3.Ex5.m2.9.9.1.1.1.1.4.3">𝑎</ci></apply><apply id="S3.Ex5.m2.9.9.1.1.1.1.2.cmml" xref="S3.Ex5.m2.9.9.1.1.1.1.2"><times id="S3.Ex5.m2.9.9.1.1.1.1.2.3.cmml" xref="S3.Ex5.m2.9.9.1.1.1.1.2.3"></times><ci id="S3.Ex5.m2.9.9.1.1.1.1.2.4.cmml" xref="S3.Ex5.m2.9.9.1.1.1.1.2.4">𝑃</ci><interval closure="open" id="S3.Ex5.m2.9.9.1.1.1.1.2.2.3.cmml" xref="S3.Ex5.m2.9.9.1.1.1.1.2.2.2"><apply id="S3.Ex5.m2.9.9.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex5.m2.9.9.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex5.m2.9.9.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex5.m2.9.9.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.Ex5.m2.9.9.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex5.m2.9.9.1.1.1.1.1.1.1.1.2">𝑔</ci><ci id="S3.Ex5.m2.9.9.1.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex5.m2.9.9.1.1.1.1.1.1.1.1.3">𝑎</ci></apply><apply id="S3.Ex5.m2.9.9.1.1.1.1.2.2.2.2.cmml" xref="S3.Ex5.m2.9.9.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.Ex5.m2.9.9.1.1.1.1.2.2.2.2.1.cmml" xref="S3.Ex5.m2.9.9.1.1.1.1.2.2.2.2">subscript</csymbol><apply id="S3.Ex5.m2.9.9.1.1.1.1.2.2.2.2.2.cmml" xref="S3.Ex5.m2.9.9.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.Ex5.m2.9.9.1.1.1.1.2.2.2.2.2.1.cmml" xref="S3.Ex5.m2.9.9.1.1.1.1.2.2.2.2">superscript</csymbol><ci id="S3.Ex5.m2.9.9.1.1.1.1.2.2.2.2.2.2.cmml" xref="S3.Ex5.m2.9.9.1.1.1.1.2.2.2.2.2.2">𝑓</ci><apply id="S3.Ex5.m2.4.4.2.cmml" xref="S3.Ex5.m2.4.4.2"><times id="S3.Ex5.m2.4.4.2.3.cmml" xref="S3.Ex5.m2.4.4.2.3"></times><ci id="S3.Ex5.m2.4.4.2.4.cmml" xref="S3.Ex5.m2.4.4.2.4">𝑚</ci><interval closure="open" id="S3.Ex5.m2.4.4.2.5.1.cmml" xref="S3.Ex5.m2.4.4.2.5.2"><ci id="S3.Ex5.m2.3.3.1.1.cmml" xref="S3.Ex5.m2.3.3.1.1">𝑗</ci><ci id="S3.Ex5.m2.4.4.2.2.cmml" xref="S3.Ex5.m2.4.4.2.2">𝑘</ci></interval></apply></apply><ci id="S3.Ex5.m2.9.9.1.1.1.1.2.2.2.2.3.cmml" xref="S3.Ex5.m2.9.9.1.1.1.1.2.2.2.2.3">𝑖</ci></apply></interval></apply></apply><apply id="S3.Ex5.m2.9.9.1.1.2.2.3.cmml" xref="S3.Ex5.m2.9.9.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.Ex5.m2.9.9.1.1.2.2.3a.cmml" xref="S3.Ex5.m2.9.9.1.1.2.2.2.3">formulae-sequence</csymbol><apply id="S3.Ex5.m2.9.9.1.1.2.2.1.1.cmml" xref="S3.Ex5.m2.9.9.1.1.2.2.1.1"><in id="S3.Ex5.m2.9.9.1.1.2.2.1.1.1.cmml" xref="S3.Ex5.m2.9.9.1.1.2.2.1.1.1"></in><ci id="S3.Ex5.m2.9.9.1.1.2.2.1.1.2.cmml" xref="S3.Ex5.m2.9.9.1.1.2.2.1.1.2">𝑗</ci><interval closure="closed" id="S3.Ex5.m2.9.9.1.1.2.2.1.1.3.1.cmml" xref="S3.Ex5.m2.9.9.1.1.2.2.1.1.3.2"><cn type="integer" id="S3.Ex5.m2.5.5.cmml" xref="S3.Ex5.m2.5.5">1</cn><ci id="S3.Ex5.m2.6.6.cmml" xref="S3.Ex5.m2.6.6">𝐻</ci></interval></apply><apply id="S3.Ex5.m2.9.9.1.1.2.2.2.2.cmml" xref="S3.Ex5.m2.9.9.1.1.2.2.2.2"><in id="S3.Ex5.m2.9.9.1.1.2.2.2.2.1.cmml" xref="S3.Ex5.m2.9.9.1.1.2.2.2.2.1"></in><ci id="S3.Ex5.m2.9.9.1.1.2.2.2.2.2.cmml" xref="S3.Ex5.m2.9.9.1.1.2.2.2.2.2">𝑘</ci><interval closure="closed" id="S3.Ex5.m2.9.9.1.1.2.2.2.2.3.1.cmml" xref="S3.Ex5.m2.9.9.1.1.2.2.2.2.3.2"><cn type="integer" id="S3.Ex5.m2.7.7.cmml" xref="S3.Ex5.m2.7.7">1</cn><ci id="S3.Ex5.m2.8.8.cmml" xref="S3.Ex5.m2.8.8">𝑊</ci></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex5.m2.9c">\displaystyle\quad S^{(j,k)}_{a}=P(g_{a},f^{m(j,k)}_{i}),j\in[1,H],k\in[1,W],</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S3.Ex6"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.Ex6.m1.2" class="ltx_Math" alttext="\displaystyle L_{local}=Focal([Up(S_{n}),Up(S_{a})],S)" display="inline"><semantics id="S3.Ex6.m1.2a"><mrow id="S3.Ex6.m1.2.2" xref="S3.Ex6.m1.2.2.cmml"><msub id="S3.Ex6.m1.2.2.3" xref="S3.Ex6.m1.2.2.3.cmml"><mi id="S3.Ex6.m1.2.2.3.2" xref="S3.Ex6.m1.2.2.3.2.cmml">L</mi><mrow id="S3.Ex6.m1.2.2.3.3" xref="S3.Ex6.m1.2.2.3.3.cmml"><mi id="S3.Ex6.m1.2.2.3.3.2" xref="S3.Ex6.m1.2.2.3.3.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.Ex6.m1.2.2.3.3.1" xref="S3.Ex6.m1.2.2.3.3.1.cmml">​</mo><mi id="S3.Ex6.m1.2.2.3.3.3" xref="S3.Ex6.m1.2.2.3.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.Ex6.m1.2.2.3.3.1a" xref="S3.Ex6.m1.2.2.3.3.1.cmml">​</mo><mi id="S3.Ex6.m1.2.2.3.3.4" xref="S3.Ex6.m1.2.2.3.3.4.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.Ex6.m1.2.2.3.3.1b" xref="S3.Ex6.m1.2.2.3.3.1.cmml">​</mo><mi id="S3.Ex6.m1.2.2.3.3.5" xref="S3.Ex6.m1.2.2.3.3.5.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.Ex6.m1.2.2.3.3.1c" xref="S3.Ex6.m1.2.2.3.3.1.cmml">​</mo><mi id="S3.Ex6.m1.2.2.3.3.6" xref="S3.Ex6.m1.2.2.3.3.6.cmml">l</mi></mrow></msub><mo id="S3.Ex6.m1.2.2.2" xref="S3.Ex6.m1.2.2.2.cmml">=</mo><mrow id="S3.Ex6.m1.2.2.1" xref="S3.Ex6.m1.2.2.1.cmml"><mi id="S3.Ex6.m1.2.2.1.3" xref="S3.Ex6.m1.2.2.1.3.cmml">F</mi><mo lspace="0em" rspace="0em" id="S3.Ex6.m1.2.2.1.2" xref="S3.Ex6.m1.2.2.1.2.cmml">​</mo><mi id="S3.Ex6.m1.2.2.1.4" xref="S3.Ex6.m1.2.2.1.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.Ex6.m1.2.2.1.2a" xref="S3.Ex6.m1.2.2.1.2.cmml">​</mo><mi id="S3.Ex6.m1.2.2.1.5" xref="S3.Ex6.m1.2.2.1.5.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.Ex6.m1.2.2.1.2b" xref="S3.Ex6.m1.2.2.1.2.cmml">​</mo><mi id="S3.Ex6.m1.2.2.1.6" xref="S3.Ex6.m1.2.2.1.6.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.Ex6.m1.2.2.1.2c" xref="S3.Ex6.m1.2.2.1.2.cmml">​</mo><mi id="S3.Ex6.m1.2.2.1.7" xref="S3.Ex6.m1.2.2.1.7.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.Ex6.m1.2.2.1.2d" xref="S3.Ex6.m1.2.2.1.2.cmml">​</mo><mrow id="S3.Ex6.m1.2.2.1.1.1" xref="S3.Ex6.m1.2.2.1.1.2.cmml"><mo stretchy="false" id="S3.Ex6.m1.2.2.1.1.1.2" xref="S3.Ex6.m1.2.2.1.1.2.cmml">(</mo><mrow id="S3.Ex6.m1.2.2.1.1.1.1.2" xref="S3.Ex6.m1.2.2.1.1.1.1.3.cmml"><mo stretchy="false" id="S3.Ex6.m1.2.2.1.1.1.1.2.3" xref="S3.Ex6.m1.2.2.1.1.1.1.3.cmml">[</mo><mrow id="S3.Ex6.m1.2.2.1.1.1.1.1.1" xref="S3.Ex6.m1.2.2.1.1.1.1.1.1.cmml"><mi id="S3.Ex6.m1.2.2.1.1.1.1.1.1.3" xref="S3.Ex6.m1.2.2.1.1.1.1.1.1.3.cmml">U</mi><mo lspace="0em" rspace="0em" id="S3.Ex6.m1.2.2.1.1.1.1.1.1.2" xref="S3.Ex6.m1.2.2.1.1.1.1.1.1.2.cmml">​</mo><mi id="S3.Ex6.m1.2.2.1.1.1.1.1.1.4" xref="S3.Ex6.m1.2.2.1.1.1.1.1.1.4.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.Ex6.m1.2.2.1.1.1.1.1.1.2a" xref="S3.Ex6.m1.2.2.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.Ex6.m1.2.2.1.1.1.1.1.1.1.1" xref="S3.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.Ex6.m1.2.2.1.1.1.1.1.1.1.1.2" xref="S3.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1" xref="S3.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.2" xref="S3.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml">S</mi><mi id="S3.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.3" xref="S3.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.3.cmml">n</mi></msub><mo stretchy="false" id="S3.Ex6.m1.2.2.1.1.1.1.1.1.1.1.3" xref="S3.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.Ex6.m1.2.2.1.1.1.1.2.4" xref="S3.Ex6.m1.2.2.1.1.1.1.3.cmml">,</mo><mrow id="S3.Ex6.m1.2.2.1.1.1.1.2.2" xref="S3.Ex6.m1.2.2.1.1.1.1.2.2.cmml"><mi id="S3.Ex6.m1.2.2.1.1.1.1.2.2.3" xref="S3.Ex6.m1.2.2.1.1.1.1.2.2.3.cmml">U</mi><mo lspace="0em" rspace="0em" id="S3.Ex6.m1.2.2.1.1.1.1.2.2.2" xref="S3.Ex6.m1.2.2.1.1.1.1.2.2.2.cmml">​</mo><mi id="S3.Ex6.m1.2.2.1.1.1.1.2.2.4" xref="S3.Ex6.m1.2.2.1.1.1.1.2.2.4.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.Ex6.m1.2.2.1.1.1.1.2.2.2a" xref="S3.Ex6.m1.2.2.1.1.1.1.2.2.2.cmml">​</mo><mrow id="S3.Ex6.m1.2.2.1.1.1.1.2.2.1.1" xref="S3.Ex6.m1.2.2.1.1.1.1.2.2.1.1.1.cmml"><mo stretchy="false" id="S3.Ex6.m1.2.2.1.1.1.1.2.2.1.1.2" xref="S3.Ex6.m1.2.2.1.1.1.1.2.2.1.1.1.cmml">(</mo><msub id="S3.Ex6.m1.2.2.1.1.1.1.2.2.1.1.1" xref="S3.Ex6.m1.2.2.1.1.1.1.2.2.1.1.1.cmml"><mi id="S3.Ex6.m1.2.2.1.1.1.1.2.2.1.1.1.2" xref="S3.Ex6.m1.2.2.1.1.1.1.2.2.1.1.1.2.cmml">S</mi><mi id="S3.Ex6.m1.2.2.1.1.1.1.2.2.1.1.1.3" xref="S3.Ex6.m1.2.2.1.1.1.1.2.2.1.1.1.3.cmml">a</mi></msub><mo stretchy="false" id="S3.Ex6.m1.2.2.1.1.1.1.2.2.1.1.3" xref="S3.Ex6.m1.2.2.1.1.1.1.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.Ex6.m1.2.2.1.1.1.1.2.5" xref="S3.Ex6.m1.2.2.1.1.1.1.3.cmml">]</mo></mrow><mo id="S3.Ex6.m1.2.2.1.1.1.3" xref="S3.Ex6.m1.2.2.1.1.2.cmml">,</mo><mi id="S3.Ex6.m1.1.1" xref="S3.Ex6.m1.1.1.cmml">S</mi><mo stretchy="false" id="S3.Ex6.m1.2.2.1.1.1.4" xref="S3.Ex6.m1.2.2.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex6.m1.2b"><apply id="S3.Ex6.m1.2.2.cmml" xref="S3.Ex6.m1.2.2"><eq id="S3.Ex6.m1.2.2.2.cmml" xref="S3.Ex6.m1.2.2.2"></eq><apply id="S3.Ex6.m1.2.2.3.cmml" xref="S3.Ex6.m1.2.2.3"><csymbol cd="ambiguous" id="S3.Ex6.m1.2.2.3.1.cmml" xref="S3.Ex6.m1.2.2.3">subscript</csymbol><ci id="S3.Ex6.m1.2.2.3.2.cmml" xref="S3.Ex6.m1.2.2.3.2">𝐿</ci><apply id="S3.Ex6.m1.2.2.3.3.cmml" xref="S3.Ex6.m1.2.2.3.3"><times id="S3.Ex6.m1.2.2.3.3.1.cmml" xref="S3.Ex6.m1.2.2.3.3.1"></times><ci id="S3.Ex6.m1.2.2.3.3.2.cmml" xref="S3.Ex6.m1.2.2.3.3.2">𝑙</ci><ci id="S3.Ex6.m1.2.2.3.3.3.cmml" xref="S3.Ex6.m1.2.2.3.3.3">𝑜</ci><ci id="S3.Ex6.m1.2.2.3.3.4.cmml" xref="S3.Ex6.m1.2.2.3.3.4">𝑐</ci><ci id="S3.Ex6.m1.2.2.3.3.5.cmml" xref="S3.Ex6.m1.2.2.3.3.5">𝑎</ci><ci id="S3.Ex6.m1.2.2.3.3.6.cmml" xref="S3.Ex6.m1.2.2.3.3.6">𝑙</ci></apply></apply><apply id="S3.Ex6.m1.2.2.1.cmml" xref="S3.Ex6.m1.2.2.1"><times id="S3.Ex6.m1.2.2.1.2.cmml" xref="S3.Ex6.m1.2.2.1.2"></times><ci id="S3.Ex6.m1.2.2.1.3.cmml" xref="S3.Ex6.m1.2.2.1.3">𝐹</ci><ci id="S3.Ex6.m1.2.2.1.4.cmml" xref="S3.Ex6.m1.2.2.1.4">𝑜</ci><ci id="S3.Ex6.m1.2.2.1.5.cmml" xref="S3.Ex6.m1.2.2.1.5">𝑐</ci><ci id="S3.Ex6.m1.2.2.1.6.cmml" xref="S3.Ex6.m1.2.2.1.6">𝑎</ci><ci id="S3.Ex6.m1.2.2.1.7.cmml" xref="S3.Ex6.m1.2.2.1.7">𝑙</ci><interval closure="open" id="S3.Ex6.m1.2.2.1.1.2.cmml" xref="S3.Ex6.m1.2.2.1.1.1"><interval closure="closed" id="S3.Ex6.m1.2.2.1.1.1.1.3.cmml" xref="S3.Ex6.m1.2.2.1.1.1.1.2"><apply id="S3.Ex6.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.Ex6.m1.2.2.1.1.1.1.1.1"><times id="S3.Ex6.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S3.Ex6.m1.2.2.1.1.1.1.1.1.2"></times><ci id="S3.Ex6.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S3.Ex6.m1.2.2.1.1.1.1.1.1.3">𝑈</ci><ci id="S3.Ex6.m1.2.2.1.1.1.1.1.1.4.cmml" xref="S3.Ex6.m1.2.2.1.1.1.1.1.1.4">𝑝</ci><apply id="S3.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex6.m1.2.2.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex6.m1.2.2.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.2">𝑆</ci><ci id="S3.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.3">𝑛</ci></apply></apply><apply id="S3.Ex6.m1.2.2.1.1.1.1.2.2.cmml" xref="S3.Ex6.m1.2.2.1.1.1.1.2.2"><times id="S3.Ex6.m1.2.2.1.1.1.1.2.2.2.cmml" xref="S3.Ex6.m1.2.2.1.1.1.1.2.2.2"></times><ci id="S3.Ex6.m1.2.2.1.1.1.1.2.2.3.cmml" xref="S3.Ex6.m1.2.2.1.1.1.1.2.2.3">𝑈</ci><ci id="S3.Ex6.m1.2.2.1.1.1.1.2.2.4.cmml" xref="S3.Ex6.m1.2.2.1.1.1.1.2.2.4">𝑝</ci><apply id="S3.Ex6.m1.2.2.1.1.1.1.2.2.1.1.1.cmml" xref="S3.Ex6.m1.2.2.1.1.1.1.2.2.1.1"><csymbol cd="ambiguous" id="S3.Ex6.m1.2.2.1.1.1.1.2.2.1.1.1.1.cmml" xref="S3.Ex6.m1.2.2.1.1.1.1.2.2.1.1">subscript</csymbol><ci id="S3.Ex6.m1.2.2.1.1.1.1.2.2.1.1.1.2.cmml" xref="S3.Ex6.m1.2.2.1.1.1.1.2.2.1.1.1.2">𝑆</ci><ci id="S3.Ex6.m1.2.2.1.1.1.1.2.2.1.1.1.3.cmml" xref="S3.Ex6.m1.2.2.1.1.1.1.2.2.1.1.1.3">𝑎</ci></apply></apply></interval><ci id="S3.Ex6.m1.1.1.cmml" xref="S3.Ex6.m1.1.1">𝑆</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex6.m1.2c">\displaystyle L_{local}=Focal([Up(S_{n}),Up(S_{a})],S)</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.Ex6.m2.2" class="ltx_Math" alttext="\displaystyle+Dice(Up(S_{n}),I-S)+Dice(Up(S_{a}),S)," display="inline"><semantics id="S3.Ex6.m2.2a"><mrow id="S3.Ex6.m2.2.2.1" xref="S3.Ex6.m2.2.2.1.1.cmml"><mrow id="S3.Ex6.m2.2.2.1.1" xref="S3.Ex6.m2.2.2.1.1.cmml"><mrow id="S3.Ex6.m2.2.2.1.1.2" xref="S3.Ex6.m2.2.2.1.1.2.cmml"><mo id="S3.Ex6.m2.2.2.1.1.2a" xref="S3.Ex6.m2.2.2.1.1.2.cmml">+</mo><mrow id="S3.Ex6.m2.2.2.1.1.2.2" xref="S3.Ex6.m2.2.2.1.1.2.2.cmml"><mi id="S3.Ex6.m2.2.2.1.1.2.2.4" xref="S3.Ex6.m2.2.2.1.1.2.2.4.cmml">D</mi><mo lspace="0em" rspace="0em" id="S3.Ex6.m2.2.2.1.1.2.2.3" xref="S3.Ex6.m2.2.2.1.1.2.2.3.cmml">​</mo><mi id="S3.Ex6.m2.2.2.1.1.2.2.5" xref="S3.Ex6.m2.2.2.1.1.2.2.5.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.Ex6.m2.2.2.1.1.2.2.3a" xref="S3.Ex6.m2.2.2.1.1.2.2.3.cmml">​</mo><mi id="S3.Ex6.m2.2.2.1.1.2.2.6" xref="S3.Ex6.m2.2.2.1.1.2.2.6.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.Ex6.m2.2.2.1.1.2.2.3b" xref="S3.Ex6.m2.2.2.1.1.2.2.3.cmml">​</mo><mi id="S3.Ex6.m2.2.2.1.1.2.2.7" xref="S3.Ex6.m2.2.2.1.1.2.2.7.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.Ex6.m2.2.2.1.1.2.2.3c" xref="S3.Ex6.m2.2.2.1.1.2.2.3.cmml">​</mo><mrow id="S3.Ex6.m2.2.2.1.1.2.2.2.2" xref="S3.Ex6.m2.2.2.1.1.2.2.2.3.cmml"><mo stretchy="false" id="S3.Ex6.m2.2.2.1.1.2.2.2.2.3" xref="S3.Ex6.m2.2.2.1.1.2.2.2.3.cmml">(</mo><mrow id="S3.Ex6.m2.2.2.1.1.1.1.1.1.1" xref="S3.Ex6.m2.2.2.1.1.1.1.1.1.1.cmml"><mi id="S3.Ex6.m2.2.2.1.1.1.1.1.1.1.3" xref="S3.Ex6.m2.2.2.1.1.1.1.1.1.1.3.cmml">U</mi><mo lspace="0em" rspace="0em" id="S3.Ex6.m2.2.2.1.1.1.1.1.1.1.2" xref="S3.Ex6.m2.2.2.1.1.1.1.1.1.1.2.cmml">​</mo><mi id="S3.Ex6.m2.2.2.1.1.1.1.1.1.1.4" xref="S3.Ex6.m2.2.2.1.1.1.1.1.1.1.4.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.Ex6.m2.2.2.1.1.1.1.1.1.1.2a" xref="S3.Ex6.m2.2.2.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.Ex6.m2.2.2.1.1.1.1.1.1.1.1.1" xref="S3.Ex6.m2.2.2.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.Ex6.m2.2.2.1.1.1.1.1.1.1.1.1.2" xref="S3.Ex6.m2.2.2.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.Ex6.m2.2.2.1.1.1.1.1.1.1.1.1.1" xref="S3.Ex6.m2.2.2.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.Ex6.m2.2.2.1.1.1.1.1.1.1.1.1.1.2" xref="S3.Ex6.m2.2.2.1.1.1.1.1.1.1.1.1.1.2.cmml">S</mi><mi id="S3.Ex6.m2.2.2.1.1.1.1.1.1.1.1.1.1.3" xref="S3.Ex6.m2.2.2.1.1.1.1.1.1.1.1.1.1.3.cmml">n</mi></msub><mo stretchy="false" id="S3.Ex6.m2.2.2.1.1.1.1.1.1.1.1.1.3" xref="S3.Ex6.m2.2.2.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.Ex6.m2.2.2.1.1.2.2.2.2.4" xref="S3.Ex6.m2.2.2.1.1.2.2.2.3.cmml">,</mo><mrow id="S3.Ex6.m2.2.2.1.1.2.2.2.2.2" xref="S3.Ex6.m2.2.2.1.1.2.2.2.2.2.cmml"><mi id="S3.Ex6.m2.2.2.1.1.2.2.2.2.2.2" xref="S3.Ex6.m2.2.2.1.1.2.2.2.2.2.2.cmml">I</mi><mo id="S3.Ex6.m2.2.2.1.1.2.2.2.2.2.1" xref="S3.Ex6.m2.2.2.1.1.2.2.2.2.2.1.cmml">−</mo><mi id="S3.Ex6.m2.2.2.1.1.2.2.2.2.2.3" xref="S3.Ex6.m2.2.2.1.1.2.2.2.2.2.3.cmml">S</mi></mrow><mo stretchy="false" id="S3.Ex6.m2.2.2.1.1.2.2.2.2.5" xref="S3.Ex6.m2.2.2.1.1.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S3.Ex6.m2.2.2.1.1.4" xref="S3.Ex6.m2.2.2.1.1.4.cmml">+</mo><mrow id="S3.Ex6.m2.2.2.1.1.3" xref="S3.Ex6.m2.2.2.1.1.3.cmml"><mi id="S3.Ex6.m2.2.2.1.1.3.3" xref="S3.Ex6.m2.2.2.1.1.3.3.cmml">D</mi><mo lspace="0em" rspace="0em" id="S3.Ex6.m2.2.2.1.1.3.2" xref="S3.Ex6.m2.2.2.1.1.3.2.cmml">​</mo><mi id="S3.Ex6.m2.2.2.1.1.3.4" xref="S3.Ex6.m2.2.2.1.1.3.4.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.Ex6.m2.2.2.1.1.3.2a" xref="S3.Ex6.m2.2.2.1.1.3.2.cmml">​</mo><mi id="S3.Ex6.m2.2.2.1.1.3.5" xref="S3.Ex6.m2.2.2.1.1.3.5.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.Ex6.m2.2.2.1.1.3.2b" xref="S3.Ex6.m2.2.2.1.1.3.2.cmml">​</mo><mi id="S3.Ex6.m2.2.2.1.1.3.6" xref="S3.Ex6.m2.2.2.1.1.3.6.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.Ex6.m2.2.2.1.1.3.2c" xref="S3.Ex6.m2.2.2.1.1.3.2.cmml">​</mo><mrow id="S3.Ex6.m2.2.2.1.1.3.1.1" xref="S3.Ex6.m2.2.2.1.1.3.1.2.cmml"><mo stretchy="false" id="S3.Ex6.m2.2.2.1.1.3.1.1.2" xref="S3.Ex6.m2.2.2.1.1.3.1.2.cmml">(</mo><mrow id="S3.Ex6.m2.2.2.1.1.3.1.1.1" xref="S3.Ex6.m2.2.2.1.1.3.1.1.1.cmml"><mi id="S3.Ex6.m2.2.2.1.1.3.1.1.1.3" xref="S3.Ex6.m2.2.2.1.1.3.1.1.1.3.cmml">U</mi><mo lspace="0em" rspace="0em" id="S3.Ex6.m2.2.2.1.1.3.1.1.1.2" xref="S3.Ex6.m2.2.2.1.1.3.1.1.1.2.cmml">​</mo><mi id="S3.Ex6.m2.2.2.1.1.3.1.1.1.4" xref="S3.Ex6.m2.2.2.1.1.3.1.1.1.4.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.Ex6.m2.2.2.1.1.3.1.1.1.2a" xref="S3.Ex6.m2.2.2.1.1.3.1.1.1.2.cmml">​</mo><mrow id="S3.Ex6.m2.2.2.1.1.3.1.1.1.1.1" xref="S3.Ex6.m2.2.2.1.1.3.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.Ex6.m2.2.2.1.1.3.1.1.1.1.1.2" xref="S3.Ex6.m2.2.2.1.1.3.1.1.1.1.1.1.cmml">(</mo><msub id="S3.Ex6.m2.2.2.1.1.3.1.1.1.1.1.1" xref="S3.Ex6.m2.2.2.1.1.3.1.1.1.1.1.1.cmml"><mi id="S3.Ex6.m2.2.2.1.1.3.1.1.1.1.1.1.2" xref="S3.Ex6.m2.2.2.1.1.3.1.1.1.1.1.1.2.cmml">S</mi><mi id="S3.Ex6.m2.2.2.1.1.3.1.1.1.1.1.1.3" xref="S3.Ex6.m2.2.2.1.1.3.1.1.1.1.1.1.3.cmml">a</mi></msub><mo stretchy="false" id="S3.Ex6.m2.2.2.1.1.3.1.1.1.1.1.3" xref="S3.Ex6.m2.2.2.1.1.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.Ex6.m2.2.2.1.1.3.1.1.3" xref="S3.Ex6.m2.2.2.1.1.3.1.2.cmml">,</mo><mi id="S3.Ex6.m2.1.1" xref="S3.Ex6.m2.1.1.cmml">S</mi><mo stretchy="false" id="S3.Ex6.m2.2.2.1.1.3.1.1.4" xref="S3.Ex6.m2.2.2.1.1.3.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S3.Ex6.m2.2.2.1.2" xref="S3.Ex6.m2.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex6.m2.2b"><apply id="S3.Ex6.m2.2.2.1.1.cmml" xref="S3.Ex6.m2.2.2.1"><plus id="S3.Ex6.m2.2.2.1.1.4.cmml" xref="S3.Ex6.m2.2.2.1.1.4"></plus><apply id="S3.Ex6.m2.2.2.1.1.2.cmml" xref="S3.Ex6.m2.2.2.1.1.2"><plus id="S3.Ex6.m2.2.2.1.1.2.3.cmml" xref="S3.Ex6.m2.2.2.1.1.2"></plus><apply id="S3.Ex6.m2.2.2.1.1.2.2.cmml" xref="S3.Ex6.m2.2.2.1.1.2.2"><times id="S3.Ex6.m2.2.2.1.1.2.2.3.cmml" xref="S3.Ex6.m2.2.2.1.1.2.2.3"></times><ci id="S3.Ex6.m2.2.2.1.1.2.2.4.cmml" xref="S3.Ex6.m2.2.2.1.1.2.2.4">𝐷</ci><ci id="S3.Ex6.m2.2.2.1.1.2.2.5.cmml" xref="S3.Ex6.m2.2.2.1.1.2.2.5">𝑖</ci><ci id="S3.Ex6.m2.2.2.1.1.2.2.6.cmml" xref="S3.Ex6.m2.2.2.1.1.2.2.6">𝑐</ci><ci id="S3.Ex6.m2.2.2.1.1.2.2.7.cmml" xref="S3.Ex6.m2.2.2.1.1.2.2.7">𝑒</ci><interval closure="open" id="S3.Ex6.m2.2.2.1.1.2.2.2.3.cmml" xref="S3.Ex6.m2.2.2.1.1.2.2.2.2"><apply id="S3.Ex6.m2.2.2.1.1.1.1.1.1.1.cmml" xref="S3.Ex6.m2.2.2.1.1.1.1.1.1.1"><times id="S3.Ex6.m2.2.2.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex6.m2.2.2.1.1.1.1.1.1.1.2"></times><ci id="S3.Ex6.m2.2.2.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex6.m2.2.2.1.1.1.1.1.1.1.3">𝑈</ci><ci id="S3.Ex6.m2.2.2.1.1.1.1.1.1.1.4.cmml" xref="S3.Ex6.m2.2.2.1.1.1.1.1.1.1.4">𝑝</ci><apply id="S3.Ex6.m2.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex6.m2.2.2.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex6.m2.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex6.m2.2.2.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.Ex6.m2.2.2.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex6.m2.2.2.1.1.1.1.1.1.1.1.1.1.2">𝑆</ci><ci id="S3.Ex6.m2.2.2.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex6.m2.2.2.1.1.1.1.1.1.1.1.1.1.3">𝑛</ci></apply></apply><apply id="S3.Ex6.m2.2.2.1.1.2.2.2.2.2.cmml" xref="S3.Ex6.m2.2.2.1.1.2.2.2.2.2"><minus id="S3.Ex6.m2.2.2.1.1.2.2.2.2.2.1.cmml" xref="S3.Ex6.m2.2.2.1.1.2.2.2.2.2.1"></minus><ci id="S3.Ex6.m2.2.2.1.1.2.2.2.2.2.2.cmml" xref="S3.Ex6.m2.2.2.1.1.2.2.2.2.2.2">𝐼</ci><ci id="S3.Ex6.m2.2.2.1.1.2.2.2.2.2.3.cmml" xref="S3.Ex6.m2.2.2.1.1.2.2.2.2.2.3">𝑆</ci></apply></interval></apply></apply><apply id="S3.Ex6.m2.2.2.1.1.3.cmml" xref="S3.Ex6.m2.2.2.1.1.3"><times id="S3.Ex6.m2.2.2.1.1.3.2.cmml" xref="S3.Ex6.m2.2.2.1.1.3.2"></times><ci id="S3.Ex6.m2.2.2.1.1.3.3.cmml" xref="S3.Ex6.m2.2.2.1.1.3.3">𝐷</ci><ci id="S3.Ex6.m2.2.2.1.1.3.4.cmml" xref="S3.Ex6.m2.2.2.1.1.3.4">𝑖</ci><ci id="S3.Ex6.m2.2.2.1.1.3.5.cmml" xref="S3.Ex6.m2.2.2.1.1.3.5">𝑐</ci><ci id="S3.Ex6.m2.2.2.1.1.3.6.cmml" xref="S3.Ex6.m2.2.2.1.1.3.6">𝑒</ci><interval closure="open" id="S3.Ex6.m2.2.2.1.1.3.1.2.cmml" xref="S3.Ex6.m2.2.2.1.1.3.1.1"><apply id="S3.Ex6.m2.2.2.1.1.3.1.1.1.cmml" xref="S3.Ex6.m2.2.2.1.1.3.1.1.1"><times id="S3.Ex6.m2.2.2.1.1.3.1.1.1.2.cmml" xref="S3.Ex6.m2.2.2.1.1.3.1.1.1.2"></times><ci id="S3.Ex6.m2.2.2.1.1.3.1.1.1.3.cmml" xref="S3.Ex6.m2.2.2.1.1.3.1.1.1.3">𝑈</ci><ci id="S3.Ex6.m2.2.2.1.1.3.1.1.1.4.cmml" xref="S3.Ex6.m2.2.2.1.1.3.1.1.1.4">𝑝</ci><apply id="S3.Ex6.m2.2.2.1.1.3.1.1.1.1.1.1.cmml" xref="S3.Ex6.m2.2.2.1.1.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex6.m2.2.2.1.1.3.1.1.1.1.1.1.1.cmml" xref="S3.Ex6.m2.2.2.1.1.3.1.1.1.1.1">subscript</csymbol><ci id="S3.Ex6.m2.2.2.1.1.3.1.1.1.1.1.1.2.cmml" xref="S3.Ex6.m2.2.2.1.1.3.1.1.1.1.1.1.2">𝑆</ci><ci id="S3.Ex6.m2.2.2.1.1.3.1.1.1.1.1.1.3.cmml" xref="S3.Ex6.m2.2.2.1.1.3.1.1.1.1.1.1.3">𝑎</ci></apply></apply><ci id="S3.Ex6.m2.1.1.cmml" xref="S3.Ex6.m2.1.1">𝑆</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex6.m2.2c">\displaystyle+Dice(Up(S_{n}),I-S)+Dice(Up(S_{a}),S),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S3.SS3.SSS0.Px1.p1.15" class="ltx_p">where <math id="S3.SS3.SSS0.Px1.p1.9.m1.2" class="ltx_Math" alttext="Focal(\cdot,\cdot)" display="inline"><semantics id="S3.SS3.SSS0.Px1.p1.9.m1.2a"><mrow id="S3.SS3.SSS0.Px1.p1.9.m1.2.3" xref="S3.SS3.SSS0.Px1.p1.9.m1.2.3.cmml"><mi id="S3.SS3.SSS0.Px1.p1.9.m1.2.3.2" xref="S3.SS3.SSS0.Px1.p1.9.m1.2.3.2.cmml">F</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS0.Px1.p1.9.m1.2.3.1" xref="S3.SS3.SSS0.Px1.p1.9.m1.2.3.1.cmml">​</mo><mi id="S3.SS3.SSS0.Px1.p1.9.m1.2.3.3" xref="S3.SS3.SSS0.Px1.p1.9.m1.2.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS0.Px1.p1.9.m1.2.3.1a" xref="S3.SS3.SSS0.Px1.p1.9.m1.2.3.1.cmml">​</mo><mi id="S3.SS3.SSS0.Px1.p1.9.m1.2.3.4" xref="S3.SS3.SSS0.Px1.p1.9.m1.2.3.4.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS0.Px1.p1.9.m1.2.3.1b" xref="S3.SS3.SSS0.Px1.p1.9.m1.2.3.1.cmml">​</mo><mi id="S3.SS3.SSS0.Px1.p1.9.m1.2.3.5" xref="S3.SS3.SSS0.Px1.p1.9.m1.2.3.5.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS0.Px1.p1.9.m1.2.3.1c" xref="S3.SS3.SSS0.Px1.p1.9.m1.2.3.1.cmml">​</mo><mi id="S3.SS3.SSS0.Px1.p1.9.m1.2.3.6" xref="S3.SS3.SSS0.Px1.p1.9.m1.2.3.6.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS0.Px1.p1.9.m1.2.3.1d" xref="S3.SS3.SSS0.Px1.p1.9.m1.2.3.1.cmml">​</mo><mrow id="S3.SS3.SSS0.Px1.p1.9.m1.2.3.7.2" xref="S3.SS3.SSS0.Px1.p1.9.m1.2.3.7.1.cmml"><mo stretchy="false" id="S3.SS3.SSS0.Px1.p1.9.m1.2.3.7.2.1" xref="S3.SS3.SSS0.Px1.p1.9.m1.2.3.7.1.cmml">(</mo><mo lspace="0em" rspace="0em" id="S3.SS3.SSS0.Px1.p1.9.m1.1.1" xref="S3.SS3.SSS0.Px1.p1.9.m1.1.1.cmml">⋅</mo><mo rspace="0em" id="S3.SS3.SSS0.Px1.p1.9.m1.2.3.7.2.2" xref="S3.SS3.SSS0.Px1.p1.9.m1.2.3.7.1.cmml">,</mo><mo lspace="0em" rspace="0em" id="S3.SS3.SSS0.Px1.p1.9.m1.2.2" xref="S3.SS3.SSS0.Px1.p1.9.m1.2.2.cmml">⋅</mo><mo stretchy="false" id="S3.SS3.SSS0.Px1.p1.9.m1.2.3.7.2.3" xref="S3.SS3.SSS0.Px1.p1.9.m1.2.3.7.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p1.9.m1.2b"><apply id="S3.SS3.SSS0.Px1.p1.9.m1.2.3.cmml" xref="S3.SS3.SSS0.Px1.p1.9.m1.2.3"><times id="S3.SS3.SSS0.Px1.p1.9.m1.2.3.1.cmml" xref="S3.SS3.SSS0.Px1.p1.9.m1.2.3.1"></times><ci id="S3.SS3.SSS0.Px1.p1.9.m1.2.3.2.cmml" xref="S3.SS3.SSS0.Px1.p1.9.m1.2.3.2">𝐹</ci><ci id="S3.SS3.SSS0.Px1.p1.9.m1.2.3.3.cmml" xref="S3.SS3.SSS0.Px1.p1.9.m1.2.3.3">𝑜</ci><ci id="S3.SS3.SSS0.Px1.p1.9.m1.2.3.4.cmml" xref="S3.SS3.SSS0.Px1.p1.9.m1.2.3.4">𝑐</ci><ci id="S3.SS3.SSS0.Px1.p1.9.m1.2.3.5.cmml" xref="S3.SS3.SSS0.Px1.p1.9.m1.2.3.5">𝑎</ci><ci id="S3.SS3.SSS0.Px1.p1.9.m1.2.3.6.cmml" xref="S3.SS3.SSS0.Px1.p1.9.m1.2.3.6">𝑙</ci><interval closure="open" id="S3.SS3.SSS0.Px1.p1.9.m1.2.3.7.1.cmml" xref="S3.SS3.SSS0.Px1.p1.9.m1.2.3.7.2"><ci id="S3.SS3.SSS0.Px1.p1.9.m1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.9.m1.1.1">⋅</ci><ci id="S3.SS3.SSS0.Px1.p1.9.m1.2.2.cmml" xref="S3.SS3.SSS0.Px1.p1.9.m1.2.2">⋅</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p1.9.m1.2c">Focal(\cdot,\cdot)</annotation></semantics></math> and <math id="S3.SS3.SSS0.Px1.p1.10.m2.2" class="ltx_Math" alttext="Dice(\cdot,\cdot)" display="inline"><semantics id="S3.SS3.SSS0.Px1.p1.10.m2.2a"><mrow id="S3.SS3.SSS0.Px1.p1.10.m2.2.3" xref="S3.SS3.SSS0.Px1.p1.10.m2.2.3.cmml"><mi id="S3.SS3.SSS0.Px1.p1.10.m2.2.3.2" xref="S3.SS3.SSS0.Px1.p1.10.m2.2.3.2.cmml">D</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS0.Px1.p1.10.m2.2.3.1" xref="S3.SS3.SSS0.Px1.p1.10.m2.2.3.1.cmml">​</mo><mi id="S3.SS3.SSS0.Px1.p1.10.m2.2.3.3" xref="S3.SS3.SSS0.Px1.p1.10.m2.2.3.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS0.Px1.p1.10.m2.2.3.1a" xref="S3.SS3.SSS0.Px1.p1.10.m2.2.3.1.cmml">​</mo><mi id="S3.SS3.SSS0.Px1.p1.10.m2.2.3.4" xref="S3.SS3.SSS0.Px1.p1.10.m2.2.3.4.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS0.Px1.p1.10.m2.2.3.1b" xref="S3.SS3.SSS0.Px1.p1.10.m2.2.3.1.cmml">​</mo><mi id="S3.SS3.SSS0.Px1.p1.10.m2.2.3.5" xref="S3.SS3.SSS0.Px1.p1.10.m2.2.3.5.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS0.Px1.p1.10.m2.2.3.1c" xref="S3.SS3.SSS0.Px1.p1.10.m2.2.3.1.cmml">​</mo><mrow id="S3.SS3.SSS0.Px1.p1.10.m2.2.3.6.2" xref="S3.SS3.SSS0.Px1.p1.10.m2.2.3.6.1.cmml"><mo stretchy="false" id="S3.SS3.SSS0.Px1.p1.10.m2.2.3.6.2.1" xref="S3.SS3.SSS0.Px1.p1.10.m2.2.3.6.1.cmml">(</mo><mo lspace="0em" rspace="0em" id="S3.SS3.SSS0.Px1.p1.10.m2.1.1" xref="S3.SS3.SSS0.Px1.p1.10.m2.1.1.cmml">⋅</mo><mo rspace="0em" id="S3.SS3.SSS0.Px1.p1.10.m2.2.3.6.2.2" xref="S3.SS3.SSS0.Px1.p1.10.m2.2.3.6.1.cmml">,</mo><mo lspace="0em" rspace="0em" id="S3.SS3.SSS0.Px1.p1.10.m2.2.2" xref="S3.SS3.SSS0.Px1.p1.10.m2.2.2.cmml">⋅</mo><mo stretchy="false" id="S3.SS3.SSS0.Px1.p1.10.m2.2.3.6.2.3" xref="S3.SS3.SSS0.Px1.p1.10.m2.2.3.6.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p1.10.m2.2b"><apply id="S3.SS3.SSS0.Px1.p1.10.m2.2.3.cmml" xref="S3.SS3.SSS0.Px1.p1.10.m2.2.3"><times id="S3.SS3.SSS0.Px1.p1.10.m2.2.3.1.cmml" xref="S3.SS3.SSS0.Px1.p1.10.m2.2.3.1"></times><ci id="S3.SS3.SSS0.Px1.p1.10.m2.2.3.2.cmml" xref="S3.SS3.SSS0.Px1.p1.10.m2.2.3.2">𝐷</ci><ci id="S3.SS3.SSS0.Px1.p1.10.m2.2.3.3.cmml" xref="S3.SS3.SSS0.Px1.p1.10.m2.2.3.3">𝑖</ci><ci id="S3.SS3.SSS0.Px1.p1.10.m2.2.3.4.cmml" xref="S3.SS3.SSS0.Px1.p1.10.m2.2.3.4">𝑐</ci><ci id="S3.SS3.SSS0.Px1.p1.10.m2.2.3.5.cmml" xref="S3.SS3.SSS0.Px1.p1.10.m2.2.3.5">𝑒</ci><interval closure="open" id="S3.SS3.SSS0.Px1.p1.10.m2.2.3.6.1.cmml" xref="S3.SS3.SSS0.Px1.p1.10.m2.2.3.6.2"><ci id="S3.SS3.SSS0.Px1.p1.10.m2.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.10.m2.1.1">⋅</ci><ci id="S3.SS3.SSS0.Px1.p1.10.m2.2.2.cmml" xref="S3.SS3.SSS0.Px1.p1.10.m2.2.2">⋅</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p1.10.m2.2c">Dice(\cdot,\cdot)</annotation></semantics></math> denote a focal loss <cite class="ltx_cite ltx_citemacro_citep">(Lin et al., <a href="#bib.bib31" title="" class="ltx_ref">2017</a>)</cite> and a Dice loss <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a href="#bib.bib29" title="" class="ltx_ref">2019</a>)</cite> respectively. The operators <math id="S3.SS3.SSS0.Px1.p1.11.m3.2" class="ltx_Math" alttext="[\cdot,\cdot]" display="inline"><semantics id="S3.SS3.SSS0.Px1.p1.11.m3.2a"><mrow id="S3.SS3.SSS0.Px1.p1.11.m3.2.3.2" xref="S3.SS3.SSS0.Px1.p1.11.m3.2.3.1.cmml"><mo stretchy="false" id="S3.SS3.SSS0.Px1.p1.11.m3.2.3.2.1" xref="S3.SS3.SSS0.Px1.p1.11.m3.2.3.1.cmml">[</mo><mo lspace="0em" rspace="0em" id="S3.SS3.SSS0.Px1.p1.11.m3.1.1" xref="S3.SS3.SSS0.Px1.p1.11.m3.1.1.cmml">⋅</mo><mo rspace="0em" id="S3.SS3.SSS0.Px1.p1.11.m3.2.3.2.2" xref="S3.SS3.SSS0.Px1.p1.11.m3.2.3.1.cmml">,</mo><mo lspace="0em" rspace="0em" id="S3.SS3.SSS0.Px1.p1.11.m3.2.2" xref="S3.SS3.SSS0.Px1.p1.11.m3.2.2.cmml">⋅</mo><mo stretchy="false" id="S3.SS3.SSS0.Px1.p1.11.m3.2.3.2.3" xref="S3.SS3.SSS0.Px1.p1.11.m3.2.3.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p1.11.m3.2b"><interval closure="closed" id="S3.SS3.SSS0.Px1.p1.11.m3.2.3.1.cmml" xref="S3.SS3.SSS0.Px1.p1.11.m3.2.3.2"><ci id="S3.SS3.SSS0.Px1.p1.11.m3.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.11.m3.1.1">⋅</ci><ci id="S3.SS3.SSS0.Px1.p1.11.m3.2.2.cmml" xref="S3.SS3.SSS0.Px1.p1.11.m3.2.2">⋅</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p1.11.m3.2c">[\cdot,\cdot]</annotation></semantics></math> and <math id="S3.SS3.SSS0.Px1.p1.12.m4.1" class="ltx_Math" alttext="Up(\cdot)" display="inline"><semantics id="S3.SS3.SSS0.Px1.p1.12.m4.1a"><mrow id="S3.SS3.SSS0.Px1.p1.12.m4.1.2" xref="S3.SS3.SSS0.Px1.p1.12.m4.1.2.cmml"><mi id="S3.SS3.SSS0.Px1.p1.12.m4.1.2.2" xref="S3.SS3.SSS0.Px1.p1.12.m4.1.2.2.cmml">U</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS0.Px1.p1.12.m4.1.2.1" xref="S3.SS3.SSS0.Px1.p1.12.m4.1.2.1.cmml">​</mo><mi id="S3.SS3.SSS0.Px1.p1.12.m4.1.2.3" xref="S3.SS3.SSS0.Px1.p1.12.m4.1.2.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS0.Px1.p1.12.m4.1.2.1a" xref="S3.SS3.SSS0.Px1.p1.12.m4.1.2.1.cmml">​</mo><mrow id="S3.SS3.SSS0.Px1.p1.12.m4.1.2.4.2" xref="S3.SS3.SSS0.Px1.p1.12.m4.1.2.cmml"><mo stretchy="false" id="S3.SS3.SSS0.Px1.p1.12.m4.1.2.4.2.1" xref="S3.SS3.SSS0.Px1.p1.12.m4.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S3.SS3.SSS0.Px1.p1.12.m4.1.1" xref="S3.SS3.SSS0.Px1.p1.12.m4.1.1.cmml">⋅</mo><mo stretchy="false" id="S3.SS3.SSS0.Px1.p1.12.m4.1.2.4.2.2" xref="S3.SS3.SSS0.Px1.p1.12.m4.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p1.12.m4.1b"><apply id="S3.SS3.SSS0.Px1.p1.12.m4.1.2.cmml" xref="S3.SS3.SSS0.Px1.p1.12.m4.1.2"><times id="S3.SS3.SSS0.Px1.p1.12.m4.1.2.1.cmml" xref="S3.SS3.SSS0.Px1.p1.12.m4.1.2.1"></times><ci id="S3.SS3.SSS0.Px1.p1.12.m4.1.2.2.cmml" xref="S3.SS3.SSS0.Px1.p1.12.m4.1.2.2">𝑈</ci><ci id="S3.SS3.SSS0.Px1.p1.12.m4.1.2.3.cmml" xref="S3.SS3.SSS0.Px1.p1.12.m4.1.2.3">𝑝</ci><ci id="S3.SS3.SSS0.Px1.p1.12.m4.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.12.m4.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p1.12.m4.1c">Up(\cdot)</annotation></semantics></math> represent concatenation along the channel and upsampling, and <math id="S3.SS3.SSS0.Px1.p1.13.m5.1" class="ltx_Math" alttext="I" display="inline"><semantics id="S3.SS3.SSS0.Px1.p1.13.m5.1a"><mi id="S3.SS3.SSS0.Px1.p1.13.m5.1.1" xref="S3.SS3.SSS0.Px1.p1.13.m5.1.1.cmml">I</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p1.13.m5.1b"><ci id="S3.SS3.SSS0.Px1.p1.13.m5.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.13.m5.1.1">𝐼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p1.13.m5.1c">I</annotation></semantics></math> denotes the full-one matrix. Since the anomalous regions are typically smaller than the normal ones, we use focal loss to address the imbalance problem. Furthermore, to ensure that the model establishes an accurate decision boundary, we employ the Dice loss to measure the overlaps between the predicted segmentation <math id="S3.SS3.SSS0.Px1.p1.14.m6.1" class="ltx_Math" alttext="S_{n}" display="inline"><semantics id="S3.SS3.SSS0.Px1.p1.14.m6.1a"><msub id="S3.SS3.SSS0.Px1.p1.14.m6.1.1" xref="S3.SS3.SSS0.Px1.p1.14.m6.1.1.cmml"><mi id="S3.SS3.SSS0.Px1.p1.14.m6.1.1.2" xref="S3.SS3.SSS0.Px1.p1.14.m6.1.1.2.cmml">S</mi><mi id="S3.SS3.SSS0.Px1.p1.14.m6.1.1.3" xref="S3.SS3.SSS0.Px1.p1.14.m6.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p1.14.m6.1b"><apply id="S3.SS3.SSS0.Px1.p1.14.m6.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.14.m6.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p1.14.m6.1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.14.m6.1.1">subscript</csymbol><ci id="S3.SS3.SSS0.Px1.p1.14.m6.1.1.2.cmml" xref="S3.SS3.SSS0.Px1.p1.14.m6.1.1.2">𝑆</ci><ci id="S3.SS3.SSS0.Px1.p1.14.m6.1.1.3.cmml" xref="S3.SS3.SSS0.Px1.p1.14.m6.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p1.14.m6.1c">S_{n}</annotation></semantics></math>/<math id="S3.SS3.SSS0.Px1.p1.15.m7.1" class="ltx_Math" alttext="S_{a}" display="inline"><semantics id="S3.SS3.SSS0.Px1.p1.15.m7.1a"><msub id="S3.SS3.SSS0.Px1.p1.15.m7.1.1" xref="S3.SS3.SSS0.Px1.p1.15.m7.1.1.cmml"><mi id="S3.SS3.SSS0.Px1.p1.15.m7.1.1.2" xref="S3.SS3.SSS0.Px1.p1.15.m7.1.1.2.cmml">S</mi><mi id="S3.SS3.SSS0.Px1.p1.15.m7.1.1.3" xref="S3.SS3.SSS0.Px1.p1.15.m7.1.1.3.cmml">a</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p1.15.m7.1b"><apply id="S3.SS3.SSS0.Px1.p1.15.m7.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.15.m7.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p1.15.m7.1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.15.m7.1.1">subscript</csymbol><ci id="S3.SS3.SSS0.Px1.p1.15.m7.1.1.2.cmml" xref="S3.SS3.SSS0.Px1.p1.15.m7.1.1.2">𝑆</ci><ci id="S3.SS3.SSS0.Px1.p1.15.m7.1.1.3.cmml" xref="S3.SS3.SSS0.Px1.p1.15.m7.1.1.3">𝑎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p1.15.m7.1c">S_{a}</annotation></semantics></math> and the ground truth mask.</p>
</div>
</section>
<section id="S3.SS3.SSS0.Px2" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Refinement of the textual space</h5>

<div id="S3.SS3.SSS0.Px2.p1" class="ltx_para ltx_noindent">
<p id="S3.SS3.SSS0.Px2.p1.13" class="ltx_p">To facilitate the learning of a more discriminative textual space via Eq. <a href="#S3.E2" title="In Glocal context optimization ‣ 3.3 Learning generic abnormality and normality prompts ‣ 3 AnomalyCLIP: object-agnostic prompt learning ‣ AnomalyCLIP: Object-agnostic Prompt Learning for Zero-shot Anomaly Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, inspired by <cite class="ltx_cite ltx_citemacro_cite">Jia et al. (<a href="#bib.bib23" title="" class="ltx_ref">2022</a>)</cite> and <cite class="ltx_cite ltx_citemacro_cite">Khattak et al. (<a href="#bib.bib24" title="" class="ltx_ref">2023</a>)</cite>, we introduce text prompt tuning to refine the original textual space of CLIP by adding additional learnable token embeddings into its text encoder.
Specifically, we first attach randomly initialized learnable token embeddings <math id="S3.SS3.SSS0.Px2.p1.1.m1.1" class="ltx_Math" alttext="t^{\prime}_{m}" display="inline"><semantics id="S3.SS3.SSS0.Px2.p1.1.m1.1a"><msubsup id="S3.SS3.SSS0.Px2.p1.1.m1.1.1" xref="S3.SS3.SSS0.Px2.p1.1.m1.1.1.cmml"><mi id="S3.SS3.SSS0.Px2.p1.1.m1.1.1.2.2" xref="S3.SS3.SSS0.Px2.p1.1.m1.1.1.2.2.cmml">t</mi><mi id="S3.SS3.SSS0.Px2.p1.1.m1.1.1.3" xref="S3.SS3.SSS0.Px2.p1.1.m1.1.1.3.cmml">m</mi><mo id="S3.SS3.SSS0.Px2.p1.1.m1.1.1.2.3" xref="S3.SS3.SSS0.Px2.p1.1.m1.1.1.2.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px2.p1.1.m1.1b"><apply id="S3.SS3.SSS0.Px2.p1.1.m1.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p1.1.m1.1.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.1.m1.1.1">subscript</csymbol><apply id="S3.SS3.SSS0.Px2.p1.1.m1.1.1.2.cmml" xref="S3.SS3.SSS0.Px2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p1.1.m1.1.1.2.1.cmml" xref="S3.SS3.SSS0.Px2.p1.1.m1.1.1">superscript</csymbol><ci id="S3.SS3.SSS0.Px2.p1.1.m1.1.1.2.2.cmml" xref="S3.SS3.SSS0.Px2.p1.1.m1.1.1.2.2">𝑡</ci><ci id="S3.SS3.SSS0.Px2.p1.1.m1.1.1.2.3.cmml" xref="S3.SS3.SSS0.Px2.p1.1.m1.1.1.2.3">′</ci></apply><ci id="S3.SS3.SSS0.Px2.p1.1.m1.1.1.3.cmml" xref="S3.SS3.SSS0.Px2.p1.1.m1.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px2.p1.1.m1.1c">t^{\prime}_{m}</annotation></semantics></math> into <math id="S3.SS3.SSS0.Px2.p1.2.m2.1" class="ltx_Math" alttext="T_{m}" display="inline"><semantics id="S3.SS3.SSS0.Px2.p1.2.m2.1a"><msub id="S3.SS3.SSS0.Px2.p1.2.m2.1.1" xref="S3.SS3.SSS0.Px2.p1.2.m2.1.1.cmml"><mi id="S3.SS3.SSS0.Px2.p1.2.m2.1.1.2" xref="S3.SS3.SSS0.Px2.p1.2.m2.1.1.2.cmml">T</mi><mi id="S3.SS3.SSS0.Px2.p1.2.m2.1.1.3" xref="S3.SS3.SSS0.Px2.p1.2.m2.1.1.3.cmml">m</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px2.p1.2.m2.1b"><apply id="S3.SS3.SSS0.Px2.p1.2.m2.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p1.2.m2.1.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS3.SSS0.Px2.p1.2.m2.1.1.2.cmml" xref="S3.SS3.SSS0.Px2.p1.2.m2.1.1.2">𝑇</ci><ci id="S3.SS3.SSS0.Px2.p1.2.m2.1.1.3.cmml" xref="S3.SS3.SSS0.Px2.p1.2.m2.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px2.p1.2.m2.1c">T_{m}</annotation></semantics></math>, the <math id="S3.SS3.SSS0.Px2.p1.3.m3.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S3.SS3.SSS0.Px2.p1.3.m3.1a"><mi id="S3.SS3.SSS0.Px2.p1.3.m3.1.1" xref="S3.SS3.SSS0.Px2.p1.3.m3.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px2.p1.3.m3.1b"><ci id="S3.SS3.SSS0.Px2.p1.3.m3.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.3.m3.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px2.p1.3.m3.1c">m</annotation></semantics></math>-th layer of the frozen CLIP text encoder. Then, we concatenate <math id="S3.SS3.SSS0.Px2.p1.4.m4.1" class="ltx_Math" alttext="t^{\prime}_{m}" display="inline"><semantics id="S3.SS3.SSS0.Px2.p1.4.m4.1a"><msubsup id="S3.SS3.SSS0.Px2.p1.4.m4.1.1" xref="S3.SS3.SSS0.Px2.p1.4.m4.1.1.cmml"><mi id="S3.SS3.SSS0.Px2.p1.4.m4.1.1.2.2" xref="S3.SS3.SSS0.Px2.p1.4.m4.1.1.2.2.cmml">t</mi><mi id="S3.SS3.SSS0.Px2.p1.4.m4.1.1.3" xref="S3.SS3.SSS0.Px2.p1.4.m4.1.1.3.cmml">m</mi><mo id="S3.SS3.SSS0.Px2.p1.4.m4.1.1.2.3" xref="S3.SS3.SSS0.Px2.p1.4.m4.1.1.2.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px2.p1.4.m4.1b"><apply id="S3.SS3.SSS0.Px2.p1.4.m4.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p1.4.m4.1.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.4.m4.1.1">subscript</csymbol><apply id="S3.SS3.SSS0.Px2.p1.4.m4.1.1.2.cmml" xref="S3.SS3.SSS0.Px2.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p1.4.m4.1.1.2.1.cmml" xref="S3.SS3.SSS0.Px2.p1.4.m4.1.1">superscript</csymbol><ci id="S3.SS3.SSS0.Px2.p1.4.m4.1.1.2.2.cmml" xref="S3.SS3.SSS0.Px2.p1.4.m4.1.1.2.2">𝑡</ci><ci id="S3.SS3.SSS0.Px2.p1.4.m4.1.1.2.3.cmml" xref="S3.SS3.SSS0.Px2.p1.4.m4.1.1.2.3">′</ci></apply><ci id="S3.SS3.SSS0.Px2.p1.4.m4.1.1.3.cmml" xref="S3.SS3.SSS0.Px2.p1.4.m4.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px2.p1.4.m4.1c">t^{\prime}_{m}</annotation></semantics></math> and the original token embeddings <math id="S3.SS3.SSS0.Px2.p1.5.m5.1" class="ltx_Math" alttext="t_{m}" display="inline"><semantics id="S3.SS3.SSS0.Px2.p1.5.m5.1a"><msub id="S3.SS3.SSS0.Px2.p1.5.m5.1.1" xref="S3.SS3.SSS0.Px2.p1.5.m5.1.1.cmml"><mi id="S3.SS3.SSS0.Px2.p1.5.m5.1.1.2" xref="S3.SS3.SSS0.Px2.p1.5.m5.1.1.2.cmml">t</mi><mi id="S3.SS3.SSS0.Px2.p1.5.m5.1.1.3" xref="S3.SS3.SSS0.Px2.p1.5.m5.1.1.3.cmml">m</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px2.p1.5.m5.1b"><apply id="S3.SS3.SSS0.Px2.p1.5.m5.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p1.5.m5.1.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.5.m5.1.1">subscript</csymbol><ci id="S3.SS3.SSS0.Px2.p1.5.m5.1.1.2.cmml" xref="S3.SS3.SSS0.Px2.p1.5.m5.1.1.2">𝑡</ci><ci id="S3.SS3.SSS0.Px2.p1.5.m5.1.1.3.cmml" xref="S3.SS3.SSS0.Px2.p1.5.m5.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px2.p1.5.m5.1c">t_{m}</annotation></semantics></math> along the dimension of the channel, and forward them to <math id="S3.SS3.SSS0.Px2.p1.6.m6.1" class="ltx_Math" alttext="T_{m}" display="inline"><semantics id="S3.SS3.SSS0.Px2.p1.6.m6.1a"><msub id="S3.SS3.SSS0.Px2.p1.6.m6.1.1" xref="S3.SS3.SSS0.Px2.p1.6.m6.1.1.cmml"><mi id="S3.SS3.SSS0.Px2.p1.6.m6.1.1.2" xref="S3.SS3.SSS0.Px2.p1.6.m6.1.1.2.cmml">T</mi><mi id="S3.SS3.SSS0.Px2.p1.6.m6.1.1.3" xref="S3.SS3.SSS0.Px2.p1.6.m6.1.1.3.cmml">m</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px2.p1.6.m6.1b"><apply id="S3.SS3.SSS0.Px2.p1.6.m6.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p1.6.m6.1.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.6.m6.1.1">subscript</csymbol><ci id="S3.SS3.SSS0.Px2.p1.6.m6.1.1.2.cmml" xref="S3.SS3.SSS0.Px2.p1.6.m6.1.1.2">𝑇</ci><ci id="S3.SS3.SSS0.Px2.p1.6.m6.1.1.3.cmml" xref="S3.SS3.SSS0.Px2.p1.6.m6.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px2.p1.6.m6.1c">T_{m}</annotation></semantics></math> to get the corresponding <math id="S3.SS3.SSS0.Px2.p1.7.m7.1" class="ltx_Math" alttext="r^{\prime}_{m+1}" display="inline"><semantics id="S3.SS3.SSS0.Px2.p1.7.m7.1a"><msubsup id="S3.SS3.SSS0.Px2.p1.7.m7.1.1" xref="S3.SS3.SSS0.Px2.p1.7.m7.1.1.cmml"><mi id="S3.SS3.SSS0.Px2.p1.7.m7.1.1.2.2" xref="S3.SS3.SSS0.Px2.p1.7.m7.1.1.2.2.cmml">r</mi><mrow id="S3.SS3.SSS0.Px2.p1.7.m7.1.1.3" xref="S3.SS3.SSS0.Px2.p1.7.m7.1.1.3.cmml"><mi id="S3.SS3.SSS0.Px2.p1.7.m7.1.1.3.2" xref="S3.SS3.SSS0.Px2.p1.7.m7.1.1.3.2.cmml">m</mi><mo id="S3.SS3.SSS0.Px2.p1.7.m7.1.1.3.1" xref="S3.SS3.SSS0.Px2.p1.7.m7.1.1.3.1.cmml">+</mo><mn id="S3.SS3.SSS0.Px2.p1.7.m7.1.1.3.3" xref="S3.SS3.SSS0.Px2.p1.7.m7.1.1.3.3.cmml">1</mn></mrow><mo id="S3.SS3.SSS0.Px2.p1.7.m7.1.1.2.3" xref="S3.SS3.SSS0.Px2.p1.7.m7.1.1.2.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px2.p1.7.m7.1b"><apply id="S3.SS3.SSS0.Px2.p1.7.m7.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p1.7.m7.1.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.7.m7.1.1">subscript</csymbol><apply id="S3.SS3.SSS0.Px2.p1.7.m7.1.1.2.cmml" xref="S3.SS3.SSS0.Px2.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p1.7.m7.1.1.2.1.cmml" xref="S3.SS3.SSS0.Px2.p1.7.m7.1.1">superscript</csymbol><ci id="S3.SS3.SSS0.Px2.p1.7.m7.1.1.2.2.cmml" xref="S3.SS3.SSS0.Px2.p1.7.m7.1.1.2.2">𝑟</ci><ci id="S3.SS3.SSS0.Px2.p1.7.m7.1.1.2.3.cmml" xref="S3.SS3.SSS0.Px2.p1.7.m7.1.1.2.3">′</ci></apply><apply id="S3.SS3.SSS0.Px2.p1.7.m7.1.1.3.cmml" xref="S3.SS3.SSS0.Px2.p1.7.m7.1.1.3"><plus id="S3.SS3.SSS0.Px2.p1.7.m7.1.1.3.1.cmml" xref="S3.SS3.SSS0.Px2.p1.7.m7.1.1.3.1"></plus><ci id="S3.SS3.SSS0.Px2.p1.7.m7.1.1.3.2.cmml" xref="S3.SS3.SSS0.Px2.p1.7.m7.1.1.3.2">𝑚</ci><cn type="integer" id="S3.SS3.SSS0.Px2.p1.7.m7.1.1.3.3.cmml" xref="S3.SS3.SSS0.Px2.p1.7.m7.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px2.p1.7.m7.1c">r^{\prime}_{m+1}</annotation></semantics></math> and <math id="S3.SS3.SSS0.Px2.p1.8.m8.1" class="ltx_Math" alttext="t_{m+1}" display="inline"><semantics id="S3.SS3.SSS0.Px2.p1.8.m8.1a"><msub id="S3.SS3.SSS0.Px2.p1.8.m8.1.1" xref="S3.SS3.SSS0.Px2.p1.8.m8.1.1.cmml"><mi id="S3.SS3.SSS0.Px2.p1.8.m8.1.1.2" xref="S3.SS3.SSS0.Px2.p1.8.m8.1.1.2.cmml">t</mi><mrow id="S3.SS3.SSS0.Px2.p1.8.m8.1.1.3" xref="S3.SS3.SSS0.Px2.p1.8.m8.1.1.3.cmml"><mi id="S3.SS3.SSS0.Px2.p1.8.m8.1.1.3.2" xref="S3.SS3.SSS0.Px2.p1.8.m8.1.1.3.2.cmml">m</mi><mo id="S3.SS3.SSS0.Px2.p1.8.m8.1.1.3.1" xref="S3.SS3.SSS0.Px2.p1.8.m8.1.1.3.1.cmml">+</mo><mn id="S3.SS3.SSS0.Px2.p1.8.m8.1.1.3.3" xref="S3.SS3.SSS0.Px2.p1.8.m8.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px2.p1.8.m8.1b"><apply id="S3.SS3.SSS0.Px2.p1.8.m8.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p1.8.m8.1.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.8.m8.1.1">subscript</csymbol><ci id="S3.SS3.SSS0.Px2.p1.8.m8.1.1.2.cmml" xref="S3.SS3.SSS0.Px2.p1.8.m8.1.1.2">𝑡</ci><apply id="S3.SS3.SSS0.Px2.p1.8.m8.1.1.3.cmml" xref="S3.SS3.SSS0.Px2.p1.8.m8.1.1.3"><plus id="S3.SS3.SSS0.Px2.p1.8.m8.1.1.3.1.cmml" xref="S3.SS3.SSS0.Px2.p1.8.m8.1.1.3.1"></plus><ci id="S3.SS3.SSS0.Px2.p1.8.m8.1.1.3.2.cmml" xref="S3.SS3.SSS0.Px2.p1.8.m8.1.1.3.2">𝑚</ci><cn type="integer" id="S3.SS3.SSS0.Px2.p1.8.m8.1.1.3.3.cmml" xref="S3.SS3.SSS0.Px2.p1.8.m8.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px2.p1.8.m8.1c">t_{m+1}</annotation></semantics></math>. To ensure proper calibration, we discard the obtained <math id="S3.SS3.SSS0.Px2.p1.9.m9.1" class="ltx_Math" alttext="r^{\prime}_{m+1}" display="inline"><semantics id="S3.SS3.SSS0.Px2.p1.9.m9.1a"><msubsup id="S3.SS3.SSS0.Px2.p1.9.m9.1.1" xref="S3.SS3.SSS0.Px2.p1.9.m9.1.1.cmml"><mi id="S3.SS3.SSS0.Px2.p1.9.m9.1.1.2.2" xref="S3.SS3.SSS0.Px2.p1.9.m9.1.1.2.2.cmml">r</mi><mrow id="S3.SS3.SSS0.Px2.p1.9.m9.1.1.3" xref="S3.SS3.SSS0.Px2.p1.9.m9.1.1.3.cmml"><mi id="S3.SS3.SSS0.Px2.p1.9.m9.1.1.3.2" xref="S3.SS3.SSS0.Px2.p1.9.m9.1.1.3.2.cmml">m</mi><mo id="S3.SS3.SSS0.Px2.p1.9.m9.1.1.3.1" xref="S3.SS3.SSS0.Px2.p1.9.m9.1.1.3.1.cmml">+</mo><mn id="S3.SS3.SSS0.Px2.p1.9.m9.1.1.3.3" xref="S3.SS3.SSS0.Px2.p1.9.m9.1.1.3.3.cmml">1</mn></mrow><mo id="S3.SS3.SSS0.Px2.p1.9.m9.1.1.2.3" xref="S3.SS3.SSS0.Px2.p1.9.m9.1.1.2.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px2.p1.9.m9.1b"><apply id="S3.SS3.SSS0.Px2.p1.9.m9.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p1.9.m9.1.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.9.m9.1.1">subscript</csymbol><apply id="S3.SS3.SSS0.Px2.p1.9.m9.1.1.2.cmml" xref="S3.SS3.SSS0.Px2.p1.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p1.9.m9.1.1.2.1.cmml" xref="S3.SS3.SSS0.Px2.p1.9.m9.1.1">superscript</csymbol><ci id="S3.SS3.SSS0.Px2.p1.9.m9.1.1.2.2.cmml" xref="S3.SS3.SSS0.Px2.p1.9.m9.1.1.2.2">𝑟</ci><ci id="S3.SS3.SSS0.Px2.p1.9.m9.1.1.2.3.cmml" xref="S3.SS3.SSS0.Px2.p1.9.m9.1.1.2.3">′</ci></apply><apply id="S3.SS3.SSS0.Px2.p1.9.m9.1.1.3.cmml" xref="S3.SS3.SSS0.Px2.p1.9.m9.1.1.3"><plus id="S3.SS3.SSS0.Px2.p1.9.m9.1.1.3.1.cmml" xref="S3.SS3.SSS0.Px2.p1.9.m9.1.1.3.1"></plus><ci id="S3.SS3.SSS0.Px2.p1.9.m9.1.1.3.2.cmml" xref="S3.SS3.SSS0.Px2.p1.9.m9.1.1.3.2">𝑚</ci><cn type="integer" id="S3.SS3.SSS0.Px2.p1.9.m9.1.1.3.3.cmml" xref="S3.SS3.SSS0.Px2.p1.9.m9.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px2.p1.9.m9.1c">r^{\prime}_{m+1}</annotation></semantics></math> and initialize new learnable token embeddings <math id="S3.SS3.SSS0.Px2.p1.10.m10.1" class="ltx_Math" alttext="t^{\prime}_{m+1}" display="inline"><semantics id="S3.SS3.SSS0.Px2.p1.10.m10.1a"><msubsup id="S3.SS3.SSS0.Px2.p1.10.m10.1.1" xref="S3.SS3.SSS0.Px2.p1.10.m10.1.1.cmml"><mi id="S3.SS3.SSS0.Px2.p1.10.m10.1.1.2.2" xref="S3.SS3.SSS0.Px2.p1.10.m10.1.1.2.2.cmml">t</mi><mrow id="S3.SS3.SSS0.Px2.p1.10.m10.1.1.3" xref="S3.SS3.SSS0.Px2.p1.10.m10.1.1.3.cmml"><mi id="S3.SS3.SSS0.Px2.p1.10.m10.1.1.3.2" xref="S3.SS3.SSS0.Px2.p1.10.m10.1.1.3.2.cmml">m</mi><mo id="S3.SS3.SSS0.Px2.p1.10.m10.1.1.3.1" xref="S3.SS3.SSS0.Px2.p1.10.m10.1.1.3.1.cmml">+</mo><mn id="S3.SS3.SSS0.Px2.p1.10.m10.1.1.3.3" xref="S3.SS3.SSS0.Px2.p1.10.m10.1.1.3.3.cmml">1</mn></mrow><mo id="S3.SS3.SSS0.Px2.p1.10.m10.1.1.2.3" xref="S3.SS3.SSS0.Px2.p1.10.m10.1.1.2.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px2.p1.10.m10.1b"><apply id="S3.SS3.SSS0.Px2.p1.10.m10.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.10.m10.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p1.10.m10.1.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.10.m10.1.1">subscript</csymbol><apply id="S3.SS3.SSS0.Px2.p1.10.m10.1.1.2.cmml" xref="S3.SS3.SSS0.Px2.p1.10.m10.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p1.10.m10.1.1.2.1.cmml" xref="S3.SS3.SSS0.Px2.p1.10.m10.1.1">superscript</csymbol><ci id="S3.SS3.SSS0.Px2.p1.10.m10.1.1.2.2.cmml" xref="S3.SS3.SSS0.Px2.p1.10.m10.1.1.2.2">𝑡</ci><ci id="S3.SS3.SSS0.Px2.p1.10.m10.1.1.2.3.cmml" xref="S3.SS3.SSS0.Px2.p1.10.m10.1.1.2.3">′</ci></apply><apply id="S3.SS3.SSS0.Px2.p1.10.m10.1.1.3.cmml" xref="S3.SS3.SSS0.Px2.p1.10.m10.1.1.3"><plus id="S3.SS3.SSS0.Px2.p1.10.m10.1.1.3.1.cmml" xref="S3.SS3.SSS0.Px2.p1.10.m10.1.1.3.1"></plus><ci id="S3.SS3.SSS0.Px2.p1.10.m10.1.1.3.2.cmml" xref="S3.SS3.SSS0.Px2.p1.10.m10.1.1.3.2">𝑚</ci><cn type="integer" id="S3.SS3.SSS0.Px2.p1.10.m10.1.1.3.3.cmml" xref="S3.SS3.SSS0.Px2.p1.10.m10.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px2.p1.10.m10.1c">t^{\prime}_{m+1}</annotation></semantics></math>. Note that even though the output <math id="S3.SS3.SSS0.Px2.p1.11.m11.1" class="ltx_Math" alttext="r^{\prime}_{m+1}" display="inline"><semantics id="S3.SS3.SSS0.Px2.p1.11.m11.1a"><msubsup id="S3.SS3.SSS0.Px2.p1.11.m11.1.1" xref="S3.SS3.SSS0.Px2.p1.11.m11.1.1.cmml"><mi id="S3.SS3.SSS0.Px2.p1.11.m11.1.1.2.2" xref="S3.SS3.SSS0.Px2.p1.11.m11.1.1.2.2.cmml">r</mi><mrow id="S3.SS3.SSS0.Px2.p1.11.m11.1.1.3" xref="S3.SS3.SSS0.Px2.p1.11.m11.1.1.3.cmml"><mi id="S3.SS3.SSS0.Px2.p1.11.m11.1.1.3.2" xref="S3.SS3.SSS0.Px2.p1.11.m11.1.1.3.2.cmml">m</mi><mo id="S3.SS3.SSS0.Px2.p1.11.m11.1.1.3.1" xref="S3.SS3.SSS0.Px2.p1.11.m11.1.1.3.1.cmml">+</mo><mn id="S3.SS3.SSS0.Px2.p1.11.m11.1.1.3.3" xref="S3.SS3.SSS0.Px2.p1.11.m11.1.1.3.3.cmml">1</mn></mrow><mo id="S3.SS3.SSS0.Px2.p1.11.m11.1.1.2.3" xref="S3.SS3.SSS0.Px2.p1.11.m11.1.1.2.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px2.p1.11.m11.1b"><apply id="S3.SS3.SSS0.Px2.p1.11.m11.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.11.m11.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p1.11.m11.1.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.11.m11.1.1">subscript</csymbol><apply id="S3.SS3.SSS0.Px2.p1.11.m11.1.1.2.cmml" xref="S3.SS3.SSS0.Px2.p1.11.m11.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p1.11.m11.1.1.2.1.cmml" xref="S3.SS3.SSS0.Px2.p1.11.m11.1.1">superscript</csymbol><ci id="S3.SS3.SSS0.Px2.p1.11.m11.1.1.2.2.cmml" xref="S3.SS3.SSS0.Px2.p1.11.m11.1.1.2.2">𝑟</ci><ci id="S3.SS3.SSS0.Px2.p1.11.m11.1.1.2.3.cmml" xref="S3.SS3.SSS0.Px2.p1.11.m11.1.1.2.3">′</ci></apply><apply id="S3.SS3.SSS0.Px2.p1.11.m11.1.1.3.cmml" xref="S3.SS3.SSS0.Px2.p1.11.m11.1.1.3"><plus id="S3.SS3.SSS0.Px2.p1.11.m11.1.1.3.1.cmml" xref="S3.SS3.SSS0.Px2.p1.11.m11.1.1.3.1"></plus><ci id="S3.SS3.SSS0.Px2.p1.11.m11.1.1.3.2.cmml" xref="S3.SS3.SSS0.Px2.p1.11.m11.1.1.3.2">𝑚</ci><cn type="integer" id="S3.SS3.SSS0.Px2.p1.11.m11.1.1.3.3.cmml" xref="S3.SS3.SSS0.Px2.p1.11.m11.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px2.p1.11.m11.1c">r^{\prime}_{m+1}</annotation></semantics></math> is discarded, the updated gradients can still be backpropagated to optimize the learnable tokens <math id="S3.SS3.SSS0.Px2.p1.12.m12.1" class="ltx_Math" alttext="t^{\prime}_{m}" display="inline"><semantics id="S3.SS3.SSS0.Px2.p1.12.m12.1a"><msubsup id="S3.SS3.SSS0.Px2.p1.12.m12.1.1" xref="S3.SS3.SSS0.Px2.p1.12.m12.1.1.cmml"><mi id="S3.SS3.SSS0.Px2.p1.12.m12.1.1.2.2" xref="S3.SS3.SSS0.Px2.p1.12.m12.1.1.2.2.cmml">t</mi><mi id="S3.SS3.SSS0.Px2.p1.12.m12.1.1.3" xref="S3.SS3.SSS0.Px2.p1.12.m12.1.1.3.cmml">m</mi><mo id="S3.SS3.SSS0.Px2.p1.12.m12.1.1.2.3" xref="S3.SS3.SSS0.Px2.p1.12.m12.1.1.2.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px2.p1.12.m12.1b"><apply id="S3.SS3.SSS0.Px2.p1.12.m12.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.12.m12.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p1.12.m12.1.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.12.m12.1.1">subscript</csymbol><apply id="S3.SS3.SSS0.Px2.p1.12.m12.1.1.2.cmml" xref="S3.SS3.SSS0.Px2.p1.12.m12.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p1.12.m12.1.1.2.1.cmml" xref="S3.SS3.SSS0.Px2.p1.12.m12.1.1">superscript</csymbol><ci id="S3.SS3.SSS0.Px2.p1.12.m12.1.1.2.2.cmml" xref="S3.SS3.SSS0.Px2.p1.12.m12.1.1.2.2">𝑡</ci><ci id="S3.SS3.SSS0.Px2.p1.12.m12.1.1.2.3.cmml" xref="S3.SS3.SSS0.Px2.p1.12.m12.1.1.2.3">′</ci></apply><ci id="S3.SS3.SSS0.Px2.p1.12.m12.1.1.3.cmml" xref="S3.SS3.SSS0.Px2.p1.12.m12.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px2.p1.12.m12.1c">t^{\prime}_{m}</annotation></semantics></math> due to the self-attention mechanism. We repeat this operation until we reach the designated layer <math id="S3.SS3.SSS0.Px2.p1.13.m13.1" class="ltx_Math" alttext="M^{\prime}" display="inline"><semantics id="S3.SS3.SSS0.Px2.p1.13.m13.1a"><msup id="S3.SS3.SSS0.Px2.p1.13.m13.1.1" xref="S3.SS3.SSS0.Px2.p1.13.m13.1.1.cmml"><mi id="S3.SS3.SSS0.Px2.p1.13.m13.1.1.2" xref="S3.SS3.SSS0.Px2.p1.13.m13.1.1.2.cmml">M</mi><mo id="S3.SS3.SSS0.Px2.p1.13.m13.1.1.3" xref="S3.SS3.SSS0.Px2.p1.13.m13.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px2.p1.13.m13.1b"><apply id="S3.SS3.SSS0.Px2.p1.13.m13.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.13.m13.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p1.13.m13.1.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.13.m13.1.1">superscript</csymbol><ci id="S3.SS3.SSS0.Px2.p1.13.m13.1.1.2.cmml" xref="S3.SS3.SSS0.Px2.p1.13.m13.1.1.2">𝑀</ci><ci id="S3.SS3.SSS0.Px2.p1.13.m13.1.1.3.cmml" xref="S3.SS3.SSS0.Px2.p1.13.m13.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px2.p1.13.m13.1c">M^{\prime}</annotation></semantics></math>. During fine-tuning, these learnable token embeddings are optimized to refine the original textual space. More details see Appendix <a href="#A4" title="Appendix D Additional results and ablations ‣ AnomalyCLIP: Object-agnostic Prompt Learning for Zero-shot Anomaly Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">D</span></a>.</p>
</div>
</section>
<section id="S3.SS3.SSS0.Px3" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Refinement of the local visual space</h5>

<figure id="S3.F3" class="ltx_figure ltx_align_floatright">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_4">
<div id="S3.F3.1" class="ltx_inline-block ltx_figure_panel ltx_align_center ltx_transformed_outer" style="width:159.0pt;height:113.5pt;vertical-align:-14.5pt;"><span class="ltx_transformed_inner" style="transform:translate(-123.7pt,77.0pt) scale(0.391253760444731,0.391253760444731) ;">
</span></div>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure id="S3.F3.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2310.18961/assets/x8.png" id="S3.F3.sf1.g1" class="ltx_graphics ltx_img_portrait" width="81" height="270" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span>Input</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure id="S3.F3.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2310.18961/assets/x9.png" id="S3.F3.sf2.g1" class="ltx_graphics ltx_img_portrait" width="81" height="270" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span>Q-K attention</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure id="S3.F3.sf3" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2310.18961/assets/x10.png" id="S3.F3.sf3.g1" class="ltx_graphics ltx_img_portrait" width="81" height="270" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(c) </span>Q-Q attention</figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S3.F3.sf4" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2310.18961/assets/x11.png" id="S3.F3.sf4.g1" class="ltx_graphics ltx_img_portrait" width="81" height="270" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(d) </span>K-K attention</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S3.F3.sf5" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2310.18961/assets/x12.png" id="S3.F3.sf5.g1" class="ltx_graphics ltx_img_portrait" width="81" height="270" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(e) </span>V-V attention</figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>DPAM visualization.</figcaption>
</figure>
<div id="S3.SS3.SSS0.Px3.p1" class="ltx_para ltx_noindent">
<p id="S3.SS3.SSS0.Px3.p1.12" class="ltx_p">Since the visual encoder of CLIP is originally pre-trained to align global object semantics, the contrastive loss used in CLIP makes the visual encoder produce a representative global embedding for class recognition. Through the self-attention mechanism, the attention map in the visual encoder focuses on the specific tokens highlighted within the red rectangle in Fig <a href="#S3.F3.sf2" title="In Figure 3 ‣ Refinement of the local visual space ‣ 3.3 Learning generic abnormality and normality prompts ‣ 3 AnomalyCLIP: object-agnostic prompt learning ‣ AnomalyCLIP: Object-agnostic Prompt Learning for Zero-shot Anomaly Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3b</span></a>. Although these tokens may contribute to global object recognition, they disrupt the local visual semantics, which directly hinders the effective learning of the fine-grained abnormality in our object-agnostic text prompts <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a href="#bib.bib30" title="" class="ltx_ref">2023b</a>)</cite>.
We found empirically that a diagonally prominent attention map helps reduce the disturbance from other tokens, leading to improved local visual semantics. Therefore, we propose a mechanism called Diagonally Prominent Attention Map to refine the local visual space, with the visual encoder kept frozen during training. To this end, we replace the original <math id="S3.SS3.SSS0.Px3.p1.1.m1.1" class="ltx_Math" alttext="Q" display="inline"><semantics id="S3.SS3.SSS0.Px3.p1.1.m1.1a"><mi id="S3.SS3.SSS0.Px3.p1.1.m1.1.1" xref="S3.SS3.SSS0.Px3.p1.1.m1.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px3.p1.1.m1.1b"><ci id="S3.SS3.SSS0.Px3.p1.1.m1.1.1.cmml" xref="S3.SS3.SSS0.Px3.p1.1.m1.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px3.p1.1.m1.1c">Q</annotation></semantics></math>-<math id="S3.SS3.SSS0.Px3.p1.2.m2.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S3.SS3.SSS0.Px3.p1.2.m2.1a"><mi id="S3.SS3.SSS0.Px3.p1.2.m2.1.1" xref="S3.SS3.SSS0.Px3.p1.2.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px3.p1.2.m2.1b"><ci id="S3.SS3.SSS0.Px3.p1.2.m2.1.1.cmml" xref="S3.SS3.SSS0.Px3.p1.2.m2.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px3.p1.2.m2.1c">K</annotation></semantics></math> attention in the visual encoder with diagonally prominent attention, such as <math id="S3.SS3.SSS0.Px3.p1.3.m3.1" class="ltx_Math" alttext="Q" display="inline"><semantics id="S3.SS3.SSS0.Px3.p1.3.m3.1a"><mi id="S3.SS3.SSS0.Px3.p1.3.m3.1.1" xref="S3.SS3.SSS0.Px3.p1.3.m3.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px3.p1.3.m3.1b"><ci id="S3.SS3.SSS0.Px3.p1.3.m3.1.1.cmml" xref="S3.SS3.SSS0.Px3.p1.3.m3.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px3.p1.3.m3.1c">Q</annotation></semantics></math>-<math id="S3.SS3.SSS0.Px3.p1.4.m4.1" class="ltx_Math" alttext="Q" display="inline"><semantics id="S3.SS3.SSS0.Px3.p1.4.m4.1a"><mi id="S3.SS3.SSS0.Px3.p1.4.m4.1.1" xref="S3.SS3.SSS0.Px3.p1.4.m4.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px3.p1.4.m4.1b"><ci id="S3.SS3.SSS0.Px3.p1.4.m4.1.1.cmml" xref="S3.SS3.SSS0.Px3.p1.4.m4.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px3.p1.4.m4.1c">Q</annotation></semantics></math>, <math id="S3.SS3.SSS0.Px3.p1.5.m5.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S3.SS3.SSS0.Px3.p1.5.m5.1a"><mi id="S3.SS3.SSS0.Px3.p1.5.m5.1.1" xref="S3.SS3.SSS0.Px3.p1.5.m5.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px3.p1.5.m5.1b"><ci id="S3.SS3.SSS0.Px3.p1.5.m5.1.1.cmml" xref="S3.SS3.SSS0.Px3.p1.5.m5.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px3.p1.5.m5.1c">K</annotation></semantics></math>-<math id="S3.SS3.SSS0.Px3.p1.6.m6.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S3.SS3.SSS0.Px3.p1.6.m6.1a"><mi id="S3.SS3.SSS0.Px3.p1.6.m6.1.1" xref="S3.SS3.SSS0.Px3.p1.6.m6.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px3.p1.6.m6.1b"><ci id="S3.SS3.SSS0.Px3.p1.6.m6.1.1.cmml" xref="S3.SS3.SSS0.Px3.p1.6.m6.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px3.p1.6.m6.1c">K</annotation></semantics></math>, and <math id="S3.SS3.SSS0.Px3.p1.7.m7.1" class="ltx_Math" alttext="V" display="inline"><semantics id="S3.SS3.SSS0.Px3.p1.7.m7.1a"><mi id="S3.SS3.SSS0.Px3.p1.7.m7.1.1" xref="S3.SS3.SSS0.Px3.p1.7.m7.1.1.cmml">V</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px3.p1.7.m7.1b"><ci id="S3.SS3.SSS0.Px3.p1.7.m7.1.1.cmml" xref="S3.SS3.SSS0.Px3.p1.7.m7.1.1">𝑉</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px3.p1.7.m7.1c">V</annotation></semantics></math>-<math id="S3.SS3.SSS0.Px3.p1.8.m8.1" class="ltx_Math" alttext="V" display="inline"><semantics id="S3.SS3.SSS0.Px3.p1.8.m8.1a"><mi id="S3.SS3.SSS0.Px3.p1.8.m8.1.1" xref="S3.SS3.SSS0.Px3.p1.8.m8.1.1.cmml">V</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px3.p1.8.m8.1b"><ci id="S3.SS3.SSS0.Px3.p1.8.m8.1.1.cmml" xref="S3.SS3.SSS0.Px3.p1.8.m8.1.1">𝑉</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px3.p1.8.m8.1c">V</annotation></semantics></math> self-attention schemes. As demonstrated in Fig.<a href="#S3.F3.sf3" title="In Figure 3 ‣ Refinement of the local visual space ‣ 3.3 Learning generic abnormality and normality prompts ‣ 3 AnomalyCLIP: object-agnostic prompt learning ‣ AnomalyCLIP: Object-agnostic Prompt Learning for Zero-shot Anomaly Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3c</span></a>, Fig.<a href="#S3.F3.sf4" title="In Figure 3 ‣ Refinement of the local visual space ‣ 3.3 Learning generic abnormality and normality prompts ‣ 3 AnomalyCLIP: object-agnostic prompt learning ‣ AnomalyCLIP: Object-agnostic Prompt Learning for Zero-shot Anomaly Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3d</span></a>, and Fig. <a href="#S3.F3.sf5" title="In Figure 3 ‣ Refinement of the local visual space ‣ 3.3 Learning generic abnormality and normality prompts ‣ 3 AnomalyCLIP: object-agnostic prompt learning ‣ AnomalyCLIP: Object-agnostic Prompt Learning for Zero-shot Anomaly Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3e</span></a>, the refined DPAM attention maps are more diagonally prominent, resulting in substantially improved segmentation maps in both original CLIP and our AnomalyCLIP. Compared to CLIP that is based on global features and manually defined text prompts, the text prompts learned by AnomalyCLIP are more fine-grained, enabling substantially more accurate alignment between the normality/abnormality prompt embeddings and the local visual embeddings across four different self-attention schemes. This, in turn, allows AnomalyCLIP to generate accurate <math id="S3.SS3.SSS0.Px3.p1.9.m9.1" class="ltx_Math" alttext="S_{n}" display="inline"><semantics id="S3.SS3.SSS0.Px3.p1.9.m9.1a"><msub id="S3.SS3.SSS0.Px3.p1.9.m9.1.1" xref="S3.SS3.SSS0.Px3.p1.9.m9.1.1.cmml"><mi id="S3.SS3.SSS0.Px3.p1.9.m9.1.1.2" xref="S3.SS3.SSS0.Px3.p1.9.m9.1.1.2.cmml">S</mi><mi id="S3.SS3.SSS0.Px3.p1.9.m9.1.1.3" xref="S3.SS3.SSS0.Px3.p1.9.m9.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px3.p1.9.m9.1b"><apply id="S3.SS3.SSS0.Px3.p1.9.m9.1.1.cmml" xref="S3.SS3.SSS0.Px3.p1.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px3.p1.9.m9.1.1.1.cmml" xref="S3.SS3.SSS0.Px3.p1.9.m9.1.1">subscript</csymbol><ci id="S3.SS3.SSS0.Px3.p1.9.m9.1.1.2.cmml" xref="S3.SS3.SSS0.Px3.p1.9.m9.1.1.2">𝑆</ci><ci id="S3.SS3.SSS0.Px3.p1.9.m9.1.1.3.cmml" xref="S3.SS3.SSS0.Px3.p1.9.m9.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px3.p1.9.m9.1c">S_{n}</annotation></semantics></math> and <math id="S3.SS3.SSS0.Px3.p1.10.m10.1" class="ltx_Math" alttext="S_{a}" display="inline"><semantics id="S3.SS3.SSS0.Px3.p1.10.m10.1a"><msub id="S3.SS3.SSS0.Px3.p1.10.m10.1.1" xref="S3.SS3.SSS0.Px3.p1.10.m10.1.1.cmml"><mi id="S3.SS3.SSS0.Px3.p1.10.m10.1.1.2" xref="S3.SS3.SSS0.Px3.p1.10.m10.1.1.2.cmml">S</mi><mi id="S3.SS3.SSS0.Px3.p1.10.m10.1.1.3" xref="S3.SS3.SSS0.Px3.p1.10.m10.1.1.3.cmml">a</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px3.p1.10.m10.1b"><apply id="S3.SS3.SSS0.Px3.p1.10.m10.1.1.cmml" xref="S3.SS3.SSS0.Px3.p1.10.m10.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px3.p1.10.m10.1.1.1.cmml" xref="S3.SS3.SSS0.Px3.p1.10.m10.1.1">subscript</csymbol><ci id="S3.SS3.SSS0.Px3.p1.10.m10.1.1.2.cmml" xref="S3.SS3.SSS0.Px3.p1.10.m10.1.1.2">𝑆</ci><ci id="S3.SS3.SSS0.Px3.p1.10.m10.1.1.3.cmml" xref="S3.SS3.SSS0.Px3.p1.10.m10.1.1.3">𝑎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px3.p1.10.m10.1c">S_{a}</annotation></semantics></math> for the joint optimization in Eq. <a href="#S3.E2" title="In Glocal context optimization ‣ 3.3 Learning generic abnormality and normality prompts ‣ 3 AnomalyCLIP: object-agnostic prompt learning ‣ AnomalyCLIP: Object-agnostic Prompt Learning for Zero-shot Anomaly Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>.
Unless otherwise specified, AnomalyCLIP utilizes <math id="S3.SS3.SSS0.Px3.p1.11.m11.1" class="ltx_Math" alttext="V" display="inline"><semantics id="S3.SS3.SSS0.Px3.p1.11.m11.1a"><mi id="S3.SS3.SSS0.Px3.p1.11.m11.1.1" xref="S3.SS3.SSS0.Px3.p1.11.m11.1.1.cmml">V</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px3.p1.11.m11.1b"><ci id="S3.SS3.SSS0.Px3.p1.11.m11.1.1.cmml" xref="S3.SS3.SSS0.Px3.p1.11.m11.1.1">𝑉</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px3.p1.11.m11.1c">V</annotation></semantics></math>-<math id="S3.SS3.SSS0.Px3.p1.12.m12.1" class="ltx_Math" alttext="V" display="inline"><semantics id="S3.SS3.SSS0.Px3.p1.12.m12.1a"><mi id="S3.SS3.SSS0.Px3.p1.12.m12.1.1" xref="S3.SS3.SSS0.Px3.p1.12.m12.1.1.cmml">V</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px3.p1.12.m12.1b"><ci id="S3.SS3.SSS0.Px3.p1.12.m12.1.1.cmml" xref="S3.SS3.SSS0.Px3.p1.12.m12.1.1">𝑉</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px3.p1.12.m12.1c">V</annotation></semantics></math> self-attention due to its superior overall performance. The performance of different self-attention mechanisms is analyzed in Sec. <a href="#A4" title="Appendix D Additional results and ablations ‣ AnomalyCLIP: Object-agnostic Prompt Learning for Zero-shot Anomaly Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">D</span></a>. We also provide a detailed explanation about DPAM in Appendix <a href="#A3" title="Appendix C Detailed Analysis of DPAM ‣ AnomalyCLIP: Object-agnostic Prompt Learning for Zero-shot Anomaly Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">C</span></a>.</p>
</div>
</section>
<section id="S3.SS3.SSS0.Px4" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Training and Inference</h5>

<div id="S3.SS3.SSS0.Px4.p1" class="ltx_para ltx_noindent">
<p id="S3.SS3.SSS0.Px4.p1.10" class="ltx_p">During training, AnomalyCLIP minimizes the loss in Eq. <a href="#S3.E2" title="In Glocal context optimization ‣ 3.3 Learning generic abnormality and normality prompts ‣ 3 AnomalyCLIP: object-agnostic prompt learning ‣ AnomalyCLIP: Object-agnostic Prompt Learning for Zero-shot Anomaly Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> using an auxiliary AD-related dataset. As for inference, given a test image <math id="S3.SS3.SSS0.Px4.p1.1.m1.1" class="ltx_Math" alttext="x_{i}" display="inline"><semantics id="S3.SS3.SSS0.Px4.p1.1.m1.1a"><msub id="S3.SS3.SSS0.Px4.p1.1.m1.1.1" xref="S3.SS3.SSS0.Px4.p1.1.m1.1.1.cmml"><mi id="S3.SS3.SSS0.Px4.p1.1.m1.1.1.2" xref="S3.SS3.SSS0.Px4.p1.1.m1.1.1.2.cmml">x</mi><mi id="S3.SS3.SSS0.Px4.p1.1.m1.1.1.3" xref="S3.SS3.SSS0.Px4.p1.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px4.p1.1.m1.1b"><apply id="S3.SS3.SSS0.Px4.p1.1.m1.1.1.cmml" xref="S3.SS3.SSS0.Px4.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px4.p1.1.m1.1.1.1.cmml" xref="S3.SS3.SSS0.Px4.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS3.SSS0.Px4.p1.1.m1.1.1.2.cmml" xref="S3.SS3.SSS0.Px4.p1.1.m1.1.1.2">𝑥</ci><ci id="S3.SS3.SSS0.Px4.p1.1.m1.1.1.3.cmml" xref="S3.SS3.SSS0.Px4.p1.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px4.p1.1.m1.1c">x_{i}</annotation></semantics></math>, we use the similarity score <math id="S3.SS3.SSS0.Px4.p1.2.m2.2" class="ltx_Math" alttext="P(g_{a},f_{i})" display="inline"><semantics id="S3.SS3.SSS0.Px4.p1.2.m2.2a"><mrow id="S3.SS3.SSS0.Px4.p1.2.m2.2.2" xref="S3.SS3.SSS0.Px4.p1.2.m2.2.2.cmml"><mi id="S3.SS3.SSS0.Px4.p1.2.m2.2.2.4" xref="S3.SS3.SSS0.Px4.p1.2.m2.2.2.4.cmml">P</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS0.Px4.p1.2.m2.2.2.3" xref="S3.SS3.SSS0.Px4.p1.2.m2.2.2.3.cmml">​</mo><mrow id="S3.SS3.SSS0.Px4.p1.2.m2.2.2.2.2" xref="S3.SS3.SSS0.Px4.p1.2.m2.2.2.2.3.cmml"><mo stretchy="false" id="S3.SS3.SSS0.Px4.p1.2.m2.2.2.2.2.3" xref="S3.SS3.SSS0.Px4.p1.2.m2.2.2.2.3.cmml">(</mo><msub id="S3.SS3.SSS0.Px4.p1.2.m2.1.1.1.1.1" xref="S3.SS3.SSS0.Px4.p1.2.m2.1.1.1.1.1.cmml"><mi id="S3.SS3.SSS0.Px4.p1.2.m2.1.1.1.1.1.2" xref="S3.SS3.SSS0.Px4.p1.2.m2.1.1.1.1.1.2.cmml">g</mi><mi id="S3.SS3.SSS0.Px4.p1.2.m2.1.1.1.1.1.3" xref="S3.SS3.SSS0.Px4.p1.2.m2.1.1.1.1.1.3.cmml">a</mi></msub><mo id="S3.SS3.SSS0.Px4.p1.2.m2.2.2.2.2.4" xref="S3.SS3.SSS0.Px4.p1.2.m2.2.2.2.3.cmml">,</mo><msub id="S3.SS3.SSS0.Px4.p1.2.m2.2.2.2.2.2" xref="S3.SS3.SSS0.Px4.p1.2.m2.2.2.2.2.2.cmml"><mi id="S3.SS3.SSS0.Px4.p1.2.m2.2.2.2.2.2.2" xref="S3.SS3.SSS0.Px4.p1.2.m2.2.2.2.2.2.2.cmml">f</mi><mi id="S3.SS3.SSS0.Px4.p1.2.m2.2.2.2.2.2.3" xref="S3.SS3.SSS0.Px4.p1.2.m2.2.2.2.2.2.3.cmml">i</mi></msub><mo stretchy="false" id="S3.SS3.SSS0.Px4.p1.2.m2.2.2.2.2.5" xref="S3.SS3.SSS0.Px4.p1.2.m2.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px4.p1.2.m2.2b"><apply id="S3.SS3.SSS0.Px4.p1.2.m2.2.2.cmml" xref="S3.SS3.SSS0.Px4.p1.2.m2.2.2"><times id="S3.SS3.SSS0.Px4.p1.2.m2.2.2.3.cmml" xref="S3.SS3.SSS0.Px4.p1.2.m2.2.2.3"></times><ci id="S3.SS3.SSS0.Px4.p1.2.m2.2.2.4.cmml" xref="S3.SS3.SSS0.Px4.p1.2.m2.2.2.4">𝑃</ci><interval closure="open" id="S3.SS3.SSS0.Px4.p1.2.m2.2.2.2.3.cmml" xref="S3.SS3.SSS0.Px4.p1.2.m2.2.2.2.2"><apply id="S3.SS3.SSS0.Px4.p1.2.m2.1.1.1.1.1.cmml" xref="S3.SS3.SSS0.Px4.p1.2.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px4.p1.2.m2.1.1.1.1.1.1.cmml" xref="S3.SS3.SSS0.Px4.p1.2.m2.1.1.1.1.1">subscript</csymbol><ci id="S3.SS3.SSS0.Px4.p1.2.m2.1.1.1.1.1.2.cmml" xref="S3.SS3.SSS0.Px4.p1.2.m2.1.1.1.1.1.2">𝑔</ci><ci id="S3.SS3.SSS0.Px4.p1.2.m2.1.1.1.1.1.3.cmml" xref="S3.SS3.SSS0.Px4.p1.2.m2.1.1.1.1.1.3">𝑎</ci></apply><apply id="S3.SS3.SSS0.Px4.p1.2.m2.2.2.2.2.2.cmml" xref="S3.SS3.SSS0.Px4.p1.2.m2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px4.p1.2.m2.2.2.2.2.2.1.cmml" xref="S3.SS3.SSS0.Px4.p1.2.m2.2.2.2.2.2">subscript</csymbol><ci id="S3.SS3.SSS0.Px4.p1.2.m2.2.2.2.2.2.2.cmml" xref="S3.SS3.SSS0.Px4.p1.2.m2.2.2.2.2.2.2">𝑓</ci><ci id="S3.SS3.SSS0.Px4.p1.2.m2.2.2.2.2.2.3.cmml" xref="S3.SS3.SSS0.Px4.p1.2.m2.2.2.2.2.2.3">𝑖</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px4.p1.2.m2.2c">P(g_{a},f_{i})</annotation></semantics></math> as the image-level anomaly score, with the anomaly score leaning toward one when the anomaly textual embedding <math id="S3.SS3.SSS0.Px4.p1.3.m3.1" class="ltx_Math" alttext="g_{a}" display="inline"><semantics id="S3.SS3.SSS0.Px4.p1.3.m3.1a"><msub id="S3.SS3.SSS0.Px4.p1.3.m3.1.1" xref="S3.SS3.SSS0.Px4.p1.3.m3.1.1.cmml"><mi id="S3.SS3.SSS0.Px4.p1.3.m3.1.1.2" xref="S3.SS3.SSS0.Px4.p1.3.m3.1.1.2.cmml">g</mi><mi id="S3.SS3.SSS0.Px4.p1.3.m3.1.1.3" xref="S3.SS3.SSS0.Px4.p1.3.m3.1.1.3.cmml">a</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px4.p1.3.m3.1b"><apply id="S3.SS3.SSS0.Px4.p1.3.m3.1.1.cmml" xref="S3.SS3.SSS0.Px4.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px4.p1.3.m3.1.1.1.cmml" xref="S3.SS3.SSS0.Px4.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS3.SSS0.Px4.p1.3.m3.1.1.2.cmml" xref="S3.SS3.SSS0.Px4.p1.3.m3.1.1.2">𝑔</ci><ci id="S3.SS3.SSS0.Px4.p1.3.m3.1.1.3.cmml" xref="S3.SS3.SSS0.Px4.p1.3.m3.1.1.3">𝑎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px4.p1.3.m3.1c">g_{a}</annotation></semantics></math> is aligned with the global visual embedding <math id="S3.SS3.SSS0.Px4.p1.4.m4.1" class="ltx_Math" alttext="f_{i}" display="inline"><semantics id="S3.SS3.SSS0.Px4.p1.4.m4.1a"><msub id="S3.SS3.SSS0.Px4.p1.4.m4.1.1" xref="S3.SS3.SSS0.Px4.p1.4.m4.1.1.cmml"><mi id="S3.SS3.SSS0.Px4.p1.4.m4.1.1.2" xref="S3.SS3.SSS0.Px4.p1.4.m4.1.1.2.cmml">f</mi><mi id="S3.SS3.SSS0.Px4.p1.4.m4.1.1.3" xref="S3.SS3.SSS0.Px4.p1.4.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px4.p1.4.m4.1b"><apply id="S3.SS3.SSS0.Px4.p1.4.m4.1.1.cmml" xref="S3.SS3.SSS0.Px4.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px4.p1.4.m4.1.1.1.cmml" xref="S3.SS3.SSS0.Px4.p1.4.m4.1.1">subscript</csymbol><ci id="S3.SS3.SSS0.Px4.p1.4.m4.1.1.2.cmml" xref="S3.SS3.SSS0.Px4.p1.4.m4.1.1.2">𝑓</ci><ci id="S3.SS3.SSS0.Px4.p1.4.m4.1.1.3.cmml" xref="S3.SS3.SSS0.Px4.p1.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px4.p1.4.m4.1c">f_{i}</annotation></semantics></math>. For pixel-wise predictions, we merge the segmentation <math id="S3.SS3.SSS0.Px4.p1.5.m5.1" class="ltx_Math" alttext="S_{n}" display="inline"><semantics id="S3.SS3.SSS0.Px4.p1.5.m5.1a"><msub id="S3.SS3.SSS0.Px4.p1.5.m5.1.1" xref="S3.SS3.SSS0.Px4.p1.5.m5.1.1.cmml"><mi id="S3.SS3.SSS0.Px4.p1.5.m5.1.1.2" xref="S3.SS3.SSS0.Px4.p1.5.m5.1.1.2.cmml">S</mi><mi id="S3.SS3.SSS0.Px4.p1.5.m5.1.1.3" xref="S3.SS3.SSS0.Px4.p1.5.m5.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px4.p1.5.m5.1b"><apply id="S3.SS3.SSS0.Px4.p1.5.m5.1.1.cmml" xref="S3.SS3.SSS0.Px4.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px4.p1.5.m5.1.1.1.cmml" xref="S3.SS3.SSS0.Px4.p1.5.m5.1.1">subscript</csymbol><ci id="S3.SS3.SSS0.Px4.p1.5.m5.1.1.2.cmml" xref="S3.SS3.SSS0.Px4.p1.5.m5.1.1.2">𝑆</ci><ci id="S3.SS3.SSS0.Px4.p1.5.m5.1.1.3.cmml" xref="S3.SS3.SSS0.Px4.p1.5.m5.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px4.p1.5.m5.1c">S_{n}</annotation></semantics></math> and <math id="S3.SS3.SSS0.Px4.p1.6.m6.1" class="ltx_Math" alttext="S_{a}" display="inline"><semantics id="S3.SS3.SSS0.Px4.p1.6.m6.1a"><msub id="S3.SS3.SSS0.Px4.p1.6.m6.1.1" xref="S3.SS3.SSS0.Px4.p1.6.m6.1.1.cmml"><mi id="S3.SS3.SSS0.Px4.p1.6.m6.1.1.2" xref="S3.SS3.SSS0.Px4.p1.6.m6.1.1.2.cmml">S</mi><mi id="S3.SS3.SSS0.Px4.p1.6.m6.1.1.3" xref="S3.SS3.SSS0.Px4.p1.6.m6.1.1.3.cmml">a</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px4.p1.6.m6.1b"><apply id="S3.SS3.SSS0.Px4.p1.6.m6.1.1.cmml" xref="S3.SS3.SSS0.Px4.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px4.p1.6.m6.1.1.1.cmml" xref="S3.SS3.SSS0.Px4.p1.6.m6.1.1">subscript</csymbol><ci id="S3.SS3.SSS0.Px4.p1.6.m6.1.1.2.cmml" xref="S3.SS3.SSS0.Px4.p1.6.m6.1.1.2">𝑆</ci><ci id="S3.SS3.SSS0.Px4.p1.6.m6.1.1.3.cmml" xref="S3.SS3.SSS0.Px4.p1.6.m6.1.1.3">𝑎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px4.p1.6.m6.1c">S_{a}</annotation></semantics></math>, followed by an interpolation and smoothing operation. Formally, our anomaly score map <math id="S3.SS3.SSS0.Px4.p1.7.m7.1" class="ltx_Math" alttext="M\in\mathbb{R}^{H_{image}\times W_{image}}" display="inline"><semantics id="S3.SS3.SSS0.Px4.p1.7.m7.1a"><mrow id="S3.SS3.SSS0.Px4.p1.7.m7.1.1" xref="S3.SS3.SSS0.Px4.p1.7.m7.1.1.cmml"><mi id="S3.SS3.SSS0.Px4.p1.7.m7.1.1.2" xref="S3.SS3.SSS0.Px4.p1.7.m7.1.1.2.cmml">M</mi><mo id="S3.SS3.SSS0.Px4.p1.7.m7.1.1.1" xref="S3.SS3.SSS0.Px4.p1.7.m7.1.1.1.cmml">∈</mo><msup id="S3.SS3.SSS0.Px4.p1.7.m7.1.1.3" xref="S3.SS3.SSS0.Px4.p1.7.m7.1.1.3.cmml"><mi id="S3.SS3.SSS0.Px4.p1.7.m7.1.1.3.2" xref="S3.SS3.SSS0.Px4.p1.7.m7.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS3.SSS0.Px4.p1.7.m7.1.1.3.3" xref="S3.SS3.SSS0.Px4.p1.7.m7.1.1.3.3.cmml"><msub id="S3.SS3.SSS0.Px4.p1.7.m7.1.1.3.3.2" xref="S3.SS3.SSS0.Px4.p1.7.m7.1.1.3.3.2.cmml"><mi id="S3.SS3.SSS0.Px4.p1.7.m7.1.1.3.3.2.2" xref="S3.SS3.SSS0.Px4.p1.7.m7.1.1.3.3.2.2.cmml">H</mi><mrow id="S3.SS3.SSS0.Px4.p1.7.m7.1.1.3.3.2.3" xref="S3.SS3.SSS0.Px4.p1.7.m7.1.1.3.3.2.3.cmml"><mi id="S3.SS3.SSS0.Px4.p1.7.m7.1.1.3.3.2.3.2" xref="S3.SS3.SSS0.Px4.p1.7.m7.1.1.3.3.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS0.Px4.p1.7.m7.1.1.3.3.2.3.1" xref="S3.SS3.SSS0.Px4.p1.7.m7.1.1.3.3.2.3.1.cmml">​</mo><mi id="S3.SS3.SSS0.Px4.p1.7.m7.1.1.3.3.2.3.3" xref="S3.SS3.SSS0.Px4.p1.7.m7.1.1.3.3.2.3.3.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS0.Px4.p1.7.m7.1.1.3.3.2.3.1a" xref="S3.SS3.SSS0.Px4.p1.7.m7.1.1.3.3.2.3.1.cmml">​</mo><mi id="S3.SS3.SSS0.Px4.p1.7.m7.1.1.3.3.2.3.4" xref="S3.SS3.SSS0.Px4.p1.7.m7.1.1.3.3.2.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS0.Px4.p1.7.m7.1.1.3.3.2.3.1b" xref="S3.SS3.SSS0.Px4.p1.7.m7.1.1.3.3.2.3.1.cmml">​</mo><mi id="S3.SS3.SSS0.Px4.p1.7.m7.1.1.3.3.2.3.5" xref="S3.SS3.SSS0.Px4.p1.7.m7.1.1.3.3.2.3.5.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS0.Px4.p1.7.m7.1.1.3.3.2.3.1c" xref="S3.SS3.SSS0.Px4.p1.7.m7.1.1.3.3.2.3.1.cmml">​</mo><mi id="S3.SS3.SSS0.Px4.p1.7.m7.1.1.3.3.2.3.6" xref="S3.SS3.SSS0.Px4.p1.7.m7.1.1.3.3.2.3.6.cmml">e</mi></mrow></msub><mo lspace="0.222em" rspace="0.222em" id="S3.SS3.SSS0.Px4.p1.7.m7.1.1.3.3.1" xref="S3.SS3.SSS0.Px4.p1.7.m7.1.1.3.3.1.cmml">×</mo><msub id="S3.SS3.SSS0.Px4.p1.7.m7.1.1.3.3.3" xref="S3.SS3.SSS0.Px4.p1.7.m7.1.1.3.3.3.cmml"><mi id="S3.SS3.SSS0.Px4.p1.7.m7.1.1.3.3.3.2" xref="S3.SS3.SSS0.Px4.p1.7.m7.1.1.3.3.3.2.cmml">W</mi><mrow id="S3.SS3.SSS0.Px4.p1.7.m7.1.1.3.3.3.3" xref="S3.SS3.SSS0.Px4.p1.7.m7.1.1.3.3.3.3.cmml"><mi id="S3.SS3.SSS0.Px4.p1.7.m7.1.1.3.3.3.3.2" xref="S3.SS3.SSS0.Px4.p1.7.m7.1.1.3.3.3.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS0.Px4.p1.7.m7.1.1.3.3.3.3.1" xref="S3.SS3.SSS0.Px4.p1.7.m7.1.1.3.3.3.3.1.cmml">​</mo><mi id="S3.SS3.SSS0.Px4.p1.7.m7.1.1.3.3.3.3.3" xref="S3.SS3.SSS0.Px4.p1.7.m7.1.1.3.3.3.3.3.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS0.Px4.p1.7.m7.1.1.3.3.3.3.1a" xref="S3.SS3.SSS0.Px4.p1.7.m7.1.1.3.3.3.3.1.cmml">​</mo><mi id="S3.SS3.SSS0.Px4.p1.7.m7.1.1.3.3.3.3.4" xref="S3.SS3.SSS0.Px4.p1.7.m7.1.1.3.3.3.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS0.Px4.p1.7.m7.1.1.3.3.3.3.1b" xref="S3.SS3.SSS0.Px4.p1.7.m7.1.1.3.3.3.3.1.cmml">​</mo><mi id="S3.SS3.SSS0.Px4.p1.7.m7.1.1.3.3.3.3.5" xref="S3.SS3.SSS0.Px4.p1.7.m7.1.1.3.3.3.3.5.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS0.Px4.p1.7.m7.1.1.3.3.3.3.1c" xref="S3.SS3.SSS0.Px4.p1.7.m7.1.1.3.3.3.3.1.cmml">​</mo><mi id="S3.SS3.SSS0.Px4.p1.7.m7.1.1.3.3.3.3.6" xref="S3.SS3.SSS0.Px4.p1.7.m7.1.1.3.3.3.3.6.cmml">e</mi></mrow></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px4.p1.7.m7.1b"><apply id="S3.SS3.SSS0.Px4.p1.7.m7.1.1.cmml" xref="S3.SS3.SSS0.Px4.p1.7.m7.1.1"><in id="S3.SS3.SSS0.Px4.p1.7.m7.1.1.1.cmml" xref="S3.SS3.SSS0.Px4.p1.7.m7.1.1.1"></in><ci id="S3.SS3.SSS0.Px4.p1.7.m7.1.1.2.cmml" xref="S3.SS3.SSS0.Px4.p1.7.m7.1.1.2">𝑀</ci><apply id="S3.SS3.SSS0.Px4.p1.7.m7.1.1.3.cmml" xref="S3.SS3.SSS0.Px4.p1.7.m7.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px4.p1.7.m7.1.1.3.1.cmml" xref="S3.SS3.SSS0.Px4.p1.7.m7.1.1.3">superscript</csymbol><ci id="S3.SS3.SSS0.Px4.p1.7.m7.1.1.3.2.cmml" xref="S3.SS3.SSS0.Px4.p1.7.m7.1.1.3.2">ℝ</ci><apply id="S3.SS3.SSS0.Px4.p1.7.m7.1.1.3.3.cmml" xref="S3.SS3.SSS0.Px4.p1.7.m7.1.1.3.3"><times id="S3.SS3.SSS0.Px4.p1.7.m7.1.1.3.3.1.cmml" xref="S3.SS3.SSS0.Px4.p1.7.m7.1.1.3.3.1"></times><apply id="S3.SS3.SSS0.Px4.p1.7.m7.1.1.3.3.2.cmml" xref="S3.SS3.SSS0.Px4.p1.7.m7.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px4.p1.7.m7.1.1.3.3.2.1.cmml" xref="S3.SS3.SSS0.Px4.p1.7.m7.1.1.3.3.2">subscript</csymbol><ci id="S3.SS3.SSS0.Px4.p1.7.m7.1.1.3.3.2.2.cmml" xref="S3.SS3.SSS0.Px4.p1.7.m7.1.1.3.3.2.2">𝐻</ci><apply id="S3.SS3.SSS0.Px4.p1.7.m7.1.1.3.3.2.3.cmml" xref="S3.SS3.SSS0.Px4.p1.7.m7.1.1.3.3.2.3"><times id="S3.SS3.SSS0.Px4.p1.7.m7.1.1.3.3.2.3.1.cmml" xref="S3.SS3.SSS0.Px4.p1.7.m7.1.1.3.3.2.3.1"></times><ci id="S3.SS3.SSS0.Px4.p1.7.m7.1.1.3.3.2.3.2.cmml" xref="S3.SS3.SSS0.Px4.p1.7.m7.1.1.3.3.2.3.2">𝑖</ci><ci id="S3.SS3.SSS0.Px4.p1.7.m7.1.1.3.3.2.3.3.cmml" xref="S3.SS3.SSS0.Px4.p1.7.m7.1.1.3.3.2.3.3">𝑚</ci><ci id="S3.SS3.SSS0.Px4.p1.7.m7.1.1.3.3.2.3.4.cmml" xref="S3.SS3.SSS0.Px4.p1.7.m7.1.1.3.3.2.3.4">𝑎</ci><ci id="S3.SS3.SSS0.Px4.p1.7.m7.1.1.3.3.2.3.5.cmml" xref="S3.SS3.SSS0.Px4.p1.7.m7.1.1.3.3.2.3.5">𝑔</ci><ci id="S3.SS3.SSS0.Px4.p1.7.m7.1.1.3.3.2.3.6.cmml" xref="S3.SS3.SSS0.Px4.p1.7.m7.1.1.3.3.2.3.6">𝑒</ci></apply></apply><apply id="S3.SS3.SSS0.Px4.p1.7.m7.1.1.3.3.3.cmml" xref="S3.SS3.SSS0.Px4.p1.7.m7.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px4.p1.7.m7.1.1.3.3.3.1.cmml" xref="S3.SS3.SSS0.Px4.p1.7.m7.1.1.3.3.3">subscript</csymbol><ci id="S3.SS3.SSS0.Px4.p1.7.m7.1.1.3.3.3.2.cmml" xref="S3.SS3.SSS0.Px4.p1.7.m7.1.1.3.3.3.2">𝑊</ci><apply id="S3.SS3.SSS0.Px4.p1.7.m7.1.1.3.3.3.3.cmml" xref="S3.SS3.SSS0.Px4.p1.7.m7.1.1.3.3.3.3"><times id="S3.SS3.SSS0.Px4.p1.7.m7.1.1.3.3.3.3.1.cmml" xref="S3.SS3.SSS0.Px4.p1.7.m7.1.1.3.3.3.3.1"></times><ci id="S3.SS3.SSS0.Px4.p1.7.m7.1.1.3.3.3.3.2.cmml" xref="S3.SS3.SSS0.Px4.p1.7.m7.1.1.3.3.3.3.2">𝑖</ci><ci id="S3.SS3.SSS0.Px4.p1.7.m7.1.1.3.3.3.3.3.cmml" xref="S3.SS3.SSS0.Px4.p1.7.m7.1.1.3.3.3.3.3">𝑚</ci><ci id="S3.SS3.SSS0.Px4.p1.7.m7.1.1.3.3.3.3.4.cmml" xref="S3.SS3.SSS0.Px4.p1.7.m7.1.1.3.3.3.3.4">𝑎</ci><ci id="S3.SS3.SSS0.Px4.p1.7.m7.1.1.3.3.3.3.5.cmml" xref="S3.SS3.SSS0.Px4.p1.7.m7.1.1.3.3.3.3.5">𝑔</ci><ci id="S3.SS3.SSS0.Px4.p1.7.m7.1.1.3.3.3.3.6.cmml" xref="S3.SS3.SSS0.Px4.p1.7.m7.1.1.3.3.3.3.6">𝑒</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px4.p1.7.m7.1c">M\in\mathbb{R}^{H_{image}\times W_{image}}</annotation></semantics></math> is computed as <math id="S3.SS3.SSS0.Px4.p1.8.m8.1" class="ltx_Math" alttext="M=G_{\sigma}(Bilinear\_interploation(\frac{1}{2}(I-S_{n}+S_{a})))" display="inline"><semantics id="S3.SS3.SSS0.Px4.p1.8.m8.1a"><mrow id="S3.SS3.SSS0.Px4.p1.8.m8.1.1" xref="S3.SS3.SSS0.Px4.p1.8.m8.1.1.cmml"><mi id="S3.SS3.SSS0.Px4.p1.8.m8.1.1.3" xref="S3.SS3.SSS0.Px4.p1.8.m8.1.1.3.cmml">M</mi><mo id="S3.SS3.SSS0.Px4.p1.8.m8.1.1.2" xref="S3.SS3.SSS0.Px4.p1.8.m8.1.1.2.cmml">=</mo><mrow id="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1" xref="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.cmml"><msub id="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.3" xref="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.3.cmml"><mi id="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.3.2" xref="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.3.2.cmml">G</mi><mi id="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.3.3" xref="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.3.3.cmml">σ</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.2" xref="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.2.cmml">​</mo><mrow id="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1" xref="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.2" xref="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1" xref="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.cmml"><mi id="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.3" xref="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.3.cmml">B</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.2" xref="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.2.cmml">​</mo><mi id="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.4" xref="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.4.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.2a" xref="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.2.cmml">​</mo><mi id="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.5" xref="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.5.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.2b" xref="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.2.cmml">​</mo><mi id="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.6" xref="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.6.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.2c" xref="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.2.cmml">​</mo><mi id="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.7" xref="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.7.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.2d" xref="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.2.cmml">​</mo><mi id="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.8" xref="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.8.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.2e" xref="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.2.cmml">​</mo><mi id="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.9" xref="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.9.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.2f" xref="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.2.cmml">​</mo><mi id="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.10" xref="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.10.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.2g" xref="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.2.cmml">​</mo><mi mathvariant="normal" id="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.11" xref="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.11.cmml">_</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.2h" xref="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.2.cmml">​</mo><mi id="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.12" xref="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.12.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.2i" xref="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.2.cmml">​</mo><mi id="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.13" xref="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.13.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.2j" xref="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.2.cmml">​</mo><mi id="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.14" xref="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.14.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.2k" xref="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.2.cmml">​</mo><mi id="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.15" xref="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.15.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.2l" xref="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.2.cmml">​</mo><mi id="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.16" xref="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.16.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.2m" xref="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.2.cmml">​</mo><mi id="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.17" xref="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.17.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.2n" xref="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.2.cmml">​</mo><mi id="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.18" xref="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.18.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.2o" xref="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.2.cmml">​</mo><mi id="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.19" xref="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.19.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.2p" xref="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.2.cmml">​</mo><mi id="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.20" xref="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.20.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.2q" xref="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.2.cmml">​</mo><mi id="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.21" xref="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.21.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.2r" xref="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.2.cmml">​</mo><mi id="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.22" xref="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.22.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.2s" xref="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.2.cmml">​</mo><mi id="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.23" xref="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.23.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.2t" xref="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.2.cmml">​</mo><mi id="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.24" xref="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.24.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.2u" xref="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.1.1" xref="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.1.1.2" xref="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.1.1.1" xref="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.1.1.1.cmml"><mfrac id="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.1.1.1.3" xref="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.1.1.1.3.cmml"><mn id="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.1.1.1.3.2" xref="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.1.1.1.3.2.cmml">1</mn><mn id="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.1.1.1.3.3" xref="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.1.1.1.3.3.cmml">2</mn></mfrac><mo lspace="0em" rspace="0em" id="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.1.1.1.2" xref="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.1.1.1.1.1" xref="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">I</mi><mo id="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.1.1.1.1.1.1.2.1" xref="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml">−</mo><msub id="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.1.1.1.1.1.1.2.3.2" xref="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.1.1.1.1.1.1.2.3.2.cmml">S</mi><mi id="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.1.1.1.1.1.1.2.3.3" xref="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.1.1.1.1.1.1.2.3.3.cmml">n</mi></msub></mrow><mo id="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">+</mo><msub id="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">S</mi><mi id="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">a</mi></msub></mrow><mo stretchy="false" id="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.1.1.3" xref="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.3" xref="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px4.p1.8.m8.1b"><apply id="S3.SS3.SSS0.Px4.p1.8.m8.1.1.cmml" xref="S3.SS3.SSS0.Px4.p1.8.m8.1.1"><eq id="S3.SS3.SSS0.Px4.p1.8.m8.1.1.2.cmml" xref="S3.SS3.SSS0.Px4.p1.8.m8.1.1.2"></eq><ci id="S3.SS3.SSS0.Px4.p1.8.m8.1.1.3.cmml" xref="S3.SS3.SSS0.Px4.p1.8.m8.1.1.3">𝑀</ci><apply id="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.cmml" xref="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1"><times id="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.2.cmml" xref="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.2"></times><apply id="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.3.cmml" xref="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.3.1.cmml" xref="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.3">subscript</csymbol><ci id="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.3.2.cmml" xref="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.3.2">𝐺</ci><ci id="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.3.3.cmml" xref="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.3.3">𝜎</ci></apply><apply id="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.cmml" xref="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1"><times id="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.2.cmml" xref="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.2"></times><ci id="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.3.cmml" xref="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.3">𝐵</ci><ci id="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.4.cmml" xref="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.4">𝑖</ci><ci id="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.5.cmml" xref="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.5">𝑙</ci><ci id="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.6.cmml" xref="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.6">𝑖</ci><ci id="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.7.cmml" xref="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.7">𝑛</ci><ci id="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.8.cmml" xref="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.8">𝑒</ci><ci id="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.9.cmml" xref="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.9">𝑎</ci><ci id="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.10.cmml" xref="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.10">𝑟</ci><ci id="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.11.cmml" xref="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.11">_</ci><ci id="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.12.cmml" xref="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.12">𝑖</ci><ci id="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.13.cmml" xref="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.13">𝑛</ci><ci id="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.14.cmml" xref="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.14">𝑡</ci><ci id="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.15.cmml" xref="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.15">𝑒</ci><ci id="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.16.cmml" xref="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.16">𝑟</ci><ci id="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.17.cmml" xref="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.17">𝑝</ci><ci id="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.18.cmml" xref="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.18">𝑙</ci><ci id="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.19.cmml" xref="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.19">𝑜</ci><ci id="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.20.cmml" xref="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.20">𝑎</ci><ci id="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.21.cmml" xref="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.21">𝑡</ci><ci id="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.22.cmml" xref="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.22">𝑖</ci><ci id="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.23.cmml" xref="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.23">𝑜</ci><ci id="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.24.cmml" xref="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.24">𝑛</ci><apply id="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.1.1"><times id="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.1.1.1.2"></times><apply id="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.1.1.1.3"><divide id="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.1.1.1.3"></divide><cn type="integer" id="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.1.1.1.3.2">1</cn><cn type="integer" id="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.1.1.1.3.3">2</cn></apply><apply id="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.1.1.1.1.1"><plus id="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.1.1.1.1.1.1.1"></plus><apply id="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.1.1.1.1.1.1.2"><minus id="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.1.1.1.1.1.1.2.1"></minus><ci id="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.1.1.1.1.1.1.2.2">𝐼</ci><apply id="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.1.1.1.1.1.1.2.3.2">𝑆</ci><ci id="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.1.1.1.1.1.1.2.3.3">𝑛</ci></apply></apply><apply id="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.1.1.1.1.1.1.3.2">𝑆</ci><ci id="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.SS3.SSS0.Px4.p1.8.m8.1.1.1.1.1.1.1.1.1.1.1.1.3.3">𝑎</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px4.p1.8.m8.1c">M=G_{\sigma}(Bilinear\_interploation(\frac{1}{2}(I-S_{n}+S_{a})))</annotation></semantics></math>, where <math id="S3.SS3.SSS0.Px4.p1.9.m9.1" class="ltx_Math" alttext="G_{\sigma}" display="inline"><semantics id="S3.SS3.SSS0.Px4.p1.9.m9.1a"><msub id="S3.SS3.SSS0.Px4.p1.9.m9.1.1" xref="S3.SS3.SSS0.Px4.p1.9.m9.1.1.cmml"><mi id="S3.SS3.SSS0.Px4.p1.9.m9.1.1.2" xref="S3.SS3.SSS0.Px4.p1.9.m9.1.1.2.cmml">G</mi><mi id="S3.SS3.SSS0.Px4.p1.9.m9.1.1.3" xref="S3.SS3.SSS0.Px4.p1.9.m9.1.1.3.cmml">σ</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px4.p1.9.m9.1b"><apply id="S3.SS3.SSS0.Px4.p1.9.m9.1.1.cmml" xref="S3.SS3.SSS0.Px4.p1.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px4.p1.9.m9.1.1.1.cmml" xref="S3.SS3.SSS0.Px4.p1.9.m9.1.1">subscript</csymbol><ci id="S3.SS3.SSS0.Px4.p1.9.m9.1.1.2.cmml" xref="S3.SS3.SSS0.Px4.p1.9.m9.1.1.2">𝐺</ci><ci id="S3.SS3.SSS0.Px4.p1.9.m9.1.1.3.cmml" xref="S3.SS3.SSS0.Px4.p1.9.m9.1.1.3">𝜎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px4.p1.9.m9.1c">G_{\sigma}</annotation></semantics></math> represents a Gaussian filter, and <math id="S3.SS3.SSS0.Px4.p1.10.m10.1" class="ltx_Math" alttext="\sigma" display="inline"><semantics id="S3.SS3.SSS0.Px4.p1.10.m10.1a"><mi id="S3.SS3.SSS0.Px4.p1.10.m10.1.1" xref="S3.SS3.SSS0.Px4.p1.10.m10.1.1.cmml">σ</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px4.p1.10.m10.1b"><ci id="S3.SS3.SSS0.Px4.p1.10.m10.1.1.cmml" xref="S3.SS3.SSS0.Px4.p1.10.m10.1.1">𝜎</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px4.p1.10.m10.1c">\sigma</annotation></semantics></math> controls the extent of smoothing.</p>
</div>
</section>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Experiments</h2>

<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Experiment setup</h3>

<section id="S4.SS1.SSS0.Px1" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Datasets and Evaluation Metrics</h5>

<div id="S4.SS1.SSS0.Px1.p1" class="ltx_para ltx_noindent">
<p id="S4.SS1.SSS0.Px1.p1.1" class="ltx_p">We conducted extensive experiments on 17 publicly available datasets, covering various industrial inspection scenarios and medical imaging domains (including photography, endoscopy, and radiology) to evaluate the performance of AnomalyCLIP. In industrial inspection, we consider MVTec AD <cite class="ltx_cite ltx_citemacro_citep">(Bergmann et al., <a href="#bib.bib2" title="" class="ltx_ref">2019</a>)</cite>, VisA <cite class="ltx_cite ltx_citemacro_citep">(Zou et al., <a href="#bib.bib62" title="" class="ltx_ref">2022</a>)</cite>, MPDD <cite class="ltx_cite ltx_citemacro_citep">(Jezek et al., <a href="#bib.bib21" title="" class="ltx_ref">2021</a>)</cite>, BTAD <cite class="ltx_cite ltx_citemacro_citep">(Mishra et al., <a href="#bib.bib35" title="" class="ltx_ref">2021</a>)</cite>, SDD <cite class="ltx_cite ltx_citemacro_citep">(Tabernik et al., <a href="#bib.bib49" title="" class="ltx_ref">2020</a>)</cite>, DAGM <cite class="ltx_cite ltx_citemacro_citep">(Wieler &amp; Hahn, <a href="#bib.bib54" title="" class="ltx_ref">2007</a>)</cite>, and DTD-Synthetic <cite class="ltx_cite ltx_citemacro_citep">(Aota et al., <a href="#bib.bib1" title="" class="ltx_ref">2023</a>)</cite>. In medical imaging, we consider skin cancer detection dataset ISIC <cite class="ltx_cite ltx_citemacro_citep">(Gutman et al., <a href="#bib.bib16" title="" class="ltx_ref">2016</a>)</cite>, colon polyp detection datasets CVC-ClinicDB <cite class="ltx_cite ltx_citemacro_citep">(Bernal et al., <a href="#bib.bib4" title="" class="ltx_ref">2015</a>)</cite>, CVC-ColonDB <cite class="ltx_cite ltx_citemacro_citep">(Tajbakhsh et al., <a href="#bib.bib50" title="" class="ltx_ref">2015</a>)</cite>, Kvasir <cite class="ltx_cite ltx_citemacro_citep">(Jha et al., <a href="#bib.bib22" title="" class="ltx_ref">2020</a>)</cite>, and Endo <cite class="ltx_cite ltx_citemacro_citep">(Hicks et al., <a href="#bib.bib18" title="" class="ltx_ref">2021</a>)</cite>, thyroid nodule detection dataset TN3k <cite class="ltx_cite ltx_citemacro_citep">(Gong et al., <a href="#bib.bib14" title="" class="ltx_ref">2021</a>)</cite>, brain tumor detection datasets HeadCT <cite class="ltx_cite ltx_citemacro_citep">(Salehi et al., <a href="#bib.bib47" title="" class="ltx_ref">2021</a>)</cite>, BrainMRI <cite class="ltx_cite ltx_citemacro_citep">(Salehi et al., <a href="#bib.bib47" title="" class="ltx_ref">2021</a>)</cite>, Br35H <cite class="ltx_cite ltx_citemacro_citep">(Hamada., <a href="#bib.bib17" title="" class="ltx_ref">2020</a>)</cite>, and COVID-19 detection dataset COVID-19 <cite class="ltx_cite ltx_citemacro_citep">(Chowdhury et al., <a href="#bib.bib8" title="" class="ltx_ref">2020</a>; Rahman et al., <a href="#bib.bib41" title="" class="ltx_ref">2021</a>)</cite>. The SOTA competing methods include CLIP <cite class="ltx_cite ltx_citemacro_citep">(Radford et al., <a href="#bib.bib40" title="" class="ltx_ref">2021</a>)</cite>, CLIP-AC <cite class="ltx_cite ltx_citemacro_citep">(Radford et al., <a href="#bib.bib40" title="" class="ltx_ref">2021</a>)</cite>, WinCLIP <cite class="ltx_cite ltx_citemacro_citep">(Jeong et al., <a href="#bib.bib20" title="" class="ltx_ref">2023</a>)</cite>, VAND <cite class="ltx_cite ltx_citemacro_citep">(Chen et al., <a href="#bib.bib6" title="" class="ltx_ref">2023</a>)</cite>, and CoOp <cite class="ltx_cite ltx_citemacro_citep">(Zhou et al., <a href="#bib.bib60" title="" class="ltx_ref">2022b</a>)</cite>. We provide more details about the methods and data pre-processing in Appendix <a href="#A1" title="Appendix A Implementation details and baselines ‣ AnomalyCLIP: Object-agnostic Prompt Learning for Zero-shot Anomaly Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">A</span></a>. The anomaly detection performance is evaluated using the Area Under the Receiver Operating Characteristic Curve (AUROC). Additionally, average precision (AP) for anomaly detection and AUPRO <cite class="ltx_cite ltx_citemacro_citep">(Bergmann et al., <a href="#bib.bib3" title="" class="ltx_ref">2020</a>)</cite> for anomaly segmentation are also used to provide more in-depth analysis of the performance.</p>
</div>
</section>
<section id="S4.SS1.SSS0.Px2" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Implementation details</h5>

<div id="S4.SS1.SSS0.Px2.p1" class="ltx_para ltx_noindent">
<p id="S4.SS1.SSS0.Px2.p1.1" class="ltx_p">We use the publicly available CLIP model<span id="footnote1" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>https://github.com/mlfoundations/open_clip</span></span></span> (<code id="S4.SS1.SSS0.Px2.p1.1.1" class="ltx_verbatim ltx_font_typewriter">VIT-L/14@336px</code>) as our backbone. Model parameters of CLIP are all frozen. The length of learnable word embeddings <math id="S4.SS1.SSS0.Px2.p1.1.m1.1" class="ltx_Math" alttext="E" display="inline"><semantics id="S4.SS1.SSS0.Px2.p1.1.m1.1a"><mi id="S4.SS1.SSS0.Px2.p1.1.m1.1.1" xref="S4.SS1.SSS0.Px2.p1.1.m1.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px2.p1.1.m1.1b"><ci id="S4.SS1.SSS0.Px2.p1.1.m1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.1.m1.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px2.p1.1.m1.1c">E</annotation></semantics></math> is set to 12. The learnable token embeddings are attached to the first 9 layers of the text encoder for refining the textual space, and their length in each layer is set to 4. We fine-tune AnomalyCLIP using the test data on MVTec AD and evaluate the ZSAD performance on other datasets. As for MVTec AD, we fine-tune AomalyCLIP on the test data of VisA. We report dataset-level results, which are averaged across their respective sub-datasets. All experiments are conducted in PyTorch-2.0.0 with a single NVIDIA RTX 3090 24GB GPU. More details can be found in Appendix <a href="#A1" title="Appendix A Implementation details and baselines ‣ AnomalyCLIP: Object-agnostic Prompt Learning for Zero-shot Anomaly Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">A</span></a>.</p>
</div>
<figure id="S4.T1" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1: </span>ZSAD performance comparison on industrial domain. The best performance is highlighted in red, and the second-best is highlighted in blue. <sup id="S4.T1.13.1" class="ltx_sup">†</sup> denotes results taken from original papers.</figcaption>
<table id="S4.T1.11" class="ltx_tabular ltx_centering ltx_align_middle">
<tr id="S4.T1.3.1" class="ltx_tr">
<td id="S4.T1.3.1.2" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:5.0pt;padding-right:5.0pt;">Task</td>
<td id="S4.T1.3.1.3" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:5.0pt;padding-right:5.0pt;">Category</td>
<td id="S4.T1.3.1.4" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:5.0pt;padding-right:5.0pt;">Datasets</td>
<td id="S4.T1.3.1.1" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:5.0pt;padding-right:5.0pt;"><math id="S4.T1.3.1.1.m1.1" class="ltx_Math" alttext="|\mathcal{C}|" display="inline"><semantics id="S4.T1.3.1.1.m1.1a"><mrow id="S4.T1.3.1.1.m1.1.2.2" xref="S4.T1.3.1.1.m1.1.2.1.cmml"><mo stretchy="false" id="S4.T1.3.1.1.m1.1.2.2.1" xref="S4.T1.3.1.1.m1.1.2.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S4.T1.3.1.1.m1.1.1" xref="S4.T1.3.1.1.m1.1.1.cmml">𝒞</mi><mo stretchy="false" id="S4.T1.3.1.1.m1.1.2.2.2" xref="S4.T1.3.1.1.m1.1.2.1.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.3.1.1.m1.1b"><apply id="S4.T1.3.1.1.m1.1.2.1.cmml" xref="S4.T1.3.1.1.m1.1.2.2"><abs id="S4.T1.3.1.1.m1.1.2.1.1.cmml" xref="S4.T1.3.1.1.m1.1.2.2.1"></abs><ci id="S4.T1.3.1.1.m1.1.1.cmml" xref="S4.T1.3.1.1.m1.1.1">𝒞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.3.1.1.m1.1c">|\mathcal{C}|</annotation></semantics></math></td>
<td id="S4.T1.3.1.5" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:5.0pt;padding-right:5.0pt;">CLIP</td>
<td id="S4.T1.3.1.6" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:5.0pt;padding-right:5.0pt;">CLIP-AC</td>
<td id="S4.T1.3.1.7" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:5.0pt;padding-right:5.0pt;">WinCLIP</td>
<td id="S4.T1.3.1.8" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:5.0pt;padding-right:5.0pt;">VAND</td>
<td id="S4.T1.3.1.9" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:5.0pt;padding-right:5.0pt;">CoOp</td>
<td id="S4.T1.3.1.10" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:5.0pt;padding-right:5.0pt;">AnomalyCLIP</td>
</tr>
<tr id="S4.T1.5.3" class="ltx_tr">
<td id="S4.T1.5.3.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;" rowspan="7"><span id="S4.T1.5.3.3.1" class="ltx_text"><span id="S4.T1.5.3.3.1.1" class="ltx_text"></span> <span id="S4.T1.5.3.3.1.2" class="ltx_text">
<span id="S4.T1.5.3.3.1.2.1" class="ltx_tabular ltx_align_middle">
<span id="S4.T1.5.3.3.1.2.1.1" class="ltx_tr">
<span id="S4.T1.5.3.3.1.2.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">Image-level</span></span>
<span id="S4.T1.5.3.3.1.2.1.2" class="ltx_tr">
<span id="S4.T1.5.3.3.1.2.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">(AUROC, AP)</span></span>
</span></span> <span id="S4.T1.5.3.3.1.3" class="ltx_text"></span></span></td>
<td id="S4.T1.5.3.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;">
<span id="S4.T1.5.3.4.1" class="ltx_text"></span> <span id="S4.T1.5.3.4.2" class="ltx_text">
<span id="S4.T1.5.3.4.2.1" class="ltx_tabular ltx_align_middle">
<span id="S4.T1.5.3.4.2.1.1" class="ltx_tr">
<span id="S4.T1.5.3.4.2.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">Obj &amp;texture</span></span>
</span></span><span id="S4.T1.5.3.4.3" class="ltx_text"></span></td>
<td id="S4.T1.5.3.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;">MVTec AD</td>
<td id="S4.T1.5.3.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;">15</td>
<td id="S4.T1.5.3.7" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;">(74.1, 87.6)</td>
<td id="S4.T1.5.3.8" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;">(71.5, 86.4)</td>
<td id="S4.T1.4.2.1" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;">(<span id="S4.T1.4.2.1.1" class="ltx_text" style="color:#FF0000;">91.8</span>, <span id="S4.T1.4.2.1.2" class="ltx_text" style="color:#FF0000;">96.5</span>)<sup id="S4.T1.4.2.1.3" class="ltx_sup">†</sup>
</td>
<td id="S4.T1.5.3.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;">(86.1, 93.5)<sup id="S4.T1.5.3.2.1" class="ltx_sup">†</sup>
</td>
<td id="S4.T1.5.3.9" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;">(88.8, 94.8)</td>
<td id="S4.T1.5.3.10" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;">(<span id="S4.T1.5.3.10.1" class="ltx_text" style="color:#0000FF;">91.5</span>, <span id="S4.T1.5.3.10.2" class="ltx_text" style="color:#0000FF;">96.2</span>)</td>
</tr>
<tr id="S4.T1.7.5" class="ltx_tr">
<td id="S4.T1.7.5.3" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;" rowspan="4"><span id="S4.T1.7.5.3.1" class="ltx_text">Obj</span></td>
<td id="S4.T1.7.5.4" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">VisA</td>
<td id="S4.T1.7.5.5" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">12</td>
<td id="S4.T1.7.5.6" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">(66.4, 71.5)</td>
<td id="S4.T1.7.5.7" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">(65.0, 70.1)</td>
<td id="S4.T1.6.4.1" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">(<span id="S4.T1.6.4.1.1" class="ltx_text" style="color:#0000FF;">78.1</span>, <span id="S4.T1.6.4.1.2" class="ltx_text" style="color:#0000FF;">81.2</span>)<sup id="S4.T1.6.4.1.3" class="ltx_sup">†</sup>
</td>
<td id="S4.T1.7.5.2" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">(78.0, 81.4)<sup id="S4.T1.7.5.2.1" class="ltx_sup">†</sup>
</td>
<td id="S4.T1.7.5.8" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">(62.8, 68.1)</td>
<td id="S4.T1.7.5.9" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">(<span id="S4.T1.7.5.9.1" class="ltx_text" style="color:#FF0000;">82.1</span>, <span id="S4.T1.7.5.9.2" class="ltx_text" style="color:#FF0000;">85.4</span>)</td>
</tr>
<tr id="S4.T1.11.10" class="ltx_tr">
<td id="S4.T1.11.10.1" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">MPDD</td>
<td id="S4.T1.11.10.2" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">6</td>
<td id="S4.T1.11.10.3" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">(54.3, 65.4)</td>
<td id="S4.T1.11.10.4" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">(56.2, 66.0)</td>
<td id="S4.T1.11.10.5" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">(63.6, 69.9)</td>
<td id="S4.T1.11.10.6" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">(<span id="S4.T1.11.10.6.1" class="ltx_text" style="color:#0000FF;">73.0</span>, <span id="S4.T1.11.10.6.2" class="ltx_text" style="color:#0000FF;">80.2</span>)</td>
<td id="S4.T1.11.10.7" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">(55.1, 64.2)</td>
<td id="S4.T1.11.10.8" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">(<span id="S4.T1.11.10.8.1" class="ltx_text" style="color:#FF0000;">77.0</span>, <span id="S4.T1.11.10.8.2" class="ltx_text" style="color:#FF0000;">82.0</span>)</td>
</tr>
<tr id="S4.T1.11.11" class="ltx_tr">
<td id="S4.T1.11.11.1" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">BTAD</td>
<td id="S4.T1.11.11.2" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">3</td>
<td id="S4.T1.11.11.3" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">(34.5, 52.5)</td>
<td id="S4.T1.11.11.4" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">(51.0, 62.1)</td>
<td id="S4.T1.11.11.5" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">(68.2, 70.9)</td>
<td id="S4.T1.11.11.6" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">(<span id="S4.T1.11.11.6.1" class="ltx_text" style="color:#0000FF;">73.6</span>, 68.6)</td>
<td id="S4.T1.11.11.7" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">(66.8, <span id="S4.T1.11.11.7.1" class="ltx_text" style="color:#0000FF;">77.4</span>)</td>
<td id="S4.T1.11.11.8" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">(<span id="S4.T1.11.11.8.1" class="ltx_text" style="color:#FF0000;">88.3</span>, <span id="S4.T1.11.11.8.2" class="ltx_text" style="color:#FF0000;">87.3</span>)</td>
</tr>
<tr id="S4.T1.11.12" class="ltx_tr">
<td id="S4.T1.11.12.1" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">SDD</td>
<td id="S4.T1.11.12.2" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">1</td>
<td id="S4.T1.11.12.3" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">(65.7, 45.2)</td>
<td id="S4.T1.11.12.4" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">(65.2, 45.7)</td>
<td id="S4.T1.11.12.5" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">(<span id="S4.T1.11.12.5.1" class="ltx_text" style="color:#0000FF;">84.3</span>, <span id="S4.T1.11.12.5.2" class="ltx_text" style="color:#0000FF;">77.4</span>)</td>
<td id="S4.T1.11.12.6" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">(79.8, 71.4)</td>
<td id="S4.T1.11.12.7" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">(74.9, 65.1)</td>
<td id="S4.T1.11.12.8" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">(<span id="S4.T1.11.12.8.1" class="ltx_text" style="color:#FF0000;">84.7</span>, <span id="S4.T1.11.12.8.2" class="ltx_text" style="color:#FF0000;">80.0</span>)</td>
</tr>
<tr id="S4.T1.11.13" class="ltx_tr">
<td id="S4.T1.11.13.1" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;" rowspan="2"><span id="S4.T1.11.13.1.1" class="ltx_text">Texture</span></td>
<td id="S4.T1.11.13.2" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">DAGM</td>
<td id="S4.T1.11.13.3" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">10</td>
<td id="S4.T1.11.13.4" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">(79.6, 59.0)</td>
<td id="S4.T1.11.13.5" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">(82.5, 63.7)</td>
<td id="S4.T1.11.13.6" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">(91.8, 79.5)</td>
<td id="S4.T1.11.13.7" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">(<span id="S4.T1.11.13.7.1" class="ltx_text" style="color:#0000FF;">94.4</span>, <span id="S4.T1.11.13.7.2" class="ltx_text" style="color:#0000FF;">83.8</span>)</td>
<td id="S4.T1.11.13.8" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">(87.5, 74.6)</td>
<td id="S4.T1.11.13.9" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">(<span id="S4.T1.11.13.9.1" class="ltx_text" style="color:#FF0000;">97.5</span>, <span id="S4.T1.11.13.9.2" class="ltx_text" style="color:#FF0000;">92.3</span>)</td>
</tr>
<tr id="S4.T1.11.14" class="ltx_tr">
<td id="S4.T1.11.14.1" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">DTD-Synthetic</td>
<td id="S4.T1.11.14.2" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">12</td>
<td id="S4.T1.11.14.3" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">(71.6, 85.7)</td>
<td id="S4.T1.11.14.4" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">(66.8, 83.2)</td>
<td id="S4.T1.11.14.5" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">(<span id="S4.T1.11.14.5.1" class="ltx_text" style="color:#0000FF;">93.2</span>, 92.6)</td>
<td id="S4.T1.11.14.6" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">(86.4, <span id="S4.T1.11.14.6.1" class="ltx_text" style="color:#0000FF;">95.0</span>)</td>
<td id="S4.T1.11.14.7" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">(-, -)</td>
<td id="S4.T1.11.14.8" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">(<span id="S4.T1.11.14.8.1" class="ltx_text" style="color:#FF0000;">93.5</span>, <span id="S4.T1.11.14.8.2" class="ltx_text" style="color:#FF0000;">97.0</span>)</td>
</tr>
<tr id="S4.T1.9.7" class="ltx_tr">
<td id="S4.T1.9.7.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;" rowspan="7"><span id="S4.T1.9.7.3.1" class="ltx_text"><span id="S4.T1.9.7.3.1.1" class="ltx_text"></span> <span id="S4.T1.9.7.3.1.2" class="ltx_text">
<span id="S4.T1.9.7.3.1.2.1" class="ltx_tabular ltx_align_middle">
<span id="S4.T1.9.7.3.1.2.1.1" class="ltx_tr">
<span id="S4.T1.9.7.3.1.2.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">Pixel-level</span></span>
<span id="S4.T1.9.7.3.1.2.1.2" class="ltx_tr">
<span id="S4.T1.9.7.3.1.2.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">(AUROC, PRO)</span></span>
</span></span> <span id="S4.T1.9.7.3.1.3" class="ltx_text"></span></span></td>
<td id="S4.T1.9.7.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;">
<span id="S4.T1.9.7.4.1" class="ltx_text"></span> <span id="S4.T1.9.7.4.2" class="ltx_text">
<span id="S4.T1.9.7.4.2.1" class="ltx_tabular ltx_align_middle">
<span id="S4.T1.9.7.4.2.1.1" class="ltx_tr">
<span id="S4.T1.9.7.4.2.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">Obj &amp;texture</span></span>
</span></span><span id="S4.T1.9.7.4.3" class="ltx_text"></span></td>
<td id="S4.T1.9.7.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;">MVTec AD</td>
<td id="S4.T1.9.7.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;">15</td>
<td id="S4.T1.9.7.7" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;">(38.4, 11.3)</td>
<td id="S4.T1.9.7.8" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;">(38.2, 11.6)</td>
<td id="S4.T1.8.6.1" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;">(85.1, <span id="S4.T1.8.6.1.1" class="ltx_text" style="color:#0000FF;">64.6</span>)<sup id="S4.T1.8.6.1.2" class="ltx_sup">†</sup>
</td>
<td id="S4.T1.9.7.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;">(<span id="S4.T1.9.7.2.1" class="ltx_text" style="color:#0000FF;">87.6</span>, 44.0)<sup id="S4.T1.9.7.2.2" class="ltx_sup">†</sup>
</td>
<td id="S4.T1.9.7.9" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;">(33.3, 6.7)</td>
<td id="S4.T1.9.7.10" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;">(<span id="S4.T1.9.7.10.1" class="ltx_text" style="color:#FF0000;">91.1</span>, <span id="S4.T1.9.7.10.2" class="ltx_text" style="color:#FF0000;">81.4</span>)</td>
</tr>
<tr id="S4.T1.11.9" class="ltx_tr">
<td id="S4.T1.11.9.3" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;" rowspan="4"><span id="S4.T1.11.9.3.1" class="ltx_text">Obj</span></td>
<td id="S4.T1.11.9.4" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">VisA</td>
<td id="S4.T1.11.9.5" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">12</td>
<td id="S4.T1.11.9.6" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">(46.6, 14.8)</td>
<td id="S4.T1.11.9.7" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">(47.8, 17.3)</td>
<td id="S4.T1.10.8.1" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">(79.6, 56.8)<sup id="S4.T1.10.8.1.1" class="ltx_sup">†</sup>
</td>
<td id="S4.T1.11.9.2" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">(<span id="S4.T1.11.9.2.1" class="ltx_text" style="color:#0000FF;">94.2</span>, <span id="S4.T1.11.9.2.2" class="ltx_text" style="color:#0000FF;">86.8</span>)<sup id="S4.T1.11.9.2.3" class="ltx_sup">†</sup>
</td>
<td id="S4.T1.11.9.8" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">(24.2, 3.8)</td>
<td id="S4.T1.11.9.9" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">(<span id="S4.T1.11.9.9.1" class="ltx_text" style="color:#FF0000;">95.5</span>, <span id="S4.T1.11.9.9.2" class="ltx_text" style="color:#FF0000;">87.0</span>)</td>
</tr>
<tr id="S4.T1.11.15" class="ltx_tr">
<td id="S4.T1.11.15.1" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">MPDD</td>
<td id="S4.T1.11.15.2" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">6</td>
<td id="S4.T1.11.15.3" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">(62.1, 33.0)</td>
<td id="S4.T1.11.15.4" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">(58.7, 29.1)</td>
<td id="S4.T1.11.15.5" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">(76.4, 48.9)</td>
<td id="S4.T1.11.15.6" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">(<span id="S4.T1.11.15.6.1" class="ltx_text" style="color:#0000FF;">94.1</span>, <span id="S4.T1.11.15.6.2" class="ltx_text" style="color:#0000FF;">83.2</span>)</td>
<td id="S4.T1.11.15.7" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">(15.4, 2.3)</td>
<td id="S4.T1.11.15.8" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">(<span id="S4.T1.11.15.8.1" class="ltx_text" style="color:#FF0000;">96.5</span>, <span id="S4.T1.11.15.8.2" class="ltx_text" style="color:#FF0000;">88.7</span>)</td>
</tr>
<tr id="S4.T1.11.16" class="ltx_tr">
<td id="S4.T1.11.16.1" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">BTAD</td>
<td id="S4.T1.11.16.2" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">3</td>
<td id="S4.T1.11.16.3" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">(30.6, 4.4)</td>
<td id="S4.T1.11.16.4" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">(32.8, 8.3)</td>
<td id="S4.T1.11.16.5" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">(<span id="S4.T1.11.16.5.1" class="ltx_text" style="color:#0000FF;">72.7</span>, 27.3)</td>
<td id="S4.T1.11.16.6" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">(60.8, <span id="S4.T1.11.16.6.1" class="ltx_text" style="color:#0000FF;">25.0</span>)</td>
<td id="S4.T1.11.16.7" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">(28.6, 3.8)</td>
<td id="S4.T1.11.16.8" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">(<span id="S4.T1.11.16.8.1" class="ltx_text" style="color:#FF0000;">94.2</span>, <span id="S4.T1.11.16.8.2" class="ltx_text" style="color:#FF0000;">74.8</span>)</td>
</tr>
<tr id="S4.T1.11.17" class="ltx_tr">
<td id="S4.T1.11.17.1" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">SDD</td>
<td id="S4.T1.11.17.2" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">1</td>
<td id="S4.T1.11.17.3" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">(39.0, 8.9)</td>
<td id="S4.T1.11.17.4" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">(32.5, 5.8)</td>
<td id="S4.T1.11.17.5" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">(68.8, 24.2)</td>
<td id="S4.T1.11.17.6" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">(<span id="S4.T1.11.17.6.1" class="ltx_text" style="color:#0000FF;">79.8</span>, <span id="S4.T1.11.17.6.2" class="ltx_text" style="color:#0000FF;">65.1</span>)</td>
<td id="S4.T1.11.17.7" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">(28.9, 7.1)</td>
<td id="S4.T1.11.17.8" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">(<span id="S4.T1.11.17.8.1" class="ltx_text" style="color:#FF0000;">90.6</span>, <span id="S4.T1.11.17.8.2" class="ltx_text" style="color:#FF0000;">67.8</span>)</td>
</tr>
<tr id="S4.T1.11.18" class="ltx_tr">
<td id="S4.T1.11.18.1" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:5.0pt;padding-right:5.0pt;" rowspan="2"><span id="S4.T1.11.18.1.1" class="ltx_text">Texture</span></td>
<td id="S4.T1.11.18.2" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">DAGM</td>
<td id="S4.T1.11.18.3" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">10</td>
<td id="S4.T1.11.18.4" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">(28.2, 2.9)</td>
<td id="S4.T1.11.18.5" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">(32.7, 4.8)</td>
<td id="S4.T1.11.18.6" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">(<span id="S4.T1.11.18.6.1" class="ltx_text" style="color:#0000FF;">87.6</span>, 65.7)</td>
<td id="S4.T1.11.18.7" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">(82.4, <span id="S4.T1.11.18.7.1" class="ltx_text" style="color:#0000FF;">66.2</span>)</td>
<td id="S4.T1.11.18.8" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">(17.5, 2.1)</td>
<td id="S4.T1.11.18.9" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">(<span id="S4.T1.11.18.9.1" class="ltx_text" style="color:#FF0000;">95.6</span>, <span id="S4.T1.11.18.9.2" class="ltx_text" style="color:#FF0000;">91.0</span>)</td>
</tr>
<tr id="S4.T1.11.19" class="ltx_tr">
<td id="S4.T1.11.19.1" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:5.0pt;padding-right:5.0pt;">DTD-Synthetic</td>
<td id="S4.T1.11.19.2" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:5.0pt;padding-right:5.0pt;">12</td>
<td id="S4.T1.11.19.3" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:5.0pt;padding-right:5.0pt;">(33.9, 12.5)</td>
<td id="S4.T1.11.19.4" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:5.0pt;padding-right:5.0pt;">(23.7, 5.5)</td>
<td id="S4.T1.11.19.5" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:5.0pt;padding-right:5.0pt;">(83.9, 57.8)</td>
<td id="S4.T1.11.19.6" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:5.0pt;padding-right:5.0pt;">(<span id="S4.T1.11.19.6.1" class="ltx_text" style="color:#0000FF;">95.3</span>, <span id="S4.T1.11.19.6.2" class="ltx_text" style="color:#0000FF;">86.9</span>)</td>
<td id="S4.T1.11.19.7" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:5.0pt;padding-right:5.0pt;">(-, -)</td>
<td id="S4.T1.11.19.8" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:5.0pt;padding-right:5.0pt;">(<span id="S4.T1.11.19.8.1" class="ltx_text" style="color:#FF0000;">97.9</span>, <span id="S4.T1.11.19.8.2" class="ltx_text" style="color:#FF0000;">92.3</span>)</td>
</tr>
</table>
</figure>
<figure id="S4.T2" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 2: </span>ZSAD performance comparison on medical domain. The best performance is highlighted in red, and the second-best is highlighted in blue. Note that the image-level medical AD datasets do not contain segmentation ground truth, so the pixel-level medical AD datasets are different from the image-level datasets.</figcaption>
<table id="S4.T2.1" class="ltx_tabular ltx_centering ltx_align_middle">
<tr id="S4.T2.1.1" class="ltx_tr">
<td id="S4.T2.1.1.2" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:5.0pt;padding-right:5.0pt;">Task</td>
<td id="S4.T2.1.1.3" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:5.0pt;padding-right:5.0pt;">Category</td>
<td id="S4.T2.1.1.4" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:5.0pt;padding-right:5.0pt;">Datasets</td>
<td id="S4.T2.1.1.1" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:5.0pt;padding-right:5.0pt;"><math id="S4.T2.1.1.1.m1.1" class="ltx_Math" alttext="|\mathcal{C}|" display="inline"><semantics id="S4.T2.1.1.1.m1.1a"><mrow id="S4.T2.1.1.1.m1.1.2.2" xref="S4.T2.1.1.1.m1.1.2.1.cmml"><mo stretchy="false" id="S4.T2.1.1.1.m1.1.2.2.1" xref="S4.T2.1.1.1.m1.1.2.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S4.T2.1.1.1.m1.1.1" xref="S4.T2.1.1.1.m1.1.1.cmml">𝒞</mi><mo stretchy="false" id="S4.T2.1.1.1.m1.1.2.2.2" xref="S4.T2.1.1.1.m1.1.2.1.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.1.1.1.m1.1b"><apply id="S4.T2.1.1.1.m1.1.2.1.cmml" xref="S4.T2.1.1.1.m1.1.2.2"><abs id="S4.T2.1.1.1.m1.1.2.1.1.cmml" xref="S4.T2.1.1.1.m1.1.2.2.1"></abs><ci id="S4.T2.1.1.1.m1.1.1.cmml" xref="S4.T2.1.1.1.m1.1.1">𝒞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.1.1.1.m1.1c">|\mathcal{C}|</annotation></semantics></math></td>
<td id="S4.T2.1.1.5" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:5.0pt;padding-right:5.0pt;">CLIP</td>
<td id="S4.T2.1.1.6" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:5.0pt;padding-right:5.0pt;">CLIP-AC</td>
<td id="S4.T2.1.1.7" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:5.0pt;padding-right:5.0pt;">WinCLIP</td>
<td id="S4.T2.1.1.8" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:5.0pt;padding-right:5.0pt;">VAND</td>
<td id="S4.T2.1.1.9" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:5.0pt;padding-right:5.0pt;">CoOp</td>
<td id="S4.T2.1.1.10" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:5.0pt;padding-right:5.0pt;">AnomalyCLIP</td>
</tr>
<tr id="S4.T2.1.2" class="ltx_tr">
<td id="S4.T2.1.2.1" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;" rowspan="4"><span id="S4.T2.1.2.1.1" class="ltx_text"><span id="S4.T2.1.2.1.1.1" class="ltx_text"></span> <span id="S4.T2.1.2.1.1.2" class="ltx_text">
<span id="S4.T2.1.2.1.1.2.1" class="ltx_tabular ltx_align_middle">
<span id="S4.T2.1.2.1.1.2.1.1" class="ltx_tr">
<span id="S4.T2.1.2.1.1.2.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">Image-level</span></span>
<span id="S4.T2.1.2.1.1.2.1.2" class="ltx_tr">
<span id="S4.T2.1.2.1.1.2.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">(AUROC, AP)</span></span>
</span></span> <span id="S4.T2.1.2.1.1.3" class="ltx_text"></span></span></td>
<td id="S4.T2.1.2.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;" rowspan="3"><span id="S4.T2.1.2.2.1" class="ltx_text">Brain</span></td>
<td id="S4.T2.1.2.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;">HeadCT</td>
<td id="S4.T2.1.2.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;">1</td>
<td id="S4.T2.1.2.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;">(56.5, 58.4)</td>
<td id="S4.T2.1.2.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;">(60.0, 60.7)</td>
<td id="S4.T2.1.2.7" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;">(81.8, 80.2)</td>
<td id="S4.T2.1.2.8" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;">(<span id="S4.T2.1.2.8.1" class="ltx_text" style="color:#0000FF;">89.1</span>, <span id="S4.T2.1.2.8.2" class="ltx_text" style="color:#0000FF;">89.4</span>)</td>
<td id="S4.T2.1.2.9" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;">(78.4, 78.8)</td>
<td id="S4.T2.1.2.10" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;">(<span id="S4.T2.1.2.10.1" class="ltx_text" style="color:#FF0000;">93.4</span>, <span id="S4.T2.1.2.10.2" class="ltx_text" style="color:#FF0000;">91.6</span>)</td>
</tr>
<tr id="S4.T2.1.3" class="ltx_tr">
<td id="S4.T2.1.3.1" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">BrainMRI</td>
<td id="S4.T2.1.3.2" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">1</td>
<td id="S4.T2.1.3.3" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">(73.9, 81.7)</td>
<td id="S4.T2.1.3.4" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">(80.6, 86.4)</td>
<td id="S4.T2.1.3.5" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">(86.6, <span id="S4.T2.1.3.5.1" class="ltx_text" style="color:#0000FF;">91.5</span>)</td>
<td id="S4.T2.1.3.6" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">(<span id="S4.T2.1.3.6.1" class="ltx_text" style="color:#0000FF;">89.3</span>, 90.9)</td>
<td id="S4.T2.1.3.7" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">(61.3, 44.9)</td>
<td id="S4.T2.1.3.8" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">(<span id="S4.T2.1.3.8.1" class="ltx_text" style="color:#FF0000;">90.3</span>, <span id="S4.T2.1.3.8.2" class="ltx_text" style="color:#FF0000;">92.2</span>)</td>
</tr>
<tr id="S4.T2.1.4" class="ltx_tr">
<td id="S4.T2.1.4.1" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">Br35H</td>
<td id="S4.T2.1.4.2" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">1</td>
<td id="S4.T2.1.4.3" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">(78.4, 78.8)</td>
<td id="S4.T2.1.4.4" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">(82.7, 81.3)</td>
<td id="S4.T2.1.4.5" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">(80.5, 82.2)</td>
<td id="S4.T2.1.4.6" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">(<span id="S4.T2.1.4.6.1" class="ltx_text" style="color:#0000FF;">93.1</span>, <span id="S4.T2.1.4.6.2" class="ltx_text" style="color:#0000FF;">92.9</span>)</td>
<td id="S4.T2.1.4.7" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">(86.0, 87.5)</td>
<td id="S4.T2.1.4.8" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">(<span id="S4.T2.1.4.8.1" class="ltx_text" style="color:#FF0000;">94.6</span>, <span id="S4.T2.1.4.8.2" class="ltx_text" style="color:#FF0000;">94.7</span>)</td>
</tr>
<tr id="S4.T2.1.5" class="ltx_tr">
<td id="S4.T2.1.5.1" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">Chest</td>
<td id="S4.T2.1.5.2" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">COVID-19</td>
<td id="S4.T2.1.5.3" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">1</td>
<td id="S4.T2.1.5.4" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">(73.7, 42.4)</td>
<td id="S4.T2.1.5.5" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">(<span id="S4.T2.1.5.5.1" class="ltx_text" style="color:#0000FF;">75.0</span>, <span id="S4.T2.1.5.5.2" class="ltx_text" style="color:#0000FF;">45.9</span>)</td>
<td id="S4.T2.1.5.6" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">(66.4, 42.9)</td>
<td id="S4.T2.1.5.7" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">(15.5, 8.5)</td>
<td id="S4.T2.1.5.8" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">(25.3, 9.2)</td>
<td id="S4.T2.1.5.9" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">(<span id="S4.T2.1.5.9.1" class="ltx_text" style="color:#FF0000;">80.1</span>, <span id="S4.T2.1.5.9.2" class="ltx_text" style="color:#FF0000;">58.7</span>)</td>
</tr>
<tr id="S4.T2.1.6" class="ltx_tr">
<td id="S4.T2.1.6.1" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;" rowspan="6"><span id="S4.T2.1.6.1.1" class="ltx_text"><span id="S4.T2.1.6.1.1.1" class="ltx_text"></span> <span id="S4.T2.1.6.1.1.2" class="ltx_text">
<span id="S4.T2.1.6.1.1.2.1" class="ltx_tabular ltx_align_middle">
<span id="S4.T2.1.6.1.1.2.1.1" class="ltx_tr">
<span id="S4.T2.1.6.1.1.2.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">Pixel-level</span></span>
<span id="S4.T2.1.6.1.1.2.1.2" class="ltx_tr">
<span id="S4.T2.1.6.1.1.2.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">(AUROC, PRO)</span></span>
</span></span> <span id="S4.T2.1.6.1.1.3" class="ltx_text"></span></span></td>
<td id="S4.T2.1.6.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;">Skin</td>
<td id="S4.T2.1.6.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;">ISIC</td>
<td id="S4.T2.1.6.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;">1</td>
<td id="S4.T2.1.6.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;">(33.1, 5.8)</td>
<td id="S4.T2.1.6.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;">(36.0, 7.7)</td>
<td id="S4.T2.1.6.7" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;">(83.3, 55.1)</td>
<td id="S4.T2.1.6.8" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;">(<span id="S4.T2.1.6.8.1" class="ltx_text" style="color:#0000FF;">89.4</span>, <span id="S4.T2.1.6.8.2" class="ltx_text" style="color:#0000FF;">77.2</span>)</td>
<td id="S4.T2.1.6.9" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;">(51.7, 15.9)</td>
<td id="S4.T2.1.6.10" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;">(<span id="S4.T2.1.6.10.1" class="ltx_text" style="color:#FF0000;">89.7</span>, <span id="S4.T2.1.6.10.2" class="ltx_text" style="color:#FF0000;">78.4</span>)</td>
</tr>
<tr id="S4.T2.1.7" class="ltx_tr">
<td id="S4.T2.1.7.1" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;" rowspan="4"><span id="S4.T2.1.7.1.1" class="ltx_text">Colon</span></td>
<td id="S4.T2.1.7.2" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">CVC-ColonDB</td>
<td id="S4.T2.1.7.3" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">1</td>
<td id="S4.T2.1.7.4" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">(49.5, 15.8)</td>
<td id="S4.T2.1.7.5" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">(49.5, 11.5)</td>
<td id="S4.T2.1.7.6" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">(70.3,32.5)</td>
<td id="S4.T2.1.7.7" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">(<span id="S4.T2.1.7.7.1" class="ltx_text" style="color:#0000FF;">78.4</span>, <span id="S4.T2.1.7.7.2" class="ltx_text" style="color:#0000FF;">64.6</span>)</td>
<td id="S4.T2.1.7.8" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">(40.5, 2.6)</td>
<td id="S4.T2.1.7.9" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">(<span id="S4.T2.1.7.9.1" class="ltx_text" style="color:#FF0000;">81.9</span>, <span id="S4.T2.1.7.9.2" class="ltx_text" style="color:#FF0000;">71.3</span>)</td>
</tr>
<tr id="S4.T2.1.8" class="ltx_tr">
<td id="S4.T2.1.8.1" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">CVC-ClinicDB</td>
<td id="S4.T2.1.8.2" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">1</td>
<td id="S4.T2.1.8.3" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">(47.5, 18.9)</td>
<td id="S4.T2.1.8.4" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">(48.5, 12.6)</td>
<td id="S4.T2.1.8.5" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">(51.2,13.8)</td>
<td id="S4.T2.1.8.6" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">(<span id="S4.T2.1.8.6.1" class="ltx_text" style="color:#0000FF;">80.5</span>, <span id="S4.T2.1.8.6.2" class="ltx_text" style="color:#0000FF;">60.7</span>)</td>
<td id="S4.T2.1.8.7" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">(34.8, 2.4)</td>
<td id="S4.T2.1.8.8" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">(<span id="S4.T2.1.8.8.1" class="ltx_text" style="color:#FF0000;">82.9</span>, <span id="S4.T2.1.8.8.2" class="ltx_text" style="color:#FF0000;">67.8</span>)</td>
</tr>
<tr id="S4.T2.1.9" class="ltx_tr">
<td id="S4.T2.1.9.1" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">Kvasir</td>
<td id="S4.T2.1.9.2" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">1</td>
<td id="S4.T2.1.9.3" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">(44.6, 17.7)</td>
<td id="S4.T2.1.9.4" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">(45.0, 16.8)</td>
<td id="S4.T2.1.9.5" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">(69.7, 24.5)</td>
<td id="S4.T2.1.9.6" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">(<span id="S4.T2.1.9.6.1" class="ltx_text" style="color:#0000FF;">75.0</span>, <span id="S4.T2.1.9.6.2" class="ltx_text" style="color:#0000FF;">36.2</span>)</td>
<td id="S4.T2.1.9.7" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">(44.1, 3.5)</td>
<td id="S4.T2.1.9.8" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">(<span id="S4.T2.1.9.8.1" class="ltx_text" style="color:#FF0000;">78.9</span>, <span id="S4.T2.1.9.8.2" class="ltx_text" style="color:#FF0000;">45.6</span>)</td>
</tr>
<tr id="S4.T2.1.10" class="ltx_tr">
<td id="S4.T2.1.10.1" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">Endo</td>
<td id="S4.T2.1.10.2" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">1</td>
<td id="S4.T2.1.10.3" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">(45.2, 15.9)</td>
<td id="S4.T2.1.10.4" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">(46.6, 12.6)</td>
<td id="S4.T2.1.10.5" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">(68.2, 28.3)</td>
<td id="S4.T2.1.10.6" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">(<span id="S4.T2.1.10.6.1" class="ltx_text" style="color:#0000FF;">81.9</span>, <span id="S4.T2.1.10.6.2" class="ltx_text" style="color:#0000FF;">54.9</span>)</td>
<td id="S4.T2.1.10.7" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">(40.6, 3.9)</td>
<td id="S4.T2.1.10.8" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">(<span id="S4.T2.1.10.8.1" class="ltx_text" style="color:#FF0000;">84.1</span>, <span id="S4.T2.1.10.8.2" class="ltx_text" style="color:#FF0000;">63.6</span>)</td>
</tr>
<tr id="S4.T2.1.11" class="ltx_tr">
<td id="S4.T2.1.11.1" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:5.0pt;padding-right:5.0pt;">Thyroid</td>
<td id="S4.T2.1.11.2" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:5.0pt;padding-right:5.0pt;">TN3K</td>
<td id="S4.T2.1.11.3" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:5.0pt;padding-right:5.0pt;">1</td>
<td id="S4.T2.1.11.4" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:5.0pt;padding-right:5.0pt;">(42.3, 7.3)</td>
<td id="S4.T2.1.11.5" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:5.0pt;padding-right:5.0pt;">(35.6, 5.2)</td>
<td id="S4.T2.1.11.6" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:5.0pt;padding-right:5.0pt;">(70.7, <span id="S4.T2.1.11.6.1" class="ltx_text" style="color:#0000FF;">39.8</span>)</td>
<td id="S4.T2.1.11.7" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:5.0pt;padding-right:5.0pt;">(<span id="S4.T2.1.11.7.1" class="ltx_text" style="color:#0000FF;">73.6</span>, 37.8)</td>
<td id="S4.T2.1.11.8" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:5.0pt;padding-right:5.0pt;">(34.0, 9.5)</td>
<td id="S4.T2.1.11.9" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:5.0pt;padding-right:5.0pt;">(<span id="S4.T2.1.11.9.1" class="ltx_text" style="color:#FF0000;">81.5</span>, <span id="S4.T2.1.11.9.2" class="ltx_text" style="color:#FF0000;">50.4</span>)</td>
</tr>
</table>
</figure>
</section>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Main results</h3>

<section id="S4.SS2.SSS0.Px1" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">ZSAD performance on diverse industrial inspection domains</h5>

<div id="S4.SS2.SSS0.Px1.p1" class="ltx_para ltx_noindent">
<p id="S4.SS2.SSS0.Px1.p1.1" class="ltx_p">Table <a href="#S4.T1" title="Table 1 ‣ Implementation details ‣ 4.1 Experiment setup ‣ 4 Experiments ‣ AnomalyCLIP: Object-agnostic Prompt Learning for Zero-shot Anomaly Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> shows the ZSAD results of AnomalyCLIP with five competing methods over seven industrial defect datasets of very different foreground objects, background, and/or anomaly types. AnomalyCLIP achieves superior ZSAD performance across the datasets, substantially outperforming the other five methods in most datasets. The weak performance of CLIP and CLIP-AC can be attributed to CLIP’s original pre-training, which focuses on aligning object semantics rather than anomaly semantics. By using manually defined text prompts, WinCLIP and VAND achieve better results. Alternatively, CoOp adopts learnable prompts to learn the global anomaly semantics. However, those prompts focus on the global feature and ignore the fine-grained local anomaly semantics, leading to their poor performance on anomaly segmentation. To adapt CLIP to ZSAD, AnomalyCLIP learns object-agnostic text prompts to focus on learning the generic abnormality/normality using global and local context optimization, enabling the modeling of both global and local abnormality/normality. Our resulting prompts can also generalize to different datasets from various domains. To provide more intuitive results, we visualize the anomaly segmentation results of AnomalyCLIP, VAND, and WinCLIP across different datasets in Fig. <a href="#S4.F4.1" title="Figure 4 ‣ Can we obtain better ZSAD performance if fine-tuned using medical image data? ‣ 4.2 Main results ‣ 4 Experiments ‣ AnomalyCLIP: Object-agnostic Prompt Learning for Zero-shot Anomaly Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>. Compared to VAND and WinCLIP, AnomalyCLIP can perform much more accurate segmentation for the defects from different industrial inspection domains.</p>
</div>
</section>
<section id="S4.SS2.SSS0.Px2" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Generalization from defect datasets to diverse medical domain datasets</h5>

<div id="S4.SS2.SSS0.Px2.p1" class="ltx_para ltx_noindent">
<p id="S4.SS2.SSS0.Px2.p1.1" class="ltx_p">To evaluate the generalization ability of our model, we further examine the ZSAD performance of AnomalyCLIP on 10 medical image datasets of different organs across different imaging devices. Table <a href="#S4.T2" title="Table 2 ‣ Implementation details ‣ 4.1 Experiment setup ‣ 4 Experiments ‣ AnomalyCLIP: Object-agnostic Prompt Learning for Zero-shot Anomaly Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> shows the results, where learning-based methods, including AnomalyCLIP, VAND and CoOp, are all tuned using MVTec AD data. It is remarkable that methods like AnomalyCLIP and VAND obtain promising ZSAD performance on various medical image datasets, even though they are tuned using a defect detection dataset. Among all these methods, AnomalyCLIP is the best performer due to its strong generalization brought by object-agnostic prompt learning. As illustrated in Fig. <a href="#S4.F4.1" title="Figure 4 ‣ Can we obtain better ZSAD performance if fine-tuned using medical image data? ‣ 4.2 Main results ‣ 4 Experiments ‣ AnomalyCLIP: Object-agnostic Prompt Learning for Zero-shot Anomaly Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>, AnomalyCLIP can accurately detect various types of anomalies in diverse medical images, such as skin cancer regions in photography images, colon polyps in endoscopy images, thyroid nodules in ultrasound images, and brain tumors in MRI images, having substantially better performance in locating the abnormal lesion/tumor regions than the other two methods WinCLIP and VAND. This again demonstrates the superior ZSAD performance of AnomalyCLIP in datasets of highly diverse object semantics from medical imaging domains.</p>
</div>
</section>
<section id="S4.SS2.SSS0.Px3" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Can we obtain better ZSAD performance if fine-tuned using medical image data?</h5>

<div id="S4.SS2.SSS0.Px3.p1" class="ltx_para ltx_noindent">
<p id="S4.SS2.SSS0.Px3.p1.1" class="ltx_p">Comparing the promising performance in industrial datasets, AnomalyCLIP presents a relatively low performance in medical datasets. This is partly due to the impact of auxiliary data used in our prompt learning. So, then we examine whether the ZSAD performance on medical images can be improved if the prompt learning is trained on an auxiliary medical dataset. One challenge is that there are no available large 2D medical datasets that include both image-level and pixel-level annotations for our training. To address this issue, we create such a dataset based on ColonDB (More details see Appendix <a href="#A1" title="Appendix A Implementation details and baselines ‣ AnomalyCLIP: Object-agnostic Prompt Learning for Zero-shot Anomaly Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">A</span></a>), and then optimize the prompts in AnomalyCLIP and VAND using this dataset and evaluate their performance on the medical image datasets.
The results are presented in Table <a href="#S4.F4.1" title="Figure 4 ‣ Can we obtain better ZSAD performance if fine-tuned using medical image data? ‣ 4.2 Main results ‣ 4 Experiments ‣ AnomalyCLIP: Object-agnostic Prompt Learning for Zero-shot Anomaly Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>. AnomalyCLIP and VAND largely improve their detection and segmentation performance compared to that fine-tuned on MVTec AD, especially for the colon polyp-related datasets such as CVC-ClincDB, Kvasir, and Endo (note that these datasets are all from different domains compared to the fine-tuning ColonDB dataset). AnomalyCLIP also exhibits performance improvement in detecting brain tumors in datasets such as HeadCT, BrainMRI, and Br35H. This is attributed to the visual similarities between colon polyps and brain tumors. Conversely, the symptom of the colon polyp differs significantly from that of diseased skin or chest, leading to performance degradation in ISIC and COVID-19. Overall, compared to VAND, AnomalyCLIP performs consistently better across all datasets of anomaly detection and segmentation.</p>
</div>
<figure id="S4.F4.1" class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_middle" style="width:218.6pt;"><img src="/html/2310.18961/assets/x13.png" id="S4.F4.1.g1" class="ltx_graphics ltx_img_landscape" width="423" height="220" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>Segmentation visualization.</figcaption>
<div id="S4.F4.1.2" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_middle" style="width:159.0pt;">
<span id="S4.F4.1.2.1" class="ltx_ERROR undefined">\captionof</span>
<p id="S4.F4.1.2.2" class="ltx_p ltx_align_center">tableZSAD performance on medical images when fine-tuned by medical image datasets.

<span id="S4.F4.1.2.2.1" class="ltx_tabular ltx_align_middle">
<span id="S4.F4.1.2.2.1.1" class="ltx_tr">
<span id="S4.F4.1.2.2.1.1.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_tt" style="padding-left:1.5pt;padding-right:1.5pt;">Category</span>
<span id="S4.F4.1.2.2.1.1.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_tt" style="padding-left:1.5pt;padding-right:1.5pt;">Datasets</span>
<span id="S4.F4.1.2.2.1.1.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_tt" style="padding-left:1.5pt;padding-right:1.5pt;">VAND</span>
<span id="S4.F4.1.2.2.1.1.4" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_tt" style="padding-left:1.5pt;padding-right:1.5pt;">AnomalyCLIP</span></span>
<span id="S4.F4.1.2.2.1.2" class="ltx_tr">
<span id="S4.F4.1.2.2.1.2.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:1.5pt;padding-right:1.5pt;">Classification</span>
<span id="S4.F4.1.2.2.1.2.2" class="ltx_td ltx_border_t" style="padding-left:1.5pt;padding-right:1.5pt;"></span>
<span id="S4.F4.1.2.2.1.2.3" class="ltx_td ltx_border_t" style="padding-left:1.5pt;padding-right:1.5pt;"></span>
<span id="S4.F4.1.2.2.1.2.4" class="ltx_td ltx_border_t" style="padding-left:1.5pt;padding-right:1.5pt;"></span></span>
<span id="S4.F4.1.2.2.1.3" class="ltx_tr">
<span id="S4.F4.1.2.2.1.3.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t ltx_rowspan ltx_rowspan_3" style="padding-left:1.5pt;padding-right:1.5pt;"><span id="S4.F4.1.2.2.1.3.1.1" class="ltx_text">Brain</span></span>
<span id="S4.F4.1.2.2.1.3.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:1.5pt;padding-right:1.5pt;">HeadCT</span>
<span id="S4.F4.1.2.2.1.3.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:1.5pt;padding-right:1.5pt;">(89.1, 89.4)</span>
<span id="S4.F4.1.2.2.1.3.4" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:1.5pt;padding-right:1.5pt;">(<span id="S4.F4.1.2.2.1.3.4.1" class="ltx_text" style="color:#FF0000;">93.5</span>, <span id="S4.F4.1.2.2.1.3.4.2" class="ltx_text" style="color:#FF0000;">95.1</span>)</span></span>
<span id="S4.F4.1.2.2.1.4" class="ltx_tr">
<span id="S4.F4.1.2.2.1.4.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.5pt;padding-right:1.5pt;">BrainMRI</span>
<span id="S4.F4.1.2.2.1.4.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.5pt;padding-right:1.5pt;">(89.3, 90.9)</span>
<span id="S4.F4.1.2.2.1.4.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.5pt;padding-right:1.5pt;">(<span id="S4.F4.1.2.2.1.4.3.1" class="ltx_text" style="color:#FF0000;">95.5</span>, <span id="S4.F4.1.2.2.1.4.3.2" class="ltx_text" style="color:#FF0000;">97.2</span>)</span></span>
<span id="S4.F4.1.2.2.1.5" class="ltx_tr">
<span id="S4.F4.1.2.2.1.5.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.5pt;padding-right:1.5pt;">Br35H</span>
<span id="S4.F4.1.2.2.1.5.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.5pt;padding-right:1.5pt;">(93.1, 92.9)</span>
<span id="S4.F4.1.2.2.1.5.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.5pt;padding-right:1.5pt;">(<span id="S4.F4.1.2.2.1.5.3.1" class="ltx_text" style="color:#FF0000;">97.9</span>, <span id="S4.F4.1.2.2.1.5.3.2" class="ltx_text" style="color:#FF0000;">98.0</span>)</span></span>
<span id="S4.F4.1.2.2.1.6" class="ltx_tr">
<span id="S4.F4.1.2.2.1.6.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.5pt;padding-right:1.5pt;">Chest</span>
<span id="S4.F4.1.2.2.1.6.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.5pt;padding-right:1.5pt;">COVID-19</span>
<span id="S4.F4.1.2.2.1.6.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.5pt;padding-right:1.5pt;">(15.5, 8.5)</span>
<span id="S4.F4.1.2.2.1.6.4" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.5pt;padding-right:1.5pt;">(<span id="S4.F4.1.2.2.1.6.4.1" class="ltx_text" style="color:#FF0000;">70.9</span>, <span id="S4.F4.1.2.2.1.6.4.2" class="ltx_text" style="color:#FF0000;">33.7</span>)</span></span>
<span id="S4.F4.1.2.2.1.7" class="ltx_tr">
<span id="S4.F4.1.2.2.1.7.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:1.5pt;padding-right:1.5pt;">Segmentation</span>
<span id="S4.F4.1.2.2.1.7.2" class="ltx_td ltx_border_t" style="padding-left:1.5pt;padding-right:1.5pt;"></span>
<span id="S4.F4.1.2.2.1.7.3" class="ltx_td ltx_border_t" style="padding-left:1.5pt;padding-right:1.5pt;"></span>
<span id="S4.F4.1.2.2.1.7.4" class="ltx_td ltx_border_t" style="padding-left:1.5pt;padding-right:1.5pt;"></span></span>
<span id="S4.F4.1.2.2.1.8" class="ltx_tr">
<span id="S4.F4.1.2.2.1.8.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:1.5pt;padding-right:1.5pt;">Skin</span>
<span id="S4.F4.1.2.2.1.8.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:1.5pt;padding-right:1.5pt;">ISIC</span>
<span id="S4.F4.1.2.2.1.8.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:1.5pt;padding-right:1.5pt;">(58.8, 31.2)</span>
<span id="S4.F4.1.2.2.1.8.4" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:1.5pt;padding-right:1.5pt;">(<span id="S4.F4.1.2.2.1.8.4.1" class="ltx_text" style="color:#FF0000;">83.0</span>, <span id="S4.F4.1.2.2.1.8.4.2" class="ltx_text" style="color:#FF0000;">63.8</span>)</span></span>
<span id="S4.F4.1.2.2.1.9" class="ltx_tr">
<span id="S4.F4.1.2.2.1.9.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_rowspan ltx_rowspan_3" style="padding-left:1.5pt;padding-right:1.5pt;"><span id="S4.F4.1.2.2.1.9.1.1" class="ltx_text">Colon</span></span>
<span id="S4.F4.1.2.2.1.9.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.5pt;padding-right:1.5pt;">CVC-ClinicDB</span>
<span id="S4.F4.1.2.2.1.9.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.5pt;padding-right:1.5pt;">(89.4, 82.3)</span>
<span id="S4.F4.1.2.2.1.9.4" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.5pt;padding-right:1.5pt;">(<span id="S4.F4.1.2.2.1.9.4.1" class="ltx_text" style="color:#FF0000;">92.4</span>, <span id="S4.F4.1.2.2.1.9.4.2" class="ltx_text" style="color:#FF0000;">82.9</span>)</span></span>
<span id="S4.F4.1.2.2.1.10" class="ltx_tr">
<span id="S4.F4.1.2.2.1.10.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.5pt;padding-right:1.5pt;">Kvasir</span>
<span id="S4.F4.1.2.2.1.10.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.5pt;padding-right:1.5pt;">(87.6, 39.3)</span>
<span id="S4.F4.1.2.2.1.10.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.5pt;padding-right:1.5pt;">(<span id="S4.F4.1.2.2.1.10.3.1" class="ltx_text" style="color:#FF0000;">92.5</span>, <span id="S4.F4.1.2.2.1.10.3.2" class="ltx_text" style="color:#FF0000;">61.5</span>)</span></span>
<span id="S4.F4.1.2.2.1.11" class="ltx_tr">
<span id="S4.F4.1.2.2.1.11.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.5pt;padding-right:1.5pt;">Endo</span>
<span id="S4.F4.1.2.2.1.11.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.5pt;padding-right:1.5pt;">(88.5, 81.9)</span>
<span id="S4.F4.1.2.2.1.11.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.5pt;padding-right:1.5pt;">(<span id="S4.F4.1.2.2.1.11.3.1" class="ltx_text" style="color:#FF0000;">93.2</span>, <span id="S4.F4.1.2.2.1.11.3.2" class="ltx_text" style="color:#FF0000;">84.8</span>)</span></span>
<span id="S4.F4.1.2.2.1.12" class="ltx_tr">
<span id="S4.F4.1.2.2.1.12.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_b" style="padding-left:1.5pt;padding-right:1.5pt;">Thyroid</span>
<span id="S4.F4.1.2.2.1.12.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_b" style="padding-left:1.5pt;padding-right:1.5pt;">TN3K</span>
<span id="S4.F4.1.2.2.1.12.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_b" style="padding-left:1.5pt;padding-right:1.5pt;">(60.5, 16.8)</span>
<span id="S4.F4.1.2.2.1.12.4" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_b" style="padding-left:1.5pt;padding-right:1.5pt;">(<span id="S4.F4.1.2.2.1.12.4.1" class="ltx_text" style="color:#FF0000;">79.2</span>, <span id="S4.F4.1.2.2.1.12.4.2" class="ltx_text" style="color:#FF0000;">47.0</span>)</span></span>
</span></p>
</div>
</figure>
<figure id="S4.F5" class="ltx_figure ltx_align_floatright"><img src="/html/2310.18961/assets/x14.png" id="S4.F5.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="253" height="123" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>Performance gain of using object-agnostic prompts compared to object-aware prompts.</figcaption>
</figure>
</section>
<section id="S4.SS2.SSS0.Px4" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Object-agnostic vs. object-aware prompt learning</h5>

<div id="S4.SS2.SSS0.Px4.p1" class="ltx_para ltx_noindent">
<p id="S4.SS2.SSS0.Px4.p1.1" class="ltx_p">To study the effectiveness of object-agnostic prompt learning in AnomalyCLIP, we compare AnomalyCLIP with its variant that uses an object-aware prompt template. The performance gain of AnomalyCLIP to its object-aware prompt learning variant is shown in Fig. <a href="#S4.F5" title="Figure 5 ‣ Can we obtain better ZSAD performance if fine-tuned using medical image data? ‣ 4.2 Main results ‣ 4 Experiments ‣ AnomalyCLIP: Object-agnostic Prompt Learning for Zero-shot Anomaly Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>, where positive values indicate our object-agnostic prompt templates are better than the object-aware one. It is clear that our object-agnostic prompt learning performs much better than, or on par with, the object-aware version in both image-level and pixel-level anomaly detection. This indicates that having object-agnostic prompts helps better learn the generic abnormality and normality in images, as the object semantics are often not helpful, or can even become noisy features, for the ZSAD task.</p>
</div>
</section>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Ablation study</h3>

<section id="S4.SS3.SSS0.Px1" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Module ablation</h5>

<div id="S4.SS3.SSS0.Px1.p1" class="ltx_para ltx_noindent">
<p id="S4.SS3.SSS0.Px1.p1.8" class="ltx_p">We first validate the effectiveness of different high-level modules of our AnomalyCLIP, including DPAM (<math id="S4.SS3.SSS0.Px1.p1.1.m1.1" class="ltx_Math" alttext="T_{1}" display="inline"><semantics id="S4.SS3.SSS0.Px1.p1.1.m1.1a"><msub id="S4.SS3.SSS0.Px1.p1.1.m1.1.1" xref="S4.SS3.SSS0.Px1.p1.1.m1.1.1.cmml"><mi id="S4.SS3.SSS0.Px1.p1.1.m1.1.1.2" xref="S4.SS3.SSS0.Px1.p1.1.m1.1.1.2.cmml">T</mi><mn id="S4.SS3.SSS0.Px1.p1.1.m1.1.1.3" xref="S4.SS3.SSS0.Px1.p1.1.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px1.p1.1.m1.1b"><apply id="S4.SS3.SSS0.Px1.p1.1.m1.1.1.cmml" xref="S4.SS3.SSS0.Px1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS0.Px1.p1.1.m1.1.1.1.cmml" xref="S4.SS3.SSS0.Px1.p1.1.m1.1.1">subscript</csymbol><ci id="S4.SS3.SSS0.Px1.p1.1.m1.1.1.2.cmml" xref="S4.SS3.SSS0.Px1.p1.1.m1.1.1.2">𝑇</ci><cn type="integer" id="S4.SS3.SSS0.Px1.p1.1.m1.1.1.3.cmml" xref="S4.SS3.SSS0.Px1.p1.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px1.p1.1.m1.1c">T_{1}</annotation></semantics></math>), object-agnostic text prompts (<math id="S4.SS3.SSS0.Px1.p1.2.m2.1" class="ltx_Math" alttext="T_{2}" display="inline"><semantics id="S4.SS3.SSS0.Px1.p1.2.m2.1a"><msub id="S4.SS3.SSS0.Px1.p1.2.m2.1.1" xref="S4.SS3.SSS0.Px1.p1.2.m2.1.1.cmml"><mi id="S4.SS3.SSS0.Px1.p1.2.m2.1.1.2" xref="S4.SS3.SSS0.Px1.p1.2.m2.1.1.2.cmml">T</mi><mn id="S4.SS3.SSS0.Px1.p1.2.m2.1.1.3" xref="S4.SS3.SSS0.Px1.p1.2.m2.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px1.p1.2.m2.1b"><apply id="S4.SS3.SSS0.Px1.p1.2.m2.1.1.cmml" xref="S4.SS3.SSS0.Px1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS0.Px1.p1.2.m2.1.1.1.cmml" xref="S4.SS3.SSS0.Px1.p1.2.m2.1.1">subscript</csymbol><ci id="S4.SS3.SSS0.Px1.p1.2.m2.1.1.2.cmml" xref="S4.SS3.SSS0.Px1.p1.2.m2.1.1.2">𝑇</ci><cn type="integer" id="S4.SS3.SSS0.Px1.p1.2.m2.1.1.3.cmml" xref="S4.SS3.SSS0.Px1.p1.2.m2.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px1.p1.2.m2.1c">T_{2}</annotation></semantics></math>), added learnable tokens in text encoders (<math id="S4.SS3.SSS0.Px1.p1.3.m3.1" class="ltx_Math" alttext="T_{3}" display="inline"><semantics id="S4.SS3.SSS0.Px1.p1.3.m3.1a"><msub id="S4.SS3.SSS0.Px1.p1.3.m3.1.1" xref="S4.SS3.SSS0.Px1.p1.3.m3.1.1.cmml"><mi id="S4.SS3.SSS0.Px1.p1.3.m3.1.1.2" xref="S4.SS3.SSS0.Px1.p1.3.m3.1.1.2.cmml">T</mi><mn id="S4.SS3.SSS0.Px1.p1.3.m3.1.1.3" xref="S4.SS3.SSS0.Px1.p1.3.m3.1.1.3.cmml">3</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px1.p1.3.m3.1b"><apply id="S4.SS3.SSS0.Px1.p1.3.m3.1.1.cmml" xref="S4.SS3.SSS0.Px1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS0.Px1.p1.3.m3.1.1.1.cmml" xref="S4.SS3.SSS0.Px1.p1.3.m3.1.1">subscript</csymbol><ci id="S4.SS3.SSS0.Px1.p1.3.m3.1.1.2.cmml" xref="S4.SS3.SSS0.Px1.p1.3.m3.1.1.2">𝑇</ci><cn type="integer" id="S4.SS3.SSS0.Px1.p1.3.m3.1.1.3.cmml" xref="S4.SS3.SSS0.Px1.p1.3.m3.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px1.p1.3.m3.1c">T_{3}</annotation></semantics></math>), and multi-layer visual encoder features (<math id="S4.SS3.SSS0.Px1.p1.4.m4.1" class="ltx_Math" alttext="T_{4}" display="inline"><semantics id="S4.SS3.SSS0.Px1.p1.4.m4.1a"><msub id="S4.SS3.SSS0.Px1.p1.4.m4.1.1" xref="S4.SS3.SSS0.Px1.p1.4.m4.1.1.cmml"><mi id="S4.SS3.SSS0.Px1.p1.4.m4.1.1.2" xref="S4.SS3.SSS0.Px1.p1.4.m4.1.1.2.cmml">T</mi><mn id="S4.SS3.SSS0.Px1.p1.4.m4.1.1.3" xref="S4.SS3.SSS0.Px1.p1.4.m4.1.1.3.cmml">4</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px1.p1.4.m4.1b"><apply id="S4.SS3.SSS0.Px1.p1.4.m4.1.1.cmml" xref="S4.SS3.SSS0.Px1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS0.Px1.p1.4.m4.1.1.1.cmml" xref="S4.SS3.SSS0.Px1.p1.4.m4.1.1">subscript</csymbol><ci id="S4.SS3.SSS0.Px1.p1.4.m4.1.1.2.cmml" xref="S4.SS3.SSS0.Px1.p1.4.m4.1.1.2">𝑇</ci><cn type="integer" id="S4.SS3.SSS0.Px1.p1.4.m4.1.1.3.cmml" xref="S4.SS3.SSS0.Px1.p1.4.m4.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px1.p1.4.m4.1c">T_{4}</annotation></semantics></math>). As shown in Table <a href="#S4.SS3.SSS0.Px1" title="Module ablation ‣ 4.3 Ablation study ‣ 4 Experiments ‣ AnomalyCLIP: Object-agnostic Prompt Learning for Zero-shot Anomaly Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.3</span></a>, each module contributes to the remarkable performance of AnomalyCLIP. DPAM improves the segmentation performance by enhancing local visual semantics (<math id="S4.SS3.SSS0.Px1.p1.5.m5.1" class="ltx_Math" alttext="T_{1}" display="inline"><semantics id="S4.SS3.SSS0.Px1.p1.5.m5.1a"><msub id="S4.SS3.SSS0.Px1.p1.5.m5.1.1" xref="S4.SS3.SSS0.Px1.p1.5.m5.1.1.cmml"><mi id="S4.SS3.SSS0.Px1.p1.5.m5.1.1.2" xref="S4.SS3.SSS0.Px1.p1.5.m5.1.1.2.cmml">T</mi><mn id="S4.SS3.SSS0.Px1.p1.5.m5.1.1.3" xref="S4.SS3.SSS0.Px1.p1.5.m5.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px1.p1.5.m5.1b"><apply id="S4.SS3.SSS0.Px1.p1.5.m5.1.1.cmml" xref="S4.SS3.SSS0.Px1.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS0.Px1.p1.5.m5.1.1.1.cmml" xref="S4.SS3.SSS0.Px1.p1.5.m5.1.1">subscript</csymbol><ci id="S4.SS3.SSS0.Px1.p1.5.m5.1.1.2.cmml" xref="S4.SS3.SSS0.Px1.p1.5.m5.1.1.2">𝑇</ci><cn type="integer" id="S4.SS3.SSS0.Px1.p1.5.m5.1.1.3.cmml" xref="S4.SS3.SSS0.Px1.p1.5.m5.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px1.p1.5.m5.1c">T_{1}</annotation></semantics></math>). Object-agnostic text prompts focus on the abnormality/normality within images instead of the object semantics, allowing AnomalyCLIP to detect anomalies in diverse unseen objects. Therefore, introducing object-agnostic text prompts (<math id="S4.SS3.SSS0.Px1.p1.6.m6.1" class="ltx_Math" alttext="T_{2}" display="inline"><semantics id="S4.SS3.SSS0.Px1.p1.6.m6.1a"><msub id="S4.SS3.SSS0.Px1.p1.6.m6.1.1" xref="S4.SS3.SSS0.Px1.p1.6.m6.1.1.cmml"><mi id="S4.SS3.SSS0.Px1.p1.6.m6.1.1.2" xref="S4.SS3.SSS0.Px1.p1.6.m6.1.1.2.cmml">T</mi><mn id="S4.SS3.SSS0.Px1.p1.6.m6.1.1.3" xref="S4.SS3.SSS0.Px1.p1.6.m6.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px1.p1.6.m6.1b"><apply id="S4.SS3.SSS0.Px1.p1.6.m6.1.1.cmml" xref="S4.SS3.SSS0.Px1.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS0.Px1.p1.6.m6.1.1.1.cmml" xref="S4.SS3.SSS0.Px1.p1.6.m6.1.1">subscript</csymbol><ci id="S4.SS3.SSS0.Px1.p1.6.m6.1.1.2.cmml" xref="S4.SS3.SSS0.Px1.p1.6.m6.1.1.2">𝑇</ci><cn type="integer" id="S4.SS3.SSS0.Px1.p1.6.m6.1.1.3.cmml" xref="S4.SS3.SSS0.Px1.p1.6.m6.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px1.p1.6.m6.1c">T_{2}</annotation></semantics></math>) significantly improves AnomalyCLIP. Furthermore, text prompt tuning (<math id="S4.SS3.SSS0.Px1.p1.7.m7.1" class="ltx_Math" alttext="T_{3}" display="inline"><semantics id="S4.SS3.SSS0.Px1.p1.7.m7.1a"><msub id="S4.SS3.SSS0.Px1.p1.7.m7.1.1" xref="S4.SS3.SSS0.Px1.p1.7.m7.1.1.cmml"><mi id="S4.SS3.SSS0.Px1.p1.7.m7.1.1.2" xref="S4.SS3.SSS0.Px1.p1.7.m7.1.1.2.cmml">T</mi><mn id="S4.SS3.SSS0.Px1.p1.7.m7.1.1.3" xref="S4.SS3.SSS0.Px1.p1.7.m7.1.1.3.cmml">3</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px1.p1.7.m7.1b"><apply id="S4.SS3.SSS0.Px1.p1.7.m7.1.1.cmml" xref="S4.SS3.SSS0.Px1.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS0.Px1.p1.7.m7.1.1.1.cmml" xref="S4.SS3.SSS0.Px1.p1.7.m7.1.1">subscript</csymbol><ci id="S4.SS3.SSS0.Px1.p1.7.m7.1.1.2.cmml" xref="S4.SS3.SSS0.Px1.p1.7.m7.1.1.2">𝑇</ci><cn type="integer" id="S4.SS3.SSS0.Px1.p1.7.m7.1.1.3.cmml" xref="S4.SS3.SSS0.Px1.p1.7.m7.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px1.p1.7.m7.1c">T_{3}</annotation></semantics></math>) also brings performance improvement via the refinement of original textual space. Finally, <math id="S4.SS3.SSS0.Px1.p1.8.m8.1" class="ltx_Math" alttext="T_{4}" display="inline"><semantics id="S4.SS3.SSS0.Px1.p1.8.m8.1a"><msub id="S4.SS3.SSS0.Px1.p1.8.m8.1.1" xref="S4.SS3.SSS0.Px1.p1.8.m8.1.1.cmml"><mi id="S4.SS3.SSS0.Px1.p1.8.m8.1.1.2" xref="S4.SS3.SSS0.Px1.p1.8.m8.1.1.2.cmml">T</mi><mn id="S4.SS3.SSS0.Px1.p1.8.m8.1.1.3" xref="S4.SS3.SSS0.Px1.p1.8.m8.1.1.3.cmml">4</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px1.p1.8.m8.1b"><apply id="S4.SS3.SSS0.Px1.p1.8.m8.1.1.cmml" xref="S4.SS3.SSS0.Px1.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS0.Px1.p1.8.m8.1.1.1.cmml" xref="S4.SS3.SSS0.Px1.p1.8.m8.1.1">subscript</csymbol><ci id="S4.SS3.SSS0.Px1.p1.8.m8.1.1.2.cmml" xref="S4.SS3.SSS0.Px1.p1.8.m8.1.1.2">𝑇</ci><cn type="integer" id="S4.SS3.SSS0.Px1.p1.8.m8.1.1.3.cmml" xref="S4.SS3.SSS0.Px1.p1.8.m8.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px1.p1.8.m8.1c">T_{4}</annotation></semantics></math> integrates multi-layer visual semantics to provide more visual details, which further promotes the performance of ZSAD.</p>
</div>
<figure id="S4.SS3.SSS0.Px1.4" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<div id="S4.SS3.SSS0.Px1.4.4" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_middle" style="width:190.8pt;">
<span id="S4.SS3.SSS0.Px1.4.4.5" class="ltx_ERROR undefined">\captionof</span>
<p id="S4.SS3.SSS0.Px1.4.4.4" class="ltx_p ltx_align_center">tableModule ablation.




<span id="S4.SS3.SSS0.Px1.4.4.4.4" class="ltx_tabular ltx_align_middle">
<span id="S4.SS3.SSS0.Px1.4.4.4.4.5" class="ltx_tr">
<span id="S4.SS3.SSS0.Px1.4.4.4.4.5.1" class="ltx_td ltx_align_center ltx_border_tt ltx_rowspan ltx_rowspan_2" style="padding-left:3.0pt;padding-right:3.0pt;"><span id="S4.SS3.SSS0.Px1.4.4.4.4.5.1.1" class="ltx_text">Module</span></span>
<span id="S4.SS3.SSS0.Px1.4.4.4.4.5.2" class="ltx_td ltx_align_center ltx_border_tt ltx_colspan ltx_colspan_2" style="padding-left:3.0pt;padding-right:3.0pt;">MVTec AD</span>
<span id="S4.SS3.SSS0.Px1.4.4.4.4.5.3" class="ltx_td ltx_align_center ltx_border_tt ltx_colspan ltx_colspan_2" style="padding-left:3.0pt;padding-right:3.0pt;">VisA</span></span>
<span id="S4.SS3.SSS0.Px1.4.4.4.4.6" class="ltx_tr">
<span id="S4.SS3.SSS0.Px1.4.4.4.4.6.1" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;">Pixel-level</span>
<span id="S4.SS3.SSS0.Px1.4.4.4.4.6.2" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;">Image-level</span>
<span id="S4.SS3.SSS0.Px1.4.4.4.4.6.3" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;">Pixel-level</span>
<span id="S4.SS3.SSS0.Px1.4.4.4.4.6.4" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;">Image-level</span></span>
<span id="S4.SS3.SSS0.Px1.4.4.4.4.7" class="ltx_tr">
<span id="S4.SS3.SSS0.Px1.4.4.4.4.7.1" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;">Base</span>
<span id="S4.SS3.SSS0.Px1.4.4.4.4.7.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;">(46.8, 15.4)</span>
<span id="S4.SS3.SSS0.Px1.4.4.4.4.7.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;">(66.3, 83.3)</span>
<span id="S4.SS3.SSS0.Px1.4.4.4.4.7.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;">(47.9, 17.1)</span>
<span id="S4.SS3.SSS0.Px1.4.4.4.4.7.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;">(54.4, 61.7)</span></span>
<span id="S4.SS3.SSS0.Px1.1.1.1.1.1" class="ltx_tr">
<span id="S4.SS3.SSS0.Px1.1.1.1.1.1.1" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;"><math id="S4.SS3.SSS0.Px1.1.1.1.1.1.1.m1.1" class="ltx_Math" alttext="+T_{1}" display="inline"><semantics id="S4.SS3.SSS0.Px1.1.1.1.1.1.1.m1.1a"><mrow id="S4.SS3.SSS0.Px1.1.1.1.1.1.1.m1.1.1" xref="S4.SS3.SSS0.Px1.1.1.1.1.1.1.m1.1.1.cmml"><mo id="S4.SS3.SSS0.Px1.1.1.1.1.1.1.m1.1.1a" xref="S4.SS3.SSS0.Px1.1.1.1.1.1.1.m1.1.1.cmml">+</mo><msub id="S4.SS3.SSS0.Px1.1.1.1.1.1.1.m1.1.1.2" xref="S4.SS3.SSS0.Px1.1.1.1.1.1.1.m1.1.1.2.cmml"><mi id="S4.SS3.SSS0.Px1.1.1.1.1.1.1.m1.1.1.2.2" xref="S4.SS3.SSS0.Px1.1.1.1.1.1.1.m1.1.1.2.2.cmml">T</mi><mn id="S4.SS3.SSS0.Px1.1.1.1.1.1.1.m1.1.1.2.3" xref="S4.SS3.SSS0.Px1.1.1.1.1.1.1.m1.1.1.2.3.cmml">1</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px1.1.1.1.1.1.1.m1.1b"><apply id="S4.SS3.SSS0.Px1.1.1.1.1.1.1.m1.1.1.cmml" xref="S4.SS3.SSS0.Px1.1.1.1.1.1.1.m1.1.1"><plus id="S4.SS3.SSS0.Px1.1.1.1.1.1.1.m1.1.1.1.cmml" xref="S4.SS3.SSS0.Px1.1.1.1.1.1.1.m1.1.1"></plus><apply id="S4.SS3.SSS0.Px1.1.1.1.1.1.1.m1.1.1.2.cmml" xref="S4.SS3.SSS0.Px1.1.1.1.1.1.1.m1.1.1.2"><csymbol cd="ambiguous" id="S4.SS3.SSS0.Px1.1.1.1.1.1.1.m1.1.1.2.1.cmml" xref="S4.SS3.SSS0.Px1.1.1.1.1.1.1.m1.1.1.2">subscript</csymbol><ci id="S4.SS3.SSS0.Px1.1.1.1.1.1.1.m1.1.1.2.2.cmml" xref="S4.SS3.SSS0.Px1.1.1.1.1.1.1.m1.1.1.2.2">𝑇</ci><cn type="integer" id="S4.SS3.SSS0.Px1.1.1.1.1.1.1.m1.1.1.2.3.cmml" xref="S4.SS3.SSS0.Px1.1.1.1.1.1.1.m1.1.1.2.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px1.1.1.1.1.1.1.m1.1c">+T_{1}</annotation></semantics></math></span>
<span id="S4.SS3.SSS0.Px1.1.1.1.1.1.2" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;">(68.4, 47.4)</span>
<span id="S4.SS3.SSS0.Px1.1.1.1.1.1.3" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;">(66.3, 83.3)</span>
<span id="S4.SS3.SSS0.Px1.1.1.1.1.1.4" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;">(54.8, 32.7)</span>
<span id="S4.SS3.SSS0.Px1.1.1.1.1.1.5" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;">(54.4, 61.7)</span></span>
<span id="S4.SS3.SSS0.Px1.2.2.2.2.2" class="ltx_tr">
<span id="S4.SS3.SSS0.Px1.2.2.2.2.2.1" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;"><math id="S4.SS3.SSS0.Px1.2.2.2.2.2.1.m1.1" class="ltx_Math" alttext="+T_{2}" display="inline"><semantics id="S4.SS3.SSS0.Px1.2.2.2.2.2.1.m1.1a"><mrow id="S4.SS3.SSS0.Px1.2.2.2.2.2.1.m1.1.1" xref="S4.SS3.SSS0.Px1.2.2.2.2.2.1.m1.1.1.cmml"><mo id="S4.SS3.SSS0.Px1.2.2.2.2.2.1.m1.1.1a" xref="S4.SS3.SSS0.Px1.2.2.2.2.2.1.m1.1.1.cmml">+</mo><msub id="S4.SS3.SSS0.Px1.2.2.2.2.2.1.m1.1.1.2" xref="S4.SS3.SSS0.Px1.2.2.2.2.2.1.m1.1.1.2.cmml"><mi id="S4.SS3.SSS0.Px1.2.2.2.2.2.1.m1.1.1.2.2" xref="S4.SS3.SSS0.Px1.2.2.2.2.2.1.m1.1.1.2.2.cmml">T</mi><mn id="S4.SS3.SSS0.Px1.2.2.2.2.2.1.m1.1.1.2.3" xref="S4.SS3.SSS0.Px1.2.2.2.2.2.1.m1.1.1.2.3.cmml">2</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px1.2.2.2.2.2.1.m1.1b"><apply id="S4.SS3.SSS0.Px1.2.2.2.2.2.1.m1.1.1.cmml" xref="S4.SS3.SSS0.Px1.2.2.2.2.2.1.m1.1.1"><plus id="S4.SS3.SSS0.Px1.2.2.2.2.2.1.m1.1.1.1.cmml" xref="S4.SS3.SSS0.Px1.2.2.2.2.2.1.m1.1.1"></plus><apply id="S4.SS3.SSS0.Px1.2.2.2.2.2.1.m1.1.1.2.cmml" xref="S4.SS3.SSS0.Px1.2.2.2.2.2.1.m1.1.1.2"><csymbol cd="ambiguous" id="S4.SS3.SSS0.Px1.2.2.2.2.2.1.m1.1.1.2.1.cmml" xref="S4.SS3.SSS0.Px1.2.2.2.2.2.1.m1.1.1.2">subscript</csymbol><ci id="S4.SS3.SSS0.Px1.2.2.2.2.2.1.m1.1.1.2.2.cmml" xref="S4.SS3.SSS0.Px1.2.2.2.2.2.1.m1.1.1.2.2">𝑇</ci><cn type="integer" id="S4.SS3.SSS0.Px1.2.2.2.2.2.1.m1.1.1.2.3.cmml" xref="S4.SS3.SSS0.Px1.2.2.2.2.2.1.m1.1.1.2.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px1.2.2.2.2.2.1.m1.1c">+T_{2}</annotation></semantics></math></span>
<span id="S4.SS3.SSS0.Px1.2.2.2.2.2.2" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;">(89.5, <span id="S4.SS3.SSS0.Px1.2.2.2.2.2.2.1" class="ltx_text" style="color:#0000FF;">81.2</span>)</span>
<span id="S4.SS3.SSS0.Px1.2.2.2.2.2.3" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;">(90.8, 96.0)</span>
<span id="S4.SS3.SSS0.Px1.2.2.2.2.2.4" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;">(95.0, 85.3)</span>
<span id="S4.SS3.SSS0.Px1.2.2.2.2.2.5" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;">(81.7, <span id="S4.SS3.SSS0.Px1.2.2.2.2.2.5.1" class="ltx_text" style="color:#0000FF;">85.2</span>)</span></span>
<span id="S4.SS3.SSS0.Px1.3.3.3.3.3" class="ltx_tr">
<span id="S4.SS3.SSS0.Px1.3.3.3.3.3.1" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;"><math id="S4.SS3.SSS0.Px1.3.3.3.3.3.1.m1.1" class="ltx_Math" alttext="+T_{3}" display="inline"><semantics id="S4.SS3.SSS0.Px1.3.3.3.3.3.1.m1.1a"><mrow id="S4.SS3.SSS0.Px1.3.3.3.3.3.1.m1.1.1" xref="S4.SS3.SSS0.Px1.3.3.3.3.3.1.m1.1.1.cmml"><mo id="S4.SS3.SSS0.Px1.3.3.3.3.3.1.m1.1.1a" xref="S4.SS3.SSS0.Px1.3.3.3.3.3.1.m1.1.1.cmml">+</mo><msub id="S4.SS3.SSS0.Px1.3.3.3.3.3.1.m1.1.1.2" xref="S4.SS3.SSS0.Px1.3.3.3.3.3.1.m1.1.1.2.cmml"><mi id="S4.SS3.SSS0.Px1.3.3.3.3.3.1.m1.1.1.2.2" xref="S4.SS3.SSS0.Px1.3.3.3.3.3.1.m1.1.1.2.2.cmml">T</mi><mn id="S4.SS3.SSS0.Px1.3.3.3.3.3.1.m1.1.1.2.3" xref="S4.SS3.SSS0.Px1.3.3.3.3.3.1.m1.1.1.2.3.cmml">3</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px1.3.3.3.3.3.1.m1.1b"><apply id="S4.SS3.SSS0.Px1.3.3.3.3.3.1.m1.1.1.cmml" xref="S4.SS3.SSS0.Px1.3.3.3.3.3.1.m1.1.1"><plus id="S4.SS3.SSS0.Px1.3.3.3.3.3.1.m1.1.1.1.cmml" xref="S4.SS3.SSS0.Px1.3.3.3.3.3.1.m1.1.1"></plus><apply id="S4.SS3.SSS0.Px1.3.3.3.3.3.1.m1.1.1.2.cmml" xref="S4.SS3.SSS0.Px1.3.3.3.3.3.1.m1.1.1.2"><csymbol cd="ambiguous" id="S4.SS3.SSS0.Px1.3.3.3.3.3.1.m1.1.1.2.1.cmml" xref="S4.SS3.SSS0.Px1.3.3.3.3.3.1.m1.1.1.2">subscript</csymbol><ci id="S4.SS3.SSS0.Px1.3.3.3.3.3.1.m1.1.1.2.2.cmml" xref="S4.SS3.SSS0.Px1.3.3.3.3.3.1.m1.1.1.2.2">𝑇</ci><cn type="integer" id="S4.SS3.SSS0.Px1.3.3.3.3.3.1.m1.1.1.2.3.cmml" xref="S4.SS3.SSS0.Px1.3.3.3.3.3.1.m1.1.1.2.3">3</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px1.3.3.3.3.3.1.m1.1c">+T_{3}</annotation></semantics></math></span>
<span id="S4.SS3.SSS0.Px1.3.3.3.3.3.2" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;">(<span id="S4.SS3.SSS0.Px1.3.3.3.3.3.2.1" class="ltx_text" style="color:#0000FF;">90.0</span>, 81.1)</span>
<span id="S4.SS3.SSS0.Px1.3.3.3.3.3.3" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;">(<span id="S4.SS3.SSS0.Px1.3.3.3.3.3.3.1" class="ltx_text" style="color:#0000FF;">91.0</span>, <span id="S4.SS3.SSS0.Px1.3.3.3.3.3.3.2" class="ltx_text" style="color:#0000FF;">96.1</span>)</span>
<span id="S4.SS3.SSS0.Px1.3.3.3.3.3.4" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;">(<span id="S4.SS3.SSS0.Px1.3.3.3.3.3.4.1" class="ltx_text" style="color:#0000FF;">95.2</span>, <span id="S4.SS3.SSS0.Px1.3.3.3.3.3.4.2" class="ltx_text" style="color:#0000FF;">86.0</span>)</span>
<span id="S4.SS3.SSS0.Px1.3.3.3.3.3.5" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;">(<span id="S4.SS3.SSS0.Px1.3.3.3.3.3.5.1" class="ltx_text" style="color:#0000FF;">81.9</span>, <span id="S4.SS3.SSS0.Px1.3.3.3.3.3.5.2" class="ltx_text" style="color:#0000FF;">85.2)</span></span></span>
<span id="S4.SS3.SSS0.Px1.4.4.4.4.4" class="ltx_tr">
<span id="S4.SS3.SSS0.Px1.4.4.4.4.4.1" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:3.0pt;padding-right:3.0pt;"><math id="S4.SS3.SSS0.Px1.4.4.4.4.4.1.m1.1" class="ltx_Math" alttext="+T_{4}" display="inline"><semantics id="S4.SS3.SSS0.Px1.4.4.4.4.4.1.m1.1a"><mrow id="S4.SS3.SSS0.Px1.4.4.4.4.4.1.m1.1.1" xref="S4.SS3.SSS0.Px1.4.4.4.4.4.1.m1.1.1.cmml"><mo id="S4.SS3.SSS0.Px1.4.4.4.4.4.1.m1.1.1a" xref="S4.SS3.SSS0.Px1.4.4.4.4.4.1.m1.1.1.cmml">+</mo><msub id="S4.SS3.SSS0.Px1.4.4.4.4.4.1.m1.1.1.2" xref="S4.SS3.SSS0.Px1.4.4.4.4.4.1.m1.1.1.2.cmml"><mi id="S4.SS3.SSS0.Px1.4.4.4.4.4.1.m1.1.1.2.2" xref="S4.SS3.SSS0.Px1.4.4.4.4.4.1.m1.1.1.2.2.cmml">T</mi><mn id="S4.SS3.SSS0.Px1.4.4.4.4.4.1.m1.1.1.2.3" xref="S4.SS3.SSS0.Px1.4.4.4.4.4.1.m1.1.1.2.3.cmml">4</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px1.4.4.4.4.4.1.m1.1b"><apply id="S4.SS3.SSS0.Px1.4.4.4.4.4.1.m1.1.1.cmml" xref="S4.SS3.SSS0.Px1.4.4.4.4.4.1.m1.1.1"><plus id="S4.SS3.SSS0.Px1.4.4.4.4.4.1.m1.1.1.1.cmml" xref="S4.SS3.SSS0.Px1.4.4.4.4.4.1.m1.1.1"></plus><apply id="S4.SS3.SSS0.Px1.4.4.4.4.4.1.m1.1.1.2.cmml" xref="S4.SS3.SSS0.Px1.4.4.4.4.4.1.m1.1.1.2"><csymbol cd="ambiguous" id="S4.SS3.SSS0.Px1.4.4.4.4.4.1.m1.1.1.2.1.cmml" xref="S4.SS3.SSS0.Px1.4.4.4.4.4.1.m1.1.1.2">subscript</csymbol><ci id="S4.SS3.SSS0.Px1.4.4.4.4.4.1.m1.1.1.2.2.cmml" xref="S4.SS3.SSS0.Px1.4.4.4.4.4.1.m1.1.1.2.2">𝑇</ci><cn type="integer" id="S4.SS3.SSS0.Px1.4.4.4.4.4.1.m1.1.1.2.3.cmml" xref="S4.SS3.SSS0.Px1.4.4.4.4.4.1.m1.1.1.2.3">4</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px1.4.4.4.4.4.1.m1.1c">+T_{4}</annotation></semantics></math></span>
<span id="S4.SS3.SSS0.Px1.4.4.4.4.4.2" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:3.0pt;padding-right:3.0pt;">(<span id="S4.SS3.SSS0.Px1.4.4.4.4.4.2.1" class="ltx_text" style="color:#FF0000;">91.1</span>, <span id="S4.SS3.SSS0.Px1.4.4.4.4.4.2.2" class="ltx_text" style="color:#FF0000;">81.4</span>)</span>
<span id="S4.SS3.SSS0.Px1.4.4.4.4.4.3" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:3.0pt;padding-right:3.0pt;">(<span id="S4.SS3.SSS0.Px1.4.4.4.4.4.3.1" class="ltx_text" style="color:#FF0000;">91.5</span>, <span id="S4.SS3.SSS0.Px1.4.4.4.4.4.3.2" class="ltx_text" style="color:#FF0000;">96.2</span>)</span>
<span id="S4.SS3.SSS0.Px1.4.4.4.4.4.4" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:3.0pt;padding-right:3.0pt;">(<span id="S4.SS3.SSS0.Px1.4.4.4.4.4.4.1" class="ltx_text" style="color:#FF0000;">95.5</span>, <span id="S4.SS3.SSS0.Px1.4.4.4.4.4.4.2" class="ltx_text" style="color:#FF0000;">87.0</span>)</span>
<span id="S4.SS3.SSS0.Px1.4.4.4.4.4.5" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:3.0pt;padding-right:3.0pt;">(<span id="S4.SS3.SSS0.Px1.4.4.4.4.4.5.1" class="ltx_text" style="color:#FF0000;">82.1</span>, <span id="S4.SS3.SSS0.Px1.4.4.4.4.4.5.2" class="ltx_text" style="color:#FF0000;">85.4</span>)</span></span>
</span></p>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<div id="S4.SS3.SSS0.Px1.4.5" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_middle" style="width:190.8pt;">
<span id="S4.SS3.SSS0.Px1.4.5.1" class="ltx_ERROR undefined">\captionof</span>
<p id="S4.SS3.SSS0.Px1.4.5.2" class="ltx_p ltx_align_center">tableContext optimization ablation.



<span id="S4.SS3.SSS0.Px1.4.5.2.1" class="ltx_tabular ltx_align_middle">
<span id="S4.SS3.SSS0.Px1.4.5.2.1.1" class="ltx_tr">
<span id="S4.SS3.SSS0.Px1.4.5.2.1.1.1" class="ltx_td ltx_align_center ltx_border_tt ltx_rowspan ltx_rowspan_2" style="padding-left:3.0pt;padding-right:3.0pt;"><span id="S4.SS3.SSS0.Px1.4.5.2.1.1.1.1" class="ltx_text">Local.</span></span>
<span id="S4.SS3.SSS0.Px1.4.5.2.1.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt ltx_rowspan ltx_rowspan_2" style="padding-left:3.0pt;padding-right:3.0pt;"><span id="S4.SS3.SSS0.Px1.4.5.2.1.1.2.1" class="ltx_text">Global.</span></span>
<span id="S4.SS3.SSS0.Px1.4.5.2.1.1.3" class="ltx_td ltx_align_center ltx_border_tt ltx_colspan ltx_colspan_2" style="padding-left:3.0pt;padding-right:3.0pt;">MVTec AD</span>
<span id="S4.SS3.SSS0.Px1.4.5.2.1.1.4" class="ltx_td ltx_align_center ltx_border_tt ltx_colspan ltx_colspan_2" style="padding-left:3.0pt;padding-right:3.0pt;">VisA</span></span>
<span id="S4.SS3.SSS0.Px1.4.5.2.1.2" class="ltx_tr">
<span id="S4.SS3.SSS0.Px1.4.5.2.1.2.1" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;">Pixel-level</span>
<span id="S4.SS3.SSS0.Px1.4.5.2.1.2.2" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;">Image-level</span>
<span id="S4.SS3.SSS0.Px1.4.5.2.1.2.3" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;">Pixel-level</span>
<span id="S4.SS3.SSS0.Px1.4.5.2.1.2.4" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;">Image-level</span></span>
<span id="S4.SS3.SSS0.Px1.4.5.2.1.3" class="ltx_tr">
<span id="S4.SS3.SSS0.Px1.4.5.2.1.3.1" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;">✗</span>
<span id="S4.SS3.SSS0.Px1.4.5.2.1.3.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;">✗</span>
<span id="S4.SS3.SSS0.Px1.4.5.2.1.3.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;">(71.7, 57.7)</span>
<span id="S4.SS3.SSS0.Px1.4.5.2.1.3.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;">(<span id="S4.SS3.SSS0.Px1.4.5.2.1.3.4.1" class="ltx_text" style="color:#FF8000;">68.8</span>, <span id="S4.SS3.SSS0.Px1.4.5.2.1.3.4.2" class="ltx_text" style="color:#FF8000;">85.8</span>)</span>
<span id="S4.SS3.SSS0.Px1.4.5.2.1.3.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;">(<span id="S4.SS3.SSS0.Px1.4.5.2.1.3.5.1" class="ltx_text" style="color:#FF8000;">74.7</span>, <span id="S4.SS3.SSS0.Px1.4.5.2.1.3.5.2" class="ltx_text" style="color:#FF8000;">62.1</span>)</span>
<span id="S4.SS3.SSS0.Px1.4.5.2.1.3.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;">(<span id="S4.SS3.SSS0.Px1.4.5.2.1.3.6.1" class="ltx_text" style="color:#FF8000;">61.1</span>, <span id="S4.SS3.SSS0.Px1.4.5.2.1.3.6.2" class="ltx_text" style="color:#FF8000;">69.1</span>)</span></span>
<span id="S4.SS3.SSS0.Px1.4.5.2.1.4" class="ltx_tr">
<span id="S4.SS3.SSS0.Px1.4.5.2.1.4.1" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;">✗</span>
<span id="S4.SS3.SSS0.Px1.4.5.2.1.4.2" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:3.0pt;padding-right:3.0pt;">✓</span>
<span id="S4.SS3.SSS0.Px1.4.5.2.1.4.3" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;">(80.3, 77.8)</span>
<span id="S4.SS3.SSS0.Px1.4.5.2.1.4.4" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;">(<span id="S4.SS3.SSS0.Px1.4.5.2.1.4.4.1" class="ltx_text" style="color:#0000FF;">89.9</span>, 95.4)</span>
<span id="S4.SS3.SSS0.Px1.4.5.2.1.4.5" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;">(86.6, 78.1)</span>
<span id="S4.SS3.SSS0.Px1.4.5.2.1.4.6" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;">(<span id="S4.SS3.SSS0.Px1.4.5.2.1.4.6.1" class="ltx_text" style="color:#FF0000;">82.2</span>, <span id="S4.SS3.SSS0.Px1.4.5.2.1.4.6.2" class="ltx_text" style="color:#0000FF;">84.9</span>)</span></span>
<span id="S4.SS3.SSS0.Px1.4.5.2.1.5" class="ltx_tr">
<span id="S4.SS3.SSS0.Px1.4.5.2.1.5.1" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;">✓</span>
<span id="S4.SS3.SSS0.Px1.4.5.2.1.5.2" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:3.0pt;padding-right:3.0pt;">✗</span>
<span id="S4.SS3.SSS0.Px1.4.5.2.1.5.3" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;">(<span id="S4.SS3.SSS0.Px1.4.5.2.1.5.3.1" class="ltx_text" style="color:#0000FF;">91.0</span>, <span id="S4.SS3.SSS0.Px1.4.5.2.1.5.3.2" class="ltx_text" style="color:#0000FF;">80.4</span>)</span>
<span id="S4.SS3.SSS0.Px1.4.5.2.1.5.4" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;">(<span id="S4.SS3.SSS0.Px1.4.5.2.1.5.4.1" class="ltx_text" style="color:#0000FF;">89.9</span>, <span id="S4.SS3.SSS0.Px1.4.5.2.1.5.4.2" class="ltx_text" style="color:#0000FF;">96.0</span>)</span>
<span id="S4.SS3.SSS0.Px1.4.5.2.1.5.5" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;">(<span id="S4.SS3.SSS0.Px1.4.5.2.1.5.5.1" class="ltx_text" style="color:#0000FF;">95.2</span>, <span id="S4.SS3.SSS0.Px1.4.5.2.1.5.5.2" class="ltx_text" style="color:#0000FF;">86.5</span>)</span>
<span id="S4.SS3.SSS0.Px1.4.5.2.1.5.6" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;">(79.5, 83.2)</span></span>
<span id="S4.SS3.SSS0.Px1.4.5.2.1.6" class="ltx_tr">
<span id="S4.SS3.SSS0.Px1.4.5.2.1.6.1" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:3.0pt;padding-right:3.0pt;">✓</span>
<span id="S4.SS3.SSS0.Px1.4.5.2.1.6.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" style="padding-left:3.0pt;padding-right:3.0pt;">✓</span>
<span id="S4.SS3.SSS0.Px1.4.5.2.1.6.3" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:3.0pt;padding-right:3.0pt;">(<span id="S4.SS3.SSS0.Px1.4.5.2.1.6.3.1" class="ltx_text" style="color:#FF0000;">91.1</span>, <span id="S4.SS3.SSS0.Px1.4.5.2.1.6.3.2" class="ltx_text" style="color:#FF0000;">81.4</span>)</span>
<span id="S4.SS3.SSS0.Px1.4.5.2.1.6.4" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:3.0pt;padding-right:3.0pt;">(<span id="S4.SS3.SSS0.Px1.4.5.2.1.6.4.1" class="ltx_text" style="color:#FF0000;">91.5</span>, <span id="S4.SS3.SSS0.Px1.4.5.2.1.6.4.2" class="ltx_text" style="color:#FF0000;">96.2</span>)</span>
<span id="S4.SS3.SSS0.Px1.4.5.2.1.6.5" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:3.0pt;padding-right:3.0pt;">(<span id="S4.SS3.SSS0.Px1.4.5.2.1.6.5.1" class="ltx_text" style="color:#FF0000;">95.5</span>, <span id="S4.SS3.SSS0.Px1.4.5.2.1.6.5.2" class="ltx_text" style="color:#FF0000;">87.0</span>)</span>
<span id="S4.SS3.SSS0.Px1.4.5.2.1.6.6" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:3.0pt;padding-right:3.0pt;">(<span id="S4.SS3.SSS0.Px1.4.5.2.1.6.6.1" class="ltx_text" style="color:#0000FF;">82.1</span>, <span id="S4.SS3.SSS0.Px1.4.5.2.1.6.6.2" class="ltx_text" style="color:#FF0000;">85.4</span>)</span></span>
</span></p>
</div>
</div>
</div>
</figure>
<figure id="S4.F6" class="ltx_figure"><img src="/html/2310.18961/assets/x15.png" id="S4.F6.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="338" height="91" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6: </span>DPAM component ablation.</figcaption>
</figure>
</section>
<section id="S4.SS3.SSS0.Px2" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Context optimization</h5>

<div id="S4.SS3.SSS0.Px2.p1" class="ltx_para ltx_noindent">
<p id="S4.SS3.SSS0.Px2.p1.1" class="ltx_p">Next we examine key modules in detail. The object-agnostic prompt learning is the most effective module, and it is driven by our glocal context optimization, so we consider two different optimization terms, local and global losses, in Eq. <a href="#S3.E2" title="In Glocal context optimization ‣ 3.3 Learning generic abnormality and normality prompts ‣ 3 AnomalyCLIP: object-agnostic prompt learning ‣ AnomalyCLIP: Object-agnostic Prompt Learning for Zero-shot Anomaly Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>. The results are shown in Table <a href="#S4.SS3.SSS0.Px1" title="Module ablation ‣ 4.3 Ablation study ‣ 4 Experiments ‣ AnomalyCLIP: Object-agnostic Prompt Learning for Zero-shot Anomaly Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.3</span></a>.
Both global and local context optimization contribute to the superiority of AnomalyCLIP. Global context optimization helps to capture global anomaly semantics, thus enabling more accurate image-level detection. Compared to global context optimization, local context optimization incorporates local anomaly semantics, which improves pixel-level performance and complements image-level performance.
By synthesizing these two optimization strategies, AnomalyCLIP generally achieves better performance than using them individually.
</p>
</div>
</section>
<section id="S4.SS3.SSS0.Px3" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">DPAM strategy ablation</h5>

<div id="S4.SS3.SSS0.Px3.p1" class="ltx_para ltx_noindent">
<p id="S4.SS3.SSS0.Px3.p1.13" class="ltx_p">AnomalyCLIP uses <math id="S4.SS3.SSS0.Px3.p1.1.m1.1" class="ltx_Math" alttext="V" display="inline"><semantics id="S4.SS3.SSS0.Px3.p1.1.m1.1a"><mi id="S4.SS3.SSS0.Px3.p1.1.m1.1.1" xref="S4.SS3.SSS0.Px3.p1.1.m1.1.1.cmml">V</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px3.p1.1.m1.1b"><ci id="S4.SS3.SSS0.Px3.p1.1.m1.1.1.cmml" xref="S4.SS3.SSS0.Px3.p1.1.m1.1.1">𝑉</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px3.p1.1.m1.1c">V</annotation></semantics></math>-<math id="S4.SS3.SSS0.Px3.p1.2.m2.1" class="ltx_Math" alttext="V" display="inline"><semantics id="S4.SS3.SSS0.Px3.p1.2.m2.1a"><mi id="S4.SS3.SSS0.Px3.p1.2.m2.1.1" xref="S4.SS3.SSS0.Px3.p1.2.m2.1.1.cmml">V</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px3.p1.2.m2.1b"><ci id="S4.SS3.SSS0.Px3.p1.2.m2.1.1.cmml" xref="S4.SS3.SSS0.Px3.p1.2.m2.1.1">𝑉</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px3.p1.2.m2.1c">V</annotation></semantics></math> self-attention by default. Here we study the effectiveness of using two other DPAM strategies, including <math id="S4.SS3.SSS0.Px3.p1.3.m3.1" class="ltx_Math" alttext="Q" display="inline"><semantics id="S4.SS3.SSS0.Px3.p1.3.m3.1a"><mi id="S4.SS3.SSS0.Px3.p1.3.m3.1.1" xref="S4.SS3.SSS0.Px3.p1.3.m3.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px3.p1.3.m3.1b"><ci id="S4.SS3.SSS0.Px3.p1.3.m3.1.1.cmml" xref="S4.SS3.SSS0.Px3.p1.3.m3.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px3.p1.3.m3.1c">Q</annotation></semantics></math>-<math id="S4.SS3.SSS0.Px3.p1.4.m4.1" class="ltx_Math" alttext="Q" display="inline"><semantics id="S4.SS3.SSS0.Px3.p1.4.m4.1a"><mi id="S4.SS3.SSS0.Px3.p1.4.m4.1.1" xref="S4.SS3.SSS0.Px3.p1.4.m4.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px3.p1.4.m4.1b"><ci id="S4.SS3.SSS0.Px3.p1.4.m4.1.1.cmml" xref="S4.SS3.SSS0.Px3.p1.4.m4.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px3.p1.4.m4.1c">Q</annotation></semantics></math> and <math id="S4.SS3.SSS0.Px3.p1.5.m5.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S4.SS3.SSS0.Px3.p1.5.m5.1a"><mi id="S4.SS3.SSS0.Px3.p1.5.m5.1.1" xref="S4.SS3.SSS0.Px3.p1.5.m5.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px3.p1.5.m5.1b"><ci id="S4.SS3.SSS0.Px3.p1.5.m5.1.1.cmml" xref="S4.SS3.SSS0.Px3.p1.5.m5.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px3.p1.5.m5.1c">K</annotation></semantics></math>-<math id="S4.SS3.SSS0.Px3.p1.6.m6.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S4.SS3.SSS0.Px3.p1.6.m6.1a"><mi id="S4.SS3.SSS0.Px3.p1.6.m6.1.1" xref="S4.SS3.SSS0.Px3.p1.6.m6.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px3.p1.6.m6.1b"><ci id="S4.SS3.SSS0.Px3.p1.6.m6.1.1.cmml" xref="S4.SS3.SSS0.Px3.p1.6.m6.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px3.p1.6.m6.1c">K</annotation></semantics></math> self-attention, resulting in two AnomalyCLIP variants, namely AnomalyCLIP<sub id="S4.SS3.SSS0.Px3.p1.13.1" class="ltx_sub"><span id="S4.SS3.SSS0.Px3.p1.13.1.1" class="ltx_text ltx_font_italic">qq</span></sub> and AnomalyCLIP<sub id="S4.SS3.SSS0.Px3.p1.13.2" class="ltx_sub"><span id="S4.SS3.SSS0.Px3.p1.13.2.1" class="ltx_text ltx_font_italic">kk</span></sub>. The comparison results are presented in Fig. <a href="#S4.F6" title="Figure 6 ‣ Module ablation ‣ 4.3 Ablation study ‣ 4 Experiments ‣ AnomalyCLIP: Object-agnostic Prompt Learning for Zero-shot Anomaly Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>. AnomalyCLIP<sub id="S4.SS3.SSS0.Px3.p1.13.3" class="ltx_sub"><span id="S4.SS3.SSS0.Px3.p1.13.3.1" class="ltx_text ltx_font_italic">qq</span></sub> achieves similar segmentation capabilities as AnomalyCLIP but suffers from degradation in detecting image-level anomalies. Conversely, while AnomalyCLIP<sub id="S4.SS3.SSS0.Px3.p1.13.4" class="ltx_sub"><span id="S4.SS3.SSS0.Px3.p1.13.4.1" class="ltx_text ltx_font_italic">kk</span></sub> performs well in anomaly classification, its segmentation performance is less effective than AnomalyCLIP and AnomalyCLIP<sub id="S4.SS3.SSS0.Px3.p1.13.5" class="ltx_sub"><span id="S4.SS3.SSS0.Px3.p1.13.5.1" class="ltx_text ltx_font_italic">qq</span></sub>. The <math id="S4.SS3.SSS0.Px3.p1.12.m12.1" class="ltx_Math" alttext="V" display="inline"><semantics id="S4.SS3.SSS0.Px3.p1.12.m12.1a"><mi id="S4.SS3.SSS0.Px3.p1.12.m12.1.1" xref="S4.SS3.SSS0.Px3.p1.12.m12.1.1.cmml">V</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px3.p1.12.m12.1b"><ci id="S4.SS3.SSS0.Px3.p1.12.m12.1.1.cmml" xref="S4.SS3.SSS0.Px3.p1.12.m12.1.1">𝑉</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px3.p1.12.m12.1c">V</annotation></semantics></math>-<math id="S4.SS3.SSS0.Px3.p1.13.m13.1" class="ltx_Math" alttext="V" display="inline"><semantics id="S4.SS3.SSS0.Px3.p1.13.m13.1a"><mi id="S4.SS3.SSS0.Px3.p1.13.m13.1.1" xref="S4.SS3.SSS0.Px3.p1.13.m13.1.1.cmml">V</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px3.p1.13.m13.1b"><ci id="S4.SS3.SSS0.Px3.p1.13.m13.1.1.cmml" xref="S4.SS3.SSS0.Px3.p1.13.m13.1.1">𝑉</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px3.p1.13.m13.1c">V</annotation></semantics></math> self-attention is generally recommended in AnomalyCLIP. <span id="S4.SS3.SSS0.Px3.p1.13.6" class="ltx_text" style="color:#FF8000;">Detailed analysis of DPAM can be seen in Appendix <a href="#A3" title="Appendix C Detailed Analysis of DPAM ‣ AnomalyCLIP: Object-agnostic Prompt Learning for Zero-shot Anomaly Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">C</span></a>.</span></p>
</div>
</section>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Related Work</h2>

<section id="S5.SS0.SSS0.Px1" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Zero-shot anomaly detection</h5>

<div id="S5.SS0.SSS0.Px1.p1" class="ltx_para ltx_noindent">
<p id="S5.SS0.SSS0.Px1.p1.1" class="ltx_p">ZSAD relies on the model’s strong transferability to handle unseen anomalies<span id="S5.SS0.SSS0.Px1.p1.1.1" class="ltx_text" style="color:#FF8000;"> <cite class="ltx_cite ltx_citemacro_citep">(Aota et al., <a href="#bib.bib1" title="" class="ltx_ref">2023</a>)</cite></span>.
<span id="S5.SS0.SSS0.Px1.p1.1.2" class="ltx_text" style="color:#FF8000;">CLIP-AD <cite class="ltx_cite ltx_citemacro_citep">(Liznerski et al., <a href="#bib.bib34" title="" class="ltx_ref">2022</a>)</cite> and ZOC <cite class="ltx_cite ltx_citemacro_citep">(Esmaeilpour et al., <a href="#bib.bib12" title="" class="ltx_ref">2022</a>)</cite> are early studies in utilizing CLIP for ZSAD, but they mainly focus on the anomaly classification task. ACR <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a href="#bib.bib28" title="" class="ltx_ref">2023a</a>)</cite> requires tuning on target-domain-relevant auxiliary data for ZSAD on different target datasets, while AnomalyCLIP can be applied to different datasets after it is trained on one general dataset.</span> A very recent approach WinCLIP <cite class="ltx_cite ltx_citemacro_citep">(Jeong et al., <a href="#bib.bib20" title="" class="ltx_ref">2023</a>)</cite> presents a seminal work that leverages CLIP for zero-shot classification and segmentation. It uses a large number of hand-crafted text prompts and involves multiple forward passes of image patches for anomaly segmentation. To tackle this inefficiency, VAND <cite class="ltx_cite ltx_citemacro_citep">(Chen et al., <a href="#bib.bib6" title="" class="ltx_ref">2023</a>)</cite> introduces learnable linear projection techniques to enhance the modeling of local visual semantics. However, these approaches suffer from insufficiently generalized textual prompt embeddings, which degrades their performance in identifying anomalies associated with various unseen object semantics. AnomalyCLIP utilizes only two object-agnostic learnable text prompts to optimize the generic text prompts of abnormality and normality, and it can obtain segmentation results with just a single forward pass. <span id="S5.SS0.SSS0.Px1.p1.1.3" class="ltx_text" style="color:#FF8000;">AnomalyGPT <cite class="ltx_cite ltx_citemacro_citep">(Gu et al., <a href="#bib.bib15" title="" class="ltx_ref">2023</a>)</cite> is a concurrent work in utilizing foundation models for AD, but it is designed for unsupervised/few-shot AD with manually crafted prompts.</span></p>
</div>
</section>
<section id="S5.SS0.SSS0.Px2" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Prompt learning</h5>

<div id="S5.SS0.SSS0.Px2.p1" class="ltx_para ltx_noindent">
<p id="S5.SS0.SSS0.Px2.p1.1" class="ltx_p">Rather than resorting to full network fine-tuning, prompt learning emerges as a parameter-efficient alternative to achieve satisfactory results <cite class="ltx_cite ltx_citemacro_citep">(Sun et al., <a href="#bib.bib48" title="" class="ltx_ref">2022</a>; Khattak et al., <a href="#bib.bib24" title="" class="ltx_ref">2023</a>; Kim et al., <a href="#bib.bib25" title="" class="ltx_ref">2023</a>; Zhou et al., <a href="#bib.bib59" title="" class="ltx_ref">2022a</a>)</cite>. CoOp <cite class="ltx_cite ltx_citemacro_citep">(Zhou et al., <a href="#bib.bib60" title="" class="ltx_ref">2022b</a>)</cite> introduces learnable text prompts for few-shot classification. On this basis, DenseCLIP <cite class="ltx_cite ltx_citemacro_citep">(Rao et al., <a href="#bib.bib42" title="" class="ltx_ref">2022</a>)</cite> extends prompt learning to dense prediction tasks with an extra image decoder. Instead, AnomalyCLIP proposes object-agnostic prompt learning for anomaly detection, blocking out the potential adverse impact of the diverse object semantics on anomaly detection. Benefiting from the glocal context optimization, AnomalyCLIP can capture local anomaly semantics such that we can simultaneously perform classification and segmentation tasks without an additional decoder network like <cite class="ltx_cite ltx_citemacro_cite">Rao et al. (<a href="#bib.bib42" title="" class="ltx_ref">2022</a>)</cite>.</p>
</div>
</section>
</section>
<section id="S6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Conclusion</h2>

<div id="S6.p1" class="ltx_para ltx_noindent">
<p id="S6.p1.1" class="ltx_p">In this paper, we tackle a challenging yet significant area of anomaly detection, ZSAD, in which there is no available data in the target dataset for training. We propose AnomalyCLIP to improve the weak generalization performance of CLIP for ZSAD. We introduce object-agnostic prompt learning to learn generic abnormality/normality text prompts for generalized ZSAD on image datasets of diverse foreground objects. Further, to incorporate global and local anomaly semantics into AnomalyCLIP, we devise a joint global and local context optimization to optimize the object-agnostic text prompts. Extensive experimental results on 17 public datasets demonstrate that AnomalyCLIP achieves superior ZSAD performance.</p>
</div>
<section id="S6.SS0.SSSx1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">Acknowledgments</h4>

<div id="S6.SS0.SSSx1.p1" class="ltx_para ltx_noindent">
<p id="S6.SS0.SSSx1.p1.1" class="ltx_p">This work was supported by NSFC U1909207, NSFC 62088101 Autonomous Intelligent Unmanned Systems, and the Singapore Ministry of Education Academic Research Fund Tier 1 grant (21SISSMU031).</p>
</div>
</section>
<section id="S6.SS0.SSSx2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">Reproducibility Statement</h4>

<div id="S6.SS0.SSSx2.p1" class="ltx_para ltx_noindent">
<p id="S6.SS0.SSSx2.p1.1" class="ltx_p">To ensure the reproducibility and completeness of this paper, we have included an Appendix consisting of five main sections. In Appendix <a href="#A1" title="Appendix A Implementation details and baselines ‣ AnomalyCLIP: Object-agnostic Prompt Learning for Zero-shot Anomaly Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">A</span></a>, we provide more implementation details of AnomalyCLIP, as well as the reproduction of other baseline methods. Appendix <a href="#A2" title="Appendix B Dataset ‣ AnomalyCLIP: Object-agnostic Prompt Learning for Zero-shot Anomaly Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">B</span></a> provides key statistics about the datasets used in our experiments and the implementation of the auxiliary medical dataset for prompt tuning. Appendix <a href="#A4" title="Appendix D Additional results and ablations ‣ AnomalyCLIP: Object-agnostic Prompt Learning for Zero-shot Anomaly Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">D</span></a> supplements the main paper with additional results and ablations. Further visualizations of similarity scores and maps are detailed in Appendix <a href="#A5" title="Appendix E Visualization ‣ AnomalyCLIP: Object-agnostic Prompt Learning for Zero-shot Anomaly Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">E</span></a>. Additionally, the main paper presents only the average performance in each dataset that contains a number of data subsets, for which we present their fine-grained detection results, in Appendix <a href="#A6" title="Appendix F Fine-grained ZSAD performance ‣ AnomalyCLIP: Object-agnostic Prompt Learning for Zero-shot Anomaly Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">F</span></a>. Our code will be made publicly accessible once the paper is accepted.</p>
</div>
</section>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Aota et al. (2023)</span>
<span class="ltx_bibblock">
Toshimichi Aota, Lloyd Teh Tzer Tong, and Takayuki Okatani.

</span>
<span class="ltx_bibblock">Zero-shot versus many-shot: Unsupervised texture anomaly detection.

</span>
<span class="ltx_bibblock">In <em id="bib.bib1.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF Winter Conference on
Applications of Computer Vision</em>, pp.  5564–5572, 2023.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bergmann et al. (2019)</span>
<span class="ltx_bibblock">
Paul Bergmann, Michael Fauser, David Sattlegger, and Carsten Steger.

</span>
<span class="ltx_bibblock">Mvtec ad–a comprehensive real-world dataset for unsupervised anomaly
detection.

</span>
<span class="ltx_bibblock">In <em id="bib.bib2.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF conference on computer vision
and pattern recognition</em>, pp.  9592–9600, 2019.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bergmann et al. (2020)</span>
<span class="ltx_bibblock">
Paul Bergmann, Michael Fauser, David Sattlegger, and Carsten Steger.

</span>
<span class="ltx_bibblock">Uninformed students: Student-teacher anomaly detection with
discriminative latent embeddings.

</span>
<span class="ltx_bibblock">In <em id="bib.bib3.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF conference on computer vision
and pattern recognition</em>, pp.  4183–4192, 2020.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bernal et al. (2015)</span>
<span class="ltx_bibblock">
Jorge Bernal, F Javier Sánchez, Gloria Fernández-Esparrach, Debora Gil,
Cristina Rodríguez, and Fernando Vilariño.

</span>
<span class="ltx_bibblock">Wm-dova maps for accurate polyp highlighting in colonoscopy:
Validation vs. saliency maps from physicians.

</span>
<span class="ltx_bibblock"><em id="bib.bib4.1.1" class="ltx_emph ltx_font_italic">Computerized medical imaging and graphics</em>, 43:99–111, 2015.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cao et al. (2023)</span>
<span class="ltx_bibblock">
Tri Cao, Jiawen Zhu, and Guansong Pang.

</span>
<span class="ltx_bibblock">Anomaly detection under distribution shift.

</span>
<span class="ltx_bibblock"><em id="bib.bib5.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2303.13845</em>, 2023.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al. (2023)</span>
<span class="ltx_bibblock">
Xuhai Chen, Yue Han, and Jiangning Zhang.

</span>
<span class="ltx_bibblock">A zero-/few-shot anomaly classification and segmentation method for
cvpr 2023 vand workshop challenge tracks 1&amp;2: 1st place on zero-shot ad and
4th place on few-shot ad.

</span>
<span class="ltx_bibblock"><em id="bib.bib6.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2305.17382</em>, 2023.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al. (2022)</span>
<span class="ltx_bibblock">
Yuanhong Chen, Yu Tian, Guansong Pang, and Gustavo Carneiro.

</span>
<span class="ltx_bibblock">Deep one-class classification via interpolated gaussian descriptor.

</span>
<span class="ltx_bibblock">In <em id="bib.bib7.1.1" class="ltx_emph ltx_font_italic">Proceedings of the AAAI Conference on Artificial
Intelligence</em>, volume 36, pp.  383–392, 2022.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chowdhury et al. (2020)</span>
<span class="ltx_bibblock">
Muhammad E. H. Chowdhury, Tawsifur Rahman, Amith Khandakar, Rashid Mazhar,
Muhammad Abdul Kadir, Zaid Bin Mahbub, Khandakar Reajul Islam,
Muhammad Salman Khan, Atif Iqbal, Nasser Al Emadi, Mamun Bin Ibne Reaz, and
Mohammad Tariqul Islam.

</span>
<span class="ltx_bibblock">Can ai help in screening viral and covid-19 pneumonia?

</span>
<span class="ltx_bibblock"><em id="bib.bib8.1.1" class="ltx_emph ltx_font_italic">IEEE Access</em>, 8:132665–132676, 2020.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.1109/ACCESS.2020.3010287</span>.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Deng &amp; Li (2022)</span>
<span class="ltx_bibblock">
Hanqiu Deng and Xingyu Li.

</span>
<span class="ltx_bibblock">Anomaly detection via reverse distillation from one-class embedding.

</span>
<span class="ltx_bibblock">In <em id="bib.bib9.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF Conference on Computer Vision
and Pattern Recognition</em>, pp.  9737–9746, 2022.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ding et al. (2022)</span>
<span class="ltx_bibblock">
Choubo Ding, Guansong Pang, and Chunhua Shen.

</span>
<span class="ltx_bibblock">Catching both gray and black swans: Open-set supervised anomaly
detection.

</span>
<span class="ltx_bibblock">In <em id="bib.bib10.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF Conference on Computer Vision
and Pattern Recognition</em>, pp.  7388–7398, 2022.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dosovitskiy et al. (2020)</span>
<span class="ltx_bibblock">
Alexey Dosovitskiy, Lucas Beyer, Alexander Kolesnikov, Dirk Weissenborn,
Xiaohua Zhai, Thomas Unterthiner, Mostafa Dehghani, Matthias Minderer, Georg
Heigold, Sylvain Gelly, et al.

</span>
<span class="ltx_bibblock">An image is worth 16x16 words: Transformers for image recognition at
scale.

</span>
<span class="ltx_bibblock"><em id="bib.bib11.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2010.11929</em>, 2020.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Esmaeilpour et al. (2022)</span>
<span class="ltx_bibblock">
Sepideh Esmaeilpour, Bing Liu, Eric Robertson, and Lei Shu.

</span>
<span class="ltx_bibblock">Zero-shot out-of-distribution detection based on the pre-trained
model clip.

</span>
<span class="ltx_bibblock">In <em id="bib.bib12.1.1" class="ltx_emph ltx_font_italic">Proceedings of the AAAI conference on artificial
intelligence</em>, volume 36, pp.  6568–6576, 2022.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Fernando et al. (2021)</span>
<span class="ltx_bibblock">
Tharindu Fernando, Harshala Gammulle, Simon Denman, Sridha Sridharan, and
Clinton Fookes.

</span>
<span class="ltx_bibblock">Deep learning for medical anomaly detection–a survey.

</span>
<span class="ltx_bibblock"><em id="bib.bib13.1.1" class="ltx_emph ltx_font_italic">ACM Computing Surveys (CSUR)</em>, 54(7):1–37,
2021.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gong et al. (2021)</span>
<span class="ltx_bibblock">
Haifan Gong, Guanqi Chen, Ranran Wang, Xiang Xie, Mingzhi Mao, Yizhou Yu, Fei
Chen, and Guanbin Li.

</span>
<span class="ltx_bibblock">Multi-task learning for thyroid nodule segmentation with thyroid
region prior.

</span>
<span class="ltx_bibblock">In <em id="bib.bib14.1.1" class="ltx_emph ltx_font_italic">2021 IEEE 18th international symposium on biomedical imaging
(ISBI)</em>, pp.  257–261. IEEE, 2021.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gu et al. (2023)</span>
<span class="ltx_bibblock">
Zhaopeng Gu, Bingke Zhu, Guibo Zhu, Yingying Chen, Ming Tang, and Jinqiao Wang.

</span>
<span class="ltx_bibblock">Anomalygpt: Detecting industrial anomalies using large
vision-language models, 2023.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gutman et al. (2016)</span>
<span class="ltx_bibblock">
David Gutman, Noel C. F. Codella, Emre Celebi, Brian Helba, Michael Marchetti,
Nabin Mishra, and Allan Halpern.

</span>
<span class="ltx_bibblock">Skin lesion analysis toward melanoma detection: A challenge at the
international symposium on biomedical imaging (isbi) 2016, hosted by the
international skin imaging collaboration (isic), 2016.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hamada. (2020)</span>
<span class="ltx_bibblock">
A. Hamada.

</span>
<span class="ltx_bibblock">Br35h: Brain tumor detection 2020.

</span>
<span class="ltx_bibblock"><em id="bib.bib17.1.1" class="ltx_emph ltx_font_italic">Online. Available:
https://www.kaggle.com/datasets/ahmedhamada0/brain-tumor-detection</em>, 2020.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hicks et al. (2021)</span>
<span class="ltx_bibblock">
Steven A Hicks, Debesh Jha, Vajira Thambawita, Pål Halvorsen, Hugo L
Hammer, and Michael A Riegler.

</span>
<span class="ltx_bibblock">The endotect 2020 challenge: evaluation and comparison of
classification, segmentation and inference time for endoscopy.

</span>
<span class="ltx_bibblock">In <em id="bib.bib18.1.1" class="ltx_emph ltx_font_italic">Pattern Recognition. ICPR International Workshops and
Challenges: Virtual Event, January 10-15, 2021, Proceedings, Part VIII</em>, pp. 263–274. Springer, 2021.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Huang et al. (2022)</span>
<span class="ltx_bibblock">
Chaoqin Huang, Haoyan Guan, Aofan Jiang, Ya Zhang, Michael Spratling, and
Yan-Feng Wang.

</span>
<span class="ltx_bibblock">Registration based few-shot anomaly detection.

</span>
<span class="ltx_bibblock">In <em id="bib.bib19.1.1" class="ltx_emph ltx_font_italic">European Conference on Computer Vision</em>, pp.  303–319.
Springer, 2022.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jeong et al. (2023)</span>
<span class="ltx_bibblock">
Jongheon Jeong, Yang Zou, Taewan Kim, Dongqing Zhang, Avinash Ravichandran, and
Onkar Dabeer.

</span>
<span class="ltx_bibblock">Winclip: Zero-/few-shot anomaly classification and segmentation.

</span>
<span class="ltx_bibblock">In <em id="bib.bib20.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF Conference on Computer Vision
and Pattern Recognition</em>, pp.  19606–19616, 2023.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jezek et al. (2021)</span>
<span class="ltx_bibblock">
Stepan Jezek, Martin Jonak, Radim Burget, Pavel Dvorak, and Milos Skotak.

</span>
<span class="ltx_bibblock">Deep learning-based defect detection of metal parts: evaluating
current methods in complex conditions.

</span>
<span class="ltx_bibblock">In <em id="bib.bib21.1.1" class="ltx_emph ltx_font_italic">2021 13th International congress on ultra modern
telecommunications and control systems and workshops (ICUMT)</em>, pp.  66–71.
IEEE, 2021.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jha et al. (2020)</span>
<span class="ltx_bibblock">
Debesh Jha, Pia H Smedsrud, Michael A Riegler, Pål Halvorsen, Thomas
de Lange, Dag Johansen, and Håvard D Johansen.

</span>
<span class="ltx_bibblock">Kvasir-seg: A segmented polyp dataset.

</span>
<span class="ltx_bibblock">In <em id="bib.bib22.1.1" class="ltx_emph ltx_font_italic">MultiMedia Modeling: 26th International Conference, MMM
2020, Daejeon, South Korea, January 5–8, 2020, Proceedings, Part II 26</em>,
pp.  451–462. Springer, 2020.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jia et al. (2022)</span>
<span class="ltx_bibblock">
Menglin Jia, Luming Tang, Bor-Chun Chen, Claire Cardie, Serge Belongie, Bharath
Hariharan, and Ser-Nam Lim.

</span>
<span class="ltx_bibblock">Visual prompt tuning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib23.1.1" class="ltx_emph ltx_font_italic">European Conference on Computer Vision</em>, pp.  709–727.
Springer, 2022.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Khattak et al. (2023)</span>
<span class="ltx_bibblock">
Muhammad Uzair Khattak, Hanoona Rasheed, Muhammad Maaz, Salman Khan, and
Fahad Shahbaz Khan.

</span>
<span class="ltx_bibblock">Maple: Multi-modal prompt learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib24.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF Conference on Computer Vision
and Pattern Recognition</em>, pp.  19113–19122, 2023.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kim et al. (2023)</span>
<span class="ltx_bibblock">
Kwanyoung Kim, Yujin Oh, and Jong Chul Ye.

</span>
<span class="ltx_bibblock">Zegot: Zero-shot segmentation through optimal transport of text
prompts.

</span>
<span class="ltx_bibblock"><em id="bib.bib25.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2301.12171</em>, 2023.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kingma &amp; Ba (2014)</span>
<span class="ltx_bibblock">
Diederik P Kingma and Jimmy Ba.

</span>
<span class="ltx_bibblock">Adam: A method for stochastic optimization.

</span>
<span class="ltx_bibblock"><em id="bib.bib26.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1412.6980</em>, 2014.

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kirillov et al. (2023)</span>
<span class="ltx_bibblock">
Alexander Kirillov, Eric Mintun, Nikhila Ravi, Hanzi Mao, Chloe Rolland, Laura
Gustafson, Tete Xiao, Spencer Whitehead, Alexander C Berg, Wan-Yen Lo, et al.

</span>
<span class="ltx_bibblock">Segment anything.

</span>
<span class="ltx_bibblock"><em id="bib.bib27.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2304.02643</em>, 2023.

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2023a)</span>
<span class="ltx_bibblock">
Aodong Li, Chen Qiu, Marius Kloft, Padhraic Smyth, Maja Rudolph, and Stephan
Mandt.

</span>
<span class="ltx_bibblock">Zero-shot anomaly detection via batch normalization.

</span>
<span class="ltx_bibblock">In <em id="bib.bib28.1.1" class="ltx_emph ltx_font_italic">Thirty-seventh Conference on Neural Information Processing
Systems</em>, 2023a.

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2019)</span>
<span class="ltx_bibblock">
Xiaoya Li, Xiaofei Sun, Yuxian Meng, Junjun Liang, Fei Wu, and Jiwei Li.

</span>
<span class="ltx_bibblock">Dice loss for data-imbalanced nlp tasks.

</span>
<span class="ltx_bibblock"><em id="bib.bib29.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1911.02855</em>, 2019.

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2023b)</span>
<span class="ltx_bibblock">
Yi Li, Hualiang Wang, Yiqun Duan, and Xiaomeng Li.

</span>
<span class="ltx_bibblock">Clip surgery for better explainability with enhancement in
open-vocabulary tasks.

</span>
<span class="ltx_bibblock"><em id="bib.bib30.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2304.05653</em>, 2023b.

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lin et al. (2017)</span>
<span class="ltx_bibblock">
Tsung-Yi Lin, Priya Goyal, Ross Girshick, Kaiming He, and Piotr Dollár.

</span>
<span class="ltx_bibblock">Focal loss for dense object detection.

</span>
<span class="ltx_bibblock">In <em id="bib.bib31.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE international conference on computer
vision</em>, pp.  2980–2988, 2017.

</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al. (2023)</span>
<span class="ltx_bibblock">
Jie Liu, Yixiao Zhang, Jie-Neng Chen, Junfei Xiao, Yongyi Lu, Bennett A
Landman, Yixuan Yuan, Alan Yuille, Yucheng Tang, and Zongwei Zhou.

</span>
<span class="ltx_bibblock">Clip-driven universal model for organ segmentation and tumor
detection.

</span>
<span class="ltx_bibblock"><em id="bib.bib32.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2301.00785</em>, 2023.

</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liznerski et al. (2020)</span>
<span class="ltx_bibblock">
Philipp Liznerski, Lukas Ruff, Robert A Vandermeulen, Billy Joe Franks, Marius
Kloft, and Klaus-Robert Müller.

</span>
<span class="ltx_bibblock">Explainable deep one-class classification.

</span>
<span class="ltx_bibblock"><em id="bib.bib33.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2007.01760</em>, 2020.

</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liznerski et al. (2022)</span>
<span class="ltx_bibblock">
Philipp Liznerski, Lukas Ruff, Robert A Vandermeulen, Billy Joe Franks,
Klaus-Robert Müller, and Marius Kloft.

</span>
<span class="ltx_bibblock">Exposing outlier exposure: What can be learned from few, one, and
zero outlier images.

</span>
<span class="ltx_bibblock"><em id="bib.bib34.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2205.11474</em>, 2022.

</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mishra et al. (2021)</span>
<span class="ltx_bibblock">
Pankaj Mishra, Riccardo Verk, Daniele Fornasier, Claudio Piciarelli, and
Gian Luca Foresti.

</span>
<span class="ltx_bibblock">Vt-adl: A vision transformer network for image anomaly detection and
localization.

</span>
<span class="ltx_bibblock">In <em id="bib.bib35.1.1" class="ltx_emph ltx_font_italic">2021 IEEE 30th International Symposium on Industrial
Electronics (ISIE)</em>, pp.  01–06. IEEE, 2021.

</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mou et al. (2022)</span>
<span class="ltx_bibblock">
Shancong Mou, Xiaoyi Gu, Meng Cao, Haoping Bai, Ping Huang, Jiulong Shan, and
Jianjun Shi.

</span>
<span class="ltx_bibblock">Rgi: robust gan-inversion for mask-free image inpainting and
unsupervised pixel-wise anomaly detection.

</span>
<span class="ltx_bibblock">In <em id="bib.bib36.1.1" class="ltx_emph ltx_font_italic">The Eleventh International Conference on Learning
Representations</em>, 2022.

</span>
</li>
<li id="bib.bib37" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Pang et al. (2021a)</span>
<span class="ltx_bibblock">
Guansong Pang, Choubo Ding, Chunhua Shen, and Anton van den Hengel.

</span>
<span class="ltx_bibblock">Explainable deep few-shot anomaly detection with deviation networks.

</span>
<span class="ltx_bibblock"><em id="bib.bib37.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2108.00462</em>, 2021a.

</span>
</li>
<li id="bib.bib38" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Pang et al. (2021b)</span>
<span class="ltx_bibblock">
Guansong Pang, Chunhua Shen, Longbing Cao, and Anton Van Den Hengel.

</span>
<span class="ltx_bibblock">Deep learning for anomaly detection: A review.

</span>
<span class="ltx_bibblock"><em id="bib.bib38.1.1" class="ltx_emph ltx_font_italic">ACM computing surveys (CSUR)</em>, 54(2):1–38,
2021b.

</span>
</li>
<li id="bib.bib39" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Qin et al. (2022)</span>
<span class="ltx_bibblock">
Ziyuan Qin, Huahui Yi, Qicheng Lao, and Kang Li.

</span>
<span class="ltx_bibblock">Medical image understanding with pretrained vision language models: A
comprehensive study.

</span>
<span class="ltx_bibblock"><em id="bib.bib39.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2209.15517</em>, 2022.

</span>
</li>
<li id="bib.bib40" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Radford et al. (2021)</span>
<span class="ltx_bibblock">
Alec Radford, Jong Wook Kim, Chris Hallacy, Aditya Ramesh, Gabriel Goh,
Sandhini Agarwal, Girish Sastry, Amanda Askell, Pamela Mishkin, Jack Clark,
et al.

</span>
<span class="ltx_bibblock">Learning transferable visual models from natural language
supervision.

</span>
<span class="ltx_bibblock">In <em id="bib.bib40.1.1" class="ltx_emph ltx_font_italic">International conference on machine learning</em>, pp. 8748–8763. PMLR, 2021.

</span>
</li>
<li id="bib.bib41" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rahman et al. (2021)</span>
<span class="ltx_bibblock">
Tawsifur Rahman, Amith Khandakar, Yazan Qiblawey, Anas Tahir, Serkan Kiranyaz,
Saad Bin Abul Kashem, Mohammad Tariqul Islam, Somaya Al Maadeed, Susu M
Zughaier, Muhammad Salman Khan, et al.

</span>
<span class="ltx_bibblock">Exploring the effect of image enhancement techniques on covid-19
detection using chest x-ray images.

</span>
<span class="ltx_bibblock"><em id="bib.bib41.1.1" class="ltx_emph ltx_font_italic">Computers in biology and medicine</em>, 132:104319, 2021.

</span>
</li>
<li id="bib.bib42" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rao et al. (2022)</span>
<span class="ltx_bibblock">
Yongming Rao, Wenliang Zhao, Guangyi Chen, Yansong Tang, Zheng Zhu, Guan Huang,
Jie Zhou, and Jiwen Lu.

</span>
<span class="ltx_bibblock">Denseclip: Language-guided dense prediction with context-aware
prompting.

</span>
<span class="ltx_bibblock">In <em id="bib.bib42.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF Conference on Computer Vision
and Pattern Recognition</em>, pp.  18082–18091, 2022.

</span>
</li>
<li id="bib.bib43" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Reiss &amp; Hoshen (2023)</span>
<span class="ltx_bibblock">
Tal Reiss and Yedid Hoshen.

</span>
<span class="ltx_bibblock">Mean-shifted contrastive loss for anomaly detection.

</span>
<span class="ltx_bibblock">In <em id="bib.bib43.1.1" class="ltx_emph ltx_font_italic">Proceedings of the AAAI Conference on Artificial
Intelligence</em>, volume 37, pp.  2155–2162, 2023.

</span>
</li>
<li id="bib.bib44" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Roth et al. (2022)</span>
<span class="ltx_bibblock">
Karsten Roth, Latha Pemula, Joaquin Zepeda, Bernhard Schölkopf, Thomas
Brox, and Peter Gehler.

</span>
<span class="ltx_bibblock">Towards total recall in industrial anomaly detection.

</span>
<span class="ltx_bibblock">In <em id="bib.bib44.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF Conference on Computer Vision
and Pattern Recognition</em>, pp.  14318–14328, 2022.

</span>
</li>
<li id="bib.bib45" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ruff et al. (2021)</span>
<span class="ltx_bibblock">
Lukas Ruff, Jacob R Kauffmann, Robert A Vandermeulen, Grégoire Montavon,
Wojciech Samek, Marius Kloft, Thomas G Dietterich, and Klaus-Robert
Müller.

</span>
<span class="ltx_bibblock">A unifying review of deep and shallow anomaly detection.

</span>
<span class="ltx_bibblock"><em id="bib.bib45.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE</em>, 109(5):756–795,
2021.

</span>
</li>
<li id="bib.bib46" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sain et al. (2023)</span>
<span class="ltx_bibblock">
Aneeshan Sain, Ayan Kumar Bhunia, Pinaki Nath Chowdhury, Subhadeep Koley, Tao
Xiang, and Yi-Zhe Song.

</span>
<span class="ltx_bibblock">Clip for all things zero-shot sketch-based image retrieval,
fine-grained or not.

</span>
<span class="ltx_bibblock">In <em id="bib.bib46.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF Conference on Computer Vision
and Pattern Recognition</em>, pp.  2765–2775, 2023.

</span>
</li>
<li id="bib.bib47" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Salehi et al. (2021)</span>
<span class="ltx_bibblock">
Mohammadreza Salehi, Niousha Sadjadi, Soroosh Baselizadeh, Mohammad H Rohban,
and Hamid R Rabiee.

</span>
<span class="ltx_bibblock">Multiresolution knowledge distillation for anomaly detection.

</span>
<span class="ltx_bibblock">In <em id="bib.bib47.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF conference on computer vision
and pattern recognition</em>, pp.  14902–14912, 2021.

</span>
</li>
<li id="bib.bib48" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sun et al. (2022)</span>
<span class="ltx_bibblock">
Ximeng Sun, Ping Hu, and Kate Saenko.

</span>
<span class="ltx_bibblock">Dualcoop: Fast adaptation to multi-label recognition with limited
annotations.

</span>
<span class="ltx_bibblock"><em id="bib.bib48.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>,
35:30569–30582, 2022.

</span>
</li>
<li id="bib.bib49" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tabernik et al. (2020)</span>
<span class="ltx_bibblock">
Domen Tabernik, Samo Šela, Jure Skvarč, and Danijel Skočaj.

</span>
<span class="ltx_bibblock">Segmentation-based deep-learning approach for surface-defect
detection.

</span>
<span class="ltx_bibblock"><em id="bib.bib49.1.1" class="ltx_emph ltx_font_italic">Journal of Intelligent Manufacturing</em>, 31(3):759–776, 2020.

</span>
</li>
<li id="bib.bib50" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tajbakhsh et al. (2015)</span>
<span class="ltx_bibblock">
Nima Tajbakhsh, Suryakanth R Gurudu, and Jianming Liang.

</span>
<span class="ltx_bibblock">Automated polyp detection in colonoscopy videos using shape and
context information.

</span>
<span class="ltx_bibblock"><em id="bib.bib50.1.1" class="ltx_emph ltx_font_italic">IEEE transactions on medical imaging</em>, 35(2):630–644, 2015.

</span>
</li>
<li id="bib.bib51" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tian et al. (2021)</span>
<span class="ltx_bibblock">
Yu Tian, Guansong Pang, Fengbei Liu, Yuanhong Chen, Seon Ho Shin, Johan W
Verjans, Rajvinder Singh, and Gustavo Carneiro.

</span>
<span class="ltx_bibblock">Constrained contrastive distribution learning for unsupervised
anomaly detection and localisation in medical images.

</span>
<span class="ltx_bibblock">In <em id="bib.bib51.1.1" class="ltx_emph ltx_font_italic">Medical Image Computing and Computer Assisted
Intervention–MICCAI 2021: 24th International Conference, Strasbourg, France,
September 27–October 1, 2021, Proceedings, Part V 24</em>, pp.  128–140.
Springer, 2021.

</span>
</li>
<li id="bib.bib52" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tian et al. (2023)</span>
<span class="ltx_bibblock">
Yu Tian, Fengbei Liu, Guansong Pang, Yuanhong Chen, Yuyuan Liu, Johan W
Verjans, Rajvinder Singh, and Gustavo Carneiro.

</span>
<span class="ltx_bibblock">Self-supervised pseudo multi-class pre-training for unsupervised
anomaly detection and segmentation in medical images.

</span>
<span class="ltx_bibblock"><em id="bib.bib52.1.1" class="ltx_emph ltx_font_italic">Medical Image Analysis</em>, pp.  102930, 2023.

</span>
</li>
<li id="bib.bib53" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Vaswani et al. (2017)</span>
<span class="ltx_bibblock">
Ashish Vaswani, Noam Shazeer, Niki Parmar, Jakob Uszkoreit, Llion Jones,
Aidan N Gomez, Łukasz Kaiser, and Illia Polosukhin.

</span>
<span class="ltx_bibblock">Attention is all you need.

</span>
<span class="ltx_bibblock"><em id="bib.bib53.1.1" class="ltx_emph ltx_font_italic">Advances in neural information processing systems</em>, 30, 2017.

</span>
</li>
<li id="bib.bib54" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wieler &amp; Hahn (2007)</span>
<span class="ltx_bibblock">
Matthias Wieler and Tobias Hahn.

</span>
<span class="ltx_bibblock">Weakly supervised learning for industrial optical inspection.

</span>
<span class="ltx_bibblock">In <em id="bib.bib54.1.1" class="ltx_emph ltx_font_italic">DAGM symposium in</em>, volume 6, 2007.

</span>
</li>
<li id="bib.bib55" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wu et al. (2023)</span>
<span class="ltx_bibblock">
Size Wu, Wenwei Zhang, Sheng Jin, Wentao Liu, and Chen Change Loy.

</span>
<span class="ltx_bibblock">Aligning bag of regions for open-vocabulary object detection.

</span>
<span class="ltx_bibblock">In <em id="bib.bib55.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF Conference on Computer Vision
and Pattern Recognition</em>, pp.  15254–15264, 2023.

</span>
</li>
<li id="bib.bib56" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xie et al. (2023)</span>
<span class="ltx_bibblock">
Guoyang Xie, Jingbao Wang, Jiaqi Liu, Feng Zheng, and Yaochu Jin.

</span>
<span class="ltx_bibblock">Pushing the limits of fewshot anomaly detection in industry vision:
Graphcore.

</span>
<span class="ltx_bibblock"><em id="bib.bib56.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2301.12082</em>, 2023.

</span>
</li>
<li id="bib.bib57" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">You et al. (2022)</span>
<span class="ltx_bibblock">
Zhiyuan You, Lei Cui, Yujun Shen, Kai Yang, Xin Lu, Yu Zheng, and Xinyi Le.

</span>
<span class="ltx_bibblock">A unified model for multi-class anomaly detection.

</span>
<span class="ltx_bibblock"><em id="bib.bib57.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>,
35:4571–4584, 2022.

</span>
</li>
<li id="bib.bib58" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhong et al. (2022)</span>
<span class="ltx_bibblock">
Yiwu Zhong, Jianwei Yang, Pengchuan Zhang, Chunyuan Li, Noel Codella,
Liunian Harold Li, Luowei Zhou, Xiyang Dai, Lu Yuan, Yin Li, et al.

</span>
<span class="ltx_bibblock">Regionclip: Region-based language-image pretraining.

</span>
<span class="ltx_bibblock">In <em id="bib.bib58.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF Conference on Computer Vision
and Pattern Recognition</em>, pp.  16793–16803, 2022.

</span>
</li>
<li id="bib.bib59" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhou et al. (2022a)</span>
<span class="ltx_bibblock">
Kaiyang Zhou, Jingkang Yang, Chen Change Loy, and Ziwei Liu.

</span>
<span class="ltx_bibblock">Conditional prompt learning for vision-language models.

</span>
<span class="ltx_bibblock">In <em id="bib.bib59.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF Conference on Computer Vision
and Pattern Recognition</em>, pp.  16816–16825, 2022a.

</span>
</li>
<li id="bib.bib60" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhou et al. (2022b)</span>
<span class="ltx_bibblock">
Kaiyang Zhou, Jingkang Yang, Chen Change Loy, and Ziwei Liu.

</span>
<span class="ltx_bibblock">Learning to prompt for vision-language models.

</span>
<span class="ltx_bibblock"><em id="bib.bib60.1.1" class="ltx_emph ltx_font_italic">International Journal of Computer Vision</em>, 130(9):2337–2348, 2022b.

</span>
</li>
<li id="bib.bib61" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhou et al. (2023)</span>
<span class="ltx_bibblock">
Qihang Zhou, Shibo He, Haoyu Liu, Tao Chen, and Jiming Chen.

</span>
<span class="ltx_bibblock">Pull &amp; push: Leveraging differential knowledge distillation for
efficient unsupervised anomaly detection and localization.

</span>
<span class="ltx_bibblock"><em id="bib.bib61.1.1" class="ltx_emph ltx_font_italic">IEEE Transactions on Circuits and Systems for Video
Technology</em>, 33(5):2176–2189, 2023.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.1109/TCSVT.2022.3218587</span>.

</span>
</li>
<li id="bib.bib62" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zou et al. (2022)</span>
<span class="ltx_bibblock">
Yang Zou, Jongheon Jeong, Latha Pemula, Dongqing Zhang, and Onkar Dabeer.

</span>
<span class="ltx_bibblock">Spot-the-difference self-supervised pre-training for anomaly
detection and segmentation.

</span>
<span class="ltx_bibblock">In <em id="bib.bib62.1.1" class="ltx_emph ltx_font_italic">European Conference on Computer Vision</em>, pp.  392–408.
Springer, 2022.

</span>
</li>
</ul>
</section>
<section id="A1" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Implementation details and baselines</h2>

<section id="A1.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.1 </span>Implementation details</h3>

<div id="A1.SS1.p1" class="ltx_para ltx_noindent">
<p id="A1.SS1.p1.4" class="ltx_p">In this paper, we use the publicly available CLIP model (<code id="A1.SS1.p1.4.1" class="ltx_verbatim ltx_font_typewriter">VIT-L/14@336px</code>) as our backbone. Model parameters of CLIP are all frozen. The length of learnable text prompts <math id="A1.SS1.p1.1.m1.1" class="ltx_Math" alttext="M" display="inline"><semantics id="A1.SS1.p1.1.m1.1a"><mi id="A1.SS1.p1.1.m1.1.1" xref="A1.SS1.p1.1.m1.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.1.m1.1b"><ci id="A1.SS1.p1.1.m1.1.1.cmml" xref="A1.SS1.p1.1.m1.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.1.m1.1c">M</annotation></semantics></math> is set to 12. These trainable text tokens are attached to the first 9 layers of the text encoder, and each text token has a length of 4. We fine-tune AnomalyCLIP on the test data on MVTec AD and test the performance for other datasets. As for MVTec AD, we fine-tune AomalyCLIP on test data on VisA. To provide adequate visual details, we extract local visual embeddings <math id="A1.SS1.p1.2.m2.1" class="ltx_Math" alttext="{\bm{v}}_{m}^{i}" display="inline"><semantics id="A1.SS1.p1.2.m2.1a"><msubsup id="A1.SS1.p1.2.m2.1.1" xref="A1.SS1.p1.2.m2.1.1.cmml"><mi id="A1.SS1.p1.2.m2.1.1.2.2" xref="A1.SS1.p1.2.m2.1.1.2.2.cmml">𝒗</mi><mi id="A1.SS1.p1.2.m2.1.1.2.3" xref="A1.SS1.p1.2.m2.1.1.2.3.cmml">m</mi><mi id="A1.SS1.p1.2.m2.1.1.3" xref="A1.SS1.p1.2.m2.1.1.3.cmml">i</mi></msubsup><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.2.m2.1b"><apply id="A1.SS1.p1.2.m2.1.1.cmml" xref="A1.SS1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="A1.SS1.p1.2.m2.1.1.1.cmml" xref="A1.SS1.p1.2.m2.1.1">superscript</csymbol><apply id="A1.SS1.p1.2.m2.1.1.2.cmml" xref="A1.SS1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="A1.SS1.p1.2.m2.1.1.2.1.cmml" xref="A1.SS1.p1.2.m2.1.1">subscript</csymbol><ci id="A1.SS1.p1.2.m2.1.1.2.2.cmml" xref="A1.SS1.p1.2.m2.1.1.2.2">𝒗</ci><ci id="A1.SS1.p1.2.m2.1.1.2.3.cmml" xref="A1.SS1.p1.2.m2.1.1.2.3">𝑚</ci></apply><ci id="A1.SS1.p1.2.m2.1.1.3.cmml" xref="A1.SS1.p1.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.2.m2.1c">{\bm{v}}_{m}^{i}</annotation></semantics></math> from the 6-th, 12-th, 18-th, and 24-th layers of the visual encoder. Starting from the 6-th layer, we apply DPAM to the architecture of the visual encoder according to Sec. <a href="#S3.SS3.SSS0.Px3" title="Refinement of the local visual space ‣ 3.3 Learning generic abnormality and normality prompts ‣ 3 AnomalyCLIP: object-agnostic prompt learning ‣ AnomalyCLIP: Object-agnostic Prompt Learning for Zero-shot Anomaly Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.3</span></a>. Additionally, we set the balanced weight <math id="A1.SS1.p1.3.m3.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="A1.SS1.p1.3.m3.1a"><mi id="A1.SS1.p1.3.m3.1.1" xref="A1.SS1.p1.3.m3.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.3.m3.1b"><ci id="A1.SS1.p1.3.m3.1.1.cmml" xref="A1.SS1.p1.3.m3.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.3.m3.1c">\lambda</annotation></semantics></math> to 1 in our loss function. The input images are resized to a size of 518 with batch size 8, and we use the Adam optimizer <cite class="ltx_cite ltx_citemacro_citep">(Kingma &amp; Ba, <a href="#bib.bib26" title="" class="ltx_ref">2014</a>)</cite> with a learning rate of 0.001 to update model parameters. During testing, we apply a Gaussian filter with <math id="A1.SS1.p1.4.m4.1" class="ltx_Math" alttext="\sigma=4" display="inline"><semantics id="A1.SS1.p1.4.m4.1a"><mrow id="A1.SS1.p1.4.m4.1.1" xref="A1.SS1.p1.4.m4.1.1.cmml"><mi id="A1.SS1.p1.4.m4.1.1.2" xref="A1.SS1.p1.4.m4.1.1.2.cmml">σ</mi><mo id="A1.SS1.p1.4.m4.1.1.1" xref="A1.SS1.p1.4.m4.1.1.1.cmml">=</mo><mn id="A1.SS1.p1.4.m4.1.1.3" xref="A1.SS1.p1.4.m4.1.1.3.cmml">4</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.4.m4.1b"><apply id="A1.SS1.p1.4.m4.1.1.cmml" xref="A1.SS1.p1.4.m4.1.1"><eq id="A1.SS1.p1.4.m4.1.1.1.cmml" xref="A1.SS1.p1.4.m4.1.1.1"></eq><ci id="A1.SS1.p1.4.m4.1.1.2.cmml" xref="A1.SS1.p1.4.m4.1.1.2">𝜎</ci><cn type="integer" id="A1.SS1.p1.4.m4.1.1.3.cmml" xref="A1.SS1.p1.4.m4.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.4.m4.1c">\sigma=4</annotation></semantics></math> to smooth the anomaly score map. The epoch is 15 for all experiments, which are performed in PyTorch-2.0.0 with a single NVIDIA RTX 3090 24GB GPU.</p>
</div>
</section>
<section id="A1.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.2 </span>Baselines</h3>

<div id="A1.SS2.p1" class="ltx_para ltx_noindent">
<p id="A1.SS2.p1.1" class="ltx_p">To demonstrate the superiority of Anomlay-CLIP, we compare AnomlayCLIP with broad SOTA baselines.
Implementation and reproduction details are given as follows:</p>
<ul id="A1.I1" class="ltx_itemize">
<li id="A1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A1.I1.i1.p1" class="ltx_para">
<p id="A1.I1.i1.p1.1" class="ltx_p">CLIP <cite class="ltx_cite ltx_citemacro_citep">(Radford et al., <a href="#bib.bib40" title="" class="ltx_ref">2021</a>)</cite>. CLIP is a powerful zero-shot classification method. To perform the anomaly detection task, we use two classes of text prompt templates <code id="A1.I1.i1.p1.1.1" class="ltx_verbatim ltx_font_typewriter">A photo of a normal [cls]</code> and <code id="A1.I1.i1.p1.1.2" class="ltx_verbatim ltx_font_typewriter">A photo of an anomalous [cls]</code>, where <code id="A1.I1.i1.p1.1.3" class="ltx_verbatim ltx_font_typewriter">cls</code> denotes the target class name. The anomaly score is computed according to Eq. <a href="#S2.E1" title="In 2 Preliminary ‣ AnomalyCLIP: Object-agnostic Prompt Learning for Zero-shot Anomaly Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>. As for anomaly segmentation, we extend the above computation to local visual embedding to derive the segmentation.</p>
</div>
</li>
<li id="A1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A1.I1.i2.p1" class="ltx_para">
<p id="A1.I1.i2.p1.1" class="ltx_p">CLIP-AC <cite class="ltx_cite ltx_citemacro_citep">(Radford et al., <a href="#bib.bib40" title="" class="ltx_ref">2021</a>)</cite>. Different from CLIP, CLIP-AC employs an ensemble of text prompt templates that are recommended for ImageNet dataset <cite class="ltx_cite ltx_citemacro_citep">(Radford et al., <a href="#bib.bib40" title="" class="ltx_ref">2021</a>)</cite>. We average the generated textual embeddings of normal and anomaly classes respectively, and compute the probability and segmentation in the same way as CLIP.</p>
</div>
</li>
<li id="A1.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A1.I1.i3.p1" class="ltx_para">
<p id="A1.I1.i3.p1.1" class="ltx_p">WinCLIP <cite class="ltx_cite ltx_citemacro_citep">(Jeong et al., <a href="#bib.bib20" title="" class="ltx_ref">2023</a>)</cite>. WinCLIP is a SOTA ZSAD method. They design a large set of hand-crafted text prompt templates specific to anomaly detection and use a window scaling strategy to obtain anomaly segmentation. All parameters are kept the same as in their paper.</p>
</div>
</li>
<li id="A1.I1.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A1.I1.i4.p1" class="ltx_para">
<p id="A1.I1.i4.p1.1" class="ltx_p">VAND <cite class="ltx_cite ltx_citemacro_citep">(Chen et al., <a href="#bib.bib6" title="" class="ltx_ref">2023</a>)</cite>. VAND is an improved version of WinCLIP. They first adjust the text prompt templates and then introduce learnable linear projections to improve local visual semantics to derive more accurate segmentation. All parameters are kept the same as in their paper.</p>
</div>
</li>
<li id="A1.I1.i5" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A1.I1.i5.p1" class="ltx_para ltx_noindent">
<p id="A1.I1.i5.p1.4" class="ltx_p">CoOp <cite class="ltx_cite ltx_citemacro_citep">(Zhou et al., <a href="#bib.bib60" title="" class="ltx_ref">2022b</a>)</cite>. CoOp is a representative method for prompt learning. To adapt CoOp to ZSAD, we replace its learnable text prompt templates <math id="A1.I1.i5.p1.1.m1.4" class="ltx_Math" alttext="[V_{1}][V_{2}]...[V_{N}][\verb'cls']" display="inline"><semantics id="A1.I1.i5.p1.1.m1.4a"><mrow id="A1.I1.i5.p1.1.m1.4.4" xref="A1.I1.i5.p1.1.m1.4.4.cmml"><mrow id="A1.I1.i5.p1.1.m1.2.2.1.1" xref="A1.I1.i5.p1.1.m1.2.2.1.2.cmml"><mo stretchy="false" id="A1.I1.i5.p1.1.m1.2.2.1.1.2" xref="A1.I1.i5.p1.1.m1.2.2.1.2.1.cmml">[</mo><msub id="A1.I1.i5.p1.1.m1.2.2.1.1.1" xref="A1.I1.i5.p1.1.m1.2.2.1.1.1.cmml"><mi id="A1.I1.i5.p1.1.m1.2.2.1.1.1.2" xref="A1.I1.i5.p1.1.m1.2.2.1.1.1.2.cmml">V</mi><mn id="A1.I1.i5.p1.1.m1.2.2.1.1.1.3" xref="A1.I1.i5.p1.1.m1.2.2.1.1.1.3.cmml">1</mn></msub><mo stretchy="false" id="A1.I1.i5.p1.1.m1.2.2.1.1.3" xref="A1.I1.i5.p1.1.m1.2.2.1.2.1.cmml">]</mo></mrow><mo lspace="0em" rspace="0em" id="A1.I1.i5.p1.1.m1.4.4.4" xref="A1.I1.i5.p1.1.m1.4.4.4.cmml">​</mo><mrow id="A1.I1.i5.p1.1.m1.3.3.2.1" xref="A1.I1.i5.p1.1.m1.3.3.2.2.cmml"><mo stretchy="false" id="A1.I1.i5.p1.1.m1.3.3.2.1.2" xref="A1.I1.i5.p1.1.m1.3.3.2.2.1.cmml">[</mo><msub id="A1.I1.i5.p1.1.m1.3.3.2.1.1" xref="A1.I1.i5.p1.1.m1.3.3.2.1.1.cmml"><mi id="A1.I1.i5.p1.1.m1.3.3.2.1.1.2" xref="A1.I1.i5.p1.1.m1.3.3.2.1.1.2.cmml">V</mi><mn id="A1.I1.i5.p1.1.m1.3.3.2.1.1.3" xref="A1.I1.i5.p1.1.m1.3.3.2.1.1.3.cmml">2</mn></msub><mo stretchy="false" id="A1.I1.i5.p1.1.m1.3.3.2.1.3" xref="A1.I1.i5.p1.1.m1.3.3.2.2.1.cmml">]</mo></mrow><mo lspace="0em" rspace="0em" id="A1.I1.i5.p1.1.m1.4.4.4a" xref="A1.I1.i5.p1.1.m1.4.4.4.cmml">​</mo><mi mathvariant="normal" id="A1.I1.i5.p1.1.m1.4.4.5" xref="A1.I1.i5.p1.1.m1.4.4.5.cmml">…</mi><mo lspace="0em" rspace="0em" id="A1.I1.i5.p1.1.m1.4.4.4b" xref="A1.I1.i5.p1.1.m1.4.4.4.cmml">​</mo><mrow id="A1.I1.i5.p1.1.m1.4.4.3.1" xref="A1.I1.i5.p1.1.m1.4.4.3.2.cmml"><mo stretchy="false" id="A1.I1.i5.p1.1.m1.4.4.3.1.2" xref="A1.I1.i5.p1.1.m1.4.4.3.2.1.cmml">[</mo><msub id="A1.I1.i5.p1.1.m1.4.4.3.1.1" xref="A1.I1.i5.p1.1.m1.4.4.3.1.1.cmml"><mi id="A1.I1.i5.p1.1.m1.4.4.3.1.1.2" xref="A1.I1.i5.p1.1.m1.4.4.3.1.1.2.cmml">V</mi><mi id="A1.I1.i5.p1.1.m1.4.4.3.1.1.3" xref="A1.I1.i5.p1.1.m1.4.4.3.1.1.3.cmml">N</mi></msub><mo stretchy="false" id="A1.I1.i5.p1.1.m1.4.4.3.1.3" xref="A1.I1.i5.p1.1.m1.4.4.3.2.1.cmml">]</mo></mrow><mo lspace="0em" rspace="0em" id="A1.I1.i5.p1.1.m1.4.4.4c" xref="A1.I1.i5.p1.1.m1.4.4.4.cmml">​</mo><mrow id="A1.I1.i5.p1.1.m1.4.4.6.2" xref="A1.I1.i5.p1.1.m1.4.4.6.1.cmml"><mo stretchy="false" id="A1.I1.i5.p1.1.m1.4.4.6.2.1" xref="A1.I1.i5.p1.1.m1.4.4.6.1.1.cmml">[</mo><mi id="A1.I1.i5.p1.1.m1.1.1" xref="A1.I1.i5.p1.1.m1.1.1.cmml">𝚌𝚕𝚜</mi><mo stretchy="false" id="A1.I1.i5.p1.1.m1.4.4.6.2.2" xref="A1.I1.i5.p1.1.m1.4.4.6.1.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.I1.i5.p1.1.m1.4b"><apply id="A1.I1.i5.p1.1.m1.4.4.cmml" xref="A1.I1.i5.p1.1.m1.4.4"><times id="A1.I1.i5.p1.1.m1.4.4.4.cmml" xref="A1.I1.i5.p1.1.m1.4.4.4"></times><apply id="A1.I1.i5.p1.1.m1.2.2.1.2.cmml" xref="A1.I1.i5.p1.1.m1.2.2.1.1"><csymbol cd="latexml" id="A1.I1.i5.p1.1.m1.2.2.1.2.1.cmml" xref="A1.I1.i5.p1.1.m1.2.2.1.1.2">delimited-[]</csymbol><apply id="A1.I1.i5.p1.1.m1.2.2.1.1.1.cmml" xref="A1.I1.i5.p1.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="A1.I1.i5.p1.1.m1.2.2.1.1.1.1.cmml" xref="A1.I1.i5.p1.1.m1.2.2.1.1.1">subscript</csymbol><ci id="A1.I1.i5.p1.1.m1.2.2.1.1.1.2.cmml" xref="A1.I1.i5.p1.1.m1.2.2.1.1.1.2">𝑉</ci><cn type="integer" id="A1.I1.i5.p1.1.m1.2.2.1.1.1.3.cmml" xref="A1.I1.i5.p1.1.m1.2.2.1.1.1.3">1</cn></apply></apply><apply id="A1.I1.i5.p1.1.m1.3.3.2.2.cmml" xref="A1.I1.i5.p1.1.m1.3.3.2.1"><csymbol cd="latexml" id="A1.I1.i5.p1.1.m1.3.3.2.2.1.cmml" xref="A1.I1.i5.p1.1.m1.3.3.2.1.2">delimited-[]</csymbol><apply id="A1.I1.i5.p1.1.m1.3.3.2.1.1.cmml" xref="A1.I1.i5.p1.1.m1.3.3.2.1.1"><csymbol cd="ambiguous" id="A1.I1.i5.p1.1.m1.3.3.2.1.1.1.cmml" xref="A1.I1.i5.p1.1.m1.3.3.2.1.1">subscript</csymbol><ci id="A1.I1.i5.p1.1.m1.3.3.2.1.1.2.cmml" xref="A1.I1.i5.p1.1.m1.3.3.2.1.1.2">𝑉</ci><cn type="integer" id="A1.I1.i5.p1.1.m1.3.3.2.1.1.3.cmml" xref="A1.I1.i5.p1.1.m1.3.3.2.1.1.3">2</cn></apply></apply><ci id="A1.I1.i5.p1.1.m1.4.4.5.cmml" xref="A1.I1.i5.p1.1.m1.4.4.5">…</ci><apply id="A1.I1.i5.p1.1.m1.4.4.3.2.cmml" xref="A1.I1.i5.p1.1.m1.4.4.3.1"><csymbol cd="latexml" id="A1.I1.i5.p1.1.m1.4.4.3.2.1.cmml" xref="A1.I1.i5.p1.1.m1.4.4.3.1.2">delimited-[]</csymbol><apply id="A1.I1.i5.p1.1.m1.4.4.3.1.1.cmml" xref="A1.I1.i5.p1.1.m1.4.4.3.1.1"><csymbol cd="ambiguous" id="A1.I1.i5.p1.1.m1.4.4.3.1.1.1.cmml" xref="A1.I1.i5.p1.1.m1.4.4.3.1.1">subscript</csymbol><ci id="A1.I1.i5.p1.1.m1.4.4.3.1.1.2.cmml" xref="A1.I1.i5.p1.1.m1.4.4.3.1.1.2">𝑉</ci><ci id="A1.I1.i5.p1.1.m1.4.4.3.1.1.3.cmml" xref="A1.I1.i5.p1.1.m1.4.4.3.1.1.3">𝑁</ci></apply></apply><apply id="A1.I1.i5.p1.1.m1.4.4.6.1.cmml" xref="A1.I1.i5.p1.1.m1.4.4.6.2"><csymbol cd="latexml" id="A1.I1.i5.p1.1.m1.4.4.6.1.1.cmml" xref="A1.I1.i5.p1.1.m1.4.4.6.2.1">delimited-[]</csymbol><ci id="A1.I1.i5.p1.1.m1.1.1.cmml" xref="A1.I1.i5.p1.1.m1.1.1">𝚌𝚕𝚜</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.I1.i5.p1.1.m1.4c">[V_{1}][V_{2}]...[V_{N}][\verb'cls']</annotation></semantics></math> with normality and abnormality text prompt templates, where <math id="A1.I1.i5.p1.2.m2.1" class="ltx_Math" alttext="V_{i}" display="inline"><semantics id="A1.I1.i5.p1.2.m2.1a"><msub id="A1.I1.i5.p1.2.m2.1.1" xref="A1.I1.i5.p1.2.m2.1.1.cmml"><mi id="A1.I1.i5.p1.2.m2.1.1.2" xref="A1.I1.i5.p1.2.m2.1.1.2.cmml">V</mi><mi id="A1.I1.i5.p1.2.m2.1.1.3" xref="A1.I1.i5.p1.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A1.I1.i5.p1.2.m2.1b"><apply id="A1.I1.i5.p1.2.m2.1.1.cmml" xref="A1.I1.i5.p1.2.m2.1.1"><csymbol cd="ambiguous" id="A1.I1.i5.p1.2.m2.1.1.1.cmml" xref="A1.I1.i5.p1.2.m2.1.1">subscript</csymbol><ci id="A1.I1.i5.p1.2.m2.1.1.2.cmml" xref="A1.I1.i5.p1.2.m2.1.1.2">𝑉</ci><ci id="A1.I1.i5.p1.2.m2.1.1.3.cmml" xref="A1.I1.i5.p1.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.I1.i5.p1.2.m2.1c">V_{i}</annotation></semantics></math> is the learnable word embeddings. The normality text prompt template is defined as <math id="A1.I1.i5.p1.3.m3.5" class="ltx_Math" alttext="[V_{1}][V_{2}]...[V_{N}][\verb'normal'][\verb'cls']" display="inline"><semantics id="A1.I1.i5.p1.3.m3.5a"><mrow id="A1.I1.i5.p1.3.m3.5.5" xref="A1.I1.i5.p1.3.m3.5.5.cmml"><mrow id="A1.I1.i5.p1.3.m3.3.3.1.1" xref="A1.I1.i5.p1.3.m3.3.3.1.2.cmml"><mo stretchy="false" id="A1.I1.i5.p1.3.m3.3.3.1.1.2" xref="A1.I1.i5.p1.3.m3.3.3.1.2.1.cmml">[</mo><msub id="A1.I1.i5.p1.3.m3.3.3.1.1.1" xref="A1.I1.i5.p1.3.m3.3.3.1.1.1.cmml"><mi id="A1.I1.i5.p1.3.m3.3.3.1.1.1.2" xref="A1.I1.i5.p1.3.m3.3.3.1.1.1.2.cmml">V</mi><mn id="A1.I1.i5.p1.3.m3.3.3.1.1.1.3" xref="A1.I1.i5.p1.3.m3.3.3.1.1.1.3.cmml">1</mn></msub><mo stretchy="false" id="A1.I1.i5.p1.3.m3.3.3.1.1.3" xref="A1.I1.i5.p1.3.m3.3.3.1.2.1.cmml">]</mo></mrow><mo lspace="0em" rspace="0em" id="A1.I1.i5.p1.3.m3.5.5.4" xref="A1.I1.i5.p1.3.m3.5.5.4.cmml">​</mo><mrow id="A1.I1.i5.p1.3.m3.4.4.2.1" xref="A1.I1.i5.p1.3.m3.4.4.2.2.cmml"><mo stretchy="false" id="A1.I1.i5.p1.3.m3.4.4.2.1.2" xref="A1.I1.i5.p1.3.m3.4.4.2.2.1.cmml">[</mo><msub id="A1.I1.i5.p1.3.m3.4.4.2.1.1" xref="A1.I1.i5.p1.3.m3.4.4.2.1.1.cmml"><mi id="A1.I1.i5.p1.3.m3.4.4.2.1.1.2" xref="A1.I1.i5.p1.3.m3.4.4.2.1.1.2.cmml">V</mi><mn id="A1.I1.i5.p1.3.m3.4.4.2.1.1.3" xref="A1.I1.i5.p1.3.m3.4.4.2.1.1.3.cmml">2</mn></msub><mo stretchy="false" id="A1.I1.i5.p1.3.m3.4.4.2.1.3" xref="A1.I1.i5.p1.3.m3.4.4.2.2.1.cmml">]</mo></mrow><mo lspace="0em" rspace="0em" id="A1.I1.i5.p1.3.m3.5.5.4a" xref="A1.I1.i5.p1.3.m3.5.5.4.cmml">​</mo><mi mathvariant="normal" id="A1.I1.i5.p1.3.m3.5.5.5" xref="A1.I1.i5.p1.3.m3.5.5.5.cmml">…</mi><mo lspace="0em" rspace="0em" id="A1.I1.i5.p1.3.m3.5.5.4b" xref="A1.I1.i5.p1.3.m3.5.5.4.cmml">​</mo><mrow id="A1.I1.i5.p1.3.m3.5.5.3.1" xref="A1.I1.i5.p1.3.m3.5.5.3.2.cmml"><mo stretchy="false" id="A1.I1.i5.p1.3.m3.5.5.3.1.2" xref="A1.I1.i5.p1.3.m3.5.5.3.2.1.cmml">[</mo><msub id="A1.I1.i5.p1.3.m3.5.5.3.1.1" xref="A1.I1.i5.p1.3.m3.5.5.3.1.1.cmml"><mi id="A1.I1.i5.p1.3.m3.5.5.3.1.1.2" xref="A1.I1.i5.p1.3.m3.5.5.3.1.1.2.cmml">V</mi><mi id="A1.I1.i5.p1.3.m3.5.5.3.1.1.3" xref="A1.I1.i5.p1.3.m3.5.5.3.1.1.3.cmml">N</mi></msub><mo stretchy="false" id="A1.I1.i5.p1.3.m3.5.5.3.1.3" xref="A1.I1.i5.p1.3.m3.5.5.3.2.1.cmml">]</mo></mrow><mo lspace="0em" rspace="0em" id="A1.I1.i5.p1.3.m3.5.5.4c" xref="A1.I1.i5.p1.3.m3.5.5.4.cmml">​</mo><mrow id="A1.I1.i5.p1.3.m3.5.5.6.2" xref="A1.I1.i5.p1.3.m3.5.5.6.1.cmml"><mo stretchy="false" id="A1.I1.i5.p1.3.m3.5.5.6.2.1" xref="A1.I1.i5.p1.3.m3.5.5.6.1.1.cmml">[</mo><mi id="A1.I1.i5.p1.3.m3.1.1" xref="A1.I1.i5.p1.3.m3.1.1.cmml">𝚗𝚘𝚛𝚖𝚊𝚕</mi><mo stretchy="false" id="A1.I1.i5.p1.3.m3.5.5.6.2.2" xref="A1.I1.i5.p1.3.m3.5.5.6.1.1.cmml">]</mo></mrow><mo lspace="0em" rspace="0em" id="A1.I1.i5.p1.3.m3.5.5.4d" xref="A1.I1.i5.p1.3.m3.5.5.4.cmml">​</mo><mrow id="A1.I1.i5.p1.3.m3.5.5.7.2" xref="A1.I1.i5.p1.3.m3.5.5.7.1.cmml"><mo stretchy="false" id="A1.I1.i5.p1.3.m3.5.5.7.2.1" xref="A1.I1.i5.p1.3.m3.5.5.7.1.1.cmml">[</mo><mi id="A1.I1.i5.p1.3.m3.2.2" xref="A1.I1.i5.p1.3.m3.2.2.cmml">𝚌𝚕𝚜</mi><mo stretchy="false" id="A1.I1.i5.p1.3.m3.5.5.7.2.2" xref="A1.I1.i5.p1.3.m3.5.5.7.1.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.I1.i5.p1.3.m3.5b"><apply id="A1.I1.i5.p1.3.m3.5.5.cmml" xref="A1.I1.i5.p1.3.m3.5.5"><times id="A1.I1.i5.p1.3.m3.5.5.4.cmml" xref="A1.I1.i5.p1.3.m3.5.5.4"></times><apply id="A1.I1.i5.p1.3.m3.3.3.1.2.cmml" xref="A1.I1.i5.p1.3.m3.3.3.1.1"><csymbol cd="latexml" id="A1.I1.i5.p1.3.m3.3.3.1.2.1.cmml" xref="A1.I1.i5.p1.3.m3.3.3.1.1.2">delimited-[]</csymbol><apply id="A1.I1.i5.p1.3.m3.3.3.1.1.1.cmml" xref="A1.I1.i5.p1.3.m3.3.3.1.1.1"><csymbol cd="ambiguous" id="A1.I1.i5.p1.3.m3.3.3.1.1.1.1.cmml" xref="A1.I1.i5.p1.3.m3.3.3.1.1.1">subscript</csymbol><ci id="A1.I1.i5.p1.3.m3.3.3.1.1.1.2.cmml" xref="A1.I1.i5.p1.3.m3.3.3.1.1.1.2">𝑉</ci><cn type="integer" id="A1.I1.i5.p1.3.m3.3.3.1.1.1.3.cmml" xref="A1.I1.i5.p1.3.m3.3.3.1.1.1.3">1</cn></apply></apply><apply id="A1.I1.i5.p1.3.m3.4.4.2.2.cmml" xref="A1.I1.i5.p1.3.m3.4.4.2.1"><csymbol cd="latexml" id="A1.I1.i5.p1.3.m3.4.4.2.2.1.cmml" xref="A1.I1.i5.p1.3.m3.4.4.2.1.2">delimited-[]</csymbol><apply id="A1.I1.i5.p1.3.m3.4.4.2.1.1.cmml" xref="A1.I1.i5.p1.3.m3.4.4.2.1.1"><csymbol cd="ambiguous" id="A1.I1.i5.p1.3.m3.4.4.2.1.1.1.cmml" xref="A1.I1.i5.p1.3.m3.4.4.2.1.1">subscript</csymbol><ci id="A1.I1.i5.p1.3.m3.4.4.2.1.1.2.cmml" xref="A1.I1.i5.p1.3.m3.4.4.2.1.1.2">𝑉</ci><cn type="integer" id="A1.I1.i5.p1.3.m3.4.4.2.1.1.3.cmml" xref="A1.I1.i5.p1.3.m3.4.4.2.1.1.3">2</cn></apply></apply><ci id="A1.I1.i5.p1.3.m3.5.5.5.cmml" xref="A1.I1.i5.p1.3.m3.5.5.5">…</ci><apply id="A1.I1.i5.p1.3.m3.5.5.3.2.cmml" xref="A1.I1.i5.p1.3.m3.5.5.3.1"><csymbol cd="latexml" id="A1.I1.i5.p1.3.m3.5.5.3.2.1.cmml" xref="A1.I1.i5.p1.3.m3.5.5.3.1.2">delimited-[]</csymbol><apply id="A1.I1.i5.p1.3.m3.5.5.3.1.1.cmml" xref="A1.I1.i5.p1.3.m3.5.5.3.1.1"><csymbol cd="ambiguous" id="A1.I1.i5.p1.3.m3.5.5.3.1.1.1.cmml" xref="A1.I1.i5.p1.3.m3.5.5.3.1.1">subscript</csymbol><ci id="A1.I1.i5.p1.3.m3.5.5.3.1.1.2.cmml" xref="A1.I1.i5.p1.3.m3.5.5.3.1.1.2">𝑉</ci><ci id="A1.I1.i5.p1.3.m3.5.5.3.1.1.3.cmml" xref="A1.I1.i5.p1.3.m3.5.5.3.1.1.3">𝑁</ci></apply></apply><apply id="A1.I1.i5.p1.3.m3.5.5.6.1.cmml" xref="A1.I1.i5.p1.3.m3.5.5.6.2"><csymbol cd="latexml" id="A1.I1.i5.p1.3.m3.5.5.6.1.1.cmml" xref="A1.I1.i5.p1.3.m3.5.5.6.2.1">delimited-[]</csymbol><ci id="A1.I1.i5.p1.3.m3.1.1.cmml" xref="A1.I1.i5.p1.3.m3.1.1">𝚗𝚘𝚛𝚖𝚊𝚕</ci></apply><apply id="A1.I1.i5.p1.3.m3.5.5.7.1.cmml" xref="A1.I1.i5.p1.3.m3.5.5.7.2"><csymbol cd="latexml" id="A1.I1.i5.p1.3.m3.5.5.7.1.1.cmml" xref="A1.I1.i5.p1.3.m3.5.5.7.2.1">delimited-[]</csymbol><ci id="A1.I1.i5.p1.3.m3.2.2.cmml" xref="A1.I1.i5.p1.3.m3.2.2">𝚌𝚕𝚜</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.I1.i5.p1.3.m3.5c">[V_{1}][V_{2}]...[V_{N}][\verb'normal'][\verb'cls']</annotation></semantics></math>, and the abnormality one is defined as <math id="A1.I1.i5.p1.4.m4.5" class="ltx_Math" alttext="[V_{1}][V_{2}]...[V_{N}][\verb'anomalous'][\verb'cls']" display="inline"><semantics id="A1.I1.i5.p1.4.m4.5a"><mrow id="A1.I1.i5.p1.4.m4.5.5" xref="A1.I1.i5.p1.4.m4.5.5.cmml"><mrow id="A1.I1.i5.p1.4.m4.3.3.1.1" xref="A1.I1.i5.p1.4.m4.3.3.1.2.cmml"><mo stretchy="false" id="A1.I1.i5.p1.4.m4.3.3.1.1.2" xref="A1.I1.i5.p1.4.m4.3.3.1.2.1.cmml">[</mo><msub id="A1.I1.i5.p1.4.m4.3.3.1.1.1" xref="A1.I1.i5.p1.4.m4.3.3.1.1.1.cmml"><mi id="A1.I1.i5.p1.4.m4.3.3.1.1.1.2" xref="A1.I1.i5.p1.4.m4.3.3.1.1.1.2.cmml">V</mi><mn id="A1.I1.i5.p1.4.m4.3.3.1.1.1.3" xref="A1.I1.i5.p1.4.m4.3.3.1.1.1.3.cmml">1</mn></msub><mo stretchy="false" id="A1.I1.i5.p1.4.m4.3.3.1.1.3" xref="A1.I1.i5.p1.4.m4.3.3.1.2.1.cmml">]</mo></mrow><mo lspace="0em" rspace="0em" id="A1.I1.i5.p1.4.m4.5.5.4" xref="A1.I1.i5.p1.4.m4.5.5.4.cmml">​</mo><mrow id="A1.I1.i5.p1.4.m4.4.4.2.1" xref="A1.I1.i5.p1.4.m4.4.4.2.2.cmml"><mo stretchy="false" id="A1.I1.i5.p1.4.m4.4.4.2.1.2" xref="A1.I1.i5.p1.4.m4.4.4.2.2.1.cmml">[</mo><msub id="A1.I1.i5.p1.4.m4.4.4.2.1.1" xref="A1.I1.i5.p1.4.m4.4.4.2.1.1.cmml"><mi id="A1.I1.i5.p1.4.m4.4.4.2.1.1.2" xref="A1.I1.i5.p1.4.m4.4.4.2.1.1.2.cmml">V</mi><mn id="A1.I1.i5.p1.4.m4.4.4.2.1.1.3" xref="A1.I1.i5.p1.4.m4.4.4.2.1.1.3.cmml">2</mn></msub><mo stretchy="false" id="A1.I1.i5.p1.4.m4.4.4.2.1.3" xref="A1.I1.i5.p1.4.m4.4.4.2.2.1.cmml">]</mo></mrow><mo lspace="0em" rspace="0em" id="A1.I1.i5.p1.4.m4.5.5.4a" xref="A1.I1.i5.p1.4.m4.5.5.4.cmml">​</mo><mi mathvariant="normal" id="A1.I1.i5.p1.4.m4.5.5.5" xref="A1.I1.i5.p1.4.m4.5.5.5.cmml">…</mi><mo lspace="0em" rspace="0em" id="A1.I1.i5.p1.4.m4.5.5.4b" xref="A1.I1.i5.p1.4.m4.5.5.4.cmml">​</mo><mrow id="A1.I1.i5.p1.4.m4.5.5.3.1" xref="A1.I1.i5.p1.4.m4.5.5.3.2.cmml"><mo stretchy="false" id="A1.I1.i5.p1.4.m4.5.5.3.1.2" xref="A1.I1.i5.p1.4.m4.5.5.3.2.1.cmml">[</mo><msub id="A1.I1.i5.p1.4.m4.5.5.3.1.1" xref="A1.I1.i5.p1.4.m4.5.5.3.1.1.cmml"><mi id="A1.I1.i5.p1.4.m4.5.5.3.1.1.2" xref="A1.I1.i5.p1.4.m4.5.5.3.1.1.2.cmml">V</mi><mi id="A1.I1.i5.p1.4.m4.5.5.3.1.1.3" xref="A1.I1.i5.p1.4.m4.5.5.3.1.1.3.cmml">N</mi></msub><mo stretchy="false" id="A1.I1.i5.p1.4.m4.5.5.3.1.3" xref="A1.I1.i5.p1.4.m4.5.5.3.2.1.cmml">]</mo></mrow><mo lspace="0em" rspace="0em" id="A1.I1.i5.p1.4.m4.5.5.4c" xref="A1.I1.i5.p1.4.m4.5.5.4.cmml">​</mo><mrow id="A1.I1.i5.p1.4.m4.5.5.6.2" xref="A1.I1.i5.p1.4.m4.5.5.6.1.cmml"><mo stretchy="false" id="A1.I1.i5.p1.4.m4.5.5.6.2.1" xref="A1.I1.i5.p1.4.m4.5.5.6.1.1.cmml">[</mo><mi id="A1.I1.i5.p1.4.m4.1.1" xref="A1.I1.i5.p1.4.m4.1.1.cmml">𝚊𝚗𝚘𝚖𝚊𝚕𝚘𝚞𝚜</mi><mo stretchy="false" id="A1.I1.i5.p1.4.m4.5.5.6.2.2" xref="A1.I1.i5.p1.4.m4.5.5.6.1.1.cmml">]</mo></mrow><mo lspace="0em" rspace="0em" id="A1.I1.i5.p1.4.m4.5.5.4d" xref="A1.I1.i5.p1.4.m4.5.5.4.cmml">​</mo><mrow id="A1.I1.i5.p1.4.m4.5.5.7.2" xref="A1.I1.i5.p1.4.m4.5.5.7.1.cmml"><mo stretchy="false" id="A1.I1.i5.p1.4.m4.5.5.7.2.1" xref="A1.I1.i5.p1.4.m4.5.5.7.1.1.cmml">[</mo><mi id="A1.I1.i5.p1.4.m4.2.2" xref="A1.I1.i5.p1.4.m4.2.2.cmml">𝚌𝚕𝚜</mi><mo stretchy="false" id="A1.I1.i5.p1.4.m4.5.5.7.2.2" xref="A1.I1.i5.p1.4.m4.5.5.7.1.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.I1.i5.p1.4.m4.5b"><apply id="A1.I1.i5.p1.4.m4.5.5.cmml" xref="A1.I1.i5.p1.4.m4.5.5"><times id="A1.I1.i5.p1.4.m4.5.5.4.cmml" xref="A1.I1.i5.p1.4.m4.5.5.4"></times><apply id="A1.I1.i5.p1.4.m4.3.3.1.2.cmml" xref="A1.I1.i5.p1.4.m4.3.3.1.1"><csymbol cd="latexml" id="A1.I1.i5.p1.4.m4.3.3.1.2.1.cmml" xref="A1.I1.i5.p1.4.m4.3.3.1.1.2">delimited-[]</csymbol><apply id="A1.I1.i5.p1.4.m4.3.3.1.1.1.cmml" xref="A1.I1.i5.p1.4.m4.3.3.1.1.1"><csymbol cd="ambiguous" id="A1.I1.i5.p1.4.m4.3.3.1.1.1.1.cmml" xref="A1.I1.i5.p1.4.m4.3.3.1.1.1">subscript</csymbol><ci id="A1.I1.i5.p1.4.m4.3.3.1.1.1.2.cmml" xref="A1.I1.i5.p1.4.m4.3.3.1.1.1.2">𝑉</ci><cn type="integer" id="A1.I1.i5.p1.4.m4.3.3.1.1.1.3.cmml" xref="A1.I1.i5.p1.4.m4.3.3.1.1.1.3">1</cn></apply></apply><apply id="A1.I1.i5.p1.4.m4.4.4.2.2.cmml" xref="A1.I1.i5.p1.4.m4.4.4.2.1"><csymbol cd="latexml" id="A1.I1.i5.p1.4.m4.4.4.2.2.1.cmml" xref="A1.I1.i5.p1.4.m4.4.4.2.1.2">delimited-[]</csymbol><apply id="A1.I1.i5.p1.4.m4.4.4.2.1.1.cmml" xref="A1.I1.i5.p1.4.m4.4.4.2.1.1"><csymbol cd="ambiguous" id="A1.I1.i5.p1.4.m4.4.4.2.1.1.1.cmml" xref="A1.I1.i5.p1.4.m4.4.4.2.1.1">subscript</csymbol><ci id="A1.I1.i5.p1.4.m4.4.4.2.1.1.2.cmml" xref="A1.I1.i5.p1.4.m4.4.4.2.1.1.2">𝑉</ci><cn type="integer" id="A1.I1.i5.p1.4.m4.4.4.2.1.1.3.cmml" xref="A1.I1.i5.p1.4.m4.4.4.2.1.1.3">2</cn></apply></apply><ci id="A1.I1.i5.p1.4.m4.5.5.5.cmml" xref="A1.I1.i5.p1.4.m4.5.5.5">…</ci><apply id="A1.I1.i5.p1.4.m4.5.5.3.2.cmml" xref="A1.I1.i5.p1.4.m4.5.5.3.1"><csymbol cd="latexml" id="A1.I1.i5.p1.4.m4.5.5.3.2.1.cmml" xref="A1.I1.i5.p1.4.m4.5.5.3.1.2">delimited-[]</csymbol><apply id="A1.I1.i5.p1.4.m4.5.5.3.1.1.cmml" xref="A1.I1.i5.p1.4.m4.5.5.3.1.1"><csymbol cd="ambiguous" id="A1.I1.i5.p1.4.m4.5.5.3.1.1.1.cmml" xref="A1.I1.i5.p1.4.m4.5.5.3.1.1">subscript</csymbol><ci id="A1.I1.i5.p1.4.m4.5.5.3.1.1.2.cmml" xref="A1.I1.i5.p1.4.m4.5.5.3.1.1.2">𝑉</ci><ci id="A1.I1.i5.p1.4.m4.5.5.3.1.1.3.cmml" xref="A1.I1.i5.p1.4.m4.5.5.3.1.1.3">𝑁</ci></apply></apply><apply id="A1.I1.i5.p1.4.m4.5.5.6.1.cmml" xref="A1.I1.i5.p1.4.m4.5.5.6.2"><csymbol cd="latexml" id="A1.I1.i5.p1.4.m4.5.5.6.1.1.cmml" xref="A1.I1.i5.p1.4.m4.5.5.6.2.1">delimited-[]</csymbol><ci id="A1.I1.i5.p1.4.m4.1.1.cmml" xref="A1.I1.i5.p1.4.m4.1.1">𝚊𝚗𝚘𝚖𝚊𝚕𝚘𝚞𝚜</ci></apply><apply id="A1.I1.i5.p1.4.m4.5.5.7.1.cmml" xref="A1.I1.i5.p1.4.m4.5.5.7.2"><csymbol cd="latexml" id="A1.I1.i5.p1.4.m4.5.5.7.1.1.cmml" xref="A1.I1.i5.p1.4.m4.5.5.7.2.1">delimited-[]</csymbol><ci id="A1.I1.i5.p1.4.m4.2.2.cmml" xref="A1.I1.i5.p1.4.m4.2.2">𝚌𝚕𝚜</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.I1.i5.p1.4.m4.5c">[V_{1}][V_{2}]...[V_{N}][\verb'anomalous'][\verb'cls']</annotation></semantics></math>. Anomaly probabilities and segmentation are obtained in the same way as for AnomalyCLIP. All parameters are kept the same as in their paper.</p>
</div>
</li>
</ul>
</div>
</section>
</section>
<section id="A2" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>Dataset</h2>

<figure id="A2.T3" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 3: </span>Key statistics on the datasets used.</figcaption>
<div id="A2.T3.1" class="ltx_inline-block ltx_transformed_outer" style="width:397.5pt;height:370.3pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-53.4pt,49.7pt) scale(0.788268438065301,0.788268438065301) ;">
<table id="A2.T3.1.1" class="ltx_tabular ltx_align_middle">
<tr id="A2.T3.1.1.1" class="ltx_tr">
<td id="A2.T3.1.1.1.2" class="ltx_td ltx_align_center ltx_border_tt">Dataset</td>
<td id="A2.T3.1.1.1.3" class="ltx_td ltx_align_center ltx_border_tt">Category</td>
<td id="A2.T3.1.1.1.4" class="ltx_td ltx_align_center ltx_border_tt">Modalities</td>
<td id="A2.T3.1.1.1.1" class="ltx_td ltx_align_center ltx_border_tt"><math id="A2.T3.1.1.1.1.m1.1" class="ltx_Math" alttext="|\mathcal{C}|" display="inline"><semantics id="A2.T3.1.1.1.1.m1.1a"><mrow id="A2.T3.1.1.1.1.m1.1.2.2" xref="A2.T3.1.1.1.1.m1.1.2.1.cmml"><mo stretchy="false" id="A2.T3.1.1.1.1.m1.1.2.2.1" xref="A2.T3.1.1.1.1.m1.1.2.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="A2.T3.1.1.1.1.m1.1.1" xref="A2.T3.1.1.1.1.m1.1.1.cmml">𝒞</mi><mo stretchy="false" id="A2.T3.1.1.1.1.m1.1.2.2.2" xref="A2.T3.1.1.1.1.m1.1.2.1.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="A2.T3.1.1.1.1.m1.1b"><apply id="A2.T3.1.1.1.1.m1.1.2.1.cmml" xref="A2.T3.1.1.1.1.m1.1.2.2"><abs id="A2.T3.1.1.1.1.m1.1.2.1.1.cmml" xref="A2.T3.1.1.1.1.m1.1.2.2.1"></abs><ci id="A2.T3.1.1.1.1.m1.1.1.cmml" xref="A2.T3.1.1.1.1.m1.1.1">𝒞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T3.1.1.1.1.m1.1c">|\mathcal{C}|</annotation></semantics></math></td>
<td id="A2.T3.1.1.1.5" class="ltx_td ltx_align_center ltx_border_tt">
<span id="A2.T3.1.1.1.5.1" class="ltx_text"></span> <span id="A2.T3.1.1.1.5.2" class="ltx_text">
<span id="A2.T3.1.1.1.5.2.1" class="ltx_tabular ltx_align_middle">
<span id="A2.T3.1.1.1.5.2.1.1" class="ltx_tr">
<span id="A2.T3.1.1.1.5.2.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">Normal and</span></span>
<span id="A2.T3.1.1.1.5.2.1.2" class="ltx_tr">
<span id="A2.T3.1.1.1.5.2.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center">anomalous samples</span></span>
</span></span><span id="A2.T3.1.1.1.5.3" class="ltx_text"></span></td>
<td id="A2.T3.1.1.1.6" class="ltx_td ltx_align_center ltx_border_tt">Usage</td>
</tr>
<tr id="A2.T3.1.1.2" class="ltx_tr">
<td id="A2.T3.1.1.2.1" class="ltx_td ltx_align_center ltx_border_t"><a target="_blank" href="https://www.mvtec.com/company/research/datasets/mvtec-ad" title="" class="ltx_ref ltx_href">MVTec AD</a></td>
<td id="A2.T3.1.1.2.2" class="ltx_td ltx_align_center ltx_border_t">
<span id="A2.T3.1.1.2.2.1" class="ltx_text"></span> <span id="A2.T3.1.1.2.2.2" class="ltx_text">
<span id="A2.T3.1.1.2.2.2.1" class="ltx_tabular ltx_align_middle">
<span id="A2.T3.1.1.2.2.2.1.1" class="ltx_tr">
<span id="A2.T3.1.1.2.2.2.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">Obj &amp;texture</span></span>
</span></span><span id="A2.T3.1.1.2.2.3" class="ltx_text"></span></td>
<td id="A2.T3.1.1.2.3" class="ltx_td ltx_align_center ltx_border_t">Photography</td>
<td id="A2.T3.1.1.2.4" class="ltx_td ltx_align_center ltx_border_t">15</td>
<td id="A2.T3.1.1.2.5" class="ltx_td ltx_align_center ltx_border_t">(467, 1258)</td>
<td id="A2.T3.1.1.2.6" class="ltx_td ltx_align_center ltx_border_t">Industrial defect detection</td>
</tr>
<tr id="A2.T3.1.1.3" class="ltx_tr">
<td id="A2.T3.1.1.3.1" class="ltx_td ltx_align_center ltx_border_t"><a target="_blank" href="https://github.com/amazon-science/spot-diff" title="" class="ltx_ref ltx_href">VisA</a></td>
<td id="A2.T3.1.1.3.2" class="ltx_td ltx_align_center ltx_border_t" rowspan="4"><span id="A2.T3.1.1.3.2.1" class="ltx_text">Obj</span></td>
<td id="A2.T3.1.1.3.3" class="ltx_td ltx_align_center ltx_border_t">Photography</td>
<td id="A2.T3.1.1.3.4" class="ltx_td ltx_align_center ltx_border_t">12</td>
<td id="A2.T3.1.1.3.5" class="ltx_td ltx_align_center ltx_border_t">(962, 1200)</td>
<td id="A2.T3.1.1.3.6" class="ltx_td ltx_align_center ltx_border_t">Industrial defect detection</td>
</tr>
<tr id="A2.T3.1.1.4" class="ltx_tr">
<td id="A2.T3.1.1.4.1" class="ltx_td ltx_align_center"><a target="_blank" href="https://github.com/amazon-science/spot-diff" title="" class="ltx_ref ltx_href">MPDD</a></td>
<td id="A2.T3.1.1.4.2" class="ltx_td ltx_align_center">Photography</td>
<td id="A2.T3.1.1.4.3" class="ltx_td ltx_align_center">6</td>
<td id="A2.T3.1.1.4.4" class="ltx_td ltx_align_center">(176, 282)</td>
<td id="A2.T3.1.1.4.5" class="ltx_td ltx_align_center">Industrial defect detection</td>
</tr>
<tr id="A2.T3.1.1.5" class="ltx_tr">
<td id="A2.T3.1.1.5.1" class="ltx_td ltx_align_center"><a target="_blank" href="http://avires.dimi.uniud.it/papers/btad/btad.zip" title="" class="ltx_ref ltx_href">BTAD</a></td>
<td id="A2.T3.1.1.5.2" class="ltx_td ltx_align_center">Photography</td>
<td id="A2.T3.1.1.5.3" class="ltx_td ltx_align_center">3</td>
<td id="A2.T3.1.1.5.4" class="ltx_td ltx_align_center">(451, 290)</td>
<td id="A2.T3.1.1.5.5" class="ltx_td ltx_align_center">Industrial defect detection</td>
</tr>
<tr id="A2.T3.1.1.6" class="ltx_tr">
<td id="A2.T3.1.1.6.1" class="ltx_td ltx_align_center"><a target="_blank" href="https://www.vicos.si/resources/kolektorsdd/" title="" class="ltx_ref ltx_href">SDD</a></td>
<td id="A2.T3.1.1.6.2" class="ltx_td ltx_align_center">Photography</td>
<td id="A2.T3.1.1.6.3" class="ltx_td ltx_align_center">1</td>
<td id="A2.T3.1.1.6.4" class="ltx_td ltx_align_center">(181, 74)</td>
<td id="A2.T3.1.1.6.5" class="ltx_td ltx_align_center">Industrial defect detection</td>
</tr>
<tr id="A2.T3.1.1.7" class="ltx_tr">
<td id="A2.T3.1.1.7.1" class="ltx_td ltx_align_center ltx_border_t"><a target="_blank" href="https://www.kaggle.com/datasets/mhskjelvareid/dagm-2007-competition-dataset-optical-inspection" title="" class="ltx_ref ltx_href">DAGM</a></td>
<td id="A2.T3.1.1.7.2" class="ltx_td ltx_align_center ltx_border_t" rowspan="2"><span id="A2.T3.1.1.7.2.1" class="ltx_text">Texture</span></td>
<td id="A2.T3.1.1.7.3" class="ltx_td ltx_align_center ltx_border_t">Photography</td>
<td id="A2.T3.1.1.7.4" class="ltx_td ltx_align_center ltx_border_t">10</td>
<td id="A2.T3.1.1.7.5" class="ltx_td ltx_align_center ltx_border_t">(6996, 1054)</td>
<td id="A2.T3.1.1.7.6" class="ltx_td ltx_align_center ltx_border_t">Industrial defect detection</td>
</tr>
<tr id="A2.T3.1.1.8" class="ltx_tr">
<td id="A2.T3.1.1.8.1" class="ltx_td ltx_align_center"><a target="_blank" href="https://drive.google.com/drive/folders/10OyPzvI3H6llCZBxKxFlKWt1Pw1tkMK1" title="" class="ltx_ref ltx_href">DTD-Synthetic</a></td>
<td id="A2.T3.1.1.8.2" class="ltx_td ltx_align_center">Photography</td>
<td id="A2.T3.1.1.8.3" class="ltx_td ltx_align_center">12</td>
<td id="A2.T3.1.1.8.4" class="ltx_td ltx_align_center">(357, 947)</td>
<td id="A2.T3.1.1.8.5" class="ltx_td ltx_align_center">Industrial defect detection</td>
</tr>
<tr id="A2.T3.1.1.9" class="ltx_tr">
<td id="A2.T3.1.1.9.1" class="ltx_td ltx_align_center ltx_border_t"><a target="_blank" href="https://isic-challenge-data.s3.amazonaws.com/2016/ISBI2016_ISIC_Part1_Test_Data.zip" title="" class="ltx_ref ltx_href">ISIC</a></td>
<td id="A2.T3.1.1.9.2" class="ltx_td ltx_align_center ltx_border_t">Skin</td>
<td id="A2.T3.1.1.9.3" class="ltx_td ltx_align_center ltx_border_t">Photography</td>
<td id="A2.T3.1.1.9.4" class="ltx_td ltx_align_center ltx_border_t">1</td>
<td id="A2.T3.1.1.9.5" class="ltx_td ltx_align_center ltx_border_t">(0, 379)</td>
<td id="A2.T3.1.1.9.6" class="ltx_td ltx_align_center ltx_border_t">Skin cancer detection</td>
</tr>
<tr id="A2.T3.1.1.10" class="ltx_tr">
<td id="A2.T3.1.1.10.1" class="ltx_td ltx_align_center ltx_border_t"><a target="_blank" href="https://figshare.com/articles/figure/Polyp_DataSet_zip/21221579" title="" class="ltx_ref ltx_href">CVC-ClinicDB</a></td>
<td id="A2.T3.1.1.10.2" class="ltx_td ltx_border_t"></td>
<td id="A2.T3.1.1.10.3" class="ltx_td ltx_align_center ltx_border_t">Endoscopy</td>
<td id="A2.T3.1.1.10.4" class="ltx_td ltx_align_center ltx_border_t">1</td>
<td id="A2.T3.1.1.10.5" class="ltx_td ltx_align_center ltx_border_t">(0, 612)</td>
<td id="A2.T3.1.1.10.6" class="ltx_td ltx_align_center ltx_border_t">Colon polyp detection</td>
</tr>
<tr id="A2.T3.1.1.11" class="ltx_tr">
<td id="A2.T3.1.1.11.1" class="ltx_td ltx_align_center"><a target="_blank" href="https://figshare.com/articles/figure/Polyp_DataSet_zip/21221579" title="" class="ltx_ref ltx_href">CVC-ColonDB</a></td>
<td id="A2.T3.1.1.11.2" class="ltx_td"></td>
<td id="A2.T3.1.1.11.3" class="ltx_td ltx_align_center">Endoscopy</td>
<td id="A2.T3.1.1.11.4" class="ltx_td ltx_align_center">1</td>
<td id="A2.T3.1.1.11.5" class="ltx_td ltx_align_center">(0, 380)</td>
<td id="A2.T3.1.1.11.6" class="ltx_td ltx_align_center">Colon polyp detection</td>
</tr>
<tr id="A2.T3.1.1.12" class="ltx_tr">
<td id="A2.T3.1.1.12.1" class="ltx_td ltx_align_center"><a target="_blank" href="https://figshare.com/articles/figure/Polyp_DataSet_zip/21221579" title="" class="ltx_ref ltx_href">Kvasir</a></td>
<td id="A2.T3.1.1.12.2" class="ltx_td"></td>
<td id="A2.T3.1.1.12.3" class="ltx_td ltx_align_center">Endoscopy</td>
<td id="A2.T3.1.1.12.4" class="ltx_td ltx_align_center">1</td>
<td id="A2.T3.1.1.12.5" class="ltx_td ltx_align_center">(0, 1000)</td>
<td id="A2.T3.1.1.12.6" class="ltx_td ltx_align_center">Colon polyp detection</td>
</tr>
<tr id="A2.T3.1.1.13" class="ltx_tr">
<td id="A2.T3.1.1.13.1" class="ltx_td ltx_align_center"><a target="_blank" href="https://drive.google.com/file/d/1LNpLkv5ZlEUzr_RPN5rdOHaqk0SkZa3m/view" title="" class="ltx_ref ltx_href">Endo</a></td>
<td id="A2.T3.1.1.13.2" class="ltx_td"></td>
<td id="A2.T3.1.1.13.3" class="ltx_td ltx_align_center">Endoscopy</td>
<td id="A2.T3.1.1.13.4" class="ltx_td ltx_align_center">1</td>
<td id="A2.T3.1.1.13.5" class="ltx_td ltx_align_center">(0, 200)</td>
<td id="A2.T3.1.1.13.6" class="ltx_td ltx_align_center">Colon polyp detection</td>
</tr>
<tr id="A2.T3.1.1.14" class="ltx_tr">
<td id="A2.T3.1.1.14.1" class="ltx_td ltx_align_center ltx_border_t"><a target="_blank" href="https://github.com/haifangong/TRFE-Net-for-thyroid-nodule-segmentation?tab=readme-ov-file" title="" class="ltx_ref ltx_href">TN3K</a></td>
<td id="A2.T3.1.1.14.2" class="ltx_td ltx_align_center ltx_border_t">Thyroid</td>
<td id="A2.T3.1.1.14.3" class="ltx_td ltx_align_center ltx_border_t">
<span id="A2.T3.1.1.14.3.1" class="ltx_text"></span> <span id="A2.T3.1.1.14.3.2" class="ltx_text">
<span id="A2.T3.1.1.14.3.2.1" class="ltx_tabular ltx_align_middle">
<span id="A2.T3.1.1.14.3.2.1.1" class="ltx_tr">
<span id="A2.T3.1.1.14.3.2.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">Radiology</span></span>
<span id="A2.T3.1.1.14.3.2.1.2" class="ltx_tr">
<span id="A2.T3.1.1.14.3.2.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center">(Utralsound)</span></span>
</span></span><span id="A2.T3.1.1.14.3.3" class="ltx_text"></span></td>
<td id="A2.T3.1.1.14.4" class="ltx_td ltx_align_center ltx_border_t">1</td>
<td id="A2.T3.1.1.14.5" class="ltx_td ltx_align_center ltx_border_t">(0, 614)</td>
<td id="A2.T3.1.1.14.6" class="ltx_td ltx_align_center ltx_border_t">Thyroid nodule detection</td>
</tr>
<tr id="A2.T3.1.1.15" class="ltx_tr">
<td id="A2.T3.1.1.15.1" class="ltx_td ltx_align_center ltx_border_t"><a target="_blank" href="https://www.kaggle.com/datasets/felipekitamura/head-ct-hemorrhage" title="" class="ltx_ref ltx_href">HeadCT</a></td>
<td id="A2.T3.1.1.15.2" class="ltx_td ltx_align_center ltx_border_t" rowspan="3"><span id="A2.T3.1.1.15.2.1" class="ltx_text">Brain</span></td>
<td id="A2.T3.1.1.15.3" class="ltx_td ltx_align_center ltx_border_t">
<span id="A2.T3.1.1.15.3.1" class="ltx_text"></span> <span id="A2.T3.1.1.15.3.2" class="ltx_text">
<span id="A2.T3.1.1.15.3.2.1" class="ltx_tabular ltx_align_middle">
<span id="A2.T3.1.1.15.3.2.1.1" class="ltx_tr">
<span id="A2.T3.1.1.15.3.2.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">Radiology</span></span>
<span id="A2.T3.1.1.15.3.2.1.2" class="ltx_tr">
<span id="A2.T3.1.1.15.3.2.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center">(CT)</span></span>
</span></span><span id="A2.T3.1.1.15.3.3" class="ltx_text"></span></td>
<td id="A2.T3.1.1.15.4" class="ltx_td ltx_align_center ltx_border_t">1</td>
<td id="A2.T3.1.1.15.5" class="ltx_td ltx_align_center ltx_border_t">(100, 100)</td>
<td id="A2.T3.1.1.15.6" class="ltx_td ltx_align_center ltx_border_t">Brain tumor detection</td>
</tr>
<tr id="A2.T3.1.1.16" class="ltx_tr">
<td id="A2.T3.1.1.16.1" class="ltx_td ltx_align_center"><a target="_blank" href="https://www.kaggle.com/datasets/navoneel/brain-mri-images-for-brain-tumor-detection" title="" class="ltx_ref ltx_href">BrainMRI</a></td>
<td id="A2.T3.1.1.16.2" class="ltx_td ltx_align_center">
<span id="A2.T3.1.1.16.2.1" class="ltx_text"></span> <span id="A2.T3.1.1.16.2.2" class="ltx_text">
<span id="A2.T3.1.1.16.2.2.1" class="ltx_tabular ltx_align_middle">
<span id="A2.T3.1.1.16.2.2.1.1" class="ltx_tr">
<span id="A2.T3.1.1.16.2.2.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">Radiology</span></span>
<span id="A2.T3.1.1.16.2.2.1.2" class="ltx_tr">
<span id="A2.T3.1.1.16.2.2.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center">(MRI)</span></span>
</span></span><span id="A2.T3.1.1.16.2.3" class="ltx_text"></span></td>
<td id="A2.T3.1.1.16.3" class="ltx_td ltx_align_center">1</td>
<td id="A2.T3.1.1.16.4" class="ltx_td ltx_align_center">(98, 155)</td>
<td id="A2.T3.1.1.16.5" class="ltx_td ltx_align_center">Brain tumor detection</td>
</tr>
<tr id="A2.T3.1.1.17" class="ltx_tr">
<td id="A2.T3.1.1.17.1" class="ltx_td ltx_align_center"><a target="_blank" href="https://www.kaggle.com/datasets/ahmedhamada0/brain-tumor-detection" title="" class="ltx_ref ltx_href">Br35H</a></td>
<td id="A2.T3.1.1.17.2" class="ltx_td ltx_align_center">
<span id="A2.T3.1.1.17.2.1" class="ltx_text"></span> <span id="A2.T3.1.1.17.2.2" class="ltx_text">
<span id="A2.T3.1.1.17.2.2.1" class="ltx_tabular ltx_align_middle">
<span id="A2.T3.1.1.17.2.2.1.1" class="ltx_tr">
<span id="A2.T3.1.1.17.2.2.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">Radiology</span></span>
<span id="A2.T3.1.1.17.2.2.1.2" class="ltx_tr">
<span id="A2.T3.1.1.17.2.2.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center">(MRI)</span></span>
</span></span><span id="A2.T3.1.1.17.2.3" class="ltx_text"></span></td>
<td id="A2.T3.1.1.17.3" class="ltx_td ltx_align_center">1</td>
<td id="A2.T3.1.1.17.4" class="ltx_td ltx_align_center">(1500, 1500)</td>
<td id="A2.T3.1.1.17.5" class="ltx_td ltx_align_center">Brain tumor detection</td>
</tr>
<tr id="A2.T3.1.1.18" class="ltx_tr">
<td id="A2.T3.1.1.18.1" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><a target="_blank" href="https://www.kaggle.com/datasets/tawsifurrahman/covid19-radiography-database" title="" class="ltx_ref ltx_href">COVID-19</a></td>
<td id="A2.T3.1.1.18.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">Chest</td>
<td id="A2.T3.1.1.18.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">
<span id="A2.T3.1.1.18.3.1" class="ltx_text"></span> <span id="A2.T3.1.1.18.3.2" class="ltx_text">
<span id="A2.T3.1.1.18.3.2.1" class="ltx_tabular ltx_align_middle">
<span id="A2.T3.1.1.18.3.2.1.1" class="ltx_tr">
<span id="A2.T3.1.1.18.3.2.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">Radiology</span></span>
<span id="A2.T3.1.1.18.3.2.1.2" class="ltx_tr">
<span id="A2.T3.1.1.18.3.2.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center">(X-ray)</span></span>
</span></span><span id="A2.T3.1.1.18.3.3" class="ltx_text"></span></td>
<td id="A2.T3.1.1.18.4" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">1</td>
<td id="A2.T3.1.1.18.5" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">(1341, 219)</td>
<td id="A2.T3.1.1.18.6" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">COVID-19 detection</td>
</tr>
</table>
</span></div>
</figure>
<section id="A2.SS0.SSS0.Px1" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">More dataset details</h5>

<div id="A2.SS0.SSS0.Px1.p1" class="ltx_para ltx_noindent">
<p id="A2.SS0.SSS0.Px1.p1.1" class="ltx_p">In this paper, we conduct extensive experiments on 17 public datasets spanning two domains and three modalities to validate the effectiveness of our methods. Since we just use the test data of Datasets, we present the relevant information of their test sets in Table <a href="#A2.T3" title="Table 3 ‣ Appendix B Dataset ‣ AnomalyCLIP: Object-agnostic Prompt Learning for Zero-shot Anomaly Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>.
We apply the default normalization of OpenCLIP to all datasets. After normalization, we resize the images to a resolution of (518, 518) to obtain an appropriate visual feature map resolution. It should be noted that the original image size of SDD has a width of 500 and a height ranging from 1,240 to 1,270. Before processing, we vertically divide the original 500 × 1,250 image into two images and assign pixel-wise annotations to each image.</p>
</div>
</section>
<section id="A2.SS0.SSS0.Px2" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Fine-tuning medical dataset</h5>

<div id="A2.SS0.SSS0.Px2.p1" class="ltx_para ltx_noindent">
<p id="A2.SS0.SSS0.Px2.p1.1" class="ltx_p">We cannot find publicly available 2D medical AD datasets that include both category labels and segmentation ground truths simultaneously. To fill the blank, in this paper, we create such a medical dataset by combining two existing 2D medical datasets. Particularly, we use the colon polyp detection dataset ColonDB <cite class="ltx_cite ltx_citemacro_citep">(Tajbakhsh et al., <a href="#bib.bib50" title="" class="ltx_ref">2015</a>)</cite> to provide pixel-level annotations. Meanwhile, considering the normal samples in the same domain, we choose the test split of Endo classification dataset <cite class="ltx_cite ltx_citemacro_citep">(Hicks et al., <a href="#bib.bib18" title="" class="ltx_ref">2021</a>)</cite> to combine with ColonDB. As a result, the new medical dataset contains 163 normal samples and 380 anomaly samples, supporting both anomaly classification and segmentation tasks.</p>
</div>
</section>
</section>
<section id="A3" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix" style="color:#FF8000;">
<span class="ltx_tag ltx_tag_appendix">Appendix C </span>Detailed Analysis of DPAM</h2>

<div id="A3.p1" class="ltx_para ltx_noindent">
<p id="A3.p1.4" class="ltx_p"><span id="A3.p1.4.1" class="ltx_text" style="color:#FF8000;">Since the visual encoder of CLIP is originally pre-trained to align
global object semantics, such as cat and dog, the contrastive loss used in CLIP makes the visual encoder produce a representative global embedding for recognizing semantic classes. Through the self-attention mechanism, the attention map in the visual encoder focuses on the specific tokens highlighted within the red rectangle in Fig. </span><a href="#S3.F3.sf2" title="In Figure 3 ‣ Refinement of the local visual space ‣ 3.3 Learning generic abnormality and normality prompts ‣ 3 AnomalyCLIP: object-agnostic prompt learning ‣ AnomalyCLIP: Object-agnostic Prompt Learning for Zero-shot Anomaly Detection" class="ltx_ref" style="color:#FF8000;"><span class="ltx_text ltx_ref_tag">3b</span></a><span id="A3.p1.4.2" class="ltx_text" style="color:#FF8000;">. Although these tokens may contribute to global object recognition, they disrupt the local visual semantics, which directly hinders the effective learning of the fine-grained abnormality in our object-agnostic text prompts. For segmentation purposes, it’s crucial for the visual feature map to emphasize the surrounding context to capture more local visual semantics.</span>
<br class="ltx_break"><span id="A3.p1.4.3" class="ltx_text" style="color:#FF8000;">Formally, let </span><math id="A3.p1.1.m1.1" class="ltx_Math" alttext="a_{ij}" display="inline"><semantics id="A3.p1.1.m1.1a"><msub id="A3.p1.1.m1.1.1" xref="A3.p1.1.m1.1.1.cmml"><mi mathcolor="#FF8000" id="A3.p1.1.m1.1.1.2" xref="A3.p1.1.m1.1.1.2.cmml">a</mi><mrow id="A3.p1.1.m1.1.1.3" xref="A3.p1.1.m1.1.1.3.cmml"><mi mathcolor="#FF8000" id="A3.p1.1.m1.1.1.3.2" xref="A3.p1.1.m1.1.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="A3.p1.1.m1.1.1.3.1" xref="A3.p1.1.m1.1.1.3.1.cmml">​</mo><mi mathcolor="#FF8000" id="A3.p1.1.m1.1.1.3.3" xref="A3.p1.1.m1.1.1.3.3.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="A3.p1.1.m1.1b"><apply id="A3.p1.1.m1.1.1.cmml" xref="A3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="A3.p1.1.m1.1.1.1.cmml" xref="A3.p1.1.m1.1.1">subscript</csymbol><ci id="A3.p1.1.m1.1.1.2.cmml" xref="A3.p1.1.m1.1.1.2">𝑎</ci><apply id="A3.p1.1.m1.1.1.3.cmml" xref="A3.p1.1.m1.1.1.3"><times id="A3.p1.1.m1.1.1.3.1.cmml" xref="A3.p1.1.m1.1.1.3.1"></times><ci id="A3.p1.1.m1.1.1.3.2.cmml" xref="A3.p1.1.m1.1.1.3.2">𝑖</ci><ci id="A3.p1.1.m1.1.1.3.3.cmml" xref="A3.p1.1.m1.1.1.3.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.1.m1.1c">a_{ij}</annotation></semantics></math><span id="A3.p1.4.4" class="ltx_text" style="color:#FF8000;"> be an attention score in the attention score matrix, where </span><math id="A3.p1.2.m2.4" class="ltx_Math" alttext="i,j\in[1,h\times w]" display="inline"><semantics id="A3.p1.2.m2.4a"><mrow id="A3.p1.2.m2.4.4" xref="A3.p1.2.m2.4.4.cmml"><mrow id="A3.p1.2.m2.4.4.3.2" xref="A3.p1.2.m2.4.4.3.1.cmml"><mi mathcolor="#FF8000" id="A3.p1.2.m2.2.2" xref="A3.p1.2.m2.2.2.cmml">i</mi><mo mathcolor="#FF8000" id="A3.p1.2.m2.4.4.3.2.1" xref="A3.p1.2.m2.4.4.3.1.cmml">,</mo><mi mathcolor="#FF8000" id="A3.p1.2.m2.3.3" xref="A3.p1.2.m2.3.3.cmml">j</mi></mrow><mo mathcolor="#FF8000" id="A3.p1.2.m2.4.4.2" xref="A3.p1.2.m2.4.4.2.cmml">∈</mo><mrow id="A3.p1.2.m2.4.4.1.1" xref="A3.p1.2.m2.4.4.1.2.cmml"><mo mathcolor="#FF8000" stretchy="false" id="A3.p1.2.m2.4.4.1.1.2" xref="A3.p1.2.m2.4.4.1.2.cmml">[</mo><mn mathcolor="#FF8000" id="A3.p1.2.m2.1.1" xref="A3.p1.2.m2.1.1.cmml">1</mn><mo mathcolor="#FF8000" id="A3.p1.2.m2.4.4.1.1.3" xref="A3.p1.2.m2.4.4.1.2.cmml">,</mo><mrow id="A3.p1.2.m2.4.4.1.1.1" xref="A3.p1.2.m2.4.4.1.1.1.cmml"><mi mathcolor="#FF8000" id="A3.p1.2.m2.4.4.1.1.1.2" xref="A3.p1.2.m2.4.4.1.1.1.2.cmml">h</mi><mo lspace="0.222em" mathcolor="#FF8000" rspace="0.222em" id="A3.p1.2.m2.4.4.1.1.1.1" xref="A3.p1.2.m2.4.4.1.1.1.1.cmml">×</mo><mi mathcolor="#FF8000" id="A3.p1.2.m2.4.4.1.1.1.3" xref="A3.p1.2.m2.4.4.1.1.1.3.cmml">w</mi></mrow><mo mathcolor="#FF8000" stretchy="false" id="A3.p1.2.m2.4.4.1.1.4" xref="A3.p1.2.m2.4.4.1.2.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.p1.2.m2.4b"><apply id="A3.p1.2.m2.4.4.cmml" xref="A3.p1.2.m2.4.4"><in id="A3.p1.2.m2.4.4.2.cmml" xref="A3.p1.2.m2.4.4.2"></in><list id="A3.p1.2.m2.4.4.3.1.cmml" xref="A3.p1.2.m2.4.4.3.2"><ci id="A3.p1.2.m2.2.2.cmml" xref="A3.p1.2.m2.2.2">𝑖</ci><ci id="A3.p1.2.m2.3.3.cmml" xref="A3.p1.2.m2.3.3">𝑗</ci></list><interval closure="closed" id="A3.p1.2.m2.4.4.1.2.cmml" xref="A3.p1.2.m2.4.4.1.1"><cn type="integer" id="A3.p1.2.m2.1.1.cmml" xref="A3.p1.2.m2.1.1">1</cn><apply id="A3.p1.2.m2.4.4.1.1.1.cmml" xref="A3.p1.2.m2.4.4.1.1.1"><times id="A3.p1.2.m2.4.4.1.1.1.1.cmml" xref="A3.p1.2.m2.4.4.1.1.1.1"></times><ci id="A3.p1.2.m2.4.4.1.1.1.2.cmml" xref="A3.p1.2.m2.4.4.1.1.1.2">ℎ</ci><ci id="A3.p1.2.m2.4.4.1.1.1.3.cmml" xref="A3.p1.2.m2.4.4.1.1.1.3">𝑤</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.2.m2.4c">i,j\in[1,h\times w]</annotation></semantics></math><span id="A3.p1.4.5" class="ltx_text" style="color:#FF8000;">, then the i-th output of </span><math id="A3.p1.3.m3.1" class="ltx_Math" alttext="Q" display="inline"><semantics id="A3.p1.3.m3.1a"><mi mathcolor="#FF8000" id="A3.p1.3.m3.1.1" xref="A3.p1.3.m3.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="A3.p1.3.m3.1b"><ci id="A3.p1.3.m3.1.1.cmml" xref="A3.p1.3.m3.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.3.m3.1c">Q</annotation></semantics></math><span id="A3.p1.4.6" class="ltx_text" style="color:#FF8000;">-</span><math id="A3.p1.4.m4.1" class="ltx_Math" alttext="K" display="inline"><semantics id="A3.p1.4.m4.1a"><mi mathcolor="#FF8000" id="A3.p1.4.m4.1.1" xref="A3.p1.4.m4.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="A3.p1.4.m4.1b"><ci id="A3.p1.4.m4.1.1.cmml" xref="A3.p1.4.m4.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.4.m4.1c">K</annotation></semantics></math><span id="A3.p1.4.7" class="ltx_text" style="color:#FF8000;"> attention can be written as:</span></p>
<table id="A3.Ex7" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="A3.Ex7.m1.5" class="ltx_Math" alttext="Attention({Q},{K},{V})_{i}=softmax\left(\frac{q_{i}K^{\top}}{\sqrt{D}}\right)V=\frac{\sum\limits_{j=1}^{n}a_{ij}v_{j}}{\sum\limits_{j=1}^{n}a_{ij}},\quad\quad a_{ij}=e^{\frac{q_{i}k_{j}^{\top}}{\sqrt{D}}}." display="block"><semantics id="A3.Ex7.m1.5a"><mrow id="A3.Ex7.m1.5.5.1"><mrow id="A3.Ex7.m1.5.5.1.1.2" xref="A3.Ex7.m1.5.5.1.1.3.cmml"><mrow id="A3.Ex7.m1.5.5.1.1.1.1" xref="A3.Ex7.m1.5.5.1.1.1.1.cmml"><mrow id="A3.Ex7.m1.5.5.1.1.1.1.2" xref="A3.Ex7.m1.5.5.1.1.1.1.2.cmml"><mi mathcolor="#FF8000" id="A3.Ex7.m1.5.5.1.1.1.1.2.2" xref="A3.Ex7.m1.5.5.1.1.1.1.2.2.cmml">A</mi><mo lspace="0em" rspace="0em" id="A3.Ex7.m1.5.5.1.1.1.1.2.1" xref="A3.Ex7.m1.5.5.1.1.1.1.2.1.cmml">​</mo><mi mathcolor="#FF8000" id="A3.Ex7.m1.5.5.1.1.1.1.2.3" xref="A3.Ex7.m1.5.5.1.1.1.1.2.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="A3.Ex7.m1.5.5.1.1.1.1.2.1a" xref="A3.Ex7.m1.5.5.1.1.1.1.2.1.cmml">​</mo><mi mathcolor="#FF8000" id="A3.Ex7.m1.5.5.1.1.1.1.2.4" xref="A3.Ex7.m1.5.5.1.1.1.1.2.4.cmml">t</mi><mo lspace="0em" rspace="0em" id="A3.Ex7.m1.5.5.1.1.1.1.2.1b" xref="A3.Ex7.m1.5.5.1.1.1.1.2.1.cmml">​</mo><mi mathcolor="#FF8000" id="A3.Ex7.m1.5.5.1.1.1.1.2.5" xref="A3.Ex7.m1.5.5.1.1.1.1.2.5.cmml">e</mi><mo lspace="0em" rspace="0em" id="A3.Ex7.m1.5.5.1.1.1.1.2.1c" xref="A3.Ex7.m1.5.5.1.1.1.1.2.1.cmml">​</mo><mi mathcolor="#FF8000" id="A3.Ex7.m1.5.5.1.1.1.1.2.6" xref="A3.Ex7.m1.5.5.1.1.1.1.2.6.cmml">n</mi><mo lspace="0em" rspace="0em" id="A3.Ex7.m1.5.5.1.1.1.1.2.1d" xref="A3.Ex7.m1.5.5.1.1.1.1.2.1.cmml">​</mo><mi mathcolor="#FF8000" id="A3.Ex7.m1.5.5.1.1.1.1.2.7" xref="A3.Ex7.m1.5.5.1.1.1.1.2.7.cmml">t</mi><mo lspace="0em" rspace="0em" id="A3.Ex7.m1.5.5.1.1.1.1.2.1e" xref="A3.Ex7.m1.5.5.1.1.1.1.2.1.cmml">​</mo><mi mathcolor="#FF8000" id="A3.Ex7.m1.5.5.1.1.1.1.2.8" xref="A3.Ex7.m1.5.5.1.1.1.1.2.8.cmml">i</mi><mo lspace="0em" rspace="0em" id="A3.Ex7.m1.5.5.1.1.1.1.2.1f" xref="A3.Ex7.m1.5.5.1.1.1.1.2.1.cmml">​</mo><mi mathcolor="#FF8000" id="A3.Ex7.m1.5.5.1.1.1.1.2.9" xref="A3.Ex7.m1.5.5.1.1.1.1.2.9.cmml">o</mi><mo lspace="0em" rspace="0em" id="A3.Ex7.m1.5.5.1.1.1.1.2.1g" xref="A3.Ex7.m1.5.5.1.1.1.1.2.1.cmml">​</mo><mi mathcolor="#FF8000" id="A3.Ex7.m1.5.5.1.1.1.1.2.10" xref="A3.Ex7.m1.5.5.1.1.1.1.2.10.cmml">n</mi><mo lspace="0em" rspace="0em" id="A3.Ex7.m1.5.5.1.1.1.1.2.1h" xref="A3.Ex7.m1.5.5.1.1.1.1.2.1.cmml">​</mo><msub id="A3.Ex7.m1.5.5.1.1.1.1.2.11" xref="A3.Ex7.m1.5.5.1.1.1.1.2.11.cmml"><mrow id="A3.Ex7.m1.5.5.1.1.1.1.2.11.2.2" xref="A3.Ex7.m1.5.5.1.1.1.1.2.11.2.1.cmml"><mo mathcolor="#FF8000" stretchy="false" id="A3.Ex7.m1.5.5.1.1.1.1.2.11.2.2.1" xref="A3.Ex7.m1.5.5.1.1.1.1.2.11.2.1.cmml">(</mo><mi mathcolor="#FF8000" id="A3.Ex7.m1.1.1" xref="A3.Ex7.m1.1.1.cmml">Q</mi><mo mathcolor="#FF8000" id="A3.Ex7.m1.5.5.1.1.1.1.2.11.2.2.2" xref="A3.Ex7.m1.5.5.1.1.1.1.2.11.2.1.cmml">,</mo><mi mathcolor="#FF8000" id="A3.Ex7.m1.2.2" xref="A3.Ex7.m1.2.2.cmml">K</mi><mo mathcolor="#FF8000" id="A3.Ex7.m1.5.5.1.1.1.1.2.11.2.2.3" xref="A3.Ex7.m1.5.5.1.1.1.1.2.11.2.1.cmml">,</mo><mi mathcolor="#FF8000" id="A3.Ex7.m1.3.3" xref="A3.Ex7.m1.3.3.cmml">V</mi><mo mathcolor="#FF8000" stretchy="false" id="A3.Ex7.m1.5.5.1.1.1.1.2.11.2.2.4" xref="A3.Ex7.m1.5.5.1.1.1.1.2.11.2.1.cmml">)</mo></mrow><mi mathcolor="#FF8000" id="A3.Ex7.m1.5.5.1.1.1.1.2.11.3" xref="A3.Ex7.m1.5.5.1.1.1.1.2.11.3.cmml">i</mi></msub></mrow><mo mathcolor="#FF8000" id="A3.Ex7.m1.5.5.1.1.1.1.3" xref="A3.Ex7.m1.5.5.1.1.1.1.3.cmml">=</mo><mrow id="A3.Ex7.m1.5.5.1.1.1.1.4" xref="A3.Ex7.m1.5.5.1.1.1.1.4.cmml"><mi mathcolor="#FF8000" id="A3.Ex7.m1.5.5.1.1.1.1.4.2" xref="A3.Ex7.m1.5.5.1.1.1.1.4.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="A3.Ex7.m1.5.5.1.1.1.1.4.1" xref="A3.Ex7.m1.5.5.1.1.1.1.4.1.cmml">​</mo><mi mathcolor="#FF8000" id="A3.Ex7.m1.5.5.1.1.1.1.4.3" xref="A3.Ex7.m1.5.5.1.1.1.1.4.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="A3.Ex7.m1.5.5.1.1.1.1.4.1a" xref="A3.Ex7.m1.5.5.1.1.1.1.4.1.cmml">​</mo><mi mathcolor="#FF8000" id="A3.Ex7.m1.5.5.1.1.1.1.4.4" xref="A3.Ex7.m1.5.5.1.1.1.1.4.4.cmml">f</mi><mo lspace="0em" rspace="0em" id="A3.Ex7.m1.5.5.1.1.1.1.4.1b" xref="A3.Ex7.m1.5.5.1.1.1.1.4.1.cmml">​</mo><mi mathcolor="#FF8000" id="A3.Ex7.m1.5.5.1.1.1.1.4.5" xref="A3.Ex7.m1.5.5.1.1.1.1.4.5.cmml">t</mi><mo lspace="0em" rspace="0em" id="A3.Ex7.m1.5.5.1.1.1.1.4.1c" xref="A3.Ex7.m1.5.5.1.1.1.1.4.1.cmml">​</mo><mi mathcolor="#FF8000" id="A3.Ex7.m1.5.5.1.1.1.1.4.6" xref="A3.Ex7.m1.5.5.1.1.1.1.4.6.cmml">m</mi><mo lspace="0em" rspace="0em" id="A3.Ex7.m1.5.5.1.1.1.1.4.1d" xref="A3.Ex7.m1.5.5.1.1.1.1.4.1.cmml">​</mo><mi mathcolor="#FF8000" id="A3.Ex7.m1.5.5.1.1.1.1.4.7" xref="A3.Ex7.m1.5.5.1.1.1.1.4.7.cmml">a</mi><mo lspace="0em" rspace="0em" id="A3.Ex7.m1.5.5.1.1.1.1.4.1e" xref="A3.Ex7.m1.5.5.1.1.1.1.4.1.cmml">​</mo><mi mathcolor="#FF8000" id="A3.Ex7.m1.5.5.1.1.1.1.4.8" xref="A3.Ex7.m1.5.5.1.1.1.1.4.8.cmml">x</mi><mo lspace="0em" rspace="0em" id="A3.Ex7.m1.5.5.1.1.1.1.4.1f" xref="A3.Ex7.m1.5.5.1.1.1.1.4.1.cmml">​</mo><mrow id="A3.Ex7.m1.5.5.1.1.1.1.4.9.2" xref="A3.Ex7.m1.4.4.cmml"><mo mathcolor="#FF8000" id="A3.Ex7.m1.5.5.1.1.1.1.4.9.2.1" xref="A3.Ex7.m1.4.4.cmml">(</mo><mfrac mathcolor="#FF8000" id="A3.Ex7.m1.4.4" xref="A3.Ex7.m1.4.4.cmml"><mrow id="A3.Ex7.m1.4.4.2" xref="A3.Ex7.m1.4.4.2.cmml"><msub id="A3.Ex7.m1.4.4.2.2" xref="A3.Ex7.m1.4.4.2.2.cmml"><mi mathcolor="#FF8000" id="A3.Ex7.m1.4.4.2.2.2" xref="A3.Ex7.m1.4.4.2.2.2.cmml">q</mi><mi mathcolor="#FF8000" id="A3.Ex7.m1.4.4.2.2.3" xref="A3.Ex7.m1.4.4.2.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="A3.Ex7.m1.4.4.2.1" xref="A3.Ex7.m1.4.4.2.1.cmml">​</mo><msup id="A3.Ex7.m1.4.4.2.3" xref="A3.Ex7.m1.4.4.2.3.cmml"><mi mathcolor="#FF8000" id="A3.Ex7.m1.4.4.2.3.2" xref="A3.Ex7.m1.4.4.2.3.2.cmml">K</mi><mo mathcolor="#FF8000" id="A3.Ex7.m1.4.4.2.3.3" xref="A3.Ex7.m1.4.4.2.3.3.cmml">⊤</mo></msup></mrow><msqrt mathcolor="#FF8000" id="A3.Ex7.m1.4.4.3" xref="A3.Ex7.m1.4.4.3.cmml"><mi mathcolor="#FF8000" id="A3.Ex7.m1.4.4.3.2" xref="A3.Ex7.m1.4.4.3.2.cmml">D</mi></msqrt></mfrac><mo mathcolor="#FF8000" id="A3.Ex7.m1.5.5.1.1.1.1.4.9.2.2" xref="A3.Ex7.m1.4.4.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="A3.Ex7.m1.5.5.1.1.1.1.4.1g" xref="A3.Ex7.m1.5.5.1.1.1.1.4.1.cmml">​</mo><mi mathcolor="#FF8000" id="A3.Ex7.m1.5.5.1.1.1.1.4.10" xref="A3.Ex7.m1.5.5.1.1.1.1.4.10.cmml">V</mi></mrow><mo mathcolor="#FF8000" id="A3.Ex7.m1.5.5.1.1.1.1.5" xref="A3.Ex7.m1.5.5.1.1.1.1.5.cmml">=</mo><mfrac mathcolor="#FF8000" id="A3.Ex7.m1.5.5.1.1.1.1.6" xref="A3.Ex7.m1.5.5.1.1.1.1.6.cmml"><mrow id="A3.Ex7.m1.5.5.1.1.1.1.6.2" xref="A3.Ex7.m1.5.5.1.1.1.1.6.2.cmml"><munderover id="A3.Ex7.m1.5.5.1.1.1.1.6.2.1" xref="A3.Ex7.m1.5.5.1.1.1.1.6.2.1.cmml"><mo mathcolor="#FF8000" movablelimits="false" id="A3.Ex7.m1.5.5.1.1.1.1.6.2.1.2.2" xref="A3.Ex7.m1.5.5.1.1.1.1.6.2.1.2.2.cmml">∑</mo><mrow id="A3.Ex7.m1.5.5.1.1.1.1.6.2.1.2.3" xref="A3.Ex7.m1.5.5.1.1.1.1.6.2.1.2.3.cmml"><mi mathcolor="#FF8000" id="A3.Ex7.m1.5.5.1.1.1.1.6.2.1.2.3.2" xref="A3.Ex7.m1.5.5.1.1.1.1.6.2.1.2.3.2.cmml">j</mi><mo mathcolor="#FF8000" id="A3.Ex7.m1.5.5.1.1.1.1.6.2.1.2.3.1" xref="A3.Ex7.m1.5.5.1.1.1.1.6.2.1.2.3.1.cmml">=</mo><mn mathcolor="#FF8000" id="A3.Ex7.m1.5.5.1.1.1.1.6.2.1.2.3.3" xref="A3.Ex7.m1.5.5.1.1.1.1.6.2.1.2.3.3.cmml">1</mn></mrow><mi mathcolor="#FF8000" id="A3.Ex7.m1.5.5.1.1.1.1.6.2.1.3" xref="A3.Ex7.m1.5.5.1.1.1.1.6.2.1.3.cmml">n</mi></munderover><mrow id="A3.Ex7.m1.5.5.1.1.1.1.6.2.2" xref="A3.Ex7.m1.5.5.1.1.1.1.6.2.2.cmml"><msub id="A3.Ex7.m1.5.5.1.1.1.1.6.2.2.2" xref="A3.Ex7.m1.5.5.1.1.1.1.6.2.2.2.cmml"><mi mathcolor="#FF8000" id="A3.Ex7.m1.5.5.1.1.1.1.6.2.2.2.2" xref="A3.Ex7.m1.5.5.1.1.1.1.6.2.2.2.2.cmml">a</mi><mrow id="A3.Ex7.m1.5.5.1.1.1.1.6.2.2.2.3" xref="A3.Ex7.m1.5.5.1.1.1.1.6.2.2.2.3.cmml"><mi mathcolor="#FF8000" id="A3.Ex7.m1.5.5.1.1.1.1.6.2.2.2.3.2" xref="A3.Ex7.m1.5.5.1.1.1.1.6.2.2.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="A3.Ex7.m1.5.5.1.1.1.1.6.2.2.2.3.1" xref="A3.Ex7.m1.5.5.1.1.1.1.6.2.2.2.3.1.cmml">​</mo><mi mathcolor="#FF8000" id="A3.Ex7.m1.5.5.1.1.1.1.6.2.2.2.3.3" xref="A3.Ex7.m1.5.5.1.1.1.1.6.2.2.2.3.3.cmml">j</mi></mrow></msub><mo lspace="0em" rspace="0em" id="A3.Ex7.m1.5.5.1.1.1.1.6.2.2.1" xref="A3.Ex7.m1.5.5.1.1.1.1.6.2.2.1.cmml">​</mo><msub id="A3.Ex7.m1.5.5.1.1.1.1.6.2.2.3" xref="A3.Ex7.m1.5.5.1.1.1.1.6.2.2.3.cmml"><mi mathcolor="#FF8000" id="A3.Ex7.m1.5.5.1.1.1.1.6.2.2.3.2" xref="A3.Ex7.m1.5.5.1.1.1.1.6.2.2.3.2.cmml">v</mi><mi mathcolor="#FF8000" id="A3.Ex7.m1.5.5.1.1.1.1.6.2.2.3.3" xref="A3.Ex7.m1.5.5.1.1.1.1.6.2.2.3.3.cmml">j</mi></msub></mrow></mrow><mrow id="A3.Ex7.m1.5.5.1.1.1.1.6.3" xref="A3.Ex7.m1.5.5.1.1.1.1.6.3.cmml"><munderover id="A3.Ex7.m1.5.5.1.1.1.1.6.3.1" xref="A3.Ex7.m1.5.5.1.1.1.1.6.3.1.cmml"><mo mathcolor="#FF8000" movablelimits="false" id="A3.Ex7.m1.5.5.1.1.1.1.6.3.1.2.2" xref="A3.Ex7.m1.5.5.1.1.1.1.6.3.1.2.2.cmml">∑</mo><mrow id="A3.Ex7.m1.5.5.1.1.1.1.6.3.1.2.3" xref="A3.Ex7.m1.5.5.1.1.1.1.6.3.1.2.3.cmml"><mi mathcolor="#FF8000" id="A3.Ex7.m1.5.5.1.1.1.1.6.3.1.2.3.2" xref="A3.Ex7.m1.5.5.1.1.1.1.6.3.1.2.3.2.cmml">j</mi><mo mathcolor="#FF8000" id="A3.Ex7.m1.5.5.1.1.1.1.6.3.1.2.3.1" xref="A3.Ex7.m1.5.5.1.1.1.1.6.3.1.2.3.1.cmml">=</mo><mn mathcolor="#FF8000" id="A3.Ex7.m1.5.5.1.1.1.1.6.3.1.2.3.3" xref="A3.Ex7.m1.5.5.1.1.1.1.6.3.1.2.3.3.cmml">1</mn></mrow><mi mathcolor="#FF8000" id="A3.Ex7.m1.5.5.1.1.1.1.6.3.1.3" xref="A3.Ex7.m1.5.5.1.1.1.1.6.3.1.3.cmml">n</mi></munderover><msub id="A3.Ex7.m1.5.5.1.1.1.1.6.3.2" xref="A3.Ex7.m1.5.5.1.1.1.1.6.3.2.cmml"><mi mathcolor="#FF8000" id="A3.Ex7.m1.5.5.1.1.1.1.6.3.2.2" xref="A3.Ex7.m1.5.5.1.1.1.1.6.3.2.2.cmml">a</mi><mrow id="A3.Ex7.m1.5.5.1.1.1.1.6.3.2.3" xref="A3.Ex7.m1.5.5.1.1.1.1.6.3.2.3.cmml"><mi mathcolor="#FF8000" id="A3.Ex7.m1.5.5.1.1.1.1.6.3.2.3.2" xref="A3.Ex7.m1.5.5.1.1.1.1.6.3.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="A3.Ex7.m1.5.5.1.1.1.1.6.3.2.3.1" xref="A3.Ex7.m1.5.5.1.1.1.1.6.3.2.3.1.cmml">​</mo><mi mathcolor="#FF8000" id="A3.Ex7.m1.5.5.1.1.1.1.6.3.2.3.3" xref="A3.Ex7.m1.5.5.1.1.1.1.6.3.2.3.3.cmml">j</mi></mrow></msub></mrow></mfrac></mrow><mo mathcolor="#FF8000" rspace="2.167em" id="A3.Ex7.m1.5.5.1.1.2.3" xref="A3.Ex7.m1.5.5.1.1.3a.cmml">,</mo><mrow id="A3.Ex7.m1.5.5.1.1.2.2" xref="A3.Ex7.m1.5.5.1.1.2.2.cmml"><msub id="A3.Ex7.m1.5.5.1.1.2.2.2" xref="A3.Ex7.m1.5.5.1.1.2.2.2.cmml"><mi mathcolor="#FF8000" id="A3.Ex7.m1.5.5.1.1.2.2.2.2" xref="A3.Ex7.m1.5.5.1.1.2.2.2.2.cmml">a</mi><mrow id="A3.Ex7.m1.5.5.1.1.2.2.2.3" xref="A3.Ex7.m1.5.5.1.1.2.2.2.3.cmml"><mi mathcolor="#FF8000" id="A3.Ex7.m1.5.5.1.1.2.2.2.3.2" xref="A3.Ex7.m1.5.5.1.1.2.2.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="A3.Ex7.m1.5.5.1.1.2.2.2.3.1" xref="A3.Ex7.m1.5.5.1.1.2.2.2.3.1.cmml">​</mo><mi mathcolor="#FF8000" id="A3.Ex7.m1.5.5.1.1.2.2.2.3.3" xref="A3.Ex7.m1.5.5.1.1.2.2.2.3.3.cmml">j</mi></mrow></msub><mo mathcolor="#FF8000" id="A3.Ex7.m1.5.5.1.1.2.2.1" xref="A3.Ex7.m1.5.5.1.1.2.2.1.cmml">=</mo><msup id="A3.Ex7.m1.5.5.1.1.2.2.3" xref="A3.Ex7.m1.5.5.1.1.2.2.3.cmml"><mi mathcolor="#FF8000" id="A3.Ex7.m1.5.5.1.1.2.2.3.2" xref="A3.Ex7.m1.5.5.1.1.2.2.3.2.cmml">e</mi><mfrac mathcolor="#FF8000" id="A3.Ex7.m1.5.5.1.1.2.2.3.3" xref="A3.Ex7.m1.5.5.1.1.2.2.3.3.cmml"><mrow id="A3.Ex7.m1.5.5.1.1.2.2.3.3.2" xref="A3.Ex7.m1.5.5.1.1.2.2.3.3.2.cmml"><msub id="A3.Ex7.m1.5.5.1.1.2.2.3.3.2.2" xref="A3.Ex7.m1.5.5.1.1.2.2.3.3.2.2.cmml"><mi mathcolor="#FF8000" id="A3.Ex7.m1.5.5.1.1.2.2.3.3.2.2.2" xref="A3.Ex7.m1.5.5.1.1.2.2.3.3.2.2.2.cmml">q</mi><mi mathcolor="#FF8000" id="A3.Ex7.m1.5.5.1.1.2.2.3.3.2.2.3" xref="A3.Ex7.m1.5.5.1.1.2.2.3.3.2.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="A3.Ex7.m1.5.5.1.1.2.2.3.3.2.1" xref="A3.Ex7.m1.5.5.1.1.2.2.3.3.2.1.cmml">​</mo><msubsup id="A3.Ex7.m1.5.5.1.1.2.2.3.3.2.3" xref="A3.Ex7.m1.5.5.1.1.2.2.3.3.2.3.cmml"><mi mathcolor="#FF8000" id="A3.Ex7.m1.5.5.1.1.2.2.3.3.2.3.2.2" xref="A3.Ex7.m1.5.5.1.1.2.2.3.3.2.3.2.2.cmml">k</mi><mi mathcolor="#FF8000" id="A3.Ex7.m1.5.5.1.1.2.2.3.3.2.3.2.3" xref="A3.Ex7.m1.5.5.1.1.2.2.3.3.2.3.2.3.cmml">j</mi><mo mathcolor="#FF8000" id="A3.Ex7.m1.5.5.1.1.2.2.3.3.2.3.3" xref="A3.Ex7.m1.5.5.1.1.2.2.3.3.2.3.3.cmml">⊤</mo></msubsup></mrow><msqrt mathcolor="#FF8000" id="A3.Ex7.m1.5.5.1.1.2.2.3.3.3" xref="A3.Ex7.m1.5.5.1.1.2.2.3.3.3.cmml"><mi mathcolor="#FF8000" id="A3.Ex7.m1.5.5.1.1.2.2.3.3.3.2" xref="A3.Ex7.m1.5.5.1.1.2.2.3.3.3.2.cmml">D</mi></msqrt></mfrac></msup></mrow></mrow><mo lspace="0em" mathcolor="#FF8000" id="A3.Ex7.m1.5.5.1.2">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A3.Ex7.m1.5b"><apply id="A3.Ex7.m1.5.5.1.1.3.cmml" xref="A3.Ex7.m1.5.5.1.1.2"><csymbol cd="ambiguous" id="A3.Ex7.m1.5.5.1.1.3a.cmml" xref="A3.Ex7.m1.5.5.1.1.2.3">formulae-sequence</csymbol><apply id="A3.Ex7.m1.5.5.1.1.1.1.cmml" xref="A3.Ex7.m1.5.5.1.1.1.1"><and id="A3.Ex7.m1.5.5.1.1.1.1a.cmml" xref="A3.Ex7.m1.5.5.1.1.1.1"></and><apply id="A3.Ex7.m1.5.5.1.1.1.1b.cmml" xref="A3.Ex7.m1.5.5.1.1.1.1"><eq id="A3.Ex7.m1.5.5.1.1.1.1.3.cmml" xref="A3.Ex7.m1.5.5.1.1.1.1.3"></eq><apply id="A3.Ex7.m1.5.5.1.1.1.1.2.cmml" xref="A3.Ex7.m1.5.5.1.1.1.1.2"><times id="A3.Ex7.m1.5.5.1.1.1.1.2.1.cmml" xref="A3.Ex7.m1.5.5.1.1.1.1.2.1"></times><ci id="A3.Ex7.m1.5.5.1.1.1.1.2.2.cmml" xref="A3.Ex7.m1.5.5.1.1.1.1.2.2">𝐴</ci><ci id="A3.Ex7.m1.5.5.1.1.1.1.2.3.cmml" xref="A3.Ex7.m1.5.5.1.1.1.1.2.3">𝑡</ci><ci id="A3.Ex7.m1.5.5.1.1.1.1.2.4.cmml" xref="A3.Ex7.m1.5.5.1.1.1.1.2.4">𝑡</ci><ci id="A3.Ex7.m1.5.5.1.1.1.1.2.5.cmml" xref="A3.Ex7.m1.5.5.1.1.1.1.2.5">𝑒</ci><ci id="A3.Ex7.m1.5.5.1.1.1.1.2.6.cmml" xref="A3.Ex7.m1.5.5.1.1.1.1.2.6">𝑛</ci><ci id="A3.Ex7.m1.5.5.1.1.1.1.2.7.cmml" xref="A3.Ex7.m1.5.5.1.1.1.1.2.7">𝑡</ci><ci id="A3.Ex7.m1.5.5.1.1.1.1.2.8.cmml" xref="A3.Ex7.m1.5.5.1.1.1.1.2.8">𝑖</ci><ci id="A3.Ex7.m1.5.5.1.1.1.1.2.9.cmml" xref="A3.Ex7.m1.5.5.1.1.1.1.2.9">𝑜</ci><ci id="A3.Ex7.m1.5.5.1.1.1.1.2.10.cmml" xref="A3.Ex7.m1.5.5.1.1.1.1.2.10">𝑛</ci><apply id="A3.Ex7.m1.5.5.1.1.1.1.2.11.cmml" xref="A3.Ex7.m1.5.5.1.1.1.1.2.11"><csymbol cd="ambiguous" id="A3.Ex7.m1.5.5.1.1.1.1.2.11.1.cmml" xref="A3.Ex7.m1.5.5.1.1.1.1.2.11">subscript</csymbol><vector id="A3.Ex7.m1.5.5.1.1.1.1.2.11.2.1.cmml" xref="A3.Ex7.m1.5.5.1.1.1.1.2.11.2.2"><ci id="A3.Ex7.m1.1.1.cmml" xref="A3.Ex7.m1.1.1">𝑄</ci><ci id="A3.Ex7.m1.2.2.cmml" xref="A3.Ex7.m1.2.2">𝐾</ci><ci id="A3.Ex7.m1.3.3.cmml" xref="A3.Ex7.m1.3.3">𝑉</ci></vector><ci id="A3.Ex7.m1.5.5.1.1.1.1.2.11.3.cmml" xref="A3.Ex7.m1.5.5.1.1.1.1.2.11.3">𝑖</ci></apply></apply><apply id="A3.Ex7.m1.5.5.1.1.1.1.4.cmml" xref="A3.Ex7.m1.5.5.1.1.1.1.4"><times id="A3.Ex7.m1.5.5.1.1.1.1.4.1.cmml" xref="A3.Ex7.m1.5.5.1.1.1.1.4.1"></times><ci id="A3.Ex7.m1.5.5.1.1.1.1.4.2.cmml" xref="A3.Ex7.m1.5.5.1.1.1.1.4.2">𝑠</ci><ci id="A3.Ex7.m1.5.5.1.1.1.1.4.3.cmml" xref="A3.Ex7.m1.5.5.1.1.1.1.4.3">𝑜</ci><ci id="A3.Ex7.m1.5.5.1.1.1.1.4.4.cmml" xref="A3.Ex7.m1.5.5.1.1.1.1.4.4">𝑓</ci><ci id="A3.Ex7.m1.5.5.1.1.1.1.4.5.cmml" xref="A3.Ex7.m1.5.5.1.1.1.1.4.5">𝑡</ci><ci id="A3.Ex7.m1.5.5.1.1.1.1.4.6.cmml" xref="A3.Ex7.m1.5.5.1.1.1.1.4.6">𝑚</ci><ci id="A3.Ex7.m1.5.5.1.1.1.1.4.7.cmml" xref="A3.Ex7.m1.5.5.1.1.1.1.4.7">𝑎</ci><ci id="A3.Ex7.m1.5.5.1.1.1.1.4.8.cmml" xref="A3.Ex7.m1.5.5.1.1.1.1.4.8">𝑥</ci><apply id="A3.Ex7.m1.4.4.cmml" xref="A3.Ex7.m1.5.5.1.1.1.1.4.9.2"><divide id="A3.Ex7.m1.4.4.1.cmml" xref="A3.Ex7.m1.5.5.1.1.1.1.4.9.2"></divide><apply id="A3.Ex7.m1.4.4.2.cmml" xref="A3.Ex7.m1.4.4.2"><times id="A3.Ex7.m1.4.4.2.1.cmml" xref="A3.Ex7.m1.4.4.2.1"></times><apply id="A3.Ex7.m1.4.4.2.2.cmml" xref="A3.Ex7.m1.4.4.2.2"><csymbol cd="ambiguous" id="A3.Ex7.m1.4.4.2.2.1.cmml" xref="A3.Ex7.m1.4.4.2.2">subscript</csymbol><ci id="A3.Ex7.m1.4.4.2.2.2.cmml" xref="A3.Ex7.m1.4.4.2.2.2">𝑞</ci><ci id="A3.Ex7.m1.4.4.2.2.3.cmml" xref="A3.Ex7.m1.4.4.2.2.3">𝑖</ci></apply><apply id="A3.Ex7.m1.4.4.2.3.cmml" xref="A3.Ex7.m1.4.4.2.3"><csymbol cd="ambiguous" id="A3.Ex7.m1.4.4.2.3.1.cmml" xref="A3.Ex7.m1.4.4.2.3">superscript</csymbol><ci id="A3.Ex7.m1.4.4.2.3.2.cmml" xref="A3.Ex7.m1.4.4.2.3.2">𝐾</ci><csymbol cd="latexml" id="A3.Ex7.m1.4.4.2.3.3.cmml" xref="A3.Ex7.m1.4.4.2.3.3">top</csymbol></apply></apply><apply id="A3.Ex7.m1.4.4.3.cmml" xref="A3.Ex7.m1.4.4.3"><root id="A3.Ex7.m1.4.4.3a.cmml" xref="A3.Ex7.m1.4.4.3"></root><ci id="A3.Ex7.m1.4.4.3.2.cmml" xref="A3.Ex7.m1.4.4.3.2">𝐷</ci></apply></apply><ci id="A3.Ex7.m1.5.5.1.1.1.1.4.10.cmml" xref="A3.Ex7.m1.5.5.1.1.1.1.4.10">𝑉</ci></apply></apply><apply id="A3.Ex7.m1.5.5.1.1.1.1c.cmml" xref="A3.Ex7.m1.5.5.1.1.1.1"><eq id="A3.Ex7.m1.5.5.1.1.1.1.5.cmml" xref="A3.Ex7.m1.5.5.1.1.1.1.5"></eq><share href="#A3.Ex7.m1.5.5.1.1.1.1.4.cmml" id="A3.Ex7.m1.5.5.1.1.1.1d.cmml" xref="A3.Ex7.m1.5.5.1.1.1.1"></share><apply id="A3.Ex7.m1.5.5.1.1.1.1.6.cmml" xref="A3.Ex7.m1.5.5.1.1.1.1.6"><divide id="A3.Ex7.m1.5.5.1.1.1.1.6.1.cmml" xref="A3.Ex7.m1.5.5.1.1.1.1.6"></divide><apply id="A3.Ex7.m1.5.5.1.1.1.1.6.2.cmml" xref="A3.Ex7.m1.5.5.1.1.1.1.6.2"><apply id="A3.Ex7.m1.5.5.1.1.1.1.6.2.1.cmml" xref="A3.Ex7.m1.5.5.1.1.1.1.6.2.1"><csymbol cd="ambiguous" id="A3.Ex7.m1.5.5.1.1.1.1.6.2.1.1.cmml" xref="A3.Ex7.m1.5.5.1.1.1.1.6.2.1">superscript</csymbol><apply id="A3.Ex7.m1.5.5.1.1.1.1.6.2.1.2.cmml" xref="A3.Ex7.m1.5.5.1.1.1.1.6.2.1"><csymbol cd="ambiguous" id="A3.Ex7.m1.5.5.1.1.1.1.6.2.1.2.1.cmml" xref="A3.Ex7.m1.5.5.1.1.1.1.6.2.1">subscript</csymbol><sum id="A3.Ex7.m1.5.5.1.1.1.1.6.2.1.2.2.cmml" xref="A3.Ex7.m1.5.5.1.1.1.1.6.2.1.2.2"></sum><apply id="A3.Ex7.m1.5.5.1.1.1.1.6.2.1.2.3.cmml" xref="A3.Ex7.m1.5.5.1.1.1.1.6.2.1.2.3"><eq id="A3.Ex7.m1.5.5.1.1.1.1.6.2.1.2.3.1.cmml" xref="A3.Ex7.m1.5.5.1.1.1.1.6.2.1.2.3.1"></eq><ci id="A3.Ex7.m1.5.5.1.1.1.1.6.2.1.2.3.2.cmml" xref="A3.Ex7.m1.5.5.1.1.1.1.6.2.1.2.3.2">𝑗</ci><cn type="integer" id="A3.Ex7.m1.5.5.1.1.1.1.6.2.1.2.3.3.cmml" xref="A3.Ex7.m1.5.5.1.1.1.1.6.2.1.2.3.3">1</cn></apply></apply><ci id="A3.Ex7.m1.5.5.1.1.1.1.6.2.1.3.cmml" xref="A3.Ex7.m1.5.5.1.1.1.1.6.2.1.3">𝑛</ci></apply><apply id="A3.Ex7.m1.5.5.1.1.1.1.6.2.2.cmml" xref="A3.Ex7.m1.5.5.1.1.1.1.6.2.2"><times id="A3.Ex7.m1.5.5.1.1.1.1.6.2.2.1.cmml" xref="A3.Ex7.m1.5.5.1.1.1.1.6.2.2.1"></times><apply id="A3.Ex7.m1.5.5.1.1.1.1.6.2.2.2.cmml" xref="A3.Ex7.m1.5.5.1.1.1.1.6.2.2.2"><csymbol cd="ambiguous" id="A3.Ex7.m1.5.5.1.1.1.1.6.2.2.2.1.cmml" xref="A3.Ex7.m1.5.5.1.1.1.1.6.2.2.2">subscript</csymbol><ci id="A3.Ex7.m1.5.5.1.1.1.1.6.2.2.2.2.cmml" xref="A3.Ex7.m1.5.5.1.1.1.1.6.2.2.2.2">𝑎</ci><apply id="A3.Ex7.m1.5.5.1.1.1.1.6.2.2.2.3.cmml" xref="A3.Ex7.m1.5.5.1.1.1.1.6.2.2.2.3"><times id="A3.Ex7.m1.5.5.1.1.1.1.6.2.2.2.3.1.cmml" xref="A3.Ex7.m1.5.5.1.1.1.1.6.2.2.2.3.1"></times><ci id="A3.Ex7.m1.5.5.1.1.1.1.6.2.2.2.3.2.cmml" xref="A3.Ex7.m1.5.5.1.1.1.1.6.2.2.2.3.2">𝑖</ci><ci id="A3.Ex7.m1.5.5.1.1.1.1.6.2.2.2.3.3.cmml" xref="A3.Ex7.m1.5.5.1.1.1.1.6.2.2.2.3.3">𝑗</ci></apply></apply><apply id="A3.Ex7.m1.5.5.1.1.1.1.6.2.2.3.cmml" xref="A3.Ex7.m1.5.5.1.1.1.1.6.2.2.3"><csymbol cd="ambiguous" id="A3.Ex7.m1.5.5.1.1.1.1.6.2.2.3.1.cmml" xref="A3.Ex7.m1.5.5.1.1.1.1.6.2.2.3">subscript</csymbol><ci id="A3.Ex7.m1.5.5.1.1.1.1.6.2.2.3.2.cmml" xref="A3.Ex7.m1.5.5.1.1.1.1.6.2.2.3.2">𝑣</ci><ci id="A3.Ex7.m1.5.5.1.1.1.1.6.2.2.3.3.cmml" xref="A3.Ex7.m1.5.5.1.1.1.1.6.2.2.3.3">𝑗</ci></apply></apply></apply><apply id="A3.Ex7.m1.5.5.1.1.1.1.6.3.cmml" xref="A3.Ex7.m1.5.5.1.1.1.1.6.3"><apply id="A3.Ex7.m1.5.5.1.1.1.1.6.3.1.cmml" xref="A3.Ex7.m1.5.5.1.1.1.1.6.3.1"><csymbol cd="ambiguous" id="A3.Ex7.m1.5.5.1.1.1.1.6.3.1.1.cmml" xref="A3.Ex7.m1.5.5.1.1.1.1.6.3.1">superscript</csymbol><apply id="A3.Ex7.m1.5.5.1.1.1.1.6.3.1.2.cmml" xref="A3.Ex7.m1.5.5.1.1.1.1.6.3.1"><csymbol cd="ambiguous" id="A3.Ex7.m1.5.5.1.1.1.1.6.3.1.2.1.cmml" xref="A3.Ex7.m1.5.5.1.1.1.1.6.3.1">subscript</csymbol><sum id="A3.Ex7.m1.5.5.1.1.1.1.6.3.1.2.2.cmml" xref="A3.Ex7.m1.5.5.1.1.1.1.6.3.1.2.2"></sum><apply id="A3.Ex7.m1.5.5.1.1.1.1.6.3.1.2.3.cmml" xref="A3.Ex7.m1.5.5.1.1.1.1.6.3.1.2.3"><eq id="A3.Ex7.m1.5.5.1.1.1.1.6.3.1.2.3.1.cmml" xref="A3.Ex7.m1.5.5.1.1.1.1.6.3.1.2.3.1"></eq><ci id="A3.Ex7.m1.5.5.1.1.1.1.6.3.1.2.3.2.cmml" xref="A3.Ex7.m1.5.5.1.1.1.1.6.3.1.2.3.2">𝑗</ci><cn type="integer" id="A3.Ex7.m1.5.5.1.1.1.1.6.3.1.2.3.3.cmml" xref="A3.Ex7.m1.5.5.1.1.1.1.6.3.1.2.3.3">1</cn></apply></apply><ci id="A3.Ex7.m1.5.5.1.1.1.1.6.3.1.3.cmml" xref="A3.Ex7.m1.5.5.1.1.1.1.6.3.1.3">𝑛</ci></apply><apply id="A3.Ex7.m1.5.5.1.1.1.1.6.3.2.cmml" xref="A3.Ex7.m1.5.5.1.1.1.1.6.3.2"><csymbol cd="ambiguous" id="A3.Ex7.m1.5.5.1.1.1.1.6.3.2.1.cmml" xref="A3.Ex7.m1.5.5.1.1.1.1.6.3.2">subscript</csymbol><ci id="A3.Ex7.m1.5.5.1.1.1.1.6.3.2.2.cmml" xref="A3.Ex7.m1.5.5.1.1.1.1.6.3.2.2">𝑎</ci><apply id="A3.Ex7.m1.5.5.1.1.1.1.6.3.2.3.cmml" xref="A3.Ex7.m1.5.5.1.1.1.1.6.3.2.3"><times id="A3.Ex7.m1.5.5.1.1.1.1.6.3.2.3.1.cmml" xref="A3.Ex7.m1.5.5.1.1.1.1.6.3.2.3.1"></times><ci id="A3.Ex7.m1.5.5.1.1.1.1.6.3.2.3.2.cmml" xref="A3.Ex7.m1.5.5.1.1.1.1.6.3.2.3.2">𝑖</ci><ci id="A3.Ex7.m1.5.5.1.1.1.1.6.3.2.3.3.cmml" xref="A3.Ex7.m1.5.5.1.1.1.1.6.3.2.3.3">𝑗</ci></apply></apply></apply></apply></apply></apply><apply id="A3.Ex7.m1.5.5.1.1.2.2.cmml" xref="A3.Ex7.m1.5.5.1.1.2.2"><eq id="A3.Ex7.m1.5.5.1.1.2.2.1.cmml" xref="A3.Ex7.m1.5.5.1.1.2.2.1"></eq><apply id="A3.Ex7.m1.5.5.1.1.2.2.2.cmml" xref="A3.Ex7.m1.5.5.1.1.2.2.2"><csymbol cd="ambiguous" id="A3.Ex7.m1.5.5.1.1.2.2.2.1.cmml" xref="A3.Ex7.m1.5.5.1.1.2.2.2">subscript</csymbol><ci id="A3.Ex7.m1.5.5.1.1.2.2.2.2.cmml" xref="A3.Ex7.m1.5.5.1.1.2.2.2.2">𝑎</ci><apply id="A3.Ex7.m1.5.5.1.1.2.2.2.3.cmml" xref="A3.Ex7.m1.5.5.1.1.2.2.2.3"><times id="A3.Ex7.m1.5.5.1.1.2.2.2.3.1.cmml" xref="A3.Ex7.m1.5.5.1.1.2.2.2.3.1"></times><ci id="A3.Ex7.m1.5.5.1.1.2.2.2.3.2.cmml" xref="A3.Ex7.m1.5.5.1.1.2.2.2.3.2">𝑖</ci><ci id="A3.Ex7.m1.5.5.1.1.2.2.2.3.3.cmml" xref="A3.Ex7.m1.5.5.1.1.2.2.2.3.3">𝑗</ci></apply></apply><apply id="A3.Ex7.m1.5.5.1.1.2.2.3.cmml" xref="A3.Ex7.m1.5.5.1.1.2.2.3"><csymbol cd="ambiguous" id="A3.Ex7.m1.5.5.1.1.2.2.3.1.cmml" xref="A3.Ex7.m1.5.5.1.1.2.2.3">superscript</csymbol><ci id="A3.Ex7.m1.5.5.1.1.2.2.3.2.cmml" xref="A3.Ex7.m1.5.5.1.1.2.2.3.2">𝑒</ci><apply id="A3.Ex7.m1.5.5.1.1.2.2.3.3.cmml" xref="A3.Ex7.m1.5.5.1.1.2.2.3.3"><divide id="A3.Ex7.m1.5.5.1.1.2.2.3.3.1.cmml" xref="A3.Ex7.m1.5.5.1.1.2.2.3.3"></divide><apply id="A3.Ex7.m1.5.5.1.1.2.2.3.3.2.cmml" xref="A3.Ex7.m1.5.5.1.1.2.2.3.3.2"><times id="A3.Ex7.m1.5.5.1.1.2.2.3.3.2.1.cmml" xref="A3.Ex7.m1.5.5.1.1.2.2.3.3.2.1"></times><apply id="A3.Ex7.m1.5.5.1.1.2.2.3.3.2.2.cmml" xref="A3.Ex7.m1.5.5.1.1.2.2.3.3.2.2"><csymbol cd="ambiguous" id="A3.Ex7.m1.5.5.1.1.2.2.3.3.2.2.1.cmml" xref="A3.Ex7.m1.5.5.1.1.2.2.3.3.2.2">subscript</csymbol><ci id="A3.Ex7.m1.5.5.1.1.2.2.3.3.2.2.2.cmml" xref="A3.Ex7.m1.5.5.1.1.2.2.3.3.2.2.2">𝑞</ci><ci id="A3.Ex7.m1.5.5.1.1.2.2.3.3.2.2.3.cmml" xref="A3.Ex7.m1.5.5.1.1.2.2.3.3.2.2.3">𝑖</ci></apply><apply id="A3.Ex7.m1.5.5.1.1.2.2.3.3.2.3.cmml" xref="A3.Ex7.m1.5.5.1.1.2.2.3.3.2.3"><csymbol cd="ambiguous" id="A3.Ex7.m1.5.5.1.1.2.2.3.3.2.3.1.cmml" xref="A3.Ex7.m1.5.5.1.1.2.2.3.3.2.3">superscript</csymbol><apply id="A3.Ex7.m1.5.5.1.1.2.2.3.3.2.3.2.cmml" xref="A3.Ex7.m1.5.5.1.1.2.2.3.3.2.3"><csymbol cd="ambiguous" id="A3.Ex7.m1.5.5.1.1.2.2.3.3.2.3.2.1.cmml" xref="A3.Ex7.m1.5.5.1.1.2.2.3.3.2.3">subscript</csymbol><ci id="A3.Ex7.m1.5.5.1.1.2.2.3.3.2.3.2.2.cmml" xref="A3.Ex7.m1.5.5.1.1.2.2.3.3.2.3.2.2">𝑘</ci><ci id="A3.Ex7.m1.5.5.1.1.2.2.3.3.2.3.2.3.cmml" xref="A3.Ex7.m1.5.5.1.1.2.2.3.3.2.3.2.3">𝑗</ci></apply><csymbol cd="latexml" id="A3.Ex7.m1.5.5.1.1.2.2.3.3.2.3.3.cmml" xref="A3.Ex7.m1.5.5.1.1.2.2.3.3.2.3.3">top</csymbol></apply></apply><apply id="A3.Ex7.m1.5.5.1.1.2.2.3.3.3.cmml" xref="A3.Ex7.m1.5.5.1.1.2.2.3.3.3"><root id="A3.Ex7.m1.5.5.1.1.2.2.3.3.3a.cmml" xref="A3.Ex7.m1.5.5.1.1.2.2.3.3.3"></root><ci id="A3.Ex7.m1.5.5.1.1.2.2.3.3.3.2.cmml" xref="A3.Ex7.m1.5.5.1.1.2.2.3.3.3.2">𝐷</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.Ex7.m1.5c">Attention({Q},{K},{V})_{i}=softmax\left(\frac{q_{i}K^{\top}}{\sqrt{D}}\right)V=\frac{\sum\limits_{j=1}^{n}a_{ij}v_{j}}{\sum\limits_{j=1}^{n}a_{ij}},\quad\quad a_{ij}=e^{\frac{q_{i}k_{j}^{\top}}{\sqrt{D}}}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="A3.p1.34" class="ltx_p"><span id="A3.p1.34.1" class="ltx_text" style="color:#FF8000;">Note that vectors (i.e., </span><math id="A3.p1.5.m1.1" class="ltx_Math" alttext="q_{i}" display="inline"><semantics id="A3.p1.5.m1.1a"><msub id="A3.p1.5.m1.1.1" xref="A3.p1.5.m1.1.1.cmml"><mi mathcolor="#FF8000" id="A3.p1.5.m1.1.1.2" xref="A3.p1.5.m1.1.1.2.cmml">q</mi><mi mathcolor="#FF8000" id="A3.p1.5.m1.1.1.3" xref="A3.p1.5.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A3.p1.5.m1.1b"><apply id="A3.p1.5.m1.1.1.cmml" xref="A3.p1.5.m1.1.1"><csymbol cd="ambiguous" id="A3.p1.5.m1.1.1.1.cmml" xref="A3.p1.5.m1.1.1">subscript</csymbol><ci id="A3.p1.5.m1.1.1.2.cmml" xref="A3.p1.5.m1.1.1.2">𝑞</ci><ci id="A3.p1.5.m1.1.1.3.cmml" xref="A3.p1.5.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.5.m1.1c">q_{i}</annotation></semantics></math><span id="A3.p1.34.2" class="ltx_text" style="color:#FF8000;">, </span><math id="A3.p1.6.m2.1" class="ltx_Math" alttext="k_{i}" display="inline"><semantics id="A3.p1.6.m2.1a"><msub id="A3.p1.6.m2.1.1" xref="A3.p1.6.m2.1.1.cmml"><mi mathcolor="#FF8000" id="A3.p1.6.m2.1.1.2" xref="A3.p1.6.m2.1.1.2.cmml">k</mi><mi mathcolor="#FF8000" id="A3.p1.6.m2.1.1.3" xref="A3.p1.6.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A3.p1.6.m2.1b"><apply id="A3.p1.6.m2.1.1.cmml" xref="A3.p1.6.m2.1.1"><csymbol cd="ambiguous" id="A3.p1.6.m2.1.1.1.cmml" xref="A3.p1.6.m2.1.1">subscript</csymbol><ci id="A3.p1.6.m2.1.1.2.cmml" xref="A3.p1.6.m2.1.1.2">𝑘</ci><ci id="A3.p1.6.m2.1.1.3.cmml" xref="A3.p1.6.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.6.m2.1c">k_{i}</annotation></semantics></math><span id="A3.p1.34.3" class="ltx_text" style="color:#FF8000;">, </span><math id="A3.p1.7.m3.1" class="ltx_Math" alttext="v_{i}" display="inline"><semantics id="A3.p1.7.m3.1a"><msub id="A3.p1.7.m3.1.1" xref="A3.p1.7.m3.1.1.cmml"><mi mathcolor="#FF8000" id="A3.p1.7.m3.1.1.2" xref="A3.p1.7.m3.1.1.2.cmml">v</mi><mi mathcolor="#FF8000" id="A3.p1.7.m3.1.1.3" xref="A3.p1.7.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A3.p1.7.m3.1b"><apply id="A3.p1.7.m3.1.1.cmml" xref="A3.p1.7.m3.1.1"><csymbol cd="ambiguous" id="A3.p1.7.m3.1.1.1.cmml" xref="A3.p1.7.m3.1.1">subscript</csymbol><ci id="A3.p1.7.m3.1.1.2.cmml" xref="A3.p1.7.m3.1.1.2">𝑣</ci><ci id="A3.p1.7.m3.1.1.3.cmml" xref="A3.p1.7.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.7.m3.1c">v_{i}</annotation></semantics></math><span id="A3.p1.34.4" class="ltx_text" style="color:#FF8000;">) are represented as row vectors. </span><math id="A3.p1.8.m4.3" class="ltx_Math" alttext="Attention({Q},{K},{V})_{i}" display="inline"><semantics id="A3.p1.8.m4.3a"><mrow id="A3.p1.8.m4.3.4" xref="A3.p1.8.m4.3.4.cmml"><mi mathcolor="#FF8000" id="A3.p1.8.m4.3.4.2" xref="A3.p1.8.m4.3.4.2.cmml">A</mi><mo lspace="0em" rspace="0em" id="A3.p1.8.m4.3.4.1" xref="A3.p1.8.m4.3.4.1.cmml">​</mo><mi mathcolor="#FF8000" id="A3.p1.8.m4.3.4.3" xref="A3.p1.8.m4.3.4.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="A3.p1.8.m4.3.4.1a" xref="A3.p1.8.m4.3.4.1.cmml">​</mo><mi mathcolor="#FF8000" id="A3.p1.8.m4.3.4.4" xref="A3.p1.8.m4.3.4.4.cmml">t</mi><mo lspace="0em" rspace="0em" id="A3.p1.8.m4.3.4.1b" xref="A3.p1.8.m4.3.4.1.cmml">​</mo><mi mathcolor="#FF8000" id="A3.p1.8.m4.3.4.5" xref="A3.p1.8.m4.3.4.5.cmml">e</mi><mo lspace="0em" rspace="0em" id="A3.p1.8.m4.3.4.1c" xref="A3.p1.8.m4.3.4.1.cmml">​</mo><mi mathcolor="#FF8000" id="A3.p1.8.m4.3.4.6" xref="A3.p1.8.m4.3.4.6.cmml">n</mi><mo lspace="0em" rspace="0em" id="A3.p1.8.m4.3.4.1d" xref="A3.p1.8.m4.3.4.1.cmml">​</mo><mi mathcolor="#FF8000" id="A3.p1.8.m4.3.4.7" xref="A3.p1.8.m4.3.4.7.cmml">t</mi><mo lspace="0em" rspace="0em" id="A3.p1.8.m4.3.4.1e" xref="A3.p1.8.m4.3.4.1.cmml">​</mo><mi mathcolor="#FF8000" id="A3.p1.8.m4.3.4.8" xref="A3.p1.8.m4.3.4.8.cmml">i</mi><mo lspace="0em" rspace="0em" id="A3.p1.8.m4.3.4.1f" xref="A3.p1.8.m4.3.4.1.cmml">​</mo><mi mathcolor="#FF8000" id="A3.p1.8.m4.3.4.9" xref="A3.p1.8.m4.3.4.9.cmml">o</mi><mo lspace="0em" rspace="0em" id="A3.p1.8.m4.3.4.1g" xref="A3.p1.8.m4.3.4.1.cmml">​</mo><mi mathcolor="#FF8000" id="A3.p1.8.m4.3.4.10" xref="A3.p1.8.m4.3.4.10.cmml">n</mi><mo lspace="0em" rspace="0em" id="A3.p1.8.m4.3.4.1h" xref="A3.p1.8.m4.3.4.1.cmml">​</mo><msub id="A3.p1.8.m4.3.4.11" xref="A3.p1.8.m4.3.4.11.cmml"><mrow id="A3.p1.8.m4.3.4.11.2.2" xref="A3.p1.8.m4.3.4.11.2.1.cmml"><mo mathcolor="#FF8000" stretchy="false" id="A3.p1.8.m4.3.4.11.2.2.1" xref="A3.p1.8.m4.3.4.11.2.1.cmml">(</mo><mi mathcolor="#FF8000" id="A3.p1.8.m4.1.1" xref="A3.p1.8.m4.1.1.cmml">Q</mi><mo mathcolor="#FF8000" id="A3.p1.8.m4.3.4.11.2.2.2" xref="A3.p1.8.m4.3.4.11.2.1.cmml">,</mo><mi mathcolor="#FF8000" id="A3.p1.8.m4.2.2" xref="A3.p1.8.m4.2.2.cmml">K</mi><mo mathcolor="#FF8000" id="A3.p1.8.m4.3.4.11.2.2.3" xref="A3.p1.8.m4.3.4.11.2.1.cmml">,</mo><mi mathcolor="#FF8000" id="A3.p1.8.m4.3.3" xref="A3.p1.8.m4.3.3.cmml">V</mi><mo mathcolor="#FF8000" stretchy="false" id="A3.p1.8.m4.3.4.11.2.2.4" xref="A3.p1.8.m4.3.4.11.2.1.cmml">)</mo></mrow><mi mathcolor="#FF8000" id="A3.p1.8.m4.3.4.11.3" xref="A3.p1.8.m4.3.4.11.3.cmml">i</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="A3.p1.8.m4.3b"><apply id="A3.p1.8.m4.3.4.cmml" xref="A3.p1.8.m4.3.4"><times id="A3.p1.8.m4.3.4.1.cmml" xref="A3.p1.8.m4.3.4.1"></times><ci id="A3.p1.8.m4.3.4.2.cmml" xref="A3.p1.8.m4.3.4.2">𝐴</ci><ci id="A3.p1.8.m4.3.4.3.cmml" xref="A3.p1.8.m4.3.4.3">𝑡</ci><ci id="A3.p1.8.m4.3.4.4.cmml" xref="A3.p1.8.m4.3.4.4">𝑡</ci><ci id="A3.p1.8.m4.3.4.5.cmml" xref="A3.p1.8.m4.3.4.5">𝑒</ci><ci id="A3.p1.8.m4.3.4.6.cmml" xref="A3.p1.8.m4.3.4.6">𝑛</ci><ci id="A3.p1.8.m4.3.4.7.cmml" xref="A3.p1.8.m4.3.4.7">𝑡</ci><ci id="A3.p1.8.m4.3.4.8.cmml" xref="A3.p1.8.m4.3.4.8">𝑖</ci><ci id="A3.p1.8.m4.3.4.9.cmml" xref="A3.p1.8.m4.3.4.9">𝑜</ci><ci id="A3.p1.8.m4.3.4.10.cmml" xref="A3.p1.8.m4.3.4.10">𝑛</ci><apply id="A3.p1.8.m4.3.4.11.cmml" xref="A3.p1.8.m4.3.4.11"><csymbol cd="ambiguous" id="A3.p1.8.m4.3.4.11.1.cmml" xref="A3.p1.8.m4.3.4.11">subscript</csymbol><vector id="A3.p1.8.m4.3.4.11.2.1.cmml" xref="A3.p1.8.m4.3.4.11.2.2"><ci id="A3.p1.8.m4.1.1.cmml" xref="A3.p1.8.m4.1.1">𝑄</ci><ci id="A3.p1.8.m4.2.2.cmml" xref="A3.p1.8.m4.2.2">𝐾</ci><ci id="A3.p1.8.m4.3.3.cmml" xref="A3.p1.8.m4.3.3">𝑉</ci></vector><ci id="A3.p1.8.m4.3.4.11.3.cmml" xref="A3.p1.8.m4.3.4.11.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.8.m4.3c">Attention({Q},{K},{V})_{i}</annotation></semantics></math><span id="A3.p1.34.5" class="ltx_text" style="color:#FF8000;"> can be regarded as the weighted average of </span><math id="A3.p1.9.m5.1" class="ltx_Math" alttext="v_{j}" display="inline"><semantics id="A3.p1.9.m5.1a"><msub id="A3.p1.9.m5.1.1" xref="A3.p1.9.m5.1.1.cmml"><mi mathcolor="#FF8000" id="A3.p1.9.m5.1.1.2" xref="A3.p1.9.m5.1.1.2.cmml">v</mi><mi mathcolor="#FF8000" id="A3.p1.9.m5.1.1.3" xref="A3.p1.9.m5.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="A3.p1.9.m5.1b"><apply id="A3.p1.9.m5.1.1.cmml" xref="A3.p1.9.m5.1.1"><csymbol cd="ambiguous" id="A3.p1.9.m5.1.1.1.cmml" xref="A3.p1.9.m5.1.1">subscript</csymbol><ci id="A3.p1.9.m5.1.1.2.cmml" xref="A3.p1.9.m5.1.1.2">𝑣</ci><ci id="A3.p1.9.m5.1.1.3.cmml" xref="A3.p1.9.m5.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.9.m5.1c">v_{j}</annotation></semantics></math><span id="A3.p1.34.6" class="ltx_text" style="color:#FF8000;"> using </span><math id="A3.p1.10.m6.1" class="ltx_Math" alttext="a_{ij}" display="inline"><semantics id="A3.p1.10.m6.1a"><msub id="A3.p1.10.m6.1.1" xref="A3.p1.10.m6.1.1.cmml"><mi mathcolor="#FF8000" id="A3.p1.10.m6.1.1.2" xref="A3.p1.10.m6.1.1.2.cmml">a</mi><mrow id="A3.p1.10.m6.1.1.3" xref="A3.p1.10.m6.1.1.3.cmml"><mi mathcolor="#FF8000" id="A3.p1.10.m6.1.1.3.2" xref="A3.p1.10.m6.1.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="A3.p1.10.m6.1.1.3.1" xref="A3.p1.10.m6.1.1.3.1.cmml">​</mo><mi mathcolor="#FF8000" id="A3.p1.10.m6.1.1.3.3" xref="A3.p1.10.m6.1.1.3.3.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="A3.p1.10.m6.1b"><apply id="A3.p1.10.m6.1.1.cmml" xref="A3.p1.10.m6.1.1"><csymbol cd="ambiguous" id="A3.p1.10.m6.1.1.1.cmml" xref="A3.p1.10.m6.1.1">subscript</csymbol><ci id="A3.p1.10.m6.1.1.2.cmml" xref="A3.p1.10.m6.1.1.2">𝑎</ci><apply id="A3.p1.10.m6.1.1.3.cmml" xref="A3.p1.10.m6.1.1.3"><times id="A3.p1.10.m6.1.1.3.1.cmml" xref="A3.p1.10.m6.1.1.3.1"></times><ci id="A3.p1.10.m6.1.1.3.2.cmml" xref="A3.p1.10.m6.1.1.3.2">𝑖</ci><ci id="A3.p1.10.m6.1.1.3.3.cmml" xref="A3.p1.10.m6.1.1.3.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.10.m6.1c">a_{ij}</annotation></semantics></math><span id="A3.p1.34.7" class="ltx_text" style="color:#FF8000;"> as the weight. Assuming that the original attention map focuses on the specific tokens at index </span><math id="A3.p1.11.m7.1" class="ltx_Math" alttext="m" display="inline"><semantics id="A3.p1.11.m7.1a"><mi mathcolor="#FF8000" id="A3.p1.11.m7.1.1" xref="A3.p1.11.m7.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="A3.p1.11.m7.1b"><ci id="A3.p1.11.m7.1.1.cmml" xref="A3.p1.11.m7.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.11.m7.1c">m</annotation></semantics></math><span id="A3.p1.34.8" class="ltx_text" style="color:#FF8000;">, it is clear that </span><math id="A3.p1.12.m8.1" class="ltx_Math" alttext="q_{i}" display="inline"><semantics id="A3.p1.12.m8.1a"><msub id="A3.p1.12.m8.1.1" xref="A3.p1.12.m8.1.1.cmml"><mi mathcolor="#FF8000" id="A3.p1.12.m8.1.1.2" xref="A3.p1.12.m8.1.1.2.cmml">q</mi><mi mathcolor="#FF8000" id="A3.p1.12.m8.1.1.3" xref="A3.p1.12.m8.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A3.p1.12.m8.1b"><apply id="A3.p1.12.m8.1.1.cmml" xref="A3.p1.12.m8.1.1"><csymbol cd="ambiguous" id="A3.p1.12.m8.1.1.1.cmml" xref="A3.p1.12.m8.1.1">subscript</csymbol><ci id="A3.p1.12.m8.1.1.2.cmml" xref="A3.p1.12.m8.1.1.2">𝑞</ci><ci id="A3.p1.12.m8.1.1.3.cmml" xref="A3.p1.12.m8.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.12.m8.1c">q_{i}</annotation></semantics></math><span id="A3.p1.34.9" class="ltx_text" style="color:#FF8000;"> only produces the large attention score with </span><math id="A3.p1.13.m9.1" class="ltx_Math" alttext="k_{m}" display="inline"><semantics id="A3.p1.13.m9.1a"><msub id="A3.p1.13.m9.1.1" xref="A3.p1.13.m9.1.1.cmml"><mi mathcolor="#FF8000" id="A3.p1.13.m9.1.1.2" xref="A3.p1.13.m9.1.1.2.cmml">k</mi><mi mathcolor="#FF8000" id="A3.p1.13.m9.1.1.3" xref="A3.p1.13.m9.1.1.3.cmml">m</mi></msub><annotation-xml encoding="MathML-Content" id="A3.p1.13.m9.1b"><apply id="A3.p1.13.m9.1.1.cmml" xref="A3.p1.13.m9.1.1"><csymbol cd="ambiguous" id="A3.p1.13.m9.1.1.1.cmml" xref="A3.p1.13.m9.1.1">subscript</csymbol><ci id="A3.p1.13.m9.1.1.2.cmml" xref="A3.p1.13.m9.1.1.2">𝑘</ci><ci id="A3.p1.13.m9.1.1.3.cmml" xref="A3.p1.13.m9.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.13.m9.1c">k_{m}</annotation></semantics></math><span id="A3.p1.34.10" class="ltx_text" style="color:#FF8000;"> in all </span><math id="A3.p1.14.m10.1" class="ltx_Math" alttext="k_{j}" display="inline"><semantics id="A3.p1.14.m10.1a"><msub id="A3.p1.14.m10.1.1" xref="A3.p1.14.m10.1.1.cmml"><mi mathcolor="#FF8000" id="A3.p1.14.m10.1.1.2" xref="A3.p1.14.m10.1.1.2.cmml">k</mi><mi mathcolor="#FF8000" id="A3.p1.14.m10.1.1.3" xref="A3.p1.14.m10.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="A3.p1.14.m10.1b"><apply id="A3.p1.14.m10.1.1.cmml" xref="A3.p1.14.m10.1.1"><csymbol cd="ambiguous" id="A3.p1.14.m10.1.1.1.cmml" xref="A3.p1.14.m10.1.1">subscript</csymbol><ci id="A3.p1.14.m10.1.1.2.cmml" xref="A3.p1.14.m10.1.1.2">𝑘</ci><ci id="A3.p1.14.m10.1.1.3.cmml" xref="A3.p1.14.m10.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.14.m10.1c">k_{j}</annotation></semantics></math><span id="A3.p1.34.11" class="ltx_text" style="color:#FF8000;">. Therefore, </span><math id="A3.p1.15.m11.1" class="ltx_Math" alttext="a_{im}" display="inline"><semantics id="A3.p1.15.m11.1a"><msub id="A3.p1.15.m11.1.1" xref="A3.p1.15.m11.1.1.cmml"><mi mathcolor="#FF8000" id="A3.p1.15.m11.1.1.2" xref="A3.p1.15.m11.1.1.2.cmml">a</mi><mrow id="A3.p1.15.m11.1.1.3" xref="A3.p1.15.m11.1.1.3.cmml"><mi mathcolor="#FF8000" id="A3.p1.15.m11.1.1.3.2" xref="A3.p1.15.m11.1.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="A3.p1.15.m11.1.1.3.1" xref="A3.p1.15.m11.1.1.3.1.cmml">​</mo><mi mathcolor="#FF8000" id="A3.p1.15.m11.1.1.3.3" xref="A3.p1.15.m11.1.1.3.3.cmml">m</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="A3.p1.15.m11.1b"><apply id="A3.p1.15.m11.1.1.cmml" xref="A3.p1.15.m11.1.1"><csymbol cd="ambiguous" id="A3.p1.15.m11.1.1.1.cmml" xref="A3.p1.15.m11.1.1">subscript</csymbol><ci id="A3.p1.15.m11.1.1.2.cmml" xref="A3.p1.15.m11.1.1.2">𝑎</ci><apply id="A3.p1.15.m11.1.1.3.cmml" xref="A3.p1.15.m11.1.1.3"><times id="A3.p1.15.m11.1.1.3.1.cmml" xref="A3.p1.15.m11.1.1.3.1"></times><ci id="A3.p1.15.m11.1.1.3.2.cmml" xref="A3.p1.15.m11.1.1.3.2">𝑖</ci><ci id="A3.p1.15.m11.1.1.3.3.cmml" xref="A3.p1.15.m11.1.1.3.3">𝑚</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.15.m11.1c">a_{im}</annotation></semantics></math><span id="A3.p1.34.12" class="ltx_text" style="color:#FF8000;"> is the largest score among other </span><math id="A3.p1.16.m12.1" class="ltx_Math" alttext="a_{ij}" display="inline"><semantics id="A3.p1.16.m12.1a"><msub id="A3.p1.16.m12.1.1" xref="A3.p1.16.m12.1.1.cmml"><mi mathcolor="#FF8000" id="A3.p1.16.m12.1.1.2" xref="A3.p1.16.m12.1.1.2.cmml">a</mi><mrow id="A3.p1.16.m12.1.1.3" xref="A3.p1.16.m12.1.1.3.cmml"><mi mathcolor="#FF8000" id="A3.p1.16.m12.1.1.3.2" xref="A3.p1.16.m12.1.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="A3.p1.16.m12.1.1.3.1" xref="A3.p1.16.m12.1.1.3.1.cmml">​</mo><mi mathcolor="#FF8000" id="A3.p1.16.m12.1.1.3.3" xref="A3.p1.16.m12.1.1.3.3.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="A3.p1.16.m12.1b"><apply id="A3.p1.16.m12.1.1.cmml" xref="A3.p1.16.m12.1.1"><csymbol cd="ambiguous" id="A3.p1.16.m12.1.1.1.cmml" xref="A3.p1.16.m12.1.1">subscript</csymbol><ci id="A3.p1.16.m12.1.1.2.cmml" xref="A3.p1.16.m12.1.1.2">𝑎</ci><apply id="A3.p1.16.m12.1.1.3.cmml" xref="A3.p1.16.m12.1.1.3"><times id="A3.p1.16.m12.1.1.3.1.cmml" xref="A3.p1.16.m12.1.1.3.1"></times><ci id="A3.p1.16.m12.1.1.3.2.cmml" xref="A3.p1.16.m12.1.1.3.2">𝑖</ci><ci id="A3.p1.16.m12.1.1.3.3.cmml" xref="A3.p1.16.m12.1.1.3.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.16.m12.1c">a_{ij}</annotation></semantics></math><span id="A3.p1.34.13" class="ltx_text" style="color:#FF8000;"> so </span><math id="A3.p1.17.m13.3" class="ltx_Math" alttext="Attention({Q},{K},{V})_{i}" display="inline"><semantics id="A3.p1.17.m13.3a"><mrow id="A3.p1.17.m13.3.4" xref="A3.p1.17.m13.3.4.cmml"><mi mathcolor="#FF8000" id="A3.p1.17.m13.3.4.2" xref="A3.p1.17.m13.3.4.2.cmml">A</mi><mo lspace="0em" rspace="0em" id="A3.p1.17.m13.3.4.1" xref="A3.p1.17.m13.3.4.1.cmml">​</mo><mi mathcolor="#FF8000" id="A3.p1.17.m13.3.4.3" xref="A3.p1.17.m13.3.4.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="A3.p1.17.m13.3.4.1a" xref="A3.p1.17.m13.3.4.1.cmml">​</mo><mi mathcolor="#FF8000" id="A3.p1.17.m13.3.4.4" xref="A3.p1.17.m13.3.4.4.cmml">t</mi><mo lspace="0em" rspace="0em" id="A3.p1.17.m13.3.4.1b" xref="A3.p1.17.m13.3.4.1.cmml">​</mo><mi mathcolor="#FF8000" id="A3.p1.17.m13.3.4.5" xref="A3.p1.17.m13.3.4.5.cmml">e</mi><mo lspace="0em" rspace="0em" id="A3.p1.17.m13.3.4.1c" xref="A3.p1.17.m13.3.4.1.cmml">​</mo><mi mathcolor="#FF8000" id="A3.p1.17.m13.3.4.6" xref="A3.p1.17.m13.3.4.6.cmml">n</mi><mo lspace="0em" rspace="0em" id="A3.p1.17.m13.3.4.1d" xref="A3.p1.17.m13.3.4.1.cmml">​</mo><mi mathcolor="#FF8000" id="A3.p1.17.m13.3.4.7" xref="A3.p1.17.m13.3.4.7.cmml">t</mi><mo lspace="0em" rspace="0em" id="A3.p1.17.m13.3.4.1e" xref="A3.p1.17.m13.3.4.1.cmml">​</mo><mi mathcolor="#FF8000" id="A3.p1.17.m13.3.4.8" xref="A3.p1.17.m13.3.4.8.cmml">i</mi><mo lspace="0em" rspace="0em" id="A3.p1.17.m13.3.4.1f" xref="A3.p1.17.m13.3.4.1.cmml">​</mo><mi mathcolor="#FF8000" id="A3.p1.17.m13.3.4.9" xref="A3.p1.17.m13.3.4.9.cmml">o</mi><mo lspace="0em" rspace="0em" id="A3.p1.17.m13.3.4.1g" xref="A3.p1.17.m13.3.4.1.cmml">​</mo><mi mathcolor="#FF8000" id="A3.p1.17.m13.3.4.10" xref="A3.p1.17.m13.3.4.10.cmml">n</mi><mo lspace="0em" rspace="0em" id="A3.p1.17.m13.3.4.1h" xref="A3.p1.17.m13.3.4.1.cmml">​</mo><msub id="A3.p1.17.m13.3.4.11" xref="A3.p1.17.m13.3.4.11.cmml"><mrow id="A3.p1.17.m13.3.4.11.2.2" xref="A3.p1.17.m13.3.4.11.2.1.cmml"><mo mathcolor="#FF8000" stretchy="false" id="A3.p1.17.m13.3.4.11.2.2.1" xref="A3.p1.17.m13.3.4.11.2.1.cmml">(</mo><mi mathcolor="#FF8000" id="A3.p1.17.m13.1.1" xref="A3.p1.17.m13.1.1.cmml">Q</mi><mo mathcolor="#FF8000" id="A3.p1.17.m13.3.4.11.2.2.2" xref="A3.p1.17.m13.3.4.11.2.1.cmml">,</mo><mi mathcolor="#FF8000" id="A3.p1.17.m13.2.2" xref="A3.p1.17.m13.2.2.cmml">K</mi><mo mathcolor="#FF8000" id="A3.p1.17.m13.3.4.11.2.2.3" xref="A3.p1.17.m13.3.4.11.2.1.cmml">,</mo><mi mathcolor="#FF8000" id="A3.p1.17.m13.3.3" xref="A3.p1.17.m13.3.3.cmml">V</mi><mo mathcolor="#FF8000" stretchy="false" id="A3.p1.17.m13.3.4.11.2.2.4" xref="A3.p1.17.m13.3.4.11.2.1.cmml">)</mo></mrow><mi mathcolor="#FF8000" id="A3.p1.17.m13.3.4.11.3" xref="A3.p1.17.m13.3.4.11.3.cmml">i</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="A3.p1.17.m13.3b"><apply id="A3.p1.17.m13.3.4.cmml" xref="A3.p1.17.m13.3.4"><times id="A3.p1.17.m13.3.4.1.cmml" xref="A3.p1.17.m13.3.4.1"></times><ci id="A3.p1.17.m13.3.4.2.cmml" xref="A3.p1.17.m13.3.4.2">𝐴</ci><ci id="A3.p1.17.m13.3.4.3.cmml" xref="A3.p1.17.m13.3.4.3">𝑡</ci><ci id="A3.p1.17.m13.3.4.4.cmml" xref="A3.p1.17.m13.3.4.4">𝑡</ci><ci id="A3.p1.17.m13.3.4.5.cmml" xref="A3.p1.17.m13.3.4.5">𝑒</ci><ci id="A3.p1.17.m13.3.4.6.cmml" xref="A3.p1.17.m13.3.4.6">𝑛</ci><ci id="A3.p1.17.m13.3.4.7.cmml" xref="A3.p1.17.m13.3.4.7">𝑡</ci><ci id="A3.p1.17.m13.3.4.8.cmml" xref="A3.p1.17.m13.3.4.8">𝑖</ci><ci id="A3.p1.17.m13.3.4.9.cmml" xref="A3.p1.17.m13.3.4.9">𝑜</ci><ci id="A3.p1.17.m13.3.4.10.cmml" xref="A3.p1.17.m13.3.4.10">𝑛</ci><apply id="A3.p1.17.m13.3.4.11.cmml" xref="A3.p1.17.m13.3.4.11"><csymbol cd="ambiguous" id="A3.p1.17.m13.3.4.11.1.cmml" xref="A3.p1.17.m13.3.4.11">subscript</csymbol><vector id="A3.p1.17.m13.3.4.11.2.1.cmml" xref="A3.p1.17.m13.3.4.11.2.2"><ci id="A3.p1.17.m13.1.1.cmml" xref="A3.p1.17.m13.1.1">𝑄</ci><ci id="A3.p1.17.m13.2.2.cmml" xref="A3.p1.17.m13.2.2">𝐾</ci><ci id="A3.p1.17.m13.3.3.cmml" xref="A3.p1.17.m13.3.3">𝑉</ci></vector><ci id="A3.p1.17.m13.3.4.11.3.cmml" xref="A3.p1.17.m13.3.4.11.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.17.m13.3c">Attention({Q},{K},{V})_{i}</annotation></semantics></math><span id="A3.p1.34.14" class="ltx_text" style="color:#FF8000;"> is dominated by </span><math id="A3.p1.18.m14.1" class="ltx_Math" alttext="v_{m}" display="inline"><semantics id="A3.p1.18.m14.1a"><msub id="A3.p1.18.m14.1.1" xref="A3.p1.18.m14.1.1.cmml"><mi mathcolor="#FF8000" id="A3.p1.18.m14.1.1.2" xref="A3.p1.18.m14.1.1.2.cmml">v</mi><mi mathcolor="#FF8000" id="A3.p1.18.m14.1.1.3" xref="A3.p1.18.m14.1.1.3.cmml">m</mi></msub><annotation-xml encoding="MathML-Content" id="A3.p1.18.m14.1b"><apply id="A3.p1.18.m14.1.1.cmml" xref="A3.p1.18.m14.1.1"><csymbol cd="ambiguous" id="A3.p1.18.m14.1.1.1.cmml" xref="A3.p1.18.m14.1.1">subscript</csymbol><ci id="A3.p1.18.m14.1.1.2.cmml" xref="A3.p1.18.m14.1.1.2">𝑣</ci><ci id="A3.p1.18.m14.1.1.3.cmml" xref="A3.p1.18.m14.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.18.m14.1c">v_{m}</annotation></semantics></math><span id="A3.p1.34.15" class="ltx_text" style="color:#FF8000;">, which causes the local visual embedding at index </span><math id="A3.p1.19.m15.1" class="ltx_Math" alttext="i" display="inline"><semantics id="A3.p1.19.m15.1a"><mi mathcolor="#FF8000" id="A3.p1.19.m15.1.1" xref="A3.p1.19.m15.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="A3.p1.19.m15.1b"><ci id="A3.p1.19.m15.1.1.cmml" xref="A3.p1.19.m15.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.19.m15.1c">i</annotation></semantics></math><span id="A3.p1.34.16" class="ltx_text" style="color:#FF8000;"> to be disturbed by the local visual embedding at index </span><math id="A3.p1.20.m16.1" class="ltx_Math" alttext="m" display="inline"><semantics id="A3.p1.20.m16.1a"><mi mathcolor="#FF8000" id="A3.p1.20.m16.1.1" xref="A3.p1.20.m16.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="A3.p1.20.m16.1b"><ci id="A3.p1.20.m16.1.1.cmml" xref="A3.p1.20.m16.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.20.m16.1c">m</annotation></semantics></math><span id="A3.p1.34.17" class="ltx_text" style="color:#FF8000;">. In Figure 3(b), the attention score map presents vertical activation and suggests that every </span><math id="A3.p1.21.m17.1" class="ltx_Math" alttext="q_{i}" display="inline"><semantics id="A3.p1.21.m17.1a"><msub id="A3.p1.21.m17.1.1" xref="A3.p1.21.m17.1.1.cmml"><mi mathcolor="#FF8000" id="A3.p1.21.m17.1.1.2" xref="A3.p1.21.m17.1.1.2.cmml">q</mi><mi mathcolor="#FF8000" id="A3.p1.21.m17.1.1.3" xref="A3.p1.21.m17.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A3.p1.21.m17.1b"><apply id="A3.p1.21.m17.1.1.cmml" xref="A3.p1.21.m17.1.1"><csymbol cd="ambiguous" id="A3.p1.21.m17.1.1.1.cmml" xref="A3.p1.21.m17.1.1">subscript</csymbol><ci id="A3.p1.21.m17.1.1.2.cmml" xref="A3.p1.21.m17.1.1.2">𝑞</ci><ci id="A3.p1.21.m17.1.1.3.cmml" xref="A3.p1.21.m17.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.21.m17.1c">q_{i}</annotation></semantics></math><span id="A3.p1.34.18" class="ltx_text" style="color:#FF8000;"> produces a large attention score with </span><math id="A3.p1.22.m18.1" class="ltx_Math" alttext="k_{m}" display="inline"><semantics id="A3.p1.22.m18.1a"><msub id="A3.p1.22.m18.1.1" xref="A3.p1.22.m18.1.1.cmml"><mi mathcolor="#FF8000" id="A3.p1.22.m18.1.1.2" xref="A3.p1.22.m18.1.1.2.cmml">k</mi><mi mathcolor="#FF8000" id="A3.p1.22.m18.1.1.3" xref="A3.p1.22.m18.1.1.3.cmml">m</mi></msub><annotation-xml encoding="MathML-Content" id="A3.p1.22.m18.1b"><apply id="A3.p1.22.m18.1.1.cmml" xref="A3.p1.22.m18.1.1"><csymbol cd="ambiguous" id="A3.p1.22.m18.1.1.1.cmml" xref="A3.p1.22.m18.1.1">subscript</csymbol><ci id="A3.p1.22.m18.1.1.2.cmml" xref="A3.p1.22.m18.1.1.2">𝑘</ci><ci id="A3.p1.22.m18.1.1.3.cmml" xref="A3.p1.22.m18.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.22.m18.1c">k_{m}</annotation></semantics></math><span id="A3.p1.34.19" class="ltx_text" style="color:#FF8000;">. In such a case, several </span><math id="A3.p1.23.m19.3" class="ltx_Math" alttext="Attention({Q},{K},{V})_{i}" display="inline"><semantics id="A3.p1.23.m19.3a"><mrow id="A3.p1.23.m19.3.4" xref="A3.p1.23.m19.3.4.cmml"><mi mathcolor="#FF8000" id="A3.p1.23.m19.3.4.2" xref="A3.p1.23.m19.3.4.2.cmml">A</mi><mo lspace="0em" rspace="0em" id="A3.p1.23.m19.3.4.1" xref="A3.p1.23.m19.3.4.1.cmml">​</mo><mi mathcolor="#FF8000" id="A3.p1.23.m19.3.4.3" xref="A3.p1.23.m19.3.4.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="A3.p1.23.m19.3.4.1a" xref="A3.p1.23.m19.3.4.1.cmml">​</mo><mi mathcolor="#FF8000" id="A3.p1.23.m19.3.4.4" xref="A3.p1.23.m19.3.4.4.cmml">t</mi><mo lspace="0em" rspace="0em" id="A3.p1.23.m19.3.4.1b" xref="A3.p1.23.m19.3.4.1.cmml">​</mo><mi mathcolor="#FF8000" id="A3.p1.23.m19.3.4.5" xref="A3.p1.23.m19.3.4.5.cmml">e</mi><mo lspace="0em" rspace="0em" id="A3.p1.23.m19.3.4.1c" xref="A3.p1.23.m19.3.4.1.cmml">​</mo><mi mathcolor="#FF8000" id="A3.p1.23.m19.3.4.6" xref="A3.p1.23.m19.3.4.6.cmml">n</mi><mo lspace="0em" rspace="0em" id="A3.p1.23.m19.3.4.1d" xref="A3.p1.23.m19.3.4.1.cmml">​</mo><mi mathcolor="#FF8000" id="A3.p1.23.m19.3.4.7" xref="A3.p1.23.m19.3.4.7.cmml">t</mi><mo lspace="0em" rspace="0em" id="A3.p1.23.m19.3.4.1e" xref="A3.p1.23.m19.3.4.1.cmml">​</mo><mi mathcolor="#FF8000" id="A3.p1.23.m19.3.4.8" xref="A3.p1.23.m19.3.4.8.cmml">i</mi><mo lspace="0em" rspace="0em" id="A3.p1.23.m19.3.4.1f" xref="A3.p1.23.m19.3.4.1.cmml">​</mo><mi mathcolor="#FF8000" id="A3.p1.23.m19.3.4.9" xref="A3.p1.23.m19.3.4.9.cmml">o</mi><mo lspace="0em" rspace="0em" id="A3.p1.23.m19.3.4.1g" xref="A3.p1.23.m19.3.4.1.cmml">​</mo><mi mathcolor="#FF8000" id="A3.p1.23.m19.3.4.10" xref="A3.p1.23.m19.3.4.10.cmml">n</mi><mo lspace="0em" rspace="0em" id="A3.p1.23.m19.3.4.1h" xref="A3.p1.23.m19.3.4.1.cmml">​</mo><msub id="A3.p1.23.m19.3.4.11" xref="A3.p1.23.m19.3.4.11.cmml"><mrow id="A3.p1.23.m19.3.4.11.2.2" xref="A3.p1.23.m19.3.4.11.2.1.cmml"><mo mathcolor="#FF8000" stretchy="false" id="A3.p1.23.m19.3.4.11.2.2.1" xref="A3.p1.23.m19.3.4.11.2.1.cmml">(</mo><mi mathcolor="#FF8000" id="A3.p1.23.m19.1.1" xref="A3.p1.23.m19.1.1.cmml">Q</mi><mo mathcolor="#FF8000" id="A3.p1.23.m19.3.4.11.2.2.2" xref="A3.p1.23.m19.3.4.11.2.1.cmml">,</mo><mi mathcolor="#FF8000" id="A3.p1.23.m19.2.2" xref="A3.p1.23.m19.2.2.cmml">K</mi><mo mathcolor="#FF8000" id="A3.p1.23.m19.3.4.11.2.2.3" xref="A3.p1.23.m19.3.4.11.2.1.cmml">,</mo><mi mathcolor="#FF8000" id="A3.p1.23.m19.3.3" xref="A3.p1.23.m19.3.3.cmml">V</mi><mo mathcolor="#FF8000" stretchy="false" id="A3.p1.23.m19.3.4.11.2.2.4" xref="A3.p1.23.m19.3.4.11.2.1.cmml">)</mo></mrow><mi mathcolor="#FF8000" id="A3.p1.23.m19.3.4.11.3" xref="A3.p1.23.m19.3.4.11.3.cmml">i</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="A3.p1.23.m19.3b"><apply id="A3.p1.23.m19.3.4.cmml" xref="A3.p1.23.m19.3.4"><times id="A3.p1.23.m19.3.4.1.cmml" xref="A3.p1.23.m19.3.4.1"></times><ci id="A3.p1.23.m19.3.4.2.cmml" xref="A3.p1.23.m19.3.4.2">𝐴</ci><ci id="A3.p1.23.m19.3.4.3.cmml" xref="A3.p1.23.m19.3.4.3">𝑡</ci><ci id="A3.p1.23.m19.3.4.4.cmml" xref="A3.p1.23.m19.3.4.4">𝑡</ci><ci id="A3.p1.23.m19.3.4.5.cmml" xref="A3.p1.23.m19.3.4.5">𝑒</ci><ci id="A3.p1.23.m19.3.4.6.cmml" xref="A3.p1.23.m19.3.4.6">𝑛</ci><ci id="A3.p1.23.m19.3.4.7.cmml" xref="A3.p1.23.m19.3.4.7">𝑡</ci><ci id="A3.p1.23.m19.3.4.8.cmml" xref="A3.p1.23.m19.3.4.8">𝑖</ci><ci id="A3.p1.23.m19.3.4.9.cmml" xref="A3.p1.23.m19.3.4.9">𝑜</ci><ci id="A3.p1.23.m19.3.4.10.cmml" xref="A3.p1.23.m19.3.4.10">𝑛</ci><apply id="A3.p1.23.m19.3.4.11.cmml" xref="A3.p1.23.m19.3.4.11"><csymbol cd="ambiguous" id="A3.p1.23.m19.3.4.11.1.cmml" xref="A3.p1.23.m19.3.4.11">subscript</csymbol><vector id="A3.p1.23.m19.3.4.11.2.1.cmml" xref="A3.p1.23.m19.3.4.11.2.2"><ci id="A3.p1.23.m19.1.1.cmml" xref="A3.p1.23.m19.1.1">𝑄</ci><ci id="A3.p1.23.m19.2.2.cmml" xref="A3.p1.23.m19.2.2">𝐾</ci><ci id="A3.p1.23.m19.3.3.cmml" xref="A3.p1.23.m19.3.3">𝑉</ci></vector><ci id="A3.p1.23.m19.3.4.11.3.cmml" xref="A3.p1.23.m19.3.4.11.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.23.m19.3c">Attention({Q},{K},{V})_{i}</annotation></semantics></math><span id="A3.p1.34.20" class="ltx_text" style="color:#FF8000;"> is dominated by </span><math id="A3.p1.24.m20.1" class="ltx_Math" alttext="v_{m}" display="inline"><semantics id="A3.p1.24.m20.1a"><msub id="A3.p1.24.m20.1.1" xref="A3.p1.24.m20.1.1.cmml"><mi mathcolor="#FF8000" id="A3.p1.24.m20.1.1.2" xref="A3.p1.24.m20.1.1.2.cmml">v</mi><mi mathcolor="#FF8000" id="A3.p1.24.m20.1.1.3" xref="A3.p1.24.m20.1.1.3.cmml">m</mi></msub><annotation-xml encoding="MathML-Content" id="A3.p1.24.m20.1b"><apply id="A3.p1.24.m20.1.1.cmml" xref="A3.p1.24.m20.1.1"><csymbol cd="ambiguous" id="A3.p1.24.m20.1.1.1.cmml" xref="A3.p1.24.m20.1.1">subscript</csymbol><ci id="A3.p1.24.m20.1.1.2.cmml" xref="A3.p1.24.m20.1.1.2">𝑣</ci><ci id="A3.p1.24.m20.1.1.3.cmml" xref="A3.p1.24.m20.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.24.m20.1c">v_{m}</annotation></semantics></math><span id="A3.p1.34.21" class="ltx_text" style="color:#FF8000;"> and results in weak anomaly segmentation in Figure 3(b) even though </span><math id="A3.p1.25.m21.1" class="ltx_Math" alttext="v_{m}" display="inline"><semantics id="A3.p1.25.m21.1a"><msub id="A3.p1.25.m21.1.1" xref="A3.p1.25.m21.1.1.cmml"><mi mathcolor="#FF8000" id="A3.p1.25.m21.1.1.2" xref="A3.p1.25.m21.1.1.2.cmml">v</mi><mi mathcolor="#FF8000" id="A3.p1.25.m21.1.1.3" xref="A3.p1.25.m21.1.1.3.cmml">m</mi></msub><annotation-xml encoding="MathML-Content" id="A3.p1.25.m21.1b"><apply id="A3.p1.25.m21.1.1.cmml" xref="A3.p1.25.m21.1.1"><csymbol cd="ambiguous" id="A3.p1.25.m21.1.1.1.cmml" xref="A3.p1.25.m21.1.1">subscript</csymbol><ci id="A3.p1.25.m21.1.1.2.cmml" xref="A3.p1.25.m21.1.1.2">𝑣</ci><ci id="A3.p1.25.m21.1.1.3.cmml" xref="A3.p1.25.m21.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.25.m21.1c">v_{m}</annotation></semantics></math><span id="A3.p1.34.22" class="ltx_text" style="color:#FF8000;"> may be important for original class recognition. Some prior studies </span><cite class="ltx_cite ltx_citemacro_citep"><span id="A3.p1.34.23.1" class="ltx_text" style="color:#FF8000;">(</span>Rao et al.<span id="A3.p1.34.24.2.1.1" class="ltx_text" style="color:#FF8000;">, </span><a href="#bib.bib42" title="" class="ltx_ref">2022</a>; Gu et al.<span id="A3.p1.34.24.2.1.1" class="ltx_text" style="color:#FF8000;">, </span><a href="#bib.bib15" title="" class="ltx_ref">2023</a><span id="A3.p1.34.25.3" class="ltx_text" style="color:#FF8000;">)</span></cite><span id="A3.p1.34.26" class="ltx_text" style="color:#FF8000;"> use an additional decoder to recover the local visual semantics. In this paper, we directly use local visual embeddings for segmentation and point out that an ideal attention map for local visual semantics should exhibit a more pronounced diagonal pattern. For this purpose, DPAM is proposed to replace the original </span><math id="A3.p1.26.m22.1" class="ltx_Math" alttext="Q" display="inline"><semantics id="A3.p1.26.m22.1a"><mi mathcolor="#FF8000" id="A3.p1.26.m22.1.1" xref="A3.p1.26.m22.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="A3.p1.26.m22.1b"><ci id="A3.p1.26.m22.1.1.cmml" xref="A3.p1.26.m22.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.26.m22.1c">Q</annotation></semantics></math><span id="A3.p1.34.27" class="ltx_text" style="color:#FF8000;">-</span><math id="A3.p1.27.m23.1" class="ltx_Math" alttext="K" display="inline"><semantics id="A3.p1.27.m23.1a"><mi mathcolor="#FF8000" id="A3.p1.27.m23.1.1" xref="A3.p1.27.m23.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="A3.p1.27.m23.1b"><ci id="A3.p1.27.m23.1.1.cmml" xref="A3.p1.27.m23.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.27.m23.1c">K</annotation></semantics></math><span id="A3.p1.34.28" class="ltx_text" style="color:#FF8000;"> attention with analogous components, including </span><math id="A3.p1.28.m24.1" class="ltx_Math" alttext="Q" display="inline"><semantics id="A3.p1.28.m24.1a"><mi mathcolor="#FF8000" id="A3.p1.28.m24.1.1" xref="A3.p1.28.m24.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="A3.p1.28.m24.1b"><ci id="A3.p1.28.m24.1.1.cmml" xref="A3.p1.28.m24.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.28.m24.1c">Q</annotation></semantics></math><span id="A3.p1.34.29" class="ltx_text" style="color:#FF8000;">-</span><math id="A3.p1.29.m25.1" class="ltx_Math" alttext="Q" display="inline"><semantics id="A3.p1.29.m25.1a"><mi mathcolor="#FF8000" id="A3.p1.29.m25.1.1" xref="A3.p1.29.m25.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="A3.p1.29.m25.1b"><ci id="A3.p1.29.m25.1.1.cmml" xref="A3.p1.29.m25.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.29.m25.1c">Q</annotation></semantics></math><span id="A3.p1.34.30" class="ltx_text" style="color:#FF8000;">, </span><math id="A3.p1.30.m26.1" class="ltx_Math" alttext="K" display="inline"><semantics id="A3.p1.30.m26.1a"><mi mathcolor="#FF8000" id="A3.p1.30.m26.1.1" xref="A3.p1.30.m26.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="A3.p1.30.m26.1b"><ci id="A3.p1.30.m26.1.1.cmml" xref="A3.p1.30.m26.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.30.m26.1c">K</annotation></semantics></math><span id="A3.p1.34.31" class="ltx_text" style="color:#FF8000;">-</span><math id="A3.p1.31.m27.1" class="ltx_Math" alttext="K" display="inline"><semantics id="A3.p1.31.m27.1a"><mi mathcolor="#FF8000" id="A3.p1.31.m27.1.1" xref="A3.p1.31.m27.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="A3.p1.31.m27.1b"><ci id="A3.p1.31.m27.1.1.cmml" xref="A3.p1.31.m27.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.31.m27.1c">K</annotation></semantics></math><span id="A3.p1.34.32" class="ltx_text" style="color:#FF8000;">, and </span><math id="A3.p1.32.m28.1" class="ltx_Math" alttext="V" display="inline"><semantics id="A3.p1.32.m28.1a"><mi mathcolor="#FF8000" id="A3.p1.32.m28.1.1" xref="A3.p1.32.m28.1.1.cmml">V</mi><annotation-xml encoding="MathML-Content" id="A3.p1.32.m28.1b"><ci id="A3.p1.32.m28.1.1.cmml" xref="A3.p1.32.m28.1.1">𝑉</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.32.m28.1c">V</annotation></semantics></math><span id="A3.p1.34.33" class="ltx_text" style="color:#FF8000;">-</span><math id="A3.p1.33.m29.1" class="ltx_Math" alttext="V" display="inline"><semantics id="A3.p1.33.m29.1a"><mi mathcolor="#FF8000" id="A3.p1.33.m29.1.1" xref="A3.p1.33.m29.1.1.cmml">V</mi><annotation-xml encoding="MathML-Content" id="A3.p1.33.m29.1b"><ci id="A3.p1.33.m29.1.1.cmml" xref="A3.p1.33.m29.1.1">𝑉</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.33.m29.1c">V</annotation></semantics></math><span id="A3.p1.34.34" class="ltx_text" style="color:#FF8000;"> self-attention. Therefore, </span><math id="A3.p1.34.m30.1" class="ltx_Math" alttext="a_{ij}" display="inline"><semantics id="A3.p1.34.m30.1a"><msub id="A3.p1.34.m30.1.1" xref="A3.p1.34.m30.1.1.cmml"><mi mathcolor="#FF8000" id="A3.p1.34.m30.1.1.2" xref="A3.p1.34.m30.1.1.2.cmml">a</mi><mrow id="A3.p1.34.m30.1.1.3" xref="A3.p1.34.m30.1.1.3.cmml"><mi mathcolor="#FF8000" id="A3.p1.34.m30.1.1.3.2" xref="A3.p1.34.m30.1.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="A3.p1.34.m30.1.1.3.1" xref="A3.p1.34.m30.1.1.3.1.cmml">​</mo><mi mathcolor="#FF8000" id="A3.p1.34.m30.1.1.3.3" xref="A3.p1.34.m30.1.1.3.3.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="A3.p1.34.m30.1b"><apply id="A3.p1.34.m30.1.1.cmml" xref="A3.p1.34.m30.1.1"><csymbol cd="ambiguous" id="A3.p1.34.m30.1.1.1.cmml" xref="A3.p1.34.m30.1.1">subscript</csymbol><ci id="A3.p1.34.m30.1.1.2.cmml" xref="A3.p1.34.m30.1.1.2">𝑎</ci><apply id="A3.p1.34.m30.1.1.3.cmml" xref="A3.p1.34.m30.1.1.3"><times id="A3.p1.34.m30.1.1.3.1.cmml" xref="A3.p1.34.m30.1.1.3.1"></times><ci id="A3.p1.34.m30.1.1.3.2.cmml" xref="A3.p1.34.m30.1.1.3.2">𝑖</ci><ci id="A3.p1.34.m30.1.1.3.3.cmml" xref="A3.p1.34.m30.1.1.3.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.34.m30.1c">a_{ij}</annotation></semantics></math><span id="A3.p1.34.35" class="ltx_text" style="color:#FF8000;"> is changed into:</span></p>
<table id="A3.Ex8" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="A3.Ex8.m1.1" class="ltx_Math" alttext="a^{qq}_{ij}=e^{\frac{q_{i}q_{j}^{\top}}{\sqrt{D}}},\quad a^{kk}_{ij}=e^{\frac{k_{i}k_{j}^{\top}}{\sqrt{D}}},\quad a^{vv}_{ij}=e^{\frac{v_{i}v_{j}^{\top}}{\sqrt{D}}}." display="block"><semantics id="A3.Ex8.m1.1a"><mrow id="A3.Ex8.m1.1.1.1"><mrow id="A3.Ex8.m1.1.1.1.1.2" xref="A3.Ex8.m1.1.1.1.1.3.cmml"><mrow id="A3.Ex8.m1.1.1.1.1.1.1" xref="A3.Ex8.m1.1.1.1.1.1.1.cmml"><msubsup id="A3.Ex8.m1.1.1.1.1.1.1.2" xref="A3.Ex8.m1.1.1.1.1.1.1.2.cmml"><mi mathcolor="#FF8000" id="A3.Ex8.m1.1.1.1.1.1.1.2.2.2" xref="A3.Ex8.m1.1.1.1.1.1.1.2.2.2.cmml">a</mi><mrow id="A3.Ex8.m1.1.1.1.1.1.1.2.3" xref="A3.Ex8.m1.1.1.1.1.1.1.2.3.cmml"><mi mathcolor="#FF8000" id="A3.Ex8.m1.1.1.1.1.1.1.2.3.2" xref="A3.Ex8.m1.1.1.1.1.1.1.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="A3.Ex8.m1.1.1.1.1.1.1.2.3.1" xref="A3.Ex8.m1.1.1.1.1.1.1.2.3.1.cmml">​</mo><mi mathcolor="#FF8000" id="A3.Ex8.m1.1.1.1.1.1.1.2.3.3" xref="A3.Ex8.m1.1.1.1.1.1.1.2.3.3.cmml">j</mi></mrow><mrow id="A3.Ex8.m1.1.1.1.1.1.1.2.2.3" xref="A3.Ex8.m1.1.1.1.1.1.1.2.2.3.cmml"><mi mathcolor="#FF8000" id="A3.Ex8.m1.1.1.1.1.1.1.2.2.3.2" xref="A3.Ex8.m1.1.1.1.1.1.1.2.2.3.2.cmml">q</mi><mo lspace="0em" rspace="0em" id="A3.Ex8.m1.1.1.1.1.1.1.2.2.3.1" xref="A3.Ex8.m1.1.1.1.1.1.1.2.2.3.1.cmml">​</mo><mi mathcolor="#FF8000" id="A3.Ex8.m1.1.1.1.1.1.1.2.2.3.3" xref="A3.Ex8.m1.1.1.1.1.1.1.2.2.3.3.cmml">q</mi></mrow></msubsup><mo mathcolor="#FF8000" id="A3.Ex8.m1.1.1.1.1.1.1.1" xref="A3.Ex8.m1.1.1.1.1.1.1.1.cmml">=</mo><msup id="A3.Ex8.m1.1.1.1.1.1.1.3" xref="A3.Ex8.m1.1.1.1.1.1.1.3.cmml"><mi mathcolor="#FF8000" id="A3.Ex8.m1.1.1.1.1.1.1.3.2" xref="A3.Ex8.m1.1.1.1.1.1.1.3.2.cmml">e</mi><mfrac mathcolor="#FF8000" id="A3.Ex8.m1.1.1.1.1.1.1.3.3" xref="A3.Ex8.m1.1.1.1.1.1.1.3.3.cmml"><mrow id="A3.Ex8.m1.1.1.1.1.1.1.3.3.2" xref="A3.Ex8.m1.1.1.1.1.1.1.3.3.2.cmml"><msub id="A3.Ex8.m1.1.1.1.1.1.1.3.3.2.2" xref="A3.Ex8.m1.1.1.1.1.1.1.3.3.2.2.cmml"><mi mathcolor="#FF8000" id="A3.Ex8.m1.1.1.1.1.1.1.3.3.2.2.2" xref="A3.Ex8.m1.1.1.1.1.1.1.3.3.2.2.2.cmml">q</mi><mi mathcolor="#FF8000" id="A3.Ex8.m1.1.1.1.1.1.1.3.3.2.2.3" xref="A3.Ex8.m1.1.1.1.1.1.1.3.3.2.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="A3.Ex8.m1.1.1.1.1.1.1.3.3.2.1" xref="A3.Ex8.m1.1.1.1.1.1.1.3.3.2.1.cmml">​</mo><msubsup id="A3.Ex8.m1.1.1.1.1.1.1.3.3.2.3" xref="A3.Ex8.m1.1.1.1.1.1.1.3.3.2.3.cmml"><mi mathcolor="#FF8000" id="A3.Ex8.m1.1.1.1.1.1.1.3.3.2.3.2.2" xref="A3.Ex8.m1.1.1.1.1.1.1.3.3.2.3.2.2.cmml">q</mi><mi mathcolor="#FF8000" id="A3.Ex8.m1.1.1.1.1.1.1.3.3.2.3.2.3" xref="A3.Ex8.m1.1.1.1.1.1.1.3.3.2.3.2.3.cmml">j</mi><mo mathcolor="#FF8000" id="A3.Ex8.m1.1.1.1.1.1.1.3.3.2.3.3" xref="A3.Ex8.m1.1.1.1.1.1.1.3.3.2.3.3.cmml">⊤</mo></msubsup></mrow><msqrt mathcolor="#FF8000" id="A3.Ex8.m1.1.1.1.1.1.1.3.3.3" xref="A3.Ex8.m1.1.1.1.1.1.1.3.3.3.cmml"><mi mathcolor="#FF8000" id="A3.Ex8.m1.1.1.1.1.1.1.3.3.3.2" xref="A3.Ex8.m1.1.1.1.1.1.1.3.3.3.2.cmml">D</mi></msqrt></mfrac></msup></mrow><mo mathcolor="#FF8000" rspace="1.167em" id="A3.Ex8.m1.1.1.1.1.2.3" xref="A3.Ex8.m1.1.1.1.1.3a.cmml">,</mo><mrow id="A3.Ex8.m1.1.1.1.1.2.2.2" xref="A3.Ex8.m1.1.1.1.1.2.2.3.cmml"><mrow id="A3.Ex8.m1.1.1.1.1.2.2.1.1" xref="A3.Ex8.m1.1.1.1.1.2.2.1.1.cmml"><msubsup id="A3.Ex8.m1.1.1.1.1.2.2.1.1.2" xref="A3.Ex8.m1.1.1.1.1.2.2.1.1.2.cmml"><mi mathcolor="#FF8000" id="A3.Ex8.m1.1.1.1.1.2.2.1.1.2.2.2" xref="A3.Ex8.m1.1.1.1.1.2.2.1.1.2.2.2.cmml">a</mi><mrow id="A3.Ex8.m1.1.1.1.1.2.2.1.1.2.3" xref="A3.Ex8.m1.1.1.1.1.2.2.1.1.2.3.cmml"><mi mathcolor="#FF8000" id="A3.Ex8.m1.1.1.1.1.2.2.1.1.2.3.2" xref="A3.Ex8.m1.1.1.1.1.2.2.1.1.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="A3.Ex8.m1.1.1.1.1.2.2.1.1.2.3.1" xref="A3.Ex8.m1.1.1.1.1.2.2.1.1.2.3.1.cmml">​</mo><mi mathcolor="#FF8000" id="A3.Ex8.m1.1.1.1.1.2.2.1.1.2.3.3" xref="A3.Ex8.m1.1.1.1.1.2.2.1.1.2.3.3.cmml">j</mi></mrow><mrow id="A3.Ex8.m1.1.1.1.1.2.2.1.1.2.2.3" xref="A3.Ex8.m1.1.1.1.1.2.2.1.1.2.2.3.cmml"><mi mathcolor="#FF8000" id="A3.Ex8.m1.1.1.1.1.2.2.1.1.2.2.3.2" xref="A3.Ex8.m1.1.1.1.1.2.2.1.1.2.2.3.2.cmml">k</mi><mo lspace="0em" rspace="0em" id="A3.Ex8.m1.1.1.1.1.2.2.1.1.2.2.3.1" xref="A3.Ex8.m1.1.1.1.1.2.2.1.1.2.2.3.1.cmml">​</mo><mi mathcolor="#FF8000" id="A3.Ex8.m1.1.1.1.1.2.2.1.1.2.2.3.3" xref="A3.Ex8.m1.1.1.1.1.2.2.1.1.2.2.3.3.cmml">k</mi></mrow></msubsup><mo mathcolor="#FF8000" id="A3.Ex8.m1.1.1.1.1.2.2.1.1.1" xref="A3.Ex8.m1.1.1.1.1.2.2.1.1.1.cmml">=</mo><msup id="A3.Ex8.m1.1.1.1.1.2.2.1.1.3" xref="A3.Ex8.m1.1.1.1.1.2.2.1.1.3.cmml"><mi mathcolor="#FF8000" id="A3.Ex8.m1.1.1.1.1.2.2.1.1.3.2" xref="A3.Ex8.m1.1.1.1.1.2.2.1.1.3.2.cmml">e</mi><mfrac mathcolor="#FF8000" id="A3.Ex8.m1.1.1.1.1.2.2.1.1.3.3" xref="A3.Ex8.m1.1.1.1.1.2.2.1.1.3.3.cmml"><mrow id="A3.Ex8.m1.1.1.1.1.2.2.1.1.3.3.2" xref="A3.Ex8.m1.1.1.1.1.2.2.1.1.3.3.2.cmml"><msub id="A3.Ex8.m1.1.1.1.1.2.2.1.1.3.3.2.2" xref="A3.Ex8.m1.1.1.1.1.2.2.1.1.3.3.2.2.cmml"><mi mathcolor="#FF8000" id="A3.Ex8.m1.1.1.1.1.2.2.1.1.3.3.2.2.2" xref="A3.Ex8.m1.1.1.1.1.2.2.1.1.3.3.2.2.2.cmml">k</mi><mi mathcolor="#FF8000" id="A3.Ex8.m1.1.1.1.1.2.2.1.1.3.3.2.2.3" xref="A3.Ex8.m1.1.1.1.1.2.2.1.1.3.3.2.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="A3.Ex8.m1.1.1.1.1.2.2.1.1.3.3.2.1" xref="A3.Ex8.m1.1.1.1.1.2.2.1.1.3.3.2.1.cmml">​</mo><msubsup id="A3.Ex8.m1.1.1.1.1.2.2.1.1.3.3.2.3" xref="A3.Ex8.m1.1.1.1.1.2.2.1.1.3.3.2.3.cmml"><mi mathcolor="#FF8000" id="A3.Ex8.m1.1.1.1.1.2.2.1.1.3.3.2.3.2.2" xref="A3.Ex8.m1.1.1.1.1.2.2.1.1.3.3.2.3.2.2.cmml">k</mi><mi mathcolor="#FF8000" id="A3.Ex8.m1.1.1.1.1.2.2.1.1.3.3.2.3.2.3" xref="A3.Ex8.m1.1.1.1.1.2.2.1.1.3.3.2.3.2.3.cmml">j</mi><mo mathcolor="#FF8000" id="A3.Ex8.m1.1.1.1.1.2.2.1.1.3.3.2.3.3" xref="A3.Ex8.m1.1.1.1.1.2.2.1.1.3.3.2.3.3.cmml">⊤</mo></msubsup></mrow><msqrt mathcolor="#FF8000" id="A3.Ex8.m1.1.1.1.1.2.2.1.1.3.3.3" xref="A3.Ex8.m1.1.1.1.1.2.2.1.1.3.3.3.cmml"><mi mathcolor="#FF8000" id="A3.Ex8.m1.1.1.1.1.2.2.1.1.3.3.3.2" xref="A3.Ex8.m1.1.1.1.1.2.2.1.1.3.3.3.2.cmml">D</mi></msqrt></mfrac></msup></mrow><mo mathcolor="#FF8000" rspace="1.167em" id="A3.Ex8.m1.1.1.1.1.2.2.2.3" xref="A3.Ex8.m1.1.1.1.1.2.2.3a.cmml">,</mo><mrow id="A3.Ex8.m1.1.1.1.1.2.2.2.2" xref="A3.Ex8.m1.1.1.1.1.2.2.2.2.cmml"><msubsup id="A3.Ex8.m1.1.1.1.1.2.2.2.2.2" xref="A3.Ex8.m1.1.1.1.1.2.2.2.2.2.cmml"><mi mathcolor="#FF8000" id="A3.Ex8.m1.1.1.1.1.2.2.2.2.2.2.2" xref="A3.Ex8.m1.1.1.1.1.2.2.2.2.2.2.2.cmml">a</mi><mrow id="A3.Ex8.m1.1.1.1.1.2.2.2.2.2.3" xref="A3.Ex8.m1.1.1.1.1.2.2.2.2.2.3.cmml"><mi mathcolor="#FF8000" id="A3.Ex8.m1.1.1.1.1.2.2.2.2.2.3.2" xref="A3.Ex8.m1.1.1.1.1.2.2.2.2.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="A3.Ex8.m1.1.1.1.1.2.2.2.2.2.3.1" xref="A3.Ex8.m1.1.1.1.1.2.2.2.2.2.3.1.cmml">​</mo><mi mathcolor="#FF8000" id="A3.Ex8.m1.1.1.1.1.2.2.2.2.2.3.3" xref="A3.Ex8.m1.1.1.1.1.2.2.2.2.2.3.3.cmml">j</mi></mrow><mrow id="A3.Ex8.m1.1.1.1.1.2.2.2.2.2.2.3" xref="A3.Ex8.m1.1.1.1.1.2.2.2.2.2.2.3.cmml"><mi mathcolor="#FF8000" id="A3.Ex8.m1.1.1.1.1.2.2.2.2.2.2.3.2" xref="A3.Ex8.m1.1.1.1.1.2.2.2.2.2.2.3.2.cmml">v</mi><mo lspace="0em" rspace="0em" id="A3.Ex8.m1.1.1.1.1.2.2.2.2.2.2.3.1" xref="A3.Ex8.m1.1.1.1.1.2.2.2.2.2.2.3.1.cmml">​</mo><mi mathcolor="#FF8000" id="A3.Ex8.m1.1.1.1.1.2.2.2.2.2.2.3.3" xref="A3.Ex8.m1.1.1.1.1.2.2.2.2.2.2.3.3.cmml">v</mi></mrow></msubsup><mo mathcolor="#FF8000" id="A3.Ex8.m1.1.1.1.1.2.2.2.2.1" xref="A3.Ex8.m1.1.1.1.1.2.2.2.2.1.cmml">=</mo><msup id="A3.Ex8.m1.1.1.1.1.2.2.2.2.3" xref="A3.Ex8.m1.1.1.1.1.2.2.2.2.3.cmml"><mi mathcolor="#FF8000" id="A3.Ex8.m1.1.1.1.1.2.2.2.2.3.2" xref="A3.Ex8.m1.1.1.1.1.2.2.2.2.3.2.cmml">e</mi><mfrac mathcolor="#FF8000" id="A3.Ex8.m1.1.1.1.1.2.2.2.2.3.3" xref="A3.Ex8.m1.1.1.1.1.2.2.2.2.3.3.cmml"><mrow id="A3.Ex8.m1.1.1.1.1.2.2.2.2.3.3.2" xref="A3.Ex8.m1.1.1.1.1.2.2.2.2.3.3.2.cmml"><msub id="A3.Ex8.m1.1.1.1.1.2.2.2.2.3.3.2.2" xref="A3.Ex8.m1.1.1.1.1.2.2.2.2.3.3.2.2.cmml"><mi mathcolor="#FF8000" id="A3.Ex8.m1.1.1.1.1.2.2.2.2.3.3.2.2.2" xref="A3.Ex8.m1.1.1.1.1.2.2.2.2.3.3.2.2.2.cmml">v</mi><mi mathcolor="#FF8000" id="A3.Ex8.m1.1.1.1.1.2.2.2.2.3.3.2.2.3" xref="A3.Ex8.m1.1.1.1.1.2.2.2.2.3.3.2.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="A3.Ex8.m1.1.1.1.1.2.2.2.2.3.3.2.1" xref="A3.Ex8.m1.1.1.1.1.2.2.2.2.3.3.2.1.cmml">​</mo><msubsup id="A3.Ex8.m1.1.1.1.1.2.2.2.2.3.3.2.3" xref="A3.Ex8.m1.1.1.1.1.2.2.2.2.3.3.2.3.cmml"><mi mathcolor="#FF8000" id="A3.Ex8.m1.1.1.1.1.2.2.2.2.3.3.2.3.2.2" xref="A3.Ex8.m1.1.1.1.1.2.2.2.2.3.3.2.3.2.2.cmml">v</mi><mi mathcolor="#FF8000" id="A3.Ex8.m1.1.1.1.1.2.2.2.2.3.3.2.3.2.3" xref="A3.Ex8.m1.1.1.1.1.2.2.2.2.3.3.2.3.2.3.cmml">j</mi><mo mathcolor="#FF8000" id="A3.Ex8.m1.1.1.1.1.2.2.2.2.3.3.2.3.3" xref="A3.Ex8.m1.1.1.1.1.2.2.2.2.3.3.2.3.3.cmml">⊤</mo></msubsup></mrow><msqrt mathcolor="#FF8000" id="A3.Ex8.m1.1.1.1.1.2.2.2.2.3.3.3" xref="A3.Ex8.m1.1.1.1.1.2.2.2.2.3.3.3.cmml"><mi mathcolor="#FF8000" id="A3.Ex8.m1.1.1.1.1.2.2.2.2.3.3.3.2" xref="A3.Ex8.m1.1.1.1.1.2.2.2.2.3.3.3.2.cmml">D</mi></msqrt></mfrac></msup></mrow></mrow></mrow><mo lspace="0em" mathcolor="#FF8000" id="A3.Ex8.m1.1.1.1.2">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A3.Ex8.m1.1b"><apply id="A3.Ex8.m1.1.1.1.1.3.cmml" xref="A3.Ex8.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="A3.Ex8.m1.1.1.1.1.3a.cmml" xref="A3.Ex8.m1.1.1.1.1.2.3">formulae-sequence</csymbol><apply id="A3.Ex8.m1.1.1.1.1.1.1.cmml" xref="A3.Ex8.m1.1.1.1.1.1.1"><eq id="A3.Ex8.m1.1.1.1.1.1.1.1.cmml" xref="A3.Ex8.m1.1.1.1.1.1.1.1"></eq><apply id="A3.Ex8.m1.1.1.1.1.1.1.2.cmml" xref="A3.Ex8.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A3.Ex8.m1.1.1.1.1.1.1.2.1.cmml" xref="A3.Ex8.m1.1.1.1.1.1.1.2">subscript</csymbol><apply id="A3.Ex8.m1.1.1.1.1.1.1.2.2.cmml" xref="A3.Ex8.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A3.Ex8.m1.1.1.1.1.1.1.2.2.1.cmml" xref="A3.Ex8.m1.1.1.1.1.1.1.2">superscript</csymbol><ci id="A3.Ex8.m1.1.1.1.1.1.1.2.2.2.cmml" xref="A3.Ex8.m1.1.1.1.1.1.1.2.2.2">𝑎</ci><apply id="A3.Ex8.m1.1.1.1.1.1.1.2.2.3.cmml" xref="A3.Ex8.m1.1.1.1.1.1.1.2.2.3"><times id="A3.Ex8.m1.1.1.1.1.1.1.2.2.3.1.cmml" xref="A3.Ex8.m1.1.1.1.1.1.1.2.2.3.1"></times><ci id="A3.Ex8.m1.1.1.1.1.1.1.2.2.3.2.cmml" xref="A3.Ex8.m1.1.1.1.1.1.1.2.2.3.2">𝑞</ci><ci id="A3.Ex8.m1.1.1.1.1.1.1.2.2.3.3.cmml" xref="A3.Ex8.m1.1.1.1.1.1.1.2.2.3.3">𝑞</ci></apply></apply><apply id="A3.Ex8.m1.1.1.1.1.1.1.2.3.cmml" xref="A3.Ex8.m1.1.1.1.1.1.1.2.3"><times id="A3.Ex8.m1.1.1.1.1.1.1.2.3.1.cmml" xref="A3.Ex8.m1.1.1.1.1.1.1.2.3.1"></times><ci id="A3.Ex8.m1.1.1.1.1.1.1.2.3.2.cmml" xref="A3.Ex8.m1.1.1.1.1.1.1.2.3.2">𝑖</ci><ci id="A3.Ex8.m1.1.1.1.1.1.1.2.3.3.cmml" xref="A3.Ex8.m1.1.1.1.1.1.1.2.3.3">𝑗</ci></apply></apply><apply id="A3.Ex8.m1.1.1.1.1.1.1.3.cmml" xref="A3.Ex8.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A3.Ex8.m1.1.1.1.1.1.1.3.1.cmml" xref="A3.Ex8.m1.1.1.1.1.1.1.3">superscript</csymbol><ci id="A3.Ex8.m1.1.1.1.1.1.1.3.2.cmml" xref="A3.Ex8.m1.1.1.1.1.1.1.3.2">𝑒</ci><apply id="A3.Ex8.m1.1.1.1.1.1.1.3.3.cmml" xref="A3.Ex8.m1.1.1.1.1.1.1.3.3"><divide id="A3.Ex8.m1.1.1.1.1.1.1.3.3.1.cmml" xref="A3.Ex8.m1.1.1.1.1.1.1.3.3"></divide><apply id="A3.Ex8.m1.1.1.1.1.1.1.3.3.2.cmml" xref="A3.Ex8.m1.1.1.1.1.1.1.3.3.2"><times id="A3.Ex8.m1.1.1.1.1.1.1.3.3.2.1.cmml" xref="A3.Ex8.m1.1.1.1.1.1.1.3.3.2.1"></times><apply id="A3.Ex8.m1.1.1.1.1.1.1.3.3.2.2.cmml" xref="A3.Ex8.m1.1.1.1.1.1.1.3.3.2.2"><csymbol cd="ambiguous" id="A3.Ex8.m1.1.1.1.1.1.1.3.3.2.2.1.cmml" xref="A3.Ex8.m1.1.1.1.1.1.1.3.3.2.2">subscript</csymbol><ci id="A3.Ex8.m1.1.1.1.1.1.1.3.3.2.2.2.cmml" xref="A3.Ex8.m1.1.1.1.1.1.1.3.3.2.2.2">𝑞</ci><ci id="A3.Ex8.m1.1.1.1.1.1.1.3.3.2.2.3.cmml" xref="A3.Ex8.m1.1.1.1.1.1.1.3.3.2.2.3">𝑖</ci></apply><apply id="A3.Ex8.m1.1.1.1.1.1.1.3.3.2.3.cmml" xref="A3.Ex8.m1.1.1.1.1.1.1.3.3.2.3"><csymbol cd="ambiguous" id="A3.Ex8.m1.1.1.1.1.1.1.3.3.2.3.1.cmml" xref="A3.Ex8.m1.1.1.1.1.1.1.3.3.2.3">superscript</csymbol><apply id="A3.Ex8.m1.1.1.1.1.1.1.3.3.2.3.2.cmml" xref="A3.Ex8.m1.1.1.1.1.1.1.3.3.2.3"><csymbol cd="ambiguous" id="A3.Ex8.m1.1.1.1.1.1.1.3.3.2.3.2.1.cmml" xref="A3.Ex8.m1.1.1.1.1.1.1.3.3.2.3">subscript</csymbol><ci id="A3.Ex8.m1.1.1.1.1.1.1.3.3.2.3.2.2.cmml" xref="A3.Ex8.m1.1.1.1.1.1.1.3.3.2.3.2.2">𝑞</ci><ci id="A3.Ex8.m1.1.1.1.1.1.1.3.3.2.3.2.3.cmml" xref="A3.Ex8.m1.1.1.1.1.1.1.3.3.2.3.2.3">𝑗</ci></apply><csymbol cd="latexml" id="A3.Ex8.m1.1.1.1.1.1.1.3.3.2.3.3.cmml" xref="A3.Ex8.m1.1.1.1.1.1.1.3.3.2.3.3">top</csymbol></apply></apply><apply id="A3.Ex8.m1.1.1.1.1.1.1.3.3.3.cmml" xref="A3.Ex8.m1.1.1.1.1.1.1.3.3.3"><root id="A3.Ex8.m1.1.1.1.1.1.1.3.3.3a.cmml" xref="A3.Ex8.m1.1.1.1.1.1.1.3.3.3"></root><ci id="A3.Ex8.m1.1.1.1.1.1.1.3.3.3.2.cmml" xref="A3.Ex8.m1.1.1.1.1.1.1.3.3.3.2">𝐷</ci></apply></apply></apply></apply><apply id="A3.Ex8.m1.1.1.1.1.2.2.3.cmml" xref="A3.Ex8.m1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="A3.Ex8.m1.1.1.1.1.2.2.3a.cmml" xref="A3.Ex8.m1.1.1.1.1.2.2.2.3">formulae-sequence</csymbol><apply id="A3.Ex8.m1.1.1.1.1.2.2.1.1.cmml" xref="A3.Ex8.m1.1.1.1.1.2.2.1.1"><eq id="A3.Ex8.m1.1.1.1.1.2.2.1.1.1.cmml" xref="A3.Ex8.m1.1.1.1.1.2.2.1.1.1"></eq><apply id="A3.Ex8.m1.1.1.1.1.2.2.1.1.2.cmml" xref="A3.Ex8.m1.1.1.1.1.2.2.1.1.2"><csymbol cd="ambiguous" id="A3.Ex8.m1.1.1.1.1.2.2.1.1.2.1.cmml" xref="A3.Ex8.m1.1.1.1.1.2.2.1.1.2">subscript</csymbol><apply id="A3.Ex8.m1.1.1.1.1.2.2.1.1.2.2.cmml" xref="A3.Ex8.m1.1.1.1.1.2.2.1.1.2"><csymbol cd="ambiguous" id="A3.Ex8.m1.1.1.1.1.2.2.1.1.2.2.1.cmml" xref="A3.Ex8.m1.1.1.1.1.2.2.1.1.2">superscript</csymbol><ci id="A3.Ex8.m1.1.1.1.1.2.2.1.1.2.2.2.cmml" xref="A3.Ex8.m1.1.1.1.1.2.2.1.1.2.2.2">𝑎</ci><apply id="A3.Ex8.m1.1.1.1.1.2.2.1.1.2.2.3.cmml" xref="A3.Ex8.m1.1.1.1.1.2.2.1.1.2.2.3"><times id="A3.Ex8.m1.1.1.1.1.2.2.1.1.2.2.3.1.cmml" xref="A3.Ex8.m1.1.1.1.1.2.2.1.1.2.2.3.1"></times><ci id="A3.Ex8.m1.1.1.1.1.2.2.1.1.2.2.3.2.cmml" xref="A3.Ex8.m1.1.1.1.1.2.2.1.1.2.2.3.2">𝑘</ci><ci id="A3.Ex8.m1.1.1.1.1.2.2.1.1.2.2.3.3.cmml" xref="A3.Ex8.m1.1.1.1.1.2.2.1.1.2.2.3.3">𝑘</ci></apply></apply><apply id="A3.Ex8.m1.1.1.1.1.2.2.1.1.2.3.cmml" xref="A3.Ex8.m1.1.1.1.1.2.2.1.1.2.3"><times id="A3.Ex8.m1.1.1.1.1.2.2.1.1.2.3.1.cmml" xref="A3.Ex8.m1.1.1.1.1.2.2.1.1.2.3.1"></times><ci id="A3.Ex8.m1.1.1.1.1.2.2.1.1.2.3.2.cmml" xref="A3.Ex8.m1.1.1.1.1.2.2.1.1.2.3.2">𝑖</ci><ci id="A3.Ex8.m1.1.1.1.1.2.2.1.1.2.3.3.cmml" xref="A3.Ex8.m1.1.1.1.1.2.2.1.1.2.3.3">𝑗</ci></apply></apply><apply id="A3.Ex8.m1.1.1.1.1.2.2.1.1.3.cmml" xref="A3.Ex8.m1.1.1.1.1.2.2.1.1.3"><csymbol cd="ambiguous" id="A3.Ex8.m1.1.1.1.1.2.2.1.1.3.1.cmml" xref="A3.Ex8.m1.1.1.1.1.2.2.1.1.3">superscript</csymbol><ci id="A3.Ex8.m1.1.1.1.1.2.2.1.1.3.2.cmml" xref="A3.Ex8.m1.1.1.1.1.2.2.1.1.3.2">𝑒</ci><apply id="A3.Ex8.m1.1.1.1.1.2.2.1.1.3.3.cmml" xref="A3.Ex8.m1.1.1.1.1.2.2.1.1.3.3"><divide id="A3.Ex8.m1.1.1.1.1.2.2.1.1.3.3.1.cmml" xref="A3.Ex8.m1.1.1.1.1.2.2.1.1.3.3"></divide><apply id="A3.Ex8.m1.1.1.1.1.2.2.1.1.3.3.2.cmml" xref="A3.Ex8.m1.1.1.1.1.2.2.1.1.3.3.2"><times id="A3.Ex8.m1.1.1.1.1.2.2.1.1.3.3.2.1.cmml" xref="A3.Ex8.m1.1.1.1.1.2.2.1.1.3.3.2.1"></times><apply id="A3.Ex8.m1.1.1.1.1.2.2.1.1.3.3.2.2.cmml" xref="A3.Ex8.m1.1.1.1.1.2.2.1.1.3.3.2.2"><csymbol cd="ambiguous" id="A3.Ex8.m1.1.1.1.1.2.2.1.1.3.3.2.2.1.cmml" xref="A3.Ex8.m1.1.1.1.1.2.2.1.1.3.3.2.2">subscript</csymbol><ci id="A3.Ex8.m1.1.1.1.1.2.2.1.1.3.3.2.2.2.cmml" xref="A3.Ex8.m1.1.1.1.1.2.2.1.1.3.3.2.2.2">𝑘</ci><ci id="A3.Ex8.m1.1.1.1.1.2.2.1.1.3.3.2.2.3.cmml" xref="A3.Ex8.m1.1.1.1.1.2.2.1.1.3.3.2.2.3">𝑖</ci></apply><apply id="A3.Ex8.m1.1.1.1.1.2.2.1.1.3.3.2.3.cmml" xref="A3.Ex8.m1.1.1.1.1.2.2.1.1.3.3.2.3"><csymbol cd="ambiguous" id="A3.Ex8.m1.1.1.1.1.2.2.1.1.3.3.2.3.1.cmml" xref="A3.Ex8.m1.1.1.1.1.2.2.1.1.3.3.2.3">superscript</csymbol><apply id="A3.Ex8.m1.1.1.1.1.2.2.1.1.3.3.2.3.2.cmml" xref="A3.Ex8.m1.1.1.1.1.2.2.1.1.3.3.2.3"><csymbol cd="ambiguous" id="A3.Ex8.m1.1.1.1.1.2.2.1.1.3.3.2.3.2.1.cmml" xref="A3.Ex8.m1.1.1.1.1.2.2.1.1.3.3.2.3">subscript</csymbol><ci id="A3.Ex8.m1.1.1.1.1.2.2.1.1.3.3.2.3.2.2.cmml" xref="A3.Ex8.m1.1.1.1.1.2.2.1.1.3.3.2.3.2.2">𝑘</ci><ci id="A3.Ex8.m1.1.1.1.1.2.2.1.1.3.3.2.3.2.3.cmml" xref="A3.Ex8.m1.1.1.1.1.2.2.1.1.3.3.2.3.2.3">𝑗</ci></apply><csymbol cd="latexml" id="A3.Ex8.m1.1.1.1.1.2.2.1.1.3.3.2.3.3.cmml" xref="A3.Ex8.m1.1.1.1.1.2.2.1.1.3.3.2.3.3">top</csymbol></apply></apply><apply id="A3.Ex8.m1.1.1.1.1.2.2.1.1.3.3.3.cmml" xref="A3.Ex8.m1.1.1.1.1.2.2.1.1.3.3.3"><root id="A3.Ex8.m1.1.1.1.1.2.2.1.1.3.3.3a.cmml" xref="A3.Ex8.m1.1.1.1.1.2.2.1.1.3.3.3"></root><ci id="A3.Ex8.m1.1.1.1.1.2.2.1.1.3.3.3.2.cmml" xref="A3.Ex8.m1.1.1.1.1.2.2.1.1.3.3.3.2">𝐷</ci></apply></apply></apply></apply><apply id="A3.Ex8.m1.1.1.1.1.2.2.2.2.cmml" xref="A3.Ex8.m1.1.1.1.1.2.2.2.2"><eq id="A3.Ex8.m1.1.1.1.1.2.2.2.2.1.cmml" xref="A3.Ex8.m1.1.1.1.1.2.2.2.2.1"></eq><apply id="A3.Ex8.m1.1.1.1.1.2.2.2.2.2.cmml" xref="A3.Ex8.m1.1.1.1.1.2.2.2.2.2"><csymbol cd="ambiguous" id="A3.Ex8.m1.1.1.1.1.2.2.2.2.2.1.cmml" xref="A3.Ex8.m1.1.1.1.1.2.2.2.2.2">subscript</csymbol><apply id="A3.Ex8.m1.1.1.1.1.2.2.2.2.2.2.cmml" xref="A3.Ex8.m1.1.1.1.1.2.2.2.2.2"><csymbol cd="ambiguous" id="A3.Ex8.m1.1.1.1.1.2.2.2.2.2.2.1.cmml" xref="A3.Ex8.m1.1.1.1.1.2.2.2.2.2">superscript</csymbol><ci id="A3.Ex8.m1.1.1.1.1.2.2.2.2.2.2.2.cmml" xref="A3.Ex8.m1.1.1.1.1.2.2.2.2.2.2.2">𝑎</ci><apply id="A3.Ex8.m1.1.1.1.1.2.2.2.2.2.2.3.cmml" xref="A3.Ex8.m1.1.1.1.1.2.2.2.2.2.2.3"><times id="A3.Ex8.m1.1.1.1.1.2.2.2.2.2.2.3.1.cmml" xref="A3.Ex8.m1.1.1.1.1.2.2.2.2.2.2.3.1"></times><ci id="A3.Ex8.m1.1.1.1.1.2.2.2.2.2.2.3.2.cmml" xref="A3.Ex8.m1.1.1.1.1.2.2.2.2.2.2.3.2">𝑣</ci><ci id="A3.Ex8.m1.1.1.1.1.2.2.2.2.2.2.3.3.cmml" xref="A3.Ex8.m1.1.1.1.1.2.2.2.2.2.2.3.3">𝑣</ci></apply></apply><apply id="A3.Ex8.m1.1.1.1.1.2.2.2.2.2.3.cmml" xref="A3.Ex8.m1.1.1.1.1.2.2.2.2.2.3"><times id="A3.Ex8.m1.1.1.1.1.2.2.2.2.2.3.1.cmml" xref="A3.Ex8.m1.1.1.1.1.2.2.2.2.2.3.1"></times><ci id="A3.Ex8.m1.1.1.1.1.2.2.2.2.2.3.2.cmml" xref="A3.Ex8.m1.1.1.1.1.2.2.2.2.2.3.2">𝑖</ci><ci id="A3.Ex8.m1.1.1.1.1.2.2.2.2.2.3.3.cmml" xref="A3.Ex8.m1.1.1.1.1.2.2.2.2.2.3.3">𝑗</ci></apply></apply><apply id="A3.Ex8.m1.1.1.1.1.2.2.2.2.3.cmml" xref="A3.Ex8.m1.1.1.1.1.2.2.2.2.3"><csymbol cd="ambiguous" id="A3.Ex8.m1.1.1.1.1.2.2.2.2.3.1.cmml" xref="A3.Ex8.m1.1.1.1.1.2.2.2.2.3">superscript</csymbol><ci id="A3.Ex8.m1.1.1.1.1.2.2.2.2.3.2.cmml" xref="A3.Ex8.m1.1.1.1.1.2.2.2.2.3.2">𝑒</ci><apply id="A3.Ex8.m1.1.1.1.1.2.2.2.2.3.3.cmml" xref="A3.Ex8.m1.1.1.1.1.2.2.2.2.3.3"><divide id="A3.Ex8.m1.1.1.1.1.2.2.2.2.3.3.1.cmml" xref="A3.Ex8.m1.1.1.1.1.2.2.2.2.3.3"></divide><apply id="A3.Ex8.m1.1.1.1.1.2.2.2.2.3.3.2.cmml" xref="A3.Ex8.m1.1.1.1.1.2.2.2.2.3.3.2"><times id="A3.Ex8.m1.1.1.1.1.2.2.2.2.3.3.2.1.cmml" xref="A3.Ex8.m1.1.1.1.1.2.2.2.2.3.3.2.1"></times><apply id="A3.Ex8.m1.1.1.1.1.2.2.2.2.3.3.2.2.cmml" xref="A3.Ex8.m1.1.1.1.1.2.2.2.2.3.3.2.2"><csymbol cd="ambiguous" id="A3.Ex8.m1.1.1.1.1.2.2.2.2.3.3.2.2.1.cmml" xref="A3.Ex8.m1.1.1.1.1.2.2.2.2.3.3.2.2">subscript</csymbol><ci id="A3.Ex8.m1.1.1.1.1.2.2.2.2.3.3.2.2.2.cmml" xref="A3.Ex8.m1.1.1.1.1.2.2.2.2.3.3.2.2.2">𝑣</ci><ci id="A3.Ex8.m1.1.1.1.1.2.2.2.2.3.3.2.2.3.cmml" xref="A3.Ex8.m1.1.1.1.1.2.2.2.2.3.3.2.2.3">𝑖</ci></apply><apply id="A3.Ex8.m1.1.1.1.1.2.2.2.2.3.3.2.3.cmml" xref="A3.Ex8.m1.1.1.1.1.2.2.2.2.3.3.2.3"><csymbol cd="ambiguous" id="A3.Ex8.m1.1.1.1.1.2.2.2.2.3.3.2.3.1.cmml" xref="A3.Ex8.m1.1.1.1.1.2.2.2.2.3.3.2.3">superscript</csymbol><apply id="A3.Ex8.m1.1.1.1.1.2.2.2.2.3.3.2.3.2.cmml" xref="A3.Ex8.m1.1.1.1.1.2.2.2.2.3.3.2.3"><csymbol cd="ambiguous" id="A3.Ex8.m1.1.1.1.1.2.2.2.2.3.3.2.3.2.1.cmml" xref="A3.Ex8.m1.1.1.1.1.2.2.2.2.3.3.2.3">subscript</csymbol><ci id="A3.Ex8.m1.1.1.1.1.2.2.2.2.3.3.2.3.2.2.cmml" xref="A3.Ex8.m1.1.1.1.1.2.2.2.2.3.3.2.3.2.2">𝑣</ci><ci id="A3.Ex8.m1.1.1.1.1.2.2.2.2.3.3.2.3.2.3.cmml" xref="A3.Ex8.m1.1.1.1.1.2.2.2.2.3.3.2.3.2.3">𝑗</ci></apply><csymbol cd="latexml" id="A3.Ex8.m1.1.1.1.1.2.2.2.2.3.3.2.3.3.cmml" xref="A3.Ex8.m1.1.1.1.1.2.2.2.2.3.3.2.3.3">top</csymbol></apply></apply><apply id="A3.Ex8.m1.1.1.1.1.2.2.2.2.3.3.3.cmml" xref="A3.Ex8.m1.1.1.1.1.2.2.2.2.3.3.3"><root id="A3.Ex8.m1.1.1.1.1.2.2.2.2.3.3.3a.cmml" xref="A3.Ex8.m1.1.1.1.1.2.2.2.2.3.3.3"></root><ci id="A3.Ex8.m1.1.1.1.1.2.2.2.2.3.3.3.2.cmml" xref="A3.Ex8.m1.1.1.1.1.2.2.2.2.3.3.3.2">𝐷</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.Ex8.m1.1c">a^{qq}_{ij}=e^{\frac{q_{i}q_{j}^{\top}}{\sqrt{D}}},\quad a^{kk}_{ij}=e^{\frac{k_{i}k_{j}^{\top}}{\sqrt{D}}},\quad a^{vv}_{ij}=e^{\frac{v_{i}v_{j}^{\top}}{\sqrt{D}}}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="A3.p1.64" class="ltx_p"><span id="A3.p1.64.1" class="ltx_text" style="color:#FF8000;">This modification ensures that </span><math id="A3.p1.35.m1.1" class="ltx_Math" alttext="q_{i}" display="inline"><semantics id="A3.p1.35.m1.1a"><msub id="A3.p1.35.m1.1.1" xref="A3.p1.35.m1.1.1.cmml"><mi mathcolor="#FF8000" id="A3.p1.35.m1.1.1.2" xref="A3.p1.35.m1.1.1.2.cmml">q</mi><mi mathcolor="#FF8000" id="A3.p1.35.m1.1.1.3" xref="A3.p1.35.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A3.p1.35.m1.1b"><apply id="A3.p1.35.m1.1.1.cmml" xref="A3.p1.35.m1.1.1"><csymbol cd="ambiguous" id="A3.p1.35.m1.1.1.1.cmml" xref="A3.p1.35.m1.1.1">subscript</csymbol><ci id="A3.p1.35.m1.1.1.2.cmml" xref="A3.p1.35.m1.1.1.2">𝑞</ci><ci id="A3.p1.35.m1.1.1.3.cmml" xref="A3.p1.35.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.35.m1.1c">q_{i}</annotation></semantics></math><span id="A3.p1.64.2" class="ltx_text" style="color:#FF8000;">, </span><math id="A3.p1.36.m2.1" class="ltx_Math" alttext="k_{i}" display="inline"><semantics id="A3.p1.36.m2.1a"><msub id="A3.p1.36.m2.1.1" xref="A3.p1.36.m2.1.1.cmml"><mi mathcolor="#FF8000" id="A3.p1.36.m2.1.1.2" xref="A3.p1.36.m2.1.1.2.cmml">k</mi><mi mathcolor="#FF8000" id="A3.p1.36.m2.1.1.3" xref="A3.p1.36.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A3.p1.36.m2.1b"><apply id="A3.p1.36.m2.1.1.cmml" xref="A3.p1.36.m2.1.1"><csymbol cd="ambiguous" id="A3.p1.36.m2.1.1.1.cmml" xref="A3.p1.36.m2.1.1">subscript</csymbol><ci id="A3.p1.36.m2.1.1.2.cmml" xref="A3.p1.36.m2.1.1.2">𝑘</ci><ci id="A3.p1.36.m2.1.1.3.cmml" xref="A3.p1.36.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.36.m2.1c">k_{i}</annotation></semantics></math><span id="A3.p1.64.3" class="ltx_text" style="color:#FF8000;">, and </span><math id="A3.p1.37.m3.1" class="ltx_Math" alttext="v_{i}" display="inline"><semantics id="A3.p1.37.m3.1a"><msub id="A3.p1.37.m3.1.1" xref="A3.p1.37.m3.1.1.cmml"><mi mathcolor="#FF8000" id="A3.p1.37.m3.1.1.2" xref="A3.p1.37.m3.1.1.2.cmml">v</mi><mi mathcolor="#FF8000" id="A3.p1.37.m3.1.1.3" xref="A3.p1.37.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A3.p1.37.m3.1b"><apply id="A3.p1.37.m3.1.1.cmml" xref="A3.p1.37.m3.1.1"><csymbol cd="ambiguous" id="A3.p1.37.m3.1.1.1.cmml" xref="A3.p1.37.m3.1.1">subscript</csymbol><ci id="A3.p1.37.m3.1.1.2.cmml" xref="A3.p1.37.m3.1.1.2">𝑣</ci><ci id="A3.p1.37.m3.1.1.3.cmml" xref="A3.p1.37.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.37.m3.1c">v_{i}</annotation></semantics></math><span id="A3.p1.64.4" class="ltx_text" style="color:#FF8000;"> hold significant weight in forming </span><math id="A3.p1.38.m4.3" class="ltx_Math" alttext="Attention({Q},{Q},{V})_{i}" display="inline"><semantics id="A3.p1.38.m4.3a"><mrow id="A3.p1.38.m4.3.4" xref="A3.p1.38.m4.3.4.cmml"><mi mathcolor="#FF8000" id="A3.p1.38.m4.3.4.2" xref="A3.p1.38.m4.3.4.2.cmml">A</mi><mo lspace="0em" rspace="0em" id="A3.p1.38.m4.3.4.1" xref="A3.p1.38.m4.3.4.1.cmml">​</mo><mi mathcolor="#FF8000" id="A3.p1.38.m4.3.4.3" xref="A3.p1.38.m4.3.4.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="A3.p1.38.m4.3.4.1a" xref="A3.p1.38.m4.3.4.1.cmml">​</mo><mi mathcolor="#FF8000" id="A3.p1.38.m4.3.4.4" xref="A3.p1.38.m4.3.4.4.cmml">t</mi><mo lspace="0em" rspace="0em" id="A3.p1.38.m4.3.4.1b" xref="A3.p1.38.m4.3.4.1.cmml">​</mo><mi mathcolor="#FF8000" id="A3.p1.38.m4.3.4.5" xref="A3.p1.38.m4.3.4.5.cmml">e</mi><mo lspace="0em" rspace="0em" id="A3.p1.38.m4.3.4.1c" xref="A3.p1.38.m4.3.4.1.cmml">​</mo><mi mathcolor="#FF8000" id="A3.p1.38.m4.3.4.6" xref="A3.p1.38.m4.3.4.6.cmml">n</mi><mo lspace="0em" rspace="0em" id="A3.p1.38.m4.3.4.1d" xref="A3.p1.38.m4.3.4.1.cmml">​</mo><mi mathcolor="#FF8000" id="A3.p1.38.m4.3.4.7" xref="A3.p1.38.m4.3.4.7.cmml">t</mi><mo lspace="0em" rspace="0em" id="A3.p1.38.m4.3.4.1e" xref="A3.p1.38.m4.3.4.1.cmml">​</mo><mi mathcolor="#FF8000" id="A3.p1.38.m4.3.4.8" xref="A3.p1.38.m4.3.4.8.cmml">i</mi><mo lspace="0em" rspace="0em" id="A3.p1.38.m4.3.4.1f" xref="A3.p1.38.m4.3.4.1.cmml">​</mo><mi mathcolor="#FF8000" id="A3.p1.38.m4.3.4.9" xref="A3.p1.38.m4.3.4.9.cmml">o</mi><mo lspace="0em" rspace="0em" id="A3.p1.38.m4.3.4.1g" xref="A3.p1.38.m4.3.4.1.cmml">​</mo><mi mathcolor="#FF8000" id="A3.p1.38.m4.3.4.10" xref="A3.p1.38.m4.3.4.10.cmml">n</mi><mo lspace="0em" rspace="0em" id="A3.p1.38.m4.3.4.1h" xref="A3.p1.38.m4.3.4.1.cmml">​</mo><msub id="A3.p1.38.m4.3.4.11" xref="A3.p1.38.m4.3.4.11.cmml"><mrow id="A3.p1.38.m4.3.4.11.2.2" xref="A3.p1.38.m4.3.4.11.2.1.cmml"><mo mathcolor="#FF8000" stretchy="false" id="A3.p1.38.m4.3.4.11.2.2.1" xref="A3.p1.38.m4.3.4.11.2.1.cmml">(</mo><mi mathcolor="#FF8000" id="A3.p1.38.m4.1.1" xref="A3.p1.38.m4.1.1.cmml">Q</mi><mo mathcolor="#FF8000" id="A3.p1.38.m4.3.4.11.2.2.2" xref="A3.p1.38.m4.3.4.11.2.1.cmml">,</mo><mi mathcolor="#FF8000" id="A3.p1.38.m4.2.2" xref="A3.p1.38.m4.2.2.cmml">Q</mi><mo mathcolor="#FF8000" id="A3.p1.38.m4.3.4.11.2.2.3" xref="A3.p1.38.m4.3.4.11.2.1.cmml">,</mo><mi mathcolor="#FF8000" id="A3.p1.38.m4.3.3" xref="A3.p1.38.m4.3.3.cmml">V</mi><mo mathcolor="#FF8000" stretchy="false" id="A3.p1.38.m4.3.4.11.2.2.4" xref="A3.p1.38.m4.3.4.11.2.1.cmml">)</mo></mrow><mi mathcolor="#FF8000" id="A3.p1.38.m4.3.4.11.3" xref="A3.p1.38.m4.3.4.11.3.cmml">i</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="A3.p1.38.m4.3b"><apply id="A3.p1.38.m4.3.4.cmml" xref="A3.p1.38.m4.3.4"><times id="A3.p1.38.m4.3.4.1.cmml" xref="A3.p1.38.m4.3.4.1"></times><ci id="A3.p1.38.m4.3.4.2.cmml" xref="A3.p1.38.m4.3.4.2">𝐴</ci><ci id="A3.p1.38.m4.3.4.3.cmml" xref="A3.p1.38.m4.3.4.3">𝑡</ci><ci id="A3.p1.38.m4.3.4.4.cmml" xref="A3.p1.38.m4.3.4.4">𝑡</ci><ci id="A3.p1.38.m4.3.4.5.cmml" xref="A3.p1.38.m4.3.4.5">𝑒</ci><ci id="A3.p1.38.m4.3.4.6.cmml" xref="A3.p1.38.m4.3.4.6">𝑛</ci><ci id="A3.p1.38.m4.3.4.7.cmml" xref="A3.p1.38.m4.3.4.7">𝑡</ci><ci id="A3.p1.38.m4.3.4.8.cmml" xref="A3.p1.38.m4.3.4.8">𝑖</ci><ci id="A3.p1.38.m4.3.4.9.cmml" xref="A3.p1.38.m4.3.4.9">𝑜</ci><ci id="A3.p1.38.m4.3.4.10.cmml" xref="A3.p1.38.m4.3.4.10">𝑛</ci><apply id="A3.p1.38.m4.3.4.11.cmml" xref="A3.p1.38.m4.3.4.11"><csymbol cd="ambiguous" id="A3.p1.38.m4.3.4.11.1.cmml" xref="A3.p1.38.m4.3.4.11">subscript</csymbol><vector id="A3.p1.38.m4.3.4.11.2.1.cmml" xref="A3.p1.38.m4.3.4.11.2.2"><ci id="A3.p1.38.m4.1.1.cmml" xref="A3.p1.38.m4.1.1">𝑄</ci><ci id="A3.p1.38.m4.2.2.cmml" xref="A3.p1.38.m4.2.2">𝑄</ci><ci id="A3.p1.38.m4.3.3.cmml" xref="A3.p1.38.m4.3.3">𝑉</ci></vector><ci id="A3.p1.38.m4.3.4.11.3.cmml" xref="A3.p1.38.m4.3.4.11.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.38.m4.3c">Attention({Q},{Q},{V})_{i}</annotation></semantics></math><span id="A3.p1.64.5" class="ltx_text" style="color:#FF8000;">, </span><math id="A3.p1.39.m5.3" class="ltx_Math" alttext="Attention({K},{K},{V})_{i}" display="inline"><semantics id="A3.p1.39.m5.3a"><mrow id="A3.p1.39.m5.3.4" xref="A3.p1.39.m5.3.4.cmml"><mi mathcolor="#FF8000" id="A3.p1.39.m5.3.4.2" xref="A3.p1.39.m5.3.4.2.cmml">A</mi><mo lspace="0em" rspace="0em" id="A3.p1.39.m5.3.4.1" xref="A3.p1.39.m5.3.4.1.cmml">​</mo><mi mathcolor="#FF8000" id="A3.p1.39.m5.3.4.3" xref="A3.p1.39.m5.3.4.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="A3.p1.39.m5.3.4.1a" xref="A3.p1.39.m5.3.4.1.cmml">​</mo><mi mathcolor="#FF8000" id="A3.p1.39.m5.3.4.4" xref="A3.p1.39.m5.3.4.4.cmml">t</mi><mo lspace="0em" rspace="0em" id="A3.p1.39.m5.3.4.1b" xref="A3.p1.39.m5.3.4.1.cmml">​</mo><mi mathcolor="#FF8000" id="A3.p1.39.m5.3.4.5" xref="A3.p1.39.m5.3.4.5.cmml">e</mi><mo lspace="0em" rspace="0em" id="A3.p1.39.m5.3.4.1c" xref="A3.p1.39.m5.3.4.1.cmml">​</mo><mi mathcolor="#FF8000" id="A3.p1.39.m5.3.4.6" xref="A3.p1.39.m5.3.4.6.cmml">n</mi><mo lspace="0em" rspace="0em" id="A3.p1.39.m5.3.4.1d" xref="A3.p1.39.m5.3.4.1.cmml">​</mo><mi mathcolor="#FF8000" id="A3.p1.39.m5.3.4.7" xref="A3.p1.39.m5.3.4.7.cmml">t</mi><mo lspace="0em" rspace="0em" id="A3.p1.39.m5.3.4.1e" xref="A3.p1.39.m5.3.4.1.cmml">​</mo><mi mathcolor="#FF8000" id="A3.p1.39.m5.3.4.8" xref="A3.p1.39.m5.3.4.8.cmml">i</mi><mo lspace="0em" rspace="0em" id="A3.p1.39.m5.3.4.1f" xref="A3.p1.39.m5.3.4.1.cmml">​</mo><mi mathcolor="#FF8000" id="A3.p1.39.m5.3.4.9" xref="A3.p1.39.m5.3.4.9.cmml">o</mi><mo lspace="0em" rspace="0em" id="A3.p1.39.m5.3.4.1g" xref="A3.p1.39.m5.3.4.1.cmml">​</mo><mi mathcolor="#FF8000" id="A3.p1.39.m5.3.4.10" xref="A3.p1.39.m5.3.4.10.cmml">n</mi><mo lspace="0em" rspace="0em" id="A3.p1.39.m5.3.4.1h" xref="A3.p1.39.m5.3.4.1.cmml">​</mo><msub id="A3.p1.39.m5.3.4.11" xref="A3.p1.39.m5.3.4.11.cmml"><mrow id="A3.p1.39.m5.3.4.11.2.2" xref="A3.p1.39.m5.3.4.11.2.1.cmml"><mo mathcolor="#FF8000" stretchy="false" id="A3.p1.39.m5.3.4.11.2.2.1" xref="A3.p1.39.m5.3.4.11.2.1.cmml">(</mo><mi mathcolor="#FF8000" id="A3.p1.39.m5.1.1" xref="A3.p1.39.m5.1.1.cmml">K</mi><mo mathcolor="#FF8000" id="A3.p1.39.m5.3.4.11.2.2.2" xref="A3.p1.39.m5.3.4.11.2.1.cmml">,</mo><mi mathcolor="#FF8000" id="A3.p1.39.m5.2.2" xref="A3.p1.39.m5.2.2.cmml">K</mi><mo mathcolor="#FF8000" id="A3.p1.39.m5.3.4.11.2.2.3" xref="A3.p1.39.m5.3.4.11.2.1.cmml">,</mo><mi mathcolor="#FF8000" id="A3.p1.39.m5.3.3" xref="A3.p1.39.m5.3.3.cmml">V</mi><mo mathcolor="#FF8000" stretchy="false" id="A3.p1.39.m5.3.4.11.2.2.4" xref="A3.p1.39.m5.3.4.11.2.1.cmml">)</mo></mrow><mi mathcolor="#FF8000" id="A3.p1.39.m5.3.4.11.3" xref="A3.p1.39.m5.3.4.11.3.cmml">i</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="A3.p1.39.m5.3b"><apply id="A3.p1.39.m5.3.4.cmml" xref="A3.p1.39.m5.3.4"><times id="A3.p1.39.m5.3.4.1.cmml" xref="A3.p1.39.m5.3.4.1"></times><ci id="A3.p1.39.m5.3.4.2.cmml" xref="A3.p1.39.m5.3.4.2">𝐴</ci><ci id="A3.p1.39.m5.3.4.3.cmml" xref="A3.p1.39.m5.3.4.3">𝑡</ci><ci id="A3.p1.39.m5.3.4.4.cmml" xref="A3.p1.39.m5.3.4.4">𝑡</ci><ci id="A3.p1.39.m5.3.4.5.cmml" xref="A3.p1.39.m5.3.4.5">𝑒</ci><ci id="A3.p1.39.m5.3.4.6.cmml" xref="A3.p1.39.m5.3.4.6">𝑛</ci><ci id="A3.p1.39.m5.3.4.7.cmml" xref="A3.p1.39.m5.3.4.7">𝑡</ci><ci id="A3.p1.39.m5.3.4.8.cmml" xref="A3.p1.39.m5.3.4.8">𝑖</ci><ci id="A3.p1.39.m5.3.4.9.cmml" xref="A3.p1.39.m5.3.4.9">𝑜</ci><ci id="A3.p1.39.m5.3.4.10.cmml" xref="A3.p1.39.m5.3.4.10">𝑛</ci><apply id="A3.p1.39.m5.3.4.11.cmml" xref="A3.p1.39.m5.3.4.11"><csymbol cd="ambiguous" id="A3.p1.39.m5.3.4.11.1.cmml" xref="A3.p1.39.m5.3.4.11">subscript</csymbol><vector id="A3.p1.39.m5.3.4.11.2.1.cmml" xref="A3.p1.39.m5.3.4.11.2.2"><ci id="A3.p1.39.m5.1.1.cmml" xref="A3.p1.39.m5.1.1">𝐾</ci><ci id="A3.p1.39.m5.2.2.cmml" xref="A3.p1.39.m5.2.2">𝐾</ci><ci id="A3.p1.39.m5.3.3.cmml" xref="A3.p1.39.m5.3.3">𝑉</ci></vector><ci id="A3.p1.39.m5.3.4.11.3.cmml" xref="A3.p1.39.m5.3.4.11.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.39.m5.3c">Attention({K},{K},{V})_{i}</annotation></semantics></math><span id="A3.p1.64.6" class="ltx_text" style="color:#FF8000;">, and </span><math id="A3.p1.40.m6.3" class="ltx_Math" alttext="Attention({V},{V},{V})_{i}" display="inline"><semantics id="A3.p1.40.m6.3a"><mrow id="A3.p1.40.m6.3.4" xref="A3.p1.40.m6.3.4.cmml"><mi mathcolor="#FF8000" id="A3.p1.40.m6.3.4.2" xref="A3.p1.40.m6.3.4.2.cmml">A</mi><mo lspace="0em" rspace="0em" id="A3.p1.40.m6.3.4.1" xref="A3.p1.40.m6.3.4.1.cmml">​</mo><mi mathcolor="#FF8000" id="A3.p1.40.m6.3.4.3" xref="A3.p1.40.m6.3.4.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="A3.p1.40.m6.3.4.1a" xref="A3.p1.40.m6.3.4.1.cmml">​</mo><mi mathcolor="#FF8000" id="A3.p1.40.m6.3.4.4" xref="A3.p1.40.m6.3.4.4.cmml">t</mi><mo lspace="0em" rspace="0em" id="A3.p1.40.m6.3.4.1b" xref="A3.p1.40.m6.3.4.1.cmml">​</mo><mi mathcolor="#FF8000" id="A3.p1.40.m6.3.4.5" xref="A3.p1.40.m6.3.4.5.cmml">e</mi><mo lspace="0em" rspace="0em" id="A3.p1.40.m6.3.4.1c" xref="A3.p1.40.m6.3.4.1.cmml">​</mo><mi mathcolor="#FF8000" id="A3.p1.40.m6.3.4.6" xref="A3.p1.40.m6.3.4.6.cmml">n</mi><mo lspace="0em" rspace="0em" id="A3.p1.40.m6.3.4.1d" xref="A3.p1.40.m6.3.4.1.cmml">​</mo><mi mathcolor="#FF8000" id="A3.p1.40.m6.3.4.7" xref="A3.p1.40.m6.3.4.7.cmml">t</mi><mo lspace="0em" rspace="0em" id="A3.p1.40.m6.3.4.1e" xref="A3.p1.40.m6.3.4.1.cmml">​</mo><mi mathcolor="#FF8000" id="A3.p1.40.m6.3.4.8" xref="A3.p1.40.m6.3.4.8.cmml">i</mi><mo lspace="0em" rspace="0em" id="A3.p1.40.m6.3.4.1f" xref="A3.p1.40.m6.3.4.1.cmml">​</mo><mi mathcolor="#FF8000" id="A3.p1.40.m6.3.4.9" xref="A3.p1.40.m6.3.4.9.cmml">o</mi><mo lspace="0em" rspace="0em" id="A3.p1.40.m6.3.4.1g" xref="A3.p1.40.m6.3.4.1.cmml">​</mo><mi mathcolor="#FF8000" id="A3.p1.40.m6.3.4.10" xref="A3.p1.40.m6.3.4.10.cmml">n</mi><mo lspace="0em" rspace="0em" id="A3.p1.40.m6.3.4.1h" xref="A3.p1.40.m6.3.4.1.cmml">​</mo><msub id="A3.p1.40.m6.3.4.11" xref="A3.p1.40.m6.3.4.11.cmml"><mrow id="A3.p1.40.m6.3.4.11.2.2" xref="A3.p1.40.m6.3.4.11.2.1.cmml"><mo mathcolor="#FF8000" stretchy="false" id="A3.p1.40.m6.3.4.11.2.2.1" xref="A3.p1.40.m6.3.4.11.2.1.cmml">(</mo><mi mathcolor="#FF8000" id="A3.p1.40.m6.1.1" xref="A3.p1.40.m6.1.1.cmml">V</mi><mo mathcolor="#FF8000" id="A3.p1.40.m6.3.4.11.2.2.2" xref="A3.p1.40.m6.3.4.11.2.1.cmml">,</mo><mi mathcolor="#FF8000" id="A3.p1.40.m6.2.2" xref="A3.p1.40.m6.2.2.cmml">V</mi><mo mathcolor="#FF8000" id="A3.p1.40.m6.3.4.11.2.2.3" xref="A3.p1.40.m6.3.4.11.2.1.cmml">,</mo><mi mathcolor="#FF8000" id="A3.p1.40.m6.3.3" xref="A3.p1.40.m6.3.3.cmml">V</mi><mo mathcolor="#FF8000" stretchy="false" id="A3.p1.40.m6.3.4.11.2.2.4" xref="A3.p1.40.m6.3.4.11.2.1.cmml">)</mo></mrow><mi mathcolor="#FF8000" id="A3.p1.40.m6.3.4.11.3" xref="A3.p1.40.m6.3.4.11.3.cmml">i</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="A3.p1.40.m6.3b"><apply id="A3.p1.40.m6.3.4.cmml" xref="A3.p1.40.m6.3.4"><times id="A3.p1.40.m6.3.4.1.cmml" xref="A3.p1.40.m6.3.4.1"></times><ci id="A3.p1.40.m6.3.4.2.cmml" xref="A3.p1.40.m6.3.4.2">𝐴</ci><ci id="A3.p1.40.m6.3.4.3.cmml" xref="A3.p1.40.m6.3.4.3">𝑡</ci><ci id="A3.p1.40.m6.3.4.4.cmml" xref="A3.p1.40.m6.3.4.4">𝑡</ci><ci id="A3.p1.40.m6.3.4.5.cmml" xref="A3.p1.40.m6.3.4.5">𝑒</ci><ci id="A3.p1.40.m6.3.4.6.cmml" xref="A3.p1.40.m6.3.4.6">𝑛</ci><ci id="A3.p1.40.m6.3.4.7.cmml" xref="A3.p1.40.m6.3.4.7">𝑡</ci><ci id="A3.p1.40.m6.3.4.8.cmml" xref="A3.p1.40.m6.3.4.8">𝑖</ci><ci id="A3.p1.40.m6.3.4.9.cmml" xref="A3.p1.40.m6.3.4.9">𝑜</ci><ci id="A3.p1.40.m6.3.4.10.cmml" xref="A3.p1.40.m6.3.4.10">𝑛</ci><apply id="A3.p1.40.m6.3.4.11.cmml" xref="A3.p1.40.m6.3.4.11"><csymbol cd="ambiguous" id="A3.p1.40.m6.3.4.11.1.cmml" xref="A3.p1.40.m6.3.4.11">subscript</csymbol><vector id="A3.p1.40.m6.3.4.11.2.1.cmml" xref="A3.p1.40.m6.3.4.11.2.2"><ci id="A3.p1.40.m6.1.1.cmml" xref="A3.p1.40.m6.1.1">𝑉</ci><ci id="A3.p1.40.m6.2.2.cmml" xref="A3.p1.40.m6.2.2">𝑉</ci><ci id="A3.p1.40.m6.3.3.cmml" xref="A3.p1.40.m6.3.3">𝑉</ci></vector><ci id="A3.p1.40.m6.3.4.11.3.cmml" xref="A3.p1.40.m6.3.4.11.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.40.m6.3c">Attention({V},{V},{V})_{i}</annotation></semantics></math><span id="A3.p1.64.7" class="ltx_text" style="color:#FF8000;">, thereby preserving local visual semantics. As a result, the produced attention maps exhibit a more diagonal prominence compared to the original Q-K attention, leading to improved performance in anomaly segmentation, as shown in Fig.</span><a href="#S3.F3.sf3" title="In Figure 3 ‣ Refinement of the local visual space ‣ 3.3 Learning generic abnormality and normality prompts ‣ 3 AnomalyCLIP: object-agnostic prompt learning ‣ AnomalyCLIP: Object-agnostic Prompt Learning for Zero-shot Anomaly Detection" class="ltx_ref" style="color:#FF8000;"><span class="ltx_text ltx_ref_tag">3c</span></a><span id="A3.p1.64.8" class="ltx_text" style="color:#FF8000;">, Fig.</span><a href="#S3.F3.sf4" title="In Figure 3 ‣ Refinement of the local visual space ‣ 3.3 Learning generic abnormality and normality prompts ‣ 3 AnomalyCLIP: object-agnostic prompt learning ‣ AnomalyCLIP: Object-agnostic Prompt Learning for Zero-shot Anomaly Detection" class="ltx_ref" style="color:#FF8000;"><span class="ltx_text ltx_ref_tag">3d</span></a><span id="A3.p1.64.9" class="ltx_text" style="color:#FF8000;">, and Fig. </span><a href="#S3.F3.sf5" title="In Figure 3 ‣ Refinement of the local visual space ‣ 3.3 Learning generic abnormality and normality prompts ‣ 3 AnomalyCLIP: object-agnostic prompt learning ‣ AnomalyCLIP: Object-agnostic Prompt Learning for Zero-shot Anomaly Detection" class="ltx_ref" style="color:#FF8000;"><span class="ltx_text ltx_ref_tag">3e</span></a><span id="A3.p1.64.10" class="ltx_text" style="color:#FF8000;">. However, since </span><math id="A3.p1.41.m7.1" class="ltx_Math" alttext="Q" display="inline"><semantics id="A3.p1.41.m7.1a"><mi mathcolor="#FF8000" id="A3.p1.41.m7.1.1" xref="A3.p1.41.m7.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="A3.p1.41.m7.1b"><ci id="A3.p1.41.m7.1.1.cmml" xref="A3.p1.41.m7.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.41.m7.1c">Q</annotation></semantics></math><span id="A3.p1.64.11" class="ltx_text" style="color:#FF8000;"> and </span><math id="A3.p1.42.m8.1" class="ltx_Math" alttext="K" display="inline"><semantics id="A3.p1.42.m8.1a"><mi mathcolor="#FF8000" id="A3.p1.42.m8.1.1" xref="A3.p1.42.m8.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="A3.p1.42.m8.1b"><ci id="A3.p1.42.m8.1.1.cmml" xref="A3.p1.42.m8.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.42.m8.1c">K</annotation></semantics></math><span id="A3.p1.64.12" class="ltx_text" style="color:#FF8000;"> consist of the original attention map, other important tokens at index </span><math id="A3.p1.43.m9.1" class="ltx_Math" alttext="n" display="inline"><semantics id="A3.p1.43.m9.1a"><mi mathcolor="#FF8000" id="A3.p1.43.m9.1.1" xref="A3.p1.43.m9.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="A3.p1.43.m9.1b"><ci id="A3.p1.43.m9.1.1.cmml" xref="A3.p1.43.m9.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.43.m9.1c">n</annotation></semantics></math><span id="A3.p1.64.13" class="ltx_text" style="color:#FF8000;"> for class recognition within themselves may also produce relatively large scores (</span><math id="A3.p1.44.m10.1" class="ltx_Math" alttext="a_{in}" display="inline"><semantics id="A3.p1.44.m10.1a"><msub id="A3.p1.44.m10.1.1" xref="A3.p1.44.m10.1.1.cmml"><mi mathcolor="#FF8000" id="A3.p1.44.m10.1.1.2" xref="A3.p1.44.m10.1.1.2.cmml">a</mi><mrow id="A3.p1.44.m10.1.1.3" xref="A3.p1.44.m10.1.1.3.cmml"><mi mathcolor="#FF8000" id="A3.p1.44.m10.1.1.3.2" xref="A3.p1.44.m10.1.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="A3.p1.44.m10.1.1.3.1" xref="A3.p1.44.m10.1.1.3.1.cmml">​</mo><mi mathcolor="#FF8000" id="A3.p1.44.m10.1.1.3.3" xref="A3.p1.44.m10.1.1.3.3.cmml">n</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="A3.p1.44.m10.1b"><apply id="A3.p1.44.m10.1.1.cmml" xref="A3.p1.44.m10.1.1"><csymbol cd="ambiguous" id="A3.p1.44.m10.1.1.1.cmml" xref="A3.p1.44.m10.1.1">subscript</csymbol><ci id="A3.p1.44.m10.1.1.2.cmml" xref="A3.p1.44.m10.1.1.2">𝑎</ci><apply id="A3.p1.44.m10.1.1.3.cmml" xref="A3.p1.44.m10.1.1.3"><times id="A3.p1.44.m10.1.1.3.1.cmml" xref="A3.p1.44.m10.1.1.3.1"></times><ci id="A3.p1.44.m10.1.1.3.2.cmml" xref="A3.p1.44.m10.1.1.3.2">𝑖</ci><ci id="A3.p1.44.m10.1.1.3.3.cmml" xref="A3.p1.44.m10.1.1.3.3">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.44.m10.1c">a_{in}</annotation></semantics></math><span id="A3.p1.64.14" class="ltx_text" style="color:#FF8000;">) (e.g., </span><math id="A3.p1.45.m11.1" class="ltx_Math" alttext="q_{i}" display="inline"><semantics id="A3.p1.45.m11.1a"><msub id="A3.p1.45.m11.1.1" xref="A3.p1.45.m11.1.1.cmml"><mi mathcolor="#FF8000" id="A3.p1.45.m11.1.1.2" xref="A3.p1.45.m11.1.1.2.cmml">q</mi><mi mathcolor="#FF8000" id="A3.p1.45.m11.1.1.3" xref="A3.p1.45.m11.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A3.p1.45.m11.1b"><apply id="A3.p1.45.m11.1.1.cmml" xref="A3.p1.45.m11.1.1"><csymbol cd="ambiguous" id="A3.p1.45.m11.1.1.1.cmml" xref="A3.p1.45.m11.1.1">subscript</csymbol><ci id="A3.p1.45.m11.1.1.2.cmml" xref="A3.p1.45.m11.1.1.2">𝑞</ci><ci id="A3.p1.45.m11.1.1.3.cmml" xref="A3.p1.45.m11.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.45.m11.1c">q_{i}</annotation></semantics></math><span id="A3.p1.64.15" class="ltx_text" style="color:#FF8000;"> has strong relevance with </span><math id="A3.p1.46.m12.1" class="ltx_Math" alttext="q_{n}" display="inline"><semantics id="A3.p1.46.m12.1a"><msub id="A3.p1.46.m12.1.1" xref="A3.p1.46.m12.1.1.cmml"><mi mathcolor="#FF8000" id="A3.p1.46.m12.1.1.2" xref="A3.p1.46.m12.1.1.2.cmml">q</mi><mi mathcolor="#FF8000" id="A3.p1.46.m12.1.1.3" xref="A3.p1.46.m12.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="A3.p1.46.m12.1b"><apply id="A3.p1.46.m12.1.1.cmml" xref="A3.p1.46.m12.1.1"><csymbol cd="ambiguous" id="A3.p1.46.m12.1.1.1.cmml" xref="A3.p1.46.m12.1.1">subscript</csymbol><ci id="A3.p1.46.m12.1.1.2.cmml" xref="A3.p1.46.m12.1.1.2">𝑞</ci><ci id="A3.p1.46.m12.1.1.3.cmml" xref="A3.p1.46.m12.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.46.m12.1c">q_{n}</annotation></semantics></math><span id="A3.p1.64.16" class="ltx_text" style="color:#FF8000;">
besides </span><math id="A3.p1.47.m13.1" class="ltx_Math" alttext="q_{i}" display="inline"><semantics id="A3.p1.47.m13.1a"><msub id="A3.p1.47.m13.1.1" xref="A3.p1.47.m13.1.1.cmml"><mi mathcolor="#FF8000" id="A3.p1.47.m13.1.1.2" xref="A3.p1.47.m13.1.1.2.cmml">q</mi><mi mathcolor="#FF8000" id="A3.p1.47.m13.1.1.3" xref="A3.p1.47.m13.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A3.p1.47.m13.1b"><apply id="A3.p1.47.m13.1.1.cmml" xref="A3.p1.47.m13.1.1"><csymbol cd="ambiguous" id="A3.p1.47.m13.1.1.1.cmml" xref="A3.p1.47.m13.1.1">subscript</csymbol><ci id="A3.p1.47.m13.1.1.2.cmml" xref="A3.p1.47.m13.1.1.2">𝑞</ci><ci id="A3.p1.47.m13.1.1.3.cmml" xref="A3.p1.47.m13.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.47.m13.1c">q_{i}</annotation></semantics></math><span id="A3.p1.64.17" class="ltx_text" style="color:#FF8000;">) to disturb </span><math id="A3.p1.48.m14.3" class="ltx_Math" alttext="Attention({Q},{Q},{V})_{i}" display="inline"><semantics id="A3.p1.48.m14.3a"><mrow id="A3.p1.48.m14.3.4" xref="A3.p1.48.m14.3.4.cmml"><mi mathcolor="#FF8000" id="A3.p1.48.m14.3.4.2" xref="A3.p1.48.m14.3.4.2.cmml">A</mi><mo lspace="0em" rspace="0em" id="A3.p1.48.m14.3.4.1" xref="A3.p1.48.m14.3.4.1.cmml">​</mo><mi mathcolor="#FF8000" id="A3.p1.48.m14.3.4.3" xref="A3.p1.48.m14.3.4.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="A3.p1.48.m14.3.4.1a" xref="A3.p1.48.m14.3.4.1.cmml">​</mo><mi mathcolor="#FF8000" id="A3.p1.48.m14.3.4.4" xref="A3.p1.48.m14.3.4.4.cmml">t</mi><mo lspace="0em" rspace="0em" id="A3.p1.48.m14.3.4.1b" xref="A3.p1.48.m14.3.4.1.cmml">​</mo><mi mathcolor="#FF8000" id="A3.p1.48.m14.3.4.5" xref="A3.p1.48.m14.3.4.5.cmml">e</mi><mo lspace="0em" rspace="0em" id="A3.p1.48.m14.3.4.1c" xref="A3.p1.48.m14.3.4.1.cmml">​</mo><mi mathcolor="#FF8000" id="A3.p1.48.m14.3.4.6" xref="A3.p1.48.m14.3.4.6.cmml">n</mi><mo lspace="0em" rspace="0em" id="A3.p1.48.m14.3.4.1d" xref="A3.p1.48.m14.3.4.1.cmml">​</mo><mi mathcolor="#FF8000" id="A3.p1.48.m14.3.4.7" xref="A3.p1.48.m14.3.4.7.cmml">t</mi><mo lspace="0em" rspace="0em" id="A3.p1.48.m14.3.4.1e" xref="A3.p1.48.m14.3.4.1.cmml">​</mo><mi mathcolor="#FF8000" id="A3.p1.48.m14.3.4.8" xref="A3.p1.48.m14.3.4.8.cmml">i</mi><mo lspace="0em" rspace="0em" id="A3.p1.48.m14.3.4.1f" xref="A3.p1.48.m14.3.4.1.cmml">​</mo><mi mathcolor="#FF8000" id="A3.p1.48.m14.3.4.9" xref="A3.p1.48.m14.3.4.9.cmml">o</mi><mo lspace="0em" rspace="0em" id="A3.p1.48.m14.3.4.1g" xref="A3.p1.48.m14.3.4.1.cmml">​</mo><mi mathcolor="#FF8000" id="A3.p1.48.m14.3.4.10" xref="A3.p1.48.m14.3.4.10.cmml">n</mi><mo lspace="0em" rspace="0em" id="A3.p1.48.m14.3.4.1h" xref="A3.p1.48.m14.3.4.1.cmml">​</mo><msub id="A3.p1.48.m14.3.4.11" xref="A3.p1.48.m14.3.4.11.cmml"><mrow id="A3.p1.48.m14.3.4.11.2.2" xref="A3.p1.48.m14.3.4.11.2.1.cmml"><mo mathcolor="#FF8000" stretchy="false" id="A3.p1.48.m14.3.4.11.2.2.1" xref="A3.p1.48.m14.3.4.11.2.1.cmml">(</mo><mi mathcolor="#FF8000" id="A3.p1.48.m14.1.1" xref="A3.p1.48.m14.1.1.cmml">Q</mi><mo mathcolor="#FF8000" id="A3.p1.48.m14.3.4.11.2.2.2" xref="A3.p1.48.m14.3.4.11.2.1.cmml">,</mo><mi mathcolor="#FF8000" id="A3.p1.48.m14.2.2" xref="A3.p1.48.m14.2.2.cmml">Q</mi><mo mathcolor="#FF8000" id="A3.p1.48.m14.3.4.11.2.2.3" xref="A3.p1.48.m14.3.4.11.2.1.cmml">,</mo><mi mathcolor="#FF8000" id="A3.p1.48.m14.3.3" xref="A3.p1.48.m14.3.3.cmml">V</mi><mo mathcolor="#FF8000" stretchy="false" id="A3.p1.48.m14.3.4.11.2.2.4" xref="A3.p1.48.m14.3.4.11.2.1.cmml">)</mo></mrow><mi mathcolor="#FF8000" id="A3.p1.48.m14.3.4.11.3" xref="A3.p1.48.m14.3.4.11.3.cmml">i</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="A3.p1.48.m14.3b"><apply id="A3.p1.48.m14.3.4.cmml" xref="A3.p1.48.m14.3.4"><times id="A3.p1.48.m14.3.4.1.cmml" xref="A3.p1.48.m14.3.4.1"></times><ci id="A3.p1.48.m14.3.4.2.cmml" xref="A3.p1.48.m14.3.4.2">𝐴</ci><ci id="A3.p1.48.m14.3.4.3.cmml" xref="A3.p1.48.m14.3.4.3">𝑡</ci><ci id="A3.p1.48.m14.3.4.4.cmml" xref="A3.p1.48.m14.3.4.4">𝑡</ci><ci id="A3.p1.48.m14.3.4.5.cmml" xref="A3.p1.48.m14.3.4.5">𝑒</ci><ci id="A3.p1.48.m14.3.4.6.cmml" xref="A3.p1.48.m14.3.4.6">𝑛</ci><ci id="A3.p1.48.m14.3.4.7.cmml" xref="A3.p1.48.m14.3.4.7">𝑡</ci><ci id="A3.p1.48.m14.3.4.8.cmml" xref="A3.p1.48.m14.3.4.8">𝑖</ci><ci id="A3.p1.48.m14.3.4.9.cmml" xref="A3.p1.48.m14.3.4.9">𝑜</ci><ci id="A3.p1.48.m14.3.4.10.cmml" xref="A3.p1.48.m14.3.4.10">𝑛</ci><apply id="A3.p1.48.m14.3.4.11.cmml" xref="A3.p1.48.m14.3.4.11"><csymbol cd="ambiguous" id="A3.p1.48.m14.3.4.11.1.cmml" xref="A3.p1.48.m14.3.4.11">subscript</csymbol><vector id="A3.p1.48.m14.3.4.11.2.1.cmml" xref="A3.p1.48.m14.3.4.11.2.2"><ci id="A3.p1.48.m14.1.1.cmml" xref="A3.p1.48.m14.1.1">𝑄</ci><ci id="A3.p1.48.m14.2.2.cmml" xref="A3.p1.48.m14.2.2">𝑄</ci><ci id="A3.p1.48.m14.3.3.cmml" xref="A3.p1.48.m14.3.3">𝑉</ci></vector><ci id="A3.p1.48.m14.3.4.11.3.cmml" xref="A3.p1.48.m14.3.4.11.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.48.m14.3c">Attention({Q},{Q},{V})_{i}</annotation></semantics></math><span id="A3.p1.64.18" class="ltx_text" style="color:#FF8000;"> and </span><math id="A3.p1.49.m15.3" class="ltx_Math" alttext="Attention({K},{K},{V})_{i}" display="inline"><semantics id="A3.p1.49.m15.3a"><mrow id="A3.p1.49.m15.3.4" xref="A3.p1.49.m15.3.4.cmml"><mi mathcolor="#FF8000" id="A3.p1.49.m15.3.4.2" xref="A3.p1.49.m15.3.4.2.cmml">A</mi><mo lspace="0em" rspace="0em" id="A3.p1.49.m15.3.4.1" xref="A3.p1.49.m15.3.4.1.cmml">​</mo><mi mathcolor="#FF8000" id="A3.p1.49.m15.3.4.3" xref="A3.p1.49.m15.3.4.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="A3.p1.49.m15.3.4.1a" xref="A3.p1.49.m15.3.4.1.cmml">​</mo><mi mathcolor="#FF8000" id="A3.p1.49.m15.3.4.4" xref="A3.p1.49.m15.3.4.4.cmml">t</mi><mo lspace="0em" rspace="0em" id="A3.p1.49.m15.3.4.1b" xref="A3.p1.49.m15.3.4.1.cmml">​</mo><mi mathcolor="#FF8000" id="A3.p1.49.m15.3.4.5" xref="A3.p1.49.m15.3.4.5.cmml">e</mi><mo lspace="0em" rspace="0em" id="A3.p1.49.m15.3.4.1c" xref="A3.p1.49.m15.3.4.1.cmml">​</mo><mi mathcolor="#FF8000" id="A3.p1.49.m15.3.4.6" xref="A3.p1.49.m15.3.4.6.cmml">n</mi><mo lspace="0em" rspace="0em" id="A3.p1.49.m15.3.4.1d" xref="A3.p1.49.m15.3.4.1.cmml">​</mo><mi mathcolor="#FF8000" id="A3.p1.49.m15.3.4.7" xref="A3.p1.49.m15.3.4.7.cmml">t</mi><mo lspace="0em" rspace="0em" id="A3.p1.49.m15.3.4.1e" xref="A3.p1.49.m15.3.4.1.cmml">​</mo><mi mathcolor="#FF8000" id="A3.p1.49.m15.3.4.8" xref="A3.p1.49.m15.3.4.8.cmml">i</mi><mo lspace="0em" rspace="0em" id="A3.p1.49.m15.3.4.1f" xref="A3.p1.49.m15.3.4.1.cmml">​</mo><mi mathcolor="#FF8000" id="A3.p1.49.m15.3.4.9" xref="A3.p1.49.m15.3.4.9.cmml">o</mi><mo lspace="0em" rspace="0em" id="A3.p1.49.m15.3.4.1g" xref="A3.p1.49.m15.3.4.1.cmml">​</mo><mi mathcolor="#FF8000" id="A3.p1.49.m15.3.4.10" xref="A3.p1.49.m15.3.4.10.cmml">n</mi><mo lspace="0em" rspace="0em" id="A3.p1.49.m15.3.4.1h" xref="A3.p1.49.m15.3.4.1.cmml">​</mo><msub id="A3.p1.49.m15.3.4.11" xref="A3.p1.49.m15.3.4.11.cmml"><mrow id="A3.p1.49.m15.3.4.11.2.2" xref="A3.p1.49.m15.3.4.11.2.1.cmml"><mo mathcolor="#FF8000" stretchy="false" id="A3.p1.49.m15.3.4.11.2.2.1" xref="A3.p1.49.m15.3.4.11.2.1.cmml">(</mo><mi mathcolor="#FF8000" id="A3.p1.49.m15.1.1" xref="A3.p1.49.m15.1.1.cmml">K</mi><mo mathcolor="#FF8000" id="A3.p1.49.m15.3.4.11.2.2.2" xref="A3.p1.49.m15.3.4.11.2.1.cmml">,</mo><mi mathcolor="#FF8000" id="A3.p1.49.m15.2.2" xref="A3.p1.49.m15.2.2.cmml">K</mi><mo mathcolor="#FF8000" id="A3.p1.49.m15.3.4.11.2.2.3" xref="A3.p1.49.m15.3.4.11.2.1.cmml">,</mo><mi mathcolor="#FF8000" id="A3.p1.49.m15.3.3" xref="A3.p1.49.m15.3.3.cmml">V</mi><mo mathcolor="#FF8000" stretchy="false" id="A3.p1.49.m15.3.4.11.2.2.4" xref="A3.p1.49.m15.3.4.11.2.1.cmml">)</mo></mrow><mi mathcolor="#FF8000" id="A3.p1.49.m15.3.4.11.3" xref="A3.p1.49.m15.3.4.11.3.cmml">i</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="A3.p1.49.m15.3b"><apply id="A3.p1.49.m15.3.4.cmml" xref="A3.p1.49.m15.3.4"><times id="A3.p1.49.m15.3.4.1.cmml" xref="A3.p1.49.m15.3.4.1"></times><ci id="A3.p1.49.m15.3.4.2.cmml" xref="A3.p1.49.m15.3.4.2">𝐴</ci><ci id="A3.p1.49.m15.3.4.3.cmml" xref="A3.p1.49.m15.3.4.3">𝑡</ci><ci id="A3.p1.49.m15.3.4.4.cmml" xref="A3.p1.49.m15.3.4.4">𝑡</ci><ci id="A3.p1.49.m15.3.4.5.cmml" xref="A3.p1.49.m15.3.4.5">𝑒</ci><ci id="A3.p1.49.m15.3.4.6.cmml" xref="A3.p1.49.m15.3.4.6">𝑛</ci><ci id="A3.p1.49.m15.3.4.7.cmml" xref="A3.p1.49.m15.3.4.7">𝑡</ci><ci id="A3.p1.49.m15.3.4.8.cmml" xref="A3.p1.49.m15.3.4.8">𝑖</ci><ci id="A3.p1.49.m15.3.4.9.cmml" xref="A3.p1.49.m15.3.4.9">𝑜</ci><ci id="A3.p1.49.m15.3.4.10.cmml" xref="A3.p1.49.m15.3.4.10">𝑛</ci><apply id="A3.p1.49.m15.3.4.11.cmml" xref="A3.p1.49.m15.3.4.11"><csymbol cd="ambiguous" id="A3.p1.49.m15.3.4.11.1.cmml" xref="A3.p1.49.m15.3.4.11">subscript</csymbol><vector id="A3.p1.49.m15.3.4.11.2.1.cmml" xref="A3.p1.49.m15.3.4.11.2.2"><ci id="A3.p1.49.m15.1.1.cmml" xref="A3.p1.49.m15.1.1">𝐾</ci><ci id="A3.p1.49.m15.2.2.cmml" xref="A3.p1.49.m15.2.2">𝐾</ci><ci id="A3.p1.49.m15.3.3.cmml" xref="A3.p1.49.m15.3.3">𝑉</ci></vector><ci id="A3.p1.49.m15.3.4.11.3.cmml" xref="A3.p1.49.m15.3.4.11.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.49.m15.3c">Attention({K},{K},{V})_{i}</annotation></semantics></math><span id="A3.p1.64.19" class="ltx_text" style="color:#FF8000;"> Fig.</span><a href="#S3.F3.sf3" title="In Figure 3 ‣ Refinement of the local visual space ‣ 3.3 Learning generic abnormality and normality prompts ‣ 3 AnomalyCLIP: object-agnostic prompt learning ‣ AnomalyCLIP: Object-agnostic Prompt Learning for Zero-shot Anomaly Detection" class="ltx_ref" style="color:#FF8000;"><span class="ltx_text ltx_ref_tag">3c</span></a><span id="A3.p1.64.20" class="ltx_text" style="color:#FF8000;"> and Fig.</span><a href="#S3.F3.sf4" title="In Figure 3 ‣ Refinement of the local visual space ‣ 3.3 Learning generic abnormality and normality prompts ‣ 3 AnomalyCLIP: object-agnostic prompt learning ‣ AnomalyCLIP: Object-agnostic Prompt Learning for Zero-shot Anomaly Detection" class="ltx_ref" style="color:#FF8000;"><span class="ltx_text ltx_ref_tag">3d</span></a><span id="A3.p1.64.21" class="ltx_text" style="color:#FF8000;">. In contrast to </span><math id="A3.p1.50.m16.1" class="ltx_Math" alttext="Q" display="inline"><semantics id="A3.p1.50.m16.1a"><mi mathcolor="#FF8000" id="A3.p1.50.m16.1.1" xref="A3.p1.50.m16.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="A3.p1.50.m16.1b"><ci id="A3.p1.50.m16.1.1.cmml" xref="A3.p1.50.m16.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.50.m16.1c">Q</annotation></semantics></math><span id="A3.p1.64.22" class="ltx_text" style="color:#FF8000;">-</span><math id="A3.p1.51.m17.1" class="ltx_Math" alttext="Q" display="inline"><semantics id="A3.p1.51.m17.1a"><mi mathcolor="#FF8000" id="A3.p1.51.m17.1.1" xref="A3.p1.51.m17.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="A3.p1.51.m17.1b"><ci id="A3.p1.51.m17.1.1.cmml" xref="A3.p1.51.m17.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.51.m17.1c">Q</annotation></semantics></math><span id="A3.p1.64.23" class="ltx_text" style="color:#FF8000;"> and </span><math id="A3.p1.52.m18.1" class="ltx_Math" alttext="K" display="inline"><semantics id="A3.p1.52.m18.1a"><mi mathcolor="#FF8000" id="A3.p1.52.m18.1.1" xref="A3.p1.52.m18.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="A3.p1.52.m18.1b"><ci id="A3.p1.52.m18.1.1.cmml" xref="A3.p1.52.m18.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.52.m18.1c">K</annotation></semantics></math><span id="A3.p1.64.24" class="ltx_text" style="color:#FF8000;">-</span><math id="A3.p1.53.m19.1" class="ltx_Math" alttext="K" display="inline"><semantics id="A3.p1.53.m19.1a"><mi mathcolor="#FF8000" id="A3.p1.53.m19.1.1" xref="A3.p1.53.m19.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="A3.p1.53.m19.1b"><ci id="A3.p1.53.m19.1.1.cmml" xref="A3.p1.53.m19.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.53.m19.1c">K</annotation></semantics></math><span id="A3.p1.64.25" class="ltx_text" style="color:#FF8000;">, </span><math id="A3.p1.54.m20.1" class="ltx_Math" alttext="V" display="inline"><semantics id="A3.p1.54.m20.1a"><mi mathcolor="#FF8000" id="A3.p1.54.m20.1.1" xref="A3.p1.54.m20.1.1.cmml">V</mi><annotation-xml encoding="MathML-Content" id="A3.p1.54.m20.1b"><ci id="A3.p1.54.m20.1.1.cmml" xref="A3.p1.54.m20.1.1">𝑉</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.54.m20.1c">V</annotation></semantics></math><span id="A3.p1.64.26" class="ltx_text" style="color:#FF8000;">-</span><math id="A3.p1.55.m21.1" class="ltx_Math" alttext="V" display="inline"><semantics id="A3.p1.55.m21.1a"><mi mathcolor="#FF8000" id="A3.p1.55.m21.1.1" xref="A3.p1.55.m21.1.1.cmml">V</mi><annotation-xml encoding="MathML-Content" id="A3.p1.55.m21.1b"><ci id="A3.p1.55.m21.1.1.cmml" xref="A3.p1.55.m21.1.1">𝑉</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.55.m21.1c">V</annotation></semantics></math><span id="A3.p1.64.27" class="ltx_text" style="color:#FF8000;"> does not participate in computing the original attention map, reducing the unexpected bias to different tokens in </span><math id="A3.p1.56.m22.1" class="ltx_Math" alttext="V" display="inline"><semantics id="A3.p1.56.m22.1a"><mi mathcolor="#FF8000" id="A3.p1.56.m22.1.1" xref="A3.p1.56.m22.1.1.cmml">V</mi><annotation-xml encoding="MathML-Content" id="A3.p1.56.m22.1b"><ci id="A3.p1.56.m22.1.1.cmml" xref="A3.p1.56.m22.1.1">𝑉</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.56.m22.1c">V</annotation></semantics></math><span id="A3.p1.64.28" class="ltx_text" style="color:#FF8000;"> for the purpose of anomaly segmentation. Therefore, </span><math id="A3.p1.57.m23.1" class="ltx_Math" alttext="v_{i}" display="inline"><semantics id="A3.p1.57.m23.1a"><msub id="A3.p1.57.m23.1.1" xref="A3.p1.57.m23.1.1.cmml"><mi mathcolor="#FF8000" id="A3.p1.57.m23.1.1.2" xref="A3.p1.57.m23.1.1.2.cmml">v</mi><mi mathcolor="#FF8000" id="A3.p1.57.m23.1.1.3" xref="A3.p1.57.m23.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A3.p1.57.m23.1b"><apply id="A3.p1.57.m23.1.1.cmml" xref="A3.p1.57.m23.1.1"><csymbol cd="ambiguous" id="A3.p1.57.m23.1.1.1.cmml" xref="A3.p1.57.m23.1.1">subscript</csymbol><ci id="A3.p1.57.m23.1.1.2.cmml" xref="A3.p1.57.m23.1.1.2">𝑣</ci><ci id="A3.p1.57.m23.1.1.3.cmml" xref="A3.p1.57.m23.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.57.m23.1c">v_{i}</annotation></semantics></math><span id="A3.p1.64.29" class="ltx_text" style="color:#FF8000;"> does not produce a large weight (</span><math id="A3.p1.58.m24.1" class="ltx_Math" alttext="a_{ij}" display="inline"><semantics id="A3.p1.58.m24.1a"><msub id="A3.p1.58.m24.1.1" xref="A3.p1.58.m24.1.1.cmml"><mi mathcolor="#FF8000" id="A3.p1.58.m24.1.1.2" xref="A3.p1.58.m24.1.1.2.cmml">a</mi><mrow id="A3.p1.58.m24.1.1.3" xref="A3.p1.58.m24.1.1.3.cmml"><mi mathcolor="#FF8000" id="A3.p1.58.m24.1.1.3.2" xref="A3.p1.58.m24.1.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="A3.p1.58.m24.1.1.3.1" xref="A3.p1.58.m24.1.1.3.1.cmml">​</mo><mi mathcolor="#FF8000" id="A3.p1.58.m24.1.1.3.3" xref="A3.p1.58.m24.1.1.3.3.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="A3.p1.58.m24.1b"><apply id="A3.p1.58.m24.1.1.cmml" xref="A3.p1.58.m24.1.1"><csymbol cd="ambiguous" id="A3.p1.58.m24.1.1.1.cmml" xref="A3.p1.58.m24.1.1">subscript</csymbol><ci id="A3.p1.58.m24.1.1.2.cmml" xref="A3.p1.58.m24.1.1.2">𝑎</ci><apply id="A3.p1.58.m24.1.1.3.cmml" xref="A3.p1.58.m24.1.1.3"><times id="A3.p1.58.m24.1.1.3.1.cmml" xref="A3.p1.58.m24.1.1.3.1"></times><ci id="A3.p1.58.m24.1.1.3.2.cmml" xref="A3.p1.58.m24.1.1.3.2">𝑖</ci><ci id="A3.p1.58.m24.1.1.3.3.cmml" xref="A3.p1.58.m24.1.1.3.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.58.m24.1c">a_{ij}</annotation></semantics></math><span id="A3.p1.64.30" class="ltx_text" style="color:#FF8000;">) with </span><math id="A3.p1.59.m25.1" class="ltx_Math" alttext="v_{j}" display="inline"><semantics id="A3.p1.59.m25.1a"><msub id="A3.p1.59.m25.1.1" xref="A3.p1.59.m25.1.1.cmml"><mi mathcolor="#FF8000" id="A3.p1.59.m25.1.1.2" xref="A3.p1.59.m25.1.1.2.cmml">v</mi><mi mathcolor="#FF8000" id="A3.p1.59.m25.1.1.3" xref="A3.p1.59.m25.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="A3.p1.59.m25.1b"><apply id="A3.p1.59.m25.1.1.cmml" xref="A3.p1.59.m25.1.1"><csymbol cd="ambiguous" id="A3.p1.59.m25.1.1.1.cmml" xref="A3.p1.59.m25.1.1">subscript</csymbol><ci id="A3.p1.59.m25.1.1.2.cmml" xref="A3.p1.59.m25.1.1.2">𝑣</ci><ci id="A3.p1.59.m25.1.1.3.cmml" xref="A3.p1.59.m25.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.59.m25.1c">v_{j}</annotation></semantics></math><span id="A3.p1.64.31" class="ltx_text" style="color:#FF8000;"> and generates a larger weight (</span><math id="A3.p1.60.m26.1" class="ltx_Math" alttext="a_{ii}" display="inline"><semantics id="A3.p1.60.m26.1a"><msub id="A3.p1.60.m26.1.1" xref="A3.p1.60.m26.1.1.cmml"><mi mathcolor="#FF8000" id="A3.p1.60.m26.1.1.2" xref="A3.p1.60.m26.1.1.2.cmml">a</mi><mrow id="A3.p1.60.m26.1.1.3" xref="A3.p1.60.m26.1.1.3.cmml"><mi mathcolor="#FF8000" id="A3.p1.60.m26.1.1.3.2" xref="A3.p1.60.m26.1.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="A3.p1.60.m26.1.1.3.1" xref="A3.p1.60.m26.1.1.3.1.cmml">​</mo><mi mathcolor="#FF8000" id="A3.p1.60.m26.1.1.3.3" xref="A3.p1.60.m26.1.1.3.3.cmml">i</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="A3.p1.60.m26.1b"><apply id="A3.p1.60.m26.1.1.cmml" xref="A3.p1.60.m26.1.1"><csymbol cd="ambiguous" id="A3.p1.60.m26.1.1.1.cmml" xref="A3.p1.60.m26.1.1">subscript</csymbol><ci id="A3.p1.60.m26.1.1.2.cmml" xref="A3.p1.60.m26.1.1.2">𝑎</ci><apply id="A3.p1.60.m26.1.1.3.cmml" xref="A3.p1.60.m26.1.1.3"><times id="A3.p1.60.m26.1.1.3.1.cmml" xref="A3.p1.60.m26.1.1.3.1"></times><ci id="A3.p1.60.m26.1.1.3.2.cmml" xref="A3.p1.60.m26.1.1.3.2">𝑖</ci><ci id="A3.p1.60.m26.1.1.3.3.cmml" xref="A3.p1.60.m26.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.60.m26.1c">a_{ii}</annotation></semantics></math><span id="A3.p1.64.32" class="ltx_text" style="color:#FF8000;">) to form </span><math id="A3.p1.61.m27.3" class="ltx_Math" alttext="Attention({V},{V},{V})_{i}" display="inline"><semantics id="A3.p1.61.m27.3a"><mrow id="A3.p1.61.m27.3.4" xref="A3.p1.61.m27.3.4.cmml"><mi mathcolor="#FF8000" id="A3.p1.61.m27.3.4.2" xref="A3.p1.61.m27.3.4.2.cmml">A</mi><mo lspace="0em" rspace="0em" id="A3.p1.61.m27.3.4.1" xref="A3.p1.61.m27.3.4.1.cmml">​</mo><mi mathcolor="#FF8000" id="A3.p1.61.m27.3.4.3" xref="A3.p1.61.m27.3.4.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="A3.p1.61.m27.3.4.1a" xref="A3.p1.61.m27.3.4.1.cmml">​</mo><mi mathcolor="#FF8000" id="A3.p1.61.m27.3.4.4" xref="A3.p1.61.m27.3.4.4.cmml">t</mi><mo lspace="0em" rspace="0em" id="A3.p1.61.m27.3.4.1b" xref="A3.p1.61.m27.3.4.1.cmml">​</mo><mi mathcolor="#FF8000" id="A3.p1.61.m27.3.4.5" xref="A3.p1.61.m27.3.4.5.cmml">e</mi><mo lspace="0em" rspace="0em" id="A3.p1.61.m27.3.4.1c" xref="A3.p1.61.m27.3.4.1.cmml">​</mo><mi mathcolor="#FF8000" id="A3.p1.61.m27.3.4.6" xref="A3.p1.61.m27.3.4.6.cmml">n</mi><mo lspace="0em" rspace="0em" id="A3.p1.61.m27.3.4.1d" xref="A3.p1.61.m27.3.4.1.cmml">​</mo><mi mathcolor="#FF8000" id="A3.p1.61.m27.3.4.7" xref="A3.p1.61.m27.3.4.7.cmml">t</mi><mo lspace="0em" rspace="0em" id="A3.p1.61.m27.3.4.1e" xref="A3.p1.61.m27.3.4.1.cmml">​</mo><mi mathcolor="#FF8000" id="A3.p1.61.m27.3.4.8" xref="A3.p1.61.m27.3.4.8.cmml">i</mi><mo lspace="0em" rspace="0em" id="A3.p1.61.m27.3.4.1f" xref="A3.p1.61.m27.3.4.1.cmml">​</mo><mi mathcolor="#FF8000" id="A3.p1.61.m27.3.4.9" xref="A3.p1.61.m27.3.4.9.cmml">o</mi><mo lspace="0em" rspace="0em" id="A3.p1.61.m27.3.4.1g" xref="A3.p1.61.m27.3.4.1.cmml">​</mo><mi mathcolor="#FF8000" id="A3.p1.61.m27.3.4.10" xref="A3.p1.61.m27.3.4.10.cmml">n</mi><mo lspace="0em" rspace="0em" id="A3.p1.61.m27.3.4.1h" xref="A3.p1.61.m27.3.4.1.cmml">​</mo><msub id="A3.p1.61.m27.3.4.11" xref="A3.p1.61.m27.3.4.11.cmml"><mrow id="A3.p1.61.m27.3.4.11.2.2" xref="A3.p1.61.m27.3.4.11.2.1.cmml"><mo mathcolor="#FF8000" stretchy="false" id="A3.p1.61.m27.3.4.11.2.2.1" xref="A3.p1.61.m27.3.4.11.2.1.cmml">(</mo><mi mathcolor="#FF8000" id="A3.p1.61.m27.1.1" xref="A3.p1.61.m27.1.1.cmml">V</mi><mo mathcolor="#FF8000" id="A3.p1.61.m27.3.4.11.2.2.2" xref="A3.p1.61.m27.3.4.11.2.1.cmml">,</mo><mi mathcolor="#FF8000" id="A3.p1.61.m27.2.2" xref="A3.p1.61.m27.2.2.cmml">V</mi><mo mathcolor="#FF8000" id="A3.p1.61.m27.3.4.11.2.2.3" xref="A3.p1.61.m27.3.4.11.2.1.cmml">,</mo><mi mathcolor="#FF8000" id="A3.p1.61.m27.3.3" xref="A3.p1.61.m27.3.3.cmml">V</mi><mo mathcolor="#FF8000" stretchy="false" id="A3.p1.61.m27.3.4.11.2.2.4" xref="A3.p1.61.m27.3.4.11.2.1.cmml">)</mo></mrow><mi mathcolor="#FF8000" id="A3.p1.61.m27.3.4.11.3" xref="A3.p1.61.m27.3.4.11.3.cmml">i</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="A3.p1.61.m27.3b"><apply id="A3.p1.61.m27.3.4.cmml" xref="A3.p1.61.m27.3.4"><times id="A3.p1.61.m27.3.4.1.cmml" xref="A3.p1.61.m27.3.4.1"></times><ci id="A3.p1.61.m27.3.4.2.cmml" xref="A3.p1.61.m27.3.4.2">𝐴</ci><ci id="A3.p1.61.m27.3.4.3.cmml" xref="A3.p1.61.m27.3.4.3">𝑡</ci><ci id="A3.p1.61.m27.3.4.4.cmml" xref="A3.p1.61.m27.3.4.4">𝑡</ci><ci id="A3.p1.61.m27.3.4.5.cmml" xref="A3.p1.61.m27.3.4.5">𝑒</ci><ci id="A3.p1.61.m27.3.4.6.cmml" xref="A3.p1.61.m27.3.4.6">𝑛</ci><ci id="A3.p1.61.m27.3.4.7.cmml" xref="A3.p1.61.m27.3.4.7">𝑡</ci><ci id="A3.p1.61.m27.3.4.8.cmml" xref="A3.p1.61.m27.3.4.8">𝑖</ci><ci id="A3.p1.61.m27.3.4.9.cmml" xref="A3.p1.61.m27.3.4.9">𝑜</ci><ci id="A3.p1.61.m27.3.4.10.cmml" xref="A3.p1.61.m27.3.4.10">𝑛</ci><apply id="A3.p1.61.m27.3.4.11.cmml" xref="A3.p1.61.m27.3.4.11"><csymbol cd="ambiguous" id="A3.p1.61.m27.3.4.11.1.cmml" xref="A3.p1.61.m27.3.4.11">subscript</csymbol><vector id="A3.p1.61.m27.3.4.11.2.1.cmml" xref="A3.p1.61.m27.3.4.11.2.2"><ci id="A3.p1.61.m27.1.1.cmml" xref="A3.p1.61.m27.1.1">𝑉</ci><ci id="A3.p1.61.m27.2.2.cmml" xref="A3.p1.61.m27.2.2">𝑉</ci><ci id="A3.p1.61.m27.3.3.cmml" xref="A3.p1.61.m27.3.3">𝑉</ci></vector><ci id="A3.p1.61.m27.3.4.11.3.cmml" xref="A3.p1.61.m27.3.4.11.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.61.m27.3c">Attention({V},{V},{V})_{i}</annotation></semantics></math><span id="A3.p1.64.33" class="ltx_text" style="color:#FF8000;">, preserving more information of </span><math id="A3.p1.62.m28.1" class="ltx_Math" alttext="v_{i}" display="inline"><semantics id="A3.p1.62.m28.1a"><msub id="A3.p1.62.m28.1.1" xref="A3.p1.62.m28.1.1.cmml"><mi mathcolor="#FF8000" id="A3.p1.62.m28.1.1.2" xref="A3.p1.62.m28.1.1.2.cmml">v</mi><mi mathcolor="#FF8000" id="A3.p1.62.m28.1.1.3" xref="A3.p1.62.m28.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A3.p1.62.m28.1b"><apply id="A3.p1.62.m28.1.1.cmml" xref="A3.p1.62.m28.1.1"><csymbol cd="ambiguous" id="A3.p1.62.m28.1.1.1.cmml" xref="A3.p1.62.m28.1.1">subscript</csymbol><ci id="A3.p1.62.m28.1.1.2.cmml" xref="A3.p1.62.m28.1.1.2">𝑣</ci><ci id="A3.p1.62.m28.1.1.3.cmml" xref="A3.p1.62.m28.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.62.m28.1c">v_{i}</annotation></semantics></math><span id="A3.p1.64.34" class="ltx_text" style="color:#FF8000;"> and experiencing diagonally prominent attention map (minimal disturbance), as depicted in Fig. </span><a href="#S3.F3.sf5" title="In Figure 3 ‣ Refinement of the local visual space ‣ 3.3 Learning generic abnormality and normality prompts ‣ 3 AnomalyCLIP: object-agnostic prompt learning ‣ AnomalyCLIP: Object-agnostic Prompt Learning for Zero-shot Anomaly Detection" class="ltx_ref" style="color:#FF8000;"><span class="ltx_text ltx_ref_tag">3e</span></a><span id="A3.p1.64.35" class="ltx_text" style="color:#FF8000;">. This is the reason why </span><math id="A3.p1.63.m29.1" class="ltx_Math" alttext="V" display="inline"><semantics id="A3.p1.63.m29.1a"><mi mathcolor="#FF8000" id="A3.p1.63.m29.1.1" xref="A3.p1.63.m29.1.1.cmml">V</mi><annotation-xml encoding="MathML-Content" id="A3.p1.63.m29.1b"><ci id="A3.p1.63.m29.1.1.cmml" xref="A3.p1.63.m29.1.1">𝑉</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.63.m29.1c">V</annotation></semantics></math><span id="A3.p1.64.36" class="ltx_text" style="color:#FF8000;">-</span><math id="A3.p1.64.m30.1" class="ltx_Math" alttext="V" display="inline"><semantics id="A3.p1.64.m30.1a"><mi mathcolor="#FF8000" id="A3.p1.64.m30.1.1" xref="A3.p1.64.m30.1.1.cmml">V</mi><annotation-xml encoding="MathML-Content" id="A3.p1.64.m30.1b"><ci id="A3.p1.64.m30.1.1.cmml" xref="A3.p1.64.m30.1.1">𝑉</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.64.m30.1c">V</annotation></semantics></math><span id="A3.p1.64.37" class="ltx_text" style="color:#FF8000;"> achieves the best results.
</span><span id="A3.p1.64.38" class="ltx_text"></span></p>
</div>
</section>
<section id="A4" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix D </span>Additional results and ablations</h2>

<figure id="A4.T4" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 4: </span>Comparison of ZSAD performance between AnomalyCLIP and SOTA full-shot methods. The best performance is highlighted in red, and the second-best is highlighted in blue.</figcaption>
<table id="A4.T4.1" class="ltx_tabular ltx_centering ltx_align_middle">
<tr id="A4.T4.1.1" class="ltx_tr">
<td id="A4.T4.1.1.2" class="ltx_td ltx_align_center ltx_border_tt">Task</td>
<td id="A4.T4.1.1.3" class="ltx_td ltx_align_center ltx_border_tt">Category</td>
<td id="A4.T4.1.1.4" class="ltx_td ltx_align_center ltx_border_tt">Datasets</td>
<td id="A4.T4.1.1.1" class="ltx_td ltx_align_center ltx_border_tt"><math id="A4.T4.1.1.1.m1.1" class="ltx_Math" alttext="|\mathcal{C}|" display="inline"><semantics id="A4.T4.1.1.1.m1.1a"><mrow id="A4.T4.1.1.1.m1.1.2.2" xref="A4.T4.1.1.1.m1.1.2.1.cmml"><mo stretchy="false" id="A4.T4.1.1.1.m1.1.2.2.1" xref="A4.T4.1.1.1.m1.1.2.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="A4.T4.1.1.1.m1.1.1" xref="A4.T4.1.1.1.m1.1.1.cmml">𝒞</mi><mo stretchy="false" id="A4.T4.1.1.1.m1.1.2.2.2" xref="A4.T4.1.1.1.m1.1.2.1.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="A4.T4.1.1.1.m1.1b"><apply id="A4.T4.1.1.1.m1.1.2.1.cmml" xref="A4.T4.1.1.1.m1.1.2.2"><abs id="A4.T4.1.1.1.m1.1.2.1.1.cmml" xref="A4.T4.1.1.1.m1.1.2.2.1"></abs><ci id="A4.T4.1.1.1.m1.1.1.cmml" xref="A4.T4.1.1.1.m1.1.1">𝒞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.T4.1.1.1.m1.1c">|\mathcal{C}|</annotation></semantics></math></td>
<td id="A4.T4.1.1.5" class="ltx_td ltx_align_center ltx_border_tt">AnomalyCLIP</td>
<td id="A4.T4.1.1.6" class="ltx_td ltx_align_center ltx_border_tt">PatchCore</td>
<td id="A4.T4.1.1.7" class="ltx_td ltx_align_center ltx_border_tt">RD4AD</td>
</tr>
<tr id="A4.T4.1.2" class="ltx_tr">
<td id="A4.T4.1.2.1" class="ltx_td ltx_align_center ltx_border_t" rowspan="6"><span id="A4.T4.1.2.1.1" class="ltx_text"><span id="A4.T4.1.2.1.1.1" class="ltx_text"></span> <span id="A4.T4.1.2.1.1.2" class="ltx_text">
<span id="A4.T4.1.2.1.1.2.1" class="ltx_tabular ltx_align_middle">
<span id="A4.T4.1.2.1.1.2.1.1" class="ltx_tr">
<span id="A4.T4.1.2.1.1.2.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">Image-level</span></span>
<span id="A4.T4.1.2.1.1.2.1.2" class="ltx_tr">
<span id="A4.T4.1.2.1.1.2.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center">(AUROC, AP)</span></span>
</span></span> <span id="A4.T4.1.2.1.1.3" class="ltx_text"></span></span></td>
<td id="A4.T4.1.2.2" class="ltx_td ltx_align_center ltx_border_t">
<span id="A4.T4.1.2.2.1" class="ltx_text"></span> <span id="A4.T4.1.2.2.2" class="ltx_text">
<span id="A4.T4.1.2.2.2.1" class="ltx_tabular ltx_align_middle">
<span id="A4.T4.1.2.2.2.1.1" class="ltx_tr">
<span id="A4.T4.1.2.2.2.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">Obj &amp;texture</span></span>
</span></span><span id="A4.T4.1.2.2.3" class="ltx_text"></span></td>
<td id="A4.T4.1.2.3" class="ltx_td ltx_align_center ltx_border_t">MVTec AD</td>
<td id="A4.T4.1.2.4" class="ltx_td ltx_align_center ltx_border_t">15</td>
<td id="A4.T4.1.2.5" class="ltx_td ltx_align_center ltx_border_t">(91.5, 96.2)</td>
<td id="A4.T4.1.2.6" class="ltx_td ltx_align_center ltx_border_t">(<span id="A4.T4.1.2.6.1" class="ltx_text" style="color:#FF0000;">99.0</span>, <span id="A4.T4.1.2.6.2" class="ltx_text" style="color:#FF0000;">99.7</span>)</td>
<td id="A4.T4.1.2.7" class="ltx_td ltx_align_center ltx_border_t">
<span id="A4.T4.1.2.7.1" class="ltx_text" style="color:#0000FF;">(98.7</span>, <span id="A4.T4.1.2.7.2" class="ltx_text" style="color:#0000FF;">99.4</span>)</td>
</tr>
<tr id="A4.T4.1.3" class="ltx_tr">
<td id="A4.T4.1.3.1" class="ltx_td ltx_align_center" rowspan="4"><span id="A4.T4.1.3.1.1" class="ltx_text">Obj</span></td>
<td id="A4.T4.1.3.2" class="ltx_td ltx_align_center">VisA</td>
<td id="A4.T4.1.3.3" class="ltx_td ltx_align_center">12</td>
<td id="A4.T4.1.3.4" class="ltx_td ltx_align_center">(82.1, 85.4)</td>
<td id="A4.T4.1.3.5" class="ltx_td ltx_align_center">(<span id="A4.T4.1.3.5.1" class="ltx_text" style="color:#FF0000;">94.6</span>, <span id="A4.T4.1.3.5.2" class="ltx_text" style="color:#FF0000;">95.9</span>)</td>
<td id="A4.T4.1.3.6" class="ltx_td ltx_align_center">(<span id="A4.T4.1.3.6.1" class="ltx_text" style="color:#FF0000;">95.3</span>, <span id="A4.T4.1.3.6.2" class="ltx_text" style="color:#0000FF;">95.7</span>)</td>
</tr>
<tr id="A4.T4.1.4" class="ltx_tr">
<td id="A4.T4.1.4.1" class="ltx_td ltx_align_center">MPDD</td>
<td id="A4.T4.1.4.2" class="ltx_td ltx_align_center">6</td>
<td id="A4.T4.1.4.3" class="ltx_td ltx_align_center">(77.0, 82.0)</td>
<td id="A4.T4.1.4.4" class="ltx_td ltx_align_center">(<span id="A4.T4.1.4.4.1" class="ltx_text" style="color:#FF0000;">94.1</span>, <span id="A4.T4.1.4.4.2" class="ltx_text" style="color:#FF0000;">96.3</span>)</td>
<td id="A4.T4.1.4.5" class="ltx_td ltx_align_center">(<span id="A4.T4.1.4.5.1" class="ltx_text" style="color:#0000FF;">91.6</span>, <span id="A4.T4.1.4.5.2" class="ltx_text" style="color:#0000FF;">93.8</span>)</td>
</tr>
<tr id="A4.T4.1.5" class="ltx_tr">
<td id="A4.T4.1.5.1" class="ltx_td ltx_align_center">BTAD</td>
<td id="A4.T4.1.5.2" class="ltx_td ltx_align_center">3</td>
<td id="A4.T4.1.5.3" class="ltx_td ltx_align_center">(88.3, 87.3)</td>
<td id="A4.T4.1.5.4" class="ltx_td ltx_align_center">(<span id="A4.T4.1.5.4.1" class="ltx_text" style="color:#0000FF;">93.2</span>, <span id="A4.T4.1.5.4.2" class="ltx_text" style="color:#FF0000;">98.6</span>)</td>
<td id="A4.T4.1.5.5" class="ltx_td ltx_align_center">(<span id="A4.T4.1.5.5.1" class="ltx_text" style="color:#FF0000;">93.8</span>, <span id="A4.T4.1.5.5.2" class="ltx_text" style="color:#0000FF;">96.8</span>)</td>
</tr>
<tr id="A4.T4.1.6" class="ltx_tr">
<td id="A4.T4.1.6.1" class="ltx_td ltx_align_center">SDD</td>
<td id="A4.T4.1.6.2" class="ltx_td ltx_align_center">1</td>
<td id="A4.T4.1.6.3" class="ltx_td ltx_align_center">(<span id="A4.T4.1.6.3.1" class="ltx_text" style="color:#0000FF;">84.7</span>, <span id="A4.T4.1.6.3.2" class="ltx_text" style="color:#0000FF;">80.0</span>)</td>
<td id="A4.T4.1.6.4" class="ltx_td ltx_align_center">(64.9, 48.3)</td>
<td id="A4.T4.1.6.5" class="ltx_td ltx_align_center">(<span id="A4.T4.1.6.5.1" class="ltx_text" style="color:#FF0000;">86.8</span>, <span id="A4.T4.1.6.5.2" class="ltx_text" style="color:#FF0000;">81.3</span>)</td>
</tr>
<tr id="A4.T4.1.7" class="ltx_tr">
<td id="A4.T4.1.7.1" class="ltx_td ltx_align_center"><span id="A4.T4.1.7.1.1" class="ltx_text">Texture</span></td>
<td id="A4.T4.1.7.2" class="ltx_td ltx_align_center">DAGM</td>
<td id="A4.T4.1.7.3" class="ltx_td ltx_align_center">10</td>
<td id="A4.T4.1.7.4" class="ltx_td ltx_align_center">(<span id="A4.T4.1.7.4.1" class="ltx_text" style="color:#FF0000;">97.5</span>, <span id="A4.T4.1.7.4.2" class="ltx_text" style="color:#FF0000;">92.3</span>)</td>
<td id="A4.T4.1.7.5" class="ltx_td ltx_align_center">(92.7, <span id="A4.T4.1.7.5.1" class="ltx_text" style="color:#0000FF;">81.3</span>)</td>
<td id="A4.T4.1.7.6" class="ltx_td ltx_align_center">(<span id="A4.T4.1.7.6.1" class="ltx_text" style="color:#0000FF;">92.9</span>, 79.1)</td>
</tr>
<tr id="A4.T4.1.8" class="ltx_tr">
<td id="A4.T4.1.8.1" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" rowspan="6"><span id="A4.T4.1.8.1.1" class="ltx_text"><span id="A4.T4.1.8.1.1.1" class="ltx_text"></span> <span id="A4.T4.1.8.1.1.2" class="ltx_text">
<span id="A4.T4.1.8.1.1.2.1" class="ltx_tabular ltx_align_middle">
<span id="A4.T4.1.8.1.1.2.1.1" class="ltx_tr">
<span id="A4.T4.1.8.1.1.2.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">Pixel-level</span></span>
<span id="A4.T4.1.8.1.1.2.1.2" class="ltx_tr">
<span id="A4.T4.1.8.1.1.2.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center">(AUROC, PRO)</span></span>
</span></span> <span id="A4.T4.1.8.1.1.3" class="ltx_text"></span></span></td>
<td id="A4.T4.1.8.2" class="ltx_td ltx_align_center ltx_border_t">
<span id="A4.T4.1.8.2.1" class="ltx_text"></span> <span id="A4.T4.1.8.2.2" class="ltx_text">
<span id="A4.T4.1.8.2.2.1" class="ltx_tabular ltx_align_middle">
<span id="A4.T4.1.8.2.2.1.1" class="ltx_tr">
<span id="A4.T4.1.8.2.2.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">Obj &amp;texture</span></span>
</span></span><span id="A4.T4.1.8.2.3" class="ltx_text"></span></td>
<td id="A4.T4.1.8.3" class="ltx_td ltx_align_center ltx_border_t">MVTec AD</td>
<td id="A4.T4.1.8.4" class="ltx_td ltx_align_center ltx_border_t">15</td>
<td id="A4.T4.1.8.5" class="ltx_td ltx_align_center ltx_border_t">(91.1, 81.4)</td>
<td id="A4.T4.1.8.6" class="ltx_td ltx_align_center ltx_border_t">(<span id="A4.T4.1.8.6.1" class="ltx_text" style="color:#FF0000;">98.1</span>, <span id="A4.T4.1.8.6.2" class="ltx_text" style="color:#0000FF;">92.8</span>)</td>
<td id="A4.T4.1.8.7" class="ltx_td ltx_align_center ltx_border_t">(<span id="A4.T4.1.8.7.1" class="ltx_text" style="color:#0000FF;">97.8</span>, <span id="A4.T4.1.8.7.2" class="ltx_text" style="color:#FF0000;">93.6</span>)</td>
</tr>
<tr id="A4.T4.1.9" class="ltx_tr">
<td id="A4.T4.1.9.1" class="ltx_td ltx_align_center" rowspan="4"><span id="A4.T4.1.9.1.1" class="ltx_text">Obj</span></td>
<td id="A4.T4.1.9.2" class="ltx_td ltx_align_center">VisA</td>
<td id="A4.T4.1.9.3" class="ltx_td ltx_align_center">12</td>
<td id="A4.T4.1.9.4" class="ltx_td ltx_align_center">(95.5, 87.0)</td>
<td id="A4.T4.1.9.5" class="ltx_td ltx_align_center">(<span id="A4.T4.1.9.5.1" class="ltx_text" style="color:#FF0000;">98.5</span>, <span id="A4.T4.1.9.5.2" class="ltx_text" style="color:#FF0000;">92.2</span>)</td>
<td id="A4.T4.1.9.6" class="ltx_td ltx_align_center">(<span id="A4.T4.1.9.6.1" class="ltx_text" style="color:#0000FF;">98.4</span>, <span id="A4.T4.1.9.6.2" class="ltx_text" style="color:#0000FF;">91.2</span>)</td>
</tr>
<tr id="A4.T4.1.10" class="ltx_tr">
<td id="A4.T4.1.10.1" class="ltx_td ltx_align_center">MPDD</td>
<td id="A4.T4.1.10.2" class="ltx_td ltx_align_center">6</td>
<td id="A4.T4.1.10.3" class="ltx_td ltx_align_center">(96.5, 88.7)</td>
<td id="A4.T4.1.10.4" class="ltx_td ltx_align_center">(<span id="A4.T4.1.10.4.1" class="ltx_text" style="color:#FF0000;">98.8</span>, <span id="A4.T4.1.10.4.2" class="ltx_text" style="color:#0000FF;">94.9</span>)</td>
<td id="A4.T4.1.10.5" class="ltx_td ltx_align_center">(<span id="A4.T4.1.10.5.1" class="ltx_text" style="color:#0000FF;">98.4</span>, <span id="A4.T4.1.10.5.2" class="ltx_text" style="color:#FF0000;">95.2</span>)</td>
</tr>
<tr id="A4.T4.1.11" class="ltx_tr">
<td id="A4.T4.1.11.1" class="ltx_td ltx_align_center">BTAD</td>
<td id="A4.T4.1.11.2" class="ltx_td ltx_align_center">3</td>
<td id="A4.T4.1.11.3" class="ltx_td ltx_align_center">(94.2, <span id="A4.T4.1.11.3.1" class="ltx_text" style="color:#0000FF;">74.8</span>)</td>
<td id="A4.T4.1.11.4" class="ltx_td ltx_align_center">(<span id="A4.T4.1.11.4.1" class="ltx_text" style="color:#0000FF;">97.4</span>, 74.4)</td>
<td id="A4.T4.1.11.5" class="ltx_td ltx_align_center">(<span id="A4.T4.1.11.5.1" class="ltx_text" style="color:#FF0000;">97.5</span>, <span id="A4.T4.1.11.5.2" class="ltx_text" style="color:#FF0000;">75.1</span>)</td>
</tr>
<tr id="A4.T4.1.12" class="ltx_tr">
<td id="A4.T4.1.12.1" class="ltx_td ltx_align_center">SDD</td>
<td id="A4.T4.1.12.2" class="ltx_td ltx_align_center">1</td>
<td id="A4.T4.1.12.3" class="ltx_td ltx_align_center">(<span id="A4.T4.1.12.3.1" class="ltx_text" style="color:#0000FF;">90.6</span>, <span id="A4.T4.1.12.3.2" class="ltx_text" style="color:#0000FF;">67.8</span>)</td>
<td id="A4.T4.1.12.4" class="ltx_td ltx_align_center">(87.9, 46.3)</td>
<td id="A4.T4.1.12.5" class="ltx_td ltx_align_center">(<span id="A4.T4.1.12.5.1" class="ltx_text" style="color:#FF0000;">92.2</span>, <span id="A4.T4.1.12.5.2" class="ltx_text" style="color:#FF0000;">72.0</span>)</td>
</tr>
<tr id="A4.T4.1.13" class="ltx_tr">
<td id="A4.T4.1.13.1" class="ltx_td ltx_align_center ltx_border_bb"><span id="A4.T4.1.13.1.1" class="ltx_text">Texture</span></td>
<td id="A4.T4.1.13.2" class="ltx_td ltx_align_center ltx_border_bb">DAGM</td>
<td id="A4.T4.1.13.3" class="ltx_td ltx_align_center ltx_border_bb">10</td>
<td id="A4.T4.1.13.4" class="ltx_td ltx_align_center ltx_border_bb">(95.6, <span id="A4.T4.1.13.4.1" class="ltx_text" style="color:#0000FF;">91.0</span>)</td>
<td id="A4.T4.1.13.5" class="ltx_td ltx_align_center ltx_border_bb">(<span id="A4.T4.1.13.5.1" class="ltx_text" style="color:#0000FF;">95.9</span>, 87.9)</td>
<td id="A4.T4.1.13.6" class="ltx_td ltx_align_center ltx_border_bb">(<span id="A4.T4.1.13.6.1" class="ltx_text" style="color:#FF0000;">96.8</span>, <span id="A4.T4.1.13.6.2" class="ltx_text" style="color:#FF0000;">91.9</span>)</td>
</tr>
</table>
</figure>
<section id="A4.SS0.SSS0.Px1" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Comparison with SOTA full-shot methods</h5>

<div id="A4.SS0.SSS0.Px1.p1" class="ltx_para ltx_noindent">
<p id="A4.SS0.SSS0.Px1.p1.1" class="ltx_p">In this section, we are interested in the performance gap between AnomalyCLIP and the recently published SOTA full-shot methods, such as PatchCore <cite class="ltx_cite ltx_citemacro_citep">(Roth et al., <a href="#bib.bib44" title="" class="ltx_ref">2022</a>)</cite> and RD4AD <cite class="ltx_cite ltx_citemacro_citep">(Deng &amp; Li, <a href="#bib.bib9" title="" class="ltx_ref">2022</a>)</cite>. Since some datasets do not provide normal training data, we conduct experiments on six public datasets. AnomalyCLIP achieves comparable anomaly detection and segmentation performance compared to PatchCore and RD4AD, and it even outperforms them in some datasets. This illustrates that the generic prompt embeddings empower AnomalyCLIP to effectively capture the normality and abnormality so that AnomalyCLIP can surpass the performance boundary decided by the training data.</p>
</div>
</section>
<section id="A4.SS0.SSS0.Px2" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Refinement of the textual space</h5>

<div id="A4.SS0.SSS0.Px2.p1" class="ltx_para ltx_noindent">
<p id="A4.SS0.SSS0.Px2.p1.16" class="ltx_p">A representative embedding is not only decided by the well-designed text prompt, it also depends on the appropriate textual space. During fine-tuning, randomly initialized learnable token embeddings are introduced in the text encoder to refine the textual space for the adaption to AD. To control the degree of refining the textual space, we choose to insert the learnable token embeddings into the text encoder from its bottom to the top layer. In particular, the trainable and original tokens are denoted as <math id="A4.SS0.SSS0.Px2.p1.1.m1.1" class="ltx_Math" alttext="t^{\prime}_{m}" display="inline"><semantics id="A4.SS0.SSS0.Px2.p1.1.m1.1a"><msubsup id="A4.SS0.SSS0.Px2.p1.1.m1.1.1" xref="A4.SS0.SSS0.Px2.p1.1.m1.1.1.cmml"><mi id="A4.SS0.SSS0.Px2.p1.1.m1.1.1.2.2" xref="A4.SS0.SSS0.Px2.p1.1.m1.1.1.2.2.cmml">t</mi><mi id="A4.SS0.SSS0.Px2.p1.1.m1.1.1.3" xref="A4.SS0.SSS0.Px2.p1.1.m1.1.1.3.cmml">m</mi><mo id="A4.SS0.SSS0.Px2.p1.1.m1.1.1.2.3" xref="A4.SS0.SSS0.Px2.p1.1.m1.1.1.2.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="A4.SS0.SSS0.Px2.p1.1.m1.1b"><apply id="A4.SS0.SSS0.Px2.p1.1.m1.1.1.cmml" xref="A4.SS0.SSS0.Px2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="A4.SS0.SSS0.Px2.p1.1.m1.1.1.1.cmml" xref="A4.SS0.SSS0.Px2.p1.1.m1.1.1">subscript</csymbol><apply id="A4.SS0.SSS0.Px2.p1.1.m1.1.1.2.cmml" xref="A4.SS0.SSS0.Px2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="A4.SS0.SSS0.Px2.p1.1.m1.1.1.2.1.cmml" xref="A4.SS0.SSS0.Px2.p1.1.m1.1.1">superscript</csymbol><ci id="A4.SS0.SSS0.Px2.p1.1.m1.1.1.2.2.cmml" xref="A4.SS0.SSS0.Px2.p1.1.m1.1.1.2.2">𝑡</ci><ci id="A4.SS0.SSS0.Px2.p1.1.m1.1.1.2.3.cmml" xref="A4.SS0.SSS0.Px2.p1.1.m1.1.1.2.3">′</ci></apply><ci id="A4.SS0.SSS0.Px2.p1.1.m1.1.1.3.cmml" xref="A4.SS0.SSS0.Px2.p1.1.m1.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS0.SSS0.Px2.p1.1.m1.1c">t^{\prime}_{m}</annotation></semantics></math> and <math id="A4.SS0.SSS0.Px2.p1.2.m2.1" class="ltx_Math" alttext="t_{m}" display="inline"><semantics id="A4.SS0.SSS0.Px2.p1.2.m2.1a"><msub id="A4.SS0.SSS0.Px2.p1.2.m2.1.1" xref="A4.SS0.SSS0.Px2.p1.2.m2.1.1.cmml"><mi id="A4.SS0.SSS0.Px2.p1.2.m2.1.1.2" xref="A4.SS0.SSS0.Px2.p1.2.m2.1.1.2.cmml">t</mi><mi id="A4.SS0.SSS0.Px2.p1.2.m2.1.1.3" xref="A4.SS0.SSS0.Px2.p1.2.m2.1.1.3.cmml">m</mi></msub><annotation-xml encoding="MathML-Content" id="A4.SS0.SSS0.Px2.p1.2.m2.1b"><apply id="A4.SS0.SSS0.Px2.p1.2.m2.1.1.cmml" xref="A4.SS0.SSS0.Px2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="A4.SS0.SSS0.Px2.p1.2.m2.1.1.1.cmml" xref="A4.SS0.SSS0.Px2.p1.2.m2.1.1">subscript</csymbol><ci id="A4.SS0.SSS0.Px2.p1.2.m2.1.1.2.cmml" xref="A4.SS0.SSS0.Px2.p1.2.m2.1.1.2">𝑡</ci><ci id="A4.SS0.SSS0.Px2.p1.2.m2.1.1.3.cmml" xref="A4.SS0.SSS0.Px2.p1.2.m2.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS0.SSS0.Px2.p1.2.m2.1c">t_{m}</annotation></semantics></math>, respectively, where <math id="A4.SS0.SSS0.Px2.p1.3.m3.1" class="ltx_Math" alttext="m" display="inline"><semantics id="A4.SS0.SSS0.Px2.p1.3.m3.1a"><mi id="A4.SS0.SSS0.Px2.p1.3.m3.1.1" xref="A4.SS0.SSS0.Px2.p1.3.m3.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="A4.SS0.SSS0.Px2.p1.3.m3.1b"><ci id="A4.SS0.SSS0.Px2.p1.3.m3.1.1.cmml" xref="A4.SS0.SSS0.Px2.p1.3.m3.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.SS0.SSS0.Px2.p1.3.m3.1c">m</annotation></semantics></math> represents the layer of the text encoder. To integrate the original textual representations, for the layer <math id="A4.SS0.SSS0.Px2.p1.4.m4.1" class="ltx_Math" alttext="m" display="inline"><semantics id="A4.SS0.SSS0.Px2.p1.4.m4.1a"><mi id="A4.SS0.SSS0.Px2.p1.4.m4.1.1" xref="A4.SS0.SSS0.Px2.p1.4.m4.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="A4.SS0.SSS0.Px2.p1.4.m4.1b"><ci id="A4.SS0.SSS0.Px2.p1.4.m4.1.1.cmml" xref="A4.SS0.SSS0.Px2.p1.4.m4.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.SS0.SSS0.Px2.p1.4.m4.1c">m</annotation></semantics></math>, we concatenate <math id="A4.SS0.SSS0.Px2.p1.5.m5.1" class="ltx_Math" alttext="t^{\prime}_{m}" display="inline"><semantics id="A4.SS0.SSS0.Px2.p1.5.m5.1a"><msubsup id="A4.SS0.SSS0.Px2.p1.5.m5.1.1" xref="A4.SS0.SSS0.Px2.p1.5.m5.1.1.cmml"><mi id="A4.SS0.SSS0.Px2.p1.5.m5.1.1.2.2" xref="A4.SS0.SSS0.Px2.p1.5.m5.1.1.2.2.cmml">t</mi><mi id="A4.SS0.SSS0.Px2.p1.5.m5.1.1.3" xref="A4.SS0.SSS0.Px2.p1.5.m5.1.1.3.cmml">m</mi><mo id="A4.SS0.SSS0.Px2.p1.5.m5.1.1.2.3" xref="A4.SS0.SSS0.Px2.p1.5.m5.1.1.2.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="A4.SS0.SSS0.Px2.p1.5.m5.1b"><apply id="A4.SS0.SSS0.Px2.p1.5.m5.1.1.cmml" xref="A4.SS0.SSS0.Px2.p1.5.m5.1.1"><csymbol cd="ambiguous" id="A4.SS0.SSS0.Px2.p1.5.m5.1.1.1.cmml" xref="A4.SS0.SSS0.Px2.p1.5.m5.1.1">subscript</csymbol><apply id="A4.SS0.SSS0.Px2.p1.5.m5.1.1.2.cmml" xref="A4.SS0.SSS0.Px2.p1.5.m5.1.1"><csymbol cd="ambiguous" id="A4.SS0.SSS0.Px2.p1.5.m5.1.1.2.1.cmml" xref="A4.SS0.SSS0.Px2.p1.5.m5.1.1">superscript</csymbol><ci id="A4.SS0.SSS0.Px2.p1.5.m5.1.1.2.2.cmml" xref="A4.SS0.SSS0.Px2.p1.5.m5.1.1.2.2">𝑡</ci><ci id="A4.SS0.SSS0.Px2.p1.5.m5.1.1.2.3.cmml" xref="A4.SS0.SSS0.Px2.p1.5.m5.1.1.2.3">′</ci></apply><ci id="A4.SS0.SSS0.Px2.p1.5.m5.1.1.3.cmml" xref="A4.SS0.SSS0.Px2.p1.5.m5.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS0.SSS0.Px2.p1.5.m5.1c">t^{\prime}_{m}</annotation></semantics></math> and <math id="A4.SS0.SSS0.Px2.p1.6.m6.1" class="ltx_Math" alttext="t_{m}" display="inline"><semantics id="A4.SS0.SSS0.Px2.p1.6.m6.1a"><msub id="A4.SS0.SSS0.Px2.p1.6.m6.1.1" xref="A4.SS0.SSS0.Px2.p1.6.m6.1.1.cmml"><mi id="A4.SS0.SSS0.Px2.p1.6.m6.1.1.2" xref="A4.SS0.SSS0.Px2.p1.6.m6.1.1.2.cmml">t</mi><mi id="A4.SS0.SSS0.Px2.p1.6.m6.1.1.3" xref="A4.SS0.SSS0.Px2.p1.6.m6.1.1.3.cmml">m</mi></msub><annotation-xml encoding="MathML-Content" id="A4.SS0.SSS0.Px2.p1.6.m6.1b"><apply id="A4.SS0.SSS0.Px2.p1.6.m6.1.1.cmml" xref="A4.SS0.SSS0.Px2.p1.6.m6.1.1"><csymbol cd="ambiguous" id="A4.SS0.SSS0.Px2.p1.6.m6.1.1.1.cmml" xref="A4.SS0.SSS0.Px2.p1.6.m6.1.1">subscript</csymbol><ci id="A4.SS0.SSS0.Px2.p1.6.m6.1.1.2.cmml" xref="A4.SS0.SSS0.Px2.p1.6.m6.1.1.2">𝑡</ci><ci id="A4.SS0.SSS0.Px2.p1.6.m6.1.1.3.cmml" xref="A4.SS0.SSS0.Px2.p1.6.m6.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS0.SSS0.Px2.p1.6.m6.1c">t_{m}</annotation></semantics></math> along the dimension of the channel and then forward them into <math id="A4.SS0.SSS0.Px2.p1.7.m7.1" class="ltx_Math" alttext="T_{m}" display="inline"><semantics id="A4.SS0.SSS0.Px2.p1.7.m7.1a"><msub id="A4.SS0.SSS0.Px2.p1.7.m7.1.1" xref="A4.SS0.SSS0.Px2.p1.7.m7.1.1.cmml"><mi id="A4.SS0.SSS0.Px2.p1.7.m7.1.1.2" xref="A4.SS0.SSS0.Px2.p1.7.m7.1.1.2.cmml">T</mi><mi id="A4.SS0.SSS0.Px2.p1.7.m7.1.1.3" xref="A4.SS0.SSS0.Px2.p1.7.m7.1.1.3.cmml">m</mi></msub><annotation-xml encoding="MathML-Content" id="A4.SS0.SSS0.Px2.p1.7.m7.1b"><apply id="A4.SS0.SSS0.Px2.p1.7.m7.1.1.cmml" xref="A4.SS0.SSS0.Px2.p1.7.m7.1.1"><csymbol cd="ambiguous" id="A4.SS0.SSS0.Px2.p1.7.m7.1.1.1.cmml" xref="A4.SS0.SSS0.Px2.p1.7.m7.1.1">subscript</csymbol><ci id="A4.SS0.SSS0.Px2.p1.7.m7.1.1.2.cmml" xref="A4.SS0.SSS0.Px2.p1.7.m7.1.1.2">𝑇</ci><ci id="A4.SS0.SSS0.Px2.p1.7.m7.1.1.3.cmml" xref="A4.SS0.SSS0.Px2.p1.7.m7.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS0.SSS0.Px2.p1.7.m7.1c">T_{m}</annotation></semantics></math> to get <math id="A4.SS0.SSS0.Px2.p1.8.m8.1" class="ltx_Math" alttext="r^{\prime}_{m+1}" display="inline"><semantics id="A4.SS0.SSS0.Px2.p1.8.m8.1a"><msubsup id="A4.SS0.SSS0.Px2.p1.8.m8.1.1" xref="A4.SS0.SSS0.Px2.p1.8.m8.1.1.cmml"><mi id="A4.SS0.SSS0.Px2.p1.8.m8.1.1.2.2" xref="A4.SS0.SSS0.Px2.p1.8.m8.1.1.2.2.cmml">r</mi><mrow id="A4.SS0.SSS0.Px2.p1.8.m8.1.1.3" xref="A4.SS0.SSS0.Px2.p1.8.m8.1.1.3.cmml"><mi id="A4.SS0.SSS0.Px2.p1.8.m8.1.1.3.2" xref="A4.SS0.SSS0.Px2.p1.8.m8.1.1.3.2.cmml">m</mi><mo id="A4.SS0.SSS0.Px2.p1.8.m8.1.1.3.1" xref="A4.SS0.SSS0.Px2.p1.8.m8.1.1.3.1.cmml">+</mo><mn id="A4.SS0.SSS0.Px2.p1.8.m8.1.1.3.3" xref="A4.SS0.SSS0.Px2.p1.8.m8.1.1.3.3.cmml">1</mn></mrow><mo id="A4.SS0.SSS0.Px2.p1.8.m8.1.1.2.3" xref="A4.SS0.SSS0.Px2.p1.8.m8.1.1.2.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="A4.SS0.SSS0.Px2.p1.8.m8.1b"><apply id="A4.SS0.SSS0.Px2.p1.8.m8.1.1.cmml" xref="A4.SS0.SSS0.Px2.p1.8.m8.1.1"><csymbol cd="ambiguous" id="A4.SS0.SSS0.Px2.p1.8.m8.1.1.1.cmml" xref="A4.SS0.SSS0.Px2.p1.8.m8.1.1">subscript</csymbol><apply id="A4.SS0.SSS0.Px2.p1.8.m8.1.1.2.cmml" xref="A4.SS0.SSS0.Px2.p1.8.m8.1.1"><csymbol cd="ambiguous" id="A4.SS0.SSS0.Px2.p1.8.m8.1.1.2.1.cmml" xref="A4.SS0.SSS0.Px2.p1.8.m8.1.1">superscript</csymbol><ci id="A4.SS0.SSS0.Px2.p1.8.m8.1.1.2.2.cmml" xref="A4.SS0.SSS0.Px2.p1.8.m8.1.1.2.2">𝑟</ci><ci id="A4.SS0.SSS0.Px2.p1.8.m8.1.1.2.3.cmml" xref="A4.SS0.SSS0.Px2.p1.8.m8.1.1.2.3">′</ci></apply><apply id="A4.SS0.SSS0.Px2.p1.8.m8.1.1.3.cmml" xref="A4.SS0.SSS0.Px2.p1.8.m8.1.1.3"><plus id="A4.SS0.SSS0.Px2.p1.8.m8.1.1.3.1.cmml" xref="A4.SS0.SSS0.Px2.p1.8.m8.1.1.3.1"></plus><ci id="A4.SS0.SSS0.Px2.p1.8.m8.1.1.3.2.cmml" xref="A4.SS0.SSS0.Px2.p1.8.m8.1.1.3.2">𝑚</ci><cn type="integer" id="A4.SS0.SSS0.Px2.p1.8.m8.1.1.3.3.cmml" xref="A4.SS0.SSS0.Px2.p1.8.m8.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS0.SSS0.Px2.p1.8.m8.1c">r^{\prime}_{m+1}</annotation></semantics></math> and <math id="A4.SS0.SSS0.Px2.p1.9.m9.1" class="ltx_Math" alttext="t_{m+1}" display="inline"><semantics id="A4.SS0.SSS0.Px2.p1.9.m9.1a"><msub id="A4.SS0.SSS0.Px2.p1.9.m9.1.1" xref="A4.SS0.SSS0.Px2.p1.9.m9.1.1.cmml"><mi id="A4.SS0.SSS0.Px2.p1.9.m9.1.1.2" xref="A4.SS0.SSS0.Px2.p1.9.m9.1.1.2.cmml">t</mi><mrow id="A4.SS0.SSS0.Px2.p1.9.m9.1.1.3" xref="A4.SS0.SSS0.Px2.p1.9.m9.1.1.3.cmml"><mi id="A4.SS0.SSS0.Px2.p1.9.m9.1.1.3.2" xref="A4.SS0.SSS0.Px2.p1.9.m9.1.1.3.2.cmml">m</mi><mo id="A4.SS0.SSS0.Px2.p1.9.m9.1.1.3.1" xref="A4.SS0.SSS0.Px2.p1.9.m9.1.1.3.1.cmml">+</mo><mn id="A4.SS0.SSS0.Px2.p1.9.m9.1.1.3.3" xref="A4.SS0.SSS0.Px2.p1.9.m9.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="A4.SS0.SSS0.Px2.p1.9.m9.1b"><apply id="A4.SS0.SSS0.Px2.p1.9.m9.1.1.cmml" xref="A4.SS0.SSS0.Px2.p1.9.m9.1.1"><csymbol cd="ambiguous" id="A4.SS0.SSS0.Px2.p1.9.m9.1.1.1.cmml" xref="A4.SS0.SSS0.Px2.p1.9.m9.1.1">subscript</csymbol><ci id="A4.SS0.SSS0.Px2.p1.9.m9.1.1.2.cmml" xref="A4.SS0.SSS0.Px2.p1.9.m9.1.1.2">𝑡</ci><apply id="A4.SS0.SSS0.Px2.p1.9.m9.1.1.3.cmml" xref="A4.SS0.SSS0.Px2.p1.9.m9.1.1.3"><plus id="A4.SS0.SSS0.Px2.p1.9.m9.1.1.3.1.cmml" xref="A4.SS0.SSS0.Px2.p1.9.m9.1.1.3.1"></plus><ci id="A4.SS0.SSS0.Px2.p1.9.m9.1.1.3.2.cmml" xref="A4.SS0.SSS0.Px2.p1.9.m9.1.1.3.2">𝑚</ci><cn type="integer" id="A4.SS0.SSS0.Px2.p1.9.m9.1.1.3.3.cmml" xref="A4.SS0.SSS0.Px2.p1.9.m9.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS0.SSS0.Px2.p1.9.m9.1c">t_{m+1}</annotation></semantics></math>. Due to the self-attention mechanism, the output of <math id="A4.SS0.SSS0.Px2.p1.10.m10.1" class="ltx_Math" alttext="t_{m+1}" display="inline"><semantics id="A4.SS0.SSS0.Px2.p1.10.m10.1a"><msub id="A4.SS0.SSS0.Px2.p1.10.m10.1.1" xref="A4.SS0.SSS0.Px2.p1.10.m10.1.1.cmml"><mi id="A4.SS0.SSS0.Px2.p1.10.m10.1.1.2" xref="A4.SS0.SSS0.Px2.p1.10.m10.1.1.2.cmml">t</mi><mrow id="A4.SS0.SSS0.Px2.p1.10.m10.1.1.3" xref="A4.SS0.SSS0.Px2.p1.10.m10.1.1.3.cmml"><mi id="A4.SS0.SSS0.Px2.p1.10.m10.1.1.3.2" xref="A4.SS0.SSS0.Px2.p1.10.m10.1.1.3.2.cmml">m</mi><mo id="A4.SS0.SSS0.Px2.p1.10.m10.1.1.3.1" xref="A4.SS0.SSS0.Px2.p1.10.m10.1.1.3.1.cmml">+</mo><mn id="A4.SS0.SSS0.Px2.p1.10.m10.1.1.3.3" xref="A4.SS0.SSS0.Px2.p1.10.m10.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="A4.SS0.SSS0.Px2.p1.10.m10.1b"><apply id="A4.SS0.SSS0.Px2.p1.10.m10.1.1.cmml" xref="A4.SS0.SSS0.Px2.p1.10.m10.1.1"><csymbol cd="ambiguous" id="A4.SS0.SSS0.Px2.p1.10.m10.1.1.1.cmml" xref="A4.SS0.SSS0.Px2.p1.10.m10.1.1">subscript</csymbol><ci id="A4.SS0.SSS0.Px2.p1.10.m10.1.1.2.cmml" xref="A4.SS0.SSS0.Px2.p1.10.m10.1.1.2">𝑡</ci><apply id="A4.SS0.SSS0.Px2.p1.10.m10.1.1.3.cmml" xref="A4.SS0.SSS0.Px2.p1.10.m10.1.1.3"><plus id="A4.SS0.SSS0.Px2.p1.10.m10.1.1.3.1.cmml" xref="A4.SS0.SSS0.Px2.p1.10.m10.1.1.3.1"></plus><ci id="A4.SS0.SSS0.Px2.p1.10.m10.1.1.3.2.cmml" xref="A4.SS0.SSS0.Px2.p1.10.m10.1.1.3.2">𝑚</ci><cn type="integer" id="A4.SS0.SSS0.Px2.p1.10.m10.1.1.3.3.cmml" xref="A4.SS0.SSS0.Px2.p1.10.m10.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS0.SSS0.Px2.p1.10.m10.1c">t_{m+1}</annotation></semantics></math> contains the information of <math id="A4.SS0.SSS0.Px2.p1.11.m11.1" class="ltx_Math" alttext="t^{\prime}_{m}" display="inline"><semantics id="A4.SS0.SSS0.Px2.p1.11.m11.1a"><msubsup id="A4.SS0.SSS0.Px2.p1.11.m11.1.1" xref="A4.SS0.SSS0.Px2.p1.11.m11.1.1.cmml"><mi id="A4.SS0.SSS0.Px2.p1.11.m11.1.1.2.2" xref="A4.SS0.SSS0.Px2.p1.11.m11.1.1.2.2.cmml">t</mi><mi id="A4.SS0.SSS0.Px2.p1.11.m11.1.1.3" xref="A4.SS0.SSS0.Px2.p1.11.m11.1.1.3.cmml">m</mi><mo id="A4.SS0.SSS0.Px2.p1.11.m11.1.1.2.3" xref="A4.SS0.SSS0.Px2.p1.11.m11.1.1.2.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="A4.SS0.SSS0.Px2.p1.11.m11.1b"><apply id="A4.SS0.SSS0.Px2.p1.11.m11.1.1.cmml" xref="A4.SS0.SSS0.Px2.p1.11.m11.1.1"><csymbol cd="ambiguous" id="A4.SS0.SSS0.Px2.p1.11.m11.1.1.1.cmml" xref="A4.SS0.SSS0.Px2.p1.11.m11.1.1">subscript</csymbol><apply id="A4.SS0.SSS0.Px2.p1.11.m11.1.1.2.cmml" xref="A4.SS0.SSS0.Px2.p1.11.m11.1.1"><csymbol cd="ambiguous" id="A4.SS0.SSS0.Px2.p1.11.m11.1.1.2.1.cmml" xref="A4.SS0.SSS0.Px2.p1.11.m11.1.1">superscript</csymbol><ci id="A4.SS0.SSS0.Px2.p1.11.m11.1.1.2.2.cmml" xref="A4.SS0.SSS0.Px2.p1.11.m11.1.1.2.2">𝑡</ci><ci id="A4.SS0.SSS0.Px2.p1.11.m11.1.1.2.3.cmml" xref="A4.SS0.SSS0.Px2.p1.11.m11.1.1.2.3">′</ci></apply><ci id="A4.SS0.SSS0.Px2.p1.11.m11.1.1.3.cmml" xref="A4.SS0.SSS0.Px2.p1.11.m11.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS0.SSS0.Px2.p1.11.m11.1c">t^{\prime}_{m}</annotation></semantics></math>. In order to provide adequate calibration, we discard the obtained <math id="A4.SS0.SSS0.Px2.p1.12.m12.1" class="ltx_Math" alttext="r^{\prime}_{m+1}" display="inline"><semantics id="A4.SS0.SSS0.Px2.p1.12.m12.1a"><msubsup id="A4.SS0.SSS0.Px2.p1.12.m12.1.1" xref="A4.SS0.SSS0.Px2.p1.12.m12.1.1.cmml"><mi id="A4.SS0.SSS0.Px2.p1.12.m12.1.1.2.2" xref="A4.SS0.SSS0.Px2.p1.12.m12.1.1.2.2.cmml">r</mi><mrow id="A4.SS0.SSS0.Px2.p1.12.m12.1.1.3" xref="A4.SS0.SSS0.Px2.p1.12.m12.1.1.3.cmml"><mi id="A4.SS0.SSS0.Px2.p1.12.m12.1.1.3.2" xref="A4.SS0.SSS0.Px2.p1.12.m12.1.1.3.2.cmml">m</mi><mo id="A4.SS0.SSS0.Px2.p1.12.m12.1.1.3.1" xref="A4.SS0.SSS0.Px2.p1.12.m12.1.1.3.1.cmml">+</mo><mn id="A4.SS0.SSS0.Px2.p1.12.m12.1.1.3.3" xref="A4.SS0.SSS0.Px2.p1.12.m12.1.1.3.3.cmml">1</mn></mrow><mo id="A4.SS0.SSS0.Px2.p1.12.m12.1.1.2.3" xref="A4.SS0.SSS0.Px2.p1.12.m12.1.1.2.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="A4.SS0.SSS0.Px2.p1.12.m12.1b"><apply id="A4.SS0.SSS0.Px2.p1.12.m12.1.1.cmml" xref="A4.SS0.SSS0.Px2.p1.12.m12.1.1"><csymbol cd="ambiguous" id="A4.SS0.SSS0.Px2.p1.12.m12.1.1.1.cmml" xref="A4.SS0.SSS0.Px2.p1.12.m12.1.1">subscript</csymbol><apply id="A4.SS0.SSS0.Px2.p1.12.m12.1.1.2.cmml" xref="A4.SS0.SSS0.Px2.p1.12.m12.1.1"><csymbol cd="ambiguous" id="A4.SS0.SSS0.Px2.p1.12.m12.1.1.2.1.cmml" xref="A4.SS0.SSS0.Px2.p1.12.m12.1.1">superscript</csymbol><ci id="A4.SS0.SSS0.Px2.p1.12.m12.1.1.2.2.cmml" xref="A4.SS0.SSS0.Px2.p1.12.m12.1.1.2.2">𝑟</ci><ci id="A4.SS0.SSS0.Px2.p1.12.m12.1.1.2.3.cmml" xref="A4.SS0.SSS0.Px2.p1.12.m12.1.1.2.3">′</ci></apply><apply id="A4.SS0.SSS0.Px2.p1.12.m12.1.1.3.cmml" xref="A4.SS0.SSS0.Px2.p1.12.m12.1.1.3"><plus id="A4.SS0.SSS0.Px2.p1.12.m12.1.1.3.1.cmml" xref="A4.SS0.SSS0.Px2.p1.12.m12.1.1.3.1"></plus><ci id="A4.SS0.SSS0.Px2.p1.12.m12.1.1.3.2.cmml" xref="A4.SS0.SSS0.Px2.p1.12.m12.1.1.3.2">𝑚</ci><cn type="integer" id="A4.SS0.SSS0.Px2.p1.12.m12.1.1.3.3.cmml" xref="A4.SS0.SSS0.Px2.p1.12.m12.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS0.SSS0.Px2.p1.12.m12.1c">r^{\prime}_{m+1}</annotation></semantics></math> and initialize new learnable token embeddings <math id="A4.SS0.SSS0.Px2.p1.13.m13.1" class="ltx_Math" alttext="t^{\prime}_{m+1}" display="inline"><semantics id="A4.SS0.SSS0.Px2.p1.13.m13.1a"><msubsup id="A4.SS0.SSS0.Px2.p1.13.m13.1.1" xref="A4.SS0.SSS0.Px2.p1.13.m13.1.1.cmml"><mi id="A4.SS0.SSS0.Px2.p1.13.m13.1.1.2.2" xref="A4.SS0.SSS0.Px2.p1.13.m13.1.1.2.2.cmml">t</mi><mrow id="A4.SS0.SSS0.Px2.p1.13.m13.1.1.3" xref="A4.SS0.SSS0.Px2.p1.13.m13.1.1.3.cmml"><mi id="A4.SS0.SSS0.Px2.p1.13.m13.1.1.3.2" xref="A4.SS0.SSS0.Px2.p1.13.m13.1.1.3.2.cmml">m</mi><mo id="A4.SS0.SSS0.Px2.p1.13.m13.1.1.3.1" xref="A4.SS0.SSS0.Px2.p1.13.m13.1.1.3.1.cmml">+</mo><mn id="A4.SS0.SSS0.Px2.p1.13.m13.1.1.3.3" xref="A4.SS0.SSS0.Px2.p1.13.m13.1.1.3.3.cmml">1</mn></mrow><mo id="A4.SS0.SSS0.Px2.p1.13.m13.1.1.2.3" xref="A4.SS0.SSS0.Px2.p1.13.m13.1.1.2.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="A4.SS0.SSS0.Px2.p1.13.m13.1b"><apply id="A4.SS0.SSS0.Px2.p1.13.m13.1.1.cmml" xref="A4.SS0.SSS0.Px2.p1.13.m13.1.1"><csymbol cd="ambiguous" id="A4.SS0.SSS0.Px2.p1.13.m13.1.1.1.cmml" xref="A4.SS0.SSS0.Px2.p1.13.m13.1.1">subscript</csymbol><apply id="A4.SS0.SSS0.Px2.p1.13.m13.1.1.2.cmml" xref="A4.SS0.SSS0.Px2.p1.13.m13.1.1"><csymbol cd="ambiguous" id="A4.SS0.SSS0.Px2.p1.13.m13.1.1.2.1.cmml" xref="A4.SS0.SSS0.Px2.p1.13.m13.1.1">superscript</csymbol><ci id="A4.SS0.SSS0.Px2.p1.13.m13.1.1.2.2.cmml" xref="A4.SS0.SSS0.Px2.p1.13.m13.1.1.2.2">𝑡</ci><ci id="A4.SS0.SSS0.Px2.p1.13.m13.1.1.2.3.cmml" xref="A4.SS0.SSS0.Px2.p1.13.m13.1.1.2.3">′</ci></apply><apply id="A4.SS0.SSS0.Px2.p1.13.m13.1.1.3.cmml" xref="A4.SS0.SSS0.Px2.p1.13.m13.1.1.3"><plus id="A4.SS0.SSS0.Px2.p1.13.m13.1.1.3.1.cmml" xref="A4.SS0.SSS0.Px2.p1.13.m13.1.1.3.1"></plus><ci id="A4.SS0.SSS0.Px2.p1.13.m13.1.1.3.2.cmml" xref="A4.SS0.SSS0.Px2.p1.13.m13.1.1.3.2">𝑚</ci><cn type="integer" id="A4.SS0.SSS0.Px2.p1.13.m13.1.1.3.3.cmml" xref="A4.SS0.SSS0.Px2.p1.13.m13.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS0.SSS0.Px2.p1.13.m13.1c">t^{\prime}_{m+1}</annotation></semantics></math>. Through this operation, <math id="A4.SS0.SSS0.Px2.p1.14.m14.1" class="ltx_Math" alttext="t^{\prime}_{m+1}" display="inline"><semantics id="A4.SS0.SSS0.Px2.p1.14.m14.1a"><msubsup id="A4.SS0.SSS0.Px2.p1.14.m14.1.1" xref="A4.SS0.SSS0.Px2.p1.14.m14.1.1.cmml"><mi id="A4.SS0.SSS0.Px2.p1.14.m14.1.1.2.2" xref="A4.SS0.SSS0.Px2.p1.14.m14.1.1.2.2.cmml">t</mi><mrow id="A4.SS0.SSS0.Px2.p1.14.m14.1.1.3" xref="A4.SS0.SSS0.Px2.p1.14.m14.1.1.3.cmml"><mi id="A4.SS0.SSS0.Px2.p1.14.m14.1.1.3.2" xref="A4.SS0.SSS0.Px2.p1.14.m14.1.1.3.2.cmml">m</mi><mo id="A4.SS0.SSS0.Px2.p1.14.m14.1.1.3.1" xref="A4.SS0.SSS0.Px2.p1.14.m14.1.1.3.1.cmml">+</mo><mn id="A4.SS0.SSS0.Px2.p1.14.m14.1.1.3.3" xref="A4.SS0.SSS0.Px2.p1.14.m14.1.1.3.3.cmml">1</mn></mrow><mo id="A4.SS0.SSS0.Px2.p1.14.m14.1.1.2.3" xref="A4.SS0.SSS0.Px2.p1.14.m14.1.1.2.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="A4.SS0.SSS0.Px2.p1.14.m14.1b"><apply id="A4.SS0.SSS0.Px2.p1.14.m14.1.1.cmml" xref="A4.SS0.SSS0.Px2.p1.14.m14.1.1"><csymbol cd="ambiguous" id="A4.SS0.SSS0.Px2.p1.14.m14.1.1.1.cmml" xref="A4.SS0.SSS0.Px2.p1.14.m14.1.1">subscript</csymbol><apply id="A4.SS0.SSS0.Px2.p1.14.m14.1.1.2.cmml" xref="A4.SS0.SSS0.Px2.p1.14.m14.1.1"><csymbol cd="ambiguous" id="A4.SS0.SSS0.Px2.p1.14.m14.1.1.2.1.cmml" xref="A4.SS0.SSS0.Px2.p1.14.m14.1.1">superscript</csymbol><ci id="A4.SS0.SSS0.Px2.p1.14.m14.1.1.2.2.cmml" xref="A4.SS0.SSS0.Px2.p1.14.m14.1.1.2.2">𝑡</ci><ci id="A4.SS0.SSS0.Px2.p1.14.m14.1.1.2.3.cmml" xref="A4.SS0.SSS0.Px2.p1.14.m14.1.1.2.3">′</ci></apply><apply id="A4.SS0.SSS0.Px2.p1.14.m14.1.1.3.cmml" xref="A4.SS0.SSS0.Px2.p1.14.m14.1.1.3"><plus id="A4.SS0.SSS0.Px2.p1.14.m14.1.1.3.1.cmml" xref="A4.SS0.SSS0.Px2.p1.14.m14.1.1.3.1"></plus><ci id="A4.SS0.SSS0.Px2.p1.14.m14.1.1.3.2.cmml" xref="A4.SS0.SSS0.Px2.p1.14.m14.1.1.3.2">𝑚</ci><cn type="integer" id="A4.SS0.SSS0.Px2.p1.14.m14.1.1.3.3.cmml" xref="A4.SS0.SSS0.Px2.p1.14.m14.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS0.SSS0.Px2.p1.14.m14.1c">t^{\prime}_{m+1}</annotation></semantics></math> further refines textual representations of the layer <math id="A4.SS0.SSS0.Px2.p1.15.m15.1" class="ltx_Math" alttext="m+1" display="inline"><semantics id="A4.SS0.SSS0.Px2.p1.15.m15.1a"><mrow id="A4.SS0.SSS0.Px2.p1.15.m15.1.1" xref="A4.SS0.SSS0.Px2.p1.15.m15.1.1.cmml"><mi id="A4.SS0.SSS0.Px2.p1.15.m15.1.1.2" xref="A4.SS0.SSS0.Px2.p1.15.m15.1.1.2.cmml">m</mi><mo id="A4.SS0.SSS0.Px2.p1.15.m15.1.1.1" xref="A4.SS0.SSS0.Px2.p1.15.m15.1.1.1.cmml">+</mo><mn id="A4.SS0.SSS0.Px2.p1.15.m15.1.1.3" xref="A4.SS0.SSS0.Px2.p1.15.m15.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="A4.SS0.SSS0.Px2.p1.15.m15.1b"><apply id="A4.SS0.SSS0.Px2.p1.15.m15.1.1.cmml" xref="A4.SS0.SSS0.Px2.p1.15.m15.1.1"><plus id="A4.SS0.SSS0.Px2.p1.15.m15.1.1.1.cmml" xref="A4.SS0.SSS0.Px2.p1.15.m15.1.1.1"></plus><ci id="A4.SS0.SSS0.Px2.p1.15.m15.1.1.2.cmml" xref="A4.SS0.SSS0.Px2.p1.15.m15.1.1.2">𝑚</ci><cn type="integer" id="A4.SS0.SSS0.Px2.p1.15.m15.1.1.3.cmml" xref="A4.SS0.SSS0.Px2.p1.15.m15.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS0.SSS0.Px2.p1.15.m15.1c">m+1</annotation></semantics></math>. We repeat this operation until we reach the designated layer <math id="A4.SS0.SSS0.Px2.p1.16.m16.1" class="ltx_Math" alttext="M^{\prime}" display="inline"><semantics id="A4.SS0.SSS0.Px2.p1.16.m16.1a"><msup id="A4.SS0.SSS0.Px2.p1.16.m16.1.1" xref="A4.SS0.SSS0.Px2.p1.16.m16.1.1.cmml"><mi id="A4.SS0.SSS0.Px2.p1.16.m16.1.1.2" xref="A4.SS0.SSS0.Px2.p1.16.m16.1.1.2.cmml">M</mi><mo id="A4.SS0.SSS0.Px2.p1.16.m16.1.1.3" xref="A4.SS0.SSS0.Px2.p1.16.m16.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="A4.SS0.SSS0.Px2.p1.16.m16.1b"><apply id="A4.SS0.SSS0.Px2.p1.16.m16.1.1.cmml" xref="A4.SS0.SSS0.Px2.p1.16.m16.1.1"><csymbol cd="ambiguous" id="A4.SS0.SSS0.Px2.p1.16.m16.1.1.1.cmml" xref="A4.SS0.SSS0.Px2.p1.16.m16.1.1">superscript</csymbol><ci id="A4.SS0.SSS0.Px2.p1.16.m16.1.1.2.cmml" xref="A4.SS0.SSS0.Px2.p1.16.m16.1.1.2">𝑀</ci><ci id="A4.SS0.SSS0.Px2.p1.16.m16.1.1.3.cmml" xref="A4.SS0.SSS0.Px2.p1.16.m16.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS0.SSS0.Px2.p1.16.m16.1c">M^{\prime}</annotation></semantics></math>. This procedure is given by:</p>
<table id="A6.EGx5" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="A4.Ex9"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="A4.Ex9.m1.2" class="ltx_Math" alttext="\displaystyle[r^{\prime}_{m+1},t_{m+1}]" display="inline"><semantics id="A4.Ex9.m1.2a"><mrow id="A4.Ex9.m1.2.2.2" xref="A4.Ex9.m1.2.2.3.cmml"><mo stretchy="false" id="A4.Ex9.m1.2.2.2.3" xref="A4.Ex9.m1.2.2.3.cmml">[</mo><msubsup id="A4.Ex9.m1.1.1.1.1" xref="A4.Ex9.m1.1.1.1.1.cmml"><mi id="A4.Ex9.m1.1.1.1.1.2.2" xref="A4.Ex9.m1.1.1.1.1.2.2.cmml">r</mi><mrow id="A4.Ex9.m1.1.1.1.1.3" xref="A4.Ex9.m1.1.1.1.1.3.cmml"><mi id="A4.Ex9.m1.1.1.1.1.3.2" xref="A4.Ex9.m1.1.1.1.1.3.2.cmml">m</mi><mo id="A4.Ex9.m1.1.1.1.1.3.1" xref="A4.Ex9.m1.1.1.1.1.3.1.cmml">+</mo><mn id="A4.Ex9.m1.1.1.1.1.3.3" xref="A4.Ex9.m1.1.1.1.1.3.3.cmml">1</mn></mrow><mo id="A4.Ex9.m1.1.1.1.1.2.3" xref="A4.Ex9.m1.1.1.1.1.2.3.cmml">′</mo></msubsup><mo id="A4.Ex9.m1.2.2.2.4" xref="A4.Ex9.m1.2.2.3.cmml">,</mo><msub id="A4.Ex9.m1.2.2.2.2" xref="A4.Ex9.m1.2.2.2.2.cmml"><mi id="A4.Ex9.m1.2.2.2.2.2" xref="A4.Ex9.m1.2.2.2.2.2.cmml">t</mi><mrow id="A4.Ex9.m1.2.2.2.2.3" xref="A4.Ex9.m1.2.2.2.2.3.cmml"><mi id="A4.Ex9.m1.2.2.2.2.3.2" xref="A4.Ex9.m1.2.2.2.2.3.2.cmml">m</mi><mo id="A4.Ex9.m1.2.2.2.2.3.1" xref="A4.Ex9.m1.2.2.2.2.3.1.cmml">+</mo><mn id="A4.Ex9.m1.2.2.2.2.3.3" xref="A4.Ex9.m1.2.2.2.2.3.3.cmml">1</mn></mrow></msub><mo stretchy="false" id="A4.Ex9.m1.2.2.2.5" xref="A4.Ex9.m1.2.2.3.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="A4.Ex9.m1.2b"><interval closure="closed" id="A4.Ex9.m1.2.2.3.cmml" xref="A4.Ex9.m1.2.2.2"><apply id="A4.Ex9.m1.1.1.1.1.cmml" xref="A4.Ex9.m1.1.1.1.1"><csymbol cd="ambiguous" id="A4.Ex9.m1.1.1.1.1.1.cmml" xref="A4.Ex9.m1.1.1.1.1">subscript</csymbol><apply id="A4.Ex9.m1.1.1.1.1.2.cmml" xref="A4.Ex9.m1.1.1.1.1"><csymbol cd="ambiguous" id="A4.Ex9.m1.1.1.1.1.2.1.cmml" xref="A4.Ex9.m1.1.1.1.1">superscript</csymbol><ci id="A4.Ex9.m1.1.1.1.1.2.2.cmml" xref="A4.Ex9.m1.1.1.1.1.2.2">𝑟</ci><ci id="A4.Ex9.m1.1.1.1.1.2.3.cmml" xref="A4.Ex9.m1.1.1.1.1.2.3">′</ci></apply><apply id="A4.Ex9.m1.1.1.1.1.3.cmml" xref="A4.Ex9.m1.1.1.1.1.3"><plus id="A4.Ex9.m1.1.1.1.1.3.1.cmml" xref="A4.Ex9.m1.1.1.1.1.3.1"></plus><ci id="A4.Ex9.m1.1.1.1.1.3.2.cmml" xref="A4.Ex9.m1.1.1.1.1.3.2">𝑚</ci><cn type="integer" id="A4.Ex9.m1.1.1.1.1.3.3.cmml" xref="A4.Ex9.m1.1.1.1.1.3.3">1</cn></apply></apply><apply id="A4.Ex9.m1.2.2.2.2.cmml" xref="A4.Ex9.m1.2.2.2.2"><csymbol cd="ambiguous" id="A4.Ex9.m1.2.2.2.2.1.cmml" xref="A4.Ex9.m1.2.2.2.2">subscript</csymbol><ci id="A4.Ex9.m1.2.2.2.2.2.cmml" xref="A4.Ex9.m1.2.2.2.2.2">𝑡</ci><apply id="A4.Ex9.m1.2.2.2.2.3.cmml" xref="A4.Ex9.m1.2.2.2.2.3"><plus id="A4.Ex9.m1.2.2.2.2.3.1.cmml" xref="A4.Ex9.m1.2.2.2.2.3.1"></plus><ci id="A4.Ex9.m1.2.2.2.2.3.2.cmml" xref="A4.Ex9.m1.2.2.2.2.3.2">𝑚</ci><cn type="integer" id="A4.Ex9.m1.2.2.2.2.3.3.cmml" xref="A4.Ex9.m1.2.2.2.2.3.3">1</cn></apply></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="A4.Ex9.m1.2c">\displaystyle[r^{\prime}_{m+1},t_{m+1}]</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="A4.Ex9.m2.1" class="ltx_Math" alttext="\displaystyle=T_{m}([t^{\prime}_{m},t_{m}])" display="inline"><semantics id="A4.Ex9.m2.1a"><mrow id="A4.Ex9.m2.1.1" xref="A4.Ex9.m2.1.1.cmml"><mi id="A4.Ex9.m2.1.1.3" xref="A4.Ex9.m2.1.1.3.cmml"></mi><mo id="A4.Ex9.m2.1.1.2" xref="A4.Ex9.m2.1.1.2.cmml">=</mo><mrow id="A4.Ex9.m2.1.1.1" xref="A4.Ex9.m2.1.1.1.cmml"><msub id="A4.Ex9.m2.1.1.1.3" xref="A4.Ex9.m2.1.1.1.3.cmml"><mi id="A4.Ex9.m2.1.1.1.3.2" xref="A4.Ex9.m2.1.1.1.3.2.cmml">T</mi><mi id="A4.Ex9.m2.1.1.1.3.3" xref="A4.Ex9.m2.1.1.1.3.3.cmml">m</mi></msub><mo lspace="0em" rspace="0em" id="A4.Ex9.m2.1.1.1.2" xref="A4.Ex9.m2.1.1.1.2.cmml">​</mo><mrow id="A4.Ex9.m2.1.1.1.1.1" xref="A4.Ex9.m2.1.1.1.cmml"><mo stretchy="false" id="A4.Ex9.m2.1.1.1.1.1.2" xref="A4.Ex9.m2.1.1.1.cmml">(</mo><mrow id="A4.Ex9.m2.1.1.1.1.1.1.2" xref="A4.Ex9.m2.1.1.1.1.1.1.3.cmml"><mo stretchy="false" id="A4.Ex9.m2.1.1.1.1.1.1.2.3" xref="A4.Ex9.m2.1.1.1.1.1.1.3.cmml">[</mo><msubsup id="A4.Ex9.m2.1.1.1.1.1.1.1.1" xref="A4.Ex9.m2.1.1.1.1.1.1.1.1.cmml"><mi id="A4.Ex9.m2.1.1.1.1.1.1.1.1.2.2" xref="A4.Ex9.m2.1.1.1.1.1.1.1.1.2.2.cmml">t</mi><mi id="A4.Ex9.m2.1.1.1.1.1.1.1.1.3" xref="A4.Ex9.m2.1.1.1.1.1.1.1.1.3.cmml">m</mi><mo id="A4.Ex9.m2.1.1.1.1.1.1.1.1.2.3" xref="A4.Ex9.m2.1.1.1.1.1.1.1.1.2.3.cmml">′</mo></msubsup><mo id="A4.Ex9.m2.1.1.1.1.1.1.2.4" xref="A4.Ex9.m2.1.1.1.1.1.1.3.cmml">,</mo><msub id="A4.Ex9.m2.1.1.1.1.1.1.2.2" xref="A4.Ex9.m2.1.1.1.1.1.1.2.2.cmml"><mi id="A4.Ex9.m2.1.1.1.1.1.1.2.2.2" xref="A4.Ex9.m2.1.1.1.1.1.1.2.2.2.cmml">t</mi><mi id="A4.Ex9.m2.1.1.1.1.1.1.2.2.3" xref="A4.Ex9.m2.1.1.1.1.1.1.2.2.3.cmml">m</mi></msub><mo stretchy="false" id="A4.Ex9.m2.1.1.1.1.1.1.2.5" xref="A4.Ex9.m2.1.1.1.1.1.1.3.cmml">]</mo></mrow><mo stretchy="false" id="A4.Ex9.m2.1.1.1.1.1.3" xref="A4.Ex9.m2.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A4.Ex9.m2.1b"><apply id="A4.Ex9.m2.1.1.cmml" xref="A4.Ex9.m2.1.1"><eq id="A4.Ex9.m2.1.1.2.cmml" xref="A4.Ex9.m2.1.1.2"></eq><csymbol cd="latexml" id="A4.Ex9.m2.1.1.3.cmml" xref="A4.Ex9.m2.1.1.3">absent</csymbol><apply id="A4.Ex9.m2.1.1.1.cmml" xref="A4.Ex9.m2.1.1.1"><times id="A4.Ex9.m2.1.1.1.2.cmml" xref="A4.Ex9.m2.1.1.1.2"></times><apply id="A4.Ex9.m2.1.1.1.3.cmml" xref="A4.Ex9.m2.1.1.1.3"><csymbol cd="ambiguous" id="A4.Ex9.m2.1.1.1.3.1.cmml" xref="A4.Ex9.m2.1.1.1.3">subscript</csymbol><ci id="A4.Ex9.m2.1.1.1.3.2.cmml" xref="A4.Ex9.m2.1.1.1.3.2">𝑇</ci><ci id="A4.Ex9.m2.1.1.1.3.3.cmml" xref="A4.Ex9.m2.1.1.1.3.3">𝑚</ci></apply><interval closure="closed" id="A4.Ex9.m2.1.1.1.1.1.1.3.cmml" xref="A4.Ex9.m2.1.1.1.1.1.1.2"><apply id="A4.Ex9.m2.1.1.1.1.1.1.1.1.cmml" xref="A4.Ex9.m2.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A4.Ex9.m2.1.1.1.1.1.1.1.1.1.cmml" xref="A4.Ex9.m2.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="A4.Ex9.m2.1.1.1.1.1.1.1.1.2.cmml" xref="A4.Ex9.m2.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A4.Ex9.m2.1.1.1.1.1.1.1.1.2.1.cmml" xref="A4.Ex9.m2.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="A4.Ex9.m2.1.1.1.1.1.1.1.1.2.2.cmml" xref="A4.Ex9.m2.1.1.1.1.1.1.1.1.2.2">𝑡</ci><ci id="A4.Ex9.m2.1.1.1.1.1.1.1.1.2.3.cmml" xref="A4.Ex9.m2.1.1.1.1.1.1.1.1.2.3">′</ci></apply><ci id="A4.Ex9.m2.1.1.1.1.1.1.1.1.3.cmml" xref="A4.Ex9.m2.1.1.1.1.1.1.1.1.3">𝑚</ci></apply><apply id="A4.Ex9.m2.1.1.1.1.1.1.2.2.cmml" xref="A4.Ex9.m2.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="A4.Ex9.m2.1.1.1.1.1.1.2.2.1.cmml" xref="A4.Ex9.m2.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="A4.Ex9.m2.1.1.1.1.1.1.2.2.2.cmml" xref="A4.Ex9.m2.1.1.1.1.1.1.2.2.2">𝑡</ci><ci id="A4.Ex9.m2.1.1.1.1.1.1.2.2.3.cmml" xref="A4.Ex9.m2.1.1.1.1.1.1.2.2.3">𝑚</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.Ex9.m2.1c">\displaystyle=T_{m}([t^{\prime}_{m},t_{m}])</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A4.E3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="A4.E3.m1.2" class="ltx_Math" alttext="\displaystyle[r^{\prime}_{m+2},t_{m+2}]" display="inline"><semantics id="A4.E3.m1.2a"><mrow id="A4.E3.m1.2.2.2" xref="A4.E3.m1.2.2.3.cmml"><mo stretchy="false" id="A4.E3.m1.2.2.2.3" xref="A4.E3.m1.2.2.3.cmml">[</mo><msubsup id="A4.E3.m1.1.1.1.1" xref="A4.E3.m1.1.1.1.1.cmml"><mi id="A4.E3.m1.1.1.1.1.2.2" xref="A4.E3.m1.1.1.1.1.2.2.cmml">r</mi><mrow id="A4.E3.m1.1.1.1.1.3" xref="A4.E3.m1.1.1.1.1.3.cmml"><mi id="A4.E3.m1.1.1.1.1.3.2" xref="A4.E3.m1.1.1.1.1.3.2.cmml">m</mi><mo id="A4.E3.m1.1.1.1.1.3.1" xref="A4.E3.m1.1.1.1.1.3.1.cmml">+</mo><mn id="A4.E3.m1.1.1.1.1.3.3" xref="A4.E3.m1.1.1.1.1.3.3.cmml">2</mn></mrow><mo id="A4.E3.m1.1.1.1.1.2.3" xref="A4.E3.m1.1.1.1.1.2.3.cmml">′</mo></msubsup><mo id="A4.E3.m1.2.2.2.4" xref="A4.E3.m1.2.2.3.cmml">,</mo><msub id="A4.E3.m1.2.2.2.2" xref="A4.E3.m1.2.2.2.2.cmml"><mi id="A4.E3.m1.2.2.2.2.2" xref="A4.E3.m1.2.2.2.2.2.cmml">t</mi><mrow id="A4.E3.m1.2.2.2.2.3" xref="A4.E3.m1.2.2.2.2.3.cmml"><mi id="A4.E3.m1.2.2.2.2.3.2" xref="A4.E3.m1.2.2.2.2.3.2.cmml">m</mi><mo id="A4.E3.m1.2.2.2.2.3.1" xref="A4.E3.m1.2.2.2.2.3.1.cmml">+</mo><mn id="A4.E3.m1.2.2.2.2.3.3" xref="A4.E3.m1.2.2.2.2.3.3.cmml">2</mn></mrow></msub><mo stretchy="false" id="A4.E3.m1.2.2.2.5" xref="A4.E3.m1.2.2.3.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="A4.E3.m1.2b"><interval closure="closed" id="A4.E3.m1.2.2.3.cmml" xref="A4.E3.m1.2.2.2"><apply id="A4.E3.m1.1.1.1.1.cmml" xref="A4.E3.m1.1.1.1.1"><csymbol cd="ambiguous" id="A4.E3.m1.1.1.1.1.1.cmml" xref="A4.E3.m1.1.1.1.1">subscript</csymbol><apply id="A4.E3.m1.1.1.1.1.2.cmml" xref="A4.E3.m1.1.1.1.1"><csymbol cd="ambiguous" id="A4.E3.m1.1.1.1.1.2.1.cmml" xref="A4.E3.m1.1.1.1.1">superscript</csymbol><ci id="A4.E3.m1.1.1.1.1.2.2.cmml" xref="A4.E3.m1.1.1.1.1.2.2">𝑟</ci><ci id="A4.E3.m1.1.1.1.1.2.3.cmml" xref="A4.E3.m1.1.1.1.1.2.3">′</ci></apply><apply id="A4.E3.m1.1.1.1.1.3.cmml" xref="A4.E3.m1.1.1.1.1.3"><plus id="A4.E3.m1.1.1.1.1.3.1.cmml" xref="A4.E3.m1.1.1.1.1.3.1"></plus><ci id="A4.E3.m1.1.1.1.1.3.2.cmml" xref="A4.E3.m1.1.1.1.1.3.2">𝑚</ci><cn type="integer" id="A4.E3.m1.1.1.1.1.3.3.cmml" xref="A4.E3.m1.1.1.1.1.3.3">2</cn></apply></apply><apply id="A4.E3.m1.2.2.2.2.cmml" xref="A4.E3.m1.2.2.2.2"><csymbol cd="ambiguous" id="A4.E3.m1.2.2.2.2.1.cmml" xref="A4.E3.m1.2.2.2.2">subscript</csymbol><ci id="A4.E3.m1.2.2.2.2.2.cmml" xref="A4.E3.m1.2.2.2.2.2">𝑡</ci><apply id="A4.E3.m1.2.2.2.2.3.cmml" xref="A4.E3.m1.2.2.2.2.3"><plus id="A4.E3.m1.2.2.2.2.3.1.cmml" xref="A4.E3.m1.2.2.2.2.3.1"></plus><ci id="A4.E3.m1.2.2.2.2.3.2.cmml" xref="A4.E3.m1.2.2.2.2.3.2">𝑚</ci><cn type="integer" id="A4.E3.m1.2.2.2.2.3.3.cmml" xref="A4.E3.m1.2.2.2.2.3.3">2</cn></apply></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="A4.E3.m1.2c">\displaystyle[r^{\prime}_{m+2},t_{m+2}]</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="A4.E3.m2.1" class="ltx_Math" alttext="\displaystyle=T_{m+1}([t^{\prime}_{m+1},t_{m+1}])" display="inline"><semantics id="A4.E3.m2.1a"><mrow id="A4.E3.m2.1.1" xref="A4.E3.m2.1.1.cmml"><mi id="A4.E3.m2.1.1.3" xref="A4.E3.m2.1.1.3.cmml"></mi><mo id="A4.E3.m2.1.1.2" xref="A4.E3.m2.1.1.2.cmml">=</mo><mrow id="A4.E3.m2.1.1.1" xref="A4.E3.m2.1.1.1.cmml"><msub id="A4.E3.m2.1.1.1.3" xref="A4.E3.m2.1.1.1.3.cmml"><mi id="A4.E3.m2.1.1.1.3.2" xref="A4.E3.m2.1.1.1.3.2.cmml">T</mi><mrow id="A4.E3.m2.1.1.1.3.3" xref="A4.E3.m2.1.1.1.3.3.cmml"><mi id="A4.E3.m2.1.1.1.3.3.2" xref="A4.E3.m2.1.1.1.3.3.2.cmml">m</mi><mo id="A4.E3.m2.1.1.1.3.3.1" xref="A4.E3.m2.1.1.1.3.3.1.cmml">+</mo><mn id="A4.E3.m2.1.1.1.3.3.3" xref="A4.E3.m2.1.1.1.3.3.3.cmml">1</mn></mrow></msub><mo lspace="0em" rspace="0em" id="A4.E3.m2.1.1.1.2" xref="A4.E3.m2.1.1.1.2.cmml">​</mo><mrow id="A4.E3.m2.1.1.1.1.1" xref="A4.E3.m2.1.1.1.cmml"><mo stretchy="false" id="A4.E3.m2.1.1.1.1.1.2" xref="A4.E3.m2.1.1.1.cmml">(</mo><mrow id="A4.E3.m2.1.1.1.1.1.1.2" xref="A4.E3.m2.1.1.1.1.1.1.3.cmml"><mo stretchy="false" id="A4.E3.m2.1.1.1.1.1.1.2.3" xref="A4.E3.m2.1.1.1.1.1.1.3.cmml">[</mo><msubsup id="A4.E3.m2.1.1.1.1.1.1.1.1" xref="A4.E3.m2.1.1.1.1.1.1.1.1.cmml"><mi id="A4.E3.m2.1.1.1.1.1.1.1.1.2.2" xref="A4.E3.m2.1.1.1.1.1.1.1.1.2.2.cmml">t</mi><mrow id="A4.E3.m2.1.1.1.1.1.1.1.1.3" xref="A4.E3.m2.1.1.1.1.1.1.1.1.3.cmml"><mi id="A4.E3.m2.1.1.1.1.1.1.1.1.3.2" xref="A4.E3.m2.1.1.1.1.1.1.1.1.3.2.cmml">m</mi><mo id="A4.E3.m2.1.1.1.1.1.1.1.1.3.1" xref="A4.E3.m2.1.1.1.1.1.1.1.1.3.1.cmml">+</mo><mn id="A4.E3.m2.1.1.1.1.1.1.1.1.3.3" xref="A4.E3.m2.1.1.1.1.1.1.1.1.3.3.cmml">1</mn></mrow><mo id="A4.E3.m2.1.1.1.1.1.1.1.1.2.3" xref="A4.E3.m2.1.1.1.1.1.1.1.1.2.3.cmml">′</mo></msubsup><mo id="A4.E3.m2.1.1.1.1.1.1.2.4" xref="A4.E3.m2.1.1.1.1.1.1.3.cmml">,</mo><msub id="A4.E3.m2.1.1.1.1.1.1.2.2" xref="A4.E3.m2.1.1.1.1.1.1.2.2.cmml"><mi id="A4.E3.m2.1.1.1.1.1.1.2.2.2" xref="A4.E3.m2.1.1.1.1.1.1.2.2.2.cmml">t</mi><mrow id="A4.E3.m2.1.1.1.1.1.1.2.2.3" xref="A4.E3.m2.1.1.1.1.1.1.2.2.3.cmml"><mi id="A4.E3.m2.1.1.1.1.1.1.2.2.3.2" xref="A4.E3.m2.1.1.1.1.1.1.2.2.3.2.cmml">m</mi><mo id="A4.E3.m2.1.1.1.1.1.1.2.2.3.1" xref="A4.E3.m2.1.1.1.1.1.1.2.2.3.1.cmml">+</mo><mn id="A4.E3.m2.1.1.1.1.1.1.2.2.3.3" xref="A4.E3.m2.1.1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow></msub><mo stretchy="false" id="A4.E3.m2.1.1.1.1.1.1.2.5" xref="A4.E3.m2.1.1.1.1.1.1.3.cmml">]</mo></mrow><mo stretchy="false" id="A4.E3.m2.1.1.1.1.1.3" xref="A4.E3.m2.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A4.E3.m2.1b"><apply id="A4.E3.m2.1.1.cmml" xref="A4.E3.m2.1.1"><eq id="A4.E3.m2.1.1.2.cmml" xref="A4.E3.m2.1.1.2"></eq><csymbol cd="latexml" id="A4.E3.m2.1.1.3.cmml" xref="A4.E3.m2.1.1.3">absent</csymbol><apply id="A4.E3.m2.1.1.1.cmml" xref="A4.E3.m2.1.1.1"><times id="A4.E3.m2.1.1.1.2.cmml" xref="A4.E3.m2.1.1.1.2"></times><apply id="A4.E3.m2.1.1.1.3.cmml" xref="A4.E3.m2.1.1.1.3"><csymbol cd="ambiguous" id="A4.E3.m2.1.1.1.3.1.cmml" xref="A4.E3.m2.1.1.1.3">subscript</csymbol><ci id="A4.E3.m2.1.1.1.3.2.cmml" xref="A4.E3.m2.1.1.1.3.2">𝑇</ci><apply id="A4.E3.m2.1.1.1.3.3.cmml" xref="A4.E3.m2.1.1.1.3.3"><plus id="A4.E3.m2.1.1.1.3.3.1.cmml" xref="A4.E3.m2.1.1.1.3.3.1"></plus><ci id="A4.E3.m2.1.1.1.3.3.2.cmml" xref="A4.E3.m2.1.1.1.3.3.2">𝑚</ci><cn type="integer" id="A4.E3.m2.1.1.1.3.3.3.cmml" xref="A4.E3.m2.1.1.1.3.3.3">1</cn></apply></apply><interval closure="closed" id="A4.E3.m2.1.1.1.1.1.1.3.cmml" xref="A4.E3.m2.1.1.1.1.1.1.2"><apply id="A4.E3.m2.1.1.1.1.1.1.1.1.cmml" xref="A4.E3.m2.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A4.E3.m2.1.1.1.1.1.1.1.1.1.cmml" xref="A4.E3.m2.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="A4.E3.m2.1.1.1.1.1.1.1.1.2.cmml" xref="A4.E3.m2.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A4.E3.m2.1.1.1.1.1.1.1.1.2.1.cmml" xref="A4.E3.m2.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="A4.E3.m2.1.1.1.1.1.1.1.1.2.2.cmml" xref="A4.E3.m2.1.1.1.1.1.1.1.1.2.2">𝑡</ci><ci id="A4.E3.m2.1.1.1.1.1.1.1.1.2.3.cmml" xref="A4.E3.m2.1.1.1.1.1.1.1.1.2.3">′</ci></apply><apply id="A4.E3.m2.1.1.1.1.1.1.1.1.3.cmml" xref="A4.E3.m2.1.1.1.1.1.1.1.1.3"><plus id="A4.E3.m2.1.1.1.1.1.1.1.1.3.1.cmml" xref="A4.E3.m2.1.1.1.1.1.1.1.1.3.1"></plus><ci id="A4.E3.m2.1.1.1.1.1.1.1.1.3.2.cmml" xref="A4.E3.m2.1.1.1.1.1.1.1.1.3.2">𝑚</ci><cn type="integer" id="A4.E3.m2.1.1.1.1.1.1.1.1.3.3.cmml" xref="A4.E3.m2.1.1.1.1.1.1.1.1.3.3">1</cn></apply></apply><apply id="A4.E3.m2.1.1.1.1.1.1.2.2.cmml" xref="A4.E3.m2.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="A4.E3.m2.1.1.1.1.1.1.2.2.1.cmml" xref="A4.E3.m2.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="A4.E3.m2.1.1.1.1.1.1.2.2.2.cmml" xref="A4.E3.m2.1.1.1.1.1.1.2.2.2">𝑡</ci><apply id="A4.E3.m2.1.1.1.1.1.1.2.2.3.cmml" xref="A4.E3.m2.1.1.1.1.1.1.2.2.3"><plus id="A4.E3.m2.1.1.1.1.1.1.2.2.3.1.cmml" xref="A4.E3.m2.1.1.1.1.1.1.2.2.3.1"></plus><ci id="A4.E3.m2.1.1.1.1.1.1.2.2.3.2.cmml" xref="A4.E3.m2.1.1.1.1.1.1.2.2.3.2">𝑚</ci><cn type="integer" id="A4.E3.m2.1.1.1.1.1.1.2.2.3.3.cmml" xref="A4.E3.m2.1.1.1.1.1.1.2.2.3.3">1</cn></apply></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.E3.m2.1c">\displaystyle=T_{m+1}([t^{\prime}_{m+1},t_{m+1}])</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
<tbody id="A4.Ex10"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="A4.Ex10.m1.1" class="ltx_Math" alttext="\displaystyle\qquad\ldots" display="inline"><semantics id="A4.Ex10.m1.1a"><mi mathvariant="normal" id="A4.Ex10.m1.1.1" xref="A4.Ex10.m1.1.1.cmml">…</mi><annotation-xml encoding="MathML-Content" id="A4.Ex10.m1.1b"><ci id="A4.Ex10.m1.1.1.cmml" xref="A4.Ex10.m1.1.1">…</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.Ex10.m1.1c">\displaystyle\qquad\ldots</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright" colspan="2"></td>
</tr></tbody>
<tbody id="A4.Ex11"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="A4.Ex11.m1.1" class="ltx_Math" alttext="\displaystyle t_{M^{\prime}+1}" display="inline"><semantics id="A4.Ex11.m1.1a"><msub id="A4.Ex11.m1.1.1" xref="A4.Ex11.m1.1.1.cmml"><mi id="A4.Ex11.m1.1.1.2" xref="A4.Ex11.m1.1.1.2.cmml">t</mi><mrow id="A4.Ex11.m1.1.1.3" xref="A4.Ex11.m1.1.1.3.cmml"><msup id="A4.Ex11.m1.1.1.3.2" xref="A4.Ex11.m1.1.1.3.2.cmml"><mi id="A4.Ex11.m1.1.1.3.2.2" xref="A4.Ex11.m1.1.1.3.2.2.cmml">M</mi><mo id="A4.Ex11.m1.1.1.3.2.3" xref="A4.Ex11.m1.1.1.3.2.3.cmml">′</mo></msup><mo id="A4.Ex11.m1.1.1.3.1" xref="A4.Ex11.m1.1.1.3.1.cmml">+</mo><mn id="A4.Ex11.m1.1.1.3.3" xref="A4.Ex11.m1.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="A4.Ex11.m1.1b"><apply id="A4.Ex11.m1.1.1.cmml" xref="A4.Ex11.m1.1.1"><csymbol cd="ambiguous" id="A4.Ex11.m1.1.1.1.cmml" xref="A4.Ex11.m1.1.1">subscript</csymbol><ci id="A4.Ex11.m1.1.1.2.cmml" xref="A4.Ex11.m1.1.1.2">𝑡</ci><apply id="A4.Ex11.m1.1.1.3.cmml" xref="A4.Ex11.m1.1.1.3"><plus id="A4.Ex11.m1.1.1.3.1.cmml" xref="A4.Ex11.m1.1.1.3.1"></plus><apply id="A4.Ex11.m1.1.1.3.2.cmml" xref="A4.Ex11.m1.1.1.3.2"><csymbol cd="ambiguous" id="A4.Ex11.m1.1.1.3.2.1.cmml" xref="A4.Ex11.m1.1.1.3.2">superscript</csymbol><ci id="A4.Ex11.m1.1.1.3.2.2.cmml" xref="A4.Ex11.m1.1.1.3.2.2">𝑀</ci><ci id="A4.Ex11.m1.1.1.3.2.3.cmml" xref="A4.Ex11.m1.1.1.3.2.3">′</ci></apply><cn type="integer" id="A4.Ex11.m1.1.1.3.3.cmml" xref="A4.Ex11.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.Ex11.m1.1c">\displaystyle t_{M^{\prime}+1}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="A4.Ex11.m2.1" class="ltx_Math" alttext="\displaystyle=T_{M^{\prime}}(t_{M^{\prime}})," display="inline"><semantics id="A4.Ex11.m2.1a"><mrow id="A4.Ex11.m2.1.1.1" xref="A4.Ex11.m2.1.1.1.1.cmml"><mrow id="A4.Ex11.m2.1.1.1.1" xref="A4.Ex11.m2.1.1.1.1.cmml"><mi id="A4.Ex11.m2.1.1.1.1.3" xref="A4.Ex11.m2.1.1.1.1.3.cmml"></mi><mo id="A4.Ex11.m2.1.1.1.1.2" xref="A4.Ex11.m2.1.1.1.1.2.cmml">=</mo><mrow id="A4.Ex11.m2.1.1.1.1.1" xref="A4.Ex11.m2.1.1.1.1.1.cmml"><msub id="A4.Ex11.m2.1.1.1.1.1.3" xref="A4.Ex11.m2.1.1.1.1.1.3.cmml"><mi id="A4.Ex11.m2.1.1.1.1.1.3.2" xref="A4.Ex11.m2.1.1.1.1.1.3.2.cmml">T</mi><msup id="A4.Ex11.m2.1.1.1.1.1.3.3" xref="A4.Ex11.m2.1.1.1.1.1.3.3.cmml"><mi id="A4.Ex11.m2.1.1.1.1.1.3.3.2" xref="A4.Ex11.m2.1.1.1.1.1.3.3.2.cmml">M</mi><mo id="A4.Ex11.m2.1.1.1.1.1.3.3.3" xref="A4.Ex11.m2.1.1.1.1.1.3.3.3.cmml">′</mo></msup></msub><mo lspace="0em" rspace="0em" id="A4.Ex11.m2.1.1.1.1.1.2" xref="A4.Ex11.m2.1.1.1.1.1.2.cmml">​</mo><mrow id="A4.Ex11.m2.1.1.1.1.1.1.1" xref="A4.Ex11.m2.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="A4.Ex11.m2.1.1.1.1.1.1.1.2" xref="A4.Ex11.m2.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="A4.Ex11.m2.1.1.1.1.1.1.1.1" xref="A4.Ex11.m2.1.1.1.1.1.1.1.1.cmml"><mi id="A4.Ex11.m2.1.1.1.1.1.1.1.1.2" xref="A4.Ex11.m2.1.1.1.1.1.1.1.1.2.cmml">t</mi><msup id="A4.Ex11.m2.1.1.1.1.1.1.1.1.3" xref="A4.Ex11.m2.1.1.1.1.1.1.1.1.3.cmml"><mi id="A4.Ex11.m2.1.1.1.1.1.1.1.1.3.2" xref="A4.Ex11.m2.1.1.1.1.1.1.1.1.3.2.cmml">M</mi><mo id="A4.Ex11.m2.1.1.1.1.1.1.1.1.3.3" xref="A4.Ex11.m2.1.1.1.1.1.1.1.1.3.3.cmml">′</mo></msup></msub><mo stretchy="false" id="A4.Ex11.m2.1.1.1.1.1.1.1.3" xref="A4.Ex11.m2.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="A4.Ex11.m2.1.1.1.2" xref="A4.Ex11.m2.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A4.Ex11.m2.1b"><apply id="A4.Ex11.m2.1.1.1.1.cmml" xref="A4.Ex11.m2.1.1.1"><eq id="A4.Ex11.m2.1.1.1.1.2.cmml" xref="A4.Ex11.m2.1.1.1.1.2"></eq><csymbol cd="latexml" id="A4.Ex11.m2.1.1.1.1.3.cmml" xref="A4.Ex11.m2.1.1.1.1.3">absent</csymbol><apply id="A4.Ex11.m2.1.1.1.1.1.cmml" xref="A4.Ex11.m2.1.1.1.1.1"><times id="A4.Ex11.m2.1.1.1.1.1.2.cmml" xref="A4.Ex11.m2.1.1.1.1.1.2"></times><apply id="A4.Ex11.m2.1.1.1.1.1.3.cmml" xref="A4.Ex11.m2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A4.Ex11.m2.1.1.1.1.1.3.1.cmml" xref="A4.Ex11.m2.1.1.1.1.1.3">subscript</csymbol><ci id="A4.Ex11.m2.1.1.1.1.1.3.2.cmml" xref="A4.Ex11.m2.1.1.1.1.1.3.2">𝑇</ci><apply id="A4.Ex11.m2.1.1.1.1.1.3.3.cmml" xref="A4.Ex11.m2.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="A4.Ex11.m2.1.1.1.1.1.3.3.1.cmml" xref="A4.Ex11.m2.1.1.1.1.1.3.3">superscript</csymbol><ci id="A4.Ex11.m2.1.1.1.1.1.3.3.2.cmml" xref="A4.Ex11.m2.1.1.1.1.1.3.3.2">𝑀</ci><ci id="A4.Ex11.m2.1.1.1.1.1.3.3.3.cmml" xref="A4.Ex11.m2.1.1.1.1.1.3.3.3">′</ci></apply></apply><apply id="A4.Ex11.m2.1.1.1.1.1.1.1.1.cmml" xref="A4.Ex11.m2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A4.Ex11.m2.1.1.1.1.1.1.1.1.1.cmml" xref="A4.Ex11.m2.1.1.1.1.1.1.1">subscript</csymbol><ci id="A4.Ex11.m2.1.1.1.1.1.1.1.1.2.cmml" xref="A4.Ex11.m2.1.1.1.1.1.1.1.1.2">𝑡</ci><apply id="A4.Ex11.m2.1.1.1.1.1.1.1.1.3.cmml" xref="A4.Ex11.m2.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A4.Ex11.m2.1.1.1.1.1.1.1.1.3.1.cmml" xref="A4.Ex11.m2.1.1.1.1.1.1.1.1.3">superscript</csymbol><ci id="A4.Ex11.m2.1.1.1.1.1.1.1.1.3.2.cmml" xref="A4.Ex11.m2.1.1.1.1.1.1.1.1.3.2">𝑀</ci><ci id="A4.Ex11.m2.1.1.1.1.1.1.1.1.3.3.cmml" xref="A4.Ex11.m2.1.1.1.1.1.1.1.1.3.3">′</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.Ex11.m2.1c">\displaystyle=T_{M^{\prime}}(t_{M^{\prime}}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="A4.SS0.SSS0.Px2.p1.17" class="ltx_p">where the operator <math id="A4.SS0.SSS0.Px2.p1.17.m1.2" class="ltx_Math" alttext="[\cdot,\cdot]" display="inline"><semantics id="A4.SS0.SSS0.Px2.p1.17.m1.2a"><mrow id="A4.SS0.SSS0.Px2.p1.17.m1.2.3.2" xref="A4.SS0.SSS0.Px2.p1.17.m1.2.3.1.cmml"><mo stretchy="false" id="A4.SS0.SSS0.Px2.p1.17.m1.2.3.2.1" xref="A4.SS0.SSS0.Px2.p1.17.m1.2.3.1.cmml">[</mo><mo lspace="0em" rspace="0em" id="A4.SS0.SSS0.Px2.p1.17.m1.1.1" xref="A4.SS0.SSS0.Px2.p1.17.m1.1.1.cmml">⋅</mo><mo rspace="0em" id="A4.SS0.SSS0.Px2.p1.17.m1.2.3.2.2" xref="A4.SS0.SSS0.Px2.p1.17.m1.2.3.1.cmml">,</mo><mo lspace="0em" rspace="0em" id="A4.SS0.SSS0.Px2.p1.17.m1.2.2" xref="A4.SS0.SSS0.Px2.p1.17.m1.2.2.cmml">⋅</mo><mo stretchy="false" id="A4.SS0.SSS0.Px2.p1.17.m1.2.3.2.3" xref="A4.SS0.SSS0.Px2.p1.17.m1.2.3.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="A4.SS0.SSS0.Px2.p1.17.m1.2b"><interval closure="closed" id="A4.SS0.SSS0.Px2.p1.17.m1.2.3.1.cmml" xref="A4.SS0.SSS0.Px2.p1.17.m1.2.3.2"><ci id="A4.SS0.SSS0.Px2.p1.17.m1.1.1.cmml" xref="A4.SS0.SSS0.Px2.p1.17.m1.1.1">⋅</ci><ci id="A4.SS0.SSS0.Px2.p1.17.m1.2.2.cmml" xref="A4.SS0.SSS0.Px2.p1.17.m1.2.2">⋅</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="A4.SS0.SSS0.Px2.p1.17.m1.2c">[\cdot,\cdot]</annotation></semantics></math> represents the concatenation along the channel.</p>
</div>
<figure id="A4.F7" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="A4.F7.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2310.18961/assets/x16.png" id="A4.F7.sf1.g1" class="ltx_graphics ltx_img_landscape" width="207" height="71" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="A4.F7.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2310.18961/assets/x17.png" id="A4.F7.sf2.g1" class="ltx_graphics ltx_img_landscape" width="207" height="71" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="A4.F7.sf3" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2310.18961/assets/x18.png" id="A4.F7.sf3.g1" class="ltx_graphics ltx_img_landscape" width="207" height="69" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(c) </span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="A4.F7.sf4" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2310.18961/assets/x19.png" id="A4.F7.sf4.g1" class="ltx_graphics ltx_img_landscape" width="207" height="72" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(d) </span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 7: </span>Hyparameter analysis. (a)<math id="A4.F7.5.m1.1" class="ltx_Math" alttext="E" display="inline"><semantics id="A4.F7.5.m1.1b"><mi id="A4.F7.5.m1.1.1" xref="A4.F7.5.m1.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="A4.F7.5.m1.1c"><ci id="A4.F7.5.m1.1.1.cmml" xref="A4.F7.5.m1.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.F7.5.m1.1d">E</annotation></semantics></math> ablation. (b)
<math id="A4.F7.6.m2.1" class="ltx_Math" alttext="M" display="inline"><semantics id="A4.F7.6.m2.1b"><mi id="A4.F7.6.m2.1.1" xref="A4.F7.6.m2.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="A4.F7.6.m2.1c"><ci id="A4.F7.6.m2.1.1.cmml" xref="A4.F7.6.m2.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.F7.6.m2.1d">M</annotation></semantics></math> ablation. (c)<math id="A4.F7.7.m3.1" class="ltx_Math" alttext="L" display="inline"><semantics id="A4.F7.7.m3.1b"><mi id="A4.F7.7.m3.1.1" xref="A4.F7.7.m3.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="A4.F7.7.m3.1c"><ci id="A4.F7.7.m3.1.1.cmml" xref="A4.F7.7.m3.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.F7.7.m3.1d">L</annotation></semantics></math> ablation (d)<math id="A4.F7.8.m4.1" class="ltx_Math" alttext="N" display="inline"><semantics id="A4.F7.8.m4.1b"><mi id="A4.F7.8.m4.1.1" xref="A4.F7.8.m4.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="A4.F7.8.m4.1c"><ci id="A4.F7.8.m4.1.1.cmml" xref="A4.F7.8.m4.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.F7.8.m4.1d">N</annotation></semantics></math> ablation. Pixel/image-level (AUPRO, AP) performances are shown on the left and right sides of each subplot, respectively.</figcaption>
</figure>
</section>
<section id="A4.SS0.SSS0.Px3" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Hyparameter analysis</h5>

<div id="A4.SS0.SSS0.Px3.p1" class="ltx_para ltx_noindent">
<p id="A4.SS0.SSS0.Px3.p1.9" class="ltx_p">We study the length of learnable text prompts <math id="A4.SS0.SSS0.Px3.p1.1.m1.1" class="ltx_Math" alttext="E" display="inline"><semantics id="A4.SS0.SSS0.Px3.p1.1.m1.1a"><mi id="A4.SS0.SSS0.Px3.p1.1.m1.1.1" xref="A4.SS0.SSS0.Px3.p1.1.m1.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="A4.SS0.SSS0.Px3.p1.1.m1.1b"><ci id="A4.SS0.SSS0.Px3.p1.1.m1.1.1.cmml" xref="A4.SS0.SSS0.Px3.p1.1.m1.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.SS0.SSS0.Px3.p1.1.m1.1c">E</annotation></semantics></math>, depth of learnable token embeddings <math id="A4.SS0.SSS0.Px3.p1.2.m2.1" class="ltx_Math" alttext="M" display="inline"><semantics id="A4.SS0.SSS0.Px3.p1.2.m2.1a"><mi id="A4.SS0.SSS0.Px3.p1.2.m2.1.1" xref="A4.SS0.SSS0.Px3.p1.2.m2.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="A4.SS0.SSS0.Px3.p1.2.m2.1b"><ci id="A4.SS0.SSS0.Px3.p1.2.m2.1.1.cmml" xref="A4.SS0.SSS0.Px3.p1.2.m2.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.SS0.SSS0.Px3.p1.2.m2.1c">M</annotation></semantics></math>, length of learnable token embeddings <math id="A4.SS0.SSS0.Px3.p1.3.m3.1" class="ltx_Math" alttext="M" display="inline"><semantics id="A4.SS0.SSS0.Px3.p1.3.m3.1a"><mi id="A4.SS0.SSS0.Px3.p1.3.m3.1.1" xref="A4.SS0.SSS0.Px3.p1.3.m3.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="A4.SS0.SSS0.Px3.p1.3.m3.1b"><ci id="A4.SS0.SSS0.Px3.p1.3.m3.1.1.cmml" xref="A4.SS0.SSS0.Px3.p1.3.m3.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.SS0.SSS0.Px3.p1.3.m3.1c">M</annotation></semantics></math>, and number of used layers in visual encoder <math id="A4.SS0.SSS0.Px3.p1.4.m4.1" class="ltx_Math" alttext="N" display="inline"><semantics id="A4.SS0.SSS0.Px3.p1.4.m4.1a"><mi id="A4.SS0.SSS0.Px3.p1.4.m4.1.1" xref="A4.SS0.SSS0.Px3.p1.4.m4.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="A4.SS0.SSS0.Px3.p1.4.m4.1b"><ci id="A4.SS0.SSS0.Px3.p1.4.m4.1.1.cmml" xref="A4.SS0.SSS0.Px3.p1.4.m4.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.SS0.SSS0.Px3.p1.4.m4.1c">N</annotation></semantics></math>. As shown in Fig. <a href="#A4.F7.sf2" title="In Figure 7 ‣ Refinement of the textual space ‣ Appendix D Additional results and ablations ‣ AnomalyCLIP: Object-agnostic Prompt Learning for Zero-shot Anomaly Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7b</span></a>, we observe that the detection and segmentation performance initially improves with an increase in the value of <math id="A4.SS0.SSS0.Px3.p1.5.m5.1" class="ltx_Math" alttext="E" display="inline"><semantics id="A4.SS0.SSS0.Px3.p1.5.m5.1a"><mi id="A4.SS0.SSS0.Px3.p1.5.m5.1.1" xref="A4.SS0.SSS0.Px3.p1.5.m5.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="A4.SS0.SSS0.Px3.p1.5.m5.1b"><ci id="A4.SS0.SSS0.Px3.p1.5.m5.1.1.cmml" xref="A4.SS0.SSS0.Px3.p1.5.m5.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.SS0.SSS0.Px3.p1.5.m5.1c">E</annotation></semantics></math>. However, within the range of lengths from 12 to 16, we notice a decline in performance, which suggests that excessively long learnable text prompts could involve redundant information. Therefore, an appropriate value for <math id="A4.SS0.SSS0.Px3.p1.6.m6.1" class="ltx_Math" alttext="E" display="inline"><semantics id="A4.SS0.SSS0.Px3.p1.6.m6.1a"><mi id="A4.SS0.SSS0.Px3.p1.6.m6.1.1" xref="A4.SS0.SSS0.Px3.p1.6.m6.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="A4.SS0.SSS0.Px3.p1.6.m6.1b"><ci id="A4.SS0.SSS0.Px3.p1.6.m6.1.1.cmml" xref="A4.SS0.SSS0.Px3.p1.6.m6.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.SS0.SSS0.Px3.p1.6.m6.1c">E</annotation></semantics></math>, such as <math id="A4.SS0.SSS0.Px3.p1.7.m7.1" class="ltx_Math" alttext="E=12" display="inline"><semantics id="A4.SS0.SSS0.Px3.p1.7.m7.1a"><mrow id="A4.SS0.SSS0.Px3.p1.7.m7.1.1" xref="A4.SS0.SSS0.Px3.p1.7.m7.1.1.cmml"><mi id="A4.SS0.SSS0.Px3.p1.7.m7.1.1.2" xref="A4.SS0.SSS0.Px3.p1.7.m7.1.1.2.cmml">E</mi><mo id="A4.SS0.SSS0.Px3.p1.7.m7.1.1.1" xref="A4.SS0.SSS0.Px3.p1.7.m7.1.1.1.cmml">=</mo><mn id="A4.SS0.SSS0.Px3.p1.7.m7.1.1.3" xref="A4.SS0.SSS0.Px3.p1.7.m7.1.1.3.cmml">12</mn></mrow><annotation-xml encoding="MathML-Content" id="A4.SS0.SSS0.Px3.p1.7.m7.1b"><apply id="A4.SS0.SSS0.Px3.p1.7.m7.1.1.cmml" xref="A4.SS0.SSS0.Px3.p1.7.m7.1.1"><eq id="A4.SS0.SSS0.Px3.p1.7.m7.1.1.1.cmml" xref="A4.SS0.SSS0.Px3.p1.7.m7.1.1.1"></eq><ci id="A4.SS0.SSS0.Px3.p1.7.m7.1.1.2.cmml" xref="A4.SS0.SSS0.Px3.p1.7.m7.1.1.2">𝐸</ci><cn type="integer" id="A4.SS0.SSS0.Px3.p1.7.m7.1.1.3.cmml" xref="A4.SS0.SSS0.Px3.p1.7.m7.1.1.3">12</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS0.SSS0.Px3.p1.7.m7.1c">E=12</annotation></semantics></math>, is beneficial to accurate learning of object-agnostic text prompts. Besides, we also investigate the depth of the attached learnable token embeddings in Fig. <a href="#A4.F7.sf2" title="In Figure 7 ‣ Refinement of the textual space ‣ Appendix D Additional results and ablations ‣ AnomalyCLIP: Object-agnostic Prompt Learning for Zero-shot Anomaly Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7b</span></a>. The degree of refining of the initial text space becomes more pronounced as the depth increases, enabling more discriminative textual embeddings for normal and anomaly. However, the performance drops when the refinement is excessive and impairs the generalization of AnomlayCLIP, as seen in the case when <math id="A4.SS0.SSS0.Px3.p1.8.m8.1" class="ltx_Math" alttext="M" display="inline"><semantics id="A4.SS0.SSS0.Px3.p1.8.m8.1a"><mi id="A4.SS0.SSS0.Px3.p1.8.m8.1.1" xref="A4.SS0.SSS0.Px3.p1.8.m8.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="A4.SS0.SSS0.Px3.p1.8.m8.1b"><ci id="A4.SS0.SSS0.Px3.p1.8.m8.1.1.cmml" xref="A4.SS0.SSS0.Px3.p1.8.m8.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.SS0.SSS0.Px3.p1.8.m8.1c">M</annotation></semantics></math> equals 9. After selecting the depth, we proceed to investigate the influence of the length of learnable token embeddings. As illustrated in Fig. <a href="#A4.F7.sf3" title="In Figure 7 ‣ Refinement of the textual space ‣ Appendix D Additional results and ablations ‣ AnomalyCLIP: Object-agnostic Prompt Learning for Zero-shot Anomaly Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7c</span></a>, we find that the length of token embeddings also involves a similar tradeoff between the model generalization and calibration of textual space in Fig. <a href="#A4.F7.sf4" title="In Figure 7 ‣ Refinement of the textual space ‣ Appendix D Additional results and ablations ‣ AnomalyCLIP: Object-agnostic Prompt Learning for Zero-shot Anomaly Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7d</span></a>. AnomalyCLIP achieves the overall performance gain when we provide the most local visual semantics (<math id="A4.SS0.SSS0.Px3.p1.9.m9.1" class="ltx_Math" alttext="N=4" display="inline"><semantics id="A4.SS0.SSS0.Px3.p1.9.m9.1a"><mrow id="A4.SS0.SSS0.Px3.p1.9.m9.1.1" xref="A4.SS0.SSS0.Px3.p1.9.m9.1.1.cmml"><mi id="A4.SS0.SSS0.Px3.p1.9.m9.1.1.2" xref="A4.SS0.SSS0.Px3.p1.9.m9.1.1.2.cmml">N</mi><mo id="A4.SS0.SSS0.Px3.p1.9.m9.1.1.1" xref="A4.SS0.SSS0.Px3.p1.9.m9.1.1.1.cmml">=</mo><mn id="A4.SS0.SSS0.Px3.p1.9.m9.1.1.3" xref="A4.SS0.SSS0.Px3.p1.9.m9.1.1.3.cmml">4</mn></mrow><annotation-xml encoding="MathML-Content" id="A4.SS0.SSS0.Px3.p1.9.m9.1b"><apply id="A4.SS0.SSS0.Px3.p1.9.m9.1.1.cmml" xref="A4.SS0.SSS0.Px3.p1.9.m9.1.1"><eq id="A4.SS0.SSS0.Px3.p1.9.m9.1.1.1.cmml" xref="A4.SS0.SSS0.Px3.p1.9.m9.1.1.1"></eq><ci id="A4.SS0.SSS0.Px3.p1.9.m9.1.1.2.cmml" xref="A4.SS0.SSS0.Px3.p1.9.m9.1.1.2">𝑁</ci><cn type="integer" id="A4.SS0.SSS0.Px3.p1.9.m9.1.1.3.cmml" xref="A4.SS0.SSS0.Px3.p1.9.m9.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS0.SSS0.Px3.p1.9.m9.1c">N=4</annotation></semantics></math>).</p>
</div>
</section>
<section id="A4.SS0.SSS0.Px4" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Prompt template ablation</h5>

<div id="A4.SS0.SSS0.Px4.p1" class="ltx_para ltx_noindent">
<p id="A4.SS0.SSS0.Px4.p1.1" class="ltx_p">Here, we study the robustness of AnomalyCLIP to prior anomaly semantics in the object-agnostic text prompt template. We replace <code id="A4.SS0.SSS0.Px4.p1.1.1" class="ltx_verbatim ltx_font_typewriter">damaged</code> in the object-agnostic text prompt with other words having similar anomaly semantics, such as <code id="A4.SS0.SSS0.Px4.p1.1.2" class="ltx_verbatim ltx_font_typewriter">anomalous</code>, <code id="A4.SS0.SSS0.Px4.p1.1.3" class="ltx_verbatim ltx_font_typewriter">flawed</code>, <code id="A4.SS0.SSS0.Px4.p1.1.4" class="ltx_verbatim ltx_font_typewriter">defective</code>, <code id="A4.SS0.SSS0.Px4.p1.1.5" class="ltx_verbatim ltx_font_typewriter">blemished</code>. The results are presented in Table <a href="#A4.T5" title="Table 5 ‣ Prompt template ablation ‣ Appendix D Additional results and ablations ‣ AnomalyCLIP: Object-agnostic Prompt Learning for Zero-shot Anomaly Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> and Table <a href="#A4.T6" title="Table 6 ‣ Object ablation ‣ Appendix D Additional results and ablations ‣ AnomalyCLIP: Object-agnostic Prompt Learning for Zero-shot Anomaly Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>. The steady results indicate that AnomalyCLIP is not sensitive to the prior anomaly semantics introduced by the object-agnostic text prompt template.</p>
</div>
<figure id="A4.T5" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 5: </span>Ablation on the robustness of the abnormality-related token in our prompt template on industrial defect datasets.</figcaption>
<table id="A4.T5.1" class="ltx_tabular ltx_centering ltx_align_middle">
<tr id="A4.T5.1.1" class="ltx_tr">
<td id="A4.T5.1.1.1" class="ltx_td ltx_align_center ltx_border_tt">Task</td>
<td id="A4.T5.1.1.2" class="ltx_td ltx_align_center ltx_border_tt">Category</td>
<td id="A4.T5.1.1.3" class="ltx_td ltx_align_center ltx_border_tt">Datasets</td>
<td id="A4.T5.1.1.4" class="ltx_td ltx_align_center ltx_border_tt">damaged</td>
<td id="A4.T5.1.1.5" class="ltx_td ltx_align_center ltx_border_tt">anomalous</td>
<td id="A4.T5.1.1.6" class="ltx_td ltx_align_center ltx_border_tt">flawed</td>
<td id="A4.T5.1.1.7" class="ltx_td ltx_align_center ltx_border_tt">defective</td>
<td id="A4.T5.1.1.8" class="ltx_td ltx_align_center ltx_border_tt">blemished</td>
</tr>
<tr id="A4.T5.1.2" class="ltx_tr">
<td id="A4.T5.1.2.1" class="ltx_td ltx_align_center ltx_border_t" rowspan="7"><span id="A4.T5.1.2.1.1" class="ltx_text"><span id="A4.T5.1.2.1.1.1" class="ltx_text"></span> <span id="A4.T5.1.2.1.1.2" class="ltx_text">
<span id="A4.T5.1.2.1.1.2.1" class="ltx_tabular ltx_align_middle">
<span id="A4.T5.1.2.1.1.2.1.1" class="ltx_tr">
<span id="A4.T5.1.2.1.1.2.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">Image-level</span></span>
<span id="A4.T5.1.2.1.1.2.1.2" class="ltx_tr">
<span id="A4.T5.1.2.1.1.2.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center">(AUROC, AP)</span></span>
</span></span> <span id="A4.T5.1.2.1.1.3" class="ltx_text"></span></span></td>
<td id="A4.T5.1.2.2" class="ltx_td ltx_align_center ltx_border_t">
<span id="A4.T5.1.2.2.1" class="ltx_text"></span> <span id="A4.T5.1.2.2.2" class="ltx_text">
<span id="A4.T5.1.2.2.2.1" class="ltx_tabular ltx_align_middle">
<span id="A4.T5.1.2.2.2.1.1" class="ltx_tr">
<span id="A4.T5.1.2.2.2.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">Obj &amp;texture</span></span>
</span></span><span id="A4.T5.1.2.2.3" class="ltx_text"></span></td>
<td id="A4.T5.1.2.3" class="ltx_td ltx_align_center ltx_border_t">MVTec AD</td>
<td id="A4.T5.1.2.4" class="ltx_td ltx_align_center ltx_border_t">(91.5, 96.2)</td>
<td id="A4.T5.1.2.5" class="ltx_td ltx_align_center ltx_border_t">(91.4, 96.2)</td>
<td id="A4.T5.1.2.6" class="ltx_td ltx_align_center ltx_border_t">(91.3, 96.2)</td>
<td id="A4.T5.1.2.7" class="ltx_td ltx_align_center ltx_border_t">(91.4, 96.2)</td>
<td id="A4.T5.1.2.8" class="ltx_td ltx_align_center ltx_border_t">(91.5, 96.2)</td>
</tr>
<tr id="A4.T5.1.3" class="ltx_tr">
<td id="A4.T5.1.3.1" class="ltx_td ltx_align_center" rowspan="4"><span id="A4.T5.1.3.1.1" class="ltx_text">Obj</span></td>
<td id="A4.T5.1.3.2" class="ltx_td ltx_align_center">VisA</td>
<td id="A4.T5.1.3.3" class="ltx_td ltx_align_center">(82.1, 85.4)</td>
<td id="A4.T5.1.3.4" class="ltx_td ltx_align_center">(80.7, 84.5)</td>
<td id="A4.T5.1.3.5" class="ltx_td ltx_align_center">(80.7, 84.5)</td>
<td id="A4.T5.1.3.6" class="ltx_td ltx_align_center">(80.9, 84.6)</td>
<td id="A4.T5.1.3.7" class="ltx_td ltx_align_center">(80.7, 84.5)</td>
</tr>
<tr id="A4.T5.1.4" class="ltx_tr">
<td id="A4.T5.1.4.1" class="ltx_td ltx_align_center">MPDD</td>
<td id="A4.T5.1.4.2" class="ltx_td ltx_align_center">(77.0, 82.0)</td>
<td id="A4.T5.1.4.3" class="ltx_td ltx_align_center">(78.0, 83.9)</td>
<td id="A4.T5.1.4.4" class="ltx_td ltx_align_center">(77.9, 83.6)</td>
<td id="A4.T5.1.4.5" class="ltx_td ltx_align_center">(77.8, 83.5)</td>
<td id="A4.T5.1.4.6" class="ltx_td ltx_align_center">(78.6. 84.1)</td>
</tr>
<tr id="A4.T5.1.5" class="ltx_tr">
<td id="A4.T5.1.5.1" class="ltx_td ltx_align_center">BTAD</td>
<td id="A4.T5.1.5.2" class="ltx_td ltx_align_center">(88.3, 87.3)</td>
<td id="A4.T5.1.5.3" class="ltx_td ltx_align_center">(84.8, 86.7)</td>
<td id="A4.T5.1.5.4" class="ltx_td ltx_align_center">(85.2, 87.4)</td>
<td id="A4.T5.1.5.5" class="ltx_td ltx_align_center">(84.8, 86.2)</td>
<td id="A4.T5.1.5.6" class="ltx_td ltx_align_center">(85.9, 67.1)</td>
</tr>
<tr id="A4.T5.1.6" class="ltx_tr">
<td id="A4.T5.1.6.1" class="ltx_td ltx_align_center">SDD</td>
<td id="A4.T5.1.6.2" class="ltx_td ltx_align_center">(84.7, 80.0)</td>
<td id="A4.T5.1.6.3" class="ltx_td ltx_align_center">(82.3, 76.3)</td>
<td id="A4.T5.1.6.4" class="ltx_td ltx_align_center">(82.6, 76.8)</td>
<td id="A4.T5.1.6.5" class="ltx_td ltx_align_center">(82.8, 77.2)</td>
<td id="A4.T5.1.6.6" class="ltx_td ltx_align_center">(82.7, 77.0)</td>
</tr>
<tr id="A4.T5.1.7" class="ltx_tr">
<td id="A4.T5.1.7.1" class="ltx_td ltx_align_center" rowspan="2"><span id="A4.T5.1.7.1.1" class="ltx_text">Texture</span></td>
<td id="A4.T5.1.7.2" class="ltx_td ltx_align_center">DAGM</td>
<td id="A4.T5.1.7.3" class="ltx_td ltx_align_center">(97.5, 92.3)</td>
<td id="A4.T5.1.7.4" class="ltx_td ltx_align_center">(97.7, 92.6)</td>
<td id="A4.T5.1.7.5" class="ltx_td ltx_align_center">(97.5, 92.4)</td>
<td id="A4.T5.1.7.6" class="ltx_td ltx_align_center">(97.5, 92.3)</td>
<td id="A4.T5.1.7.7" class="ltx_td ltx_align_center">(97.5, 92.4)</td>
</tr>
<tr id="A4.T5.1.8" class="ltx_tr">
<td id="A4.T5.1.8.1" class="ltx_td ltx_align_center">DTD-Synthetic</td>
<td id="A4.T5.1.8.2" class="ltx_td ltx_align_center">(93.5, 97.0)</td>
<td id="A4.T5.1.8.3" class="ltx_td ltx_align_center">(93.3, 96.9)</td>
<td id="A4.T5.1.8.4" class="ltx_td ltx_align_center">(93.2, 96.9)</td>
<td id="A4.T5.1.8.5" class="ltx_td ltx_align_center">(93.4, 97.0)</td>
<td id="A4.T5.1.8.6" class="ltx_td ltx_align_center">(93.5, 97.0)</td>
</tr>
<tr id="A4.T5.1.9" class="ltx_tr">
<td id="A4.T5.1.9.1" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" rowspan="7"><span id="A4.T5.1.9.1.1" class="ltx_text"><span id="A4.T5.1.9.1.1.1" class="ltx_text"></span> <span id="A4.T5.1.9.1.1.2" class="ltx_text">
<span id="A4.T5.1.9.1.1.2.1" class="ltx_tabular ltx_align_middle">
<span id="A4.T5.1.9.1.1.2.1.1" class="ltx_tr">
<span id="A4.T5.1.9.1.1.2.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">Pixel-level</span></span>
<span id="A4.T5.1.9.1.1.2.1.2" class="ltx_tr">
<span id="A4.T5.1.9.1.1.2.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center">(AUROC, PRO)</span></span>
</span></span> <span id="A4.T5.1.9.1.1.3" class="ltx_text"></span></span></td>
<td id="A4.T5.1.9.2" class="ltx_td ltx_align_center ltx_border_t">
<span id="A4.T5.1.9.2.1" class="ltx_text"></span> <span id="A4.T5.1.9.2.2" class="ltx_text">
<span id="A4.T5.1.9.2.2.1" class="ltx_tabular ltx_align_middle">
<span id="A4.T5.1.9.2.2.1.1" class="ltx_tr">
<span id="A4.T5.1.9.2.2.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">Obj &amp;texture</span></span>
</span></span><span id="A4.T5.1.9.2.3" class="ltx_text"></span></td>
<td id="A4.T5.1.9.3" class="ltx_td ltx_align_center ltx_border_t">MVTec AD</td>
<td id="A4.T5.1.9.4" class="ltx_td ltx_align_center ltx_border_t">(91.1, 81.4)</td>
<td id="A4.T5.1.9.5" class="ltx_td ltx_align_center ltx_border_t">(91.0, 81.4)</td>
<td id="A4.T5.1.9.6" class="ltx_td ltx_align_center ltx_border_t">(90.7, 81.4)</td>
<td id="A4.T5.1.9.7" class="ltx_td ltx_align_center ltx_border_t">(91.0, 81.7)</td>
<td id="A4.T5.1.9.8" class="ltx_td ltx_align_center ltx_border_t">(90.9, 81.2)</td>
</tr>
<tr id="A4.T5.1.10" class="ltx_tr">
<td id="A4.T5.1.10.1" class="ltx_td ltx_align_center" rowspan="4"><span id="A4.T5.1.10.1.1" class="ltx_text">Obj</span></td>
<td id="A4.T5.1.10.2" class="ltx_td ltx_align_center">VisA</td>
<td id="A4.T5.1.10.3" class="ltx_td ltx_align_center">(95.5, 87.0)</td>
<td id="A4.T5.1.10.4" class="ltx_td ltx_align_center">(95.5, 86.5)</td>
<td id="A4.T5.1.10.5" class="ltx_td ltx_align_center">(95.5, 86.5)</td>
<td id="A4.T5.1.10.6" class="ltx_td ltx_align_center">(95.5, 86.2)</td>
<td id="A4.T5.1.10.7" class="ltx_td ltx_align_center">(95.6, 86.5)</td>
</tr>
<tr id="A4.T5.1.11" class="ltx_tr">
<td id="A4.T5.1.11.1" class="ltx_td ltx_align_center">MPDD</td>
<td id="A4.T5.1.11.2" class="ltx_td ltx_align_center">(96.5, 88.7)</td>
<td id="A4.T5.1.11.3" class="ltx_td ltx_align_center">(96.6, 88.7)</td>
<td id="A4.T5.1.11.4" class="ltx_td ltx_align_center">(96.7, 89.0)</td>
<td id="A4.T5.1.11.5" class="ltx_td ltx_align_center">(96.7, 89.2)</td>
<td id="A4.T5.1.11.6" class="ltx_td ltx_align_center">(96.6, 88.8)</td>
</tr>
<tr id="A4.T5.1.12" class="ltx_tr">
<td id="A4.T5.1.12.1" class="ltx_td ltx_align_center">BTAD</td>
<td id="A4.T5.1.12.2" class="ltx_td ltx_align_center">(94.2, 74.8)</td>
<td id="A4.T5.1.12.3" class="ltx_td ltx_align_center">(94.3, 74.3)</td>
<td id="A4.T5.1.12.4" class="ltx_td ltx_align_center">(94.4, 75.1)</td>
<td id="A4.T5.1.12.5" class="ltx_td ltx_align_center">(94.3, 75.2)</td>
<td id="A4.T5.1.12.6" class="ltx_td ltx_align_center">(94.3, 73.7)</td>
</tr>
<tr id="A4.T5.1.13" class="ltx_tr">
<td id="A4.T5.1.13.1" class="ltx_td ltx_align_center">SDD</td>
<td id="A4.T5.1.13.2" class="ltx_td ltx_align_center">(90.6, 67.8)</td>
<td id="A4.T5.1.13.3" class="ltx_td ltx_align_center">(89.6, 66.8)</td>
<td id="A4.T5.1.13.4" class="ltx_td ltx_align_center">(89.5, 66.5)</td>
<td id="A4.T5.1.13.5" class="ltx_td ltx_align_center">(89.5, 64.8)</td>
<td id="A4.T5.1.13.6" class="ltx_td ltx_align_center">(89.6, 64.6)</td>
</tr>
<tr id="A4.T5.1.14" class="ltx_tr">
<td id="A4.T5.1.14.1" class="ltx_td ltx_align_center ltx_border_bb" rowspan="2"><span id="A4.T5.1.14.1.1" class="ltx_text">Texture</span></td>
<td id="A4.T5.1.14.2" class="ltx_td ltx_align_center">DAGM</td>
<td id="A4.T5.1.14.3" class="ltx_td ltx_align_center">(95.6, 91.0)</td>
<td id="A4.T5.1.14.4" class="ltx_td ltx_align_center">(95.6, 91.2)</td>
<td id="A4.T5.1.14.5" class="ltx_td ltx_align_center">(95.6, 91.3)</td>
<td id="A4.T5.1.14.6" class="ltx_td ltx_align_center">(95.5, 90.9)</td>
<td id="A4.T5.1.14.7" class="ltx_td ltx_align_center">(95.6, 90.9)</td>
</tr>
<tr id="A4.T5.1.15" class="ltx_tr">
<td id="A4.T5.1.15.1" class="ltx_td ltx_align_center ltx_border_bb">DTD-Synthetic</td>
<td id="A4.T5.1.15.2" class="ltx_td ltx_align_center ltx_border_bb">(97.9, 92.3)</td>
<td id="A4.T5.1.15.3" class="ltx_td ltx_align_center ltx_border_bb">(97.9, 92.3)</td>
<td id="A4.T5.1.15.4" class="ltx_td ltx_align_center ltx_border_bb">(97.9, 92.1)</td>
<td id="A4.T5.1.15.5" class="ltx_td ltx_align_center ltx_border_bb">(97.9, 92.5)</td>
<td id="A4.T5.1.15.6" class="ltx_td ltx_align_center ltx_border_bb">(97.9, 92.2)</td>
</tr>
</table>
</figure>
<figure id="A4.F8" class="ltx_figure"><img src="/html/2310.18961/assets/x20.png" id="A4.F8.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="338" height="123" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 8: </span>Object ablation.</figcaption>
</figure>
</section>
<section id="A4.SS0.SSS0.Px5" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Object ablation</h5>

<div id="A4.SS0.SSS0.Px5.p1" class="ltx_para ltx_noindent">
<p id="A4.SS0.SSS0.Px5.p1.3" class="ltx_p">To investigate what the object-agnostic text prompts have learned, we replace <code id="A4.SS0.SSS0.Px5.p1.3.1" class="ltx_verbatim ltx_font_typewriter">object</code> in object-agnostic text prompts with specific target <code id="A4.SS0.SSS0.Px5.p1.3.2" class="ltx_verbatim ltx_font_typewriter">[cls]</code>, resulting in AnomalyCLIP<sub id="A4.SS0.SSS0.Px5.p1.3.3" class="ltx_sub"><span id="A4.SS0.SSS0.Px5.p1.3.3.1" class="ltx_text ltx_font_italic">re</span></sub>. In Fig. <a href="#A4.F8" title="Figure 8 ‣ Prompt template ablation ‣ Appendix D Additional results and ablations ‣ AnomalyCLIP: Object-agnostic Prompt Learning for Zero-shot Anomaly Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a>, AnomalyCLIP<sub id="A4.SS0.SSS0.Px5.p1.3.4" class="ltx_sub"><span id="A4.SS0.SSS0.Px5.p1.3.4.1" class="ltx_text ltx_font_italic">re</span></sub> still performs well in ZSAD, even as we block out the object semantics during fine-tuning. This suggests that the knowledge learned by object-agnostic text prompts is the underlying anomaly patterns, allowing them to provide discriminative textual embeddings even when specific object semantics are incorporated. Furthermore, compared to AnomalyCLIP, AnomalyCLIP<sub id="A4.SS0.SSS0.Px5.p1.3.5" class="ltx_sub"><span id="A4.SS0.SSS0.Px5.p1.3.5.1" class="ltx_text ltx_font_italic">re</span></sub> shows a performance decay, which can be attributed to the inclusion of redundant/noisy object semantics. These results once again demonstrate the generalization ability of object-agnostic prompt learning.</p>
</div>
<figure id="A4.T6" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 6: </span>Ablation on the robustness of the abnormality-related token in our prompt template on medical image datasets.</figcaption>
<table id="A4.T6.1" class="ltx_tabular ltx_centering ltx_align_middle">
<tr id="A4.T6.1.1" class="ltx_tr">
<td id="A4.T6.1.1.1" class="ltx_td ltx_align_center ltx_border_tt">Task</td>
<td id="A4.T6.1.1.2" class="ltx_td ltx_align_center ltx_border_tt">Category</td>
<td id="A4.T6.1.1.3" class="ltx_td ltx_align_center ltx_border_tt">Datasets</td>
<td id="A4.T6.1.1.4" class="ltx_td ltx_align_center ltx_border_tt">damaged</td>
<td id="A4.T6.1.1.5" class="ltx_td ltx_align_center ltx_border_tt">anomalous</td>
<td id="A4.T6.1.1.6" class="ltx_td ltx_align_center ltx_border_tt">flawed</td>
<td id="A4.T6.1.1.7" class="ltx_td ltx_align_center ltx_border_tt">defective</td>
<td id="A4.T6.1.1.8" class="ltx_td ltx_align_center ltx_border_tt">blemished</td>
</tr>
<tr id="A4.T6.1.2" class="ltx_tr">
<td id="A4.T6.1.2.1" class="ltx_td ltx_align_center ltx_border_t" rowspan="4"><span id="A4.T6.1.2.1.1" class="ltx_text"><span id="A4.T6.1.2.1.1.1" class="ltx_text"></span> <span id="A4.T6.1.2.1.1.2" class="ltx_text">
<span id="A4.T6.1.2.1.1.2.1" class="ltx_tabular ltx_align_middle">
<span id="A4.T6.1.2.1.1.2.1.1" class="ltx_tr">
<span id="A4.T6.1.2.1.1.2.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">Image-level</span></span>
<span id="A4.T6.1.2.1.1.2.1.2" class="ltx_tr">
<span id="A4.T6.1.2.1.1.2.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center">(AUROC, AP)</span></span>
</span></span> <span id="A4.T6.1.2.1.1.3" class="ltx_text"></span></span></td>
<td id="A4.T6.1.2.2" class="ltx_td ltx_align_center ltx_border_t" rowspan="3"><span id="A4.T6.1.2.2.1" class="ltx_text">Brain</span></td>
<td id="A4.T6.1.2.3" class="ltx_td ltx_align_center ltx_border_t">HeadCT</td>
<td id="A4.T6.1.2.4" class="ltx_td ltx_align_center ltx_border_t">(93.4, 91.6)</td>
<td id="A4.T6.1.2.5" class="ltx_td ltx_align_center ltx_border_t">(93.1, 90.6)</td>
<td id="A4.T6.1.2.6" class="ltx_td ltx_align_center ltx_border_t">(93.3, 90.8)</td>
<td id="A4.T6.1.2.7" class="ltx_td ltx_align_center ltx_border_t">(93.5, 91.0)</td>
<td id="A4.T6.1.2.8" class="ltx_td ltx_align_center ltx_border_t">(93.8, 91.5)</td>
</tr>
<tr id="A4.T6.1.3" class="ltx_tr">
<td id="A4.T6.1.3.1" class="ltx_td ltx_align_center">BrainMRI</td>
<td id="A4.T6.1.3.2" class="ltx_td ltx_align_center">(90.3, 92.2)</td>
<td id="A4.T6.1.3.3" class="ltx_td ltx_align_center">(87.8, 90.4)</td>
<td id="A4.T6.1.3.4" class="ltx_td ltx_align_center">(87.7, 90.0)</td>
<td id="A4.T6.1.3.5" class="ltx_td ltx_align_center">(88.3, 90.5)</td>
<td id="A4.T6.1.3.6" class="ltx_td ltx_align_center">(88.6, 90.7)</td>
</tr>
<tr id="A4.T6.1.4" class="ltx_tr">
<td id="A4.T6.1.4.1" class="ltx_td ltx_align_center">Br35H</td>
<td id="A4.T6.1.4.2" class="ltx_td ltx_align_center">(94.6, 94.7)</td>
<td id="A4.T6.1.4.3" class="ltx_td ltx_align_center">(93.1, 93.0)</td>
<td id="A4.T6.1.4.4" class="ltx_td ltx_align_center">(92.9, 92.8)</td>
<td id="A4.T6.1.4.5" class="ltx_td ltx_align_center">(93.1, 93.0)</td>
<td id="A4.T6.1.4.6" class="ltx_td ltx_align_center">(93.2, 93.1)</td>
</tr>
<tr id="A4.T6.1.5" class="ltx_tr">
<td id="A4.T6.1.5.1" class="ltx_td ltx_align_center">Chest</td>
<td id="A4.T6.1.5.2" class="ltx_td ltx_align_center">COVID-19</td>
<td id="A4.T6.1.5.3" class="ltx_td ltx_align_center">(80.1, 58.7)</td>
<td id="A4.T6.1.5.4" class="ltx_td ltx_align_center">(80.0, 58.5)</td>
<td id="A4.T6.1.5.5" class="ltx_td ltx_align_center">(80.2, 58.8)</td>
<td id="A4.T6.1.5.6" class="ltx_td ltx_align_center">(80.6, 59.0)</td>
<td id="A4.T6.1.5.7" class="ltx_td ltx_align_center">(82.1, 61.4)</td>
</tr>
<tr id="A4.T6.1.6" class="ltx_tr">
<td id="A4.T6.1.6.1" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" rowspan="6"><span id="A4.T6.1.6.1.1" class="ltx_text"><span id="A4.T6.1.6.1.1.1" class="ltx_text"></span> <span id="A4.T6.1.6.1.1.2" class="ltx_text">
<span id="A4.T6.1.6.1.1.2.1" class="ltx_tabular ltx_align_middle">
<span id="A4.T6.1.6.1.1.2.1.1" class="ltx_tr">
<span id="A4.T6.1.6.1.1.2.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">Pixel-level</span></span>
<span id="A4.T6.1.6.1.1.2.1.2" class="ltx_tr">
<span id="A4.T6.1.6.1.1.2.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center">(AUROC, PRO)</span></span>
</span></span> <span id="A4.T6.1.6.1.1.3" class="ltx_text"></span></span></td>
<td id="A4.T6.1.6.2" class="ltx_td ltx_align_center ltx_border_t">Skin</td>
<td id="A4.T6.1.6.3" class="ltx_td ltx_align_center ltx_border_t">ISIC</td>
<td id="A4.T6.1.6.4" class="ltx_td ltx_align_center ltx_border_t">(89.7, 78.4)</td>
<td id="A4.T6.1.6.5" class="ltx_td ltx_align_center ltx_border_t">(90.1, 80.1)</td>
<td id="A4.T6.1.6.6" class="ltx_td ltx_align_center ltx_border_t">(90.1, 80.1)</td>
<td id="A4.T6.1.6.7" class="ltx_td ltx_align_center ltx_border_t">(90.4, 81.0)</td>
<td id="A4.T6.1.6.8" class="ltx_td ltx_align_center ltx_border_t">(90.2, 80.6)</td>
</tr>
<tr id="A4.T6.1.7" class="ltx_tr">
<td id="A4.T6.1.7.1" class="ltx_td ltx_align_center" rowspan="4"><span id="A4.T6.1.7.1.1" class="ltx_text">Colon</span></td>
<td id="A4.T6.1.7.2" class="ltx_td ltx_align_center">CVC-ColonDB</td>
<td id="A4.T6.1.7.3" class="ltx_td ltx_align_center">(81.9, 71.3)</td>
<td id="A4.T6.1.7.4" class="ltx_td ltx_align_center">(82.2, 71.5)</td>
<td id="A4.T6.1.7.5" class="ltx_td ltx_align_center">(82.3, 71.6)</td>
<td id="A4.T6.1.7.6" class="ltx_td ltx_align_center">(82.1, 71.1)</td>
<td id="A4.T6.1.7.7" class="ltx_td ltx_align_center">(82.2, 71.5)</td>
</tr>
<tr id="A4.T6.1.8" class="ltx_tr">
<td id="A4.T6.1.8.1" class="ltx_td ltx_align_center">CVC-ClinicDB</td>
<td id="A4.T6.1.8.2" class="ltx_td ltx_align_center">(82.9, 67.8)</td>
<td id="A4.T6.1.8.3" class="ltx_td ltx_align_center">(83.0, 68.1)</td>
<td id="A4.T6.1.8.4" class="ltx_td ltx_align_center">(83.1, 68.4)</td>
<td id="A4.T6.1.8.5" class="ltx_td ltx_align_center">(82.9, 67.9)</td>
<td id="A4.T6.1.8.6" class="ltx_td ltx_align_center">(83.1, 68.2)</td>
</tr>
<tr id="A4.T6.1.9" class="ltx_tr">
<td id="A4.T6.1.9.1" class="ltx_td ltx_align_center">Kvasir</td>
<td id="A4.T6.1.9.2" class="ltx_td ltx_align_center">(78.9, 45.6)</td>
<td id="A4.T6.1.9.3" class="ltx_td ltx_align_center">(79.4, 45.1)</td>
<td id="A4.T6.1.9.4" class="ltx_td ltx_align_center">(79.4, 45.2)</td>
<td id="A4.T6.1.9.5" class="ltx_td ltx_align_center">(79.3, 44.9)</td>
<td id="A4.T6.1.9.6" class="ltx_td ltx_align_center">(79.5, 45.8)</td>
</tr>
<tr id="A4.T6.1.10" class="ltx_tr">
<td id="A4.T6.1.10.1" class="ltx_td ltx_align_center">Endo</td>
<td id="A4.T6.1.10.2" class="ltx_td ltx_align_center">(84.1, 63.6)</td>
<td id="A4.T6.1.10.3" class="ltx_td ltx_align_center">(84.3, 63.5)</td>
<td id="A4.T6.1.10.4" class="ltx_td ltx_align_center">(84.2, 63.5)</td>
<td id="A4.T6.1.10.5" class="ltx_td ltx_align_center">(84.2, 62.9)</td>
<td id="A4.T6.1.10.6" class="ltx_td ltx_align_center">(84.3, 63.4)</td>
</tr>
<tr id="A4.T6.1.11" class="ltx_tr">
<td id="A4.T6.1.11.1" class="ltx_td ltx_align_center ltx_border_bb">Thyroid</td>
<td id="A4.T6.1.11.2" class="ltx_td ltx_align_center ltx_border_bb">TN3K</td>
<td id="A4.T6.1.11.3" class="ltx_td ltx_align_center ltx_border_bb">(81.5, 50.4)</td>
<td id="A4.T6.1.11.4" class="ltx_td ltx_align_center ltx_border_bb">(81.5, 51.7)</td>
<td id="A4.T6.1.11.5" class="ltx_td ltx_align_center ltx_border_bb">(81.3, 50.9)</td>
<td id="A4.T6.1.11.6" class="ltx_td ltx_align_center ltx_border_bb">(81.3, 50.3)</td>
<td id="A4.T6.1.11.7" class="ltx_td ltx_align_center ltx_border_bb">(81.6, 51.1)</td>
</tr>
</table>
</figure>
</section>
</section>
<section id="A5" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix E </span>Visualization</h2>

<section id="A5.SS0.SSS0.Px1" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Similarity score between textual and visual embeddings.</h5>

<div id="A5.SS0.SSS0.Px1.p1" class="ltx_para ltx_noindent">
<p id="A5.SS0.SSS0.Px1.p1.1" class="ltx_p">We present visualizations of the similarity scores generated by both CLIP and AnomalyCLIP. These visualizations aim to provide an intuitive illustration of the effective adaptation made by AnomalyCLIP in comparison to CLIP. As shown in Fig. <a href="#A5.F9" title="Figure 9 ‣ Anomaly score map for different datasets. ‣ Appendix E Visualization ‣ AnomalyCLIP: Object-agnostic Prompt Learning for Zero-shot Anomaly Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">9</span></a> and Fig. <a href="#A5.F10" title="Figure 10 ‣ Anomaly score map for different datasets. ‣ Appendix E Visualization ‣ AnomalyCLIP: Object-agnostic Prompt Learning for Zero-shot Anomaly Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">10</span></a>, we present the similarity score of CLIP on MVTec AD and VisA. The normal and anomaly scores are severely overlapped. Further, the range of scores is centered at 0.5. These show that the textual and visual space of CLIP originally aligned for object semantics are not desired for ZSAD. Also, we visualize the similarity scores
of AnomalyCLIP in Fig. <a href="#A5.F11" title="Figure 11 ‣ Anomaly score map for different datasets. ‣ Appendix E Visualization ‣ AnomalyCLIP: Object-agnostic Prompt Learning for Zero-shot Anomaly Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">11</span></a> and Fig. <a href="#A5.F12" title="Figure 12 ‣ Anomaly score map for different datasets. ‣ Appendix E Visualization ‣ AnomalyCLIP: Object-agnostic Prompt Learning for Zero-shot Anomaly Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">12</span></a>. Compared to CLIP, there is a significant overlap between the scores assigned to normal and anomaly instances, and at the same time, the score range is considerably wider. These results indicate that AnomalyCLIP achieves a significant improvement in adapting CLIP to ZSAD.</p>
</div>
</section>
<section id="A5.SS0.SSS0.Px2" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Anomaly score map for different datasets.</h5>

<div id="A5.SS0.SSS0.Px2.p1" class="ltx_para ltx_noindent">
<p id="A5.SS0.SSS0.Px2.p1.1" class="ltx_p">In addition to the similarity score for anomaly classification, we also visualize the anomaly score maps to present the strong anomaly segmentation ability of AnomalyCLIP. Specifically, we visualize the industrial object class: hazelnut, pill, and screw from MVTec AD; candle, chewinggum, capsule, cashew, pcb, and pip fryum from Visa; bracket, metal plate, and tube from MPDD. We also visualize the industrial texture: grid, leather, carpet, tile, wood, and zipper. In addition, we visualize the segmentation in medical domain across photography, endoscopy, and radiology images: skin cancer detection from ISIC; thyroid nodule detection from TN3K; colon polyp detection from Kvasir; brain tumor detection from Br35H.</p>
</div>
<figure id="A5.F9" class="ltx_figure"><img src="/html/2310.18961/assets/x21.png" id="A5.F9.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="422" height="282" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 9: </span>Similarity scores of CLIP on MVTec AD. Each sub-figure represents the visualization of one object.</figcaption>
</figure>
<figure id="A5.F10" class="ltx_figure"><img src="/html/2310.18961/assets/x22.png" id="A5.F10.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="422" height="282" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 10: </span>Similarity scores of CLIP on VisA. Each sub-figure represents the visualization of one object.</figcaption>
</figure>
<figure id="A5.F11" class="ltx_figure"><img src="/html/2310.18961/assets/x23.png" id="A5.F11.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="422" height="281" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 11: </span>Similarity scores of AnomalyCLIP on MVTec AD. Each sub-figure represents the visualization of one object.</figcaption>
</figure>
<figure id="A5.F12" class="ltx_figure"><img src="/html/2310.18961/assets/x24.png" id="A5.F12.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="422" height="278" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 12: </span>Similarity scores of AnomalyCLIP on VisA. Each sub-figure represents the visualization of one object.</figcaption>
</figure>
<figure id="A5.F13" class="ltx_figure"><img src="/html/2310.18961/assets/select_mvtec_hazelnut.png" id="A5.F13.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="548" height="151" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 13: </span>Anomaly score maps for the data subset, hazelnut, in MVTec AD. The first row represents the input, and we circle the anomaly regions in the second row. The last row presents the segmentation results from AnomalyCLIP.</figcaption>
</figure>
<figure id="A5.F14" class="ltx_figure"><img src="/html/2310.18961/assets/select_mvtec_pill.png" id="A5.F14.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="548" height="151" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 14: </span>Anomaly score maps for the data subset, pill, in MVTec AD. The first row represents the input, and we circle the anomaly regions in the second row. The last row presents the segmentation results from AnomalyCLIP.</figcaption>
</figure>
<figure id="A5.F15" class="ltx_figure"><img src="/html/2310.18961/assets/select_mvtec_metal_nut.png" id="A5.F15.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="548" height="151" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 15: </span>Anomaly score maps for the data subset, metal nut, in MVTec AD. The first row represents the input, and we circle the anomaly regions in the second row. The last row presents the segmentation results from AnomalyCLIP.</figcaption>
</figure>
<figure id="A5.F16" class="ltx_figure"><img src="/html/2310.18961/assets/select_mvtec_capsule.png" id="A5.F16.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="548" height="151" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 16: </span>Anomaly score maps for the data subset, capsule, in MVTec AD. The first row represents the input, and we circle the anomaly regions in the second row. The last row presents the segmentation results from AnomalyCLIP.</figcaption>
</figure>
<figure id="A5.F17" class="ltx_figure"><img src="/html/2310.18961/assets/select_mvtec_screw.png" id="A5.F17.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="548" height="151" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 17: </span>Anomaly score maps for the data subset, screw, in MVTec AD. The first row represents the input, and we circle the anomaly regions in the second row. The last row presents the segmentation results from AnomalyCLIP.</figcaption>
</figure>
<figure id="A5.F18" class="ltx_figure"><img src="/html/2310.18961/assets/select_visa_candle.png" id="A5.F18.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="548" height="151" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 18: </span>Anomaly score maps for the data subset candle. The first row represents the input, and we circle the anomaly regions in the second row. The last row presents the segmentation results from AnomalyCLIP.</figcaption>
</figure>
<figure id="A5.F19" class="ltx_figure"><img src="/html/2310.18961/assets/select_visa_chewinggum.png" id="A5.F19.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="548" height="151" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 19: </span>Anomaly score maps for the data subset chewinggum. The first row represents the input, and we circle the anomaly regions in the second row. The last row presents the segmentation results from AnomalyCLIP.</figcaption>
</figure>
<figure id="A5.F20" class="ltx_figure"><img src="/html/2310.18961/assets/select_visa_capusle.png" id="A5.F20.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="548" height="151" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 20: </span>Anomaly score maps for the data subset capusle. The first row represents the input, and we circle the anomaly regions in the second row. The last row presents the segmentation results from AnomalyCLIP.</figcaption>
</figure>
<figure id="A5.F21" class="ltx_figure"><img src="/html/2310.18961/assets/select_visa_cashew.png" id="A5.F21.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="548" height="151" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 21: </span>Anomaly score maps for the data subset cashew. The first row represents the input, and we circle the anomaly regions in the second row. The last row presents the segmentation results from AnomalyCLIP.</figcaption>
</figure>
<figure id="A5.F22" class="ltx_figure"><img src="/html/2310.18961/assets/select_visa_pcb4.png" id="A5.F22.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="548" height="151" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 22: </span>Anomaly score maps for the data subset pcb. The first row represents the input, and we circle the anomaly regions in the second row. The last row presents the segmentation results from AnomalyCLIP.</figcaption>
</figure>
<figure id="A5.F23" class="ltx_figure"><img src="/html/2310.18961/assets/select_visa_pip_fryum.png" id="A5.F23.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="548" height="151" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 23: </span>Anomaly score maps for the data subset pip fryum. The first row represents the input, and we circle the anomaly regions in the second row. The last row presents the segmentation results from AnomalyCLIP.</figcaption>
</figure>
<figure id="A5.F24" class="ltx_figure"><img src="/html/2310.18961/assets/select_mpdd_bracket.png" id="A5.F24.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="548" height="151" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 24: </span>Similarity scores for the data subset bracket. The first row represents the input, and we circle the anomaly regions in the second row. The last row presents the segmentation results from AnomalyCLIP.</figcaption>
</figure>
<figure id="A5.F25" class="ltx_figure"><img src="/html/2310.18961/assets/select_mpdd_metal_plate.png" id="A5.F25.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="548" height="151" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 25: </span>Anomaly score maps for the data subset metal plate. The first row represents the input, and we circle the anomaly regions in the second row. The last row presents the segmentation results from AnomalyCLIP.</figcaption>
</figure>
<figure id="A5.F26" class="ltx_figure"><img src="/html/2310.18961/assets/select_mapp_tubes.png" id="A5.F26.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="548" height="151" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 26: </span>Anomaly score maps for the data subset tube. The first row represents the input, and we circle the anomaly regions in the second row. The last row presents the segmentation results from AnomalyCLIP.</figcaption>
</figure>
<figure id="A5.F27" class="ltx_figure"><img src="/html/2310.18961/assets/select_mvtec_grid.png" id="A5.F27.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="548" height="151" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 27: </span>Anomaly score maps for the data subset grid. The first row represents the input, and we circle the anomaly regions in the second row. The last row presents the segmentation results from AnomalyCLIP.</figcaption>
</figure>
<figure id="A5.F28" class="ltx_figure"><img src="/html/2310.18961/assets/select_mvtec_leather.png" id="A5.F28.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="548" height="151" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 28: </span>Anomaly score maps for the data subset leather. The first row represents the input, and we circle the anomaly regions in the second row. The last row presents the segmentation results from AnomalyCLIP.</figcaption>
</figure>
<figure id="A5.F29" class="ltx_figure"><img src="/html/2310.18961/assets/select_mvtec_carpet.png" id="A5.F29.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="548" height="151" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 29: </span>Anomaly score maps for the data subset carpet. The first row represents the input, and we circle the anomaly regions in the second row. The last row presents the segmentation results from AnomalyCLIP.</figcaption>
</figure>
<figure id="A5.F30" class="ltx_figure"><img src="/html/2310.18961/assets/select_mvtec_tile.png" id="A5.F30.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="548" height="151" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 30: </span>Anomaly score maps for the data subset tile. The first row represents the input, and we circle the anomaly regions in the second row. The last row presents the segmentation results from AnomalyCLIP.</figcaption>
</figure>
<figure id="A5.F31" class="ltx_figure"><img src="/html/2310.18961/assets/select_mvtec_wood.png" id="A5.F31.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="548" height="151" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 31: </span>Anomaly score maps for the data subset wood. The first row represents the input, and we circle the anomaly regions in the second row. The last row presents the segmentation results from AnomalyCLIP.</figcaption>
</figure>
<figure id="A5.F32" class="ltx_figure"><img src="/html/2310.18961/assets/select_mvtec_zipper.png" id="A5.F32.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="548" height="151" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 32: </span>Anomaly score maps for the data subset zipper. The first row represents the input, and we circle the anomaly regions in the second row. The last row presents the segmentation results from AnomalyCLIP.</figcaption>
</figure>
<figure id="A5.F33" class="ltx_figure"><img src="/html/2310.18961/assets/select_ISIC_skin.png" id="A5.F33.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="548" height="151" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 33: </span>Similarity scores for the data subset skin.</figcaption>
</figure>
<figure id="A5.F34" class="ltx_figure"><img src="/html/2310.18961/assets/select_thyroid.png" id="A5.F34.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="548" height="151" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 34: </span>Anomaly score maps for the data subset thyroid. The first row represents the input, and we circle the anomaly regions in the second row. The last row presents the segmentation results from AnomalyCLIP.</figcaption>
</figure>
<figure id="A5.F35" class="ltx_figure"><img src="/html/2310.18961/assets/select_colon.png" id="A5.F35.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="548" height="151" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 35: </span>Anomaly score maps for the data subset colon. The first row represents the input, and we circle the anomaly regions in the second row. The last row presents the segmentation results from AnomalyCLIP.</figcaption>
</figure>
<figure id="A5.F36" class="ltx_figure"><img src="/html/2310.18961/assets/select_brain.png" id="A5.F36.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="548" height="151" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 36: </span>Anomaly score maps for the data subset brain. The first row represents the input, and we circle the anomaly regions in the second row. The last row presents the segmentation results from AnomalyCLIP.</figcaption>
</figure>
</section>
</section>
<section id="A6" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix F </span>Fine-grained ZSAD performance</h2>

<div id="A6.p1" class="ltx_para ltx_noindent">
<p id="A6.p1.1" class="ltx_p">In this section, we present the fine-grained data subset-level ZSAD performance in details.</p>
</div>
<figure id="A6.T7" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 7: </span>Fine-grained data-subset-wise performance comparison (AUROC) for anomaly segmentation on MVTec AD.</figcaption>
<table id="A6.T7.1" class="ltx_tabular ltx_centering ltx_align_middle">
<tr id="A6.T7.1.1" class="ltx_tr">
<td id="A6.T7.1.1.1" class="ltx_td ltx_align_center ltx_border_tt"><span id="A6.T7.1.1.1.1" class="ltx_text ltx_font_bold">Object name</span></td>
<td id="A6.T7.1.1.2" class="ltx_td ltx_align_center ltx_border_tt">CLIP</td>
<td id="A6.T7.1.1.3" class="ltx_td ltx_align_center ltx_border_tt">CLIP-AC</td>
<td id="A6.T7.1.1.4" class="ltx_td ltx_align_center ltx_border_tt">WinCLIP</td>
<td id="A6.T7.1.1.5" class="ltx_td ltx_align_center ltx_border_tt">VAND</td>
<td id="A6.T7.1.1.6" class="ltx_td ltx_align_center ltx_border_tt">CoOp</td>
<td id="A6.T7.1.1.7" class="ltx_td ltx_align_center ltx_border_tt">AnomalyCLIP</td>
</tr>
<tr id="A6.T7.1.2" class="ltx_tr">
<td id="A6.T7.1.2.1" class="ltx_td ltx_align_center ltx_border_t">Carpet</td>
<td id="A6.T7.1.2.2" class="ltx_td ltx_align_center ltx_border_t">11.5</td>
<td id="A6.T7.1.2.3" class="ltx_td ltx_align_center ltx_border_t">10.7</td>
<td id="A6.T7.1.2.4" class="ltx_td ltx_align_center ltx_border_t">95.4</td>
<td id="A6.T7.1.2.5" class="ltx_td ltx_align_center ltx_border_t">98.4</td>
<td id="A6.T7.1.2.6" class="ltx_td ltx_align_center ltx_border_t">6.7</td>
<td id="A6.T7.1.2.7" class="ltx_td ltx_align_center ltx_border_t">98.8</td>
</tr>
<tr id="A6.T7.1.3" class="ltx_tr">
<td id="A6.T7.1.3.1" class="ltx_td ltx_align_center">Bottle</td>
<td id="A6.T7.1.3.2" class="ltx_td ltx_align_center">17.5</td>
<td id="A6.T7.1.3.3" class="ltx_td ltx_align_center">23.3</td>
<td id="A6.T7.1.3.4" class="ltx_td ltx_align_center">89.5</td>
<td id="A6.T7.1.3.5" class="ltx_td ltx_align_center">83.4</td>
<td id="A6.T7.1.3.6" class="ltx_td ltx_align_center">23.1</td>
<td id="A6.T7.1.3.7" class="ltx_td ltx_align_center">90.4</td>
</tr>
<tr id="A6.T7.1.4" class="ltx_tr">
<td id="A6.T7.1.4.1" class="ltx_td ltx_align_center">Hazelnut</td>
<td id="A6.T7.1.4.2" class="ltx_td ltx_align_center">25.2</td>
<td id="A6.T7.1.4.3" class="ltx_td ltx_align_center">34.0</td>
<td id="A6.T7.1.4.4" class="ltx_td ltx_align_center">94.3</td>
<td id="A6.T7.1.4.5" class="ltx_td ltx_align_center">96.1</td>
<td id="A6.T7.1.4.6" class="ltx_td ltx_align_center">30.2</td>
<td id="A6.T7.1.4.7" class="ltx_td ltx_align_center">97.1</td>
</tr>
<tr id="A6.T7.1.5" class="ltx_tr">
<td id="A6.T7.1.5.1" class="ltx_td ltx_align_center">Leather</td>
<td id="A6.T7.1.5.2" class="ltx_td ltx_align_center">9.9</td>
<td id="A6.T7.1.5.3" class="ltx_td ltx_align_center">5.6</td>
<td id="A6.T7.1.5.4" class="ltx_td ltx_align_center">96.7</td>
<td id="A6.T7.1.5.5" class="ltx_td ltx_align_center">99.1</td>
<td id="A6.T7.1.5.6" class="ltx_td ltx_align_center">11.7</td>
<td id="A6.T7.1.5.7" class="ltx_td ltx_align_center">98.6</td>
</tr>
<tr id="A6.T7.1.6" class="ltx_tr">
<td id="A6.T7.1.6.1" class="ltx_td ltx_align_center">Cable</td>
<td id="A6.T7.1.6.2" class="ltx_td ltx_align_center">37.4</td>
<td id="A6.T7.1.6.3" class="ltx_td ltx_align_center">37.5</td>
<td id="A6.T7.1.6.4" class="ltx_td ltx_align_center">77.0</td>
<td id="A6.T7.1.6.5" class="ltx_td ltx_align_center">72.3</td>
<td id="A6.T7.1.6.6" class="ltx_td ltx_align_center">49.7</td>
<td id="A6.T7.1.6.7" class="ltx_td ltx_align_center">78.9</td>
</tr>
<tr id="A6.T7.1.7" class="ltx_tr">
<td id="A6.T7.1.7.1" class="ltx_td ltx_align_center">Capsule</td>
<td id="A6.T7.1.7.2" class="ltx_td ltx_align_center">50.9</td>
<td id="A6.T7.1.7.3" class="ltx_td ltx_align_center">49.1</td>
<td id="A6.T7.1.7.4" class="ltx_td ltx_align_center">86.9</td>
<td id="A6.T7.1.7.5" class="ltx_td ltx_align_center">92.0</td>
<td id="A6.T7.1.7.6" class="ltx_td ltx_align_center">35.5</td>
<td id="A6.T7.1.7.7" class="ltx_td ltx_align_center">95.8</td>
</tr>
<tr id="A6.T7.1.8" class="ltx_tr">
<td id="A6.T7.1.8.1" class="ltx_td ltx_align_center">Grid</td>
<td id="A6.T7.1.8.2" class="ltx_td ltx_align_center">8.7</td>
<td id="A6.T7.1.8.3" class="ltx_td ltx_align_center">11.9</td>
<td id="A6.T7.1.8.4" class="ltx_td ltx_align_center">82.2</td>
<td id="A6.T7.1.8.5" class="ltx_td ltx_align_center">95.8</td>
<td id="A6.T7.1.8.6" class="ltx_td ltx_align_center">7.8</td>
<td id="A6.T7.1.8.7" class="ltx_td ltx_align_center">97.3</td>
</tr>
<tr id="A6.T7.1.9" class="ltx_tr">
<td id="A6.T7.1.9.1" class="ltx_td ltx_align_center">Pill</td>
<td id="A6.T7.1.9.2" class="ltx_td ltx_align_center">55.8</td>
<td id="A6.T7.1.9.3" class="ltx_td ltx_align_center">60.8</td>
<td id="A6.T7.1.9.4" class="ltx_td ltx_align_center">80.0</td>
<td id="A6.T7.1.9.5" class="ltx_td ltx_align_center">76.2</td>
<td id="A6.T7.1.9.6" class="ltx_td ltx_align_center">46.5</td>
<td id="A6.T7.1.9.7" class="ltx_td ltx_align_center">92</td>
</tr>
<tr id="A6.T7.1.10" class="ltx_tr">
<td id="A6.T7.1.10.1" class="ltx_td ltx_align_center">Transistor</td>
<td id="A6.T7.1.10.2" class="ltx_td ltx_align_center">51.1</td>
<td id="A6.T7.1.10.3" class="ltx_td ltx_align_center">48.5</td>
<td id="A6.T7.1.10.4" class="ltx_td ltx_align_center">74.7</td>
<td id="A6.T7.1.10.5" class="ltx_td ltx_align_center">62.4</td>
<td id="A6.T7.1.10.6" class="ltx_td ltx_align_center">50.1</td>
<td id="A6.T7.1.10.7" class="ltx_td ltx_align_center">71</td>
</tr>
<tr id="A6.T7.1.11" class="ltx_tr">
<td id="A6.T7.1.11.1" class="ltx_td ltx_align_center">Metal_nut</td>
<td id="A6.T7.1.11.2" class="ltx_td ltx_align_center">43.9</td>
<td id="A6.T7.1.11.3" class="ltx_td ltx_align_center">53.6</td>
<td id="A6.T7.1.11.4" class="ltx_td ltx_align_center">61.0</td>
<td id="A6.T7.1.11.5" class="ltx_td ltx_align_center">65.4</td>
<td id="A6.T7.1.11.6" class="ltx_td ltx_align_center">49.3</td>
<td id="A6.T7.1.11.7" class="ltx_td ltx_align_center">74.4</td>
</tr>
<tr id="A6.T7.1.12" class="ltx_tr">
<td id="A6.T7.1.12.1" class="ltx_td ltx_align_center">Screw</td>
<td id="A6.T7.1.12.2" class="ltx_td ltx_align_center">80.1</td>
<td id="A6.T7.1.12.3" class="ltx_td ltx_align_center">76.4</td>
<td id="A6.T7.1.12.4" class="ltx_td ltx_align_center">89.6</td>
<td id="A6.T7.1.12.5" class="ltx_td ltx_align_center">97.8</td>
<td id="A6.T7.1.12.6" class="ltx_td ltx_align_center">17.0</td>
<td id="A6.T7.1.12.7" class="ltx_td ltx_align_center">97.5</td>
</tr>
<tr id="A6.T7.1.13" class="ltx_tr">
<td id="A6.T7.1.13.1" class="ltx_td ltx_align_center">Toothbrush</td>
<td id="A6.T7.1.13.2" class="ltx_td ltx_align_center">36.3</td>
<td id="A6.T7.1.13.3" class="ltx_td ltx_align_center">35.0</td>
<td id="A6.T7.1.13.4" class="ltx_td ltx_align_center">86.9</td>
<td id="A6.T7.1.13.5" class="ltx_td ltx_align_center">95.8</td>
<td id="A6.T7.1.13.6" class="ltx_td ltx_align_center">64.9</td>
<td id="A6.T7.1.13.7" class="ltx_td ltx_align_center">91.9</td>
</tr>
<tr id="A6.T7.1.14" class="ltx_tr">
<td id="A6.T7.1.14.1" class="ltx_td ltx_align_center">Zipper</td>
<td id="A6.T7.1.14.2" class="ltx_td ltx_align_center">51.5</td>
<td id="A6.T7.1.14.3" class="ltx_td ltx_align_center">44.7</td>
<td id="A6.T7.1.14.4" class="ltx_td ltx_align_center">91.6</td>
<td id="A6.T7.1.14.5" class="ltx_td ltx_align_center">91.1</td>
<td id="A6.T7.1.14.6" class="ltx_td ltx_align_center">33.4</td>
<td id="A6.T7.1.14.7" class="ltx_td ltx_align_center">91.4</td>
</tr>
<tr id="A6.T7.1.15" class="ltx_tr">
<td id="A6.T7.1.15.1" class="ltx_td ltx_align_center">Tile</td>
<td id="A6.T7.1.15.2" class="ltx_td ltx_align_center">49.9</td>
<td id="A6.T7.1.15.3" class="ltx_td ltx_align_center">39.1</td>
<td id="A6.T7.1.15.4" class="ltx_td ltx_align_center">77.6</td>
<td id="A6.T7.1.15.5" class="ltx_td ltx_align_center">92.7</td>
<td id="A6.T7.1.15.6" class="ltx_td ltx_align_center">41.7</td>
<td id="A6.T7.1.15.7" class="ltx_td ltx_align_center">94.6</td>
</tr>
<tr id="A6.T7.1.16" class="ltx_tr">
<td id="A6.T7.1.16.1" class="ltx_td ltx_align_center">Wood</td>
<td id="A6.T7.1.16.2" class="ltx_td ltx_align_center">45.7</td>
<td id="A6.T7.1.16.3" class="ltx_td ltx_align_center">42.4</td>
<td id="A6.T7.1.16.4" class="ltx_td ltx_align_center">93.4</td>
<td id="A6.T7.1.16.5" class="ltx_td ltx_align_center">95.8</td>
<td id="A6.T7.1.16.6" class="ltx_td ltx_align_center">31.4</td>
<td id="A6.T7.1.16.7" class="ltx_td ltx_align_center">96.5</td>
</tr>
<tr id="A6.T7.1.17" class="ltx_tr">
<td id="A6.T7.1.17.1" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">Mean</td>
<td id="A6.T7.1.17.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">38.4</td>
<td id="A6.T7.1.17.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">38.2</td>
<td id="A6.T7.1.17.4" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">85.1</td>
<td id="A6.T7.1.17.5" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">87.6</td>
<td id="A6.T7.1.17.6" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">33.3</td>
<td id="A6.T7.1.17.7" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">91.1</td>
</tr>
</table>
</figure>
<figure id="A6.T8" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 8: </span>Fine-grained data-subset-wise performance comparison (PRO) for anomaly segmentation on MVTec AD.</figcaption>
<table id="A6.T8.1" class="ltx_tabular ltx_centering ltx_align_middle">
<tr id="A6.T8.1.1" class="ltx_tr">
<td id="A6.T8.1.1.1" class="ltx_td ltx_align_center ltx_border_tt"><span id="A6.T8.1.1.1.1" class="ltx_text ltx_font_bold">Object name</span></td>
<td id="A6.T8.1.1.2" class="ltx_td ltx_align_center ltx_border_tt">CLIP</td>
<td id="A6.T8.1.1.3" class="ltx_td ltx_align_center ltx_border_tt">CLIP-AC</td>
<td id="A6.T8.1.1.4" class="ltx_td ltx_align_center ltx_border_tt">WinCLIP</td>
<td id="A6.T8.1.1.5" class="ltx_td ltx_align_center ltx_border_tt">VAND</td>
<td id="A6.T8.1.1.6" class="ltx_td ltx_align_center ltx_border_tt">CoOp</td>
<td id="A6.T8.1.1.7" class="ltx_td ltx_align_center ltx_border_tt">AnomalyCLIP</td>
</tr>
<tr id="A6.T8.1.2" class="ltx_tr">
<td id="A6.T8.1.2.1" class="ltx_td ltx_align_center ltx_border_t">Carpet</td>
<td id="A6.T8.1.2.2" class="ltx_td ltx_align_center ltx_border_t">2.9</td>
<td id="A6.T8.1.2.3" class="ltx_td ltx_align_center ltx_border_t">1.9</td>
<td id="A6.T8.1.2.4" class="ltx_td ltx_align_center ltx_border_t">84.1</td>
<td id="A6.T8.1.2.5" class="ltx_td ltx_align_center ltx_border_t">48.5</td>
<td id="A6.T8.1.2.6" class="ltx_td ltx_align_center ltx_border_t">0.5</td>
<td id="A6.T8.1.2.7" class="ltx_td ltx_align_center ltx_border_t">90.1</td>
</tr>
<tr id="A6.T8.1.3" class="ltx_tr">
<td id="A6.T8.1.3.1" class="ltx_td ltx_align_center">Bottle</td>
<td id="A6.T8.1.3.2" class="ltx_td ltx_align_center">1.4</td>
<td id="A6.T8.1.3.3" class="ltx_td ltx_align_center">4.9</td>
<td id="A6.T8.1.3.4" class="ltx_td ltx_align_center">76.4</td>
<td id="A6.T8.1.3.5" class="ltx_td ltx_align_center">45.6</td>
<td id="A6.T8.1.3.6" class="ltx_td ltx_align_center">4.5</td>
<td id="A6.T8.1.3.7" class="ltx_td ltx_align_center">80.9</td>
</tr>
<tr id="A6.T8.1.4" class="ltx_tr">
<td id="A6.T8.1.4.1" class="ltx_td ltx_align_center">Hazelnut</td>
<td id="A6.T8.1.4.2" class="ltx_td ltx_align_center">2.8</td>
<td id="A6.T8.1.4.3" class="ltx_td ltx_align_center">9.4</td>
<td id="A6.T8.1.4.4" class="ltx_td ltx_align_center">81.6</td>
<td id="A6.T8.1.4.5" class="ltx_td ltx_align_center">70.3</td>
<td id="A6.T8.1.4.6" class="ltx_td ltx_align_center">4.7</td>
<td id="A6.T8.1.4.7" class="ltx_td ltx_align_center">92.4</td>
</tr>
<tr id="A6.T8.1.5" class="ltx_tr">
<td id="A6.T8.1.5.1" class="ltx_td ltx_align_center">Leather</td>
<td id="A6.T8.1.5.2" class="ltx_td ltx_align_center">0.2</td>
<td id="A6.T8.1.5.3" class="ltx_td ltx_align_center">0.0</td>
<td id="A6.T8.1.5.4" class="ltx_td ltx_align_center">91.1</td>
<td id="A6.T8.1.5.5" class="ltx_td ltx_align_center">72.4</td>
<td id="A6.T8.1.5.6" class="ltx_td ltx_align_center">1.8</td>
<td id="A6.T8.1.5.7" class="ltx_td ltx_align_center">92.2</td>
</tr>
<tr id="A6.T8.1.6" class="ltx_tr">
<td id="A6.T8.1.6.1" class="ltx_td ltx_align_center">Cable</td>
<td id="A6.T8.1.6.2" class="ltx_td ltx_align_center">7.3</td>
<td id="A6.T8.1.6.3" class="ltx_td ltx_align_center">6.9</td>
<td id="A6.T8.1.6.4" class="ltx_td ltx_align_center">42.9</td>
<td id="A6.T8.1.6.5" class="ltx_td ltx_align_center">25.7</td>
<td id="A6.T8.1.6.6" class="ltx_td ltx_align_center">12.2</td>
<td id="A6.T8.1.6.7" class="ltx_td ltx_align_center">64.4</td>
</tr>
<tr id="A6.T8.1.7" class="ltx_tr">
<td id="A6.T8.1.7.1" class="ltx_td ltx_align_center">Capsule</td>
<td id="A6.T8.1.7.2" class="ltx_td ltx_align_center">13.2</td>
<td id="A6.T8.1.7.3" class="ltx_td ltx_align_center">14.9</td>
<td id="A6.T8.1.7.4" class="ltx_td ltx_align_center">62.1</td>
<td id="A6.T8.1.7.5" class="ltx_td ltx_align_center">51.3</td>
<td id="A6.T8.1.7.6" class="ltx_td ltx_align_center">5.7</td>
<td id="A6.T8.1.7.7" class="ltx_td ltx_align_center">87.2</td>
</tr>
<tr id="A6.T8.1.8" class="ltx_tr">
<td id="A6.T8.1.8.1" class="ltx_td ltx_align_center">Grid</td>
<td id="A6.T8.1.8.2" class="ltx_td ltx_align_center">0.9</td>
<td id="A6.T8.1.8.3" class="ltx_td ltx_align_center">2.4</td>
<td id="A6.T8.1.8.4" class="ltx_td ltx_align_center">57.0</td>
<td id="A6.T8.1.8.5" class="ltx_td ltx_align_center">31.6</td>
<td id="A6.T8.1.8.6" class="ltx_td ltx_align_center">1.0</td>
<td id="A6.T8.1.8.7" class="ltx_td ltx_align_center">75.6</td>
</tr>
<tr id="A6.T8.1.9" class="ltx_tr">
<td id="A6.T8.1.9.1" class="ltx_td ltx_align_center">Pill</td>
<td id="A6.T8.1.9.2" class="ltx_td ltx_align_center">6.0</td>
<td id="A6.T8.1.9.3" class="ltx_td ltx_align_center">8.2</td>
<td id="A6.T8.1.9.4" class="ltx_td ltx_align_center">65.0</td>
<td id="A6.T8.1.9.5" class="ltx_td ltx_align_center">65.4</td>
<td id="A6.T8.1.9.6" class="ltx_td ltx_align_center">3.2</td>
<td id="A6.T8.1.9.7" class="ltx_td ltx_align_center">88.2</td>
</tr>
<tr id="A6.T8.1.10" class="ltx_tr">
<td id="A6.T8.1.10.1" class="ltx_td ltx_align_center">Transistor</td>
<td id="A6.T8.1.10.2" class="ltx_td ltx_align_center">15.3</td>
<td id="A6.T8.1.10.3" class="ltx_td ltx_align_center">11.2</td>
<td id="A6.T8.1.10.4" class="ltx_td ltx_align_center">43.4</td>
<td id="A6.T8.1.10.5" class="ltx_td ltx_align_center">21.3</td>
<td id="A6.T8.1.10.6" class="ltx_td ltx_align_center">9.3</td>
<td id="A6.T8.1.10.7" class="ltx_td ltx_align_center">58.1</td>
</tr>
<tr id="A6.T8.1.11" class="ltx_tr">
<td id="A6.T8.1.11.1" class="ltx_td ltx_align_center">Metal_nut</td>
<td id="A6.T8.1.11.2" class="ltx_td ltx_align_center">2.9</td>
<td id="A6.T8.1.11.3" class="ltx_td ltx_align_center">10.3</td>
<td id="A6.T8.1.11.4" class="ltx_td ltx_align_center">31.8</td>
<td id="A6.T8.1.11.5" class="ltx_td ltx_align_center">38.4</td>
<td id="A6.T8.1.11.6" class="ltx_td ltx_align_center">7.0</td>
<td id="A6.T8.1.11.7" class="ltx_td ltx_align_center">71.0</td>
</tr>
<tr id="A6.T8.1.12" class="ltx_tr">
<td id="A6.T8.1.12.1" class="ltx_td ltx_align_center">Screw</td>
<td id="A6.T8.1.12.2" class="ltx_td ltx_align_center">57.8</td>
<td id="A6.T8.1.12.3" class="ltx_td ltx_align_center">56.2</td>
<td id="A6.T8.1.12.4" class="ltx_td ltx_align_center">68.5</td>
<td id="A6.T8.1.12.5" class="ltx_td ltx_align_center">67.1</td>
<td id="A6.T8.1.12.6" class="ltx_td ltx_align_center">6.4</td>
<td id="A6.T8.1.12.7" class="ltx_td ltx_align_center">88.0</td>
</tr>
<tr id="A6.T8.1.13" class="ltx_tr">
<td id="A6.T8.1.13.1" class="ltx_td ltx_align_center">Toothbrush</td>
<td id="A6.T8.1.13.2" class="ltx_td ltx_align_center">5.8</td>
<td id="A6.T8.1.13.3" class="ltx_td ltx_align_center">5.2</td>
<td id="A6.T8.1.13.4" class="ltx_td ltx_align_center">67.7</td>
<td id="A6.T8.1.13.5" class="ltx_td ltx_align_center">54.5</td>
<td id="A6.T8.1.13.6" class="ltx_td ltx_align_center">16.6</td>
<td id="A6.T8.1.13.7" class="ltx_td ltx_align_center">88.5</td>
</tr>
<tr id="A6.T8.1.14" class="ltx_tr">
<td id="A6.T8.1.14.1" class="ltx_td ltx_align_center">Zipper</td>
<td id="A6.T8.1.14.2" class="ltx_td ltx_align_center">17.7</td>
<td id="A6.T8.1.14.3" class="ltx_td ltx_align_center">15.2</td>
<td id="A6.T8.1.14.4" class="ltx_td ltx_align_center">71.7</td>
<td id="A6.T8.1.14.5" class="ltx_td ltx_align_center">10.7</td>
<td id="A6.T8.1.14.6" class="ltx_td ltx_align_center">11.6</td>
<td id="A6.T8.1.14.7" class="ltx_td ltx_align_center">65.3</td>
</tr>
<tr id="A6.T8.1.15" class="ltx_tr">
<td id="A6.T8.1.15.1" class="ltx_td ltx_align_center">Tile</td>
<td id="A6.T8.1.15.2" class="ltx_td ltx_align_center">21.5</td>
<td id="A6.T8.1.15.3" class="ltx_td ltx_align_center">16.3</td>
<td id="A6.T8.1.15.4" class="ltx_td ltx_align_center">51.2</td>
<td id="A6.T8.1.15.5" class="ltx_td ltx_align_center">26.7</td>
<td id="A6.T8.1.15.6" class="ltx_td ltx_align_center">10.1</td>
<td id="A6.T8.1.15.7" class="ltx_td ltx_align_center">87.6</td>
</tr>
<tr id="A6.T8.1.16" class="ltx_tr">
<td id="A6.T8.1.16.1" class="ltx_td ltx_align_center">Wood</td>
<td id="A6.T8.1.16.2" class="ltx_td ltx_align_center">13.7</td>
<td id="A6.T8.1.16.3" class="ltx_td ltx_align_center">10.3</td>
<td id="A6.T8.1.16.4" class="ltx_td ltx_align_center">74.1</td>
<td id="A6.T8.1.16.5" class="ltx_td ltx_align_center">31.1</td>
<td id="A6.T8.1.16.6" class="ltx_td ltx_align_center">5.1</td>
<td id="A6.T8.1.16.7" class="ltx_td ltx_align_center">91.2</td>
</tr>
<tr id="A6.T8.1.17" class="ltx_tr">
<td id="A6.T8.1.17.1" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">Mean</td>
<td id="A6.T8.1.17.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">11.3</td>
<td id="A6.T8.1.17.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">11.6</td>
<td id="A6.T8.1.17.4" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">64.6</td>
<td id="A6.T8.1.17.5" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">44.0</td>
<td id="A6.T8.1.17.6" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">6.7</td>
<td id="A6.T8.1.17.7" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">81.4</td>
</tr>
</table>
</figure>
<figure id="A6.T9" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 9: </span>Fine-grained data-subset-wise performance comparison (AUROC) for anomaly classification on MVTec AD.</figcaption>
<table id="A6.T9.1" class="ltx_tabular ltx_centering ltx_align_middle">
<tr id="A6.T9.1.1" class="ltx_tr">
<td id="A6.T9.1.1.1" class="ltx_td ltx_align_center ltx_border_tt"><span id="A6.T9.1.1.1.1" class="ltx_text ltx_font_bold">Object name</span></td>
<td id="A6.T9.1.1.2" class="ltx_td ltx_align_center ltx_border_tt">CLIP</td>
<td id="A6.T9.1.1.3" class="ltx_td ltx_align_center ltx_border_tt">CLIP-AC</td>
<td id="A6.T9.1.1.4" class="ltx_td ltx_align_center ltx_border_tt">WinCLIP</td>
<td id="A6.T9.1.1.5" class="ltx_td ltx_align_center ltx_border_tt">VAND</td>
<td id="A6.T9.1.1.6" class="ltx_td ltx_align_center ltx_border_tt">CoOp</td>
<td id="A6.T9.1.1.7" class="ltx_td ltx_align_center ltx_border_tt">AnomalyCLIP</td>
</tr>
<tr id="A6.T9.1.2" class="ltx_tr">
<td id="A6.T9.1.2.1" class="ltx_td ltx_align_center ltx_border_t">Carpet</td>
<td id="A6.T9.1.2.2" class="ltx_td ltx_align_center ltx_border_t">96</td>
<td id="A6.T9.1.2.3" class="ltx_td ltx_align_center ltx_border_t">93.1</td>
<td id="A6.T9.1.2.4" class="ltx_td ltx_align_center ltx_border_t">100.0</td>
<td id="A6.T9.1.2.5" class="ltx_td ltx_align_center ltx_border_t">99.5</td>
<td id="A6.T9.1.2.6" class="ltx_td ltx_align_center ltx_border_t">99.9</td>
<td id="A6.T9.1.2.7" class="ltx_td ltx_align_center ltx_border_t">100.0</td>
</tr>
<tr id="A6.T9.1.3" class="ltx_tr">
<td id="A6.T9.1.3.1" class="ltx_td ltx_align_center">Bottle</td>
<td id="A6.T9.1.3.2" class="ltx_td ltx_align_center">45.9</td>
<td id="A6.T9.1.3.3" class="ltx_td ltx_align_center">46.1</td>
<td id="A6.T9.1.3.4" class="ltx_td ltx_align_center">99.2</td>
<td id="A6.T9.1.3.5" class="ltx_td ltx_align_center">92.0</td>
<td id="A6.T9.1.3.6" class="ltx_td ltx_align_center">87.7</td>
<td id="A6.T9.1.3.7" class="ltx_td ltx_align_center">89.3</td>
</tr>
<tr id="A6.T9.1.4" class="ltx_tr">
<td id="A6.T9.1.4.1" class="ltx_td ltx_align_center">Hazelnut</td>
<td id="A6.T9.1.4.2" class="ltx_td ltx_align_center">88.7</td>
<td id="A6.T9.1.4.3" class="ltx_td ltx_align_center">91.1</td>
<td id="A6.T9.1.4.4" class="ltx_td ltx_align_center">93.9</td>
<td id="A6.T9.1.4.5" class="ltx_td ltx_align_center">89.6</td>
<td id="A6.T9.1.4.6" class="ltx_td ltx_align_center">93.5</td>
<td id="A6.T9.1.4.7" class="ltx_td ltx_align_center">97.2</td>
</tr>
<tr id="A6.T9.1.5" class="ltx_tr">
<td id="A6.T9.1.5.1" class="ltx_td ltx_align_center">Leather</td>
<td id="A6.T9.1.5.2" class="ltx_td ltx_align_center">99.4</td>
<td id="A6.T9.1.5.3" class="ltx_td ltx_align_center">99.5</td>
<td id="A6.T9.1.5.4" class="ltx_td ltx_align_center">100.0</td>
<td id="A6.T9.1.5.5" class="ltx_td ltx_align_center">99.7</td>
<td id="A6.T9.1.5.6" class="ltx_td ltx_align_center">99.9</td>
<td id="A6.T9.1.5.7" class="ltx_td ltx_align_center">99.8</td>
</tr>
<tr id="A6.T9.1.6" class="ltx_tr">
<td id="A6.T9.1.6.1" class="ltx_td ltx_align_center">Cable</td>
<td id="A6.T9.1.6.2" class="ltx_td ltx_align_center">58.1</td>
<td id="A6.T9.1.6.3" class="ltx_td ltx_align_center">46.6</td>
<td id="A6.T9.1.6.4" class="ltx_td ltx_align_center">86.5</td>
<td id="A6.T9.1.6.5" class="ltx_td ltx_align_center">88.4</td>
<td id="A6.T9.1.6.6" class="ltx_td ltx_align_center">56.7</td>
<td id="A6.T9.1.6.7" class="ltx_td ltx_align_center">69.8</td>
</tr>
<tr id="A6.T9.1.7" class="ltx_tr">
<td id="A6.T9.1.7.1" class="ltx_td ltx_align_center">Capsule</td>
<td id="A6.T9.1.7.2" class="ltx_td ltx_align_center">71.4</td>
<td id="A6.T9.1.7.3" class="ltx_td ltx_align_center">68.8</td>
<td id="A6.T9.1.7.4" class="ltx_td ltx_align_center">72.9</td>
<td id="A6.T9.1.7.5" class="ltx_td ltx_align_center">79.9</td>
<td id="A6.T9.1.7.6" class="ltx_td ltx_align_center">81.1</td>
<td id="A6.T9.1.7.7" class="ltx_td ltx_align_center">89.9</td>
</tr>
<tr id="A6.T9.1.8" class="ltx_tr">
<td id="A6.T9.1.8.1" class="ltx_td ltx_align_center">Grid</td>
<td id="A6.T9.1.8.2" class="ltx_td ltx_align_center">72.5</td>
<td id="A6.T9.1.8.3" class="ltx_td ltx_align_center">63.7</td>
<td id="A6.T9.1.8.4" class="ltx_td ltx_align_center">98.8</td>
<td id="A6.T9.1.8.5" class="ltx_td ltx_align_center">86.3</td>
<td id="A6.T9.1.8.6" class="ltx_td ltx_align_center">94.7</td>
<td id="A6.T9.1.8.7" class="ltx_td ltx_align_center">97.0</td>
</tr>
<tr id="A6.T9.1.9" class="ltx_tr">
<td id="A6.T9.1.9.1" class="ltx_td ltx_align_center">Pill</td>
<td id="A6.T9.1.9.2" class="ltx_td ltx_align_center">73.6</td>
<td id="A6.T9.1.9.3" class="ltx_td ltx_align_center">73.8</td>
<td id="A6.T9.1.9.4" class="ltx_td ltx_align_center">79.1</td>
<td id="A6.T9.1.9.5" class="ltx_td ltx_align_center">80.5</td>
<td id="A6.T9.1.9.6" class="ltx_td ltx_align_center">78.6</td>
<td id="A6.T9.1.9.7" class="ltx_td ltx_align_center">81.8</td>
</tr>
<tr id="A6.T9.1.10" class="ltx_tr">
<td id="A6.T9.1.10.1" class="ltx_td ltx_align_center">Transistor</td>
<td id="A6.T9.1.10.2" class="ltx_td ltx_align_center">48.8</td>
<td id="A6.T9.1.10.3" class="ltx_td ltx_align_center">51.2</td>
<td id="A6.T9.1.10.4" class="ltx_td ltx_align_center">88.0</td>
<td id="A6.T9.1.10.5" class="ltx_td ltx_align_center">80.8</td>
<td id="A6.T9.1.10.6" class="ltx_td ltx_align_center">92.2</td>
<td id="A6.T9.1.10.7" class="ltx_td ltx_align_center">92.8</td>
</tr>
<tr id="A6.T9.1.11" class="ltx_tr">
<td id="A6.T9.1.11.1" class="ltx_td ltx_align_center">Metal_nut</td>
<td id="A6.T9.1.11.2" class="ltx_td ltx_align_center">62.8</td>
<td id="A6.T9.1.11.3" class="ltx_td ltx_align_center">63.4</td>
<td id="A6.T9.1.11.4" class="ltx_td ltx_align_center">97.1</td>
<td id="A6.T9.1.11.5" class="ltx_td ltx_align_center">68.4</td>
<td id="A6.T9.1.11.6" class="ltx_td ltx_align_center">85.3</td>
<td id="A6.T9.1.11.7" class="ltx_td ltx_align_center">93.6</td>
</tr>
<tr id="A6.T9.1.12" class="ltx_tr">
<td id="A6.T9.1.12.1" class="ltx_td ltx_align_center">Screw</td>
<td id="A6.T9.1.12.2" class="ltx_td ltx_align_center">78.2</td>
<td id="A6.T9.1.12.3" class="ltx_td ltx_align_center">66.7</td>
<td id="A6.T9.1.12.4" class="ltx_td ltx_align_center">83.3</td>
<td id="A6.T9.1.12.5" class="ltx_td ltx_align_center">84.9</td>
<td id="A6.T9.1.12.6" class="ltx_td ltx_align_center">88.9</td>
<td id="A6.T9.1.12.7" class="ltx_td ltx_align_center">81.1</td>
</tr>
<tr id="A6.T9.1.13" class="ltx_tr">
<td id="A6.T9.1.13.1" class="ltx_td ltx_align_center">Toothbrush</td>
<td id="A6.T9.1.13.2" class="ltx_td ltx_align_center">73.3</td>
<td id="A6.T9.1.13.3" class="ltx_td ltx_align_center">89.2</td>
<td id="A6.T9.1.13.4" class="ltx_td ltx_align_center">88.0</td>
<td id="A6.T9.1.13.5" class="ltx_td ltx_align_center">53.8</td>
<td id="A6.T9.1.13.6" class="ltx_td ltx_align_center">77.5</td>
<td id="A6.T9.1.13.7" class="ltx_td ltx_align_center">84.7</td>
</tr>
<tr id="A6.T9.1.14" class="ltx_tr">
<td id="A6.T9.1.14.1" class="ltx_td ltx_align_center">Zipper</td>
<td id="A6.T9.1.14.2" class="ltx_td ltx_align_center">60.1</td>
<td id="A6.T9.1.14.3" class="ltx_td ltx_align_center">36.1</td>
<td id="A6.T9.1.14.4" class="ltx_td ltx_align_center">91.5</td>
<td id="A6.T9.1.14.5" class="ltx_td ltx_align_center">89.6</td>
<td id="A6.T9.1.14.6" class="ltx_td ltx_align_center">98.8</td>
<td id="A6.T9.1.14.7" class="ltx_td ltx_align_center">98.5</td>
</tr>
<tr id="A6.T9.1.15" class="ltx_tr">
<td id="A6.T9.1.15.1" class="ltx_td ltx_align_center">Tile</td>
<td id="A6.T9.1.15.2" class="ltx_td ltx_align_center">88.5</td>
<td id="A6.T9.1.15.3" class="ltx_td ltx_align_center">89.0</td>
<td id="A6.T9.1.15.4" class="ltx_td ltx_align_center">100.0</td>
<td id="A6.T9.1.15.5" class="ltx_td ltx_align_center">99.9</td>
<td id="A6.T9.1.15.6" class="ltx_td ltx_align_center">99.7</td>
<td id="A6.T9.1.15.7" class="ltx_td ltx_align_center">100.0</td>
</tr>
<tr id="A6.T9.1.16" class="ltx_tr">
<td id="A6.T9.1.16.1" class="ltx_td ltx_align_center">Wood</td>
<td id="A6.T9.1.16.2" class="ltx_td ltx_align_center">94</td>
<td id="A6.T9.1.16.3" class="ltx_td ltx_align_center">94.9</td>
<td id="A6.T9.1.16.4" class="ltx_td ltx_align_center">99.4</td>
<td id="A6.T9.1.16.5" class="ltx_td ltx_align_center">99.0</td>
<td id="A6.T9.1.16.6" class="ltx_td ltx_align_center">97.7</td>
<td id="A6.T9.1.16.7" class="ltx_td ltx_align_center">96.8</td>
</tr>
<tr id="A6.T9.1.17" class="ltx_tr">
<td id="A6.T9.1.17.1" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">Mean</td>
<td id="A6.T9.1.17.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">74.1</td>
<td id="A6.T9.1.17.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">71.5</td>
<td id="A6.T9.1.17.4" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">91.8</td>
<td id="A6.T9.1.17.5" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">86.1</td>
<td id="A6.T9.1.17.6" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">88.8</td>
<td id="A6.T9.1.17.7" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">91.5</td>
</tr>
</table>
</figure>
<figure id="A6.T10" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 10: </span>Fine-grained data-subset-wise performance comparison (AP) on for anomaly classification MVTec AD.</figcaption>
<table id="A6.T10.1" class="ltx_tabular ltx_centering ltx_align_middle">
<tr id="A6.T10.1.1" class="ltx_tr">
<td id="A6.T10.1.1.1" class="ltx_td ltx_align_center ltx_border_tt"><span id="A6.T10.1.1.1.1" class="ltx_text ltx_font_bold">Object name</span></td>
<td id="A6.T10.1.1.2" class="ltx_td ltx_align_center ltx_border_tt">CLIP</td>
<td id="A6.T10.1.1.3" class="ltx_td ltx_align_center ltx_border_tt">CLIP-AC</td>
<td id="A6.T10.1.1.4" class="ltx_td ltx_align_center ltx_border_tt">WinCLIP</td>
<td id="A6.T10.1.1.5" class="ltx_td ltx_align_center ltx_border_tt">VAND</td>
<td id="A6.T10.1.1.6" class="ltx_td ltx_align_center ltx_border_tt">CoOp</td>
<td id="A6.T10.1.1.7" class="ltx_td ltx_align_center ltx_border_tt">AnomalyCLIP</td>
</tr>
<tr id="A6.T10.1.2" class="ltx_tr">
<td id="A6.T10.1.2.1" class="ltx_td ltx_align_center ltx_border_t">Carpet</td>
<td id="A6.T10.1.2.2" class="ltx_td ltx_align_center ltx_border_t">98.8</td>
<td id="A6.T10.1.2.3" class="ltx_td ltx_align_center ltx_border_t">97.8</td>
<td id="A6.T10.1.2.4" class="ltx_td ltx_align_center ltx_border_t">100.0</td>
<td id="A6.T10.1.2.5" class="ltx_td ltx_align_center ltx_border_t">99.8</td>
<td id="A6.T10.1.2.6" class="ltx_td ltx_align_center ltx_border_t">100.0</td>
<td id="A6.T10.1.2.7" class="ltx_td ltx_align_center ltx_border_t">100.0</td>
</tr>
<tr id="A6.T10.1.3" class="ltx_tr">
<td id="A6.T10.1.3.1" class="ltx_td ltx_align_center">Bottle</td>
<td id="A6.T10.1.3.2" class="ltx_td ltx_align_center">78.9</td>
<td id="A6.T10.1.3.3" class="ltx_td ltx_align_center">79.8</td>
<td id="A6.T10.1.3.4" class="ltx_td ltx_align_center">99.8</td>
<td id="A6.T10.1.3.5" class="ltx_td ltx_align_center">97.7</td>
<td id="A6.T10.1.3.6" class="ltx_td ltx_align_center">96.4</td>
<td id="A6.T10.1.3.7" class="ltx_td ltx_align_center">97.0</td>
</tr>
<tr id="A6.T10.1.4" class="ltx_tr">
<td id="A6.T10.1.4.1" class="ltx_td ltx_align_center">Hazelnut</td>
<td id="A6.T10.1.4.2" class="ltx_td ltx_align_center">94.6</td>
<td id="A6.T10.1.4.3" class="ltx_td ltx_align_center">95.9</td>
<td id="A6.T10.1.4.4" class="ltx_td ltx_align_center">96.9</td>
<td id="A6.T10.1.4.5" class="ltx_td ltx_align_center">94.8</td>
<td id="A6.T10.1.4.6" class="ltx_td ltx_align_center">96.7</td>
<td id="A6.T10.1.4.7" class="ltx_td ltx_align_center">98.6</td>
</tr>
<tr id="A6.T10.1.5" class="ltx_tr">
<td id="A6.T10.1.5.1" class="ltx_td ltx_align_center">Leather</td>
<td id="A6.T10.1.5.2" class="ltx_td ltx_align_center">99.8</td>
<td id="A6.T10.1.5.3" class="ltx_td ltx_align_center">99.8</td>
<td id="A6.T10.1.5.4" class="ltx_td ltx_align_center">100.0</td>
<td id="A6.T10.1.5.5" class="ltx_td ltx_align_center">99.9</td>
<td id="A6.T10.1.5.6" class="ltx_td ltx_align_center">100.0</td>
<td id="A6.T10.1.5.7" class="ltx_td ltx_align_center">99.9</td>
</tr>
<tr id="A6.T10.1.6" class="ltx_tr">
<td id="A6.T10.1.6.1" class="ltx_td ltx_align_center">Cable</td>
<td id="A6.T10.1.6.2" class="ltx_td ltx_align_center">70.8</td>
<td id="A6.T10.1.6.3" class="ltx_td ltx_align_center">64.3</td>
<td id="A6.T10.1.6.4" class="ltx_td ltx_align_center">91.2</td>
<td id="A6.T10.1.6.5" class="ltx_td ltx_align_center">93.1</td>
<td id="A6.T10.1.6.6" class="ltx_td ltx_align_center">69.4</td>
<td id="A6.T10.1.6.7" class="ltx_td ltx_align_center">81.4</td>
</tr>
<tr id="A6.T10.1.7" class="ltx_tr">
<td id="A6.T10.1.7.1" class="ltx_td ltx_align_center">Capsule</td>
<td id="A6.T10.1.7.2" class="ltx_td ltx_align_center">92.1</td>
<td id="A6.T10.1.7.3" class="ltx_td ltx_align_center">90.9</td>
<td id="A6.T10.1.7.4" class="ltx_td ltx_align_center">91.5</td>
<td id="A6.T10.1.7.5" class="ltx_td ltx_align_center">95.5</td>
<td id="A6.T10.1.7.6" class="ltx_td ltx_align_center">95.7</td>
<td id="A6.T10.1.7.7" class="ltx_td ltx_align_center">97.9</td>
</tr>
<tr id="A6.T10.1.8" class="ltx_tr">
<td id="A6.T10.1.8.1" class="ltx_td ltx_align_center">Grid</td>
<td id="A6.T10.1.8.2" class="ltx_td ltx_align_center">87.1</td>
<td id="A6.T10.1.8.3" class="ltx_td ltx_align_center">83.9</td>
<td id="A6.T10.1.8.4" class="ltx_td ltx_align_center">99.6</td>
<td id="A6.T10.1.8.5" class="ltx_td ltx_align_center">94.9</td>
<td id="A6.T10.1.8.6" class="ltx_td ltx_align_center">98.1</td>
<td id="A6.T10.1.8.7" class="ltx_td ltx_align_center">99.1</td>
</tr>
<tr id="A6.T10.1.9" class="ltx_tr">
<td id="A6.T10.1.9.1" class="ltx_td ltx_align_center">Pill</td>
<td id="A6.T10.1.9.2" class="ltx_td ltx_align_center">93.4</td>
<td id="A6.T10.1.9.3" class="ltx_td ltx_align_center">93.6</td>
<td id="A6.T10.1.9.4" class="ltx_td ltx_align_center">95.7</td>
<td id="A6.T10.1.9.5" class="ltx_td ltx_align_center">96.0</td>
<td id="A6.T10.1.9.6" class="ltx_td ltx_align_center">94.2</td>
<td id="A6.T10.1.9.7" class="ltx_td ltx_align_center">95.4</td>
</tr>
<tr id="A6.T10.1.10" class="ltx_tr">
<td id="A6.T10.1.10.1" class="ltx_td ltx_align_center">Transistor</td>
<td id="A6.T10.1.10.2" class="ltx_td ltx_align_center">48.1</td>
<td id="A6.T10.1.10.3" class="ltx_td ltx_align_center">49.9</td>
<td id="A6.T10.1.10.4" class="ltx_td ltx_align_center">87.1</td>
<td id="A6.T10.1.10.5" class="ltx_td ltx_align_center">77.5</td>
<td id="A6.T10.1.10.6" class="ltx_td ltx_align_center">90.2</td>
<td id="A6.T10.1.10.7" class="ltx_td ltx_align_center">90.6</td>
</tr>
<tr id="A6.T10.1.11" class="ltx_tr">
<td id="A6.T10.1.11.1" class="ltx_td ltx_align_center">Metal_nut</td>
<td id="A6.T10.1.11.2" class="ltx_td ltx_align_center">87.7</td>
<td id="A6.T10.1.11.3" class="ltx_td ltx_align_center">89.2</td>
<td id="A6.T10.1.11.4" class="ltx_td ltx_align_center">99.3</td>
<td id="A6.T10.1.11.5" class="ltx_td ltx_align_center">91.9</td>
<td id="A6.T10.1.11.6" class="ltx_td ltx_align_center">96.3</td>
<td id="A6.T10.1.11.7" class="ltx_td ltx_align_center">98.5</td>
</tr>
<tr id="A6.T10.1.12" class="ltx_tr">
<td id="A6.T10.1.12.1" class="ltx_td ltx_align_center">Screw</td>
<td id="A6.T10.1.12.2" class="ltx_td ltx_align_center">91.4</td>
<td id="A6.T10.1.12.3" class="ltx_td ltx_align_center">86.6</td>
<td id="A6.T10.1.12.4" class="ltx_td ltx_align_center">93.1</td>
<td id="A6.T10.1.12.5" class="ltx_td ltx_align_center">93.6</td>
<td id="A6.T10.1.12.6" class="ltx_td ltx_align_center">96.2</td>
<td id="A6.T10.1.12.7" class="ltx_td ltx_align_center">92.5</td>
</tr>
<tr id="A6.T10.1.13" class="ltx_tr">
<td id="A6.T10.1.13.1" class="ltx_td ltx_align_center">Toothbrush</td>
<td id="A6.T10.1.13.2" class="ltx_td ltx_align_center">90.7</td>
<td id="A6.T10.1.13.3" class="ltx_td ltx_align_center">96.0</td>
<td id="A6.T10.1.13.4" class="ltx_td ltx_align_center">95.6</td>
<td id="A6.T10.1.13.5" class="ltx_td ltx_align_center">71.5</td>
<td id="A6.T10.1.13.6" class="ltx_td ltx_align_center">90.4</td>
<td id="A6.T10.1.13.7" class="ltx_td ltx_align_center">93.7</td>
</tr>
<tr id="A6.T10.1.14" class="ltx_tr">
<td id="A6.T10.1.14.1" class="ltx_td ltx_align_center">Zipper</td>
<td id="A6.T10.1.14.2" class="ltx_td ltx_align_center">87.4</td>
<td id="A6.T10.1.14.3" class="ltx_td ltx_align_center">73.9</td>
<td id="A6.T10.1.14.4" class="ltx_td ltx_align_center">97.5</td>
<td id="A6.T10.1.14.5" class="ltx_td ltx_align_center">97.1</td>
<td id="A6.T10.1.14.6" class="ltx_td ltx_align_center">99.7</td>
<td id="A6.T10.1.14.7" class="ltx_td ltx_align_center">99.6</td>
</tr>
<tr id="A6.T10.1.15" class="ltx_tr">
<td id="A6.T10.1.15.1" class="ltx_td ltx_align_center">Tile</td>
<td id="A6.T10.1.15.2" class="ltx_td ltx_align_center">95.9</td>
<td id="A6.T10.1.15.3" class="ltx_td ltx_align_center">96.2</td>
<td id="A6.T10.1.15.4" class="ltx_td ltx_align_center">100.0</td>
<td id="A6.T10.1.15.5" class="ltx_td ltx_align_center">100.0</td>
<td id="A6.T10.1.15.6" class="ltx_td ltx_align_center">99.9</td>
<td id="A6.T10.1.15.7" class="ltx_td ltx_align_center">100.0</td>
</tr>
<tr id="A6.T10.1.16" class="ltx_tr">
<td id="A6.T10.1.16.1" class="ltx_td ltx_align_center">Wood</td>
<td id="A6.T10.1.16.2" class="ltx_td ltx_align_center">97.9</td>
<td id="A6.T10.1.16.3" class="ltx_td ltx_align_center">98.3</td>
<td id="A6.T10.1.16.4" class="ltx_td ltx_align_center">99.8</td>
<td id="A6.T10.1.16.5" class="ltx_td ltx_align_center">99.7</td>
<td id="A6.T10.1.16.6" class="ltx_td ltx_align_center">99.4</td>
<td id="A6.T10.1.16.7" class="ltx_td ltx_align_center">99.2</td>
</tr>
<tr id="A6.T10.1.17" class="ltx_tr">
<td id="A6.T10.1.17.1" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">Mean</td>
<td id="A6.T10.1.17.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">87.6</td>
<td id="A6.T10.1.17.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">86.4</td>
<td id="A6.T10.1.17.4" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">96.5</td>
<td id="A6.T10.1.17.5" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">93.5</td>
<td id="A6.T10.1.17.6" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">94.8</td>
<td id="A6.T10.1.17.7" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">96.2</td>
</tr>
</table>
</figure>
<figure id="A6.T11" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 11: </span>Fine-grained data-subset-wise performance comparison (AUROC) for anomaly segmentation on VisA.</figcaption>
<table id="A6.T11.1" class="ltx_tabular ltx_centering ltx_align_middle">
<tr id="A6.T11.1.1" class="ltx_tr">
<td id="A6.T11.1.1.1" class="ltx_td ltx_align_center ltx_border_tt"><span id="A6.T11.1.1.1.1" class="ltx_text ltx_font_bold">Object name</span></td>
<td id="A6.T11.1.1.2" class="ltx_td ltx_align_center ltx_border_tt">CLIP</td>
<td id="A6.T11.1.1.3" class="ltx_td ltx_align_center ltx_border_tt">CLIP-AC</td>
<td id="A6.T11.1.1.4" class="ltx_td ltx_align_center ltx_border_tt">WinCLIP</td>
<td id="A6.T11.1.1.5" class="ltx_td ltx_align_center ltx_border_tt">VAND</td>
<td id="A6.T11.1.1.6" class="ltx_td ltx_align_center ltx_border_tt">CoOp</td>
<td id="A6.T11.1.1.7" class="ltx_td ltx_align_center ltx_border_tt">AnomalyCLIP</td>
</tr>
<tr id="A6.T11.1.2" class="ltx_tr">
<td id="A6.T11.1.2.1" class="ltx_td ltx_align_center ltx_border_t">Candle</td>
<td id="A6.T11.1.2.2" class="ltx_td ltx_align_center ltx_border_t">33.6</td>
<td id="A6.T11.1.2.3" class="ltx_td ltx_align_center ltx_border_t">50.0</td>
<td id="A6.T11.1.2.4" class="ltx_td ltx_align_center ltx_border_t">88.9</td>
<td id="A6.T11.1.2.5" class="ltx_td ltx_align_center ltx_border_t">97.8</td>
<td id="A6.T11.1.2.6" class="ltx_td ltx_align_center ltx_border_t">16.3</td>
<td id="A6.T11.1.2.7" class="ltx_td ltx_align_center ltx_border_t">98.8</td>
</tr>
<tr id="A6.T11.1.3" class="ltx_tr">
<td id="A6.T11.1.3.1" class="ltx_td ltx_align_center">Capsules</td>
<td id="A6.T11.1.3.2" class="ltx_td ltx_align_center">56.8</td>
<td id="A6.T11.1.3.3" class="ltx_td ltx_align_center">61.5</td>
<td id="A6.T11.1.3.4" class="ltx_td ltx_align_center">81.6</td>
<td id="A6.T11.1.3.5" class="ltx_td ltx_align_center">97.5</td>
<td id="A6.T11.1.3.6" class="ltx_td ltx_align_center">47.5</td>
<td id="A6.T11.1.3.7" class="ltx_td ltx_align_center">95.0</td>
</tr>
<tr id="A6.T11.1.4" class="ltx_tr">
<td id="A6.T11.1.4.1" class="ltx_td ltx_align_center">Cashew</td>
<td id="A6.T11.1.4.2" class="ltx_td ltx_align_center">64.5</td>
<td id="A6.T11.1.4.3" class="ltx_td ltx_align_center">62.5</td>
<td id="A6.T11.1.4.4" class="ltx_td ltx_align_center">84.7</td>
<td id="A6.T11.1.4.5" class="ltx_td ltx_align_center">86.0</td>
<td id="A6.T11.1.4.6" class="ltx_td ltx_align_center">32.5</td>
<td id="A6.T11.1.4.7" class="ltx_td ltx_align_center">93.8</td>
</tr>
<tr id="A6.T11.1.5" class="ltx_tr">
<td id="A6.T11.1.5.1" class="ltx_td ltx_align_center">Chewinggum</td>
<td id="A6.T11.1.5.2" class="ltx_td ltx_align_center">43.0</td>
<td id="A6.T11.1.5.3" class="ltx_td ltx_align_center">56.5</td>
<td id="A6.T11.1.5.4" class="ltx_td ltx_align_center">93.3</td>
<td id="A6.T11.1.5.5" class="ltx_td ltx_align_center">99.5</td>
<td id="A6.T11.1.5.6" class="ltx_td ltx_align_center">3.4</td>
<td id="A6.T11.1.5.7" class="ltx_td ltx_align_center">99.3</td>
</tr>
<tr id="A6.T11.1.6" class="ltx_tr">
<td id="A6.T11.1.6.1" class="ltx_td ltx_align_center">Fryum</td>
<td id="A6.T11.1.6.2" class="ltx_td ltx_align_center">45.6</td>
<td id="A6.T11.1.6.3" class="ltx_td ltx_align_center">62.7</td>
<td id="A6.T11.1.6.4" class="ltx_td ltx_align_center">88.5</td>
<td id="A6.T11.1.6.5" class="ltx_td ltx_align_center">92.0</td>
<td id="A6.T11.1.6.6" class="ltx_td ltx_align_center">21.7</td>
<td id="A6.T11.1.6.7" class="ltx_td ltx_align_center">94.6</td>
</tr>
<tr id="A6.T11.1.7" class="ltx_tr">
<td id="A6.T11.1.7.1" class="ltx_td ltx_align_center">Macaroni1</td>
<td id="A6.T11.1.7.2" class="ltx_td ltx_align_center">20.3</td>
<td id="A6.T11.1.7.3" class="ltx_td ltx_align_center">22.9</td>
<td id="A6.T11.1.7.4" class="ltx_td ltx_align_center">70.9</td>
<td id="A6.T11.1.7.5" class="ltx_td ltx_align_center">98.8</td>
<td id="A6.T11.1.7.6" class="ltx_td ltx_align_center">36.8</td>
<td id="A6.T11.1.7.7" class="ltx_td ltx_align_center">98.3</td>
</tr>
<tr id="A6.T11.1.8" class="ltx_tr">
<td id="A6.T11.1.8.1" class="ltx_td ltx_align_center">Macaroni2</td>
<td id="A6.T11.1.8.2" class="ltx_td ltx_align_center">37.7</td>
<td id="A6.T11.1.8.3" class="ltx_td ltx_align_center">28.8</td>
<td id="A6.T11.1.8.4" class="ltx_td ltx_align_center">59.3</td>
<td id="A6.T11.1.8.5" class="ltx_td ltx_align_center">97.8</td>
<td id="A6.T11.1.8.6" class="ltx_td ltx_align_center">27.5</td>
<td id="A6.T11.1.8.7" class="ltx_td ltx_align_center">97.6</td>
</tr>
<tr id="A6.T11.1.9" class="ltx_tr">
<td id="A6.T11.1.9.1" class="ltx_td ltx_align_center">Pcb1</td>
<td id="A6.T11.1.9.2" class="ltx_td ltx_align_center">57.8</td>
<td id="A6.T11.1.9.3" class="ltx_td ltx_align_center">51.6</td>
<td id="A6.T11.1.9.4" class="ltx_td ltx_align_center">61.2</td>
<td id="A6.T11.1.9.5" class="ltx_td ltx_align_center">92.7</td>
<td id="A6.T11.1.9.6" class="ltx_td ltx_align_center">19.8</td>
<td id="A6.T11.1.9.7" class="ltx_td ltx_align_center">94.1</td>
</tr>
<tr id="A6.T11.1.10" class="ltx_tr">
<td id="A6.T11.1.10.1" class="ltx_td ltx_align_center">Pcb2</td>
<td id="A6.T11.1.10.2" class="ltx_td ltx_align_center">34.7</td>
<td id="A6.T11.1.10.3" class="ltx_td ltx_align_center">38.4</td>
<td id="A6.T11.1.10.4" class="ltx_td ltx_align_center">71.6</td>
<td id="A6.T11.1.10.5" class="ltx_td ltx_align_center">89.7</td>
<td id="A6.T11.1.10.6" class="ltx_td ltx_align_center">22.9</td>
<td id="A6.T11.1.10.7" class="ltx_td ltx_align_center">92.4</td>
</tr>
<tr id="A6.T11.1.11" class="ltx_tr">
<td id="A6.T11.1.11.1" class="ltx_td ltx_align_center">Pcb3</td>
<td id="A6.T11.1.11.2" class="ltx_td ltx_align_center">54.6</td>
<td id="A6.T11.1.11.3" class="ltx_td ltx_align_center">44.6</td>
<td id="A6.T11.1.11.4" class="ltx_td ltx_align_center">85.3</td>
<td id="A6.T11.1.11.5" class="ltx_td ltx_align_center">88.4</td>
<td id="A6.T11.1.11.6" class="ltx_td ltx_align_center">18.0</td>
<td id="A6.T11.1.11.7" class="ltx_td ltx_align_center">88.4</td>
</tr>
<tr id="A6.T11.1.12" class="ltx_tr">
<td id="A6.T11.1.12.1" class="ltx_td ltx_align_center">Pcb4</td>
<td id="A6.T11.1.12.2" class="ltx_td ltx_align_center">52.1</td>
<td id="A6.T11.1.12.3" class="ltx_td ltx_align_center">49.9</td>
<td id="A6.T11.1.12.4" class="ltx_td ltx_align_center">94.4</td>
<td id="A6.T11.1.12.5" class="ltx_td ltx_align_center">94.6</td>
<td id="A6.T11.1.12.6" class="ltx_td ltx_align_center">14.0</td>
<td id="A6.T11.1.12.7" class="ltx_td ltx_align_center">95.7</td>
</tr>
<tr id="A6.T11.1.13" class="ltx_tr">
<td id="A6.T11.1.13.1" class="ltx_td ltx_align_center">Pipe_fryum</td>
<td id="A6.T11.1.13.2" class="ltx_td ltx_align_center">58.7</td>
<td id="A6.T11.1.13.3" class="ltx_td ltx_align_center">44.7</td>
<td id="A6.T11.1.13.4" class="ltx_td ltx_align_center">75.4</td>
<td id="A6.T11.1.13.5" class="ltx_td ltx_align_center">96.0</td>
<td id="A6.T11.1.13.6" class="ltx_td ltx_align_center">29.2</td>
<td id="A6.T11.1.13.7" class="ltx_td ltx_align_center">98.2</td>
</tr>
<tr id="A6.T11.1.14" class="ltx_tr">
<td id="A6.T11.1.14.1" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">Mean</td>
<td id="A6.T11.1.14.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">46.6</td>
<td id="A6.T11.1.14.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">47.8</td>
<td id="A6.T11.1.14.4" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">79.6</td>
<td id="A6.T11.1.14.5" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">94.2</td>
<td id="A6.T11.1.14.6" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">24.2</td>
<td id="A6.T11.1.14.7" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">95.5</td>
</tr>
</table>
</figure>
<figure id="A6.T12" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 12: </span>Fine-grained data-subset-wise performance comparison (PRO) for anomaly segmentation on VisA.</figcaption>
<table id="A6.T12.1" class="ltx_tabular ltx_centering ltx_align_middle">
<tr id="A6.T12.1.1" class="ltx_tr">
<td id="A6.T12.1.1.1" class="ltx_td ltx_align_center ltx_border_tt"><span id="A6.T12.1.1.1.1" class="ltx_text ltx_font_bold">Object name</span></td>
<td id="A6.T12.1.1.2" class="ltx_td ltx_align_center ltx_border_tt">CLIP</td>
<td id="A6.T12.1.1.3" class="ltx_td ltx_align_center ltx_border_tt">CLIP-AC</td>
<td id="A6.T12.1.1.4" class="ltx_td ltx_align_center ltx_border_tt">WinCLIP</td>
<td id="A6.T12.1.1.5" class="ltx_td ltx_align_center ltx_border_tt">VAND</td>
<td id="A6.T12.1.1.6" class="ltx_td ltx_align_center ltx_border_tt">CoOp</td>
<td id="A6.T12.1.1.7" class="ltx_td ltx_align_center ltx_border_tt">AnomalyCLIP</td>
</tr>
<tr id="A6.T12.1.2" class="ltx_tr">
<td id="A6.T12.1.2.1" class="ltx_td ltx_align_center ltx_border_t">Candle</td>
<td id="A6.T12.1.2.2" class="ltx_td ltx_align_center ltx_border_t">3.6</td>
<td id="A6.T12.1.2.3" class="ltx_td ltx_align_center ltx_border_t">6.0</td>
<td id="A6.T12.1.2.4" class="ltx_td ltx_align_center ltx_border_t">83.5</td>
<td id="A6.T12.1.2.5" class="ltx_td ltx_align_center ltx_border_t">92.5</td>
<td id="A6.T12.1.2.6" class="ltx_td ltx_align_center ltx_border_t">1.1</td>
<td id="A6.T12.1.2.7" class="ltx_td ltx_align_center ltx_border_t">96.2</td>
</tr>
<tr id="A6.T12.1.3" class="ltx_tr">
<td id="A6.T12.1.3.1" class="ltx_td ltx_align_center">Capsules</td>
<td id="A6.T12.1.3.2" class="ltx_td ltx_align_center">15.8</td>
<td id="A6.T12.1.3.3" class="ltx_td ltx_align_center">22.4</td>
<td id="A6.T12.1.3.4" class="ltx_td ltx_align_center">35.3</td>
<td id="A6.T12.1.3.5" class="ltx_td ltx_align_center">86.7</td>
<td id="A6.T12.1.3.6" class="ltx_td ltx_align_center">18.4</td>
<td id="A6.T12.1.3.7" class="ltx_td ltx_align_center">78.5</td>
</tr>
<tr id="A6.T12.1.4" class="ltx_tr">
<td id="A6.T12.1.4.1" class="ltx_td ltx_align_center">Cashew</td>
<td id="A6.T12.1.4.2" class="ltx_td ltx_align_center">9.6</td>
<td id="A6.T12.1.4.3" class="ltx_td ltx_align_center">10.9</td>
<td id="A6.T12.1.4.4" class="ltx_td ltx_align_center">76.4</td>
<td id="A6.T12.1.4.5" class="ltx_td ltx_align_center">91.7</td>
<td id="A6.T12.1.4.6" class="ltx_td ltx_align_center">1.7</td>
<td id="A6.T12.1.4.7" class="ltx_td ltx_align_center">91.6</td>
</tr>
<tr id="A6.T12.1.5" class="ltx_tr">
<td id="A6.T12.1.5.1" class="ltx_td ltx_align_center">Chewinggum</td>
<td id="A6.T12.1.5.2" class="ltx_td ltx_align_center">17.8</td>
<td id="A6.T12.1.5.3" class="ltx_td ltx_align_center">30.2</td>
<td id="A6.T12.1.5.4" class="ltx_td ltx_align_center">70.4</td>
<td id="A6.T12.1.5.5" class="ltx_td ltx_align_center">87.3</td>
<td id="A6.T12.1.5.6" class="ltx_td ltx_align_center">0.1</td>
<td id="A6.T12.1.5.7" class="ltx_td ltx_align_center">91.2</td>
</tr>
<tr id="A6.T12.1.6" class="ltx_tr">
<td id="A6.T12.1.6.1" class="ltx_td ltx_align_center">Fryum</td>
<td id="A6.T12.1.6.2" class="ltx_td ltx_align_center">12.1</td>
<td id="A6.T12.1.6.3" class="ltx_td ltx_align_center">29.3</td>
<td id="A6.T12.1.6.4" class="ltx_td ltx_align_center">77.4</td>
<td id="A6.T12.1.6.5" class="ltx_td ltx_align_center">89.7</td>
<td id="A6.T12.1.6.6" class="ltx_td ltx_align_center">2.6</td>
<td id="A6.T12.1.6.7" class="ltx_td ltx_align_center">86.8</td>
</tr>
<tr id="A6.T12.1.7" class="ltx_tr">
<td id="A6.T12.1.7.1" class="ltx_td ltx_align_center">Macaroni1</td>
<td id="A6.T12.1.7.2" class="ltx_td ltx_align_center">8.1</td>
<td id="A6.T12.1.7.3" class="ltx_td ltx_align_center">13.4</td>
<td id="A6.T12.1.7.4" class="ltx_td ltx_align_center">34.3</td>
<td id="A6.T12.1.7.5" class="ltx_td ltx_align_center">93.2</td>
<td id="A6.T12.1.7.6" class="ltx_td ltx_align_center">18.1</td>
<td id="A6.T12.1.7.7" class="ltx_td ltx_align_center">89.8</td>
</tr>
<tr id="A6.T12.1.8" class="ltx_tr">
<td id="A6.T12.1.8.1" class="ltx_td ltx_align_center">Macaroni2</td>
<td id="A6.T12.1.8.2" class="ltx_td ltx_align_center">20.9</td>
<td id="A6.T12.1.8.3" class="ltx_td ltx_align_center">18.4</td>
<td id="A6.T12.1.8.4" class="ltx_td ltx_align_center">21.4</td>
<td id="A6.T12.1.8.5" class="ltx_td ltx_align_center">82.3</td>
<td id="A6.T12.1.8.6" class="ltx_td ltx_align_center">2.7</td>
<td id="A6.T12.1.8.7" class="ltx_td ltx_align_center">84.2</td>
</tr>
<tr id="A6.T12.1.9" class="ltx_tr">
<td id="A6.T12.1.9.1" class="ltx_td ltx_align_center">Pcb1</td>
<td id="A6.T12.1.9.2" class="ltx_td ltx_align_center">11.7</td>
<td id="A6.T12.1.9.3" class="ltx_td ltx_align_center">12.5</td>
<td id="A6.T12.1.9.4" class="ltx_td ltx_align_center">26.3</td>
<td id="A6.T12.1.9.5" class="ltx_td ltx_align_center">87.5</td>
<td id="A6.T12.1.9.6" class="ltx_td ltx_align_center">0.1</td>
<td id="A6.T12.1.9.7" class="ltx_td ltx_align_center">81.7</td>
</tr>
<tr id="A6.T12.1.10" class="ltx_tr">
<td id="A6.T12.1.10.1" class="ltx_td ltx_align_center">Pcb2</td>
<td id="A6.T12.1.10.2" class="ltx_td ltx_align_center">12.8</td>
<td id="A6.T12.1.10.3" class="ltx_td ltx_align_center">13.9</td>
<td id="A6.T12.1.10.4" class="ltx_td ltx_align_center">37.2</td>
<td id="A6.T12.1.10.5" class="ltx_td ltx_align_center">75.6</td>
<td id="A6.T12.1.10.6" class="ltx_td ltx_align_center">0.7</td>
<td id="A6.T12.1.10.7" class="ltx_td ltx_align_center">78.9</td>
</tr>
<tr id="A6.T12.1.11" class="ltx_tr">
<td id="A6.T12.1.11.1" class="ltx_td ltx_align_center">Pcb3</td>
<td id="A6.T12.1.11.2" class="ltx_td ltx_align_center">31.7</td>
<td id="A6.T12.1.11.3" class="ltx_td ltx_align_center">23.6</td>
<td id="A6.T12.1.11.4" class="ltx_td ltx_align_center">56.1</td>
<td id="A6.T12.1.11.5" class="ltx_td ltx_align_center">77.8</td>
<td id="A6.T12.1.11.6" class="ltx_td ltx_align_center">0.0</td>
<td id="A6.T12.1.11.7" class="ltx_td ltx_align_center">77.1</td>
</tr>
<tr id="A6.T12.1.12" class="ltx_tr">
<td id="A6.T12.1.12.1" class="ltx_td ltx_align_center">Pcb4</td>
<td id="A6.T12.1.12.2" class="ltx_td ltx_align_center">17.1</td>
<td id="A6.T12.1.12.3" class="ltx_td ltx_align_center">20.3</td>
<td id="A6.T12.1.12.4" class="ltx_td ltx_align_center">80.4</td>
<td id="A6.T12.1.12.5" class="ltx_td ltx_align_center">86.8</td>
<td id="A6.T12.1.12.6" class="ltx_td ltx_align_center">0.0</td>
<td id="A6.T12.1.12.7" class="ltx_td ltx_align_center">91.3</td>
</tr>
<tr id="A6.T12.1.13" class="ltx_tr">
<td id="A6.T12.1.13.1" class="ltx_td ltx_align_center">Pipe_fryum</td>
<td id="A6.T12.1.13.2" class="ltx_td ltx_align_center">16.7</td>
<td id="A6.T12.1.13.3" class="ltx_td ltx_align_center">6.0</td>
<td id="A6.T12.1.13.4" class="ltx_td ltx_align_center">82.3</td>
<td id="A6.T12.1.13.5" class="ltx_td ltx_align_center">90.9</td>
<td id="A6.T12.1.13.6" class="ltx_td ltx_align_center">0.6</td>
<td id="A6.T12.1.13.7" class="ltx_td ltx_align_center">96.8</td>
</tr>
<tr id="A6.T12.1.14" class="ltx_tr">
<td id="A6.T12.1.14.1" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">Mean</td>
<td id="A6.T12.1.14.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">14.8</td>
<td id="A6.T12.1.14.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">17.3</td>
<td id="A6.T12.1.14.4" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">56.8</td>
<td id="A6.T12.1.14.5" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">86.8</td>
<td id="A6.T12.1.14.6" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">3.8</td>
<td id="A6.T12.1.14.7" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">87.0</td>
</tr>
</table>
</figure>
<figure id="A6.T13" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 13: </span>Fine-grained data-subset-wise performance comparison (AUROC) for anomaly classification on VisA.</figcaption>
<table id="A6.T13.1" class="ltx_tabular ltx_centering ltx_align_middle">
<tr id="A6.T13.1.1" class="ltx_tr">
<td id="A6.T13.1.1.1" class="ltx_td ltx_align_center ltx_border_tt"><span id="A6.T13.1.1.1.1" class="ltx_text ltx_font_bold">Object name</span></td>
<td id="A6.T13.1.1.2" class="ltx_td ltx_align_center ltx_border_tt">CLIP</td>
<td id="A6.T13.1.1.3" class="ltx_td ltx_align_center ltx_border_tt">CLIP-AC</td>
<td id="A6.T13.1.1.4" class="ltx_td ltx_align_center ltx_border_tt">WinCLIP</td>
<td id="A6.T13.1.1.5" class="ltx_td ltx_align_center ltx_border_tt">VAND</td>
<td id="A6.T13.1.1.6" class="ltx_td ltx_align_center ltx_border_tt">CoOp</td>
<td id="A6.T13.1.1.7" class="ltx_td ltx_align_center ltx_border_tt">AnomalyCLIP</td>
</tr>
<tr id="A6.T13.1.2" class="ltx_tr">
<td id="A6.T13.1.2.1" class="ltx_td ltx_align_center ltx_border_t">Candle</td>
<td id="A6.T13.1.2.2" class="ltx_td ltx_align_center ltx_border_t">37.9</td>
<td id="A6.T13.1.2.3" class="ltx_td ltx_align_center ltx_border_t">33.0</td>
<td id="A6.T13.1.2.4" class="ltx_td ltx_align_center ltx_border_t">95.4</td>
<td id="A6.T13.1.2.5" class="ltx_td ltx_align_center ltx_border_t">83.8</td>
<td id="A6.T13.1.2.6" class="ltx_td ltx_align_center ltx_border_t">46.2</td>
<td id="A6.T13.1.2.7" class="ltx_td ltx_align_center ltx_border_t">79.3</td>
</tr>
<tr id="A6.T13.1.3" class="ltx_tr">
<td id="A6.T13.1.3.1" class="ltx_td ltx_align_center">Capsules</td>
<td id="A6.T13.1.3.2" class="ltx_td ltx_align_center">69.7</td>
<td id="A6.T13.1.3.3" class="ltx_td ltx_align_center">75.3</td>
<td id="A6.T13.1.3.4" class="ltx_td ltx_align_center">85.0</td>
<td id="A6.T13.1.3.5" class="ltx_td ltx_align_center">61.2</td>
<td id="A6.T13.1.3.6" class="ltx_td ltx_align_center">77.2</td>
<td id="A6.T13.1.3.7" class="ltx_td ltx_align_center">81.5</td>
</tr>
<tr id="A6.T13.1.4" class="ltx_tr">
<td id="A6.T13.1.4.1" class="ltx_td ltx_align_center">Cashew</td>
<td id="A6.T13.1.4.2" class="ltx_td ltx_align_center">69.1</td>
<td id="A6.T13.1.4.3" class="ltx_td ltx_align_center">72.7</td>
<td id="A6.T13.1.4.4" class="ltx_td ltx_align_center">92.1</td>
<td id="A6.T13.1.4.5" class="ltx_td ltx_align_center">87.3</td>
<td id="A6.T13.1.4.6" class="ltx_td ltx_align_center">75.7</td>
<td id="A6.T13.1.4.7" class="ltx_td ltx_align_center">76.3</td>
</tr>
<tr id="A6.T13.1.5" class="ltx_tr">
<td id="A6.T13.1.5.1" class="ltx_td ltx_align_center">Chewinggum</td>
<td id="A6.T13.1.5.2" class="ltx_td ltx_align_center">77.5</td>
<td id="A6.T13.1.5.3" class="ltx_td ltx_align_center">76.9</td>
<td id="A6.T13.1.5.4" class="ltx_td ltx_align_center">96.5</td>
<td id="A6.T13.1.5.5" class="ltx_td ltx_align_center">96.4</td>
<td id="A6.T13.1.5.6" class="ltx_td ltx_align_center">84.9</td>
<td id="A6.T13.1.5.7" class="ltx_td ltx_align_center">97.4</td>
</tr>
<tr id="A6.T13.1.6" class="ltx_tr">
<td id="A6.T13.1.6.1" class="ltx_td ltx_align_center">Fryum</td>
<td id="A6.T13.1.6.2" class="ltx_td ltx_align_center">67.2</td>
<td id="A6.T13.1.6.3" class="ltx_td ltx_align_center">60.9</td>
<td id="A6.T13.1.6.4" class="ltx_td ltx_align_center">80.3</td>
<td id="A6.T13.1.6.5" class="ltx_td ltx_align_center">94.3</td>
<td id="A6.T13.1.6.6" class="ltx_td ltx_align_center">80.0</td>
<td id="A6.T13.1.6.7" class="ltx_td ltx_align_center">93.0</td>
</tr>
<tr id="A6.T13.1.7" class="ltx_tr">
<td id="A6.T13.1.7.1" class="ltx_td ltx_align_center">Macaroni1</td>
<td id="A6.T13.1.7.2" class="ltx_td ltx_align_center">64.4</td>
<td id="A6.T13.1.7.3" class="ltx_td ltx_align_center">67.4</td>
<td id="A6.T13.1.7.4" class="ltx_td ltx_align_center">76.2</td>
<td id="A6.T13.1.7.5" class="ltx_td ltx_align_center">71.6</td>
<td id="A6.T13.1.7.6" class="ltx_td ltx_align_center">53.6</td>
<td id="A6.T13.1.7.7" class="ltx_td ltx_align_center">87.2</td>
</tr>
<tr id="A6.T13.1.8" class="ltx_tr">
<td id="A6.T13.1.8.1" class="ltx_td ltx_align_center">Macaroni2</td>
<td id="A6.T13.1.8.2" class="ltx_td ltx_align_center">65</td>
<td id="A6.T13.1.8.3" class="ltx_td ltx_align_center">65.7</td>
<td id="A6.T13.1.8.4" class="ltx_td ltx_align_center">63.7</td>
<td id="A6.T13.1.8.5" class="ltx_td ltx_align_center">64.6</td>
<td id="A6.T13.1.8.6" class="ltx_td ltx_align_center">66.5</td>
<td id="A6.T13.1.8.7" class="ltx_td ltx_align_center">73.4</td>
</tr>
<tr id="A6.T13.1.9" class="ltx_tr">
<td id="A6.T13.1.9.1" class="ltx_td ltx_align_center">Pcb1</td>
<td id="A6.T13.1.9.2" class="ltx_td ltx_align_center">54.9</td>
<td id="A6.T13.1.9.3" class="ltx_td ltx_align_center">43.9</td>
<td id="A6.T13.1.9.4" class="ltx_td ltx_align_center">73.6</td>
<td id="A6.T13.1.9.5" class="ltx_td ltx_align_center">53.4</td>
<td id="A6.T13.1.9.6" class="ltx_td ltx_align_center">24.7</td>
<td id="A6.T13.1.9.7" class="ltx_td ltx_align_center">85.4</td>
</tr>
<tr id="A6.T13.1.10" class="ltx_tr">
<td id="A6.T13.1.10.1" class="ltx_td ltx_align_center">Pcb2</td>
<td id="A6.T13.1.10.2" class="ltx_td ltx_align_center">62.6</td>
<td id="A6.T13.1.10.3" class="ltx_td ltx_align_center">59.5</td>
<td id="A6.T13.1.10.4" class="ltx_td ltx_align_center">51.2</td>
<td id="A6.T13.1.10.5" class="ltx_td ltx_align_center">71.8</td>
<td id="A6.T13.1.10.6" class="ltx_td ltx_align_center">44.6</td>
<td id="A6.T13.1.10.7" class="ltx_td ltx_align_center">62.2</td>
</tr>
<tr id="A6.T13.1.11" class="ltx_tr">
<td id="A6.T13.1.11.1" class="ltx_td ltx_align_center">Pcb3</td>
<td id="A6.T13.1.11.2" class="ltx_td ltx_align_center">52.2</td>
<td id="A6.T13.1.11.3" class="ltx_td ltx_align_center">49.0</td>
<td id="A6.T13.1.11.4" class="ltx_td ltx_align_center">73.4</td>
<td id="A6.T13.1.11.5" class="ltx_td ltx_align_center">66.8</td>
<td id="A6.T13.1.11.6" class="ltx_td ltx_align_center">54.4</td>
<td id="A6.T13.1.11.7" class="ltx_td ltx_align_center">62.7</td>
</tr>
<tr id="A6.T13.1.12" class="ltx_tr">
<td id="A6.T13.1.12.1" class="ltx_td ltx_align_center">Pcb4</td>
<td id="A6.T13.1.12.2" class="ltx_td ltx_align_center">87.7</td>
<td id="A6.T13.1.12.3" class="ltx_td ltx_align_center">89.0</td>
<td id="A6.T13.1.12.4" class="ltx_td ltx_align_center">79.6</td>
<td id="A6.T13.1.12.5" class="ltx_td ltx_align_center">95.0</td>
<td id="A6.T13.1.12.6" class="ltx_td ltx_align_center">66.0</td>
<td id="A6.T13.1.12.7" class="ltx_td ltx_align_center">93.9</td>
</tr>
<tr id="A6.T13.1.13" class="ltx_tr">
<td id="A6.T13.1.13.1" class="ltx_td ltx_align_center">Pipe_fryum</td>
<td id="A6.T13.1.13.2" class="ltx_td ltx_align_center">88.8</td>
<td id="A6.T13.1.13.3" class="ltx_td ltx_align_center">86.4</td>
<td id="A6.T13.1.13.4" class="ltx_td ltx_align_center">69.7</td>
<td id="A6.T13.1.13.5" class="ltx_td ltx_align_center">89.9</td>
<td id="A6.T13.1.13.6" class="ltx_td ltx_align_center">80.1</td>
<td id="A6.T13.1.13.7" class="ltx_td ltx_align_center">92.4</td>
</tr>
<tr id="A6.T13.1.14" class="ltx_tr">
<td id="A6.T13.1.14.1" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">Mean</td>
<td id="A6.T13.1.14.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">66.4</td>
<td id="A6.T13.1.14.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">65.0</td>
<td id="A6.T13.1.14.4" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">78.1</td>
<td id="A6.T13.1.14.5" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">78.0</td>
<td id="A6.T13.1.14.6" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">62.8</td>
<td id="A6.T13.1.14.7" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">82.1</td>
</tr>
</table>
</figure>
<figure id="A6.T14" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 14: </span>Fine-grained data-subset-wise performance comparison (AP) for anomaly classification on VisA.</figcaption>
<table id="A6.T14.1" class="ltx_tabular ltx_centering ltx_align_middle">
<tr id="A6.T14.1.1" class="ltx_tr">
<td id="A6.T14.1.1.1" class="ltx_td ltx_align_center ltx_border_tt"><span id="A6.T14.1.1.1.1" class="ltx_text ltx_font_bold">Object name</span></td>
<td id="A6.T14.1.1.2" class="ltx_td ltx_align_center ltx_border_tt">CLIP</td>
<td id="A6.T14.1.1.3" class="ltx_td ltx_align_center ltx_border_tt">CLIP-AC</td>
<td id="A6.T14.1.1.4" class="ltx_td ltx_align_center ltx_border_tt">WinCLIP</td>
<td id="A6.T14.1.1.5" class="ltx_td ltx_align_center ltx_border_tt">VAND</td>
<td id="A6.T14.1.1.6" class="ltx_td ltx_align_center ltx_border_tt">CoOp</td>
<td id="A6.T14.1.1.7" class="ltx_td ltx_align_center ltx_border_tt">AnomalyCLIP</td>
</tr>
<tr id="A6.T14.1.2" class="ltx_tr">
<td id="A6.T14.1.2.1" class="ltx_td ltx_align_center ltx_border_t">Candle</td>
<td id="A6.T14.1.2.2" class="ltx_td ltx_align_center ltx_border_t">42.9</td>
<td id="A6.T14.1.2.3" class="ltx_td ltx_align_center ltx_border_t">40.0</td>
<td id="A6.T14.1.2.4" class="ltx_td ltx_align_center ltx_border_t">95.8</td>
<td id="A6.T14.1.2.5" class="ltx_td ltx_align_center ltx_border_t">86.9</td>
<td id="A6.T14.1.2.6" class="ltx_td ltx_align_center ltx_border_t">52.9</td>
<td id="A6.T14.1.2.7" class="ltx_td ltx_align_center ltx_border_t">81.1</td>
</tr>
<tr id="A6.T14.1.3" class="ltx_tr">
<td id="A6.T14.1.3.1" class="ltx_td ltx_align_center">Capsules</td>
<td id="A6.T14.1.3.2" class="ltx_td ltx_align_center">81.0</td>
<td id="A6.T14.1.3.3" class="ltx_td ltx_align_center">84.3</td>
<td id="A6.T14.1.3.4" class="ltx_td ltx_align_center">90.9</td>
<td id="A6.T14.1.3.5" class="ltx_td ltx_align_center">74.3</td>
<td id="A6.T14.1.3.6" class="ltx_td ltx_align_center">85.3</td>
<td id="A6.T14.1.3.7" class="ltx_td ltx_align_center">88.7</td>
</tr>
<tr id="A6.T14.1.4" class="ltx_tr">
<td id="A6.T14.1.4.1" class="ltx_td ltx_align_center">Cashew</td>
<td id="A6.T14.1.4.2" class="ltx_td ltx_align_center">83.4</td>
<td id="A6.T14.1.4.3" class="ltx_td ltx_align_center">86.1</td>
<td id="A6.T14.1.4.4" class="ltx_td ltx_align_center">96.4</td>
<td id="A6.T14.1.4.5" class="ltx_td ltx_align_center">94.1</td>
<td id="A6.T14.1.4.6" class="ltx_td ltx_align_center">87.1</td>
<td id="A6.T14.1.4.7" class="ltx_td ltx_align_center">89.4</td>
</tr>
<tr id="A6.T14.1.5" class="ltx_tr">
<td id="A6.T14.1.5.1" class="ltx_td ltx_align_center">Chewinggum</td>
<td id="A6.T14.1.5.2" class="ltx_td ltx_align_center">90.4</td>
<td id="A6.T14.1.5.3" class="ltx_td ltx_align_center">90.2</td>
<td id="A6.T14.1.5.4" class="ltx_td ltx_align_center">98.6</td>
<td id="A6.T14.1.5.5" class="ltx_td ltx_align_center">98.4</td>
<td id="A6.T14.1.5.6" class="ltx_td ltx_align_center">93.1</td>
<td id="A6.T14.1.5.7" class="ltx_td ltx_align_center">98.9</td>
</tr>
<tr id="A6.T14.1.6" class="ltx_tr">
<td id="A6.T14.1.6.1" class="ltx_td ltx_align_center">Fryum</td>
<td id="A6.T14.1.6.2" class="ltx_td ltx_align_center">82.0</td>
<td id="A6.T14.1.6.3" class="ltx_td ltx_align_center">76.6</td>
<td id="A6.T14.1.6.4" class="ltx_td ltx_align_center">90.1</td>
<td id="A6.T14.1.6.5" class="ltx_td ltx_align_center">97.2</td>
<td id="A6.T14.1.6.6" class="ltx_td ltx_align_center">90.2</td>
<td id="A6.T14.1.6.7" class="ltx_td ltx_align_center">96.8</td>
</tr>
<tr id="A6.T14.1.7" class="ltx_tr">
<td id="A6.T14.1.7.1" class="ltx_td ltx_align_center">Macaroni1</td>
<td id="A6.T14.1.7.2" class="ltx_td ltx_align_center">56.8</td>
<td id="A6.T14.1.7.3" class="ltx_td ltx_align_center">58.7</td>
<td id="A6.T14.1.7.4" class="ltx_td ltx_align_center">75.8</td>
<td id="A6.T14.1.7.5" class="ltx_td ltx_align_center">70.9</td>
<td id="A6.T14.1.7.6" class="ltx_td ltx_align_center">52.3</td>
<td id="A6.T14.1.7.7" class="ltx_td ltx_align_center">86.0</td>
</tr>
<tr id="A6.T14.1.8" class="ltx_tr">
<td id="A6.T14.1.8.1" class="ltx_td ltx_align_center">Macaroni2</td>
<td id="A6.T14.1.8.2" class="ltx_td ltx_align_center">65.0</td>
<td id="A6.T14.1.8.3" class="ltx_td ltx_align_center">65.8</td>
<td id="A6.T14.1.8.4" class="ltx_td ltx_align_center">60.3</td>
<td id="A6.T14.1.8.5" class="ltx_td ltx_align_center">63.2</td>
<td id="A6.T14.1.8.6" class="ltx_td ltx_align_center">62.2</td>
<td id="A6.T14.1.8.7" class="ltx_td ltx_align_center">72.1</td>
</tr>
<tr id="A6.T14.1.9" class="ltx_tr">
<td id="A6.T14.1.9.1" class="ltx_td ltx_align_center">Pcb1</td>
<td id="A6.T14.1.9.2" class="ltx_td ltx_align_center">56.9</td>
<td id="A6.T14.1.9.3" class="ltx_td ltx_align_center">48.4</td>
<td id="A6.T14.1.9.4" class="ltx_td ltx_align_center">78.4</td>
<td id="A6.T14.1.9.5" class="ltx_td ltx_align_center">57.2</td>
<td id="A6.T14.1.9.6" class="ltx_td ltx_align_center">36.0</td>
<td id="A6.T14.1.9.7" class="ltx_td ltx_align_center">87.0</td>
</tr>
<tr id="A6.T14.1.10" class="ltx_tr">
<td id="A6.T14.1.10.1" class="ltx_td ltx_align_center">Pcb2</td>
<td id="A6.T14.1.10.2" class="ltx_td ltx_align_center">63.2</td>
<td id="A6.T14.1.10.3" class="ltx_td ltx_align_center">59.8</td>
<td id="A6.T14.1.10.4" class="ltx_td ltx_align_center">49.2</td>
<td id="A6.T14.1.10.5" class="ltx_td ltx_align_center">73.8</td>
<td id="A6.T14.1.10.6" class="ltx_td ltx_align_center">47.3</td>
<td id="A6.T14.1.10.7" class="ltx_td ltx_align_center">64.3</td>
</tr>
<tr id="A6.T14.1.11" class="ltx_tr">
<td id="A6.T14.1.11.1" class="ltx_td ltx_align_center">Pcb3</td>
<td id="A6.T14.1.11.2" class="ltx_td ltx_align_center">53.0</td>
<td id="A6.T14.1.11.3" class="ltx_td ltx_align_center">47.6</td>
<td id="A6.T14.1.11.4" class="ltx_td ltx_align_center">76.5</td>
<td id="A6.T14.1.11.5" class="ltx_td ltx_align_center">70.7</td>
<td id="A6.T14.1.11.6" class="ltx_td ltx_align_center">54.8</td>
<td id="A6.T14.1.11.7" class="ltx_td ltx_align_center">70.0</td>
</tr>
<tr id="A6.T14.1.12" class="ltx_tr">
<td id="A6.T14.1.12.1" class="ltx_td ltx_align_center">Pcb4</td>
<td id="A6.T14.1.12.2" class="ltx_td ltx_align_center">88.0</td>
<td id="A6.T14.1.12.3" class="ltx_td ltx_align_center">90.6</td>
<td id="A6.T14.1.12.4" class="ltx_td ltx_align_center">77.7</td>
<td id="A6.T14.1.12.5" class="ltx_td ltx_align_center">95.1</td>
<td id="A6.T14.1.12.6" class="ltx_td ltx_align_center">66.3</td>
<td id="A6.T14.1.12.7" class="ltx_td ltx_align_center">94.4</td>
</tr>
<tr id="A6.T14.1.13" class="ltx_tr">
<td id="A6.T14.1.13.1" class="ltx_td ltx_align_center">Pipe_fryum</td>
<td id="A6.T14.1.13.2" class="ltx_td ltx_align_center">94.6</td>
<td id="A6.T14.1.13.3" class="ltx_td ltx_align_center">93.7</td>
<td id="A6.T14.1.13.4" class="ltx_td ltx_align_center">82.3</td>
<td id="A6.T14.1.13.5" class="ltx_td ltx_align_center">94.8</td>
<td id="A6.T14.1.13.6" class="ltx_td ltx_align_center">89.7</td>
<td id="A6.T14.1.13.7" class="ltx_td ltx_align_center">96.3</td>
</tr>
<tr id="A6.T14.1.14" class="ltx_tr">
<td id="A6.T14.1.14.1" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">Mean</td>
<td id="A6.T14.1.14.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">71.5</td>
<td id="A6.T14.1.14.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">70.1</td>
<td id="A6.T14.1.14.4" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">81.2</td>
<td id="A6.T14.1.14.5" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">81.4</td>
<td id="A6.T14.1.14.6" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">68.1</td>
<td id="A6.T14.1.14.7" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">85.4</td>
</tr>
</table>
</figure>
<figure id="A6.T15" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 15: </span>Fine-grained data-subset-wise performance comparison (AUROC) for anomaly segmentation on MPDD.</figcaption>
<table id="A6.T15.1" class="ltx_tabular ltx_centering ltx_align_middle">
<tr id="A6.T15.1.1" class="ltx_tr">
<td id="A6.T15.1.1.1" class="ltx_td ltx_align_center ltx_border_tt"><span id="A6.T15.1.1.1.1" class="ltx_text ltx_font_bold">Object name</span></td>
<td id="A6.T15.1.1.2" class="ltx_td ltx_align_center ltx_border_tt">CLIP</td>
<td id="A6.T15.1.1.3" class="ltx_td ltx_align_center ltx_border_tt">CLIP-AC</td>
<td id="A6.T15.1.1.4" class="ltx_td ltx_align_center ltx_border_tt">WinCLIP</td>
<td id="A6.T15.1.1.5" class="ltx_td ltx_align_center ltx_border_tt">VAND</td>
<td id="A6.T15.1.1.6" class="ltx_td ltx_align_center ltx_border_tt">CoOp</td>
<td id="A6.T15.1.1.7" class="ltx_td ltx_align_center ltx_border_tt">AnomalyCLIP</td>
</tr>
<tr id="A6.T15.1.2" class="ltx_tr">
<td id="A6.T15.1.2.1" class="ltx_td ltx_align_center ltx_border_t">Bracket_black</td>
<td id="A6.T15.1.2.2" class="ltx_td ltx_align_center ltx_border_t">85.3</td>
<td id="A6.T15.1.2.3" class="ltx_td ltx_align_center ltx_border_t">86.4</td>
<td id="A6.T15.1.2.4" class="ltx_td ltx_align_center ltx_border_t">57.8</td>
<td id="A6.T15.1.2.5" class="ltx_td ltx_align_center ltx_border_t">96.3</td>
<td id="A6.T15.1.2.6" class="ltx_td ltx_align_center ltx_border_t">9.3</td>
<td id="A6.T15.1.2.7" class="ltx_td ltx_align_center ltx_border_t">95.7</td>
</tr>
<tr id="A6.T15.1.3" class="ltx_tr">
<td id="A6.T15.1.3.1" class="ltx_td ltx_align_center">Bracket_brown</td>
<td id="A6.T15.1.3.2" class="ltx_td ltx_align_center">26.9</td>
<td id="A6.T15.1.3.3" class="ltx_td ltx_align_center">31.5</td>
<td id="A6.T15.1.3.4" class="ltx_td ltx_align_center">72.2</td>
<td id="A6.T15.1.3.5" class="ltx_td ltx_align_center">86.2</td>
<td id="A6.T15.1.3.6" class="ltx_td ltx_align_center">20.2</td>
<td id="A6.T15.1.3.7" class="ltx_td ltx_align_center">94.4</td>
</tr>
<tr id="A6.T15.1.4" class="ltx_tr">
<td id="A6.T15.1.4.1" class="ltx_td ltx_align_center">Bracket_white</td>
<td id="A6.T15.1.4.2" class="ltx_td ltx_align_center">83.5</td>
<td id="A6.T15.1.4.3" class="ltx_td ltx_align_center">77.4</td>
<td id="A6.T15.1.4.4" class="ltx_td ltx_align_center">79.5</td>
<td id="A6.T15.1.4.5" class="ltx_td ltx_align_center">99.0</td>
<td id="A6.T15.1.4.6" class="ltx_td ltx_align_center">8.3</td>
<td id="A6.T15.1.4.7" class="ltx_td ltx_align_center">99.8</td>
</tr>
<tr id="A6.T15.1.5" class="ltx_tr">
<td id="A6.T15.1.5.1" class="ltx_td ltx_align_center">Connector</td>
<td id="A6.T15.1.5.2" class="ltx_td ltx_align_center">56.5</td>
<td id="A6.T15.1.5.3" class="ltx_td ltx_align_center">52.9</td>
<td id="A6.T15.1.5.4" class="ltx_td ltx_align_center">79.0</td>
<td id="A6.T15.1.5.5" class="ltx_td ltx_align_center">90.6</td>
<td id="A6.T15.1.5.6" class="ltx_td ltx_align_center">7.6</td>
<td id="A6.T15.1.5.7" class="ltx_td ltx_align_center">97.2</td>
</tr>
<tr id="A6.T15.1.6" class="ltx_tr">
<td id="A6.T15.1.6.1" class="ltx_td ltx_align_center">Metal_plate</td>
<td id="A6.T15.1.6.2" class="ltx_td ltx_align_center">64.3</td>
<td id="A6.T15.1.6.3" class="ltx_td ltx_align_center">52.5</td>
<td id="A6.T15.1.6.4" class="ltx_td ltx_align_center">92.6</td>
<td id="A6.T15.1.6.5" class="ltx_td ltx_align_center">93.1</td>
<td id="A6.T15.1.6.6" class="ltx_td ltx_align_center">14.1</td>
<td id="A6.T15.1.6.7" class="ltx_td ltx_align_center">93.8</td>
</tr>
<tr id="A6.T15.1.7" class="ltx_tr">
<td id="A6.T15.1.7.1" class="ltx_td ltx_align_center">Tubes</td>
<td id="A6.T15.1.7.2" class="ltx_td ltx_align_center">56.4</td>
<td id="A6.T15.1.7.3" class="ltx_td ltx_align_center">51.5</td>
<td id="A6.T15.1.7.4" class="ltx_td ltx_align_center">77.6</td>
<td id="A6.T15.1.7.5" class="ltx_td ltx_align_center">99.1</td>
<td id="A6.T15.1.7.6" class="ltx_td ltx_align_center">33.2</td>
<td id="A6.T15.1.7.7" class="ltx_td ltx_align_center">98.1</td>
</tr>
<tr id="A6.T15.1.8" class="ltx_tr">
<td id="A6.T15.1.8.1" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">Mean</td>
<td id="A6.T15.1.8.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">62.1</td>
<td id="A6.T15.1.8.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">58.7</td>
<td id="A6.T15.1.8.4" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">76.4</td>
<td id="A6.T15.1.8.5" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">94.1</td>
<td id="A6.T15.1.8.6" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">15.4</td>
<td id="A6.T15.1.8.7" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">96.5</td>
</tr>
</table>
</figure>
<figure id="A6.T16" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 16: </span>Fine-grained data-subset-wise performance comparison (PRO) for anomaly segmentation on MPDD.</figcaption>
<table id="A6.T16.1" class="ltx_tabular ltx_centering ltx_align_middle">
<tr id="A6.T16.1.1" class="ltx_tr">
<td id="A6.T16.1.1.1" class="ltx_td ltx_align_center ltx_border_tt"><span id="A6.T16.1.1.1.1" class="ltx_text ltx_font_bold">Object name</span></td>
<td id="A6.T16.1.1.2" class="ltx_td ltx_align_center ltx_border_tt">CLIP</td>
<td id="A6.T16.1.1.3" class="ltx_td ltx_align_center ltx_border_tt">CLIP-AC</td>
<td id="A6.T16.1.1.4" class="ltx_td ltx_align_center ltx_border_tt">WinCLIP</td>
<td id="A6.T16.1.1.5" class="ltx_td ltx_align_center ltx_border_tt">VAND</td>
<td id="A6.T16.1.1.6" class="ltx_td ltx_align_center ltx_border_tt">CoOp</td>
<td id="A6.T16.1.1.7" class="ltx_td ltx_align_center ltx_border_tt">AnomalyCLIP</td>
</tr>
<tr id="A6.T16.1.2" class="ltx_tr">
<td id="A6.T16.1.2.1" class="ltx_td ltx_align_center ltx_border_t">Bracket_black</td>
<td id="A6.T16.1.2.2" class="ltx_td ltx_align_center ltx_border_t">62.6</td>
<td id="A6.T16.1.2.3" class="ltx_td ltx_align_center ltx_border_t">58.9</td>
<td id="A6.T16.1.2.4" class="ltx_td ltx_align_center ltx_border_t">43</td>
<td id="A6.T16.1.2.5" class="ltx_td ltx_align_center ltx_border_t">89.7</td>
<td id="A6.T16.1.2.6" class="ltx_td ltx_align_center ltx_border_t">1.5</td>
<td id="A6.T16.1.2.7" class="ltx_td ltx_align_center ltx_border_t">85.2</td>
</tr>
<tr id="A6.T16.1.3" class="ltx_tr">
<td id="A6.T16.1.3.1" class="ltx_td ltx_align_center">Bracket_brown</td>
<td id="A6.T16.1.3.2" class="ltx_td ltx_align_center">2.8</td>
<td id="A6.T16.1.3.3" class="ltx_td ltx_align_center">4.0</td>
<td id="A6.T16.1.3.4" class="ltx_td ltx_align_center">25.0</td>
<td id="A6.T16.1.3.5" class="ltx_td ltx_align_center">70.3</td>
<td id="A6.T16.1.3.6" class="ltx_td ltx_align_center">0.4</td>
<td id="A6.T16.1.3.7" class="ltx_td ltx_align_center">77.7</td>
</tr>
<tr id="A6.T16.1.4" class="ltx_tr">
<td id="A6.T16.1.4.1" class="ltx_td ltx_align_center">Bracket_white</td>
<td id="A6.T16.1.4.2" class="ltx_td ltx_align_center">47.9</td>
<td id="A6.T16.1.4.3" class="ltx_td ltx_align_center">41.6</td>
<td id="A6.T16.1.4.4" class="ltx_td ltx_align_center">57.6</td>
<td id="A6.T16.1.4.5" class="ltx_td ltx_align_center">93.1</td>
<td id="A6.T16.1.4.6" class="ltx_td ltx_align_center">0.0</td>
<td id="A6.T16.1.4.7" class="ltx_td ltx_align_center">98.8</td>
</tr>
<tr id="A6.T16.1.5" class="ltx_tr">
<td id="A6.T16.1.5.1" class="ltx_td ltx_align_center">Connector</td>
<td id="A6.T16.1.5.2" class="ltx_td ltx_align_center">22.8</td>
<td id="A6.T16.1.5.3" class="ltx_td ltx_align_center">20.2</td>
<td id="A6.T16.1.5.4" class="ltx_td ltx_align_center">44.6</td>
<td id="A6.T16.1.5.5" class="ltx_td ltx_align_center">74.5</td>
<td id="A6.T16.1.5.6" class="ltx_td ltx_align_center">0.0</td>
<td id="A6.T16.1.5.7" class="ltx_td ltx_align_center">89.8</td>
</tr>
<tr id="A6.T16.1.6" class="ltx_tr">
<td id="A6.T16.1.6.1" class="ltx_td ltx_align_center">Metal_plate</td>
<td id="A6.T16.1.6.2" class="ltx_td ltx_align_center">31.5</td>
<td id="A6.T16.1.6.3" class="ltx_td ltx_align_center">27.0</td>
<td id="A6.T16.1.6.4" class="ltx_td ltx_align_center">78.2</td>
<td id="A6.T16.1.6.5" class="ltx_td ltx_align_center">74.5</td>
<td id="A6.T16.1.6.6" class="ltx_td ltx_align_center">0.2</td>
<td id="A6.T16.1.6.7" class="ltx_td ltx_align_center">86.9</td>
</tr>
<tr id="A6.T16.1.7" class="ltx_tr">
<td id="A6.T16.1.7.1" class="ltx_td ltx_align_center">Tubes</td>
<td id="A6.T16.1.7.2" class="ltx_td ltx_align_center">30.4</td>
<td id="A6.T16.1.7.3" class="ltx_td ltx_align_center">22.9</td>
<td id="A6.T16.1.7.4" class="ltx_td ltx_align_center">44.7</td>
<td id="A6.T16.1.7.5" class="ltx_td ltx_align_center">96.9</td>
<td id="A6.T16.1.7.6" class="ltx_td ltx_align_center">11.5</td>
<td id="A6.T16.1.7.7" class="ltx_td ltx_align_center">93.6</td>
</tr>
<tr id="A6.T16.1.8" class="ltx_tr">
<td id="A6.T16.1.8.1" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">Mean</td>
<td id="A6.T16.1.8.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">33.0</td>
<td id="A6.T16.1.8.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">29.1</td>
<td id="A6.T16.1.8.4" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">48.9</td>
<td id="A6.T16.1.8.5" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">83.2</td>
<td id="A6.T16.1.8.6" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">2.3</td>
<td id="A6.T16.1.8.7" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">88.7</td>
</tr>
</table>
</figure>
<figure id="A6.T17" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 17: </span>Fine-grained data-subset-wise performance comparison (AUROC) for anomaly classification on MPDD.</figcaption>
<table id="A6.T17.1" class="ltx_tabular ltx_centering ltx_align_middle">
<tr id="A6.T17.1.1" class="ltx_tr">
<td id="A6.T17.1.1.1" class="ltx_td ltx_align_center ltx_border_tt"><span id="A6.T17.1.1.1.1" class="ltx_text ltx_font_bold">Object name</span></td>
<td id="A6.T17.1.1.2" class="ltx_td ltx_align_center ltx_border_tt">CLIP</td>
<td id="A6.T17.1.1.3" class="ltx_td ltx_align_center ltx_border_tt">CLIP-AC</td>
<td id="A6.T17.1.1.4" class="ltx_td ltx_align_center ltx_border_tt">WinCLIP</td>
<td id="A6.T17.1.1.5" class="ltx_td ltx_align_center ltx_border_tt">VAND</td>
<td id="A6.T17.1.1.6" class="ltx_td ltx_align_center ltx_border_tt">CoOp</td>
<td id="A6.T17.1.1.7" class="ltx_td ltx_align_center ltx_border_tt">AnomalyCLIP</td>
</tr>
<tr id="A6.T17.1.2" class="ltx_tr">
<td id="A6.T17.1.2.1" class="ltx_td ltx_align_center ltx_border_t">Bracket_black</td>
<td id="A6.T17.1.2.2" class="ltx_td ltx_align_center ltx_border_t">32.4</td>
<td id="A6.T17.1.2.3" class="ltx_td ltx_align_center ltx_border_t">32.8</td>
<td id="A6.T17.1.2.4" class="ltx_td ltx_align_center ltx_border_t">41.5</td>
<td id="A6.T17.1.2.5" class="ltx_td ltx_align_center ltx_border_t">66.1</td>
<td id="A6.T17.1.2.6" class="ltx_td ltx_align_center ltx_border_t">36.9</td>
<td id="A6.T17.1.2.7" class="ltx_td ltx_align_center ltx_border_t">67.3</td>
</tr>
<tr id="A6.T17.1.3" class="ltx_tr">
<td id="A6.T17.1.3.1" class="ltx_td ltx_align_center">Bracket_brown</td>
<td id="A6.T17.1.3.2" class="ltx_td ltx_align_center">50.9</td>
<td id="A6.T17.1.3.3" class="ltx_td ltx_align_center">57.9</td>
<td id="A6.T17.1.3.4" class="ltx_td ltx_align_center">48.6</td>
<td id="A6.T17.1.3.5" class="ltx_td ltx_align_center">64.0</td>
<td id="A6.T17.1.3.6" class="ltx_td ltx_align_center">43.9</td>
<td id="A6.T17.1.3.7" class="ltx_td ltx_align_center">62.2</td>
</tr>
<tr id="A6.T17.1.4" class="ltx_tr">
<td id="A6.T17.1.4.1" class="ltx_td ltx_align_center">Bracket_white</td>
<td id="A6.T17.1.4.2" class="ltx_td ltx_align_center">45.4</td>
<td id="A6.T17.1.4.3" class="ltx_td ltx_align_center">42.6</td>
<td id="A6.T17.1.4.4" class="ltx_td ltx_align_center">40.2</td>
<td id="A6.T17.1.4.5" class="ltx_td ltx_align_center">79.6</td>
<td id="A6.T17.1.4.6" class="ltx_td ltx_align_center">48.9</td>
<td id="A6.T17.1.4.7" class="ltx_td ltx_align_center">64.9</td>
</tr>
<tr id="A6.T17.1.5" class="ltx_tr">
<td id="A6.T17.1.5.1" class="ltx_td ltx_align_center">Connector</td>
<td id="A6.T17.1.5.2" class="ltx_td ltx_align_center">75</td>
<td id="A6.T17.1.5.3" class="ltx_td ltx_align_center">76.2</td>
<td id="A6.T17.1.5.4" class="ltx_td ltx_align_center">79.3</td>
<td id="A6.T17.1.5.5" class="ltx_td ltx_align_center">78.8</td>
<td id="A6.T17.1.5.6" class="ltx_td ltx_align_center">38.3</td>
<td id="A6.T17.1.5.7" class="ltx_td ltx_align_center">86.9</td>
</tr>
<tr id="A6.T17.1.6" class="ltx_tr">
<td id="A6.T17.1.6.1" class="ltx_td ltx_align_center">Metal_plate</td>
<td id="A6.T17.1.6.2" class="ltx_td ltx_align_center">34.9</td>
<td id="A6.T17.1.6.3" class="ltx_td ltx_align_center">54.8</td>
<td id="A6.T17.1.6.4" class="ltx_td ltx_align_center">93.4</td>
<td id="A6.T17.1.6.5" class="ltx_td ltx_align_center">53.8</td>
<td id="A6.T17.1.6.6" class="ltx_td ltx_align_center">77.0</td>
<td id="A6.T17.1.6.7" class="ltx_td ltx_align_center">85.2</td>
</tr>
<tr id="A6.T17.1.7" class="ltx_tr">
<td id="A6.T17.1.7.1" class="ltx_td ltx_align_center">Tubes</td>
<td id="A6.T17.1.7.2" class="ltx_td ltx_align_center">87.3</td>
<td id="A6.T17.1.7.3" class="ltx_td ltx_align_center">72.8</td>
<td id="A6.T17.1.7.4" class="ltx_td ltx_align_center">78.7</td>
<td id="A6.T17.1.7.5" class="ltx_td ltx_align_center">95.9</td>
<td id="A6.T17.1.7.6" class="ltx_td ltx_align_center">85.4</td>
<td id="A6.T17.1.7.7" class="ltx_td ltx_align_center">95.5</td>
</tr>
<tr id="A6.T17.1.8" class="ltx_tr">
<td id="A6.T17.1.8.1" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">Mean</td>
<td id="A6.T17.1.8.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">54.3</td>
<td id="A6.T17.1.8.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">56.2</td>
<td id="A6.T17.1.8.4" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">63.6</td>
<td id="A6.T17.1.8.5" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">73.0</td>
<td id="A6.T17.1.8.6" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">55.1</td>
<td id="A6.T17.1.8.7" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">77.0</td>
</tr>
</table>
</figure>
<figure id="A6.T18" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 18: </span>Fine-grained data-subset-wise performance comparison (AP) for anomaly classification on MPDD.</figcaption>
<table id="A6.T18.1" class="ltx_tabular ltx_centering ltx_align_middle">
<tr id="A6.T18.1.1" class="ltx_tr">
<td id="A6.T18.1.1.1" class="ltx_td ltx_align_center ltx_border_tt"><span id="A6.T18.1.1.1.1" class="ltx_text ltx_font_bold">Object name</span></td>
<td id="A6.T18.1.1.2" class="ltx_td ltx_align_center ltx_border_tt">CLIP</td>
<td id="A6.T18.1.1.3" class="ltx_td ltx_align_center ltx_border_tt">CLIP-AC</td>
<td id="A6.T18.1.1.4" class="ltx_td ltx_align_center ltx_border_tt">WinCLIP</td>
<td id="A6.T18.1.1.5" class="ltx_td ltx_align_center ltx_border_tt">VAND</td>
<td id="A6.T18.1.1.6" class="ltx_td ltx_align_center ltx_border_tt">CoOp</td>
<td id="A6.T18.1.1.7" class="ltx_td ltx_align_center ltx_border_tt">AnomalyCLIP</td>
</tr>
<tr id="A6.T18.1.2" class="ltx_tr">
<td id="A6.T18.1.2.1" class="ltx_td ltx_align_center ltx_border_t">Bracket_black</td>
<td id="A6.T18.1.2.2" class="ltx_td ltx_align_center ltx_border_t">47.8</td>
<td id="A6.T18.1.2.3" class="ltx_td ltx_align_center ltx_border_t">48.6</td>
<td id="A6.T18.1.2.4" class="ltx_td ltx_align_center ltx_border_t">56.9</td>
<td id="A6.T18.1.2.5" class="ltx_td ltx_align_center ltx_border_t">71.7</td>
<td id="A6.T18.1.2.6" class="ltx_td ltx_align_center ltx_border_t">50.0</td>
<td id="A6.T18.1.2.7" class="ltx_td ltx_align_center ltx_border_t">72.9</td>
</tr>
<tr id="A6.T18.1.3" class="ltx_tr">
<td id="A6.T18.1.3.1" class="ltx_td ltx_align_center">Bracket_brown</td>
<td id="A6.T18.1.3.2" class="ltx_td ltx_align_center">66.2</td>
<td id="A6.T18.1.3.3" class="ltx_td ltx_align_center">72.0</td>
<td id="A6.T18.1.3.4" class="ltx_td ltx_align_center">69.5</td>
<td id="A6.T18.1.3.5" class="ltx_td ltx_align_center">79.0</td>
<td id="A6.T18.1.3.6" class="ltx_td ltx_align_center">65.7</td>
<td id="A6.T18.1.3.7" class="ltx_td ltx_align_center">80.8</td>
</tr>
<tr id="A6.T18.1.4" class="ltx_tr">
<td id="A6.T18.1.4.1" class="ltx_td ltx_align_center">Bracket_white</td>
<td id="A6.T18.1.4.2" class="ltx_td ltx_align_center">51.2</td>
<td id="A6.T18.1.4.3" class="ltx_td ltx_align_center">47.3</td>
<td id="A6.T18.1.4.4" class="ltx_td ltx_align_center">45.1</td>
<td id="A6.T18.1.4.5" class="ltx_td ltx_align_center">82.3</td>
<td id="A6.T18.1.4.6" class="ltx_td ltx_align_center">57.5</td>
<td id="A6.T18.1.4.7" class="ltx_td ltx_align_center">68.5</td>
</tr>
<tr id="A6.T18.1.5" class="ltx_tr">
<td id="A6.T18.1.5.1" class="ltx_td ltx_align_center">Connector</td>
<td id="A6.T18.1.5.2" class="ltx_td ltx_align_center">62.2</td>
<td id="A6.T18.1.5.3" class="ltx_td ltx_align_center">61.4</td>
<td id="A6.T18.1.5.4" class="ltx_td ltx_align_center">61.3</td>
<td id="A6.T18.1.5.5" class="ltx_td ltx_align_center">71.8</td>
<td id="A6.T18.1.5.6" class="ltx_td ltx_align_center">26.4</td>
<td id="A6.T18.1.5.7" class="ltx_td ltx_align_center">76.8</td>
</tr>
<tr id="A6.T18.1.6" class="ltx_tr">
<td id="A6.T18.1.6.1" class="ltx_td ltx_align_center">Metal_plate</td>
<td id="A6.T18.1.6.2" class="ltx_td ltx_align_center">70.6</td>
<td id="A6.T18.1.6.3" class="ltx_td ltx_align_center">78.5</td>
<td id="A6.T18.1.6.4" class="ltx_td ltx_align_center">97.6</td>
<td id="A6.T18.1.6.5" class="ltx_td ltx_align_center">78.3</td>
<td id="A6.T18.1.6.6" class="ltx_td ltx_align_center">92.0</td>
<td id="A6.T18.1.6.7" class="ltx_td ltx_align_center">94.7</td>
</tr>
<tr id="A6.T18.1.7" class="ltx_tr">
<td id="A6.T18.1.7.1" class="ltx_td ltx_align_center">Tubes</td>
<td id="A6.T18.1.7.2" class="ltx_td ltx_align_center">94.4</td>
<td id="A6.T18.1.7.3" class="ltx_td ltx_align_center">88.2</td>
<td id="A6.T18.1.7.4" class="ltx_td ltx_align_center">89.1</td>
<td id="A6.T18.1.7.5" class="ltx_td ltx_align_center">98.1</td>
<td id="A6.T18.1.7.6" class="ltx_td ltx_align_center">93.6</td>
<td id="A6.T18.1.7.7" class="ltx_td ltx_align_center">98.1</td>
</tr>
<tr id="A6.T18.1.8" class="ltx_tr">
<td id="A6.T18.1.8.1" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">Mean</td>
<td id="A6.T18.1.8.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">65.4</td>
<td id="A6.T18.1.8.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">66.0</td>
<td id="A6.T18.1.8.4" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">69.9</td>
<td id="A6.T18.1.8.5" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">80.2</td>
<td id="A6.T18.1.8.6" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">64.2</td>
<td id="A6.T18.1.8.7" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">82.0</td>
</tr>
</table>
</figure>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2310.18960" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2310.18961" class="ar5iv-text-button ar5iv-severity-error">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2310.18961">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2310.18961" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2310.18962" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Tue Feb 27 21:37:41 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
