<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2303.14386] ​​Prompt-Guided Transformers for End-to-End Open-Vocabulary Object Detection​​</title><meta property="og:description" content="Prompt-OVD is an efficient and effective framework for open-vocabulary object detection that utilizes class embeddings from CLIP as prompts, guiding the Transformer decoder to detect objects in both base and novel clas…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="​​Prompt-Guided Transformers for End-to-End Open-Vocabulary Object Detection​​">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="​​Prompt-Guided Transformers for End-to-End Open-Vocabulary Object Detection​​">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2303.14386">

<!--Generated on Thu Feb 29 17:17:35 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">​​Prompt-Guided Transformers for End-to-End Open-Vocabulary Object Detection​​</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Hwanjun Song   
<br class="ltx_break">AWS AI Labs
<br class="ltx_break"><span id="id1.1.id1" class="ltx_text ltx_font_typewriter" style="font-size:90%;">hwanjuns@amazon.com</span>
</span><span class="ltx_author_notes">Hwanjun and Jihwan contributed equally and this work was done while working at NAVER AI Lab.Hwanjun is also the corresponding author (hwanjuns@amazon.com).</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Jihwan Bang <span id="footnotex1" class="ltx_note ltx_role_footnotemark"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_note_type">footnotemark: </span><span class="ltx_tag ltx_tag_note">1</span></span></span></span>
<br class="ltx_break">NAVER Cloud
<br class="ltx_break"><span id="id2.1.id1" class="ltx_text ltx_font_typewriter" style="font-size:90%;">jihwan.bang@navercorp.com</span>
</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id3.id1" class="ltx_p">Prompt-OVD is an efficient and effective framework for open-vocabulary object detection that utilizes class embeddings from CLIP as prompts, guiding the Transformer decoder to detect objects in both base and novel classes. Additionally, our novel RoI-based masked attention and RoI pruning techniques help leverage the zero-shot classification ability of the Vision Transformer-based CLIP, resulting in improved detection performance at minimal computational cost. Our experiments on the OV-COCO and OV-LVIS datasets demonstrate that Prompt-OVD achieves an impressive 21.2 times faster inference speed than the first end-to-end open-vocabulary detection method (OV-DETR), while also achieving higher APs than four two-stage-based methods operating within similar inference time ranges. Code will be made available soon.</p>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Object detection is one of crucial tasks for real-world computer vision applications, which localizes and detects visible objects from the scenes <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>, <a href="#bib.bib19" title="" class="ltx_ref">19</a>, <a href="#bib.bib20" title="" class="ltx_ref">20</a>, <a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite>. Recently, the development of visual language models has enabled significant progress towards open-vocabulary object detection (OVD), which can detect novel classes that were <em id="S1.p1.1.1" class="ltx_emph ltx_font_italic">not</em> visible during training <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>, <a href="#bib.bib29" title="" class="ltx_ref">29</a>, <a href="#bib.bib31" title="" class="ltx_ref">31</a>]</cite>. The large visual language models like CLIP <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite> help recognize the concept of common objects using their image-text aligned embeddings. Therefore, it offers a more practical and effective detection pipeline by eliminating the need of re-training object detectors on newly collected data.</p>
</div>
<figure id="S1.F1" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><img src="/html/2303.14386/assets/x1.png" id="S1.F1.1.g1" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" width="453" height="124" alt="Refer to caption"></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p id="S1.F1.3" class="ltx_p ltx_figure_panel"><span id="S1.F1.3.1" class="ltx_text" style="font-size:90%;">(a) OV-DETR.</span>                                              <span id="S1.F1.3.2" class="ltx_text" style="font-size:90%;">(b) Prompt-OVD (Ours).</span></p>
</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S1.F1.4.1.1" class="ltx_text" style="font-size:90%;">Figure 1</span>: </span><span id="S1.F1.5.2" class="ltx_text" style="font-size:90%;">Architectural comparison: (a) OV-DETR needs linearly increasing number of object queries with respect to the number of classes and (b) Prompt-OVD maintains a constant number of object queries by using class prompts.</span></figcaption>
</figure>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">Most OVD approaches heavily rely on the region proposal network (RPN), which can easily overfit to base classes <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>, <a href="#bib.bib31" title="" class="ltx_ref">31</a>]</cite>, and several approaches have extended it to leverage external data to mitigate this limitation <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>, <a href="#bib.bib22" title="" class="ltx_ref">22</a>, <a href="#bib.bib32" title="" class="ltx_ref">32</a>]</cite>. On the other hand, OV-DETR <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite> proposes a Transformer-based framework with conditional matching, which has two advantages over RPN-based methods.
First, it has the potential to localize novel objects better than the RPN by inject <em id="S1.p2.1.1" class="ltx_emph ltx_font_italic">class-specific</em> knowledge, i.e., the addition of CLIP embeddings to the object queries as in Figure <a href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ ​​Prompt-Guided Transformers for End-to-End Open-Vocabulary Object Detection​​" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>(a), to the Transformer decoder.
Second, it can be trained in an <em id="S1.p2.1.2" class="ltx_emph ltx_font_italic">end-to-end</em> fashion, eliminating the need for handcraft components like anchor generation and non-maximum suppression <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>, <a href="#bib.bib33" title="" class="ltx_ref">33</a>]</cite>. However, the main limitation of OV-DETR is the need for multiple forward passes in the decoder due to its large number of object queries, which results in slow inference speeds that may not be suitable for real-world use cases.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">In this paper, we propose an efficient yet effective end-to-end Transformer-based framework named <span id="S1.p3.1.1" class="ltx_text ltx_font_bold">Prompt-OVD</span>, as shown in Figure <a href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ ​​Prompt-Guided Transformers for End-to-End Open-Vocabulary Object Detection​​" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>(b). Our framework leverages class embeddings from CLIP as <em id="S1.p3.1.2" class="ltx_emph ltx_font_italic">class prompts</em> to the Transformer decoder. Unlike OV-DETR, which forces all object queries to be class-specific by mathematically adding class embeddings, we keep the object queries class-agnostic by prepending the class embeddings as class prompts to the decoder. Hence, we can maintain the <em id="S1.p3.1.3" class="ltx_emph ltx_font_italic">constant</em> number of object queries regardless of increasing number of classes, significantly expediting the inference speed when handling a large number of object classes like LVIS data. In contrast, as shown in Figure <a href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ ​​Prompt-Guided Transformers for End-to-End Open-Vocabulary Object Detection​​" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>(a), OV-DETR needs linearly increasing number of object queries with respect to the number of classes.
The proposed class prompts provide class-specific instruction instantaneously to the decoder on which object classes should be detected. Therefore, the output object embeddings by the decoder can be generalized to classes given by the prompts, resulting in very high recall for box regression on base and novel object classes.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">Furthermore, there is still a significant gap in classification accuracy between base and novel classes in OVD, as only the base classes are visible during the end-to-end training pipeline. To mitigate such gap, we benefit from the zero-shot classification ability of the Vision Transformer (ViT)-based CLIP, and propose two additional techniques to reduce its computational overhead: efficient <em id="S1.p4.1.1" class="ltx_emph ltx_font_italic">RoI-based masked attention</em>, which extracts the CLIP embeddings of the given RoIs with a minimal cost of a single inference path, and <em id="S1.p4.1.2" class="ltx_emph ltx_font_italic">RoI pruning</em>, which selects only the RoIs that have objects with high probability from the entire box predictions. We then ensemble the classification results from the ViT-based CLIP with those from our detection model.</p>
</div>
<div id="S1.p5" class="ltx_para">
<p id="S1.p5.2" class="ltx_p">We conduct comprehensive experiments on two popular OVD datasets, namely OV-COCO <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite> and OV-LVIS <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>, and compare Prompt-OVD with an end-to-end method OV-DETR (baseline), but also four RPN-based two-phase OVD methods. The results demonstrate that Prompt-OVD has an inference speed <em id="S1.p5.2.1" class="ltx_emph ltx_font_italic">21.2 times faster</em> than OV-DETR and similar to that of the existing two-stage methods. Additionally, Prompt-OVD achieves 30.6 <math id="S1.p5.1.m1.1" class="ltx_Math" alttext="\mathrm{AP^{50}}" display="inline"><semantics id="S1.p5.1.m1.1a"><msup id="S1.p5.1.m1.1.1" xref="S1.p5.1.m1.1.1.cmml"><mi id="S1.p5.1.m1.1.1.2" xref="S1.p5.1.m1.1.1.2.cmml">AP</mi><mn id="S1.p5.1.m1.1.1.3" xref="S1.p5.1.m1.1.1.3.cmml">50</mn></msup><annotation-xml encoding="MathML-Content" id="S1.p5.1.m1.1b"><apply id="S1.p5.1.m1.1.1.cmml" xref="S1.p5.1.m1.1.1"><csymbol cd="ambiguous" id="S1.p5.1.m1.1.1.1.cmml" xref="S1.p5.1.m1.1.1">superscript</csymbol><ci id="S1.p5.1.m1.1.1.2.cmml" xref="S1.p5.1.m1.1.1.2">AP</ci><cn type="integer" id="S1.p5.1.m1.1.1.3.cmml" xref="S1.p5.1.m1.1.1.3">50</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p5.1.m1.1c">\mathrm{AP^{50}}</annotation></semantics></math> of novel classes for OV-COCO and 29.4 <math id="S1.p5.2.m2.1" class="ltx_Math" alttext="\mathrm{AP^{box}}" display="inline"><semantics id="S1.p5.2.m2.1a"><msup id="S1.p5.2.m2.1.1" xref="S1.p5.2.m2.1.1.cmml"><mi id="S1.p5.2.m2.1.1.2" xref="S1.p5.2.m2.1.1.2.cmml">AP</mi><mi id="S1.p5.2.m2.1.1.3" xref="S1.p5.2.m2.1.1.3.cmml">box</mi></msup><annotation-xml encoding="MathML-Content" id="S1.p5.2.m2.1b"><apply id="S1.p5.2.m2.1.1.cmml" xref="S1.p5.2.m2.1.1"><csymbol cd="ambiguous" id="S1.p5.2.m2.1.1.1.cmml" xref="S1.p5.2.m2.1.1">superscript</csymbol><ci id="S1.p5.2.m2.1.1.2.cmml" xref="S1.p5.2.m2.1.1.2">AP</ci><ci id="S1.p5.2.m2.1.1.3.cmml" xref="S1.p5.2.m2.1.1.3">box</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p5.2.m2.1c">\mathrm{AP^{box}}</annotation></semantics></math> of novel classes for OV-LVIS. Our contributions are as follows:</p>
<ul id="S1.I1" class="ltx_itemize">
<li id="S1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i1.p1" class="ltx_para">
<p id="S1.I1.i1.p1.1" class="ltx_p">We propose a prompt-based decoding that can keep a constant number of object queries, reducing the computational overhead of the Transformer decoder.</p>
</div>
</li>
<li id="S1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i2.p1" class="ltx_para">
<p id="S1.I1.i2.p1.1" class="ltx_p">We propose RoI-based masked attention and RoI pruning to benefit from a pre-trained ViT-based CLIP at minimal computational cost.</p>
</div>
</li>
<li id="S1.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i3.p1" class="ltx_para">
<p id="S1.I1.i3.p1.1" class="ltx_p">We considerably improve the efficiency and accuracy of the end-to-end Transformer-based detection pipeline for open vocabulary object detection.</p>
</div>
</li>
</ul>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Work</h2>

<div id="S2.p1" class="ltx_para ltx_noindent">
<p id="S2.p1.1" class="ltx_p"><span id="S2.p1.1.1" class="ltx_text ltx_font_bold">Object Detection with Transformers.</span>
Transformers <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib28" title="" class="ltx_ref">28</a>]</cite> have emerged as one of the leading architectures for computer vision. The main advantage of using Transformers is its weaker inductive bias than convolutional neural networks (CNN), leading to the state-of-the-art results in image classification benchmarks <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>, <a href="#bib.bib17" title="" class="ltx_ref">17</a>, <a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>. The use of Transformers has recently been extended to object detection and then rosolved the limitation of modern two-stage object detector like Mask-RCNN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite> and YOLOS <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite>. DETR <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite> eliminates the handcrafted components (e.g., anchor generation
and non-maximum suppression) by combining a CNN backbone and Transformer
encoder-decoders. Deformable DETR <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib33" title="" class="ltx_ref">33</a>]</cite> introduces the notion of deformable attention to leverage multi-scale features as well as accelerating the slow training convergence of DETR. Next, YOLOS <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite> and ViDT <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib27" title="" class="ltx_ref">27</a>]</cite> propose the fully Transformer-based object detection architecture without relying CNNs, proving the potential of ViTs as a generic object detector. In this paper, we present an end-to-end Transformer-based framework for OVD, distinct from the two-stage detectors.</p>
</div>
<div id="S2.p2" class="ltx_para ltx_noindent">
<p id="S2.p2.1" class="ltx_p"><span id="S2.p2.1.1" class="ltx_text ltx_font_bold">Open Vocabulary Object Detection.</span>
Despite significant progress in object detection <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib27" title="" class="ltx_ref">27</a>, <a href="#bib.bib6" title="" class="ltx_ref">6</a>, <a href="#bib.bib11" title="" class="ltx_ref">11</a>, <a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite>, training and scaling these models remains costly due to their closed-set assumption.
To address more object categories, including previously unseen ones, recent advances have leveraged visual language models, e.g., CLIP <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite>, to provide additional supervision for detection models. Their goal is open-vocabulary object detection (OVD), enabling the detection of previously unseen objects at the time of training.</p>
</div>
<div id="S2.p3" class="ltx_para">
<p id="S2.p3.1" class="ltx_p">One widely used approach in OVD is to employ a pre-trained CLIP model. ViLD <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite> first proposes distilling knowledge from CLIP. Furthermore, DetPro <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite> suggests continuously learning prompts based on a pre-trained vision language model, and F-VLM <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite> suggests that freezing CLIP weights as a backbone is more effective for novel object classes. This family of methods follows the pipeline of Mask-RCNN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite>, inheriting the limitations of the two-stage detection model.</p>
</div>
<div id="S2.p4" class="ltx_para">
<p id="S2.p4.1" class="ltx_p">In contrast, OV-DETR <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite> is the first to adopt DETR <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite> for an end-to-end OVD. This involves formulating the learning objective as a binary matching problem between object queries and corresponding objects. However, OV-DETR requires significant computational power compared to Mask-RCNN or other two-stage detection methods. In addition, several approaches <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib31" title="" class="ltx_ref">31</a>, <a href="#bib.bib22" title="" class="ltx_ref">22</a>, <a href="#bib.bib32" title="" class="ltx_ref">32</a>, <a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite> have attempted to relax the problem to an unrestricted setup, which permits the use of external large-scale data that covers most common concepts in the real world, such as CC3M <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite> and ImageNet-21k <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite>. However, comparing these methods with those under the restricted setup that does not allow the use of external data is unfair. It should be noted that our detection framework follows the restricted setup, requiring a stronger zero-shot generalization capability.</p>
</div>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Preliminary</h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.1" class="ltx_p">We briefly overview the pipelines of Transformer-based object detector and ViT-based CLIP.</p>
</div>
<div id="S3.p2" class="ltx_para ltx_noindent">
<p id="S3.p2.2" class="ltx_p"><span id="S3.p2.2.1" class="ltx_text ltx_font_bold">Transformer-based Detector.</span> Detection Transformers (DETR) have replaced the RPN-based two-stage pipeline with a simple Transformer encoder-decoder pipeline <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>, <a href="#bib.bib33" title="" class="ltx_ref">33</a>, <a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>, and its extensions have realized a fully Transformer-based object detector that removes the need for CNN backbones by adopting the pre-trained ViT as its Transformer encoder <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>, <a href="#bib.bib14" title="" class="ltx_ref">14</a>, <a href="#bib.bib27" title="" class="ltx_ref">27</a>]</cite>. For the fully Transformer architecture, the <math id="S3.p2.1.m1.1" class="ltx_Math" alttext="L" display="inline"><semantics id="S3.p2.1.m1.1a"><mi id="S3.p2.1.m1.1.1" xref="S3.p2.1.m1.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S3.p2.1.m1.1b"><ci id="S3.p2.1.m1.1.1.cmml" xref="S3.p2.1.m1.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.1.m1.1c">L</annotation></semantics></math>-layer Transformer encoder receives an image as the input of patch tokens, <math id="S3.p2.2.m2.3" class="ltx_Math" alttext="\mathrm{{I}_{0}=[patch_{1},\dots,patch_{n}]\in{\mathbb{R}^{n\times d}}}" display="inline"><semantics id="S3.p2.2.m2.3a"><mrow id="S3.p2.2.m2.3.3" xref="S3.p2.2.m2.3.3.cmml"><msub id="S3.p2.2.m2.3.3.4" xref="S3.p2.2.m2.3.3.4.cmml"><mi mathvariant="normal" id="S3.p2.2.m2.3.3.4.2" xref="S3.p2.2.m2.3.3.4.2.cmml">I</mi><mn id="S3.p2.2.m2.3.3.4.3" xref="S3.p2.2.m2.3.3.4.3.cmml">0</mn></msub><mo id="S3.p2.2.m2.3.3.5" xref="S3.p2.2.m2.3.3.5.cmml">=</mo><mrow id="S3.p2.2.m2.3.3.2.2" xref="S3.p2.2.m2.3.3.2.3.cmml"><mo stretchy="false" id="S3.p2.2.m2.3.3.2.2.3" xref="S3.p2.2.m2.3.3.2.3.cmml">[</mo><msub id="S3.p2.2.m2.2.2.1.1.1" xref="S3.p2.2.m2.2.2.1.1.1.cmml"><mi id="S3.p2.2.m2.2.2.1.1.1.2" xref="S3.p2.2.m2.2.2.1.1.1.2.cmml">patch</mi><mn id="S3.p2.2.m2.2.2.1.1.1.3" xref="S3.p2.2.m2.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.p2.2.m2.3.3.2.2.4" xref="S3.p2.2.m2.3.3.2.3.cmml">,</mo><mi mathvariant="normal" id="S3.p2.2.m2.1.1" xref="S3.p2.2.m2.1.1.cmml">…</mi><mo id="S3.p2.2.m2.3.3.2.2.5" xref="S3.p2.2.m2.3.3.2.3.cmml">,</mo><msub id="S3.p2.2.m2.3.3.2.2.2" xref="S3.p2.2.m2.3.3.2.2.2.cmml"><mi id="S3.p2.2.m2.3.3.2.2.2.2" xref="S3.p2.2.m2.3.3.2.2.2.2.cmml">patch</mi><mi mathvariant="normal" id="S3.p2.2.m2.3.3.2.2.2.3" xref="S3.p2.2.m2.3.3.2.2.2.3.cmml">n</mi></msub><mo stretchy="false" id="S3.p2.2.m2.3.3.2.2.6" xref="S3.p2.2.m2.3.3.2.3.cmml">]</mo></mrow><mo id="S3.p2.2.m2.3.3.6" xref="S3.p2.2.m2.3.3.6.cmml">∈</mo><msup id="S3.p2.2.m2.3.3.7" xref="S3.p2.2.m2.3.3.7.cmml"><mi id="S3.p2.2.m2.3.3.7.2" xref="S3.p2.2.m2.3.3.7.2.cmml">ℝ</mi><mrow id="S3.p2.2.m2.3.3.7.3" xref="S3.p2.2.m2.3.3.7.3.cmml"><mi mathvariant="normal" id="S3.p2.2.m2.3.3.7.3.2" xref="S3.p2.2.m2.3.3.7.3.2.cmml">n</mi><mo lspace="0.222em" rspace="0.222em" id="S3.p2.2.m2.3.3.7.3.1" xref="S3.p2.2.m2.3.3.7.3.1.cmml">×</mo><mi mathvariant="normal" id="S3.p2.2.m2.3.3.7.3.3" xref="S3.p2.2.m2.3.3.7.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.2.m2.3b"><apply id="S3.p2.2.m2.3.3.cmml" xref="S3.p2.2.m2.3.3"><and id="S3.p2.2.m2.3.3a.cmml" xref="S3.p2.2.m2.3.3"></and><apply id="S3.p2.2.m2.3.3b.cmml" xref="S3.p2.2.m2.3.3"><eq id="S3.p2.2.m2.3.3.5.cmml" xref="S3.p2.2.m2.3.3.5"></eq><apply id="S3.p2.2.m2.3.3.4.cmml" xref="S3.p2.2.m2.3.3.4"><csymbol cd="ambiguous" id="S3.p2.2.m2.3.3.4.1.cmml" xref="S3.p2.2.m2.3.3.4">subscript</csymbol><ci id="S3.p2.2.m2.3.3.4.2.cmml" xref="S3.p2.2.m2.3.3.4.2">I</ci><cn type="integer" id="S3.p2.2.m2.3.3.4.3.cmml" xref="S3.p2.2.m2.3.3.4.3">0</cn></apply><list id="S3.p2.2.m2.3.3.2.3.cmml" xref="S3.p2.2.m2.3.3.2.2"><apply id="S3.p2.2.m2.2.2.1.1.1.cmml" xref="S3.p2.2.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.p2.2.m2.2.2.1.1.1.1.cmml" xref="S3.p2.2.m2.2.2.1.1.1">subscript</csymbol><ci id="S3.p2.2.m2.2.2.1.1.1.2.cmml" xref="S3.p2.2.m2.2.2.1.1.1.2">patch</ci><cn type="integer" id="S3.p2.2.m2.2.2.1.1.1.3.cmml" xref="S3.p2.2.m2.2.2.1.1.1.3">1</cn></apply><ci id="S3.p2.2.m2.1.1.cmml" xref="S3.p2.2.m2.1.1">…</ci><apply id="S3.p2.2.m2.3.3.2.2.2.cmml" xref="S3.p2.2.m2.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.p2.2.m2.3.3.2.2.2.1.cmml" xref="S3.p2.2.m2.3.3.2.2.2">subscript</csymbol><ci id="S3.p2.2.m2.3.3.2.2.2.2.cmml" xref="S3.p2.2.m2.3.3.2.2.2.2">patch</ci><ci id="S3.p2.2.m2.3.3.2.2.2.3.cmml" xref="S3.p2.2.m2.3.3.2.2.2.3">n</ci></apply></list></apply><apply id="S3.p2.2.m2.3.3c.cmml" xref="S3.p2.2.m2.3.3"><in id="S3.p2.2.m2.3.3.6.cmml" xref="S3.p2.2.m2.3.3.6"></in><share href="#S3.p2.2.m2.3.3.2.cmml" id="S3.p2.2.m2.3.3d.cmml" xref="S3.p2.2.m2.3.3"></share><apply id="S3.p2.2.m2.3.3.7.cmml" xref="S3.p2.2.m2.3.3.7"><csymbol cd="ambiguous" id="S3.p2.2.m2.3.3.7.1.cmml" xref="S3.p2.2.m2.3.3.7">superscript</csymbol><ci id="S3.p2.2.m2.3.3.7.2.cmml" xref="S3.p2.2.m2.3.3.7.2">ℝ</ci><apply id="S3.p2.2.m2.3.3.7.3.cmml" xref="S3.p2.2.m2.3.3.7.3"><times id="S3.p2.2.m2.3.3.7.3.1.cmml" xref="S3.p2.2.m2.3.3.7.3.1"></times><ci id="S3.p2.2.m2.3.3.7.3.2.cmml" xref="S3.p2.2.m2.3.3.7.3.2">n</ci><ci id="S3.p2.2.m2.3.3.7.3.3.cmml" xref="S3.p2.2.m2.3.3.7.3.3">d</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.2.m2.3c">\mathrm{{I}_{0}=[patch_{1},\dots,patch_{n}]\in{\mathbb{R}^{n\times d}}}</annotation></semantics></math>, which are progressively calibrated across the layers via self-attention,</p>
<table id="S3.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E1.m1.14" class="ltx_Math" alttext="\begin{gathered}{\rm I}_{L}={\rm Encoder}({\rm I}_{0})\in\mathbb{R}^{n\times d}.\end{gathered}" display="block"><semantics id="S3.E1.m1.14a"><mtable displaystyle="true" id="S3.E1.m1.14.14.2"><mtr id="S3.E1.m1.14.14.2a"><mtd id="S3.E1.m1.14.14.2b"><mrow id="S3.E1.m1.14.14.2.13.13.13.13"><mrow id="S3.E1.m1.14.14.2.13.13.13.13.1"><msub id="S3.E1.m1.14.14.2.13.13.13.13.1.3"><mi mathvariant="normal" id="S3.E1.m1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.cmml">I</mi><mi id="S3.E1.m1.2.2.2.2.2.2.1" xref="S3.E1.m1.2.2.2.2.2.2.1.cmml">L</mi></msub><mo id="S3.E1.m1.3.3.3.3.3.3" xref="S3.E1.m1.3.3.3.3.3.3.cmml">=</mo><mrow id="S3.E1.m1.14.14.2.13.13.13.13.1.1"><mi id="S3.E1.m1.4.4.4.4.4.4" xref="S3.E1.m1.4.4.4.4.4.4.cmml">Encoder</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.14.14.2.13.13.13.13.1.1.2" xref="S3.E1.m1.13.13.1.1.1.cmml">​</mo><mrow id="S3.E1.m1.14.14.2.13.13.13.13.1.1.1.1"><mo stretchy="false" id="S3.E1.m1.5.5.5.5.5.5" xref="S3.E1.m1.13.13.1.1.1.cmml">(</mo><msub id="S3.E1.m1.14.14.2.13.13.13.13.1.1.1.1.1"><mi mathvariant="normal" id="S3.E1.m1.6.6.6.6.6.6" xref="S3.E1.m1.6.6.6.6.6.6.cmml">I</mi><mn id="S3.E1.m1.7.7.7.7.7.7.1" xref="S3.E1.m1.7.7.7.7.7.7.1.cmml">0</mn></msub><mo stretchy="false" id="S3.E1.m1.8.8.8.8.8.8" xref="S3.E1.m1.13.13.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E1.m1.9.9.9.9.9.9" xref="S3.E1.m1.9.9.9.9.9.9.cmml">∈</mo><msup id="S3.E1.m1.14.14.2.13.13.13.13.1.4"><mi id="S3.E1.m1.10.10.10.10.10.10" xref="S3.E1.m1.10.10.10.10.10.10.cmml">ℝ</mi><mrow id="S3.E1.m1.11.11.11.11.11.11.1" xref="S3.E1.m1.11.11.11.11.11.11.1.cmml"><mi id="S3.E1.m1.11.11.11.11.11.11.1.2" xref="S3.E1.m1.11.11.11.11.11.11.1.2.cmml">n</mi><mo lspace="0.222em" rspace="0.222em" id="S3.E1.m1.11.11.11.11.11.11.1.1" xref="S3.E1.m1.11.11.11.11.11.11.1.1.cmml">×</mo><mi id="S3.E1.m1.11.11.11.11.11.11.1.3" xref="S3.E1.m1.11.11.11.11.11.11.1.3.cmml">d</mi></mrow></msup></mrow><mo lspace="0em" id="S3.E1.m1.12.12.12.12.12.12" xref="S3.E1.m1.13.13.1.1.1.cmml">.</mo></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S3.E1.m1.14b"><apply id="S3.E1.m1.13.13.1.1.1.cmml" xref="S3.E1.m1.14.14.2.13.13.13.13.1.1.2"><and id="S3.E1.m1.13.13.1.1.1a.cmml" xref="S3.E1.m1.14.14.2.13.13.13.13.1.1.2"></and><apply id="S3.E1.m1.13.13.1.1.1b.cmml" xref="S3.E1.m1.14.14.2.13.13.13.13.1.1.2"><eq id="S3.E1.m1.3.3.3.3.3.3.cmml" xref="S3.E1.m1.3.3.3.3.3.3"></eq><apply id="S3.E1.m1.13.13.1.1.1.3.cmml" xref="S3.E1.m1.14.14.2.13.13.13.13.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.13.13.1.1.1.3.1.cmml" xref="S3.E1.m1.14.14.2.13.13.13.13.1.1.2">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1">I</ci><ci id="S3.E1.m1.2.2.2.2.2.2.1.cmml" xref="S3.E1.m1.2.2.2.2.2.2.1">𝐿</ci></apply><apply id="S3.E1.m1.13.13.1.1.1.1.cmml" xref="S3.E1.m1.14.14.2.13.13.13.13.1.1.2"><times id="S3.E1.m1.13.13.1.1.1.1.2.cmml" xref="S3.E1.m1.14.14.2.13.13.13.13.1.1.2"></times><ci id="S3.E1.m1.4.4.4.4.4.4.cmml" xref="S3.E1.m1.4.4.4.4.4.4">Encoder</ci><apply id="S3.E1.m1.13.13.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.14.14.2.13.13.13.13.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.13.13.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.14.14.2.13.13.13.13.1.1.2">subscript</csymbol><ci id="S3.E1.m1.6.6.6.6.6.6.cmml" xref="S3.E1.m1.6.6.6.6.6.6">I</ci><cn type="integer" id="S3.E1.m1.7.7.7.7.7.7.1.cmml" xref="S3.E1.m1.7.7.7.7.7.7.1">0</cn></apply></apply></apply><apply id="S3.E1.m1.13.13.1.1.1c.cmml" xref="S3.E1.m1.14.14.2.13.13.13.13.1.1.2"><in id="S3.E1.m1.9.9.9.9.9.9.cmml" xref="S3.E1.m1.9.9.9.9.9.9"></in><share href="#S3.E1.m1.13.13.1.1.1.1.cmml" id="S3.E1.m1.13.13.1.1.1d.cmml" xref="S3.E1.m1.14.14.2.13.13.13.13.1.1.2"></share><apply id="S3.E1.m1.13.13.1.1.1.6.cmml" xref="S3.E1.m1.14.14.2.13.13.13.13.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.13.13.1.1.1.6.1.cmml" xref="S3.E1.m1.14.14.2.13.13.13.13.1.1.2">superscript</csymbol><ci id="S3.E1.m1.10.10.10.10.10.10.cmml" xref="S3.E1.m1.10.10.10.10.10.10">ℝ</ci><apply id="S3.E1.m1.11.11.11.11.11.11.1.cmml" xref="S3.E1.m1.11.11.11.11.11.11.1"><times id="S3.E1.m1.11.11.11.11.11.11.1.1.cmml" xref="S3.E1.m1.11.11.11.11.11.11.1.1"></times><ci id="S3.E1.m1.11.11.11.11.11.11.1.2.cmml" xref="S3.E1.m1.11.11.11.11.11.11.1.2">𝑛</ci><ci id="S3.E1.m1.11.11.11.11.11.11.1.3.cmml" xref="S3.E1.m1.11.11.11.11.11.11.1.3">𝑑</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.14c">\begin{gathered}{\rm I}_{L}={\rm Encoder}({\rm I}_{0})\in\mathbb{R}^{n\times d}.\end{gathered}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S3.p2.5" class="ltx_p">Subsequently, the Transformer decoder receives <em id="S3.p2.5.1" class="ltx_emph ltx_font_italic">object queries</em> <math id="S3.p2.3.m1.3" class="ltx_Math" alttext="{\rm Q}_{0}=[{\rm qeury}_{1},\dots,{\rm qeury}_{m}]\in{\mathbb{R}^{m\times d}}" display="inline"><semantics id="S3.p2.3.m1.3a"><mrow id="S3.p2.3.m1.3.3" xref="S3.p2.3.m1.3.3.cmml"><msub id="S3.p2.3.m1.3.3.4" xref="S3.p2.3.m1.3.3.4.cmml"><mi mathvariant="normal" id="S3.p2.3.m1.3.3.4.2" xref="S3.p2.3.m1.3.3.4.2.cmml">Q</mi><mn id="S3.p2.3.m1.3.3.4.3" xref="S3.p2.3.m1.3.3.4.3.cmml">0</mn></msub><mo id="S3.p2.3.m1.3.3.5" xref="S3.p2.3.m1.3.3.5.cmml">=</mo><mrow id="S3.p2.3.m1.3.3.2.2" xref="S3.p2.3.m1.3.3.2.3.cmml"><mo stretchy="false" id="S3.p2.3.m1.3.3.2.2.3" xref="S3.p2.3.m1.3.3.2.3.cmml">[</mo><msub id="S3.p2.3.m1.2.2.1.1.1" xref="S3.p2.3.m1.2.2.1.1.1.cmml"><mi id="S3.p2.3.m1.2.2.1.1.1.2" xref="S3.p2.3.m1.2.2.1.1.1.2.cmml">qeury</mi><mn id="S3.p2.3.m1.2.2.1.1.1.3" xref="S3.p2.3.m1.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.p2.3.m1.3.3.2.2.4" xref="S3.p2.3.m1.3.3.2.3.cmml">,</mo><mi mathvariant="normal" id="S3.p2.3.m1.1.1" xref="S3.p2.3.m1.1.1.cmml">…</mi><mo id="S3.p2.3.m1.3.3.2.2.5" xref="S3.p2.3.m1.3.3.2.3.cmml">,</mo><msub id="S3.p2.3.m1.3.3.2.2.2" xref="S3.p2.3.m1.3.3.2.2.2.cmml"><mi id="S3.p2.3.m1.3.3.2.2.2.2" xref="S3.p2.3.m1.3.3.2.2.2.2.cmml">qeury</mi><mi id="S3.p2.3.m1.3.3.2.2.2.3" xref="S3.p2.3.m1.3.3.2.2.2.3.cmml">m</mi></msub><mo stretchy="false" id="S3.p2.3.m1.3.3.2.2.6" xref="S3.p2.3.m1.3.3.2.3.cmml">]</mo></mrow><mo id="S3.p2.3.m1.3.3.6" xref="S3.p2.3.m1.3.3.6.cmml">∈</mo><msup id="S3.p2.3.m1.3.3.7" xref="S3.p2.3.m1.3.3.7.cmml"><mi id="S3.p2.3.m1.3.3.7.2" xref="S3.p2.3.m1.3.3.7.2.cmml">ℝ</mi><mrow id="S3.p2.3.m1.3.3.7.3" xref="S3.p2.3.m1.3.3.7.3.cmml"><mi id="S3.p2.3.m1.3.3.7.3.2" xref="S3.p2.3.m1.3.3.7.3.2.cmml">m</mi><mo lspace="0.222em" rspace="0.222em" id="S3.p2.3.m1.3.3.7.3.1" xref="S3.p2.3.m1.3.3.7.3.1.cmml">×</mo><mi id="S3.p2.3.m1.3.3.7.3.3" xref="S3.p2.3.m1.3.3.7.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.3.m1.3b"><apply id="S3.p2.3.m1.3.3.cmml" xref="S3.p2.3.m1.3.3"><and id="S3.p2.3.m1.3.3a.cmml" xref="S3.p2.3.m1.3.3"></and><apply id="S3.p2.3.m1.3.3b.cmml" xref="S3.p2.3.m1.3.3"><eq id="S3.p2.3.m1.3.3.5.cmml" xref="S3.p2.3.m1.3.3.5"></eq><apply id="S3.p2.3.m1.3.3.4.cmml" xref="S3.p2.3.m1.3.3.4"><csymbol cd="ambiguous" id="S3.p2.3.m1.3.3.4.1.cmml" xref="S3.p2.3.m1.3.3.4">subscript</csymbol><ci id="S3.p2.3.m1.3.3.4.2.cmml" xref="S3.p2.3.m1.3.3.4.2">Q</ci><cn type="integer" id="S3.p2.3.m1.3.3.4.3.cmml" xref="S3.p2.3.m1.3.3.4.3">0</cn></apply><list id="S3.p2.3.m1.3.3.2.3.cmml" xref="S3.p2.3.m1.3.3.2.2"><apply id="S3.p2.3.m1.2.2.1.1.1.cmml" xref="S3.p2.3.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.p2.3.m1.2.2.1.1.1.1.cmml" xref="S3.p2.3.m1.2.2.1.1.1">subscript</csymbol><ci id="S3.p2.3.m1.2.2.1.1.1.2.cmml" xref="S3.p2.3.m1.2.2.1.1.1.2">qeury</ci><cn type="integer" id="S3.p2.3.m1.2.2.1.1.1.3.cmml" xref="S3.p2.3.m1.2.2.1.1.1.3">1</cn></apply><ci id="S3.p2.3.m1.1.1.cmml" xref="S3.p2.3.m1.1.1">…</ci><apply id="S3.p2.3.m1.3.3.2.2.2.cmml" xref="S3.p2.3.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.p2.3.m1.3.3.2.2.2.1.cmml" xref="S3.p2.3.m1.3.3.2.2.2">subscript</csymbol><ci id="S3.p2.3.m1.3.3.2.2.2.2.cmml" xref="S3.p2.3.m1.3.3.2.2.2.2">qeury</ci><ci id="S3.p2.3.m1.3.3.2.2.2.3.cmml" xref="S3.p2.3.m1.3.3.2.2.2.3">𝑚</ci></apply></list></apply><apply id="S3.p2.3.m1.3.3c.cmml" xref="S3.p2.3.m1.3.3"><in id="S3.p2.3.m1.3.3.6.cmml" xref="S3.p2.3.m1.3.3.6"></in><share href="#S3.p2.3.m1.3.3.2.cmml" id="S3.p2.3.m1.3.3d.cmml" xref="S3.p2.3.m1.3.3"></share><apply id="S3.p2.3.m1.3.3.7.cmml" xref="S3.p2.3.m1.3.3.7"><csymbol cd="ambiguous" id="S3.p2.3.m1.3.3.7.1.cmml" xref="S3.p2.3.m1.3.3.7">superscript</csymbol><ci id="S3.p2.3.m1.3.3.7.2.cmml" xref="S3.p2.3.m1.3.3.7.2">ℝ</ci><apply id="S3.p2.3.m1.3.3.7.3.cmml" xref="S3.p2.3.m1.3.3.7.3"><times id="S3.p2.3.m1.3.3.7.3.1.cmml" xref="S3.p2.3.m1.3.3.7.3.1"></times><ci id="S3.p2.3.m1.3.3.7.3.2.cmml" xref="S3.p2.3.m1.3.3.7.3.2">𝑚</ci><ci id="S3.p2.3.m1.3.3.7.3.3.cmml" xref="S3.p2.3.m1.3.3.7.3.3">𝑑</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.3.m1.3c">{\rm Q}_{0}=[{\rm qeury}_{1},\dots,{\rm qeury}_{m}]\in{\mathbb{R}^{m\times d}}</annotation></semantics></math> that aggregate the key contents from the encoder output <math id="S3.p2.4.m2.1" class="ltx_Math" alttext="\mathrm{I}_{L}" display="inline"><semantics id="S3.p2.4.m2.1a"><msub id="S3.p2.4.m2.1.1" xref="S3.p2.4.m2.1.1.cmml"><mi mathvariant="normal" id="S3.p2.4.m2.1.1.2" xref="S3.p2.4.m2.1.1.2.cmml">I</mi><mi id="S3.p2.4.m2.1.1.3" xref="S3.p2.4.m2.1.1.3.cmml">L</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p2.4.m2.1b"><apply id="S3.p2.4.m2.1.1.cmml" xref="S3.p2.4.m2.1.1"><csymbol cd="ambiguous" id="S3.p2.4.m2.1.1.1.cmml" xref="S3.p2.4.m2.1.1">subscript</csymbol><ci id="S3.p2.4.m2.1.1.2.cmml" xref="S3.p2.4.m2.1.1.2">I</ci><ci id="S3.p2.4.m2.1.1.3.cmml" xref="S3.p2.4.m2.1.1.3">𝐿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.4.m2.1c">\mathrm{I}_{L}</annotation></semantics></math> to produce <math id="S3.p2.5.m3.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S3.p2.5.m3.1a"><mi id="S3.p2.5.m3.1.1" xref="S3.p2.5.m3.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S3.p2.5.m3.1b"><ci id="S3.p2.5.m3.1.1.cmml" xref="S3.p2.5.m3.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.5.m3.1c">m</annotation></semantics></math> different object embeddings via alternating self-attention and cross-attention,</p>
<table id="S3.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E2.m1.1" class="ltx_Math" alttext="\mathrm{{O}}_{L}={\rm Decoder}({\rm Q}_{0},{\rm I}_{L})\in\mathbb{R}^{m\times d}." display="block"><semantics id="S3.E2.m1.1a"><mrow id="S3.E2.m1.1.1.1" xref="S3.E2.m1.1.1.1.1.cmml"><mrow id="S3.E2.m1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.cmml"><msub id="S3.E2.m1.1.1.1.1.4" xref="S3.E2.m1.1.1.1.1.4.cmml"><mi mathvariant="normal" id="S3.E2.m1.1.1.1.1.4.2" xref="S3.E2.m1.1.1.1.1.4.2.cmml">O</mi><mi id="S3.E2.m1.1.1.1.1.4.3" xref="S3.E2.m1.1.1.1.1.4.3.cmml">L</mi></msub><mo id="S3.E2.m1.1.1.1.1.5" xref="S3.E2.m1.1.1.1.1.5.cmml">=</mo><mrow id="S3.E2.m1.1.1.1.1.2" xref="S3.E2.m1.1.1.1.1.2.cmml"><mi id="S3.E2.m1.1.1.1.1.2.4" xref="S3.E2.m1.1.1.1.1.2.4.cmml">Decoder</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.1.1.1.1.2.3" xref="S3.E2.m1.1.1.1.1.2.3.cmml">​</mo><mrow id="S3.E2.m1.1.1.1.1.2.2.2" xref="S3.E2.m1.1.1.1.1.2.2.3.cmml"><mo stretchy="false" id="S3.E2.m1.1.1.1.1.2.2.2.3" xref="S3.E2.m1.1.1.1.1.2.2.3.cmml">(</mo><msub id="S3.E2.m1.1.1.1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.1.1.1.cmml"><mi mathvariant="normal" id="S3.E2.m1.1.1.1.1.1.1.1.1.2" xref="S3.E2.m1.1.1.1.1.1.1.1.1.2.cmml">Q</mi><mn id="S3.E2.m1.1.1.1.1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.1.1.1.1.3.cmml">0</mn></msub><mo id="S3.E2.m1.1.1.1.1.2.2.2.4" xref="S3.E2.m1.1.1.1.1.2.2.3.cmml">,</mo><msub id="S3.E2.m1.1.1.1.1.2.2.2.2" xref="S3.E2.m1.1.1.1.1.2.2.2.2.cmml"><mi mathvariant="normal" id="S3.E2.m1.1.1.1.1.2.2.2.2.2" xref="S3.E2.m1.1.1.1.1.2.2.2.2.2.cmml">I</mi><mi id="S3.E2.m1.1.1.1.1.2.2.2.2.3" xref="S3.E2.m1.1.1.1.1.2.2.2.2.3.cmml">L</mi></msub><mo stretchy="false" id="S3.E2.m1.1.1.1.1.2.2.2.5" xref="S3.E2.m1.1.1.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo id="S3.E2.m1.1.1.1.1.6" xref="S3.E2.m1.1.1.1.1.6.cmml">∈</mo><msup id="S3.E2.m1.1.1.1.1.7" xref="S3.E2.m1.1.1.1.1.7.cmml"><mi id="S3.E2.m1.1.1.1.1.7.2" xref="S3.E2.m1.1.1.1.1.7.2.cmml">ℝ</mi><mrow id="S3.E2.m1.1.1.1.1.7.3" xref="S3.E2.m1.1.1.1.1.7.3.cmml"><mi id="S3.E2.m1.1.1.1.1.7.3.2" xref="S3.E2.m1.1.1.1.1.7.3.2.cmml">m</mi><mo lspace="0.222em" rspace="0.222em" id="S3.E2.m1.1.1.1.1.7.3.1" xref="S3.E2.m1.1.1.1.1.7.3.1.cmml">×</mo><mi id="S3.E2.m1.1.1.1.1.7.3.3" xref="S3.E2.m1.1.1.1.1.7.3.3.cmml">d</mi></mrow></msup></mrow><mo lspace="0em" id="S3.E2.m1.1.1.1.2" xref="S3.E2.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.1b"><apply id="S3.E2.m1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1"><and id="S3.E2.m1.1.1.1.1a.cmml" xref="S3.E2.m1.1.1.1"></and><apply id="S3.E2.m1.1.1.1.1b.cmml" xref="S3.E2.m1.1.1.1"><eq id="S3.E2.m1.1.1.1.1.5.cmml" xref="S3.E2.m1.1.1.1.1.5"></eq><apply id="S3.E2.m1.1.1.1.1.4.cmml" xref="S3.E2.m1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.4.1.cmml" xref="S3.E2.m1.1.1.1.1.4">subscript</csymbol><ci id="S3.E2.m1.1.1.1.1.4.2.cmml" xref="S3.E2.m1.1.1.1.1.4.2">O</ci><ci id="S3.E2.m1.1.1.1.1.4.3.cmml" xref="S3.E2.m1.1.1.1.1.4.3">𝐿</ci></apply><apply id="S3.E2.m1.1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.1.2"><times id="S3.E2.m1.1.1.1.1.2.3.cmml" xref="S3.E2.m1.1.1.1.1.2.3"></times><ci id="S3.E2.m1.1.1.1.1.2.4.cmml" xref="S3.E2.m1.1.1.1.1.2.4">Decoder</ci><interval closure="open" id="S3.E2.m1.1.1.1.1.2.2.3.cmml" xref="S3.E2.m1.1.1.1.1.2.2.2"><apply id="S3.E2.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E2.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.2">Q</ci><cn type="integer" id="S3.E2.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.3">0</cn></apply><apply id="S3.E2.m1.1.1.1.1.2.2.2.2.cmml" xref="S3.E2.m1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.2.2.2.2.1.cmml" xref="S3.E2.m1.1.1.1.1.2.2.2.2">subscript</csymbol><ci id="S3.E2.m1.1.1.1.1.2.2.2.2.2.cmml" xref="S3.E2.m1.1.1.1.1.2.2.2.2.2">I</ci><ci id="S3.E2.m1.1.1.1.1.2.2.2.2.3.cmml" xref="S3.E2.m1.1.1.1.1.2.2.2.2.3">𝐿</ci></apply></interval></apply></apply><apply id="S3.E2.m1.1.1.1.1c.cmml" xref="S3.E2.m1.1.1.1"><in id="S3.E2.m1.1.1.1.1.6.cmml" xref="S3.E2.m1.1.1.1.1.6"></in><share href="#S3.E2.m1.1.1.1.1.2.cmml" id="S3.E2.m1.1.1.1.1d.cmml" xref="S3.E2.m1.1.1.1"></share><apply id="S3.E2.m1.1.1.1.1.7.cmml" xref="S3.E2.m1.1.1.1.1.7"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.7.1.cmml" xref="S3.E2.m1.1.1.1.1.7">superscript</csymbol><ci id="S3.E2.m1.1.1.1.1.7.2.cmml" xref="S3.E2.m1.1.1.1.1.7.2">ℝ</ci><apply id="S3.E2.m1.1.1.1.1.7.3.cmml" xref="S3.E2.m1.1.1.1.1.7.3"><times id="S3.E2.m1.1.1.1.1.7.3.1.cmml" xref="S3.E2.m1.1.1.1.1.7.3.1"></times><ci id="S3.E2.m1.1.1.1.1.7.3.2.cmml" xref="S3.E2.m1.1.1.1.1.7.3.2">𝑚</ci><ci id="S3.E2.m1.1.1.1.1.7.3.3.cmml" xref="S3.E2.m1.1.1.1.1.7.3.3">𝑑</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.1c">\mathrm{{O}}_{L}={\rm Decoder}({\rm Q}_{0},{\rm I}_{L})\in\mathbb{R}^{m\times d}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p id="S3.p2.7" class="ltx_p">Lastly, the object embeddings are directly fed to a 3-layer feedforward neural networks (FFNs) for bounding box regression and linear projection for classification,</p>
<table id="S3.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E3.m1.27" class="ltx_Math" alttext="\begin{gathered}\mathrm{\hat{B}_{det}=FFN_{3-layer}}({\rm O}_{L})\in\mathbb{R}^{m\times 4}\\
\mathrm{\hat{P}_{det}=Linear}({\rm O}_{L})\in\mathbb{R}^{m\times k},\end{gathered}" display="block"><semantics id="S3.E3.m1.27a"><mtable displaystyle="true" rowspacing="0pt" id="S3.E3.m1.27.27.3"><mtr id="S3.E3.m1.27.27.3a"><mtd id="S3.E3.m1.27.27.3b"><mrow id="S3.E3.m1.26.26.2.25.13.13"><msub id="S3.E3.m1.26.26.2.25.13.13.15"><mover accent="true" id="S3.E3.m1.1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.cmml"><mi mathvariant="normal" id="S3.E3.m1.1.1.1.1.1.1.2" xref="S3.E3.m1.1.1.1.1.1.1.2.cmml">B</mi><mo id="S3.E3.m1.1.1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.1.cmml">^</mo></mover><mi id="S3.E3.m1.2.2.2.2.2.2.1" xref="S3.E3.m1.2.2.2.2.2.2.1.cmml">det</mi></msub><mo id="S3.E3.m1.3.3.3.3.3.3" xref="S3.E3.m1.3.3.3.3.3.3.cmml">=</mo><mrow id="S3.E3.m1.26.26.2.25.13.13.13"><msub id="S3.E3.m1.26.26.2.25.13.13.13.3"><mi id="S3.E3.m1.4.4.4.4.4.4" xref="S3.E3.m1.4.4.4.4.4.4.cmml">FFN</mi><mrow id="S3.E3.m1.5.5.5.5.5.5.1" xref="S3.E3.m1.5.5.5.5.5.5.1.cmml"><mn id="S3.E3.m1.5.5.5.5.5.5.1.2" xref="S3.E3.m1.5.5.5.5.5.5.1.2.cmml">3</mn><mo id="S3.E3.m1.5.5.5.5.5.5.1.1" xref="S3.E3.m1.5.5.5.5.5.5.1.1.cmml">−</mo><mi id="S3.E3.m1.5.5.5.5.5.5.1.3" xref="S3.E3.m1.5.5.5.5.5.5.1.3.cmml">layer</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E3.m1.26.26.2.25.13.13.13.2" xref="S3.E3.m1.25.25.1.1.1.cmml">​</mo><mrow id="S3.E3.m1.26.26.2.25.13.13.13.1.1"><mo stretchy="false" id="S3.E3.m1.6.6.6.6.6.6" xref="S3.E3.m1.25.25.1.1.1.cmml">(</mo><msub id="S3.E3.m1.26.26.2.25.13.13.13.1.1.1"><mi mathvariant="normal" id="S3.E3.m1.7.7.7.7.7.7" xref="S3.E3.m1.7.7.7.7.7.7.cmml">O</mi><mi id="S3.E3.m1.8.8.8.8.8.8.1" xref="S3.E3.m1.8.8.8.8.8.8.1.cmml">L</mi></msub><mo stretchy="false" id="S3.E3.m1.9.9.9.9.9.9" xref="S3.E3.m1.25.25.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E3.m1.10.10.10.10.10.10" xref="S3.E3.m1.10.10.10.10.10.10.cmml">∈</mo><msup id="S3.E3.m1.26.26.2.25.13.13.16"><mi id="S3.E3.m1.11.11.11.11.11.11" xref="S3.E3.m1.11.11.11.11.11.11.cmml">ℝ</mi><mrow id="S3.E3.m1.12.12.12.12.12.12.1" xref="S3.E3.m1.12.12.12.12.12.12.1.cmml"><mi id="S3.E3.m1.12.12.12.12.12.12.1.2" xref="S3.E3.m1.12.12.12.12.12.12.1.2.cmml">m</mi><mo lspace="0.222em" rspace="0.222em" id="S3.E3.m1.12.12.12.12.12.12.1.1" xref="S3.E3.m1.12.12.12.12.12.12.1.1.cmml">×</mo><mn id="S3.E3.m1.12.12.12.12.12.12.1.3" xref="S3.E3.m1.12.12.12.12.12.12.1.3.cmml">4</mn></mrow></msup></mrow></mtd></mtr><mtr id="S3.E3.m1.27.27.3c"><mtd id="S3.E3.m1.27.27.3d"><mrow id="S3.E3.m1.27.27.3.26.13.13.13"><mrow id="S3.E3.m1.27.27.3.26.13.13.13.1"><msub id="S3.E3.m1.27.27.3.26.13.13.13.1.3"><mover accent="true" id="S3.E3.m1.13.13.13.1.1.1" xref="S3.E3.m1.13.13.13.1.1.1.cmml"><mi mathvariant="normal" id="S3.E3.m1.13.13.13.1.1.1.2" xref="S3.E3.m1.13.13.13.1.1.1.2.cmml">P</mi><mo id="S3.E3.m1.13.13.13.1.1.1.1" xref="S3.E3.m1.13.13.13.1.1.1.1.cmml">^</mo></mover><mi id="S3.E3.m1.14.14.14.2.2.2.1" xref="S3.E3.m1.14.14.14.2.2.2.1.cmml">det</mi></msub><mo id="S3.E3.m1.15.15.15.3.3.3" xref="S3.E3.m1.15.15.15.3.3.3.cmml">=</mo><mrow id="S3.E3.m1.27.27.3.26.13.13.13.1.1"><mi id="S3.E3.m1.16.16.16.4.4.4" xref="S3.E3.m1.16.16.16.4.4.4.cmml">Linear</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.27.27.3.26.13.13.13.1.1.2" xref="S3.E3.m1.25.25.1.1.1.cmml">​</mo><mrow id="S3.E3.m1.27.27.3.26.13.13.13.1.1.1.1"><mo stretchy="false" id="S3.E3.m1.17.17.17.5.5.5" xref="S3.E3.m1.25.25.1.1.1.cmml">(</mo><msub id="S3.E3.m1.27.27.3.26.13.13.13.1.1.1.1.1"><mi mathvariant="normal" id="S3.E3.m1.18.18.18.6.6.6" xref="S3.E3.m1.18.18.18.6.6.6.cmml">O</mi><mi id="S3.E3.m1.19.19.19.7.7.7.1" xref="S3.E3.m1.19.19.19.7.7.7.1.cmml">L</mi></msub><mo stretchy="false" id="S3.E3.m1.20.20.20.8.8.8" xref="S3.E3.m1.25.25.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E3.m1.21.21.21.9.9.9" xref="S3.E3.m1.21.21.21.9.9.9.cmml">∈</mo><msup id="S3.E3.m1.27.27.3.26.13.13.13.1.4"><mi id="S3.E3.m1.22.22.22.10.10.10" xref="S3.E3.m1.22.22.22.10.10.10.cmml">ℝ</mi><mrow id="S3.E3.m1.23.23.23.11.11.11.1" xref="S3.E3.m1.23.23.23.11.11.11.1.cmml"><mi id="S3.E3.m1.23.23.23.11.11.11.1.2" xref="S3.E3.m1.23.23.23.11.11.11.1.2.cmml">m</mi><mo lspace="0.222em" rspace="0.222em" id="S3.E3.m1.23.23.23.11.11.11.1.1" xref="S3.E3.m1.23.23.23.11.11.11.1.1.cmml">×</mo><mi id="S3.E3.m1.23.23.23.11.11.11.1.3" xref="S3.E3.m1.23.23.23.11.11.11.1.3.cmml">k</mi></mrow></msup></mrow><mo id="S3.E3.m1.24.24.24.12.12.12" xref="S3.E3.m1.25.25.1.1.1.cmml">,</mo></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S3.E3.m1.27b"><apply id="S3.E3.m1.25.25.1.1.1.cmml" xref="S3.E3.m1.26.26.2.25.13.13.13.2"><and id="S3.E3.m1.25.25.1.1.1a.cmml" xref="S3.E3.m1.26.26.2.25.13.13.13.2"></and><apply id="S3.E3.m1.25.25.1.1.1b.cmml" xref="S3.E3.m1.26.26.2.25.13.13.13.2"><eq id="S3.E3.m1.3.3.3.3.3.3.cmml" xref="S3.E3.m1.3.3.3.3.3.3"></eq><apply id="S3.E3.m1.25.25.1.1.1.4.cmml" xref="S3.E3.m1.26.26.2.25.13.13.13.2"><csymbol cd="ambiguous" id="S3.E3.m1.25.25.1.1.1.4.1.cmml" xref="S3.E3.m1.26.26.2.25.13.13.13.2">subscript</csymbol><apply id="S3.E3.m1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1"><ci id="S3.E3.m1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1">^</ci><ci id="S3.E3.m1.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.2">B</ci></apply><ci id="S3.E3.m1.2.2.2.2.2.2.1.cmml" xref="S3.E3.m1.2.2.2.2.2.2.1">det</ci></apply><apply id="S3.E3.m1.25.25.1.1.1.1.cmml" xref="S3.E3.m1.26.26.2.25.13.13.13.2"><times id="S3.E3.m1.25.25.1.1.1.1.2.cmml" xref="S3.E3.m1.26.26.2.25.13.13.13.2"></times><apply id="S3.E3.m1.25.25.1.1.1.1.3.cmml" xref="S3.E3.m1.26.26.2.25.13.13.13.2"><csymbol cd="ambiguous" id="S3.E3.m1.25.25.1.1.1.1.3.1.cmml" xref="S3.E3.m1.26.26.2.25.13.13.13.2">subscript</csymbol><ci id="S3.E3.m1.4.4.4.4.4.4.cmml" xref="S3.E3.m1.4.4.4.4.4.4">FFN</ci><apply id="S3.E3.m1.5.5.5.5.5.5.1.cmml" xref="S3.E3.m1.5.5.5.5.5.5.1"><minus id="S3.E3.m1.5.5.5.5.5.5.1.1.cmml" xref="S3.E3.m1.5.5.5.5.5.5.1.1"></minus><cn type="integer" id="S3.E3.m1.5.5.5.5.5.5.1.2.cmml" xref="S3.E3.m1.5.5.5.5.5.5.1.2">3</cn><ci id="S3.E3.m1.5.5.5.5.5.5.1.3.cmml" xref="S3.E3.m1.5.5.5.5.5.5.1.3">layer</ci></apply></apply><apply id="S3.E3.m1.25.25.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.26.26.2.25.13.13.13.2"><csymbol cd="ambiguous" id="S3.E3.m1.25.25.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.26.26.2.25.13.13.13.2">subscript</csymbol><ci id="S3.E3.m1.7.7.7.7.7.7.cmml" xref="S3.E3.m1.7.7.7.7.7.7">O</ci><ci id="S3.E3.m1.8.8.8.8.8.8.1.cmml" xref="S3.E3.m1.8.8.8.8.8.8.1">𝐿</ci></apply></apply></apply><apply id="S3.E3.m1.25.25.1.1.1c.cmml" xref="S3.E3.m1.26.26.2.25.13.13.13.2"><in id="S3.E3.m1.10.10.10.10.10.10.cmml" xref="S3.E3.m1.10.10.10.10.10.10"></in><share href="#S3.E3.m1.25.25.1.1.1.1.cmml" id="S3.E3.m1.25.25.1.1.1d.cmml" xref="S3.E3.m1.26.26.2.25.13.13.13.2"></share><apply id="S3.E3.m1.25.25.1.1.1.7.cmml" xref="S3.E3.m1.26.26.2.25.13.13.13.2"><times id="S3.E3.m1.25.25.1.1.1.7.1.cmml" xref="S3.E3.m1.26.26.2.25.13.13.13.2"></times><apply id="S3.E3.m1.25.25.1.1.1.7.2.cmml" xref="S3.E3.m1.26.26.2.25.13.13.13.2"><csymbol cd="ambiguous" id="S3.E3.m1.25.25.1.1.1.7.2.1.cmml" xref="S3.E3.m1.26.26.2.25.13.13.13.2">superscript</csymbol><ci id="S3.E3.m1.11.11.11.11.11.11.cmml" xref="S3.E3.m1.11.11.11.11.11.11">ℝ</ci><apply id="S3.E3.m1.12.12.12.12.12.12.1.cmml" xref="S3.E3.m1.12.12.12.12.12.12.1"><times id="S3.E3.m1.12.12.12.12.12.12.1.1.cmml" xref="S3.E3.m1.12.12.12.12.12.12.1.1"></times><ci id="S3.E3.m1.12.12.12.12.12.12.1.2.cmml" xref="S3.E3.m1.12.12.12.12.12.12.1.2">𝑚</ci><cn type="integer" id="S3.E3.m1.12.12.12.12.12.12.1.3.cmml" xref="S3.E3.m1.12.12.12.12.12.12.1.3">4</cn></apply></apply><apply id="S3.E3.m1.25.25.1.1.1.7.3.cmml" xref="S3.E3.m1.26.26.2.25.13.13.13.2"><csymbol cd="ambiguous" id="S3.E3.m1.25.25.1.1.1.7.3.1.cmml" xref="S3.E3.m1.26.26.2.25.13.13.13.2">subscript</csymbol><apply id="S3.E3.m1.13.13.13.1.1.1.cmml" xref="S3.E3.m1.13.13.13.1.1.1"><ci id="S3.E3.m1.13.13.13.1.1.1.1.cmml" xref="S3.E3.m1.13.13.13.1.1.1.1">^</ci><ci id="S3.E3.m1.13.13.13.1.1.1.2.cmml" xref="S3.E3.m1.13.13.13.1.1.1.2">P</ci></apply><ci id="S3.E3.m1.14.14.14.2.2.2.1.cmml" xref="S3.E3.m1.14.14.14.2.2.2.1">det</ci></apply></apply></apply><apply id="S3.E3.m1.25.25.1.1.1e.cmml" xref="S3.E3.m1.26.26.2.25.13.13.13.2"><eq id="S3.E3.m1.15.15.15.3.3.3.cmml" xref="S3.E3.m1.15.15.15.3.3.3"></eq><share href="#S3.E3.m1.25.25.1.1.1.7.cmml" id="S3.E3.m1.25.25.1.1.1f.cmml" xref="S3.E3.m1.26.26.2.25.13.13.13.2"></share><apply id="S3.E3.m1.25.25.1.1.1.2.cmml" xref="S3.E3.m1.26.26.2.25.13.13.13.2"><times id="S3.E3.m1.25.25.1.1.1.2.2.cmml" xref="S3.E3.m1.26.26.2.25.13.13.13.2"></times><ci id="S3.E3.m1.16.16.16.4.4.4.cmml" xref="S3.E3.m1.16.16.16.4.4.4">Linear</ci><apply id="S3.E3.m1.25.25.1.1.1.2.1.1.1.cmml" xref="S3.E3.m1.26.26.2.25.13.13.13.2"><csymbol cd="ambiguous" id="S3.E3.m1.25.25.1.1.1.2.1.1.1.1.cmml" xref="S3.E3.m1.26.26.2.25.13.13.13.2">subscript</csymbol><ci id="S3.E3.m1.18.18.18.6.6.6.cmml" xref="S3.E3.m1.18.18.18.6.6.6">O</ci><ci id="S3.E3.m1.19.19.19.7.7.7.1.cmml" xref="S3.E3.m1.19.19.19.7.7.7.1">𝐿</ci></apply></apply></apply><apply id="S3.E3.m1.25.25.1.1.1g.cmml" xref="S3.E3.m1.26.26.2.25.13.13.13.2"><in id="S3.E3.m1.21.21.21.9.9.9.cmml" xref="S3.E3.m1.21.21.21.9.9.9"></in><share href="#S3.E3.m1.25.25.1.1.1.2.cmml" id="S3.E3.m1.25.25.1.1.1h.cmml" xref="S3.E3.m1.26.26.2.25.13.13.13.2"></share><apply id="S3.E3.m1.25.25.1.1.1.10.cmml" xref="S3.E3.m1.26.26.2.25.13.13.13.2"><csymbol cd="ambiguous" id="S3.E3.m1.25.25.1.1.1.10.1.cmml" xref="S3.E3.m1.26.26.2.25.13.13.13.2">superscript</csymbol><ci id="S3.E3.m1.22.22.22.10.10.10.cmml" xref="S3.E3.m1.22.22.22.10.10.10">ℝ</ci><apply id="S3.E3.m1.23.23.23.11.11.11.1.cmml" xref="S3.E3.m1.23.23.23.11.11.11.1"><times id="S3.E3.m1.23.23.23.11.11.11.1.1.cmml" xref="S3.E3.m1.23.23.23.11.11.11.1.1"></times><ci id="S3.E3.m1.23.23.23.11.11.11.1.2.cmml" xref="S3.E3.m1.23.23.23.11.11.11.1.2">𝑚</ci><ci id="S3.E3.m1.23.23.23.11.11.11.1.3.cmml" xref="S3.E3.m1.23.23.23.11.11.11.1.3">𝑘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.27c">\begin{gathered}\mathrm{\hat{B}_{det}=FFN_{3-layer}}({\rm O}_{L})\in\mathbb{R}^{m\times 4}\\
\mathrm{\hat{P}_{det}=Linear}({\rm O}_{L})\in\mathbb{R}^{m\times k},\end{gathered}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p id="S3.p2.6" class="ltx_p">where <math id="S3.p2.6.m1.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.p2.6.m1.1a"><mi id="S3.p2.6.m1.1.1" xref="S3.p2.6.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.p2.6.m1.1b"><ci id="S3.p2.6.m1.1.1.cmml" xref="S3.p2.6.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.6.m1.1c">k</annotation></semantics></math> is the number of object classes. The bipartite Hungarian matching is used to train the model in an end-to-end fashion  <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>.</p>
</div>
<div id="S3.p3" class="ltx_para ltx_noindent">
<p id="S3.p3.4" class="ltx_p"><span id="S3.p3.4.1" class="ltx_text ltx_font_bold">ViT-based CLIP.</span> CLIP <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite> is a dual-encoder architecture that consists of visual and text encoders, returning the image-text aligned embeddings of the visual and text inputs. ViT-based CLIP uses a ViT architecture as the visual encoder and a masked self-attention Transformer as the text encoder. It receives the patch tokens of an image as input to the visual encoder, while image-aligned word tokens to the text encoder. Given an image <math id="S3.p3.1.m1.1" class="ltx_Math" alttext="{\bf x}" display="inline"><semantics id="S3.p3.1.m1.1a"><mi id="S3.p3.1.m1.1.1" xref="S3.p3.1.m1.1.1.cmml">𝐱</mi><annotation-xml encoding="MathML-Content" id="S3.p3.1.m1.1b"><ci id="S3.p3.1.m1.1.1.cmml" xref="S3.p3.1.m1.1.1">𝐱</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.1.m1.1c">{\bf x}</annotation></semantics></math> and a text prompt <math id="S3.p3.2.m2.1" class="ltx_Math" alttext="{\bf y^{cls}}" display="inline"><semantics id="S3.p3.2.m2.1a"><msup id="S3.p3.2.m2.1.1" xref="S3.p3.2.m2.1.1.cmml"><mi id="S3.p3.2.m2.1.1.2" xref="S3.p3.2.m2.1.1.2.cmml">𝐲</mi><mi id="S3.p3.2.m2.1.1.3" xref="S3.p3.2.m2.1.1.3.cmml">𝐜𝐥𝐬</mi></msup><annotation-xml encoding="MathML-Content" id="S3.p3.2.m2.1b"><apply id="S3.p3.2.m2.1.1.cmml" xref="S3.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S3.p3.2.m2.1.1.1.cmml" xref="S3.p3.2.m2.1.1">superscript</csymbol><ci id="S3.p3.2.m2.1.1.2.cmml" xref="S3.p3.2.m2.1.1.2">𝐲</ci><ci id="S3.p3.2.m2.1.1.3.cmml" xref="S3.p3.2.m2.1.1.3">𝐜𝐥𝐬</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.2.m2.1c">{\bf y^{cls}}</annotation></semantics></math> for its class name, CLIP generates the two output embeddings, an image embedding <math id="S3.p3.3.m3.1" class="ltx_Math" alttext="{\bf e}^{\rm img}_{\rm clip}\in\mathbb{R}^{d^{\prime}}" display="inline"><semantics id="S3.p3.3.m3.1a"><mrow id="S3.p3.3.m3.1.1" xref="S3.p3.3.m3.1.1.cmml"><msubsup id="S3.p3.3.m3.1.1.2" xref="S3.p3.3.m3.1.1.2.cmml"><mi id="S3.p3.3.m3.1.1.2.2.2" xref="S3.p3.3.m3.1.1.2.2.2.cmml">𝐞</mi><mi id="S3.p3.3.m3.1.1.2.3" xref="S3.p3.3.m3.1.1.2.3.cmml">clip</mi><mi id="S3.p3.3.m3.1.1.2.2.3" xref="S3.p3.3.m3.1.1.2.2.3.cmml">img</mi></msubsup><mo id="S3.p3.3.m3.1.1.1" xref="S3.p3.3.m3.1.1.1.cmml">∈</mo><msup id="S3.p3.3.m3.1.1.3" xref="S3.p3.3.m3.1.1.3.cmml"><mi id="S3.p3.3.m3.1.1.3.2" xref="S3.p3.3.m3.1.1.3.2.cmml">ℝ</mi><msup id="S3.p3.3.m3.1.1.3.3" xref="S3.p3.3.m3.1.1.3.3.cmml"><mi id="S3.p3.3.m3.1.1.3.3.2" xref="S3.p3.3.m3.1.1.3.3.2.cmml">d</mi><mo id="S3.p3.3.m3.1.1.3.3.3" xref="S3.p3.3.m3.1.1.3.3.3.cmml">′</mo></msup></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.p3.3.m3.1b"><apply id="S3.p3.3.m3.1.1.cmml" xref="S3.p3.3.m3.1.1"><in id="S3.p3.3.m3.1.1.1.cmml" xref="S3.p3.3.m3.1.1.1"></in><apply id="S3.p3.3.m3.1.1.2.cmml" xref="S3.p3.3.m3.1.1.2"><csymbol cd="ambiguous" id="S3.p3.3.m3.1.1.2.1.cmml" xref="S3.p3.3.m3.1.1.2">subscript</csymbol><apply id="S3.p3.3.m3.1.1.2.2.cmml" xref="S3.p3.3.m3.1.1.2"><csymbol cd="ambiguous" id="S3.p3.3.m3.1.1.2.2.1.cmml" xref="S3.p3.3.m3.1.1.2">superscript</csymbol><ci id="S3.p3.3.m3.1.1.2.2.2.cmml" xref="S3.p3.3.m3.1.1.2.2.2">𝐞</ci><ci id="S3.p3.3.m3.1.1.2.2.3.cmml" xref="S3.p3.3.m3.1.1.2.2.3">img</ci></apply><ci id="S3.p3.3.m3.1.1.2.3.cmml" xref="S3.p3.3.m3.1.1.2.3">clip</ci></apply><apply id="S3.p3.3.m3.1.1.3.cmml" xref="S3.p3.3.m3.1.1.3"><csymbol cd="ambiguous" id="S3.p3.3.m3.1.1.3.1.cmml" xref="S3.p3.3.m3.1.1.3">superscript</csymbol><ci id="S3.p3.3.m3.1.1.3.2.cmml" xref="S3.p3.3.m3.1.1.3.2">ℝ</ci><apply id="S3.p3.3.m3.1.1.3.3.cmml" xref="S3.p3.3.m3.1.1.3.3"><csymbol cd="ambiguous" id="S3.p3.3.m3.1.1.3.3.1.cmml" xref="S3.p3.3.m3.1.1.3.3">superscript</csymbol><ci id="S3.p3.3.m3.1.1.3.3.2.cmml" xref="S3.p3.3.m3.1.1.3.3.2">𝑑</ci><ci id="S3.p3.3.m3.1.1.3.3.3.cmml" xref="S3.p3.3.m3.1.1.3.3.3">′</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.3.m3.1c">{\bf e}^{\rm img}_{\rm clip}\in\mathbb{R}^{d^{\prime}}</annotation></semantics></math> and a text embedding <math id="S3.p3.4.m4.1" class="ltx_Math" alttext="{\bf e}^{\rm txt}_{\rm clip}\in\mathbb{R}^{d^{\prime}}" display="inline"><semantics id="S3.p3.4.m4.1a"><mrow id="S3.p3.4.m4.1.1" xref="S3.p3.4.m4.1.1.cmml"><msubsup id="S3.p3.4.m4.1.1.2" xref="S3.p3.4.m4.1.1.2.cmml"><mi id="S3.p3.4.m4.1.1.2.2.2" xref="S3.p3.4.m4.1.1.2.2.2.cmml">𝐞</mi><mi id="S3.p3.4.m4.1.1.2.3" xref="S3.p3.4.m4.1.1.2.3.cmml">clip</mi><mi id="S3.p3.4.m4.1.1.2.2.3" xref="S3.p3.4.m4.1.1.2.2.3.cmml">txt</mi></msubsup><mo id="S3.p3.4.m4.1.1.1" xref="S3.p3.4.m4.1.1.1.cmml">∈</mo><msup id="S3.p3.4.m4.1.1.3" xref="S3.p3.4.m4.1.1.3.cmml"><mi id="S3.p3.4.m4.1.1.3.2" xref="S3.p3.4.m4.1.1.3.2.cmml">ℝ</mi><msup id="S3.p3.4.m4.1.1.3.3" xref="S3.p3.4.m4.1.1.3.3.cmml"><mi id="S3.p3.4.m4.1.1.3.3.2" xref="S3.p3.4.m4.1.1.3.3.2.cmml">d</mi><mo id="S3.p3.4.m4.1.1.3.3.3" xref="S3.p3.4.m4.1.1.3.3.3.cmml">′</mo></msup></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.p3.4.m4.1b"><apply id="S3.p3.4.m4.1.1.cmml" xref="S3.p3.4.m4.1.1"><in id="S3.p3.4.m4.1.1.1.cmml" xref="S3.p3.4.m4.1.1.1"></in><apply id="S3.p3.4.m4.1.1.2.cmml" xref="S3.p3.4.m4.1.1.2"><csymbol cd="ambiguous" id="S3.p3.4.m4.1.1.2.1.cmml" xref="S3.p3.4.m4.1.1.2">subscript</csymbol><apply id="S3.p3.4.m4.1.1.2.2.cmml" xref="S3.p3.4.m4.1.1.2"><csymbol cd="ambiguous" id="S3.p3.4.m4.1.1.2.2.1.cmml" xref="S3.p3.4.m4.1.1.2">superscript</csymbol><ci id="S3.p3.4.m4.1.1.2.2.2.cmml" xref="S3.p3.4.m4.1.1.2.2.2">𝐞</ci><ci id="S3.p3.4.m4.1.1.2.2.3.cmml" xref="S3.p3.4.m4.1.1.2.2.3">txt</ci></apply><ci id="S3.p3.4.m4.1.1.2.3.cmml" xref="S3.p3.4.m4.1.1.2.3">clip</ci></apply><apply id="S3.p3.4.m4.1.1.3.cmml" xref="S3.p3.4.m4.1.1.3"><csymbol cd="ambiguous" id="S3.p3.4.m4.1.1.3.1.cmml" xref="S3.p3.4.m4.1.1.3">superscript</csymbol><ci id="S3.p3.4.m4.1.1.3.2.cmml" xref="S3.p3.4.m4.1.1.3.2">ℝ</ci><apply id="S3.p3.4.m4.1.1.3.3.cmml" xref="S3.p3.4.m4.1.1.3.3"><csymbol cd="ambiguous" id="S3.p3.4.m4.1.1.3.3.1.cmml" xref="S3.p3.4.m4.1.1.3.3">superscript</csymbol><ci id="S3.p3.4.m4.1.1.3.3.2.cmml" xref="S3.p3.4.m4.1.1.3.3.2">𝑑</ci><ci id="S3.p3.4.m4.1.1.3.3.3.cmml" xref="S3.p3.4.m4.1.1.3.3.3">′</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.4.m4.1c">{\bf e}^{\rm txt}_{\rm clip}\in\mathbb{R}^{d^{\prime}}</annotation></semantics></math> as:</p>
<table id="S3.E4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E4.m1.2" class="ltx_Math" alttext="{\bf e}^{\rm img}_{\rm clip}={\rm CLIP}_{\rm img}({\bf x})~{}~{}{\rm and}~{}~{}{\bf e}^{\rm txt}_{\rm clip}={\rm CLIP}_{\rm txt}({\bf y^{cls}})." display="block"><semantics id="S3.E4.m1.2a"><mrow id="S3.E4.m1.2.2.1" xref="S3.E4.m1.2.2.1.1.cmml"><mrow id="S3.E4.m1.2.2.1.1" xref="S3.E4.m1.2.2.1.1.cmml"><msubsup id="S3.E4.m1.2.2.1.1.3" xref="S3.E4.m1.2.2.1.1.3.cmml"><mi id="S3.E4.m1.2.2.1.1.3.2.2" xref="S3.E4.m1.2.2.1.1.3.2.2.cmml">𝐞</mi><mi id="S3.E4.m1.2.2.1.1.3.3" xref="S3.E4.m1.2.2.1.1.3.3.cmml">clip</mi><mi id="S3.E4.m1.2.2.1.1.3.2.3" xref="S3.E4.m1.2.2.1.1.3.2.3.cmml">img</mi></msubsup><mo id="S3.E4.m1.2.2.1.1.4" xref="S3.E4.m1.2.2.1.1.4.cmml">=</mo><mrow id="S3.E4.m1.2.2.1.1.5" xref="S3.E4.m1.2.2.1.1.5.cmml"><msub id="S3.E4.m1.2.2.1.1.5.2" xref="S3.E4.m1.2.2.1.1.5.2.cmml"><mi id="S3.E4.m1.2.2.1.1.5.2.2" xref="S3.E4.m1.2.2.1.1.5.2.2.cmml">CLIP</mi><mi id="S3.E4.m1.2.2.1.1.5.2.3" xref="S3.E4.m1.2.2.1.1.5.2.3.cmml">img</mi></msub><mo lspace="0em" rspace="0em" id="S3.E4.m1.2.2.1.1.5.1" xref="S3.E4.m1.2.2.1.1.5.1.cmml">​</mo><mrow id="S3.E4.m1.2.2.1.1.5.3.2" xref="S3.E4.m1.2.2.1.1.5.cmml"><mo stretchy="false" id="S3.E4.m1.2.2.1.1.5.3.2.1" xref="S3.E4.m1.2.2.1.1.5.cmml">(</mo><mi id="S3.E4.m1.1.1" xref="S3.E4.m1.1.1.cmml">𝐱</mi><mo stretchy="false" id="S3.E4.m1.2.2.1.1.5.3.2.2" xref="S3.E4.m1.2.2.1.1.5.cmml">)</mo></mrow><mo lspace="0.660em" rspace="0em" id="S3.E4.m1.2.2.1.1.5.1a" xref="S3.E4.m1.2.2.1.1.5.1.cmml">​</mo><mi id="S3.E4.m1.2.2.1.1.5.4" xref="S3.E4.m1.2.2.1.1.5.4.cmml">and</mi><mo lspace="0.660em" rspace="0em" id="S3.E4.m1.2.2.1.1.5.1b" xref="S3.E4.m1.2.2.1.1.5.1.cmml">​</mo><msubsup id="S3.E4.m1.2.2.1.1.5.5" xref="S3.E4.m1.2.2.1.1.5.5.cmml"><mi id="S3.E4.m1.2.2.1.1.5.5.2.2" xref="S3.E4.m1.2.2.1.1.5.5.2.2.cmml">𝐞</mi><mi id="S3.E4.m1.2.2.1.1.5.5.3" xref="S3.E4.m1.2.2.1.1.5.5.3.cmml">clip</mi><mi id="S3.E4.m1.2.2.1.1.5.5.2.3" xref="S3.E4.m1.2.2.1.1.5.5.2.3.cmml">txt</mi></msubsup></mrow><mo id="S3.E4.m1.2.2.1.1.6" xref="S3.E4.m1.2.2.1.1.6.cmml">=</mo><mrow id="S3.E4.m1.2.2.1.1.1" xref="S3.E4.m1.2.2.1.1.1.cmml"><msub id="S3.E4.m1.2.2.1.1.1.3" xref="S3.E4.m1.2.2.1.1.1.3.cmml"><mi id="S3.E4.m1.2.2.1.1.1.3.2" xref="S3.E4.m1.2.2.1.1.1.3.2.cmml">CLIP</mi><mi id="S3.E4.m1.2.2.1.1.1.3.3" xref="S3.E4.m1.2.2.1.1.1.3.3.cmml">txt</mi></msub><mo lspace="0em" rspace="0em" id="S3.E4.m1.2.2.1.1.1.2" xref="S3.E4.m1.2.2.1.1.1.2.cmml">​</mo><mrow id="S3.E4.m1.2.2.1.1.1.1.1" xref="S3.E4.m1.2.2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E4.m1.2.2.1.1.1.1.1.2" xref="S3.E4.m1.2.2.1.1.1.1.1.1.cmml">(</mo><msup id="S3.E4.m1.2.2.1.1.1.1.1.1" xref="S3.E4.m1.2.2.1.1.1.1.1.1.cmml"><mi id="S3.E4.m1.2.2.1.1.1.1.1.1.2" xref="S3.E4.m1.2.2.1.1.1.1.1.1.2.cmml">𝐲</mi><mi id="S3.E4.m1.2.2.1.1.1.1.1.1.3" xref="S3.E4.m1.2.2.1.1.1.1.1.1.3.cmml">𝐜𝐥𝐬</mi></msup><mo stretchy="false" id="S3.E4.m1.2.2.1.1.1.1.1.3" xref="S3.E4.m1.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo lspace="0em" id="S3.E4.m1.2.2.1.2" xref="S3.E4.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.2b"><apply id="S3.E4.m1.2.2.1.1.cmml" xref="S3.E4.m1.2.2.1"><and id="S3.E4.m1.2.2.1.1a.cmml" xref="S3.E4.m1.2.2.1"></and><apply id="S3.E4.m1.2.2.1.1b.cmml" xref="S3.E4.m1.2.2.1"><eq id="S3.E4.m1.2.2.1.1.4.cmml" xref="S3.E4.m1.2.2.1.1.4"></eq><apply id="S3.E4.m1.2.2.1.1.3.cmml" xref="S3.E4.m1.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.1.1.3.1.cmml" xref="S3.E4.m1.2.2.1.1.3">subscript</csymbol><apply id="S3.E4.m1.2.2.1.1.3.2.cmml" xref="S3.E4.m1.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.1.1.3.2.1.cmml" xref="S3.E4.m1.2.2.1.1.3">superscript</csymbol><ci id="S3.E4.m1.2.2.1.1.3.2.2.cmml" xref="S3.E4.m1.2.2.1.1.3.2.2">𝐞</ci><ci id="S3.E4.m1.2.2.1.1.3.2.3.cmml" xref="S3.E4.m1.2.2.1.1.3.2.3">img</ci></apply><ci id="S3.E4.m1.2.2.1.1.3.3.cmml" xref="S3.E4.m1.2.2.1.1.3.3">clip</ci></apply><apply id="S3.E4.m1.2.2.1.1.5.cmml" xref="S3.E4.m1.2.2.1.1.5"><times id="S3.E4.m1.2.2.1.1.5.1.cmml" xref="S3.E4.m1.2.2.1.1.5.1"></times><apply id="S3.E4.m1.2.2.1.1.5.2.cmml" xref="S3.E4.m1.2.2.1.1.5.2"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.1.1.5.2.1.cmml" xref="S3.E4.m1.2.2.1.1.5.2">subscript</csymbol><ci id="S3.E4.m1.2.2.1.1.5.2.2.cmml" xref="S3.E4.m1.2.2.1.1.5.2.2">CLIP</ci><ci id="S3.E4.m1.2.2.1.1.5.2.3.cmml" xref="S3.E4.m1.2.2.1.1.5.2.3">img</ci></apply><ci id="S3.E4.m1.1.1.cmml" xref="S3.E4.m1.1.1">𝐱</ci><ci id="S3.E4.m1.2.2.1.1.5.4.cmml" xref="S3.E4.m1.2.2.1.1.5.4">and</ci><apply id="S3.E4.m1.2.2.1.1.5.5.cmml" xref="S3.E4.m1.2.2.1.1.5.5"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.1.1.5.5.1.cmml" xref="S3.E4.m1.2.2.1.1.5.5">subscript</csymbol><apply id="S3.E4.m1.2.2.1.1.5.5.2.cmml" xref="S3.E4.m1.2.2.1.1.5.5"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.1.1.5.5.2.1.cmml" xref="S3.E4.m1.2.2.1.1.5.5">superscript</csymbol><ci id="S3.E4.m1.2.2.1.1.5.5.2.2.cmml" xref="S3.E4.m1.2.2.1.1.5.5.2.2">𝐞</ci><ci id="S3.E4.m1.2.2.1.1.5.5.2.3.cmml" xref="S3.E4.m1.2.2.1.1.5.5.2.3">txt</ci></apply><ci id="S3.E4.m1.2.2.1.1.5.5.3.cmml" xref="S3.E4.m1.2.2.1.1.5.5.3">clip</ci></apply></apply></apply><apply id="S3.E4.m1.2.2.1.1c.cmml" xref="S3.E4.m1.2.2.1"><eq id="S3.E4.m1.2.2.1.1.6.cmml" xref="S3.E4.m1.2.2.1.1.6"></eq><share href="#S3.E4.m1.2.2.1.1.5.cmml" id="S3.E4.m1.2.2.1.1d.cmml" xref="S3.E4.m1.2.2.1"></share><apply id="S3.E4.m1.2.2.1.1.1.cmml" xref="S3.E4.m1.2.2.1.1.1"><times id="S3.E4.m1.2.2.1.1.1.2.cmml" xref="S3.E4.m1.2.2.1.1.1.2"></times><apply id="S3.E4.m1.2.2.1.1.1.3.cmml" xref="S3.E4.m1.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.1.1.1.3.1.cmml" xref="S3.E4.m1.2.2.1.1.1.3">subscript</csymbol><ci id="S3.E4.m1.2.2.1.1.1.3.2.cmml" xref="S3.E4.m1.2.2.1.1.1.3.2">CLIP</ci><ci id="S3.E4.m1.2.2.1.1.1.3.3.cmml" xref="S3.E4.m1.2.2.1.1.1.3.3">txt</ci></apply><apply id="S3.E4.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1">superscript</csymbol><ci id="S3.E4.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.1.2">𝐲</ci><ci id="S3.E4.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.1.3">𝐜𝐥𝐬</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.2c">{\bf e}^{\rm img}_{\rm clip}={\rm CLIP}_{\rm img}({\bf x})~{}~{}{\rm and}~{}~{}{\bf e}^{\rm txt}_{\rm clip}={\rm CLIP}_{\rm txt}({\bf y^{cls}}).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p id="S3.p3.5" class="ltx_p">Since the two output embeddings are aligned each other via contrastive learning, knowledge distillation using CLIP embeddings has been shown to improve the detection performance on previsouly unseen classes <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>, <a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite>.</p>
</div>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Prompt-OVD</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p">We first reconfigure the decoding procedure of DETR to leverage the CLIP embeddings as its class prompts. Next, we propose an efficient way of ensembling with CLIP using RoI-based masked attention and RoI pruning.</p>
</div>
<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Prompt-based Decoding</h3>

<div id="S4.SS1.p1" class="ltx_para">
<p id="S4.SS1.p1.3" class="ltx_p">Our first objective is designing a highly efficient decoding pipeline for an end-to-end Transformer-based open-vocabulary detector. To achieve this, we propose the concept of <em id="S4.SS1.p1.3.1" class="ltx_emph ltx_font_italic">prompt-based decoding</em>. Similar to OV-DETR <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite>, our approach involves selecting either an image embedding <math id="S4.SS1.p1.1.m1.1" class="ltx_Math" alttext="{\bf e^{img}}" display="inline"><semantics id="S4.SS1.p1.1.m1.1a"><msup id="S4.SS1.p1.1.m1.1.1" xref="S4.SS1.p1.1.m1.1.1.cmml"><mi id="S4.SS1.p1.1.m1.1.1.2" xref="S4.SS1.p1.1.m1.1.1.2.cmml">𝐞</mi><mi id="S4.SS1.p1.1.m1.1.1.3" xref="S4.SS1.p1.1.m1.1.1.3.cmml">𝐢𝐦𝐠</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.1.m1.1b"><apply id="S4.SS1.p1.1.m1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.1.m1.1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1">superscript</csymbol><ci id="S4.SS1.p1.1.m1.1.1.2.cmml" xref="S4.SS1.p1.1.m1.1.1.2">𝐞</ci><ci id="S4.SS1.p1.1.m1.1.1.3.cmml" xref="S4.SS1.p1.1.m1.1.1.3">𝐢𝐦𝐠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.1.m1.1c">{\bf e^{img}}</annotation></semantics></math> or a text embedding <math id="S4.SS1.p1.2.m2.1" class="ltx_Math" alttext="{\bf e^{txt}}" display="inline"><semantics id="S4.SS1.p1.2.m2.1a"><msup id="S4.SS1.p1.2.m2.1.1" xref="S4.SS1.p1.2.m2.1.1.cmml"><mi id="S4.SS1.p1.2.m2.1.1.2" xref="S4.SS1.p1.2.m2.1.1.2.cmml">𝐞</mi><mi id="S4.SS1.p1.2.m2.1.1.3" xref="S4.SS1.p1.2.m2.1.1.3.cmml">𝐭𝐱𝐭</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.2.m2.1b"><apply id="S4.SS1.p1.2.m2.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.2.m2.1.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1">superscript</csymbol><ci id="S4.SS1.p1.2.m2.1.1.2.cmml" xref="S4.SS1.p1.2.m2.1.1.2">𝐞</ci><ci id="S4.SS1.p1.2.m2.1.1.3.cmml" xref="S4.SS1.p1.2.m2.1.1.3">𝐭𝐱𝐭</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.2.m2.1c">{\bf e^{txt}}</annotation></semantics></math> from CLIP to provide prior information about the classes that the decoder detects. However, we take this approach further by treating the two embeddings as <em id="S4.SS1.p1.3.2" class="ltx_emph ltx_font_italic">class prompts</em>. These prompts modifies object queries <math id="S4.SS1.p1.3.m3.1" class="ltx_Math" alttext="{\rm Q}" display="inline"><semantics id="S4.SS1.p1.3.m3.1a"><mi mathvariant="normal" id="S4.SS1.p1.3.m3.1.1" xref="S4.SS1.p1.3.m3.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.3.m3.1b"><ci id="S4.SS1.p1.3.m3.1.1.cmml" xref="S4.SS1.p1.3.m3.1.1">Q</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.3.m3.1c">{\rm Q}</annotation></semantics></math> in real-time via self-attention, enabling them to instantly detect class objects specified by the prompts.</p>
</div>
<figure id="S4.F2" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><img src="/html/2303.14386/assets/x2.png" id="S4.F2.1.g1" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" width="260" height="135" alt="Refer to caption"></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p id="S4.F2.7" class="ltx_p ltx_figure_panel"><span id="S4.F2.7.1" class="ltx_text" style="font-size:90%;">(a) OV-DETR.</span>                     <span id="S4.F2.7.2" class="ltx_text" style="font-size:90%;">(b) Prompt-OVD.</span></p>
</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F2.8.3.1" class="ltx_text" style="font-size:90%;">Figure 2</span>: </span><span id="S4.F2.5.2" class="ltx_text" style="font-size:90%;">Difference in label assignment after decoding, where # of classes <math id="S4.F2.4.1.m1.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S4.F2.4.1.m1.1b"><mi id="S4.F2.4.1.m1.1.1" xref="S4.F2.4.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.F2.4.1.m1.1c"><ci id="S4.F2.4.1.m1.1.1.cmml" xref="S4.F2.4.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F2.4.1.m1.1d">k</annotation></semantics></math> is 4 and # of object queries <math id="S4.F2.5.2.m2.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S4.F2.5.2.m2.1b"><mi id="S4.F2.5.2.m2.1.1" xref="S4.F2.5.2.m2.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S4.F2.5.2.m2.1c"><ci id="S4.F2.5.2.m2.1.1.cmml" xref="S4.F2.5.2.m2.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F2.5.2.m2.1d">m</annotation></semantics></math> is 3. </span></figcaption>
</figure>
<div id="S4.SS1.p2" class="ltx_para ltx_noindent">
<p id="S4.SS1.p2.9" class="ltx_p"><span id="S4.SS1.p2.9.1" class="ltx_text ltx_font_bold">Decoding.</span> The decoder in DETR is a structure of alternating self-attention and cross-attention modules in each layer. Thus, we prepend the CLIP embedding as the prompts to the self-attention module of every decoding layer,</p>
<table id="S4.E5" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E5.m1.34" class="ltx_Math" alttext="\begin{gathered}{{\rm Q}_{l}^{\prime}={\rm SelfAttn}_{l}([{\rm\mathbb{F}}_{\rm proj}({\rm{\bf e}_{clip}^{mod}});{\rm Q}_{l}])}\in\mathbb{R}^{m\times d}\\
{\rm mod}\in{\rm\{txt,img\}},\end{gathered}" display="block"><semantics id="S4.E5.m1.34a"><mtable displaystyle="true" rowspacing="0pt" id="S4.E5.m1.34.34.3"><mtr id="S4.E5.m1.34.34.3a"><mtd id="S4.E5.m1.34.34.3b"><mrow id="S4.E5.m1.33.33.2.32.24.24"><msubsup id="S4.E5.m1.33.33.2.32.24.24.26"><mi mathvariant="normal" id="S4.E5.m1.1.1.1.1.1.1" xref="S4.E5.m1.1.1.1.1.1.1.cmml">Q</mi><mi id="S4.E5.m1.2.2.2.2.2.2.1" xref="S4.E5.m1.2.2.2.2.2.2.1.cmml">l</mi><mo id="S4.E5.m1.3.3.3.3.3.3.1" xref="S4.E5.m1.3.3.3.3.3.3.1.cmml">′</mo></msubsup><mo id="S4.E5.m1.4.4.4.4.4.4" xref="S4.E5.m1.4.4.4.4.4.4.cmml">=</mo><mrow id="S4.E5.m1.33.33.2.32.24.24.24"><msub id="S4.E5.m1.33.33.2.32.24.24.24.3"><mi id="S4.E5.m1.5.5.5.5.5.5" xref="S4.E5.m1.5.5.5.5.5.5.cmml">SelfAttn</mi><mi id="S4.E5.m1.6.6.6.6.6.6.1" xref="S4.E5.m1.6.6.6.6.6.6.1.cmml">l</mi></msub><mo lspace="0em" rspace="0em" id="S4.E5.m1.33.33.2.32.24.24.24.2" xref="S4.E5.m1.32.32.1.1.1.cmml">​</mo><mrow id="S4.E5.m1.33.33.2.32.24.24.24.1.1"><mo stretchy="false" id="S4.E5.m1.7.7.7.7.7.7" xref="S4.E5.m1.32.32.1.1.1.cmml">(</mo><mrow id="S4.E5.m1.33.33.2.32.24.24.24.1.1.1"><mo stretchy="false" id="S4.E5.m1.8.8.8.8.8.8" xref="S4.E5.m1.32.32.1.1.1.cmml">[</mo><mrow id="S4.E5.m1.33.33.2.32.24.24.24.1.1.1.1.1"><msub id="S4.E5.m1.33.33.2.32.24.24.24.1.1.1.1.1.3"><mi id="S4.E5.m1.9.9.9.9.9.9" xref="S4.E5.m1.9.9.9.9.9.9.cmml">𝔽</mi><mi id="S4.E5.m1.10.10.10.10.10.10.1" xref="S4.E5.m1.10.10.10.10.10.10.1.cmml">proj</mi></msub><mo lspace="0em" rspace="0em" id="S4.E5.m1.33.33.2.32.24.24.24.1.1.1.1.1.2" xref="S4.E5.m1.32.32.1.1.1.cmml">​</mo><mrow id="S4.E5.m1.33.33.2.32.24.24.24.1.1.1.1.1.1.1"><mo stretchy="false" id="S4.E5.m1.11.11.11.11.11.11" xref="S4.E5.m1.32.32.1.1.1.cmml">(</mo><msubsup id="S4.E5.m1.33.33.2.32.24.24.24.1.1.1.1.1.1.1.1"><mi id="S4.E5.m1.12.12.12.12.12.12" xref="S4.E5.m1.12.12.12.12.12.12.cmml">𝐞</mi><mi id="S4.E5.m1.13.13.13.13.13.13.1" xref="S4.E5.m1.13.13.13.13.13.13.1.cmml">clip</mi><mi id="S4.E5.m1.14.14.14.14.14.14.1" xref="S4.E5.m1.14.14.14.14.14.14.1.cmml">mod</mi></msubsup><mo stretchy="false" id="S4.E5.m1.15.15.15.15.15.15" xref="S4.E5.m1.32.32.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E5.m1.16.16.16.16.16.16" xref="S4.E5.m1.32.32.1.1.1.cmml">;</mo><msub id="S4.E5.m1.33.33.2.32.24.24.24.1.1.1.2.2"><mi mathvariant="normal" id="S4.E5.m1.17.17.17.17.17.17" xref="S4.E5.m1.17.17.17.17.17.17.cmml">Q</mi><mi id="S4.E5.m1.18.18.18.18.18.18.1" xref="S4.E5.m1.18.18.18.18.18.18.1.cmml">l</mi></msub><mo stretchy="false" id="S4.E5.m1.19.19.19.19.19.19" xref="S4.E5.m1.32.32.1.1.1.cmml">]</mo></mrow><mo stretchy="false" id="S4.E5.m1.20.20.20.20.20.20" xref="S4.E5.m1.32.32.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E5.m1.21.21.21.21.21.21" xref="S4.E5.m1.21.21.21.21.21.21.cmml">∈</mo><msup id="S4.E5.m1.33.33.2.32.24.24.27"><mi id="S4.E5.m1.22.22.22.22.22.22" xref="S4.E5.m1.22.22.22.22.22.22.cmml">ℝ</mi><mrow id="S4.E5.m1.23.23.23.23.23.23.1" xref="S4.E5.m1.23.23.23.23.23.23.1.cmml"><mi id="S4.E5.m1.23.23.23.23.23.23.1.2" xref="S4.E5.m1.23.23.23.23.23.23.1.2.cmml">m</mi><mo lspace="0.222em" rspace="0.222em" id="S4.E5.m1.23.23.23.23.23.23.1.1" xref="S4.E5.m1.23.23.23.23.23.23.1.1.cmml">×</mo><mi id="S4.E5.m1.23.23.23.23.23.23.1.3" xref="S4.E5.m1.23.23.23.23.23.23.1.3.cmml">d</mi></mrow></msup></mrow></mtd></mtr><mtr id="S4.E5.m1.34.34.3c"><mtd id="S4.E5.m1.34.34.3d"><mrow id="S4.E5.m1.34.34.3.33.9.9.9"><mrow id="S4.E5.m1.34.34.3.33.9.9.9.1"><mi id="S4.E5.m1.24.24.24.1.1.1" xref="S4.E5.m1.24.24.24.1.1.1.cmml">mod</mi><mo id="S4.E5.m1.25.25.25.2.2.2" xref="S4.E5.m1.25.25.25.2.2.2.cmml">∈</mo><mrow id="S4.E5.m1.34.34.3.33.9.9.9.1.1"><mo stretchy="false" id="S4.E5.m1.26.26.26.3.3.3" xref="S4.E5.m1.32.32.1.1.1.cmml">{</mo><mi id="S4.E5.m1.27.27.27.4.4.4" xref="S4.E5.m1.27.27.27.4.4.4.cmml">txt</mi><mo id="S4.E5.m1.28.28.28.5.5.5" xref="S4.E5.m1.32.32.1.1.1.cmml">,</mo><mi id="S4.E5.m1.29.29.29.6.6.6" xref="S4.E5.m1.29.29.29.6.6.6.cmml">img</mi><mo stretchy="false" id="S4.E5.m1.30.30.30.7.7.7" xref="S4.E5.m1.32.32.1.1.1.cmml">}</mo></mrow></mrow><mo id="S4.E5.m1.31.31.31.8.8.8" xref="S4.E5.m1.32.32.1.1.1.cmml">,</mo></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S4.E5.m1.34b"><apply id="S4.E5.m1.32.32.1.1.1.cmml" xref="S4.E5.m1.33.33.2.32.24.24.24.2"><and id="S4.E5.m1.32.32.1.1.1a.cmml" xref="S4.E5.m1.33.33.2.32.24.24.24.2"></and><apply id="S4.E5.m1.32.32.1.1.1b.cmml" xref="S4.E5.m1.33.33.2.32.24.24.24.2"><eq id="S4.E5.m1.4.4.4.4.4.4.cmml" xref="S4.E5.m1.4.4.4.4.4.4"></eq><apply id="S4.E5.m1.32.32.1.1.1.3.cmml" xref="S4.E5.m1.33.33.2.32.24.24.24.2"><csymbol cd="ambiguous" id="S4.E5.m1.32.32.1.1.1.3.1.cmml" xref="S4.E5.m1.33.33.2.32.24.24.24.2">superscript</csymbol><apply id="S4.E5.m1.32.32.1.1.1.3.2.cmml" xref="S4.E5.m1.33.33.2.32.24.24.24.2"><csymbol cd="ambiguous" id="S4.E5.m1.32.32.1.1.1.3.2.1.cmml" xref="S4.E5.m1.33.33.2.32.24.24.24.2">subscript</csymbol><ci id="S4.E5.m1.1.1.1.1.1.1.cmml" xref="S4.E5.m1.1.1.1.1.1.1">Q</ci><ci id="S4.E5.m1.2.2.2.2.2.2.1.cmml" xref="S4.E5.m1.2.2.2.2.2.2.1">𝑙</ci></apply><ci id="S4.E5.m1.3.3.3.3.3.3.1.cmml" xref="S4.E5.m1.3.3.3.3.3.3.1">′</ci></apply><apply id="S4.E5.m1.32.32.1.1.1.1.cmml" xref="S4.E5.m1.33.33.2.32.24.24.24.2"><times id="S4.E5.m1.32.32.1.1.1.1.2.cmml" xref="S4.E5.m1.33.33.2.32.24.24.24.2"></times><apply id="S4.E5.m1.32.32.1.1.1.1.3.cmml" xref="S4.E5.m1.33.33.2.32.24.24.24.2"><csymbol cd="ambiguous" id="S4.E5.m1.32.32.1.1.1.1.3.1.cmml" xref="S4.E5.m1.33.33.2.32.24.24.24.2">subscript</csymbol><ci id="S4.E5.m1.5.5.5.5.5.5.cmml" xref="S4.E5.m1.5.5.5.5.5.5">SelfAttn</ci><ci id="S4.E5.m1.6.6.6.6.6.6.1.cmml" xref="S4.E5.m1.6.6.6.6.6.6.1">𝑙</ci></apply><list id="S4.E5.m1.32.32.1.1.1.1.1.1.1.3.cmml" xref="S4.E5.m1.33.33.2.32.24.24.24.2"><apply id="S4.E5.m1.32.32.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E5.m1.33.33.2.32.24.24.24.2"><times id="S4.E5.m1.32.32.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E5.m1.33.33.2.32.24.24.24.2"></times><apply id="S4.E5.m1.32.32.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E5.m1.33.33.2.32.24.24.24.2"><csymbol cd="ambiguous" id="S4.E5.m1.32.32.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E5.m1.33.33.2.32.24.24.24.2">subscript</csymbol><ci id="S4.E5.m1.9.9.9.9.9.9.cmml" xref="S4.E5.m1.9.9.9.9.9.9">𝔽</ci><ci id="S4.E5.m1.10.10.10.10.10.10.1.cmml" xref="S4.E5.m1.10.10.10.10.10.10.1">proj</ci></apply><apply id="S4.E5.m1.32.32.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E5.m1.33.33.2.32.24.24.24.2"><csymbol cd="ambiguous" id="S4.E5.m1.32.32.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E5.m1.33.33.2.32.24.24.24.2">superscript</csymbol><apply id="S4.E5.m1.32.32.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E5.m1.33.33.2.32.24.24.24.2"><csymbol cd="ambiguous" id="S4.E5.m1.32.32.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E5.m1.33.33.2.32.24.24.24.2">subscript</csymbol><ci id="S4.E5.m1.12.12.12.12.12.12.cmml" xref="S4.E5.m1.12.12.12.12.12.12">𝐞</ci><ci id="S4.E5.m1.13.13.13.13.13.13.1.cmml" xref="S4.E5.m1.13.13.13.13.13.13.1">clip</ci></apply><ci id="S4.E5.m1.14.14.14.14.14.14.1.cmml" xref="S4.E5.m1.14.14.14.14.14.14.1">mod</ci></apply></apply><apply id="S4.E5.m1.32.32.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E5.m1.33.33.2.32.24.24.24.2"><csymbol cd="ambiguous" id="S4.E5.m1.32.32.1.1.1.1.1.1.1.2.2.1.cmml" xref="S4.E5.m1.33.33.2.32.24.24.24.2">subscript</csymbol><ci id="S4.E5.m1.17.17.17.17.17.17.cmml" xref="S4.E5.m1.17.17.17.17.17.17">Q</ci><ci id="S4.E5.m1.18.18.18.18.18.18.1.cmml" xref="S4.E5.m1.18.18.18.18.18.18.1">𝑙</ci></apply></list></apply></apply><apply id="S4.E5.m1.32.32.1.1.1c.cmml" xref="S4.E5.m1.33.33.2.32.24.24.24.2"><in id="S4.E5.m1.21.21.21.21.21.21.cmml" xref="S4.E5.m1.21.21.21.21.21.21"></in><share href="#S4.E5.m1.32.32.1.1.1.1.cmml" id="S4.E5.m1.32.32.1.1.1d.cmml" xref="S4.E5.m1.33.33.2.32.24.24.24.2"></share><apply id="S4.E5.m1.32.32.1.1.1.6.cmml" xref="S4.E5.m1.33.33.2.32.24.24.24.2"><times id="S4.E5.m1.32.32.1.1.1.6.1.cmml" xref="S4.E5.m1.33.33.2.32.24.24.24.2"></times><apply id="S4.E5.m1.32.32.1.1.1.6.2.cmml" xref="S4.E5.m1.33.33.2.32.24.24.24.2"><csymbol cd="ambiguous" id="S4.E5.m1.32.32.1.1.1.6.2.1.cmml" xref="S4.E5.m1.33.33.2.32.24.24.24.2">superscript</csymbol><ci id="S4.E5.m1.22.22.22.22.22.22.cmml" xref="S4.E5.m1.22.22.22.22.22.22">ℝ</ci><apply id="S4.E5.m1.23.23.23.23.23.23.1.cmml" xref="S4.E5.m1.23.23.23.23.23.23.1"><times id="S4.E5.m1.23.23.23.23.23.23.1.1.cmml" xref="S4.E5.m1.23.23.23.23.23.23.1.1"></times><ci id="S4.E5.m1.23.23.23.23.23.23.1.2.cmml" xref="S4.E5.m1.23.23.23.23.23.23.1.2">𝑚</ci><ci id="S4.E5.m1.23.23.23.23.23.23.1.3.cmml" xref="S4.E5.m1.23.23.23.23.23.23.1.3">𝑑</ci></apply></apply><ci id="S4.E5.m1.24.24.24.1.1.1.cmml" xref="S4.E5.m1.24.24.24.1.1.1">mod</ci></apply></apply><apply id="S4.E5.m1.32.32.1.1.1e.cmml" xref="S4.E5.m1.33.33.2.32.24.24.24.2"><in id="S4.E5.m1.25.25.25.2.2.2.cmml" xref="S4.E5.m1.25.25.25.2.2.2"></in><share href="#S4.E5.m1.32.32.1.1.1.6.cmml" id="S4.E5.m1.32.32.1.1.1f.cmml" xref="S4.E5.m1.33.33.2.32.24.24.24.2"></share><set id="S4.E5.m1.32.32.1.1.1.8.cmml" xref="S4.E5.m1.33.33.2.32.24.24.24.2"><ci id="S4.E5.m1.27.27.27.4.4.4.cmml" xref="S4.E5.m1.27.27.27.4.4.4">txt</ci><ci id="S4.E5.m1.29.29.29.6.6.6.cmml" xref="S4.E5.m1.29.29.29.6.6.6">img</ci></set></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E5.m1.34c">\begin{gathered}{{\rm Q}_{l}^{\prime}={\rm SelfAttn}_{l}([{\rm\mathbb{F}}_{\rm proj}({\rm{\bf e}_{clip}^{mod}});{\rm Q}_{l}])}\in\mathbb{R}^{m\times d}\\
{\rm mod}\in{\rm\{txt,img\}},\end{gathered}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p id="S4.SS1.p2.5" class="ltx_p">where <math id="S4.SS1.p2.1.m1.1" class="ltx_Math" alttext="\mathbb{F}_{\rm proj}" display="inline"><semantics id="S4.SS1.p2.1.m1.1a"><msub id="S4.SS1.p2.1.m1.1.1" xref="S4.SS1.p2.1.m1.1.1.cmml"><mi id="S4.SS1.p2.1.m1.1.1.2" xref="S4.SS1.p2.1.m1.1.1.2.cmml">𝔽</mi><mi id="S4.SS1.p2.1.m1.1.1.3" xref="S4.SS1.p2.1.m1.1.1.3.cmml">proj</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.1.m1.1b"><apply id="S4.SS1.p2.1.m1.1.1.cmml" xref="S4.SS1.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.1.m1.1.1.1.cmml" xref="S4.SS1.p2.1.m1.1.1">subscript</csymbol><ci id="S4.SS1.p2.1.m1.1.1.2.cmml" xref="S4.SS1.p2.1.m1.1.1.2">𝔽</ci><ci id="S4.SS1.p2.1.m1.1.1.3.cmml" xref="S4.SS1.p2.1.m1.1.1.3">proj</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.1.m1.1c">\mathbb{F}_{\rm proj}</annotation></semantics></math> is the projection layer to ensure that the CLIP embedding dimension <math id="S4.SS1.p2.2.m2.1" class="ltx_Math" alttext="d^{\prime}" display="inline"><semantics id="S4.SS1.p2.2.m2.1a"><msup id="S4.SS1.p2.2.m2.1.1" xref="S4.SS1.p2.2.m2.1.1.cmml"><mi id="S4.SS1.p2.2.m2.1.1.2" xref="S4.SS1.p2.2.m2.1.1.2.cmml">d</mi><mo id="S4.SS1.p2.2.m2.1.1.3" xref="S4.SS1.p2.2.m2.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.2.m2.1b"><apply id="S4.SS1.p2.2.m2.1.1.cmml" xref="S4.SS1.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.2.m2.1.1.1.cmml" xref="S4.SS1.p2.2.m2.1.1">superscript</csymbol><ci id="S4.SS1.p2.2.m2.1.1.2.cmml" xref="S4.SS1.p2.2.m2.1.1.2">𝑑</ci><ci id="S4.SS1.p2.2.m2.1.1.3.cmml" xref="S4.SS1.p2.2.m2.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.2.m2.1c">d^{\prime}</annotation></semantics></math> matches the Transformer’s embedding dimension <math id="S4.SS1.p2.3.m3.1" class="ltx_Math" alttext="d" display="inline"><semantics id="S4.SS1.p2.3.m3.1a"><mi id="S4.SS1.p2.3.m3.1.1" xref="S4.SS1.p2.3.m3.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.3.m3.1b"><ci id="S4.SS1.p2.3.m3.1.1.cmml" xref="S4.SS1.p2.3.m3.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.3.m3.1c">d</annotation></semantics></math>. In Eq. (<a href="#S4.E5" title="In 4.1 Prompt-based Decoding ‣ 4 Prompt-OVD ‣ ​​Prompt-Guided Transformers for End-to-End Open-Vocabulary Object Detection​​" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>), we prepend only a single clip embedding for simplicity, but multiple clip embeddings of different classes can be prepended in a batch (e.g., 10 prompts for 10 different classes). This results in the object queires <math id="S4.SS1.p2.4.m4.1" class="ltx_Math" alttext="{\rm Q}^{\prime}" display="inline"><semantics id="S4.SS1.p2.4.m4.1a"><msup id="S4.SS1.p2.4.m4.1.1" xref="S4.SS1.p2.4.m4.1.1.cmml"><mi mathvariant="normal" id="S4.SS1.p2.4.m4.1.1.2" xref="S4.SS1.p2.4.m4.1.1.2.cmml">Q</mi><mo id="S4.SS1.p2.4.m4.1.1.3" xref="S4.SS1.p2.4.m4.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.4.m4.1b"><apply id="S4.SS1.p2.4.m4.1.1.cmml" xref="S4.SS1.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.4.m4.1.1.1.cmml" xref="S4.SS1.p2.4.m4.1.1">superscript</csymbol><ci id="S4.SS1.p2.4.m4.1.1.2.cmml" xref="S4.SS1.p2.4.m4.1.1.2">Q</ci><ci id="S4.SS1.p2.4.m4.1.1.3.cmml" xref="S4.SS1.p2.4.m4.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.4.m4.1c">{\rm Q}^{\prime}</annotation></semantics></math> becoming <em id="S4.SS1.p2.5.1" class="ltx_emph ltx_font_italic">class-agnostic</em> for the classes given by prompts. They are then fed as input to the cross-attention module in the same layer, aggregating key contents from the encoder output <math id="S4.SS1.p2.5.m5.1" class="ltx_Math" alttext="{\rm I}_{L}" display="inline"><semantics id="S4.SS1.p2.5.m5.1a"><msub id="S4.SS1.p2.5.m5.1.1" xref="S4.SS1.p2.5.m5.1.1.cmml"><mi mathvariant="normal" id="S4.SS1.p2.5.m5.1.1.2" xref="S4.SS1.p2.5.m5.1.1.2.cmml">I</mi><mi id="S4.SS1.p2.5.m5.1.1.3" xref="S4.SS1.p2.5.m5.1.1.3.cmml">L</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.5.m5.1b"><apply id="S4.SS1.p2.5.m5.1.1.cmml" xref="S4.SS1.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.5.m5.1.1.1.cmml" xref="S4.SS1.p2.5.m5.1.1">subscript</csymbol><ci id="S4.SS1.p2.5.m5.1.1.2.cmml" xref="S4.SS1.p2.5.m5.1.1.2">I</ci><ci id="S4.SS1.p2.5.m5.1.1.3.cmml" xref="S4.SS1.p2.5.m5.1.1.3">𝐿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.5.m5.1c">{\rm I}_{L}</annotation></semantics></math> to represent objects,</p>
<table id="S4.E6" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E6.m1.19" class="ltx_Math" alttext="\begin{gathered}{{\rm O}_{l}={\rm CrossAttn}_{l}({\rm Q}_{l}^{\prime},{\rm I}_{L})}\in\mathbb{R}^{m\times d}.\end{gathered}" display="block"><semantics id="S4.E6.m1.19a"><mtable displaystyle="true" id="S4.E6.m1.19.19.2"><mtr id="S4.E6.m1.19.19.2a"><mtd id="S4.E6.m1.19.19.2b"><mrow id="S4.E6.m1.19.19.2.18.18.18.18"><mrow id="S4.E6.m1.19.19.2.18.18.18.18.1"><msub id="S4.E6.m1.19.19.2.18.18.18.18.1.4"><mi mathvariant="normal" id="S4.E6.m1.1.1.1.1.1.1" xref="S4.E6.m1.1.1.1.1.1.1.cmml">O</mi><mi id="S4.E6.m1.2.2.2.2.2.2.1" xref="S4.E6.m1.2.2.2.2.2.2.1.cmml">l</mi></msub><mo id="S4.E6.m1.3.3.3.3.3.3" xref="S4.E6.m1.3.3.3.3.3.3.cmml">=</mo><mrow id="S4.E6.m1.19.19.2.18.18.18.18.1.2"><msub id="S4.E6.m1.19.19.2.18.18.18.18.1.2.4"><mi id="S4.E6.m1.4.4.4.4.4.4" xref="S4.E6.m1.4.4.4.4.4.4.cmml">CrossAttn</mi><mi id="S4.E6.m1.5.5.5.5.5.5.1" xref="S4.E6.m1.5.5.5.5.5.5.1.cmml">l</mi></msub><mo lspace="0em" rspace="0em" id="S4.E6.m1.19.19.2.18.18.18.18.1.2.3" xref="S4.E6.m1.18.18.1.1.1.cmml">​</mo><mrow id="S4.E6.m1.19.19.2.18.18.18.18.1.2.2.2"><mo stretchy="false" id="S4.E6.m1.6.6.6.6.6.6" xref="S4.E6.m1.18.18.1.1.1.cmml">(</mo><msubsup id="S4.E6.m1.19.19.2.18.18.18.18.1.1.1.1.1"><mi mathvariant="normal" id="S4.E6.m1.7.7.7.7.7.7" xref="S4.E6.m1.7.7.7.7.7.7.cmml">Q</mi><mi id="S4.E6.m1.8.8.8.8.8.8.1" xref="S4.E6.m1.8.8.8.8.8.8.1.cmml">l</mi><mo id="S4.E6.m1.9.9.9.9.9.9.1" xref="S4.E6.m1.9.9.9.9.9.9.1.cmml">′</mo></msubsup><mo id="S4.E6.m1.10.10.10.10.10.10" xref="S4.E6.m1.18.18.1.1.1.cmml">,</mo><msub id="S4.E6.m1.19.19.2.18.18.18.18.1.2.2.2.2"><mi mathvariant="normal" id="S4.E6.m1.11.11.11.11.11.11" xref="S4.E6.m1.11.11.11.11.11.11.cmml">I</mi><mi id="S4.E6.m1.12.12.12.12.12.12.1" xref="S4.E6.m1.12.12.12.12.12.12.1.cmml">L</mi></msub><mo stretchy="false" id="S4.E6.m1.13.13.13.13.13.13" xref="S4.E6.m1.18.18.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E6.m1.14.14.14.14.14.14" xref="S4.E6.m1.14.14.14.14.14.14.cmml">∈</mo><msup id="S4.E6.m1.19.19.2.18.18.18.18.1.5"><mi id="S4.E6.m1.15.15.15.15.15.15" xref="S4.E6.m1.15.15.15.15.15.15.cmml">ℝ</mi><mrow id="S4.E6.m1.16.16.16.16.16.16.1" xref="S4.E6.m1.16.16.16.16.16.16.1.cmml"><mi id="S4.E6.m1.16.16.16.16.16.16.1.2" xref="S4.E6.m1.16.16.16.16.16.16.1.2.cmml">m</mi><mo lspace="0.222em" rspace="0.222em" id="S4.E6.m1.16.16.16.16.16.16.1.1" xref="S4.E6.m1.16.16.16.16.16.16.1.1.cmml">×</mo><mi id="S4.E6.m1.16.16.16.16.16.16.1.3" xref="S4.E6.m1.16.16.16.16.16.16.1.3.cmml">d</mi></mrow></msup></mrow><mo lspace="0em" id="S4.E6.m1.17.17.17.17.17.17" xref="S4.E6.m1.18.18.1.1.1.cmml">.</mo></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S4.E6.m1.19b"><apply id="S4.E6.m1.18.18.1.1.1.cmml" xref="S4.E6.m1.19.19.2.18.18.18.18.1.2.3"><and id="S4.E6.m1.18.18.1.1.1a.cmml" xref="S4.E6.m1.19.19.2.18.18.18.18.1.2.3"></and><apply id="S4.E6.m1.18.18.1.1.1b.cmml" xref="S4.E6.m1.19.19.2.18.18.18.18.1.2.3"><eq id="S4.E6.m1.3.3.3.3.3.3.cmml" xref="S4.E6.m1.3.3.3.3.3.3"></eq><apply id="S4.E6.m1.18.18.1.1.1.4.cmml" xref="S4.E6.m1.19.19.2.18.18.18.18.1.2.3"><csymbol cd="ambiguous" id="S4.E6.m1.18.18.1.1.1.4.1.cmml" xref="S4.E6.m1.19.19.2.18.18.18.18.1.2.3">subscript</csymbol><ci id="S4.E6.m1.1.1.1.1.1.1.cmml" xref="S4.E6.m1.1.1.1.1.1.1">O</ci><ci id="S4.E6.m1.2.2.2.2.2.2.1.cmml" xref="S4.E6.m1.2.2.2.2.2.2.1">𝑙</ci></apply><apply id="S4.E6.m1.18.18.1.1.1.2.cmml" xref="S4.E6.m1.19.19.2.18.18.18.18.1.2.3"><times id="S4.E6.m1.18.18.1.1.1.2.3.cmml" xref="S4.E6.m1.19.19.2.18.18.18.18.1.2.3"></times><apply id="S4.E6.m1.18.18.1.1.1.2.4.cmml" xref="S4.E6.m1.19.19.2.18.18.18.18.1.2.3"><csymbol cd="ambiguous" id="S4.E6.m1.18.18.1.1.1.2.4.1.cmml" xref="S4.E6.m1.19.19.2.18.18.18.18.1.2.3">subscript</csymbol><ci id="S4.E6.m1.4.4.4.4.4.4.cmml" xref="S4.E6.m1.4.4.4.4.4.4">CrossAttn</ci><ci id="S4.E6.m1.5.5.5.5.5.5.1.cmml" xref="S4.E6.m1.5.5.5.5.5.5.1">𝑙</ci></apply><interval closure="open" id="S4.E6.m1.18.18.1.1.1.2.2.3.cmml" xref="S4.E6.m1.19.19.2.18.18.18.18.1.2.3"><apply id="S4.E6.m1.18.18.1.1.1.1.1.1.1.cmml" xref="S4.E6.m1.19.19.2.18.18.18.18.1.2.3"><csymbol cd="ambiguous" id="S4.E6.m1.18.18.1.1.1.1.1.1.1.1.cmml" xref="S4.E6.m1.19.19.2.18.18.18.18.1.2.3">superscript</csymbol><apply id="S4.E6.m1.18.18.1.1.1.1.1.1.1.2.cmml" xref="S4.E6.m1.19.19.2.18.18.18.18.1.2.3"><csymbol cd="ambiguous" id="S4.E6.m1.18.18.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E6.m1.19.19.2.18.18.18.18.1.2.3">subscript</csymbol><ci id="S4.E6.m1.7.7.7.7.7.7.cmml" xref="S4.E6.m1.7.7.7.7.7.7">Q</ci><ci id="S4.E6.m1.8.8.8.8.8.8.1.cmml" xref="S4.E6.m1.8.8.8.8.8.8.1">𝑙</ci></apply><ci id="S4.E6.m1.9.9.9.9.9.9.1.cmml" xref="S4.E6.m1.9.9.9.9.9.9.1">′</ci></apply><apply id="S4.E6.m1.18.18.1.1.1.2.2.2.2.cmml" xref="S4.E6.m1.19.19.2.18.18.18.18.1.2.3"><csymbol cd="ambiguous" id="S4.E6.m1.18.18.1.1.1.2.2.2.2.1.cmml" xref="S4.E6.m1.19.19.2.18.18.18.18.1.2.3">subscript</csymbol><ci id="S4.E6.m1.11.11.11.11.11.11.cmml" xref="S4.E6.m1.11.11.11.11.11.11">I</ci><ci id="S4.E6.m1.12.12.12.12.12.12.1.cmml" xref="S4.E6.m1.12.12.12.12.12.12.1">𝐿</ci></apply></interval></apply></apply><apply id="S4.E6.m1.18.18.1.1.1c.cmml" xref="S4.E6.m1.19.19.2.18.18.18.18.1.2.3"><in id="S4.E6.m1.14.14.14.14.14.14.cmml" xref="S4.E6.m1.14.14.14.14.14.14"></in><share href="#S4.E6.m1.18.18.1.1.1.2.cmml" id="S4.E6.m1.18.18.1.1.1d.cmml" xref="S4.E6.m1.19.19.2.18.18.18.18.1.2.3"></share><apply id="S4.E6.m1.18.18.1.1.1.7.cmml" xref="S4.E6.m1.19.19.2.18.18.18.18.1.2.3"><csymbol cd="ambiguous" id="S4.E6.m1.18.18.1.1.1.7.1.cmml" xref="S4.E6.m1.19.19.2.18.18.18.18.1.2.3">superscript</csymbol><ci id="S4.E6.m1.15.15.15.15.15.15.cmml" xref="S4.E6.m1.15.15.15.15.15.15">ℝ</ci><apply id="S4.E6.m1.16.16.16.16.16.16.1.cmml" xref="S4.E6.m1.16.16.16.16.16.16.1"><times id="S4.E6.m1.16.16.16.16.16.16.1.1.cmml" xref="S4.E6.m1.16.16.16.16.16.16.1.1"></times><ci id="S4.E6.m1.16.16.16.16.16.16.1.2.cmml" xref="S4.E6.m1.16.16.16.16.16.16.1.2">𝑚</ci><ci id="S4.E6.m1.16.16.16.16.16.16.1.3.cmml" xref="S4.E6.m1.16.16.16.16.16.16.1.3">𝑑</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E6.m1.19c">\begin{gathered}{{\rm O}_{l}={\rm CrossAttn}_{l}({\rm Q}_{l}^{\prime},{\rm I}_{L})}\in\mathbb{R}^{m\times d}.\end{gathered}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p id="S4.SS1.p2.8" class="ltx_p">The object embeding <math id="S4.SS1.p2.6.m1.1" class="ltx_Math" alttext="{\rm O}_{l}" display="inline"><semantics id="S4.SS1.p2.6.m1.1a"><msub id="S4.SS1.p2.6.m1.1.1" xref="S4.SS1.p2.6.m1.1.1.cmml"><mi mathvariant="normal" id="S4.SS1.p2.6.m1.1.1.2" xref="S4.SS1.p2.6.m1.1.1.2.cmml">O</mi><mi id="S4.SS1.p2.6.m1.1.1.3" xref="S4.SS1.p2.6.m1.1.1.3.cmml">l</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.6.m1.1b"><apply id="S4.SS1.p2.6.m1.1.1.cmml" xref="S4.SS1.p2.6.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.6.m1.1.1.1.cmml" xref="S4.SS1.p2.6.m1.1.1">subscript</csymbol><ci id="S4.SS1.p2.6.m1.1.1.2.cmml" xref="S4.SS1.p2.6.m1.1.1.2">O</ci><ci id="S4.SS1.p2.6.m1.1.1.3.cmml" xref="S4.SS1.p2.6.m1.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.6.m1.1c">{\rm O}_{l}</annotation></semantics></math> is also used as the object query <math id="S4.SS1.p2.7.m2.1" class="ltx_Math" alttext="{\rm Q}_{l+1}" display="inline"><semantics id="S4.SS1.p2.7.m2.1a"><msub id="S4.SS1.p2.7.m2.1.1" xref="S4.SS1.p2.7.m2.1.1.cmml"><mi mathvariant="normal" id="S4.SS1.p2.7.m2.1.1.2" xref="S4.SS1.p2.7.m2.1.1.2.cmml">Q</mi><mrow id="S4.SS1.p2.7.m2.1.1.3" xref="S4.SS1.p2.7.m2.1.1.3.cmml"><mi id="S4.SS1.p2.7.m2.1.1.3.2" xref="S4.SS1.p2.7.m2.1.1.3.2.cmml">l</mi><mo id="S4.SS1.p2.7.m2.1.1.3.1" xref="S4.SS1.p2.7.m2.1.1.3.1.cmml">+</mo><mn id="S4.SS1.p2.7.m2.1.1.3.3" xref="S4.SS1.p2.7.m2.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.7.m2.1b"><apply id="S4.SS1.p2.7.m2.1.1.cmml" xref="S4.SS1.p2.7.m2.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.7.m2.1.1.1.cmml" xref="S4.SS1.p2.7.m2.1.1">subscript</csymbol><ci id="S4.SS1.p2.7.m2.1.1.2.cmml" xref="S4.SS1.p2.7.m2.1.1.2">Q</ci><apply id="S4.SS1.p2.7.m2.1.1.3.cmml" xref="S4.SS1.p2.7.m2.1.1.3"><plus id="S4.SS1.p2.7.m2.1.1.3.1.cmml" xref="S4.SS1.p2.7.m2.1.1.3.1"></plus><ci id="S4.SS1.p2.7.m2.1.1.3.2.cmml" xref="S4.SS1.p2.7.m2.1.1.3.2">𝑙</ci><cn type="integer" id="S4.SS1.p2.7.m2.1.1.3.3.cmml" xref="S4.SS1.p2.7.m2.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.7.m2.1c">{\rm Q}_{l+1}</annotation></semantics></math> to the next layer and, therefore, the final object embedding <math id="S4.SS1.p2.8.m3.1" class="ltx_Math" alttext="{\rm O}_{L}" display="inline"><semantics id="S4.SS1.p2.8.m3.1a"><msub id="S4.SS1.p2.8.m3.1.1" xref="S4.SS1.p2.8.m3.1.1.cmml"><mi mathvariant="normal" id="S4.SS1.p2.8.m3.1.1.2" xref="S4.SS1.p2.8.m3.1.1.2.cmml">O</mi><mi id="S4.SS1.p2.8.m3.1.1.3" xref="S4.SS1.p2.8.m3.1.1.3.cmml">L</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.8.m3.1b"><apply id="S4.SS1.p2.8.m3.1.1.cmml" xref="S4.SS1.p2.8.m3.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.8.m3.1.1.1.cmml" xref="S4.SS1.p2.8.m3.1.1">subscript</csymbol><ci id="S4.SS1.p2.8.m3.1.1.2.cmml" xref="S4.SS1.p2.8.m3.1.1.2">O</ci><ci id="S4.SS1.p2.8.m3.1.1.3.cmml" xref="S4.SS1.p2.8.m3.1.1.3">𝐿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.8.m3.1c">{\rm O}_{L}</annotation></semantics></math> is the output of the last decoding layer.</p>
</div>
<div id="S4.SS1.p3" class="ltx_para ltx_noindent">
<p id="S4.SS1.p3.4" class="ltx_p"><span id="S4.SS1.p3.4.1" class="ltx_text ltx_font_bold">Prediction.</span> Figure <a href="#S4.F2" title="Figure 2 ‣ 4.1 Prompt-based Decoding ‣ 4 Prompt-OVD ‣ ​​Prompt-Guided Transformers for End-to-End Open-Vocabulary Object Detection​​" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> contrasts the difference in label assignment after decoding of OV-DETR and Prompt-OVD. Specifically, OV-DETR forces all the object queries to be class-specific for binary classification, which requires input query tokens (i.e., the input of Transformer decoding layers) whose number is linearly proportional to the number of detected classes. For example, when using LVIS data with 1,203 classes, it requires <math id="S4.SS1.p3.1.m1.2" class="ltx_Math" alttext="1,203\times m" display="inline"><semantics id="S4.SS1.p3.1.m1.2a"><mrow id="S4.SS1.p3.1.m1.2.2.1" xref="S4.SS1.p3.1.m1.2.2.2.cmml"><mn id="S4.SS1.p3.1.m1.1.1" xref="S4.SS1.p3.1.m1.1.1.cmml">1</mn><mo id="S4.SS1.p3.1.m1.2.2.1.2" xref="S4.SS1.p3.1.m1.2.2.2.cmml">,</mo><mrow id="S4.SS1.p3.1.m1.2.2.1.1" xref="S4.SS1.p3.1.m1.2.2.1.1.cmml"><mn id="S4.SS1.p3.1.m1.2.2.1.1.2" xref="S4.SS1.p3.1.m1.2.2.1.1.2.cmml">203</mn><mo lspace="0.222em" rspace="0.222em" id="S4.SS1.p3.1.m1.2.2.1.1.1" xref="S4.SS1.p3.1.m1.2.2.1.1.1.cmml">×</mo><mi id="S4.SS1.p3.1.m1.2.2.1.1.3" xref="S4.SS1.p3.1.m1.2.2.1.1.3.cmml">m</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.1.m1.2b"><list id="S4.SS1.p3.1.m1.2.2.2.cmml" xref="S4.SS1.p3.1.m1.2.2.1"><cn type="integer" id="S4.SS1.p3.1.m1.1.1.cmml" xref="S4.SS1.p3.1.m1.1.1">1</cn><apply id="S4.SS1.p3.1.m1.2.2.1.1.cmml" xref="S4.SS1.p3.1.m1.2.2.1.1"><times id="S4.SS1.p3.1.m1.2.2.1.1.1.cmml" xref="S4.SS1.p3.1.m1.2.2.1.1.1"></times><cn type="integer" id="S4.SS1.p3.1.m1.2.2.1.1.2.cmml" xref="S4.SS1.p3.1.m1.2.2.1.1.2">203</cn><ci id="S4.SS1.p3.1.m1.2.2.1.1.3.cmml" xref="S4.SS1.p3.1.m1.2.2.1.1.3">𝑚</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.1.m1.2c">1,203\times m</annotation></semantics></math> object embeddings where <math id="S4.SS1.p3.2.m2.2" class="ltx_Math" alttext="m=1,500" display="inline"><semantics id="S4.SS1.p3.2.m2.2a"><mrow id="S4.SS1.p3.2.m2.2.3" xref="S4.SS1.p3.2.m2.2.3.cmml"><mi id="S4.SS1.p3.2.m2.2.3.2" xref="S4.SS1.p3.2.m2.2.3.2.cmml">m</mi><mo id="S4.SS1.p3.2.m2.2.3.1" xref="S4.SS1.p3.2.m2.2.3.1.cmml">=</mo><mrow id="S4.SS1.p3.2.m2.2.3.3.2" xref="S4.SS1.p3.2.m2.2.3.3.1.cmml"><mn id="S4.SS1.p3.2.m2.1.1" xref="S4.SS1.p3.2.m2.1.1.cmml">1</mn><mo id="S4.SS1.p3.2.m2.2.3.3.2.1" xref="S4.SS1.p3.2.m2.2.3.3.1.cmml">,</mo><mn id="S4.SS1.p3.2.m2.2.2" xref="S4.SS1.p3.2.m2.2.2.cmml">500</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.2.m2.2b"><apply id="S4.SS1.p3.2.m2.2.3.cmml" xref="S4.SS1.p3.2.m2.2.3"><eq id="S4.SS1.p3.2.m2.2.3.1.cmml" xref="S4.SS1.p3.2.m2.2.3.1"></eq><ci id="S4.SS1.p3.2.m2.2.3.2.cmml" xref="S4.SS1.p3.2.m2.2.3.2">𝑚</ci><list id="S4.SS1.p3.2.m2.2.3.3.1.cmml" xref="S4.SS1.p3.2.m2.2.3.3.2"><cn type="integer" id="S4.SS1.p3.2.m2.1.1.cmml" xref="S4.SS1.p3.2.m2.1.1">1</cn><cn type="integer" id="S4.SS1.p3.2.m2.2.2.cmml" xref="S4.SS1.p3.2.m2.2.2">500</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.2.m2.2c">m=1,500</annotation></semantics></math> by default. On the other hand, Prompt-OVD uses class-agnostic queries with prompts, which turns binary classification into a <em id="S4.SS1.p3.4.2" class="ltx_emph ltx_font_italic">multi-label</em> classification.<span id="footnote1" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>Multi-label classification is a generalization of multi-class classification. Here, the labels are nonexclusive and there is no constraint on how many of the classes each RoI (bounding box) can include.</span></span></span> This requires only <math id="S4.SS1.p3.3.m3.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S4.SS1.p3.3.m3.1a"><mi id="S4.SS1.p3.3.m3.1.1" xref="S4.SS1.p3.3.m3.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.3.m3.1b"><ci id="S4.SS1.p3.3.m3.1.1.cmml" xref="S4.SS1.p3.3.m3.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.3.m3.1c">m</annotation></semantics></math> object embeddings but having identical number of predictions, i.e., <math id="S4.SS1.p3.4.m4.1" class="ltx_Math" alttext="k\times m" display="inline"><semantics id="S4.SS1.p3.4.m4.1a"><mrow id="S4.SS1.p3.4.m4.1.1" xref="S4.SS1.p3.4.m4.1.1.cmml"><mi id="S4.SS1.p3.4.m4.1.1.2" xref="S4.SS1.p3.4.m4.1.1.2.cmml">k</mi><mo lspace="0.222em" rspace="0.222em" id="S4.SS1.p3.4.m4.1.1.1" xref="S4.SS1.p3.4.m4.1.1.1.cmml">×</mo><mi id="S4.SS1.p3.4.m4.1.1.3" xref="S4.SS1.p3.4.m4.1.1.3.cmml">m</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.4.m4.1b"><apply id="S4.SS1.p3.4.m4.1.1.cmml" xref="S4.SS1.p3.4.m4.1.1"><times id="S4.SS1.p3.4.m4.1.1.1.cmml" xref="S4.SS1.p3.4.m4.1.1.1"></times><ci id="S4.SS1.p3.4.m4.1.1.2.cmml" xref="S4.SS1.p3.4.m4.1.1.2">𝑘</ci><ci id="S4.SS1.p3.4.m4.1.1.3.cmml" xref="S4.SS1.p3.4.m4.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.4.m4.1c">k\times m</annotation></semantics></math>. As for the box regression, each object embedding produces a single bounding box.</p>
</div>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Ensemble with ViT-based CLIP</h3>

<figure id="S4.F3" class="ltx_figure"><img src="/html/2303.14386/assets/x3.png" id="S4.F3.1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="260" height="107" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F3.3.1.1" class="ltx_text" style="font-size:90%;">Figure 3</span>: </span><span id="S4.F3.4.2" class="ltx_text" style="font-size:90%;">Attention mask generation with RoIs. </span></figcaption>
</figure>
<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.2" class="ltx_p">Our second objective is to improve the classification performance on base and novel classes by utilizing the <em id="S4.SS2.p1.2.1" class="ltx_emph ltx_font_italic">zero-shot</em> classification ability of the ViT-based CLIP. Let <math id="S4.SS2.p1.1.m1.2" class="ltx_Math" alttext="{\rm\hat{B}_{det}}=\{{\bf b}_{1},\dots\bf b_{m}\}" display="inline"><semantics id="S4.SS2.p1.1.m1.2a"><mrow id="S4.SS2.p1.1.m1.2.2" xref="S4.SS2.p1.1.m1.2.2.cmml"><msub id="S4.SS2.p1.1.m1.2.2.4" xref="S4.SS2.p1.1.m1.2.2.4.cmml"><mover accent="true" id="S4.SS2.p1.1.m1.2.2.4.2" xref="S4.SS2.p1.1.m1.2.2.4.2.cmml"><mi mathvariant="normal" id="S4.SS2.p1.1.m1.2.2.4.2.2" xref="S4.SS2.p1.1.m1.2.2.4.2.2.cmml">B</mi><mo id="S4.SS2.p1.1.m1.2.2.4.2.1" xref="S4.SS2.p1.1.m1.2.2.4.2.1.cmml">^</mo></mover><mi id="S4.SS2.p1.1.m1.2.2.4.3" xref="S4.SS2.p1.1.m1.2.2.4.3.cmml">det</mi></msub><mo id="S4.SS2.p1.1.m1.2.2.3" xref="S4.SS2.p1.1.m1.2.2.3.cmml">=</mo><mrow id="S4.SS2.p1.1.m1.2.2.2.2" xref="S4.SS2.p1.1.m1.2.2.2.3.cmml"><mo stretchy="false" id="S4.SS2.p1.1.m1.2.2.2.2.3" xref="S4.SS2.p1.1.m1.2.2.2.3.cmml">{</mo><msub id="S4.SS2.p1.1.m1.1.1.1.1.1" xref="S4.SS2.p1.1.m1.1.1.1.1.1.cmml"><mi id="S4.SS2.p1.1.m1.1.1.1.1.1.2" xref="S4.SS2.p1.1.m1.1.1.1.1.1.2.cmml">𝐛</mi><mn id="S4.SS2.p1.1.m1.1.1.1.1.1.3" xref="S4.SS2.p1.1.m1.1.1.1.1.1.3.cmml">1</mn></msub><mo id="S4.SS2.p1.1.m1.2.2.2.2.4" xref="S4.SS2.p1.1.m1.2.2.2.3.cmml">,</mo><mrow id="S4.SS2.p1.1.m1.2.2.2.2.2" xref="S4.SS2.p1.1.m1.2.2.2.2.2.cmml"><mi mathvariant="normal" id="S4.SS2.p1.1.m1.2.2.2.2.2.2" xref="S4.SS2.p1.1.m1.2.2.2.2.2.2.cmml">…</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p1.1.m1.2.2.2.2.2.1" xref="S4.SS2.p1.1.m1.2.2.2.2.2.1.cmml">​</mo><msub id="S4.SS2.p1.1.m1.2.2.2.2.2.3" xref="S4.SS2.p1.1.m1.2.2.2.2.2.3.cmml"><mi id="S4.SS2.p1.1.m1.2.2.2.2.2.3.2" xref="S4.SS2.p1.1.m1.2.2.2.2.2.3.2.cmml">𝐛</mi><mi id="S4.SS2.p1.1.m1.2.2.2.2.2.3.3" xref="S4.SS2.p1.1.m1.2.2.2.2.2.3.3.cmml">m</mi></msub></mrow><mo stretchy="false" id="S4.SS2.p1.1.m1.2.2.2.2.5" xref="S4.SS2.p1.1.m1.2.2.2.3.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.1.m1.2b"><apply id="S4.SS2.p1.1.m1.2.2.cmml" xref="S4.SS2.p1.1.m1.2.2"><eq id="S4.SS2.p1.1.m1.2.2.3.cmml" xref="S4.SS2.p1.1.m1.2.2.3"></eq><apply id="S4.SS2.p1.1.m1.2.2.4.cmml" xref="S4.SS2.p1.1.m1.2.2.4"><csymbol cd="ambiguous" id="S4.SS2.p1.1.m1.2.2.4.1.cmml" xref="S4.SS2.p1.1.m1.2.2.4">subscript</csymbol><apply id="S4.SS2.p1.1.m1.2.2.4.2.cmml" xref="S4.SS2.p1.1.m1.2.2.4.2"><ci id="S4.SS2.p1.1.m1.2.2.4.2.1.cmml" xref="S4.SS2.p1.1.m1.2.2.4.2.1">^</ci><ci id="S4.SS2.p1.1.m1.2.2.4.2.2.cmml" xref="S4.SS2.p1.1.m1.2.2.4.2.2">B</ci></apply><ci id="S4.SS2.p1.1.m1.2.2.4.3.cmml" xref="S4.SS2.p1.1.m1.2.2.4.3">det</ci></apply><set id="S4.SS2.p1.1.m1.2.2.2.3.cmml" xref="S4.SS2.p1.1.m1.2.2.2.2"><apply id="S4.SS2.p1.1.m1.1.1.1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.1.m1.1.1.1.1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1.1.1.1">subscript</csymbol><ci id="S4.SS2.p1.1.m1.1.1.1.1.1.2.cmml" xref="S4.SS2.p1.1.m1.1.1.1.1.1.2">𝐛</ci><cn type="integer" id="S4.SS2.p1.1.m1.1.1.1.1.1.3.cmml" xref="S4.SS2.p1.1.m1.1.1.1.1.1.3">1</cn></apply><apply id="S4.SS2.p1.1.m1.2.2.2.2.2.cmml" xref="S4.SS2.p1.1.m1.2.2.2.2.2"><times id="S4.SS2.p1.1.m1.2.2.2.2.2.1.cmml" xref="S4.SS2.p1.1.m1.2.2.2.2.2.1"></times><ci id="S4.SS2.p1.1.m1.2.2.2.2.2.2.cmml" xref="S4.SS2.p1.1.m1.2.2.2.2.2.2">…</ci><apply id="S4.SS2.p1.1.m1.2.2.2.2.2.3.cmml" xref="S4.SS2.p1.1.m1.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S4.SS2.p1.1.m1.2.2.2.2.2.3.1.cmml" xref="S4.SS2.p1.1.m1.2.2.2.2.2.3">subscript</csymbol><ci id="S4.SS2.p1.1.m1.2.2.2.2.2.3.2.cmml" xref="S4.SS2.p1.1.m1.2.2.2.2.2.3.2">𝐛</ci><ci id="S4.SS2.p1.1.m1.2.2.2.2.2.3.3.cmml" xref="S4.SS2.p1.1.m1.2.2.2.2.2.3.3">𝑚</ci></apply></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.1.m1.2c">{\rm\hat{B}_{det}}=\{{\bf b}_{1},\dots\bf b_{m}\}</annotation></semantics></math> denote the set of <math id="S4.SS2.p1.2.m2.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S4.SS2.p1.2.m2.1a"><mi id="S4.SS2.p1.2.m2.1.1" xref="S4.SS2.p1.2.m2.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.2.m2.1b"><ci id="S4.SS2.p1.2.m2.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.2.m2.1c">m</annotation></semantics></math> bounding boxes predicted by the prompt-based decoding as in Eq. (<a href="#S3.E3" title="In 3 Preliminary ‣ ​​Prompt-Guided Transformers for End-to-End Open-Vocabulary Object Detection​​" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>). For zero-shot classification, a naive approach is repeatedly inferring on the cropped image for all RoIs as:</p>
<table id="S4.E7" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E7.m1.2" class="ltx_Math" alttext="\forall_{1\leq i\leq m}{\bf e}^{\rm img}_{i}={\rm CLIP}_{\rm img}\big{(}{\rm Crop}({\bf x},{\bf b}_{i})\big{)}\in\mathbb{R}^{d^{\prime}}," display="block"><semantics id="S4.E7.m1.2a"><mrow id="S4.E7.m1.2.2.1" xref="S4.E7.m1.2.2.1.1.cmml"><mrow id="S4.E7.m1.2.2.1.1" xref="S4.E7.m1.2.2.1.1.cmml"><mrow id="S4.E7.m1.2.2.1.1.3" xref="S4.E7.m1.2.2.1.1.3.cmml"><msub id="S4.E7.m1.2.2.1.1.3.1" xref="S4.E7.m1.2.2.1.1.3.1.cmml"><mo id="S4.E7.m1.2.2.1.1.3.1.2" xref="S4.E7.m1.2.2.1.1.3.1.2.cmml">∀</mo><mrow id="S4.E7.m1.2.2.1.1.3.1.3" xref="S4.E7.m1.2.2.1.1.3.1.3.cmml"><mn id="S4.E7.m1.2.2.1.1.3.1.3.2" xref="S4.E7.m1.2.2.1.1.3.1.3.2.cmml">1</mn><mo id="S4.E7.m1.2.2.1.1.3.1.3.3" xref="S4.E7.m1.2.2.1.1.3.1.3.3.cmml">≤</mo><mi id="S4.E7.m1.2.2.1.1.3.1.3.4" xref="S4.E7.m1.2.2.1.1.3.1.3.4.cmml">i</mi><mo id="S4.E7.m1.2.2.1.1.3.1.3.5" xref="S4.E7.m1.2.2.1.1.3.1.3.5.cmml">≤</mo><mi id="S4.E7.m1.2.2.1.1.3.1.3.6" xref="S4.E7.m1.2.2.1.1.3.1.3.6.cmml">m</mi></mrow></msub><msubsup id="S4.E7.m1.2.2.1.1.3.2" xref="S4.E7.m1.2.2.1.1.3.2.cmml"><mi id="S4.E7.m1.2.2.1.1.3.2.2.2" xref="S4.E7.m1.2.2.1.1.3.2.2.2.cmml">𝐞</mi><mi id="S4.E7.m1.2.2.1.1.3.2.3" xref="S4.E7.m1.2.2.1.1.3.2.3.cmml">i</mi><mi id="S4.E7.m1.2.2.1.1.3.2.2.3" xref="S4.E7.m1.2.2.1.1.3.2.2.3.cmml">img</mi></msubsup></mrow><mo id="S4.E7.m1.2.2.1.1.4" xref="S4.E7.m1.2.2.1.1.4.cmml">=</mo><mrow id="S4.E7.m1.2.2.1.1.1" xref="S4.E7.m1.2.2.1.1.1.cmml"><msub id="S4.E7.m1.2.2.1.1.1.3" xref="S4.E7.m1.2.2.1.1.1.3.cmml"><mi id="S4.E7.m1.2.2.1.1.1.3.2" xref="S4.E7.m1.2.2.1.1.1.3.2.cmml">CLIP</mi><mi id="S4.E7.m1.2.2.1.1.1.3.3" xref="S4.E7.m1.2.2.1.1.1.3.3.cmml">img</mi></msub><mo lspace="0em" rspace="0em" id="S4.E7.m1.2.2.1.1.1.2" xref="S4.E7.m1.2.2.1.1.1.2.cmml">​</mo><mrow id="S4.E7.m1.2.2.1.1.1.1.1" xref="S4.E7.m1.2.2.1.1.1.1.1.1.cmml"><mo maxsize="120%" minsize="120%" id="S4.E7.m1.2.2.1.1.1.1.1.2" xref="S4.E7.m1.2.2.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E7.m1.2.2.1.1.1.1.1.1" xref="S4.E7.m1.2.2.1.1.1.1.1.1.cmml"><mi id="S4.E7.m1.2.2.1.1.1.1.1.1.3" xref="S4.E7.m1.2.2.1.1.1.1.1.1.3.cmml">Crop</mi><mo lspace="0em" rspace="0em" id="S4.E7.m1.2.2.1.1.1.1.1.1.2" xref="S4.E7.m1.2.2.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S4.E7.m1.2.2.1.1.1.1.1.1.1.1" xref="S4.E7.m1.2.2.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S4.E7.m1.2.2.1.1.1.1.1.1.1.1.2" xref="S4.E7.m1.2.2.1.1.1.1.1.1.1.2.cmml">(</mo><mi id="S4.E7.m1.1.1" xref="S4.E7.m1.1.1.cmml">𝐱</mi><mo id="S4.E7.m1.2.2.1.1.1.1.1.1.1.1.3" xref="S4.E7.m1.2.2.1.1.1.1.1.1.1.2.cmml">,</mo><msub id="S4.E7.m1.2.2.1.1.1.1.1.1.1.1.1" xref="S4.E7.m1.2.2.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E7.m1.2.2.1.1.1.1.1.1.1.1.1.2" xref="S4.E7.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml">𝐛</mi><mi id="S4.E7.m1.2.2.1.1.1.1.1.1.1.1.1.3" xref="S4.E7.m1.2.2.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S4.E7.m1.2.2.1.1.1.1.1.1.1.1.4" xref="S4.E7.m1.2.2.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo maxsize="120%" minsize="120%" id="S4.E7.m1.2.2.1.1.1.1.1.3" xref="S4.E7.m1.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E7.m1.2.2.1.1.5" xref="S4.E7.m1.2.2.1.1.5.cmml">∈</mo><msup id="S4.E7.m1.2.2.1.1.6" xref="S4.E7.m1.2.2.1.1.6.cmml"><mi id="S4.E7.m1.2.2.1.1.6.2" xref="S4.E7.m1.2.2.1.1.6.2.cmml">ℝ</mi><msup id="S4.E7.m1.2.2.1.1.6.3" xref="S4.E7.m1.2.2.1.1.6.3.cmml"><mi id="S4.E7.m1.2.2.1.1.6.3.2" xref="S4.E7.m1.2.2.1.1.6.3.2.cmml">d</mi><mo id="S4.E7.m1.2.2.1.1.6.3.3" xref="S4.E7.m1.2.2.1.1.6.3.3.cmml">′</mo></msup></msup></mrow><mo id="S4.E7.m1.2.2.1.2" xref="S4.E7.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E7.m1.2b"><apply id="S4.E7.m1.2.2.1.1.cmml" xref="S4.E7.m1.2.2.1"><and id="S4.E7.m1.2.2.1.1a.cmml" xref="S4.E7.m1.2.2.1"></and><apply id="S4.E7.m1.2.2.1.1b.cmml" xref="S4.E7.m1.2.2.1"><eq id="S4.E7.m1.2.2.1.1.4.cmml" xref="S4.E7.m1.2.2.1.1.4"></eq><apply id="S4.E7.m1.2.2.1.1.3.cmml" xref="S4.E7.m1.2.2.1.1.3"><apply id="S4.E7.m1.2.2.1.1.3.1.cmml" xref="S4.E7.m1.2.2.1.1.3.1"><csymbol cd="ambiguous" id="S4.E7.m1.2.2.1.1.3.1.1.cmml" xref="S4.E7.m1.2.2.1.1.3.1">subscript</csymbol><csymbol cd="latexml" id="S4.E7.m1.2.2.1.1.3.1.2.cmml" xref="S4.E7.m1.2.2.1.1.3.1.2">for-all</csymbol><apply id="S4.E7.m1.2.2.1.1.3.1.3.cmml" xref="S4.E7.m1.2.2.1.1.3.1.3"><and id="S4.E7.m1.2.2.1.1.3.1.3a.cmml" xref="S4.E7.m1.2.2.1.1.3.1.3"></and><apply id="S4.E7.m1.2.2.1.1.3.1.3b.cmml" xref="S4.E7.m1.2.2.1.1.3.1.3"><leq id="S4.E7.m1.2.2.1.1.3.1.3.3.cmml" xref="S4.E7.m1.2.2.1.1.3.1.3.3"></leq><cn type="integer" id="S4.E7.m1.2.2.1.1.3.1.3.2.cmml" xref="S4.E7.m1.2.2.1.1.3.1.3.2">1</cn><ci id="S4.E7.m1.2.2.1.1.3.1.3.4.cmml" xref="S4.E7.m1.2.2.1.1.3.1.3.4">𝑖</ci></apply><apply id="S4.E7.m1.2.2.1.1.3.1.3c.cmml" xref="S4.E7.m1.2.2.1.1.3.1.3"><leq id="S4.E7.m1.2.2.1.1.3.1.3.5.cmml" xref="S4.E7.m1.2.2.1.1.3.1.3.5"></leq><share href="#S4.E7.m1.2.2.1.1.3.1.3.4.cmml" id="S4.E7.m1.2.2.1.1.3.1.3d.cmml" xref="S4.E7.m1.2.2.1.1.3.1.3"></share><ci id="S4.E7.m1.2.2.1.1.3.1.3.6.cmml" xref="S4.E7.m1.2.2.1.1.3.1.3.6">𝑚</ci></apply></apply></apply><apply id="S4.E7.m1.2.2.1.1.3.2.cmml" xref="S4.E7.m1.2.2.1.1.3.2"><csymbol cd="ambiguous" id="S4.E7.m1.2.2.1.1.3.2.1.cmml" xref="S4.E7.m1.2.2.1.1.3.2">subscript</csymbol><apply id="S4.E7.m1.2.2.1.1.3.2.2.cmml" xref="S4.E7.m1.2.2.1.1.3.2"><csymbol cd="ambiguous" id="S4.E7.m1.2.2.1.1.3.2.2.1.cmml" xref="S4.E7.m1.2.2.1.1.3.2">superscript</csymbol><ci id="S4.E7.m1.2.2.1.1.3.2.2.2.cmml" xref="S4.E7.m1.2.2.1.1.3.2.2.2">𝐞</ci><ci id="S4.E7.m1.2.2.1.1.3.2.2.3.cmml" xref="S4.E7.m1.2.2.1.1.3.2.2.3">img</ci></apply><ci id="S4.E7.m1.2.2.1.1.3.2.3.cmml" xref="S4.E7.m1.2.2.1.1.3.2.3">𝑖</ci></apply></apply><apply id="S4.E7.m1.2.2.1.1.1.cmml" xref="S4.E7.m1.2.2.1.1.1"><times id="S4.E7.m1.2.2.1.1.1.2.cmml" xref="S4.E7.m1.2.2.1.1.1.2"></times><apply id="S4.E7.m1.2.2.1.1.1.3.cmml" xref="S4.E7.m1.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S4.E7.m1.2.2.1.1.1.3.1.cmml" xref="S4.E7.m1.2.2.1.1.1.3">subscript</csymbol><ci id="S4.E7.m1.2.2.1.1.1.3.2.cmml" xref="S4.E7.m1.2.2.1.1.1.3.2">CLIP</ci><ci id="S4.E7.m1.2.2.1.1.1.3.3.cmml" xref="S4.E7.m1.2.2.1.1.1.3.3">img</ci></apply><apply id="S4.E7.m1.2.2.1.1.1.1.1.1.cmml" xref="S4.E7.m1.2.2.1.1.1.1.1"><times id="S4.E7.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S4.E7.m1.2.2.1.1.1.1.1.1.2"></times><ci id="S4.E7.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S4.E7.m1.2.2.1.1.1.1.1.1.3">Crop</ci><interval closure="open" id="S4.E7.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="S4.E7.m1.2.2.1.1.1.1.1.1.1.1"><ci id="S4.E7.m1.1.1.cmml" xref="S4.E7.m1.1.1">𝐱</ci><apply id="S4.E7.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E7.m1.2.2.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E7.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E7.m1.2.2.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E7.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E7.m1.2.2.1.1.1.1.1.1.1.1.1.2">𝐛</ci><ci id="S4.E7.m1.2.2.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E7.m1.2.2.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></interval></apply></apply></apply><apply id="S4.E7.m1.2.2.1.1c.cmml" xref="S4.E7.m1.2.2.1"><in id="S4.E7.m1.2.2.1.1.5.cmml" xref="S4.E7.m1.2.2.1.1.5"></in><share href="#S4.E7.m1.2.2.1.1.1.cmml" id="S4.E7.m1.2.2.1.1d.cmml" xref="S4.E7.m1.2.2.1"></share><apply id="S4.E7.m1.2.2.1.1.6.cmml" xref="S4.E7.m1.2.2.1.1.6"><csymbol cd="ambiguous" id="S4.E7.m1.2.2.1.1.6.1.cmml" xref="S4.E7.m1.2.2.1.1.6">superscript</csymbol><ci id="S4.E7.m1.2.2.1.1.6.2.cmml" xref="S4.E7.m1.2.2.1.1.6.2">ℝ</ci><apply id="S4.E7.m1.2.2.1.1.6.3.cmml" xref="S4.E7.m1.2.2.1.1.6.3"><csymbol cd="ambiguous" id="S4.E7.m1.2.2.1.1.6.3.1.cmml" xref="S4.E7.m1.2.2.1.1.6.3">superscript</csymbol><ci id="S4.E7.m1.2.2.1.1.6.3.2.cmml" xref="S4.E7.m1.2.2.1.1.6.3.2">𝑑</ci><ci id="S4.E7.m1.2.2.1.1.6.3.3.cmml" xref="S4.E7.m1.2.2.1.1.6.3.3">′</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E7.m1.2c">\forall_{1\leq i\leq m}{\bf e}^{\rm img}_{i}={\rm CLIP}_{\rm img}\big{(}{\rm Crop}({\bf x},{\bf b}_{i})\big{)}\in\mathbb{R}^{d^{\prime}},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p id="S4.SS2.p1.5" class="ltx_p">and calculation of cosine similarity between the embedding <math id="S4.SS2.p1.3.m1.1" class="ltx_Math" alttext="{\bf e}^{\rm img}_{i}" display="inline"><semantics id="S4.SS2.p1.3.m1.1a"><msubsup id="S4.SS2.p1.3.m1.1.1" xref="S4.SS2.p1.3.m1.1.1.cmml"><mi id="S4.SS2.p1.3.m1.1.1.2.2" xref="S4.SS2.p1.3.m1.1.1.2.2.cmml">𝐞</mi><mi id="S4.SS2.p1.3.m1.1.1.3" xref="S4.SS2.p1.3.m1.1.1.3.cmml">i</mi><mi id="S4.SS2.p1.3.m1.1.1.2.3" xref="S4.SS2.p1.3.m1.1.1.2.3.cmml">img</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.3.m1.1b"><apply id="S4.SS2.p1.3.m1.1.1.cmml" xref="S4.SS2.p1.3.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.3.m1.1.1.1.cmml" xref="S4.SS2.p1.3.m1.1.1">subscript</csymbol><apply id="S4.SS2.p1.3.m1.1.1.2.cmml" xref="S4.SS2.p1.3.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.3.m1.1.1.2.1.cmml" xref="S4.SS2.p1.3.m1.1.1">superscript</csymbol><ci id="S4.SS2.p1.3.m1.1.1.2.2.cmml" xref="S4.SS2.p1.3.m1.1.1.2.2">𝐞</ci><ci id="S4.SS2.p1.3.m1.1.1.2.3.cmml" xref="S4.SS2.p1.3.m1.1.1.2.3">img</ci></apply><ci id="S4.SS2.p1.3.m1.1.1.3.cmml" xref="S4.SS2.p1.3.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.3.m1.1c">{\bf e}^{\rm img}_{i}</annotation></semantics></math> of the <math id="S4.SS2.p1.4.m2.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S4.SS2.p1.4.m2.1a"><mi id="S4.SS2.p1.4.m2.1.1" xref="S4.SS2.p1.4.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.4.m2.1b"><ci id="S4.SS2.p1.4.m2.1.1.cmml" xref="S4.SS2.p1.4.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.4.m2.1c">i</annotation></semantics></math>-th cropped image and text class embeddings <math id="S4.SS2.p1.5.m3.1" class="ltx_Math" alttext="{\bf e}^{\rm txt}_{y}" display="inline"><semantics id="S4.SS2.p1.5.m3.1a"><msubsup id="S4.SS2.p1.5.m3.1.1" xref="S4.SS2.p1.5.m3.1.1.cmml"><mi id="S4.SS2.p1.5.m3.1.1.2.2" xref="S4.SS2.p1.5.m3.1.1.2.2.cmml">𝐞</mi><mi id="S4.SS2.p1.5.m3.1.1.3" xref="S4.SS2.p1.5.m3.1.1.3.cmml">y</mi><mi id="S4.SS2.p1.5.m3.1.1.2.3" xref="S4.SS2.p1.5.m3.1.1.2.3.cmml">txt</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.5.m3.1b"><apply id="S4.SS2.p1.5.m3.1.1.cmml" xref="S4.SS2.p1.5.m3.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.5.m3.1.1.1.cmml" xref="S4.SS2.p1.5.m3.1.1">subscript</csymbol><apply id="S4.SS2.p1.5.m3.1.1.2.cmml" xref="S4.SS2.p1.5.m3.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.5.m3.1.1.2.1.cmml" xref="S4.SS2.p1.5.m3.1.1">superscript</csymbol><ci id="S4.SS2.p1.5.m3.1.1.2.2.cmml" xref="S4.SS2.p1.5.m3.1.1.2.2">𝐞</ci><ci id="S4.SS2.p1.5.m3.1.1.2.3.cmml" xref="S4.SS2.p1.5.m3.1.1.2.3">txt</ci></apply><ci id="S4.SS2.p1.5.m3.1.1.3.cmml" xref="S4.SS2.p1.5.m3.1.1.3">𝑦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.5.m3.1c">{\bf e}^{\rm txt}_{y}</annotation></semantics></math>, returning class prediction probabilities as:</p>
<table id="S4.E8" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E8.m1.52" class="ltx_Math" alttext="\begin{gathered}{\rm\hat{P}}_{\rm clip}=[\hat{\bf p}_{1},\dots,\hat{\bf p}_{m}]\in\mathbb{R}^{m\times k}\\
\!\!\!\hat{\bf p}_{i}\!=\!{\rm Softmax}\big{(}\frac{1}{\tau}[{\rm cos}({\bf e}^{\rm img}_{i},{\bf e}^{\rm txt}_{1}),\dots,{\rm cos}({\bf e}^{\rm img}_{i},{\bf e}^{\rm txt}_{k})]\big{)},\!\!\!\end{gathered}" display="block"><semantics id="S4.E8.m1.52a"><mtable displaystyle="true" rowspacing="0pt" id="S4.E8.m1.52.52.4"><mtr id="S4.E8.m1.52.52.4a"><mtd id="S4.E8.m1.52.52.4b"><mrow id="S4.E8.m1.51.51.3.50.17.17"><msub id="S4.E8.m1.51.51.3.50.17.17.19"><mover accent="true" id="S4.E8.m1.1.1.1.1.1.1" xref="S4.E8.m1.1.1.1.1.1.1.cmml"><mi mathvariant="normal" id="S4.E8.m1.1.1.1.1.1.1.2" xref="S4.E8.m1.1.1.1.1.1.1.2.cmml">P</mi><mo id="S4.E8.m1.1.1.1.1.1.1.1" xref="S4.E8.m1.1.1.1.1.1.1.1.cmml">^</mo></mover><mi id="S4.E8.m1.2.2.2.2.2.2.1" xref="S4.E8.m1.2.2.2.2.2.2.1.cmml">clip</mi></msub><mo id="S4.E8.m1.3.3.3.3.3.3" xref="S4.E8.m1.3.3.3.3.3.3.cmml">=</mo><mrow id="S4.E8.m1.51.51.3.50.17.17.17.2"><mo stretchy="false" id="S4.E8.m1.4.4.4.4.4.4" xref="S4.E8.m1.49.49.1.1.1.cmml">[</mo><msub id="S4.E8.m1.50.50.2.49.16.16.16.1.1"><mover accent="true" id="S4.E8.m1.5.5.5.5.5.5" xref="S4.E8.m1.5.5.5.5.5.5.cmml"><mi id="S4.E8.m1.5.5.5.5.5.5.2" xref="S4.E8.m1.5.5.5.5.5.5.2.cmml">𝐩</mi><mo id="S4.E8.m1.5.5.5.5.5.5.1" xref="S4.E8.m1.5.5.5.5.5.5.1.cmml">^</mo></mover><mn id="S4.E8.m1.6.6.6.6.6.6.1" xref="S4.E8.m1.6.6.6.6.6.6.1.cmml">1</mn></msub><mo id="S4.E8.m1.7.7.7.7.7.7" xref="S4.E8.m1.49.49.1.1.1.cmml">,</mo><mi mathvariant="normal" id="S4.E8.m1.8.8.8.8.8.8" xref="S4.E8.m1.8.8.8.8.8.8.cmml">…</mi><mo id="S4.E8.m1.9.9.9.9.9.9" xref="S4.E8.m1.49.49.1.1.1.cmml">,</mo><msub id="S4.E8.m1.51.51.3.50.17.17.17.2.2"><mover accent="true" id="S4.E8.m1.10.10.10.10.10.10" xref="S4.E8.m1.10.10.10.10.10.10.cmml"><mi id="S4.E8.m1.10.10.10.10.10.10.2" xref="S4.E8.m1.10.10.10.10.10.10.2.cmml">𝐩</mi><mo id="S4.E8.m1.10.10.10.10.10.10.1" xref="S4.E8.m1.10.10.10.10.10.10.1.cmml">^</mo></mover><mi id="S4.E8.m1.11.11.11.11.11.11.1" xref="S4.E8.m1.11.11.11.11.11.11.1.cmml">m</mi></msub><mo stretchy="false" id="S4.E8.m1.12.12.12.12.12.12" xref="S4.E8.m1.49.49.1.1.1.cmml">]</mo></mrow><mo id="S4.E8.m1.13.13.13.13.13.13" xref="S4.E8.m1.13.13.13.13.13.13.cmml">∈</mo><msup id="S4.E8.m1.51.51.3.50.17.17.20"><mi id="S4.E8.m1.14.14.14.14.14.14" xref="S4.E8.m1.14.14.14.14.14.14.cmml">ℝ</mi><mrow id="S4.E8.m1.15.15.15.15.15.15.1" xref="S4.E8.m1.15.15.15.15.15.15.1.cmml"><mi id="S4.E8.m1.15.15.15.15.15.15.1.2" xref="S4.E8.m1.15.15.15.15.15.15.1.2.cmml">m</mi><mo lspace="0.222em" rspace="0.222em" id="S4.E8.m1.15.15.15.15.15.15.1.1" xref="S4.E8.m1.15.15.15.15.15.15.1.1.cmml">×</mo><mi id="S4.E8.m1.15.15.15.15.15.15.1.3" xref="S4.E8.m1.15.15.15.15.15.15.1.3.cmml">k</mi></mrow></msup></mrow></mtd></mtr><mtr id="S4.E8.m1.52.52.4c"><mtd id="S4.E8.m1.52.52.4d"><mrow id="S4.E8.m1.52.52.4.51.34.34.34"><mrow id="S4.E8.m1.52.52.4.51.34.34.34.1"><msub id="S4.E8.m1.52.52.4.51.34.34.34.1.2"><mover accent="true" id="S4.E8.m1.16.16.16.1.1.1" xref="S4.E8.m1.16.16.16.1.1.1.cmml"><mi id="S4.E8.m1.16.16.16.1.1.1.2" xref="S4.E8.m1.16.16.16.1.1.1.2.cmml">𝐩</mi><mo id="S4.E8.m1.16.16.16.1.1.1.1" xref="S4.E8.m1.16.16.16.1.1.1.1.cmml">^</mo></mover><mi id="S4.E8.m1.17.17.17.2.2.2.1" xref="S4.E8.m1.17.17.17.2.2.2.1.cmml">i</mi></msub><mo lspace="0.108em" rspace="0.108em" id="S4.E8.m1.18.18.18.3.3.3" xref="S4.E8.m1.18.18.18.3.3.3.cmml">=</mo><mrow id="S4.E8.m1.52.52.4.51.34.34.34.1.1"><mi id="S4.E8.m1.19.19.19.4.4.4" xref="S4.E8.m1.19.19.19.4.4.4.cmml">Softmax</mi><mo lspace="0em" rspace="0em" id="S4.E8.m1.52.52.4.51.34.34.34.1.1.2" xref="S4.E8.m1.49.49.1.1.1.cmml">​</mo><mrow id="S4.E8.m1.52.52.4.51.34.34.34.1.1.1.1"><mo maxsize="120%" minsize="120%" id="S4.E8.m1.20.20.20.5.5.5" xref="S4.E8.m1.49.49.1.1.1.cmml">(</mo><mrow id="S4.E8.m1.52.52.4.51.34.34.34.1.1.1.1.1"><mfrac id="S4.E8.m1.21.21.21.6.6.6" xref="S4.E8.m1.21.21.21.6.6.6.cmml"><mn id="S4.E8.m1.21.21.21.6.6.6.2" xref="S4.E8.m1.21.21.21.6.6.6.2.cmml">1</mn><mi id="S4.E8.m1.21.21.21.6.6.6.3" xref="S4.E8.m1.21.21.21.6.6.6.3.cmml">τ</mi></mfrac><mo lspace="0em" rspace="0em" id="S4.E8.m1.52.52.4.51.34.34.34.1.1.1.1.1.3" xref="S4.E8.m1.49.49.1.1.1.cmml">​</mo><mrow id="S4.E8.m1.52.52.4.51.34.34.34.1.1.1.1.1.2.2"><mo stretchy="false" id="S4.E8.m1.22.22.22.7.7.7" xref="S4.E8.m1.49.49.1.1.1.cmml">[</mo><mrow id="S4.E8.m1.52.52.4.51.34.34.34.1.1.1.1.1.1.1.1"><mi id="S4.E8.m1.23.23.23.8.8.8" xref="S4.E8.m1.23.23.23.8.8.8.cmml">cos</mi><mo lspace="0em" rspace="0em" id="S4.E8.m1.52.52.4.51.34.34.34.1.1.1.1.1.1.1.1.3" xref="S4.E8.m1.49.49.1.1.1.cmml">​</mo><mrow id="S4.E8.m1.52.52.4.51.34.34.34.1.1.1.1.1.1.1.1.2.2"><mo stretchy="false" id="S4.E8.m1.24.24.24.9.9.9" xref="S4.E8.m1.49.49.1.1.1.cmml">(</mo><msubsup id="S4.E8.m1.52.52.4.51.34.34.34.1.1.1.1.1.1.1.1.1.1.1"><mi id="S4.E8.m1.25.25.25.10.10.10" xref="S4.E8.m1.25.25.25.10.10.10.cmml">𝐞</mi><mi id="S4.E8.m1.27.27.27.12.12.12.1" xref="S4.E8.m1.27.27.27.12.12.12.1.cmml">i</mi><mi id="S4.E8.m1.26.26.26.11.11.11.1" xref="S4.E8.m1.26.26.26.11.11.11.1.cmml">img</mi></msubsup><mo id="S4.E8.m1.28.28.28.13.13.13" xref="S4.E8.m1.49.49.1.1.1.cmml">,</mo><msubsup id="S4.E8.m1.52.52.4.51.34.34.34.1.1.1.1.1.1.1.1.2.2.2"><mi id="S4.E8.m1.29.29.29.14.14.14" xref="S4.E8.m1.29.29.29.14.14.14.cmml">𝐞</mi><mn id="S4.E8.m1.31.31.31.16.16.16.1" xref="S4.E8.m1.31.31.31.16.16.16.1.cmml">1</mn><mi id="S4.E8.m1.30.30.30.15.15.15.1" xref="S4.E8.m1.30.30.30.15.15.15.1.cmml">txt</mi></msubsup><mo stretchy="false" id="S4.E8.m1.32.32.32.17.17.17" xref="S4.E8.m1.49.49.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E8.m1.33.33.33.18.18.18" xref="S4.E8.m1.49.49.1.1.1.cmml">,</mo><mi mathvariant="normal" id="S4.E8.m1.34.34.34.19.19.19" xref="S4.E8.m1.34.34.34.19.19.19.cmml">…</mi><mo id="S4.E8.m1.35.35.35.20.20.20" xref="S4.E8.m1.49.49.1.1.1.cmml">,</mo><mrow id="S4.E8.m1.52.52.4.51.34.34.34.1.1.1.1.1.2.2.2"><mi id="S4.E8.m1.36.36.36.21.21.21" xref="S4.E8.m1.36.36.36.21.21.21.cmml">cos</mi><mo lspace="0em" rspace="0em" id="S4.E8.m1.52.52.4.51.34.34.34.1.1.1.1.1.2.2.2.3" xref="S4.E8.m1.49.49.1.1.1.cmml">​</mo><mrow id="S4.E8.m1.52.52.4.51.34.34.34.1.1.1.1.1.2.2.2.2.2"><mo stretchy="false" id="S4.E8.m1.37.37.37.22.22.22" xref="S4.E8.m1.49.49.1.1.1.cmml">(</mo><msubsup id="S4.E8.m1.52.52.4.51.34.34.34.1.1.1.1.1.2.2.2.1.1.1"><mi id="S4.E8.m1.38.38.38.23.23.23" xref="S4.E8.m1.38.38.38.23.23.23.cmml">𝐞</mi><mi id="S4.E8.m1.40.40.40.25.25.25.1" xref="S4.E8.m1.40.40.40.25.25.25.1.cmml">i</mi><mi id="S4.E8.m1.39.39.39.24.24.24.1" xref="S4.E8.m1.39.39.39.24.24.24.1.cmml">img</mi></msubsup><mo id="S4.E8.m1.41.41.41.26.26.26" xref="S4.E8.m1.49.49.1.1.1.cmml">,</mo><msubsup id="S4.E8.m1.52.52.4.51.34.34.34.1.1.1.1.1.2.2.2.2.2.2"><mi id="S4.E8.m1.42.42.42.27.27.27" xref="S4.E8.m1.42.42.42.27.27.27.cmml">𝐞</mi><mi id="S4.E8.m1.44.44.44.29.29.29.1" xref="S4.E8.m1.44.44.44.29.29.29.1.cmml">k</mi><mi id="S4.E8.m1.43.43.43.28.28.28.1" xref="S4.E8.m1.43.43.43.28.28.28.1.cmml">txt</mi></msubsup><mo stretchy="false" id="S4.E8.m1.45.45.45.30.30.30" xref="S4.E8.m1.49.49.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S4.E8.m1.46.46.46.31.31.31" xref="S4.E8.m1.49.49.1.1.1.cmml">]</mo></mrow></mrow><mo maxsize="120%" minsize="120%" id="S4.E8.m1.47.47.47.32.32.32" xref="S4.E8.m1.49.49.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E8.m1.48.48.48.33.33.33" xref="S4.E8.m1.49.49.1.1.1.cmml">,</mo></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S4.E8.m1.52b"><apply id="S4.E8.m1.49.49.1.1.1.cmml" xref="S4.E8.m1.4.4.4.4.4.4"><and id="S4.E8.m1.49.49.1.1.1a.cmml" xref="S4.E8.m1.4.4.4.4.4.4"></and><apply id="S4.E8.m1.49.49.1.1.1b.cmml" xref="S4.E8.m1.4.4.4.4.4.4"><eq id="S4.E8.m1.3.3.3.3.3.3.cmml" xref="S4.E8.m1.3.3.3.3.3.3"></eq><apply id="S4.E8.m1.49.49.1.1.1.5.cmml" xref="S4.E8.m1.4.4.4.4.4.4"><csymbol cd="ambiguous" id="S4.E8.m1.49.49.1.1.1.5.1.cmml" xref="S4.E8.m1.4.4.4.4.4.4">subscript</csymbol><apply id="S4.E8.m1.1.1.1.1.1.1.cmml" xref="S4.E8.m1.1.1.1.1.1.1"><ci id="S4.E8.m1.1.1.1.1.1.1.1.cmml" xref="S4.E8.m1.1.1.1.1.1.1.1">^</ci><ci id="S4.E8.m1.1.1.1.1.1.1.2.cmml" xref="S4.E8.m1.1.1.1.1.1.1.2">P</ci></apply><ci id="S4.E8.m1.2.2.2.2.2.2.1.cmml" xref="S4.E8.m1.2.2.2.2.2.2.1">clip</ci></apply><list id="S4.E8.m1.49.49.1.1.1.2.3.cmml" xref="S4.E8.m1.4.4.4.4.4.4"><apply id="S4.E8.m1.49.49.1.1.1.1.1.1.cmml" xref="S4.E8.m1.4.4.4.4.4.4"><csymbol cd="ambiguous" id="S4.E8.m1.49.49.1.1.1.1.1.1.1.cmml" xref="S4.E8.m1.4.4.4.4.4.4">subscript</csymbol><apply id="S4.E8.m1.5.5.5.5.5.5.cmml" xref="S4.E8.m1.5.5.5.5.5.5"><ci id="S4.E8.m1.5.5.5.5.5.5.1.cmml" xref="S4.E8.m1.5.5.5.5.5.5.1">^</ci><ci id="S4.E8.m1.5.5.5.5.5.5.2.cmml" xref="S4.E8.m1.5.5.5.5.5.5.2">𝐩</ci></apply><cn type="integer" id="S4.E8.m1.6.6.6.6.6.6.1.cmml" xref="S4.E8.m1.6.6.6.6.6.6.1">1</cn></apply><ci id="S4.E8.m1.8.8.8.8.8.8.cmml" xref="S4.E8.m1.8.8.8.8.8.8">…</ci><apply id="S4.E8.m1.49.49.1.1.1.2.2.2.cmml" xref="S4.E8.m1.4.4.4.4.4.4"><csymbol cd="ambiguous" id="S4.E8.m1.49.49.1.1.1.2.2.2.1.cmml" xref="S4.E8.m1.4.4.4.4.4.4">subscript</csymbol><apply id="S4.E8.m1.10.10.10.10.10.10.cmml" xref="S4.E8.m1.10.10.10.10.10.10"><ci id="S4.E8.m1.10.10.10.10.10.10.1.cmml" xref="S4.E8.m1.10.10.10.10.10.10.1">^</ci><ci id="S4.E8.m1.10.10.10.10.10.10.2.cmml" xref="S4.E8.m1.10.10.10.10.10.10.2">𝐩</ci></apply><ci id="S4.E8.m1.11.11.11.11.11.11.1.cmml" xref="S4.E8.m1.11.11.11.11.11.11.1">𝑚</ci></apply></list></apply><apply id="S4.E8.m1.49.49.1.1.1c.cmml" xref="S4.E8.m1.4.4.4.4.4.4"><in id="S4.E8.m1.13.13.13.13.13.13.cmml" xref="S4.E8.m1.13.13.13.13.13.13"></in><share href="#S4.E8.m1.49.49.1.1.1.2.cmml" id="S4.E8.m1.49.49.1.1.1d.cmml" xref="S4.E8.m1.4.4.4.4.4.4"></share><apply id="S4.E8.m1.49.49.1.1.1.8.cmml" xref="S4.E8.m1.4.4.4.4.4.4"><times id="S4.E8.m1.49.49.1.1.1.8.1.cmml" xref="S4.E8.m1.4.4.4.4.4.4"></times><apply id="S4.E8.m1.49.49.1.1.1.8.2.cmml" xref="S4.E8.m1.4.4.4.4.4.4"><csymbol cd="ambiguous" id="S4.E8.m1.49.49.1.1.1.8.2.1.cmml" xref="S4.E8.m1.4.4.4.4.4.4">superscript</csymbol><ci id="S4.E8.m1.14.14.14.14.14.14.cmml" xref="S4.E8.m1.14.14.14.14.14.14">ℝ</ci><apply id="S4.E8.m1.15.15.15.15.15.15.1.cmml" xref="S4.E8.m1.15.15.15.15.15.15.1"><times id="S4.E8.m1.15.15.15.15.15.15.1.1.cmml" xref="S4.E8.m1.15.15.15.15.15.15.1.1"></times><ci id="S4.E8.m1.15.15.15.15.15.15.1.2.cmml" xref="S4.E8.m1.15.15.15.15.15.15.1.2">𝑚</ci><ci id="S4.E8.m1.15.15.15.15.15.15.1.3.cmml" xref="S4.E8.m1.15.15.15.15.15.15.1.3">𝑘</ci></apply></apply><apply id="S4.E8.m1.49.49.1.1.1.8.3.cmml" xref="S4.E8.m1.4.4.4.4.4.4"><csymbol cd="ambiguous" id="S4.E8.m1.49.49.1.1.1.8.3.1.cmml" xref="S4.E8.m1.4.4.4.4.4.4">subscript</csymbol><apply id="S4.E8.m1.16.16.16.1.1.1.cmml" xref="S4.E8.m1.16.16.16.1.1.1"><ci id="S4.E8.m1.16.16.16.1.1.1.1.cmml" xref="S4.E8.m1.16.16.16.1.1.1.1">^</ci><ci id="S4.E8.m1.16.16.16.1.1.1.2.cmml" xref="S4.E8.m1.16.16.16.1.1.1.2">𝐩</ci></apply><ci id="S4.E8.m1.17.17.17.2.2.2.1.cmml" xref="S4.E8.m1.17.17.17.2.2.2.1">𝑖</ci></apply></apply></apply><apply id="S4.E8.m1.49.49.1.1.1e.cmml" xref="S4.E8.m1.4.4.4.4.4.4"><eq id="S4.E8.m1.18.18.18.3.3.3.cmml" xref="S4.E8.m1.18.18.18.3.3.3"></eq><share href="#S4.E8.m1.49.49.1.1.1.8.cmml" id="S4.E8.m1.49.49.1.1.1f.cmml" xref="S4.E8.m1.4.4.4.4.4.4"></share><apply id="S4.E8.m1.49.49.1.1.1.3.cmml" xref="S4.E8.m1.4.4.4.4.4.4"><times id="S4.E8.m1.49.49.1.1.1.3.2.cmml" xref="S4.E8.m1.4.4.4.4.4.4"></times><ci id="S4.E8.m1.19.19.19.4.4.4.cmml" xref="S4.E8.m1.19.19.19.4.4.4">Softmax</ci><apply id="S4.E8.m1.49.49.1.1.1.3.1.1.1.cmml" xref="S4.E8.m1.4.4.4.4.4.4"><times id="S4.E8.m1.49.49.1.1.1.3.1.1.1.3.cmml" xref="S4.E8.m1.4.4.4.4.4.4"></times><apply id="S4.E8.m1.21.21.21.6.6.6.cmml" xref="S4.E8.m1.21.21.21.6.6.6"><divide id="S4.E8.m1.21.21.21.6.6.6.1.cmml" xref="S4.E8.m1.21.21.21.6.6.6"></divide><cn type="integer" id="S4.E8.m1.21.21.21.6.6.6.2.cmml" xref="S4.E8.m1.21.21.21.6.6.6.2">1</cn><ci id="S4.E8.m1.21.21.21.6.6.6.3.cmml" xref="S4.E8.m1.21.21.21.6.6.6.3">𝜏</ci></apply><list id="S4.E8.m1.49.49.1.1.1.3.1.1.1.2.3.cmml" xref="S4.E8.m1.4.4.4.4.4.4"><apply id="S4.E8.m1.49.49.1.1.1.3.1.1.1.1.1.1.cmml" xref="S4.E8.m1.4.4.4.4.4.4"><times id="S4.E8.m1.49.49.1.1.1.3.1.1.1.1.1.1.3.cmml" xref="S4.E8.m1.4.4.4.4.4.4"></times><ci id="S4.E8.m1.23.23.23.8.8.8.cmml" xref="S4.E8.m1.23.23.23.8.8.8">cos</ci><interval closure="open" id="S4.E8.m1.49.49.1.1.1.3.1.1.1.1.1.1.2.3.cmml" xref="S4.E8.m1.4.4.4.4.4.4"><apply id="S4.E8.m1.49.49.1.1.1.3.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E8.m1.4.4.4.4.4.4"><csymbol cd="ambiguous" id="S4.E8.m1.49.49.1.1.1.3.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E8.m1.4.4.4.4.4.4">subscript</csymbol><apply id="S4.E8.m1.49.49.1.1.1.3.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E8.m1.4.4.4.4.4.4"><csymbol cd="ambiguous" id="S4.E8.m1.49.49.1.1.1.3.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E8.m1.4.4.4.4.4.4">superscript</csymbol><ci id="S4.E8.m1.25.25.25.10.10.10.cmml" xref="S4.E8.m1.25.25.25.10.10.10">𝐞</ci><ci id="S4.E8.m1.26.26.26.11.11.11.1.cmml" xref="S4.E8.m1.26.26.26.11.11.11.1">img</ci></apply><ci id="S4.E8.m1.27.27.27.12.12.12.1.cmml" xref="S4.E8.m1.27.27.27.12.12.12.1">𝑖</ci></apply><apply id="S4.E8.m1.49.49.1.1.1.3.1.1.1.1.1.1.2.2.2.cmml" xref="S4.E8.m1.4.4.4.4.4.4"><csymbol cd="ambiguous" id="S4.E8.m1.49.49.1.1.1.3.1.1.1.1.1.1.2.2.2.1.cmml" xref="S4.E8.m1.4.4.4.4.4.4">subscript</csymbol><apply id="S4.E8.m1.49.49.1.1.1.3.1.1.1.1.1.1.2.2.2.2.cmml" xref="S4.E8.m1.4.4.4.4.4.4"><csymbol cd="ambiguous" id="S4.E8.m1.49.49.1.1.1.3.1.1.1.1.1.1.2.2.2.2.1.cmml" xref="S4.E8.m1.4.4.4.4.4.4">superscript</csymbol><ci id="S4.E8.m1.29.29.29.14.14.14.cmml" xref="S4.E8.m1.29.29.29.14.14.14">𝐞</ci><ci id="S4.E8.m1.30.30.30.15.15.15.1.cmml" xref="S4.E8.m1.30.30.30.15.15.15.1">txt</ci></apply><cn type="integer" id="S4.E8.m1.31.31.31.16.16.16.1.cmml" xref="S4.E8.m1.31.31.31.16.16.16.1">1</cn></apply></interval></apply><ci id="S4.E8.m1.34.34.34.19.19.19.cmml" xref="S4.E8.m1.34.34.34.19.19.19">…</ci><apply id="S4.E8.m1.49.49.1.1.1.3.1.1.1.2.2.2.cmml" xref="S4.E8.m1.4.4.4.4.4.4"><times id="S4.E8.m1.49.49.1.1.1.3.1.1.1.2.2.2.3.cmml" xref="S4.E8.m1.4.4.4.4.4.4"></times><ci id="S4.E8.m1.36.36.36.21.21.21.cmml" xref="S4.E8.m1.36.36.36.21.21.21">cos</ci><interval closure="open" id="S4.E8.m1.49.49.1.1.1.3.1.1.1.2.2.2.2.3.cmml" xref="S4.E8.m1.4.4.4.4.4.4"><apply id="S4.E8.m1.49.49.1.1.1.3.1.1.1.2.2.2.1.1.1.cmml" xref="S4.E8.m1.4.4.4.4.4.4"><csymbol cd="ambiguous" id="S4.E8.m1.49.49.1.1.1.3.1.1.1.2.2.2.1.1.1.1.cmml" xref="S4.E8.m1.4.4.4.4.4.4">subscript</csymbol><apply id="S4.E8.m1.49.49.1.1.1.3.1.1.1.2.2.2.1.1.1.2.cmml" xref="S4.E8.m1.4.4.4.4.4.4"><csymbol cd="ambiguous" id="S4.E8.m1.49.49.1.1.1.3.1.1.1.2.2.2.1.1.1.2.1.cmml" xref="S4.E8.m1.4.4.4.4.4.4">superscript</csymbol><ci id="S4.E8.m1.38.38.38.23.23.23.cmml" xref="S4.E8.m1.38.38.38.23.23.23">𝐞</ci><ci id="S4.E8.m1.39.39.39.24.24.24.1.cmml" xref="S4.E8.m1.39.39.39.24.24.24.1">img</ci></apply><ci id="S4.E8.m1.40.40.40.25.25.25.1.cmml" xref="S4.E8.m1.40.40.40.25.25.25.1">𝑖</ci></apply><apply id="S4.E8.m1.49.49.1.1.1.3.1.1.1.2.2.2.2.2.2.cmml" xref="S4.E8.m1.4.4.4.4.4.4"><csymbol cd="ambiguous" id="S4.E8.m1.49.49.1.1.1.3.1.1.1.2.2.2.2.2.2.1.cmml" xref="S4.E8.m1.4.4.4.4.4.4">subscript</csymbol><apply id="S4.E8.m1.49.49.1.1.1.3.1.1.1.2.2.2.2.2.2.2.cmml" xref="S4.E8.m1.4.4.4.4.4.4"><csymbol cd="ambiguous" id="S4.E8.m1.49.49.1.1.1.3.1.1.1.2.2.2.2.2.2.2.1.cmml" xref="S4.E8.m1.4.4.4.4.4.4">superscript</csymbol><ci id="S4.E8.m1.42.42.42.27.27.27.cmml" xref="S4.E8.m1.42.42.42.27.27.27">𝐞</ci><ci id="S4.E8.m1.43.43.43.28.28.28.1.cmml" xref="S4.E8.m1.43.43.43.28.28.28.1">txt</ci></apply><ci id="S4.E8.m1.44.44.44.29.29.29.1.cmml" xref="S4.E8.m1.44.44.44.29.29.29.1">𝑘</ci></apply></interval></apply></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E8.m1.52c">\begin{gathered}{\rm\hat{P}}_{\rm clip}=[\hat{\bf p}_{1},\dots,\hat{\bf p}_{m}]\in\mathbb{R}^{m\times k}\\
\!\!\!\hat{\bf p}_{i}\!=\!{\rm Softmax}\big{(}\frac{1}{\tau}[{\rm cos}({\bf e}^{\rm img}_{i},{\bf e}^{\rm txt}_{1}),\dots,{\rm cos}({\bf e}^{\rm img}_{i},{\bf e}^{\rm txt}_{k})]\big{)},\!\!\!\end{gathered}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
<p id="S4.SS2.p1.6" class="ltx_p">where <math id="S4.SS2.p1.6.m1.1" class="ltx_Math" alttext="\tau" display="inline"><semantics id="S4.SS2.p1.6.m1.1a"><mi id="S4.SS2.p1.6.m1.1.1" xref="S4.SS2.p1.6.m1.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.6.m1.1b"><ci id="S4.SS2.p1.6.m1.1.1.cmml" xref="S4.SS2.p1.6.m1.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.6.m1.1c">\tau</annotation></semantics></math> is the temperature on the logits.</p>
</div>
<div id="S4.SS2.p2" class="ltx_para">
<p id="S4.SS2.p2.7" class="ltx_p">Inspired by <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite>, we combine the CLIP class probabilities with the detection class probabilities to improve overall classification performance. The final class probabilities are given by:</p>
<table id="S4.E9" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E9.m1.6" class="ltx_Math" alttext="\!\!\!\!{\rm{P}}_{\rm final}{[\cdot,j]}\!=\!\begin{cases}\alpha{\rm{P}}_{\rm det}{[\cdot,j]}+(1\!-\!\alpha){\rm{P}}_{\rm clip}{[\cdot,j]}&amp;\!\!\!\!\text{if $j\in C_{B}$}\!\!\!\!\!\!\\
\beta{\rm{P}}_{\rm det}{[\cdot,j]}+(1\!-\!\beta){\rm{P}}_{\rm clip}{[\cdot,j]}&amp;\!\!\!\!\text{if $j\in C_{N}$},\!\!\!\!\!\!\end{cases}" display="block"><semantics id="S4.E9.m1.6a"><mrow id="S4.E9.m1.6.7" xref="S4.E9.m1.6.7.cmml"><mrow id="S4.E9.m1.6.7.2" xref="S4.E9.m1.6.7.2.cmml"><msub id="S4.E9.m1.6.7.2.2" xref="S4.E9.m1.6.7.2.2.cmml"><mi mathvariant="normal" id="S4.E9.m1.6.7.2.2.2" xref="S4.E9.m1.6.7.2.2.2.cmml">P</mi><mi id="S4.E9.m1.6.7.2.2.3" xref="S4.E9.m1.6.7.2.2.3.cmml">final</mi></msub><mo lspace="0em" rspace="0em" id="S4.E9.m1.6.7.2.1" xref="S4.E9.m1.6.7.2.1.cmml">​</mo><mrow id="S4.E9.m1.6.7.2.3.2" xref="S4.E9.m1.6.7.2.3.1.cmml"><mo stretchy="false" id="S4.E9.m1.6.7.2.3.2.1" xref="S4.E9.m1.6.7.2.3.1.cmml">[</mo><mo lspace="0em" rspace="0em" id="S4.E9.m1.5.5" xref="S4.E9.m1.5.5.cmml">⋅</mo><mo id="S4.E9.m1.6.7.2.3.2.2" xref="S4.E9.m1.6.7.2.3.1.cmml">,</mo><mi id="S4.E9.m1.6.6" xref="S4.E9.m1.6.6.cmml">j</mi><mo stretchy="false" id="S4.E9.m1.6.7.2.3.2.3" xref="S4.E9.m1.6.7.2.3.1.cmml">]</mo></mrow></mrow><mo lspace="0.108em" rspace="0.108em" id="S4.E9.m1.6.7.1" xref="S4.E9.m1.6.7.1.cmml">=</mo><mrow id="S4.E9.m1.4.4" xref="S4.E9.m1.6.7.3.1.cmml"><mo id="S4.E9.m1.4.4.5" xref="S4.E9.m1.6.7.3.1.1.cmml">{</mo><mtable columnspacing="5pt" displaystyle="true" rowspacing="0pt" id="S4.E9.m1.4.4.4" xref="S4.E9.m1.6.7.3.1.cmml"><mtr id="S4.E9.m1.4.4.4a" xref="S4.E9.m1.6.7.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S4.E9.m1.4.4.4b" xref="S4.E9.m1.6.7.3.1.cmml"><mrow id="S4.E9.m1.3.3.3.3.2.1" xref="S4.E9.m1.3.3.3.3.2.1.cmml"><mrow id="S4.E9.m1.3.3.3.3.2.1.7" xref="S4.E9.m1.3.3.3.3.2.1.7.cmml"><mi id="S4.E9.m1.3.3.3.3.2.1.7.2" xref="S4.E9.m1.3.3.3.3.2.1.7.2.cmml">α</mi><mo lspace="0em" rspace="0em" id="S4.E9.m1.3.3.3.3.2.1.7.1" xref="S4.E9.m1.3.3.3.3.2.1.7.1.cmml">​</mo><msub id="S4.E9.m1.3.3.3.3.2.1.7.3" xref="S4.E9.m1.3.3.3.3.2.1.7.3.cmml"><mi mathvariant="normal" id="S4.E9.m1.3.3.3.3.2.1.7.3.2" xref="S4.E9.m1.3.3.3.3.2.1.7.3.2.cmml">P</mi><mi id="S4.E9.m1.3.3.3.3.2.1.7.3.3" xref="S4.E9.m1.3.3.3.3.2.1.7.3.3.cmml">det</mi></msub><mo lspace="0em" rspace="0em" id="S4.E9.m1.3.3.3.3.2.1.7.1a" xref="S4.E9.m1.3.3.3.3.2.1.7.1.cmml">​</mo><mrow id="S4.E9.m1.3.3.3.3.2.1.7.4.2" xref="S4.E9.m1.3.3.3.3.2.1.7.4.1.cmml"><mo stretchy="false" id="S4.E9.m1.3.3.3.3.2.1.7.4.2.1" xref="S4.E9.m1.3.3.3.3.2.1.7.4.1.cmml">[</mo><mo lspace="0em" rspace="0em" id="S4.E9.m1.3.3.3.3.2.1.1" xref="S4.E9.m1.3.3.3.3.2.1.1.cmml">⋅</mo><mo id="S4.E9.m1.3.3.3.3.2.1.7.4.2.2" xref="S4.E9.m1.3.3.3.3.2.1.7.4.1.cmml">,</mo><mi id="S4.E9.m1.3.3.3.3.2.1.2" xref="S4.E9.m1.3.3.3.3.2.1.2.cmml">j</mi><mo stretchy="false" id="S4.E9.m1.3.3.3.3.2.1.7.4.2.3" xref="S4.E9.m1.3.3.3.3.2.1.7.4.1.cmml">]</mo></mrow></mrow><mo id="S4.E9.m1.3.3.3.3.2.1.6" xref="S4.E9.m1.3.3.3.3.2.1.6.cmml">+</mo><mrow id="S4.E9.m1.3.3.3.3.2.1.5" xref="S4.E9.m1.3.3.3.3.2.1.5.cmml"><mrow id="S4.E9.m1.3.3.3.3.2.1.5.1.1" xref="S4.E9.m1.3.3.3.3.2.1.5.1.1.1.cmml"><mo stretchy="false" id="S4.E9.m1.3.3.3.3.2.1.5.1.1.2" xref="S4.E9.m1.3.3.3.3.2.1.5.1.1.1.cmml">(</mo><mrow id="S4.E9.m1.3.3.3.3.2.1.5.1.1.1" xref="S4.E9.m1.3.3.3.3.2.1.5.1.1.1.cmml"><mn id="S4.E9.m1.3.3.3.3.2.1.5.1.1.1.2" xref="S4.E9.m1.3.3.3.3.2.1.5.1.1.1.2.cmml">1</mn><mo lspace="0.052em" rspace="0.052em" id="S4.E9.m1.3.3.3.3.2.1.5.1.1.1.1" xref="S4.E9.m1.3.3.3.3.2.1.5.1.1.1.1.cmml">−</mo><mi id="S4.E9.m1.3.3.3.3.2.1.5.1.1.1.3" xref="S4.E9.m1.3.3.3.3.2.1.5.1.1.1.3.cmml">α</mi></mrow><mo stretchy="false" id="S4.E9.m1.3.3.3.3.2.1.5.1.1.3" xref="S4.E9.m1.3.3.3.3.2.1.5.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S4.E9.m1.3.3.3.3.2.1.5.2" xref="S4.E9.m1.3.3.3.3.2.1.5.2.cmml">​</mo><msub id="S4.E9.m1.3.3.3.3.2.1.5.3" xref="S4.E9.m1.3.3.3.3.2.1.5.3.cmml"><mi mathvariant="normal" id="S4.E9.m1.3.3.3.3.2.1.5.3.2" xref="S4.E9.m1.3.3.3.3.2.1.5.3.2.cmml">P</mi><mi id="S4.E9.m1.3.3.3.3.2.1.5.3.3" xref="S4.E9.m1.3.3.3.3.2.1.5.3.3.cmml">clip</mi></msub><mo lspace="0em" rspace="0em" id="S4.E9.m1.3.3.3.3.2.1.5.2a" xref="S4.E9.m1.3.3.3.3.2.1.5.2.cmml">​</mo><mrow id="S4.E9.m1.3.3.3.3.2.1.5.4.2" xref="S4.E9.m1.3.3.3.3.2.1.5.4.1.cmml"><mo stretchy="false" id="S4.E9.m1.3.3.3.3.2.1.5.4.2.1" xref="S4.E9.m1.3.3.3.3.2.1.5.4.1.cmml">[</mo><mo lspace="0em" rspace="0em" id="S4.E9.m1.3.3.3.3.2.1.3" xref="S4.E9.m1.3.3.3.3.2.1.3.cmml">⋅</mo><mo id="S4.E9.m1.3.3.3.3.2.1.5.4.2.2" xref="S4.E9.m1.3.3.3.3.2.1.5.4.1.cmml">,</mo><mi id="S4.E9.m1.3.3.3.3.2.1.4" xref="S4.E9.m1.3.3.3.3.2.1.4.cmml">j</mi><mo stretchy="false" id="S4.E9.m1.3.3.3.3.2.1.5.4.2.3" xref="S4.E9.m1.3.3.3.3.2.1.5.4.1.cmml">]</mo></mrow></mrow></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S4.E9.m1.4.4.4c" xref="S4.E9.m1.6.7.3.1.cmml"><mrow id="S4.E9.m1.1.1.1.1.1.1" xref="S4.E9.m1.1.1.1.1.1.1b.cmml"><mtext id="S4.E9.m1.1.1.1.1.1.1a" xref="S4.E9.m1.1.1.1.1.1.1b.cmml">if </mtext><mrow id="S4.E9.m1.1.1.1.1.1.1.1.1.m1.1.1" xref="S4.E9.m1.1.1.1.1.1.1.1.1.m1.1.1.cmml"><mi id="S4.E9.m1.1.1.1.1.1.1.1.1.m1.1.1.2" xref="S4.E9.m1.1.1.1.1.1.1.1.1.m1.1.1.2.cmml">j</mi><mo id="S4.E9.m1.1.1.1.1.1.1.1.1.m1.1.1.1" xref="S4.E9.m1.1.1.1.1.1.1.1.1.m1.1.1.1.cmml">∈</mo><msub id="S4.E9.m1.1.1.1.1.1.1.1.1.m1.1.1.3" xref="S4.E9.m1.1.1.1.1.1.1.1.1.m1.1.1.3.cmml"><mi id="S4.E9.m1.1.1.1.1.1.1.1.1.m1.1.1.3.2" xref="S4.E9.m1.1.1.1.1.1.1.1.1.m1.1.1.3.2.cmml">C</mi><mi id="S4.E9.m1.1.1.1.1.1.1.1.1.m1.1.1.3.3" xref="S4.E9.m1.1.1.1.1.1.1.1.1.m1.1.1.3.3.cmml">B</mi></msub></mrow></mrow></mtd></mtr><mtr id="S4.E9.m1.4.4.4d" xref="S4.E9.m1.6.7.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S4.E9.m1.4.4.4e" xref="S4.E9.m1.6.7.3.1.cmml"><mrow id="S4.E9.m1.4.4.4.4.2.1" xref="S4.E9.m1.4.4.4.4.2.1.cmml"><mrow id="S4.E9.m1.4.4.4.4.2.1.7" xref="S4.E9.m1.4.4.4.4.2.1.7.cmml"><mi id="S4.E9.m1.4.4.4.4.2.1.7.2" xref="S4.E9.m1.4.4.4.4.2.1.7.2.cmml">β</mi><mo lspace="0em" rspace="0em" id="S4.E9.m1.4.4.4.4.2.1.7.1" xref="S4.E9.m1.4.4.4.4.2.1.7.1.cmml">​</mo><msub id="S4.E9.m1.4.4.4.4.2.1.7.3" xref="S4.E9.m1.4.4.4.4.2.1.7.3.cmml"><mi mathvariant="normal" id="S4.E9.m1.4.4.4.4.2.1.7.3.2" xref="S4.E9.m1.4.4.4.4.2.1.7.3.2.cmml">P</mi><mi id="S4.E9.m1.4.4.4.4.2.1.7.3.3" xref="S4.E9.m1.4.4.4.4.2.1.7.3.3.cmml">det</mi></msub><mo lspace="0em" rspace="0em" id="S4.E9.m1.4.4.4.4.2.1.7.1a" xref="S4.E9.m1.4.4.4.4.2.1.7.1.cmml">​</mo><mrow id="S4.E9.m1.4.4.4.4.2.1.7.4.2" xref="S4.E9.m1.4.4.4.4.2.1.7.4.1.cmml"><mo stretchy="false" id="S4.E9.m1.4.4.4.4.2.1.7.4.2.1" xref="S4.E9.m1.4.4.4.4.2.1.7.4.1.cmml">[</mo><mo lspace="0em" rspace="0em" id="S4.E9.m1.4.4.4.4.2.1.1" xref="S4.E9.m1.4.4.4.4.2.1.1.cmml">⋅</mo><mo id="S4.E9.m1.4.4.4.4.2.1.7.4.2.2" xref="S4.E9.m1.4.4.4.4.2.1.7.4.1.cmml">,</mo><mi id="S4.E9.m1.4.4.4.4.2.1.2" xref="S4.E9.m1.4.4.4.4.2.1.2.cmml">j</mi><mo stretchy="false" id="S4.E9.m1.4.4.4.4.2.1.7.4.2.3" xref="S4.E9.m1.4.4.4.4.2.1.7.4.1.cmml">]</mo></mrow></mrow><mo id="S4.E9.m1.4.4.4.4.2.1.6" xref="S4.E9.m1.4.4.4.4.2.1.6.cmml">+</mo><mrow id="S4.E9.m1.4.4.4.4.2.1.5" xref="S4.E9.m1.4.4.4.4.2.1.5.cmml"><mrow id="S4.E9.m1.4.4.4.4.2.1.5.1.1" xref="S4.E9.m1.4.4.4.4.2.1.5.1.1.1.cmml"><mo stretchy="false" id="S4.E9.m1.4.4.4.4.2.1.5.1.1.2" xref="S4.E9.m1.4.4.4.4.2.1.5.1.1.1.cmml">(</mo><mrow id="S4.E9.m1.4.4.4.4.2.1.5.1.1.1" xref="S4.E9.m1.4.4.4.4.2.1.5.1.1.1.cmml"><mn id="S4.E9.m1.4.4.4.4.2.1.5.1.1.1.2" xref="S4.E9.m1.4.4.4.4.2.1.5.1.1.1.2.cmml">1</mn><mo lspace="0.052em" rspace="0.052em" id="S4.E9.m1.4.4.4.4.2.1.5.1.1.1.1" xref="S4.E9.m1.4.4.4.4.2.1.5.1.1.1.1.cmml">−</mo><mi id="S4.E9.m1.4.4.4.4.2.1.5.1.1.1.3" xref="S4.E9.m1.4.4.4.4.2.1.5.1.1.1.3.cmml">β</mi></mrow><mo stretchy="false" id="S4.E9.m1.4.4.4.4.2.1.5.1.1.3" xref="S4.E9.m1.4.4.4.4.2.1.5.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S4.E9.m1.4.4.4.4.2.1.5.2" xref="S4.E9.m1.4.4.4.4.2.1.5.2.cmml">​</mo><msub id="S4.E9.m1.4.4.4.4.2.1.5.3" xref="S4.E9.m1.4.4.4.4.2.1.5.3.cmml"><mi mathvariant="normal" id="S4.E9.m1.4.4.4.4.2.1.5.3.2" xref="S4.E9.m1.4.4.4.4.2.1.5.3.2.cmml">P</mi><mi id="S4.E9.m1.4.4.4.4.2.1.5.3.3" xref="S4.E9.m1.4.4.4.4.2.1.5.3.3.cmml">clip</mi></msub><mo lspace="0em" rspace="0em" id="S4.E9.m1.4.4.4.4.2.1.5.2a" xref="S4.E9.m1.4.4.4.4.2.1.5.2.cmml">​</mo><mrow id="S4.E9.m1.4.4.4.4.2.1.5.4.2" xref="S4.E9.m1.4.4.4.4.2.1.5.4.1.cmml"><mo stretchy="false" id="S4.E9.m1.4.4.4.4.2.1.5.4.2.1" xref="S4.E9.m1.4.4.4.4.2.1.5.4.1.cmml">[</mo><mo lspace="0em" rspace="0em" id="S4.E9.m1.4.4.4.4.2.1.3" xref="S4.E9.m1.4.4.4.4.2.1.3.cmml">⋅</mo><mo id="S4.E9.m1.4.4.4.4.2.1.5.4.2.2" xref="S4.E9.m1.4.4.4.4.2.1.5.4.1.cmml">,</mo><mi id="S4.E9.m1.4.4.4.4.2.1.4" xref="S4.E9.m1.4.4.4.4.2.1.4.cmml">j</mi><mo stretchy="false" id="S4.E9.m1.4.4.4.4.2.1.5.4.2.3" xref="S4.E9.m1.4.4.4.4.2.1.5.4.1.cmml">]</mo></mrow></mrow></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S4.E9.m1.4.4.4f" xref="S4.E9.m1.6.7.3.1.cmml"><mrow id="S4.E9.m1.2.2.2.2.1.1.3" xref="S4.E9.m1.2.2.2.2.1.1.1.1b.cmml"><mrow id="S4.E9.m1.2.2.2.2.1.1.1.1" xref="S4.E9.m1.2.2.2.2.1.1.1.1b.cmml"><mtext id="S4.E9.m1.2.2.2.2.1.1.1.1a" xref="S4.E9.m1.2.2.2.2.1.1.1.1a.cmml">if </mtext><mrow id="S4.E9.m1.2.2.2.2.1.1.1.1.m1.1.1" xref="S4.E9.m1.2.2.2.2.1.1.1.1.m1.1.1.cmml"><mi id="S4.E9.m1.2.2.2.2.1.1.1.1.m1.1.1.2" xref="S4.E9.m1.2.2.2.2.1.1.1.1.m1.1.1.2.cmml">j</mi><mo id="S4.E9.m1.2.2.2.2.1.1.1.1.m1.1.1.1" xref="S4.E9.m1.2.2.2.2.1.1.1.1.m1.1.1.1.cmml">∈</mo><msub id="S4.E9.m1.2.2.2.2.1.1.1.1.m1.1.1.3" xref="S4.E9.m1.2.2.2.2.1.1.1.1.m1.1.1.3.cmml"><mi id="S4.E9.m1.2.2.2.2.1.1.1.1.m1.1.1.3.2" xref="S4.E9.m1.2.2.2.2.1.1.1.1.m1.1.1.3.2.cmml">C</mi><mi id="S4.E9.m1.2.2.2.2.1.1.1.1.m1.1.1.3.3" xref="S4.E9.m1.2.2.2.2.1.1.1.1.m1.1.1.3.3.cmml">N</mi></msub></mrow></mrow><mo id="S4.E9.m1.2.2.2.2.1.1.3.1" xref="S4.E9.m1.2.2.2.2.1.1.1.1b.cmml">,</mo></mrow></mtd></mtr></mtable></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E9.m1.6b"><apply id="S4.E9.m1.6.7.cmml" xref="S4.E9.m1.6.7"><eq id="S4.E9.m1.6.7.1.cmml" xref="S4.E9.m1.6.7.1"></eq><apply id="S4.E9.m1.6.7.2.cmml" xref="S4.E9.m1.6.7.2"><times id="S4.E9.m1.6.7.2.1.cmml" xref="S4.E9.m1.6.7.2.1"></times><apply id="S4.E9.m1.6.7.2.2.cmml" xref="S4.E9.m1.6.7.2.2"><csymbol cd="ambiguous" id="S4.E9.m1.6.7.2.2.1.cmml" xref="S4.E9.m1.6.7.2.2">subscript</csymbol><ci id="S4.E9.m1.6.7.2.2.2.cmml" xref="S4.E9.m1.6.7.2.2.2">P</ci><ci id="S4.E9.m1.6.7.2.2.3.cmml" xref="S4.E9.m1.6.7.2.2.3">final</ci></apply><interval closure="closed" id="S4.E9.m1.6.7.2.3.1.cmml" xref="S4.E9.m1.6.7.2.3.2"><ci id="S4.E9.m1.5.5.cmml" xref="S4.E9.m1.5.5">⋅</ci><ci id="S4.E9.m1.6.6.cmml" xref="S4.E9.m1.6.6">𝑗</ci></interval></apply><apply id="S4.E9.m1.6.7.3.1.cmml" xref="S4.E9.m1.4.4"><csymbol cd="latexml" id="S4.E9.m1.6.7.3.1.1.cmml" xref="S4.E9.m1.4.4.5">cases</csymbol><apply id="S4.E9.m1.3.3.3.3.2.1.cmml" xref="S4.E9.m1.3.3.3.3.2.1"><plus id="S4.E9.m1.3.3.3.3.2.1.6.cmml" xref="S4.E9.m1.3.3.3.3.2.1.6"></plus><apply id="S4.E9.m1.3.3.3.3.2.1.7.cmml" xref="S4.E9.m1.3.3.3.3.2.1.7"><times id="S4.E9.m1.3.3.3.3.2.1.7.1.cmml" xref="S4.E9.m1.3.3.3.3.2.1.7.1"></times><ci id="S4.E9.m1.3.3.3.3.2.1.7.2.cmml" xref="S4.E9.m1.3.3.3.3.2.1.7.2">𝛼</ci><apply id="S4.E9.m1.3.3.3.3.2.1.7.3.cmml" xref="S4.E9.m1.3.3.3.3.2.1.7.3"><csymbol cd="ambiguous" id="S4.E9.m1.3.3.3.3.2.1.7.3.1.cmml" xref="S4.E9.m1.3.3.3.3.2.1.7.3">subscript</csymbol><ci id="S4.E9.m1.3.3.3.3.2.1.7.3.2.cmml" xref="S4.E9.m1.3.3.3.3.2.1.7.3.2">P</ci><ci id="S4.E9.m1.3.3.3.3.2.1.7.3.3.cmml" xref="S4.E9.m1.3.3.3.3.2.1.7.3.3">det</ci></apply><interval closure="closed" id="S4.E9.m1.3.3.3.3.2.1.7.4.1.cmml" xref="S4.E9.m1.3.3.3.3.2.1.7.4.2"><ci id="S4.E9.m1.3.3.3.3.2.1.1.cmml" xref="S4.E9.m1.3.3.3.3.2.1.1">⋅</ci><ci id="S4.E9.m1.3.3.3.3.2.1.2.cmml" xref="S4.E9.m1.3.3.3.3.2.1.2">𝑗</ci></interval></apply><apply id="S4.E9.m1.3.3.3.3.2.1.5.cmml" xref="S4.E9.m1.3.3.3.3.2.1.5"><times id="S4.E9.m1.3.3.3.3.2.1.5.2.cmml" xref="S4.E9.m1.3.3.3.3.2.1.5.2"></times><apply id="S4.E9.m1.3.3.3.3.2.1.5.1.1.1.cmml" xref="S4.E9.m1.3.3.3.3.2.1.5.1.1"><minus id="S4.E9.m1.3.3.3.3.2.1.5.1.1.1.1.cmml" xref="S4.E9.m1.3.3.3.3.2.1.5.1.1.1.1"></minus><cn type="integer" id="S4.E9.m1.3.3.3.3.2.1.5.1.1.1.2.cmml" xref="S4.E9.m1.3.3.3.3.2.1.5.1.1.1.2">1</cn><ci id="S4.E9.m1.3.3.3.3.2.1.5.1.1.1.3.cmml" xref="S4.E9.m1.3.3.3.3.2.1.5.1.1.1.3">𝛼</ci></apply><apply id="S4.E9.m1.3.3.3.3.2.1.5.3.cmml" xref="S4.E9.m1.3.3.3.3.2.1.5.3"><csymbol cd="ambiguous" id="S4.E9.m1.3.3.3.3.2.1.5.3.1.cmml" xref="S4.E9.m1.3.3.3.3.2.1.5.3">subscript</csymbol><ci id="S4.E9.m1.3.3.3.3.2.1.5.3.2.cmml" xref="S4.E9.m1.3.3.3.3.2.1.5.3.2">P</ci><ci id="S4.E9.m1.3.3.3.3.2.1.5.3.3.cmml" xref="S4.E9.m1.3.3.3.3.2.1.5.3.3">clip</ci></apply><interval closure="closed" id="S4.E9.m1.3.3.3.3.2.1.5.4.1.cmml" xref="S4.E9.m1.3.3.3.3.2.1.5.4.2"><ci id="S4.E9.m1.3.3.3.3.2.1.3.cmml" xref="S4.E9.m1.3.3.3.3.2.1.3">⋅</ci><ci id="S4.E9.m1.3.3.3.3.2.1.4.cmml" xref="S4.E9.m1.3.3.3.3.2.1.4">𝑗</ci></interval></apply></apply><ci id="S4.E9.m1.1.1.1.1.1.1b.cmml" xref="S4.E9.m1.1.1.1.1.1.1"><mrow id="S4.E9.m1.1.1.1.1.1.1.cmml" xref="S4.E9.m1.1.1.1.1.1.1"><mtext id="S4.E9.m1.1.1.1.1.1.1a.cmml" xref="S4.E9.m1.1.1.1.1.1.1">if </mtext><mrow id="S4.E9.m1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S4.E9.m1.1.1.1.1.1.1.1.1.m1.1.1"><mi id="S4.E9.m1.1.1.1.1.1.1.1.1.m1.1.1.2.cmml" xref="S4.E9.m1.1.1.1.1.1.1.1.1.m1.1.1.2">j</mi><mo id="S4.E9.m1.1.1.1.1.1.1.1.1.m1.1.1.1.cmml" xref="S4.E9.m1.1.1.1.1.1.1.1.1.m1.1.1.1">∈</mo><msub id="S4.E9.m1.1.1.1.1.1.1.1.1.m1.1.1.3.cmml" xref="S4.E9.m1.1.1.1.1.1.1.1.1.m1.1.1.3"><mi id="S4.E9.m1.1.1.1.1.1.1.1.1.m1.1.1.3.2.cmml" xref="S4.E9.m1.1.1.1.1.1.1.1.1.m1.1.1.3.2">C</mi><mi id="S4.E9.m1.1.1.1.1.1.1.1.1.m1.1.1.3.3.cmml" xref="S4.E9.m1.1.1.1.1.1.1.1.1.m1.1.1.3.3">B</mi></msub></mrow></mrow></ci><apply id="S4.E9.m1.4.4.4.4.2.1.cmml" xref="S4.E9.m1.4.4.4.4.2.1"><plus id="S4.E9.m1.4.4.4.4.2.1.6.cmml" xref="S4.E9.m1.4.4.4.4.2.1.6"></plus><apply id="S4.E9.m1.4.4.4.4.2.1.7.cmml" xref="S4.E9.m1.4.4.4.4.2.1.7"><times id="S4.E9.m1.4.4.4.4.2.1.7.1.cmml" xref="S4.E9.m1.4.4.4.4.2.1.7.1"></times><ci id="S4.E9.m1.4.4.4.4.2.1.7.2.cmml" xref="S4.E9.m1.4.4.4.4.2.1.7.2">𝛽</ci><apply id="S4.E9.m1.4.4.4.4.2.1.7.3.cmml" xref="S4.E9.m1.4.4.4.4.2.1.7.3"><csymbol cd="ambiguous" id="S4.E9.m1.4.4.4.4.2.1.7.3.1.cmml" xref="S4.E9.m1.4.4.4.4.2.1.7.3">subscript</csymbol><ci id="S4.E9.m1.4.4.4.4.2.1.7.3.2.cmml" xref="S4.E9.m1.4.4.4.4.2.1.7.3.2">P</ci><ci id="S4.E9.m1.4.4.4.4.2.1.7.3.3.cmml" xref="S4.E9.m1.4.4.4.4.2.1.7.3.3">det</ci></apply><interval closure="closed" id="S4.E9.m1.4.4.4.4.2.1.7.4.1.cmml" xref="S4.E9.m1.4.4.4.4.2.1.7.4.2"><ci id="S4.E9.m1.4.4.4.4.2.1.1.cmml" xref="S4.E9.m1.4.4.4.4.2.1.1">⋅</ci><ci id="S4.E9.m1.4.4.4.4.2.1.2.cmml" xref="S4.E9.m1.4.4.4.4.2.1.2">𝑗</ci></interval></apply><apply id="S4.E9.m1.4.4.4.4.2.1.5.cmml" xref="S4.E9.m1.4.4.4.4.2.1.5"><times id="S4.E9.m1.4.4.4.4.2.1.5.2.cmml" xref="S4.E9.m1.4.4.4.4.2.1.5.2"></times><apply id="S4.E9.m1.4.4.4.4.2.1.5.1.1.1.cmml" xref="S4.E9.m1.4.4.4.4.2.1.5.1.1"><minus id="S4.E9.m1.4.4.4.4.2.1.5.1.1.1.1.cmml" xref="S4.E9.m1.4.4.4.4.2.1.5.1.1.1.1"></minus><cn type="integer" id="S4.E9.m1.4.4.4.4.2.1.5.1.1.1.2.cmml" xref="S4.E9.m1.4.4.4.4.2.1.5.1.1.1.2">1</cn><ci id="S4.E9.m1.4.4.4.4.2.1.5.1.1.1.3.cmml" xref="S4.E9.m1.4.4.4.4.2.1.5.1.1.1.3">𝛽</ci></apply><apply id="S4.E9.m1.4.4.4.4.2.1.5.3.cmml" xref="S4.E9.m1.4.4.4.4.2.1.5.3"><csymbol cd="ambiguous" id="S4.E9.m1.4.4.4.4.2.1.5.3.1.cmml" xref="S4.E9.m1.4.4.4.4.2.1.5.3">subscript</csymbol><ci id="S4.E9.m1.4.4.4.4.2.1.5.3.2.cmml" xref="S4.E9.m1.4.4.4.4.2.1.5.3.2">P</ci><ci id="S4.E9.m1.4.4.4.4.2.1.5.3.3.cmml" xref="S4.E9.m1.4.4.4.4.2.1.5.3.3">clip</ci></apply><interval closure="closed" id="S4.E9.m1.4.4.4.4.2.1.5.4.1.cmml" xref="S4.E9.m1.4.4.4.4.2.1.5.4.2"><ci id="S4.E9.m1.4.4.4.4.2.1.3.cmml" xref="S4.E9.m1.4.4.4.4.2.1.3">⋅</ci><ci id="S4.E9.m1.4.4.4.4.2.1.4.cmml" xref="S4.E9.m1.4.4.4.4.2.1.4">𝑗</ci></interval></apply></apply><ci id="S4.E9.m1.2.2.2.2.1.1.1.1b.cmml" xref="S4.E9.m1.2.2.2.2.1.1.3"><mrow id="S4.E9.m1.2.2.2.2.1.1.1.1.cmml" xref="S4.E9.m1.2.2.2.2.1.1.3"><mtext id="S4.E9.m1.2.2.2.2.1.1.1.1a.cmml" xref="S4.E9.m1.2.2.2.2.1.1.1.1a">if </mtext><mrow id="S4.E9.m1.2.2.2.2.1.1.1.1.m1.1.1.cmml" xref="S4.E9.m1.2.2.2.2.1.1.1.1.m1.1.1"><mi id="S4.E9.m1.2.2.2.2.1.1.1.1.m1.1.1.2.cmml" xref="S4.E9.m1.2.2.2.2.1.1.1.1.m1.1.1.2">j</mi><mo id="S4.E9.m1.2.2.2.2.1.1.1.1.m1.1.1.1.cmml" xref="S4.E9.m1.2.2.2.2.1.1.1.1.m1.1.1.1">∈</mo><msub id="S4.E9.m1.2.2.2.2.1.1.1.1.m1.1.1.3.cmml" xref="S4.E9.m1.2.2.2.2.1.1.1.1.m1.1.1.3"><mi id="S4.E9.m1.2.2.2.2.1.1.1.1.m1.1.1.3.2.cmml" xref="S4.E9.m1.2.2.2.2.1.1.1.1.m1.1.1.3.2">C</mi><mi id="S4.E9.m1.2.2.2.2.1.1.1.1.m1.1.1.3.3.cmml" xref="S4.E9.m1.2.2.2.2.1.1.1.1.m1.1.1.3.3">N</mi></msub></mrow></mrow></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E9.m1.6c">\!\!\!\!{\rm{P}}_{\rm final}{[\cdot,j]}\!=\!\begin{cases}\alpha{\rm{P}}_{\rm det}{[\cdot,j]}+(1\!-\!\alpha){\rm{P}}_{\rm clip}{[\cdot,j]}&amp;\!\!\!\!\text{if $j\in C_{B}$}\!\!\!\!\!\!\\
\beta{\rm{P}}_{\rm det}{[\cdot,j]}+(1\!-\!\beta){\rm{P}}_{\rm clip}{[\cdot,j]}&amp;\!\!\!\!\text{if $j\in C_{N}$},\!\!\!\!\!\!\end{cases}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
<p id="S4.SS2.p2.6" class="ltx_p">where <math id="S4.SS2.p2.1.m1.2" class="ltx_Math" alttext="[\cdot,j]" display="inline"><semantics id="S4.SS2.p2.1.m1.2a"><mrow id="S4.SS2.p2.1.m1.2.3.2" xref="S4.SS2.p2.1.m1.2.3.1.cmml"><mo stretchy="false" id="S4.SS2.p2.1.m1.2.3.2.1" xref="S4.SS2.p2.1.m1.2.3.1.cmml">[</mo><mo lspace="0em" rspace="0em" id="S4.SS2.p2.1.m1.1.1" xref="S4.SS2.p2.1.m1.1.1.cmml">⋅</mo><mo id="S4.SS2.p2.1.m1.2.3.2.2" xref="S4.SS2.p2.1.m1.2.3.1.cmml">,</mo><mi id="S4.SS2.p2.1.m1.2.2" xref="S4.SS2.p2.1.m1.2.2.cmml">j</mi><mo stretchy="false" id="S4.SS2.p2.1.m1.2.3.2.3" xref="S4.SS2.p2.1.m1.2.3.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.1.m1.2b"><interval closure="closed" id="S4.SS2.p2.1.m1.2.3.1.cmml" xref="S4.SS2.p2.1.m1.2.3.2"><ci id="S4.SS2.p2.1.m1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1">⋅</ci><ci id="S4.SS2.p2.1.m1.2.2.cmml" xref="S4.SS2.p2.1.m1.2.2">𝑗</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.1.m1.2c">[\cdot,j]</annotation></semantics></math> is the index for the <math id="S4.SS2.p2.2.m2.1" class="ltx_Math" alttext="j" display="inline"><semantics id="S4.SS2.p2.2.m2.1a"><mi id="S4.SS2.p2.2.m2.1.1" xref="S4.SS2.p2.2.m2.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.2.m2.1b"><ci id="S4.SS2.p2.2.m2.1.1.cmml" xref="S4.SS2.p2.2.m2.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.2.m2.1c">j</annotation></semantics></math>-th class column in the probability matrix <math id="S4.SS2.p2.3.m3.1" class="ltx_Math" alttext="{\rm P}\in\mathbb{R}^{m\times k}" display="inline"><semantics id="S4.SS2.p2.3.m3.1a"><mrow id="S4.SS2.p2.3.m3.1.1" xref="S4.SS2.p2.3.m3.1.1.cmml"><mi mathvariant="normal" id="S4.SS2.p2.3.m3.1.1.2" xref="S4.SS2.p2.3.m3.1.1.2.cmml">P</mi><mo id="S4.SS2.p2.3.m3.1.1.1" xref="S4.SS2.p2.3.m3.1.1.1.cmml">∈</mo><msup id="S4.SS2.p2.3.m3.1.1.3" xref="S4.SS2.p2.3.m3.1.1.3.cmml"><mi id="S4.SS2.p2.3.m3.1.1.3.2" xref="S4.SS2.p2.3.m3.1.1.3.2.cmml">ℝ</mi><mrow id="S4.SS2.p2.3.m3.1.1.3.3" xref="S4.SS2.p2.3.m3.1.1.3.3.cmml"><mi id="S4.SS2.p2.3.m3.1.1.3.3.2" xref="S4.SS2.p2.3.m3.1.1.3.3.2.cmml">m</mi><mo lspace="0.222em" rspace="0.222em" id="S4.SS2.p2.3.m3.1.1.3.3.1" xref="S4.SS2.p2.3.m3.1.1.3.3.1.cmml">×</mo><mi id="S4.SS2.p2.3.m3.1.1.3.3.3" xref="S4.SS2.p2.3.m3.1.1.3.3.3.cmml">k</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.3.m3.1b"><apply id="S4.SS2.p2.3.m3.1.1.cmml" xref="S4.SS2.p2.3.m3.1.1"><in id="S4.SS2.p2.3.m3.1.1.1.cmml" xref="S4.SS2.p2.3.m3.1.1.1"></in><ci id="S4.SS2.p2.3.m3.1.1.2.cmml" xref="S4.SS2.p2.3.m3.1.1.2">P</ci><apply id="S4.SS2.p2.3.m3.1.1.3.cmml" xref="S4.SS2.p2.3.m3.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p2.3.m3.1.1.3.1.cmml" xref="S4.SS2.p2.3.m3.1.1.3">superscript</csymbol><ci id="S4.SS2.p2.3.m3.1.1.3.2.cmml" xref="S4.SS2.p2.3.m3.1.1.3.2">ℝ</ci><apply id="S4.SS2.p2.3.m3.1.1.3.3.cmml" xref="S4.SS2.p2.3.m3.1.1.3.3"><times id="S4.SS2.p2.3.m3.1.1.3.3.1.cmml" xref="S4.SS2.p2.3.m3.1.1.3.3.1"></times><ci id="S4.SS2.p2.3.m3.1.1.3.3.2.cmml" xref="S4.SS2.p2.3.m3.1.1.3.3.2">𝑚</ci><ci id="S4.SS2.p2.3.m3.1.1.3.3.3.cmml" xref="S4.SS2.p2.3.m3.1.1.3.3.3">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.3.m3.1c">{\rm P}\in\mathbb{R}^{m\times k}</annotation></semantics></math>; <math id="S4.SS2.p2.4.m4.1" class="ltx_Math" alttext="C_{B}" display="inline"><semantics id="S4.SS2.p2.4.m4.1a"><msub id="S4.SS2.p2.4.m4.1.1" xref="S4.SS2.p2.4.m4.1.1.cmml"><mi id="S4.SS2.p2.4.m4.1.1.2" xref="S4.SS2.p2.4.m4.1.1.2.cmml">C</mi><mi id="S4.SS2.p2.4.m4.1.1.3" xref="S4.SS2.p2.4.m4.1.1.3.cmml">B</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.4.m4.1b"><apply id="S4.SS2.p2.4.m4.1.1.cmml" xref="S4.SS2.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.4.m4.1.1.1.cmml" xref="S4.SS2.p2.4.m4.1.1">subscript</csymbol><ci id="S4.SS2.p2.4.m4.1.1.2.cmml" xref="S4.SS2.p2.4.m4.1.1.2">𝐶</ci><ci id="S4.SS2.p2.4.m4.1.1.3.cmml" xref="S4.SS2.p2.4.m4.1.1.3">𝐵</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.4.m4.1c">C_{B}</annotation></semantics></math> and <math id="S4.SS2.p2.5.m5.1" class="ltx_Math" alttext="C_{N}" display="inline"><semantics id="S4.SS2.p2.5.m5.1a"><msub id="S4.SS2.p2.5.m5.1.1" xref="S4.SS2.p2.5.m5.1.1.cmml"><mi id="S4.SS2.p2.5.m5.1.1.2" xref="S4.SS2.p2.5.m5.1.1.2.cmml">C</mi><mi id="S4.SS2.p2.5.m5.1.1.3" xref="S4.SS2.p2.5.m5.1.1.3.cmml">N</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.5.m5.1b"><apply id="S4.SS2.p2.5.m5.1.1.cmml" xref="S4.SS2.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.5.m5.1.1.1.cmml" xref="S4.SS2.p2.5.m5.1.1">subscript</csymbol><ci id="S4.SS2.p2.5.m5.1.1.2.cmml" xref="S4.SS2.p2.5.m5.1.1.2">𝐶</ci><ci id="S4.SS2.p2.5.m5.1.1.3.cmml" xref="S4.SS2.p2.5.m5.1.1.3">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.5.m5.1c">C_{N}</annotation></semantics></math> are the set of base and novel classes; and <math id="S4.SS2.p2.6.m6.4" class="ltx_Math" alttext="\alpha,\beta\in[0,1]" display="inline"><semantics id="S4.SS2.p2.6.m6.4a"><mrow id="S4.SS2.p2.6.m6.4.5" xref="S4.SS2.p2.6.m6.4.5.cmml"><mrow id="S4.SS2.p2.6.m6.4.5.2.2" xref="S4.SS2.p2.6.m6.4.5.2.1.cmml"><mi id="S4.SS2.p2.6.m6.3.3" xref="S4.SS2.p2.6.m6.3.3.cmml">α</mi><mo id="S4.SS2.p2.6.m6.4.5.2.2.1" xref="S4.SS2.p2.6.m6.4.5.2.1.cmml">,</mo><mi id="S4.SS2.p2.6.m6.4.4" xref="S4.SS2.p2.6.m6.4.4.cmml">β</mi></mrow><mo id="S4.SS2.p2.6.m6.4.5.1" xref="S4.SS2.p2.6.m6.4.5.1.cmml">∈</mo><mrow id="S4.SS2.p2.6.m6.4.5.3.2" xref="S4.SS2.p2.6.m6.4.5.3.1.cmml"><mo stretchy="false" id="S4.SS2.p2.6.m6.4.5.3.2.1" xref="S4.SS2.p2.6.m6.4.5.3.1.cmml">[</mo><mn id="S4.SS2.p2.6.m6.1.1" xref="S4.SS2.p2.6.m6.1.1.cmml">0</mn><mo id="S4.SS2.p2.6.m6.4.5.3.2.2" xref="S4.SS2.p2.6.m6.4.5.3.1.cmml">,</mo><mn id="S4.SS2.p2.6.m6.2.2" xref="S4.SS2.p2.6.m6.2.2.cmml">1</mn><mo stretchy="false" id="S4.SS2.p2.6.m6.4.5.3.2.3" xref="S4.SS2.p2.6.m6.4.5.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.6.m6.4b"><apply id="S4.SS2.p2.6.m6.4.5.cmml" xref="S4.SS2.p2.6.m6.4.5"><in id="S4.SS2.p2.6.m6.4.5.1.cmml" xref="S4.SS2.p2.6.m6.4.5.1"></in><list id="S4.SS2.p2.6.m6.4.5.2.1.cmml" xref="S4.SS2.p2.6.m6.4.5.2.2"><ci id="S4.SS2.p2.6.m6.3.3.cmml" xref="S4.SS2.p2.6.m6.3.3">𝛼</ci><ci id="S4.SS2.p2.6.m6.4.4.cmml" xref="S4.SS2.p2.6.m6.4.4">𝛽</ci></list><interval closure="closed" id="S4.SS2.p2.6.m6.4.5.3.1.cmml" xref="S4.SS2.p2.6.m6.4.5.3.2"><cn type="integer" id="S4.SS2.p2.6.m6.1.1.cmml" xref="S4.SS2.p2.6.m6.1.1">0</cn><cn type="integer" id="S4.SS2.p2.6.m6.2.2.cmml" xref="S4.SS2.p2.6.m6.2.2">1</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.6.m6.4c">\alpha,\beta\in[0,1]</annotation></semantics></math> control the probability weights for base and novel classes, respectively. This ensemble approach helps mitigate the classification performance gap between base and novel classes in open-vocabulary detection because novel classes benefit much more than base classes. The analysis can be found demonstrated in Section <a href="#S5.SS2" title="5.2 Main Ablation Study ‣ 5 Evaluation ‣ ​​Prompt-Guided Transformers for End-to-End Open-Vocabulary Object Detection​​" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5.2</span></a>.</p>
</div>
<section id="S4.SS2.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.2.1 </span>RoI-based Masked Attention</h4>

<div id="S4.SS2.SSS1.p1" class="ltx_para">
<p id="S4.SS2.SSS1.p1.1" class="ltx_p">The iterative inference of Eq. (<a href="#S4.E7" title="In 4.2 Ensemble with ViT-based CLIP ‣ 4 Prompt-OVD ‣ ​​Prompt-Guided Transformers for End-to-End Open-Vocabulary Object Detection​​" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a>) harms the efficiency of using the large ViT-based CLIP model. RoI-Align <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite> is an efficient operator for extracting the feature maps from all the cropped patches, but this operator is confined to CNN architectures. Therefore, we introduce a new concept of <em id="S4.SS2.SSS1.p1.1.1" class="ltx_emph ltx_font_italic">RoI-based masked attention</em>, extracting the feature maps with a minimal cost of a single inference step.</p>
</div>
<div id="S4.SS2.SSS1.p2" class="ltx_para">
<p id="S4.SS2.SSS1.p2.2" class="ltx_p">Let <math id="S4.SS2.SSS1.p2.1.m1.3" class="ltx_Math" alttext="{\rm W}_{Q},{\rm W}_{K},{\rm W}_{V}" display="inline"><semantics id="S4.SS2.SSS1.p2.1.m1.3a"><mrow id="S4.SS2.SSS1.p2.1.m1.3.3.3" xref="S4.SS2.SSS1.p2.1.m1.3.3.4.cmml"><msub id="S4.SS2.SSS1.p2.1.m1.1.1.1.1" xref="S4.SS2.SSS1.p2.1.m1.1.1.1.1.cmml"><mi mathvariant="normal" id="S4.SS2.SSS1.p2.1.m1.1.1.1.1.2" xref="S4.SS2.SSS1.p2.1.m1.1.1.1.1.2.cmml">W</mi><mi id="S4.SS2.SSS1.p2.1.m1.1.1.1.1.3" xref="S4.SS2.SSS1.p2.1.m1.1.1.1.1.3.cmml">Q</mi></msub><mo id="S4.SS2.SSS1.p2.1.m1.3.3.3.4" xref="S4.SS2.SSS1.p2.1.m1.3.3.4.cmml">,</mo><msub id="S4.SS2.SSS1.p2.1.m1.2.2.2.2" xref="S4.SS2.SSS1.p2.1.m1.2.2.2.2.cmml"><mi mathvariant="normal" id="S4.SS2.SSS1.p2.1.m1.2.2.2.2.2" xref="S4.SS2.SSS1.p2.1.m1.2.2.2.2.2.cmml">W</mi><mi id="S4.SS2.SSS1.p2.1.m1.2.2.2.2.3" xref="S4.SS2.SSS1.p2.1.m1.2.2.2.2.3.cmml">K</mi></msub><mo id="S4.SS2.SSS1.p2.1.m1.3.3.3.5" xref="S4.SS2.SSS1.p2.1.m1.3.3.4.cmml">,</mo><msub id="S4.SS2.SSS1.p2.1.m1.3.3.3.3" xref="S4.SS2.SSS1.p2.1.m1.3.3.3.3.cmml"><mi mathvariant="normal" id="S4.SS2.SSS1.p2.1.m1.3.3.3.3.2" xref="S4.SS2.SSS1.p2.1.m1.3.3.3.3.2.cmml">W</mi><mi id="S4.SS2.SSS1.p2.1.m1.3.3.3.3.3" xref="S4.SS2.SSS1.p2.1.m1.3.3.3.3.3.cmml">V</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p2.1.m1.3b"><list id="S4.SS2.SSS1.p2.1.m1.3.3.4.cmml" xref="S4.SS2.SSS1.p2.1.m1.3.3.3"><apply id="S4.SS2.SSS1.p2.1.m1.1.1.1.1.cmml" xref="S4.SS2.SSS1.p2.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p2.1.m1.1.1.1.1.1.cmml" xref="S4.SS2.SSS1.p2.1.m1.1.1.1.1">subscript</csymbol><ci id="S4.SS2.SSS1.p2.1.m1.1.1.1.1.2.cmml" xref="S4.SS2.SSS1.p2.1.m1.1.1.1.1.2">W</ci><ci id="S4.SS2.SSS1.p2.1.m1.1.1.1.1.3.cmml" xref="S4.SS2.SSS1.p2.1.m1.1.1.1.1.3">𝑄</ci></apply><apply id="S4.SS2.SSS1.p2.1.m1.2.2.2.2.cmml" xref="S4.SS2.SSS1.p2.1.m1.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p2.1.m1.2.2.2.2.1.cmml" xref="S4.SS2.SSS1.p2.1.m1.2.2.2.2">subscript</csymbol><ci id="S4.SS2.SSS1.p2.1.m1.2.2.2.2.2.cmml" xref="S4.SS2.SSS1.p2.1.m1.2.2.2.2.2">W</ci><ci id="S4.SS2.SSS1.p2.1.m1.2.2.2.2.3.cmml" xref="S4.SS2.SSS1.p2.1.m1.2.2.2.2.3">𝐾</ci></apply><apply id="S4.SS2.SSS1.p2.1.m1.3.3.3.3.cmml" xref="S4.SS2.SSS1.p2.1.m1.3.3.3.3"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p2.1.m1.3.3.3.3.1.cmml" xref="S4.SS2.SSS1.p2.1.m1.3.3.3.3">subscript</csymbol><ci id="S4.SS2.SSS1.p2.1.m1.3.3.3.3.2.cmml" xref="S4.SS2.SSS1.p2.1.m1.3.3.3.3.2">W</ci><ci id="S4.SS2.SSS1.p2.1.m1.3.3.3.3.3.cmml" xref="S4.SS2.SSS1.p2.1.m1.3.3.3.3.3">𝑉</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p2.1.m1.3c">{\rm W}_{Q},{\rm W}_{K},{\rm W}_{V}</annotation></semantics></math> be the query, key, value projection matrices of the <em id="S4.SS2.SSS1.p2.2.1" class="ltx_emph ltx_font_italic">last</em> attention layer in the ViT. Then, the attention map <math id="S4.SS2.SSS1.p2.2.m2.2" class="ltx_Math" alttext="{\rm Attn}({\rm E}_{Q},{\rm E}_{K})\in\mathbb{R}^{hw}" display="inline"><semantics id="S4.SS2.SSS1.p2.2.m2.2a"><mrow id="S4.SS2.SSS1.p2.2.m2.2.2" xref="S4.SS2.SSS1.p2.2.m2.2.2.cmml"><mrow id="S4.SS2.SSS1.p2.2.m2.2.2.2" xref="S4.SS2.SSS1.p2.2.m2.2.2.2.cmml"><mi id="S4.SS2.SSS1.p2.2.m2.2.2.2.4" xref="S4.SS2.SSS1.p2.2.m2.2.2.2.4.cmml">Attn</mi><mo lspace="0em" rspace="0em" id="S4.SS2.SSS1.p2.2.m2.2.2.2.3" xref="S4.SS2.SSS1.p2.2.m2.2.2.2.3.cmml">​</mo><mrow id="S4.SS2.SSS1.p2.2.m2.2.2.2.2.2" xref="S4.SS2.SSS1.p2.2.m2.2.2.2.2.3.cmml"><mo stretchy="false" id="S4.SS2.SSS1.p2.2.m2.2.2.2.2.2.3" xref="S4.SS2.SSS1.p2.2.m2.2.2.2.2.3.cmml">(</mo><msub id="S4.SS2.SSS1.p2.2.m2.1.1.1.1.1.1" xref="S4.SS2.SSS1.p2.2.m2.1.1.1.1.1.1.cmml"><mi mathvariant="normal" id="S4.SS2.SSS1.p2.2.m2.1.1.1.1.1.1.2" xref="S4.SS2.SSS1.p2.2.m2.1.1.1.1.1.1.2.cmml">E</mi><mi id="S4.SS2.SSS1.p2.2.m2.1.1.1.1.1.1.3" xref="S4.SS2.SSS1.p2.2.m2.1.1.1.1.1.1.3.cmml">Q</mi></msub><mo id="S4.SS2.SSS1.p2.2.m2.2.2.2.2.2.4" xref="S4.SS2.SSS1.p2.2.m2.2.2.2.2.3.cmml">,</mo><msub id="S4.SS2.SSS1.p2.2.m2.2.2.2.2.2.2" xref="S4.SS2.SSS1.p2.2.m2.2.2.2.2.2.2.cmml"><mi mathvariant="normal" id="S4.SS2.SSS1.p2.2.m2.2.2.2.2.2.2.2" xref="S4.SS2.SSS1.p2.2.m2.2.2.2.2.2.2.2.cmml">E</mi><mi id="S4.SS2.SSS1.p2.2.m2.2.2.2.2.2.2.3" xref="S4.SS2.SSS1.p2.2.m2.2.2.2.2.2.2.3.cmml">K</mi></msub><mo stretchy="false" id="S4.SS2.SSS1.p2.2.m2.2.2.2.2.2.5" xref="S4.SS2.SSS1.p2.2.m2.2.2.2.2.3.cmml">)</mo></mrow></mrow><mo id="S4.SS2.SSS1.p2.2.m2.2.2.3" xref="S4.SS2.SSS1.p2.2.m2.2.2.3.cmml">∈</mo><msup id="S4.SS2.SSS1.p2.2.m2.2.2.4" xref="S4.SS2.SSS1.p2.2.m2.2.2.4.cmml"><mi id="S4.SS2.SSS1.p2.2.m2.2.2.4.2" xref="S4.SS2.SSS1.p2.2.m2.2.2.4.2.cmml">ℝ</mi><mrow id="S4.SS2.SSS1.p2.2.m2.2.2.4.3" xref="S4.SS2.SSS1.p2.2.m2.2.2.4.3.cmml"><mi id="S4.SS2.SSS1.p2.2.m2.2.2.4.3.2" xref="S4.SS2.SSS1.p2.2.m2.2.2.4.3.2.cmml">h</mi><mo lspace="0em" rspace="0em" id="S4.SS2.SSS1.p2.2.m2.2.2.4.3.1" xref="S4.SS2.SSS1.p2.2.m2.2.2.4.3.1.cmml">​</mo><mi id="S4.SS2.SSS1.p2.2.m2.2.2.4.3.3" xref="S4.SS2.SSS1.p2.2.m2.2.2.4.3.3.cmml">w</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p2.2.m2.2b"><apply id="S4.SS2.SSS1.p2.2.m2.2.2.cmml" xref="S4.SS2.SSS1.p2.2.m2.2.2"><in id="S4.SS2.SSS1.p2.2.m2.2.2.3.cmml" xref="S4.SS2.SSS1.p2.2.m2.2.2.3"></in><apply id="S4.SS2.SSS1.p2.2.m2.2.2.2.cmml" xref="S4.SS2.SSS1.p2.2.m2.2.2.2"><times id="S4.SS2.SSS1.p2.2.m2.2.2.2.3.cmml" xref="S4.SS2.SSS1.p2.2.m2.2.2.2.3"></times><ci id="S4.SS2.SSS1.p2.2.m2.2.2.2.4.cmml" xref="S4.SS2.SSS1.p2.2.m2.2.2.2.4">Attn</ci><interval closure="open" id="S4.SS2.SSS1.p2.2.m2.2.2.2.2.3.cmml" xref="S4.SS2.SSS1.p2.2.m2.2.2.2.2.2"><apply id="S4.SS2.SSS1.p2.2.m2.1.1.1.1.1.1.cmml" xref="S4.SS2.SSS1.p2.2.m2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p2.2.m2.1.1.1.1.1.1.1.cmml" xref="S4.SS2.SSS1.p2.2.m2.1.1.1.1.1.1">subscript</csymbol><ci id="S4.SS2.SSS1.p2.2.m2.1.1.1.1.1.1.2.cmml" xref="S4.SS2.SSS1.p2.2.m2.1.1.1.1.1.1.2">E</ci><ci id="S4.SS2.SSS1.p2.2.m2.1.1.1.1.1.1.3.cmml" xref="S4.SS2.SSS1.p2.2.m2.1.1.1.1.1.1.3">𝑄</ci></apply><apply id="S4.SS2.SSS1.p2.2.m2.2.2.2.2.2.2.cmml" xref="S4.SS2.SSS1.p2.2.m2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p2.2.m2.2.2.2.2.2.2.1.cmml" xref="S4.SS2.SSS1.p2.2.m2.2.2.2.2.2.2">subscript</csymbol><ci id="S4.SS2.SSS1.p2.2.m2.2.2.2.2.2.2.2.cmml" xref="S4.SS2.SSS1.p2.2.m2.2.2.2.2.2.2.2">E</ci><ci id="S4.SS2.SSS1.p2.2.m2.2.2.2.2.2.2.3.cmml" xref="S4.SS2.SSS1.p2.2.m2.2.2.2.2.2.2.3">𝐾</ci></apply></interval></apply><apply id="S4.SS2.SSS1.p2.2.m2.2.2.4.cmml" xref="S4.SS2.SSS1.p2.2.m2.2.2.4"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p2.2.m2.2.2.4.1.cmml" xref="S4.SS2.SSS1.p2.2.m2.2.2.4">superscript</csymbol><ci id="S4.SS2.SSS1.p2.2.m2.2.2.4.2.cmml" xref="S4.SS2.SSS1.p2.2.m2.2.2.4.2">ℝ</ci><apply id="S4.SS2.SSS1.p2.2.m2.2.2.4.3.cmml" xref="S4.SS2.SSS1.p2.2.m2.2.2.4.3"><times id="S4.SS2.SSS1.p2.2.m2.2.2.4.3.1.cmml" xref="S4.SS2.SSS1.p2.2.m2.2.2.4.3.1"></times><ci id="S4.SS2.SSS1.p2.2.m2.2.2.4.3.2.cmml" xref="S4.SS2.SSS1.p2.2.m2.2.2.4.3.2">ℎ</ci><ci id="S4.SS2.SSS1.p2.2.m2.2.2.4.3.3.cmml" xref="S4.SS2.SSS1.p2.2.m2.2.2.4.3.3">𝑤</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p2.2.m2.2c">{\rm Attn}({\rm E}_{Q},{\rm E}_{K})\in\mathbb{R}^{hw}</annotation></semantics></math> of the last Transformer layers is computed by:</p>
<table id="S4.E10" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E10.m1.30" class="ltx_Math" alttext="\begin{gathered}\!\!\!{\rm Attn}={\rm Softmax}\big{(}\frac{({\rm E}_{Q}{\rm W}_{Q})({\rm E}_{K}{\rm W}_{K})^{\top}}{\sqrt{d}}\big{)}\!\!\!\\
{\rm where}~{}~{}{\rm E}_{Q}=[{\bf e}^{\rm cls}_{L-1}]~{}~{}{\rm and}~{}~{}{\rm E}_{K}=[{\bf e}^{\rm cls}_{L-1};\rm{I}_{L-1}].\end{gathered}" display="block"><semantics id="S4.E10.m1.30a"><mtable displaystyle="true" rowspacing="0pt" id="S4.E10.m1.30.30.2"><mtr id="S4.E10.m1.30.30.2a"><mtd id="S4.E10.m1.30.30.2b"><mrow id="S4.E10.m1.6.6.6.6.6"><mi id="S4.E10.m1.1.1.1.1.1.1" xref="S4.E10.m1.1.1.1.1.1.1.cmml">Attn</mi><mo id="S4.E10.m1.2.2.2.2.2.2" xref="S4.E10.m1.2.2.2.2.2.2.cmml">=</mo><mrow id="S4.E10.m1.6.6.6.6.6.7"><mi id="S4.E10.m1.3.3.3.3.3.3" xref="S4.E10.m1.3.3.3.3.3.3.cmml">Softmax</mi><mo lspace="0em" rspace="0em" id="S4.E10.m1.6.6.6.6.6.7.1" xref="S4.E10.m1.29.29.1.1.1.cmml">​</mo><mrow id="S4.E10.m1.6.6.6.6.6.7.2"><mo maxsize="120%" minsize="120%" id="S4.E10.m1.4.4.4.4.4.4" xref="S4.E10.m1.29.29.1.1.1.cmml">(</mo><mfrac id="S4.E10.m1.5.5.5.5.5.5" xref="S4.E10.m1.5.5.5.5.5.5.cmml"><mrow id="S4.E10.m1.5.5.5.5.5.5.2" xref="S4.E10.m1.5.5.5.5.5.5.2.cmml"><mrow id="S4.E10.m1.5.5.5.5.5.5.1.1.1" xref="S4.E10.m1.5.5.5.5.5.5.1.1.1.1.cmml"><mo stretchy="false" id="S4.E10.m1.5.5.5.5.5.5.1.1.1.2" xref="S4.E10.m1.5.5.5.5.5.5.1.1.1.1.cmml">(</mo><mrow id="S4.E10.m1.5.5.5.5.5.5.1.1.1.1" xref="S4.E10.m1.5.5.5.5.5.5.1.1.1.1.cmml"><msub id="S4.E10.m1.5.5.5.5.5.5.1.1.1.1.2" xref="S4.E10.m1.5.5.5.5.5.5.1.1.1.1.2.cmml"><mi mathvariant="normal" id="S4.E10.m1.5.5.5.5.5.5.1.1.1.1.2.2" xref="S4.E10.m1.5.5.5.5.5.5.1.1.1.1.2.2.cmml">E</mi><mi id="S4.E10.m1.5.5.5.5.5.5.1.1.1.1.2.3" xref="S4.E10.m1.5.5.5.5.5.5.1.1.1.1.2.3.cmml">Q</mi></msub><mo lspace="0em" rspace="0em" id="S4.E10.m1.5.5.5.5.5.5.1.1.1.1.1" xref="S4.E10.m1.5.5.5.5.5.5.1.1.1.1.1.cmml">​</mo><msub id="S4.E10.m1.5.5.5.5.5.5.1.1.1.1.3" xref="S4.E10.m1.5.5.5.5.5.5.1.1.1.1.3.cmml"><mi mathvariant="normal" id="S4.E10.m1.5.5.5.5.5.5.1.1.1.1.3.2" xref="S4.E10.m1.5.5.5.5.5.5.1.1.1.1.3.2.cmml">W</mi><mi id="S4.E10.m1.5.5.5.5.5.5.1.1.1.1.3.3" xref="S4.E10.m1.5.5.5.5.5.5.1.1.1.1.3.3.cmml">Q</mi></msub></mrow><mo stretchy="false" id="S4.E10.m1.5.5.5.5.5.5.1.1.1.3" xref="S4.E10.m1.5.5.5.5.5.5.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S4.E10.m1.5.5.5.5.5.5.2.3" xref="S4.E10.m1.5.5.5.5.5.5.2.3.cmml">​</mo><msup id="S4.E10.m1.5.5.5.5.5.5.2.2" xref="S4.E10.m1.5.5.5.5.5.5.2.2.cmml"><mrow id="S4.E10.m1.5.5.5.5.5.5.2.2.1.1" xref="S4.E10.m1.5.5.5.5.5.5.2.2.1.1.1.cmml"><mo stretchy="false" id="S4.E10.m1.5.5.5.5.5.5.2.2.1.1.2" xref="S4.E10.m1.5.5.5.5.5.5.2.2.1.1.1.cmml">(</mo><mrow id="S4.E10.m1.5.5.5.5.5.5.2.2.1.1.1" xref="S4.E10.m1.5.5.5.5.5.5.2.2.1.1.1.cmml"><msub id="S4.E10.m1.5.5.5.5.5.5.2.2.1.1.1.2" xref="S4.E10.m1.5.5.5.5.5.5.2.2.1.1.1.2.cmml"><mi mathvariant="normal" id="S4.E10.m1.5.5.5.5.5.5.2.2.1.1.1.2.2" xref="S4.E10.m1.5.5.5.5.5.5.2.2.1.1.1.2.2.cmml">E</mi><mi id="S4.E10.m1.5.5.5.5.5.5.2.2.1.1.1.2.3" xref="S4.E10.m1.5.5.5.5.5.5.2.2.1.1.1.2.3.cmml">K</mi></msub><mo lspace="0em" rspace="0em" id="S4.E10.m1.5.5.5.5.5.5.2.2.1.1.1.1" xref="S4.E10.m1.5.5.5.5.5.5.2.2.1.1.1.1.cmml">​</mo><msub id="S4.E10.m1.5.5.5.5.5.5.2.2.1.1.1.3" xref="S4.E10.m1.5.5.5.5.5.5.2.2.1.1.1.3.cmml"><mi mathvariant="normal" id="S4.E10.m1.5.5.5.5.5.5.2.2.1.1.1.3.2" xref="S4.E10.m1.5.5.5.5.5.5.2.2.1.1.1.3.2.cmml">W</mi><mi id="S4.E10.m1.5.5.5.5.5.5.2.2.1.1.1.3.3" xref="S4.E10.m1.5.5.5.5.5.5.2.2.1.1.1.3.3.cmml">K</mi></msub></mrow><mo stretchy="false" id="S4.E10.m1.5.5.5.5.5.5.2.2.1.1.3" xref="S4.E10.m1.5.5.5.5.5.5.2.2.1.1.1.cmml">)</mo></mrow><mo id="S4.E10.m1.5.5.5.5.5.5.2.2.3" xref="S4.E10.m1.5.5.5.5.5.5.2.2.3.cmml">⊤</mo></msup></mrow><msqrt id="S4.E10.m1.5.5.5.5.5.5.4" xref="S4.E10.m1.5.5.5.5.5.5.4.cmml"><mi id="S4.E10.m1.5.5.5.5.5.5.4.2" xref="S4.E10.m1.5.5.5.5.5.5.4.2.cmml">d</mi></msqrt></mfrac><mo maxsize="120%" minsize="120%" id="S4.E10.m1.6.6.6.6.6.6" xref="S4.E10.m1.29.29.1.1.1.cmml">)</mo></mrow></mrow></mrow></mtd></mtr><mtr id="S4.E10.m1.30.30.2c"><mtd id="S4.E10.m1.30.30.2d"><mrow id="S4.E10.m1.30.30.2.29.23.23.23"><mrow id="S4.E10.m1.30.30.2.29.23.23.23.1"><mrow id="S4.E10.m1.30.30.2.29.23.23.23.1.5"><mi id="S4.E10.m1.7.7.7.1.1.1" xref="S4.E10.m1.7.7.7.1.1.1.cmml">where</mi><mo lspace="0.660em" rspace="0em" id="S4.E10.m1.30.30.2.29.23.23.23.1.5.1" xref="S4.E10.m1.29.29.1.1.1.cmml">​</mo><msub id="S4.E10.m1.30.30.2.29.23.23.23.1.5.2"><mi mathvariant="normal" id="S4.E10.m1.8.8.8.2.2.2" xref="S4.E10.m1.8.8.8.2.2.2.cmml">E</mi><mi id="S4.E10.m1.9.9.9.3.3.3.1" xref="S4.E10.m1.9.9.9.3.3.3.1.cmml">Q</mi></msub></mrow><mo id="S4.E10.m1.10.10.10.4.4.4" xref="S4.E10.m1.10.10.10.4.4.4.cmml">=</mo><mrow id="S4.E10.m1.30.30.2.29.23.23.23.1.1"><mrow id="S4.E10.m1.30.30.2.29.23.23.23.1.1.1.1"><mo stretchy="false" id="S4.E10.m1.11.11.11.5.5.5" xref="S4.E10.m1.29.29.1.1.1.cmml">[</mo><msubsup id="S4.E10.m1.30.30.2.29.23.23.23.1.1.1.1.1"><mi id="S4.E10.m1.12.12.12.6.6.6" xref="S4.E10.m1.12.12.12.6.6.6.cmml">𝐞</mi><mrow id="S4.E10.m1.14.14.14.8.8.8.1" xref="S4.E10.m1.14.14.14.8.8.8.1.cmml"><mi id="S4.E10.m1.14.14.14.8.8.8.1.2" xref="S4.E10.m1.14.14.14.8.8.8.1.2.cmml">L</mi><mo id="S4.E10.m1.14.14.14.8.8.8.1.1" xref="S4.E10.m1.14.14.14.8.8.8.1.1.cmml">−</mo><mn id="S4.E10.m1.14.14.14.8.8.8.1.3" xref="S4.E10.m1.14.14.14.8.8.8.1.3.cmml">1</mn></mrow><mi id="S4.E10.m1.13.13.13.7.7.7.1" xref="S4.E10.m1.13.13.13.7.7.7.1.cmml">cls</mi></msubsup><mo stretchy="false" id="S4.E10.m1.15.15.15.9.9.9" xref="S4.E10.m1.29.29.1.1.1.cmml">]</mo></mrow><mo lspace="0.660em" rspace="0em" id="S4.E10.m1.30.30.2.29.23.23.23.1.1.2" xref="S4.E10.m1.29.29.1.1.1.cmml">​</mo><mi id="S4.E10.m1.16.16.16.10.10.10" xref="S4.E10.m1.16.16.16.10.10.10.cmml">and</mi><mo lspace="0.660em" rspace="0em" id="S4.E10.m1.30.30.2.29.23.23.23.1.1.2a" xref="S4.E10.m1.29.29.1.1.1.cmml">​</mo><msub id="S4.E10.m1.30.30.2.29.23.23.23.1.1.3"><mi mathvariant="normal" id="S4.E10.m1.17.17.17.11.11.11" xref="S4.E10.m1.17.17.17.11.11.11.cmml">E</mi><mi id="S4.E10.m1.18.18.18.12.12.12.1" xref="S4.E10.m1.18.18.18.12.12.12.1.cmml">K</mi></msub></mrow><mo id="S4.E10.m1.19.19.19.13.13.13" xref="S4.E10.m1.19.19.19.13.13.13.cmml">=</mo><mrow id="S4.E10.m1.30.30.2.29.23.23.23.1.3.2"><mo stretchy="false" id="S4.E10.m1.20.20.20.14.14.14" xref="S4.E10.m1.29.29.1.1.1.cmml">[</mo><msubsup id="S4.E10.m1.30.30.2.29.23.23.23.1.2.1.1"><mi id="S4.E10.m1.21.21.21.15.15.15" xref="S4.E10.m1.21.21.21.15.15.15.cmml">𝐞</mi><mrow id="S4.E10.m1.23.23.23.17.17.17.1" xref="S4.E10.m1.23.23.23.17.17.17.1.cmml"><mi id="S4.E10.m1.23.23.23.17.17.17.1.2" xref="S4.E10.m1.23.23.23.17.17.17.1.2.cmml">L</mi><mo id="S4.E10.m1.23.23.23.17.17.17.1.1" xref="S4.E10.m1.23.23.23.17.17.17.1.1.cmml">−</mo><mn id="S4.E10.m1.23.23.23.17.17.17.1.3" xref="S4.E10.m1.23.23.23.17.17.17.1.3.cmml">1</mn></mrow><mi id="S4.E10.m1.22.22.22.16.16.16.1" xref="S4.E10.m1.22.22.22.16.16.16.1.cmml">cls</mi></msubsup><mo id="S4.E10.m1.24.24.24.18.18.18" xref="S4.E10.m1.29.29.1.1.1.cmml">;</mo><msub id="S4.E10.m1.30.30.2.29.23.23.23.1.3.2.2"><mi mathvariant="normal" id="S4.E10.m1.25.25.25.19.19.19" xref="S4.E10.m1.25.25.25.19.19.19.cmml">I</mi><mrow id="S4.E10.m1.26.26.26.20.20.20.1" xref="S4.E10.m1.26.26.26.20.20.20.1.cmml"><mi mathvariant="normal" id="S4.E10.m1.26.26.26.20.20.20.1.2" xref="S4.E10.m1.26.26.26.20.20.20.1.2.cmml">L</mi><mo id="S4.E10.m1.26.26.26.20.20.20.1.1" xref="S4.E10.m1.26.26.26.20.20.20.1.1.cmml">−</mo><mn id="S4.E10.m1.26.26.26.20.20.20.1.3" xref="S4.E10.m1.26.26.26.20.20.20.1.3.cmml">1</mn></mrow></msub><mo stretchy="false" id="S4.E10.m1.27.27.27.21.21.21" xref="S4.E10.m1.29.29.1.1.1.cmml">]</mo></mrow></mrow><mo lspace="0em" id="S4.E10.m1.28.28.28.22.22.22" xref="S4.E10.m1.29.29.1.1.1.cmml">.</mo></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S4.E10.m1.30b"><apply id="S4.E10.m1.29.29.1.1.1.cmml" xref="S4.E10.m1.6.6.6.6.6.7.1"><and id="S4.E10.m1.29.29.1.1.1a.cmml" xref="S4.E10.m1.6.6.6.6.6.7.1"></and><apply id="S4.E10.m1.29.29.1.1.1b.cmml" xref="S4.E10.m1.6.6.6.6.6.7.1"><eq id="S4.E10.m1.2.2.2.2.2.2.cmml" xref="S4.E10.m1.2.2.2.2.2.2"></eq><ci id="S4.E10.m1.1.1.1.1.1.1.cmml" xref="S4.E10.m1.1.1.1.1.1.1">Attn</ci><apply id="S4.E10.m1.29.29.1.1.1.7.cmml" xref="S4.E10.m1.6.6.6.6.6.7.1"><times id="S4.E10.m1.29.29.1.1.1.7.1.cmml" xref="S4.E10.m1.6.6.6.6.6.7.1"></times><ci id="S4.E10.m1.3.3.3.3.3.3.cmml" xref="S4.E10.m1.3.3.3.3.3.3">Softmax</ci><apply id="S4.E10.m1.5.5.5.5.5.5.cmml" xref="S4.E10.m1.5.5.5.5.5.5"><divide id="S4.E10.m1.5.5.5.5.5.5.3.cmml" xref="S4.E10.m1.5.5.5.5.5.5"></divide><apply id="S4.E10.m1.5.5.5.5.5.5.2.cmml" xref="S4.E10.m1.5.5.5.5.5.5.2"><times id="S4.E10.m1.5.5.5.5.5.5.2.3.cmml" xref="S4.E10.m1.5.5.5.5.5.5.2.3"></times><apply id="S4.E10.m1.5.5.5.5.5.5.1.1.1.1.cmml" xref="S4.E10.m1.5.5.5.5.5.5.1.1.1"><times id="S4.E10.m1.5.5.5.5.5.5.1.1.1.1.1.cmml" xref="S4.E10.m1.5.5.5.5.5.5.1.1.1.1.1"></times><apply id="S4.E10.m1.5.5.5.5.5.5.1.1.1.1.2.cmml" xref="S4.E10.m1.5.5.5.5.5.5.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E10.m1.5.5.5.5.5.5.1.1.1.1.2.1.cmml" xref="S4.E10.m1.5.5.5.5.5.5.1.1.1.1.2">subscript</csymbol><ci id="S4.E10.m1.5.5.5.5.5.5.1.1.1.1.2.2.cmml" xref="S4.E10.m1.5.5.5.5.5.5.1.1.1.1.2.2">E</ci><ci id="S4.E10.m1.5.5.5.5.5.5.1.1.1.1.2.3.cmml" xref="S4.E10.m1.5.5.5.5.5.5.1.1.1.1.2.3">𝑄</ci></apply><apply id="S4.E10.m1.5.5.5.5.5.5.1.1.1.1.3.cmml" xref="S4.E10.m1.5.5.5.5.5.5.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E10.m1.5.5.5.5.5.5.1.1.1.1.3.1.cmml" xref="S4.E10.m1.5.5.5.5.5.5.1.1.1.1.3">subscript</csymbol><ci id="S4.E10.m1.5.5.5.5.5.5.1.1.1.1.3.2.cmml" xref="S4.E10.m1.5.5.5.5.5.5.1.1.1.1.3.2">W</ci><ci id="S4.E10.m1.5.5.5.5.5.5.1.1.1.1.3.3.cmml" xref="S4.E10.m1.5.5.5.5.5.5.1.1.1.1.3.3">𝑄</ci></apply></apply><apply id="S4.E10.m1.5.5.5.5.5.5.2.2.cmml" xref="S4.E10.m1.5.5.5.5.5.5.2.2"><csymbol cd="ambiguous" id="S4.E10.m1.5.5.5.5.5.5.2.2.2.cmml" xref="S4.E10.m1.5.5.5.5.5.5.2.2">superscript</csymbol><apply id="S4.E10.m1.5.5.5.5.5.5.2.2.1.1.1.cmml" xref="S4.E10.m1.5.5.5.5.5.5.2.2.1.1"><times id="S4.E10.m1.5.5.5.5.5.5.2.2.1.1.1.1.cmml" xref="S4.E10.m1.5.5.5.5.5.5.2.2.1.1.1.1"></times><apply id="S4.E10.m1.5.5.5.5.5.5.2.2.1.1.1.2.cmml" xref="S4.E10.m1.5.5.5.5.5.5.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S4.E10.m1.5.5.5.5.5.5.2.2.1.1.1.2.1.cmml" xref="S4.E10.m1.5.5.5.5.5.5.2.2.1.1.1.2">subscript</csymbol><ci id="S4.E10.m1.5.5.5.5.5.5.2.2.1.1.1.2.2.cmml" xref="S4.E10.m1.5.5.5.5.5.5.2.2.1.1.1.2.2">E</ci><ci id="S4.E10.m1.5.5.5.5.5.5.2.2.1.1.1.2.3.cmml" xref="S4.E10.m1.5.5.5.5.5.5.2.2.1.1.1.2.3">𝐾</ci></apply><apply id="S4.E10.m1.5.5.5.5.5.5.2.2.1.1.1.3.cmml" xref="S4.E10.m1.5.5.5.5.5.5.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S4.E10.m1.5.5.5.5.5.5.2.2.1.1.1.3.1.cmml" xref="S4.E10.m1.5.5.5.5.5.5.2.2.1.1.1.3">subscript</csymbol><ci id="S4.E10.m1.5.5.5.5.5.5.2.2.1.1.1.3.2.cmml" xref="S4.E10.m1.5.5.5.5.5.5.2.2.1.1.1.3.2">W</ci><ci id="S4.E10.m1.5.5.5.5.5.5.2.2.1.1.1.3.3.cmml" xref="S4.E10.m1.5.5.5.5.5.5.2.2.1.1.1.3.3">𝐾</ci></apply></apply><csymbol cd="latexml" id="S4.E10.m1.5.5.5.5.5.5.2.2.3.cmml" xref="S4.E10.m1.5.5.5.5.5.5.2.2.3">top</csymbol></apply></apply><apply id="S4.E10.m1.5.5.5.5.5.5.4.cmml" xref="S4.E10.m1.5.5.5.5.5.5.4"><root id="S4.E10.m1.5.5.5.5.5.5.4a.cmml" xref="S4.E10.m1.5.5.5.5.5.5.4"></root><ci id="S4.E10.m1.5.5.5.5.5.5.4.2.cmml" xref="S4.E10.m1.5.5.5.5.5.5.4.2">𝑑</ci></apply></apply><ci id="S4.E10.m1.7.7.7.1.1.1.cmml" xref="S4.E10.m1.7.7.7.1.1.1">where</ci><apply id="S4.E10.m1.29.29.1.1.1.7.5.cmml" xref="S4.E10.m1.6.6.6.6.6.7.1"><csymbol cd="ambiguous" id="S4.E10.m1.29.29.1.1.1.7.5.1.cmml" xref="S4.E10.m1.6.6.6.6.6.7.1">subscript</csymbol><ci id="S4.E10.m1.8.8.8.2.2.2.cmml" xref="S4.E10.m1.8.8.8.2.2.2">E</ci><ci id="S4.E10.m1.9.9.9.3.3.3.1.cmml" xref="S4.E10.m1.9.9.9.3.3.3.1">𝑄</ci></apply></apply></apply><apply id="S4.E10.m1.29.29.1.1.1c.cmml" xref="S4.E10.m1.6.6.6.6.6.7.1"><eq id="S4.E10.m1.10.10.10.4.4.4.cmml" xref="S4.E10.m1.10.10.10.4.4.4"></eq><share href="#S4.E10.m1.29.29.1.1.1.7.cmml" id="S4.E10.m1.29.29.1.1.1d.cmml" xref="S4.E10.m1.6.6.6.6.6.7.1"></share><apply id="S4.E10.m1.29.29.1.1.1.1.cmml" xref="S4.E10.m1.6.6.6.6.6.7.1"><times id="S4.E10.m1.29.29.1.1.1.1.2.cmml" xref="S4.E10.m1.6.6.6.6.6.7.1"></times><apply id="S4.E10.m1.29.29.1.1.1.1.1.2.cmml" xref="S4.E10.m1.6.6.6.6.6.7.1"><csymbol cd="latexml" id="S4.E10.m1.29.29.1.1.1.1.1.2.1.cmml" xref="S4.E10.m1.6.6.6.6.6.7.1">delimited-[]</csymbol><apply id="S4.E10.m1.29.29.1.1.1.1.1.1.1.cmml" xref="S4.E10.m1.6.6.6.6.6.7.1"><csymbol cd="ambiguous" id="S4.E10.m1.29.29.1.1.1.1.1.1.1.1.cmml" xref="S4.E10.m1.6.6.6.6.6.7.1">subscript</csymbol><apply id="S4.E10.m1.29.29.1.1.1.1.1.1.1.2.cmml" xref="S4.E10.m1.6.6.6.6.6.7.1"><csymbol cd="ambiguous" id="S4.E10.m1.29.29.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E10.m1.6.6.6.6.6.7.1">superscript</csymbol><ci id="S4.E10.m1.12.12.12.6.6.6.cmml" xref="S4.E10.m1.12.12.12.6.6.6">𝐞</ci><ci id="S4.E10.m1.13.13.13.7.7.7.1.cmml" xref="S4.E10.m1.13.13.13.7.7.7.1">cls</ci></apply><apply id="S4.E10.m1.14.14.14.8.8.8.1.cmml" xref="S4.E10.m1.14.14.14.8.8.8.1"><minus id="S4.E10.m1.14.14.14.8.8.8.1.1.cmml" xref="S4.E10.m1.14.14.14.8.8.8.1.1"></minus><ci id="S4.E10.m1.14.14.14.8.8.8.1.2.cmml" xref="S4.E10.m1.14.14.14.8.8.8.1.2">𝐿</ci><cn type="integer" id="S4.E10.m1.14.14.14.8.8.8.1.3.cmml" xref="S4.E10.m1.14.14.14.8.8.8.1.3">1</cn></apply></apply></apply><ci id="S4.E10.m1.16.16.16.10.10.10.cmml" xref="S4.E10.m1.16.16.16.10.10.10">and</ci><apply id="S4.E10.m1.29.29.1.1.1.1.4.cmml" xref="S4.E10.m1.6.6.6.6.6.7.1"><csymbol cd="ambiguous" id="S4.E10.m1.29.29.1.1.1.1.4.1.cmml" xref="S4.E10.m1.6.6.6.6.6.7.1">subscript</csymbol><ci id="S4.E10.m1.17.17.17.11.11.11.cmml" xref="S4.E10.m1.17.17.17.11.11.11">E</ci><ci id="S4.E10.m1.18.18.18.12.12.12.1.cmml" xref="S4.E10.m1.18.18.18.12.12.12.1">𝐾</ci></apply></apply></apply><apply id="S4.E10.m1.29.29.1.1.1e.cmml" xref="S4.E10.m1.6.6.6.6.6.7.1"><eq id="S4.E10.m1.19.19.19.13.13.13.cmml" xref="S4.E10.m1.19.19.19.13.13.13"></eq><share href="#S4.E10.m1.29.29.1.1.1.1.cmml" id="S4.E10.m1.29.29.1.1.1f.cmml" xref="S4.E10.m1.6.6.6.6.6.7.1"></share><list id="S4.E10.m1.29.29.1.1.1.3.3.cmml" xref="S4.E10.m1.6.6.6.6.6.7.1"><apply id="S4.E10.m1.29.29.1.1.1.2.1.1.cmml" xref="S4.E10.m1.6.6.6.6.6.7.1"><csymbol cd="ambiguous" id="S4.E10.m1.29.29.1.1.1.2.1.1.1.cmml" xref="S4.E10.m1.6.6.6.6.6.7.1">subscript</csymbol><apply id="S4.E10.m1.29.29.1.1.1.2.1.1.2.cmml" xref="S4.E10.m1.6.6.6.6.6.7.1"><csymbol cd="ambiguous" id="S4.E10.m1.29.29.1.1.1.2.1.1.2.1.cmml" xref="S4.E10.m1.6.6.6.6.6.7.1">superscript</csymbol><ci id="S4.E10.m1.21.21.21.15.15.15.cmml" xref="S4.E10.m1.21.21.21.15.15.15">𝐞</ci><ci id="S4.E10.m1.22.22.22.16.16.16.1.cmml" xref="S4.E10.m1.22.22.22.16.16.16.1">cls</ci></apply><apply id="S4.E10.m1.23.23.23.17.17.17.1.cmml" xref="S4.E10.m1.23.23.23.17.17.17.1"><minus id="S4.E10.m1.23.23.23.17.17.17.1.1.cmml" xref="S4.E10.m1.23.23.23.17.17.17.1.1"></minus><ci id="S4.E10.m1.23.23.23.17.17.17.1.2.cmml" xref="S4.E10.m1.23.23.23.17.17.17.1.2">𝐿</ci><cn type="integer" id="S4.E10.m1.23.23.23.17.17.17.1.3.cmml" xref="S4.E10.m1.23.23.23.17.17.17.1.3">1</cn></apply></apply><apply id="S4.E10.m1.29.29.1.1.1.3.2.2.cmml" xref="S4.E10.m1.6.6.6.6.6.7.1"><csymbol cd="ambiguous" id="S4.E10.m1.29.29.1.1.1.3.2.2.1.cmml" xref="S4.E10.m1.6.6.6.6.6.7.1">subscript</csymbol><ci id="S4.E10.m1.25.25.25.19.19.19.cmml" xref="S4.E10.m1.25.25.25.19.19.19">I</ci><apply id="S4.E10.m1.26.26.26.20.20.20.1.cmml" xref="S4.E10.m1.26.26.26.20.20.20.1"><minus id="S4.E10.m1.26.26.26.20.20.20.1.1.cmml" xref="S4.E10.m1.26.26.26.20.20.20.1.1"></minus><ci id="S4.E10.m1.26.26.26.20.20.20.1.2.cmml" xref="S4.E10.m1.26.26.26.20.20.20.1.2">L</ci><cn type="integer" id="S4.E10.m1.26.26.26.20.20.20.1.3.cmml" xref="S4.E10.m1.26.26.26.20.20.20.1.3">1</cn></apply></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E10.m1.30c">\begin{gathered}\!\!\!{\rm Attn}={\rm Softmax}\big{(}\frac{({\rm E}_{Q}{\rm W}_{Q})({\rm E}_{K}{\rm W}_{K})^{\top}}{\sqrt{d}}\big{)}\!\!\!\\
{\rm where}~{}~{}{\rm E}_{Q}=[{\bf e}^{\rm cls}_{L-1}]~{}~{}{\rm and}~{}~{}{\rm E}_{K}=[{\bf e}^{\rm cls}_{L-1};\rm{I}_{L-1}].\end{gathered}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
</table>
<p id="S4.SS2.SSS1.p2.10" class="ltx_p"><math id="S4.SS2.SSS1.p2.3.m1.1" class="ltx_Math" alttext="{\bf e}^{\rm cls}_{L-1}" display="inline"><semantics id="S4.SS2.SSS1.p2.3.m1.1a"><msubsup id="S4.SS2.SSS1.p2.3.m1.1.1" xref="S4.SS2.SSS1.p2.3.m1.1.1.cmml"><mi id="S4.SS2.SSS1.p2.3.m1.1.1.2.2" xref="S4.SS2.SSS1.p2.3.m1.1.1.2.2.cmml">𝐞</mi><mrow id="S4.SS2.SSS1.p2.3.m1.1.1.3" xref="S4.SS2.SSS1.p2.3.m1.1.1.3.cmml"><mi id="S4.SS2.SSS1.p2.3.m1.1.1.3.2" xref="S4.SS2.SSS1.p2.3.m1.1.1.3.2.cmml">L</mi><mo id="S4.SS2.SSS1.p2.3.m1.1.1.3.1" xref="S4.SS2.SSS1.p2.3.m1.1.1.3.1.cmml">−</mo><mn id="S4.SS2.SSS1.p2.3.m1.1.1.3.3" xref="S4.SS2.SSS1.p2.3.m1.1.1.3.3.cmml">1</mn></mrow><mi id="S4.SS2.SSS1.p2.3.m1.1.1.2.3" xref="S4.SS2.SSS1.p2.3.m1.1.1.2.3.cmml">cls</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p2.3.m1.1b"><apply id="S4.SS2.SSS1.p2.3.m1.1.1.cmml" xref="S4.SS2.SSS1.p2.3.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p2.3.m1.1.1.1.cmml" xref="S4.SS2.SSS1.p2.3.m1.1.1">subscript</csymbol><apply id="S4.SS2.SSS1.p2.3.m1.1.1.2.cmml" xref="S4.SS2.SSS1.p2.3.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p2.3.m1.1.1.2.1.cmml" xref="S4.SS2.SSS1.p2.3.m1.1.1">superscript</csymbol><ci id="S4.SS2.SSS1.p2.3.m1.1.1.2.2.cmml" xref="S4.SS2.SSS1.p2.3.m1.1.1.2.2">𝐞</ci><ci id="S4.SS2.SSS1.p2.3.m1.1.1.2.3.cmml" xref="S4.SS2.SSS1.p2.3.m1.1.1.2.3">cls</ci></apply><apply id="S4.SS2.SSS1.p2.3.m1.1.1.3.cmml" xref="S4.SS2.SSS1.p2.3.m1.1.1.3"><minus id="S4.SS2.SSS1.p2.3.m1.1.1.3.1.cmml" xref="S4.SS2.SSS1.p2.3.m1.1.1.3.1"></minus><ci id="S4.SS2.SSS1.p2.3.m1.1.1.3.2.cmml" xref="S4.SS2.SSS1.p2.3.m1.1.1.3.2">𝐿</ci><cn type="integer" id="S4.SS2.SSS1.p2.3.m1.1.1.3.3.cmml" xref="S4.SS2.SSS1.p2.3.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p2.3.m1.1c">{\bf e}^{\rm cls}_{L-1}</annotation></semantics></math> is the class token and <math id="S4.SS2.SSS1.p2.4.m2.1" class="ltx_Math" alttext="{\rm I}_{L-1}" display="inline"><semantics id="S4.SS2.SSS1.p2.4.m2.1a"><msub id="S4.SS2.SSS1.p2.4.m2.1.1" xref="S4.SS2.SSS1.p2.4.m2.1.1.cmml"><mi mathvariant="normal" id="S4.SS2.SSS1.p2.4.m2.1.1.2" xref="S4.SS2.SSS1.p2.4.m2.1.1.2.cmml">I</mi><mrow id="S4.SS2.SSS1.p2.4.m2.1.1.3" xref="S4.SS2.SSS1.p2.4.m2.1.1.3.cmml"><mi id="S4.SS2.SSS1.p2.4.m2.1.1.3.2" xref="S4.SS2.SSS1.p2.4.m2.1.1.3.2.cmml">L</mi><mo id="S4.SS2.SSS1.p2.4.m2.1.1.3.1" xref="S4.SS2.SSS1.p2.4.m2.1.1.3.1.cmml">−</mo><mn id="S4.SS2.SSS1.p2.4.m2.1.1.3.3" xref="S4.SS2.SSS1.p2.4.m2.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p2.4.m2.1b"><apply id="S4.SS2.SSS1.p2.4.m2.1.1.cmml" xref="S4.SS2.SSS1.p2.4.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p2.4.m2.1.1.1.cmml" xref="S4.SS2.SSS1.p2.4.m2.1.1">subscript</csymbol><ci id="S4.SS2.SSS1.p2.4.m2.1.1.2.cmml" xref="S4.SS2.SSS1.p2.4.m2.1.1.2">I</ci><apply id="S4.SS2.SSS1.p2.4.m2.1.1.3.cmml" xref="S4.SS2.SSS1.p2.4.m2.1.1.3"><minus id="S4.SS2.SSS1.p2.4.m2.1.1.3.1.cmml" xref="S4.SS2.SSS1.p2.4.m2.1.1.3.1"></minus><ci id="S4.SS2.SSS1.p2.4.m2.1.1.3.2.cmml" xref="S4.SS2.SSS1.p2.4.m2.1.1.3.2">𝐿</ci><cn type="integer" id="S4.SS2.SSS1.p2.4.m2.1.1.3.3.cmml" xref="S4.SS2.SSS1.p2.4.m2.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p2.4.m2.1c">{\rm I}_{L-1}</annotation></semantics></math> is the patch tokens from the (<math id="S4.SS2.SSS1.p2.5.m3.1" class="ltx_Math" alttext="L" display="inline"><semantics id="S4.SS2.SSS1.p2.5.m3.1a"><mi id="S4.SS2.SSS1.p2.5.m3.1.1" xref="S4.SS2.SSS1.p2.5.m3.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p2.5.m3.1b"><ci id="S4.SS2.SSS1.p2.5.m3.1.1.cmml" xref="S4.SS2.SSS1.p2.5.m3.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p2.5.m3.1c">L</annotation></semantics></math>-1)-th Transformer layer. Note that the query <math id="S4.SS2.SSS1.p2.6.m4.1" class="ltx_Math" alttext="{\rm E}_{Q}" display="inline"><semantics id="S4.SS2.SSS1.p2.6.m4.1a"><msub id="S4.SS2.SSS1.p2.6.m4.1.1" xref="S4.SS2.SSS1.p2.6.m4.1.1.cmml"><mi mathvariant="normal" id="S4.SS2.SSS1.p2.6.m4.1.1.2" xref="S4.SS2.SSS1.p2.6.m4.1.1.2.cmml">E</mi><mi id="S4.SS2.SSS1.p2.6.m4.1.1.3" xref="S4.SS2.SSS1.p2.6.m4.1.1.3.cmml">Q</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p2.6.m4.1b"><apply id="S4.SS2.SSS1.p2.6.m4.1.1.cmml" xref="S4.SS2.SSS1.p2.6.m4.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p2.6.m4.1.1.1.cmml" xref="S4.SS2.SSS1.p2.6.m4.1.1">subscript</csymbol><ci id="S4.SS2.SSS1.p2.6.m4.1.1.2.cmml" xref="S4.SS2.SSS1.p2.6.m4.1.1.2">E</ci><ci id="S4.SS2.SSS1.p2.6.m4.1.1.3.cmml" xref="S4.SS2.SSS1.p2.6.m4.1.1.3">𝑄</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p2.6.m4.1c">{\rm E}_{Q}</annotation></semantics></math> includes only the class token since the clip image embedding is the projection of the class token’s output <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite>. We convert this attention process to the RoI-based masked attention. As seen in Figure <a href="#S4.F3" title="Figure 3 ‣ 4.2 Ensemble with ViT-based CLIP ‣ 4 Prompt-OVD ‣ ​​Prompt-Guided Transformers for End-to-End Open-Vocabulary Object Detection​​" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>, we generate attention masks <math id="S4.SS2.SSS1.p2.7.m5.3" class="ltx_Math" alttext="{\rm M}_{\hat{\rm B}}=[{\rm M}_{{\bf b}_{1}},\dots,{\rm M}_{{\bf b}_{m}}]\in\mathbb{R}^{m\times hw}" display="inline"><semantics id="S4.SS2.SSS1.p2.7.m5.3a"><mrow id="S4.SS2.SSS1.p2.7.m5.3.3" xref="S4.SS2.SSS1.p2.7.m5.3.3.cmml"><msub id="S4.SS2.SSS1.p2.7.m5.3.3.4" xref="S4.SS2.SSS1.p2.7.m5.3.3.4.cmml"><mi mathvariant="normal" id="S4.SS2.SSS1.p2.7.m5.3.3.4.2" xref="S4.SS2.SSS1.p2.7.m5.3.3.4.2.cmml">M</mi><mover accent="true" id="S4.SS2.SSS1.p2.7.m5.3.3.4.3" xref="S4.SS2.SSS1.p2.7.m5.3.3.4.3.cmml"><mi mathvariant="normal" id="S4.SS2.SSS1.p2.7.m5.3.3.4.3.2" xref="S4.SS2.SSS1.p2.7.m5.3.3.4.3.2.cmml">B</mi><mo id="S4.SS2.SSS1.p2.7.m5.3.3.4.3.1" xref="S4.SS2.SSS1.p2.7.m5.3.3.4.3.1.cmml">^</mo></mover></msub><mo id="S4.SS2.SSS1.p2.7.m5.3.3.5" xref="S4.SS2.SSS1.p2.7.m5.3.3.5.cmml">=</mo><mrow id="S4.SS2.SSS1.p2.7.m5.3.3.2.2" xref="S4.SS2.SSS1.p2.7.m5.3.3.2.3.cmml"><mo stretchy="false" id="S4.SS2.SSS1.p2.7.m5.3.3.2.2.3" xref="S4.SS2.SSS1.p2.7.m5.3.3.2.3.cmml">[</mo><msub id="S4.SS2.SSS1.p2.7.m5.2.2.1.1.1" xref="S4.SS2.SSS1.p2.7.m5.2.2.1.1.1.cmml"><mi mathvariant="normal" id="S4.SS2.SSS1.p2.7.m5.2.2.1.1.1.2" xref="S4.SS2.SSS1.p2.7.m5.2.2.1.1.1.2.cmml">M</mi><msub id="S4.SS2.SSS1.p2.7.m5.2.2.1.1.1.3" xref="S4.SS2.SSS1.p2.7.m5.2.2.1.1.1.3.cmml"><mi id="S4.SS2.SSS1.p2.7.m5.2.2.1.1.1.3.2" xref="S4.SS2.SSS1.p2.7.m5.2.2.1.1.1.3.2.cmml">𝐛</mi><mn id="S4.SS2.SSS1.p2.7.m5.2.2.1.1.1.3.3" xref="S4.SS2.SSS1.p2.7.m5.2.2.1.1.1.3.3.cmml">1</mn></msub></msub><mo id="S4.SS2.SSS1.p2.7.m5.3.3.2.2.4" xref="S4.SS2.SSS1.p2.7.m5.3.3.2.3.cmml">,</mo><mi mathvariant="normal" id="S4.SS2.SSS1.p2.7.m5.1.1" xref="S4.SS2.SSS1.p2.7.m5.1.1.cmml">…</mi><mo id="S4.SS2.SSS1.p2.7.m5.3.3.2.2.5" xref="S4.SS2.SSS1.p2.7.m5.3.3.2.3.cmml">,</mo><msub id="S4.SS2.SSS1.p2.7.m5.3.3.2.2.2" xref="S4.SS2.SSS1.p2.7.m5.3.3.2.2.2.cmml"><mi mathvariant="normal" id="S4.SS2.SSS1.p2.7.m5.3.3.2.2.2.2" xref="S4.SS2.SSS1.p2.7.m5.3.3.2.2.2.2.cmml">M</mi><msub id="S4.SS2.SSS1.p2.7.m5.3.3.2.2.2.3" xref="S4.SS2.SSS1.p2.7.m5.3.3.2.2.2.3.cmml"><mi id="S4.SS2.SSS1.p2.7.m5.3.3.2.2.2.3.2" xref="S4.SS2.SSS1.p2.7.m5.3.3.2.2.2.3.2.cmml">𝐛</mi><mi id="S4.SS2.SSS1.p2.7.m5.3.3.2.2.2.3.3" xref="S4.SS2.SSS1.p2.7.m5.3.3.2.2.2.3.3.cmml">m</mi></msub></msub><mo stretchy="false" id="S4.SS2.SSS1.p2.7.m5.3.3.2.2.6" xref="S4.SS2.SSS1.p2.7.m5.3.3.2.3.cmml">]</mo></mrow><mo id="S4.SS2.SSS1.p2.7.m5.3.3.6" xref="S4.SS2.SSS1.p2.7.m5.3.3.6.cmml">∈</mo><msup id="S4.SS2.SSS1.p2.7.m5.3.3.7" xref="S4.SS2.SSS1.p2.7.m5.3.3.7.cmml"><mi id="S4.SS2.SSS1.p2.7.m5.3.3.7.2" xref="S4.SS2.SSS1.p2.7.m5.3.3.7.2.cmml">ℝ</mi><mrow id="S4.SS2.SSS1.p2.7.m5.3.3.7.3" xref="S4.SS2.SSS1.p2.7.m5.3.3.7.3.cmml"><mrow id="S4.SS2.SSS1.p2.7.m5.3.3.7.3.2" xref="S4.SS2.SSS1.p2.7.m5.3.3.7.3.2.cmml"><mi id="S4.SS2.SSS1.p2.7.m5.3.3.7.3.2.2" xref="S4.SS2.SSS1.p2.7.m5.3.3.7.3.2.2.cmml">m</mi><mo lspace="0.222em" rspace="0.222em" id="S4.SS2.SSS1.p2.7.m5.3.3.7.3.2.1" xref="S4.SS2.SSS1.p2.7.m5.3.3.7.3.2.1.cmml">×</mo><mi id="S4.SS2.SSS1.p2.7.m5.3.3.7.3.2.3" xref="S4.SS2.SSS1.p2.7.m5.3.3.7.3.2.3.cmml">h</mi></mrow><mo lspace="0em" rspace="0em" id="S4.SS2.SSS1.p2.7.m5.3.3.7.3.1" xref="S4.SS2.SSS1.p2.7.m5.3.3.7.3.1.cmml">​</mo><mi id="S4.SS2.SSS1.p2.7.m5.3.3.7.3.3" xref="S4.SS2.SSS1.p2.7.m5.3.3.7.3.3.cmml">w</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p2.7.m5.3b"><apply id="S4.SS2.SSS1.p2.7.m5.3.3.cmml" xref="S4.SS2.SSS1.p2.7.m5.3.3"><and id="S4.SS2.SSS1.p2.7.m5.3.3a.cmml" xref="S4.SS2.SSS1.p2.7.m5.3.3"></and><apply id="S4.SS2.SSS1.p2.7.m5.3.3b.cmml" xref="S4.SS2.SSS1.p2.7.m5.3.3"><eq id="S4.SS2.SSS1.p2.7.m5.3.3.5.cmml" xref="S4.SS2.SSS1.p2.7.m5.3.3.5"></eq><apply id="S4.SS2.SSS1.p2.7.m5.3.3.4.cmml" xref="S4.SS2.SSS1.p2.7.m5.3.3.4"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p2.7.m5.3.3.4.1.cmml" xref="S4.SS2.SSS1.p2.7.m5.3.3.4">subscript</csymbol><ci id="S4.SS2.SSS1.p2.7.m5.3.3.4.2.cmml" xref="S4.SS2.SSS1.p2.7.m5.3.3.4.2">M</ci><apply id="S4.SS2.SSS1.p2.7.m5.3.3.4.3.cmml" xref="S4.SS2.SSS1.p2.7.m5.3.3.4.3"><ci id="S4.SS2.SSS1.p2.7.m5.3.3.4.3.1.cmml" xref="S4.SS2.SSS1.p2.7.m5.3.3.4.3.1">^</ci><ci id="S4.SS2.SSS1.p2.7.m5.3.3.4.3.2.cmml" xref="S4.SS2.SSS1.p2.7.m5.3.3.4.3.2">B</ci></apply></apply><list id="S4.SS2.SSS1.p2.7.m5.3.3.2.3.cmml" xref="S4.SS2.SSS1.p2.7.m5.3.3.2.2"><apply id="S4.SS2.SSS1.p2.7.m5.2.2.1.1.1.cmml" xref="S4.SS2.SSS1.p2.7.m5.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p2.7.m5.2.2.1.1.1.1.cmml" xref="S4.SS2.SSS1.p2.7.m5.2.2.1.1.1">subscript</csymbol><ci id="S4.SS2.SSS1.p2.7.m5.2.2.1.1.1.2.cmml" xref="S4.SS2.SSS1.p2.7.m5.2.2.1.1.1.2">M</ci><apply id="S4.SS2.SSS1.p2.7.m5.2.2.1.1.1.3.cmml" xref="S4.SS2.SSS1.p2.7.m5.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p2.7.m5.2.2.1.1.1.3.1.cmml" xref="S4.SS2.SSS1.p2.7.m5.2.2.1.1.1.3">subscript</csymbol><ci id="S4.SS2.SSS1.p2.7.m5.2.2.1.1.1.3.2.cmml" xref="S4.SS2.SSS1.p2.7.m5.2.2.1.1.1.3.2">𝐛</ci><cn type="integer" id="S4.SS2.SSS1.p2.7.m5.2.2.1.1.1.3.3.cmml" xref="S4.SS2.SSS1.p2.7.m5.2.2.1.1.1.3.3">1</cn></apply></apply><ci id="S4.SS2.SSS1.p2.7.m5.1.1.cmml" xref="S4.SS2.SSS1.p2.7.m5.1.1">…</ci><apply id="S4.SS2.SSS1.p2.7.m5.3.3.2.2.2.cmml" xref="S4.SS2.SSS1.p2.7.m5.3.3.2.2.2"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p2.7.m5.3.3.2.2.2.1.cmml" xref="S4.SS2.SSS1.p2.7.m5.3.3.2.2.2">subscript</csymbol><ci id="S4.SS2.SSS1.p2.7.m5.3.3.2.2.2.2.cmml" xref="S4.SS2.SSS1.p2.7.m5.3.3.2.2.2.2">M</ci><apply id="S4.SS2.SSS1.p2.7.m5.3.3.2.2.2.3.cmml" xref="S4.SS2.SSS1.p2.7.m5.3.3.2.2.2.3"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p2.7.m5.3.3.2.2.2.3.1.cmml" xref="S4.SS2.SSS1.p2.7.m5.3.3.2.2.2.3">subscript</csymbol><ci id="S4.SS2.SSS1.p2.7.m5.3.3.2.2.2.3.2.cmml" xref="S4.SS2.SSS1.p2.7.m5.3.3.2.2.2.3.2">𝐛</ci><ci id="S4.SS2.SSS1.p2.7.m5.3.3.2.2.2.3.3.cmml" xref="S4.SS2.SSS1.p2.7.m5.3.3.2.2.2.3.3">𝑚</ci></apply></apply></list></apply><apply id="S4.SS2.SSS1.p2.7.m5.3.3c.cmml" xref="S4.SS2.SSS1.p2.7.m5.3.3"><in id="S4.SS2.SSS1.p2.7.m5.3.3.6.cmml" xref="S4.SS2.SSS1.p2.7.m5.3.3.6"></in><share href="#S4.SS2.SSS1.p2.7.m5.3.3.2.cmml" id="S4.SS2.SSS1.p2.7.m5.3.3d.cmml" xref="S4.SS2.SSS1.p2.7.m5.3.3"></share><apply id="S4.SS2.SSS1.p2.7.m5.3.3.7.cmml" xref="S4.SS2.SSS1.p2.7.m5.3.3.7"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p2.7.m5.3.3.7.1.cmml" xref="S4.SS2.SSS1.p2.7.m5.3.3.7">superscript</csymbol><ci id="S4.SS2.SSS1.p2.7.m5.3.3.7.2.cmml" xref="S4.SS2.SSS1.p2.7.m5.3.3.7.2">ℝ</ci><apply id="S4.SS2.SSS1.p2.7.m5.3.3.7.3.cmml" xref="S4.SS2.SSS1.p2.7.m5.3.3.7.3"><times id="S4.SS2.SSS1.p2.7.m5.3.3.7.3.1.cmml" xref="S4.SS2.SSS1.p2.7.m5.3.3.7.3.1"></times><apply id="S4.SS2.SSS1.p2.7.m5.3.3.7.3.2.cmml" xref="S4.SS2.SSS1.p2.7.m5.3.3.7.3.2"><times id="S4.SS2.SSS1.p2.7.m5.3.3.7.3.2.1.cmml" xref="S4.SS2.SSS1.p2.7.m5.3.3.7.3.2.1"></times><ci id="S4.SS2.SSS1.p2.7.m5.3.3.7.3.2.2.cmml" xref="S4.SS2.SSS1.p2.7.m5.3.3.7.3.2.2">𝑚</ci><ci id="S4.SS2.SSS1.p2.7.m5.3.3.7.3.2.3.cmml" xref="S4.SS2.SSS1.p2.7.m5.3.3.7.3.2.3">ℎ</ci></apply><ci id="S4.SS2.SSS1.p2.7.m5.3.3.7.3.3.cmml" xref="S4.SS2.SSS1.p2.7.m5.3.3.7.3.3">𝑤</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p2.7.m5.3c">{\rm M}_{\hat{\rm B}}=[{\rm M}_{{\bf b}_{1}},\dots,{\rm M}_{{\bf b}_{m}}]\in\mathbb{R}^{m\times hw}</annotation></semantics></math>; <math id="S4.SS2.SSS1.p2.8.m6.1" class="ltx_Math" alttext="{\rm M}_{{\bf b}_{i}}" display="inline"><semantics id="S4.SS2.SSS1.p2.8.m6.1a"><msub id="S4.SS2.SSS1.p2.8.m6.1.1" xref="S4.SS2.SSS1.p2.8.m6.1.1.cmml"><mi mathvariant="normal" id="S4.SS2.SSS1.p2.8.m6.1.1.2" xref="S4.SS2.SSS1.p2.8.m6.1.1.2.cmml">M</mi><msub id="S4.SS2.SSS1.p2.8.m6.1.1.3" xref="S4.SS2.SSS1.p2.8.m6.1.1.3.cmml"><mi id="S4.SS2.SSS1.p2.8.m6.1.1.3.2" xref="S4.SS2.SSS1.p2.8.m6.1.1.3.2.cmml">𝐛</mi><mi id="S4.SS2.SSS1.p2.8.m6.1.1.3.3" xref="S4.SS2.SSS1.p2.8.m6.1.1.3.3.cmml">i</mi></msub></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p2.8.m6.1b"><apply id="S4.SS2.SSS1.p2.8.m6.1.1.cmml" xref="S4.SS2.SSS1.p2.8.m6.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p2.8.m6.1.1.1.cmml" xref="S4.SS2.SSS1.p2.8.m6.1.1">subscript</csymbol><ci id="S4.SS2.SSS1.p2.8.m6.1.1.2.cmml" xref="S4.SS2.SSS1.p2.8.m6.1.1.2">M</ci><apply id="S4.SS2.SSS1.p2.8.m6.1.1.3.cmml" xref="S4.SS2.SSS1.p2.8.m6.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p2.8.m6.1.1.3.1.cmml" xref="S4.SS2.SSS1.p2.8.m6.1.1.3">subscript</csymbol><ci id="S4.SS2.SSS1.p2.8.m6.1.1.3.2.cmml" xref="S4.SS2.SSS1.p2.8.m6.1.1.3.2">𝐛</ci><ci id="S4.SS2.SSS1.p2.8.m6.1.1.3.3.cmml" xref="S4.SS2.SSS1.p2.8.m6.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p2.8.m6.1c">{\rm M}_{{\bf b}_{i}}</annotation></semantics></math> has the <math id="S4.SS2.SSS1.p2.9.m7.1" class="ltx_Math" alttext="0" display="inline"><semantics id="S4.SS2.SSS1.p2.9.m7.1a"><mn id="S4.SS2.SSS1.p2.9.m7.1.1" xref="S4.SS2.SSS1.p2.9.m7.1.1.cmml">0</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p2.9.m7.1b"><cn type="integer" id="S4.SS2.SSS1.p2.9.m7.1.1.cmml" xref="S4.SS2.SSS1.p2.9.m7.1.1">0</cn></annotation-xml></semantics></math> values for the area that overlaps the given RoI <math id="S4.SS2.SSS1.p2.10.m8.1" class="ltx_Math" alttext="{\bf b}_{i}" display="inline"><semantics id="S4.SS2.SSS1.p2.10.m8.1a"><msub id="S4.SS2.SSS1.p2.10.m8.1.1" xref="S4.SS2.SSS1.p2.10.m8.1.1.cmml"><mi id="S4.SS2.SSS1.p2.10.m8.1.1.2" xref="S4.SS2.SSS1.p2.10.m8.1.1.2.cmml">𝐛</mi><mi id="S4.SS2.SSS1.p2.10.m8.1.1.3" xref="S4.SS2.SSS1.p2.10.m8.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p2.10.m8.1b"><apply id="S4.SS2.SSS1.p2.10.m8.1.1.cmml" xref="S4.SS2.SSS1.p2.10.m8.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p2.10.m8.1.1.1.cmml" xref="S4.SS2.SSS1.p2.10.m8.1.1">subscript</csymbol><ci id="S4.SS2.SSS1.p2.10.m8.1.1.2.cmml" xref="S4.SS2.SSS1.p2.10.m8.1.1.2">𝐛</ci><ci id="S4.SS2.SSS1.p2.10.m8.1.1.3.cmml" xref="S4.SS2.SSS1.p2.10.m8.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p2.10.m8.1c">{\bf b}_{i}</annotation></semantics></math>, -100 otherwise. Each mask penalizes the patch tokens outside the corresponding RoI not to affect the attention operation as:</p>
<table id="S4.E11" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E11.m1.3" class="ltx_Math" alttext="{\rm Softmax}\big{(}\frac{({\rm E}_{Q}{\rm W}_{Q})({\rm E}_{K}{\rm W}_{K})^{\top}\!\!+{\rm M}_{{\bf b}_{i}}}{\sqrt{d}}\big{)}." display="block"><semantics id="S4.E11.m1.3a"><mrow id="S4.E11.m1.3.3.1" xref="S4.E11.m1.3.3.1.1.cmml"><mrow id="S4.E11.m1.3.3.1.1" xref="S4.E11.m1.3.3.1.1.cmml"><mi id="S4.E11.m1.3.3.1.1.2" xref="S4.E11.m1.3.3.1.1.2.cmml">Softmax</mi><mo lspace="0em" rspace="0em" id="S4.E11.m1.3.3.1.1.1" xref="S4.E11.m1.3.3.1.1.1.cmml">​</mo><mrow id="S4.E11.m1.3.3.1.1.3.2" xref="S4.E11.m1.2.2.cmml"><mo maxsize="120%" minsize="120%" id="S4.E11.m1.3.3.1.1.3.2.1" xref="S4.E11.m1.2.2.cmml">(</mo><mfrac id="S4.E11.m1.2.2" xref="S4.E11.m1.2.2.cmml"><mrow id="S4.E11.m1.2.2.2" xref="S4.E11.m1.2.2.2.cmml"><mrow id="S4.E11.m1.2.2.2.2" xref="S4.E11.m1.2.2.2.2.cmml"><mrow id="S4.E11.m1.1.1.1.1.1.1" xref="S4.E11.m1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E11.m1.1.1.1.1.1.1.2" xref="S4.E11.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E11.m1.1.1.1.1.1.1.1" xref="S4.E11.m1.1.1.1.1.1.1.1.cmml"><msub id="S4.E11.m1.1.1.1.1.1.1.1.2" xref="S4.E11.m1.1.1.1.1.1.1.1.2.cmml"><mi mathvariant="normal" id="S4.E11.m1.1.1.1.1.1.1.1.2.2" xref="S4.E11.m1.1.1.1.1.1.1.1.2.2.cmml">E</mi><mi id="S4.E11.m1.1.1.1.1.1.1.1.2.3" xref="S4.E11.m1.1.1.1.1.1.1.1.2.3.cmml">Q</mi></msub><mo lspace="0em" rspace="0em" id="S4.E11.m1.1.1.1.1.1.1.1.1" xref="S4.E11.m1.1.1.1.1.1.1.1.1.cmml">​</mo><msub id="S4.E11.m1.1.1.1.1.1.1.1.3" xref="S4.E11.m1.1.1.1.1.1.1.1.3.cmml"><mi mathvariant="normal" id="S4.E11.m1.1.1.1.1.1.1.1.3.2" xref="S4.E11.m1.1.1.1.1.1.1.1.3.2.cmml">W</mi><mi id="S4.E11.m1.1.1.1.1.1.1.1.3.3" xref="S4.E11.m1.1.1.1.1.1.1.1.3.3.cmml">Q</mi></msub></mrow><mo stretchy="false" id="S4.E11.m1.1.1.1.1.1.1.3" xref="S4.E11.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S4.E11.m1.2.2.2.2.3" xref="S4.E11.m1.2.2.2.2.3.cmml">​</mo><msup id="S4.E11.m1.2.2.2.2.2" xref="S4.E11.m1.2.2.2.2.2.cmml"><mrow id="S4.E11.m1.2.2.2.2.2.1.1" xref="S4.E11.m1.2.2.2.2.2.1.1.1.cmml"><mo stretchy="false" id="S4.E11.m1.2.2.2.2.2.1.1.2" xref="S4.E11.m1.2.2.2.2.2.1.1.1.cmml">(</mo><mrow id="S4.E11.m1.2.2.2.2.2.1.1.1" xref="S4.E11.m1.2.2.2.2.2.1.1.1.cmml"><msub id="S4.E11.m1.2.2.2.2.2.1.1.1.2" xref="S4.E11.m1.2.2.2.2.2.1.1.1.2.cmml"><mi mathvariant="normal" id="S4.E11.m1.2.2.2.2.2.1.1.1.2.2" xref="S4.E11.m1.2.2.2.2.2.1.1.1.2.2.cmml">E</mi><mi id="S4.E11.m1.2.2.2.2.2.1.1.1.2.3" xref="S4.E11.m1.2.2.2.2.2.1.1.1.2.3.cmml">K</mi></msub><mo lspace="0em" rspace="0em" id="S4.E11.m1.2.2.2.2.2.1.1.1.1" xref="S4.E11.m1.2.2.2.2.2.1.1.1.1.cmml">​</mo><msub id="S4.E11.m1.2.2.2.2.2.1.1.1.3" xref="S4.E11.m1.2.2.2.2.2.1.1.1.3.cmml"><mi mathvariant="normal" id="S4.E11.m1.2.2.2.2.2.1.1.1.3.2" xref="S4.E11.m1.2.2.2.2.2.1.1.1.3.2.cmml">W</mi><mi id="S4.E11.m1.2.2.2.2.2.1.1.1.3.3" xref="S4.E11.m1.2.2.2.2.2.1.1.1.3.3.cmml">K</mi></msub></mrow><mo stretchy="false" id="S4.E11.m1.2.2.2.2.2.1.1.3" xref="S4.E11.m1.2.2.2.2.2.1.1.1.cmml">)</mo></mrow><mo id="S4.E11.m1.2.2.2.2.2.3" xref="S4.E11.m1.2.2.2.2.2.3.cmml">⊤</mo></msup></mrow><mo id="S4.E11.m1.2.2.2.3" xref="S4.E11.m1.2.2.2.3.cmml">+</mo><msub id="S4.E11.m1.2.2.2.4" xref="S4.E11.m1.2.2.2.4.cmml"><mi mathvariant="normal" id="S4.E11.m1.2.2.2.4.2" xref="S4.E11.m1.2.2.2.4.2.cmml">M</mi><msub id="S4.E11.m1.2.2.2.4.3" xref="S4.E11.m1.2.2.2.4.3.cmml"><mi id="S4.E11.m1.2.2.2.4.3.2" xref="S4.E11.m1.2.2.2.4.3.2.cmml">𝐛</mi><mi id="S4.E11.m1.2.2.2.4.3.3" xref="S4.E11.m1.2.2.2.4.3.3.cmml">i</mi></msub></msub></mrow><msqrt id="S4.E11.m1.2.2.4" xref="S4.E11.m1.2.2.4.cmml"><mi id="S4.E11.m1.2.2.4.2" xref="S4.E11.m1.2.2.4.2.cmml">d</mi></msqrt></mfrac><mo maxsize="120%" minsize="120%" id="S4.E11.m1.3.3.1.1.3.2.2" xref="S4.E11.m1.2.2.cmml">)</mo></mrow></mrow><mo lspace="0em" id="S4.E11.m1.3.3.1.2" xref="S4.E11.m1.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E11.m1.3b"><apply id="S4.E11.m1.3.3.1.1.cmml" xref="S4.E11.m1.3.3.1"><times id="S4.E11.m1.3.3.1.1.1.cmml" xref="S4.E11.m1.3.3.1.1.1"></times><ci id="S4.E11.m1.3.3.1.1.2.cmml" xref="S4.E11.m1.3.3.1.1.2">Softmax</ci><apply id="S4.E11.m1.2.2.cmml" xref="S4.E11.m1.3.3.1.1.3.2"><divide id="S4.E11.m1.2.2.3.cmml" xref="S4.E11.m1.3.3.1.1.3.2"></divide><apply id="S4.E11.m1.2.2.2.cmml" xref="S4.E11.m1.2.2.2"><plus id="S4.E11.m1.2.2.2.3.cmml" xref="S4.E11.m1.2.2.2.3"></plus><apply id="S4.E11.m1.2.2.2.2.cmml" xref="S4.E11.m1.2.2.2.2"><times id="S4.E11.m1.2.2.2.2.3.cmml" xref="S4.E11.m1.2.2.2.2.3"></times><apply id="S4.E11.m1.1.1.1.1.1.1.1.cmml" xref="S4.E11.m1.1.1.1.1.1.1"><times id="S4.E11.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.E11.m1.1.1.1.1.1.1.1.1"></times><apply id="S4.E11.m1.1.1.1.1.1.1.1.2.cmml" xref="S4.E11.m1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E11.m1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E11.m1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S4.E11.m1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E11.m1.1.1.1.1.1.1.1.2.2">E</ci><ci id="S4.E11.m1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E11.m1.1.1.1.1.1.1.1.2.3">𝑄</ci></apply><apply id="S4.E11.m1.1.1.1.1.1.1.1.3.cmml" xref="S4.E11.m1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E11.m1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E11.m1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E11.m1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E11.m1.1.1.1.1.1.1.1.3.2">W</ci><ci id="S4.E11.m1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E11.m1.1.1.1.1.1.1.1.3.3">𝑄</ci></apply></apply><apply id="S4.E11.m1.2.2.2.2.2.cmml" xref="S4.E11.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.E11.m1.2.2.2.2.2.2.cmml" xref="S4.E11.m1.2.2.2.2.2">superscript</csymbol><apply id="S4.E11.m1.2.2.2.2.2.1.1.1.cmml" xref="S4.E11.m1.2.2.2.2.2.1.1"><times id="S4.E11.m1.2.2.2.2.2.1.1.1.1.cmml" xref="S4.E11.m1.2.2.2.2.2.1.1.1.1"></times><apply id="S4.E11.m1.2.2.2.2.2.1.1.1.2.cmml" xref="S4.E11.m1.2.2.2.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S4.E11.m1.2.2.2.2.2.1.1.1.2.1.cmml" xref="S4.E11.m1.2.2.2.2.2.1.1.1.2">subscript</csymbol><ci id="S4.E11.m1.2.2.2.2.2.1.1.1.2.2.cmml" xref="S4.E11.m1.2.2.2.2.2.1.1.1.2.2">E</ci><ci id="S4.E11.m1.2.2.2.2.2.1.1.1.2.3.cmml" xref="S4.E11.m1.2.2.2.2.2.1.1.1.2.3">𝐾</ci></apply><apply id="S4.E11.m1.2.2.2.2.2.1.1.1.3.cmml" xref="S4.E11.m1.2.2.2.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S4.E11.m1.2.2.2.2.2.1.1.1.3.1.cmml" xref="S4.E11.m1.2.2.2.2.2.1.1.1.3">subscript</csymbol><ci id="S4.E11.m1.2.2.2.2.2.1.1.1.3.2.cmml" xref="S4.E11.m1.2.2.2.2.2.1.1.1.3.2">W</ci><ci id="S4.E11.m1.2.2.2.2.2.1.1.1.3.3.cmml" xref="S4.E11.m1.2.2.2.2.2.1.1.1.3.3">𝐾</ci></apply></apply><csymbol cd="latexml" id="S4.E11.m1.2.2.2.2.2.3.cmml" xref="S4.E11.m1.2.2.2.2.2.3">top</csymbol></apply></apply><apply id="S4.E11.m1.2.2.2.4.cmml" xref="S4.E11.m1.2.2.2.4"><csymbol cd="ambiguous" id="S4.E11.m1.2.2.2.4.1.cmml" xref="S4.E11.m1.2.2.2.4">subscript</csymbol><ci id="S4.E11.m1.2.2.2.4.2.cmml" xref="S4.E11.m1.2.2.2.4.2">M</ci><apply id="S4.E11.m1.2.2.2.4.3.cmml" xref="S4.E11.m1.2.2.2.4.3"><csymbol cd="ambiguous" id="S4.E11.m1.2.2.2.4.3.1.cmml" xref="S4.E11.m1.2.2.2.4.3">subscript</csymbol><ci id="S4.E11.m1.2.2.2.4.3.2.cmml" xref="S4.E11.m1.2.2.2.4.3.2">𝐛</ci><ci id="S4.E11.m1.2.2.2.4.3.3.cmml" xref="S4.E11.m1.2.2.2.4.3.3">𝑖</ci></apply></apply></apply><apply id="S4.E11.m1.2.2.4.cmml" xref="S4.E11.m1.2.2.4"><root id="S4.E11.m1.2.2.4a.cmml" xref="S4.E11.m1.2.2.4"></root><ci id="S4.E11.m1.2.2.4.2.cmml" xref="S4.E11.m1.2.2.4.2">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E11.m1.3c">{\rm Softmax}\big{(}\frac{({\rm E}_{Q}{\rm W}_{Q})({\rm E}_{K}{\rm W}_{K})^{\top}\!\!+{\rm M}_{{\bf b}_{i}}}{\sqrt{d}}\big{)}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(11)</span></td>
</tr></tbody>
</table>
<p id="S4.SS2.SSS1.p2.11" class="ltx_p">This eliminate the need of iterative inference over all RoIs by simply applying the proposed RoI-based masked attention in the last Transformer layer. Thus, the inference on the image is now modified from Eq. (<a href="#S4.E7" title="In 4.2 Ensemble with ViT-based CLIP ‣ 4 Prompt-OVD ‣ ​​Prompt-Guided Transformers for End-to-End Open-Vocabulary Object Detection​​" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a>) to:</p>
<table id="S4.E12" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E12.m1.3" class="ltx_Math" alttext="[{\bf e}^{\rm img}_{i},\dots,{\bf e}^{\rm img}_{m}]={\rm CLIP}_{\rm img}({\bf x},\hat{\rm B}_{\rm det})\in\mathbb{R}^{m\times d^{\prime}}." display="block"><semantics id="S4.E12.m1.3a"><mrow id="S4.E12.m1.3.3.1" xref="S4.E12.m1.3.3.1.1.cmml"><mrow id="S4.E12.m1.3.3.1.1" xref="S4.E12.m1.3.3.1.1.cmml"><mrow id="S4.E12.m1.3.3.1.1.2.2" xref="S4.E12.m1.3.3.1.1.2.3.cmml"><mo stretchy="false" id="S4.E12.m1.3.3.1.1.2.2.3" xref="S4.E12.m1.3.3.1.1.2.3.cmml">[</mo><msubsup id="S4.E12.m1.3.3.1.1.1.1.1" xref="S4.E12.m1.3.3.1.1.1.1.1.cmml"><mi id="S4.E12.m1.3.3.1.1.1.1.1.2.2" xref="S4.E12.m1.3.3.1.1.1.1.1.2.2.cmml">𝐞</mi><mi id="S4.E12.m1.3.3.1.1.1.1.1.3" xref="S4.E12.m1.3.3.1.1.1.1.1.3.cmml">i</mi><mi id="S4.E12.m1.3.3.1.1.1.1.1.2.3" xref="S4.E12.m1.3.3.1.1.1.1.1.2.3.cmml">img</mi></msubsup><mo id="S4.E12.m1.3.3.1.1.2.2.4" xref="S4.E12.m1.3.3.1.1.2.3.cmml">,</mo><mi mathvariant="normal" id="S4.E12.m1.1.1" xref="S4.E12.m1.1.1.cmml">…</mi><mo id="S4.E12.m1.3.3.1.1.2.2.5" xref="S4.E12.m1.3.3.1.1.2.3.cmml">,</mo><msubsup id="S4.E12.m1.3.3.1.1.2.2.2" xref="S4.E12.m1.3.3.1.1.2.2.2.cmml"><mi id="S4.E12.m1.3.3.1.1.2.2.2.2.2" xref="S4.E12.m1.3.3.1.1.2.2.2.2.2.cmml">𝐞</mi><mi id="S4.E12.m1.3.3.1.1.2.2.2.3" xref="S4.E12.m1.3.3.1.1.2.2.2.3.cmml">m</mi><mi id="S4.E12.m1.3.3.1.1.2.2.2.2.3" xref="S4.E12.m1.3.3.1.1.2.2.2.2.3.cmml">img</mi></msubsup><mo stretchy="false" id="S4.E12.m1.3.3.1.1.2.2.6" xref="S4.E12.m1.3.3.1.1.2.3.cmml">]</mo></mrow><mo id="S4.E12.m1.3.3.1.1.5" xref="S4.E12.m1.3.3.1.1.5.cmml">=</mo><mrow id="S4.E12.m1.3.3.1.1.3" xref="S4.E12.m1.3.3.1.1.3.cmml"><msub id="S4.E12.m1.3.3.1.1.3.3" xref="S4.E12.m1.3.3.1.1.3.3.cmml"><mi id="S4.E12.m1.3.3.1.1.3.3.2" xref="S4.E12.m1.3.3.1.1.3.3.2.cmml">CLIP</mi><mi id="S4.E12.m1.3.3.1.1.3.3.3" xref="S4.E12.m1.3.3.1.1.3.3.3.cmml">img</mi></msub><mo lspace="0em" rspace="0em" id="S4.E12.m1.3.3.1.1.3.2" xref="S4.E12.m1.3.3.1.1.3.2.cmml">​</mo><mrow id="S4.E12.m1.3.3.1.1.3.1.1" xref="S4.E12.m1.3.3.1.1.3.1.2.cmml"><mo stretchy="false" id="S4.E12.m1.3.3.1.1.3.1.1.2" xref="S4.E12.m1.3.3.1.1.3.1.2.cmml">(</mo><mi id="S4.E12.m1.2.2" xref="S4.E12.m1.2.2.cmml">𝐱</mi><mo id="S4.E12.m1.3.3.1.1.3.1.1.3" xref="S4.E12.m1.3.3.1.1.3.1.2.cmml">,</mo><msub id="S4.E12.m1.3.3.1.1.3.1.1.1" xref="S4.E12.m1.3.3.1.1.3.1.1.1.cmml"><mover accent="true" id="S4.E12.m1.3.3.1.1.3.1.1.1.2" xref="S4.E12.m1.3.3.1.1.3.1.1.1.2.cmml"><mi mathvariant="normal" id="S4.E12.m1.3.3.1.1.3.1.1.1.2.2" xref="S4.E12.m1.3.3.1.1.3.1.1.1.2.2.cmml">B</mi><mo id="S4.E12.m1.3.3.1.1.3.1.1.1.2.1" xref="S4.E12.m1.3.3.1.1.3.1.1.1.2.1.cmml">^</mo></mover><mi id="S4.E12.m1.3.3.1.1.3.1.1.1.3" xref="S4.E12.m1.3.3.1.1.3.1.1.1.3.cmml">det</mi></msub><mo stretchy="false" id="S4.E12.m1.3.3.1.1.3.1.1.4" xref="S4.E12.m1.3.3.1.1.3.1.2.cmml">)</mo></mrow></mrow><mo id="S4.E12.m1.3.3.1.1.6" xref="S4.E12.m1.3.3.1.1.6.cmml">∈</mo><msup id="S4.E12.m1.3.3.1.1.7" xref="S4.E12.m1.3.3.1.1.7.cmml"><mi id="S4.E12.m1.3.3.1.1.7.2" xref="S4.E12.m1.3.3.1.1.7.2.cmml">ℝ</mi><mrow id="S4.E12.m1.3.3.1.1.7.3" xref="S4.E12.m1.3.3.1.1.7.3.cmml"><mi id="S4.E12.m1.3.3.1.1.7.3.2" xref="S4.E12.m1.3.3.1.1.7.3.2.cmml">m</mi><mo lspace="0.222em" rspace="0.222em" id="S4.E12.m1.3.3.1.1.7.3.1" xref="S4.E12.m1.3.3.1.1.7.3.1.cmml">×</mo><msup id="S4.E12.m1.3.3.1.1.7.3.3" xref="S4.E12.m1.3.3.1.1.7.3.3.cmml"><mi id="S4.E12.m1.3.3.1.1.7.3.3.2" xref="S4.E12.m1.3.3.1.1.7.3.3.2.cmml">d</mi><mo id="S4.E12.m1.3.3.1.1.7.3.3.3" xref="S4.E12.m1.3.3.1.1.7.3.3.3.cmml">′</mo></msup></mrow></msup></mrow><mo lspace="0em" id="S4.E12.m1.3.3.1.2" xref="S4.E12.m1.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E12.m1.3b"><apply id="S4.E12.m1.3.3.1.1.cmml" xref="S4.E12.m1.3.3.1"><and id="S4.E12.m1.3.3.1.1a.cmml" xref="S4.E12.m1.3.3.1"></and><apply id="S4.E12.m1.3.3.1.1b.cmml" xref="S4.E12.m1.3.3.1"><eq id="S4.E12.m1.3.3.1.1.5.cmml" xref="S4.E12.m1.3.3.1.1.5"></eq><list id="S4.E12.m1.3.3.1.1.2.3.cmml" xref="S4.E12.m1.3.3.1.1.2.2"><apply id="S4.E12.m1.3.3.1.1.1.1.1.cmml" xref="S4.E12.m1.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E12.m1.3.3.1.1.1.1.1.1.cmml" xref="S4.E12.m1.3.3.1.1.1.1.1">subscript</csymbol><apply id="S4.E12.m1.3.3.1.1.1.1.1.2.cmml" xref="S4.E12.m1.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E12.m1.3.3.1.1.1.1.1.2.1.cmml" xref="S4.E12.m1.3.3.1.1.1.1.1">superscript</csymbol><ci id="S4.E12.m1.3.3.1.1.1.1.1.2.2.cmml" xref="S4.E12.m1.3.3.1.1.1.1.1.2.2">𝐞</ci><ci id="S4.E12.m1.3.3.1.1.1.1.1.2.3.cmml" xref="S4.E12.m1.3.3.1.1.1.1.1.2.3">img</ci></apply><ci id="S4.E12.m1.3.3.1.1.1.1.1.3.cmml" xref="S4.E12.m1.3.3.1.1.1.1.1.3">𝑖</ci></apply><ci id="S4.E12.m1.1.1.cmml" xref="S4.E12.m1.1.1">…</ci><apply id="S4.E12.m1.3.3.1.1.2.2.2.cmml" xref="S4.E12.m1.3.3.1.1.2.2.2"><csymbol cd="ambiguous" id="S4.E12.m1.3.3.1.1.2.2.2.1.cmml" xref="S4.E12.m1.3.3.1.1.2.2.2">subscript</csymbol><apply id="S4.E12.m1.3.3.1.1.2.2.2.2.cmml" xref="S4.E12.m1.3.3.1.1.2.2.2"><csymbol cd="ambiguous" id="S4.E12.m1.3.3.1.1.2.2.2.2.1.cmml" xref="S4.E12.m1.3.3.1.1.2.2.2">superscript</csymbol><ci id="S4.E12.m1.3.3.1.1.2.2.2.2.2.cmml" xref="S4.E12.m1.3.3.1.1.2.2.2.2.2">𝐞</ci><ci id="S4.E12.m1.3.3.1.1.2.2.2.2.3.cmml" xref="S4.E12.m1.3.3.1.1.2.2.2.2.3">img</ci></apply><ci id="S4.E12.m1.3.3.1.1.2.2.2.3.cmml" xref="S4.E12.m1.3.3.1.1.2.2.2.3">𝑚</ci></apply></list><apply id="S4.E12.m1.3.3.1.1.3.cmml" xref="S4.E12.m1.3.3.1.1.3"><times id="S4.E12.m1.3.3.1.1.3.2.cmml" xref="S4.E12.m1.3.3.1.1.3.2"></times><apply id="S4.E12.m1.3.3.1.1.3.3.cmml" xref="S4.E12.m1.3.3.1.1.3.3"><csymbol cd="ambiguous" id="S4.E12.m1.3.3.1.1.3.3.1.cmml" xref="S4.E12.m1.3.3.1.1.3.3">subscript</csymbol><ci id="S4.E12.m1.3.3.1.1.3.3.2.cmml" xref="S4.E12.m1.3.3.1.1.3.3.2">CLIP</ci><ci id="S4.E12.m1.3.3.1.1.3.3.3.cmml" xref="S4.E12.m1.3.3.1.1.3.3.3">img</ci></apply><interval closure="open" id="S4.E12.m1.3.3.1.1.3.1.2.cmml" xref="S4.E12.m1.3.3.1.1.3.1.1"><ci id="S4.E12.m1.2.2.cmml" xref="S4.E12.m1.2.2">𝐱</ci><apply id="S4.E12.m1.3.3.1.1.3.1.1.1.cmml" xref="S4.E12.m1.3.3.1.1.3.1.1.1"><csymbol cd="ambiguous" id="S4.E12.m1.3.3.1.1.3.1.1.1.1.cmml" xref="S4.E12.m1.3.3.1.1.3.1.1.1">subscript</csymbol><apply id="S4.E12.m1.3.3.1.1.3.1.1.1.2.cmml" xref="S4.E12.m1.3.3.1.1.3.1.1.1.2"><ci id="S4.E12.m1.3.3.1.1.3.1.1.1.2.1.cmml" xref="S4.E12.m1.3.3.1.1.3.1.1.1.2.1">^</ci><ci id="S4.E12.m1.3.3.1.1.3.1.1.1.2.2.cmml" xref="S4.E12.m1.3.3.1.1.3.1.1.1.2.2">B</ci></apply><ci id="S4.E12.m1.3.3.1.1.3.1.1.1.3.cmml" xref="S4.E12.m1.3.3.1.1.3.1.1.1.3">det</ci></apply></interval></apply></apply><apply id="S4.E12.m1.3.3.1.1c.cmml" xref="S4.E12.m1.3.3.1"><in id="S4.E12.m1.3.3.1.1.6.cmml" xref="S4.E12.m1.3.3.1.1.6"></in><share href="#S4.E12.m1.3.3.1.1.3.cmml" id="S4.E12.m1.3.3.1.1d.cmml" xref="S4.E12.m1.3.3.1"></share><apply id="S4.E12.m1.3.3.1.1.7.cmml" xref="S4.E12.m1.3.3.1.1.7"><csymbol cd="ambiguous" id="S4.E12.m1.3.3.1.1.7.1.cmml" xref="S4.E12.m1.3.3.1.1.7">superscript</csymbol><ci id="S4.E12.m1.3.3.1.1.7.2.cmml" xref="S4.E12.m1.3.3.1.1.7.2">ℝ</ci><apply id="S4.E12.m1.3.3.1.1.7.3.cmml" xref="S4.E12.m1.3.3.1.1.7.3"><times id="S4.E12.m1.3.3.1.1.7.3.1.cmml" xref="S4.E12.m1.3.3.1.1.7.3.1"></times><ci id="S4.E12.m1.3.3.1.1.7.3.2.cmml" xref="S4.E12.m1.3.3.1.1.7.3.2">𝑚</ci><apply id="S4.E12.m1.3.3.1.1.7.3.3.cmml" xref="S4.E12.m1.3.3.1.1.7.3.3"><csymbol cd="ambiguous" id="S4.E12.m1.3.3.1.1.7.3.3.1.cmml" xref="S4.E12.m1.3.3.1.1.7.3.3">superscript</csymbol><ci id="S4.E12.m1.3.3.1.1.7.3.3.2.cmml" xref="S4.E12.m1.3.3.1.1.7.3.3.2">𝑑</ci><ci id="S4.E12.m1.3.3.1.1.7.3.3.3.cmml" xref="S4.E12.m1.3.3.1.1.7.3.3.3">′</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E12.m1.3c">[{\bf e}^{\rm img}_{i},\dots,{\bf e}^{\rm img}_{m}]={\rm CLIP}_{\rm img}({\bf x},\hat{\rm B}_{\rm det})\in\mathbb{R}^{m\times d^{\prime}}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(12)</span></td>
</tr></tbody>
</table>
</div>
</section>
<section id="S4.SS2.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.2.2 </span>RoI Pruning</h4>

<div id="S4.SS2.SSS2.p1" class="ltx_para">
<p id="S4.SS2.SSS2.p1.3" class="ltx_p">To make better use of CLIP, it is necessary to provide only RoIs that likely contain target objects. As discussed in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib31" title="" class="ltx_ref">31</a>]</cite>, the contrastive learning of CLIP is unaware of the alignment between local image regions and text tokens, leading to incorrect predictions for background regions. To address this, we propose a simple RoI pruning that identifies non-background RoIs from box predictions. We define an <em id="S4.SS2.SSS2.p1.3.1" class="ltx_emph ltx_font_italic">object score</em> as the maximum prediction probability values across all classes given by prompts. Given the box prediction <math id="S4.SS2.SSS2.p1.1.m1.1" class="ltx_Math" alttext="{\rm\hat{B}_{det}}" display="inline"><semantics id="S4.SS2.SSS2.p1.1.m1.1a"><msub id="S4.SS2.SSS2.p1.1.m1.1.1" xref="S4.SS2.SSS2.p1.1.m1.1.1.cmml"><mover accent="true" id="S4.SS2.SSS2.p1.1.m1.1.1.2" xref="S4.SS2.SSS2.p1.1.m1.1.1.2.cmml"><mi mathvariant="normal" id="S4.SS2.SSS2.p1.1.m1.1.1.2.2" xref="S4.SS2.SSS2.p1.1.m1.1.1.2.2.cmml">B</mi><mo id="S4.SS2.SSS2.p1.1.m1.1.1.2.1" xref="S4.SS2.SSS2.p1.1.m1.1.1.2.1.cmml">^</mo></mover><mi id="S4.SS2.SSS2.p1.1.m1.1.1.3" xref="S4.SS2.SSS2.p1.1.m1.1.1.3.cmml">det</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p1.1.m1.1b"><apply id="S4.SS2.SSS2.p1.1.m1.1.1.cmml" xref="S4.SS2.SSS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p1.1.m1.1.1.1.cmml" xref="S4.SS2.SSS2.p1.1.m1.1.1">subscript</csymbol><apply id="S4.SS2.SSS2.p1.1.m1.1.1.2.cmml" xref="S4.SS2.SSS2.p1.1.m1.1.1.2"><ci id="S4.SS2.SSS2.p1.1.m1.1.1.2.1.cmml" xref="S4.SS2.SSS2.p1.1.m1.1.1.2.1">^</ci><ci id="S4.SS2.SSS2.p1.1.m1.1.1.2.2.cmml" xref="S4.SS2.SSS2.p1.1.m1.1.1.2.2">B</ci></apply><ci id="S4.SS2.SSS2.p1.1.m1.1.1.3.cmml" xref="S4.SS2.SSS2.p1.1.m1.1.1.3">det</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p1.1.m1.1c">{\rm\hat{B}_{det}}</annotation></semantics></math> and its class prediction <math id="S4.SS2.SSS2.p1.2.m2.1" class="ltx_Math" alttext="{\rm\hat{P}_{det}}" display="inline"><semantics id="S4.SS2.SSS2.p1.2.m2.1a"><msub id="S4.SS2.SSS2.p1.2.m2.1.1" xref="S4.SS2.SSS2.p1.2.m2.1.1.cmml"><mover accent="true" id="S4.SS2.SSS2.p1.2.m2.1.1.2" xref="S4.SS2.SSS2.p1.2.m2.1.1.2.cmml"><mi mathvariant="normal" id="S4.SS2.SSS2.p1.2.m2.1.1.2.2" xref="S4.SS2.SSS2.p1.2.m2.1.1.2.2.cmml">P</mi><mo id="S4.SS2.SSS2.p1.2.m2.1.1.2.1" xref="S4.SS2.SSS2.p1.2.m2.1.1.2.1.cmml">^</mo></mover><mi id="S4.SS2.SSS2.p1.2.m2.1.1.3" xref="S4.SS2.SSS2.p1.2.m2.1.1.3.cmml">det</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p1.2.m2.1b"><apply id="S4.SS2.SSS2.p1.2.m2.1.1.cmml" xref="S4.SS2.SSS2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p1.2.m2.1.1.1.cmml" xref="S4.SS2.SSS2.p1.2.m2.1.1">subscript</csymbol><apply id="S4.SS2.SSS2.p1.2.m2.1.1.2.cmml" xref="S4.SS2.SSS2.p1.2.m2.1.1.2"><ci id="S4.SS2.SSS2.p1.2.m2.1.1.2.1.cmml" xref="S4.SS2.SSS2.p1.2.m2.1.1.2.1">^</ci><ci id="S4.SS2.SSS2.p1.2.m2.1.1.2.2.cmml" xref="S4.SS2.SSS2.p1.2.m2.1.1.2.2">P</ci></apply><ci id="S4.SS2.SSS2.p1.2.m2.1.1.3.cmml" xref="S4.SS2.SSS2.p1.2.m2.1.1.3">det</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p1.2.m2.1c">{\rm\hat{P}_{det}}</annotation></semantics></math> from the Transformer decoder, we keep only the RoIs with an object score higher than a certain threshold <math id="S4.SS2.SSS2.p1.3.m3.1" class="ltx_Math" alttext="\epsilon" display="inline"><semantics id="S4.SS2.SSS2.p1.3.m3.1a"><mi id="S4.SS2.SSS2.p1.3.m3.1.1" xref="S4.SS2.SSS2.p1.3.m3.1.1.cmml">ϵ</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p1.3.m3.1b"><ci id="S4.SS2.SSS2.p1.3.m3.1.1.cmml" xref="S4.SS2.SSS2.p1.3.m3.1.1">italic-ϵ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p1.3.m3.1c">\epsilon</annotation></semantics></math> as:</p>
<table id="S4.E13" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E13.m1.1" class="ltx_Math" alttext="{\rm\hat{B}}_{\rm prune}=\{{\bf b}_{i}\in{\rm\hat{B}}_{\rm det}:{\bf p}_{i}\in{\rm\hat{P}}_{\rm det}\wedge{\rm max}({\bf p}_{i})\geq\epsilon\}." display="block"><semantics id="S4.E13.m1.1a"><mrow id="S4.E13.m1.1.1.1" xref="S4.E13.m1.1.1.1.1.cmml"><mrow id="S4.E13.m1.1.1.1.1" xref="S4.E13.m1.1.1.1.1.cmml"><msub id="S4.E13.m1.1.1.1.1.4" xref="S4.E13.m1.1.1.1.1.4.cmml"><mover accent="true" id="S4.E13.m1.1.1.1.1.4.2" xref="S4.E13.m1.1.1.1.1.4.2.cmml"><mi mathvariant="normal" id="S4.E13.m1.1.1.1.1.4.2.2" xref="S4.E13.m1.1.1.1.1.4.2.2.cmml">B</mi><mo id="S4.E13.m1.1.1.1.1.4.2.1" xref="S4.E13.m1.1.1.1.1.4.2.1.cmml">^</mo></mover><mi id="S4.E13.m1.1.1.1.1.4.3" xref="S4.E13.m1.1.1.1.1.4.3.cmml">prune</mi></msub><mo id="S4.E13.m1.1.1.1.1.3" xref="S4.E13.m1.1.1.1.1.3.cmml">=</mo><mrow id="S4.E13.m1.1.1.1.1.2.2" xref="S4.E13.m1.1.1.1.1.2.3.cmml"><mo stretchy="false" id="S4.E13.m1.1.1.1.1.2.2.3" xref="S4.E13.m1.1.1.1.1.2.3.1.cmml">{</mo><mrow id="S4.E13.m1.1.1.1.1.1.1.1" xref="S4.E13.m1.1.1.1.1.1.1.1.cmml"><msub id="S4.E13.m1.1.1.1.1.1.1.1.2" xref="S4.E13.m1.1.1.1.1.1.1.1.2.cmml"><mi id="S4.E13.m1.1.1.1.1.1.1.1.2.2" xref="S4.E13.m1.1.1.1.1.1.1.1.2.2.cmml">𝐛</mi><mi id="S4.E13.m1.1.1.1.1.1.1.1.2.3" xref="S4.E13.m1.1.1.1.1.1.1.1.2.3.cmml">i</mi></msub><mo id="S4.E13.m1.1.1.1.1.1.1.1.1" xref="S4.E13.m1.1.1.1.1.1.1.1.1.cmml">∈</mo><msub id="S4.E13.m1.1.1.1.1.1.1.1.3" xref="S4.E13.m1.1.1.1.1.1.1.1.3.cmml"><mover accent="true" id="S4.E13.m1.1.1.1.1.1.1.1.3.2" xref="S4.E13.m1.1.1.1.1.1.1.1.3.2.cmml"><mi mathvariant="normal" id="S4.E13.m1.1.1.1.1.1.1.1.3.2.2" xref="S4.E13.m1.1.1.1.1.1.1.1.3.2.2.cmml">B</mi><mo id="S4.E13.m1.1.1.1.1.1.1.1.3.2.1" xref="S4.E13.m1.1.1.1.1.1.1.1.3.2.1.cmml">^</mo></mover><mi id="S4.E13.m1.1.1.1.1.1.1.1.3.3" xref="S4.E13.m1.1.1.1.1.1.1.1.3.3.cmml">det</mi></msub></mrow><mo lspace="0.278em" rspace="0.278em" id="S4.E13.m1.1.1.1.1.2.2.4" xref="S4.E13.m1.1.1.1.1.2.3.1.cmml">:</mo><mrow id="S4.E13.m1.1.1.1.1.2.2.2" xref="S4.E13.m1.1.1.1.1.2.2.2.cmml"><msub id="S4.E13.m1.1.1.1.1.2.2.2.3" xref="S4.E13.m1.1.1.1.1.2.2.2.3.cmml"><mi id="S4.E13.m1.1.1.1.1.2.2.2.3.2" xref="S4.E13.m1.1.1.1.1.2.2.2.3.2.cmml">𝐩</mi><mi id="S4.E13.m1.1.1.1.1.2.2.2.3.3" xref="S4.E13.m1.1.1.1.1.2.2.2.3.3.cmml">i</mi></msub><mo id="S4.E13.m1.1.1.1.1.2.2.2.4" xref="S4.E13.m1.1.1.1.1.2.2.2.4.cmml">∈</mo><mrow id="S4.E13.m1.1.1.1.1.2.2.2.1" xref="S4.E13.m1.1.1.1.1.2.2.2.1.cmml"><msub id="S4.E13.m1.1.1.1.1.2.2.2.1.3" xref="S4.E13.m1.1.1.1.1.2.2.2.1.3.cmml"><mover accent="true" id="S4.E13.m1.1.1.1.1.2.2.2.1.3.2" xref="S4.E13.m1.1.1.1.1.2.2.2.1.3.2.cmml"><mi mathvariant="normal" id="S4.E13.m1.1.1.1.1.2.2.2.1.3.2.2" xref="S4.E13.m1.1.1.1.1.2.2.2.1.3.2.2.cmml">P</mi><mo id="S4.E13.m1.1.1.1.1.2.2.2.1.3.2.1" xref="S4.E13.m1.1.1.1.1.2.2.2.1.3.2.1.cmml">^</mo></mover><mi id="S4.E13.m1.1.1.1.1.2.2.2.1.3.3" xref="S4.E13.m1.1.1.1.1.2.2.2.1.3.3.cmml">det</mi></msub><mo id="S4.E13.m1.1.1.1.1.2.2.2.1.2" xref="S4.E13.m1.1.1.1.1.2.2.2.1.2.cmml">∧</mo><mrow id="S4.E13.m1.1.1.1.1.2.2.2.1.1" xref="S4.E13.m1.1.1.1.1.2.2.2.1.1.cmml"><mi id="S4.E13.m1.1.1.1.1.2.2.2.1.1.3" xref="S4.E13.m1.1.1.1.1.2.2.2.1.1.3.cmml">max</mi><mo lspace="0em" rspace="0em" id="S4.E13.m1.1.1.1.1.2.2.2.1.1.2" xref="S4.E13.m1.1.1.1.1.2.2.2.1.1.2.cmml">​</mo><mrow id="S4.E13.m1.1.1.1.1.2.2.2.1.1.1.1" xref="S4.E13.m1.1.1.1.1.2.2.2.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E13.m1.1.1.1.1.2.2.2.1.1.1.1.2" xref="S4.E13.m1.1.1.1.1.2.2.2.1.1.1.1.1.cmml">(</mo><msub id="S4.E13.m1.1.1.1.1.2.2.2.1.1.1.1.1" xref="S4.E13.m1.1.1.1.1.2.2.2.1.1.1.1.1.cmml"><mi id="S4.E13.m1.1.1.1.1.2.2.2.1.1.1.1.1.2" xref="S4.E13.m1.1.1.1.1.2.2.2.1.1.1.1.1.2.cmml">𝐩</mi><mi id="S4.E13.m1.1.1.1.1.2.2.2.1.1.1.1.1.3" xref="S4.E13.m1.1.1.1.1.2.2.2.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S4.E13.m1.1.1.1.1.2.2.2.1.1.1.1.3" xref="S4.E13.m1.1.1.1.1.2.2.2.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E13.m1.1.1.1.1.2.2.2.5" xref="S4.E13.m1.1.1.1.1.2.2.2.5.cmml">≥</mo><mi id="S4.E13.m1.1.1.1.1.2.2.2.6" xref="S4.E13.m1.1.1.1.1.2.2.2.6.cmml">ϵ</mi></mrow><mo stretchy="false" id="S4.E13.m1.1.1.1.1.2.2.5" xref="S4.E13.m1.1.1.1.1.2.3.1.cmml">}</mo></mrow></mrow><mo lspace="0em" id="S4.E13.m1.1.1.1.2" xref="S4.E13.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E13.m1.1b"><apply id="S4.E13.m1.1.1.1.1.cmml" xref="S4.E13.m1.1.1.1"><eq id="S4.E13.m1.1.1.1.1.3.cmml" xref="S4.E13.m1.1.1.1.1.3"></eq><apply id="S4.E13.m1.1.1.1.1.4.cmml" xref="S4.E13.m1.1.1.1.1.4"><csymbol cd="ambiguous" id="S4.E13.m1.1.1.1.1.4.1.cmml" xref="S4.E13.m1.1.1.1.1.4">subscript</csymbol><apply id="S4.E13.m1.1.1.1.1.4.2.cmml" xref="S4.E13.m1.1.1.1.1.4.2"><ci id="S4.E13.m1.1.1.1.1.4.2.1.cmml" xref="S4.E13.m1.1.1.1.1.4.2.1">^</ci><ci id="S4.E13.m1.1.1.1.1.4.2.2.cmml" xref="S4.E13.m1.1.1.1.1.4.2.2">B</ci></apply><ci id="S4.E13.m1.1.1.1.1.4.3.cmml" xref="S4.E13.m1.1.1.1.1.4.3">prune</ci></apply><apply id="S4.E13.m1.1.1.1.1.2.3.cmml" xref="S4.E13.m1.1.1.1.1.2.2"><csymbol cd="latexml" id="S4.E13.m1.1.1.1.1.2.3.1.cmml" xref="S4.E13.m1.1.1.1.1.2.2.3">conditional-set</csymbol><apply id="S4.E13.m1.1.1.1.1.1.1.1.cmml" xref="S4.E13.m1.1.1.1.1.1.1.1"><in id="S4.E13.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.E13.m1.1.1.1.1.1.1.1.1"></in><apply id="S4.E13.m1.1.1.1.1.1.1.1.2.cmml" xref="S4.E13.m1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E13.m1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E13.m1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S4.E13.m1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E13.m1.1.1.1.1.1.1.1.2.2">𝐛</ci><ci id="S4.E13.m1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E13.m1.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><apply id="S4.E13.m1.1.1.1.1.1.1.1.3.cmml" xref="S4.E13.m1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E13.m1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E13.m1.1.1.1.1.1.1.1.3">subscript</csymbol><apply id="S4.E13.m1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E13.m1.1.1.1.1.1.1.1.3.2"><ci id="S4.E13.m1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S4.E13.m1.1.1.1.1.1.1.1.3.2.1">^</ci><ci id="S4.E13.m1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S4.E13.m1.1.1.1.1.1.1.1.3.2.2">B</ci></apply><ci id="S4.E13.m1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E13.m1.1.1.1.1.1.1.1.3.3">det</ci></apply></apply><apply id="S4.E13.m1.1.1.1.1.2.2.2.cmml" xref="S4.E13.m1.1.1.1.1.2.2.2"><and id="S4.E13.m1.1.1.1.1.2.2.2a.cmml" xref="S4.E13.m1.1.1.1.1.2.2.2"></and><apply id="S4.E13.m1.1.1.1.1.2.2.2b.cmml" xref="S4.E13.m1.1.1.1.1.2.2.2"><in id="S4.E13.m1.1.1.1.1.2.2.2.4.cmml" xref="S4.E13.m1.1.1.1.1.2.2.2.4"></in><apply id="S4.E13.m1.1.1.1.1.2.2.2.3.cmml" xref="S4.E13.m1.1.1.1.1.2.2.2.3"><csymbol cd="ambiguous" id="S4.E13.m1.1.1.1.1.2.2.2.3.1.cmml" xref="S4.E13.m1.1.1.1.1.2.2.2.3">subscript</csymbol><ci id="S4.E13.m1.1.1.1.1.2.2.2.3.2.cmml" xref="S4.E13.m1.1.1.1.1.2.2.2.3.2">𝐩</ci><ci id="S4.E13.m1.1.1.1.1.2.2.2.3.3.cmml" xref="S4.E13.m1.1.1.1.1.2.2.2.3.3">𝑖</ci></apply><apply id="S4.E13.m1.1.1.1.1.2.2.2.1.cmml" xref="S4.E13.m1.1.1.1.1.2.2.2.1"><and id="S4.E13.m1.1.1.1.1.2.2.2.1.2.cmml" xref="S4.E13.m1.1.1.1.1.2.2.2.1.2"></and><apply id="S4.E13.m1.1.1.1.1.2.2.2.1.3.cmml" xref="S4.E13.m1.1.1.1.1.2.2.2.1.3"><csymbol cd="ambiguous" id="S4.E13.m1.1.1.1.1.2.2.2.1.3.1.cmml" xref="S4.E13.m1.1.1.1.1.2.2.2.1.3">subscript</csymbol><apply id="S4.E13.m1.1.1.1.1.2.2.2.1.3.2.cmml" xref="S4.E13.m1.1.1.1.1.2.2.2.1.3.2"><ci id="S4.E13.m1.1.1.1.1.2.2.2.1.3.2.1.cmml" xref="S4.E13.m1.1.1.1.1.2.2.2.1.3.2.1">^</ci><ci id="S4.E13.m1.1.1.1.1.2.2.2.1.3.2.2.cmml" xref="S4.E13.m1.1.1.1.1.2.2.2.1.3.2.2">P</ci></apply><ci id="S4.E13.m1.1.1.1.1.2.2.2.1.3.3.cmml" xref="S4.E13.m1.1.1.1.1.2.2.2.1.3.3">det</ci></apply><apply id="S4.E13.m1.1.1.1.1.2.2.2.1.1.cmml" xref="S4.E13.m1.1.1.1.1.2.2.2.1.1"><times id="S4.E13.m1.1.1.1.1.2.2.2.1.1.2.cmml" xref="S4.E13.m1.1.1.1.1.2.2.2.1.1.2"></times><ci id="S4.E13.m1.1.1.1.1.2.2.2.1.1.3.cmml" xref="S4.E13.m1.1.1.1.1.2.2.2.1.1.3">max</ci><apply id="S4.E13.m1.1.1.1.1.2.2.2.1.1.1.1.1.cmml" xref="S4.E13.m1.1.1.1.1.2.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S4.E13.m1.1.1.1.1.2.2.2.1.1.1.1.1.1.cmml" xref="S4.E13.m1.1.1.1.1.2.2.2.1.1.1.1">subscript</csymbol><ci id="S4.E13.m1.1.1.1.1.2.2.2.1.1.1.1.1.2.cmml" xref="S4.E13.m1.1.1.1.1.2.2.2.1.1.1.1.1.2">𝐩</ci><ci id="S4.E13.m1.1.1.1.1.2.2.2.1.1.1.1.1.3.cmml" xref="S4.E13.m1.1.1.1.1.2.2.2.1.1.1.1.1.3">𝑖</ci></apply></apply></apply></apply><apply id="S4.E13.m1.1.1.1.1.2.2.2c.cmml" xref="S4.E13.m1.1.1.1.1.2.2.2"><geq id="S4.E13.m1.1.1.1.1.2.2.2.5.cmml" xref="S4.E13.m1.1.1.1.1.2.2.2.5"></geq><share href="#S4.E13.m1.1.1.1.1.2.2.2.1.cmml" id="S4.E13.m1.1.1.1.1.2.2.2d.cmml" xref="S4.E13.m1.1.1.1.1.2.2.2"></share><ci id="S4.E13.m1.1.1.1.1.2.2.2.6.cmml" xref="S4.E13.m1.1.1.1.1.2.2.2.6">italic-ϵ</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E13.m1.1c">{\rm\hat{B}}_{\rm prune}=\{{\bf b}_{i}\in{\rm\hat{B}}_{\rm det}:{\bf p}_{i}\in{\rm\hat{P}}_{\rm det}\wedge{\rm max}({\bf p}_{i})\geq\epsilon\}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(13)</span></td>
</tr></tbody>
</table>
<p id="S4.SS2.SSS2.p1.4" class="ltx_p">Therefore, we replace the input of the RoI-based masked attention with the pruned RoIs.</p>
</div>
</section>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Training and Evaluation Pipeline</h3>

<div id="S4.SS3.p1" class="ltx_para">
<p id="S4.SS3.p1.4" class="ltx_p">For label assignment, Prompt-OVD conducts multi-label classification using bipartite matching with the Hungarian algorithm <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite>. Therefore, following the existing optimization pipeline in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>, <a href="#bib.bib33" title="" class="ltx_ref">33</a>]</cite>, we uses focal loss <math id="S4.SS3.p1.1.m1.1" class="ltx_Math" alttext="\ell_{\rm cls}" display="inline"><semantics id="S4.SS3.p1.1.m1.1a"><msub id="S4.SS3.p1.1.m1.1.1" xref="S4.SS3.p1.1.m1.1.1.cmml"><mi mathvariant="normal" id="S4.SS3.p1.1.m1.1.1.2" xref="S4.SS3.p1.1.m1.1.1.2.cmml">ℓ</mi><mi id="S4.SS3.p1.1.m1.1.1.3" xref="S4.SS3.p1.1.m1.1.1.3.cmml">cls</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.1.m1.1b"><apply id="S4.SS3.p1.1.m1.1.1.cmml" xref="S4.SS3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.1.m1.1.1.1.cmml" xref="S4.SS3.p1.1.m1.1.1">subscript</csymbol><ci id="S4.SS3.p1.1.m1.1.1.2.cmml" xref="S4.SS3.p1.1.m1.1.1.2">ℓ</ci><ci id="S4.SS3.p1.1.m1.1.1.3.cmml" xref="S4.SS3.p1.1.m1.1.1.3">cls</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.1.m1.1c">\ell_{\rm cls}</annotation></semantics></math> for multi-label classification, and L1 loss <math id="S4.SS3.p1.2.m2.1" class="ltx_Math" alttext="\ell_{\rm l1}" display="inline"><semantics id="S4.SS3.p1.2.m2.1a"><msub id="S4.SS3.p1.2.m2.1.1" xref="S4.SS3.p1.2.m2.1.1.cmml"><mi mathvariant="normal" id="S4.SS3.p1.2.m2.1.1.2" xref="S4.SS3.p1.2.m2.1.1.2.cmml">ℓ</mi><mi id="S4.SS3.p1.2.m2.1.1.3" xref="S4.SS3.p1.2.m2.1.1.3.cmml">l1</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.2.m2.1b"><apply id="S4.SS3.p1.2.m2.1.1.cmml" xref="S4.SS3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.2.m2.1.1.1.cmml" xref="S4.SS3.p1.2.m2.1.1">subscript</csymbol><ci id="S4.SS3.p1.2.m2.1.1.2.cmml" xref="S4.SS3.p1.2.m2.1.1.2">ℓ</ci><ci id="S4.SS3.p1.2.m2.1.1.3.cmml" xref="S4.SS3.p1.2.m2.1.1.3">l1</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.2.m2.1c">\ell_{\rm l1}</annotation></semantics></math> and GIoU loss <math id="S4.SS3.p1.3.m3.1" class="ltx_Math" alttext="\ell_{\rm iou}" display="inline"><semantics id="S4.SS3.p1.3.m3.1a"><msub id="S4.SS3.p1.3.m3.1.1" xref="S4.SS3.p1.3.m3.1.1.cmml"><mi mathvariant="normal" id="S4.SS3.p1.3.m3.1.1.2" xref="S4.SS3.p1.3.m3.1.1.2.cmml">ℓ</mi><mi id="S4.SS3.p1.3.m3.1.1.3" xref="S4.SS3.p1.3.m3.1.1.3.cmml">iou</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.3.m3.1b"><apply id="S4.SS3.p1.3.m3.1.1.cmml" xref="S4.SS3.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.3.m3.1.1.1.cmml" xref="S4.SS3.p1.3.m3.1.1">subscript</csymbol><ci id="S4.SS3.p1.3.m3.1.1.2.cmml" xref="S4.SS3.p1.3.m3.1.1.2">ℓ</ci><ci id="S4.SS3.p1.3.m3.1.1.3.cmml" xref="S4.SS3.p1.3.m3.1.1.3">iou</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.3.m3.1c">\ell_{\rm iou}</annotation></semantics></math> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite> for box regression. The embedding loss <math id="S4.SS3.p1.4.m4.1" class="ltx_Math" alttext="\ell_{\rm embed}" display="inline"><semantics id="S4.SS3.p1.4.m4.1a"><msub id="S4.SS3.p1.4.m4.1.1" xref="S4.SS3.p1.4.m4.1.1.cmml"><mi mathvariant="normal" id="S4.SS3.p1.4.m4.1.1.2" xref="S4.SS3.p1.4.m4.1.1.2.cmml">ℓ</mi><mi id="S4.SS3.p1.4.m4.1.1.3" xref="S4.SS3.p1.4.m4.1.1.3.cmml">embed</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.4.m4.1b"><apply id="S4.SS3.p1.4.m4.1.1.cmml" xref="S4.SS3.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.4.m4.1.1.1.cmml" xref="S4.SS3.p1.4.m4.1.1">subscript</csymbol><ci id="S4.SS3.p1.4.m4.1.1.2.cmml" xref="S4.SS3.p1.4.m4.1.1.2">ℓ</ci><ci id="S4.SS3.p1.4.m4.1.1.3.cmml" xref="S4.SS3.p1.4.m4.1.1.3">embed</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.4.m4.1c">\ell_{\rm embed}</annotation></semantics></math> proposed by <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite> is also used to distil the CLIP’s knowledge for open vocabulary object detection,</p>
<table id="S4.E14" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E14.m1.1" class="ltx_Math" alttext="\ell=\lambda_{\rm cls}\ell_{\rm cls}+\lambda_{\rm l1}\ell_{\rm l1}+\lambda_{\rm iou}\ell_{\rm iou}+\lambda_{\rm embed}\ell_{\rm embed}," display="block"><semantics id="S4.E14.m1.1a"><mrow id="S4.E14.m1.1.1.1" xref="S4.E14.m1.1.1.1.1.cmml"><mrow id="S4.E14.m1.1.1.1.1" xref="S4.E14.m1.1.1.1.1.cmml"><mi mathvariant="normal" id="S4.E14.m1.1.1.1.1.2" xref="S4.E14.m1.1.1.1.1.2.cmml">ℓ</mi><mo id="S4.E14.m1.1.1.1.1.1" xref="S4.E14.m1.1.1.1.1.1.cmml">=</mo><mrow id="S4.E14.m1.1.1.1.1.3" xref="S4.E14.m1.1.1.1.1.3.cmml"><mrow id="S4.E14.m1.1.1.1.1.3.2" xref="S4.E14.m1.1.1.1.1.3.2.cmml"><msub id="S4.E14.m1.1.1.1.1.3.2.2" xref="S4.E14.m1.1.1.1.1.3.2.2.cmml"><mi id="S4.E14.m1.1.1.1.1.3.2.2.2" xref="S4.E14.m1.1.1.1.1.3.2.2.2.cmml">λ</mi><mi id="S4.E14.m1.1.1.1.1.3.2.2.3" xref="S4.E14.m1.1.1.1.1.3.2.2.3.cmml">cls</mi></msub><mo lspace="0em" rspace="0em" id="S4.E14.m1.1.1.1.1.3.2.1" xref="S4.E14.m1.1.1.1.1.3.2.1.cmml">​</mo><msub id="S4.E14.m1.1.1.1.1.3.2.3" xref="S4.E14.m1.1.1.1.1.3.2.3.cmml"><mi mathvariant="normal" id="S4.E14.m1.1.1.1.1.3.2.3.2" xref="S4.E14.m1.1.1.1.1.3.2.3.2.cmml">ℓ</mi><mi id="S4.E14.m1.1.1.1.1.3.2.3.3" xref="S4.E14.m1.1.1.1.1.3.2.3.3.cmml">cls</mi></msub></mrow><mo id="S4.E14.m1.1.1.1.1.3.1" xref="S4.E14.m1.1.1.1.1.3.1.cmml">+</mo><mrow id="S4.E14.m1.1.1.1.1.3.3" xref="S4.E14.m1.1.1.1.1.3.3.cmml"><msub id="S4.E14.m1.1.1.1.1.3.3.2" xref="S4.E14.m1.1.1.1.1.3.3.2.cmml"><mi id="S4.E14.m1.1.1.1.1.3.3.2.2" xref="S4.E14.m1.1.1.1.1.3.3.2.2.cmml">λ</mi><mi id="S4.E14.m1.1.1.1.1.3.3.2.3" xref="S4.E14.m1.1.1.1.1.3.3.2.3.cmml">l1</mi></msub><mo lspace="0em" rspace="0em" id="S4.E14.m1.1.1.1.1.3.3.1" xref="S4.E14.m1.1.1.1.1.3.3.1.cmml">​</mo><msub id="S4.E14.m1.1.1.1.1.3.3.3" xref="S4.E14.m1.1.1.1.1.3.3.3.cmml"><mi mathvariant="normal" id="S4.E14.m1.1.1.1.1.3.3.3.2" xref="S4.E14.m1.1.1.1.1.3.3.3.2.cmml">ℓ</mi><mi id="S4.E14.m1.1.1.1.1.3.3.3.3" xref="S4.E14.m1.1.1.1.1.3.3.3.3.cmml">l1</mi></msub></mrow><mo id="S4.E14.m1.1.1.1.1.3.1a" xref="S4.E14.m1.1.1.1.1.3.1.cmml">+</mo><mrow id="S4.E14.m1.1.1.1.1.3.4" xref="S4.E14.m1.1.1.1.1.3.4.cmml"><msub id="S4.E14.m1.1.1.1.1.3.4.2" xref="S4.E14.m1.1.1.1.1.3.4.2.cmml"><mi id="S4.E14.m1.1.1.1.1.3.4.2.2" xref="S4.E14.m1.1.1.1.1.3.4.2.2.cmml">λ</mi><mi id="S4.E14.m1.1.1.1.1.3.4.2.3" xref="S4.E14.m1.1.1.1.1.3.4.2.3.cmml">iou</mi></msub><mo lspace="0em" rspace="0em" id="S4.E14.m1.1.1.1.1.3.4.1" xref="S4.E14.m1.1.1.1.1.3.4.1.cmml">​</mo><msub id="S4.E14.m1.1.1.1.1.3.4.3" xref="S4.E14.m1.1.1.1.1.3.4.3.cmml"><mi mathvariant="normal" id="S4.E14.m1.1.1.1.1.3.4.3.2" xref="S4.E14.m1.1.1.1.1.3.4.3.2.cmml">ℓ</mi><mi id="S4.E14.m1.1.1.1.1.3.4.3.3" xref="S4.E14.m1.1.1.1.1.3.4.3.3.cmml">iou</mi></msub></mrow><mo id="S4.E14.m1.1.1.1.1.3.1b" xref="S4.E14.m1.1.1.1.1.3.1.cmml">+</mo><mrow id="S4.E14.m1.1.1.1.1.3.5" xref="S4.E14.m1.1.1.1.1.3.5.cmml"><msub id="S4.E14.m1.1.1.1.1.3.5.2" xref="S4.E14.m1.1.1.1.1.3.5.2.cmml"><mi id="S4.E14.m1.1.1.1.1.3.5.2.2" xref="S4.E14.m1.1.1.1.1.3.5.2.2.cmml">λ</mi><mi id="S4.E14.m1.1.1.1.1.3.5.2.3" xref="S4.E14.m1.1.1.1.1.3.5.2.3.cmml">embed</mi></msub><mo lspace="0em" rspace="0em" id="S4.E14.m1.1.1.1.1.3.5.1" xref="S4.E14.m1.1.1.1.1.3.5.1.cmml">​</mo><msub id="S4.E14.m1.1.1.1.1.3.5.3" xref="S4.E14.m1.1.1.1.1.3.5.3.cmml"><mi mathvariant="normal" id="S4.E14.m1.1.1.1.1.3.5.3.2" xref="S4.E14.m1.1.1.1.1.3.5.3.2.cmml">ℓ</mi><mi id="S4.E14.m1.1.1.1.1.3.5.3.3" xref="S4.E14.m1.1.1.1.1.3.5.3.3.cmml">embed</mi></msub></mrow></mrow></mrow><mo id="S4.E14.m1.1.1.1.2" xref="S4.E14.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E14.m1.1b"><apply id="S4.E14.m1.1.1.1.1.cmml" xref="S4.E14.m1.1.1.1"><eq id="S4.E14.m1.1.1.1.1.1.cmml" xref="S4.E14.m1.1.1.1.1.1"></eq><ci id="S4.E14.m1.1.1.1.1.2.cmml" xref="S4.E14.m1.1.1.1.1.2">ℓ</ci><apply id="S4.E14.m1.1.1.1.1.3.cmml" xref="S4.E14.m1.1.1.1.1.3"><plus id="S4.E14.m1.1.1.1.1.3.1.cmml" xref="S4.E14.m1.1.1.1.1.3.1"></plus><apply id="S4.E14.m1.1.1.1.1.3.2.cmml" xref="S4.E14.m1.1.1.1.1.3.2"><times id="S4.E14.m1.1.1.1.1.3.2.1.cmml" xref="S4.E14.m1.1.1.1.1.3.2.1"></times><apply id="S4.E14.m1.1.1.1.1.3.2.2.cmml" xref="S4.E14.m1.1.1.1.1.3.2.2"><csymbol cd="ambiguous" id="S4.E14.m1.1.1.1.1.3.2.2.1.cmml" xref="S4.E14.m1.1.1.1.1.3.2.2">subscript</csymbol><ci id="S4.E14.m1.1.1.1.1.3.2.2.2.cmml" xref="S4.E14.m1.1.1.1.1.3.2.2.2">𝜆</ci><ci id="S4.E14.m1.1.1.1.1.3.2.2.3.cmml" xref="S4.E14.m1.1.1.1.1.3.2.2.3">cls</ci></apply><apply id="S4.E14.m1.1.1.1.1.3.2.3.cmml" xref="S4.E14.m1.1.1.1.1.3.2.3"><csymbol cd="ambiguous" id="S4.E14.m1.1.1.1.1.3.2.3.1.cmml" xref="S4.E14.m1.1.1.1.1.3.2.3">subscript</csymbol><ci id="S4.E14.m1.1.1.1.1.3.2.3.2.cmml" xref="S4.E14.m1.1.1.1.1.3.2.3.2">ℓ</ci><ci id="S4.E14.m1.1.1.1.1.3.2.3.3.cmml" xref="S4.E14.m1.1.1.1.1.3.2.3.3">cls</ci></apply></apply><apply id="S4.E14.m1.1.1.1.1.3.3.cmml" xref="S4.E14.m1.1.1.1.1.3.3"><times id="S4.E14.m1.1.1.1.1.3.3.1.cmml" xref="S4.E14.m1.1.1.1.1.3.3.1"></times><apply id="S4.E14.m1.1.1.1.1.3.3.2.cmml" xref="S4.E14.m1.1.1.1.1.3.3.2"><csymbol cd="ambiguous" id="S4.E14.m1.1.1.1.1.3.3.2.1.cmml" xref="S4.E14.m1.1.1.1.1.3.3.2">subscript</csymbol><ci id="S4.E14.m1.1.1.1.1.3.3.2.2.cmml" xref="S4.E14.m1.1.1.1.1.3.3.2.2">𝜆</ci><ci id="S4.E14.m1.1.1.1.1.3.3.2.3.cmml" xref="S4.E14.m1.1.1.1.1.3.3.2.3">l1</ci></apply><apply id="S4.E14.m1.1.1.1.1.3.3.3.cmml" xref="S4.E14.m1.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S4.E14.m1.1.1.1.1.3.3.3.1.cmml" xref="S4.E14.m1.1.1.1.1.3.3.3">subscript</csymbol><ci id="S4.E14.m1.1.1.1.1.3.3.3.2.cmml" xref="S4.E14.m1.1.1.1.1.3.3.3.2">ℓ</ci><ci id="S4.E14.m1.1.1.1.1.3.3.3.3.cmml" xref="S4.E14.m1.1.1.1.1.3.3.3.3">l1</ci></apply></apply><apply id="S4.E14.m1.1.1.1.1.3.4.cmml" xref="S4.E14.m1.1.1.1.1.3.4"><times id="S4.E14.m1.1.1.1.1.3.4.1.cmml" xref="S4.E14.m1.1.1.1.1.3.4.1"></times><apply id="S4.E14.m1.1.1.1.1.3.4.2.cmml" xref="S4.E14.m1.1.1.1.1.3.4.2"><csymbol cd="ambiguous" id="S4.E14.m1.1.1.1.1.3.4.2.1.cmml" xref="S4.E14.m1.1.1.1.1.3.4.2">subscript</csymbol><ci id="S4.E14.m1.1.1.1.1.3.4.2.2.cmml" xref="S4.E14.m1.1.1.1.1.3.4.2.2">𝜆</ci><ci id="S4.E14.m1.1.1.1.1.3.4.2.3.cmml" xref="S4.E14.m1.1.1.1.1.3.4.2.3">iou</ci></apply><apply id="S4.E14.m1.1.1.1.1.3.4.3.cmml" xref="S4.E14.m1.1.1.1.1.3.4.3"><csymbol cd="ambiguous" id="S4.E14.m1.1.1.1.1.3.4.3.1.cmml" xref="S4.E14.m1.1.1.1.1.3.4.3">subscript</csymbol><ci id="S4.E14.m1.1.1.1.1.3.4.3.2.cmml" xref="S4.E14.m1.1.1.1.1.3.4.3.2">ℓ</ci><ci id="S4.E14.m1.1.1.1.1.3.4.3.3.cmml" xref="S4.E14.m1.1.1.1.1.3.4.3.3">iou</ci></apply></apply><apply id="S4.E14.m1.1.1.1.1.3.5.cmml" xref="S4.E14.m1.1.1.1.1.3.5"><times id="S4.E14.m1.1.1.1.1.3.5.1.cmml" xref="S4.E14.m1.1.1.1.1.3.5.1"></times><apply id="S4.E14.m1.1.1.1.1.3.5.2.cmml" xref="S4.E14.m1.1.1.1.1.3.5.2"><csymbol cd="ambiguous" id="S4.E14.m1.1.1.1.1.3.5.2.1.cmml" xref="S4.E14.m1.1.1.1.1.3.5.2">subscript</csymbol><ci id="S4.E14.m1.1.1.1.1.3.5.2.2.cmml" xref="S4.E14.m1.1.1.1.1.3.5.2.2">𝜆</ci><ci id="S4.E14.m1.1.1.1.1.3.5.2.3.cmml" xref="S4.E14.m1.1.1.1.1.3.5.2.3">embed</ci></apply><apply id="S4.E14.m1.1.1.1.1.3.5.3.cmml" xref="S4.E14.m1.1.1.1.1.3.5.3"><csymbol cd="ambiguous" id="S4.E14.m1.1.1.1.1.3.5.3.1.cmml" xref="S4.E14.m1.1.1.1.1.3.5.3">subscript</csymbol><ci id="S4.E14.m1.1.1.1.1.3.5.3.2.cmml" xref="S4.E14.m1.1.1.1.1.3.5.3.2">ℓ</ci><ci id="S4.E14.m1.1.1.1.1.3.5.3.3.cmml" xref="S4.E14.m1.1.1.1.1.3.5.3.3">embed</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E14.m1.1c">\ell=\lambda_{\rm cls}\ell_{\rm cls}+\lambda_{\rm l1}\ell_{\rm l1}+\lambda_{\rm iou}\ell_{\rm iou}+\lambda_{\rm embed}\ell_{\rm embed},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(14)</span></td>
</tr></tbody>
</table>
<p id="S4.SS3.p1.5" class="ltx_p">where <math id="S4.SS3.p1.5.m1.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="S4.SS3.p1.5.m1.1a"><mi id="S4.SS3.p1.5.m1.1.1" xref="S4.SS3.p1.5.m1.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.5.m1.1b"><ci id="S4.SS3.p1.5.m1.1.1.cmml" xref="S4.SS3.p1.5.m1.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.5.m1.1c">\lambda</annotation></semantics></math>s are the balancing parameters.</p>
</div>
<div id="S4.SS3.p2" class="ltx_para">
<p id="S4.SS3.p2.1" class="ltx_p">We set the number of object queries <math id="S4.SS3.p2.1.m1.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S4.SS3.p2.1.m1.1a"><mi id="S4.SS3.p2.1.m1.1.1" xref="S4.SS3.p2.1.m1.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.1.m1.1b"><ci id="S4.SS3.p2.1.m1.1.1.cmml" xref="S4.SS3.p2.1.m1.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.1.m1.1c">m</annotation></semantics></math> to 300 and 1,500 for MS-COCO <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite> and LVIS <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>, respectively. Following the literature <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>, <a href="#bib.bib29" title="" class="ltx_ref">29</a>, <a href="#bib.bib31" title="" class="ltx_ref">31</a>, <a href="#bib.bib32" title="" class="ltx_ref">32</a>, <a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite>, only base classes are given in training time, while novel classes are given together with base classes in testing time. Appendix A provides further details on the training and evaluation pipeline.</p>
</div>
<figure id="S4.T1" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="S4.T1.19.6.1" class="ltx_text" style="font-size:90%;">Table 1</span>: </span><span id="S4.T1.10.5" class="ltx_text" style="font-size:90%;">Main Results on OV-COCO and OV-LVIS: We evaluate box AP with IoU threshold 0.5 (<math id="S4.T1.6.1.m1.1" class="ltx_Math" alttext="\mathrm{mAP^{50}}" display="inline"><semantics id="S4.T1.6.1.m1.1b"><msup id="S4.T1.6.1.m1.1.1" xref="S4.T1.6.1.m1.1.1.cmml"><mi id="S4.T1.6.1.m1.1.1.2" xref="S4.T1.6.1.m1.1.1.2.cmml">mAP</mi><mn id="S4.T1.6.1.m1.1.1.3" xref="S4.T1.6.1.m1.1.1.3.cmml">50</mn></msup><annotation-xml encoding="MathML-Content" id="S4.T1.6.1.m1.1c"><apply id="S4.T1.6.1.m1.1.1.cmml" xref="S4.T1.6.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T1.6.1.m1.1.1.1.cmml" xref="S4.T1.6.1.m1.1.1">superscript</csymbol><ci id="S4.T1.6.1.m1.1.1.2.cmml" xref="S4.T1.6.1.m1.1.1.2">mAP</ci><cn type="integer" id="S4.T1.6.1.m1.1.1.3.cmml" xref="S4.T1.6.1.m1.1.1.3">50</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.6.1.m1.1d">\mathrm{mAP^{50}}</annotation></semantics></math>) on OV-COCO, and box AP (<math id="S4.T1.7.2.m2.1" class="ltx_Math" alttext="\mathrm{mAP^{box}}" display="inline"><semantics id="S4.T1.7.2.m2.1b"><msup id="S4.T1.7.2.m2.1.1" xref="S4.T1.7.2.m2.1.1.cmml"><mi id="S4.T1.7.2.m2.1.1.2" xref="S4.T1.7.2.m2.1.1.2.cmml">mAP</mi><mi id="S4.T1.7.2.m2.1.1.3" xref="S4.T1.7.2.m2.1.1.3.cmml">box</mi></msup><annotation-xml encoding="MathML-Content" id="S4.T1.7.2.m2.1c"><apply id="S4.T1.7.2.m2.1.1.cmml" xref="S4.T1.7.2.m2.1.1"><csymbol cd="ambiguous" id="S4.T1.7.2.m2.1.1.1.cmml" xref="S4.T1.7.2.m2.1.1">superscript</csymbol><ci id="S4.T1.7.2.m2.1.1.2.cmml" xref="S4.T1.7.2.m2.1.1.2">mAP</ci><ci id="S4.T1.7.2.m2.1.1.3.cmml" xref="S4.T1.7.2.m2.1.1.3">box</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.7.2.m2.1d">\mathrm{mAP^{box}}</annotation></semantics></math>) and mask AP (<math id="S4.T1.8.3.m3.1" class="ltx_Math" alttext="\mathrm{mAP^{mask}}" display="inline"><semantics id="S4.T1.8.3.m3.1b"><msup id="S4.T1.8.3.m3.1.1" xref="S4.T1.8.3.m3.1.1.cmml"><mi id="S4.T1.8.3.m3.1.1.2" xref="S4.T1.8.3.m3.1.1.2.cmml">mAP</mi><mi id="S4.T1.8.3.m3.1.1.3" xref="S4.T1.8.3.m3.1.1.3.cmml">mask</mi></msup><annotation-xml encoding="MathML-Content" id="S4.T1.8.3.m3.1c"><apply id="S4.T1.8.3.m3.1.1.cmml" xref="S4.T1.8.3.m3.1.1"><csymbol cd="ambiguous" id="S4.T1.8.3.m3.1.1.1.cmml" xref="S4.T1.8.3.m3.1.1">superscript</csymbol><ci id="S4.T1.8.3.m3.1.1.2.cmml" xref="S4.T1.8.3.m3.1.1.2">mAP</ci><ci id="S4.T1.8.3.m3.1.1.3.cmml" xref="S4.T1.8.3.m3.1.1.3">mask</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.8.3.m3.1d">\mathrm{mAP^{mask}}</annotation></semantics></math>) on OV-LVIS. Note that <math id="S4.T1.9.4.m4.1" class="ltx_Math" alttext="\mathrm{mAP_{novel}}" display="inline"><semantics id="S4.T1.9.4.m4.1b"><msub id="S4.T1.9.4.m4.1.1" xref="S4.T1.9.4.m4.1.1.cmml"><mi id="S4.T1.9.4.m4.1.1.2" xref="S4.T1.9.4.m4.1.1.2.cmml">mAP</mi><mi id="S4.T1.9.4.m4.1.1.3" xref="S4.T1.9.4.m4.1.1.3.cmml">novel</mi></msub><annotation-xml encoding="MathML-Content" id="S4.T1.9.4.m4.1c"><apply id="S4.T1.9.4.m4.1.1.cmml" xref="S4.T1.9.4.m4.1.1"><csymbol cd="ambiguous" id="S4.T1.9.4.m4.1.1.1.cmml" xref="S4.T1.9.4.m4.1.1">subscript</csymbol><ci id="S4.T1.9.4.m4.1.1.2.cmml" xref="S4.T1.9.4.m4.1.1.2">mAP</ci><ci id="S4.T1.9.4.m4.1.1.3.cmml" xref="S4.T1.9.4.m4.1.1.3">novel</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.9.4.m4.1d">\mathrm{mAP_{novel}}</annotation></semantics></math> and <math id="S4.T1.10.5.m5.1" class="ltx_Math" alttext="\mathrm{mAP}" display="inline"><semantics id="S4.T1.10.5.m5.1b"><mi id="S4.T1.10.5.m5.1.1" xref="S4.T1.10.5.m5.1.1.cmml">mAP</mi><annotation-xml encoding="MathML-Content" id="S4.T1.10.5.m5.1c"><ci id="S4.T1.10.5.m5.1.1.cmml" xref="S4.T1.10.5.m5.1.1">mAP</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.10.5.m5.1d">\mathrm{mAP}</annotation></semantics></math> indicate the performance of zero-shot and the entire of categories, respectively. Lastly, latency implies inference time per image in seconds for OV-LVIS.</span></figcaption>
<div id="S4.T1.17" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:121.2pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-105.2pt,29.4pt) scale(0.673364710886788,0.673364710886788) ;">
<table id="S4.T1.17.7" class="ltx_tabular ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S4.T1.17.7.8.1" class="ltx_tr">
<td id="S4.T1.17.7.8.1.1" class="ltx_td ltx_border_tt"></td>
<td id="S4.T1.17.7.8.1.2" class="ltx_td ltx_border_tt"></td>
<td id="S4.T1.17.7.8.1.3" class="ltx_td ltx_border_tt"></td>
<td id="S4.T1.17.7.8.1.4" class="ltx_td ltx_border_tt"></td>
<td id="S4.T1.17.7.8.1.5" class="ltx_td ltx_align_center ltx_border_tt" colspan="3">OV-COCO</td>
<td id="S4.T1.17.7.8.1.6" class="ltx_td ltx_align_center ltx_border_tt" colspan="5">OV-LVIS</td>
</tr>
<tr id="S4.T1.17.7.7" class="ltx_tr">
<td id="S4.T1.17.7.7.8" class="ltx_td ltx_align_left">Methods</td>
<td id="S4.T1.17.7.7.9" class="ltx_td ltx_align_right">Backbone</td>
<td id="S4.T1.17.7.7.10" class="ltx_td ltx_align_right">CLIP</td>
<td id="S4.T1.17.7.7.11" class="ltx_td ltx_align_right">Res.</td>
<td id="S4.T1.11.1.1.1" class="ltx_td ltx_align_right ltx_border_t"><math id="S4.T1.11.1.1.1.m1.1" class="ltx_Math" alttext="\mathrm{mAP^{50}_{novel}}" display="inline"><semantics id="S4.T1.11.1.1.1.m1.1a"><msubsup id="S4.T1.11.1.1.1.m1.1.1" xref="S4.T1.11.1.1.1.m1.1.1.cmml"><mi id="S4.T1.11.1.1.1.m1.1.1.2.2" xref="S4.T1.11.1.1.1.m1.1.1.2.2.cmml">mAP</mi><mi id="S4.T1.11.1.1.1.m1.1.1.3" xref="S4.T1.11.1.1.1.m1.1.1.3.cmml">novel</mi><mn id="S4.T1.11.1.1.1.m1.1.1.2.3" xref="S4.T1.11.1.1.1.m1.1.1.2.3.cmml">50</mn></msubsup><annotation-xml encoding="MathML-Content" id="S4.T1.11.1.1.1.m1.1b"><apply id="S4.T1.11.1.1.1.m1.1.1.cmml" xref="S4.T1.11.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T1.11.1.1.1.m1.1.1.1.cmml" xref="S4.T1.11.1.1.1.m1.1.1">subscript</csymbol><apply id="S4.T1.11.1.1.1.m1.1.1.2.cmml" xref="S4.T1.11.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T1.11.1.1.1.m1.1.1.2.1.cmml" xref="S4.T1.11.1.1.1.m1.1.1">superscript</csymbol><ci id="S4.T1.11.1.1.1.m1.1.1.2.2.cmml" xref="S4.T1.11.1.1.1.m1.1.1.2.2">mAP</ci><cn type="integer" id="S4.T1.11.1.1.1.m1.1.1.2.3.cmml" xref="S4.T1.11.1.1.1.m1.1.1.2.3">50</cn></apply><ci id="S4.T1.11.1.1.1.m1.1.1.3.cmml" xref="S4.T1.11.1.1.1.m1.1.1.3">novel</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.11.1.1.1.m1.1c">\mathrm{mAP^{50}_{novel}}</annotation></semantics></math></td>
<td id="S4.T1.12.2.2.2" class="ltx_td ltx_align_right ltx_border_t"><math id="S4.T1.12.2.2.2.m1.1" class="ltx_Math" alttext="\mathrm{mAP^{50}_{base}}" display="inline"><semantics id="S4.T1.12.2.2.2.m1.1a"><msubsup id="S4.T1.12.2.2.2.m1.1.1" xref="S4.T1.12.2.2.2.m1.1.1.cmml"><mi id="S4.T1.12.2.2.2.m1.1.1.2.2" xref="S4.T1.12.2.2.2.m1.1.1.2.2.cmml">mAP</mi><mi id="S4.T1.12.2.2.2.m1.1.1.3" xref="S4.T1.12.2.2.2.m1.1.1.3.cmml">base</mi><mn id="S4.T1.12.2.2.2.m1.1.1.2.3" xref="S4.T1.12.2.2.2.m1.1.1.2.3.cmml">50</mn></msubsup><annotation-xml encoding="MathML-Content" id="S4.T1.12.2.2.2.m1.1b"><apply id="S4.T1.12.2.2.2.m1.1.1.cmml" xref="S4.T1.12.2.2.2.m1.1.1"><csymbol cd="ambiguous" id="S4.T1.12.2.2.2.m1.1.1.1.cmml" xref="S4.T1.12.2.2.2.m1.1.1">subscript</csymbol><apply id="S4.T1.12.2.2.2.m1.1.1.2.cmml" xref="S4.T1.12.2.2.2.m1.1.1"><csymbol cd="ambiguous" id="S4.T1.12.2.2.2.m1.1.1.2.1.cmml" xref="S4.T1.12.2.2.2.m1.1.1">superscript</csymbol><ci id="S4.T1.12.2.2.2.m1.1.1.2.2.cmml" xref="S4.T1.12.2.2.2.m1.1.1.2.2">mAP</ci><cn type="integer" id="S4.T1.12.2.2.2.m1.1.1.2.3.cmml" xref="S4.T1.12.2.2.2.m1.1.1.2.3">50</cn></apply><ci id="S4.T1.12.2.2.2.m1.1.1.3.cmml" xref="S4.T1.12.2.2.2.m1.1.1.3">base</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.12.2.2.2.m1.1c">\mathrm{mAP^{50}_{base}}</annotation></semantics></math></td>
<td id="S4.T1.13.3.3.3" class="ltx_td ltx_align_right ltx_border_t"><math id="S4.T1.13.3.3.3.m1.1" class="ltx_Math" alttext="\mathrm{mAP^{50}}" display="inline"><semantics id="S4.T1.13.3.3.3.m1.1a"><msup id="S4.T1.13.3.3.3.m1.1.1" xref="S4.T1.13.3.3.3.m1.1.1.cmml"><mi id="S4.T1.13.3.3.3.m1.1.1.2" xref="S4.T1.13.3.3.3.m1.1.1.2.cmml">mAP</mi><mn id="S4.T1.13.3.3.3.m1.1.1.3" xref="S4.T1.13.3.3.3.m1.1.1.3.cmml">50</mn></msup><annotation-xml encoding="MathML-Content" id="S4.T1.13.3.3.3.m1.1b"><apply id="S4.T1.13.3.3.3.m1.1.1.cmml" xref="S4.T1.13.3.3.3.m1.1.1"><csymbol cd="ambiguous" id="S4.T1.13.3.3.3.m1.1.1.1.cmml" xref="S4.T1.13.3.3.3.m1.1.1">superscript</csymbol><ci id="S4.T1.13.3.3.3.m1.1.1.2.cmml" xref="S4.T1.13.3.3.3.m1.1.1.2">mAP</ci><cn type="integer" id="S4.T1.13.3.3.3.m1.1.1.3.cmml" xref="S4.T1.13.3.3.3.m1.1.1.3">50</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.13.3.3.3.m1.1c">\mathrm{mAP^{50}}</annotation></semantics></math></td>
<td id="S4.T1.14.4.4.4" class="ltx_td ltx_align_right ltx_border_t"><math id="S4.T1.14.4.4.4.m1.1" class="ltx_Math" alttext="\mathrm{mAP^{box}_{novel}}" display="inline"><semantics id="S4.T1.14.4.4.4.m1.1a"><msubsup id="S4.T1.14.4.4.4.m1.1.1" xref="S4.T1.14.4.4.4.m1.1.1.cmml"><mi id="S4.T1.14.4.4.4.m1.1.1.2.2" xref="S4.T1.14.4.4.4.m1.1.1.2.2.cmml">mAP</mi><mi id="S4.T1.14.4.4.4.m1.1.1.3" xref="S4.T1.14.4.4.4.m1.1.1.3.cmml">novel</mi><mi id="S4.T1.14.4.4.4.m1.1.1.2.3" xref="S4.T1.14.4.4.4.m1.1.1.2.3.cmml">box</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.T1.14.4.4.4.m1.1b"><apply id="S4.T1.14.4.4.4.m1.1.1.cmml" xref="S4.T1.14.4.4.4.m1.1.1"><csymbol cd="ambiguous" id="S4.T1.14.4.4.4.m1.1.1.1.cmml" xref="S4.T1.14.4.4.4.m1.1.1">subscript</csymbol><apply id="S4.T1.14.4.4.4.m1.1.1.2.cmml" xref="S4.T1.14.4.4.4.m1.1.1"><csymbol cd="ambiguous" id="S4.T1.14.4.4.4.m1.1.1.2.1.cmml" xref="S4.T1.14.4.4.4.m1.1.1">superscript</csymbol><ci id="S4.T1.14.4.4.4.m1.1.1.2.2.cmml" xref="S4.T1.14.4.4.4.m1.1.1.2.2">mAP</ci><ci id="S4.T1.14.4.4.4.m1.1.1.2.3.cmml" xref="S4.T1.14.4.4.4.m1.1.1.2.3">box</ci></apply><ci id="S4.T1.14.4.4.4.m1.1.1.3.cmml" xref="S4.T1.14.4.4.4.m1.1.1.3">novel</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.14.4.4.4.m1.1c">\mathrm{mAP^{box}_{novel}}</annotation></semantics></math></td>
<td id="S4.T1.15.5.5.5" class="ltx_td ltx_align_right ltx_border_t"><math id="S4.T1.15.5.5.5.m1.1" class="ltx_Math" alttext="\mathrm{mAP^{box}}" display="inline"><semantics id="S4.T1.15.5.5.5.m1.1a"><msup id="S4.T1.15.5.5.5.m1.1.1" xref="S4.T1.15.5.5.5.m1.1.1.cmml"><mi id="S4.T1.15.5.5.5.m1.1.1.2" xref="S4.T1.15.5.5.5.m1.1.1.2.cmml">mAP</mi><mi id="S4.T1.15.5.5.5.m1.1.1.3" xref="S4.T1.15.5.5.5.m1.1.1.3.cmml">box</mi></msup><annotation-xml encoding="MathML-Content" id="S4.T1.15.5.5.5.m1.1b"><apply id="S4.T1.15.5.5.5.m1.1.1.cmml" xref="S4.T1.15.5.5.5.m1.1.1"><csymbol cd="ambiguous" id="S4.T1.15.5.5.5.m1.1.1.1.cmml" xref="S4.T1.15.5.5.5.m1.1.1">superscript</csymbol><ci id="S4.T1.15.5.5.5.m1.1.1.2.cmml" xref="S4.T1.15.5.5.5.m1.1.1.2">mAP</ci><ci id="S4.T1.15.5.5.5.m1.1.1.3.cmml" xref="S4.T1.15.5.5.5.m1.1.1.3">box</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.15.5.5.5.m1.1c">\mathrm{mAP^{box}}</annotation></semantics></math></td>
<td id="S4.T1.16.6.6.6" class="ltx_td ltx_align_right ltx_border_t"><math id="S4.T1.16.6.6.6.m1.1" class="ltx_Math" alttext="\mathrm{mAP^{mask}_{novel}}" display="inline"><semantics id="S4.T1.16.6.6.6.m1.1a"><msubsup id="S4.T1.16.6.6.6.m1.1.1" xref="S4.T1.16.6.6.6.m1.1.1.cmml"><mi id="S4.T1.16.6.6.6.m1.1.1.2.2" xref="S4.T1.16.6.6.6.m1.1.1.2.2.cmml">mAP</mi><mi id="S4.T1.16.6.6.6.m1.1.1.3" xref="S4.T1.16.6.6.6.m1.1.1.3.cmml">novel</mi><mi id="S4.T1.16.6.6.6.m1.1.1.2.3" xref="S4.T1.16.6.6.6.m1.1.1.2.3.cmml">mask</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.T1.16.6.6.6.m1.1b"><apply id="S4.T1.16.6.6.6.m1.1.1.cmml" xref="S4.T1.16.6.6.6.m1.1.1"><csymbol cd="ambiguous" id="S4.T1.16.6.6.6.m1.1.1.1.cmml" xref="S4.T1.16.6.6.6.m1.1.1">subscript</csymbol><apply id="S4.T1.16.6.6.6.m1.1.1.2.cmml" xref="S4.T1.16.6.6.6.m1.1.1"><csymbol cd="ambiguous" id="S4.T1.16.6.6.6.m1.1.1.2.1.cmml" xref="S4.T1.16.6.6.6.m1.1.1">superscript</csymbol><ci id="S4.T1.16.6.6.6.m1.1.1.2.2.cmml" xref="S4.T1.16.6.6.6.m1.1.1.2.2">mAP</ci><ci id="S4.T1.16.6.6.6.m1.1.1.2.3.cmml" xref="S4.T1.16.6.6.6.m1.1.1.2.3">mask</ci></apply><ci id="S4.T1.16.6.6.6.m1.1.1.3.cmml" xref="S4.T1.16.6.6.6.m1.1.1.3">novel</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.16.6.6.6.m1.1c">\mathrm{mAP^{mask}_{novel}}</annotation></semantics></math></td>
<td id="S4.T1.17.7.7.7" class="ltx_td ltx_align_right ltx_border_t"><math id="S4.T1.17.7.7.7.m1.1" class="ltx_Math" alttext="\mathrm{mAP^{mask}}" display="inline"><semantics id="S4.T1.17.7.7.7.m1.1a"><msup id="S4.T1.17.7.7.7.m1.1.1" xref="S4.T1.17.7.7.7.m1.1.1.cmml"><mi id="S4.T1.17.7.7.7.m1.1.1.2" xref="S4.T1.17.7.7.7.m1.1.1.2.cmml">mAP</mi><mi id="S4.T1.17.7.7.7.m1.1.1.3" xref="S4.T1.17.7.7.7.m1.1.1.3.cmml">mask</mi></msup><annotation-xml encoding="MathML-Content" id="S4.T1.17.7.7.7.m1.1b"><apply id="S4.T1.17.7.7.7.m1.1.1.cmml" xref="S4.T1.17.7.7.7.m1.1.1"><csymbol cd="ambiguous" id="S4.T1.17.7.7.7.m1.1.1.1.cmml" xref="S4.T1.17.7.7.7.m1.1.1">superscript</csymbol><ci id="S4.T1.17.7.7.7.m1.1.1.2.cmml" xref="S4.T1.17.7.7.7.m1.1.1.2">mAP</ci><ci id="S4.T1.17.7.7.7.m1.1.1.3.cmml" xref="S4.T1.17.7.7.7.m1.1.1.3">mask</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.17.7.7.7.m1.1c">\mathrm{mAP^{mask}}</annotation></semantics></math></td>
<td id="S4.T1.17.7.7.12" class="ltx_td ltx_nopad_r ltx_align_right ltx_border_t">Latency (s)</td>
</tr>
<tr id="S4.T1.17.7.9.2" class="ltx_tr">
<td id="S4.T1.17.7.9.2.1" class="ltx_td ltx_align_right ltx_border_t">
<span id="S4.T1.17.7.9.2.1.1" class="ltx_text ltx_font_sansserif">DETR-based</span></td>
<td id="S4.T1.17.7.9.2.2" class="ltx_td ltx_border_t"></td>
<td id="S4.T1.17.7.9.2.3" class="ltx_td ltx_border_t"></td>
<td id="S4.T1.17.7.9.2.4" class="ltx_td ltx_border_t"></td>
<td id="S4.T1.17.7.9.2.5" class="ltx_td ltx_border_t"></td>
<td id="S4.T1.17.7.9.2.6" class="ltx_td ltx_border_t"></td>
<td id="S4.T1.17.7.9.2.7" class="ltx_td ltx_border_t"></td>
<td id="S4.T1.17.7.9.2.8" class="ltx_td ltx_border_t"></td>
<td id="S4.T1.17.7.9.2.9" class="ltx_td ltx_border_t"></td>
<td id="S4.T1.17.7.9.2.10" class="ltx_td ltx_border_t"></td>
<td id="S4.T1.17.7.9.2.11" class="ltx_td ltx_border_t"></td>
<td id="S4.T1.17.7.9.2.12" class="ltx_td ltx_border_t"></td>
</tr>
<tr id="S4.T1.17.7.10.3" class="ltx_tr">
<td id="S4.T1.17.7.10.3.1" class="ltx_td ltx_align_left">OV-DETR <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite>
</td>
<td id="S4.T1.17.7.10.3.2" class="ltx_td ltx_align_right">RN50</td>
<td id="S4.T1.17.7.10.3.3" class="ltx_td ltx_align_right">ViT-B/32</td>
<td id="S4.T1.17.7.10.3.4" class="ltx_td ltx_align_right">1333</td>
<td id="S4.T1.17.7.10.3.5" class="ltx_td ltx_align_right">29.4</td>
<td id="S4.T1.17.7.10.3.6" class="ltx_td ltx_align_right">61.0</td>
<td id="S4.T1.17.7.10.3.7" class="ltx_td ltx_align_right">52.7</td>
<td id="S4.T1.17.7.10.3.8" class="ltx_td ltx_align_right">18.0</td>
<td id="S4.T1.17.7.10.3.9" class="ltx_td ltx_align_right">27.4</td>
<td id="S4.T1.17.7.10.3.10" class="ltx_td ltx_align_right">17.4</td>
<td id="S4.T1.17.7.10.3.11" class="ltx_td ltx_align_right">26.6</td>
<td id="S4.T1.17.7.10.3.12" class="ltx_td ltx_nopad_r ltx_align_right">12.28</td>
</tr>
<tr id="S4.T1.17.7.11.4" class="ltx_tr">
<td id="S4.T1.17.7.11.4.1" class="ltx_td ltx_align_left"><span id="S4.T1.17.7.11.4.1.1" class="ltx_text ltx_font_bold">Prompt-OVD</span></td>
<td id="S4.T1.17.7.11.4.2" class="ltx_td ltx_align_right">ViT-B/16</td>
<td id="S4.T1.17.7.11.4.3" class="ltx_td ltx_align_right">ViT-L/14</td>
<td id="S4.T1.17.7.11.4.4" class="ltx_td ltx_align_right">840</td>
<td id="S4.T1.17.7.11.4.5" class="ltx_td ltx_align_right"><span id="S4.T1.17.7.11.4.5.1" class="ltx_text ltx_font_bold">30.6</span></td>
<td id="S4.T1.17.7.11.4.6" class="ltx_td ltx_align_right"><span id="S4.T1.17.7.11.4.6.1" class="ltx_text ltx_font_bold">63.5</span></td>
<td id="S4.T1.17.7.11.4.7" class="ltx_td ltx_align_right"><span id="S4.T1.17.7.11.4.7.1" class="ltx_text ltx_font_bold">54.9</span></td>
<td id="S4.T1.17.7.11.4.8" class="ltx_td ltx_align_right"><span id="S4.T1.17.7.11.4.8.1" class="ltx_text ltx_font_bold">29.4</span></td>
<td id="S4.T1.17.7.11.4.9" class="ltx_td ltx_align_right"><span id="S4.T1.17.7.11.4.9.1" class="ltx_text ltx_font_bold">33.0</span></td>
<td id="S4.T1.17.7.11.4.10" class="ltx_td ltx_align_right"><span id="S4.T1.17.7.11.4.10.1" class="ltx_text ltx_font_bold">23.1</span></td>
<td id="S4.T1.17.7.11.4.11" class="ltx_td ltx_align_right">24.2</td>
<td id="S4.T1.17.7.11.4.12" class="ltx_td ltx_nopad_r ltx_align_right">0.58</td>
</tr>
<tr id="S4.T1.17.7.12.5" class="ltx_tr">
<td id="S4.T1.17.7.12.5.1" class="ltx_td ltx_align_right ltx_border_t"><span id="S4.T1.17.7.12.5.1.1" class="ltx_text ltx_font_sansserif">RCNN-based</span></td>
<td id="S4.T1.17.7.12.5.2" class="ltx_td ltx_align_right ltx_border_t" colspan="4">​​​​​​​​<span id="S4.T1.17.7.12.5.2.1" class="ltx_text ltx_font_sansserif">(Latency Range: 0.40 – 0.70 seconds)</span></td>
<td id="S4.T1.17.7.12.5.3" class="ltx_td ltx_border_t"></td>
<td id="S4.T1.17.7.12.5.4" class="ltx_td ltx_border_t"></td>
<td id="S4.T1.17.7.12.5.5" class="ltx_td ltx_border_t"></td>
<td id="S4.T1.17.7.12.5.6" class="ltx_td ltx_border_t"></td>
<td id="S4.T1.17.7.12.5.7" class="ltx_td ltx_border_t"></td>
<td id="S4.T1.17.7.12.5.8" class="ltx_td ltx_border_t"></td>
<td id="S4.T1.17.7.12.5.9" class="ltx_td ltx_border_t"></td>
</tr>
<tr id="S4.T1.17.7.13.6" class="ltx_tr">
<td id="S4.T1.17.7.13.6.1" class="ltx_td ltx_align_left">Detic <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib32" title="" class="ltx_ref">32</a>]</cite>
</td>
<td id="S4.T1.17.7.13.6.2" class="ltx_td ltx_align_right">RN50</td>
<td id="S4.T1.17.7.13.6.3" class="ltx_td ltx_align_right">ViT-B/32</td>
<td id="S4.T1.17.7.13.6.4" class="ltx_td ltx_align_right">1333</td>
<td id="S4.T1.17.7.13.6.5" class="ltx_td ltx_align_right">27.8</td>
<td id="S4.T1.17.7.13.6.6" class="ltx_td ltx_align_right">51.0</td>
<td id="S4.T1.17.7.13.6.7" class="ltx_td ltx_align_right">45.0</td>
<td id="S4.T1.17.7.13.6.8" class="ltx_td ltx_align_right">23.6</td>
<td id="S4.T1.17.7.13.6.9" class="ltx_td ltx_align_right">30.4</td>
<td id="S4.T1.17.7.13.6.10" class="ltx_td ltx_align_right">21.4</td>
<td id="S4.T1.17.7.13.6.11" class="ltx_td ltx_align_right"><span id="S4.T1.17.7.13.6.11.1" class="ltx_text ltx_font_bold">26.9</span></td>
<td id="S4.T1.17.7.13.6.12" class="ltx_td ltx_nopad_r ltx_align_right">0.47</td>
</tr>
<tr id="S4.T1.17.7.14.7" class="ltx_tr">
<td id="S4.T1.17.7.14.7.1" class="ltx_td ltx_align_left">ViLD <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite>
</td>
<td id="S4.T1.17.7.14.7.2" class="ltx_td ltx_align_right">RN50</td>
<td id="S4.T1.17.7.14.7.3" class="ltx_td ltx_align_right">ViT-B/32</td>
<td id="S4.T1.17.7.14.7.4" class="ltx_td ltx_align_right">1333</td>
<td id="S4.T1.17.7.14.7.5" class="ltx_td ltx_align_right">27.6</td>
<td id="S4.T1.17.7.14.7.6" class="ltx_td ltx_align_right">59.6</td>
<td id="S4.T1.17.7.14.7.7" class="ltx_td ltx_align_right">51.3</td>
<td id="S4.T1.17.7.14.7.8" class="ltx_td ltx_align_right">16.7</td>
<td id="S4.T1.17.7.14.7.9" class="ltx_td ltx_align_right">27.8</td>
<td id="S4.T1.17.7.14.7.10" class="ltx_td ltx_align_right">16.6</td>
<td id="S4.T1.17.7.14.7.11" class="ltx_td ltx_align_right">25.5</td>
<td id="S4.T1.17.7.14.7.12" class="ltx_td ltx_nopad_r ltx_align_right">0.48</td>
</tr>
<tr id="S4.T1.17.7.15.8" class="ltx_tr">
<td id="S4.T1.17.7.15.8.1" class="ltx_td ltx_align_left">F-VLM <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite>
</td>
<td id="S4.T1.17.7.15.8.2" class="ltx_td ltx_align_right">RN50</td>
<td id="S4.T1.17.7.15.8.3" class="ltx_td ltx_align_right">RN50</td>
<td id="S4.T1.17.7.15.8.4" class="ltx_td ltx_align_right">1024</td>
<td id="S4.T1.17.7.15.8.5" class="ltx_td ltx_align_right">28.0</td>
<td id="S4.T1.17.7.15.8.6" class="ltx_td ltx_align_right">43.7</td>
<td id="S4.T1.17.7.15.8.7" class="ltx_td ltx_align_right">39.6</td>
<td id="S4.T1.17.7.15.8.8" class="ltx_td ltx_align_right">20.3</td>
<td id="S4.T1.17.7.15.8.9" class="ltx_td ltx_align_right">27.8</td>
<td id="S4.T1.17.7.15.8.10" class="ltx_td ltx_align_right">18.6</td>
<td id="S4.T1.17.7.15.8.11" class="ltx_td ltx_align_right">24.2</td>
<td id="S4.T1.17.7.15.8.12" class="ltx_td ltx_nopad_r ltx_align_right">0.50</td>
</tr>
<tr id="S4.T1.17.7.16.9" class="ltx_tr">
<td id="S4.T1.17.7.16.9.1" class="ltx_td ltx_align_left ltx_border_bb">DetPro <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>
</td>
<td id="S4.T1.17.7.16.9.2" class="ltx_td ltx_align_right ltx_border_bb">RN50</td>
<td id="S4.T1.17.7.16.9.3" class="ltx_td ltx_align_right ltx_border_bb">ViT-B/32</td>
<td id="S4.T1.17.7.16.9.4" class="ltx_td ltx_align_right ltx_border_bb">1333</td>
<td id="S4.T1.17.7.16.9.5" class="ltx_td ltx_align_right ltx_border_bb">-</td>
<td id="S4.T1.17.7.16.9.6" class="ltx_td ltx_align_right ltx_border_bb">-</td>
<td id="S4.T1.17.7.16.9.7" class="ltx_td ltx_align_right ltx_border_bb">-</td>
<td id="S4.T1.17.7.16.9.8" class="ltx_td ltx_align_right ltx_border_bb">20.8</td>
<td id="S4.T1.17.7.16.9.9" class="ltx_td ltx_align_right ltx_border_bb">28.4</td>
<td id="S4.T1.17.7.16.9.10" class="ltx_td ltx_align_right ltx_border_bb">19.8</td>
<td id="S4.T1.17.7.16.9.11" class="ltx_td ltx_align_right ltx_border_bb">25.9</td>
<td id="S4.T1.17.7.16.9.12" class="ltx_td ltx_nopad_r ltx_align_right ltx_border_bb">0.67</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<figure id="S4.T4" class="ltx_table">
<div class="ltx_flex_figure ltx_flex_table">
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S4.T4.3" class="ltx_figure ltx_figure_panel ltx_parbox ltx_align_middle" style="width:130.1pt;">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.T4.3.4.1.1" class="ltx_text" style="font-size:90%;">Table 2</span>: </span><span id="S4.T4.3.5.2" class="ltx_text" style="font-size:90%;">Latency change by modifying OV-DETR to Prompt-OVD.</span></figcaption>
<div id="S4.T4.3.3" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:283.9pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(115.3pt,-75.5pt) scale(2.13546855240212,2.13546855240212) ;">
<table id="S4.T4.3.3.3" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S4.T4.3.3.3.4.1" class="ltx_tr">
<td id="S4.T4.3.3.3.4.1.1" class="ltx_td ltx_border_tt"></td>
<th id="S4.T4.3.3.3.4.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt">Modification</th>
<th id="S4.T4.3.3.3.4.1.3" class="ltx_td ltx_nopad_r ltx_align_right ltx_th ltx_th_column ltx_border_tt">Latency (s)</th>
</tr>
<tr id="S4.T4.3.3.3.5.2" class="ltx_tr">
<td id="S4.T4.3.3.3.5.2.1" class="ltx_td ltx_border_t"></td>
<td id="S4.T4.3.3.3.5.2.2" class="ltx_td ltx_align_left ltx_border_t">OV-DETR</td>
<td id="S4.T4.3.3.3.5.2.3" class="ltx_td ltx_nopad_r ltx_align_right ltx_border_t">12.28</td>
</tr>
<tr id="S4.T4.1.1.1.1" class="ltx_tr">
<td id="S4.T4.1.1.1.1.2" class="ltx_td ltx_align_left">(1)​​</td>
<td id="S4.T4.1.1.1.1.1" class="ltx_td ltx_align_left">ResNet <math id="S4.T4.1.1.1.1.1.m1.1" class="ltx_Math" alttext="\xrightarrow{}" display="inline"><semantics id="S4.T4.1.1.1.1.1.m1.1a"><mover accent="true" id="S4.T4.1.1.1.1.1.m1.1.1" xref="S4.T4.1.1.1.1.1.m1.1.1.cmml"><mo stretchy="false" id="S4.T4.1.1.1.1.1.m1.1.1.2" xref="S4.T4.1.1.1.1.1.m1.1.1.2.cmml">→</mo><mi id="S4.T4.1.1.1.1.1.m1.1.1.1" xref="S4.T4.1.1.1.1.1.m1.1.1.1.cmml"></mi></mover><annotation-xml encoding="MathML-Content" id="S4.T4.1.1.1.1.1.m1.1b"><apply id="S4.T4.1.1.1.1.1.m1.1.1.cmml" xref="S4.T4.1.1.1.1.1.m1.1.1"><csymbol cd="latexml" id="S4.T4.1.1.1.1.1.m1.1.1.1.cmml" xref="S4.T4.1.1.1.1.1.m1.1.1.1">absent</csymbol><ci id="S4.T4.1.1.1.1.1.m1.1.1.2.cmml" xref="S4.T4.1.1.1.1.1.m1.1.1.2">→</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.1.1.1.1.1.m1.1c">\xrightarrow{}</annotation></semantics></math> ViT</td>
<td id="S4.T4.1.1.1.1.3" class="ltx_td ltx_nopad_r ltx_align_right">12.36</td>
</tr>
<tr id="S4.T4.2.2.2.2" class="ltx_tr">
<td id="S4.T4.2.2.2.2.2" class="ltx_td ltx_align_left">(2)​​</td>
<td id="S4.T4.2.2.2.2.1" class="ltx_td ltx_align_left">ViT <math id="S4.T4.2.2.2.2.1.m1.1" class="ltx_Math" alttext="\xrightarrow{}" display="inline"><semantics id="S4.T4.2.2.2.2.1.m1.1a"><mover accent="true" id="S4.T4.2.2.2.2.1.m1.1.1" xref="S4.T4.2.2.2.2.1.m1.1.1.cmml"><mo stretchy="false" id="S4.T4.2.2.2.2.1.m1.1.1.2" xref="S4.T4.2.2.2.2.1.m1.1.1.2.cmml">→</mo><mi id="S4.T4.2.2.2.2.1.m1.1.1.1" xref="S4.T4.2.2.2.2.1.m1.1.1.1.cmml"></mi></mover><annotation-xml encoding="MathML-Content" id="S4.T4.2.2.2.2.1.m1.1b"><apply id="S4.T4.2.2.2.2.1.m1.1.1.cmml" xref="S4.T4.2.2.2.2.1.m1.1.1"><csymbol cd="latexml" id="S4.T4.2.2.2.2.1.m1.1.1.1.cmml" xref="S4.T4.2.2.2.2.1.m1.1.1.1">absent</csymbol><ci id="S4.T4.2.2.2.2.1.m1.1.1.2.cmml" xref="S4.T4.2.2.2.2.1.m1.1.1.2">→</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.2.2.2.2.1.m1.1c">\xrightarrow{}</annotation></semantics></math> ViTDet</td>
<td id="S4.T4.2.2.2.2.3" class="ltx_td ltx_nopad_r ltx_align_right">8.75</td>
</tr>
<tr id="S4.T4.3.3.3.6.3" class="ltx_tr">
<td id="S4.T4.3.3.3.6.3.1" class="ltx_td ltx_align_left">(3)​​</td>
<td id="S4.T4.3.3.3.6.3.2" class="ltx_td ltx_align_left">Prompt-based Decoding</td>
<td id="S4.T4.3.3.3.6.3.3" class="ltx_td ltx_nopad_r ltx_align_right">2.89</td>
</tr>
<tr id="S4.T4.3.3.3.7.4" class="ltx_tr">
<td id="S4.T4.3.3.3.7.4.1" class="ltx_td ltx_align_left">(4)​​</td>
<td id="S4.T4.3.3.3.7.4.2" class="ltx_td ltx_align_left">Ensemble with CLIP</td>
<td id="S4.T4.3.3.3.7.4.3" class="ltx_td ltx_nopad_r ltx_align_right">3.03</td>
</tr>
<tr id="S4.T4.3.3.3.3" class="ltx_tr">
<td id="S4.T4.3.3.3.3.2" class="ltx_td ltx_align_left ltx_border_bb">(5)​​</td>
<td id="S4.T4.3.3.3.3.1" class="ltx_td ltx_align_left ltx_border_bb">RoI Pruning (<math id="S4.T4.3.3.3.3.1.m1.1" class="ltx_math_unparsed" alttext="\epsilon=0.3)" display="inline"><semantics id="S4.T4.3.3.3.3.1.m1.1a"><mrow id="S4.T4.3.3.3.3.1.m1.1b"><mi id="S4.T4.3.3.3.3.1.m1.1.1">ϵ</mi><mo id="S4.T4.3.3.3.3.1.m1.1.2">=</mo><mn id="S4.T4.3.3.3.3.1.m1.1.3">0.3</mn><mo stretchy="false" id="S4.T4.3.3.3.3.1.m1.1.4">)</mo></mrow><annotation encoding="application/x-tex" id="S4.T4.3.3.3.3.1.m1.1c">\epsilon=0.3)</annotation></semantics></math>
</td>
<td id="S4.T4.3.3.3.3.3" class="ltx_td ltx_nopad_r ltx_align_right ltx_border_bb">0.58</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S4.T4.12" class="ltx_figure ltx_figure_panel ltx_parbox ltx_align_middle" style="width:143.1pt;">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.T4.12.10.3.1" class="ltx_text" style="font-size:90%;">Table 3</span>: </span><span id="S4.T4.7.4.2" class="ltx_text" style="font-size:90%;">Performance with varying <math id="S4.T4.6.3.1.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S4.T4.6.3.1.m1.1b"><mi id="S4.T4.6.3.1.m1.1.1" xref="S4.T4.6.3.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S4.T4.6.3.1.m1.1c"><ci id="S4.T4.6.3.1.m1.1.1.cmml" xref="S4.T4.6.3.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.6.3.1.m1.1d">\alpha</annotation></semantics></math> when fixing <math id="S4.T4.7.4.2.m2.1" class="ltx_Math" alttext="\beta=0.4" display="inline"><semantics id="S4.T4.7.4.2.m2.1b"><mrow id="S4.T4.7.4.2.m2.1.1" xref="S4.T4.7.4.2.m2.1.1.cmml"><mi id="S4.T4.7.4.2.m2.1.1.2" xref="S4.T4.7.4.2.m2.1.1.2.cmml">β</mi><mo id="S4.T4.7.4.2.m2.1.1.1" xref="S4.T4.7.4.2.m2.1.1.1.cmml">=</mo><mn id="S4.T4.7.4.2.m2.1.1.3" xref="S4.T4.7.4.2.m2.1.1.3.cmml">0.4</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T4.7.4.2.m2.1c"><apply id="S4.T4.7.4.2.m2.1.1.cmml" xref="S4.T4.7.4.2.m2.1.1"><eq id="S4.T4.7.4.2.m2.1.1.1.cmml" xref="S4.T4.7.4.2.m2.1.1.1"></eq><ci id="S4.T4.7.4.2.m2.1.1.2.cmml" xref="S4.T4.7.4.2.m2.1.1.2">𝛽</ci><cn type="float" id="S4.T4.7.4.2.m2.1.1.3.cmml" xref="S4.T4.7.4.2.m2.1.1.3">0.4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.7.4.2.m2.1d">\beta=0.4</annotation></semantics></math>.</span></figcaption>
<div id="S4.T4.12.9" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:331.2pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(116.6pt,-89.1pt) scale(2.16453672722143,2.16453672722143) ;">
<table id="S4.T4.12.9.5" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T4.12.9.5.5" class="ltx_tr">
<th id="S4.T4.8.5.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt"><math id="S4.T4.8.5.1.1.1.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S4.T4.8.5.1.1.1.m1.1a"><mi id="S4.T4.8.5.1.1.1.m1.1.1" xref="S4.T4.8.5.1.1.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S4.T4.8.5.1.1.1.m1.1b"><ci id="S4.T4.8.5.1.1.1.m1.1.1.cmml" xref="S4.T4.8.5.1.1.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.8.5.1.1.1.m1.1c">\alpha</annotation></semantics></math></th>
<th id="S4.T4.9.6.2.2.2" class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_tt"><math id="S4.T4.9.6.2.2.2.m1.1" class="ltx_Math" alttext="\mathrm{mAP^{box}_{novel}}" display="inline"><semantics id="S4.T4.9.6.2.2.2.m1.1a"><msubsup id="S4.T4.9.6.2.2.2.m1.1.1" xref="S4.T4.9.6.2.2.2.m1.1.1.cmml"><mi id="S4.T4.9.6.2.2.2.m1.1.1.2.2" xref="S4.T4.9.6.2.2.2.m1.1.1.2.2.cmml">mAP</mi><mi id="S4.T4.9.6.2.2.2.m1.1.1.3" xref="S4.T4.9.6.2.2.2.m1.1.1.3.cmml">novel</mi><mi id="S4.T4.9.6.2.2.2.m1.1.1.2.3" xref="S4.T4.9.6.2.2.2.m1.1.1.2.3.cmml">box</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.T4.9.6.2.2.2.m1.1b"><apply id="S4.T4.9.6.2.2.2.m1.1.1.cmml" xref="S4.T4.9.6.2.2.2.m1.1.1"><csymbol cd="ambiguous" id="S4.T4.9.6.2.2.2.m1.1.1.1.cmml" xref="S4.T4.9.6.2.2.2.m1.1.1">subscript</csymbol><apply id="S4.T4.9.6.2.2.2.m1.1.1.2.cmml" xref="S4.T4.9.6.2.2.2.m1.1.1"><csymbol cd="ambiguous" id="S4.T4.9.6.2.2.2.m1.1.1.2.1.cmml" xref="S4.T4.9.6.2.2.2.m1.1.1">superscript</csymbol><ci id="S4.T4.9.6.2.2.2.m1.1.1.2.2.cmml" xref="S4.T4.9.6.2.2.2.m1.1.1.2.2">mAP</ci><ci id="S4.T4.9.6.2.2.2.m1.1.1.2.3.cmml" xref="S4.T4.9.6.2.2.2.m1.1.1.2.3">box</ci></apply><ci id="S4.T4.9.6.2.2.2.m1.1.1.3.cmml" xref="S4.T4.9.6.2.2.2.m1.1.1.3">novel</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.9.6.2.2.2.m1.1c">\mathrm{mAP^{box}_{novel}}</annotation></semantics></math></th>
<th id="S4.T4.10.7.3.3.3" class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_tt"><math id="S4.T4.10.7.3.3.3.m1.1" class="ltx_Math" alttext="\mathrm{mAP^{box}}" display="inline"><semantics id="S4.T4.10.7.3.3.3.m1.1a"><msup id="S4.T4.10.7.3.3.3.m1.1.1" xref="S4.T4.10.7.3.3.3.m1.1.1.cmml"><mi id="S4.T4.10.7.3.3.3.m1.1.1.2" xref="S4.T4.10.7.3.3.3.m1.1.1.2.cmml">mAP</mi><mi id="S4.T4.10.7.3.3.3.m1.1.1.3" xref="S4.T4.10.7.3.3.3.m1.1.1.3.cmml">box</mi></msup><annotation-xml encoding="MathML-Content" id="S4.T4.10.7.3.3.3.m1.1b"><apply id="S4.T4.10.7.3.3.3.m1.1.1.cmml" xref="S4.T4.10.7.3.3.3.m1.1.1"><csymbol cd="ambiguous" id="S4.T4.10.7.3.3.3.m1.1.1.1.cmml" xref="S4.T4.10.7.3.3.3.m1.1.1">superscript</csymbol><ci id="S4.T4.10.7.3.3.3.m1.1.1.2.cmml" xref="S4.T4.10.7.3.3.3.m1.1.1.2">mAP</ci><ci id="S4.T4.10.7.3.3.3.m1.1.1.3.cmml" xref="S4.T4.10.7.3.3.3.m1.1.1.3">box</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.10.7.3.3.3.m1.1c">\mathrm{mAP^{box}}</annotation></semantics></math></th>
<th id="S4.T4.11.8.4.4.4" class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_tt"><math id="S4.T4.11.8.4.4.4.m1.1" class="ltx_Math" alttext="\mathrm{mAP^{mask}_{novel}}" display="inline"><semantics id="S4.T4.11.8.4.4.4.m1.1a"><msubsup id="S4.T4.11.8.4.4.4.m1.1.1" xref="S4.T4.11.8.4.4.4.m1.1.1.cmml"><mi id="S4.T4.11.8.4.4.4.m1.1.1.2.2" xref="S4.T4.11.8.4.4.4.m1.1.1.2.2.cmml">mAP</mi><mi id="S4.T4.11.8.4.4.4.m1.1.1.3" xref="S4.T4.11.8.4.4.4.m1.1.1.3.cmml">novel</mi><mi id="S4.T4.11.8.4.4.4.m1.1.1.2.3" xref="S4.T4.11.8.4.4.4.m1.1.1.2.3.cmml">mask</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.T4.11.8.4.4.4.m1.1b"><apply id="S4.T4.11.8.4.4.4.m1.1.1.cmml" xref="S4.T4.11.8.4.4.4.m1.1.1"><csymbol cd="ambiguous" id="S4.T4.11.8.4.4.4.m1.1.1.1.cmml" xref="S4.T4.11.8.4.4.4.m1.1.1">subscript</csymbol><apply id="S4.T4.11.8.4.4.4.m1.1.1.2.cmml" xref="S4.T4.11.8.4.4.4.m1.1.1"><csymbol cd="ambiguous" id="S4.T4.11.8.4.4.4.m1.1.1.2.1.cmml" xref="S4.T4.11.8.4.4.4.m1.1.1">superscript</csymbol><ci id="S4.T4.11.8.4.4.4.m1.1.1.2.2.cmml" xref="S4.T4.11.8.4.4.4.m1.1.1.2.2">mAP</ci><ci id="S4.T4.11.8.4.4.4.m1.1.1.2.3.cmml" xref="S4.T4.11.8.4.4.4.m1.1.1.2.3">mask</ci></apply><ci id="S4.T4.11.8.4.4.4.m1.1.1.3.cmml" xref="S4.T4.11.8.4.4.4.m1.1.1.3">novel</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.11.8.4.4.4.m1.1c">\mathrm{mAP^{mask}_{novel}}</annotation></semantics></math></th>
<th id="S4.T4.12.9.5.5.5" class="ltx_td ltx_nopad_r ltx_align_right ltx_th ltx_th_column ltx_border_tt"><math id="S4.T4.12.9.5.5.5.m1.1" class="ltx_Math" alttext="\mathrm{mAP^{mask}}" display="inline"><semantics id="S4.T4.12.9.5.5.5.m1.1a"><msup id="S4.T4.12.9.5.5.5.m1.1.1" xref="S4.T4.12.9.5.5.5.m1.1.1.cmml"><mi id="S4.T4.12.9.5.5.5.m1.1.1.2" xref="S4.T4.12.9.5.5.5.m1.1.1.2.cmml">mAP</mi><mi id="S4.T4.12.9.5.5.5.m1.1.1.3" xref="S4.T4.12.9.5.5.5.m1.1.1.3.cmml">mask</mi></msup><annotation-xml encoding="MathML-Content" id="S4.T4.12.9.5.5.5.m1.1b"><apply id="S4.T4.12.9.5.5.5.m1.1.1.cmml" xref="S4.T4.12.9.5.5.5.m1.1.1"><csymbol cd="ambiguous" id="S4.T4.12.9.5.5.5.m1.1.1.1.cmml" xref="S4.T4.12.9.5.5.5.m1.1.1">superscript</csymbol><ci id="S4.T4.12.9.5.5.5.m1.1.1.2.cmml" xref="S4.T4.12.9.5.5.5.m1.1.1.2">mAP</ci><ci id="S4.T4.12.9.5.5.5.m1.1.1.3.cmml" xref="S4.T4.12.9.5.5.5.m1.1.1.3">mask</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.12.9.5.5.5.m1.1c">\mathrm{mAP^{mask}}</annotation></semantics></math></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T4.12.9.5.6.1" class="ltx_tr">
<th id="S4.T4.12.9.5.6.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">0.0</th>
<td id="S4.T4.12.9.5.6.1.2" class="ltx_td ltx_align_right ltx_border_t">28.1</td>
<td id="S4.T4.12.9.5.6.1.3" class="ltx_td ltx_align_right ltx_border_t">30.8</td>
<td id="S4.T4.12.9.5.6.1.4" class="ltx_td ltx_align_right ltx_border_t">21.9</td>
<td id="S4.T4.12.9.5.6.1.5" class="ltx_td ltx_nopad_r ltx_align_right ltx_border_t">22.4</td>
</tr>
<tr id="S4.T4.12.9.5.7.2" class="ltx_tr">
<th id="S4.T4.12.9.5.7.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">0.1</th>
<td id="S4.T4.12.9.5.7.2.2" class="ltx_td ltx_align_right">28.7</td>
<td id="S4.T4.12.9.5.7.2.3" class="ltx_td ltx_align_right">32.3</td>
<td id="S4.T4.12.9.5.7.2.4" class="ltx_td ltx_align_right">22.6</td>
<td id="S4.T4.12.9.5.7.2.5" class="ltx_td ltx_nopad_r ltx_align_right">23.6</td>
</tr>
<tr id="S4.T4.12.9.5.8.3" class="ltx_tr">
<th id="S4.T4.12.9.5.8.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S4.T4.12.9.5.8.3.1.1" class="ltx_text ltx_font_bold">0.2</span></th>
<td id="S4.T4.12.9.5.8.3.2" class="ltx_td ltx_align_right"><span id="S4.T4.12.9.5.8.3.2.1" class="ltx_text ltx_font_bold">29.4</span></td>
<td id="S4.T4.12.9.5.8.3.3" class="ltx_td ltx_align_right"><span id="S4.T4.12.9.5.8.3.3.1" class="ltx_text ltx_font_bold">33.0</span></td>
<td id="S4.T4.12.9.5.8.3.4" class="ltx_td ltx_align_right"><span id="S4.T4.12.9.5.8.3.4.1" class="ltx_text ltx_font_bold">23.1</span></td>
<td id="S4.T4.12.9.5.8.3.5" class="ltx_td ltx_nopad_r ltx_align_right"><span id="S4.T4.12.9.5.8.3.5.1" class="ltx_text ltx_font_bold">24.2</span></td>
</tr>
<tr id="S4.T4.12.9.5.9.4" class="ltx_tr">
<th id="S4.T4.12.9.5.9.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">0.3</th>
<td id="S4.T4.12.9.5.9.4.2" class="ltx_td ltx_align_right">29.5</td>
<td id="S4.T4.12.9.5.9.4.3" class="ltx_td ltx_align_right">32.2</td>
<td id="S4.T4.12.9.5.9.4.4" class="ltx_td ltx_align_right">23.2</td>
<td id="S4.T4.12.9.5.9.4.5" class="ltx_td ltx_nopad_r ltx_align_right">23.7</td>
</tr>
<tr id="S4.T4.12.9.5.10.5" class="ltx_tr">
<th id="S4.T4.12.9.5.10.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">0.4</th>
<td id="S4.T4.12.9.5.10.5.2" class="ltx_td ltx_align_right">29.7</td>
<td id="S4.T4.12.9.5.10.5.3" class="ltx_td ltx_align_right">30.6</td>
<td id="S4.T4.12.9.5.10.5.4" class="ltx_td ltx_align_right">23.3</td>
<td id="S4.T4.12.9.5.10.5.5" class="ltx_td ltx_nopad_r ltx_align_right">22.5</td>
</tr>
<tr id="S4.T4.12.9.5.11.6" class="ltx_tr">
<th id="S4.T4.12.9.5.11.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">0.5</th>
<td id="S4.T4.12.9.5.11.6.2" class="ltx_td ltx_align_right">29.9</td>
<td id="S4.T4.12.9.5.11.6.3" class="ltx_td ltx_align_right">28.8</td>
<td id="S4.T4.12.9.5.11.6.4" class="ltx_td ltx_align_right">23.5</td>
<td id="S4.T4.12.9.5.11.6.5" class="ltx_td ltx_nopad_r ltx_align_right">21.2</td>
</tr>
<tr id="S4.T4.12.9.5.12.7" class="ltx_tr">
<th id="S4.T4.12.9.5.12.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb">1.0</th>
<td id="S4.T4.12.9.5.12.7.2" class="ltx_td ltx_align_right ltx_border_bb">30.5</td>
<td id="S4.T4.12.9.5.12.7.3" class="ltx_td ltx_align_right ltx_border_bb">14.5</td>
<td id="S4.T4.12.9.5.12.7.4" class="ltx_td ltx_align_right ltx_border_bb">24.0</td>
<td id="S4.T4.12.9.5.12.7.5" class="ltx_td ltx_nopad_r ltx_align_right ltx_border_bb">10.8</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S4.T4.21" class="ltx_figure ltx_figure_panel ltx_parbox ltx_align_middle" style="width:143.1pt;">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.T4.21.10.3.1" class="ltx_text" style="font-size:90%;">Table 4</span>: </span><span id="S4.T4.16.4.2" class="ltx_text" style="font-size:90%;">Performance with varying <math id="S4.T4.15.3.1.m1.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S4.T4.15.3.1.m1.1b"><mi id="S4.T4.15.3.1.m1.1.1" xref="S4.T4.15.3.1.m1.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S4.T4.15.3.1.m1.1c"><ci id="S4.T4.15.3.1.m1.1.1.cmml" xref="S4.T4.15.3.1.m1.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.15.3.1.m1.1d">\beta</annotation></semantics></math> when fixing <math id="S4.T4.16.4.2.m2.1" class="ltx_Math" alttext="\alpha=0.2" display="inline"><semantics id="S4.T4.16.4.2.m2.1b"><mrow id="S4.T4.16.4.2.m2.1.1" xref="S4.T4.16.4.2.m2.1.1.cmml"><mi id="S4.T4.16.4.2.m2.1.1.2" xref="S4.T4.16.4.2.m2.1.1.2.cmml">α</mi><mo id="S4.T4.16.4.2.m2.1.1.1" xref="S4.T4.16.4.2.m2.1.1.1.cmml">=</mo><mn id="S4.T4.16.4.2.m2.1.1.3" xref="S4.T4.16.4.2.m2.1.1.3.cmml">0.2</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T4.16.4.2.m2.1c"><apply id="S4.T4.16.4.2.m2.1.1.cmml" xref="S4.T4.16.4.2.m2.1.1"><eq id="S4.T4.16.4.2.m2.1.1.1.cmml" xref="S4.T4.16.4.2.m2.1.1.1"></eq><ci id="S4.T4.16.4.2.m2.1.1.2.cmml" xref="S4.T4.16.4.2.m2.1.1.2">𝛼</ci><cn type="float" id="S4.T4.16.4.2.m2.1.1.3.cmml" xref="S4.T4.16.4.2.m2.1.1.3">0.2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.16.4.2.m2.1d">\alpha=0.2</annotation></semantics></math>.</span></figcaption>
<div id="S4.T4.21.9" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:325.8pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(115.0pt,-86.4pt) scale(2.12910993517007,2.12910993517007) ;">
<table id="S4.T4.21.9.5" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T4.21.9.5.5" class="ltx_tr">
<th id="S4.T4.17.5.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt"><math id="S4.T4.17.5.1.1.1.m1.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S4.T4.17.5.1.1.1.m1.1a"><mi id="S4.T4.17.5.1.1.1.m1.1.1" xref="S4.T4.17.5.1.1.1.m1.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S4.T4.17.5.1.1.1.m1.1b"><ci id="S4.T4.17.5.1.1.1.m1.1.1.cmml" xref="S4.T4.17.5.1.1.1.m1.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.17.5.1.1.1.m1.1c">\beta</annotation></semantics></math></th>
<th id="S4.T4.18.6.2.2.2" class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_tt"><math id="S4.T4.18.6.2.2.2.m1.1" class="ltx_Math" alttext="\mathrm{mAP^{box}_{novel}}" display="inline"><semantics id="S4.T4.18.6.2.2.2.m1.1a"><msubsup id="S4.T4.18.6.2.2.2.m1.1.1" xref="S4.T4.18.6.2.2.2.m1.1.1.cmml"><mi id="S4.T4.18.6.2.2.2.m1.1.1.2.2" xref="S4.T4.18.6.2.2.2.m1.1.1.2.2.cmml">mAP</mi><mi id="S4.T4.18.6.2.2.2.m1.1.1.3" xref="S4.T4.18.6.2.2.2.m1.1.1.3.cmml">novel</mi><mi id="S4.T4.18.6.2.2.2.m1.1.1.2.3" xref="S4.T4.18.6.2.2.2.m1.1.1.2.3.cmml">box</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.T4.18.6.2.2.2.m1.1b"><apply id="S4.T4.18.6.2.2.2.m1.1.1.cmml" xref="S4.T4.18.6.2.2.2.m1.1.1"><csymbol cd="ambiguous" id="S4.T4.18.6.2.2.2.m1.1.1.1.cmml" xref="S4.T4.18.6.2.2.2.m1.1.1">subscript</csymbol><apply id="S4.T4.18.6.2.2.2.m1.1.1.2.cmml" xref="S4.T4.18.6.2.2.2.m1.1.1"><csymbol cd="ambiguous" id="S4.T4.18.6.2.2.2.m1.1.1.2.1.cmml" xref="S4.T4.18.6.2.2.2.m1.1.1">superscript</csymbol><ci id="S4.T4.18.6.2.2.2.m1.1.1.2.2.cmml" xref="S4.T4.18.6.2.2.2.m1.1.1.2.2">mAP</ci><ci id="S4.T4.18.6.2.2.2.m1.1.1.2.3.cmml" xref="S4.T4.18.6.2.2.2.m1.1.1.2.3">box</ci></apply><ci id="S4.T4.18.6.2.2.2.m1.1.1.3.cmml" xref="S4.T4.18.6.2.2.2.m1.1.1.3">novel</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.18.6.2.2.2.m1.1c">\mathrm{mAP^{box}_{novel}}</annotation></semantics></math></th>
<th id="S4.T4.19.7.3.3.3" class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_tt"><math id="S4.T4.19.7.3.3.3.m1.1" class="ltx_Math" alttext="\mathrm{mAP^{box}}" display="inline"><semantics id="S4.T4.19.7.3.3.3.m1.1a"><msup id="S4.T4.19.7.3.3.3.m1.1.1" xref="S4.T4.19.7.3.3.3.m1.1.1.cmml"><mi id="S4.T4.19.7.3.3.3.m1.1.1.2" xref="S4.T4.19.7.3.3.3.m1.1.1.2.cmml">mAP</mi><mi id="S4.T4.19.7.3.3.3.m1.1.1.3" xref="S4.T4.19.7.3.3.3.m1.1.1.3.cmml">box</mi></msup><annotation-xml encoding="MathML-Content" id="S4.T4.19.7.3.3.3.m1.1b"><apply id="S4.T4.19.7.3.3.3.m1.1.1.cmml" xref="S4.T4.19.7.3.3.3.m1.1.1"><csymbol cd="ambiguous" id="S4.T4.19.7.3.3.3.m1.1.1.1.cmml" xref="S4.T4.19.7.3.3.3.m1.1.1">superscript</csymbol><ci id="S4.T4.19.7.3.3.3.m1.1.1.2.cmml" xref="S4.T4.19.7.3.3.3.m1.1.1.2">mAP</ci><ci id="S4.T4.19.7.3.3.3.m1.1.1.3.cmml" xref="S4.T4.19.7.3.3.3.m1.1.1.3">box</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.19.7.3.3.3.m1.1c">\mathrm{mAP^{box}}</annotation></semantics></math></th>
<th id="S4.T4.20.8.4.4.4" class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_tt"><math id="S4.T4.20.8.4.4.4.m1.1" class="ltx_Math" alttext="\mathrm{mAP^{mask}_{novel}}" display="inline"><semantics id="S4.T4.20.8.4.4.4.m1.1a"><msubsup id="S4.T4.20.8.4.4.4.m1.1.1" xref="S4.T4.20.8.4.4.4.m1.1.1.cmml"><mi id="S4.T4.20.8.4.4.4.m1.1.1.2.2" xref="S4.T4.20.8.4.4.4.m1.1.1.2.2.cmml">mAP</mi><mi id="S4.T4.20.8.4.4.4.m1.1.1.3" xref="S4.T4.20.8.4.4.4.m1.1.1.3.cmml">novel</mi><mi id="S4.T4.20.8.4.4.4.m1.1.1.2.3" xref="S4.T4.20.8.4.4.4.m1.1.1.2.3.cmml">mask</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.T4.20.8.4.4.4.m1.1b"><apply id="S4.T4.20.8.4.4.4.m1.1.1.cmml" xref="S4.T4.20.8.4.4.4.m1.1.1"><csymbol cd="ambiguous" id="S4.T4.20.8.4.4.4.m1.1.1.1.cmml" xref="S4.T4.20.8.4.4.4.m1.1.1">subscript</csymbol><apply id="S4.T4.20.8.4.4.4.m1.1.1.2.cmml" xref="S4.T4.20.8.4.4.4.m1.1.1"><csymbol cd="ambiguous" id="S4.T4.20.8.4.4.4.m1.1.1.2.1.cmml" xref="S4.T4.20.8.4.4.4.m1.1.1">superscript</csymbol><ci id="S4.T4.20.8.4.4.4.m1.1.1.2.2.cmml" xref="S4.T4.20.8.4.4.4.m1.1.1.2.2">mAP</ci><ci id="S4.T4.20.8.4.4.4.m1.1.1.2.3.cmml" xref="S4.T4.20.8.4.4.4.m1.1.1.2.3">mask</ci></apply><ci id="S4.T4.20.8.4.4.4.m1.1.1.3.cmml" xref="S4.T4.20.8.4.4.4.m1.1.1.3">novel</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.20.8.4.4.4.m1.1c">\mathrm{mAP^{mask}_{novel}}</annotation></semantics></math></th>
<th id="S4.T4.21.9.5.5.5" class="ltx_td ltx_nopad_r ltx_align_right ltx_th ltx_th_column ltx_border_tt"><math id="S4.T4.21.9.5.5.5.m1.1" class="ltx_Math" alttext="\mathrm{mAP^{mask}}" display="inline"><semantics id="S4.T4.21.9.5.5.5.m1.1a"><msup id="S4.T4.21.9.5.5.5.m1.1.1" xref="S4.T4.21.9.5.5.5.m1.1.1.cmml"><mi id="S4.T4.21.9.5.5.5.m1.1.1.2" xref="S4.T4.21.9.5.5.5.m1.1.1.2.cmml">mAP</mi><mi id="S4.T4.21.9.5.5.5.m1.1.1.3" xref="S4.T4.21.9.5.5.5.m1.1.1.3.cmml">mask</mi></msup><annotation-xml encoding="MathML-Content" id="S4.T4.21.9.5.5.5.m1.1b"><apply id="S4.T4.21.9.5.5.5.m1.1.1.cmml" xref="S4.T4.21.9.5.5.5.m1.1.1"><csymbol cd="ambiguous" id="S4.T4.21.9.5.5.5.m1.1.1.1.cmml" xref="S4.T4.21.9.5.5.5.m1.1.1">superscript</csymbol><ci id="S4.T4.21.9.5.5.5.m1.1.1.2.cmml" xref="S4.T4.21.9.5.5.5.m1.1.1.2">mAP</ci><ci id="S4.T4.21.9.5.5.5.m1.1.1.3.cmml" xref="S4.T4.21.9.5.5.5.m1.1.1.3">mask</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.21.9.5.5.5.m1.1c">\mathrm{mAP^{mask}}</annotation></semantics></math></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T4.21.9.5.6.1" class="ltx_tr">
<th id="S4.T4.21.9.5.6.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">0.0</th>
<td id="S4.T4.21.9.5.6.1.2" class="ltx_td ltx_align_right ltx_border_t">15.9</td>
<td id="S4.T4.21.9.5.6.1.3" class="ltx_td ltx_align_right ltx_border_t">30.0</td>
<td id="S4.T4.21.9.5.6.1.4" class="ltx_td ltx_align_right ltx_border_t">12.1</td>
<td id="S4.T4.21.9.5.6.1.5" class="ltx_td ltx_nopad_r ltx_align_right ltx_border_t">21.7</td>
</tr>
<tr id="S4.T4.21.9.5.7.2" class="ltx_tr">
<th id="S4.T4.21.9.5.7.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">0.1</th>
<td id="S4.T4.21.9.5.7.2.2" class="ltx_td ltx_align_right">22.8</td>
<td id="S4.T4.21.9.5.7.2.3" class="ltx_td ltx_align_right">31.4</td>
<td id="S4.T4.21.9.5.7.2.4" class="ltx_td ltx_align_right">17.9</td>
<td id="S4.T4.21.9.5.7.2.5" class="ltx_td ltx_nopad_r ltx_align_right">22.9</td>
</tr>
<tr id="S4.T4.21.9.5.8.3" class="ltx_tr">
<th id="S4.T4.21.9.5.8.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">0.2</th>
<td id="S4.T4.21.9.5.8.3.2" class="ltx_td ltx_align_right">29.0</td>
<td id="S4.T4.21.9.5.8.3.3" class="ltx_td ltx_align_right">32.7</td>
<td id="S4.T4.21.9.5.8.3.4" class="ltx_td ltx_align_right">22.5</td>
<td id="S4.T4.21.9.5.8.3.5" class="ltx_td ltx_nopad_r ltx_align_right">23.9</td>
</tr>
<tr id="S4.T4.21.9.5.9.4" class="ltx_tr">
<th id="S4.T4.21.9.5.9.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">0.3</th>
<td id="S4.T4.21.9.5.9.4.2" class="ltx_td ltx_align_right">29.3</td>
<td id="S4.T4.21.9.5.9.4.3" class="ltx_td ltx_align_right">33.0</td>
<td id="S4.T4.21.9.5.9.4.4" class="ltx_td ltx_align_right">23.0</td>
<td id="S4.T4.21.9.5.9.4.5" class="ltx_td ltx_nopad_r ltx_align_right">24.1</td>
</tr>
<tr id="S4.T4.21.9.5.10.5" class="ltx_tr">
<th id="S4.T4.21.9.5.10.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S4.T4.21.9.5.10.5.1.1" class="ltx_text ltx_font_bold">0.4</span></th>
<td id="S4.T4.21.9.5.10.5.2" class="ltx_td ltx_align_right"><span id="S4.T4.21.9.5.10.5.2.1" class="ltx_text ltx_font_bold">29.3</span></td>
<td id="S4.T4.21.9.5.10.5.3" class="ltx_td ltx_align_right"><span id="S4.T4.21.9.5.10.5.3.1" class="ltx_text ltx_font_bold">33.0</span></td>
<td id="S4.T4.21.9.5.10.5.4" class="ltx_td ltx_align_right"><span id="S4.T4.21.9.5.10.5.4.1" class="ltx_text ltx_font_bold">23.1</span></td>
<td id="S4.T4.21.9.5.10.5.5" class="ltx_td ltx_nopad_r ltx_align_right"><span id="S4.T4.21.9.5.10.5.5.1" class="ltx_text ltx_font_bold">24.2</span></td>
</tr>
<tr id="S4.T4.21.9.5.11.6" class="ltx_tr">
<th id="S4.T4.21.9.5.11.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">0.5</th>
<td id="S4.T4.21.9.5.11.6.2" class="ltx_td ltx_align_right">28.6</td>
<td id="S4.T4.21.9.5.11.6.3" class="ltx_td ltx_align_right">33.0</td>
<td id="S4.T4.21.9.5.11.6.4" class="ltx_td ltx_align_right">22.4</td>
<td id="S4.T4.21.9.5.11.6.5" class="ltx_td ltx_nopad_r ltx_align_right">24.1</td>
</tr>
<tr id="S4.T4.21.9.5.12.7" class="ltx_tr">
<th id="S4.T4.21.9.5.12.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb">1.0</th>
<td id="S4.T4.21.9.5.12.7.2" class="ltx_td ltx_align_right ltx_border_bb">19.6</td>
<td id="S4.T4.21.9.5.12.7.3" class="ltx_td ltx_align_right ltx_border_bb">31.5</td>
<td id="S4.T4.21.9.5.12.7.4" class="ltx_td ltx_align_right ltx_border_bb">15.3</td>
<td id="S4.T4.21.9.5.12.7.5" class="ltx_td ltx_nopad_r ltx_align_right ltx_border_bb">22.9</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
</div>
</div>
</figure>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Evaluation</h2>

<div id="S5.p1" class="ltx_para ltx_noindent">
<p id="S5.p1.1" class="ltx_p"><span id="S5.p1.1.1" class="ltx_text ltx_font_bold">Datasets.</span> We evaluate our approach on two popularly used benchmark datasets, namely OV-COCO and OV-LVIS, each of which is modified from MS-COCO <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite> and LVIS (v1) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>; OV-COCO has 121K images with 64 classes while OV-LVIS has 100K images with 1,203 classes.
Following OV-DETR <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite>, COCO is split into 17 novel classes and 48 base classes. LVIS is split into three categories: 337 novel classes, and 866 common or base classes based on the number of training images. Note that we refer to the two datasets as OV-COCO and OV-LVIS, respectively, and only base classes are used for training.</p>
</div>
<div id="S5.p2" class="ltx_para ltx_noindent">
<p id="S5.p2.1" class="ltx_p"><span id="S5.p2.1.1" class="ltx_text ltx_font_bold">Algorithms.</span> We compare Prompt-OVD with an end-to-end OVD detection model named OV-DETR <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite> (baseline) and four two-stage OVD models. However, it should be noted that the two-stage OVD models are based on Mask-RCNN or allow the use of external large-scale data, which makes a fair comparison with the end-to-end Transformer-based detectors difficult. Therefore, to ensure a fair comparison, we follow two criteria: (1) the results should be obtained by only using base categories in training, i.e., the restricted OVD setup and (2) the models’ inference speed should be in the range of 0.4 – 0.7 seconds/image, which is similar to that of our proposed framework.</p>
</div>
<div id="S5.p3" class="ltx_para ltx_noindent">
<p id="S5.p3.1" class="ltx_p"><span id="S5.p3.1.1" class="ltx_text ltx_font_bold">Implementation.</span> The proposed Prompt-OVD builds upon Deformable DETR <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib33" title="" class="ltx_ref">33</a>]</cite>, similar to OV-DETR. However, we merge the independent ResNet backbone and Transformer encoder into a single ViT encoder using ViTDet <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>. As a result, our architecture is a purely Transformer encoder-decoder structure, following recent fully Transformer detection pipeline <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>, <a href="#bib.bib27" title="" class="ltx_ref">27</a>]</cite>.</p>
</div>
<div id="S5.p4" class="ltx_para">
<p id="S5.p4.1" class="ltx_p">For training, we initialize the backbone weights with a plain ViT backbone that has been pre-trained as Masked Autoencoders on ImageNet-1K. The entire model is then trained end-to-end for 50 epochs with a batch size of 32, a weight decay of 1e-4, and an AdamW optimizer. We set the initial learning rate to 2e-4 while using an image size of 840<math id="S5.p4.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S5.p4.1.m1.1a"><mo id="S5.p4.1.m1.1.1" xref="S5.p4.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S5.p4.1.m1.1b"><times id="S5.p4.1.m1.1.1.cmml" xref="S5.p4.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S5.p4.1.m1.1c">\times</annotation></semantics></math>840. We implement and test all algorithms using PyTorch on eight NVIDIA V100 GPUs.</p>
</div>
<div id="S5.p5" class="ltx_para">
<p id="S5.p5.6" class="ltx_p">For inference, there are three hyperparameters: the weights <math id="S5.p5.1.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S5.p5.1.m1.1a"><mi id="S5.p5.1.m1.1.1" xref="S5.p5.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S5.p5.1.m1.1b"><ci id="S5.p5.1.m1.1.1.cmml" xref="S5.p5.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.p5.1.m1.1c">\alpha</annotation></semantics></math> and <math id="S5.p5.2.m2.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S5.p5.2.m2.1a"><mi id="S5.p5.2.m2.1.1" xref="S5.p5.2.m2.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S5.p5.2.m2.1b"><ci id="S5.p5.2.m2.1.1.cmml" xref="S5.p5.2.m2.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.p5.2.m2.1c">\beta</annotation></semantics></math> for ensembling in Eq. (<a href="#S4.E9" title="In 4.2 Ensemble with ViT-based CLIP ‣ 4 Prompt-OVD ‣ ​​Prompt-Guided Transformers for End-to-End Open-Vocabulary Object Detection​​" class="ltx_ref"><span class="ltx_text ltx_ref_tag">9</span></a>); the threshold <math id="S5.p5.3.m3.1" class="ltx_Math" alttext="\epsilon" display="inline"><semantics id="S5.p5.3.m3.1a"><mi id="S5.p5.3.m3.1.1" xref="S5.p5.3.m3.1.1.cmml">ϵ</mi><annotation-xml encoding="MathML-Content" id="S5.p5.3.m3.1b"><ci id="S5.p5.3.m3.1.1.cmml" xref="S5.p5.3.m3.1.1">italic-ϵ</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.p5.3.m3.1c">\epsilon</annotation></semantics></math> for RoI pruning in Eq. (<a href="#S4.E10" title="In 4.2.1 RoI-based Masked Attention ‣ 4.2 Ensemble with ViT-based CLIP ‣ 4 Prompt-OVD ‣ ​​Prompt-Guided Transformers for End-to-End Open-Vocabulary Object Detection​​" class="ltx_ref"><span class="ltx_text ltx_ref_tag">10</span></a>). The former weights are set to be <math id="S5.p5.4.m4.2" class="ltx_Math" alttext="(0.2,0.35)" display="inline"><semantics id="S5.p5.4.m4.2a"><mrow id="S5.p5.4.m4.2.3.2" xref="S5.p5.4.m4.2.3.1.cmml"><mo stretchy="false" id="S5.p5.4.m4.2.3.2.1" xref="S5.p5.4.m4.2.3.1.cmml">(</mo><mn id="S5.p5.4.m4.1.1" xref="S5.p5.4.m4.1.1.cmml">0.2</mn><mo id="S5.p5.4.m4.2.3.2.2" xref="S5.p5.4.m4.2.3.1.cmml">,</mo><mn id="S5.p5.4.m4.2.2" xref="S5.p5.4.m4.2.2.cmml">0.35</mn><mo stretchy="false" id="S5.p5.4.m4.2.3.2.3" xref="S5.p5.4.m4.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.p5.4.m4.2b"><interval closure="open" id="S5.p5.4.m4.2.3.1.cmml" xref="S5.p5.4.m4.2.3.2"><cn type="float" id="S5.p5.4.m4.1.1.cmml" xref="S5.p5.4.m4.1.1">0.2</cn><cn type="float" id="S5.p5.4.m4.2.2.cmml" xref="S5.p5.4.m4.2.2">0.35</cn></interval></annotation-xml><annotation encoding="application/x-tex" id="S5.p5.4.m4.2c">(0.2,0.35)</annotation></semantics></math> and <math id="S5.p5.5.m5.2" class="ltx_Math" alttext="(0.2,0.4)" display="inline"><semantics id="S5.p5.5.m5.2a"><mrow id="S5.p5.5.m5.2.3.2" xref="S5.p5.5.m5.2.3.1.cmml"><mo stretchy="false" id="S5.p5.5.m5.2.3.2.1" xref="S5.p5.5.m5.2.3.1.cmml">(</mo><mn id="S5.p5.5.m5.1.1" xref="S5.p5.5.m5.1.1.cmml">0.2</mn><mo id="S5.p5.5.m5.2.3.2.2" xref="S5.p5.5.m5.2.3.1.cmml">,</mo><mn id="S5.p5.5.m5.2.2" xref="S5.p5.5.m5.2.2.cmml">0.4</mn><mo stretchy="false" id="S5.p5.5.m5.2.3.2.3" xref="S5.p5.5.m5.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.p5.5.m5.2b"><interval closure="open" id="S5.p5.5.m5.2.3.1.cmml" xref="S5.p5.5.m5.2.3.2"><cn type="float" id="S5.p5.5.m5.1.1.cmml" xref="S5.p5.5.m5.1.1">0.2</cn><cn type="float" id="S5.p5.5.m5.2.2.cmml" xref="S5.p5.5.m5.2.2">0.4</cn></interval></annotation-xml><annotation encoding="application/x-tex" id="S5.p5.5.m5.2c">(0.2,0.4)</annotation></semantics></math> for OV-COCO and OV-LVIS, while the latter pruning threshold is set to 0.125 and 0.3 for OV-COCO and OV-LVIS. As for the ensemble for classification, we leverage the CLIP model that uses ViT-L/14 as its image encoder with a image size of 336<math id="S5.p5.6.m6.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S5.p5.6.m6.1a"><mo id="S5.p5.6.m6.1.1" xref="S5.p5.6.m6.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S5.p5.6.m6.1b"><times id="S5.p5.6.m6.1.1.cmml" xref="S5.p5.6.m6.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S5.p5.6.m6.1c">\times</annotation></semantics></math>336, which adds very little computational overhead with our RoI-based masked attention and RoI pruning. The detailed analysis of the hyperparameters and additional overhead due to using CLIP is provided in Section <a href="#S5.SS2" title="5.2 Main Ablation Study ‣ 5 Evaluation ‣ ​​Prompt-Guided Transformers for End-to-End Open-Vocabulary Object Detection​​" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5.2</span></a>.</p>
</div>
<div id="S5.p6" class="ltx_para">
<p id="S5.p6.1" class="ltx_p">In addition, we need to incorporate the mask head into our model for the evaluation on OV-LVIS, as RPN-based two-stage methods have reported both box and mask APs. Following the recent literature <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>, <a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite>, we extend our DETR-based detector using SOLQ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>, which can perform a joint training of object detection and instance segmentation by simply adding a unified query representation module. The mask vector size is set to be 1,024 while keeping remaining hyperparameters to be the same as SOLQ.</p>
</div>
<div id="S5.p7" class="ltx_para ltx_noindent">
<p id="S5.p7.3" class="ltx_p"><span id="S5.p7.3.1" class="ltx_text ltx_font_bold">Evaluation Metrics.</span> We evaluate the detection accuracy of our method following exactly the same metrics used in prior OVD studies <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>, <a href="#bib.bib29" title="" class="ltx_ref">29</a>, <a href="#bib.bib31" title="" class="ltx_ref">31</a>, <a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite>. Specifically, for OV-COCO, we use <math id="S5.p7.1.m1.1" class="ltx_Math" alttext="\mathrm{mAP^{50}}" display="inline"><semantics id="S5.p7.1.m1.1a"><msup id="S5.p7.1.m1.1.1" xref="S5.p7.1.m1.1.1.cmml"><mi id="S5.p7.1.m1.1.1.2" xref="S5.p7.1.m1.1.1.2.cmml">mAP</mi><mn id="S5.p7.1.m1.1.1.3" xref="S5.p7.1.m1.1.1.3.cmml">50</mn></msup><annotation-xml encoding="MathML-Content" id="S5.p7.1.m1.1b"><apply id="S5.p7.1.m1.1.1.cmml" xref="S5.p7.1.m1.1.1"><csymbol cd="ambiguous" id="S5.p7.1.m1.1.1.1.cmml" xref="S5.p7.1.m1.1.1">superscript</csymbol><ci id="S5.p7.1.m1.1.1.2.cmml" xref="S5.p7.1.m1.1.1.2">mAP</ci><cn type="integer" id="S5.p7.1.m1.1.1.3.cmml" xref="S5.p7.1.m1.1.1.3">50</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p7.1.m1.1c">\mathrm{mAP^{50}}</annotation></semantics></math> which is a measure of the box average precision (AP) with an IoU threshold of 0.5. On the other hand, for OV-LVIS, we use both box mAP (<math id="S5.p7.2.m2.1" class="ltx_Math" alttext="\mathrm{mAP^{box}}" display="inline"><semantics id="S5.p7.2.m2.1a"><msup id="S5.p7.2.m2.1.1" xref="S5.p7.2.m2.1.1.cmml"><mi id="S5.p7.2.m2.1.1.2" xref="S5.p7.2.m2.1.1.2.cmml">mAP</mi><mi id="S5.p7.2.m2.1.1.3" xref="S5.p7.2.m2.1.1.3.cmml">box</mi></msup><annotation-xml encoding="MathML-Content" id="S5.p7.2.m2.1b"><apply id="S5.p7.2.m2.1.1.cmml" xref="S5.p7.2.m2.1.1"><csymbol cd="ambiguous" id="S5.p7.2.m2.1.1.1.cmml" xref="S5.p7.2.m2.1.1">superscript</csymbol><ci id="S5.p7.2.m2.1.1.2.cmml" xref="S5.p7.2.m2.1.1.2">mAP</ci><ci id="S5.p7.2.m2.1.1.3.cmml" xref="S5.p7.2.m2.1.1.3">box</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p7.2.m2.1c">\mathrm{mAP^{box}}</annotation></semantics></math>) and mask mAP (<math id="S5.p7.3.m3.1" class="ltx_Math" alttext="\mathrm{mAP^{mask}}" display="inline"><semantics id="S5.p7.3.m3.1a"><msup id="S5.p7.3.m3.1.1" xref="S5.p7.3.m3.1.1.cmml"><mi id="S5.p7.3.m3.1.1.2" xref="S5.p7.3.m3.1.1.2.cmml">mAP</mi><mi id="S5.p7.3.m3.1.1.3" xref="S5.p7.3.m3.1.1.3.cmml">mask</mi></msup><annotation-xml encoding="MathML-Content" id="S5.p7.3.m3.1b"><apply id="S5.p7.3.m3.1.1.cmml" xref="S5.p7.3.m3.1.1"><csymbol cd="ambiguous" id="S5.p7.3.m3.1.1.1.cmml" xref="S5.p7.3.m3.1.1">superscript</csymbol><ci id="S5.p7.3.m3.1.1.2.cmml" xref="S5.p7.3.m3.1.1.2">mAP</ci><ci id="S5.p7.3.m3.1.1.3.cmml" xref="S5.p7.3.m3.1.1.3">mask</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p7.3.m3.1c">\mathrm{mAP^{mask}}</annotation></semantics></math>) obtained by the joint learning of object detection and instance segmentation, respectively.</p>
</div>
<div id="S5.p8" class="ltx_para">
<p id="S5.p8.1" class="ltx_p">Inference time is also a crucial metric for practical applications. To compare the efficiency of different models, we compute the inference time of all methods using the same hardware environment, consisting of a single NVIDIA V100 GPU and six Intel(R) Xeon(R) Gold 5120 CPUs. To ensure an accurate inference time measurement, we calculate the average time of 100 iterations after five initial iterations, using a batch size of 1.</p>
</div>
<section id="S5.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1 </span>Main Experiment</h3>

<div id="S5.SS1.p1" class="ltx_para">
<p id="S5.SS1.p1.1" class="ltx_p">We present a comprehensive comparison of Prompt-OVD with other five OVD methods in terms of detection accuracy and speed. To ensure a fair comparison, we only include the results of RCNN-based methods that can operate at a similar inference speed as ours. Table <a href="#S4.T1" title="Table 1 ‣ 4.3 Training and Evaluation Pipeline ‣ 4 Prompt-OVD ‣ ​​Prompt-Guided Transformers for End-to-End Open-Vocabulary Object Detection​​" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> summarizes the results of Prompt-OVD and other five OVD methods.</p>
</div>
<div id="S5.SS1.p2" class="ltx_para">
<p id="S5.SS1.p2.1" class="ltx_p">In general, Prompt-OVD outperforms the previous end-to-end OVD method, OV-DETR, on both datasets. Notably, Prompt-OVD’s inference speed is <math id="S5.SS1.p2.1.m1.1" class="ltx_Math" alttext="21.2" display="inline"><semantics id="S5.SS1.p2.1.m1.1a"><mn id="S5.SS1.p2.1.m1.1.1" xref="S5.SS1.p2.1.m1.1.1.cmml">21.2</mn><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.1.m1.1b"><cn type="float" id="S5.SS1.p2.1.m1.1.1.cmml" xref="S5.SS1.p2.1.m1.1.1">21.2</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.1.m1.1c">21.2</annotation></semantics></math> times faster than OV-DETR, thanks to its prompt-based decoding approach. Refer to Section <a href="#S5.SS2.SSS1" title="5.2.1 Inference Speed Up from OV-DETR ‣ 5.2 Main Ablation Study ‣ 5 Evaluation ‣ ​​Prompt-Guided Transformers for End-to-End Open-Vocabulary Object Detection​​" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5.2.1</span></a> for an in-depth comparison of efficiency with OV-DETR. Moreover, Prompt-OVD exhibits superior performance in terms of box mAP, even compared to RCNN-based OVD methods. These results support the effectiveness of our design that utilizes ViT-based CLIP with RoI-based mask attention and RoI pruning, improving the overall performance. Further investigation of the two techniques can be found in Section <a href="#S5.SS2.SSS3" title="5.2.3 RoI-based Masked Attention ‣ 5.2 Main Ablation Study ‣ 5 Evaluation ‣ ​​Prompt-Guided Transformers for End-to-End Open-Vocabulary Object Detection​​" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5.2.3</span></a> and  <a href="#S5.SS2.SSS5" title="5.2.5 RoI Pruning Threshold ‣ 5.2 Main Ablation Study ‣ 5 Evaluation ‣ ​​Prompt-Guided Transformers for End-to-End Open-Vocabulary Object Detection​​" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5.2.5</span></a>.</p>
</div>
<div id="S5.SS1.p3" class="ltx_para">
<p id="S5.SS1.p3.1" class="ltx_p">Although we observe a larger gap between box mAP and mask mAP (29.4 <math id="S5.SS1.p3.1.m1.1" class="ltx_math_unparsed" alttext="\mathrm{mAP^{box}_{novel}}\rightarrow 23.1\mathrm{mAP^{mask}_{novel}})" display="inline"><semantics id="S5.SS1.p3.1.m1.1a"><mrow id="S5.SS1.p3.1.m1.1b"><msubsup id="S5.SS1.p3.1.m1.1.1"><mi id="S5.SS1.p3.1.m1.1.1.2.2">mAP</mi><mi id="S5.SS1.p3.1.m1.1.1.3">novel</mi><mi id="S5.SS1.p3.1.m1.1.1.2.3">box</mi></msubsup><mo stretchy="false" id="S5.SS1.p3.1.m1.1.2">→</mo><mn id="S5.SS1.p3.1.m1.1.3">23.1</mn><msubsup id="S5.SS1.p3.1.m1.1.4"><mi id="S5.SS1.p3.1.m1.1.4.2.2">mAP</mi><mi id="S5.SS1.p3.1.m1.1.4.3">novel</mi><mi id="S5.SS1.p3.1.m1.1.4.2.3">mask</mi></msubsup><mo stretchy="false" id="S5.SS1.p3.1.m1.1.5">)</mo></mrow><annotation encoding="application/x-tex" id="S5.SS1.p3.1.m1.1c">\mathrm{mAP^{box}_{novel}}\rightarrow 23.1\mathrm{mAP^{mask}_{novel}})</annotation></semantics></math>, this is a result of inheriting the limitation of SOLQ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>. Specifically, the vector encoding of 2D segmentation masks using discrete cosine transformation loses object details compared to the conventional FPN-style mask head <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite>.
Furthermore, despite using a larger ViT-B/16 backbone than ResNet-50, Prompt-OVD exhibits comparable inference time to RCNN-based methods, thanks to its simple encoding-decoding pipeline. Therefore, our results demonstrate that Prompt-OVD shows a potential of the end-to-end Transformer-based framework for OVD.</p>
</div>
<div id="S5.SS1.p4" class="ltx_para">
<p id="S5.SS1.p4.1" class="ltx_p">In Appendices B and C, we discuss potential enhancements to our method and present the results of our experiments on using image queries other than text queries for open-vocabulary object detection, respectively.</p>
</div>
<figure id="S5.F4" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><img src="/html/2303.14386/assets/x4.png" id="S5.F4.1.g1" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" width="505" height="188" alt="Refer to caption"></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure id="S5.F4.sf1" class="ltx_figure ltx_figure_panel">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S5.F4.sf1.2.1.1" class="ltx_text" style="font-size:90%;">(a)</span> </span><span id="S5.F4.sf1.3.2" class="ltx_text" style="font-size:90%;">GT</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure id="S5.F4.sf2" class="ltx_figure ltx_figure_panel">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S5.F4.sf2.2.1.1" class="ltx_text" style="font-size:90%;">(b)</span> </span><span id="S5.F4.sf2.3.2" class="ltx_text" style="font-size:90%;">RPN</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure id="S5.F4.sf3" class="ltx_figure ltx_figure_panel">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S5.F4.sf3.4.2.1" class="ltx_text" style="font-size:90%;">(c)</span> </span><span id="S5.F4.sf3.2.1" class="ltx_text" style="font-size:90%;">No pruning (<math id="S5.F4.sf3.2.1.m1.1" class="ltx_Math" alttext="\epsilon=0" display="inline"><semantics id="S5.F4.sf3.2.1.m1.1b"><mrow id="S5.F4.sf3.2.1.m1.1.1" xref="S5.F4.sf3.2.1.m1.1.1.cmml"><mi id="S5.F4.sf3.2.1.m1.1.1.2" xref="S5.F4.sf3.2.1.m1.1.1.2.cmml">ϵ</mi><mo id="S5.F4.sf3.2.1.m1.1.1.1" xref="S5.F4.sf3.2.1.m1.1.1.1.cmml">=</mo><mn id="S5.F4.sf3.2.1.m1.1.1.3" xref="S5.F4.sf3.2.1.m1.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.F4.sf3.2.1.m1.1c"><apply id="S5.F4.sf3.2.1.m1.1.1.cmml" xref="S5.F4.sf3.2.1.m1.1.1"><eq id="S5.F4.sf3.2.1.m1.1.1.1.cmml" xref="S5.F4.sf3.2.1.m1.1.1.1"></eq><ci id="S5.F4.sf3.2.1.m1.1.1.2.cmml" xref="S5.F4.sf3.2.1.m1.1.1.2">italic-ϵ</ci><cn type="integer" id="S5.F4.sf3.2.1.m1.1.1.3.cmml" xref="S5.F4.sf3.2.1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F4.sf3.2.1.m1.1d">\epsilon=0</annotation></semantics></math>)</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure id="S5.F4.sf4" class="ltx_figure ltx_figure_panel">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S5.F4.sf4.4.2.1" class="ltx_text" style="font-size:90%;">(d)</span> </span><span id="S5.F4.sf4.2.1" class="ltx_text" style="font-size:90%;">Pruning (<math id="S5.F4.sf4.2.1.m1.1" class="ltx_Math" alttext="\epsilon=0.3" display="inline"><semantics id="S5.F4.sf4.2.1.m1.1b"><mrow id="S5.F4.sf4.2.1.m1.1.1" xref="S5.F4.sf4.2.1.m1.1.1.cmml"><mi id="S5.F4.sf4.2.1.m1.1.1.2" xref="S5.F4.sf4.2.1.m1.1.1.2.cmml">ϵ</mi><mo id="S5.F4.sf4.2.1.m1.1.1.1" xref="S5.F4.sf4.2.1.m1.1.1.1.cmml">=</mo><mn id="S5.F4.sf4.2.1.m1.1.1.3" xref="S5.F4.sf4.2.1.m1.1.1.3.cmml">0.3</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.F4.sf4.2.1.m1.1c"><apply id="S5.F4.sf4.2.1.m1.1.1.cmml" xref="S5.F4.sf4.2.1.m1.1.1"><eq id="S5.F4.sf4.2.1.m1.1.1.1.cmml" xref="S5.F4.sf4.2.1.m1.1.1.1"></eq><ci id="S5.F4.sf4.2.1.m1.1.1.2.cmml" xref="S5.F4.sf4.2.1.m1.1.1.2">italic-ϵ</ci><cn type="float" id="S5.F4.sf4.2.1.m1.1.1.3.cmml" xref="S5.F4.sf4.2.1.m1.1.1.3">0.3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F4.sf4.2.1.m1.1d">\epsilon=0.3</annotation></semantics></math>)</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S5.F4.3.1.1" class="ltx_text" style="font-size:90%;">Figure 4</span>: </span><span id="S5.F4.4.2" class="ltx_text" style="font-size:90%;">Box predictions: (a) ground-truth boxes, (b) boxes estimated by RPN from DetPro <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>, (c)–(d) boxes estimated by Prompt-OVD without and with RoI pruning. Due to numerous predicted boxes in (b) and (c), we limit the number of boxes to 40 for better visualization. Red and green boxes are the ground-truth of novel and base classes, while blue and white ones represent predicted boxes that are either in close proximity or not in close proximity to the ground-truth, respectively.</span></figcaption>
</figure>
</section>
<section id="S5.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2 </span>Main Ablation Study</h3>

<section id="S5.SS2.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.2.1 </span>Inference Speed Up from OV-DETR</h4>

<div id="S5.SS2.SSS1.p1" class="ltx_para">
<p id="S5.SS2.SSS1.p1.1" class="ltx_p">Table <span class="ltx_ref ltx_missing_label ltx_ref_self">LABEL:table:modification</span> summarizes the change in inference speed when replacing each design component of OV-DETR with our proposed ones on OV-LVIS. (1) Despite having more parameters, using ViT-B/16 incurs little additional latency, as it rather reduces the computational burden for the multi-scale deformable attention of the DETR encoder. (2) The use of local attention and the replacement of the DETR encoder with a simple feature pyramid network, as suggested by <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>, <a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite>, result in a meaningful reduction in latency. (3) The primary speedup comes from replacing the decoding of OV-DETR with prompt-based decoding. (4) The ensemble with ViT-based CLIP only adds very little latency thanks to our efficient RoI-based masked attention. (6) RoI pruning also significantly contributes to speeding up by reducing the number of RoI candidates for detection and segmentation, without sacrificing detection accuracy. Overall, Prompt-OVD speeds up inference by <math id="S5.SS2.SSS1.p1.1.m1.1" class="ltx_Math" alttext="21.2" display="inline"><semantics id="S5.SS2.SSS1.p1.1.m1.1a"><mn id="S5.SS2.SSS1.p1.1.m1.1.1" xref="S5.SS2.SSS1.p1.1.m1.1.1.cmml">21.2</mn><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS1.p1.1.m1.1b"><cn type="float" id="S5.SS2.SSS1.p1.1.m1.1.1.cmml" xref="S5.SS2.SSS1.p1.1.m1.1.1">21.2</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS1.p1.1.m1.1c">21.2</annotation></semantics></math> times over OV-DETR.</p>
</div>
<figure id="S5.T5" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="S5.T5.6.1.1" class="ltx_text" style="font-size:90%;">Table 5</span>: </span><span id="S5.T5.7.2" class="ltx_text" style="font-size:90%;">Performance between RoI Align and RoI-based Masked Attention (RMA) on OV-LVIS.</span></figcaption>
<div id="S5.T5.4" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:156.3pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(42.0pt,-15.2pt) scale(1.24048662057087,1.24048662057087) ;">
<table id="S5.T5.4.4" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S5.T5.4.4.4" class="ltx_tr">
<th id="S5.T5.4.4.4.5" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt">RoI Proc.</th>
<th id="S5.T5.1.1.1.1" class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_tt"><math id="S5.T5.1.1.1.1.m1.1" class="ltx_Math" alttext="\mathrm{mAP^{box}_{novel}}" display="inline"><semantics id="S5.T5.1.1.1.1.m1.1a"><msubsup id="S5.T5.1.1.1.1.m1.1.1" xref="S5.T5.1.1.1.1.m1.1.1.cmml"><mi id="S5.T5.1.1.1.1.m1.1.1.2.2" xref="S5.T5.1.1.1.1.m1.1.1.2.2.cmml">mAP</mi><mi id="S5.T5.1.1.1.1.m1.1.1.3" xref="S5.T5.1.1.1.1.m1.1.1.3.cmml">novel</mi><mi id="S5.T5.1.1.1.1.m1.1.1.2.3" xref="S5.T5.1.1.1.1.m1.1.1.2.3.cmml">box</mi></msubsup><annotation-xml encoding="MathML-Content" id="S5.T5.1.1.1.1.m1.1b"><apply id="S5.T5.1.1.1.1.m1.1.1.cmml" xref="S5.T5.1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S5.T5.1.1.1.1.m1.1.1.1.cmml" xref="S5.T5.1.1.1.1.m1.1.1">subscript</csymbol><apply id="S5.T5.1.1.1.1.m1.1.1.2.cmml" xref="S5.T5.1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S5.T5.1.1.1.1.m1.1.1.2.1.cmml" xref="S5.T5.1.1.1.1.m1.1.1">superscript</csymbol><ci id="S5.T5.1.1.1.1.m1.1.1.2.2.cmml" xref="S5.T5.1.1.1.1.m1.1.1.2.2">mAP</ci><ci id="S5.T5.1.1.1.1.m1.1.1.2.3.cmml" xref="S5.T5.1.1.1.1.m1.1.1.2.3">box</ci></apply><ci id="S5.T5.1.1.1.1.m1.1.1.3.cmml" xref="S5.T5.1.1.1.1.m1.1.1.3">novel</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T5.1.1.1.1.m1.1c">\mathrm{mAP^{box}_{novel}}</annotation></semantics></math></th>
<th id="S5.T5.2.2.2.2" class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_tt"><math id="S5.T5.2.2.2.2.m1.1" class="ltx_Math" alttext="\mathrm{mAP^{box}}" display="inline"><semantics id="S5.T5.2.2.2.2.m1.1a"><msup id="S5.T5.2.2.2.2.m1.1.1" xref="S5.T5.2.2.2.2.m1.1.1.cmml"><mi id="S5.T5.2.2.2.2.m1.1.1.2" xref="S5.T5.2.2.2.2.m1.1.1.2.cmml">mAP</mi><mi id="S5.T5.2.2.2.2.m1.1.1.3" xref="S5.T5.2.2.2.2.m1.1.1.3.cmml">box</mi></msup><annotation-xml encoding="MathML-Content" id="S5.T5.2.2.2.2.m1.1b"><apply id="S5.T5.2.2.2.2.m1.1.1.cmml" xref="S5.T5.2.2.2.2.m1.1.1"><csymbol cd="ambiguous" id="S5.T5.2.2.2.2.m1.1.1.1.cmml" xref="S5.T5.2.2.2.2.m1.1.1">superscript</csymbol><ci id="S5.T5.2.2.2.2.m1.1.1.2.cmml" xref="S5.T5.2.2.2.2.m1.1.1.2">mAP</ci><ci id="S5.T5.2.2.2.2.m1.1.1.3.cmml" xref="S5.T5.2.2.2.2.m1.1.1.3">box</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T5.2.2.2.2.m1.1c">\mathrm{mAP^{box}}</annotation></semantics></math></th>
<th id="S5.T5.3.3.3.3" class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_tt"><math id="S5.T5.3.3.3.3.m1.1" class="ltx_Math" alttext="\mathrm{mAP^{mask}_{novel}}" display="inline"><semantics id="S5.T5.3.3.3.3.m1.1a"><msubsup id="S5.T5.3.3.3.3.m1.1.1" xref="S5.T5.3.3.3.3.m1.1.1.cmml"><mi id="S5.T5.3.3.3.3.m1.1.1.2.2" xref="S5.T5.3.3.3.3.m1.1.1.2.2.cmml">mAP</mi><mi id="S5.T5.3.3.3.3.m1.1.1.3" xref="S5.T5.3.3.3.3.m1.1.1.3.cmml">novel</mi><mi id="S5.T5.3.3.3.3.m1.1.1.2.3" xref="S5.T5.3.3.3.3.m1.1.1.2.3.cmml">mask</mi></msubsup><annotation-xml encoding="MathML-Content" id="S5.T5.3.3.3.3.m1.1b"><apply id="S5.T5.3.3.3.3.m1.1.1.cmml" xref="S5.T5.3.3.3.3.m1.1.1"><csymbol cd="ambiguous" id="S5.T5.3.3.3.3.m1.1.1.1.cmml" xref="S5.T5.3.3.3.3.m1.1.1">subscript</csymbol><apply id="S5.T5.3.3.3.3.m1.1.1.2.cmml" xref="S5.T5.3.3.3.3.m1.1.1"><csymbol cd="ambiguous" id="S5.T5.3.3.3.3.m1.1.1.2.1.cmml" xref="S5.T5.3.3.3.3.m1.1.1">superscript</csymbol><ci id="S5.T5.3.3.3.3.m1.1.1.2.2.cmml" xref="S5.T5.3.3.3.3.m1.1.1.2.2">mAP</ci><ci id="S5.T5.3.3.3.3.m1.1.1.2.3.cmml" xref="S5.T5.3.3.3.3.m1.1.1.2.3">mask</ci></apply><ci id="S5.T5.3.3.3.3.m1.1.1.3.cmml" xref="S5.T5.3.3.3.3.m1.1.1.3">novel</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T5.3.3.3.3.m1.1c">\mathrm{mAP^{mask}_{novel}}</annotation></semantics></math></th>
<th id="S5.T5.4.4.4.4" class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_tt"><math id="S5.T5.4.4.4.4.m1.1" class="ltx_Math" alttext="\mathrm{mAP^{mask}}" display="inline"><semantics id="S5.T5.4.4.4.4.m1.1a"><msup id="S5.T5.4.4.4.4.m1.1.1" xref="S5.T5.4.4.4.4.m1.1.1.cmml"><mi id="S5.T5.4.4.4.4.m1.1.1.2" xref="S5.T5.4.4.4.4.m1.1.1.2.cmml">mAP</mi><mi id="S5.T5.4.4.4.4.m1.1.1.3" xref="S5.T5.4.4.4.4.m1.1.1.3.cmml">mask</mi></msup><annotation-xml encoding="MathML-Content" id="S5.T5.4.4.4.4.m1.1b"><apply id="S5.T5.4.4.4.4.m1.1.1.cmml" xref="S5.T5.4.4.4.4.m1.1.1"><csymbol cd="ambiguous" id="S5.T5.4.4.4.4.m1.1.1.1.cmml" xref="S5.T5.4.4.4.4.m1.1.1">superscript</csymbol><ci id="S5.T5.4.4.4.4.m1.1.1.2.cmml" xref="S5.T5.4.4.4.4.m1.1.1.2">mAP</ci><ci id="S5.T5.4.4.4.4.m1.1.1.3.cmml" xref="S5.T5.4.4.4.4.m1.1.1.3">mask</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T5.4.4.4.4.m1.1c">\mathrm{mAP^{mask}}</annotation></semantics></math></th>
<th id="S5.T5.4.4.4.6" class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_tt">Latency</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S5.T5.4.4.5.1" class="ltx_tr">
<th id="S5.T5.4.4.5.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">Naive</th>
<td id="S5.T5.4.4.5.1.2" class="ltx_td ltx_align_right ltx_border_t">12.8</td>
<td id="S5.T5.4.4.5.1.3" class="ltx_td ltx_align_right ltx_border_t">28.3</td>
<td id="S5.T5.4.4.5.1.4" class="ltx_td ltx_align_right ltx_border_t">9.9</td>
<td id="S5.T5.4.4.5.1.5" class="ltx_td ltx_align_right ltx_border_t">20.3</td>
<td id="S5.T5.4.4.5.1.6" class="ltx_td ltx_align_right ltx_border_t">13.51</td>
</tr>
<tr id="S5.T5.4.4.6.2" class="ltx_tr">
<th id="S5.T5.4.4.6.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">+Pruning</th>
<td id="S5.T5.4.4.6.2.2" class="ltx_td ltx_align_right">13.7</td>
<td id="S5.T5.4.4.6.2.3" class="ltx_td ltx_align_right">28.3</td>
<td id="S5.T5.4.4.6.2.4" class="ltx_td ltx_align_right">10.2</td>
<td id="S5.T5.4.4.6.2.5" class="ltx_td ltx_align_right">20.4</td>
<td id="S5.T5.4.4.6.2.6" class="ltx_td ltx_align_right">1.85</td>
</tr>
<tr id="S5.T5.4.4.7.3" class="ltx_tr">
<th id="S5.T5.4.4.7.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">Align <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite>
</th>
<td id="S5.T5.4.4.7.3.2" class="ltx_td ltx_align_right">24.2</td>
<td id="S5.T5.4.4.7.3.3" class="ltx_td ltx_align_right">31.7</td>
<td id="S5.T5.4.4.7.3.4" class="ltx_td ltx_align_right">19.1</td>
<td id="S5.T5.4.4.7.3.5" class="ltx_td ltx_align_right">23.0</td>
<td id="S5.T5.4.4.7.3.6" class="ltx_td ltx_align_right">3.06</td>
</tr>
<tr id="S5.T5.4.4.8.4" class="ltx_tr">
<th id="S5.T5.4.4.8.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">+Pruning</th>
<td id="S5.T5.4.4.8.4.2" class="ltx_td ltx_align_right">26.2</td>
<td id="S5.T5.4.4.8.4.3" class="ltx_td ltx_align_right">32.0</td>
<td id="S5.T5.4.4.8.4.4" class="ltx_td ltx_align_right">20.8</td>
<td id="S5.T5.4.4.8.4.5" class="ltx_td ltx_align_right">23.4</td>
<td id="S5.T5.4.4.8.4.6" class="ltx_td ltx_align_right">0.60</td>
</tr>
<tr id="S5.T5.4.4.9.5" class="ltx_tr">
<th id="S5.T5.4.4.9.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">RMA (ours)</th>
<td id="S5.T5.4.4.9.5.2" class="ltx_td ltx_align_right">26.6</td>
<td id="S5.T5.4.4.9.5.3" class="ltx_td ltx_align_right">32.5</td>
<td id="S5.T5.4.4.9.5.4" class="ltx_td ltx_align_right">21.0</td>
<td id="S5.T5.4.4.9.5.5" class="ltx_td ltx_align_right">23.8</td>
<td id="S5.T5.4.4.9.5.6" class="ltx_td ltx_align_right">3.03</td>
</tr>
<tr id="S5.T5.4.4.10.6" class="ltx_tr">
<th id="S5.T5.4.4.10.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb">+Pruning</th>
<td id="S5.T5.4.4.10.6.2" class="ltx_td ltx_align_right ltx_border_bb"><span id="S5.T5.4.4.10.6.2.1" class="ltx_text ltx_font_bold">29.4</span></td>
<td id="S5.T5.4.4.10.6.3" class="ltx_td ltx_align_right ltx_border_bb"><span id="S5.T5.4.4.10.6.3.1" class="ltx_text ltx_font_bold">33.0</span></td>
<td id="S5.T5.4.4.10.6.4" class="ltx_td ltx_align_right ltx_border_bb"><span id="S5.T5.4.4.10.6.4.1" class="ltx_text ltx_font_bold">23.1</span></td>
<td id="S5.T5.4.4.10.6.5" class="ltx_td ltx_align_right ltx_border_bb"><span id="S5.T5.4.4.10.6.5.1" class="ltx_text ltx_font_bold">24.2</span></td>
<td id="S5.T5.4.4.10.6.6" class="ltx_td ltx_align_right ltx_border_bb">0.58</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
</section>
<section id="S5.SS2.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.2.2 </span>Ensemble Coefficient</h4>

<div id="S5.SS2.SSS2.p1" class="ltx_para">
<p id="S5.SS2.SSS2.p1.9" class="ltx_p">We investigate the influence of the ensembling weights <math id="S5.SS2.SSS2.p1.1.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S5.SS2.SSS2.p1.1.m1.1a"><mi id="S5.SS2.SSS2.p1.1.m1.1.1" xref="S5.SS2.SSS2.p1.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS2.p1.1.m1.1b"><ci id="S5.SS2.SSS2.p1.1.m1.1.1.cmml" xref="S5.SS2.SSS2.p1.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS2.p1.1.m1.1c">\alpha</annotation></semantics></math> and <math id="S5.SS2.SSS2.p1.2.m2.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S5.SS2.SSS2.p1.2.m2.1a"><mi id="S5.SS2.SSS2.p1.2.m2.1.1" xref="S5.SS2.SSS2.p1.2.m2.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS2.p1.2.m2.1b"><ci id="S5.SS2.SSS2.p1.2.m2.1.1.cmml" xref="S5.SS2.SSS2.p1.2.m2.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS2.p1.2.m2.1c">\beta</annotation></semantics></math> for base and novel classes. We vary the value of each hyperparameter while keeping the other constant, as summarized in Tables <a href="#S4.T4" title="Table 4 ‣ 4.3 Training and Evaluation Pipeline ‣ 4 Prompt-OVD ‣ ​​Prompt-Guided Transformers for End-to-End Open-Vocabulary Object Detection​​" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> and <a href="#S4.T4" title="Table 4 ‣ 4.3 Training and Evaluation Pipeline ‣ 4 Prompt-OVD ‣ ​​Prompt-Guided Transformers for End-to-End Open-Vocabulary Object Detection​​" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>, with a fixed RoI pruning threshold <math id="S5.SS2.SSS2.p1.3.m3.1" class="ltx_Math" alttext="\epsilon" display="inline"><semantics id="S5.SS2.SSS2.p1.3.m3.1a"><mi id="S5.SS2.SSS2.p1.3.m3.1.1" xref="S5.SS2.SSS2.p1.3.m3.1.1.cmml">ϵ</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS2.p1.3.m3.1b"><ci id="S5.SS2.SSS2.p1.3.m3.1.1.cmml" xref="S5.SS2.SSS2.p1.3.m3.1.1">italic-ϵ</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS2.p1.3.m3.1c">\epsilon</annotation></semantics></math> of 0.3. In general, the overall performance increases and then reaches at their maximum values when <math id="S5.SS2.SSS2.p1.4.m4.1" class="ltx_Math" alttext="\alpha=0.2" display="inline"><semantics id="S5.SS2.SSS2.p1.4.m4.1a"><mrow id="S5.SS2.SSS2.p1.4.m4.1.1" xref="S5.SS2.SSS2.p1.4.m4.1.1.cmml"><mi id="S5.SS2.SSS2.p1.4.m4.1.1.2" xref="S5.SS2.SSS2.p1.4.m4.1.1.2.cmml">α</mi><mo id="S5.SS2.SSS2.p1.4.m4.1.1.1" xref="S5.SS2.SSS2.p1.4.m4.1.1.1.cmml">=</mo><mn id="S5.SS2.SSS2.p1.4.m4.1.1.3" xref="S5.SS2.SSS2.p1.4.m4.1.1.3.cmml">0.2</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS2.p1.4.m4.1b"><apply id="S5.SS2.SSS2.p1.4.m4.1.1.cmml" xref="S5.SS2.SSS2.p1.4.m4.1.1"><eq id="S5.SS2.SSS2.p1.4.m4.1.1.1.cmml" xref="S5.SS2.SSS2.p1.4.m4.1.1.1"></eq><ci id="S5.SS2.SSS2.p1.4.m4.1.1.2.cmml" xref="S5.SS2.SSS2.p1.4.m4.1.1.2">𝛼</ci><cn type="float" id="S5.SS2.SSS2.p1.4.m4.1.1.3.cmml" xref="S5.SS2.SSS2.p1.4.m4.1.1.3">0.2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS2.p1.4.m4.1c">\alpha=0.2</annotation></semantics></math> and <math id="S5.SS2.SSS2.p1.5.m5.1" class="ltx_Math" alttext="\beta=0.4" display="inline"><semantics id="S5.SS2.SSS2.p1.5.m5.1a"><mrow id="S5.SS2.SSS2.p1.5.m5.1.1" xref="S5.SS2.SSS2.p1.5.m5.1.1.cmml"><mi id="S5.SS2.SSS2.p1.5.m5.1.1.2" xref="S5.SS2.SSS2.p1.5.m5.1.1.2.cmml">β</mi><mo id="S5.SS2.SSS2.p1.5.m5.1.1.1" xref="S5.SS2.SSS2.p1.5.m5.1.1.1.cmml">=</mo><mn id="S5.SS2.SSS2.p1.5.m5.1.1.3" xref="S5.SS2.SSS2.p1.5.m5.1.1.3.cmml">0.4</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS2.p1.5.m5.1b"><apply id="S5.SS2.SSS2.p1.5.m5.1.1.cmml" xref="S5.SS2.SSS2.p1.5.m5.1.1"><eq id="S5.SS2.SSS2.p1.5.m5.1.1.1.cmml" xref="S5.SS2.SSS2.p1.5.m5.1.1.1"></eq><ci id="S5.SS2.SSS2.p1.5.m5.1.1.2.cmml" xref="S5.SS2.SSS2.p1.5.m5.1.1.2">𝛽</ci><cn type="float" id="S5.SS2.SSS2.p1.5.m5.1.1.3.cmml" xref="S5.SS2.SSS2.p1.5.m5.1.1.3">0.4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS2.p1.5.m5.1c">\beta=0.4</annotation></semantics></math>. Using extreme values 0.0 or 1.0 for either coefficient results in significantly worse performance than using a more balanced ensemble. Moreover, the results show that the ensemble is more effective for novel classes than base classes, as evidenced by the significant impact of <math id="S5.SS2.SSS2.p1.6.m6.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S5.SS2.SSS2.p1.6.m6.1a"><mi id="S5.SS2.SSS2.p1.6.m6.1.1" xref="S5.SS2.SSS2.p1.6.m6.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS2.p1.6.m6.1b"><ci id="S5.SS2.SSS2.p1.6.m6.1.1.cmml" xref="S5.SS2.SSS2.p1.6.m6.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS2.p1.6.m6.1c">\beta</annotation></semantics></math> on the results of <math id="S5.SS2.SSS2.p1.7.m7.1" class="ltx_Math" alttext="\mathrm{mAP_{novel}}" display="inline"><semantics id="S5.SS2.SSS2.p1.7.m7.1a"><msub id="S5.SS2.SSS2.p1.7.m7.1.1" xref="S5.SS2.SSS2.p1.7.m7.1.1.cmml"><mi id="S5.SS2.SSS2.p1.7.m7.1.1.2" xref="S5.SS2.SSS2.p1.7.m7.1.1.2.cmml">mAP</mi><mi id="S5.SS2.SSS2.p1.7.m7.1.1.3" xref="S5.SS2.SSS2.p1.7.m7.1.1.3.cmml">novel</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS2.p1.7.m7.1b"><apply id="S5.SS2.SSS2.p1.7.m7.1.1.cmml" xref="S5.SS2.SSS2.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S5.SS2.SSS2.p1.7.m7.1.1.1.cmml" xref="S5.SS2.SSS2.p1.7.m7.1.1">subscript</csymbol><ci id="S5.SS2.SSS2.p1.7.m7.1.1.2.cmml" xref="S5.SS2.SSS2.p1.7.m7.1.1.2">mAP</ci><ci id="S5.SS2.SSS2.p1.7.m7.1.1.3.cmml" xref="S5.SS2.SSS2.p1.7.m7.1.1.3">novel</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS2.p1.7.m7.1c">\mathrm{mAP_{novel}}</annotation></semantics></math>. This suggests that the knowledge from CLIP has a greater positive impact on novel classes than on base classes. We set the values of <math id="S5.SS2.SSS2.p1.8.m8.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S5.SS2.SSS2.p1.8.m8.1a"><mi id="S5.SS2.SSS2.p1.8.m8.1.1" xref="S5.SS2.SSS2.p1.8.m8.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS2.p1.8.m8.1b"><ci id="S5.SS2.SSS2.p1.8.m8.1.1.cmml" xref="S5.SS2.SSS2.p1.8.m8.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS2.p1.8.m8.1c">\alpha</annotation></semantics></math> and <math id="S5.SS2.SSS2.p1.9.m9.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S5.SS2.SSS2.p1.9.m9.1a"><mi id="S5.SS2.SSS2.p1.9.m9.1.1" xref="S5.SS2.SSS2.p1.9.m9.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS2.p1.9.m9.1b"><ci id="S5.SS2.SSS2.p1.9.m9.1.1.cmml" xref="S5.SS2.SSS2.p1.9.m9.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS2.p1.9.m9.1c">\beta</annotation></semantics></math> to 0.2 and 0.4 for all experiments.</p>
</div>
</section>
<section id="S5.SS2.SSS3" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.2.3 </span>RoI-based Masked Attention</h4>

<div id="S5.SS2.SSS3.p1" class="ltx_para">
<p id="S5.SS2.SSS3.p1.2" class="ltx_p">We conduct a comparison between our RoI-based masked attention method with both the naive approach and the commonly used RoI Align method, as summarized in Table <a href="#S5.T5" title="Table 5 ‣ 5.2.1 Inference Speed Up from OV-DETR ‣ 5.2 Main Ablation Study ‣ 5 Evaluation ‣ ​​Prompt-Guided Transformers for End-to-End Open-Vocabulary Object Detection​​" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>. The naive approach implies that CLIP infers all the cropped images of RoIs according to Eq. (<a href="#S4.E7" title="In 4.2 Ensemble with ViT-based CLIP ‣ 4 Prompt-OVD ‣ ​​Prompt-Guided Transformers for End-to-End Open-Vocabulary Object Detection​​" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a>). To apply the RoI Align method to CLIP’s ViT encoder, we reconstruct its patch tokens into a 2D feature map prior to the final Transformer layer. Compared to the naive approach, our RoI-based masked attention method has a significantly smaller computational overhead. Additionally, the efficiency and effectiveness of our method can be further improved by utilizing RoI pruning, which removes background RoIs. In contrast, RoI Align shows substantially lower <math id="S5.SS2.SSS3.p1.1.m1.1" class="ltx_Math" alttext="\mathrm{mAP^{box}_{novel}}" display="inline"><semantics id="S5.SS2.SSS3.p1.1.m1.1a"><msubsup id="S5.SS2.SSS3.p1.1.m1.1.1" xref="S5.SS2.SSS3.p1.1.m1.1.1.cmml"><mi id="S5.SS2.SSS3.p1.1.m1.1.1.2.2" xref="S5.SS2.SSS3.p1.1.m1.1.1.2.2.cmml">mAP</mi><mi id="S5.SS2.SSS3.p1.1.m1.1.1.3" xref="S5.SS2.SSS3.p1.1.m1.1.1.3.cmml">novel</mi><mi id="S5.SS2.SSS3.p1.1.m1.1.1.2.3" xref="S5.SS2.SSS3.p1.1.m1.1.1.2.3.cmml">box</mi></msubsup><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS3.p1.1.m1.1b"><apply id="S5.SS2.SSS3.p1.1.m1.1.1.cmml" xref="S5.SS2.SSS3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S5.SS2.SSS3.p1.1.m1.1.1.1.cmml" xref="S5.SS2.SSS3.p1.1.m1.1.1">subscript</csymbol><apply id="S5.SS2.SSS3.p1.1.m1.1.1.2.cmml" xref="S5.SS2.SSS3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S5.SS2.SSS3.p1.1.m1.1.1.2.1.cmml" xref="S5.SS2.SSS3.p1.1.m1.1.1">superscript</csymbol><ci id="S5.SS2.SSS3.p1.1.m1.1.1.2.2.cmml" xref="S5.SS2.SSS3.p1.1.m1.1.1.2.2">mAP</ci><ci id="S5.SS2.SSS3.p1.1.m1.1.1.2.3.cmml" xref="S5.SS2.SSS3.p1.1.m1.1.1.2.3">box</ci></apply><ci id="S5.SS2.SSS3.p1.1.m1.1.1.3.cmml" xref="S5.SS2.SSS3.p1.1.m1.1.1.3">novel</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS3.p1.1.m1.1c">\mathrm{mAP^{box}_{novel}}</annotation></semantics></math> and <math id="S5.SS2.SSS3.p1.2.m2.1" class="ltx_Math" alttext="\mathrm{mAP^{box}}" display="inline"><semantics id="S5.SS2.SSS3.p1.2.m2.1a"><msup id="S5.SS2.SSS3.p1.2.m2.1.1" xref="S5.SS2.SSS3.p1.2.m2.1.1.cmml"><mi id="S5.SS2.SSS3.p1.2.m2.1.1.2" xref="S5.SS2.SSS3.p1.2.m2.1.1.2.cmml">mAP</mi><mi id="S5.SS2.SSS3.p1.2.m2.1.1.3" xref="S5.SS2.SSS3.p1.2.m2.1.1.3.cmml">box</mi></msup><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS3.p1.2.m2.1b"><apply id="S5.SS2.SSS3.p1.2.m2.1.1.cmml" xref="S5.SS2.SSS3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S5.SS2.SSS3.p1.2.m2.1.1.1.cmml" xref="S5.SS2.SSS3.p1.2.m2.1.1">superscript</csymbol><ci id="S5.SS2.SSS3.p1.2.m2.1.1.2.cmml" xref="S5.SS2.SSS3.p1.2.m2.1.1.2">mAP</ci><ci id="S5.SS2.SSS3.p1.2.m2.1.1.3.cmml" xref="S5.SS2.SSS3.p1.2.m2.1.1.3">box</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS3.p1.2.m2.1c">\mathrm{mAP^{box}}</annotation></semantics></math> than our method, as it is not optimized for the Transformer structure. Surprisingly, the naive crop method did not perform well, likely due to resizing a small object to be too large. Therefore, using masked attention is a more appropriate approach for Transformers than others.</p>
</div>
<figure id="S5.T6" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="S5.T6.9.2.1" class="ltx_text" style="font-size:90%;">Table 6</span>: </span><span id="S5.T6.2.1" class="ltx_text" style="font-size:90%;">Performance trade-off with varying <math id="S5.T6.2.1.m1.1" class="ltx_Math" alttext="\epsilon" display="inline"><semantics id="S5.T6.2.1.m1.1b"><mi id="S5.T6.2.1.m1.1.1" xref="S5.T6.2.1.m1.1.1.cmml">ϵ</mi><annotation-xml encoding="MathML-Content" id="S5.T6.2.1.m1.1c"><ci id="S5.T6.2.1.m1.1.1.cmml" xref="S5.T6.2.1.m1.1.1">italic-ϵ</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T6.2.1.m1.1d">\epsilon</annotation></semantics></math> on OV-LVIS.</span></figcaption>
<div id="S5.T6.7" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:208.3pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(85.7pt,-41.2pt) scale(1.65348562603067,1.65348562603067) ;">
<table id="S5.T6.7.5" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S5.T6.7.5.5" class="ltx_tr">
<th id="S5.T6.3.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt"><math id="S5.T6.3.1.1.1.m1.1" class="ltx_Math" alttext="\epsilon" display="inline"><semantics id="S5.T6.3.1.1.1.m1.1a"><mi id="S5.T6.3.1.1.1.m1.1.1" xref="S5.T6.3.1.1.1.m1.1.1.cmml">ϵ</mi><annotation-xml encoding="MathML-Content" id="S5.T6.3.1.1.1.m1.1b"><ci id="S5.T6.3.1.1.1.m1.1.1.cmml" xref="S5.T6.3.1.1.1.m1.1.1">italic-ϵ</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T6.3.1.1.1.m1.1c">\epsilon</annotation></semantics></math></th>
<th id="S5.T6.4.2.2.2" class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_tt"><math id="S5.T6.4.2.2.2.m1.1" class="ltx_Math" alttext="\mathrm{mAP^{box}_{novel}}" display="inline"><semantics id="S5.T6.4.2.2.2.m1.1a"><msubsup id="S5.T6.4.2.2.2.m1.1.1" xref="S5.T6.4.2.2.2.m1.1.1.cmml"><mi id="S5.T6.4.2.2.2.m1.1.1.2.2" xref="S5.T6.4.2.2.2.m1.1.1.2.2.cmml">mAP</mi><mi id="S5.T6.4.2.2.2.m1.1.1.3" xref="S5.T6.4.2.2.2.m1.1.1.3.cmml">novel</mi><mi id="S5.T6.4.2.2.2.m1.1.1.2.3" xref="S5.T6.4.2.2.2.m1.1.1.2.3.cmml">box</mi></msubsup><annotation-xml encoding="MathML-Content" id="S5.T6.4.2.2.2.m1.1b"><apply id="S5.T6.4.2.2.2.m1.1.1.cmml" xref="S5.T6.4.2.2.2.m1.1.1"><csymbol cd="ambiguous" id="S5.T6.4.2.2.2.m1.1.1.1.cmml" xref="S5.T6.4.2.2.2.m1.1.1">subscript</csymbol><apply id="S5.T6.4.2.2.2.m1.1.1.2.cmml" xref="S5.T6.4.2.2.2.m1.1.1"><csymbol cd="ambiguous" id="S5.T6.4.2.2.2.m1.1.1.2.1.cmml" xref="S5.T6.4.2.2.2.m1.1.1">superscript</csymbol><ci id="S5.T6.4.2.2.2.m1.1.1.2.2.cmml" xref="S5.T6.4.2.2.2.m1.1.1.2.2">mAP</ci><ci id="S5.T6.4.2.2.2.m1.1.1.2.3.cmml" xref="S5.T6.4.2.2.2.m1.1.1.2.3">box</ci></apply><ci id="S5.T6.4.2.2.2.m1.1.1.3.cmml" xref="S5.T6.4.2.2.2.m1.1.1.3">novel</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T6.4.2.2.2.m1.1c">\mathrm{mAP^{box}_{novel}}</annotation></semantics></math></th>
<th id="S5.T6.5.3.3.3" class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_tt"><math id="S5.T6.5.3.3.3.m1.1" class="ltx_Math" alttext="\mathrm{mAP^{box}}" display="inline"><semantics id="S5.T6.5.3.3.3.m1.1a"><msup id="S5.T6.5.3.3.3.m1.1.1" xref="S5.T6.5.3.3.3.m1.1.1.cmml"><mi id="S5.T6.5.3.3.3.m1.1.1.2" xref="S5.T6.5.3.3.3.m1.1.1.2.cmml">mAP</mi><mi id="S5.T6.5.3.3.3.m1.1.1.3" xref="S5.T6.5.3.3.3.m1.1.1.3.cmml">box</mi></msup><annotation-xml encoding="MathML-Content" id="S5.T6.5.3.3.3.m1.1b"><apply id="S5.T6.5.3.3.3.m1.1.1.cmml" xref="S5.T6.5.3.3.3.m1.1.1"><csymbol cd="ambiguous" id="S5.T6.5.3.3.3.m1.1.1.1.cmml" xref="S5.T6.5.3.3.3.m1.1.1">superscript</csymbol><ci id="S5.T6.5.3.3.3.m1.1.1.2.cmml" xref="S5.T6.5.3.3.3.m1.1.1.2">mAP</ci><ci id="S5.T6.5.3.3.3.m1.1.1.3.cmml" xref="S5.T6.5.3.3.3.m1.1.1.3">box</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T6.5.3.3.3.m1.1c">\mathrm{mAP^{box}}</annotation></semantics></math></th>
<th id="S5.T6.6.4.4.4" class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_tt"><math id="S5.T6.6.4.4.4.m1.1" class="ltx_Math" alttext="\mathrm{mAP^{mask}_{novel}}" display="inline"><semantics id="S5.T6.6.4.4.4.m1.1a"><msubsup id="S5.T6.6.4.4.4.m1.1.1" xref="S5.T6.6.4.4.4.m1.1.1.cmml"><mi id="S5.T6.6.4.4.4.m1.1.1.2.2" xref="S5.T6.6.4.4.4.m1.1.1.2.2.cmml">mAP</mi><mi id="S5.T6.6.4.4.4.m1.1.1.3" xref="S5.T6.6.4.4.4.m1.1.1.3.cmml">novel</mi><mi id="S5.T6.6.4.4.4.m1.1.1.2.3" xref="S5.T6.6.4.4.4.m1.1.1.2.3.cmml">mask</mi></msubsup><annotation-xml encoding="MathML-Content" id="S5.T6.6.4.4.4.m1.1b"><apply id="S5.T6.6.4.4.4.m1.1.1.cmml" xref="S5.T6.6.4.4.4.m1.1.1"><csymbol cd="ambiguous" id="S5.T6.6.4.4.4.m1.1.1.1.cmml" xref="S5.T6.6.4.4.4.m1.1.1">subscript</csymbol><apply id="S5.T6.6.4.4.4.m1.1.1.2.cmml" xref="S5.T6.6.4.4.4.m1.1.1"><csymbol cd="ambiguous" id="S5.T6.6.4.4.4.m1.1.1.2.1.cmml" xref="S5.T6.6.4.4.4.m1.1.1">superscript</csymbol><ci id="S5.T6.6.4.4.4.m1.1.1.2.2.cmml" xref="S5.T6.6.4.4.4.m1.1.1.2.2">mAP</ci><ci id="S5.T6.6.4.4.4.m1.1.1.2.3.cmml" xref="S5.T6.6.4.4.4.m1.1.1.2.3">mask</ci></apply><ci id="S5.T6.6.4.4.4.m1.1.1.3.cmml" xref="S5.T6.6.4.4.4.m1.1.1.3">novel</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T6.6.4.4.4.m1.1c">\mathrm{mAP^{mask}_{novel}}</annotation></semantics></math></th>
<th id="S5.T6.7.5.5.5" class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_tt"><math id="S5.T6.7.5.5.5.m1.1" class="ltx_Math" alttext="\mathrm{mAP^{mask}}" display="inline"><semantics id="S5.T6.7.5.5.5.m1.1a"><msup id="S5.T6.7.5.5.5.m1.1.1" xref="S5.T6.7.5.5.5.m1.1.1.cmml"><mi id="S5.T6.7.5.5.5.m1.1.1.2" xref="S5.T6.7.5.5.5.m1.1.1.2.cmml">mAP</mi><mi id="S5.T6.7.5.5.5.m1.1.1.3" xref="S5.T6.7.5.5.5.m1.1.1.3.cmml">mask</mi></msup><annotation-xml encoding="MathML-Content" id="S5.T6.7.5.5.5.m1.1b"><apply id="S5.T6.7.5.5.5.m1.1.1.cmml" xref="S5.T6.7.5.5.5.m1.1.1"><csymbol cd="ambiguous" id="S5.T6.7.5.5.5.m1.1.1.1.cmml" xref="S5.T6.7.5.5.5.m1.1.1">superscript</csymbol><ci id="S5.T6.7.5.5.5.m1.1.1.2.cmml" xref="S5.T6.7.5.5.5.m1.1.1.2">mAP</ci><ci id="S5.T6.7.5.5.5.m1.1.1.3.cmml" xref="S5.T6.7.5.5.5.m1.1.1.3">mask</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T6.7.5.5.5.m1.1c">\mathrm{mAP^{mask}}</annotation></semantics></math></th>
<th id="S5.T6.7.5.5.6" class="ltx_td ltx_nopad_r ltx_align_right ltx_th ltx_th_column ltx_border_tt">Latency (s)</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S5.T6.7.5.6.1" class="ltx_tr">
<th id="S5.T6.7.5.6.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">0.0</th>
<td id="S5.T6.7.5.6.1.2" class="ltx_td ltx_align_right ltx_border_t">26.6</td>
<td id="S5.T6.7.5.6.1.3" class="ltx_td ltx_align_right ltx_border_t">32.5</td>
<td id="S5.T6.7.5.6.1.4" class="ltx_td ltx_align_right ltx_border_t">21.0</td>
<td id="S5.T6.7.5.6.1.5" class="ltx_td ltx_align_right ltx_border_t">23.8</td>
<td id="S5.T6.7.5.6.1.6" class="ltx_td ltx_nopad_r ltx_align_right ltx_border_t">3.03</td>
</tr>
<tr id="S5.T6.7.5.7.2" class="ltx_tr">
<th id="S5.T6.7.5.7.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">0.1</th>
<td id="S5.T6.7.5.7.2.2" class="ltx_td ltx_align_right">27.7</td>
<td id="S5.T6.7.5.7.2.3" class="ltx_td ltx_align_right">32.8</td>
<td id="S5.T6.7.5.7.2.4" class="ltx_td ltx_align_right">21.9</td>
<td id="S5.T6.7.5.7.2.5" class="ltx_td ltx_align_right">24.0</td>
<td id="S5.T6.7.5.7.2.6" class="ltx_td ltx_nopad_r ltx_align_right">1.38</td>
</tr>
<tr id="S5.T6.7.5.8.3" class="ltx_tr">
<th id="S5.T6.7.5.8.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">0.2</th>
<td id="S5.T6.7.5.8.3.2" class="ltx_td ltx_align_right">28.3</td>
<td id="S5.T6.7.5.8.3.3" class="ltx_td ltx_align_right">33.0</td>
<td id="S5.T6.7.5.8.3.4" class="ltx_td ltx_align_right">22.3</td>
<td id="S5.T6.7.5.8.3.5" class="ltx_td ltx_align_right">24.1</td>
<td id="S5.T6.7.5.8.3.6" class="ltx_td ltx_nopad_r ltx_align_right">0.86</td>
</tr>
<tr id="S5.T6.7.5.9.4" class="ltx_tr">
<th id="S5.T6.7.5.9.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S5.T6.7.5.9.4.1.1" class="ltx_text ltx_font_bold">0.3</span></th>
<td id="S5.T6.7.5.9.4.2" class="ltx_td ltx_align_right"><span id="S5.T6.7.5.9.4.2.1" class="ltx_text ltx_font_bold">29.4</span></td>
<td id="S5.T6.7.5.9.4.3" class="ltx_td ltx_align_right"><span id="S5.T6.7.5.9.4.3.1" class="ltx_text ltx_font_bold">33.0</span></td>
<td id="S5.T6.7.5.9.4.4" class="ltx_td ltx_align_right"><span id="S5.T6.7.5.9.4.4.1" class="ltx_text ltx_font_bold">23.1</span></td>
<td id="S5.T6.7.5.9.4.5" class="ltx_td ltx_align_right"><span id="S5.T6.7.5.9.4.5.1" class="ltx_text ltx_font_bold">24.2</span></td>
<td id="S5.T6.7.5.9.4.6" class="ltx_td ltx_nopad_r ltx_align_right">0.58</td>
</tr>
<tr id="S5.T6.7.5.10.5" class="ltx_tr">
<th id="S5.T6.7.5.10.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">0.4</th>
<td id="S5.T6.7.5.10.5.2" class="ltx_td ltx_align_right">28.3</td>
<td id="S5.T6.7.5.10.5.3" class="ltx_td ltx_align_right">31.9</td>
<td id="S5.T6.7.5.10.5.4" class="ltx_td ltx_align_right">22.5</td>
<td id="S5.T6.7.5.10.5.5" class="ltx_td ltx_align_right">23.4</td>
<td id="S5.T6.7.5.10.5.6" class="ltx_td ltx_nopad_r ltx_align_right">0.43</td>
</tr>
<tr id="S5.T6.7.5.11.6" class="ltx_tr">
<th id="S5.T6.7.5.11.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb">0.5</th>
<td id="S5.T6.7.5.11.6.2" class="ltx_td ltx_align_right ltx_border_bb">25.3</td>
<td id="S5.T6.7.5.11.6.3" class="ltx_td ltx_align_right ltx_border_bb">28.1</td>
<td id="S5.T6.7.5.11.6.4" class="ltx_td ltx_align_right ltx_border_bb">19.8</td>
<td id="S5.T6.7.5.11.6.5" class="ltx_td ltx_align_right ltx_border_bb">20.8</td>
<td id="S5.T6.7.5.11.6.6" class="ltx_td ltx_nopad_r ltx_align_right ltx_border_bb">0.37</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
</section>
<section id="S5.SS2.SSS4" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.2.4 </span>Box Regression over RPN</h4>

<div id="S5.SS2.SSS4.p1" class="ltx_para">
<p id="S5.SS2.SSS4.p1.1" class="ltx_p">We validate the effectiveness of Prompt-OVD in terms of box regression compared with the existing RPN-based method. Figure <a href="#S5.F4" title="Figure 4 ‣ 5.1 Main Experiment ‣ 5 Evaluation ‣ ​​Prompt-Guided Transformers for End-to-End Open-Vocabulary Object Detection​​" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> compares their estimated bounding boxes based on the ground-truth ones. Figure <a href="#S5.F4" title="Figure 4 ‣ 5.1 Main Experiment ‣ 5 Evaluation ‣ ​​Prompt-Guided Transformers for End-to-End Open-Vocabulary Object Detection​​" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>(b) is an example of the scenario where the RPN method fails to accurately localize objects, i.e., a missing box for carriage (novel class) and two deviated boxes from the ground-truth for the bread (novel class) and plate (base class). In contrast, Prompt-OVD successfully localizes all base and novel objects with high recall using the prompt-guided decoding, as shown in Figure <a href="#S5.F4" title="Figure 4 ‣ 5.1 Main Experiment ‣ 5 Evaluation ‣ ​​Prompt-Guided Transformers for End-to-End Open-Vocabulary Object Detection​​" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>(c). Despite the presence of background or inaccurate boxes in the box candidates, Prompt-OVD successfully covers all the ground-truth boxes with its predictions. Furthermore, as seen in Figure <a href="#S5.F4" title="Figure 4 ‣ 5.1 Main Experiment ‣ 5 Evaluation ‣ ​​Prompt-Guided Transformers for End-to-End Open-Vocabulary Object Detection​​" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>(d), RoI pruning effectively excludes such irrelevant boxes from the detection process.</p>
</div>
</section>
<section id="S5.SS2.SSS5" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.2.5 </span>RoI Pruning Threshold</h4>

<div id="S5.SS2.SSS5.p1" class="ltx_para">
<p id="S5.SS2.SSS5.p1.4" class="ltx_p">We investigate the trade-off between detection performance and computational efficiency by varying the pruning threshold <math id="S5.SS2.SSS5.p1.1.m1.1" class="ltx_Math" alttext="\epsilon" display="inline"><semantics id="S5.SS2.SSS5.p1.1.m1.1a"><mi id="S5.SS2.SSS5.p1.1.m1.1.1" xref="S5.SS2.SSS5.p1.1.m1.1.1.cmml">ϵ</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS5.p1.1.m1.1b"><ci id="S5.SS2.SSS5.p1.1.m1.1.1.cmml" xref="S5.SS2.SSS5.p1.1.m1.1.1">italic-ϵ</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS5.p1.1.m1.1c">\epsilon</annotation></semantics></math>, as summarized in Table <a href="#S5.T6" title="Table 6 ‣ 5.2.3 RoI-based Masked Attention ‣ 5.2 Main Ablation Study ‣ 5 Evaluation ‣ ​​Prompt-Guided Transformers for End-to-End Open-Vocabulary Object Detection​​" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>. As the threshold increases, fewer bounding boxes are retained, as the number of boxes with object scores greater than the threshold decreases. For instance, when the threshold is set to be 0.0, which means RoI pruning is not applied, the detection accuracy deteriorates due to the inclusion of background boxes, also resulting in a high latency. On the contrary, the detection accuracy improves as <math id="S5.SS2.SSS5.p1.2.m2.1" class="ltx_Math" alttext="\epsilon" display="inline"><semantics id="S5.SS2.SSS5.p1.2.m2.1a"><mi id="S5.SS2.SSS5.p1.2.m2.1.1" xref="S5.SS2.SSS5.p1.2.m2.1.1.cmml">ϵ</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS5.p1.2.m2.1b"><ci id="S5.SS2.SSS5.p1.2.m2.1.1.cmml" xref="S5.SS2.SSS5.p1.2.m2.1.1">italic-ϵ</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS5.p1.2.m2.1c">\epsilon</annotation></semantics></math> increases within the reasonable range of 0.0 – 0.3, but deteriorates with a larger threshold of 0.4 – 0.5. That is, as <math id="S5.SS2.SSS5.p1.3.m3.1" class="ltx_Math" alttext="\epsilon" display="inline"><semantics id="S5.SS2.SSS5.p1.3.m3.1a"><mi id="S5.SS2.SSS5.p1.3.m3.1.1" xref="S5.SS2.SSS5.p1.3.m3.1.1.cmml">ϵ</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS5.p1.3.m3.1b"><ci id="S5.SS2.SSS5.p1.3.m3.1.1.cmml" xref="S5.SS2.SSS5.p1.3.m3.1.1">italic-ϵ</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS5.p1.3.m3.1c">\epsilon</annotation></semantics></math> increases, more false positive boxes begins to be excluded, leading to improved performance. However, further increasing the threshold leads to the removal of true positive boxes, causing performance degradation. Therefore, we set the value of <math id="S5.SS2.SSS5.p1.4.m4.1" class="ltx_Math" alttext="\epsilon" display="inline"><semantics id="S5.SS2.SSS5.p1.4.m4.1a"><mi id="S5.SS2.SSS5.p1.4.m4.1.1" xref="S5.SS2.SSS5.p1.4.m4.1.1.cmml">ϵ</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS5.p1.4.m4.1b"><ci id="S5.SS2.SSS5.p1.4.m4.1.1.cmml" xref="S5.SS2.SSS5.p1.4.m4.1.1">italic-ϵ</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS5.p1.4.m4.1c">\epsilon</annotation></semantics></math> to 0.3 for all experiments.</p>
</div>
<figure id="S5.T7" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="S5.T7.6.1.1" class="ltx_text" style="font-size:90%;">Table 7</span>: </span><span id="S5.T7.7.2" class="ltx_text" style="font-size:90%;">Performance when using different CLIP models for ensembling on OV-LVIS.</span></figcaption>
<div id="S5.T7.4" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:133.5pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(70.6pt,-21.7pt) scale(1.48304485918293,1.48304485918293) ;">
<table id="S5.T7.4.4" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S5.T7.4.4.4" class="ltx_tr">
<th id="S5.T7.4.4.4.5" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt">CLIP</th>
<th id="S5.T7.1.1.1.1" class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_tt"><math id="S5.T7.1.1.1.1.m1.1" class="ltx_Math" alttext="\mathrm{mAP^{box}_{novel}}" display="inline"><semantics id="S5.T7.1.1.1.1.m1.1a"><msubsup id="S5.T7.1.1.1.1.m1.1.1" xref="S5.T7.1.1.1.1.m1.1.1.cmml"><mi id="S5.T7.1.1.1.1.m1.1.1.2.2" xref="S5.T7.1.1.1.1.m1.1.1.2.2.cmml">mAP</mi><mi id="S5.T7.1.1.1.1.m1.1.1.3" xref="S5.T7.1.1.1.1.m1.1.1.3.cmml">novel</mi><mi id="S5.T7.1.1.1.1.m1.1.1.2.3" xref="S5.T7.1.1.1.1.m1.1.1.2.3.cmml">box</mi></msubsup><annotation-xml encoding="MathML-Content" id="S5.T7.1.1.1.1.m1.1b"><apply id="S5.T7.1.1.1.1.m1.1.1.cmml" xref="S5.T7.1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S5.T7.1.1.1.1.m1.1.1.1.cmml" xref="S5.T7.1.1.1.1.m1.1.1">subscript</csymbol><apply id="S5.T7.1.1.1.1.m1.1.1.2.cmml" xref="S5.T7.1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S5.T7.1.1.1.1.m1.1.1.2.1.cmml" xref="S5.T7.1.1.1.1.m1.1.1">superscript</csymbol><ci id="S5.T7.1.1.1.1.m1.1.1.2.2.cmml" xref="S5.T7.1.1.1.1.m1.1.1.2.2">mAP</ci><ci id="S5.T7.1.1.1.1.m1.1.1.2.3.cmml" xref="S5.T7.1.1.1.1.m1.1.1.2.3">box</ci></apply><ci id="S5.T7.1.1.1.1.m1.1.1.3.cmml" xref="S5.T7.1.1.1.1.m1.1.1.3">novel</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T7.1.1.1.1.m1.1c">\mathrm{mAP^{box}_{novel}}</annotation></semantics></math></th>
<th id="S5.T7.2.2.2.2" class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_tt"><math id="S5.T7.2.2.2.2.m1.1" class="ltx_Math" alttext="\mathrm{mAP^{box}}" display="inline"><semantics id="S5.T7.2.2.2.2.m1.1a"><msup id="S5.T7.2.2.2.2.m1.1.1" xref="S5.T7.2.2.2.2.m1.1.1.cmml"><mi id="S5.T7.2.2.2.2.m1.1.1.2" xref="S5.T7.2.2.2.2.m1.1.1.2.cmml">mAP</mi><mi id="S5.T7.2.2.2.2.m1.1.1.3" xref="S5.T7.2.2.2.2.m1.1.1.3.cmml">box</mi></msup><annotation-xml encoding="MathML-Content" id="S5.T7.2.2.2.2.m1.1b"><apply id="S5.T7.2.2.2.2.m1.1.1.cmml" xref="S5.T7.2.2.2.2.m1.1.1"><csymbol cd="ambiguous" id="S5.T7.2.2.2.2.m1.1.1.1.cmml" xref="S5.T7.2.2.2.2.m1.1.1">superscript</csymbol><ci id="S5.T7.2.2.2.2.m1.1.1.2.cmml" xref="S5.T7.2.2.2.2.m1.1.1.2">mAP</ci><ci id="S5.T7.2.2.2.2.m1.1.1.3.cmml" xref="S5.T7.2.2.2.2.m1.1.1.3">box</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T7.2.2.2.2.m1.1c">\mathrm{mAP^{box}}</annotation></semantics></math></th>
<th id="S5.T7.3.3.3.3" class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_tt"><math id="S5.T7.3.3.3.3.m1.1" class="ltx_Math" alttext="\mathrm{mAP^{mask}_{novel}}" display="inline"><semantics id="S5.T7.3.3.3.3.m1.1a"><msubsup id="S5.T7.3.3.3.3.m1.1.1" xref="S5.T7.3.3.3.3.m1.1.1.cmml"><mi id="S5.T7.3.3.3.3.m1.1.1.2.2" xref="S5.T7.3.3.3.3.m1.1.1.2.2.cmml">mAP</mi><mi id="S5.T7.3.3.3.3.m1.1.1.3" xref="S5.T7.3.3.3.3.m1.1.1.3.cmml">novel</mi><mi id="S5.T7.3.3.3.3.m1.1.1.2.3" xref="S5.T7.3.3.3.3.m1.1.1.2.3.cmml">mask</mi></msubsup><annotation-xml encoding="MathML-Content" id="S5.T7.3.3.3.3.m1.1b"><apply id="S5.T7.3.3.3.3.m1.1.1.cmml" xref="S5.T7.3.3.3.3.m1.1.1"><csymbol cd="ambiguous" id="S5.T7.3.3.3.3.m1.1.1.1.cmml" xref="S5.T7.3.3.3.3.m1.1.1">subscript</csymbol><apply id="S5.T7.3.3.3.3.m1.1.1.2.cmml" xref="S5.T7.3.3.3.3.m1.1.1"><csymbol cd="ambiguous" id="S5.T7.3.3.3.3.m1.1.1.2.1.cmml" xref="S5.T7.3.3.3.3.m1.1.1">superscript</csymbol><ci id="S5.T7.3.3.3.3.m1.1.1.2.2.cmml" xref="S5.T7.3.3.3.3.m1.1.1.2.2">mAP</ci><ci id="S5.T7.3.3.3.3.m1.1.1.2.3.cmml" xref="S5.T7.3.3.3.3.m1.1.1.2.3">mask</ci></apply><ci id="S5.T7.3.3.3.3.m1.1.1.3.cmml" xref="S5.T7.3.3.3.3.m1.1.1.3">novel</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T7.3.3.3.3.m1.1c">\mathrm{mAP^{mask}_{novel}}</annotation></semantics></math></th>
<th id="S5.T7.4.4.4.4" class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_tt"><math id="S5.T7.4.4.4.4.m1.1" class="ltx_Math" alttext="\mathrm{mAP^{mask}}" display="inline"><semantics id="S5.T7.4.4.4.4.m1.1a"><msup id="S5.T7.4.4.4.4.m1.1.1" xref="S5.T7.4.4.4.4.m1.1.1.cmml"><mi id="S5.T7.4.4.4.4.m1.1.1.2" xref="S5.T7.4.4.4.4.m1.1.1.2.cmml">mAP</mi><mi id="S5.T7.4.4.4.4.m1.1.1.3" xref="S5.T7.4.4.4.4.m1.1.1.3.cmml">mask</mi></msup><annotation-xml encoding="MathML-Content" id="S5.T7.4.4.4.4.m1.1b"><apply id="S5.T7.4.4.4.4.m1.1.1.cmml" xref="S5.T7.4.4.4.4.m1.1.1"><csymbol cd="ambiguous" id="S5.T7.4.4.4.4.m1.1.1.1.cmml" xref="S5.T7.4.4.4.4.m1.1.1">superscript</csymbol><ci id="S5.T7.4.4.4.4.m1.1.1.2.cmml" xref="S5.T7.4.4.4.4.m1.1.1.2">mAP</ci><ci id="S5.T7.4.4.4.4.m1.1.1.3.cmml" xref="S5.T7.4.4.4.4.m1.1.1.3">mask</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T7.4.4.4.4.m1.1c">\mathrm{mAP^{mask}}</annotation></semantics></math></th>
<th id="S5.T7.4.4.4.6" class="ltx_td ltx_nopad_r ltx_align_right ltx_th ltx_th_column ltx_border_tt">Latency (s)</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S5.T7.4.4.5.1" class="ltx_tr">
<th id="S5.T7.4.4.5.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">None</th>
<td id="S5.T7.4.4.5.1.2" class="ltx_td ltx_align_right ltx_border_t">15.4</td>
<td id="S5.T7.4.4.5.1.3" class="ltx_td ltx_align_right ltx_border_t">28.1</td>
<td id="S5.T7.4.4.5.1.4" class="ltx_td ltx_align_right ltx_border_t">11.7</td>
<td id="S5.T7.4.4.5.1.5" class="ltx_td ltx_align_right ltx_border_t">20.3</td>
<td id="S5.T7.4.4.5.1.6" class="ltx_td ltx_nopad_r ltx_align_right ltx_border_t">0.54</td>
</tr>
<tr id="S5.T7.4.4.6.2" class="ltx_tr">
<th id="S5.T7.4.4.6.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">ViT-B/32</th>
<td id="S5.T7.4.4.6.2.2" class="ltx_td ltx_align_right">20.5</td>
<td id="S5.T7.4.4.6.2.3" class="ltx_td ltx_align_right">30.1</td>
<td id="S5.T7.4.4.6.2.4" class="ltx_td ltx_align_right">16.4</td>
<td id="S5.T7.4.4.6.2.5" class="ltx_td ltx_align_right">21.9</td>
<td id="S5.T7.4.4.6.2.6" class="ltx_td ltx_nopad_r ltx_align_right">0.56</td>
</tr>
<tr id="S5.T7.4.4.7.3" class="ltx_tr">
<th id="S5.T7.4.4.7.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">ViT-B/16</th>
<td id="S5.T7.4.4.7.3.2" class="ltx_td ltx_align_right">22.3</td>
<td id="S5.T7.4.4.7.3.3" class="ltx_td ltx_align_right">31.1</td>
<td id="S5.T7.4.4.7.3.4" class="ltx_td ltx_align_right">17.5</td>
<td id="S5.T7.4.4.7.3.5" class="ltx_td ltx_align_right">22.6</td>
<td id="S5.T7.4.4.7.3.6" class="ltx_td ltx_nopad_r ltx_align_right">0.57</td>
</tr>
<tr id="S5.T7.4.4.8.4" class="ltx_tr">
<th id="S5.T7.4.4.8.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb"><span id="S5.T7.4.4.8.4.1.1" class="ltx_text ltx_font_bold">ViT-L/14</span></th>
<td id="S5.T7.4.4.8.4.2" class="ltx_td ltx_align_right ltx_border_bb"><span id="S5.T7.4.4.8.4.2.1" class="ltx_text ltx_font_bold">29.4</span></td>
<td id="S5.T7.4.4.8.4.3" class="ltx_td ltx_align_right ltx_border_bb"><span id="S5.T7.4.4.8.4.3.1" class="ltx_text ltx_font_bold">33.0</span></td>
<td id="S5.T7.4.4.8.4.4" class="ltx_td ltx_align_right ltx_border_bb"><span id="S5.T7.4.4.8.4.4.1" class="ltx_text ltx_font_bold">23.1</span></td>
<td id="S5.T7.4.4.8.4.5" class="ltx_td ltx_align_right ltx_border_bb"><span id="S5.T7.4.4.8.4.5.1" class="ltx_text ltx_font_bold">24.2</span></td>
<td id="S5.T7.4.4.8.4.6" class="ltx_td ltx_nopad_r ltx_align_right ltx_border_bb">0.58</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
</section>
</section>
<section id="S5.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.3 </span>Additional Design Choice</h3>

<div id="S5.SS3.p1" class="ltx_para ltx_noindent">
<p id="S5.SS3.p1.1" class="ltx_p">We explore two supplementary design choices to utilize the ViT-based CLIP model in a manner that achieves the best balance between OVD performance and inference speed. We provide more supplementary analysis on applying RoI-based masked attention to different attention layers and using different pre-trained ViT backbones with Prompt-OVD in Appendix D.</p>
</div>
<section id="S5.SS3.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.3.1 </span>CLIP Model Size</h4>

<div id="S5.SS3.SSS1.p1" class="ltx_para">
<p id="S5.SS3.SSS1.p1.1" class="ltx_p">Table <a href="#S5.T7" title="Table 7 ‣ 5.2.5 RoI Pruning Threshold ‣ 5.2 Main Ablation Study ‣ 5 Evaluation ‣ ​​Prompt-Guided Transformers for End-to-End Open-Vocabulary Object Detection​​" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a> summarizes the performance obtained after the ensemble with three different sizes of ViT-based CLIP models, including the scenario where CLIP is not used at all. We observe that without using the ensemble technique, the zero-shot performance is very poor compared to when CLIP is employed. However, as the size of the CLIP model increases, both zero-shot and overall performance improve, albeit with slightly higher inference speed. The difference in inference time is negligible due to our proposed efficient techniques; RoI-based masked attention and RoI pruning. Therefore, we conclude that the benefits obtained from using a larger CLIP encoder with ViT-L/14 outweigh the minimal increase in inference time.</p>
</div>
</section>
<section id="S5.SS3.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.3.2 </span>CLIP Input Resolution</h4>

<div id="S5.SS3.SSS2.p1" class="ltx_para">
<p id="S5.SS3.SSS2.p1.3" class="ltx_p">Another design consideration is the resolution of input to the ViT-based CLIP. To evaluate the performance trade-off between detection accuracy and latency of CLIP, we vary the input image size and report the results in Table <a href="#S5.T8" title="Table 8 ‣ 5.3.2 CLIP Input Resolution ‣ 5.3 Additional Design Choice ‣ 5 Evaluation ‣ ​​Prompt-Guided Transformers for End-to-End Open-Vocabulary Object Detection​​" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a>. Similar to the model size, the latency change by input resolution is negligible thanks to our efficient methodological design. This indicates that we can use a variety of image resolutions without sacrificing the latency of Prompt-OVD. However, the best image resolution for the ViT-L/14 encoder is <math id="S5.SS3.SSS2.p1.1.m1.1" class="ltx_Math" alttext="336\times 336" display="inline"><semantics id="S5.SS3.SSS2.p1.1.m1.1a"><mrow id="S5.SS3.SSS2.p1.1.m1.1.1" xref="S5.SS3.SSS2.p1.1.m1.1.1.cmml"><mn id="S5.SS3.SSS2.p1.1.m1.1.1.2" xref="S5.SS3.SSS2.p1.1.m1.1.1.2.cmml">336</mn><mo lspace="0.222em" rspace="0.222em" id="S5.SS3.SSS2.p1.1.m1.1.1.1" xref="S5.SS3.SSS2.p1.1.m1.1.1.1.cmml">×</mo><mn id="S5.SS3.SSS2.p1.1.m1.1.1.3" xref="S5.SS3.SSS2.p1.1.m1.1.1.3.cmml">336</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.SSS2.p1.1.m1.1b"><apply id="S5.SS3.SSS2.p1.1.m1.1.1.cmml" xref="S5.SS3.SSS2.p1.1.m1.1.1"><times id="S5.SS3.SSS2.p1.1.m1.1.1.1.cmml" xref="S5.SS3.SSS2.p1.1.m1.1.1.1"></times><cn type="integer" id="S5.SS3.SSS2.p1.1.m1.1.1.2.cmml" xref="S5.SS3.SSS2.p1.1.m1.1.1.2">336</cn><cn type="integer" id="S5.SS3.SSS2.p1.1.m1.1.1.3.cmml" xref="S5.SS3.SSS2.p1.1.m1.1.1.3">336</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.SSS2.p1.1.m1.1c">336\times 336</annotation></semantics></math>, which is the original input size used to train the CLIP model, while the detection accuracy for base and novel classes drops with a larger <math id="S5.SS3.SSS2.p1.2.m2.1" class="ltx_Math" alttext="672\times 672" display="inline"><semantics id="S5.SS3.SSS2.p1.2.m2.1a"><mrow id="S5.SS3.SSS2.p1.2.m2.1.1" xref="S5.SS3.SSS2.p1.2.m2.1.1.cmml"><mn id="S5.SS3.SSS2.p1.2.m2.1.1.2" xref="S5.SS3.SSS2.p1.2.m2.1.1.2.cmml">672</mn><mo lspace="0.222em" rspace="0.222em" id="S5.SS3.SSS2.p1.2.m2.1.1.1" xref="S5.SS3.SSS2.p1.2.m2.1.1.1.cmml">×</mo><mn id="S5.SS3.SSS2.p1.2.m2.1.1.3" xref="S5.SS3.SSS2.p1.2.m2.1.1.3.cmml">672</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.SSS2.p1.2.m2.1b"><apply id="S5.SS3.SSS2.p1.2.m2.1.1.cmml" xref="S5.SS3.SSS2.p1.2.m2.1.1"><times id="S5.SS3.SSS2.p1.2.m2.1.1.1.cmml" xref="S5.SS3.SSS2.p1.2.m2.1.1.1"></times><cn type="integer" id="S5.SS3.SSS2.p1.2.m2.1.1.2.cmml" xref="S5.SS3.SSS2.p1.2.m2.1.1.2">672</cn><cn type="integer" id="S5.SS3.SSS2.p1.2.m2.1.1.3.cmml" xref="S5.SS3.SSS2.p1.2.m2.1.1.3">672</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.SSS2.p1.2.m2.1c">672\times 672</annotation></semantics></math>. The <math id="S5.SS3.SSS2.p1.3.m3.1" class="ltx_Math" alttext="336\times 336" display="inline"><semantics id="S5.SS3.SSS2.p1.3.m3.1a"><mrow id="S5.SS3.SSS2.p1.3.m3.1.1" xref="S5.SS3.SSS2.p1.3.m3.1.1.cmml"><mn id="S5.SS3.SSS2.p1.3.m3.1.1.2" xref="S5.SS3.SSS2.p1.3.m3.1.1.2.cmml">336</mn><mo lspace="0.222em" rspace="0.222em" id="S5.SS3.SSS2.p1.3.m3.1.1.1" xref="S5.SS3.SSS2.p1.3.m3.1.1.1.cmml">×</mo><mn id="S5.SS3.SSS2.p1.3.m3.1.1.3" xref="S5.SS3.SSS2.p1.3.m3.1.1.3.cmml">336</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.SSS2.p1.3.m3.1b"><apply id="S5.SS3.SSS2.p1.3.m3.1.1.cmml" xref="S5.SS3.SSS2.p1.3.m3.1.1"><times id="S5.SS3.SSS2.p1.3.m3.1.1.1.cmml" xref="S5.SS3.SSS2.p1.3.m3.1.1.1"></times><cn type="integer" id="S5.SS3.SSS2.p1.3.m3.1.1.2.cmml" xref="S5.SS3.SSS2.p1.3.m3.1.1.2">336</cn><cn type="integer" id="S5.SS3.SSS2.p1.3.m3.1.1.3.cmml" xref="S5.SS3.SSS2.p1.3.m3.1.1.3">336</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.SSS2.p1.3.m3.1c">336\times 336</annotation></semantics></math> provides a good balance between detection accuracy and inference time, so it is the recommended input resolution.</p>
</div>
<figure id="S5.T8" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="S5.T8.9.1.1" class="ltx_text" style="font-size:90%;">Table 8</span>: </span><span id="S5.T8.10.2" class="ltx_text" style="font-size:90%;">Performance when using different input image resolution for ViT-based CLIP on OV-LVIS.</span></figcaption>
<div id="S5.T8.7" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:114.7pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(80.7pt,-21.4pt) scale(1.59307538502738,1.59307538502738) ;">
<table id="S5.T8.7.7" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S5.T8.4.4.4" class="ltx_tr">
<th id="S5.T8.4.4.4.5" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt">img. res.</th>
<th id="S5.T8.1.1.1.1" class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_tt"><math id="S5.T8.1.1.1.1.m1.1" class="ltx_Math" alttext="\mathrm{mAP^{box}_{novel}}" display="inline"><semantics id="S5.T8.1.1.1.1.m1.1a"><msubsup id="S5.T8.1.1.1.1.m1.1.1" xref="S5.T8.1.1.1.1.m1.1.1.cmml"><mi id="S5.T8.1.1.1.1.m1.1.1.2.2" xref="S5.T8.1.1.1.1.m1.1.1.2.2.cmml">mAP</mi><mi id="S5.T8.1.1.1.1.m1.1.1.3" xref="S5.T8.1.1.1.1.m1.1.1.3.cmml">novel</mi><mi id="S5.T8.1.1.1.1.m1.1.1.2.3" xref="S5.T8.1.1.1.1.m1.1.1.2.3.cmml">box</mi></msubsup><annotation-xml encoding="MathML-Content" id="S5.T8.1.1.1.1.m1.1b"><apply id="S5.T8.1.1.1.1.m1.1.1.cmml" xref="S5.T8.1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S5.T8.1.1.1.1.m1.1.1.1.cmml" xref="S5.T8.1.1.1.1.m1.1.1">subscript</csymbol><apply id="S5.T8.1.1.1.1.m1.1.1.2.cmml" xref="S5.T8.1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S5.T8.1.1.1.1.m1.1.1.2.1.cmml" xref="S5.T8.1.1.1.1.m1.1.1">superscript</csymbol><ci id="S5.T8.1.1.1.1.m1.1.1.2.2.cmml" xref="S5.T8.1.1.1.1.m1.1.1.2.2">mAP</ci><ci id="S5.T8.1.1.1.1.m1.1.1.2.3.cmml" xref="S5.T8.1.1.1.1.m1.1.1.2.3">box</ci></apply><ci id="S5.T8.1.1.1.1.m1.1.1.3.cmml" xref="S5.T8.1.1.1.1.m1.1.1.3">novel</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T8.1.1.1.1.m1.1c">\mathrm{mAP^{box}_{novel}}</annotation></semantics></math></th>
<th id="S5.T8.2.2.2.2" class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_tt"><math id="S5.T8.2.2.2.2.m1.1" class="ltx_Math" alttext="\mathrm{mAP^{box}}" display="inline"><semantics id="S5.T8.2.2.2.2.m1.1a"><msup id="S5.T8.2.2.2.2.m1.1.1" xref="S5.T8.2.2.2.2.m1.1.1.cmml"><mi id="S5.T8.2.2.2.2.m1.1.1.2" xref="S5.T8.2.2.2.2.m1.1.1.2.cmml">mAP</mi><mi id="S5.T8.2.2.2.2.m1.1.1.3" xref="S5.T8.2.2.2.2.m1.1.1.3.cmml">box</mi></msup><annotation-xml encoding="MathML-Content" id="S5.T8.2.2.2.2.m1.1b"><apply id="S5.T8.2.2.2.2.m1.1.1.cmml" xref="S5.T8.2.2.2.2.m1.1.1"><csymbol cd="ambiguous" id="S5.T8.2.2.2.2.m1.1.1.1.cmml" xref="S5.T8.2.2.2.2.m1.1.1">superscript</csymbol><ci id="S5.T8.2.2.2.2.m1.1.1.2.cmml" xref="S5.T8.2.2.2.2.m1.1.1.2">mAP</ci><ci id="S5.T8.2.2.2.2.m1.1.1.3.cmml" xref="S5.T8.2.2.2.2.m1.1.1.3">box</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T8.2.2.2.2.m1.1c">\mathrm{mAP^{box}}</annotation></semantics></math></th>
<th id="S5.T8.3.3.3.3" class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_tt"><math id="S5.T8.3.3.3.3.m1.1" class="ltx_Math" alttext="\mathrm{mAP^{mask}_{novel}}" display="inline"><semantics id="S5.T8.3.3.3.3.m1.1a"><msubsup id="S5.T8.3.3.3.3.m1.1.1" xref="S5.T8.3.3.3.3.m1.1.1.cmml"><mi id="S5.T8.3.3.3.3.m1.1.1.2.2" xref="S5.T8.3.3.3.3.m1.1.1.2.2.cmml">mAP</mi><mi id="S5.T8.3.3.3.3.m1.1.1.3" xref="S5.T8.3.3.3.3.m1.1.1.3.cmml">novel</mi><mi id="S5.T8.3.3.3.3.m1.1.1.2.3" xref="S5.T8.3.3.3.3.m1.1.1.2.3.cmml">mask</mi></msubsup><annotation-xml encoding="MathML-Content" id="S5.T8.3.3.3.3.m1.1b"><apply id="S5.T8.3.3.3.3.m1.1.1.cmml" xref="S5.T8.3.3.3.3.m1.1.1"><csymbol cd="ambiguous" id="S5.T8.3.3.3.3.m1.1.1.1.cmml" xref="S5.T8.3.3.3.3.m1.1.1">subscript</csymbol><apply id="S5.T8.3.3.3.3.m1.1.1.2.cmml" xref="S5.T8.3.3.3.3.m1.1.1"><csymbol cd="ambiguous" id="S5.T8.3.3.3.3.m1.1.1.2.1.cmml" xref="S5.T8.3.3.3.3.m1.1.1">superscript</csymbol><ci id="S5.T8.3.3.3.3.m1.1.1.2.2.cmml" xref="S5.T8.3.3.3.3.m1.1.1.2.2">mAP</ci><ci id="S5.T8.3.3.3.3.m1.1.1.2.3.cmml" xref="S5.T8.3.3.3.3.m1.1.1.2.3">mask</ci></apply><ci id="S5.T8.3.3.3.3.m1.1.1.3.cmml" xref="S5.T8.3.3.3.3.m1.1.1.3">novel</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T8.3.3.3.3.m1.1c">\mathrm{mAP^{mask}_{novel}}</annotation></semantics></math></th>
<th id="S5.T8.4.4.4.4" class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_tt"><math id="S5.T8.4.4.4.4.m1.1" class="ltx_Math" alttext="\mathrm{mAP^{mask}}" display="inline"><semantics id="S5.T8.4.4.4.4.m1.1a"><msup id="S5.T8.4.4.4.4.m1.1.1" xref="S5.T8.4.4.4.4.m1.1.1.cmml"><mi id="S5.T8.4.4.4.4.m1.1.1.2" xref="S5.T8.4.4.4.4.m1.1.1.2.cmml">mAP</mi><mi id="S5.T8.4.4.4.4.m1.1.1.3" xref="S5.T8.4.4.4.4.m1.1.1.3.cmml">mask</mi></msup><annotation-xml encoding="MathML-Content" id="S5.T8.4.4.4.4.m1.1b"><apply id="S5.T8.4.4.4.4.m1.1.1.cmml" xref="S5.T8.4.4.4.4.m1.1.1"><csymbol cd="ambiguous" id="S5.T8.4.4.4.4.m1.1.1.1.cmml" xref="S5.T8.4.4.4.4.m1.1.1">superscript</csymbol><ci id="S5.T8.4.4.4.4.m1.1.1.2.cmml" xref="S5.T8.4.4.4.4.m1.1.1.2">mAP</ci><ci id="S5.T8.4.4.4.4.m1.1.1.3.cmml" xref="S5.T8.4.4.4.4.m1.1.1.3">mask</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T8.4.4.4.4.m1.1c">\mathrm{mAP^{mask}}</annotation></semantics></math></th>
<th id="S5.T8.4.4.4.6" class="ltx_td ltx_nopad_r ltx_align_right ltx_th ltx_th_column ltx_border_tt">Latency</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S5.T8.5.5.5" class="ltx_tr">
<th id="S5.T8.5.5.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">168<math id="S5.T8.5.5.5.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S5.T8.5.5.5.1.m1.1a"><mo id="S5.T8.5.5.5.1.m1.1.1" xref="S5.T8.5.5.5.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S5.T8.5.5.5.1.m1.1b"><times id="S5.T8.5.5.5.1.m1.1.1.cmml" xref="S5.T8.5.5.5.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S5.T8.5.5.5.1.m1.1c">\times</annotation></semantics></math>168</th>
<td id="S5.T8.5.5.5.2" class="ltx_td ltx_align_right ltx_border_t">28.5</td>
<td id="S5.T8.5.5.5.3" class="ltx_td ltx_align_right ltx_border_t">30.1</td>
<td id="S5.T8.5.5.5.4" class="ltx_td ltx_align_right ltx_border_t">20.9</td>
<td id="S5.T8.5.5.5.5" class="ltx_td ltx_align_right ltx_border_t">22.0</td>
<td id="S5.T8.5.5.5.6" class="ltx_td ltx_nopad_r ltx_align_right ltx_border_t">0.57</td>
</tr>
<tr id="S5.T8.6.6.6" class="ltx_tr">
<th id="S5.T8.6.6.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S5.T8.6.6.6.1.1" class="ltx_text ltx_font_bold">336<math id="S5.T8.6.6.6.1.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S5.T8.6.6.6.1.1.m1.1a"><mo id="S5.T8.6.6.6.1.1.m1.1.1" xref="S5.T8.6.6.6.1.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S5.T8.6.6.6.1.1.m1.1b"><times id="S5.T8.6.6.6.1.1.m1.1.1.cmml" xref="S5.T8.6.6.6.1.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S5.T8.6.6.6.1.1.m1.1c">\times</annotation></semantics></math>336</span></th>
<td id="S5.T8.6.6.6.2" class="ltx_td ltx_align_right"><span id="S5.T8.6.6.6.2.1" class="ltx_text ltx_font_bold">29.4</span></td>
<td id="S5.T8.6.6.6.3" class="ltx_td ltx_align_right"><span id="S5.T8.6.6.6.3.1" class="ltx_text ltx_font_bold">33.0</span></td>
<td id="S5.T8.6.6.6.4" class="ltx_td ltx_align_right"><span id="S5.T8.6.6.6.4.1" class="ltx_text ltx_font_bold">23.1</span></td>
<td id="S5.T8.6.6.6.5" class="ltx_td ltx_align_right"><span id="S5.T8.6.6.6.5.1" class="ltx_text ltx_font_bold">24.2</span></td>
<td id="S5.T8.6.6.6.6" class="ltx_td ltx_nopad_r ltx_align_right">0.58</td>
</tr>
<tr id="S5.T8.7.7.7" class="ltx_tr">
<th id="S5.T8.7.7.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb">672<math id="S5.T8.7.7.7.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S5.T8.7.7.7.1.m1.1a"><mo id="S5.T8.7.7.7.1.m1.1.1" xref="S5.T8.7.7.7.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S5.T8.7.7.7.1.m1.1b"><times id="S5.T8.7.7.7.1.m1.1.1.cmml" xref="S5.T8.7.7.7.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S5.T8.7.7.7.1.m1.1c">\times</annotation></semantics></math>672</th>
<td id="S5.T8.7.7.7.2" class="ltx_td ltx_align_right ltx_border_bb">29.2</td>
<td id="S5.T8.7.7.7.3" class="ltx_td ltx_align_right ltx_border_bb">33.0</td>
<td id="S5.T8.7.7.7.4" class="ltx_td ltx_align_right ltx_border_bb">23.0</td>
<td id="S5.T8.7.7.7.5" class="ltx_td ltx_align_right ltx_border_bb">24.2</td>
<td id="S5.T8.7.7.7.6" class="ltx_td ltx_nopad_r ltx_align_right ltx_border_bb">0.83</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
</section>
</section>
</section>
<section id="S6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Conclusion</h2>

<div id="S6.p1" class="ltx_para">
<p id="S6.p1.1" class="ltx_p">We introduce Prompt-OVD, a novel object detection method that achieves highly efficient inference speed while also improving zero-shot generalization compared with existing methods. The prompt-based decoding approach reduces the computational burden of object queries. The RoI-based masked attention and RoI pruning techniques allow us to efficiently leverage a large ViT-based CLIP model, enhancing detection performance through classification prediction ensembling. Comprehensive experiments show that Prompt-OVD is <math id="S6.p1.1.m1.1" class="ltx_Math" alttext="21.2" display="inline"><semantics id="S6.p1.1.m1.1a"><mn id="S6.p1.1.m1.1.1" xref="S6.p1.1.m1.1.1.cmml">21.2</mn><annotation-xml encoding="MathML-Content" id="S6.p1.1.m1.1b"><cn type="float" id="S6.p1.1.m1.1.1.cmml" xref="S6.p1.1.m1.1.1">21.2</cn></annotation-xml><annotation encoding="application/x-tex" id="S6.p1.1.m1.1c">21.2</annotation></semantics></math> times faster than OV-DETR while achieving comparable or higher APs on base and novel classes compared to two-stage OVD methods.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography" style="font-size:90%;">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock"><span id="bib.bib1.1.1" class="ltx_text" style="font-size:90%;">
Nicolas Carion, Francisco Massa, Gabriel Synnaeve, Nicolas Usunier, Alexander
Kirillov, and Sergey Zagoruyko.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib1.2.1" class="ltx_text" style="font-size:90%;">End-to-end object detection with transformers.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib1.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib1.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ECCV</span><span id="bib.bib1.5.3" class="ltx_text" style="font-size:90%;">, 2020.
</span>
</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock"><span id="bib.bib2.1.1" class="ltx_text" style="font-size:90%;">
Jia Deng, Wei Dong, Richard Socher, Li-Jia Li, Kai Li, and Li Fei-Fei.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib2.2.1" class="ltx_text" style="font-size:90%;">Imagenet: A large-scale hierarchical image database.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib2.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib2.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">CVPR</span><span id="bib.bib2.5.3" class="ltx_text" style="font-size:90%;">, pages 248–255, 2009.
</span>
</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock"><span id="bib.bib3.1.1" class="ltx_text" style="font-size:90%;">
Bin Dong, Fangao Zeng, Tiancai Wang, Xiangyu Zhang, and Yichen Wei.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib3.2.1" class="ltx_text" style="font-size:90%;">Solq: Segmenting objects by learning queries.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib3.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">NeurIPS</span><span id="bib.bib3.4.2" class="ltx_text" style="font-size:90%;">, 2021.
</span>
</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock"><span id="bib.bib4.1.1" class="ltx_text" style="font-size:90%;">
Alexey Dosovitskiy, Lucas Beyer, Alexander Kolesnikov, Dirk Weissenborn,
Xiaohua Zhai, Thomas Unterthiner, Mostafa Dehghani, Matthias Minderer, Georg
Heigold, Sylvain Gelly, et al.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib4.2.1" class="ltx_text" style="font-size:90%;">An image is worth 16x16 words: Transformers for image recognition at
scale.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib4.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib4.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ICLR</span><span id="bib.bib4.5.3" class="ltx_text" style="font-size:90%;">, 2021.
</span>
</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock"><span id="bib.bib5.1.1" class="ltx_text" style="font-size:90%;">
Yu Du, Fangyun Wei, Zihe Zhang, Miaojing Shi, Yue Gao, and Guoqi Li.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib5.2.1" class="ltx_text" style="font-size:90%;">Learning to prompt for open-vocabulary object detection with
vision-language model.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib5.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib5.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">CVPR</span><span id="bib.bib5.5.3" class="ltx_text" style="font-size:90%;">, 2022.
</span>
</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock"><span id="bib.bib6.1.1" class="ltx_text" style="font-size:90%;">
Yuxin Fang, Bencheng Liao, Xinggang Wang, Jiemin Fang, Jiyang Qi, Rui Wu,
Jianwei Niu, and Wenyu Liu.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib6.2.1" class="ltx_text" style="font-size:90%;">You only look at one sequence: Rethinking transformer in vision
through object detection.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib6.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib6.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">NeurIPS</span><span id="bib.bib6.5.3" class="ltx_text" style="font-size:90%;">, 2021.
</span>
</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock"><span id="bib.bib7.1.1" class="ltx_text" style="font-size:90%;">
Xiuye Gu, Tsung-Yi Lin, Weicheng Kuo, and Yin Cui.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib7.2.1" class="ltx_text" style="font-size:90%;">Open-vocabulary object detection via vision and language knowledge
distillation.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib7.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib7.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ICLR</span><span id="bib.bib7.5.3" class="ltx_text" style="font-size:90%;">, 2022.
</span>
</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock"><span id="bib.bib8.1.1" class="ltx_text" style="font-size:90%;">
Agrim Gupta, Piotr Dollar, and Ross Girshick.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib8.2.1" class="ltx_text" style="font-size:90%;">LVIS: A dataset for large vocabulary instance segmentation.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib8.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib8.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">CVPR</span><span id="bib.bib8.5.3" class="ltx_text" style="font-size:90%;">, 2019.
</span>
</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock"><span id="bib.bib9.1.1" class="ltx_text" style="font-size:90%;">
Kai Han, Yunhe Wang, Hanting Chen, Xinghao Chen, Jianyuan Guo, Zhenhua Liu,
Yehui Tang, An Xiao, Chunjing Xu, Yixing Xu, et al.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib9.2.1" class="ltx_text" style="font-size:90%;">A survey on vision transformer.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib9.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">Transactions on Pattern Analysis and Machine Intelligence</span><span id="bib.bib9.4.2" class="ltx_text" style="font-size:90%;">,
45(1), 2022.
</span>
</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock"><span id="bib.bib10.1.1" class="ltx_text" style="font-size:90%;">
Kaiming He, Xinlei Chen, Saining Xie, Yanghao Li, Piotr Dollár, and Ross
Girshick.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib10.2.1" class="ltx_text" style="font-size:90%;">Masked autoencoders are scalable vision learners.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib10.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib10.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">CVPR</span><span id="bib.bib10.5.3" class="ltx_text" style="font-size:90%;">, 2022.
</span>
</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock"><span id="bib.bib11.1.1" class="ltx_text" style="font-size:90%;">
Kaiming He, Georgia Gkioxari, Piotr Dollár, and Ross Girshick.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib11.2.1" class="ltx_text" style="font-size:90%;">Mask R-CNN.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib11.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib11.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ICCV</span><span id="bib.bib11.5.3" class="ltx_text" style="font-size:90%;">, 2017.
</span>
</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock"><span id="bib.bib12.1.1" class="ltx_text" style="font-size:90%;">
Weicheng Kuo, Yin Cui, Xiuye Gu, AJ Piergiovanni, and Anelia Angelova.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib12.2.1" class="ltx_text" style="font-size:90%;">Open-vocabulary object detection upon frozen vision and language
models.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib12.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib12.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ICLR</span><span id="bib.bib12.5.3" class="ltx_text" style="font-size:90%;">, 2023.
</span>
</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock"><span id="bib.bib13.1.1" class="ltx_text" style="font-size:90%;">
Yanghao Li, Hanzi Mao, Ross Girshick, and Kaiming He.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib13.2.1" class="ltx_text" style="font-size:90%;">Exploring plain vision transformer backbones for object detection.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib13.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib13.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ECCV</span><span id="bib.bib13.5.3" class="ltx_text" style="font-size:90%;">, pages 280–296, 2022.
</span>
</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock"><span id="bib.bib14.1.1" class="ltx_text" style="font-size:90%;">
Zhishan Li, Ying Nie, Kai Han, Jianyuan Guo, Lei Xie, and Yunhe Wang.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib14.2.1" class="ltx_text" style="font-size:90%;">A transformer-based object detector with coarse-fine crossing
representations.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib14.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib14.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">NeurIPS</span><span id="bib.bib14.5.3" class="ltx_text" style="font-size:90%;">, 2022.
</span>
</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock"><span id="bib.bib15.1.1" class="ltx_text" style="font-size:90%;">
Tsung-Yi Lin, Priya Goyal, Ross Girshick, Kaiming He, and Piotr Dollár.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib15.2.1" class="ltx_text" style="font-size:90%;">Focal loss for dense object detection.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib15.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib15.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ICCV</span><span id="bib.bib15.5.3" class="ltx_text" style="font-size:90%;">, pages 2980–2988, 2017.
</span>
</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock"><span id="bib.bib16.1.1" class="ltx_text" style="font-size:90%;">
Tsung-Yi Lin, Michael Maire, Serge Belongie, James Hays, Pietro Perona, Deva
Ramanan, Piotr Dollár, and C Lawrence Zitnick.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib16.2.1" class="ltx_text" style="font-size:90%;">Microsoft coco: Common objects in context.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib16.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib16.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ECCV</span><span id="bib.bib16.5.3" class="ltx_text" style="font-size:90%;">, 2014.
</span>
</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock"><span id="bib.bib17.1.1" class="ltx_text" style="font-size:90%;">
Ze Liu, Yutong Lin, Yue Cao, Han Hu, Yixuan Wei, Zheng Zhang, Stephen Lin, and
Baining Guo.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib17.2.1" class="ltx_text" style="font-size:90%;">Swin transformer: Hierarchical vision transformer using shifted
windows.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib17.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib17.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">CVPR</span><span id="bib.bib17.5.3" class="ltx_text" style="font-size:90%;">, 2021.
</span>
</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock"><span id="bib.bib18.1.1" class="ltx_text" style="font-size:90%;">
Matthias Minderer, Alexey Gritsenko, Austin Stone, Maxim Neumann, Dirk
Weissenborn, Alexey Dosovitskiy, Aravindh Mahendran, Anurag Arnab, Mostafa
Dehghani, Zhuoran Shen, et al.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib18.2.1" class="ltx_text" style="font-size:90%;">Simple open-vocabulary object detection with vision transformers.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib18.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">ECCV</span><span id="bib.bib18.4.2" class="ltx_text" style="font-size:90%;">, 2022.
</span>
</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock"><span id="bib.bib19.1.1" class="ltx_text" style="font-size:90%;">
Rafael Padilla, Sergio L Netto, and Eduardo AB Da Silva.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib19.2.1" class="ltx_text" style="font-size:90%;">A survey on performance metrics for object-detection algorithms.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib19.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib19.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">IWSSIP</span><span id="bib.bib19.5.3" class="ltx_text" style="font-size:90%;">, pages 237–242, 2020.
</span>
</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock"><span id="bib.bib20.1.1" class="ltx_text" style="font-size:90%;">
Constantine P Papageorgiou, Michael Oren, and Tomaso Poggio.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib20.2.1" class="ltx_text" style="font-size:90%;">A general framework for object detection.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib20.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib20.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ICCV</span><span id="bib.bib20.5.3" class="ltx_text" style="font-size:90%;">, pages 555–562, 1998.
</span>
</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock"><span id="bib.bib21.1.1" class="ltx_text" style="font-size:90%;">
Alec Radford, Jong Wook Kim, Chris Hallacy, Aditya Ramesh, Gabriel Goh,
Sandhini Agarwal, Girish Sastry, Amanda Askell, Pamela Mishkin, Jack Clark,
et al.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib21.2.1" class="ltx_text" style="font-size:90%;">Learning transferable visual models from natural language
supervision.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib21.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib21.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ICML</span><span id="bib.bib21.5.3" class="ltx_text" style="font-size:90%;">, 2021.
</span>
</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock"><span id="bib.bib22.1.1" class="ltx_text" style="font-size:90%;">
Hanoona Abdul Rasheed, Muhammad Maaz, Muhammd Uzair Khattak, Salman Khan, and
Fahad Khan.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib22.2.1" class="ltx_text" style="font-size:90%;">Bridging the gap between object and image-level representations for
open-vocabulary detection.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib22.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib22.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">NeurIPS</span><span id="bib.bib22.5.3" class="ltx_text" style="font-size:90%;">, 2022.
</span>
</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock"><span id="bib.bib23.1.1" class="ltx_text" style="font-size:90%;">
Joseph Redmon, Santosh Divvala, Ross Girshick, and Ali Farhadi.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib23.2.1" class="ltx_text" style="font-size:90%;">You only look once: Unified, real-time object detection.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib23.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib23.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">CVPR</span><span id="bib.bib23.5.3" class="ltx_text" style="font-size:90%;">, 2016.
</span>
</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock"><span id="bib.bib24.1.1" class="ltx_text" style="font-size:90%;">
Hamid Rezatofighi, Nathan Tsoi, JunYoung Gwak, Amir Sadeghian, Ian Reid, and
Silvio Savarese.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib24.2.1" class="ltx_text" style="font-size:90%;">Generalized intersection over union: A metric and a loss for bounding
box regression.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib24.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib24.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">CVPR</span><span id="bib.bib24.5.3" class="ltx_text" style="font-size:90%;">, pages 658–666, 2019.
</span>
</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock"><span id="bib.bib25.1.1" class="ltx_text" style="font-size:90%;">
Piyush Sharma, Nan Ding, Sebastian Goodman, and Radu Soricut.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib25.2.1" class="ltx_text" style="font-size:90%;">Conceptual captions: A cleaned, hypernymed, image alt-text dataset
for automatic image captioning.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib25.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib25.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ACL</span><span id="bib.bib25.5.3" class="ltx_text" style="font-size:90%;">, pages 2556–2565, 2018.
</span>
</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock"><span id="bib.bib26.1.1" class="ltx_text" style="font-size:90%;">
Hwanjun Song, Deqing Sun, Sanghyuk Chun, Varun Jampani, Dongyoon Han, Byeongho
Heo, Wonjae Kim, and Ming-Hsuan Yang.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib26.2.1" class="ltx_text" style="font-size:90%;">An extendable, efficient and effective transformer-based object
detector.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib26.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:2204.07962</span><span id="bib.bib26.4.2" class="ltx_text" style="font-size:90%;">, 2022.
</span>
</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock"><span id="bib.bib27.1.1" class="ltx_text" style="font-size:90%;">
Hwanjun Song, Deqing Sun, Sanghyuk Chun, Varun Jampani, Dongyoon Han, Byeongho
Heo, Wonjae Kim, and Ming-Hsuan Yang.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib27.2.1" class="ltx_text" style="font-size:90%;">Vidt: An efficient and effective fully transformer-based object
detector.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib27.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib27.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ICLR</span><span id="bib.bib27.5.3" class="ltx_text" style="font-size:90%;">, 2022.
</span>
</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock"><span id="bib.bib28.1.1" class="ltx_text" style="font-size:90%;">
Ashish Vaswani, Noam Shazeer, Niki Parmar, Jakob Uszkoreit, Llion Jones,
Aidan N Gomez, Łukasz Kaiser, and Illia Polosukhin.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib28.2.1" class="ltx_text" style="font-size:90%;">Attention is all you need.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib28.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib28.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">NeurIPS</span><span id="bib.bib28.5.3" class="ltx_text" style="font-size:90%;">, 2017.
</span>
</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock"><span id="bib.bib29.1.1" class="ltx_text" style="font-size:90%;">
Yuhang Zang, Wei Li, Kaiyang Zhou, Chen Huang, and Chen Change Loy.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib29.2.1" class="ltx_text" style="font-size:90%;">Open-vocabulary DERT with conditional matching.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib29.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib29.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ECCV</span><span id="bib.bib29.5.3" class="ltx_text" style="font-size:90%;">, pages 106–122, 2022.
</span>
</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock"><span id="bib.bib30.1.1" class="ltx_text" style="font-size:90%;">
Alireza Zareian, Kevin Dela Rosa, Derek Hao Hu, and Shih-Fu Chang.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib30.2.1" class="ltx_text" style="font-size:90%;">Open-vocabulary object detection using captions.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib30.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib30.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">CVPR</span><span id="bib.bib30.5.3" class="ltx_text" style="font-size:90%;">, pages 14393–14402, 2021.
</span>
</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock"><span id="bib.bib31.1.1" class="ltx_text" style="font-size:90%;">
Yiwu Zhong, Jianwei Yang, Pengchuan Zhang, Chunyuan Li, Noel Codella,
Liunian Harold Li, Luowei Zhou, Xiyang Dai, Lu Yuan, Yin Li, et al.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib31.2.1" class="ltx_text" style="font-size:90%;">RegionClip: Region-based language-image pretraining.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib31.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib31.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">CVPR</span><span id="bib.bib31.5.3" class="ltx_text" style="font-size:90%;">, pages 16793–16803, 2022.
</span>
</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[32]</span>
<span class="ltx_bibblock"><span id="bib.bib32.1.1" class="ltx_text" style="font-size:90%;">
Xingyi Zhou, Rohit Girdhar, Armand Joulin, Philipp Krähenbühl, and
Ishan Misra.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib32.2.1" class="ltx_text" style="font-size:90%;">Detecting twenty-thousand classes using image-level supervision.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib32.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib32.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ECCV</span><span id="bib.bib32.5.3" class="ltx_text" style="font-size:90%;">, pages 350–368, 2022.
</span>
</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[33]</span>
<span class="ltx_bibblock"><span id="bib.bib33.1.1" class="ltx_text" style="font-size:90%;">
Xizhou Zhu, Weijie Su, Lewei Lu, Bin Li, Xiaogang Wang, and Jifeng Dai.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib33.2.1" class="ltx_text" style="font-size:90%;">Deformable DETR: Deformable transformers for end-to-end object
detection.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib33.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib33.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ICLR</span><span id="bib.bib33.5.3" class="ltx_text" style="font-size:90%;">, 2021.
</span>
</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<section id="A1" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Training and Evaluation Details</h2>

<figure id="A1.F5" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><img src="/html/2303.14386/assets/x5.png" id="A1.F5.1.g1" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" width="505" height="138" alt="Refer to caption"></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p id="A1.F5.3" class="ltx_p ltx_figure_panel">(a) Grilled salmon                  (b) Crepe                     (c) Omelette                    (d) Burrito</p>
</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="A1.F5.4.1.1" class="ltx_text" style="font-size:90%;">Figure 5</span>: </span><span id="A1.F5.5.2" class="ltx_text" style="font-size:90%;">Image-conditioned open-vocabulary detection. Image queries are from novel classes and the sub-captions represent text corresponding to the image queries.</span></figcaption>
</figure>
<div id="A1.p1" class="ltx_para">
<p id="A1.p1.1" class="ltx_p">We assess our method by conducting experiments on two widely used open-vocabulary object detection datasets, namely OV-COCO and OV-LVIS. Following the literature <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>, <a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite>, we split the classes in MS-COCO into 48 base categories and 17 novel categories, where the remaining categories are not included since they do not belong to a synset in the WordNet hierarhiy <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>]</cite>. Regarding OV-LVIS, we follow the setup of <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>]</cite>, selecting 337 rare classes as novel categories and the remaining classes as common and frequent categories. Because of the difference in the number of object categories, OV-LVIS has a much larger number of objects to detect. Additionally, the number of object queries should be larger than the number of actual objects in an image. Therefore, the number of object queries is set to 300 and 1,500 for OV-COCO and OV-LVIS.</p>
</div>
<div id="A1.p2" class="ltx_para ltx_noindent">
<p id="A1.p2.1" class="ltx_p"><span id="A1.p2.1.1" class="ltx_text ltx_font_bold">Training Loss Function.</span>
Prompt-OVD utilize the loss function from (Deformable) DETR <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>, <a href="#bib.bib33" title="" class="ltx_ref">33</a>]</cite>, which includes a detection head that generates a set of bounding boxes. We modify this for OVD such that the detection head only generates the boxes and class labels given by the class prompts. During the training phase, the number of class prompts can vary according to the number of visible base classes in the current mini-batch.</p>
</div>
<div id="A1.p3" class="ltx_para">
<p id="A1.p3.5" class="ltx_p">Hungarian matching is employed to identify a bipartite matching between the predicted boxes <math id="A1.p3.1.m1.1" class="ltx_Math" alttext="{\rm\hat{B}}" display="inline"><semantics id="A1.p3.1.m1.1a"><mover accent="true" id="A1.p3.1.m1.1.1" xref="A1.p3.1.m1.1.1.cmml"><mi mathvariant="normal" id="A1.p3.1.m1.1.1.2" xref="A1.p3.1.m1.1.1.2.cmml">B</mi><mo id="A1.p3.1.m1.1.1.1" xref="A1.p3.1.m1.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="A1.p3.1.m1.1b"><apply id="A1.p3.1.m1.1.1.cmml" xref="A1.p3.1.m1.1.1"><ci id="A1.p3.1.m1.1.1.1.cmml" xref="A1.p3.1.m1.1.1.1">^</ci><ci id="A1.p3.1.m1.1.1.2.cmml" xref="A1.p3.1.m1.1.1.2">B</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p3.1.m1.1c">{\rm\hat{B}}</annotation></semantics></math> and the ground-truth boxes <math id="A1.p3.2.m2.1" class="ltx_Math" alttext="{\rm{B}}" display="inline"><semantics id="A1.p3.2.m2.1a"><mi mathvariant="normal" id="A1.p3.2.m2.1.1" xref="A1.p3.2.m2.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="A1.p3.2.m2.1b"><ci id="A1.p3.2.m2.1.1.cmml" xref="A1.p3.2.m2.1.1">B</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.p3.2.m2.1c">{\rm{B}}</annotation></semantics></math>. The training process basically involves three types of losses: a classification loss <math id="A1.p3.3.m3.1" class="ltx_Math" alttext="\ell_{\rm cls}" display="inline"><semantics id="A1.p3.3.m3.1a"><msub id="A1.p3.3.m3.1.1" xref="A1.p3.3.m3.1.1.cmml"><mi mathvariant="normal" id="A1.p3.3.m3.1.1.2" xref="A1.p3.3.m3.1.1.2.cmml">ℓ</mi><mi id="A1.p3.3.m3.1.1.3" xref="A1.p3.3.m3.1.1.3.cmml">cls</mi></msub><annotation-xml encoding="MathML-Content" id="A1.p3.3.m3.1b"><apply id="A1.p3.3.m3.1.1.cmml" xref="A1.p3.3.m3.1.1"><csymbol cd="ambiguous" id="A1.p3.3.m3.1.1.1.cmml" xref="A1.p3.3.m3.1.1">subscript</csymbol><ci id="A1.p3.3.m3.1.1.2.cmml" xref="A1.p3.3.m3.1.1.2">ℓ</ci><ci id="A1.p3.3.m3.1.1.3.cmml" xref="A1.p3.3.m3.1.1.3">cls</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p3.3.m3.1c">\ell_{\rm cls}</annotation></semantics></math>, which is the focal loss<span id="footnote2" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span>Multi-label classification is performed only for the classes given by the class prompts.</span></span></span>, a box distance loss <math id="A1.p3.4.m4.1" class="ltx_Math" alttext="\ell_{\rm l1}" display="inline"><semantics id="A1.p3.4.m4.1a"><msub id="A1.p3.4.m4.1.1" xref="A1.p3.4.m4.1.1.cmml"><mi mathvariant="normal" id="A1.p3.4.m4.1.1.2" xref="A1.p3.4.m4.1.1.2.cmml">ℓ</mi><mi id="A1.p3.4.m4.1.1.3" xref="A1.p3.4.m4.1.1.3.cmml">l1</mi></msub><annotation-xml encoding="MathML-Content" id="A1.p3.4.m4.1b"><apply id="A1.p3.4.m4.1.1.cmml" xref="A1.p3.4.m4.1.1"><csymbol cd="ambiguous" id="A1.p3.4.m4.1.1.1.cmml" xref="A1.p3.4.m4.1.1">subscript</csymbol><ci id="A1.p3.4.m4.1.1.2.cmml" xref="A1.p3.4.m4.1.1.2">ℓ</ci><ci id="A1.p3.4.m4.1.1.3.cmml" xref="A1.p3.4.m4.1.1.3">l1</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p3.4.m4.1c">\ell_{\rm l1}</annotation></semantics></math> and a generalized IoU loss <math id="A1.p3.5.m5.1" class="ltx_Math" alttext="\ell_{\rm iou}" display="inline"><semantics id="A1.p3.5.m5.1a"><msub id="A1.p3.5.m5.1.1" xref="A1.p3.5.m5.1.1.cmml"><mi mathvariant="normal" id="A1.p3.5.m5.1.1.2" xref="A1.p3.5.m5.1.1.2.cmml">ℓ</mi><mi id="A1.p3.5.m5.1.1.3" xref="A1.p3.5.m5.1.1.3.cmml">iou</mi></msub><annotation-xml encoding="MathML-Content" id="A1.p3.5.m5.1b"><apply id="A1.p3.5.m5.1.1.cmml" xref="A1.p3.5.m5.1.1"><csymbol cd="ambiguous" id="A1.p3.5.m5.1.1.1.cmml" xref="A1.p3.5.m5.1.1">subscript</csymbol><ci id="A1.p3.5.m5.1.1.2.cmml" xref="A1.p3.5.m5.1.1.2">ℓ</ci><ci id="A1.p3.5.m5.1.1.3.cmml" xref="A1.p3.5.m5.1.1.3">iou</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p3.5.m5.1c">\ell_{\rm iou}</annotation></semantics></math> for box regression as  <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib27" title="" class="ltx_ref">27</a>, <a href="#bib.bib33" title="" class="ltx_ref">33</a>]</cite>:</p>
<table id="A1.E15" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="A1.E15.m1.45" class="ltx_Math" alttext="\begin{gathered}\ell_{\rm cls}(i)=-\text{log}~{}\hat{\rm{P}}_{\sigma(i),c_{i}},~{}~{}~{}\ell_{\rm l1}(i)=||{\rm B}_{i}-\hat{\rm B}_{\sigma(i)}||_{1},\\
\ell_{\rm iou}(i)=1\!-\!\big{(}\frac{|{\rm B}_{i}\cap\hat{{\rm B}}_{\sigma(i)}|}{|{\rm B}_{i}\cup\hat{{\rm B}}_{\sigma(i)}|}-\frac{|{\sf{\rm B}}({\rm B}_{i},\hat{{\rm B}}_{\sigma(i)})\char 92\relax{\rm B}_{i}\cup\hat{{\rm B}}_{\sigma(i)}|}{|{\sf{\rm B}}({\rm B}_{i},\hat{{\rm B}}_{\sigma(i)})|}\big{)},\end{gathered}" display="block"><semantics id="A1.E15.m1.45a"><mtable displaystyle="true" rowspacing="0pt" id="A1.E15.m1.45.45.3"><mtr id="A1.E15.m1.45.45.3a"><mtd id="A1.E15.m1.45.45.3b"><mrow id="A1.E15.m1.44.44.2.43.29.29.29"><mrow id="A1.E15.m1.44.44.2.43.29.29.29.1"><mrow id="A1.E15.m1.44.44.2.43.29.29.29.1.1.1"><mrow id="A1.E15.m1.44.44.2.43.29.29.29.1.1.1.1"><msub id="A1.E15.m1.44.44.2.43.29.29.29.1.1.1.1.2"><mi mathvariant="normal" id="A1.E15.m1.1.1.1.1.1.1" xref="A1.E15.m1.1.1.1.1.1.1.cmml">ℓ</mi><mi id="A1.E15.m1.2.2.2.2.2.2.1" xref="A1.E15.m1.2.2.2.2.2.2.1.cmml">cls</mi></msub><mo lspace="0em" rspace="0em" id="A1.E15.m1.44.44.2.43.29.29.29.1.1.1.1.1">​</mo><mrow id="A1.E15.m1.44.44.2.43.29.29.29.1.1.1.1.3"><mo stretchy="false" id="A1.E15.m1.3.3.3.3.3.3">(</mo><mi id="A1.E15.m1.4.4.4.4.4.4" xref="A1.E15.m1.4.4.4.4.4.4.cmml">i</mi><mo stretchy="false" id="A1.E15.m1.5.5.5.5.5.5">)</mo></mrow></mrow><mo id="A1.E15.m1.6.6.6.6.6.6" xref="A1.E15.m1.6.6.6.6.6.6.cmml">=</mo><mrow id="A1.E15.m1.44.44.2.43.29.29.29.1.1.1.2"><mo id="A1.E15.m1.44.44.2.43.29.29.29.1.1.1.2a">−</mo><mrow id="A1.E15.m1.44.44.2.43.29.29.29.1.1.1.2.1"><mtext id="A1.E15.m1.8.8.8.8.8.8" xref="A1.E15.m1.8.8.8.8.8.8a.cmml">log</mtext><mo lspace="0.330em" rspace="0em" id="A1.E15.m1.44.44.2.43.29.29.29.1.1.1.2.1.1">​</mo><msub id="A1.E15.m1.44.44.2.43.29.29.29.1.1.1.2.1.2"><mover accent="true" id="A1.E15.m1.9.9.9.9.9.9" xref="A1.E15.m1.9.9.9.9.9.9.cmml"><mi mathvariant="normal" id="A1.E15.m1.9.9.9.9.9.9.2" xref="A1.E15.m1.9.9.9.9.9.9.2.cmml">P</mi><mo id="A1.E15.m1.9.9.9.9.9.9.1" xref="A1.E15.m1.9.9.9.9.9.9.1.cmml">^</mo></mover><mrow id="A1.E15.m1.10.10.10.10.10.10.1.3" xref="A1.E15.m1.10.10.10.10.10.10.1.4.cmml"><mrow id="A1.E15.m1.10.10.10.10.10.10.1.2.1" xref="A1.E15.m1.10.10.10.10.10.10.1.2.1.cmml"><mi id="A1.E15.m1.10.10.10.10.10.10.1.2.1.2" xref="A1.E15.m1.10.10.10.10.10.10.1.2.1.2.cmml">σ</mi><mo lspace="0em" rspace="0em" id="A1.E15.m1.10.10.10.10.10.10.1.2.1.1" xref="A1.E15.m1.10.10.10.10.10.10.1.2.1.1.cmml">​</mo><mrow id="A1.E15.m1.10.10.10.10.10.10.1.2.1.3.2" xref="A1.E15.m1.10.10.10.10.10.10.1.2.1.cmml"><mo stretchy="false" id="A1.E15.m1.10.10.10.10.10.10.1.2.1.3.2.1" xref="A1.E15.m1.10.10.10.10.10.10.1.2.1.cmml">(</mo><mi id="A1.E15.m1.10.10.10.10.10.10.1.1" xref="A1.E15.m1.10.10.10.10.10.10.1.1.cmml">i</mi><mo stretchy="false" id="A1.E15.m1.10.10.10.10.10.10.1.2.1.3.2.2" xref="A1.E15.m1.10.10.10.10.10.10.1.2.1.cmml">)</mo></mrow></mrow><mo id="A1.E15.m1.10.10.10.10.10.10.1.3.3" xref="A1.E15.m1.10.10.10.10.10.10.1.4.cmml">,</mo><msub id="A1.E15.m1.10.10.10.10.10.10.1.3.2" xref="A1.E15.m1.10.10.10.10.10.10.1.3.2.cmml"><mi id="A1.E15.m1.10.10.10.10.10.10.1.3.2.2" xref="A1.E15.m1.10.10.10.10.10.10.1.3.2.2.cmml">c</mi><mi id="A1.E15.m1.10.10.10.10.10.10.1.3.2.3" xref="A1.E15.m1.10.10.10.10.10.10.1.3.2.3.cmml">i</mi></msub></mrow></msub></mrow></mrow></mrow><mo rspace="1.157em" id="A1.E15.m1.11.11.11.11.11.11">,</mo><mrow id="A1.E15.m1.44.44.2.43.29.29.29.1.2.2"><mrow id="A1.E15.m1.44.44.2.43.29.29.29.1.2.2.2"><msub id="A1.E15.m1.44.44.2.43.29.29.29.1.2.2.2.2"><mi mathvariant="normal" id="A1.E15.m1.12.12.12.12.12.12" xref="A1.E15.m1.12.12.12.12.12.12.cmml">ℓ</mi><mi id="A1.E15.m1.13.13.13.13.13.13.1" xref="A1.E15.m1.13.13.13.13.13.13.1.cmml">l1</mi></msub><mo lspace="0em" rspace="0em" id="A1.E15.m1.44.44.2.43.29.29.29.1.2.2.2.1">​</mo><mrow id="A1.E15.m1.44.44.2.43.29.29.29.1.2.2.2.3"><mo stretchy="false" id="A1.E15.m1.14.14.14.14.14.14">(</mo><mi id="A1.E15.m1.15.15.15.15.15.15" xref="A1.E15.m1.15.15.15.15.15.15.cmml">i</mi><mo stretchy="false" id="A1.E15.m1.16.16.16.16.16.16">)</mo></mrow></mrow><mo id="A1.E15.m1.17.17.17.17.17.17" xref="A1.E15.m1.17.17.17.17.17.17.cmml">=</mo><msub id="A1.E15.m1.44.44.2.43.29.29.29.1.2.2.1"><mrow id="A1.E15.m1.44.44.2.43.29.29.29.1.2.2.1.1.1"><mo stretchy="false" id="A1.E15.m1.18.18.18.18.18.18b">‖</mo><mrow id="A1.E15.m1.44.44.2.43.29.29.29.1.2.2.1.1.1.1"><msub id="A1.E15.m1.44.44.2.43.29.29.29.1.2.2.1.1.1.1.1"><mi mathvariant="normal" id="A1.E15.m1.20.20.20.20.20.20" xref="A1.E15.m1.20.20.20.20.20.20.cmml">B</mi><mi id="A1.E15.m1.21.21.21.21.21.21.1" xref="A1.E15.m1.21.21.21.21.21.21.1.cmml">i</mi></msub><mo id="A1.E15.m1.22.22.22.22.22.22" xref="A1.E15.m1.22.22.22.22.22.22.cmml">−</mo><msub id="A1.E15.m1.44.44.2.43.29.29.29.1.2.2.1.1.1.1.2"><mover accent="true" id="A1.E15.m1.23.23.23.23.23.23" xref="A1.E15.m1.23.23.23.23.23.23.cmml"><mi mathvariant="normal" id="A1.E15.m1.23.23.23.23.23.23.2" xref="A1.E15.m1.23.23.23.23.23.23.2.cmml">B</mi><mo id="A1.E15.m1.23.23.23.23.23.23.1" xref="A1.E15.m1.23.23.23.23.23.23.1.cmml">^</mo></mover><mrow id="A1.E15.m1.24.24.24.24.24.24.1" xref="A1.E15.m1.24.24.24.24.24.24.1.cmml"><mi id="A1.E15.m1.24.24.24.24.24.24.1.3" xref="A1.E15.m1.24.24.24.24.24.24.1.3.cmml">σ</mi><mo lspace="0em" rspace="0em" id="A1.E15.m1.24.24.24.24.24.24.1.2" xref="A1.E15.m1.24.24.24.24.24.24.1.2.cmml">​</mo><mrow id="A1.E15.m1.24.24.24.24.24.24.1.4.2" xref="A1.E15.m1.24.24.24.24.24.24.1.cmml"><mo stretchy="false" id="A1.E15.m1.24.24.24.24.24.24.1.4.2.1" xref="A1.E15.m1.24.24.24.24.24.24.1.cmml">(</mo><mi id="A1.E15.m1.24.24.24.24.24.24.1.1" xref="A1.E15.m1.24.24.24.24.24.24.1.1.cmml">i</mi><mo stretchy="false" id="A1.E15.m1.24.24.24.24.24.24.1.4.2.2" xref="A1.E15.m1.24.24.24.24.24.24.1.cmml">)</mo></mrow></mrow></msub></mrow><mo stretchy="false" id="A1.E15.m1.25.25.25.25.25.25b">‖</mo></mrow><mn id="A1.E15.m1.27.27.27.27.27.27.1" xref="A1.E15.m1.27.27.27.27.27.27.1.cmml">1</mn></msub></mrow></mrow><mo id="A1.E15.m1.28.28.28.28.28.28">,</mo></mrow></mtd></mtr><mtr id="A1.E15.m1.45.45.3c"><mtd id="A1.E15.m1.45.45.3d"><mrow id="A1.E15.m1.45.45.3.44.15.15.15"><mrow id="A1.E15.m1.45.45.3.44.15.15.15.1"><mrow id="A1.E15.m1.45.45.3.44.15.15.15.1.2"><msub id="A1.E15.m1.45.45.3.44.15.15.15.1.2.2"><mi mathvariant="normal" id="A1.E15.m1.29.29.29.1.1.1" xref="A1.E15.m1.29.29.29.1.1.1.cmml">ℓ</mi><mi id="A1.E15.m1.30.30.30.2.2.2.1" xref="A1.E15.m1.30.30.30.2.2.2.1.cmml">iou</mi></msub><mo lspace="0em" rspace="0em" id="A1.E15.m1.45.45.3.44.15.15.15.1.2.1">​</mo><mrow id="A1.E15.m1.45.45.3.44.15.15.15.1.2.3"><mo stretchy="false" id="A1.E15.m1.31.31.31.3.3.3">(</mo><mi id="A1.E15.m1.32.32.32.4.4.4" xref="A1.E15.m1.32.32.32.4.4.4.cmml">i</mi><mo stretchy="false" id="A1.E15.m1.33.33.33.5.5.5">)</mo></mrow></mrow><mo id="A1.E15.m1.34.34.34.6.6.6" xref="A1.E15.m1.34.34.34.6.6.6.cmml">=</mo><mrow id="A1.E15.m1.45.45.3.44.15.15.15.1.1"><mn id="A1.E15.m1.35.35.35.7.7.7" xref="A1.E15.m1.35.35.35.7.7.7.cmml">1</mn><mo lspace="0.052em" rspace="0.052em" id="A1.E15.m1.36.36.36.8.8.8" xref="A1.E15.m1.36.36.36.8.8.8.cmml">−</mo><mrow id="A1.E15.m1.45.45.3.44.15.15.15.1.1.1.1"><mo maxsize="120%" minsize="120%" id="A1.E15.m1.37.37.37.9.9.9">(</mo><mrow id="A1.E15.m1.45.45.3.44.15.15.15.1.1.1.1.1"><mfrac id="A1.E15.m1.38.38.38.10.10.10" xref="A1.E15.m1.38.38.38.10.10.10.cmml"><mrow id="A1.E15.m1.38.38.38.10.10.10.2.2" xref="A1.E15.m1.38.38.38.10.10.10.2.3.cmml"><mo stretchy="false" id="A1.E15.m1.38.38.38.10.10.10.2.2.2" xref="A1.E15.m1.38.38.38.10.10.10.2.3.1.cmml">|</mo><mrow id="A1.E15.m1.38.38.38.10.10.10.2.2.1" xref="A1.E15.m1.38.38.38.10.10.10.2.2.1.cmml"><msub id="A1.E15.m1.38.38.38.10.10.10.2.2.1.2" xref="A1.E15.m1.38.38.38.10.10.10.2.2.1.2.cmml"><mi mathvariant="normal" id="A1.E15.m1.38.38.38.10.10.10.2.2.1.2.2" xref="A1.E15.m1.38.38.38.10.10.10.2.2.1.2.2.cmml">B</mi><mi id="A1.E15.m1.38.38.38.10.10.10.2.2.1.2.3" xref="A1.E15.m1.38.38.38.10.10.10.2.2.1.2.3.cmml">i</mi></msub><mo id="A1.E15.m1.38.38.38.10.10.10.2.2.1.1" xref="A1.E15.m1.38.38.38.10.10.10.2.2.1.1.cmml">∩</mo><msub id="A1.E15.m1.38.38.38.10.10.10.2.2.1.3" xref="A1.E15.m1.38.38.38.10.10.10.2.2.1.3.cmml"><mover accent="true" id="A1.E15.m1.38.38.38.10.10.10.2.2.1.3.2" xref="A1.E15.m1.38.38.38.10.10.10.2.2.1.3.2.cmml"><mi mathvariant="normal" id="A1.E15.m1.38.38.38.10.10.10.2.2.1.3.2.2" xref="A1.E15.m1.38.38.38.10.10.10.2.2.1.3.2.2.cmml">B</mi><mo id="A1.E15.m1.38.38.38.10.10.10.2.2.1.3.2.1" xref="A1.E15.m1.38.38.38.10.10.10.2.2.1.3.2.1.cmml">^</mo></mover><mrow id="A1.E15.m1.38.38.38.10.10.10.1.1.1" xref="A1.E15.m1.38.38.38.10.10.10.1.1.1.cmml"><mi id="A1.E15.m1.38.38.38.10.10.10.1.1.1.3" xref="A1.E15.m1.38.38.38.10.10.10.1.1.1.3.cmml">σ</mi><mo lspace="0em" rspace="0em" id="A1.E15.m1.38.38.38.10.10.10.1.1.1.2" xref="A1.E15.m1.38.38.38.10.10.10.1.1.1.2.cmml">​</mo><mrow id="A1.E15.m1.38.38.38.10.10.10.1.1.1.4.2" xref="A1.E15.m1.38.38.38.10.10.10.1.1.1.cmml"><mo stretchy="false" id="A1.E15.m1.38.38.38.10.10.10.1.1.1.4.2.1" xref="A1.E15.m1.38.38.38.10.10.10.1.1.1.cmml">(</mo><mi id="A1.E15.m1.38.38.38.10.10.10.1.1.1.1" xref="A1.E15.m1.38.38.38.10.10.10.1.1.1.1.cmml">i</mi><mo stretchy="false" id="A1.E15.m1.38.38.38.10.10.10.1.1.1.4.2.2" xref="A1.E15.m1.38.38.38.10.10.10.1.1.1.cmml">)</mo></mrow></mrow></msub></mrow><mo stretchy="false" id="A1.E15.m1.38.38.38.10.10.10.2.2.3" xref="A1.E15.m1.38.38.38.10.10.10.2.3.1.cmml">|</mo></mrow><mrow id="A1.E15.m1.38.38.38.10.10.10.4.2" xref="A1.E15.m1.38.38.38.10.10.10.4.3.cmml"><mo stretchy="false" id="A1.E15.m1.38.38.38.10.10.10.4.2.2" xref="A1.E15.m1.38.38.38.10.10.10.4.3.1.cmml">|</mo><mrow id="A1.E15.m1.38.38.38.10.10.10.4.2.1" xref="A1.E15.m1.38.38.38.10.10.10.4.2.1.cmml"><msub id="A1.E15.m1.38.38.38.10.10.10.4.2.1.2" xref="A1.E15.m1.38.38.38.10.10.10.4.2.1.2.cmml"><mi mathvariant="normal" id="A1.E15.m1.38.38.38.10.10.10.4.2.1.2.2" xref="A1.E15.m1.38.38.38.10.10.10.4.2.1.2.2.cmml">B</mi><mi id="A1.E15.m1.38.38.38.10.10.10.4.2.1.2.3" xref="A1.E15.m1.38.38.38.10.10.10.4.2.1.2.3.cmml">i</mi></msub><mo id="A1.E15.m1.38.38.38.10.10.10.4.2.1.1" xref="A1.E15.m1.38.38.38.10.10.10.4.2.1.1.cmml">∪</mo><msub id="A1.E15.m1.38.38.38.10.10.10.4.2.1.3" xref="A1.E15.m1.38.38.38.10.10.10.4.2.1.3.cmml"><mover accent="true" id="A1.E15.m1.38.38.38.10.10.10.4.2.1.3.2" xref="A1.E15.m1.38.38.38.10.10.10.4.2.1.3.2.cmml"><mi mathvariant="normal" id="A1.E15.m1.38.38.38.10.10.10.4.2.1.3.2.2" xref="A1.E15.m1.38.38.38.10.10.10.4.2.1.3.2.2.cmml">B</mi><mo id="A1.E15.m1.38.38.38.10.10.10.4.2.1.3.2.1" xref="A1.E15.m1.38.38.38.10.10.10.4.2.1.3.2.1.cmml">^</mo></mover><mrow id="A1.E15.m1.38.38.38.10.10.10.3.1.1" xref="A1.E15.m1.38.38.38.10.10.10.3.1.1.cmml"><mi id="A1.E15.m1.38.38.38.10.10.10.3.1.1.3" xref="A1.E15.m1.38.38.38.10.10.10.3.1.1.3.cmml">σ</mi><mo lspace="0em" rspace="0em" id="A1.E15.m1.38.38.38.10.10.10.3.1.1.2" xref="A1.E15.m1.38.38.38.10.10.10.3.1.1.2.cmml">​</mo><mrow id="A1.E15.m1.38.38.38.10.10.10.3.1.1.4.2" xref="A1.E15.m1.38.38.38.10.10.10.3.1.1.cmml"><mo stretchy="false" id="A1.E15.m1.38.38.38.10.10.10.3.1.1.4.2.1" xref="A1.E15.m1.38.38.38.10.10.10.3.1.1.cmml">(</mo><mi id="A1.E15.m1.38.38.38.10.10.10.3.1.1.1" xref="A1.E15.m1.38.38.38.10.10.10.3.1.1.1.cmml">i</mi><mo stretchy="false" id="A1.E15.m1.38.38.38.10.10.10.3.1.1.4.2.2" xref="A1.E15.m1.38.38.38.10.10.10.3.1.1.cmml">)</mo></mrow></mrow></msub></mrow><mo stretchy="false" id="A1.E15.m1.38.38.38.10.10.10.4.2.3" xref="A1.E15.m1.38.38.38.10.10.10.4.3.1.cmml">|</mo></mrow></mfrac><mo id="A1.E15.m1.39.39.39.11.11.11" xref="A1.E15.m1.39.39.39.11.11.11.cmml">−</mo><mfrac id="A1.E15.m1.40.40.40.12.12.12" xref="A1.E15.m1.40.40.40.12.12.12.cmml"><mrow id="A1.E15.m1.40.40.40.12.12.12.3.3" xref="A1.E15.m1.40.40.40.12.12.12.3.4.cmml"><mo stretchy="false" id="A1.E15.m1.40.40.40.12.12.12.3.3.2" xref="A1.E15.m1.40.40.40.12.12.12.3.4.1.cmml">|</mo><mrow id="A1.E15.m1.40.40.40.12.12.12.3.3.1" xref="A1.E15.m1.40.40.40.12.12.12.3.3.1.cmml"><mrow id="A1.E15.m1.40.40.40.12.12.12.3.3.1.2" xref="A1.E15.m1.40.40.40.12.12.12.3.3.1.2.cmml"><mi mathvariant="normal" id="A1.E15.m1.40.40.40.12.12.12.3.3.1.2.4" xref="A1.E15.m1.40.40.40.12.12.12.3.3.1.2.4.cmml">B</mi><mo lspace="0em" rspace="0em" id="A1.E15.m1.40.40.40.12.12.12.3.3.1.2.3" xref="A1.E15.m1.40.40.40.12.12.12.3.3.1.2.3.cmml">​</mo><mrow id="A1.E15.m1.40.40.40.12.12.12.3.3.1.2.2.2" xref="A1.E15.m1.40.40.40.12.12.12.3.3.1.2.2.3.cmml"><mo stretchy="false" id="A1.E15.m1.40.40.40.12.12.12.3.3.1.2.2.2.3" xref="A1.E15.m1.40.40.40.12.12.12.3.3.1.2.2.3.cmml">(</mo><msub id="A1.E15.m1.40.40.40.12.12.12.3.3.1.1.1.1.1" xref="A1.E15.m1.40.40.40.12.12.12.3.3.1.1.1.1.1.cmml"><mi mathvariant="normal" id="A1.E15.m1.40.40.40.12.12.12.3.3.1.1.1.1.1.2" xref="A1.E15.m1.40.40.40.12.12.12.3.3.1.1.1.1.1.2.cmml">B</mi><mi id="A1.E15.m1.40.40.40.12.12.12.3.3.1.1.1.1.1.3" xref="A1.E15.m1.40.40.40.12.12.12.3.3.1.1.1.1.1.3.cmml">i</mi></msub><mo id="A1.E15.m1.40.40.40.12.12.12.3.3.1.2.2.2.4" xref="A1.E15.m1.40.40.40.12.12.12.3.3.1.2.2.3.cmml">,</mo><msub id="A1.E15.m1.40.40.40.12.12.12.3.3.1.2.2.2.2" xref="A1.E15.m1.40.40.40.12.12.12.3.3.1.2.2.2.2.cmml"><mover accent="true" id="A1.E15.m1.40.40.40.12.12.12.3.3.1.2.2.2.2.2" xref="A1.E15.m1.40.40.40.12.12.12.3.3.1.2.2.2.2.2.cmml"><mi mathvariant="normal" id="A1.E15.m1.40.40.40.12.12.12.3.3.1.2.2.2.2.2.2" xref="A1.E15.m1.40.40.40.12.12.12.3.3.1.2.2.2.2.2.2.cmml">B</mi><mo id="A1.E15.m1.40.40.40.12.12.12.3.3.1.2.2.2.2.2.1" xref="A1.E15.m1.40.40.40.12.12.12.3.3.1.2.2.2.2.2.1.cmml">^</mo></mover><mrow id="A1.E15.m1.40.40.40.12.12.12.1.1.1" xref="A1.E15.m1.40.40.40.12.12.12.1.1.1.cmml"><mi id="A1.E15.m1.40.40.40.12.12.12.1.1.1.3" xref="A1.E15.m1.40.40.40.12.12.12.1.1.1.3.cmml">σ</mi><mo lspace="0em" rspace="0em" id="A1.E15.m1.40.40.40.12.12.12.1.1.1.2" xref="A1.E15.m1.40.40.40.12.12.12.1.1.1.2.cmml">​</mo><mrow id="A1.E15.m1.40.40.40.12.12.12.1.1.1.4.2" xref="A1.E15.m1.40.40.40.12.12.12.1.1.1.cmml"><mo stretchy="false" id="A1.E15.m1.40.40.40.12.12.12.1.1.1.4.2.1" xref="A1.E15.m1.40.40.40.12.12.12.1.1.1.cmml">(</mo><mi id="A1.E15.m1.40.40.40.12.12.12.1.1.1.1" xref="A1.E15.m1.40.40.40.12.12.12.1.1.1.1.cmml">i</mi><mo stretchy="false" id="A1.E15.m1.40.40.40.12.12.12.1.1.1.4.2.2" xref="A1.E15.m1.40.40.40.12.12.12.1.1.1.cmml">)</mo></mrow></mrow></msub><mo stretchy="false" id="A1.E15.m1.40.40.40.12.12.12.3.3.1.2.2.2.5" xref="A1.E15.m1.40.40.40.12.12.12.3.3.1.2.2.3.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="A1.E15.m1.40.40.40.12.12.12.3.3.1.2.3a" xref="A1.E15.m1.40.40.40.12.12.12.3.3.1.2.3.cmml">​</mo><mi mathvariant="normal" id="A1.E15.m1.40.40.40.12.12.12.3.3.1.2.5" xref="A1.E15.m1.40.40.40.12.12.12.3.3.1.2.5.cmml">“</mi><mo lspace="0em" rspace="0em" id="A1.E15.m1.40.40.40.12.12.12.3.3.1.2.3b" xref="A1.E15.m1.40.40.40.12.12.12.3.3.1.2.3.cmml">​</mo><msub id="A1.E15.m1.40.40.40.12.12.12.3.3.1.2.6" xref="A1.E15.m1.40.40.40.12.12.12.3.3.1.2.6.cmml"><mi mathvariant="normal" id="A1.E15.m1.40.40.40.12.12.12.3.3.1.2.6.2" xref="A1.E15.m1.40.40.40.12.12.12.3.3.1.2.6.2.cmml">B</mi><mi id="A1.E15.m1.40.40.40.12.12.12.3.3.1.2.6.3" xref="A1.E15.m1.40.40.40.12.12.12.3.3.1.2.6.3.cmml">i</mi></msub></mrow><mo id="A1.E15.m1.40.40.40.12.12.12.3.3.1.3" xref="A1.E15.m1.40.40.40.12.12.12.3.3.1.3.cmml">∪</mo><msub id="A1.E15.m1.40.40.40.12.12.12.3.3.1.4" xref="A1.E15.m1.40.40.40.12.12.12.3.3.1.4.cmml"><mover accent="true" id="A1.E15.m1.40.40.40.12.12.12.3.3.1.4.2" xref="A1.E15.m1.40.40.40.12.12.12.3.3.1.4.2.cmml"><mi mathvariant="normal" id="A1.E15.m1.40.40.40.12.12.12.3.3.1.4.2.2" xref="A1.E15.m1.40.40.40.12.12.12.3.3.1.4.2.2.cmml">B</mi><mo id="A1.E15.m1.40.40.40.12.12.12.3.3.1.4.2.1" xref="A1.E15.m1.40.40.40.12.12.12.3.3.1.4.2.1.cmml">^</mo></mover><mrow id="A1.E15.m1.40.40.40.12.12.12.2.2.1" xref="A1.E15.m1.40.40.40.12.12.12.2.2.1.cmml"><mi id="A1.E15.m1.40.40.40.12.12.12.2.2.1.3" xref="A1.E15.m1.40.40.40.12.12.12.2.2.1.3.cmml">σ</mi><mo lspace="0em" rspace="0em" id="A1.E15.m1.40.40.40.12.12.12.2.2.1.2" xref="A1.E15.m1.40.40.40.12.12.12.2.2.1.2.cmml">​</mo><mrow id="A1.E15.m1.40.40.40.12.12.12.2.2.1.4.2" xref="A1.E15.m1.40.40.40.12.12.12.2.2.1.cmml"><mo stretchy="false" id="A1.E15.m1.40.40.40.12.12.12.2.2.1.4.2.1" xref="A1.E15.m1.40.40.40.12.12.12.2.2.1.cmml">(</mo><mi id="A1.E15.m1.40.40.40.12.12.12.2.2.1.1" xref="A1.E15.m1.40.40.40.12.12.12.2.2.1.1.cmml">i</mi><mo stretchy="false" id="A1.E15.m1.40.40.40.12.12.12.2.2.1.4.2.2" xref="A1.E15.m1.40.40.40.12.12.12.2.2.1.cmml">)</mo></mrow></mrow></msub></mrow><mo stretchy="false" id="A1.E15.m1.40.40.40.12.12.12.3.3.3" xref="A1.E15.m1.40.40.40.12.12.12.3.4.1.cmml">|</mo></mrow><mrow id="A1.E15.m1.40.40.40.12.12.12.5.2" xref="A1.E15.m1.40.40.40.12.12.12.5.3.cmml"><mo stretchy="false" id="A1.E15.m1.40.40.40.12.12.12.5.2.2" xref="A1.E15.m1.40.40.40.12.12.12.5.3.1.cmml">|</mo><mrow id="A1.E15.m1.40.40.40.12.12.12.5.2.1" xref="A1.E15.m1.40.40.40.12.12.12.5.2.1.cmml"><mi mathvariant="normal" id="A1.E15.m1.40.40.40.12.12.12.5.2.1.4" xref="A1.E15.m1.40.40.40.12.12.12.5.2.1.4.cmml">B</mi><mo lspace="0em" rspace="0em" id="A1.E15.m1.40.40.40.12.12.12.5.2.1.3" xref="A1.E15.m1.40.40.40.12.12.12.5.2.1.3.cmml">​</mo><mrow id="A1.E15.m1.40.40.40.12.12.12.5.2.1.2.2" xref="A1.E15.m1.40.40.40.12.12.12.5.2.1.2.3.cmml"><mo stretchy="false" id="A1.E15.m1.40.40.40.12.12.12.5.2.1.2.2.3" xref="A1.E15.m1.40.40.40.12.12.12.5.2.1.2.3.cmml">(</mo><msub id="A1.E15.m1.40.40.40.12.12.12.5.2.1.1.1.1" xref="A1.E15.m1.40.40.40.12.12.12.5.2.1.1.1.1.cmml"><mi mathvariant="normal" id="A1.E15.m1.40.40.40.12.12.12.5.2.1.1.1.1.2" xref="A1.E15.m1.40.40.40.12.12.12.5.2.1.1.1.1.2.cmml">B</mi><mi id="A1.E15.m1.40.40.40.12.12.12.5.2.1.1.1.1.3" xref="A1.E15.m1.40.40.40.12.12.12.5.2.1.1.1.1.3.cmml">i</mi></msub><mo id="A1.E15.m1.40.40.40.12.12.12.5.2.1.2.2.4" xref="A1.E15.m1.40.40.40.12.12.12.5.2.1.2.3.cmml">,</mo><msub id="A1.E15.m1.40.40.40.12.12.12.5.2.1.2.2.2" xref="A1.E15.m1.40.40.40.12.12.12.5.2.1.2.2.2.cmml"><mover accent="true" id="A1.E15.m1.40.40.40.12.12.12.5.2.1.2.2.2.2" xref="A1.E15.m1.40.40.40.12.12.12.5.2.1.2.2.2.2.cmml"><mi mathvariant="normal" id="A1.E15.m1.40.40.40.12.12.12.5.2.1.2.2.2.2.2" xref="A1.E15.m1.40.40.40.12.12.12.5.2.1.2.2.2.2.2.cmml">B</mi><mo id="A1.E15.m1.40.40.40.12.12.12.5.2.1.2.2.2.2.1" xref="A1.E15.m1.40.40.40.12.12.12.5.2.1.2.2.2.2.1.cmml">^</mo></mover><mrow id="A1.E15.m1.40.40.40.12.12.12.4.1.1" xref="A1.E15.m1.40.40.40.12.12.12.4.1.1.cmml"><mi id="A1.E15.m1.40.40.40.12.12.12.4.1.1.3" xref="A1.E15.m1.40.40.40.12.12.12.4.1.1.3.cmml">σ</mi><mo lspace="0em" rspace="0em" id="A1.E15.m1.40.40.40.12.12.12.4.1.1.2" xref="A1.E15.m1.40.40.40.12.12.12.4.1.1.2.cmml">​</mo><mrow id="A1.E15.m1.40.40.40.12.12.12.4.1.1.4.2" xref="A1.E15.m1.40.40.40.12.12.12.4.1.1.cmml"><mo stretchy="false" id="A1.E15.m1.40.40.40.12.12.12.4.1.1.4.2.1" xref="A1.E15.m1.40.40.40.12.12.12.4.1.1.cmml">(</mo><mi id="A1.E15.m1.40.40.40.12.12.12.4.1.1.1" xref="A1.E15.m1.40.40.40.12.12.12.4.1.1.1.cmml">i</mi><mo stretchy="false" id="A1.E15.m1.40.40.40.12.12.12.4.1.1.4.2.2" xref="A1.E15.m1.40.40.40.12.12.12.4.1.1.cmml">)</mo></mrow></mrow></msub><mo stretchy="false" id="A1.E15.m1.40.40.40.12.12.12.5.2.1.2.2.5" xref="A1.E15.m1.40.40.40.12.12.12.5.2.1.2.3.cmml">)</mo></mrow></mrow><mo stretchy="false" id="A1.E15.m1.40.40.40.12.12.12.5.2.3" xref="A1.E15.m1.40.40.40.12.12.12.5.3.1.cmml">|</mo></mrow></mfrac></mrow><mo maxsize="120%" minsize="120%" id="A1.E15.m1.41.41.41.13.13.13">)</mo></mrow></mrow></mrow><mo id="A1.E15.m1.42.42.42.14.14.14">,</mo></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="A1.E15.m1.45b"><apply id="A1.E15.m1.43.43.1.1.1.3.cmml"><csymbol cd="ambiguous" id="A1.E15.m1.43.43.1.1.1.3a.cmml">formulae-sequence</csymbol><apply id="A1.E15.m1.43.43.1.1.1.1.1.cmml"><eq id="A1.E15.m1.6.6.6.6.6.6.cmml" xref="A1.E15.m1.6.6.6.6.6.6"></eq><apply id="A1.E15.m1.43.43.1.1.1.1.1.2.cmml"><times id="A1.E15.m1.43.43.1.1.1.1.1.2.1.cmml"></times><apply id="A1.E15.m1.43.43.1.1.1.1.1.2.2.cmml"><csymbol cd="ambiguous" id="A1.E15.m1.43.43.1.1.1.1.1.2.2.1.cmml">subscript</csymbol><ci id="A1.E15.m1.1.1.1.1.1.1.cmml" xref="A1.E15.m1.1.1.1.1.1.1">ℓ</ci><ci id="A1.E15.m1.2.2.2.2.2.2.1.cmml" xref="A1.E15.m1.2.2.2.2.2.2.1">cls</ci></apply><ci id="A1.E15.m1.4.4.4.4.4.4.cmml" xref="A1.E15.m1.4.4.4.4.4.4">𝑖</ci></apply><apply id="A1.E15.m1.43.43.1.1.1.1.1.3.cmml"><minus id="A1.E15.m1.7.7.7.7.7.7.cmml"></minus><apply id="A1.E15.m1.43.43.1.1.1.1.1.3.2.cmml"><times id="A1.E15.m1.43.43.1.1.1.1.1.3.2.1.cmml"></times><ci id="A1.E15.m1.8.8.8.8.8.8a.cmml" xref="A1.E15.m1.8.8.8.8.8.8"><mtext id="A1.E15.m1.8.8.8.8.8.8.cmml" xref="A1.E15.m1.8.8.8.8.8.8">log</mtext></ci><apply id="A1.E15.m1.43.43.1.1.1.1.1.3.2.3.cmml"><csymbol cd="ambiguous" id="A1.E15.m1.43.43.1.1.1.1.1.3.2.3.1.cmml">subscript</csymbol><apply id="A1.E15.m1.9.9.9.9.9.9.cmml" xref="A1.E15.m1.9.9.9.9.9.9"><ci id="A1.E15.m1.9.9.9.9.9.9.1.cmml" xref="A1.E15.m1.9.9.9.9.9.9.1">^</ci><ci id="A1.E15.m1.9.9.9.9.9.9.2.cmml" xref="A1.E15.m1.9.9.9.9.9.9.2">P</ci></apply><list id="A1.E15.m1.10.10.10.10.10.10.1.4.cmml" xref="A1.E15.m1.10.10.10.10.10.10.1.3"><apply id="A1.E15.m1.10.10.10.10.10.10.1.2.1.cmml" xref="A1.E15.m1.10.10.10.10.10.10.1.2.1"><times id="A1.E15.m1.10.10.10.10.10.10.1.2.1.1.cmml" xref="A1.E15.m1.10.10.10.10.10.10.1.2.1.1"></times><ci id="A1.E15.m1.10.10.10.10.10.10.1.2.1.2.cmml" xref="A1.E15.m1.10.10.10.10.10.10.1.2.1.2">𝜎</ci><ci id="A1.E15.m1.10.10.10.10.10.10.1.1.cmml" xref="A1.E15.m1.10.10.10.10.10.10.1.1">𝑖</ci></apply><apply id="A1.E15.m1.10.10.10.10.10.10.1.3.2.cmml" xref="A1.E15.m1.10.10.10.10.10.10.1.3.2"><csymbol cd="ambiguous" id="A1.E15.m1.10.10.10.10.10.10.1.3.2.1.cmml" xref="A1.E15.m1.10.10.10.10.10.10.1.3.2">subscript</csymbol><ci id="A1.E15.m1.10.10.10.10.10.10.1.3.2.2.cmml" xref="A1.E15.m1.10.10.10.10.10.10.1.3.2.2">𝑐</ci><ci id="A1.E15.m1.10.10.10.10.10.10.1.3.2.3.cmml" xref="A1.E15.m1.10.10.10.10.10.10.1.3.2.3">𝑖</ci></apply></list></apply></apply></apply></apply><apply id="A1.E15.m1.43.43.1.1.1.2.2.3.cmml"><csymbol cd="ambiguous" id="A1.E15.m1.43.43.1.1.1.2.2.3a.cmml">formulae-sequence</csymbol><apply id="A1.E15.m1.43.43.1.1.1.2.2.1.1.cmml"><eq id="A1.E15.m1.17.17.17.17.17.17.cmml" xref="A1.E15.m1.17.17.17.17.17.17"></eq><apply id="A1.E15.m1.43.43.1.1.1.2.2.1.1.3.cmml"><times id="A1.E15.m1.43.43.1.1.1.2.2.1.1.3.1.cmml"></times><apply id="A1.E15.m1.43.43.1.1.1.2.2.1.1.3.2.cmml"><csymbol cd="ambiguous" id="A1.E15.m1.43.43.1.1.1.2.2.1.1.3.2.1.cmml">subscript</csymbol><ci id="A1.E15.m1.12.12.12.12.12.12.cmml" xref="A1.E15.m1.12.12.12.12.12.12">ℓ</ci><ci id="A1.E15.m1.13.13.13.13.13.13.1.cmml" xref="A1.E15.m1.13.13.13.13.13.13.1">l1</ci></apply><ci id="A1.E15.m1.15.15.15.15.15.15.cmml" xref="A1.E15.m1.15.15.15.15.15.15">𝑖</ci></apply><apply id="A1.E15.m1.43.43.1.1.1.2.2.1.1.1.cmml"><csymbol cd="ambiguous" id="A1.E15.m1.43.43.1.1.1.2.2.1.1.1.2.cmml">subscript</csymbol><apply id="A1.E15.m1.43.43.1.1.1.2.2.1.1.1.1.2.cmml"><csymbol cd="latexml" id="A1.E15.m1.43.43.1.1.1.2.2.1.1.1.1.2.1.cmml">norm</csymbol><apply id="A1.E15.m1.43.43.1.1.1.2.2.1.1.1.1.1.1.cmml"><minus id="A1.E15.m1.22.22.22.22.22.22.cmml" xref="A1.E15.m1.22.22.22.22.22.22"></minus><apply id="A1.E15.m1.43.43.1.1.1.2.2.1.1.1.1.1.1.2.cmml"><csymbol cd="ambiguous" id="A1.E15.m1.43.43.1.1.1.2.2.1.1.1.1.1.1.2.1.cmml">subscript</csymbol><ci id="A1.E15.m1.20.20.20.20.20.20.cmml" xref="A1.E15.m1.20.20.20.20.20.20">B</ci><ci id="A1.E15.m1.21.21.21.21.21.21.1.cmml" xref="A1.E15.m1.21.21.21.21.21.21.1">𝑖</ci></apply><apply id="A1.E15.m1.43.43.1.1.1.2.2.1.1.1.1.1.1.3.cmml"><csymbol cd="ambiguous" id="A1.E15.m1.43.43.1.1.1.2.2.1.1.1.1.1.1.3.1.cmml">subscript</csymbol><apply id="A1.E15.m1.23.23.23.23.23.23.cmml" xref="A1.E15.m1.23.23.23.23.23.23"><ci id="A1.E15.m1.23.23.23.23.23.23.1.cmml" xref="A1.E15.m1.23.23.23.23.23.23.1">^</ci><ci id="A1.E15.m1.23.23.23.23.23.23.2.cmml" xref="A1.E15.m1.23.23.23.23.23.23.2">B</ci></apply><apply id="A1.E15.m1.24.24.24.24.24.24.1.cmml" xref="A1.E15.m1.24.24.24.24.24.24.1"><times id="A1.E15.m1.24.24.24.24.24.24.1.2.cmml" xref="A1.E15.m1.24.24.24.24.24.24.1.2"></times><ci id="A1.E15.m1.24.24.24.24.24.24.1.3.cmml" xref="A1.E15.m1.24.24.24.24.24.24.1.3">𝜎</ci><ci id="A1.E15.m1.24.24.24.24.24.24.1.1.cmml" xref="A1.E15.m1.24.24.24.24.24.24.1.1">𝑖</ci></apply></apply></apply></apply><cn type="integer" id="A1.E15.m1.27.27.27.27.27.27.1.cmml" xref="A1.E15.m1.27.27.27.27.27.27.1">1</cn></apply></apply><apply id="A1.E15.m1.43.43.1.1.1.2.2.2.2.cmml"><eq id="A1.E15.m1.34.34.34.6.6.6.cmml" xref="A1.E15.m1.34.34.34.6.6.6"></eq><apply id="A1.E15.m1.43.43.1.1.1.2.2.2.2.3.cmml"><times id="A1.E15.m1.43.43.1.1.1.2.2.2.2.3.1.cmml"></times><apply id="A1.E15.m1.43.43.1.1.1.2.2.2.2.3.2.cmml"><csymbol cd="ambiguous" id="A1.E15.m1.43.43.1.1.1.2.2.2.2.3.2.1.cmml">subscript</csymbol><ci id="A1.E15.m1.29.29.29.1.1.1.cmml" xref="A1.E15.m1.29.29.29.1.1.1">ℓ</ci><ci id="A1.E15.m1.30.30.30.2.2.2.1.cmml" xref="A1.E15.m1.30.30.30.2.2.2.1">iou</ci></apply><ci id="A1.E15.m1.32.32.32.4.4.4.cmml" xref="A1.E15.m1.32.32.32.4.4.4">𝑖</ci></apply><apply id="A1.E15.m1.43.43.1.1.1.2.2.2.2.1.cmml"><minus id="A1.E15.m1.36.36.36.8.8.8.cmml" xref="A1.E15.m1.36.36.36.8.8.8"></minus><cn type="integer" id="A1.E15.m1.35.35.35.7.7.7.cmml" xref="A1.E15.m1.35.35.35.7.7.7">1</cn><apply id="A1.E15.m1.43.43.1.1.1.2.2.2.2.1.1.1.1.cmml"><minus id="A1.E15.m1.39.39.39.11.11.11.cmml" xref="A1.E15.m1.39.39.39.11.11.11"></minus><apply id="A1.E15.m1.38.38.38.10.10.10.cmml" xref="A1.E15.m1.38.38.38.10.10.10"><divide id="A1.E15.m1.38.38.38.10.10.10.5.cmml" xref="A1.E15.m1.38.38.38.10.10.10"></divide><apply id="A1.E15.m1.38.38.38.10.10.10.2.3.cmml" xref="A1.E15.m1.38.38.38.10.10.10.2.2"><abs id="A1.E15.m1.38.38.38.10.10.10.2.3.1.cmml" xref="A1.E15.m1.38.38.38.10.10.10.2.2.2"></abs><apply id="A1.E15.m1.38.38.38.10.10.10.2.2.1.cmml" xref="A1.E15.m1.38.38.38.10.10.10.2.2.1"><intersect id="A1.E15.m1.38.38.38.10.10.10.2.2.1.1.cmml" xref="A1.E15.m1.38.38.38.10.10.10.2.2.1.1"></intersect><apply id="A1.E15.m1.38.38.38.10.10.10.2.2.1.2.cmml" xref="A1.E15.m1.38.38.38.10.10.10.2.2.1.2"><csymbol cd="ambiguous" id="A1.E15.m1.38.38.38.10.10.10.2.2.1.2.1.cmml" xref="A1.E15.m1.38.38.38.10.10.10.2.2.1.2">subscript</csymbol><ci id="A1.E15.m1.38.38.38.10.10.10.2.2.1.2.2.cmml" xref="A1.E15.m1.38.38.38.10.10.10.2.2.1.2.2">B</ci><ci id="A1.E15.m1.38.38.38.10.10.10.2.2.1.2.3.cmml" xref="A1.E15.m1.38.38.38.10.10.10.2.2.1.2.3">𝑖</ci></apply><apply id="A1.E15.m1.38.38.38.10.10.10.2.2.1.3.cmml" xref="A1.E15.m1.38.38.38.10.10.10.2.2.1.3"><csymbol cd="ambiguous" id="A1.E15.m1.38.38.38.10.10.10.2.2.1.3.1.cmml" xref="A1.E15.m1.38.38.38.10.10.10.2.2.1.3">subscript</csymbol><apply id="A1.E15.m1.38.38.38.10.10.10.2.2.1.3.2.cmml" xref="A1.E15.m1.38.38.38.10.10.10.2.2.1.3.2"><ci id="A1.E15.m1.38.38.38.10.10.10.2.2.1.3.2.1.cmml" xref="A1.E15.m1.38.38.38.10.10.10.2.2.1.3.2.1">^</ci><ci id="A1.E15.m1.38.38.38.10.10.10.2.2.1.3.2.2.cmml" xref="A1.E15.m1.38.38.38.10.10.10.2.2.1.3.2.2">B</ci></apply><apply id="A1.E15.m1.38.38.38.10.10.10.1.1.1.cmml" xref="A1.E15.m1.38.38.38.10.10.10.1.1.1"><times id="A1.E15.m1.38.38.38.10.10.10.1.1.1.2.cmml" xref="A1.E15.m1.38.38.38.10.10.10.1.1.1.2"></times><ci id="A1.E15.m1.38.38.38.10.10.10.1.1.1.3.cmml" xref="A1.E15.m1.38.38.38.10.10.10.1.1.1.3">𝜎</ci><ci id="A1.E15.m1.38.38.38.10.10.10.1.1.1.1.cmml" xref="A1.E15.m1.38.38.38.10.10.10.1.1.1.1">𝑖</ci></apply></apply></apply></apply><apply id="A1.E15.m1.38.38.38.10.10.10.4.3.cmml" xref="A1.E15.m1.38.38.38.10.10.10.4.2"><abs id="A1.E15.m1.38.38.38.10.10.10.4.3.1.cmml" xref="A1.E15.m1.38.38.38.10.10.10.4.2.2"></abs><apply id="A1.E15.m1.38.38.38.10.10.10.4.2.1.cmml" xref="A1.E15.m1.38.38.38.10.10.10.4.2.1"><union id="A1.E15.m1.38.38.38.10.10.10.4.2.1.1.cmml" xref="A1.E15.m1.38.38.38.10.10.10.4.2.1.1"></union><apply id="A1.E15.m1.38.38.38.10.10.10.4.2.1.2.cmml" xref="A1.E15.m1.38.38.38.10.10.10.4.2.1.2"><csymbol cd="ambiguous" id="A1.E15.m1.38.38.38.10.10.10.4.2.1.2.1.cmml" xref="A1.E15.m1.38.38.38.10.10.10.4.2.1.2">subscript</csymbol><ci id="A1.E15.m1.38.38.38.10.10.10.4.2.1.2.2.cmml" xref="A1.E15.m1.38.38.38.10.10.10.4.2.1.2.2">B</ci><ci id="A1.E15.m1.38.38.38.10.10.10.4.2.1.2.3.cmml" xref="A1.E15.m1.38.38.38.10.10.10.4.2.1.2.3">𝑖</ci></apply><apply id="A1.E15.m1.38.38.38.10.10.10.4.2.1.3.cmml" xref="A1.E15.m1.38.38.38.10.10.10.4.2.1.3"><csymbol cd="ambiguous" id="A1.E15.m1.38.38.38.10.10.10.4.2.1.3.1.cmml" xref="A1.E15.m1.38.38.38.10.10.10.4.2.1.3">subscript</csymbol><apply id="A1.E15.m1.38.38.38.10.10.10.4.2.1.3.2.cmml" xref="A1.E15.m1.38.38.38.10.10.10.4.2.1.3.2"><ci id="A1.E15.m1.38.38.38.10.10.10.4.2.1.3.2.1.cmml" xref="A1.E15.m1.38.38.38.10.10.10.4.2.1.3.2.1">^</ci><ci id="A1.E15.m1.38.38.38.10.10.10.4.2.1.3.2.2.cmml" xref="A1.E15.m1.38.38.38.10.10.10.4.2.1.3.2.2">B</ci></apply><apply id="A1.E15.m1.38.38.38.10.10.10.3.1.1.cmml" xref="A1.E15.m1.38.38.38.10.10.10.3.1.1"><times id="A1.E15.m1.38.38.38.10.10.10.3.1.1.2.cmml" xref="A1.E15.m1.38.38.38.10.10.10.3.1.1.2"></times><ci id="A1.E15.m1.38.38.38.10.10.10.3.1.1.3.cmml" xref="A1.E15.m1.38.38.38.10.10.10.3.1.1.3">𝜎</ci><ci id="A1.E15.m1.38.38.38.10.10.10.3.1.1.1.cmml" xref="A1.E15.m1.38.38.38.10.10.10.3.1.1.1">𝑖</ci></apply></apply></apply></apply></apply><apply id="A1.E15.m1.40.40.40.12.12.12.cmml" xref="A1.E15.m1.40.40.40.12.12.12"><divide id="A1.E15.m1.40.40.40.12.12.12.6.cmml" xref="A1.E15.m1.40.40.40.12.12.12"></divide><apply id="A1.E15.m1.40.40.40.12.12.12.3.4.cmml" xref="A1.E15.m1.40.40.40.12.12.12.3.3"><abs id="A1.E15.m1.40.40.40.12.12.12.3.4.1.cmml" xref="A1.E15.m1.40.40.40.12.12.12.3.3.2"></abs><apply id="A1.E15.m1.40.40.40.12.12.12.3.3.1.cmml" xref="A1.E15.m1.40.40.40.12.12.12.3.3.1"><union id="A1.E15.m1.40.40.40.12.12.12.3.3.1.3.cmml" xref="A1.E15.m1.40.40.40.12.12.12.3.3.1.3"></union><apply id="A1.E15.m1.40.40.40.12.12.12.3.3.1.2.cmml" xref="A1.E15.m1.40.40.40.12.12.12.3.3.1.2"><times id="A1.E15.m1.40.40.40.12.12.12.3.3.1.2.3.cmml" xref="A1.E15.m1.40.40.40.12.12.12.3.3.1.2.3"></times><ci id="A1.E15.m1.40.40.40.12.12.12.3.3.1.2.4.cmml" xref="A1.E15.m1.40.40.40.12.12.12.3.3.1.2.4">B</ci><interval closure="open" id="A1.E15.m1.40.40.40.12.12.12.3.3.1.2.2.3.cmml" xref="A1.E15.m1.40.40.40.12.12.12.3.3.1.2.2.2"><apply id="A1.E15.m1.40.40.40.12.12.12.3.3.1.1.1.1.1.cmml" xref="A1.E15.m1.40.40.40.12.12.12.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E15.m1.40.40.40.12.12.12.3.3.1.1.1.1.1.1.cmml" xref="A1.E15.m1.40.40.40.12.12.12.3.3.1.1.1.1.1">subscript</csymbol><ci id="A1.E15.m1.40.40.40.12.12.12.3.3.1.1.1.1.1.2.cmml" xref="A1.E15.m1.40.40.40.12.12.12.3.3.1.1.1.1.1.2">B</ci><ci id="A1.E15.m1.40.40.40.12.12.12.3.3.1.1.1.1.1.3.cmml" xref="A1.E15.m1.40.40.40.12.12.12.3.3.1.1.1.1.1.3">𝑖</ci></apply><apply id="A1.E15.m1.40.40.40.12.12.12.3.3.1.2.2.2.2.cmml" xref="A1.E15.m1.40.40.40.12.12.12.3.3.1.2.2.2.2"><csymbol cd="ambiguous" id="A1.E15.m1.40.40.40.12.12.12.3.3.1.2.2.2.2.1.cmml" xref="A1.E15.m1.40.40.40.12.12.12.3.3.1.2.2.2.2">subscript</csymbol><apply id="A1.E15.m1.40.40.40.12.12.12.3.3.1.2.2.2.2.2.cmml" xref="A1.E15.m1.40.40.40.12.12.12.3.3.1.2.2.2.2.2"><ci id="A1.E15.m1.40.40.40.12.12.12.3.3.1.2.2.2.2.2.1.cmml" xref="A1.E15.m1.40.40.40.12.12.12.3.3.1.2.2.2.2.2.1">^</ci><ci id="A1.E15.m1.40.40.40.12.12.12.3.3.1.2.2.2.2.2.2.cmml" xref="A1.E15.m1.40.40.40.12.12.12.3.3.1.2.2.2.2.2.2">B</ci></apply><apply id="A1.E15.m1.40.40.40.12.12.12.1.1.1.cmml" xref="A1.E15.m1.40.40.40.12.12.12.1.1.1"><times id="A1.E15.m1.40.40.40.12.12.12.1.1.1.2.cmml" xref="A1.E15.m1.40.40.40.12.12.12.1.1.1.2"></times><ci id="A1.E15.m1.40.40.40.12.12.12.1.1.1.3.cmml" xref="A1.E15.m1.40.40.40.12.12.12.1.1.1.3">𝜎</ci><ci id="A1.E15.m1.40.40.40.12.12.12.1.1.1.1.cmml" xref="A1.E15.m1.40.40.40.12.12.12.1.1.1.1">𝑖</ci></apply></apply></interval><ci id="A1.E15.m1.40.40.40.12.12.12.3.3.1.2.5.cmml" xref="A1.E15.m1.40.40.40.12.12.12.3.3.1.2.5">“</ci><apply id="A1.E15.m1.40.40.40.12.12.12.3.3.1.2.6.cmml" xref="A1.E15.m1.40.40.40.12.12.12.3.3.1.2.6"><csymbol cd="ambiguous" id="A1.E15.m1.40.40.40.12.12.12.3.3.1.2.6.1.cmml" xref="A1.E15.m1.40.40.40.12.12.12.3.3.1.2.6">subscript</csymbol><ci id="A1.E15.m1.40.40.40.12.12.12.3.3.1.2.6.2.cmml" xref="A1.E15.m1.40.40.40.12.12.12.3.3.1.2.6.2">B</ci><ci id="A1.E15.m1.40.40.40.12.12.12.3.3.1.2.6.3.cmml" xref="A1.E15.m1.40.40.40.12.12.12.3.3.1.2.6.3">𝑖</ci></apply></apply><apply id="A1.E15.m1.40.40.40.12.12.12.3.3.1.4.cmml" xref="A1.E15.m1.40.40.40.12.12.12.3.3.1.4"><csymbol cd="ambiguous" id="A1.E15.m1.40.40.40.12.12.12.3.3.1.4.1.cmml" xref="A1.E15.m1.40.40.40.12.12.12.3.3.1.4">subscript</csymbol><apply id="A1.E15.m1.40.40.40.12.12.12.3.3.1.4.2.cmml" xref="A1.E15.m1.40.40.40.12.12.12.3.3.1.4.2"><ci id="A1.E15.m1.40.40.40.12.12.12.3.3.1.4.2.1.cmml" xref="A1.E15.m1.40.40.40.12.12.12.3.3.1.4.2.1">^</ci><ci id="A1.E15.m1.40.40.40.12.12.12.3.3.1.4.2.2.cmml" xref="A1.E15.m1.40.40.40.12.12.12.3.3.1.4.2.2">B</ci></apply><apply id="A1.E15.m1.40.40.40.12.12.12.2.2.1.cmml" xref="A1.E15.m1.40.40.40.12.12.12.2.2.1"><times id="A1.E15.m1.40.40.40.12.12.12.2.2.1.2.cmml" xref="A1.E15.m1.40.40.40.12.12.12.2.2.1.2"></times><ci id="A1.E15.m1.40.40.40.12.12.12.2.2.1.3.cmml" xref="A1.E15.m1.40.40.40.12.12.12.2.2.1.3">𝜎</ci><ci id="A1.E15.m1.40.40.40.12.12.12.2.2.1.1.cmml" xref="A1.E15.m1.40.40.40.12.12.12.2.2.1.1">𝑖</ci></apply></apply></apply></apply><apply id="A1.E15.m1.40.40.40.12.12.12.5.3.cmml" xref="A1.E15.m1.40.40.40.12.12.12.5.2"><abs id="A1.E15.m1.40.40.40.12.12.12.5.3.1.cmml" xref="A1.E15.m1.40.40.40.12.12.12.5.2.2"></abs><apply id="A1.E15.m1.40.40.40.12.12.12.5.2.1.cmml" xref="A1.E15.m1.40.40.40.12.12.12.5.2.1"><times id="A1.E15.m1.40.40.40.12.12.12.5.2.1.3.cmml" xref="A1.E15.m1.40.40.40.12.12.12.5.2.1.3"></times><ci id="A1.E15.m1.40.40.40.12.12.12.5.2.1.4.cmml" xref="A1.E15.m1.40.40.40.12.12.12.5.2.1.4">B</ci><interval closure="open" id="A1.E15.m1.40.40.40.12.12.12.5.2.1.2.3.cmml" xref="A1.E15.m1.40.40.40.12.12.12.5.2.1.2.2"><apply id="A1.E15.m1.40.40.40.12.12.12.5.2.1.1.1.1.cmml" xref="A1.E15.m1.40.40.40.12.12.12.5.2.1.1.1.1"><csymbol cd="ambiguous" id="A1.E15.m1.40.40.40.12.12.12.5.2.1.1.1.1.1.cmml" xref="A1.E15.m1.40.40.40.12.12.12.5.2.1.1.1.1">subscript</csymbol><ci id="A1.E15.m1.40.40.40.12.12.12.5.2.1.1.1.1.2.cmml" xref="A1.E15.m1.40.40.40.12.12.12.5.2.1.1.1.1.2">B</ci><ci id="A1.E15.m1.40.40.40.12.12.12.5.2.1.1.1.1.3.cmml" xref="A1.E15.m1.40.40.40.12.12.12.5.2.1.1.1.1.3">𝑖</ci></apply><apply id="A1.E15.m1.40.40.40.12.12.12.5.2.1.2.2.2.cmml" xref="A1.E15.m1.40.40.40.12.12.12.5.2.1.2.2.2"><csymbol cd="ambiguous" id="A1.E15.m1.40.40.40.12.12.12.5.2.1.2.2.2.1.cmml" xref="A1.E15.m1.40.40.40.12.12.12.5.2.1.2.2.2">subscript</csymbol><apply id="A1.E15.m1.40.40.40.12.12.12.5.2.1.2.2.2.2.cmml" xref="A1.E15.m1.40.40.40.12.12.12.5.2.1.2.2.2.2"><ci id="A1.E15.m1.40.40.40.12.12.12.5.2.1.2.2.2.2.1.cmml" xref="A1.E15.m1.40.40.40.12.12.12.5.2.1.2.2.2.2.1">^</ci><ci id="A1.E15.m1.40.40.40.12.12.12.5.2.1.2.2.2.2.2.cmml" xref="A1.E15.m1.40.40.40.12.12.12.5.2.1.2.2.2.2.2">B</ci></apply><apply id="A1.E15.m1.40.40.40.12.12.12.4.1.1.cmml" xref="A1.E15.m1.40.40.40.12.12.12.4.1.1"><times id="A1.E15.m1.40.40.40.12.12.12.4.1.1.2.cmml" xref="A1.E15.m1.40.40.40.12.12.12.4.1.1.2"></times><ci id="A1.E15.m1.40.40.40.12.12.12.4.1.1.3.cmml" xref="A1.E15.m1.40.40.40.12.12.12.4.1.1.3">𝜎</ci><ci id="A1.E15.m1.40.40.40.12.12.12.4.1.1.1.cmml" xref="A1.E15.m1.40.40.40.12.12.12.4.1.1.1">𝑖</ci></apply></apply></interval></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E15.m1.45c">\begin{gathered}\ell_{\rm cls}(i)=-\text{log}~{}\hat{\rm{P}}_{\sigma(i),c_{i}},~{}~{}~{}\ell_{\rm l1}(i)=||{\rm B}_{i}-\hat{\rm B}_{\sigma(i)}||_{1},\\
\ell_{\rm iou}(i)=1\!-\!\big{(}\frac{|{\rm B}_{i}\cap\hat{{\rm B}}_{\sigma(i)}|}{|{\rm B}_{i}\cup\hat{{\rm B}}_{\sigma(i)}|}-\frac{|{\sf{\rm B}}({\rm B}_{i},\hat{{\rm B}}_{\sigma(i)})\char 92\relax{\rm B}_{i}\cup\hat{{\rm B}}_{\sigma(i)}|}{|{\sf{\rm B}}({\rm B}_{i},\hat{{\rm B}}_{\sigma(i)})|}\big{)},\end{gathered}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(15)</span></td>
</tr></tbody>
</table>
<p id="A1.p3.9" class="ltx_p">where <math id="A1.p3.6.m1.1" class="ltx_Math" alttext="c_{i}" display="inline"><semantics id="A1.p3.6.m1.1a"><msub id="A1.p3.6.m1.1.1" xref="A1.p3.6.m1.1.1.cmml"><mi id="A1.p3.6.m1.1.1.2" xref="A1.p3.6.m1.1.1.2.cmml">c</mi><mi id="A1.p3.6.m1.1.1.3" xref="A1.p3.6.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A1.p3.6.m1.1b"><apply id="A1.p3.6.m1.1.1.cmml" xref="A1.p3.6.m1.1.1"><csymbol cd="ambiguous" id="A1.p3.6.m1.1.1.1.cmml" xref="A1.p3.6.m1.1.1">subscript</csymbol><ci id="A1.p3.6.m1.1.1.2.cmml" xref="A1.p3.6.m1.1.1.2">𝑐</ci><ci id="A1.p3.6.m1.1.1.3.cmml" xref="A1.p3.6.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p3.6.m1.1c">c_{i}</annotation></semantics></math> is the target base class and <math id="A1.p3.7.m2.1" class="ltx_Math" alttext="\sigma(i)" display="inline"><semantics id="A1.p3.7.m2.1a"><mrow id="A1.p3.7.m2.1.2" xref="A1.p3.7.m2.1.2.cmml"><mi id="A1.p3.7.m2.1.2.2" xref="A1.p3.7.m2.1.2.2.cmml">σ</mi><mo lspace="0em" rspace="0em" id="A1.p3.7.m2.1.2.1" xref="A1.p3.7.m2.1.2.1.cmml">​</mo><mrow id="A1.p3.7.m2.1.2.3.2" xref="A1.p3.7.m2.1.2.cmml"><mo stretchy="false" id="A1.p3.7.m2.1.2.3.2.1" xref="A1.p3.7.m2.1.2.cmml">(</mo><mi id="A1.p3.7.m2.1.1" xref="A1.p3.7.m2.1.1.cmml">i</mi><mo stretchy="false" id="A1.p3.7.m2.1.2.3.2.2" xref="A1.p3.7.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.p3.7.m2.1b"><apply id="A1.p3.7.m2.1.2.cmml" xref="A1.p3.7.m2.1.2"><times id="A1.p3.7.m2.1.2.1.cmml" xref="A1.p3.7.m2.1.2.1"></times><ci id="A1.p3.7.m2.1.2.2.cmml" xref="A1.p3.7.m2.1.2.2">𝜎</ci><ci id="A1.p3.7.m2.1.1.cmml" xref="A1.p3.7.m2.1.1">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p3.7.m2.1c">\sigma(i)</annotation></semantics></math> is the bipartite assignment of the <math id="A1.p3.8.m3.1" class="ltx_Math" alttext="i" display="inline"><semantics id="A1.p3.8.m3.1a"><mi id="A1.p3.8.m3.1.1" xref="A1.p3.8.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="A1.p3.8.m3.1b"><ci id="A1.p3.8.m3.1.1.cmml" xref="A1.p3.8.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.p3.8.m3.1c">i</annotation></semantics></math>-th ground-truth box. Also, the embedding loss <math id="A1.p3.9.m4.1" class="ltx_Math" alttext="\ell_{\rm embed}" display="inline"><semantics id="A1.p3.9.m4.1a"><msub id="A1.p3.9.m4.1.1" xref="A1.p3.9.m4.1.1.cmml"><mi mathvariant="normal" id="A1.p3.9.m4.1.1.2" xref="A1.p3.9.m4.1.1.2.cmml">ℓ</mi><mi id="A1.p3.9.m4.1.1.3" xref="A1.p3.9.m4.1.1.3.cmml">embed</mi></msub><annotation-xml encoding="MathML-Content" id="A1.p3.9.m4.1b"><apply id="A1.p3.9.m4.1.1.cmml" xref="A1.p3.9.m4.1.1"><csymbol cd="ambiguous" id="A1.p3.9.m4.1.1.1.cmml" xref="A1.p3.9.m4.1.1">subscript</csymbol><ci id="A1.p3.9.m4.1.1.2.cmml" xref="A1.p3.9.m4.1.1.2">ℓ</ci><ci id="A1.p3.9.m4.1.1.3.cmml" xref="A1.p3.9.m4.1.1.3">embed</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p3.9.m4.1c">\ell_{\rm embed}</annotation></semantics></math> proposed by <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite> is used to distil the CLIP’s knowledge for open vocabulary object detection. Therefore, the final objective of Prompt-OVD is formulated as:</p>
<table id="A1.E16" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="A1.E16.m1.1" class="ltx_Math" alttext="\ell=\lambda_{\rm cls}\ell_{\rm cls}+\lambda_{\rm l1}\ell_{\rm l1}+\lambda_{\rm iou}\ell_{\rm iou}+\lambda_{\rm embed}\ell_{\rm embed}," display="block"><semantics id="A1.E16.m1.1a"><mrow id="A1.E16.m1.1.1.1" xref="A1.E16.m1.1.1.1.1.cmml"><mrow id="A1.E16.m1.1.1.1.1" xref="A1.E16.m1.1.1.1.1.cmml"><mi mathvariant="normal" id="A1.E16.m1.1.1.1.1.2" xref="A1.E16.m1.1.1.1.1.2.cmml">ℓ</mi><mo id="A1.E16.m1.1.1.1.1.1" xref="A1.E16.m1.1.1.1.1.1.cmml">=</mo><mrow id="A1.E16.m1.1.1.1.1.3" xref="A1.E16.m1.1.1.1.1.3.cmml"><mrow id="A1.E16.m1.1.1.1.1.3.2" xref="A1.E16.m1.1.1.1.1.3.2.cmml"><msub id="A1.E16.m1.1.1.1.1.3.2.2" xref="A1.E16.m1.1.1.1.1.3.2.2.cmml"><mi id="A1.E16.m1.1.1.1.1.3.2.2.2" xref="A1.E16.m1.1.1.1.1.3.2.2.2.cmml">λ</mi><mi id="A1.E16.m1.1.1.1.1.3.2.2.3" xref="A1.E16.m1.1.1.1.1.3.2.2.3.cmml">cls</mi></msub><mo lspace="0em" rspace="0em" id="A1.E16.m1.1.1.1.1.3.2.1" xref="A1.E16.m1.1.1.1.1.3.2.1.cmml">​</mo><msub id="A1.E16.m1.1.1.1.1.3.2.3" xref="A1.E16.m1.1.1.1.1.3.2.3.cmml"><mi mathvariant="normal" id="A1.E16.m1.1.1.1.1.3.2.3.2" xref="A1.E16.m1.1.1.1.1.3.2.3.2.cmml">ℓ</mi><mi id="A1.E16.m1.1.1.1.1.3.2.3.3" xref="A1.E16.m1.1.1.1.1.3.2.3.3.cmml">cls</mi></msub></mrow><mo id="A1.E16.m1.1.1.1.1.3.1" xref="A1.E16.m1.1.1.1.1.3.1.cmml">+</mo><mrow id="A1.E16.m1.1.1.1.1.3.3" xref="A1.E16.m1.1.1.1.1.3.3.cmml"><msub id="A1.E16.m1.1.1.1.1.3.3.2" xref="A1.E16.m1.1.1.1.1.3.3.2.cmml"><mi id="A1.E16.m1.1.1.1.1.3.3.2.2" xref="A1.E16.m1.1.1.1.1.3.3.2.2.cmml">λ</mi><mi id="A1.E16.m1.1.1.1.1.3.3.2.3" xref="A1.E16.m1.1.1.1.1.3.3.2.3.cmml">l1</mi></msub><mo lspace="0em" rspace="0em" id="A1.E16.m1.1.1.1.1.3.3.1" xref="A1.E16.m1.1.1.1.1.3.3.1.cmml">​</mo><msub id="A1.E16.m1.1.1.1.1.3.3.3" xref="A1.E16.m1.1.1.1.1.3.3.3.cmml"><mi mathvariant="normal" id="A1.E16.m1.1.1.1.1.3.3.3.2" xref="A1.E16.m1.1.1.1.1.3.3.3.2.cmml">ℓ</mi><mi id="A1.E16.m1.1.1.1.1.3.3.3.3" xref="A1.E16.m1.1.1.1.1.3.3.3.3.cmml">l1</mi></msub></mrow><mo id="A1.E16.m1.1.1.1.1.3.1a" xref="A1.E16.m1.1.1.1.1.3.1.cmml">+</mo><mrow id="A1.E16.m1.1.1.1.1.3.4" xref="A1.E16.m1.1.1.1.1.3.4.cmml"><msub id="A1.E16.m1.1.1.1.1.3.4.2" xref="A1.E16.m1.1.1.1.1.3.4.2.cmml"><mi id="A1.E16.m1.1.1.1.1.3.4.2.2" xref="A1.E16.m1.1.1.1.1.3.4.2.2.cmml">λ</mi><mi id="A1.E16.m1.1.1.1.1.3.4.2.3" xref="A1.E16.m1.1.1.1.1.3.4.2.3.cmml">iou</mi></msub><mo lspace="0em" rspace="0em" id="A1.E16.m1.1.1.1.1.3.4.1" xref="A1.E16.m1.1.1.1.1.3.4.1.cmml">​</mo><msub id="A1.E16.m1.1.1.1.1.3.4.3" xref="A1.E16.m1.1.1.1.1.3.4.3.cmml"><mi mathvariant="normal" id="A1.E16.m1.1.1.1.1.3.4.3.2" xref="A1.E16.m1.1.1.1.1.3.4.3.2.cmml">ℓ</mi><mi id="A1.E16.m1.1.1.1.1.3.4.3.3" xref="A1.E16.m1.1.1.1.1.3.4.3.3.cmml">iou</mi></msub></mrow><mo id="A1.E16.m1.1.1.1.1.3.1b" xref="A1.E16.m1.1.1.1.1.3.1.cmml">+</mo><mrow id="A1.E16.m1.1.1.1.1.3.5" xref="A1.E16.m1.1.1.1.1.3.5.cmml"><msub id="A1.E16.m1.1.1.1.1.3.5.2" xref="A1.E16.m1.1.1.1.1.3.5.2.cmml"><mi id="A1.E16.m1.1.1.1.1.3.5.2.2" xref="A1.E16.m1.1.1.1.1.3.5.2.2.cmml">λ</mi><mi id="A1.E16.m1.1.1.1.1.3.5.2.3" xref="A1.E16.m1.1.1.1.1.3.5.2.3.cmml">embed</mi></msub><mo lspace="0em" rspace="0em" id="A1.E16.m1.1.1.1.1.3.5.1" xref="A1.E16.m1.1.1.1.1.3.5.1.cmml">​</mo><msub id="A1.E16.m1.1.1.1.1.3.5.3" xref="A1.E16.m1.1.1.1.1.3.5.3.cmml"><mi mathvariant="normal" id="A1.E16.m1.1.1.1.1.3.5.3.2" xref="A1.E16.m1.1.1.1.1.3.5.3.2.cmml">ℓ</mi><mi id="A1.E16.m1.1.1.1.1.3.5.3.3" xref="A1.E16.m1.1.1.1.1.3.5.3.3.cmml">embed</mi></msub></mrow></mrow></mrow><mo id="A1.E16.m1.1.1.1.2" xref="A1.E16.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.E16.m1.1b"><apply id="A1.E16.m1.1.1.1.1.cmml" xref="A1.E16.m1.1.1.1"><eq id="A1.E16.m1.1.1.1.1.1.cmml" xref="A1.E16.m1.1.1.1.1.1"></eq><ci id="A1.E16.m1.1.1.1.1.2.cmml" xref="A1.E16.m1.1.1.1.1.2">ℓ</ci><apply id="A1.E16.m1.1.1.1.1.3.cmml" xref="A1.E16.m1.1.1.1.1.3"><plus id="A1.E16.m1.1.1.1.1.3.1.cmml" xref="A1.E16.m1.1.1.1.1.3.1"></plus><apply id="A1.E16.m1.1.1.1.1.3.2.cmml" xref="A1.E16.m1.1.1.1.1.3.2"><times id="A1.E16.m1.1.1.1.1.3.2.1.cmml" xref="A1.E16.m1.1.1.1.1.3.2.1"></times><apply id="A1.E16.m1.1.1.1.1.3.2.2.cmml" xref="A1.E16.m1.1.1.1.1.3.2.2"><csymbol cd="ambiguous" id="A1.E16.m1.1.1.1.1.3.2.2.1.cmml" xref="A1.E16.m1.1.1.1.1.3.2.2">subscript</csymbol><ci id="A1.E16.m1.1.1.1.1.3.2.2.2.cmml" xref="A1.E16.m1.1.1.1.1.3.2.2.2">𝜆</ci><ci id="A1.E16.m1.1.1.1.1.3.2.2.3.cmml" xref="A1.E16.m1.1.1.1.1.3.2.2.3">cls</ci></apply><apply id="A1.E16.m1.1.1.1.1.3.2.3.cmml" xref="A1.E16.m1.1.1.1.1.3.2.3"><csymbol cd="ambiguous" id="A1.E16.m1.1.1.1.1.3.2.3.1.cmml" xref="A1.E16.m1.1.1.1.1.3.2.3">subscript</csymbol><ci id="A1.E16.m1.1.1.1.1.3.2.3.2.cmml" xref="A1.E16.m1.1.1.1.1.3.2.3.2">ℓ</ci><ci id="A1.E16.m1.1.1.1.1.3.2.3.3.cmml" xref="A1.E16.m1.1.1.1.1.3.2.3.3">cls</ci></apply></apply><apply id="A1.E16.m1.1.1.1.1.3.3.cmml" xref="A1.E16.m1.1.1.1.1.3.3"><times id="A1.E16.m1.1.1.1.1.3.3.1.cmml" xref="A1.E16.m1.1.1.1.1.3.3.1"></times><apply id="A1.E16.m1.1.1.1.1.3.3.2.cmml" xref="A1.E16.m1.1.1.1.1.3.3.2"><csymbol cd="ambiguous" id="A1.E16.m1.1.1.1.1.3.3.2.1.cmml" xref="A1.E16.m1.1.1.1.1.3.3.2">subscript</csymbol><ci id="A1.E16.m1.1.1.1.1.3.3.2.2.cmml" xref="A1.E16.m1.1.1.1.1.3.3.2.2">𝜆</ci><ci id="A1.E16.m1.1.1.1.1.3.3.2.3.cmml" xref="A1.E16.m1.1.1.1.1.3.3.2.3">l1</ci></apply><apply id="A1.E16.m1.1.1.1.1.3.3.3.cmml" xref="A1.E16.m1.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="A1.E16.m1.1.1.1.1.3.3.3.1.cmml" xref="A1.E16.m1.1.1.1.1.3.3.3">subscript</csymbol><ci id="A1.E16.m1.1.1.1.1.3.3.3.2.cmml" xref="A1.E16.m1.1.1.1.1.3.3.3.2">ℓ</ci><ci id="A1.E16.m1.1.1.1.1.3.3.3.3.cmml" xref="A1.E16.m1.1.1.1.1.3.3.3.3">l1</ci></apply></apply><apply id="A1.E16.m1.1.1.1.1.3.4.cmml" xref="A1.E16.m1.1.1.1.1.3.4"><times id="A1.E16.m1.1.1.1.1.3.4.1.cmml" xref="A1.E16.m1.1.1.1.1.3.4.1"></times><apply id="A1.E16.m1.1.1.1.1.3.4.2.cmml" xref="A1.E16.m1.1.1.1.1.3.4.2"><csymbol cd="ambiguous" id="A1.E16.m1.1.1.1.1.3.4.2.1.cmml" xref="A1.E16.m1.1.1.1.1.3.4.2">subscript</csymbol><ci id="A1.E16.m1.1.1.1.1.3.4.2.2.cmml" xref="A1.E16.m1.1.1.1.1.3.4.2.2">𝜆</ci><ci id="A1.E16.m1.1.1.1.1.3.4.2.3.cmml" xref="A1.E16.m1.1.1.1.1.3.4.2.3">iou</ci></apply><apply id="A1.E16.m1.1.1.1.1.3.4.3.cmml" xref="A1.E16.m1.1.1.1.1.3.4.3"><csymbol cd="ambiguous" id="A1.E16.m1.1.1.1.1.3.4.3.1.cmml" xref="A1.E16.m1.1.1.1.1.3.4.3">subscript</csymbol><ci id="A1.E16.m1.1.1.1.1.3.4.3.2.cmml" xref="A1.E16.m1.1.1.1.1.3.4.3.2">ℓ</ci><ci id="A1.E16.m1.1.1.1.1.3.4.3.3.cmml" xref="A1.E16.m1.1.1.1.1.3.4.3.3">iou</ci></apply></apply><apply id="A1.E16.m1.1.1.1.1.3.5.cmml" xref="A1.E16.m1.1.1.1.1.3.5"><times id="A1.E16.m1.1.1.1.1.3.5.1.cmml" xref="A1.E16.m1.1.1.1.1.3.5.1"></times><apply id="A1.E16.m1.1.1.1.1.3.5.2.cmml" xref="A1.E16.m1.1.1.1.1.3.5.2"><csymbol cd="ambiguous" id="A1.E16.m1.1.1.1.1.3.5.2.1.cmml" xref="A1.E16.m1.1.1.1.1.3.5.2">subscript</csymbol><ci id="A1.E16.m1.1.1.1.1.3.5.2.2.cmml" xref="A1.E16.m1.1.1.1.1.3.5.2.2">𝜆</ci><ci id="A1.E16.m1.1.1.1.1.3.5.2.3.cmml" xref="A1.E16.m1.1.1.1.1.3.5.2.3">embed</ci></apply><apply id="A1.E16.m1.1.1.1.1.3.5.3.cmml" xref="A1.E16.m1.1.1.1.1.3.5.3"><csymbol cd="ambiguous" id="A1.E16.m1.1.1.1.1.3.5.3.1.cmml" xref="A1.E16.m1.1.1.1.1.3.5.3">subscript</csymbol><ci id="A1.E16.m1.1.1.1.1.3.5.3.2.cmml" xref="A1.E16.m1.1.1.1.1.3.5.3.2">ℓ</ci><ci id="A1.E16.m1.1.1.1.1.3.5.3.3.cmml" xref="A1.E16.m1.1.1.1.1.3.5.3.3">embed</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E16.m1.1c">\ell=\lambda_{\rm cls}\ell_{\rm cls}+\lambda_{\rm l1}\ell_{\rm l1}+\lambda_{\rm iou}\ell_{\rm iou}+\lambda_{\rm embed}\ell_{\rm embed},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(16)</span></td>
</tr></tbody>
</table>
<p id="A1.p3.12" class="ltx_p">where <math id="A1.p3.10.m1.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="A1.p3.10.m1.1a"><mi id="A1.p3.10.m1.1.1" xref="A1.p3.10.m1.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="A1.p3.10.m1.1b"><ci id="A1.p3.10.m1.1.1.cmml" xref="A1.p3.10.m1.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.p3.10.m1.1c">\lambda</annotation></semantics></math>s are the balancing parameters, where <math id="A1.p3.11.m2.2" class="ltx_Math" alttext="\lambda_{\rm cls}=3,\lambda_{\rm l1}=5,\lambda_{\rm iou}=2" display="inline"><semantics id="A1.p3.11.m2.2a"><mrow id="A1.p3.11.m2.2.2.2" xref="A1.p3.11.m2.2.2.3.cmml"><mrow id="A1.p3.11.m2.1.1.1.1" xref="A1.p3.11.m2.1.1.1.1.cmml"><msub id="A1.p3.11.m2.1.1.1.1.2" xref="A1.p3.11.m2.1.1.1.1.2.cmml"><mi id="A1.p3.11.m2.1.1.1.1.2.2" xref="A1.p3.11.m2.1.1.1.1.2.2.cmml">λ</mi><mi id="A1.p3.11.m2.1.1.1.1.2.3" xref="A1.p3.11.m2.1.1.1.1.2.3.cmml">cls</mi></msub><mo id="A1.p3.11.m2.1.1.1.1.1" xref="A1.p3.11.m2.1.1.1.1.1.cmml">=</mo><mn id="A1.p3.11.m2.1.1.1.1.3" xref="A1.p3.11.m2.1.1.1.1.3.cmml">3</mn></mrow><mo id="A1.p3.11.m2.2.2.2.3" xref="A1.p3.11.m2.2.2.3a.cmml">,</mo><mrow id="A1.p3.11.m2.2.2.2.2.2" xref="A1.p3.11.m2.2.2.2.2.3.cmml"><mrow id="A1.p3.11.m2.2.2.2.2.1.1" xref="A1.p3.11.m2.2.2.2.2.1.1.cmml"><msub id="A1.p3.11.m2.2.2.2.2.1.1.2" xref="A1.p3.11.m2.2.2.2.2.1.1.2.cmml"><mi id="A1.p3.11.m2.2.2.2.2.1.1.2.2" xref="A1.p3.11.m2.2.2.2.2.1.1.2.2.cmml">λ</mi><mi id="A1.p3.11.m2.2.2.2.2.1.1.2.3" xref="A1.p3.11.m2.2.2.2.2.1.1.2.3.cmml">l1</mi></msub><mo id="A1.p3.11.m2.2.2.2.2.1.1.1" xref="A1.p3.11.m2.2.2.2.2.1.1.1.cmml">=</mo><mn id="A1.p3.11.m2.2.2.2.2.1.1.3" xref="A1.p3.11.m2.2.2.2.2.1.1.3.cmml">5</mn></mrow><mo id="A1.p3.11.m2.2.2.2.2.2.3" xref="A1.p3.11.m2.2.2.2.2.3a.cmml">,</mo><mrow id="A1.p3.11.m2.2.2.2.2.2.2" xref="A1.p3.11.m2.2.2.2.2.2.2.cmml"><msub id="A1.p3.11.m2.2.2.2.2.2.2.2" xref="A1.p3.11.m2.2.2.2.2.2.2.2.cmml"><mi id="A1.p3.11.m2.2.2.2.2.2.2.2.2" xref="A1.p3.11.m2.2.2.2.2.2.2.2.2.cmml">λ</mi><mi id="A1.p3.11.m2.2.2.2.2.2.2.2.3" xref="A1.p3.11.m2.2.2.2.2.2.2.2.3.cmml">iou</mi></msub><mo id="A1.p3.11.m2.2.2.2.2.2.2.1" xref="A1.p3.11.m2.2.2.2.2.2.2.1.cmml">=</mo><mn id="A1.p3.11.m2.2.2.2.2.2.2.3" xref="A1.p3.11.m2.2.2.2.2.2.2.3.cmml">2</mn></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.p3.11.m2.2b"><apply id="A1.p3.11.m2.2.2.3.cmml" xref="A1.p3.11.m2.2.2.2"><csymbol cd="ambiguous" id="A1.p3.11.m2.2.2.3a.cmml" xref="A1.p3.11.m2.2.2.2.3">formulae-sequence</csymbol><apply id="A1.p3.11.m2.1.1.1.1.cmml" xref="A1.p3.11.m2.1.1.1.1"><eq id="A1.p3.11.m2.1.1.1.1.1.cmml" xref="A1.p3.11.m2.1.1.1.1.1"></eq><apply id="A1.p3.11.m2.1.1.1.1.2.cmml" xref="A1.p3.11.m2.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.p3.11.m2.1.1.1.1.2.1.cmml" xref="A1.p3.11.m2.1.1.1.1.2">subscript</csymbol><ci id="A1.p3.11.m2.1.1.1.1.2.2.cmml" xref="A1.p3.11.m2.1.1.1.1.2.2">𝜆</ci><ci id="A1.p3.11.m2.1.1.1.1.2.3.cmml" xref="A1.p3.11.m2.1.1.1.1.2.3">cls</ci></apply><cn type="integer" id="A1.p3.11.m2.1.1.1.1.3.cmml" xref="A1.p3.11.m2.1.1.1.1.3">3</cn></apply><apply id="A1.p3.11.m2.2.2.2.2.3.cmml" xref="A1.p3.11.m2.2.2.2.2.2"><csymbol cd="ambiguous" id="A1.p3.11.m2.2.2.2.2.3a.cmml" xref="A1.p3.11.m2.2.2.2.2.2.3">formulae-sequence</csymbol><apply id="A1.p3.11.m2.2.2.2.2.1.1.cmml" xref="A1.p3.11.m2.2.2.2.2.1.1"><eq id="A1.p3.11.m2.2.2.2.2.1.1.1.cmml" xref="A1.p3.11.m2.2.2.2.2.1.1.1"></eq><apply id="A1.p3.11.m2.2.2.2.2.1.1.2.cmml" xref="A1.p3.11.m2.2.2.2.2.1.1.2"><csymbol cd="ambiguous" id="A1.p3.11.m2.2.2.2.2.1.1.2.1.cmml" xref="A1.p3.11.m2.2.2.2.2.1.1.2">subscript</csymbol><ci id="A1.p3.11.m2.2.2.2.2.1.1.2.2.cmml" xref="A1.p3.11.m2.2.2.2.2.1.1.2.2">𝜆</ci><ci id="A1.p3.11.m2.2.2.2.2.1.1.2.3.cmml" xref="A1.p3.11.m2.2.2.2.2.1.1.2.3">l1</ci></apply><cn type="integer" id="A1.p3.11.m2.2.2.2.2.1.1.3.cmml" xref="A1.p3.11.m2.2.2.2.2.1.1.3">5</cn></apply><apply id="A1.p3.11.m2.2.2.2.2.2.2.cmml" xref="A1.p3.11.m2.2.2.2.2.2.2"><eq id="A1.p3.11.m2.2.2.2.2.2.2.1.cmml" xref="A1.p3.11.m2.2.2.2.2.2.2.1"></eq><apply id="A1.p3.11.m2.2.2.2.2.2.2.2.cmml" xref="A1.p3.11.m2.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="A1.p3.11.m2.2.2.2.2.2.2.2.1.cmml" xref="A1.p3.11.m2.2.2.2.2.2.2.2">subscript</csymbol><ci id="A1.p3.11.m2.2.2.2.2.2.2.2.2.cmml" xref="A1.p3.11.m2.2.2.2.2.2.2.2.2">𝜆</ci><ci id="A1.p3.11.m2.2.2.2.2.2.2.2.3.cmml" xref="A1.p3.11.m2.2.2.2.2.2.2.2.3">iou</ci></apply><cn type="integer" id="A1.p3.11.m2.2.2.2.2.2.2.3.cmml" xref="A1.p3.11.m2.2.2.2.2.2.2.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p3.11.m2.2c">\lambda_{\rm cls}=3,\lambda_{\rm l1}=5,\lambda_{\rm iou}=2</annotation></semantics></math>, and <math id="A1.p3.12.m3.1" class="ltx_Math" alttext="\lambda_{\rm embed}=2" display="inline"><semantics id="A1.p3.12.m3.1a"><mrow id="A1.p3.12.m3.1.1" xref="A1.p3.12.m3.1.1.cmml"><msub id="A1.p3.12.m3.1.1.2" xref="A1.p3.12.m3.1.1.2.cmml"><mi id="A1.p3.12.m3.1.1.2.2" xref="A1.p3.12.m3.1.1.2.2.cmml">λ</mi><mi id="A1.p3.12.m3.1.1.2.3" xref="A1.p3.12.m3.1.1.2.3.cmml">embed</mi></msub><mo id="A1.p3.12.m3.1.1.1" xref="A1.p3.12.m3.1.1.1.cmml">=</mo><mn id="A1.p3.12.m3.1.1.3" xref="A1.p3.12.m3.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.p3.12.m3.1b"><apply id="A1.p3.12.m3.1.1.cmml" xref="A1.p3.12.m3.1.1"><eq id="A1.p3.12.m3.1.1.1.cmml" xref="A1.p3.12.m3.1.1.1"></eq><apply id="A1.p3.12.m3.1.1.2.cmml" xref="A1.p3.12.m3.1.1.2"><csymbol cd="ambiguous" id="A1.p3.12.m3.1.1.2.1.cmml" xref="A1.p3.12.m3.1.1.2">subscript</csymbol><ci id="A1.p3.12.m3.1.1.2.2.cmml" xref="A1.p3.12.m3.1.1.2.2">𝜆</ci><ci id="A1.p3.12.m3.1.1.2.3.cmml" xref="A1.p3.12.m3.1.1.2.3">embed</ci></apply><cn type="integer" id="A1.p3.12.m3.1.1.3.cmml" xref="A1.p3.12.m3.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p3.12.m3.1c">\lambda_{\rm embed}=2</annotation></semantics></math>.</p>
</div>
<div id="A1.p4" class="ltx_para ltx_noindent">
<p id="A1.p4.1" class="ltx_p"><span id="A1.p4.1.1" class="ltx_text ltx_font_bold">Evaluation.</span>
In the testing phase, the class prompts are inclusive of all base and novel classes following the recent literature <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>, <a href="#bib.bib29" title="" class="ltx_ref">29</a>, <a href="#bib.bib31" title="" class="ltx_ref">31</a>, <a href="#bib.bib32" title="" class="ltx_ref">32</a>, <a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite>. For producing the final results, we apply RoI-based pruning to identify the RoIs with high object scores. Next, the classification results of the selected bounding boxes are ensembled with those from the ViT-based CLIP by Eq. (<a href="#S4.E9" title="In 4.2 Ensemble with ViT-based CLIP ‣ 4 Prompt-OVD ‣ ​​Prompt-Guided Transformers for End-to-End Open-Vocabulary Object Detection​​" class="ltx_ref"><span class="ltx_text ltx_ref_tag">9</span></a>).</p>
</div>
</section>
<section id="A2" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>Potential Enhancement</h2>

<div id="A2.p1" class="ltx_para">
<p id="A2.p1.1" class="ltx_p">We discuss three possible ways to further enhance the potential of our framework.</p>
</div>
<div id="A2.p2" class="ltx_para ltx_noindent">
<p id="A2.p2.1" class="ltx_p"><span id="A2.p2.1.1" class="ltx_text ltx_font_bold">Prediction Ensemble.</span> In our ensemble method, we adopt an arithmetic mean approach as shown in Eq. (<a href="#S4.E9" title="In 4.2 Ensemble with ViT-based CLIP ‣ 4 Prompt-OVD ‣ ​​Prompt-Guided Transformers for End-to-End Open-Vocabulary Object Detection​​" class="ltx_ref"><span class="ltx_text ltx_ref_tag">9</span></a>). However, this requires hyperparameter tuning to achieve the best performance, and the results are sensitive to the selection of <math id="A2.p2.1.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="A2.p2.1.m1.1a"><mi id="A2.p2.1.m1.1.1" xref="A2.p2.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="A2.p2.1.m1.1b"><ci id="A2.p2.1.m1.1.1.cmml" xref="A2.p2.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.p2.1.m1.1c">\alpha</annotation></semantics></math> values, as indicated in Table <a href="#S4.T4" title="Table 4 ‣ 4.3 Training and Evaluation Pipeline ‣ 4 Prompt-OVD ‣ ​​Prompt-Guided Transformers for End-to-End Open-Vocabulary Object Detection​​" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>. The variation in performance highlights the importance of carefully choosing the hyperparameters for Prompt-OVD, as suboptimal selections can have a significant impact on the overall performance. Although the simple ensemble approach provides a satisfactory detection accuracy for OV-COCO and OV-LVIS, we are of the belief that a more effective prediction ensemble strategy can be studied as future work to leverage both CLIP and a detection model in synergy.</p>
</div>
<div id="A2.p3" class="ltx_para ltx_noindent">
<p id="A2.p3.1" class="ltx_p"><span id="A2.p3.1.1" class="ltx_text ltx_font_bold">Unrestricted Setup.</span> Our primary focus is on developing an end-to-end Transformer-based framework that is both efficient and effective. Therefore, we adopt a restricted setup in which external data is not permitted, as our aim is to investigate the potential of the framework itself in achieving optimal performance. Despite our restricted setup, we acknowledge that in real-world scenarios, large-scale external data are often available and their utilization can significantly enhance the zero-shot detection performance. We are confident that our framework can be extended in this direction, owing to its simple end-to-end encoding and decoding pipeline. However, we leave this as a potential avenue for future work, as our current focus is on investigating the framework’s performance under the restricted setup.</p>
</div>
<div id="A2.p4" class="ltx_para ltx_noindent">
<p id="A2.p4.1" class="ltx_p"><span id="A2.p4.1.1" class="ltx_text ltx_font_bold">Instance Segmentation.</span> A drawback of Prompt-OVD is the considerable discrepancy in the performance between object detection and instance segmentation. While this is partly due to inheriting the limitations of using SOLQ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite> for end-to-end joint learning, the development of a more effective segmentation approach based on DETR will enhance the performance of our framework significantly. We leave this as an avenue for future research.</p>
</div>
</section>
<section id="A3" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix C </span>Image Conditioned Detection</h2>

<div id="A3.p1" class="ltx_para">
<p id="A3.p1.1" class="ltx_p">One advantage of our framework is that it can detect objects using an image query instead of relying solely on the class name. This feature has the potential to identify the target object by using a cropped image of the object itself, even when we may not know the object’s name.</p>
</div>
<div id="A3.p2" class="ltx_para">
<p id="A3.p2.1" class="ltx_p">Figure <a href="#A1.F5" title="Figure 5 ‣ Appendix A Training and Evaluation Details ‣ ​​Prompt-Guided Transformers for End-to-End Open-Vocabulary Object Detection​​" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> shows the results of Prompt-OVD when applying this image-conditioned object detection using four different image queries. Although their class names are not provided, Prompt-OVD is capable of accurately localizing target objects that were not encountered during the training phase. Additionally, Prompt-OVD can recognize new classes even when the image query has a dissimilar shape of target objects, as depicted in Figure <a href="#A1.F5" title="Figure 5 ‣ Appendix A Training and Evaluation Details ‣ ​​Prompt-Guided Transformers for End-to-End Open-Vocabulary Object Detection​​" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>(a). These findings suggest that our algorithm is resilient in detecting objects using image queries for open-set scenarios.</p>
</div>
<figure id="A3.T9" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="A3.T9.9.1.1" class="ltx_text" style="font-size:90%;">Table 9</span>: </span><span id="A3.T9.10.2" class="ltx_text" style="font-size:90%;">Performance when using different attention layers for RoI-based masked attention on OV-LVIS </span></figcaption>
<div id="A3.T9.7" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:117.3pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(83.8pt,-22.7pt) scale(1.62983434920345,1.62983434920345) ;">
<table id="A3.T9.7.7" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="A3.T9.4.4.4" class="ltx_tr">
<th id="A3.T9.4.4.4.5" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt">Attn. Layer Num.</th>
<th id="A3.T9.1.1.1.1" class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_tt"><math id="A3.T9.1.1.1.1.m1.1" class="ltx_Math" alttext="\mathrm{mAP^{box}_{novel}}" display="inline"><semantics id="A3.T9.1.1.1.1.m1.1a"><msubsup id="A3.T9.1.1.1.1.m1.1.1" xref="A3.T9.1.1.1.1.m1.1.1.cmml"><mi id="A3.T9.1.1.1.1.m1.1.1.2.2" xref="A3.T9.1.1.1.1.m1.1.1.2.2.cmml">mAP</mi><mi id="A3.T9.1.1.1.1.m1.1.1.3" xref="A3.T9.1.1.1.1.m1.1.1.3.cmml">novel</mi><mi id="A3.T9.1.1.1.1.m1.1.1.2.3" xref="A3.T9.1.1.1.1.m1.1.1.2.3.cmml">box</mi></msubsup><annotation-xml encoding="MathML-Content" id="A3.T9.1.1.1.1.m1.1b"><apply id="A3.T9.1.1.1.1.m1.1.1.cmml" xref="A3.T9.1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="A3.T9.1.1.1.1.m1.1.1.1.cmml" xref="A3.T9.1.1.1.1.m1.1.1">subscript</csymbol><apply id="A3.T9.1.1.1.1.m1.1.1.2.cmml" xref="A3.T9.1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="A3.T9.1.1.1.1.m1.1.1.2.1.cmml" xref="A3.T9.1.1.1.1.m1.1.1">superscript</csymbol><ci id="A3.T9.1.1.1.1.m1.1.1.2.2.cmml" xref="A3.T9.1.1.1.1.m1.1.1.2.2">mAP</ci><ci id="A3.T9.1.1.1.1.m1.1.1.2.3.cmml" xref="A3.T9.1.1.1.1.m1.1.1.2.3">box</ci></apply><ci id="A3.T9.1.1.1.1.m1.1.1.3.cmml" xref="A3.T9.1.1.1.1.m1.1.1.3">novel</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.T9.1.1.1.1.m1.1c">\mathrm{mAP^{box}_{novel}}</annotation></semantics></math></th>
<th id="A3.T9.2.2.2.2" class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_tt"><math id="A3.T9.2.2.2.2.m1.1" class="ltx_Math" alttext="\mathrm{mAP^{box}}" display="inline"><semantics id="A3.T9.2.2.2.2.m1.1a"><msup id="A3.T9.2.2.2.2.m1.1.1" xref="A3.T9.2.2.2.2.m1.1.1.cmml"><mi id="A3.T9.2.2.2.2.m1.1.1.2" xref="A3.T9.2.2.2.2.m1.1.1.2.cmml">mAP</mi><mi id="A3.T9.2.2.2.2.m1.1.1.3" xref="A3.T9.2.2.2.2.m1.1.1.3.cmml">box</mi></msup><annotation-xml encoding="MathML-Content" id="A3.T9.2.2.2.2.m1.1b"><apply id="A3.T9.2.2.2.2.m1.1.1.cmml" xref="A3.T9.2.2.2.2.m1.1.1"><csymbol cd="ambiguous" id="A3.T9.2.2.2.2.m1.1.1.1.cmml" xref="A3.T9.2.2.2.2.m1.1.1">superscript</csymbol><ci id="A3.T9.2.2.2.2.m1.1.1.2.cmml" xref="A3.T9.2.2.2.2.m1.1.1.2">mAP</ci><ci id="A3.T9.2.2.2.2.m1.1.1.3.cmml" xref="A3.T9.2.2.2.2.m1.1.1.3">box</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.T9.2.2.2.2.m1.1c">\mathrm{mAP^{box}}</annotation></semantics></math></th>
<th id="A3.T9.3.3.3.3" class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_tt"><math id="A3.T9.3.3.3.3.m1.1" class="ltx_Math" alttext="\mathrm{mAP^{mask}_{novel}}" display="inline"><semantics id="A3.T9.3.3.3.3.m1.1a"><msubsup id="A3.T9.3.3.3.3.m1.1.1" xref="A3.T9.3.3.3.3.m1.1.1.cmml"><mi id="A3.T9.3.3.3.3.m1.1.1.2.2" xref="A3.T9.3.3.3.3.m1.1.1.2.2.cmml">mAP</mi><mi id="A3.T9.3.3.3.3.m1.1.1.3" xref="A3.T9.3.3.3.3.m1.1.1.3.cmml">novel</mi><mi id="A3.T9.3.3.3.3.m1.1.1.2.3" xref="A3.T9.3.3.3.3.m1.1.1.2.3.cmml">mask</mi></msubsup><annotation-xml encoding="MathML-Content" id="A3.T9.3.3.3.3.m1.1b"><apply id="A3.T9.3.3.3.3.m1.1.1.cmml" xref="A3.T9.3.3.3.3.m1.1.1"><csymbol cd="ambiguous" id="A3.T9.3.3.3.3.m1.1.1.1.cmml" xref="A3.T9.3.3.3.3.m1.1.1">subscript</csymbol><apply id="A3.T9.3.3.3.3.m1.1.1.2.cmml" xref="A3.T9.3.3.3.3.m1.1.1"><csymbol cd="ambiguous" id="A3.T9.3.3.3.3.m1.1.1.2.1.cmml" xref="A3.T9.3.3.3.3.m1.1.1">superscript</csymbol><ci id="A3.T9.3.3.3.3.m1.1.1.2.2.cmml" xref="A3.T9.3.3.3.3.m1.1.1.2.2">mAP</ci><ci id="A3.T9.3.3.3.3.m1.1.1.2.3.cmml" xref="A3.T9.3.3.3.3.m1.1.1.2.3">mask</ci></apply><ci id="A3.T9.3.3.3.3.m1.1.1.3.cmml" xref="A3.T9.3.3.3.3.m1.1.1.3">novel</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.T9.3.3.3.3.m1.1c">\mathrm{mAP^{mask}_{novel}}</annotation></semantics></math></th>
<th id="A3.T9.4.4.4.4" class="ltx_td ltx_nopad_r ltx_align_right ltx_th ltx_th_column ltx_border_tt"><math id="A3.T9.4.4.4.4.m1.1" class="ltx_Math" alttext="\mathrm{mAP^{mask}}" display="inline"><semantics id="A3.T9.4.4.4.4.m1.1a"><msup id="A3.T9.4.4.4.4.m1.1.1" xref="A3.T9.4.4.4.4.m1.1.1.cmml"><mi id="A3.T9.4.4.4.4.m1.1.1.2" xref="A3.T9.4.4.4.4.m1.1.1.2.cmml">mAP</mi><mi id="A3.T9.4.4.4.4.m1.1.1.3" xref="A3.T9.4.4.4.4.m1.1.1.3.cmml">mask</mi></msup><annotation-xml encoding="MathML-Content" id="A3.T9.4.4.4.4.m1.1b"><apply id="A3.T9.4.4.4.4.m1.1.1.cmml" xref="A3.T9.4.4.4.4.m1.1.1"><csymbol cd="ambiguous" id="A3.T9.4.4.4.4.m1.1.1.1.cmml" xref="A3.T9.4.4.4.4.m1.1.1">superscript</csymbol><ci id="A3.T9.4.4.4.4.m1.1.1.2.cmml" xref="A3.T9.4.4.4.4.m1.1.1.2">mAP</ci><ci id="A3.T9.4.4.4.4.m1.1.1.3.cmml" xref="A3.T9.4.4.4.4.m1.1.1.3">mask</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.T9.4.4.4.4.m1.1c">\mathrm{mAP^{mask}}</annotation></semantics></math></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="A3.T9.5.5.5" class="ltx_tr">
<th id="A3.T9.5.5.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t"><math id="A3.T9.5.5.5.1.m1.1" class="ltx_Math" alttext="\mathrm{15^{th}}" display="inline"><semantics id="A3.T9.5.5.5.1.m1.1a"><msup id="A3.T9.5.5.5.1.m1.1.1" xref="A3.T9.5.5.5.1.m1.1.1.cmml"><mn id="A3.T9.5.5.5.1.m1.1.1.2" xref="A3.T9.5.5.5.1.m1.1.1.2.cmml">15</mn><mi id="A3.T9.5.5.5.1.m1.1.1.3" xref="A3.T9.5.5.5.1.m1.1.1.3.cmml">th</mi></msup><annotation-xml encoding="MathML-Content" id="A3.T9.5.5.5.1.m1.1b"><apply id="A3.T9.5.5.5.1.m1.1.1.cmml" xref="A3.T9.5.5.5.1.m1.1.1"><csymbol cd="ambiguous" id="A3.T9.5.5.5.1.m1.1.1.1.cmml" xref="A3.T9.5.5.5.1.m1.1.1">superscript</csymbol><cn type="integer" id="A3.T9.5.5.5.1.m1.1.1.2.cmml" xref="A3.T9.5.5.5.1.m1.1.1.2">15</cn><ci id="A3.T9.5.5.5.1.m1.1.1.3.cmml" xref="A3.T9.5.5.5.1.m1.1.1.3">th</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.T9.5.5.5.1.m1.1c">\mathrm{15^{th}}</annotation></semantics></math></th>
<td id="A3.T9.5.5.5.2" class="ltx_td ltx_align_right ltx_border_t">13.6</td>
<td id="A3.T9.5.5.5.3" class="ltx_td ltx_align_right ltx_border_t">28.3</td>
<td id="A3.T9.5.5.5.4" class="ltx_td ltx_align_right ltx_border_t">10.5</td>
<td id="A3.T9.5.5.5.5" class="ltx_td ltx_nopad_r ltx_align_right ltx_border_t">20.4</td>
</tr>
<tr id="A3.T9.6.6.6" class="ltx_tr">
<th id="A3.T9.6.6.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><math id="A3.T9.6.6.6.1.m1.1" class="ltx_Math" alttext="\mathrm{20^{th}}" display="inline"><semantics id="A3.T9.6.6.6.1.m1.1a"><msup id="A3.T9.6.6.6.1.m1.1.1" xref="A3.T9.6.6.6.1.m1.1.1.cmml"><mn id="A3.T9.6.6.6.1.m1.1.1.2" xref="A3.T9.6.6.6.1.m1.1.1.2.cmml">20</mn><mi id="A3.T9.6.6.6.1.m1.1.1.3" xref="A3.T9.6.6.6.1.m1.1.1.3.cmml">th</mi></msup><annotation-xml encoding="MathML-Content" id="A3.T9.6.6.6.1.m1.1b"><apply id="A3.T9.6.6.6.1.m1.1.1.cmml" xref="A3.T9.6.6.6.1.m1.1.1"><csymbol cd="ambiguous" id="A3.T9.6.6.6.1.m1.1.1.1.cmml" xref="A3.T9.6.6.6.1.m1.1.1">superscript</csymbol><cn type="integer" id="A3.T9.6.6.6.1.m1.1.1.2.cmml" xref="A3.T9.6.6.6.1.m1.1.1.2">20</cn><ci id="A3.T9.6.6.6.1.m1.1.1.3.cmml" xref="A3.T9.6.6.6.1.m1.1.1.3">th</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.T9.6.6.6.1.m1.1c">\mathrm{20^{th}}</annotation></semantics></math></th>
<td id="A3.T9.6.6.6.2" class="ltx_td ltx_align_right">20.4</td>
<td id="A3.T9.6.6.6.3" class="ltx_td ltx_align_right">30.1</td>
<td id="A3.T9.6.6.6.4" class="ltx_td ltx_align_right">16.2</td>
<td id="A3.T9.6.6.6.5" class="ltx_td ltx_nopad_r ltx_align_right">21.9</td>
</tr>
<tr id="A3.T9.7.7.7" class="ltx_tr">
<th id="A3.T9.7.7.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb">
<math id="A3.T9.7.7.7.1.m1.1" class="ltx_Math" alttext="\mathrm{24^{th}}" display="inline"><semantics id="A3.T9.7.7.7.1.m1.1a"><msup id="A3.T9.7.7.7.1.m1.1.1" xref="A3.T9.7.7.7.1.m1.1.1.cmml"><mn id="A3.T9.7.7.7.1.m1.1.1.2" xref="A3.T9.7.7.7.1.m1.1.1.2.cmml">24</mn><mi id="A3.T9.7.7.7.1.m1.1.1.3" xref="A3.T9.7.7.7.1.m1.1.1.3.cmml">th</mi></msup><annotation-xml encoding="MathML-Content" id="A3.T9.7.7.7.1.m1.1b"><apply id="A3.T9.7.7.7.1.m1.1.1.cmml" xref="A3.T9.7.7.7.1.m1.1.1"><csymbol cd="ambiguous" id="A3.T9.7.7.7.1.m1.1.1.1.cmml" xref="A3.T9.7.7.7.1.m1.1.1">superscript</csymbol><cn type="integer" id="A3.T9.7.7.7.1.m1.1.1.2.cmml" xref="A3.T9.7.7.7.1.m1.1.1.2">24</cn><ci id="A3.T9.7.7.7.1.m1.1.1.3.cmml" xref="A3.T9.7.7.7.1.m1.1.1.3">th</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.T9.7.7.7.1.m1.1c">\mathrm{24^{th}}</annotation></semantics></math><span id="A3.T9.7.7.7.1.1" class="ltx_text ltx_font_bold"> (last layer)</span>
</th>
<td id="A3.T9.7.7.7.2" class="ltx_td ltx_align_right ltx_border_bb"><span id="A3.T9.7.7.7.2.1" class="ltx_text ltx_font_bold">29.4</span></td>
<td id="A3.T9.7.7.7.3" class="ltx_td ltx_align_right ltx_border_bb"><span id="A3.T9.7.7.7.3.1" class="ltx_text ltx_font_bold">33.0</span></td>
<td id="A3.T9.7.7.7.4" class="ltx_td ltx_align_right ltx_border_bb"><span id="A3.T9.7.7.7.4.1" class="ltx_text ltx_font_bold">23.1</span></td>
<td id="A3.T9.7.7.7.5" class="ltx_td ltx_nopad_r ltx_align_right ltx_border_bb"><span id="A3.T9.7.7.7.5.1" class="ltx_text ltx_font_bold">24.2</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
</section>
<section id="A4" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix D </span>Supplementary Analysis</h2>

<div id="A4.p1" class="ltx_para">
<p id="A4.p1.1" class="ltx_p">We provide supplementary analysis on applying RoI-based masked attention to different attention layers in Appendix <a href="#A4.SS2" title="D.2 Different Layers for RoI-based Attention ‣ Appendix D Supplementary Analysis ‣ ​​Prompt-Guided Transformers for End-to-End Open-Vocabulary Object Detection​​" class="ltx_ref"><span class="ltx_text ltx_ref_tag">D.2</span></a> and using different pre-trained ViT backbones with Prompt-OVD in Appendix <a href="#A4.SS1" title="D.1 Pre-trained Weights. ‣ Appendix D Supplementary Analysis ‣ ​​Prompt-Guided Transformers for End-to-End Open-Vocabulary Object Detection​​" class="ltx_ref"><span class="ltx_text ltx_ref_tag">D.1</span></a>.</p>
</div>
<section id="A4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">D.1 </span>Pre-trained Weights.</h3>

<div id="A4.SS1.p1" class="ltx_para">
<p id="A4.SS1.p1.1" class="ltx_p">We analyze the impact of using different initial weights for the backbone, ImageNet and MAE, on the overall performance. As outlined in Table <a href="#A4.T10" title="Table 10 ‣ D.2 Different Layers for RoI-based Attention ‣ Appendix D Supplementary Analysis ‣ ​​Prompt-Guided Transformers for End-to-End Open-Vocabulary Object Detection​​" class="ltx_ref"><span class="ltx_text ltx_ref_tag">10</span></a>, training the backbone using the MAE pre-trained weights yields better performance in dense prediction tasks such as object detection and instance segmentation, even under an open-vocabulary setup, compared to starting from the ImageNet pre-trained weights. This observation is consistent with previous research, such as <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>.
It is also worth noting that even when using the ImageNet pre-trained weights, Prompt-OVD still outperforms the baseline (OV-DETR) with a much faster inference speed.
In conclusion, the choice of initial weight for the backbone plays a crucial role in the overall performance of the model, and using the MAE pre-trained weights as the starting point results in better performance.</p>
</div>
</section>
<section id="A4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">D.2 </span>Different Layers for RoI-based Attention</h3>

<div id="A4.SS2.p1" class="ltx_para">
<p id="A4.SS2.p1.1" class="ltx_p">We investigate the impact of applying our RoI-based masked attention to different attention layers in the ViT-L/14 image encoder of CLIP. The results, as summarized in Table <a href="#A3.T9" title="Table 9 ‣ Appendix C Image Conditioned Detection ‣ ​​Prompt-Guided Transformers for End-to-End Open-Vocabulary Object Detection​​" class="ltx_ref"><span class="ltx_text ltx_ref_tag">9</span></a>, show that detection accuracy improves as the layer number increases, from the 15th to the 24th. Therefore, applying the technique to the last layer is the best design choice for open vocabulary detection with Prompt-OVD.</p>
</div>
<figure id="A4.T10" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="A4.T10.6.1.1" class="ltx_text" style="font-size:90%;">Table 10</span>: </span><span id="A4.T10.7.2" class="ltx_text" style="font-size:90%;">Performance when using different pre-trained ViT backbones on OV-LVIS.</span></figcaption>
<div id="A4.T10.4" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:70.1pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(49.7pt,-8.0pt) scale(1.29742830174741,1.29742830174741) ;">
<table id="A4.T10.4.4" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="A4.T10.4.4.4" class="ltx_tr">
<th id="A4.T10.4.4.4.5" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt">Pretrained Model</th>
<th id="A4.T10.1.1.1.1" class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_tt"><math id="A4.T10.1.1.1.1.m1.1" class="ltx_Math" alttext="\mathrm{mAP^{box}_{novel}}" display="inline"><semantics id="A4.T10.1.1.1.1.m1.1a"><msubsup id="A4.T10.1.1.1.1.m1.1.1" xref="A4.T10.1.1.1.1.m1.1.1.cmml"><mi id="A4.T10.1.1.1.1.m1.1.1.2.2" xref="A4.T10.1.1.1.1.m1.1.1.2.2.cmml">mAP</mi><mi id="A4.T10.1.1.1.1.m1.1.1.3" xref="A4.T10.1.1.1.1.m1.1.1.3.cmml">novel</mi><mi id="A4.T10.1.1.1.1.m1.1.1.2.3" xref="A4.T10.1.1.1.1.m1.1.1.2.3.cmml">box</mi></msubsup><annotation-xml encoding="MathML-Content" id="A4.T10.1.1.1.1.m1.1b"><apply id="A4.T10.1.1.1.1.m1.1.1.cmml" xref="A4.T10.1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="A4.T10.1.1.1.1.m1.1.1.1.cmml" xref="A4.T10.1.1.1.1.m1.1.1">subscript</csymbol><apply id="A4.T10.1.1.1.1.m1.1.1.2.cmml" xref="A4.T10.1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="A4.T10.1.1.1.1.m1.1.1.2.1.cmml" xref="A4.T10.1.1.1.1.m1.1.1">superscript</csymbol><ci id="A4.T10.1.1.1.1.m1.1.1.2.2.cmml" xref="A4.T10.1.1.1.1.m1.1.1.2.2">mAP</ci><ci id="A4.T10.1.1.1.1.m1.1.1.2.3.cmml" xref="A4.T10.1.1.1.1.m1.1.1.2.3">box</ci></apply><ci id="A4.T10.1.1.1.1.m1.1.1.3.cmml" xref="A4.T10.1.1.1.1.m1.1.1.3">novel</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.T10.1.1.1.1.m1.1c">\mathrm{mAP^{box}_{novel}}</annotation></semantics></math></th>
<th id="A4.T10.2.2.2.2" class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_tt"><math id="A4.T10.2.2.2.2.m1.1" class="ltx_Math" alttext="\mathrm{mAP^{box}}" display="inline"><semantics id="A4.T10.2.2.2.2.m1.1a"><msup id="A4.T10.2.2.2.2.m1.1.1" xref="A4.T10.2.2.2.2.m1.1.1.cmml"><mi id="A4.T10.2.2.2.2.m1.1.1.2" xref="A4.T10.2.2.2.2.m1.1.1.2.cmml">mAP</mi><mi id="A4.T10.2.2.2.2.m1.1.1.3" xref="A4.T10.2.2.2.2.m1.1.1.3.cmml">box</mi></msup><annotation-xml encoding="MathML-Content" id="A4.T10.2.2.2.2.m1.1b"><apply id="A4.T10.2.2.2.2.m1.1.1.cmml" xref="A4.T10.2.2.2.2.m1.1.1"><csymbol cd="ambiguous" id="A4.T10.2.2.2.2.m1.1.1.1.cmml" xref="A4.T10.2.2.2.2.m1.1.1">superscript</csymbol><ci id="A4.T10.2.2.2.2.m1.1.1.2.cmml" xref="A4.T10.2.2.2.2.m1.1.1.2">mAP</ci><ci id="A4.T10.2.2.2.2.m1.1.1.3.cmml" xref="A4.T10.2.2.2.2.m1.1.1.3">box</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.T10.2.2.2.2.m1.1c">\mathrm{mAP^{box}}</annotation></semantics></math></th>
<th id="A4.T10.3.3.3.3" class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_tt"><math id="A4.T10.3.3.3.3.m1.1" class="ltx_Math" alttext="\mathrm{mAP^{mask}_{novel}}" display="inline"><semantics id="A4.T10.3.3.3.3.m1.1a"><msubsup id="A4.T10.3.3.3.3.m1.1.1" xref="A4.T10.3.3.3.3.m1.1.1.cmml"><mi id="A4.T10.3.3.3.3.m1.1.1.2.2" xref="A4.T10.3.3.3.3.m1.1.1.2.2.cmml">mAP</mi><mi id="A4.T10.3.3.3.3.m1.1.1.3" xref="A4.T10.3.3.3.3.m1.1.1.3.cmml">novel</mi><mi id="A4.T10.3.3.3.3.m1.1.1.2.3" xref="A4.T10.3.3.3.3.m1.1.1.2.3.cmml">mask</mi></msubsup><annotation-xml encoding="MathML-Content" id="A4.T10.3.3.3.3.m1.1b"><apply id="A4.T10.3.3.3.3.m1.1.1.cmml" xref="A4.T10.3.3.3.3.m1.1.1"><csymbol cd="ambiguous" id="A4.T10.3.3.3.3.m1.1.1.1.cmml" xref="A4.T10.3.3.3.3.m1.1.1">subscript</csymbol><apply id="A4.T10.3.3.3.3.m1.1.1.2.cmml" xref="A4.T10.3.3.3.3.m1.1.1"><csymbol cd="ambiguous" id="A4.T10.3.3.3.3.m1.1.1.2.1.cmml" xref="A4.T10.3.3.3.3.m1.1.1">superscript</csymbol><ci id="A4.T10.3.3.3.3.m1.1.1.2.2.cmml" xref="A4.T10.3.3.3.3.m1.1.1.2.2">mAP</ci><ci id="A4.T10.3.3.3.3.m1.1.1.2.3.cmml" xref="A4.T10.3.3.3.3.m1.1.1.2.3">mask</ci></apply><ci id="A4.T10.3.3.3.3.m1.1.1.3.cmml" xref="A4.T10.3.3.3.3.m1.1.1.3">novel</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.T10.3.3.3.3.m1.1c">\mathrm{mAP^{mask}_{novel}}</annotation></semantics></math></th>
<th id="A4.T10.4.4.4.4" class="ltx_td ltx_nopad_r ltx_align_right ltx_th ltx_th_column ltx_border_tt"><math id="A4.T10.4.4.4.4.m1.1" class="ltx_Math" alttext="\mathrm{mAP^{mask}}" display="inline"><semantics id="A4.T10.4.4.4.4.m1.1a"><msup id="A4.T10.4.4.4.4.m1.1.1" xref="A4.T10.4.4.4.4.m1.1.1.cmml"><mi id="A4.T10.4.4.4.4.m1.1.1.2" xref="A4.T10.4.4.4.4.m1.1.1.2.cmml">mAP</mi><mi id="A4.T10.4.4.4.4.m1.1.1.3" xref="A4.T10.4.4.4.4.m1.1.1.3.cmml">mask</mi></msup><annotation-xml encoding="MathML-Content" id="A4.T10.4.4.4.4.m1.1b"><apply id="A4.T10.4.4.4.4.m1.1.1.cmml" xref="A4.T10.4.4.4.4.m1.1.1"><csymbol cd="ambiguous" id="A4.T10.4.4.4.4.m1.1.1.1.cmml" xref="A4.T10.4.4.4.4.m1.1.1">superscript</csymbol><ci id="A4.T10.4.4.4.4.m1.1.1.2.cmml" xref="A4.T10.4.4.4.4.m1.1.1.2">mAP</ci><ci id="A4.T10.4.4.4.4.m1.1.1.3.cmml" xref="A4.T10.4.4.4.4.m1.1.1.3">mask</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.T10.4.4.4.4.m1.1c">\mathrm{mAP^{mask}}</annotation></semantics></math></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="A4.T10.4.4.5.1" class="ltx_tr">
<th id="A4.T10.4.4.5.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">ImageNet <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite>
</th>
<td id="A4.T10.4.4.5.1.2" class="ltx_td ltx_align_right ltx_border_t">26.4</td>
<td id="A4.T10.4.4.5.1.3" class="ltx_td ltx_align_right ltx_border_t">28.7</td>
<td id="A4.T10.4.4.5.1.4" class="ltx_td ltx_align_right ltx_border_t">20.7</td>
<td id="A4.T10.4.4.5.1.5" class="ltx_td ltx_nopad_r ltx_align_right ltx_border_t">20.9</td>
</tr>
<tr id="A4.T10.4.4.6.2" class="ltx_tr">
<th id="A4.T10.4.4.6.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb">
<span id="A4.T10.4.4.6.2.1.1" class="ltx_text ltx_font_bold">MAE</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite>
</th>
<td id="A4.T10.4.4.6.2.2" class="ltx_td ltx_align_right ltx_border_bb"><span id="A4.T10.4.4.6.2.2.1" class="ltx_text ltx_font_bold">29.4</span></td>
<td id="A4.T10.4.4.6.2.3" class="ltx_td ltx_align_right ltx_border_bb"><span id="A4.T10.4.4.6.2.3.1" class="ltx_text ltx_font_bold">33.0</span></td>
<td id="A4.T10.4.4.6.2.4" class="ltx_td ltx_align_right ltx_border_bb"><span id="A4.T10.4.4.6.2.4.1" class="ltx_text ltx_font_bold">23.1</span></td>
<td id="A4.T10.4.4.6.2.5" class="ltx_td ltx_nopad_r ltx_align_right ltx_border_bb"><span id="A4.T10.4.4.6.2.5.1" class="ltx_text ltx_font_bold">24.2</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
</section>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2303.14385" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2303.14386" class="ar5iv-text-button ar5iv-severity-warning">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2303.14386">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2303.14386" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2303.14387" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Thu Feb 29 17:17:35 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
