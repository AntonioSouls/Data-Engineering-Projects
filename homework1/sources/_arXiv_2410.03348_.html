<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>Dolphin: A Programmable Framework for Scalable Neurosymbolic Learning</title>
<!--Generated on Fri Oct  4 12:12:25 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<base href="/html/2410.03348v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.03348v1#S1" title="In Dolphin: A Programmable Framework for Scalable Neurosymbolic Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03348v1#S2" title="In Dolphin: A Programmable Framework for Scalable Neurosymbolic Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Overview</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03348v1#S3" title="In 2 Overview ‣ Dolphin: A Programmable Framework for Scalable Neurosymbolic Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>The <span class="ltx_text ltx_font_smallcaps">Dolphin</span> Framework</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03348v1#S3.SS1" title="In 3 The Dolphin Framework ‣ 2 Overview ‣ Dolphin: A Programmable Framework for Scalable Neurosymbolic Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span><span class="ltx_text ltx_font_smallcaps">Dolphin</span> Core Design Principles</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03348v1#S3.SS2" title="In 3 The Dolphin Framework ‣ 2 Overview ‣ Dolphin: A Programmable Framework for Scalable Neurosymbolic Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>The <span class="ltx_text ltx_font_smallcaps">Dolphin</span> Syntax</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03348v1#S3.SS2.SSS1" title="In 3.2 The Dolphin Syntax ‣ 3 The Dolphin Framework ‣ 2 Overview ‣ Dolphin: A Programmable Framework for Scalable Neurosymbolic Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2.1 </span>Abstractions</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03348v1#S3.SS2.SSS2" title="In 3.2 The Dolphin Syntax ‣ 3 The Dolphin Framework ‣ 2 Overview ‣ Dolphin: A Programmable Framework for Scalable Neurosymbolic Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2.2 </span>Operations</span></a>
<ol class="ltx_toclist ltx_toclist_subsubsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.03348v1#S3.SS2.SSS2.Px1" title="In 3.2.2 Operations ‣ 3.2 The Dolphin Syntax ‣ 3 The Dolphin Framework ‣ 2 Overview ‣ Dolphin: A Programmable Framework for Scalable Neurosymbolic Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_text ltx_font_smallcaps">Apply</span>.</span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03348v1#S3.SS3" title="In 3 The Dolphin Framework ‣ 2 Overview ‣ Dolphin: A Programmable Framework for Scalable Neurosymbolic Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3 </span><span class="ltx_text ltx_font_smallcaps">Dolphin</span> Provenances</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03348v1#S3.SS4" title="In 3 The Dolphin Framework ‣ 2 Overview ‣ Dolphin: A Programmable Framework for Scalable Neurosymbolic Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.4 </span>Building the <span class="ltx_text ltx_font_smallcaps">Dolphin</span> Program</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03348v1#S4" title="In 3.4 Building the Dolphin Program ‣ 3 The Dolphin Framework ‣ 2 Overview ‣ Dolphin: A Programmable Framework for Scalable Neurosymbolic Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Experiments</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03348v1#S4.SS1" title="In 4 Experiments ‣ 3.4 Building the Dolphin Program ‣ 3 The Dolphin Framework ‣ 2 Overview ‣ Dolphin: A Programmable Framework for Scalable Neurosymbolic Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Benchmarks</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03348v1#S4.SS2" title="In 4 Experiments ‣ 3.4 Building the Dolphin Program ‣ 3 The Dolphin Framework ‣ 2 Overview ‣ Dolphin: A Programmable Framework for Scalable Neurosymbolic Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>Experimental Setup and Baselines</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03348v1#S4.SS3" title="In 4 Experiments ‣ 3.4 Building the Dolphin Program ‣ 3 The Dolphin Framework ‣ 2 Overview ‣ Dolphin: A Programmable Framework for Scalable Neurosymbolic Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3 </span>RQ1: Scalability</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03348v1#S4.SS4" title="In 4 Experiments ‣ 3.4 Building the Dolphin Program ‣ 3 The Dolphin Framework ‣ 2 Overview ‣ Dolphin: A Programmable Framework for Scalable Neurosymbolic Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.4 </span>RQ2: Accuracy</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03348v1#S4.SS5" title="In 4 Experiments ‣ 3.4 Building the Dolphin Program ‣ 3 The Dolphin Framework ‣ 2 Overview ‣ Dolphin: A Programmable Framework for Scalable Neurosymbolic Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.5 </span>RQ3: Provenance Comparisons</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03348v1#S5" title="In 4.5 RQ3: Provenance Comparisons ‣ 4 Experiments ‣ 3.4 Building the Dolphin Program ‣ 3 The Dolphin Framework ‣ 2 Overview ‣ Dolphin: A Programmable Framework for Scalable Neurosymbolic Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Related Work</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03348v1#S6" title="In 5 Related Work ‣ 4.5 RQ3: Provenance Comparisons ‣ 4 Experiments ‣ 3.4 Building the Dolphin Program ‣ 3 The Dolphin Framework ‣ 2 Overview ‣ Dolphin: A Programmable Framework for Scalable Neurosymbolic Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6 </span>Conclusion and Limitations</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03348v1#A1" title="In 6 Conclusion and Limitations ‣ 5 Related Work ‣ 4.5 RQ3: Provenance Comparisons ‣ 4 Experiments ‣ 3.4 Building the Dolphin Program ‣ 3 The Dolphin Framework ‣ 2 Overview ‣ Dolphin: A Programmable Framework for Scalable Neurosymbolic Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A </span><span class="ltx_text ltx_font_smallcaps">Dolphin</span> Experiment Details for Benchmarks</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03348v1#A1.SS1" title="In Appendix A Dolphin Experiment Details for Benchmarks ‣ 6 Conclusion and Limitations ‣ 5 Related Work ‣ 4.5 RQ3: Provenance Comparisons ‣ 4 Experiments ‣ 3.4 Building the Dolphin Program ‣ 3 The Dolphin Framework ‣ 2 Overview ‣ Dolphin: A Programmable Framework for Scalable Neurosymbolic Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.1 </span>MNIST Sum-N</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03348v1#A1.SS2" title="In Appendix A Dolphin Experiment Details for Benchmarks ‣ 6 Conclusion and Limitations ‣ 5 Related Work ‣ 4.5 RQ3: Provenance Comparisons ‣ 4 Experiments ‣ 3.4 Building the Dolphin Program ‣ 3 The Dolphin Framework ‣ 2 Overview ‣ Dolphin: A Programmable Framework for Scalable Neurosymbolic Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.2 </span>Hand-Written Formula</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03348v1#A1.SS3" title="In Appendix A Dolphin Experiment Details for Benchmarks ‣ 6 Conclusion and Limitations ‣ 5 Related Work ‣ 4.5 RQ3: Provenance Comparisons ‣ 4 Experiments ‣ 3.4 Building the Dolphin Program ‣ 3 The Dolphin Framework ‣ 2 Overview ‣ Dolphin: A Programmable Framework for Scalable Neurosymbolic Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.3 </span>PathFinder</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03348v1#A1.SS4" title="In Appendix A Dolphin Experiment Details for Benchmarks ‣ 6 Conclusion and Limitations ‣ 5 Related Work ‣ 4.5 RQ3: Provenance Comparisons ‣ 4 Experiments ‣ 3.4 Building the Dolphin Program ‣ 3 The Dolphin Framework ‣ 2 Overview ‣ Dolphin: A Programmable Framework for Scalable Neurosymbolic Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.4 </span>CLUTRR</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03348v1#A1.SS5" title="In Appendix A Dolphin Experiment Details for Benchmarks ‣ 6 Conclusion and Limitations ‣ 5 Related Work ‣ 4.5 RQ3: Provenance Comparisons ‣ 4 Experiments ‣ 3.4 Building the Dolphin Program ‣ 3 The Dolphin Framework ‣ 2 Overview ‣ Dolphin: A Programmable Framework for Scalable Neurosymbolic Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.5 </span>Mugen</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2410.03348v1#A2" title="In 6 Conclusion and Limitations ‣ 5 Related Work ‣ 4.5 RQ3: Provenance Comparisons ‣ 4 Experiments ‣ 3.4 Building the Dolphin Program ‣ 3 The Dolphin Framework ‣ 2 Overview ‣ Dolphin: A Programmable Framework for Scalable Neurosymbolic Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B </span>Accuracy Curves for Mugen</span></a></li>
</ol>
</li>
</ol>
</li>
</ol>
</li>
</ol>
</li>
</ol>
</li>
</ol>
</li>
</ol>
</li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line"><span class="ltx_note ltx_role_affiliationtext" id="id1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_note_type">affiliationtext: </span>Department of Computer and Information Science, University of Pennsylvania</span></span></span><span class="ltx_note ltx_role_affiliationtext" id="id2"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_note_type">affiliationtext: </span>Department of Computer Science, Cornell University</span></span></span>
<h1 class="ltx_title ltx_title_document">
<span class="ltx_text ltx_font_smallcaps" id="id4.id1">Dolphin</span>: A Programmable Framework for Scalable Neurosymbolic Learning</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Aaditya Naik
</span><span class="ltx_author_notes"></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Jason Liu
</span><span class="ltx_author_notes"></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Claire Wang
</span><span class="ltx_author_notes"></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Saikat Dutta
</span><span class="ltx_author_notes"></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Mayur Naik
</span><span class="ltx_author_notes"></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Eric Wong
</span><span class="ltx_author_notes"></span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id3.3">Neurosymbolic learning has emerged as a promising paradigm to incorporate
symbolic reasoning into deep learning models.
However, existing frameworks are limited in scalability with respect to both
the training data and the complexity of symbolic programs.
We propose <span class="ltx_text ltx_font_smallcaps" id="id3.3.1">Dolphin</span>, a framework to scale neurosymbolic learning at a fundamental level by mapping both forward chaining and backward gradient propagation in symbolic programs
to vectorized computations.
For this purpose, <span class="ltx_text ltx_font_smallcaps" id="id3.3.2">Dolphin</span> introduces a set of abstractions and primitives
built directly on top of a high-performance deep learning framework like
PyTorch, effectively enabling symbolic programs to be written as PyTorch modules.
It thereby enables neurosymbolic programs to be written in a language like Python that is familiar to developers and compile them to computation graphs that are amenable to end-to-end differentiation on GPUs.
We evaluate <span class="ltx_text ltx_font_smallcaps" id="id3.3.3">Dolphin</span> on a suite of 13 benchmarks across 5 neurosymbolic tasks that combine deep learning models for
text, image, or video processing with symbolic programs that involve multi-hop
reasoning, recursion, and even black-box functions like Python <span class="ltx_text ltx_font_typewriter" id="id3.3.4">eval()</span>.
<span class="ltx_text ltx_font_smallcaps" id="id3.3.5">Dolphin</span> only takes <math alttext="0.33" class="ltx_Math" display="inline" id="id1.1.m1.1"><semantics id="id1.1.m1.1a"><mn id="id1.1.m1.1.1" xref="id1.1.m1.1.1.cmml">0.33</mn><annotation-xml encoding="MathML-Content" id="id1.1.m1.1b"><cn id="id1.1.m1.1.1.cmml" type="float" xref="id1.1.m1.1.1">0.33</cn></annotation-xml><annotation encoding="application/x-tex" id="id1.1.m1.1c">0.33</annotation><annotation encoding="application/x-llamapun" id="id1.1.m1.1d">0.33</annotation></semantics></math>%-<math alttext="37.17" class="ltx_Math" display="inline" id="id2.2.m2.1"><semantics id="id2.2.m2.1a"><mn id="id2.2.m2.1.1" xref="id2.2.m2.1.1.cmml">37.17</mn><annotation-xml encoding="MathML-Content" id="id2.2.m2.1b"><cn id="id2.2.m2.1.1.cmml" type="float" xref="id2.2.m2.1.1">37.17</cn></annotation-xml><annotation encoding="application/x-tex" id="id2.2.m2.1c">37.17</annotation><annotation encoding="application/x-llamapun" id="id2.2.m2.1d">37.17</annotation></semantics></math>% of the time (and <math alttext="2.77" class="ltx_Math" display="inline" id="id3.3.m3.1"><semantics id="id3.3.m3.1a"><mn id="id3.3.m3.1.1" xref="id3.3.m3.1.1.cmml">2.77</mn><annotation-xml encoding="MathML-Content" id="id3.3.m3.1b"><cn id="id3.3.m3.1.1.cmml" type="float" xref="id3.3.m3.1.1">2.77</cn></annotation-xml><annotation encoding="application/x-tex" id="id3.3.m3.1c">2.77</annotation><annotation encoding="application/x-llamapun" id="id3.3.m3.1d">2.77</annotation></semantics></math>% on average) to train these models on the largest input per task compared to baselines Scallop, ISED, and IndeCateR+, which time out on most of these inputs.
Models written in <span class="ltx_text ltx_font_smallcaps" id="id3.3.6">Dolphin</span> also achieve state-of-the-art accuracies even on the largest benchmarks.</p>
</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>
<div class="ltx_para ltx_noindent" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">Deep learning has achieved remarkable success on a wide range of tasks such as image classification, speech
recognition, and natural language processing. With the recent emergence of foundation models like GPT-4 and CLIP, deep learning models are now increasingly being used in more challenging tasks. While such models work well for prediction and generation tasks, they are limited in their ability to perform reasoning required for tasks involving structure, logic, and planning, where symbolic reasoning traditionally excels <cite class="ltx_cite ltx_citemacro_citep">(Kambhampati et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03348v1#bib.bib7" title="">2024</a>)</cite>.
Neurosymbolic programming <cite class="ltx_cite ltx_citemacro_citep">(Chaudhuri et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03348v1#bib.bib1" title="">2021</a>)</cite> has emerged as a promising paradigm to incorporate symbolic reasoning into deep learning models, providing the best of both worlds.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">Various frameworks have been developed to improve the programmability and accessibility of neurosymbolic applications <cite class="ltx_cite ltx_citemacro_citep">(Manhaeve et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03348v1#bib.bib11" title="">2018</a>; Li et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03348v1#bib.bib9" title="">2023</a>; Solko-Breslin et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03348v1#bib.bib18" title="">2024</a>)</cite>.
These frameworks support complex symbolic reasoning features like recursion and black-box functions, implement efficient differentiable reasoning algorithms, and provide bindings for deep learning frameworks like PyTorch.
Despite significant strides, however, these frameworks incur significant overhead
when training neurosymbolic programs.</p>
</div>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.6">Consider a typical workflow of such a framework depicted in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03348v1#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Dolphin: A Programmable Framework for Scalable Neurosymbolic Learning"><span class="ltx_text ltx_ref_tag">1</span></a>(a).
In this case, we have a supervised learning task with labeled data <math alttext="(x,y)" class="ltx_Math" display="inline" id="S1.p3.1.m1.2"><semantics id="S1.p3.1.m1.2a"><mrow id="S1.p3.1.m1.2.3.2" xref="S1.p3.1.m1.2.3.1.cmml"><mo id="S1.p3.1.m1.2.3.2.1" stretchy="false" xref="S1.p3.1.m1.2.3.1.cmml">(</mo><mi id="S1.p3.1.m1.1.1" xref="S1.p3.1.m1.1.1.cmml">x</mi><mo id="S1.p3.1.m1.2.3.2.2" xref="S1.p3.1.m1.2.3.1.cmml">,</mo><mi id="S1.p3.1.m1.2.2" xref="S1.p3.1.m1.2.2.cmml">y</mi><mo id="S1.p3.1.m1.2.3.2.3" stretchy="false" xref="S1.p3.1.m1.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S1.p3.1.m1.2b"><interval closure="open" id="S1.p3.1.m1.2.3.1.cmml" xref="S1.p3.1.m1.2.3.2"><ci id="S1.p3.1.m1.1.1.cmml" xref="S1.p3.1.m1.1.1">𝑥</ci><ci id="S1.p3.1.m1.2.2.cmml" xref="S1.p3.1.m1.2.2">𝑦</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.1.m1.2c">(x,y)</annotation><annotation encoding="application/x-llamapun" id="S1.p3.1.m1.2d">( italic_x , italic_y )</annotation></semantics></math>, a neural network <math alttext="M_{\theta}" class="ltx_Math" display="inline" id="S1.p3.2.m2.1"><semantics id="S1.p3.2.m2.1a"><msub id="S1.p3.2.m2.1.1" xref="S1.p3.2.m2.1.1.cmml"><mi id="S1.p3.2.m2.1.1.2" xref="S1.p3.2.m2.1.1.2.cmml">M</mi><mi id="S1.p3.2.m2.1.1.3" xref="S1.p3.2.m2.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S1.p3.2.m2.1b"><apply id="S1.p3.2.m2.1.1.cmml" xref="S1.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S1.p3.2.m2.1.1.1.cmml" xref="S1.p3.2.m2.1.1">subscript</csymbol><ci id="S1.p3.2.m2.1.1.2.cmml" xref="S1.p3.2.m2.1.1.2">𝑀</ci><ci id="S1.p3.2.m2.1.1.3.cmml" xref="S1.p3.2.m2.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.2.m2.1c">M_{\theta}</annotation><annotation encoding="application/x-llamapun" id="S1.p3.2.m2.1d">italic_M start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math> that processes input <math alttext="x" class="ltx_Math" display="inline" id="S1.p3.3.m3.1"><semantics id="S1.p3.3.m3.1a"><mi id="S1.p3.3.m3.1.1" xref="S1.p3.3.m3.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S1.p3.3.m3.1b"><ci id="S1.p3.3.m3.1.1.cmml" xref="S1.p3.3.m3.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.3.m3.1c">x</annotation><annotation encoding="application/x-llamapun" id="S1.p3.3.m3.1d">italic_x</annotation></semantics></math>, and a symbolic program <math alttext="P_{\tt symbolic}" class="ltx_Math" display="inline" id="S1.p3.4.m4.1"><semantics id="S1.p3.4.m4.1a"><msub id="S1.p3.4.m4.1.1" xref="S1.p3.4.m4.1.1.cmml"><mi id="S1.p3.4.m4.1.1.2" xref="S1.p3.4.m4.1.1.2.cmml">P</mi><mi id="S1.p3.4.m4.1.1.3" xref="S1.p3.4.m4.1.1.3.cmml">𝚜𝚢𝚖𝚋𝚘𝚕𝚒𝚌</mi></msub><annotation-xml encoding="MathML-Content" id="S1.p3.4.m4.1b"><apply id="S1.p3.4.m4.1.1.cmml" xref="S1.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S1.p3.4.m4.1.1.1.cmml" xref="S1.p3.4.m4.1.1">subscript</csymbol><ci id="S1.p3.4.m4.1.1.2.cmml" xref="S1.p3.4.m4.1.1.2">𝑃</ci><ci id="S1.p3.4.m4.1.1.3.cmml" xref="S1.p3.4.m4.1.1.3">𝚜𝚢𝚖𝚋𝚘𝚕𝚒𝚌</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.4.m4.1c">P_{\tt symbolic}</annotation><annotation encoding="application/x-llamapun" id="S1.p3.4.m4.1d">italic_P start_POSTSUBSCRIPT typewriter_symbolic end_POSTSUBSCRIPT</annotation></semantics></math> that takes the network’s output <math alttext="r" class="ltx_Math" display="inline" id="S1.p3.5.m5.1"><semantics id="S1.p3.5.m5.1a"><mi id="S1.p3.5.m5.1.1" xref="S1.p3.5.m5.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S1.p3.5.m5.1b"><ci id="S1.p3.5.m5.1.1.cmml" xref="S1.p3.5.m5.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.5.m5.1c">r</annotation><annotation encoding="application/x-llamapun" id="S1.p3.5.m5.1d">italic_r</annotation></semantics></math> and produces final output <math alttext="y" class="ltx_Math" display="inline" id="S1.p3.6.m6.1"><semantics id="S1.p3.6.m6.1a"><mi id="S1.p3.6.m6.1.1" xref="S1.p3.6.m6.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S1.p3.6.m6.1b"><ci id="S1.p3.6.m6.1.1.cmml" xref="S1.p3.6.m6.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.6.m6.1c">y</annotation><annotation encoding="application/x-llamapun" id="S1.p3.6.m6.1d">italic_y</annotation></semantics></math>.
Existing frameworks, such as Scallop <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03348v1#bib.bib9" title="">2023</a>)</cite>, execute the neural model on GPU but use a separate CPU-based backend (implemented in Rust in Scallop’s case) for the
symbolic program. Moreover, such systems suffer from slow inter-process
data transfers between the two environments.</p>
</div>
<figure class="ltx_figure" id="S1.F1">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S1.F1.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="65" id="S1.F1.sf1.g1" src="x1.png" width="258"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(a) </span>Typical neurosymbolic framework (e.g. Scallop).</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S1.F1.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="65" id="S1.F1.sf2.g1" src="x2.png" width="237"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(b) </span>Our neurosymbolic framework <span class="ltx_text ltx_font_smallcaps" id="S1.F1.sf2.2.1">Dolphin</span>.</figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Comparison of system architectures of neurosymbolic frameworks.</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">Together, these issues hinder the scalability of neurosymbolic learning with respect to <span class="ltx_text ltx_font_italic" id="S1.p4.1.1">problem complexity</span>
and <span class="ltx_text ltx_font_italic" id="S1.p4.1.2">data complexity</span>.
First, the symbolic computation engine must derive a set of all possible results and their associated probabilities in a manner that is differentiable with respect to the network’s parameters <math alttext="\theta" class="ltx_Math" display="inline" id="S1.p4.1.m1.1"><semantics id="S1.p4.1.m1.1a"><mi id="S1.p4.1.m1.1.1" xref="S1.p4.1.m1.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S1.p4.1.m1.1b"><ci id="S1.p4.1.m1.1.1.cmml" xref="S1.p4.1.m1.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.1.m1.1c">\theta</annotation><annotation encoding="application/x-llamapun" id="S1.p4.1.m1.1d">italic_θ</annotation></semantics></math>.
As the complexity of the symbolic program increases, the number of possible results and their associated weights also grows exponentially, leading to a combinatorial explosion in the number of required computations.
However, the symbolic computations are discrete and not easily parallelizable on modern hardware like GPUs.
Second, larger datasets also compound the computational cost of neurosymbolic learning. Deep learning typically addresses this challenge by batching computations across multiple data samples.
However, in neurosymbolic learning, the computations may differ across data samples, making it difficult to batch them effectively.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p5">
<p class="ltx_p" id="S1.p5.1">To address these challenges, we need to fundamentally rethink the design of a neurosymbolic framework. One approach is to develop specialized and low-level primitives that scale specific benchmarks but make it time-intensive for developers to write neurosymbolic programs tailored to particular tasks. Alternatively, providing high-level primitives—such as a logic programming language like Scallop <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03348v1#bib.bib9" title="">2023</a>)</cite> or DeepProbLog <cite class="ltx_cite ltx_citemacro_citep">(Manhaeve et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03348v1#bib.bib11" title="">2018</a>)</cite>—simplifies the development of symbolic programs but limits the fine-grained control needed to scale specific applications. Finally, to truly democratize neurosymbolic programming, it is crucial to develop a framework that seamlessly integrates into the everyday deep learning workflows that developers already use.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p6">
<p class="ltx_p" id="S1.p6.1">In this work, we propose <span class="ltx_text ltx_font_smallcaps" id="S1.p6.1.1">Dolphin</span>, a novel framework for scalable neurosymbolic learning. In <span class="ltx_text ltx_font_smallcaps" id="S1.p6.1.2">Dolphin</span>, we build three key components that effectively tackle the scalability and programmability challenges described above. First, we develop a general symbolic representation that efficiently captures the relationships between neural network outputs and associated discrete symbols.
Second, we introduce a set of primitives to map forward chaining in symbolic programs to vectorized computations over these representations.
Third, we develop a set of vectorized <span class="ltx_text ltx_font_italic" id="S1.p6.1.3">provenance semirings</span> <cite class="ltx_cite ltx_citemacro_citep">(Green et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03348v1#bib.bib4" title="">2007</a>)</cite> that are easily pluggable into <span class="ltx_text ltx_font_smallcaps" id="S1.p6.1.4">Dolphin</span> and enable to efficiently compute symbolic gradients.
As illustrated in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03348v1#S1.F1.sf2" title="In Figure 1 ‣ 1 Introduction ‣ Dolphin: A Programmable Framework for Scalable Neurosymbolic Learning"><span class="ltx_text ltx_ref_tag">1(b)</span></a>, these components together allow <span class="ltx_text ltx_font_smallcaps" id="S1.p6.1.5">Dolphin</span> to build a computation graph that spans both symbolic and neural operations, is highly parallelizable, and end-to-end differentiable on GPUs. Finally, <span class="ltx_text ltx_font_smallcaps" id="S1.p6.1.6">Dolphin</span> is implemented as a library that is integrated with PyTorch, allowing users to easily incorporate it into their
existing deep learning pipelines.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p7">
<p class="ltx_p" id="S1.p7.3">We evaluate <span class="ltx_text ltx_font_smallcaps" id="S1.p7.3.1">Dolphin</span> on a diverse set of neurosymbolic tasks that involve text, image, video, and multi-modal data, and use rich reasoning features such as recursion and black-box Python functions.
Neurosymbolic programs written using <span class="ltx_text ltx_font_smallcaps" id="S1.p7.3.2">Dolphin</span> only require <math alttext="0.33" class="ltx_Math" display="inline" id="S1.p7.1.m1.1"><semantics id="S1.p7.1.m1.1a"><mn id="S1.p7.1.m1.1.1" xref="S1.p7.1.m1.1.1.cmml">0.33</mn><annotation-xml encoding="MathML-Content" id="S1.p7.1.m1.1b"><cn id="S1.p7.1.m1.1.1.cmml" type="float" xref="S1.p7.1.m1.1.1">0.33</cn></annotation-xml><annotation encoding="application/x-tex" id="S1.p7.1.m1.1c">0.33</annotation><annotation encoding="application/x-llamapun" id="S1.p7.1.m1.1d">0.33</annotation></semantics></math>%-<math alttext="37.17" class="ltx_Math" display="inline" id="S1.p7.2.m2.1"><semantics id="S1.p7.2.m2.1a"><mn id="S1.p7.2.m2.1.1" xref="S1.p7.2.m2.1.1.cmml">37.17</mn><annotation-xml encoding="MathML-Content" id="S1.p7.2.m2.1b"><cn id="S1.p7.2.m2.1.1.cmml" type="float" xref="S1.p7.2.m2.1.1">37.17</cn></annotation-xml><annotation encoding="application/x-tex" id="S1.p7.2.m2.1c">37.17</annotation><annotation encoding="application/x-llamapun" id="S1.p7.2.m2.1d">37.17</annotation></semantics></math>% (<math alttext="2.77" class="ltx_Math" display="inline" id="S1.p7.3.m3.1"><semantics id="S1.p7.3.m3.1a"><mn id="S1.p7.3.m3.1.1" xref="S1.p7.3.m3.1.1.cmml">2.77</mn><annotation-xml encoding="MathML-Content" id="S1.p7.3.m3.1b"><cn id="S1.p7.3.m3.1.1.cmml" type="float" xref="S1.p7.3.m3.1.1">2.77</cn></annotation-xml><annotation encoding="application/x-tex" id="S1.p7.3.m3.1c">2.77</annotation><annotation encoding="application/x-llamapun" id="S1.p7.3.m3.1d">2.77</annotation></semantics></math>% on average) of the time to train compared to state-of-the-art baselines including differentiable reasoning frameworks like Scallop, and sampling-based frameworks like ISED and IndeCateR+ while maintaining similar levels of accuracy.
We also observe that <span class="ltx_text ltx_font_smallcaps" id="S1.p7.3.3">Dolphin</span> efficiently scales to
more complex benchmarks and larger datasets whereas the baselines either time out after 10 hours or fail to converge.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p8">
<p class="ltx_p" id="S1.p8.1">We make the following contributions in this work:</p>
<ul class="ltx_itemize" id="S1.I1">
<li class="ltx_item" id="S1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i1.p1">
<p class="ltx_p" id="S1.I1.i1.p1.1">We propose <span class="ltx_text ltx_font_smallcaps" id="S1.I1.i1.p1.1.1">Dolphin</span>, a novel neurosymbolic programming framework for end-to-end differentiable symbolic reasoning in a scalable manner.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i2.p1">
<p class="ltx_p" id="S1.I1.i2.p1.1">We develop novel abstractions to represent symbolic and neural computations and introduce vectorized primitives for neurosymbolic programs.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i3.p1">
<p class="ltx_p" id="S1.I1.i3.p1.1">We develop vectorized provenances that can be plugged into <span class="ltx_text ltx_font_smallcaps" id="S1.I1.i3.p1.1.1">Dolphin</span> for efficient computation of symbolic
gradients on parallelizable hardware such as GPUs.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para ltx_noindent" id="S1.I1.i4.p1">
<p class="ltx_p" id="S1.I1.i4.p1.1">We evaluate <span class="ltx_text ltx_font_smallcaps" id="S1.I1.i4.p1.1.1">Dolphin</span> on a diverse range of challenging neurosymbolic tasks across different domains and show that it effectively scales with increasing problem complexity and dataset size.</p>
</div>
</li>
</ul>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Overview</h2>
<div class="ltx_para" id="S2.p1">
<p class="ltx_p" id="S2.p1.4">We illustrate our approach using the MNIST Sum-<math alttext="N" class="ltx_Math" display="inline" id="S2.p1.1.m1.1"><semantics id="S2.p1.1.m1.1a"><mi id="S2.p1.1.m1.1.1" xref="S2.p1.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S2.p1.1.m1.1b"><ci id="S2.p1.1.m1.1.1.cmml" xref="S2.p1.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.1.m1.1c">N</annotation><annotation encoding="application/x-llamapun" id="S2.p1.1.m1.1d">italic_N</annotation></semantics></math> task from <cite class="ltx_cite ltx_citemacro_citep">(De Smet et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03348v1#bib.bib3" title="">2024</a>)</cite>.
The goal is to train a model that takes as input <math alttext="N" class="ltx_Math" display="inline" id="S2.p1.2.m2.1"><semantics id="S2.p1.2.m2.1a"><mi id="S2.p1.2.m2.1.1" xref="S2.p1.2.m2.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S2.p1.2.m2.1b"><ci id="S2.p1.2.m2.1.1.cmml" xref="S2.p1.2.m2.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.2.m2.1c">N</annotation><annotation encoding="application/x-llamapun" id="S2.p1.2.m2.1d">italic_N</annotation></semantics></math> images of MNIST digits and returns the sum of the digits represented by the images.
During learning, supervision is provided only on the sum instead of the labels of the digits. The difficulty of the problem scales exponentially as there are <math alttext="10^{N}" class="ltx_Math" display="inline" id="S2.p1.3.m3.1"><semantics id="S2.p1.3.m3.1a"><msup id="S2.p1.3.m3.1.1" xref="S2.p1.3.m3.1.1.cmml"><mn id="S2.p1.3.m3.1.1.2" xref="S2.p1.3.m3.1.1.2.cmml">10</mn><mi id="S2.p1.3.m3.1.1.3" xref="S2.p1.3.m3.1.1.3.cmml">N</mi></msup><annotation-xml encoding="MathML-Content" id="S2.p1.3.m3.1b"><apply id="S2.p1.3.m3.1.1.cmml" xref="S2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S2.p1.3.m3.1.1.1.cmml" xref="S2.p1.3.m3.1.1">superscript</csymbol><cn id="S2.p1.3.m3.1.1.2.cmml" type="integer" xref="S2.p1.3.m3.1.1.2">10</cn><ci id="S2.p1.3.m3.1.1.3.cmml" xref="S2.p1.3.m3.1.1.3">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.3.m3.1c">10^{N}</annotation><annotation encoding="application/x-llamapun" id="S2.p1.3.m3.1d">10 start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT</annotation></semantics></math> states in the input space. Further, there are only <math alttext="9N+1" class="ltx_Math" display="inline" id="S2.p1.4.m4.1"><semantics id="S2.p1.4.m4.1a"><mrow id="S2.p1.4.m4.1.1" xref="S2.p1.4.m4.1.1.cmml"><mrow id="S2.p1.4.m4.1.1.2" xref="S2.p1.4.m4.1.1.2.cmml"><mn id="S2.p1.4.m4.1.1.2.2" xref="S2.p1.4.m4.1.1.2.2.cmml">9</mn><mo id="S2.p1.4.m4.1.1.2.1" xref="S2.p1.4.m4.1.1.2.1.cmml">⁢</mo><mi id="S2.p1.4.m4.1.1.2.3" xref="S2.p1.4.m4.1.1.2.3.cmml">N</mi></mrow><mo id="S2.p1.4.m4.1.1.1" xref="S2.p1.4.m4.1.1.1.cmml">+</mo><mn id="S2.p1.4.m4.1.1.3" xref="S2.p1.4.m4.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.4.m4.1b"><apply id="S2.p1.4.m4.1.1.cmml" xref="S2.p1.4.m4.1.1"><plus id="S2.p1.4.m4.1.1.1.cmml" xref="S2.p1.4.m4.1.1.1"></plus><apply id="S2.p1.4.m4.1.1.2.cmml" xref="S2.p1.4.m4.1.1.2"><times id="S2.p1.4.m4.1.1.2.1.cmml" xref="S2.p1.4.m4.1.1.2.1"></times><cn id="S2.p1.4.m4.1.1.2.2.cmml" type="integer" xref="S2.p1.4.m4.1.1.2.2">9</cn><ci id="S2.p1.4.m4.1.1.2.3.cmml" xref="S2.p1.4.m4.1.1.2.3">𝑁</ci></apply><cn id="S2.p1.4.m4.1.1.3.cmml" type="integer" xref="S2.p1.4.m4.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.4.m4.1c">9N+1</annotation><annotation encoding="application/x-llamapun" id="S2.p1.4.m4.1d">9 italic_N + 1</annotation></semantics></math> possible labels, resulting in very sparse supervision.</p>
</div>
<figure class="ltx_figure" id="S2.1">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<div class="ltx_listing ltx_figure_panel ltx_lst_language_Python ltx_lst_numbers_left ltx_lstlisting ltx_listing" id="S2.1.1" style="background-color:#FFFFFF;border-color: #000000;">
<div class="ltx_listing_data"><a download="" href="data:text/plain;base64,Y2xhc3MgTU5JU1ROZXQobm4uTW9kdWxlKToKICBkZWYgX19pbml0X18oc2VsZik6CiAgICBzdXBlcihNTklTVE5ldCwgc2VsZikuX19pbml0X18oKQogICAgLi4uCgpjbGFzcyBTdW1OTmV0KG5uLk1vZHVsZSk6CiAgZGVmIF9faW5pdF9fKHNlbGYpOgogICAgc3VwZXIoU3VtTk5ldCwgc2VsZikuX19pbml0X18oKQogICAgc2VsZi5DTk4gPSBNTklTVE5ldCgpCgogIGRlZiBmb3J3YXJkKHNlbGYsIGltZ3MpOgogICAgZGlnaXRzID0gcmFuZ2UoMTApCiAgICBEX3JlcyA9IERpc3RyaWJ1dGlvbihzZWxmLkNOTihpbWdzWzBdKSwgZGlnaXRzKQogICAgZm9yIGkgaW4gcmFuZ2UoMSwgbGVuKGltZ3MpKToKICAgICAgRF9pID0gRGlzdHJpYnV0aW9uKHNlbGYuQ05OKGltZ3NbaV0pLCBkaWdpdHMpCiAgICAgIERfcmVzID0gYXBwbHkoRF9yZXMsIERfaSwgbGFtYmRhIHgseTogeCArIHkpCiAgICBsX3JlcyA9IGdldF9sb2dpdHMoRF9yZXMpCiAgICByZXR1cm4gbF9yZXNcZW5ke2xzdGxpc3Rpbmd9CiAgICAgICAgXGNhcHRpb257Q29kZSB1c2luZyBcdG9vbHt9IHByaW1pdGl2ZXMgd2l0aCBQeVRvcmNoLn0KICAgICAgICBcbGFiZWx7ZmlnOm1uaXN0X3N1bV9uX2NvZGV9CiAgICBcZW5ke3N1YmZpZ3VyZX0KICAgIFxoZmlsbAogICAgXGJlZ2lue3N1YmZpZ3VyZX17MC40M1x0ZXh0d2lkdGh9CiAgICBcdnNwYWNley0wLjA1aW59CiAgICAgICAgXGNlbnRlcmluZwogICAgICAgIFxpbmNsdWRlZ3JhcGhpY3Nbd2lkdGg9MC42XHRleHR3aWR0aF17ZmlndXJlcy9mbG93LnBuZ30KICAgICAgICBcY2FwdGlvbntDb21wb25lbnRzIG9mIHRoZSBcY29kZXtTdW1OTmV0fSBtb2RlbC59CiAgICAgICAgXGxhYmVse2ZpZzptbmlzdF9zdW1fYnJlYWtkb3dufQogICAgXGVuZHtzdWJmaWd1cmV9CiAgICBcY2FwdGlvbntBIG5ldXJvc3ltYm9saWMgcHJvZ3JhbSBmb3IgdGhlIE1OSVNUIFN1bS1OIHRhc2sgd3JpdHRlbiB1c2luZyBcdG9vbHt9Ln0KICAgICBcdnNwYWNley0wLjFpbn0KICAgIFxsYWJlbHtmaWc6bW5pc3Rfc3VtX25fZXhhbXBsZX0KXGVuZHtmaWd1cmV9CgoKCgoKCgoKCkZpZ3VyZX5ccmVme2ZpZzptbmlzdF9zdW1fbl9jb2RlfSBzaG93cyB0aGUgY29kZSBmb3IgdGhpcyB0YXNrIHVzaW5nIFx0b29se30gd2l0aCBQeVRvcmNoLgpUaGUgbmV1cmFsIG1vZHVsZSBpcyBhIGNvbnZvbHV0aW9uYWwgbmV1cmFsIG5ldHdvcmsgKENOTikgY2FsbGVkIFxjb2Rle01OSVNUTmV0fS4KSXQgdGFrZXMgaW4gYSBiYXRjaCBvZiBpbWFnZSB0dXBsZXMgXGNvZGV7aW1nc30gd2hlcmUgZWFjaCBzYW1wbGUgY29udGFpbnMgJE4kIE1OSVNUIGltYWdlcy4KXGNvZGV7TU5JU1ROZXR9IGNsYXNzaWZpZXMgZWFjaCBpbWFnZSBpbnRvIG9uZSBvZiAxMCBjbGFzc2VzIHJlcHJlc2VudGluZyB0aGUgZGlnaXRzIDAtOS4KVGhlIGxvZ2l0cyBwcm9kdWNlZCBieSBcY29kZXtNTklTVE5ldH0sIHJlcHJlc2VudGluZyBwcm9iYWJpbGl0eSBkaXN0cmlidXRpb25zIG92ZXIgdGhlIGRpZ2l0cywgYXJlIHRoZW4gcGFzc2VkIGFzIGlucHV0cyB0byB0aGUgc3ltYm9saWMgcHJvZ3JhbS4KTGluZXMgMTMtMTcgZGVwaWN0IGEgc3ltYm9saWMgcHJvZ3JhbSB3cml0dGVuIGluIFB5dGhvbiB1c2luZyBcdG9vbHt9IHByaW1pdGl2ZXMuICUKCkluIG9yZGVyIHRvIHN1cHBvcnQgdHJhaW5pbmcsIHRoZSBzeW1ib2xpYyBwcm9ncmFtIG11c3QgcmVhc29uIG92ZXIgYWxsIHRoZSBvdXRwdXRzIG9mIHRoZSBDTk4sIGFuZCByZXR1cm4gcHJvYmFiaWxpdHkgZGlzdHJpYnV0aW9ucyBvdmVyIGFsbCB0aGUgcG9zc2libGUgcmVzdWx0cyAoJDAkIHRvICQ5TiQpLgpUaGlzIGludm9sdmVzIHRyYWNraW5nIHRoZSBwcm9iYWJpbGl0aWVzIG9mIGluZGl2aWR1YWwgXHRleHRpdHtzeW1ib2xzfSAoaGVyZSwgZGlnaXRzIG9yIG51bWJlcnMpLCBjb21iaW5hdG9yaWFsbHkgZXZhbHVhdGluZyB0aGUgcmVzdWx0cyBvZiBjb21wbGV4IHN5bWJvbGljIGZ1bmN0aW9ucywgYW5kIGNhbGN1bGF0aW5nIHRoZSBwcm9iYWJpbGl0aWVzIG9mIGVhY2ggaW50ZXJtZWRpYXRlIHJlc3VsdCwgYWxsIHdoaWxlIHRyYWNraW5nIHRoZWlyIGdyYWRpZW50cyB0byBhbGxvdyBmb3IgYWNjdXJhdGUgYmFja3Byb3BhZ2F0aW9uIHdoaWxlIG9wdGltaXppbmcgdGhlIHRyYWluaW5nIG9iamVjdGl2ZS4KVGhlIGJhdGNoZWQgbmF0dXJlIG9mIGRhdGEgaW4gbWFjaGluZSBsZWFybmluZyBmdXJ0aGVyIGNvbXBsaWNhdGVzIHRoZXNlIGNhbGN1bGF0aW9ucyBzaW5jZSB0aGUgcHJvYmFiaWxpdGllcyBvZiBzeW1ib2xzIGNhbiBiZSBkaWZmZXJlbnQgYWNyb3NzIHNhbXBsZXMgd2l0aGluIHRoZSBzYW1lIGJhdGNoLgpBcyBhIHJlc3VsdCwgd3JpdGluZyBuZXVyb3N5bWJvbGljIHByb2dyYW1zIGluIG5hdGl2ZSBQeVRvcmNoIGlzIHRlZGlvdXMgZXZlbiBmb3Igc2ltcGxlIHRhc2tzLgoKVG8gYWRkcmVzcyB0aGVzZSBpc3N1ZXMsIFx0b29se30gcHJvdmlkZXMgcHJpbWl0aXZlcyB0aGF0IGFsbG93IHByb2dyYW1tZXJzIHRvIGV4cHJlc3Mgc3ltYm9saWMgcHJvZ3JhbXMgd2l0aG91dCB3b3JyeWluZyBhYm91dCB0aGUgdW5kZXJseWluZyBjb21wdXRhdGlvbnMuCkxpbmVzIDEzIGFuZCAxNSBvZiBGaWd1cmV+XHJlZntmaWc6bW5pc3Rfc3VtX25fY29kZX0gc2hvdyBob3cgdGhlIENOTidzIG91dHB1dCBjYW4gYmUgY2FwdHVyZWQgd2l0aGluIFxjb2Rle0Rpc3RyaWJ1dGlvbn0gb2JqZWN0cy4KRWFjaCBcY29kZXtEaXN0cmlidXRpb259IGFzc29jaWF0ZXMgdGhlIFxjb2Rle2RpZ2l0c30gd2l0aCB0aGUgY29ycmVzcG9uZGluZyBiYXRjaGVkIGxvZ2l0cyBwcm9kdWNlZCBieSB0aGUgQ05OLCBhbG9uZyB3aXRoIGFueSBncmFkaWVudHMgYW5kIGFzc29jaWF0ZWQgbWV0YWRhdGEuCkZpZ3VyZX5ccmVme2ZpZzptbmlzdF9zdW1fYnJlYWtkb3dufSBzaG93cyB0aGUgaW50ZXJuYWwgc3RydWN0dXJlIG9mIHRoZXNlIG9iamVjdHMuCgpUaGUgcHJvZ3JhbW1lciBjYW4gbm93IGV4cHJlc3MgdGhlIHN5bWJvbGljIHByb2dyYW0gaW4gdGVybXMgb2Ygb3BlcmF0aW9ucyB0aGF0IG1hbmlwdWxhdGUgXGNvZGV7RGlzdHJpYnV0aW9uc30uCkZvciBpbnN0YW5jZSwgaW4gbGluZSAxNiwgdGhlIFxjb2Rle2FwcGx5fSBmdW5jdGlvbiBpcyB1c2VkIHRvIHBlcmZvcm0gYW4gb3BlcmF0aW9uIG9uIHR3byBkaXN0cmlidXRpb25zLgpIZXJlLCB0aGUgXGNvZGV7YXBwbHl9IGZ1bmN0aW9uIHRha2VzIHR3byBcY29kZXtEaXN0cmlidXRpb259cyBhcyBhcmd1bWVudHMsIGFsb25nIHdpdGggYSBsYW1iZGEgZnVuY3Rpb24gdGhhdCBzcGVjaWZpZXMgdGhlIGFkZGl0aW9uIG9wZXJhdGlvbi4KVW5kZXIgdGhlIGhvb2QsIFxjb2Rle2FwcGx5fSBjb21iaW5hdG9yaWFsbHkgZXhwbG9yZXMgYWxsIHRoZSBwb3NzaWJsZSBzdW1zIG9mIHRoZSBzeW1ib2xzIGZyb20gXGNvZGV7RFxfcmVzfSBhbmQgXGNvZGV7RFxfaX0gYW5kIGNhbGN1bGF0ZXMgdGhlaXIgYXNzb2NpYXRlZCBwcm9iYWJpbGl0aWVzIHVzaW5nIGFuIGFwcHJvcHJpYXRlIHByb3ZlbmFuY2UuClRoZSByZXN1bHQgb2YgXGNvZGV7YXBwbHl9IGlzIGEgbmV3IFxjb2Rle0Rpc3RyaWJ1dGlvbn0gb3ZlciB0aGUgY2FsY3VsYXRlZCBzdW1zLCBhbmQgaXMgc3RvcmVkIGJhY2sgaW50byBcY29kZXtEXF9yZXN9LgpUaGlzIGlzIHJlcGVhdGVkIGl0ZXJhdGl2ZWx5IHVudGlsIGFsbCB0aGUgb3V0cHV0cyBvZiB0aGUgQ05OIGFyZSBzdW1tZWQgYXBwcm9wcmlhdGVseS4KT25jZSB0aGUgZmluYWwgXGNvZGV7RGlzdHJpYnV0aW9ufSBpcyBjYWxjdWxhdGVkLCBpdCBpcyBzaW1wbHkgYSBtYXR0ZXIgb2YgZ2V0dGluZyBpdHMgbG9naXRzIHdoaWNoIGNhbiBiZSB1c2VkIHRvIGNhbGN1bGF0ZSB0aGUgbG9zcyBvZiB0aGUgcHJlZGljdGlvbnMuCgpcYmVnaW57ZmlndXJlfVt0XQogICAgXGNlbnRlcmluZwogICAgXGJlZ2lue3N1YmZpZ3VyZX1bYl17MC4zNVx0ZXh0d2lkdGh9CiAgICAgICAgXGNlbnRlcmluZwogICAgICAgIFxpbmNsdWRlZ3JhcGhpY3Nbc2NhbGU9MC4zNV17ZmlndXJlcy9tbmlzdF9ncmFwaC5wbmd9CiAgICAgICAgXGNhcHRpb257TU5JU1QgU3VtLU4ufQogICAgICAgIFxsYWJlbHtmaWc6bW5pc3RfZ3JhcGh9CiAgICAgICAgXHZzcGFjZXstMC4wNWlufQogICAgXGVuZHtzdWJmaWd1cmV9CiAgICBcaGZpbGwKICAgIFxiZWdpbntzdWJmaWd1cmV9W2JdezAuNjRcdGV4dHdpZHRofQogICAgICAgIFxjZW50ZXJpbmcKICAgICAgICBcaW5jbHVkZWdyYXBoaWNzW3NjYWxlPTAuMzVde2ZpZ3VyZXMvcGF0aF9ncmFwaC5wbmd9CiAgICAgICAgXGNhcHRpb257UGF0aEZpbmRlci59CiAgICAgICAgXGxhYmVse2ZpZzpwYXRoX2dyYXBofQogICAgICAgIFx2c3BhY2V7LTAuMDVpbn0KICAgIFxlbmR7c3ViZmlndXJlfQogICAgXGNhcHRpb257Q29tcHV0YXRpb24gZ3JhcGhzIGZvciBuZXVyb3N5bWJvbGljIHByb2dyYW1zIHdyaXR0ZW4gdXNpbmcgXHRvb2x7fS59CiAgICBcbGFiZWx7ZmlnOmNvbXB1dGF0aW9uX2dyYXBoc30KICAgIFx2c3BhY2V7LTAuMTVpbn0KXGVuZHtmaWd1cmV9CgpcdG9vbHt9IHByb3ZpZGVzIGFkZGl0aW9uYWwgcHJpbWl0aXZlcyB0byBzdXBwb3J0IG1vcmUgY29tcGxleCBzeW1ib2xpYyBwcm9ncmFtcy4KRmlndXJlflxyZWZ7ZmlnOnBhdGhfZ3JhcGh9LCBmb3IgaW5zdGFuY2UsIHNob3dzIHRoZSBjb21wdXRhdGlvbiBncmFwaCBmb3IgdGhlIFBhdGhGaW5kZXIgdGFzayBcY2l0ZXB7dGF5MjAyMGxvbmd9LCB3aGljaCBpbnZvbHZlcyByZWN1cnNpdmVseSBidWlsZGluZyBwYXRocyB0byBpZGVudGlmeSBpZiB0d28gcG9pbnRzIGluIGEgbWF6ZSBhcmUgY29ubmVjdGVkLgpUaGUgXGNvZGV7dW5pb259IHByaW1pdGl2ZSBpcyB1c2VkIHRvIHN1cHBvcnQgdGhlIHJlY3Vyc2l2ZSBuYXR1cmUgb2YgdGhpcyBwcm9ncmFtLgpBcyB3aXRoIFxjb2Rle2FwcGx5fSwgXHRvb2x7fSBtYXBzIHRoZSBzeW1ib2xpYyBvcGVyYXRpb25zIGRlbm90ZWQgd2l0aGluIHRoZXNlIHByaW1pdGl2ZXMgdG8gcHJvYmFiaWxpdHkgY29tcHV0YXRpb25zLgpHaXZlbiB0aGF0IFxjb2Rle0Rpc3RyaWJ1dGlvbn0gb2JqZWN0cyBhc3NvY2lhdGUgc3ltYm9scyB3aXRoIHRoZSBiYXRjaGVkIGxvZ2l0cyB0aGVtc2VsdmVzLCB0aGVzZSBjb21wdXRhdGlvbnMgYXJlIHZlY3Rvcml6ZWQgYW5kIGRpcmVjdGx5IG9wZXJhdGUgb3ZlciBQeVRvcmNoIHRlbnNvcnMuClRoaXMgZGVlcCBpbnRlZ3JhdGlvbiBvZiBcdG9vbHt9IGludG8gUHlUb3JjaCBhbGxvd3MgcHJvZ3JhbW1lcnMgdG8gd3JpdGUgc3ltYm9saWMgcHJvZ3JhbXMgYXMgXHRleHRpdHtzeW1ib2xpYyBsYXllcnN9IHRoYXQgaW50ZXJhY3Qgd2l0aCBzdGFuZGFyZCBQeVRvcmNoIG5ldXJhbCBsYXllcnMgd2l0aGluIGEgbmV1cm9zeW1ib2xpYyBtb2RlbC4KRnVydGhlcm1vcmUsIFx0b29se30gY2FuIGxldmVyYWdlIHRoZSBoYXJkd2FyZSBhY2NlbGVyYXRpb24gc3VwcG9ydGVkIGJ5IFB5VG9yY2ggdG8gc2NhbGUgdG8gbGFyZ2UgYW5kIGNvbXBsZXggcHJvZ3JhbXMuClRoaXMgaXMgaW4gY29udHJhc3QgdG8gc3lzdGVtcyBsaWtlIFNjYWxsb3AgXGNpdGVwe2xpMjAyM3NjYWxsb3B9LCB3aGVyZSB0ZW5zb3JzIGFyZSBjb252ZXJ0ZWQgaW50byBTY2FsbG9wLWZyaWVuZGx5IHRhZ3MgdGhhdCBhcmUgdHJhbnNmZXJyZWQgdG8gYSBwcm9jZXNzIG91dHNpZGUgdGhlIFB5dGhvbiBlbnZpcm9ubWVudCwgYW5kIHdoZXJlIHRoZSBwcm9iYWJpbGl0eSBjb21wdXRhdGlvbnMgYXJlIENQVS1ib3VuZCwgcmVzdHJpY3RpbmcgaXRzIHNjYWxhYmlsaXR5LgoKCgoK">⬇</a></div>
<div class="ltx_listingline" id="lstnumberx1">
<span class="ltx_tag ltx_tag_listingline">1</span><span class="ltx_text ltx_lst_keyword ltx_font_typewriter" id="lstnumberx1.1" style="color:#9400D1;">class</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx1.2"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx1.3">MNISTNet</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx1.4">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx1.5">nn</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx1.6">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx1.7">Module</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx1.8">):</span>
</div>
<div class="ltx_listingline" id="lstnumberx2">
<span class="ltx_tag ltx_tag_listingline">2</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx2.1"> </span><span class="ltx_text ltx_lst_keyword ltx_font_typewriter" id="lstnumberx2.2" style="color:#9400D1;">def</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx2.3"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx2.4">__init__</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx2.5">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx2.6">self</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx2.7">):</span>
</div>
<div class="ltx_listingline" id="lstnumberx3">
<span class="ltx_tag ltx_tag_listingline">3</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx3.1"> </span><span class="ltx_text ltx_lst_keyword ltx_lst_keywords2 ltx_font_typewriter" id="lstnumberx3.2" style="color:#9400D1;">super</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx3.3">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx3.4">MNISTNet</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx3.5">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx3.6"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx3.7">self</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx3.8">).</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx3.9">__init__</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx3.10">()</span>
</div>
<div class="ltx_listingline" id="lstnumberx4">
<span class="ltx_tag ltx_tag_listingline">4</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx4.1"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx4.2">...</span>
</div>
<div class="ltx_listingline" id="lstnumberx5">
<span class="ltx_tag ltx_tag_listingline">5</span>
</div>
<div class="ltx_listingline" id="lstnumberx6">
<span class="ltx_tag ltx_tag_listingline">6</span><span class="ltx_text ltx_lst_keyword ltx_font_typewriter" id="lstnumberx6.1" style="color:#9400D1;">class</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx6.2"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx6.3">SumNNet</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx6.4">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx6.5">nn</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx6.6">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx6.7">Module</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx6.8">):</span>
</div>
<div class="ltx_listingline" id="lstnumberx7">
<span class="ltx_tag ltx_tag_listingline">7</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx7.1"> </span><span class="ltx_text ltx_lst_keyword ltx_font_typewriter" id="lstnumberx7.2" style="color:#9400D1;">def</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx7.3"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx7.4">__init__</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx7.5">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx7.6">self</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx7.7">):</span>
</div>
<div class="ltx_listingline" id="lstnumberx8">
<span class="ltx_tag ltx_tag_listingline">8</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx8.1"> </span><span class="ltx_text ltx_lst_keyword ltx_lst_keywords2 ltx_font_typewriter" id="lstnumberx8.2" style="color:#9400D1;">super</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx8.3">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx8.4">SumNNet</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx8.5">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx8.6"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx8.7">self</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx8.8">).</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx8.9">__init__</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx8.10">()</span>
</div>
<div class="ltx_listingline" id="lstnumberx9">
<span class="ltx_tag ltx_tag_listingline">9</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx9.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx9.2">self</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx9.3">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx9.4">CNN</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx9.5"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx9.6">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx9.7"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx9.8">MNISTNet</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx9.9">()</span>
</div>
<div class="ltx_listingline" id="lstnumberx10">
<span class="ltx_tag ltx_tag_listingline">10</span>
</div>
<div class="ltx_listingline" id="lstnumberx11">
<span class="ltx_tag ltx_tag_listingline">11</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx11.1"> </span><span class="ltx_text ltx_lst_keyword ltx_font_typewriter" id="lstnumberx11.2" style="color:#9400D1;">def</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx11.3"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx11.4">forward</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx11.5">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx11.6">self</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx11.7">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx11.8"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx11.9">imgs</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx11.10">):</span>
</div>
<div class="ltx_listingline" id="lstnumberx12">
<span class="ltx_tag ltx_tag_listingline">12</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx12.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx12.2">digits</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx12.3"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx12.4">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx12.5"> </span><span class="ltx_text ltx_lst_keyword ltx_lst_keywords2 ltx_font_typewriter" id="lstnumberx12.6" style="color:#9400D1;">range</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx12.7">(10)</span>
</div>
<div class="ltx_listingline" id="lstnumberx13">
<span class="ltx_tag ltx_tag_listingline">13</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx13.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx13.2">D_res</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx13.3"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx13.4">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx13.5"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx13.6">Distribution</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx13.7">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx13.8">self</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx13.9">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx13.10">CNN</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx13.11">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx13.12">imgs</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx13.13">[0]),</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx13.14"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx13.15">digits</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx13.16">)</span>
</div>
<div class="ltx_listingline" id="lstnumberx14">
<span class="ltx_tag ltx_tag_listingline">14</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx14.1"> </span><span class="ltx_text ltx_lst_keyword ltx_font_typewriter" id="lstnumberx14.2" style="color:#9400D1;">for</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx14.3"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx14.4">i</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx14.5"> </span><span class="ltx_text ltx_lst_keyword ltx_font_typewriter" id="lstnumberx14.6" style="color:#9400D1;">in</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx14.7"> </span><span class="ltx_text ltx_lst_keyword ltx_lst_keywords2 ltx_font_typewriter" id="lstnumberx14.8" style="color:#9400D1;">range</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx14.9">(1,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx14.10"> </span><span class="ltx_text ltx_lst_keyword ltx_lst_keywords2 ltx_font_typewriter" id="lstnumberx14.11" style="color:#9400D1;">len</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx14.12">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx14.13">imgs</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx14.14">)):</span>
</div>
<div class="ltx_listingline" id="lstnumberx15">
<span class="ltx_tag ltx_tag_listingline">15</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx15.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx15.2">D_i</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx15.3"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx15.4">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx15.5"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx15.6">Distribution</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx15.7">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx15.8">self</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx15.9">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx15.10">CNN</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx15.11">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx15.12">imgs</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx15.13">[</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx15.14">i</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx15.15">]),</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx15.16"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx15.17">digits</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx15.18">)</span>
</div>
<div class="ltx_listingline" id="lstnumberx16">
<span class="ltx_tag ltx_tag_listingline">16</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx16.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx16.2">D_res</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx16.3"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx16.4">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx16.5"> </span><span class="ltx_text ltx_lst_keyword ltx_lst_keywords2 ltx_font_typewriter" id="lstnumberx16.6" style="color:#9400D1;">apply</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx16.7">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx16.8">D_res</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx16.9">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx16.10"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx16.11">D_i</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx16.12">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx16.13"> </span><span class="ltx_text ltx_lst_keyword ltx_font_typewriter" id="lstnumberx16.14" style="color:#9400D1;">lambda</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx16.15"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx16.16">x</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx16.17">,</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx16.18">y</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx16.19">:</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx16.20"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx16.21">x</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx16.22"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx16.23">+</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx16.24"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx16.25">y</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx16.26">)</span>
</div>
<div class="ltx_listingline" id="lstnumberx17">
<span class="ltx_tag ltx_tag_listingline">17</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx17.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx17.2">l_res</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx17.3"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx17.4">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx17.5"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx17.6">get_logits</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx17.7">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx17.8">D_res</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx17.9">)</span>
</div>
<div class="ltx_listingline" id="lstnumberx18">
<span class="ltx_tag ltx_tag_listingline">18</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx18.1"> </span><span class="ltx_text ltx_lst_keyword ltx_font_typewriter" id="lstnumberx18.2" style="color:#9400D1;">return</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx18.3"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx18.4">l_res</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx18.5">\</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx18.6">end</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx18.7">{</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx18.8">lstlisting</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx18.9">}</span>
</div>
<div class="ltx_listingline" id="lstnumberx19">
<span class="ltx_tag ltx_tag_listingline">19</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx19.1"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx19.2">\</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx19.3">caption</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx19.4">{</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx19.5">Code</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx19.6"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx19.7">using</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx19.8"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx19.9">\</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx19.10">tool</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx19.11">{}</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx19.12"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx19.13">primitives</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx19.14"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx19.15">with</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx19.16"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx19.17">PyTorch</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx19.18">.}</span>
</div>
<div class="ltx_listingline" id="lstnumberx20">
<span class="ltx_tag ltx_tag_listingline">20</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx20.1"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx20.2">\</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx20.3">label</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx20.4">{</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx20.5">fig</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx20.6">:</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx20.7">mnist_sum_n_code</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx20.8">}</span>
</div>
<div class="ltx_listingline" id="lstnumberx21">
<span class="ltx_tag ltx_tag_listingline">21</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx21.1"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx21.2">\</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx21.3">end</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx21.4">{</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx21.5">subfigure</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx21.6">}</span>
</div>
<div class="ltx_listingline" id="lstnumberx22">
<span class="ltx_tag ltx_tag_listingline">22</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx22.1"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx22.2">\</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx22.3">hfill</span>
</div>
<div class="ltx_listingline" id="lstnumberx23">
<span class="ltx_tag ltx_tag_listingline">23</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx23.1"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx23.2">\</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx23.3">begin</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx23.4">{</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx23.5">subfigure</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx23.6">}{0.43\</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx23.7">textwidth</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx23.8">}</span>
</div>
<div class="ltx_listingline" id="lstnumberx24">
<span class="ltx_tag ltx_tag_listingline">24</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx24.1"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx24.2">\</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx24.3">vspace</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx24.4">{-0.05</span><span class="ltx_text ltx_lst_keyword ltx_font_typewriter" id="lstnumberx24.5" style="color:#9400D1;">in</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx24.6">}</span>
</div>
<div class="ltx_listingline" id="lstnumberx25">
<span class="ltx_tag ltx_tag_listingline">25</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx25.1"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx25.2">\</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx25.3">centering</span>
</div>
<div class="ltx_listingline" id="lstnumberx26">
<span class="ltx_tag ltx_tag_listingline">26</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx26.1"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx26.2">\</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx26.3">includegraphics</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx26.4">[</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx26.5">width</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx26.6">=0.6\</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx26.7">textwidth</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx26.8">]{</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx26.9">figures</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx26.10">/</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx26.11">flow</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx26.12">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx26.13">png</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx26.14">}</span>
</div>
<div class="ltx_listingline" id="lstnumberx27">
<span class="ltx_tag ltx_tag_listingline">27</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx27.1"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx27.2">\</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx27.3">caption</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx27.4">{</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx27.5">Components</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx27.6"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx27.7">of</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx27.8"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx27.9">the</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx27.10"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx27.11">\</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx27.12">code</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx27.13">{</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx27.14">SumNNet</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx27.15">}</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx27.16"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx27.17">model</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx27.18">.}</span>
</div>
<div class="ltx_listingline" id="lstnumberx28">
<span class="ltx_tag ltx_tag_listingline">28</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx28.1"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx28.2">\</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx28.3">label</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx28.4">{</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx28.5">fig</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx28.6">:</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx28.7">mnist_sum_breakdown</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx28.8">}</span>
</div>
<div class="ltx_listingline" id="lstnumberx29">
<span class="ltx_tag ltx_tag_listingline">29</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx29.1"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx29.2">\</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx29.3">end</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx29.4">{</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx29.5">subfigure</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx29.6">}</span>
</div>
<div class="ltx_listingline" id="lstnumberx30">
<span class="ltx_tag ltx_tag_listingline">30</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx30.1"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx30.2">\</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx30.3">caption</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx30.4">{</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx30.5">A</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx30.6"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx30.7">neurosymbolic</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx30.8"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx30.9">program</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx30.10"> </span><span class="ltx_text ltx_lst_keyword ltx_font_typewriter" id="lstnumberx30.11" style="color:#9400D1;">for</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx30.12"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx30.13">the</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx30.14"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx30.15">MNIST</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx30.16"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx30.17">Sum</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx30.18">-</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx30.19">N</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx30.20"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx30.21">task</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx30.22"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx30.23">written</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx30.24"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx30.25">using</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx30.26"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx30.27">\</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx30.28">tool</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx30.29">{}.}</span>
</div>
<div class="ltx_listingline" id="lstnumberx31">
<span class="ltx_tag ltx_tag_listingline">31</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx31.1"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx31.2">\</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx31.3">vspace</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx31.4">{-0.1</span><span class="ltx_text ltx_lst_keyword ltx_font_typewriter" id="lstnumberx31.5" style="color:#9400D1;">in</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx31.6">}</span>
</div>
<div class="ltx_listingline" id="lstnumberx32">
<span class="ltx_tag ltx_tag_listingline">32</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx32.1"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx32.2">\</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx32.3">label</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx32.4">{</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx32.5">fig</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx32.6">:</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx32.7">mnist_sum_n_example</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx32.8">}</span>
</div>
<div class="ltx_listingline" id="lstnumberx33">
<span class="ltx_tag ltx_tag_listingline">33</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx33.1">\</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx33.2">end</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx33.3">{</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx33.4">figure</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx33.5">}</span>
</div>
<div class="ltx_listingline" id="lstnumberx34">
<span class="ltx_tag ltx_tag_listingline">34</span>
</div>
<div class="ltx_listingline" id="lstnumberx35">
<span class="ltx_tag ltx_tag_listingline">35</span>
</div>
<div class="ltx_listingline" id="lstnumberx36">
<span class="ltx_tag ltx_tag_listingline">36</span>
</div>
<div class="ltx_listingline" id="lstnumberx37">
<span class="ltx_tag ltx_tag_listingline">37</span>
</div>
<div class="ltx_listingline" id="lstnumberx38">
<span class="ltx_tag ltx_tag_listingline">38</span>
</div>
<div class="ltx_listingline" id="lstnumberx39">
<span class="ltx_tag ltx_tag_listingline">39</span>
</div>
<div class="ltx_listingline" id="lstnumberx40">
<span class="ltx_tag ltx_tag_listingline">40</span>
</div>
<div class="ltx_listingline" id="lstnumberx41">
<span class="ltx_tag ltx_tag_listingline">41</span>
</div>
<div class="ltx_listingline" id="lstnumberx42">
<span class="ltx_tag ltx_tag_listingline">42</span>
</div>
<div class="ltx_listingline" id="lstnumberx43">
<span class="ltx_tag ltx_tag_listingline">43</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx43.1">Figure</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx43.2">~\</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx43.3">ref</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx43.4">{</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx43.5">fig</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx43.6">:</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx43.7">mnist_sum_n_code</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx43.8">}</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx43.9"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx43.10">shows</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx43.11"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx43.12">the</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx43.13"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx43.14">code</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx43.15"> </span><span class="ltx_text ltx_lst_keyword ltx_font_typewriter" id="lstnumberx43.16" style="color:#9400D1;">for</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx43.17"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx43.18">this</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx43.19"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx43.20">task</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx43.21"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx43.22">using</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx43.23"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx43.24">\</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx43.25">tool</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx43.26">{}</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx43.27"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx43.28">with</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx43.29"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx43.30">PyTorch</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx43.31">.</span>
</div>
<div class="ltx_listingline" id="lstnumberx44">
<span class="ltx_tag ltx_tag_listingline">44</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx44.1">The</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx44.2"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx44.3">neural</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx44.4"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx44.5">module</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx44.6"> </span><span class="ltx_text ltx_lst_keyword ltx_font_typewriter" id="lstnumberx44.7" style="color:#9400D1;">is</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx44.8"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx44.9">a</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx44.10"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx44.11">convolutional</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx44.12"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx44.13">neural</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx44.14"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx44.15">network</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx44.16"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx44.17">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx44.18">CNN</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx44.19">)</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx44.20"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx44.21">called</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx44.22"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx44.23">\</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx44.24">code</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx44.25">{</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx44.26">MNISTNet</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx44.27">}.</span>
</div>
<div class="ltx_listingline" id="lstnumberx45">
<span class="ltx_tag ltx_tag_listingline">45</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx45.1">It</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx45.2"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx45.3">takes</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx45.4"> </span><span class="ltx_text ltx_lst_keyword ltx_font_typewriter" id="lstnumberx45.5" style="color:#9400D1;">in</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx45.6"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx45.7">a</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx45.8"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx45.9">batch</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx45.10"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx45.11">of</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx45.12"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx45.13">image</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx45.14"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx45.15">tuples</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx45.16"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx45.17">\</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx45.18">code</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx45.19">{</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx45.20">imgs</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx45.21">}</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx45.22"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx45.23">where</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx45.24"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx45.25">each</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx45.26"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx45.27">sample</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx45.28"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx45.29">contains</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx45.30"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx45.31">$N$</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx45.32"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx45.33">MNIST</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx45.34"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx45.35">images</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx45.36">.</span>
</div>
<div class="ltx_listingline" id="lstnumberx46">
<span class="ltx_tag ltx_tag_listingline">46</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx46.1">\</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx46.2">code</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx46.3">{</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx46.4">MNISTNet</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx46.5">}</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx46.6"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx46.7">classifies</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx46.8"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx46.9">each</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx46.10"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx46.11">image</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx46.12"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx46.13">into</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx46.14"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx46.15">one</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx46.16"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx46.17">of</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx46.18"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx46.19">10</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx46.20"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx46.21">classes</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx46.22"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx46.23">representing</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx46.24"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx46.25">the</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx46.26"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx46.27">digits</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx46.28"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx46.29">0-9.</span>
</div>
<div class="ltx_listingline" id="lstnumberx47">
<span class="ltx_tag ltx_tag_listingline">47</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx47.1">The</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx47.2"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx47.3">logits</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx47.4"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx47.5">produced</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx47.6"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx47.7">by</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx47.8"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx47.9">\</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx47.10">code</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx47.11">{</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx47.12">MNISTNet</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx47.13">},</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx47.14"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx47.15">representing</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx47.16"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx47.17">probability</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx47.18"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx47.19">distributions</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx47.20"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx47.21">over</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx47.22"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx47.23">the</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx47.24"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx47.25">digits</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx47.26">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx47.27"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx47.28">are</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx47.29"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx47.30">then</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx47.31"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx47.32">passed</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx47.33"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx47.34">as</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx47.35"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx47.36">inputs</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx47.37"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx47.38">to</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx47.39"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx47.40">the</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx47.41"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx47.42">symbolic</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx47.43"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx47.44">program</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx47.45">.</span>
</div>
<div class="ltx_listingline" id="lstnumberx48">
<span class="ltx_tag ltx_tag_listingline">48</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx48.1">Lines</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx48.2"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx48.3">13-17</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx48.4"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx48.5">depict</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx48.6"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx48.7">a</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx48.8"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx48.9">symbolic</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx48.10"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx48.11">program</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx48.12"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx48.13">written</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx48.14"> </span><span class="ltx_text ltx_lst_keyword ltx_font_typewriter" id="lstnumberx48.15" style="color:#9400D1;">in</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx48.16"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx48.17">Python</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx48.18"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx48.19">using</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx48.20"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx48.21">\</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx48.22">tool</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx48.23">{}</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx48.24"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx48.25">primitives</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx48.26">.</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx48.27"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx48.28">%</span>
</div>
<div class="ltx_listingline" id="lstnumberx49">
<span class="ltx_tag ltx_tag_listingline">49</span>
</div>
<div class="ltx_listingline" id="lstnumberx50">
<span class="ltx_tag ltx_tag_listingline">50</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx50.1">In</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx50.2"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx50.3">order</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx50.4"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx50.5">to</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx50.6"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx50.7">support</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx50.8"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx50.9">training</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx50.10">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx50.11"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx50.12">the</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx50.13"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx50.14">symbolic</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx50.15"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx50.16">program</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx50.17"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx50.18">must</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx50.19"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx50.20">reason</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx50.21"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx50.22">over</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx50.23"> </span><span class="ltx_text ltx_lst_keyword ltx_lst_keywords2 ltx_font_typewriter" id="lstnumberx50.24" style="color:#9400D1;">all</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx50.25"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx50.26">the</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx50.27"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx50.28">outputs</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx50.29"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx50.30">of</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx50.31"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx50.32">the</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx50.33"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx50.34">CNN</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx50.35">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx50.36"> </span><span class="ltx_text ltx_lst_keyword ltx_font_typewriter" id="lstnumberx50.37" style="color:#9400D1;">and</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx50.38"> </span><span class="ltx_text ltx_lst_keyword ltx_font_typewriter" id="lstnumberx50.39" style="color:#9400D1;">return</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx50.40"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx50.41">probability</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx50.42"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx50.43">distributions</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx50.44"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx50.45">over</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx50.46"> </span><span class="ltx_text ltx_lst_keyword ltx_lst_keywords2 ltx_font_typewriter" id="lstnumberx50.47" style="color:#9400D1;">all</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx50.48"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx50.49">the</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx50.50"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx50.51">possible</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx50.52"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx50.53">results</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx50.54"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx50.55">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx50.56">$0$</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx50.57"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx50.58">to</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx50.59"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx50.60">$9N$</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx50.61">).</span>
</div>
<div class="ltx_listingline" id="lstnumberx51">
<span class="ltx_tag ltx_tag_listingline">51</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx51.1">This</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx51.2"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx51.3">involves</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx51.4"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx51.5">tracking</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx51.6"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx51.7">the</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx51.8"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx51.9">probabilities</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx51.10"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx51.11">of</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx51.12"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx51.13">individual</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx51.14"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx51.15">\</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx51.16">textit</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx51.17">{</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx51.18">symbols</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx51.19">}</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx51.20"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx51.21">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx51.22">here</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx51.23">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx51.24"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx51.25">digits</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx51.26"> </span><span class="ltx_text ltx_lst_keyword ltx_font_typewriter" id="lstnumberx51.27" style="color:#9400D1;">or</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx51.28"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx51.29">numbers</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx51.30">),</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx51.31"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx51.32">combinatorially</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx51.33"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx51.34">evaluating</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx51.35"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx51.36">the</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx51.37"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx51.38">results</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx51.39"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx51.40">of</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx51.41"> </span><span class="ltx_text ltx_lst_keyword ltx_lst_keywords2 ltx_font_typewriter" id="lstnumberx51.42" style="color:#9400D1;">complex</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx51.43"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx51.44">symbolic</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx51.45"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx51.46">functions</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx51.47">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx51.48"> </span><span class="ltx_text ltx_lst_keyword ltx_font_typewriter" id="lstnumberx51.49" style="color:#9400D1;">and</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx51.50"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx51.51">calculating</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx51.52"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx51.53">the</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx51.54"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx51.55">probabilities</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx51.56"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx51.57">of</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx51.58"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx51.59">each</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx51.60"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx51.61">intermediate</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx51.62"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx51.63">result</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx51.64">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx51.65"> </span><span class="ltx_text ltx_lst_keyword ltx_lst_keywords2 ltx_font_typewriter" id="lstnumberx51.66" style="color:#9400D1;">all</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx51.67"> </span><span class="ltx_text ltx_lst_keyword ltx_font_typewriter" id="lstnumberx51.68" style="color:#9400D1;">while</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx51.69"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx51.70">tracking</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx51.71"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx51.72">their</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx51.73"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx51.74">gradients</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx51.75"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx51.76">to</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx51.77"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx51.78">allow</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx51.79"> </span><span class="ltx_text ltx_lst_keyword ltx_font_typewriter" id="lstnumberx51.80" style="color:#9400D1;">for</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx51.81"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx51.82">accurate</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx51.83"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx51.84">backpropagation</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx51.85"> </span><span class="ltx_text ltx_lst_keyword ltx_font_typewriter" id="lstnumberx51.86" style="color:#9400D1;">while</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx51.87"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx51.88">optimizing</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx51.89"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx51.90">the</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx51.91"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx51.92">training</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx51.93"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx51.94">objective</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx51.95">.</span>
</div>
<div class="ltx_listingline" id="lstnumberx52">
<span class="ltx_tag ltx_tag_listingline">52</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx52.1">The</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx52.2"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx52.3">batched</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx52.4"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx52.5">nature</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx52.6"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx52.7">of</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx52.8"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx52.9">data</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx52.10"> </span><span class="ltx_text ltx_lst_keyword ltx_font_typewriter" id="lstnumberx52.11" style="color:#9400D1;">in</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx52.12"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx52.13">machine</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx52.14"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx52.15">learning</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx52.16"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx52.17">further</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx52.18"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx52.19">complicates</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx52.20"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx52.21">these</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx52.22"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx52.23">calculations</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx52.24"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx52.25">since</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx52.26"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx52.27">the</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx52.28"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx52.29">probabilities</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx52.30"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx52.31">of</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx52.32"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx52.33">symbols</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx52.34"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx52.35">can</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx52.36"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx52.37">be</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx52.38"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx52.39">different</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx52.40"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx52.41">across</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx52.42"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx52.43">samples</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx52.44"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx52.45">within</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx52.46"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx52.47">the</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx52.48"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx52.49">same</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx52.50"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx52.51">batch</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx52.52">.</span>
</div>
<div class="ltx_listingline" id="lstnumberx53">
<span class="ltx_tag ltx_tag_listingline">53</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx53.1">As</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx53.2"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx53.3">a</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx53.4"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx53.5">result</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx53.6">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx53.7"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx53.8">writing</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx53.9"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx53.10">neurosymbolic</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx53.11"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx53.12">programs</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx53.13"> </span><span class="ltx_text ltx_lst_keyword ltx_font_typewriter" id="lstnumberx53.14" style="color:#9400D1;">in</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx53.15"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx53.16">native</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx53.17"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx53.18">PyTorch</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx53.19"> </span><span class="ltx_text ltx_lst_keyword ltx_font_typewriter" id="lstnumberx53.20" style="color:#9400D1;">is</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx53.21"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx53.22">tedious</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx53.23"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx53.24">even</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx53.25"> </span><span class="ltx_text ltx_lst_keyword ltx_font_typewriter" id="lstnumberx53.26" style="color:#9400D1;">for</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx53.27"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx53.28">simple</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx53.29"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx53.30">tasks</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx53.31">.</span>
</div>
<div class="ltx_listingline" id="lstnumberx54">
<span class="ltx_tag ltx_tag_listingline">54</span>
</div>
<div class="ltx_listingline" id="lstnumberx55">
<span class="ltx_tag ltx_tag_listingline">55</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx55.1">To</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx55.2"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx55.3">address</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx55.4"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx55.5">these</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx55.6"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx55.7">issues</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx55.8">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx55.9"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx55.10">\</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx55.11">tool</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx55.12">{}</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx55.13"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx55.14">provides</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx55.15"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx55.16">primitives</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx55.17"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx55.18">that</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx55.19"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx55.20">allow</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx55.21"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx55.22">programmers</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx55.23"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx55.24">to</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx55.25"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx55.26">express</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx55.27"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx55.28">symbolic</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx55.29"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx55.30">programs</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx55.31"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx55.32">without</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx55.33"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx55.34">worrying</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx55.35"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx55.36">about</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx55.37"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx55.38">the</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx55.39"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx55.40">underlying</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx55.41"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx55.42">computations</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx55.43">.</span>
</div>
<div class="ltx_listingline" id="lstnumberx56">
<span class="ltx_tag ltx_tag_listingline">56</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx56.1">Lines</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx56.2"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx56.3">13</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx56.4"> </span><span class="ltx_text ltx_lst_keyword ltx_font_typewriter" id="lstnumberx56.5" style="color:#9400D1;">and</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx56.6"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx56.7">15</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx56.8"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx56.9">of</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx56.10"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx56.11">Figure</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx56.12">~\</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx56.13">ref</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx56.14">{</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx56.15">fig</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx56.16">:</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx56.17">mnist_sum_n_code</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx56.18">}</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx56.19"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx56.20">show</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx56.21"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx56.22">how</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx56.23"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx56.24">the</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx56.25"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx56.26">CNN</span><span class="ltx_text ltx_lst_string ltx_font_typewriter" id="lstnumberx56.27" style="color:#0000FF;">’s<span class="ltx_text ltx_lst_space" id="lstnumberx56.27.1"> </span>output<span class="ltx_text ltx_lst_space" id="lstnumberx56.27.2"> </span>can<span class="ltx_text ltx_lst_space" id="lstnumberx56.27.3"> </span>be<span class="ltx_text ltx_lst_space" id="lstnumberx56.27.4"> </span>captured<span class="ltx_text ltx_lst_space" id="lstnumberx56.27.5"> </span>within<span class="ltx_text ltx_lst_space" id="lstnumberx56.27.6"> </span>\code{Distribution}<span class="ltx_text ltx_lst_space" id="lstnumberx56.27.7"> </span>objects.</span>
</div>
<div class="ltx_listingline" id="lstnumberx57">
<span class="ltx_tag ltx_tag_listingline">57</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx57.1" style="color:#0000FF;">Each</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx57.2" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx57.3" style="color:#0000FF;">\code{Distribution}</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx57.4" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx57.5" style="color:#0000FF;">associates</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx57.6" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx57.7" style="color:#0000FF;">the</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx57.8" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx57.9" style="color:#0000FF;">\code{digits}</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx57.10" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx57.11" style="color:#0000FF;">with</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx57.12" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx57.13" style="color:#0000FF;">the</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx57.14" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx57.15" style="color:#0000FF;">corresponding</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx57.16" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx57.17" style="color:#0000FF;">batched</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx57.18" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx57.19" style="color:#0000FF;">logits</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx57.20" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx57.21" style="color:#0000FF;">produced</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx57.22" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx57.23" style="color:#0000FF;">by</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx57.24" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx57.25" style="color:#0000FF;">the</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx57.26" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx57.27" style="color:#0000FF;">CNN,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx57.28" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx57.29" style="color:#0000FF;">along</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx57.30" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx57.31" style="color:#0000FF;">with</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx57.32" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx57.33" style="color:#0000FF;">any</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx57.34" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx57.35" style="color:#0000FF;">gradients</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx57.36" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx57.37" style="color:#0000FF;">and</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx57.38" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx57.39" style="color:#0000FF;">associated</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx57.40" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx57.41" style="color:#0000FF;">metadata.</span>
</div>
<div class="ltx_listingline" id="lstnumberx58">
<span class="ltx_tag ltx_tag_listingline">58</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx58.1" style="color:#0000FF;">Figure~\ref{fig:mnist_sum_breakdown}</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx58.2" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx58.3" style="color:#0000FF;">shows</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx58.4" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx58.5" style="color:#0000FF;">the</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx58.6" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx58.7" style="color:#0000FF;">internal</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx58.8" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx58.9" style="color:#0000FF;">structure</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx58.10" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx58.11" style="color:#0000FF;">of</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx58.12" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx58.13" style="color:#0000FF;">these</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx58.14" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx58.15" style="color:#0000FF;">objects.</span>
</div>
<div class="ltx_listingline" id="lstnumberx59">
<span class="ltx_tag ltx_tag_listingline">59</span>
</div>
<div class="ltx_listingline" id="lstnumberx60">
<span class="ltx_tag ltx_tag_listingline">60</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx60.1" style="color:#0000FF;">The</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx60.2" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx60.3" style="color:#0000FF;">programmer</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx60.4" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx60.5" style="color:#0000FF;">can</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx60.6" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx60.7" style="color:#0000FF;">now</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx60.8" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx60.9" style="color:#0000FF;">express</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx60.10" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx60.11" style="color:#0000FF;">the</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx60.12" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx60.13" style="color:#0000FF;">symbolic</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx60.14" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx60.15" style="color:#0000FF;">program</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx60.16" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx60.17" style="color:#0000FF;">in</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx60.18" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx60.19" style="color:#0000FF;">terms</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx60.20" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx60.21" style="color:#0000FF;">of</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx60.22" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx60.23" style="color:#0000FF;">operations</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx60.24" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx60.25" style="color:#0000FF;">that</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx60.26" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx60.27" style="color:#0000FF;">manipulate</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx60.28" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx60.29" style="color:#0000FF;">\code{Distributions}.</span>
</div>
<div class="ltx_listingline" id="lstnumberx61">
<span class="ltx_tag ltx_tag_listingline">61</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx61.1" style="color:#0000FF;">For</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx61.2" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx61.3" style="color:#0000FF;">instance,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx61.4" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx61.5" style="color:#0000FF;">in</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx61.6" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx61.7" style="color:#0000FF;">line</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx61.8" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx61.9" style="color:#0000FF;">16,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx61.10" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx61.11" style="color:#0000FF;">the</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx61.12" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx61.13" style="color:#0000FF;">\code{apply}</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx61.14" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx61.15" style="color:#0000FF;">function</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx61.16" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx61.17" style="color:#0000FF;">is</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx61.18" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx61.19" style="color:#0000FF;">used</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx61.20" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx61.21" style="color:#0000FF;">to</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx61.22" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx61.23" style="color:#0000FF;">perform</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx61.24" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx61.25" style="color:#0000FF;">an</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx61.26" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx61.27" style="color:#0000FF;">operation</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx61.28" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx61.29" style="color:#0000FF;">on</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx61.30" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx61.31" style="color:#0000FF;">two</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx61.32" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx61.33" style="color:#0000FF;">distributions.</span>
</div>
<div class="ltx_listingline" id="lstnumberx62">
<span class="ltx_tag ltx_tag_listingline">62</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx62.1" style="color:#0000FF;">Here,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx62.2" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx62.3" style="color:#0000FF;">the</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx62.4" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx62.5" style="color:#0000FF;">\code{apply}</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx62.6" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx62.7" style="color:#0000FF;">function</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx62.8" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx62.9" style="color:#0000FF;">takes</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx62.10" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx62.11" style="color:#0000FF;">two</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx62.12" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx62.13" style="color:#0000FF;">\code{Distribution}s</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx62.14" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx62.15" style="color:#0000FF;">as</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx62.16" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx62.17" style="color:#0000FF;">arguments,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx62.18" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx62.19" style="color:#0000FF;">along</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx62.20" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx62.21" style="color:#0000FF;">with</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx62.22" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx62.23" style="color:#0000FF;">a</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx62.24" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx62.25" style="color:#0000FF;">lambda</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx62.26" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx62.27" style="color:#0000FF;">function</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx62.28" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx62.29" style="color:#0000FF;">that</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx62.30" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx62.31" style="color:#0000FF;">specifies</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx62.32" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx62.33" style="color:#0000FF;">the</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx62.34" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx62.35" style="color:#0000FF;">addition</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx62.36" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx62.37" style="color:#0000FF;">operation.</span>
</div>
<div class="ltx_listingline" id="lstnumberx63">
<span class="ltx_tag ltx_tag_listingline">63</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx63.1" style="color:#0000FF;">Under</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx63.2" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx63.3" style="color:#0000FF;">the</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx63.4" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx63.5" style="color:#0000FF;">hood,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx63.6" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx63.7" style="color:#0000FF;">\code{apply}</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx63.8" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx63.9" style="color:#0000FF;">combinatorially</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx63.10" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx63.11" style="color:#0000FF;">explores</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx63.12" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx63.13" style="color:#0000FF;">all</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx63.14" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx63.15" style="color:#0000FF;">the</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx63.16" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx63.17" style="color:#0000FF;">possible</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx63.18" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx63.19" style="color:#0000FF;">sums</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx63.20" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx63.21" style="color:#0000FF;">of</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx63.22" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx63.23" style="color:#0000FF;">the</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx63.24" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx63.25" style="color:#0000FF;">symbols</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx63.26" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx63.27" style="color:#0000FF;">from</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx63.28" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx63.29" style="color:#0000FF;">\code{D\_res}</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx63.30" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx63.31" style="color:#0000FF;">and</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx63.32" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx63.33" style="color:#0000FF;">\code{D\_i}</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx63.34" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx63.35" style="color:#0000FF;">and</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx63.36" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx63.37" style="color:#0000FF;">calculates</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx63.38" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx63.39" style="color:#0000FF;">their</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx63.40" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx63.41" style="color:#0000FF;">associated</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx63.42" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx63.43" style="color:#0000FF;">probabilities</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx63.44" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx63.45" style="color:#0000FF;">using</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx63.46" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx63.47" style="color:#0000FF;">an</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx63.48" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx63.49" style="color:#0000FF;">appropriate</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx63.50" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx63.51" style="color:#0000FF;">provenance.</span>
</div>
<div class="ltx_listingline" id="lstnumberx64">
<span class="ltx_tag ltx_tag_listingline">64</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx64.1" style="color:#0000FF;">The</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx64.2" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx64.3" style="color:#0000FF;">result</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx64.4" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx64.5" style="color:#0000FF;">of</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx64.6" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx64.7" style="color:#0000FF;">\code{apply}</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx64.8" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx64.9" style="color:#0000FF;">is</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx64.10" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx64.11" style="color:#0000FF;">a</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx64.12" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx64.13" style="color:#0000FF;">new</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx64.14" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx64.15" style="color:#0000FF;">\code{Distribution}</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx64.16" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx64.17" style="color:#0000FF;">over</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx64.18" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx64.19" style="color:#0000FF;">the</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx64.20" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx64.21" style="color:#0000FF;">calculated</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx64.22" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx64.23" style="color:#0000FF;">sums,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx64.24" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx64.25" style="color:#0000FF;">and</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx64.26" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx64.27" style="color:#0000FF;">is</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx64.28" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx64.29" style="color:#0000FF;">stored</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx64.30" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx64.31" style="color:#0000FF;">back</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx64.32" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx64.33" style="color:#0000FF;">into</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx64.34" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx64.35" style="color:#0000FF;">\code{D\_res}.</span>
</div>
<div class="ltx_listingline" id="lstnumberx65">
<span class="ltx_tag ltx_tag_listingline">65</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx65.1" style="color:#0000FF;">This</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx65.2" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx65.3" style="color:#0000FF;">is</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx65.4" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx65.5" style="color:#0000FF;">repeated</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx65.6" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx65.7" style="color:#0000FF;">iteratively</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx65.8" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx65.9" style="color:#0000FF;">until</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx65.10" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx65.11" style="color:#0000FF;">all</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx65.12" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx65.13" style="color:#0000FF;">the</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx65.14" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx65.15" style="color:#0000FF;">outputs</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx65.16" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx65.17" style="color:#0000FF;">of</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx65.18" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx65.19" style="color:#0000FF;">the</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx65.20" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx65.21" style="color:#0000FF;">CNN</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx65.22" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx65.23" style="color:#0000FF;">are</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx65.24" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx65.25" style="color:#0000FF;">summed</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx65.26" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx65.27" style="color:#0000FF;">appropriately.</span>
</div>
<div class="ltx_listingline" id="lstnumberx66">
<span class="ltx_tag ltx_tag_listingline">66</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx66.1" style="color:#0000FF;">Once</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx66.2" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx66.3" style="color:#0000FF;">the</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx66.4" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx66.5" style="color:#0000FF;">final</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx66.6" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx66.7" style="color:#0000FF;">\code{Distribution}</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx66.8" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx66.9" style="color:#0000FF;">is</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx66.10" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx66.11" style="color:#0000FF;">calculated,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx66.12" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx66.13" style="color:#0000FF;">it</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx66.14" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx66.15" style="color:#0000FF;">is</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx66.16" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx66.17" style="color:#0000FF;">simply</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx66.18" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx66.19" style="color:#0000FF;">a</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx66.20" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx66.21" style="color:#0000FF;">matter</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx66.22" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx66.23" style="color:#0000FF;">of</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx66.24" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx66.25" style="color:#0000FF;">getting</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx66.26" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx66.27" style="color:#0000FF;">its</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx66.28" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx66.29" style="color:#0000FF;">logits</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx66.30" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx66.31" style="color:#0000FF;">which</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx66.32" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx66.33" style="color:#0000FF;">can</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx66.34" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx66.35" style="color:#0000FF;">be</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx66.36" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx66.37" style="color:#0000FF;">used</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx66.38" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx66.39" style="color:#0000FF;">to</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx66.40" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx66.41" style="color:#0000FF;">calculate</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx66.42" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx66.43" style="color:#0000FF;">the</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx66.44" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx66.45" style="color:#0000FF;">loss</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx66.46" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx66.47" style="color:#0000FF;">of</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx66.48" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx66.49" style="color:#0000FF;">the</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx66.50" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx66.51" style="color:#0000FF;">predictions.</span>
</div>
<div class="ltx_listingline" id="lstnumberx67">
<span class="ltx_tag ltx_tag_listingline">67</span>
</div>
<div class="ltx_listingline" id="lstnumberx68">
<span class="ltx_tag ltx_tag_listingline">68</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx68.1" style="color:#0000FF;">\begin{figure}[t]</span>
</div>
<div class="ltx_listingline" id="lstnumberx69">
<span class="ltx_tag ltx_tag_listingline">69</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx69.1" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx69.2" style="color:#0000FF;">\centering</span>
</div>
<div class="ltx_listingline" id="lstnumberx70">
<span class="ltx_tag ltx_tag_listingline">70</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx70.1" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx70.2" style="color:#0000FF;">\begin{subfigure}[b]{0.35\textwidth}</span>
</div>
<div class="ltx_listingline" id="lstnumberx71">
<span class="ltx_tag ltx_tag_listingline">71</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx71.1" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx71.2" style="color:#0000FF;">\centering</span>
</div>
<div class="ltx_listingline" id="lstnumberx72">
<span class="ltx_tag ltx_tag_listingline">72</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx72.1" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx72.2" style="color:#0000FF;">\includegraphics[scale=0.35]{figures/mnist_graph.png}</span>
</div>
<div class="ltx_listingline" id="lstnumberx73">
<span class="ltx_tag ltx_tag_listingline">73</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx73.1" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx73.2" style="color:#0000FF;">\caption{MNIST</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx73.3" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx73.4" style="color:#0000FF;">Sum-N.}</span>
</div>
<div class="ltx_listingline" id="lstnumberx74">
<span class="ltx_tag ltx_tag_listingline">74</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx74.1" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx74.2" style="color:#0000FF;">\label{fig:mnist_graph}</span>
</div>
<div class="ltx_listingline" id="lstnumberx75">
<span class="ltx_tag ltx_tag_listingline">75</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx75.1" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx75.2" style="color:#0000FF;">\vspace{-0.05in}</span>
</div>
<div class="ltx_listingline" id="lstnumberx76">
<span class="ltx_tag ltx_tag_listingline">76</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx76.1" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx76.2" style="color:#0000FF;">\end{subfigure}</span>
</div>
<div class="ltx_listingline" id="lstnumberx77">
<span class="ltx_tag ltx_tag_listingline">77</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx77.1" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx77.2" style="color:#0000FF;">\hfill</span>
</div>
<div class="ltx_listingline" id="lstnumberx78">
<span class="ltx_tag ltx_tag_listingline">78</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx78.1" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx78.2" style="color:#0000FF;">\begin{subfigure}[b]{0.64\textwidth}</span>
</div>
<div class="ltx_listingline" id="lstnumberx79">
<span class="ltx_tag ltx_tag_listingline">79</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx79.1" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx79.2" style="color:#0000FF;">\centering</span>
</div>
<div class="ltx_listingline" id="lstnumberx80">
<span class="ltx_tag ltx_tag_listingline">80</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx80.1" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx80.2" style="color:#0000FF;">\includegraphics[scale=0.35]{figures/path_graph.png}</span>
</div>
<div class="ltx_listingline" id="lstnumberx81">
<span class="ltx_tag ltx_tag_listingline">81</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx81.1" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx81.2" style="color:#0000FF;">\caption{PathFinder.}</span>
</div>
<div class="ltx_listingline" id="lstnumberx82">
<span class="ltx_tag ltx_tag_listingline">82</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx82.1" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx82.2" style="color:#0000FF;">\label{fig:path_graph}</span>
</div>
<div class="ltx_listingline" id="lstnumberx83">
<span class="ltx_tag ltx_tag_listingline">83</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx83.1" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx83.2" style="color:#0000FF;">\vspace{-0.05in}</span>
</div>
<div class="ltx_listingline" id="lstnumberx84">
<span class="ltx_tag ltx_tag_listingline">84</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx84.1" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx84.2" style="color:#0000FF;">\end{subfigure}</span>
</div>
<div class="ltx_listingline" id="lstnumberx85">
<span class="ltx_tag ltx_tag_listingline">85</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx85.1" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx85.2" style="color:#0000FF;">\caption{Computation</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx85.3" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx85.4" style="color:#0000FF;">graphs</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx85.5" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx85.6" style="color:#0000FF;">for</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx85.7" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx85.8" style="color:#0000FF;">neurosymbolic</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx85.9" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx85.10" style="color:#0000FF;">programs</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx85.11" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx85.12" style="color:#0000FF;">written</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx85.13" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx85.14" style="color:#0000FF;">using</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx85.15" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx85.16" style="color:#0000FF;">\tool{}.}</span>
</div>
<div class="ltx_listingline" id="lstnumberx86">
<span class="ltx_tag ltx_tag_listingline">86</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx86.1" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx86.2" style="color:#0000FF;">\label{fig:computation_graphs}</span>
</div>
<div class="ltx_listingline" id="lstnumberx87">
<span class="ltx_tag ltx_tag_listingline">87</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx87.1" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx87.2" style="color:#0000FF;">\vspace{-0.15in}</span>
</div>
<div class="ltx_listingline" id="lstnumberx88">
<span class="ltx_tag ltx_tag_listingline">88</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx88.1" style="color:#0000FF;">\end{figure}</span>
</div>
<div class="ltx_listingline" id="lstnumberx89">
<span class="ltx_tag ltx_tag_listingline">89</span>
</div>
<div class="ltx_listingline" id="lstnumberx90">
<span class="ltx_tag ltx_tag_listingline">90</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx90.1" style="color:#0000FF;">\tool{}</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx90.2" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx90.3" style="color:#0000FF;">provides</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx90.4" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx90.5" style="color:#0000FF;">additional</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx90.6" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx90.7" style="color:#0000FF;">primitives</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx90.8" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx90.9" style="color:#0000FF;">to</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx90.10" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx90.11" style="color:#0000FF;">support</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx90.12" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx90.13" style="color:#0000FF;">more</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx90.14" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx90.15" style="color:#0000FF;">complex</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx90.16" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx90.17" style="color:#0000FF;">symbolic</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx90.18" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx90.19" style="color:#0000FF;">programs.</span>
</div>
<div class="ltx_listingline" id="lstnumberx91">
<span class="ltx_tag ltx_tag_listingline">91</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx91.1" style="color:#0000FF;">Figure~\ref{fig:path_graph},</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx91.2" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx91.3" style="color:#0000FF;">for</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx91.4" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx91.5" style="color:#0000FF;">instance,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx91.6" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx91.7" style="color:#0000FF;">shows</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx91.8" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx91.9" style="color:#0000FF;">the</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx91.10" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx91.11" style="color:#0000FF;">computation</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx91.12" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx91.13" style="color:#0000FF;">graph</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx91.14" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx91.15" style="color:#0000FF;">for</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx91.16" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx91.17" style="color:#0000FF;">the</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx91.18" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx91.19" style="color:#0000FF;">PathFinder</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx91.20" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx91.21" style="color:#0000FF;">task</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx91.22" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx91.23" style="color:#0000FF;">\citep{tay2020long},</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx91.24" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx91.25" style="color:#0000FF;">which</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx91.26" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx91.27" style="color:#0000FF;">involves</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx91.28" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx91.29" style="color:#0000FF;">recursively</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx91.30" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx91.31" style="color:#0000FF;">building</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx91.32" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx91.33" style="color:#0000FF;">paths</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx91.34" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx91.35" style="color:#0000FF;">to</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx91.36" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx91.37" style="color:#0000FF;">identify</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx91.38" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx91.39" style="color:#0000FF;">if</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx91.40" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx91.41" style="color:#0000FF;">two</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx91.42" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx91.43" style="color:#0000FF;">points</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx91.44" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx91.45" style="color:#0000FF;">in</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx91.46" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx91.47" style="color:#0000FF;">a</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx91.48" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx91.49" style="color:#0000FF;">maze</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx91.50" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx91.51" style="color:#0000FF;">are</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx91.52" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx91.53" style="color:#0000FF;">connected.</span>
</div>
<div class="ltx_listingline" id="lstnumberx92">
<span class="ltx_tag ltx_tag_listingline">92</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx92.1" style="color:#0000FF;">The</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx92.2" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx92.3" style="color:#0000FF;">\code{union}</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx92.4" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx92.5" style="color:#0000FF;">primitive</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx92.6" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx92.7" style="color:#0000FF;">is</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx92.8" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx92.9" style="color:#0000FF;">used</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx92.10" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx92.11" style="color:#0000FF;">to</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx92.12" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx92.13" style="color:#0000FF;">support</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx92.14" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx92.15" style="color:#0000FF;">the</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx92.16" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx92.17" style="color:#0000FF;">recursive</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx92.18" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx92.19" style="color:#0000FF;">nature</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx92.20" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx92.21" style="color:#0000FF;">of</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx92.22" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx92.23" style="color:#0000FF;">this</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx92.24" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx92.25" style="color:#0000FF;">program.</span>
</div>
<div class="ltx_listingline" id="lstnumberx93">
<span class="ltx_tag ltx_tag_listingline">93</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx93.1" style="color:#0000FF;">As</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx93.2" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx93.3" style="color:#0000FF;">with</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx93.4" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx93.5" style="color:#0000FF;">\code{apply},</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx93.6" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx93.7" style="color:#0000FF;">\tool{}</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx93.8" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx93.9" style="color:#0000FF;">maps</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx93.10" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx93.11" style="color:#0000FF;">the</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx93.12" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx93.13" style="color:#0000FF;">symbolic</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx93.14" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx93.15" style="color:#0000FF;">operations</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx93.16" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx93.17" style="color:#0000FF;">denoted</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx93.18" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx93.19" style="color:#0000FF;">within</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx93.20" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx93.21" style="color:#0000FF;">these</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx93.22" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx93.23" style="color:#0000FF;">primitives</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx93.24" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx93.25" style="color:#0000FF;">to</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx93.26" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx93.27" style="color:#0000FF;">probability</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx93.28" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx93.29" style="color:#0000FF;">computations.</span>
</div>
<div class="ltx_listingline" id="lstnumberx94">
<span class="ltx_tag ltx_tag_listingline">94</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx94.1" style="color:#0000FF;">Given</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx94.2" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx94.3" style="color:#0000FF;">that</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx94.4" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx94.5" style="color:#0000FF;">\code{Distribution}</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx94.6" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx94.7" style="color:#0000FF;">objects</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx94.8" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx94.9" style="color:#0000FF;">associate</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx94.10" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx94.11" style="color:#0000FF;">symbols</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx94.12" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx94.13" style="color:#0000FF;">with</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx94.14" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx94.15" style="color:#0000FF;">the</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx94.16" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx94.17" style="color:#0000FF;">batched</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx94.18" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx94.19" style="color:#0000FF;">logits</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx94.20" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx94.21" style="color:#0000FF;">themselves,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx94.22" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx94.23" style="color:#0000FF;">these</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx94.24" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx94.25" style="color:#0000FF;">computations</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx94.26" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx94.27" style="color:#0000FF;">are</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx94.28" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx94.29" style="color:#0000FF;">vectorized</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx94.30" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx94.31" style="color:#0000FF;">and</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx94.32" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx94.33" style="color:#0000FF;">directly</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx94.34" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx94.35" style="color:#0000FF;">operate</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx94.36" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx94.37" style="color:#0000FF;">over</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx94.38" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx94.39" style="color:#0000FF;">PyTorch</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx94.40" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx94.41" style="color:#0000FF;">tensors.</span>
</div>
<div class="ltx_listingline" id="lstnumberx95">
<span class="ltx_tag ltx_tag_listingline">95</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx95.1" style="color:#0000FF;">This</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx95.2" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx95.3" style="color:#0000FF;">deep</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx95.4" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx95.5" style="color:#0000FF;">integration</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx95.6" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx95.7" style="color:#0000FF;">of</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx95.8" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx95.9" style="color:#0000FF;">\tool{}</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx95.10" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx95.11" style="color:#0000FF;">into</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx95.12" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx95.13" style="color:#0000FF;">PyTorch</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx95.14" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx95.15" style="color:#0000FF;">allows</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx95.16" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx95.17" style="color:#0000FF;">programmers</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx95.18" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx95.19" style="color:#0000FF;">to</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx95.20" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx95.21" style="color:#0000FF;">write</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx95.22" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx95.23" style="color:#0000FF;">symbolic</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx95.24" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx95.25" style="color:#0000FF;">programs</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx95.26" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx95.27" style="color:#0000FF;">as</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx95.28" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx95.29" style="color:#0000FF;">\textit{symbolic</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx95.30" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx95.31" style="color:#0000FF;">layers}</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx95.32" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx95.33" style="color:#0000FF;">that</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx95.34" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx95.35" style="color:#0000FF;">interact</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx95.36" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx95.37" style="color:#0000FF;">with</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx95.38" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx95.39" style="color:#0000FF;">standard</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx95.40" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx95.41" style="color:#0000FF;">PyTorch</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx95.42" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx95.43" style="color:#0000FF;">neural</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx95.44" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx95.45" style="color:#0000FF;">layers</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx95.46" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx95.47" style="color:#0000FF;">within</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx95.48" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx95.49" style="color:#0000FF;">a</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx95.50" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx95.51" style="color:#0000FF;">neurosymbolic</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx95.52" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx95.53" style="color:#0000FF;">model.</span>
</div>
<div class="ltx_listingline" id="lstnumberx96">
<span class="ltx_tag ltx_tag_listingline">96</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx96.1" style="color:#0000FF;">Furthermore,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx96.2" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx96.3" style="color:#0000FF;">\tool{}</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx96.4" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx96.5" style="color:#0000FF;">can</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx96.6" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx96.7" style="color:#0000FF;">leverage</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx96.8" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx96.9" style="color:#0000FF;">the</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx96.10" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx96.11" style="color:#0000FF;">hardware</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx96.12" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx96.13" style="color:#0000FF;">acceleration</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx96.14" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx96.15" style="color:#0000FF;">supported</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx96.16" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx96.17" style="color:#0000FF;">by</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx96.18" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx96.19" style="color:#0000FF;">PyTorch</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx96.20" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx96.21" style="color:#0000FF;">to</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx96.22" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx96.23" style="color:#0000FF;">scale</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx96.24" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx96.25" style="color:#0000FF;">to</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx96.26" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx96.27" style="color:#0000FF;">large</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx96.28" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx96.29" style="color:#0000FF;">and</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx96.30" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx96.31" style="color:#0000FF;">complex</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx96.32" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx96.33" style="color:#0000FF;">programs.</span>
</div>
<div class="ltx_listingline" id="lstnumberx97">
<span class="ltx_tag ltx_tag_listingline">97</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx97.1" style="color:#0000FF;">This</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx97.2" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx97.3" style="color:#0000FF;">is</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx97.4" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx97.5" style="color:#0000FF;">in</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx97.6" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx97.7" style="color:#0000FF;">contrast</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx97.8" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx97.9" style="color:#0000FF;">to</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx97.10" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx97.11" style="color:#0000FF;">systems</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx97.12" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx97.13" style="color:#0000FF;">like</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx97.14" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx97.15" style="color:#0000FF;">Scallop</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx97.16" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx97.17" style="color:#0000FF;">\citep{li2023scallop},</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx97.18" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx97.19" style="color:#0000FF;">where</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx97.20" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx97.21" style="color:#0000FF;">tensors</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx97.22" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx97.23" style="color:#0000FF;">are</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx97.24" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx97.25" style="color:#0000FF;">converted</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx97.26" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx97.27" style="color:#0000FF;">into</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx97.28" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx97.29" style="color:#0000FF;">Scallop-friendly</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx97.30" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx97.31" style="color:#0000FF;">tags</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx97.32" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx97.33" style="color:#0000FF;">that</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx97.34" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx97.35" style="color:#0000FF;">are</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx97.36" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx97.37" style="color:#0000FF;">transferred</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx97.38" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx97.39" style="color:#0000FF;">to</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx97.40" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx97.41" style="color:#0000FF;">a</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx97.42" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx97.43" style="color:#0000FF;">process</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx97.44" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx97.45" style="color:#0000FF;">outside</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx97.46" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx97.47" style="color:#0000FF;">the</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx97.48" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx97.49" style="color:#0000FF;">Python</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx97.50" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx97.51" style="color:#0000FF;">environment,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx97.52" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx97.53" style="color:#0000FF;">and</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx97.54" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx97.55" style="color:#0000FF;">where</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx97.56" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx97.57" style="color:#0000FF;">the</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx97.58" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx97.59" style="color:#0000FF;">probability</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx97.60" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx97.61" style="color:#0000FF;">computations</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx97.62" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx97.63" style="color:#0000FF;">are</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx97.64" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx97.65" style="color:#0000FF;">CPU-bound,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx97.66" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx97.67" style="color:#0000FF;">restricting</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx97.68" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx97.69" style="color:#0000FF;">its</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx97.70" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx97.71" style="color:#0000FF;">scalability.’</span>
</div>
</div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<section class="ltx_section ltx_figure_panel" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>The <span class="ltx_text ltx_font_smallcaps" id="S3.1.1">Dolphin</span> Framework</h2>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span><span class="ltx_text ltx_font_smallcaps" id="S3.SS1.1.1">Dolphin</span> Core Design Principles</h3>
<div class="ltx_para ltx_noindent" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.1">We based <span class="ltx_text ltx_font_smallcaps" id="S3.SS1.p1.1.1">Dolphin</span>’s framework design on the following core principles:</p>
<ul class="ltx_itemize" id="S3.I1">
<li class="ltx_item" id="S3.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S3.I1.i1.p1">
<p class="ltx_p" id="S3.I1.i1.p1.1"><span class="ltx_text ltx_font_bold" id="S3.I1.i1.p1.1.1">Flexible programmability:</span> The framework should allow developers to write neurosymbolic applications in Python with minimal effort, providing intuitive primitives that seamlessly integrate with Python’s rich and expressive language features.</p>
</div>
</li>
<li class="ltx_item" id="S3.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S3.I1.i2.p1">
<p class="ltx_p" id="S3.I1.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S3.I1.i2.p1.1.1">End-to-end differentiability on GPUs:</span> The framework should allow any neurosymbolic program to be end-to-end differentiable on GPUs irrespective of the task characteristics.</p>
</div>
</li>
<li class="ltx_item" id="S3.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S3.I1.i3.p1">
<p class="ltx_p" id="S3.I1.i3.p1.1"><span class="ltx_text ltx_font_bold" id="S3.I1.i3.p1.1.1">Scalable:</span> The framework should easily scale with greater problem and data complexity.</p>
</div>
</li>
<li class="ltx_item" id="S3.I1.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para ltx_noindent" id="S3.I1.i4.p1">
<p class="ltx_p" id="S3.I1.i4.p1.1"><span class="ltx_text ltx_font_bold" id="S3.I1.i4.p1.1.1">Tunable:</span> Similar to hyperparameters in deep learning, the framework should provide a simple interface for developers to choose provenances (and their configurations) or define new ones.</p>
</div>
</li>
</ul>
<p class="ltx_p" id="S3.SS1.p1.2">Next, we show how we realize these principles by describing the key components of <span class="ltx_text ltx_font_smallcaps" id="S3.SS1.p1.2.1">Dolphin</span>.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>The <span class="ltx_text ltx_font_smallcaps" id="S3.SS2.1.1">Dolphin</span> Syntax</h3>
<div class="ltx_para ltx_noindent" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.1"><span class="ltx_text ltx_font_smallcaps" id="S3.SS2.p1.1.1">Dolphin</span> provides a programming interface that developers can use to express symbolic programs in a Pythonic manner.
<span class="ltx_text ltx_font_smallcaps" id="S3.SS2.p1.1.2">Dolphin</span> maps each operation of the symbolic program to PyTorch which enables end-to-end GPU-accelerated differentiable reasoning.
Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03348v1#S3.F3" title="Figure 3 ‣ 3.2 The Dolphin Syntax ‣ 3 The Dolphin Framework ‣ 2 Overview ‣ Dolphin: A Programmable Framework for Scalable Neurosymbolic Learning"><span class="ltx_text ltx_ref_tag">3</span></a> presents <span class="ltx_text ltx_font_smallcaps" id="S3.SS2.p1.1.3">Dolphin</span>’s programming interface including the symbolic abstractions and operations over them.</p>
</div>
<figure class="ltx_figure" id="S3.F3">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel" id="S3.F3.fig1">
<table class="ltx_equation ltx_eqn_table" id="S3.Ex1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\begin{array}[]{rcrl}\text{Symbol}&amp;::&amp;s&amp;\in\ \ S\ \ \text{ ({objects})}\\
\text{Tag}&amp;::&amp;t&amp;\in\ \ T\ \ \text{ ({tensors})}\\
\text{Distribution}&amp;::&amp;D&amp;\in\ \ \mathbb{D}=S\rightarrow T\end{array}" class="ltx_Math" display="block" id="S3.Ex1.m1.8"><semantics id="S3.Ex1.m1.8a"><mtable columnspacing="5pt" displaystyle="true" id="S3.Ex1.m1.8.8" rowspacing="0pt" xref="S3.Ex1.m1.8.8.cmml"><mtr id="S3.Ex1.m1.8.8a" xref="S3.Ex1.m1.8.8.cmml"><mtd class="ltx_align_right" columnalign="right" id="S3.Ex1.m1.8.8b" xref="S3.Ex1.m1.8.8.cmml"><mtext id="S3.Ex1.m1.3.3.3.4.1" xref="S3.Ex1.m1.3.3.3.4.1a.cmml">Symbol</mtext></mtd><mtd id="S3.Ex1.m1.8.8c" xref="S3.Ex1.m1.8.8.cmml"><mrow id="S3.Ex1.m1.3.3.3.5.1" xref="S3.Ex1.m1.3.3.3.5.1.cmml"><mi id="S3.Ex1.m1.3.3.3.5.1.2" xref="S3.Ex1.m1.3.3.3.5.1.2.cmml"></mi><mo id="S3.Ex1.m1.3.3.3.5.1.1" lspace="0.278em" rspace="0em" xref="S3.Ex1.m1.3.3.3.5.1.1.cmml">:</mo><mo id="S3.Ex1.m1.3.3.3.5.1.3" xref="S3.Ex1.m1.3.3.3.5.1.3.cmml">:</mo></mrow></mtd><mtd class="ltx_align_right" columnalign="right" id="S3.Ex1.m1.8.8d" xref="S3.Ex1.m1.8.8.cmml"><mi id="S3.Ex1.m1.3.3.3.6.1" xref="S3.Ex1.m1.3.3.3.6.1.cmml">s</mi></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.Ex1.m1.8.8e" xref="S3.Ex1.m1.8.8.cmml"><mrow id="S3.Ex1.m1.3.3.3.3.3.5" xref="S3.Ex1.m1.3.3.3.3.3.4.cmml"><mo id="S3.Ex1.m1.1.1.1.1.1.1" xref="S3.Ex1.m1.1.1.1.1.1.1.cmml">∈</mo><mspace id="S3.Ex1.m1.3.3.3.3.3.5.1" width="1em" xref="S3.Ex1.m1.3.3.3.3.3.4.cmml"></mspace><mi id="S3.Ex1.m1.2.2.2.2.2.2" xref="S3.Ex1.m1.2.2.2.2.2.2.cmml">S</mi><mspace id="S3.Ex1.m1.3.3.3.3.3.5.2" width="1em" xref="S3.Ex1.m1.3.3.3.3.3.4.cmml"></mspace><mrow id="S3.Ex1.m1.3.3.3.3.3.3" xref="S3.Ex1.m1.3.3.3.3.3.3d.cmml"><mtext id="S3.Ex1.m1.3.3.3.3.3.3a" xref="S3.Ex1.m1.3.3.3.3.3.3d.cmml"> (</mtext><mtext class="ltx_mathvariant_monospace" id="S3.Ex1.m1.3.3.3.3.3.3b" xref="S3.Ex1.m1.3.3.3.3.3.3d.cmml">objects</mtext><mtext id="S3.Ex1.m1.3.3.3.3.3.3c" xref="S3.Ex1.m1.3.3.3.3.3.3d.cmml">)</mtext></mrow></mrow></mtd></mtr><mtr id="S3.Ex1.m1.8.8f" xref="S3.Ex1.m1.8.8.cmml"><mtd class="ltx_align_right" columnalign="right" id="S3.Ex1.m1.8.8g" xref="S3.Ex1.m1.8.8.cmml"><mtext id="S3.Ex1.m1.6.6.6.4.1" xref="S3.Ex1.m1.6.6.6.4.1a.cmml">Tag</mtext></mtd><mtd id="S3.Ex1.m1.8.8h" xref="S3.Ex1.m1.8.8.cmml"><mrow id="S3.Ex1.m1.6.6.6.5.1" xref="S3.Ex1.m1.6.6.6.5.1.cmml"><mi id="S3.Ex1.m1.6.6.6.5.1.2" xref="S3.Ex1.m1.6.6.6.5.1.2.cmml"></mi><mo id="S3.Ex1.m1.6.6.6.5.1.1" lspace="0.278em" rspace="0em" xref="S3.Ex1.m1.6.6.6.5.1.1.cmml">:</mo><mo id="S3.Ex1.m1.6.6.6.5.1.3" xref="S3.Ex1.m1.6.6.6.5.1.3.cmml">:</mo></mrow></mtd><mtd class="ltx_align_right" columnalign="right" id="S3.Ex1.m1.8.8i" xref="S3.Ex1.m1.8.8.cmml"><mi id="S3.Ex1.m1.6.6.6.6.1" xref="S3.Ex1.m1.6.6.6.6.1.cmml">t</mi></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.Ex1.m1.8.8j" xref="S3.Ex1.m1.8.8.cmml"><mrow id="S3.Ex1.m1.6.6.6.3.3.5" xref="S3.Ex1.m1.6.6.6.3.3.4.cmml"><mo id="S3.Ex1.m1.4.4.4.1.1.1" xref="S3.Ex1.m1.4.4.4.1.1.1.cmml">∈</mo><mspace id="S3.Ex1.m1.6.6.6.3.3.5.1" width="1em" xref="S3.Ex1.m1.6.6.6.3.3.4.cmml"></mspace><mi id="S3.Ex1.m1.5.5.5.2.2.2" xref="S3.Ex1.m1.5.5.5.2.2.2.cmml">T</mi><mspace id="S3.Ex1.m1.6.6.6.3.3.5.2" width="1em" xref="S3.Ex1.m1.6.6.6.3.3.4.cmml"></mspace><mrow id="S3.Ex1.m1.6.6.6.3.3.3" xref="S3.Ex1.m1.6.6.6.3.3.3d.cmml"><mtext id="S3.Ex1.m1.6.6.6.3.3.3a" xref="S3.Ex1.m1.6.6.6.3.3.3d.cmml"> (</mtext><mtext class="ltx_mathvariant_monospace" id="S3.Ex1.m1.6.6.6.3.3.3b" xref="S3.Ex1.m1.6.6.6.3.3.3d.cmml">tensors</mtext><mtext id="S3.Ex1.m1.6.6.6.3.3.3c" xref="S3.Ex1.m1.6.6.6.3.3.3d.cmml">)</mtext></mrow></mrow></mtd></mtr><mtr id="S3.Ex1.m1.8.8k" xref="S3.Ex1.m1.8.8.cmml"><mtd class="ltx_align_right" columnalign="right" id="S3.Ex1.m1.8.8l" xref="S3.Ex1.m1.8.8.cmml"><mtext id="S3.Ex1.m1.8.8.8.3.1" xref="S3.Ex1.m1.8.8.8.3.1a.cmml">Distribution</mtext></mtd><mtd id="S3.Ex1.m1.8.8m" xref="S3.Ex1.m1.8.8.cmml"><mrow id="S3.Ex1.m1.8.8.8.4.1" xref="S3.Ex1.m1.8.8.8.4.1.cmml"><mi id="S3.Ex1.m1.8.8.8.4.1.2" xref="S3.Ex1.m1.8.8.8.4.1.2.cmml"></mi><mo id="S3.Ex1.m1.8.8.8.4.1.1" lspace="0.278em" rspace="0em" xref="S3.Ex1.m1.8.8.8.4.1.1.cmml">:</mo><mo id="S3.Ex1.m1.8.8.8.4.1.3" xref="S3.Ex1.m1.8.8.8.4.1.3.cmml">:</mo></mrow></mtd><mtd class="ltx_align_right" columnalign="right" id="S3.Ex1.m1.8.8n" xref="S3.Ex1.m1.8.8.cmml"><mi id="S3.Ex1.m1.8.8.8.5.1" xref="S3.Ex1.m1.8.8.8.5.1.cmml">D</mi></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.Ex1.m1.8.8o" xref="S3.Ex1.m1.8.8.cmml"><mrow id="S3.Ex1.m1.8.8.8.2.2" xref="S3.Ex1.m1.8.8.8.2.2.cmml"><mrow id="S3.Ex1.m1.8.8.8.2.2.4.2" xref="S3.Ex1.m1.8.8.8.2.2.4.1.cmml"><mo id="S3.Ex1.m1.7.7.7.1.1.1" xref="S3.Ex1.m1.7.7.7.1.1.1.cmml">∈</mo><mspace id="S3.Ex1.m1.8.8.8.2.2.4.2.1" width="1em" xref="S3.Ex1.m1.8.8.8.2.2.4.1.cmml"></mspace><mi id="S3.Ex1.m1.8.8.8.2.2.2" xref="S3.Ex1.m1.8.8.8.2.2.2.cmml">𝔻</mi></mrow><mo id="S3.Ex1.m1.8.8.8.2.2.5" xref="S3.Ex1.m1.8.8.8.2.2.5.cmml">=</mo><mi id="S3.Ex1.m1.8.8.8.2.2.6" xref="S3.Ex1.m1.8.8.8.2.2.6.cmml">S</mi><mo id="S3.Ex1.m1.8.8.8.2.2.7" stretchy="false" xref="S3.Ex1.m1.8.8.8.2.2.7.cmml">→</mo><mi id="S3.Ex1.m1.8.8.8.2.2.8" xref="S3.Ex1.m1.8.8.8.2.2.8.cmml">T</mi></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S3.Ex1.m1.8b"><matrix id="S3.Ex1.m1.8.8.cmml" xref="S3.Ex1.m1.8.8"><matrixrow id="S3.Ex1.m1.8.8a.cmml" xref="S3.Ex1.m1.8.8"><ci id="S3.Ex1.m1.3.3.3.4.1a.cmml" xref="S3.Ex1.m1.3.3.3.4.1"><mtext id="S3.Ex1.m1.3.3.3.4.1.cmml" xref="S3.Ex1.m1.3.3.3.4.1">Symbol</mtext></ci><apply id="S3.Ex1.m1.3.3.3.5.1.cmml" xref="S3.Ex1.m1.3.3.3.5.1"><ci id="S3.Ex1.m1.3.3.3.5.1.1.cmml" xref="S3.Ex1.m1.3.3.3.5.1.1">:</ci><csymbol cd="latexml" id="S3.Ex1.m1.3.3.3.5.1.2.cmml" xref="S3.Ex1.m1.3.3.3.5.1.2">absent</csymbol><ci id="S3.Ex1.m1.3.3.3.5.1.3.cmml" xref="S3.Ex1.m1.3.3.3.5.1.3">:</ci></apply><ci id="S3.Ex1.m1.3.3.3.6.1.cmml" xref="S3.Ex1.m1.3.3.3.6.1">𝑠</ci><list id="S3.Ex1.m1.3.3.3.3.3.4.cmml" xref="S3.Ex1.m1.3.3.3.3.3.5"><in id="S3.Ex1.m1.1.1.1.1.1.1.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1"></in><ci id="S3.Ex1.m1.2.2.2.2.2.2.cmml" xref="S3.Ex1.m1.2.2.2.2.2.2">𝑆</ci><ci id="S3.Ex1.m1.3.3.3.3.3.3d.cmml" xref="S3.Ex1.m1.3.3.3.3.3.3"><mrow id="S3.Ex1.m1.3.3.3.3.3.3.cmml" xref="S3.Ex1.m1.3.3.3.3.3.3"><mtext id="S3.Ex1.m1.3.3.3.3.3.3a.cmml" xref="S3.Ex1.m1.3.3.3.3.3.3"> (</mtext><mtext class="ltx_mathvariant_monospace" id="S3.Ex1.m1.3.3.3.3.3.3b.cmml" xref="S3.Ex1.m1.3.3.3.3.3.3">objects</mtext><mtext id="S3.Ex1.m1.3.3.3.3.3.3c.cmml" xref="S3.Ex1.m1.3.3.3.3.3.3">)</mtext></mrow></ci></list></matrixrow><matrixrow id="S3.Ex1.m1.8.8b.cmml" xref="S3.Ex1.m1.8.8"><ci id="S3.Ex1.m1.6.6.6.4.1a.cmml" xref="S3.Ex1.m1.6.6.6.4.1"><mtext id="S3.Ex1.m1.6.6.6.4.1.cmml" xref="S3.Ex1.m1.6.6.6.4.1">Tag</mtext></ci><apply id="S3.Ex1.m1.6.6.6.5.1.cmml" xref="S3.Ex1.m1.6.6.6.5.1"><ci id="S3.Ex1.m1.6.6.6.5.1.1.cmml" xref="S3.Ex1.m1.6.6.6.5.1.1">:</ci><csymbol cd="latexml" id="S3.Ex1.m1.6.6.6.5.1.2.cmml" xref="S3.Ex1.m1.6.6.6.5.1.2">absent</csymbol><ci id="S3.Ex1.m1.6.6.6.5.1.3.cmml" xref="S3.Ex1.m1.6.6.6.5.1.3">:</ci></apply><ci id="S3.Ex1.m1.6.6.6.6.1.cmml" xref="S3.Ex1.m1.6.6.6.6.1">𝑡</ci><list id="S3.Ex1.m1.6.6.6.3.3.4.cmml" xref="S3.Ex1.m1.6.6.6.3.3.5"><in id="S3.Ex1.m1.4.4.4.1.1.1.cmml" xref="S3.Ex1.m1.4.4.4.1.1.1"></in><ci id="S3.Ex1.m1.5.5.5.2.2.2.cmml" xref="S3.Ex1.m1.5.5.5.2.2.2">𝑇</ci><ci id="S3.Ex1.m1.6.6.6.3.3.3d.cmml" xref="S3.Ex1.m1.6.6.6.3.3.3"><mrow id="S3.Ex1.m1.6.6.6.3.3.3.cmml" xref="S3.Ex1.m1.6.6.6.3.3.3"><mtext id="S3.Ex1.m1.6.6.6.3.3.3a.cmml" xref="S3.Ex1.m1.6.6.6.3.3.3"> (</mtext><mtext class="ltx_mathvariant_monospace" id="S3.Ex1.m1.6.6.6.3.3.3b.cmml" xref="S3.Ex1.m1.6.6.6.3.3.3">tensors</mtext><mtext id="S3.Ex1.m1.6.6.6.3.3.3c.cmml" xref="S3.Ex1.m1.6.6.6.3.3.3">)</mtext></mrow></ci></list></matrixrow><matrixrow id="S3.Ex1.m1.8.8c.cmml" xref="S3.Ex1.m1.8.8"><ci id="S3.Ex1.m1.8.8.8.3.1a.cmml" xref="S3.Ex1.m1.8.8.8.3.1"><mtext id="S3.Ex1.m1.8.8.8.3.1.cmml" xref="S3.Ex1.m1.8.8.8.3.1">Distribution</mtext></ci><apply id="S3.Ex1.m1.8.8.8.4.1.cmml" xref="S3.Ex1.m1.8.8.8.4.1"><ci id="S3.Ex1.m1.8.8.8.4.1.1.cmml" xref="S3.Ex1.m1.8.8.8.4.1.1">:</ci><csymbol cd="latexml" id="S3.Ex1.m1.8.8.8.4.1.2.cmml" xref="S3.Ex1.m1.8.8.8.4.1.2">absent</csymbol><ci id="S3.Ex1.m1.8.8.8.4.1.3.cmml" xref="S3.Ex1.m1.8.8.8.4.1.3">:</ci></apply><ci id="S3.Ex1.m1.8.8.8.5.1.cmml" xref="S3.Ex1.m1.8.8.8.5.1">𝐷</ci><apply id="S3.Ex1.m1.8.8.8.2.2.cmml" xref="S3.Ex1.m1.8.8.8.2.2"><and id="S3.Ex1.m1.8.8.8.2.2a.cmml" xref="S3.Ex1.m1.8.8.8.2.2"></and><apply id="S3.Ex1.m1.8.8.8.2.2b.cmml" xref="S3.Ex1.m1.8.8.8.2.2"><eq id="S3.Ex1.m1.8.8.8.2.2.5.cmml" xref="S3.Ex1.m1.8.8.8.2.2.5"></eq><list id="S3.Ex1.m1.8.8.8.2.2.4.1.cmml" xref="S3.Ex1.m1.8.8.8.2.2.4.2"><in id="S3.Ex1.m1.7.7.7.1.1.1.cmml" xref="S3.Ex1.m1.7.7.7.1.1.1"></in><ci id="S3.Ex1.m1.8.8.8.2.2.2.cmml" xref="S3.Ex1.m1.8.8.8.2.2.2">𝔻</ci></list><ci id="S3.Ex1.m1.8.8.8.2.2.6.cmml" xref="S3.Ex1.m1.8.8.8.2.2.6">𝑆</ci></apply><apply id="S3.Ex1.m1.8.8.8.2.2c.cmml" xref="S3.Ex1.m1.8.8.8.2.2"><ci id="S3.Ex1.m1.8.8.8.2.2.7.cmml" xref="S3.Ex1.m1.8.8.8.2.2.7">→</ci><share href="https://arxiv.org/html/2410.03348v1#S3.Ex1.m1.8.8.8.2.2.6.cmml" id="S3.Ex1.m1.8.8.8.2.2d.cmml" xref="S3.Ex1.m1.8.8.8.2.2"></share><ci id="S3.Ex1.m1.8.8.8.2.2.8.cmml" xref="S3.Ex1.m1.8.8.8.2.2.8">𝑇</ci></apply></apply></matrixrow></matrix></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex1.m1.8c">\begin{array}[]{rcrl}\text{Symbol}&amp;::&amp;s&amp;\in\ \ S\ \ \text{ ({objects})}\\
\text{Tag}&amp;::&amp;t&amp;\in\ \ T\ \ \text{ ({tensors})}\\
\text{Distribution}&amp;::&amp;D&amp;\in\ \ \mathbb{D}=S\rightarrow T\end{array}</annotation><annotation encoding="application/x-llamapun" id="S3.Ex1.m1.8d">start_ARRAY start_ROW start_CELL Symbol end_CELL start_CELL : : end_CELL start_CELL italic_s end_CELL start_CELL ∈ italic_S ( typewriter_objects ) end_CELL end_ROW start_ROW start_CELL Tag end_CELL start_CELL : : end_CELL start_CELL italic_t end_CELL start_CELL ∈ italic_T ( typewriter_tensors ) end_CELL end_ROW start_ROW start_CELL Distribution end_CELL start_CELL : : end_CELL start_CELL italic_D end_CELL start_CELL ∈ blackboard_D = italic_S → italic_T end_CELL end_ROW end_ARRAY</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel" id="S3.F3.fig2">
<table class="ltx_equation ltx_eqn_table" id="S3.Ex2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\begin{array}[]{rcl}\textsc{Apply}&amp;:&amp;\mathbb{D}^{K}\times(S^{K}\rightarrow S)%
\rightarrow\mathbb{D}\\
\textsc{Filter}&amp;:&amp;\mathbb{D}\times(S\rightarrow\mathbb{B})\rightarrow\mathbb{D%
}\\
\textsc{ApplyIf}&amp;:&amp;\mathbb{D}^{K}\times(S^{K}\rightarrow S)\times(S^{K}%
\rightarrow\mathbb{B})\rightarrow\mathbb{D}\\
\textsc{Union}&amp;:&amp;\mathbb{D}\times\mathbb{D}\rightarrow\mathbb{D}\\
\textsc{GetProbs}&amp;:&amp;\mathbb{D}\rightarrow[0,1]^{N}\end{array}" class="ltx_Math" display="block" id="S3.Ex2.m1.6"><semantics id="S3.Ex2.m1.6a"><mtable columnspacing="5pt" displaystyle="true" id="S3.Ex2.m1.6.6" rowspacing="0pt" xref="S3.Ex2.m1.6.6.cmml"><mtr id="S3.Ex2.m1.6.6a" xref="S3.Ex2.m1.6.6.cmml"><mtd class="ltx_align_right" columnalign="right" id="S3.Ex2.m1.6.6b" xref="S3.Ex2.m1.6.6.cmml"><mtext class="ltx_font_smallcaps" id="S3.Ex2.m1.1.1.1.2.1" xref="S3.Ex2.m1.1.1.1.2.1a.cmml">Apply</mtext></mtd><mtd id="S3.Ex2.m1.6.6c" xref="S3.Ex2.m1.6.6.cmml"><mo id="S3.Ex2.m1.1.1.1.3.1" xref="S3.Ex2.m1.1.1.1.3.1.cmml">:</mo></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.Ex2.m1.6.6d" xref="S3.Ex2.m1.6.6.cmml"><mrow id="S3.Ex2.m1.1.1.1.1.1" xref="S3.Ex2.m1.1.1.1.1.1.cmml"><mrow id="S3.Ex2.m1.1.1.1.1.1.1" xref="S3.Ex2.m1.1.1.1.1.1.1.cmml"><msup id="S3.Ex2.m1.1.1.1.1.1.1.3" xref="S3.Ex2.m1.1.1.1.1.1.1.3.cmml"><mi id="S3.Ex2.m1.1.1.1.1.1.1.3.2" xref="S3.Ex2.m1.1.1.1.1.1.1.3.2.cmml">𝔻</mi><mi id="S3.Ex2.m1.1.1.1.1.1.1.3.3" xref="S3.Ex2.m1.1.1.1.1.1.1.3.3.cmml">K</mi></msup><mo id="S3.Ex2.m1.1.1.1.1.1.1.2" lspace="0.222em" rspace="0.222em" xref="S3.Ex2.m1.1.1.1.1.1.1.2.cmml">×</mo><mrow id="S3.Ex2.m1.1.1.1.1.1.1.1.1" xref="S3.Ex2.m1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.Ex2.m1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.Ex2.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.Ex2.m1.1.1.1.1.1.1.1.1.1" xref="S3.Ex2.m1.1.1.1.1.1.1.1.1.1.cmml"><msup id="S3.Ex2.m1.1.1.1.1.1.1.1.1.1.2" xref="S3.Ex2.m1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.Ex2.m1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.Ex2.m1.1.1.1.1.1.1.1.1.1.2.2.cmml">S</mi><mi id="S3.Ex2.m1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.Ex2.m1.1.1.1.1.1.1.1.1.1.2.3.cmml">K</mi></msup><mo id="S3.Ex2.m1.1.1.1.1.1.1.1.1.1.1" stretchy="false" xref="S3.Ex2.m1.1.1.1.1.1.1.1.1.1.1.cmml">→</mo><mi id="S3.Ex2.m1.1.1.1.1.1.1.1.1.1.3" xref="S3.Ex2.m1.1.1.1.1.1.1.1.1.1.3.cmml">S</mi></mrow><mo id="S3.Ex2.m1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.Ex2.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.Ex2.m1.1.1.1.1.1.2" stretchy="false" xref="S3.Ex2.m1.1.1.1.1.1.2.cmml">→</mo><mi id="S3.Ex2.m1.1.1.1.1.1.3" xref="S3.Ex2.m1.1.1.1.1.1.3.cmml">𝔻</mi></mrow></mtd></mtr><mtr id="S3.Ex2.m1.6.6e" xref="S3.Ex2.m1.6.6.cmml"><mtd class="ltx_align_right" columnalign="right" id="S3.Ex2.m1.6.6f" xref="S3.Ex2.m1.6.6.cmml"><mtext class="ltx_font_smallcaps" id="S3.Ex2.m1.2.2.2.2.1" xref="S3.Ex2.m1.2.2.2.2.1a.cmml">Filter</mtext></mtd><mtd id="S3.Ex2.m1.6.6g" xref="S3.Ex2.m1.6.6.cmml"><mo id="S3.Ex2.m1.2.2.2.3.1" xref="S3.Ex2.m1.2.2.2.3.1.cmml">:</mo></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.Ex2.m1.6.6h" xref="S3.Ex2.m1.6.6.cmml"><mrow id="S3.Ex2.m1.2.2.2.1.1" xref="S3.Ex2.m1.2.2.2.1.1.cmml"><mrow id="S3.Ex2.m1.2.2.2.1.1.1" xref="S3.Ex2.m1.2.2.2.1.1.1.cmml"><mi id="S3.Ex2.m1.2.2.2.1.1.1.3" xref="S3.Ex2.m1.2.2.2.1.1.1.3.cmml">𝔻</mi><mo id="S3.Ex2.m1.2.2.2.1.1.1.2" lspace="0.222em" rspace="0.222em" xref="S3.Ex2.m1.2.2.2.1.1.1.2.cmml">×</mo><mrow id="S3.Ex2.m1.2.2.2.1.1.1.1.1" xref="S3.Ex2.m1.2.2.2.1.1.1.1.1.1.cmml"><mo id="S3.Ex2.m1.2.2.2.1.1.1.1.1.2" stretchy="false" xref="S3.Ex2.m1.2.2.2.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.Ex2.m1.2.2.2.1.1.1.1.1.1" xref="S3.Ex2.m1.2.2.2.1.1.1.1.1.1.cmml"><mi id="S3.Ex2.m1.2.2.2.1.1.1.1.1.1.2" xref="S3.Ex2.m1.2.2.2.1.1.1.1.1.1.2.cmml">S</mi><mo id="S3.Ex2.m1.2.2.2.1.1.1.1.1.1.1" stretchy="false" xref="S3.Ex2.m1.2.2.2.1.1.1.1.1.1.1.cmml">→</mo><mi id="S3.Ex2.m1.2.2.2.1.1.1.1.1.1.3" xref="S3.Ex2.m1.2.2.2.1.1.1.1.1.1.3.cmml">𝔹</mi></mrow><mo id="S3.Ex2.m1.2.2.2.1.1.1.1.1.3" stretchy="false" xref="S3.Ex2.m1.2.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.Ex2.m1.2.2.2.1.1.2" stretchy="false" xref="S3.Ex2.m1.2.2.2.1.1.2.cmml">→</mo><mi id="S3.Ex2.m1.2.2.2.1.1.3" xref="S3.Ex2.m1.2.2.2.1.1.3.cmml">𝔻</mi></mrow></mtd></mtr><mtr id="S3.Ex2.m1.6.6i" xref="S3.Ex2.m1.6.6.cmml"><mtd class="ltx_align_right" columnalign="right" id="S3.Ex2.m1.6.6j" xref="S3.Ex2.m1.6.6.cmml"><mtext class="ltx_font_smallcaps" id="S3.Ex2.m1.4.4.4.3.1" xref="S3.Ex2.m1.4.4.4.3.1a.cmml">ApplyIf</mtext></mtd><mtd id="S3.Ex2.m1.6.6k" xref="S3.Ex2.m1.6.6.cmml"><mo id="S3.Ex2.m1.4.4.4.4.1" xref="S3.Ex2.m1.4.4.4.4.1.cmml">:</mo></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.Ex2.m1.6.6l" xref="S3.Ex2.m1.6.6.cmml"><mrow id="S3.Ex2.m1.4.4.4.2.2" xref="S3.Ex2.m1.4.4.4.2.2.cmml"><mrow id="S3.Ex2.m1.4.4.4.2.2.2" xref="S3.Ex2.m1.4.4.4.2.2.2.cmml"><msup id="S3.Ex2.m1.4.4.4.2.2.2.4" xref="S3.Ex2.m1.4.4.4.2.2.2.4.cmml"><mi id="S3.Ex2.m1.4.4.4.2.2.2.4.2" xref="S3.Ex2.m1.4.4.4.2.2.2.4.2.cmml">𝔻</mi><mi id="S3.Ex2.m1.4.4.4.2.2.2.4.3" xref="S3.Ex2.m1.4.4.4.2.2.2.4.3.cmml">K</mi></msup><mo id="S3.Ex2.m1.4.4.4.2.2.2.3" lspace="0.222em" rspace="0.222em" xref="S3.Ex2.m1.4.4.4.2.2.2.3.cmml">×</mo><mrow id="S3.Ex2.m1.3.3.3.1.1.1.1.1" xref="S3.Ex2.m1.3.3.3.1.1.1.1.1.1.cmml"><mo id="S3.Ex2.m1.3.3.3.1.1.1.1.1.2" stretchy="false" xref="S3.Ex2.m1.3.3.3.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.Ex2.m1.3.3.3.1.1.1.1.1.1" xref="S3.Ex2.m1.3.3.3.1.1.1.1.1.1.cmml"><msup id="S3.Ex2.m1.3.3.3.1.1.1.1.1.1.2" xref="S3.Ex2.m1.3.3.3.1.1.1.1.1.1.2.cmml"><mi id="S3.Ex2.m1.3.3.3.1.1.1.1.1.1.2.2" xref="S3.Ex2.m1.3.3.3.1.1.1.1.1.1.2.2.cmml">S</mi><mi id="S3.Ex2.m1.3.3.3.1.1.1.1.1.1.2.3" xref="S3.Ex2.m1.3.3.3.1.1.1.1.1.1.2.3.cmml">K</mi></msup><mo id="S3.Ex2.m1.3.3.3.1.1.1.1.1.1.1" stretchy="false" xref="S3.Ex2.m1.3.3.3.1.1.1.1.1.1.1.cmml">→</mo><mi id="S3.Ex2.m1.3.3.3.1.1.1.1.1.1.3" xref="S3.Ex2.m1.3.3.3.1.1.1.1.1.1.3.cmml">S</mi></mrow><mo id="S3.Ex2.m1.3.3.3.1.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="S3.Ex2.m1.3.3.3.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.Ex2.m1.4.4.4.2.2.2.3a" rspace="0.222em" xref="S3.Ex2.m1.4.4.4.2.2.2.3.cmml">×</mo><mrow id="S3.Ex2.m1.4.4.4.2.2.2.2.1" xref="S3.Ex2.m1.4.4.4.2.2.2.2.1.1.cmml"><mo id="S3.Ex2.m1.4.4.4.2.2.2.2.1.2" stretchy="false" xref="S3.Ex2.m1.4.4.4.2.2.2.2.1.1.cmml">(</mo><mrow id="S3.Ex2.m1.4.4.4.2.2.2.2.1.1" xref="S3.Ex2.m1.4.4.4.2.2.2.2.1.1.cmml"><msup id="S3.Ex2.m1.4.4.4.2.2.2.2.1.1.2" xref="S3.Ex2.m1.4.4.4.2.2.2.2.1.1.2.cmml"><mi id="S3.Ex2.m1.4.4.4.2.2.2.2.1.1.2.2" xref="S3.Ex2.m1.4.4.4.2.2.2.2.1.1.2.2.cmml">S</mi><mi id="S3.Ex2.m1.4.4.4.2.2.2.2.1.1.2.3" xref="S3.Ex2.m1.4.4.4.2.2.2.2.1.1.2.3.cmml">K</mi></msup><mo id="S3.Ex2.m1.4.4.4.2.2.2.2.1.1.1" stretchy="false" xref="S3.Ex2.m1.4.4.4.2.2.2.2.1.1.1.cmml">→</mo><mi id="S3.Ex2.m1.4.4.4.2.2.2.2.1.1.3" xref="S3.Ex2.m1.4.4.4.2.2.2.2.1.1.3.cmml">𝔹</mi></mrow><mo id="S3.Ex2.m1.4.4.4.2.2.2.2.1.3" stretchy="false" xref="S3.Ex2.m1.4.4.4.2.2.2.2.1.1.cmml">)</mo></mrow></mrow><mo id="S3.Ex2.m1.4.4.4.2.2.3" stretchy="false" xref="S3.Ex2.m1.4.4.4.2.2.3.cmml">→</mo><mi id="S3.Ex2.m1.4.4.4.2.2.4" xref="S3.Ex2.m1.4.4.4.2.2.4.cmml">𝔻</mi></mrow></mtd></mtr><mtr id="S3.Ex2.m1.6.6m" xref="S3.Ex2.m1.6.6.cmml"><mtd class="ltx_align_right" columnalign="right" id="S3.Ex2.m1.6.6n" xref="S3.Ex2.m1.6.6.cmml"><mtext class="ltx_font_smallcaps" id="S3.Ex2.m1.6.6.7.1.1" xref="S3.Ex2.m1.6.6.7.1.1a.cmml">Union</mtext></mtd><mtd id="S3.Ex2.m1.6.6o" xref="S3.Ex2.m1.6.6.cmml"><mo id="S3.Ex2.m1.6.6.7.2.1" xref="S3.Ex2.m1.6.6.7.2.1.cmml">:</mo></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.Ex2.m1.6.6p" xref="S3.Ex2.m1.6.6.cmml"><mrow id="S3.Ex2.m1.6.6.7.3.1" xref="S3.Ex2.m1.6.6.7.3.1.cmml"><mrow id="S3.Ex2.m1.6.6.7.3.1.2" xref="S3.Ex2.m1.6.6.7.3.1.2.cmml"><mi id="S3.Ex2.m1.6.6.7.3.1.2.2" xref="S3.Ex2.m1.6.6.7.3.1.2.2.cmml">𝔻</mi><mo id="S3.Ex2.m1.6.6.7.3.1.2.1" lspace="0.222em" rspace="0.222em" xref="S3.Ex2.m1.6.6.7.3.1.2.1.cmml">×</mo><mi id="S3.Ex2.m1.6.6.7.3.1.2.3" xref="S3.Ex2.m1.6.6.7.3.1.2.3.cmml">𝔻</mi></mrow><mo id="S3.Ex2.m1.6.6.7.3.1.1" stretchy="false" xref="S3.Ex2.m1.6.6.7.3.1.1.cmml">→</mo><mi id="S3.Ex2.m1.6.6.7.3.1.3" xref="S3.Ex2.m1.6.6.7.3.1.3.cmml">𝔻</mi></mrow></mtd></mtr><mtr id="S3.Ex2.m1.6.6q" xref="S3.Ex2.m1.6.6.cmml"><mtd class="ltx_align_right" columnalign="right" id="S3.Ex2.m1.6.6r" xref="S3.Ex2.m1.6.6.cmml"><mtext class="ltx_font_smallcaps" id="S3.Ex2.m1.6.6.6.3.1" xref="S3.Ex2.m1.6.6.6.3.1a.cmml">GetProbs</mtext></mtd><mtd id="S3.Ex2.m1.6.6s" xref="S3.Ex2.m1.6.6.cmml"><mo id="S3.Ex2.m1.6.6.6.4.1" xref="S3.Ex2.m1.6.6.6.4.1.cmml">:</mo></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.Ex2.m1.6.6t" xref="S3.Ex2.m1.6.6.cmml"><mrow id="S3.Ex2.m1.6.6.6.2.2" xref="S3.Ex2.m1.6.6.6.2.2.cmml"><mi id="S3.Ex2.m1.6.6.6.2.2.4" xref="S3.Ex2.m1.6.6.6.2.2.4.cmml">𝔻</mi><mo id="S3.Ex2.m1.6.6.6.2.2.3" stretchy="false" xref="S3.Ex2.m1.6.6.6.2.2.3.cmml">→</mo><msup id="S3.Ex2.m1.6.6.6.2.2.5" xref="S3.Ex2.m1.6.6.6.2.2.5.cmml"><mrow id="S3.Ex2.m1.6.6.6.2.2.5.2.2" xref="S3.Ex2.m1.6.6.6.2.2.5.2.1.cmml"><mo id="S3.Ex2.m1.6.6.6.2.2.5.2.2.1" stretchy="false" xref="S3.Ex2.m1.6.6.6.2.2.5.2.1.cmml">[</mo><mn id="S3.Ex2.m1.5.5.5.1.1.1" xref="S3.Ex2.m1.5.5.5.1.1.1.cmml">0</mn><mo id="S3.Ex2.m1.6.6.6.2.2.5.2.2.2" xref="S3.Ex2.m1.6.6.6.2.2.5.2.1.cmml">,</mo><mn id="S3.Ex2.m1.6.6.6.2.2.2" xref="S3.Ex2.m1.6.6.6.2.2.2.cmml">1</mn><mo id="S3.Ex2.m1.6.6.6.2.2.5.2.2.3" stretchy="false" xref="S3.Ex2.m1.6.6.6.2.2.5.2.1.cmml">]</mo></mrow><mi id="S3.Ex2.m1.6.6.6.2.2.5.3" xref="S3.Ex2.m1.6.6.6.2.2.5.3.cmml">N</mi></msup></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S3.Ex2.m1.6b"><matrix id="S3.Ex2.m1.6.6.cmml" xref="S3.Ex2.m1.6.6"><matrixrow id="S3.Ex2.m1.6.6a.cmml" xref="S3.Ex2.m1.6.6"><ci id="S3.Ex2.m1.1.1.1.2.1a.cmml" xref="S3.Ex2.m1.1.1.1.2.1"><mtext class="ltx_font_smallcaps" id="S3.Ex2.m1.1.1.1.2.1.cmml" xref="S3.Ex2.m1.1.1.1.2.1">Apply</mtext></ci><ci id="S3.Ex2.m1.1.1.1.3.1.cmml" xref="S3.Ex2.m1.1.1.1.3.1">:</ci><apply id="S3.Ex2.m1.1.1.1.1.1.cmml" xref="S3.Ex2.m1.1.1.1.1.1"><ci id="S3.Ex2.m1.1.1.1.1.1.2.cmml" xref="S3.Ex2.m1.1.1.1.1.1.2">→</ci><apply id="S3.Ex2.m1.1.1.1.1.1.1.cmml" xref="S3.Ex2.m1.1.1.1.1.1.1"><times id="S3.Ex2.m1.1.1.1.1.1.1.2.cmml" xref="S3.Ex2.m1.1.1.1.1.1.1.2"></times><apply id="S3.Ex2.m1.1.1.1.1.1.1.3.cmml" xref="S3.Ex2.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex2.m1.1.1.1.1.1.1.3.1.cmml" xref="S3.Ex2.m1.1.1.1.1.1.1.3">superscript</csymbol><ci id="S3.Ex2.m1.1.1.1.1.1.1.3.2.cmml" xref="S3.Ex2.m1.1.1.1.1.1.1.3.2">𝔻</ci><ci id="S3.Ex2.m1.1.1.1.1.1.1.3.3.cmml" xref="S3.Ex2.m1.1.1.1.1.1.1.3.3">𝐾</ci></apply><apply id="S3.Ex2.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex2.m1.1.1.1.1.1.1.1.1"><ci id="S3.Ex2.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex2.m1.1.1.1.1.1.1.1.1.1.1">→</ci><apply id="S3.Ex2.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex2.m1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.Ex2.m1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.Ex2.m1.1.1.1.1.1.1.1.1.1.2">superscript</csymbol><ci id="S3.Ex2.m1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.Ex2.m1.1.1.1.1.1.1.1.1.1.2.2">𝑆</ci><ci id="S3.Ex2.m1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.Ex2.m1.1.1.1.1.1.1.1.1.1.2.3">𝐾</ci></apply><ci id="S3.Ex2.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex2.m1.1.1.1.1.1.1.1.1.1.3">𝑆</ci></apply></apply><ci id="S3.Ex2.m1.1.1.1.1.1.3.cmml" xref="S3.Ex2.m1.1.1.1.1.1.3">𝔻</ci></apply></matrixrow><matrixrow id="S3.Ex2.m1.6.6b.cmml" xref="S3.Ex2.m1.6.6"><ci id="S3.Ex2.m1.2.2.2.2.1a.cmml" xref="S3.Ex2.m1.2.2.2.2.1"><mtext class="ltx_font_smallcaps" id="S3.Ex2.m1.2.2.2.2.1.cmml" xref="S3.Ex2.m1.2.2.2.2.1">Filter</mtext></ci><ci id="S3.Ex2.m1.2.2.2.3.1.cmml" xref="S3.Ex2.m1.2.2.2.3.1">:</ci><apply id="S3.Ex2.m1.2.2.2.1.1.cmml" xref="S3.Ex2.m1.2.2.2.1.1"><ci id="S3.Ex2.m1.2.2.2.1.1.2.cmml" xref="S3.Ex2.m1.2.2.2.1.1.2">→</ci><apply id="S3.Ex2.m1.2.2.2.1.1.1.cmml" xref="S3.Ex2.m1.2.2.2.1.1.1"><times id="S3.Ex2.m1.2.2.2.1.1.1.2.cmml" xref="S3.Ex2.m1.2.2.2.1.1.1.2"></times><ci id="S3.Ex2.m1.2.2.2.1.1.1.3.cmml" xref="S3.Ex2.m1.2.2.2.1.1.1.3">𝔻</ci><apply id="S3.Ex2.m1.2.2.2.1.1.1.1.1.1.cmml" xref="S3.Ex2.m1.2.2.2.1.1.1.1.1"><ci id="S3.Ex2.m1.2.2.2.1.1.1.1.1.1.1.cmml" xref="S3.Ex2.m1.2.2.2.1.1.1.1.1.1.1">→</ci><ci id="S3.Ex2.m1.2.2.2.1.1.1.1.1.1.2.cmml" xref="S3.Ex2.m1.2.2.2.1.1.1.1.1.1.2">𝑆</ci><ci id="S3.Ex2.m1.2.2.2.1.1.1.1.1.1.3.cmml" xref="S3.Ex2.m1.2.2.2.1.1.1.1.1.1.3">𝔹</ci></apply></apply><ci id="S3.Ex2.m1.2.2.2.1.1.3.cmml" xref="S3.Ex2.m1.2.2.2.1.1.3">𝔻</ci></apply></matrixrow><matrixrow id="S3.Ex2.m1.6.6c.cmml" xref="S3.Ex2.m1.6.6"><ci id="S3.Ex2.m1.4.4.4.3.1a.cmml" xref="S3.Ex2.m1.4.4.4.3.1"><mtext class="ltx_font_smallcaps" id="S3.Ex2.m1.4.4.4.3.1.cmml" xref="S3.Ex2.m1.4.4.4.3.1">ApplyIf</mtext></ci><ci id="S3.Ex2.m1.4.4.4.4.1.cmml" xref="S3.Ex2.m1.4.4.4.4.1">:</ci><apply id="S3.Ex2.m1.4.4.4.2.2.cmml" xref="S3.Ex2.m1.4.4.4.2.2"><ci id="S3.Ex2.m1.4.4.4.2.2.3.cmml" xref="S3.Ex2.m1.4.4.4.2.2.3">→</ci><apply id="S3.Ex2.m1.4.4.4.2.2.2.cmml" xref="S3.Ex2.m1.4.4.4.2.2.2"><times id="S3.Ex2.m1.4.4.4.2.2.2.3.cmml" xref="S3.Ex2.m1.4.4.4.2.2.2.3"></times><apply id="S3.Ex2.m1.4.4.4.2.2.2.4.cmml" xref="S3.Ex2.m1.4.4.4.2.2.2.4"><csymbol cd="ambiguous" id="S3.Ex2.m1.4.4.4.2.2.2.4.1.cmml" xref="S3.Ex2.m1.4.4.4.2.2.2.4">superscript</csymbol><ci id="S3.Ex2.m1.4.4.4.2.2.2.4.2.cmml" xref="S3.Ex2.m1.4.4.4.2.2.2.4.2">𝔻</ci><ci id="S3.Ex2.m1.4.4.4.2.2.2.4.3.cmml" xref="S3.Ex2.m1.4.4.4.2.2.2.4.3">𝐾</ci></apply><apply id="S3.Ex2.m1.3.3.3.1.1.1.1.1.1.cmml" xref="S3.Ex2.m1.3.3.3.1.1.1.1.1"><ci id="S3.Ex2.m1.3.3.3.1.1.1.1.1.1.1.cmml" xref="S3.Ex2.m1.3.3.3.1.1.1.1.1.1.1">→</ci><apply id="S3.Ex2.m1.3.3.3.1.1.1.1.1.1.2.cmml" xref="S3.Ex2.m1.3.3.3.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.Ex2.m1.3.3.3.1.1.1.1.1.1.2.1.cmml" xref="S3.Ex2.m1.3.3.3.1.1.1.1.1.1.2">superscript</csymbol><ci id="S3.Ex2.m1.3.3.3.1.1.1.1.1.1.2.2.cmml" xref="S3.Ex2.m1.3.3.3.1.1.1.1.1.1.2.2">𝑆</ci><ci id="S3.Ex2.m1.3.3.3.1.1.1.1.1.1.2.3.cmml" xref="S3.Ex2.m1.3.3.3.1.1.1.1.1.1.2.3">𝐾</ci></apply><ci id="S3.Ex2.m1.3.3.3.1.1.1.1.1.1.3.cmml" xref="S3.Ex2.m1.3.3.3.1.1.1.1.1.1.3">𝑆</ci></apply><apply id="S3.Ex2.m1.4.4.4.2.2.2.2.1.1.cmml" xref="S3.Ex2.m1.4.4.4.2.2.2.2.1"><ci id="S3.Ex2.m1.4.4.4.2.2.2.2.1.1.1.cmml" xref="S3.Ex2.m1.4.4.4.2.2.2.2.1.1.1">→</ci><apply id="S3.Ex2.m1.4.4.4.2.2.2.2.1.1.2.cmml" xref="S3.Ex2.m1.4.4.4.2.2.2.2.1.1.2"><csymbol cd="ambiguous" id="S3.Ex2.m1.4.4.4.2.2.2.2.1.1.2.1.cmml" xref="S3.Ex2.m1.4.4.4.2.2.2.2.1.1.2">superscript</csymbol><ci id="S3.Ex2.m1.4.4.4.2.2.2.2.1.1.2.2.cmml" xref="S3.Ex2.m1.4.4.4.2.2.2.2.1.1.2.2">𝑆</ci><ci id="S3.Ex2.m1.4.4.4.2.2.2.2.1.1.2.3.cmml" xref="S3.Ex2.m1.4.4.4.2.2.2.2.1.1.2.3">𝐾</ci></apply><ci id="S3.Ex2.m1.4.4.4.2.2.2.2.1.1.3.cmml" xref="S3.Ex2.m1.4.4.4.2.2.2.2.1.1.3">𝔹</ci></apply></apply><ci id="S3.Ex2.m1.4.4.4.2.2.4.cmml" xref="S3.Ex2.m1.4.4.4.2.2.4">𝔻</ci></apply></matrixrow><matrixrow id="S3.Ex2.m1.6.6d.cmml" xref="S3.Ex2.m1.6.6"><ci id="S3.Ex2.m1.6.6.7.1.1a.cmml" xref="S3.Ex2.m1.6.6.7.1.1"><mtext class="ltx_font_smallcaps" id="S3.Ex2.m1.6.6.7.1.1.cmml" xref="S3.Ex2.m1.6.6.7.1.1">Union</mtext></ci><ci id="S3.Ex2.m1.6.6.7.2.1.cmml" xref="S3.Ex2.m1.6.6.7.2.1">:</ci><apply id="S3.Ex2.m1.6.6.7.3.1.cmml" xref="S3.Ex2.m1.6.6.7.3.1"><ci id="S3.Ex2.m1.6.6.7.3.1.1.cmml" xref="S3.Ex2.m1.6.6.7.3.1.1">→</ci><apply id="S3.Ex2.m1.6.6.7.3.1.2.cmml" xref="S3.Ex2.m1.6.6.7.3.1.2"><times id="S3.Ex2.m1.6.6.7.3.1.2.1.cmml" xref="S3.Ex2.m1.6.6.7.3.1.2.1"></times><ci id="S3.Ex2.m1.6.6.7.3.1.2.2.cmml" xref="S3.Ex2.m1.6.6.7.3.1.2.2">𝔻</ci><ci id="S3.Ex2.m1.6.6.7.3.1.2.3.cmml" xref="S3.Ex2.m1.6.6.7.3.1.2.3">𝔻</ci></apply><ci id="S3.Ex2.m1.6.6.7.3.1.3.cmml" xref="S3.Ex2.m1.6.6.7.3.1.3">𝔻</ci></apply></matrixrow><matrixrow id="S3.Ex2.m1.6.6e.cmml" xref="S3.Ex2.m1.6.6"><ci id="S3.Ex2.m1.6.6.6.3.1a.cmml" xref="S3.Ex2.m1.6.6.6.3.1"><mtext class="ltx_font_smallcaps" id="S3.Ex2.m1.6.6.6.3.1.cmml" xref="S3.Ex2.m1.6.6.6.3.1">GetProbs</mtext></ci><ci id="S3.Ex2.m1.6.6.6.4.1.cmml" xref="S3.Ex2.m1.6.6.6.4.1">:</ci><apply id="S3.Ex2.m1.6.6.6.2.2.cmml" xref="S3.Ex2.m1.6.6.6.2.2"><ci id="S3.Ex2.m1.6.6.6.2.2.3.cmml" xref="S3.Ex2.m1.6.6.6.2.2.3">→</ci><ci id="S3.Ex2.m1.6.6.6.2.2.4.cmml" xref="S3.Ex2.m1.6.6.6.2.2.4">𝔻</ci><apply id="S3.Ex2.m1.6.6.6.2.2.5.cmml" xref="S3.Ex2.m1.6.6.6.2.2.5"><csymbol cd="ambiguous" id="S3.Ex2.m1.6.6.6.2.2.5.1.cmml" xref="S3.Ex2.m1.6.6.6.2.2.5">superscript</csymbol><interval closure="closed" id="S3.Ex2.m1.6.6.6.2.2.5.2.1.cmml" xref="S3.Ex2.m1.6.6.6.2.2.5.2.2"><cn id="S3.Ex2.m1.5.5.5.1.1.1.cmml" type="integer" xref="S3.Ex2.m1.5.5.5.1.1.1">0</cn><cn id="S3.Ex2.m1.6.6.6.2.2.2.cmml" type="integer" xref="S3.Ex2.m1.6.6.6.2.2.2">1</cn></interval><ci id="S3.Ex2.m1.6.6.6.2.2.5.3.cmml" xref="S3.Ex2.m1.6.6.6.2.2.5.3">𝑁</ci></apply></apply></matrixrow></matrix></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex2.m1.6c">\begin{array}[]{rcl}\textsc{Apply}&amp;:&amp;\mathbb{D}^{K}\times(S^{K}\rightarrow S)%
\rightarrow\mathbb{D}\\
\textsc{Filter}&amp;:&amp;\mathbb{D}\times(S\rightarrow\mathbb{B})\rightarrow\mathbb{D%
}\\
\textsc{ApplyIf}&amp;:&amp;\mathbb{D}^{K}\times(S^{K}\rightarrow S)\times(S^{K}%
\rightarrow\mathbb{B})\rightarrow\mathbb{D}\\
\textsc{Union}&amp;:&amp;\mathbb{D}\times\mathbb{D}\rightarrow\mathbb{D}\\
\textsc{GetProbs}&amp;:&amp;\mathbb{D}\rightarrow[0,1]^{N}\end{array}</annotation><annotation encoding="application/x-llamapun" id="S3.Ex2.m1.6d">start_ARRAY start_ROW start_CELL Apply end_CELL start_CELL : end_CELL start_CELL blackboard_D start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT × ( italic_S start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT → italic_S ) → blackboard_D end_CELL end_ROW start_ROW start_CELL Filter end_CELL start_CELL : end_CELL start_CELL blackboard_D × ( italic_S → blackboard_B ) → blackboard_D end_CELL end_ROW start_ROW start_CELL ApplyIf end_CELL start_CELL : end_CELL start_CELL blackboard_D start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT × ( italic_S start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT → italic_S ) × ( italic_S start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT → blackboard_B ) → blackboard_D end_CELL end_ROW start_ROW start_CELL Union end_CELL start_CELL : end_CELL start_CELL blackboard_D × blackboard_D → blackboard_D end_CELL end_ROW start_ROW start_CELL GetProbs end_CELL start_CELL : end_CELL start_CELL blackboard_D → [ 0 , 1 ] start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT end_CELL end_ROW end_ARRAY</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</figure>
</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>Formal definition of <span class="ltx_text ltx_font_smallcaps" id="S3.F3.2.1">Dolphin</span>’s programming abstractions and primitives.</figcaption>
</figure>
<section class="ltx_subsubsection" id="S3.SS2.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.2.1 </span>Abstractions</h4>
<div class="ltx_para ltx_noindent" id="S3.SS2.SSS1.p1">
<p class="ltx_p" id="S3.SS2.SSS1.p1.3">The three main abstractions provided by <span class="ltx_text ltx_font_smallcaps" id="S3.SS2.SSS1.p1.3.1">Dolphin</span> for expressing differentiable symbolic programs are shown on the left of Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03348v1#S3.F3" title="Figure 3 ‣ 3.2 The Dolphin Syntax ‣ 3 The Dolphin Framework ‣ 2 Overview ‣ Dolphin: A Programmable Framework for Scalable Neurosymbolic Learning"><span class="ltx_text ltx_ref_tag">3</span></a>.
<em class="ltx_emph ltx_font_italic" id="S3.SS2.SSS1.p1.3.2">Symbols</em> <math alttext="S" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p1.1.m1.1"><semantics id="S3.SS2.SSS1.p1.1.m1.1a"><mi id="S3.SS2.SSS1.p1.1.m1.1.1" xref="S3.SS2.SSS1.p1.1.m1.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.1.m1.1b"><ci id="S3.SS2.SSS1.p1.1.m1.1.1.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.1.m1.1c">S</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p1.1.m1.1d">italic_S</annotation></semantics></math> represent symbolic entities relevant to the program.
These entities can be any Pythonic object, such as hand-written digits in MNIST-SumN or coordinates of points in PathFinder.
<em class="ltx_emph ltx_font_italic" id="S3.SS2.SSS1.p1.3.3">Tags</em> <math alttext="T" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p1.2.m2.1"><semantics id="S3.SS2.SSS1.p1.2.m2.1a"><mi id="S3.SS2.SSS1.p1.2.m2.1.1" xref="S3.SS2.SSS1.p1.2.m2.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.2.m2.1b"><ci id="S3.SS2.SSS1.p1.2.m2.1.1.cmml" xref="S3.SS2.SSS1.p1.2.m2.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.2.m2.1c">T</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p1.2.m2.1d">italic_T</annotation></semantics></math> are tensors that represent relative likelihoods.
Typically, tags for symbols are derived from the outputs of machine learning models, such as the probability distribution over digits produced by the CNN classifier in MNIST-SumN.
Finally, <em class="ltx_emph ltx_font_italic" id="S3.SS2.SSS1.p1.3.4">Distribution</em> <math alttext="D" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p1.3.m3.1"><semantics id="S3.SS2.SSS1.p1.3.m3.1a"><mi id="S3.SS2.SSS1.p1.3.m3.1.1" xref="S3.SS2.SSS1.p1.3.m3.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.3.m3.1b"><ci id="S3.SS2.SSS1.p1.3.m3.1.1.cmml" xref="S3.SS2.SSS1.p1.3.m3.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.3.m3.1c">D</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p1.3.m3.1d">italic_D</annotation></semantics></math> represents the likelihood of an input being classified as one of the pre-defined symbols.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS2.SSS1.p2">
<p class="ltx_p" id="S3.SS2.SSS1.p2.1">Distributions serve as the fundamental datatype of a <span class="ltx_text ltx_font_smallcaps" id="S3.SS2.SSS1.p2.1.1">Dolphin</span> program and act as its main interface with a machine learning model.
For instance, when the developer instantiates a Distribution object, such as in the following code snippet from Figure <span class="ltx_ref ltx_missing_label ltx_ref_self">LABEL:fig:mnist_sum_n_code</span>:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.Ex3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><span class="ltx_text ltx_markedasmath ltx_font_typewriter" id="S3.Ex3.m1.1.1.1"><math alttext="\texttt{D}_{\text{res}}" class="ltx_Math" display="inline" id="S3.Ex3.m1.1.1.1.m1.1"><semantics id="S3.Ex3.m1.1.1.1.m1.1a"><msub id="S3.Ex3.m1.1.1.1.m1.1.1" xref="S3.Ex3.m1.1.1.1.m1.1.1.cmml"><mtext class="ltx_mathvariant_monospace" id="S3.Ex3.m1.1.1.1.m1.1.1.2" xref="S3.Ex3.m1.1.1.1.m1.1.1.2a.cmml">D</mtext><mtext class="ltx_mathvariant_monospace" id="S3.Ex3.m1.1.1.1.m1.1.1.3" xref="S3.Ex3.m1.1.1.1.m1.1.1.3a.cmml">res</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.Ex3.m1.1.1.1.m1.1b"><apply id="S3.Ex3.m1.1.1.1.m1.1.1.cmml" xref="S3.Ex3.m1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.Ex3.m1.1.1.1.m1.1.1.1.cmml" xref="S3.Ex3.m1.1.1.1.m1.1.1">subscript</csymbol><ci id="S3.Ex3.m1.1.1.1.m1.1.1.2a.cmml" xref="S3.Ex3.m1.1.1.1.m1.1.1.2"><mtext class="ltx_mathvariant_monospace" id="S3.Ex3.m1.1.1.1.m1.1.1.2.cmml" xref="S3.Ex3.m1.1.1.1.m1.1.1.2">D</mtext></ci><ci id="S3.Ex3.m1.1.1.1.m1.1.1.3a.cmml" xref="S3.Ex3.m1.1.1.1.m1.1.1.3"><mtext class="ltx_mathvariant_monospace" id="S3.Ex3.m1.1.1.1.m1.1.1.3.cmml" mathsize="70%" xref="S3.Ex3.m1.1.1.1.m1.1.1.3">res</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex3.m1.1.1.1.m1.1c">\texttt{D}_{\text{res}}</annotation><annotation encoding="application/x-llamapun" id="S3.Ex3.m1.1.1.1.m1.1d">D start_POSTSUBSCRIPT res end_POSTSUBSCRIPT</annotation></semantics></math> = Distribution(self.CNN(imgs[0]), digits)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.SSS1.p2.2">the output of the CNN model is directly passed to the Distribution object, effectively acting as an input to the symbolic program.
The Distribution object itself, as shown in Figure <span class="ltx_ref ltx_missing_label ltx_ref_self">LABEL:fig:mnist_sum_breakdown</span>, contains batches of <span class="ltx_text ltx_font_italic" id="S3.SS2.SSS1.p2.2.1">tags</span> extracted from the model outputs, and maintains the set of corresponding symbols.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS2.SSS1.p3">
<p class="ltx_p" id="S3.SS2.SSS1.p3.1">To enable such a seamless integration between the PyTorch model and the symbolic program, Distributions are designed to
operate directly over PyTorch tensors.
This has two main advantages.
First, it preserves the gradients of the model output throughout the symbolic program, enabling end-to-end differentiability.
Second, it allows <span class="ltx_text ltx_font_smallcaps" id="S3.SS2.SSS1.p3.1.1">Dolphin</span> to perform operations over an entire batch of tags, leveraging the vectorized operations provided by PyTorch.
<span class="ltx_text ltx_font_smallcaps" id="S3.SS2.SSS1.p3.1.2">Dolphin</span> can thus operate efficiently on specialized hardware like GPUs, allowing the symbolic program to scale effectively.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S3.SS2.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.2.2 </span>Operations</h4>
<div class="ltx_para ltx_noindent" id="S3.SS2.SSS2.p1">
<p class="ltx_p" id="S3.SS2.SSS2.p1.1">Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03348v1#S3.F3" title="Figure 3 ‣ 3.2 The Dolphin Syntax ‣ 3 The Dolphin Framework ‣ 2 Overview ‣ Dolphin: A Programmable Framework for Scalable Neurosymbolic Learning"><span class="ltx_text ltx_ref_tag">3</span></a> shows the five operations supported by <span class="ltx_text ltx_font_smallcaps" id="S3.SS2.SSS2.p1.1.1">Dolphin</span> that developers can use to manipulate Distributions and express complex symbolic programs. We now expand on these operations.</p>
</div>
<section class="ltx_paragraph" id="S3.SS2.SSS2.Px1">
<h5 class="ltx_title ltx_title_paragraph">
<span class="ltx_text ltx_font_smallcaps" id="S3.SS2.SSS2.Px1.1.1">Apply</span>.</h5>
<div class="ltx_para ltx_noindent" id="S3.SS2.SSS2.Px1.p1">
<p class="ltx_p" id="S3.SS2.SSS2.Px1.p1.5">This is the primary operation that developers can use to manipulate Distributions.
It takes as inputs <math alttext="K" class="ltx_Math" display="inline" id="S3.SS2.SSS2.Px1.p1.1.m1.1"><semantics id="S3.SS2.SSS2.Px1.p1.1.m1.1a"><mi id="S3.SS2.SSS2.Px1.p1.1.m1.1.1" xref="S3.SS2.SSS2.Px1.p1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px1.p1.1.m1.1b"><ci id="S3.SS2.SSS2.Px1.p1.1.m1.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px1.p1.1.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.Px1.p1.1.m1.1d">italic_K</annotation></semantics></math> Distributions, where <math alttext="K\geq 1" class="ltx_Math" display="inline" id="S3.SS2.SSS2.Px1.p1.2.m2.1"><semantics id="S3.SS2.SSS2.Px1.p1.2.m2.1a"><mrow id="S3.SS2.SSS2.Px1.p1.2.m2.1.1" xref="S3.SS2.SSS2.Px1.p1.2.m2.1.1.cmml"><mi id="S3.SS2.SSS2.Px1.p1.2.m2.1.1.2" xref="S3.SS2.SSS2.Px1.p1.2.m2.1.1.2.cmml">K</mi><mo id="S3.SS2.SSS2.Px1.p1.2.m2.1.1.1" xref="S3.SS2.SSS2.Px1.p1.2.m2.1.1.1.cmml">≥</mo><mn id="S3.SS2.SSS2.Px1.p1.2.m2.1.1.3" xref="S3.SS2.SSS2.Px1.p1.2.m2.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px1.p1.2.m2.1b"><apply id="S3.SS2.SSS2.Px1.p1.2.m2.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.2.m2.1.1"><geq id="S3.SS2.SSS2.Px1.p1.2.m2.1.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.2.m2.1.1.1"></geq><ci id="S3.SS2.SSS2.Px1.p1.2.m2.1.1.2.cmml" xref="S3.SS2.SSS2.Px1.p1.2.m2.1.1.2">𝐾</ci><cn id="S3.SS2.SSS2.Px1.p1.2.m2.1.1.3.cmml" type="integer" xref="S3.SS2.SSS2.Px1.p1.2.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px1.p1.2.m2.1c">K\geq 1</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.Px1.p1.2.m2.1d">italic_K ≥ 1</annotation></semantics></math>, along with a function <math alttext="f" class="ltx_Math" display="inline" id="S3.SS2.SSS2.Px1.p1.3.m3.1"><semantics id="S3.SS2.SSS2.Px1.p1.3.m3.1a"><mi id="S3.SS2.SSS2.Px1.p1.3.m3.1.1" xref="S3.SS2.SSS2.Px1.p1.3.m3.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px1.p1.3.m3.1b"><ci id="S3.SS2.SSS2.Px1.p1.3.m3.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.3.m3.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px1.p1.3.m3.1c">f</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.Px1.p1.3.m3.1d">italic_f</annotation></semantics></math> of the same arity.
This function defines operations over the symbols of <math alttext="K" class="ltx_Math" display="inline" id="S3.SS2.SSS2.Px1.p1.4.m4.1"><semantics id="S3.SS2.SSS2.Px1.p1.4.m4.1a"><mi id="S3.SS2.SSS2.Px1.p1.4.m4.1.1" xref="S3.SS2.SSS2.Px1.p1.4.m4.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px1.p1.4.m4.1b"><ci id="S3.SS2.SSS2.Px1.p1.4.m4.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.4.m4.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px1.p1.4.m4.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.Px1.p1.4.m4.1d">italic_K</annotation></semantics></math> distributions.
<span class="ltx_text ltx_font_smallcaps" id="S3.SS2.SSS2.Px1.p1.5.1">Apply</span> then computes the results of <math alttext="f" class="ltx_Math" display="inline" id="S3.SS2.SSS2.Px1.p1.5.m5.1"><semantics id="S3.SS2.SSS2.Px1.p1.5.m5.1a"><mi id="S3.SS2.SSS2.Px1.p1.5.m5.1.1" xref="S3.SS2.SSS2.Px1.p1.5.m5.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px1.p1.5.m5.1b"><ci id="S3.SS2.SSS2.Px1.p1.5.m5.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.5.m5.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px1.p1.5.m5.1c">f</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.Px1.p1.5.m5.1d">italic_f</annotation></semantics></math> over all possible combinations of arguments sourced from the symbols of
the Distributions as well as their associated tags, and returns a new Distribution with these results and tags.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS2.SSS2.Px1.p2">
<p class="ltx_p" id="S3.SS2.SSS2.Px1.p2.1">This operation occurs in two stages akin to the popular map-reduce pattern.
In the <span class="ltx_text ltx_font_italic" id="S3.SS2.SSS2.Px1.p2.1.1">map</span> stage, <span class="ltx_text ltx_font_smallcaps" id="S3.SS2.SSS2.Px1.p2.1.2">Apply</span> computes the results of <math alttext="f" class="ltx_Math" display="inline" id="S3.SS2.SSS2.Px1.p2.1.m1.1"><semantics id="S3.SS2.SSS2.Px1.p2.1.m1.1a"><mi id="S3.SS2.SSS2.Px1.p2.1.m1.1.1" xref="S3.SS2.SSS2.Px1.p2.1.m1.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px1.p2.1.m1.1b"><ci id="S3.SS2.SSS2.Px1.p2.1.m1.1.1.cmml" xref="S3.SS2.SSS2.Px1.p2.1.m1.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px1.p2.1.m1.1c">f</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.Px1.p2.1.m1.1d">italic_f</annotation></semantics></math> over the symbols of the input Distributions and their associated tags:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="R\ =\ \{\ (f(s_{1},s_{2},\ldots,s_{k}),(t_{1}\otimes t_{2}\otimes\ldots\otimes
t%
_{k}))\ |\ D_{i}(s_{i})=t_{i},i=1,\ldots,k\ \}" class="ltx_Math" display="block" id="S3.E1.m1.6"><semantics id="S3.E1.m1.6a"><mrow id="S3.E1.m1.6.6" xref="S3.E1.m1.6.6.cmml"><mi id="S3.E1.m1.6.6.4" xref="S3.E1.m1.6.6.4.cmml">R</mi><mo id="S3.E1.m1.6.6.3" lspace="0.778em" rspace="0.778em" xref="S3.E1.m1.6.6.3.cmml">=</mo><mrow id="S3.E1.m1.6.6.2.2" xref="S3.E1.m1.6.6.2.3.cmml"><mo id="S3.E1.m1.6.6.2.2.3" rspace="0.500em" stretchy="false" xref="S3.E1.m1.6.6.2.3.1.cmml">{</mo><mrow id="S3.E1.m1.5.5.1.1.1.2" xref="S3.E1.m1.5.5.1.1.1.3.cmml"><mo id="S3.E1.m1.5.5.1.1.1.2.3" stretchy="false" xref="S3.E1.m1.5.5.1.1.1.3.cmml">(</mo><mrow id="S3.E1.m1.5.5.1.1.1.1.1" xref="S3.E1.m1.5.5.1.1.1.1.1.cmml"><mi id="S3.E1.m1.5.5.1.1.1.1.1.5" xref="S3.E1.m1.5.5.1.1.1.1.1.5.cmml">f</mi><mo id="S3.E1.m1.5.5.1.1.1.1.1.4" xref="S3.E1.m1.5.5.1.1.1.1.1.4.cmml">⁢</mo><mrow id="S3.E1.m1.5.5.1.1.1.1.1.3.3" xref="S3.E1.m1.5.5.1.1.1.1.1.3.4.cmml"><mo id="S3.E1.m1.5.5.1.1.1.1.1.3.3.4" stretchy="false" xref="S3.E1.m1.5.5.1.1.1.1.1.3.4.cmml">(</mo><msub id="S3.E1.m1.5.5.1.1.1.1.1.1.1.1" xref="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.2" xref="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.2.cmml">s</mi><mn id="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.3" xref="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.3.cmml">1</mn></msub><mo id="S3.E1.m1.5.5.1.1.1.1.1.3.3.5" xref="S3.E1.m1.5.5.1.1.1.1.1.3.4.cmml">,</mo><msub id="S3.E1.m1.5.5.1.1.1.1.1.2.2.2" xref="S3.E1.m1.5.5.1.1.1.1.1.2.2.2.cmml"><mi id="S3.E1.m1.5.5.1.1.1.1.1.2.2.2.2" xref="S3.E1.m1.5.5.1.1.1.1.1.2.2.2.2.cmml">s</mi><mn id="S3.E1.m1.5.5.1.1.1.1.1.2.2.2.3" xref="S3.E1.m1.5.5.1.1.1.1.1.2.2.2.3.cmml">2</mn></msub><mo id="S3.E1.m1.5.5.1.1.1.1.1.3.3.6" xref="S3.E1.m1.5.5.1.1.1.1.1.3.4.cmml">,</mo><mi id="S3.E1.m1.1.1" mathvariant="normal" xref="S3.E1.m1.1.1.cmml">…</mi><mo id="S3.E1.m1.5.5.1.1.1.1.1.3.3.7" xref="S3.E1.m1.5.5.1.1.1.1.1.3.4.cmml">,</mo><msub id="S3.E1.m1.5.5.1.1.1.1.1.3.3.3" xref="S3.E1.m1.5.5.1.1.1.1.1.3.3.3.cmml"><mi id="S3.E1.m1.5.5.1.1.1.1.1.3.3.3.2" xref="S3.E1.m1.5.5.1.1.1.1.1.3.3.3.2.cmml">s</mi><mi id="S3.E1.m1.5.5.1.1.1.1.1.3.3.3.3" xref="S3.E1.m1.5.5.1.1.1.1.1.3.3.3.3.cmml">k</mi></msub><mo id="S3.E1.m1.5.5.1.1.1.1.1.3.3.8" stretchy="false" xref="S3.E1.m1.5.5.1.1.1.1.1.3.4.cmml">)</mo></mrow></mrow><mo id="S3.E1.m1.5.5.1.1.1.2.4" xref="S3.E1.m1.5.5.1.1.1.3.cmml">,</mo><mrow id="S3.E1.m1.5.5.1.1.1.2.2.1" xref="S3.E1.m1.5.5.1.1.1.2.2.1.1.cmml"><mo id="S3.E1.m1.5.5.1.1.1.2.2.1.2" stretchy="false" xref="S3.E1.m1.5.5.1.1.1.2.2.1.1.cmml">(</mo><mrow id="S3.E1.m1.5.5.1.1.1.2.2.1.1" xref="S3.E1.m1.5.5.1.1.1.2.2.1.1.cmml"><msub id="S3.E1.m1.5.5.1.1.1.2.2.1.1.2" xref="S3.E1.m1.5.5.1.1.1.2.2.1.1.2.cmml"><mi id="S3.E1.m1.5.5.1.1.1.2.2.1.1.2.2" xref="S3.E1.m1.5.5.1.1.1.2.2.1.1.2.2.cmml">t</mi><mn id="S3.E1.m1.5.5.1.1.1.2.2.1.1.2.3" xref="S3.E1.m1.5.5.1.1.1.2.2.1.1.2.3.cmml">1</mn></msub><mo id="S3.E1.m1.5.5.1.1.1.2.2.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.E1.m1.5.5.1.1.1.2.2.1.1.1.cmml">⊗</mo><msub id="S3.E1.m1.5.5.1.1.1.2.2.1.1.3" xref="S3.E1.m1.5.5.1.1.1.2.2.1.1.3.cmml"><mi id="S3.E1.m1.5.5.1.1.1.2.2.1.1.3.2" xref="S3.E1.m1.5.5.1.1.1.2.2.1.1.3.2.cmml">t</mi><mn id="S3.E1.m1.5.5.1.1.1.2.2.1.1.3.3" xref="S3.E1.m1.5.5.1.1.1.2.2.1.1.3.3.cmml">2</mn></msub><mo id="S3.E1.m1.5.5.1.1.1.2.2.1.1.1a" lspace="0.222em" rspace="0.222em" xref="S3.E1.m1.5.5.1.1.1.2.2.1.1.1.cmml">⊗</mo><mi id="S3.E1.m1.5.5.1.1.1.2.2.1.1.4" mathvariant="normal" xref="S3.E1.m1.5.5.1.1.1.2.2.1.1.4.cmml">…</mi><mo id="S3.E1.m1.5.5.1.1.1.2.2.1.1.1b" lspace="0.222em" rspace="0.222em" xref="S3.E1.m1.5.5.1.1.1.2.2.1.1.1.cmml">⊗</mo><msub id="S3.E1.m1.5.5.1.1.1.2.2.1.1.5" xref="S3.E1.m1.5.5.1.1.1.2.2.1.1.5.cmml"><mi id="S3.E1.m1.5.5.1.1.1.2.2.1.1.5.2" xref="S3.E1.m1.5.5.1.1.1.2.2.1.1.5.2.cmml">t</mi><mi id="S3.E1.m1.5.5.1.1.1.2.2.1.1.5.3" xref="S3.E1.m1.5.5.1.1.1.2.2.1.1.5.3.cmml">k</mi></msub></mrow><mo id="S3.E1.m1.5.5.1.1.1.2.2.1.3" stretchy="false" xref="S3.E1.m1.5.5.1.1.1.2.2.1.1.cmml">)</mo></mrow><mo id="S3.E1.m1.5.5.1.1.1.2.5" rspace="0.222em" stretchy="false" xref="S3.E1.m1.5.5.1.1.1.3.cmml">)</mo></mrow><mo id="S3.E1.m1.6.6.2.2.4" rspace="0.500em" xref="S3.E1.m1.6.6.2.3.1.cmml">|</mo><mrow id="S3.E1.m1.6.6.2.2.2.2" xref="S3.E1.m1.6.6.2.2.2.3.cmml"><mrow id="S3.E1.m1.6.6.2.2.2.1.1" xref="S3.E1.m1.6.6.2.2.2.1.1.cmml"><mrow id="S3.E1.m1.6.6.2.2.2.1.1.1" xref="S3.E1.m1.6.6.2.2.2.1.1.1.cmml"><msub id="S3.E1.m1.6.6.2.2.2.1.1.1.3" xref="S3.E1.m1.6.6.2.2.2.1.1.1.3.cmml"><mi id="S3.E1.m1.6.6.2.2.2.1.1.1.3.2" xref="S3.E1.m1.6.6.2.2.2.1.1.1.3.2.cmml">D</mi><mi id="S3.E1.m1.6.6.2.2.2.1.1.1.3.3" xref="S3.E1.m1.6.6.2.2.2.1.1.1.3.3.cmml">i</mi></msub><mo id="S3.E1.m1.6.6.2.2.2.1.1.1.2" xref="S3.E1.m1.6.6.2.2.2.1.1.1.2.cmml">⁢</mo><mrow id="S3.E1.m1.6.6.2.2.2.1.1.1.1.1" xref="S3.E1.m1.6.6.2.2.2.1.1.1.1.1.1.cmml"><mo id="S3.E1.m1.6.6.2.2.2.1.1.1.1.1.2" stretchy="false" xref="S3.E1.m1.6.6.2.2.2.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E1.m1.6.6.2.2.2.1.1.1.1.1.1" xref="S3.E1.m1.6.6.2.2.2.1.1.1.1.1.1.cmml"><mi id="S3.E1.m1.6.6.2.2.2.1.1.1.1.1.1.2" xref="S3.E1.m1.6.6.2.2.2.1.1.1.1.1.1.2.cmml">s</mi><mi id="S3.E1.m1.6.6.2.2.2.1.1.1.1.1.1.3" xref="S3.E1.m1.6.6.2.2.2.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E1.m1.6.6.2.2.2.1.1.1.1.1.3" stretchy="false" xref="S3.E1.m1.6.6.2.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E1.m1.6.6.2.2.2.1.1.2" xref="S3.E1.m1.6.6.2.2.2.1.1.2.cmml">=</mo><msub id="S3.E1.m1.6.6.2.2.2.1.1.3" xref="S3.E1.m1.6.6.2.2.2.1.1.3.cmml"><mi id="S3.E1.m1.6.6.2.2.2.1.1.3.2" xref="S3.E1.m1.6.6.2.2.2.1.1.3.2.cmml">t</mi><mi id="S3.E1.m1.6.6.2.2.2.1.1.3.3" xref="S3.E1.m1.6.6.2.2.2.1.1.3.3.cmml">i</mi></msub></mrow><mo id="S3.E1.m1.6.6.2.2.2.2.3" xref="S3.E1.m1.6.6.2.2.2.3a.cmml">,</mo><mrow id="S3.E1.m1.6.6.2.2.2.2.2" xref="S3.E1.m1.6.6.2.2.2.2.2.cmml"><mi id="S3.E1.m1.6.6.2.2.2.2.2.2" xref="S3.E1.m1.6.6.2.2.2.2.2.2.cmml">i</mi><mo id="S3.E1.m1.6.6.2.2.2.2.2.1" xref="S3.E1.m1.6.6.2.2.2.2.2.1.cmml">=</mo><mrow id="S3.E1.m1.6.6.2.2.2.2.2.3.2" xref="S3.E1.m1.6.6.2.2.2.2.2.3.1.cmml"><mn id="S3.E1.m1.2.2" xref="S3.E1.m1.2.2.cmml">1</mn><mo id="S3.E1.m1.6.6.2.2.2.2.2.3.2.1" xref="S3.E1.m1.6.6.2.2.2.2.2.3.1.cmml">,</mo><mi id="S3.E1.m1.3.3" mathvariant="normal" xref="S3.E1.m1.3.3.cmml">…</mi><mo id="S3.E1.m1.6.6.2.2.2.2.2.3.2.2" xref="S3.E1.m1.6.6.2.2.2.2.2.3.1.cmml">,</mo><mi id="S3.E1.m1.4.4" xref="S3.E1.m1.4.4.cmml">k</mi></mrow></mrow></mrow><mo id="S3.E1.m1.6.6.2.2.5" lspace="0.500em" stretchy="false" xref="S3.E1.m1.6.6.2.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.6b"><apply id="S3.E1.m1.6.6.cmml" xref="S3.E1.m1.6.6"><eq id="S3.E1.m1.6.6.3.cmml" xref="S3.E1.m1.6.6.3"></eq><ci id="S3.E1.m1.6.6.4.cmml" xref="S3.E1.m1.6.6.4">𝑅</ci><apply id="S3.E1.m1.6.6.2.3.cmml" xref="S3.E1.m1.6.6.2.2"><csymbol cd="latexml" id="S3.E1.m1.6.6.2.3.1.cmml" xref="S3.E1.m1.6.6.2.2.3">conditional-set</csymbol><interval closure="open" id="S3.E1.m1.5.5.1.1.1.3.cmml" xref="S3.E1.m1.5.5.1.1.1.2"><apply id="S3.E1.m1.5.5.1.1.1.1.1.cmml" xref="S3.E1.m1.5.5.1.1.1.1.1"><times id="S3.E1.m1.5.5.1.1.1.1.1.4.cmml" xref="S3.E1.m1.5.5.1.1.1.1.1.4"></times><ci id="S3.E1.m1.5.5.1.1.1.1.1.5.cmml" xref="S3.E1.m1.5.5.1.1.1.1.1.5">𝑓</ci><vector id="S3.E1.m1.5.5.1.1.1.1.1.3.4.cmml" xref="S3.E1.m1.5.5.1.1.1.1.1.3.3"><apply id="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.5.5.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.5.5.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.2">𝑠</ci><cn id="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.3">1</cn></apply><apply id="S3.E1.m1.5.5.1.1.1.1.1.2.2.2.cmml" xref="S3.E1.m1.5.5.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.5.5.1.1.1.1.1.2.2.2.1.cmml" xref="S3.E1.m1.5.5.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S3.E1.m1.5.5.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E1.m1.5.5.1.1.1.1.1.2.2.2.2">𝑠</ci><cn id="S3.E1.m1.5.5.1.1.1.1.1.2.2.2.3.cmml" type="integer" xref="S3.E1.m1.5.5.1.1.1.1.1.2.2.2.3">2</cn></apply><ci id="S3.E1.m1.1.1.cmml" xref="S3.E1.m1.1.1">…</ci><apply id="S3.E1.m1.5.5.1.1.1.1.1.3.3.3.cmml" xref="S3.E1.m1.5.5.1.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.E1.m1.5.5.1.1.1.1.1.3.3.3.1.cmml" xref="S3.E1.m1.5.5.1.1.1.1.1.3.3.3">subscript</csymbol><ci id="S3.E1.m1.5.5.1.1.1.1.1.3.3.3.2.cmml" xref="S3.E1.m1.5.5.1.1.1.1.1.3.3.3.2">𝑠</ci><ci id="S3.E1.m1.5.5.1.1.1.1.1.3.3.3.3.cmml" xref="S3.E1.m1.5.5.1.1.1.1.1.3.3.3.3">𝑘</ci></apply></vector></apply><apply id="S3.E1.m1.5.5.1.1.1.2.2.1.1.cmml" xref="S3.E1.m1.5.5.1.1.1.2.2.1"><csymbol cd="latexml" id="S3.E1.m1.5.5.1.1.1.2.2.1.1.1.cmml" xref="S3.E1.m1.5.5.1.1.1.2.2.1.1.1">tensor-product</csymbol><apply id="S3.E1.m1.5.5.1.1.1.2.2.1.1.2.cmml" xref="S3.E1.m1.5.5.1.1.1.2.2.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.5.5.1.1.1.2.2.1.1.2.1.cmml" xref="S3.E1.m1.5.5.1.1.1.2.2.1.1.2">subscript</csymbol><ci id="S3.E1.m1.5.5.1.1.1.2.2.1.1.2.2.cmml" xref="S3.E1.m1.5.5.1.1.1.2.2.1.1.2.2">𝑡</ci><cn id="S3.E1.m1.5.5.1.1.1.2.2.1.1.2.3.cmml" type="integer" xref="S3.E1.m1.5.5.1.1.1.2.2.1.1.2.3">1</cn></apply><apply id="S3.E1.m1.5.5.1.1.1.2.2.1.1.3.cmml" xref="S3.E1.m1.5.5.1.1.1.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.5.5.1.1.1.2.2.1.1.3.1.cmml" xref="S3.E1.m1.5.5.1.1.1.2.2.1.1.3">subscript</csymbol><ci id="S3.E1.m1.5.5.1.1.1.2.2.1.1.3.2.cmml" xref="S3.E1.m1.5.5.1.1.1.2.2.1.1.3.2">𝑡</ci><cn id="S3.E1.m1.5.5.1.1.1.2.2.1.1.3.3.cmml" type="integer" xref="S3.E1.m1.5.5.1.1.1.2.2.1.1.3.3">2</cn></apply><ci id="S3.E1.m1.5.5.1.1.1.2.2.1.1.4.cmml" xref="S3.E1.m1.5.5.1.1.1.2.2.1.1.4">…</ci><apply id="S3.E1.m1.5.5.1.1.1.2.2.1.1.5.cmml" xref="S3.E1.m1.5.5.1.1.1.2.2.1.1.5"><csymbol cd="ambiguous" id="S3.E1.m1.5.5.1.1.1.2.2.1.1.5.1.cmml" xref="S3.E1.m1.5.5.1.1.1.2.2.1.1.5">subscript</csymbol><ci id="S3.E1.m1.5.5.1.1.1.2.2.1.1.5.2.cmml" xref="S3.E1.m1.5.5.1.1.1.2.2.1.1.5.2">𝑡</ci><ci id="S3.E1.m1.5.5.1.1.1.2.2.1.1.5.3.cmml" xref="S3.E1.m1.5.5.1.1.1.2.2.1.1.5.3">𝑘</ci></apply></apply></interval><apply id="S3.E1.m1.6.6.2.2.2.3.cmml" xref="S3.E1.m1.6.6.2.2.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.6.6.2.2.2.3a.cmml" xref="S3.E1.m1.6.6.2.2.2.2.3">formulae-sequence</csymbol><apply id="S3.E1.m1.6.6.2.2.2.1.1.cmml" xref="S3.E1.m1.6.6.2.2.2.1.1"><eq id="S3.E1.m1.6.6.2.2.2.1.1.2.cmml" xref="S3.E1.m1.6.6.2.2.2.1.1.2"></eq><apply id="S3.E1.m1.6.6.2.2.2.1.1.1.cmml" xref="S3.E1.m1.6.6.2.2.2.1.1.1"><times id="S3.E1.m1.6.6.2.2.2.1.1.1.2.cmml" xref="S3.E1.m1.6.6.2.2.2.1.1.1.2"></times><apply id="S3.E1.m1.6.6.2.2.2.1.1.1.3.cmml" xref="S3.E1.m1.6.6.2.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.6.6.2.2.2.1.1.1.3.1.cmml" xref="S3.E1.m1.6.6.2.2.2.1.1.1.3">subscript</csymbol><ci id="S3.E1.m1.6.6.2.2.2.1.1.1.3.2.cmml" xref="S3.E1.m1.6.6.2.2.2.1.1.1.3.2">𝐷</ci><ci id="S3.E1.m1.6.6.2.2.2.1.1.1.3.3.cmml" xref="S3.E1.m1.6.6.2.2.2.1.1.1.3.3">𝑖</ci></apply><apply id="S3.E1.m1.6.6.2.2.2.1.1.1.1.1.1.cmml" xref="S3.E1.m1.6.6.2.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.6.6.2.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.6.6.2.2.2.1.1.1.1.1">subscript</csymbol><ci id="S3.E1.m1.6.6.2.2.2.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.6.6.2.2.2.1.1.1.1.1.1.2">𝑠</ci><ci id="S3.E1.m1.6.6.2.2.2.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.6.6.2.2.2.1.1.1.1.1.1.3">𝑖</ci></apply></apply><apply id="S3.E1.m1.6.6.2.2.2.1.1.3.cmml" xref="S3.E1.m1.6.6.2.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.6.6.2.2.2.1.1.3.1.cmml" xref="S3.E1.m1.6.6.2.2.2.1.1.3">subscript</csymbol><ci id="S3.E1.m1.6.6.2.2.2.1.1.3.2.cmml" xref="S3.E1.m1.6.6.2.2.2.1.1.3.2">𝑡</ci><ci id="S3.E1.m1.6.6.2.2.2.1.1.3.3.cmml" xref="S3.E1.m1.6.6.2.2.2.1.1.3.3">𝑖</ci></apply></apply><apply id="S3.E1.m1.6.6.2.2.2.2.2.cmml" xref="S3.E1.m1.6.6.2.2.2.2.2"><eq id="S3.E1.m1.6.6.2.2.2.2.2.1.cmml" xref="S3.E1.m1.6.6.2.2.2.2.2.1"></eq><ci id="S3.E1.m1.6.6.2.2.2.2.2.2.cmml" xref="S3.E1.m1.6.6.2.2.2.2.2.2">𝑖</ci><list id="S3.E1.m1.6.6.2.2.2.2.2.3.1.cmml" xref="S3.E1.m1.6.6.2.2.2.2.2.3.2"><cn id="S3.E1.m1.2.2.cmml" type="integer" xref="S3.E1.m1.2.2">1</cn><ci id="S3.E1.m1.3.3.cmml" xref="S3.E1.m1.3.3">…</ci><ci id="S3.E1.m1.4.4.cmml" xref="S3.E1.m1.4.4">𝑘</ci></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.6c">R\ =\ \{\ (f(s_{1},s_{2},\ldots,s_{k}),(t_{1}\otimes t_{2}\otimes\ldots\otimes
t%
_{k}))\ |\ D_{i}(s_{i})=t_{i},i=1,\ldots,k\ \}</annotation><annotation encoding="application/x-llamapun" id="S3.E1.m1.6d">italic_R = { ( italic_f ( italic_s start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_s start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , italic_s start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ) , ( italic_t start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ⊗ italic_t start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ⊗ … ⊗ italic_t start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ) ) | italic_D start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ( italic_s start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) = italic_t start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_i = 1 , … , italic_k }</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.SSS2.Px1.p2.4">Here, the tag of each result symbol <math alttext="f(s_{1},s_{2},\ldots,s_{k})" class="ltx_Math" display="inline" id="S3.SS2.SSS2.Px1.p2.2.m1.4"><semantics id="S3.SS2.SSS2.Px1.p2.2.m1.4a"><mrow id="S3.SS2.SSS2.Px1.p2.2.m1.4.4" xref="S3.SS2.SSS2.Px1.p2.2.m1.4.4.cmml"><mi id="S3.SS2.SSS2.Px1.p2.2.m1.4.4.5" xref="S3.SS2.SSS2.Px1.p2.2.m1.4.4.5.cmml">f</mi><mo id="S3.SS2.SSS2.Px1.p2.2.m1.4.4.4" xref="S3.SS2.SSS2.Px1.p2.2.m1.4.4.4.cmml">⁢</mo><mrow id="S3.SS2.SSS2.Px1.p2.2.m1.4.4.3.3" xref="S3.SS2.SSS2.Px1.p2.2.m1.4.4.3.4.cmml"><mo id="S3.SS2.SSS2.Px1.p2.2.m1.4.4.3.3.4" stretchy="false" xref="S3.SS2.SSS2.Px1.p2.2.m1.4.4.3.4.cmml">(</mo><msub id="S3.SS2.SSS2.Px1.p2.2.m1.2.2.1.1.1" xref="S3.SS2.SSS2.Px1.p2.2.m1.2.2.1.1.1.cmml"><mi id="S3.SS2.SSS2.Px1.p2.2.m1.2.2.1.1.1.2" xref="S3.SS2.SSS2.Px1.p2.2.m1.2.2.1.1.1.2.cmml">s</mi><mn id="S3.SS2.SSS2.Px1.p2.2.m1.2.2.1.1.1.3" xref="S3.SS2.SSS2.Px1.p2.2.m1.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS2.SSS2.Px1.p2.2.m1.4.4.3.3.5" xref="S3.SS2.SSS2.Px1.p2.2.m1.4.4.3.4.cmml">,</mo><msub id="S3.SS2.SSS2.Px1.p2.2.m1.3.3.2.2.2" xref="S3.SS2.SSS2.Px1.p2.2.m1.3.3.2.2.2.cmml"><mi id="S3.SS2.SSS2.Px1.p2.2.m1.3.3.2.2.2.2" xref="S3.SS2.SSS2.Px1.p2.2.m1.3.3.2.2.2.2.cmml">s</mi><mn id="S3.SS2.SSS2.Px1.p2.2.m1.3.3.2.2.2.3" xref="S3.SS2.SSS2.Px1.p2.2.m1.3.3.2.2.2.3.cmml">2</mn></msub><mo id="S3.SS2.SSS2.Px1.p2.2.m1.4.4.3.3.6" xref="S3.SS2.SSS2.Px1.p2.2.m1.4.4.3.4.cmml">,</mo><mi id="S3.SS2.SSS2.Px1.p2.2.m1.1.1" mathvariant="normal" xref="S3.SS2.SSS2.Px1.p2.2.m1.1.1.cmml">…</mi><mo id="S3.SS2.SSS2.Px1.p2.2.m1.4.4.3.3.7" xref="S3.SS2.SSS2.Px1.p2.2.m1.4.4.3.4.cmml">,</mo><msub id="S3.SS2.SSS2.Px1.p2.2.m1.4.4.3.3.3" xref="S3.SS2.SSS2.Px1.p2.2.m1.4.4.3.3.3.cmml"><mi id="S3.SS2.SSS2.Px1.p2.2.m1.4.4.3.3.3.2" xref="S3.SS2.SSS2.Px1.p2.2.m1.4.4.3.3.3.2.cmml">s</mi><mi id="S3.SS2.SSS2.Px1.p2.2.m1.4.4.3.3.3.3" xref="S3.SS2.SSS2.Px1.p2.2.m1.4.4.3.3.3.3.cmml">k</mi></msub><mo id="S3.SS2.SSS2.Px1.p2.2.m1.4.4.3.3.8" stretchy="false" xref="S3.SS2.SSS2.Px1.p2.2.m1.4.4.3.4.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px1.p2.2.m1.4b"><apply id="S3.SS2.SSS2.Px1.p2.2.m1.4.4.cmml" xref="S3.SS2.SSS2.Px1.p2.2.m1.4.4"><times id="S3.SS2.SSS2.Px1.p2.2.m1.4.4.4.cmml" xref="S3.SS2.SSS2.Px1.p2.2.m1.4.4.4"></times><ci id="S3.SS2.SSS2.Px1.p2.2.m1.4.4.5.cmml" xref="S3.SS2.SSS2.Px1.p2.2.m1.4.4.5">𝑓</ci><vector id="S3.SS2.SSS2.Px1.p2.2.m1.4.4.3.4.cmml" xref="S3.SS2.SSS2.Px1.p2.2.m1.4.4.3.3"><apply id="S3.SS2.SSS2.Px1.p2.2.m1.2.2.1.1.1.cmml" xref="S3.SS2.SSS2.Px1.p2.2.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px1.p2.2.m1.2.2.1.1.1.1.cmml" xref="S3.SS2.SSS2.Px1.p2.2.m1.2.2.1.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.Px1.p2.2.m1.2.2.1.1.1.2.cmml" xref="S3.SS2.SSS2.Px1.p2.2.m1.2.2.1.1.1.2">𝑠</ci><cn id="S3.SS2.SSS2.Px1.p2.2.m1.2.2.1.1.1.3.cmml" type="integer" xref="S3.SS2.SSS2.Px1.p2.2.m1.2.2.1.1.1.3">1</cn></apply><apply id="S3.SS2.SSS2.Px1.p2.2.m1.3.3.2.2.2.cmml" xref="S3.SS2.SSS2.Px1.p2.2.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px1.p2.2.m1.3.3.2.2.2.1.cmml" xref="S3.SS2.SSS2.Px1.p2.2.m1.3.3.2.2.2">subscript</csymbol><ci id="S3.SS2.SSS2.Px1.p2.2.m1.3.3.2.2.2.2.cmml" xref="S3.SS2.SSS2.Px1.p2.2.m1.3.3.2.2.2.2">𝑠</ci><cn id="S3.SS2.SSS2.Px1.p2.2.m1.3.3.2.2.2.3.cmml" type="integer" xref="S3.SS2.SSS2.Px1.p2.2.m1.3.3.2.2.2.3">2</cn></apply><ci id="S3.SS2.SSS2.Px1.p2.2.m1.1.1.cmml" xref="S3.SS2.SSS2.Px1.p2.2.m1.1.1">…</ci><apply id="S3.SS2.SSS2.Px1.p2.2.m1.4.4.3.3.3.cmml" xref="S3.SS2.SSS2.Px1.p2.2.m1.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px1.p2.2.m1.4.4.3.3.3.1.cmml" xref="S3.SS2.SSS2.Px1.p2.2.m1.4.4.3.3.3">subscript</csymbol><ci id="S3.SS2.SSS2.Px1.p2.2.m1.4.4.3.3.3.2.cmml" xref="S3.SS2.SSS2.Px1.p2.2.m1.4.4.3.3.3.2">𝑠</ci><ci id="S3.SS2.SSS2.Px1.p2.2.m1.4.4.3.3.3.3.cmml" xref="S3.SS2.SSS2.Px1.p2.2.m1.4.4.3.3.3.3">𝑘</ci></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px1.p2.2.m1.4c">f(s_{1},s_{2},\ldots,s_{k})</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.Px1.p2.2.m1.4d">italic_f ( italic_s start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_s start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , italic_s start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT )</annotation></semantics></math> is the conjunction <math alttext="\otimes" class="ltx_Math" display="inline" id="S3.SS2.SSS2.Px1.p2.3.m2.1"><semantics id="S3.SS2.SSS2.Px1.p2.3.m2.1a"><mo id="S3.SS2.SSS2.Px1.p2.3.m2.1.1" xref="S3.SS2.SSS2.Px1.p2.3.m2.1.1.cmml">⊗</mo><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px1.p2.3.m2.1b"><csymbol cd="latexml" id="S3.SS2.SSS2.Px1.p2.3.m2.1.1.cmml" xref="S3.SS2.SSS2.Px1.p2.3.m2.1.1">tensor-product</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px1.p2.3.m2.1c">\otimes</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.Px1.p2.3.m2.1d">⊗</annotation></semantics></math> of the tags <math alttext="(t_{1},t_{2},\ldots,t_{k})" class="ltx_Math" display="inline" id="S3.SS2.SSS2.Px1.p2.4.m3.4"><semantics id="S3.SS2.SSS2.Px1.p2.4.m3.4a"><mrow id="S3.SS2.SSS2.Px1.p2.4.m3.4.4.3" xref="S3.SS2.SSS2.Px1.p2.4.m3.4.4.4.cmml"><mo id="S3.SS2.SSS2.Px1.p2.4.m3.4.4.3.4" stretchy="false" xref="S3.SS2.SSS2.Px1.p2.4.m3.4.4.4.cmml">(</mo><msub id="S3.SS2.SSS2.Px1.p2.4.m3.2.2.1.1" xref="S3.SS2.SSS2.Px1.p2.4.m3.2.2.1.1.cmml"><mi id="S3.SS2.SSS2.Px1.p2.4.m3.2.2.1.1.2" xref="S3.SS2.SSS2.Px1.p2.4.m3.2.2.1.1.2.cmml">t</mi><mn id="S3.SS2.SSS2.Px1.p2.4.m3.2.2.1.1.3" xref="S3.SS2.SSS2.Px1.p2.4.m3.2.2.1.1.3.cmml">1</mn></msub><mo id="S3.SS2.SSS2.Px1.p2.4.m3.4.4.3.5" xref="S3.SS2.SSS2.Px1.p2.4.m3.4.4.4.cmml">,</mo><msub id="S3.SS2.SSS2.Px1.p2.4.m3.3.3.2.2" xref="S3.SS2.SSS2.Px1.p2.4.m3.3.3.2.2.cmml"><mi id="S3.SS2.SSS2.Px1.p2.4.m3.3.3.2.2.2" xref="S3.SS2.SSS2.Px1.p2.4.m3.3.3.2.2.2.cmml">t</mi><mn id="S3.SS2.SSS2.Px1.p2.4.m3.3.3.2.2.3" xref="S3.SS2.SSS2.Px1.p2.4.m3.3.3.2.2.3.cmml">2</mn></msub><mo id="S3.SS2.SSS2.Px1.p2.4.m3.4.4.3.6" xref="S3.SS2.SSS2.Px1.p2.4.m3.4.4.4.cmml">,</mo><mi id="S3.SS2.SSS2.Px1.p2.4.m3.1.1" mathvariant="normal" xref="S3.SS2.SSS2.Px1.p2.4.m3.1.1.cmml">…</mi><mo id="S3.SS2.SSS2.Px1.p2.4.m3.4.4.3.7" xref="S3.SS2.SSS2.Px1.p2.4.m3.4.4.4.cmml">,</mo><msub id="S3.SS2.SSS2.Px1.p2.4.m3.4.4.3.3" xref="S3.SS2.SSS2.Px1.p2.4.m3.4.4.3.3.cmml"><mi id="S3.SS2.SSS2.Px1.p2.4.m3.4.4.3.3.2" xref="S3.SS2.SSS2.Px1.p2.4.m3.4.4.3.3.2.cmml">t</mi><mi id="S3.SS2.SSS2.Px1.p2.4.m3.4.4.3.3.3" xref="S3.SS2.SSS2.Px1.p2.4.m3.4.4.3.3.3.cmml">k</mi></msub><mo id="S3.SS2.SSS2.Px1.p2.4.m3.4.4.3.8" stretchy="false" xref="S3.SS2.SSS2.Px1.p2.4.m3.4.4.4.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px1.p2.4.m3.4b"><vector id="S3.SS2.SSS2.Px1.p2.4.m3.4.4.4.cmml" xref="S3.SS2.SSS2.Px1.p2.4.m3.4.4.3"><apply id="S3.SS2.SSS2.Px1.p2.4.m3.2.2.1.1.cmml" xref="S3.SS2.SSS2.Px1.p2.4.m3.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px1.p2.4.m3.2.2.1.1.1.cmml" xref="S3.SS2.SSS2.Px1.p2.4.m3.2.2.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.Px1.p2.4.m3.2.2.1.1.2.cmml" xref="S3.SS2.SSS2.Px1.p2.4.m3.2.2.1.1.2">𝑡</ci><cn id="S3.SS2.SSS2.Px1.p2.4.m3.2.2.1.1.3.cmml" type="integer" xref="S3.SS2.SSS2.Px1.p2.4.m3.2.2.1.1.3">1</cn></apply><apply id="S3.SS2.SSS2.Px1.p2.4.m3.3.3.2.2.cmml" xref="S3.SS2.SSS2.Px1.p2.4.m3.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px1.p2.4.m3.3.3.2.2.1.cmml" xref="S3.SS2.SSS2.Px1.p2.4.m3.3.3.2.2">subscript</csymbol><ci id="S3.SS2.SSS2.Px1.p2.4.m3.3.3.2.2.2.cmml" xref="S3.SS2.SSS2.Px1.p2.4.m3.3.3.2.2.2">𝑡</ci><cn id="S3.SS2.SSS2.Px1.p2.4.m3.3.3.2.2.3.cmml" type="integer" xref="S3.SS2.SSS2.Px1.p2.4.m3.3.3.2.2.3">2</cn></apply><ci id="S3.SS2.SSS2.Px1.p2.4.m3.1.1.cmml" xref="S3.SS2.SSS2.Px1.p2.4.m3.1.1">…</ci><apply id="S3.SS2.SSS2.Px1.p2.4.m3.4.4.3.3.cmml" xref="S3.SS2.SSS2.Px1.p2.4.m3.4.4.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px1.p2.4.m3.4.4.3.3.1.cmml" xref="S3.SS2.SSS2.Px1.p2.4.m3.4.4.3.3">subscript</csymbol><ci id="S3.SS2.SSS2.Px1.p2.4.m3.4.4.3.3.2.cmml" xref="S3.SS2.SSS2.Px1.p2.4.m3.4.4.3.3.2">𝑡</ci><ci id="S3.SS2.SSS2.Px1.p2.4.m3.4.4.3.3.3.cmml" xref="S3.SS2.SSS2.Px1.p2.4.m3.4.4.3.3.3">𝑘</ci></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px1.p2.4.m3.4c">(t_{1},t_{2},\ldots,t_{k})</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.Px1.p2.4.m3.4d">( italic_t start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_t start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , italic_t start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT )</annotation></semantics></math> of the input symbols it was derived from.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS2.SSS2.Px1.p3">
<p class="ltx_p" id="S3.SS2.SSS2.Px1.p3.4">Note that the function <math alttext="f" class="ltx_Math" display="inline" id="S3.SS2.SSS2.Px1.p3.1.m1.1"><semantics id="S3.SS2.SSS2.Px1.p3.1.m1.1a"><mi id="S3.SS2.SSS2.Px1.p3.1.m1.1.1" xref="S3.SS2.SSS2.Px1.p3.1.m1.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px1.p3.1.m1.1b"><ci id="S3.SS2.SSS2.Px1.p3.1.m1.1.1.cmml" xref="S3.SS2.SSS2.Px1.p3.1.m1.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px1.p3.1.m1.1c">f</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.Px1.p3.1.m1.1d">italic_f</annotation></semantics></math> can be any user-defined Python function, including complex functions like regex parsing, image processing, or Python’s <span class="ltx_text ltx_font_typewriter" id="S3.SS2.SSS2.Px1.p3.4.1">eval()</span>.
As a result, <math alttext="f" class="ltx_Math" display="inline" id="S3.SS2.SSS2.Px1.p3.2.m2.1"><semantics id="S3.SS2.SSS2.Px1.p3.2.m2.1a"><mi id="S3.SS2.SSS2.Px1.p3.2.m2.1.1" xref="S3.SS2.SSS2.Px1.p3.2.m2.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px1.p3.2.m2.1b"><ci id="S3.SS2.SSS2.Px1.p3.2.m2.1.1.cmml" xref="S3.SS2.SSS2.Px1.p3.2.m2.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px1.p3.2.m2.1c">f</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.Px1.p3.2.m2.1d">italic_f</annotation></semantics></math> may be a many-to-one function and the tags shared by a resulting symbol must be aggregated
to form the final tags of the output Distribution.
We, therefore, <span class="ltx_text ltx_font_italic" id="S3.SS2.SSS2.Px1.p3.4.2">shuffle</span> the results from the map stage to compute a function <math alttext="M" class="ltx_Math" display="inline" id="S3.SS2.SSS2.Px1.p3.3.m3.1"><semantics id="S3.SS2.SSS2.Px1.p3.3.m3.1a"><mi id="S3.SS2.SSS2.Px1.p3.3.m3.1.1" xref="S3.SS2.SSS2.Px1.p3.3.m3.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px1.p3.3.m3.1b"><ci id="S3.SS2.SSS2.Px1.p3.3.m3.1.1.cmml" xref="S3.SS2.SSS2.Px1.p3.3.m3.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px1.p3.3.m3.1c">M</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.Px1.p3.3.m3.1d">italic_M</annotation></semantics></math> from each symbol to tags from <math alttext="R" class="ltx_Math" display="inline" id="S3.SS2.SSS2.Px1.p3.4.m4.1"><semantics id="S3.SS2.SSS2.Px1.p3.4.m4.1a"><mi id="S3.SS2.SSS2.Px1.p3.4.m4.1.1" xref="S3.SS2.SSS2.Px1.p3.4.m4.1.1.cmml">R</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px1.p3.4.m4.1b"><ci id="S3.SS2.SSS2.Px1.p3.4.m4.1.1.cmml" xref="S3.SS2.SSS2.Px1.p3.4.m4.1.1">𝑅</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px1.p3.4.m4.1c">R</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.Px1.p3.4.m4.1d">italic_R</annotation></semantics></math> associated with it:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="M=\lambda\ s\ .\ \{\ t\ |\ (s,t)\in R\ \}" class="ltx_Math" display="block" id="S3.E2.m1.5"><semantics id="S3.E2.m1.5a"><mrow id="S3.E2.m1.5.5.2" xref="S3.E2.m1.5.5.3.cmml"><mrow id="S3.E2.m1.4.4.1.1" xref="S3.E2.m1.4.4.1.1.cmml"><mi id="S3.E2.m1.4.4.1.1.2" xref="S3.E2.m1.4.4.1.1.2.cmml">M</mi><mo id="S3.E2.m1.4.4.1.1.1" xref="S3.E2.m1.4.4.1.1.1.cmml">=</mo><mrow id="S3.E2.m1.4.4.1.1.3" xref="S3.E2.m1.4.4.1.1.3.cmml"><mi id="S3.E2.m1.4.4.1.1.3.2" xref="S3.E2.m1.4.4.1.1.3.2.cmml">λ</mi><mo id="S3.E2.m1.4.4.1.1.3.1" lspace="0.500em" xref="S3.E2.m1.4.4.1.1.3.1.cmml">⁢</mo><mi id="S3.E2.m1.4.4.1.1.3.3" xref="S3.E2.m1.4.4.1.1.3.3.cmml">s</mi></mrow></mrow><mo id="S3.E2.m1.5.5.2.3" lspace="0.500em" rspace="0.667em" xref="S3.E2.m1.5.5.3a.cmml">.</mo><mrow id="S3.E2.m1.5.5.2.2.1" xref="S3.E2.m1.5.5.2.2.2.cmml"><mo id="S3.E2.m1.5.5.2.2.1.2" rspace="0.500em" stretchy="false" xref="S3.E2.m1.5.5.2.2.2.1.cmml">{</mo><mi id="S3.E2.m1.3.3" xref="S3.E2.m1.3.3.cmml">t</mi><mo id="S3.E2.m1.5.5.2.2.1.3" lspace="0.500em" rspace="0.500em" xref="S3.E2.m1.5.5.2.2.2.1.cmml">|</mo><mrow id="S3.E2.m1.5.5.2.2.1.1" xref="S3.E2.m1.5.5.2.2.1.1.cmml"><mrow id="S3.E2.m1.5.5.2.2.1.1.2.2" xref="S3.E2.m1.5.5.2.2.1.1.2.1.cmml"><mo id="S3.E2.m1.5.5.2.2.1.1.2.2.1" stretchy="false" xref="S3.E2.m1.5.5.2.2.1.1.2.1.cmml">(</mo><mi id="S3.E2.m1.1.1" xref="S3.E2.m1.1.1.cmml">s</mi><mo id="S3.E2.m1.5.5.2.2.1.1.2.2.2" xref="S3.E2.m1.5.5.2.2.1.1.2.1.cmml">,</mo><mi id="S3.E2.m1.2.2" xref="S3.E2.m1.2.2.cmml">t</mi><mo id="S3.E2.m1.5.5.2.2.1.1.2.2.3" stretchy="false" xref="S3.E2.m1.5.5.2.2.1.1.2.1.cmml">)</mo></mrow><mo id="S3.E2.m1.5.5.2.2.1.1.1" xref="S3.E2.m1.5.5.2.2.1.1.1.cmml">∈</mo><mi id="S3.E2.m1.5.5.2.2.1.1.3" xref="S3.E2.m1.5.5.2.2.1.1.3.cmml">R</mi></mrow><mo id="S3.E2.m1.5.5.2.2.1.4" lspace="0.500em" stretchy="false" xref="S3.E2.m1.5.5.2.2.2.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.5b"><apply id="S3.E2.m1.5.5.3.cmml" xref="S3.E2.m1.5.5.2"><csymbol cd="ambiguous" id="S3.E2.m1.5.5.3a.cmml" xref="S3.E2.m1.5.5.2.3">formulae-sequence</csymbol><apply id="S3.E2.m1.4.4.1.1.cmml" xref="S3.E2.m1.4.4.1.1"><eq id="S3.E2.m1.4.4.1.1.1.cmml" xref="S3.E2.m1.4.4.1.1.1"></eq><ci id="S3.E2.m1.4.4.1.1.2.cmml" xref="S3.E2.m1.4.4.1.1.2">𝑀</ci><apply id="S3.E2.m1.4.4.1.1.3.cmml" xref="S3.E2.m1.4.4.1.1.3"><times id="S3.E2.m1.4.4.1.1.3.1.cmml" xref="S3.E2.m1.4.4.1.1.3.1"></times><ci id="S3.E2.m1.4.4.1.1.3.2.cmml" xref="S3.E2.m1.4.4.1.1.3.2">𝜆</ci><ci id="S3.E2.m1.4.4.1.1.3.3.cmml" xref="S3.E2.m1.4.4.1.1.3.3">𝑠</ci></apply></apply><apply id="S3.E2.m1.5.5.2.2.2.cmml" xref="S3.E2.m1.5.5.2.2.1"><csymbol cd="latexml" id="S3.E2.m1.5.5.2.2.2.1.cmml" xref="S3.E2.m1.5.5.2.2.1.2">conditional-set</csymbol><ci id="S3.E2.m1.3.3.cmml" xref="S3.E2.m1.3.3">𝑡</ci><apply id="S3.E2.m1.5.5.2.2.1.1.cmml" xref="S3.E2.m1.5.5.2.2.1.1"><in id="S3.E2.m1.5.5.2.2.1.1.1.cmml" xref="S3.E2.m1.5.5.2.2.1.1.1"></in><interval closure="open" id="S3.E2.m1.5.5.2.2.1.1.2.1.cmml" xref="S3.E2.m1.5.5.2.2.1.1.2.2"><ci id="S3.E2.m1.1.1.cmml" xref="S3.E2.m1.1.1">𝑠</ci><ci id="S3.E2.m1.2.2.cmml" xref="S3.E2.m1.2.2">𝑡</ci></interval><ci id="S3.E2.m1.5.5.2.2.1.1.3.cmml" xref="S3.E2.m1.5.5.2.2.1.1.3">𝑅</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.5c">M=\lambda\ s\ .\ \{\ t\ |\ (s,t)\in R\ \}</annotation><annotation encoding="application/x-llamapun" id="S3.E2.m1.5d">italic_M = italic_λ italic_s . { italic_t | ( italic_s , italic_t ) ∈ italic_R }</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.SSS2.Px1.p3.7">We then proceed to the <span class="ltx_text ltx_font_italic" id="S3.SS2.SSS2.Px1.p3.7.1">reduce</span> stage, where we aggregate the tags of each symbol in <math alttext="M" class="ltx_Math" display="inline" id="S3.SS2.SSS2.Px1.p3.5.m1.1"><semantics id="S3.SS2.SSS2.Px1.p3.5.m1.1a"><mi id="S3.SS2.SSS2.Px1.p3.5.m1.1.1" xref="S3.SS2.SSS2.Px1.p3.5.m1.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px1.p3.5.m1.1b"><ci id="S3.SS2.SSS2.Px1.p3.5.m1.1.1.cmml" xref="S3.SS2.SSS2.Px1.p3.5.m1.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px1.p3.5.m1.1c">M</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.Px1.p3.5.m1.1d">italic_M</annotation></semantics></math> using disjunction <math alttext="\oplus" class="ltx_Math" display="inline" id="S3.SS2.SSS2.Px1.p3.6.m2.1"><semantics id="S3.SS2.SSS2.Px1.p3.6.m2.1a"><mo id="S3.SS2.SSS2.Px1.p3.6.m2.1.1" xref="S3.SS2.SSS2.Px1.p3.6.m2.1.1.cmml">⊕</mo><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px1.p3.6.m2.1b"><csymbol cd="latexml" id="S3.SS2.SSS2.Px1.p3.6.m2.1.1.cmml" xref="S3.SS2.SSS2.Px1.p3.6.m2.1.1">direct-sum</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px1.p3.6.m2.1c">\oplus</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.Px1.p3.6.m2.1d">⊕</annotation></semantics></math> to produce the final Distribution <math alttext="D_{\text{res}}" class="ltx_Math" display="inline" id="S3.SS2.SSS2.Px1.p3.7.m3.1"><semantics id="S3.SS2.SSS2.Px1.p3.7.m3.1a"><msub id="S3.SS2.SSS2.Px1.p3.7.m3.1.1" xref="S3.SS2.SSS2.Px1.p3.7.m3.1.1.cmml"><mi id="S3.SS2.SSS2.Px1.p3.7.m3.1.1.2" xref="S3.SS2.SSS2.Px1.p3.7.m3.1.1.2.cmml">D</mi><mtext id="S3.SS2.SSS2.Px1.p3.7.m3.1.1.3" xref="S3.SS2.SSS2.Px1.p3.7.m3.1.1.3a.cmml">res</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px1.p3.7.m3.1b"><apply id="S3.SS2.SSS2.Px1.p3.7.m3.1.1.cmml" xref="S3.SS2.SSS2.Px1.p3.7.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px1.p3.7.m3.1.1.1.cmml" xref="S3.SS2.SSS2.Px1.p3.7.m3.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.Px1.p3.7.m3.1.1.2.cmml" xref="S3.SS2.SSS2.Px1.p3.7.m3.1.1.2">𝐷</ci><ci id="S3.SS2.SSS2.Px1.p3.7.m3.1.1.3a.cmml" xref="S3.SS2.SSS2.Px1.p3.7.m3.1.1.3"><mtext id="S3.SS2.SSS2.Px1.p3.7.m3.1.1.3.cmml" mathsize="70%" xref="S3.SS2.SSS2.Px1.p3.7.m3.1.1.3">res</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px1.p3.7.m3.1c">D_{\text{res}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.Px1.p3.7.m3.1d">italic_D start_POSTSUBSCRIPT res end_POSTSUBSCRIPT</annotation></semantics></math>:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="D_{\text{res}}=\lambda\ s\ .\ \bigoplus\ \{\ t\ |\ t\in M(s)\ \}" class="ltx_Math" display="block" id="S3.E3.m1.4"><semantics id="S3.E3.m1.4a"><mrow id="S3.E3.m1.4.4.2" xref="S3.E3.m1.4.4.3.cmml"><mrow id="S3.E3.m1.3.3.1.1" xref="S3.E3.m1.3.3.1.1.cmml"><msub id="S3.E3.m1.3.3.1.1.2" xref="S3.E3.m1.3.3.1.1.2.cmml"><mi id="S3.E3.m1.3.3.1.1.2.2" xref="S3.E3.m1.3.3.1.1.2.2.cmml">D</mi><mtext id="S3.E3.m1.3.3.1.1.2.3" xref="S3.E3.m1.3.3.1.1.2.3a.cmml">res</mtext></msub><mo id="S3.E3.m1.3.3.1.1.1" xref="S3.E3.m1.3.3.1.1.1.cmml">=</mo><mrow id="S3.E3.m1.3.3.1.1.3" xref="S3.E3.m1.3.3.1.1.3.cmml"><mi id="S3.E3.m1.3.3.1.1.3.2" xref="S3.E3.m1.3.3.1.1.3.2.cmml">λ</mi><mo id="S3.E3.m1.3.3.1.1.3.1" lspace="0.500em" xref="S3.E3.m1.3.3.1.1.3.1.cmml">⁢</mo><mi id="S3.E3.m1.3.3.1.1.3.3" xref="S3.E3.m1.3.3.1.1.3.3.cmml">s</mi></mrow></mrow><mo id="S3.E3.m1.4.4.2.3" lspace="0.500em" rspace="0.500em" xref="S3.E3.m1.4.4.3a.cmml">.</mo><mrow id="S3.E3.m1.4.4.2.2" xref="S3.E3.m1.4.4.2.2.cmml"><mo id="S3.E3.m1.4.4.2.2.2" movablelimits="false" rspace="0.500em" xref="S3.E3.m1.4.4.2.2.2.cmml">⨁</mo><mrow id="S3.E3.m1.4.4.2.2.1.1" xref="S3.E3.m1.4.4.2.2.1.2.cmml"><mo id="S3.E3.m1.4.4.2.2.1.1.2" rspace="0.500em" stretchy="false" xref="S3.E3.m1.4.4.2.2.1.2.1.cmml">{</mo><mi id="S3.E3.m1.2.2" xref="S3.E3.m1.2.2.cmml">t</mi><mo id="S3.E3.m1.4.4.2.2.1.1.3" lspace="0.500em" rspace="0.500em" xref="S3.E3.m1.4.4.2.2.1.2.1.cmml">|</mo><mrow id="S3.E3.m1.4.4.2.2.1.1.1" xref="S3.E3.m1.4.4.2.2.1.1.1.cmml"><mi id="S3.E3.m1.4.4.2.2.1.1.1.2" xref="S3.E3.m1.4.4.2.2.1.1.1.2.cmml">t</mi><mo id="S3.E3.m1.4.4.2.2.1.1.1.1" xref="S3.E3.m1.4.4.2.2.1.1.1.1.cmml">∈</mo><mrow id="S3.E3.m1.4.4.2.2.1.1.1.3" xref="S3.E3.m1.4.4.2.2.1.1.1.3.cmml"><mi id="S3.E3.m1.4.4.2.2.1.1.1.3.2" xref="S3.E3.m1.4.4.2.2.1.1.1.3.2.cmml">M</mi><mo id="S3.E3.m1.4.4.2.2.1.1.1.3.1" xref="S3.E3.m1.4.4.2.2.1.1.1.3.1.cmml">⁢</mo><mrow id="S3.E3.m1.4.4.2.2.1.1.1.3.3.2" xref="S3.E3.m1.4.4.2.2.1.1.1.3.cmml"><mo id="S3.E3.m1.4.4.2.2.1.1.1.3.3.2.1" stretchy="false" xref="S3.E3.m1.4.4.2.2.1.1.1.3.cmml">(</mo><mi id="S3.E3.m1.1.1" xref="S3.E3.m1.1.1.cmml">s</mi><mo id="S3.E3.m1.4.4.2.2.1.1.1.3.3.2.2" rspace="0.500em" stretchy="false" xref="S3.E3.m1.4.4.2.2.1.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E3.m1.4.4.2.2.1.1.4" stretchy="false" xref="S3.E3.m1.4.4.2.2.1.2.1.cmml">}</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.4b"><apply id="S3.E3.m1.4.4.3.cmml" xref="S3.E3.m1.4.4.2"><csymbol cd="ambiguous" id="S3.E3.m1.4.4.3a.cmml" xref="S3.E3.m1.4.4.2.3">formulae-sequence</csymbol><apply id="S3.E3.m1.3.3.1.1.cmml" xref="S3.E3.m1.3.3.1.1"><eq id="S3.E3.m1.3.3.1.1.1.cmml" xref="S3.E3.m1.3.3.1.1.1"></eq><apply id="S3.E3.m1.3.3.1.1.2.cmml" xref="S3.E3.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.3.3.1.1.2.1.cmml" xref="S3.E3.m1.3.3.1.1.2">subscript</csymbol><ci id="S3.E3.m1.3.3.1.1.2.2.cmml" xref="S3.E3.m1.3.3.1.1.2.2">𝐷</ci><ci id="S3.E3.m1.3.3.1.1.2.3a.cmml" xref="S3.E3.m1.3.3.1.1.2.3"><mtext id="S3.E3.m1.3.3.1.1.2.3.cmml" mathsize="70%" xref="S3.E3.m1.3.3.1.1.2.3">res</mtext></ci></apply><apply id="S3.E3.m1.3.3.1.1.3.cmml" xref="S3.E3.m1.3.3.1.1.3"><times id="S3.E3.m1.3.3.1.1.3.1.cmml" xref="S3.E3.m1.3.3.1.1.3.1"></times><ci id="S3.E3.m1.3.3.1.1.3.2.cmml" xref="S3.E3.m1.3.3.1.1.3.2">𝜆</ci><ci id="S3.E3.m1.3.3.1.1.3.3.cmml" xref="S3.E3.m1.3.3.1.1.3.3">𝑠</ci></apply></apply><apply id="S3.E3.m1.4.4.2.2.cmml" xref="S3.E3.m1.4.4.2.2"><csymbol cd="latexml" id="S3.E3.m1.4.4.2.2.2.cmml" xref="S3.E3.m1.4.4.2.2.2">direct-sum</csymbol><apply id="S3.E3.m1.4.4.2.2.1.2.cmml" xref="S3.E3.m1.4.4.2.2.1.1"><csymbol cd="latexml" id="S3.E3.m1.4.4.2.2.1.2.1.cmml" xref="S3.E3.m1.4.4.2.2.1.1.2">conditional-set</csymbol><ci id="S3.E3.m1.2.2.cmml" xref="S3.E3.m1.2.2">𝑡</ci><apply id="S3.E3.m1.4.4.2.2.1.1.1.cmml" xref="S3.E3.m1.4.4.2.2.1.1.1"><in id="S3.E3.m1.4.4.2.2.1.1.1.1.cmml" xref="S3.E3.m1.4.4.2.2.1.1.1.1"></in><ci id="S3.E3.m1.4.4.2.2.1.1.1.2.cmml" xref="S3.E3.m1.4.4.2.2.1.1.1.2">𝑡</ci><apply id="S3.E3.m1.4.4.2.2.1.1.1.3.cmml" xref="S3.E3.m1.4.4.2.2.1.1.1.3"><times id="S3.E3.m1.4.4.2.2.1.1.1.3.1.cmml" xref="S3.E3.m1.4.4.2.2.1.1.1.3.1"></times><ci id="S3.E3.m1.4.4.2.2.1.1.1.3.2.cmml" xref="S3.E3.m1.4.4.2.2.1.1.1.3.2">𝑀</ci><ci id="S3.E3.m1.1.1.cmml" xref="S3.E3.m1.1.1">𝑠</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.4c">D_{\text{res}}=\lambda\ s\ .\ \bigoplus\ \{\ t\ |\ t\in M(s)\ \}</annotation><annotation encoding="application/x-llamapun" id="S3.E3.m1.4d">italic_D start_POSTSUBSCRIPT res end_POSTSUBSCRIPT = italic_λ italic_s . ⨁ { italic_t | italic_t ∈ italic_M ( italic_s ) }</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.SSS2.Px1.p3.8">Since the tags here are PyTorch tensors representing probabilities, the implementations of the conjunction and disjunction
operations are dictated by the underlying provenance used by the program.
A more detailed explanation of the provenances is provided in Section <a class="ltx_ref" href="https://arxiv.org/html/2410.03348v1#S3.SS3" title="3.3 Dolphin Provenances ‣ 3 The Dolphin Framework ‣ 2 Overview ‣ Dolphin: A Programmable Framework for Scalable Neurosymbolic Learning"><span class="ltx_text ltx_ref_tag">3.3</span></a>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS2.SSS2.Px1.p4">
<p class="ltx_p" id="S3.SS2.SSS2.Px1.p4.1"><span class="ltx_text ltx_font_bold ltx_font_smallcaps" id="S3.SS2.SSS2.Px1.p4.1.1">Filter<span class="ltx_text ltx_font_upright" id="S3.SS2.SSS2.Px1.p4.1.1.1">.</span></span>
The <span class="ltx_text ltx_font_smallcaps" id="S3.SS2.SSS2.Px1.p4.1.2">Filter</span> operation is used to filter out symbols from a Distribution based on some condition.
It takes in a single Distribution, along with a user-defined function that returns a boolean value, which acts as the condition.
This operation then returns a new Distribution that contains only the symbols that satisfy the condition, along with their tags.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS2.SSS2.Px1.p5">
<p class="ltx_p" id="S3.SS2.SSS2.Px1.p5.6"><span class="ltx_text ltx_font_bold ltx_font_smallcaps" id="S3.SS2.SSS2.Px1.p5.6.1">ApplyIf<span class="ltx_text ltx_font_upright" id="S3.SS2.SSS2.Px1.p5.6.1.1">.</span></span>
The <span class="ltx_text ltx_font_smallcaps" id="S3.SS2.SSS2.Px1.p5.6.2">ApplyIf</span> operation is a conditional version of <span class="ltx_text ltx_font_smallcaps" id="S3.SS2.SSS2.Px1.p5.6.3">Apply</span>.
It takes in <math alttext="K" class="ltx_Math" display="inline" id="S3.SS2.SSS2.Px1.p5.1.m1.1"><semantics id="S3.SS2.SSS2.Px1.p5.1.m1.1a"><mi id="S3.SS2.SSS2.Px1.p5.1.m1.1.1" xref="S3.SS2.SSS2.Px1.p5.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px1.p5.1.m1.1b"><ci id="S3.SS2.SSS2.Px1.p5.1.m1.1.1.cmml" xref="S3.SS2.SSS2.Px1.p5.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px1.p5.1.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.Px1.p5.1.m1.1d">italic_K</annotation></semantics></math> Distributions and two functions <math alttext="f_{\textit{apply}}" class="ltx_Math" display="inline" id="S3.SS2.SSS2.Px1.p5.2.m2.1"><semantics id="S3.SS2.SSS2.Px1.p5.2.m2.1a"><msub id="S3.SS2.SSS2.Px1.p5.2.m2.1.1" xref="S3.SS2.SSS2.Px1.p5.2.m2.1.1.cmml"><mi id="S3.SS2.SSS2.Px1.p5.2.m2.1.1.2" xref="S3.SS2.SSS2.Px1.p5.2.m2.1.1.2.cmml">f</mi><mtext class="ltx_mathvariant_italic" id="S3.SS2.SSS2.Px1.p5.2.m2.1.1.3" xref="S3.SS2.SSS2.Px1.p5.2.m2.1.1.3a.cmml">apply</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px1.p5.2.m2.1b"><apply id="S3.SS2.SSS2.Px1.p5.2.m2.1.1.cmml" xref="S3.SS2.SSS2.Px1.p5.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px1.p5.2.m2.1.1.1.cmml" xref="S3.SS2.SSS2.Px1.p5.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.Px1.p5.2.m2.1.1.2.cmml" xref="S3.SS2.SSS2.Px1.p5.2.m2.1.1.2">𝑓</ci><ci id="S3.SS2.SSS2.Px1.p5.2.m2.1.1.3a.cmml" xref="S3.SS2.SSS2.Px1.p5.2.m2.1.1.3"><mtext class="ltx_mathvariant_italic" id="S3.SS2.SSS2.Px1.p5.2.m2.1.1.3.cmml" mathsize="70%" xref="S3.SS2.SSS2.Px1.p5.2.m2.1.1.3">apply</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px1.p5.2.m2.1c">f_{\textit{apply}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.Px1.p5.2.m2.1d">italic_f start_POSTSUBSCRIPT apply end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="f_{\textit{cond}}" class="ltx_Math" display="inline" id="S3.SS2.SSS2.Px1.p5.3.m3.1"><semantics id="S3.SS2.SSS2.Px1.p5.3.m3.1a"><msub id="S3.SS2.SSS2.Px1.p5.3.m3.1.1" xref="S3.SS2.SSS2.Px1.p5.3.m3.1.1.cmml"><mi id="S3.SS2.SSS2.Px1.p5.3.m3.1.1.2" xref="S3.SS2.SSS2.Px1.p5.3.m3.1.1.2.cmml">f</mi><mtext class="ltx_mathvariant_italic" id="S3.SS2.SSS2.Px1.p5.3.m3.1.1.3" xref="S3.SS2.SSS2.Px1.p5.3.m3.1.1.3a.cmml">cond</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px1.p5.3.m3.1b"><apply id="S3.SS2.SSS2.Px1.p5.3.m3.1.1.cmml" xref="S3.SS2.SSS2.Px1.p5.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px1.p5.3.m3.1.1.1.cmml" xref="S3.SS2.SSS2.Px1.p5.3.m3.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.Px1.p5.3.m3.1.1.2.cmml" xref="S3.SS2.SSS2.Px1.p5.3.m3.1.1.2">𝑓</ci><ci id="S3.SS2.SSS2.Px1.p5.3.m3.1.1.3a.cmml" xref="S3.SS2.SSS2.Px1.p5.3.m3.1.1.3"><mtext class="ltx_mathvariant_italic" id="S3.SS2.SSS2.Px1.p5.3.m3.1.1.3.cmml" mathsize="70%" xref="S3.SS2.SSS2.Px1.p5.3.m3.1.1.3">cond</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px1.p5.3.m3.1c">f_{\textit{cond}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.Px1.p5.3.m3.1d">italic_f start_POSTSUBSCRIPT cond end_POSTSUBSCRIPT</annotation></semantics></math> of the same arity.
For each combination of symbols from the <math alttext="K" class="ltx_Math" display="inline" id="S3.SS2.SSS2.Px1.p5.4.m4.1"><semantics id="S3.SS2.SSS2.Px1.p5.4.m4.1a"><mi id="S3.SS2.SSS2.Px1.p5.4.m4.1.1" xref="S3.SS2.SSS2.Px1.p5.4.m4.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px1.p5.4.m4.1b"><ci id="S3.SS2.SSS2.Px1.p5.4.m4.1.1.cmml" xref="S3.SS2.SSS2.Px1.p5.4.m4.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px1.p5.4.m4.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.Px1.p5.4.m4.1d">italic_K</annotation></semantics></math> Distributions, <span class="ltx_text ltx_font_smallcaps" id="S3.SS2.SSS2.Px1.p5.6.4">ApplyIf</span> computes the results of <math alttext="f_{\textit{apply}}" class="ltx_Math" display="inline" id="S3.SS2.SSS2.Px1.p5.5.m5.1"><semantics id="S3.SS2.SSS2.Px1.p5.5.m5.1a"><msub id="S3.SS2.SSS2.Px1.p5.5.m5.1.1" xref="S3.SS2.SSS2.Px1.p5.5.m5.1.1.cmml"><mi id="S3.SS2.SSS2.Px1.p5.5.m5.1.1.2" xref="S3.SS2.SSS2.Px1.p5.5.m5.1.1.2.cmml">f</mi><mtext class="ltx_mathvariant_italic" id="S3.SS2.SSS2.Px1.p5.5.m5.1.1.3" xref="S3.SS2.SSS2.Px1.p5.5.m5.1.1.3a.cmml">apply</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px1.p5.5.m5.1b"><apply id="S3.SS2.SSS2.Px1.p5.5.m5.1.1.cmml" xref="S3.SS2.SSS2.Px1.p5.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px1.p5.5.m5.1.1.1.cmml" xref="S3.SS2.SSS2.Px1.p5.5.m5.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.Px1.p5.5.m5.1.1.2.cmml" xref="S3.SS2.SSS2.Px1.p5.5.m5.1.1.2">𝑓</ci><ci id="S3.SS2.SSS2.Px1.p5.5.m5.1.1.3a.cmml" xref="S3.SS2.SSS2.Px1.p5.5.m5.1.1.3"><mtext class="ltx_mathvariant_italic" id="S3.SS2.SSS2.Px1.p5.5.m5.1.1.3.cmml" mathsize="70%" xref="S3.SS2.SSS2.Px1.p5.5.m5.1.1.3">apply</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px1.p5.5.m5.1c">f_{\textit{apply}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.Px1.p5.5.m5.1d">italic_f start_POSTSUBSCRIPT apply end_POSTSUBSCRIPT</annotation></semantics></math> and
its associated tags only if the condition <math alttext="f_{\textit{cond}}" class="ltx_Math" display="inline" id="S3.SS2.SSS2.Px1.p5.6.m6.1"><semantics id="S3.SS2.SSS2.Px1.p5.6.m6.1a"><msub id="S3.SS2.SSS2.Px1.p5.6.m6.1.1" xref="S3.SS2.SSS2.Px1.p5.6.m6.1.1.cmml"><mi id="S3.SS2.SSS2.Px1.p5.6.m6.1.1.2" xref="S3.SS2.SSS2.Px1.p5.6.m6.1.1.2.cmml">f</mi><mtext class="ltx_mathvariant_italic" id="S3.SS2.SSS2.Px1.p5.6.m6.1.1.3" xref="S3.SS2.SSS2.Px1.p5.6.m6.1.1.3a.cmml">cond</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px1.p5.6.m6.1b"><apply id="S3.SS2.SSS2.Px1.p5.6.m6.1.1.cmml" xref="S3.SS2.SSS2.Px1.p5.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px1.p5.6.m6.1.1.1.cmml" xref="S3.SS2.SSS2.Px1.p5.6.m6.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.Px1.p5.6.m6.1.1.2.cmml" xref="S3.SS2.SSS2.Px1.p5.6.m6.1.1.2">𝑓</ci><ci id="S3.SS2.SSS2.Px1.p5.6.m6.1.1.3a.cmml" xref="S3.SS2.SSS2.Px1.p5.6.m6.1.1.3"><mtext class="ltx_mathvariant_italic" id="S3.SS2.SSS2.Px1.p5.6.m6.1.1.3.cmml" mathsize="70%" xref="S3.SS2.SSS2.Px1.p5.6.m6.1.1.3">cond</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px1.p5.6.m6.1c">f_{\textit{cond}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.Px1.p5.6.m6.1d">italic_f start_POSTSUBSCRIPT cond end_POSTSUBSCRIPT</annotation></semantics></math> is satisfied over that combination of symbols.
The operation then returns a new Distribution with these results and tags.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS2.SSS2.Px1.p6">
<p class="ltx_p" id="S3.SS2.SSS2.Px1.p6.1"><span class="ltx_text ltx_font_bold ltx_font_smallcaps" id="S3.SS2.SSS2.Px1.p6.1.1">Union<span class="ltx_text ltx_font_upright" id="S3.SS2.SSS2.Px1.p6.1.1.1">.</span></span>
The <span class="ltx_text ltx_font_smallcaps" id="S3.SS2.SSS2.Px1.p6.1.2">Union</span> operation is used to combine two Distributions.
It takes in two Distributions and returns a new Distribution that contains the union of the symbols from the two input Distributions, along with their tags.
Any symbols common to both input Distributions have their tags merged via a disjunction operation.
<span class="ltx_text ltx_font_smallcaps" id="S3.SS2.SSS2.Px1.p6.1.3">Union</span> is especially useful when writing recursive programs in <span class="ltx_text ltx_font_smallcaps" id="S3.SS2.SSS2.Px1.p6.1.4">Dolphin</span> that require combining the results of multiple recursive calls.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS2.SSS2.Px1.p7">
<p class="ltx_p" id="S3.SS2.SSS2.Px1.p7.1"><span class="ltx_text ltx_font_bold ltx_font_smallcaps" id="S3.SS2.SSS2.Px1.p7.1.1">GetProbs<span class="ltx_text ltx_font_upright" id="S3.SS2.SSS2.Px1.p7.1.1.1">.</span></span>
The <span class="ltx_text ltx_font_smallcaps" id="S3.SS2.SSS2.Px1.p7.1.2">GetProbs</span> operation is used to extract the probabilities from the tags of a Distribution.
This is used mainly once the symbolic program has been executed to extract the final probabilities of the symbols in the output Distribution.
These probabilities can then be used to compute the loss function for training the neural components of the neurosymbolic model.
The actual extraction of the probabilities from the tags depends on the specific provenance used in the program, which we discuss next.</p>
</div>
</section>
</section>
</section>
<section class="ltx_subsection" id="S3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span><span class="ltx_text ltx_font_smallcaps" id="S3.SS3.1.1">Dolphin</span> Provenances</h3>
<div class="ltx_para ltx_noindent" id="S3.SS3.p1">
<p class="ltx_p" id="S3.SS3.p1.1">As discussed earlier, each symbol in a distribution is associated with a batch of one or more tags.
The <span class="ltx_text ltx_font_smallcaps" id="S3.SS3.p1.1.1">Dolphin</span> primitives define how to manipulate certain tags.
For instance, Equations (<a class="ltx_ref" href="https://arxiv.org/html/2410.03348v1#S3.E1" title="In Apply. ‣ 3.2.2 Operations ‣ 3.2 The Dolphin Syntax ‣ 3 The Dolphin Framework ‣ 2 Overview ‣ Dolphin: A Programmable Framework for Scalable Neurosymbolic Learning"><span class="ltx_text ltx_ref_tag">1</span></a>) and (<a class="ltx_ref" href="https://arxiv.org/html/2410.03348v1#S3.E3" title="In Apply. ‣ 3.2.2 Operations ‣ 3.2 The Dolphin Syntax ‣ 3 The Dolphin Framework ‣ 2 Overview ‣ Dolphin: A Programmable Framework for Scalable Neurosymbolic Learning"><span class="ltx_text ltx_ref_tag">3</span></a>) specify the tags to be conjuncted or disjuncted.
We now define the semantics of these operations.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS3.p2">
<p class="ltx_p" id="S3.SS3.p2.1">The goal of such operations is to approximate the probabilities of the symbols in the output distribution as accurately as possible.
This is achieved by using a mathematical framework called <span class="ltx_text ltx_font_italic" id="S3.SS3.p2.1.1">provenance semirings</span> <cite class="ltx_cite ltx_citemacro_citep">(Green et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03348v1#bib.bib4" title="">2007</a>)</cite>.
Provenance semirings provide generalized algebraic structure to propagate tags when computing over tagged data.
In the case of <span class="ltx_text ltx_font_smallcaps" id="S3.SS3.p2.1.2">Dolphin</span> distributions, we can view the tags as representing the probabilities, and the data as the distribution’s symbols.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS3.p3">
<p class="ltx_p" id="S3.SS3.p3.1">Designing and implementing provenances can be challenging since they must be accurate enough to capture the semantics
of the symbolic program, while at the same time being coarse enough to maintain computational feasibility.
Furthermore, the provenances must be differentiable to enable end-to-end training for neurosymbolic tasks.
While neurosymbolic frameworks like Scallop <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03348v1#bib.bib9" title="">2023</a>)</cite> implement differentiable provenances, they
are not designed to leverage hardware accelerations or batched optimizations due to the CPU-bound nature of their implementations.
We thus design vectorized provenances in <span class="ltx_text ltx_font_smallcaps" id="S3.SS3.p3.1.1">Dolphin</span> that are differentiable and enable GPU computations.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS3.p4">
<p class="ltx_p" id="S3.SS3.p4.6">We simplify the definition of provenances from Scallop as a 5-tuple: <math alttext="(T,\mathbf{0},\mathbf{1},\otimes,\oplus)" class="ltx_Math" display="inline" id="S3.SS3.p4.1.m1.5"><semantics id="S3.SS3.p4.1.m1.5a"><mrow id="S3.SS3.p4.1.m1.5.6.2" xref="S3.SS3.p4.1.m1.5.6.1.cmml"><mo id="S3.SS3.p4.1.m1.5.6.2.1" stretchy="false" xref="S3.SS3.p4.1.m1.5.6.1.cmml">(</mo><mi id="S3.SS3.p4.1.m1.1.1" xref="S3.SS3.p4.1.m1.1.1.cmml">T</mi><mo id="S3.SS3.p4.1.m1.5.6.2.2" xref="S3.SS3.p4.1.m1.5.6.1.cmml">,</mo><mn id="S3.SS3.p4.1.m1.2.2" xref="S3.SS3.p4.1.m1.2.2.cmml">𝟎</mn><mo id="S3.SS3.p4.1.m1.5.6.2.3" xref="S3.SS3.p4.1.m1.5.6.1.cmml">,</mo><mn id="S3.SS3.p4.1.m1.3.3" xref="S3.SS3.p4.1.m1.3.3.cmml">𝟏</mn><mo id="S3.SS3.p4.1.m1.5.6.2.4" rspace="0em" xref="S3.SS3.p4.1.m1.5.6.1.cmml">,</mo><mo id="S3.SS3.p4.1.m1.4.4" lspace="0em" rspace="0em" xref="S3.SS3.p4.1.m1.4.4.cmml">⊗</mo><mo id="S3.SS3.p4.1.m1.5.6.2.5" rspace="0em" xref="S3.SS3.p4.1.m1.5.6.1.cmml">,</mo><mo id="S3.SS3.p4.1.m1.5.5" lspace="0em" rspace="0em" xref="S3.SS3.p4.1.m1.5.5.cmml">⊕</mo><mo id="S3.SS3.p4.1.m1.5.6.2.6" stretchy="false" xref="S3.SS3.p4.1.m1.5.6.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.1.m1.5b"><vector id="S3.SS3.p4.1.m1.5.6.1.cmml" xref="S3.SS3.p4.1.m1.5.6.2"><ci id="S3.SS3.p4.1.m1.1.1.cmml" xref="S3.SS3.p4.1.m1.1.1">𝑇</ci><cn id="S3.SS3.p4.1.m1.2.2.cmml" type="integer" xref="S3.SS3.p4.1.m1.2.2">0</cn><cn id="S3.SS3.p4.1.m1.3.3.cmml" type="integer" xref="S3.SS3.p4.1.m1.3.3">1</cn><csymbol cd="latexml" id="S3.SS3.p4.1.m1.4.4.cmml" xref="S3.SS3.p4.1.m1.4.4">tensor-product</csymbol><csymbol cd="latexml" id="S3.SS3.p4.1.m1.5.5.cmml" xref="S3.SS3.p4.1.m1.5.5">direct-sum</csymbol></vector></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.1.m1.5c">(T,\mathbf{0},\mathbf{1},\otimes,\oplus)</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p4.1.m1.5d">( italic_T , bold_0 , bold_1 , ⊗ , ⊕ )</annotation></semantics></math>.
Here, <math alttext="T" class="ltx_Math" display="inline" id="S3.SS3.p4.2.m2.1"><semantics id="S3.SS3.p4.2.m2.1a"><mi id="S3.SS3.p4.2.m2.1.1" xref="S3.SS3.p4.2.m2.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.2.m2.1b"><ci id="S3.SS3.p4.2.m2.1.1.cmml" xref="S3.SS3.p4.2.m2.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.2.m2.1c">T</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p4.2.m2.1d">italic_T</annotation></semantics></math> is the tag space, <math alttext="\otimes:T\times T\to T" class="ltx_math_unparsed" display="inline" id="S3.SS3.p4.3.m3.2"><semantics id="S3.SS3.p4.3.m3.2a"><mrow id="S3.SS3.p4.3.m3.2b"><mo id="S3.SS3.p4.3.m3.1.1" rspace="0em">⊗</mo><mo id="S3.SS3.p4.3.m3.2.2" rspace="0.278em">:</mo><mi id="S3.SS3.p4.3.m3.2.3">T</mi><mo id="S3.SS3.p4.3.m3.2.4" lspace="0.222em" rspace="0.222em">×</mo><mi id="S3.SS3.p4.3.m3.2.5">T</mi><mo id="S3.SS3.p4.3.m3.2.6" stretchy="false">→</mo><mi id="S3.SS3.p4.3.m3.2.7">T</mi></mrow><annotation encoding="application/x-tex" id="S3.SS3.p4.3.m3.2c">\otimes:T\times T\to T</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p4.3.m3.2d">⊗ : italic_T × italic_T → italic_T</annotation></semantics></math> is the conjunction operator with identity <math alttext="\mathbf{0}" class="ltx_Math" display="inline" id="S3.SS3.p4.4.m4.1"><semantics id="S3.SS3.p4.4.m4.1a"><mn id="S3.SS3.p4.4.m4.1.1" xref="S3.SS3.p4.4.m4.1.1.cmml">𝟎</mn><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.4.m4.1b"><cn id="S3.SS3.p4.4.m4.1.1.cmml" type="integer" xref="S3.SS3.p4.4.m4.1.1">0</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.4.m4.1c">\mathbf{0}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p4.4.m4.1d">bold_0</annotation></semantics></math>,
and <math alttext="\oplus:T\times T\to T" class="ltx_math_unparsed" display="inline" id="S3.SS3.p4.5.m5.2"><semantics id="S3.SS3.p4.5.m5.2a"><mrow id="S3.SS3.p4.5.m5.2b"><mo id="S3.SS3.p4.5.m5.1.1" rspace="0em">⊕</mo><mo id="S3.SS3.p4.5.m5.2.2" rspace="0.278em">:</mo><mi id="S3.SS3.p4.5.m5.2.3">T</mi><mo id="S3.SS3.p4.5.m5.2.4" lspace="0.222em" rspace="0.222em">×</mo><mi id="S3.SS3.p4.5.m5.2.5">T</mi><mo id="S3.SS3.p4.5.m5.2.6" stretchy="false">→</mo><mi id="S3.SS3.p4.5.m5.2.7">T</mi></mrow><annotation encoding="application/x-tex" id="S3.SS3.p4.5.m5.2c">\oplus:T\times T\to T</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p4.5.m5.2d">⊕ : italic_T × italic_T → italic_T</annotation></semantics></math> is the disjunction operator with identity <math alttext="\mathbf{1}" class="ltx_Math" display="inline" id="S3.SS3.p4.6.m6.1"><semantics id="S3.SS3.p4.6.m6.1a"><mn id="S3.SS3.p4.6.m6.1.1" xref="S3.SS3.p4.6.m6.1.1.cmml">𝟏</mn><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.6.m6.1b"><cn id="S3.SS3.p4.6.m6.1.1.cmml" type="integer" xref="S3.SS3.p4.6.m6.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.6.m6.1c">\mathbf{1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p4.6.m6.1d">bold_1</annotation></semantics></math>.
We then implement two differentiable provenances in <span class="ltx_text ltx_font_smallcaps" id="S3.SS3.p4.6.1">Dolphin</span>: Differentiable Add-Mult Probabilities (DAMP) and
Differentiable Top-K Proofs (DTKP).
Table <a class="ltx_ref" href="https://arxiv.org/html/2410.03348v1#S3.T1" title="Table 1 ‣ 3.3 Dolphin Provenances ‣ 3 The Dolphin Framework ‣ 2 Overview ‣ Dolphin: A Programmable Framework for Scalable Neurosymbolic Learning"><span class="ltx_text ltx_ref_tag">1</span></a> summarizes the operations of these provenances.</p>
</div>
<figure class="ltx_table" id="S3.T1">
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S3.T1.12" style="width:397.5pt;height:51.8pt;vertical-align:-0.9pt;"><span class="ltx_transformed_inner" style="transform:translate(-15.9pt,2.0pt) scale(0.925860570308117,0.925860570308117) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S3.T1.12.12">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S3.T1.4.4.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt" id="S3.T1.4.4.4.5" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.4.4.4.5.1">Provenance</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" id="S3.T1.4.4.4.6" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.4.4.4.6.1">Domain</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" id="S3.T1.1.1.1.1" style="padding-left:2.0pt;padding-right:2.0pt;"><math alttext="\mathbf{0}" class="ltx_Math" display="inline" id="S3.T1.1.1.1.1.m1.1"><semantics id="S3.T1.1.1.1.1.m1.1a"><mn id="S3.T1.1.1.1.1.m1.1.1" xref="S3.T1.1.1.1.1.m1.1.1.cmml">𝟎</mn><annotation-xml encoding="MathML-Content" id="S3.T1.1.1.1.1.m1.1b"><cn id="S3.T1.1.1.1.1.m1.1.1.cmml" type="integer" xref="S3.T1.1.1.1.1.m1.1.1">0</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.1.1.1.1.m1.1c">\mathbf{0}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.1.1.1.1.m1.1d">bold_0</annotation></semantics></math></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" id="S3.T1.2.2.2.2" style="padding-left:2.0pt;padding-right:2.0pt;"><math alttext="\mathbf{1}" class="ltx_Math" display="inline" id="S3.T1.2.2.2.2.m1.1"><semantics id="S3.T1.2.2.2.2.m1.1a"><mn id="S3.T1.2.2.2.2.m1.1.1" xref="S3.T1.2.2.2.2.m1.1.1.cmml">𝟏</mn><annotation-xml encoding="MathML-Content" id="S3.T1.2.2.2.2.m1.1b"><cn id="S3.T1.2.2.2.2.m1.1.1.cmml" type="integer" xref="S3.T1.2.2.2.2.m1.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.2.2.2.2.m1.1c">\mathbf{1}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.2.2.2.2.m1.1d">bold_1</annotation></semantics></math></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" id="S3.T1.3.3.3.3" style="padding-left:2.0pt;padding-right:2.0pt;"><math alttext="t\oplus t^{\prime}" class="ltx_Math" display="inline" id="S3.T1.3.3.3.3.m1.1"><semantics id="S3.T1.3.3.3.3.m1.1a"><mrow id="S3.T1.3.3.3.3.m1.1.1" xref="S3.T1.3.3.3.3.m1.1.1.cmml"><mi id="S3.T1.3.3.3.3.m1.1.1.2" xref="S3.T1.3.3.3.3.m1.1.1.2.cmml">t</mi><mo id="S3.T1.3.3.3.3.m1.1.1.1" xref="S3.T1.3.3.3.3.m1.1.1.1.cmml">⊕</mo><msup id="S3.T1.3.3.3.3.m1.1.1.3" xref="S3.T1.3.3.3.3.m1.1.1.3.cmml"><mi id="S3.T1.3.3.3.3.m1.1.1.3.2" xref="S3.T1.3.3.3.3.m1.1.1.3.2.cmml">t</mi><mo id="S3.T1.3.3.3.3.m1.1.1.3.3" xref="S3.T1.3.3.3.3.m1.1.1.3.3.cmml">′</mo></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.T1.3.3.3.3.m1.1b"><apply id="S3.T1.3.3.3.3.m1.1.1.cmml" xref="S3.T1.3.3.3.3.m1.1.1"><csymbol cd="latexml" id="S3.T1.3.3.3.3.m1.1.1.1.cmml" xref="S3.T1.3.3.3.3.m1.1.1.1">direct-sum</csymbol><ci id="S3.T1.3.3.3.3.m1.1.1.2.cmml" xref="S3.T1.3.3.3.3.m1.1.1.2">𝑡</ci><apply id="S3.T1.3.3.3.3.m1.1.1.3.cmml" xref="S3.T1.3.3.3.3.m1.1.1.3"><csymbol cd="ambiguous" id="S3.T1.3.3.3.3.m1.1.1.3.1.cmml" xref="S3.T1.3.3.3.3.m1.1.1.3">superscript</csymbol><ci id="S3.T1.3.3.3.3.m1.1.1.3.2.cmml" xref="S3.T1.3.3.3.3.m1.1.1.3.2">𝑡</ci><ci id="S3.T1.3.3.3.3.m1.1.1.3.3.cmml" xref="S3.T1.3.3.3.3.m1.1.1.3.3">′</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.3.3.3.3.m1.1c">t\oplus t^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.3.3.3.3.m1.1d">italic_t ⊕ italic_t start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S3.T1.4.4.4.4" style="padding-left:2.0pt;padding-right:2.0pt;"><math alttext="t\otimes t^{\prime}" class="ltx_Math" display="inline" id="S3.T1.4.4.4.4.m1.1"><semantics id="S3.T1.4.4.4.4.m1.1a"><mrow id="S3.T1.4.4.4.4.m1.1.1" xref="S3.T1.4.4.4.4.m1.1.1.cmml"><mi id="S3.T1.4.4.4.4.m1.1.1.2" xref="S3.T1.4.4.4.4.m1.1.1.2.cmml">t</mi><mo id="S3.T1.4.4.4.4.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.T1.4.4.4.4.m1.1.1.1.cmml">⊗</mo><msup id="S3.T1.4.4.4.4.m1.1.1.3" xref="S3.T1.4.4.4.4.m1.1.1.3.cmml"><mi id="S3.T1.4.4.4.4.m1.1.1.3.2" xref="S3.T1.4.4.4.4.m1.1.1.3.2.cmml">t</mi><mo id="S3.T1.4.4.4.4.m1.1.1.3.3" xref="S3.T1.4.4.4.4.m1.1.1.3.3.cmml">′</mo></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.T1.4.4.4.4.m1.1b"><apply id="S3.T1.4.4.4.4.m1.1.1.cmml" xref="S3.T1.4.4.4.4.m1.1.1"><csymbol cd="latexml" id="S3.T1.4.4.4.4.m1.1.1.1.cmml" xref="S3.T1.4.4.4.4.m1.1.1.1">tensor-product</csymbol><ci id="S3.T1.4.4.4.4.m1.1.1.2.cmml" xref="S3.T1.4.4.4.4.m1.1.1.2">𝑡</ci><apply id="S3.T1.4.4.4.4.m1.1.1.3.cmml" xref="S3.T1.4.4.4.4.m1.1.1.3"><csymbol cd="ambiguous" id="S3.T1.4.4.4.4.m1.1.1.3.1.cmml" xref="S3.T1.4.4.4.4.m1.1.1.3">superscript</csymbol><ci id="S3.T1.4.4.4.4.m1.1.1.3.2.cmml" xref="S3.T1.4.4.4.4.m1.1.1.3.2">𝑡</ci><ci id="S3.T1.4.4.4.4.m1.1.1.3.3.cmml" xref="S3.T1.4.4.4.4.m1.1.1.3.3">′</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.4.4.4.4.m1.1c">t\otimes t^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.4.4.4.4.m1.1d">italic_t ⊗ italic_t start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S3.T1.7.7.7">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S3.T1.7.7.7.4" style="padding-left:2.0pt;padding-right:2.0pt;">DAMP</th>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T1.5.5.5.1" style="padding-left:2.0pt;padding-right:2.0pt;"><math alttext="[0,1]" class="ltx_Math" display="inline" id="S3.T1.5.5.5.1.m1.2"><semantics id="S3.T1.5.5.5.1.m1.2a"><mrow id="S3.T1.5.5.5.1.m1.2.3.2" xref="S3.T1.5.5.5.1.m1.2.3.1.cmml"><mo id="S3.T1.5.5.5.1.m1.2.3.2.1" stretchy="false" xref="S3.T1.5.5.5.1.m1.2.3.1.cmml">[</mo><mn id="S3.T1.5.5.5.1.m1.1.1" xref="S3.T1.5.5.5.1.m1.1.1.cmml">0</mn><mo id="S3.T1.5.5.5.1.m1.2.3.2.2" xref="S3.T1.5.5.5.1.m1.2.3.1.cmml">,</mo><mn id="S3.T1.5.5.5.1.m1.2.2" xref="S3.T1.5.5.5.1.m1.2.2.cmml">1</mn><mo id="S3.T1.5.5.5.1.m1.2.3.2.3" stretchy="false" xref="S3.T1.5.5.5.1.m1.2.3.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.T1.5.5.5.1.m1.2b"><interval closure="closed" id="S3.T1.5.5.5.1.m1.2.3.1.cmml" xref="S3.T1.5.5.5.1.m1.2.3.2"><cn id="S3.T1.5.5.5.1.m1.1.1.cmml" type="integer" xref="S3.T1.5.5.5.1.m1.1.1">0</cn><cn id="S3.T1.5.5.5.1.m1.2.2.cmml" type="integer" xref="S3.T1.5.5.5.1.m1.2.2">1</cn></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.5.5.5.1.m1.2c">[0,1]</annotation><annotation encoding="application/x-llamapun" id="S3.T1.5.5.5.1.m1.2d">[ 0 , 1 ]</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T1.7.7.7.5" style="padding-left:2.0pt;padding-right:2.0pt;">0</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T1.7.7.7.6" style="padding-left:2.0pt;padding-right:2.0pt;">1</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T1.6.6.6.2" style="padding-left:2.0pt;padding-right:2.0pt;"><math alttext="\text{clamp}_{0}^{1}(t+t^{\prime})" class="ltx_Math" display="inline" id="S3.T1.6.6.6.2.m1.1"><semantics id="S3.T1.6.6.6.2.m1.1a"><mrow id="S3.T1.6.6.6.2.m1.1.1" xref="S3.T1.6.6.6.2.m1.1.1.cmml"><msubsup id="S3.T1.6.6.6.2.m1.1.1.3" xref="S3.T1.6.6.6.2.m1.1.1.3.cmml"><mtext id="S3.T1.6.6.6.2.m1.1.1.3.2.2" xref="S3.T1.6.6.6.2.m1.1.1.3.2.2a.cmml">clamp</mtext><mn id="S3.T1.6.6.6.2.m1.1.1.3.2.3" xref="S3.T1.6.6.6.2.m1.1.1.3.2.3.cmml">0</mn><mn id="S3.T1.6.6.6.2.m1.1.1.3.3" xref="S3.T1.6.6.6.2.m1.1.1.3.3.cmml">1</mn></msubsup><mo id="S3.T1.6.6.6.2.m1.1.1.2" xref="S3.T1.6.6.6.2.m1.1.1.2.cmml">⁢</mo><mrow id="S3.T1.6.6.6.2.m1.1.1.1.1" xref="S3.T1.6.6.6.2.m1.1.1.1.1.1.cmml"><mo id="S3.T1.6.6.6.2.m1.1.1.1.1.2" stretchy="false" xref="S3.T1.6.6.6.2.m1.1.1.1.1.1.cmml">(</mo><mrow id="S3.T1.6.6.6.2.m1.1.1.1.1.1" xref="S3.T1.6.6.6.2.m1.1.1.1.1.1.cmml"><mi id="S3.T1.6.6.6.2.m1.1.1.1.1.1.2" xref="S3.T1.6.6.6.2.m1.1.1.1.1.1.2.cmml">t</mi><mo id="S3.T1.6.6.6.2.m1.1.1.1.1.1.1" xref="S3.T1.6.6.6.2.m1.1.1.1.1.1.1.cmml">+</mo><msup id="S3.T1.6.6.6.2.m1.1.1.1.1.1.3" xref="S3.T1.6.6.6.2.m1.1.1.1.1.1.3.cmml"><mi id="S3.T1.6.6.6.2.m1.1.1.1.1.1.3.2" xref="S3.T1.6.6.6.2.m1.1.1.1.1.1.3.2.cmml">t</mi><mo id="S3.T1.6.6.6.2.m1.1.1.1.1.1.3.3" xref="S3.T1.6.6.6.2.m1.1.1.1.1.1.3.3.cmml">′</mo></msup></mrow><mo id="S3.T1.6.6.6.2.m1.1.1.1.1.3" stretchy="false" xref="S3.T1.6.6.6.2.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.T1.6.6.6.2.m1.1b"><apply id="S3.T1.6.6.6.2.m1.1.1.cmml" xref="S3.T1.6.6.6.2.m1.1.1"><times id="S3.T1.6.6.6.2.m1.1.1.2.cmml" xref="S3.T1.6.6.6.2.m1.1.1.2"></times><apply id="S3.T1.6.6.6.2.m1.1.1.3.cmml" xref="S3.T1.6.6.6.2.m1.1.1.3"><csymbol cd="ambiguous" id="S3.T1.6.6.6.2.m1.1.1.3.1.cmml" xref="S3.T1.6.6.6.2.m1.1.1.3">superscript</csymbol><apply id="S3.T1.6.6.6.2.m1.1.1.3.2.cmml" xref="S3.T1.6.6.6.2.m1.1.1.3"><csymbol cd="ambiguous" id="S3.T1.6.6.6.2.m1.1.1.3.2.1.cmml" xref="S3.T1.6.6.6.2.m1.1.1.3">subscript</csymbol><ci id="S3.T1.6.6.6.2.m1.1.1.3.2.2a.cmml" xref="S3.T1.6.6.6.2.m1.1.1.3.2.2"><mtext id="S3.T1.6.6.6.2.m1.1.1.3.2.2.cmml" xref="S3.T1.6.6.6.2.m1.1.1.3.2.2">clamp</mtext></ci><cn id="S3.T1.6.6.6.2.m1.1.1.3.2.3.cmml" type="integer" xref="S3.T1.6.6.6.2.m1.1.1.3.2.3">0</cn></apply><cn id="S3.T1.6.6.6.2.m1.1.1.3.3.cmml" type="integer" xref="S3.T1.6.6.6.2.m1.1.1.3.3">1</cn></apply><apply id="S3.T1.6.6.6.2.m1.1.1.1.1.1.cmml" xref="S3.T1.6.6.6.2.m1.1.1.1.1"><plus id="S3.T1.6.6.6.2.m1.1.1.1.1.1.1.cmml" xref="S3.T1.6.6.6.2.m1.1.1.1.1.1.1"></plus><ci id="S3.T1.6.6.6.2.m1.1.1.1.1.1.2.cmml" xref="S3.T1.6.6.6.2.m1.1.1.1.1.1.2">𝑡</ci><apply id="S3.T1.6.6.6.2.m1.1.1.1.1.1.3.cmml" xref="S3.T1.6.6.6.2.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.T1.6.6.6.2.m1.1.1.1.1.1.3.1.cmml" xref="S3.T1.6.6.6.2.m1.1.1.1.1.1.3">superscript</csymbol><ci id="S3.T1.6.6.6.2.m1.1.1.1.1.1.3.2.cmml" xref="S3.T1.6.6.6.2.m1.1.1.1.1.1.3.2">𝑡</ci><ci id="S3.T1.6.6.6.2.m1.1.1.1.1.1.3.3.cmml" xref="S3.T1.6.6.6.2.m1.1.1.1.1.1.3.3">′</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.6.6.6.2.m1.1c">\text{clamp}_{0}^{1}(t+t^{\prime})</annotation><annotation encoding="application/x-llamapun" id="S3.T1.6.6.6.2.m1.1d">clamp start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT ( italic_t + italic_t start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT )</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.7.7.7.3" style="padding-left:2.0pt;padding-right:2.0pt;"><math alttext="t\cdot t^{\prime}" class="ltx_Math" display="inline" id="S3.T1.7.7.7.3.m1.1"><semantics id="S3.T1.7.7.7.3.m1.1a"><mrow id="S3.T1.7.7.7.3.m1.1.1" xref="S3.T1.7.7.7.3.m1.1.1.cmml"><mi id="S3.T1.7.7.7.3.m1.1.1.2" xref="S3.T1.7.7.7.3.m1.1.1.2.cmml">t</mi><mo id="S3.T1.7.7.7.3.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.T1.7.7.7.3.m1.1.1.1.cmml">⋅</mo><msup id="S3.T1.7.7.7.3.m1.1.1.3" xref="S3.T1.7.7.7.3.m1.1.1.3.cmml"><mi id="S3.T1.7.7.7.3.m1.1.1.3.2" xref="S3.T1.7.7.7.3.m1.1.1.3.2.cmml">t</mi><mo id="S3.T1.7.7.7.3.m1.1.1.3.3" xref="S3.T1.7.7.7.3.m1.1.1.3.3.cmml">′</mo></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.T1.7.7.7.3.m1.1b"><apply id="S3.T1.7.7.7.3.m1.1.1.cmml" xref="S3.T1.7.7.7.3.m1.1.1"><ci id="S3.T1.7.7.7.3.m1.1.1.1.cmml" xref="S3.T1.7.7.7.3.m1.1.1.1">⋅</ci><ci id="S3.T1.7.7.7.3.m1.1.1.2.cmml" xref="S3.T1.7.7.7.3.m1.1.1.2">𝑡</ci><apply id="S3.T1.7.7.7.3.m1.1.1.3.cmml" xref="S3.T1.7.7.7.3.m1.1.1.3"><csymbol cd="ambiguous" id="S3.T1.7.7.7.3.m1.1.1.3.1.cmml" xref="S3.T1.7.7.7.3.m1.1.1.3">superscript</csymbol><ci id="S3.T1.7.7.7.3.m1.1.1.3.2.cmml" xref="S3.T1.7.7.7.3.m1.1.1.3.2">𝑡</ci><ci id="S3.T1.7.7.7.3.m1.1.1.3.3.cmml" xref="S3.T1.7.7.7.3.m1.1.1.3.3">′</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.7.7.7.3.m1.1c">t\cdot t^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.7.7.7.3.m1.1d">italic_t ⋅ italic_t start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S3.T1.12.12.12">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_r" id="S3.T1.12.12.12.6" style="padding-left:2.0pt;padding-right:2.0pt;">DTKP-AM</th>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S3.T1.8.8.8.1" style="padding-left:2.0pt;padding-right:2.0pt;"><math alttext="[0,1]\cup\{\infty,-\infty\}" class="ltx_Math" display="inline" id="S3.T1.8.8.8.1.m1.4"><semantics id="S3.T1.8.8.8.1.m1.4a"><mrow id="S3.T1.8.8.8.1.m1.4.4" xref="S3.T1.8.8.8.1.m1.4.4.cmml"><mrow id="S3.T1.8.8.8.1.m1.4.4.3.2" xref="S3.T1.8.8.8.1.m1.4.4.3.1.cmml"><mo id="S3.T1.8.8.8.1.m1.4.4.3.2.1" stretchy="false" xref="S3.T1.8.8.8.1.m1.4.4.3.1.cmml">[</mo><mn id="S3.T1.8.8.8.1.m1.1.1" xref="S3.T1.8.8.8.1.m1.1.1.cmml">0</mn><mo id="S3.T1.8.8.8.1.m1.4.4.3.2.2" xref="S3.T1.8.8.8.1.m1.4.4.3.1.cmml">,</mo><mn id="S3.T1.8.8.8.1.m1.2.2" xref="S3.T1.8.8.8.1.m1.2.2.cmml">1</mn><mo id="S3.T1.8.8.8.1.m1.4.4.3.2.3" stretchy="false" xref="S3.T1.8.8.8.1.m1.4.4.3.1.cmml">]</mo></mrow><mo id="S3.T1.8.8.8.1.m1.4.4.2" xref="S3.T1.8.8.8.1.m1.4.4.2.cmml">∪</mo><mrow id="S3.T1.8.8.8.1.m1.4.4.1.1" xref="S3.T1.8.8.8.1.m1.4.4.1.2.cmml"><mo id="S3.T1.8.8.8.1.m1.4.4.1.1.2" stretchy="false" xref="S3.T1.8.8.8.1.m1.4.4.1.2.cmml">{</mo><mi id="S3.T1.8.8.8.1.m1.3.3" mathvariant="normal" xref="S3.T1.8.8.8.1.m1.3.3.cmml">∞</mi><mo id="S3.T1.8.8.8.1.m1.4.4.1.1.3" xref="S3.T1.8.8.8.1.m1.4.4.1.2.cmml">,</mo><mrow id="S3.T1.8.8.8.1.m1.4.4.1.1.1" xref="S3.T1.8.8.8.1.m1.4.4.1.1.1.cmml"><mo id="S3.T1.8.8.8.1.m1.4.4.1.1.1a" xref="S3.T1.8.8.8.1.m1.4.4.1.1.1.cmml">−</mo><mi id="S3.T1.8.8.8.1.m1.4.4.1.1.1.2" mathvariant="normal" xref="S3.T1.8.8.8.1.m1.4.4.1.1.1.2.cmml">∞</mi></mrow><mo id="S3.T1.8.8.8.1.m1.4.4.1.1.4" stretchy="false" xref="S3.T1.8.8.8.1.m1.4.4.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.T1.8.8.8.1.m1.4b"><apply id="S3.T1.8.8.8.1.m1.4.4.cmml" xref="S3.T1.8.8.8.1.m1.4.4"><union id="S3.T1.8.8.8.1.m1.4.4.2.cmml" xref="S3.T1.8.8.8.1.m1.4.4.2"></union><interval closure="closed" id="S3.T1.8.8.8.1.m1.4.4.3.1.cmml" xref="S3.T1.8.8.8.1.m1.4.4.3.2"><cn id="S3.T1.8.8.8.1.m1.1.1.cmml" type="integer" xref="S3.T1.8.8.8.1.m1.1.1">0</cn><cn id="S3.T1.8.8.8.1.m1.2.2.cmml" type="integer" xref="S3.T1.8.8.8.1.m1.2.2">1</cn></interval><set id="S3.T1.8.8.8.1.m1.4.4.1.2.cmml" xref="S3.T1.8.8.8.1.m1.4.4.1.1"><infinity id="S3.T1.8.8.8.1.m1.3.3.cmml" xref="S3.T1.8.8.8.1.m1.3.3"></infinity><apply id="S3.T1.8.8.8.1.m1.4.4.1.1.1.cmml" xref="S3.T1.8.8.8.1.m1.4.4.1.1.1"><minus id="S3.T1.8.8.8.1.m1.4.4.1.1.1.1.cmml" xref="S3.T1.8.8.8.1.m1.4.4.1.1.1"></minus><infinity id="S3.T1.8.8.8.1.m1.4.4.1.1.1.2.cmml" xref="S3.T1.8.8.8.1.m1.4.4.1.1.1.2"></infinity></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.8.8.8.1.m1.4c">[0,1]\cup\{\infty,-\infty\}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.8.8.8.1.m1.4d">[ 0 , 1 ] ∪ { ∞ , - ∞ }</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S3.T1.9.9.9.2" style="padding-left:2.0pt;padding-right:2.0pt;"><math alttext="\mathbf{\hat{0}}_{ij}=\begin{cases}\infty&amp;i=1\\
-\infty&amp;i&gt;1\end{cases}" class="ltx_Math" display="inline" id="S3.T1.9.9.9.2.m1.4"><semantics id="S3.T1.9.9.9.2.m1.4a"><mrow id="S3.T1.9.9.9.2.m1.4.5" xref="S3.T1.9.9.9.2.m1.4.5.cmml"><msub id="S3.T1.9.9.9.2.m1.4.5.2" xref="S3.T1.9.9.9.2.m1.4.5.2.cmml"><mover accent="true" id="S3.T1.9.9.9.2.m1.4.5.2.2" xref="S3.T1.9.9.9.2.m1.4.5.2.2.cmml"><mn id="S3.T1.9.9.9.2.m1.4.5.2.2.2" xref="S3.T1.9.9.9.2.m1.4.5.2.2.2.cmml">𝟎</mn><mo id="S3.T1.9.9.9.2.m1.4.5.2.2.1" xref="S3.T1.9.9.9.2.m1.4.5.2.2.1.cmml">^</mo></mover><mrow id="S3.T1.9.9.9.2.m1.4.5.2.3" xref="S3.T1.9.9.9.2.m1.4.5.2.3.cmml"><mi id="S3.T1.9.9.9.2.m1.4.5.2.3.2" xref="S3.T1.9.9.9.2.m1.4.5.2.3.2.cmml">i</mi><mo id="S3.T1.9.9.9.2.m1.4.5.2.3.1" xref="S3.T1.9.9.9.2.m1.4.5.2.3.1.cmml">⁢</mo><mi id="S3.T1.9.9.9.2.m1.4.5.2.3.3" xref="S3.T1.9.9.9.2.m1.4.5.2.3.3.cmml">j</mi></mrow></msub><mo id="S3.T1.9.9.9.2.m1.4.5.1" xref="S3.T1.9.9.9.2.m1.4.5.1.cmml">=</mo><mrow id="S3.T1.9.9.9.2.m1.4.4" xref="S3.T1.9.9.9.2.m1.4.5.3.1.cmml"><mo id="S3.T1.9.9.9.2.m1.4.4.5" xref="S3.T1.9.9.9.2.m1.4.5.3.1.1.cmml">{</mo><mtable columnspacing="5pt" id="S3.T1.9.9.9.2.m1.4.4.4" rowspacing="0pt" xref="S3.T1.9.9.9.2.m1.4.5.3.1.cmml"><mtr id="S3.T1.9.9.9.2.m1.4.4.4a" xref="S3.T1.9.9.9.2.m1.4.5.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S3.T1.9.9.9.2.m1.4.4.4b" xref="S3.T1.9.9.9.2.m1.4.5.3.1.cmml"><mi id="S3.T1.9.9.9.2.m1.1.1.1.1.1.1" mathvariant="normal" xref="S3.T1.9.9.9.2.m1.1.1.1.1.1.1.cmml">∞</mi></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.T1.9.9.9.2.m1.4.4.4c" xref="S3.T1.9.9.9.2.m1.4.5.3.1.cmml"><mrow id="S3.T1.9.9.9.2.m1.2.2.2.2.2.1" xref="S3.T1.9.9.9.2.m1.2.2.2.2.2.1.cmml"><mi id="S3.T1.9.9.9.2.m1.2.2.2.2.2.1.2" xref="S3.T1.9.9.9.2.m1.2.2.2.2.2.1.2.cmml">i</mi><mo id="S3.T1.9.9.9.2.m1.2.2.2.2.2.1.1" xref="S3.T1.9.9.9.2.m1.2.2.2.2.2.1.1.cmml">=</mo><mn id="S3.T1.9.9.9.2.m1.2.2.2.2.2.1.3" xref="S3.T1.9.9.9.2.m1.2.2.2.2.2.1.3.cmml">1</mn></mrow></mtd></mtr><mtr id="S3.T1.9.9.9.2.m1.4.4.4d" xref="S3.T1.9.9.9.2.m1.4.5.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S3.T1.9.9.9.2.m1.4.4.4e" xref="S3.T1.9.9.9.2.m1.4.5.3.1.cmml"><mrow id="S3.T1.9.9.9.2.m1.3.3.3.3.1.1" xref="S3.T1.9.9.9.2.m1.3.3.3.3.1.1.cmml"><mo id="S3.T1.9.9.9.2.m1.3.3.3.3.1.1a" xref="S3.T1.9.9.9.2.m1.3.3.3.3.1.1.cmml">−</mo><mi id="S3.T1.9.9.9.2.m1.3.3.3.3.1.1.2" mathvariant="normal" xref="S3.T1.9.9.9.2.m1.3.3.3.3.1.1.2.cmml">∞</mi></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.T1.9.9.9.2.m1.4.4.4f" xref="S3.T1.9.9.9.2.m1.4.5.3.1.cmml"><mrow id="S3.T1.9.9.9.2.m1.4.4.4.4.2.1" xref="S3.T1.9.9.9.2.m1.4.4.4.4.2.1.cmml"><mi id="S3.T1.9.9.9.2.m1.4.4.4.4.2.1.2" xref="S3.T1.9.9.9.2.m1.4.4.4.4.2.1.2.cmml">i</mi><mo id="S3.T1.9.9.9.2.m1.4.4.4.4.2.1.1" xref="S3.T1.9.9.9.2.m1.4.4.4.4.2.1.1.cmml">&gt;</mo><mn id="S3.T1.9.9.9.2.m1.4.4.4.4.2.1.3" xref="S3.T1.9.9.9.2.m1.4.4.4.4.2.1.3.cmml">1</mn></mrow></mtd></mtr></mtable></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.T1.9.9.9.2.m1.4b"><apply id="S3.T1.9.9.9.2.m1.4.5.cmml" xref="S3.T1.9.9.9.2.m1.4.5"><eq id="S3.T1.9.9.9.2.m1.4.5.1.cmml" xref="S3.T1.9.9.9.2.m1.4.5.1"></eq><apply id="S3.T1.9.9.9.2.m1.4.5.2.cmml" xref="S3.T1.9.9.9.2.m1.4.5.2"><csymbol cd="ambiguous" id="S3.T1.9.9.9.2.m1.4.5.2.1.cmml" xref="S3.T1.9.9.9.2.m1.4.5.2">subscript</csymbol><apply id="S3.T1.9.9.9.2.m1.4.5.2.2.cmml" xref="S3.T1.9.9.9.2.m1.4.5.2.2"><ci id="S3.T1.9.9.9.2.m1.4.5.2.2.1.cmml" xref="S3.T1.9.9.9.2.m1.4.5.2.2.1">^</ci><cn id="S3.T1.9.9.9.2.m1.4.5.2.2.2.cmml" type="integer" xref="S3.T1.9.9.9.2.m1.4.5.2.2.2">0</cn></apply><apply id="S3.T1.9.9.9.2.m1.4.5.2.3.cmml" xref="S3.T1.9.9.9.2.m1.4.5.2.3"><times id="S3.T1.9.9.9.2.m1.4.5.2.3.1.cmml" xref="S3.T1.9.9.9.2.m1.4.5.2.3.1"></times><ci id="S3.T1.9.9.9.2.m1.4.5.2.3.2.cmml" xref="S3.T1.9.9.9.2.m1.4.5.2.3.2">𝑖</ci><ci id="S3.T1.9.9.9.2.m1.4.5.2.3.3.cmml" xref="S3.T1.9.9.9.2.m1.4.5.2.3.3">𝑗</ci></apply></apply><apply id="S3.T1.9.9.9.2.m1.4.5.3.1.cmml" xref="S3.T1.9.9.9.2.m1.4.4"><csymbol cd="latexml" id="S3.T1.9.9.9.2.m1.4.5.3.1.1.cmml" xref="S3.T1.9.9.9.2.m1.4.4.5">cases</csymbol><infinity id="S3.T1.9.9.9.2.m1.1.1.1.1.1.1.cmml" xref="S3.T1.9.9.9.2.m1.1.1.1.1.1.1"></infinity><apply id="S3.T1.9.9.9.2.m1.2.2.2.2.2.1.cmml" xref="S3.T1.9.9.9.2.m1.2.2.2.2.2.1"><eq id="S3.T1.9.9.9.2.m1.2.2.2.2.2.1.1.cmml" xref="S3.T1.9.9.9.2.m1.2.2.2.2.2.1.1"></eq><ci id="S3.T1.9.9.9.2.m1.2.2.2.2.2.1.2.cmml" xref="S3.T1.9.9.9.2.m1.2.2.2.2.2.1.2">𝑖</ci><cn id="S3.T1.9.9.9.2.m1.2.2.2.2.2.1.3.cmml" type="integer" xref="S3.T1.9.9.9.2.m1.2.2.2.2.2.1.3">1</cn></apply><apply id="S3.T1.9.9.9.2.m1.3.3.3.3.1.1.cmml" xref="S3.T1.9.9.9.2.m1.3.3.3.3.1.1"><minus id="S3.T1.9.9.9.2.m1.3.3.3.3.1.1.1.cmml" xref="S3.T1.9.9.9.2.m1.3.3.3.3.1.1"></minus><infinity id="S3.T1.9.9.9.2.m1.3.3.3.3.1.1.2.cmml" xref="S3.T1.9.9.9.2.m1.3.3.3.3.1.1.2"></infinity></apply><apply id="S3.T1.9.9.9.2.m1.4.4.4.4.2.1.cmml" xref="S3.T1.9.9.9.2.m1.4.4.4.4.2.1"><gt id="S3.T1.9.9.9.2.m1.4.4.4.4.2.1.1.cmml" xref="S3.T1.9.9.9.2.m1.4.4.4.4.2.1.1"></gt><ci id="S3.T1.9.9.9.2.m1.4.4.4.4.2.1.2.cmml" xref="S3.T1.9.9.9.2.m1.4.4.4.4.2.1.2">𝑖</ci><cn id="S3.T1.9.9.9.2.m1.4.4.4.4.2.1.3.cmml" type="integer" xref="S3.T1.9.9.9.2.m1.4.4.4.4.2.1.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.9.9.9.2.m1.4c">\mathbf{\hat{0}}_{ij}=\begin{cases}\infty&amp;i=1\\
-\infty&amp;i&gt;1\end{cases}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.9.9.9.2.m1.4d">over^ start_ARG bold_0 end_ARG start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT = { start_ROW start_CELL ∞ end_CELL start_CELL italic_i = 1 end_CELL end_ROW start_ROW start_CELL - ∞ end_CELL start_CELL italic_i &gt; 1 end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S3.T1.10.10.10.3" style="padding-left:2.0pt;padding-right:2.0pt;"><math alttext="\mathbf{\hat{1}}_{ij}=\infty" class="ltx_Math" display="inline" id="S3.T1.10.10.10.3.m1.1"><semantics id="S3.T1.10.10.10.3.m1.1a"><mrow id="S3.T1.10.10.10.3.m1.1.1" xref="S3.T1.10.10.10.3.m1.1.1.cmml"><msub id="S3.T1.10.10.10.3.m1.1.1.2" xref="S3.T1.10.10.10.3.m1.1.1.2.cmml"><mover accent="true" id="S3.T1.10.10.10.3.m1.1.1.2.2" xref="S3.T1.10.10.10.3.m1.1.1.2.2.cmml"><mn id="S3.T1.10.10.10.3.m1.1.1.2.2.2" xref="S3.T1.10.10.10.3.m1.1.1.2.2.2.cmml">𝟏</mn><mo id="S3.T1.10.10.10.3.m1.1.1.2.2.1" xref="S3.T1.10.10.10.3.m1.1.1.2.2.1.cmml">^</mo></mover><mrow id="S3.T1.10.10.10.3.m1.1.1.2.3" xref="S3.T1.10.10.10.3.m1.1.1.2.3.cmml"><mi id="S3.T1.10.10.10.3.m1.1.1.2.3.2" xref="S3.T1.10.10.10.3.m1.1.1.2.3.2.cmml">i</mi><mo id="S3.T1.10.10.10.3.m1.1.1.2.3.1" xref="S3.T1.10.10.10.3.m1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.T1.10.10.10.3.m1.1.1.2.3.3" xref="S3.T1.10.10.10.3.m1.1.1.2.3.3.cmml">j</mi></mrow></msub><mo id="S3.T1.10.10.10.3.m1.1.1.1" xref="S3.T1.10.10.10.3.m1.1.1.1.cmml">=</mo><mi id="S3.T1.10.10.10.3.m1.1.1.3" mathvariant="normal" xref="S3.T1.10.10.10.3.m1.1.1.3.cmml">∞</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.T1.10.10.10.3.m1.1b"><apply id="S3.T1.10.10.10.3.m1.1.1.cmml" xref="S3.T1.10.10.10.3.m1.1.1"><eq id="S3.T1.10.10.10.3.m1.1.1.1.cmml" xref="S3.T1.10.10.10.3.m1.1.1.1"></eq><apply id="S3.T1.10.10.10.3.m1.1.1.2.cmml" xref="S3.T1.10.10.10.3.m1.1.1.2"><csymbol cd="ambiguous" id="S3.T1.10.10.10.3.m1.1.1.2.1.cmml" xref="S3.T1.10.10.10.3.m1.1.1.2">subscript</csymbol><apply id="S3.T1.10.10.10.3.m1.1.1.2.2.cmml" xref="S3.T1.10.10.10.3.m1.1.1.2.2"><ci id="S3.T1.10.10.10.3.m1.1.1.2.2.1.cmml" xref="S3.T1.10.10.10.3.m1.1.1.2.2.1">^</ci><cn id="S3.T1.10.10.10.3.m1.1.1.2.2.2.cmml" type="integer" xref="S3.T1.10.10.10.3.m1.1.1.2.2.2">1</cn></apply><apply id="S3.T1.10.10.10.3.m1.1.1.2.3.cmml" xref="S3.T1.10.10.10.3.m1.1.1.2.3"><times id="S3.T1.10.10.10.3.m1.1.1.2.3.1.cmml" xref="S3.T1.10.10.10.3.m1.1.1.2.3.1"></times><ci id="S3.T1.10.10.10.3.m1.1.1.2.3.2.cmml" xref="S3.T1.10.10.10.3.m1.1.1.2.3.2">𝑖</ci><ci id="S3.T1.10.10.10.3.m1.1.1.2.3.3.cmml" xref="S3.T1.10.10.10.3.m1.1.1.2.3.3">𝑗</ci></apply></apply><infinity id="S3.T1.10.10.10.3.m1.1.1.3.cmml" xref="S3.T1.10.10.10.3.m1.1.1.3"></infinity></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.10.10.10.3.m1.1c">\mathbf{\hat{1}}_{ij}=\infty</annotation><annotation encoding="application/x-llamapun" id="S3.T1.10.10.10.3.m1.1d">over^ start_ARG bold_1 end_ARG start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT = ∞</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S3.T1.11.11.11.4" style="padding-left:2.0pt;padding-right:2.0pt;"><math alttext="\text{top}_{k}(\text{cat}(t,t^{\prime}))" class="ltx_Math" display="inline" id="S3.T1.11.11.11.4.m1.2"><semantics id="S3.T1.11.11.11.4.m1.2a"><mrow id="S3.T1.11.11.11.4.m1.2.2" xref="S3.T1.11.11.11.4.m1.2.2.cmml"><msub id="S3.T1.11.11.11.4.m1.2.2.3" xref="S3.T1.11.11.11.4.m1.2.2.3.cmml"><mtext id="S3.T1.11.11.11.4.m1.2.2.3.2" xref="S3.T1.11.11.11.4.m1.2.2.3.2a.cmml">top</mtext><mi id="S3.T1.11.11.11.4.m1.2.2.3.3" xref="S3.T1.11.11.11.4.m1.2.2.3.3.cmml">k</mi></msub><mo id="S3.T1.11.11.11.4.m1.2.2.2" xref="S3.T1.11.11.11.4.m1.2.2.2.cmml">⁢</mo><mrow id="S3.T1.11.11.11.4.m1.2.2.1.1" xref="S3.T1.11.11.11.4.m1.2.2.1.1.1.cmml"><mo id="S3.T1.11.11.11.4.m1.2.2.1.1.2" stretchy="false" xref="S3.T1.11.11.11.4.m1.2.2.1.1.1.cmml">(</mo><mrow id="S3.T1.11.11.11.4.m1.2.2.1.1.1" xref="S3.T1.11.11.11.4.m1.2.2.1.1.1.cmml"><mtext id="S3.T1.11.11.11.4.m1.2.2.1.1.1.3" xref="S3.T1.11.11.11.4.m1.2.2.1.1.1.3a.cmml">cat</mtext><mo id="S3.T1.11.11.11.4.m1.2.2.1.1.1.2" xref="S3.T1.11.11.11.4.m1.2.2.1.1.1.2.cmml">⁢</mo><mrow id="S3.T1.11.11.11.4.m1.2.2.1.1.1.1.1" xref="S3.T1.11.11.11.4.m1.2.2.1.1.1.1.2.cmml"><mo id="S3.T1.11.11.11.4.m1.2.2.1.1.1.1.1.2" stretchy="false" xref="S3.T1.11.11.11.4.m1.2.2.1.1.1.1.2.cmml">(</mo><mi id="S3.T1.11.11.11.4.m1.1.1" xref="S3.T1.11.11.11.4.m1.1.1.cmml">t</mi><mo id="S3.T1.11.11.11.4.m1.2.2.1.1.1.1.1.3" xref="S3.T1.11.11.11.4.m1.2.2.1.1.1.1.2.cmml">,</mo><msup id="S3.T1.11.11.11.4.m1.2.2.1.1.1.1.1.1" xref="S3.T1.11.11.11.4.m1.2.2.1.1.1.1.1.1.cmml"><mi id="S3.T1.11.11.11.4.m1.2.2.1.1.1.1.1.1.2" xref="S3.T1.11.11.11.4.m1.2.2.1.1.1.1.1.1.2.cmml">t</mi><mo id="S3.T1.11.11.11.4.m1.2.2.1.1.1.1.1.1.3" xref="S3.T1.11.11.11.4.m1.2.2.1.1.1.1.1.1.3.cmml">′</mo></msup><mo id="S3.T1.11.11.11.4.m1.2.2.1.1.1.1.1.4" stretchy="false" xref="S3.T1.11.11.11.4.m1.2.2.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.T1.11.11.11.4.m1.2.2.1.1.3" stretchy="false" xref="S3.T1.11.11.11.4.m1.2.2.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.T1.11.11.11.4.m1.2b"><apply id="S3.T1.11.11.11.4.m1.2.2.cmml" xref="S3.T1.11.11.11.4.m1.2.2"><times id="S3.T1.11.11.11.4.m1.2.2.2.cmml" xref="S3.T1.11.11.11.4.m1.2.2.2"></times><apply id="S3.T1.11.11.11.4.m1.2.2.3.cmml" xref="S3.T1.11.11.11.4.m1.2.2.3"><csymbol cd="ambiguous" id="S3.T1.11.11.11.4.m1.2.2.3.1.cmml" xref="S3.T1.11.11.11.4.m1.2.2.3">subscript</csymbol><ci id="S3.T1.11.11.11.4.m1.2.2.3.2a.cmml" xref="S3.T1.11.11.11.4.m1.2.2.3.2"><mtext id="S3.T1.11.11.11.4.m1.2.2.3.2.cmml" xref="S3.T1.11.11.11.4.m1.2.2.3.2">top</mtext></ci><ci id="S3.T1.11.11.11.4.m1.2.2.3.3.cmml" xref="S3.T1.11.11.11.4.m1.2.2.3.3">𝑘</ci></apply><apply id="S3.T1.11.11.11.4.m1.2.2.1.1.1.cmml" xref="S3.T1.11.11.11.4.m1.2.2.1.1"><times id="S3.T1.11.11.11.4.m1.2.2.1.1.1.2.cmml" xref="S3.T1.11.11.11.4.m1.2.2.1.1.1.2"></times><ci id="S3.T1.11.11.11.4.m1.2.2.1.1.1.3a.cmml" xref="S3.T1.11.11.11.4.m1.2.2.1.1.1.3"><mtext id="S3.T1.11.11.11.4.m1.2.2.1.1.1.3.cmml" xref="S3.T1.11.11.11.4.m1.2.2.1.1.1.3">cat</mtext></ci><interval closure="open" id="S3.T1.11.11.11.4.m1.2.2.1.1.1.1.2.cmml" xref="S3.T1.11.11.11.4.m1.2.2.1.1.1.1.1"><ci id="S3.T1.11.11.11.4.m1.1.1.cmml" xref="S3.T1.11.11.11.4.m1.1.1">𝑡</ci><apply id="S3.T1.11.11.11.4.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.T1.11.11.11.4.m1.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.T1.11.11.11.4.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.T1.11.11.11.4.m1.2.2.1.1.1.1.1.1">superscript</csymbol><ci id="S3.T1.11.11.11.4.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S3.T1.11.11.11.4.m1.2.2.1.1.1.1.1.1.2">𝑡</ci><ci id="S3.T1.11.11.11.4.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S3.T1.11.11.11.4.m1.2.2.1.1.1.1.1.1.3">′</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.11.11.11.4.m1.2c">\text{top}_{k}(\text{cat}(t,t^{\prime}))</annotation><annotation encoding="application/x-llamapun" id="S3.T1.11.11.11.4.m1.2d">top start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ( cat ( italic_t , italic_t start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ) )</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T1.12.12.12.5" style="padding-left:2.0pt;padding-right:2.0pt;"><math alttext="\text{top}_{k}([\min(|t_{i}|,|t^{\prime}_{j}|)\mid(t_{i},t^{\prime}_{j})\in t%
\times t^{\prime}])" class="ltx_Math" display="inline" id="S3.T1.12.12.12.5.m1.2"><semantics id="S3.T1.12.12.12.5.m1.2a"><mrow id="S3.T1.12.12.12.5.m1.2.2" xref="S3.T1.12.12.12.5.m1.2.2.cmml"><msub id="S3.T1.12.12.12.5.m1.2.2.3" xref="S3.T1.12.12.12.5.m1.2.2.3.cmml"><mtext id="S3.T1.12.12.12.5.m1.2.2.3.2" xref="S3.T1.12.12.12.5.m1.2.2.3.2a.cmml">top</mtext><mi id="S3.T1.12.12.12.5.m1.2.2.3.3" xref="S3.T1.12.12.12.5.m1.2.2.3.3.cmml">k</mi></msub><mo id="S3.T1.12.12.12.5.m1.2.2.2" xref="S3.T1.12.12.12.5.m1.2.2.2.cmml">⁢</mo><mrow id="S3.T1.12.12.12.5.m1.2.2.1.1" xref="S3.T1.12.12.12.5.m1.2.2.cmml"><mo id="S3.T1.12.12.12.5.m1.2.2.1.1.2" stretchy="false" xref="S3.T1.12.12.12.5.m1.2.2.cmml">(</mo><mrow id="S3.T1.12.12.12.5.m1.2.2.1.1.1.1" xref="S3.T1.12.12.12.5.m1.2.2.1.1.1.2.cmml"><mo id="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.2" stretchy="false" xref="S3.T1.12.12.12.5.m1.2.2.1.1.1.2.1.cmml">[</mo><mrow id="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1" xref="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.cmml"><mrow id="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.4" xref="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.4.cmml"><mrow id="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.2.2.2" xref="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.2.2.3.cmml"><mi id="S3.T1.12.12.12.5.m1.1.1" xref="S3.T1.12.12.12.5.m1.1.1.cmml">min</mi><mo id="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.2.2.2a" xref="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.2.2.3.cmml">⁡</mo><mrow id="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.2.2.2.2" xref="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.2.2.3.cmml"><mo id="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.2.2.2.2.3" stretchy="false" xref="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.2.2.3.cmml">(</mo><mrow id="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.1.1.1.1.1.1" xref="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.cmml"><mo id="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.1.cmml">|</mo><msub id="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">t</mi><mi id="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.1.cmml">|</mo></mrow><mo id="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.2.2.2.2.4" xref="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.2.2.3.cmml">,</mo><mrow id="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.2.2.2.2.2.1" xref="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.2.2.2.2.2.2.cmml"><mo id="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.2.2.2.2.2.1.2" stretchy="false" xref="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.2.2.2.2.2.2.1.cmml">|</mo><msubsup id="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.2.2.2.2.2.1.1" xref="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.2.2.2.2.2.1.1.cmml"><mi id="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.2.2.2.2.2.1.1.2.2" xref="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.2.2.2.2.2.1.1.2.2.cmml">t</mi><mi id="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.2.2.2.2.2.1.1.3" xref="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.2.2.2.2.2.1.1.3.cmml">j</mi><mo id="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.2.2.2.2.2.1.1.2.3" xref="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.2.2.2.2.2.1.1.2.3.cmml">′</mo></msubsup><mo id="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.2.2.2.2.2.1.3" stretchy="false" xref="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.2.2.2.2.2.2.1.cmml">|</mo></mrow><mo id="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.2.2.2.2.5" stretchy="false" xref="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo id="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.4.5" xref="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.4.5.cmml">∣</mo><mrow id="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.4.4.2" xref="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.4.4.3.cmml"><mo id="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.4.4.2.3" stretchy="false" xref="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.4.4.3.cmml">(</mo><msub id="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.3.3.1.1" xref="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.3.3.1.1.cmml"><mi id="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.3.3.1.1.2" xref="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.3.3.1.1.2.cmml">t</mi><mi id="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.3.3.1.1.3" xref="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.3.3.1.1.3.cmml">i</mi></msub><mo id="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.4.4.2.4" xref="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.4.4.3.cmml">,</mo><msubsup id="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.4.4.2.2" xref="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.4.4.2.2.cmml"><mi id="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.4.4.2.2.2.2" xref="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.4.4.2.2.2.2.cmml">t</mi><mi id="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.4.4.2.2.3" xref="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.4.4.2.2.3.cmml">j</mi><mo id="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.4.4.2.2.2.3" xref="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.4.4.2.2.2.3.cmml">′</mo></msubsup><mo id="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.4.4.2.5" stretchy="false" xref="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.4.4.3.cmml">)</mo></mrow></mrow><mo id="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.5" xref="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.5.cmml">∈</mo><mrow id="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.6" xref="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.6.cmml"><mi id="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.6.2" xref="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.6.2.cmml">t</mi><mo id="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.6.1" lspace="0.222em" rspace="0.222em" xref="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.6.1.cmml">×</mo><msup id="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.6.3" xref="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.6.3.cmml"><mi id="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.6.3.2" xref="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.6.3.2.cmml">t</mi><mo id="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.6.3.3" xref="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.6.3.3.cmml">′</mo></msup></mrow></mrow><mo id="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.3" stretchy="false" xref="S3.T1.12.12.12.5.m1.2.2.1.1.1.2.1.cmml">]</mo></mrow><mo id="S3.T1.12.12.12.5.m1.2.2.1.1.3" stretchy="false" xref="S3.T1.12.12.12.5.m1.2.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.T1.12.12.12.5.m1.2b"><apply id="S3.T1.12.12.12.5.m1.2.2.cmml" xref="S3.T1.12.12.12.5.m1.2.2"><times id="S3.T1.12.12.12.5.m1.2.2.2.cmml" xref="S3.T1.12.12.12.5.m1.2.2.2"></times><apply id="S3.T1.12.12.12.5.m1.2.2.3.cmml" xref="S3.T1.12.12.12.5.m1.2.2.3"><csymbol cd="ambiguous" id="S3.T1.12.12.12.5.m1.2.2.3.1.cmml" xref="S3.T1.12.12.12.5.m1.2.2.3">subscript</csymbol><ci id="S3.T1.12.12.12.5.m1.2.2.3.2a.cmml" xref="S3.T1.12.12.12.5.m1.2.2.3.2"><mtext id="S3.T1.12.12.12.5.m1.2.2.3.2.cmml" xref="S3.T1.12.12.12.5.m1.2.2.3.2">top</mtext></ci><ci id="S3.T1.12.12.12.5.m1.2.2.3.3.cmml" xref="S3.T1.12.12.12.5.m1.2.2.3.3">𝑘</ci></apply><apply id="S3.T1.12.12.12.5.m1.2.2.1.1.1.2.cmml" xref="S3.T1.12.12.12.5.m1.2.2.1.1.1.1"><csymbol cd="latexml" id="S3.T1.12.12.12.5.m1.2.2.1.1.1.2.1.cmml" xref="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.cmml" xref="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1"><in id="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.5.cmml" xref="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.5"></in><apply id="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.4.cmml" xref="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.4"><csymbol cd="latexml" id="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.4.5.cmml" xref="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.4.5">conditional</csymbol><apply id="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.2.2.3.cmml" xref="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.2.2.2"><min id="S3.T1.12.12.12.5.m1.1.1.cmml" xref="S3.T1.12.12.12.5.m1.1.1"></min><apply id="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.1.1.1.1.1.1"><abs id="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2"></abs><apply id="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2">𝑡</ci><ci id="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply><apply id="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.2.2.2.2.2.2.cmml" xref="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.2.2.2.2.2.1"><abs id="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.2.2.2.2.2.2.1.cmml" xref="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.2.2.2.2.2.1.2"></abs><apply id="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.2.2.2.2.2.1.1.cmml" xref="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.2.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.2.2.2.2.2.1.1.1.cmml" xref="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.2.2.2.2.2.1.1">subscript</csymbol><apply id="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.2.2.2.2.2.1.1.2.cmml" xref="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.2.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.2.2.2.2.2.1.1.2.1.cmml" xref="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.2.2.2.2.2.1.1">superscript</csymbol><ci id="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.2.2.2.2.2.1.1.2.2.cmml" xref="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.2.2.2.2.2.1.1.2.2">𝑡</ci><ci id="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.2.2.2.2.2.1.1.2.3.cmml" xref="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.2.2.2.2.2.1.1.2.3">′</ci></apply><ci id="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.2.2.2.2.2.1.1.3.cmml" xref="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.2.2.2.2.2.1.1.3">𝑗</ci></apply></apply></apply><interval closure="open" id="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.4.4.3.cmml" xref="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.4.4.2"><apply id="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.3.3.1.1.cmml" xref="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.3.3.1.1"><csymbol cd="ambiguous" id="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.3.3.1.1.1.cmml" xref="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.3.3.1.1">subscript</csymbol><ci id="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.3.3.1.1.2.cmml" xref="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.3.3.1.1.2">𝑡</ci><ci id="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.3.3.1.1.3.cmml" xref="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.3.3.1.1.3">𝑖</ci></apply><apply id="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.4.4.2.2.cmml" xref="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.4.4.2.2"><csymbol cd="ambiguous" id="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.4.4.2.2.1.cmml" xref="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.4.4.2.2">subscript</csymbol><apply id="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.4.4.2.2.2.cmml" xref="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.4.4.2.2"><csymbol cd="ambiguous" id="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.4.4.2.2.2.1.cmml" xref="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.4.4.2.2">superscript</csymbol><ci id="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.4.4.2.2.2.2.cmml" xref="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.4.4.2.2.2.2">𝑡</ci><ci id="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.4.4.2.2.2.3.cmml" xref="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.4.4.2.2.2.3">′</ci></apply><ci id="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.4.4.2.2.3.cmml" xref="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.4.4.2.2.3">𝑗</ci></apply></interval></apply><apply id="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.6.cmml" xref="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.6"><times id="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.6.1.cmml" xref="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.6.1"></times><ci id="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.6.2.cmml" xref="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.6.2">𝑡</ci><apply id="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.6.3.cmml" xref="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.6.3"><csymbol cd="ambiguous" id="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.6.3.1.cmml" xref="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.6.3">superscript</csymbol><ci id="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.6.3.2.cmml" xref="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.6.3.2">𝑡</ci><ci id="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.6.3.3.cmml" xref="S3.T1.12.12.12.5.m1.2.2.1.1.1.1.1.6.3.3">′</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.12.12.12.5.m1.2c">\text{top}_{k}([\min(|t_{i}|,|t^{\prime}_{j}|)\mid(t_{i},t^{\prime}_{j})\in t%
\times t^{\prime}])</annotation><annotation encoding="application/x-llamapun" id="S3.T1.12.12.12.5.m1.2d">top start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ( [ roman_min ( | italic_t start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT | , | italic_t start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT | ) ∣ ( italic_t start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_t start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) ∈ italic_t × italic_t start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ] )</annotation></semantics></math></td>
</tr>
</tbody>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1: </span><span class="ltx_text ltx_font_smallcaps" id="S3.T1.14.1">Dolphin</span> provenances implemented in PyTorch.</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="S3.SS3.p5">
<p class="ltx_p" id="S3.SS3.p5.4"><span class="ltx_text ltx_font_bold" id="S3.SS3.p5.4.1">Differentiable Add-Mult Probabilities.</span>
Differentiable Add-Mult Probabilities (DAMP) is a popular technique that uses the probability space as its tag space: <math alttext="T=[0,1]" class="ltx_Math" display="inline" id="S3.SS3.p5.1.m1.2"><semantics id="S3.SS3.p5.1.m1.2a"><mrow id="S3.SS3.p5.1.m1.2.3" xref="S3.SS3.p5.1.m1.2.3.cmml"><mi id="S3.SS3.p5.1.m1.2.3.2" xref="S3.SS3.p5.1.m1.2.3.2.cmml">T</mi><mo id="S3.SS3.p5.1.m1.2.3.1" xref="S3.SS3.p5.1.m1.2.3.1.cmml">=</mo><mrow id="S3.SS3.p5.1.m1.2.3.3.2" xref="S3.SS3.p5.1.m1.2.3.3.1.cmml"><mo id="S3.SS3.p5.1.m1.2.3.3.2.1" stretchy="false" xref="S3.SS3.p5.1.m1.2.3.3.1.cmml">[</mo><mn id="S3.SS3.p5.1.m1.1.1" xref="S3.SS3.p5.1.m1.1.1.cmml">0</mn><mo id="S3.SS3.p5.1.m1.2.3.3.2.2" xref="S3.SS3.p5.1.m1.2.3.3.1.cmml">,</mo><mn id="S3.SS3.p5.1.m1.2.2" xref="S3.SS3.p5.1.m1.2.2.cmml">1</mn><mo id="S3.SS3.p5.1.m1.2.3.3.2.3" stretchy="false" xref="S3.SS3.p5.1.m1.2.3.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p5.1.m1.2b"><apply id="S3.SS3.p5.1.m1.2.3.cmml" xref="S3.SS3.p5.1.m1.2.3"><eq id="S3.SS3.p5.1.m1.2.3.1.cmml" xref="S3.SS3.p5.1.m1.2.3.1"></eq><ci id="S3.SS3.p5.1.m1.2.3.2.cmml" xref="S3.SS3.p5.1.m1.2.3.2">𝑇</ci><interval closure="closed" id="S3.SS3.p5.1.m1.2.3.3.1.cmml" xref="S3.SS3.p5.1.m1.2.3.3.2"><cn id="S3.SS3.p5.1.m1.1.1.cmml" type="integer" xref="S3.SS3.p5.1.m1.1.1">0</cn><cn id="S3.SS3.p5.1.m1.2.2.cmml" type="integer" xref="S3.SS3.p5.1.m1.2.2">1</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p5.1.m1.2c">T=[0,1]</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p5.1.m1.2d">italic_T = [ 0 , 1 ]</annotation></semantics></math>.
Its conjunction operation <math alttext="\otimes" class="ltx_Math" display="inline" id="S3.SS3.p5.2.m2.1"><semantics id="S3.SS3.p5.2.m2.1a"><mo id="S3.SS3.p5.2.m2.1.1" xref="S3.SS3.p5.2.m2.1.1.cmml">⊗</mo><annotation-xml encoding="MathML-Content" id="S3.SS3.p5.2.m2.1b"><csymbol cd="latexml" id="S3.SS3.p5.2.m2.1.1.cmml" xref="S3.SS3.p5.2.m2.1.1">tensor-product</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p5.2.m2.1c">\otimes</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p5.2.m2.1d">⊗</annotation></semantics></math> is defined as the addition of probabilities, clamped at <math alttext="\mathbf{1}" class="ltx_Math" display="inline" id="S3.SS3.p5.3.m3.1"><semantics id="S3.SS3.p5.3.m3.1a"><mn id="S3.SS3.p5.3.m3.1.1" xref="S3.SS3.p5.3.m3.1.1.cmml">𝟏</mn><annotation-xml encoding="MathML-Content" id="S3.SS3.p5.3.m3.1b"><cn id="S3.SS3.p5.3.m3.1.1.cmml" type="integer" xref="S3.SS3.p5.3.m3.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p5.3.m3.1c">\mathbf{1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p5.3.m3.1d">bold_1</annotation></semantics></math>,
and its disjunction operation <math alttext="\oplus" class="ltx_Math" display="inline" id="S3.SS3.p5.4.m4.1"><semantics id="S3.SS3.p5.4.m4.1a"><mo id="S3.SS3.p5.4.m4.1.1" xref="S3.SS3.p5.4.m4.1.1.cmml">⊕</mo><annotation-xml encoding="MathML-Content" id="S3.SS3.p5.4.m4.1b"><csymbol cd="latexml" id="S3.SS3.p5.4.m4.1.1.cmml" xref="S3.SS3.p5.4.m4.1.1">direct-sum</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p5.4.m4.1c">\oplus</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p5.4.m4.1d">⊕</annotation></semantics></math> is defined as the multiplication of probabilities.
The main assumption underlying the DAMP operations is that the input Distributions are mutually exclusive and
independent.
This assumption allows DAMP to compute probabilities extremely efficiently, as the operations are simple and can be easily
vectorized.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS3.p6">
<p class="ltx_p" id="S3.SS3.p6.3"><span class="ltx_text ltx_font_bold" id="S3.SS3.p6.1.1">Differentiable Top-<math alttext="k" class="ltx_Math" display="inline" id="S3.SS3.p6.1.1.m1.1"><semantics id="S3.SS3.p6.1.1.m1.1a"><mi id="S3.SS3.p6.1.1.m1.1.1" xref="S3.SS3.p6.1.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p6.1.1.m1.1b"><ci id="S3.SS3.p6.1.1.m1.1.1.cmml" xref="S3.SS3.p6.1.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p6.1.1.m1.1c">k</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p6.1.1.m1.1d">italic_k</annotation></semantics></math> Proofs.</span>
Differentiable Top-<math alttext="k" class="ltx_Math" display="inline" id="S3.SS3.p6.2.m1.1"><semantics id="S3.SS3.p6.2.m1.1a"><mi id="S3.SS3.p6.2.m1.1.1" xref="S3.SS3.p6.2.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p6.2.m1.1b"><ci id="S3.SS3.p6.2.m1.1.1.cmml" xref="S3.SS3.p6.2.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p6.2.m1.1c">k</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p6.2.m1.1d">italic_k</annotation></semantics></math> Proofs (DTKP) <cite class="ltx_cite ltx_citemacro_citep">(Huang et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03348v1#bib.bib6" title="">2021</a>)</cite> was proposed to overcome the shortcomings of DAMP.
This provenance tracks a set of up to <math alttext="k" class="ltx_Math" display="inline" id="S3.SS3.p6.3.m2.1"><semantics id="S3.SS3.p6.3.m2.1a"><mi id="S3.SS3.p6.3.m2.1.1" xref="S3.SS3.p6.3.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p6.3.m2.1b"><ci id="S3.SS3.p6.3.m2.1.1.cmml" xref="S3.SS3.p6.3.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p6.3.m2.1c">k</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p6.3.m2.1d">italic_k</annotation></semantics></math> <span class="ltx_text ltx_font_italic" id="S3.SS3.p6.3.2">proofs</span> for each symbol.
Each proof, in turn, denotes the set of input symbols necessary to derive the output symbol.
These proofs are then used to compute the probabilities of the output symbols.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS3.p7">
<p class="ltx_p" id="S3.SS3.p7.1">In Scallop, DTKP tags are converted into probabilities via differentiable weighted model counting (WMC).
This form of DTKP is computationally hard and is by nature difficult
to vectorize due to the varying sizes of proof sets and the WMC procedure.
We therefore design a vectorized version of DTKP, called DTKP-AM (DTKP with Add-Mult), that can be efficiently computed on GPUs.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS3.p8">
<p class="ltx_p" id="S3.SS3.p8.11">We first define the structure of tags in DTKP-AM in a manner that conforms to the constraints of PyTorch tensors.
Each tag <math alttext="t" class="ltx_Math" display="inline" id="S3.SS3.p8.1.m1.1"><semantics id="S3.SS3.p8.1.m1.1a"><mi id="S3.SS3.p8.1.m1.1.1" xref="S3.SS3.p8.1.m1.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p8.1.m1.1b"><ci id="S3.SS3.p8.1.m1.1.1.cmml" xref="S3.SS3.p8.1.m1.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p8.1.m1.1c">t</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p8.1.m1.1d">italic_t</annotation></semantics></math> for a symbol <math alttext="s" class="ltx_Math" display="inline" id="S3.SS3.p8.2.m2.1"><semantics id="S3.SS3.p8.2.m2.1a"><mi id="S3.SS3.p8.2.m2.1.1" xref="S3.SS3.p8.2.m2.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p8.2.m2.1b"><ci id="S3.SS3.p8.2.m2.1.1.cmml" xref="S3.SS3.p8.2.m2.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p8.2.m2.1c">s</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p8.2.m2.1d">italic_s</annotation></semantics></math> is a 2-dimensional tensor of shape <math alttext="(k,|I|)" class="ltx_Math" display="inline" id="S3.SS3.p8.3.m3.3"><semantics id="S3.SS3.p8.3.m3.3a"><mrow id="S3.SS3.p8.3.m3.3.3.1" xref="S3.SS3.p8.3.m3.3.3.2.cmml"><mo id="S3.SS3.p8.3.m3.3.3.1.2" stretchy="false" xref="S3.SS3.p8.3.m3.3.3.2.cmml">(</mo><mi id="S3.SS3.p8.3.m3.2.2" xref="S3.SS3.p8.3.m3.2.2.cmml">k</mi><mo id="S3.SS3.p8.3.m3.3.3.1.3" xref="S3.SS3.p8.3.m3.3.3.2.cmml">,</mo><mrow id="S3.SS3.p8.3.m3.3.3.1.1.2" xref="S3.SS3.p8.3.m3.3.3.1.1.1.cmml"><mo id="S3.SS3.p8.3.m3.3.3.1.1.2.1" stretchy="false" xref="S3.SS3.p8.3.m3.3.3.1.1.1.1.cmml">|</mo><mi id="S3.SS3.p8.3.m3.1.1" xref="S3.SS3.p8.3.m3.1.1.cmml">I</mi><mo id="S3.SS3.p8.3.m3.3.3.1.1.2.2" stretchy="false" xref="S3.SS3.p8.3.m3.3.3.1.1.1.1.cmml">|</mo></mrow><mo id="S3.SS3.p8.3.m3.3.3.1.4" stretchy="false" xref="S3.SS3.p8.3.m3.3.3.2.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p8.3.m3.3b"><interval closure="open" id="S3.SS3.p8.3.m3.3.3.2.cmml" xref="S3.SS3.p8.3.m3.3.3.1"><ci id="S3.SS3.p8.3.m3.2.2.cmml" xref="S3.SS3.p8.3.m3.2.2">𝑘</ci><apply id="S3.SS3.p8.3.m3.3.3.1.1.1.cmml" xref="S3.SS3.p8.3.m3.3.3.1.1.2"><abs id="S3.SS3.p8.3.m3.3.3.1.1.1.1.cmml" xref="S3.SS3.p8.3.m3.3.3.1.1.2.1"></abs><ci id="S3.SS3.p8.3.m3.1.1.cmml" xref="S3.SS3.p8.3.m3.1.1">𝐼</ci></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p8.3.m3.3c">(k,|I|)</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p8.3.m3.3d">( italic_k , | italic_I | )</annotation></semantics></math>, where <math alttext="k" class="ltx_Math" display="inline" id="S3.SS3.p8.4.m4.1"><semantics id="S3.SS3.p8.4.m4.1a"><mi id="S3.SS3.p8.4.m4.1.1" xref="S3.SS3.p8.4.m4.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p8.4.m4.1b"><ci id="S3.SS3.p8.4.m4.1.1.cmml" xref="S3.SS3.p8.4.m4.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p8.4.m4.1c">k</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p8.4.m4.1d">italic_k</annotation></semantics></math> is the maximum number of proofs to be
retained and <math alttext="I" class="ltx_Math" display="inline" id="S3.SS3.p8.5.m5.1"><semantics id="S3.SS3.p8.5.m5.1a"><mi id="S3.SS3.p8.5.m5.1.1" xref="S3.SS3.p8.5.m5.1.1.cmml">I</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p8.5.m5.1b"><ci id="S3.SS3.p8.5.m5.1.1.cmml" xref="S3.SS3.p8.5.m5.1.1">𝐼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p8.5.m5.1c">I</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p8.5.m5.1d">italic_I</annotation></semantics></math> is an ordered list of all <span class="ltx_text ltx_font_italic" id="S3.SS3.p8.11.1">input symbols</span> (symbols that are present in the input Distributions).
Each row <math alttext="t_{i}" class="ltx_Math" display="inline" id="S3.SS3.p8.6.m6.1"><semantics id="S3.SS3.p8.6.m6.1a"><msub id="S3.SS3.p8.6.m6.1.1" xref="S3.SS3.p8.6.m6.1.1.cmml"><mi id="S3.SS3.p8.6.m6.1.1.2" xref="S3.SS3.p8.6.m6.1.1.2.cmml">t</mi><mi id="S3.SS3.p8.6.m6.1.1.3" xref="S3.SS3.p8.6.m6.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p8.6.m6.1b"><apply id="S3.SS3.p8.6.m6.1.1.cmml" xref="S3.SS3.p8.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS3.p8.6.m6.1.1.1.cmml" xref="S3.SS3.p8.6.m6.1.1">subscript</csymbol><ci id="S3.SS3.p8.6.m6.1.1.2.cmml" xref="S3.SS3.p8.6.m6.1.1.2">𝑡</ci><ci id="S3.SS3.p8.6.m6.1.1.3.cmml" xref="S3.SS3.p8.6.m6.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p8.6.m6.1c">t_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p8.6.m6.1d">italic_t start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> of <math alttext="t" class="ltx_Math" display="inline" id="S3.SS3.p8.7.m7.1"><semantics id="S3.SS3.p8.7.m7.1a"><mi id="S3.SS3.p8.7.m7.1.1" xref="S3.SS3.p8.7.m7.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p8.7.m7.1b"><ci id="S3.SS3.p8.7.m7.1.1.cmml" xref="S3.SS3.p8.7.m7.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p8.7.m7.1c">t</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p8.7.m7.1d">italic_t</annotation></semantics></math> corresponds to one of the tag’s <math alttext="k" class="ltx_Math" display="inline" id="S3.SS3.p8.8.m8.1"><semantics id="S3.SS3.p8.8.m8.1a"><mi id="S3.SS3.p8.8.m8.1.1" xref="S3.SS3.p8.8.m8.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p8.8.m8.1b"><ci id="S3.SS3.p8.8.m8.1.1.cmml" xref="S3.SS3.p8.8.m8.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p8.8.m8.1c">k</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p8.8.m8.1d">italic_k</annotation></semantics></math> proofs.
Each element <math alttext="t_{ij}" class="ltx_Math" display="inline" id="S3.SS3.p8.9.m9.1"><semantics id="S3.SS3.p8.9.m9.1a"><msub id="S3.SS3.p8.9.m9.1.1" xref="S3.SS3.p8.9.m9.1.1.cmml"><mi id="S3.SS3.p8.9.m9.1.1.2" xref="S3.SS3.p8.9.m9.1.1.2.cmml">t</mi><mrow id="S3.SS3.p8.9.m9.1.1.3" xref="S3.SS3.p8.9.m9.1.1.3.cmml"><mi id="S3.SS3.p8.9.m9.1.1.3.2" xref="S3.SS3.p8.9.m9.1.1.3.2.cmml">i</mi><mo id="S3.SS3.p8.9.m9.1.1.3.1" xref="S3.SS3.p8.9.m9.1.1.3.1.cmml">⁢</mo><mi id="S3.SS3.p8.9.m9.1.1.3.3" xref="S3.SS3.p8.9.m9.1.1.3.3.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p8.9.m9.1b"><apply id="S3.SS3.p8.9.m9.1.1.cmml" xref="S3.SS3.p8.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS3.p8.9.m9.1.1.1.cmml" xref="S3.SS3.p8.9.m9.1.1">subscript</csymbol><ci id="S3.SS3.p8.9.m9.1.1.2.cmml" xref="S3.SS3.p8.9.m9.1.1.2">𝑡</ci><apply id="S3.SS3.p8.9.m9.1.1.3.cmml" xref="S3.SS3.p8.9.m9.1.1.3"><times id="S3.SS3.p8.9.m9.1.1.3.1.cmml" xref="S3.SS3.p8.9.m9.1.1.3.1"></times><ci id="S3.SS3.p8.9.m9.1.1.3.2.cmml" xref="S3.SS3.p8.9.m9.1.1.3.2">𝑖</ci><ci id="S3.SS3.p8.9.m9.1.1.3.3.cmml" xref="S3.SS3.p8.9.m9.1.1.3.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p8.9.m9.1c">t_{ij}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p8.9.m9.1d">italic_t start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT</annotation></semantics></math> thus represents the probability of the <math alttext="j" class="ltx_Math" display="inline" id="S3.SS3.p8.10.m10.1"><semantics id="S3.SS3.p8.10.m10.1a"><mi id="S3.SS3.p8.10.m10.1.1" xref="S3.SS3.p8.10.m10.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p8.10.m10.1b"><ci id="S3.SS3.p8.10.m10.1.1.cmml" xref="S3.SS3.p8.10.m10.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p8.10.m10.1c">j</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p8.10.m10.1d">italic_j</annotation></semantics></math>th input symbol in the <math alttext="i" class="ltx_Math" display="inline" id="S3.SS3.p8.11.m11.1"><semantics id="S3.SS3.p8.11.m11.1a"><mi id="S3.SS3.p8.11.m11.1.1" xref="S3.SS3.p8.11.m11.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p8.11.m11.1b"><ci id="S3.SS3.p8.11.m11.1.1.cmml" xref="S3.SS3.p8.11.m11.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p8.11.m11.1c">i</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p8.11.m11.1d">italic_i</annotation></semantics></math>th proof:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.Ex4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="t_{ij}=\begin{cases}p_{j}&amp;\text{if the $j$th symbol is present in the $i$th %
proof}\\
\mathbf{\hat{0}}_{ij}&amp;\text{otherwise}\end{cases}" class="ltx_Math" display="block" id="S3.Ex4.m1.5"><semantics id="S3.Ex4.m1.5a"><mrow id="S3.Ex4.m1.5.6" xref="S3.Ex4.m1.5.6.cmml"><msub id="S3.Ex4.m1.5.6.2" xref="S3.Ex4.m1.5.6.2.cmml"><mi id="S3.Ex4.m1.5.6.2.2" xref="S3.Ex4.m1.5.6.2.2.cmml">t</mi><mrow id="S3.Ex4.m1.5.6.2.3" xref="S3.Ex4.m1.5.6.2.3.cmml"><mi id="S3.Ex4.m1.5.6.2.3.2" xref="S3.Ex4.m1.5.6.2.3.2.cmml">i</mi><mo id="S3.Ex4.m1.5.6.2.3.1" xref="S3.Ex4.m1.5.6.2.3.1.cmml">⁢</mo><mi id="S3.Ex4.m1.5.6.2.3.3" xref="S3.Ex4.m1.5.6.2.3.3.cmml">j</mi></mrow></msub><mo id="S3.Ex4.m1.5.6.1" xref="S3.Ex4.m1.5.6.1.cmml">=</mo><mrow id="S3.Ex4.m1.5.5" xref="S3.Ex4.m1.5.6.3.1.cmml"><mo id="S3.Ex4.m1.5.5.6" xref="S3.Ex4.m1.5.6.3.1.1.cmml">{</mo><mtable columnspacing="5pt" displaystyle="true" id="S3.Ex4.m1.5.5.5" rowspacing="0pt" xref="S3.Ex4.m1.5.6.3.1.cmml"><mtr id="S3.Ex4.m1.5.5.5a" xref="S3.Ex4.m1.5.6.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S3.Ex4.m1.5.5.5b" xref="S3.Ex4.m1.5.6.3.1.cmml"><msub id="S3.Ex4.m1.3.3.3.3.3.1" xref="S3.Ex4.m1.3.3.3.3.3.1.cmml"><mi id="S3.Ex4.m1.3.3.3.3.3.1.2" xref="S3.Ex4.m1.3.3.3.3.3.1.2.cmml">p</mi><mi id="S3.Ex4.m1.3.3.3.3.3.1.3" xref="S3.Ex4.m1.3.3.3.3.3.1.3.cmml">j</mi></msub></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.Ex4.m1.5.5.5c" xref="S3.Ex4.m1.5.6.3.1.cmml"><mrow id="S3.Ex4.m1.2.2.2.2.2.2" xref="S3.Ex4.m1.2.2.2.2.2.2d.cmml"><mtext id="S3.Ex4.m1.2.2.2.2.2.2a" xref="S3.Ex4.m1.2.2.2.2.2.2d.cmml">if the </mtext><mi id="S3.Ex4.m1.1.1.1.1.1.1.1.1.m1.1.1" xref="S3.Ex4.m1.1.1.1.1.1.1.1.1.m1.1.1.cmml">j</mi><mtext id="S3.Ex4.m1.2.2.2.2.2.2b" xref="S3.Ex4.m1.2.2.2.2.2.2d.cmml">th symbol is present in the </mtext><mi id="S3.Ex4.m1.2.2.2.2.2.2.2.2.m2.1.1" xref="S3.Ex4.m1.2.2.2.2.2.2.2.2.m2.1.1.cmml">i</mi><mtext id="S3.Ex4.m1.2.2.2.2.2.2c" xref="S3.Ex4.m1.2.2.2.2.2.2d.cmml">th proof</mtext></mrow></mtd></mtr><mtr id="S3.Ex4.m1.5.5.5d" xref="S3.Ex4.m1.5.6.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S3.Ex4.m1.5.5.5e" xref="S3.Ex4.m1.5.6.3.1.cmml"><msub id="S3.Ex4.m1.4.4.4.4.1.1" xref="S3.Ex4.m1.4.4.4.4.1.1.cmml"><mover accent="true" id="S3.Ex4.m1.4.4.4.4.1.1.2" xref="S3.Ex4.m1.4.4.4.4.1.1.2.cmml"><mn id="S3.Ex4.m1.4.4.4.4.1.1.2.2" xref="S3.Ex4.m1.4.4.4.4.1.1.2.2.cmml">𝟎</mn><mo id="S3.Ex4.m1.4.4.4.4.1.1.2.1" xref="S3.Ex4.m1.4.4.4.4.1.1.2.1.cmml">^</mo></mover><mrow id="S3.Ex4.m1.4.4.4.4.1.1.3" xref="S3.Ex4.m1.4.4.4.4.1.1.3.cmml"><mi id="S3.Ex4.m1.4.4.4.4.1.1.3.2" xref="S3.Ex4.m1.4.4.4.4.1.1.3.2.cmml">i</mi><mo id="S3.Ex4.m1.4.4.4.4.1.1.3.1" xref="S3.Ex4.m1.4.4.4.4.1.1.3.1.cmml">⁢</mo><mi id="S3.Ex4.m1.4.4.4.4.1.1.3.3" xref="S3.Ex4.m1.4.4.4.4.1.1.3.3.cmml">j</mi></mrow></msub></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.Ex4.m1.5.5.5f" xref="S3.Ex4.m1.5.6.3.1.cmml"><mtext id="S3.Ex4.m1.5.5.5.5.2.1" xref="S3.Ex4.m1.5.5.5.5.2.1a.cmml">otherwise</mtext></mtd></mtr></mtable></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex4.m1.5b"><apply id="S3.Ex4.m1.5.6.cmml" xref="S3.Ex4.m1.5.6"><eq id="S3.Ex4.m1.5.6.1.cmml" xref="S3.Ex4.m1.5.6.1"></eq><apply id="S3.Ex4.m1.5.6.2.cmml" xref="S3.Ex4.m1.5.6.2"><csymbol cd="ambiguous" id="S3.Ex4.m1.5.6.2.1.cmml" xref="S3.Ex4.m1.5.6.2">subscript</csymbol><ci id="S3.Ex4.m1.5.6.2.2.cmml" xref="S3.Ex4.m1.5.6.2.2">𝑡</ci><apply id="S3.Ex4.m1.5.6.2.3.cmml" xref="S3.Ex4.m1.5.6.2.3"><times id="S3.Ex4.m1.5.6.2.3.1.cmml" xref="S3.Ex4.m1.5.6.2.3.1"></times><ci id="S3.Ex4.m1.5.6.2.3.2.cmml" xref="S3.Ex4.m1.5.6.2.3.2">𝑖</ci><ci id="S3.Ex4.m1.5.6.2.3.3.cmml" xref="S3.Ex4.m1.5.6.2.3.3">𝑗</ci></apply></apply><apply id="S3.Ex4.m1.5.6.3.1.cmml" xref="S3.Ex4.m1.5.5"><csymbol cd="latexml" id="S3.Ex4.m1.5.6.3.1.1.cmml" xref="S3.Ex4.m1.5.5.6">cases</csymbol><apply id="S3.Ex4.m1.3.3.3.3.3.1.cmml" xref="S3.Ex4.m1.3.3.3.3.3.1"><csymbol cd="ambiguous" id="S3.Ex4.m1.3.3.3.3.3.1.1.cmml" xref="S3.Ex4.m1.3.3.3.3.3.1">subscript</csymbol><ci id="S3.Ex4.m1.3.3.3.3.3.1.2.cmml" xref="S3.Ex4.m1.3.3.3.3.3.1.2">𝑝</ci><ci id="S3.Ex4.m1.3.3.3.3.3.1.3.cmml" xref="S3.Ex4.m1.3.3.3.3.3.1.3">𝑗</ci></apply><ci id="S3.Ex4.m1.2.2.2.2.2.2d.cmml" xref="S3.Ex4.m1.2.2.2.2.2.2"><mrow id="S3.Ex4.m1.2.2.2.2.2.2.cmml" xref="S3.Ex4.m1.2.2.2.2.2.2"><mtext id="S3.Ex4.m1.2.2.2.2.2.2a.cmml" xref="S3.Ex4.m1.2.2.2.2.2.2">if the </mtext><mi id="S3.Ex4.m1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S3.Ex4.m1.1.1.1.1.1.1.1.1.m1.1.1">j</mi><mtext id="S3.Ex4.m1.2.2.2.2.2.2b.cmml" xref="S3.Ex4.m1.2.2.2.2.2.2">th symbol is present in the </mtext><mi id="S3.Ex4.m1.2.2.2.2.2.2.2.2.m2.1.1.cmml" xref="S3.Ex4.m1.2.2.2.2.2.2.2.2.m2.1.1">i</mi><mtext id="S3.Ex4.m1.2.2.2.2.2.2c.cmml" xref="S3.Ex4.m1.2.2.2.2.2.2">th proof</mtext></mrow></ci><apply id="S3.Ex4.m1.4.4.4.4.1.1.cmml" xref="S3.Ex4.m1.4.4.4.4.1.1"><csymbol cd="ambiguous" id="S3.Ex4.m1.4.4.4.4.1.1.1.cmml" xref="S3.Ex4.m1.4.4.4.4.1.1">subscript</csymbol><apply id="S3.Ex4.m1.4.4.4.4.1.1.2.cmml" xref="S3.Ex4.m1.4.4.4.4.1.1.2"><ci id="S3.Ex4.m1.4.4.4.4.1.1.2.1.cmml" xref="S3.Ex4.m1.4.4.4.4.1.1.2.1">^</ci><cn id="S3.Ex4.m1.4.4.4.4.1.1.2.2.cmml" type="integer" xref="S3.Ex4.m1.4.4.4.4.1.1.2.2">0</cn></apply><apply id="S3.Ex4.m1.4.4.4.4.1.1.3.cmml" xref="S3.Ex4.m1.4.4.4.4.1.1.3"><times id="S3.Ex4.m1.4.4.4.4.1.1.3.1.cmml" xref="S3.Ex4.m1.4.4.4.4.1.1.3.1"></times><ci id="S3.Ex4.m1.4.4.4.4.1.1.3.2.cmml" xref="S3.Ex4.m1.4.4.4.4.1.1.3.2">𝑖</ci><ci id="S3.Ex4.m1.4.4.4.4.1.1.3.3.cmml" xref="S3.Ex4.m1.4.4.4.4.1.1.3.3">𝑗</ci></apply></apply><ci id="S3.Ex4.m1.5.5.5.5.2.1a.cmml" xref="S3.Ex4.m1.5.5.5.5.2.1"><mtext id="S3.Ex4.m1.5.5.5.5.2.1.cmml" xref="S3.Ex4.m1.5.5.5.5.2.1">otherwise</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex4.m1.5c">t_{ij}=\begin{cases}p_{j}&amp;\text{if the $j$th symbol is present in the $i$th %
proof}\\
\mathbf{\hat{0}}_{ij}&amp;\text{otherwise}\end{cases}</annotation><annotation encoding="application/x-llamapun" id="S3.Ex4.m1.5d">italic_t start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT = { start_ROW start_CELL italic_p start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_CELL start_CELL if the italic_j th symbol is present in the italic_i th proof end_CELL end_ROW start_ROW start_CELL over^ start_ARG bold_0 end_ARG start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT end_CELL start_CELL otherwise end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.p8.13">where <math alttext="p_{j}" class="ltx_Math" display="inline" id="S3.SS3.p8.12.m1.1"><semantics id="S3.SS3.p8.12.m1.1a"><msub id="S3.SS3.p8.12.m1.1.1" xref="S3.SS3.p8.12.m1.1.1.cmml"><mi id="S3.SS3.p8.12.m1.1.1.2" xref="S3.SS3.p8.12.m1.1.1.2.cmml">p</mi><mi id="S3.SS3.p8.12.m1.1.1.3" xref="S3.SS3.p8.12.m1.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p8.12.m1.1b"><apply id="S3.SS3.p8.12.m1.1.1.cmml" xref="S3.SS3.p8.12.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p8.12.m1.1.1.1.cmml" xref="S3.SS3.p8.12.m1.1.1">subscript</csymbol><ci id="S3.SS3.p8.12.m1.1.1.2.cmml" xref="S3.SS3.p8.12.m1.1.1.2">𝑝</ci><ci id="S3.SS3.p8.12.m1.1.1.3.cmml" xref="S3.SS3.p8.12.m1.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p8.12.m1.1c">p_{j}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p8.12.m1.1d">italic_p start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> is the probability of the <math alttext="j" class="ltx_Math" display="inline" id="S3.SS3.p8.13.m2.1"><semantics id="S3.SS3.p8.13.m2.1a"><mi id="S3.SS3.p8.13.m2.1.1" xref="S3.SS3.p8.13.m2.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p8.13.m2.1b"><ci id="S3.SS3.p8.13.m2.1.1.cmml" xref="S3.SS3.p8.13.m2.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p8.13.m2.1c">j</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p8.13.m2.1d">italic_j</annotation></semantics></math>th input symbol.
The probability of each proof is then computed by taking the product of the normalized elements of that proof:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.Ex5">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\Pr(t_{i})=\prod_{j}\text{norm}(t_{ij})\quad\text{where}\quad\text{norm}(t_{ij%
})=\begin{cases}1&amp;t_{ij}=+\infty\\
0&amp;t_{ij}=-\infty\\
t_{ij}&amp;\text{otherwise}\end{cases}" class="ltx_Math" display="block" id="S3.Ex5.m1.10"><semantics id="S3.Ex5.m1.10a"><mrow id="S3.Ex5.m1.10.10.2" xref="S3.Ex5.m1.10.10.3.cmml"><mrow id="S3.Ex5.m1.9.9.1.1" xref="S3.Ex5.m1.9.9.1.1.cmml"><mrow id="S3.Ex5.m1.9.9.1.1.1.1" xref="S3.Ex5.m1.9.9.1.1.1.2.cmml"><mi id="S3.Ex5.m1.7.7" xref="S3.Ex5.m1.7.7.cmml">Pr</mi><mo id="S3.Ex5.m1.9.9.1.1.1.1a" xref="S3.Ex5.m1.9.9.1.1.1.2.cmml">⁡</mo><mrow id="S3.Ex5.m1.9.9.1.1.1.1.1" xref="S3.Ex5.m1.9.9.1.1.1.2.cmml"><mo id="S3.Ex5.m1.9.9.1.1.1.1.1.2" stretchy="false" xref="S3.Ex5.m1.9.9.1.1.1.2.cmml">(</mo><msub id="S3.Ex5.m1.9.9.1.1.1.1.1.1" xref="S3.Ex5.m1.9.9.1.1.1.1.1.1.cmml"><mi id="S3.Ex5.m1.9.9.1.1.1.1.1.1.2" xref="S3.Ex5.m1.9.9.1.1.1.1.1.1.2.cmml">t</mi><mi id="S3.Ex5.m1.9.9.1.1.1.1.1.1.3" xref="S3.Ex5.m1.9.9.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.Ex5.m1.9.9.1.1.1.1.1.3" stretchy="false" xref="S3.Ex5.m1.9.9.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.Ex5.m1.9.9.1.1.3" rspace="0.111em" xref="S3.Ex5.m1.9.9.1.1.3.cmml">=</mo><mrow id="S3.Ex5.m1.9.9.1.1.2.1" xref="S3.Ex5.m1.9.9.1.1.2.2.cmml"><mrow id="S3.Ex5.m1.9.9.1.1.2.1.1" xref="S3.Ex5.m1.9.9.1.1.2.1.1.cmml"><munder id="S3.Ex5.m1.9.9.1.1.2.1.1.2" xref="S3.Ex5.m1.9.9.1.1.2.1.1.2.cmml"><mo id="S3.Ex5.m1.9.9.1.1.2.1.1.2.2" movablelimits="false" xref="S3.Ex5.m1.9.9.1.1.2.1.1.2.2.cmml">∏</mo><mi id="S3.Ex5.m1.9.9.1.1.2.1.1.2.3" xref="S3.Ex5.m1.9.9.1.1.2.1.1.2.3.cmml">j</mi></munder><mrow id="S3.Ex5.m1.9.9.1.1.2.1.1.1" xref="S3.Ex5.m1.9.9.1.1.2.1.1.1.cmml"><mtext id="S3.Ex5.m1.9.9.1.1.2.1.1.1.3" xref="S3.Ex5.m1.9.9.1.1.2.1.1.1.3a.cmml">norm</mtext><mo id="S3.Ex5.m1.9.9.1.1.2.1.1.1.2" xref="S3.Ex5.m1.9.9.1.1.2.1.1.1.2.cmml">⁢</mo><mrow id="S3.Ex5.m1.9.9.1.1.2.1.1.1.1.1" xref="S3.Ex5.m1.9.9.1.1.2.1.1.1.1.1.1.cmml"><mo id="S3.Ex5.m1.9.9.1.1.2.1.1.1.1.1.2" stretchy="false" xref="S3.Ex5.m1.9.9.1.1.2.1.1.1.1.1.1.cmml">(</mo><msub id="S3.Ex5.m1.9.9.1.1.2.1.1.1.1.1.1" xref="S3.Ex5.m1.9.9.1.1.2.1.1.1.1.1.1.cmml"><mi id="S3.Ex5.m1.9.9.1.1.2.1.1.1.1.1.1.2" xref="S3.Ex5.m1.9.9.1.1.2.1.1.1.1.1.1.2.cmml">t</mi><mrow id="S3.Ex5.m1.9.9.1.1.2.1.1.1.1.1.1.3" xref="S3.Ex5.m1.9.9.1.1.2.1.1.1.1.1.1.3.cmml"><mi id="S3.Ex5.m1.9.9.1.1.2.1.1.1.1.1.1.3.2" xref="S3.Ex5.m1.9.9.1.1.2.1.1.1.1.1.1.3.2.cmml">i</mi><mo id="S3.Ex5.m1.9.9.1.1.2.1.1.1.1.1.1.3.1" xref="S3.Ex5.m1.9.9.1.1.2.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S3.Ex5.m1.9.9.1.1.2.1.1.1.1.1.1.3.3" xref="S3.Ex5.m1.9.9.1.1.2.1.1.1.1.1.1.3.3.cmml">j</mi></mrow></msub><mo id="S3.Ex5.m1.9.9.1.1.2.1.1.1.1.1.3" stretchy="false" xref="S3.Ex5.m1.9.9.1.1.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mspace id="S3.Ex5.m1.9.9.1.1.2.1.2" width="1em" xref="S3.Ex5.m1.9.9.1.1.2.2.cmml"></mspace><mtext id="S3.Ex5.m1.8.8" xref="S3.Ex5.m1.8.8a.cmml">where</mtext></mrow></mrow><mspace id="S3.Ex5.m1.10.10.2.3" width="1em" xref="S3.Ex5.m1.10.10.3a.cmml"></mspace><mrow id="S3.Ex5.m1.10.10.2.2" xref="S3.Ex5.m1.10.10.2.2.cmml"><mrow id="S3.Ex5.m1.10.10.2.2.1" xref="S3.Ex5.m1.10.10.2.2.1.cmml"><mtext id="S3.Ex5.m1.10.10.2.2.1.3" xref="S3.Ex5.m1.10.10.2.2.1.3a.cmml">norm</mtext><mo id="S3.Ex5.m1.10.10.2.2.1.2" xref="S3.Ex5.m1.10.10.2.2.1.2.cmml">⁢</mo><mrow id="S3.Ex5.m1.10.10.2.2.1.1.1" xref="S3.Ex5.m1.10.10.2.2.1.1.1.1.cmml"><mo id="S3.Ex5.m1.10.10.2.2.1.1.1.2" stretchy="false" xref="S3.Ex5.m1.10.10.2.2.1.1.1.1.cmml">(</mo><msub id="S3.Ex5.m1.10.10.2.2.1.1.1.1" xref="S3.Ex5.m1.10.10.2.2.1.1.1.1.cmml"><mi id="S3.Ex5.m1.10.10.2.2.1.1.1.1.2" xref="S3.Ex5.m1.10.10.2.2.1.1.1.1.2.cmml">t</mi><mrow id="S3.Ex5.m1.10.10.2.2.1.1.1.1.3" xref="S3.Ex5.m1.10.10.2.2.1.1.1.1.3.cmml"><mi id="S3.Ex5.m1.10.10.2.2.1.1.1.1.3.2" xref="S3.Ex5.m1.10.10.2.2.1.1.1.1.3.2.cmml">i</mi><mo id="S3.Ex5.m1.10.10.2.2.1.1.1.1.3.1" xref="S3.Ex5.m1.10.10.2.2.1.1.1.1.3.1.cmml">⁢</mo><mi id="S3.Ex5.m1.10.10.2.2.1.1.1.1.3.3" xref="S3.Ex5.m1.10.10.2.2.1.1.1.1.3.3.cmml">j</mi></mrow></msub><mo id="S3.Ex5.m1.10.10.2.2.1.1.1.3" stretchy="false" xref="S3.Ex5.m1.10.10.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.Ex5.m1.10.10.2.2.2" xref="S3.Ex5.m1.10.10.2.2.2.cmml">=</mo><mrow id="S3.Ex5.m1.6.6" xref="S3.Ex5.m1.10.10.2.2.3.1.cmml"><mo id="S3.Ex5.m1.6.6.7" xref="S3.Ex5.m1.10.10.2.2.3.1.1.cmml">{</mo><mtable columnspacing="5pt" displaystyle="true" id="S3.Ex5.m1.6.6.6" rowspacing="0pt" xref="S3.Ex5.m1.10.10.2.2.3.1.cmml"><mtr id="S3.Ex5.m1.6.6.6a" xref="S3.Ex5.m1.10.10.2.2.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S3.Ex5.m1.6.6.6b" xref="S3.Ex5.m1.10.10.2.2.3.1.cmml"><mn id="S3.Ex5.m1.1.1.1.1.1.1" xref="S3.Ex5.m1.1.1.1.1.1.1.cmml">1</mn></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.Ex5.m1.6.6.6c" xref="S3.Ex5.m1.10.10.2.2.3.1.cmml"><mrow id="S3.Ex5.m1.2.2.2.2.2.1" xref="S3.Ex5.m1.2.2.2.2.2.1.cmml"><msub id="S3.Ex5.m1.2.2.2.2.2.1.2" xref="S3.Ex5.m1.2.2.2.2.2.1.2.cmml"><mi id="S3.Ex5.m1.2.2.2.2.2.1.2.2" xref="S3.Ex5.m1.2.2.2.2.2.1.2.2.cmml">t</mi><mrow id="S3.Ex5.m1.2.2.2.2.2.1.2.3" xref="S3.Ex5.m1.2.2.2.2.2.1.2.3.cmml"><mi id="S3.Ex5.m1.2.2.2.2.2.1.2.3.2" xref="S3.Ex5.m1.2.2.2.2.2.1.2.3.2.cmml">i</mi><mo id="S3.Ex5.m1.2.2.2.2.2.1.2.3.1" xref="S3.Ex5.m1.2.2.2.2.2.1.2.3.1.cmml">⁢</mo><mi id="S3.Ex5.m1.2.2.2.2.2.1.2.3.3" xref="S3.Ex5.m1.2.2.2.2.2.1.2.3.3.cmml">j</mi></mrow></msub><mo id="S3.Ex5.m1.2.2.2.2.2.1.1" xref="S3.Ex5.m1.2.2.2.2.2.1.1.cmml">=</mo><mrow id="S3.Ex5.m1.2.2.2.2.2.1.3" xref="S3.Ex5.m1.2.2.2.2.2.1.3.cmml"><mo id="S3.Ex5.m1.2.2.2.2.2.1.3a" xref="S3.Ex5.m1.2.2.2.2.2.1.3.cmml">+</mo><mi id="S3.Ex5.m1.2.2.2.2.2.1.3.2" mathvariant="normal" xref="S3.Ex5.m1.2.2.2.2.2.1.3.2.cmml">∞</mi></mrow></mrow></mtd></mtr><mtr id="S3.Ex5.m1.6.6.6d" xref="S3.Ex5.m1.10.10.2.2.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S3.Ex5.m1.6.6.6e" xref="S3.Ex5.m1.10.10.2.2.3.1.cmml"><mn id="S3.Ex5.m1.3.3.3.3.1.1" xref="S3.Ex5.m1.3.3.3.3.1.1.cmml">0</mn></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.Ex5.m1.6.6.6f" xref="S3.Ex5.m1.10.10.2.2.3.1.cmml"><mrow id="S3.Ex5.m1.4.4.4.4.2.1" xref="S3.Ex5.m1.4.4.4.4.2.1.cmml"><msub id="S3.Ex5.m1.4.4.4.4.2.1.2" xref="S3.Ex5.m1.4.4.4.4.2.1.2.cmml"><mi id="S3.Ex5.m1.4.4.4.4.2.1.2.2" xref="S3.Ex5.m1.4.4.4.4.2.1.2.2.cmml">t</mi><mrow id="S3.Ex5.m1.4.4.4.4.2.1.2.3" xref="S3.Ex5.m1.4.4.4.4.2.1.2.3.cmml"><mi id="S3.Ex5.m1.4.4.4.4.2.1.2.3.2" xref="S3.Ex5.m1.4.4.4.4.2.1.2.3.2.cmml">i</mi><mo id="S3.Ex5.m1.4.4.4.4.2.1.2.3.1" xref="S3.Ex5.m1.4.4.4.4.2.1.2.3.1.cmml">⁢</mo><mi id="S3.Ex5.m1.4.4.4.4.2.1.2.3.3" xref="S3.Ex5.m1.4.4.4.4.2.1.2.3.3.cmml">j</mi></mrow></msub><mo id="S3.Ex5.m1.4.4.4.4.2.1.1" xref="S3.Ex5.m1.4.4.4.4.2.1.1.cmml">=</mo><mrow id="S3.Ex5.m1.4.4.4.4.2.1.3" xref="S3.Ex5.m1.4.4.4.4.2.1.3.cmml"><mo id="S3.Ex5.m1.4.4.4.4.2.1.3a" xref="S3.Ex5.m1.4.4.4.4.2.1.3.cmml">−</mo><mi id="S3.Ex5.m1.4.4.4.4.2.1.3.2" mathvariant="normal" xref="S3.Ex5.m1.4.4.4.4.2.1.3.2.cmml">∞</mi></mrow></mrow></mtd></mtr><mtr id="S3.Ex5.m1.6.6.6g" xref="S3.Ex5.m1.10.10.2.2.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S3.Ex5.m1.6.6.6h" xref="S3.Ex5.m1.10.10.2.2.3.1.cmml"><msub id="S3.Ex5.m1.5.5.5.5.1.1" xref="S3.Ex5.m1.5.5.5.5.1.1.cmml"><mi id="S3.Ex5.m1.5.5.5.5.1.1.2" xref="S3.Ex5.m1.5.5.5.5.1.1.2.cmml">t</mi><mrow id="S3.Ex5.m1.5.5.5.5.1.1.3" xref="S3.Ex5.m1.5.5.5.5.1.1.3.cmml"><mi id="S3.Ex5.m1.5.5.5.5.1.1.3.2" xref="S3.Ex5.m1.5.5.5.5.1.1.3.2.cmml">i</mi><mo id="S3.Ex5.m1.5.5.5.5.1.1.3.1" xref="S3.Ex5.m1.5.5.5.5.1.1.3.1.cmml">⁢</mo><mi id="S3.Ex5.m1.5.5.5.5.1.1.3.3" xref="S3.Ex5.m1.5.5.5.5.1.1.3.3.cmml">j</mi></mrow></msub></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.Ex5.m1.6.6.6i" xref="S3.Ex5.m1.10.10.2.2.3.1.cmml"><mtext id="S3.Ex5.m1.6.6.6.6.2.1" xref="S3.Ex5.m1.6.6.6.6.2.1a.cmml">otherwise</mtext></mtd></mtr></mtable></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex5.m1.10b"><apply id="S3.Ex5.m1.10.10.3.cmml" xref="S3.Ex5.m1.10.10.2"><csymbol cd="ambiguous" id="S3.Ex5.m1.10.10.3a.cmml" xref="S3.Ex5.m1.10.10.2.3">formulae-sequence</csymbol><apply id="S3.Ex5.m1.9.9.1.1.cmml" xref="S3.Ex5.m1.9.9.1.1"><eq id="S3.Ex5.m1.9.9.1.1.3.cmml" xref="S3.Ex5.m1.9.9.1.1.3"></eq><apply id="S3.Ex5.m1.9.9.1.1.1.2.cmml" xref="S3.Ex5.m1.9.9.1.1.1.1"><ci id="S3.Ex5.m1.7.7.cmml" xref="S3.Ex5.m1.7.7">Pr</ci><apply id="S3.Ex5.m1.9.9.1.1.1.1.1.1.cmml" xref="S3.Ex5.m1.9.9.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex5.m1.9.9.1.1.1.1.1.1.1.cmml" xref="S3.Ex5.m1.9.9.1.1.1.1.1.1">subscript</csymbol><ci id="S3.Ex5.m1.9.9.1.1.1.1.1.1.2.cmml" xref="S3.Ex5.m1.9.9.1.1.1.1.1.1.2">𝑡</ci><ci id="S3.Ex5.m1.9.9.1.1.1.1.1.1.3.cmml" xref="S3.Ex5.m1.9.9.1.1.1.1.1.1.3">𝑖</ci></apply></apply><list id="S3.Ex5.m1.9.9.1.1.2.2.cmml" xref="S3.Ex5.m1.9.9.1.1.2.1"><apply id="S3.Ex5.m1.9.9.1.1.2.1.1.cmml" xref="S3.Ex5.m1.9.9.1.1.2.1.1"><apply id="S3.Ex5.m1.9.9.1.1.2.1.1.2.cmml" xref="S3.Ex5.m1.9.9.1.1.2.1.1.2"><csymbol cd="ambiguous" id="S3.Ex5.m1.9.9.1.1.2.1.1.2.1.cmml" xref="S3.Ex5.m1.9.9.1.1.2.1.1.2">subscript</csymbol><csymbol cd="latexml" id="S3.Ex5.m1.9.9.1.1.2.1.1.2.2.cmml" xref="S3.Ex5.m1.9.9.1.1.2.1.1.2.2">product</csymbol><ci id="S3.Ex5.m1.9.9.1.1.2.1.1.2.3.cmml" xref="S3.Ex5.m1.9.9.1.1.2.1.1.2.3">𝑗</ci></apply><apply id="S3.Ex5.m1.9.9.1.1.2.1.1.1.cmml" xref="S3.Ex5.m1.9.9.1.1.2.1.1.1"><times id="S3.Ex5.m1.9.9.1.1.2.1.1.1.2.cmml" xref="S3.Ex5.m1.9.9.1.1.2.1.1.1.2"></times><ci id="S3.Ex5.m1.9.9.1.1.2.1.1.1.3a.cmml" xref="S3.Ex5.m1.9.9.1.1.2.1.1.1.3"><mtext id="S3.Ex5.m1.9.9.1.1.2.1.1.1.3.cmml" xref="S3.Ex5.m1.9.9.1.1.2.1.1.1.3">norm</mtext></ci><apply id="S3.Ex5.m1.9.9.1.1.2.1.1.1.1.1.1.cmml" xref="S3.Ex5.m1.9.9.1.1.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex5.m1.9.9.1.1.2.1.1.1.1.1.1.1.cmml" xref="S3.Ex5.m1.9.9.1.1.2.1.1.1.1.1">subscript</csymbol><ci id="S3.Ex5.m1.9.9.1.1.2.1.1.1.1.1.1.2.cmml" xref="S3.Ex5.m1.9.9.1.1.2.1.1.1.1.1.1.2">𝑡</ci><apply id="S3.Ex5.m1.9.9.1.1.2.1.1.1.1.1.1.3.cmml" xref="S3.Ex5.m1.9.9.1.1.2.1.1.1.1.1.1.3"><times id="S3.Ex5.m1.9.9.1.1.2.1.1.1.1.1.1.3.1.cmml" xref="S3.Ex5.m1.9.9.1.1.2.1.1.1.1.1.1.3.1"></times><ci id="S3.Ex5.m1.9.9.1.1.2.1.1.1.1.1.1.3.2.cmml" xref="S3.Ex5.m1.9.9.1.1.2.1.1.1.1.1.1.3.2">𝑖</ci><ci id="S3.Ex5.m1.9.9.1.1.2.1.1.1.1.1.1.3.3.cmml" xref="S3.Ex5.m1.9.9.1.1.2.1.1.1.1.1.1.3.3">𝑗</ci></apply></apply></apply></apply><ci id="S3.Ex5.m1.8.8a.cmml" xref="S3.Ex5.m1.8.8"><mtext id="S3.Ex5.m1.8.8.cmml" xref="S3.Ex5.m1.8.8">where</mtext></ci></list></apply><apply id="S3.Ex5.m1.10.10.2.2.cmml" xref="S3.Ex5.m1.10.10.2.2"><eq id="S3.Ex5.m1.10.10.2.2.2.cmml" xref="S3.Ex5.m1.10.10.2.2.2"></eq><apply id="S3.Ex5.m1.10.10.2.2.1.cmml" xref="S3.Ex5.m1.10.10.2.2.1"><times id="S3.Ex5.m1.10.10.2.2.1.2.cmml" xref="S3.Ex5.m1.10.10.2.2.1.2"></times><ci id="S3.Ex5.m1.10.10.2.2.1.3a.cmml" xref="S3.Ex5.m1.10.10.2.2.1.3"><mtext id="S3.Ex5.m1.10.10.2.2.1.3.cmml" xref="S3.Ex5.m1.10.10.2.2.1.3">norm</mtext></ci><apply id="S3.Ex5.m1.10.10.2.2.1.1.1.1.cmml" xref="S3.Ex5.m1.10.10.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.Ex5.m1.10.10.2.2.1.1.1.1.1.cmml" xref="S3.Ex5.m1.10.10.2.2.1.1.1">subscript</csymbol><ci id="S3.Ex5.m1.10.10.2.2.1.1.1.1.2.cmml" xref="S3.Ex5.m1.10.10.2.2.1.1.1.1.2">𝑡</ci><apply id="S3.Ex5.m1.10.10.2.2.1.1.1.1.3.cmml" xref="S3.Ex5.m1.10.10.2.2.1.1.1.1.3"><times id="S3.Ex5.m1.10.10.2.2.1.1.1.1.3.1.cmml" xref="S3.Ex5.m1.10.10.2.2.1.1.1.1.3.1"></times><ci id="S3.Ex5.m1.10.10.2.2.1.1.1.1.3.2.cmml" xref="S3.Ex5.m1.10.10.2.2.1.1.1.1.3.2">𝑖</ci><ci id="S3.Ex5.m1.10.10.2.2.1.1.1.1.3.3.cmml" xref="S3.Ex5.m1.10.10.2.2.1.1.1.1.3.3">𝑗</ci></apply></apply></apply><apply id="S3.Ex5.m1.10.10.2.2.3.1.cmml" xref="S3.Ex5.m1.6.6"><csymbol cd="latexml" id="S3.Ex5.m1.10.10.2.2.3.1.1.cmml" xref="S3.Ex5.m1.6.6.7">cases</csymbol><cn id="S3.Ex5.m1.1.1.1.1.1.1.cmml" type="integer" xref="S3.Ex5.m1.1.1.1.1.1.1">1</cn><apply id="S3.Ex5.m1.2.2.2.2.2.1.cmml" xref="S3.Ex5.m1.2.2.2.2.2.1"><eq id="S3.Ex5.m1.2.2.2.2.2.1.1.cmml" xref="S3.Ex5.m1.2.2.2.2.2.1.1"></eq><apply id="S3.Ex5.m1.2.2.2.2.2.1.2.cmml" xref="S3.Ex5.m1.2.2.2.2.2.1.2"><csymbol cd="ambiguous" id="S3.Ex5.m1.2.2.2.2.2.1.2.1.cmml" xref="S3.Ex5.m1.2.2.2.2.2.1.2">subscript</csymbol><ci id="S3.Ex5.m1.2.2.2.2.2.1.2.2.cmml" xref="S3.Ex5.m1.2.2.2.2.2.1.2.2">𝑡</ci><apply id="S3.Ex5.m1.2.2.2.2.2.1.2.3.cmml" xref="S3.Ex5.m1.2.2.2.2.2.1.2.3"><times id="S3.Ex5.m1.2.2.2.2.2.1.2.3.1.cmml" xref="S3.Ex5.m1.2.2.2.2.2.1.2.3.1"></times><ci id="S3.Ex5.m1.2.2.2.2.2.1.2.3.2.cmml" xref="S3.Ex5.m1.2.2.2.2.2.1.2.3.2">𝑖</ci><ci id="S3.Ex5.m1.2.2.2.2.2.1.2.3.3.cmml" xref="S3.Ex5.m1.2.2.2.2.2.1.2.3.3">𝑗</ci></apply></apply><apply id="S3.Ex5.m1.2.2.2.2.2.1.3.cmml" xref="S3.Ex5.m1.2.2.2.2.2.1.3"><plus id="S3.Ex5.m1.2.2.2.2.2.1.3.1.cmml" xref="S3.Ex5.m1.2.2.2.2.2.1.3"></plus><infinity id="S3.Ex5.m1.2.2.2.2.2.1.3.2.cmml" xref="S3.Ex5.m1.2.2.2.2.2.1.3.2"></infinity></apply></apply><cn id="S3.Ex5.m1.3.3.3.3.1.1.cmml" type="integer" xref="S3.Ex5.m1.3.3.3.3.1.1">0</cn><apply id="S3.Ex5.m1.4.4.4.4.2.1.cmml" xref="S3.Ex5.m1.4.4.4.4.2.1"><eq id="S3.Ex5.m1.4.4.4.4.2.1.1.cmml" xref="S3.Ex5.m1.4.4.4.4.2.1.1"></eq><apply id="S3.Ex5.m1.4.4.4.4.2.1.2.cmml" xref="S3.Ex5.m1.4.4.4.4.2.1.2"><csymbol cd="ambiguous" id="S3.Ex5.m1.4.4.4.4.2.1.2.1.cmml" xref="S3.Ex5.m1.4.4.4.4.2.1.2">subscript</csymbol><ci id="S3.Ex5.m1.4.4.4.4.2.1.2.2.cmml" xref="S3.Ex5.m1.4.4.4.4.2.1.2.2">𝑡</ci><apply id="S3.Ex5.m1.4.4.4.4.2.1.2.3.cmml" xref="S3.Ex5.m1.4.4.4.4.2.1.2.3"><times id="S3.Ex5.m1.4.4.4.4.2.1.2.3.1.cmml" xref="S3.Ex5.m1.4.4.4.4.2.1.2.3.1"></times><ci id="S3.Ex5.m1.4.4.4.4.2.1.2.3.2.cmml" xref="S3.Ex5.m1.4.4.4.4.2.1.2.3.2">𝑖</ci><ci id="S3.Ex5.m1.4.4.4.4.2.1.2.3.3.cmml" xref="S3.Ex5.m1.4.4.4.4.2.1.2.3.3">𝑗</ci></apply></apply><apply id="S3.Ex5.m1.4.4.4.4.2.1.3.cmml" xref="S3.Ex5.m1.4.4.4.4.2.1.3"><minus id="S3.Ex5.m1.4.4.4.4.2.1.3.1.cmml" xref="S3.Ex5.m1.4.4.4.4.2.1.3"></minus><infinity id="S3.Ex5.m1.4.4.4.4.2.1.3.2.cmml" xref="S3.Ex5.m1.4.4.4.4.2.1.3.2"></infinity></apply></apply><apply id="S3.Ex5.m1.5.5.5.5.1.1.cmml" xref="S3.Ex5.m1.5.5.5.5.1.1"><csymbol cd="ambiguous" id="S3.Ex5.m1.5.5.5.5.1.1.1.cmml" xref="S3.Ex5.m1.5.5.5.5.1.1">subscript</csymbol><ci id="S3.Ex5.m1.5.5.5.5.1.1.2.cmml" xref="S3.Ex5.m1.5.5.5.5.1.1.2">𝑡</ci><apply id="S3.Ex5.m1.5.5.5.5.1.1.3.cmml" xref="S3.Ex5.m1.5.5.5.5.1.1.3"><times id="S3.Ex5.m1.5.5.5.5.1.1.3.1.cmml" xref="S3.Ex5.m1.5.5.5.5.1.1.3.1"></times><ci id="S3.Ex5.m1.5.5.5.5.1.1.3.2.cmml" xref="S3.Ex5.m1.5.5.5.5.1.1.3.2">𝑖</ci><ci id="S3.Ex5.m1.5.5.5.5.1.1.3.3.cmml" xref="S3.Ex5.m1.5.5.5.5.1.1.3.3">𝑗</ci></apply></apply><ci id="S3.Ex5.m1.6.6.6.6.2.1a.cmml" xref="S3.Ex5.m1.6.6.6.6.2.1"><mtext id="S3.Ex5.m1.6.6.6.6.2.1.cmml" xref="S3.Ex5.m1.6.6.6.6.2.1">otherwise</mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex5.m1.10c">\Pr(t_{i})=\prod_{j}\text{norm}(t_{ij})\quad\text{where}\quad\text{norm}(t_{ij%
})=\begin{cases}1&amp;t_{ij}=+\infty\\
0&amp;t_{ij}=-\infty\\
t_{ij}&amp;\text{otherwise}\end{cases}</annotation><annotation encoding="application/x-llamapun" id="S3.Ex5.m1.10d">roman_Pr ( italic_t start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) = ∏ start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT norm ( italic_t start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT ) where norm ( italic_t start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT ) = { start_ROW start_CELL 1 end_CELL start_CELL italic_t start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT = + ∞ end_CELL end_ROW start_ROW start_CELL 0 end_CELL start_CELL italic_t start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT = - ∞ end_CELL end_ROW start_ROW start_CELL italic_t start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT end_CELL start_CELL otherwise end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.p8.21">We next define the operations of DTKP-AM in Table <a class="ltx_ref" href="https://arxiv.org/html/2410.03348v1#S3.T1" title="Table 1 ‣ 3.3 Dolphin Provenances ‣ 3 The Dolphin Framework ‣ 2 Overview ‣ Dolphin: A Programmable Framework for Scalable Neurosymbolic Learning"><span class="ltx_text ltx_ref_tag">1</span></a>.
The <math alttext="\oplus" class="ltx_Math" display="inline" id="S3.SS3.p8.14.m1.1"><semantics id="S3.SS3.p8.14.m1.1a"><mo id="S3.SS3.p8.14.m1.1.1" xref="S3.SS3.p8.14.m1.1.1.cmml">⊕</mo><annotation-xml encoding="MathML-Content" id="S3.SS3.p8.14.m1.1b"><csymbol cd="latexml" id="S3.SS3.p8.14.m1.1.1.cmml" xref="S3.SS3.p8.14.m1.1.1">direct-sum</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p8.14.m1.1c">\oplus</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p8.14.m1.1d">⊕</annotation></semantics></math> operation is defined as the union of two tag tensors <math alttext="t" class="ltx_Math" display="inline" id="S3.SS3.p8.15.m2.1"><semantics id="S3.SS3.p8.15.m2.1a"><mi id="S3.SS3.p8.15.m2.1.1" xref="S3.SS3.p8.15.m2.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p8.15.m2.1b"><ci id="S3.SS3.p8.15.m2.1.1.cmml" xref="S3.SS3.p8.15.m2.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p8.15.m2.1c">t</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p8.15.m2.1d">italic_t</annotation></semantics></math> and <math alttext="t^{\prime}" class="ltx_Math" display="inline" id="S3.SS3.p8.16.m3.1"><semantics id="S3.SS3.p8.16.m3.1a"><msup id="S3.SS3.p8.16.m3.1.1" xref="S3.SS3.p8.16.m3.1.1.cmml"><mi id="S3.SS3.p8.16.m3.1.1.2" xref="S3.SS3.p8.16.m3.1.1.2.cmml">t</mi><mo id="S3.SS3.p8.16.m3.1.1.3" xref="S3.SS3.p8.16.m3.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p8.16.m3.1b"><apply id="S3.SS3.p8.16.m3.1.1.cmml" xref="S3.SS3.p8.16.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.p8.16.m3.1.1.1.cmml" xref="S3.SS3.p8.16.m3.1.1">superscript</csymbol><ci id="S3.SS3.p8.16.m3.1.1.2.cmml" xref="S3.SS3.p8.16.m3.1.1.2">𝑡</ci><ci id="S3.SS3.p8.16.m3.1.1.3.cmml" xref="S3.SS3.p8.16.m3.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p8.16.m3.1c">t^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p8.16.m3.1d">italic_t start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math> while <math alttext="\otimes" class="ltx_Math" display="inline" id="S3.SS3.p8.17.m4.1"><semantics id="S3.SS3.p8.17.m4.1a"><mo id="S3.SS3.p8.17.m4.1.1" xref="S3.SS3.p8.17.m4.1.1.cmml">⊗</mo><annotation-xml encoding="MathML-Content" id="S3.SS3.p8.17.m4.1b"><csymbol cd="latexml" id="S3.SS3.p8.17.m4.1.1.cmml" xref="S3.SS3.p8.17.m4.1.1">tensor-product</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p8.17.m4.1c">\otimes</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p8.17.m4.1d">⊗</annotation></semantics></math> is defined as
the element-wise minimum of the absolute values of all possible combinations of proofs in <math alttext="t" class="ltx_Math" display="inline" id="S3.SS3.p8.18.m5.1"><semantics id="S3.SS3.p8.18.m5.1a"><mi id="S3.SS3.p8.18.m5.1.1" xref="S3.SS3.p8.18.m5.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p8.18.m5.1b"><ci id="S3.SS3.p8.18.m5.1.1.cmml" xref="S3.SS3.p8.18.m5.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p8.18.m5.1c">t</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p8.18.m5.1d">italic_t</annotation></semantics></math> and <math alttext="t^{\prime}" class="ltx_Math" display="inline" id="S3.SS3.p8.19.m6.1"><semantics id="S3.SS3.p8.19.m6.1a"><msup id="S3.SS3.p8.19.m6.1.1" xref="S3.SS3.p8.19.m6.1.1.cmml"><mi id="S3.SS3.p8.19.m6.1.1.2" xref="S3.SS3.p8.19.m6.1.1.2.cmml">t</mi><mo id="S3.SS3.p8.19.m6.1.1.3" xref="S3.SS3.p8.19.m6.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p8.19.m6.1b"><apply id="S3.SS3.p8.19.m6.1.1.cmml" xref="S3.SS3.p8.19.m6.1.1"><csymbol cd="ambiguous" id="S3.SS3.p8.19.m6.1.1.1.cmml" xref="S3.SS3.p8.19.m6.1.1">superscript</csymbol><ci id="S3.SS3.p8.19.m6.1.1.2.cmml" xref="S3.SS3.p8.19.m6.1.1.2">𝑡</ci><ci id="S3.SS3.p8.19.m6.1.1.3.cmml" xref="S3.SS3.p8.19.m6.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p8.19.m6.1c">t^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p8.19.m6.1d">italic_t start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math>.
In each case, the <math alttext="\text{top}_{k}" class="ltx_Math" display="inline" id="S3.SS3.p8.20.m7.1"><semantics id="S3.SS3.p8.20.m7.1a"><msub id="S3.SS3.p8.20.m7.1.1" xref="S3.SS3.p8.20.m7.1.1.cmml"><mtext id="S3.SS3.p8.20.m7.1.1.2" xref="S3.SS3.p8.20.m7.1.1.2a.cmml">top</mtext><mi id="S3.SS3.p8.20.m7.1.1.3" xref="S3.SS3.p8.20.m7.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p8.20.m7.1b"><apply id="S3.SS3.p8.20.m7.1.1.cmml" xref="S3.SS3.p8.20.m7.1.1"><csymbol cd="ambiguous" id="S3.SS3.p8.20.m7.1.1.1.cmml" xref="S3.SS3.p8.20.m7.1.1">subscript</csymbol><ci id="S3.SS3.p8.20.m7.1.1.2a.cmml" xref="S3.SS3.p8.20.m7.1.1.2"><mtext id="S3.SS3.p8.20.m7.1.1.2.cmml" xref="S3.SS3.p8.20.m7.1.1.2">top</mtext></ci><ci id="S3.SS3.p8.20.m7.1.1.3.cmml" xref="S3.SS3.p8.20.m7.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p8.20.m7.1c">\text{top}_{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p8.20.m7.1d">top start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> operation retains only upto <math alttext="k" class="ltx_Math" display="inline" id="S3.SS3.p8.21.m8.1"><semantics id="S3.SS3.p8.21.m8.1a"><mi id="S3.SS3.p8.21.m8.1.1" xref="S3.SS3.p8.21.m8.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p8.21.m8.1b"><ci id="S3.SS3.p8.21.m8.1.1.cmml" xref="S3.SS3.p8.21.m8.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p8.21.m8.1c">k</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p8.21.m8.1d">italic_k</annotation></semantics></math> proofs with the highest probabilities.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS3.p9">
<p class="ltx_p" id="S3.SS3.p9.1">These definitions thus allow us to take advantage of the benefits of the DTKP provenance while enabling efficient computation
on GPUs.
To calculate the probability of the entire tag, DTKP-AM adds the probabilities of the individual proofs and clamps it at 1.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.4 </span>Building the <span class="ltx_text ltx_font_smallcaps" id="S3.SS4.1.1">Dolphin</span> Program</h3>
<div class="ltx_para ltx_noindent" id="S3.SS4.p1">
<p class="ltx_p" id="S3.SS4.p1.3">The programmer specifies the neurosymbolic task using a Python program <math alttext="P" class="ltx_Math" display="inline" id="S3.SS4.p1.1.m1.1"><semantics id="S3.SS4.p1.1.m1.1a"><mi id="S3.SS4.p1.1.m1.1.1" xref="S3.SS4.p1.1.m1.1.1.cmml">P</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.1.m1.1b"><ci id="S3.SS4.p1.1.m1.1.1.cmml" xref="S3.SS4.p1.1.m1.1.1">𝑃</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.1.m1.1c">P</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.1.m1.1d">italic_P</annotation></semantics></math> that uses <span class="ltx_text ltx_font_smallcaps" id="S3.SS4.p1.3.1">Dolphin</span>’s programming interface
to connect the neural components (e.g., neural networks) with the symbolic components and operations. We call <math alttext="P" class="ltx_Math" display="inline" id="S3.SS4.p1.2.m2.1"><semantics id="S3.SS4.p1.2.m2.1a"><mi id="S3.SS4.p1.2.m2.1.1" xref="S3.SS4.p1.2.m2.1.1.cmml">P</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.2.m2.1b"><ci id="S3.SS4.p1.2.m2.1.1.cmml" xref="S3.SS4.p1.2.m2.1.1">𝑃</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.2.m2.1c">P</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.2.m2.1d">italic_P</annotation></semantics></math> the <em class="ltx_emph ltx_font_italic" id="S3.SS4.p1.3.2">symbolic program</em>. Because <math alttext="P" class="ltx_Math" display="inline" id="S3.SS4.p1.3.m3.1"><semantics id="S3.SS4.p1.3.m3.1a"><mi id="S3.SS4.p1.3.m3.1.1" xref="S3.SS4.p1.3.m3.1.1.cmml">P</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.3.m3.1b"><ci id="S3.SS4.p1.3.m3.1.1.cmml" xref="S3.SS4.p1.3.m3.1.1">𝑃</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.3.m3.1c">P</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.3.m3.1d">italic_P</annotation></semantics></math> is a Python program and <span class="ltx_text ltx_font_smallcaps" id="S3.SS4.p1.3.3">Dolphin</span> interfaces with PyTorch, <span class="ltx_text ltx_font_smallcaps" id="S3.SS4.p1.3.4">Dolphin</span> supports
any PyTorch-based neural network(s), most Python language features, and custom user-defined functions. This feature
enables greater flexibility and expressiveness in neurosymbolic programs than existing frameworks.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS4.p2">
<p class="ltx_p" id="S3.SS4.p2.6">In addition to <math alttext="P" class="ltx_Math" display="inline" id="S3.SS4.p2.1.m1.1"><semantics id="S3.SS4.p2.1.m1.1a"><mi id="S3.SS4.p2.1.m1.1.1" xref="S3.SS4.p2.1.m1.1.1.cmml">P</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.1.m1.1b"><ci id="S3.SS4.p2.1.m1.1.1.cmml" xref="S3.SS4.p2.1.m1.1.1">𝑃</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.1.m1.1c">P</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p2.1.m1.1d">italic_P</annotation></semantics></math>, the programmer provides one or more neural networks <math alttext="M_{1},\ldots,M_{k}" class="ltx_Math" display="inline" id="S3.SS4.p2.2.m2.3"><semantics id="S3.SS4.p2.2.m2.3a"><mrow id="S3.SS4.p2.2.m2.3.3.2" xref="S3.SS4.p2.2.m2.3.3.3.cmml"><msub id="S3.SS4.p2.2.m2.2.2.1.1" xref="S3.SS4.p2.2.m2.2.2.1.1.cmml"><mi id="S3.SS4.p2.2.m2.2.2.1.1.2" xref="S3.SS4.p2.2.m2.2.2.1.1.2.cmml">M</mi><mn id="S3.SS4.p2.2.m2.2.2.1.1.3" xref="S3.SS4.p2.2.m2.2.2.1.1.3.cmml">1</mn></msub><mo id="S3.SS4.p2.2.m2.3.3.2.3" xref="S3.SS4.p2.2.m2.3.3.3.cmml">,</mo><mi id="S3.SS4.p2.2.m2.1.1" mathvariant="normal" xref="S3.SS4.p2.2.m2.1.1.cmml">…</mi><mo id="S3.SS4.p2.2.m2.3.3.2.4" xref="S3.SS4.p2.2.m2.3.3.3.cmml">,</mo><msub id="S3.SS4.p2.2.m2.3.3.2.2" xref="S3.SS4.p2.2.m2.3.3.2.2.cmml"><mi id="S3.SS4.p2.2.m2.3.3.2.2.2" xref="S3.SS4.p2.2.m2.3.3.2.2.2.cmml">M</mi><mi id="S3.SS4.p2.2.m2.3.3.2.2.3" xref="S3.SS4.p2.2.m2.3.3.2.2.3.cmml">k</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.2.m2.3b"><list id="S3.SS4.p2.2.m2.3.3.3.cmml" xref="S3.SS4.p2.2.m2.3.3.2"><apply id="S3.SS4.p2.2.m2.2.2.1.1.cmml" xref="S3.SS4.p2.2.m2.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS4.p2.2.m2.2.2.1.1.1.cmml" xref="S3.SS4.p2.2.m2.2.2.1.1">subscript</csymbol><ci id="S3.SS4.p2.2.m2.2.2.1.1.2.cmml" xref="S3.SS4.p2.2.m2.2.2.1.1.2">𝑀</ci><cn id="S3.SS4.p2.2.m2.2.2.1.1.3.cmml" type="integer" xref="S3.SS4.p2.2.m2.2.2.1.1.3">1</cn></apply><ci id="S3.SS4.p2.2.m2.1.1.cmml" xref="S3.SS4.p2.2.m2.1.1">…</ci><apply id="S3.SS4.p2.2.m2.3.3.2.2.cmml" xref="S3.SS4.p2.2.m2.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS4.p2.2.m2.3.3.2.2.1.cmml" xref="S3.SS4.p2.2.m2.3.3.2.2">subscript</csymbol><ci id="S3.SS4.p2.2.m2.3.3.2.2.2.cmml" xref="S3.SS4.p2.2.m2.3.3.2.2.2">𝑀</ci><ci id="S3.SS4.p2.2.m2.3.3.2.2.3.cmml" xref="S3.SS4.p2.2.m2.3.3.2.2.3">𝑘</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.2.m2.3c">M_{1},\ldots,M_{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p2.2.m2.3d">italic_M start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_M start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math>, and a dataset <math alttext="\mathcal{D}" class="ltx_Math" display="inline" id="S3.SS4.p2.3.m3.1"><semantics id="S3.SS4.p2.3.m3.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p2.3.m3.1.1" xref="S3.SS4.p2.3.m3.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.3.m3.1b"><ci id="S3.SS4.p2.3.m3.1.1.cmml" xref="S3.SS4.p2.3.m3.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.3.m3.1c">\mathcal{D}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p2.3.m3.1d">caligraphic_D</annotation></semantics></math>. Given these inputs, <span class="ltx_text ltx_font_smallcaps" id="S3.SS4.p2.6.1">Dolphin</span> extracts the computation graph that encodes how the neural network outputs are transformed using symbolic operations to produce a final result <math alttext="D_{\text{res}}" class="ltx_Math" display="inline" id="S3.SS4.p2.4.m4.1"><semantics id="S3.SS4.p2.4.m4.1a"><msub id="S3.SS4.p2.4.m4.1.1" xref="S3.SS4.p2.4.m4.1.1.cmml"><mi id="S3.SS4.p2.4.m4.1.1.2" xref="S3.SS4.p2.4.m4.1.1.2.cmml">D</mi><mtext id="S3.SS4.p2.4.m4.1.1.3" xref="S3.SS4.p2.4.m4.1.1.3a.cmml">res</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.4.m4.1b"><apply id="S3.SS4.p2.4.m4.1.1.cmml" xref="S3.SS4.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS4.p2.4.m4.1.1.1.cmml" xref="S3.SS4.p2.4.m4.1.1">subscript</csymbol><ci id="S3.SS4.p2.4.m4.1.1.2.cmml" xref="S3.SS4.p2.4.m4.1.1.2">𝐷</ci><ci id="S3.SS4.p2.4.m4.1.1.3a.cmml" xref="S3.SS4.p2.4.m4.1.1.3"><mtext id="S3.SS4.p2.4.m4.1.1.3.cmml" mathsize="70%" xref="S3.SS4.p2.4.m4.1.1.3">res</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.4.m4.1c">D_{\text{res}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p2.4.m4.1d">italic_D start_POSTSUBSCRIPT res end_POSTSUBSCRIPT</annotation></semantics></math>. All computations in <span class="ltx_text ltx_font_smallcaps" id="S3.SS4.p2.6.2">Dolphin</span> are expressed using distribution objects <math alttext="D_{i}" class="ltx_Math" display="inline" id="S3.SS4.p2.5.m5.1"><semantics id="S3.SS4.p2.5.m5.1a"><msub id="S3.SS4.p2.5.m5.1.1" xref="S3.SS4.p2.5.m5.1.1.cmml"><mi id="S3.SS4.p2.5.m5.1.1.2" xref="S3.SS4.p2.5.m5.1.1.2.cmml">D</mi><mi id="S3.SS4.p2.5.m5.1.1.3" xref="S3.SS4.p2.5.m5.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.5.m5.1b"><apply id="S3.SS4.p2.5.m5.1.1.cmml" xref="S3.SS4.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS4.p2.5.m5.1.1.1.cmml" xref="S3.SS4.p2.5.m5.1.1">subscript</csymbol><ci id="S3.SS4.p2.5.m5.1.1.2.cmml" xref="S3.SS4.p2.5.m5.1.1.2">𝐷</ci><ci id="S3.SS4.p2.5.m5.1.1.3.cmml" xref="S3.SS4.p2.5.m5.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.5.m5.1c">D_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p2.5.m5.1d">italic_D start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>. Each <span class="ltx_text ltx_font_smallcaps" id="S3.SS4.p2.6.3">Dolphin</span> primitive (e.g., <span class="ltx_text ltx_font_smallcaps" id="S3.SS4.p2.6.4">Apply</span>) takes one or more distribution objects as inputs and applies a transformation to produce another distribution object. Because each distribution object <math alttext="D_{i}" class="ltx_Math" display="inline" id="S3.SS4.p2.6.m6.1"><semantics id="S3.SS4.p2.6.m6.1a"><msub id="S3.SS4.p2.6.m6.1.1" xref="S3.SS4.p2.6.m6.1.1.cmml"><mi id="S3.SS4.p2.6.m6.1.1.2" xref="S3.SS4.p2.6.m6.1.1.2.cmml">D</mi><mi id="S3.SS4.p2.6.m6.1.1.3" xref="S3.SS4.p2.6.m6.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.6.m6.1b"><apply id="S3.SS4.p2.6.m6.1.1.cmml" xref="S3.SS4.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS4.p2.6.m6.1.1.1.cmml" xref="S3.SS4.p2.6.m6.1.1">subscript</csymbol><ci id="S3.SS4.p2.6.m6.1.1.2.cmml" xref="S3.SS4.p2.6.m6.1.1.2">𝐷</ci><ci id="S3.SS4.p2.6.m6.1.1.3.cmml" xref="S3.SS4.p2.6.m6.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.6.m6.1c">D_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p2.6.m6.1d">italic_D start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> only contains vectors of tags (or probabilities), the entire computation graph (including the neural network(s))
can be ported to a GPU for faster execution.
During training, <span class="ltx_text ltx_font_smallcaps" id="S3.SS4.p2.6.5">Dolphin</span> optimizes over the standard objective function:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\phi(\theta)=\min_{\theta}\sum_{(x,y)\in\mathcal{D}}\mathcal{L}(\text{$P$}(M_{%
\theta}(x)),y)" class="ltx_Math" display="block" id="S3.E4.m1.7"><semantics id="S3.E4.m1.7a"><mrow id="S3.E4.m1.7.7" xref="S3.E4.m1.7.7.cmml"><mrow id="S3.E4.m1.7.7.3" xref="S3.E4.m1.7.7.3.cmml"><mi id="S3.E4.m1.7.7.3.2" xref="S3.E4.m1.7.7.3.2.cmml">ϕ</mi><mo id="S3.E4.m1.7.7.3.1" xref="S3.E4.m1.7.7.3.1.cmml">⁢</mo><mrow id="S3.E4.m1.7.7.3.3.2" xref="S3.E4.m1.7.7.3.cmml"><mo id="S3.E4.m1.7.7.3.3.2.1" stretchy="false" xref="S3.E4.m1.7.7.3.cmml">(</mo><mi id="S3.E4.m1.4.4" xref="S3.E4.m1.4.4.cmml">θ</mi><mo id="S3.E4.m1.7.7.3.3.2.2" stretchy="false" xref="S3.E4.m1.7.7.3.cmml">)</mo></mrow></mrow><mo id="S3.E4.m1.7.7.2" xref="S3.E4.m1.7.7.2.cmml">=</mo><mrow id="S3.E4.m1.7.7.1" xref="S3.E4.m1.7.7.1.cmml"><munder id="S3.E4.m1.7.7.1.3" xref="S3.E4.m1.7.7.1.3.cmml"><mi id="S3.E4.m1.7.7.1.3.2" xref="S3.E4.m1.7.7.1.3.2.cmml">min</mi><mi id="S3.E4.m1.7.7.1.3.3" xref="S3.E4.m1.7.7.1.3.3.cmml">θ</mi></munder><mo id="S3.E4.m1.7.7.1.2" xref="S3.E4.m1.7.7.1.2.cmml">⁢</mo><mrow id="S3.E4.m1.7.7.1.1" xref="S3.E4.m1.7.7.1.1.cmml"><munder id="S3.E4.m1.7.7.1.1.2" xref="S3.E4.m1.7.7.1.1.2.cmml"><mo id="S3.E4.m1.7.7.1.1.2.2" movablelimits="false" xref="S3.E4.m1.7.7.1.1.2.2.cmml">∑</mo><mrow id="S3.E4.m1.3.3.2" xref="S3.E4.m1.3.3.2.cmml"><mrow id="S3.E4.m1.3.3.2.4.2" xref="S3.E4.m1.3.3.2.4.1.cmml"><mo id="S3.E4.m1.3.3.2.4.2.1" stretchy="false" xref="S3.E4.m1.3.3.2.4.1.cmml">(</mo><mi id="S3.E4.m1.2.2.1.1" xref="S3.E4.m1.2.2.1.1.cmml">x</mi><mo id="S3.E4.m1.3.3.2.4.2.2" xref="S3.E4.m1.3.3.2.4.1.cmml">,</mo><mi id="S3.E4.m1.3.3.2.2" xref="S3.E4.m1.3.3.2.2.cmml">y</mi><mo id="S3.E4.m1.3.3.2.4.2.3" stretchy="false" xref="S3.E4.m1.3.3.2.4.1.cmml">)</mo></mrow><mo id="S3.E4.m1.3.3.2.3" xref="S3.E4.m1.3.3.2.3.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.3.3.2.5" xref="S3.E4.m1.3.3.2.5.cmml">𝒟</mi></mrow></munder><mrow id="S3.E4.m1.7.7.1.1.1" xref="S3.E4.m1.7.7.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.7.7.1.1.1.3" xref="S3.E4.m1.7.7.1.1.1.3.cmml">ℒ</mi><mo id="S3.E4.m1.7.7.1.1.1.2" xref="S3.E4.m1.7.7.1.1.1.2.cmml">⁢</mo><mrow id="S3.E4.m1.7.7.1.1.1.1.1" xref="S3.E4.m1.7.7.1.1.1.1.2.cmml"><mo id="S3.E4.m1.7.7.1.1.1.1.1.2" stretchy="false" xref="S3.E4.m1.7.7.1.1.1.1.2.cmml">(</mo><mrow id="S3.E4.m1.7.7.1.1.1.1.1.1" xref="S3.E4.m1.7.7.1.1.1.1.1.1.cmml"><mi id="S3.E4.m1.7.7.1.1.1.1.1.1.3" xref="S3.E4.m1.7.7.1.1.1.1.1.1.3.cmml">P</mi><mo id="S3.E4.m1.7.7.1.1.1.1.1.1.2" xref="S3.E4.m1.7.7.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E4.m1.7.7.1.1.1.1.1.1.1.1" xref="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.1" xref="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.1.2" xref="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.1.2.2.cmml">M</mi><mi id="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.1.2.3.cmml">θ</mi></msub><mo id="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.1.1" xref="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.1.3.2.1" stretchy="false" xref="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.1.cmml">(</mo><mi id="S3.E4.m1.5.5" xref="S3.E4.m1.5.5.cmml">x</mi><mo id="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.1.3.2.2" stretchy="false" xref="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E4.m1.7.7.1.1.1.1.1.3" xref="S3.E4.m1.7.7.1.1.1.1.2.cmml">,</mo><mi id="S3.E4.m1.6.6" xref="S3.E4.m1.6.6.cmml">y</mi><mo id="S3.E4.m1.7.7.1.1.1.1.1.4" stretchy="false" xref="S3.E4.m1.7.7.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.7b"><apply id="S3.E4.m1.7.7.cmml" xref="S3.E4.m1.7.7"><eq id="S3.E4.m1.7.7.2.cmml" xref="S3.E4.m1.7.7.2"></eq><apply id="S3.E4.m1.7.7.3.cmml" xref="S3.E4.m1.7.7.3"><times id="S3.E4.m1.7.7.3.1.cmml" xref="S3.E4.m1.7.7.3.1"></times><ci id="S3.E4.m1.7.7.3.2.cmml" xref="S3.E4.m1.7.7.3.2">italic-ϕ</ci><ci id="S3.E4.m1.4.4.cmml" xref="S3.E4.m1.4.4">𝜃</ci></apply><apply id="S3.E4.m1.7.7.1.cmml" xref="S3.E4.m1.7.7.1"><times id="S3.E4.m1.7.7.1.2.cmml" xref="S3.E4.m1.7.7.1.2"></times><apply id="S3.E4.m1.7.7.1.3.cmml" xref="S3.E4.m1.7.7.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.7.7.1.3.1.cmml" xref="S3.E4.m1.7.7.1.3">subscript</csymbol><min id="S3.E4.m1.7.7.1.3.2.cmml" xref="S3.E4.m1.7.7.1.3.2"></min><ci id="S3.E4.m1.7.7.1.3.3.cmml" xref="S3.E4.m1.7.7.1.3.3">𝜃</ci></apply><apply id="S3.E4.m1.7.7.1.1.cmml" xref="S3.E4.m1.7.7.1.1"><apply id="S3.E4.m1.7.7.1.1.2.cmml" xref="S3.E4.m1.7.7.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.7.7.1.1.2.1.cmml" xref="S3.E4.m1.7.7.1.1.2">subscript</csymbol><sum id="S3.E4.m1.7.7.1.1.2.2.cmml" xref="S3.E4.m1.7.7.1.1.2.2"></sum><apply id="S3.E4.m1.3.3.2.cmml" xref="S3.E4.m1.3.3.2"><in id="S3.E4.m1.3.3.2.3.cmml" xref="S3.E4.m1.3.3.2.3"></in><interval closure="open" id="S3.E4.m1.3.3.2.4.1.cmml" xref="S3.E4.m1.3.3.2.4.2"><ci id="S3.E4.m1.2.2.1.1.cmml" xref="S3.E4.m1.2.2.1.1">𝑥</ci><ci id="S3.E4.m1.3.3.2.2.cmml" xref="S3.E4.m1.3.3.2.2">𝑦</ci></interval><ci id="S3.E4.m1.3.3.2.5.cmml" xref="S3.E4.m1.3.3.2.5">𝒟</ci></apply></apply><apply id="S3.E4.m1.7.7.1.1.1.cmml" xref="S3.E4.m1.7.7.1.1.1"><times id="S3.E4.m1.7.7.1.1.1.2.cmml" xref="S3.E4.m1.7.7.1.1.1.2"></times><ci id="S3.E4.m1.7.7.1.1.1.3.cmml" xref="S3.E4.m1.7.7.1.1.1.3">ℒ</ci><interval closure="open" id="S3.E4.m1.7.7.1.1.1.1.2.cmml" xref="S3.E4.m1.7.7.1.1.1.1.1"><apply id="S3.E4.m1.7.7.1.1.1.1.1.1.cmml" xref="S3.E4.m1.7.7.1.1.1.1.1.1"><times id="S3.E4.m1.7.7.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.7.7.1.1.1.1.1.1.2"></times><ci id="S3.E4.m1.7.7.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.7.7.1.1.1.1.1.1.3">𝑃</ci><apply id="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.7.7.1.1.1.1.1.1.1.1"><times id="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.1.1"></times><apply id="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.1.2.2">𝑀</ci><ci id="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.1.2.3">𝜃</ci></apply><ci id="S3.E4.m1.5.5.cmml" xref="S3.E4.m1.5.5">𝑥</ci></apply></apply><ci id="S3.E4.m1.6.6.cmml" xref="S3.E4.m1.6.6">𝑦</ci></interval></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.7c">\phi(\theta)=\min_{\theta}\sum_{(x,y)\in\mathcal{D}}\mathcal{L}(\text{$P$}(M_{%
\theta}(x)),y)</annotation><annotation encoding="application/x-llamapun" id="S3.E4.m1.7d">italic_ϕ ( italic_θ ) = roman_min start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ∑ start_POSTSUBSCRIPT ( italic_x , italic_y ) ∈ caligraphic_D end_POSTSUBSCRIPT caligraphic_L ( italic_P ( italic_M start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_x ) ) , italic_y )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS4.p2.9">Here <math alttext="\mathcal{L}" class="ltx_Math" display="inline" id="S3.SS4.p2.7.m1.1"><semantics id="S3.SS4.p2.7.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p2.7.m1.1.1" xref="S3.SS4.p2.7.m1.1.1.cmml">ℒ</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.7.m1.1b"><ci id="S3.SS4.p2.7.m1.1.1.cmml" xref="S3.SS4.p2.7.m1.1.1">ℒ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.7.m1.1c">\mathcal{L}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p2.7.m1.1d">caligraphic_L</annotation></semantics></math> is the loss function, such as binary cross entropy. While <span class="ltx_text ltx_font_smallcaps" id="S3.SS4.p2.9.1">Dolphin</span> allows <math alttext="P" class="ltx_Math" display="inline" id="S3.SS4.p2.8.m2.1"><semantics id="S3.SS4.p2.8.m2.1a"><mi id="S3.SS4.p2.8.m2.1.1" xref="S3.SS4.p2.8.m2.1.1.cmml">P</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.8.m2.1b"><ci id="S3.SS4.p2.8.m2.1.1.cmml" xref="S3.SS4.p2.8.m2.1.1">𝑃</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.8.m2.1c">P</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p2.8.m2.1d">italic_P</annotation></semantics></math> to take multiple neural networks as inputs, we show only one neural network model <math alttext="M" class="ltx_Math" display="inline" id="S3.SS4.p2.9.m3.1"><semantics id="S3.SS4.p2.9.m3.1a"><mi id="S3.SS4.p2.9.m3.1.1" xref="S3.SS4.p2.9.m3.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.9.m3.1b"><ci id="S3.SS4.p2.9.m3.1.1.cmml" xref="S3.SS4.p2.9.m3.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.9.m3.1c">M</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p2.9.m3.1d">italic_M</annotation></semantics></math> here for simplicity.</p>
</div>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Experiments</h2>
<div class="ltx_para ltx_noindent" id="S4.p1">
<p class="ltx_p" id="S4.p1.1">We evaluate <span class="ltx_text ltx_font_smallcaps" id="S4.p1.1.1">Dolphin</span> on a set of 13 benchmarks of varying complexity and scale across 5 neurosymbolic tasks. Our evaluation addresses the following research questions:</p>
<ul class="ltx_itemize" id="S4.I1">
<li class="ltx_item" id="S4.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I1.i1.p1">
<p class="ltx_p" id="S4.I1.i1.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I1.i1.p1.1.1">RQ1: Scalability.</span> How does <span class="ltx_text ltx_font_smallcaps" id="S4.I1.i1.p1.1.2">Dolphin</span> scale to complex problems and large datasets compared to existing baselines?</p>
</div>
</li>
<li class="ltx_item" id="S4.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I1.i2.p1">
<p class="ltx_p" id="S4.I1.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I1.i2.p1.1.1">RQ2: Accuracy.</span> Do models written in <span class="ltx_text ltx_font_smallcaps" id="S4.I1.i2.p1.1.2">Dolphin</span> converge to SOTA accuracies?</p>
</div>
</li>
<li class="ltx_item" id="S4.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para ltx_noindent" id="S4.I1.i3.p1">
<p class="ltx_p" id="S4.I1.i3.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I1.i3.p1.1.1">RQ3: Provenance Comparisons.</span> Which provenances are most effective for each benchmark?</p>
</div>
</li>
</ul>
</div>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Benchmarks</h3>
<div class="ltx_para ltx_noindent" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.4"><span class="ltx_text ltx_font_bold" id="S4.SS1.p1.4.1">MNIST-SumN.</span>
The MNIST-SumN (or briefly, SumN) task from <cite class="ltx_cite ltx_citemacro_citep">(De Smet et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03348v1#bib.bib3" title="">2024</a>)</cite> takes as inputs <math alttext="N" class="ltx_Math" display="inline" id="S4.SS1.p1.1.m1.1"><semantics id="S4.SS1.p1.1.m1.1a"><mi id="S4.SS1.p1.1.m1.1.1" xref="S4.SS1.p1.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.1.m1.1b"><ci id="S4.SS1.p1.1.m1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.1.m1.1c">N</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.1.m1.1d">italic_N</annotation></semantics></math> handwritten digits from the MNIST dataset
and returns their sum.
We consider three versions of this task: small (<math alttext="N=5" class="ltx_Math" display="inline" id="S4.SS1.p1.2.m2.1"><semantics id="S4.SS1.p1.2.m2.1a"><mrow id="S4.SS1.p1.2.m2.1.1" xref="S4.SS1.p1.2.m2.1.1.cmml"><mi id="S4.SS1.p1.2.m2.1.1.2" xref="S4.SS1.p1.2.m2.1.1.2.cmml">N</mi><mo id="S4.SS1.p1.2.m2.1.1.1" xref="S4.SS1.p1.2.m2.1.1.1.cmml">=</mo><mn id="S4.SS1.p1.2.m2.1.1.3" xref="S4.SS1.p1.2.m2.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.2.m2.1b"><apply id="S4.SS1.p1.2.m2.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1"><eq id="S4.SS1.p1.2.m2.1.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1.1"></eq><ci id="S4.SS1.p1.2.m2.1.1.2.cmml" xref="S4.SS1.p1.2.m2.1.1.2">𝑁</ci><cn id="S4.SS1.p1.2.m2.1.1.3.cmml" type="integer" xref="S4.SS1.p1.2.m2.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.2.m2.1c">N=5</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.2.m2.1d">italic_N = 5</annotation></semantics></math>), medium (<math alttext="N=10" class="ltx_Math" display="inline" id="S4.SS1.p1.3.m3.1"><semantics id="S4.SS1.p1.3.m3.1a"><mrow id="S4.SS1.p1.3.m3.1.1" xref="S4.SS1.p1.3.m3.1.1.cmml"><mi id="S4.SS1.p1.3.m3.1.1.2" xref="S4.SS1.p1.3.m3.1.1.2.cmml">N</mi><mo id="S4.SS1.p1.3.m3.1.1.1" xref="S4.SS1.p1.3.m3.1.1.1.cmml">=</mo><mn id="S4.SS1.p1.3.m3.1.1.3" xref="S4.SS1.p1.3.m3.1.1.3.cmml">10</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.3.m3.1b"><apply id="S4.SS1.p1.3.m3.1.1.cmml" xref="S4.SS1.p1.3.m3.1.1"><eq id="S4.SS1.p1.3.m3.1.1.1.cmml" xref="S4.SS1.p1.3.m3.1.1.1"></eq><ci id="S4.SS1.p1.3.m3.1.1.2.cmml" xref="S4.SS1.p1.3.m3.1.1.2">𝑁</ci><cn id="S4.SS1.p1.3.m3.1.1.3.cmml" type="integer" xref="S4.SS1.p1.3.m3.1.1.3">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.3.m3.1c">N=10</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.3.m3.1d">italic_N = 10</annotation></semantics></math>), and large (<math alttext="N=15" class="ltx_Math" display="inline" id="S4.SS1.p1.4.m4.1"><semantics id="S4.SS1.p1.4.m4.1a"><mrow id="S4.SS1.p1.4.m4.1.1" xref="S4.SS1.p1.4.m4.1.1.cmml"><mi id="S4.SS1.p1.4.m4.1.1.2" xref="S4.SS1.p1.4.m4.1.1.2.cmml">N</mi><mo id="S4.SS1.p1.4.m4.1.1.1" xref="S4.SS1.p1.4.m4.1.1.1.cmml">=</mo><mn id="S4.SS1.p1.4.m4.1.1.3" xref="S4.SS1.p1.4.m4.1.1.3.cmml">15</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.4.m4.1b"><apply id="S4.SS1.p1.4.m4.1.1.cmml" xref="S4.SS1.p1.4.m4.1.1"><eq id="S4.SS1.p1.4.m4.1.1.1.cmml" xref="S4.SS1.p1.4.m4.1.1.1"></eq><ci id="S4.SS1.p1.4.m4.1.1.2.cmml" xref="S4.SS1.p1.4.m4.1.1.2">𝑁</ci><cn id="S4.SS1.p1.4.m4.1.1.3.cmml" type="integer" xref="S4.SS1.p1.4.m4.1.1.3">15</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.4.m4.1c">N=15</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.4.m4.1d">italic_N = 15</annotation></semantics></math>).
The perception model for this task is a standard CNN while the symbolic program sums the outputs of this model.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS1.p2">
<p class="ltx_p" id="S4.SS1.p2.1"><span class="ltx_text ltx_font_bold" id="S4.SS1.p2.1.1">Hand-Written Formula (HWF).</span>
The HWF task from <cite class="ltx_cite ltx_citemacro_cite">Li et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03348v1#bib.bib8" title="">2020</a>)</cite> takes as input a set of images of handwritten digits and arithmetic operators representing
a formula.
The task is to evaluate the formula and return the result.
We consider three versions of HWF: small (formulas of length up to 7), medium (formulas of length up to 15),
and large (formulas of length up to 19).
Similar to MNIST-SumN, the perception model for this task is a standard CNN.
The <span class="ltx_text ltx_font_smallcaps" id="S4.SS1.p2.1.2">Dolphin</span> program for this task builds strings of formulae from the outputs of the neural model and evaluates them
using Python’s <span class="ltx_text ltx_font_typewriter" id="S4.SS1.p2.1.3">eval</span> function, demonstrating the ability of <span class="ltx_text ltx_font_smallcaps" id="S4.SS1.p2.1.4">Dolphin</span> to support black-box functions.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS1.p3">
<p class="ltx_p" id="S4.SS1.p3.1"><span class="ltx_text ltx_font_bold" id="S4.SS1.p3.1.1">PathFinder.</span>
PathFinder (or Path) from  <cite class="ltx_cite ltx_citemacro_cite">Tay et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03348v1#bib.bib19" title="">2020</a>)</cite> tests the ability of an agent to reason over long-range dependencies within an input image. The image consisting of two dots and a sequence of curved and dashed lines. The task is to identify whether the two dots are connected via the lines.
We consider three versions of this task based on the image size in pixels: small (32 x 32), medium
(128 x 128), and large (256 x 256).
The perception model for this task is also a standard CNN.
However, the <span class="ltx_text ltx_font_smallcaps" id="S4.SS1.p3.1.2">Dolphin</span> program for this task is recursive, since it must search for paths between the two dots.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS1.p4">
<p class="ltx_p" id="S4.SS1.p4.1"><span class="ltx_text ltx_font_bold" id="S4.SS1.p4.1.1">CLUTRR.</span>
In this task from <cite class="ltx_cite ltx_citemacro_cite">Sinha et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03348v1#bib.bib17" title="">2019</a>)</cite>, the input is a passage of text containing some information about several individuals and some of their relationships. The task is then to infer the relationship between two given individuals, which is not explicitly provided in the input. Hence, the <span class="ltx_text ltx_font_smallcaps" id="S4.SS1.p4.1.2">Dolphin</span> program for this task needs to reason over long chains of relationships recursively. We consider two versions of this task, where the training data contains relation chains of lengths up to 3 (small) or 4 (medium). We use Roberta-base <cite class="ltx_cite ltx_citemacro_citep">(Liu, <a class="ltx_ref" href="https://arxiv.org/html/2410.03348v1#bib.bib10" title="">2019</a>)</cite> as the language model for this task.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS1.p5">
<p class="ltx_p" id="S4.SS1.p5.1"><span class="ltx_text ltx_font_bold" id="S4.SS1.p5.1.1">Mugen.</span>
In this task from <cite class="ltx_cite ltx_citemacro_cite">Hayes et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03348v1#bib.bib5" title="">2022</a>)</cite>, the input is a video of gameplay footage that is 3.2 seconds long and a natural language passage captioning the video.
The goal is to measure how aligned the text is with the video.
This task therefore has two variants: Mugen-TVR, where the model must retrieve the video that best aligns with the
text, and Mugen-VTR, where the model must retrieve the text that best aligns with the video.
This benchmark tests the ability of the model to reason over multimodal data. We consider two versions of this task: small, with 1000 training samples, and medium, with 5000 training samples.
We use a combination of DistilBert <cite class="ltx_cite ltx_citemacro_citep">(Sanh, <a class="ltx_ref" href="https://arxiv.org/html/2410.03348v1#bib.bib16" title="">2019</a>)</cite> and S3D <cite class="ltx_cite ltx_citemacro_citep">(De Smet et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03348v1#bib.bib3" title="">2024</a>)</cite> as the perception model for the text and video inputs respectively.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Experimental Setup and Baselines</h3>
<div class="ltx_para ltx_noindent" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.1"><span class="ltx_text ltx_font_bold" id="S4.SS2.p1.1.1">Setup.</span>
All experiments, with the exception of the CLUTRR benchmark, were run on machines with two 20-core Intel Xeon Gold 6248
CPUs, four NVIDIA GeForce RTX 4352 GPUs, and 768 GB RAM.
Since the CLUTRR benchmark requires a larger amount of GPU memory, it was run on a machine with 8 NVIDIA A100 40GB GPUs
instead.
We ran each tool thrice until convergence or until a timeout of 10 hours was reached and report the average best accuracy and training time.
The code of <span class="ltx_text ltx_font_smallcaps" id="S4.SS2.p1.1.2">Dolphin</span> and the benchmarks is provided in the supplementary material.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS2.p2">
<p class="ltx_p" id="S4.SS2.p2.1"><span class="ltx_text ltx_font_bold" id="S4.SS2.p2.1.1">Baselines.</span>
We select Scallop <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03348v1#bib.bib9" title="">2023</a>)</cite>, a contemporary state-of-the-art neurosymbolic framework supporting differentiable programming optimized to run on the CPU and use multiple cores to parallelize its computations.
We also choose two sampling-based gradient approximation methods, ISED <cite class="ltx_cite ltx_citemacro_citep">(Solko-Breslin et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03348v1#bib.bib18" title="">2024</a>)</cite> and IndeCateR+ <cite class="ltx_cite ltx_citemacro_citep">(De Smet et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03348v1#bib.bib3" title="">2024</a>)</cite>.
We compare <span class="ltx_text ltx_font_smallcaps" id="S4.SS2.p2.1.2">Dolphin</span> against Scallop on all benchmarks, and against ISED and IndeCateR on MNIST-SumN and HWF.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>RQ1: Scalability</h3>
<figure class="ltx_table" id="S4.T2">
<table class="ltx_tabular ltx_centering ltx_align_middle" id="S4.T2.11">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T2.11.12.1">
<td class="ltx_td ltx_align_left ltx_border_tt" id="S4.T2.11.12.1.1" style="padding-left:5.0pt;padding-right:5.0pt;"><span class="ltx_text ltx_font_bold" id="S4.T2.11.12.1.1.1">Task</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" colspan="2" id="S4.T2.11.12.1.2" style="padding-left:5.0pt;padding-right:5.0pt;"><span class="ltx_text ltx_font_bold ltx_font_smallcaps" id="S4.T2.11.12.1.2.1">Dolphin</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" colspan="3" id="S4.T2.11.12.1.3" style="padding-left:5.0pt;padding-right:5.0pt;"><span class="ltx_text ltx_font_bold" id="S4.T2.11.12.1.3.1">Scallop</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" colspan="3" id="S4.T2.11.12.1.4" style="padding-left:5.0pt;padding-right:5.0pt;"><span class="ltx_text ltx_font_bold" id="S4.T2.11.12.1.4.1">ISED</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="3" id="S4.T2.11.12.1.5" style="padding-left:5.0pt;padding-right:5.0pt;"><span class="ltx_text ltx_font_bold" id="S4.T2.11.12.1.5.1">IndeCateR+</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.11.11">
<td class="ltx_td ltx_border_t" id="S4.T2.11.11.12" style="padding-left:5.0pt;padding-right:5.0pt;"></td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T2.1.1.1" style="padding-left:5.0pt;padding-right:5.0pt;"><math alttext="\text{T}_{\text{total}}" class="ltx_Math" display="inline" id="S4.T2.1.1.1.m1.1"><semantics id="S4.T2.1.1.1.m1.1a"><msub id="S4.T2.1.1.1.m1.1.1" xref="S4.T2.1.1.1.m1.1.1.cmml"><mtext id="S4.T2.1.1.1.m1.1.1.2" xref="S4.T2.1.1.1.m1.1.1.2a.cmml">T</mtext><mtext id="S4.T2.1.1.1.m1.1.1.3" xref="S4.T2.1.1.1.m1.1.1.3a.cmml">total</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.T2.1.1.1.m1.1b"><apply id="S4.T2.1.1.1.m1.1.1.cmml" xref="S4.T2.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T2.1.1.1.m1.1.1.1.cmml" xref="S4.T2.1.1.1.m1.1.1">subscript</csymbol><ci id="S4.T2.1.1.1.m1.1.1.2a.cmml" xref="S4.T2.1.1.1.m1.1.1.2"><mtext id="S4.T2.1.1.1.m1.1.1.2.cmml" xref="S4.T2.1.1.1.m1.1.1.2">T</mtext></ci><ci id="S4.T2.1.1.1.m1.1.1.3a.cmml" xref="S4.T2.1.1.1.m1.1.1.3"><mtext id="S4.T2.1.1.1.m1.1.1.3.cmml" mathsize="70%" xref="S4.T2.1.1.1.m1.1.1.3">total</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.1.1.1.m1.1c">\text{T}_{\text{total}}</annotation><annotation encoding="application/x-llamapun" id="S4.T2.1.1.1.m1.1d">T start_POSTSUBSCRIPT total end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_right ltx_border_r ltx_border_t" id="S4.T2.2.2.2" style="padding-left:5.0pt;padding-right:5.0pt;"><math alttext="\text{T}_{\text{epoch}}" class="ltx_Math" display="inline" id="S4.T2.2.2.2.m1.1"><semantics id="S4.T2.2.2.2.m1.1a"><msub id="S4.T2.2.2.2.m1.1.1" xref="S4.T2.2.2.2.m1.1.1.cmml"><mtext id="S4.T2.2.2.2.m1.1.1.2" xref="S4.T2.2.2.2.m1.1.1.2a.cmml">T</mtext><mtext id="S4.T2.2.2.2.m1.1.1.3" xref="S4.T2.2.2.2.m1.1.1.3a.cmml">epoch</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.T2.2.2.2.m1.1b"><apply id="S4.T2.2.2.2.m1.1.1.cmml" xref="S4.T2.2.2.2.m1.1.1"><csymbol cd="ambiguous" id="S4.T2.2.2.2.m1.1.1.1.cmml" xref="S4.T2.2.2.2.m1.1.1">subscript</csymbol><ci id="S4.T2.2.2.2.m1.1.1.2a.cmml" xref="S4.T2.2.2.2.m1.1.1.2"><mtext id="S4.T2.2.2.2.m1.1.1.2.cmml" xref="S4.T2.2.2.2.m1.1.1.2">T</mtext></ci><ci id="S4.T2.2.2.2.m1.1.1.3a.cmml" xref="S4.T2.2.2.2.m1.1.1.3"><mtext id="S4.T2.2.2.2.m1.1.1.3.cmml" mathsize="70%" xref="S4.T2.2.2.2.m1.1.1.3">epoch</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.2.2.2.m1.1c">\text{T}_{\text{epoch}}</annotation><annotation encoding="application/x-llamapun" id="S4.T2.2.2.2.m1.1d">T start_POSTSUBSCRIPT epoch end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T2.3.3.3" style="padding-left:5.0pt;padding-right:5.0pt;"><math alttext="\text{T}_{\text{total}}" class="ltx_Math" display="inline" id="S4.T2.3.3.3.m1.1"><semantics id="S4.T2.3.3.3.m1.1a"><msub id="S4.T2.3.3.3.m1.1.1" xref="S4.T2.3.3.3.m1.1.1.cmml"><mtext id="S4.T2.3.3.3.m1.1.1.2" xref="S4.T2.3.3.3.m1.1.1.2a.cmml">T</mtext><mtext id="S4.T2.3.3.3.m1.1.1.3" xref="S4.T2.3.3.3.m1.1.1.3a.cmml">total</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.T2.3.3.3.m1.1b"><apply id="S4.T2.3.3.3.m1.1.1.cmml" xref="S4.T2.3.3.3.m1.1.1"><csymbol cd="ambiguous" id="S4.T2.3.3.3.m1.1.1.1.cmml" xref="S4.T2.3.3.3.m1.1.1">subscript</csymbol><ci id="S4.T2.3.3.3.m1.1.1.2a.cmml" xref="S4.T2.3.3.3.m1.1.1.2"><mtext id="S4.T2.3.3.3.m1.1.1.2.cmml" xref="S4.T2.3.3.3.m1.1.1.2">T</mtext></ci><ci id="S4.T2.3.3.3.m1.1.1.3a.cmml" xref="S4.T2.3.3.3.m1.1.1.3"><mtext id="S4.T2.3.3.3.m1.1.1.3.cmml" mathsize="70%" xref="S4.T2.3.3.3.m1.1.1.3">total</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.3.3.3.m1.1c">\text{T}_{\text{total}}</annotation><annotation encoding="application/x-llamapun" id="S4.T2.3.3.3.m1.1d">T start_POSTSUBSCRIPT total end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T2.4.4.4" style="padding-left:5.0pt;padding-right:5.0pt;"><math alttext="\text{T}_{\text{epoch}}" class="ltx_Math" display="inline" id="S4.T2.4.4.4.m1.1"><semantics id="S4.T2.4.4.4.m1.1a"><msub id="S4.T2.4.4.4.m1.1.1" xref="S4.T2.4.4.4.m1.1.1.cmml"><mtext id="S4.T2.4.4.4.m1.1.1.2" xref="S4.T2.4.4.4.m1.1.1.2a.cmml">T</mtext><mtext id="S4.T2.4.4.4.m1.1.1.3" xref="S4.T2.4.4.4.m1.1.1.3a.cmml">epoch</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.T2.4.4.4.m1.1b"><apply id="S4.T2.4.4.4.m1.1.1.cmml" xref="S4.T2.4.4.4.m1.1.1"><csymbol cd="ambiguous" id="S4.T2.4.4.4.m1.1.1.1.cmml" xref="S4.T2.4.4.4.m1.1.1">subscript</csymbol><ci id="S4.T2.4.4.4.m1.1.1.2a.cmml" xref="S4.T2.4.4.4.m1.1.1.2"><mtext id="S4.T2.4.4.4.m1.1.1.2.cmml" xref="S4.T2.4.4.4.m1.1.1.2">T</mtext></ci><ci id="S4.T2.4.4.4.m1.1.1.3a.cmml" xref="S4.T2.4.4.4.m1.1.1.3"><mtext id="S4.T2.4.4.4.m1.1.1.3.cmml" mathsize="70%" xref="S4.T2.4.4.4.m1.1.1.3">epoch</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.4.4.4.m1.1c">\text{T}_{\text{epoch}}</annotation><annotation encoding="application/x-llamapun" id="S4.T2.4.4.4.m1.1d">T start_POSTSUBSCRIPT epoch end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_right ltx_border_r ltx_border_t" id="S4.T2.5.5.5" style="padding-left:5.0pt;padding-right:5.0pt;"><math alttext="\alpha" class="ltx_Math" display="inline" id="S4.T2.5.5.5.m1.1"><semantics id="S4.T2.5.5.5.m1.1a"><mi id="S4.T2.5.5.5.m1.1.1" xref="S4.T2.5.5.5.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S4.T2.5.5.5.m1.1b"><ci id="S4.T2.5.5.5.m1.1.1.cmml" xref="S4.T2.5.5.5.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.5.5.5.m1.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="S4.T2.5.5.5.m1.1d">italic_α</annotation></semantics></math></td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T2.6.6.6" style="padding-left:5.0pt;padding-right:5.0pt;"><math alttext="\text{T}_{\text{total}}" class="ltx_Math" display="inline" id="S4.T2.6.6.6.m1.1"><semantics id="S4.T2.6.6.6.m1.1a"><msub id="S4.T2.6.6.6.m1.1.1" xref="S4.T2.6.6.6.m1.1.1.cmml"><mtext id="S4.T2.6.6.6.m1.1.1.2" xref="S4.T2.6.6.6.m1.1.1.2a.cmml">T</mtext><mtext id="S4.T2.6.6.6.m1.1.1.3" xref="S4.T2.6.6.6.m1.1.1.3a.cmml">total</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.T2.6.6.6.m1.1b"><apply id="S4.T2.6.6.6.m1.1.1.cmml" xref="S4.T2.6.6.6.m1.1.1"><csymbol cd="ambiguous" id="S4.T2.6.6.6.m1.1.1.1.cmml" xref="S4.T2.6.6.6.m1.1.1">subscript</csymbol><ci id="S4.T2.6.6.6.m1.1.1.2a.cmml" xref="S4.T2.6.6.6.m1.1.1.2"><mtext id="S4.T2.6.6.6.m1.1.1.2.cmml" xref="S4.T2.6.6.6.m1.1.1.2">T</mtext></ci><ci id="S4.T2.6.6.6.m1.1.1.3a.cmml" xref="S4.T2.6.6.6.m1.1.1.3"><mtext id="S4.T2.6.6.6.m1.1.1.3.cmml" mathsize="70%" xref="S4.T2.6.6.6.m1.1.1.3">total</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.6.6.6.m1.1c">\text{T}_{\text{total}}</annotation><annotation encoding="application/x-llamapun" id="S4.T2.6.6.6.m1.1d">T start_POSTSUBSCRIPT total end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T2.7.7.7" style="padding-left:5.0pt;padding-right:5.0pt;"><math alttext="\text{T}_{\text{epoch}}" class="ltx_Math" display="inline" id="S4.T2.7.7.7.m1.1"><semantics id="S4.T2.7.7.7.m1.1a"><msub id="S4.T2.7.7.7.m1.1.1" xref="S4.T2.7.7.7.m1.1.1.cmml"><mtext id="S4.T2.7.7.7.m1.1.1.2" xref="S4.T2.7.7.7.m1.1.1.2a.cmml">T</mtext><mtext id="S4.T2.7.7.7.m1.1.1.3" xref="S4.T2.7.7.7.m1.1.1.3a.cmml">epoch</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.T2.7.7.7.m1.1b"><apply id="S4.T2.7.7.7.m1.1.1.cmml" xref="S4.T2.7.7.7.m1.1.1"><csymbol cd="ambiguous" id="S4.T2.7.7.7.m1.1.1.1.cmml" xref="S4.T2.7.7.7.m1.1.1">subscript</csymbol><ci id="S4.T2.7.7.7.m1.1.1.2a.cmml" xref="S4.T2.7.7.7.m1.1.1.2"><mtext id="S4.T2.7.7.7.m1.1.1.2.cmml" xref="S4.T2.7.7.7.m1.1.1.2">T</mtext></ci><ci id="S4.T2.7.7.7.m1.1.1.3a.cmml" xref="S4.T2.7.7.7.m1.1.1.3"><mtext id="S4.T2.7.7.7.m1.1.1.3.cmml" mathsize="70%" xref="S4.T2.7.7.7.m1.1.1.3">epoch</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.7.7.7.m1.1c">\text{T}_{\text{epoch}}</annotation><annotation encoding="application/x-llamapun" id="S4.T2.7.7.7.m1.1d">T start_POSTSUBSCRIPT epoch end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_right ltx_border_r ltx_border_t" id="S4.T2.8.8.8" style="padding-left:5.0pt;padding-right:5.0pt;"><math alttext="\alpha" class="ltx_Math" display="inline" id="S4.T2.8.8.8.m1.1"><semantics id="S4.T2.8.8.8.m1.1a"><mi id="S4.T2.8.8.8.m1.1.1" xref="S4.T2.8.8.8.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S4.T2.8.8.8.m1.1b"><ci id="S4.T2.8.8.8.m1.1.1.cmml" xref="S4.T2.8.8.8.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.8.8.8.m1.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="S4.T2.8.8.8.m1.1d">italic_α</annotation></semantics></math></td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T2.9.9.9" style="padding-left:5.0pt;padding-right:5.0pt;"><math alttext="\text{T}_{\text{total}}" class="ltx_Math" display="inline" id="S4.T2.9.9.9.m1.1"><semantics id="S4.T2.9.9.9.m1.1a"><msub id="S4.T2.9.9.9.m1.1.1" xref="S4.T2.9.9.9.m1.1.1.cmml"><mtext id="S4.T2.9.9.9.m1.1.1.2" xref="S4.T2.9.9.9.m1.1.1.2a.cmml">T</mtext><mtext id="S4.T2.9.9.9.m1.1.1.3" xref="S4.T2.9.9.9.m1.1.1.3a.cmml">total</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.T2.9.9.9.m1.1b"><apply id="S4.T2.9.9.9.m1.1.1.cmml" xref="S4.T2.9.9.9.m1.1.1"><csymbol cd="ambiguous" id="S4.T2.9.9.9.m1.1.1.1.cmml" xref="S4.T2.9.9.9.m1.1.1">subscript</csymbol><ci id="S4.T2.9.9.9.m1.1.1.2a.cmml" xref="S4.T2.9.9.9.m1.1.1.2"><mtext id="S4.T2.9.9.9.m1.1.1.2.cmml" xref="S4.T2.9.9.9.m1.1.1.2">T</mtext></ci><ci id="S4.T2.9.9.9.m1.1.1.3a.cmml" xref="S4.T2.9.9.9.m1.1.1.3"><mtext id="S4.T2.9.9.9.m1.1.1.3.cmml" mathsize="70%" xref="S4.T2.9.9.9.m1.1.1.3">total</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.9.9.9.m1.1c">\text{T}_{\text{total}}</annotation><annotation encoding="application/x-llamapun" id="S4.T2.9.9.9.m1.1d">T start_POSTSUBSCRIPT total end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T2.10.10.10" style="padding-left:5.0pt;padding-right:5.0pt;"><math alttext="\text{T}_{\text{epoch}}" class="ltx_Math" display="inline" id="S4.T2.10.10.10.m1.1"><semantics id="S4.T2.10.10.10.m1.1a"><msub id="S4.T2.10.10.10.m1.1.1" xref="S4.T2.10.10.10.m1.1.1.cmml"><mtext id="S4.T2.10.10.10.m1.1.1.2" xref="S4.T2.10.10.10.m1.1.1.2a.cmml">T</mtext><mtext id="S4.T2.10.10.10.m1.1.1.3" xref="S4.T2.10.10.10.m1.1.1.3a.cmml">epoch</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.T2.10.10.10.m1.1b"><apply id="S4.T2.10.10.10.m1.1.1.cmml" xref="S4.T2.10.10.10.m1.1.1"><csymbol cd="ambiguous" id="S4.T2.10.10.10.m1.1.1.1.cmml" xref="S4.T2.10.10.10.m1.1.1">subscript</csymbol><ci id="S4.T2.10.10.10.m1.1.1.2a.cmml" xref="S4.T2.10.10.10.m1.1.1.2"><mtext id="S4.T2.10.10.10.m1.1.1.2.cmml" xref="S4.T2.10.10.10.m1.1.1.2">T</mtext></ci><ci id="S4.T2.10.10.10.m1.1.1.3a.cmml" xref="S4.T2.10.10.10.m1.1.1.3"><mtext id="S4.T2.10.10.10.m1.1.1.3.cmml" mathsize="70%" xref="S4.T2.10.10.10.m1.1.1.3">epoch</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.10.10.10.m1.1c">\text{T}_{\text{epoch}}</annotation><annotation encoding="application/x-llamapun" id="S4.T2.10.10.10.m1.1d">T start_POSTSUBSCRIPT epoch end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T2.11.11.11" style="padding-left:5.0pt;padding-right:5.0pt;"><math alttext="\alpha" class="ltx_Math" display="inline" id="S4.T2.11.11.11.m1.1"><semantics id="S4.T2.11.11.11.m1.1a"><mi id="S4.T2.11.11.11.m1.1.1" xref="S4.T2.11.11.11.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S4.T2.11.11.11.m1.1b"><ci id="S4.T2.11.11.11.m1.1.1.cmml" xref="S4.T2.11.11.11.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.11.11.11.m1.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="S4.T2.11.11.11.m1.1d">italic_α</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S4.T2.11.13.2">
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T2.11.13.2.1" style="padding-left:5.0pt;padding-right:5.0pt;">SumN (S)</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T2.11.13.2.2" style="padding-left:5.0pt;padding-right:5.0pt;">78.33</td>
<td class="ltx_td ltx_align_right ltx_border_r ltx_border_t" id="S4.T2.11.13.2.3" style="padding-left:5.0pt;padding-right:5.0pt;"><span class="ltx_text ltx_font_bold" id="S4.T2.11.13.2.3.1">15.67</span></td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T2.11.13.2.4" style="padding-left:5.0pt;padding-right:5.0pt;">923.78</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T2.11.13.2.5" style="padding-left:5.0pt;padding-right:5.0pt;">184.76</td>
<td class="ltx_td ltx_align_right ltx_border_r ltx_border_t" id="S4.T2.11.13.2.6" style="padding-left:5.0pt;padding-right:5.0pt;">11.80</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T2.11.13.2.7" style="padding-left:5.0pt;padding-right:5.0pt;">299.63</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T2.11.13.2.8" style="padding-left:5.0pt;padding-right:5.0pt;">59.93</td>
<td class="ltx_td ltx_align_right ltx_border_r ltx_border_t" id="S4.T2.11.13.2.9" style="padding-left:5.0pt;padding-right:5.0pt;">3.82</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T2.11.13.2.10" style="padding-left:5.0pt;padding-right:5.0pt;">3.16e3</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T2.11.13.2.11" style="padding-left:5.0pt;padding-right:5.0pt;">632.52</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T2.11.13.2.12" style="padding-left:5.0pt;padding-right:5.0pt;">40.36</td>
</tr>
<tr class="ltx_tr" id="S4.T2.11.14.3">
<td class="ltx_td ltx_align_left" id="S4.T2.11.14.3.1" style="padding-left:5.0pt;padding-right:5.0pt;">SumN (M)</td>
<td class="ltx_td ltx_align_right" id="S4.T2.11.14.3.2" style="padding-left:5.0pt;padding-right:5.0pt;">144.92</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="S4.T2.11.14.3.3" style="padding-left:5.0pt;padding-right:5.0pt;"><span class="ltx_text ltx_font_bold" id="S4.T2.11.14.3.3.1">14.49</span></td>
<td class="ltx_td ltx_align_right" id="S4.T2.11.14.3.4" style="padding-left:5.0pt;padding-right:5.0pt;">3.41e3</td>
<td class="ltx_td ltx_align_right" id="S4.T2.11.14.3.5" style="padding-left:5.0pt;padding-right:5.0pt;">341.57</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="S4.T2.11.14.3.6" style="padding-left:5.0pt;padding-right:5.0pt;">23.57</td>
<td class="ltx_td ltx_align_right" id="S4.T2.11.14.3.7" style="padding-left:5.0pt;padding-right:5.0pt;">2.16e3</td>
<td class="ltx_td ltx_align_right" id="S4.T2.11.14.3.8" style="padding-left:5.0pt;padding-right:5.0pt;">216.54</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="S4.T2.11.14.3.9" style="padding-left:5.0pt;padding-right:5.0pt;">14.94</td>
<td class="ltx_td ltx_align_right" id="S4.T2.11.14.3.10" style="padding-left:5.0pt;padding-right:5.0pt;">2.63e4</td>
<td class="ltx_td ltx_align_right" id="S4.T2.11.14.3.11" style="padding-left:5.0pt;padding-right:5.0pt;">2.63e3</td>
<td class="ltx_td ltx_align_right" id="S4.T2.11.14.3.12" style="padding-left:5.0pt;padding-right:5.0pt;">181.88</td>
</tr>
<tr class="ltx_tr" id="S4.T2.11.15.4">
<td class="ltx_td ltx_align_left" id="S4.T2.11.15.4.1" style="padding-left:5.0pt;padding-right:5.0pt;">SumN (L)</td>
<td class="ltx_td ltx_align_right" id="S4.T2.11.15.4.2" style="padding-left:5.0pt;padding-right:5.0pt;">220.47</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="S4.T2.11.15.4.3" style="padding-left:5.0pt;padding-right:5.0pt;"><span class="ltx_text ltx_font_bold" id="S4.T2.11.15.4.3.1">14.70</span></td>
<td class="ltx_td ltx_align_right" id="S4.T2.11.15.4.4" style="padding-left:5.0pt;padding-right:5.0pt;">7.41e3</td>
<td class="ltx_td ltx_align_right" id="S4.T2.11.15.4.5" style="padding-left:5.0pt;padding-right:5.0pt;">493.87</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="S4.T2.11.15.4.6" style="padding-left:5.0pt;padding-right:5.0pt;">33.60</td>
<td class="ltx_td ltx_align_right" id="S4.T2.11.15.4.7" style="padding-left:5.0pt;padding-right:5.0pt;">9.8e3</td>
<td class="ltx_td ltx_align_right" id="S4.T2.11.15.4.8" style="padding-left:5.0pt;padding-right:5.0pt;">653.39</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="S4.T2.11.15.4.9" style="padding-left:5.0pt;padding-right:5.0pt;">44.45</td>
<td class="ltx_td ltx_align_right" id="S4.T2.11.15.4.10" style="padding-left:5.0pt;padding-right:5.0pt;">TO</td>
<td class="ltx_td ltx_align_right" id="S4.T2.11.15.4.11" style="padding-left:5.0pt;padding-right:5.0pt;">2.27e3</td>
<td class="ltx_td ltx_align_right" id="S4.T2.11.15.4.12" style="padding-left:5.0pt;padding-right:5.0pt;">154.37</td>
</tr>
<tr class="ltx_tr" id="S4.T2.11.16.5">
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T2.11.16.5.1" style="padding-left:5.0pt;padding-right:5.0pt;">HWF (S)</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T2.11.16.5.2" style="padding-left:5.0pt;padding-right:5.0pt;">3.17e3</td>
<td class="ltx_td ltx_align_right ltx_border_r ltx_border_t" id="S4.T2.11.16.5.3" style="padding-left:5.0pt;padding-right:5.0pt;"><span class="ltx_text ltx_font_bold" id="S4.T2.11.16.5.3.1">158.79</span></td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T2.11.16.5.4" style="padding-left:5.0pt;padding-right:5.0pt;">9.99e3</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T2.11.16.5.5" style="padding-left:5.0pt;padding-right:5.0pt;">499.57</td>
<td class="ltx_td ltx_align_right ltx_border_r ltx_border_t" id="S4.T2.11.16.5.6" style="padding-left:5.0pt;padding-right:5.0pt;">3.15</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T2.11.16.5.7" style="padding-left:5.0pt;padding-right:5.0pt;">1.58e4</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T2.11.16.5.8" style="padding-left:5.0pt;padding-right:5.0pt;">790.04</td>
<td class="ltx_td ltx_align_right ltx_border_r ltx_border_t" id="S4.T2.11.16.5.9" style="padding-left:5.0pt;padding-right:5.0pt;">4.97</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T2.11.16.5.10" style="padding-left:5.0pt;padding-right:5.0pt;">1.76e4</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T2.11.16.5.11" style="padding-left:5.0pt;padding-right:5.0pt;">877.92</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T2.11.16.5.12" style="padding-left:5.0pt;padding-right:5.0pt;">5.52</td>
</tr>
<tr class="ltx_tr" id="S4.T2.11.17.6">
<td class="ltx_td ltx_align_left" id="S4.T2.11.17.6.1" style="padding-left:5.0pt;padding-right:5.0pt;">HWF (M)</td>
<td class="ltx_td ltx_align_right" id="S4.T2.11.17.6.2" style="padding-left:5.0pt;padding-right:5.0pt;">1.46e4</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="S4.T2.11.17.6.3" style="padding-left:5.0pt;padding-right:5.0pt;"><span class="ltx_text ltx_font_bold" id="S4.T2.11.17.6.3.1">731.67</span></td>
<td class="ltx_td ltx_align_right" id="S4.T2.11.17.6.4" style="padding-left:5.0pt;padding-right:5.0pt;">TO</td>
<td class="ltx_td ltx_align_right" id="S4.T2.11.17.6.5" style="padding-left:5.0pt;padding-right:5.0pt;">1.49e4</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="S4.T2.11.17.6.6" style="padding-left:5.0pt;padding-right:5.0pt;">20.41</td>
<td class="ltx_td ltx_align_right" id="S4.T2.11.17.6.7" style="padding-left:5.0pt;padding-right:5.0pt;">TO</td>
<td class="ltx_td ltx_align_right" id="S4.T2.11.17.6.8" style="padding-left:5.0pt;padding-right:5.0pt;">6.83e3</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="S4.T2.11.17.6.9" style="padding-left:5.0pt;padding-right:5.0pt;">9.34</td>
<td class="ltx_td ltx_align_right" id="S4.T2.11.17.6.10" style="padding-left:5.0pt;padding-right:5.0pt;">TO</td>
<td class="ltx_td ltx_align_right" id="S4.T2.11.17.6.11" style="padding-left:5.0pt;padding-right:5.0pt;">3.6e3</td>
<td class="ltx_td ltx_align_right" id="S4.T2.11.17.6.12" style="padding-left:5.0pt;padding-right:5.0pt;">4.93</td>
</tr>
<tr class="ltx_tr" id="S4.T2.11.18.7">
<td class="ltx_td ltx_align_left" id="S4.T2.11.18.7.1" style="padding-left:5.0pt;padding-right:5.0pt;">HWF (L)</td>
<td class="ltx_td ltx_align_right" id="S4.T2.11.18.7.2" style="padding-left:5.0pt;padding-right:5.0pt;">2.42e4</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="S4.T2.11.18.7.3" style="padding-left:5.0pt;padding-right:5.0pt;"><span class="ltx_text ltx_font_bold" id="S4.T2.11.18.7.3.1">1.21e3</span></td>
<td class="ltx_td ltx_align_right" id="S4.T2.11.18.7.4" style="padding-left:5.0pt;padding-right:5.0pt;">TO</td>
<td class="ltx_td ltx_align_right" id="S4.T2.11.18.7.5" style="padding-left:5.0pt;padding-right:5.0pt;">3.92e5</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="S4.T2.11.18.7.6" style="padding-left:5.0pt;padding-right:5.0pt;">323.21</td>
<td class="ltx_td ltx_align_right" id="S4.T2.11.18.7.7" style="padding-left:5.0pt;padding-right:5.0pt;">TO</td>
<td class="ltx_td ltx_align_right" id="S4.T2.11.18.7.8" style="padding-left:5.0pt;padding-right:5.0pt;">1.05e4</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="S4.T2.11.18.7.9" style="padding-left:5.0pt;padding-right:5.0pt;">8.61</td>
<td class="ltx_td ltx_align_right" id="S4.T2.11.18.7.10" style="padding-left:5.0pt;padding-right:5.0pt;">TO</td>
<td class="ltx_td ltx_align_right" id="S4.T2.11.18.7.11" style="padding-left:5.0pt;padding-right:5.0pt;">5.59e3</td>
<td class="ltx_td ltx_align_right" id="S4.T2.11.18.7.12" style="padding-left:5.0pt;padding-right:5.0pt;">4.61</td>
</tr>
<tr class="ltx_tr" id="S4.T2.11.19.8">
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T2.11.19.8.1" style="padding-left:5.0pt;padding-right:5.0pt;">Path (S)</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T2.11.19.8.2" style="padding-left:5.0pt;padding-right:5.0pt;">1.08e4</td>
<td class="ltx_td ltx_align_right ltx_border_r ltx_border_t" id="S4.T2.11.19.8.3" style="padding-left:5.0pt;padding-right:5.0pt;"><span class="ltx_text ltx_font_bold" id="S4.T2.11.19.8.3.1">1.08e3</span></td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T2.11.19.8.4" style="padding-left:5.0pt;padding-right:5.0pt;">2.2e4</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T2.11.19.8.5" style="padding-left:5.0pt;padding-right:5.0pt;">2.2e3</td>
<td class="ltx_td ltx_align_right ltx_border_r ltx_border_t" id="S4.T2.11.19.8.6" style="padding-left:5.0pt;padding-right:5.0pt;">2.03</td>
<td class="ltx_td ltx_align_center ltx_border_t" colspan="6" id="S4.T2.11.19.8.7" rowspan="3" style="padding-left:5.0pt;padding-right:5.0pt;"><span class="ltx_text" id="S4.T2.11.19.8.7.1">N.A.</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.11.20.9">
<td class="ltx_td ltx_align_left" id="S4.T2.11.20.9.1" style="padding-left:5.0pt;padding-right:5.0pt;">Path (M)</td>
<td class="ltx_td ltx_align_right" id="S4.T2.11.20.9.2" style="padding-left:5.0pt;padding-right:5.0pt;">1.79e4</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="S4.T2.11.20.9.3" style="padding-left:5.0pt;padding-right:5.0pt;"><span class="ltx_text ltx_font_bold" id="S4.T2.11.20.9.3.1">1.79e3</span></td>
<td class="ltx_td ltx_align_right" id="S4.T2.11.20.9.4" style="padding-left:5.0pt;padding-right:5.0pt;">TO</td>
<td class="ltx_td ltx_align_right" id="S4.T2.11.20.9.5" style="padding-left:5.0pt;padding-right:5.0pt;">4.17e3</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="S4.T2.11.20.9.6" style="padding-left:5.0pt;padding-right:5.0pt;">2.32</td>
</tr>
<tr class="ltx_tr" id="S4.T2.11.21.10">
<td class="ltx_td ltx_align_left" id="S4.T2.11.21.10.1" style="padding-left:5.0pt;padding-right:5.0pt;">Path (L)</td>
<td class="ltx_td ltx_align_right" id="S4.T2.11.21.10.2" style="padding-left:5.0pt;padding-right:5.0pt;">1.94e4</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="S4.T2.11.21.10.3" style="padding-left:5.0pt;padding-right:5.0pt;"><span class="ltx_text ltx_font_bold" id="S4.T2.11.21.10.3.1">1.94e3</span></td>
<td class="ltx_td ltx_align_right" id="S4.T2.11.21.10.4" style="padding-left:5.0pt;padding-right:5.0pt;">TO</td>
<td class="ltx_td ltx_align_right" id="S4.T2.11.21.10.5" style="padding-left:5.0pt;padding-right:5.0pt;">1.12e4</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="S4.T2.11.21.10.6" style="padding-left:5.0pt;padding-right:5.0pt;">5.81</td>
</tr>
<tr class="ltx_tr" id="S4.T2.11.22.11">
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T2.11.22.11.1" style="padding-left:5.0pt;padding-right:5.0pt;">CLUTRR (S)</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T2.11.22.11.2" style="padding-left:5.0pt;padding-right:5.0pt;">1.54e3</td>
<td class="ltx_td ltx_align_right ltx_border_r ltx_border_t" id="S4.T2.11.22.11.3" style="padding-left:5.0pt;padding-right:5.0pt;"><span class="ltx_text ltx_font_bold" id="S4.T2.11.22.11.3.1">154.85</span></td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T2.11.22.11.4" style="padding-left:5.0pt;padding-right:5.0pt;">4.29e3</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T2.11.22.11.5" style="padding-left:5.0pt;padding-right:5.0pt;">429.97</td>
<td class="ltx_td ltx_align_right ltx_border_r ltx_border_t" id="S4.T2.11.22.11.6" style="padding-left:5.0pt;padding-right:5.0pt;">2.77</td>
<td class="ltx_td ltx_align_center ltx_border_t" colspan="6" id="S4.T2.11.22.11.7" rowspan="2" style="padding-left:5.0pt;padding-right:5.0pt;"><span class="ltx_text" id="S4.T2.11.22.11.7.1">N.A.</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.11.23.12">
<td class="ltx_td ltx_align_left" id="S4.T2.11.23.12.1" style="padding-left:5.0pt;padding-right:5.0pt;">CLUTRR (M)</td>
<td class="ltx_td ltx_align_right" id="S4.T2.11.23.12.2" style="padding-left:5.0pt;padding-right:5.0pt;">2.91e3</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="S4.T2.11.23.12.3" style="padding-left:5.0pt;padding-right:5.0pt;"><span class="ltx_text ltx_font_bold" id="S4.T2.11.23.12.3.1">291.36</span></td>
<td class="ltx_td ltx_align_right" id="S4.T2.11.23.12.4" style="padding-left:5.0pt;padding-right:5.0pt;">7.83e3</td>
<td class="ltx_td ltx_align_right" id="S4.T2.11.23.12.5" style="padding-left:5.0pt;padding-right:5.0pt;">783.11</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="S4.T2.11.23.12.6" style="padding-left:5.0pt;padding-right:5.0pt;">2.69</td>
</tr>
<tr class="ltx_tr" id="S4.T2.11.24.13">
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T2.11.24.13.1" style="padding-left:5.0pt;padding-right:5.0pt;">Mugen (S)</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T2.11.24.13.2" style="padding-left:5.0pt;padding-right:5.0pt;">3.62e3</td>
<td class="ltx_td ltx_align_right ltx_border_r ltx_border_t" id="S4.T2.11.24.13.3" style="padding-left:5.0pt;padding-right:5.0pt;">180.80</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T2.11.24.13.4" style="padding-left:5.0pt;padding-right:5.0pt;">1.34e4</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T2.11.24.13.5" style="padding-left:5.0pt;padding-right:5.0pt;"><span class="ltx_text ltx_font_bold" id="S4.T2.11.24.13.5.1">133.68</span></td>
<td class="ltx_td ltx_align_right ltx_border_r ltx_border_t" id="S4.T2.11.24.13.6" style="padding-left:5.0pt;padding-right:5.0pt;">0.74</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" colspan="6" id="S4.T2.11.24.13.7" rowspan="2" style="padding-left:5.0pt;padding-right:5.0pt;"><span class="ltx_text" id="S4.T2.11.24.13.7.1">N.A.</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.11.25.14">
<td class="ltx_td ltx_align_left ltx_border_bb" id="S4.T2.11.25.14.1" style="padding-left:5.0pt;padding-right:5.0pt;">Mugen (M)</td>
<td class="ltx_td ltx_align_right ltx_border_bb" id="S4.T2.11.25.14.2" style="padding-left:5.0pt;padding-right:5.0pt;">1.78e3</td>
<td class="ltx_td ltx_align_right ltx_border_bb ltx_border_r" id="S4.T2.11.25.14.3" style="padding-left:5.0pt;padding-right:5.0pt;">890.34</td>
<td class="ltx_td ltx_align_right ltx_border_bb" id="S4.T2.11.25.14.4" style="padding-left:5.0pt;padding-right:5.0pt;">TO</td>
<td class="ltx_td ltx_align_right ltx_border_bb" id="S4.T2.11.25.14.5" style="padding-left:5.0pt;padding-right:5.0pt;"><span class="ltx_text ltx_font_bold" id="S4.T2.11.25.14.5.1">634.86</span></td>
<td class="ltx_td ltx_align_right ltx_border_bb ltx_border_r" id="S4.T2.11.25.14.6" style="padding-left:5.0pt;padding-right:5.0pt;">0.71</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 2: </span>Comparison of training times taken by each baseline. The Timeout (TO) is set at 10 hours. <math alttext="\alpha" class="ltx_Math" display="inline" id="S4.T2.13.m1.1"><semantics id="S4.T2.13.m1.1b"><mi id="S4.T2.13.m1.1.1" xref="S4.T2.13.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S4.T2.13.m1.1c"><ci id="S4.T2.13.m1.1.1.cmml" xref="S4.T2.13.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.13.m1.1d">\alpha</annotation><annotation encoding="application/x-llamapun" id="S4.T2.13.m1.1e">italic_α</annotation></semantics></math> is the scaling factor, which is the ratio of the per epoch training times of the baselines and <span class="ltx_text ltx_font_smallcaps" id="S4.T2.15.1">Dolphin</span>.</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="S4.SS3.p1">
<p class="ltx_p" id="S4.SS3.p1.3">Table <a class="ltx_ref" href="https://arxiv.org/html/2410.03348v1#S4.T2" title="Table 2 ‣ 4.3 RQ1: Scalability ‣ 4 Experiments ‣ 3.4 Building the Dolphin Program ‣ 3 The Dolphin Framework ‣ 2 Overview ‣ Dolphin: A Programmable Framework for Scalable Neurosymbolic Learning"><span class="ltx_text ltx_ref_tag">2</span></a> presents the training times for <span class="ltx_text ltx_font_smallcaps" id="S4.SS3.p1.3.1">Dolphin</span> and baselines on all benchmarks, along with the
total training time (<math alttext="T_{\textit{total}}" class="ltx_Math" display="inline" id="S4.SS3.p1.1.m1.1"><semantics id="S4.SS3.p1.1.m1.1a"><msub id="S4.SS3.p1.1.m1.1.1" xref="S4.SS3.p1.1.m1.1.1.cmml"><mi id="S4.SS3.p1.1.m1.1.1.2" xref="S4.SS3.p1.1.m1.1.1.2.cmml">T</mi><mtext class="ltx_mathvariant_italic" id="S4.SS3.p1.1.m1.1.1.3" xref="S4.SS3.p1.1.m1.1.1.3a.cmml">total</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.1.m1.1b"><apply id="S4.SS3.p1.1.m1.1.1.cmml" xref="S4.SS3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.1.m1.1.1.1.cmml" xref="S4.SS3.p1.1.m1.1.1">subscript</csymbol><ci id="S4.SS3.p1.1.m1.1.1.2.cmml" xref="S4.SS3.p1.1.m1.1.1.2">𝑇</ci><ci id="S4.SS3.p1.1.m1.1.1.3a.cmml" xref="S4.SS3.p1.1.m1.1.1.3"><mtext class="ltx_mathvariant_italic" id="S4.SS3.p1.1.m1.1.1.3.cmml" mathsize="70%" xref="S4.SS3.p1.1.m1.1.1.3">total</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.1.m1.1c">T_{\textit{total}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.1.m1.1d">italic_T start_POSTSUBSCRIPT total end_POSTSUBSCRIPT</annotation></semantics></math>), time per epoch (<math alttext="T_{\textit{epoch}}" class="ltx_Math" display="inline" id="S4.SS3.p1.2.m2.1"><semantics id="S4.SS3.p1.2.m2.1a"><msub id="S4.SS3.p1.2.m2.1.1" xref="S4.SS3.p1.2.m2.1.1.cmml"><mi id="S4.SS3.p1.2.m2.1.1.2" xref="S4.SS3.p1.2.m2.1.1.2.cmml">T</mi><mtext class="ltx_mathvariant_italic" id="S4.SS3.p1.2.m2.1.1.3" xref="S4.SS3.p1.2.m2.1.1.3a.cmml">epoch</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.2.m2.1b"><apply id="S4.SS3.p1.2.m2.1.1.cmml" xref="S4.SS3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.2.m2.1.1.1.cmml" xref="S4.SS3.p1.2.m2.1.1">subscript</csymbol><ci id="S4.SS3.p1.2.m2.1.1.2.cmml" xref="S4.SS3.p1.2.m2.1.1.2">𝑇</ci><ci id="S4.SS3.p1.2.m2.1.1.3a.cmml" xref="S4.SS3.p1.2.m2.1.1.3"><mtext class="ltx_mathvariant_italic" id="S4.SS3.p1.2.m2.1.1.3.cmml" mathsize="70%" xref="S4.SS3.p1.2.m2.1.1.3">epoch</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.2.m2.1c">T_{\textit{epoch}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.2.m2.1d">italic_T start_POSTSUBSCRIPT epoch end_POSTSUBSCRIPT</annotation></semantics></math>), and the scaling factor <math alttext="\alpha" class="ltx_Math" display="inline" id="S4.SS3.p1.3.m3.1"><semantics id="S4.SS3.p1.3.m3.1a"><mi id="S4.SS3.p1.3.m3.1.1" xref="S4.SS3.p1.3.m3.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.3.m3.1b"><ci id="S4.SS3.p1.3.m3.1.1.cmml" xref="S4.SS3.p1.3.m3.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.3.m3.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.3.m3.1d">italic_α</annotation></semantics></math>.
The scaling factor is the ratio of the per epoch times of the baselines to <span class="ltx_text ltx_font_smallcaps" id="S4.SS3.p1.3.2">Dolphin</span>.
We observe that in almost all cases, <span class="ltx_text ltx_font_smallcaps" id="S4.SS3.p1.3.3">Dolphin</span> shows significant improvements in training times, training up to about 300x faster than Scallop, 44x faster than ISED, and 180x faster than IndeCateR+.
On average, <span class="ltx_text ltx_font_smallcaps" id="S4.SS3.p1.3.4">Dolphin</span> reports a speedup of 36x times over all baselines.
Further, <span class="ltx_text ltx_font_smallcaps" id="S4.SS3.p1.3.5">Dolphin</span> converges on all benchmarks, while the baselines time out on most of the Medium and Large versions of the benchmarks.
These results thus demonstrate that, unlike existing tools, <span class="ltx_text ltx_font_smallcaps" id="S4.SS3.p1.3.6">Dolphin</span> can scale to complex problems and large datasets.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS3.p2">
<p class="ltx_p" id="S4.SS3.p2.1"><span class="ltx_text ltx_font_smallcaps" id="S4.SS3.p2.1.1">Dolphin</span> trains slightly slower than Scallop on both versions of the Mugen benchmark.
This is because the <span class="ltx_text ltx_font_smallcaps" id="S4.SS3.p2.1.2">Dolphin</span> program written for Mugen uses Python objects and operations that are not fully batchable across samples.
In contrast, the Scallop program, which is written in a compiled and optimized language, runs around 1.3x faster than <span class="ltx_text ltx_font_smallcaps" id="S4.SS3.p2.1.3">Dolphin</span> on average per iteration.
However, <span class="ltx_text ltx_font_smallcaps" id="S4.SS3.p2.1.4">Dolphin</span> requires only 20 epochs to converge whereas Scallop requires almost 1000 epochs <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03348v1#bib.bib9" title="">2023</a>)</cite>.
As a result, <span class="ltx_text ltx_font_smallcaps" id="S4.SS3.p2.1.5">Dolphin</span>’s total training time is still significantly lower than Scallop’s (3̃.7x for Mugen(S)). We show the accuracy curves for Mugen in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.03348v1#A2" title="Appendix B Accuracy Curves for Mugen ‣ 6 Conclusion and Limitations ‣ 5 Related Work ‣ 4.5 RQ3: Provenance Comparisons ‣ 4 Experiments ‣ 3.4 Building the Dolphin Program ‣ 3 The Dolphin Framework ‣ 2 Overview ‣ Dolphin: A Programmable Framework for Scalable Neurosymbolic Learning"><span class="ltx_text ltx_ref_tag">B</span></a>.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.4 </span>RQ2: Accuracy</h3>
<div class="ltx_para ltx_noindent" id="S4.SS4.p1">
<p class="ltx_p" id="S4.SS4.p1.1">Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03348v1#S4.F4" title="Figure 4 ‣ 4.4 RQ2: Accuracy ‣ 4 Experiments ‣ 3.4 Building the Dolphin Program ‣ 3 The Dolphin Framework ‣ 2 Overview ‣ Dolphin: A Programmable Framework for Scalable Neurosymbolic Learning"><span class="ltx_text ltx_ref_tag">4</span></a> presents the accuracy of <span class="ltx_text ltx_font_smallcaps" id="S4.SS4.p1.1.1">Dolphin</span> and the baselines on the different benchmarks.
<span class="ltx_text ltx_font_smallcaps" id="S4.SS4.p1.1.2">Dolphin</span> accuracies are marked in blue.
In all cases, for <span class="ltx_text ltx_font_smallcaps" id="S4.SS4.p1.1.3">Dolphin</span>, we report the accuracies of the best-performing provenance.
We use the DAMP provenance for MNIST, CLUTRR, and Mugen benchmarks, and the DTKP-AM provenance for the HWF and PathFinder benchmarks.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS4.p2">
<p class="ltx_p" id="S4.SS4.p2.1">We observe that in all cases, <span class="ltx_text ltx_font_smallcaps" id="S4.SS4.p2.1.1">Dolphin</span> achieves state-of-the-art accuracy, except in CLUTRR, where
<span class="ltx_text ltx_font_smallcaps" id="S4.SS4.p2.1.2">Dolphin</span>’s accuracy is slightly lower than that of Scallop.
For most Medium and Large versions of the benchmarks, <span class="ltx_text ltx_font_smallcaps" id="S4.SS4.p2.1.3">Dolphin</span> achieves better accuracy, whereas the baselines either report lower accuracy due to the complexity of the benchmark (e.g., HWF) or fail to converge within the time limit (e.g., Scallop on PathFinder-Large).
Most importantly, these results show that <span class="ltx_text ltx_font_smallcaps" id="S4.SS4.p2.1.4">Dolphin</span>’s scalability improvements do not come at the cost of accuracy.</p>
</div>
<figure class="ltx_figure" id="S4.F4"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="141" id="S4.F4.g1" src="x3.png" width="549"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>Accuracy of <span class="ltx_text ltx_font_smallcaps" id="S4.F4.2.1">Dolphin</span> and baselines across all benchmarks.</figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S4.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.5 </span>RQ3: Provenance Comparisons</h3>
<figure class="ltx_figure" id="S4.F5">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel" id="S4.F5.1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="129" id="S4.F5.1.g1" src="x4.png" width="462"/>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel" id="S4.F5.2"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="129" id="S4.F5.2.g1" src="x5.png" width="392"/>
</figure>
</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>Accuracy and average training time per epoch for DAMP and DTKP-AM.</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="S4.SS5.p1">
<p class="ltx_p" id="S4.SS5.p1.1">We perform ablation studies to compare the effectiveness of the DAMP and DTKP-AM provenances for each benchmark.
Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03348v1#S4.F5" title="Figure 5 ‣ 4.5 RQ3: Provenance Comparisons ‣ 4 Experiments ‣ 3.4 Building the Dolphin Program ‣ 3 The Dolphin Framework ‣ 2 Overview ‣ Dolphin: A Programmable Framework for Scalable Neurosymbolic Learning"><span class="ltx_text ltx_ref_tag">5</span></a> presents the accuracy of <span class="ltx_text ltx_font_smallcaps" id="S4.SS5.p1.1.1">Dolphin</span> using DAMP and DTKP-AM in the top graph, and the average training time per epoch in the bottom.
We observe that the relative effectiveness of the provenances differ across benchmarks.
For instance, in the MNIST-SumN benchmark, the DAMP provenance is more effective than the DTKP-AM provenance,
since the top-k proofs are not able to capture all the possible ways in which the sum of the digits can be computed.
In contrast, for HWF, the DTKP-AM provenance is more effective than DAMP since the tags in DAMP provenance lack the structure needed to capture the semantics of the symbolic program.
Otherwise, DTKP-AM mostly has a slight edge over DAMP.
On the other hand, DAMP is faster than DTKP-AM for all benchmarks, since it does not track individual proofs.
We thus see that selecting provenances is a trade-off between accuracy and training time.</p>
</div>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Related Work</h2>
<div class="ltx_para ltx_noindent" id="S5.p1">
<p class="ltx_p" id="S5.p1.1"><span class="ltx_text ltx_font_bold" id="S5.p1.1.1">Neurosymbolic programming frameworks.</span> Frameworks like Scallop <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03348v1#bib.bib9" title="">2023</a>)</cite>, DeepProbLog <cite class="ltx_cite ltx_citemacro_citep">(Manhaeve et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03348v1#bib.bib11" title="">2018</a>)</cite>, and ISED <cite class="ltx_cite ltx_citemacro_citep">(Solko-Breslin et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03348v1#bib.bib18" title="">2024</a>)</cite> provide a simple interface for neurosymbolic programming.
There are also domain-specific tools like NeurASP <cite class="ltx_cite ltx_citemacro_cite">Yang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03348v1#bib.bib20" title="">2023</a>)</cite> for answer set programming and NeuralLog <cite class="ltx_cite ltx_citemacro_cite">Chen et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03348v1#bib.bib2" title="">2021</a>)</cite> for phrase alignment in NLP.
While these frameworks provide intuitive abstractions, they are bottle-necked due to expensive data transfers between symbolic computations done on CPU versus neural computations that execute on GPU, making neurosymbolic learning hard to scale.
In contrast, <span class="ltx_text ltx_font_smallcaps" id="S5.p1.1.2">Dolphin</span> provides a deeper integration of the two worlds by building a Python-based API on top of PyTorch, which scales better.</p>
</div>
<div class="ltx_para ltx_noindent" id="S5.p2">
<p class="ltx_p" id="S5.p2.1"><span class="ltx_text ltx_font_bold" id="S5.p2.1.1">Scalability improving techniques.</span> Several optimization techniques have been proposed to improve the scalability of differentiable reasoning algorithms. For instance, Greedy NTP <cite class="ltx_cite ltx_citemacro_citep">(Minervini et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03348v1#bib.bib13" title="">2020a</a>)</cite> reduces the computation cost of Neural Theorem Prover (NTP) <cite class="ltx_cite ltx_citemacro_citep">(Rocktäschel &amp; Riedel, <a class="ltx_ref" href="https://arxiv.org/html/2410.03348v1#bib.bib15" title="">2017</a>)</cite> by tracking only a subset of proof states using nearest neighbor search. Likewise, the conditional theorem prover <cite class="ltx_cite ltx_citemacro_citep">(Minervini et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03348v1#bib.bib14" title="">2020b</a>)</cite> employs a machine learning-based proof selection technique. However, unlike <span class="ltx_text ltx_font_smallcaps" id="S5.p2.1.2">Dolphin</span>, these methods are point solutions that do not fundamentally address the scalability challenge for neurosymbolic learning.</p>
</div>
<div class="ltx_para ltx_noindent" id="S5.p3">
<p class="ltx_p" id="S5.p3.1"><span class="ltx_text ltx_font_bold" id="S5.p3.1.1">Specialized neurosymbolic solutions.</span>
There are many specialized solutions for various neurosymbolic tasks. For instance, NGS <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03348v1#bib.bib8" title="">2020</a>)</cite> uses a hand-coded syntax to specify the structure of mathematical expressions for HWF. More general solutions, such as NS-CL <cite class="ltx_cite ltx_citemacro_citep">(Mao et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03348v1#bib.bib12" title="">2019</a>)</cite> includes a framework for visual question answering that learns symbolic representations for text and images. NeRd <cite class="ltx_cite ltx_citemacro_citep">(Chen et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03348v1#bib.bib2" title="">2021</a>)</cite> transforms questions in natural language into executable programs based on symbolic information extracted from text. In this work, we rather focus on building a general programming framework that improves the scalability of diverse neurosymbolic programs.</p>
</div>
<section class="ltx_section" id="S6">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Conclusion and Limitations</h2>
<div class="ltx_para ltx_noindent" id="S6.p1">
<p class="ltx_p" id="S6.p1.1">We proposed <span class="ltx_text ltx_font_smallcaps" id="S6.p1.1.1">Dolphin</span>, a programmable framework for scaling neurosymbolic learning.
<span class="ltx_text ltx_font_smallcaps" id="S6.p1.1.2">Dolphin</span> provides abstractions for writing symbolic programs along with pluggable vectorized provenances to compute symbolic gradients.
This allows users to write differentiable symbolic programs in Python within PyTorch pipelines that can scale
to complex programs and large datasets.
We show that <span class="ltx_text ltx_font_smallcaps" id="S6.p1.1.3">Dolphin</span> scales significantly better than existing neurosymbolic frameworks while achieving state-of-the-art performance on a variety of tasks.</p>
</div>
<div class="ltx_para ltx_noindent" id="S6.p2">
<p class="ltx_p" id="S6.p2.1">A limitation of <span class="ltx_text ltx_font_smallcaps" id="S6.p2.1.1">Dolphin</span> is that it requires the user to express symbolic programs
in a batched manner. While this is a common pattern within deep learning, it may be restrictive to users new to batched programming.
Another limitation is that while <span class="ltx_text ltx_font_smallcaps" id="S6.p2.1.2">Dolphin</span> works well with most models, the representation of Distributions needed
by generative models (e.g., Causal LLMs like Llama) has not yet been investigated. We leave this to future work.</p>
</div>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chaudhuri et al. (2021)</span>
<span class="ltx_bibblock">
Swarat Chaudhuri, Kevin Ellis, Oleksandr Polozov, Rishabh Singh, Armando
Solar-Lezama, Yisong Yue, et al.

</span>
<span class="ltx_bibblock">Neurosymbolic programming.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib1.1.1">Foundations and Trends® in Programming
Languages</em>, 7(3):158–243, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al. (2021)</span>
<span class="ltx_bibblock">
Zeming Chen, Qiyue Gao, and Lawrence S Moss.

</span>
<span class="ltx_bibblock">Neurallog: Natural language inference with joint neural and logical
reasoning.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib2.1.1">arXiv preprint arXiv:2105.14167</em>, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">De Smet et al. (2024)</span>
<span class="ltx_bibblock">
Lennert De Smet, Emanuele Sansone, and Pedro Zuidberg Dos Martires.

</span>
<span class="ltx_bibblock">Differentiable sampling of categorical distributions using the
catlog-derivative trick.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib3.1.1">Advances in Neural Information Processing Systems</em>, 36, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Green et al. (2007)</span>
<span class="ltx_bibblock">
Todd J Green, Grigoris Karvounarakis, and Val Tannen.

</span>
<span class="ltx_bibblock">Provenance semirings.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib4.1.1">Proceedings of the twenty-sixth ACM SIGMOD-SIGACT-SIGART
symposium on Principles of database systems</em>, pp.  31–40, 2007.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hayes et al. (2022)</span>
<span class="ltx_bibblock">
Thomas Hayes, Songyang Zhang, Xi Yin, Guan Pang, Sasha Sheng, Harry Yang,
Songwei Ge, Qiyuan Hu, and Devi Parikh.

</span>
<span class="ltx_bibblock">Mugen: A playground for video-audio-text multimodal understanding and
generation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib5.1.1">European Conference on Computer Vision</em>, pp.  431–449.
Springer, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Huang et al. (2021)</span>
<span class="ltx_bibblock">
Jiani Huang, Ziyang Li, Binghong Chen, Karan Samel, Mayur Naik, Le Song, and
Xujie Si.

</span>
<span class="ltx_bibblock">Scallop: From probabilistic deductive databases to scalable
differentiable reasoning.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib6.1.1">Advances in Neural Information Processing Systems</em>,
34:25134–25145, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kambhampati et al. (2024)</span>
<span class="ltx_bibblock">
Subbarao Kambhampati, Karthik Valmeekam, Lin Guan, Kaya Stechly, Mudit Verma,
Siddhant Bhambri, Lucas Saldyt, and Anil Murthy.

</span>
<span class="ltx_bibblock">Llms can’t plan, but can help planning in llm-modulo frameworks.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib7.1.1">arXiv preprint arXiv:2402.01817</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2020)</span>
<span class="ltx_bibblock">
Qing Li, Siyuan Huang, Yining Hong, Yixin Chen, Ying Nian Wu, and Song-Chun
Zhu.

</span>
<span class="ltx_bibblock">Closed loop neural-symbolic learning via integrating neural
perception, grammar parsing, and symbolic reasoning.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib8.1.1">International Conference on Machine Learning</em>, pp. 5884–5894. PMLR, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2023)</span>
<span class="ltx_bibblock">
Ziyang Li, Jiani Huang, and Mayur Naik.

</span>
<span class="ltx_bibblock">Scallop: A language for neurosymbolic programming.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib9.1.1">Proceedings of the ACM on Programming Languages</em>, 7(PLDI):1463–1487, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu (2019)</span>
<span class="ltx_bibblock">
Yinhan Liu.

</span>
<span class="ltx_bibblock">Roberta: A robustly optimized bert pretraining approach.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib10.1.1">arXiv preprint arXiv:1907.11692</em>, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Manhaeve et al. (2018)</span>
<span class="ltx_bibblock">
Robin Manhaeve, Sebastijan Dumancic, Angelika Kimmig, Thomas Demeester, and Luc
De Raedt.

</span>
<span class="ltx_bibblock">Deepproblog: Neural probabilistic logic programming.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib11.1.1">Advances in neural information processing systems</em>, 31, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mao et al. (2019)</span>
<span class="ltx_bibblock">
Jiayuan Mao, Chuang Gan, Pushmeet Kohli, Joshua B Tenenbaum, and Jiajun Wu.

</span>
<span class="ltx_bibblock">The neuro-symbolic concept learner: Interpreting scenes, words, and
sentences from natural supervision.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib12.1.1">arXiv preprint arXiv:1904.12584</em>, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Minervini et al. (2020a)</span>
<span class="ltx_bibblock">
Pasquale Minervini, Matko Bošnjak, Tim Rocktäschel, Sebastian Riedel,
and Edward Grefenstette.

</span>
<span class="ltx_bibblock">Differentiable reasoning on large knowledge bases and natural
language.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib13.1.1">Proceedings of the AAAI conference on artificial
intelligence</em>, volume 34, pp.  5182–5190, 2020a.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Minervini et al. (2020b)</span>
<span class="ltx_bibblock">
Pasquale Minervini, Sebastian Riedel, Pontus Stenetorp, Edward Grefenstette,
and Tim Rocktäschel.

</span>
<span class="ltx_bibblock">Learning reasoning strategies in end-to-end differentiable proving.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib14.1.1">International Conference on Machine Learning</em>, pp. 6938–6949. PMLR, 2020b.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rocktäschel &amp; Riedel (2017)</span>
<span class="ltx_bibblock">
Tim Rocktäschel and Sebastian Riedel.

</span>
<span class="ltx_bibblock">End-to-end differentiable proving.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib15.1.1">Advances in neural information processing systems</em>, 30, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sanh (2019)</span>
<span class="ltx_bibblock">
V Sanh.

</span>
<span class="ltx_bibblock">Distilbert, a distilled version of bert: Smaller, faster, cheaper and
lighter.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib16.1.1">arXiv preprint arXiv:1910.01108</em>, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sinha et al. (2019)</span>
<span class="ltx_bibblock">
Koustuv Sinha, Shagun Sodhani, Jin Dong, Joelle Pineau, and William L Hamilton.

</span>
<span class="ltx_bibblock">Clutrr: A diagnostic benchmark for inductive reasoning from text.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib17.1.1">arXiv preprint arXiv:1908.06177</em>, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Solko-Breslin et al. (2024)</span>
<span class="ltx_bibblock">
Alaia Solko-Breslin, Seewon Choi, Ziyang Li, Neelay Velingker, Rajeev Alur,
Mayur Naik, and Eric Wong.

</span>
<span class="ltx_bibblock">Data-efficient learning with neural programs.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib18.1.1">arXiv preprint arXiv:2406.06246</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tay et al. (2020)</span>
<span class="ltx_bibblock">
Yi Tay, Mostafa Dehghani, Samira Abnar, Yikang Shen, Dara Bahri, Philip Pham,
Jinfeng Rao, Liu Yang, Sebastian Ruder, and Donald Metzler.

</span>
<span class="ltx_bibblock">Long range arena: A benchmark for efficient transformers.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib19.1.1">arXiv preprint arXiv:2011.04006</em>, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yang et al. (2023)</span>
<span class="ltx_bibblock">
Zhun Yang, Adam Ishay, and Joohyung Lee.

</span>
<span class="ltx_bibblock">Neurasp: Embracing neural networks into answer set programming.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib20.1.1">arXiv preprint arXiv:2307.07700</em>, 2023.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<section class="ltx_appendix" id="A1">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span><span class="ltx_text ltx_font_smallcaps" id="A1.1.1">Dolphin</span> Experiment Details for Benchmarks</h2>
<div class="ltx_para ltx_noindent" id="A1.p1">
<p class="ltx_p" id="A1.p1.1">The following are more details on the experiment setup.
For each experimental trial, we report the highest evaluation accuracy over all epochs.
Unless otherwise noted, each trial was run on a machine with Intel Xeon Gold 6248 (2.50 GHz) CPUs and NVIDIA GeForce RTX 2080 Ti (11 GB) GPUs.</p>
</div>
<section class="ltx_subsection" id="A1.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.1 </span>MNIST Sum-N</h3>
<div class="ltx_para ltx_noindent" id="A1.SS1.p1">
<p class="ltx_p" id="A1.SS1.p1.1">Each of the MNIST Sum-N tasks had a batch train size of 64 samples, a learning rate of 0.001, and a top-k value of 1. Each of the tasks were trained on a dataset size of the original MNIST dataset divided by N of Sum-N. Sum5’s dataset consisted of 12000 train samples and 2000 test samples. Sum10’s dataset consisted of 6000 train samples and 1000 test samples. Sum15’s dataset consisted of 4000 train samples and 666 test samples.</p>
</div>
</section>
<section class="ltx_subsection" id="A1.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.2 </span>Hand-Written Formula</h3>
<div class="ltx_para ltx_noindent" id="A1.SS2.p1">
<p class="ltx_p" id="A1.SS2.p1.1">For Hand-Written Formula we trained each task with a batch train size of 64 samples. The learning rate was 0.0001, sample-k was 7, and top-k value was 3. Length 7’s dataset consisted of 9600 samples for training, 2400 samples for testing. Length 15 consisted of 24000 training samples and 6000 testing samples. Length 19 consisted of 32000 training samples and 8000 testing samples.</p>
</div>
</section>
<section class="ltx_subsection" id="A1.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.3 </span>PathFinder</h3>
<div class="ltx_para ltx_noindent" id="A1.SS3.p1">
<p class="ltx_p" id="A1.SS3.p1.1">For each of the PathFinder tasks, we used a batch train size of 64 samples, a learning rate of 0.0001, and a top-k value of 3. Each task’s dataset consisted of 539459 images for training and 59940 images for testing. Each task had its own dataset of images with dimensions of the task’s pixel size.</p>
</div>
</section>
<section class="ltx_subsection" id="A1.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.4 </span>CLUTRR</h3>
<div class="ltx_para ltx_noindent" id="A1.SS4.p1">
<p class="ltx_p" id="A1.SS4.p1.1">For each CLUTRR task, we used a single A100 GPU (40 GB), with a learning rate of 0.00001 and use a batch size of 16.
The length of the training dataset for CLUTRR (Small) was 11,093 and that of the test set was 1146.
The training set for CLUTRR (Medium) contained 15,083 samples and the test set contained 1048 samples.</p>
</div>
</section>
<section class="ltx_subsection" id="A1.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.5 </span>Mugen</h3>
<div class="ltx_para ltx_noindent" id="A1.SS5.p1">
<p class="ltx_p" id="A1.SS5.p1.1">For each Mugen task, we use a batch size of 3 and a learning rate of 0.0001. From the full Mugen dataset, we sample a training set of 5000 examples for Mugen (Medium), and from that set, we sample a training set of 1000 for Mugen (Small). Both Small and Medium are evaluated on a fixed holdout set of 1000 samples.
We train and evaluate for up to 100 epochs.</p>
</div>
</section>
</section>
<section class="ltx_appendix" id="A2">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>Accuracy Curves for Mugen</h2>
<figure class="ltx_figure" id="A2.F6">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A2.F6.1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="288" id="A2.F6.1.g1" src="extracted/5901627/figures/mugen_tvr_1k.png" width="548"/>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A2.F6.2"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="288" id="A2.F6.2.g1" src="extracted/5901627/figures/mugen_vtr_1k.png" width="548"/>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6: </span>Test accuracies for each epoch of <span class="ltx_text ltx_font_smallcaps" id="A2.F6.4.1">Dolphin</span> and Scallop for Mugen (Small). The accuracies for TVR are on the left and VTR are on the right.</figcaption>
</figure>
<figure class="ltx_figure" id="A2.F7">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A2.F7.1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="288" id="A2.F7.1.g1" src="extracted/5901627/figures/mugen_tvr_5k.png" width="548"/>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A2.F7.2"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="288" id="A2.F7.2.g1" src="extracted/5901627/figures/mugen_vtr_5k.png" width="548"/>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 7: </span>Test accuracies for each epoch of <span class="ltx_text ltx_font_smallcaps" id="A2.F7.4.1">Dolphin</span> and Scallop for Mugen (Medium). The accuracies for TVR are on the left and VTR are on the right.</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="A2.p1">
<p class="ltx_p" id="A2.p1.1">Figures <a class="ltx_ref" href="https://arxiv.org/html/2410.03348v1#A2.F6" title="Figure 6 ‣ Appendix B Accuracy Curves for Mugen ‣ 6 Conclusion and Limitations ‣ 5 Related Work ‣ 4.5 RQ3: Provenance Comparisons ‣ 4 Experiments ‣ 3.4 Building the Dolphin Program ‣ 3 The Dolphin Framework ‣ 2 Overview ‣ Dolphin: A Programmable Framework for Scalable Neurosymbolic Learning"><span class="ltx_text ltx_ref_tag">6</span></a> and <a class="ltx_ref" href="https://arxiv.org/html/2410.03348v1#A2.F7" title="Figure 7 ‣ Appendix B Accuracy Curves for Mugen ‣ 6 Conclusion and Limitations ‣ 5 Related Work ‣ 4.5 RQ3: Provenance Comparisons ‣ 4 Experiments ‣ 3.4 Building the Dolphin Program ‣ 3 The Dolphin Framework ‣ 2 Overview ‣ Dolphin: A Programmable Framework for Scalable Neurosymbolic Learning"><span class="ltx_text ltx_ref_tag">7</span></a> show the test accuracies for each epoch of <span class="ltx_text ltx_font_smallcaps" id="A2.p1.1.1">Dolphin</span> and Scallop for Mugen (Small) and Mugen (Medium) respectively.
The accuracies for TVR are on the left and VTR are on the right.
Note that <span class="ltx_text ltx_font_smallcaps" id="A2.p1.1.2">Dolphin</span> converges within 20 epochs in all cases, while Scallop does not converge within 100 epochs.</p>
</div>
</section>
</section>
</section>
</section>
</section>
</section>
</section>
</div>
</div>
</figure>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Fri Oct  4 12:12:25 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
