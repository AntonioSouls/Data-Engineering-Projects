<!DOCTYPE html><html lang="en" data-theme="light"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<title>No Need to Talk: Asynchronous Mixture of Language Models</title>
<!--Generated on Fri Oct  4 15:50:09 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css">
<link href="https://arxiv.org/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css">
<link href="https://arxiv.org/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css">
<link href="https://arxiv.org/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css">




<base href="https://arxiv.org/html/2410.03529v1/"><link rel="stylesheet" href="https://use.typekit.net/rwr5zpx.css"><link rel="icon" type="image/png" href="https://static.arxiv.org/static/browse/0.3.4/images/icons/favicon-16x16.png" sizes="16x16"><link rel="icon" type="image/png" href="https://static.arxiv.org/static/browse/0.3.4/images/icons/favicon-32x32.png" sizes="32x32"></head>
<body><header class="mob_header">
    <div class="html-header-logo">
      <a href="https://arxiv.org/">
        <img alt="logo" class="logomark" role="presentation" width="100" src="https://services.dev.arxiv.org/html/static/arxiv-logomark-small-white.svg">
        <span class="sr-only">Back to arXiv</span>
      </a>
    </div>

    <!--TOC, dark mode, links-->
    <div class="html-header-nav">
      <!--back to abstract-->
      
        <a class="nav-link ar5iv-footer-button hover-effect" aria-label="Back to abstract page" href="https://arxiv.org/abs/2410.03529v1">
        <svg xmlns="http://www.w3.org/2000/svg" height="1.25em" viewBox="0 0 512 512" fill="#ffffff" aria-hidden="true">
            <path d="M502.6 278.6c12.5-12.5 12.5-32.8 0-45.3l-128-128c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L402.7 224 192 224c-17.7 0-32 14.3-32 32s14.3 32 32 32l210.7 0-73.4 73.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l128-128zM160 96c17.7 0 32-14.3 32-32s-14.3-32-32-32L96 32C43 32 0 75 0 128L0 384c0 53 43 96 96 96l64 0c17.7 0 32-14.3 32-32s-14.3-32-32-32l-64 0c-17.7 0-32-14.3-32-32l0-256c0-17.7 14.3-32 32-32l64 0z"></path>
        </svg>
        </a>
      <!--dark mode-->
      <a class="ar5iv-toggle-color-scheme" title="Toggle dark/light mode" aria-label="System preference">
        <label id="automatic-tog" class="toggle-icon" title="Switch to light mode" for="__palette_3">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9h-1.9M20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69m-9.15 3.96h2.3L12 9l-1.15 3.65Z"></path></svg>
        </label>
        
        
      </a>
      <!--nav-->
      <button class="navbar-toggler ar5iv-footer-button" type="button" data-bs-theme="dark" data-bs-toggle="collapse" aria-expanded="false" data-bs-target=".ltx_page_main >.ltx_TOC.mobile" aria-controls="navbarSupportedContent" aria-label="Toggle navigation" style="border:none; margin-right: 0em;">
        <svg xmlns="http://www.w3.org/2000/svg" height="1.25em" viewBox="0 0 448 512" aria-hidden="true" role="img" fill="#ffffff"><path d="M0 96C0 78.3 14.3 64 32 64H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32C14.3 128 0 113.7 0 96zM0 256c0-17.7 14.3-32 32-32H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32c-17.7 0-32-14.3-32-32zM448 416c0 17.7-14.3 32-32 32H32c-17.7 0-32-14.3-32-32s14.3-32 32-32H416c17.7 0 32 14.3 32 32z"></path></svg>
      </button>
    </div>
    </header><header class="desktop_header">
    <div class="html-header-logo">
      <a href="https://arxiv.org/">
          <img alt="logo" class="logo" role="presentation" width="100" src="https://services.dev.arxiv.org/html/static/arxiv-logo-one-color-white.svg">
          <span class="sr-only">Back to arXiv</span>
      </a>
    </div>
    <div class="html-header-message" role="banner">
        <p>This is <strong>experimental HTML</strong> to improve accessibility. We invite you to report rendering errors. <span class="sr-only">Use Alt+Y to toggle on accessible reporting links and Alt+Shift+Y to toggle off.</span> Learn more <a href="https://info.arxiv.org/about/accessible_HTML.html" target="_blank">about this project</a> and <a href="https://info.arxiv.org/help/submit_latex_best_practices.html" target="_blank">help improve conversions</a>.
        </p>
    </div>
    <nav class="html-header-nav">
      <a class="ar5iv-footer-button hover-effect" href="https://info.arxiv.org/about/accessible_HTML.html" target="_blank">Why HTML?</a>
      <a class="ar5iv-footer-button hover-effect" target="_blank" href="https://arxiv.org/html/2410.03529v1/#myForm">Report Issue</a>
      <a class="ar5iv-footer-button hover-effect" href="https://arxiv.org/abs/2410.03529v1">Back to Abstract</a>
      <a class="ar5iv-footer-button hover-effect" href="https://arxiv.org/pdf/2410.03529v1" target="_blank">Download PDF</a>
      <a class="ar5iv-toggle-color-scheme" title="Toggle dark/light mode">
        <label id="automatic-tog" class="toggle-icon" title="Switch to light mode" for="__palette_3">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9h-1.9M20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69m-9.15 3.96h2.3L12 9l-1.15 3.65Z"></path></svg>
        </label>
        
        
      </a>
    </nav></header>

<div class="ltx_page_main" id="main">
<nav class="ltx_TOC active" aria-labelledby="toc_header"><h2 id="toc_header" class="sr-only">Table of Contents</h2>

      <div id="listIcon" type="button" class="hide">
          <svg width="17px" height="17px" viewBox="0 0 512 512" style="pointer-events: none;">
          <path d="M40 48C26.7 48 16 58.7 16 72v48c0 13.3 10.7 24 24 24H88c13.3 0 24-10.7 24-24V72c0-13.3-10.7-24-24-24H40zM192 64c-17.7 0-32 14.3-32 32s14.3 32 32 32H480c17.7 0 32-14.3 32-32s-14.3-32-32-32H192zm0 160c-17.7 0-32 14.3-32 32s14.3 32 32 32H480c17.7 0 32-14.3 32-32s-14.3-32-32-32H192zm0 160c-17.7 0-32 14.3-32 32s14.3 32 32 32H480c17.7 0 32-14.3 32-32s-14.3-32-32-32H192zM16 232v48c0 13.3 10.7 24 24 24H88c13.3 0 24-10.7 24-24V232c0-13.3-10.7-24-24-24H40c-13.3 0-24 10.7-24 24zM40 368c-13.3 0-24 10.7-24 24v48c0 13.3 10.7 24 24 24H88c13.3 0 24-10.7 24-24V392c0-13.3-10.7-24-24-24H40z"></path>
          </svg>
      </div>
      <div id="arrowIcon" type="button">
          <svg width="17px" height="17px" viewBox="0 0 448 512" style="pointer-events: none;">
          <path d="M9.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.2 288 416 288c17.7 0 32-14.3 32-32s-14.3-32-32-32l-306.7 0L214.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160z"></path>
          </svg>
      </div><ol class="ltx_toclist"><li class="ltx_tocentry ltx_tocentry_section">
    <a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#abstract" title="Abstract">
      <span class="ltx_text ltx_ref_title">
        <span class="ltx_tag ltx_tag_ref"></span>
        Abstract
      </span>
    </a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#S1" title="In No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#S2" title="In No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Method</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#S2.SS1" title="In 2 Method ‣ No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.1 </span>Background</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#S2.SS1.SSS0.Px1" title="In 2.1 Background ‣ 2 Method ‣ No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_title">Language modeling</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#S2.SS1.SSS0.Px2" title="In 2.1 Background ‣ 2 Method ‣ No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_title">Mixture of Experts</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#S2.SS2" title="In 2 Method ‣ No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2 </span><span class="ltx_text ltx_font_smallcaps">SmallTalk LM</span></span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#S2.SS2.SSS0.Px1" title="In 2.2 SmallTalk LM ‣ 2 Method ‣ No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_title">Routing With Independent Language Models</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#S2.SS2.SSS0.Px2" title="In 2.2 SmallTalk LM ‣ 2 Method ‣ No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_title">Deriving a Practical Model</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#S2.SS2.SSS0.Px3" title="In 2.2 SmallTalk LM ‣ 2 Method ‣ No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_title">Training Procedure</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#S2.SS2.SSS0.Px4" title="In 2.2 SmallTalk LM ‣ 2 Method ‣ No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_title">Balancing the Assignments to Experts</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#S2.SS2.SSS0.Px5" title="In 2.2 SmallTalk LM ‣ 2 Method ‣ No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_title">Computational and Communication Cost</span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#S3" title="In No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Experiments</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#S3.SS1" title="In 3 Experiments ‣ No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Experimental Setup</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#S3.SS1.SSS0.Px1" title="In 3.1 Experimental Setup ‣ 3 Experiments ‣ No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_title">Comparison to the Dense Model</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#S3.SS2" title="In 3 Experiments ‣ No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>Language Modeling Results</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#S3.SS2.SSS0.Px1" title="In 3.2 Language Modeling Results ‣ 3 Experiments ‣ No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_title">Communication Overhead</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#S3.SS3" title="In 3 Experiments ‣ No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3 </span>Downstream evaluation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#S3.SS4" title="In 3 Experiments ‣ No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.4 </span>Routing analysis</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#S3.SS4.SSS0.Px1" title="In 3.4 Routing analysis ‣ 3 Experiments ‣ No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_title">Impact of Router Size</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#S3.SS4.SSS0.Px2" title="In 3.4 Routing analysis ‣ 3 Experiments ‣ No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_title">Impact of Prefix Length</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#S3.SS4.SSS0.Px3" title="In 3.4 Routing analysis ‣ 3 Experiments ‣ No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_title">Comparison With Routing Using TF-IDF</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#S3.SS4.SSS0.Px4" title="In 3.4 Routing analysis ‣ 3 Experiments ‣ No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_title">Experts Do Specialize</span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#S4" title="In No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Related Work</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#S4.SS0.SSS0.Px1" title="In 4 Related Work ‣ No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_title">Distributed optimization</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#S4.SS0.SSS0.Px2" title="In 4 Related Work ‣ No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_title">Mixture of Experts</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#S4.SS0.SSS0.Px3" title="In 4 Related Work ‣ No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_title">Independent Training of Mixture of Experts Models</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#S5" title="In No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Conclusion</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#A1" title="In No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A </span>Language modeling experiments</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#A1.SS1" title="In Appendix A Language modeling experiments ‣ No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.1 </span>Architecture and training details</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#A1.SS2" title="In Appendix A Language modeling experiments ‣ No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.2 </span>Notation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#A1.SS3" title="In Appendix A Language modeling experiments ‣ No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.3 </span>Computational Cost</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#A1.SS3.SSS1" title="In A.3 Computational Cost ‣ Appendix A Language modeling experiments ‣ No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.3.1 </span>Transformer</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#A1.SS3.SSS2" title="In A.3 Computational Cost ‣ Appendix A Language modeling experiments ‣ No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.3.2 </span>Mixture of LLMs</span></a>
<ol class="ltx_toclist ltx_toclist_subsubsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#A1.SS3.SSS2.Px1" title="In A.3.2 Mixture of LLMs ‣ A.3 Computational Cost ‣ Appendix A Language modeling experiments ‣ No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_title">Regarding Computational Overhead</span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#A1.SS4" title="In Appendix A Language modeling experiments ‣ No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.4 </span>Communication overhead</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#A1.SS4.SSS0.Px1" title="In A.4 Communication overhead ‣ Appendix A Language modeling experiments ‣ No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_title">Mixture of LLMs</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#A1.SS4.SSS0.Px2" title="In A.4 Communication overhead ‣ Appendix A Language modeling experiments ‣ No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_title">Comparison with Distributed Training</span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#A2" title="In No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B </span>Downstream evaluation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#A3" title="In No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">C </span>Additional Results</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#A3.SS0.SSS0.Px1" title="In Appendix C Additional Results ‣ No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_title">Effect of Prefix Length on Routing Performance</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
    <a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#bib" title="References">
      <span class="ltx_text ltx_ref_title">
        <span class="ltx_tag ltx_tag_ref"></span>
        References
      </span>
    </a></li></ol></nav>

<div class="ltx_page_content"><div class="package-alerts ltx_document" role="status" aria-label="Conversion errors have been found">
      <button aria-label="Dismiss alert">
          <span aria-hidden="true"><svg role="presentation" width="20" height="20" viewBox="0 0 44 44" aria-hidden="true" focusable="false">
          <path d="M0.549989 4.44999L4.44999 0.549988L43.45 39.55L39.55 43.45L0.549989 4.44999Z"></path>
          <path d="M39.55 0.549988L43.45 4.44999L4.44999 43.45L0.549988 39.55L39.55 0.549988Z"></path>
          </svg></span>
      </button>
      <p>HTML conversions <a href="https://info.dev.arxiv.org/about/accessibility_html_error_messages.html" target="_blank">sometimes display errors</a> due to content that did not convert correctly from the source. This paper uses the following packages that are not yet supported by the HTML conversion tool. Feedback on these issues are not necessary; they are known and are being worked on.</p>
          <ul arial-label="Unsupported packages used in this paper">
              <li>failed: changepage</li>
          </ul>
      <p>Authors: achieve the best HTML results from your LaTeX submissions by following these <a href="https://info.arxiv.org/help/submit_latex_best_practices.html" target="_blank">best practices</a>.</p>
    </div><div id="target-section" class="section"><a id="license-tr" href="https://info.arxiv.org/help/license/index.html#licenses-available">License: CC BY 4.0</a><div id="watermark-tr">arXiv:2410.03529v1 [cs.LG] 04 Oct 2024</div></div>
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">No Need to Talk: 
<br class="ltx_break">Asynchronous Mixture of Language Models</h1><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Anastasiia Filippova 
<br class="ltx_break">EPFL
<br class="ltx_break">&amp;Angelos Katharopoulos 
<br class="ltx_break">Apple 
<br class="ltx_break">&amp;David Grangier 
<br class="ltx_break">Apple 
<br class="ltx_break">&amp;Ronan Collobert 
<br class="ltx_break">Apple 
<br class="ltx_break">
</span><span class="ltx_author_notes">Work done while interning at Apple.</span></span>
</div><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_abstract" id="abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<p class="ltx_p" id="id1.1">We introduce <span class="ltx_text ltx_font_smallcaps" id="id1.1.1">SmallTalk LM</span>, an innovative method for training a mixture of language models in an almost asynchronous manner. Each model of the mixture specializes in distinct parts of the data distribution, without the need of high-bandwidth communication between the nodes training each model. At inference, a lightweight router directs a given sequence to a single expert, according to a short prefix. This inference scheme naturally uses a fraction of the parameters from the overall mixture model. Our experiments on language modeling demonstrate that <span class="ltx_text ltx_font_smallcaps" id="id1.1.2">SmallTalk LM</span> achieves significantly lower perplexity than dense model baselines for the same total training FLOPs and an almost identical inference cost. Finally, in our downstream evaluations we outperform the dense baseline on <math alttext="75\%" class="ltx_Math" display="inline" id="id1.1.m1.1"><semantics id="id1.1.m1.1a"><mrow id="id1.1.m1.1.1" xref="id1.1.m1.1.1.cmml"><mn id="id1.1.m1.1.1.2" xref="id1.1.m1.1.1.2.cmml">75</mn><mo id="id1.1.m1.1.1.1" xref="id1.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="id1.1.m1.1b"><apply id="id1.1.m1.1.1.cmml" xref="id1.1.m1.1.1"><csymbol cd="latexml" id="id1.1.m1.1.1.1.cmml" xref="id1.1.m1.1.1.1">percent</csymbol><cn id="id1.1.m1.1.1.2.cmml" type="integer" xref="id1.1.m1.1.1.2">75</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="id1.1.m1.1c">75\%</annotation><annotation encoding="application/x-llamapun" id="id1.1.m1.1d">75 %</annotation></semantics></math> of the tasks.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">Recent research has demonstrated that scaling large language models (LLMs) by increasing model capacity and expanding training data consistently leads to significant performance improvements on a wide range of downstream tasks <cite class="ltx_cite ltx_citemacro_citep">(Kaplan et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#bib.bib27" title="">2020</a>; Brown et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#bib.bib5" title="">2020</a>; Henighan et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#bib.bib21" title="">2020</a>; Hoffmann et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#bib.bib23" title="">2022</a>; Dubey et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#bib.bib15" title="">2024</a>)</cite>. Scaling introduces substantial operating and engineering costs for both inference and training. In general, training is achieved on a large number of nodes via synchronous gradient descent techniques, which relies on high-bandwidth communication to scale. Inference of large models may require multiple compute nodes to distribute the model, which relies on low-latency communication. In both cases, state-of-the-art interconnect hardware is critical, and careful engineering is required to scale, and maintain a large compute cluster. While mainstream machine learning frameworks have eased the engineering work on the scaling side, access to a large number of well interconnected nodes remains a privilege in the machine learning community.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">In this paper, we explore strategies to mitigate the communication cost of large language models, both at training and inference, while keeping the inference efficient. We show that efficient training and inference can be achieved without relying on fast interconnects, and without compromising model performance, both in terms of perplexity or downstream task accuracy.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">In recent studies aimed at mitigating reliance on high-bandwidth interconnects, researchers have developed algorithms that reduce the need for frequent or comprehensive gradient synchronizations. Such techniques include asynchronous training <cite class="ltx_cite ltx_citemacro_citep">(Douillard et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#bib.bib13" title="">2023</a>; Aji &amp; Heafield, <a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#bib.bib1" title="">2017</a>; Zhang et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#bib.bib57" title="">2015</a>; Liu et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#bib.bib35" title="">2024</a>)</cite> and gradient compression <cite class="ltx_cite ltx_citemacro_citep">(Lin et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#bib.bib33" title="">2017</a>; Dettmers, <a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#bib.bib11" title="">2016</a>)</cite> which effectively decrease communication overhead. By performing updates less frequently or by communicating less data, these methods sustain high training throughput while diminishing dependence on high-speed interconnects. However, these algorithms still require some level of gradient synchronization, and resulting models often under perform (in terms of perplexity) compared to training approaches synchronizing at every step&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Diskin et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#bib.bib12" title="">2021</a>)</cite>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">Regarding efficient inference, a number of sparse parameter activation techniques have recently become popular <cite class="ltx_cite ltx_citemacro_citep">(Shazeer et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#bib.bib46" title="">2017</a>; Fedus et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#bib.bib16" title="">2022</a>; Artetxe et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#bib.bib2" title="">2022</a>; Lewis et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#bib.bib30" title="">2021</a>; Du et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#bib.bib14" title="">2022</a>)</cite>, in particular the Switch Transformer mixture of experts (MoE). These approaches are effective at reducing significantly the number of active model parameters at inference time. Yet, they require routing decisions to be made for each token, demanding rapid interconnections and requiring all parameters to be accessible in RAM.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S1.p5">
<p class="ltx_p" id="S1.p5.1">To achieve both low-bandwidth training and efficient inference, several prior works have explored asynchronously training mixtures of models <cite class="ltx_cite ltx_citemacro_citep">(Gross et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#bib.bib18" title="">2017</a>; Li et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#bib.bib31" title="">2022</a>; Gururangan et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#bib.bib19" title="">2023</a>)</cite>. In these methods, the input space is clustered using unsupervised techniques like K-Means, with each model in the mixture trained on an assigned cluster. These approaches reduce communication overhead and have demonstrated improvements in model perplexity, while maintaining similar inference costs to baseline models <cite class="ltx_cite ltx_citemacro_citep">(Gross et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#bib.bib18" title="">2017</a>; Gururangan et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#bib.bib19" title="">2023</a>)</cite>.
However, in the context of language processing, their practical applicability on standard downstream tasks with relatively short input prefixes remains a subject of debate, as they rely on full corpus clustering or access to metadata <cite class="ltx_cite ltx_citemacro_citep">(Li et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#bib.bib31" title="">2022</a>; Gururangan et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#bib.bib19" title="">2023</a>)</cite>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S1.p6">
<p class="ltx_p" id="S1.p6.1">In this paper, we introduce <span class="ltx_text ltx_font_smallcaps" id="S1.p6.1.1">SmallTalk LM</span>, an asynchronous mixture of language models, which combines the advantage of asynchronous LM training methods (significantly reducing interconnect requirements), and sparse activation methods (it naturally uses only a subset of the overall architecture parameters during inference). <span class="ltx_text ltx_font_smallcaps" id="S1.p6.1.2">SmallTalk LM</span> achieves better perplexity, and better accuracy on a majority of downstream tasks, compared to a regular dense language model trained with the same amount of FLOPs. Our main contributions are as follows:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S1.p7">
<ul class="ltx_itemize" id="S1.I1">
<li class="ltx_item" id="S1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para ltx_noindent" id="S1.I1.i1.p1">
<p class="ltx_p" id="S1.I1.i1.p1.1">We introduce an algorithm that trains a mixture of independent language models, significantly reducing bandwidth requirements during training compared to regular distributed training methods. Our approach leverages a lightweight router (which accounts for less than <math alttext="1.5\%" class="ltx_Math" display="inline" id="S1.I1.i1.p1.1.m1.1"><semantics id="S1.I1.i1.p1.1.m1.1a"><mrow id="S1.I1.i1.p1.1.m1.1.1" xref="S1.I1.i1.p1.1.m1.1.1.cmml"><mn id="S1.I1.i1.p1.1.m1.1.1.2" xref="S1.I1.i1.p1.1.m1.1.1.2.cmml">1.5</mn><mo id="S1.I1.i1.p1.1.m1.1.1.1" xref="S1.I1.i1.p1.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S1.I1.i1.p1.1.m1.1b"><apply id="S1.I1.i1.p1.1.m1.1.1.cmml" xref="S1.I1.i1.p1.1.m1.1.1"><csymbol cd="latexml" id="S1.I1.i1.p1.1.m1.1.1.1.cmml" xref="S1.I1.i1.p1.1.m1.1.1.1">percent</csymbol><cn id="S1.I1.i1.p1.1.m1.1.1.2.cmml" type="float" xref="S1.I1.i1.p1.1.m1.1.1.2">1.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.I1.i1.p1.1.m1.1c">1.5\%</annotation><annotation encoding="application/x-llamapun" id="S1.I1.i1.p1.1.m1.1d">1.5 %</annotation></semantics></math> of the size of each expert) to efficiently route sequences. This router determines the most suitable expert for a given sequence based on a short prefix (see §&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#S2" title="2 Method ‣ No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_tag">2</span></a>).</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="S1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para ltx_noindent" id="S1.I1.i2.p1">
<p class="ltx_p" id="S1.I1.i2.p1.1">We empirically demonstrate that our method achieves significantly lower perplexity than a dense baseline for near-identical training and inference FLOPs and identical training data volume (see Fig.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#S3.F2" title="Figure 2 ‣ 3.2 Language Modeling Results ‣ 3 Experiments ‣ No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_tag">2</span></a>).
Furthermore, we show that for a constant mixture model size, the improvement in perplexity increases with the number of experts.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="S1.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para ltx_noindent" id="S1.I1.i3.p1">
<p class="ltx_p" id="S1.I1.i3.p1.1">We evaluate our method on a set of downstream tasks, showing that it achieves better or similar accuracy compared to a dense baseline on <math alttext="75\%" class="ltx_Math" display="inline" id="S1.I1.i3.p1.1.m1.1"><semantics id="S1.I1.i3.p1.1.m1.1a"><mrow id="S1.I1.i3.p1.1.m1.1.1" xref="S1.I1.i3.p1.1.m1.1.1.cmml"><mn id="S1.I1.i3.p1.1.m1.1.1.2" xref="S1.I1.i3.p1.1.m1.1.1.2.cmml">75</mn><mo id="S1.I1.i3.p1.1.m1.1.1.1" xref="S1.I1.i3.p1.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S1.I1.i3.p1.1.m1.1b"><apply id="S1.I1.i3.p1.1.m1.1.1.cmml" xref="S1.I1.i3.p1.1.m1.1.1"><csymbol cd="latexml" id="S1.I1.i3.p1.1.m1.1.1.1.cmml" xref="S1.I1.i3.p1.1.m1.1.1.1">percent</csymbol><cn id="S1.I1.i3.p1.1.m1.1.1.2.cmml" type="integer" xref="S1.I1.i3.p1.1.m1.1.1.2">75</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.I1.i3.p1.1.m1.1c">75\%</annotation><annotation encoding="application/x-llamapun" id="S1.I1.i3.p1.1.m1.1d">75 %</annotation></semantics></math> of the tasks (see §&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#S3.SS3" title="3.3 Downstream evaluation ‣ 3 Experiments ‣ No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_tag">3.3</span></a> and App.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#A2" title="Appendix B Downstream evaluation ‣ No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_tag">B</span></a>).</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
</ul>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Method</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S2.p1">
<p class="ltx_p" id="S2.p1.1">In this section, we formalize our proposed method: <span class="ltx_text ltx_font_smallcaps" id="S2.p1.1.1">SmallTalk LM</span>. In §&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#S2.SS1" title="2.1 Background ‣ 2 Method ‣ No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_tag">2.1</span></a>, we introduce general language modeling background, and present a mixture of experts framework in this context. Subsequently, in §&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#S2.SS2" title="2.2 SmallTalk LM ‣ 2 Method ‣ No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_tag">2.2</span></a>, we show how we can use independent language models to perform routing to different experts in the mixture. We also present the training procedure and implementation details of our method. Finally, we discuss its marginal computational overhead and minimal distributed communication costs.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<section class="ltx_subsection" id="S2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Background</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<section class="ltx_paragraph" id="S2.SS1.SSS0.Px1">
<h5 class="ltx_title ltx_title_paragraph">Language modeling</h5><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S2.SS1.SSS0.Px1.p1">
<p class="ltx_p" id="S2.SS1.SSS0.Px1.p1.9">Let <math alttext="\mathcal{V}" class="ltx_Math" display="inline" id="S2.SS1.SSS0.Px1.p1.1.m1.1"><semantics id="S2.SS1.SSS0.Px1.p1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.SSS0.Px1.p1.1.m1.1.1" xref="S2.SS1.SSS0.Px1.p1.1.m1.1.1.cmml">𝒱</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS0.Px1.p1.1.m1.1b"><ci id="S2.SS1.SSS0.Px1.p1.1.m1.1.1.cmml" xref="S2.SS1.SSS0.Px1.p1.1.m1.1.1">𝒱</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS0.Px1.p1.1.m1.1c">\mathcal{V}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS0.Px1.p1.1.m1.1d">caligraphic_V</annotation></semantics></math> denote a fixed vocabulary, and consider a sequence of tokens <math alttext="\mathbf{x}=(x_{1},x_{2},\dots,x_{S})" class="ltx_Math" display="inline" id="S2.SS1.SSS0.Px1.p1.2.m2.4"><semantics id="S2.SS1.SSS0.Px1.p1.2.m2.4a"><mrow id="S2.SS1.SSS0.Px1.p1.2.m2.4.4" xref="S2.SS1.SSS0.Px1.p1.2.m2.4.4.cmml"><mi id="S2.SS1.SSS0.Px1.p1.2.m2.4.4.5" xref="S2.SS1.SSS0.Px1.p1.2.m2.4.4.5.cmml">𝐱</mi><mo id="S2.SS1.SSS0.Px1.p1.2.m2.4.4.4" xref="S2.SS1.SSS0.Px1.p1.2.m2.4.4.4.cmml">=</mo><mrow id="S2.SS1.SSS0.Px1.p1.2.m2.4.4.3.3" xref="S2.SS1.SSS0.Px1.p1.2.m2.4.4.3.4.cmml"><mo id="S2.SS1.SSS0.Px1.p1.2.m2.4.4.3.3.4" stretchy="false" xref="S2.SS1.SSS0.Px1.p1.2.m2.4.4.3.4.cmml">(</mo><msub id="S2.SS1.SSS0.Px1.p1.2.m2.2.2.1.1.1" xref="S2.SS1.SSS0.Px1.p1.2.m2.2.2.1.1.1.cmml"><mi id="S2.SS1.SSS0.Px1.p1.2.m2.2.2.1.1.1.2" xref="S2.SS1.SSS0.Px1.p1.2.m2.2.2.1.1.1.2.cmml">x</mi><mn id="S2.SS1.SSS0.Px1.p1.2.m2.2.2.1.1.1.3" xref="S2.SS1.SSS0.Px1.p1.2.m2.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S2.SS1.SSS0.Px1.p1.2.m2.4.4.3.3.5" xref="S2.SS1.SSS0.Px1.p1.2.m2.4.4.3.4.cmml">,</mo><msub id="S2.SS1.SSS0.Px1.p1.2.m2.3.3.2.2.2" xref="S2.SS1.SSS0.Px1.p1.2.m2.3.3.2.2.2.cmml"><mi id="S2.SS1.SSS0.Px1.p1.2.m2.3.3.2.2.2.2" xref="S2.SS1.SSS0.Px1.p1.2.m2.3.3.2.2.2.2.cmml">x</mi><mn id="S2.SS1.SSS0.Px1.p1.2.m2.3.3.2.2.2.3" xref="S2.SS1.SSS0.Px1.p1.2.m2.3.3.2.2.2.3.cmml">2</mn></msub><mo id="S2.SS1.SSS0.Px1.p1.2.m2.4.4.3.3.6" xref="S2.SS1.SSS0.Px1.p1.2.m2.4.4.3.4.cmml">,</mo><mi id="S2.SS1.SSS0.Px1.p1.2.m2.1.1" mathvariant="normal" xref="S2.SS1.SSS0.Px1.p1.2.m2.1.1.cmml">…</mi><mo id="S2.SS1.SSS0.Px1.p1.2.m2.4.4.3.3.7" xref="S2.SS1.SSS0.Px1.p1.2.m2.4.4.3.4.cmml">,</mo><msub id="S2.SS1.SSS0.Px1.p1.2.m2.4.4.3.3.3" xref="S2.SS1.SSS0.Px1.p1.2.m2.4.4.3.3.3.cmml"><mi id="S2.SS1.SSS0.Px1.p1.2.m2.4.4.3.3.3.2" xref="S2.SS1.SSS0.Px1.p1.2.m2.4.4.3.3.3.2.cmml">x</mi><mi id="S2.SS1.SSS0.Px1.p1.2.m2.4.4.3.3.3.3" xref="S2.SS1.SSS0.Px1.p1.2.m2.4.4.3.3.3.3.cmml">S</mi></msub><mo id="S2.SS1.SSS0.Px1.p1.2.m2.4.4.3.3.8" stretchy="false" xref="S2.SS1.SSS0.Px1.p1.2.m2.4.4.3.4.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS0.Px1.p1.2.m2.4b"><apply id="S2.SS1.SSS0.Px1.p1.2.m2.4.4.cmml" xref="S2.SS1.SSS0.Px1.p1.2.m2.4.4"><eq id="S2.SS1.SSS0.Px1.p1.2.m2.4.4.4.cmml" xref="S2.SS1.SSS0.Px1.p1.2.m2.4.4.4"></eq><ci id="S2.SS1.SSS0.Px1.p1.2.m2.4.4.5.cmml" xref="S2.SS1.SSS0.Px1.p1.2.m2.4.4.5">𝐱</ci><vector id="S2.SS1.SSS0.Px1.p1.2.m2.4.4.3.4.cmml" xref="S2.SS1.SSS0.Px1.p1.2.m2.4.4.3.3"><apply id="S2.SS1.SSS0.Px1.p1.2.m2.2.2.1.1.1.cmml" xref="S2.SS1.SSS0.Px1.p1.2.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.SSS0.Px1.p1.2.m2.2.2.1.1.1.1.cmml" xref="S2.SS1.SSS0.Px1.p1.2.m2.2.2.1.1.1">subscript</csymbol><ci id="S2.SS1.SSS0.Px1.p1.2.m2.2.2.1.1.1.2.cmml" xref="S2.SS1.SSS0.Px1.p1.2.m2.2.2.1.1.1.2">𝑥</ci><cn id="S2.SS1.SSS0.Px1.p1.2.m2.2.2.1.1.1.3.cmml" type="integer" xref="S2.SS1.SSS0.Px1.p1.2.m2.2.2.1.1.1.3">1</cn></apply><apply id="S2.SS1.SSS0.Px1.p1.2.m2.3.3.2.2.2.cmml" xref="S2.SS1.SSS0.Px1.p1.2.m2.3.3.2.2.2"><csymbol cd="ambiguous" id="S2.SS1.SSS0.Px1.p1.2.m2.3.3.2.2.2.1.cmml" xref="S2.SS1.SSS0.Px1.p1.2.m2.3.3.2.2.2">subscript</csymbol><ci id="S2.SS1.SSS0.Px1.p1.2.m2.3.3.2.2.2.2.cmml" xref="S2.SS1.SSS0.Px1.p1.2.m2.3.3.2.2.2.2">𝑥</ci><cn id="S2.SS1.SSS0.Px1.p1.2.m2.3.3.2.2.2.3.cmml" type="integer" xref="S2.SS1.SSS0.Px1.p1.2.m2.3.3.2.2.2.3">2</cn></apply><ci id="S2.SS1.SSS0.Px1.p1.2.m2.1.1.cmml" xref="S2.SS1.SSS0.Px1.p1.2.m2.1.1">…</ci><apply id="S2.SS1.SSS0.Px1.p1.2.m2.4.4.3.3.3.cmml" xref="S2.SS1.SSS0.Px1.p1.2.m2.4.4.3.3.3"><csymbol cd="ambiguous" id="S2.SS1.SSS0.Px1.p1.2.m2.4.4.3.3.3.1.cmml" xref="S2.SS1.SSS0.Px1.p1.2.m2.4.4.3.3.3">subscript</csymbol><ci id="S2.SS1.SSS0.Px1.p1.2.m2.4.4.3.3.3.2.cmml" xref="S2.SS1.SSS0.Px1.p1.2.m2.4.4.3.3.3.2">𝑥</ci><ci id="S2.SS1.SSS0.Px1.p1.2.m2.4.4.3.3.3.3.cmml" xref="S2.SS1.SSS0.Px1.p1.2.m2.4.4.3.3.3.3">𝑆</ci></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS0.Px1.p1.2.m2.4c">\mathbf{x}=(x_{1},x_{2},\dots,x_{S})</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS0.Px1.p1.2.m2.4d">bold_x = ( italic_x start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_x start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , italic_x start_POSTSUBSCRIPT italic_S end_POSTSUBSCRIPT )</annotation></semantics></math>, where each <math alttext="x_{s}\in\mathcal{V}" class="ltx_Math" display="inline" id="S2.SS1.SSS0.Px1.p1.3.m3.1"><semantics id="S2.SS1.SSS0.Px1.p1.3.m3.1a"><mrow id="S2.SS1.SSS0.Px1.p1.3.m3.1.1" xref="S2.SS1.SSS0.Px1.p1.3.m3.1.1.cmml"><msub id="S2.SS1.SSS0.Px1.p1.3.m3.1.1.2" xref="S2.SS1.SSS0.Px1.p1.3.m3.1.1.2.cmml"><mi id="S2.SS1.SSS0.Px1.p1.3.m3.1.1.2.2" xref="S2.SS1.SSS0.Px1.p1.3.m3.1.1.2.2.cmml">x</mi><mi id="S2.SS1.SSS0.Px1.p1.3.m3.1.1.2.3" xref="S2.SS1.SSS0.Px1.p1.3.m3.1.1.2.3.cmml">s</mi></msub><mo id="S2.SS1.SSS0.Px1.p1.3.m3.1.1.1" xref="S2.SS1.SSS0.Px1.p1.3.m3.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S2.SS1.SSS0.Px1.p1.3.m3.1.1.3" xref="S2.SS1.SSS0.Px1.p1.3.m3.1.1.3.cmml">𝒱</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS0.Px1.p1.3.m3.1b"><apply id="S2.SS1.SSS0.Px1.p1.3.m3.1.1.cmml" xref="S2.SS1.SSS0.Px1.p1.3.m3.1.1"><in id="S2.SS1.SSS0.Px1.p1.3.m3.1.1.1.cmml" xref="S2.SS1.SSS0.Px1.p1.3.m3.1.1.1"></in><apply id="S2.SS1.SSS0.Px1.p1.3.m3.1.1.2.cmml" xref="S2.SS1.SSS0.Px1.p1.3.m3.1.1.2"><csymbol cd="ambiguous" id="S2.SS1.SSS0.Px1.p1.3.m3.1.1.2.1.cmml" xref="S2.SS1.SSS0.Px1.p1.3.m3.1.1.2">subscript</csymbol><ci id="S2.SS1.SSS0.Px1.p1.3.m3.1.1.2.2.cmml" xref="S2.SS1.SSS0.Px1.p1.3.m3.1.1.2.2">𝑥</ci><ci id="S2.SS1.SSS0.Px1.p1.3.m3.1.1.2.3.cmml" xref="S2.SS1.SSS0.Px1.p1.3.m3.1.1.2.3">𝑠</ci></apply><ci id="S2.SS1.SSS0.Px1.p1.3.m3.1.1.3.cmml" xref="S2.SS1.SSS0.Px1.p1.3.m3.1.1.3">𝒱</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS0.Px1.p1.3.m3.1c">x_{s}\in\mathcal{V}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS0.Px1.p1.3.m3.1d">italic_x start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT ∈ caligraphic_V</annotation></semantics></math> for <math alttext="s=1,2,\dots,S" class="ltx_Math" display="inline" id="S2.SS1.SSS0.Px1.p1.4.m4.4"><semantics id="S2.SS1.SSS0.Px1.p1.4.m4.4a"><mrow id="S2.SS1.SSS0.Px1.p1.4.m4.4.5" xref="S2.SS1.SSS0.Px1.p1.4.m4.4.5.cmml"><mi id="S2.SS1.SSS0.Px1.p1.4.m4.4.5.2" xref="S2.SS1.SSS0.Px1.p1.4.m4.4.5.2.cmml">s</mi><mo id="S2.SS1.SSS0.Px1.p1.4.m4.4.5.1" xref="S2.SS1.SSS0.Px1.p1.4.m4.4.5.1.cmml">=</mo><mrow id="S2.SS1.SSS0.Px1.p1.4.m4.4.5.3.2" xref="S2.SS1.SSS0.Px1.p1.4.m4.4.5.3.1.cmml"><mn id="S2.SS1.SSS0.Px1.p1.4.m4.1.1" xref="S2.SS1.SSS0.Px1.p1.4.m4.1.1.cmml">1</mn><mo id="S2.SS1.SSS0.Px1.p1.4.m4.4.5.3.2.1" xref="S2.SS1.SSS0.Px1.p1.4.m4.4.5.3.1.cmml">,</mo><mn id="S2.SS1.SSS0.Px1.p1.4.m4.2.2" xref="S2.SS1.SSS0.Px1.p1.4.m4.2.2.cmml">2</mn><mo id="S2.SS1.SSS0.Px1.p1.4.m4.4.5.3.2.2" xref="S2.SS1.SSS0.Px1.p1.4.m4.4.5.3.1.cmml">,</mo><mi id="S2.SS1.SSS0.Px1.p1.4.m4.3.3" mathvariant="normal" xref="S2.SS1.SSS0.Px1.p1.4.m4.3.3.cmml">…</mi><mo id="S2.SS1.SSS0.Px1.p1.4.m4.4.5.3.2.3" xref="S2.SS1.SSS0.Px1.p1.4.m4.4.5.3.1.cmml">,</mo><mi id="S2.SS1.SSS0.Px1.p1.4.m4.4.4" xref="S2.SS1.SSS0.Px1.p1.4.m4.4.4.cmml">S</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS0.Px1.p1.4.m4.4b"><apply id="S2.SS1.SSS0.Px1.p1.4.m4.4.5.cmml" xref="S2.SS1.SSS0.Px1.p1.4.m4.4.5"><eq id="S2.SS1.SSS0.Px1.p1.4.m4.4.5.1.cmml" xref="S2.SS1.SSS0.Px1.p1.4.m4.4.5.1"></eq><ci id="S2.SS1.SSS0.Px1.p1.4.m4.4.5.2.cmml" xref="S2.SS1.SSS0.Px1.p1.4.m4.4.5.2">𝑠</ci><list id="S2.SS1.SSS0.Px1.p1.4.m4.4.5.3.1.cmml" xref="S2.SS1.SSS0.Px1.p1.4.m4.4.5.3.2"><cn id="S2.SS1.SSS0.Px1.p1.4.m4.1.1.cmml" type="integer" xref="S2.SS1.SSS0.Px1.p1.4.m4.1.1">1</cn><cn id="S2.SS1.SSS0.Px1.p1.4.m4.2.2.cmml" type="integer" xref="S2.SS1.SSS0.Px1.p1.4.m4.2.2">2</cn><ci id="S2.SS1.SSS0.Px1.p1.4.m4.3.3.cmml" xref="S2.SS1.SSS0.Px1.p1.4.m4.3.3">…</ci><ci id="S2.SS1.SSS0.Px1.p1.4.m4.4.4.cmml" xref="S2.SS1.SSS0.Px1.p1.4.m4.4.4">𝑆</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS0.Px1.p1.4.m4.4c">s=1,2,\dots,S</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS0.Px1.p1.4.m4.4d">italic_s = 1 , 2 , … , italic_S</annotation></semantics></math>. Language modeling is about modeling the data distribution <math alttext="p(\mathbf{x})" class="ltx_Math" display="inline" id="S2.SS1.SSS0.Px1.p1.5.m5.1"><semantics id="S2.SS1.SSS0.Px1.p1.5.m5.1a"><mrow id="S2.SS1.SSS0.Px1.p1.5.m5.1.2" xref="S2.SS1.SSS0.Px1.p1.5.m5.1.2.cmml"><mi id="S2.SS1.SSS0.Px1.p1.5.m5.1.2.2" xref="S2.SS1.SSS0.Px1.p1.5.m5.1.2.2.cmml">p</mi><mo id="S2.SS1.SSS0.Px1.p1.5.m5.1.2.1" xref="S2.SS1.SSS0.Px1.p1.5.m5.1.2.1.cmml">⁢</mo><mrow id="S2.SS1.SSS0.Px1.p1.5.m5.1.2.3.2" xref="S2.SS1.SSS0.Px1.p1.5.m5.1.2.cmml"><mo id="S2.SS1.SSS0.Px1.p1.5.m5.1.2.3.2.1" stretchy="false" xref="S2.SS1.SSS0.Px1.p1.5.m5.1.2.cmml">(</mo><mi id="S2.SS1.SSS0.Px1.p1.5.m5.1.1" xref="S2.SS1.SSS0.Px1.p1.5.m5.1.1.cmml">𝐱</mi><mo id="S2.SS1.SSS0.Px1.p1.5.m5.1.2.3.2.2" stretchy="false" xref="S2.SS1.SSS0.Px1.p1.5.m5.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS0.Px1.p1.5.m5.1b"><apply id="S2.SS1.SSS0.Px1.p1.5.m5.1.2.cmml" xref="S2.SS1.SSS0.Px1.p1.5.m5.1.2"><times id="S2.SS1.SSS0.Px1.p1.5.m5.1.2.1.cmml" xref="S2.SS1.SSS0.Px1.p1.5.m5.1.2.1"></times><ci id="S2.SS1.SSS0.Px1.p1.5.m5.1.2.2.cmml" xref="S2.SS1.SSS0.Px1.p1.5.m5.1.2.2">𝑝</ci><ci id="S2.SS1.SSS0.Px1.p1.5.m5.1.1.cmml" xref="S2.SS1.SSS0.Px1.p1.5.m5.1.1">𝐱</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS0.Px1.p1.5.m5.1c">p(\mathbf{x})</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS0.Px1.p1.5.m5.1d">italic_p ( bold_x )</annotation></semantics></math>, which in practice is cast as training a language model <math alttext="p(x_{s+1}\mid\mathbf{x}_{1:s}\,;\,\theta)" class="ltx_Math" display="inline" id="S2.SS1.SSS0.Px1.p1.6.m6.2"><semantics id="S2.SS1.SSS0.Px1.p1.6.m6.2a"><mrow id="S2.SS1.SSS0.Px1.p1.6.m6.2.2" xref="S2.SS1.SSS0.Px1.p1.6.m6.2.2.cmml"><mi id="S2.SS1.SSS0.Px1.p1.6.m6.2.2.3" xref="S2.SS1.SSS0.Px1.p1.6.m6.2.2.3.cmml">p</mi><mo id="S2.SS1.SSS0.Px1.p1.6.m6.2.2.2" xref="S2.SS1.SSS0.Px1.p1.6.m6.2.2.2.cmml">⁢</mo><mrow id="S2.SS1.SSS0.Px1.p1.6.m6.2.2.1.1" xref="S2.SS1.SSS0.Px1.p1.6.m6.2.2.1.1.1.cmml"><mo id="S2.SS1.SSS0.Px1.p1.6.m6.2.2.1.1.2" stretchy="false" xref="S2.SS1.SSS0.Px1.p1.6.m6.2.2.1.1.1.cmml">(</mo><mrow id="S2.SS1.SSS0.Px1.p1.6.m6.2.2.1.1.1" xref="S2.SS1.SSS0.Px1.p1.6.m6.2.2.1.1.1.cmml"><msub id="S2.SS1.SSS0.Px1.p1.6.m6.2.2.1.1.1.3" xref="S2.SS1.SSS0.Px1.p1.6.m6.2.2.1.1.1.3.cmml"><mi id="S2.SS1.SSS0.Px1.p1.6.m6.2.2.1.1.1.3.2" xref="S2.SS1.SSS0.Px1.p1.6.m6.2.2.1.1.1.3.2.cmml">x</mi><mrow id="S2.SS1.SSS0.Px1.p1.6.m6.2.2.1.1.1.3.3" xref="S2.SS1.SSS0.Px1.p1.6.m6.2.2.1.1.1.3.3.cmml"><mi id="S2.SS1.SSS0.Px1.p1.6.m6.2.2.1.1.1.3.3.2" xref="S2.SS1.SSS0.Px1.p1.6.m6.2.2.1.1.1.3.3.2.cmml">s</mi><mo id="S2.SS1.SSS0.Px1.p1.6.m6.2.2.1.1.1.3.3.1" xref="S2.SS1.SSS0.Px1.p1.6.m6.2.2.1.1.1.3.3.1.cmml">+</mo><mn id="S2.SS1.SSS0.Px1.p1.6.m6.2.2.1.1.1.3.3.3" xref="S2.SS1.SSS0.Px1.p1.6.m6.2.2.1.1.1.3.3.3.cmml">1</mn></mrow></msub><mo id="S2.SS1.SSS0.Px1.p1.6.m6.2.2.1.1.1.2" xref="S2.SS1.SSS0.Px1.p1.6.m6.2.2.1.1.1.2.cmml">∣</mo><mrow id="S2.SS1.SSS0.Px1.p1.6.m6.2.2.1.1.1.1.1" xref="S2.SS1.SSS0.Px1.p1.6.m6.2.2.1.1.1.1.2.cmml"><msub id="S2.SS1.SSS0.Px1.p1.6.m6.2.2.1.1.1.1.1.1" xref="S2.SS1.SSS0.Px1.p1.6.m6.2.2.1.1.1.1.1.1.cmml"><mi id="S2.SS1.SSS0.Px1.p1.6.m6.2.2.1.1.1.1.1.1.2" xref="S2.SS1.SSS0.Px1.p1.6.m6.2.2.1.1.1.1.1.1.2.cmml">𝐱</mi><mrow id="S2.SS1.SSS0.Px1.p1.6.m6.2.2.1.1.1.1.1.1.3" xref="S2.SS1.SSS0.Px1.p1.6.m6.2.2.1.1.1.1.1.1.3.cmml"><mn id="S2.SS1.SSS0.Px1.p1.6.m6.2.2.1.1.1.1.1.1.3.2" xref="S2.SS1.SSS0.Px1.p1.6.m6.2.2.1.1.1.1.1.1.3.2.cmml">1</mn><mo id="S2.SS1.SSS0.Px1.p1.6.m6.2.2.1.1.1.1.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="S2.SS1.SSS0.Px1.p1.6.m6.2.2.1.1.1.1.1.1.3.1.cmml">:</mo><mi id="S2.SS1.SSS0.Px1.p1.6.m6.2.2.1.1.1.1.1.1.3.3" xref="S2.SS1.SSS0.Px1.p1.6.m6.2.2.1.1.1.1.1.1.3.3.cmml">s</mi></mrow></msub><mo id="S2.SS1.SSS0.Px1.p1.6.m6.2.2.1.1.1.1.1.2" rspace="0.337em" xref="S2.SS1.SSS0.Px1.p1.6.m6.2.2.1.1.1.1.2.cmml">;</mo><mi id="S2.SS1.SSS0.Px1.p1.6.m6.1.1" xref="S2.SS1.SSS0.Px1.p1.6.m6.1.1.cmml">θ</mi></mrow></mrow><mo id="S2.SS1.SSS0.Px1.p1.6.m6.2.2.1.1.3" stretchy="false" xref="S2.SS1.SSS0.Px1.p1.6.m6.2.2.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS0.Px1.p1.6.m6.2b"><apply id="S2.SS1.SSS0.Px1.p1.6.m6.2.2.cmml" xref="S2.SS1.SSS0.Px1.p1.6.m6.2.2"><times id="S2.SS1.SSS0.Px1.p1.6.m6.2.2.2.cmml" xref="S2.SS1.SSS0.Px1.p1.6.m6.2.2.2"></times><ci id="S2.SS1.SSS0.Px1.p1.6.m6.2.2.3.cmml" xref="S2.SS1.SSS0.Px1.p1.6.m6.2.2.3">𝑝</ci><apply id="S2.SS1.SSS0.Px1.p1.6.m6.2.2.1.1.1.cmml" xref="S2.SS1.SSS0.Px1.p1.6.m6.2.2.1.1"><csymbol cd="latexml" id="S2.SS1.SSS0.Px1.p1.6.m6.2.2.1.1.1.2.cmml" xref="S2.SS1.SSS0.Px1.p1.6.m6.2.2.1.1.1.2">conditional</csymbol><apply id="S2.SS1.SSS0.Px1.p1.6.m6.2.2.1.1.1.3.cmml" xref="S2.SS1.SSS0.Px1.p1.6.m6.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S2.SS1.SSS0.Px1.p1.6.m6.2.2.1.1.1.3.1.cmml" xref="S2.SS1.SSS0.Px1.p1.6.m6.2.2.1.1.1.3">subscript</csymbol><ci id="S2.SS1.SSS0.Px1.p1.6.m6.2.2.1.1.1.3.2.cmml" xref="S2.SS1.SSS0.Px1.p1.6.m6.2.2.1.1.1.3.2">𝑥</ci><apply id="S2.SS1.SSS0.Px1.p1.6.m6.2.2.1.1.1.3.3.cmml" xref="S2.SS1.SSS0.Px1.p1.6.m6.2.2.1.1.1.3.3"><plus id="S2.SS1.SSS0.Px1.p1.6.m6.2.2.1.1.1.3.3.1.cmml" xref="S2.SS1.SSS0.Px1.p1.6.m6.2.2.1.1.1.3.3.1"></plus><ci id="S2.SS1.SSS0.Px1.p1.6.m6.2.2.1.1.1.3.3.2.cmml" xref="S2.SS1.SSS0.Px1.p1.6.m6.2.2.1.1.1.3.3.2">𝑠</ci><cn id="S2.SS1.SSS0.Px1.p1.6.m6.2.2.1.1.1.3.3.3.cmml" type="integer" xref="S2.SS1.SSS0.Px1.p1.6.m6.2.2.1.1.1.3.3.3">1</cn></apply></apply><list id="S2.SS1.SSS0.Px1.p1.6.m6.2.2.1.1.1.1.2.cmml" xref="S2.SS1.SSS0.Px1.p1.6.m6.2.2.1.1.1.1.1"><apply id="S2.SS1.SSS0.Px1.p1.6.m6.2.2.1.1.1.1.1.1.cmml" xref="S2.SS1.SSS0.Px1.p1.6.m6.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.SSS0.Px1.p1.6.m6.2.2.1.1.1.1.1.1.1.cmml" xref="S2.SS1.SSS0.Px1.p1.6.m6.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="S2.SS1.SSS0.Px1.p1.6.m6.2.2.1.1.1.1.1.1.2.cmml" xref="S2.SS1.SSS0.Px1.p1.6.m6.2.2.1.1.1.1.1.1.2">𝐱</ci><apply id="S2.SS1.SSS0.Px1.p1.6.m6.2.2.1.1.1.1.1.1.3.cmml" xref="S2.SS1.SSS0.Px1.p1.6.m6.2.2.1.1.1.1.1.1.3"><ci id="S2.SS1.SSS0.Px1.p1.6.m6.2.2.1.1.1.1.1.1.3.1.cmml" xref="S2.SS1.SSS0.Px1.p1.6.m6.2.2.1.1.1.1.1.1.3.1">:</ci><cn id="S2.SS1.SSS0.Px1.p1.6.m6.2.2.1.1.1.1.1.1.3.2.cmml" type="integer" xref="S2.SS1.SSS0.Px1.p1.6.m6.2.2.1.1.1.1.1.1.3.2">1</cn><ci id="S2.SS1.SSS0.Px1.p1.6.m6.2.2.1.1.1.1.1.1.3.3.cmml" xref="S2.SS1.SSS0.Px1.p1.6.m6.2.2.1.1.1.1.1.1.3.3">𝑠</ci></apply></apply><ci id="S2.SS1.SSS0.Px1.p1.6.m6.1.1.cmml" xref="S2.SS1.SSS0.Px1.p1.6.m6.1.1">𝜃</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS0.Px1.p1.6.m6.2c">p(x_{s+1}\mid\mathbf{x}_{1:s}\,;\,\theta)</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS0.Px1.p1.6.m6.2d">italic_p ( italic_x start_POSTSUBSCRIPT italic_s + 1 end_POSTSUBSCRIPT ∣ bold_x start_POSTSUBSCRIPT 1 : italic_s end_POSTSUBSCRIPT ; italic_θ )</annotation></semantics></math> generating a token <math alttext="x_{s+1}" class="ltx_Math" display="inline" id="S2.SS1.SSS0.Px1.p1.7.m7.1"><semantics id="S2.SS1.SSS0.Px1.p1.7.m7.1a"><msub id="S2.SS1.SSS0.Px1.p1.7.m7.1.1" xref="S2.SS1.SSS0.Px1.p1.7.m7.1.1.cmml"><mi id="S2.SS1.SSS0.Px1.p1.7.m7.1.1.2" xref="S2.SS1.SSS0.Px1.p1.7.m7.1.1.2.cmml">x</mi><mrow id="S2.SS1.SSS0.Px1.p1.7.m7.1.1.3" xref="S2.SS1.SSS0.Px1.p1.7.m7.1.1.3.cmml"><mi id="S2.SS1.SSS0.Px1.p1.7.m7.1.1.3.2" xref="S2.SS1.SSS0.Px1.p1.7.m7.1.1.3.2.cmml">s</mi><mo id="S2.SS1.SSS0.Px1.p1.7.m7.1.1.3.1" xref="S2.SS1.SSS0.Px1.p1.7.m7.1.1.3.1.cmml">+</mo><mn id="S2.SS1.SSS0.Px1.p1.7.m7.1.1.3.3" xref="S2.SS1.SSS0.Px1.p1.7.m7.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS0.Px1.p1.7.m7.1b"><apply id="S2.SS1.SSS0.Px1.p1.7.m7.1.1.cmml" xref="S2.SS1.SSS0.Px1.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S2.SS1.SSS0.Px1.p1.7.m7.1.1.1.cmml" xref="S2.SS1.SSS0.Px1.p1.7.m7.1.1">subscript</csymbol><ci id="S2.SS1.SSS0.Px1.p1.7.m7.1.1.2.cmml" xref="S2.SS1.SSS0.Px1.p1.7.m7.1.1.2">𝑥</ci><apply id="S2.SS1.SSS0.Px1.p1.7.m7.1.1.3.cmml" xref="S2.SS1.SSS0.Px1.p1.7.m7.1.1.3"><plus id="S2.SS1.SSS0.Px1.p1.7.m7.1.1.3.1.cmml" xref="S2.SS1.SSS0.Px1.p1.7.m7.1.1.3.1"></plus><ci id="S2.SS1.SSS0.Px1.p1.7.m7.1.1.3.2.cmml" xref="S2.SS1.SSS0.Px1.p1.7.m7.1.1.3.2">𝑠</ci><cn id="S2.SS1.SSS0.Px1.p1.7.m7.1.1.3.3.cmml" type="integer" xref="S2.SS1.SSS0.Px1.p1.7.m7.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS0.Px1.p1.7.m7.1c">x_{s+1}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS0.Px1.p1.7.m7.1d">italic_x start_POSTSUBSCRIPT italic_s + 1 end_POSTSUBSCRIPT</annotation></semantics></math> given a context sequence <math alttext="\mathbf{x}_{1:s}=(x_{1},x_{2},\dots,x_{s})" class="ltx_Math" display="inline" id="S2.SS1.SSS0.Px1.p1.8.m8.4"><semantics id="S2.SS1.SSS0.Px1.p1.8.m8.4a"><mrow id="S2.SS1.SSS0.Px1.p1.8.m8.4.4" xref="S2.SS1.SSS0.Px1.p1.8.m8.4.4.cmml"><msub id="S2.SS1.SSS0.Px1.p1.8.m8.4.4.5" xref="S2.SS1.SSS0.Px1.p1.8.m8.4.4.5.cmml"><mi id="S2.SS1.SSS0.Px1.p1.8.m8.4.4.5.2" xref="S2.SS1.SSS0.Px1.p1.8.m8.4.4.5.2.cmml">𝐱</mi><mrow id="S2.SS1.SSS0.Px1.p1.8.m8.4.4.5.3" xref="S2.SS1.SSS0.Px1.p1.8.m8.4.4.5.3.cmml"><mn id="S2.SS1.SSS0.Px1.p1.8.m8.4.4.5.3.2" xref="S2.SS1.SSS0.Px1.p1.8.m8.4.4.5.3.2.cmml">1</mn><mo id="S2.SS1.SSS0.Px1.p1.8.m8.4.4.5.3.1" lspace="0.278em" rspace="0.278em" xref="S2.SS1.SSS0.Px1.p1.8.m8.4.4.5.3.1.cmml">:</mo><mi id="S2.SS1.SSS0.Px1.p1.8.m8.4.4.5.3.3" xref="S2.SS1.SSS0.Px1.p1.8.m8.4.4.5.3.3.cmml">s</mi></mrow></msub><mo id="S2.SS1.SSS0.Px1.p1.8.m8.4.4.4" xref="S2.SS1.SSS0.Px1.p1.8.m8.4.4.4.cmml">=</mo><mrow id="S2.SS1.SSS0.Px1.p1.8.m8.4.4.3.3" xref="S2.SS1.SSS0.Px1.p1.8.m8.4.4.3.4.cmml"><mo id="S2.SS1.SSS0.Px1.p1.8.m8.4.4.3.3.4" stretchy="false" xref="S2.SS1.SSS0.Px1.p1.8.m8.4.4.3.4.cmml">(</mo><msub id="S2.SS1.SSS0.Px1.p1.8.m8.2.2.1.1.1" xref="S2.SS1.SSS0.Px1.p1.8.m8.2.2.1.1.1.cmml"><mi id="S2.SS1.SSS0.Px1.p1.8.m8.2.2.1.1.1.2" xref="S2.SS1.SSS0.Px1.p1.8.m8.2.2.1.1.1.2.cmml">x</mi><mn id="S2.SS1.SSS0.Px1.p1.8.m8.2.2.1.1.1.3" xref="S2.SS1.SSS0.Px1.p1.8.m8.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S2.SS1.SSS0.Px1.p1.8.m8.4.4.3.3.5" xref="S2.SS1.SSS0.Px1.p1.8.m8.4.4.3.4.cmml">,</mo><msub id="S2.SS1.SSS0.Px1.p1.8.m8.3.3.2.2.2" xref="S2.SS1.SSS0.Px1.p1.8.m8.3.3.2.2.2.cmml"><mi id="S2.SS1.SSS0.Px1.p1.8.m8.3.3.2.2.2.2" xref="S2.SS1.SSS0.Px1.p1.8.m8.3.3.2.2.2.2.cmml">x</mi><mn id="S2.SS1.SSS0.Px1.p1.8.m8.3.3.2.2.2.3" xref="S2.SS1.SSS0.Px1.p1.8.m8.3.3.2.2.2.3.cmml">2</mn></msub><mo id="S2.SS1.SSS0.Px1.p1.8.m8.4.4.3.3.6" xref="S2.SS1.SSS0.Px1.p1.8.m8.4.4.3.4.cmml">,</mo><mi id="S2.SS1.SSS0.Px1.p1.8.m8.1.1" mathvariant="normal" xref="S2.SS1.SSS0.Px1.p1.8.m8.1.1.cmml">…</mi><mo id="S2.SS1.SSS0.Px1.p1.8.m8.4.4.3.3.7" xref="S2.SS1.SSS0.Px1.p1.8.m8.4.4.3.4.cmml">,</mo><msub id="S2.SS1.SSS0.Px1.p1.8.m8.4.4.3.3.3" xref="S2.SS1.SSS0.Px1.p1.8.m8.4.4.3.3.3.cmml"><mi id="S2.SS1.SSS0.Px1.p1.8.m8.4.4.3.3.3.2" xref="S2.SS1.SSS0.Px1.p1.8.m8.4.4.3.3.3.2.cmml">x</mi><mi id="S2.SS1.SSS0.Px1.p1.8.m8.4.4.3.3.3.3" xref="S2.SS1.SSS0.Px1.p1.8.m8.4.4.3.3.3.3.cmml">s</mi></msub><mo id="S2.SS1.SSS0.Px1.p1.8.m8.4.4.3.3.8" stretchy="false" xref="S2.SS1.SSS0.Px1.p1.8.m8.4.4.3.4.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS0.Px1.p1.8.m8.4b"><apply id="S2.SS1.SSS0.Px1.p1.8.m8.4.4.cmml" xref="S2.SS1.SSS0.Px1.p1.8.m8.4.4"><eq id="S2.SS1.SSS0.Px1.p1.8.m8.4.4.4.cmml" xref="S2.SS1.SSS0.Px1.p1.8.m8.4.4.4"></eq><apply id="S2.SS1.SSS0.Px1.p1.8.m8.4.4.5.cmml" xref="S2.SS1.SSS0.Px1.p1.8.m8.4.4.5"><csymbol cd="ambiguous" id="S2.SS1.SSS0.Px1.p1.8.m8.4.4.5.1.cmml" xref="S2.SS1.SSS0.Px1.p1.8.m8.4.4.5">subscript</csymbol><ci id="S2.SS1.SSS0.Px1.p1.8.m8.4.4.5.2.cmml" xref="S2.SS1.SSS0.Px1.p1.8.m8.4.4.5.2">𝐱</ci><apply id="S2.SS1.SSS0.Px1.p1.8.m8.4.4.5.3.cmml" xref="S2.SS1.SSS0.Px1.p1.8.m8.4.4.5.3"><ci id="S2.SS1.SSS0.Px1.p1.8.m8.4.4.5.3.1.cmml" xref="S2.SS1.SSS0.Px1.p1.8.m8.4.4.5.3.1">:</ci><cn id="S2.SS1.SSS0.Px1.p1.8.m8.4.4.5.3.2.cmml" type="integer" xref="S2.SS1.SSS0.Px1.p1.8.m8.4.4.5.3.2">1</cn><ci id="S2.SS1.SSS0.Px1.p1.8.m8.4.4.5.3.3.cmml" xref="S2.SS1.SSS0.Px1.p1.8.m8.4.4.5.3.3">𝑠</ci></apply></apply><vector id="S2.SS1.SSS0.Px1.p1.8.m8.4.4.3.4.cmml" xref="S2.SS1.SSS0.Px1.p1.8.m8.4.4.3.3"><apply id="S2.SS1.SSS0.Px1.p1.8.m8.2.2.1.1.1.cmml" xref="S2.SS1.SSS0.Px1.p1.8.m8.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.SSS0.Px1.p1.8.m8.2.2.1.1.1.1.cmml" xref="S2.SS1.SSS0.Px1.p1.8.m8.2.2.1.1.1">subscript</csymbol><ci id="S2.SS1.SSS0.Px1.p1.8.m8.2.2.1.1.1.2.cmml" xref="S2.SS1.SSS0.Px1.p1.8.m8.2.2.1.1.1.2">𝑥</ci><cn id="S2.SS1.SSS0.Px1.p1.8.m8.2.2.1.1.1.3.cmml" type="integer" xref="S2.SS1.SSS0.Px1.p1.8.m8.2.2.1.1.1.3">1</cn></apply><apply id="S2.SS1.SSS0.Px1.p1.8.m8.3.3.2.2.2.cmml" xref="S2.SS1.SSS0.Px1.p1.8.m8.3.3.2.2.2"><csymbol cd="ambiguous" id="S2.SS1.SSS0.Px1.p1.8.m8.3.3.2.2.2.1.cmml" xref="S2.SS1.SSS0.Px1.p1.8.m8.3.3.2.2.2">subscript</csymbol><ci id="S2.SS1.SSS0.Px1.p1.8.m8.3.3.2.2.2.2.cmml" xref="S2.SS1.SSS0.Px1.p1.8.m8.3.3.2.2.2.2">𝑥</ci><cn id="S2.SS1.SSS0.Px1.p1.8.m8.3.3.2.2.2.3.cmml" type="integer" xref="S2.SS1.SSS0.Px1.p1.8.m8.3.3.2.2.2.3">2</cn></apply><ci id="S2.SS1.SSS0.Px1.p1.8.m8.1.1.cmml" xref="S2.SS1.SSS0.Px1.p1.8.m8.1.1">…</ci><apply id="S2.SS1.SSS0.Px1.p1.8.m8.4.4.3.3.3.cmml" xref="S2.SS1.SSS0.Px1.p1.8.m8.4.4.3.3.3"><csymbol cd="ambiguous" id="S2.SS1.SSS0.Px1.p1.8.m8.4.4.3.3.3.1.cmml" xref="S2.SS1.SSS0.Px1.p1.8.m8.4.4.3.3.3">subscript</csymbol><ci id="S2.SS1.SSS0.Px1.p1.8.m8.4.4.3.3.3.2.cmml" xref="S2.SS1.SSS0.Px1.p1.8.m8.4.4.3.3.3.2">𝑥</ci><ci id="S2.SS1.SSS0.Px1.p1.8.m8.4.4.3.3.3.3.cmml" xref="S2.SS1.SSS0.Px1.p1.8.m8.4.4.3.3.3.3">𝑠</ci></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS0.Px1.p1.8.m8.4c">\mathbf{x}_{1:s}=(x_{1},x_{2},\dots,x_{s})</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS0.Px1.p1.8.m8.4d">bold_x start_POSTSUBSCRIPT 1 : italic_s end_POSTSUBSCRIPT = ( italic_x start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_x start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , italic_x start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT )</annotation></semantics></math>. Typically, the model parameterized by <math alttext="\theta" class="ltx_Math" display="inline" id="S2.SS1.SSS0.Px1.p1.9.m9.1"><semantics id="S2.SS1.SSS0.Px1.p1.9.m9.1a"><mi id="S2.SS1.SSS0.Px1.p1.9.m9.1.1" xref="S2.SS1.SSS0.Px1.p1.9.m9.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS0.Px1.p1.9.m9.1b"><ci id="S2.SS1.SSS0.Px1.p1.9.m9.1.1.cmml" xref="S2.SS1.SSS0.Px1.p1.9.m9.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS0.Px1.p1.9.m9.1c">\theta</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS0.Px1.p1.9.m9.1d">italic_θ</annotation></semantics></math> is a neural network, and parameters are obtained by minimizing the negative log-likelihood:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equation ltx_eqn_table" id="S2.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}(\mathbf{x};\theta)=-\,p(\mathbf{x}\,;\,\theta)=-\sum_{s=1}^{S-1}%
\log p(x_{s+1}\mid\mathbf{x}_{1:s}\,;\,\theta)\,." class="ltx_Math" display="block" id="S2.E1.m1.6"><semantics id="S2.E1.m1.6a"><mrow id="S2.E1.m1.6.6.1" xref="S2.E1.m1.6.6.1.1.cmml"><mrow id="S2.E1.m1.6.6.1.1" xref="S2.E1.m1.6.6.1.1.cmml"><mrow id="S2.E1.m1.6.6.1.1.3" xref="S2.E1.m1.6.6.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E1.m1.6.6.1.1.3.2" xref="S2.E1.m1.6.6.1.1.3.2.cmml">ℒ</mi><mo id="S2.E1.m1.6.6.1.1.3.1" xref="S2.E1.m1.6.6.1.1.3.1.cmml">⁢</mo><mrow id="S2.E1.m1.6.6.1.1.3.3.2" xref="S2.E1.m1.6.6.1.1.3.3.1.cmml"><mo id="S2.E1.m1.6.6.1.1.3.3.2.1" stretchy="false" xref="S2.E1.m1.6.6.1.1.3.3.1.cmml">(</mo><mi id="S2.E1.m1.1.1" xref="S2.E1.m1.1.1.cmml">𝐱</mi><mo id="S2.E1.m1.6.6.1.1.3.3.2.2" xref="S2.E1.m1.6.6.1.1.3.3.1.cmml">;</mo><mi id="S2.E1.m1.2.2" xref="S2.E1.m1.2.2.cmml">θ</mi><mo id="S2.E1.m1.6.6.1.1.3.3.2.3" stretchy="false" xref="S2.E1.m1.6.6.1.1.3.3.1.cmml">)</mo></mrow></mrow><mo id="S2.E1.m1.6.6.1.1.4" xref="S2.E1.m1.6.6.1.1.4.cmml">=</mo><mrow id="S2.E1.m1.6.6.1.1.5" xref="S2.E1.m1.6.6.1.1.5.cmml"><mo id="S2.E1.m1.6.6.1.1.5a" xref="S2.E1.m1.6.6.1.1.5.cmml">−</mo><mrow id="S2.E1.m1.6.6.1.1.5.2" xref="S2.E1.m1.6.6.1.1.5.2.cmml"><mi id="S2.E1.m1.6.6.1.1.5.2.2" xref="S2.E1.m1.6.6.1.1.5.2.2.cmml">p</mi><mo id="S2.E1.m1.6.6.1.1.5.2.1" xref="S2.E1.m1.6.6.1.1.5.2.1.cmml">⁢</mo><mrow id="S2.E1.m1.6.6.1.1.5.2.3.2" xref="S2.E1.m1.6.6.1.1.5.2.3.1.cmml"><mo id="S2.E1.m1.6.6.1.1.5.2.3.2.1" stretchy="false" xref="S2.E1.m1.6.6.1.1.5.2.3.1.cmml">(</mo><mi id="S2.E1.m1.3.3" xref="S2.E1.m1.3.3.cmml">𝐱</mi><mo id="S2.E1.m1.6.6.1.1.5.2.3.2.2" lspace="0.170em" rspace="0.337em" xref="S2.E1.m1.6.6.1.1.5.2.3.1.cmml">;</mo><mi id="S2.E1.m1.4.4" xref="S2.E1.m1.4.4.cmml">θ</mi><mo id="S2.E1.m1.6.6.1.1.5.2.3.2.3" stretchy="false" xref="S2.E1.m1.6.6.1.1.5.2.3.1.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E1.m1.6.6.1.1.6" xref="S2.E1.m1.6.6.1.1.6.cmml">=</mo><mrow id="S2.E1.m1.6.6.1.1.1" xref="S2.E1.m1.6.6.1.1.1.cmml"><mo id="S2.E1.m1.6.6.1.1.1a" xref="S2.E1.m1.6.6.1.1.1.cmml">−</mo><mrow id="S2.E1.m1.6.6.1.1.1.1" xref="S2.E1.m1.6.6.1.1.1.1.cmml"><munderover id="S2.E1.m1.6.6.1.1.1.1.2" xref="S2.E1.m1.6.6.1.1.1.1.2.cmml"><mo id="S2.E1.m1.6.6.1.1.1.1.2.2.2" movablelimits="false" xref="S2.E1.m1.6.6.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S2.E1.m1.6.6.1.1.1.1.2.2.3" xref="S2.E1.m1.6.6.1.1.1.1.2.2.3.cmml"><mi id="S2.E1.m1.6.6.1.1.1.1.2.2.3.2" xref="S2.E1.m1.6.6.1.1.1.1.2.2.3.2.cmml">s</mi><mo id="S2.E1.m1.6.6.1.1.1.1.2.2.3.1" xref="S2.E1.m1.6.6.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S2.E1.m1.6.6.1.1.1.1.2.2.3.3" xref="S2.E1.m1.6.6.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mrow id="S2.E1.m1.6.6.1.1.1.1.2.3" xref="S2.E1.m1.6.6.1.1.1.1.2.3.cmml"><mi id="S2.E1.m1.6.6.1.1.1.1.2.3.2" xref="S2.E1.m1.6.6.1.1.1.1.2.3.2.cmml">S</mi><mo id="S2.E1.m1.6.6.1.1.1.1.2.3.1" xref="S2.E1.m1.6.6.1.1.1.1.2.3.1.cmml">−</mo><mn id="S2.E1.m1.6.6.1.1.1.1.2.3.3" xref="S2.E1.m1.6.6.1.1.1.1.2.3.3.cmml">1</mn></mrow></munderover><mrow id="S2.E1.m1.6.6.1.1.1.1.1" xref="S2.E1.m1.6.6.1.1.1.1.1.cmml"><mrow id="S2.E1.m1.6.6.1.1.1.1.1.3" xref="S2.E1.m1.6.6.1.1.1.1.1.3.cmml"><mi id="S2.E1.m1.6.6.1.1.1.1.1.3.1" xref="S2.E1.m1.6.6.1.1.1.1.1.3.1.cmml">log</mi><mo id="S2.E1.m1.6.6.1.1.1.1.1.3a" lspace="0.167em" xref="S2.E1.m1.6.6.1.1.1.1.1.3.cmml">⁡</mo><mi id="S2.E1.m1.6.6.1.1.1.1.1.3.2" xref="S2.E1.m1.6.6.1.1.1.1.1.3.2.cmml">p</mi></mrow><mo id="S2.E1.m1.6.6.1.1.1.1.1.2" xref="S2.E1.m1.6.6.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E1.m1.6.6.1.1.1.1.1.1.1" xref="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.cmml"><mo id="S2.E1.m1.6.6.1.1.1.1.1.1.1.2" stretchy="false" xref="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E1.m1.6.6.1.1.1.1.1.1.1.1" xref="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.cmml"><msub id="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.3" xref="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.3.cmml"><mi id="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.3.2" xref="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.3.2.cmml">x</mi><mrow id="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.3.3" xref="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.3.3.2" xref="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.3.3.2.cmml">s</mi><mo id="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.3.3.1" xref="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.3.3.1.cmml">+</mo><mn id="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.3.3.3" xref="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.3.3.3.cmml">1</mn></mrow></msub><mo id="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.2" xref="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.2.cmml">∣</mo><mrow id="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.1.1" xref="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.1.2.cmml"><msub id="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.2.cmml">𝐱</mi><mrow id="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mn id="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">1</mn><mo id="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml">:</mo><mi id="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">s</mi></mrow></msub><mo id="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.1.1.2" rspace="0.337em" xref="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.1.2.cmml">;</mo><mi id="S2.E1.m1.5.5" xref="S2.E1.m1.5.5.cmml">θ</mi></mrow></mrow><mo id="S2.E1.m1.6.6.1.1.1.1.1.1.1.3" stretchy="false" xref="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="S2.E1.m1.6.6.1.2" lspace="0.170em" xref="S2.E1.m1.6.6.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E1.m1.6b"><apply id="S2.E1.m1.6.6.1.1.cmml" xref="S2.E1.m1.6.6.1"><and id="S2.E1.m1.6.6.1.1a.cmml" xref="S2.E1.m1.6.6.1"></and><apply id="S2.E1.m1.6.6.1.1b.cmml" xref="S2.E1.m1.6.6.1"><eq id="S2.E1.m1.6.6.1.1.4.cmml" xref="S2.E1.m1.6.6.1.1.4"></eq><apply id="S2.E1.m1.6.6.1.1.3.cmml" xref="S2.E1.m1.6.6.1.1.3"><times id="S2.E1.m1.6.6.1.1.3.1.cmml" xref="S2.E1.m1.6.6.1.1.3.1"></times><ci id="S2.E1.m1.6.6.1.1.3.2.cmml" xref="S2.E1.m1.6.6.1.1.3.2">ℒ</ci><list id="S2.E1.m1.6.6.1.1.3.3.1.cmml" xref="S2.E1.m1.6.6.1.1.3.3.2"><ci id="S2.E1.m1.1.1.cmml" xref="S2.E1.m1.1.1">𝐱</ci><ci id="S2.E1.m1.2.2.cmml" xref="S2.E1.m1.2.2">𝜃</ci></list></apply><apply id="S2.E1.m1.6.6.1.1.5.cmml" xref="S2.E1.m1.6.6.1.1.5"><minus id="S2.E1.m1.6.6.1.1.5.1.cmml" xref="S2.E1.m1.6.6.1.1.5"></minus><apply id="S2.E1.m1.6.6.1.1.5.2.cmml" xref="S2.E1.m1.6.6.1.1.5.2"><times id="S2.E1.m1.6.6.1.1.5.2.1.cmml" xref="S2.E1.m1.6.6.1.1.5.2.1"></times><ci id="S2.E1.m1.6.6.1.1.5.2.2.cmml" xref="S2.E1.m1.6.6.1.1.5.2.2">𝑝</ci><list id="S2.E1.m1.6.6.1.1.5.2.3.1.cmml" xref="S2.E1.m1.6.6.1.1.5.2.3.2"><ci id="S2.E1.m1.3.3.cmml" xref="S2.E1.m1.3.3">𝐱</ci><ci id="S2.E1.m1.4.4.cmml" xref="S2.E1.m1.4.4">𝜃</ci></list></apply></apply></apply><apply id="S2.E1.m1.6.6.1.1c.cmml" xref="S2.E1.m1.6.6.1"><eq id="S2.E1.m1.6.6.1.1.6.cmml" xref="S2.E1.m1.6.6.1.1.6"></eq><share href="https://arxiv.org/html/2410.03529v1#S2.E1.m1.6.6.1.1.5.cmml" id="S2.E1.m1.6.6.1.1d.cmml" xref="S2.E1.m1.6.6.1"></share><apply id="S2.E1.m1.6.6.1.1.1.cmml" xref="S2.E1.m1.6.6.1.1.1"><minus id="S2.E1.m1.6.6.1.1.1.2.cmml" xref="S2.E1.m1.6.6.1.1.1"></minus><apply id="S2.E1.m1.6.6.1.1.1.1.cmml" xref="S2.E1.m1.6.6.1.1.1.1"><apply id="S2.E1.m1.6.6.1.1.1.1.2.cmml" xref="S2.E1.m1.6.6.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E1.m1.6.6.1.1.1.1.2.1.cmml" xref="S2.E1.m1.6.6.1.1.1.1.2">superscript</csymbol><apply id="S2.E1.m1.6.6.1.1.1.1.2.2.cmml" xref="S2.E1.m1.6.6.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E1.m1.6.6.1.1.1.1.2.2.1.cmml" xref="S2.E1.m1.6.6.1.1.1.1.2">subscript</csymbol><sum id="S2.E1.m1.6.6.1.1.1.1.2.2.2.cmml" xref="S2.E1.m1.6.6.1.1.1.1.2.2.2"></sum><apply id="S2.E1.m1.6.6.1.1.1.1.2.2.3.cmml" xref="S2.E1.m1.6.6.1.1.1.1.2.2.3"><eq id="S2.E1.m1.6.6.1.1.1.1.2.2.3.1.cmml" xref="S2.E1.m1.6.6.1.1.1.1.2.2.3.1"></eq><ci id="S2.E1.m1.6.6.1.1.1.1.2.2.3.2.cmml" xref="S2.E1.m1.6.6.1.1.1.1.2.2.3.2">𝑠</ci><cn id="S2.E1.m1.6.6.1.1.1.1.2.2.3.3.cmml" type="integer" xref="S2.E1.m1.6.6.1.1.1.1.2.2.3.3">1</cn></apply></apply><apply id="S2.E1.m1.6.6.1.1.1.1.2.3.cmml" xref="S2.E1.m1.6.6.1.1.1.1.2.3"><minus id="S2.E1.m1.6.6.1.1.1.1.2.3.1.cmml" xref="S2.E1.m1.6.6.1.1.1.1.2.3.1"></minus><ci id="S2.E1.m1.6.6.1.1.1.1.2.3.2.cmml" xref="S2.E1.m1.6.6.1.1.1.1.2.3.2">𝑆</ci><cn id="S2.E1.m1.6.6.1.1.1.1.2.3.3.cmml" type="integer" xref="S2.E1.m1.6.6.1.1.1.1.2.3.3">1</cn></apply></apply><apply id="S2.E1.m1.6.6.1.1.1.1.1.cmml" xref="S2.E1.m1.6.6.1.1.1.1.1"><times id="S2.E1.m1.6.6.1.1.1.1.1.2.cmml" xref="S2.E1.m1.6.6.1.1.1.1.1.2"></times><apply id="S2.E1.m1.6.6.1.1.1.1.1.3.cmml" xref="S2.E1.m1.6.6.1.1.1.1.1.3"><log id="S2.E1.m1.6.6.1.1.1.1.1.3.1.cmml" xref="S2.E1.m1.6.6.1.1.1.1.1.3.1"></log><ci id="S2.E1.m1.6.6.1.1.1.1.1.3.2.cmml" xref="S2.E1.m1.6.6.1.1.1.1.1.3.2">𝑝</ci></apply><apply id="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.6.6.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.2">conditional</csymbol><apply id="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.3.2">𝑥</ci><apply id="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.3.3.cmml" xref="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.3.3"><plus id="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.3.3.1"></plus><ci id="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.3.3.2">𝑠</ci><cn id="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.3.3.3.cmml" type="integer" xref="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.3.3.3">1</cn></apply></apply><list id="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.1.1"><apply id="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.2">𝐱</ci><apply id="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.3"><ci id="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.3.1">:</ci><cn id="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" type="integer" xref="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.3.2">1</cn><ci id="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.3.3">𝑠</ci></apply></apply><ci id="S2.E1.m1.5.5.cmml" xref="S2.E1.m1.5.5">𝜃</ci></list></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1.m1.6c">\mathcal{L}(\mathbf{x};\theta)=-\,p(\mathbf{x}\,;\,\theta)=-\sum_{s=1}^{S-1}%
\log p(x_{s+1}\mid\mathbf{x}_{1:s}\,;\,\theta)\,.</annotation><annotation encoding="application/x-llamapun" id="S2.E1.m1.6d">caligraphic_L ( bold_x ; italic_θ ) = - italic_p ( bold_x ; italic_θ ) = - ∑ start_POSTSUBSCRIPT italic_s = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_S - 1 end_POSTSUPERSCRIPT roman_log italic_p ( italic_x start_POSTSUBSCRIPT italic_s + 1 end_POSTSUBSCRIPT ∣ bold_x start_POSTSUBSCRIPT 1 : italic_s end_POSTSUBSCRIPT ; italic_θ ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
</div>
</section>
<section class="ltx_paragraph" id="S2.SS1.SSS0.Px2">
<h5 class="ltx_title ltx_title_paragraph">Mixture of Experts</h5><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S2.SS1.SSS0.Px2.p1">
<p class="ltx_p" id="S2.SS1.SSS0.Px2.p1.1">There exist many variants of the mixture of experts model <cite class="ltx_cite ltx_citemacro_citep">(Jacobs et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#bib.bib24" title="">1991</a>; Jordan &amp; Jacobs, <a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#bib.bib26" title="">1994</a>; Tresp, <a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#bib.bib51" title="">2000</a>; Collobert et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#bib.bib7" title="">2001</a>; Shahbaba &amp; Neal, <a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#bib.bib45" title="">2009</a>)</cite>. Following the original formulation and applying it to language modeling, we factorize the conditional distribution for predicting a given token by summing over a set of <math alttext="E" class="ltx_Math" display="inline" id="S2.SS1.SSS0.Px2.p1.1.m1.1"><semantics id="S2.SS1.SSS0.Px2.p1.1.m1.1a"><mi id="S2.SS1.SSS0.Px2.p1.1.m1.1.1" xref="S2.SS1.SSS0.Px2.p1.1.m1.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS0.Px2.p1.1.m1.1b"><ci id="S2.SS1.SSS0.Px2.p1.1.m1.1.1.cmml" xref="S2.SS1.SSS0.Px2.p1.1.m1.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS0.Px2.p1.1.m1.1c">E</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS0.Px2.p1.1.m1.1d">italic_E</annotation></semantics></math> experts:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS1.SSS0.Px2.p2">
<table class="ltx_equation ltx_eqn_table" id="S2.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}(\mathbf{x};\theta)=-\sum_{s=1}^{S-1}\log\sum_{e=1}^{E}p(x_{s+1}%
\mid\mathbf{x}_{1:s},e\,;\,\theta^{e})\,p(e\mid\mathbf{x}_{1:s}\,;\,\theta^{r})," class="ltx_Math" display="block" id="S2.E2.m1.4"><semantics id="S2.E2.m1.4a"><mrow id="S2.E2.m1.4.4.1" xref="S2.E2.m1.4.4.1.1.cmml"><mrow id="S2.E2.m1.4.4.1.1" xref="S2.E2.m1.4.4.1.1.cmml"><mrow id="S2.E2.m1.4.4.1.1.4" xref="S2.E2.m1.4.4.1.1.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E2.m1.4.4.1.1.4.2" xref="S2.E2.m1.4.4.1.1.4.2.cmml">ℒ</mi><mo id="S2.E2.m1.4.4.1.1.4.1" xref="S2.E2.m1.4.4.1.1.4.1.cmml">⁢</mo><mrow id="S2.E2.m1.4.4.1.1.4.3.2" xref="S2.E2.m1.4.4.1.1.4.3.1.cmml"><mo id="S2.E2.m1.4.4.1.1.4.3.2.1" stretchy="false" xref="S2.E2.m1.4.4.1.1.4.3.1.cmml">(</mo><mi id="S2.E2.m1.1.1" xref="S2.E2.m1.1.1.cmml">𝐱</mi><mo id="S2.E2.m1.4.4.1.1.4.3.2.2" xref="S2.E2.m1.4.4.1.1.4.3.1.cmml">;</mo><mi id="S2.E2.m1.2.2" xref="S2.E2.m1.2.2.cmml">θ</mi><mo id="S2.E2.m1.4.4.1.1.4.3.2.3" stretchy="false" xref="S2.E2.m1.4.4.1.1.4.3.1.cmml">)</mo></mrow></mrow><mo id="S2.E2.m1.4.4.1.1.3" xref="S2.E2.m1.4.4.1.1.3.cmml">=</mo><mrow id="S2.E2.m1.4.4.1.1.2" xref="S2.E2.m1.4.4.1.1.2.cmml"><mo id="S2.E2.m1.4.4.1.1.2a" xref="S2.E2.m1.4.4.1.1.2.cmml">−</mo><mrow id="S2.E2.m1.4.4.1.1.2.2" xref="S2.E2.m1.4.4.1.1.2.2.cmml"><munderover id="S2.E2.m1.4.4.1.1.2.2.3" xref="S2.E2.m1.4.4.1.1.2.2.3.cmml"><mo id="S2.E2.m1.4.4.1.1.2.2.3.2.2" movablelimits="false" xref="S2.E2.m1.4.4.1.1.2.2.3.2.2.cmml">∑</mo><mrow id="S2.E2.m1.4.4.1.1.2.2.3.2.3" xref="S2.E2.m1.4.4.1.1.2.2.3.2.3.cmml"><mi id="S2.E2.m1.4.4.1.1.2.2.3.2.3.2" xref="S2.E2.m1.4.4.1.1.2.2.3.2.3.2.cmml">s</mi><mo id="S2.E2.m1.4.4.1.1.2.2.3.2.3.1" xref="S2.E2.m1.4.4.1.1.2.2.3.2.3.1.cmml">=</mo><mn id="S2.E2.m1.4.4.1.1.2.2.3.2.3.3" xref="S2.E2.m1.4.4.1.1.2.2.3.2.3.3.cmml">1</mn></mrow><mrow id="S2.E2.m1.4.4.1.1.2.2.3.3" xref="S2.E2.m1.4.4.1.1.2.2.3.3.cmml"><mi id="S2.E2.m1.4.4.1.1.2.2.3.3.2" xref="S2.E2.m1.4.4.1.1.2.2.3.3.2.cmml">S</mi><mo id="S2.E2.m1.4.4.1.1.2.2.3.3.1" xref="S2.E2.m1.4.4.1.1.2.2.3.3.1.cmml">−</mo><mn id="S2.E2.m1.4.4.1.1.2.2.3.3.3" xref="S2.E2.m1.4.4.1.1.2.2.3.3.3.cmml">1</mn></mrow></munderover><mrow id="S2.E2.m1.4.4.1.1.2.2.2" xref="S2.E2.m1.4.4.1.1.2.2.2.cmml"><mi id="S2.E2.m1.4.4.1.1.2.2.2.4" xref="S2.E2.m1.4.4.1.1.2.2.2.4.cmml">log</mi><mo id="S2.E2.m1.4.4.1.1.2.2.2.3" xref="S2.E2.m1.4.4.1.1.2.2.2.3.cmml">⁢</mo><mrow id="S2.E2.m1.4.4.1.1.2.2.2.2" xref="S2.E2.m1.4.4.1.1.2.2.2.2.cmml"><munderover id="S2.E2.m1.4.4.1.1.2.2.2.2.3" xref="S2.E2.m1.4.4.1.1.2.2.2.2.3.cmml"><mo id="S2.E2.m1.4.4.1.1.2.2.2.2.3.2.2" movablelimits="false" xref="S2.E2.m1.4.4.1.1.2.2.2.2.3.2.2.cmml">∑</mo><mrow id="S2.E2.m1.4.4.1.1.2.2.2.2.3.2.3" xref="S2.E2.m1.4.4.1.1.2.2.2.2.3.2.3.cmml"><mi id="S2.E2.m1.4.4.1.1.2.2.2.2.3.2.3.2" xref="S2.E2.m1.4.4.1.1.2.2.2.2.3.2.3.2.cmml">e</mi><mo id="S2.E2.m1.4.4.1.1.2.2.2.2.3.2.3.1" xref="S2.E2.m1.4.4.1.1.2.2.2.2.3.2.3.1.cmml">=</mo><mn id="S2.E2.m1.4.4.1.1.2.2.2.2.3.2.3.3" xref="S2.E2.m1.4.4.1.1.2.2.2.2.3.2.3.3.cmml">1</mn></mrow><mi id="S2.E2.m1.4.4.1.1.2.2.2.2.3.3" xref="S2.E2.m1.4.4.1.1.2.2.2.2.3.3.cmml">E</mi></munderover><mrow id="S2.E2.m1.4.4.1.1.2.2.2.2.2" xref="S2.E2.m1.4.4.1.1.2.2.2.2.2.cmml"><mi id="S2.E2.m1.4.4.1.1.2.2.2.2.2.4" xref="S2.E2.m1.4.4.1.1.2.2.2.2.2.4.cmml">p</mi><mo id="S2.E2.m1.4.4.1.1.2.2.2.2.2.3" xref="S2.E2.m1.4.4.1.1.2.2.2.2.2.3.cmml">⁢</mo><mrow id="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.4" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.4.cmml"><mi id="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.4.2" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.4.2.cmml">x</mi><mrow id="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.4.3" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.4.3.cmml"><mi id="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.4.3.2" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.4.3.2.cmml">s</mi><mo id="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.4.3.1" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.4.3.1.cmml">+</mo><mn id="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.4.3.3" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.4.3.3.cmml">1</mn></mrow></msub><mo id="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.cmml">∣</mo><mrow id="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.2" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.3.cmml"><msub id="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">𝐱</mi><mrow id="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mn id="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">1</mn><mo id="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml">:</mo><mi id="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">s</mi></mrow></msub><mo id="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.2.3" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.3.cmml">,</mo><mi id="S2.E2.m1.3.3" xref="S2.E2.m1.3.3.cmml">e</mi><mo id="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.2.4" lspace="0.170em" rspace="0.337em" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.3.cmml">;</mo><msup id="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.2.2" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml"><mi id="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.2.2.2" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.2.2.2.cmml">θ</mi><mi id="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.2.2.3" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.2.2.3.cmml">e</mi></msup></mrow></mrow><mo id="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S2.E2.m1.4.4.1.1.2.2.2.2.2.3a" lspace="0.170em" xref="S2.E2.m1.4.4.1.1.2.2.2.2.2.3.cmml">⁢</mo><mi id="S2.E2.m1.4.4.1.1.2.2.2.2.2.5" xref="S2.E2.m1.4.4.1.1.2.2.2.2.2.5.cmml">p</mi><mo id="S2.E2.m1.4.4.1.1.2.2.2.2.2.3b" xref="S2.E2.m1.4.4.1.1.2.2.2.2.2.3.cmml">⁢</mo><mrow id="S2.E2.m1.4.4.1.1.2.2.2.2.2.2.1" xref="S2.E2.m1.4.4.1.1.2.2.2.2.2.2.1.1.cmml"><mo id="S2.E2.m1.4.4.1.1.2.2.2.2.2.2.1.2" stretchy="false" xref="S2.E2.m1.4.4.1.1.2.2.2.2.2.2.1.1.cmml">(</mo><mrow id="S2.E2.m1.4.4.1.1.2.2.2.2.2.2.1.1" xref="S2.E2.m1.4.4.1.1.2.2.2.2.2.2.1.1.cmml"><mi id="S2.E2.m1.4.4.1.1.2.2.2.2.2.2.1.1.4" xref="S2.E2.m1.4.4.1.1.2.2.2.2.2.2.1.1.4.cmml">e</mi><mo id="S2.E2.m1.4.4.1.1.2.2.2.2.2.2.1.1.3" xref="S2.E2.m1.4.4.1.1.2.2.2.2.2.2.1.1.3.cmml">∣</mo><mrow id="S2.E2.m1.4.4.1.1.2.2.2.2.2.2.1.1.2.2" xref="S2.E2.m1.4.4.1.1.2.2.2.2.2.2.1.1.2.3.cmml"><msub id="S2.E2.m1.4.4.1.1.2.2.2.2.2.2.1.1.1.1.1" xref="S2.E2.m1.4.4.1.1.2.2.2.2.2.2.1.1.1.1.1.cmml"><mi id="S2.E2.m1.4.4.1.1.2.2.2.2.2.2.1.1.1.1.1.2" xref="S2.E2.m1.4.4.1.1.2.2.2.2.2.2.1.1.1.1.1.2.cmml">𝐱</mi><mrow id="S2.E2.m1.4.4.1.1.2.2.2.2.2.2.1.1.1.1.1.3" xref="S2.E2.m1.4.4.1.1.2.2.2.2.2.2.1.1.1.1.1.3.cmml"><mn id="S2.E2.m1.4.4.1.1.2.2.2.2.2.2.1.1.1.1.1.3.2" xref="S2.E2.m1.4.4.1.1.2.2.2.2.2.2.1.1.1.1.1.3.2.cmml">1</mn><mo id="S2.E2.m1.4.4.1.1.2.2.2.2.2.2.1.1.1.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="S2.E2.m1.4.4.1.1.2.2.2.2.2.2.1.1.1.1.1.3.1.cmml">:</mo><mi id="S2.E2.m1.4.4.1.1.2.2.2.2.2.2.1.1.1.1.1.3.3" xref="S2.E2.m1.4.4.1.1.2.2.2.2.2.2.1.1.1.1.1.3.3.cmml">s</mi></mrow></msub><mo id="S2.E2.m1.4.4.1.1.2.2.2.2.2.2.1.1.2.2.3" rspace="0.337em" xref="S2.E2.m1.4.4.1.1.2.2.2.2.2.2.1.1.2.3.cmml">;</mo><msup id="S2.E2.m1.4.4.1.1.2.2.2.2.2.2.1.1.2.2.2" xref="S2.E2.m1.4.4.1.1.2.2.2.2.2.2.1.1.2.2.2.cmml"><mi id="S2.E2.m1.4.4.1.1.2.2.2.2.2.2.1.1.2.2.2.2" xref="S2.E2.m1.4.4.1.1.2.2.2.2.2.2.1.1.2.2.2.2.cmml">θ</mi><mi id="S2.E2.m1.4.4.1.1.2.2.2.2.2.2.1.1.2.2.2.3" xref="S2.E2.m1.4.4.1.1.2.2.2.2.2.2.1.1.2.2.2.3.cmml">r</mi></msup></mrow></mrow><mo id="S2.E2.m1.4.4.1.1.2.2.2.2.2.2.1.3" stretchy="false" xref="S2.E2.m1.4.4.1.1.2.2.2.2.2.2.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mrow></mrow><mo id="S2.E2.m1.4.4.1.2" xref="S2.E2.m1.4.4.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E2.m1.4b"><apply id="S2.E2.m1.4.4.1.1.cmml" xref="S2.E2.m1.4.4.1"><eq id="S2.E2.m1.4.4.1.1.3.cmml" xref="S2.E2.m1.4.4.1.1.3"></eq><apply id="S2.E2.m1.4.4.1.1.4.cmml" xref="S2.E2.m1.4.4.1.1.4"><times id="S2.E2.m1.4.4.1.1.4.1.cmml" xref="S2.E2.m1.4.4.1.1.4.1"></times><ci id="S2.E2.m1.4.4.1.1.4.2.cmml" xref="S2.E2.m1.4.4.1.1.4.2">ℒ</ci><list id="S2.E2.m1.4.4.1.1.4.3.1.cmml" xref="S2.E2.m1.4.4.1.1.4.3.2"><ci id="S2.E2.m1.1.1.cmml" xref="S2.E2.m1.1.1">𝐱</ci><ci id="S2.E2.m1.2.2.cmml" xref="S2.E2.m1.2.2">𝜃</ci></list></apply><apply id="S2.E2.m1.4.4.1.1.2.cmml" xref="S2.E2.m1.4.4.1.1.2"><minus id="S2.E2.m1.4.4.1.1.2.3.cmml" xref="S2.E2.m1.4.4.1.1.2"></minus><apply id="S2.E2.m1.4.4.1.1.2.2.cmml" xref="S2.E2.m1.4.4.1.1.2.2"><apply id="S2.E2.m1.4.4.1.1.2.2.3.cmml" xref="S2.E2.m1.4.4.1.1.2.2.3"><csymbol cd="ambiguous" id="S2.E2.m1.4.4.1.1.2.2.3.1.cmml" xref="S2.E2.m1.4.4.1.1.2.2.3">superscript</csymbol><apply id="S2.E2.m1.4.4.1.1.2.2.3.2.cmml" xref="S2.E2.m1.4.4.1.1.2.2.3"><csymbol cd="ambiguous" id="S2.E2.m1.4.4.1.1.2.2.3.2.1.cmml" xref="S2.E2.m1.4.4.1.1.2.2.3">subscript</csymbol><sum id="S2.E2.m1.4.4.1.1.2.2.3.2.2.cmml" xref="S2.E2.m1.4.4.1.1.2.2.3.2.2"></sum><apply id="S2.E2.m1.4.4.1.1.2.2.3.2.3.cmml" xref="S2.E2.m1.4.4.1.1.2.2.3.2.3"><eq id="S2.E2.m1.4.4.1.1.2.2.3.2.3.1.cmml" xref="S2.E2.m1.4.4.1.1.2.2.3.2.3.1"></eq><ci id="S2.E2.m1.4.4.1.1.2.2.3.2.3.2.cmml" xref="S2.E2.m1.4.4.1.1.2.2.3.2.3.2">𝑠</ci><cn id="S2.E2.m1.4.4.1.1.2.2.3.2.3.3.cmml" type="integer" xref="S2.E2.m1.4.4.1.1.2.2.3.2.3.3">1</cn></apply></apply><apply id="S2.E2.m1.4.4.1.1.2.2.3.3.cmml" xref="S2.E2.m1.4.4.1.1.2.2.3.3"><minus id="S2.E2.m1.4.4.1.1.2.2.3.3.1.cmml" xref="S2.E2.m1.4.4.1.1.2.2.3.3.1"></minus><ci id="S2.E2.m1.4.4.1.1.2.2.3.3.2.cmml" xref="S2.E2.m1.4.4.1.1.2.2.3.3.2">𝑆</ci><cn id="S2.E2.m1.4.4.1.1.2.2.3.3.3.cmml" type="integer" xref="S2.E2.m1.4.4.1.1.2.2.3.3.3">1</cn></apply></apply><apply id="S2.E2.m1.4.4.1.1.2.2.2.cmml" xref="S2.E2.m1.4.4.1.1.2.2.2"><times id="S2.E2.m1.4.4.1.1.2.2.2.3.cmml" xref="S2.E2.m1.4.4.1.1.2.2.2.3"></times><log id="S2.E2.m1.4.4.1.1.2.2.2.4.cmml" xref="S2.E2.m1.4.4.1.1.2.2.2.4"></log><apply id="S2.E2.m1.4.4.1.1.2.2.2.2.cmml" xref="S2.E2.m1.4.4.1.1.2.2.2.2"><apply id="S2.E2.m1.4.4.1.1.2.2.2.2.3.cmml" xref="S2.E2.m1.4.4.1.1.2.2.2.2.3"><csymbol cd="ambiguous" id="S2.E2.m1.4.4.1.1.2.2.2.2.3.1.cmml" xref="S2.E2.m1.4.4.1.1.2.2.2.2.3">superscript</csymbol><apply id="S2.E2.m1.4.4.1.1.2.2.2.2.3.2.cmml" xref="S2.E2.m1.4.4.1.1.2.2.2.2.3"><csymbol cd="ambiguous" id="S2.E2.m1.4.4.1.1.2.2.2.2.3.2.1.cmml" xref="S2.E2.m1.4.4.1.1.2.2.2.2.3">subscript</csymbol><sum id="S2.E2.m1.4.4.1.1.2.2.2.2.3.2.2.cmml" xref="S2.E2.m1.4.4.1.1.2.2.2.2.3.2.2"></sum><apply id="S2.E2.m1.4.4.1.1.2.2.2.2.3.2.3.cmml" xref="S2.E2.m1.4.4.1.1.2.2.2.2.3.2.3"><eq id="S2.E2.m1.4.4.1.1.2.2.2.2.3.2.3.1.cmml" xref="S2.E2.m1.4.4.1.1.2.2.2.2.3.2.3.1"></eq><ci id="S2.E2.m1.4.4.1.1.2.2.2.2.3.2.3.2.cmml" xref="S2.E2.m1.4.4.1.1.2.2.2.2.3.2.3.2">𝑒</ci><cn id="S2.E2.m1.4.4.1.1.2.2.2.2.3.2.3.3.cmml" type="integer" xref="S2.E2.m1.4.4.1.1.2.2.2.2.3.2.3.3">1</cn></apply></apply><ci id="S2.E2.m1.4.4.1.1.2.2.2.2.3.3.cmml" xref="S2.E2.m1.4.4.1.1.2.2.2.2.3.3">𝐸</ci></apply><apply id="S2.E2.m1.4.4.1.1.2.2.2.2.2.cmml" xref="S2.E2.m1.4.4.1.1.2.2.2.2.2"><times id="S2.E2.m1.4.4.1.1.2.2.2.2.2.3.cmml" xref="S2.E2.m1.4.4.1.1.2.2.2.2.2.3"></times><ci id="S2.E2.m1.4.4.1.1.2.2.2.2.2.4.cmml" xref="S2.E2.m1.4.4.1.1.2.2.2.2.2.4">𝑝</ci><apply id="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.3">conditional</csymbol><apply id="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.4.cmml" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.4.1.cmml" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.4">subscript</csymbol><ci id="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.4.2.cmml" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.4.2">𝑥</ci><apply id="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.4.3.cmml" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.4.3"><plus id="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.4.3.1.cmml" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.4.3.1"></plus><ci id="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.4.3.2.cmml" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.4.3.2">𝑠</ci><cn id="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.4.3.3.cmml" type="integer" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.4.3.3">1</cn></apply></apply><list id="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.2"><apply id="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.2">𝐱</ci><apply id="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.3"><ci id="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1">:</ci><cn id="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" type="integer" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2">1</cn><ci id="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3">𝑠</ci></apply></apply><ci id="S2.E2.m1.3.3.cmml" xref="S2.E2.m1.3.3">𝑒</ci><apply id="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.2.2">superscript</csymbol><ci id="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.2.2.2">𝜃</ci><ci id="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.2.2.3.cmml" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.2.2.3">𝑒</ci></apply></list></apply><ci id="S2.E2.m1.4.4.1.1.2.2.2.2.2.5.cmml" xref="S2.E2.m1.4.4.1.1.2.2.2.2.2.5">𝑝</ci><apply id="S2.E2.m1.4.4.1.1.2.2.2.2.2.2.1.1.cmml" xref="S2.E2.m1.4.4.1.1.2.2.2.2.2.2.1"><csymbol cd="latexml" id="S2.E2.m1.4.4.1.1.2.2.2.2.2.2.1.1.3.cmml" xref="S2.E2.m1.4.4.1.1.2.2.2.2.2.2.1.1.3">conditional</csymbol><ci id="S2.E2.m1.4.4.1.1.2.2.2.2.2.2.1.1.4.cmml" xref="S2.E2.m1.4.4.1.1.2.2.2.2.2.2.1.1.4">𝑒</ci><list id="S2.E2.m1.4.4.1.1.2.2.2.2.2.2.1.1.2.3.cmml" xref="S2.E2.m1.4.4.1.1.2.2.2.2.2.2.1.1.2.2"><apply id="S2.E2.m1.4.4.1.1.2.2.2.2.2.2.1.1.1.1.1.cmml" xref="S2.E2.m1.4.4.1.1.2.2.2.2.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.4.4.1.1.2.2.2.2.2.2.1.1.1.1.1.1.cmml" xref="S2.E2.m1.4.4.1.1.2.2.2.2.2.2.1.1.1.1.1">subscript</csymbol><ci id="S2.E2.m1.4.4.1.1.2.2.2.2.2.2.1.1.1.1.1.2.cmml" xref="S2.E2.m1.4.4.1.1.2.2.2.2.2.2.1.1.1.1.1.2">𝐱</ci><apply id="S2.E2.m1.4.4.1.1.2.2.2.2.2.2.1.1.1.1.1.3.cmml" xref="S2.E2.m1.4.4.1.1.2.2.2.2.2.2.1.1.1.1.1.3"><ci id="S2.E2.m1.4.4.1.1.2.2.2.2.2.2.1.1.1.1.1.3.1.cmml" xref="S2.E2.m1.4.4.1.1.2.2.2.2.2.2.1.1.1.1.1.3.1">:</ci><cn id="S2.E2.m1.4.4.1.1.2.2.2.2.2.2.1.1.1.1.1.3.2.cmml" type="integer" xref="S2.E2.m1.4.4.1.1.2.2.2.2.2.2.1.1.1.1.1.3.2">1</cn><ci id="S2.E2.m1.4.4.1.1.2.2.2.2.2.2.1.1.1.1.1.3.3.cmml" xref="S2.E2.m1.4.4.1.1.2.2.2.2.2.2.1.1.1.1.1.3.3">𝑠</ci></apply></apply><apply id="S2.E2.m1.4.4.1.1.2.2.2.2.2.2.1.1.2.2.2.cmml" xref="S2.E2.m1.4.4.1.1.2.2.2.2.2.2.1.1.2.2.2"><csymbol cd="ambiguous" id="S2.E2.m1.4.4.1.1.2.2.2.2.2.2.1.1.2.2.2.1.cmml" xref="S2.E2.m1.4.4.1.1.2.2.2.2.2.2.1.1.2.2.2">superscript</csymbol><ci id="S2.E2.m1.4.4.1.1.2.2.2.2.2.2.1.1.2.2.2.2.cmml" xref="S2.E2.m1.4.4.1.1.2.2.2.2.2.2.1.1.2.2.2.2">𝜃</ci><ci id="S2.E2.m1.4.4.1.1.2.2.2.2.2.2.1.1.2.2.2.3.cmml" xref="S2.E2.m1.4.4.1.1.2.2.2.2.2.2.1.1.2.2.2.3">𝑟</ci></apply></list></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2.m1.4c">\mathcal{L}(\mathbf{x};\theta)=-\sum_{s=1}^{S-1}\log\sum_{e=1}^{E}p(x_{s+1}%
\mid\mathbf{x}_{1:s},e\,;\,\theta^{e})\,p(e\mid\mathbf{x}_{1:s}\,;\,\theta^{r}),</annotation><annotation encoding="application/x-llamapun" id="S2.E2.m1.4d">caligraphic_L ( bold_x ; italic_θ ) = - ∑ start_POSTSUBSCRIPT italic_s = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_S - 1 end_POSTSUPERSCRIPT roman_log ∑ start_POSTSUBSCRIPT italic_e = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_E end_POSTSUPERSCRIPT italic_p ( italic_x start_POSTSUBSCRIPT italic_s + 1 end_POSTSUBSCRIPT ∣ bold_x start_POSTSUBSCRIPT 1 : italic_s end_POSTSUBSCRIPT , italic_e ; italic_θ start_POSTSUPERSCRIPT italic_e end_POSTSUPERSCRIPT ) italic_p ( italic_e ∣ bold_x start_POSTSUBSCRIPT 1 : italic_s end_POSTSUBSCRIPT ; italic_θ start_POSTSUPERSCRIPT italic_r end_POSTSUPERSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS1.SSS0.Px2.p2.5">where each expert <math alttext="p(x_{s+1}\mid\mathbf{x}_{1:s},e\,;\,\theta^{e})" class="ltx_Math" display="inline" id="S2.SS1.SSS0.Px2.p2.1.m1.2"><semantics id="S2.SS1.SSS0.Px2.p2.1.m1.2a"><mrow id="S2.SS1.SSS0.Px2.p2.1.m1.2.2" xref="S2.SS1.SSS0.Px2.p2.1.m1.2.2.cmml"><mi id="S2.SS1.SSS0.Px2.p2.1.m1.2.2.3" xref="S2.SS1.SSS0.Px2.p2.1.m1.2.2.3.cmml">p</mi><mo id="S2.SS1.SSS0.Px2.p2.1.m1.2.2.2" xref="S2.SS1.SSS0.Px2.p2.1.m1.2.2.2.cmml">⁢</mo><mrow id="S2.SS1.SSS0.Px2.p2.1.m1.2.2.1.1" xref="S2.SS1.SSS0.Px2.p2.1.m1.2.2.1.1.1.cmml"><mo id="S2.SS1.SSS0.Px2.p2.1.m1.2.2.1.1.2" stretchy="false" xref="S2.SS1.SSS0.Px2.p2.1.m1.2.2.1.1.1.cmml">(</mo><mrow id="S2.SS1.SSS0.Px2.p2.1.m1.2.2.1.1.1" xref="S2.SS1.SSS0.Px2.p2.1.m1.2.2.1.1.1.cmml"><msub id="S2.SS1.SSS0.Px2.p2.1.m1.2.2.1.1.1.4" xref="S2.SS1.SSS0.Px2.p2.1.m1.2.2.1.1.1.4.cmml"><mi id="S2.SS1.SSS0.Px2.p2.1.m1.2.2.1.1.1.4.2" xref="S2.SS1.SSS0.Px2.p2.1.m1.2.2.1.1.1.4.2.cmml">x</mi><mrow id="S2.SS1.SSS0.Px2.p2.1.m1.2.2.1.1.1.4.3" xref="S2.SS1.SSS0.Px2.p2.1.m1.2.2.1.1.1.4.3.cmml"><mi id="S2.SS1.SSS0.Px2.p2.1.m1.2.2.1.1.1.4.3.2" xref="S2.SS1.SSS0.Px2.p2.1.m1.2.2.1.1.1.4.3.2.cmml">s</mi><mo id="S2.SS1.SSS0.Px2.p2.1.m1.2.2.1.1.1.4.3.1" xref="S2.SS1.SSS0.Px2.p2.1.m1.2.2.1.1.1.4.3.1.cmml">+</mo><mn id="S2.SS1.SSS0.Px2.p2.1.m1.2.2.1.1.1.4.3.3" xref="S2.SS1.SSS0.Px2.p2.1.m1.2.2.1.1.1.4.3.3.cmml">1</mn></mrow></msub><mo id="S2.SS1.SSS0.Px2.p2.1.m1.2.2.1.1.1.3" xref="S2.SS1.SSS0.Px2.p2.1.m1.2.2.1.1.1.3.cmml">∣</mo><mrow id="S2.SS1.SSS0.Px2.p2.1.m1.2.2.1.1.1.2.2" xref="S2.SS1.SSS0.Px2.p2.1.m1.2.2.1.1.1.2.3.cmml"><msub id="S2.SS1.SSS0.Px2.p2.1.m1.2.2.1.1.1.1.1.1" xref="S2.SS1.SSS0.Px2.p2.1.m1.2.2.1.1.1.1.1.1.cmml"><mi id="S2.SS1.SSS0.Px2.p2.1.m1.2.2.1.1.1.1.1.1.2" xref="S2.SS1.SSS0.Px2.p2.1.m1.2.2.1.1.1.1.1.1.2.cmml">𝐱</mi><mrow id="S2.SS1.SSS0.Px2.p2.1.m1.2.2.1.1.1.1.1.1.3" xref="S2.SS1.SSS0.Px2.p2.1.m1.2.2.1.1.1.1.1.1.3.cmml"><mn id="S2.SS1.SSS0.Px2.p2.1.m1.2.2.1.1.1.1.1.1.3.2" xref="S2.SS1.SSS0.Px2.p2.1.m1.2.2.1.1.1.1.1.1.3.2.cmml">1</mn><mo id="S2.SS1.SSS0.Px2.p2.1.m1.2.2.1.1.1.1.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="S2.SS1.SSS0.Px2.p2.1.m1.2.2.1.1.1.1.1.1.3.1.cmml">:</mo><mi id="S2.SS1.SSS0.Px2.p2.1.m1.2.2.1.1.1.1.1.1.3.3" xref="S2.SS1.SSS0.Px2.p2.1.m1.2.2.1.1.1.1.1.1.3.3.cmml">s</mi></mrow></msub><mo id="S2.SS1.SSS0.Px2.p2.1.m1.2.2.1.1.1.2.2.3" xref="S2.SS1.SSS0.Px2.p2.1.m1.2.2.1.1.1.2.3.cmml">,</mo><mi id="S2.SS1.SSS0.Px2.p2.1.m1.1.1" xref="S2.SS1.SSS0.Px2.p2.1.m1.1.1.cmml">e</mi><mo id="S2.SS1.SSS0.Px2.p2.1.m1.2.2.1.1.1.2.2.4" lspace="0.170em" rspace="0.337em" xref="S2.SS1.SSS0.Px2.p2.1.m1.2.2.1.1.1.2.3.cmml">;</mo><msup id="S2.SS1.SSS0.Px2.p2.1.m1.2.2.1.1.1.2.2.2" xref="S2.SS1.SSS0.Px2.p2.1.m1.2.2.1.1.1.2.2.2.cmml"><mi id="S2.SS1.SSS0.Px2.p2.1.m1.2.2.1.1.1.2.2.2.2" xref="S2.SS1.SSS0.Px2.p2.1.m1.2.2.1.1.1.2.2.2.2.cmml">θ</mi><mi id="S2.SS1.SSS0.Px2.p2.1.m1.2.2.1.1.1.2.2.2.3" xref="S2.SS1.SSS0.Px2.p2.1.m1.2.2.1.1.1.2.2.2.3.cmml">e</mi></msup></mrow></mrow><mo id="S2.SS1.SSS0.Px2.p2.1.m1.2.2.1.1.3" stretchy="false" xref="S2.SS1.SSS0.Px2.p2.1.m1.2.2.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS0.Px2.p2.1.m1.2b"><apply id="S2.SS1.SSS0.Px2.p2.1.m1.2.2.cmml" xref="S2.SS1.SSS0.Px2.p2.1.m1.2.2"><times id="S2.SS1.SSS0.Px2.p2.1.m1.2.2.2.cmml" xref="S2.SS1.SSS0.Px2.p2.1.m1.2.2.2"></times><ci id="S2.SS1.SSS0.Px2.p2.1.m1.2.2.3.cmml" xref="S2.SS1.SSS0.Px2.p2.1.m1.2.2.3">𝑝</ci><apply id="S2.SS1.SSS0.Px2.p2.1.m1.2.2.1.1.1.cmml" xref="S2.SS1.SSS0.Px2.p2.1.m1.2.2.1.1"><csymbol cd="latexml" id="S2.SS1.SSS0.Px2.p2.1.m1.2.2.1.1.1.3.cmml" xref="S2.SS1.SSS0.Px2.p2.1.m1.2.2.1.1.1.3">conditional</csymbol><apply id="S2.SS1.SSS0.Px2.p2.1.m1.2.2.1.1.1.4.cmml" xref="S2.SS1.SSS0.Px2.p2.1.m1.2.2.1.1.1.4"><csymbol cd="ambiguous" id="S2.SS1.SSS0.Px2.p2.1.m1.2.2.1.1.1.4.1.cmml" xref="S2.SS1.SSS0.Px2.p2.1.m1.2.2.1.1.1.4">subscript</csymbol><ci id="S2.SS1.SSS0.Px2.p2.1.m1.2.2.1.1.1.4.2.cmml" xref="S2.SS1.SSS0.Px2.p2.1.m1.2.2.1.1.1.4.2">𝑥</ci><apply id="S2.SS1.SSS0.Px2.p2.1.m1.2.2.1.1.1.4.3.cmml" xref="S2.SS1.SSS0.Px2.p2.1.m1.2.2.1.1.1.4.3"><plus id="S2.SS1.SSS0.Px2.p2.1.m1.2.2.1.1.1.4.3.1.cmml" xref="S2.SS1.SSS0.Px2.p2.1.m1.2.2.1.1.1.4.3.1"></plus><ci id="S2.SS1.SSS0.Px2.p2.1.m1.2.2.1.1.1.4.3.2.cmml" xref="S2.SS1.SSS0.Px2.p2.1.m1.2.2.1.1.1.4.3.2">𝑠</ci><cn id="S2.SS1.SSS0.Px2.p2.1.m1.2.2.1.1.1.4.3.3.cmml" type="integer" xref="S2.SS1.SSS0.Px2.p2.1.m1.2.2.1.1.1.4.3.3">1</cn></apply></apply><list id="S2.SS1.SSS0.Px2.p2.1.m1.2.2.1.1.1.2.3.cmml" xref="S2.SS1.SSS0.Px2.p2.1.m1.2.2.1.1.1.2.2"><apply id="S2.SS1.SSS0.Px2.p2.1.m1.2.2.1.1.1.1.1.1.cmml" xref="S2.SS1.SSS0.Px2.p2.1.m1.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.SSS0.Px2.p2.1.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S2.SS1.SSS0.Px2.p2.1.m1.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="S2.SS1.SSS0.Px2.p2.1.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S2.SS1.SSS0.Px2.p2.1.m1.2.2.1.1.1.1.1.1.2">𝐱</ci><apply id="S2.SS1.SSS0.Px2.p2.1.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S2.SS1.SSS0.Px2.p2.1.m1.2.2.1.1.1.1.1.1.3"><ci id="S2.SS1.SSS0.Px2.p2.1.m1.2.2.1.1.1.1.1.1.3.1.cmml" xref="S2.SS1.SSS0.Px2.p2.1.m1.2.2.1.1.1.1.1.1.3.1">:</ci><cn id="S2.SS1.SSS0.Px2.p2.1.m1.2.2.1.1.1.1.1.1.3.2.cmml" type="integer" xref="S2.SS1.SSS0.Px2.p2.1.m1.2.2.1.1.1.1.1.1.3.2">1</cn><ci id="S2.SS1.SSS0.Px2.p2.1.m1.2.2.1.1.1.1.1.1.3.3.cmml" xref="S2.SS1.SSS0.Px2.p2.1.m1.2.2.1.1.1.1.1.1.3.3">𝑠</ci></apply></apply><ci id="S2.SS1.SSS0.Px2.p2.1.m1.1.1.cmml" xref="S2.SS1.SSS0.Px2.p2.1.m1.1.1">𝑒</ci><apply id="S2.SS1.SSS0.Px2.p2.1.m1.2.2.1.1.1.2.2.2.cmml" xref="S2.SS1.SSS0.Px2.p2.1.m1.2.2.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S2.SS1.SSS0.Px2.p2.1.m1.2.2.1.1.1.2.2.2.1.cmml" xref="S2.SS1.SSS0.Px2.p2.1.m1.2.2.1.1.1.2.2.2">superscript</csymbol><ci id="S2.SS1.SSS0.Px2.p2.1.m1.2.2.1.1.1.2.2.2.2.cmml" xref="S2.SS1.SSS0.Px2.p2.1.m1.2.2.1.1.1.2.2.2.2">𝜃</ci><ci id="S2.SS1.SSS0.Px2.p2.1.m1.2.2.1.1.1.2.2.2.3.cmml" xref="S2.SS1.SSS0.Px2.p2.1.m1.2.2.1.1.1.2.2.2.3">𝑒</ci></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS0.Px2.p2.1.m1.2c">p(x_{s+1}\mid\mathbf{x}_{1:s},e\,;\,\theta^{e})</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS0.Px2.p2.1.m1.2d">italic_p ( italic_x start_POSTSUBSCRIPT italic_s + 1 end_POSTSUBSCRIPT ∣ bold_x start_POSTSUBSCRIPT 1 : italic_s end_POSTSUBSCRIPT , italic_e ; italic_θ start_POSTSUPERSCRIPT italic_e end_POSTSUPERSCRIPT )</annotation></semantics></math> is intended to focus on different parts of the data distribution, and the router <math alttext="p(e\mid\mathbf{x}_{1:s}\,;\,\theta^{r})" class="ltx_Math" display="inline" id="S2.SS1.SSS0.Px2.p2.2.m2.1"><semantics id="S2.SS1.SSS0.Px2.p2.2.m2.1a"><mrow id="S2.SS1.SSS0.Px2.p2.2.m2.1.1" xref="S2.SS1.SSS0.Px2.p2.2.m2.1.1.cmml"><mi id="S2.SS1.SSS0.Px2.p2.2.m2.1.1.3" xref="S2.SS1.SSS0.Px2.p2.2.m2.1.1.3.cmml">p</mi><mo id="S2.SS1.SSS0.Px2.p2.2.m2.1.1.2" xref="S2.SS1.SSS0.Px2.p2.2.m2.1.1.2.cmml">⁢</mo><mrow id="S2.SS1.SSS0.Px2.p2.2.m2.1.1.1.1" xref="S2.SS1.SSS0.Px2.p2.2.m2.1.1.1.1.1.cmml"><mo id="S2.SS1.SSS0.Px2.p2.2.m2.1.1.1.1.2" stretchy="false" xref="S2.SS1.SSS0.Px2.p2.2.m2.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS1.SSS0.Px2.p2.2.m2.1.1.1.1.1" xref="S2.SS1.SSS0.Px2.p2.2.m2.1.1.1.1.1.cmml"><mi id="S2.SS1.SSS0.Px2.p2.2.m2.1.1.1.1.1.4" xref="S2.SS1.SSS0.Px2.p2.2.m2.1.1.1.1.1.4.cmml">e</mi><mo id="S2.SS1.SSS0.Px2.p2.2.m2.1.1.1.1.1.3" xref="S2.SS1.SSS0.Px2.p2.2.m2.1.1.1.1.1.3.cmml">∣</mo><mrow id="S2.SS1.SSS0.Px2.p2.2.m2.1.1.1.1.1.2.2" xref="S2.SS1.SSS0.Px2.p2.2.m2.1.1.1.1.1.2.3.cmml"><msub id="S2.SS1.SSS0.Px2.p2.2.m2.1.1.1.1.1.1.1.1" xref="S2.SS1.SSS0.Px2.p2.2.m2.1.1.1.1.1.1.1.1.cmml"><mi id="S2.SS1.SSS0.Px2.p2.2.m2.1.1.1.1.1.1.1.1.2" xref="S2.SS1.SSS0.Px2.p2.2.m2.1.1.1.1.1.1.1.1.2.cmml">𝐱</mi><mrow id="S2.SS1.SSS0.Px2.p2.2.m2.1.1.1.1.1.1.1.1.3" xref="S2.SS1.SSS0.Px2.p2.2.m2.1.1.1.1.1.1.1.1.3.cmml"><mn id="S2.SS1.SSS0.Px2.p2.2.m2.1.1.1.1.1.1.1.1.3.2" xref="S2.SS1.SSS0.Px2.p2.2.m2.1.1.1.1.1.1.1.1.3.2.cmml">1</mn><mo id="S2.SS1.SSS0.Px2.p2.2.m2.1.1.1.1.1.1.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="S2.SS1.SSS0.Px2.p2.2.m2.1.1.1.1.1.1.1.1.3.1.cmml">:</mo><mi id="S2.SS1.SSS0.Px2.p2.2.m2.1.1.1.1.1.1.1.1.3.3" xref="S2.SS1.SSS0.Px2.p2.2.m2.1.1.1.1.1.1.1.1.3.3.cmml">s</mi></mrow></msub><mo id="S2.SS1.SSS0.Px2.p2.2.m2.1.1.1.1.1.2.2.3" rspace="0.337em" xref="S2.SS1.SSS0.Px2.p2.2.m2.1.1.1.1.1.2.3.cmml">;</mo><msup id="S2.SS1.SSS0.Px2.p2.2.m2.1.1.1.1.1.2.2.2" xref="S2.SS1.SSS0.Px2.p2.2.m2.1.1.1.1.1.2.2.2.cmml"><mi id="S2.SS1.SSS0.Px2.p2.2.m2.1.1.1.1.1.2.2.2.2" xref="S2.SS1.SSS0.Px2.p2.2.m2.1.1.1.1.1.2.2.2.2.cmml">θ</mi><mi id="S2.SS1.SSS0.Px2.p2.2.m2.1.1.1.1.1.2.2.2.3" xref="S2.SS1.SSS0.Px2.p2.2.m2.1.1.1.1.1.2.2.2.3.cmml">r</mi></msup></mrow></mrow><mo id="S2.SS1.SSS0.Px2.p2.2.m2.1.1.1.1.3" stretchy="false" xref="S2.SS1.SSS0.Px2.p2.2.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS0.Px2.p2.2.m2.1b"><apply id="S2.SS1.SSS0.Px2.p2.2.m2.1.1.cmml" xref="S2.SS1.SSS0.Px2.p2.2.m2.1.1"><times id="S2.SS1.SSS0.Px2.p2.2.m2.1.1.2.cmml" xref="S2.SS1.SSS0.Px2.p2.2.m2.1.1.2"></times><ci id="S2.SS1.SSS0.Px2.p2.2.m2.1.1.3.cmml" xref="S2.SS1.SSS0.Px2.p2.2.m2.1.1.3">𝑝</ci><apply id="S2.SS1.SSS0.Px2.p2.2.m2.1.1.1.1.1.cmml" xref="S2.SS1.SSS0.Px2.p2.2.m2.1.1.1.1"><csymbol cd="latexml" id="S2.SS1.SSS0.Px2.p2.2.m2.1.1.1.1.1.3.cmml" xref="S2.SS1.SSS0.Px2.p2.2.m2.1.1.1.1.1.3">conditional</csymbol><ci id="S2.SS1.SSS0.Px2.p2.2.m2.1.1.1.1.1.4.cmml" xref="S2.SS1.SSS0.Px2.p2.2.m2.1.1.1.1.1.4">𝑒</ci><list id="S2.SS1.SSS0.Px2.p2.2.m2.1.1.1.1.1.2.3.cmml" xref="S2.SS1.SSS0.Px2.p2.2.m2.1.1.1.1.1.2.2"><apply id="S2.SS1.SSS0.Px2.p2.2.m2.1.1.1.1.1.1.1.1.cmml" xref="S2.SS1.SSS0.Px2.p2.2.m2.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.SSS0.Px2.p2.2.m2.1.1.1.1.1.1.1.1.1.cmml" xref="S2.SS1.SSS0.Px2.p2.2.m2.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.SS1.SSS0.Px2.p2.2.m2.1.1.1.1.1.1.1.1.2.cmml" xref="S2.SS1.SSS0.Px2.p2.2.m2.1.1.1.1.1.1.1.1.2">𝐱</ci><apply id="S2.SS1.SSS0.Px2.p2.2.m2.1.1.1.1.1.1.1.1.3.cmml" xref="S2.SS1.SSS0.Px2.p2.2.m2.1.1.1.1.1.1.1.1.3"><ci id="S2.SS1.SSS0.Px2.p2.2.m2.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.SS1.SSS0.Px2.p2.2.m2.1.1.1.1.1.1.1.1.3.1">:</ci><cn id="S2.SS1.SSS0.Px2.p2.2.m2.1.1.1.1.1.1.1.1.3.2.cmml" type="integer" xref="S2.SS1.SSS0.Px2.p2.2.m2.1.1.1.1.1.1.1.1.3.2">1</cn><ci id="S2.SS1.SSS0.Px2.p2.2.m2.1.1.1.1.1.1.1.1.3.3.cmml" xref="S2.SS1.SSS0.Px2.p2.2.m2.1.1.1.1.1.1.1.1.3.3">𝑠</ci></apply></apply><apply id="S2.SS1.SSS0.Px2.p2.2.m2.1.1.1.1.1.2.2.2.cmml" xref="S2.SS1.SSS0.Px2.p2.2.m2.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S2.SS1.SSS0.Px2.p2.2.m2.1.1.1.1.1.2.2.2.1.cmml" xref="S2.SS1.SSS0.Px2.p2.2.m2.1.1.1.1.1.2.2.2">superscript</csymbol><ci id="S2.SS1.SSS0.Px2.p2.2.m2.1.1.1.1.1.2.2.2.2.cmml" xref="S2.SS1.SSS0.Px2.p2.2.m2.1.1.1.1.1.2.2.2.2">𝜃</ci><ci id="S2.SS1.SSS0.Px2.p2.2.m2.1.1.1.1.1.2.2.2.3.cmml" xref="S2.SS1.SSS0.Px2.p2.2.m2.1.1.1.1.1.2.2.2.3">𝑟</ci></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS0.Px2.p2.2.m2.1c">p(e\mid\mathbf{x}_{1:s}\,;\,\theta^{r})</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS0.Px2.p2.2.m2.1d">italic_p ( italic_e ∣ bold_x start_POSTSUBSCRIPT 1 : italic_s end_POSTSUBSCRIPT ; italic_θ start_POSTSUPERSCRIPT italic_r end_POSTSUPERSCRIPT )</annotation></semantics></math> assigns weights to the expert predictions. Each expert <math alttext="e" class="ltx_Math" display="inline" id="S2.SS1.SSS0.Px2.p2.3.m3.1"><semantics id="S2.SS1.SSS0.Px2.p2.3.m3.1a"><mi id="S2.SS1.SSS0.Px2.p2.3.m3.1.1" xref="S2.SS1.SSS0.Px2.p2.3.m3.1.1.cmml">e</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS0.Px2.p2.3.m3.1b"><ci id="S2.SS1.SSS0.Px2.p2.3.m3.1.1.cmml" xref="S2.SS1.SSS0.Px2.p2.3.m3.1.1">𝑒</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS0.Px2.p2.3.m3.1c">e</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS0.Px2.p2.3.m3.1d">italic_e</annotation></semantics></math> has its own set of independent parameters <math alttext="\theta^{e}" class="ltx_Math" display="inline" id="S2.SS1.SSS0.Px2.p2.4.m4.1"><semantics id="S2.SS1.SSS0.Px2.p2.4.m4.1a"><msup id="S2.SS1.SSS0.Px2.p2.4.m4.1.1" xref="S2.SS1.SSS0.Px2.p2.4.m4.1.1.cmml"><mi id="S2.SS1.SSS0.Px2.p2.4.m4.1.1.2" xref="S2.SS1.SSS0.Px2.p2.4.m4.1.1.2.cmml">θ</mi><mi id="S2.SS1.SSS0.Px2.p2.4.m4.1.1.3" xref="S2.SS1.SSS0.Px2.p2.4.m4.1.1.3.cmml">e</mi></msup><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS0.Px2.p2.4.m4.1b"><apply id="S2.SS1.SSS0.Px2.p2.4.m4.1.1.cmml" xref="S2.SS1.SSS0.Px2.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS1.SSS0.Px2.p2.4.m4.1.1.1.cmml" xref="S2.SS1.SSS0.Px2.p2.4.m4.1.1">superscript</csymbol><ci id="S2.SS1.SSS0.Px2.p2.4.m4.1.1.2.cmml" xref="S2.SS1.SSS0.Px2.p2.4.m4.1.1.2">𝜃</ci><ci id="S2.SS1.SSS0.Px2.p2.4.m4.1.1.3.cmml" xref="S2.SS1.SSS0.Px2.p2.4.m4.1.1.3">𝑒</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS0.Px2.p2.4.m4.1c">\theta^{e}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS0.Px2.p2.4.m4.1d">italic_θ start_POSTSUPERSCRIPT italic_e end_POSTSUPERSCRIPT</annotation></semantics></math>, and the router is parameterized by <math alttext="\theta^{r}" class="ltx_Math" display="inline" id="S2.SS1.SSS0.Px2.p2.5.m5.1"><semantics id="S2.SS1.SSS0.Px2.p2.5.m5.1a"><msup id="S2.SS1.SSS0.Px2.p2.5.m5.1.1" xref="S2.SS1.SSS0.Px2.p2.5.m5.1.1.cmml"><mi id="S2.SS1.SSS0.Px2.p2.5.m5.1.1.2" xref="S2.SS1.SSS0.Px2.p2.5.m5.1.1.2.cmml">θ</mi><mi id="S2.SS1.SSS0.Px2.p2.5.m5.1.1.3" xref="S2.SS1.SSS0.Px2.p2.5.m5.1.1.3.cmml">r</mi></msup><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS0.Px2.p2.5.m5.1b"><apply id="S2.SS1.SSS0.Px2.p2.5.m5.1.1.cmml" xref="S2.SS1.SSS0.Px2.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S2.SS1.SSS0.Px2.p2.5.m5.1.1.1.cmml" xref="S2.SS1.SSS0.Px2.p2.5.m5.1.1">superscript</csymbol><ci id="S2.SS1.SSS0.Px2.p2.5.m5.1.1.2.cmml" xref="S2.SS1.SSS0.Px2.p2.5.m5.1.1.2">𝜃</ci><ci id="S2.SS1.SSS0.Px2.p2.5.m5.1.1.3.cmml" xref="S2.SS1.SSS0.Px2.p2.5.m5.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS0.Px2.p2.5.m5.1c">\theta^{r}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS0.Px2.p2.5.m5.1d">italic_θ start_POSTSUPERSCRIPT italic_r end_POSTSUPERSCRIPT</annotation></semantics></math>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS1.SSS0.Px2.p3">
<p class="ltx_p" id="S2.SS1.SSS0.Px2.p3.2">While this type of mixture of experts partitions the input space across different models, all experts are still involved when computing the conditional likelihood in Equation&nbsp;(<a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#S2.E2" title="In Mixture of Experts ‣ 2.1 Background ‣ 2 Method ‣ No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_tag">2</span></a>), both at training and inference time. Hard mixtures of experts circumvent this issue by hard-assigning a sequence <math alttext="\mathbf{x}_{1:s}" class="ltx_Math" display="inline" id="S2.SS1.SSS0.Px2.p3.1.m1.1"><semantics id="S2.SS1.SSS0.Px2.p3.1.m1.1a"><msub id="S2.SS1.SSS0.Px2.p3.1.m1.1.1" xref="S2.SS1.SSS0.Px2.p3.1.m1.1.1.cmml"><mi id="S2.SS1.SSS0.Px2.p3.1.m1.1.1.2" xref="S2.SS1.SSS0.Px2.p3.1.m1.1.1.2.cmml">𝐱</mi><mrow id="S2.SS1.SSS0.Px2.p3.1.m1.1.1.3" xref="S2.SS1.SSS0.Px2.p3.1.m1.1.1.3.cmml"><mn id="S2.SS1.SSS0.Px2.p3.1.m1.1.1.3.2" xref="S2.SS1.SSS0.Px2.p3.1.m1.1.1.3.2.cmml">1</mn><mo id="S2.SS1.SSS0.Px2.p3.1.m1.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="S2.SS1.SSS0.Px2.p3.1.m1.1.1.3.1.cmml">:</mo><mi id="S2.SS1.SSS0.Px2.p3.1.m1.1.1.3.3" xref="S2.SS1.SSS0.Px2.p3.1.m1.1.1.3.3.cmml">s</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS0.Px2.p3.1.m1.1b"><apply id="S2.SS1.SSS0.Px2.p3.1.m1.1.1.cmml" xref="S2.SS1.SSS0.Px2.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS1.SSS0.Px2.p3.1.m1.1.1.1.cmml" xref="S2.SS1.SSS0.Px2.p3.1.m1.1.1">subscript</csymbol><ci id="S2.SS1.SSS0.Px2.p3.1.m1.1.1.2.cmml" xref="S2.SS1.SSS0.Px2.p3.1.m1.1.1.2">𝐱</ci><apply id="S2.SS1.SSS0.Px2.p3.1.m1.1.1.3.cmml" xref="S2.SS1.SSS0.Px2.p3.1.m1.1.1.3"><ci id="S2.SS1.SSS0.Px2.p3.1.m1.1.1.3.1.cmml" xref="S2.SS1.SSS0.Px2.p3.1.m1.1.1.3.1">:</ci><cn id="S2.SS1.SSS0.Px2.p3.1.m1.1.1.3.2.cmml" type="integer" xref="S2.SS1.SSS0.Px2.p3.1.m1.1.1.3.2">1</cn><ci id="S2.SS1.SSS0.Px2.p3.1.m1.1.1.3.3.cmml" xref="S2.SS1.SSS0.Px2.p3.1.m1.1.1.3.3">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS0.Px2.p3.1.m1.1c">\mathbf{x}_{1:s}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS0.Px2.p3.1.m1.1d">bold_x start_POSTSUBSCRIPT 1 : italic_s end_POSTSUBSCRIPT</annotation></semantics></math> to a <em class="ltx_emph ltx_font_italic" id="S2.SS1.SSS0.Px2.p3.2.1">single</em> expert <math alttext="e^{\star}" class="ltx_Math" display="inline" id="S2.SS1.SSS0.Px2.p3.2.m2.1"><semantics id="S2.SS1.SSS0.Px2.p3.2.m2.1a"><msup id="S2.SS1.SSS0.Px2.p3.2.m2.1.1" xref="S2.SS1.SSS0.Px2.p3.2.m2.1.1.cmml"><mi id="S2.SS1.SSS0.Px2.p3.2.m2.1.1.2" xref="S2.SS1.SSS0.Px2.p3.2.m2.1.1.2.cmml">e</mi><mo id="S2.SS1.SSS0.Px2.p3.2.m2.1.1.3" xref="S2.SS1.SSS0.Px2.p3.2.m2.1.1.3.cmml">⋆</mo></msup><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS0.Px2.p3.2.m2.1b"><apply id="S2.SS1.SSS0.Px2.p3.2.m2.1.1.cmml" xref="S2.SS1.SSS0.Px2.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS1.SSS0.Px2.p3.2.m2.1.1.1.cmml" xref="S2.SS1.SSS0.Px2.p3.2.m2.1.1">superscript</csymbol><ci id="S2.SS1.SSS0.Px2.p3.2.m2.1.1.2.cmml" xref="S2.SS1.SSS0.Px2.p3.2.m2.1.1.2">𝑒</ci><ci id="S2.SS1.SSS0.Px2.p3.2.m2.1.1.3.cmml" xref="S2.SS1.SSS0.Px2.p3.2.m2.1.1.3">⋆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS0.Px2.p3.2.m2.1c">e^{\star}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS0.Px2.p3.2.m2.1d">italic_e start_POSTSUPERSCRIPT ⋆ end_POSTSUPERSCRIPT</annotation></semantics></math>, minimizing an upper bound of Equation&nbsp;(<a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#S2.E2" title="In Mixture of Experts ‣ 2.1 Background ‣ 2 Method ‣ No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_tag">2</span></a>):</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equation ltx_eqn_table" id="S2.E3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}(\mathbf{x};\theta)\leq-\sum_{s=1}^{S-1}\log p(x_{s+1}\mid\mathbf{x%
}_{1:s},e^{\star}\,;\,\theta^{e^{\star}})\,p(e^{\star}\mid\mathbf{x}_{1:s}\,;%
\,\theta^{r})," class="ltx_Math" display="block" id="S2.E3.m1.3"><semantics id="S2.E3.m1.3a"><mrow id="S2.E3.m1.3.3.1" xref="S2.E3.m1.3.3.1.1.cmml"><mrow id="S2.E3.m1.3.3.1.1" xref="S2.E3.m1.3.3.1.1.cmml"><mrow id="S2.E3.m1.3.3.1.1.4" xref="S2.E3.m1.3.3.1.1.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E3.m1.3.3.1.1.4.2" xref="S2.E3.m1.3.3.1.1.4.2.cmml">ℒ</mi><mo id="S2.E3.m1.3.3.1.1.4.1" xref="S2.E3.m1.3.3.1.1.4.1.cmml">⁢</mo><mrow id="S2.E3.m1.3.3.1.1.4.3.2" xref="S2.E3.m1.3.3.1.1.4.3.1.cmml"><mo id="S2.E3.m1.3.3.1.1.4.3.2.1" stretchy="false" xref="S2.E3.m1.3.3.1.1.4.3.1.cmml">(</mo><mi id="S2.E3.m1.1.1" xref="S2.E3.m1.1.1.cmml">𝐱</mi><mo id="S2.E3.m1.3.3.1.1.4.3.2.2" xref="S2.E3.m1.3.3.1.1.4.3.1.cmml">;</mo><mi id="S2.E3.m1.2.2" xref="S2.E3.m1.2.2.cmml">θ</mi><mo id="S2.E3.m1.3.3.1.1.4.3.2.3" stretchy="false" xref="S2.E3.m1.3.3.1.1.4.3.1.cmml">)</mo></mrow></mrow><mo id="S2.E3.m1.3.3.1.1.3" xref="S2.E3.m1.3.3.1.1.3.cmml">≤</mo><mrow id="S2.E3.m1.3.3.1.1.2" xref="S2.E3.m1.3.3.1.1.2.cmml"><mo id="S2.E3.m1.3.3.1.1.2a" xref="S2.E3.m1.3.3.1.1.2.cmml">−</mo><mrow id="S2.E3.m1.3.3.1.1.2.2" xref="S2.E3.m1.3.3.1.1.2.2.cmml"><munderover id="S2.E3.m1.3.3.1.1.2.2.3" xref="S2.E3.m1.3.3.1.1.2.2.3.cmml"><mo id="S2.E3.m1.3.3.1.1.2.2.3.2.2" movablelimits="false" xref="S2.E3.m1.3.3.1.1.2.2.3.2.2.cmml">∑</mo><mrow id="S2.E3.m1.3.3.1.1.2.2.3.2.3" xref="S2.E3.m1.3.3.1.1.2.2.3.2.3.cmml"><mi id="S2.E3.m1.3.3.1.1.2.2.3.2.3.2" xref="S2.E3.m1.3.3.1.1.2.2.3.2.3.2.cmml">s</mi><mo id="S2.E3.m1.3.3.1.1.2.2.3.2.3.1" xref="S2.E3.m1.3.3.1.1.2.2.3.2.3.1.cmml">=</mo><mn id="S2.E3.m1.3.3.1.1.2.2.3.2.3.3" xref="S2.E3.m1.3.3.1.1.2.2.3.2.3.3.cmml">1</mn></mrow><mrow id="S2.E3.m1.3.3.1.1.2.2.3.3" xref="S2.E3.m1.3.3.1.1.2.2.3.3.cmml"><mi id="S2.E3.m1.3.3.1.1.2.2.3.3.2" xref="S2.E3.m1.3.3.1.1.2.2.3.3.2.cmml">S</mi><mo id="S2.E3.m1.3.3.1.1.2.2.3.3.1" xref="S2.E3.m1.3.3.1.1.2.2.3.3.1.cmml">−</mo><mn id="S2.E3.m1.3.3.1.1.2.2.3.3.3" xref="S2.E3.m1.3.3.1.1.2.2.3.3.3.cmml">1</mn></mrow></munderover><mrow id="S2.E3.m1.3.3.1.1.2.2.2" xref="S2.E3.m1.3.3.1.1.2.2.2.cmml"><mrow id="S2.E3.m1.3.3.1.1.2.2.2.4" xref="S2.E3.m1.3.3.1.1.2.2.2.4.cmml"><mi id="S2.E3.m1.3.3.1.1.2.2.2.4.1" xref="S2.E3.m1.3.3.1.1.2.2.2.4.1.cmml">log</mi><mo id="S2.E3.m1.3.3.1.1.2.2.2.4a" lspace="0.167em" xref="S2.E3.m1.3.3.1.1.2.2.2.4.cmml">⁡</mo><mi id="S2.E3.m1.3.3.1.1.2.2.2.4.2" xref="S2.E3.m1.3.3.1.1.2.2.2.4.2.cmml">p</mi></mrow><mo id="S2.E3.m1.3.3.1.1.2.2.2.3" xref="S2.E3.m1.3.3.1.1.2.2.2.3.cmml">⁢</mo><mrow id="S2.E3.m1.3.3.1.1.1.1.1.1.1" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.cmml"><mo id="S2.E3.m1.3.3.1.1.1.1.1.1.1.2" stretchy="false" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E3.m1.3.3.1.1.1.1.1.1.1.1" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.cmml"><msub id="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.5" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.5.cmml"><mi id="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.5.2" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.5.2.cmml">x</mi><mrow id="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.5.3" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.5.3.cmml"><mi id="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.5.3.2" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.5.3.2.cmml">s</mi><mo id="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.5.3.1" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.5.3.1.cmml">+</mo><mn id="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.5.3.3" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.5.3.3.cmml">1</mn></mrow></msub><mo id="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.4" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.4.cmml">∣</mo><mrow id="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.3.3" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.3.4.cmml"><msub id="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.cmml">𝐱</mi><mrow id="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mn id="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">1</mn><mo id="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml">:</mo><mi id="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">s</mi></mrow></msub><mo id="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.3.3.4" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.3.4.cmml">,</mo><msup id="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.2.2.2" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.2.2.2.cmml"><mi id="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.2.2.2.2" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.2.2.2.2.cmml">e</mi><mo id="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.2.2.2.3" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.2.2.2.3.cmml">⋆</mo></msup><mo id="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.3.3.5" rspace="0.337em" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.3.4.cmml">;</mo><msup id="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.3.3.3" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.3.3.3.cmml"><mi id="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.3.3.3.2" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.3.3.3.2.cmml">θ</mi><msup id="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.3.3.3.3" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.3.3.3.3.cmml"><mi id="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.3.3.3.3.2" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.3.3.3.3.2.cmml">e</mi><mo id="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.3.3.3.3.3" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.3.3.3.3.3.cmml">⋆</mo></msup></msup></mrow></mrow><mo id="S2.E3.m1.3.3.1.1.1.1.1.1.1.3" stretchy="false" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S2.E3.m1.3.3.1.1.2.2.2.3a" lspace="0.170em" xref="S2.E3.m1.3.3.1.1.2.2.2.3.cmml">⁢</mo><mi id="S2.E3.m1.3.3.1.1.2.2.2.5" xref="S2.E3.m1.3.3.1.1.2.2.2.5.cmml">p</mi><mo id="S2.E3.m1.3.3.1.1.2.2.2.3b" xref="S2.E3.m1.3.3.1.1.2.2.2.3.cmml">⁢</mo><mrow id="S2.E3.m1.3.3.1.1.2.2.2.2.1" xref="S2.E3.m1.3.3.1.1.2.2.2.2.1.1.cmml"><mo id="S2.E3.m1.3.3.1.1.2.2.2.2.1.2" stretchy="false" xref="S2.E3.m1.3.3.1.1.2.2.2.2.1.1.cmml">(</mo><mrow id="S2.E3.m1.3.3.1.1.2.2.2.2.1.1" xref="S2.E3.m1.3.3.1.1.2.2.2.2.1.1.cmml"><msup id="S2.E3.m1.3.3.1.1.2.2.2.2.1.1.4" xref="S2.E3.m1.3.3.1.1.2.2.2.2.1.1.4.cmml"><mi id="S2.E3.m1.3.3.1.1.2.2.2.2.1.1.4.2" xref="S2.E3.m1.3.3.1.1.2.2.2.2.1.1.4.2.cmml">e</mi><mo id="S2.E3.m1.3.3.1.1.2.2.2.2.1.1.4.3" xref="S2.E3.m1.3.3.1.1.2.2.2.2.1.1.4.3.cmml">⋆</mo></msup><mo id="S2.E3.m1.3.3.1.1.2.2.2.2.1.1.3" xref="S2.E3.m1.3.3.1.1.2.2.2.2.1.1.3.cmml">∣</mo><mrow id="S2.E3.m1.3.3.1.1.2.2.2.2.1.1.2.2" xref="S2.E3.m1.3.3.1.1.2.2.2.2.1.1.2.3.cmml"><msub id="S2.E3.m1.3.3.1.1.2.2.2.2.1.1.1.1.1" xref="S2.E3.m1.3.3.1.1.2.2.2.2.1.1.1.1.1.cmml"><mi id="S2.E3.m1.3.3.1.1.2.2.2.2.1.1.1.1.1.2" xref="S2.E3.m1.3.3.1.1.2.2.2.2.1.1.1.1.1.2.cmml">𝐱</mi><mrow id="S2.E3.m1.3.3.1.1.2.2.2.2.1.1.1.1.1.3" xref="S2.E3.m1.3.3.1.1.2.2.2.2.1.1.1.1.1.3.cmml"><mn id="S2.E3.m1.3.3.1.1.2.2.2.2.1.1.1.1.1.3.2" xref="S2.E3.m1.3.3.1.1.2.2.2.2.1.1.1.1.1.3.2.cmml">1</mn><mo id="S2.E3.m1.3.3.1.1.2.2.2.2.1.1.1.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="S2.E3.m1.3.3.1.1.2.2.2.2.1.1.1.1.1.3.1.cmml">:</mo><mi id="S2.E3.m1.3.3.1.1.2.2.2.2.1.1.1.1.1.3.3" xref="S2.E3.m1.3.3.1.1.2.2.2.2.1.1.1.1.1.3.3.cmml">s</mi></mrow></msub><mo id="S2.E3.m1.3.3.1.1.2.2.2.2.1.1.2.2.3" rspace="0.337em" xref="S2.E3.m1.3.3.1.1.2.2.2.2.1.1.2.3.cmml">;</mo><msup id="S2.E3.m1.3.3.1.1.2.2.2.2.1.1.2.2.2" xref="S2.E3.m1.3.3.1.1.2.2.2.2.1.1.2.2.2.cmml"><mi id="S2.E3.m1.3.3.1.1.2.2.2.2.1.1.2.2.2.2" xref="S2.E3.m1.3.3.1.1.2.2.2.2.1.1.2.2.2.2.cmml">θ</mi><mi id="S2.E3.m1.3.3.1.1.2.2.2.2.1.1.2.2.2.3" xref="S2.E3.m1.3.3.1.1.2.2.2.2.1.1.2.2.2.3.cmml">r</mi></msup></mrow></mrow><mo id="S2.E3.m1.3.3.1.1.2.2.2.2.1.3" stretchy="false" xref="S2.E3.m1.3.3.1.1.2.2.2.2.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="S2.E3.m1.3.3.1.2" xref="S2.E3.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E3.m1.3b"><apply id="S2.E3.m1.3.3.1.1.cmml" xref="S2.E3.m1.3.3.1"><leq id="S2.E3.m1.3.3.1.1.3.cmml" xref="S2.E3.m1.3.3.1.1.3"></leq><apply id="S2.E3.m1.3.3.1.1.4.cmml" xref="S2.E3.m1.3.3.1.1.4"><times id="S2.E3.m1.3.3.1.1.4.1.cmml" xref="S2.E3.m1.3.3.1.1.4.1"></times><ci id="S2.E3.m1.3.3.1.1.4.2.cmml" xref="S2.E3.m1.3.3.1.1.4.2">ℒ</ci><list id="S2.E3.m1.3.3.1.1.4.3.1.cmml" xref="S2.E3.m1.3.3.1.1.4.3.2"><ci id="S2.E3.m1.1.1.cmml" xref="S2.E3.m1.1.1">𝐱</ci><ci id="S2.E3.m1.2.2.cmml" xref="S2.E3.m1.2.2">𝜃</ci></list></apply><apply id="S2.E3.m1.3.3.1.1.2.cmml" xref="S2.E3.m1.3.3.1.1.2"><minus id="S2.E3.m1.3.3.1.1.2.3.cmml" xref="S2.E3.m1.3.3.1.1.2"></minus><apply id="S2.E3.m1.3.3.1.1.2.2.cmml" xref="S2.E3.m1.3.3.1.1.2.2"><apply id="S2.E3.m1.3.3.1.1.2.2.3.cmml" xref="S2.E3.m1.3.3.1.1.2.2.3"><csymbol cd="ambiguous" id="S2.E3.m1.3.3.1.1.2.2.3.1.cmml" xref="S2.E3.m1.3.3.1.1.2.2.3">superscript</csymbol><apply id="S2.E3.m1.3.3.1.1.2.2.3.2.cmml" xref="S2.E3.m1.3.3.1.1.2.2.3"><csymbol cd="ambiguous" id="S2.E3.m1.3.3.1.1.2.2.3.2.1.cmml" xref="S2.E3.m1.3.3.1.1.2.2.3">subscript</csymbol><sum id="S2.E3.m1.3.3.1.1.2.2.3.2.2.cmml" xref="S2.E3.m1.3.3.1.1.2.2.3.2.2"></sum><apply id="S2.E3.m1.3.3.1.1.2.2.3.2.3.cmml" xref="S2.E3.m1.3.3.1.1.2.2.3.2.3"><eq id="S2.E3.m1.3.3.1.1.2.2.3.2.3.1.cmml" xref="S2.E3.m1.3.3.1.1.2.2.3.2.3.1"></eq><ci id="S2.E3.m1.3.3.1.1.2.2.3.2.3.2.cmml" xref="S2.E3.m1.3.3.1.1.2.2.3.2.3.2">𝑠</ci><cn id="S2.E3.m1.3.3.1.1.2.2.3.2.3.3.cmml" type="integer" xref="S2.E3.m1.3.3.1.1.2.2.3.2.3.3">1</cn></apply></apply><apply id="S2.E3.m1.3.3.1.1.2.2.3.3.cmml" xref="S2.E3.m1.3.3.1.1.2.2.3.3"><minus id="S2.E3.m1.3.3.1.1.2.2.3.3.1.cmml" xref="S2.E3.m1.3.3.1.1.2.2.3.3.1"></minus><ci id="S2.E3.m1.3.3.1.1.2.2.3.3.2.cmml" xref="S2.E3.m1.3.3.1.1.2.2.3.3.2">𝑆</ci><cn id="S2.E3.m1.3.3.1.1.2.2.3.3.3.cmml" type="integer" xref="S2.E3.m1.3.3.1.1.2.2.3.3.3">1</cn></apply></apply><apply id="S2.E3.m1.3.3.1.1.2.2.2.cmml" xref="S2.E3.m1.3.3.1.1.2.2.2"><times id="S2.E3.m1.3.3.1.1.2.2.2.3.cmml" xref="S2.E3.m1.3.3.1.1.2.2.2.3"></times><apply id="S2.E3.m1.3.3.1.1.2.2.2.4.cmml" xref="S2.E3.m1.3.3.1.1.2.2.2.4"><log id="S2.E3.m1.3.3.1.1.2.2.2.4.1.cmml" xref="S2.E3.m1.3.3.1.1.2.2.2.4.1"></log><ci id="S2.E3.m1.3.3.1.1.2.2.2.4.2.cmml" xref="S2.E3.m1.3.3.1.1.2.2.2.4.2">𝑝</ci></apply><apply id="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.4.cmml" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.4">conditional</csymbol><apply id="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.5.cmml" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.5"><csymbol cd="ambiguous" id="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.5.1.cmml" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.5">subscript</csymbol><ci id="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.5.2.cmml" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.5.2">𝑥</ci><apply id="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.5.3.cmml" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.5.3"><plus id="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.5.3.1.cmml" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.5.3.1"></plus><ci id="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.5.3.2.cmml" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.5.3.2">𝑠</ci><cn id="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.5.3.3.cmml" type="integer" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.5.3.3">1</cn></apply></apply><list id="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.3.4.cmml" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.3.3"><apply id="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2">𝐱</ci><apply id="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3"><ci id="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.1">:</ci><cn id="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" type="integer" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2">1</cn><ci id="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3">𝑠</ci></apply></apply><apply id="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.2.2.2">superscript</csymbol><ci id="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.2.2.2.2">𝑒</ci><ci id="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.2.2.2.3.cmml" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.2.2.2.3">⋆</ci></apply><apply id="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.3.3.3.1.cmml" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.3.3.3">superscript</csymbol><ci id="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.3.3.3.2.cmml" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.3.3.3.2">𝜃</ci><apply id="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.3.3.3.3.cmml" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.3.3.3.3"><csymbol cd="ambiguous" id="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.3.3.3.3.1.cmml" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.3.3.3.3">superscript</csymbol><ci id="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.3.3.3.3.2.cmml" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.3.3.3.3.2">𝑒</ci><ci id="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.3.3.3.3.3.cmml" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.3.3.3.3.3">⋆</ci></apply></apply></list></apply><ci id="S2.E3.m1.3.3.1.1.2.2.2.5.cmml" xref="S2.E3.m1.3.3.1.1.2.2.2.5">𝑝</ci><apply id="S2.E3.m1.3.3.1.1.2.2.2.2.1.1.cmml" xref="S2.E3.m1.3.3.1.1.2.2.2.2.1"><csymbol cd="latexml" id="S2.E3.m1.3.3.1.1.2.2.2.2.1.1.3.cmml" xref="S2.E3.m1.3.3.1.1.2.2.2.2.1.1.3">conditional</csymbol><apply id="S2.E3.m1.3.3.1.1.2.2.2.2.1.1.4.cmml" xref="S2.E3.m1.3.3.1.1.2.2.2.2.1.1.4"><csymbol cd="ambiguous" id="S2.E3.m1.3.3.1.1.2.2.2.2.1.1.4.1.cmml" xref="S2.E3.m1.3.3.1.1.2.2.2.2.1.1.4">superscript</csymbol><ci id="S2.E3.m1.3.3.1.1.2.2.2.2.1.1.4.2.cmml" xref="S2.E3.m1.3.3.1.1.2.2.2.2.1.1.4.2">𝑒</ci><ci id="S2.E3.m1.3.3.1.1.2.2.2.2.1.1.4.3.cmml" xref="S2.E3.m1.3.3.1.1.2.2.2.2.1.1.4.3">⋆</ci></apply><list id="S2.E3.m1.3.3.1.1.2.2.2.2.1.1.2.3.cmml" xref="S2.E3.m1.3.3.1.1.2.2.2.2.1.1.2.2"><apply id="S2.E3.m1.3.3.1.1.2.2.2.2.1.1.1.1.1.cmml" xref="S2.E3.m1.3.3.1.1.2.2.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E3.m1.3.3.1.1.2.2.2.2.1.1.1.1.1.1.cmml" xref="S2.E3.m1.3.3.1.1.2.2.2.2.1.1.1.1.1">subscript</csymbol><ci id="S2.E3.m1.3.3.1.1.2.2.2.2.1.1.1.1.1.2.cmml" xref="S2.E3.m1.3.3.1.1.2.2.2.2.1.1.1.1.1.2">𝐱</ci><apply id="S2.E3.m1.3.3.1.1.2.2.2.2.1.1.1.1.1.3.cmml" xref="S2.E3.m1.3.3.1.1.2.2.2.2.1.1.1.1.1.3"><ci id="S2.E3.m1.3.3.1.1.2.2.2.2.1.1.1.1.1.3.1.cmml" xref="S2.E3.m1.3.3.1.1.2.2.2.2.1.1.1.1.1.3.1">:</ci><cn id="S2.E3.m1.3.3.1.1.2.2.2.2.1.1.1.1.1.3.2.cmml" type="integer" xref="S2.E3.m1.3.3.1.1.2.2.2.2.1.1.1.1.1.3.2">1</cn><ci id="S2.E3.m1.3.3.1.1.2.2.2.2.1.1.1.1.1.3.3.cmml" xref="S2.E3.m1.3.3.1.1.2.2.2.2.1.1.1.1.1.3.3">𝑠</ci></apply></apply><apply id="S2.E3.m1.3.3.1.1.2.2.2.2.1.1.2.2.2.cmml" xref="S2.E3.m1.3.3.1.1.2.2.2.2.1.1.2.2.2"><csymbol cd="ambiguous" id="S2.E3.m1.3.3.1.1.2.2.2.2.1.1.2.2.2.1.cmml" xref="S2.E3.m1.3.3.1.1.2.2.2.2.1.1.2.2.2">superscript</csymbol><ci id="S2.E3.m1.3.3.1.1.2.2.2.2.1.1.2.2.2.2.cmml" xref="S2.E3.m1.3.3.1.1.2.2.2.2.1.1.2.2.2.2">𝜃</ci><ci id="S2.E3.m1.3.3.1.1.2.2.2.2.1.1.2.2.2.3.cmml" xref="S2.E3.m1.3.3.1.1.2.2.2.2.1.1.2.2.2.3">𝑟</ci></apply></list></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E3.m1.3c">\mathcal{L}(\mathbf{x};\theta)\leq-\sum_{s=1}^{S-1}\log p(x_{s+1}\mid\mathbf{x%
}_{1:s},e^{\star}\,;\,\theta^{e^{\star}})\,p(e^{\star}\mid\mathbf{x}_{1:s}\,;%
\,\theta^{r}),</annotation><annotation encoding="application/x-llamapun" id="S2.E3.m1.3d">caligraphic_L ( bold_x ; italic_θ ) ≤ - ∑ start_POSTSUBSCRIPT italic_s = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_S - 1 end_POSTSUPERSCRIPT roman_log italic_p ( italic_x start_POSTSUBSCRIPT italic_s + 1 end_POSTSUBSCRIPT ∣ bold_x start_POSTSUBSCRIPT 1 : italic_s end_POSTSUBSCRIPT , italic_e start_POSTSUPERSCRIPT ⋆ end_POSTSUPERSCRIPT ; italic_θ start_POSTSUPERSCRIPT italic_e start_POSTSUPERSCRIPT ⋆ end_POSTSUPERSCRIPT end_POSTSUPERSCRIPT ) italic_p ( italic_e start_POSTSUPERSCRIPT ⋆ end_POSTSUPERSCRIPT ∣ bold_x start_POSTSUBSCRIPT 1 : italic_s end_POSTSUBSCRIPT ; italic_θ start_POSTSUPERSCRIPT italic_r end_POSTSUPERSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS1.SSS0.Px2.p3.6">The way <math alttext="e^{\star}" class="ltx_Math" display="inline" id="S2.SS1.SSS0.Px2.p3.3.m1.1"><semantics id="S2.SS1.SSS0.Px2.p3.3.m1.1a"><msup id="S2.SS1.SSS0.Px2.p3.3.m1.1.1" xref="S2.SS1.SSS0.Px2.p3.3.m1.1.1.cmml"><mi id="S2.SS1.SSS0.Px2.p3.3.m1.1.1.2" xref="S2.SS1.SSS0.Px2.p3.3.m1.1.1.2.cmml">e</mi><mo id="S2.SS1.SSS0.Px2.p3.3.m1.1.1.3" xref="S2.SS1.SSS0.Px2.p3.3.m1.1.1.3.cmml">⋆</mo></msup><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS0.Px2.p3.3.m1.1b"><apply id="S2.SS1.SSS0.Px2.p3.3.m1.1.1.cmml" xref="S2.SS1.SSS0.Px2.p3.3.m1.1.1"><csymbol cd="ambiguous" id="S2.SS1.SSS0.Px2.p3.3.m1.1.1.1.cmml" xref="S2.SS1.SSS0.Px2.p3.3.m1.1.1">superscript</csymbol><ci id="S2.SS1.SSS0.Px2.p3.3.m1.1.1.2.cmml" xref="S2.SS1.SSS0.Px2.p3.3.m1.1.1.2">𝑒</ci><ci id="S2.SS1.SSS0.Px2.p3.3.m1.1.1.3.cmml" xref="S2.SS1.SSS0.Px2.p3.3.m1.1.1.3">⋆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS0.Px2.p3.3.m1.1c">e^{\star}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS0.Px2.p3.3.m1.1d">italic_e start_POSTSUPERSCRIPT ⋆ end_POSTSUPERSCRIPT</annotation></semantics></math> is chosen depends of the goal of the approach. For example, in <cite class="ltx_cite ltx_citemacro_cite">Jacobs et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#bib.bib24" title="">1991</a>)</cite>, <math alttext="e^{\star}" class="ltx_Math" display="inline" id="S2.SS1.SSS0.Px2.p3.4.m2.1"><semantics id="S2.SS1.SSS0.Px2.p3.4.m2.1a"><msup id="S2.SS1.SSS0.Px2.p3.4.m2.1.1" xref="S2.SS1.SSS0.Px2.p3.4.m2.1.1.cmml"><mi id="S2.SS1.SSS0.Px2.p3.4.m2.1.1.2" xref="S2.SS1.SSS0.Px2.p3.4.m2.1.1.2.cmml">e</mi><mo id="S2.SS1.SSS0.Px2.p3.4.m2.1.1.3" xref="S2.SS1.SSS0.Px2.p3.4.m2.1.1.3.cmml">⋆</mo></msup><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS0.Px2.p3.4.m2.1b"><apply id="S2.SS1.SSS0.Px2.p3.4.m2.1.1.cmml" xref="S2.SS1.SSS0.Px2.p3.4.m2.1.1"><csymbol cd="ambiguous" id="S2.SS1.SSS0.Px2.p3.4.m2.1.1.1.cmml" xref="S2.SS1.SSS0.Px2.p3.4.m2.1.1">superscript</csymbol><ci id="S2.SS1.SSS0.Px2.p3.4.m2.1.1.2.cmml" xref="S2.SS1.SSS0.Px2.p3.4.m2.1.1.2">𝑒</ci><ci id="S2.SS1.SSS0.Px2.p3.4.m2.1.1.3.cmml" xref="S2.SS1.SSS0.Px2.p3.4.m2.1.1.3">⋆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS0.Px2.p3.4.m2.1c">e^{\star}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS0.Px2.p3.4.m2.1d">italic_e start_POSTSUPERSCRIPT ⋆ end_POSTSUPERSCRIPT</annotation></semantics></math> is sampled at training time, according to the distribution <math alttext="p(e\mid\mathbf{x}_{1:s}\,;\,\theta^{r})" class="ltx_Math" display="inline" id="S2.SS1.SSS0.Px2.p3.5.m3.1"><semantics id="S2.SS1.SSS0.Px2.p3.5.m3.1a"><mrow id="S2.SS1.SSS0.Px2.p3.5.m3.1.1" xref="S2.SS1.SSS0.Px2.p3.5.m3.1.1.cmml"><mi id="S2.SS1.SSS0.Px2.p3.5.m3.1.1.3" xref="S2.SS1.SSS0.Px2.p3.5.m3.1.1.3.cmml">p</mi><mo id="S2.SS1.SSS0.Px2.p3.5.m3.1.1.2" xref="S2.SS1.SSS0.Px2.p3.5.m3.1.1.2.cmml">⁢</mo><mrow id="S2.SS1.SSS0.Px2.p3.5.m3.1.1.1.1" xref="S2.SS1.SSS0.Px2.p3.5.m3.1.1.1.1.1.cmml"><mo id="S2.SS1.SSS0.Px2.p3.5.m3.1.1.1.1.2" stretchy="false" xref="S2.SS1.SSS0.Px2.p3.5.m3.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS1.SSS0.Px2.p3.5.m3.1.1.1.1.1" xref="S2.SS1.SSS0.Px2.p3.5.m3.1.1.1.1.1.cmml"><mi id="S2.SS1.SSS0.Px2.p3.5.m3.1.1.1.1.1.4" xref="S2.SS1.SSS0.Px2.p3.5.m3.1.1.1.1.1.4.cmml">e</mi><mo id="S2.SS1.SSS0.Px2.p3.5.m3.1.1.1.1.1.3" xref="S2.SS1.SSS0.Px2.p3.5.m3.1.1.1.1.1.3.cmml">∣</mo><mrow id="S2.SS1.SSS0.Px2.p3.5.m3.1.1.1.1.1.2.2" xref="S2.SS1.SSS0.Px2.p3.5.m3.1.1.1.1.1.2.3.cmml"><msub id="S2.SS1.SSS0.Px2.p3.5.m3.1.1.1.1.1.1.1.1" xref="S2.SS1.SSS0.Px2.p3.5.m3.1.1.1.1.1.1.1.1.cmml"><mi id="S2.SS1.SSS0.Px2.p3.5.m3.1.1.1.1.1.1.1.1.2" xref="S2.SS1.SSS0.Px2.p3.5.m3.1.1.1.1.1.1.1.1.2.cmml">𝐱</mi><mrow id="S2.SS1.SSS0.Px2.p3.5.m3.1.1.1.1.1.1.1.1.3" xref="S2.SS1.SSS0.Px2.p3.5.m3.1.1.1.1.1.1.1.1.3.cmml"><mn id="S2.SS1.SSS0.Px2.p3.5.m3.1.1.1.1.1.1.1.1.3.2" xref="S2.SS1.SSS0.Px2.p3.5.m3.1.1.1.1.1.1.1.1.3.2.cmml">1</mn><mo id="S2.SS1.SSS0.Px2.p3.5.m3.1.1.1.1.1.1.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="S2.SS1.SSS0.Px2.p3.5.m3.1.1.1.1.1.1.1.1.3.1.cmml">:</mo><mi id="S2.SS1.SSS0.Px2.p3.5.m3.1.1.1.1.1.1.1.1.3.3" xref="S2.SS1.SSS0.Px2.p3.5.m3.1.1.1.1.1.1.1.1.3.3.cmml">s</mi></mrow></msub><mo id="S2.SS1.SSS0.Px2.p3.5.m3.1.1.1.1.1.2.2.3" rspace="0.337em" xref="S2.SS1.SSS0.Px2.p3.5.m3.1.1.1.1.1.2.3.cmml">;</mo><msup id="S2.SS1.SSS0.Px2.p3.5.m3.1.1.1.1.1.2.2.2" xref="S2.SS1.SSS0.Px2.p3.5.m3.1.1.1.1.1.2.2.2.cmml"><mi id="S2.SS1.SSS0.Px2.p3.5.m3.1.1.1.1.1.2.2.2.2" xref="S2.SS1.SSS0.Px2.p3.5.m3.1.1.1.1.1.2.2.2.2.cmml">θ</mi><mi id="S2.SS1.SSS0.Px2.p3.5.m3.1.1.1.1.1.2.2.2.3" xref="S2.SS1.SSS0.Px2.p3.5.m3.1.1.1.1.1.2.2.2.3.cmml">r</mi></msup></mrow></mrow><mo id="S2.SS1.SSS0.Px2.p3.5.m3.1.1.1.1.3" stretchy="false" xref="S2.SS1.SSS0.Px2.p3.5.m3.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS0.Px2.p3.5.m3.1b"><apply id="S2.SS1.SSS0.Px2.p3.5.m3.1.1.cmml" xref="S2.SS1.SSS0.Px2.p3.5.m3.1.1"><times id="S2.SS1.SSS0.Px2.p3.5.m3.1.1.2.cmml" xref="S2.SS1.SSS0.Px2.p3.5.m3.1.1.2"></times><ci id="S2.SS1.SSS0.Px2.p3.5.m3.1.1.3.cmml" xref="S2.SS1.SSS0.Px2.p3.5.m3.1.1.3">𝑝</ci><apply id="S2.SS1.SSS0.Px2.p3.5.m3.1.1.1.1.1.cmml" xref="S2.SS1.SSS0.Px2.p3.5.m3.1.1.1.1"><csymbol cd="latexml" id="S2.SS1.SSS0.Px2.p3.5.m3.1.1.1.1.1.3.cmml" xref="S2.SS1.SSS0.Px2.p3.5.m3.1.1.1.1.1.3">conditional</csymbol><ci id="S2.SS1.SSS0.Px2.p3.5.m3.1.1.1.1.1.4.cmml" xref="S2.SS1.SSS0.Px2.p3.5.m3.1.1.1.1.1.4">𝑒</ci><list id="S2.SS1.SSS0.Px2.p3.5.m3.1.1.1.1.1.2.3.cmml" xref="S2.SS1.SSS0.Px2.p3.5.m3.1.1.1.1.1.2.2"><apply id="S2.SS1.SSS0.Px2.p3.5.m3.1.1.1.1.1.1.1.1.cmml" xref="S2.SS1.SSS0.Px2.p3.5.m3.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.SSS0.Px2.p3.5.m3.1.1.1.1.1.1.1.1.1.cmml" xref="S2.SS1.SSS0.Px2.p3.5.m3.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.SS1.SSS0.Px2.p3.5.m3.1.1.1.1.1.1.1.1.2.cmml" xref="S2.SS1.SSS0.Px2.p3.5.m3.1.1.1.1.1.1.1.1.2">𝐱</ci><apply id="S2.SS1.SSS0.Px2.p3.5.m3.1.1.1.1.1.1.1.1.3.cmml" xref="S2.SS1.SSS0.Px2.p3.5.m3.1.1.1.1.1.1.1.1.3"><ci id="S2.SS1.SSS0.Px2.p3.5.m3.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.SS1.SSS0.Px2.p3.5.m3.1.1.1.1.1.1.1.1.3.1">:</ci><cn id="S2.SS1.SSS0.Px2.p3.5.m3.1.1.1.1.1.1.1.1.3.2.cmml" type="integer" xref="S2.SS1.SSS0.Px2.p3.5.m3.1.1.1.1.1.1.1.1.3.2">1</cn><ci id="S2.SS1.SSS0.Px2.p3.5.m3.1.1.1.1.1.1.1.1.3.3.cmml" xref="S2.SS1.SSS0.Px2.p3.5.m3.1.1.1.1.1.1.1.1.3.3">𝑠</ci></apply></apply><apply id="S2.SS1.SSS0.Px2.p3.5.m3.1.1.1.1.1.2.2.2.cmml" xref="S2.SS1.SSS0.Px2.p3.5.m3.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S2.SS1.SSS0.Px2.p3.5.m3.1.1.1.1.1.2.2.2.1.cmml" xref="S2.SS1.SSS0.Px2.p3.5.m3.1.1.1.1.1.2.2.2">superscript</csymbol><ci id="S2.SS1.SSS0.Px2.p3.5.m3.1.1.1.1.1.2.2.2.2.cmml" xref="S2.SS1.SSS0.Px2.p3.5.m3.1.1.1.1.1.2.2.2.2">𝜃</ci><ci id="S2.SS1.SSS0.Px2.p3.5.m3.1.1.1.1.1.2.2.2.3.cmml" xref="S2.SS1.SSS0.Px2.p3.5.m3.1.1.1.1.1.2.2.2.3">𝑟</ci></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS0.Px2.p3.5.m3.1c">p(e\mid\mathbf{x}_{1:s}\,;\,\theta^{r})</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS0.Px2.p3.5.m3.1d">italic_p ( italic_e ∣ bold_x start_POSTSUBSCRIPT 1 : italic_s end_POSTSUBSCRIPT ; italic_θ start_POSTSUPERSCRIPT italic_r end_POSTSUPERSCRIPT )</annotation></semantics></math>. In other works, like <cite class="ltx_cite ltx_citemacro_cite">Collobert et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#bib.bib7" title="">2001</a>)</cite>, it is chosen as the most relevant expert (that is <math alttext="e^{\star}=\operatorname*{arg\,max}_{e}p(e\mid\mathbf{x}_{1:s}\,;\,\theta^{r})" class="ltx_Math" display="inline" id="S2.SS1.SSS0.Px2.p3.6.m4.1"><semantics id="S2.SS1.SSS0.Px2.p3.6.m4.1a"><mrow id="S2.SS1.SSS0.Px2.p3.6.m4.1.1" xref="S2.SS1.SSS0.Px2.p3.6.m4.1.1.cmml"><msup id="S2.SS1.SSS0.Px2.p3.6.m4.1.1.3" xref="S2.SS1.SSS0.Px2.p3.6.m4.1.1.3.cmml"><mi id="S2.SS1.SSS0.Px2.p3.6.m4.1.1.3.2" xref="S2.SS1.SSS0.Px2.p3.6.m4.1.1.3.2.cmml">e</mi><mo id="S2.SS1.SSS0.Px2.p3.6.m4.1.1.3.3" xref="S2.SS1.SSS0.Px2.p3.6.m4.1.1.3.3.cmml">⋆</mo></msup><mo id="S2.SS1.SSS0.Px2.p3.6.m4.1.1.2" xref="S2.SS1.SSS0.Px2.p3.6.m4.1.1.2.cmml">=</mo><mrow id="S2.SS1.SSS0.Px2.p3.6.m4.1.1.1" xref="S2.SS1.SSS0.Px2.p3.6.m4.1.1.1.cmml"><mrow id="S2.SS1.SSS0.Px2.p3.6.m4.1.1.1.3" xref="S2.SS1.SSS0.Px2.p3.6.m4.1.1.1.3.cmml"><msub id="S2.SS1.SSS0.Px2.p3.6.m4.1.1.1.3.1" xref="S2.SS1.SSS0.Px2.p3.6.m4.1.1.1.3.1.cmml"><mrow id="S2.SS1.SSS0.Px2.p3.6.m4.1.1.1.3.1.2" xref="S2.SS1.SSS0.Px2.p3.6.m4.1.1.1.3.1.2.cmml"><mi id="S2.SS1.SSS0.Px2.p3.6.m4.1.1.1.3.1.2.2" xref="S2.SS1.SSS0.Px2.p3.6.m4.1.1.1.3.1.2.2.cmml">arg</mi><mo id="S2.SS1.SSS0.Px2.p3.6.m4.1.1.1.3.1.2.1" lspace="0.170em" xref="S2.SS1.SSS0.Px2.p3.6.m4.1.1.1.3.1.2.1.cmml">⁢</mo><mi id="S2.SS1.SSS0.Px2.p3.6.m4.1.1.1.3.1.2.3" xref="S2.SS1.SSS0.Px2.p3.6.m4.1.1.1.3.1.2.3.cmml">max</mi></mrow><mi id="S2.SS1.SSS0.Px2.p3.6.m4.1.1.1.3.1.3" xref="S2.SS1.SSS0.Px2.p3.6.m4.1.1.1.3.1.3.cmml">e</mi></msub><mo id="S2.SS1.SSS0.Px2.p3.6.m4.1.1.1.3a" xref="S2.SS1.SSS0.Px2.p3.6.m4.1.1.1.3.cmml">⁡</mo><mi id="S2.SS1.SSS0.Px2.p3.6.m4.1.1.1.3.2" xref="S2.SS1.SSS0.Px2.p3.6.m4.1.1.1.3.2.cmml">p</mi></mrow><mo id="S2.SS1.SSS0.Px2.p3.6.m4.1.1.1.2" xref="S2.SS1.SSS0.Px2.p3.6.m4.1.1.1.2.cmml">⁢</mo><mrow id="S2.SS1.SSS0.Px2.p3.6.m4.1.1.1.1.1" xref="S2.SS1.SSS0.Px2.p3.6.m4.1.1.1.1.1.1.cmml"><mo id="S2.SS1.SSS0.Px2.p3.6.m4.1.1.1.1.1.2" stretchy="false" xref="S2.SS1.SSS0.Px2.p3.6.m4.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS1.SSS0.Px2.p3.6.m4.1.1.1.1.1.1" xref="S2.SS1.SSS0.Px2.p3.6.m4.1.1.1.1.1.1.cmml"><mi id="S2.SS1.SSS0.Px2.p3.6.m4.1.1.1.1.1.1.4" xref="S2.SS1.SSS0.Px2.p3.6.m4.1.1.1.1.1.1.4.cmml">e</mi><mo id="S2.SS1.SSS0.Px2.p3.6.m4.1.1.1.1.1.1.3" xref="S2.SS1.SSS0.Px2.p3.6.m4.1.1.1.1.1.1.3.cmml">∣</mo><mrow id="S2.SS1.SSS0.Px2.p3.6.m4.1.1.1.1.1.1.2.2" xref="S2.SS1.SSS0.Px2.p3.6.m4.1.1.1.1.1.1.2.3.cmml"><msub id="S2.SS1.SSS0.Px2.p3.6.m4.1.1.1.1.1.1.1.1.1" xref="S2.SS1.SSS0.Px2.p3.6.m4.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.SS1.SSS0.Px2.p3.6.m4.1.1.1.1.1.1.1.1.1.2" xref="S2.SS1.SSS0.Px2.p3.6.m4.1.1.1.1.1.1.1.1.1.2.cmml">𝐱</mi><mrow id="S2.SS1.SSS0.Px2.p3.6.m4.1.1.1.1.1.1.1.1.1.3" xref="S2.SS1.SSS0.Px2.p3.6.m4.1.1.1.1.1.1.1.1.1.3.cmml"><mn id="S2.SS1.SSS0.Px2.p3.6.m4.1.1.1.1.1.1.1.1.1.3.2" xref="S2.SS1.SSS0.Px2.p3.6.m4.1.1.1.1.1.1.1.1.1.3.2.cmml">1</mn><mo id="S2.SS1.SSS0.Px2.p3.6.m4.1.1.1.1.1.1.1.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="S2.SS1.SSS0.Px2.p3.6.m4.1.1.1.1.1.1.1.1.1.3.1.cmml">:</mo><mi id="S2.SS1.SSS0.Px2.p3.6.m4.1.1.1.1.1.1.1.1.1.3.3" xref="S2.SS1.SSS0.Px2.p3.6.m4.1.1.1.1.1.1.1.1.1.3.3.cmml">s</mi></mrow></msub><mo id="S2.SS1.SSS0.Px2.p3.6.m4.1.1.1.1.1.1.2.2.3" rspace="0.337em" xref="S2.SS1.SSS0.Px2.p3.6.m4.1.1.1.1.1.1.2.3.cmml">;</mo><msup id="S2.SS1.SSS0.Px2.p3.6.m4.1.1.1.1.1.1.2.2.2" xref="S2.SS1.SSS0.Px2.p3.6.m4.1.1.1.1.1.1.2.2.2.cmml"><mi id="S2.SS1.SSS0.Px2.p3.6.m4.1.1.1.1.1.1.2.2.2.2" xref="S2.SS1.SSS0.Px2.p3.6.m4.1.1.1.1.1.1.2.2.2.2.cmml">θ</mi><mi id="S2.SS1.SSS0.Px2.p3.6.m4.1.1.1.1.1.1.2.2.2.3" xref="S2.SS1.SSS0.Px2.p3.6.m4.1.1.1.1.1.1.2.2.2.3.cmml">r</mi></msup></mrow></mrow><mo id="S2.SS1.SSS0.Px2.p3.6.m4.1.1.1.1.1.3" stretchy="false" xref="S2.SS1.SSS0.Px2.p3.6.m4.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS0.Px2.p3.6.m4.1b"><apply id="S2.SS1.SSS0.Px2.p3.6.m4.1.1.cmml" xref="S2.SS1.SSS0.Px2.p3.6.m4.1.1"><eq id="S2.SS1.SSS0.Px2.p3.6.m4.1.1.2.cmml" xref="S2.SS1.SSS0.Px2.p3.6.m4.1.1.2"></eq><apply id="S2.SS1.SSS0.Px2.p3.6.m4.1.1.3.cmml" xref="S2.SS1.SSS0.Px2.p3.6.m4.1.1.3"><csymbol cd="ambiguous" id="S2.SS1.SSS0.Px2.p3.6.m4.1.1.3.1.cmml" xref="S2.SS1.SSS0.Px2.p3.6.m4.1.1.3">superscript</csymbol><ci id="S2.SS1.SSS0.Px2.p3.6.m4.1.1.3.2.cmml" xref="S2.SS1.SSS0.Px2.p3.6.m4.1.1.3.2">𝑒</ci><ci id="S2.SS1.SSS0.Px2.p3.6.m4.1.1.3.3.cmml" xref="S2.SS1.SSS0.Px2.p3.6.m4.1.1.3.3">⋆</ci></apply><apply id="S2.SS1.SSS0.Px2.p3.6.m4.1.1.1.cmml" xref="S2.SS1.SSS0.Px2.p3.6.m4.1.1.1"><times id="S2.SS1.SSS0.Px2.p3.6.m4.1.1.1.2.cmml" xref="S2.SS1.SSS0.Px2.p3.6.m4.1.1.1.2"></times><apply id="S2.SS1.SSS0.Px2.p3.6.m4.1.1.1.3.cmml" xref="S2.SS1.SSS0.Px2.p3.6.m4.1.1.1.3"><apply id="S2.SS1.SSS0.Px2.p3.6.m4.1.1.1.3.1.cmml" xref="S2.SS1.SSS0.Px2.p3.6.m4.1.1.1.3.1"><csymbol cd="ambiguous" id="S2.SS1.SSS0.Px2.p3.6.m4.1.1.1.3.1.1.cmml" xref="S2.SS1.SSS0.Px2.p3.6.m4.1.1.1.3.1">subscript</csymbol><apply id="S2.SS1.SSS0.Px2.p3.6.m4.1.1.1.3.1.2.cmml" xref="S2.SS1.SSS0.Px2.p3.6.m4.1.1.1.3.1.2"><times id="S2.SS1.SSS0.Px2.p3.6.m4.1.1.1.3.1.2.1.cmml" xref="S2.SS1.SSS0.Px2.p3.6.m4.1.1.1.3.1.2.1"></times><ci id="S2.SS1.SSS0.Px2.p3.6.m4.1.1.1.3.1.2.2.cmml" xref="S2.SS1.SSS0.Px2.p3.6.m4.1.1.1.3.1.2.2">arg</ci><ci id="S2.SS1.SSS0.Px2.p3.6.m4.1.1.1.3.1.2.3.cmml" xref="S2.SS1.SSS0.Px2.p3.6.m4.1.1.1.3.1.2.3">max</ci></apply><ci id="S2.SS1.SSS0.Px2.p3.6.m4.1.1.1.3.1.3.cmml" xref="S2.SS1.SSS0.Px2.p3.6.m4.1.1.1.3.1.3">𝑒</ci></apply><ci id="S2.SS1.SSS0.Px2.p3.6.m4.1.1.1.3.2.cmml" xref="S2.SS1.SSS0.Px2.p3.6.m4.1.1.1.3.2">𝑝</ci></apply><apply id="S2.SS1.SSS0.Px2.p3.6.m4.1.1.1.1.1.1.cmml" xref="S2.SS1.SSS0.Px2.p3.6.m4.1.1.1.1.1"><csymbol cd="latexml" id="S2.SS1.SSS0.Px2.p3.6.m4.1.1.1.1.1.1.3.cmml" xref="S2.SS1.SSS0.Px2.p3.6.m4.1.1.1.1.1.1.3">conditional</csymbol><ci id="S2.SS1.SSS0.Px2.p3.6.m4.1.1.1.1.1.1.4.cmml" xref="S2.SS1.SSS0.Px2.p3.6.m4.1.1.1.1.1.1.4">𝑒</ci><list id="S2.SS1.SSS0.Px2.p3.6.m4.1.1.1.1.1.1.2.3.cmml" xref="S2.SS1.SSS0.Px2.p3.6.m4.1.1.1.1.1.1.2.2"><apply id="S2.SS1.SSS0.Px2.p3.6.m4.1.1.1.1.1.1.1.1.1.cmml" xref="S2.SS1.SSS0.Px2.p3.6.m4.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.SSS0.Px2.p3.6.m4.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.SS1.SSS0.Px2.p3.6.m4.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.SS1.SSS0.Px2.p3.6.m4.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.SS1.SSS0.Px2.p3.6.m4.1.1.1.1.1.1.1.1.1.2">𝐱</ci><apply id="S2.SS1.SSS0.Px2.p3.6.m4.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.SS1.SSS0.Px2.p3.6.m4.1.1.1.1.1.1.1.1.1.3"><ci id="S2.SS1.SSS0.Px2.p3.6.m4.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.SS1.SSS0.Px2.p3.6.m4.1.1.1.1.1.1.1.1.1.3.1">:</ci><cn id="S2.SS1.SSS0.Px2.p3.6.m4.1.1.1.1.1.1.1.1.1.3.2.cmml" type="integer" xref="S2.SS1.SSS0.Px2.p3.6.m4.1.1.1.1.1.1.1.1.1.3.2">1</cn><ci id="S2.SS1.SSS0.Px2.p3.6.m4.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S2.SS1.SSS0.Px2.p3.6.m4.1.1.1.1.1.1.1.1.1.3.3">𝑠</ci></apply></apply><apply id="S2.SS1.SSS0.Px2.p3.6.m4.1.1.1.1.1.1.2.2.2.cmml" xref="S2.SS1.SSS0.Px2.p3.6.m4.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S2.SS1.SSS0.Px2.p3.6.m4.1.1.1.1.1.1.2.2.2.1.cmml" xref="S2.SS1.SSS0.Px2.p3.6.m4.1.1.1.1.1.1.2.2.2">superscript</csymbol><ci id="S2.SS1.SSS0.Px2.p3.6.m4.1.1.1.1.1.1.2.2.2.2.cmml" xref="S2.SS1.SSS0.Px2.p3.6.m4.1.1.1.1.1.1.2.2.2.2">𝜃</ci><ci id="S2.SS1.SSS0.Px2.p3.6.m4.1.1.1.1.1.1.2.2.2.3.cmml" xref="S2.SS1.SSS0.Px2.p3.6.m4.1.1.1.1.1.1.2.2.2.3">𝑟</ci></apply></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS0.Px2.p3.6.m4.1c">e^{\star}=\operatorname*{arg\,max}_{e}p(e\mid\mathbf{x}_{1:s}\,;\,\theta^{r})</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS0.Px2.p3.6.m4.1d">italic_e start_POSTSUPERSCRIPT ⋆ end_POSTSUPERSCRIPT = start_OPERATOR roman_arg roman_max end_OPERATOR start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT italic_p ( italic_e ∣ bold_x start_POSTSUBSCRIPT 1 : italic_s end_POSTSUBSCRIPT ; italic_θ start_POSTSUPERSCRIPT italic_r end_POSTSUPERSCRIPT )</annotation></semantics></math>), both at training and inference. Regarding the training procedure, mixture models with both soft and hard assignments are typically trained with an Expectation-Minimization (EM) scheme, alternating between experts and router optimization.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
</section>
<section class="ltx_subsection" id="S2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span><span class="ltx_text ltx_font_smallcaps" id="S2.SS2.1.1">SmallTalk LM</span>
</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<section class="ltx_paragraph" id="S2.SS2.SSS0.Px1">
<h5 class="ltx_title ltx_title_paragraph">Routing With Independent Language Models</h5><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S2.SS2.SSS0.Px1.p1">
<p class="ltx_p" id="S2.SS2.SSS0.Px1.p1.2"><span class="ltx_text ltx_font_smallcaps" id="S2.SS2.SSS0.Px1.p1.2.1">SmallTalk LM</span> can be viewed as an instance of hard mixture of experts, where a sequence is routed to the most relevant expert <math alttext="e^{\star}" class="ltx_Math" display="inline" id="S2.SS2.SSS0.Px1.p1.1.m1.1"><semantics id="S2.SS2.SSS0.Px1.p1.1.m1.1a"><msup id="S2.SS2.SSS0.Px1.p1.1.m1.1.1" xref="S2.SS2.SSS0.Px1.p1.1.m1.1.1.cmml"><mi id="S2.SS2.SSS0.Px1.p1.1.m1.1.1.2" xref="S2.SS2.SSS0.Px1.p1.1.m1.1.1.2.cmml">e</mi><mo id="S2.SS2.SSS0.Px1.p1.1.m1.1.1.3" xref="S2.SS2.SSS0.Px1.p1.1.m1.1.1.3.cmml">⋆</mo></msup><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS0.Px1.p1.1.m1.1b"><apply id="S2.SS2.SSS0.Px1.p1.1.m1.1.1.cmml" xref="S2.SS2.SSS0.Px1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS0.Px1.p1.1.m1.1.1.1.cmml" xref="S2.SS2.SSS0.Px1.p1.1.m1.1.1">superscript</csymbol><ci id="S2.SS2.SSS0.Px1.p1.1.m1.1.1.2.cmml" xref="S2.SS2.SSS0.Px1.p1.1.m1.1.1.2">𝑒</ci><ci id="S2.SS2.SSS0.Px1.p1.1.m1.1.1.3.cmml" xref="S2.SS2.SSS0.Px1.p1.1.m1.1.1.3">⋆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS0.Px1.p1.1.m1.1c">e^{\star}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS0.Px1.p1.1.m1.1d">italic_e start_POSTSUPERSCRIPT ⋆ end_POSTSUPERSCRIPT</annotation></semantics></math>, according to the router posterior <math alttext="p(e\mid\mathbf{x}_{1:s}\,;\,\theta^{r})" class="ltx_Math" display="inline" id="S2.SS2.SSS0.Px1.p1.2.m2.1"><semantics id="S2.SS2.SSS0.Px1.p1.2.m2.1a"><mrow id="S2.SS2.SSS0.Px1.p1.2.m2.1.1" xref="S2.SS2.SSS0.Px1.p1.2.m2.1.1.cmml"><mi id="S2.SS2.SSS0.Px1.p1.2.m2.1.1.3" xref="S2.SS2.SSS0.Px1.p1.2.m2.1.1.3.cmml">p</mi><mo id="S2.SS2.SSS0.Px1.p1.2.m2.1.1.2" xref="S2.SS2.SSS0.Px1.p1.2.m2.1.1.2.cmml">⁢</mo><mrow id="S2.SS2.SSS0.Px1.p1.2.m2.1.1.1.1" xref="S2.SS2.SSS0.Px1.p1.2.m2.1.1.1.1.1.cmml"><mo id="S2.SS2.SSS0.Px1.p1.2.m2.1.1.1.1.2" stretchy="false" xref="S2.SS2.SSS0.Px1.p1.2.m2.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS2.SSS0.Px1.p1.2.m2.1.1.1.1.1" xref="S2.SS2.SSS0.Px1.p1.2.m2.1.1.1.1.1.cmml"><mi id="S2.SS2.SSS0.Px1.p1.2.m2.1.1.1.1.1.4" xref="S2.SS2.SSS0.Px1.p1.2.m2.1.1.1.1.1.4.cmml">e</mi><mo id="S2.SS2.SSS0.Px1.p1.2.m2.1.1.1.1.1.3" xref="S2.SS2.SSS0.Px1.p1.2.m2.1.1.1.1.1.3.cmml">∣</mo><mrow id="S2.SS2.SSS0.Px1.p1.2.m2.1.1.1.1.1.2.2" xref="S2.SS2.SSS0.Px1.p1.2.m2.1.1.1.1.1.2.3.cmml"><msub id="S2.SS2.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.1.1" xref="S2.SS2.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.1.1.cmml"><mi id="S2.SS2.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.1.1.2" xref="S2.SS2.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.1.1.2.cmml">𝐱</mi><mrow id="S2.SS2.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.1.1.3" xref="S2.SS2.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.1.1.3.cmml"><mn id="S2.SS2.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.1.1.3.2" xref="S2.SS2.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.1.1.3.2.cmml">1</mn><mo id="S2.SS2.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="S2.SS2.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.1.1.3.1.cmml">:</mo><mi id="S2.SS2.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.1.1.3.3" xref="S2.SS2.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.1.1.3.3.cmml">s</mi></mrow></msub><mo id="S2.SS2.SSS0.Px1.p1.2.m2.1.1.1.1.1.2.2.3" rspace="0.337em" xref="S2.SS2.SSS0.Px1.p1.2.m2.1.1.1.1.1.2.3.cmml">;</mo><msup id="S2.SS2.SSS0.Px1.p1.2.m2.1.1.1.1.1.2.2.2" xref="S2.SS2.SSS0.Px1.p1.2.m2.1.1.1.1.1.2.2.2.cmml"><mi id="S2.SS2.SSS0.Px1.p1.2.m2.1.1.1.1.1.2.2.2.2" xref="S2.SS2.SSS0.Px1.p1.2.m2.1.1.1.1.1.2.2.2.2.cmml">θ</mi><mi id="S2.SS2.SSS0.Px1.p1.2.m2.1.1.1.1.1.2.2.2.3" xref="S2.SS2.SSS0.Px1.p1.2.m2.1.1.1.1.1.2.2.2.3.cmml">r</mi></msup></mrow></mrow><mo id="S2.SS2.SSS0.Px1.p1.2.m2.1.1.1.1.3" stretchy="false" xref="S2.SS2.SSS0.Px1.p1.2.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS0.Px1.p1.2.m2.1b"><apply id="S2.SS2.SSS0.Px1.p1.2.m2.1.1.cmml" xref="S2.SS2.SSS0.Px1.p1.2.m2.1.1"><times id="S2.SS2.SSS0.Px1.p1.2.m2.1.1.2.cmml" xref="S2.SS2.SSS0.Px1.p1.2.m2.1.1.2"></times><ci id="S2.SS2.SSS0.Px1.p1.2.m2.1.1.3.cmml" xref="S2.SS2.SSS0.Px1.p1.2.m2.1.1.3">𝑝</ci><apply id="S2.SS2.SSS0.Px1.p1.2.m2.1.1.1.1.1.cmml" xref="S2.SS2.SSS0.Px1.p1.2.m2.1.1.1.1"><csymbol cd="latexml" id="S2.SS2.SSS0.Px1.p1.2.m2.1.1.1.1.1.3.cmml" xref="S2.SS2.SSS0.Px1.p1.2.m2.1.1.1.1.1.3">conditional</csymbol><ci id="S2.SS2.SSS0.Px1.p1.2.m2.1.1.1.1.1.4.cmml" xref="S2.SS2.SSS0.Px1.p1.2.m2.1.1.1.1.1.4">𝑒</ci><list id="S2.SS2.SSS0.Px1.p1.2.m2.1.1.1.1.1.2.3.cmml" xref="S2.SS2.SSS0.Px1.p1.2.m2.1.1.1.1.1.2.2"><apply id="S2.SS2.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.1.1.cmml" xref="S2.SS2.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.1.1.1.cmml" xref="S2.SS2.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.SS2.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.1.1.2.cmml" xref="S2.SS2.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.1.1.2">𝐱</ci><apply id="S2.SS2.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.1.1.3.cmml" xref="S2.SS2.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.1.1.3"><ci id="S2.SS2.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.SS2.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.1.1.3.1">:</ci><cn id="S2.SS2.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.1.1.3.2.cmml" type="integer" xref="S2.SS2.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.1.1.3.2">1</cn><ci id="S2.SS2.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.1.1.3.3.cmml" xref="S2.SS2.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.1.1.3.3">𝑠</ci></apply></apply><apply id="S2.SS2.SSS0.Px1.p1.2.m2.1.1.1.1.1.2.2.2.cmml" xref="S2.SS2.SSS0.Px1.p1.2.m2.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.SSS0.Px1.p1.2.m2.1.1.1.1.1.2.2.2.1.cmml" xref="S2.SS2.SSS0.Px1.p1.2.m2.1.1.1.1.1.2.2.2">superscript</csymbol><ci id="S2.SS2.SSS0.Px1.p1.2.m2.1.1.1.1.1.2.2.2.2.cmml" xref="S2.SS2.SSS0.Px1.p1.2.m2.1.1.1.1.1.2.2.2.2">𝜃</ci><ci id="S2.SS2.SSS0.Px1.p1.2.m2.1.1.1.1.1.2.2.2.3.cmml" xref="S2.SS2.SSS0.Px1.p1.2.m2.1.1.1.1.1.2.2.2.3">𝑟</ci></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS0.Px1.p1.2.m2.1c">p(e\mid\mathbf{x}_{1:s}\,;\,\theta^{r})</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS0.Px1.p1.2.m2.1d">italic_p ( italic_e ∣ bold_x start_POSTSUBSCRIPT 1 : italic_s end_POSTSUBSCRIPT ; italic_θ start_POSTSUPERSCRIPT italic_r end_POSTSUPERSCRIPT )</annotation></semantics></math>, both at training and inference. However, instead of being a monolithic neural network model, the router is implemented as a language model per expert. More precisely, with Bayes’ rule we have:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A3.EGx1">
<tbody id="S2.E4"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle e^{\star}" class="ltx_Math" display="inline" id="S2.E4.m1.1"><semantics id="S2.E4.m1.1a"><msup id="S2.E4.m1.1.1" xref="S2.E4.m1.1.1.cmml"><mi id="S2.E4.m1.1.1.2" xref="S2.E4.m1.1.1.2.cmml">e</mi><mo id="S2.E4.m1.1.1.3" xref="S2.E4.m1.1.1.3.cmml">⋆</mo></msup><annotation-xml encoding="MathML-Content" id="S2.E4.m1.1b"><apply id="S2.E4.m1.1.1.cmml" xref="S2.E4.m1.1.1"><csymbol cd="ambiguous" id="S2.E4.m1.1.1.1.cmml" xref="S2.E4.m1.1.1">superscript</csymbol><ci id="S2.E4.m1.1.1.2.cmml" xref="S2.E4.m1.1.1.2">𝑒</ci><ci id="S2.E4.m1.1.1.3.cmml" xref="S2.E4.m1.1.1.3">⋆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E4.m1.1c">\displaystyle e^{\star}</annotation><annotation encoding="application/x-llamapun" id="S2.E4.m1.1d">italic_e start_POSTSUPERSCRIPT ⋆ end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\operatorname*{arg\,max}_{e}p(e\mid\mathbf{x}_{1:s}\,;\,\theta^{%
r})" class="ltx_Math" display="inline" id="S2.E4.m2.1"><semantics id="S2.E4.m2.1a"><mrow id="S2.E4.m2.1.1" xref="S2.E4.m2.1.1.cmml"><mi id="S2.E4.m2.1.1.3" xref="S2.E4.m2.1.1.3.cmml"></mi><mo id="S2.E4.m2.1.1.2" xref="S2.E4.m2.1.1.2.cmml">=</mo><mrow id="S2.E4.m2.1.1.1" xref="S2.E4.m2.1.1.1.cmml"><mrow id="S2.E4.m2.1.1.1.3" xref="S2.E4.m2.1.1.1.3.cmml"><munder id="S2.E4.m2.1.1.1.3.1" xref="S2.E4.m2.1.1.1.3.1.cmml"><mrow id="S2.E4.m2.1.1.1.3.1.2" xref="S2.E4.m2.1.1.1.3.1.2.cmml"><mi id="S2.E4.m2.1.1.1.3.1.2.2" xref="S2.E4.m2.1.1.1.3.1.2.2.cmml">arg</mi><mo id="S2.E4.m2.1.1.1.3.1.2.1" lspace="0.170em" xref="S2.E4.m2.1.1.1.3.1.2.1.cmml">⁢</mo><mi id="S2.E4.m2.1.1.1.3.1.2.3" xref="S2.E4.m2.1.1.1.3.1.2.3.cmml">max</mi></mrow><mi id="S2.E4.m2.1.1.1.3.1.3" xref="S2.E4.m2.1.1.1.3.1.3.cmml">e</mi></munder><mo id="S2.E4.m2.1.1.1.3a" xref="S2.E4.m2.1.1.1.3.cmml">⁡</mo><mi id="S2.E4.m2.1.1.1.3.2" xref="S2.E4.m2.1.1.1.3.2.cmml">p</mi></mrow><mo id="S2.E4.m2.1.1.1.2" xref="S2.E4.m2.1.1.1.2.cmml">⁢</mo><mrow id="S2.E4.m2.1.1.1.1.1" xref="S2.E4.m2.1.1.1.1.1.1.cmml"><mo id="S2.E4.m2.1.1.1.1.1.2" stretchy="false" xref="S2.E4.m2.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E4.m2.1.1.1.1.1.1" xref="S2.E4.m2.1.1.1.1.1.1.cmml"><mi id="S2.E4.m2.1.1.1.1.1.1.4" xref="S2.E4.m2.1.1.1.1.1.1.4.cmml">e</mi><mo id="S2.E4.m2.1.1.1.1.1.1.3" xref="S2.E4.m2.1.1.1.1.1.1.3.cmml">∣</mo><mrow id="S2.E4.m2.1.1.1.1.1.1.2.2" xref="S2.E4.m2.1.1.1.1.1.1.2.3.cmml"><msub id="S2.E4.m2.1.1.1.1.1.1.1.1.1" xref="S2.E4.m2.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E4.m2.1.1.1.1.1.1.1.1.1.2" xref="S2.E4.m2.1.1.1.1.1.1.1.1.1.2.cmml">𝐱</mi><mrow id="S2.E4.m2.1.1.1.1.1.1.1.1.1.3" xref="S2.E4.m2.1.1.1.1.1.1.1.1.1.3.cmml"><mn id="S2.E4.m2.1.1.1.1.1.1.1.1.1.3.2" xref="S2.E4.m2.1.1.1.1.1.1.1.1.1.3.2.cmml">1</mn><mo id="S2.E4.m2.1.1.1.1.1.1.1.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="S2.E4.m2.1.1.1.1.1.1.1.1.1.3.1.cmml">:</mo><mi id="S2.E4.m2.1.1.1.1.1.1.1.1.1.3.3" xref="S2.E4.m2.1.1.1.1.1.1.1.1.1.3.3.cmml">s</mi></mrow></msub><mo id="S2.E4.m2.1.1.1.1.1.1.2.2.3" rspace="0.337em" xref="S2.E4.m2.1.1.1.1.1.1.2.3.cmml">;</mo><msup id="S2.E4.m2.1.1.1.1.1.1.2.2.2" xref="S2.E4.m2.1.1.1.1.1.1.2.2.2.cmml"><mi id="S2.E4.m2.1.1.1.1.1.1.2.2.2.2" xref="S2.E4.m2.1.1.1.1.1.1.2.2.2.2.cmml">θ</mi><mi id="S2.E4.m2.1.1.1.1.1.1.2.2.2.3" xref="S2.E4.m2.1.1.1.1.1.1.2.2.2.3.cmml">r</mi></msup></mrow></mrow><mo id="S2.E4.m2.1.1.1.1.1.3" stretchy="false" xref="S2.E4.m2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E4.m2.1b"><apply id="S2.E4.m2.1.1.cmml" xref="S2.E4.m2.1.1"><eq id="S2.E4.m2.1.1.2.cmml" xref="S2.E4.m2.1.1.2"></eq><csymbol cd="latexml" id="S2.E4.m2.1.1.3.cmml" xref="S2.E4.m2.1.1.3">absent</csymbol><apply id="S2.E4.m2.1.1.1.cmml" xref="S2.E4.m2.1.1.1"><times id="S2.E4.m2.1.1.1.2.cmml" xref="S2.E4.m2.1.1.1.2"></times><apply id="S2.E4.m2.1.1.1.3.cmml" xref="S2.E4.m2.1.1.1.3"><apply id="S2.E4.m2.1.1.1.3.1.cmml" xref="S2.E4.m2.1.1.1.3.1"><csymbol cd="ambiguous" id="S2.E4.m2.1.1.1.3.1.1.cmml" xref="S2.E4.m2.1.1.1.3.1">subscript</csymbol><apply id="S2.E4.m2.1.1.1.3.1.2.cmml" xref="S2.E4.m2.1.1.1.3.1.2"><times id="S2.E4.m2.1.1.1.3.1.2.1.cmml" xref="S2.E4.m2.1.1.1.3.1.2.1"></times><ci id="S2.E4.m2.1.1.1.3.1.2.2.cmml" xref="S2.E4.m2.1.1.1.3.1.2.2">arg</ci><ci id="S2.E4.m2.1.1.1.3.1.2.3.cmml" xref="S2.E4.m2.1.1.1.3.1.2.3">max</ci></apply><ci id="S2.E4.m2.1.1.1.3.1.3.cmml" xref="S2.E4.m2.1.1.1.3.1.3">𝑒</ci></apply><ci id="S2.E4.m2.1.1.1.3.2.cmml" xref="S2.E4.m2.1.1.1.3.2">𝑝</ci></apply><apply id="S2.E4.m2.1.1.1.1.1.1.cmml" xref="S2.E4.m2.1.1.1.1.1"><csymbol cd="latexml" id="S2.E4.m2.1.1.1.1.1.1.3.cmml" xref="S2.E4.m2.1.1.1.1.1.1.3">conditional</csymbol><ci id="S2.E4.m2.1.1.1.1.1.1.4.cmml" xref="S2.E4.m2.1.1.1.1.1.1.4">𝑒</ci><list id="S2.E4.m2.1.1.1.1.1.1.2.3.cmml" xref="S2.E4.m2.1.1.1.1.1.1.2.2"><apply id="S2.E4.m2.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E4.m2.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E4.m2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E4.m2.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E4.m2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E4.m2.1.1.1.1.1.1.1.1.1.2">𝐱</ci><apply id="S2.E4.m2.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E4.m2.1.1.1.1.1.1.1.1.1.3"><ci id="S2.E4.m2.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E4.m2.1.1.1.1.1.1.1.1.1.3.1">:</ci><cn id="S2.E4.m2.1.1.1.1.1.1.1.1.1.3.2.cmml" type="integer" xref="S2.E4.m2.1.1.1.1.1.1.1.1.1.3.2">1</cn><ci id="S2.E4.m2.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S2.E4.m2.1.1.1.1.1.1.1.1.1.3.3">𝑠</ci></apply></apply><apply id="S2.E4.m2.1.1.1.1.1.1.2.2.2.cmml" xref="S2.E4.m2.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S2.E4.m2.1.1.1.1.1.1.2.2.2.1.cmml" xref="S2.E4.m2.1.1.1.1.1.1.2.2.2">superscript</csymbol><ci id="S2.E4.m2.1.1.1.1.1.1.2.2.2.2.cmml" xref="S2.E4.m2.1.1.1.1.1.1.2.2.2.2">𝜃</ci><ci id="S2.E4.m2.1.1.1.1.1.1.2.2.2.3.cmml" xref="S2.E4.m2.1.1.1.1.1.1.2.2.2.3">𝑟</ci></apply></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E4.m2.1c">\displaystyle=\operatorname*{arg\,max}_{e}p(e\mid\mathbf{x}_{1:s}\,;\,\theta^{%
r})</annotation><annotation encoding="application/x-llamapun" id="S2.E4.m2.1d">= start_OPERATOR roman_arg roman_max end_OPERATOR start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT italic_p ( italic_e ∣ bold_x start_POSTSUBSCRIPT 1 : italic_s end_POSTSUBSCRIPT ; italic_θ start_POSTSUPERSCRIPT italic_r end_POSTSUPERSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
<tbody id="S2.E5"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\operatorname*{arg\,max}_{e}\frac{p(\mathbf{x}_{1:s}\mid e\,;\,%
\theta^{r})\,p(e)}{\sum_{i=1}^{E}p(\mathbf{x}_{1:s}\mid i\,;\,\theta^{r})\,p(i)}" class="ltx_Math" display="inline" id="S2.E5.m1.6"><semantics id="S2.E5.m1.6a"><mrow id="S2.E5.m1.6.7" xref="S2.E5.m1.6.7.cmml"><mi id="S2.E5.m1.6.7.2" xref="S2.E5.m1.6.7.2.cmml"></mi><mo id="S2.E5.m1.6.7.1" xref="S2.E5.m1.6.7.1.cmml">=</mo><mrow id="S2.E5.m1.6.7.3" xref="S2.E5.m1.6.7.3.cmml"><munder id="S2.E5.m1.6.7.3.1" xref="S2.E5.m1.6.7.3.1.cmml"><mrow id="S2.E5.m1.6.7.3.1.2" xref="S2.E5.m1.6.7.3.1.2.cmml"><mi id="S2.E5.m1.6.7.3.1.2.2" xref="S2.E5.m1.6.7.3.1.2.2.cmml">arg</mi><mo id="S2.E5.m1.6.7.3.1.2.1" lspace="0.170em" xref="S2.E5.m1.6.7.3.1.2.1.cmml">⁢</mo><mi id="S2.E5.m1.6.7.3.1.2.3" xref="S2.E5.m1.6.7.3.1.2.3.cmml">max</mi></mrow><mi id="S2.E5.m1.6.7.3.1.3" xref="S2.E5.m1.6.7.3.1.3.cmml">e</mi></munder><mo id="S2.E5.m1.6.7.3a" xref="S2.E5.m1.6.7.3.cmml">⁡</mo><mstyle displaystyle="true" id="S2.E5.m1.6.6" xref="S2.E5.m1.6.6.cmml"><mfrac id="S2.E5.m1.6.6a" xref="S2.E5.m1.6.6.cmml"><mrow id="S2.E5.m1.3.3.3" xref="S2.E5.m1.3.3.3.cmml"><mi id="S2.E5.m1.3.3.3.5" xref="S2.E5.m1.3.3.3.5.cmml">p</mi><mo id="S2.E5.m1.3.3.3.4" xref="S2.E5.m1.3.3.3.4.cmml">⁢</mo><mrow id="S2.E5.m1.3.3.3.3.1" xref="S2.E5.m1.3.3.3.3.1.1.cmml"><mo id="S2.E5.m1.3.3.3.3.1.2" stretchy="false" xref="S2.E5.m1.3.3.3.3.1.1.cmml">(</mo><mrow id="S2.E5.m1.3.3.3.3.1.1" xref="S2.E5.m1.3.3.3.3.1.1.cmml"><msub id="S2.E5.m1.3.3.3.3.1.1.3" xref="S2.E5.m1.3.3.3.3.1.1.3.cmml"><mi id="S2.E5.m1.3.3.3.3.1.1.3.2" xref="S2.E5.m1.3.3.3.3.1.1.3.2.cmml">𝐱</mi><mrow id="S2.E5.m1.3.3.3.3.1.1.3.3" xref="S2.E5.m1.3.3.3.3.1.1.3.3.cmml"><mn id="S2.E5.m1.3.3.3.3.1.1.3.3.2" xref="S2.E5.m1.3.3.3.3.1.1.3.3.2.cmml">1</mn><mo id="S2.E5.m1.3.3.3.3.1.1.3.3.1" lspace="0.278em" rspace="0.278em" xref="S2.E5.m1.3.3.3.3.1.1.3.3.1.cmml">:</mo><mi id="S2.E5.m1.3.3.3.3.1.1.3.3.3" xref="S2.E5.m1.3.3.3.3.1.1.3.3.3.cmml">s</mi></mrow></msub><mo id="S2.E5.m1.3.3.3.3.1.1.2" xref="S2.E5.m1.3.3.3.3.1.1.2.cmml">∣</mo><mrow id="S2.E5.m1.3.3.3.3.1.1.1.1" xref="S2.E5.m1.3.3.3.3.1.1.1.2.cmml"><mi id="S2.E5.m1.1.1.1.1" xref="S2.E5.m1.1.1.1.1.cmml">e</mi><mo id="S2.E5.m1.3.3.3.3.1.1.1.1.2" lspace="0.170em" rspace="0.337em" xref="S2.E5.m1.3.3.3.3.1.1.1.2.cmml">;</mo><msup id="S2.E5.m1.3.3.3.3.1.1.1.1.1" xref="S2.E5.m1.3.3.3.3.1.1.1.1.1.cmml"><mi id="S2.E5.m1.3.3.3.3.1.1.1.1.1.2" xref="S2.E5.m1.3.3.3.3.1.1.1.1.1.2.cmml">θ</mi><mi id="S2.E5.m1.3.3.3.3.1.1.1.1.1.3" xref="S2.E5.m1.3.3.3.3.1.1.1.1.1.3.cmml">r</mi></msup></mrow></mrow><mo id="S2.E5.m1.3.3.3.3.1.3" stretchy="false" xref="S2.E5.m1.3.3.3.3.1.1.cmml">)</mo></mrow><mo id="S2.E5.m1.3.3.3.4a" lspace="0.170em" xref="S2.E5.m1.3.3.3.4.cmml">⁢</mo><mi id="S2.E5.m1.3.3.3.6" xref="S2.E5.m1.3.3.3.6.cmml">p</mi><mo id="S2.E5.m1.3.3.3.4b" xref="S2.E5.m1.3.3.3.4.cmml">⁢</mo><mrow id="S2.E5.m1.3.3.3.7.2" xref="S2.E5.m1.3.3.3.cmml"><mo id="S2.E5.m1.3.3.3.7.2.1" stretchy="false" xref="S2.E5.m1.3.3.3.cmml">(</mo><mi id="S2.E5.m1.2.2.2.2" xref="S2.E5.m1.2.2.2.2.cmml">e</mi><mo id="S2.E5.m1.3.3.3.7.2.2" stretchy="false" xref="S2.E5.m1.3.3.3.cmml">)</mo></mrow></mrow><mrow id="S2.E5.m1.6.6.6" xref="S2.E5.m1.6.6.6.cmml"><msubsup id="S2.E5.m1.6.6.6.4" xref="S2.E5.m1.6.6.6.4.cmml"><mo id="S2.E5.m1.6.6.6.4.2.2" xref="S2.E5.m1.6.6.6.4.2.2.cmml">∑</mo><mrow id="S2.E5.m1.6.6.6.4.2.3" xref="S2.E5.m1.6.6.6.4.2.3.cmml"><mi id="S2.E5.m1.6.6.6.4.2.3.2" xref="S2.E5.m1.6.6.6.4.2.3.2.cmml">i</mi><mo id="S2.E5.m1.6.6.6.4.2.3.1" xref="S2.E5.m1.6.6.6.4.2.3.1.cmml">=</mo><mn id="S2.E5.m1.6.6.6.4.2.3.3" xref="S2.E5.m1.6.6.6.4.2.3.3.cmml">1</mn></mrow><mi id="S2.E5.m1.6.6.6.4.3" xref="S2.E5.m1.6.6.6.4.3.cmml">E</mi></msubsup><mrow id="S2.E5.m1.6.6.6.3" xref="S2.E5.m1.6.6.6.3.cmml"><mi id="S2.E5.m1.6.6.6.3.3" xref="S2.E5.m1.6.6.6.3.3.cmml">p</mi><mo id="S2.E5.m1.6.6.6.3.2" xref="S2.E5.m1.6.6.6.3.2.cmml">⁢</mo><mrow id="S2.E5.m1.6.6.6.3.1.1" xref="S2.E5.m1.6.6.6.3.1.1.1.cmml"><mo id="S2.E5.m1.6.6.6.3.1.1.2" stretchy="false" xref="S2.E5.m1.6.6.6.3.1.1.1.cmml">(</mo><mrow id="S2.E5.m1.6.6.6.3.1.1.1" xref="S2.E5.m1.6.6.6.3.1.1.1.cmml"><msub id="S2.E5.m1.6.6.6.3.1.1.1.3" xref="S2.E5.m1.6.6.6.3.1.1.1.3.cmml"><mi id="S2.E5.m1.6.6.6.3.1.1.1.3.2" xref="S2.E5.m1.6.6.6.3.1.1.1.3.2.cmml">𝐱</mi><mrow id="S2.E5.m1.6.6.6.3.1.1.1.3.3" xref="S2.E5.m1.6.6.6.3.1.1.1.3.3.cmml"><mn id="S2.E5.m1.6.6.6.3.1.1.1.3.3.2" xref="S2.E5.m1.6.6.6.3.1.1.1.3.3.2.cmml">1</mn><mo id="S2.E5.m1.6.6.6.3.1.1.1.3.3.1" lspace="0.278em" rspace="0.278em" xref="S2.E5.m1.6.6.6.3.1.1.1.3.3.1.cmml">:</mo><mi id="S2.E5.m1.6.6.6.3.1.1.1.3.3.3" xref="S2.E5.m1.6.6.6.3.1.1.1.3.3.3.cmml">s</mi></mrow></msub><mo id="S2.E5.m1.6.6.6.3.1.1.1.2" xref="S2.E5.m1.6.6.6.3.1.1.1.2.cmml">∣</mo><mrow id="S2.E5.m1.6.6.6.3.1.1.1.1.1" xref="S2.E5.m1.6.6.6.3.1.1.1.1.2.cmml"><mi id="S2.E5.m1.4.4.4.1" xref="S2.E5.m1.4.4.4.1.cmml">i</mi><mo id="S2.E5.m1.6.6.6.3.1.1.1.1.1.2" lspace="0.170em" rspace="0.337em" xref="S2.E5.m1.6.6.6.3.1.1.1.1.2.cmml">;</mo><msup id="S2.E5.m1.6.6.6.3.1.1.1.1.1.1" xref="S2.E5.m1.6.6.6.3.1.1.1.1.1.1.cmml"><mi id="S2.E5.m1.6.6.6.3.1.1.1.1.1.1.2" xref="S2.E5.m1.6.6.6.3.1.1.1.1.1.1.2.cmml">θ</mi><mi id="S2.E5.m1.6.6.6.3.1.1.1.1.1.1.3" xref="S2.E5.m1.6.6.6.3.1.1.1.1.1.1.3.cmml">r</mi></msup></mrow></mrow><mo id="S2.E5.m1.6.6.6.3.1.1.3" stretchy="false" xref="S2.E5.m1.6.6.6.3.1.1.1.cmml">)</mo></mrow><mo id="S2.E5.m1.6.6.6.3.2a" lspace="0.170em" xref="S2.E5.m1.6.6.6.3.2.cmml">⁢</mo><mi id="S2.E5.m1.6.6.6.3.4" xref="S2.E5.m1.6.6.6.3.4.cmml">p</mi><mo id="S2.E5.m1.6.6.6.3.2b" xref="S2.E5.m1.6.6.6.3.2.cmml">⁢</mo><mrow id="S2.E5.m1.6.6.6.3.5.2" xref="S2.E5.m1.6.6.6.3.cmml"><mo id="S2.E5.m1.6.6.6.3.5.2.1" stretchy="false" xref="S2.E5.m1.6.6.6.3.cmml">(</mo><mi id="S2.E5.m1.5.5.5.2" xref="S2.E5.m1.5.5.5.2.cmml">i</mi><mo id="S2.E5.m1.6.6.6.3.5.2.2" stretchy="false" xref="S2.E5.m1.6.6.6.3.cmml">)</mo></mrow></mrow></mrow></mfrac></mstyle></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E5.m1.6b"><apply id="S2.E5.m1.6.7.cmml" xref="S2.E5.m1.6.7"><eq id="S2.E5.m1.6.7.1.cmml" xref="S2.E5.m1.6.7.1"></eq><csymbol cd="latexml" id="S2.E5.m1.6.7.2.cmml" xref="S2.E5.m1.6.7.2">absent</csymbol><apply id="S2.E5.m1.6.7.3.cmml" xref="S2.E5.m1.6.7.3"><apply id="S2.E5.m1.6.7.3.1.cmml" xref="S2.E5.m1.6.7.3.1"><csymbol cd="ambiguous" id="S2.E5.m1.6.7.3.1.1.cmml" xref="S2.E5.m1.6.7.3.1">subscript</csymbol><apply id="S2.E5.m1.6.7.3.1.2.cmml" xref="S2.E5.m1.6.7.3.1.2"><times id="S2.E5.m1.6.7.3.1.2.1.cmml" xref="S2.E5.m1.6.7.3.1.2.1"></times><ci id="S2.E5.m1.6.7.3.1.2.2.cmml" xref="S2.E5.m1.6.7.3.1.2.2">arg</ci><ci id="S2.E5.m1.6.7.3.1.2.3.cmml" xref="S2.E5.m1.6.7.3.1.2.3">max</ci></apply><ci id="S2.E5.m1.6.7.3.1.3.cmml" xref="S2.E5.m1.6.7.3.1.3">𝑒</ci></apply><apply id="S2.E5.m1.6.6.cmml" xref="S2.E5.m1.6.6"><divide id="S2.E5.m1.6.6.7.cmml" xref="S2.E5.m1.6.6"></divide><apply id="S2.E5.m1.3.3.3.cmml" xref="S2.E5.m1.3.3.3"><times id="S2.E5.m1.3.3.3.4.cmml" xref="S2.E5.m1.3.3.3.4"></times><ci id="S2.E5.m1.3.3.3.5.cmml" xref="S2.E5.m1.3.3.3.5">𝑝</ci><apply id="S2.E5.m1.3.3.3.3.1.1.cmml" xref="S2.E5.m1.3.3.3.3.1"><csymbol cd="latexml" id="S2.E5.m1.3.3.3.3.1.1.2.cmml" xref="S2.E5.m1.3.3.3.3.1.1.2">conditional</csymbol><apply id="S2.E5.m1.3.3.3.3.1.1.3.cmml" xref="S2.E5.m1.3.3.3.3.1.1.3"><csymbol cd="ambiguous" id="S2.E5.m1.3.3.3.3.1.1.3.1.cmml" xref="S2.E5.m1.3.3.3.3.1.1.3">subscript</csymbol><ci id="S2.E5.m1.3.3.3.3.1.1.3.2.cmml" xref="S2.E5.m1.3.3.3.3.1.1.3.2">𝐱</ci><apply id="S2.E5.m1.3.3.3.3.1.1.3.3.cmml" xref="S2.E5.m1.3.3.3.3.1.1.3.3"><ci id="S2.E5.m1.3.3.3.3.1.1.3.3.1.cmml" xref="S2.E5.m1.3.3.3.3.1.1.3.3.1">:</ci><cn id="S2.E5.m1.3.3.3.3.1.1.3.3.2.cmml" type="integer" xref="S2.E5.m1.3.3.3.3.1.1.3.3.2">1</cn><ci id="S2.E5.m1.3.3.3.3.1.1.3.3.3.cmml" xref="S2.E5.m1.3.3.3.3.1.1.3.3.3">𝑠</ci></apply></apply><list id="S2.E5.m1.3.3.3.3.1.1.1.2.cmml" xref="S2.E5.m1.3.3.3.3.1.1.1.1"><ci id="S2.E5.m1.1.1.1.1.cmml" xref="S2.E5.m1.1.1.1.1">𝑒</ci><apply id="S2.E5.m1.3.3.3.3.1.1.1.1.1.cmml" xref="S2.E5.m1.3.3.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E5.m1.3.3.3.3.1.1.1.1.1.1.cmml" xref="S2.E5.m1.3.3.3.3.1.1.1.1.1">superscript</csymbol><ci id="S2.E5.m1.3.3.3.3.1.1.1.1.1.2.cmml" xref="S2.E5.m1.3.3.3.3.1.1.1.1.1.2">𝜃</ci><ci id="S2.E5.m1.3.3.3.3.1.1.1.1.1.3.cmml" xref="S2.E5.m1.3.3.3.3.1.1.1.1.1.3">𝑟</ci></apply></list></apply><ci id="S2.E5.m1.3.3.3.6.cmml" xref="S2.E5.m1.3.3.3.6">𝑝</ci><ci id="S2.E5.m1.2.2.2.2.cmml" xref="S2.E5.m1.2.2.2.2">𝑒</ci></apply><apply id="S2.E5.m1.6.6.6.cmml" xref="S2.E5.m1.6.6.6"><apply id="S2.E5.m1.6.6.6.4.cmml" xref="S2.E5.m1.6.6.6.4"><csymbol cd="ambiguous" id="S2.E5.m1.6.6.6.4.1.cmml" xref="S2.E5.m1.6.6.6.4">superscript</csymbol><apply id="S2.E5.m1.6.6.6.4.2.cmml" xref="S2.E5.m1.6.6.6.4"><csymbol cd="ambiguous" id="S2.E5.m1.6.6.6.4.2.1.cmml" xref="S2.E5.m1.6.6.6.4">subscript</csymbol><sum id="S2.E5.m1.6.6.6.4.2.2.cmml" xref="S2.E5.m1.6.6.6.4.2.2"></sum><apply id="S2.E5.m1.6.6.6.4.2.3.cmml" xref="S2.E5.m1.6.6.6.4.2.3"><eq id="S2.E5.m1.6.6.6.4.2.3.1.cmml" xref="S2.E5.m1.6.6.6.4.2.3.1"></eq><ci id="S2.E5.m1.6.6.6.4.2.3.2.cmml" xref="S2.E5.m1.6.6.6.4.2.3.2">𝑖</ci><cn id="S2.E5.m1.6.6.6.4.2.3.3.cmml" type="integer" xref="S2.E5.m1.6.6.6.4.2.3.3">1</cn></apply></apply><ci id="S2.E5.m1.6.6.6.4.3.cmml" xref="S2.E5.m1.6.6.6.4.3">𝐸</ci></apply><apply id="S2.E5.m1.6.6.6.3.cmml" xref="S2.E5.m1.6.6.6.3"><times id="S2.E5.m1.6.6.6.3.2.cmml" xref="S2.E5.m1.6.6.6.3.2"></times><ci id="S2.E5.m1.6.6.6.3.3.cmml" xref="S2.E5.m1.6.6.6.3.3">𝑝</ci><apply id="S2.E5.m1.6.6.6.3.1.1.1.cmml" xref="S2.E5.m1.6.6.6.3.1.1"><csymbol cd="latexml" id="S2.E5.m1.6.6.6.3.1.1.1.2.cmml" xref="S2.E5.m1.6.6.6.3.1.1.1.2">conditional</csymbol><apply id="S2.E5.m1.6.6.6.3.1.1.1.3.cmml" xref="S2.E5.m1.6.6.6.3.1.1.1.3"><csymbol cd="ambiguous" id="S2.E5.m1.6.6.6.3.1.1.1.3.1.cmml" xref="S2.E5.m1.6.6.6.3.1.1.1.3">subscript</csymbol><ci id="S2.E5.m1.6.6.6.3.1.1.1.3.2.cmml" xref="S2.E5.m1.6.6.6.3.1.1.1.3.2">𝐱</ci><apply id="S2.E5.m1.6.6.6.3.1.1.1.3.3.cmml" xref="S2.E5.m1.6.6.6.3.1.1.1.3.3"><ci id="S2.E5.m1.6.6.6.3.1.1.1.3.3.1.cmml" xref="S2.E5.m1.6.6.6.3.1.1.1.3.3.1">:</ci><cn id="S2.E5.m1.6.6.6.3.1.1.1.3.3.2.cmml" type="integer" xref="S2.E5.m1.6.6.6.3.1.1.1.3.3.2">1</cn><ci id="S2.E5.m1.6.6.6.3.1.1.1.3.3.3.cmml" xref="S2.E5.m1.6.6.6.3.1.1.1.3.3.3">𝑠</ci></apply></apply><list id="S2.E5.m1.6.6.6.3.1.1.1.1.2.cmml" xref="S2.E5.m1.6.6.6.3.1.1.1.1.1"><ci id="S2.E5.m1.4.4.4.1.cmml" xref="S2.E5.m1.4.4.4.1">𝑖</ci><apply id="S2.E5.m1.6.6.6.3.1.1.1.1.1.1.cmml" xref="S2.E5.m1.6.6.6.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E5.m1.6.6.6.3.1.1.1.1.1.1.1.cmml" xref="S2.E5.m1.6.6.6.3.1.1.1.1.1.1">superscript</csymbol><ci id="S2.E5.m1.6.6.6.3.1.1.1.1.1.1.2.cmml" xref="S2.E5.m1.6.6.6.3.1.1.1.1.1.1.2">𝜃</ci><ci id="S2.E5.m1.6.6.6.3.1.1.1.1.1.1.3.cmml" xref="S2.E5.m1.6.6.6.3.1.1.1.1.1.1.3">𝑟</ci></apply></list></apply><ci id="S2.E5.m1.6.6.6.3.4.cmml" xref="S2.E5.m1.6.6.6.3.4">𝑝</ci><ci id="S2.E5.m1.5.5.5.2.cmml" xref="S2.E5.m1.5.5.5.2">𝑖</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E5.m1.6c">\displaystyle=\operatorname*{arg\,max}_{e}\frac{p(\mathbf{x}_{1:s}\mid e\,;\,%
\theta^{r})\,p(e)}{\sum_{i=1}^{E}p(\mathbf{x}_{1:s}\mid i\,;\,\theta^{r})\,p(i)}</annotation><annotation encoding="application/x-llamapun" id="S2.E5.m1.6d">= start_OPERATOR roman_arg roman_max end_OPERATOR start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT divide start_ARG italic_p ( bold_x start_POSTSUBSCRIPT 1 : italic_s end_POSTSUBSCRIPT ∣ italic_e ; italic_θ start_POSTSUPERSCRIPT italic_r end_POSTSUPERSCRIPT ) italic_p ( italic_e ) end_ARG start_ARG ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_E end_POSTSUPERSCRIPT italic_p ( bold_x start_POSTSUBSCRIPT 1 : italic_s end_POSTSUBSCRIPT ∣ italic_i ; italic_θ start_POSTSUPERSCRIPT italic_r end_POSTSUPERSCRIPT ) italic_p ( italic_i ) end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
<tbody id="S2.E6"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\operatorname*{arg\,max}_{e}p(\mathbf{x}_{1:s}\mid e\,;\,\theta^%
{r})" class="ltx_Math" display="inline" id="S2.E6.m1.2"><semantics id="S2.E6.m1.2a"><mrow id="S2.E6.m1.2.2" xref="S2.E6.m1.2.2.cmml"><mi id="S2.E6.m1.2.2.3" xref="S2.E6.m1.2.2.3.cmml"></mi><mo id="S2.E6.m1.2.2.2" xref="S2.E6.m1.2.2.2.cmml">=</mo><mrow id="S2.E6.m1.2.2.1" xref="S2.E6.m1.2.2.1.cmml"><mrow id="S2.E6.m1.2.2.1.3" xref="S2.E6.m1.2.2.1.3.cmml"><munder id="S2.E6.m1.2.2.1.3.1" xref="S2.E6.m1.2.2.1.3.1.cmml"><mrow id="S2.E6.m1.2.2.1.3.1.2" xref="S2.E6.m1.2.2.1.3.1.2.cmml"><mi id="S2.E6.m1.2.2.1.3.1.2.2" xref="S2.E6.m1.2.2.1.3.1.2.2.cmml">arg</mi><mo id="S2.E6.m1.2.2.1.3.1.2.1" lspace="0.170em" xref="S2.E6.m1.2.2.1.3.1.2.1.cmml">⁢</mo><mi id="S2.E6.m1.2.2.1.3.1.2.3" xref="S2.E6.m1.2.2.1.3.1.2.3.cmml">max</mi></mrow><mi id="S2.E6.m1.2.2.1.3.1.3" xref="S2.E6.m1.2.2.1.3.1.3.cmml">e</mi></munder><mo id="S2.E6.m1.2.2.1.3a" xref="S2.E6.m1.2.2.1.3.cmml">⁡</mo><mi id="S2.E6.m1.2.2.1.3.2" xref="S2.E6.m1.2.2.1.3.2.cmml">p</mi></mrow><mo id="S2.E6.m1.2.2.1.2" xref="S2.E6.m1.2.2.1.2.cmml">⁢</mo><mrow id="S2.E6.m1.2.2.1.1.1" xref="S2.E6.m1.2.2.1.1.1.1.cmml"><mo id="S2.E6.m1.2.2.1.1.1.2" stretchy="false" xref="S2.E6.m1.2.2.1.1.1.1.cmml">(</mo><mrow id="S2.E6.m1.2.2.1.1.1.1" xref="S2.E6.m1.2.2.1.1.1.1.cmml"><msub id="S2.E6.m1.2.2.1.1.1.1.3" xref="S2.E6.m1.2.2.1.1.1.1.3.cmml"><mi id="S2.E6.m1.2.2.1.1.1.1.3.2" xref="S2.E6.m1.2.2.1.1.1.1.3.2.cmml">𝐱</mi><mrow id="S2.E6.m1.2.2.1.1.1.1.3.3" xref="S2.E6.m1.2.2.1.1.1.1.3.3.cmml"><mn id="S2.E6.m1.2.2.1.1.1.1.3.3.2" xref="S2.E6.m1.2.2.1.1.1.1.3.3.2.cmml">1</mn><mo id="S2.E6.m1.2.2.1.1.1.1.3.3.1" lspace="0.278em" rspace="0.278em" xref="S2.E6.m1.2.2.1.1.1.1.3.3.1.cmml">:</mo><mi id="S2.E6.m1.2.2.1.1.1.1.3.3.3" xref="S2.E6.m1.2.2.1.1.1.1.3.3.3.cmml">s</mi></mrow></msub><mo id="S2.E6.m1.2.2.1.1.1.1.2" xref="S2.E6.m1.2.2.1.1.1.1.2.cmml">∣</mo><mrow id="S2.E6.m1.2.2.1.1.1.1.1.1" xref="S2.E6.m1.2.2.1.1.1.1.1.2.cmml"><mi id="S2.E6.m1.1.1" xref="S2.E6.m1.1.1.cmml">e</mi><mo id="S2.E6.m1.2.2.1.1.1.1.1.1.2" lspace="0.170em" rspace="0.337em" xref="S2.E6.m1.2.2.1.1.1.1.1.2.cmml">;</mo><msup id="S2.E6.m1.2.2.1.1.1.1.1.1.1" xref="S2.E6.m1.2.2.1.1.1.1.1.1.1.cmml"><mi id="S2.E6.m1.2.2.1.1.1.1.1.1.1.2" xref="S2.E6.m1.2.2.1.1.1.1.1.1.1.2.cmml">θ</mi><mi id="S2.E6.m1.2.2.1.1.1.1.1.1.1.3" xref="S2.E6.m1.2.2.1.1.1.1.1.1.1.3.cmml">r</mi></msup></mrow></mrow><mo id="S2.E6.m1.2.2.1.1.1.3" stretchy="false" xref="S2.E6.m1.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E6.m1.2b"><apply id="S2.E6.m1.2.2.cmml" xref="S2.E6.m1.2.2"><eq id="S2.E6.m1.2.2.2.cmml" xref="S2.E6.m1.2.2.2"></eq><csymbol cd="latexml" id="S2.E6.m1.2.2.3.cmml" xref="S2.E6.m1.2.2.3">absent</csymbol><apply id="S2.E6.m1.2.2.1.cmml" xref="S2.E6.m1.2.2.1"><times id="S2.E6.m1.2.2.1.2.cmml" xref="S2.E6.m1.2.2.1.2"></times><apply id="S2.E6.m1.2.2.1.3.cmml" xref="S2.E6.m1.2.2.1.3"><apply id="S2.E6.m1.2.2.1.3.1.cmml" xref="S2.E6.m1.2.2.1.3.1"><csymbol cd="ambiguous" id="S2.E6.m1.2.2.1.3.1.1.cmml" xref="S2.E6.m1.2.2.1.3.1">subscript</csymbol><apply id="S2.E6.m1.2.2.1.3.1.2.cmml" xref="S2.E6.m1.2.2.1.3.1.2"><times id="S2.E6.m1.2.2.1.3.1.2.1.cmml" xref="S2.E6.m1.2.2.1.3.1.2.1"></times><ci id="S2.E6.m1.2.2.1.3.1.2.2.cmml" xref="S2.E6.m1.2.2.1.3.1.2.2">arg</ci><ci id="S2.E6.m1.2.2.1.3.1.2.3.cmml" xref="S2.E6.m1.2.2.1.3.1.2.3">max</ci></apply><ci id="S2.E6.m1.2.2.1.3.1.3.cmml" xref="S2.E6.m1.2.2.1.3.1.3">𝑒</ci></apply><ci id="S2.E6.m1.2.2.1.3.2.cmml" xref="S2.E6.m1.2.2.1.3.2">𝑝</ci></apply><apply id="S2.E6.m1.2.2.1.1.1.1.cmml" xref="S2.E6.m1.2.2.1.1.1"><csymbol cd="latexml" id="S2.E6.m1.2.2.1.1.1.1.2.cmml" xref="S2.E6.m1.2.2.1.1.1.1.2">conditional</csymbol><apply id="S2.E6.m1.2.2.1.1.1.1.3.cmml" xref="S2.E6.m1.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E6.m1.2.2.1.1.1.1.3.1.cmml" xref="S2.E6.m1.2.2.1.1.1.1.3">subscript</csymbol><ci id="S2.E6.m1.2.2.1.1.1.1.3.2.cmml" xref="S2.E6.m1.2.2.1.1.1.1.3.2">𝐱</ci><apply id="S2.E6.m1.2.2.1.1.1.1.3.3.cmml" xref="S2.E6.m1.2.2.1.1.1.1.3.3"><ci id="S2.E6.m1.2.2.1.1.1.1.3.3.1.cmml" xref="S2.E6.m1.2.2.1.1.1.1.3.3.1">:</ci><cn id="S2.E6.m1.2.2.1.1.1.1.3.3.2.cmml" type="integer" xref="S2.E6.m1.2.2.1.1.1.1.3.3.2">1</cn><ci id="S2.E6.m1.2.2.1.1.1.1.3.3.3.cmml" xref="S2.E6.m1.2.2.1.1.1.1.3.3.3">𝑠</ci></apply></apply><list id="S2.E6.m1.2.2.1.1.1.1.1.2.cmml" xref="S2.E6.m1.2.2.1.1.1.1.1.1"><ci id="S2.E6.m1.1.1.cmml" xref="S2.E6.m1.1.1">𝑒</ci><apply id="S2.E6.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S2.E6.m1.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E6.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S2.E6.m1.2.2.1.1.1.1.1.1.1">superscript</csymbol><ci id="S2.E6.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="S2.E6.m1.2.2.1.1.1.1.1.1.1.2">𝜃</ci><ci id="S2.E6.m1.2.2.1.1.1.1.1.1.1.3.cmml" xref="S2.E6.m1.2.2.1.1.1.1.1.1.1.3">𝑟</ci></apply></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E6.m1.2c">\displaystyle=\operatorname*{arg\,max}_{e}p(\mathbf{x}_{1:s}\mid e\,;\,\theta^%
{r})</annotation><annotation encoding="application/x-llamapun" id="S2.E6.m1.2d">= start_OPERATOR roman_arg roman_max end_OPERATOR start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT italic_p ( bold_x start_POSTSUBSCRIPT 1 : italic_s end_POSTSUBSCRIPT ∣ italic_e ; italic_θ start_POSTSUPERSCRIPT italic_r end_POSTSUPERSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
<tbody id="S2.E7"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\operatorname*{arg\,max}_{e}p(\mathbf{x}_{1:s}\mid\theta^{r,e})\,," class="ltx_Math" display="inline" id="S2.E7.m1.3"><semantics id="S2.E7.m1.3a"><mrow id="S2.E7.m1.3.3.1" xref="S2.E7.m1.3.3.1.1.cmml"><mrow id="S2.E7.m1.3.3.1.1" xref="S2.E7.m1.3.3.1.1.cmml"><mi id="S2.E7.m1.3.3.1.1.3" xref="S2.E7.m1.3.3.1.1.3.cmml"></mi><mo id="S2.E7.m1.3.3.1.1.2" xref="S2.E7.m1.3.3.1.1.2.cmml">=</mo><mrow id="S2.E7.m1.3.3.1.1.1" xref="S2.E7.m1.3.3.1.1.1.cmml"><mrow id="S2.E7.m1.3.3.1.1.1.3" xref="S2.E7.m1.3.3.1.1.1.3.cmml"><munder id="S2.E7.m1.3.3.1.1.1.3.1" xref="S2.E7.m1.3.3.1.1.1.3.1.cmml"><mrow id="S2.E7.m1.3.3.1.1.1.3.1.2" xref="S2.E7.m1.3.3.1.1.1.3.1.2.cmml"><mi id="S2.E7.m1.3.3.1.1.1.3.1.2.2" xref="S2.E7.m1.3.3.1.1.1.3.1.2.2.cmml">arg</mi><mo id="S2.E7.m1.3.3.1.1.1.3.1.2.1" lspace="0.170em" xref="S2.E7.m1.3.3.1.1.1.3.1.2.1.cmml">⁢</mo><mi id="S2.E7.m1.3.3.1.1.1.3.1.2.3" xref="S2.E7.m1.3.3.1.1.1.3.1.2.3.cmml">max</mi></mrow><mi id="S2.E7.m1.3.3.1.1.1.3.1.3" xref="S2.E7.m1.3.3.1.1.1.3.1.3.cmml">e</mi></munder><mo id="S2.E7.m1.3.3.1.1.1.3a" xref="S2.E7.m1.3.3.1.1.1.3.cmml">⁡</mo><mi id="S2.E7.m1.3.3.1.1.1.3.2" xref="S2.E7.m1.3.3.1.1.1.3.2.cmml">p</mi></mrow><mo id="S2.E7.m1.3.3.1.1.1.2" xref="S2.E7.m1.3.3.1.1.1.2.cmml">⁢</mo><mrow id="S2.E7.m1.3.3.1.1.1.1.1" xref="S2.E7.m1.3.3.1.1.1.1.1.1.cmml"><mo id="S2.E7.m1.3.3.1.1.1.1.1.2" stretchy="false" xref="S2.E7.m1.3.3.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E7.m1.3.3.1.1.1.1.1.1" xref="S2.E7.m1.3.3.1.1.1.1.1.1.cmml"><msub id="S2.E7.m1.3.3.1.1.1.1.1.1.2" xref="S2.E7.m1.3.3.1.1.1.1.1.1.2.cmml"><mi id="S2.E7.m1.3.3.1.1.1.1.1.1.2.2" xref="S2.E7.m1.3.3.1.1.1.1.1.1.2.2.cmml">𝐱</mi><mrow id="S2.E7.m1.3.3.1.1.1.1.1.1.2.3" xref="S2.E7.m1.3.3.1.1.1.1.1.1.2.3.cmml"><mn id="S2.E7.m1.3.3.1.1.1.1.1.1.2.3.2" xref="S2.E7.m1.3.3.1.1.1.1.1.1.2.3.2.cmml">1</mn><mo id="S2.E7.m1.3.3.1.1.1.1.1.1.2.3.1" lspace="0.278em" rspace="0.278em" xref="S2.E7.m1.3.3.1.1.1.1.1.1.2.3.1.cmml">:</mo><mi id="S2.E7.m1.3.3.1.1.1.1.1.1.2.3.3" xref="S2.E7.m1.3.3.1.1.1.1.1.1.2.3.3.cmml">s</mi></mrow></msub><mo id="S2.E7.m1.3.3.1.1.1.1.1.1.1" xref="S2.E7.m1.3.3.1.1.1.1.1.1.1.cmml">∣</mo><msup id="S2.E7.m1.3.3.1.1.1.1.1.1.3" xref="S2.E7.m1.3.3.1.1.1.1.1.1.3.cmml"><mi id="S2.E7.m1.3.3.1.1.1.1.1.1.3.2" xref="S2.E7.m1.3.3.1.1.1.1.1.1.3.2.cmml">θ</mi><mrow id="S2.E7.m1.2.2.2.4" xref="S2.E7.m1.2.2.2.3.cmml"><mi id="S2.E7.m1.1.1.1.1" xref="S2.E7.m1.1.1.1.1.cmml">r</mi><mo id="S2.E7.m1.2.2.2.4.1" xref="S2.E7.m1.2.2.2.3.cmml">,</mo><mi id="S2.E7.m1.2.2.2.2" xref="S2.E7.m1.2.2.2.2.cmml">e</mi></mrow></msup></mrow><mo id="S2.E7.m1.3.3.1.1.1.1.1.3" rspace="0.170em" stretchy="false" xref="S2.E7.m1.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E7.m1.3.3.1.2" xref="S2.E7.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E7.m1.3b"><apply id="S2.E7.m1.3.3.1.1.cmml" xref="S2.E7.m1.3.3.1"><eq id="S2.E7.m1.3.3.1.1.2.cmml" xref="S2.E7.m1.3.3.1.1.2"></eq><csymbol cd="latexml" id="S2.E7.m1.3.3.1.1.3.cmml" xref="S2.E7.m1.3.3.1.1.3">absent</csymbol><apply id="S2.E7.m1.3.3.1.1.1.cmml" xref="S2.E7.m1.3.3.1.1.1"><times id="S2.E7.m1.3.3.1.1.1.2.cmml" xref="S2.E7.m1.3.3.1.1.1.2"></times><apply id="S2.E7.m1.3.3.1.1.1.3.cmml" xref="S2.E7.m1.3.3.1.1.1.3"><apply id="S2.E7.m1.3.3.1.1.1.3.1.cmml" xref="S2.E7.m1.3.3.1.1.1.3.1"><csymbol cd="ambiguous" id="S2.E7.m1.3.3.1.1.1.3.1.1.cmml" xref="S2.E7.m1.3.3.1.1.1.3.1">subscript</csymbol><apply id="S2.E7.m1.3.3.1.1.1.3.1.2.cmml" xref="S2.E7.m1.3.3.1.1.1.3.1.2"><times id="S2.E7.m1.3.3.1.1.1.3.1.2.1.cmml" xref="S2.E7.m1.3.3.1.1.1.3.1.2.1"></times><ci id="S2.E7.m1.3.3.1.1.1.3.1.2.2.cmml" xref="S2.E7.m1.3.3.1.1.1.3.1.2.2">arg</ci><ci id="S2.E7.m1.3.3.1.1.1.3.1.2.3.cmml" xref="S2.E7.m1.3.3.1.1.1.3.1.2.3">max</ci></apply><ci id="S2.E7.m1.3.3.1.1.1.3.1.3.cmml" xref="S2.E7.m1.3.3.1.1.1.3.1.3">𝑒</ci></apply><ci id="S2.E7.m1.3.3.1.1.1.3.2.cmml" xref="S2.E7.m1.3.3.1.1.1.3.2">𝑝</ci></apply><apply id="S2.E7.m1.3.3.1.1.1.1.1.1.cmml" xref="S2.E7.m1.3.3.1.1.1.1.1"><csymbol cd="latexml" id="S2.E7.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S2.E7.m1.3.3.1.1.1.1.1.1.1">conditional</csymbol><apply id="S2.E7.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S2.E7.m1.3.3.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E7.m1.3.3.1.1.1.1.1.1.2.1.cmml" xref="S2.E7.m1.3.3.1.1.1.1.1.1.2">subscript</csymbol><ci id="S2.E7.m1.3.3.1.1.1.1.1.1.2.2.cmml" xref="S2.E7.m1.3.3.1.1.1.1.1.1.2.2">𝐱</ci><apply id="S2.E7.m1.3.3.1.1.1.1.1.1.2.3.cmml" xref="S2.E7.m1.3.3.1.1.1.1.1.1.2.3"><ci id="S2.E7.m1.3.3.1.1.1.1.1.1.2.3.1.cmml" xref="S2.E7.m1.3.3.1.1.1.1.1.1.2.3.1">:</ci><cn id="S2.E7.m1.3.3.1.1.1.1.1.1.2.3.2.cmml" type="integer" xref="S2.E7.m1.3.3.1.1.1.1.1.1.2.3.2">1</cn><ci id="S2.E7.m1.3.3.1.1.1.1.1.1.2.3.3.cmml" xref="S2.E7.m1.3.3.1.1.1.1.1.1.2.3.3">𝑠</ci></apply></apply><apply id="S2.E7.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S2.E7.m1.3.3.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E7.m1.3.3.1.1.1.1.1.1.3.1.cmml" xref="S2.E7.m1.3.3.1.1.1.1.1.1.3">superscript</csymbol><ci id="S2.E7.m1.3.3.1.1.1.1.1.1.3.2.cmml" xref="S2.E7.m1.3.3.1.1.1.1.1.1.3.2">𝜃</ci><list id="S2.E7.m1.2.2.2.3.cmml" xref="S2.E7.m1.2.2.2.4"><ci id="S2.E7.m1.1.1.1.1.cmml" xref="S2.E7.m1.1.1.1.1">𝑟</ci><ci id="S2.E7.m1.2.2.2.2.cmml" xref="S2.E7.m1.2.2.2.2">𝑒</ci></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E7.m1.3c">\displaystyle=\operatorname*{arg\,max}_{e}p(\mathbf{x}_{1:s}\mid\theta^{r,e})\,,</annotation><annotation encoding="application/x-llamapun" id="S2.E7.m1.3d">= start_OPERATOR roman_arg roman_max end_OPERATOR start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT italic_p ( bold_x start_POSTSUBSCRIPT 1 : italic_s end_POSTSUBSCRIPT ∣ italic_θ start_POSTSUPERSCRIPT italic_r , italic_e end_POSTSUPERSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS2.SSS0.Px1.p1.8">where the likelihood <math alttext="p(\mathbf{x}_{1:s}\mid\theta^{r,e})" class="ltx_Math" display="inline" id="S2.SS2.SSS0.Px1.p1.3.m1.3"><semantics id="S2.SS2.SSS0.Px1.p1.3.m1.3a"><mrow id="S2.SS2.SSS0.Px1.p1.3.m1.3.3" xref="S2.SS2.SSS0.Px1.p1.3.m1.3.3.cmml"><mi id="S2.SS2.SSS0.Px1.p1.3.m1.3.3.3" xref="S2.SS2.SSS0.Px1.p1.3.m1.3.3.3.cmml">p</mi><mo id="S2.SS2.SSS0.Px1.p1.3.m1.3.3.2" xref="S2.SS2.SSS0.Px1.p1.3.m1.3.3.2.cmml">⁢</mo><mrow id="S2.SS2.SSS0.Px1.p1.3.m1.3.3.1.1" xref="S2.SS2.SSS0.Px1.p1.3.m1.3.3.1.1.1.cmml"><mo id="S2.SS2.SSS0.Px1.p1.3.m1.3.3.1.1.2" stretchy="false" xref="S2.SS2.SSS0.Px1.p1.3.m1.3.3.1.1.1.cmml">(</mo><mrow id="S2.SS2.SSS0.Px1.p1.3.m1.3.3.1.1.1" xref="S2.SS2.SSS0.Px1.p1.3.m1.3.3.1.1.1.cmml"><msub id="S2.SS2.SSS0.Px1.p1.3.m1.3.3.1.1.1.2" xref="S2.SS2.SSS0.Px1.p1.3.m1.3.3.1.1.1.2.cmml"><mi id="S2.SS2.SSS0.Px1.p1.3.m1.3.3.1.1.1.2.2" xref="S2.SS2.SSS0.Px1.p1.3.m1.3.3.1.1.1.2.2.cmml">𝐱</mi><mrow id="S2.SS2.SSS0.Px1.p1.3.m1.3.3.1.1.1.2.3" xref="S2.SS2.SSS0.Px1.p1.3.m1.3.3.1.1.1.2.3.cmml"><mn id="S2.SS2.SSS0.Px1.p1.3.m1.3.3.1.1.1.2.3.2" xref="S2.SS2.SSS0.Px1.p1.3.m1.3.3.1.1.1.2.3.2.cmml">1</mn><mo id="S2.SS2.SSS0.Px1.p1.3.m1.3.3.1.1.1.2.3.1" lspace="0.278em" rspace="0.278em" xref="S2.SS2.SSS0.Px1.p1.3.m1.3.3.1.1.1.2.3.1.cmml">:</mo><mi id="S2.SS2.SSS0.Px1.p1.3.m1.3.3.1.1.1.2.3.3" xref="S2.SS2.SSS0.Px1.p1.3.m1.3.3.1.1.1.2.3.3.cmml">s</mi></mrow></msub><mo id="S2.SS2.SSS0.Px1.p1.3.m1.3.3.1.1.1.1" xref="S2.SS2.SSS0.Px1.p1.3.m1.3.3.1.1.1.1.cmml">∣</mo><msup id="S2.SS2.SSS0.Px1.p1.3.m1.3.3.1.1.1.3" xref="S2.SS2.SSS0.Px1.p1.3.m1.3.3.1.1.1.3.cmml"><mi id="S2.SS2.SSS0.Px1.p1.3.m1.3.3.1.1.1.3.2" xref="S2.SS2.SSS0.Px1.p1.3.m1.3.3.1.1.1.3.2.cmml">θ</mi><mrow id="S2.SS2.SSS0.Px1.p1.3.m1.2.2.2.4" xref="S2.SS2.SSS0.Px1.p1.3.m1.2.2.2.3.cmml"><mi id="S2.SS2.SSS0.Px1.p1.3.m1.1.1.1.1" xref="S2.SS2.SSS0.Px1.p1.3.m1.1.1.1.1.cmml">r</mi><mo id="S2.SS2.SSS0.Px1.p1.3.m1.2.2.2.4.1" xref="S2.SS2.SSS0.Px1.p1.3.m1.2.2.2.3.cmml">,</mo><mi id="S2.SS2.SSS0.Px1.p1.3.m1.2.2.2.2" xref="S2.SS2.SSS0.Px1.p1.3.m1.2.2.2.2.cmml">e</mi></mrow></msup></mrow><mo id="S2.SS2.SSS0.Px1.p1.3.m1.3.3.1.1.3" stretchy="false" xref="S2.SS2.SSS0.Px1.p1.3.m1.3.3.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS0.Px1.p1.3.m1.3b"><apply id="S2.SS2.SSS0.Px1.p1.3.m1.3.3.cmml" xref="S2.SS2.SSS0.Px1.p1.3.m1.3.3"><times id="S2.SS2.SSS0.Px1.p1.3.m1.3.3.2.cmml" xref="S2.SS2.SSS0.Px1.p1.3.m1.3.3.2"></times><ci id="S2.SS2.SSS0.Px1.p1.3.m1.3.3.3.cmml" xref="S2.SS2.SSS0.Px1.p1.3.m1.3.3.3">𝑝</ci><apply id="S2.SS2.SSS0.Px1.p1.3.m1.3.3.1.1.1.cmml" xref="S2.SS2.SSS0.Px1.p1.3.m1.3.3.1.1"><csymbol cd="latexml" id="S2.SS2.SSS0.Px1.p1.3.m1.3.3.1.1.1.1.cmml" xref="S2.SS2.SSS0.Px1.p1.3.m1.3.3.1.1.1.1">conditional</csymbol><apply id="S2.SS2.SSS0.Px1.p1.3.m1.3.3.1.1.1.2.cmml" xref="S2.SS2.SSS0.Px1.p1.3.m1.3.3.1.1.1.2"><csymbol cd="ambiguous" id="S2.SS2.SSS0.Px1.p1.3.m1.3.3.1.1.1.2.1.cmml" xref="S2.SS2.SSS0.Px1.p1.3.m1.3.3.1.1.1.2">subscript</csymbol><ci id="S2.SS2.SSS0.Px1.p1.3.m1.3.3.1.1.1.2.2.cmml" xref="S2.SS2.SSS0.Px1.p1.3.m1.3.3.1.1.1.2.2">𝐱</ci><apply id="S2.SS2.SSS0.Px1.p1.3.m1.3.3.1.1.1.2.3.cmml" xref="S2.SS2.SSS0.Px1.p1.3.m1.3.3.1.1.1.2.3"><ci id="S2.SS2.SSS0.Px1.p1.3.m1.3.3.1.1.1.2.3.1.cmml" xref="S2.SS2.SSS0.Px1.p1.3.m1.3.3.1.1.1.2.3.1">:</ci><cn id="S2.SS2.SSS0.Px1.p1.3.m1.3.3.1.1.1.2.3.2.cmml" type="integer" xref="S2.SS2.SSS0.Px1.p1.3.m1.3.3.1.1.1.2.3.2">1</cn><ci id="S2.SS2.SSS0.Px1.p1.3.m1.3.3.1.1.1.2.3.3.cmml" xref="S2.SS2.SSS0.Px1.p1.3.m1.3.3.1.1.1.2.3.3">𝑠</ci></apply></apply><apply id="S2.SS2.SSS0.Px1.p1.3.m1.3.3.1.1.1.3.cmml" xref="S2.SS2.SSS0.Px1.p1.3.m1.3.3.1.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.SSS0.Px1.p1.3.m1.3.3.1.1.1.3.1.cmml" xref="S2.SS2.SSS0.Px1.p1.3.m1.3.3.1.1.1.3">superscript</csymbol><ci id="S2.SS2.SSS0.Px1.p1.3.m1.3.3.1.1.1.3.2.cmml" xref="S2.SS2.SSS0.Px1.p1.3.m1.3.3.1.1.1.3.2">𝜃</ci><list id="S2.SS2.SSS0.Px1.p1.3.m1.2.2.2.3.cmml" xref="S2.SS2.SSS0.Px1.p1.3.m1.2.2.2.4"><ci id="S2.SS2.SSS0.Px1.p1.3.m1.1.1.1.1.cmml" xref="S2.SS2.SSS0.Px1.p1.3.m1.1.1.1.1">𝑟</ci><ci id="S2.SS2.SSS0.Px1.p1.3.m1.2.2.2.2.cmml" xref="S2.SS2.SSS0.Px1.p1.3.m1.2.2.2.2">𝑒</ci></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS0.Px1.p1.3.m1.3c">p(\mathbf{x}_{1:s}\mid\theta^{r,e})</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS0.Px1.p1.3.m1.3d">italic_p ( bold_x start_POSTSUBSCRIPT 1 : italic_s end_POSTSUBSCRIPT ∣ italic_θ start_POSTSUPERSCRIPT italic_r , italic_e end_POSTSUPERSCRIPT )</annotation></semantics></math> defines a routing language model attributed to the <math alttext="e" class="ltx_Math" display="inline" id="S2.SS2.SSS0.Px1.p1.4.m2.1"><semantics id="S2.SS2.SSS0.Px1.p1.4.m2.1a"><mi id="S2.SS2.SSS0.Px1.p1.4.m2.1.1" xref="S2.SS2.SSS0.Px1.p1.4.m2.1.1.cmml">e</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS0.Px1.p1.4.m2.1b"><ci id="S2.SS2.SSS0.Px1.p1.4.m2.1.1.cmml" xref="S2.SS2.SSS0.Px1.p1.4.m2.1.1">𝑒</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS0.Px1.p1.4.m2.1c">e</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS0.Px1.p1.4.m2.1d">italic_e</annotation></semantics></math>-th expert with <em class="ltx_emph ltx_font_italic" id="S2.SS2.SSS0.Px1.p1.8.1">independent</em> parameters <math alttext="\theta^{r,e}" class="ltx_Math" display="inline" id="S2.SS2.SSS0.Px1.p1.5.m3.2"><semantics id="S2.SS2.SSS0.Px1.p1.5.m3.2a"><msup id="S2.SS2.SSS0.Px1.p1.5.m3.2.3" xref="S2.SS2.SSS0.Px1.p1.5.m3.2.3.cmml"><mi id="S2.SS2.SSS0.Px1.p1.5.m3.2.3.2" xref="S2.SS2.SSS0.Px1.p1.5.m3.2.3.2.cmml">θ</mi><mrow id="S2.SS2.SSS0.Px1.p1.5.m3.2.2.2.4" xref="S2.SS2.SSS0.Px1.p1.5.m3.2.2.2.3.cmml"><mi id="S2.SS2.SSS0.Px1.p1.5.m3.1.1.1.1" xref="S2.SS2.SSS0.Px1.p1.5.m3.1.1.1.1.cmml">r</mi><mo id="S2.SS2.SSS0.Px1.p1.5.m3.2.2.2.4.1" xref="S2.SS2.SSS0.Px1.p1.5.m3.2.2.2.3.cmml">,</mo><mi id="S2.SS2.SSS0.Px1.p1.5.m3.2.2.2.2" xref="S2.SS2.SSS0.Px1.p1.5.m3.2.2.2.2.cmml">e</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS0.Px1.p1.5.m3.2b"><apply id="S2.SS2.SSS0.Px1.p1.5.m3.2.3.cmml" xref="S2.SS2.SSS0.Px1.p1.5.m3.2.3"><csymbol cd="ambiguous" id="S2.SS2.SSS0.Px1.p1.5.m3.2.3.1.cmml" xref="S2.SS2.SSS0.Px1.p1.5.m3.2.3">superscript</csymbol><ci id="S2.SS2.SSS0.Px1.p1.5.m3.2.3.2.cmml" xref="S2.SS2.SSS0.Px1.p1.5.m3.2.3.2">𝜃</ci><list id="S2.SS2.SSS0.Px1.p1.5.m3.2.2.2.3.cmml" xref="S2.SS2.SSS0.Px1.p1.5.m3.2.2.2.4"><ci id="S2.SS2.SSS0.Px1.p1.5.m3.1.1.1.1.cmml" xref="S2.SS2.SSS0.Px1.p1.5.m3.1.1.1.1">𝑟</ci><ci id="S2.SS2.SSS0.Px1.p1.5.m3.2.2.2.2.cmml" xref="S2.SS2.SSS0.Px1.p1.5.m3.2.2.2.2">𝑒</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS0.Px1.p1.5.m3.2c">\theta^{r,e}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS0.Px1.p1.5.m3.2d">italic_θ start_POSTSUPERSCRIPT italic_r , italic_e end_POSTSUPERSCRIPT</annotation></semantics></math>, and expert priors <math alttext="p(e)" class="ltx_Math" display="inline" id="S2.SS2.SSS0.Px1.p1.6.m4.1"><semantics id="S2.SS2.SSS0.Px1.p1.6.m4.1a"><mrow id="S2.SS2.SSS0.Px1.p1.6.m4.1.2" xref="S2.SS2.SSS0.Px1.p1.6.m4.1.2.cmml"><mi id="S2.SS2.SSS0.Px1.p1.6.m4.1.2.2" xref="S2.SS2.SSS0.Px1.p1.6.m4.1.2.2.cmml">p</mi><mo id="S2.SS2.SSS0.Px1.p1.6.m4.1.2.1" xref="S2.SS2.SSS0.Px1.p1.6.m4.1.2.1.cmml">⁢</mo><mrow id="S2.SS2.SSS0.Px1.p1.6.m4.1.2.3.2" xref="S2.SS2.SSS0.Px1.p1.6.m4.1.2.cmml"><mo id="S2.SS2.SSS0.Px1.p1.6.m4.1.2.3.2.1" stretchy="false" xref="S2.SS2.SSS0.Px1.p1.6.m4.1.2.cmml">(</mo><mi id="S2.SS2.SSS0.Px1.p1.6.m4.1.1" xref="S2.SS2.SSS0.Px1.p1.6.m4.1.1.cmml">e</mi><mo id="S2.SS2.SSS0.Px1.p1.6.m4.1.2.3.2.2" stretchy="false" xref="S2.SS2.SSS0.Px1.p1.6.m4.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS0.Px1.p1.6.m4.1b"><apply id="S2.SS2.SSS0.Px1.p1.6.m4.1.2.cmml" xref="S2.SS2.SSS0.Px1.p1.6.m4.1.2"><times id="S2.SS2.SSS0.Px1.p1.6.m4.1.2.1.cmml" xref="S2.SS2.SSS0.Px1.p1.6.m4.1.2.1"></times><ci id="S2.SS2.SSS0.Px1.p1.6.m4.1.2.2.cmml" xref="S2.SS2.SSS0.Px1.p1.6.m4.1.2.2">𝑝</ci><ci id="S2.SS2.SSS0.Px1.p1.6.m4.1.1.cmml" xref="S2.SS2.SSS0.Px1.p1.6.m4.1.1">𝑒</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS0.Px1.p1.6.m4.1c">p(e)</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS0.Px1.p1.6.m4.1d">italic_p ( italic_e )</annotation></semantics></math> are supposed to be uniform. So far, in our definition, there is nothing that prevents <math alttext="\theta^{r,e}=\theta^{e}" class="ltx_Math" display="inline" id="S2.SS2.SSS0.Px1.p1.7.m5.2"><semantics id="S2.SS2.SSS0.Px1.p1.7.m5.2a"><mrow id="S2.SS2.SSS0.Px1.p1.7.m5.2.3" xref="S2.SS2.SSS0.Px1.p1.7.m5.2.3.cmml"><msup id="S2.SS2.SSS0.Px1.p1.7.m5.2.3.2" xref="S2.SS2.SSS0.Px1.p1.7.m5.2.3.2.cmml"><mi id="S2.SS2.SSS0.Px1.p1.7.m5.2.3.2.2" xref="S2.SS2.SSS0.Px1.p1.7.m5.2.3.2.2.cmml">θ</mi><mrow id="S2.SS2.SSS0.Px1.p1.7.m5.2.2.2.4" xref="S2.SS2.SSS0.Px1.p1.7.m5.2.2.2.3.cmml"><mi id="S2.SS2.SSS0.Px1.p1.7.m5.1.1.1.1" xref="S2.SS2.SSS0.Px1.p1.7.m5.1.1.1.1.cmml">r</mi><mo id="S2.SS2.SSS0.Px1.p1.7.m5.2.2.2.4.1" xref="S2.SS2.SSS0.Px1.p1.7.m5.2.2.2.3.cmml">,</mo><mi id="S2.SS2.SSS0.Px1.p1.7.m5.2.2.2.2" xref="S2.SS2.SSS0.Px1.p1.7.m5.2.2.2.2.cmml">e</mi></mrow></msup><mo id="S2.SS2.SSS0.Px1.p1.7.m5.2.3.1" xref="S2.SS2.SSS0.Px1.p1.7.m5.2.3.1.cmml">=</mo><msup id="S2.SS2.SSS0.Px1.p1.7.m5.2.3.3" xref="S2.SS2.SSS0.Px1.p1.7.m5.2.3.3.cmml"><mi id="S2.SS2.SSS0.Px1.p1.7.m5.2.3.3.2" xref="S2.SS2.SSS0.Px1.p1.7.m5.2.3.3.2.cmml">θ</mi><mi id="S2.SS2.SSS0.Px1.p1.7.m5.2.3.3.3" xref="S2.SS2.SSS0.Px1.p1.7.m5.2.3.3.3.cmml">e</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS0.Px1.p1.7.m5.2b"><apply id="S2.SS2.SSS0.Px1.p1.7.m5.2.3.cmml" xref="S2.SS2.SSS0.Px1.p1.7.m5.2.3"><eq id="S2.SS2.SSS0.Px1.p1.7.m5.2.3.1.cmml" xref="S2.SS2.SSS0.Px1.p1.7.m5.2.3.1"></eq><apply id="S2.SS2.SSS0.Px1.p1.7.m5.2.3.2.cmml" xref="S2.SS2.SSS0.Px1.p1.7.m5.2.3.2"><csymbol cd="ambiguous" id="S2.SS2.SSS0.Px1.p1.7.m5.2.3.2.1.cmml" xref="S2.SS2.SSS0.Px1.p1.7.m5.2.3.2">superscript</csymbol><ci id="S2.SS2.SSS0.Px1.p1.7.m5.2.3.2.2.cmml" xref="S2.SS2.SSS0.Px1.p1.7.m5.2.3.2.2">𝜃</ci><list id="S2.SS2.SSS0.Px1.p1.7.m5.2.2.2.3.cmml" xref="S2.SS2.SSS0.Px1.p1.7.m5.2.2.2.4"><ci id="S2.SS2.SSS0.Px1.p1.7.m5.1.1.1.1.cmml" xref="S2.SS2.SSS0.Px1.p1.7.m5.1.1.1.1">𝑟</ci><ci id="S2.SS2.SSS0.Px1.p1.7.m5.2.2.2.2.cmml" xref="S2.SS2.SSS0.Px1.p1.7.m5.2.2.2.2">𝑒</ci></list></apply><apply id="S2.SS2.SSS0.Px1.p1.7.m5.2.3.3.cmml" xref="S2.SS2.SSS0.Px1.p1.7.m5.2.3.3"><csymbol cd="ambiguous" id="S2.SS2.SSS0.Px1.p1.7.m5.2.3.3.1.cmml" xref="S2.SS2.SSS0.Px1.p1.7.m5.2.3.3">superscript</csymbol><ci id="S2.SS2.SSS0.Px1.p1.7.m5.2.3.3.2.cmml" xref="S2.SS2.SSS0.Px1.p1.7.m5.2.3.3.2">𝜃</ci><ci id="S2.SS2.SSS0.Px1.p1.7.m5.2.3.3.3.cmml" xref="S2.SS2.SSS0.Px1.p1.7.m5.2.3.3.3">𝑒</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS0.Px1.p1.7.m5.2c">\theta^{r,e}=\theta^{e}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS0.Px1.p1.7.m5.2d">italic_θ start_POSTSUPERSCRIPT italic_r , italic_e end_POSTSUPERSCRIPT = italic_θ start_POSTSUPERSCRIPT italic_e end_POSTSUPERSCRIPT</annotation></semantics></math>, namely to use the experts themselves to implement the router. Interestingly, in that case selecting <math alttext="e^{\star}" class="ltx_Math" display="inline" id="S2.SS2.SSS0.Px1.p1.8.m6.1"><semantics id="S2.SS2.SSS0.Px1.p1.8.m6.1a"><msup id="S2.SS2.SSS0.Px1.p1.8.m6.1.1" xref="S2.SS2.SSS0.Px1.p1.8.m6.1.1.cmml"><mi id="S2.SS2.SSS0.Px1.p1.8.m6.1.1.2" xref="S2.SS2.SSS0.Px1.p1.8.m6.1.1.2.cmml">e</mi><mo id="S2.SS2.SSS0.Px1.p1.8.m6.1.1.3" xref="S2.SS2.SSS0.Px1.p1.8.m6.1.1.3.cmml">⋆</mo></msup><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS0.Px1.p1.8.m6.1b"><apply id="S2.SS2.SSS0.Px1.p1.8.m6.1.1.cmml" xref="S2.SS2.SSS0.Px1.p1.8.m6.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS0.Px1.p1.8.m6.1.1.1.cmml" xref="S2.SS2.SSS0.Px1.p1.8.m6.1.1">superscript</csymbol><ci id="S2.SS2.SSS0.Px1.p1.8.m6.1.1.2.cmml" xref="S2.SS2.SSS0.Px1.p1.8.m6.1.1.2">𝑒</ci><ci id="S2.SS2.SSS0.Px1.p1.8.m6.1.1.3.cmml" xref="S2.SS2.SSS0.Px1.p1.8.m6.1.1.3">⋆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS0.Px1.p1.8.m6.1c">e^{\star}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS0.Px1.p1.8.m6.1d">italic_e start_POSTSUPERSCRIPT ⋆ end_POSTSUPERSCRIPT</annotation></semantics></math> as above is intuitive because it amounts to selecting the best expert for a given sequence (in terms of log-likelihood).</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_paragraph" id="S2.SS2.SSS0.Px2">
<h5 class="ltx_title ltx_title_paragraph">Deriving a Practical Model</h5><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S2.SS2.SSS0.Px2.p1">
<p class="ltx_p" id="S2.SS2.SSS0.Px2.p1.1">In order for the above formulation to result in a model that is useful in practice, we have to solve the following main challenges. Firstly, we need to be able to route using a small prefix of the full sequence since in most real world applications we do not have access to a full sequence (e.g. in question answering we do not have the answer). Secondly, using the experts to implement the router results in a large computational overhead since we need to evaluate every single one of them, largely negating the benefits of the hard mixture of experts.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS2.SSS0.Px2.p2">
<p class="ltx_p" id="S2.SS2.SSS0.Px2.p2.1">We solve both of the above problems with the following two key ideas:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<ol class="ltx_enumerate" id="S2.I1">
<li class="ltx_item" id="S2.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span>
<div class="ltx_para" id="S2.I1.i1.p1">
<p class="ltx_p" id="S2.I1.i1.p1.1">We use a <em class="ltx_emph ltx_font_italic" id="S2.I1.i1.p1.1.1">short prefix</em> of length <math alttext="M" class="ltx_Math" display="inline" id="S2.I1.i1.p1.1.m1.1"><semantics id="S2.I1.i1.p1.1.m1.1a"><mi id="S2.I1.i1.p1.1.m1.1.1" xref="S2.I1.i1.p1.1.m1.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S2.I1.i1.p1.1.m1.1b"><ci id="S2.I1.i1.p1.1.m1.1.1.cmml" xref="S2.I1.i1.p1.1.m1.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i1.p1.1.m1.1c">M</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i1.p1.1.m1.1d">italic_M</annotation></semantics></math> to compute the score for each expert as follows:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equation ltx_eqn_table" id="S2.E8">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="p(e^{\star}\mid\mathbf{x}_{1:s})\approx p(e^{\star}\mid\mathbf{x}_{1:M})." class="ltx_Math" display="block" id="S2.E8.m1.1"><semantics id="S2.E8.m1.1a"><mrow id="S2.E8.m1.1.1.1" xref="S2.E8.m1.1.1.1.1.cmml"><mrow id="S2.E8.m1.1.1.1.1" xref="S2.E8.m1.1.1.1.1.cmml"><mrow id="S2.E8.m1.1.1.1.1.1" xref="S2.E8.m1.1.1.1.1.1.cmml"><mi id="S2.E8.m1.1.1.1.1.1.3" xref="S2.E8.m1.1.1.1.1.1.3.cmml">p</mi><mo id="S2.E8.m1.1.1.1.1.1.2" xref="S2.E8.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E8.m1.1.1.1.1.1.1.1" xref="S2.E8.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S2.E8.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="S2.E8.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E8.m1.1.1.1.1.1.1.1.1" xref="S2.E8.m1.1.1.1.1.1.1.1.1.cmml"><msup id="S2.E8.m1.1.1.1.1.1.1.1.1.2" xref="S2.E8.m1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S2.E8.m1.1.1.1.1.1.1.1.1.2.2" xref="S2.E8.m1.1.1.1.1.1.1.1.1.2.2.cmml">e</mi><mo id="S2.E8.m1.1.1.1.1.1.1.1.1.2.3" xref="S2.E8.m1.1.1.1.1.1.1.1.1.2.3.cmml">⋆</mo></msup><mo id="S2.E8.m1.1.1.1.1.1.1.1.1.1" xref="S2.E8.m1.1.1.1.1.1.1.1.1.1.cmml">∣</mo><msub id="S2.E8.m1.1.1.1.1.1.1.1.1.3" xref="S2.E8.m1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S2.E8.m1.1.1.1.1.1.1.1.1.3.2" xref="S2.E8.m1.1.1.1.1.1.1.1.1.3.2.cmml">𝐱</mi><mrow id="S2.E8.m1.1.1.1.1.1.1.1.1.3.3" xref="S2.E8.m1.1.1.1.1.1.1.1.1.3.3.cmml"><mn id="S2.E8.m1.1.1.1.1.1.1.1.1.3.3.2" xref="S2.E8.m1.1.1.1.1.1.1.1.1.3.3.2.cmml">1</mn><mo id="S2.E8.m1.1.1.1.1.1.1.1.1.3.3.1" lspace="0.278em" rspace="0.278em" xref="S2.E8.m1.1.1.1.1.1.1.1.1.3.3.1.cmml">:</mo><mi id="S2.E8.m1.1.1.1.1.1.1.1.1.3.3.3" xref="S2.E8.m1.1.1.1.1.1.1.1.1.3.3.3.cmml">s</mi></mrow></msub></mrow><mo id="S2.E8.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="S2.E8.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E8.m1.1.1.1.1.3" xref="S2.E8.m1.1.1.1.1.3.cmml">≈</mo><mrow id="S2.E8.m1.1.1.1.1.2" xref="S2.E8.m1.1.1.1.1.2.cmml"><mi id="S2.E8.m1.1.1.1.1.2.3" xref="S2.E8.m1.1.1.1.1.2.3.cmml">p</mi><mo id="S2.E8.m1.1.1.1.1.2.2" xref="S2.E8.m1.1.1.1.1.2.2.cmml">⁢</mo><mrow id="S2.E8.m1.1.1.1.1.2.1.1" xref="S2.E8.m1.1.1.1.1.2.1.1.1.cmml"><mo id="S2.E8.m1.1.1.1.1.2.1.1.2" stretchy="false" xref="S2.E8.m1.1.1.1.1.2.1.1.1.cmml">(</mo><mrow id="S2.E8.m1.1.1.1.1.2.1.1.1" xref="S2.E8.m1.1.1.1.1.2.1.1.1.cmml"><msup id="S2.E8.m1.1.1.1.1.2.1.1.1.2" xref="S2.E8.m1.1.1.1.1.2.1.1.1.2.cmml"><mi id="S2.E8.m1.1.1.1.1.2.1.1.1.2.2" xref="S2.E8.m1.1.1.1.1.2.1.1.1.2.2.cmml">e</mi><mo id="S2.E8.m1.1.1.1.1.2.1.1.1.2.3" xref="S2.E8.m1.1.1.1.1.2.1.1.1.2.3.cmml">⋆</mo></msup><mo id="S2.E8.m1.1.1.1.1.2.1.1.1.1" xref="S2.E8.m1.1.1.1.1.2.1.1.1.1.cmml">∣</mo><msub id="S2.E8.m1.1.1.1.1.2.1.1.1.3" xref="S2.E8.m1.1.1.1.1.2.1.1.1.3.cmml"><mi id="S2.E8.m1.1.1.1.1.2.1.1.1.3.2" xref="S2.E8.m1.1.1.1.1.2.1.1.1.3.2.cmml">𝐱</mi><mrow id="S2.E8.m1.1.1.1.1.2.1.1.1.3.3" xref="S2.E8.m1.1.1.1.1.2.1.1.1.3.3.cmml"><mn id="S2.E8.m1.1.1.1.1.2.1.1.1.3.3.2" xref="S2.E8.m1.1.1.1.1.2.1.1.1.3.3.2.cmml">1</mn><mo id="S2.E8.m1.1.1.1.1.2.1.1.1.3.3.1" lspace="0.278em" rspace="0.278em" xref="S2.E8.m1.1.1.1.1.2.1.1.1.3.3.1.cmml">:</mo><mi id="S2.E8.m1.1.1.1.1.2.1.1.1.3.3.3" xref="S2.E8.m1.1.1.1.1.2.1.1.1.3.3.3.cmml">M</mi></mrow></msub></mrow><mo id="S2.E8.m1.1.1.1.1.2.1.1.3" stretchy="false" xref="S2.E8.m1.1.1.1.1.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E8.m1.1.1.1.2" lspace="0em" xref="S2.E8.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E8.m1.1b"><apply id="S2.E8.m1.1.1.1.1.cmml" xref="S2.E8.m1.1.1.1"><approx id="S2.E8.m1.1.1.1.1.3.cmml" xref="S2.E8.m1.1.1.1.1.3"></approx><apply id="S2.E8.m1.1.1.1.1.1.cmml" xref="S2.E8.m1.1.1.1.1.1"><times id="S2.E8.m1.1.1.1.1.1.2.cmml" xref="S2.E8.m1.1.1.1.1.1.2"></times><ci id="S2.E8.m1.1.1.1.1.1.3.cmml" xref="S2.E8.m1.1.1.1.1.1.3">𝑝</ci><apply id="S2.E8.m1.1.1.1.1.1.1.1.1.cmml" xref="S2.E8.m1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.E8.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E8.m1.1.1.1.1.1.1.1.1.1">conditional</csymbol><apply id="S2.E8.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E8.m1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E8.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E8.m1.1.1.1.1.1.1.1.1.2">superscript</csymbol><ci id="S2.E8.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E8.m1.1.1.1.1.1.1.1.1.2.2">𝑒</ci><ci id="S2.E8.m1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E8.m1.1.1.1.1.1.1.1.1.2.3">⋆</ci></apply><apply id="S2.E8.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E8.m1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E8.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E8.m1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E8.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E8.m1.1.1.1.1.1.1.1.1.3.2">𝐱</ci><apply id="S2.E8.m1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S2.E8.m1.1.1.1.1.1.1.1.1.3.3"><ci id="S2.E8.m1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S2.E8.m1.1.1.1.1.1.1.1.1.3.3.1">:</ci><cn id="S2.E8.m1.1.1.1.1.1.1.1.1.3.3.2.cmml" type="integer" xref="S2.E8.m1.1.1.1.1.1.1.1.1.3.3.2">1</cn><ci id="S2.E8.m1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S2.E8.m1.1.1.1.1.1.1.1.1.3.3.3">𝑠</ci></apply></apply></apply></apply><apply id="S2.E8.m1.1.1.1.1.2.cmml" xref="S2.E8.m1.1.1.1.1.2"><times id="S2.E8.m1.1.1.1.1.2.2.cmml" xref="S2.E8.m1.1.1.1.1.2.2"></times><ci id="S2.E8.m1.1.1.1.1.2.3.cmml" xref="S2.E8.m1.1.1.1.1.2.3">𝑝</ci><apply id="S2.E8.m1.1.1.1.1.2.1.1.1.cmml" xref="S2.E8.m1.1.1.1.1.2.1.1"><csymbol cd="latexml" id="S2.E8.m1.1.1.1.1.2.1.1.1.1.cmml" xref="S2.E8.m1.1.1.1.1.2.1.1.1.1">conditional</csymbol><apply id="S2.E8.m1.1.1.1.1.2.1.1.1.2.cmml" xref="S2.E8.m1.1.1.1.1.2.1.1.1.2"><csymbol cd="ambiguous" id="S2.E8.m1.1.1.1.1.2.1.1.1.2.1.cmml" xref="S2.E8.m1.1.1.1.1.2.1.1.1.2">superscript</csymbol><ci id="S2.E8.m1.1.1.1.1.2.1.1.1.2.2.cmml" xref="S2.E8.m1.1.1.1.1.2.1.1.1.2.2">𝑒</ci><ci id="S2.E8.m1.1.1.1.1.2.1.1.1.2.3.cmml" xref="S2.E8.m1.1.1.1.1.2.1.1.1.2.3">⋆</ci></apply><apply id="S2.E8.m1.1.1.1.1.2.1.1.1.3.cmml" xref="S2.E8.m1.1.1.1.1.2.1.1.1.3"><csymbol cd="ambiguous" id="S2.E8.m1.1.1.1.1.2.1.1.1.3.1.cmml" xref="S2.E8.m1.1.1.1.1.2.1.1.1.3">subscript</csymbol><ci id="S2.E8.m1.1.1.1.1.2.1.1.1.3.2.cmml" xref="S2.E8.m1.1.1.1.1.2.1.1.1.3.2">𝐱</ci><apply id="S2.E8.m1.1.1.1.1.2.1.1.1.3.3.cmml" xref="S2.E8.m1.1.1.1.1.2.1.1.1.3.3"><ci id="S2.E8.m1.1.1.1.1.2.1.1.1.3.3.1.cmml" xref="S2.E8.m1.1.1.1.1.2.1.1.1.3.3.1">:</ci><cn id="S2.E8.m1.1.1.1.1.2.1.1.1.3.3.2.cmml" type="integer" xref="S2.E8.m1.1.1.1.1.2.1.1.1.3.3.2">1</cn><ci id="S2.E8.m1.1.1.1.1.2.1.1.1.3.3.3.cmml" xref="S2.E8.m1.1.1.1.1.2.1.1.1.3.3.3">𝑀</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E8.m1.1c">p(e^{\star}\mid\mathbf{x}_{1:s})\approx p(e^{\star}\mid\mathbf{x}_{1:M}).</annotation><annotation encoding="application/x-llamapun" id="S2.E8.m1.1d">italic_p ( italic_e start_POSTSUPERSCRIPT ⋆ end_POSTSUPERSCRIPT ∣ bold_x start_POSTSUBSCRIPT 1 : italic_s end_POSTSUBSCRIPT ) ≈ italic_p ( italic_e start_POSTSUPERSCRIPT ⋆ end_POSTSUPERSCRIPT ∣ bold_x start_POSTSUBSCRIPT 1 : italic_M end_POSTSUBSCRIPT ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.I1.i1.p1.2">This enables us to use <span class="ltx_text ltx_font_smallcaps" id="S2.I1.i1.p1.2.1">SmallTalk LM</span> in real-world applications where only a very small prefix may be available. We show in §&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#S3.SS4" title="3.4 Routing analysis ‣ 3 Experiments ‣ No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_tag">3.4</span></a> that our method outperforms the dense baseline even when using as little as <math alttext="32" class="ltx_Math" display="inline" id="S2.I1.i1.p1.2.m1.1"><semantics id="S2.I1.i1.p1.2.m1.1a"><mn id="S2.I1.i1.p1.2.m1.1.1" xref="S2.I1.i1.p1.2.m1.1.1.cmml">32</mn><annotation-xml encoding="MathML-Content" id="S2.I1.i1.p1.2.m1.1b"><cn id="S2.I1.i1.p1.2.m1.1.1.cmml" type="integer" xref="S2.I1.i1.p1.2.m1.1.1">32</cn></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i1.p1.2.m1.1c">32</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i1.p1.2.m1.1d">32</annotation></semantics></math> tokens for routing.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="S2.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span>
<div class="ltx_para ltx_noindent" id="S2.I1.i2.p1">
<p class="ltx_p" id="S2.I1.i2.p1.3">We implement the router with <math alttext="E" class="ltx_Math" display="inline" id="S2.I1.i2.p1.1.m1.1"><semantics id="S2.I1.i2.p1.1.m1.1a"><mi id="S2.I1.i2.p1.1.m1.1.1" xref="S2.I1.i2.p1.1.m1.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="S2.I1.i2.p1.1.m1.1b"><ci id="S2.I1.i2.p1.1.m1.1.1.cmml" xref="S2.I1.i2.p1.1.m1.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i2.p1.1.m1.1c">E</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i2.p1.1.m1.1d">italic_E</annotation></semantics></math> language models that are <em class="ltx_emph ltx_font_italic" id="S2.I1.i2.p1.3.1">orders of magnitude smaller</em> than the experts. This results in marginal computational overhead, as little as <math alttext="1\%" class="ltx_Math" display="inline" id="S2.I1.i2.p1.2.m2.1"><semantics id="S2.I1.i2.p1.2.m2.1a"><mrow id="S2.I1.i2.p1.2.m2.1.1" xref="S2.I1.i2.p1.2.m2.1.1.cmml"><mn id="S2.I1.i2.p1.2.m2.1.1.2" xref="S2.I1.i2.p1.2.m2.1.1.2.cmml">1</mn><mo id="S2.I1.i2.p1.2.m2.1.1.1" xref="S2.I1.i2.p1.2.m2.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.I1.i2.p1.2.m2.1b"><apply id="S2.I1.i2.p1.2.m2.1.1.cmml" xref="S2.I1.i2.p1.2.m2.1.1"><csymbol cd="latexml" id="S2.I1.i2.p1.2.m2.1.1.1.cmml" xref="S2.I1.i2.p1.2.m2.1.1.1">percent</csymbol><cn id="S2.I1.i2.p1.2.m2.1.1.2.cmml" type="integer" xref="S2.I1.i2.p1.2.m2.1.1.2">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i2.p1.2.m2.1c">1\%</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i2.p1.2.m2.1d">1 %</annotation></semantics></math> during training and <math alttext="3\%" class="ltx_Math" display="inline" id="S2.I1.i2.p1.3.m3.1"><semantics id="S2.I1.i2.p1.3.m3.1a"><mrow id="S2.I1.i2.p1.3.m3.1.1" xref="S2.I1.i2.p1.3.m3.1.1.cmml"><mn id="S2.I1.i2.p1.3.m3.1.1.2" xref="S2.I1.i2.p1.3.m3.1.1.2.cmml">3</mn><mo id="S2.I1.i2.p1.3.m3.1.1.1" xref="S2.I1.i2.p1.3.m3.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.I1.i2.p1.3.m3.1b"><apply id="S2.I1.i2.p1.3.m3.1.1.cmml" xref="S2.I1.i2.p1.3.m3.1.1"><csymbol cd="latexml" id="S2.I1.i2.p1.3.m3.1.1.1.cmml" xref="S2.I1.i2.p1.3.m3.1.1.1">percent</csymbol><cn id="S2.I1.i2.p1.3.m3.1.1.2.cmml" type="integer" xref="S2.I1.i2.p1.3.m3.1.1.2">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i2.p1.3.m3.1c">3\%</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i2.p1.3.m3.1d">3 %</annotation></semantics></math> during inference (§&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#S3.SS2" title="3.2 Language Modeling Results ‣ 3 Experiments ‣ No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_tag">3.2</span></a>).</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
</ol>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS2.SSS0.Px2.p3">
<p class="ltx_p" id="S2.SS2.SSS0.Px2.p3.1">Using the log-likelihood of a prefix to route a sequence is an intuitive solution since a model that is good at predicting the beginning of a sequence is likely to be good at the full sequence. Another interpretation is that the prefix can be used to perform some sort of thematic identification of the whole sequence that is then used to route to the appropriate expert.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS2.SSS0.Px2.p4">
<p class="ltx_p" id="S2.SS2.SSS0.Px2.p4.1">On the other hand, the efficacy of smaller language models as routers is less intuitive. Even though one can expect a large model to be able to perform well on sequences that are beyond the capabilities of smaller models, the task of routing boils down to identifying whether a sequence is similar to the training data or not. We show that even really small models (<math alttext="4.4" class="ltx_Math" display="inline" id="S2.SS2.SSS0.Px2.p4.1.m1.1"><semantics id="S2.SS2.SSS0.Px2.p4.1.m1.1a"><mn id="S2.SS2.SSS0.Px2.p4.1.m1.1.1" xref="S2.SS2.SSS0.Px2.p4.1.m1.1.1.cmml">4.4</mn><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS0.Px2.p4.1.m1.1b"><cn id="S2.SS2.SSS0.Px2.p4.1.m1.1.1.cmml" type="float" xref="S2.SS2.SSS0.Px2.p4.1.m1.1.1">4.4</cn></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS0.Px2.p4.1.m1.1c">4.4</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS0.Px2.p4.1.m1.1d">4.4</annotation></semantics></math>M parameters) can perform that task very well and result in no discernible difference in performance compared to larger routers (§&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#S3.SS4" title="3.4 Routing analysis ‣ 3 Experiments ‣ No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_tag">3.4</span></a>).</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top" id="alg1">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="alg1.3.1.1">Algorithm 1</span> </span> <span class="ltx_text ltx_font_bold ltx_font_smallcaps" id="alg1.4.2">SmallTalk LM<span class="ltx_text ltx_font_upright" id="alg1.4.2.1"> training.</span></span> </figcaption>
<div class="ltx_listing ltx_listing" id="alg1.5">
<div class="ltx_listingline" id="alg1.l1">
<span class="ltx_tag ltx_tag_listingline">1:</span><span class="ltx_text" id="alg1.l1.1" style="color:#808080;">Train the routers</span>
</div>
<div class="ltx_listingline" id="alg1.l2">
<span class="ltx_tag ltx_tag_listingline">2:</span><math alttext="\mathbf{X}\leftarrow N" class="ltx_Math" display="inline" id="alg1.l2.m1.1"><semantics id="alg1.l2.m1.1a"><mrow id="alg1.l2.m1.1.1" xref="alg1.l2.m1.1.1.cmml"><mi id="alg1.l2.m1.1.1.2" xref="alg1.l2.m1.1.1.2.cmml">𝐗</mi><mo id="alg1.l2.m1.1.1.1" stretchy="false" xref="alg1.l2.m1.1.1.1.cmml">←</mo><mi id="alg1.l2.m1.1.1.3" xref="alg1.l2.m1.1.1.3.cmml">N</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l2.m1.1b"><apply id="alg1.l2.m1.1.1.cmml" xref="alg1.l2.m1.1.1"><ci id="alg1.l2.m1.1.1.1.cmml" xref="alg1.l2.m1.1.1.1">←</ci><ci id="alg1.l2.m1.1.1.2.cmml" xref="alg1.l2.m1.1.1.2">𝐗</ci><ci id="alg1.l2.m1.1.1.3.cmml" xref="alg1.l2.m1.1.1.3">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m1.1c">\mathbf{X}\leftarrow N</annotation><annotation encoding="application/x-llamapun" id="alg1.l2.m1.1d">bold_X ← italic_N</annotation></semantics></math> new sequences from the dataset

</div>
<div class="ltx_listingline" id="alg1.l3">
<span class="ltx_tag ltx_tag_listingline">3:</span><math alttext="\mathbf{X}_{1:E}=\text{random\_assignments}(\mathbf{X})" class="ltx_Math" display="inline" id="alg1.l3.m1.1"><semantics id="alg1.l3.m1.1a"><mrow id="alg1.l3.m1.1.2" xref="alg1.l3.m1.1.2.cmml"><msub id="alg1.l3.m1.1.2.2" xref="alg1.l3.m1.1.2.2.cmml"><mi id="alg1.l3.m1.1.2.2.2" xref="alg1.l3.m1.1.2.2.2.cmml">𝐗</mi><mrow id="alg1.l3.m1.1.2.2.3" xref="alg1.l3.m1.1.2.2.3.cmml"><mn id="alg1.l3.m1.1.2.2.3.2" xref="alg1.l3.m1.1.2.2.3.2.cmml">1</mn><mo id="alg1.l3.m1.1.2.2.3.1" lspace="0.278em" rspace="0.278em" xref="alg1.l3.m1.1.2.2.3.1.cmml">:</mo><mi id="alg1.l3.m1.1.2.2.3.3" xref="alg1.l3.m1.1.2.2.3.3.cmml">E</mi></mrow></msub><mo id="alg1.l3.m1.1.2.1" xref="alg1.l3.m1.1.2.1.cmml">=</mo><mrow id="alg1.l3.m1.1.2.3" xref="alg1.l3.m1.1.2.3.cmml"><mtext id="alg1.l3.m1.1.2.3.2" xref="alg1.l3.m1.1.2.3.2a.cmml">random_assignments</mtext><mo id="alg1.l3.m1.1.2.3.1" xref="alg1.l3.m1.1.2.3.1.cmml">⁢</mo><mrow id="alg1.l3.m1.1.2.3.3.2" xref="alg1.l3.m1.1.2.3.cmml"><mo id="alg1.l3.m1.1.2.3.3.2.1" stretchy="false" xref="alg1.l3.m1.1.2.3.cmml">(</mo><mi id="alg1.l3.m1.1.1" xref="alg1.l3.m1.1.1.cmml">𝐗</mi><mo id="alg1.l3.m1.1.2.3.3.2.2" stretchy="false" xref="alg1.l3.m1.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l3.m1.1b"><apply id="alg1.l3.m1.1.2.cmml" xref="alg1.l3.m1.1.2"><eq id="alg1.l3.m1.1.2.1.cmml" xref="alg1.l3.m1.1.2.1"></eq><apply id="alg1.l3.m1.1.2.2.cmml" xref="alg1.l3.m1.1.2.2"><csymbol cd="ambiguous" id="alg1.l3.m1.1.2.2.1.cmml" xref="alg1.l3.m1.1.2.2">subscript</csymbol><ci id="alg1.l3.m1.1.2.2.2.cmml" xref="alg1.l3.m1.1.2.2.2">𝐗</ci><apply id="alg1.l3.m1.1.2.2.3.cmml" xref="alg1.l3.m1.1.2.2.3"><ci id="alg1.l3.m1.1.2.2.3.1.cmml" xref="alg1.l3.m1.1.2.2.3.1">:</ci><cn id="alg1.l3.m1.1.2.2.3.2.cmml" type="integer" xref="alg1.l3.m1.1.2.2.3.2">1</cn><ci id="alg1.l3.m1.1.2.2.3.3.cmml" xref="alg1.l3.m1.1.2.2.3.3">𝐸</ci></apply></apply><apply id="alg1.l3.m1.1.2.3.cmml" xref="alg1.l3.m1.1.2.3"><times id="alg1.l3.m1.1.2.3.1.cmml" xref="alg1.l3.m1.1.2.3.1"></times><ci id="alg1.l3.m1.1.2.3.2a.cmml" xref="alg1.l3.m1.1.2.3.2"><mtext id="alg1.l3.m1.1.2.3.2.cmml" xref="alg1.l3.m1.1.2.3.2">random_assignments</mtext></ci><ci id="alg1.l3.m1.1.1.cmml" xref="alg1.l3.m1.1.1">𝐗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m1.1c">\mathbf{X}_{1:E}=\text{random\_assignments}(\mathbf{X})</annotation><annotation encoding="application/x-llamapun" id="alg1.l3.m1.1d">bold_X start_POSTSUBSCRIPT 1 : italic_E end_POSTSUBSCRIPT = random_assignments ( bold_X )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l4">
<span class="ltx_tag ltx_tag_listingline">4:</span><span class="ltx_text ltx_font_bold" id="alg1.l4.1">for</span>&nbsp;<math alttext="i=1\dots T" class="ltx_Math" display="inline" id="alg1.l4.m1.1"><semantics id="alg1.l4.m1.1a"><mrow id="alg1.l4.m1.1.1" xref="alg1.l4.m1.1.1.cmml"><mi id="alg1.l4.m1.1.1.2" xref="alg1.l4.m1.1.1.2.cmml">i</mi><mo id="alg1.l4.m1.1.1.1" xref="alg1.l4.m1.1.1.1.cmml">=</mo><mrow id="alg1.l4.m1.1.1.3" xref="alg1.l4.m1.1.1.3.cmml"><mn id="alg1.l4.m1.1.1.3.2" xref="alg1.l4.m1.1.1.3.2.cmml">1</mn><mo id="alg1.l4.m1.1.1.3.1" xref="alg1.l4.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l4.m1.1.1.3.3" mathvariant="normal" xref="alg1.l4.m1.1.1.3.3.cmml">…</mi><mo id="alg1.l4.m1.1.1.3.1a" xref="alg1.l4.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l4.m1.1.1.3.4" xref="alg1.l4.m1.1.1.3.4.cmml">T</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l4.m1.1b"><apply id="alg1.l4.m1.1.1.cmml" xref="alg1.l4.m1.1.1"><eq id="alg1.l4.m1.1.1.1.cmml" xref="alg1.l4.m1.1.1.1"></eq><ci id="alg1.l4.m1.1.1.2.cmml" xref="alg1.l4.m1.1.1.2">𝑖</ci><apply id="alg1.l4.m1.1.1.3.cmml" xref="alg1.l4.m1.1.1.3"><times id="alg1.l4.m1.1.1.3.1.cmml" xref="alg1.l4.m1.1.1.3.1"></times><cn id="alg1.l4.m1.1.1.3.2.cmml" type="integer" xref="alg1.l4.m1.1.1.3.2">1</cn><ci id="alg1.l4.m1.1.1.3.3.cmml" xref="alg1.l4.m1.1.1.3.3">…</ci><ci id="alg1.l4.m1.1.1.3.4.cmml" xref="alg1.l4.m1.1.1.3.4">𝑇</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m1.1c">i=1\dots T</annotation><annotation encoding="application/x-llamapun" id="alg1.l4.m1.1d">italic_i = 1 … italic_T</annotation></semantics></math>&nbsp;<span class="ltx_text ltx_font_bold" id="alg1.l4.2">do</span>
</div>
<div class="ltx_listingline" id="alg1.l5">
<span class="ltx_tag ltx_tag_listingline">5:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ltx_text ltx_font_bold" id="alg1.l5.1">for</span>&nbsp;<math alttext="e=1\dots E" class="ltx_Math" display="inline" id="alg1.l5.m1.1"><semantics id="alg1.l5.m1.1a"><mrow id="alg1.l5.m1.1.1" xref="alg1.l5.m1.1.1.cmml"><mi id="alg1.l5.m1.1.1.2" xref="alg1.l5.m1.1.1.2.cmml">e</mi><mo id="alg1.l5.m1.1.1.1" xref="alg1.l5.m1.1.1.1.cmml">=</mo><mrow id="alg1.l5.m1.1.1.3" xref="alg1.l5.m1.1.1.3.cmml"><mn id="alg1.l5.m1.1.1.3.2" xref="alg1.l5.m1.1.1.3.2.cmml">1</mn><mo id="alg1.l5.m1.1.1.3.1" xref="alg1.l5.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l5.m1.1.1.3.3" mathvariant="normal" xref="alg1.l5.m1.1.1.3.3.cmml">…</mi><mo id="alg1.l5.m1.1.1.3.1a" xref="alg1.l5.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l5.m1.1.1.3.4" xref="alg1.l5.m1.1.1.3.4.cmml">E</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l5.m1.1b"><apply id="alg1.l5.m1.1.1.cmml" xref="alg1.l5.m1.1.1"><eq id="alg1.l5.m1.1.1.1.cmml" xref="alg1.l5.m1.1.1.1"></eq><ci id="alg1.l5.m1.1.1.2.cmml" xref="alg1.l5.m1.1.1.2">𝑒</ci><apply id="alg1.l5.m1.1.1.3.cmml" xref="alg1.l5.m1.1.1.3"><times id="alg1.l5.m1.1.1.3.1.cmml" xref="alg1.l5.m1.1.1.3.1"></times><cn id="alg1.l5.m1.1.1.3.2.cmml" type="integer" xref="alg1.l5.m1.1.1.3.2">1</cn><ci id="alg1.l5.m1.1.1.3.3.cmml" xref="alg1.l5.m1.1.1.3.3">…</ci><ci id="alg1.l5.m1.1.1.3.4.cmml" xref="alg1.l5.m1.1.1.3.4">𝐸</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m1.1c">e=1\dots E</annotation><annotation encoding="application/x-llamapun" id="alg1.l5.m1.1d">italic_e = 1 … italic_E</annotation></semantics></math>&nbsp;<span class="ltx_text ltx_font_bold" id="alg1.l5.2">do</span>
</div>
<div class="ltx_listingline" id="alg1.l6">
<span class="ltx_tag ltx_tag_listingline">6:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<math alttext="\theta^{r,e}\approx\operatorname*{arg\,min}_{\theta^{r,e}}\mathcal{L}(\mathbf{%
X}_{e};\theta^{r,e})" class="ltx_Math" display="inline" id="alg1.l6.m1.8"><semantics id="alg1.l6.m1.8a"><mrow id="alg1.l6.m1.8.8" xref="alg1.l6.m1.8.8.cmml"><msup id="alg1.l6.m1.8.8.4" xref="alg1.l6.m1.8.8.4.cmml"><mi id="alg1.l6.m1.8.8.4.2" xref="alg1.l6.m1.8.8.4.2.cmml">θ</mi><mrow id="alg1.l6.m1.2.2.2.4" xref="alg1.l6.m1.2.2.2.3.cmml"><mi id="alg1.l6.m1.1.1.1.1" xref="alg1.l6.m1.1.1.1.1.cmml">r</mi><mo id="alg1.l6.m1.2.2.2.4.1" xref="alg1.l6.m1.2.2.2.3.cmml">,</mo><mi id="alg1.l6.m1.2.2.2.2" xref="alg1.l6.m1.2.2.2.2.cmml">e</mi></mrow></msup><mo id="alg1.l6.m1.8.8.3" xref="alg1.l6.m1.8.8.3.cmml">≈</mo><mrow id="alg1.l6.m1.8.8.2" xref="alg1.l6.m1.8.8.2.cmml"><mrow id="alg1.l6.m1.8.8.2.4" xref="alg1.l6.m1.8.8.2.4.cmml"><msub id="alg1.l6.m1.8.8.2.4.1" xref="alg1.l6.m1.8.8.2.4.1.cmml"><mrow id="alg1.l6.m1.8.8.2.4.1.2" xref="alg1.l6.m1.8.8.2.4.1.2.cmml"><mi id="alg1.l6.m1.8.8.2.4.1.2.2" xref="alg1.l6.m1.8.8.2.4.1.2.2.cmml">arg</mi><mo id="alg1.l6.m1.8.8.2.4.1.2.1" lspace="0.170em" xref="alg1.l6.m1.8.8.2.4.1.2.1.cmml">⁢</mo><mi id="alg1.l6.m1.8.8.2.4.1.2.3" xref="alg1.l6.m1.8.8.2.4.1.2.3.cmml">min</mi></mrow><msup id="alg1.l6.m1.4.4.2" xref="alg1.l6.m1.4.4.2.cmml"><mi id="alg1.l6.m1.4.4.2.4" xref="alg1.l6.m1.4.4.2.4.cmml">θ</mi><mrow id="alg1.l6.m1.4.4.2.2.2.4" xref="alg1.l6.m1.4.4.2.2.2.3.cmml"><mi id="alg1.l6.m1.3.3.1.1.1.1" xref="alg1.l6.m1.3.3.1.1.1.1.cmml">r</mi><mo id="alg1.l6.m1.4.4.2.2.2.4.1" xref="alg1.l6.m1.4.4.2.2.2.3.cmml">,</mo><mi id="alg1.l6.m1.4.4.2.2.2.2" xref="alg1.l6.m1.4.4.2.2.2.2.cmml">e</mi></mrow></msup></msub><mo id="alg1.l6.m1.8.8.2.4a" xref="alg1.l6.m1.8.8.2.4.cmml">⁡</mo><mi class="ltx_font_mathcaligraphic" id="alg1.l6.m1.8.8.2.4.2" xref="alg1.l6.m1.8.8.2.4.2.cmml">ℒ</mi></mrow><mo id="alg1.l6.m1.8.8.2.3" xref="alg1.l6.m1.8.8.2.3.cmml">⁢</mo><mrow id="alg1.l6.m1.8.8.2.2.2" xref="alg1.l6.m1.8.8.2.2.3.cmml"><mo id="alg1.l6.m1.8.8.2.2.2.3" stretchy="false" xref="alg1.l6.m1.8.8.2.2.3.cmml">(</mo><msub id="alg1.l6.m1.7.7.1.1.1.1" xref="alg1.l6.m1.7.7.1.1.1.1.cmml"><mi id="alg1.l6.m1.7.7.1.1.1.1.2" xref="alg1.l6.m1.7.7.1.1.1.1.2.cmml">𝐗</mi><mi id="alg1.l6.m1.7.7.1.1.1.1.3" xref="alg1.l6.m1.7.7.1.1.1.1.3.cmml">e</mi></msub><mo id="alg1.l6.m1.8.8.2.2.2.4" xref="alg1.l6.m1.8.8.2.2.3.cmml">;</mo><msup id="alg1.l6.m1.8.8.2.2.2.2" xref="alg1.l6.m1.8.8.2.2.2.2.cmml"><mi id="alg1.l6.m1.8.8.2.2.2.2.2" xref="alg1.l6.m1.8.8.2.2.2.2.2.cmml">θ</mi><mrow id="alg1.l6.m1.6.6.2.4" xref="alg1.l6.m1.6.6.2.3.cmml"><mi id="alg1.l6.m1.5.5.1.1" xref="alg1.l6.m1.5.5.1.1.cmml">r</mi><mo id="alg1.l6.m1.6.6.2.4.1" xref="alg1.l6.m1.6.6.2.3.cmml">,</mo><mi id="alg1.l6.m1.6.6.2.2" xref="alg1.l6.m1.6.6.2.2.cmml">e</mi></mrow></msup><mo id="alg1.l6.m1.8.8.2.2.2.5" stretchy="false" xref="alg1.l6.m1.8.8.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l6.m1.8b"><apply id="alg1.l6.m1.8.8.cmml" xref="alg1.l6.m1.8.8"><approx id="alg1.l6.m1.8.8.3.cmml" xref="alg1.l6.m1.8.8.3"></approx><apply id="alg1.l6.m1.8.8.4.cmml" xref="alg1.l6.m1.8.8.4"><csymbol cd="ambiguous" id="alg1.l6.m1.8.8.4.1.cmml" xref="alg1.l6.m1.8.8.4">superscript</csymbol><ci id="alg1.l6.m1.8.8.4.2.cmml" xref="alg1.l6.m1.8.8.4.2">𝜃</ci><list id="alg1.l6.m1.2.2.2.3.cmml" xref="alg1.l6.m1.2.2.2.4"><ci id="alg1.l6.m1.1.1.1.1.cmml" xref="alg1.l6.m1.1.1.1.1">𝑟</ci><ci id="alg1.l6.m1.2.2.2.2.cmml" xref="alg1.l6.m1.2.2.2.2">𝑒</ci></list></apply><apply id="alg1.l6.m1.8.8.2.cmml" xref="alg1.l6.m1.8.8.2"><times id="alg1.l6.m1.8.8.2.3.cmml" xref="alg1.l6.m1.8.8.2.3"></times><apply id="alg1.l6.m1.8.8.2.4.cmml" xref="alg1.l6.m1.8.8.2.4"><apply id="alg1.l6.m1.8.8.2.4.1.cmml" xref="alg1.l6.m1.8.8.2.4.1"><csymbol cd="ambiguous" id="alg1.l6.m1.8.8.2.4.1.1.cmml" xref="alg1.l6.m1.8.8.2.4.1">subscript</csymbol><apply id="alg1.l6.m1.8.8.2.4.1.2.cmml" xref="alg1.l6.m1.8.8.2.4.1.2"><times id="alg1.l6.m1.8.8.2.4.1.2.1.cmml" xref="alg1.l6.m1.8.8.2.4.1.2.1"></times><ci id="alg1.l6.m1.8.8.2.4.1.2.2.cmml" xref="alg1.l6.m1.8.8.2.4.1.2.2">arg</ci><ci id="alg1.l6.m1.8.8.2.4.1.2.3.cmml" xref="alg1.l6.m1.8.8.2.4.1.2.3">min</ci></apply><apply id="alg1.l6.m1.4.4.2.cmml" xref="alg1.l6.m1.4.4.2"><csymbol cd="ambiguous" id="alg1.l6.m1.4.4.2.3.cmml" xref="alg1.l6.m1.4.4.2">superscript</csymbol><ci id="alg1.l6.m1.4.4.2.4.cmml" xref="alg1.l6.m1.4.4.2.4">𝜃</ci><list id="alg1.l6.m1.4.4.2.2.2.3.cmml" xref="alg1.l6.m1.4.4.2.2.2.4"><ci id="alg1.l6.m1.3.3.1.1.1.1.cmml" xref="alg1.l6.m1.3.3.1.1.1.1">𝑟</ci><ci id="alg1.l6.m1.4.4.2.2.2.2.cmml" xref="alg1.l6.m1.4.4.2.2.2.2">𝑒</ci></list></apply></apply><ci id="alg1.l6.m1.8.8.2.4.2.cmml" xref="alg1.l6.m1.8.8.2.4.2">ℒ</ci></apply><list id="alg1.l6.m1.8.8.2.2.3.cmml" xref="alg1.l6.m1.8.8.2.2.2"><apply id="alg1.l6.m1.7.7.1.1.1.1.cmml" xref="alg1.l6.m1.7.7.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l6.m1.7.7.1.1.1.1.1.cmml" xref="alg1.l6.m1.7.7.1.1.1.1">subscript</csymbol><ci id="alg1.l6.m1.7.7.1.1.1.1.2.cmml" xref="alg1.l6.m1.7.7.1.1.1.1.2">𝐗</ci><ci id="alg1.l6.m1.7.7.1.1.1.1.3.cmml" xref="alg1.l6.m1.7.7.1.1.1.1.3">𝑒</ci></apply><apply id="alg1.l6.m1.8.8.2.2.2.2.cmml" xref="alg1.l6.m1.8.8.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l6.m1.8.8.2.2.2.2.1.cmml" xref="alg1.l6.m1.8.8.2.2.2.2">superscript</csymbol><ci id="alg1.l6.m1.8.8.2.2.2.2.2.cmml" xref="alg1.l6.m1.8.8.2.2.2.2.2">𝜃</ci><list id="alg1.l6.m1.6.6.2.3.cmml" xref="alg1.l6.m1.6.6.2.4"><ci id="alg1.l6.m1.5.5.1.1.cmml" xref="alg1.l6.m1.5.5.1.1">𝑟</ci><ci id="alg1.l6.m1.6.6.2.2.cmml" xref="alg1.l6.m1.6.6.2.2">𝑒</ci></list></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m1.8c">\theta^{r,e}\approx\operatorname*{arg\,min}_{\theta^{r,e}}\mathcal{L}(\mathbf{%
X}_{e};\theta^{r,e})</annotation><annotation encoding="application/x-llamapun" id="alg1.l6.m1.8d">italic_θ start_POSTSUPERSCRIPT italic_r , italic_e end_POSTSUPERSCRIPT ≈ start_OPERATOR roman_arg roman_min end_OPERATOR start_POSTSUBSCRIPT italic_θ start_POSTSUPERSCRIPT italic_r , italic_e end_POSTSUPERSCRIPT end_POSTSUBSCRIPT caligraphic_L ( bold_X start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT ; italic_θ start_POSTSUPERSCRIPT italic_r , italic_e end_POSTSUPERSCRIPT )</annotation></semantics></math>
<span class="ltx_text" id="alg1.l6.1" style="float:right;"><span class="ltx_text" id="alg1.l6.1.1" style="color:#808080;"># Optimize Equation&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#S2.E9" title="In item 1 ‣ Training Procedure ‣ 2.2 SmallTalk LM ‣ 2 Method ‣ No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_tag">9</span></a> with SGD for the <math alttext="e" class="ltx_Math" display="inline" id="alg1.l6.1.1.m1.1"><semantics id="alg1.l6.1.1.m1.1a"><mi id="alg1.l6.1.1.m1.1.1" mathcolor="#808080" xref="alg1.l6.1.1.m1.1.1.cmml">e</mi><annotation-xml encoding="MathML-Content" id="alg1.l6.1.1.m1.1b"><ci id="alg1.l6.1.1.m1.1.1.cmml" xref="alg1.l6.1.1.m1.1.1">𝑒</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.1.1.m1.1c">e</annotation><annotation encoding="application/x-llamapun" id="alg1.l6.1.1.m1.1d">italic_e</annotation></semantics></math>-th router</span>
</span>
</div>
<div class="ltx_listingline" id="alg1.l7">
<span class="ltx_tag ltx_tag_listingline">7:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ltx_text ltx_font_bold" id="alg1.l7.1">end</span>&nbsp;<span class="ltx_text ltx_font_bold" id="alg1.l7.2">for</span>
</div>
<div class="ltx_listingline" id="alg1.l8">
<span class="ltx_tag ltx_tag_listingline">8:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<math alttext="\mathbf{X}\leftarrow N" class="ltx_Math" display="inline" id="alg1.l8.m1.1"><semantics id="alg1.l8.m1.1a"><mrow id="alg1.l8.m1.1.1" xref="alg1.l8.m1.1.1.cmml"><mi id="alg1.l8.m1.1.1.2" xref="alg1.l8.m1.1.1.2.cmml">𝐗</mi><mo id="alg1.l8.m1.1.1.1" stretchy="false" xref="alg1.l8.m1.1.1.1.cmml">←</mo><mi id="alg1.l8.m1.1.1.3" xref="alg1.l8.m1.1.1.3.cmml">N</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l8.m1.1b"><apply id="alg1.l8.m1.1.1.cmml" xref="alg1.l8.m1.1.1"><ci id="alg1.l8.m1.1.1.1.cmml" xref="alg1.l8.m1.1.1.1">←</ci><ci id="alg1.l8.m1.1.1.2.cmml" xref="alg1.l8.m1.1.1.2">𝐗</ci><ci id="alg1.l8.m1.1.1.3.cmml" xref="alg1.l8.m1.1.1.3">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m1.1c">\mathbf{X}\leftarrow N</annotation><annotation encoding="application/x-llamapun" id="alg1.l8.m1.1d">bold_X ← italic_N</annotation></semantics></math> new sequences from the dataset

</div>
<div class="ltx_listingline" id="alg1.l9">
<span class="ltx_tag ltx_tag_listingline">9:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<math alttext="\mathbf{X}_{1:E}=\text{balanced\_assignments}(\mathbf{X},\theta^{r})" class="ltx_Math" display="inline" id="alg1.l9.m1.2"><semantics id="alg1.l9.m1.2a"><mrow id="alg1.l9.m1.2.2" xref="alg1.l9.m1.2.2.cmml"><msub id="alg1.l9.m1.2.2.3" xref="alg1.l9.m1.2.2.3.cmml"><mi id="alg1.l9.m1.2.2.3.2" xref="alg1.l9.m1.2.2.3.2.cmml">𝐗</mi><mrow id="alg1.l9.m1.2.2.3.3" xref="alg1.l9.m1.2.2.3.3.cmml"><mn id="alg1.l9.m1.2.2.3.3.2" xref="alg1.l9.m1.2.2.3.3.2.cmml">1</mn><mo id="alg1.l9.m1.2.2.3.3.1" lspace="0.278em" rspace="0.278em" xref="alg1.l9.m1.2.2.3.3.1.cmml">:</mo><mi id="alg1.l9.m1.2.2.3.3.3" xref="alg1.l9.m1.2.2.3.3.3.cmml">E</mi></mrow></msub><mo id="alg1.l9.m1.2.2.2" xref="alg1.l9.m1.2.2.2.cmml">=</mo><mrow id="alg1.l9.m1.2.2.1" xref="alg1.l9.m1.2.2.1.cmml"><mtext id="alg1.l9.m1.2.2.1.3" xref="alg1.l9.m1.2.2.1.3a.cmml">balanced_assignments</mtext><mo id="alg1.l9.m1.2.2.1.2" xref="alg1.l9.m1.2.2.1.2.cmml">⁢</mo><mrow id="alg1.l9.m1.2.2.1.1.1" xref="alg1.l9.m1.2.2.1.1.2.cmml"><mo id="alg1.l9.m1.2.2.1.1.1.2" stretchy="false" xref="alg1.l9.m1.2.2.1.1.2.cmml">(</mo><mi id="alg1.l9.m1.1.1" xref="alg1.l9.m1.1.1.cmml">𝐗</mi><mo id="alg1.l9.m1.2.2.1.1.1.3" xref="alg1.l9.m1.2.2.1.1.2.cmml">,</mo><msup id="alg1.l9.m1.2.2.1.1.1.1" xref="alg1.l9.m1.2.2.1.1.1.1.cmml"><mi id="alg1.l9.m1.2.2.1.1.1.1.2" xref="alg1.l9.m1.2.2.1.1.1.1.2.cmml">θ</mi><mi id="alg1.l9.m1.2.2.1.1.1.1.3" xref="alg1.l9.m1.2.2.1.1.1.1.3.cmml">r</mi></msup><mo id="alg1.l9.m1.2.2.1.1.1.4" stretchy="false" xref="alg1.l9.m1.2.2.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l9.m1.2b"><apply id="alg1.l9.m1.2.2.cmml" xref="alg1.l9.m1.2.2"><eq id="alg1.l9.m1.2.2.2.cmml" xref="alg1.l9.m1.2.2.2"></eq><apply id="alg1.l9.m1.2.2.3.cmml" xref="alg1.l9.m1.2.2.3"><csymbol cd="ambiguous" id="alg1.l9.m1.2.2.3.1.cmml" xref="alg1.l9.m1.2.2.3">subscript</csymbol><ci id="alg1.l9.m1.2.2.3.2.cmml" xref="alg1.l9.m1.2.2.3.2">𝐗</ci><apply id="alg1.l9.m1.2.2.3.3.cmml" xref="alg1.l9.m1.2.2.3.3"><ci id="alg1.l9.m1.2.2.3.3.1.cmml" xref="alg1.l9.m1.2.2.3.3.1">:</ci><cn id="alg1.l9.m1.2.2.3.3.2.cmml" type="integer" xref="alg1.l9.m1.2.2.3.3.2">1</cn><ci id="alg1.l9.m1.2.2.3.3.3.cmml" xref="alg1.l9.m1.2.2.3.3.3">𝐸</ci></apply></apply><apply id="alg1.l9.m1.2.2.1.cmml" xref="alg1.l9.m1.2.2.1"><times id="alg1.l9.m1.2.2.1.2.cmml" xref="alg1.l9.m1.2.2.1.2"></times><ci id="alg1.l9.m1.2.2.1.3a.cmml" xref="alg1.l9.m1.2.2.1.3"><mtext id="alg1.l9.m1.2.2.1.3.cmml" xref="alg1.l9.m1.2.2.1.3">balanced_assignments</mtext></ci><interval closure="open" id="alg1.l9.m1.2.2.1.1.2.cmml" xref="alg1.l9.m1.2.2.1.1.1"><ci id="alg1.l9.m1.1.1.cmml" xref="alg1.l9.m1.1.1">𝐗</ci><apply id="alg1.l9.m1.2.2.1.1.1.1.cmml" xref="alg1.l9.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l9.m1.2.2.1.1.1.1.1.cmml" xref="alg1.l9.m1.2.2.1.1.1.1">superscript</csymbol><ci id="alg1.l9.m1.2.2.1.1.1.1.2.cmml" xref="alg1.l9.m1.2.2.1.1.1.1.2">𝜃</ci><ci id="alg1.l9.m1.2.2.1.1.1.1.3.cmml" xref="alg1.l9.m1.2.2.1.1.1.1.3">𝑟</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m1.2c">\mathbf{X}_{1:E}=\text{balanced\_assignments}(\mathbf{X},\theta^{r})</annotation><annotation encoding="application/x-llamapun" id="alg1.l9.m1.2d">bold_X start_POSTSUBSCRIPT 1 : italic_E end_POSTSUBSCRIPT = balanced_assignments ( bold_X , italic_θ start_POSTSUPERSCRIPT italic_r end_POSTSUPERSCRIPT )</annotation></semantics></math>
<span class="ltx_text" id="alg1.l9.1" style="float:right;"><span class="ltx_text" id="alg1.l9.1.1" style="color:#808080;"># Segment the data according to Equation&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#S2.E4" title="In Routing With Independent Language Models ‣ 2.2 SmallTalk LM ‣ 2 Method ‣ No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_tag">4</span></a></span>
</span>
</div>
<div class="ltx_listingline" id="alg1.l10">
<span class="ltx_tag ltx_tag_listingline">10:</span><span class="ltx_text ltx_font_bold" id="alg1.l10.1">end</span>&nbsp;<span class="ltx_text ltx_font_bold" id="alg1.l10.2">for</span>
</div>
<div class="ltx_listingline" id="alg1.l11">
<span class="ltx_tag ltx_tag_listingline">11:</span><span class="ltx_text" id="alg1.l11.1" style="color:#808080;">Train the experts</span>
</div>
<div class="ltx_listingline" id="alg1.l12">
<span class="ltx_tag ltx_tag_listingline">12:</span><math alttext="\mathbf{X}\leftarrow M" class="ltx_Math" display="inline" id="alg1.l12.m1.1"><semantics id="alg1.l12.m1.1a"><mrow id="alg1.l12.m1.1.1" xref="alg1.l12.m1.1.1.cmml"><mi id="alg1.l12.m1.1.1.2" xref="alg1.l12.m1.1.1.2.cmml">𝐗</mi><mo id="alg1.l12.m1.1.1.1" stretchy="false" xref="alg1.l12.m1.1.1.1.cmml">←</mo><mi id="alg1.l12.m1.1.1.3" xref="alg1.l12.m1.1.1.3.cmml">M</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l12.m1.1b"><apply id="alg1.l12.m1.1.1.cmml" xref="alg1.l12.m1.1.1"><ci id="alg1.l12.m1.1.1.1.cmml" xref="alg1.l12.m1.1.1.1">←</ci><ci id="alg1.l12.m1.1.1.2.cmml" xref="alg1.l12.m1.1.1.2">𝐗</ci><ci id="alg1.l12.m1.1.1.3.cmml" xref="alg1.l12.m1.1.1.3">𝑀</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l12.m1.1c">\mathbf{X}\leftarrow M</annotation><annotation encoding="application/x-llamapun" id="alg1.l12.m1.1d">bold_X ← italic_M</annotation></semantics></math> new sequences from the dataset comprising the total number of training tokens

</div>
<div class="ltx_listingline" id="alg1.l13">
<span class="ltx_tag ltx_tag_listingline">13:</span><math alttext="\mathbf{X}_{1:E}=\text{balanced\_assignments}(\mathbf{X},\theta^{r})" class="ltx_Math" display="inline" id="alg1.l13.m1.2"><semantics id="alg1.l13.m1.2a"><mrow id="alg1.l13.m1.2.2" xref="alg1.l13.m1.2.2.cmml"><msub id="alg1.l13.m1.2.2.3" xref="alg1.l13.m1.2.2.3.cmml"><mi id="alg1.l13.m1.2.2.3.2" xref="alg1.l13.m1.2.2.3.2.cmml">𝐗</mi><mrow id="alg1.l13.m1.2.2.3.3" xref="alg1.l13.m1.2.2.3.3.cmml"><mn id="alg1.l13.m1.2.2.3.3.2" xref="alg1.l13.m1.2.2.3.3.2.cmml">1</mn><mo id="alg1.l13.m1.2.2.3.3.1" lspace="0.278em" rspace="0.278em" xref="alg1.l13.m1.2.2.3.3.1.cmml">:</mo><mi id="alg1.l13.m1.2.2.3.3.3" xref="alg1.l13.m1.2.2.3.3.3.cmml">E</mi></mrow></msub><mo id="alg1.l13.m1.2.2.2" xref="alg1.l13.m1.2.2.2.cmml">=</mo><mrow id="alg1.l13.m1.2.2.1" xref="alg1.l13.m1.2.2.1.cmml"><mtext id="alg1.l13.m1.2.2.1.3" xref="alg1.l13.m1.2.2.1.3a.cmml">balanced_assignments</mtext><mo id="alg1.l13.m1.2.2.1.2" xref="alg1.l13.m1.2.2.1.2.cmml">⁢</mo><mrow id="alg1.l13.m1.2.2.1.1.1" xref="alg1.l13.m1.2.2.1.1.2.cmml"><mo id="alg1.l13.m1.2.2.1.1.1.2" stretchy="false" xref="alg1.l13.m1.2.2.1.1.2.cmml">(</mo><mi id="alg1.l13.m1.1.1" xref="alg1.l13.m1.1.1.cmml">𝐗</mi><mo id="alg1.l13.m1.2.2.1.1.1.3" xref="alg1.l13.m1.2.2.1.1.2.cmml">,</mo><msup id="alg1.l13.m1.2.2.1.1.1.1" xref="alg1.l13.m1.2.2.1.1.1.1.cmml"><mi id="alg1.l13.m1.2.2.1.1.1.1.2" xref="alg1.l13.m1.2.2.1.1.1.1.2.cmml">θ</mi><mi id="alg1.l13.m1.2.2.1.1.1.1.3" xref="alg1.l13.m1.2.2.1.1.1.1.3.cmml">r</mi></msup><mo id="alg1.l13.m1.2.2.1.1.1.4" stretchy="false" xref="alg1.l13.m1.2.2.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l13.m1.2b"><apply id="alg1.l13.m1.2.2.cmml" xref="alg1.l13.m1.2.2"><eq id="alg1.l13.m1.2.2.2.cmml" xref="alg1.l13.m1.2.2.2"></eq><apply id="alg1.l13.m1.2.2.3.cmml" xref="alg1.l13.m1.2.2.3"><csymbol cd="ambiguous" id="alg1.l13.m1.2.2.3.1.cmml" xref="alg1.l13.m1.2.2.3">subscript</csymbol><ci id="alg1.l13.m1.2.2.3.2.cmml" xref="alg1.l13.m1.2.2.3.2">𝐗</ci><apply id="alg1.l13.m1.2.2.3.3.cmml" xref="alg1.l13.m1.2.2.3.3"><ci id="alg1.l13.m1.2.2.3.3.1.cmml" xref="alg1.l13.m1.2.2.3.3.1">:</ci><cn id="alg1.l13.m1.2.2.3.3.2.cmml" type="integer" xref="alg1.l13.m1.2.2.3.3.2">1</cn><ci id="alg1.l13.m1.2.2.3.3.3.cmml" xref="alg1.l13.m1.2.2.3.3.3">𝐸</ci></apply></apply><apply id="alg1.l13.m1.2.2.1.cmml" xref="alg1.l13.m1.2.2.1"><times id="alg1.l13.m1.2.2.1.2.cmml" xref="alg1.l13.m1.2.2.1.2"></times><ci id="alg1.l13.m1.2.2.1.3a.cmml" xref="alg1.l13.m1.2.2.1.3"><mtext id="alg1.l13.m1.2.2.1.3.cmml" xref="alg1.l13.m1.2.2.1.3">balanced_assignments</mtext></ci><interval closure="open" id="alg1.l13.m1.2.2.1.1.2.cmml" xref="alg1.l13.m1.2.2.1.1.1"><ci id="alg1.l13.m1.1.1.cmml" xref="alg1.l13.m1.1.1">𝐗</ci><apply id="alg1.l13.m1.2.2.1.1.1.1.cmml" xref="alg1.l13.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l13.m1.2.2.1.1.1.1.1.cmml" xref="alg1.l13.m1.2.2.1.1.1.1">superscript</csymbol><ci id="alg1.l13.m1.2.2.1.1.1.1.2.cmml" xref="alg1.l13.m1.2.2.1.1.1.1.2">𝜃</ci><ci id="alg1.l13.m1.2.2.1.1.1.1.3.cmml" xref="alg1.l13.m1.2.2.1.1.1.1.3">𝑟</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l13.m1.2c">\mathbf{X}_{1:E}=\text{balanced\_assignments}(\mathbf{X},\theta^{r})</annotation><annotation encoding="application/x-llamapun" id="alg1.l13.m1.2d">bold_X start_POSTSUBSCRIPT 1 : italic_E end_POSTSUBSCRIPT = balanced_assignments ( bold_X , italic_θ start_POSTSUPERSCRIPT italic_r end_POSTSUPERSCRIPT )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l14">
<span class="ltx_tag ltx_tag_listingline">14:</span><span class="ltx_text ltx_font_bold" id="alg1.l14.1">for</span>&nbsp;<math alttext="e=1\dots E" class="ltx_Math" display="inline" id="alg1.l14.m1.1"><semantics id="alg1.l14.m1.1a"><mrow id="alg1.l14.m1.1.1" xref="alg1.l14.m1.1.1.cmml"><mi id="alg1.l14.m1.1.1.2" xref="alg1.l14.m1.1.1.2.cmml">e</mi><mo id="alg1.l14.m1.1.1.1" xref="alg1.l14.m1.1.1.1.cmml">=</mo><mrow id="alg1.l14.m1.1.1.3" xref="alg1.l14.m1.1.1.3.cmml"><mn id="alg1.l14.m1.1.1.3.2" xref="alg1.l14.m1.1.1.3.2.cmml">1</mn><mo id="alg1.l14.m1.1.1.3.1" xref="alg1.l14.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l14.m1.1.1.3.3" mathvariant="normal" xref="alg1.l14.m1.1.1.3.3.cmml">…</mi><mo id="alg1.l14.m1.1.1.3.1a" xref="alg1.l14.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l14.m1.1.1.3.4" xref="alg1.l14.m1.1.1.3.4.cmml">E</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l14.m1.1b"><apply id="alg1.l14.m1.1.1.cmml" xref="alg1.l14.m1.1.1"><eq id="alg1.l14.m1.1.1.1.cmml" xref="alg1.l14.m1.1.1.1"></eq><ci id="alg1.l14.m1.1.1.2.cmml" xref="alg1.l14.m1.1.1.2">𝑒</ci><apply id="alg1.l14.m1.1.1.3.cmml" xref="alg1.l14.m1.1.1.3"><times id="alg1.l14.m1.1.1.3.1.cmml" xref="alg1.l14.m1.1.1.3.1"></times><cn id="alg1.l14.m1.1.1.3.2.cmml" type="integer" xref="alg1.l14.m1.1.1.3.2">1</cn><ci id="alg1.l14.m1.1.1.3.3.cmml" xref="alg1.l14.m1.1.1.3.3">…</ci><ci id="alg1.l14.m1.1.1.3.4.cmml" xref="alg1.l14.m1.1.1.3.4">𝐸</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l14.m1.1c">e=1\dots E</annotation><annotation encoding="application/x-llamapun" id="alg1.l14.m1.1d">italic_e = 1 … italic_E</annotation></semantics></math>&nbsp;<span class="ltx_text ltx_font_bold" id="alg1.l14.2">do</span>
</div>
<div class="ltx_listingline" id="alg1.l15">
<span class="ltx_tag ltx_tag_listingline">15:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<math alttext="\theta^{e}\approx\operatorname*{arg\,min}_{\theta^{e}}\mathcal{L}(\mathbf{X}_{%
e};\theta^{e})" class="ltx_Math" display="inline" id="alg1.l15.m1.2"><semantics id="alg1.l15.m1.2a"><mrow id="alg1.l15.m1.2.2" xref="alg1.l15.m1.2.2.cmml"><msup id="alg1.l15.m1.2.2.4" xref="alg1.l15.m1.2.2.4.cmml"><mi id="alg1.l15.m1.2.2.4.2" xref="alg1.l15.m1.2.2.4.2.cmml">θ</mi><mi id="alg1.l15.m1.2.2.4.3" xref="alg1.l15.m1.2.2.4.3.cmml">e</mi></msup><mo id="alg1.l15.m1.2.2.3" xref="alg1.l15.m1.2.2.3.cmml">≈</mo><mrow id="alg1.l15.m1.2.2.2" xref="alg1.l15.m1.2.2.2.cmml"><mrow id="alg1.l15.m1.2.2.2.4" xref="alg1.l15.m1.2.2.2.4.cmml"><msub id="alg1.l15.m1.2.2.2.4.1" xref="alg1.l15.m1.2.2.2.4.1.cmml"><mrow id="alg1.l15.m1.2.2.2.4.1.2" xref="alg1.l15.m1.2.2.2.4.1.2.cmml"><mi id="alg1.l15.m1.2.2.2.4.1.2.2" xref="alg1.l15.m1.2.2.2.4.1.2.2.cmml">arg</mi><mo id="alg1.l15.m1.2.2.2.4.1.2.1" lspace="0.170em" xref="alg1.l15.m1.2.2.2.4.1.2.1.cmml">⁢</mo><mi id="alg1.l15.m1.2.2.2.4.1.2.3" xref="alg1.l15.m1.2.2.2.4.1.2.3.cmml">min</mi></mrow><msup id="alg1.l15.m1.2.2.2.4.1.3" xref="alg1.l15.m1.2.2.2.4.1.3.cmml"><mi id="alg1.l15.m1.2.2.2.4.1.3.2" xref="alg1.l15.m1.2.2.2.4.1.3.2.cmml">θ</mi><mi id="alg1.l15.m1.2.2.2.4.1.3.3" xref="alg1.l15.m1.2.2.2.4.1.3.3.cmml">e</mi></msup></msub><mo id="alg1.l15.m1.2.2.2.4a" xref="alg1.l15.m1.2.2.2.4.cmml">⁡</mo><mi class="ltx_font_mathcaligraphic" id="alg1.l15.m1.2.2.2.4.2" xref="alg1.l15.m1.2.2.2.4.2.cmml">ℒ</mi></mrow><mo id="alg1.l15.m1.2.2.2.3" xref="alg1.l15.m1.2.2.2.3.cmml">⁢</mo><mrow id="alg1.l15.m1.2.2.2.2.2" xref="alg1.l15.m1.2.2.2.2.3.cmml"><mo id="alg1.l15.m1.2.2.2.2.2.3" stretchy="false" xref="alg1.l15.m1.2.2.2.2.3.cmml">(</mo><msub id="alg1.l15.m1.1.1.1.1.1.1" xref="alg1.l15.m1.1.1.1.1.1.1.cmml"><mi id="alg1.l15.m1.1.1.1.1.1.1.2" xref="alg1.l15.m1.1.1.1.1.1.1.2.cmml">𝐗</mi><mi id="alg1.l15.m1.1.1.1.1.1.1.3" xref="alg1.l15.m1.1.1.1.1.1.1.3.cmml">e</mi></msub><mo id="alg1.l15.m1.2.2.2.2.2.4" xref="alg1.l15.m1.2.2.2.2.3.cmml">;</mo><msup id="alg1.l15.m1.2.2.2.2.2.2" xref="alg1.l15.m1.2.2.2.2.2.2.cmml"><mi id="alg1.l15.m1.2.2.2.2.2.2.2" xref="alg1.l15.m1.2.2.2.2.2.2.2.cmml">θ</mi><mi id="alg1.l15.m1.2.2.2.2.2.2.3" xref="alg1.l15.m1.2.2.2.2.2.2.3.cmml">e</mi></msup><mo id="alg1.l15.m1.2.2.2.2.2.5" stretchy="false" xref="alg1.l15.m1.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l15.m1.2b"><apply id="alg1.l15.m1.2.2.cmml" xref="alg1.l15.m1.2.2"><approx id="alg1.l15.m1.2.2.3.cmml" xref="alg1.l15.m1.2.2.3"></approx><apply id="alg1.l15.m1.2.2.4.cmml" xref="alg1.l15.m1.2.2.4"><csymbol cd="ambiguous" id="alg1.l15.m1.2.2.4.1.cmml" xref="alg1.l15.m1.2.2.4">superscript</csymbol><ci id="alg1.l15.m1.2.2.4.2.cmml" xref="alg1.l15.m1.2.2.4.2">𝜃</ci><ci id="alg1.l15.m1.2.2.4.3.cmml" xref="alg1.l15.m1.2.2.4.3">𝑒</ci></apply><apply id="alg1.l15.m1.2.2.2.cmml" xref="alg1.l15.m1.2.2.2"><times id="alg1.l15.m1.2.2.2.3.cmml" xref="alg1.l15.m1.2.2.2.3"></times><apply id="alg1.l15.m1.2.2.2.4.cmml" xref="alg1.l15.m1.2.2.2.4"><apply id="alg1.l15.m1.2.2.2.4.1.cmml" xref="alg1.l15.m1.2.2.2.4.1"><csymbol cd="ambiguous" id="alg1.l15.m1.2.2.2.4.1.1.cmml" xref="alg1.l15.m1.2.2.2.4.1">subscript</csymbol><apply id="alg1.l15.m1.2.2.2.4.1.2.cmml" xref="alg1.l15.m1.2.2.2.4.1.2"><times id="alg1.l15.m1.2.2.2.4.1.2.1.cmml" xref="alg1.l15.m1.2.2.2.4.1.2.1"></times><ci id="alg1.l15.m1.2.2.2.4.1.2.2.cmml" xref="alg1.l15.m1.2.2.2.4.1.2.2">arg</ci><ci id="alg1.l15.m1.2.2.2.4.1.2.3.cmml" xref="alg1.l15.m1.2.2.2.4.1.2.3">min</ci></apply><apply id="alg1.l15.m1.2.2.2.4.1.3.cmml" xref="alg1.l15.m1.2.2.2.4.1.3"><csymbol cd="ambiguous" id="alg1.l15.m1.2.2.2.4.1.3.1.cmml" xref="alg1.l15.m1.2.2.2.4.1.3">superscript</csymbol><ci id="alg1.l15.m1.2.2.2.4.1.3.2.cmml" xref="alg1.l15.m1.2.2.2.4.1.3.2">𝜃</ci><ci id="alg1.l15.m1.2.2.2.4.1.3.3.cmml" xref="alg1.l15.m1.2.2.2.4.1.3.3">𝑒</ci></apply></apply><ci id="alg1.l15.m1.2.2.2.4.2.cmml" xref="alg1.l15.m1.2.2.2.4.2">ℒ</ci></apply><list id="alg1.l15.m1.2.2.2.2.3.cmml" xref="alg1.l15.m1.2.2.2.2.2"><apply id="alg1.l15.m1.1.1.1.1.1.1.cmml" xref="alg1.l15.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l15.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l15.m1.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l15.m1.1.1.1.1.1.1.2.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.2">𝐗</ci><ci id="alg1.l15.m1.1.1.1.1.1.1.3.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.3">𝑒</ci></apply><apply id="alg1.l15.m1.2.2.2.2.2.2.cmml" xref="alg1.l15.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l15.m1.2.2.2.2.2.2.1.cmml" xref="alg1.l15.m1.2.2.2.2.2.2">superscript</csymbol><ci id="alg1.l15.m1.2.2.2.2.2.2.2.cmml" xref="alg1.l15.m1.2.2.2.2.2.2.2">𝜃</ci><ci id="alg1.l15.m1.2.2.2.2.2.2.3.cmml" xref="alg1.l15.m1.2.2.2.2.2.2.3">𝑒</ci></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l15.m1.2c">\theta^{e}\approx\operatorname*{arg\,min}_{\theta^{e}}\mathcal{L}(\mathbf{X}_{%
e};\theta^{e})</annotation><annotation encoding="application/x-llamapun" id="alg1.l15.m1.2d">italic_θ start_POSTSUPERSCRIPT italic_e end_POSTSUPERSCRIPT ≈ start_OPERATOR roman_arg roman_min end_OPERATOR start_POSTSUBSCRIPT italic_θ start_POSTSUPERSCRIPT italic_e end_POSTSUPERSCRIPT end_POSTSUBSCRIPT caligraphic_L ( bold_X start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT ; italic_θ start_POSTSUPERSCRIPT italic_e end_POSTSUPERSCRIPT )</annotation></semantics></math>
<span class="ltx_text" id="alg1.l15.1" style="float:right;"><span class="ltx_text" id="alg1.l15.1.1" style="color:#808080;"># Optimize Equation&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#S2.E1" title="In Language modeling ‣ 2.1 Background ‣ 2 Method ‣ No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_tag">1</span></a> with SGD for the <math alttext="e" class="ltx_Math" display="inline" id="alg1.l15.1.1.m1.1"><semantics id="alg1.l15.1.1.m1.1a"><mi id="alg1.l15.1.1.m1.1.1" mathcolor="#808080" xref="alg1.l15.1.1.m1.1.1.cmml">e</mi><annotation-xml encoding="MathML-Content" id="alg1.l15.1.1.m1.1b"><ci id="alg1.l15.1.1.m1.1.1.cmml" xref="alg1.l15.1.1.m1.1.1">𝑒</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l15.1.1.m1.1c">e</annotation><annotation encoding="application/x-llamapun" id="alg1.l15.1.1.m1.1d">italic_e</annotation></semantics></math>-th expert</span>
</span>
</div>
<div class="ltx_listingline" id="alg1.l16">
<span class="ltx_tag ltx_tag_listingline">16:</span><span class="ltx_text ltx_font_bold" id="alg1.l16.1">end</span>&nbsp;<span class="ltx_text ltx_font_bold" id="alg1.l16.2">for</span>
</div>
</div>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</section>
<section class="ltx_paragraph" id="S2.SS2.SSS0.Px3">
<h5 class="ltx_title ltx_title_paragraph">Training Procedure</h5><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S2.SS2.SSS0.Px3.p1">
<p class="ltx_p" id="S2.SS2.SSS0.Px3.p1.1">We train our proposed hard mixture of experts with EM. Namely we alternate between a step of optimizing equation&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#S2.E1" title="In Language modeling ‣ 2.1 Background ‣ 2 Method ‣ No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_tag">1</span></a> and a step of assignments according to equation&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#S2.E4" title="In Routing With Independent Language Models ‣ 2.2 SmallTalk LM ‣ 2 Method ‣ No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_tag">4</span></a>. In our framework, assignments <math alttext="e^{\star}" class="ltx_Math" display="inline" id="S2.SS2.SSS0.Px3.p1.1.m1.1"><semantics id="S2.SS2.SSS0.Px3.p1.1.m1.1a"><msup id="S2.SS2.SSS0.Px3.p1.1.m1.1.1" xref="S2.SS2.SSS0.Px3.p1.1.m1.1.1.cmml"><mi id="S2.SS2.SSS0.Px3.p1.1.m1.1.1.2" xref="S2.SS2.SSS0.Px3.p1.1.m1.1.1.2.cmml">e</mi><mo id="S2.SS2.SSS0.Px3.p1.1.m1.1.1.3" xref="S2.SS2.SSS0.Px3.p1.1.m1.1.1.3.cmml">⋆</mo></msup><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS0.Px3.p1.1.m1.1b"><apply id="S2.SS2.SSS0.Px3.p1.1.m1.1.1.cmml" xref="S2.SS2.SSS0.Px3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS0.Px3.p1.1.m1.1.1.1.cmml" xref="S2.SS2.SSS0.Px3.p1.1.m1.1.1">superscript</csymbol><ci id="S2.SS2.SSS0.Px3.p1.1.m1.1.1.2.cmml" xref="S2.SS2.SSS0.Px3.p1.1.m1.1.1.2">𝑒</ci><ci id="S2.SS2.SSS0.Px3.p1.1.m1.1.1.3.cmml" xref="S2.SS2.SSS0.Px3.p1.1.m1.1.1.3">⋆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS0.Px3.p1.1.m1.1c">e^{\star}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS0.Px3.p1.1.m1.1d">italic_e start_POSTSUPERSCRIPT ⋆ end_POSTSUPERSCRIPT</annotation></semantics></math> purposefully do not depend on the experts, and the routers are independent language models. This allows us to split the training in two stages:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<ol class="ltx_enumerate" id="S2.I2">
<li class="ltx_item" id="S2.I2.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span>
<div class="ltx_para" id="S2.I2.i1.p1">
<p class="ltx_p" id="S2.I2.i1.p1.1">We train the routers using EM without using the experts at all, namely we minimize</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equation ltx_eqn_table" id="S2.E9">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}(\mathbf{x},\theta^{r})=-\log p(e^{\star}\mid\mathbf{x}_{1:M};%
\theta^{r})=-\sum_{s=1}^{M-1}\log p\left(x_{s+1}|\mathbf{x}_{1:s};\theta^{r,e^%
{\star}}\right)," class="ltx_Math" display="block" id="S2.E9.m1.4"><semantics id="S2.E9.m1.4a"><mrow id="S2.E9.m1.4.4.1" xref="S2.E9.m1.4.4.1.1.cmml"><mrow id="S2.E9.m1.4.4.1.1" xref="S2.E9.m1.4.4.1.1.cmml"><mrow id="S2.E9.m1.4.4.1.1.1" xref="S2.E9.m1.4.4.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E9.m1.4.4.1.1.1.3" xref="S2.E9.m1.4.4.1.1.1.3.cmml">ℒ</mi><mo id="S2.E9.m1.4.4.1.1.1.2" xref="S2.E9.m1.4.4.1.1.1.2.cmml">⁢</mo><mrow id="S2.E9.m1.4.4.1.1.1.1.1" xref="S2.E9.m1.4.4.1.1.1.1.2.cmml"><mo id="S2.E9.m1.4.4.1.1.1.1.1.2" stretchy="false" xref="S2.E9.m1.4.4.1.1.1.1.2.cmml">(</mo><mi id="S2.E9.m1.3.3" xref="S2.E9.m1.3.3.cmml">𝐱</mi><mo id="S2.E9.m1.4.4.1.1.1.1.1.3" xref="S2.E9.m1.4.4.1.1.1.1.2.cmml">,</mo><msup id="S2.E9.m1.4.4.1.1.1.1.1.1" xref="S2.E9.m1.4.4.1.1.1.1.1.1.cmml"><mi id="S2.E9.m1.4.4.1.1.1.1.1.1.2" xref="S2.E9.m1.4.4.1.1.1.1.1.1.2.cmml">θ</mi><mi id="S2.E9.m1.4.4.1.1.1.1.1.1.3" xref="S2.E9.m1.4.4.1.1.1.1.1.1.3.cmml">r</mi></msup><mo id="S2.E9.m1.4.4.1.1.1.1.1.4" stretchy="false" xref="S2.E9.m1.4.4.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S2.E9.m1.4.4.1.1.5" xref="S2.E9.m1.4.4.1.1.5.cmml">=</mo><mrow id="S2.E9.m1.4.4.1.1.2" xref="S2.E9.m1.4.4.1.1.2.cmml"><mo id="S2.E9.m1.4.4.1.1.2a" rspace="0.167em" xref="S2.E9.m1.4.4.1.1.2.cmml">−</mo><mrow id="S2.E9.m1.4.4.1.1.2.1" xref="S2.E9.m1.4.4.1.1.2.1.cmml"><mrow id="S2.E9.m1.4.4.1.1.2.1.3" xref="S2.E9.m1.4.4.1.1.2.1.3.cmml"><mi id="S2.E9.m1.4.4.1.1.2.1.3.1" xref="S2.E9.m1.4.4.1.1.2.1.3.1.cmml">log</mi><mo id="S2.E9.m1.4.4.1.1.2.1.3a" lspace="0.167em" xref="S2.E9.m1.4.4.1.1.2.1.3.cmml">⁡</mo><mi id="S2.E9.m1.4.4.1.1.2.1.3.2" xref="S2.E9.m1.4.4.1.1.2.1.3.2.cmml">p</mi></mrow><mo id="S2.E9.m1.4.4.1.1.2.1.2" xref="S2.E9.m1.4.4.1.1.2.1.2.cmml">⁢</mo><mrow id="S2.E9.m1.4.4.1.1.2.1.1.1" xref="S2.E9.m1.4.4.1.1.2.1.1.1.1.cmml"><mo id="S2.E9.m1.4.4.1.1.2.1.1.1.2" stretchy="false" xref="S2.E9.m1.4.4.1.1.2.1.1.1.1.cmml">(</mo><mrow id="S2.E9.m1.4.4.1.1.2.1.1.1.1" xref="S2.E9.m1.4.4.1.1.2.1.1.1.1.cmml"><msup id="S2.E9.m1.4.4.1.1.2.1.1.1.1.4" xref="S2.E9.m1.4.4.1.1.2.1.1.1.1.4.cmml"><mi id="S2.E9.m1.4.4.1.1.2.1.1.1.1.4.2" xref="S2.E9.m1.4.4.1.1.2.1.1.1.1.4.2.cmml">e</mi><mo id="S2.E9.m1.4.4.1.1.2.1.1.1.1.4.3" xref="S2.E9.m1.4.4.1.1.2.1.1.1.1.4.3.cmml">⋆</mo></msup><mo id="S2.E9.m1.4.4.1.1.2.1.1.1.1.3" xref="S2.E9.m1.4.4.1.1.2.1.1.1.1.3.cmml">∣</mo><mrow id="S2.E9.m1.4.4.1.1.2.1.1.1.1.2.2" xref="S2.E9.m1.4.4.1.1.2.1.1.1.1.2.3.cmml"><msub id="S2.E9.m1.4.4.1.1.2.1.1.1.1.1.1.1" xref="S2.E9.m1.4.4.1.1.2.1.1.1.1.1.1.1.cmml"><mi id="S2.E9.m1.4.4.1.1.2.1.1.1.1.1.1.1.2" xref="S2.E9.m1.4.4.1.1.2.1.1.1.1.1.1.1.2.cmml">𝐱</mi><mrow id="S2.E9.m1.4.4.1.1.2.1.1.1.1.1.1.1.3" xref="S2.E9.m1.4.4.1.1.2.1.1.1.1.1.1.1.3.cmml"><mn id="S2.E9.m1.4.4.1.1.2.1.1.1.1.1.1.1.3.2" xref="S2.E9.m1.4.4.1.1.2.1.1.1.1.1.1.1.3.2.cmml">1</mn><mo id="S2.E9.m1.4.4.1.1.2.1.1.1.1.1.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="S2.E9.m1.4.4.1.1.2.1.1.1.1.1.1.1.3.1.cmml">:</mo><mi id="S2.E9.m1.4.4.1.1.2.1.1.1.1.1.1.1.3.3" xref="S2.E9.m1.4.4.1.1.2.1.1.1.1.1.1.1.3.3.cmml">M</mi></mrow></msub><mo id="S2.E9.m1.4.4.1.1.2.1.1.1.1.2.2.3" xref="S2.E9.m1.4.4.1.1.2.1.1.1.1.2.3.cmml">;</mo><msup id="S2.E9.m1.4.4.1.1.2.1.1.1.1.2.2.2" xref="S2.E9.m1.4.4.1.1.2.1.1.1.1.2.2.2.cmml"><mi id="S2.E9.m1.4.4.1.1.2.1.1.1.1.2.2.2.2" xref="S2.E9.m1.4.4.1.1.2.1.1.1.1.2.2.2.2.cmml">θ</mi><mi id="S2.E9.m1.4.4.1.1.2.1.1.1.1.2.2.2.3" xref="S2.E9.m1.4.4.1.1.2.1.1.1.1.2.2.2.3.cmml">r</mi></msup></mrow></mrow><mo id="S2.E9.m1.4.4.1.1.2.1.1.1.3" stretchy="false" xref="S2.E9.m1.4.4.1.1.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E9.m1.4.4.1.1.6" xref="S2.E9.m1.4.4.1.1.6.cmml">=</mo><mrow id="S2.E9.m1.4.4.1.1.3" xref="S2.E9.m1.4.4.1.1.3.cmml"><mo id="S2.E9.m1.4.4.1.1.3a" xref="S2.E9.m1.4.4.1.1.3.cmml">−</mo><mrow id="S2.E9.m1.4.4.1.1.3.1" xref="S2.E9.m1.4.4.1.1.3.1.cmml"><munderover id="S2.E9.m1.4.4.1.1.3.1.2" xref="S2.E9.m1.4.4.1.1.3.1.2.cmml"><mo id="S2.E9.m1.4.4.1.1.3.1.2.2.2" movablelimits="false" xref="S2.E9.m1.4.4.1.1.3.1.2.2.2.cmml">∑</mo><mrow id="S2.E9.m1.4.4.1.1.3.1.2.2.3" xref="S2.E9.m1.4.4.1.1.3.1.2.2.3.cmml"><mi id="S2.E9.m1.4.4.1.1.3.1.2.2.3.2" xref="S2.E9.m1.4.4.1.1.3.1.2.2.3.2.cmml">s</mi><mo id="S2.E9.m1.4.4.1.1.3.1.2.2.3.1" xref="S2.E9.m1.4.4.1.1.3.1.2.2.3.1.cmml">=</mo><mn id="S2.E9.m1.4.4.1.1.3.1.2.2.3.3" xref="S2.E9.m1.4.4.1.1.3.1.2.2.3.3.cmml">1</mn></mrow><mrow id="S2.E9.m1.4.4.1.1.3.1.2.3" xref="S2.E9.m1.4.4.1.1.3.1.2.3.cmml"><mi id="S2.E9.m1.4.4.1.1.3.1.2.3.2" xref="S2.E9.m1.4.4.1.1.3.1.2.3.2.cmml">M</mi><mo id="S2.E9.m1.4.4.1.1.3.1.2.3.1" xref="S2.E9.m1.4.4.1.1.3.1.2.3.1.cmml">−</mo><mn id="S2.E9.m1.4.4.1.1.3.1.2.3.3" xref="S2.E9.m1.4.4.1.1.3.1.2.3.3.cmml">1</mn></mrow></munderover><mrow id="S2.E9.m1.4.4.1.1.3.1.1" xref="S2.E9.m1.4.4.1.1.3.1.1.cmml"><mrow id="S2.E9.m1.4.4.1.1.3.1.1.3" xref="S2.E9.m1.4.4.1.1.3.1.1.3.cmml"><mi id="S2.E9.m1.4.4.1.1.3.1.1.3.1" xref="S2.E9.m1.4.4.1.1.3.1.1.3.1.cmml">log</mi><mo id="S2.E9.m1.4.4.1.1.3.1.1.3a" lspace="0.167em" xref="S2.E9.m1.4.4.1.1.3.1.1.3.cmml">⁡</mo><mi id="S2.E9.m1.4.4.1.1.3.1.1.3.2" xref="S2.E9.m1.4.4.1.1.3.1.1.3.2.cmml">p</mi></mrow><mo id="S2.E9.m1.4.4.1.1.3.1.1.2" xref="S2.E9.m1.4.4.1.1.3.1.1.2.cmml">⁢</mo><mrow id="S2.E9.m1.4.4.1.1.3.1.1.1.1" xref="S2.E9.m1.4.4.1.1.3.1.1.1.1.1.cmml"><mo id="S2.E9.m1.4.4.1.1.3.1.1.1.1.2" xref="S2.E9.m1.4.4.1.1.3.1.1.1.1.1.cmml">(</mo><mrow id="S2.E9.m1.4.4.1.1.3.1.1.1.1.1" xref="S2.E9.m1.4.4.1.1.3.1.1.1.1.1.cmml"><msub id="S2.E9.m1.4.4.1.1.3.1.1.1.1.1.4" xref="S2.E9.m1.4.4.1.1.3.1.1.1.1.1.4.cmml"><mi id="S2.E9.m1.4.4.1.1.3.1.1.1.1.1.4.2" xref="S2.E9.m1.4.4.1.1.3.1.1.1.1.1.4.2.cmml">x</mi><mrow id="S2.E9.m1.4.4.1.1.3.1.1.1.1.1.4.3" xref="S2.E9.m1.4.4.1.1.3.1.1.1.1.1.4.3.cmml"><mi id="S2.E9.m1.4.4.1.1.3.1.1.1.1.1.4.3.2" xref="S2.E9.m1.4.4.1.1.3.1.1.1.1.1.4.3.2.cmml">s</mi><mo id="S2.E9.m1.4.4.1.1.3.1.1.1.1.1.4.3.1" xref="S2.E9.m1.4.4.1.1.3.1.1.1.1.1.4.3.1.cmml">+</mo><mn id="S2.E9.m1.4.4.1.1.3.1.1.1.1.1.4.3.3" xref="S2.E9.m1.4.4.1.1.3.1.1.1.1.1.4.3.3.cmml">1</mn></mrow></msub><mo fence="false" id="S2.E9.m1.4.4.1.1.3.1.1.1.1.1.3" xref="S2.E9.m1.4.4.1.1.3.1.1.1.1.1.3.cmml">|</mo><mrow id="S2.E9.m1.4.4.1.1.3.1.1.1.1.1.2.2" xref="S2.E9.m1.4.4.1.1.3.1.1.1.1.1.2.3.cmml"><msub id="S2.E9.m1.4.4.1.1.3.1.1.1.1.1.1.1.1" xref="S2.E9.m1.4.4.1.1.3.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E9.m1.4.4.1.1.3.1.1.1.1.1.1.1.1.2" xref="S2.E9.m1.4.4.1.1.3.1.1.1.1.1.1.1.1.2.cmml">𝐱</mi><mrow id="S2.E9.m1.4.4.1.1.3.1.1.1.1.1.1.1.1.3" xref="S2.E9.m1.4.4.1.1.3.1.1.1.1.1.1.1.1.3.cmml"><mn id="S2.E9.m1.4.4.1.1.3.1.1.1.1.1.1.1.1.3.2" xref="S2.E9.m1.4.4.1.1.3.1.1.1.1.1.1.1.1.3.2.cmml">1</mn><mo id="S2.E9.m1.4.4.1.1.3.1.1.1.1.1.1.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="S2.E9.m1.4.4.1.1.3.1.1.1.1.1.1.1.1.3.1.cmml">:</mo><mi id="S2.E9.m1.4.4.1.1.3.1.1.1.1.1.1.1.1.3.3" xref="S2.E9.m1.4.4.1.1.3.1.1.1.1.1.1.1.1.3.3.cmml">s</mi></mrow></msub><mo id="S2.E9.m1.4.4.1.1.3.1.1.1.1.1.2.2.3" xref="S2.E9.m1.4.4.1.1.3.1.1.1.1.1.2.3.cmml">;</mo><msup id="S2.E9.m1.4.4.1.1.3.1.1.1.1.1.2.2.2" xref="S2.E9.m1.4.4.1.1.3.1.1.1.1.1.2.2.2.cmml"><mi id="S2.E9.m1.4.4.1.1.3.1.1.1.1.1.2.2.2.2" xref="S2.E9.m1.4.4.1.1.3.1.1.1.1.1.2.2.2.2.cmml">θ</mi><mrow id="S2.E9.m1.2.2.2.2" xref="S2.E9.m1.2.2.2.3.cmml"><mi id="S2.E9.m1.1.1.1.1" xref="S2.E9.m1.1.1.1.1.cmml">r</mi><mo id="S2.E9.m1.2.2.2.2.2" xref="S2.E9.m1.2.2.2.3.cmml">,</mo><msup id="S2.E9.m1.2.2.2.2.1" xref="S2.E9.m1.2.2.2.2.1.cmml"><mi id="S2.E9.m1.2.2.2.2.1.2" xref="S2.E9.m1.2.2.2.2.1.2.cmml">e</mi><mo id="S2.E9.m1.2.2.2.2.1.3" xref="S2.E9.m1.2.2.2.2.1.3.cmml">⋆</mo></msup></mrow></msup></mrow></mrow><mo id="S2.E9.m1.4.4.1.1.3.1.1.1.1.3" xref="S2.E9.m1.4.4.1.1.3.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="S2.E9.m1.4.4.1.2" xref="S2.E9.m1.4.4.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E9.m1.4b"><apply id="S2.E9.m1.4.4.1.1.cmml" xref="S2.E9.m1.4.4.1"><and id="S2.E9.m1.4.4.1.1a.cmml" xref="S2.E9.m1.4.4.1"></and><apply id="S2.E9.m1.4.4.1.1b.cmml" xref="S2.E9.m1.4.4.1"><eq id="S2.E9.m1.4.4.1.1.5.cmml" xref="S2.E9.m1.4.4.1.1.5"></eq><apply id="S2.E9.m1.4.4.1.1.1.cmml" xref="S2.E9.m1.4.4.1.1.1"><times id="S2.E9.m1.4.4.1.1.1.2.cmml" xref="S2.E9.m1.4.4.1.1.1.2"></times><ci id="S2.E9.m1.4.4.1.1.1.3.cmml" xref="S2.E9.m1.4.4.1.1.1.3">ℒ</ci><interval closure="open" id="S2.E9.m1.4.4.1.1.1.1.2.cmml" xref="S2.E9.m1.4.4.1.1.1.1.1"><ci id="S2.E9.m1.3.3.cmml" xref="S2.E9.m1.3.3">𝐱</ci><apply id="S2.E9.m1.4.4.1.1.1.1.1.1.cmml" xref="S2.E9.m1.4.4.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E9.m1.4.4.1.1.1.1.1.1.1.cmml" xref="S2.E9.m1.4.4.1.1.1.1.1.1">superscript</csymbol><ci id="S2.E9.m1.4.4.1.1.1.1.1.1.2.cmml" xref="S2.E9.m1.4.4.1.1.1.1.1.1.2">𝜃</ci><ci id="S2.E9.m1.4.4.1.1.1.1.1.1.3.cmml" xref="S2.E9.m1.4.4.1.1.1.1.1.1.3">𝑟</ci></apply></interval></apply><apply id="S2.E9.m1.4.4.1.1.2.cmml" xref="S2.E9.m1.4.4.1.1.2"><minus id="S2.E9.m1.4.4.1.1.2.2.cmml" xref="S2.E9.m1.4.4.1.1.2"></minus><apply id="S2.E9.m1.4.4.1.1.2.1.cmml" xref="S2.E9.m1.4.4.1.1.2.1"><times id="S2.E9.m1.4.4.1.1.2.1.2.cmml" xref="S2.E9.m1.4.4.1.1.2.1.2"></times><apply id="S2.E9.m1.4.4.1.1.2.1.3.cmml" xref="S2.E9.m1.4.4.1.1.2.1.3"><log id="S2.E9.m1.4.4.1.1.2.1.3.1.cmml" xref="S2.E9.m1.4.4.1.1.2.1.3.1"></log><ci id="S2.E9.m1.4.4.1.1.2.1.3.2.cmml" xref="S2.E9.m1.4.4.1.1.2.1.3.2">𝑝</ci></apply><apply id="S2.E9.m1.4.4.1.1.2.1.1.1.1.cmml" xref="S2.E9.m1.4.4.1.1.2.1.1.1"><csymbol cd="latexml" id="S2.E9.m1.4.4.1.1.2.1.1.1.1.3.cmml" xref="S2.E9.m1.4.4.1.1.2.1.1.1.1.3">conditional</csymbol><apply id="S2.E9.m1.4.4.1.1.2.1.1.1.1.4.cmml" xref="S2.E9.m1.4.4.1.1.2.1.1.1.1.4"><csymbol cd="ambiguous" id="S2.E9.m1.4.4.1.1.2.1.1.1.1.4.1.cmml" xref="S2.E9.m1.4.4.1.1.2.1.1.1.1.4">superscript</csymbol><ci id="S2.E9.m1.4.4.1.1.2.1.1.1.1.4.2.cmml" xref="S2.E9.m1.4.4.1.1.2.1.1.1.1.4.2">𝑒</ci><ci id="S2.E9.m1.4.4.1.1.2.1.1.1.1.4.3.cmml" xref="S2.E9.m1.4.4.1.1.2.1.1.1.1.4.3">⋆</ci></apply><list id="S2.E9.m1.4.4.1.1.2.1.1.1.1.2.3.cmml" xref="S2.E9.m1.4.4.1.1.2.1.1.1.1.2.2"><apply id="S2.E9.m1.4.4.1.1.2.1.1.1.1.1.1.1.cmml" xref="S2.E9.m1.4.4.1.1.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E9.m1.4.4.1.1.2.1.1.1.1.1.1.1.1.cmml" xref="S2.E9.m1.4.4.1.1.2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E9.m1.4.4.1.1.2.1.1.1.1.1.1.1.2.cmml" xref="S2.E9.m1.4.4.1.1.2.1.1.1.1.1.1.1.2">𝐱</ci><apply id="S2.E9.m1.4.4.1.1.2.1.1.1.1.1.1.1.3.cmml" xref="S2.E9.m1.4.4.1.1.2.1.1.1.1.1.1.1.3"><ci id="S2.E9.m1.4.4.1.1.2.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E9.m1.4.4.1.1.2.1.1.1.1.1.1.1.3.1">:</ci><cn id="S2.E9.m1.4.4.1.1.2.1.1.1.1.1.1.1.3.2.cmml" type="integer" xref="S2.E9.m1.4.4.1.1.2.1.1.1.1.1.1.1.3.2">1</cn><ci id="S2.E9.m1.4.4.1.1.2.1.1.1.1.1.1.1.3.3.cmml" xref="S2.E9.m1.4.4.1.1.2.1.1.1.1.1.1.1.3.3">𝑀</ci></apply></apply><apply id="S2.E9.m1.4.4.1.1.2.1.1.1.1.2.2.2.cmml" xref="S2.E9.m1.4.4.1.1.2.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S2.E9.m1.4.4.1.1.2.1.1.1.1.2.2.2.1.cmml" xref="S2.E9.m1.4.4.1.1.2.1.1.1.1.2.2.2">superscript</csymbol><ci id="S2.E9.m1.4.4.1.1.2.1.1.1.1.2.2.2.2.cmml" xref="S2.E9.m1.4.4.1.1.2.1.1.1.1.2.2.2.2">𝜃</ci><ci id="S2.E9.m1.4.4.1.1.2.1.1.1.1.2.2.2.3.cmml" xref="S2.E9.m1.4.4.1.1.2.1.1.1.1.2.2.2.3">𝑟</ci></apply></list></apply></apply></apply></apply><apply id="S2.E9.m1.4.4.1.1c.cmml" xref="S2.E9.m1.4.4.1"><eq id="S2.E9.m1.4.4.1.1.6.cmml" xref="S2.E9.m1.4.4.1.1.6"></eq><share href="https://arxiv.org/html/2410.03529v1#S2.E9.m1.4.4.1.1.2.cmml" id="S2.E9.m1.4.4.1.1d.cmml" xref="S2.E9.m1.4.4.1"></share><apply id="S2.E9.m1.4.4.1.1.3.cmml" xref="S2.E9.m1.4.4.1.1.3"><minus id="S2.E9.m1.4.4.1.1.3.2.cmml" xref="S2.E9.m1.4.4.1.1.3"></minus><apply id="S2.E9.m1.4.4.1.1.3.1.cmml" xref="S2.E9.m1.4.4.1.1.3.1"><apply id="S2.E9.m1.4.4.1.1.3.1.2.cmml" xref="S2.E9.m1.4.4.1.1.3.1.2"><csymbol cd="ambiguous" id="S2.E9.m1.4.4.1.1.3.1.2.1.cmml" xref="S2.E9.m1.4.4.1.1.3.1.2">superscript</csymbol><apply id="S2.E9.m1.4.4.1.1.3.1.2.2.cmml" xref="S2.E9.m1.4.4.1.1.3.1.2"><csymbol cd="ambiguous" id="S2.E9.m1.4.4.1.1.3.1.2.2.1.cmml" xref="S2.E9.m1.4.4.1.1.3.1.2">subscript</csymbol><sum id="S2.E9.m1.4.4.1.1.3.1.2.2.2.cmml" xref="S2.E9.m1.4.4.1.1.3.1.2.2.2"></sum><apply id="S2.E9.m1.4.4.1.1.3.1.2.2.3.cmml" xref="S2.E9.m1.4.4.1.1.3.1.2.2.3"><eq id="S2.E9.m1.4.4.1.1.3.1.2.2.3.1.cmml" xref="S2.E9.m1.4.4.1.1.3.1.2.2.3.1"></eq><ci id="S2.E9.m1.4.4.1.1.3.1.2.2.3.2.cmml" xref="S2.E9.m1.4.4.1.1.3.1.2.2.3.2">𝑠</ci><cn id="S2.E9.m1.4.4.1.1.3.1.2.2.3.3.cmml" type="integer" xref="S2.E9.m1.4.4.1.1.3.1.2.2.3.3">1</cn></apply></apply><apply id="S2.E9.m1.4.4.1.1.3.1.2.3.cmml" xref="S2.E9.m1.4.4.1.1.3.1.2.3"><minus id="S2.E9.m1.4.4.1.1.3.1.2.3.1.cmml" xref="S2.E9.m1.4.4.1.1.3.1.2.3.1"></minus><ci id="S2.E9.m1.4.4.1.1.3.1.2.3.2.cmml" xref="S2.E9.m1.4.4.1.1.3.1.2.3.2">𝑀</ci><cn id="S2.E9.m1.4.4.1.1.3.1.2.3.3.cmml" type="integer" xref="S2.E9.m1.4.4.1.1.3.1.2.3.3">1</cn></apply></apply><apply id="S2.E9.m1.4.4.1.1.3.1.1.cmml" xref="S2.E9.m1.4.4.1.1.3.1.1"><times id="S2.E9.m1.4.4.1.1.3.1.1.2.cmml" xref="S2.E9.m1.4.4.1.1.3.1.1.2"></times><apply id="S2.E9.m1.4.4.1.1.3.1.1.3.cmml" xref="S2.E9.m1.4.4.1.1.3.1.1.3"><log id="S2.E9.m1.4.4.1.1.3.1.1.3.1.cmml" xref="S2.E9.m1.4.4.1.1.3.1.1.3.1"></log><ci id="S2.E9.m1.4.4.1.1.3.1.1.3.2.cmml" xref="S2.E9.m1.4.4.1.1.3.1.1.3.2">𝑝</ci></apply><apply id="S2.E9.m1.4.4.1.1.3.1.1.1.1.1.cmml" xref="S2.E9.m1.4.4.1.1.3.1.1.1.1"><csymbol cd="latexml" id="S2.E9.m1.4.4.1.1.3.1.1.1.1.1.3.cmml" xref="S2.E9.m1.4.4.1.1.3.1.1.1.1.1.3">conditional</csymbol><apply id="S2.E9.m1.4.4.1.1.3.1.1.1.1.1.4.cmml" xref="S2.E9.m1.4.4.1.1.3.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S2.E9.m1.4.4.1.1.3.1.1.1.1.1.4.1.cmml" xref="S2.E9.m1.4.4.1.1.3.1.1.1.1.1.4">subscript</csymbol><ci id="S2.E9.m1.4.4.1.1.3.1.1.1.1.1.4.2.cmml" xref="S2.E9.m1.4.4.1.1.3.1.1.1.1.1.4.2">𝑥</ci><apply id="S2.E9.m1.4.4.1.1.3.1.1.1.1.1.4.3.cmml" xref="S2.E9.m1.4.4.1.1.3.1.1.1.1.1.4.3"><plus id="S2.E9.m1.4.4.1.1.3.1.1.1.1.1.4.3.1.cmml" xref="S2.E9.m1.4.4.1.1.3.1.1.1.1.1.4.3.1"></plus><ci id="S2.E9.m1.4.4.1.1.3.1.1.1.1.1.4.3.2.cmml" xref="S2.E9.m1.4.4.1.1.3.1.1.1.1.1.4.3.2">𝑠</ci><cn id="S2.E9.m1.4.4.1.1.3.1.1.1.1.1.4.3.3.cmml" type="integer" xref="S2.E9.m1.4.4.1.1.3.1.1.1.1.1.4.3.3">1</cn></apply></apply><list id="S2.E9.m1.4.4.1.1.3.1.1.1.1.1.2.3.cmml" xref="S2.E9.m1.4.4.1.1.3.1.1.1.1.1.2.2"><apply id="S2.E9.m1.4.4.1.1.3.1.1.1.1.1.1.1.1.cmml" xref="S2.E9.m1.4.4.1.1.3.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E9.m1.4.4.1.1.3.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E9.m1.4.4.1.1.3.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E9.m1.4.4.1.1.3.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E9.m1.4.4.1.1.3.1.1.1.1.1.1.1.1.2">𝐱</ci><apply id="S2.E9.m1.4.4.1.1.3.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E9.m1.4.4.1.1.3.1.1.1.1.1.1.1.1.3"><ci id="S2.E9.m1.4.4.1.1.3.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E9.m1.4.4.1.1.3.1.1.1.1.1.1.1.1.3.1">:</ci><cn id="S2.E9.m1.4.4.1.1.3.1.1.1.1.1.1.1.1.3.2.cmml" type="integer" xref="S2.E9.m1.4.4.1.1.3.1.1.1.1.1.1.1.1.3.2">1</cn><ci id="S2.E9.m1.4.4.1.1.3.1.1.1.1.1.1.1.1.3.3.cmml" xref="S2.E9.m1.4.4.1.1.3.1.1.1.1.1.1.1.1.3.3">𝑠</ci></apply></apply><apply id="S2.E9.m1.4.4.1.1.3.1.1.1.1.1.2.2.2.cmml" xref="S2.E9.m1.4.4.1.1.3.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S2.E9.m1.4.4.1.1.3.1.1.1.1.1.2.2.2.1.cmml" xref="S2.E9.m1.4.4.1.1.3.1.1.1.1.1.2.2.2">superscript</csymbol><ci id="S2.E9.m1.4.4.1.1.3.1.1.1.1.1.2.2.2.2.cmml" xref="S2.E9.m1.4.4.1.1.3.1.1.1.1.1.2.2.2.2">𝜃</ci><list id="S2.E9.m1.2.2.2.3.cmml" xref="S2.E9.m1.2.2.2.2"><ci id="S2.E9.m1.1.1.1.1.cmml" xref="S2.E9.m1.1.1.1.1">𝑟</ci><apply id="S2.E9.m1.2.2.2.2.1.cmml" xref="S2.E9.m1.2.2.2.2.1"><csymbol cd="ambiguous" id="S2.E9.m1.2.2.2.2.1.1.cmml" xref="S2.E9.m1.2.2.2.2.1">superscript</csymbol><ci id="S2.E9.m1.2.2.2.2.1.2.cmml" xref="S2.E9.m1.2.2.2.2.1.2">𝑒</ci><ci id="S2.E9.m1.2.2.2.2.1.3.cmml" xref="S2.E9.m1.2.2.2.2.1.3">⋆</ci></apply></list></apply></list></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E9.m1.4c">\mathcal{L}(\mathbf{x},\theta^{r})=-\log p(e^{\star}\mid\mathbf{x}_{1:M};%
\theta^{r})=-\sum_{s=1}^{M-1}\log p\left(x_{s+1}|\mathbf{x}_{1:s};\theta^{r,e^%
{\star}}\right),</annotation><annotation encoding="application/x-llamapun" id="S2.E9.m1.4d">caligraphic_L ( bold_x , italic_θ start_POSTSUPERSCRIPT italic_r end_POSTSUPERSCRIPT ) = - roman_log italic_p ( italic_e start_POSTSUPERSCRIPT ⋆ end_POSTSUPERSCRIPT ∣ bold_x start_POSTSUBSCRIPT 1 : italic_M end_POSTSUBSCRIPT ; italic_θ start_POSTSUPERSCRIPT italic_r end_POSTSUPERSCRIPT ) = - ∑ start_POSTSUBSCRIPT italic_s = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_M - 1 end_POSTSUPERSCRIPT roman_log italic_p ( italic_x start_POSTSUBSCRIPT italic_s + 1 end_POSTSUBSCRIPT | bold_x start_POSTSUBSCRIPT 1 : italic_s end_POSTSUBSCRIPT ; italic_θ start_POSTSUPERSCRIPT italic_r , italic_e start_POSTSUPERSCRIPT ⋆ end_POSTSUPERSCRIPT end_POSTSUPERSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.I2.i1.p1.2">in the likelihood maximization step and perform the assignments using equation&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#S2.E4" title="In Routing With Independent Language Models ‣ 2.2 SmallTalk LM ‣ 2 Method ‣ No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_tag">4</span></a> in the expectation step.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="S2.I2.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span>
<div class="ltx_para ltx_noindent" id="S2.I2.i2.p1">
<p class="ltx_p" id="S2.I2.i2.p1.1">We train the experts as <math alttext="E" class="ltx_Math" display="inline" id="S2.I2.i2.p1.1.m1.1"><semantics id="S2.I2.i2.p1.1.m1.1a"><mi id="S2.I2.i2.p1.1.m1.1.1" xref="S2.I2.i2.p1.1.m1.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="S2.I2.i2.p1.1.m1.1b"><ci id="S2.I2.i2.p1.1.m1.1.1.cmml" xref="S2.I2.i2.p1.1.m1.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.I2.i2.p1.1.m1.1c">E</annotation><annotation encoding="application/x-llamapun" id="S2.I2.i2.p1.1.m1.1d">italic_E</annotation></semantics></math> independent language models on disjoint dataset segments selected by the trained routers.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
</ol>
<p class="ltx_p" id="S2.SS2.SSS0.Px3.p1.2">This procedure is described in pseudocode in Algorithm&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#alg1" title="Algorithm 1 ‣ Deriving a Practical Model ‣ 2.2 SmallTalk LM ‣ 2 Method ‣ No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_tag">1</span></a>.
In the specific case where the experts and the routers are the same language models (<math alttext="\theta^{e}=\theta^{r,e}" class="ltx_Math" display="inline" id="S2.SS2.SSS0.Px3.p1.2.m1.2"><semantics id="S2.SS2.SSS0.Px3.p1.2.m1.2a"><mrow id="S2.SS2.SSS0.Px3.p1.2.m1.2.3" xref="S2.SS2.SSS0.Px3.p1.2.m1.2.3.cmml"><msup id="S2.SS2.SSS0.Px3.p1.2.m1.2.3.2" xref="S2.SS2.SSS0.Px3.p1.2.m1.2.3.2.cmml"><mi id="S2.SS2.SSS0.Px3.p1.2.m1.2.3.2.2" xref="S2.SS2.SSS0.Px3.p1.2.m1.2.3.2.2.cmml">θ</mi><mi id="S2.SS2.SSS0.Px3.p1.2.m1.2.3.2.3" xref="S2.SS2.SSS0.Px3.p1.2.m1.2.3.2.3.cmml">e</mi></msup><mo id="S2.SS2.SSS0.Px3.p1.2.m1.2.3.1" xref="S2.SS2.SSS0.Px3.p1.2.m1.2.3.1.cmml">=</mo><msup id="S2.SS2.SSS0.Px3.p1.2.m1.2.3.3" xref="S2.SS2.SSS0.Px3.p1.2.m1.2.3.3.cmml"><mi id="S2.SS2.SSS0.Px3.p1.2.m1.2.3.3.2" xref="S2.SS2.SSS0.Px3.p1.2.m1.2.3.3.2.cmml">θ</mi><mrow id="S2.SS2.SSS0.Px3.p1.2.m1.2.2.2.4" xref="S2.SS2.SSS0.Px3.p1.2.m1.2.2.2.3.cmml"><mi id="S2.SS2.SSS0.Px3.p1.2.m1.1.1.1.1" xref="S2.SS2.SSS0.Px3.p1.2.m1.1.1.1.1.cmml">r</mi><mo id="S2.SS2.SSS0.Px3.p1.2.m1.2.2.2.4.1" xref="S2.SS2.SSS0.Px3.p1.2.m1.2.2.2.3.cmml">,</mo><mi id="S2.SS2.SSS0.Px3.p1.2.m1.2.2.2.2" xref="S2.SS2.SSS0.Px3.p1.2.m1.2.2.2.2.cmml">e</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS0.Px3.p1.2.m1.2b"><apply id="S2.SS2.SSS0.Px3.p1.2.m1.2.3.cmml" xref="S2.SS2.SSS0.Px3.p1.2.m1.2.3"><eq id="S2.SS2.SSS0.Px3.p1.2.m1.2.3.1.cmml" xref="S2.SS2.SSS0.Px3.p1.2.m1.2.3.1"></eq><apply id="S2.SS2.SSS0.Px3.p1.2.m1.2.3.2.cmml" xref="S2.SS2.SSS0.Px3.p1.2.m1.2.3.2"><csymbol cd="ambiguous" id="S2.SS2.SSS0.Px3.p1.2.m1.2.3.2.1.cmml" xref="S2.SS2.SSS0.Px3.p1.2.m1.2.3.2">superscript</csymbol><ci id="S2.SS2.SSS0.Px3.p1.2.m1.2.3.2.2.cmml" xref="S2.SS2.SSS0.Px3.p1.2.m1.2.3.2.2">𝜃</ci><ci id="S2.SS2.SSS0.Px3.p1.2.m1.2.3.2.3.cmml" xref="S2.SS2.SSS0.Px3.p1.2.m1.2.3.2.3">𝑒</ci></apply><apply id="S2.SS2.SSS0.Px3.p1.2.m1.2.3.3.cmml" xref="S2.SS2.SSS0.Px3.p1.2.m1.2.3.3"><csymbol cd="ambiguous" id="S2.SS2.SSS0.Px3.p1.2.m1.2.3.3.1.cmml" xref="S2.SS2.SSS0.Px3.p1.2.m1.2.3.3">superscript</csymbol><ci id="S2.SS2.SSS0.Px3.p1.2.m1.2.3.3.2.cmml" xref="S2.SS2.SSS0.Px3.p1.2.m1.2.3.3.2">𝜃</ci><list id="S2.SS2.SSS0.Px3.p1.2.m1.2.2.2.3.cmml" xref="S2.SS2.SSS0.Px3.p1.2.m1.2.2.2.4"><ci id="S2.SS2.SSS0.Px3.p1.2.m1.1.1.1.1.cmml" xref="S2.SS2.SSS0.Px3.p1.2.m1.1.1.1.1">𝑟</ci><ci id="S2.SS2.SSS0.Px3.p1.2.m1.2.2.2.2.cmml" xref="S2.SS2.SSS0.Px3.p1.2.m1.2.2.2.2">𝑒</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS0.Px3.p1.2.m1.2c">\theta^{e}=\theta^{r,e}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS0.Px3.p1.2.m1.2d">italic_θ start_POSTSUPERSCRIPT italic_e end_POSTSUPERSCRIPT = italic_θ start_POSTSUPERSCRIPT italic_r , italic_e end_POSTSUPERSCRIPT</annotation></semantics></math>) our training algorithm comes down to a regular EM algorithm where the sequences are routed to the best performing expert. In that light, we can think of each router as lightweight approximation of the corresponding expert. See §&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#S3.SS4" title="3.4 Routing analysis ‣ 3 Experiments ‣ No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_tag">3.4</span></a> for experiments where the experts themselves are used for routing.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_paragraph" id="S2.SS2.SSS0.Px4">
<h5 class="ltx_title ltx_title_paragraph">Balancing the Assignments to Experts</h5><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S2.SS2.SSS0.Px4.p1">
<p class="ltx_p" id="S2.SS2.SSS0.Px4.p1.1">A common hurdle to overcome when training mixture of experts models is to ensure that the modeling load is shared as evenly as possible across all experts, or in other words that the model is utilizing the capacity of all experts efficiently instead of relying on a few good ones.
Common ways of tackling this problem are either introducing losses that penalize uneven assignments or introducing noise into the assignments namely by sometimes performing “sub-optimal” assignments to avoid local-minima. These techniques are used in all mixture models since their introduction in <cite class="ltx_cite ltx_citemacro_cite">Jacobs et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#bib.bib24" title="">1991</a>)</cite> until more recently in <cite class="ltx_cite ltx_citemacro_cite">Fedus et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#bib.bib16" title="">2022</a>)</cite>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_figure" id="S2.F1">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S2.F1.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="523" id="S2.F1.sf1.g1" src="https://arxiv.org/html/2410.03529v1/x1.png" width="747">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(a) </span>Naive assignments</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S2.F1.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="291" id="S2.F1.sf2.g1" src="https://arxiv.org/html/2410.03529v1/x2.png" width="747">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(b) </span>Assignment with respect to the minimum in a chunk.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span><span class="ltx_text ltx_font_bold" id="S2.F1.10.1">Balanced assignments.</span> In this scenario we have <math alttext="3" class="ltx_Math" display="inline" id="S2.F1.4.m1.1"><semantics id="S2.F1.4.m1.1b"><mn id="S2.F1.4.m1.1.1" xref="S2.F1.4.m1.1.1.cmml">3</mn><annotation-xml encoding="MathML-Content" id="S2.F1.4.m1.1c"><cn id="S2.F1.4.m1.1.1.cmml" type="integer" xref="S2.F1.4.m1.1.1">3</cn></annotation-xml><annotation encoding="application/x-tex" id="S2.F1.4.m1.1d">3</annotation><annotation encoding="application/x-llamapun" id="S2.F1.4.m1.1e">3</annotation></semantics></math> experts (columns with different colors) and <math alttext="3" class="ltx_Math" display="inline" id="S2.F1.5.m2.1"><semantics id="S2.F1.5.m2.1b"><mn id="S2.F1.5.m2.1.1" xref="S2.F1.5.m2.1.1.cmml">3</mn><annotation-xml encoding="MathML-Content" id="S2.F1.5.m2.1c"><cn id="S2.F1.5.m2.1.1.cmml" type="integer" xref="S2.F1.5.m2.1.1">3</cn></annotation-xml><annotation encoding="application/x-tex" id="S2.F1.5.m2.1d">3</annotation><annotation encoding="application/x-llamapun" id="S2.F1.5.m2.1e">3</annotation></semantics></math> sequences to assign (rows) under the constraint that each expert should get <math alttext="1" class="ltx_Math" display="inline" id="S2.F1.6.m3.1"><semantics id="S2.F1.6.m3.1b"><mn id="S2.F1.6.m3.1.1" xref="S2.F1.6.m3.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="S2.F1.6.m3.1c"><cn id="S2.F1.6.m3.1.1.cmml" type="integer" xref="S2.F1.6.m3.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S2.F1.6.m3.1d">1</annotation><annotation encoding="application/x-llamapun" id="S2.F1.6.m3.1e">1</annotation></semantics></math> sequence. In&nbsp;<span class="ltx_text ltx_font_bold" id="S2.F1.11.2">(a)</span> we assign sequentially each row, by negative log-likelihood, leading to sub-optimal assignment because the first expert is full when we try to assign the last row. On the other hand, in&nbsp;<span class="ltx_text ltx_font_bold" id="S2.F1.12.3">(b)</span>, we first sort wrt to the minimum log-likelihood which results in optimal assignments.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S2.SS2.SSS0.Px4.p2">
<p class="ltx_p" id="S2.SS2.SSS0.Px4.p2.1">In our setup, we can solve this problem by ensuring that each expert is assigned equally sized distinct portions of the dataset.
However, a challenge arises when assigning data sequentially based solely on Equation&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#S2.E4" title="In Routing With Independent Language Models ‣ 2.2 SmallTalk LM ‣ 2 Method ‣ No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_tag">4</span></a>. In such cases, an expert might already have more than its fair share of the dataset assigned yet we continue to find sequences for which it has the lowest loss among all experts, as illustrated in Figure&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#S2.F1.sf1" title="In Figure 1 ‣ Balancing the Assignments to Experts ‣ 2.2 SmallTalk LM ‣ 2 Method ‣ No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_tag">1(a)</span></a>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS2.SSS0.Px4.p3">
<p class="ltx_p" id="S2.SS2.SSS0.Px4.p3.1">To overcome this issue, during training we perform the assignments considering the whole set of sequences rather than one sequence at a time. In particular, we sort the sequences based on <math alttext="-\max_{e}\log p(\mathbf{x}_{1:M}\mid e;\theta^{r})" class="ltx_Math" display="inline" id="S2.SS2.SSS0.Px4.p3.1.m1.2"><semantics id="S2.SS2.SSS0.Px4.p3.1.m1.2a"><mrow id="S2.SS2.SSS0.Px4.p3.1.m1.2.2" xref="S2.SS2.SSS0.Px4.p3.1.m1.2.2.cmml"><mo id="S2.SS2.SSS0.Px4.p3.1.m1.2.2a" rspace="0.167em" xref="S2.SS2.SSS0.Px4.p3.1.m1.2.2.cmml">−</mo><mrow id="S2.SS2.SSS0.Px4.p3.1.m1.2.2.1" xref="S2.SS2.SSS0.Px4.p3.1.m1.2.2.1.cmml"><mrow id="S2.SS2.SSS0.Px4.p3.1.m1.2.2.1.3" xref="S2.SS2.SSS0.Px4.p3.1.m1.2.2.1.3.cmml"><msub id="S2.SS2.SSS0.Px4.p3.1.m1.2.2.1.3.1" xref="S2.SS2.SSS0.Px4.p3.1.m1.2.2.1.3.1.cmml"><mi id="S2.SS2.SSS0.Px4.p3.1.m1.2.2.1.3.1.2" xref="S2.SS2.SSS0.Px4.p3.1.m1.2.2.1.3.1.2.cmml">max</mi><mi id="S2.SS2.SSS0.Px4.p3.1.m1.2.2.1.3.1.3" xref="S2.SS2.SSS0.Px4.p3.1.m1.2.2.1.3.1.3.cmml">e</mi></msub><mo id="S2.SS2.SSS0.Px4.p3.1.m1.2.2.1.3a" lspace="0.167em" xref="S2.SS2.SSS0.Px4.p3.1.m1.2.2.1.3.cmml">⁡</mo><mrow id="S2.SS2.SSS0.Px4.p3.1.m1.2.2.1.3.2" xref="S2.SS2.SSS0.Px4.p3.1.m1.2.2.1.3.2.cmml"><mi id="S2.SS2.SSS0.Px4.p3.1.m1.2.2.1.3.2.1" xref="S2.SS2.SSS0.Px4.p3.1.m1.2.2.1.3.2.1.cmml">log</mi><mo id="S2.SS2.SSS0.Px4.p3.1.m1.2.2.1.3.2a" lspace="0.167em" xref="S2.SS2.SSS0.Px4.p3.1.m1.2.2.1.3.2.cmml">⁡</mo><mi id="S2.SS2.SSS0.Px4.p3.1.m1.2.2.1.3.2.2" xref="S2.SS2.SSS0.Px4.p3.1.m1.2.2.1.3.2.2.cmml">p</mi></mrow></mrow><mo id="S2.SS2.SSS0.Px4.p3.1.m1.2.2.1.2" xref="S2.SS2.SSS0.Px4.p3.1.m1.2.2.1.2.cmml">⁢</mo><mrow id="S2.SS2.SSS0.Px4.p3.1.m1.2.2.1.1.1" xref="S2.SS2.SSS0.Px4.p3.1.m1.2.2.1.1.1.1.cmml"><mo id="S2.SS2.SSS0.Px4.p3.1.m1.2.2.1.1.1.2" stretchy="false" xref="S2.SS2.SSS0.Px4.p3.1.m1.2.2.1.1.1.1.cmml">(</mo><mrow id="S2.SS2.SSS0.Px4.p3.1.m1.2.2.1.1.1.1" xref="S2.SS2.SSS0.Px4.p3.1.m1.2.2.1.1.1.1.cmml"><msub id="S2.SS2.SSS0.Px4.p3.1.m1.2.2.1.1.1.1.3" xref="S2.SS2.SSS0.Px4.p3.1.m1.2.2.1.1.1.1.3.cmml"><mi id="S2.SS2.SSS0.Px4.p3.1.m1.2.2.1.1.1.1.3.2" xref="S2.SS2.SSS0.Px4.p3.1.m1.2.2.1.1.1.1.3.2.cmml">𝐱</mi><mrow id="S2.SS2.SSS0.Px4.p3.1.m1.2.2.1.1.1.1.3.3" xref="S2.SS2.SSS0.Px4.p3.1.m1.2.2.1.1.1.1.3.3.cmml"><mn id="S2.SS2.SSS0.Px4.p3.1.m1.2.2.1.1.1.1.3.3.2" xref="S2.SS2.SSS0.Px4.p3.1.m1.2.2.1.1.1.1.3.3.2.cmml">1</mn><mo id="S2.SS2.SSS0.Px4.p3.1.m1.2.2.1.1.1.1.3.3.1" lspace="0.278em" rspace="0.278em" xref="S2.SS2.SSS0.Px4.p3.1.m1.2.2.1.1.1.1.3.3.1.cmml">:</mo><mi id="S2.SS2.SSS0.Px4.p3.1.m1.2.2.1.1.1.1.3.3.3" xref="S2.SS2.SSS0.Px4.p3.1.m1.2.2.1.1.1.1.3.3.3.cmml">M</mi></mrow></msub><mo id="S2.SS2.SSS0.Px4.p3.1.m1.2.2.1.1.1.1.2" xref="S2.SS2.SSS0.Px4.p3.1.m1.2.2.1.1.1.1.2.cmml">∣</mo><mrow id="S2.SS2.SSS0.Px4.p3.1.m1.2.2.1.1.1.1.1.1" xref="S2.SS2.SSS0.Px4.p3.1.m1.2.2.1.1.1.1.1.2.cmml"><mi id="S2.SS2.SSS0.Px4.p3.1.m1.1.1" xref="S2.SS2.SSS0.Px4.p3.1.m1.1.1.cmml">e</mi><mo id="S2.SS2.SSS0.Px4.p3.1.m1.2.2.1.1.1.1.1.1.2" xref="S2.SS2.SSS0.Px4.p3.1.m1.2.2.1.1.1.1.1.2.cmml">;</mo><msup id="S2.SS2.SSS0.Px4.p3.1.m1.2.2.1.1.1.1.1.1.1" xref="S2.SS2.SSS0.Px4.p3.1.m1.2.2.1.1.1.1.1.1.1.cmml"><mi id="S2.SS2.SSS0.Px4.p3.1.m1.2.2.1.1.1.1.1.1.1.2" xref="S2.SS2.SSS0.Px4.p3.1.m1.2.2.1.1.1.1.1.1.1.2.cmml">θ</mi><mi id="S2.SS2.SSS0.Px4.p3.1.m1.2.2.1.1.1.1.1.1.1.3" xref="S2.SS2.SSS0.Px4.p3.1.m1.2.2.1.1.1.1.1.1.1.3.cmml">r</mi></msup></mrow></mrow><mo id="S2.SS2.SSS0.Px4.p3.1.m1.2.2.1.1.1.3" stretchy="false" xref="S2.SS2.SSS0.Px4.p3.1.m1.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS0.Px4.p3.1.m1.2b"><apply id="S2.SS2.SSS0.Px4.p3.1.m1.2.2.cmml" xref="S2.SS2.SSS0.Px4.p3.1.m1.2.2"><minus id="S2.SS2.SSS0.Px4.p3.1.m1.2.2.2.cmml" xref="S2.SS2.SSS0.Px4.p3.1.m1.2.2"></minus><apply id="S2.SS2.SSS0.Px4.p3.1.m1.2.2.1.cmml" xref="S2.SS2.SSS0.Px4.p3.1.m1.2.2.1"><times id="S2.SS2.SSS0.Px4.p3.1.m1.2.2.1.2.cmml" xref="S2.SS2.SSS0.Px4.p3.1.m1.2.2.1.2"></times><apply id="S2.SS2.SSS0.Px4.p3.1.m1.2.2.1.3.cmml" xref="S2.SS2.SSS0.Px4.p3.1.m1.2.2.1.3"><apply id="S2.SS2.SSS0.Px4.p3.1.m1.2.2.1.3.1.cmml" xref="S2.SS2.SSS0.Px4.p3.1.m1.2.2.1.3.1"><csymbol cd="ambiguous" id="S2.SS2.SSS0.Px4.p3.1.m1.2.2.1.3.1.1.cmml" xref="S2.SS2.SSS0.Px4.p3.1.m1.2.2.1.3.1">subscript</csymbol><max id="S2.SS2.SSS0.Px4.p3.1.m1.2.2.1.3.1.2.cmml" xref="S2.SS2.SSS0.Px4.p3.1.m1.2.2.1.3.1.2"></max><ci id="S2.SS2.SSS0.Px4.p3.1.m1.2.2.1.3.1.3.cmml" xref="S2.SS2.SSS0.Px4.p3.1.m1.2.2.1.3.1.3">𝑒</ci></apply><apply id="S2.SS2.SSS0.Px4.p3.1.m1.2.2.1.3.2.cmml" xref="S2.SS2.SSS0.Px4.p3.1.m1.2.2.1.3.2"><log id="S2.SS2.SSS0.Px4.p3.1.m1.2.2.1.3.2.1.cmml" xref="S2.SS2.SSS0.Px4.p3.1.m1.2.2.1.3.2.1"></log><ci id="S2.SS2.SSS0.Px4.p3.1.m1.2.2.1.3.2.2.cmml" xref="S2.SS2.SSS0.Px4.p3.1.m1.2.2.1.3.2.2">𝑝</ci></apply></apply><apply id="S2.SS2.SSS0.Px4.p3.1.m1.2.2.1.1.1.1.cmml" xref="S2.SS2.SSS0.Px4.p3.1.m1.2.2.1.1.1"><csymbol cd="latexml" id="S2.SS2.SSS0.Px4.p3.1.m1.2.2.1.1.1.1.2.cmml" xref="S2.SS2.SSS0.Px4.p3.1.m1.2.2.1.1.1.1.2">conditional</csymbol><apply id="S2.SS2.SSS0.Px4.p3.1.m1.2.2.1.1.1.1.3.cmml" xref="S2.SS2.SSS0.Px4.p3.1.m1.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.SSS0.Px4.p3.1.m1.2.2.1.1.1.1.3.1.cmml" xref="S2.SS2.SSS0.Px4.p3.1.m1.2.2.1.1.1.1.3">subscript</csymbol><ci id="S2.SS2.SSS0.Px4.p3.1.m1.2.2.1.1.1.1.3.2.cmml" xref="S2.SS2.SSS0.Px4.p3.1.m1.2.2.1.1.1.1.3.2">𝐱</ci><apply id="S2.SS2.SSS0.Px4.p3.1.m1.2.2.1.1.1.1.3.3.cmml" xref="S2.SS2.SSS0.Px4.p3.1.m1.2.2.1.1.1.1.3.3"><ci id="S2.SS2.SSS0.Px4.p3.1.m1.2.2.1.1.1.1.3.3.1.cmml" xref="S2.SS2.SSS0.Px4.p3.1.m1.2.2.1.1.1.1.3.3.1">:</ci><cn id="S2.SS2.SSS0.Px4.p3.1.m1.2.2.1.1.1.1.3.3.2.cmml" type="integer" xref="S2.SS2.SSS0.Px4.p3.1.m1.2.2.1.1.1.1.3.3.2">1</cn><ci id="S2.SS2.SSS0.Px4.p3.1.m1.2.2.1.1.1.1.3.3.3.cmml" xref="S2.SS2.SSS0.Px4.p3.1.m1.2.2.1.1.1.1.3.3.3">𝑀</ci></apply></apply><list id="S2.SS2.SSS0.Px4.p3.1.m1.2.2.1.1.1.1.1.2.cmml" xref="S2.SS2.SSS0.Px4.p3.1.m1.2.2.1.1.1.1.1.1"><ci id="S2.SS2.SSS0.Px4.p3.1.m1.1.1.cmml" xref="S2.SS2.SSS0.Px4.p3.1.m1.1.1">𝑒</ci><apply id="S2.SS2.SSS0.Px4.p3.1.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S2.SS2.SSS0.Px4.p3.1.m1.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS0.Px4.p3.1.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S2.SS2.SSS0.Px4.p3.1.m1.2.2.1.1.1.1.1.1.1">superscript</csymbol><ci id="S2.SS2.SSS0.Px4.p3.1.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="S2.SS2.SSS0.Px4.p3.1.m1.2.2.1.1.1.1.1.1.1.2">𝜃</ci><ci id="S2.SS2.SSS0.Px4.p3.1.m1.2.2.1.1.1.1.1.1.1.3.cmml" xref="S2.SS2.SSS0.Px4.p3.1.m1.2.2.1.1.1.1.1.1.1.3">𝑟</ci></apply></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS0.Px4.p3.1.m1.2c">-\max_{e}\log p(\mathbf{x}_{1:M}\mid e;\theta^{r})</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS0.Px4.p3.1.m1.2d">- roman_max start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT roman_log italic_p ( bold_x start_POSTSUBSCRIPT 1 : italic_M end_POSTSUBSCRIPT ∣ italic_e ; italic_θ start_POSTSUPERSCRIPT italic_r end_POSTSUPERSCRIPT )</annotation></semantics></math> and perform the assignments in that order. This ensures that sequences with high likelihood will be assigned first and avoids the edge-case where a sequence with low-loss cannot be assigned to the appropriate expert because it is at capacity. In Algorithm&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#alg1" title="Algorithm 1 ‣ Deriving a Practical Model ‣ 2.2 SmallTalk LM ‣ 2 Method ‣ No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_tag">1</span></a> we refer to this procedure as <em class="ltx_emph ltx_font_italic" id="S2.SS2.SSS0.Px4.p3.1.1">balanced assignments</em> and it is demonstrated in Figure&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#S2.F1.sf2" title="In Figure 1 ‣ Balancing the Assignments to Experts ‣ 2.2 SmallTalk LM ‣ 2 Method ‣ No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_tag">1(b)</span></a>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS2.SSS0.Px4.p4">
<p class="ltx_p" id="S2.SS2.SSS0.Px4.p4.1">During inference, no balancing is performed, and the expert is selected solely based on equation&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#S2.E4" title="In Routing With Independent Language Models ‣ 2.2 SmallTalk LM ‣ 2 Method ‣ No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_tag">4</span></a>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_paragraph" id="S2.SS2.SSS0.Px5">
<h5 class="ltx_title ltx_title_paragraph">Computational and Communication Cost</h5><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S2.SS2.SSS0.Px5.p1">
<p class="ltx_p" id="S2.SS2.SSS0.Px5.p1.1">It is important to note that the computational cost of training and inference with the routers is significantly lower than that of training and inference with the experts. This difference arises due to the routers’ much smaller size, smaller batch sizes, and the fewer tokens they train on (see Appendix&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#A1.SS3" title="A.3 Computational Cost ‣ Appendix A Language modeling experiments ‣ No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_tag">A.3</span></a> for further details). As a result, the additional computational overhead from training and inference with the routers is negligible.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS2.SSS0.Px5.p2">
<p class="ltx_p" id="S2.SS2.SSS0.Px5.p2.3">Regarding communication requirements for a distributed implementation, in Algorithm&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#alg1" title="Algorithm 1 ‣ Deriving a Practical Model ‣ 2.2 SmallTalk LM ‣ 2 Method ‣ No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_tag">1</span></a> all operations except for the balanced assignments are completely independent and embarrassingly parallelizable without any communication. Namely, each expert or each router can be trained on its own on a different node or set of nodes. The assignments, however, require that every node has access to the scores of every router in order to perform the assignment according to equation&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#S2.E4" title="In Routing With Independent Language Models ‣ 2.2 SmallTalk LM ‣ 2 Method ‣ No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_tag">4</span></a>. This requires a small amount of communication as each node needs to share <math alttext="1" class="ltx_Math" display="inline" id="S2.SS2.SSS0.Px5.p2.1.m1.1"><semantics id="S2.SS2.SSS0.Px5.p2.1.m1.1a"><mn id="S2.SS2.SSS0.Px5.p2.1.m1.1.1" xref="S2.SS2.SSS0.Px5.p2.1.m1.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS0.Px5.p2.1.m1.1b"><cn id="S2.SS2.SSS0.Px5.p2.1.m1.1.1.cmml" type="integer" xref="S2.SS2.SSS0.Px5.p2.1.m1.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS0.Px5.p2.1.m1.1c">1</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS0.Px5.p2.1.m1.1d">1</annotation></semantics></math> score per sequence which results in <math alttext="2" class="ltx_Math" display="inline" id="S2.SS2.SSS0.Px5.p2.2.m2.1"><semantics id="S2.SS2.SSS0.Px5.p2.2.m2.1a"><mn id="S2.SS2.SSS0.Px5.p2.2.m2.1.1" xref="S2.SS2.SSS0.Px5.p2.2.m2.1.1.cmml">2</mn><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS0.Px5.p2.2.m2.1b"><cn id="S2.SS2.SSS0.Px5.p2.2.m2.1.1.cmml" type="integer" xref="S2.SS2.SSS0.Px5.p2.2.m2.1.1">2</cn></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS0.Px5.p2.2.m2.1c">2</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS0.Px5.p2.2.m2.1d">2</annotation></semantics></math>MB per <math alttext="1" class="ltx_Math" display="inline" id="S2.SS2.SSS0.Px5.p2.3.m3.1"><semantics id="S2.SS2.SSS0.Px5.p2.3.m3.1a"><mn id="S2.SS2.SSS0.Px5.p2.3.m3.1.1" xref="S2.SS2.SSS0.Px5.p2.3.m3.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS0.Px5.p2.3.m3.1b"><cn id="S2.SS2.SSS0.Px5.p2.3.m3.1.1.cmml" type="integer" xref="S2.SS2.SSS0.Px5.p2.3.m3.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS0.Px5.p2.3.m3.1c">1</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS0.Px5.p2.3.m3.1d">1</annotation></semantics></math>M sequences if we represent the scores in 16-bit floats. A detailed analysis is provided in the Appendix&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#A1.SS4" title="A.4 Communication overhead ‣ Appendix A Language modeling experiments ‣ No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_tag">A.4</span></a>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Experiments</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S3.p1">
<p class="ltx_p" id="S3.p1.1">In this section, we experimentally analyze the performance of our proposed method.
First, in §&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#S3.SS2" title="3.2 Language Modeling Results ‣ 3 Experiments ‣ No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_tag">3.2</span></a> we benchmark our approach against a dense LLM trained using regular distributed training techniques.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S3.p2">
<p class="ltx_p" id="S3.p2.1">Second, in §&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#S3.SS3" title="3.3 Downstream evaluation ‣ 3 Experiments ‣ No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_tag">3.3</span></a>, we evaluate our method on downstream tasks, demonstrating that it achieves performance comparable to baseline models at the same level of perplexity, improving upon a dense model given the total training FLOPs spent.
Finally, in §&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#S3.SS4" title="3.4 Routing analysis ‣ 3 Experiments ‣ No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_tag">3.4</span></a>, we analyse the core component of our method, the routing. We show that the performance of the mixture does not depend significantly on the size of the router. Furthermore, we show that our approach outperforms less complex routing methods, such as the TF-IDF encoding with K-Means clustering proposed by &nbsp;<cite class="ltx_cite ltx_citemacro_cite">Gururangan et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#bib.bib19" title="">2023</a>)</cite>. Moreover, we demonstrate that the perplexity gains are not driven by a few dominant experts but result from each expert contributing positively to the overall performance.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Experimental Setup</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.1">We use the RedPajama-V2 dataset <cite class="ltx_cite ltx_citemacro_citep">(Computer, <a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#bib.bib9" title="">2023</a>)</cite>, which is a large-scale collection of text data designed for training language models. The dataset is built from the ground up based on publicly available web data, consisting of <math alttext="84" class="ltx_Math" display="inline" id="S3.SS1.p1.1.m1.1"><semantics id="S3.SS1.p1.1.m1.1a"><mn id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml">84</mn><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><cn id="S3.SS1.p1.1.m1.1.1.cmml" type="integer" xref="S3.SS1.p1.1.m1.1.1">84</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">84</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.1.m1.1d">84</annotation></semantics></math> crawls provided by <cite class="ltx_cite ltx_citemacro_cite">Common Crawl (<a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#bib.bib8" title="">2024</a>)</cite>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS1.p2">
<p class="ltx_p" id="S3.SS1.p2.5">Both the experts and routers utilize a Transformer architecture <cite class="ltx_cite ltx_citemacro_citep">(Vaswani, <a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#bib.bib52" title="">2017</a>)</cite> with rotary positional encoding <cite class="ltx_cite ltx_citemacro_citep">(Su et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#bib.bib48" title="">2024</a>)</cite>. All experiments use sequences of <math alttext="1,024" class="ltx_Math" display="inline" id="S3.SS1.p2.1.m1.2"><semantics id="S3.SS1.p2.1.m1.2a"><mrow id="S3.SS1.p2.1.m1.2.3.2" xref="S3.SS1.p2.1.m1.2.3.1.cmml"><mn id="S3.SS1.p2.1.m1.1.1" xref="S3.SS1.p2.1.m1.1.1.cmml">1</mn><mo id="S3.SS1.p2.1.m1.2.3.2.1" xref="S3.SS1.p2.1.m1.2.3.1.cmml">,</mo><mn id="S3.SS1.p2.1.m1.2.2" xref="S3.SS1.p2.1.m1.2.2.cmml">024</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.2b"><list id="S3.SS1.p2.1.m1.2.3.1.cmml" xref="S3.SS1.p2.1.m1.2.3.2"><cn id="S3.SS1.p2.1.m1.1.1.cmml" type="integer" xref="S3.SS1.p2.1.m1.1.1">1</cn><cn id="S3.SS1.p2.1.m1.2.2.cmml" type="integer" xref="S3.SS1.p2.1.m1.2.2">024</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.2c">1,024</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.1.m1.2d">1 , 024</annotation></semantics></math> tokens. We train the models using the AdamW optimizer <cite class="ltx_cite ltx_citemacro_citep">(Loshchilov &amp; Hutter, <a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#bib.bib36" title="">2017</a>)</cite> with <math alttext="\beta_{1}=0.9" class="ltx_Math" display="inline" id="S3.SS1.p2.2.m2.1"><semantics id="S3.SS1.p2.2.m2.1a"><mrow id="S3.SS1.p2.2.m2.1.1" xref="S3.SS1.p2.2.m2.1.1.cmml"><msub id="S3.SS1.p2.2.m2.1.1.2" xref="S3.SS1.p2.2.m2.1.1.2.cmml"><mi id="S3.SS1.p2.2.m2.1.1.2.2" xref="S3.SS1.p2.2.m2.1.1.2.2.cmml">β</mi><mn id="S3.SS1.p2.2.m2.1.1.2.3" xref="S3.SS1.p2.2.m2.1.1.2.3.cmml">1</mn></msub><mo id="S3.SS1.p2.2.m2.1.1.1" xref="S3.SS1.p2.2.m2.1.1.1.cmml">=</mo><mn id="S3.SS1.p2.2.m2.1.1.3" xref="S3.SS1.p2.2.m2.1.1.3.cmml">0.9</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.2.m2.1b"><apply id="S3.SS1.p2.2.m2.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1"><eq id="S3.SS1.p2.2.m2.1.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1.1"></eq><apply id="S3.SS1.p2.2.m2.1.1.2.cmml" xref="S3.SS1.p2.2.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p2.2.m2.1.1.2.1.cmml" xref="S3.SS1.p2.2.m2.1.1.2">subscript</csymbol><ci id="S3.SS1.p2.2.m2.1.1.2.2.cmml" xref="S3.SS1.p2.2.m2.1.1.2.2">𝛽</ci><cn id="S3.SS1.p2.2.m2.1.1.2.3.cmml" type="integer" xref="S3.SS1.p2.2.m2.1.1.2.3">1</cn></apply><cn id="S3.SS1.p2.2.m2.1.1.3.cmml" type="float" xref="S3.SS1.p2.2.m2.1.1.3">0.9</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.2.m2.1c">\beta_{1}=0.9</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.2.m2.1d">italic_β start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT = 0.9</annotation></semantics></math>, <math alttext="\beta_{2}=0.99" class="ltx_Math" display="inline" id="S3.SS1.p2.3.m3.1"><semantics id="S3.SS1.p2.3.m3.1a"><mrow id="S3.SS1.p2.3.m3.1.1" xref="S3.SS1.p2.3.m3.1.1.cmml"><msub id="S3.SS1.p2.3.m3.1.1.2" xref="S3.SS1.p2.3.m3.1.1.2.cmml"><mi id="S3.SS1.p2.3.m3.1.1.2.2" xref="S3.SS1.p2.3.m3.1.1.2.2.cmml">β</mi><mn id="S3.SS1.p2.3.m3.1.1.2.3" xref="S3.SS1.p2.3.m3.1.1.2.3.cmml">2</mn></msub><mo id="S3.SS1.p2.3.m3.1.1.1" xref="S3.SS1.p2.3.m3.1.1.1.cmml">=</mo><mn id="S3.SS1.p2.3.m3.1.1.3" xref="S3.SS1.p2.3.m3.1.1.3.cmml">0.99</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.3.m3.1b"><apply id="S3.SS1.p2.3.m3.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1"><eq id="S3.SS1.p2.3.m3.1.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1.1"></eq><apply id="S3.SS1.p2.3.m3.1.1.2.cmml" xref="S3.SS1.p2.3.m3.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p2.3.m3.1.1.2.1.cmml" xref="S3.SS1.p2.3.m3.1.1.2">subscript</csymbol><ci id="S3.SS1.p2.3.m3.1.1.2.2.cmml" xref="S3.SS1.p2.3.m3.1.1.2.2">𝛽</ci><cn id="S3.SS1.p2.3.m3.1.1.2.3.cmml" type="integer" xref="S3.SS1.p2.3.m3.1.1.2.3">2</cn></apply><cn id="S3.SS1.p2.3.m3.1.1.3.cmml" type="float" xref="S3.SS1.p2.3.m3.1.1.3">0.99</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.3.m3.1c">\beta_{2}=0.99</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.3.m3.1d">italic_β start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT = 0.99</annotation></semantics></math>, and a weight decay of <math alttext="0.1" class="ltx_Math" display="inline" id="S3.SS1.p2.4.m4.1"><semantics id="S3.SS1.p2.4.m4.1a"><mn id="S3.SS1.p2.4.m4.1.1" xref="S3.SS1.p2.4.m4.1.1.cmml">0.1</mn><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.4.m4.1b"><cn id="S3.SS1.p2.4.m4.1.1.cmml" type="float" xref="S3.SS1.p2.4.m4.1.1">0.1</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.4.m4.1c">0.1</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.4.m4.1d">0.1</annotation></semantics></math>. Gradient clipping is applied with a maximum norm of <math alttext="0.1" class="ltx_Math" display="inline" id="S3.SS1.p2.5.m5.1"><semantics id="S3.SS1.p2.5.m5.1a"><mn id="S3.SS1.p2.5.m5.1.1" xref="S3.SS1.p2.5.m5.1.1.cmml">0.1</mn><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.5.m5.1b"><cn id="S3.SS1.p2.5.m5.1.1.cmml" type="float" xref="S3.SS1.p2.5.m5.1.1">0.1</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.5.m5.1c">0.1</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.5.m5.1d">0.1</annotation></semantics></math>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS1.p3">
<p class="ltx_p" id="S3.SS1.p3.11">For the experts, we employ a learning rate schedule featuring a linear warm-up to <math alttext="5\times 10^{-4}" class="ltx_Math" display="inline" id="S3.SS1.p3.1.m1.1"><semantics id="S3.SS1.p3.1.m1.1a"><mrow id="S3.SS1.p3.1.m1.1.1" xref="S3.SS1.p3.1.m1.1.1.cmml"><mn id="S3.SS1.p3.1.m1.1.1.2" xref="S3.SS1.p3.1.m1.1.1.2.cmml">5</mn><mo id="S3.SS1.p3.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.SS1.p3.1.m1.1.1.1.cmml">×</mo><msup id="S3.SS1.p3.1.m1.1.1.3" xref="S3.SS1.p3.1.m1.1.1.3.cmml"><mn id="S3.SS1.p3.1.m1.1.1.3.2" xref="S3.SS1.p3.1.m1.1.1.3.2.cmml">10</mn><mrow id="S3.SS1.p3.1.m1.1.1.3.3" xref="S3.SS1.p3.1.m1.1.1.3.3.cmml"><mo id="S3.SS1.p3.1.m1.1.1.3.3a" xref="S3.SS1.p3.1.m1.1.1.3.3.cmml">−</mo><mn id="S3.SS1.p3.1.m1.1.1.3.3.2" xref="S3.SS1.p3.1.m1.1.1.3.3.2.cmml">4</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.1.m1.1b"><apply id="S3.SS1.p3.1.m1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1"><times id="S3.SS1.p3.1.m1.1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1.1"></times><cn id="S3.SS1.p3.1.m1.1.1.2.cmml" type="integer" xref="S3.SS1.p3.1.m1.1.1.2">5</cn><apply id="S3.SS1.p3.1.m1.1.1.3.cmml" xref="S3.SS1.p3.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p3.1.m1.1.1.3.1.cmml" xref="S3.SS1.p3.1.m1.1.1.3">superscript</csymbol><cn id="S3.SS1.p3.1.m1.1.1.3.2.cmml" type="integer" xref="S3.SS1.p3.1.m1.1.1.3.2">10</cn><apply id="S3.SS1.p3.1.m1.1.1.3.3.cmml" xref="S3.SS1.p3.1.m1.1.1.3.3"><minus id="S3.SS1.p3.1.m1.1.1.3.3.1.cmml" xref="S3.SS1.p3.1.m1.1.1.3.3"></minus><cn id="S3.SS1.p3.1.m1.1.1.3.3.2.cmml" type="integer" xref="S3.SS1.p3.1.m1.1.1.3.3.2">4</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.1.m1.1c">5\times 10^{-4}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.1.m1.1d">5 × 10 start_POSTSUPERSCRIPT - 4 end_POSTSUPERSCRIPT</annotation></semantics></math> over the first <math alttext="3,000" class="ltx_Math" display="inline" id="S3.SS1.p3.2.m2.2"><semantics id="S3.SS1.p3.2.m2.2a"><mrow id="S3.SS1.p3.2.m2.2.3.2" xref="S3.SS1.p3.2.m2.2.3.1.cmml"><mn id="S3.SS1.p3.2.m2.1.1" xref="S3.SS1.p3.2.m2.1.1.cmml">3</mn><mo id="S3.SS1.p3.2.m2.2.3.2.1" xref="S3.SS1.p3.2.m2.2.3.1.cmml">,</mo><mn id="S3.SS1.p3.2.m2.2.2" xref="S3.SS1.p3.2.m2.2.2.cmml">000</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.2.m2.2b"><list id="S3.SS1.p3.2.m2.2.3.1.cmml" xref="S3.SS1.p3.2.m2.2.3.2"><cn id="S3.SS1.p3.2.m2.1.1.cmml" type="integer" xref="S3.SS1.p3.2.m2.1.1">3</cn><cn id="S3.SS1.p3.2.m2.2.2.cmml" type="integer" xref="S3.SS1.p3.2.m2.2.2">000</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.2.m2.2c">3,000</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.2.m2.2d">3 , 000</annotation></semantics></math> steps, followed by a cosine decay for the remainder of the training period. We experiment with two model sizes: a <math alttext="335" class="ltx_Math" display="inline" id="S3.SS1.p3.3.m3.1"><semantics id="S3.SS1.p3.3.m3.1a"><mn id="S3.SS1.p3.3.m3.1.1" xref="S3.SS1.p3.3.m3.1.1.cmml">335</mn><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.3.m3.1b"><cn id="S3.SS1.p3.3.m3.1.1.cmml" type="integer" xref="S3.SS1.p3.3.m3.1.1">335</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.3.m3.1c">335</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.3.m3.1d">335</annotation></semantics></math>M-parameter model with <math alttext="4" class="ltx_Math" display="inline" id="S3.SS1.p3.4.m4.1"><semantics id="S3.SS1.p3.4.m4.1a"><mn id="S3.SS1.p3.4.m4.1.1" xref="S3.SS1.p3.4.m4.1.1.cmml">4</mn><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.4.m4.1b"><cn id="S3.SS1.p3.4.m4.1.1.cmml" type="integer" xref="S3.SS1.p3.4.m4.1.1">4</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.4.m4.1c">4</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.4.m4.1d">4</annotation></semantics></math>, <math alttext="8" class="ltx_Math" display="inline" id="S3.SS1.p3.5.m5.1"><semantics id="S3.SS1.p3.5.m5.1a"><mn id="S3.SS1.p3.5.m5.1.1" xref="S3.SS1.p3.5.m5.1.1.cmml">8</mn><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.5.m5.1b"><cn id="S3.SS1.p3.5.m5.1.1.cmml" type="integer" xref="S3.SS1.p3.5.m5.1.1">8</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.5.m5.1c">8</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.5.m5.1d">8</annotation></semantics></math>, <math alttext="16" class="ltx_Math" display="inline" id="S3.SS1.p3.6.m6.1"><semantics id="S3.SS1.p3.6.m6.1a"><mn id="S3.SS1.p3.6.m6.1.1" xref="S3.SS1.p3.6.m6.1.1.cmml">16</mn><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.6.m6.1b"><cn id="S3.SS1.p3.6.m6.1.1.cmml" type="integer" xref="S3.SS1.p3.6.m6.1.1">16</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.6.m6.1c">16</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.6.m6.1d">16</annotation></semantics></math>, and <math alttext="32" class="ltx_Math" display="inline" id="S3.SS1.p3.7.m7.1"><semantics id="S3.SS1.p3.7.m7.1a"><mn id="S3.SS1.p3.7.m7.1.1" xref="S3.SS1.p3.7.m7.1.1.cmml">32</mn><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.7.m7.1b"><cn id="S3.SS1.p3.7.m7.1.1.cmml" type="integer" xref="S3.SS1.p3.7.m7.1.1">32</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.7.m7.1c">32</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.7.m7.1d">32</annotation></semantics></math> experts and a <math alttext="1.3" class="ltx_Math" display="inline" id="S3.SS1.p3.8.m8.1"><semantics id="S3.SS1.p3.8.m8.1a"><mn id="S3.SS1.p3.8.m8.1.1" xref="S3.SS1.p3.8.m8.1.1.cmml">1.3</mn><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.8.m8.1b"><cn id="S3.SS1.p3.8.m8.1.1.cmml" type="float" xref="S3.SS1.p3.8.m8.1.1">1.3</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.8.m8.1c">1.3</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.8.m8.1d">1.3</annotation></semantics></math>B-parameter model with <math alttext="4" class="ltx_Math" display="inline" id="S3.SS1.p3.9.m9.1"><semantics id="S3.SS1.p3.9.m9.1a"><mn id="S3.SS1.p3.9.m9.1.1" xref="S3.SS1.p3.9.m9.1.1.cmml">4</mn><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.9.m9.1b"><cn id="S3.SS1.p3.9.m9.1.1.cmml" type="integer" xref="S3.SS1.p3.9.m9.1.1">4</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.9.m9.1c">4</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.9.m9.1d">4</annotation></semantics></math>, <math alttext="16" class="ltx_Math" display="inline" id="S3.SS1.p3.10.m10.1"><semantics id="S3.SS1.p3.10.m10.1a"><mn id="S3.SS1.p3.10.m10.1.1" xref="S3.SS1.p3.10.m10.1.1.cmml">16</mn><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.10.m10.1b"><cn id="S3.SS1.p3.10.m10.1.1.cmml" type="integer" xref="S3.SS1.p3.10.m10.1.1">16</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.10.m10.1c">16</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.10.m10.1d">16</annotation></semantics></math>, and <math alttext="32" class="ltx_Math" display="inline" id="S3.SS1.p3.11.m11.1"><semantics id="S3.SS1.p3.11.m11.1a"><mn id="S3.SS1.p3.11.m11.1.1" xref="S3.SS1.p3.11.m11.1.1.cmml">32</mn><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.11.m11.1b"><cn id="S3.SS1.p3.11.m11.1.1.cmml" type="integer" xref="S3.SS1.p3.11.m11.1.1">32</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.11.m11.1c">32</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.11.m11.1d">32</annotation></semantics></math> experts. Tables <a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#A1.T1" title="Table 1 ‣ A.1 Architecture and training details ‣ Appendix A Language modeling experiments ‣ No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_tag">1</span></a> and <a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#A1.T2" title="Table 2 ‣ A.1 Architecture and training details ‣ Appendix A Language modeling experiments ‣ No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_tag">2</span></a> describe the architectures and the training parameters in more detail.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS1.p4">
<p class="ltx_p" id="S3.SS1.p4.8">For the routers, we use models with <math alttext="4.4" class="ltx_Math" display="inline" id="S3.SS1.p4.1.m1.1"><semantics id="S3.SS1.p4.1.m1.1a"><mn id="S3.SS1.p4.1.m1.1.1" xref="S3.SS1.p4.1.m1.1.1.cmml">4.4</mn><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.1.m1.1b"><cn id="S3.SS1.p4.1.m1.1.1.cmml" type="float" xref="S3.SS1.p4.1.m1.1.1">4.4</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.1.m1.1c">4.4</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p4.1.m1.1d">4.4</annotation></semantics></math>M parameters. The routers are trained for <math alttext="128,000" class="ltx_Math" display="inline" id="S3.SS1.p4.2.m2.2"><semantics id="S3.SS1.p4.2.m2.2a"><mrow id="S3.SS1.p4.2.m2.2.3.2" xref="S3.SS1.p4.2.m2.2.3.1.cmml"><mn id="S3.SS1.p4.2.m2.1.1" xref="S3.SS1.p4.2.m2.1.1.cmml">128</mn><mo id="S3.SS1.p4.2.m2.2.3.2.1" xref="S3.SS1.p4.2.m2.2.3.1.cmml">,</mo><mn id="S3.SS1.p4.2.m2.2.2" xref="S3.SS1.p4.2.m2.2.2.cmml">000</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.2.m2.2b"><list id="S3.SS1.p4.2.m2.2.3.1.cmml" xref="S3.SS1.p4.2.m2.2.3.2"><cn id="S3.SS1.p4.2.m2.1.1.cmml" type="integer" xref="S3.SS1.p4.2.m2.1.1">128</cn><cn id="S3.SS1.p4.2.m2.2.2.cmml" type="integer" xref="S3.SS1.p4.2.m2.2.2">000</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.2.m2.2c">128,000</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p4.2.m2.2d">128 , 000</annotation></semantics></math> steps using a constant learning rate of <math alttext="1\times 10^{-4}" class="ltx_Math" display="inline" id="S3.SS1.p4.3.m3.1"><semantics id="S3.SS1.p4.3.m3.1a"><mrow id="S3.SS1.p4.3.m3.1.1" xref="S3.SS1.p4.3.m3.1.1.cmml"><mn id="S3.SS1.p4.3.m3.1.1.2" xref="S3.SS1.p4.3.m3.1.1.2.cmml">1</mn><mo id="S3.SS1.p4.3.m3.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.SS1.p4.3.m3.1.1.1.cmml">×</mo><msup id="S3.SS1.p4.3.m3.1.1.3" xref="S3.SS1.p4.3.m3.1.1.3.cmml"><mn id="S3.SS1.p4.3.m3.1.1.3.2" xref="S3.SS1.p4.3.m3.1.1.3.2.cmml">10</mn><mrow id="S3.SS1.p4.3.m3.1.1.3.3" xref="S3.SS1.p4.3.m3.1.1.3.3.cmml"><mo id="S3.SS1.p4.3.m3.1.1.3.3a" xref="S3.SS1.p4.3.m3.1.1.3.3.cmml">−</mo><mn id="S3.SS1.p4.3.m3.1.1.3.3.2" xref="S3.SS1.p4.3.m3.1.1.3.3.2.cmml">4</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.3.m3.1b"><apply id="S3.SS1.p4.3.m3.1.1.cmml" xref="S3.SS1.p4.3.m3.1.1"><times id="S3.SS1.p4.3.m3.1.1.1.cmml" xref="S3.SS1.p4.3.m3.1.1.1"></times><cn id="S3.SS1.p4.3.m3.1.1.2.cmml" type="integer" xref="S3.SS1.p4.3.m3.1.1.2">1</cn><apply id="S3.SS1.p4.3.m3.1.1.3.cmml" xref="S3.SS1.p4.3.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p4.3.m3.1.1.3.1.cmml" xref="S3.SS1.p4.3.m3.1.1.3">superscript</csymbol><cn id="S3.SS1.p4.3.m3.1.1.3.2.cmml" type="integer" xref="S3.SS1.p4.3.m3.1.1.3.2">10</cn><apply id="S3.SS1.p4.3.m3.1.1.3.3.cmml" xref="S3.SS1.p4.3.m3.1.1.3.3"><minus id="S3.SS1.p4.3.m3.1.1.3.3.1.cmml" xref="S3.SS1.p4.3.m3.1.1.3.3"></minus><cn id="S3.SS1.p4.3.m3.1.1.3.3.2.cmml" type="integer" xref="S3.SS1.p4.3.m3.1.1.3.3.2">4</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.3.m3.1c">1\times 10^{-4}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p4.3.m3.1d">1 × 10 start_POSTSUPERSCRIPT - 4 end_POSTSUPERSCRIPT</annotation></semantics></math>, following a linear warm-up over the first <math alttext="1,000" class="ltx_Math" display="inline" id="S3.SS1.p4.4.m4.2"><semantics id="S3.SS1.p4.4.m4.2a"><mrow id="S3.SS1.p4.4.m4.2.3.2" xref="S3.SS1.p4.4.m4.2.3.1.cmml"><mn id="S3.SS1.p4.4.m4.1.1" xref="S3.SS1.p4.4.m4.1.1.cmml">1</mn><mo id="S3.SS1.p4.4.m4.2.3.2.1" xref="S3.SS1.p4.4.m4.2.3.1.cmml">,</mo><mn id="S3.SS1.p4.4.m4.2.2" xref="S3.SS1.p4.4.m4.2.2.cmml">000</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.4.m4.2b"><list id="S3.SS1.p4.4.m4.2.3.1.cmml" xref="S3.SS1.p4.4.m4.2.3.2"><cn id="S3.SS1.p4.4.m4.1.1.cmml" type="integer" xref="S3.SS1.p4.4.m4.1.1">1</cn><cn id="S3.SS1.p4.4.m4.2.2.cmml" type="integer" xref="S3.SS1.p4.4.m4.2.2">000</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.4.m4.2c">1,000</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p4.4.m4.2d">1 , 000</annotation></semantics></math> steps. Routers are trained with a batch size of <math alttext="32" class="ltx_Math" display="inline" id="S3.SS1.p4.5.m5.1"><semantics id="S3.SS1.p4.5.m5.1a"><mn id="S3.SS1.p4.5.m5.1.1" xref="S3.SS1.p4.5.m5.1.1.cmml">32</mn><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.5.m5.1b"><cn id="S3.SS1.p4.5.m5.1.1.cmml" type="integer" xref="S3.SS1.p4.5.m5.1.1">32</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.5.m5.1c">32</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p4.5.m5.1d">32</annotation></semantics></math> and perform all-to-all communication of the loss on the dataset chunk approximately every <math alttext="45" class="ltx_Math" display="inline" id="S3.SS1.p4.6.m6.1"><semantics id="S3.SS1.p4.6.m6.1a"><mn id="S3.SS1.p4.6.m6.1.1" xref="S3.SS1.p4.6.m6.1.1.cmml">45</mn><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.6.m6.1b"><cn id="S3.SS1.p4.6.m6.1.1.cmml" type="integer" xref="S3.SS1.p4.6.m6.1.1">45</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.6.m6.1c">45</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p4.6.m6.1d">45</annotation></semantics></math> million training tokens (see App.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#A1.SS4" title="A.4 Communication overhead ‣ Appendix A Language modeling experiments ‣ No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_tag">A.4</span></a>). The length of the prefix used for routing is set to <math alttext="256" class="ltx_Math" display="inline" id="S3.SS1.p4.7.m7.1"><semantics id="S3.SS1.p4.7.m7.1a"><mn id="S3.SS1.p4.7.m7.1.1" xref="S3.SS1.p4.7.m7.1.1.cmml">256</mn><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.7.m7.1b"><cn id="S3.SS1.p4.7.m7.1.1.cmml" type="integer" xref="S3.SS1.p4.7.m7.1.1">256</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.7.m7.1c">256</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p4.7.m7.1d">256</annotation></semantics></math> tokens, which is <math alttext="25\%" class="ltx_Math" display="inline" id="S3.SS1.p4.8.m8.1"><semantics id="S3.SS1.p4.8.m8.1a"><mrow id="S3.SS1.p4.8.m8.1.1" xref="S3.SS1.p4.8.m8.1.1.cmml"><mn id="S3.SS1.p4.8.m8.1.1.2" xref="S3.SS1.p4.8.m8.1.1.2.cmml">25</mn><mo id="S3.SS1.p4.8.m8.1.1.1" xref="S3.SS1.p4.8.m8.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.8.m8.1b"><apply id="S3.SS1.p4.8.m8.1.1.cmml" xref="S3.SS1.p4.8.m8.1.1"><csymbol cd="latexml" id="S3.SS1.p4.8.m8.1.1.1.cmml" xref="S3.SS1.p4.8.m8.1.1.1">percent</csymbol><cn id="S3.SS1.p4.8.m8.1.1.2.cmml" type="integer" xref="S3.SS1.p4.8.m8.1.1.2">25</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.8.m8.1c">25\%</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p4.8.m8.1d">25 %</annotation></semantics></math> of the context length.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<section class="ltx_paragraph" id="S3.SS1.SSS0.Px1">
<h5 class="ltx_title ltx_title_paragraph">Comparison to the Dense Model</h5><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S3.SS1.SSS0.Px1.p1">
<p class="ltx_p" id="S3.SS1.SSS0.Px1.p1.1">To ensure a fair comparison to the dense baseline, we designed our experiments such that the computational cost during inference and the total computational cost during training are the same. We achieve this by comparing the performance of models where each expert has the same architecture and number of parameters as the dense model, resulting in the same inference cost. In addition, we train <span class="ltx_text ltx_font_smallcaps" id="S3.SS1.SSS0.Px1.p1.1.1">SmallTalk LM</span> for the same number of total tokens which means we spend the same number of total training FLOPs.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Language Modeling Results</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_figure" id="S3.F2">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S3.F2.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="614" id="S3.F2.sf1.g1" src="https://arxiv.org/html/2410.03529v1/x3.png" width="831">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(a) </span>FLOPs vs perplexity, <math alttext="335" class="ltx_Math" display="inline" id="S3.F2.sf1.2.m1.1"><semantics id="S3.F2.sf1.2.m1.1b"><mn id="S3.F2.sf1.2.m1.1.1" xref="S3.F2.sf1.2.m1.1.1.cmml">335</mn><annotation-xml encoding="MathML-Content" id="S3.F2.sf1.2.m1.1c"><cn id="S3.F2.sf1.2.m1.1.1.cmml" type="integer" xref="S3.F2.sf1.2.m1.1.1">335</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.sf1.2.m1.1d">335</annotation><annotation encoding="application/x-llamapun" id="S3.F2.sf1.2.m1.1e">335</annotation></semantics></math>M.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S3.F2.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="592" id="S3.F2.sf2.g1" src="https://arxiv.org/html/2410.03529v1/x4.png" width="830">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(b) </span>FLOPsvs perplexity, <math alttext="1.3" class="ltx_Math" display="inline" id="S3.F2.sf2.2.m1.1"><semantics id="S3.F2.sf2.2.m1.1b"><mn id="S3.F2.sf2.2.m1.1.1" xref="S3.F2.sf2.2.m1.1.1.cmml">1.3</mn><annotation-xml encoding="MathML-Content" id="S3.F2.sf2.2.m1.1c"><cn id="S3.F2.sf2.2.m1.1.1.cmml" type="float" xref="S3.F2.sf2.2.m1.1.1">1.3</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.sf2.2.m1.1d">1.3</annotation><annotation encoding="application/x-llamapun" id="S3.F2.sf2.2.m1.1e">1.3</annotation></semantics></math>B.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S3.F2.sf3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="599" id="S3.F2.sf3.g1" src="https://arxiv.org/html/2410.03529v1/x5.png" width="831">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(c) </span>Tokens vs perplexity, <math alttext="1.3" class="ltx_Math" display="inline" id="S3.F2.sf3.2.m1.1"><semantics id="S3.F2.sf3.2.m1.1b"><mn id="S3.F2.sf3.2.m1.1.1" xref="S3.F2.sf3.2.m1.1.1.cmml">1.3</mn><annotation-xml encoding="MathML-Content" id="S3.F2.sf3.2.m1.1c"><cn id="S3.F2.sf3.2.m1.1.1.cmml" type="float" xref="S3.F2.sf3.2.m1.1.1">1.3</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.sf3.2.m1.1d">1.3</annotation><annotation encoding="application/x-llamapun" id="S3.F2.sf3.2.m1.1e">1.3</annotation></semantics></math>B. </figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span><span class="ltx_text ltx_font_bold" id="S3.F2.42.1">Better perplexity for the same price.</span> Test perplexity comparison between our approach and the dense baseline, as a function of training cost measured in PFLOPs. In <span class="ltx_text ltx_font_bold" id="S3.F2.43.2">(a)</span>, we report results for models with <math alttext="335" class="ltx_Math" display="inline" id="S3.F2.19.m1.1"><semantics id="S3.F2.19.m1.1b"><mn id="S3.F2.19.m1.1.1" xref="S3.F2.19.m1.1.1.cmml">335</mn><annotation-xml encoding="MathML-Content" id="S3.F2.19.m1.1c"><cn id="S3.F2.19.m1.1.1.cmml" type="integer" xref="S3.F2.19.m1.1.1">335</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.19.m1.1d">335</annotation><annotation encoding="application/x-llamapun" id="S3.F2.19.m1.1e">335</annotation></semantics></math>M parameters using <math alttext="4" class="ltx_Math" display="inline" id="S3.F2.20.m2.1"><semantics id="S3.F2.20.m2.1b"><mn id="S3.F2.20.m2.1.1" xref="S3.F2.20.m2.1.1.cmml">4</mn><annotation-xml encoding="MathML-Content" id="S3.F2.20.m2.1c"><cn id="S3.F2.20.m2.1.1.cmml" type="integer" xref="S3.F2.20.m2.1.1">4</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.20.m2.1d">4</annotation><annotation encoding="application/x-llamapun" id="S3.F2.20.m2.1e">4</annotation></semantics></math>, <math alttext="8" class="ltx_Math" display="inline" id="S3.F2.21.m3.1"><semantics id="S3.F2.21.m3.1b"><mn id="S3.F2.21.m3.1.1" xref="S3.F2.21.m3.1.1.cmml">8</mn><annotation-xml encoding="MathML-Content" id="S3.F2.21.m3.1c"><cn id="S3.F2.21.m3.1.1.cmml" type="integer" xref="S3.F2.21.m3.1.1">8</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.21.m3.1d">8</annotation><annotation encoding="application/x-llamapun" id="S3.F2.21.m3.1e">8</annotation></semantics></math>, <math alttext="16" class="ltx_Math" display="inline" id="S3.F2.22.m4.1"><semantics id="S3.F2.22.m4.1b"><mn id="S3.F2.22.m4.1.1" xref="S3.F2.22.m4.1.1.cmml">16</mn><annotation-xml encoding="MathML-Content" id="S3.F2.22.m4.1c"><cn id="S3.F2.22.m4.1.1.cmml" type="integer" xref="S3.F2.22.m4.1.1">16</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.22.m4.1d">16</annotation><annotation encoding="application/x-llamapun" id="S3.F2.22.m4.1e">16</annotation></semantics></math>, and <math alttext="32" class="ltx_Math" display="inline" id="S3.F2.23.m5.1"><semantics id="S3.F2.23.m5.1b"><mn id="S3.F2.23.m5.1.1" xref="S3.F2.23.m5.1.1.cmml">32</mn><annotation-xml encoding="MathML-Content" id="S3.F2.23.m5.1c"><cn id="S3.F2.23.m5.1.1.cmml" type="integer" xref="S3.F2.23.m5.1.1">32</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.23.m5.1d">32</annotation><annotation encoding="application/x-llamapun" id="S3.F2.23.m5.1e">32</annotation></semantics></math> experts and in <span class="ltx_text ltx_font_bold" id="S3.F2.44.3">(b)</span> for models with <math alttext="1.3" class="ltx_Math" display="inline" id="S3.F2.24.m6.1"><semantics id="S3.F2.24.m6.1b"><mn id="S3.F2.24.m6.1.1" xref="S3.F2.24.m6.1.1.cmml">1.3</mn><annotation-xml encoding="MathML-Content" id="S3.F2.24.m6.1c"><cn id="S3.F2.24.m6.1.1.cmml" type="float" xref="S3.F2.24.m6.1.1">1.3</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.24.m6.1d">1.3</annotation><annotation encoding="application/x-llamapun" id="S3.F2.24.m6.1e">1.3</annotation></semantics></math>B parameters using <math alttext="4" class="ltx_Math" display="inline" id="S3.F2.25.m7.1"><semantics id="S3.F2.25.m7.1b"><mn id="S3.F2.25.m7.1.1" xref="S3.F2.25.m7.1.1.cmml">4</mn><annotation-xml encoding="MathML-Content" id="S3.F2.25.m7.1c"><cn id="S3.F2.25.m7.1.1.cmml" type="integer" xref="S3.F2.25.m7.1.1">4</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.25.m7.1d">4</annotation><annotation encoding="application/x-llamapun" id="S3.F2.25.m7.1e">4</annotation></semantics></math>, <math alttext="16" class="ltx_Math" display="inline" id="S3.F2.26.m8.1"><semantics id="S3.F2.26.m8.1b"><mn id="S3.F2.26.m8.1.1" xref="S3.F2.26.m8.1.1.cmml">16</mn><annotation-xml encoding="MathML-Content" id="S3.F2.26.m8.1c"><cn id="S3.F2.26.m8.1.1.cmml" type="integer" xref="S3.F2.26.m8.1.1">16</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.26.m8.1d">16</annotation><annotation encoding="application/x-llamapun" id="S3.F2.26.m8.1e">16</annotation></semantics></math>, and <math alttext="32" class="ltx_Math" display="inline" id="S3.F2.27.m9.1"><semantics id="S3.F2.27.m9.1b"><mn id="S3.F2.27.m9.1.1" xref="S3.F2.27.m9.1.1.cmml">32</mn><annotation-xml encoding="MathML-Content" id="S3.F2.27.m9.1c"><cn id="S3.F2.27.m9.1.1.cmml" type="integer" xref="S3.F2.27.m9.1.1">32</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.27.m9.1d">32</annotation><annotation encoding="application/x-llamapun" id="S3.F2.27.m9.1e">32</annotation></semantics></math> experts. In addition, <span class="ltx_text ltx_font_bold" id="S3.F2.45.4">(c)</span> shows the perplexity comparison between our approach and the dense baseline, plotted against the cumulative number of tokens processed throughout the training for the <math alttext="1.3" class="ltx_Math" display="inline" id="S3.F2.28.m10.1"><semantics id="S3.F2.28.m10.1b"><mn id="S3.F2.28.m10.1.1" xref="S3.F2.28.m10.1.1.cmml">1.3</mn><annotation-xml encoding="MathML-Content" id="S3.F2.28.m10.1c"><cn id="S3.F2.28.m10.1.1.cmml" type="float" xref="S3.F2.28.m10.1.1">1.3</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.28.m10.1d">1.3</annotation><annotation encoding="application/x-llamapun" id="S3.F2.28.m10.1e">1.3</annotation></semantics></math>B parameter models.
We observe that our method significantly outperforms the baseline across all experimental configurations. Notably, our <math alttext="335" class="ltx_Math" display="inline" id="S3.F2.29.m11.1"><semantics id="S3.F2.29.m11.1b"><mn id="S3.F2.29.m11.1.1" xref="S3.F2.29.m11.1.1.cmml">335</mn><annotation-xml encoding="MathML-Content" id="S3.F2.29.m11.1c"><cn id="S3.F2.29.m11.1.1.cmml" type="integer" xref="S3.F2.29.m11.1.1">335</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.29.m11.1d">335</annotation><annotation encoding="application/x-llamapun" id="S3.F2.29.m11.1e">335</annotation></semantics></math>M parameter model with <math alttext="32" class="ltx_Math" display="inline" id="S3.F2.30.m12.1"><semantics id="S3.F2.30.m12.1b"><mn id="S3.F2.30.m12.1.1" xref="S3.F2.30.m12.1.1.cmml">32</mn><annotation-xml encoding="MathML-Content" id="S3.F2.30.m12.1c"><cn id="S3.F2.30.m12.1.1.cmml" type="integer" xref="S3.F2.30.m12.1.1">32</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.30.m12.1d">32</annotation><annotation encoding="application/x-llamapun" id="S3.F2.30.m12.1e">32</annotation></semantics></math> experts achieves a perplexity of 9.07, outperforming the <math alttext="1.3" class="ltx_Math" display="inline" id="S3.F2.31.m13.1"><semantics id="S3.F2.31.m13.1b"><mn id="S3.F2.31.m13.1.1" xref="S3.F2.31.m13.1.1.cmml">1.3</mn><annotation-xml encoding="MathML-Content" id="S3.F2.31.m13.1c"><cn id="S3.F2.31.m13.1.1.cmml" type="float" xref="S3.F2.31.m13.1.1">1.3</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.31.m13.1d">1.3</annotation><annotation encoding="application/x-llamapun" id="S3.F2.31.m13.1e">1.3</annotation></semantics></math>B dense baseline’s perplexity of <math alttext="9.1" class="ltx_Math" display="inline" id="S3.F2.32.m14.1"><semantics id="S3.F2.32.m14.1b"><mn id="S3.F2.32.m14.1.1" xref="S3.F2.32.m14.1.1.cmml">9.1</mn><annotation-xml encoding="MathML-Content" id="S3.F2.32.m14.1c"><cn id="S3.F2.32.m14.1.1.cmml" type="float" xref="S3.F2.32.m14.1.1">9.1</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.32.m14.1d">9.1</annotation><annotation encoding="application/x-llamapun" id="S3.F2.32.m14.1e">9.1</annotation></semantics></math>. This improvement is achieved with a training budget of <math alttext="2.5\times 10^{21}" class="ltx_Math" display="inline" id="S3.F2.33.m15.1"><semantics id="S3.F2.33.m15.1b"><mrow id="S3.F2.33.m15.1.1" xref="S3.F2.33.m15.1.1.cmml"><mn id="S3.F2.33.m15.1.1.2" xref="S3.F2.33.m15.1.1.2.cmml">2.5</mn><mo id="S3.F2.33.m15.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.F2.33.m15.1.1.1.cmml">×</mo><msup id="S3.F2.33.m15.1.1.3" xref="S3.F2.33.m15.1.1.3.cmml"><mn id="S3.F2.33.m15.1.1.3.2" xref="S3.F2.33.m15.1.1.3.2.cmml">10</mn><mn id="S3.F2.33.m15.1.1.3.3" xref="S3.F2.33.m15.1.1.3.3.cmml">21</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.F2.33.m15.1c"><apply id="S3.F2.33.m15.1.1.cmml" xref="S3.F2.33.m15.1.1"><times id="S3.F2.33.m15.1.1.1.cmml" xref="S3.F2.33.m15.1.1.1"></times><cn id="S3.F2.33.m15.1.1.2.cmml" type="float" xref="S3.F2.33.m15.1.1.2">2.5</cn><apply id="S3.F2.33.m15.1.1.3.cmml" xref="S3.F2.33.m15.1.1.3"><csymbol cd="ambiguous" id="S3.F2.33.m15.1.1.3.1.cmml" xref="S3.F2.33.m15.1.1.3">superscript</csymbol><cn id="S3.F2.33.m15.1.1.3.2.cmml" type="integer" xref="S3.F2.33.m15.1.1.3.2">10</cn><cn id="S3.F2.33.m15.1.1.3.3.cmml" type="integer" xref="S3.F2.33.m15.1.1.3.3">21</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.33.m15.1d">2.5\times 10^{21}</annotation><annotation encoding="application/x-llamapun" id="S3.F2.33.m15.1e">2.5 × 10 start_POSTSUPERSCRIPT 21 end_POSTSUPERSCRIPT</annotation></semantics></math> FLOPs, which is comparable to the baseline’s <math alttext="2.2\times 10^{21}" class="ltx_Math" display="inline" id="S3.F2.34.m16.1"><semantics id="S3.F2.34.m16.1b"><mrow id="S3.F2.34.m16.1.1" xref="S3.F2.34.m16.1.1.cmml"><mn id="S3.F2.34.m16.1.1.2" xref="S3.F2.34.m16.1.1.2.cmml">2.2</mn><mo id="S3.F2.34.m16.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.F2.34.m16.1.1.1.cmml">×</mo><msup id="S3.F2.34.m16.1.1.3" xref="S3.F2.34.m16.1.1.3.cmml"><mn id="S3.F2.34.m16.1.1.3.2" xref="S3.F2.34.m16.1.1.3.2.cmml">10</mn><mn id="S3.F2.34.m16.1.1.3.3" xref="S3.F2.34.m16.1.1.3.3.cmml">21</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.F2.34.m16.1c"><apply id="S3.F2.34.m16.1.1.cmml" xref="S3.F2.34.m16.1.1"><times id="S3.F2.34.m16.1.1.1.cmml" xref="S3.F2.34.m16.1.1.1"></times><cn id="S3.F2.34.m16.1.1.2.cmml" type="float" xref="S3.F2.34.m16.1.1.2">2.2</cn><apply id="S3.F2.34.m16.1.1.3.cmml" xref="S3.F2.34.m16.1.1.3"><csymbol cd="ambiguous" id="S3.F2.34.m16.1.1.3.1.cmml" xref="S3.F2.34.m16.1.1.3">superscript</csymbol><cn id="S3.F2.34.m16.1.1.3.2.cmml" type="integer" xref="S3.F2.34.m16.1.1.3.2">10</cn><cn id="S3.F2.34.m16.1.1.3.3.cmml" type="integer" xref="S3.F2.34.m16.1.1.3.3">21</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.34.m16.1d">2.2\times 10^{21}</annotation><annotation encoding="application/x-llamapun" id="S3.F2.34.m16.1e">2.2 × 10 start_POSTSUPERSCRIPT 21 end_POSTSUPERSCRIPT</annotation></semantics></math> FLOPs, while requiring <span class="ltx_text ltx_font_bold" id="S3.F2.46.5">three times less</span> computational cost during inference (<math alttext="0.87\times 10^{12}" class="ltx_Math" display="inline" id="S3.F2.35.m17.1"><semantics id="S3.F2.35.m17.1b"><mrow id="S3.F2.35.m17.1.1" xref="S3.F2.35.m17.1.1.cmml"><mn id="S3.F2.35.m17.1.1.2" xref="S3.F2.35.m17.1.1.2.cmml">0.87</mn><mo id="S3.F2.35.m17.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.F2.35.m17.1.1.1.cmml">×</mo><msup id="S3.F2.35.m17.1.1.3" xref="S3.F2.35.m17.1.1.3.cmml"><mn id="S3.F2.35.m17.1.1.3.2" xref="S3.F2.35.m17.1.1.3.2.cmml">10</mn><mn id="S3.F2.35.m17.1.1.3.3" xref="S3.F2.35.m17.1.1.3.3.cmml">12</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.F2.35.m17.1c"><apply id="S3.F2.35.m17.1.1.cmml" xref="S3.F2.35.m17.1.1"><times id="S3.F2.35.m17.1.1.1.cmml" xref="S3.F2.35.m17.1.1.1"></times><cn id="S3.F2.35.m17.1.1.2.cmml" type="float" xref="S3.F2.35.m17.1.1.2">0.87</cn><apply id="S3.F2.35.m17.1.1.3.cmml" xref="S3.F2.35.m17.1.1.3"><csymbol cd="ambiguous" id="S3.F2.35.m17.1.1.3.1.cmml" xref="S3.F2.35.m17.1.1.3">superscript</csymbol><cn id="S3.F2.35.m17.1.1.3.2.cmml" type="integer" xref="S3.F2.35.m17.1.1.3.2">10</cn><cn id="S3.F2.35.m17.1.1.3.3.cmml" type="integer" xref="S3.F2.35.m17.1.1.3.3">12</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.35.m17.1d">0.87\times 10^{12}</annotation><annotation encoding="application/x-llamapun" id="S3.F2.35.m17.1e">0.87 × 10 start_POSTSUPERSCRIPT 12 end_POSTSUPERSCRIPT</annotation></semantics></math> FLOPs compared to <math alttext="2.81\times 10^{12}" class="ltx_Math" display="inline" id="S3.F2.36.m18.1"><semantics id="S3.F2.36.m18.1b"><mrow id="S3.F2.36.m18.1.1" xref="S3.F2.36.m18.1.1.cmml"><mn id="S3.F2.36.m18.1.1.2" xref="S3.F2.36.m18.1.1.2.cmml">2.81</mn><mo id="S3.F2.36.m18.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.F2.36.m18.1.1.1.cmml">×</mo><msup id="S3.F2.36.m18.1.1.3" xref="S3.F2.36.m18.1.1.3.cmml"><mn id="S3.F2.36.m18.1.1.3.2" xref="S3.F2.36.m18.1.1.3.2.cmml">10</mn><mn id="S3.F2.36.m18.1.1.3.3" xref="S3.F2.36.m18.1.1.3.3.cmml">12</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.F2.36.m18.1c"><apply id="S3.F2.36.m18.1.1.cmml" xref="S3.F2.36.m18.1.1"><times id="S3.F2.36.m18.1.1.1.cmml" xref="S3.F2.36.m18.1.1.1"></times><cn id="S3.F2.36.m18.1.1.2.cmml" type="float" xref="S3.F2.36.m18.1.1.2">2.81</cn><apply id="S3.F2.36.m18.1.1.3.cmml" xref="S3.F2.36.m18.1.1.3"><csymbol cd="ambiguous" id="S3.F2.36.m18.1.1.3.1.cmml" xref="S3.F2.36.m18.1.1.3">superscript</csymbol><cn id="S3.F2.36.m18.1.1.3.2.cmml" type="integer" xref="S3.F2.36.m18.1.1.3.2">10</cn><cn id="S3.F2.36.m18.1.1.3.3.cmml" type="integer" xref="S3.F2.36.m18.1.1.3.3">12</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.36.m18.1d">2.81\times 10^{12}</annotation><annotation encoding="application/x-llamapun" id="S3.F2.36.m18.1e">2.81 × 10 start_POSTSUPERSCRIPT 12 end_POSTSUPERSCRIPT</annotation></semantics></math> FLOPs). See
§&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#S3.SS2" title="3.2 Language Modeling Results ‣ 3 Experiments ‣ No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_tag">3.2</span></a> and App.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#A1" title="Appendix A Language modeling experiments ‣ No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_tag">A</span></a> for a detailed description of our experimental setup.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.1">Across all experimental configurations, our method <em class="ltx_emph ltx_font_italic" id="S3.SS2.p1.1.1">consistently outperforms the baseline</em> while utilizing the same volume of data, with only minor increases in computational costs. Specifically, for the 1.3B parameter model, our approach results in less than a 1% increase in training FLOPs and less than a 3% increase in inference FLOPs, while achieving performance gains of up to almost 18% in perplexity. Similarly, for the 335M parameter model, the cost increases are modest, with less than a 4% increase in training FLOPs and less than a 10% increase in inference FLOPs, alongside performance gains of up to nearly 14% in perplexity (see Appendix&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#A1.SS3" title="A.3 Computational Cost ‣ Appendix A Language modeling experiments ‣ No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_tag">A.3</span></a> for details on FLOPs calculation). Figures&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#S3.F2.sf1" title="In Figure 2 ‣ 3.2 Language Modeling Results ‣ 3 Experiments ‣ No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_tag">2(a)</span></a> and <a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#S3.F2.sf2" title="In Figure 2 ‣ 3.2 Language Modeling Results ‣ 3 Experiments ‣ No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_tag">2(b)</span></a> illustrate the perplexity on a held-out test set relative to the total training cost, measured in petaFLOPs, across different model sizes. Additionally, Figure&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#S3.F2.sf3" title="In Figure 2 ‣ 3.2 Language Modeling Results ‣ 3 Experiments ‣ No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_tag">2(c)</span></a> shows the test perplexity as a function of the number of training tokens for the 1.3B parameter model.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS2.p2">
<p class="ltx_p" id="S3.SS2.p2.2">Moreover, it is interesting to compare our model with the smaller 335M parameter experts to the 1.3B dense baseline. When using 32 experts and roughly the same training budget in FLOPs, <span class="ltx_text ltx_font_smallcaps" id="S3.SS2.p2.2.1">SmallTalk LM</span> achieves slightly better perplexity (<math alttext="9.07" class="ltx_Math" display="inline" id="S3.SS2.p2.1.m1.1"><semantics id="S3.SS2.p2.1.m1.1a"><mn id="S3.SS2.p2.1.m1.1.1" xref="S3.SS2.p2.1.m1.1.1.cmml">9.07</mn><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.1.m1.1b"><cn id="S3.SS2.p2.1.m1.1.1.cmml" type="float" xref="S3.SS2.p2.1.m1.1.1">9.07</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.1.m1.1c">9.07</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.1.m1.1d">9.07</annotation></semantics></math> vs <math alttext="9.11" class="ltx_Math" display="inline" id="S3.SS2.p2.2.m2.1"><semantics id="S3.SS2.p2.2.m2.1a"><mn id="S3.SS2.p2.2.m2.1.1" xref="S3.SS2.p2.2.m2.1.1.cmml">9.11</mn><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.2.m2.1b"><cn id="S3.SS2.p2.2.m2.1.1.cmml" type="float" xref="S3.SS2.p2.2.m2.1.1">9.11</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.2.m2.1c">9.11</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.2.m2.1d">9.11</annotation></semantics></math>) but requires <span class="ltx_text ltx_font_bold" id="S3.SS2.p2.2.2">three times less</span> compute during inference.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS2.p3">
<p class="ltx_p" id="S3.SS2.p3.1">Finally, we observed that for a constant model size, the improvement in perplexity increases with the number of experts. This suggests that our method more efficiently utilizes the training data to improve performance, likely due to the specialization of experts on different segments of the data distribution.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<section class="ltx_paragraph" id="S3.SS2.SSS0.Px1">
<h5 class="ltx_title ltx_title_paragraph">Communication Overhead</h5><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S3.SS2.SSS0.Px1.p1">
<p class="ltx_p" id="S3.SS2.SSS0.Px1.p1.2">Our approach performs minimal communication and does not require a fast interconnect. As detailed in §&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#S2" title="2 Method ‣ No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_tag">2</span></a>, we first train the routers which are then used to efficiently shard the dataset and each expert is trained completely independently. During their training, the routers communicate approximately <math alttext="100" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p1.1.m1.1"><semantics id="S3.SS2.SSS0.Px1.p1.1.m1.1a"><mn id="S3.SS2.SSS0.Px1.p1.1.m1.1.1" xref="S3.SS2.SSS0.Px1.p1.1.m1.1.1.cmml">100</mn><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p1.1.m1.1b"><cn id="S3.SS2.SSS0.Px1.p1.1.m1.1.1.cmml" type="integer" xref="S3.SS2.SSS0.Px1.p1.1.m1.1.1">100</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p1.1.m1.1c">100</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p1.1.m1.1d">100</annotation></semantics></math> times with each transmission involving less than <math alttext="6" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p1.2.m2.1"><semantics id="S3.SS2.SSS0.Px1.p1.2.m2.1a"><mn id="S3.SS2.SSS0.Px1.p1.2.m2.1.1" xref="S3.SS2.SSS0.Px1.p1.2.m2.1.1.cmml">6</mn><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p1.2.m2.1b"><cn id="S3.SS2.SSS0.Px1.p1.2.m2.1.1.cmml" type="integer" xref="S3.SS2.SSS0.Px1.p1.2.m2.1.1">6</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p1.2.m2.1c">6</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p1.2.m2.1d">6</annotation></semantics></math> megabytes per router resulting in truly minimal communication requirements. See <a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#A1.SS4" title="A.4 Communication overhead ‣ Appendix A Language modeling experiments ‣ No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_tag">A.4</span></a> for details about the calculation of these numbers.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
</section>
<section class="ltx_subsection" id="S3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Downstream evaluation</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S3.SS3.p1">
<p class="ltx_p" id="S3.SS3.p1.1">To demonstrate the applicability of our approach in real-world scenarios, we performed zero-shot evaluation on a set of natural language processing (NLP) tasks, including ARC Challenge and ARC Easy <cite class="ltx_cite ltx_citemacro_citep">(Clark et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#bib.bib6" title="">2018</a>)</cite>, HellaSwag <cite class="ltx_cite ltx_citemacro_citep">(Zellers et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#bib.bib56" title="">2019</a>)</cite>, SciQ <cite class="ltx_cite ltx_citemacro_citep">(Welbl et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#bib.bib54" title="">2017</a>)</cite>, and MMLU <cite class="ltx_cite ltx_citemacro_citep">(Hendrycks et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#bib.bib20" title="">2020</a>)</cite>. Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#S3.F3" title="Figure 3 ‣ 3.3 Downstream evaluation ‣ 3 Experiments ‣ No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_tag">3</span></a> shows both accuracy and perplexity for each task (see Appendix&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#A2" title="Appendix B Downstream evaluation ‣ No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_tag">B</span></a> for details regarding perplexity and accuracy computation).</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS3.p2">
<p class="ltx_p" id="S3.SS3.p2.6">Specifically, our largest configuration, a model with <math alttext="32" class="ltx_Math" display="inline" id="S3.SS3.p2.1.m1.1"><semantics id="S3.SS3.p2.1.m1.1a"><mn id="S3.SS3.p2.1.m1.1.1" xref="S3.SS3.p2.1.m1.1.1.cmml">32</mn><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.1.m1.1b"><cn id="S3.SS3.p2.1.m1.1.1.cmml" type="integer" xref="S3.SS3.p2.1.m1.1.1">32</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.1.m1.1c">32</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.1.m1.1d">32</annotation></semantics></math> <math alttext="1.3" class="ltx_Math" display="inline" id="S3.SS3.p2.2.m2.1"><semantics id="S3.SS3.p2.2.m2.1a"><mn id="S3.SS3.p2.2.m2.1.1" xref="S3.SS3.p2.2.m2.1.1.cmml">1.3</mn><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.2.m2.1b"><cn id="S3.SS3.p2.2.m2.1.1.cmml" type="float" xref="S3.SS3.p2.2.m2.1.1">1.3</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.2.m2.1c">1.3</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.2.m2.1d">1.3</annotation></semantics></math>B parameter experts, demonstrates better performance on four out of five tasks, achieving gains of <math alttext="3\%" class="ltx_Math" display="inline" id="S3.SS3.p2.3.m3.1"><semantics id="S3.SS3.p2.3.m3.1a"><mrow id="S3.SS3.p2.3.m3.1.1" xref="S3.SS3.p2.3.m3.1.1.cmml"><mn id="S3.SS3.p2.3.m3.1.1.2" xref="S3.SS3.p2.3.m3.1.1.2.cmml">3</mn><mo id="S3.SS3.p2.3.m3.1.1.1" xref="S3.SS3.p2.3.m3.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.3.m3.1b"><apply id="S3.SS3.p2.3.m3.1.1.cmml" xref="S3.SS3.p2.3.m3.1.1"><csymbol cd="latexml" id="S3.SS3.p2.3.m3.1.1.1.cmml" xref="S3.SS3.p2.3.m3.1.1.1">percent</csymbol><cn id="S3.SS3.p2.3.m3.1.1.2.cmml" type="integer" xref="S3.SS3.p2.3.m3.1.1.2">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.3.m3.1c">3\%</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.3.m3.1d">3 %</annotation></semantics></math>, <math alttext="2\%" class="ltx_Math" display="inline" id="S3.SS3.p2.4.m4.1"><semantics id="S3.SS3.p2.4.m4.1a"><mrow id="S3.SS3.p2.4.m4.1.1" xref="S3.SS3.p2.4.m4.1.1.cmml"><mn id="S3.SS3.p2.4.m4.1.1.2" xref="S3.SS3.p2.4.m4.1.1.2.cmml">2</mn><mo id="S3.SS3.p2.4.m4.1.1.1" xref="S3.SS3.p2.4.m4.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.4.m4.1b"><apply id="S3.SS3.p2.4.m4.1.1.cmml" xref="S3.SS3.p2.4.m4.1.1"><csymbol cd="latexml" id="S3.SS3.p2.4.m4.1.1.1.cmml" xref="S3.SS3.p2.4.m4.1.1.1">percent</csymbol><cn id="S3.SS3.p2.4.m4.1.1.2.cmml" type="integer" xref="S3.SS3.p2.4.m4.1.1.2">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.4.m4.1c">2\%</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.4.m4.1d">2 %</annotation></semantics></math>, <math alttext="3\%" class="ltx_Math" display="inline" id="S3.SS3.p2.5.m5.1"><semantics id="S3.SS3.p2.5.m5.1a"><mrow id="S3.SS3.p2.5.m5.1.1" xref="S3.SS3.p2.5.m5.1.1.cmml"><mn id="S3.SS3.p2.5.m5.1.1.2" xref="S3.SS3.p2.5.m5.1.1.2.cmml">3</mn><mo id="S3.SS3.p2.5.m5.1.1.1" xref="S3.SS3.p2.5.m5.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.5.m5.1b"><apply id="S3.SS3.p2.5.m5.1.1.cmml" xref="S3.SS3.p2.5.m5.1.1"><csymbol cd="latexml" id="S3.SS3.p2.5.m5.1.1.1.cmml" xref="S3.SS3.p2.5.m5.1.1.1">percent</csymbol><cn id="S3.SS3.p2.5.m5.1.1.2.cmml" type="integer" xref="S3.SS3.p2.5.m5.1.1.2">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.5.m5.1c">3\%</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.5.m5.1d">3 %</annotation></semantics></math>, and <math alttext="1\%" class="ltx_Math" display="inline" id="S3.SS3.p2.6.m6.1"><semantics id="S3.SS3.p2.6.m6.1a"><mrow id="S3.SS3.p2.6.m6.1.1" xref="S3.SS3.p2.6.m6.1.1.cmml"><mn id="S3.SS3.p2.6.m6.1.1.2" xref="S3.SS3.p2.6.m6.1.1.2.cmml">1</mn><mo id="S3.SS3.p2.6.m6.1.1.1" xref="S3.SS3.p2.6.m6.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.6.m6.1b"><apply id="S3.SS3.p2.6.m6.1.1.cmml" xref="S3.SS3.p2.6.m6.1.1"><csymbol cd="latexml" id="S3.SS3.p2.6.m6.1.1.1.cmml" xref="S3.SS3.p2.6.m6.1.1.1">percent</csymbol><cn id="S3.SS3.p2.6.m6.1.1.2.cmml" type="integer" xref="S3.SS3.p2.6.m6.1.1.2">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.6.m6.1c">1\%</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.6.m6.1d">1 %</annotation></semantics></math> on ARC Challenge (<a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#S3.F3.sf1" title="In Figure 3 ‣ 3.3 Downstream evaluation ‣ 3 Experiments ‣ No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_tag">3(a)</span></a>), ARC Easy (<a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#S3.F3.sf2" title="In Figure 3 ‣ 3.3 Downstream evaluation ‣ 3 Experiments ‣ No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_tag">3(b)</span></a>), HellaSwag (<a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#S3.F3.sf3" title="In Figure 3 ‣ 3.3 Downstream evaluation ‣ 3 Experiments ‣ No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_tag">3(c)</span></a>), and MMLU (<a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#S3.F3.sf4" title="In Figure 3 ‣ 3.3 Downstream evaluation ‣ 3 Experiments ‣ No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_tag">3(d)</span></a>), respectively, under the same inference cost.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS3.p3">
<p class="ltx_p" id="S3.SS3.p3.3">Moreover, on the MMLU benchmark, our approach either beats the baseline or achieves the same performance on <math alttext="75" class="ltx_Math" display="inline" id="S3.SS3.p3.1.m1.1"><semantics id="S3.SS3.p3.1.m1.1a"><mn id="S3.SS3.p3.1.m1.1.1" xref="S3.SS3.p3.1.m1.1.1.cmml">75</mn><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.1.m1.1b"><cn id="S3.SS3.p3.1.m1.1.1.cmml" type="integer" xref="S3.SS3.p3.1.m1.1.1">75</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.1.m1.1c">75</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.1.m1.1d">75</annotation></semantics></math>% of the tasks (<math alttext="42" class="ltx_Math" display="inline" id="S3.SS3.p3.2.m2.1"><semantics id="S3.SS3.p3.2.m2.1a"><mn id="S3.SS3.p3.2.m2.1.1" xref="S3.SS3.p3.2.m2.1.1.cmml">42</mn><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.2.m2.1b"><cn id="S3.SS3.p3.2.m2.1.1.cmml" type="integer" xref="S3.SS3.p3.2.m2.1.1">42</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.2.m2.1c">42</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.2.m2.1d">42</annotation></semantics></math> out of <math alttext="56" class="ltx_Math" display="inline" id="S3.SS3.p3.3.m3.1"><semantics id="S3.SS3.p3.3.m3.1a"><mn id="S3.SS3.p3.3.m3.1.1" xref="S3.SS3.p3.3.m3.1.1.cmml">56</mn><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.3.m3.1b"><cn id="S3.SS3.p3.3.m3.1.1.cmml" type="integer" xref="S3.SS3.p3.3.m3.1.1">56</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.3.m3.1c">56</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.3.m3.1d">56</annotation></semantics></math>), as shown in Table&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#A2.T4" title="Table 4 ‣ Appendix B Downstream evaluation ‣ No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_tag">4</span></a>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_figure" id="S3.F3">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_4">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S3.F3.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="582" id="S3.F3.sf1.g1" src="https://arxiv.org/html/2410.03529v1/x6.png" width="831">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(a) </span>ARC Challenge</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S3.F3.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="582" id="S3.F3.sf2.g1" src="https://arxiv.org/html/2410.03529v1/x7.png" width="831">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(b) </span>ARC Easy</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S3.F3.sf3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="582" id="S3.F3.sf3.g1" src="https://arxiv.org/html/2410.03529v1/x8.png" width="831">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(c) </span>HellaSwag</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S3.F3.sf4"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="582" id="S3.F3.sf4.g1" src="https://arxiv.org/html/2410.03529v1/x9.png" width="831">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(d) </span>MMLU</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span><span class="ltx_text ltx_font_bold" id="S3.F3.22.1">Downstream evaluation.</span> Accuracy with respect to perplexity on <span class="ltx_text ltx_font_bold" id="S3.F3.23.2">(a)</span>&nbsp;ARC Challenge, <span class="ltx_text ltx_font_bold" id="S3.F3.24.3">(b)</span>&nbsp;ARC Easy, <span class="ltx_text ltx_font_bold" id="S3.F3.25.4">(c)</span>&nbsp;HellaSwag and <span class="ltx_text ltx_font_bold" id="S3.F3.26.5">(d)</span>&nbsp;MMLU, for <math alttext="1.3" class="ltx_Math" display="inline" id="S3.F3.9.m1.1"><semantics id="S3.F3.9.m1.1b"><mn id="S3.F3.9.m1.1.1" xref="S3.F3.9.m1.1.1.cmml">1.3</mn><annotation-xml encoding="MathML-Content" id="S3.F3.9.m1.1c"><cn id="S3.F3.9.m1.1.1.cmml" type="float" xref="S3.F3.9.m1.1.1">1.3</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.F3.9.m1.1d">1.3</annotation><annotation encoding="application/x-llamapun" id="S3.F3.9.m1.1e">1.3</annotation></semantics></math>B parameter dense baselines trained on <math alttext="266" class="ltx_Math" display="inline" id="S3.F3.10.m2.1"><semantics id="S3.F3.10.m2.1b"><mn id="S3.F3.10.m2.1.1" xref="S3.F3.10.m2.1.1.cmml">266</mn><annotation-xml encoding="MathML-Content" id="S3.F3.10.m2.1c"><cn id="S3.F3.10.m2.1.1.cmml" type="integer" xref="S3.F3.10.m2.1.1">266</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.F3.10.m2.1d">266</annotation><annotation encoding="application/x-llamapun" id="S3.F3.10.m2.1e">266</annotation></semantics></math>B, <math alttext="1" class="ltx_Math" display="inline" id="S3.F3.11.m3.1"><semantics id="S3.F3.11.m3.1b"><mn id="S3.F3.11.m3.1.1" xref="S3.F3.11.m3.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="S3.F3.11.m3.1c"><cn id="S3.F3.11.m3.1.1.cmml" type="integer" xref="S3.F3.11.m3.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.F3.11.m3.1d">1</annotation><annotation encoding="application/x-llamapun" id="S3.F3.11.m3.1e">1</annotation></semantics></math>T and <math alttext="2" class="ltx_Math" display="inline" id="S3.F3.12.m4.1"><semantics id="S3.F3.12.m4.1b"><mn id="S3.F3.12.m4.1.1" xref="S3.F3.12.m4.1.1.cmml">2</mn><annotation-xml encoding="MathML-Content" id="S3.F3.12.m4.1c"><cn id="S3.F3.12.m4.1.1.cmml" type="integer" xref="S3.F3.12.m4.1.1">2</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.F3.12.m4.1d">2</annotation><annotation encoding="application/x-llamapun" id="S3.F3.12.m4.1e">2</annotation></semantics></math>T tokens (empty symbols) and mixture models with <math alttext="1.3" class="ltx_Math" display="inline" id="S3.F3.13.m5.1"><semantics id="S3.F3.13.m5.1b"><mn id="S3.F3.13.m5.1.1" xref="S3.F3.13.m5.1.1.cmml">1.3</mn><annotation-xml encoding="MathML-Content" id="S3.F3.13.m5.1c"><cn id="S3.F3.13.m5.1.1.cmml" type="float" xref="S3.F3.13.m5.1.1">1.3</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.F3.13.m5.1d">1.3</annotation><annotation encoding="application/x-llamapun" id="S3.F3.13.m5.1e">1.3</annotation></semantics></math>B parameter experts and <math alttext="4" class="ltx_Math" display="inline" id="S3.F3.14.m6.1"><semantics id="S3.F3.14.m6.1b"><mn id="S3.F3.14.m6.1.1" xref="S3.F3.14.m6.1.1.cmml">4</mn><annotation-xml encoding="MathML-Content" id="S3.F3.14.m6.1c"><cn id="S3.F3.14.m6.1.1.cmml" type="integer" xref="S3.F3.14.m6.1.1">4</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.F3.14.m6.1d">4</annotation><annotation encoding="application/x-llamapun" id="S3.F3.14.m6.1e">4</annotation></semantics></math>, <math alttext="16" class="ltx_Math" display="inline" id="S3.F3.15.m7.1"><semantics id="S3.F3.15.m7.1b"><mn id="S3.F3.15.m7.1.1" xref="S3.F3.15.m7.1.1.cmml">16</mn><annotation-xml encoding="MathML-Content" id="S3.F3.15.m7.1c"><cn id="S3.F3.15.m7.1.1.cmml" type="integer" xref="S3.F3.15.m7.1.1">16</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.F3.15.m7.1d">16</annotation><annotation encoding="application/x-llamapun" id="S3.F3.15.m7.1e">16</annotation></semantics></math> and <math alttext="32" class="ltx_Math" display="inline" id="S3.F3.16.m8.1"><semantics id="S3.F3.16.m8.1b"><mn id="S3.F3.16.m8.1.1" xref="S3.F3.16.m8.1.1.cmml">32</mn><annotation-xml encoding="MathML-Content" id="S3.F3.16.m8.1c"><cn id="S3.F3.16.m8.1.1.cmml" type="integer" xref="S3.F3.16.m8.1.1">32</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.F3.16.m8.1d">32</annotation><annotation encoding="application/x-llamapun" id="S3.F3.16.m8.1e">32</annotation></semantics></math> experts respectively (filled symbols). The models that have the same symbol shape have near identical training and inference FLOPs.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</section>
<section class="ltx_subsection" id="S3.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.4 </span>Routing analysis</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S3.SS4.p1">
<p class="ltx_p" id="S3.SS4.p1.1">In this section we analyse the most critical component of <span class="ltx_text ltx_font_smallcaps" id="S3.SS4.p1.1.1">SmallTalk LM</span>, the routing. In particular, we perform experiments to investigate the impact of the size of the router to the mixture model, the impact of the size of the prefix and finally whether the EM algorithm presented in §&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#S2" title="2 Method ‣ No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_tag">2</span></a> is critical or it could be replaced by simple content based clustering.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<section class="ltx_paragraph" id="S3.SS4.SSS0.Px1">
<h5 class="ltx_title ltx_title_paragraph">Impact of Router Size</h5><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S3.SS4.SSS0.Px1.p1">
<p class="ltx_p" id="S3.SS4.SSS0.Px1.p1.1">One of the most critical findings of our work is the fact that <em class="ltx_emph ltx_font_italic" id="S3.SS4.SSS0.Px1.p1.1.1">the size of the model</em> used for routing <em class="ltx_emph ltx_font_italic" id="S3.SS4.SSS0.Px1.p1.1.2">does not impact</em> the performance of the mixture (Figure&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#S3.F4.sf1" title="In Figure 4 ‣ Impact of Router Size ‣ 3.4 Routing analysis ‣ 3 Experiments ‣ No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_tag">4(a)</span></a>). This allows us to utilize small router models which reduce dramatically the computational cost of routing during training and inference without compromising the model’s performance.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="S3.SS4.SSS0.Px1.p2">
<p class="ltx_p" id="S3.SS4.SSS0.Px1.p2.9">In detail, we investigated the effect of router size on the performance of our method by experimenting with a <math alttext="335" class="ltx_Math" display="inline" id="S3.SS4.SSS0.Px1.p2.1.m1.1"><semantics id="S3.SS4.SSS0.Px1.p2.1.m1.1a"><mn id="S3.SS4.SSS0.Px1.p2.1.m1.1.1" xref="S3.SS4.SSS0.Px1.p2.1.m1.1.1.cmml">335</mn><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px1.p2.1.m1.1b"><cn id="S3.SS4.SSS0.Px1.p2.1.m1.1.1.cmml" type="integer" xref="S3.SS4.SSS0.Px1.p2.1.m1.1.1">335</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px1.p2.1.m1.1c">335</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS0.Px1.p2.1.m1.1d">335</annotation></semantics></math>M parameter model configured with <math alttext="4" class="ltx_Math" display="inline" id="S3.SS4.SSS0.Px1.p2.2.m2.1"><semantics id="S3.SS4.SSS0.Px1.p2.2.m2.1a"><mn id="S3.SS4.SSS0.Px1.p2.2.m2.1.1" xref="S3.SS4.SSS0.Px1.p2.2.m2.1.1.cmml">4</mn><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px1.p2.2.m2.1b"><cn id="S3.SS4.SSS0.Px1.p2.2.m2.1.1.cmml" type="integer" xref="S3.SS4.SSS0.Px1.p2.2.m2.1.1">4</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px1.p2.2.m2.1c">4</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS0.Px1.p2.2.m2.1d">4</annotation></semantics></math> experts, using four different router sizes for data partitioning: a <math alttext="335" class="ltx_Math" display="inline" id="S3.SS4.SSS0.Px1.p2.3.m3.1"><semantics id="S3.SS4.SSS0.Px1.p2.3.m3.1a"><mn id="S3.SS4.SSS0.Px1.p2.3.m3.1.1" xref="S3.SS4.SSS0.Px1.p2.3.m3.1.1.cmml">335</mn><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px1.p2.3.m3.1b"><cn id="S3.SS4.SSS0.Px1.p2.3.m3.1.1.cmml" type="integer" xref="S3.SS4.SSS0.Px1.p2.3.m3.1.1">335</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px1.p2.3.m3.1c">335</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS0.Px1.p2.3.m3.1d">335</annotation></semantics></math>M parameter router (where the model routes data for itself, optimizing for the data it handles best), and routers with <math alttext="110" class="ltx_Math" display="inline" id="S3.SS4.SSS0.Px1.p2.4.m4.1"><semantics id="S3.SS4.SSS0.Px1.p2.4.m4.1a"><mn id="S3.SS4.SSS0.Px1.p2.4.m4.1.1" xref="S3.SS4.SSS0.Px1.p2.4.m4.1.1.cmml">110</mn><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px1.p2.4.m4.1b"><cn id="S3.SS4.SSS0.Px1.p2.4.m4.1.1.cmml" type="integer" xref="S3.SS4.SSS0.Px1.p2.4.m4.1.1">110</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px1.p2.4.m4.1c">110</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS0.Px1.p2.4.m4.1d">110</annotation></semantics></math>M, <math alttext="64" class="ltx_Math" display="inline" id="S3.SS4.SSS0.Px1.p2.5.m5.1"><semantics id="S3.SS4.SSS0.Px1.p2.5.m5.1a"><mn id="S3.SS4.SSS0.Px1.p2.5.m5.1.1" xref="S3.SS4.SSS0.Px1.p2.5.m5.1.1.cmml">64</mn><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px1.p2.5.m5.1b"><cn id="S3.SS4.SSS0.Px1.p2.5.m5.1.1.cmml" type="integer" xref="S3.SS4.SSS0.Px1.p2.5.m5.1.1">64</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px1.p2.5.m5.1c">64</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS0.Px1.p2.5.m5.1d">64</annotation></semantics></math>M, and <math alttext="4.4" class="ltx_Math" display="inline" id="S3.SS4.SSS0.Px1.p2.6.m6.1"><semantics id="S3.SS4.SSS0.Px1.p2.6.m6.1a"><mn id="S3.SS4.SSS0.Px1.p2.6.m6.1.1" xref="S3.SS4.SSS0.Px1.p2.6.m6.1.1.cmml">4.4</mn><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px1.p2.6.m6.1b"><cn id="S3.SS4.SSS0.Px1.p2.6.m6.1.1.cmml" type="float" xref="S3.SS4.SSS0.Px1.p2.6.m6.1.1">4.4</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px1.p2.6.m6.1c">4.4</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS0.Px1.p2.6.m6.1d">4.4</annotation></semantics></math>M parameters.
All models were trained with a batch size of <math alttext="32" class="ltx_Math" display="inline" id="S3.SS4.SSS0.Px1.p2.7.m7.1"><semantics id="S3.SS4.SSS0.Px1.p2.7.m7.1a"><mn id="S3.SS4.SSS0.Px1.p2.7.m7.1.1" xref="S3.SS4.SSS0.Px1.p2.7.m7.1.1.cmml">32</mn><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px1.p2.7.m7.1b"><cn id="S3.SS4.SSS0.Px1.p2.7.m7.1.1.cmml" type="integer" xref="S3.SS4.SSS0.Px1.p2.7.m7.1.1">32</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px1.p2.7.m7.1c">32</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS0.Px1.p2.7.m7.1d">32</annotation></semantics></math> for <math alttext="256,000" class="ltx_Math" display="inline" id="S3.SS4.SSS0.Px1.p2.8.m8.2"><semantics id="S3.SS4.SSS0.Px1.p2.8.m8.2a"><mrow id="S3.SS4.SSS0.Px1.p2.8.m8.2.3.2" xref="S3.SS4.SSS0.Px1.p2.8.m8.2.3.1.cmml"><mn id="S3.SS4.SSS0.Px1.p2.8.m8.1.1" xref="S3.SS4.SSS0.Px1.p2.8.m8.1.1.cmml">256</mn><mo id="S3.SS4.SSS0.Px1.p2.8.m8.2.3.2.1" xref="S3.SS4.SSS0.Px1.p2.8.m8.2.3.1.cmml">,</mo><mn id="S3.SS4.SSS0.Px1.p2.8.m8.2.2" xref="S3.SS4.SSS0.Px1.p2.8.m8.2.2.cmml">000</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px1.p2.8.m8.2b"><list id="S3.SS4.SSS0.Px1.p2.8.m8.2.3.1.cmml" xref="S3.SS4.SSS0.Px1.p2.8.m8.2.3.2"><cn id="S3.SS4.SSS0.Px1.p2.8.m8.1.1.cmml" type="integer" xref="S3.SS4.SSS0.Px1.p2.8.m8.1.1">256</cn><cn id="S3.SS4.SSS0.Px1.p2.8.m8.2.2.cmml" type="integer" xref="S3.SS4.SSS0.Px1.p2.8.m8.2.2">000</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px1.p2.8.m8.2c">256,000</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS0.Px1.p2.8.m8.2d">256 , 000</annotation></semantics></math> steps, using a routing prefix length of <math alttext="256" class="ltx_Math" display="inline" id="S3.SS4.SSS0.Px1.p2.9.m9.1"><semantics id="S3.SS4.SSS0.Px1.p2.9.m9.1a"><mn id="S3.SS4.SSS0.Px1.p2.9.m9.1.1" xref="S3.SS4.SSS0.Px1.p2.9.m9.1.1.cmml">256</mn><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px1.p2.9.m9.1b"><cn id="S3.SS4.SSS0.Px1.p2.9.m9.1.1.cmml" type="integer" xref="S3.SS4.SSS0.Px1.p2.9.m9.1.1">256</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px1.p2.9.m9.1c">256</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS0.Px1.p2.9.m9.1d">256</annotation></semantics></math> tokens, following the same experimental setup as in §&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#S3.SS2" title="3.2 Language Modeling Results ‣ 3 Experiments ‣ No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_tag">3.2</span></a> (see Appendix&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#A1" title="Appendix A Language modeling experiments ‣ No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_tag">A</span></a>
for more details about model architectures and training parameters). Figure&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#S3.F4.sf1" title="In Figure 4 ‣ Impact of Router Size ‣ 3.4 Routing analysis ‣ 3 Experiments ‣ No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_tag">4(a)</span></a> illustrates the test perplexity wrt the number of training tokens for these configurations. We observe that all router sizes perform practically identically.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_figure" id="S3.F4">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S3.F4.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="582" id="S3.F4.sf1.g1" src="https://arxiv.org/html/2410.03529v1/x10.png" width="831">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(a) </span>Router size</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S3.F4.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="610" id="S3.F4.sf2.g1" src="https://arxiv.org/html/2410.03529v1/x11.png" width="831">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(b) </span>Prefix length</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S3.F4.sf3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="610" id="S3.F4.sf3.g1" src="https://arxiv.org/html/2410.03529v1/x12.png" width="831">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(c) </span>Ours vs TF-IDF</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span><span class="ltx_text ltx_font_bold" id="S3.F4.31.1">Routing analysis.</span> <span class="ltx_text ltx_font_bold" id="S3.F4.32.2">(a)</span> Test perplexity over training steps for different router sizes using a <math alttext="335" class="ltx_Math" display="inline" id="S3.F4.14.m1.1"><semantics id="S3.F4.14.m1.1b"><mn id="S3.F4.14.m1.1.1" xref="S3.F4.14.m1.1.1.cmml">335</mn><annotation-xml encoding="MathML-Content" id="S3.F4.14.m1.1c"><cn id="S3.F4.14.m1.1.1.cmml" type="integer" xref="S3.F4.14.m1.1.1">335</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.F4.14.m1.1d">335</annotation><annotation encoding="application/x-llamapun" id="S3.F4.14.m1.1e">335</annotation></semantics></math>M parameter model with 4 experts. We compare routers of sizes <math alttext="335" class="ltx_Math" display="inline" id="S3.F4.15.m2.1"><semantics id="S3.F4.15.m2.1b"><mn id="S3.F4.15.m2.1.1" xref="S3.F4.15.m2.1.1.cmml">335</mn><annotation-xml encoding="MathML-Content" id="S3.F4.15.m2.1c"><cn id="S3.F4.15.m2.1.1.cmml" type="integer" xref="S3.F4.15.m2.1.1">335</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.F4.15.m2.1d">335</annotation><annotation encoding="application/x-llamapun" id="S3.F4.15.m2.1e">335</annotation></semantics></math>M (where the model routes data for itself), <math alttext="110" class="ltx_Math" display="inline" id="S3.F4.16.m3.1"><semantics id="S3.F4.16.m3.1b"><mn id="S3.F4.16.m3.1.1" xref="S3.F4.16.m3.1.1.cmml">110</mn><annotation-xml encoding="MathML-Content" id="S3.F4.16.m3.1c"><cn id="S3.F4.16.m3.1.1.cmml" type="integer" xref="S3.F4.16.m3.1.1">110</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.F4.16.m3.1d">110</annotation><annotation encoding="application/x-llamapun" id="S3.F4.16.m3.1e">110</annotation></semantics></math>M, <math alttext="65" class="ltx_Math" display="inline" id="S3.F4.17.m4.1"><semantics id="S3.F4.17.m4.1b"><mn id="S3.F4.17.m4.1.1" xref="S3.F4.17.m4.1.1.cmml">65</mn><annotation-xml encoding="MathML-Content" id="S3.F4.17.m4.1c"><cn id="S3.F4.17.m4.1.1.cmml" type="integer" xref="S3.F4.17.m4.1.1">65</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.F4.17.m4.1d">65</annotation><annotation encoding="application/x-llamapun" id="S3.F4.17.m4.1e">65</annotation></semantics></math>M, and <math alttext="4.4" class="ltx_Math" display="inline" id="S3.F4.18.m5.1"><semantics id="S3.F4.18.m5.1b"><mn id="S3.F4.18.m5.1.1" xref="S3.F4.18.m5.1.1.cmml">4.4</mn><annotation-xml encoding="MathML-Content" id="S3.F4.18.m5.1c"><cn id="S3.F4.18.m5.1.1.cmml" type="float" xref="S3.F4.18.m5.1.1">4.4</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.F4.18.m5.1d">4.4</annotation><annotation encoding="application/x-llamapun" id="S3.F4.18.m5.1e">4.4</annotation></semantics></math>M parameters.
<span class="ltx_text ltx_font_bold" id="S3.F4.33.3">(b)</span> Test perplexity as a function of routing prefix length during inference for <math alttext="1.3" class="ltx_Math" display="inline" id="S3.F4.19.m6.1"><semantics id="S3.F4.19.m6.1b"><mn id="S3.F4.19.m6.1.1" xref="S3.F4.19.m6.1.1.cmml">1.3</mn><annotation-xml encoding="MathML-Content" id="S3.F4.19.m6.1c"><cn id="S3.F4.19.m6.1.1.cmml" type="float" xref="S3.F4.19.m6.1.1">1.3</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.F4.19.m6.1d">1.3</annotation><annotation encoding="application/x-llamapun" id="S3.F4.19.m6.1e">1.3</annotation></semantics></math>B parameter model with <math alttext="4" class="ltx_Math" display="inline" id="S3.F4.20.m7.1"><semantics id="S3.F4.20.m7.1b"><mn id="S3.F4.20.m7.1.1" xref="S3.F4.20.m7.1.1.cmml">4</mn><annotation-xml encoding="MathML-Content" id="S3.F4.20.m7.1c"><cn id="S3.F4.20.m7.1.1.cmml" type="integer" xref="S3.F4.20.m7.1.1">4</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.F4.20.m7.1d">4</annotation><annotation encoding="application/x-llamapun" id="S3.F4.20.m7.1e">4</annotation></semantics></math>, <math alttext="16" class="ltx_Math" display="inline" id="S3.F4.21.m8.1"><semantics id="S3.F4.21.m8.1b"><mn id="S3.F4.21.m8.1.1" xref="S3.F4.21.m8.1.1.cmml">16</mn><annotation-xml encoding="MathML-Content" id="S3.F4.21.m8.1c"><cn id="S3.F4.21.m8.1.1.cmml" type="integer" xref="S3.F4.21.m8.1.1">16</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.F4.21.m8.1d">16</annotation><annotation encoding="application/x-llamapun" id="S3.F4.21.m8.1e">16</annotation></semantics></math> and <math alttext="32" class="ltx_Math" display="inline" id="S3.F4.22.m9.1"><semantics id="S3.F4.22.m9.1b"><mn id="S3.F4.22.m9.1.1" xref="S3.F4.22.m9.1.1.cmml">32</mn><annotation-xml encoding="MathML-Content" id="S3.F4.22.m9.1c"><cn id="S3.F4.22.m9.1.1.cmml" type="integer" xref="S3.F4.22.m9.1.1">32</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.F4.22.m9.1d">32</annotation><annotation encoding="application/x-llamapun" id="S3.F4.22.m9.1e">32</annotation></semantics></math> experts. We examine how reducing the prefix length <math alttext="\hat{M}" class="ltx_Math" display="inline" id="S3.F4.23.m10.1"><semantics id="S3.F4.23.m10.1b"><mover accent="true" id="S3.F4.23.m10.1.1" xref="S3.F4.23.m10.1.1.cmml"><mi id="S3.F4.23.m10.1.1.2" xref="S3.F4.23.m10.1.1.2.cmml">M</mi><mo id="S3.F4.23.m10.1.1.1" xref="S3.F4.23.m10.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.F4.23.m10.1c"><apply id="S3.F4.23.m10.1.1.cmml" xref="S3.F4.23.m10.1.1"><ci id="S3.F4.23.m10.1.1.1.cmml" xref="S3.F4.23.m10.1.1.1">^</ci><ci id="S3.F4.23.m10.1.1.2.cmml" xref="S3.F4.23.m10.1.1.2">𝑀</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F4.23.m10.1d">\hat{M}</annotation><annotation encoding="application/x-llamapun" id="S3.F4.23.m10.1e">over^ start_ARG italic_M end_ARG</annotation></semantics></math> used during inference affects performance when the data is partitioned during training using a prefix size <math alttext="M\geq\hat{M}" class="ltx_Math" display="inline" id="S3.F4.24.m11.1"><semantics id="S3.F4.24.m11.1b"><mrow id="S3.F4.24.m11.1.1" xref="S3.F4.24.m11.1.1.cmml"><mi id="S3.F4.24.m11.1.1.2" xref="S3.F4.24.m11.1.1.2.cmml">M</mi><mo id="S3.F4.24.m11.1.1.1" xref="S3.F4.24.m11.1.1.1.cmml">≥</mo><mover accent="true" id="S3.F4.24.m11.1.1.3" xref="S3.F4.24.m11.1.1.3.cmml"><mi id="S3.F4.24.m11.1.1.3.2" xref="S3.F4.24.m11.1.1.3.2.cmml">M</mi><mo id="S3.F4.24.m11.1.1.3.1" xref="S3.F4.24.m11.1.1.3.1.cmml">^</mo></mover></mrow><annotation-xml encoding="MathML-Content" id="S3.F4.24.m11.1c"><apply id="S3.F4.24.m11.1.1.cmml" xref="S3.F4.24.m11.1.1"><geq id="S3.F4.24.m11.1.1.1.cmml" xref="S3.F4.24.m11.1.1.1"></geq><ci id="S3.F4.24.m11.1.1.2.cmml" xref="S3.F4.24.m11.1.1.2">𝑀</ci><apply id="S3.F4.24.m11.1.1.3.cmml" xref="S3.F4.24.m11.1.1.3"><ci id="S3.F4.24.m11.1.1.3.1.cmml" xref="S3.F4.24.m11.1.1.3.1">^</ci><ci id="S3.F4.24.m11.1.1.3.2.cmml" xref="S3.F4.24.m11.1.1.3.2">𝑀</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F4.24.m11.1d">M\geq\hat{M}</annotation><annotation encoding="application/x-llamapun" id="S3.F4.24.m11.1e">italic_M ≥ over^ start_ARG italic_M end_ARG</annotation></semantics></math>. <span class="ltx_text ltx_font_bold" id="S3.F4.34.4">(c)</span> Test perplexity over training steps for a <math alttext="335" class="ltx_Math" display="inline" id="S3.F4.25.m12.1"><semantics id="S3.F4.25.m12.1b"><mn id="S3.F4.25.m12.1.1" xref="S3.F4.25.m12.1.1.cmml">335</mn><annotation-xml encoding="MathML-Content" id="S3.F4.25.m12.1c"><cn id="S3.F4.25.m12.1.1.cmml" type="integer" xref="S3.F4.25.m12.1.1">335</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.F4.25.m12.1d">335</annotation><annotation encoding="application/x-llamapun" id="S3.F4.25.m12.1e">335</annotation></semantics></math>M parameter model with <math alttext="16" class="ltx_Math" display="inline" id="S3.F4.26.m13.1"><semantics id="S3.F4.26.m13.1b"><mn id="S3.F4.26.m13.1.1" xref="S3.F4.26.m13.1.1.cmml">16</mn><annotation-xml encoding="MathML-Content" id="S3.F4.26.m13.1c"><cn id="S3.F4.26.m13.1.1.cmml" type="integer" xref="S3.F4.26.m13.1.1">16</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.F4.26.m13.1d">16</annotation><annotation encoding="application/x-llamapun" id="S3.F4.26.m13.1e">16</annotation></semantics></math> experts, comparing our proposed routing using TF-IDF document encoding followed by SVD projection and balanced K-Means clustering.
</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</section>
<section class="ltx_paragraph" id="S3.SS4.SSS0.Px2">
<h5 class="ltx_title ltx_title_paragraph">Impact of Prefix Length</h5><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S3.SS4.SSS0.Px2.p1">
<p class="ltx_p" id="S3.SS4.SSS0.Px2.p1.3">An important hyperparameter for our mixture model is the length of the context used for routing to the expert model. In our experiments, we use a prefix length of <math alttext="256" class="ltx_Math" display="inline" id="S3.SS4.SSS0.Px2.p1.1.m1.1"><semantics id="S3.SS4.SSS0.Px2.p1.1.m1.1a"><mn id="S3.SS4.SSS0.Px2.p1.1.m1.1.1" xref="S3.SS4.SSS0.Px2.p1.1.m1.1.1.cmml">256</mn><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px2.p1.1.m1.1b"><cn id="S3.SS4.SSS0.Px2.p1.1.m1.1.1.cmml" type="integer" xref="S3.SS4.SSS0.Px2.p1.1.m1.1.1">256</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px2.p1.1.m1.1c">256</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS0.Px2.p1.1.m1.1d">256</annotation></semantics></math> which may be too large for some real-world applications like conversational AI. However, we show in Figure&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#S3.F4.sf2" title="In Figure 4 ‣ Impact of Router Size ‣ 3.4 Routing analysis ‣ 3 Experiments ‣ No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_tag">4(b)</span></a> that <span class="ltx_text ltx_font_smallcaps" id="S3.SS4.SSS0.Px2.p1.3.1">SmallTalk LM</span> outperforms the dense baseline even when routing with shorter prefixes. In particular, we show that even with prefixes of just <math alttext="32" class="ltx_Math" display="inline" id="S3.SS4.SSS0.Px2.p1.2.m2.1"><semantics id="S3.SS4.SSS0.Px2.p1.2.m2.1a"><mn id="S3.SS4.SSS0.Px2.p1.2.m2.1.1" xref="S3.SS4.SSS0.Px2.p1.2.m2.1.1.cmml">32</mn><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px2.p1.2.m2.1b"><cn id="S3.SS4.SSS0.Px2.p1.2.m2.1.1.cmml" type="integer" xref="S3.SS4.SSS0.Px2.p1.2.m2.1.1">32</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px2.p1.2.m2.1c">32</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS0.Px2.p1.2.m2.1d">32</annotation></semantics></math> tokens (<math alttext="\frac{1}{8}" class="ltx_Math" display="inline" id="S3.SS4.SSS0.Px2.p1.3.m3.1"><semantics id="S3.SS4.SSS0.Px2.p1.3.m3.1a"><mfrac id="S3.SS4.SSS0.Px2.p1.3.m3.1.1" xref="S3.SS4.SSS0.Px2.p1.3.m3.1.1.cmml"><mn id="S3.SS4.SSS0.Px2.p1.3.m3.1.1.2" xref="S3.SS4.SSS0.Px2.p1.3.m3.1.1.2.cmml">1</mn><mn id="S3.SS4.SSS0.Px2.p1.3.m3.1.1.3" xref="S3.SS4.SSS0.Px2.p1.3.m3.1.1.3.cmml">8</mn></mfrac><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px2.p1.3.m3.1b"><apply id="S3.SS4.SSS0.Px2.p1.3.m3.1.1.cmml" xref="S3.SS4.SSS0.Px2.p1.3.m3.1.1"><divide id="S3.SS4.SSS0.Px2.p1.3.m3.1.1.1.cmml" xref="S3.SS4.SSS0.Px2.p1.3.m3.1.1"></divide><cn id="S3.SS4.SSS0.Px2.p1.3.m3.1.1.2.cmml" type="integer" xref="S3.SS4.SSS0.Px2.p1.3.m3.1.1.2">1</cn><cn id="S3.SS4.SSS0.Px2.p1.3.m3.1.1.3.cmml" type="integer" xref="S3.SS4.SSS0.Px2.p1.3.m3.1.1.3">8</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px2.p1.3.m3.1c">\frac{1}{8}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS0.Px2.p1.3.m3.1d">divide start_ARG 1 end_ARG start_ARG 8 end_ARG</annotation></semantics></math>th of the length during training) the model still outperforms the dense baseline.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_paragraph" id="S3.SS4.SSS0.Px3">
<h5 class="ltx_title ltx_title_paragraph">Comparison With Routing Using TF-IDF</h5><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S3.SS4.SSS0.Px3.p1">
<p class="ltx_p" id="S3.SS4.SSS0.Px3.p1.1">An alternative approach might suggest that if a tiny LLM suffices for routing, simpler methods such as TF-IDF encoding combined with balanced K-Means clustering, as proposed by <cite class="ltx_cite ltx_citemacro_cite">Gururangan et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#bib.bib19" title="">2023</a>)</cite>, could be adequate. To test this hypothesis, we trained a 335M parameter model using the routing strategy outlined in <cite class="ltx_cite ltx_citemacro_citep">(Gururangan et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#bib.bib19" title="">2023</a>)</cite>: applying TF-IDF transformation to the text, followed by Singular Value Decomposition (SVD) projection into a low-dimensional space, and then clustering using balanced K-Means.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS4.SSS0.Px3.p2">
<p class="ltx_p" id="S3.SS4.SSS0.Px3.p2.1">We then trained <math alttext="16" class="ltx_Math" display="inline" id="S3.SS4.SSS0.Px3.p2.1.m1.1"><semantics id="S3.SS4.SSS0.Px3.p2.1.m1.1a"><mn id="S3.SS4.SSS0.Px3.p2.1.m1.1.1" xref="S3.SS4.SSS0.Px3.p2.1.m1.1.1.cmml">16</mn><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px3.p2.1.m1.1b"><cn id="S3.SS4.SSS0.Px3.p2.1.m1.1.1.cmml" type="integer" xref="S3.SS4.SSS0.Px3.p2.1.m1.1.1">16</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px3.p2.1.m1.1c">16</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS0.Px3.p2.1.m1.1d">16</annotation></semantics></math> experts on these clustered results. Our findings reveal that routing with TF-IDF encoding under performs when the prefix is short, indicating limitations of this simple routing approach. As shown in Figure&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#S3.F4.sf3" title="In Figure 4 ‣ Impact of Router Size ‣ 3.4 Routing analysis ‣ 3 Experiments ‣ No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_tag">4(c)</span></a>, our proposed routing method significantly outperforms the TF-IDF-based routing. This demonstrates that our approach is more effective in capturing the nuances of the data distribution, even when using limited context for routing decisions.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_paragraph" id="S3.SS4.SSS0.Px4">
<h5 class="ltx_title ltx_title_paragraph">Experts Do Specialize</h5><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S3.SS4.SSS0.Px4.p1">
<p class="ltx_p" id="S3.SS4.SSS0.Px4.p1.5">A potential concern is that the observed performance gains might be driven primarily by a few experts among the <math alttext="E" class="ltx_Math" display="inline" id="S3.SS4.SSS0.Px4.p1.1.m1.1"><semantics id="S3.SS4.SSS0.Px4.p1.1.m1.1a"><mi id="S3.SS4.SSS0.Px4.p1.1.m1.1.1" xref="S3.SS4.SSS0.Px4.p1.1.m1.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px4.p1.1.m1.1b"><ci id="S3.SS4.SSS0.Px4.p1.1.m1.1.1.cmml" xref="S3.SS4.SSS0.Px4.p1.1.m1.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px4.p1.1.m1.1c">E</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS0.Px4.p1.1.m1.1d">italic_E</annotation></semantics></math>, while the remaining contribute minimally or may even under perform on their assigned data. To address this concern, we conducted an analysis of each expert’s performance individually. Figures <a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#S3.F5.sf1" title="In Figure 5 ‣ Experts Do Specialize ‣ 3.4 Routing analysis ‣ 3 Experiments ‣ No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_tag">5(a)</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#S3.F5.sf2" title="In Figure 5 ‣ Experts Do Specialize ‣ 3.4 Routing analysis ‣ 3 Experiments ‣ No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_tag">5(b)</span></a>, and <a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#S3.F5.sf3" title="In Figure 5 ‣ Experts Do Specialize ‣ 3.4 Routing analysis ‣ 3 Experiments ‣ No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_tag">5(c)</span></a> compare the perplexity achieved by our method and the dense baseline on the routed dataset segments for the <math alttext="1.3" class="ltx_Math" display="inline" id="S3.SS4.SSS0.Px4.p1.2.m2.1"><semantics id="S3.SS4.SSS0.Px4.p1.2.m2.1a"><mn id="S3.SS4.SSS0.Px4.p1.2.m2.1.1" xref="S3.SS4.SSS0.Px4.p1.2.m2.1.1.cmml">1.3</mn><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px4.p1.2.m2.1b"><cn id="S3.SS4.SSS0.Px4.p1.2.m2.1.1.cmml" type="float" xref="S3.SS4.SSS0.Px4.p1.2.m2.1.1">1.3</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px4.p1.2.m2.1c">1.3</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS0.Px4.p1.2.m2.1d">1.3</annotation></semantics></math>B parameter model, utilizing mixtures of <math alttext="4" class="ltx_Math" display="inline" id="S3.SS4.SSS0.Px4.p1.3.m3.1"><semantics id="S3.SS4.SSS0.Px4.p1.3.m3.1a"><mn id="S3.SS4.SSS0.Px4.p1.3.m3.1.1" xref="S3.SS4.SSS0.Px4.p1.3.m3.1.1.cmml">4</mn><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px4.p1.3.m3.1b"><cn id="S3.SS4.SSS0.Px4.p1.3.m3.1.1.cmml" type="integer" xref="S3.SS4.SSS0.Px4.p1.3.m3.1.1">4</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px4.p1.3.m3.1c">4</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS0.Px4.p1.3.m3.1d">4</annotation></semantics></math>, <math alttext="16" class="ltx_Math" display="inline" id="S3.SS4.SSS0.Px4.p1.4.m4.1"><semantics id="S3.SS4.SSS0.Px4.p1.4.m4.1a"><mn id="S3.SS4.SSS0.Px4.p1.4.m4.1.1" xref="S3.SS4.SSS0.Px4.p1.4.m4.1.1.cmml">16</mn><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px4.p1.4.m4.1b"><cn id="S3.SS4.SSS0.Px4.p1.4.m4.1.1.cmml" type="integer" xref="S3.SS4.SSS0.Px4.p1.4.m4.1.1">16</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px4.p1.4.m4.1c">16</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS0.Px4.p1.4.m4.1d">16</annotation></semantics></math>, and <math alttext="32" class="ltx_Math" display="inline" id="S3.SS4.SSS0.Px4.p1.5.m5.1"><semantics id="S3.SS4.SSS0.Px4.p1.5.m5.1a"><mn id="S3.SS4.SSS0.Px4.p1.5.m5.1.1" xref="S3.SS4.SSS0.Px4.p1.5.m5.1.1.cmml">32</mn><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px4.p1.5.m5.1b"><cn id="S3.SS4.SSS0.Px4.p1.5.m5.1.1.cmml" type="integer" xref="S3.SS4.SSS0.Px4.p1.5.m5.1.1">32</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px4.p1.5.m5.1c">32</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS0.Px4.p1.5.m5.1d">32</annotation></semantics></math> experts, respectively.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS4.SSS0.Px4.p2">
<p class="ltx_p" id="S3.SS4.SSS0.Px4.p2.1">Our findings demonstrate that all experts contribute positively, with consistent perplexity improvements observed across all routed dataset segments. Moreover, the performance gap between our method and the baseline widens as the number of experts increases, suggesting enhanced specialization due to finer partitioning of the data distribution.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS4.SSS0.Px4.p3">
<p class="ltx_p" id="S3.SS4.SSS0.Px4.p3.1">Notably, despite the absence of capacity constraints on experts during inference, unlike the enforced capacities during training, all experts are actively utilized and receive substantial portions of the data.
The consistent improvements across all routed dataset segments confirm that the experts do specialize and they all contribute to the overall improvement instead of only a few dominant experts.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_figure" id="S3.F5">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S3.F5.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="467" id="S3.F5.sf1.g1" src="https://arxiv.org/html/2410.03529v1/x13.png" width="829">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(a) </span><math alttext="4" class="ltx_Math" display="inline" id="S3.F5.sf1.3.m1.1"><semantics id="S3.F5.sf1.3.m1.1b"><mn id="S3.F5.sf1.3.m1.1.1" xref="S3.F5.sf1.3.m1.1.1.cmml">4</mn><annotation-xml encoding="MathML-Content" id="S3.F5.sf1.3.m1.1c"><cn id="S3.F5.sf1.3.m1.1.1.cmml" type="integer" xref="S3.F5.sf1.3.m1.1.1">4</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.F5.sf1.3.m1.1d">4</annotation><annotation encoding="application/x-llamapun" id="S3.F5.sf1.3.m1.1e">4</annotation></semantics></math> experts vs dense, <math alttext="266" class="ltx_Math" display="inline" id="S3.F5.sf1.4.m2.1"><semantics id="S3.F5.sf1.4.m2.1b"><mn id="S3.F5.sf1.4.m2.1.1" xref="S3.F5.sf1.4.m2.1.1.cmml">266</mn><annotation-xml encoding="MathML-Content" id="S3.F5.sf1.4.m2.1c"><cn id="S3.F5.sf1.4.m2.1.1.cmml" type="integer" xref="S3.F5.sf1.4.m2.1.1">266</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.F5.sf1.4.m2.1d">266</annotation><annotation encoding="application/x-llamapun" id="S3.F5.sf1.4.m2.1e">266</annotation></semantics></math>B</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S3.F5.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="473" id="S3.F5.sf2.g1" src="https://arxiv.org/html/2410.03529v1/x14.png" width="829">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(b) </span><math alttext="16" class="ltx_Math" display="inline" id="S3.F5.sf2.3.m1.1"><semantics id="S3.F5.sf2.3.m1.1b"><mn id="S3.F5.sf2.3.m1.1.1" xref="S3.F5.sf2.3.m1.1.1.cmml">16</mn><annotation-xml encoding="MathML-Content" id="S3.F5.sf2.3.m1.1c"><cn id="S3.F5.sf2.3.m1.1.1.cmml" type="integer" xref="S3.F5.sf2.3.m1.1.1">16</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.F5.sf2.3.m1.1d">16</annotation><annotation encoding="application/x-llamapun" id="S3.F5.sf2.3.m1.1e">16</annotation></semantics></math> experts vs dense, <math alttext="1" class="ltx_Math" display="inline" id="S3.F5.sf2.4.m2.1"><semantics id="S3.F5.sf2.4.m2.1b"><mn id="S3.F5.sf2.4.m2.1.1" xref="S3.F5.sf2.4.m2.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="S3.F5.sf2.4.m2.1c"><cn id="S3.F5.sf2.4.m2.1.1.cmml" type="integer" xref="S3.F5.sf2.4.m2.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.F5.sf2.4.m2.1d">1</annotation><annotation encoding="application/x-llamapun" id="S3.F5.sf2.4.m2.1e">1</annotation></semantics></math>T</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S3.F5.sf3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="473" id="S3.F5.sf3.g1" src="https://arxiv.org/html/2410.03529v1/x15.png" width="829">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(c) </span><math alttext="32" class="ltx_Math" display="inline" id="S3.F5.sf3.3.m1.1"><semantics id="S3.F5.sf3.3.m1.1b"><mn id="S3.F5.sf3.3.m1.1.1" xref="S3.F5.sf3.3.m1.1.1.cmml">32</mn><annotation-xml encoding="MathML-Content" id="S3.F5.sf3.3.m1.1c"><cn id="S3.F5.sf3.3.m1.1.1.cmml" type="integer" xref="S3.F5.sf3.3.m1.1.1">32</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.F5.sf3.3.m1.1d">32</annotation><annotation encoding="application/x-llamapun" id="S3.F5.sf3.3.m1.1e">32</annotation></semantics></math> experts vs dense, <math alttext="2" class="ltx_Math" display="inline" id="S3.F5.sf3.4.m2.1"><semantics id="S3.F5.sf3.4.m2.1b"><mn id="S3.F5.sf3.4.m2.1.1" xref="S3.F5.sf3.4.m2.1.1.cmml">2</mn><annotation-xml encoding="MathML-Content" id="S3.F5.sf3.4.m2.1c"><cn id="S3.F5.sf3.4.m2.1.1.cmml" type="integer" xref="S3.F5.sf3.4.m2.1.1">2</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.F5.sf3.4.m2.1d">2</annotation><annotation encoding="application/x-llamapun" id="S3.F5.sf3.4.m2.1e">2</annotation></semantics></math>T</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span><span class="ltx_text ltx_font_bold" id="S3.F5.17.1">Experts Do specialize.</span> Test perplexity comparison between our method and the dense baseline on the routed dataset segments for the 1.3B parameter model, using mixtures of <math alttext="4" class="ltx_Math" display="inline" id="S3.F5.7.m1.1"><semantics id="S3.F5.7.m1.1b"><mn id="S3.F5.7.m1.1.1" xref="S3.F5.7.m1.1.1.cmml">4</mn><annotation-xml encoding="MathML-Content" id="S3.F5.7.m1.1c"><cn id="S3.F5.7.m1.1.1.cmml" type="integer" xref="S3.F5.7.m1.1.1">4</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.F5.7.m1.1d">4</annotation><annotation encoding="application/x-llamapun" id="S3.F5.7.m1.1e">4</annotation></semantics></math> experts in <span class="ltx_text ltx_font_bold" id="S3.F5.18.2">(a)</span> (trained on <math alttext="266" class="ltx_Math" display="inline" id="S3.F5.8.m2.1"><semantics id="S3.F5.8.m2.1b"><mn id="S3.F5.8.m2.1.1" xref="S3.F5.8.m2.1.1.cmml">266</mn><annotation-xml encoding="MathML-Content" id="S3.F5.8.m2.1c"><cn id="S3.F5.8.m2.1.1.cmml" type="integer" xref="S3.F5.8.m2.1.1">266</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.F5.8.m2.1d">266</annotation><annotation encoding="application/x-llamapun" id="S3.F5.8.m2.1e">266</annotation></semantics></math>B tokens), <math alttext="16" class="ltx_Math" display="inline" id="S3.F5.9.m3.1"><semantics id="S3.F5.9.m3.1b"><mn id="S3.F5.9.m3.1.1" xref="S3.F5.9.m3.1.1.cmml">16</mn><annotation-xml encoding="MathML-Content" id="S3.F5.9.m3.1c"><cn id="S3.F5.9.m3.1.1.cmml" type="integer" xref="S3.F5.9.m3.1.1">16</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.F5.9.m3.1d">16</annotation><annotation encoding="application/x-llamapun" id="S3.F5.9.m3.1e">16</annotation></semantics></math> experts in <span class="ltx_text ltx_font_bold" id="S3.F5.19.3">(b)</span> (<math alttext="1" class="ltx_Math" display="inline" id="S3.F5.10.m4.1"><semantics id="S3.F5.10.m4.1b"><mn id="S3.F5.10.m4.1.1" xref="S3.F5.10.m4.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="S3.F5.10.m4.1c"><cn id="S3.F5.10.m4.1.1.cmml" type="integer" xref="S3.F5.10.m4.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.F5.10.m4.1d">1</annotation><annotation encoding="application/x-llamapun" id="S3.F5.10.m4.1e">1</annotation></semantics></math>T tokens), and <math alttext="32" class="ltx_Math" display="inline" id="S3.F5.11.m5.1"><semantics id="S3.F5.11.m5.1b"><mn id="S3.F5.11.m5.1.1" xref="S3.F5.11.m5.1.1.cmml">32</mn><annotation-xml encoding="MathML-Content" id="S3.F5.11.m5.1c"><cn id="S3.F5.11.m5.1.1.cmml" type="integer" xref="S3.F5.11.m5.1.1">32</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.F5.11.m5.1d">32</annotation><annotation encoding="application/x-llamapun" id="S3.F5.11.m5.1e">32</annotation></semantics></math> experts in <span class="ltx_text ltx_font_bold" id="S3.F5.20.4">(c)</span> (<math alttext="2" class="ltx_Math" display="inline" id="S3.F5.12.m6.1"><semantics id="S3.F5.12.m6.1b"><mn id="S3.F5.12.m6.1.1" xref="S3.F5.12.m6.1.1.cmml">2</mn><annotation-xml encoding="MathML-Content" id="S3.F5.12.m6.1c"><cn id="S3.F5.12.m6.1.1.cmml" type="integer" xref="S3.F5.12.m6.1.1">2</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.F5.12.m6.1d">2</annotation><annotation encoding="application/x-llamapun" id="S3.F5.12.m6.1e">2</annotation></semantics></math>T tokens). Each bar represents a dataset segment, with the color intensity indicating the percentage of data assigned to that expert – darker shades correspond to a higher proportion of data. Overlapping bars depict the perplexity achieved by the dense baseline (translucent) and our proposed mixture model (opaque). The results demonstrate that all experts specialize effectively on their assigned segments of the data distribution, leading to consistent improvements over the baseline. While the data distribution among experts is not perfectly even – with some experts receiving more data than others – all experts receive a substantial portion of the data. This shows that each expert contributes meaningfully to the overall performance gains.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</section>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Related Work</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S4.p1">
<p class="ltx_p" id="S4.p1.1">Data-parallel training requires synchronization of the gradients after each backward pass, which can be slow if the network bandwidth is limited. In this section, we discuss existing methods that aim to make data parallelism more communication-efficient via reducing the frequency of the synchronization. Since our paper also explores methods for efficient inference without performance degradation, we discuss this branch of research as well.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<section class="ltx_paragraph" id="S4.SS0.SSS0.Px1">
<h5 class="ltx_title ltx_title_paragraph">Distributed optimization</h5><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S4.SS0.SSS0.Px1.p1">
<p class="ltx_p" id="S4.SS0.SSS0.Px1.p1.1">To reduce the frequency of synchronisation during training of large models, researchers have explored distributed optimization techniques both theoretically and empirically
<cite class="ltx_cite ltx_citemacro_citep">(Mcdonald et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#bib.bib37" title="">2009</a>; Stich, <a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#bib.bib47" title="">2019</a>; Lian et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#bib.bib32" title="">2018</a>; Wang &amp; Joshi, <a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#bib.bib53" title="">2019</a>; McMahan et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#bib.bib38" title="">2017</a>; Lin et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#bib.bib34" title="">2018</a>; Zinkevich et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#bib.bib59" title="">2010</a>)</cite>. The core principle of these methods is to allow each worker to execute several local training iterations before engaging in global synchronization – each device performs multiple optimizer updates per communication round. This technique also has been studied for LLM pre-training <cite class="ltx_cite ltx_citemacro_citep">(Diskin et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#bib.bib12" title="">2021</a>; Douillard et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#bib.bib13" title="">2023</a>)</cite> and fine-tuning <cite class="ltx_cite ltx_citemacro_citep">(Borzunov et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#bib.bib3" title="">2022</a>; Liu et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#bib.bib35" title="">2024</a>; Hilmkil et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#bib.bib22" title="">2021</a>; Ro et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#bib.bib44" title="">2022</a>)</cite>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS0.SSS0.Px1.p2">
<p class="ltx_p" id="S4.SS0.SSS0.Px1.p2.1">While theses approaches reduces the frequency of communication, thereby decreasing communication overhead, they often result in degraded model performance compared to every step synchronization <cite class="ltx_cite ltx_citemacro_citep">(Diskin et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#bib.bib12" title="">2021</a>)</cite>, or they lack direct performance comparisons in the context of pre-training <cite class="ltx_cite ltx_citemacro_citep">(Douillard et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#bib.bib13" title="">2023</a>)</cite>. The degradation in performance is often attributed to the staleness of gradients and the divergence between local and global models due to delayed synchronization <cite class="ltx_cite ltx_citemacro_citep">(Zhang et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#bib.bib58" title="">2016</a>; Yu et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#bib.bib55" title="">2019</a>; Mitra et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#bib.bib39" title="">2021</a>)</cite>. Moreover, to our knowledge, all experiments have been conducted at a small scale (<math alttext="\leq 400" class="ltx_Math" display="inline" id="S4.SS0.SSS0.Px1.p2.1.m1.1"><semantics id="S4.SS0.SSS0.Px1.p2.1.m1.1a"><mrow id="S4.SS0.SSS0.Px1.p2.1.m1.1.1" xref="S4.SS0.SSS0.Px1.p2.1.m1.1.1.cmml"><mi id="S4.SS0.SSS0.Px1.p2.1.m1.1.1.2" xref="S4.SS0.SSS0.Px1.p2.1.m1.1.1.2.cmml"></mi><mo id="S4.SS0.SSS0.Px1.p2.1.m1.1.1.1" xref="S4.SS0.SSS0.Px1.p2.1.m1.1.1.1.cmml">≤</mo><mn id="S4.SS0.SSS0.Px1.p2.1.m1.1.1.3" xref="S4.SS0.SSS0.Px1.p2.1.m1.1.1.3.cmml">400</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS0.SSS0.Px1.p2.1.m1.1b"><apply id="S4.SS0.SSS0.Px1.p2.1.m1.1.1.cmml" xref="S4.SS0.SSS0.Px1.p2.1.m1.1.1"><leq id="S4.SS0.SSS0.Px1.p2.1.m1.1.1.1.cmml" xref="S4.SS0.SSS0.Px1.p2.1.m1.1.1.1"></leq><csymbol cd="latexml" id="S4.SS0.SSS0.Px1.p2.1.m1.1.1.2.cmml" xref="S4.SS0.SSS0.Px1.p2.1.m1.1.1.2">absent</csymbol><cn id="S4.SS0.SSS0.Px1.p2.1.m1.1.1.3.cmml" type="integer" xref="S4.SS0.SSS0.Px1.p2.1.m1.1.1.3">400</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS0.SSS0.Px1.p2.1.m1.1c">\leq 400</annotation><annotation encoding="application/x-llamapun" id="S4.SS0.SSS0.Px1.p2.1.m1.1d">≤ 400</annotation></semantics></math>M parameters) <cite class="ltx_cite ltx_citemacro_citep">(Douillard et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#bib.bib13" title="">2023</a>; Liu et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#bib.bib35" title="">2024</a>; Ro et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#bib.bib44" title="">2022</a>)</cite>. Therefore, scalable solutions that can reduce communication frequency for LLM training without compromising performance at larger scales are still needed.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_paragraph" id="S4.SS0.SSS0.Px2">
<h5 class="ltx_title ltx_title_paragraph">Mixture of Experts</h5><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S4.SS0.SSS0.Px2.p1">
<p class="ltx_p" id="S4.SS0.SSS0.Px2.p1.1">Mixture of Experts (MoE) models have emerged as a prominent approach to increase model capacity without a proportional increase in inference costs <cite class="ltx_cite ltx_citemacro_citep">(Jacobs et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#bib.bib24" title="">1991</a>; Jordan &amp; Jacobs, <a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#bib.bib26" title="">1994</a>)</cite>. The key idea behind MoE is to partition the input space into subsets corresponding to specific subtasks, each managed by a specialized expert. By training different experts on distinct tasks, MoE models aim to enhance performance while reducing computational overhead during inference.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS0.SSS0.Px2.p2">
<p class="ltx_p" id="S4.SS0.SSS0.Px2.p2.1">Early implementations of MoE employed algorithms such as Gaussian Processes <cite class="ltx_cite ltx_citemacro_citep">(Tresp, <a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#bib.bib51" title="">2000</a>; Theis &amp; Bethge, <a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#bib.bib50" title="">2015</a>; Deisenroth &amp; Ng, <a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#bib.bib10" title="">2015</a>)</cite>, Dirichlet Processes <cite class="ltx_cite ltx_citemacro_citep">(Shahbaba &amp; Neal, <a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#bib.bib45" title="">2009</a>)</cite>, and Support Vector Machines (SVMs) <cite class="ltx_cite ltx_citemacro_citep">(Collobert et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#bib.bib7" title="">2001</a>)</cite> to model these specialized functions. Recent advancements have integrated deep neural networks as experts, providing scalable and flexible implementations suitable for large-scale models.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS0.SSS0.Px2.p3">
<p class="ltx_p" id="S4.SS0.SSS0.Px2.p3.1">In natural language processing, researchers have generalized the original MoE idea to enhance large-scale language models. For instance, <cite class="ltx_cite ltx_citemacro_citet">Shazeer et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#bib.bib46" title="">2017</a>)</cite> introduced a Mixture of Experts feed forward layer in which, in contrast to prior works, routing decision is made for every token. This layer takes a token representation as an input and routes it to the best-matched top-<math alttext="k" class="ltx_Math" display="inline" id="S4.SS0.SSS0.Px2.p3.1.m1.1"><semantics id="S4.SS0.SSS0.Px2.p3.1.m1.1a"><mi id="S4.SS0.SSS0.Px2.p3.1.m1.1.1" xref="S4.SS0.SSS0.Px2.p3.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.SS0.SSS0.Px2.p3.1.m1.1b"><ci id="S4.SS0.SSS0.Px2.p3.1.m1.1.1.cmml" xref="S4.SS0.SSS0.Px2.p3.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS0.SSS0.Px2.p3.1.m1.1c">k</annotation><annotation encoding="application/x-llamapun" id="S4.SS0.SSS0.Px2.p3.1.m1.1d">italic_k</annotation></semantics></math> experts. By doing so the number of active parameters is decreased. Similar approaches have been effectively employed in models like the Switch Transformer <cite class="ltx_cite ltx_citemacro_citep">(Fedus et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#bib.bib16" title="">2022</a>)</cite>, GShard <cite class="ltx_cite ltx_citemacro_citep">(Lepikhin et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#bib.bib29" title="">2021</a>)</cite>, GLaM <cite class="ltx_cite ltx_citemacro_citep">(Du et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#bib.bib14" title="">2022</a>)</cite> and Mixtral of Experts <cite class="ltx_cite ltx_citemacro_citep">(Jiang et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#bib.bib25" title="">2024</a>)</cite> which leverage MoE layers to achieve state-of-the-art results with reduced number of active parameters costs.
However, since the routing decision in models like Switch Transformer MoE is made on the token level: (1) all experts must be retained in RAM during both training and inference phases, necessitating substantial memory resources, and (2) a high communication overhead is required for data transfer and gradient synchronization across experts <cite class="ltx_cite ltx_citemacro_citep">(Lepikhin et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#bib.bib29" title="">2021</a>; Fedus et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#bib.bib16" title="">2022</a>; Riquelme et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#bib.bib43" title="">2021</a>)</cite>.
In that respect this approach is completely orthogonal to our proposed <span class="ltx_text ltx_font_smallcaps" id="S4.SS0.SSS0.Px2.p3.1.1">SmallTalk LM</span>. In fact, each of the experts in our method could be such a token-level mixture model which would result in even smaller inference FLOPs for a specific achieved perplexity albeit with a significantly more complex implementation and higher RAM requirements during inference.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_paragraph" id="S4.SS0.SSS0.Px3">
<h5 class="ltx_title ltx_title_paragraph">Independent Training of Mixture of Experts Models</h5><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S4.SS0.SSS0.Px3.p1">
<p class="ltx_p" id="S4.SS0.SSS0.Px3.p1.1">To train experts fully in parallel, recent research has also explored independent training of the mixture of experts models <cite class="ltx_cite ltx_citemacro_citep">(Gross et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#bib.bib18" title="">2017</a>; Li et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#bib.bib31" title="">2022</a>; Gururangan et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#bib.bib19" title="">2023</a>)</cite>.
For instance, <cite class="ltx_cite ltx_citemacro_citet">Gross et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#bib.bib18" title="">2017</a>)</cite> proposed to train a gater independently from the experts and use the output of the gater to hard assign the input image to experts. In language processing, <cite class="ltx_cite ltx_citemacro_citet">Li et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#bib.bib31" title="">2022</a>)</cite> and <cite class="ltx_cite ltx_citemacro_citet">Gururangan et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#bib.bib19" title="">2023</a>)</cite> proposed methods that train expert models separately and merge them post-training. However, these approaches rely on full document context or metadata for routing, which can be impractical in real-time applications involving shorter inputs. For instance, <cite class="ltx_cite ltx_citemacro_citet">Gururangan et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#bib.bib19" title="">2023</a>)</cite> focus on performance in text classification tasks, which may not fully reflect real-world scenarios.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Conclusion</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S5.p1">
<p class="ltx_p" id="S5.p1.1">In this work, we present <span class="ltx_text ltx_font_smallcaps" id="S5.p1.1.1">SmallTalk LM</span> – a method that significantly reduces communication overhead during LLM training. It also outperforms dense model baselines trained with a similar amount of FLOPs and the same data volume and comparable inference costs. In addition, our proposed lightweight routing with short prefixes makes <span class="ltx_text ltx_font_smallcaps" id="S5.p1.1.2">SmallTalk LM</span> practical for real-world downstream tasks, where we show it largely outperforms the dense baselines.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S5.p2">
<p class="ltx_p" id="S5.p2.1">These findings open up multiple directions for future research, including exploring different routing strategies for data partitioning among experts and investigating further the impact on downstream task performance. Another promising avenue is scaling the mixture to hundreds or even thousands of experts, which could further enhance model performance while benefiting from sparse inference.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_section" id="Sx1">
<h2 class="ltx_title ltx_title_section">Acknowledgments</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="Sx1.p1">
<p class="ltx_p" id="Sx1.p1.1">We thank Jagrid Digani and Awni Hannun for their insightful discussions on the algorithm and experiments. We thank Justin Deschenaux for his contributions to the early stages of the project.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Aji &amp; Heafield (2017)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Alham&nbsp;Fikri Aji and Kenneth Heafield.

</span>
<span class="ltx_bibblock">Sparse communication for distributed gradient descent.

</span>
<span class="ltx_bibblock">In Martha Palmer, Rebecca Hwa, and Sebastian Riedel (eds.), <em class="ltx_emph ltx_font_italic" id="bib.bib1.1.1">Proceedings of the 2017 Conference on Empirical Methods in Natural Language Processing</em>, pp.&nbsp; 440–445. Association for Computational Linguistics, September 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Artetxe et&nbsp;al. (2022)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Mikel Artetxe, Shruti Bhosale, Naman Goyal, Todor Mihaylov, Myle Ott, Sam Shleifer, Xi&nbsp;Victoria Lin, Jingfei Du, Srinivasan Iyer, Ramakanth Pasunuru, Giridharan Anantharaman, Xian Li, Shuohui Chen, Halil Akin, Mandeep Baines, Louis Martin, Xing Zhou, Punit&nbsp;Singh Koura, Brian O’Horo, Jeffrey Wang, Luke Zettlemoyer, Mona Diab, Zornitsa Kozareva, and Veselin Stoyanov.

</span>
<span class="ltx_bibblock">Efficient large scale language modeling with mixtures of experts.

</span>
<span class="ltx_bibblock">In Yoav Goldberg, Zornitsa Kozareva, and Yue Zhang (eds.), <em class="ltx_emph ltx_font_italic" id="bib.bib2.1.1">Proceedings of the 2022 Conference on Empirical Methods in Natural Language Processing</em>, pp.&nbsp; 11699–11732. Association for Computational Linguistics, December 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Borzunov et&nbsp;al. (2022)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Alexander Borzunov, Dmitry Baranchuk, Tim Dettmers, Max Ryabinin, Younes Belkada, Artem Chumachenko, Pavel Samygin, and Colin Raffel.

</span>
<span class="ltx_bibblock">Petals: Collaborative inference and fine-tuning of large models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib3.1.1">Association for Computational Linguistics</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bradbury et&nbsp;al. (2018)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
James Bradbury, Roy Frostig, Peter Hawkins, Matthew&nbsp;James Johnson, Chris Leary, Dougal Maclaurin, George Necula, Adam Paszke, Jake VanderPlas, Skye Wanderman-Milne, and Qiao Zhang.

</span>
<span class="ltx_bibblock">JAX: composable transformations of Python+NumPy programs, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Brown et&nbsp;al. (2020)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Tom Brown, Benjamin Mann, Nick Ryder, Melanie Subbiah, Jared&nbsp;D Kaplan, Prafulla Dhariwal, Arvind Neelakantan, Pranav Shyam, Girish Sastry, Amanda Askell, Sandhini Agarwal, Ariel Herbert-Voss, Gretchen Krueger, Tom Henighan, Rewon Child, Aditya Ramesh, Daniel Ziegler, Jeffrey Wu, Clemens Winter, Chris Hesse, Mark Chen, Eric Sigler, Mateusz Litwin, Scott Gray, Benjamin Chess, Jack Clark, Christopher Berner, Sam McCandlish, Alec Radford, Ilya Sutskever, and Dario Amodei.

</span>
<span class="ltx_bibblock">Language models are few-shot learners.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib5.1.1">Advances in Neural Information Processing Systems</em>, 33:1877–1901, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Clark et&nbsp;al. (2018)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Peter Clark, Isaac Cowhey, Oren Etzioni, Tushar Khot, Ashish Sabharwal, Carissa Schoenick, and Oyvind Tafjord.

</span>
<span class="ltx_bibblock">Think you have solved question answering? try arc, the ai2 reasoning challenge.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib6.1.1">arXiv preprint arXiv:1803.05457</em>, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Collobert et&nbsp;al. (2001)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Ronan Collobert, Samy Bengio, and Yoshua Bengio.

</span>
<span class="ltx_bibblock">A parallel mixture of svms for very large scale problems.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib7.1.1">Advances in Neural Information Processing Systems</em>, 14, 2001.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Common Crawl (2024)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Common Crawl.

</span>
<span class="ltx_bibblock">Common crawl: Open web data, 2024.

</span>
<span class="ltx_bibblock">Accessed: 2024-09-15.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Computer (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Together Computer.

</span>
<span class="ltx_bibblock">Redpajama: An open source recipe to reproduce llama training dataset, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Deisenroth &amp; Ng (2015)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Marc Deisenroth and Jun&nbsp;Wei Ng.

</span>
<span class="ltx_bibblock">Distributed gaussian processes.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib10.1.1">International conference on machine learning</em>, pp.&nbsp; 1481–1490. PMLR, 2015.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dettmers (2016)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Tim Dettmers.

</span>
<span class="ltx_bibblock">8-bit approximations for parallelism in deep learning.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib11.1.1">International Conference on Learning Representations</em>, 2016.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Diskin et&nbsp;al. (2021)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Michael Diskin, Alexey Bukhtiyarov, Max Ryabinin, Lucile Saulnier, Anton Sinitsin, Dmitry Popov, Dmitry&nbsp;V Pyrkin, Maxim Kashirin, Alexander Borzunov, Albert Villanova&nbsp;del Moral, et&nbsp;al.

</span>
<span class="ltx_bibblock">Distributed deep learning in open collaborations.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib12.1.1">Advances in Neural Information Processing Systems</em>, 34:7879–7897, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Douillard et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Arthur Douillard, Qixuan Feng, Andrei&nbsp;A Rusu, Rachita Chhaparia, Yani Donchev, Adhiguna Kuncoro, Marc’Aurelio Ranzato, Arthur Szlam, and Jiajun Shen.

</span>
<span class="ltx_bibblock">Diloco: Distributed low-communication training of language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib13.1.1">arXiv preprint arXiv:2311.08105</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Du et&nbsp;al. (2022)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Nan Du, Yanping Huang, Andrew&nbsp;M Dai, Simon Tong, Dmitry Lepikhin, Yuanzhong Xu, Maxim Krikun, Yanqi Zhou, Adams&nbsp;Wei Yu, Orhan Firat, et&nbsp;al.

</span>
<span class="ltx_bibblock">Glam: Efficient scaling of language models with mixture-of-experts.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib14.1.1">International Conference on Machine Learning</em>, pp.&nbsp; 5547–5569. PMLR, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dubey et&nbsp;al. (2024)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Abhimanyu Dubey, Abhinav Jauhri, Abhinav Pandey, Abhishek Kadian, Ahmad Al-Dahle, Aiesha Letman, Akhil Mathur, Alan Schelten, Amy Yang, Angela Fan, et&nbsp;al.

</span>
<span class="ltx_bibblock">The llama 3 herd of models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib15.1.1">arXiv preprint arXiv:2407.21783</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Fedus et&nbsp;al. (2022)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
William Fedus, Barret Zoph, and Noam Shazeer.

</span>
<span class="ltx_bibblock">Switch transformers: Scaling to trillion parameter models with simple and efficient sparsity.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib16.1.1">Journal of Machine Learning Research</em>, 23(120):1–39, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gao et&nbsp;al. (2024)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Leo Gao, Jonathan Tow, Baber Abbasi, Stella Biderman, Sid Black, Anthony DiPofi, Charles Foster, Laurence Golding, Jeffrey Hsu, Alain Le&nbsp;Noac’h, Haonan Li, Kyle McDonell, Niklas Muennighoff, Chris Ociepa, Jason Phang, Laria Reynolds, Hailey Schoelkopf, Aviya Skowron, Lintang Sutawika, Eric Tang, Anish Thite, Ben Wang, Kevin Wang, and Andy Zou.

</span>
<span class="ltx_bibblock">A framework for few-shot language model evaluation, 07 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gross et&nbsp;al. (2017)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Sam Gross, Marc’Aurelio Ranzato, and Arthur Szlam.

</span>
<span class="ltx_bibblock">Hard mixtures of experts for large scale weakly supervised vision.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib18.1.1">Proceedings of the IEEE Conference on Computer Vision and Pattern Recognition</em>, pp.&nbsp; 6865–6873, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gururangan et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Suchin Gururangan, Margaret Li, Mike Lewis, Weijia Shi, Tim Althoff, Noah&nbsp;A Smith, and Luke Zettlemoyer.

</span>
<span class="ltx_bibblock">Scaling expert language models with unsupervised domain discovery.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib19.1.1">arXiv preprint arXiv:2303.14177</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hendrycks et&nbsp;al. (2020)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Dan Hendrycks, Collin Burns, Steven Basart, Andy Zou, Mantas Mazeika, Dawn Song, and Jacob Steinhardt.

</span>
<span class="ltx_bibblock">Measuring massive multitask language understanding.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib20.1.1">arXiv preprint arXiv:2009.03300</em>, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Henighan et&nbsp;al. (2020)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Tom Henighan, Jared Kaplan, Mor Katz, Mark Chen, Christopher Hesse, Jacob Jackson, Heewoo Jun, Tom&nbsp;B Brown, Prafulla Dhariwal, Scott Gray, et&nbsp;al.

</span>
<span class="ltx_bibblock">Scaling laws for autoregressive generative modeling.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib21.1.1">arXiv preprint arXiv:2010.14701</em>, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hilmkil et&nbsp;al. (2021)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Agrin Hilmkil, Sebastian Callh, Matteo Barbieri, Leon&nbsp;René Sütfeld, Edvin&nbsp;Listo Zec, and Olof Mogren.

</span>
<span class="ltx_bibblock">Scaling federated learning for fine-tuning of large language models.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib22.1.1">International Conference on Applications of Natural Language to Information Systems</em>, pp.&nbsp; 15–23. Springer, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hoffmann et&nbsp;al. (2022)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Jordan Hoffmann, Sebastian Borgeaud, Arthur Mensch, Elena Buchatskaya, Trevor Cai, Eliza Rutherford, Diego de&nbsp;Las Casas, Lisa&nbsp;Anne Hendricks, Johannes Welbl, Aidan Clark, et&nbsp;al.

</span>
<span class="ltx_bibblock">Training compute-optimal large language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib23.1.1">arXiv preprint arXiv:2203.15556</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jacobs et&nbsp;al. (1991)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Robert&nbsp;A Jacobs, Michael&nbsp;I Jordan, Steven&nbsp;J Nowlan, and Geoffrey&nbsp;E Hinton.

</span>
<span class="ltx_bibblock">Adaptive mixtures of local experts.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib24.1.1">Neural computation</em>, 3(1):79–87, 1991.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jiang et&nbsp;al. (2024)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Albert&nbsp;Q Jiang, Alexandre Sablayrolles, Antoine Roux, Arthur Mensch, Blanche Savary, Chris Bamford, Devendra&nbsp;Singh Chaplot, Diego de&nbsp;las Casas, Emma&nbsp;Bou Hanna, Florian Bressand, et&nbsp;al.

</span>
<span class="ltx_bibblock">Mixtral of experts.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib25.1.1">arXiv preprint arXiv:2401.04088</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jordan &amp; Jacobs (1994)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Michael&nbsp;I Jordan and Robert&nbsp;A Jacobs.

</span>
<span class="ltx_bibblock">Hierarchical mixtures of experts and the em algorithm.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib26.1.1">Neural computation</em>, 6(2):181–214, 1994.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kaplan et&nbsp;al. (2020)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Jared Kaplan, Sam McCandlish, Tom Henighan, Tom&nbsp;B Brown, Benjamin Chess, Rewon Child, Scott Gray, Alec Radford, Jeffrey Wu, and Dario Amodei.

</span>
<span class="ltx_bibblock">Scaling laws for neural language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib27.1.1">CoRR</em>, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kudo &amp; Richardson (2018)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Taku Kudo and John Richardson.

</span>
<span class="ltx_bibblock">SentencePiece: A simple and language independent subword tokenizer and detokenizer for neural text processing.

</span>
<span class="ltx_bibblock">In Eduardo Blanco and Wei Lu (eds.), <em class="ltx_emph ltx_font_italic" id="bib.bib28.1.1">Proceedings of the 2018 Conference on Empirical Methods in Natural Language Processing: System Demonstrations</em>, pp.&nbsp; 66–71, Brussels, Belgium, November 2018. Association for Computational Linguistics.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lepikhin et&nbsp;al. (2021)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Dmitry Lepikhin, HyoukJoong Lee, Yuanzhong Xu, Dehao Chen, Orhan Firat, Yanping Huang, Maxim Krikun, Noam Shazeer, and Zhifeng Chen.

</span>
<span class="ltx_bibblock">Gshard: Scaling giant models with conditional computation and automatic sharding.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib29.1.1">International Conference on Learning Representations</em>, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lewis et&nbsp;al. (2021)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Mike Lewis, Shruti Bhosale, Tim Dettmers, Naman Goyal, and Luke Zettlemoyer.

</span>
<span class="ltx_bibblock">Base layers: Simplifying training of large, sparse models.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib30.1.1">International Conference on Machine Learning</em>, pp.&nbsp; 6265–6274. PMLR, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et&nbsp;al. (2022)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Margaret Li, Suchin Gururangan, Tim Dettmers, Mike Lewis, Tim Althoff, Noah&nbsp;A Smith, and Luke Zettlemoyer.

</span>
<span class="ltx_bibblock">Branch-train-merge: Embarrassingly parallel training of expert language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib31.1.1">arXiv preprint arXiv:2208.03306</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lian et&nbsp;al. (2018)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Xiangru Lian, Ce&nbsp;Huang, Yijun Li, and Ji&nbsp;Liu.

</span>
<span class="ltx_bibblock">Asynchronous decentralized parallel stochastic gradient descent.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib32.1.1">Proceedings of the 35th International Conference on Machine Learning</em>, pp.&nbsp; 3043–3052. PMLR, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lin et&nbsp;al. (2017)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Yujun Lin, Song Han, Huizi Mao, Yu&nbsp;Wang, and William&nbsp;J Dally.

</span>
<span class="ltx_bibblock">Deep gradient compression: Reducing the communication bandwidth for distributed training.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib33.1.1">arXiv preprint arXiv:1712.01887</em>, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lin et&nbsp;al. (2018)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Yujun Lin, Song Han, Huizi Mao, Yu&nbsp;Wang, and William&nbsp;J Dally.

</span>
<span class="ltx_bibblock">Deep gradient compression: Reducing the communication bandwidth for distributed training.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib34.1.1">International Conference on Learning Representations</em>, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et&nbsp;al. (2024)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Bo&nbsp;Liu, Rachita Chhaparia, Arthur Douillard, Satyen Kale, Andrei&nbsp;A Rusu, Jiajun Shen, Arthur Szlam, and Marc’Aurelio Ranzato.

</span>
<span class="ltx_bibblock">Asynchronous local-sgd training for language modeling.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib35.1.1">arXiv preprint arXiv:2401.09135</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Loshchilov &amp; Hutter (2017)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Ilya Loshchilov and Frank Hutter.

</span>
<span class="ltx_bibblock">Decoupled weight decay regularization.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib36.1.1">International Conference on Learning Representations</em>, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mcdonald et&nbsp;al. (2009)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Ryan Mcdonald, Mehryar Mohri, Nathan Silberman, Dan Walker, and Gideon Mann.

</span>
<span class="ltx_bibblock">Efficient large-scale distributed training of conditional maximum entropy models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib37.1.1">Advances in neural information processing systems</em>, 22, 2009.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">McMahan et&nbsp;al. (2017)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
H.&nbsp;Brendan McMahan, Eider Moore, Daniel Ramage, Seth Hampson, and Blaise Aguera&nbsp;y Arcas.

</span>
<span class="ltx_bibblock">Communication-efficient learning of deep networks from decentralized data.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib38.1.1">Proceedings of the 20th International Conference on Artificial Intelligence and Statistics</em>, pp.&nbsp; 1273–1282. PMLR, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib39">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mitra et&nbsp;al. (2021)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Praneeth Mitra, Idan Bistritz, Ji&nbsp;Wang, Dan Alistarh, and Wotao Yin.

</span>
<span class="ltx_bibblock">Linear convergence in federated learning: Tackling client heterogeneity and asynchronous updates.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib39.1.1">Advances in Neural Information Processing Systems</em>, volume&nbsp;34, pp.&nbsp; 14606–14619, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib40">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Paszke et&nbsp;al. (2019)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Adam Paszke, Sam Gross, Francisco Massa, Adam Lerer, James Bradbury, Gregory Chanan, Trevor Killeen, Zeming Lin, Natalia Gimelshein, Luca Antiga, et&nbsp;al.

</span>
<span class="ltx_bibblock">Pytorch: An imperative style, high-performance deep learning library.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib40.1.1">Advances in neural information processing systems</em>, 32, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib41">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Patarasuk &amp; Yuan (2009)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Pitch Patarasuk and Xin Yuan.

</span>
<span class="ltx_bibblock">Bandwidth optimal all-reduce algorithms for clusters of workstations.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib41.1.1">Journal of Parallel and Distributed Computing</em>, 69(2):117–124, 2009.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib42">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Press et&nbsp;al. (2022)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Ofir Press, Noah&nbsp;A. Smith, and Mike Lewis.

</span>
<span class="ltx_bibblock">Train short, test long: Attention with linear biases enables input length extrapolation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib42.1.1">The Tenth International Conference on Learning Representations</em>. OpenReview.net, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib43">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Riquelme et&nbsp;al. (2021)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Carlos Riquelme, Joan Puigcerver, Basil Mustafa, Maxim Neumann, Rodolphe Jenatton, André Susano&nbsp;Pinto, Daniel Keysers, and Neil Houlsby.

</span>
<span class="ltx_bibblock">Scaling vision with sparse mixture of experts.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib43.1.1">Advances in Neural Information Processing Systems</em>, 34:8583–8595, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib44">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ro et&nbsp;al. (2022)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Jae&nbsp;Hun Ro, Theresa Breiner, Lara McConnaughey, Mingqing Chen, Ananda&nbsp;Theertha Suresh, Shankar Kumar, and Rajiv Mathews.

</span>
<span class="ltx_bibblock">Scaling language model size in cross-device federated learning.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib44.1.1">arXiv preprint arXiv:2204.09715</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib45">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shahbaba &amp; Neal (2009)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Babak Shahbaba and Radford Neal.

</span>
<span class="ltx_bibblock">Nonlinear models using dirichlet process mixtures.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib45.1.1">Journal of Machine Learning Research</em>, 10(8), 2009.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib46">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shazeer et&nbsp;al. (2017)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Noam Shazeer, *Azalia Mirhoseini, *Krzysztof Maziarz, Andy Davis, Quoc Le, Geoffrey Hinton, and Jeff Dean.

</span>
<span class="ltx_bibblock">Outrageously large neural networks: The sparsely-gated mixture-of-experts layer.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib46.1.1">International Conference on Learning Representations</em>, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib47">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Stich (2019)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Sebastian&nbsp;U Stich.

</span>
<span class="ltx_bibblock">Local SGD converges fast and communicates little.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib47.1.1">International Conference on Learning Representations</em>, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib48">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Su et&nbsp;al. (2024)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Jianlin Su, Murtadha Ahmed, Yu&nbsp;Lu, Shengfeng Pan, Wen Bo, and Yunfeng Liu.

</span>
<span class="ltx_bibblock">Roformer: Enhanced transformer with rotary position embedding.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib48.1.1">Neurocomputing</em>, 568:127063, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib49">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Thakur et&nbsp;al. (2005)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Rajeev Thakur, Rolf Rabenseifner, and William Gropp.

</span>
<span class="ltx_bibblock">Optimization of collective communication operations in mpich.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib49.1.1">The International Journal of High Performance Computing Applications</em>, 19(1):49–66, 2005.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib50">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Theis &amp; Bethge (2015)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Lucas Theis and Matthias Bethge.

</span>
<span class="ltx_bibblock">Generative image modeling using spatial lstms.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib50.1.1">Advances in neural information processing systems</em>, 28, 2015.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib51">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tresp (2000)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Volker Tresp.

</span>
<span class="ltx_bibblock">Mixtures of gaussian processes.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib51.1.1">Advances in neural information processing systems</em>, 13, 2000.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib52">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Vaswani (2017)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
A&nbsp;Vaswani.

</span>
<span class="ltx_bibblock">Attention is all you need.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib52.1.1">Advances in Neural Information Processing Systems</em>, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib53">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang &amp; Joshi (2019)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Jianyu Wang and Gauri Joshi.

</span>
<span class="ltx_bibblock">Adaptive communication strategies to achieve the best error-runtime trade-off in local-update sgd.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib53.1.1">Proceedings of Machine Learning and Systems</em>, 1:212–229, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib54">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Welbl et&nbsp;al. (2017)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Johannes Welbl, Nelson&nbsp;F. Liu, and Matt Gardner.

</span>
<span class="ltx_bibblock">Crowdsourcing multiple choice science questions.

</span>
<span class="ltx_bibblock">In Leon Derczynski, Wei Xu, Alan Ritter, and Tim Baldwin (eds.), <em class="ltx_emph ltx_font_italic" id="bib.bib54.1.1">Proceedings of the 3rd Workshop on Noisy User-generated Text</em>, pp.&nbsp; 94–106. Association for Computational Linguistics, September 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib55">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yu et&nbsp;al. (2019)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Hao Yu, Sen Yang, and Shenghuo Zhu.

</span>
<span class="ltx_bibblock">Parallel restarted sgd with faster convergence and less communication: Demystifying why model averaging works for deep learning.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib55.1.1">Proceedings of the AAAI Conference on Artificial Intelligence</em>, volume&nbsp;33, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib56">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zellers et&nbsp;al. (2019)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Rowan Zellers, Ari Holtzman, Yonatan Bisk, Ali Farhadi, and Yejin Choi.

</span>
<span class="ltx_bibblock">Hellaswag: Can a machine really finish your sentence?

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib56.1.1">Annual Meeting of the Association for Computational Linguistics</em>, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib57">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et&nbsp;al. (2015)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Sixin Zhang, Anna&nbsp;E Choromanska, and Yann LeCun.

</span>
<span class="ltx_bibblock">Deep learning with elastic averaging sgd.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib57.1.1">Advances in neural information processing systems</em>, 28, 2015.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib58">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et&nbsp;al. (2016)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Wei Zhang, Suyog Gupta, Xiangru Lian, and Ji&nbsp;Liu.

</span>
<span class="ltx_bibblock">Staleness-aware async-sgd for distributed deep learning.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib58.1.1">Proceedings of the 25th International Joint Conference on Artificial Intelligence</em>, pp.&nbsp; 2350–2356, 2016.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib59">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zinkevich et&nbsp;al. (2010)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Martin Zinkevich, Markus Weimer, Lihong Li, and Alex Smola.

</span>
<span class="ltx_bibblock">Parallelized stochastic gradient descent.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib59.1.1">Advances in neural information processing systems</em>, 23, 2010.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<nav class="ltx_TOC ltx_list_toc ltx_toc_toc"><h6 class="ltx_title ltx_title_contents">Contents</h6><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#S1" title="In No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#S2" title="In No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Method</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#S2.SS1" title="In 2 Method ‣ No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.1 </span>Background</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#S2.SS2" title="In 2 Method ‣ No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2 </span><span class="ltx_text ltx_font_smallcaps">SmallTalk LM</span></span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#S3" title="In No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Experiments</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#S3.SS1" title="In 3 Experiments ‣ No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Experimental Setup</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#S3.SS2" title="In 3 Experiments ‣ No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>Language Modeling Results</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#S3.SS3" title="In 3 Experiments ‣ No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3 </span>Downstream evaluation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#S3.SS4" title="In 3 Experiments ‣ No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.4 </span>Routing analysis</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#S4" title="In No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Related Work</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#S5" title="In No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Conclusion</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#A1" title="In No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A </span>Language modeling experiments</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#A1.SS1" title="In Appendix A Language modeling experiments ‣ No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.1 </span>Architecture and training details</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#A1.SS2" title="In Appendix A Language modeling experiments ‣ No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.2 </span>Notation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#A1.SS3" title="In Appendix A Language modeling experiments ‣ No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.3 </span>Computational Cost</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#A1.SS3.SSS1" title="In A.3 Computational Cost ‣ Appendix A Language modeling experiments ‣ No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.3.1 </span>Transformer</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#A1.SS3.SSS2" title="In A.3 Computational Cost ‣ Appendix A Language modeling experiments ‣ No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.3.2 </span>Mixture of LLMs</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#A1.SS4" title="In Appendix A Language modeling experiments ‣ No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.4 </span>Communication overhead</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#A2" title="In No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B </span>Downstream evaluation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#A3" title="In No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">C </span>Additional Results</span></a></li>
</ol></nav>
<section class="ltx_appendix" id="A1">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Language modeling experiments</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<section class="ltx_subsection" id="A1.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.1 </span>Architecture and training details</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="A1.SS1.p1">
<p class="ltx_p" id="A1.SS1.p1.1">Our architecture is based on the transformer decoder <cite class="ltx_cite ltx_citemacro_citep">(Vaswani, <a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#bib.bib52" title="">2017</a>)</cite>. We use rotary positional encoding <cite class="ltx_cite ltx_citemacro_citep">(Su et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#bib.bib48" title="">2024</a>)</cite>. We use a SentencePiece <cite class="ltx_cite ltx_citemacro_citep">(Kudo &amp; Richardson, <a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#bib.bib28" title="">2018</a>)</cite> tokenizer with a vocabulary of <math alttext="32000" class="ltx_Math" display="inline" id="A1.SS1.p1.1.m1.1"><semantics id="A1.SS1.p1.1.m1.1a"><mn id="A1.SS1.p1.1.m1.1.1" xref="A1.SS1.p1.1.m1.1.1.cmml">32000</mn><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.1.m1.1b"><cn id="A1.SS1.p1.1.m1.1.1.cmml" type="integer" xref="A1.SS1.p1.1.m1.1.1">32000</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.1.m1.1c">32000</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p1.1.m1.1d">32000</annotation></semantics></math> tokens. The model specific parameters for the different sizes are summarized in Table&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#A1.T1" title="Table 1 ‣ A.1 Architecture and training details ‣ Appendix A Language modeling experiments ‣ No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_tag">1</span></a>. We implemented our EM scheme for training the routers in PyTorch <cite class="ltx_cite ltx_citemacro_citep">(Paszke et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#bib.bib40" title="">2019</a>)</cite>. After segmenting the training set, the experts were trained independently using Jax&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Bradbury et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#bib.bib4" title="">2018</a>)</cite>. All training was done in <span class="ltx_text ltx_font_typewriter" id="A1.SS1.p1.1.1">bfloat16</span>. The optimizer states and operations are in <span class="ltx_text ltx_font_typewriter" id="A1.SS1.p1.1.2">float32</span>. The training parameters for specific models are summarised in Table <a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#A1.T2" title="Table 2 ‣ A.1 Architecture and training details ‣ Appendix A Language modeling experiments ‣ No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_tag">2</span></a>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_table" id="A1.T1">
<table class="ltx_tabular ltx_centering ltx_align_middle" id="A1.T1.25">
<tbody><tr class="ltx_tr" id="A1.T1.25.26">
<td class="ltx_td ltx_align_left ltx_border_tt" id="A1.T1.25.26.1"><span class="ltx_text ltx_font_bold" id="A1.T1.25.26.1.1">Model parameters</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A1.T1.25.26.2"><span class="ltx_text ltx_font_bold" id="A1.T1.25.26.2.1">Role</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A1.T1.25.26.3"><span class="ltx_text ltx_font_bold" id="A1.T1.25.26.3.1">Hidden size</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A1.T1.25.26.4"><span class="ltx_text ltx_font_bold" id="A1.T1.25.26.4.1">FFW expansion factor</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A1.T1.25.26.5"><span class="ltx_text ltx_font_bold" id="A1.T1.25.26.5.1">Layers</span></td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_tt" id="A1.T1.25.26.6"><span class="ltx_text ltx_font_bold" id="A1.T1.25.26.6.1">Attention heads</span></td>
</tr>
<tr class="ltx_tr" id="A1.T1.5.5">
<td class="ltx_td ltx_align_left ltx_border_t" id="A1.T1.1.1.1">
<math alttext="335" class="ltx_Math" display="inline" id="A1.T1.1.1.1.m1.1"><semantics id="A1.T1.1.1.1.m1.1a"><mn id="A1.T1.1.1.1.m1.1.1" xref="A1.T1.1.1.1.m1.1.1.cmml">335</mn><annotation-xml encoding="MathML-Content" id="A1.T1.1.1.1.m1.1b"><cn id="A1.T1.1.1.1.m1.1.1.cmml" type="integer" xref="A1.T1.1.1.1.m1.1.1">335</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T1.1.1.1.m1.1c">335</annotation><annotation encoding="application/x-llamapun" id="A1.T1.1.1.1.m1.1d">335</annotation></semantics></math>M</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T1.5.5.6">expert</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T1.2.2.2"><math alttext="1024" class="ltx_Math" display="inline" id="A1.T1.2.2.2.m1.1"><semantics id="A1.T1.2.2.2.m1.1a"><mn id="A1.T1.2.2.2.m1.1.1" xref="A1.T1.2.2.2.m1.1.1.cmml">1024</mn><annotation-xml encoding="MathML-Content" id="A1.T1.2.2.2.m1.1b"><cn id="A1.T1.2.2.2.m1.1.1.cmml" type="integer" xref="A1.T1.2.2.2.m1.1.1">1024</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T1.2.2.2.m1.1c">1024</annotation><annotation encoding="application/x-llamapun" id="A1.T1.2.2.2.m1.1d">1024</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T1.3.3.3"><math alttext="4" class="ltx_Math" display="inline" id="A1.T1.3.3.3.m1.1"><semantics id="A1.T1.3.3.3.m1.1a"><mn id="A1.T1.3.3.3.m1.1.1" xref="A1.T1.3.3.3.m1.1.1.cmml">4</mn><annotation-xml encoding="MathML-Content" id="A1.T1.3.3.3.m1.1b"><cn id="A1.T1.3.3.3.m1.1.1.cmml" type="integer" xref="A1.T1.3.3.3.m1.1.1">4</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T1.3.3.3.m1.1c">4</annotation><annotation encoding="application/x-llamapun" id="A1.T1.3.3.3.m1.1d">4</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T1.4.4.4"><math alttext="24" class="ltx_Math" display="inline" id="A1.T1.4.4.4.m1.1"><semantics id="A1.T1.4.4.4.m1.1a"><mn id="A1.T1.4.4.4.m1.1.1" xref="A1.T1.4.4.4.m1.1.1.cmml">24</mn><annotation-xml encoding="MathML-Content" id="A1.T1.4.4.4.m1.1b"><cn id="A1.T1.4.4.4.m1.1.1.cmml" type="integer" xref="A1.T1.4.4.4.m1.1.1">24</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T1.4.4.4.m1.1c">24</annotation><annotation encoding="application/x-llamapun" id="A1.T1.4.4.4.m1.1d">24</annotation></semantics></math></td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" id="A1.T1.5.5.5"><math alttext="16" class="ltx_Math" display="inline" id="A1.T1.5.5.5.m1.1"><semantics id="A1.T1.5.5.5.m1.1a"><mn id="A1.T1.5.5.5.m1.1.1" xref="A1.T1.5.5.5.m1.1.1.cmml">16</mn><annotation-xml encoding="MathML-Content" id="A1.T1.5.5.5.m1.1b"><cn id="A1.T1.5.5.5.m1.1.1.cmml" type="integer" xref="A1.T1.5.5.5.m1.1.1">16</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T1.5.5.5.m1.1c">16</annotation><annotation encoding="application/x-llamapun" id="A1.T1.5.5.5.m1.1d">16</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A1.T1.10.10">
<td class="ltx_td ltx_align_left" id="A1.T1.6.6.1">
<math alttext="1.3" class="ltx_Math" display="inline" id="A1.T1.6.6.1.m1.1"><semantics id="A1.T1.6.6.1.m1.1a"><mn id="A1.T1.6.6.1.m1.1.1" xref="A1.T1.6.6.1.m1.1.1.cmml">1.3</mn><annotation-xml encoding="MathML-Content" id="A1.T1.6.6.1.m1.1b"><cn id="A1.T1.6.6.1.m1.1.1.cmml" type="float" xref="A1.T1.6.6.1.m1.1.1">1.3</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T1.6.6.1.m1.1c">1.3</annotation><annotation encoding="application/x-llamapun" id="A1.T1.6.6.1.m1.1d">1.3</annotation></semantics></math>B</td>
<td class="ltx_td ltx_align_center" id="A1.T1.10.10.6">expert</td>
<td class="ltx_td ltx_align_center" id="A1.T1.7.7.2"><math alttext="2048" class="ltx_Math" display="inline" id="A1.T1.7.7.2.m1.1"><semantics id="A1.T1.7.7.2.m1.1a"><mn id="A1.T1.7.7.2.m1.1.1" xref="A1.T1.7.7.2.m1.1.1.cmml">2048</mn><annotation-xml encoding="MathML-Content" id="A1.T1.7.7.2.m1.1b"><cn id="A1.T1.7.7.2.m1.1.1.cmml" type="integer" xref="A1.T1.7.7.2.m1.1.1">2048</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T1.7.7.2.m1.1c">2048</annotation><annotation encoding="application/x-llamapun" id="A1.T1.7.7.2.m1.1d">2048</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="A1.T1.8.8.3"><math alttext="4" class="ltx_Math" display="inline" id="A1.T1.8.8.3.m1.1"><semantics id="A1.T1.8.8.3.m1.1a"><mn id="A1.T1.8.8.3.m1.1.1" xref="A1.T1.8.8.3.m1.1.1.cmml">4</mn><annotation-xml encoding="MathML-Content" id="A1.T1.8.8.3.m1.1b"><cn id="A1.T1.8.8.3.m1.1.1.cmml" type="integer" xref="A1.T1.8.8.3.m1.1.1">4</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T1.8.8.3.m1.1c">4</annotation><annotation encoding="application/x-llamapun" id="A1.T1.8.8.3.m1.1d">4</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="A1.T1.9.9.4"><math alttext="24" class="ltx_Math" display="inline" id="A1.T1.9.9.4.m1.1"><semantics id="A1.T1.9.9.4.m1.1a"><mn id="A1.T1.9.9.4.m1.1.1" xref="A1.T1.9.9.4.m1.1.1.cmml">24</mn><annotation-xml encoding="MathML-Content" id="A1.T1.9.9.4.m1.1b"><cn id="A1.T1.9.9.4.m1.1.1.cmml" type="integer" xref="A1.T1.9.9.4.m1.1.1">24</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T1.9.9.4.m1.1c">24</annotation><annotation encoding="application/x-llamapun" id="A1.T1.9.9.4.m1.1d">24</annotation></semantics></math></td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A1.T1.10.10.5"><math alttext="16" class="ltx_Math" display="inline" id="A1.T1.10.10.5.m1.1"><semantics id="A1.T1.10.10.5.m1.1a"><mn id="A1.T1.10.10.5.m1.1.1" xref="A1.T1.10.10.5.m1.1.1.cmml">16</mn><annotation-xml encoding="MathML-Content" id="A1.T1.10.10.5.m1.1b"><cn id="A1.T1.10.10.5.m1.1.1.cmml" type="integer" xref="A1.T1.10.10.5.m1.1.1">16</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T1.10.10.5.m1.1c">16</annotation><annotation encoding="application/x-llamapun" id="A1.T1.10.10.5.m1.1d">16</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A1.T1.15.15">
<td class="ltx_td ltx_align_left ltx_border_t" id="A1.T1.11.11.1">
<math alttext="4.4" class="ltx_Math" display="inline" id="A1.T1.11.11.1.m1.1"><semantics id="A1.T1.11.11.1.m1.1a"><mn id="A1.T1.11.11.1.m1.1.1" xref="A1.T1.11.11.1.m1.1.1.cmml">4.4</mn><annotation-xml encoding="MathML-Content" id="A1.T1.11.11.1.m1.1b"><cn id="A1.T1.11.11.1.m1.1.1.cmml" type="float" xref="A1.T1.11.11.1.m1.1.1">4.4</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T1.11.11.1.m1.1c">4.4</annotation><annotation encoding="application/x-llamapun" id="A1.T1.11.11.1.m1.1d">4.4</annotation></semantics></math>M</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T1.15.15.6">router</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T1.12.12.2"><math alttext="96" class="ltx_Math" display="inline" id="A1.T1.12.12.2.m1.1"><semantics id="A1.T1.12.12.2.m1.1a"><mn id="A1.T1.12.12.2.m1.1.1" xref="A1.T1.12.12.2.m1.1.1.cmml">96</mn><annotation-xml encoding="MathML-Content" id="A1.T1.12.12.2.m1.1b"><cn id="A1.T1.12.12.2.m1.1.1.cmml" type="integer" xref="A1.T1.12.12.2.m1.1.1">96</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T1.12.12.2.m1.1c">96</annotation><annotation encoding="application/x-llamapun" id="A1.T1.12.12.2.m1.1d">96</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T1.13.13.3"><math alttext="4" class="ltx_Math" display="inline" id="A1.T1.13.13.3.m1.1"><semantics id="A1.T1.13.13.3.m1.1a"><mn id="A1.T1.13.13.3.m1.1.1" xref="A1.T1.13.13.3.m1.1.1.cmml">4</mn><annotation-xml encoding="MathML-Content" id="A1.T1.13.13.3.m1.1b"><cn id="A1.T1.13.13.3.m1.1.1.cmml" type="integer" xref="A1.T1.13.13.3.m1.1.1">4</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T1.13.13.3.m1.1c">4</annotation><annotation encoding="application/x-llamapun" id="A1.T1.13.13.3.m1.1d">4</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T1.14.14.4"><math alttext="12" class="ltx_Math" display="inline" id="A1.T1.14.14.4.m1.1"><semantics id="A1.T1.14.14.4.m1.1a"><mn id="A1.T1.14.14.4.m1.1.1" xref="A1.T1.14.14.4.m1.1.1.cmml">12</mn><annotation-xml encoding="MathML-Content" id="A1.T1.14.14.4.m1.1b"><cn id="A1.T1.14.14.4.m1.1.1.cmml" type="integer" xref="A1.T1.14.14.4.m1.1.1">12</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T1.14.14.4.m1.1c">12</annotation><annotation encoding="application/x-llamapun" id="A1.T1.14.14.4.m1.1d">12</annotation></semantics></math></td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" id="A1.T1.15.15.5"><math alttext="12" class="ltx_Math" display="inline" id="A1.T1.15.15.5.m1.1"><semantics id="A1.T1.15.15.5.m1.1a"><mn id="A1.T1.15.15.5.m1.1.1" xref="A1.T1.15.15.5.m1.1.1.cmml">12</mn><annotation-xml encoding="MathML-Content" id="A1.T1.15.15.5.m1.1b"><cn id="A1.T1.15.15.5.m1.1.1.cmml" type="integer" xref="A1.T1.15.15.5.m1.1.1">12</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T1.15.15.5.m1.1c">12</annotation><annotation encoding="application/x-llamapun" id="A1.T1.15.15.5.m1.1d">12</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A1.T1.20.20">
<td class="ltx_td ltx_align_left" id="A1.T1.16.16.1">
<math alttext="64" class="ltx_Math" display="inline" id="A1.T1.16.16.1.m1.1"><semantics id="A1.T1.16.16.1.m1.1a"><mn id="A1.T1.16.16.1.m1.1.1" xref="A1.T1.16.16.1.m1.1.1.cmml">64</mn><annotation-xml encoding="MathML-Content" id="A1.T1.16.16.1.m1.1b"><cn id="A1.T1.16.16.1.m1.1.1.cmml" type="integer" xref="A1.T1.16.16.1.m1.1.1">64</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T1.16.16.1.m1.1c">64</annotation><annotation encoding="application/x-llamapun" id="A1.T1.16.16.1.m1.1d">64</annotation></semantics></math>M</td>
<td class="ltx_td ltx_align_center" id="A1.T1.20.20.6">router</td>
<td class="ltx_td ltx_align_center" id="A1.T1.17.17.2"><math alttext="416" class="ltx_Math" display="inline" id="A1.T1.17.17.2.m1.1"><semantics id="A1.T1.17.17.2.m1.1a"><mn id="A1.T1.17.17.2.m1.1.1" xref="A1.T1.17.17.2.m1.1.1.cmml">416</mn><annotation-xml encoding="MathML-Content" id="A1.T1.17.17.2.m1.1b"><cn id="A1.T1.17.17.2.m1.1.1.cmml" type="integer" xref="A1.T1.17.17.2.m1.1.1">416</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T1.17.17.2.m1.1c">416</annotation><annotation encoding="application/x-llamapun" id="A1.T1.17.17.2.m1.1d">416</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="A1.T1.18.18.3"><math alttext="4" class="ltx_Math" display="inline" id="A1.T1.18.18.3.m1.1"><semantics id="A1.T1.18.18.3.m1.1a"><mn id="A1.T1.18.18.3.m1.1.1" xref="A1.T1.18.18.3.m1.1.1.cmml">4</mn><annotation-xml encoding="MathML-Content" id="A1.T1.18.18.3.m1.1b"><cn id="A1.T1.18.18.3.m1.1.1.cmml" type="integer" xref="A1.T1.18.18.3.m1.1.1">4</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T1.18.18.3.m1.1c">4</annotation><annotation encoding="application/x-llamapun" id="A1.T1.18.18.3.m1.1d">4</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="A1.T1.19.19.4"><math alttext="12" class="ltx_Math" display="inline" id="A1.T1.19.19.4.m1.1"><semantics id="A1.T1.19.19.4.m1.1a"><mn id="A1.T1.19.19.4.m1.1.1" xref="A1.T1.19.19.4.m1.1.1.cmml">12</mn><annotation-xml encoding="MathML-Content" id="A1.T1.19.19.4.m1.1b"><cn id="A1.T1.19.19.4.m1.1.1.cmml" type="integer" xref="A1.T1.19.19.4.m1.1.1">12</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T1.19.19.4.m1.1c">12</annotation><annotation encoding="application/x-llamapun" id="A1.T1.19.19.4.m1.1d">12</annotation></semantics></math></td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A1.T1.20.20.5"><math alttext="12" class="ltx_Math" display="inline" id="A1.T1.20.20.5.m1.1"><semantics id="A1.T1.20.20.5.m1.1a"><mn id="A1.T1.20.20.5.m1.1.1" xref="A1.T1.20.20.5.m1.1.1.cmml">12</mn><annotation-xml encoding="MathML-Content" id="A1.T1.20.20.5.m1.1b"><cn id="A1.T1.20.20.5.m1.1.1.cmml" type="integer" xref="A1.T1.20.20.5.m1.1.1">12</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T1.20.20.5.m1.1c">12</annotation><annotation encoding="application/x-llamapun" id="A1.T1.20.20.5.m1.1d">12</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A1.T1.25.25">
<td class="ltx_td ltx_align_left ltx_border_bb ltx_border_b" id="A1.T1.21.21.1">
<math alttext="110" class="ltx_Math" display="inline" id="A1.T1.21.21.1.m1.1"><semantics id="A1.T1.21.21.1.m1.1a"><mn id="A1.T1.21.21.1.m1.1.1" xref="A1.T1.21.21.1.m1.1.1.cmml">110</mn><annotation-xml encoding="MathML-Content" id="A1.T1.21.21.1.m1.1b"><cn id="A1.T1.21.21.1.m1.1.1.cmml" type="integer" xref="A1.T1.21.21.1.m1.1.1">110</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T1.21.21.1.m1.1c">110</annotation><annotation encoding="application/x-llamapun" id="A1.T1.21.21.1.m1.1d">110</annotation></semantics></math>M</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_b" id="A1.T1.25.25.6">router</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_b" id="A1.T1.22.22.2"><math alttext="768" class="ltx_Math" display="inline" id="A1.T1.22.22.2.m1.1"><semantics id="A1.T1.22.22.2.m1.1a"><mn id="A1.T1.22.22.2.m1.1.1" xref="A1.T1.22.22.2.m1.1.1.cmml">768</mn><annotation-xml encoding="MathML-Content" id="A1.T1.22.22.2.m1.1b"><cn id="A1.T1.22.22.2.m1.1.1.cmml" type="integer" xref="A1.T1.22.22.2.m1.1.1">768</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T1.22.22.2.m1.1c">768</annotation><annotation encoding="application/x-llamapun" id="A1.T1.22.22.2.m1.1d">768</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_b" id="A1.T1.23.23.3"><math alttext="4" class="ltx_Math" display="inline" id="A1.T1.23.23.3.m1.1"><semantics id="A1.T1.23.23.3.m1.1a"><mn id="A1.T1.23.23.3.m1.1.1" xref="A1.T1.23.23.3.m1.1.1.cmml">4</mn><annotation-xml encoding="MathML-Content" id="A1.T1.23.23.3.m1.1b"><cn id="A1.T1.23.23.3.m1.1.1.cmml" type="integer" xref="A1.T1.23.23.3.m1.1.1">4</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T1.23.23.3.m1.1c">4</annotation><annotation encoding="application/x-llamapun" id="A1.T1.23.23.3.m1.1d">4</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_b" id="A1.T1.24.24.4"><math alttext="12" class="ltx_Math" display="inline" id="A1.T1.24.24.4.m1.1"><semantics id="A1.T1.24.24.4.m1.1a"><mn id="A1.T1.24.24.4.m1.1.1" xref="A1.T1.24.24.4.m1.1.1.cmml">12</mn><annotation-xml encoding="MathML-Content" id="A1.T1.24.24.4.m1.1b"><cn id="A1.T1.24.24.4.m1.1.1.cmml" type="integer" xref="A1.T1.24.24.4.m1.1.1">12</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T1.24.24.4.m1.1c">12</annotation><annotation encoding="application/x-llamapun" id="A1.T1.24.24.4.m1.1d">12</annotation></semantics></math></td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_bb ltx_border_b" id="A1.T1.25.25.5"><math alttext="12" class="ltx_Math" display="inline" id="A1.T1.25.25.5.m1.1"><semantics id="A1.T1.25.25.5.m1.1a"><mn id="A1.T1.25.25.5.m1.1.1" xref="A1.T1.25.25.5.m1.1.1.cmml">12</mn><annotation-xml encoding="MathML-Content" id="A1.T1.25.25.5.m1.1b"><cn id="A1.T1.25.25.5.m1.1.1.cmml" type="integer" xref="A1.T1.25.25.5.m1.1.1">12</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T1.25.25.5.m1.1c">12</annotation><annotation encoding="application/x-llamapun" id="A1.T1.25.25.5.m1.1d">12</annotation></semantics></math></td>
</tr>
</tbody></table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1: </span><span class="ltx_text ltx_font_bold" id="A1.T1.27.1">Model parameters.</span> </figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_table" id="A1.T2">
<table class="ltx_tabular ltx_centering ltx_align_middle" id="A1.T2.71">
<tbody><tr class="ltx_tr" id="A1.T2.71.72">
<td class="ltx_td ltx_align_left ltx_border_tt" id="A1.T2.71.72.1"><span class="ltx_text ltx_font_bold" id="A1.T2.71.72.1.1">Model</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A1.T2.71.72.2"><span class="ltx_text ltx_font_bold" id="A1.T2.71.72.2.1">Steps (k)</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A1.T2.71.72.3"><span class="ltx_text ltx_font_bold" id="A1.T2.71.72.3.1">Tokens (B)</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A1.T2.71.72.4"><span class="ltx_text ltx_font_bold" id="A1.T2.71.72.4.1">Batch size</span></td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_tt" id="A1.T2.71.72.5"><span class="ltx_text ltx_font_bold" id="A1.T2.71.72.5.1"># GPUs</span></td>
</tr>
<tr class="ltx_tr" id="A1.T2.5.5">
<td class="ltx_td ltx_align_left ltx_border_t" id="A1.T2.1.1.1">
<math alttext="335" class="ltx_Math" display="inline" id="A1.T2.1.1.1.m1.1"><semantics id="A1.T2.1.1.1.m1.1a"><mn id="A1.T2.1.1.1.m1.1.1" xref="A1.T2.1.1.1.m1.1.1.cmml">335</mn><annotation-xml encoding="MathML-Content" id="A1.T2.1.1.1.m1.1b"><cn id="A1.T2.1.1.1.m1.1.1.cmml" type="integer" xref="A1.T2.1.1.1.m1.1.1">335</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T2.1.1.1.m1.1c">335</annotation><annotation encoding="application/x-llamapun" id="A1.T2.1.1.1.m1.1d">335</annotation></semantics></math>M (dense)</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T2.2.2.2"><math alttext="256" class="ltx_Math" display="inline" id="A1.T2.2.2.2.m1.1"><semantics id="A1.T2.2.2.2.m1.1a"><mn id="A1.T2.2.2.2.m1.1.1" xref="A1.T2.2.2.2.m1.1.1.cmml">256</mn><annotation-xml encoding="MathML-Content" id="A1.T2.2.2.2.m1.1b"><cn id="A1.T2.2.2.2.m1.1.1.cmml" type="integer" xref="A1.T2.2.2.2.m1.1.1">256</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T2.2.2.2.m1.1c">256</annotation><annotation encoding="application/x-llamapun" id="A1.T2.2.2.2.m1.1d">256</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T2.3.3.3"><math alttext="133" class="ltx_Math" display="inline" id="A1.T2.3.3.3.m1.1"><semantics id="A1.T2.3.3.3.m1.1a"><mn id="A1.T2.3.3.3.m1.1.1" xref="A1.T2.3.3.3.m1.1.1.cmml">133</mn><annotation-xml encoding="MathML-Content" id="A1.T2.3.3.3.m1.1b"><cn id="A1.T2.3.3.3.m1.1.1.cmml" type="integer" xref="A1.T2.3.3.3.m1.1.1">133</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T2.3.3.3.m1.1c">133</annotation><annotation encoding="application/x-llamapun" id="A1.T2.3.3.3.m1.1d">133</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T2.4.4.4"><math alttext="512" class="ltx_Math" display="inline" id="A1.T2.4.4.4.m1.1"><semantics id="A1.T2.4.4.4.m1.1a"><mn id="A1.T2.4.4.4.m1.1.1" xref="A1.T2.4.4.4.m1.1.1.cmml">512</mn><annotation-xml encoding="MathML-Content" id="A1.T2.4.4.4.m1.1b"><cn id="A1.T2.4.4.4.m1.1.1.cmml" type="integer" xref="A1.T2.4.4.4.m1.1.1">512</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T2.4.4.4.m1.1c">512</annotation><annotation encoding="application/x-llamapun" id="A1.T2.4.4.4.m1.1d">512</annotation></semantics></math></td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" id="A1.T2.5.5.5"><math alttext="8" class="ltx_Math" display="inline" id="A1.T2.5.5.5.m1.1"><semantics id="A1.T2.5.5.5.m1.1a"><mn id="A1.T2.5.5.5.m1.1.1" xref="A1.T2.5.5.5.m1.1.1.cmml">8</mn><annotation-xml encoding="MathML-Content" id="A1.T2.5.5.5.m1.1b"><cn id="A1.T2.5.5.5.m1.1.1.cmml" type="integer" xref="A1.T2.5.5.5.m1.1.1">8</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T2.5.5.5.m1.1c">8</annotation><annotation encoding="application/x-llamapun" id="A1.T2.5.5.5.m1.1d">8</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A1.T2.11.11">
<td class="ltx_td ltx_align_left" id="A1.T2.7.7.2">
<math alttext="335" class="ltx_Math" display="inline" id="A1.T2.6.6.1.m1.1"><semantics id="A1.T2.6.6.1.m1.1a"><mn id="A1.T2.6.6.1.m1.1.1" xref="A1.T2.6.6.1.m1.1.1.cmml">335</mn><annotation-xml encoding="MathML-Content" id="A1.T2.6.6.1.m1.1b"><cn id="A1.T2.6.6.1.m1.1.1.cmml" type="integer" xref="A1.T2.6.6.1.m1.1.1">335</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T2.6.6.1.m1.1c">335</annotation><annotation encoding="application/x-llamapun" id="A1.T2.6.6.1.m1.1d">335</annotation></semantics></math>M (<math alttext="4" class="ltx_Math" display="inline" id="A1.T2.7.7.2.m2.1"><semantics id="A1.T2.7.7.2.m2.1a"><mn id="A1.T2.7.7.2.m2.1.1" xref="A1.T2.7.7.2.m2.1.1.cmml">4</mn><annotation-xml encoding="MathML-Content" id="A1.T2.7.7.2.m2.1b"><cn id="A1.T2.7.7.2.m2.1.1.cmml" type="integer" xref="A1.T2.7.7.2.m2.1.1">4</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T2.7.7.2.m2.1c">4</annotation><annotation encoding="application/x-llamapun" id="A1.T2.7.7.2.m2.1d">4</annotation></semantics></math> experts)</td>
<td class="ltx_td ltx_align_center" id="A1.T2.8.8.3"><math alttext="256" class="ltx_Math" display="inline" id="A1.T2.8.8.3.m1.1"><semantics id="A1.T2.8.8.3.m1.1a"><mn id="A1.T2.8.8.3.m1.1.1" xref="A1.T2.8.8.3.m1.1.1.cmml">256</mn><annotation-xml encoding="MathML-Content" id="A1.T2.8.8.3.m1.1b"><cn id="A1.T2.8.8.3.m1.1.1.cmml" type="integer" xref="A1.T2.8.8.3.m1.1.1">256</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T2.8.8.3.m1.1c">256</annotation><annotation encoding="application/x-llamapun" id="A1.T2.8.8.3.m1.1d">256</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="A1.T2.9.9.4"><math alttext="133" class="ltx_Math" display="inline" id="A1.T2.9.9.4.m1.1"><semantics id="A1.T2.9.9.4.m1.1a"><mn id="A1.T2.9.9.4.m1.1.1" xref="A1.T2.9.9.4.m1.1.1.cmml">133</mn><annotation-xml encoding="MathML-Content" id="A1.T2.9.9.4.m1.1b"><cn id="A1.T2.9.9.4.m1.1.1.cmml" type="integer" xref="A1.T2.9.9.4.m1.1.1">133</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T2.9.9.4.m1.1c">133</annotation><annotation encoding="application/x-llamapun" id="A1.T2.9.9.4.m1.1d">133</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="A1.T2.10.10.5"><math alttext="128" class="ltx_Math" display="inline" id="A1.T2.10.10.5.m1.1"><semantics id="A1.T2.10.10.5.m1.1a"><mn id="A1.T2.10.10.5.m1.1.1" xref="A1.T2.10.10.5.m1.1.1.cmml">128</mn><annotation-xml encoding="MathML-Content" id="A1.T2.10.10.5.m1.1b"><cn id="A1.T2.10.10.5.m1.1.1.cmml" type="integer" xref="A1.T2.10.10.5.m1.1.1">128</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T2.10.10.5.m1.1c">128</annotation><annotation encoding="application/x-llamapun" id="A1.T2.10.10.5.m1.1d">128</annotation></semantics></math></td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A1.T2.11.11.6"><math alttext="8" class="ltx_Math" display="inline" id="A1.T2.11.11.6.m1.1"><semantics id="A1.T2.11.11.6.m1.1a"><mn id="A1.T2.11.11.6.m1.1.1" xref="A1.T2.11.11.6.m1.1.1.cmml">8</mn><annotation-xml encoding="MathML-Content" id="A1.T2.11.11.6.m1.1b"><cn id="A1.T2.11.11.6.m1.1.1.cmml" type="integer" xref="A1.T2.11.11.6.m1.1.1">8</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T2.11.11.6.m1.1c">8</annotation><annotation encoding="application/x-llamapun" id="A1.T2.11.11.6.m1.1d">8</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A1.T2.16.16">
<td class="ltx_td ltx_align_left ltx_border_t" id="A1.T2.12.12.1">
<math alttext="335" class="ltx_Math" display="inline" id="A1.T2.12.12.1.m1.1"><semantics id="A1.T2.12.12.1.m1.1a"><mn id="A1.T2.12.12.1.m1.1.1" xref="A1.T2.12.12.1.m1.1.1.cmml">335</mn><annotation-xml encoding="MathML-Content" id="A1.T2.12.12.1.m1.1b"><cn id="A1.T2.12.12.1.m1.1.1.cmml" type="integer" xref="A1.T2.12.12.1.m1.1.1">335</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T2.12.12.1.m1.1c">335</annotation><annotation encoding="application/x-llamapun" id="A1.T2.12.12.1.m1.1d">335</annotation></semantics></math>M (dense)</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T2.13.13.2"><math alttext="512" class="ltx_Math" display="inline" id="A1.T2.13.13.2.m1.1"><semantics id="A1.T2.13.13.2.m1.1a"><mn id="A1.T2.13.13.2.m1.1.1" xref="A1.T2.13.13.2.m1.1.1.cmml">512</mn><annotation-xml encoding="MathML-Content" id="A1.T2.13.13.2.m1.1b"><cn id="A1.T2.13.13.2.m1.1.1.cmml" type="integer" xref="A1.T2.13.13.2.m1.1.1">512</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T2.13.13.2.m1.1c">512</annotation><annotation encoding="application/x-llamapun" id="A1.T2.13.13.2.m1.1d">512</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T2.14.14.3"><math alttext="266" class="ltx_Math" display="inline" id="A1.T2.14.14.3.m1.1"><semantics id="A1.T2.14.14.3.m1.1a"><mn id="A1.T2.14.14.3.m1.1.1" xref="A1.T2.14.14.3.m1.1.1.cmml">266</mn><annotation-xml encoding="MathML-Content" id="A1.T2.14.14.3.m1.1b"><cn id="A1.T2.14.14.3.m1.1.1.cmml" type="integer" xref="A1.T2.14.14.3.m1.1.1">266</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T2.14.14.3.m1.1c">266</annotation><annotation encoding="application/x-llamapun" id="A1.T2.14.14.3.m1.1d">266</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T2.15.15.4"><math alttext="512" class="ltx_Math" display="inline" id="A1.T2.15.15.4.m1.1"><semantics id="A1.T2.15.15.4.m1.1a"><mn id="A1.T2.15.15.4.m1.1.1" xref="A1.T2.15.15.4.m1.1.1.cmml">512</mn><annotation-xml encoding="MathML-Content" id="A1.T2.15.15.4.m1.1b"><cn id="A1.T2.15.15.4.m1.1.1.cmml" type="integer" xref="A1.T2.15.15.4.m1.1.1">512</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T2.15.15.4.m1.1c">512</annotation><annotation encoding="application/x-llamapun" id="A1.T2.15.15.4.m1.1d">512</annotation></semantics></math></td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" id="A1.T2.16.16.5"><math alttext="32" class="ltx_Math" display="inline" id="A1.T2.16.16.5.m1.1"><semantics id="A1.T2.16.16.5.m1.1a"><mn id="A1.T2.16.16.5.m1.1.1" xref="A1.T2.16.16.5.m1.1.1.cmml">32</mn><annotation-xml encoding="MathML-Content" id="A1.T2.16.16.5.m1.1b"><cn id="A1.T2.16.16.5.m1.1.1.cmml" type="integer" xref="A1.T2.16.16.5.m1.1.1">32</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T2.16.16.5.m1.1c">32</annotation><annotation encoding="application/x-llamapun" id="A1.T2.16.16.5.m1.1d">32</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A1.T2.22.22">
<td class="ltx_td ltx_align_left" id="A1.T2.18.18.2">
<math alttext="335" class="ltx_Math" display="inline" id="A1.T2.17.17.1.m1.1"><semantics id="A1.T2.17.17.1.m1.1a"><mn id="A1.T2.17.17.1.m1.1.1" xref="A1.T2.17.17.1.m1.1.1.cmml">335</mn><annotation-xml encoding="MathML-Content" id="A1.T2.17.17.1.m1.1b"><cn id="A1.T2.17.17.1.m1.1.1.cmml" type="integer" xref="A1.T2.17.17.1.m1.1.1">335</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T2.17.17.1.m1.1c">335</annotation><annotation encoding="application/x-llamapun" id="A1.T2.17.17.1.m1.1d">335</annotation></semantics></math>M (<math alttext="8" class="ltx_Math" display="inline" id="A1.T2.18.18.2.m2.1"><semantics id="A1.T2.18.18.2.m2.1a"><mn id="A1.T2.18.18.2.m2.1.1" xref="A1.T2.18.18.2.m2.1.1.cmml">8</mn><annotation-xml encoding="MathML-Content" id="A1.T2.18.18.2.m2.1b"><cn id="A1.T2.18.18.2.m2.1.1.cmml" type="integer" xref="A1.T2.18.18.2.m2.1.1">8</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T2.18.18.2.m2.1c">8</annotation><annotation encoding="application/x-llamapun" id="A1.T2.18.18.2.m2.1d">8</annotation></semantics></math> experts)</td>
<td class="ltx_td ltx_align_center" id="A1.T2.19.19.3"><math alttext="256" class="ltx_Math" display="inline" id="A1.T2.19.19.3.m1.1"><semantics id="A1.T2.19.19.3.m1.1a"><mn id="A1.T2.19.19.3.m1.1.1" xref="A1.T2.19.19.3.m1.1.1.cmml">256</mn><annotation-xml encoding="MathML-Content" id="A1.T2.19.19.3.m1.1b"><cn id="A1.T2.19.19.3.m1.1.1.cmml" type="integer" xref="A1.T2.19.19.3.m1.1.1">256</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T2.19.19.3.m1.1c">256</annotation><annotation encoding="application/x-llamapun" id="A1.T2.19.19.3.m1.1d">256</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="A1.T2.20.20.4"><math alttext="266" class="ltx_Math" display="inline" id="A1.T2.20.20.4.m1.1"><semantics id="A1.T2.20.20.4.m1.1a"><mn id="A1.T2.20.20.4.m1.1.1" xref="A1.T2.20.20.4.m1.1.1.cmml">266</mn><annotation-xml encoding="MathML-Content" id="A1.T2.20.20.4.m1.1b"><cn id="A1.T2.20.20.4.m1.1.1.cmml" type="integer" xref="A1.T2.20.20.4.m1.1.1">266</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T2.20.20.4.m1.1c">266</annotation><annotation encoding="application/x-llamapun" id="A1.T2.20.20.4.m1.1d">266</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="A1.T2.21.21.5"><math alttext="128" class="ltx_Math" display="inline" id="A1.T2.21.21.5.m1.1"><semantics id="A1.T2.21.21.5.m1.1a"><mn id="A1.T2.21.21.5.m1.1.1" xref="A1.T2.21.21.5.m1.1.1.cmml">128</mn><annotation-xml encoding="MathML-Content" id="A1.T2.21.21.5.m1.1b"><cn id="A1.T2.21.21.5.m1.1.1.cmml" type="integer" xref="A1.T2.21.21.5.m1.1.1">128</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T2.21.21.5.m1.1c">128</annotation><annotation encoding="application/x-llamapun" id="A1.T2.21.21.5.m1.1d">128</annotation></semantics></math></td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A1.T2.22.22.6"><math alttext="8" class="ltx_Math" display="inline" id="A1.T2.22.22.6.m1.1"><semantics id="A1.T2.22.22.6.m1.1a"><mn id="A1.T2.22.22.6.m1.1.1" xref="A1.T2.22.22.6.m1.1.1.cmml">8</mn><annotation-xml encoding="MathML-Content" id="A1.T2.22.22.6.m1.1b"><cn id="A1.T2.22.22.6.m1.1.1.cmml" type="integer" xref="A1.T2.22.22.6.m1.1.1">8</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T2.22.22.6.m1.1c">8</annotation><annotation encoding="application/x-llamapun" id="A1.T2.22.22.6.m1.1d">8</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A1.T2.27.27">
<td class="ltx_td ltx_align_left ltx_border_t" id="A1.T2.23.23.1">
<math alttext="335" class="ltx_Math" display="inline" id="A1.T2.23.23.1.m1.1"><semantics id="A1.T2.23.23.1.m1.1a"><mn id="A1.T2.23.23.1.m1.1.1" xref="A1.T2.23.23.1.m1.1.1.cmml">335</mn><annotation-xml encoding="MathML-Content" id="A1.T2.23.23.1.m1.1b"><cn id="A1.T2.23.23.1.m1.1.1.cmml" type="integer" xref="A1.T2.23.23.1.m1.1.1">335</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T2.23.23.1.m1.1c">335</annotation><annotation encoding="application/x-llamapun" id="A1.T2.23.23.1.m1.1d">335</annotation></semantics></math>M (dense)</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T2.24.24.2"><math alttext="1024" class="ltx_Math" display="inline" id="A1.T2.24.24.2.m1.1"><semantics id="A1.T2.24.24.2.m1.1a"><mn id="A1.T2.24.24.2.m1.1.1" xref="A1.T2.24.24.2.m1.1.1.cmml">1024</mn><annotation-xml encoding="MathML-Content" id="A1.T2.24.24.2.m1.1b"><cn id="A1.T2.24.24.2.m1.1.1.cmml" type="integer" xref="A1.T2.24.24.2.m1.1.1">1024</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T2.24.24.2.m1.1c">1024</annotation><annotation encoding="application/x-llamapun" id="A1.T2.24.24.2.m1.1d">1024</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T2.25.25.3"><math alttext="532" class="ltx_Math" display="inline" id="A1.T2.25.25.3.m1.1"><semantics id="A1.T2.25.25.3.m1.1a"><mn id="A1.T2.25.25.3.m1.1.1" xref="A1.T2.25.25.3.m1.1.1.cmml">532</mn><annotation-xml encoding="MathML-Content" id="A1.T2.25.25.3.m1.1b"><cn id="A1.T2.25.25.3.m1.1.1.cmml" type="integer" xref="A1.T2.25.25.3.m1.1.1">532</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T2.25.25.3.m1.1c">532</annotation><annotation encoding="application/x-llamapun" id="A1.T2.25.25.3.m1.1d">532</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T2.26.26.4"><math alttext="512" class="ltx_Math" display="inline" id="A1.T2.26.26.4.m1.1"><semantics id="A1.T2.26.26.4.m1.1a"><mn id="A1.T2.26.26.4.m1.1.1" xref="A1.T2.26.26.4.m1.1.1.cmml">512</mn><annotation-xml encoding="MathML-Content" id="A1.T2.26.26.4.m1.1b"><cn id="A1.T2.26.26.4.m1.1.1.cmml" type="integer" xref="A1.T2.26.26.4.m1.1.1">512</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T2.26.26.4.m1.1c">512</annotation><annotation encoding="application/x-llamapun" id="A1.T2.26.26.4.m1.1d">512</annotation></semantics></math></td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" id="A1.T2.27.27.5"><math alttext="32" class="ltx_Math" display="inline" id="A1.T2.27.27.5.m1.1"><semantics id="A1.T2.27.27.5.m1.1a"><mn id="A1.T2.27.27.5.m1.1.1" xref="A1.T2.27.27.5.m1.1.1.cmml">32</mn><annotation-xml encoding="MathML-Content" id="A1.T2.27.27.5.m1.1b"><cn id="A1.T2.27.27.5.m1.1.1.cmml" type="integer" xref="A1.T2.27.27.5.m1.1.1">32</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T2.27.27.5.m1.1c">32</annotation><annotation encoding="application/x-llamapun" id="A1.T2.27.27.5.m1.1d">32</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A1.T2.33.33">
<td class="ltx_td ltx_align_left" id="A1.T2.29.29.2">
<math alttext="335" class="ltx_Math" display="inline" id="A1.T2.28.28.1.m1.1"><semantics id="A1.T2.28.28.1.m1.1a"><mn id="A1.T2.28.28.1.m1.1.1" xref="A1.T2.28.28.1.m1.1.1.cmml">335</mn><annotation-xml encoding="MathML-Content" id="A1.T2.28.28.1.m1.1b"><cn id="A1.T2.28.28.1.m1.1.1.cmml" type="integer" xref="A1.T2.28.28.1.m1.1.1">335</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T2.28.28.1.m1.1c">335</annotation><annotation encoding="application/x-llamapun" id="A1.T2.28.28.1.m1.1d">335</annotation></semantics></math>M (<math alttext="16" class="ltx_Math" display="inline" id="A1.T2.29.29.2.m2.1"><semantics id="A1.T2.29.29.2.m2.1a"><mn id="A1.T2.29.29.2.m2.1.1" xref="A1.T2.29.29.2.m2.1.1.cmml">16</mn><annotation-xml encoding="MathML-Content" id="A1.T2.29.29.2.m2.1b"><cn id="A1.T2.29.29.2.m2.1.1.cmml" type="integer" xref="A1.T2.29.29.2.m2.1.1">16</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T2.29.29.2.m2.1c">16</annotation><annotation encoding="application/x-llamapun" id="A1.T2.29.29.2.m2.1d">16</annotation></semantics></math> experts)</td>
<td class="ltx_td ltx_align_center" id="A1.T2.30.30.3"><math alttext="256" class="ltx_Math" display="inline" id="A1.T2.30.30.3.m1.1"><semantics id="A1.T2.30.30.3.m1.1a"><mn id="A1.T2.30.30.3.m1.1.1" xref="A1.T2.30.30.3.m1.1.1.cmml">256</mn><annotation-xml encoding="MathML-Content" id="A1.T2.30.30.3.m1.1b"><cn id="A1.T2.30.30.3.m1.1.1.cmml" type="integer" xref="A1.T2.30.30.3.m1.1.1">256</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T2.30.30.3.m1.1c">256</annotation><annotation encoding="application/x-llamapun" id="A1.T2.30.30.3.m1.1d">256</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="A1.T2.31.31.4"><math alttext="532" class="ltx_Math" display="inline" id="A1.T2.31.31.4.m1.1"><semantics id="A1.T2.31.31.4.m1.1a"><mn id="A1.T2.31.31.4.m1.1.1" xref="A1.T2.31.31.4.m1.1.1.cmml">532</mn><annotation-xml encoding="MathML-Content" id="A1.T2.31.31.4.m1.1b"><cn id="A1.T2.31.31.4.m1.1.1.cmml" type="integer" xref="A1.T2.31.31.4.m1.1.1">532</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T2.31.31.4.m1.1c">532</annotation><annotation encoding="application/x-llamapun" id="A1.T2.31.31.4.m1.1d">532</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="A1.T2.32.32.5"><math alttext="128" class="ltx_Math" display="inline" id="A1.T2.32.32.5.m1.1"><semantics id="A1.T2.32.32.5.m1.1a"><mn id="A1.T2.32.32.5.m1.1.1" xref="A1.T2.32.32.5.m1.1.1.cmml">128</mn><annotation-xml encoding="MathML-Content" id="A1.T2.32.32.5.m1.1b"><cn id="A1.T2.32.32.5.m1.1.1.cmml" type="integer" xref="A1.T2.32.32.5.m1.1.1">128</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T2.32.32.5.m1.1c">128</annotation><annotation encoding="application/x-llamapun" id="A1.T2.32.32.5.m1.1d">128</annotation></semantics></math></td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A1.T2.33.33.6"><math alttext="8" class="ltx_Math" display="inline" id="A1.T2.33.33.6.m1.1"><semantics id="A1.T2.33.33.6.m1.1a"><mn id="A1.T2.33.33.6.m1.1.1" xref="A1.T2.33.33.6.m1.1.1.cmml">8</mn><annotation-xml encoding="MathML-Content" id="A1.T2.33.33.6.m1.1b"><cn id="A1.T2.33.33.6.m1.1.1.cmml" type="integer" xref="A1.T2.33.33.6.m1.1.1">8</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T2.33.33.6.m1.1c">8</annotation><annotation encoding="application/x-llamapun" id="A1.T2.33.33.6.m1.1d">8</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A1.T2.38.38">
<td class="ltx_td ltx_align_left ltx_border_t" id="A1.T2.34.34.1">
<math alttext="1.3" class="ltx_Math" display="inline" id="A1.T2.34.34.1.m1.1"><semantics id="A1.T2.34.34.1.m1.1a"><mn id="A1.T2.34.34.1.m1.1.1" xref="A1.T2.34.34.1.m1.1.1.cmml">1.3</mn><annotation-xml encoding="MathML-Content" id="A1.T2.34.34.1.m1.1b"><cn id="A1.T2.34.34.1.m1.1.1.cmml" type="float" xref="A1.T2.34.34.1.m1.1.1">1.3</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T2.34.34.1.m1.1c">1.3</annotation><annotation encoding="application/x-llamapun" id="A1.T2.34.34.1.m1.1d">1.3</annotation></semantics></math>B (dense)</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T2.35.35.2"><math alttext="512" class="ltx_Math" display="inline" id="A1.T2.35.35.2.m1.1"><semantics id="A1.T2.35.35.2.m1.1a"><mn id="A1.T2.35.35.2.m1.1.1" xref="A1.T2.35.35.2.m1.1.1.cmml">512</mn><annotation-xml encoding="MathML-Content" id="A1.T2.35.35.2.m1.1b"><cn id="A1.T2.35.35.2.m1.1.1.cmml" type="integer" xref="A1.T2.35.35.2.m1.1.1">512</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T2.35.35.2.m1.1c">512</annotation><annotation encoding="application/x-llamapun" id="A1.T2.35.35.2.m1.1d">512</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T2.36.36.3"><math alttext="266" class="ltx_Math" display="inline" id="A1.T2.36.36.3.m1.1"><semantics id="A1.T2.36.36.3.m1.1a"><mn id="A1.T2.36.36.3.m1.1.1" xref="A1.T2.36.36.3.m1.1.1.cmml">266</mn><annotation-xml encoding="MathML-Content" id="A1.T2.36.36.3.m1.1b"><cn id="A1.T2.36.36.3.m1.1.1.cmml" type="integer" xref="A1.T2.36.36.3.m1.1.1">266</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T2.36.36.3.m1.1c">266</annotation><annotation encoding="application/x-llamapun" id="A1.T2.36.36.3.m1.1d">266</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T2.37.37.4"><math alttext="512" class="ltx_Math" display="inline" id="A1.T2.37.37.4.m1.1"><semantics id="A1.T2.37.37.4.m1.1a"><mn id="A1.T2.37.37.4.m1.1.1" xref="A1.T2.37.37.4.m1.1.1.cmml">512</mn><annotation-xml encoding="MathML-Content" id="A1.T2.37.37.4.m1.1b"><cn id="A1.T2.37.37.4.m1.1.1.cmml" type="integer" xref="A1.T2.37.37.4.m1.1.1">512</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T2.37.37.4.m1.1c">512</annotation><annotation encoding="application/x-llamapun" id="A1.T2.37.37.4.m1.1d">512</annotation></semantics></math></td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" id="A1.T2.38.38.5"><math alttext="32" class="ltx_Math" display="inline" id="A1.T2.38.38.5.m1.1"><semantics id="A1.T2.38.38.5.m1.1a"><mn id="A1.T2.38.38.5.m1.1.1" xref="A1.T2.38.38.5.m1.1.1.cmml">32</mn><annotation-xml encoding="MathML-Content" id="A1.T2.38.38.5.m1.1b"><cn id="A1.T2.38.38.5.m1.1.1.cmml" type="integer" xref="A1.T2.38.38.5.m1.1.1">32</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T2.38.38.5.m1.1c">32</annotation><annotation encoding="application/x-llamapun" id="A1.T2.38.38.5.m1.1d">32</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A1.T2.44.44">
<td class="ltx_td ltx_align_left" id="A1.T2.40.40.2">
<math alttext="1.3" class="ltx_Math" display="inline" id="A1.T2.39.39.1.m1.1"><semantics id="A1.T2.39.39.1.m1.1a"><mn id="A1.T2.39.39.1.m1.1.1" xref="A1.T2.39.39.1.m1.1.1.cmml">1.3</mn><annotation-xml encoding="MathML-Content" id="A1.T2.39.39.1.m1.1b"><cn id="A1.T2.39.39.1.m1.1.1.cmml" type="float" xref="A1.T2.39.39.1.m1.1.1">1.3</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T2.39.39.1.m1.1c">1.3</annotation><annotation encoding="application/x-llamapun" id="A1.T2.39.39.1.m1.1d">1.3</annotation></semantics></math>B (<math alttext="4" class="ltx_Math" display="inline" id="A1.T2.40.40.2.m2.1"><semantics id="A1.T2.40.40.2.m2.1a"><mn id="A1.T2.40.40.2.m2.1.1" xref="A1.T2.40.40.2.m2.1.1.cmml">4</mn><annotation-xml encoding="MathML-Content" id="A1.T2.40.40.2.m2.1b"><cn id="A1.T2.40.40.2.m2.1.1.cmml" type="integer" xref="A1.T2.40.40.2.m2.1.1">4</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T2.40.40.2.m2.1c">4</annotation><annotation encoding="application/x-llamapun" id="A1.T2.40.40.2.m2.1d">4</annotation></semantics></math> experts)</td>
<td class="ltx_td ltx_align_center" id="A1.T2.41.41.3"><math alttext="512" class="ltx_Math" display="inline" id="A1.T2.41.41.3.m1.1"><semantics id="A1.T2.41.41.3.m1.1a"><mn id="A1.T2.41.41.3.m1.1.1" xref="A1.T2.41.41.3.m1.1.1.cmml">512</mn><annotation-xml encoding="MathML-Content" id="A1.T2.41.41.3.m1.1b"><cn id="A1.T2.41.41.3.m1.1.1.cmml" type="integer" xref="A1.T2.41.41.3.m1.1.1">512</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T2.41.41.3.m1.1c">512</annotation><annotation encoding="application/x-llamapun" id="A1.T2.41.41.3.m1.1d">512</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="A1.T2.42.42.4"><math alttext="266" class="ltx_Math" display="inline" id="A1.T2.42.42.4.m1.1"><semantics id="A1.T2.42.42.4.m1.1a"><mn id="A1.T2.42.42.4.m1.1.1" xref="A1.T2.42.42.4.m1.1.1.cmml">266</mn><annotation-xml encoding="MathML-Content" id="A1.T2.42.42.4.m1.1b"><cn id="A1.T2.42.42.4.m1.1.1.cmml" type="integer" xref="A1.T2.42.42.4.m1.1.1">266</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T2.42.42.4.m1.1c">266</annotation><annotation encoding="application/x-llamapun" id="A1.T2.42.42.4.m1.1d">266</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="A1.T2.43.43.5"><math alttext="128" class="ltx_Math" display="inline" id="A1.T2.43.43.5.m1.1"><semantics id="A1.T2.43.43.5.m1.1a"><mn id="A1.T2.43.43.5.m1.1.1" xref="A1.T2.43.43.5.m1.1.1.cmml">128</mn><annotation-xml encoding="MathML-Content" id="A1.T2.43.43.5.m1.1b"><cn id="A1.T2.43.43.5.m1.1.1.cmml" type="integer" xref="A1.T2.43.43.5.m1.1.1">128</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T2.43.43.5.m1.1c">128</annotation><annotation encoding="application/x-llamapun" id="A1.T2.43.43.5.m1.1d">128</annotation></semantics></math></td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A1.T2.44.44.6"><math alttext="8" class="ltx_Math" display="inline" id="A1.T2.44.44.6.m1.1"><semantics id="A1.T2.44.44.6.m1.1a"><mn id="A1.T2.44.44.6.m1.1.1" xref="A1.T2.44.44.6.m1.1.1.cmml">8</mn><annotation-xml encoding="MathML-Content" id="A1.T2.44.44.6.m1.1b"><cn id="A1.T2.44.44.6.m1.1.1.cmml" type="integer" xref="A1.T2.44.44.6.m1.1.1">8</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T2.44.44.6.m1.1c">8</annotation><annotation encoding="application/x-llamapun" id="A1.T2.44.44.6.m1.1d">8</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A1.T2.49.49">
<td class="ltx_td ltx_align_left ltx_border_t" id="A1.T2.45.45.1">
<math alttext="1.3" class="ltx_Math" display="inline" id="A1.T2.45.45.1.m1.1"><semantics id="A1.T2.45.45.1.m1.1a"><mn id="A1.T2.45.45.1.m1.1.1" xref="A1.T2.45.45.1.m1.1.1.cmml">1.3</mn><annotation-xml encoding="MathML-Content" id="A1.T2.45.45.1.m1.1b"><cn id="A1.T2.45.45.1.m1.1.1.cmml" type="float" xref="A1.T2.45.45.1.m1.1.1">1.3</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T2.45.45.1.m1.1c">1.3</annotation><annotation encoding="application/x-llamapun" id="A1.T2.45.45.1.m1.1d">1.3</annotation></semantics></math>B (dense)</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T2.46.46.2"><math alttext="1024" class="ltx_Math" display="inline" id="A1.T2.46.46.2.m1.1"><semantics id="A1.T2.46.46.2.m1.1a"><mn id="A1.T2.46.46.2.m1.1.1" xref="A1.T2.46.46.2.m1.1.1.cmml">1024</mn><annotation-xml encoding="MathML-Content" id="A1.T2.46.46.2.m1.1b"><cn id="A1.T2.46.46.2.m1.1.1.cmml" type="integer" xref="A1.T2.46.46.2.m1.1.1">1024</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T2.46.46.2.m1.1c">1024</annotation><annotation encoding="application/x-llamapun" id="A1.T2.46.46.2.m1.1d">1024</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T2.47.47.3"><math alttext="1000" class="ltx_Math" display="inline" id="A1.T2.47.47.3.m1.1"><semantics id="A1.T2.47.47.3.m1.1a"><mn id="A1.T2.47.47.3.m1.1.1" xref="A1.T2.47.47.3.m1.1.1.cmml">1000</mn><annotation-xml encoding="MathML-Content" id="A1.T2.47.47.3.m1.1b"><cn id="A1.T2.47.47.3.m1.1.1.cmml" type="integer" xref="A1.T2.47.47.3.m1.1.1">1000</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T2.47.47.3.m1.1c">1000</annotation><annotation encoding="application/x-llamapun" id="A1.T2.47.47.3.m1.1d">1000</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T2.48.48.4"><math alttext="1024" class="ltx_Math" display="inline" id="A1.T2.48.48.4.m1.1"><semantics id="A1.T2.48.48.4.m1.1a"><mn id="A1.T2.48.48.4.m1.1.1" xref="A1.T2.48.48.4.m1.1.1.cmml">1024</mn><annotation-xml encoding="MathML-Content" id="A1.T2.48.48.4.m1.1b"><cn id="A1.T2.48.48.4.m1.1.1.cmml" type="integer" xref="A1.T2.48.48.4.m1.1.1">1024</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T2.48.48.4.m1.1c">1024</annotation><annotation encoding="application/x-llamapun" id="A1.T2.48.48.4.m1.1d">1024</annotation></semantics></math></td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" id="A1.T2.49.49.5"><math alttext="64" class="ltx_Math" display="inline" id="A1.T2.49.49.5.m1.1"><semantics id="A1.T2.49.49.5.m1.1a"><mn id="A1.T2.49.49.5.m1.1.1" xref="A1.T2.49.49.5.m1.1.1.cmml">64</mn><annotation-xml encoding="MathML-Content" id="A1.T2.49.49.5.m1.1b"><cn id="A1.T2.49.49.5.m1.1.1.cmml" type="integer" xref="A1.T2.49.49.5.m1.1.1">64</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T2.49.49.5.m1.1c">64</annotation><annotation encoding="application/x-llamapun" id="A1.T2.49.49.5.m1.1d">64</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A1.T2.55.55">
<td class="ltx_td ltx_align_left" id="A1.T2.51.51.2">
<math alttext="1.3" class="ltx_Math" display="inline" id="A1.T2.50.50.1.m1.1"><semantics id="A1.T2.50.50.1.m1.1a"><mn id="A1.T2.50.50.1.m1.1.1" xref="A1.T2.50.50.1.m1.1.1.cmml">1.3</mn><annotation-xml encoding="MathML-Content" id="A1.T2.50.50.1.m1.1b"><cn id="A1.T2.50.50.1.m1.1.1.cmml" type="float" xref="A1.T2.50.50.1.m1.1.1">1.3</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T2.50.50.1.m1.1c">1.3</annotation><annotation encoding="application/x-llamapun" id="A1.T2.50.50.1.m1.1d">1.3</annotation></semantics></math>B (<math alttext="16" class="ltx_Math" display="inline" id="A1.T2.51.51.2.m2.1"><semantics id="A1.T2.51.51.2.m2.1a"><mn id="A1.T2.51.51.2.m2.1.1" xref="A1.T2.51.51.2.m2.1.1.cmml">16</mn><annotation-xml encoding="MathML-Content" id="A1.T2.51.51.2.m2.1b"><cn id="A1.T2.51.51.2.m2.1.1.cmml" type="integer" xref="A1.T2.51.51.2.m2.1.1">16</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T2.51.51.2.m2.1c">16</annotation><annotation encoding="application/x-llamapun" id="A1.T2.51.51.2.m2.1d">16</annotation></semantics></math> experts)</td>
<td class="ltx_td ltx_align_center" id="A1.T2.52.52.3"><math alttext="512" class="ltx_Math" display="inline" id="A1.T2.52.52.3.m1.1"><semantics id="A1.T2.52.52.3.m1.1a"><mn id="A1.T2.52.52.3.m1.1.1" xref="A1.T2.52.52.3.m1.1.1.cmml">512</mn><annotation-xml encoding="MathML-Content" id="A1.T2.52.52.3.m1.1b"><cn id="A1.T2.52.52.3.m1.1.1.cmml" type="integer" xref="A1.T2.52.52.3.m1.1.1">512</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T2.52.52.3.m1.1c">512</annotation><annotation encoding="application/x-llamapun" id="A1.T2.52.52.3.m1.1d">512</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="A1.T2.53.53.4"><math alttext="1000" class="ltx_Math" display="inline" id="A1.T2.53.53.4.m1.1"><semantics id="A1.T2.53.53.4.m1.1a"><mn id="A1.T2.53.53.4.m1.1.1" xref="A1.T2.53.53.4.m1.1.1.cmml">1000</mn><annotation-xml encoding="MathML-Content" id="A1.T2.53.53.4.m1.1b"><cn id="A1.T2.53.53.4.m1.1.1.cmml" type="integer" xref="A1.T2.53.53.4.m1.1.1">1000</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T2.53.53.4.m1.1c">1000</annotation><annotation encoding="application/x-llamapun" id="A1.T2.53.53.4.m1.1d">1000</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="A1.T2.54.54.5"><math alttext="128" class="ltx_Math" display="inline" id="A1.T2.54.54.5.m1.1"><semantics id="A1.T2.54.54.5.m1.1a"><mn id="A1.T2.54.54.5.m1.1.1" xref="A1.T2.54.54.5.m1.1.1.cmml">128</mn><annotation-xml encoding="MathML-Content" id="A1.T2.54.54.5.m1.1b"><cn id="A1.T2.54.54.5.m1.1.1.cmml" type="integer" xref="A1.T2.54.54.5.m1.1.1">128</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T2.54.54.5.m1.1c">128</annotation><annotation encoding="application/x-llamapun" id="A1.T2.54.54.5.m1.1d">128</annotation></semantics></math></td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A1.T2.55.55.6"><math alttext="8" class="ltx_Math" display="inline" id="A1.T2.55.55.6.m1.1"><semantics id="A1.T2.55.55.6.m1.1a"><mn id="A1.T2.55.55.6.m1.1.1" xref="A1.T2.55.55.6.m1.1.1.cmml">8</mn><annotation-xml encoding="MathML-Content" id="A1.T2.55.55.6.m1.1b"><cn id="A1.T2.55.55.6.m1.1.1.cmml" type="integer" xref="A1.T2.55.55.6.m1.1.1">8</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T2.55.55.6.m1.1c">8</annotation><annotation encoding="application/x-llamapun" id="A1.T2.55.55.6.m1.1d">8</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A1.T2.60.60">
<td class="ltx_td ltx_align_left ltx_border_t" id="A1.T2.56.56.1">
<math alttext="1.3" class="ltx_Math" display="inline" id="A1.T2.56.56.1.m1.1"><semantics id="A1.T2.56.56.1.m1.1a"><mn id="A1.T2.56.56.1.m1.1.1" xref="A1.T2.56.56.1.m1.1.1.cmml">1.3</mn><annotation-xml encoding="MathML-Content" id="A1.T2.56.56.1.m1.1b"><cn id="A1.T2.56.56.1.m1.1.1.cmml" type="float" xref="A1.T2.56.56.1.m1.1.1">1.3</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T2.56.56.1.m1.1c">1.3</annotation><annotation encoding="application/x-llamapun" id="A1.T2.56.56.1.m1.1d">1.3</annotation></semantics></math>B (dense)</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T2.57.57.2"><math alttext="1024" class="ltx_Math" display="inline" id="A1.T2.57.57.2.m1.1"><semantics id="A1.T2.57.57.2.m1.1a"><mn id="A1.T2.57.57.2.m1.1.1" xref="A1.T2.57.57.2.m1.1.1.cmml">1024</mn><annotation-xml encoding="MathML-Content" id="A1.T2.57.57.2.m1.1b"><cn id="A1.T2.57.57.2.m1.1.1.cmml" type="integer" xref="A1.T2.57.57.2.m1.1.1">1024</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T2.57.57.2.m1.1c">1024</annotation><annotation encoding="application/x-llamapun" id="A1.T2.57.57.2.m1.1d">1024</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T2.58.58.3"><math alttext="2000" class="ltx_Math" display="inline" id="A1.T2.58.58.3.m1.1"><semantics id="A1.T2.58.58.3.m1.1a"><mn id="A1.T2.58.58.3.m1.1.1" xref="A1.T2.58.58.3.m1.1.1.cmml">2000</mn><annotation-xml encoding="MathML-Content" id="A1.T2.58.58.3.m1.1b"><cn id="A1.T2.58.58.3.m1.1.1.cmml" type="integer" xref="A1.T2.58.58.3.m1.1.1">2000</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T2.58.58.3.m1.1c">2000</annotation><annotation encoding="application/x-llamapun" id="A1.T2.58.58.3.m1.1d">2000</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T2.59.59.4"><math alttext="2048" class="ltx_Math" display="inline" id="A1.T2.59.59.4.m1.1"><semantics id="A1.T2.59.59.4.m1.1a"><mn id="A1.T2.59.59.4.m1.1.1" xref="A1.T2.59.59.4.m1.1.1.cmml">2048</mn><annotation-xml encoding="MathML-Content" id="A1.T2.59.59.4.m1.1b"><cn id="A1.T2.59.59.4.m1.1.1.cmml" type="integer" xref="A1.T2.59.59.4.m1.1.1">2048</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T2.59.59.4.m1.1c">2048</annotation><annotation encoding="application/x-llamapun" id="A1.T2.59.59.4.m1.1d">2048</annotation></semantics></math></td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" id="A1.T2.60.60.5"><math alttext="128" class="ltx_Math" display="inline" id="A1.T2.60.60.5.m1.1"><semantics id="A1.T2.60.60.5.m1.1a"><mn id="A1.T2.60.60.5.m1.1.1" xref="A1.T2.60.60.5.m1.1.1.cmml">128</mn><annotation-xml encoding="MathML-Content" id="A1.T2.60.60.5.m1.1b"><cn id="A1.T2.60.60.5.m1.1.1.cmml" type="integer" xref="A1.T2.60.60.5.m1.1.1">128</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T2.60.60.5.m1.1c">128</annotation><annotation encoding="application/x-llamapun" id="A1.T2.60.60.5.m1.1d">128</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A1.T2.66.66">
<td class="ltx_td ltx_align_left" id="A1.T2.62.62.2">
<math alttext="1.3" class="ltx_Math" display="inline" id="A1.T2.61.61.1.m1.1"><semantics id="A1.T2.61.61.1.m1.1a"><mn id="A1.T2.61.61.1.m1.1.1" xref="A1.T2.61.61.1.m1.1.1.cmml">1.3</mn><annotation-xml encoding="MathML-Content" id="A1.T2.61.61.1.m1.1b"><cn id="A1.T2.61.61.1.m1.1.1.cmml" type="float" xref="A1.T2.61.61.1.m1.1.1">1.3</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T2.61.61.1.m1.1c">1.3</annotation><annotation encoding="application/x-llamapun" id="A1.T2.61.61.1.m1.1d">1.3</annotation></semantics></math>B (<math alttext="32" class="ltx_Math" display="inline" id="A1.T2.62.62.2.m2.1"><semantics id="A1.T2.62.62.2.m2.1a"><mn id="A1.T2.62.62.2.m2.1.1" xref="A1.T2.62.62.2.m2.1.1.cmml">32</mn><annotation-xml encoding="MathML-Content" id="A1.T2.62.62.2.m2.1b"><cn id="A1.T2.62.62.2.m2.1.1.cmml" type="integer" xref="A1.T2.62.62.2.m2.1.1">32</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T2.62.62.2.m2.1c">32</annotation><annotation encoding="application/x-llamapun" id="A1.T2.62.62.2.m2.1d">32</annotation></semantics></math> experts)</td>
<td class="ltx_td ltx_align_center" id="A1.T2.63.63.3"><math alttext="512" class="ltx_Math" display="inline" id="A1.T2.63.63.3.m1.1"><semantics id="A1.T2.63.63.3.m1.1a"><mn id="A1.T2.63.63.3.m1.1.1" xref="A1.T2.63.63.3.m1.1.1.cmml">512</mn><annotation-xml encoding="MathML-Content" id="A1.T2.63.63.3.m1.1b"><cn id="A1.T2.63.63.3.m1.1.1.cmml" type="integer" xref="A1.T2.63.63.3.m1.1.1">512</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T2.63.63.3.m1.1c">512</annotation><annotation encoding="application/x-llamapun" id="A1.T2.63.63.3.m1.1d">512</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="A1.T2.64.64.4"><math alttext="2000" class="ltx_Math" display="inline" id="A1.T2.64.64.4.m1.1"><semantics id="A1.T2.64.64.4.m1.1a"><mn id="A1.T2.64.64.4.m1.1.1" xref="A1.T2.64.64.4.m1.1.1.cmml">2000</mn><annotation-xml encoding="MathML-Content" id="A1.T2.64.64.4.m1.1b"><cn id="A1.T2.64.64.4.m1.1.1.cmml" type="integer" xref="A1.T2.64.64.4.m1.1.1">2000</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T2.64.64.4.m1.1c">2000</annotation><annotation encoding="application/x-llamapun" id="A1.T2.64.64.4.m1.1d">2000</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="A1.T2.65.65.5"><math alttext="128" class="ltx_Math" display="inline" id="A1.T2.65.65.5.m1.1"><semantics id="A1.T2.65.65.5.m1.1a"><mn id="A1.T2.65.65.5.m1.1.1" xref="A1.T2.65.65.5.m1.1.1.cmml">128</mn><annotation-xml encoding="MathML-Content" id="A1.T2.65.65.5.m1.1b"><cn id="A1.T2.65.65.5.m1.1.1.cmml" type="integer" xref="A1.T2.65.65.5.m1.1.1">128</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T2.65.65.5.m1.1c">128</annotation><annotation encoding="application/x-llamapun" id="A1.T2.65.65.5.m1.1d">128</annotation></semantics></math></td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A1.T2.66.66.6"><math alttext="8" class="ltx_Math" display="inline" id="A1.T2.66.66.6.m1.1"><semantics id="A1.T2.66.66.6.m1.1a"><mn id="A1.T2.66.66.6.m1.1.1" xref="A1.T2.66.66.6.m1.1.1.cmml">8</mn><annotation-xml encoding="MathML-Content" id="A1.T2.66.66.6.m1.1b"><cn id="A1.T2.66.66.6.m1.1.1.cmml" type="integer" xref="A1.T2.66.66.6.m1.1.1">8</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T2.66.66.6.m1.1c">8</annotation><annotation encoding="application/x-llamapun" id="A1.T2.66.66.6.m1.1d">8</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A1.T2.71.71">
<td class="ltx_td ltx_align_left ltx_border_bb ltx_border_t" id="A1.T2.67.67.1">
<math alttext="4.4" class="ltx_Math" display="inline" id="A1.T2.67.67.1.m1.1"><semantics id="A1.T2.67.67.1.m1.1a"><mn id="A1.T2.67.67.1.m1.1.1" xref="A1.T2.67.67.1.m1.1.1.cmml">4.4</mn><annotation-xml encoding="MathML-Content" id="A1.T2.67.67.1.m1.1b"><cn id="A1.T2.67.67.1.m1.1.1.cmml" type="float" xref="A1.T2.67.67.1.m1.1.1">4.4</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T2.67.67.1.m1.1c">4.4</annotation><annotation encoding="application/x-llamapun" id="A1.T2.67.67.1.m1.1d">4.4</annotation></semantics></math>M (router)</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="A1.T2.68.68.2"><math alttext="128" class="ltx_Math" display="inline" id="A1.T2.68.68.2.m1.1"><semantics id="A1.T2.68.68.2.m1.1a"><mn id="A1.T2.68.68.2.m1.1.1" xref="A1.T2.68.68.2.m1.1.1.cmml">128</mn><annotation-xml encoding="MathML-Content" id="A1.T2.68.68.2.m1.1b"><cn id="A1.T2.68.68.2.m1.1.1.cmml" type="integer" xref="A1.T2.68.68.2.m1.1.1">128</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T2.68.68.2.m1.1c">128</annotation><annotation encoding="application/x-llamapun" id="A1.T2.68.68.2.m1.1d">128</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="A1.T2.69.69.3"><math alttext="4" class="ltx_Math" display="inline" id="A1.T2.69.69.3.m1.1"><semantics id="A1.T2.69.69.3.m1.1a"><mn id="A1.T2.69.69.3.m1.1.1" xref="A1.T2.69.69.3.m1.1.1.cmml">4</mn><annotation-xml encoding="MathML-Content" id="A1.T2.69.69.3.m1.1b"><cn id="A1.T2.69.69.3.m1.1.1.cmml" type="integer" xref="A1.T2.69.69.3.m1.1.1">4</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T2.69.69.3.m1.1c">4</annotation><annotation encoding="application/x-llamapun" id="A1.T2.69.69.3.m1.1d">4</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="A1.T2.70.70.4"><math alttext="32" class="ltx_Math" display="inline" id="A1.T2.70.70.4.m1.1"><semantics id="A1.T2.70.70.4.m1.1a"><mn id="A1.T2.70.70.4.m1.1.1" xref="A1.T2.70.70.4.m1.1.1.cmml">32</mn><annotation-xml encoding="MathML-Content" id="A1.T2.70.70.4.m1.1b"><cn id="A1.T2.70.70.4.m1.1.1.cmml" type="integer" xref="A1.T2.70.70.4.m1.1.1">32</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T2.70.70.4.m1.1c">32</annotation><annotation encoding="application/x-llamapun" id="A1.T2.70.70.4.m1.1d">32</annotation></semantics></math></td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_bb ltx_border_t" id="A1.T2.71.71.5"><math alttext="1" class="ltx_Math" display="inline" id="A1.T2.71.71.5.m1.1"><semantics id="A1.T2.71.71.5.m1.1a"><mn id="A1.T2.71.71.5.m1.1.1" xref="A1.T2.71.71.5.m1.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="A1.T2.71.71.5.m1.1b"><cn id="A1.T2.71.71.5.m1.1.1.cmml" type="integer" xref="A1.T2.71.71.5.m1.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T2.71.71.5.m1.1c">1</annotation><annotation encoding="application/x-llamapun" id="A1.T2.71.71.5.m1.1d">1</annotation></semantics></math></td>
</tr>
</tbody></table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 2: </span><span class="ltx_text ltx_font_bold" id="A1.T2.73.1">Training parameters.</span></figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</section>
<section class="ltx_subsection" id="A1.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.2 </span>Notation</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="A1.SS2.p1">
<p class="ltx_p" id="A1.SS2.p1.1">For the dense baseline LLM and expert LLM:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<ul class="ltx_itemize" id="A1.I1">
<li class="ltx_item" id="A1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A1.I1.i1.p1">
<p class="ltx_p" id="A1.I1.i1.p1.1">Number of layers (<math alttext="L" class="ltx_Math" display="inline" id="A1.I1.i1.p1.1.m1.1"><semantics id="A1.I1.i1.p1.1.m1.1a"><mi id="A1.I1.i1.p1.1.m1.1.1" xref="A1.I1.i1.p1.1.m1.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="A1.I1.i1.p1.1.m1.1b"><ci id="A1.I1.i1.p1.1.m1.1.1.cmml" xref="A1.I1.i1.p1.1.m1.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.I1.i1.p1.1.m1.1c">L</annotation><annotation encoding="application/x-llamapun" id="A1.I1.i1.p1.1.m1.1d">italic_L</annotation></semantics></math>)</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="A1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A1.I1.i2.p1">
<p class="ltx_p" id="A1.I1.i2.p1.1">Hidden dimension size (<math alttext="H" class="ltx_Math" display="inline" id="A1.I1.i2.p1.1.m1.1"><semantics id="A1.I1.i2.p1.1.m1.1a"><mi id="A1.I1.i2.p1.1.m1.1.1" xref="A1.I1.i2.p1.1.m1.1.1.cmml">H</mi><annotation-xml encoding="MathML-Content" id="A1.I1.i2.p1.1.m1.1b"><ci id="A1.I1.i2.p1.1.m1.1.1.cmml" xref="A1.I1.i2.p1.1.m1.1.1">𝐻</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.I1.i2.p1.1.m1.1c">H</annotation><annotation encoding="application/x-llamapun" id="A1.I1.i2.p1.1.m1.1d">italic_H</annotation></semantics></math>)</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="A1.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A1.I1.i3.p1">
<p class="ltx_p" id="A1.I1.i3.p1.1">Number of attention heads (<math alttext="A" class="ltx_Math" display="inline" id="A1.I1.i3.p1.1.m1.1"><semantics id="A1.I1.i3.p1.1.m1.1a"><mi id="A1.I1.i3.p1.1.m1.1.1" xref="A1.I1.i3.p1.1.m1.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="A1.I1.i3.p1.1.m1.1b"><ci id="A1.I1.i3.p1.1.m1.1.1.cmml" xref="A1.I1.i3.p1.1.m1.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.I1.i3.p1.1.m1.1c">A</annotation><annotation encoding="application/x-llamapun" id="A1.I1.i3.p1.1.m1.1d">italic_A</annotation></semantics></math>)</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="A1.I1.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A1.I1.i4.p1">
<p class="ltx_p" id="A1.I1.i4.p1.1">Sequence length (<math alttext="S" class="ltx_Math" display="inline" id="A1.I1.i4.p1.1.m1.1"><semantics id="A1.I1.i4.p1.1.m1.1a"><mi id="A1.I1.i4.p1.1.m1.1.1" xref="A1.I1.i4.p1.1.m1.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="A1.I1.i4.p1.1.m1.1b"><ci id="A1.I1.i4.p1.1.m1.1.1.cmml" xref="A1.I1.i4.p1.1.m1.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.I1.i4.p1.1.m1.1c">S</annotation><annotation encoding="application/x-llamapun" id="A1.I1.i4.p1.1.m1.1d">italic_S</annotation></semantics></math>)</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="A1.I1.i5" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A1.I1.i5.p1">
<p class="ltx_p" id="A1.I1.i5.p1.1">Batch size (<math alttext="B" class="ltx_Math" display="inline" id="A1.I1.i5.p1.1.m1.1"><semantics id="A1.I1.i5.p1.1.m1.1a"><mi id="A1.I1.i5.p1.1.m1.1.1" xref="A1.I1.i5.p1.1.m1.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="A1.I1.i5.p1.1.m1.1b"><ci id="A1.I1.i5.p1.1.m1.1.1.cmml" xref="A1.I1.i5.p1.1.m1.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.I1.i5.p1.1.m1.1c">B</annotation><annotation encoding="application/x-llamapun" id="A1.I1.i5.p1.1.m1.1d">italic_B</annotation></semantics></math>)</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="A1.I1.i6" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A1.I1.i6.p1">
<p class="ltx_p" id="A1.I1.i6.p1.1">Vocabulary size (<math alttext="V" class="ltx_Math" display="inline" id="A1.I1.i6.p1.1.m1.1"><semantics id="A1.I1.i6.p1.1.m1.1a"><mi id="A1.I1.i6.p1.1.m1.1.1" xref="A1.I1.i6.p1.1.m1.1.1.cmml">V</mi><annotation-xml encoding="MathML-Content" id="A1.I1.i6.p1.1.m1.1b"><ci id="A1.I1.i6.p1.1.m1.1.1.cmml" xref="A1.I1.i6.p1.1.m1.1.1">𝑉</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.I1.i6.p1.1.m1.1c">V</annotation><annotation encoding="application/x-llamapun" id="A1.I1.i6.p1.1.m1.1d">italic_V</annotation></semantics></math>)</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="A1.I1.i7" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para ltx_noindent" id="A1.I1.i7.p1">
<p class="ltx_p" id="A1.I1.i7.p1.1">Feedforward network dimension (<math alttext="D_{\text{ff}}" class="ltx_Math" display="inline" id="A1.I1.i7.p1.1.m1.1"><semantics id="A1.I1.i7.p1.1.m1.1a"><msub id="A1.I1.i7.p1.1.m1.1.1" xref="A1.I1.i7.p1.1.m1.1.1.cmml"><mi id="A1.I1.i7.p1.1.m1.1.1.2" xref="A1.I1.i7.p1.1.m1.1.1.2.cmml">D</mi><mtext id="A1.I1.i7.p1.1.m1.1.1.3" xref="A1.I1.i7.p1.1.m1.1.1.3a.cmml">ff</mtext></msub><annotation-xml encoding="MathML-Content" id="A1.I1.i7.p1.1.m1.1b"><apply id="A1.I1.i7.p1.1.m1.1.1.cmml" xref="A1.I1.i7.p1.1.m1.1.1"><csymbol cd="ambiguous" id="A1.I1.i7.p1.1.m1.1.1.1.cmml" xref="A1.I1.i7.p1.1.m1.1.1">subscript</csymbol><ci id="A1.I1.i7.p1.1.m1.1.1.2.cmml" xref="A1.I1.i7.p1.1.m1.1.1.2">𝐷</ci><ci id="A1.I1.i7.p1.1.m1.1.1.3a.cmml" xref="A1.I1.i7.p1.1.m1.1.1.3"><mtext id="A1.I1.i7.p1.1.m1.1.1.3.cmml" mathsize="70%" xref="A1.I1.i7.p1.1.m1.1.1.3">ff</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.I1.i7.p1.1.m1.1c">D_{\text{ff}}</annotation><annotation encoding="application/x-llamapun" id="A1.I1.i7.p1.1.m1.1d">italic_D start_POSTSUBSCRIPT ff end_POSTSUBSCRIPT</annotation></semantics></math>)</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
</ul>
</div>
<div class="ltx_para ltx_noindent" id="A1.SS2.p2">
<p class="ltx_p" id="A1.SS2.p2.1">For the router LLM:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<ul class="ltx_itemize" id="A1.I2">
<li class="ltx_item" id="A1.I2.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A1.I2.i1.p1">
<p class="ltx_p" id="A1.I2.i1.p1.1">Prefix length for routing (<math alttext="M" class="ltx_Math" display="inline" id="A1.I2.i1.p1.1.m1.1"><semantics id="A1.I2.i1.p1.1.m1.1a"><mi id="A1.I2.i1.p1.1.m1.1.1" xref="A1.I2.i1.p1.1.m1.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="A1.I2.i1.p1.1.m1.1b"><ci id="A1.I2.i1.p1.1.m1.1.1.cmml" xref="A1.I2.i1.p1.1.m1.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.I2.i1.p1.1.m1.1c">M</annotation><annotation encoding="application/x-llamapun" id="A1.I2.i1.p1.1.m1.1d">italic_M</annotation></semantics></math>)</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="A1.I2.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A1.I2.i2.p1">
<p class="ltx_p" id="A1.I2.i2.p1.1">Number of layers (<math alttext="L_{r}" class="ltx_Math" display="inline" id="A1.I2.i2.p1.1.m1.1"><semantics id="A1.I2.i2.p1.1.m1.1a"><msub id="A1.I2.i2.p1.1.m1.1.1" xref="A1.I2.i2.p1.1.m1.1.1.cmml"><mi id="A1.I2.i2.p1.1.m1.1.1.2" xref="A1.I2.i2.p1.1.m1.1.1.2.cmml">L</mi><mi id="A1.I2.i2.p1.1.m1.1.1.3" xref="A1.I2.i2.p1.1.m1.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="A1.I2.i2.p1.1.m1.1b"><apply id="A1.I2.i2.p1.1.m1.1.1.cmml" xref="A1.I2.i2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="A1.I2.i2.p1.1.m1.1.1.1.cmml" xref="A1.I2.i2.p1.1.m1.1.1">subscript</csymbol><ci id="A1.I2.i2.p1.1.m1.1.1.2.cmml" xref="A1.I2.i2.p1.1.m1.1.1.2">𝐿</ci><ci id="A1.I2.i2.p1.1.m1.1.1.3.cmml" xref="A1.I2.i2.p1.1.m1.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.I2.i2.p1.1.m1.1c">L_{r}</annotation><annotation encoding="application/x-llamapun" id="A1.I2.i2.p1.1.m1.1d">italic_L start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT</annotation></semantics></math>)</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="A1.I2.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A1.I2.i3.p1">
<p class="ltx_p" id="A1.I2.i3.p1.1">Hidden dimension size (<math alttext="H_{r}" class="ltx_Math" display="inline" id="A1.I2.i3.p1.1.m1.1"><semantics id="A1.I2.i3.p1.1.m1.1a"><msub id="A1.I2.i3.p1.1.m1.1.1" xref="A1.I2.i3.p1.1.m1.1.1.cmml"><mi id="A1.I2.i3.p1.1.m1.1.1.2" xref="A1.I2.i3.p1.1.m1.1.1.2.cmml">H</mi><mi id="A1.I2.i3.p1.1.m1.1.1.3" xref="A1.I2.i3.p1.1.m1.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="A1.I2.i3.p1.1.m1.1b"><apply id="A1.I2.i3.p1.1.m1.1.1.cmml" xref="A1.I2.i3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="A1.I2.i3.p1.1.m1.1.1.1.cmml" xref="A1.I2.i3.p1.1.m1.1.1">subscript</csymbol><ci id="A1.I2.i3.p1.1.m1.1.1.2.cmml" xref="A1.I2.i3.p1.1.m1.1.1.2">𝐻</ci><ci id="A1.I2.i3.p1.1.m1.1.1.3.cmml" xref="A1.I2.i3.p1.1.m1.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.I2.i3.p1.1.m1.1c">H_{r}</annotation><annotation encoding="application/x-llamapun" id="A1.I2.i3.p1.1.m1.1d">italic_H start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT</annotation></semantics></math>)</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="A1.I2.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A1.I2.i4.p1">
<p class="ltx_p" id="A1.I2.i4.p1.1">Number of attention heads (<math alttext="A_{r}" class="ltx_Math" display="inline" id="A1.I2.i4.p1.1.m1.1"><semantics id="A1.I2.i4.p1.1.m1.1a"><msub id="A1.I2.i4.p1.1.m1.1.1" xref="A1.I2.i4.p1.1.m1.1.1.cmml"><mi id="A1.I2.i4.p1.1.m1.1.1.2" xref="A1.I2.i4.p1.1.m1.1.1.2.cmml">A</mi><mi id="A1.I2.i4.p1.1.m1.1.1.3" xref="A1.I2.i4.p1.1.m1.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="A1.I2.i4.p1.1.m1.1b"><apply id="A1.I2.i4.p1.1.m1.1.1.cmml" xref="A1.I2.i4.p1.1.m1.1.1"><csymbol cd="ambiguous" id="A1.I2.i4.p1.1.m1.1.1.1.cmml" xref="A1.I2.i4.p1.1.m1.1.1">subscript</csymbol><ci id="A1.I2.i4.p1.1.m1.1.1.2.cmml" xref="A1.I2.i4.p1.1.m1.1.1.2">𝐴</ci><ci id="A1.I2.i4.p1.1.m1.1.1.3.cmml" xref="A1.I2.i4.p1.1.m1.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.I2.i4.p1.1.m1.1c">A_{r}</annotation><annotation encoding="application/x-llamapun" id="A1.I2.i4.p1.1.m1.1d">italic_A start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT</annotation></semantics></math>)</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="A1.I2.i5" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A1.I2.i5.p1">
<p class="ltx_p" id="A1.I2.i5.p1.1">Batch size (<math alttext="B_{r}" class="ltx_Math" display="inline" id="A1.I2.i5.p1.1.m1.1"><semantics id="A1.I2.i5.p1.1.m1.1a"><msub id="A1.I2.i5.p1.1.m1.1.1" xref="A1.I2.i5.p1.1.m1.1.1.cmml"><mi id="A1.I2.i5.p1.1.m1.1.1.2" xref="A1.I2.i5.p1.1.m1.1.1.2.cmml">B</mi><mi id="A1.I2.i5.p1.1.m1.1.1.3" xref="A1.I2.i5.p1.1.m1.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="A1.I2.i5.p1.1.m1.1b"><apply id="A1.I2.i5.p1.1.m1.1.1.cmml" xref="A1.I2.i5.p1.1.m1.1.1"><csymbol cd="ambiguous" id="A1.I2.i5.p1.1.m1.1.1.1.cmml" xref="A1.I2.i5.p1.1.m1.1.1">subscript</csymbol><ci id="A1.I2.i5.p1.1.m1.1.1.2.cmml" xref="A1.I2.i5.p1.1.m1.1.1.2">𝐵</ci><ci id="A1.I2.i5.p1.1.m1.1.1.3.cmml" xref="A1.I2.i5.p1.1.m1.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.I2.i5.p1.1.m1.1c">B_{r}</annotation><annotation encoding="application/x-llamapun" id="A1.I2.i5.p1.1.m1.1d">italic_B start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT</annotation></semantics></math>)</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="A1.I2.i6" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A1.I2.i6.p1">
<p class="ltx_p" id="A1.I2.i6.p1.1">Feedforward network dimension (<math alttext="D_{r_{\text{ff}}}" class="ltx_Math" display="inline" id="A1.I2.i6.p1.1.m1.1"><semantics id="A1.I2.i6.p1.1.m1.1a"><msub id="A1.I2.i6.p1.1.m1.1.1" xref="A1.I2.i6.p1.1.m1.1.1.cmml"><mi id="A1.I2.i6.p1.1.m1.1.1.2" xref="A1.I2.i6.p1.1.m1.1.1.2.cmml">D</mi><msub id="A1.I2.i6.p1.1.m1.1.1.3" xref="A1.I2.i6.p1.1.m1.1.1.3.cmml"><mi id="A1.I2.i6.p1.1.m1.1.1.3.2" xref="A1.I2.i6.p1.1.m1.1.1.3.2.cmml">r</mi><mtext id="A1.I2.i6.p1.1.m1.1.1.3.3" xref="A1.I2.i6.p1.1.m1.1.1.3.3a.cmml">ff</mtext></msub></msub><annotation-xml encoding="MathML-Content" id="A1.I2.i6.p1.1.m1.1b"><apply id="A1.I2.i6.p1.1.m1.1.1.cmml" xref="A1.I2.i6.p1.1.m1.1.1"><csymbol cd="ambiguous" id="A1.I2.i6.p1.1.m1.1.1.1.cmml" xref="A1.I2.i6.p1.1.m1.1.1">subscript</csymbol><ci id="A1.I2.i6.p1.1.m1.1.1.2.cmml" xref="A1.I2.i6.p1.1.m1.1.1.2">𝐷</ci><apply id="A1.I2.i6.p1.1.m1.1.1.3.cmml" xref="A1.I2.i6.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="A1.I2.i6.p1.1.m1.1.1.3.1.cmml" xref="A1.I2.i6.p1.1.m1.1.1.3">subscript</csymbol><ci id="A1.I2.i6.p1.1.m1.1.1.3.2.cmml" xref="A1.I2.i6.p1.1.m1.1.1.3.2">𝑟</ci><ci id="A1.I2.i6.p1.1.m1.1.1.3.3a.cmml" xref="A1.I2.i6.p1.1.m1.1.1.3.3"><mtext id="A1.I2.i6.p1.1.m1.1.1.3.3.cmml" mathsize="50%" xref="A1.I2.i6.p1.1.m1.1.1.3.3">ff</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.I2.i6.p1.1.m1.1c">D_{r_{\text{ff}}}</annotation><annotation encoding="application/x-llamapun" id="A1.I2.i6.p1.1.m1.1d">italic_D start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT ff end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math>) – parameters specific to the router model</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="A1.I2.i7" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para ltx_noindent" id="A1.I2.i7.p1">
<p class="ltx_p" id="A1.I2.i7.p1.1">Number of training tokens per router between communications <math alttext="T" class="ltx_Math" display="inline" id="A1.I2.i7.p1.1.m1.1"><semantics id="A1.I2.i7.p1.1.m1.1a"><mi id="A1.I2.i7.p1.1.m1.1.1" xref="A1.I2.i7.p1.1.m1.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="A1.I2.i7.p1.1.m1.1b"><ci id="A1.I2.i7.p1.1.m1.1.1.cmml" xref="A1.I2.i7.p1.1.m1.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.I2.i7.p1.1.m1.1c">T</annotation><annotation encoding="application/x-llamapun" id="A1.I2.i7.p1.1.m1.1d">italic_T</annotation></semantics></math></p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
</ul>
</div>
<div class="ltx_para ltx_noindent" id="A1.SS2.p3">
<p class="ltx_p" id="A1.SS2.p3.6">We also define <math alttext="N_{\text{steps}}" class="ltx_Math" display="inline" id="A1.SS2.p3.1.m1.1"><semantics id="A1.SS2.p3.1.m1.1a"><msub id="A1.SS2.p3.1.m1.1.1" xref="A1.SS2.p3.1.m1.1.1.cmml"><mi id="A1.SS2.p3.1.m1.1.1.2" xref="A1.SS2.p3.1.m1.1.1.2.cmml">N</mi><mtext id="A1.SS2.p3.1.m1.1.1.3" xref="A1.SS2.p3.1.m1.1.1.3a.cmml">steps</mtext></msub><annotation-xml encoding="MathML-Content" id="A1.SS2.p3.1.m1.1b"><apply id="A1.SS2.p3.1.m1.1.1.cmml" xref="A1.SS2.p3.1.m1.1.1"><csymbol cd="ambiguous" id="A1.SS2.p3.1.m1.1.1.1.cmml" xref="A1.SS2.p3.1.m1.1.1">subscript</csymbol><ci id="A1.SS2.p3.1.m1.1.1.2.cmml" xref="A1.SS2.p3.1.m1.1.1.2">𝑁</ci><ci id="A1.SS2.p3.1.m1.1.1.3a.cmml" xref="A1.SS2.p3.1.m1.1.1.3"><mtext id="A1.SS2.p3.1.m1.1.1.3.cmml" mathsize="70%" xref="A1.SS2.p3.1.m1.1.1.3">steps</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p3.1.m1.1c">N_{\text{steps}}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p3.1.m1.1d">italic_N start_POSTSUBSCRIPT steps end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="N_{\text{steps\_expert}}" class="ltx_Math" display="inline" id="A1.SS2.p3.2.m2.1"><semantics id="A1.SS2.p3.2.m2.1a"><msub id="A1.SS2.p3.2.m2.1.1" xref="A1.SS2.p3.2.m2.1.1.cmml"><mi id="A1.SS2.p3.2.m2.1.1.2" xref="A1.SS2.p3.2.m2.1.1.2.cmml">N</mi><mtext id="A1.SS2.p3.2.m2.1.1.3" xref="A1.SS2.p3.2.m2.1.1.3a.cmml">steps_expert</mtext></msub><annotation-xml encoding="MathML-Content" id="A1.SS2.p3.2.m2.1b"><apply id="A1.SS2.p3.2.m2.1.1.cmml" xref="A1.SS2.p3.2.m2.1.1"><csymbol cd="ambiguous" id="A1.SS2.p3.2.m2.1.1.1.cmml" xref="A1.SS2.p3.2.m2.1.1">subscript</csymbol><ci id="A1.SS2.p3.2.m2.1.1.2.cmml" xref="A1.SS2.p3.2.m2.1.1.2">𝑁</ci><ci id="A1.SS2.p3.2.m2.1.1.3a.cmml" xref="A1.SS2.p3.2.m2.1.1.3"><mtext id="A1.SS2.p3.2.m2.1.1.3.cmml" mathsize="70%" xref="A1.SS2.p3.2.m2.1.1.3">steps_expert</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p3.2.m2.1c">N_{\text{steps\_expert}}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p3.2.m2.1d">italic_N start_POSTSUBSCRIPT steps_expert end_POSTSUBSCRIPT</annotation></semantics></math>, and <math alttext="N_{\text{steps\_router}}" class="ltx_Math" display="inline" id="A1.SS2.p3.3.m3.1"><semantics id="A1.SS2.p3.3.m3.1a"><msub id="A1.SS2.p3.3.m3.1.1" xref="A1.SS2.p3.3.m3.1.1.cmml"><mi id="A1.SS2.p3.3.m3.1.1.2" xref="A1.SS2.p3.3.m3.1.1.2.cmml">N</mi><mtext id="A1.SS2.p3.3.m3.1.1.3" xref="A1.SS2.p3.3.m3.1.1.3a.cmml">steps_router</mtext></msub><annotation-xml encoding="MathML-Content" id="A1.SS2.p3.3.m3.1b"><apply id="A1.SS2.p3.3.m3.1.1.cmml" xref="A1.SS2.p3.3.m3.1.1"><csymbol cd="ambiguous" id="A1.SS2.p3.3.m3.1.1.1.cmml" xref="A1.SS2.p3.3.m3.1.1">subscript</csymbol><ci id="A1.SS2.p3.3.m3.1.1.2.cmml" xref="A1.SS2.p3.3.m3.1.1.2">𝑁</ci><ci id="A1.SS2.p3.3.m3.1.1.3a.cmml" xref="A1.SS2.p3.3.m3.1.1.3"><mtext id="A1.SS2.p3.3.m3.1.1.3.cmml" mathsize="70%" xref="A1.SS2.p3.3.m3.1.1.3">steps_router</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p3.3.m3.1c">N_{\text{steps\_router}}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p3.3.m3.1d">italic_N start_POSTSUBSCRIPT steps_router end_POSTSUBSCRIPT</annotation></semantics></math> as the number of training steps for the dense baseline, the expert in the mixture, and the router, respectively. The sequence length (<math alttext="S" class="ltx_Math" display="inline" id="A1.SS2.p3.4.m4.1"><semantics id="A1.SS2.p3.4.m4.1a"><mi id="A1.SS2.p3.4.m4.1.1" xref="A1.SS2.p3.4.m4.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.p3.4.m4.1b"><ci id="A1.SS2.p3.4.m4.1.1.cmml" xref="A1.SS2.p3.4.m4.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p3.4.m4.1c">S</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p3.4.m4.1d">italic_S</annotation></semantics></math>) and vocabulary size (<math alttext="V" class="ltx_Math" display="inline" id="A1.SS2.p3.5.m5.1"><semantics id="A1.SS2.p3.5.m5.1a"><mi id="A1.SS2.p3.5.m5.1.1" xref="A1.SS2.p3.5.m5.1.1.cmml">V</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.p3.5.m5.1b"><ci id="A1.SS2.p3.5.m5.1.1.cmml" xref="A1.SS2.p3.5.m5.1.1">𝑉</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p3.5.m5.1c">V</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p3.5.m5.1d">italic_V</annotation></semantics></math>) are consistent across the dense baseline, router, and expert models. Finally, we denote <math alttext="E" class="ltx_Math" display="inline" id="A1.SS2.p3.6.m6.1"><semantics id="A1.SS2.p3.6.m6.1a"><mi id="A1.SS2.p3.6.m6.1.1" xref="A1.SS2.p3.6.m6.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.p3.6.m6.1b"><ci id="A1.SS2.p3.6.m6.1.1.cmml" xref="A1.SS2.p3.6.m6.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p3.6.m6.1c">E</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p3.6.m6.1d">italic_E</annotation></semantics></math> as the number of experts (routers).</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_subsection" id="A1.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.3 </span>Computational Cost</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<section class="ltx_subsubsection" id="A1.SS3.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">A.3.1 </span>Transformer</h4><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="A1.SS3.SSS1.p1">
<p class="ltx_p" id="A1.SS3.SSS1.p1.1">To estimate the computational cost of Transformer model during training and inference, we calculated the total floating-point operations (FLOPs) based on the model’s architectural parameters.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="A1.SS3.SSS1.p2">
<p class="ltx_p" id="A1.SS3.SSS1.p2.1">For <span class="ltx_text ltx_font_bold" id="A1.SS3.SSS1.p2.1.1">training</span>, we computed the FLOPs per training step by summing the contributions from the embedding layer, multi-head attention (MHA), feedforward layers (FFN), and the output projection layer. The calculations are as follows:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="A1.SS3.SSS1.p3">
<ul class="ltx_itemize" id="A1.I3">
<li class="ltx_item" id="A1.I3.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para ltx_noindent" id="A1.I3.i1.p1">
<p class="ltx_p" id="A1.I3.i1.p1.1"><span class="ltx_text ltx_font_bold" id="A1.I3.i1.p1.1.1">Embedding Layer:</span> Although embeddings are typically implemented as lookups with negligible computational cost, for completeness, we estimate the FLOPs as:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equation ltx_eqn_table" id="A1.Ex1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\text{FLOPs}_{\text{emb}}=B\times S\times H" class="ltx_Math" display="block" id="A1.Ex1.m1.1"><semantics id="A1.Ex1.m1.1a"><mrow id="A1.Ex1.m1.1.1" xref="A1.Ex1.m1.1.1.cmml"><msub id="A1.Ex1.m1.1.1.2" xref="A1.Ex1.m1.1.1.2.cmml"><mtext id="A1.Ex1.m1.1.1.2.2" xref="A1.Ex1.m1.1.1.2.2a.cmml">FLOPs</mtext><mtext id="A1.Ex1.m1.1.1.2.3" xref="A1.Ex1.m1.1.1.2.3a.cmml">emb</mtext></msub><mo id="A1.Ex1.m1.1.1.1" xref="A1.Ex1.m1.1.1.1.cmml">=</mo><mrow id="A1.Ex1.m1.1.1.3" xref="A1.Ex1.m1.1.1.3.cmml"><mi id="A1.Ex1.m1.1.1.3.2" xref="A1.Ex1.m1.1.1.3.2.cmml">B</mi><mo id="A1.Ex1.m1.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="A1.Ex1.m1.1.1.3.1.cmml">×</mo><mi id="A1.Ex1.m1.1.1.3.3" xref="A1.Ex1.m1.1.1.3.3.cmml">S</mi><mo id="A1.Ex1.m1.1.1.3.1a" lspace="0.222em" rspace="0.222em" xref="A1.Ex1.m1.1.1.3.1.cmml">×</mo><mi id="A1.Ex1.m1.1.1.3.4" xref="A1.Ex1.m1.1.1.3.4.cmml">H</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex1.m1.1b"><apply id="A1.Ex1.m1.1.1.cmml" xref="A1.Ex1.m1.1.1"><eq id="A1.Ex1.m1.1.1.1.cmml" xref="A1.Ex1.m1.1.1.1"></eq><apply id="A1.Ex1.m1.1.1.2.cmml" xref="A1.Ex1.m1.1.1.2"><csymbol cd="ambiguous" id="A1.Ex1.m1.1.1.2.1.cmml" xref="A1.Ex1.m1.1.1.2">subscript</csymbol><ci id="A1.Ex1.m1.1.1.2.2a.cmml" xref="A1.Ex1.m1.1.1.2.2"><mtext id="A1.Ex1.m1.1.1.2.2.cmml" xref="A1.Ex1.m1.1.1.2.2">FLOPs</mtext></ci><ci id="A1.Ex1.m1.1.1.2.3a.cmml" xref="A1.Ex1.m1.1.1.2.3"><mtext id="A1.Ex1.m1.1.1.2.3.cmml" mathsize="70%" xref="A1.Ex1.m1.1.1.2.3">emb</mtext></ci></apply><apply id="A1.Ex1.m1.1.1.3.cmml" xref="A1.Ex1.m1.1.1.3"><times id="A1.Ex1.m1.1.1.3.1.cmml" xref="A1.Ex1.m1.1.1.3.1"></times><ci id="A1.Ex1.m1.1.1.3.2.cmml" xref="A1.Ex1.m1.1.1.3.2">𝐵</ci><ci id="A1.Ex1.m1.1.1.3.3.cmml" xref="A1.Ex1.m1.1.1.3.3">𝑆</ci><ci id="A1.Ex1.m1.1.1.3.4.cmml" xref="A1.Ex1.m1.1.1.3.4">𝐻</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex1.m1.1c">\text{FLOPs}_{\text{emb}}=B\times S\times H</annotation><annotation encoding="application/x-llamapun" id="A1.Ex1.m1.1d">FLOPs start_POSTSUBSCRIPT emb end_POSTSUBSCRIPT = italic_B × italic_S × italic_H</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
</li>
<li class="ltx_item" id="A1.I3.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para ltx_noindent" id="A1.I3.i2.p1">
<p class="ltx_p" id="A1.I3.i2.p1.1"><span class="ltx_text ltx_font_bold" id="A1.I3.i2.p1.1.1">Multi-Head Attention (MHA):</span></p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<ol class="ltx_enumerate" id="A1.I3.i2.I1">
<li class="ltx_item" id="A1.I3.i2.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span>
<div class="ltx_para ltx_noindent" id="A1.I3.i2.I1.i1.p1">
<p class="ltx_p" id="A1.I3.i2.I1.i1.p1.1">Linear Projections (Queries, Keys, Values):</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equation ltx_eqn_table" id="A1.Ex2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\text{FLOPs}_{\text{proj}}=3\times 2\times B\times S\times H\times H=6\times B%
\times S\times H^{2}" class="ltx_Math" display="block" id="A1.Ex2.m1.1"><semantics id="A1.Ex2.m1.1a"><mrow id="A1.Ex2.m1.1.1" xref="A1.Ex2.m1.1.1.cmml"><msub id="A1.Ex2.m1.1.1.2" xref="A1.Ex2.m1.1.1.2.cmml"><mtext id="A1.Ex2.m1.1.1.2.2" xref="A1.Ex2.m1.1.1.2.2a.cmml">FLOPs</mtext><mtext id="A1.Ex2.m1.1.1.2.3" xref="A1.Ex2.m1.1.1.2.3a.cmml">proj</mtext></msub><mo id="A1.Ex2.m1.1.1.3" xref="A1.Ex2.m1.1.1.3.cmml">=</mo><mrow id="A1.Ex2.m1.1.1.4" xref="A1.Ex2.m1.1.1.4.cmml"><mn id="A1.Ex2.m1.1.1.4.2" xref="A1.Ex2.m1.1.1.4.2.cmml">3</mn><mo id="A1.Ex2.m1.1.1.4.1" lspace="0.222em" rspace="0.222em" xref="A1.Ex2.m1.1.1.4.1.cmml">×</mo><mn id="A1.Ex2.m1.1.1.4.3" xref="A1.Ex2.m1.1.1.4.3.cmml">2</mn><mo id="A1.Ex2.m1.1.1.4.1a" lspace="0.222em" rspace="0.222em" xref="A1.Ex2.m1.1.1.4.1.cmml">×</mo><mi id="A1.Ex2.m1.1.1.4.4" xref="A1.Ex2.m1.1.1.4.4.cmml">B</mi><mo id="A1.Ex2.m1.1.1.4.1b" lspace="0.222em" rspace="0.222em" xref="A1.Ex2.m1.1.1.4.1.cmml">×</mo><mi id="A1.Ex2.m1.1.1.4.5" xref="A1.Ex2.m1.1.1.4.5.cmml">S</mi><mo id="A1.Ex2.m1.1.1.4.1c" lspace="0.222em" rspace="0.222em" xref="A1.Ex2.m1.1.1.4.1.cmml">×</mo><mi id="A1.Ex2.m1.1.1.4.6" xref="A1.Ex2.m1.1.1.4.6.cmml">H</mi><mo id="A1.Ex2.m1.1.1.4.1d" lspace="0.222em" rspace="0.222em" xref="A1.Ex2.m1.1.1.4.1.cmml">×</mo><mi id="A1.Ex2.m1.1.1.4.7" xref="A1.Ex2.m1.1.1.4.7.cmml">H</mi></mrow><mo id="A1.Ex2.m1.1.1.5" xref="A1.Ex2.m1.1.1.5.cmml">=</mo><mrow id="A1.Ex2.m1.1.1.6" xref="A1.Ex2.m1.1.1.6.cmml"><mn id="A1.Ex2.m1.1.1.6.2" xref="A1.Ex2.m1.1.1.6.2.cmml">6</mn><mo id="A1.Ex2.m1.1.1.6.1" lspace="0.222em" rspace="0.222em" xref="A1.Ex2.m1.1.1.6.1.cmml">×</mo><mi id="A1.Ex2.m1.1.1.6.3" xref="A1.Ex2.m1.1.1.6.3.cmml">B</mi><mo id="A1.Ex2.m1.1.1.6.1a" lspace="0.222em" rspace="0.222em" xref="A1.Ex2.m1.1.1.6.1.cmml">×</mo><mi id="A1.Ex2.m1.1.1.6.4" xref="A1.Ex2.m1.1.1.6.4.cmml">S</mi><mo id="A1.Ex2.m1.1.1.6.1b" lspace="0.222em" rspace="0.222em" xref="A1.Ex2.m1.1.1.6.1.cmml">×</mo><msup id="A1.Ex2.m1.1.1.6.5" xref="A1.Ex2.m1.1.1.6.5.cmml"><mi id="A1.Ex2.m1.1.1.6.5.2" xref="A1.Ex2.m1.1.1.6.5.2.cmml">H</mi><mn id="A1.Ex2.m1.1.1.6.5.3" xref="A1.Ex2.m1.1.1.6.5.3.cmml">2</mn></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex2.m1.1b"><apply id="A1.Ex2.m1.1.1.cmml" xref="A1.Ex2.m1.1.1"><and id="A1.Ex2.m1.1.1a.cmml" xref="A1.Ex2.m1.1.1"></and><apply id="A1.Ex2.m1.1.1b.cmml" xref="A1.Ex2.m1.1.1"><eq id="A1.Ex2.m1.1.1.3.cmml" xref="A1.Ex2.m1.1.1.3"></eq><apply id="A1.Ex2.m1.1.1.2.cmml" xref="A1.Ex2.m1.1.1.2"><csymbol cd="ambiguous" id="A1.Ex2.m1.1.1.2.1.cmml" xref="A1.Ex2.m1.1.1.2">subscript</csymbol><ci id="A1.Ex2.m1.1.1.2.2a.cmml" xref="A1.Ex2.m1.1.1.2.2"><mtext id="A1.Ex2.m1.1.1.2.2.cmml" xref="A1.Ex2.m1.1.1.2.2">FLOPs</mtext></ci><ci id="A1.Ex2.m1.1.1.2.3a.cmml" xref="A1.Ex2.m1.1.1.2.3"><mtext id="A1.Ex2.m1.1.1.2.3.cmml" mathsize="70%" xref="A1.Ex2.m1.1.1.2.3">proj</mtext></ci></apply><apply id="A1.Ex2.m1.1.1.4.cmml" xref="A1.Ex2.m1.1.1.4"><times id="A1.Ex2.m1.1.1.4.1.cmml" xref="A1.Ex2.m1.1.1.4.1"></times><cn id="A1.Ex2.m1.1.1.4.2.cmml" type="integer" xref="A1.Ex2.m1.1.1.4.2">3</cn><cn id="A1.Ex2.m1.1.1.4.3.cmml" type="integer" xref="A1.Ex2.m1.1.1.4.3">2</cn><ci id="A1.Ex2.m1.1.1.4.4.cmml" xref="A1.Ex2.m1.1.1.4.4">𝐵</ci><ci id="A1.Ex2.m1.1.1.4.5.cmml" xref="A1.Ex2.m1.1.1.4.5">𝑆</ci><ci id="A1.Ex2.m1.1.1.4.6.cmml" xref="A1.Ex2.m1.1.1.4.6">𝐻</ci><ci id="A1.Ex2.m1.1.1.4.7.cmml" xref="A1.Ex2.m1.1.1.4.7">𝐻</ci></apply></apply><apply id="A1.Ex2.m1.1.1c.cmml" xref="A1.Ex2.m1.1.1"><eq id="A1.Ex2.m1.1.1.5.cmml" xref="A1.Ex2.m1.1.1.5"></eq><share href="https://arxiv.org/html/2410.03529v1#A1.Ex2.m1.1.1.4.cmml" id="A1.Ex2.m1.1.1d.cmml" xref="A1.Ex2.m1.1.1"></share><apply id="A1.Ex2.m1.1.1.6.cmml" xref="A1.Ex2.m1.1.1.6"><times id="A1.Ex2.m1.1.1.6.1.cmml" xref="A1.Ex2.m1.1.1.6.1"></times><cn id="A1.Ex2.m1.1.1.6.2.cmml" type="integer" xref="A1.Ex2.m1.1.1.6.2">6</cn><ci id="A1.Ex2.m1.1.1.6.3.cmml" xref="A1.Ex2.m1.1.1.6.3">𝐵</ci><ci id="A1.Ex2.m1.1.1.6.4.cmml" xref="A1.Ex2.m1.1.1.6.4">𝑆</ci><apply id="A1.Ex2.m1.1.1.6.5.cmml" xref="A1.Ex2.m1.1.1.6.5"><csymbol cd="ambiguous" id="A1.Ex2.m1.1.1.6.5.1.cmml" xref="A1.Ex2.m1.1.1.6.5">superscript</csymbol><ci id="A1.Ex2.m1.1.1.6.5.2.cmml" xref="A1.Ex2.m1.1.1.6.5.2">𝐻</ci><cn id="A1.Ex2.m1.1.1.6.5.3.cmml" type="integer" xref="A1.Ex2.m1.1.1.6.5.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex2.m1.1c">\text{FLOPs}_{\text{proj}}=3\times 2\times B\times S\times H\times H=6\times B%
\times S\times H^{2}</annotation><annotation encoding="application/x-llamapun" id="A1.Ex2.m1.1d">FLOPs start_POSTSUBSCRIPT proj end_POSTSUBSCRIPT = 3 × 2 × italic_B × italic_S × italic_H × italic_H = 6 × italic_B × italic_S × italic_H start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
</li>
<li class="ltx_item" id="A1.I3.i2.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span>
<div class="ltx_para" id="A1.I3.i2.I1.i2.p1">
<p class="ltx_p" id="A1.I3.i2.I1.i2.p1.1">Scaled Dot-Product Attention:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equation ltx_eqn_table" id="A1.Ex3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\text{FLOPs}_{\text{attn}}=\text{FLOPs}_{\text{QK}}+\text{FLOPs}_{\text{V}}=2%
\times B\times S^{2}\times H+2\times B\times S^{2}\times H=4\times B\times S^{%
2}\times H" class="ltx_Math" display="block" id="A1.Ex3.m1.1"><semantics id="A1.Ex3.m1.1a"><mrow id="A1.Ex3.m1.1.1" xref="A1.Ex3.m1.1.1.cmml"><msub id="A1.Ex3.m1.1.1.2" xref="A1.Ex3.m1.1.1.2.cmml"><mtext id="A1.Ex3.m1.1.1.2.2" xref="A1.Ex3.m1.1.1.2.2a.cmml">FLOPs</mtext><mtext id="A1.Ex3.m1.1.1.2.3" xref="A1.Ex3.m1.1.1.2.3a.cmml">attn</mtext></msub><mo id="A1.Ex3.m1.1.1.3" xref="A1.Ex3.m1.1.1.3.cmml">=</mo><mrow id="A1.Ex3.m1.1.1.4" xref="A1.Ex3.m1.1.1.4.cmml"><msub id="A1.Ex3.m1.1.1.4.2" xref="A1.Ex3.m1.1.1.4.2.cmml"><mtext id="A1.Ex3.m1.1.1.4.2.2" xref="A1.Ex3.m1.1.1.4.2.2a.cmml">FLOPs</mtext><mtext id="A1.Ex3.m1.1.1.4.2.3" xref="A1.Ex3.m1.1.1.4.2.3a.cmml">QK</mtext></msub><mo id="A1.Ex3.m1.1.1.4.1" xref="A1.Ex3.m1.1.1.4.1.cmml">+</mo><msub id="A1.Ex3.m1.1.1.4.3" xref="A1.Ex3.m1.1.1.4.3.cmml"><mtext id="A1.Ex3.m1.1.1.4.3.2" xref="A1.Ex3.m1.1.1.4.3.2a.cmml">FLOPs</mtext><mtext id="A1.Ex3.m1.1.1.4.3.3" xref="A1.Ex3.m1.1.1.4.3.3a.cmml">V</mtext></msub></mrow><mo id="A1.Ex3.m1.1.1.5" xref="A1.Ex3.m1.1.1.5.cmml">=</mo><mrow id="A1.Ex3.m1.1.1.6" xref="A1.Ex3.m1.1.1.6.cmml"><mrow id="A1.Ex3.m1.1.1.6.2" xref="A1.Ex3.m1.1.1.6.2.cmml"><mn id="A1.Ex3.m1.1.1.6.2.2" xref="A1.Ex3.m1.1.1.6.2.2.cmml">2</mn><mo id="A1.Ex3.m1.1.1.6.2.1" lspace="0.222em" rspace="0.222em" xref="A1.Ex3.m1.1.1.6.2.1.cmml">×</mo><mi id="A1.Ex3.m1.1.1.6.2.3" xref="A1.Ex3.m1.1.1.6.2.3.cmml">B</mi><mo id="A1.Ex3.m1.1.1.6.2.1a" lspace="0.222em" rspace="0.222em" xref="A1.Ex3.m1.1.1.6.2.1.cmml">×</mo><msup id="A1.Ex3.m1.1.1.6.2.4" xref="A1.Ex3.m1.1.1.6.2.4.cmml"><mi id="A1.Ex3.m1.1.1.6.2.4.2" xref="A1.Ex3.m1.1.1.6.2.4.2.cmml">S</mi><mn id="A1.Ex3.m1.1.1.6.2.4.3" xref="A1.Ex3.m1.1.1.6.2.4.3.cmml">2</mn></msup><mo id="A1.Ex3.m1.1.1.6.2.1b" lspace="0.222em" rspace="0.222em" xref="A1.Ex3.m1.1.1.6.2.1.cmml">×</mo><mi id="A1.Ex3.m1.1.1.6.2.5" xref="A1.Ex3.m1.1.1.6.2.5.cmml">H</mi></mrow><mo id="A1.Ex3.m1.1.1.6.1" xref="A1.Ex3.m1.1.1.6.1.cmml">+</mo><mrow id="A1.Ex3.m1.1.1.6.3" xref="A1.Ex3.m1.1.1.6.3.cmml"><mn id="A1.Ex3.m1.1.1.6.3.2" xref="A1.Ex3.m1.1.1.6.3.2.cmml">2</mn><mo id="A1.Ex3.m1.1.1.6.3.1" lspace="0.222em" rspace="0.222em" xref="A1.Ex3.m1.1.1.6.3.1.cmml">×</mo><mi id="A1.Ex3.m1.1.1.6.3.3" xref="A1.Ex3.m1.1.1.6.3.3.cmml">B</mi><mo id="A1.Ex3.m1.1.1.6.3.1a" lspace="0.222em" rspace="0.222em" xref="A1.Ex3.m1.1.1.6.3.1.cmml">×</mo><msup id="A1.Ex3.m1.1.1.6.3.4" xref="A1.Ex3.m1.1.1.6.3.4.cmml"><mi id="A1.Ex3.m1.1.1.6.3.4.2" xref="A1.Ex3.m1.1.1.6.3.4.2.cmml">S</mi><mn id="A1.Ex3.m1.1.1.6.3.4.3" xref="A1.Ex3.m1.1.1.6.3.4.3.cmml">2</mn></msup><mo id="A1.Ex3.m1.1.1.6.3.1b" lspace="0.222em" rspace="0.222em" xref="A1.Ex3.m1.1.1.6.3.1.cmml">×</mo><mi id="A1.Ex3.m1.1.1.6.3.5" xref="A1.Ex3.m1.1.1.6.3.5.cmml">H</mi></mrow></mrow><mo id="A1.Ex3.m1.1.1.7" xref="A1.Ex3.m1.1.1.7.cmml">=</mo><mrow id="A1.Ex3.m1.1.1.8" xref="A1.Ex3.m1.1.1.8.cmml"><mn id="A1.Ex3.m1.1.1.8.2" xref="A1.Ex3.m1.1.1.8.2.cmml">4</mn><mo id="A1.Ex3.m1.1.1.8.1" lspace="0.222em" rspace="0.222em" xref="A1.Ex3.m1.1.1.8.1.cmml">×</mo><mi id="A1.Ex3.m1.1.1.8.3" xref="A1.Ex3.m1.1.1.8.3.cmml">B</mi><mo id="A1.Ex3.m1.1.1.8.1a" lspace="0.222em" rspace="0.222em" xref="A1.Ex3.m1.1.1.8.1.cmml">×</mo><msup id="A1.Ex3.m1.1.1.8.4" xref="A1.Ex3.m1.1.1.8.4.cmml"><mi id="A1.Ex3.m1.1.1.8.4.2" xref="A1.Ex3.m1.1.1.8.4.2.cmml">S</mi><mn id="A1.Ex3.m1.1.1.8.4.3" xref="A1.Ex3.m1.1.1.8.4.3.cmml">2</mn></msup><mo id="A1.Ex3.m1.1.1.8.1b" lspace="0.222em" rspace="0.222em" xref="A1.Ex3.m1.1.1.8.1.cmml">×</mo><mi id="A1.Ex3.m1.1.1.8.5" xref="A1.Ex3.m1.1.1.8.5.cmml">H</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex3.m1.1b"><apply id="A1.Ex3.m1.1.1.cmml" xref="A1.Ex3.m1.1.1"><and id="A1.Ex3.m1.1.1a.cmml" xref="A1.Ex3.m1.1.1"></and><apply id="A1.Ex3.m1.1.1b.cmml" xref="A1.Ex3.m1.1.1"><eq id="A1.Ex3.m1.1.1.3.cmml" xref="A1.Ex3.m1.1.1.3"></eq><apply id="A1.Ex3.m1.1.1.2.cmml" xref="A1.Ex3.m1.1.1.2"><csymbol cd="ambiguous" id="A1.Ex3.m1.1.1.2.1.cmml" xref="A1.Ex3.m1.1.1.2">subscript</csymbol><ci id="A1.Ex3.m1.1.1.2.2a.cmml" xref="A1.Ex3.m1.1.1.2.2"><mtext id="A1.Ex3.m1.1.1.2.2.cmml" xref="A1.Ex3.m1.1.1.2.2">FLOPs</mtext></ci><ci id="A1.Ex3.m1.1.1.2.3a.cmml" xref="A1.Ex3.m1.1.1.2.3"><mtext id="A1.Ex3.m1.1.1.2.3.cmml" mathsize="70%" xref="A1.Ex3.m1.1.1.2.3">attn</mtext></ci></apply><apply id="A1.Ex3.m1.1.1.4.cmml" xref="A1.Ex3.m1.1.1.4"><plus id="A1.Ex3.m1.1.1.4.1.cmml" xref="A1.Ex3.m1.1.1.4.1"></plus><apply id="A1.Ex3.m1.1.1.4.2.cmml" xref="A1.Ex3.m1.1.1.4.2"><csymbol cd="ambiguous" id="A1.Ex3.m1.1.1.4.2.1.cmml" xref="A1.Ex3.m1.1.1.4.2">subscript</csymbol><ci id="A1.Ex3.m1.1.1.4.2.2a.cmml" xref="A1.Ex3.m1.1.1.4.2.2"><mtext id="A1.Ex3.m1.1.1.4.2.2.cmml" xref="A1.Ex3.m1.1.1.4.2.2">FLOPs</mtext></ci><ci id="A1.Ex3.m1.1.1.4.2.3a.cmml" xref="A1.Ex3.m1.1.1.4.2.3"><mtext id="A1.Ex3.m1.1.1.4.2.3.cmml" mathsize="70%" xref="A1.Ex3.m1.1.1.4.2.3">QK</mtext></ci></apply><apply id="A1.Ex3.m1.1.1.4.3.cmml" xref="A1.Ex3.m1.1.1.4.3"><csymbol cd="ambiguous" id="A1.Ex3.m1.1.1.4.3.1.cmml" xref="A1.Ex3.m1.1.1.4.3">subscript</csymbol><ci id="A1.Ex3.m1.1.1.4.3.2a.cmml" xref="A1.Ex3.m1.1.1.4.3.2"><mtext id="A1.Ex3.m1.1.1.4.3.2.cmml" xref="A1.Ex3.m1.1.1.4.3.2">FLOPs</mtext></ci><ci id="A1.Ex3.m1.1.1.4.3.3a.cmml" xref="A1.Ex3.m1.1.1.4.3.3"><mtext id="A1.Ex3.m1.1.1.4.3.3.cmml" mathsize="70%" xref="A1.Ex3.m1.1.1.4.3.3">V</mtext></ci></apply></apply></apply><apply id="A1.Ex3.m1.1.1c.cmml" xref="A1.Ex3.m1.1.1"><eq id="A1.Ex3.m1.1.1.5.cmml" xref="A1.Ex3.m1.1.1.5"></eq><share href="https://arxiv.org/html/2410.03529v1#A1.Ex3.m1.1.1.4.cmml" id="A1.Ex3.m1.1.1d.cmml" xref="A1.Ex3.m1.1.1"></share><apply id="A1.Ex3.m1.1.1.6.cmml" xref="A1.Ex3.m1.1.1.6"><plus id="A1.Ex3.m1.1.1.6.1.cmml" xref="A1.Ex3.m1.1.1.6.1"></plus><apply id="A1.Ex3.m1.1.1.6.2.cmml" xref="A1.Ex3.m1.1.1.6.2"><times id="A1.Ex3.m1.1.1.6.2.1.cmml" xref="A1.Ex3.m1.1.1.6.2.1"></times><cn id="A1.Ex3.m1.1.1.6.2.2.cmml" type="integer" xref="A1.Ex3.m1.1.1.6.2.2">2</cn><ci id="A1.Ex3.m1.1.1.6.2.3.cmml" xref="A1.Ex3.m1.1.1.6.2.3">𝐵</ci><apply id="A1.Ex3.m1.1.1.6.2.4.cmml" xref="A1.Ex3.m1.1.1.6.2.4"><csymbol cd="ambiguous" id="A1.Ex3.m1.1.1.6.2.4.1.cmml" xref="A1.Ex3.m1.1.1.6.2.4">superscript</csymbol><ci id="A1.Ex3.m1.1.1.6.2.4.2.cmml" xref="A1.Ex3.m1.1.1.6.2.4.2">𝑆</ci><cn id="A1.Ex3.m1.1.1.6.2.4.3.cmml" type="integer" xref="A1.Ex3.m1.1.1.6.2.4.3">2</cn></apply><ci id="A1.Ex3.m1.1.1.6.2.5.cmml" xref="A1.Ex3.m1.1.1.6.2.5">𝐻</ci></apply><apply id="A1.Ex3.m1.1.1.6.3.cmml" xref="A1.Ex3.m1.1.1.6.3"><times id="A1.Ex3.m1.1.1.6.3.1.cmml" xref="A1.Ex3.m1.1.1.6.3.1"></times><cn id="A1.Ex3.m1.1.1.6.3.2.cmml" type="integer" xref="A1.Ex3.m1.1.1.6.3.2">2</cn><ci id="A1.Ex3.m1.1.1.6.3.3.cmml" xref="A1.Ex3.m1.1.1.6.3.3">𝐵</ci><apply id="A1.Ex3.m1.1.1.6.3.4.cmml" xref="A1.Ex3.m1.1.1.6.3.4"><csymbol cd="ambiguous" id="A1.Ex3.m1.1.1.6.3.4.1.cmml" xref="A1.Ex3.m1.1.1.6.3.4">superscript</csymbol><ci id="A1.Ex3.m1.1.1.6.3.4.2.cmml" xref="A1.Ex3.m1.1.1.6.3.4.2">𝑆</ci><cn id="A1.Ex3.m1.1.1.6.3.4.3.cmml" type="integer" xref="A1.Ex3.m1.1.1.6.3.4.3">2</cn></apply><ci id="A1.Ex3.m1.1.1.6.3.5.cmml" xref="A1.Ex3.m1.1.1.6.3.5">𝐻</ci></apply></apply></apply><apply id="A1.Ex3.m1.1.1e.cmml" xref="A1.Ex3.m1.1.1"><eq id="A1.Ex3.m1.1.1.7.cmml" xref="A1.Ex3.m1.1.1.7"></eq><share href="https://arxiv.org/html/2410.03529v1#A1.Ex3.m1.1.1.6.cmml" id="A1.Ex3.m1.1.1f.cmml" xref="A1.Ex3.m1.1.1"></share><apply id="A1.Ex3.m1.1.1.8.cmml" xref="A1.Ex3.m1.1.1.8"><times id="A1.Ex3.m1.1.1.8.1.cmml" xref="A1.Ex3.m1.1.1.8.1"></times><cn id="A1.Ex3.m1.1.1.8.2.cmml" type="integer" xref="A1.Ex3.m1.1.1.8.2">4</cn><ci id="A1.Ex3.m1.1.1.8.3.cmml" xref="A1.Ex3.m1.1.1.8.3">𝐵</ci><apply id="A1.Ex3.m1.1.1.8.4.cmml" xref="A1.Ex3.m1.1.1.8.4"><csymbol cd="ambiguous" id="A1.Ex3.m1.1.1.8.4.1.cmml" xref="A1.Ex3.m1.1.1.8.4">superscript</csymbol><ci id="A1.Ex3.m1.1.1.8.4.2.cmml" xref="A1.Ex3.m1.1.1.8.4.2">𝑆</ci><cn id="A1.Ex3.m1.1.1.8.4.3.cmml" type="integer" xref="A1.Ex3.m1.1.1.8.4.3">2</cn></apply><ci id="A1.Ex3.m1.1.1.8.5.cmml" xref="A1.Ex3.m1.1.1.8.5">𝐻</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex3.m1.1c">\text{FLOPs}_{\text{attn}}=\text{FLOPs}_{\text{QK}}+\text{FLOPs}_{\text{V}}=2%
\times B\times S^{2}\times H+2\times B\times S^{2}\times H=4\times B\times S^{%
2}\times H</annotation><annotation encoding="application/x-llamapun" id="A1.Ex3.m1.1d">FLOPs start_POSTSUBSCRIPT attn end_POSTSUBSCRIPT = FLOPs start_POSTSUBSCRIPT QK end_POSTSUBSCRIPT + FLOPs start_POSTSUBSCRIPT V end_POSTSUBSCRIPT = 2 × italic_B × italic_S start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT × italic_H + 2 × italic_B × italic_S start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT × italic_H = 4 × italic_B × italic_S start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT × italic_H</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
</li>
<li class="ltx_item" id="A1.I3.i2.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">3.</span>
<div class="ltx_para ltx_noindent" id="A1.I3.i2.I1.i3.p1">
<p class="ltx_p" id="A1.I3.i2.I1.i3.p1.1">Output Projection:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equation ltx_eqn_table" id="A1.Ex4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\text{FLOPs}_{\text{out\_proj}}=2\times B\times S\times H\times H" class="ltx_Math" display="block" id="A1.Ex4.m1.1"><semantics id="A1.Ex4.m1.1a"><mrow id="A1.Ex4.m1.1.1" xref="A1.Ex4.m1.1.1.cmml"><msub id="A1.Ex4.m1.1.1.2" xref="A1.Ex4.m1.1.1.2.cmml"><mtext id="A1.Ex4.m1.1.1.2.2" xref="A1.Ex4.m1.1.1.2.2a.cmml">FLOPs</mtext><mtext id="A1.Ex4.m1.1.1.2.3" xref="A1.Ex4.m1.1.1.2.3a.cmml">out_proj</mtext></msub><mo id="A1.Ex4.m1.1.1.1" xref="A1.Ex4.m1.1.1.1.cmml">=</mo><mrow id="A1.Ex4.m1.1.1.3" xref="A1.Ex4.m1.1.1.3.cmml"><mn id="A1.Ex4.m1.1.1.3.2" xref="A1.Ex4.m1.1.1.3.2.cmml">2</mn><mo id="A1.Ex4.m1.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="A1.Ex4.m1.1.1.3.1.cmml">×</mo><mi id="A1.Ex4.m1.1.1.3.3" xref="A1.Ex4.m1.1.1.3.3.cmml">B</mi><mo id="A1.Ex4.m1.1.1.3.1a" lspace="0.222em" rspace="0.222em" xref="A1.Ex4.m1.1.1.3.1.cmml">×</mo><mi id="A1.Ex4.m1.1.1.3.4" xref="A1.Ex4.m1.1.1.3.4.cmml">S</mi><mo id="A1.Ex4.m1.1.1.3.1b" lspace="0.222em" rspace="0.222em" xref="A1.Ex4.m1.1.1.3.1.cmml">×</mo><mi id="A1.Ex4.m1.1.1.3.5" xref="A1.Ex4.m1.1.1.3.5.cmml">H</mi><mo id="A1.Ex4.m1.1.1.3.1c" lspace="0.222em" rspace="0.222em" xref="A1.Ex4.m1.1.1.3.1.cmml">×</mo><mi id="A1.Ex4.m1.1.1.3.6" xref="A1.Ex4.m1.1.1.3.6.cmml">H</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex4.m1.1b"><apply id="A1.Ex4.m1.1.1.cmml" xref="A1.Ex4.m1.1.1"><eq id="A1.Ex4.m1.1.1.1.cmml" xref="A1.Ex4.m1.1.1.1"></eq><apply id="A1.Ex4.m1.1.1.2.cmml" xref="A1.Ex4.m1.1.1.2"><csymbol cd="ambiguous" id="A1.Ex4.m1.1.1.2.1.cmml" xref="A1.Ex4.m1.1.1.2">subscript</csymbol><ci id="A1.Ex4.m1.1.1.2.2a.cmml" xref="A1.Ex4.m1.1.1.2.2"><mtext id="A1.Ex4.m1.1.1.2.2.cmml" xref="A1.Ex4.m1.1.1.2.2">FLOPs</mtext></ci><ci id="A1.Ex4.m1.1.1.2.3a.cmml" xref="A1.Ex4.m1.1.1.2.3"><mtext id="A1.Ex4.m1.1.1.2.3.cmml" mathsize="70%" xref="A1.Ex4.m1.1.1.2.3">out_proj</mtext></ci></apply><apply id="A1.Ex4.m1.1.1.3.cmml" xref="A1.Ex4.m1.1.1.3"><times id="A1.Ex4.m1.1.1.3.1.cmml" xref="A1.Ex4.m1.1.1.3.1"></times><cn id="A1.Ex4.m1.1.1.3.2.cmml" type="integer" xref="A1.Ex4.m1.1.1.3.2">2</cn><ci id="A1.Ex4.m1.1.1.3.3.cmml" xref="A1.Ex4.m1.1.1.3.3">𝐵</ci><ci id="A1.Ex4.m1.1.1.3.4.cmml" xref="A1.Ex4.m1.1.1.3.4">𝑆</ci><ci id="A1.Ex4.m1.1.1.3.5.cmml" xref="A1.Ex4.m1.1.1.3.5">𝐻</ci><ci id="A1.Ex4.m1.1.1.3.6.cmml" xref="A1.Ex4.m1.1.1.3.6">𝐻</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex4.m1.1c">\text{FLOPs}_{\text{out\_proj}}=2\times B\times S\times H\times H</annotation><annotation encoding="application/x-llamapun" id="A1.Ex4.m1.1d">FLOPs start_POSTSUBSCRIPT out_proj end_POSTSUBSCRIPT = 2 × italic_B × italic_S × italic_H × italic_H</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
</li>
</ol>
</div>
<div class="ltx_para ltx_noindent" id="A1.I3.i2.p2">
<p class="ltx_p" id="A1.I3.i2.p2.1">Total Multi-Head Attention (MHA):</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A3.EGx2">
<tbody id="A1.Ex5"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\text{FLOPs}_{\text{MHA}}" class="ltx_Math" display="inline" id="A1.Ex5.m1.1"><semantics id="A1.Ex5.m1.1a"><msub id="A1.Ex5.m1.1.1" xref="A1.Ex5.m1.1.1.cmml"><mtext id="A1.Ex5.m1.1.1.2" xref="A1.Ex5.m1.1.1.2a.cmml">FLOPs</mtext><mtext id="A1.Ex5.m1.1.1.3" xref="A1.Ex5.m1.1.1.3a.cmml">MHA</mtext></msub><annotation-xml encoding="MathML-Content" id="A1.Ex5.m1.1b"><apply id="A1.Ex5.m1.1.1.cmml" xref="A1.Ex5.m1.1.1"><csymbol cd="ambiguous" id="A1.Ex5.m1.1.1.1.cmml" xref="A1.Ex5.m1.1.1">subscript</csymbol><ci id="A1.Ex5.m1.1.1.2a.cmml" xref="A1.Ex5.m1.1.1.2"><mtext id="A1.Ex5.m1.1.1.2.cmml" xref="A1.Ex5.m1.1.1.2">FLOPs</mtext></ci><ci id="A1.Ex5.m1.1.1.3a.cmml" xref="A1.Ex5.m1.1.1.3"><mtext id="A1.Ex5.m1.1.1.3.cmml" mathsize="70%" xref="A1.Ex5.m1.1.1.3">MHA</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex5.m1.1c">\displaystyle\text{FLOPs}_{\text{MHA}}</annotation><annotation encoding="application/x-llamapun" id="A1.Ex5.m1.1d">FLOPs start_POSTSUBSCRIPT MHA end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\text{FLOPs}_{\text{proj}}+\text{FLOPs}_{\text{attn}}+\text{%
FLOPs}_{\text{out\_proj}}" class="ltx_Math" display="inline" id="A1.Ex5.m2.1"><semantics id="A1.Ex5.m2.1a"><mrow id="A1.Ex5.m2.1.1" xref="A1.Ex5.m2.1.1.cmml"><mi id="A1.Ex5.m2.1.1.2" xref="A1.Ex5.m2.1.1.2.cmml"></mi><mo id="A1.Ex5.m2.1.1.1" xref="A1.Ex5.m2.1.1.1.cmml">=</mo><mrow id="A1.Ex5.m2.1.1.3" xref="A1.Ex5.m2.1.1.3.cmml"><msub id="A1.Ex5.m2.1.1.3.2" xref="A1.Ex5.m2.1.1.3.2.cmml"><mtext id="A1.Ex5.m2.1.1.3.2.2" xref="A1.Ex5.m2.1.1.3.2.2a.cmml">FLOPs</mtext><mtext id="A1.Ex5.m2.1.1.3.2.3" xref="A1.Ex5.m2.1.1.3.2.3a.cmml">proj</mtext></msub><mo id="A1.Ex5.m2.1.1.3.1" xref="A1.Ex5.m2.1.1.3.1.cmml">+</mo><msub id="A1.Ex5.m2.1.1.3.3" xref="A1.Ex5.m2.1.1.3.3.cmml"><mtext id="A1.Ex5.m2.1.1.3.3.2" xref="A1.Ex5.m2.1.1.3.3.2a.cmml">FLOPs</mtext><mtext id="A1.Ex5.m2.1.1.3.3.3" xref="A1.Ex5.m2.1.1.3.3.3a.cmml">attn</mtext></msub><mo id="A1.Ex5.m2.1.1.3.1a" xref="A1.Ex5.m2.1.1.3.1.cmml">+</mo><msub id="A1.Ex5.m2.1.1.3.4" xref="A1.Ex5.m2.1.1.3.4.cmml"><mtext id="A1.Ex5.m2.1.1.3.4.2" xref="A1.Ex5.m2.1.1.3.4.2a.cmml">FLOPs</mtext><mtext id="A1.Ex5.m2.1.1.3.4.3" xref="A1.Ex5.m2.1.1.3.4.3a.cmml">out_proj</mtext></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex5.m2.1b"><apply id="A1.Ex5.m2.1.1.cmml" xref="A1.Ex5.m2.1.1"><eq id="A1.Ex5.m2.1.1.1.cmml" xref="A1.Ex5.m2.1.1.1"></eq><csymbol cd="latexml" id="A1.Ex5.m2.1.1.2.cmml" xref="A1.Ex5.m2.1.1.2">absent</csymbol><apply id="A1.Ex5.m2.1.1.3.cmml" xref="A1.Ex5.m2.1.1.3"><plus id="A1.Ex5.m2.1.1.3.1.cmml" xref="A1.Ex5.m2.1.1.3.1"></plus><apply id="A1.Ex5.m2.1.1.3.2.cmml" xref="A1.Ex5.m2.1.1.3.2"><csymbol cd="ambiguous" id="A1.Ex5.m2.1.1.3.2.1.cmml" xref="A1.Ex5.m2.1.1.3.2">subscript</csymbol><ci id="A1.Ex5.m2.1.1.3.2.2a.cmml" xref="A1.Ex5.m2.1.1.3.2.2"><mtext id="A1.Ex5.m2.1.1.3.2.2.cmml" xref="A1.Ex5.m2.1.1.3.2.2">FLOPs</mtext></ci><ci id="A1.Ex5.m2.1.1.3.2.3a.cmml" xref="A1.Ex5.m2.1.1.3.2.3"><mtext id="A1.Ex5.m2.1.1.3.2.3.cmml" mathsize="70%" xref="A1.Ex5.m2.1.1.3.2.3">proj</mtext></ci></apply><apply id="A1.Ex5.m2.1.1.3.3.cmml" xref="A1.Ex5.m2.1.1.3.3"><csymbol cd="ambiguous" id="A1.Ex5.m2.1.1.3.3.1.cmml" xref="A1.Ex5.m2.1.1.3.3">subscript</csymbol><ci id="A1.Ex5.m2.1.1.3.3.2a.cmml" xref="A1.Ex5.m2.1.1.3.3.2"><mtext id="A1.Ex5.m2.1.1.3.3.2.cmml" xref="A1.Ex5.m2.1.1.3.3.2">FLOPs</mtext></ci><ci id="A1.Ex5.m2.1.1.3.3.3a.cmml" xref="A1.Ex5.m2.1.1.3.3.3"><mtext id="A1.Ex5.m2.1.1.3.3.3.cmml" mathsize="70%" xref="A1.Ex5.m2.1.1.3.3.3">attn</mtext></ci></apply><apply id="A1.Ex5.m2.1.1.3.4.cmml" xref="A1.Ex5.m2.1.1.3.4"><csymbol cd="ambiguous" id="A1.Ex5.m2.1.1.3.4.1.cmml" xref="A1.Ex5.m2.1.1.3.4">subscript</csymbol><ci id="A1.Ex5.m2.1.1.3.4.2a.cmml" xref="A1.Ex5.m2.1.1.3.4.2"><mtext id="A1.Ex5.m2.1.1.3.4.2.cmml" xref="A1.Ex5.m2.1.1.3.4.2">FLOPs</mtext></ci><ci id="A1.Ex5.m2.1.1.3.4.3a.cmml" xref="A1.Ex5.m2.1.1.3.4.3"><mtext id="A1.Ex5.m2.1.1.3.4.3.cmml" mathsize="70%" xref="A1.Ex5.m2.1.1.3.4.3">out_proj</mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex5.m2.1c">\displaystyle=\text{FLOPs}_{\text{proj}}+\text{FLOPs}_{\text{attn}}+\text{%
FLOPs}_{\text{out\_proj}}</annotation><annotation encoding="application/x-llamapun" id="A1.Ex5.m2.1d">= FLOPs start_POSTSUBSCRIPT proj end_POSTSUBSCRIPT + FLOPs start_POSTSUBSCRIPT attn end_POSTSUBSCRIPT + FLOPs start_POSTSUBSCRIPT out_proj end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A1.Ex6"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=6\times B\times S\times H^{2}+4\times B\times S^{2}\times H+2%
\times B\times S\times H^{2}" class="ltx_Math" display="inline" id="A1.Ex6.m1.1"><semantics id="A1.Ex6.m1.1a"><mrow id="A1.Ex6.m1.1.1" xref="A1.Ex6.m1.1.1.cmml"><mi id="A1.Ex6.m1.1.1.2" xref="A1.Ex6.m1.1.1.2.cmml"></mi><mo id="A1.Ex6.m1.1.1.1" xref="A1.Ex6.m1.1.1.1.cmml">=</mo><mrow id="A1.Ex6.m1.1.1.3" xref="A1.Ex6.m1.1.1.3.cmml"><mrow id="A1.Ex6.m1.1.1.3.2" xref="A1.Ex6.m1.1.1.3.2.cmml"><mn id="A1.Ex6.m1.1.1.3.2.2" xref="A1.Ex6.m1.1.1.3.2.2.cmml">6</mn><mo id="A1.Ex6.m1.1.1.3.2.1" lspace="0.222em" rspace="0.222em" xref="A1.Ex6.m1.1.1.3.2.1.cmml">×</mo><mi id="A1.Ex6.m1.1.1.3.2.3" xref="A1.Ex6.m1.1.1.3.2.3.cmml">B</mi><mo id="A1.Ex6.m1.1.1.3.2.1a" lspace="0.222em" rspace="0.222em" xref="A1.Ex6.m1.1.1.3.2.1.cmml">×</mo><mi id="A1.Ex6.m1.1.1.3.2.4" xref="A1.Ex6.m1.1.1.3.2.4.cmml">S</mi><mo id="A1.Ex6.m1.1.1.3.2.1b" lspace="0.222em" rspace="0.222em" xref="A1.Ex6.m1.1.1.3.2.1.cmml">×</mo><msup id="A1.Ex6.m1.1.1.3.2.5" xref="A1.Ex6.m1.1.1.3.2.5.cmml"><mi id="A1.Ex6.m1.1.1.3.2.5.2" xref="A1.Ex6.m1.1.1.3.2.5.2.cmml">H</mi><mn id="A1.Ex6.m1.1.1.3.2.5.3" xref="A1.Ex6.m1.1.1.3.2.5.3.cmml">2</mn></msup></mrow><mo id="A1.Ex6.m1.1.1.3.1" xref="A1.Ex6.m1.1.1.3.1.cmml">+</mo><mrow id="A1.Ex6.m1.1.1.3.3" xref="A1.Ex6.m1.1.1.3.3.cmml"><mn id="A1.Ex6.m1.1.1.3.3.2" xref="A1.Ex6.m1.1.1.3.3.2.cmml">4</mn><mo id="A1.Ex6.m1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="A1.Ex6.m1.1.1.3.3.1.cmml">×</mo><mi id="A1.Ex6.m1.1.1.3.3.3" xref="A1.Ex6.m1.1.1.3.3.3.cmml">B</mi><mo id="A1.Ex6.m1.1.1.3.3.1a" lspace="0.222em" rspace="0.222em" xref="A1.Ex6.m1.1.1.3.3.1.cmml">×</mo><msup id="A1.Ex6.m1.1.1.3.3.4" xref="A1.Ex6.m1.1.1.3.3.4.cmml"><mi id="A1.Ex6.m1.1.1.3.3.4.2" xref="A1.Ex6.m1.1.1.3.3.4.2.cmml">S</mi><mn id="A1.Ex6.m1.1.1.3.3.4.3" xref="A1.Ex6.m1.1.1.3.3.4.3.cmml">2</mn></msup><mo id="A1.Ex6.m1.1.1.3.3.1b" lspace="0.222em" rspace="0.222em" xref="A1.Ex6.m1.1.1.3.3.1.cmml">×</mo><mi id="A1.Ex6.m1.1.1.3.3.5" xref="A1.Ex6.m1.1.1.3.3.5.cmml">H</mi></mrow><mo id="A1.Ex6.m1.1.1.3.1a" xref="A1.Ex6.m1.1.1.3.1.cmml">+</mo><mrow id="A1.Ex6.m1.1.1.3.4" xref="A1.Ex6.m1.1.1.3.4.cmml"><mn id="A1.Ex6.m1.1.1.3.4.2" xref="A1.Ex6.m1.1.1.3.4.2.cmml">2</mn><mo id="A1.Ex6.m1.1.1.3.4.1" lspace="0.222em" rspace="0.222em" xref="A1.Ex6.m1.1.1.3.4.1.cmml">×</mo><mi id="A1.Ex6.m1.1.1.3.4.3" xref="A1.Ex6.m1.1.1.3.4.3.cmml">B</mi><mo id="A1.Ex6.m1.1.1.3.4.1a" lspace="0.222em" rspace="0.222em" xref="A1.Ex6.m1.1.1.3.4.1.cmml">×</mo><mi id="A1.Ex6.m1.1.1.3.4.4" xref="A1.Ex6.m1.1.1.3.4.4.cmml">S</mi><mo id="A1.Ex6.m1.1.1.3.4.1b" lspace="0.222em" rspace="0.222em" xref="A1.Ex6.m1.1.1.3.4.1.cmml">×</mo><msup id="A1.Ex6.m1.1.1.3.4.5" xref="A1.Ex6.m1.1.1.3.4.5.cmml"><mi id="A1.Ex6.m1.1.1.3.4.5.2" xref="A1.Ex6.m1.1.1.3.4.5.2.cmml">H</mi><mn id="A1.Ex6.m1.1.1.3.4.5.3" xref="A1.Ex6.m1.1.1.3.4.5.3.cmml">2</mn></msup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex6.m1.1b"><apply id="A1.Ex6.m1.1.1.cmml" xref="A1.Ex6.m1.1.1"><eq id="A1.Ex6.m1.1.1.1.cmml" xref="A1.Ex6.m1.1.1.1"></eq><csymbol cd="latexml" id="A1.Ex6.m1.1.1.2.cmml" xref="A1.Ex6.m1.1.1.2">absent</csymbol><apply id="A1.Ex6.m1.1.1.3.cmml" xref="A1.Ex6.m1.1.1.3"><plus id="A1.Ex6.m1.1.1.3.1.cmml" xref="A1.Ex6.m1.1.1.3.1"></plus><apply id="A1.Ex6.m1.1.1.3.2.cmml" xref="A1.Ex6.m1.1.1.3.2"><times id="A1.Ex6.m1.1.1.3.2.1.cmml" xref="A1.Ex6.m1.1.1.3.2.1"></times><cn id="A1.Ex6.m1.1.1.3.2.2.cmml" type="integer" xref="A1.Ex6.m1.1.1.3.2.2">6</cn><ci id="A1.Ex6.m1.1.1.3.2.3.cmml" xref="A1.Ex6.m1.1.1.3.2.3">𝐵</ci><ci id="A1.Ex6.m1.1.1.3.2.4.cmml" xref="A1.Ex6.m1.1.1.3.2.4">𝑆</ci><apply id="A1.Ex6.m1.1.1.3.2.5.cmml" xref="A1.Ex6.m1.1.1.3.2.5"><csymbol cd="ambiguous" id="A1.Ex6.m1.1.1.3.2.5.1.cmml" xref="A1.Ex6.m1.1.1.3.2.5">superscript</csymbol><ci id="A1.Ex6.m1.1.1.3.2.5.2.cmml" xref="A1.Ex6.m1.1.1.3.2.5.2">𝐻</ci><cn id="A1.Ex6.m1.1.1.3.2.5.3.cmml" type="integer" xref="A1.Ex6.m1.1.1.3.2.5.3">2</cn></apply></apply><apply id="A1.Ex6.m1.1.1.3.3.cmml" xref="A1.Ex6.m1.1.1.3.3"><times id="A1.Ex6.m1.1.1.3.3.1.cmml" xref="A1.Ex6.m1.1.1.3.3.1"></times><cn id="A1.Ex6.m1.1.1.3.3.2.cmml" type="integer" xref="A1.Ex6.m1.1.1.3.3.2">4</cn><ci id="A1.Ex6.m1.1.1.3.3.3.cmml" xref="A1.Ex6.m1.1.1.3.3.3">𝐵</ci><apply id="A1.Ex6.m1.1.1.3.3.4.cmml" xref="A1.Ex6.m1.1.1.3.3.4"><csymbol cd="ambiguous" id="A1.Ex6.m1.1.1.3.3.4.1.cmml" xref="A1.Ex6.m1.1.1.3.3.4">superscript</csymbol><ci id="A1.Ex6.m1.1.1.3.3.4.2.cmml" xref="A1.Ex6.m1.1.1.3.3.4.2">𝑆</ci><cn id="A1.Ex6.m1.1.1.3.3.4.3.cmml" type="integer" xref="A1.Ex6.m1.1.1.3.3.4.3">2</cn></apply><ci id="A1.Ex6.m1.1.1.3.3.5.cmml" xref="A1.Ex6.m1.1.1.3.3.5">𝐻</ci></apply><apply id="A1.Ex6.m1.1.1.3.4.cmml" xref="A1.Ex6.m1.1.1.3.4"><times id="A1.Ex6.m1.1.1.3.4.1.cmml" xref="A1.Ex6.m1.1.1.3.4.1"></times><cn id="A1.Ex6.m1.1.1.3.4.2.cmml" type="integer" xref="A1.Ex6.m1.1.1.3.4.2">2</cn><ci id="A1.Ex6.m1.1.1.3.4.3.cmml" xref="A1.Ex6.m1.1.1.3.4.3">𝐵</ci><ci id="A1.Ex6.m1.1.1.3.4.4.cmml" xref="A1.Ex6.m1.1.1.3.4.4">𝑆</ci><apply id="A1.Ex6.m1.1.1.3.4.5.cmml" xref="A1.Ex6.m1.1.1.3.4.5"><csymbol cd="ambiguous" id="A1.Ex6.m1.1.1.3.4.5.1.cmml" xref="A1.Ex6.m1.1.1.3.4.5">superscript</csymbol><ci id="A1.Ex6.m1.1.1.3.4.5.2.cmml" xref="A1.Ex6.m1.1.1.3.4.5.2">𝐻</ci><cn id="A1.Ex6.m1.1.1.3.4.5.3.cmml" type="integer" xref="A1.Ex6.m1.1.1.3.4.5.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex6.m1.1c">\displaystyle=6\times B\times S\times H^{2}+4\times B\times S^{2}\times H+2%
\times B\times S\times H^{2}</annotation><annotation encoding="application/x-llamapun" id="A1.Ex6.m1.1d">= 6 × italic_B × italic_S × italic_H start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + 4 × italic_B × italic_S start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT × italic_H + 2 × italic_B × italic_S × italic_H start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A1.Ex7"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=8\times B\times S\times H^{2}+4\times B\times S^{2}\times H" class="ltx_Math" display="inline" id="A1.Ex7.m1.1"><semantics id="A1.Ex7.m1.1a"><mrow id="A1.Ex7.m1.1.1" xref="A1.Ex7.m1.1.1.cmml"><mi id="A1.Ex7.m1.1.1.2" xref="A1.Ex7.m1.1.1.2.cmml"></mi><mo id="A1.Ex7.m1.1.1.1" xref="A1.Ex7.m1.1.1.1.cmml">=</mo><mrow id="A1.Ex7.m1.1.1.3" xref="A1.Ex7.m1.1.1.3.cmml"><mrow id="A1.Ex7.m1.1.1.3.2" xref="A1.Ex7.m1.1.1.3.2.cmml"><mn id="A1.Ex7.m1.1.1.3.2.2" xref="A1.Ex7.m1.1.1.3.2.2.cmml">8</mn><mo id="A1.Ex7.m1.1.1.3.2.1" lspace="0.222em" rspace="0.222em" xref="A1.Ex7.m1.1.1.3.2.1.cmml">×</mo><mi id="A1.Ex7.m1.1.1.3.2.3" xref="A1.Ex7.m1.1.1.3.2.3.cmml">B</mi><mo id="A1.Ex7.m1.1.1.3.2.1a" lspace="0.222em" rspace="0.222em" xref="A1.Ex7.m1.1.1.3.2.1.cmml">×</mo><mi id="A1.Ex7.m1.1.1.3.2.4" xref="A1.Ex7.m1.1.1.3.2.4.cmml">S</mi><mo id="A1.Ex7.m1.1.1.3.2.1b" lspace="0.222em" rspace="0.222em" xref="A1.Ex7.m1.1.1.3.2.1.cmml">×</mo><msup id="A1.Ex7.m1.1.1.3.2.5" xref="A1.Ex7.m1.1.1.3.2.5.cmml"><mi id="A1.Ex7.m1.1.1.3.2.5.2" xref="A1.Ex7.m1.1.1.3.2.5.2.cmml">H</mi><mn id="A1.Ex7.m1.1.1.3.2.5.3" xref="A1.Ex7.m1.1.1.3.2.5.3.cmml">2</mn></msup></mrow><mo id="A1.Ex7.m1.1.1.3.1" xref="A1.Ex7.m1.1.1.3.1.cmml">+</mo><mrow id="A1.Ex7.m1.1.1.3.3" xref="A1.Ex7.m1.1.1.3.3.cmml"><mn id="A1.Ex7.m1.1.1.3.3.2" xref="A1.Ex7.m1.1.1.3.3.2.cmml">4</mn><mo id="A1.Ex7.m1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="A1.Ex7.m1.1.1.3.3.1.cmml">×</mo><mi id="A1.Ex7.m1.1.1.3.3.3" xref="A1.Ex7.m1.1.1.3.3.3.cmml">B</mi><mo id="A1.Ex7.m1.1.1.3.3.1a" lspace="0.222em" rspace="0.222em" xref="A1.Ex7.m1.1.1.3.3.1.cmml">×</mo><msup id="A1.Ex7.m1.1.1.3.3.4" xref="A1.Ex7.m1.1.1.3.3.4.cmml"><mi id="A1.Ex7.m1.1.1.3.3.4.2" xref="A1.Ex7.m1.1.1.3.3.4.2.cmml">S</mi><mn id="A1.Ex7.m1.1.1.3.3.4.3" xref="A1.Ex7.m1.1.1.3.3.4.3.cmml">2</mn></msup><mo id="A1.Ex7.m1.1.1.3.3.1b" lspace="0.222em" rspace="0.222em" xref="A1.Ex7.m1.1.1.3.3.1.cmml">×</mo><mi id="A1.Ex7.m1.1.1.3.3.5" xref="A1.Ex7.m1.1.1.3.3.5.cmml">H</mi></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex7.m1.1b"><apply id="A1.Ex7.m1.1.1.cmml" xref="A1.Ex7.m1.1.1"><eq id="A1.Ex7.m1.1.1.1.cmml" xref="A1.Ex7.m1.1.1.1"></eq><csymbol cd="latexml" id="A1.Ex7.m1.1.1.2.cmml" xref="A1.Ex7.m1.1.1.2">absent</csymbol><apply id="A1.Ex7.m1.1.1.3.cmml" xref="A1.Ex7.m1.1.1.3"><plus id="A1.Ex7.m1.1.1.3.1.cmml" xref="A1.Ex7.m1.1.1.3.1"></plus><apply id="A1.Ex7.m1.1.1.3.2.cmml" xref="A1.Ex7.m1.1.1.3.2"><times id="A1.Ex7.m1.1.1.3.2.1.cmml" xref="A1.Ex7.m1.1.1.3.2.1"></times><cn id="A1.Ex7.m1.1.1.3.2.2.cmml" type="integer" xref="A1.Ex7.m1.1.1.3.2.2">8</cn><ci id="A1.Ex7.m1.1.1.3.2.3.cmml" xref="A1.Ex7.m1.1.1.3.2.3">𝐵</ci><ci id="A1.Ex7.m1.1.1.3.2.4.cmml" xref="A1.Ex7.m1.1.1.3.2.4">𝑆</ci><apply id="A1.Ex7.m1.1.1.3.2.5.cmml" xref="A1.Ex7.m1.1.1.3.2.5"><csymbol cd="ambiguous" id="A1.Ex7.m1.1.1.3.2.5.1.cmml" xref="A1.Ex7.m1.1.1.3.2.5">superscript</csymbol><ci id="A1.Ex7.m1.1.1.3.2.5.2.cmml" xref="A1.Ex7.m1.1.1.3.2.5.2">𝐻</ci><cn id="A1.Ex7.m1.1.1.3.2.5.3.cmml" type="integer" xref="A1.Ex7.m1.1.1.3.2.5.3">2</cn></apply></apply><apply id="A1.Ex7.m1.1.1.3.3.cmml" xref="A1.Ex7.m1.1.1.3.3"><times id="A1.Ex7.m1.1.1.3.3.1.cmml" xref="A1.Ex7.m1.1.1.3.3.1"></times><cn id="A1.Ex7.m1.1.1.3.3.2.cmml" type="integer" xref="A1.Ex7.m1.1.1.3.3.2">4</cn><ci id="A1.Ex7.m1.1.1.3.3.3.cmml" xref="A1.Ex7.m1.1.1.3.3.3">𝐵</ci><apply id="A1.Ex7.m1.1.1.3.3.4.cmml" xref="A1.Ex7.m1.1.1.3.3.4"><csymbol cd="ambiguous" id="A1.Ex7.m1.1.1.3.3.4.1.cmml" xref="A1.Ex7.m1.1.1.3.3.4">superscript</csymbol><ci id="A1.Ex7.m1.1.1.3.3.4.2.cmml" xref="A1.Ex7.m1.1.1.3.3.4.2">𝑆</ci><cn id="A1.Ex7.m1.1.1.3.3.4.3.cmml" type="integer" xref="A1.Ex7.m1.1.1.3.3.4.3">2</cn></apply><ci id="A1.Ex7.m1.1.1.3.3.5.cmml" xref="A1.Ex7.m1.1.1.3.3.5">𝐻</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex7.m1.1c">\displaystyle=8\times B\times S\times H^{2}+4\times B\times S^{2}\times H</annotation><annotation encoding="application/x-llamapun" id="A1.Ex7.m1.1d">= 8 × italic_B × italic_S × italic_H start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + 4 × italic_B × italic_S start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT × italic_H</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
</li>
<li class="ltx_item" id="A1.I3.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para ltx_noindent" id="A1.I3.i3.p1">
<p class="ltx_p" id="A1.I3.i3.p1.1"><span class="ltx_text ltx_font_bold" id="A1.I3.i3.p1.1.1">Feedforward Network (FFN):</span></p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equation ltx_eqn_table" id="A1.Ex8">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\text{FLOPs}_{\text{FFN}}=2\times 2\times B\times S\times H\times D_{\text{ff}%
}=4\times B\times S\times H\times D_{\text{ff}}" class="ltx_Math" display="block" id="A1.Ex8.m1.1"><semantics id="A1.Ex8.m1.1a"><mrow id="A1.Ex8.m1.1.1" xref="A1.Ex8.m1.1.1.cmml"><msub id="A1.Ex8.m1.1.1.2" xref="A1.Ex8.m1.1.1.2.cmml"><mtext id="A1.Ex8.m1.1.1.2.2" xref="A1.Ex8.m1.1.1.2.2a.cmml">FLOPs</mtext><mtext id="A1.Ex8.m1.1.1.2.3" xref="A1.Ex8.m1.1.1.2.3a.cmml">FFN</mtext></msub><mo id="A1.Ex8.m1.1.1.3" xref="A1.Ex8.m1.1.1.3.cmml">=</mo><mrow id="A1.Ex8.m1.1.1.4" xref="A1.Ex8.m1.1.1.4.cmml"><mn id="A1.Ex8.m1.1.1.4.2" xref="A1.Ex8.m1.1.1.4.2.cmml">2</mn><mo id="A1.Ex8.m1.1.1.4.1" lspace="0.222em" rspace="0.222em" xref="A1.Ex8.m1.1.1.4.1.cmml">×</mo><mn id="A1.Ex8.m1.1.1.4.3" xref="A1.Ex8.m1.1.1.4.3.cmml">2</mn><mo id="A1.Ex8.m1.1.1.4.1a" lspace="0.222em" rspace="0.222em" xref="A1.Ex8.m1.1.1.4.1.cmml">×</mo><mi id="A1.Ex8.m1.1.1.4.4" xref="A1.Ex8.m1.1.1.4.4.cmml">B</mi><mo id="A1.Ex8.m1.1.1.4.1b" lspace="0.222em" rspace="0.222em" xref="A1.Ex8.m1.1.1.4.1.cmml">×</mo><mi id="A1.Ex8.m1.1.1.4.5" xref="A1.Ex8.m1.1.1.4.5.cmml">S</mi><mo id="A1.Ex8.m1.1.1.4.1c" lspace="0.222em" rspace="0.222em" xref="A1.Ex8.m1.1.1.4.1.cmml">×</mo><mi id="A1.Ex8.m1.1.1.4.6" xref="A1.Ex8.m1.1.1.4.6.cmml">H</mi><mo id="A1.Ex8.m1.1.1.4.1d" lspace="0.222em" rspace="0.222em" xref="A1.Ex8.m1.1.1.4.1.cmml">×</mo><msub id="A1.Ex8.m1.1.1.4.7" xref="A1.Ex8.m1.1.1.4.7.cmml"><mi id="A1.Ex8.m1.1.1.4.7.2" xref="A1.Ex8.m1.1.1.4.7.2.cmml">D</mi><mtext id="A1.Ex8.m1.1.1.4.7.3" xref="A1.Ex8.m1.1.1.4.7.3a.cmml">ff</mtext></msub></mrow><mo id="A1.Ex8.m1.1.1.5" xref="A1.Ex8.m1.1.1.5.cmml">=</mo><mrow id="A1.Ex8.m1.1.1.6" xref="A1.Ex8.m1.1.1.6.cmml"><mn id="A1.Ex8.m1.1.1.6.2" xref="A1.Ex8.m1.1.1.6.2.cmml">4</mn><mo id="A1.Ex8.m1.1.1.6.1" lspace="0.222em" rspace="0.222em" xref="A1.Ex8.m1.1.1.6.1.cmml">×</mo><mi id="A1.Ex8.m1.1.1.6.3" xref="A1.Ex8.m1.1.1.6.3.cmml">B</mi><mo id="A1.Ex8.m1.1.1.6.1a" lspace="0.222em" rspace="0.222em" xref="A1.Ex8.m1.1.1.6.1.cmml">×</mo><mi id="A1.Ex8.m1.1.1.6.4" xref="A1.Ex8.m1.1.1.6.4.cmml">S</mi><mo id="A1.Ex8.m1.1.1.6.1b" lspace="0.222em" rspace="0.222em" xref="A1.Ex8.m1.1.1.6.1.cmml">×</mo><mi id="A1.Ex8.m1.1.1.6.5" xref="A1.Ex8.m1.1.1.6.5.cmml">H</mi><mo id="A1.Ex8.m1.1.1.6.1c" lspace="0.222em" rspace="0.222em" xref="A1.Ex8.m1.1.1.6.1.cmml">×</mo><msub id="A1.Ex8.m1.1.1.6.6" xref="A1.Ex8.m1.1.1.6.6.cmml"><mi id="A1.Ex8.m1.1.1.6.6.2" xref="A1.Ex8.m1.1.1.6.6.2.cmml">D</mi><mtext id="A1.Ex8.m1.1.1.6.6.3" xref="A1.Ex8.m1.1.1.6.6.3a.cmml">ff</mtext></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex8.m1.1b"><apply id="A1.Ex8.m1.1.1.cmml" xref="A1.Ex8.m1.1.1"><and id="A1.Ex8.m1.1.1a.cmml" xref="A1.Ex8.m1.1.1"></and><apply id="A1.Ex8.m1.1.1b.cmml" xref="A1.Ex8.m1.1.1"><eq id="A1.Ex8.m1.1.1.3.cmml" xref="A1.Ex8.m1.1.1.3"></eq><apply id="A1.Ex8.m1.1.1.2.cmml" xref="A1.Ex8.m1.1.1.2"><csymbol cd="ambiguous" id="A1.Ex8.m1.1.1.2.1.cmml" xref="A1.Ex8.m1.1.1.2">subscript</csymbol><ci id="A1.Ex8.m1.1.1.2.2a.cmml" xref="A1.Ex8.m1.1.1.2.2"><mtext id="A1.Ex8.m1.1.1.2.2.cmml" xref="A1.Ex8.m1.1.1.2.2">FLOPs</mtext></ci><ci id="A1.Ex8.m1.1.1.2.3a.cmml" xref="A1.Ex8.m1.1.1.2.3"><mtext id="A1.Ex8.m1.1.1.2.3.cmml" mathsize="70%" xref="A1.Ex8.m1.1.1.2.3">FFN</mtext></ci></apply><apply id="A1.Ex8.m1.1.1.4.cmml" xref="A1.Ex8.m1.1.1.4"><times id="A1.Ex8.m1.1.1.4.1.cmml" xref="A1.Ex8.m1.1.1.4.1"></times><cn id="A1.Ex8.m1.1.1.4.2.cmml" type="integer" xref="A1.Ex8.m1.1.1.4.2">2</cn><cn id="A1.Ex8.m1.1.1.4.3.cmml" type="integer" xref="A1.Ex8.m1.1.1.4.3">2</cn><ci id="A1.Ex8.m1.1.1.4.4.cmml" xref="A1.Ex8.m1.1.1.4.4">𝐵</ci><ci id="A1.Ex8.m1.1.1.4.5.cmml" xref="A1.Ex8.m1.1.1.4.5">𝑆</ci><ci id="A1.Ex8.m1.1.1.4.6.cmml" xref="A1.Ex8.m1.1.1.4.6">𝐻</ci><apply id="A1.Ex8.m1.1.1.4.7.cmml" xref="A1.Ex8.m1.1.1.4.7"><csymbol cd="ambiguous" id="A1.Ex8.m1.1.1.4.7.1.cmml" xref="A1.Ex8.m1.1.1.4.7">subscript</csymbol><ci id="A1.Ex8.m1.1.1.4.7.2.cmml" xref="A1.Ex8.m1.1.1.4.7.2">𝐷</ci><ci id="A1.Ex8.m1.1.1.4.7.3a.cmml" xref="A1.Ex8.m1.1.1.4.7.3"><mtext id="A1.Ex8.m1.1.1.4.7.3.cmml" mathsize="70%" xref="A1.Ex8.m1.1.1.4.7.3">ff</mtext></ci></apply></apply></apply><apply id="A1.Ex8.m1.1.1c.cmml" xref="A1.Ex8.m1.1.1"><eq id="A1.Ex8.m1.1.1.5.cmml" xref="A1.Ex8.m1.1.1.5"></eq><share href="https://arxiv.org/html/2410.03529v1#A1.Ex8.m1.1.1.4.cmml" id="A1.Ex8.m1.1.1d.cmml" xref="A1.Ex8.m1.1.1"></share><apply id="A1.Ex8.m1.1.1.6.cmml" xref="A1.Ex8.m1.1.1.6"><times id="A1.Ex8.m1.1.1.6.1.cmml" xref="A1.Ex8.m1.1.1.6.1"></times><cn id="A1.Ex8.m1.1.1.6.2.cmml" type="integer" xref="A1.Ex8.m1.1.1.6.2">4</cn><ci id="A1.Ex8.m1.1.1.6.3.cmml" xref="A1.Ex8.m1.1.1.6.3">𝐵</ci><ci id="A1.Ex8.m1.1.1.6.4.cmml" xref="A1.Ex8.m1.1.1.6.4">𝑆</ci><ci id="A1.Ex8.m1.1.1.6.5.cmml" xref="A1.Ex8.m1.1.1.6.5">𝐻</ci><apply id="A1.Ex8.m1.1.1.6.6.cmml" xref="A1.Ex8.m1.1.1.6.6"><csymbol cd="ambiguous" id="A1.Ex8.m1.1.1.6.6.1.cmml" xref="A1.Ex8.m1.1.1.6.6">subscript</csymbol><ci id="A1.Ex8.m1.1.1.6.6.2.cmml" xref="A1.Ex8.m1.1.1.6.6.2">𝐷</ci><ci id="A1.Ex8.m1.1.1.6.6.3a.cmml" xref="A1.Ex8.m1.1.1.6.6.3"><mtext id="A1.Ex8.m1.1.1.6.6.3.cmml" mathsize="70%" xref="A1.Ex8.m1.1.1.6.6.3">ff</mtext></ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex8.m1.1c">\text{FLOPs}_{\text{FFN}}=2\times 2\times B\times S\times H\times D_{\text{ff}%
}=4\times B\times S\times H\times D_{\text{ff}}</annotation><annotation encoding="application/x-llamapun" id="A1.Ex8.m1.1d">FLOPs start_POSTSUBSCRIPT FFN end_POSTSUBSCRIPT = 2 × 2 × italic_B × italic_S × italic_H × italic_D start_POSTSUBSCRIPT ff end_POSTSUBSCRIPT = 4 × italic_B × italic_S × italic_H × italic_D start_POSTSUBSCRIPT ff end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
</li>
<li class="ltx_item" id="A1.I3.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para ltx_noindent" id="A1.I3.i4.p1">
<p class="ltx_p" id="A1.I3.i4.p1.1"><span class="ltx_text ltx_font_bold" id="A1.I3.i4.p1.1.1">Output projection:</span></p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equation ltx_eqn_table" id="A1.Ex9">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\text{FLOPs}_{\text{out}}=\text{FLOPs}_{\text{out}_{\text{proj}}}+\text{FLOPs}%
_{\text{softmax}}=2\times B\times S\times H\times V+3\times B\times S\times V" class="ltx_Math" display="block" id="A1.Ex9.m1.1"><semantics id="A1.Ex9.m1.1a"><mrow id="A1.Ex9.m1.1.1" xref="A1.Ex9.m1.1.1.cmml"><msub id="A1.Ex9.m1.1.1.2" xref="A1.Ex9.m1.1.1.2.cmml"><mtext id="A1.Ex9.m1.1.1.2.2" xref="A1.Ex9.m1.1.1.2.2a.cmml">FLOPs</mtext><mtext id="A1.Ex9.m1.1.1.2.3" xref="A1.Ex9.m1.1.1.2.3a.cmml">out</mtext></msub><mo id="A1.Ex9.m1.1.1.3" xref="A1.Ex9.m1.1.1.3.cmml">=</mo><mrow id="A1.Ex9.m1.1.1.4" xref="A1.Ex9.m1.1.1.4.cmml"><msub id="A1.Ex9.m1.1.1.4.2" xref="A1.Ex9.m1.1.1.4.2.cmml"><mtext id="A1.Ex9.m1.1.1.4.2.2" xref="A1.Ex9.m1.1.1.4.2.2a.cmml">FLOPs</mtext><msub id="A1.Ex9.m1.1.1.4.2.3" xref="A1.Ex9.m1.1.1.4.2.3.cmml"><mtext id="A1.Ex9.m1.1.1.4.2.3.2" xref="A1.Ex9.m1.1.1.4.2.3.2a.cmml">out</mtext><mtext id="A1.Ex9.m1.1.1.4.2.3.3" xref="A1.Ex9.m1.1.1.4.2.3.3a.cmml">proj</mtext></msub></msub><mo id="A1.Ex9.m1.1.1.4.1" xref="A1.Ex9.m1.1.1.4.1.cmml">+</mo><msub id="A1.Ex9.m1.1.1.4.3" xref="A1.Ex9.m1.1.1.4.3.cmml"><mtext id="A1.Ex9.m1.1.1.4.3.2" xref="A1.Ex9.m1.1.1.4.3.2a.cmml">FLOPs</mtext><mtext id="A1.Ex9.m1.1.1.4.3.3" xref="A1.Ex9.m1.1.1.4.3.3a.cmml">softmax</mtext></msub></mrow><mo id="A1.Ex9.m1.1.1.5" xref="A1.Ex9.m1.1.1.5.cmml">=</mo><mrow id="A1.Ex9.m1.1.1.6" xref="A1.Ex9.m1.1.1.6.cmml"><mrow id="A1.Ex9.m1.1.1.6.2" xref="A1.Ex9.m1.1.1.6.2.cmml"><mn id="A1.Ex9.m1.1.1.6.2.2" xref="A1.Ex9.m1.1.1.6.2.2.cmml">2</mn><mo id="A1.Ex9.m1.1.1.6.2.1" lspace="0.222em" rspace="0.222em" xref="A1.Ex9.m1.1.1.6.2.1.cmml">×</mo><mi id="A1.Ex9.m1.1.1.6.2.3" xref="A1.Ex9.m1.1.1.6.2.3.cmml">B</mi><mo id="A1.Ex9.m1.1.1.6.2.1a" lspace="0.222em" rspace="0.222em" xref="A1.Ex9.m1.1.1.6.2.1.cmml">×</mo><mi id="A1.Ex9.m1.1.1.6.2.4" xref="A1.Ex9.m1.1.1.6.2.4.cmml">S</mi><mo id="A1.Ex9.m1.1.1.6.2.1b" lspace="0.222em" rspace="0.222em" xref="A1.Ex9.m1.1.1.6.2.1.cmml">×</mo><mi id="A1.Ex9.m1.1.1.6.2.5" xref="A1.Ex9.m1.1.1.6.2.5.cmml">H</mi><mo id="A1.Ex9.m1.1.1.6.2.1c" lspace="0.222em" rspace="0.222em" xref="A1.Ex9.m1.1.1.6.2.1.cmml">×</mo><mi id="A1.Ex9.m1.1.1.6.2.6" xref="A1.Ex9.m1.1.1.6.2.6.cmml">V</mi></mrow><mo id="A1.Ex9.m1.1.1.6.1" xref="A1.Ex9.m1.1.1.6.1.cmml">+</mo><mrow id="A1.Ex9.m1.1.1.6.3" xref="A1.Ex9.m1.1.1.6.3.cmml"><mn id="A1.Ex9.m1.1.1.6.3.2" xref="A1.Ex9.m1.1.1.6.3.2.cmml">3</mn><mo id="A1.Ex9.m1.1.1.6.3.1" lspace="0.222em" rspace="0.222em" xref="A1.Ex9.m1.1.1.6.3.1.cmml">×</mo><mi id="A1.Ex9.m1.1.1.6.3.3" xref="A1.Ex9.m1.1.1.6.3.3.cmml">B</mi><mo id="A1.Ex9.m1.1.1.6.3.1a" lspace="0.222em" rspace="0.222em" xref="A1.Ex9.m1.1.1.6.3.1.cmml">×</mo><mi id="A1.Ex9.m1.1.1.6.3.4" xref="A1.Ex9.m1.1.1.6.3.4.cmml">S</mi><mo id="A1.Ex9.m1.1.1.6.3.1b" lspace="0.222em" rspace="0.222em" xref="A1.Ex9.m1.1.1.6.3.1.cmml">×</mo><mi id="A1.Ex9.m1.1.1.6.3.5" xref="A1.Ex9.m1.1.1.6.3.5.cmml">V</mi></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex9.m1.1b"><apply id="A1.Ex9.m1.1.1.cmml" xref="A1.Ex9.m1.1.1"><and id="A1.Ex9.m1.1.1a.cmml" xref="A1.Ex9.m1.1.1"></and><apply id="A1.Ex9.m1.1.1b.cmml" xref="A1.Ex9.m1.1.1"><eq id="A1.Ex9.m1.1.1.3.cmml" xref="A1.Ex9.m1.1.1.3"></eq><apply id="A1.Ex9.m1.1.1.2.cmml" xref="A1.Ex9.m1.1.1.2"><csymbol cd="ambiguous" id="A1.Ex9.m1.1.1.2.1.cmml" xref="A1.Ex9.m1.1.1.2">subscript</csymbol><ci id="A1.Ex9.m1.1.1.2.2a.cmml" xref="A1.Ex9.m1.1.1.2.2"><mtext id="A1.Ex9.m1.1.1.2.2.cmml" xref="A1.Ex9.m1.1.1.2.2">FLOPs</mtext></ci><ci id="A1.Ex9.m1.1.1.2.3a.cmml" xref="A1.Ex9.m1.1.1.2.3"><mtext id="A1.Ex9.m1.1.1.2.3.cmml" mathsize="70%" xref="A1.Ex9.m1.1.1.2.3">out</mtext></ci></apply><apply id="A1.Ex9.m1.1.1.4.cmml" xref="A1.Ex9.m1.1.1.4"><plus id="A1.Ex9.m1.1.1.4.1.cmml" xref="A1.Ex9.m1.1.1.4.1"></plus><apply id="A1.Ex9.m1.1.1.4.2.cmml" xref="A1.Ex9.m1.1.1.4.2"><csymbol cd="ambiguous" id="A1.Ex9.m1.1.1.4.2.1.cmml" xref="A1.Ex9.m1.1.1.4.2">subscript</csymbol><ci id="A1.Ex9.m1.1.1.4.2.2a.cmml" xref="A1.Ex9.m1.1.1.4.2.2"><mtext id="A1.Ex9.m1.1.1.4.2.2.cmml" xref="A1.Ex9.m1.1.1.4.2.2">FLOPs</mtext></ci><apply id="A1.Ex9.m1.1.1.4.2.3.cmml" xref="A1.Ex9.m1.1.1.4.2.3"><csymbol cd="ambiguous" id="A1.Ex9.m1.1.1.4.2.3.1.cmml" xref="A1.Ex9.m1.1.1.4.2.3">subscript</csymbol><ci id="A1.Ex9.m1.1.1.4.2.3.2a.cmml" xref="A1.Ex9.m1.1.1.4.2.3.2"><mtext id="A1.Ex9.m1.1.1.4.2.3.2.cmml" mathsize="70%" xref="A1.Ex9.m1.1.1.4.2.3.2">out</mtext></ci><ci id="A1.Ex9.m1.1.1.4.2.3.3a.cmml" xref="A1.Ex9.m1.1.1.4.2.3.3"><mtext id="A1.Ex9.m1.1.1.4.2.3.3.cmml" mathsize="50%" xref="A1.Ex9.m1.1.1.4.2.3.3">proj</mtext></ci></apply></apply><apply id="A1.Ex9.m1.1.1.4.3.cmml" xref="A1.Ex9.m1.1.1.4.3"><csymbol cd="ambiguous" id="A1.Ex9.m1.1.1.4.3.1.cmml" xref="A1.Ex9.m1.1.1.4.3">subscript</csymbol><ci id="A1.Ex9.m1.1.1.4.3.2a.cmml" xref="A1.Ex9.m1.1.1.4.3.2"><mtext id="A1.Ex9.m1.1.1.4.3.2.cmml" xref="A1.Ex9.m1.1.1.4.3.2">FLOPs</mtext></ci><ci id="A1.Ex9.m1.1.1.4.3.3a.cmml" xref="A1.Ex9.m1.1.1.4.3.3"><mtext id="A1.Ex9.m1.1.1.4.3.3.cmml" mathsize="70%" xref="A1.Ex9.m1.1.1.4.3.3">softmax</mtext></ci></apply></apply></apply><apply id="A1.Ex9.m1.1.1c.cmml" xref="A1.Ex9.m1.1.1"><eq id="A1.Ex9.m1.1.1.5.cmml" xref="A1.Ex9.m1.1.1.5"></eq><share href="https://arxiv.org/html/2410.03529v1#A1.Ex9.m1.1.1.4.cmml" id="A1.Ex9.m1.1.1d.cmml" xref="A1.Ex9.m1.1.1"></share><apply id="A1.Ex9.m1.1.1.6.cmml" xref="A1.Ex9.m1.1.1.6"><plus id="A1.Ex9.m1.1.1.6.1.cmml" xref="A1.Ex9.m1.1.1.6.1"></plus><apply id="A1.Ex9.m1.1.1.6.2.cmml" xref="A1.Ex9.m1.1.1.6.2"><times id="A1.Ex9.m1.1.1.6.2.1.cmml" xref="A1.Ex9.m1.1.1.6.2.1"></times><cn id="A1.Ex9.m1.1.1.6.2.2.cmml" type="integer" xref="A1.Ex9.m1.1.1.6.2.2">2</cn><ci id="A1.Ex9.m1.1.1.6.2.3.cmml" xref="A1.Ex9.m1.1.1.6.2.3">𝐵</ci><ci id="A1.Ex9.m1.1.1.6.2.4.cmml" xref="A1.Ex9.m1.1.1.6.2.4">𝑆</ci><ci id="A1.Ex9.m1.1.1.6.2.5.cmml" xref="A1.Ex9.m1.1.1.6.2.5">𝐻</ci><ci id="A1.Ex9.m1.1.1.6.2.6.cmml" xref="A1.Ex9.m1.1.1.6.2.6">𝑉</ci></apply><apply id="A1.Ex9.m1.1.1.6.3.cmml" xref="A1.Ex9.m1.1.1.6.3"><times id="A1.Ex9.m1.1.1.6.3.1.cmml" xref="A1.Ex9.m1.1.1.6.3.1"></times><cn id="A1.Ex9.m1.1.1.6.3.2.cmml" type="integer" xref="A1.Ex9.m1.1.1.6.3.2">3</cn><ci id="A1.Ex9.m1.1.1.6.3.3.cmml" xref="A1.Ex9.m1.1.1.6.3.3">𝐵</ci><ci id="A1.Ex9.m1.1.1.6.3.4.cmml" xref="A1.Ex9.m1.1.1.6.3.4">𝑆</ci><ci id="A1.Ex9.m1.1.1.6.3.5.cmml" xref="A1.Ex9.m1.1.1.6.3.5">𝑉</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex9.m1.1c">\text{FLOPs}_{\text{out}}=\text{FLOPs}_{\text{out}_{\text{proj}}}+\text{FLOPs}%
_{\text{softmax}}=2\times B\times S\times H\times V+3\times B\times S\times V</annotation><annotation encoding="application/x-llamapun" id="A1.Ex9.m1.1d">FLOPs start_POSTSUBSCRIPT out end_POSTSUBSCRIPT = FLOPs start_POSTSUBSCRIPT out start_POSTSUBSCRIPT proj end_POSTSUBSCRIPT end_POSTSUBSCRIPT + FLOPs start_POSTSUBSCRIPT softmax end_POSTSUBSCRIPT = 2 × italic_B × italic_S × italic_H × italic_V + 3 × italic_B × italic_S × italic_V</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
</li>
</ul>
<p class="ltx_p" id="A1.SS3.SSS1.p3.1"><span class="ltx_text ltx_font_bold" id="A1.SS3.SSS1.p3.1.1">Total FLOPs per Layer:</span></p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equation ltx_eqn_table" id="A1.Ex10">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\text{FLOPs}_{\text{layer}}=\left(\text{FLOPs}_{\text{MHA}}+\text{FLOPs}_{%
\text{FFN}}\right)\times L" class="ltx_Math" display="block" id="A1.Ex10.m1.1"><semantics id="A1.Ex10.m1.1a"><mrow id="A1.Ex10.m1.1.1" xref="A1.Ex10.m1.1.1.cmml"><msub id="A1.Ex10.m1.1.1.3" xref="A1.Ex10.m1.1.1.3.cmml"><mtext id="A1.Ex10.m1.1.1.3.2" xref="A1.Ex10.m1.1.1.3.2a.cmml">FLOPs</mtext><mtext id="A1.Ex10.m1.1.1.3.3" xref="A1.Ex10.m1.1.1.3.3a.cmml">layer</mtext></msub><mo id="A1.Ex10.m1.1.1.2" xref="A1.Ex10.m1.1.1.2.cmml">=</mo><mrow id="A1.Ex10.m1.1.1.1" xref="A1.Ex10.m1.1.1.1.cmml"><mrow id="A1.Ex10.m1.1.1.1.1.1" xref="A1.Ex10.m1.1.1.1.1.1.1.cmml"><mo id="A1.Ex10.m1.1.1.1.1.1.2" xref="A1.Ex10.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.Ex10.m1.1.1.1.1.1.1" xref="A1.Ex10.m1.1.1.1.1.1.1.cmml"><msub id="A1.Ex10.m1.1.1.1.1.1.1.2" xref="A1.Ex10.m1.1.1.1.1.1.1.2.cmml"><mtext id="A1.Ex10.m1.1.1.1.1.1.1.2.2" xref="A1.Ex10.m1.1.1.1.1.1.1.2.2a.cmml">FLOPs</mtext><mtext id="A1.Ex10.m1.1.1.1.1.1.1.2.3" xref="A1.Ex10.m1.1.1.1.1.1.1.2.3a.cmml">MHA</mtext></msub><mo id="A1.Ex10.m1.1.1.1.1.1.1.1" xref="A1.Ex10.m1.1.1.1.1.1.1.1.cmml">+</mo><msub id="A1.Ex10.m1.1.1.1.1.1.1.3" xref="A1.Ex10.m1.1.1.1.1.1.1.3.cmml"><mtext id="A1.Ex10.m1.1.1.1.1.1.1.3.2" xref="A1.Ex10.m1.1.1.1.1.1.1.3.2a.cmml">FLOPs</mtext><mtext id="A1.Ex10.m1.1.1.1.1.1.1.3.3" xref="A1.Ex10.m1.1.1.1.1.1.1.3.3a.cmml">FFN</mtext></msub></mrow><mo id="A1.Ex10.m1.1.1.1.1.1.3" rspace="0.055em" xref="A1.Ex10.m1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="A1.Ex10.m1.1.1.1.2" rspace="0.222em" xref="A1.Ex10.m1.1.1.1.2.cmml">×</mo><mi id="A1.Ex10.m1.1.1.1.3" xref="A1.Ex10.m1.1.1.1.3.cmml">L</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex10.m1.1b"><apply id="A1.Ex10.m1.1.1.cmml" xref="A1.Ex10.m1.1.1"><eq id="A1.Ex10.m1.1.1.2.cmml" xref="A1.Ex10.m1.1.1.2"></eq><apply id="A1.Ex10.m1.1.1.3.cmml" xref="A1.Ex10.m1.1.1.3"><csymbol cd="ambiguous" id="A1.Ex10.m1.1.1.3.1.cmml" xref="A1.Ex10.m1.1.1.3">subscript</csymbol><ci id="A1.Ex10.m1.1.1.3.2a.cmml" xref="A1.Ex10.m1.1.1.3.2"><mtext id="A1.Ex10.m1.1.1.3.2.cmml" xref="A1.Ex10.m1.1.1.3.2">FLOPs</mtext></ci><ci id="A1.Ex10.m1.1.1.3.3a.cmml" xref="A1.Ex10.m1.1.1.3.3"><mtext id="A1.Ex10.m1.1.1.3.3.cmml" mathsize="70%" xref="A1.Ex10.m1.1.1.3.3">layer</mtext></ci></apply><apply id="A1.Ex10.m1.1.1.1.cmml" xref="A1.Ex10.m1.1.1.1"><times id="A1.Ex10.m1.1.1.1.2.cmml" xref="A1.Ex10.m1.1.1.1.2"></times><apply id="A1.Ex10.m1.1.1.1.1.1.1.cmml" xref="A1.Ex10.m1.1.1.1.1.1"><plus id="A1.Ex10.m1.1.1.1.1.1.1.1.cmml" xref="A1.Ex10.m1.1.1.1.1.1.1.1"></plus><apply id="A1.Ex10.m1.1.1.1.1.1.1.2.cmml" xref="A1.Ex10.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.Ex10.m1.1.1.1.1.1.1.2.1.cmml" xref="A1.Ex10.m1.1.1.1.1.1.1.2">subscript</csymbol><ci id="A1.Ex10.m1.1.1.1.1.1.1.2.2a.cmml" xref="A1.Ex10.m1.1.1.1.1.1.1.2.2"><mtext id="A1.Ex10.m1.1.1.1.1.1.1.2.2.cmml" xref="A1.Ex10.m1.1.1.1.1.1.1.2.2">FLOPs</mtext></ci><ci id="A1.Ex10.m1.1.1.1.1.1.1.2.3a.cmml" xref="A1.Ex10.m1.1.1.1.1.1.1.2.3"><mtext id="A1.Ex10.m1.1.1.1.1.1.1.2.3.cmml" mathsize="70%" xref="A1.Ex10.m1.1.1.1.1.1.1.2.3">MHA</mtext></ci></apply><apply id="A1.Ex10.m1.1.1.1.1.1.1.3.cmml" xref="A1.Ex10.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.Ex10.m1.1.1.1.1.1.1.3.1.cmml" xref="A1.Ex10.m1.1.1.1.1.1.1.3">subscript</csymbol><ci id="A1.Ex10.m1.1.1.1.1.1.1.3.2a.cmml" xref="A1.Ex10.m1.1.1.1.1.1.1.3.2"><mtext id="A1.Ex10.m1.1.1.1.1.1.1.3.2.cmml" xref="A1.Ex10.m1.1.1.1.1.1.1.3.2">FLOPs</mtext></ci><ci id="A1.Ex10.m1.1.1.1.1.1.1.3.3a.cmml" xref="A1.Ex10.m1.1.1.1.1.1.1.3.3"><mtext id="A1.Ex10.m1.1.1.1.1.1.1.3.3.cmml" mathsize="70%" xref="A1.Ex10.m1.1.1.1.1.1.1.3.3">FFN</mtext></ci></apply></apply><ci id="A1.Ex10.m1.1.1.1.3.cmml" xref="A1.Ex10.m1.1.1.1.3">𝐿</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex10.m1.1c">\text{FLOPs}_{\text{layer}}=\left(\text{FLOPs}_{\text{MHA}}+\text{FLOPs}_{%
\text{FFN}}\right)\times L</annotation><annotation encoding="application/x-llamapun" id="A1.Ex10.m1.1d">FLOPs start_POSTSUBSCRIPT layer end_POSTSUBSCRIPT = ( FLOPs start_POSTSUBSCRIPT MHA end_POSTSUBSCRIPT + FLOPs start_POSTSUBSCRIPT FFN end_POSTSUBSCRIPT ) × italic_L</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="A1.SS3.SSS1.p4">
<p class="ltx_p" id="A1.SS3.SSS1.p4.1"><span class="ltx_text ltx_font_bold" id="A1.SS3.SSS1.p4.1.1">Total Forward Pass FLOPs per Step:</span></p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equation ltx_eqn_table" id="A1.Ex11">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\text{FLOPs}_{\text{forward}}=\text{FLOPs}_{\text{emb}}+\text{FLOPs}_{\text{%
layer}}+\text{FLOPs}_{\text{out}}" class="ltx_Math" display="block" id="A1.Ex11.m1.1"><semantics id="A1.Ex11.m1.1a"><mrow id="A1.Ex11.m1.1.1" xref="A1.Ex11.m1.1.1.cmml"><msub id="A1.Ex11.m1.1.1.2" xref="A1.Ex11.m1.1.1.2.cmml"><mtext id="A1.Ex11.m1.1.1.2.2" xref="A1.Ex11.m1.1.1.2.2a.cmml">FLOPs</mtext><mtext id="A1.Ex11.m1.1.1.2.3" xref="A1.Ex11.m1.1.1.2.3a.cmml">forward</mtext></msub><mo id="A1.Ex11.m1.1.1.1" xref="A1.Ex11.m1.1.1.1.cmml">=</mo><mrow id="A1.Ex11.m1.1.1.3" xref="A1.Ex11.m1.1.1.3.cmml"><msub id="A1.Ex11.m1.1.1.3.2" xref="A1.Ex11.m1.1.1.3.2.cmml"><mtext id="A1.Ex11.m1.1.1.3.2.2" xref="A1.Ex11.m1.1.1.3.2.2a.cmml">FLOPs</mtext><mtext id="A1.Ex11.m1.1.1.3.2.3" xref="A1.Ex11.m1.1.1.3.2.3a.cmml">emb</mtext></msub><mo id="A1.Ex11.m1.1.1.3.1" xref="A1.Ex11.m1.1.1.3.1.cmml">+</mo><msub id="A1.Ex11.m1.1.1.3.3" xref="A1.Ex11.m1.1.1.3.3.cmml"><mtext id="A1.Ex11.m1.1.1.3.3.2" xref="A1.Ex11.m1.1.1.3.3.2a.cmml">FLOPs</mtext><mtext id="A1.Ex11.m1.1.1.3.3.3" xref="A1.Ex11.m1.1.1.3.3.3a.cmml">layer</mtext></msub><mo id="A1.Ex11.m1.1.1.3.1a" xref="A1.Ex11.m1.1.1.3.1.cmml">+</mo><msub id="A1.Ex11.m1.1.1.3.4" xref="A1.Ex11.m1.1.1.3.4.cmml"><mtext id="A1.Ex11.m1.1.1.3.4.2" xref="A1.Ex11.m1.1.1.3.4.2a.cmml">FLOPs</mtext><mtext id="A1.Ex11.m1.1.1.3.4.3" xref="A1.Ex11.m1.1.1.3.4.3a.cmml">out</mtext></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex11.m1.1b"><apply id="A1.Ex11.m1.1.1.cmml" xref="A1.Ex11.m1.1.1"><eq id="A1.Ex11.m1.1.1.1.cmml" xref="A1.Ex11.m1.1.1.1"></eq><apply id="A1.Ex11.m1.1.1.2.cmml" xref="A1.Ex11.m1.1.1.2"><csymbol cd="ambiguous" id="A1.Ex11.m1.1.1.2.1.cmml" xref="A1.Ex11.m1.1.1.2">subscript</csymbol><ci id="A1.Ex11.m1.1.1.2.2a.cmml" xref="A1.Ex11.m1.1.1.2.2"><mtext id="A1.Ex11.m1.1.1.2.2.cmml" xref="A1.Ex11.m1.1.1.2.2">FLOPs</mtext></ci><ci id="A1.Ex11.m1.1.1.2.3a.cmml" xref="A1.Ex11.m1.1.1.2.3"><mtext id="A1.Ex11.m1.1.1.2.3.cmml" mathsize="70%" xref="A1.Ex11.m1.1.1.2.3">forward</mtext></ci></apply><apply id="A1.Ex11.m1.1.1.3.cmml" xref="A1.Ex11.m1.1.1.3"><plus id="A1.Ex11.m1.1.1.3.1.cmml" xref="A1.Ex11.m1.1.1.3.1"></plus><apply id="A1.Ex11.m1.1.1.3.2.cmml" xref="A1.Ex11.m1.1.1.3.2"><csymbol cd="ambiguous" id="A1.Ex11.m1.1.1.3.2.1.cmml" xref="A1.Ex11.m1.1.1.3.2">subscript</csymbol><ci id="A1.Ex11.m1.1.1.3.2.2a.cmml" xref="A1.Ex11.m1.1.1.3.2.2"><mtext id="A1.Ex11.m1.1.1.3.2.2.cmml" xref="A1.Ex11.m1.1.1.3.2.2">FLOPs</mtext></ci><ci id="A1.Ex11.m1.1.1.3.2.3a.cmml" xref="A1.Ex11.m1.1.1.3.2.3"><mtext id="A1.Ex11.m1.1.1.3.2.3.cmml" mathsize="70%" xref="A1.Ex11.m1.1.1.3.2.3">emb</mtext></ci></apply><apply id="A1.Ex11.m1.1.1.3.3.cmml" xref="A1.Ex11.m1.1.1.3.3"><csymbol cd="ambiguous" id="A1.Ex11.m1.1.1.3.3.1.cmml" xref="A1.Ex11.m1.1.1.3.3">subscript</csymbol><ci id="A1.Ex11.m1.1.1.3.3.2a.cmml" xref="A1.Ex11.m1.1.1.3.3.2"><mtext id="A1.Ex11.m1.1.1.3.3.2.cmml" xref="A1.Ex11.m1.1.1.3.3.2">FLOPs</mtext></ci><ci id="A1.Ex11.m1.1.1.3.3.3a.cmml" xref="A1.Ex11.m1.1.1.3.3.3"><mtext id="A1.Ex11.m1.1.1.3.3.3.cmml" mathsize="70%" xref="A1.Ex11.m1.1.1.3.3.3">layer</mtext></ci></apply><apply id="A1.Ex11.m1.1.1.3.4.cmml" xref="A1.Ex11.m1.1.1.3.4"><csymbol cd="ambiguous" id="A1.Ex11.m1.1.1.3.4.1.cmml" xref="A1.Ex11.m1.1.1.3.4">subscript</csymbol><ci id="A1.Ex11.m1.1.1.3.4.2a.cmml" xref="A1.Ex11.m1.1.1.3.4.2"><mtext id="A1.Ex11.m1.1.1.3.4.2.cmml" xref="A1.Ex11.m1.1.1.3.4.2">FLOPs</mtext></ci><ci id="A1.Ex11.m1.1.1.3.4.3a.cmml" xref="A1.Ex11.m1.1.1.3.4.3"><mtext id="A1.Ex11.m1.1.1.3.4.3.cmml" mathsize="70%" xref="A1.Ex11.m1.1.1.3.4.3">out</mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex11.m1.1c">\text{FLOPs}_{\text{forward}}=\text{FLOPs}_{\text{emb}}+\text{FLOPs}_{\text{%
layer}}+\text{FLOPs}_{\text{out}}</annotation><annotation encoding="application/x-llamapun" id="A1.Ex11.m1.1d">FLOPs start_POSTSUBSCRIPT forward end_POSTSUBSCRIPT = FLOPs start_POSTSUBSCRIPT emb end_POSTSUBSCRIPT + FLOPs start_POSTSUBSCRIPT layer end_POSTSUBSCRIPT + FLOPs start_POSTSUBSCRIPT out end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="A1.SS3.SSS1.p5">
<p class="ltx_p" id="A1.SS3.SSS1.p5.1"><span class="ltx_text ltx_font_bold" id="A1.SS3.SSS1.p5.1.1">Total Training FLOPs per Step:</span></p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="A1.SS3.SSS1.p6">
<p class="ltx_p" id="A1.SS3.SSS1.p6.1">The backward pass is approximately twice as computationally intensive as the forward pass. Therefore:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equation ltx_eqn_table" id="A1.Ex12">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\text{FLOPs}_{\text{train\_step}}=\text{FLOPs}_{\text{forward}}+2\times\text{%
FLOPs}_{\text{forward}}=3\times\text{FLOPs}_{\text{forward}}" class="ltx_Math" display="block" id="A1.Ex12.m1.1"><semantics id="A1.Ex12.m1.1a"><mrow id="A1.Ex12.m1.1.1" xref="A1.Ex12.m1.1.1.cmml"><msub id="A1.Ex12.m1.1.1.2" xref="A1.Ex12.m1.1.1.2.cmml"><mtext id="A1.Ex12.m1.1.1.2.2" xref="A1.Ex12.m1.1.1.2.2a.cmml">FLOPs</mtext><mtext id="A1.Ex12.m1.1.1.2.3" xref="A1.Ex12.m1.1.1.2.3a.cmml">train_step</mtext></msub><mo id="A1.Ex12.m1.1.1.3" xref="A1.Ex12.m1.1.1.3.cmml">=</mo><mrow id="A1.Ex12.m1.1.1.4" xref="A1.Ex12.m1.1.1.4.cmml"><msub id="A1.Ex12.m1.1.1.4.2" xref="A1.Ex12.m1.1.1.4.2.cmml"><mtext id="A1.Ex12.m1.1.1.4.2.2" xref="A1.Ex12.m1.1.1.4.2.2a.cmml">FLOPs</mtext><mtext id="A1.Ex12.m1.1.1.4.2.3" xref="A1.Ex12.m1.1.1.4.2.3a.cmml">forward</mtext></msub><mo id="A1.Ex12.m1.1.1.4.1" xref="A1.Ex12.m1.1.1.4.1.cmml">+</mo><mrow id="A1.Ex12.m1.1.1.4.3" xref="A1.Ex12.m1.1.1.4.3.cmml"><mn id="A1.Ex12.m1.1.1.4.3.2" xref="A1.Ex12.m1.1.1.4.3.2.cmml">2</mn><mo id="A1.Ex12.m1.1.1.4.3.1" lspace="0.222em" rspace="0.222em" xref="A1.Ex12.m1.1.1.4.3.1.cmml">×</mo><msub id="A1.Ex12.m1.1.1.4.3.3" xref="A1.Ex12.m1.1.1.4.3.3.cmml"><mtext id="A1.Ex12.m1.1.1.4.3.3.2" xref="A1.Ex12.m1.1.1.4.3.3.2a.cmml">FLOPs</mtext><mtext id="A1.Ex12.m1.1.1.4.3.3.3" xref="A1.Ex12.m1.1.1.4.3.3.3a.cmml">forward</mtext></msub></mrow></mrow><mo id="A1.Ex12.m1.1.1.5" xref="A1.Ex12.m1.1.1.5.cmml">=</mo><mrow id="A1.Ex12.m1.1.1.6" xref="A1.Ex12.m1.1.1.6.cmml"><mn id="A1.Ex12.m1.1.1.6.2" xref="A1.Ex12.m1.1.1.6.2.cmml">3</mn><mo id="A1.Ex12.m1.1.1.6.1" lspace="0.222em" rspace="0.222em" xref="A1.Ex12.m1.1.1.6.1.cmml">×</mo><msub id="A1.Ex12.m1.1.1.6.3" xref="A1.Ex12.m1.1.1.6.3.cmml"><mtext id="A1.Ex12.m1.1.1.6.3.2" xref="A1.Ex12.m1.1.1.6.3.2a.cmml">FLOPs</mtext><mtext id="A1.Ex12.m1.1.1.6.3.3" xref="A1.Ex12.m1.1.1.6.3.3a.cmml">forward</mtext></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex12.m1.1b"><apply id="A1.Ex12.m1.1.1.cmml" xref="A1.Ex12.m1.1.1"><and id="A1.Ex12.m1.1.1a.cmml" xref="A1.Ex12.m1.1.1"></and><apply id="A1.Ex12.m1.1.1b.cmml" xref="A1.Ex12.m1.1.1"><eq id="A1.Ex12.m1.1.1.3.cmml" xref="A1.Ex12.m1.1.1.3"></eq><apply id="A1.Ex12.m1.1.1.2.cmml" xref="A1.Ex12.m1.1.1.2"><csymbol cd="ambiguous" id="A1.Ex12.m1.1.1.2.1.cmml" xref="A1.Ex12.m1.1.1.2">subscript</csymbol><ci id="A1.Ex12.m1.1.1.2.2a.cmml" xref="A1.Ex12.m1.1.1.2.2"><mtext id="A1.Ex12.m1.1.1.2.2.cmml" xref="A1.Ex12.m1.1.1.2.2">FLOPs</mtext></ci><ci id="A1.Ex12.m1.1.1.2.3a.cmml" xref="A1.Ex12.m1.1.1.2.3"><mtext id="A1.Ex12.m1.1.1.2.3.cmml" mathsize="70%" xref="A1.Ex12.m1.1.1.2.3">train_step</mtext></ci></apply><apply id="A1.Ex12.m1.1.1.4.cmml" xref="A1.Ex12.m1.1.1.4"><plus id="A1.Ex12.m1.1.1.4.1.cmml" xref="A1.Ex12.m1.1.1.4.1"></plus><apply id="A1.Ex12.m1.1.1.4.2.cmml" xref="A1.Ex12.m1.1.1.4.2"><csymbol cd="ambiguous" id="A1.Ex12.m1.1.1.4.2.1.cmml" xref="A1.Ex12.m1.1.1.4.2">subscript</csymbol><ci id="A1.Ex12.m1.1.1.4.2.2a.cmml" xref="A1.Ex12.m1.1.1.4.2.2"><mtext id="A1.Ex12.m1.1.1.4.2.2.cmml" xref="A1.Ex12.m1.1.1.4.2.2">FLOPs</mtext></ci><ci id="A1.Ex12.m1.1.1.4.2.3a.cmml" xref="A1.Ex12.m1.1.1.4.2.3"><mtext id="A1.Ex12.m1.1.1.4.2.3.cmml" mathsize="70%" xref="A1.Ex12.m1.1.1.4.2.3">forward</mtext></ci></apply><apply id="A1.Ex12.m1.1.1.4.3.cmml" xref="A1.Ex12.m1.1.1.4.3"><times id="A1.Ex12.m1.1.1.4.3.1.cmml" xref="A1.Ex12.m1.1.1.4.3.1"></times><cn id="A1.Ex12.m1.1.1.4.3.2.cmml" type="integer" xref="A1.Ex12.m1.1.1.4.3.2">2</cn><apply id="A1.Ex12.m1.1.1.4.3.3.cmml" xref="A1.Ex12.m1.1.1.4.3.3"><csymbol cd="ambiguous" id="A1.Ex12.m1.1.1.4.3.3.1.cmml" xref="A1.Ex12.m1.1.1.4.3.3">subscript</csymbol><ci id="A1.Ex12.m1.1.1.4.3.3.2a.cmml" xref="A1.Ex12.m1.1.1.4.3.3.2"><mtext id="A1.Ex12.m1.1.1.4.3.3.2.cmml" xref="A1.Ex12.m1.1.1.4.3.3.2">FLOPs</mtext></ci><ci id="A1.Ex12.m1.1.1.4.3.3.3a.cmml" xref="A1.Ex12.m1.1.1.4.3.3.3"><mtext id="A1.Ex12.m1.1.1.4.3.3.3.cmml" mathsize="70%" xref="A1.Ex12.m1.1.1.4.3.3.3">forward</mtext></ci></apply></apply></apply></apply><apply id="A1.Ex12.m1.1.1c.cmml" xref="A1.Ex12.m1.1.1"><eq id="A1.Ex12.m1.1.1.5.cmml" xref="A1.Ex12.m1.1.1.5"></eq><share href="https://arxiv.org/html/2410.03529v1#A1.Ex12.m1.1.1.4.cmml" id="A1.Ex12.m1.1.1d.cmml" xref="A1.Ex12.m1.1.1"></share><apply id="A1.Ex12.m1.1.1.6.cmml" xref="A1.Ex12.m1.1.1.6"><times id="A1.Ex12.m1.1.1.6.1.cmml" xref="A1.Ex12.m1.1.1.6.1"></times><cn id="A1.Ex12.m1.1.1.6.2.cmml" type="integer" xref="A1.Ex12.m1.1.1.6.2">3</cn><apply id="A1.Ex12.m1.1.1.6.3.cmml" xref="A1.Ex12.m1.1.1.6.3"><csymbol cd="ambiguous" id="A1.Ex12.m1.1.1.6.3.1.cmml" xref="A1.Ex12.m1.1.1.6.3">subscript</csymbol><ci id="A1.Ex12.m1.1.1.6.3.2a.cmml" xref="A1.Ex12.m1.1.1.6.3.2"><mtext id="A1.Ex12.m1.1.1.6.3.2.cmml" xref="A1.Ex12.m1.1.1.6.3.2">FLOPs</mtext></ci><ci id="A1.Ex12.m1.1.1.6.3.3a.cmml" xref="A1.Ex12.m1.1.1.6.3.3"><mtext id="A1.Ex12.m1.1.1.6.3.3.cmml" mathsize="70%" xref="A1.Ex12.m1.1.1.6.3.3">forward</mtext></ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex12.m1.1c">\text{FLOPs}_{\text{train\_step}}=\text{FLOPs}_{\text{forward}}+2\times\text{%
FLOPs}_{\text{forward}}=3\times\text{FLOPs}_{\text{forward}}</annotation><annotation encoding="application/x-llamapun" id="A1.Ex12.m1.1d">FLOPs start_POSTSUBSCRIPT train_step end_POSTSUBSCRIPT = FLOPs start_POSTSUBSCRIPT forward end_POSTSUBSCRIPT + 2 × FLOPs start_POSTSUBSCRIPT forward end_POSTSUBSCRIPT = 3 × FLOPs start_POSTSUBSCRIPT forward end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="A1.SS3.SSS1.p7">
<p class="ltx_p" id="A1.SS3.SSS1.p7.1"><span class="ltx_text ltx_font_bold" id="A1.SS3.SSS1.p7.1.1">Total Training FLOPs:</span></p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="A1.SS3.SSS1.p8">
<p class="ltx_p" id="A1.SS3.SSS1.p8.1">Multiplying the FLOPs per training step by the total number of training steps:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equation ltx_eqn_table" id="A1.Ex13">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\text{Total Training FLOPs}=\text{FLOPs}_{\text{train\_step}}\times N_{\text{%
steps}}=3\times\text{FLOPs}_{\text{forward}}\times N_{\text{steps}}" class="ltx_Math" display="block" id="A1.Ex13.m1.1"><semantics id="A1.Ex13.m1.1a"><mrow id="A1.Ex13.m1.1.1" xref="A1.Ex13.m1.1.1.cmml"><mtext id="A1.Ex13.m1.1.1.2" xref="A1.Ex13.m1.1.1.2a.cmml">Total Training FLOPs</mtext><mo id="A1.Ex13.m1.1.1.3" xref="A1.Ex13.m1.1.1.3.cmml">=</mo><mrow id="A1.Ex13.m1.1.1.4" xref="A1.Ex13.m1.1.1.4.cmml"><msub id="A1.Ex13.m1.1.1.4.2" xref="A1.Ex13.m1.1.1.4.2.cmml"><mtext id="A1.Ex13.m1.1.1.4.2.2" xref="A1.Ex13.m1.1.1.4.2.2a.cmml">FLOPs</mtext><mtext id="A1.Ex13.m1.1.1.4.2.3" xref="A1.Ex13.m1.1.1.4.2.3a.cmml">train_step</mtext></msub><mo id="A1.Ex13.m1.1.1.4.1" lspace="0.222em" rspace="0.222em" xref="A1.Ex13.m1.1.1.4.1.cmml">×</mo><msub id="A1.Ex13.m1.1.1.4.3" xref="A1.Ex13.m1.1.1.4.3.cmml"><mi id="A1.Ex13.m1.1.1.4.3.2" xref="A1.Ex13.m1.1.1.4.3.2.cmml">N</mi><mtext id="A1.Ex13.m1.1.1.4.3.3" xref="A1.Ex13.m1.1.1.4.3.3a.cmml">steps</mtext></msub></mrow><mo id="A1.Ex13.m1.1.1.5" xref="A1.Ex13.m1.1.1.5.cmml">=</mo><mrow id="A1.Ex13.m1.1.1.6" xref="A1.Ex13.m1.1.1.6.cmml"><mn id="A1.Ex13.m1.1.1.6.2" xref="A1.Ex13.m1.1.1.6.2.cmml">3</mn><mo id="A1.Ex13.m1.1.1.6.1" lspace="0.222em" rspace="0.222em" xref="A1.Ex13.m1.1.1.6.1.cmml">×</mo><msub id="A1.Ex13.m1.1.1.6.3" xref="A1.Ex13.m1.1.1.6.3.cmml"><mtext id="A1.Ex13.m1.1.1.6.3.2" xref="A1.Ex13.m1.1.1.6.3.2a.cmml">FLOPs</mtext><mtext id="A1.Ex13.m1.1.1.6.3.3" xref="A1.Ex13.m1.1.1.6.3.3a.cmml">forward</mtext></msub><mo id="A1.Ex13.m1.1.1.6.1a" lspace="0.222em" rspace="0.222em" xref="A1.Ex13.m1.1.1.6.1.cmml">×</mo><msub id="A1.Ex13.m1.1.1.6.4" xref="A1.Ex13.m1.1.1.6.4.cmml"><mi id="A1.Ex13.m1.1.1.6.4.2" xref="A1.Ex13.m1.1.1.6.4.2.cmml">N</mi><mtext id="A1.Ex13.m1.1.1.6.4.3" xref="A1.Ex13.m1.1.1.6.4.3a.cmml">steps</mtext></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex13.m1.1b"><apply id="A1.Ex13.m1.1.1.cmml" xref="A1.Ex13.m1.1.1"><and id="A1.Ex13.m1.1.1a.cmml" xref="A1.Ex13.m1.1.1"></and><apply id="A1.Ex13.m1.1.1b.cmml" xref="A1.Ex13.m1.1.1"><eq id="A1.Ex13.m1.1.1.3.cmml" xref="A1.Ex13.m1.1.1.3"></eq><ci id="A1.Ex13.m1.1.1.2a.cmml" xref="A1.Ex13.m1.1.1.2"><mtext id="A1.Ex13.m1.1.1.2.cmml" xref="A1.Ex13.m1.1.1.2">Total Training FLOPs</mtext></ci><apply id="A1.Ex13.m1.1.1.4.cmml" xref="A1.Ex13.m1.1.1.4"><times id="A1.Ex13.m1.1.1.4.1.cmml" xref="A1.Ex13.m1.1.1.4.1"></times><apply id="A1.Ex13.m1.1.1.4.2.cmml" xref="A1.Ex13.m1.1.1.4.2"><csymbol cd="ambiguous" id="A1.Ex13.m1.1.1.4.2.1.cmml" xref="A1.Ex13.m1.1.1.4.2">subscript</csymbol><ci id="A1.Ex13.m1.1.1.4.2.2a.cmml" xref="A1.Ex13.m1.1.1.4.2.2"><mtext id="A1.Ex13.m1.1.1.4.2.2.cmml" xref="A1.Ex13.m1.1.1.4.2.2">FLOPs</mtext></ci><ci id="A1.Ex13.m1.1.1.4.2.3a.cmml" xref="A1.Ex13.m1.1.1.4.2.3"><mtext id="A1.Ex13.m1.1.1.4.2.3.cmml" mathsize="70%" xref="A1.Ex13.m1.1.1.4.2.3">train_step</mtext></ci></apply><apply id="A1.Ex13.m1.1.1.4.3.cmml" xref="A1.Ex13.m1.1.1.4.3"><csymbol cd="ambiguous" id="A1.Ex13.m1.1.1.4.3.1.cmml" xref="A1.Ex13.m1.1.1.4.3">subscript</csymbol><ci id="A1.Ex13.m1.1.1.4.3.2.cmml" xref="A1.Ex13.m1.1.1.4.3.2">𝑁</ci><ci id="A1.Ex13.m1.1.1.4.3.3a.cmml" xref="A1.Ex13.m1.1.1.4.3.3"><mtext id="A1.Ex13.m1.1.1.4.3.3.cmml" mathsize="70%" xref="A1.Ex13.m1.1.1.4.3.3">steps</mtext></ci></apply></apply></apply><apply id="A1.Ex13.m1.1.1c.cmml" xref="A1.Ex13.m1.1.1"><eq id="A1.Ex13.m1.1.1.5.cmml" xref="A1.Ex13.m1.1.1.5"></eq><share href="https://arxiv.org/html/2410.03529v1#A1.Ex13.m1.1.1.4.cmml" id="A1.Ex13.m1.1.1d.cmml" xref="A1.Ex13.m1.1.1"></share><apply id="A1.Ex13.m1.1.1.6.cmml" xref="A1.Ex13.m1.1.1.6"><times id="A1.Ex13.m1.1.1.6.1.cmml" xref="A1.Ex13.m1.1.1.6.1"></times><cn id="A1.Ex13.m1.1.1.6.2.cmml" type="integer" xref="A1.Ex13.m1.1.1.6.2">3</cn><apply id="A1.Ex13.m1.1.1.6.3.cmml" xref="A1.Ex13.m1.1.1.6.3"><csymbol cd="ambiguous" id="A1.Ex13.m1.1.1.6.3.1.cmml" xref="A1.Ex13.m1.1.1.6.3">subscript</csymbol><ci id="A1.Ex13.m1.1.1.6.3.2a.cmml" xref="A1.Ex13.m1.1.1.6.3.2"><mtext id="A1.Ex13.m1.1.1.6.3.2.cmml" xref="A1.Ex13.m1.1.1.6.3.2">FLOPs</mtext></ci><ci id="A1.Ex13.m1.1.1.6.3.3a.cmml" xref="A1.Ex13.m1.1.1.6.3.3"><mtext id="A1.Ex13.m1.1.1.6.3.3.cmml" mathsize="70%" xref="A1.Ex13.m1.1.1.6.3.3">forward</mtext></ci></apply><apply id="A1.Ex13.m1.1.1.6.4.cmml" xref="A1.Ex13.m1.1.1.6.4"><csymbol cd="ambiguous" id="A1.Ex13.m1.1.1.6.4.1.cmml" xref="A1.Ex13.m1.1.1.6.4">subscript</csymbol><ci id="A1.Ex13.m1.1.1.6.4.2.cmml" xref="A1.Ex13.m1.1.1.6.4.2">𝑁</ci><ci id="A1.Ex13.m1.1.1.6.4.3a.cmml" xref="A1.Ex13.m1.1.1.6.4.3"><mtext id="A1.Ex13.m1.1.1.6.4.3.cmml" mathsize="70%" xref="A1.Ex13.m1.1.1.6.4.3">steps</mtext></ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex13.m1.1c">\text{Total Training FLOPs}=\text{FLOPs}_{\text{train\_step}}\times N_{\text{%
steps}}=3\times\text{FLOPs}_{\text{forward}}\times N_{\text{steps}}</annotation><annotation encoding="application/x-llamapun" id="A1.Ex13.m1.1d">Total Training FLOPs = FLOPs start_POSTSUBSCRIPT train_step end_POSTSUBSCRIPT × italic_N start_POSTSUBSCRIPT steps end_POSTSUBSCRIPT = 3 × FLOPs start_POSTSUBSCRIPT forward end_POSTSUBSCRIPT × italic_N start_POSTSUBSCRIPT steps end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="A1.SS3.SSS1.p9">
<p class="ltx_p" id="A1.SS3.SSS1.p9.1"><span class="ltx_text ltx_font_bold" id="A1.SS3.SSS1.p9.1.1">Total Training FLOPs:</span></p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A3.EGx3">
<tbody id="A1.Ex14"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\text{Total Training FLOPs}=3\times N_{\text{steps}}\times\Bigg{[}" class="ltx_math_unparsed" display="inline" id="A1.Ex14.m1.1"><semantics id="A1.Ex14.m1.1a"><mrow id="A1.Ex14.m1.1b"><mtext id="A1.Ex14.m1.1.1">Total Training FLOPs</mtext><mo id="A1.Ex14.m1.1.2">=</mo><mn id="A1.Ex14.m1.1.3">3</mn><mo id="A1.Ex14.m1.1.4" lspace="0.222em" rspace="0.222em">×</mo><msub id="A1.Ex14.m1.1.5"><mi id="A1.Ex14.m1.1.5.2">N</mi><mtext id="A1.Ex14.m1.1.5.3">steps</mtext></msub><mo id="A1.Ex14.m1.1.6" lspace="0.222em" rspace="0.222em">×</mo><mo id="A1.Ex14.m1.1.7" maxsize="260%" minsize="260%">[</mo></mrow><annotation encoding="application/x-tex" id="A1.Ex14.m1.1c">\displaystyle\text{Total Training FLOPs}=3\times N_{\text{steps}}\times\Bigg{[}</annotation><annotation encoding="application/x-llamapun" id="A1.Ex14.m1.1d">Total Training FLOPs = 3 × italic_N start_POSTSUBSCRIPT steps end_POSTSUBSCRIPT × [</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle B\times S\times H" class="ltx_Math" display="inline" id="A1.Ex14.m2.1"><semantics id="A1.Ex14.m2.1a"><mrow id="A1.Ex14.m2.1.1" xref="A1.Ex14.m2.1.1.cmml"><mi id="A1.Ex14.m2.1.1.2" xref="A1.Ex14.m2.1.1.2.cmml">B</mi><mo id="A1.Ex14.m2.1.1.1" lspace="0.222em" rspace="0.222em" xref="A1.Ex14.m2.1.1.1.cmml">×</mo><mi id="A1.Ex14.m2.1.1.3" xref="A1.Ex14.m2.1.1.3.cmml">S</mi><mo id="A1.Ex14.m2.1.1.1a" lspace="0.222em" rspace="0.222em" xref="A1.Ex14.m2.1.1.1.cmml">×</mo><mi id="A1.Ex14.m2.1.1.4" xref="A1.Ex14.m2.1.1.4.cmml">H</mi></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex14.m2.1b"><apply id="A1.Ex14.m2.1.1.cmml" xref="A1.Ex14.m2.1.1"><times id="A1.Ex14.m2.1.1.1.cmml" xref="A1.Ex14.m2.1.1.1"></times><ci id="A1.Ex14.m2.1.1.2.cmml" xref="A1.Ex14.m2.1.1.2">𝐵</ci><ci id="A1.Ex14.m2.1.1.3.cmml" xref="A1.Ex14.m2.1.1.3">𝑆</ci><ci id="A1.Ex14.m2.1.1.4.cmml" xref="A1.Ex14.m2.1.1.4">𝐻</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex14.m2.1c">\displaystyle B\times S\times H</annotation><annotation encoding="application/x-llamapun" id="A1.Ex14.m2.1d">italic_B × italic_S × italic_H</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A1.Ex15"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle+L\times\Big{(}8\times B\times S\times H^{2}+4\times B\times S^{2%
}\times H+4\times B\times S\times H\times D_{\text{ff}}\Big{)}" class="ltx_Math" display="inline" id="A1.Ex15.m1.1"><semantics id="A1.Ex15.m1.1a"><mrow id="A1.Ex15.m1.1.1" xref="A1.Ex15.m1.1.1.cmml"><mo id="A1.Ex15.m1.1.1a" xref="A1.Ex15.m1.1.1.cmml">+</mo><mrow id="A1.Ex15.m1.1.1.1" xref="A1.Ex15.m1.1.1.1.cmml"><mi id="A1.Ex15.m1.1.1.1.3" xref="A1.Ex15.m1.1.1.1.3.cmml">L</mi><mo id="A1.Ex15.m1.1.1.1.2" lspace="0.222em" rspace="0.222em" xref="A1.Ex15.m1.1.1.1.2.cmml">×</mo><mrow id="A1.Ex15.m1.1.1.1.1.1" xref="A1.Ex15.m1.1.1.1.1.1.1.cmml"><mo id="A1.Ex15.m1.1.1.1.1.1.2" maxsize="160%" minsize="160%" xref="A1.Ex15.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.Ex15.m1.1.1.1.1.1.1" xref="A1.Ex15.m1.1.1.1.1.1.1.cmml"><mrow id="A1.Ex15.m1.1.1.1.1.1.1.2" xref="A1.Ex15.m1.1.1.1.1.1.1.2.cmml"><mn id="A1.Ex15.m1.1.1.1.1.1.1.2.2" xref="A1.Ex15.m1.1.1.1.1.1.1.2.2.cmml">8</mn><mo id="A1.Ex15.m1.1.1.1.1.1.1.2.1" lspace="0.222em" rspace="0.222em" xref="A1.Ex15.m1.1.1.1.1.1.1.2.1.cmml">×</mo><mi id="A1.Ex15.m1.1.1.1.1.1.1.2.3" xref="A1.Ex15.m1.1.1.1.1.1.1.2.3.cmml">B</mi><mo id="A1.Ex15.m1.1.1.1.1.1.1.2.1a" lspace="0.222em" rspace="0.222em" xref="A1.Ex15.m1.1.1.1.1.1.1.2.1.cmml">×</mo><mi id="A1.Ex15.m1.1.1.1.1.1.1.2.4" xref="A1.Ex15.m1.1.1.1.1.1.1.2.4.cmml">S</mi><mo id="A1.Ex15.m1.1.1.1.1.1.1.2.1b" lspace="0.222em" rspace="0.222em" xref="A1.Ex15.m1.1.1.1.1.1.1.2.1.cmml">×</mo><msup id="A1.Ex15.m1.1.1.1.1.1.1.2.5" xref="A1.Ex15.m1.1.1.1.1.1.1.2.5.cmml"><mi id="A1.Ex15.m1.1.1.1.1.1.1.2.5.2" xref="A1.Ex15.m1.1.1.1.1.1.1.2.5.2.cmml">H</mi><mn id="A1.Ex15.m1.1.1.1.1.1.1.2.5.3" xref="A1.Ex15.m1.1.1.1.1.1.1.2.5.3.cmml">2</mn></msup></mrow><mo id="A1.Ex15.m1.1.1.1.1.1.1.1" xref="A1.Ex15.m1.1.1.1.1.1.1.1.cmml">+</mo><mrow id="A1.Ex15.m1.1.1.1.1.1.1.3" xref="A1.Ex15.m1.1.1.1.1.1.1.3.cmml"><mn id="A1.Ex15.m1.1.1.1.1.1.1.3.2" xref="A1.Ex15.m1.1.1.1.1.1.1.3.2.cmml">4</mn><mo id="A1.Ex15.m1.1.1.1.1.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="A1.Ex15.m1.1.1.1.1.1.1.3.1.cmml">×</mo><mi id="A1.Ex15.m1.1.1.1.1.1.1.3.3" xref="A1.Ex15.m1.1.1.1.1.1.1.3.3.cmml">B</mi><mo id="A1.Ex15.m1.1.1.1.1.1.1.3.1a" lspace="0.222em" rspace="0.222em" xref="A1.Ex15.m1.1.1.1.1.1.1.3.1.cmml">×</mo><msup id="A1.Ex15.m1.1.1.1.1.1.1.3.4" xref="A1.Ex15.m1.1.1.1.1.1.1.3.4.cmml"><mi id="A1.Ex15.m1.1.1.1.1.1.1.3.4.2" xref="A1.Ex15.m1.1.1.1.1.1.1.3.4.2.cmml">S</mi><mn id="A1.Ex15.m1.1.1.1.1.1.1.3.4.3" xref="A1.Ex15.m1.1.1.1.1.1.1.3.4.3.cmml">2</mn></msup><mo id="A1.Ex15.m1.1.1.1.1.1.1.3.1b" lspace="0.222em" rspace="0.222em" xref="A1.Ex15.m1.1.1.1.1.1.1.3.1.cmml">×</mo><mi id="A1.Ex15.m1.1.1.1.1.1.1.3.5" xref="A1.Ex15.m1.1.1.1.1.1.1.3.5.cmml">H</mi></mrow><mo id="A1.Ex15.m1.1.1.1.1.1.1.1a" xref="A1.Ex15.m1.1.1.1.1.1.1.1.cmml">+</mo><mrow id="A1.Ex15.m1.1.1.1.1.1.1.4" xref="A1.Ex15.m1.1.1.1.1.1.1.4.cmml"><mn id="A1.Ex15.m1.1.1.1.1.1.1.4.2" xref="A1.Ex15.m1.1.1.1.1.1.1.4.2.cmml">4</mn><mo id="A1.Ex15.m1.1.1.1.1.1.1.4.1" lspace="0.222em" rspace="0.222em" xref="A1.Ex15.m1.1.1.1.1.1.1.4.1.cmml">×</mo><mi id="A1.Ex15.m1.1.1.1.1.1.1.4.3" xref="A1.Ex15.m1.1.1.1.1.1.1.4.3.cmml">B</mi><mo id="A1.Ex15.m1.1.1.1.1.1.1.4.1a" lspace="0.222em" rspace="0.222em" xref="A1.Ex15.m1.1.1.1.1.1.1.4.1.cmml">×</mo><mi id="A1.Ex15.m1.1.1.1.1.1.1.4.4" xref="A1.Ex15.m1.1.1.1.1.1.1.4.4.cmml">S</mi><mo id="A1.Ex15.m1.1.1.1.1.1.1.4.1b" lspace="0.222em" rspace="0.222em" xref="A1.Ex15.m1.1.1.1.1.1.1.4.1.cmml">×</mo><mi id="A1.Ex15.m1.1.1.1.1.1.1.4.5" xref="A1.Ex15.m1.1.1.1.1.1.1.4.5.cmml">H</mi><mo id="A1.Ex15.m1.1.1.1.1.1.1.4.1c" lspace="0.222em" rspace="0.222em" xref="A1.Ex15.m1.1.1.1.1.1.1.4.1.cmml">×</mo><msub id="A1.Ex15.m1.1.1.1.1.1.1.4.6" xref="A1.Ex15.m1.1.1.1.1.1.1.4.6.cmml"><mi id="A1.Ex15.m1.1.1.1.1.1.1.4.6.2" xref="A1.Ex15.m1.1.1.1.1.1.1.4.6.2.cmml">D</mi><mtext id="A1.Ex15.m1.1.1.1.1.1.1.4.6.3" xref="A1.Ex15.m1.1.1.1.1.1.1.4.6.3a.cmml">ff</mtext></msub></mrow></mrow><mo id="A1.Ex15.m1.1.1.1.1.1.3" maxsize="160%" minsize="160%" xref="A1.Ex15.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex15.m1.1b"><apply id="A1.Ex15.m1.1.1.cmml" xref="A1.Ex15.m1.1.1"><plus id="A1.Ex15.m1.1.1.2.cmml" xref="A1.Ex15.m1.1.1"></plus><apply id="A1.Ex15.m1.1.1.1.cmml" xref="A1.Ex15.m1.1.1.1"><times id="A1.Ex15.m1.1.1.1.2.cmml" xref="A1.Ex15.m1.1.1.1.2"></times><ci id="A1.Ex15.m1.1.1.1.3.cmml" xref="A1.Ex15.m1.1.1.1.3">𝐿</ci><apply id="A1.Ex15.m1.1.1.1.1.1.1.cmml" xref="A1.Ex15.m1.1.1.1.1.1"><plus id="A1.Ex15.m1.1.1.1.1.1.1.1.cmml" xref="A1.Ex15.m1.1.1.1.1.1.1.1"></plus><apply id="A1.Ex15.m1.1.1.1.1.1.1.2.cmml" xref="A1.Ex15.m1.1.1.1.1.1.1.2"><times id="A1.Ex15.m1.1.1.1.1.1.1.2.1.cmml" xref="A1.Ex15.m1.1.1.1.1.1.1.2.1"></times><cn id="A1.Ex15.m1.1.1.1.1.1.1.2.2.cmml" type="integer" xref="A1.Ex15.m1.1.1.1.1.1.1.2.2">8</cn><ci id="A1.Ex15.m1.1.1.1.1.1.1.2.3.cmml" xref="A1.Ex15.m1.1.1.1.1.1.1.2.3">𝐵</ci><ci id="A1.Ex15.m1.1.1.1.1.1.1.2.4.cmml" xref="A1.Ex15.m1.1.1.1.1.1.1.2.4">𝑆</ci><apply id="A1.Ex15.m1.1.1.1.1.1.1.2.5.cmml" xref="A1.Ex15.m1.1.1.1.1.1.1.2.5"><csymbol cd="ambiguous" id="A1.Ex15.m1.1.1.1.1.1.1.2.5.1.cmml" xref="A1.Ex15.m1.1.1.1.1.1.1.2.5">superscript</csymbol><ci id="A1.Ex15.m1.1.1.1.1.1.1.2.5.2.cmml" xref="A1.Ex15.m1.1.1.1.1.1.1.2.5.2">𝐻</ci><cn id="A1.Ex15.m1.1.1.1.1.1.1.2.5.3.cmml" type="integer" xref="A1.Ex15.m1.1.1.1.1.1.1.2.5.3">2</cn></apply></apply><apply id="A1.Ex15.m1.1.1.1.1.1.1.3.cmml" xref="A1.Ex15.m1.1.1.1.1.1.1.3"><times id="A1.Ex15.m1.1.1.1.1.1.1.3.1.cmml" xref="A1.Ex15.m1.1.1.1.1.1.1.3.1"></times><cn id="A1.Ex15.m1.1.1.1.1.1.1.3.2.cmml" type="integer" xref="A1.Ex15.m1.1.1.1.1.1.1.3.2">4</cn><ci id="A1.Ex15.m1.1.1.1.1.1.1.3.3.cmml" xref="A1.Ex15.m1.1.1.1.1.1.1.3.3">𝐵</ci><apply id="A1.Ex15.m1.1.1.1.1.1.1.3.4.cmml" xref="A1.Ex15.m1.1.1.1.1.1.1.3.4"><csymbol cd="ambiguous" id="A1.Ex15.m1.1.1.1.1.1.1.3.4.1.cmml" xref="A1.Ex15.m1.1.1.1.1.1.1.3.4">superscript</csymbol><ci id="A1.Ex15.m1.1.1.1.1.1.1.3.4.2.cmml" xref="A1.Ex15.m1.1.1.1.1.1.1.3.4.2">𝑆</ci><cn id="A1.Ex15.m1.1.1.1.1.1.1.3.4.3.cmml" type="integer" xref="A1.Ex15.m1.1.1.1.1.1.1.3.4.3">2</cn></apply><ci id="A1.Ex15.m1.1.1.1.1.1.1.3.5.cmml" xref="A1.Ex15.m1.1.1.1.1.1.1.3.5">𝐻</ci></apply><apply id="A1.Ex15.m1.1.1.1.1.1.1.4.cmml" xref="A1.Ex15.m1.1.1.1.1.1.1.4"><times id="A1.Ex15.m1.1.1.1.1.1.1.4.1.cmml" xref="A1.Ex15.m1.1.1.1.1.1.1.4.1"></times><cn id="A1.Ex15.m1.1.1.1.1.1.1.4.2.cmml" type="integer" xref="A1.Ex15.m1.1.1.1.1.1.1.4.2">4</cn><ci id="A1.Ex15.m1.1.1.1.1.1.1.4.3.cmml" xref="A1.Ex15.m1.1.1.1.1.1.1.4.3">𝐵</ci><ci id="A1.Ex15.m1.1.1.1.1.1.1.4.4.cmml" xref="A1.Ex15.m1.1.1.1.1.1.1.4.4">𝑆</ci><ci id="A1.Ex15.m1.1.1.1.1.1.1.4.5.cmml" xref="A1.Ex15.m1.1.1.1.1.1.1.4.5">𝐻</ci><apply id="A1.Ex15.m1.1.1.1.1.1.1.4.6.cmml" xref="A1.Ex15.m1.1.1.1.1.1.1.4.6"><csymbol cd="ambiguous" id="A1.Ex15.m1.1.1.1.1.1.1.4.6.1.cmml" xref="A1.Ex15.m1.1.1.1.1.1.1.4.6">subscript</csymbol><ci id="A1.Ex15.m1.1.1.1.1.1.1.4.6.2.cmml" xref="A1.Ex15.m1.1.1.1.1.1.1.4.6.2">𝐷</ci><ci id="A1.Ex15.m1.1.1.1.1.1.1.4.6.3a.cmml" xref="A1.Ex15.m1.1.1.1.1.1.1.4.6.3"><mtext id="A1.Ex15.m1.1.1.1.1.1.1.4.6.3.cmml" mathsize="70%" xref="A1.Ex15.m1.1.1.1.1.1.1.4.6.3">ff</mtext></ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex15.m1.1c">\displaystyle+L\times\Big{(}8\times B\times S\times H^{2}+4\times B\times S^{2%
}\times H+4\times B\times S\times H\times D_{\text{ff}}\Big{)}</annotation><annotation encoding="application/x-llamapun" id="A1.Ex15.m1.1d">+ italic_L × ( 8 × italic_B × italic_S × italic_H start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + 4 × italic_B × italic_S start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT × italic_H + 4 × italic_B × italic_S × italic_H × italic_D start_POSTSUBSCRIPT ff end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A1.E10"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle+2\times B\times S\times H\times V+3\times B\times S\times V\Bigg%
{]}" class="ltx_math_unparsed" display="inline" id="A1.E10.m1.1"><semantics id="A1.E10.m1.1a"><mrow id="A1.E10.m1.1b"><mo id="A1.E10.m1.1.1">+</mo><mn id="A1.E10.m1.1.2">2</mn><mo id="A1.E10.m1.1.3" lspace="0.222em" rspace="0.222em">×</mo><mi id="A1.E10.m1.1.4">B</mi><mo id="A1.E10.m1.1.5" lspace="0.222em" rspace="0.222em">×</mo><mi id="A1.E10.m1.1.6">S</mi><mo id="A1.E10.m1.1.7" lspace="0.222em" rspace="0.222em">×</mo><mi id="A1.E10.m1.1.8">H</mi><mo id="A1.E10.m1.1.9" lspace="0.222em" rspace="0.222em">×</mo><mi id="A1.E10.m1.1.10">V</mi><mo id="A1.E10.m1.1.11">+</mo><mn id="A1.E10.m1.1.12">3</mn><mo id="A1.E10.m1.1.13" lspace="0.222em" rspace="0.222em">×</mo><mi id="A1.E10.m1.1.14">B</mi><mo id="A1.E10.m1.1.15" lspace="0.222em" rspace="0.222em">×</mo><mi id="A1.E10.m1.1.16">S</mi><mo id="A1.E10.m1.1.17" lspace="0.222em" rspace="0.222em">×</mo><mi id="A1.E10.m1.1.18">V</mi><mo id="A1.E10.m1.1.19" maxsize="260%" minsize="260%">]</mo></mrow><annotation encoding="application/x-tex" id="A1.E10.m1.1c">\displaystyle+2\times B\times S\times H\times V+3\times B\times S\times V\Bigg%
{]}</annotation><annotation encoding="application/x-llamapun" id="A1.E10.m1.1d">+ 2 × italic_B × italic_S × italic_H × italic_V + 3 × italic_B × italic_S × italic_V ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="A1.SS3.SSS1.p10">
<p class="ltx_p" id="A1.SS3.SSS1.p10.1"><span class="ltx_text ltx_font_bold" id="A1.SS3.SSS1.p10.1.1">Total Inference FLOPs:</span></p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A3.EGx4">
<tbody id="A1.Ex16"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\text{Total Inference FLOPs}=" class="ltx_Math" display="inline" id="A1.Ex16.m1.1"><semantics id="A1.Ex16.m1.1a"><mrow id="A1.Ex16.m1.1.1" xref="A1.Ex16.m1.1.1.cmml"><mtext id="A1.Ex16.m1.1.1.2" xref="A1.Ex16.m1.1.1.2a.cmml">Total Inference FLOPs</mtext><mo id="A1.Ex16.m1.1.1.1" xref="A1.Ex16.m1.1.1.1.cmml">=</mo><mi id="A1.Ex16.m1.1.1.3" xref="A1.Ex16.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex16.m1.1b"><apply id="A1.Ex16.m1.1.1.cmml" xref="A1.Ex16.m1.1.1"><eq id="A1.Ex16.m1.1.1.1.cmml" xref="A1.Ex16.m1.1.1.1"></eq><ci id="A1.Ex16.m1.1.1.2a.cmml" xref="A1.Ex16.m1.1.1.2"><mtext id="A1.Ex16.m1.1.1.2.cmml" xref="A1.Ex16.m1.1.1.2">Total Inference FLOPs</mtext></ci><csymbol cd="latexml" id="A1.Ex16.m1.1.1.3.cmml" xref="A1.Ex16.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex16.m1.1c">\displaystyle\text{Total Inference FLOPs}=</annotation><annotation encoding="application/x-llamapun" id="A1.Ex16.m1.1d">Total Inference FLOPs =</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle B\times\Bigg{[}\times S\times H" class="ltx_math_unparsed" display="inline" id="A1.Ex16.m2.1"><semantics id="A1.Ex16.m2.1a"><mrow id="A1.Ex16.m2.1b"><mi id="A1.Ex16.m2.1.1">B</mi><mo id="A1.Ex16.m2.1.2" lspace="0.222em" rspace="0.222em">×</mo><mrow id="A1.Ex16.m2.1.3"><mo id="A1.Ex16.m2.1.3.1" maxsize="260%" minsize="260%">[</mo><mo id="A1.Ex16.m2.1.3.2" lspace="0em" rspace="0.222em">×</mo><mi id="A1.Ex16.m2.1.3.3">S</mi><mo id="A1.Ex16.m2.1.3.4" lspace="0.222em" rspace="0.222em">×</mo><mi id="A1.Ex16.m2.1.3.5">H</mi></mrow></mrow><annotation encoding="application/x-tex" id="A1.Ex16.m2.1c">\displaystyle B\times\Bigg{[}\times S\times H</annotation><annotation encoding="application/x-llamapun" id="A1.Ex16.m2.1d">italic_B × [ × italic_S × italic_H</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A1.Ex17"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle+L\times\Big{(}8\times S\times H^{2}+4\times S^{2}\times H+4%
\times S\times H\times D_{\text{ff}}\Big{)}" class="ltx_Math" display="inline" id="A1.Ex17.m1.1"><semantics id="A1.Ex17.m1.1a"><mrow id="A1.Ex17.m1.1.1" xref="A1.Ex17.m1.1.1.cmml"><mo id="A1.Ex17.m1.1.1a" xref="A1.Ex17.m1.1.1.cmml">+</mo><mrow id="A1.Ex17.m1.1.1.1" xref="A1.Ex17.m1.1.1.1.cmml"><mi id="A1.Ex17.m1.1.1.1.3" xref="A1.Ex17.m1.1.1.1.3.cmml">L</mi><mo id="A1.Ex17.m1.1.1.1.2" lspace="0.222em" rspace="0.222em" xref="A1.Ex17.m1.1.1.1.2.cmml">×</mo><mrow id="A1.Ex17.m1.1.1.1.1.1" xref="A1.Ex17.m1.1.1.1.1.1.1.cmml"><mo id="A1.Ex17.m1.1.1.1.1.1.2" maxsize="160%" minsize="160%" xref="A1.Ex17.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.Ex17.m1.1.1.1.1.1.1" xref="A1.Ex17.m1.1.1.1.1.1.1.cmml"><mrow id="A1.Ex17.m1.1.1.1.1.1.1.2" xref="A1.Ex17.m1.1.1.1.1.1.1.2.cmml"><mn id="A1.Ex17.m1.1.1.1.1.1.1.2.2" xref="A1.Ex17.m1.1.1.1.1.1.1.2.2.cmml">8</mn><mo id="A1.Ex17.m1.1.1.1.1.1.1.2.1" lspace="0.222em" rspace="0.222em" xref="A1.Ex17.m1.1.1.1.1.1.1.2.1.cmml">×</mo><mi id="A1.Ex17.m1.1.1.1.1.1.1.2.3" xref="A1.Ex17.m1.1.1.1.1.1.1.2.3.cmml">S</mi><mo id="A1.Ex17.m1.1.1.1.1.1.1.2.1a" lspace="0.222em" rspace="0.222em" xref="A1.Ex17.m1.1.1.1.1.1.1.2.1.cmml">×</mo><msup id="A1.Ex17.m1.1.1.1.1.1.1.2.4" xref="A1.Ex17.m1.1.1.1.1.1.1.2.4.cmml"><mi id="A1.Ex17.m1.1.1.1.1.1.1.2.4.2" xref="A1.Ex17.m1.1.1.1.1.1.1.2.4.2.cmml">H</mi><mn id="A1.Ex17.m1.1.1.1.1.1.1.2.4.3" xref="A1.Ex17.m1.1.1.1.1.1.1.2.4.3.cmml">2</mn></msup></mrow><mo id="A1.Ex17.m1.1.1.1.1.1.1.1" xref="A1.Ex17.m1.1.1.1.1.1.1.1.cmml">+</mo><mrow id="A1.Ex17.m1.1.1.1.1.1.1.3" xref="A1.Ex17.m1.1.1.1.1.1.1.3.cmml"><mn id="A1.Ex17.m1.1.1.1.1.1.1.3.2" xref="A1.Ex17.m1.1.1.1.1.1.1.3.2.cmml">4</mn><mo id="A1.Ex17.m1.1.1.1.1.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="A1.Ex17.m1.1.1.1.1.1.1.3.1.cmml">×</mo><msup id="A1.Ex17.m1.1.1.1.1.1.1.3.3" xref="A1.Ex17.m1.1.1.1.1.1.1.3.3.cmml"><mi id="A1.Ex17.m1.1.1.1.1.1.1.3.3.2" xref="A1.Ex17.m1.1.1.1.1.1.1.3.3.2.cmml">S</mi><mn id="A1.Ex17.m1.1.1.1.1.1.1.3.3.3" xref="A1.Ex17.m1.1.1.1.1.1.1.3.3.3.cmml">2</mn></msup><mo id="A1.Ex17.m1.1.1.1.1.1.1.3.1a" lspace="0.222em" rspace="0.222em" xref="A1.Ex17.m1.1.1.1.1.1.1.3.1.cmml">×</mo><mi id="A1.Ex17.m1.1.1.1.1.1.1.3.4" xref="A1.Ex17.m1.1.1.1.1.1.1.3.4.cmml">H</mi></mrow><mo id="A1.Ex17.m1.1.1.1.1.1.1.1a" xref="A1.Ex17.m1.1.1.1.1.1.1.1.cmml">+</mo><mrow id="A1.Ex17.m1.1.1.1.1.1.1.4" xref="A1.Ex17.m1.1.1.1.1.1.1.4.cmml"><mn id="A1.Ex17.m1.1.1.1.1.1.1.4.2" xref="A1.Ex17.m1.1.1.1.1.1.1.4.2.cmml">4</mn><mo id="A1.Ex17.m1.1.1.1.1.1.1.4.1" lspace="0.222em" rspace="0.222em" xref="A1.Ex17.m1.1.1.1.1.1.1.4.1.cmml">×</mo><mi id="A1.Ex17.m1.1.1.1.1.1.1.4.3" xref="A1.Ex17.m1.1.1.1.1.1.1.4.3.cmml">S</mi><mo id="A1.Ex17.m1.1.1.1.1.1.1.4.1a" lspace="0.222em" rspace="0.222em" xref="A1.Ex17.m1.1.1.1.1.1.1.4.1.cmml">×</mo><mi id="A1.Ex17.m1.1.1.1.1.1.1.4.4" xref="A1.Ex17.m1.1.1.1.1.1.1.4.4.cmml">H</mi><mo id="A1.Ex17.m1.1.1.1.1.1.1.4.1b" lspace="0.222em" rspace="0.222em" xref="A1.Ex17.m1.1.1.1.1.1.1.4.1.cmml">×</mo><msub id="A1.Ex17.m1.1.1.1.1.1.1.4.5" xref="A1.Ex17.m1.1.1.1.1.1.1.4.5.cmml"><mi id="A1.Ex17.m1.1.1.1.1.1.1.4.5.2" xref="A1.Ex17.m1.1.1.1.1.1.1.4.5.2.cmml">D</mi><mtext id="A1.Ex17.m1.1.1.1.1.1.1.4.5.3" xref="A1.Ex17.m1.1.1.1.1.1.1.4.5.3a.cmml">ff</mtext></msub></mrow></mrow><mo id="A1.Ex17.m1.1.1.1.1.1.3" maxsize="160%" minsize="160%" xref="A1.Ex17.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex17.m1.1b"><apply id="A1.Ex17.m1.1.1.cmml" xref="A1.Ex17.m1.1.1"><plus id="A1.Ex17.m1.1.1.2.cmml" xref="A1.Ex17.m1.1.1"></plus><apply id="A1.Ex17.m1.1.1.1.cmml" xref="A1.Ex17.m1.1.1.1"><times id="A1.Ex17.m1.1.1.1.2.cmml" xref="A1.Ex17.m1.1.1.1.2"></times><ci id="A1.Ex17.m1.1.1.1.3.cmml" xref="A1.Ex17.m1.1.1.1.3">𝐿</ci><apply id="A1.Ex17.m1.1.1.1.1.1.1.cmml" xref="A1.Ex17.m1.1.1.1.1.1"><plus id="A1.Ex17.m1.1.1.1.1.1.1.1.cmml" xref="A1.Ex17.m1.1.1.1.1.1.1.1"></plus><apply id="A1.Ex17.m1.1.1.1.1.1.1.2.cmml" xref="A1.Ex17.m1.1.1.1.1.1.1.2"><times id="A1.Ex17.m1.1.1.1.1.1.1.2.1.cmml" xref="A1.Ex17.m1.1.1.1.1.1.1.2.1"></times><cn id="A1.Ex17.m1.1.1.1.1.1.1.2.2.cmml" type="integer" xref="A1.Ex17.m1.1.1.1.1.1.1.2.2">8</cn><ci id="A1.Ex17.m1.1.1.1.1.1.1.2.3.cmml" xref="A1.Ex17.m1.1.1.1.1.1.1.2.3">𝑆</ci><apply id="A1.Ex17.m1.1.1.1.1.1.1.2.4.cmml" xref="A1.Ex17.m1.1.1.1.1.1.1.2.4"><csymbol cd="ambiguous" id="A1.Ex17.m1.1.1.1.1.1.1.2.4.1.cmml" xref="A1.Ex17.m1.1.1.1.1.1.1.2.4">superscript</csymbol><ci id="A1.Ex17.m1.1.1.1.1.1.1.2.4.2.cmml" xref="A1.Ex17.m1.1.1.1.1.1.1.2.4.2">𝐻</ci><cn id="A1.Ex17.m1.1.1.1.1.1.1.2.4.3.cmml" type="integer" xref="A1.Ex17.m1.1.1.1.1.1.1.2.4.3">2</cn></apply></apply><apply id="A1.Ex17.m1.1.1.1.1.1.1.3.cmml" xref="A1.Ex17.m1.1.1.1.1.1.1.3"><times id="A1.Ex17.m1.1.1.1.1.1.1.3.1.cmml" xref="A1.Ex17.m1.1.1.1.1.1.1.3.1"></times><cn id="A1.Ex17.m1.1.1.1.1.1.1.3.2.cmml" type="integer" xref="A1.Ex17.m1.1.1.1.1.1.1.3.2">4</cn><apply id="A1.Ex17.m1.1.1.1.1.1.1.3.3.cmml" xref="A1.Ex17.m1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="A1.Ex17.m1.1.1.1.1.1.1.3.3.1.cmml" xref="A1.Ex17.m1.1.1.1.1.1.1.3.3">superscript</csymbol><ci id="A1.Ex17.m1.1.1.1.1.1.1.3.3.2.cmml" xref="A1.Ex17.m1.1.1.1.1.1.1.3.3.2">𝑆</ci><cn id="A1.Ex17.m1.1.1.1.1.1.1.3.3.3.cmml" type="integer" xref="A1.Ex17.m1.1.1.1.1.1.1.3.3.3">2</cn></apply><ci id="A1.Ex17.m1.1.1.1.1.1.1.3.4.cmml" xref="A1.Ex17.m1.1.1.1.1.1.1.3.4">𝐻</ci></apply><apply id="A1.Ex17.m1.1.1.1.1.1.1.4.cmml" xref="A1.Ex17.m1.1.1.1.1.1.1.4"><times id="A1.Ex17.m1.1.1.1.1.1.1.4.1.cmml" xref="A1.Ex17.m1.1.1.1.1.1.1.4.1"></times><cn id="A1.Ex17.m1.1.1.1.1.1.1.4.2.cmml" type="integer" xref="A1.Ex17.m1.1.1.1.1.1.1.4.2">4</cn><ci id="A1.Ex17.m1.1.1.1.1.1.1.4.3.cmml" xref="A1.Ex17.m1.1.1.1.1.1.1.4.3">𝑆</ci><ci id="A1.Ex17.m1.1.1.1.1.1.1.4.4.cmml" xref="A1.Ex17.m1.1.1.1.1.1.1.4.4">𝐻</ci><apply id="A1.Ex17.m1.1.1.1.1.1.1.4.5.cmml" xref="A1.Ex17.m1.1.1.1.1.1.1.4.5"><csymbol cd="ambiguous" id="A1.Ex17.m1.1.1.1.1.1.1.4.5.1.cmml" xref="A1.Ex17.m1.1.1.1.1.1.1.4.5">subscript</csymbol><ci id="A1.Ex17.m1.1.1.1.1.1.1.4.5.2.cmml" xref="A1.Ex17.m1.1.1.1.1.1.1.4.5.2">𝐷</ci><ci id="A1.Ex17.m1.1.1.1.1.1.1.4.5.3a.cmml" xref="A1.Ex17.m1.1.1.1.1.1.1.4.5.3"><mtext id="A1.Ex17.m1.1.1.1.1.1.1.4.5.3.cmml" mathsize="70%" xref="A1.Ex17.m1.1.1.1.1.1.1.4.5.3">ff</mtext></ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex17.m1.1c">\displaystyle+L\times\Big{(}8\times S\times H^{2}+4\times S^{2}\times H+4%
\times S\times H\times D_{\text{ff}}\Big{)}</annotation><annotation encoding="application/x-llamapun" id="A1.Ex17.m1.1d">+ italic_L × ( 8 × italic_S × italic_H start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + 4 × italic_S start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT × italic_H + 4 × italic_S × italic_H × italic_D start_POSTSUBSCRIPT ff end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A1.E11"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle+2\times S\times H\times V+3\times S\times V\Bigg{]}" class="ltx_math_unparsed" display="inline" id="A1.E11.m1.1"><semantics id="A1.E11.m1.1a"><mrow id="A1.E11.m1.1b"><mo id="A1.E11.m1.1.1">+</mo><mn id="A1.E11.m1.1.2">2</mn><mo id="A1.E11.m1.1.3" lspace="0.222em" rspace="0.222em">×</mo><mi id="A1.E11.m1.1.4">S</mi><mo id="A1.E11.m1.1.5" lspace="0.222em" rspace="0.222em">×</mo><mi id="A1.E11.m1.1.6">H</mi><mo id="A1.E11.m1.1.7" lspace="0.222em" rspace="0.222em">×</mo><mi id="A1.E11.m1.1.8">V</mi><mo id="A1.E11.m1.1.9">+</mo><mn id="A1.E11.m1.1.10">3</mn><mo id="A1.E11.m1.1.11" lspace="0.222em" rspace="0.222em">×</mo><mi id="A1.E11.m1.1.12">S</mi><mo id="A1.E11.m1.1.13" lspace="0.222em" rspace="0.222em">×</mo><mi id="A1.E11.m1.1.14">V</mi><mo id="A1.E11.m1.1.15" maxsize="260%" minsize="260%">]</mo></mrow><annotation encoding="application/x-tex" id="A1.E11.m1.1c">\displaystyle+2\times S\times H\times V+3\times S\times V\Bigg{]}</annotation><annotation encoding="application/x-llamapun" id="A1.E11.m1.1d">+ 2 × italic_S × italic_H × italic_V + 3 × italic_S × italic_V ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(11)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
<section class="ltx_subsubsection" id="A1.SS3.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">A.3.2 </span>Mixture of LLMs</h4><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="A1.SS3.SSS2.p1">
<p class="ltx_p" id="A1.SS3.SSS2.p1.1">The total training FLOPs for the mixture model consist of four main components: training routers, sharding data for routers, training experts, and sharding data for the experts.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="A1.SS3.SSS2.p2">
<p class="ltx_p" id="A1.SS3.SSS2.p2.4">For a model trained with batch size <math alttext="B" class="ltx_Math" display="inline" id="A1.SS3.SSS2.p2.1.m1.1"><semantics id="A1.SS3.SSS2.p2.1.m1.1a"><mi id="A1.SS3.SSS2.p2.1.m1.1.1" xref="A1.SS3.SSS2.p2.1.m1.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="A1.SS3.SSS2.p2.1.m1.1b"><ci id="A1.SS3.SSS2.p2.1.m1.1.1.cmml" xref="A1.SS3.SSS2.p2.1.m1.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.SSS2.p2.1.m1.1c">B</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.SSS2.p2.1.m1.1d">italic_B</annotation></semantics></math> over <math alttext="N_{\text{steps}}" class="ltx_Math" display="inline" id="A1.SS3.SSS2.p2.2.m2.1"><semantics id="A1.SS3.SSS2.p2.2.m2.1a"><msub id="A1.SS3.SSS2.p2.2.m2.1.1" xref="A1.SS3.SSS2.p2.2.m2.1.1.cmml"><mi id="A1.SS3.SSS2.p2.2.m2.1.1.2" xref="A1.SS3.SSS2.p2.2.m2.1.1.2.cmml">N</mi><mtext id="A1.SS3.SSS2.p2.2.m2.1.1.3" xref="A1.SS3.SSS2.p2.2.m2.1.1.3a.cmml">steps</mtext></msub><annotation-xml encoding="MathML-Content" id="A1.SS3.SSS2.p2.2.m2.1b"><apply id="A1.SS3.SSS2.p2.2.m2.1.1.cmml" xref="A1.SS3.SSS2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="A1.SS3.SSS2.p2.2.m2.1.1.1.cmml" xref="A1.SS3.SSS2.p2.2.m2.1.1">subscript</csymbol><ci id="A1.SS3.SSS2.p2.2.m2.1.1.2.cmml" xref="A1.SS3.SSS2.p2.2.m2.1.1.2">𝑁</ci><ci id="A1.SS3.SSS2.p2.2.m2.1.1.3a.cmml" xref="A1.SS3.SSS2.p2.2.m2.1.1.3"><mtext id="A1.SS3.SSS2.p2.2.m2.1.1.3.cmml" mathsize="70%" xref="A1.SS3.SSS2.p2.2.m2.1.1.3">steps</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.SSS2.p2.2.m2.1c">N_{\text{steps}}</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.SSS2.p2.2.m2.1d">italic_N start_POSTSUBSCRIPT steps end_POSTSUBSCRIPT</annotation></semantics></math> steps, the total number of sequences shaded can be estimated as <math alttext="N_{\text{steps}}\times B\times E" class="ltx_Math" display="inline" id="A1.SS3.SSS2.p2.3.m3.1"><semantics id="A1.SS3.SSS2.p2.3.m3.1a"><mrow id="A1.SS3.SSS2.p2.3.m3.1.1" xref="A1.SS3.SSS2.p2.3.m3.1.1.cmml"><msub id="A1.SS3.SSS2.p2.3.m3.1.1.2" xref="A1.SS3.SSS2.p2.3.m3.1.1.2.cmml"><mi id="A1.SS3.SSS2.p2.3.m3.1.1.2.2" xref="A1.SS3.SSS2.p2.3.m3.1.1.2.2.cmml">N</mi><mtext id="A1.SS3.SSS2.p2.3.m3.1.1.2.3" xref="A1.SS3.SSS2.p2.3.m3.1.1.2.3a.cmml">steps</mtext></msub><mo id="A1.SS3.SSS2.p2.3.m3.1.1.1" lspace="0.222em" rspace="0.222em" xref="A1.SS3.SSS2.p2.3.m3.1.1.1.cmml">×</mo><mi id="A1.SS3.SSS2.p2.3.m3.1.1.3" xref="A1.SS3.SSS2.p2.3.m3.1.1.3.cmml">B</mi><mo id="A1.SS3.SSS2.p2.3.m3.1.1.1a" lspace="0.222em" rspace="0.222em" xref="A1.SS3.SSS2.p2.3.m3.1.1.1.cmml">×</mo><mi id="A1.SS3.SSS2.p2.3.m3.1.1.4" xref="A1.SS3.SSS2.p2.3.m3.1.1.4.cmml">E</mi></mrow><annotation-xml encoding="MathML-Content" id="A1.SS3.SSS2.p2.3.m3.1b"><apply id="A1.SS3.SSS2.p2.3.m3.1.1.cmml" xref="A1.SS3.SSS2.p2.3.m3.1.1"><times id="A1.SS3.SSS2.p2.3.m3.1.1.1.cmml" xref="A1.SS3.SSS2.p2.3.m3.1.1.1"></times><apply id="A1.SS3.SSS2.p2.3.m3.1.1.2.cmml" xref="A1.SS3.SSS2.p2.3.m3.1.1.2"><csymbol cd="ambiguous" id="A1.SS3.SSS2.p2.3.m3.1.1.2.1.cmml" xref="A1.SS3.SSS2.p2.3.m3.1.1.2">subscript</csymbol><ci id="A1.SS3.SSS2.p2.3.m3.1.1.2.2.cmml" xref="A1.SS3.SSS2.p2.3.m3.1.1.2.2">𝑁</ci><ci id="A1.SS3.SSS2.p2.3.m3.1.1.2.3a.cmml" xref="A1.SS3.SSS2.p2.3.m3.1.1.2.3"><mtext id="A1.SS3.SSS2.p2.3.m3.1.1.2.3.cmml" mathsize="70%" xref="A1.SS3.SSS2.p2.3.m3.1.1.2.3">steps</mtext></ci></apply><ci id="A1.SS3.SSS2.p2.3.m3.1.1.3.cmml" xref="A1.SS3.SSS2.p2.3.m3.1.1.3">𝐵</ci><ci id="A1.SS3.SSS2.p2.3.m3.1.1.4.cmml" xref="A1.SS3.SSS2.p2.3.m3.1.1.4">𝐸</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.SSS2.p2.3.m3.1c">N_{\text{steps}}\times B\times E</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.SSS2.p2.3.m3.1d">italic_N start_POSTSUBSCRIPT steps end_POSTSUBSCRIPT × italic_B × italic_E</annotation></semantics></math>, where each model receives approximately <math alttext="N_{\text{steps}}\times B" class="ltx_Math" display="inline" id="A1.SS3.SSS2.p2.4.m4.1"><semantics id="A1.SS3.SSS2.p2.4.m4.1a"><mrow id="A1.SS3.SSS2.p2.4.m4.1.1" xref="A1.SS3.SSS2.p2.4.m4.1.1.cmml"><msub id="A1.SS3.SSS2.p2.4.m4.1.1.2" xref="A1.SS3.SSS2.p2.4.m4.1.1.2.cmml"><mi id="A1.SS3.SSS2.p2.4.m4.1.1.2.2" xref="A1.SS3.SSS2.p2.4.m4.1.1.2.2.cmml">N</mi><mtext id="A1.SS3.SSS2.p2.4.m4.1.1.2.3" xref="A1.SS3.SSS2.p2.4.m4.1.1.2.3a.cmml">steps</mtext></msub><mo id="A1.SS3.SSS2.p2.4.m4.1.1.1" lspace="0.222em" rspace="0.222em" xref="A1.SS3.SSS2.p2.4.m4.1.1.1.cmml">×</mo><mi id="A1.SS3.SSS2.p2.4.m4.1.1.3" xref="A1.SS3.SSS2.p2.4.m4.1.1.3.cmml">B</mi></mrow><annotation-xml encoding="MathML-Content" id="A1.SS3.SSS2.p2.4.m4.1b"><apply id="A1.SS3.SSS2.p2.4.m4.1.1.cmml" xref="A1.SS3.SSS2.p2.4.m4.1.1"><times id="A1.SS3.SSS2.p2.4.m4.1.1.1.cmml" xref="A1.SS3.SSS2.p2.4.m4.1.1.1"></times><apply id="A1.SS3.SSS2.p2.4.m4.1.1.2.cmml" xref="A1.SS3.SSS2.p2.4.m4.1.1.2"><csymbol cd="ambiguous" id="A1.SS3.SSS2.p2.4.m4.1.1.2.1.cmml" xref="A1.SS3.SSS2.p2.4.m4.1.1.2">subscript</csymbol><ci id="A1.SS3.SSS2.p2.4.m4.1.1.2.2.cmml" xref="A1.SS3.SSS2.p2.4.m4.1.1.2.2">𝑁</ci><ci id="A1.SS3.SSS2.p2.4.m4.1.1.2.3a.cmml" xref="A1.SS3.SSS2.p2.4.m4.1.1.2.3"><mtext id="A1.SS3.SSS2.p2.4.m4.1.1.2.3.cmml" mathsize="70%" xref="A1.SS3.SSS2.p2.4.m4.1.1.2.3">steps</mtext></ci></apply><ci id="A1.SS3.SSS2.p2.4.m4.1.1.3.cmml" xref="A1.SS3.SSS2.p2.4.m4.1.1.3">𝐵</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.SSS2.p2.4.m4.1c">N_{\text{steps}}\times B</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.SSS2.p2.4.m4.1d">italic_N start_POSTSUBSCRIPT steps end_POSTSUBSCRIPT × italic_B</annotation></semantics></math> sequences during training.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="A1.SS3.SSS2.p3">
<p class="ltx_p" id="A1.SS3.SSS2.p3.1">Thus, the FLOPs required for sharding can be calculated as the inference FLOPs with an effective batch size of <math alttext="N_{\text{steps}}\times B\times E" class="ltx_Math" display="inline" id="A1.SS3.SSS2.p3.1.m1.1"><semantics id="A1.SS3.SSS2.p3.1.m1.1a"><mrow id="A1.SS3.SSS2.p3.1.m1.1.1" xref="A1.SS3.SSS2.p3.1.m1.1.1.cmml"><msub id="A1.SS3.SSS2.p3.1.m1.1.1.2" xref="A1.SS3.SSS2.p3.1.m1.1.1.2.cmml"><mi id="A1.SS3.SSS2.p3.1.m1.1.1.2.2" xref="A1.SS3.SSS2.p3.1.m1.1.1.2.2.cmml">N</mi><mtext id="A1.SS3.SSS2.p3.1.m1.1.1.2.3" xref="A1.SS3.SSS2.p3.1.m1.1.1.2.3a.cmml">steps</mtext></msub><mo id="A1.SS3.SSS2.p3.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="A1.SS3.SSS2.p3.1.m1.1.1.1.cmml">×</mo><mi id="A1.SS3.SSS2.p3.1.m1.1.1.3" xref="A1.SS3.SSS2.p3.1.m1.1.1.3.cmml">B</mi><mo id="A1.SS3.SSS2.p3.1.m1.1.1.1a" lspace="0.222em" rspace="0.222em" xref="A1.SS3.SSS2.p3.1.m1.1.1.1.cmml">×</mo><mi id="A1.SS3.SSS2.p3.1.m1.1.1.4" xref="A1.SS3.SSS2.p3.1.m1.1.1.4.cmml">E</mi></mrow><annotation-xml encoding="MathML-Content" id="A1.SS3.SSS2.p3.1.m1.1b"><apply id="A1.SS3.SSS2.p3.1.m1.1.1.cmml" xref="A1.SS3.SSS2.p3.1.m1.1.1"><times id="A1.SS3.SSS2.p3.1.m1.1.1.1.cmml" xref="A1.SS3.SSS2.p3.1.m1.1.1.1"></times><apply id="A1.SS3.SSS2.p3.1.m1.1.1.2.cmml" xref="A1.SS3.SSS2.p3.1.m1.1.1.2"><csymbol cd="ambiguous" id="A1.SS3.SSS2.p3.1.m1.1.1.2.1.cmml" xref="A1.SS3.SSS2.p3.1.m1.1.1.2">subscript</csymbol><ci id="A1.SS3.SSS2.p3.1.m1.1.1.2.2.cmml" xref="A1.SS3.SSS2.p3.1.m1.1.1.2.2">𝑁</ci><ci id="A1.SS3.SSS2.p3.1.m1.1.1.2.3a.cmml" xref="A1.SS3.SSS2.p3.1.m1.1.1.2.3"><mtext id="A1.SS3.SSS2.p3.1.m1.1.1.2.3.cmml" mathsize="70%" xref="A1.SS3.SSS2.p3.1.m1.1.1.2.3">steps</mtext></ci></apply><ci id="A1.SS3.SSS2.p3.1.m1.1.1.3.cmml" xref="A1.SS3.SSS2.p3.1.m1.1.1.3">𝐵</ci><ci id="A1.SS3.SSS2.p3.1.m1.1.1.4.cmml" xref="A1.SS3.SSS2.p3.1.m1.1.1.4">𝐸</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.SSS2.p3.1.m1.1c">N_{\text{steps}}\times B\times E</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.SSS2.p3.1.m1.1d">italic_N start_POSTSUBSCRIPT steps end_POSTSUBSCRIPT × italic_B × italic_E</annotation></semantics></math> (see Equation&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#A1.E11" title="In A.3.1 Transformer ‣ A.3 Computational Cost ‣ Appendix A Language modeling experiments ‣ No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_tag">11</span></a>).</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="A1.SS3.SSS2.p4">
<p class="ltx_p" id="A1.SS3.SSS2.p4.1">Therefore
<span class="ltx_text ltx_font_bold" id="A1.SS3.SSS2.p4.1.1">Total Training FLOPs:</span></p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A3.EGx5">
<tbody id="A1.E12"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\text{Total Training FLOPs}=" class="ltx_Math" display="inline" id="A1.E12.m1.1"><semantics id="A1.E12.m1.1a"><mrow id="A1.E12.m1.1.1" xref="A1.E12.m1.1.1.cmml"><mtext id="A1.E12.m1.1.1.2" xref="A1.E12.m1.1.1.2a.cmml">Total Training FLOPs</mtext><mo id="A1.E12.m1.1.1.1" xref="A1.E12.m1.1.1.1.cmml">=</mo><mi id="A1.E12.m1.1.1.3" xref="A1.E12.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="A1.E12.m1.1b"><apply id="A1.E12.m1.1.1.cmml" xref="A1.E12.m1.1.1"><eq id="A1.E12.m1.1.1.1.cmml" xref="A1.E12.m1.1.1.1"></eq><ci id="A1.E12.m1.1.1.2a.cmml" xref="A1.E12.m1.1.1.2"><mtext id="A1.E12.m1.1.1.2.cmml" xref="A1.E12.m1.1.1.2">Total Training FLOPs</mtext></ci><csymbol cd="latexml" id="A1.E12.m1.1.1.3.cmml" xref="A1.E12.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E12.m1.1c">\displaystyle\text{Total Training FLOPs}=</annotation><annotation encoding="application/x-llamapun" id="A1.E12.m1.1d">Total Training FLOPs =</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\text{Training FLOPs Routers}+\text{Training FLOPs Experts}=" class="ltx_Math" display="inline" id="A1.E12.m2.1"><semantics id="A1.E12.m2.1a"><mrow id="A1.E12.m2.1.1" xref="A1.E12.m2.1.1.cmml"><mrow id="A1.E12.m2.1.1.2" xref="A1.E12.m2.1.1.2.cmml"><mtext id="A1.E12.m2.1.1.2.2" xref="A1.E12.m2.1.1.2.2a.cmml">Training FLOPs Routers</mtext><mo id="A1.E12.m2.1.1.2.1" xref="A1.E12.m2.1.1.2.1.cmml">+</mo><mtext id="A1.E12.m2.1.1.2.3" xref="A1.E12.m2.1.1.2.3a.cmml">Training FLOPs Experts</mtext></mrow><mo id="A1.E12.m2.1.1.1" xref="A1.E12.m2.1.1.1.cmml">=</mo><mi id="A1.E12.m2.1.1.3" xref="A1.E12.m2.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="A1.E12.m2.1b"><apply id="A1.E12.m2.1.1.cmml" xref="A1.E12.m2.1.1"><eq id="A1.E12.m2.1.1.1.cmml" xref="A1.E12.m2.1.1.1"></eq><apply id="A1.E12.m2.1.1.2.cmml" xref="A1.E12.m2.1.1.2"><plus id="A1.E12.m2.1.1.2.1.cmml" xref="A1.E12.m2.1.1.2.1"></plus><ci id="A1.E12.m2.1.1.2.2a.cmml" xref="A1.E12.m2.1.1.2.2"><mtext id="A1.E12.m2.1.1.2.2.cmml" xref="A1.E12.m2.1.1.2.2">Training FLOPs Routers</mtext></ci><ci id="A1.E12.m2.1.1.2.3a.cmml" xref="A1.E12.m2.1.1.2.3"><mtext id="A1.E12.m2.1.1.2.3.cmml" xref="A1.E12.m2.1.1.2.3">Training FLOPs Experts</mtext></ci></apply><csymbol cd="latexml" id="A1.E12.m2.1.1.3.cmml" xref="A1.E12.m2.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E12.m2.1c">\displaystyle\text{Training FLOPs Routers}+\text{Training FLOPs Experts}=</annotation><annotation encoding="application/x-llamapun" id="A1.E12.m2.1d">Training FLOPs Routers + Training FLOPs Experts =</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(12)</span></td>
</tr></tbody>
<tbody id="A1.Ex18"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle+3\times N_{\text{steps\_router}}\times\Bigg{[}B_{r}\times S%
\times H_{r}" class="ltx_math_unparsed" display="inline" id="A1.Ex18.m1.1"><semantics id="A1.Ex18.m1.1a"><mrow id="A1.Ex18.m1.1b"><mo id="A1.Ex18.m1.1.1">+</mo><mn id="A1.Ex18.m1.1.2">3</mn><mo id="A1.Ex18.m1.1.3" lspace="0.222em" rspace="0.222em">×</mo><msub id="A1.Ex18.m1.1.4"><mi id="A1.Ex18.m1.1.4.2">N</mi><mtext id="A1.Ex18.m1.1.4.3">steps_router</mtext></msub><mo id="A1.Ex18.m1.1.5" lspace="0.222em" rspace="0.222em">×</mo><mrow id="A1.Ex18.m1.1.6"><mo id="A1.Ex18.m1.1.6.1" maxsize="260%" minsize="260%">[</mo><msub id="A1.Ex18.m1.1.6.2"><mi id="A1.Ex18.m1.1.6.2.2">B</mi><mi id="A1.Ex18.m1.1.6.2.3">r</mi></msub><mo id="A1.Ex18.m1.1.6.3" lspace="0.222em" rspace="0.222em">×</mo><mi id="A1.Ex18.m1.1.6.4">S</mi><mo id="A1.Ex18.m1.1.6.5" lspace="0.222em" rspace="0.222em">×</mo><msub id="A1.Ex18.m1.1.6.6"><mi id="A1.Ex18.m1.1.6.6.2">H</mi><mi id="A1.Ex18.m1.1.6.6.3">r</mi></msub></mrow></mrow><annotation encoding="application/x-tex" id="A1.Ex18.m1.1c">\displaystyle+3\times N_{\text{steps\_router}}\times\Bigg{[}B_{r}\times S%
\times H_{r}</annotation><annotation encoding="application/x-llamapun" id="A1.Ex18.m1.1d">+ 3 × italic_N start_POSTSUBSCRIPT steps_router end_POSTSUBSCRIPT × [ italic_B start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT × italic_S × italic_H start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A1.Ex19"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle+L_{r}\times\left(8\times B_{r}\times S\times H_{r}^{2}+4\times B%
_{r}\times S^{2}\times H_{r}+4\times B_{r}\times S\times H_{r}\times D_{r_{%
\text{ff}}}\right)" class="ltx_Math" display="inline" id="A1.Ex19.m1.1"><semantics id="A1.Ex19.m1.1a"><mrow id="A1.Ex19.m1.1.1" xref="A1.Ex19.m1.1.1.cmml"><mo id="A1.Ex19.m1.1.1a" xref="A1.Ex19.m1.1.1.cmml">+</mo><mrow id="A1.Ex19.m1.1.1.1" xref="A1.Ex19.m1.1.1.1.cmml"><msub id="A1.Ex19.m1.1.1.1.3" xref="A1.Ex19.m1.1.1.1.3.cmml"><mi id="A1.Ex19.m1.1.1.1.3.2" xref="A1.Ex19.m1.1.1.1.3.2.cmml">L</mi><mi id="A1.Ex19.m1.1.1.1.3.3" xref="A1.Ex19.m1.1.1.1.3.3.cmml">r</mi></msub><mo id="A1.Ex19.m1.1.1.1.2" lspace="0.222em" rspace="0.222em" xref="A1.Ex19.m1.1.1.1.2.cmml">×</mo><mrow id="A1.Ex19.m1.1.1.1.1.1" xref="A1.Ex19.m1.1.1.1.1.1.1.cmml"><mo id="A1.Ex19.m1.1.1.1.1.1.2" xref="A1.Ex19.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.Ex19.m1.1.1.1.1.1.1" xref="A1.Ex19.m1.1.1.1.1.1.1.cmml"><mrow id="A1.Ex19.m1.1.1.1.1.1.1.2" xref="A1.Ex19.m1.1.1.1.1.1.1.2.cmml"><mn id="A1.Ex19.m1.1.1.1.1.1.1.2.2" xref="A1.Ex19.m1.1.1.1.1.1.1.2.2.cmml">8</mn><mo id="A1.Ex19.m1.1.1.1.1.1.1.2.1" lspace="0.222em" rspace="0.222em" xref="A1.Ex19.m1.1.1.1.1.1.1.2.1.cmml">×</mo><msub id="A1.Ex19.m1.1.1.1.1.1.1.2.3" xref="A1.Ex19.m1.1.1.1.1.1.1.2.3.cmml"><mi id="A1.Ex19.m1.1.1.1.1.1.1.2.3.2" xref="A1.Ex19.m1.1.1.1.1.1.1.2.3.2.cmml">B</mi><mi id="A1.Ex19.m1.1.1.1.1.1.1.2.3.3" xref="A1.Ex19.m1.1.1.1.1.1.1.2.3.3.cmml">r</mi></msub><mo id="A1.Ex19.m1.1.1.1.1.1.1.2.1a" lspace="0.222em" rspace="0.222em" xref="A1.Ex19.m1.1.1.1.1.1.1.2.1.cmml">×</mo><mi id="A1.Ex19.m1.1.1.1.1.1.1.2.4" xref="A1.Ex19.m1.1.1.1.1.1.1.2.4.cmml">S</mi><mo id="A1.Ex19.m1.1.1.1.1.1.1.2.1b" lspace="0.222em" rspace="0.222em" xref="A1.Ex19.m1.1.1.1.1.1.1.2.1.cmml">×</mo><msubsup id="A1.Ex19.m1.1.1.1.1.1.1.2.5" xref="A1.Ex19.m1.1.1.1.1.1.1.2.5.cmml"><mi id="A1.Ex19.m1.1.1.1.1.1.1.2.5.2.2" xref="A1.Ex19.m1.1.1.1.1.1.1.2.5.2.2.cmml">H</mi><mi id="A1.Ex19.m1.1.1.1.1.1.1.2.5.2.3" xref="A1.Ex19.m1.1.1.1.1.1.1.2.5.2.3.cmml">r</mi><mn id="A1.Ex19.m1.1.1.1.1.1.1.2.5.3" xref="A1.Ex19.m1.1.1.1.1.1.1.2.5.3.cmml">2</mn></msubsup></mrow><mo id="A1.Ex19.m1.1.1.1.1.1.1.1" xref="A1.Ex19.m1.1.1.1.1.1.1.1.cmml">+</mo><mrow id="A1.Ex19.m1.1.1.1.1.1.1.3" xref="A1.Ex19.m1.1.1.1.1.1.1.3.cmml"><mn id="A1.Ex19.m1.1.1.1.1.1.1.3.2" xref="A1.Ex19.m1.1.1.1.1.1.1.3.2.cmml">4</mn><mo id="A1.Ex19.m1.1.1.1.1.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="A1.Ex19.m1.1.1.1.1.1.1.3.1.cmml">×</mo><msub id="A1.Ex19.m1.1.1.1.1.1.1.3.3" xref="A1.Ex19.m1.1.1.1.1.1.1.3.3.cmml"><mi id="A1.Ex19.m1.1.1.1.1.1.1.3.3.2" xref="A1.Ex19.m1.1.1.1.1.1.1.3.3.2.cmml">B</mi><mi id="A1.Ex19.m1.1.1.1.1.1.1.3.3.3" xref="A1.Ex19.m1.1.1.1.1.1.1.3.3.3.cmml">r</mi></msub><mo id="A1.Ex19.m1.1.1.1.1.1.1.3.1a" lspace="0.222em" rspace="0.222em" xref="A1.Ex19.m1.1.1.1.1.1.1.3.1.cmml">×</mo><msup id="A1.Ex19.m1.1.1.1.1.1.1.3.4" xref="A1.Ex19.m1.1.1.1.1.1.1.3.4.cmml"><mi id="A1.Ex19.m1.1.1.1.1.1.1.3.4.2" xref="A1.Ex19.m1.1.1.1.1.1.1.3.4.2.cmml">S</mi><mn id="A1.Ex19.m1.1.1.1.1.1.1.3.4.3" xref="A1.Ex19.m1.1.1.1.1.1.1.3.4.3.cmml">2</mn></msup><mo id="A1.Ex19.m1.1.1.1.1.1.1.3.1b" lspace="0.222em" rspace="0.222em" xref="A1.Ex19.m1.1.1.1.1.1.1.3.1.cmml">×</mo><msub id="A1.Ex19.m1.1.1.1.1.1.1.3.5" xref="A1.Ex19.m1.1.1.1.1.1.1.3.5.cmml"><mi id="A1.Ex19.m1.1.1.1.1.1.1.3.5.2" xref="A1.Ex19.m1.1.1.1.1.1.1.3.5.2.cmml">H</mi><mi id="A1.Ex19.m1.1.1.1.1.1.1.3.5.3" xref="A1.Ex19.m1.1.1.1.1.1.1.3.5.3.cmml">r</mi></msub></mrow><mo id="A1.Ex19.m1.1.1.1.1.1.1.1a" xref="A1.Ex19.m1.1.1.1.1.1.1.1.cmml">+</mo><mrow id="A1.Ex19.m1.1.1.1.1.1.1.4" xref="A1.Ex19.m1.1.1.1.1.1.1.4.cmml"><mn id="A1.Ex19.m1.1.1.1.1.1.1.4.2" xref="A1.Ex19.m1.1.1.1.1.1.1.4.2.cmml">4</mn><mo id="A1.Ex19.m1.1.1.1.1.1.1.4.1" lspace="0.222em" rspace="0.222em" xref="A1.Ex19.m1.1.1.1.1.1.1.4.1.cmml">×</mo><msub id="A1.Ex19.m1.1.1.1.1.1.1.4.3" xref="A1.Ex19.m1.1.1.1.1.1.1.4.3.cmml"><mi id="A1.Ex19.m1.1.1.1.1.1.1.4.3.2" xref="A1.Ex19.m1.1.1.1.1.1.1.4.3.2.cmml">B</mi><mi id="A1.Ex19.m1.1.1.1.1.1.1.4.3.3" xref="A1.Ex19.m1.1.1.1.1.1.1.4.3.3.cmml">r</mi></msub><mo id="A1.Ex19.m1.1.1.1.1.1.1.4.1a" lspace="0.222em" rspace="0.222em" xref="A1.Ex19.m1.1.1.1.1.1.1.4.1.cmml">×</mo><mi id="A1.Ex19.m1.1.1.1.1.1.1.4.4" xref="A1.Ex19.m1.1.1.1.1.1.1.4.4.cmml">S</mi><mo id="A1.Ex19.m1.1.1.1.1.1.1.4.1b" lspace="0.222em" rspace="0.222em" xref="A1.Ex19.m1.1.1.1.1.1.1.4.1.cmml">×</mo><msub id="A1.Ex19.m1.1.1.1.1.1.1.4.5" xref="A1.Ex19.m1.1.1.1.1.1.1.4.5.cmml"><mi id="A1.Ex19.m1.1.1.1.1.1.1.4.5.2" xref="A1.Ex19.m1.1.1.1.1.1.1.4.5.2.cmml">H</mi><mi id="A1.Ex19.m1.1.1.1.1.1.1.4.5.3" xref="A1.Ex19.m1.1.1.1.1.1.1.4.5.3.cmml">r</mi></msub><mo id="A1.Ex19.m1.1.1.1.1.1.1.4.1c" lspace="0.222em" rspace="0.222em" xref="A1.Ex19.m1.1.1.1.1.1.1.4.1.cmml">×</mo><msub id="A1.Ex19.m1.1.1.1.1.1.1.4.6" xref="A1.Ex19.m1.1.1.1.1.1.1.4.6.cmml"><mi id="A1.Ex19.m1.1.1.1.1.1.1.4.6.2" xref="A1.Ex19.m1.1.1.1.1.1.1.4.6.2.cmml">D</mi><msub id="A1.Ex19.m1.1.1.1.1.1.1.4.6.3" xref="A1.Ex19.m1.1.1.1.1.1.1.4.6.3.cmml"><mi id="A1.Ex19.m1.1.1.1.1.1.1.4.6.3.2" xref="A1.Ex19.m1.1.1.1.1.1.1.4.6.3.2.cmml">r</mi><mtext id="A1.Ex19.m1.1.1.1.1.1.1.4.6.3.3" xref="A1.Ex19.m1.1.1.1.1.1.1.4.6.3.3a.cmml">ff</mtext></msub></msub></mrow></mrow><mo id="A1.Ex19.m1.1.1.1.1.1.3" xref="A1.Ex19.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex19.m1.1b"><apply id="A1.Ex19.m1.1.1.cmml" xref="A1.Ex19.m1.1.1"><plus id="A1.Ex19.m1.1.1.2.cmml" xref="A1.Ex19.m1.1.1"></plus><apply id="A1.Ex19.m1.1.1.1.cmml" xref="A1.Ex19.m1.1.1.1"><times id="A1.Ex19.m1.1.1.1.2.cmml" xref="A1.Ex19.m1.1.1.1.2"></times><apply id="A1.Ex19.m1.1.1.1.3.cmml" xref="A1.Ex19.m1.1.1.1.3"><csymbol cd="ambiguous" id="A1.Ex19.m1.1.1.1.3.1.cmml" xref="A1.Ex19.m1.1.1.1.3">subscript</csymbol><ci id="A1.Ex19.m1.1.1.1.3.2.cmml" xref="A1.Ex19.m1.1.1.1.3.2">𝐿</ci><ci id="A1.Ex19.m1.1.1.1.3.3.cmml" xref="A1.Ex19.m1.1.1.1.3.3">𝑟</ci></apply><apply id="A1.Ex19.m1.1.1.1.1.1.1.cmml" xref="A1.Ex19.m1.1.1.1.1.1"><plus id="A1.Ex19.m1.1.1.1.1.1.1.1.cmml" xref="A1.Ex19.m1.1.1.1.1.1.1.1"></plus><apply id="A1.Ex19.m1.1.1.1.1.1.1.2.cmml" xref="A1.Ex19.m1.1.1.1.1.1.1.2"><times id="A1.Ex19.m1.1.1.1.1.1.1.2.1.cmml" xref="A1.Ex19.m1.1.1.1.1.1.1.2.1"></times><cn id="A1.Ex19.m1.1.1.1.1.1.1.2.2.cmml" type="integer" xref="A1.Ex19.m1.1.1.1.1.1.1.2.2">8</cn><apply id="A1.Ex19.m1.1.1.1.1.1.1.2.3.cmml" xref="A1.Ex19.m1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="A1.Ex19.m1.1.1.1.1.1.1.2.3.1.cmml" xref="A1.Ex19.m1.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="A1.Ex19.m1.1.1.1.1.1.1.2.3.2.cmml" xref="A1.Ex19.m1.1.1.1.1.1.1.2.3.2">𝐵</ci><ci id="A1.Ex19.m1.1.1.1.1.1.1.2.3.3.cmml" xref="A1.Ex19.m1.1.1.1.1.1.1.2.3.3">𝑟</ci></apply><ci id="A1.Ex19.m1.1.1.1.1.1.1.2.4.cmml" xref="A1.Ex19.m1.1.1.1.1.1.1.2.4">𝑆</ci><apply id="A1.Ex19.m1.1.1.1.1.1.1.2.5.cmml" xref="A1.Ex19.m1.1.1.1.1.1.1.2.5"><csymbol cd="ambiguous" id="A1.Ex19.m1.1.1.1.1.1.1.2.5.1.cmml" xref="A1.Ex19.m1.1.1.1.1.1.1.2.5">superscript</csymbol><apply id="A1.Ex19.m1.1.1.1.1.1.1.2.5.2.cmml" xref="A1.Ex19.m1.1.1.1.1.1.1.2.5"><csymbol cd="ambiguous" id="A1.Ex19.m1.1.1.1.1.1.1.2.5.2.1.cmml" xref="A1.Ex19.m1.1.1.1.1.1.1.2.5">subscript</csymbol><ci id="A1.Ex19.m1.1.1.1.1.1.1.2.5.2.2.cmml" xref="A1.Ex19.m1.1.1.1.1.1.1.2.5.2.2">𝐻</ci><ci id="A1.Ex19.m1.1.1.1.1.1.1.2.5.2.3.cmml" xref="A1.Ex19.m1.1.1.1.1.1.1.2.5.2.3">𝑟</ci></apply><cn id="A1.Ex19.m1.1.1.1.1.1.1.2.5.3.cmml" type="integer" xref="A1.Ex19.m1.1.1.1.1.1.1.2.5.3">2</cn></apply></apply><apply id="A1.Ex19.m1.1.1.1.1.1.1.3.cmml" xref="A1.Ex19.m1.1.1.1.1.1.1.3"><times id="A1.Ex19.m1.1.1.1.1.1.1.3.1.cmml" xref="A1.Ex19.m1.1.1.1.1.1.1.3.1"></times><cn id="A1.Ex19.m1.1.1.1.1.1.1.3.2.cmml" type="integer" xref="A1.Ex19.m1.1.1.1.1.1.1.3.2">4</cn><apply id="A1.Ex19.m1.1.1.1.1.1.1.3.3.cmml" xref="A1.Ex19.m1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="A1.Ex19.m1.1.1.1.1.1.1.3.3.1.cmml" xref="A1.Ex19.m1.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="A1.Ex19.m1.1.1.1.1.1.1.3.3.2.cmml" xref="A1.Ex19.m1.1.1.1.1.1.1.3.3.2">𝐵</ci><ci id="A1.Ex19.m1.1.1.1.1.1.1.3.3.3.cmml" xref="A1.Ex19.m1.1.1.1.1.1.1.3.3.3">𝑟</ci></apply><apply id="A1.Ex19.m1.1.1.1.1.1.1.3.4.cmml" xref="A1.Ex19.m1.1.1.1.1.1.1.3.4"><csymbol cd="ambiguous" id="A1.Ex19.m1.1.1.1.1.1.1.3.4.1.cmml" xref="A1.Ex19.m1.1.1.1.1.1.1.3.4">superscript</csymbol><ci id="A1.Ex19.m1.1.1.1.1.1.1.3.4.2.cmml" xref="A1.Ex19.m1.1.1.1.1.1.1.3.4.2">𝑆</ci><cn id="A1.Ex19.m1.1.1.1.1.1.1.3.4.3.cmml" type="integer" xref="A1.Ex19.m1.1.1.1.1.1.1.3.4.3">2</cn></apply><apply id="A1.Ex19.m1.1.1.1.1.1.1.3.5.cmml" xref="A1.Ex19.m1.1.1.1.1.1.1.3.5"><csymbol cd="ambiguous" id="A1.Ex19.m1.1.1.1.1.1.1.3.5.1.cmml" xref="A1.Ex19.m1.1.1.1.1.1.1.3.5">subscript</csymbol><ci id="A1.Ex19.m1.1.1.1.1.1.1.3.5.2.cmml" xref="A1.Ex19.m1.1.1.1.1.1.1.3.5.2">𝐻</ci><ci id="A1.Ex19.m1.1.1.1.1.1.1.3.5.3.cmml" xref="A1.Ex19.m1.1.1.1.1.1.1.3.5.3">𝑟</ci></apply></apply><apply id="A1.Ex19.m1.1.1.1.1.1.1.4.cmml" xref="A1.Ex19.m1.1.1.1.1.1.1.4"><times id="A1.Ex19.m1.1.1.1.1.1.1.4.1.cmml" xref="A1.Ex19.m1.1.1.1.1.1.1.4.1"></times><cn id="A1.Ex19.m1.1.1.1.1.1.1.4.2.cmml" type="integer" xref="A1.Ex19.m1.1.1.1.1.1.1.4.2">4</cn><apply id="A1.Ex19.m1.1.1.1.1.1.1.4.3.cmml" xref="A1.Ex19.m1.1.1.1.1.1.1.4.3"><csymbol cd="ambiguous" id="A1.Ex19.m1.1.1.1.1.1.1.4.3.1.cmml" xref="A1.Ex19.m1.1.1.1.1.1.1.4.3">subscript</csymbol><ci id="A1.Ex19.m1.1.1.1.1.1.1.4.3.2.cmml" xref="A1.Ex19.m1.1.1.1.1.1.1.4.3.2">𝐵</ci><ci id="A1.Ex19.m1.1.1.1.1.1.1.4.3.3.cmml" xref="A1.Ex19.m1.1.1.1.1.1.1.4.3.3">𝑟</ci></apply><ci id="A1.Ex19.m1.1.1.1.1.1.1.4.4.cmml" xref="A1.Ex19.m1.1.1.1.1.1.1.4.4">𝑆</ci><apply id="A1.Ex19.m1.1.1.1.1.1.1.4.5.cmml" xref="A1.Ex19.m1.1.1.1.1.1.1.4.5"><csymbol cd="ambiguous" id="A1.Ex19.m1.1.1.1.1.1.1.4.5.1.cmml" xref="A1.Ex19.m1.1.1.1.1.1.1.4.5">subscript</csymbol><ci id="A1.Ex19.m1.1.1.1.1.1.1.4.5.2.cmml" xref="A1.Ex19.m1.1.1.1.1.1.1.4.5.2">𝐻</ci><ci id="A1.Ex19.m1.1.1.1.1.1.1.4.5.3.cmml" xref="A1.Ex19.m1.1.1.1.1.1.1.4.5.3">𝑟</ci></apply><apply id="A1.Ex19.m1.1.1.1.1.1.1.4.6.cmml" xref="A1.Ex19.m1.1.1.1.1.1.1.4.6"><csymbol cd="ambiguous" id="A1.Ex19.m1.1.1.1.1.1.1.4.6.1.cmml" xref="A1.Ex19.m1.1.1.1.1.1.1.4.6">subscript</csymbol><ci id="A1.Ex19.m1.1.1.1.1.1.1.4.6.2.cmml" xref="A1.Ex19.m1.1.1.1.1.1.1.4.6.2">𝐷</ci><apply id="A1.Ex19.m1.1.1.1.1.1.1.4.6.3.cmml" xref="A1.Ex19.m1.1.1.1.1.1.1.4.6.3"><csymbol cd="ambiguous" id="A1.Ex19.m1.1.1.1.1.1.1.4.6.3.1.cmml" xref="A1.Ex19.m1.1.1.1.1.1.1.4.6.3">subscript</csymbol><ci id="A1.Ex19.m1.1.1.1.1.1.1.4.6.3.2.cmml" xref="A1.Ex19.m1.1.1.1.1.1.1.4.6.3.2">𝑟</ci><ci id="A1.Ex19.m1.1.1.1.1.1.1.4.6.3.3a.cmml" xref="A1.Ex19.m1.1.1.1.1.1.1.4.6.3.3"><mtext id="A1.Ex19.m1.1.1.1.1.1.1.4.6.3.3.cmml" mathsize="50%" xref="A1.Ex19.m1.1.1.1.1.1.1.4.6.3.3">ff</mtext></ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex19.m1.1c">\displaystyle+L_{r}\times\left(8\times B_{r}\times S\times H_{r}^{2}+4\times B%
_{r}\times S^{2}\times H_{r}+4\times B_{r}\times S\times H_{r}\times D_{r_{%
\text{ff}}}\right)</annotation><annotation encoding="application/x-llamapun" id="A1.Ex19.m1.1d">+ italic_L start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT × ( 8 × italic_B start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT × italic_S × italic_H start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + 4 × italic_B start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT × italic_S start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT × italic_H start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT + 4 × italic_B start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT × italic_S × italic_H start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT × italic_D start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT ff end_POSTSUBSCRIPT end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A1.E13"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle+2\times B_{r}\times S\times H_{r}\times V+3\times B_{r}\times S%
\times V\Bigg{]}\times E\quad\text{(Eq.~{}\ref{eq:training_routers}: Training %
Routers)}" class="ltx_math_unparsed" display="inline" id="A1.E13.m1.1"><semantics id="A1.E13.m1.1a"><mrow id="A1.E13.m1.1b"><mo id="A1.E13.m1.1.1">+</mo><mn id="A1.E13.m1.1.2">2</mn><mo id="A1.E13.m1.1.3" lspace="0.222em" rspace="0.222em">×</mo><msub id="A1.E13.m1.1.4"><mi id="A1.E13.m1.1.4.2">B</mi><mi id="A1.E13.m1.1.4.3">r</mi></msub><mo id="A1.E13.m1.1.5" lspace="0.222em" rspace="0.222em">×</mo><mi id="A1.E13.m1.1.6">S</mi><mo id="A1.E13.m1.1.7" lspace="0.222em" rspace="0.222em">×</mo><msub id="A1.E13.m1.1.8"><mi id="A1.E13.m1.1.8.2">H</mi><mi id="A1.E13.m1.1.8.3">r</mi></msub><mo id="A1.E13.m1.1.9" lspace="0.222em" rspace="0.222em">×</mo><mi id="A1.E13.m1.1.10">V</mi><mo id="A1.E13.m1.1.11">+</mo><mn id="A1.E13.m1.1.12">3</mn><mo id="A1.E13.m1.1.13" lspace="0.222em" rspace="0.222em">×</mo><msub id="A1.E13.m1.1.14"><mi id="A1.E13.m1.1.14.2">B</mi><mi id="A1.E13.m1.1.14.3">r</mi></msub><mo id="A1.E13.m1.1.15" lspace="0.222em" rspace="0.222em">×</mo><mi id="A1.E13.m1.1.16">S</mi><mo id="A1.E13.m1.1.17" lspace="0.222em" rspace="0.222em">×</mo><mi id="A1.E13.m1.1.18">V</mi><mo id="A1.E13.m1.1.19" maxsize="260%" minsize="260%" rspace="0.055em">]</mo><mo id="A1.E13.m1.1.20" rspace="0.222em">×</mo><mi id="A1.E13.m1.1.21">E</mi><mspace id="A1.E13.m1.1.22" width="1em"></mspace><mrow id="A1.E13.m1.1.23"><mtext id="A1.E13.m1.1.23a">(Eq.&nbsp;</mtext><mtext id="A1.E13.m1.1.23b"><a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#A1.E13" title="In A.3.2 Mixture of LLMs ‣ A.3 Computational Cost ‣ Appendix A Language modeling experiments ‣ No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_tag">13</span></a></mtext><mtext id="A1.E13.m1.1.23e">: Training Routers)</mtext></mrow></mrow><annotation encoding="application/x-tex" id="A1.E13.m1.1c">\displaystyle+2\times B_{r}\times S\times H_{r}\times V+3\times B_{r}\times S%
\times V\Bigg{]}\times E\quad\text{(Eq.~{}\ref{eq:training_routers}: Training %
Routers)}</annotation><annotation encoding="application/x-llamapun" id="A1.E13.m1.1d">+ 2 × italic_B start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT × italic_S × italic_H start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT × italic_V + 3 × italic_B start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT × italic_S × italic_V ] × italic_E (Eq. : Training Routers)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(13)</span></td>
</tr></tbody>
<tbody id="A1.Ex20"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle+\bigg{(}N_{\text{steps\_router}}\times B_{r}\times E\bigg{)}%
\times\Bigg{[}M\times H_{r}" class="ltx_math_unparsed" display="inline" id="A1.Ex20.m1.1"><semantics id="A1.Ex20.m1.1a"><mrow id="A1.Ex20.m1.1b"><mo id="A1.Ex20.m1.1.1">+</mo><mrow id="A1.Ex20.m1.1.2"><mo id="A1.Ex20.m1.1.2.1" maxsize="210%" minsize="210%">(</mo><msub id="A1.Ex20.m1.1.2.2"><mi id="A1.Ex20.m1.1.2.2.2">N</mi><mtext id="A1.Ex20.m1.1.2.2.3">steps_router</mtext></msub><mo id="A1.Ex20.m1.1.2.3" lspace="0.222em" rspace="0.222em">×</mo><msub id="A1.Ex20.m1.1.2.4"><mi id="A1.Ex20.m1.1.2.4.2">B</mi><mi id="A1.Ex20.m1.1.2.4.3">r</mi></msub><mo id="A1.Ex20.m1.1.2.5" lspace="0.222em" rspace="0.222em">×</mo><mi id="A1.Ex20.m1.1.2.6">E</mi><mo id="A1.Ex20.m1.1.2.7" maxsize="210%" minsize="210%" rspace="0.055em">)</mo></mrow><mo id="A1.Ex20.m1.1.3" rspace="0.222em">×</mo><mrow id="A1.Ex20.m1.1.4"><mo id="A1.Ex20.m1.1.4.1" maxsize="260%" minsize="260%">[</mo><mi id="A1.Ex20.m1.1.4.2">M</mi><mo id="A1.Ex20.m1.1.4.3" lspace="0.222em" rspace="0.222em">×</mo><msub id="A1.Ex20.m1.1.4.4"><mi id="A1.Ex20.m1.1.4.4.2">H</mi><mi id="A1.Ex20.m1.1.4.4.3">r</mi></msub></mrow></mrow><annotation encoding="application/x-tex" id="A1.Ex20.m1.1c">\displaystyle+\bigg{(}N_{\text{steps\_router}}\times B_{r}\times E\bigg{)}%
\times\Bigg{[}M\times H_{r}</annotation><annotation encoding="application/x-llamapun" id="A1.Ex20.m1.1d">+ ( italic_N start_POSTSUBSCRIPT steps_router end_POSTSUBSCRIPT × italic_B start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT × italic_E ) × [ italic_M × italic_H start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A1.Ex21"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle+L_{r}\times\left(8\times M\times H_{r}^{2}+4\times M^{2}\times H%
_{r}+4\times M\times H_{r}\times D_{r_{\text{ff}}}\right)" class="ltx_Math" display="inline" id="A1.Ex21.m1.1"><semantics id="A1.Ex21.m1.1a"><mrow id="A1.Ex21.m1.1.1" xref="A1.Ex21.m1.1.1.cmml"><mo id="A1.Ex21.m1.1.1a" xref="A1.Ex21.m1.1.1.cmml">+</mo><mrow id="A1.Ex21.m1.1.1.1" xref="A1.Ex21.m1.1.1.1.cmml"><msub id="A1.Ex21.m1.1.1.1.3" xref="A1.Ex21.m1.1.1.1.3.cmml"><mi id="A1.Ex21.m1.1.1.1.3.2" xref="A1.Ex21.m1.1.1.1.3.2.cmml">L</mi><mi id="A1.Ex21.m1.1.1.1.3.3" xref="A1.Ex21.m1.1.1.1.3.3.cmml">r</mi></msub><mo id="A1.Ex21.m1.1.1.1.2" lspace="0.222em" rspace="0.222em" xref="A1.Ex21.m1.1.1.1.2.cmml">×</mo><mrow id="A1.Ex21.m1.1.1.1.1.1" xref="A1.Ex21.m1.1.1.1.1.1.1.cmml"><mo id="A1.Ex21.m1.1.1.1.1.1.2" xref="A1.Ex21.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.Ex21.m1.1.1.1.1.1.1" xref="A1.Ex21.m1.1.1.1.1.1.1.cmml"><mrow id="A1.Ex21.m1.1.1.1.1.1.1.2" xref="A1.Ex21.m1.1.1.1.1.1.1.2.cmml"><mn id="A1.Ex21.m1.1.1.1.1.1.1.2.2" xref="A1.Ex21.m1.1.1.1.1.1.1.2.2.cmml">8</mn><mo id="A1.Ex21.m1.1.1.1.1.1.1.2.1" lspace="0.222em" rspace="0.222em" xref="A1.Ex21.m1.1.1.1.1.1.1.2.1.cmml">×</mo><mi id="A1.Ex21.m1.1.1.1.1.1.1.2.3" xref="A1.Ex21.m1.1.1.1.1.1.1.2.3.cmml">M</mi><mo id="A1.Ex21.m1.1.1.1.1.1.1.2.1a" lspace="0.222em" rspace="0.222em" xref="A1.Ex21.m1.1.1.1.1.1.1.2.1.cmml">×</mo><msubsup id="A1.Ex21.m1.1.1.1.1.1.1.2.4" xref="A1.Ex21.m1.1.1.1.1.1.1.2.4.cmml"><mi id="A1.Ex21.m1.1.1.1.1.1.1.2.4.2.2" xref="A1.Ex21.m1.1.1.1.1.1.1.2.4.2.2.cmml">H</mi><mi id="A1.Ex21.m1.1.1.1.1.1.1.2.4.2.3" xref="A1.Ex21.m1.1.1.1.1.1.1.2.4.2.3.cmml">r</mi><mn id="A1.Ex21.m1.1.1.1.1.1.1.2.4.3" xref="A1.Ex21.m1.1.1.1.1.1.1.2.4.3.cmml">2</mn></msubsup></mrow><mo id="A1.Ex21.m1.1.1.1.1.1.1.1" xref="A1.Ex21.m1.1.1.1.1.1.1.1.cmml">+</mo><mrow id="A1.Ex21.m1.1.1.1.1.1.1.3" xref="A1.Ex21.m1.1.1.1.1.1.1.3.cmml"><mn id="A1.Ex21.m1.1.1.1.1.1.1.3.2" xref="A1.Ex21.m1.1.1.1.1.1.1.3.2.cmml">4</mn><mo id="A1.Ex21.m1.1.1.1.1.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="A1.Ex21.m1.1.1.1.1.1.1.3.1.cmml">×</mo><msup id="A1.Ex21.m1.1.1.1.1.1.1.3.3" xref="A1.Ex21.m1.1.1.1.1.1.1.3.3.cmml"><mi id="A1.Ex21.m1.1.1.1.1.1.1.3.3.2" xref="A1.Ex21.m1.1.1.1.1.1.1.3.3.2.cmml">M</mi><mn id="A1.Ex21.m1.1.1.1.1.1.1.3.3.3" xref="A1.Ex21.m1.1.1.1.1.1.1.3.3.3.cmml">2</mn></msup><mo id="A1.Ex21.m1.1.1.1.1.1.1.3.1a" lspace="0.222em" rspace="0.222em" xref="A1.Ex21.m1.1.1.1.1.1.1.3.1.cmml">×</mo><msub id="A1.Ex21.m1.1.1.1.1.1.1.3.4" xref="A1.Ex21.m1.1.1.1.1.1.1.3.4.cmml"><mi id="A1.Ex21.m1.1.1.1.1.1.1.3.4.2" xref="A1.Ex21.m1.1.1.1.1.1.1.3.4.2.cmml">H</mi><mi id="A1.Ex21.m1.1.1.1.1.1.1.3.4.3" xref="A1.Ex21.m1.1.1.1.1.1.1.3.4.3.cmml">r</mi></msub></mrow><mo id="A1.Ex21.m1.1.1.1.1.1.1.1a" xref="A1.Ex21.m1.1.1.1.1.1.1.1.cmml">+</mo><mrow id="A1.Ex21.m1.1.1.1.1.1.1.4" xref="A1.Ex21.m1.1.1.1.1.1.1.4.cmml"><mn id="A1.Ex21.m1.1.1.1.1.1.1.4.2" xref="A1.Ex21.m1.1.1.1.1.1.1.4.2.cmml">4</mn><mo id="A1.Ex21.m1.1.1.1.1.1.1.4.1" lspace="0.222em" rspace="0.222em" xref="A1.Ex21.m1.1.1.1.1.1.1.4.1.cmml">×</mo><mi id="A1.Ex21.m1.1.1.1.1.1.1.4.3" xref="A1.Ex21.m1.1.1.1.1.1.1.4.3.cmml">M</mi><mo id="A1.Ex21.m1.1.1.1.1.1.1.4.1a" lspace="0.222em" rspace="0.222em" xref="A1.Ex21.m1.1.1.1.1.1.1.4.1.cmml">×</mo><msub id="A1.Ex21.m1.1.1.1.1.1.1.4.4" xref="A1.Ex21.m1.1.1.1.1.1.1.4.4.cmml"><mi id="A1.Ex21.m1.1.1.1.1.1.1.4.4.2" xref="A1.Ex21.m1.1.1.1.1.1.1.4.4.2.cmml">H</mi><mi id="A1.Ex21.m1.1.1.1.1.1.1.4.4.3" xref="A1.Ex21.m1.1.1.1.1.1.1.4.4.3.cmml">r</mi></msub><mo id="A1.Ex21.m1.1.1.1.1.1.1.4.1b" lspace="0.222em" rspace="0.222em" xref="A1.Ex21.m1.1.1.1.1.1.1.4.1.cmml">×</mo><msub id="A1.Ex21.m1.1.1.1.1.1.1.4.5" xref="A1.Ex21.m1.1.1.1.1.1.1.4.5.cmml"><mi id="A1.Ex21.m1.1.1.1.1.1.1.4.5.2" xref="A1.Ex21.m1.1.1.1.1.1.1.4.5.2.cmml">D</mi><msub id="A1.Ex21.m1.1.1.1.1.1.1.4.5.3" xref="A1.Ex21.m1.1.1.1.1.1.1.4.5.3.cmml"><mi id="A1.Ex21.m1.1.1.1.1.1.1.4.5.3.2" xref="A1.Ex21.m1.1.1.1.1.1.1.4.5.3.2.cmml">r</mi><mtext id="A1.Ex21.m1.1.1.1.1.1.1.4.5.3.3" xref="A1.Ex21.m1.1.1.1.1.1.1.4.5.3.3a.cmml">ff</mtext></msub></msub></mrow></mrow><mo id="A1.Ex21.m1.1.1.1.1.1.3" xref="A1.Ex21.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex21.m1.1b"><apply id="A1.Ex21.m1.1.1.cmml" xref="A1.Ex21.m1.1.1"><plus id="A1.Ex21.m1.1.1.2.cmml" xref="A1.Ex21.m1.1.1"></plus><apply id="A1.Ex21.m1.1.1.1.cmml" xref="A1.Ex21.m1.1.1.1"><times id="A1.Ex21.m1.1.1.1.2.cmml" xref="A1.Ex21.m1.1.1.1.2"></times><apply id="A1.Ex21.m1.1.1.1.3.cmml" xref="A1.Ex21.m1.1.1.1.3"><csymbol cd="ambiguous" id="A1.Ex21.m1.1.1.1.3.1.cmml" xref="A1.Ex21.m1.1.1.1.3">subscript</csymbol><ci id="A1.Ex21.m1.1.1.1.3.2.cmml" xref="A1.Ex21.m1.1.1.1.3.2">𝐿</ci><ci id="A1.Ex21.m1.1.1.1.3.3.cmml" xref="A1.Ex21.m1.1.1.1.3.3">𝑟</ci></apply><apply id="A1.Ex21.m1.1.1.1.1.1.1.cmml" xref="A1.Ex21.m1.1.1.1.1.1"><plus id="A1.Ex21.m1.1.1.1.1.1.1.1.cmml" xref="A1.Ex21.m1.1.1.1.1.1.1.1"></plus><apply id="A1.Ex21.m1.1.1.1.1.1.1.2.cmml" xref="A1.Ex21.m1.1.1.1.1.1.1.2"><times id="A1.Ex21.m1.1.1.1.1.1.1.2.1.cmml" xref="A1.Ex21.m1.1.1.1.1.1.1.2.1"></times><cn id="A1.Ex21.m1.1.1.1.1.1.1.2.2.cmml" type="integer" xref="A1.Ex21.m1.1.1.1.1.1.1.2.2">8</cn><ci id="A1.Ex21.m1.1.1.1.1.1.1.2.3.cmml" xref="A1.Ex21.m1.1.1.1.1.1.1.2.3">𝑀</ci><apply id="A1.Ex21.m1.1.1.1.1.1.1.2.4.cmml" xref="A1.Ex21.m1.1.1.1.1.1.1.2.4"><csymbol cd="ambiguous" id="A1.Ex21.m1.1.1.1.1.1.1.2.4.1.cmml" xref="A1.Ex21.m1.1.1.1.1.1.1.2.4">superscript</csymbol><apply id="A1.Ex21.m1.1.1.1.1.1.1.2.4.2.cmml" xref="A1.Ex21.m1.1.1.1.1.1.1.2.4"><csymbol cd="ambiguous" id="A1.Ex21.m1.1.1.1.1.1.1.2.4.2.1.cmml" xref="A1.Ex21.m1.1.1.1.1.1.1.2.4">subscript</csymbol><ci id="A1.Ex21.m1.1.1.1.1.1.1.2.4.2.2.cmml" xref="A1.Ex21.m1.1.1.1.1.1.1.2.4.2.2">𝐻</ci><ci id="A1.Ex21.m1.1.1.1.1.1.1.2.4.2.3.cmml" xref="A1.Ex21.m1.1.1.1.1.1.1.2.4.2.3">𝑟</ci></apply><cn id="A1.Ex21.m1.1.1.1.1.1.1.2.4.3.cmml" type="integer" xref="A1.Ex21.m1.1.1.1.1.1.1.2.4.3">2</cn></apply></apply><apply id="A1.Ex21.m1.1.1.1.1.1.1.3.cmml" xref="A1.Ex21.m1.1.1.1.1.1.1.3"><times id="A1.Ex21.m1.1.1.1.1.1.1.3.1.cmml" xref="A1.Ex21.m1.1.1.1.1.1.1.3.1"></times><cn id="A1.Ex21.m1.1.1.1.1.1.1.3.2.cmml" type="integer" xref="A1.Ex21.m1.1.1.1.1.1.1.3.2">4</cn><apply id="A1.Ex21.m1.1.1.1.1.1.1.3.3.cmml" xref="A1.Ex21.m1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="A1.Ex21.m1.1.1.1.1.1.1.3.3.1.cmml" xref="A1.Ex21.m1.1.1.1.1.1.1.3.3">superscript</csymbol><ci id="A1.Ex21.m1.1.1.1.1.1.1.3.3.2.cmml" xref="A1.Ex21.m1.1.1.1.1.1.1.3.3.2">𝑀</ci><cn id="A1.Ex21.m1.1.1.1.1.1.1.3.3.3.cmml" type="integer" xref="A1.Ex21.m1.1.1.1.1.1.1.3.3.3">2</cn></apply><apply id="A1.Ex21.m1.1.1.1.1.1.1.3.4.cmml" xref="A1.Ex21.m1.1.1.1.1.1.1.3.4"><csymbol cd="ambiguous" id="A1.Ex21.m1.1.1.1.1.1.1.3.4.1.cmml" xref="A1.Ex21.m1.1.1.1.1.1.1.3.4">subscript</csymbol><ci id="A1.Ex21.m1.1.1.1.1.1.1.3.4.2.cmml" xref="A1.Ex21.m1.1.1.1.1.1.1.3.4.2">𝐻</ci><ci id="A1.Ex21.m1.1.1.1.1.1.1.3.4.3.cmml" xref="A1.Ex21.m1.1.1.1.1.1.1.3.4.3">𝑟</ci></apply></apply><apply id="A1.Ex21.m1.1.1.1.1.1.1.4.cmml" xref="A1.Ex21.m1.1.1.1.1.1.1.4"><times id="A1.Ex21.m1.1.1.1.1.1.1.4.1.cmml" xref="A1.Ex21.m1.1.1.1.1.1.1.4.1"></times><cn id="A1.Ex21.m1.1.1.1.1.1.1.4.2.cmml" type="integer" xref="A1.Ex21.m1.1.1.1.1.1.1.4.2">4</cn><ci id="A1.Ex21.m1.1.1.1.1.1.1.4.3.cmml" xref="A1.Ex21.m1.1.1.1.1.1.1.4.3">𝑀</ci><apply id="A1.Ex21.m1.1.1.1.1.1.1.4.4.cmml" xref="A1.Ex21.m1.1.1.1.1.1.1.4.4"><csymbol cd="ambiguous" id="A1.Ex21.m1.1.1.1.1.1.1.4.4.1.cmml" xref="A1.Ex21.m1.1.1.1.1.1.1.4.4">subscript</csymbol><ci id="A1.Ex21.m1.1.1.1.1.1.1.4.4.2.cmml" xref="A1.Ex21.m1.1.1.1.1.1.1.4.4.2">𝐻</ci><ci id="A1.Ex21.m1.1.1.1.1.1.1.4.4.3.cmml" xref="A1.Ex21.m1.1.1.1.1.1.1.4.4.3">𝑟</ci></apply><apply id="A1.Ex21.m1.1.1.1.1.1.1.4.5.cmml" xref="A1.Ex21.m1.1.1.1.1.1.1.4.5"><csymbol cd="ambiguous" id="A1.Ex21.m1.1.1.1.1.1.1.4.5.1.cmml" xref="A1.Ex21.m1.1.1.1.1.1.1.4.5">subscript</csymbol><ci id="A1.Ex21.m1.1.1.1.1.1.1.4.5.2.cmml" xref="A1.Ex21.m1.1.1.1.1.1.1.4.5.2">𝐷</ci><apply id="A1.Ex21.m1.1.1.1.1.1.1.4.5.3.cmml" xref="A1.Ex21.m1.1.1.1.1.1.1.4.5.3"><csymbol cd="ambiguous" id="A1.Ex21.m1.1.1.1.1.1.1.4.5.3.1.cmml" xref="A1.Ex21.m1.1.1.1.1.1.1.4.5.3">subscript</csymbol><ci id="A1.Ex21.m1.1.1.1.1.1.1.4.5.3.2.cmml" xref="A1.Ex21.m1.1.1.1.1.1.1.4.5.3.2">𝑟</ci><ci id="A1.Ex21.m1.1.1.1.1.1.1.4.5.3.3a.cmml" xref="A1.Ex21.m1.1.1.1.1.1.1.4.5.3.3"><mtext id="A1.Ex21.m1.1.1.1.1.1.1.4.5.3.3.cmml" mathsize="50%" xref="A1.Ex21.m1.1.1.1.1.1.1.4.5.3.3">ff</mtext></ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex21.m1.1c">\displaystyle+L_{r}\times\left(8\times M\times H_{r}^{2}+4\times M^{2}\times H%
_{r}+4\times M\times H_{r}\times D_{r_{\text{ff}}}\right)</annotation><annotation encoding="application/x-llamapun" id="A1.Ex21.m1.1d">+ italic_L start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT × ( 8 × italic_M × italic_H start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + 4 × italic_M start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT × italic_H start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT + 4 × italic_M × italic_H start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT × italic_D start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT ff end_POSTSUBSCRIPT end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A1.E14"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle+2\times M\times H_{r}\times V+3\times M\times V\Bigg{]}\times E%
\quad\text{(Eq.~{}\ref{eq:sharding_routers}: sharding data for routers)}" class="ltx_math_unparsed" display="inline" id="A1.E14.m1.1"><semantics id="A1.E14.m1.1a"><mrow id="A1.E14.m1.1b"><mo id="A1.E14.m1.1.1">+</mo><mn id="A1.E14.m1.1.2">2</mn><mo id="A1.E14.m1.1.3" lspace="0.222em" rspace="0.222em">×</mo><mi id="A1.E14.m1.1.4">M</mi><mo id="A1.E14.m1.1.5" lspace="0.222em" rspace="0.222em">×</mo><msub id="A1.E14.m1.1.6"><mi id="A1.E14.m1.1.6.2">H</mi><mi id="A1.E14.m1.1.6.3">r</mi></msub><mo id="A1.E14.m1.1.7" lspace="0.222em" rspace="0.222em">×</mo><mi id="A1.E14.m1.1.8">V</mi><mo id="A1.E14.m1.1.9">+</mo><mn id="A1.E14.m1.1.10">3</mn><mo id="A1.E14.m1.1.11" lspace="0.222em" rspace="0.222em">×</mo><mi id="A1.E14.m1.1.12">M</mi><mo id="A1.E14.m1.1.13" lspace="0.222em" rspace="0.222em">×</mo><mi id="A1.E14.m1.1.14">V</mi><mo id="A1.E14.m1.1.15" maxsize="260%" minsize="260%" rspace="0.055em">]</mo><mo id="A1.E14.m1.1.16" rspace="0.222em">×</mo><mi id="A1.E14.m1.1.17">E</mi><mspace id="A1.E14.m1.1.18" width="1em"></mspace><mrow id="A1.E14.m1.1.19"><mtext id="A1.E14.m1.1.19a">(Eq.&nbsp;</mtext><mtext id="A1.E14.m1.1.19b"><a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#A1.E14" title="In A.3.2 Mixture of LLMs ‣ A.3 Computational Cost ‣ Appendix A Language modeling experiments ‣ No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_tag">14</span></a></mtext><mtext id="A1.E14.m1.1.19e">: sharding data for routers)</mtext></mrow></mrow><annotation encoding="application/x-tex" id="A1.E14.m1.1c">\displaystyle+2\times M\times H_{r}\times V+3\times M\times V\Bigg{]}\times E%
\quad\text{(Eq.~{}\ref{eq:sharding_routers}: sharding data for routers)}</annotation><annotation encoding="application/x-llamapun" id="A1.E14.m1.1d">+ 2 × italic_M × italic_H start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT × italic_V + 3 × italic_M × italic_V ] × italic_E (Eq. : sharding data for routers)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(14)</span></td>
</tr></tbody>
<tbody id="A1.Ex22"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\ 3\times N_{\text{steps\_expert}}\times\Bigg{[}B\times S\times H" class="ltx_math_unparsed" display="inline" id="A1.Ex22.m1.1"><semantics id="A1.Ex22.m1.1a"><mrow id="A1.Ex22.m1.1b"><mn id="A1.Ex22.m1.1.1">3</mn><mo id="A1.Ex22.m1.1.2" lspace="0.222em" rspace="0.222em">×</mo><msub id="A1.Ex22.m1.1.3"><mi id="A1.Ex22.m1.1.3.2">N</mi><mtext id="A1.Ex22.m1.1.3.3">steps_expert</mtext></msub><mo id="A1.Ex22.m1.1.4" lspace="0.222em" rspace="0.222em">×</mo><mrow id="A1.Ex22.m1.1.5"><mo id="A1.Ex22.m1.1.5.1" maxsize="260%" minsize="260%">[</mo><mi id="A1.Ex22.m1.1.5.2">B</mi><mo id="A1.Ex22.m1.1.5.3" lspace="0.222em" rspace="0.222em">×</mo><mi id="A1.Ex22.m1.1.5.4">S</mi><mo id="A1.Ex22.m1.1.5.5" lspace="0.222em" rspace="0.222em">×</mo><mi id="A1.Ex22.m1.1.5.6">H</mi></mrow></mrow><annotation encoding="application/x-tex" id="A1.Ex22.m1.1c">\displaystyle\ 3\times N_{\text{steps\_expert}}\times\Bigg{[}B\times S\times H</annotation><annotation encoding="application/x-llamapun" id="A1.Ex22.m1.1d">3 × italic_N start_POSTSUBSCRIPT steps_expert end_POSTSUBSCRIPT × [ italic_B × italic_S × italic_H</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A1.Ex23"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle+L\times\left(8\times B\times S\times H^{2}+4\times B\times S^{2}%
\times H+4\times B\times S\times H\times D_{\text{ff}}\right)" class="ltx_Math" display="inline" id="A1.Ex23.m1.1"><semantics id="A1.Ex23.m1.1a"><mrow id="A1.Ex23.m1.1.1" xref="A1.Ex23.m1.1.1.cmml"><mo id="A1.Ex23.m1.1.1a" xref="A1.Ex23.m1.1.1.cmml">+</mo><mrow id="A1.Ex23.m1.1.1.1" xref="A1.Ex23.m1.1.1.1.cmml"><mi id="A1.Ex23.m1.1.1.1.3" xref="A1.Ex23.m1.1.1.1.3.cmml">L</mi><mo id="A1.Ex23.m1.1.1.1.2" lspace="0.222em" rspace="0.222em" xref="A1.Ex23.m1.1.1.1.2.cmml">×</mo><mrow id="A1.Ex23.m1.1.1.1.1.1" xref="A1.Ex23.m1.1.1.1.1.1.1.cmml"><mo id="A1.Ex23.m1.1.1.1.1.1.2" xref="A1.Ex23.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.Ex23.m1.1.1.1.1.1.1" xref="A1.Ex23.m1.1.1.1.1.1.1.cmml"><mrow id="A1.Ex23.m1.1.1.1.1.1.1.2" xref="A1.Ex23.m1.1.1.1.1.1.1.2.cmml"><mn id="A1.Ex23.m1.1.1.1.1.1.1.2.2" xref="A1.Ex23.m1.1.1.1.1.1.1.2.2.cmml">8</mn><mo id="A1.Ex23.m1.1.1.1.1.1.1.2.1" lspace="0.222em" rspace="0.222em" xref="A1.Ex23.m1.1.1.1.1.1.1.2.1.cmml">×</mo><mi id="A1.Ex23.m1.1.1.1.1.1.1.2.3" xref="A1.Ex23.m1.1.1.1.1.1.1.2.3.cmml">B</mi><mo id="A1.Ex23.m1.1.1.1.1.1.1.2.1a" lspace="0.222em" rspace="0.222em" xref="A1.Ex23.m1.1.1.1.1.1.1.2.1.cmml">×</mo><mi id="A1.Ex23.m1.1.1.1.1.1.1.2.4" xref="A1.Ex23.m1.1.1.1.1.1.1.2.4.cmml">S</mi><mo id="A1.Ex23.m1.1.1.1.1.1.1.2.1b" lspace="0.222em" rspace="0.222em" xref="A1.Ex23.m1.1.1.1.1.1.1.2.1.cmml">×</mo><msup id="A1.Ex23.m1.1.1.1.1.1.1.2.5" xref="A1.Ex23.m1.1.1.1.1.1.1.2.5.cmml"><mi id="A1.Ex23.m1.1.1.1.1.1.1.2.5.2" xref="A1.Ex23.m1.1.1.1.1.1.1.2.5.2.cmml">H</mi><mn id="A1.Ex23.m1.1.1.1.1.1.1.2.5.3" xref="A1.Ex23.m1.1.1.1.1.1.1.2.5.3.cmml">2</mn></msup></mrow><mo id="A1.Ex23.m1.1.1.1.1.1.1.1" xref="A1.Ex23.m1.1.1.1.1.1.1.1.cmml">+</mo><mrow id="A1.Ex23.m1.1.1.1.1.1.1.3" xref="A1.Ex23.m1.1.1.1.1.1.1.3.cmml"><mn id="A1.Ex23.m1.1.1.1.1.1.1.3.2" xref="A1.Ex23.m1.1.1.1.1.1.1.3.2.cmml">4</mn><mo id="A1.Ex23.m1.1.1.1.1.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="A1.Ex23.m1.1.1.1.1.1.1.3.1.cmml">×</mo><mi id="A1.Ex23.m1.1.1.1.1.1.1.3.3" xref="A1.Ex23.m1.1.1.1.1.1.1.3.3.cmml">B</mi><mo id="A1.Ex23.m1.1.1.1.1.1.1.3.1a" lspace="0.222em" rspace="0.222em" xref="A1.Ex23.m1.1.1.1.1.1.1.3.1.cmml">×</mo><msup id="A1.Ex23.m1.1.1.1.1.1.1.3.4" xref="A1.Ex23.m1.1.1.1.1.1.1.3.4.cmml"><mi id="A1.Ex23.m1.1.1.1.1.1.1.3.4.2" xref="A1.Ex23.m1.1.1.1.1.1.1.3.4.2.cmml">S</mi><mn id="A1.Ex23.m1.1.1.1.1.1.1.3.4.3" xref="A1.Ex23.m1.1.1.1.1.1.1.3.4.3.cmml">2</mn></msup><mo id="A1.Ex23.m1.1.1.1.1.1.1.3.1b" lspace="0.222em" rspace="0.222em" xref="A1.Ex23.m1.1.1.1.1.1.1.3.1.cmml">×</mo><mi id="A1.Ex23.m1.1.1.1.1.1.1.3.5" xref="A1.Ex23.m1.1.1.1.1.1.1.3.5.cmml">H</mi></mrow><mo id="A1.Ex23.m1.1.1.1.1.1.1.1a" xref="A1.Ex23.m1.1.1.1.1.1.1.1.cmml">+</mo><mrow id="A1.Ex23.m1.1.1.1.1.1.1.4" xref="A1.Ex23.m1.1.1.1.1.1.1.4.cmml"><mn id="A1.Ex23.m1.1.1.1.1.1.1.4.2" xref="A1.Ex23.m1.1.1.1.1.1.1.4.2.cmml">4</mn><mo id="A1.Ex23.m1.1.1.1.1.1.1.4.1" lspace="0.222em" rspace="0.222em" xref="A1.Ex23.m1.1.1.1.1.1.1.4.1.cmml">×</mo><mi id="A1.Ex23.m1.1.1.1.1.1.1.4.3" xref="A1.Ex23.m1.1.1.1.1.1.1.4.3.cmml">B</mi><mo id="A1.Ex23.m1.1.1.1.1.1.1.4.1a" lspace="0.222em" rspace="0.222em" xref="A1.Ex23.m1.1.1.1.1.1.1.4.1.cmml">×</mo><mi id="A1.Ex23.m1.1.1.1.1.1.1.4.4" xref="A1.Ex23.m1.1.1.1.1.1.1.4.4.cmml">S</mi><mo id="A1.Ex23.m1.1.1.1.1.1.1.4.1b" lspace="0.222em" rspace="0.222em" xref="A1.Ex23.m1.1.1.1.1.1.1.4.1.cmml">×</mo><mi id="A1.Ex23.m1.1.1.1.1.1.1.4.5" xref="A1.Ex23.m1.1.1.1.1.1.1.4.5.cmml">H</mi><mo id="A1.Ex23.m1.1.1.1.1.1.1.4.1c" lspace="0.222em" rspace="0.222em" xref="A1.Ex23.m1.1.1.1.1.1.1.4.1.cmml">×</mo><msub id="A1.Ex23.m1.1.1.1.1.1.1.4.6" xref="A1.Ex23.m1.1.1.1.1.1.1.4.6.cmml"><mi id="A1.Ex23.m1.1.1.1.1.1.1.4.6.2" xref="A1.Ex23.m1.1.1.1.1.1.1.4.6.2.cmml">D</mi><mtext id="A1.Ex23.m1.1.1.1.1.1.1.4.6.3" xref="A1.Ex23.m1.1.1.1.1.1.1.4.6.3a.cmml">ff</mtext></msub></mrow></mrow><mo id="A1.Ex23.m1.1.1.1.1.1.3" xref="A1.Ex23.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex23.m1.1b"><apply id="A1.Ex23.m1.1.1.cmml" xref="A1.Ex23.m1.1.1"><plus id="A1.Ex23.m1.1.1.2.cmml" xref="A1.Ex23.m1.1.1"></plus><apply id="A1.Ex23.m1.1.1.1.cmml" xref="A1.Ex23.m1.1.1.1"><times id="A1.Ex23.m1.1.1.1.2.cmml" xref="A1.Ex23.m1.1.1.1.2"></times><ci id="A1.Ex23.m1.1.1.1.3.cmml" xref="A1.Ex23.m1.1.1.1.3">𝐿</ci><apply id="A1.Ex23.m1.1.1.1.1.1.1.cmml" xref="A1.Ex23.m1.1.1.1.1.1"><plus id="A1.Ex23.m1.1.1.1.1.1.1.1.cmml" xref="A1.Ex23.m1.1.1.1.1.1.1.1"></plus><apply id="A1.Ex23.m1.1.1.1.1.1.1.2.cmml" xref="A1.Ex23.m1.1.1.1.1.1.1.2"><times id="A1.Ex23.m1.1.1.1.1.1.1.2.1.cmml" xref="A1.Ex23.m1.1.1.1.1.1.1.2.1"></times><cn id="A1.Ex23.m1.1.1.1.1.1.1.2.2.cmml" type="integer" xref="A1.Ex23.m1.1.1.1.1.1.1.2.2">8</cn><ci id="A1.Ex23.m1.1.1.1.1.1.1.2.3.cmml" xref="A1.Ex23.m1.1.1.1.1.1.1.2.3">𝐵</ci><ci id="A1.Ex23.m1.1.1.1.1.1.1.2.4.cmml" xref="A1.Ex23.m1.1.1.1.1.1.1.2.4">𝑆</ci><apply id="A1.Ex23.m1.1.1.1.1.1.1.2.5.cmml" xref="A1.Ex23.m1.1.1.1.1.1.1.2.5"><csymbol cd="ambiguous" id="A1.Ex23.m1.1.1.1.1.1.1.2.5.1.cmml" xref="A1.Ex23.m1.1.1.1.1.1.1.2.5">superscript</csymbol><ci id="A1.Ex23.m1.1.1.1.1.1.1.2.5.2.cmml" xref="A1.Ex23.m1.1.1.1.1.1.1.2.5.2">𝐻</ci><cn id="A1.Ex23.m1.1.1.1.1.1.1.2.5.3.cmml" type="integer" xref="A1.Ex23.m1.1.1.1.1.1.1.2.5.3">2</cn></apply></apply><apply id="A1.Ex23.m1.1.1.1.1.1.1.3.cmml" xref="A1.Ex23.m1.1.1.1.1.1.1.3"><times id="A1.Ex23.m1.1.1.1.1.1.1.3.1.cmml" xref="A1.Ex23.m1.1.1.1.1.1.1.3.1"></times><cn id="A1.Ex23.m1.1.1.1.1.1.1.3.2.cmml" type="integer" xref="A1.Ex23.m1.1.1.1.1.1.1.3.2">4</cn><ci id="A1.Ex23.m1.1.1.1.1.1.1.3.3.cmml" xref="A1.Ex23.m1.1.1.1.1.1.1.3.3">𝐵</ci><apply id="A1.Ex23.m1.1.1.1.1.1.1.3.4.cmml" xref="A1.Ex23.m1.1.1.1.1.1.1.3.4"><csymbol cd="ambiguous" id="A1.Ex23.m1.1.1.1.1.1.1.3.4.1.cmml" xref="A1.Ex23.m1.1.1.1.1.1.1.3.4">superscript</csymbol><ci id="A1.Ex23.m1.1.1.1.1.1.1.3.4.2.cmml" xref="A1.Ex23.m1.1.1.1.1.1.1.3.4.2">𝑆</ci><cn id="A1.Ex23.m1.1.1.1.1.1.1.3.4.3.cmml" type="integer" xref="A1.Ex23.m1.1.1.1.1.1.1.3.4.3">2</cn></apply><ci id="A1.Ex23.m1.1.1.1.1.1.1.3.5.cmml" xref="A1.Ex23.m1.1.1.1.1.1.1.3.5">𝐻</ci></apply><apply id="A1.Ex23.m1.1.1.1.1.1.1.4.cmml" xref="A1.Ex23.m1.1.1.1.1.1.1.4"><times id="A1.Ex23.m1.1.1.1.1.1.1.4.1.cmml" xref="A1.Ex23.m1.1.1.1.1.1.1.4.1"></times><cn id="A1.Ex23.m1.1.1.1.1.1.1.4.2.cmml" type="integer" xref="A1.Ex23.m1.1.1.1.1.1.1.4.2">4</cn><ci id="A1.Ex23.m1.1.1.1.1.1.1.4.3.cmml" xref="A1.Ex23.m1.1.1.1.1.1.1.4.3">𝐵</ci><ci id="A1.Ex23.m1.1.1.1.1.1.1.4.4.cmml" xref="A1.Ex23.m1.1.1.1.1.1.1.4.4">𝑆</ci><ci id="A1.Ex23.m1.1.1.1.1.1.1.4.5.cmml" xref="A1.Ex23.m1.1.1.1.1.1.1.4.5">𝐻</ci><apply id="A1.Ex23.m1.1.1.1.1.1.1.4.6.cmml" xref="A1.Ex23.m1.1.1.1.1.1.1.4.6"><csymbol cd="ambiguous" id="A1.Ex23.m1.1.1.1.1.1.1.4.6.1.cmml" xref="A1.Ex23.m1.1.1.1.1.1.1.4.6">subscript</csymbol><ci id="A1.Ex23.m1.1.1.1.1.1.1.4.6.2.cmml" xref="A1.Ex23.m1.1.1.1.1.1.1.4.6.2">𝐷</ci><ci id="A1.Ex23.m1.1.1.1.1.1.1.4.6.3a.cmml" xref="A1.Ex23.m1.1.1.1.1.1.1.4.6.3"><mtext id="A1.Ex23.m1.1.1.1.1.1.1.4.6.3.cmml" mathsize="70%" xref="A1.Ex23.m1.1.1.1.1.1.1.4.6.3">ff</mtext></ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex23.m1.1c">\displaystyle+L\times\left(8\times B\times S\times H^{2}+4\times B\times S^{2}%
\times H+4\times B\times S\times H\times D_{\text{ff}}\right)</annotation><annotation encoding="application/x-llamapun" id="A1.Ex23.m1.1d">+ italic_L × ( 8 × italic_B × italic_S × italic_H start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + 4 × italic_B × italic_S start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT × italic_H + 4 × italic_B × italic_S × italic_H × italic_D start_POSTSUBSCRIPT ff end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A1.E15"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle+2\times B\times S\times H\times V+3\times B\times S\times V\Bigg%
{]}\times E\quad\text{(Eq.~{}\ref{eq:training_experts}: Training Experts)}" class="ltx_math_unparsed" display="inline" id="A1.E15.m1.1"><semantics id="A1.E15.m1.1a"><mrow id="A1.E15.m1.1b"><mo id="A1.E15.m1.1.1">+</mo><mn id="A1.E15.m1.1.2">2</mn><mo id="A1.E15.m1.1.3" lspace="0.222em" rspace="0.222em">×</mo><mi id="A1.E15.m1.1.4">B</mi><mo id="A1.E15.m1.1.5" lspace="0.222em" rspace="0.222em">×</mo><mi id="A1.E15.m1.1.6">S</mi><mo id="A1.E15.m1.1.7" lspace="0.222em" rspace="0.222em">×</mo><mi id="A1.E15.m1.1.8">H</mi><mo id="A1.E15.m1.1.9" lspace="0.222em" rspace="0.222em">×</mo><mi id="A1.E15.m1.1.10">V</mi><mo id="A1.E15.m1.1.11">+</mo><mn id="A1.E15.m1.1.12">3</mn><mo id="A1.E15.m1.1.13" lspace="0.222em" rspace="0.222em">×</mo><mi id="A1.E15.m1.1.14">B</mi><mo id="A1.E15.m1.1.15" lspace="0.222em" rspace="0.222em">×</mo><mi id="A1.E15.m1.1.16">S</mi><mo id="A1.E15.m1.1.17" lspace="0.222em" rspace="0.222em">×</mo><mi id="A1.E15.m1.1.18">V</mi><mo id="A1.E15.m1.1.19" maxsize="260%" minsize="260%" rspace="0.055em">]</mo><mo id="A1.E15.m1.1.20" rspace="0.222em">×</mo><mi id="A1.E15.m1.1.21">E</mi><mspace id="A1.E15.m1.1.22" width="1em"></mspace><mrow id="A1.E15.m1.1.23"><mtext id="A1.E15.m1.1.23a">(Eq.&nbsp;</mtext><mtext id="A1.E15.m1.1.23b"><a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#A1.E15" title="In A.3.2 Mixture of LLMs ‣ A.3 Computational Cost ‣ Appendix A Language modeling experiments ‣ No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_tag">15</span></a></mtext><mtext id="A1.E15.m1.1.23e">: Training Experts)</mtext></mrow></mrow><annotation encoding="application/x-tex" id="A1.E15.m1.1c">\displaystyle+2\times B\times S\times H\times V+3\times B\times S\times V\Bigg%
{]}\times E\quad\text{(Eq.~{}\ref{eq:training_experts}: Training Experts)}</annotation><annotation encoding="application/x-llamapun" id="A1.E15.m1.1d">+ 2 × italic_B × italic_S × italic_H × italic_V + 3 × italic_B × italic_S × italic_V ] × italic_E (Eq. : Training Experts)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(15)</span></td>
</tr></tbody>
<tbody id="A1.Ex24"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle+\bigg{(}N_{\text{steps\_expert}}\times B\times E\bigg{)}\times%
\Bigg{[}M\times H_{r}" class="ltx_math_unparsed" display="inline" id="A1.Ex24.m1.1"><semantics id="A1.Ex24.m1.1a"><mrow id="A1.Ex24.m1.1b"><mo id="A1.Ex24.m1.1.1">+</mo><mrow id="A1.Ex24.m1.1.2"><mo id="A1.Ex24.m1.1.2.1" maxsize="210%" minsize="210%">(</mo><msub id="A1.Ex24.m1.1.2.2"><mi id="A1.Ex24.m1.1.2.2.2">N</mi><mtext id="A1.Ex24.m1.1.2.2.3">steps_expert</mtext></msub><mo id="A1.Ex24.m1.1.2.3" lspace="0.222em" rspace="0.222em">×</mo><mi id="A1.Ex24.m1.1.2.4">B</mi><mo id="A1.Ex24.m1.1.2.5" lspace="0.222em" rspace="0.222em">×</mo><mi id="A1.Ex24.m1.1.2.6">E</mi><mo id="A1.Ex24.m1.1.2.7" maxsize="210%" minsize="210%" rspace="0.055em">)</mo></mrow><mo id="A1.Ex24.m1.1.3" rspace="0.222em">×</mo><mrow id="A1.Ex24.m1.1.4"><mo id="A1.Ex24.m1.1.4.1" maxsize="260%" minsize="260%">[</mo><mi id="A1.Ex24.m1.1.4.2">M</mi><mo id="A1.Ex24.m1.1.4.3" lspace="0.222em" rspace="0.222em">×</mo><msub id="A1.Ex24.m1.1.4.4"><mi id="A1.Ex24.m1.1.4.4.2">H</mi><mi id="A1.Ex24.m1.1.4.4.3">r</mi></msub></mrow></mrow><annotation encoding="application/x-tex" id="A1.Ex24.m1.1c">\displaystyle+\bigg{(}N_{\text{steps\_expert}}\times B\times E\bigg{)}\times%
\Bigg{[}M\times H_{r}</annotation><annotation encoding="application/x-llamapun" id="A1.Ex24.m1.1d">+ ( italic_N start_POSTSUBSCRIPT steps_expert end_POSTSUBSCRIPT × italic_B × italic_E ) × [ italic_M × italic_H start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A1.Ex25"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle+L_{r}\times\left(8\times M\times H_{r}^{2}+4\times M^{2}\times H%
_{r}+4\times M\times H_{r}\times D_{r_{\text{ff}}}\right)" class="ltx_Math" display="inline" id="A1.Ex25.m1.1"><semantics id="A1.Ex25.m1.1a"><mrow id="A1.Ex25.m1.1.1" xref="A1.Ex25.m1.1.1.cmml"><mo id="A1.Ex25.m1.1.1a" xref="A1.Ex25.m1.1.1.cmml">+</mo><mrow id="A1.Ex25.m1.1.1.1" xref="A1.Ex25.m1.1.1.1.cmml"><msub id="A1.Ex25.m1.1.1.1.3" xref="A1.Ex25.m1.1.1.1.3.cmml"><mi id="A1.Ex25.m1.1.1.1.3.2" xref="A1.Ex25.m1.1.1.1.3.2.cmml">L</mi><mi id="A1.Ex25.m1.1.1.1.3.3" xref="A1.Ex25.m1.1.1.1.3.3.cmml">r</mi></msub><mo id="A1.Ex25.m1.1.1.1.2" lspace="0.222em" rspace="0.222em" xref="A1.Ex25.m1.1.1.1.2.cmml">×</mo><mrow id="A1.Ex25.m1.1.1.1.1.1" xref="A1.Ex25.m1.1.1.1.1.1.1.cmml"><mo id="A1.Ex25.m1.1.1.1.1.1.2" xref="A1.Ex25.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.Ex25.m1.1.1.1.1.1.1" xref="A1.Ex25.m1.1.1.1.1.1.1.cmml"><mrow id="A1.Ex25.m1.1.1.1.1.1.1.2" xref="A1.Ex25.m1.1.1.1.1.1.1.2.cmml"><mn id="A1.Ex25.m1.1.1.1.1.1.1.2.2" xref="A1.Ex25.m1.1.1.1.1.1.1.2.2.cmml">8</mn><mo id="A1.Ex25.m1.1.1.1.1.1.1.2.1" lspace="0.222em" rspace="0.222em" xref="A1.Ex25.m1.1.1.1.1.1.1.2.1.cmml">×</mo><mi id="A1.Ex25.m1.1.1.1.1.1.1.2.3" xref="A1.Ex25.m1.1.1.1.1.1.1.2.3.cmml">M</mi><mo id="A1.Ex25.m1.1.1.1.1.1.1.2.1a" lspace="0.222em" rspace="0.222em" xref="A1.Ex25.m1.1.1.1.1.1.1.2.1.cmml">×</mo><msubsup id="A1.Ex25.m1.1.1.1.1.1.1.2.4" xref="A1.Ex25.m1.1.1.1.1.1.1.2.4.cmml"><mi id="A1.Ex25.m1.1.1.1.1.1.1.2.4.2.2" xref="A1.Ex25.m1.1.1.1.1.1.1.2.4.2.2.cmml">H</mi><mi id="A1.Ex25.m1.1.1.1.1.1.1.2.4.2.3" xref="A1.Ex25.m1.1.1.1.1.1.1.2.4.2.3.cmml">r</mi><mn id="A1.Ex25.m1.1.1.1.1.1.1.2.4.3" xref="A1.Ex25.m1.1.1.1.1.1.1.2.4.3.cmml">2</mn></msubsup></mrow><mo id="A1.Ex25.m1.1.1.1.1.1.1.1" xref="A1.Ex25.m1.1.1.1.1.1.1.1.cmml">+</mo><mrow id="A1.Ex25.m1.1.1.1.1.1.1.3" xref="A1.Ex25.m1.1.1.1.1.1.1.3.cmml"><mn id="A1.Ex25.m1.1.1.1.1.1.1.3.2" xref="A1.Ex25.m1.1.1.1.1.1.1.3.2.cmml">4</mn><mo id="A1.Ex25.m1.1.1.1.1.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="A1.Ex25.m1.1.1.1.1.1.1.3.1.cmml">×</mo><msup id="A1.Ex25.m1.1.1.1.1.1.1.3.3" xref="A1.Ex25.m1.1.1.1.1.1.1.3.3.cmml"><mi id="A1.Ex25.m1.1.1.1.1.1.1.3.3.2" xref="A1.Ex25.m1.1.1.1.1.1.1.3.3.2.cmml">M</mi><mn id="A1.Ex25.m1.1.1.1.1.1.1.3.3.3" xref="A1.Ex25.m1.1.1.1.1.1.1.3.3.3.cmml">2</mn></msup><mo id="A1.Ex25.m1.1.1.1.1.1.1.3.1a" lspace="0.222em" rspace="0.222em" xref="A1.Ex25.m1.1.1.1.1.1.1.3.1.cmml">×</mo><msub id="A1.Ex25.m1.1.1.1.1.1.1.3.4" xref="A1.Ex25.m1.1.1.1.1.1.1.3.4.cmml"><mi id="A1.Ex25.m1.1.1.1.1.1.1.3.4.2" xref="A1.Ex25.m1.1.1.1.1.1.1.3.4.2.cmml">H</mi><mi id="A1.Ex25.m1.1.1.1.1.1.1.3.4.3" xref="A1.Ex25.m1.1.1.1.1.1.1.3.4.3.cmml">r</mi></msub></mrow><mo id="A1.Ex25.m1.1.1.1.1.1.1.1a" xref="A1.Ex25.m1.1.1.1.1.1.1.1.cmml">+</mo><mrow id="A1.Ex25.m1.1.1.1.1.1.1.4" xref="A1.Ex25.m1.1.1.1.1.1.1.4.cmml"><mn id="A1.Ex25.m1.1.1.1.1.1.1.4.2" xref="A1.Ex25.m1.1.1.1.1.1.1.4.2.cmml">4</mn><mo id="A1.Ex25.m1.1.1.1.1.1.1.4.1" lspace="0.222em" rspace="0.222em" xref="A1.Ex25.m1.1.1.1.1.1.1.4.1.cmml">×</mo><mi id="A1.Ex25.m1.1.1.1.1.1.1.4.3" xref="A1.Ex25.m1.1.1.1.1.1.1.4.3.cmml">M</mi><mo id="A1.Ex25.m1.1.1.1.1.1.1.4.1a" lspace="0.222em" rspace="0.222em" xref="A1.Ex25.m1.1.1.1.1.1.1.4.1.cmml">×</mo><msub id="A1.Ex25.m1.1.1.1.1.1.1.4.4" xref="A1.Ex25.m1.1.1.1.1.1.1.4.4.cmml"><mi id="A1.Ex25.m1.1.1.1.1.1.1.4.4.2" xref="A1.Ex25.m1.1.1.1.1.1.1.4.4.2.cmml">H</mi><mi id="A1.Ex25.m1.1.1.1.1.1.1.4.4.3" xref="A1.Ex25.m1.1.1.1.1.1.1.4.4.3.cmml">r</mi></msub><mo id="A1.Ex25.m1.1.1.1.1.1.1.4.1b" lspace="0.222em" rspace="0.222em" xref="A1.Ex25.m1.1.1.1.1.1.1.4.1.cmml">×</mo><msub id="A1.Ex25.m1.1.1.1.1.1.1.4.5" xref="A1.Ex25.m1.1.1.1.1.1.1.4.5.cmml"><mi id="A1.Ex25.m1.1.1.1.1.1.1.4.5.2" xref="A1.Ex25.m1.1.1.1.1.1.1.4.5.2.cmml">D</mi><msub id="A1.Ex25.m1.1.1.1.1.1.1.4.5.3" xref="A1.Ex25.m1.1.1.1.1.1.1.4.5.3.cmml"><mi id="A1.Ex25.m1.1.1.1.1.1.1.4.5.3.2" xref="A1.Ex25.m1.1.1.1.1.1.1.4.5.3.2.cmml">r</mi><mtext id="A1.Ex25.m1.1.1.1.1.1.1.4.5.3.3" xref="A1.Ex25.m1.1.1.1.1.1.1.4.5.3.3a.cmml">ff</mtext></msub></msub></mrow></mrow><mo id="A1.Ex25.m1.1.1.1.1.1.3" xref="A1.Ex25.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex25.m1.1b"><apply id="A1.Ex25.m1.1.1.cmml" xref="A1.Ex25.m1.1.1"><plus id="A1.Ex25.m1.1.1.2.cmml" xref="A1.Ex25.m1.1.1"></plus><apply id="A1.Ex25.m1.1.1.1.cmml" xref="A1.Ex25.m1.1.1.1"><times id="A1.Ex25.m1.1.1.1.2.cmml" xref="A1.Ex25.m1.1.1.1.2"></times><apply id="A1.Ex25.m1.1.1.1.3.cmml" xref="A1.Ex25.m1.1.1.1.3"><csymbol cd="ambiguous" id="A1.Ex25.m1.1.1.1.3.1.cmml" xref="A1.Ex25.m1.1.1.1.3">subscript</csymbol><ci id="A1.Ex25.m1.1.1.1.3.2.cmml" xref="A1.Ex25.m1.1.1.1.3.2">𝐿</ci><ci id="A1.Ex25.m1.1.1.1.3.3.cmml" xref="A1.Ex25.m1.1.1.1.3.3">𝑟</ci></apply><apply id="A1.Ex25.m1.1.1.1.1.1.1.cmml" xref="A1.Ex25.m1.1.1.1.1.1"><plus id="A1.Ex25.m1.1.1.1.1.1.1.1.cmml" xref="A1.Ex25.m1.1.1.1.1.1.1.1"></plus><apply id="A1.Ex25.m1.1.1.1.1.1.1.2.cmml" xref="A1.Ex25.m1.1.1.1.1.1.1.2"><times id="A1.Ex25.m1.1.1.1.1.1.1.2.1.cmml" xref="A1.Ex25.m1.1.1.1.1.1.1.2.1"></times><cn id="A1.Ex25.m1.1.1.1.1.1.1.2.2.cmml" type="integer" xref="A1.Ex25.m1.1.1.1.1.1.1.2.2">8</cn><ci id="A1.Ex25.m1.1.1.1.1.1.1.2.3.cmml" xref="A1.Ex25.m1.1.1.1.1.1.1.2.3">𝑀</ci><apply id="A1.Ex25.m1.1.1.1.1.1.1.2.4.cmml" xref="A1.Ex25.m1.1.1.1.1.1.1.2.4"><csymbol cd="ambiguous" id="A1.Ex25.m1.1.1.1.1.1.1.2.4.1.cmml" xref="A1.Ex25.m1.1.1.1.1.1.1.2.4">superscript</csymbol><apply id="A1.Ex25.m1.1.1.1.1.1.1.2.4.2.cmml" xref="A1.Ex25.m1.1.1.1.1.1.1.2.4"><csymbol cd="ambiguous" id="A1.Ex25.m1.1.1.1.1.1.1.2.4.2.1.cmml" xref="A1.Ex25.m1.1.1.1.1.1.1.2.4">subscript</csymbol><ci id="A1.Ex25.m1.1.1.1.1.1.1.2.4.2.2.cmml" xref="A1.Ex25.m1.1.1.1.1.1.1.2.4.2.2">𝐻</ci><ci id="A1.Ex25.m1.1.1.1.1.1.1.2.4.2.3.cmml" xref="A1.Ex25.m1.1.1.1.1.1.1.2.4.2.3">𝑟</ci></apply><cn id="A1.Ex25.m1.1.1.1.1.1.1.2.4.3.cmml" type="integer" xref="A1.Ex25.m1.1.1.1.1.1.1.2.4.3">2</cn></apply></apply><apply id="A1.Ex25.m1.1.1.1.1.1.1.3.cmml" xref="A1.Ex25.m1.1.1.1.1.1.1.3"><times id="A1.Ex25.m1.1.1.1.1.1.1.3.1.cmml" xref="A1.Ex25.m1.1.1.1.1.1.1.3.1"></times><cn id="A1.Ex25.m1.1.1.1.1.1.1.3.2.cmml" type="integer" xref="A1.Ex25.m1.1.1.1.1.1.1.3.2">4</cn><apply id="A1.Ex25.m1.1.1.1.1.1.1.3.3.cmml" xref="A1.Ex25.m1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="A1.Ex25.m1.1.1.1.1.1.1.3.3.1.cmml" xref="A1.Ex25.m1.1.1.1.1.1.1.3.3">superscript</csymbol><ci id="A1.Ex25.m1.1.1.1.1.1.1.3.3.2.cmml" xref="A1.Ex25.m1.1.1.1.1.1.1.3.3.2">𝑀</ci><cn id="A1.Ex25.m1.1.1.1.1.1.1.3.3.3.cmml" type="integer" xref="A1.Ex25.m1.1.1.1.1.1.1.3.3.3">2</cn></apply><apply id="A1.Ex25.m1.1.1.1.1.1.1.3.4.cmml" xref="A1.Ex25.m1.1.1.1.1.1.1.3.4"><csymbol cd="ambiguous" id="A1.Ex25.m1.1.1.1.1.1.1.3.4.1.cmml" xref="A1.Ex25.m1.1.1.1.1.1.1.3.4">subscript</csymbol><ci id="A1.Ex25.m1.1.1.1.1.1.1.3.4.2.cmml" xref="A1.Ex25.m1.1.1.1.1.1.1.3.4.2">𝐻</ci><ci id="A1.Ex25.m1.1.1.1.1.1.1.3.4.3.cmml" xref="A1.Ex25.m1.1.1.1.1.1.1.3.4.3">𝑟</ci></apply></apply><apply id="A1.Ex25.m1.1.1.1.1.1.1.4.cmml" xref="A1.Ex25.m1.1.1.1.1.1.1.4"><times id="A1.Ex25.m1.1.1.1.1.1.1.4.1.cmml" xref="A1.Ex25.m1.1.1.1.1.1.1.4.1"></times><cn id="A1.Ex25.m1.1.1.1.1.1.1.4.2.cmml" type="integer" xref="A1.Ex25.m1.1.1.1.1.1.1.4.2">4</cn><ci id="A1.Ex25.m1.1.1.1.1.1.1.4.3.cmml" xref="A1.Ex25.m1.1.1.1.1.1.1.4.3">𝑀</ci><apply id="A1.Ex25.m1.1.1.1.1.1.1.4.4.cmml" xref="A1.Ex25.m1.1.1.1.1.1.1.4.4"><csymbol cd="ambiguous" id="A1.Ex25.m1.1.1.1.1.1.1.4.4.1.cmml" xref="A1.Ex25.m1.1.1.1.1.1.1.4.4">subscript</csymbol><ci id="A1.Ex25.m1.1.1.1.1.1.1.4.4.2.cmml" xref="A1.Ex25.m1.1.1.1.1.1.1.4.4.2">𝐻</ci><ci id="A1.Ex25.m1.1.1.1.1.1.1.4.4.3.cmml" xref="A1.Ex25.m1.1.1.1.1.1.1.4.4.3">𝑟</ci></apply><apply id="A1.Ex25.m1.1.1.1.1.1.1.4.5.cmml" xref="A1.Ex25.m1.1.1.1.1.1.1.4.5"><csymbol cd="ambiguous" id="A1.Ex25.m1.1.1.1.1.1.1.4.5.1.cmml" xref="A1.Ex25.m1.1.1.1.1.1.1.4.5">subscript</csymbol><ci id="A1.Ex25.m1.1.1.1.1.1.1.4.5.2.cmml" xref="A1.Ex25.m1.1.1.1.1.1.1.4.5.2">𝐷</ci><apply id="A1.Ex25.m1.1.1.1.1.1.1.4.5.3.cmml" xref="A1.Ex25.m1.1.1.1.1.1.1.4.5.3"><csymbol cd="ambiguous" id="A1.Ex25.m1.1.1.1.1.1.1.4.5.3.1.cmml" xref="A1.Ex25.m1.1.1.1.1.1.1.4.5.3">subscript</csymbol><ci id="A1.Ex25.m1.1.1.1.1.1.1.4.5.3.2.cmml" xref="A1.Ex25.m1.1.1.1.1.1.1.4.5.3.2">𝑟</ci><ci id="A1.Ex25.m1.1.1.1.1.1.1.4.5.3.3a.cmml" xref="A1.Ex25.m1.1.1.1.1.1.1.4.5.3.3"><mtext id="A1.Ex25.m1.1.1.1.1.1.1.4.5.3.3.cmml" mathsize="50%" xref="A1.Ex25.m1.1.1.1.1.1.1.4.5.3.3">ff</mtext></ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex25.m1.1c">\displaystyle+L_{r}\times\left(8\times M\times H_{r}^{2}+4\times M^{2}\times H%
_{r}+4\times M\times H_{r}\times D_{r_{\text{ff}}}\right)</annotation><annotation encoding="application/x-llamapun" id="A1.Ex25.m1.1d">+ italic_L start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT × ( 8 × italic_M × italic_H start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + 4 × italic_M start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT × italic_H start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT + 4 × italic_M × italic_H start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT × italic_D start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT ff end_POSTSUBSCRIPT end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A1.E16"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle+2\times M\times H_{r}\times V+3\times M\times V\Bigg{]}\times E%
\quad\text{(Eq.~{}\ref{eq:sharding_experts}: sharding data for experts)}" class="ltx_math_unparsed" display="inline" id="A1.E16.m1.1"><semantics id="A1.E16.m1.1a"><mrow id="A1.E16.m1.1b"><mo id="A1.E16.m1.1.1">+</mo><mn id="A1.E16.m1.1.2">2</mn><mo id="A1.E16.m1.1.3" lspace="0.222em" rspace="0.222em">×</mo><mi id="A1.E16.m1.1.4">M</mi><mo id="A1.E16.m1.1.5" lspace="0.222em" rspace="0.222em">×</mo><msub id="A1.E16.m1.1.6"><mi id="A1.E16.m1.1.6.2">H</mi><mi id="A1.E16.m1.1.6.3">r</mi></msub><mo id="A1.E16.m1.1.7" lspace="0.222em" rspace="0.222em">×</mo><mi id="A1.E16.m1.1.8">V</mi><mo id="A1.E16.m1.1.9">+</mo><mn id="A1.E16.m1.1.10">3</mn><mo id="A1.E16.m1.1.11" lspace="0.222em" rspace="0.222em">×</mo><mi id="A1.E16.m1.1.12">M</mi><mo id="A1.E16.m1.1.13" lspace="0.222em" rspace="0.222em">×</mo><mi id="A1.E16.m1.1.14">V</mi><mo id="A1.E16.m1.1.15" maxsize="260%" minsize="260%" rspace="0.055em">]</mo><mo id="A1.E16.m1.1.16" rspace="0.222em">×</mo><mi id="A1.E16.m1.1.17">E</mi><mspace id="A1.E16.m1.1.18" width="1em"></mspace><mrow id="A1.E16.m1.1.19"><mtext id="A1.E16.m1.1.19a">(Eq.&nbsp;</mtext><mtext id="A1.E16.m1.1.19b"><a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#A1.E16" title="In A.3.2 Mixture of LLMs ‣ A.3 Computational Cost ‣ Appendix A Language modeling experiments ‣ No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_tag">16</span></a></mtext><mtext id="A1.E16.m1.1.19e">: sharding data for experts)</mtext></mrow></mrow><annotation encoding="application/x-tex" id="A1.E16.m1.1c">\displaystyle+2\times M\times H_{r}\times V+3\times M\times V\Bigg{]}\times E%
\quad\text{(Eq.~{}\ref{eq:sharding_experts}: sharding data for experts)}</annotation><annotation encoding="application/x-llamapun" id="A1.E16.m1.1d">+ 2 × italic_M × italic_H start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT × italic_V + 3 × italic_M × italic_V ] × italic_E (Eq. : sharding data for experts)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(16)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="A1.SS3.SSS2.p5">
<p class="ltx_p" id="A1.SS3.SSS2.p5.1">In the above formula:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="A1.SS3.SSS2.p6">
<ul class="ltx_itemize" id="A1.I4">
<li class="ltx_item" id="A1.I4.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A1.I4.i1.p1">
<p class="ltx_p" id="A1.I4.i1.p1.2">Equations&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#A1.E15" title="In A.3.2 Mixture of LLMs ‣ A.3 Computational Cost ‣ Appendix A Language modeling experiments ‣ No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_tag">15</span></a> and &nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#A1.E13" title="In A.3.2 Mixture of LLMs ‣ A.3 Computational Cost ‣ Appendix A Language modeling experiments ‣ No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_tag">13</span></a> correspond to the total training FLOPs for <math alttext="E" class="ltx_Math" display="inline" id="A1.I4.i1.p1.1.m1.1"><semantics id="A1.I4.i1.p1.1.m1.1a"><mi id="A1.I4.i1.p1.1.m1.1.1" xref="A1.I4.i1.p1.1.m1.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="A1.I4.i1.p1.1.m1.1b"><ci id="A1.I4.i1.p1.1.m1.1.1.cmml" xref="A1.I4.i1.p1.1.m1.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.I4.i1.p1.1.m1.1c">E</annotation><annotation encoding="application/x-llamapun" id="A1.I4.i1.p1.1.m1.1d">italic_E</annotation></semantics></math> experts and <math alttext="E" class="ltx_Math" display="inline" id="A1.I4.i1.p1.2.m2.1"><semantics id="A1.I4.i1.p1.2.m2.1a"><mi id="A1.I4.i1.p1.2.m2.1.1" xref="A1.I4.i1.p1.2.m2.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="A1.I4.i1.p1.2.m2.1b"><ci id="A1.I4.i1.p1.2.m2.1.1.cmml" xref="A1.I4.i1.p1.2.m2.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.I4.i1.p1.2.m2.1c">E</annotation><annotation encoding="application/x-llamapun" id="A1.I4.i1.p1.2.m2.1d">italic_E</annotation></semantics></math> routers respectively.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="A1.I4.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para ltx_noindent" id="A1.I4.i2.p1">
<p class="ltx_p" id="A1.I4.i2.p1.3">Equations&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#A1.E16" title="In A.3.2 Mixture of LLMs ‣ A.3 Computational Cost ‣ Appendix A Language modeling experiments ‣ No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_tag">16</span></a> and <a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#A1.E14" title="In A.3.2 Mixture of LLMs ‣ A.3 Computational Cost ‣ Appendix A Language modeling experiments ‣ No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_tag">14</span></a> represents the inference cost of <math alttext="E" class="ltx_Math" display="inline" id="A1.I4.i2.p1.1.m1.1"><semantics id="A1.I4.i2.p1.1.m1.1a"><mi id="A1.I4.i2.p1.1.m1.1.1" xref="A1.I4.i2.p1.1.m1.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="A1.I4.i2.p1.1.m1.1b"><ci id="A1.I4.i2.p1.1.m1.1.1.cmml" xref="A1.I4.i2.p1.1.m1.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.I4.i2.p1.1.m1.1c">E</annotation><annotation encoding="application/x-llamapun" id="A1.I4.i2.p1.1.m1.1d">italic_E</annotation></semantics></math> routers on <math alttext="B" class="ltx_Math" display="inline" id="A1.I4.i2.p1.2.m2.1"><semantics id="A1.I4.i2.p1.2.m2.1a"><mi id="A1.I4.i2.p1.2.m2.1.1" xref="A1.I4.i2.p1.2.m2.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="A1.I4.i2.p1.2.m2.1b"><ci id="A1.I4.i2.p1.2.m2.1.1.cmml" xref="A1.I4.i2.p1.2.m2.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.I4.i2.p1.2.m2.1c">B</annotation><annotation encoding="application/x-llamapun" id="A1.I4.i2.p1.2.m2.1d">italic_B</annotation></semantics></math> batches with a prefix length <math alttext="M" class="ltx_Math" display="inline" id="A1.I4.i2.p1.3.m3.1"><semantics id="A1.I4.i2.p1.3.m3.1a"><mi id="A1.I4.i2.p1.3.m3.1.1" xref="A1.I4.i2.p1.3.m3.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="A1.I4.i2.p1.3.m3.1b"><ci id="A1.I4.i2.p1.3.m3.1.1.cmml" xref="A1.I4.i2.p1.3.m3.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.I4.i2.p1.3.m3.1c">M</annotation><annotation encoding="application/x-llamapun" id="A1.I4.i2.p1.3.m3.1d">italic_M</annotation></semantics></math> used to partition the data for experts and routers respectively.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
</ul>
</div>
<div class="ltx_para ltx_noindent" id="A1.SS3.SSS2.p7">
<p class="ltx_p" id="A1.SS3.SSS2.p7.1">Table&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#A1.T3" title="Table 3 ‣ A.3.2 Mixture of LLMs ‣ A.3 Computational Cost ‣ Appendix A Language modeling experiments ‣ No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_tag">3</span></a> presents the training and inference costs for our proposed mixture of language models compared to the dense baseline LLMs.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="A1.SS3.SSS2.p8">
<p class="ltx_p" id="A1.SS3.SSS2.p8.1">The expert balancing during training introduces only a negligible computational overhead relative to both training and inference costs. Therefore, it is excluded from our FLOPs calculations.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_table" id="A1.T3">
<table class="ltx_tabular ltx_centering ltx_align_middle" id="A1.T3.61">
<tbody><tr class="ltx_tr" id="A1.T3.61.62">
<td class="ltx_td ltx_align_left ltx_border_tt" id="A1.T3.61.62.1"><span class="ltx_text ltx_font_bold" id="A1.T3.61.62.1.1">Model</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A1.T3.61.62.2"><span class="ltx_text ltx_font_bold" id="A1.T3.61.62.2.1">Perplexity</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A1.T3.61.62.3"><span class="ltx_text ltx_font_bold" id="A1.T3.61.62.3.1">Training cost</span></td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_tt" id="A1.T3.61.62.4"><span class="ltx_text ltx_font_bold" id="A1.T3.61.62.4.1">Inference cost</span></td>
</tr>
<tr class="ltx_tr" id="A1.T3.4.4">
<td class="ltx_td ltx_align_left ltx_border_t" id="A1.T3.1.1.1">
<math alttext="335" class="ltx_Math" display="inline" id="A1.T3.1.1.1.m1.1"><semantics id="A1.T3.1.1.1.m1.1a"><mn id="A1.T3.1.1.1.m1.1.1" xref="A1.T3.1.1.1.m1.1.1.cmml">335</mn><annotation-xml encoding="MathML-Content" id="A1.T3.1.1.1.m1.1b"><cn id="A1.T3.1.1.1.m1.1.1.cmml" type="integer" xref="A1.T3.1.1.1.m1.1.1">335</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.1.1.1.m1.1c">335</annotation><annotation encoding="application/x-llamapun" id="A1.T3.1.1.1.m1.1d">335</annotation></semantics></math>M (dense)</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T3.2.2.2"><math alttext="11.78" class="ltx_Math" display="inline" id="A1.T3.2.2.2.m1.1"><semantics id="A1.T3.2.2.2.m1.1a"><mn id="A1.T3.2.2.2.m1.1.1" xref="A1.T3.2.2.2.m1.1.1.cmml">11.78</mn><annotation-xml encoding="MathML-Content" id="A1.T3.2.2.2.m1.1b"><cn id="A1.T3.2.2.2.m1.1.1.cmml" type="float" xref="A1.T3.2.2.2.m1.1.1">11.78</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.2.2.2.m1.1c">11.78</annotation><annotation encoding="application/x-llamapun" id="A1.T3.2.2.2.m1.1d">11.78</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T3.3.3.3"><math alttext="31.02" class="ltx_Math" display="inline" id="A1.T3.3.3.3.m1.1"><semantics id="A1.T3.3.3.3.m1.1a"><mn id="A1.T3.3.3.3.m1.1.1" xref="A1.T3.3.3.3.m1.1.1.cmml">31.02</mn><annotation-xml encoding="MathML-Content" id="A1.T3.3.3.3.m1.1b"><cn id="A1.T3.3.3.3.m1.1.1.cmml" type="float" xref="A1.T3.3.3.3.m1.1.1">31.02</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.3.3.3.m1.1c">31.02</annotation><annotation encoding="application/x-llamapun" id="A1.T3.3.3.3.m1.1d">31.02</annotation></semantics></math></td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" id="A1.T3.4.4.4"><math alttext="0.79" class="ltx_Math" display="inline" id="A1.T3.4.4.4.m1.1"><semantics id="A1.T3.4.4.4.m1.1a"><mn id="A1.T3.4.4.4.m1.1.1" xref="A1.T3.4.4.4.m1.1.1.cmml">0.79</mn><annotation-xml encoding="MathML-Content" id="A1.T3.4.4.4.m1.1b"><cn id="A1.T3.4.4.4.m1.1.1.cmml" type="float" xref="A1.T3.4.4.4.m1.1.1">0.79</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.4.4.4.m1.1c">0.79</annotation><annotation encoding="application/x-llamapun" id="A1.T3.4.4.4.m1.1d">0.79</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A1.T3.8.8">
<td class="ltx_td ltx_align_left" id="A1.T3.5.5.1">
<math alttext="335" class="ltx_Math" display="inline" id="A1.T3.5.5.1.m1.1"><semantics id="A1.T3.5.5.1.m1.1a"><mn id="A1.T3.5.5.1.m1.1.1" xref="A1.T3.5.5.1.m1.1.1.cmml">335</mn><annotation-xml encoding="MathML-Content" id="A1.T3.5.5.1.m1.1b"><cn id="A1.T3.5.5.1.m1.1.1.cmml" type="integer" xref="A1.T3.5.5.1.m1.1.1">335</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.5.5.1.m1.1c">335</annotation><annotation encoding="application/x-llamapun" id="A1.T3.5.5.1.m1.1d">335</annotation></semantics></math>M (4 experts)</td>
<td class="ltx_td ltx_align_center" id="A1.T3.6.6.2"><math alttext="10.78\,\color[rgb]{0.1,0.5,0.1}\definecolor[named]{pgfstrokecolor}{rgb}{%
0.1,0.5,0.1}{\downarrow\,8.49\%}" class="ltx_Math" display="inline" id="A1.T3.6.6.2.m1.1"><semantics id="A1.T3.6.6.2.m1.1a"><mrow id="A1.T3.6.6.2.m1.1.1" xref="A1.T3.6.6.2.m1.1.1.cmml"><mn id="A1.T3.6.6.2.m1.1.1.2" mathcolor="#000000" xref="A1.T3.6.6.2.m1.1.1.2.cmml">10.78</mn><mo id="A1.T3.6.6.2.m1.1.1.1" lspace="0.448em" mathcolor="#1A801A" stretchy="false" xref="A1.T3.6.6.2.m1.1.1.1.cmml">↓</mo><mrow id="A1.T3.6.6.2.m1.1.1.3" xref="A1.T3.6.6.2.m1.1.1.3.cmml"><mn id="A1.T3.6.6.2.m1.1.1.3.2" mathcolor="#1A801A" xref="A1.T3.6.6.2.m1.1.1.3.2.cmml"> 8.49</mn><mo id="A1.T3.6.6.2.m1.1.1.3.1" mathcolor="#1A801A" xref="A1.T3.6.6.2.m1.1.1.3.1.cmml">%</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.T3.6.6.2.m1.1b"><apply id="A1.T3.6.6.2.m1.1.1.cmml" xref="A1.T3.6.6.2.m1.1.1"><ci id="A1.T3.6.6.2.m1.1.1.1.cmml" xref="A1.T3.6.6.2.m1.1.1.1">↓</ci><cn id="A1.T3.6.6.2.m1.1.1.2.cmml" type="float" xref="A1.T3.6.6.2.m1.1.1.2">10.78</cn><apply id="A1.T3.6.6.2.m1.1.1.3.cmml" xref="A1.T3.6.6.2.m1.1.1.3"><csymbol cd="latexml" id="A1.T3.6.6.2.m1.1.1.3.1.cmml" xref="A1.T3.6.6.2.m1.1.1.3.1">percent</csymbol><cn id="A1.T3.6.6.2.m1.1.1.3.2.cmml" type="float" xref="A1.T3.6.6.2.m1.1.1.3.2">8.49</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.6.6.2.m1.1c">10.78\,\color[rgb]{0.1,0.5,0.1}\definecolor[named]{pgfstrokecolor}{rgb}{%
0.1,0.5,0.1}{\downarrow\,8.49\%}</annotation><annotation encoding="application/x-llamapun" id="A1.T3.6.6.2.m1.1d">10.78 ↓ 8.49 %</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="A1.T3.7.7.3"><math alttext="31.02+0.22\,\uparrow\,0.07\%" class="ltx_Math" display="inline" id="A1.T3.7.7.3.m1.1"><semantics id="A1.T3.7.7.3.m1.1a"><mrow id="A1.T3.7.7.3.m1.1.1" xref="A1.T3.7.7.3.m1.1.1.cmml"><mrow id="A1.T3.7.7.3.m1.1.1.2" xref="A1.T3.7.7.3.m1.1.1.2.cmml"><mn id="A1.T3.7.7.3.m1.1.1.2.2" xref="A1.T3.7.7.3.m1.1.1.2.2.cmml">31.02</mn><mo id="A1.T3.7.7.3.m1.1.1.2.1" xref="A1.T3.7.7.3.m1.1.1.2.1.cmml">+</mo><mn id="A1.T3.7.7.3.m1.1.1.2.3" xref="A1.T3.7.7.3.m1.1.1.2.3.cmml">0.22</mn></mrow><mo id="A1.T3.7.7.3.m1.1.1.1" lspace="0.448em" stretchy="false" xref="A1.T3.7.7.3.m1.1.1.1.cmml">↑</mo><mrow id="A1.T3.7.7.3.m1.1.1.3" xref="A1.T3.7.7.3.m1.1.1.3.cmml"><mn id="A1.T3.7.7.3.m1.1.1.3.2" xref="A1.T3.7.7.3.m1.1.1.3.2.cmml"> 0.07</mn><mo id="A1.T3.7.7.3.m1.1.1.3.1" xref="A1.T3.7.7.3.m1.1.1.3.1.cmml">%</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.T3.7.7.3.m1.1b"><apply id="A1.T3.7.7.3.m1.1.1.cmml" xref="A1.T3.7.7.3.m1.1.1"><ci id="A1.T3.7.7.3.m1.1.1.1.cmml" xref="A1.T3.7.7.3.m1.1.1.1">↑</ci><apply id="A1.T3.7.7.3.m1.1.1.2.cmml" xref="A1.T3.7.7.3.m1.1.1.2"><plus id="A1.T3.7.7.3.m1.1.1.2.1.cmml" xref="A1.T3.7.7.3.m1.1.1.2.1"></plus><cn id="A1.T3.7.7.3.m1.1.1.2.2.cmml" type="float" xref="A1.T3.7.7.3.m1.1.1.2.2">31.02</cn><cn id="A1.T3.7.7.3.m1.1.1.2.3.cmml" type="float" xref="A1.T3.7.7.3.m1.1.1.2.3">0.22</cn></apply><apply id="A1.T3.7.7.3.m1.1.1.3.cmml" xref="A1.T3.7.7.3.m1.1.1.3"><csymbol cd="latexml" id="A1.T3.7.7.3.m1.1.1.3.1.cmml" xref="A1.T3.7.7.3.m1.1.1.3.1">percent</csymbol><cn id="A1.T3.7.7.3.m1.1.1.3.2.cmml" type="float" xref="A1.T3.7.7.3.m1.1.1.3.2">0.07</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.7.7.3.m1.1c">31.02+0.22\,\uparrow\,0.07\%</annotation><annotation encoding="application/x-llamapun" id="A1.T3.7.7.3.m1.1d">31.02 + 0.22 ↑ 0.07 %</annotation></semantics></math></td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A1.T3.8.8.4"><math alttext="0.79+0.01\,\uparrow\,1.27\%" class="ltx_Math" display="inline" id="A1.T3.8.8.4.m1.1"><semantics id="A1.T3.8.8.4.m1.1a"><mrow id="A1.T3.8.8.4.m1.1.1" xref="A1.T3.8.8.4.m1.1.1.cmml"><mrow id="A1.T3.8.8.4.m1.1.1.2" xref="A1.T3.8.8.4.m1.1.1.2.cmml"><mn id="A1.T3.8.8.4.m1.1.1.2.2" xref="A1.T3.8.8.4.m1.1.1.2.2.cmml">0.79</mn><mo id="A1.T3.8.8.4.m1.1.1.2.1" xref="A1.T3.8.8.4.m1.1.1.2.1.cmml">+</mo><mn id="A1.T3.8.8.4.m1.1.1.2.3" xref="A1.T3.8.8.4.m1.1.1.2.3.cmml">0.01</mn></mrow><mo id="A1.T3.8.8.4.m1.1.1.1" lspace="0.448em" stretchy="false" xref="A1.T3.8.8.4.m1.1.1.1.cmml">↑</mo><mrow id="A1.T3.8.8.4.m1.1.1.3" xref="A1.T3.8.8.4.m1.1.1.3.cmml"><mn id="A1.T3.8.8.4.m1.1.1.3.2" xref="A1.T3.8.8.4.m1.1.1.3.2.cmml"> 1.27</mn><mo id="A1.T3.8.8.4.m1.1.1.3.1" xref="A1.T3.8.8.4.m1.1.1.3.1.cmml">%</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.T3.8.8.4.m1.1b"><apply id="A1.T3.8.8.4.m1.1.1.cmml" xref="A1.T3.8.8.4.m1.1.1"><ci id="A1.T3.8.8.4.m1.1.1.1.cmml" xref="A1.T3.8.8.4.m1.1.1.1">↑</ci><apply id="A1.T3.8.8.4.m1.1.1.2.cmml" xref="A1.T3.8.8.4.m1.1.1.2"><plus id="A1.T3.8.8.4.m1.1.1.2.1.cmml" xref="A1.T3.8.8.4.m1.1.1.2.1"></plus><cn id="A1.T3.8.8.4.m1.1.1.2.2.cmml" type="float" xref="A1.T3.8.8.4.m1.1.1.2.2">0.79</cn><cn id="A1.T3.8.8.4.m1.1.1.2.3.cmml" type="float" xref="A1.T3.8.8.4.m1.1.1.2.3">0.01</cn></apply><apply id="A1.T3.8.8.4.m1.1.1.3.cmml" xref="A1.T3.8.8.4.m1.1.1.3"><csymbol cd="latexml" id="A1.T3.8.8.4.m1.1.1.3.1.cmml" xref="A1.T3.8.8.4.m1.1.1.3.1">percent</csymbol><cn id="A1.T3.8.8.4.m1.1.1.3.2.cmml" type="float" xref="A1.T3.8.8.4.m1.1.1.3.2">1.27</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.8.8.4.m1.1c">0.79+0.01\,\uparrow\,1.27\%</annotation><annotation encoding="application/x-llamapun" id="A1.T3.8.8.4.m1.1d">0.79 + 0.01 ↑ 1.27 %</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A1.T3.12.12">
<td class="ltx_td ltx_align_left ltx_border_t" id="A1.T3.9.9.1">
<math alttext="335" class="ltx_Math" display="inline" id="A1.T3.9.9.1.m1.1"><semantics id="A1.T3.9.9.1.m1.1a"><mn id="A1.T3.9.9.1.m1.1.1" xref="A1.T3.9.9.1.m1.1.1.cmml">335</mn><annotation-xml encoding="MathML-Content" id="A1.T3.9.9.1.m1.1b"><cn id="A1.T3.9.9.1.m1.1.1.cmml" type="integer" xref="A1.T3.9.9.1.m1.1.1">335</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.9.9.1.m1.1c">335</annotation><annotation encoding="application/x-llamapun" id="A1.T3.9.9.1.m1.1d">335</annotation></semantics></math>M (dense)</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T3.10.10.2"><math alttext="11.25" class="ltx_Math" display="inline" id="A1.T3.10.10.2.m1.1"><semantics id="A1.T3.10.10.2.m1.1a"><mn id="A1.T3.10.10.2.m1.1.1" xref="A1.T3.10.10.2.m1.1.1.cmml">11.25</mn><annotation-xml encoding="MathML-Content" id="A1.T3.10.10.2.m1.1b"><cn id="A1.T3.10.10.2.m1.1.1.cmml" type="float" xref="A1.T3.10.10.2.m1.1.1">11.25</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.10.10.2.m1.1c">11.25</annotation><annotation encoding="application/x-llamapun" id="A1.T3.10.10.2.m1.1d">11.25</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T3.11.11.3"><math alttext="62.03" class="ltx_Math" display="inline" id="A1.T3.11.11.3.m1.1"><semantics id="A1.T3.11.11.3.m1.1a"><mn id="A1.T3.11.11.3.m1.1.1" xref="A1.T3.11.11.3.m1.1.1.cmml">62.03</mn><annotation-xml encoding="MathML-Content" id="A1.T3.11.11.3.m1.1b"><cn id="A1.T3.11.11.3.m1.1.1.cmml" type="float" xref="A1.T3.11.11.3.m1.1.1">62.03</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.11.11.3.m1.1c">62.03</annotation><annotation encoding="application/x-llamapun" id="A1.T3.11.11.3.m1.1d">62.03</annotation></semantics></math></td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" id="A1.T3.12.12.4"><math alttext="0.79" class="ltx_Math" display="inline" id="A1.T3.12.12.4.m1.1"><semantics id="A1.T3.12.12.4.m1.1a"><mn id="A1.T3.12.12.4.m1.1.1" xref="A1.T3.12.12.4.m1.1.1.cmml">0.79</mn><annotation-xml encoding="MathML-Content" id="A1.T3.12.12.4.m1.1b"><cn id="A1.T3.12.12.4.m1.1.1.cmml" type="float" xref="A1.T3.12.12.4.m1.1.1">0.79</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.12.12.4.m1.1c">0.79</annotation><annotation encoding="application/x-llamapun" id="A1.T3.12.12.4.m1.1d">0.79</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A1.T3.16.16">
<td class="ltx_td ltx_align_left" id="A1.T3.13.13.1">335M (<math alttext="8" class="ltx_Math" display="inline" id="A1.T3.13.13.1.m1.1"><semantics id="A1.T3.13.13.1.m1.1a"><mn id="A1.T3.13.13.1.m1.1.1" xref="A1.T3.13.13.1.m1.1.1.cmml">8</mn><annotation-xml encoding="MathML-Content" id="A1.T3.13.13.1.m1.1b"><cn id="A1.T3.13.13.1.m1.1.1.cmml" type="integer" xref="A1.T3.13.13.1.m1.1.1">8</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.13.13.1.m1.1c">8</annotation><annotation encoding="application/x-llamapun" id="A1.T3.13.13.1.m1.1d">8</annotation></semantics></math> experts)</td>
<td class="ltx_td ltx_align_center" id="A1.T3.14.14.2"><math alttext="10.20\,\color[rgb]{0.1,0.5,0.1}\definecolor[named]{pgfstrokecolor}{rgb}{%
0.1,0.5,0.1}{\downarrow\,9.33\%}" class="ltx_Math" display="inline" id="A1.T3.14.14.2.m1.1"><semantics id="A1.T3.14.14.2.m1.1a"><mrow id="A1.T3.14.14.2.m1.1.1" xref="A1.T3.14.14.2.m1.1.1.cmml"><mn id="A1.T3.14.14.2.m1.1.1.2" mathcolor="#000000" xref="A1.T3.14.14.2.m1.1.1.2.cmml">10.20</mn><mo id="A1.T3.14.14.2.m1.1.1.1" lspace="0.448em" mathcolor="#1A801A" stretchy="false" xref="A1.T3.14.14.2.m1.1.1.1.cmml">↓</mo><mrow id="A1.T3.14.14.2.m1.1.1.3" xref="A1.T3.14.14.2.m1.1.1.3.cmml"><mn id="A1.T3.14.14.2.m1.1.1.3.2" mathcolor="#1A801A" xref="A1.T3.14.14.2.m1.1.1.3.2.cmml"> 9.33</mn><mo id="A1.T3.14.14.2.m1.1.1.3.1" mathcolor="#1A801A" xref="A1.T3.14.14.2.m1.1.1.3.1.cmml">%</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.T3.14.14.2.m1.1b"><apply id="A1.T3.14.14.2.m1.1.1.cmml" xref="A1.T3.14.14.2.m1.1.1"><ci id="A1.T3.14.14.2.m1.1.1.1.cmml" xref="A1.T3.14.14.2.m1.1.1.1">↓</ci><cn id="A1.T3.14.14.2.m1.1.1.2.cmml" type="float" xref="A1.T3.14.14.2.m1.1.1.2">10.20</cn><apply id="A1.T3.14.14.2.m1.1.1.3.cmml" xref="A1.T3.14.14.2.m1.1.1.3"><csymbol cd="latexml" id="A1.T3.14.14.2.m1.1.1.3.1.cmml" xref="A1.T3.14.14.2.m1.1.1.3.1">percent</csymbol><cn id="A1.T3.14.14.2.m1.1.1.3.2.cmml" type="float" xref="A1.T3.14.14.2.m1.1.1.3.2">9.33</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.14.14.2.m1.1c">10.20\,\color[rgb]{0.1,0.5,0.1}\definecolor[named]{pgfstrokecolor}{rgb}{%
0.1,0.5,0.1}{\downarrow\,9.33\%}</annotation><annotation encoding="application/x-llamapun" id="A1.T3.14.14.2.m1.1d">10.20 ↓ 9.33 %</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="A1.T3.15.15.3"><math alttext="62.03+0.75\,\uparrow\,1.20\%" class="ltx_Math" display="inline" id="A1.T3.15.15.3.m1.1"><semantics id="A1.T3.15.15.3.m1.1a"><mrow id="A1.T3.15.15.3.m1.1.1" xref="A1.T3.15.15.3.m1.1.1.cmml"><mrow id="A1.T3.15.15.3.m1.1.1.2" xref="A1.T3.15.15.3.m1.1.1.2.cmml"><mn id="A1.T3.15.15.3.m1.1.1.2.2" xref="A1.T3.15.15.3.m1.1.1.2.2.cmml">62.03</mn><mo id="A1.T3.15.15.3.m1.1.1.2.1" xref="A1.T3.15.15.3.m1.1.1.2.1.cmml">+</mo><mn id="A1.T3.15.15.3.m1.1.1.2.3" xref="A1.T3.15.15.3.m1.1.1.2.3.cmml">0.75</mn></mrow><mo id="A1.T3.15.15.3.m1.1.1.1" lspace="0.448em" stretchy="false" xref="A1.T3.15.15.3.m1.1.1.1.cmml">↑</mo><mrow id="A1.T3.15.15.3.m1.1.1.3" xref="A1.T3.15.15.3.m1.1.1.3.cmml"><mn id="A1.T3.15.15.3.m1.1.1.3.2" xref="A1.T3.15.15.3.m1.1.1.3.2.cmml"> 1.20</mn><mo id="A1.T3.15.15.3.m1.1.1.3.1" xref="A1.T3.15.15.3.m1.1.1.3.1.cmml">%</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.T3.15.15.3.m1.1b"><apply id="A1.T3.15.15.3.m1.1.1.cmml" xref="A1.T3.15.15.3.m1.1.1"><ci id="A1.T3.15.15.3.m1.1.1.1.cmml" xref="A1.T3.15.15.3.m1.1.1.1">↑</ci><apply id="A1.T3.15.15.3.m1.1.1.2.cmml" xref="A1.T3.15.15.3.m1.1.1.2"><plus id="A1.T3.15.15.3.m1.1.1.2.1.cmml" xref="A1.T3.15.15.3.m1.1.1.2.1"></plus><cn id="A1.T3.15.15.3.m1.1.1.2.2.cmml" type="float" xref="A1.T3.15.15.3.m1.1.1.2.2">62.03</cn><cn id="A1.T3.15.15.3.m1.1.1.2.3.cmml" type="float" xref="A1.T3.15.15.3.m1.1.1.2.3">0.75</cn></apply><apply id="A1.T3.15.15.3.m1.1.1.3.cmml" xref="A1.T3.15.15.3.m1.1.1.3"><csymbol cd="latexml" id="A1.T3.15.15.3.m1.1.1.3.1.cmml" xref="A1.T3.15.15.3.m1.1.1.3.1">percent</csymbol><cn id="A1.T3.15.15.3.m1.1.1.3.2.cmml" type="float" xref="A1.T3.15.15.3.m1.1.1.3.2">1.20</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.15.15.3.m1.1c">62.03+0.75\,\uparrow\,1.20\%</annotation><annotation encoding="application/x-llamapun" id="A1.T3.15.15.3.m1.1d">62.03 + 0.75 ↑ 1.20 %</annotation></semantics></math></td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A1.T3.16.16.4"><math alttext="0.79+0.02\,\uparrow\,2.53\%" class="ltx_Math" display="inline" id="A1.T3.16.16.4.m1.1"><semantics id="A1.T3.16.16.4.m1.1a"><mrow id="A1.T3.16.16.4.m1.1.1" xref="A1.T3.16.16.4.m1.1.1.cmml"><mrow id="A1.T3.16.16.4.m1.1.1.2" xref="A1.T3.16.16.4.m1.1.1.2.cmml"><mn id="A1.T3.16.16.4.m1.1.1.2.2" xref="A1.T3.16.16.4.m1.1.1.2.2.cmml">0.79</mn><mo id="A1.T3.16.16.4.m1.1.1.2.1" xref="A1.T3.16.16.4.m1.1.1.2.1.cmml">+</mo><mn id="A1.T3.16.16.4.m1.1.1.2.3" xref="A1.T3.16.16.4.m1.1.1.2.3.cmml">0.02</mn></mrow><mo id="A1.T3.16.16.4.m1.1.1.1" lspace="0.448em" stretchy="false" xref="A1.T3.16.16.4.m1.1.1.1.cmml">↑</mo><mrow id="A1.T3.16.16.4.m1.1.1.3" xref="A1.T3.16.16.4.m1.1.1.3.cmml"><mn id="A1.T3.16.16.4.m1.1.1.3.2" xref="A1.T3.16.16.4.m1.1.1.3.2.cmml"> 2.53</mn><mo id="A1.T3.16.16.4.m1.1.1.3.1" xref="A1.T3.16.16.4.m1.1.1.3.1.cmml">%</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.T3.16.16.4.m1.1b"><apply id="A1.T3.16.16.4.m1.1.1.cmml" xref="A1.T3.16.16.4.m1.1.1"><ci id="A1.T3.16.16.4.m1.1.1.1.cmml" xref="A1.T3.16.16.4.m1.1.1.1">↑</ci><apply id="A1.T3.16.16.4.m1.1.1.2.cmml" xref="A1.T3.16.16.4.m1.1.1.2"><plus id="A1.T3.16.16.4.m1.1.1.2.1.cmml" xref="A1.T3.16.16.4.m1.1.1.2.1"></plus><cn id="A1.T3.16.16.4.m1.1.1.2.2.cmml" type="float" xref="A1.T3.16.16.4.m1.1.1.2.2">0.79</cn><cn id="A1.T3.16.16.4.m1.1.1.2.3.cmml" type="float" xref="A1.T3.16.16.4.m1.1.1.2.3">0.02</cn></apply><apply id="A1.T3.16.16.4.m1.1.1.3.cmml" xref="A1.T3.16.16.4.m1.1.1.3"><csymbol cd="latexml" id="A1.T3.16.16.4.m1.1.1.3.1.cmml" xref="A1.T3.16.16.4.m1.1.1.3.1">percent</csymbol><cn id="A1.T3.16.16.4.m1.1.1.3.2.cmml" type="float" xref="A1.T3.16.16.4.m1.1.1.3.2">2.53</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.16.16.4.m1.1c">0.79+0.02\,\uparrow\,2.53\%</annotation><annotation encoding="application/x-llamapun" id="A1.T3.16.16.4.m1.1d">0.79 + 0.02 ↑ 2.53 %</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A1.T3.20.20">
<td class="ltx_td ltx_align_left ltx_border_t" id="A1.T3.17.17.1">
<math alttext="335" class="ltx_Math" display="inline" id="A1.T3.17.17.1.m1.1"><semantics id="A1.T3.17.17.1.m1.1a"><mn id="A1.T3.17.17.1.m1.1.1" xref="A1.T3.17.17.1.m1.1.1.cmml">335</mn><annotation-xml encoding="MathML-Content" id="A1.T3.17.17.1.m1.1b"><cn id="A1.T3.17.17.1.m1.1.1.cmml" type="integer" xref="A1.T3.17.17.1.m1.1.1">335</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.17.17.1.m1.1c">335</annotation><annotation encoding="application/x-llamapun" id="A1.T3.17.17.1.m1.1d">335</annotation></semantics></math>M (dense)</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T3.18.18.2"><math alttext="10.80" class="ltx_Math" display="inline" id="A1.T3.18.18.2.m1.1"><semantics id="A1.T3.18.18.2.m1.1a"><mn id="A1.T3.18.18.2.m1.1.1" xref="A1.T3.18.18.2.m1.1.1.cmml">10.80</mn><annotation-xml encoding="MathML-Content" id="A1.T3.18.18.2.m1.1b"><cn id="A1.T3.18.18.2.m1.1.1.cmml" type="float" xref="A1.T3.18.18.2.m1.1.1">10.80</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.18.18.2.m1.1c">10.80</annotation><annotation encoding="application/x-llamapun" id="A1.T3.18.18.2.m1.1d">10.80</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T3.19.19.3"><math alttext="124.06" class="ltx_Math" display="inline" id="A1.T3.19.19.3.m1.1"><semantics id="A1.T3.19.19.3.m1.1a"><mn id="A1.T3.19.19.3.m1.1.1" xref="A1.T3.19.19.3.m1.1.1.cmml">124.06</mn><annotation-xml encoding="MathML-Content" id="A1.T3.19.19.3.m1.1b"><cn id="A1.T3.19.19.3.m1.1.1.cmml" type="float" xref="A1.T3.19.19.3.m1.1.1">124.06</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.19.19.3.m1.1c">124.06</annotation><annotation encoding="application/x-llamapun" id="A1.T3.19.19.3.m1.1d">124.06</annotation></semantics></math></td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" id="A1.T3.20.20.4"><math alttext="0.79" class="ltx_Math" display="inline" id="A1.T3.20.20.4.m1.1"><semantics id="A1.T3.20.20.4.m1.1a"><mn id="A1.T3.20.20.4.m1.1.1" xref="A1.T3.20.20.4.m1.1.1.cmml">0.79</mn><annotation-xml encoding="MathML-Content" id="A1.T3.20.20.4.m1.1b"><cn id="A1.T3.20.20.4.m1.1.1.cmml" type="float" xref="A1.T3.20.20.4.m1.1.1">0.79</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.20.20.4.m1.1c">0.79</annotation><annotation encoding="application/x-llamapun" id="A1.T3.20.20.4.m1.1d">0.79</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A1.T3.25.25">
<td class="ltx_td ltx_align_left" id="A1.T3.22.22.2">
<math alttext="335" class="ltx_Math" display="inline" id="A1.T3.21.21.1.m1.1"><semantics id="A1.T3.21.21.1.m1.1a"><mn id="A1.T3.21.21.1.m1.1.1" xref="A1.T3.21.21.1.m1.1.1.cmml">335</mn><annotation-xml encoding="MathML-Content" id="A1.T3.21.21.1.m1.1b"><cn id="A1.T3.21.21.1.m1.1.1.cmml" type="integer" xref="A1.T3.21.21.1.m1.1.1">335</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.21.21.1.m1.1c">335</annotation><annotation encoding="application/x-llamapun" id="A1.T3.21.21.1.m1.1d">335</annotation></semantics></math>M (<math alttext="16" class="ltx_Math" display="inline" id="A1.T3.22.22.2.m2.1"><semantics id="A1.T3.22.22.2.m2.1a"><mn id="A1.T3.22.22.2.m2.1.1" xref="A1.T3.22.22.2.m2.1.1.cmml">16</mn><annotation-xml encoding="MathML-Content" id="A1.T3.22.22.2.m2.1b"><cn id="A1.T3.22.22.2.m2.1.1.cmml" type="integer" xref="A1.T3.22.22.2.m2.1.1">16</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.22.22.2.m2.1c">16</annotation><annotation encoding="application/x-llamapun" id="A1.T3.22.22.2.m2.1d">16</annotation></semantics></math> experts)</td>
<td class="ltx_td ltx_align_center" id="A1.T3.23.23.3"><math alttext="9.64\,\color[rgb]{0.1,0.5,0.1}\definecolor[named]{pgfstrokecolor}{rgb}{%
0.1,0.5,0.1}{\downarrow\,10.74\%}" class="ltx_Math" display="inline" id="A1.T3.23.23.3.m1.1"><semantics id="A1.T3.23.23.3.m1.1a"><mrow id="A1.T3.23.23.3.m1.1.1" xref="A1.T3.23.23.3.m1.1.1.cmml"><mn id="A1.T3.23.23.3.m1.1.1.2" mathcolor="#000000" xref="A1.T3.23.23.3.m1.1.1.2.cmml">9.64</mn><mo id="A1.T3.23.23.3.m1.1.1.1" lspace="0.448em" mathcolor="#1A801A" stretchy="false" xref="A1.T3.23.23.3.m1.1.1.1.cmml">↓</mo><mrow id="A1.T3.23.23.3.m1.1.1.3" xref="A1.T3.23.23.3.m1.1.1.3.cmml"><mn id="A1.T3.23.23.3.m1.1.1.3.2" mathcolor="#1A801A" xref="A1.T3.23.23.3.m1.1.1.3.2.cmml"> 10.74</mn><mo id="A1.T3.23.23.3.m1.1.1.3.1" mathcolor="#1A801A" xref="A1.T3.23.23.3.m1.1.1.3.1.cmml">%</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.T3.23.23.3.m1.1b"><apply id="A1.T3.23.23.3.m1.1.1.cmml" xref="A1.T3.23.23.3.m1.1.1"><ci id="A1.T3.23.23.3.m1.1.1.1.cmml" xref="A1.T3.23.23.3.m1.1.1.1">↓</ci><cn id="A1.T3.23.23.3.m1.1.1.2.cmml" type="float" xref="A1.T3.23.23.3.m1.1.1.2">9.64</cn><apply id="A1.T3.23.23.3.m1.1.1.3.cmml" xref="A1.T3.23.23.3.m1.1.1.3"><csymbol cd="latexml" id="A1.T3.23.23.3.m1.1.1.3.1.cmml" xref="A1.T3.23.23.3.m1.1.1.3.1">percent</csymbol><cn id="A1.T3.23.23.3.m1.1.1.3.2.cmml" type="float" xref="A1.T3.23.23.3.m1.1.1.3.2">10.74</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.23.23.3.m1.1c">9.64\,\color[rgb]{0.1,0.5,0.1}\definecolor[named]{pgfstrokecolor}{rgb}{%
0.1,0.5,0.1}{\downarrow\,10.74\%}</annotation><annotation encoding="application/x-llamapun" id="A1.T3.23.23.3.m1.1d">9.64 ↓ 10.74 %</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="A1.T3.24.24.4"><math alttext="124.06+2.71\,\uparrow\,2.19\%" class="ltx_Math" display="inline" id="A1.T3.24.24.4.m1.1"><semantics id="A1.T3.24.24.4.m1.1a"><mrow id="A1.T3.24.24.4.m1.1.1" xref="A1.T3.24.24.4.m1.1.1.cmml"><mrow id="A1.T3.24.24.4.m1.1.1.2" xref="A1.T3.24.24.4.m1.1.1.2.cmml"><mn id="A1.T3.24.24.4.m1.1.1.2.2" xref="A1.T3.24.24.4.m1.1.1.2.2.cmml">124.06</mn><mo id="A1.T3.24.24.4.m1.1.1.2.1" xref="A1.T3.24.24.4.m1.1.1.2.1.cmml">+</mo><mn id="A1.T3.24.24.4.m1.1.1.2.3" xref="A1.T3.24.24.4.m1.1.1.2.3.cmml">2.71</mn></mrow><mo id="A1.T3.24.24.4.m1.1.1.1" lspace="0.448em" stretchy="false" xref="A1.T3.24.24.4.m1.1.1.1.cmml">↑</mo><mrow id="A1.T3.24.24.4.m1.1.1.3" xref="A1.T3.24.24.4.m1.1.1.3.cmml"><mn id="A1.T3.24.24.4.m1.1.1.3.2" xref="A1.T3.24.24.4.m1.1.1.3.2.cmml"> 2.19</mn><mo id="A1.T3.24.24.4.m1.1.1.3.1" xref="A1.T3.24.24.4.m1.1.1.3.1.cmml">%</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.T3.24.24.4.m1.1b"><apply id="A1.T3.24.24.4.m1.1.1.cmml" xref="A1.T3.24.24.4.m1.1.1"><ci id="A1.T3.24.24.4.m1.1.1.1.cmml" xref="A1.T3.24.24.4.m1.1.1.1">↑</ci><apply id="A1.T3.24.24.4.m1.1.1.2.cmml" xref="A1.T3.24.24.4.m1.1.1.2"><plus id="A1.T3.24.24.4.m1.1.1.2.1.cmml" xref="A1.T3.24.24.4.m1.1.1.2.1"></plus><cn id="A1.T3.24.24.4.m1.1.1.2.2.cmml" type="float" xref="A1.T3.24.24.4.m1.1.1.2.2">124.06</cn><cn id="A1.T3.24.24.4.m1.1.1.2.3.cmml" type="float" xref="A1.T3.24.24.4.m1.1.1.2.3">2.71</cn></apply><apply id="A1.T3.24.24.4.m1.1.1.3.cmml" xref="A1.T3.24.24.4.m1.1.1.3"><csymbol cd="latexml" id="A1.T3.24.24.4.m1.1.1.3.1.cmml" xref="A1.T3.24.24.4.m1.1.1.3.1">percent</csymbol><cn id="A1.T3.24.24.4.m1.1.1.3.2.cmml" type="float" xref="A1.T3.24.24.4.m1.1.1.3.2">2.19</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.24.24.4.m1.1c">124.06+2.71\,\uparrow\,2.19\%</annotation><annotation encoding="application/x-llamapun" id="A1.T3.24.24.4.m1.1d">124.06 + 2.71 ↑ 2.19 %</annotation></semantics></math></td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A1.T3.25.25.5"><math alttext="0.79+0.04\,\uparrow\,5.06\%" class="ltx_Math" display="inline" id="A1.T3.25.25.5.m1.1"><semantics id="A1.T3.25.25.5.m1.1a"><mrow id="A1.T3.25.25.5.m1.1.1" xref="A1.T3.25.25.5.m1.1.1.cmml"><mrow id="A1.T3.25.25.5.m1.1.1.2" xref="A1.T3.25.25.5.m1.1.1.2.cmml"><mn id="A1.T3.25.25.5.m1.1.1.2.2" xref="A1.T3.25.25.5.m1.1.1.2.2.cmml">0.79</mn><mo id="A1.T3.25.25.5.m1.1.1.2.1" xref="A1.T3.25.25.5.m1.1.1.2.1.cmml">+</mo><mn id="A1.T3.25.25.5.m1.1.1.2.3" xref="A1.T3.25.25.5.m1.1.1.2.3.cmml">0.04</mn></mrow><mo id="A1.T3.25.25.5.m1.1.1.1" lspace="0.448em" stretchy="false" xref="A1.T3.25.25.5.m1.1.1.1.cmml">↑</mo><mrow id="A1.T3.25.25.5.m1.1.1.3" xref="A1.T3.25.25.5.m1.1.1.3.cmml"><mn id="A1.T3.25.25.5.m1.1.1.3.2" xref="A1.T3.25.25.5.m1.1.1.3.2.cmml"> 5.06</mn><mo id="A1.T3.25.25.5.m1.1.1.3.1" xref="A1.T3.25.25.5.m1.1.1.3.1.cmml">%</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.T3.25.25.5.m1.1b"><apply id="A1.T3.25.25.5.m1.1.1.cmml" xref="A1.T3.25.25.5.m1.1.1"><ci id="A1.T3.25.25.5.m1.1.1.1.cmml" xref="A1.T3.25.25.5.m1.1.1.1">↑</ci><apply id="A1.T3.25.25.5.m1.1.1.2.cmml" xref="A1.T3.25.25.5.m1.1.1.2"><plus id="A1.T3.25.25.5.m1.1.1.2.1.cmml" xref="A1.T3.25.25.5.m1.1.1.2.1"></plus><cn id="A1.T3.25.25.5.m1.1.1.2.2.cmml" type="float" xref="A1.T3.25.25.5.m1.1.1.2.2">0.79</cn><cn id="A1.T3.25.25.5.m1.1.1.2.3.cmml" type="float" xref="A1.T3.25.25.5.m1.1.1.2.3">0.04</cn></apply><apply id="A1.T3.25.25.5.m1.1.1.3.cmml" xref="A1.T3.25.25.5.m1.1.1.3"><csymbol cd="latexml" id="A1.T3.25.25.5.m1.1.1.3.1.cmml" xref="A1.T3.25.25.5.m1.1.1.3.1">percent</csymbol><cn id="A1.T3.25.25.5.m1.1.1.3.2.cmml" type="float" xref="A1.T3.25.25.5.m1.1.1.3.2">5.06</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.25.25.5.m1.1c">0.79+0.04\,\uparrow\,5.06\%</annotation><annotation encoding="application/x-llamapun" id="A1.T3.25.25.5.m1.1d">0.79 + 0.04 ↑ 5.06 %</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A1.T3.29.29">
<td class="ltx_td ltx_align_left ltx_border_t" id="A1.T3.26.26.1">
<math alttext="335" class="ltx_Math" display="inline" id="A1.T3.26.26.1.m1.1"><semantics id="A1.T3.26.26.1.m1.1a"><mn id="A1.T3.26.26.1.m1.1.1" xref="A1.T3.26.26.1.m1.1.1.cmml">335</mn><annotation-xml encoding="MathML-Content" id="A1.T3.26.26.1.m1.1b"><cn id="A1.T3.26.26.1.m1.1.1.cmml" type="integer" xref="A1.T3.26.26.1.m1.1.1">335</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.26.26.1.m1.1c">335</annotation><annotation encoding="application/x-llamapun" id="A1.T3.26.26.1.m1.1d">335</annotation></semantics></math>M (dense)</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T3.27.27.2"><math alttext="10.5" class="ltx_Math" display="inline" id="A1.T3.27.27.2.m1.1"><semantics id="A1.T3.27.27.2.m1.1a"><mn id="A1.T3.27.27.2.m1.1.1" xref="A1.T3.27.27.2.m1.1.1.cmml">10.5</mn><annotation-xml encoding="MathML-Content" id="A1.T3.27.27.2.m1.1b"><cn id="A1.T3.27.27.2.m1.1.1.cmml" type="float" xref="A1.T3.27.27.2.m1.1.1">10.5</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.27.27.2.m1.1c">10.5</annotation><annotation encoding="application/x-llamapun" id="A1.T3.27.27.2.m1.1d">10.5</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T3.28.28.3"><math alttext="248.12" class="ltx_Math" display="inline" id="A1.T3.28.28.3.m1.1"><semantics id="A1.T3.28.28.3.m1.1a"><mn id="A1.T3.28.28.3.m1.1.1" xref="A1.T3.28.28.3.m1.1.1.cmml">248.12</mn><annotation-xml encoding="MathML-Content" id="A1.T3.28.28.3.m1.1b"><cn id="A1.T3.28.28.3.m1.1.1.cmml" type="float" xref="A1.T3.28.28.3.m1.1.1">248.12</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.28.28.3.m1.1c">248.12</annotation><annotation encoding="application/x-llamapun" id="A1.T3.28.28.3.m1.1d">248.12</annotation></semantics></math></td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" id="A1.T3.29.29.4"><math alttext="0.79" class="ltx_Math" display="inline" id="A1.T3.29.29.4.m1.1"><semantics id="A1.T3.29.29.4.m1.1a"><mn id="A1.T3.29.29.4.m1.1.1" xref="A1.T3.29.29.4.m1.1.1.cmml">0.79</mn><annotation-xml encoding="MathML-Content" id="A1.T3.29.29.4.m1.1b"><cn id="A1.T3.29.29.4.m1.1.1.cmml" type="float" xref="A1.T3.29.29.4.m1.1.1">0.79</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.29.29.4.m1.1c">0.79</annotation><annotation encoding="application/x-llamapun" id="A1.T3.29.29.4.m1.1d">0.79</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A1.T3.34.34">
<td class="ltx_td ltx_align_left" id="A1.T3.31.31.2">
<math alttext="335" class="ltx_Math" display="inline" id="A1.T3.30.30.1.m1.1"><semantics id="A1.T3.30.30.1.m1.1a"><mn id="A1.T3.30.30.1.m1.1.1" xref="A1.T3.30.30.1.m1.1.1.cmml">335</mn><annotation-xml encoding="MathML-Content" id="A1.T3.30.30.1.m1.1b"><cn id="A1.T3.30.30.1.m1.1.1.cmml" type="integer" xref="A1.T3.30.30.1.m1.1.1">335</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.30.30.1.m1.1c">335</annotation><annotation encoding="application/x-llamapun" id="A1.T3.30.30.1.m1.1d">335</annotation></semantics></math>M (<math alttext="32" class="ltx_Math" display="inline" id="A1.T3.31.31.2.m2.1"><semantics id="A1.T3.31.31.2.m2.1a"><mn id="A1.T3.31.31.2.m2.1.1" xref="A1.T3.31.31.2.m2.1.1.cmml">32</mn><annotation-xml encoding="MathML-Content" id="A1.T3.31.31.2.m2.1b"><cn id="A1.T3.31.31.2.m2.1.1.cmml" type="integer" xref="A1.T3.31.31.2.m2.1.1">32</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.31.31.2.m2.1c">32</annotation><annotation encoding="application/x-llamapun" id="A1.T3.31.31.2.m2.1d">32</annotation></semantics></math> experts)</td>
<td class="ltx_td ltx_align_center" id="A1.T3.32.32.3"><math alttext="9.07\,\color[rgb]{0.1,0.5,0.1}\definecolor[named]{pgfstrokecolor}{rgb}{%
0.1,0.5,0.1}{\downarrow\,13.62\%}" class="ltx_Math" display="inline" id="A1.T3.32.32.3.m1.1"><semantics id="A1.T3.32.32.3.m1.1a"><mrow id="A1.T3.32.32.3.m1.1.1" xref="A1.T3.32.32.3.m1.1.1.cmml"><mn id="A1.T3.32.32.3.m1.1.1.2" mathcolor="#000000" xref="A1.T3.32.32.3.m1.1.1.2.cmml">9.07</mn><mo id="A1.T3.32.32.3.m1.1.1.1" lspace="0.448em" mathcolor="#1A801A" stretchy="false" xref="A1.T3.32.32.3.m1.1.1.1.cmml">↓</mo><mrow id="A1.T3.32.32.3.m1.1.1.3" xref="A1.T3.32.32.3.m1.1.1.3.cmml"><mn id="A1.T3.32.32.3.m1.1.1.3.2" mathcolor="#1A801A" xref="A1.T3.32.32.3.m1.1.1.3.2.cmml"> 13.62</mn><mo id="A1.T3.32.32.3.m1.1.1.3.1" mathcolor="#1A801A" xref="A1.T3.32.32.3.m1.1.1.3.1.cmml">%</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.T3.32.32.3.m1.1b"><apply id="A1.T3.32.32.3.m1.1.1.cmml" xref="A1.T3.32.32.3.m1.1.1"><ci id="A1.T3.32.32.3.m1.1.1.1.cmml" xref="A1.T3.32.32.3.m1.1.1.1">↓</ci><cn id="A1.T3.32.32.3.m1.1.1.2.cmml" type="float" xref="A1.T3.32.32.3.m1.1.1.2">9.07</cn><apply id="A1.T3.32.32.3.m1.1.1.3.cmml" xref="A1.T3.32.32.3.m1.1.1.3"><csymbol cd="latexml" id="A1.T3.32.32.3.m1.1.1.3.1.cmml" xref="A1.T3.32.32.3.m1.1.1.3.1">percent</csymbol><cn id="A1.T3.32.32.3.m1.1.1.3.2.cmml" type="float" xref="A1.T3.32.32.3.m1.1.1.3.2">13.62</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.32.32.3.m1.1c">9.07\,\color[rgb]{0.1,0.5,0.1}\definecolor[named]{pgfstrokecolor}{rgb}{%
0.1,0.5,0.1}{\downarrow\,13.62\%}</annotation><annotation encoding="application/x-llamapun" id="A1.T3.32.32.3.m1.1d">9.07 ↓ 13.62 %</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="A1.T3.33.33.4"><math alttext="248.12+10.28\,\uparrow\,4.14\%" class="ltx_Math" display="inline" id="A1.T3.33.33.4.m1.1"><semantics id="A1.T3.33.33.4.m1.1a"><mrow id="A1.T3.33.33.4.m1.1.1" xref="A1.T3.33.33.4.m1.1.1.cmml"><mrow id="A1.T3.33.33.4.m1.1.1.2" xref="A1.T3.33.33.4.m1.1.1.2.cmml"><mn id="A1.T3.33.33.4.m1.1.1.2.2" xref="A1.T3.33.33.4.m1.1.1.2.2.cmml">248.12</mn><mo id="A1.T3.33.33.4.m1.1.1.2.1" xref="A1.T3.33.33.4.m1.1.1.2.1.cmml">+</mo><mn id="A1.T3.33.33.4.m1.1.1.2.3" xref="A1.T3.33.33.4.m1.1.1.2.3.cmml">10.28</mn></mrow><mo id="A1.T3.33.33.4.m1.1.1.1" lspace="0.448em" stretchy="false" xref="A1.T3.33.33.4.m1.1.1.1.cmml">↑</mo><mrow id="A1.T3.33.33.4.m1.1.1.3" xref="A1.T3.33.33.4.m1.1.1.3.cmml"><mn id="A1.T3.33.33.4.m1.1.1.3.2" xref="A1.T3.33.33.4.m1.1.1.3.2.cmml"> 4.14</mn><mo id="A1.T3.33.33.4.m1.1.1.3.1" xref="A1.T3.33.33.4.m1.1.1.3.1.cmml">%</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.T3.33.33.4.m1.1b"><apply id="A1.T3.33.33.4.m1.1.1.cmml" xref="A1.T3.33.33.4.m1.1.1"><ci id="A1.T3.33.33.4.m1.1.1.1.cmml" xref="A1.T3.33.33.4.m1.1.1.1">↑</ci><apply id="A1.T3.33.33.4.m1.1.1.2.cmml" xref="A1.T3.33.33.4.m1.1.1.2"><plus id="A1.T3.33.33.4.m1.1.1.2.1.cmml" xref="A1.T3.33.33.4.m1.1.1.2.1"></plus><cn id="A1.T3.33.33.4.m1.1.1.2.2.cmml" type="float" xref="A1.T3.33.33.4.m1.1.1.2.2">248.12</cn><cn id="A1.T3.33.33.4.m1.1.1.2.3.cmml" type="float" xref="A1.T3.33.33.4.m1.1.1.2.3">10.28</cn></apply><apply id="A1.T3.33.33.4.m1.1.1.3.cmml" xref="A1.T3.33.33.4.m1.1.1.3"><csymbol cd="latexml" id="A1.T3.33.33.4.m1.1.1.3.1.cmml" xref="A1.T3.33.33.4.m1.1.1.3.1">percent</csymbol><cn id="A1.T3.33.33.4.m1.1.1.3.2.cmml" type="float" xref="A1.T3.33.33.4.m1.1.1.3.2">4.14</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.33.33.4.m1.1c">248.12+10.28\,\uparrow\,4.14\%</annotation><annotation encoding="application/x-llamapun" id="A1.T3.33.33.4.m1.1d">248.12 + 10.28 ↑ 4.14 %</annotation></semantics></math></td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A1.T3.34.34.5"><math alttext="0.79+0.08\,\uparrow\,10.13\%" class="ltx_Math" display="inline" id="A1.T3.34.34.5.m1.1"><semantics id="A1.T3.34.34.5.m1.1a"><mrow id="A1.T3.34.34.5.m1.1.1" xref="A1.T3.34.34.5.m1.1.1.cmml"><mrow id="A1.T3.34.34.5.m1.1.1.2" xref="A1.T3.34.34.5.m1.1.1.2.cmml"><mn id="A1.T3.34.34.5.m1.1.1.2.2" xref="A1.T3.34.34.5.m1.1.1.2.2.cmml">0.79</mn><mo id="A1.T3.34.34.5.m1.1.1.2.1" xref="A1.T3.34.34.5.m1.1.1.2.1.cmml">+</mo><mn id="A1.T3.34.34.5.m1.1.1.2.3" xref="A1.T3.34.34.5.m1.1.1.2.3.cmml">0.08</mn></mrow><mo id="A1.T3.34.34.5.m1.1.1.1" lspace="0.448em" stretchy="false" xref="A1.T3.34.34.5.m1.1.1.1.cmml">↑</mo><mrow id="A1.T3.34.34.5.m1.1.1.3" xref="A1.T3.34.34.5.m1.1.1.3.cmml"><mn id="A1.T3.34.34.5.m1.1.1.3.2" xref="A1.T3.34.34.5.m1.1.1.3.2.cmml"> 10.13</mn><mo id="A1.T3.34.34.5.m1.1.1.3.1" xref="A1.T3.34.34.5.m1.1.1.3.1.cmml">%</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.T3.34.34.5.m1.1b"><apply id="A1.T3.34.34.5.m1.1.1.cmml" xref="A1.T3.34.34.5.m1.1.1"><ci id="A1.T3.34.34.5.m1.1.1.1.cmml" xref="A1.T3.34.34.5.m1.1.1.1">↑</ci><apply id="A1.T3.34.34.5.m1.1.1.2.cmml" xref="A1.T3.34.34.5.m1.1.1.2"><plus id="A1.T3.34.34.5.m1.1.1.2.1.cmml" xref="A1.T3.34.34.5.m1.1.1.2.1"></plus><cn id="A1.T3.34.34.5.m1.1.1.2.2.cmml" type="float" xref="A1.T3.34.34.5.m1.1.1.2.2">0.79</cn><cn id="A1.T3.34.34.5.m1.1.1.2.3.cmml" type="float" xref="A1.T3.34.34.5.m1.1.1.2.3">0.08</cn></apply><apply id="A1.T3.34.34.5.m1.1.1.3.cmml" xref="A1.T3.34.34.5.m1.1.1.3"><csymbol cd="latexml" id="A1.T3.34.34.5.m1.1.1.3.1.cmml" xref="A1.T3.34.34.5.m1.1.1.3.1">percent</csymbol><cn id="A1.T3.34.34.5.m1.1.1.3.2.cmml" type="float" xref="A1.T3.34.34.5.m1.1.1.3.2">10.13</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.34.34.5.m1.1c">0.79+0.08\,\uparrow\,10.13\%</annotation><annotation encoding="application/x-llamapun" id="A1.T3.34.34.5.m1.1d">0.79 + 0.08 ↑ 10.13 %</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A1.T3.38.38">
<td class="ltx_td ltx_align_left ltx_border_t" id="A1.T3.35.35.1">
<math alttext="1.3" class="ltx_Math" display="inline" id="A1.T3.35.35.1.m1.1"><semantics id="A1.T3.35.35.1.m1.1a"><mn id="A1.T3.35.35.1.m1.1.1" xref="A1.T3.35.35.1.m1.1.1.cmml">1.3</mn><annotation-xml encoding="MathML-Content" id="A1.T3.35.35.1.m1.1b"><cn id="A1.T3.35.35.1.m1.1.1.cmml" type="float" xref="A1.T3.35.35.1.m1.1.1">1.3</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.35.35.1.m1.1c">1.3</annotation><annotation encoding="application/x-llamapun" id="A1.T3.35.35.1.m1.1d">1.3</annotation></semantics></math>B (dense)</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T3.36.36.2"><math alttext="9.10" class="ltx_Math" display="inline" id="A1.T3.36.36.2.m1.1"><semantics id="A1.T3.36.36.2.m1.1a"><mn id="A1.T3.36.36.2.m1.1.1" xref="A1.T3.36.36.2.m1.1.1.cmml">9.10</mn><annotation-xml encoding="MathML-Content" id="A1.T3.36.36.2.m1.1b"><cn id="A1.T3.36.36.2.m1.1.1.cmml" type="float" xref="A1.T3.36.36.2.m1.1.1">9.10</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.36.36.2.m1.1c">9.10</annotation><annotation encoding="application/x-llamapun" id="A1.T3.36.36.2.m1.1d">9.10</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T3.37.37.3"><math alttext="221.33" class="ltx_Math" display="inline" id="A1.T3.37.37.3.m1.1"><semantics id="A1.T3.37.37.3.m1.1a"><mn id="A1.T3.37.37.3.m1.1.1" xref="A1.T3.37.37.3.m1.1.1.cmml">221.33</mn><annotation-xml encoding="MathML-Content" id="A1.T3.37.37.3.m1.1b"><cn id="A1.T3.37.37.3.m1.1.1.cmml" type="float" xref="A1.T3.37.37.3.m1.1.1">221.33</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.37.37.3.m1.1c">221.33</annotation><annotation encoding="application/x-llamapun" id="A1.T3.37.37.3.m1.1d">221.33</annotation></semantics></math></td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" id="A1.T3.38.38.4"><math alttext="2.81" class="ltx_Math" display="inline" id="A1.T3.38.38.4.m1.1"><semantics id="A1.T3.38.38.4.m1.1a"><mn id="A1.T3.38.38.4.m1.1.1" xref="A1.T3.38.38.4.m1.1.1.cmml">2.81</mn><annotation-xml encoding="MathML-Content" id="A1.T3.38.38.4.m1.1b"><cn id="A1.T3.38.38.4.m1.1.1.cmml" type="float" xref="A1.T3.38.38.4.m1.1.1">2.81</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.38.38.4.m1.1c">2.81</annotation><annotation encoding="application/x-llamapun" id="A1.T3.38.38.4.m1.1d">2.81</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A1.T3.43.43">
<td class="ltx_td ltx_align_left" id="A1.T3.40.40.2">
<math alttext="1.3" class="ltx_Math" display="inline" id="A1.T3.39.39.1.m1.1"><semantics id="A1.T3.39.39.1.m1.1a"><mn id="A1.T3.39.39.1.m1.1.1" xref="A1.T3.39.39.1.m1.1.1.cmml">1.3</mn><annotation-xml encoding="MathML-Content" id="A1.T3.39.39.1.m1.1b"><cn id="A1.T3.39.39.1.m1.1.1.cmml" type="float" xref="A1.T3.39.39.1.m1.1.1">1.3</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.39.39.1.m1.1c">1.3</annotation><annotation encoding="application/x-llamapun" id="A1.T3.39.39.1.m1.1d">1.3</annotation></semantics></math>B (<math alttext="4" class="ltx_Math" display="inline" id="A1.T3.40.40.2.m2.1"><semantics id="A1.T3.40.40.2.m2.1a"><mn id="A1.T3.40.40.2.m2.1.1" xref="A1.T3.40.40.2.m2.1.1.cmml">4</mn><annotation-xml encoding="MathML-Content" id="A1.T3.40.40.2.m2.1b"><cn id="A1.T3.40.40.2.m2.1.1.cmml" type="integer" xref="A1.T3.40.40.2.m2.1.1">4</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.40.40.2.m2.1c">4</annotation><annotation encoding="application/x-llamapun" id="A1.T3.40.40.2.m2.1d">4</annotation></semantics></math> experts)</td>
<td class="ltx_td ltx_align_center" id="A1.T3.41.41.3"><math alttext="8.75\,\color[rgb]{0.1,0.5,0.1}\definecolor[named]{pgfstrokecolor}{rgb}{%
0.1,0.5,0.1}{\downarrow\,3.85\%}" class="ltx_Math" display="inline" id="A1.T3.41.41.3.m1.1"><semantics id="A1.T3.41.41.3.m1.1a"><mrow id="A1.T3.41.41.3.m1.1.1" xref="A1.T3.41.41.3.m1.1.1.cmml"><mn id="A1.T3.41.41.3.m1.1.1.2" mathcolor="#000000" xref="A1.T3.41.41.3.m1.1.1.2.cmml">8.75</mn><mo id="A1.T3.41.41.3.m1.1.1.1" lspace="0.448em" mathcolor="#1A801A" stretchy="false" xref="A1.T3.41.41.3.m1.1.1.1.cmml">↓</mo><mrow id="A1.T3.41.41.3.m1.1.1.3" xref="A1.T3.41.41.3.m1.1.1.3.cmml"><mn id="A1.T3.41.41.3.m1.1.1.3.2" mathcolor="#1A801A" xref="A1.T3.41.41.3.m1.1.1.3.2.cmml"> 3.85</mn><mo id="A1.T3.41.41.3.m1.1.1.3.1" mathcolor="#1A801A" xref="A1.T3.41.41.3.m1.1.1.3.1.cmml">%</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.T3.41.41.3.m1.1b"><apply id="A1.T3.41.41.3.m1.1.1.cmml" xref="A1.T3.41.41.3.m1.1.1"><ci id="A1.T3.41.41.3.m1.1.1.1.cmml" xref="A1.T3.41.41.3.m1.1.1.1">↓</ci><cn id="A1.T3.41.41.3.m1.1.1.2.cmml" type="float" xref="A1.T3.41.41.3.m1.1.1.2">8.75</cn><apply id="A1.T3.41.41.3.m1.1.1.3.cmml" xref="A1.T3.41.41.3.m1.1.1.3"><csymbol cd="latexml" id="A1.T3.41.41.3.m1.1.1.3.1.cmml" xref="A1.T3.41.41.3.m1.1.1.3.1">percent</csymbol><cn id="A1.T3.41.41.3.m1.1.1.3.2.cmml" type="float" xref="A1.T3.41.41.3.m1.1.1.3.2">3.85</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.41.41.3.m1.1c">8.75\,\color[rgb]{0.1,0.5,0.1}\definecolor[named]{pgfstrokecolor}{rgb}{%
0.1,0.5,0.1}{\downarrow\,3.85\%}</annotation><annotation encoding="application/x-llamapun" id="A1.T3.41.41.3.m1.1d">8.75 ↓ 3.85 %</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="A1.T3.42.42.4"><math alttext="221.33+0.36\,\uparrow\,0.16\%" class="ltx_Math" display="inline" id="A1.T3.42.42.4.m1.1"><semantics id="A1.T3.42.42.4.m1.1a"><mrow id="A1.T3.42.42.4.m1.1.1" xref="A1.T3.42.42.4.m1.1.1.cmml"><mrow id="A1.T3.42.42.4.m1.1.1.2" xref="A1.T3.42.42.4.m1.1.1.2.cmml"><mn id="A1.T3.42.42.4.m1.1.1.2.2" xref="A1.T3.42.42.4.m1.1.1.2.2.cmml">221.33</mn><mo id="A1.T3.42.42.4.m1.1.1.2.1" xref="A1.T3.42.42.4.m1.1.1.2.1.cmml">+</mo><mn id="A1.T3.42.42.4.m1.1.1.2.3" xref="A1.T3.42.42.4.m1.1.1.2.3.cmml">0.36</mn></mrow><mo id="A1.T3.42.42.4.m1.1.1.1" lspace="0.448em" stretchy="false" xref="A1.T3.42.42.4.m1.1.1.1.cmml">↑</mo><mrow id="A1.T3.42.42.4.m1.1.1.3" xref="A1.T3.42.42.4.m1.1.1.3.cmml"><mn id="A1.T3.42.42.4.m1.1.1.3.2" xref="A1.T3.42.42.4.m1.1.1.3.2.cmml"> 0.16</mn><mo id="A1.T3.42.42.4.m1.1.1.3.1" xref="A1.T3.42.42.4.m1.1.1.3.1.cmml">%</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.T3.42.42.4.m1.1b"><apply id="A1.T3.42.42.4.m1.1.1.cmml" xref="A1.T3.42.42.4.m1.1.1"><ci id="A1.T3.42.42.4.m1.1.1.1.cmml" xref="A1.T3.42.42.4.m1.1.1.1">↑</ci><apply id="A1.T3.42.42.4.m1.1.1.2.cmml" xref="A1.T3.42.42.4.m1.1.1.2"><plus id="A1.T3.42.42.4.m1.1.1.2.1.cmml" xref="A1.T3.42.42.4.m1.1.1.2.1"></plus><cn id="A1.T3.42.42.4.m1.1.1.2.2.cmml" type="float" xref="A1.T3.42.42.4.m1.1.1.2.2">221.33</cn><cn id="A1.T3.42.42.4.m1.1.1.2.3.cmml" type="float" xref="A1.T3.42.42.4.m1.1.1.2.3">0.36</cn></apply><apply id="A1.T3.42.42.4.m1.1.1.3.cmml" xref="A1.T3.42.42.4.m1.1.1.3"><csymbol cd="latexml" id="A1.T3.42.42.4.m1.1.1.3.1.cmml" xref="A1.T3.42.42.4.m1.1.1.3.1">percent</csymbol><cn id="A1.T3.42.42.4.m1.1.1.3.2.cmml" type="float" xref="A1.T3.42.42.4.m1.1.1.3.2">0.16</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.42.42.4.m1.1c">221.33+0.36\,\uparrow\,0.16\%</annotation><annotation encoding="application/x-llamapun" id="A1.T3.42.42.4.m1.1d">221.33 + 0.36 ↑ 0.16 %</annotation></semantics></math></td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A1.T3.43.43.5"><math alttext="2.81+0.01\,\uparrow\,0.36\%" class="ltx_Math" display="inline" id="A1.T3.43.43.5.m1.1"><semantics id="A1.T3.43.43.5.m1.1a"><mrow id="A1.T3.43.43.5.m1.1.1" xref="A1.T3.43.43.5.m1.1.1.cmml"><mrow id="A1.T3.43.43.5.m1.1.1.2" xref="A1.T3.43.43.5.m1.1.1.2.cmml"><mn id="A1.T3.43.43.5.m1.1.1.2.2" xref="A1.T3.43.43.5.m1.1.1.2.2.cmml">2.81</mn><mo id="A1.T3.43.43.5.m1.1.1.2.1" xref="A1.T3.43.43.5.m1.1.1.2.1.cmml">+</mo><mn id="A1.T3.43.43.5.m1.1.1.2.3" xref="A1.T3.43.43.5.m1.1.1.2.3.cmml">0.01</mn></mrow><mo id="A1.T3.43.43.5.m1.1.1.1" lspace="0.448em" stretchy="false" xref="A1.T3.43.43.5.m1.1.1.1.cmml">↑</mo><mrow id="A1.T3.43.43.5.m1.1.1.3" xref="A1.T3.43.43.5.m1.1.1.3.cmml"><mn id="A1.T3.43.43.5.m1.1.1.3.2" xref="A1.T3.43.43.5.m1.1.1.3.2.cmml"> 0.36</mn><mo id="A1.T3.43.43.5.m1.1.1.3.1" xref="A1.T3.43.43.5.m1.1.1.3.1.cmml">%</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.T3.43.43.5.m1.1b"><apply id="A1.T3.43.43.5.m1.1.1.cmml" xref="A1.T3.43.43.5.m1.1.1"><ci id="A1.T3.43.43.5.m1.1.1.1.cmml" xref="A1.T3.43.43.5.m1.1.1.1">↑</ci><apply id="A1.T3.43.43.5.m1.1.1.2.cmml" xref="A1.T3.43.43.5.m1.1.1.2"><plus id="A1.T3.43.43.5.m1.1.1.2.1.cmml" xref="A1.T3.43.43.5.m1.1.1.2.1"></plus><cn id="A1.T3.43.43.5.m1.1.1.2.2.cmml" type="float" xref="A1.T3.43.43.5.m1.1.1.2.2">2.81</cn><cn id="A1.T3.43.43.5.m1.1.1.2.3.cmml" type="float" xref="A1.T3.43.43.5.m1.1.1.2.3">0.01</cn></apply><apply id="A1.T3.43.43.5.m1.1.1.3.cmml" xref="A1.T3.43.43.5.m1.1.1.3"><csymbol cd="latexml" id="A1.T3.43.43.5.m1.1.1.3.1.cmml" xref="A1.T3.43.43.5.m1.1.1.3.1">percent</csymbol><cn id="A1.T3.43.43.5.m1.1.1.3.2.cmml" type="float" xref="A1.T3.43.43.5.m1.1.1.3.2">0.36</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.43.43.5.m1.1c">2.81+0.01\,\uparrow\,0.36\%</annotation><annotation encoding="application/x-llamapun" id="A1.T3.43.43.5.m1.1d">2.81 + 0.01 ↑ 0.36 %</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A1.T3.47.47">
<td class="ltx_td ltx_align_left ltx_border_t" id="A1.T3.44.44.1">
<math alttext="1.3" class="ltx_Math" display="inline" id="A1.T3.44.44.1.m1.1"><semantics id="A1.T3.44.44.1.m1.1a"><mn id="A1.T3.44.44.1.m1.1.1" xref="A1.T3.44.44.1.m1.1.1.cmml">1.3</mn><annotation-xml encoding="MathML-Content" id="A1.T3.44.44.1.m1.1b"><cn id="A1.T3.44.44.1.m1.1.1.cmml" type="float" xref="A1.T3.44.44.1.m1.1.1">1.3</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.44.44.1.m1.1c">1.3</annotation><annotation encoding="application/x-llamapun" id="A1.T3.44.44.1.m1.1d">1.3</annotation></semantics></math>B (dense)</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T3.45.45.2"><math alttext="8.48" class="ltx_Math" display="inline" id="A1.T3.45.45.2.m1.1"><semantics id="A1.T3.45.45.2.m1.1a"><mn id="A1.T3.45.45.2.m1.1.1" xref="A1.T3.45.45.2.m1.1.1.cmml">8.48</mn><annotation-xml encoding="MathML-Content" id="A1.T3.45.45.2.m1.1b"><cn id="A1.T3.45.45.2.m1.1.1.cmml" type="float" xref="A1.T3.45.45.2.m1.1.1">8.48</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.45.45.2.m1.1c">8.48</annotation><annotation encoding="application/x-llamapun" id="A1.T3.45.45.2.m1.1d">8.48</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T3.46.46.3"><math alttext="885.32" class="ltx_Math" display="inline" id="A1.T3.46.46.3.m1.1"><semantics id="A1.T3.46.46.3.m1.1a"><mn id="A1.T3.46.46.3.m1.1.1" xref="A1.T3.46.46.3.m1.1.1.cmml">885.32</mn><annotation-xml encoding="MathML-Content" id="A1.T3.46.46.3.m1.1b"><cn id="A1.T3.46.46.3.m1.1.1.cmml" type="float" xref="A1.T3.46.46.3.m1.1.1">885.32</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.46.46.3.m1.1c">885.32</annotation><annotation encoding="application/x-llamapun" id="A1.T3.46.46.3.m1.1d">885.32</annotation></semantics></math></td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" id="A1.T3.47.47.4"><math alttext="2.81" class="ltx_Math" display="inline" id="A1.T3.47.47.4.m1.1"><semantics id="A1.T3.47.47.4.m1.1a"><mn id="A1.T3.47.47.4.m1.1.1" xref="A1.T3.47.47.4.m1.1.1.cmml">2.81</mn><annotation-xml encoding="MathML-Content" id="A1.T3.47.47.4.m1.1b"><cn id="A1.T3.47.47.4.m1.1.1.cmml" type="float" xref="A1.T3.47.47.4.m1.1.1">2.81</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.47.47.4.m1.1c">2.81</annotation><annotation encoding="application/x-llamapun" id="A1.T3.47.47.4.m1.1d">2.81</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A1.T3.52.52">
<td class="ltx_td ltx_align_left" id="A1.T3.49.49.2">
<math alttext="1.3" class="ltx_Math" display="inline" id="A1.T3.48.48.1.m1.1"><semantics id="A1.T3.48.48.1.m1.1a"><mn id="A1.T3.48.48.1.m1.1.1" xref="A1.T3.48.48.1.m1.1.1.cmml">1.3</mn><annotation-xml encoding="MathML-Content" id="A1.T3.48.48.1.m1.1b"><cn id="A1.T3.48.48.1.m1.1.1.cmml" type="float" xref="A1.T3.48.48.1.m1.1.1">1.3</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.48.48.1.m1.1c">1.3</annotation><annotation encoding="application/x-llamapun" id="A1.T3.48.48.1.m1.1d">1.3</annotation></semantics></math>B (<math alttext="16" class="ltx_Math" display="inline" id="A1.T3.49.49.2.m2.1"><semantics id="A1.T3.49.49.2.m2.1a"><mn id="A1.T3.49.49.2.m2.1.1" xref="A1.T3.49.49.2.m2.1.1.cmml">16</mn><annotation-xml encoding="MathML-Content" id="A1.T3.49.49.2.m2.1b"><cn id="A1.T3.49.49.2.m2.1.1.cmml" type="integer" xref="A1.T3.49.49.2.m2.1.1">16</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.49.49.2.m2.1c">16</annotation><annotation encoding="application/x-llamapun" id="A1.T3.49.49.2.m2.1d">16</annotation></semantics></math> experts)</td>
<td class="ltx_td ltx_align_center" id="A1.T3.50.50.3"><math alttext="7.42\,\color[rgb]{0.1,0.5,0.1}\definecolor[named]{pgfstrokecolor}{rgb}{%
0.1,0.5,0.1}{\downarrow\,12.53\%}" class="ltx_Math" display="inline" id="A1.T3.50.50.3.m1.1"><semantics id="A1.T3.50.50.3.m1.1a"><mrow id="A1.T3.50.50.3.m1.1.1" xref="A1.T3.50.50.3.m1.1.1.cmml"><mn id="A1.T3.50.50.3.m1.1.1.2" mathcolor="#000000" xref="A1.T3.50.50.3.m1.1.1.2.cmml">7.42</mn><mo id="A1.T3.50.50.3.m1.1.1.1" lspace="0.448em" mathcolor="#1A801A" stretchy="false" xref="A1.T3.50.50.3.m1.1.1.1.cmml">↓</mo><mrow id="A1.T3.50.50.3.m1.1.1.3" xref="A1.T3.50.50.3.m1.1.1.3.cmml"><mn id="A1.T3.50.50.3.m1.1.1.3.2" mathcolor="#1A801A" xref="A1.T3.50.50.3.m1.1.1.3.2.cmml"> 12.53</mn><mo id="A1.T3.50.50.3.m1.1.1.3.1" mathcolor="#1A801A" xref="A1.T3.50.50.3.m1.1.1.3.1.cmml">%</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.T3.50.50.3.m1.1b"><apply id="A1.T3.50.50.3.m1.1.1.cmml" xref="A1.T3.50.50.3.m1.1.1"><ci id="A1.T3.50.50.3.m1.1.1.1.cmml" xref="A1.T3.50.50.3.m1.1.1.1">↓</ci><cn id="A1.T3.50.50.3.m1.1.1.2.cmml" type="float" xref="A1.T3.50.50.3.m1.1.1.2">7.42</cn><apply id="A1.T3.50.50.3.m1.1.1.3.cmml" xref="A1.T3.50.50.3.m1.1.1.3"><csymbol cd="latexml" id="A1.T3.50.50.3.m1.1.1.3.1.cmml" xref="A1.T3.50.50.3.m1.1.1.3.1">percent</csymbol><cn id="A1.T3.50.50.3.m1.1.1.3.2.cmml" type="float" xref="A1.T3.50.50.3.m1.1.1.3.2">12.53</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.50.50.3.m1.1c">7.42\,\color[rgb]{0.1,0.5,0.1}\definecolor[named]{pgfstrokecolor}{rgb}{%
0.1,0.5,0.1}{\downarrow\,12.53\%}</annotation><annotation encoding="application/x-llamapun" id="A1.T3.50.50.3.m1.1d">7.42 ↓ 12.53 %</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="A1.T3.51.51.4"><math alttext="885.32+4.87\,\uparrow\,0.55\%" class="ltx_Math" display="inline" id="A1.T3.51.51.4.m1.1"><semantics id="A1.T3.51.51.4.m1.1a"><mrow id="A1.T3.51.51.4.m1.1.1" xref="A1.T3.51.51.4.m1.1.1.cmml"><mrow id="A1.T3.51.51.4.m1.1.1.2" xref="A1.T3.51.51.4.m1.1.1.2.cmml"><mn id="A1.T3.51.51.4.m1.1.1.2.2" xref="A1.T3.51.51.4.m1.1.1.2.2.cmml">885.32</mn><mo id="A1.T3.51.51.4.m1.1.1.2.1" xref="A1.T3.51.51.4.m1.1.1.2.1.cmml">+</mo><mn id="A1.T3.51.51.4.m1.1.1.2.3" xref="A1.T3.51.51.4.m1.1.1.2.3.cmml">4.87</mn></mrow><mo id="A1.T3.51.51.4.m1.1.1.1" lspace="0.448em" stretchy="false" xref="A1.T3.51.51.4.m1.1.1.1.cmml">↑</mo><mrow id="A1.T3.51.51.4.m1.1.1.3" xref="A1.T3.51.51.4.m1.1.1.3.cmml"><mn id="A1.T3.51.51.4.m1.1.1.3.2" xref="A1.T3.51.51.4.m1.1.1.3.2.cmml"> 0.55</mn><mo id="A1.T3.51.51.4.m1.1.1.3.1" xref="A1.T3.51.51.4.m1.1.1.3.1.cmml">%</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.T3.51.51.4.m1.1b"><apply id="A1.T3.51.51.4.m1.1.1.cmml" xref="A1.T3.51.51.4.m1.1.1"><ci id="A1.T3.51.51.4.m1.1.1.1.cmml" xref="A1.T3.51.51.4.m1.1.1.1">↑</ci><apply id="A1.T3.51.51.4.m1.1.1.2.cmml" xref="A1.T3.51.51.4.m1.1.1.2"><plus id="A1.T3.51.51.4.m1.1.1.2.1.cmml" xref="A1.T3.51.51.4.m1.1.1.2.1"></plus><cn id="A1.T3.51.51.4.m1.1.1.2.2.cmml" type="float" xref="A1.T3.51.51.4.m1.1.1.2.2">885.32</cn><cn id="A1.T3.51.51.4.m1.1.1.2.3.cmml" type="float" xref="A1.T3.51.51.4.m1.1.1.2.3">4.87</cn></apply><apply id="A1.T3.51.51.4.m1.1.1.3.cmml" xref="A1.T3.51.51.4.m1.1.1.3"><csymbol cd="latexml" id="A1.T3.51.51.4.m1.1.1.3.1.cmml" xref="A1.T3.51.51.4.m1.1.1.3.1">percent</csymbol><cn id="A1.T3.51.51.4.m1.1.1.3.2.cmml" type="float" xref="A1.T3.51.51.4.m1.1.1.3.2">0.55</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.51.51.4.m1.1c">885.32+4.87\,\uparrow\,0.55\%</annotation><annotation encoding="application/x-llamapun" id="A1.T3.51.51.4.m1.1d">885.32 + 4.87 ↑ 0.55 %</annotation></semantics></math></td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A1.T3.52.52.5"><math alttext="2.81+0.04\,\uparrow\,1.42\%" class="ltx_Math" display="inline" id="A1.T3.52.52.5.m1.1"><semantics id="A1.T3.52.52.5.m1.1a"><mrow id="A1.T3.52.52.5.m1.1.1" xref="A1.T3.52.52.5.m1.1.1.cmml"><mrow id="A1.T3.52.52.5.m1.1.1.2" xref="A1.T3.52.52.5.m1.1.1.2.cmml"><mn id="A1.T3.52.52.5.m1.1.1.2.2" xref="A1.T3.52.52.5.m1.1.1.2.2.cmml">2.81</mn><mo id="A1.T3.52.52.5.m1.1.1.2.1" xref="A1.T3.52.52.5.m1.1.1.2.1.cmml">+</mo><mn id="A1.T3.52.52.5.m1.1.1.2.3" xref="A1.T3.52.52.5.m1.1.1.2.3.cmml">0.04</mn></mrow><mo id="A1.T3.52.52.5.m1.1.1.1" lspace="0.448em" stretchy="false" xref="A1.T3.52.52.5.m1.1.1.1.cmml">↑</mo><mrow id="A1.T3.52.52.5.m1.1.1.3" xref="A1.T3.52.52.5.m1.1.1.3.cmml"><mn id="A1.T3.52.52.5.m1.1.1.3.2" xref="A1.T3.52.52.5.m1.1.1.3.2.cmml"> 1.42</mn><mo id="A1.T3.52.52.5.m1.1.1.3.1" xref="A1.T3.52.52.5.m1.1.1.3.1.cmml">%</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.T3.52.52.5.m1.1b"><apply id="A1.T3.52.52.5.m1.1.1.cmml" xref="A1.T3.52.52.5.m1.1.1"><ci id="A1.T3.52.52.5.m1.1.1.1.cmml" xref="A1.T3.52.52.5.m1.1.1.1">↑</ci><apply id="A1.T3.52.52.5.m1.1.1.2.cmml" xref="A1.T3.52.52.5.m1.1.1.2"><plus id="A1.T3.52.52.5.m1.1.1.2.1.cmml" xref="A1.T3.52.52.5.m1.1.1.2.1"></plus><cn id="A1.T3.52.52.5.m1.1.1.2.2.cmml" type="float" xref="A1.T3.52.52.5.m1.1.1.2.2">2.81</cn><cn id="A1.T3.52.52.5.m1.1.1.2.3.cmml" type="float" xref="A1.T3.52.52.5.m1.1.1.2.3">0.04</cn></apply><apply id="A1.T3.52.52.5.m1.1.1.3.cmml" xref="A1.T3.52.52.5.m1.1.1.3"><csymbol cd="latexml" id="A1.T3.52.52.5.m1.1.1.3.1.cmml" xref="A1.T3.52.52.5.m1.1.1.3.1">percent</csymbol><cn id="A1.T3.52.52.5.m1.1.1.3.2.cmml" type="float" xref="A1.T3.52.52.5.m1.1.1.3.2">1.42</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.52.52.5.m1.1c">2.81+0.04\,\uparrow\,1.42\%</annotation><annotation encoding="application/x-llamapun" id="A1.T3.52.52.5.m1.1d">2.81 + 0.04 ↑ 1.42 %</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A1.T3.56.56">
<td class="ltx_td ltx_align_left ltx_border_t" id="A1.T3.53.53.1">
<math alttext="1.3" class="ltx_Math" display="inline" id="A1.T3.53.53.1.m1.1"><semantics id="A1.T3.53.53.1.m1.1a"><mn id="A1.T3.53.53.1.m1.1.1" xref="A1.T3.53.53.1.m1.1.1.cmml">1.3</mn><annotation-xml encoding="MathML-Content" id="A1.T3.53.53.1.m1.1b"><cn id="A1.T3.53.53.1.m1.1.1.cmml" type="float" xref="A1.T3.53.53.1.m1.1.1">1.3</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.53.53.1.m1.1c">1.3</annotation><annotation encoding="application/x-llamapun" id="A1.T3.53.53.1.m1.1d">1.3</annotation></semantics></math>B (dense)</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T3.54.54.2"><math alttext="8.20" class="ltx_Math" display="inline" id="A1.T3.54.54.2.m1.1"><semantics id="A1.T3.54.54.2.m1.1a"><mn id="A1.T3.54.54.2.m1.1.1" xref="A1.T3.54.54.2.m1.1.1.cmml">8.20</mn><annotation-xml encoding="MathML-Content" id="A1.T3.54.54.2.m1.1b"><cn id="A1.T3.54.54.2.m1.1.1.cmml" type="float" xref="A1.T3.54.54.2.m1.1.1">8.20</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.54.54.2.m1.1c">8.20</annotation><annotation encoding="application/x-llamapun" id="A1.T3.54.54.2.m1.1d">8.20</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T3.55.55.3"><math alttext="1770.65" class="ltx_Math" display="inline" id="A1.T3.55.55.3.m1.1"><semantics id="A1.T3.55.55.3.m1.1a"><mn id="A1.T3.55.55.3.m1.1.1" xref="A1.T3.55.55.3.m1.1.1.cmml">1770.65</mn><annotation-xml encoding="MathML-Content" id="A1.T3.55.55.3.m1.1b"><cn id="A1.T3.55.55.3.m1.1.1.cmml" type="float" xref="A1.T3.55.55.3.m1.1.1">1770.65</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.55.55.3.m1.1c">1770.65</annotation><annotation encoding="application/x-llamapun" id="A1.T3.55.55.3.m1.1d">1770.65</annotation></semantics></math></td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" id="A1.T3.56.56.4"><math alttext="2.81" class="ltx_Math" display="inline" id="A1.T3.56.56.4.m1.1"><semantics id="A1.T3.56.56.4.m1.1a"><mn id="A1.T3.56.56.4.m1.1.1" xref="A1.T3.56.56.4.m1.1.1.cmml">2.81</mn><annotation-xml encoding="MathML-Content" id="A1.T3.56.56.4.m1.1b"><cn id="A1.T3.56.56.4.m1.1.1.cmml" type="float" xref="A1.T3.56.56.4.m1.1.1">2.81</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.56.56.4.m1.1c">2.81</annotation><annotation encoding="application/x-llamapun" id="A1.T3.56.56.4.m1.1d">2.81</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A1.T3.61.61">
<td class="ltx_td ltx_align_left ltx_border_bb ltx_border_b" id="A1.T3.58.58.2">
<math alttext="1.3" class="ltx_Math" display="inline" id="A1.T3.57.57.1.m1.1"><semantics id="A1.T3.57.57.1.m1.1a"><mn id="A1.T3.57.57.1.m1.1.1" xref="A1.T3.57.57.1.m1.1.1.cmml">1.3</mn><annotation-xml encoding="MathML-Content" id="A1.T3.57.57.1.m1.1b"><cn id="A1.T3.57.57.1.m1.1.1.cmml" type="float" xref="A1.T3.57.57.1.m1.1.1">1.3</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.57.57.1.m1.1c">1.3</annotation><annotation encoding="application/x-llamapun" id="A1.T3.57.57.1.m1.1d">1.3</annotation></semantics></math>B (<math alttext="32" class="ltx_Math" display="inline" id="A1.T3.58.58.2.m2.1"><semantics id="A1.T3.58.58.2.m2.1a"><mn id="A1.T3.58.58.2.m2.1.1" xref="A1.T3.58.58.2.m2.1.1.cmml">32</mn><annotation-xml encoding="MathML-Content" id="A1.T3.58.58.2.m2.1b"><cn id="A1.T3.58.58.2.m2.1.1.cmml" type="integer" xref="A1.T3.58.58.2.m2.1.1">32</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.58.58.2.m2.1c">32</annotation><annotation encoding="application/x-llamapun" id="A1.T3.58.58.2.m2.1d">32</annotation></semantics></math> experts)</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_b" id="A1.T3.59.59.3"><math alttext="6.76\,\color[rgb]{0.1,0.5,0.1}\definecolor[named]{pgfstrokecolor}{rgb}{%
0.1,0.5,0.1}{\downarrow\,17.56\%}" class="ltx_Math" display="inline" id="A1.T3.59.59.3.m1.1"><semantics id="A1.T3.59.59.3.m1.1a"><mrow id="A1.T3.59.59.3.m1.1.1" xref="A1.T3.59.59.3.m1.1.1.cmml"><mn id="A1.T3.59.59.3.m1.1.1.2" mathcolor="#000000" xref="A1.T3.59.59.3.m1.1.1.2.cmml">6.76</mn><mo id="A1.T3.59.59.3.m1.1.1.1" lspace="0.448em" mathcolor="#1A801A" stretchy="false" xref="A1.T3.59.59.3.m1.1.1.1.cmml">↓</mo><mrow id="A1.T3.59.59.3.m1.1.1.3" xref="A1.T3.59.59.3.m1.1.1.3.cmml"><mn id="A1.T3.59.59.3.m1.1.1.3.2" mathcolor="#1A801A" xref="A1.T3.59.59.3.m1.1.1.3.2.cmml"> 17.56</mn><mo id="A1.T3.59.59.3.m1.1.1.3.1" mathcolor="#1A801A" xref="A1.T3.59.59.3.m1.1.1.3.1.cmml">%</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.T3.59.59.3.m1.1b"><apply id="A1.T3.59.59.3.m1.1.1.cmml" xref="A1.T3.59.59.3.m1.1.1"><ci id="A1.T3.59.59.3.m1.1.1.1.cmml" xref="A1.T3.59.59.3.m1.1.1.1">↓</ci><cn id="A1.T3.59.59.3.m1.1.1.2.cmml" type="float" xref="A1.T3.59.59.3.m1.1.1.2">6.76</cn><apply id="A1.T3.59.59.3.m1.1.1.3.cmml" xref="A1.T3.59.59.3.m1.1.1.3"><csymbol cd="latexml" id="A1.T3.59.59.3.m1.1.1.3.1.cmml" xref="A1.T3.59.59.3.m1.1.1.3.1">percent</csymbol><cn id="A1.T3.59.59.3.m1.1.1.3.2.cmml" type="float" xref="A1.T3.59.59.3.m1.1.1.3.2">17.56</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.59.59.3.m1.1c">6.76\,\color[rgb]{0.1,0.5,0.1}\definecolor[named]{pgfstrokecolor}{rgb}{%
0.1,0.5,0.1}{\downarrow\,17.56\%}</annotation><annotation encoding="application/x-llamapun" id="A1.T3.59.59.3.m1.1d">6.76 ↓ 17.56 %</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_b" id="A1.T3.60.60.4"><math alttext="1770.65+18.94\,\uparrow\,1.07\%" class="ltx_Math" display="inline" id="A1.T3.60.60.4.m1.1"><semantics id="A1.T3.60.60.4.m1.1a"><mrow id="A1.T3.60.60.4.m1.1.1" xref="A1.T3.60.60.4.m1.1.1.cmml"><mrow id="A1.T3.60.60.4.m1.1.1.2" xref="A1.T3.60.60.4.m1.1.1.2.cmml"><mn id="A1.T3.60.60.4.m1.1.1.2.2" xref="A1.T3.60.60.4.m1.1.1.2.2.cmml">1770.65</mn><mo id="A1.T3.60.60.4.m1.1.1.2.1" xref="A1.T3.60.60.4.m1.1.1.2.1.cmml">+</mo><mn id="A1.T3.60.60.4.m1.1.1.2.3" xref="A1.T3.60.60.4.m1.1.1.2.3.cmml">18.94</mn></mrow><mo id="A1.T3.60.60.4.m1.1.1.1" lspace="0.448em" stretchy="false" xref="A1.T3.60.60.4.m1.1.1.1.cmml">↑</mo><mrow id="A1.T3.60.60.4.m1.1.1.3" xref="A1.T3.60.60.4.m1.1.1.3.cmml"><mn id="A1.T3.60.60.4.m1.1.1.3.2" xref="A1.T3.60.60.4.m1.1.1.3.2.cmml"> 1.07</mn><mo id="A1.T3.60.60.4.m1.1.1.3.1" xref="A1.T3.60.60.4.m1.1.1.3.1.cmml">%</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.T3.60.60.4.m1.1b"><apply id="A1.T3.60.60.4.m1.1.1.cmml" xref="A1.T3.60.60.4.m1.1.1"><ci id="A1.T3.60.60.4.m1.1.1.1.cmml" xref="A1.T3.60.60.4.m1.1.1.1">↑</ci><apply id="A1.T3.60.60.4.m1.1.1.2.cmml" xref="A1.T3.60.60.4.m1.1.1.2"><plus id="A1.T3.60.60.4.m1.1.1.2.1.cmml" xref="A1.T3.60.60.4.m1.1.1.2.1"></plus><cn id="A1.T3.60.60.4.m1.1.1.2.2.cmml" type="float" xref="A1.T3.60.60.4.m1.1.1.2.2">1770.65</cn><cn id="A1.T3.60.60.4.m1.1.1.2.3.cmml" type="float" xref="A1.T3.60.60.4.m1.1.1.2.3">18.94</cn></apply><apply id="A1.T3.60.60.4.m1.1.1.3.cmml" xref="A1.T3.60.60.4.m1.1.1.3"><csymbol cd="latexml" id="A1.T3.60.60.4.m1.1.1.3.1.cmml" xref="A1.T3.60.60.4.m1.1.1.3.1">percent</csymbol><cn id="A1.T3.60.60.4.m1.1.1.3.2.cmml" type="float" xref="A1.T3.60.60.4.m1.1.1.3.2">1.07</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.60.60.4.m1.1c">1770.65+18.94\,\uparrow\,1.07\%</annotation><annotation encoding="application/x-llamapun" id="A1.T3.60.60.4.m1.1d">1770.65 + 18.94 ↑ 1.07 %</annotation></semantics></math></td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_bb ltx_border_b" id="A1.T3.61.61.5"><math alttext="2.81+0.08\,\uparrow\,2.85\%" class="ltx_Math" display="inline" id="A1.T3.61.61.5.m1.1"><semantics id="A1.T3.61.61.5.m1.1a"><mrow id="A1.T3.61.61.5.m1.1.1" xref="A1.T3.61.61.5.m1.1.1.cmml"><mrow id="A1.T3.61.61.5.m1.1.1.2" xref="A1.T3.61.61.5.m1.1.1.2.cmml"><mn id="A1.T3.61.61.5.m1.1.1.2.2" xref="A1.T3.61.61.5.m1.1.1.2.2.cmml">2.81</mn><mo id="A1.T3.61.61.5.m1.1.1.2.1" xref="A1.T3.61.61.5.m1.1.1.2.1.cmml">+</mo><mn id="A1.T3.61.61.5.m1.1.1.2.3" xref="A1.T3.61.61.5.m1.1.1.2.3.cmml">0.08</mn></mrow><mo id="A1.T3.61.61.5.m1.1.1.1" lspace="0.448em" stretchy="false" xref="A1.T3.61.61.5.m1.1.1.1.cmml">↑</mo><mrow id="A1.T3.61.61.5.m1.1.1.3" xref="A1.T3.61.61.5.m1.1.1.3.cmml"><mn id="A1.T3.61.61.5.m1.1.1.3.2" xref="A1.T3.61.61.5.m1.1.1.3.2.cmml"> 2.85</mn><mo id="A1.T3.61.61.5.m1.1.1.3.1" xref="A1.T3.61.61.5.m1.1.1.3.1.cmml">%</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.T3.61.61.5.m1.1b"><apply id="A1.T3.61.61.5.m1.1.1.cmml" xref="A1.T3.61.61.5.m1.1.1"><ci id="A1.T3.61.61.5.m1.1.1.1.cmml" xref="A1.T3.61.61.5.m1.1.1.1">↑</ci><apply id="A1.T3.61.61.5.m1.1.1.2.cmml" xref="A1.T3.61.61.5.m1.1.1.2"><plus id="A1.T3.61.61.5.m1.1.1.2.1.cmml" xref="A1.T3.61.61.5.m1.1.1.2.1"></plus><cn id="A1.T3.61.61.5.m1.1.1.2.2.cmml" type="float" xref="A1.T3.61.61.5.m1.1.1.2.2">2.81</cn><cn id="A1.T3.61.61.5.m1.1.1.2.3.cmml" type="float" xref="A1.T3.61.61.5.m1.1.1.2.3">0.08</cn></apply><apply id="A1.T3.61.61.5.m1.1.1.3.cmml" xref="A1.T3.61.61.5.m1.1.1.3"><csymbol cd="latexml" id="A1.T3.61.61.5.m1.1.1.3.1.cmml" xref="A1.T3.61.61.5.m1.1.1.3.1">percent</csymbol><cn id="A1.T3.61.61.5.m1.1.1.3.2.cmml" type="float" xref="A1.T3.61.61.5.m1.1.1.3.2">2.85</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.61.61.5.m1.1c">2.81+0.08\,\uparrow\,2.85\%</annotation><annotation encoding="application/x-llamapun" id="A1.T3.61.61.5.m1.1d">2.81 + 0.08 ↑ 2.85 %</annotation></semantics></math></td>
</tr>
</tbody></table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 3: </span><span class="ltx_text ltx_font_bold" id="A1.T3.85.1">Performance gain versus computational overhead.</span> The table compares performance improvements and computational costs for models with <math alttext="335" class="ltx_Math" display="inline" id="A1.T3.73.m1.1"><semantics id="A1.T3.73.m1.1b"><mn id="A1.T3.73.m1.1.1" xref="A1.T3.73.m1.1.1.cmml">335</mn><annotation-xml encoding="MathML-Content" id="A1.T3.73.m1.1c"><cn id="A1.T3.73.m1.1.1.cmml" type="integer" xref="A1.T3.73.m1.1.1">335</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.73.m1.1d">335</annotation><annotation encoding="application/x-llamapun" id="A1.T3.73.m1.1e">335</annotation></semantics></math>M (trained with <math alttext="4" class="ltx_Math" display="inline" id="A1.T3.74.m2.1"><semantics id="A1.T3.74.m2.1b"><mn id="A1.T3.74.m2.1.1" xref="A1.T3.74.m2.1.1.cmml">4</mn><annotation-xml encoding="MathML-Content" id="A1.T3.74.m2.1c"><cn id="A1.T3.74.m2.1.1.cmml" type="integer" xref="A1.T3.74.m2.1.1">4</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.74.m2.1d">4</annotation><annotation encoding="application/x-llamapun" id="A1.T3.74.m2.1e">4</annotation></semantics></math>, <math alttext="8" class="ltx_Math" display="inline" id="A1.T3.75.m3.1"><semantics id="A1.T3.75.m3.1b"><mn id="A1.T3.75.m3.1.1" xref="A1.T3.75.m3.1.1.cmml">8</mn><annotation-xml encoding="MathML-Content" id="A1.T3.75.m3.1c"><cn id="A1.T3.75.m3.1.1.cmml" type="integer" xref="A1.T3.75.m3.1.1">8</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.75.m3.1d">8</annotation><annotation encoding="application/x-llamapun" id="A1.T3.75.m3.1e">8</annotation></semantics></math>, <math alttext="16" class="ltx_Math" display="inline" id="A1.T3.76.m4.1"><semantics id="A1.T3.76.m4.1b"><mn id="A1.T3.76.m4.1.1" xref="A1.T3.76.m4.1.1.cmml">16</mn><annotation-xml encoding="MathML-Content" id="A1.T3.76.m4.1c"><cn id="A1.T3.76.m4.1.1.cmml" type="integer" xref="A1.T3.76.m4.1.1">16</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.76.m4.1d">16</annotation><annotation encoding="application/x-llamapun" id="A1.T3.76.m4.1e">16</annotation></semantics></math>, and <math alttext="32" class="ltx_Math" display="inline" id="A1.T3.77.m5.1"><semantics id="A1.T3.77.m5.1b"><mn id="A1.T3.77.m5.1.1" xref="A1.T3.77.m5.1.1.cmml">32</mn><annotation-xml encoding="MathML-Content" id="A1.T3.77.m5.1c"><cn id="A1.T3.77.m5.1.1.cmml" type="integer" xref="A1.T3.77.m5.1.1">32</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.77.m5.1d">32</annotation><annotation encoding="application/x-llamapun" id="A1.T3.77.m5.1e">32</annotation></semantics></math> experts) and <math alttext="1.3" class="ltx_Math" display="inline" id="A1.T3.78.m6.1"><semantics id="A1.T3.78.m6.1b"><mn id="A1.T3.78.m6.1.1" xref="A1.T3.78.m6.1.1.cmml">1.3</mn><annotation-xml encoding="MathML-Content" id="A1.T3.78.m6.1c"><cn id="A1.T3.78.m6.1.1.cmml" type="float" xref="A1.T3.78.m6.1.1">1.3</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.78.m6.1d">1.3</annotation><annotation encoding="application/x-llamapun" id="A1.T3.78.m6.1e">1.3</annotation></semantics></math>B parameters (trained with <math alttext="4" class="ltx_Math" display="inline" id="A1.T3.79.m7.1"><semantics id="A1.T3.79.m7.1b"><mn id="A1.T3.79.m7.1.1" xref="A1.T3.79.m7.1.1.cmml">4</mn><annotation-xml encoding="MathML-Content" id="A1.T3.79.m7.1c"><cn id="A1.T3.79.m7.1.1.cmml" type="integer" xref="A1.T3.79.m7.1.1">4</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.79.m7.1d">4</annotation><annotation encoding="application/x-llamapun" id="A1.T3.79.m7.1e">4</annotation></semantics></math>, <math alttext="16" class="ltx_Math" display="inline" id="A1.T3.80.m8.1"><semantics id="A1.T3.80.m8.1b"><mn id="A1.T3.80.m8.1.1" xref="A1.T3.80.m8.1.1.cmml">16</mn><annotation-xml encoding="MathML-Content" id="A1.T3.80.m8.1c"><cn id="A1.T3.80.m8.1.1.cmml" type="integer" xref="A1.T3.80.m8.1.1">16</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.80.m8.1d">16</annotation><annotation encoding="application/x-llamapun" id="A1.T3.80.m8.1e">16</annotation></semantics></math>, and <math alttext="32" class="ltx_Math" display="inline" id="A1.T3.81.m9.1"><semantics id="A1.T3.81.m9.1b"><mn id="A1.T3.81.m9.1.1" xref="A1.T3.81.m9.1.1.cmml">32</mn><annotation-xml encoding="MathML-Content" id="A1.T3.81.m9.1c"><cn id="A1.T3.81.m9.1.1.cmml" type="integer" xref="A1.T3.81.m9.1.1">32</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.81.m9.1d">32</annotation><annotation encoding="application/x-llamapun" id="A1.T3.81.m9.1e">32</annotation></semantics></math>) experts. Training cost is measured in <math alttext="10^{19}" class="ltx_Math" display="inline" id="A1.T3.82.m10.1"><semantics id="A1.T3.82.m10.1b"><msup id="A1.T3.82.m10.1.1" xref="A1.T3.82.m10.1.1.cmml"><mn id="A1.T3.82.m10.1.1.2" xref="A1.T3.82.m10.1.1.2.cmml">10</mn><mn id="A1.T3.82.m10.1.1.3" xref="A1.T3.82.m10.1.1.3.cmml">19</mn></msup><annotation-xml encoding="MathML-Content" id="A1.T3.82.m10.1c"><apply id="A1.T3.82.m10.1.1.cmml" xref="A1.T3.82.m10.1.1"><csymbol cd="ambiguous" id="A1.T3.82.m10.1.1.1.cmml" xref="A1.T3.82.m10.1.1">superscript</csymbol><cn id="A1.T3.82.m10.1.1.2.cmml" type="integer" xref="A1.T3.82.m10.1.1.2">10</cn><cn id="A1.T3.82.m10.1.1.3.cmml" type="integer" xref="A1.T3.82.m10.1.1.3">19</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.82.m10.1d">10^{19}</annotation><annotation encoding="application/x-llamapun" id="A1.T3.82.m10.1e">10 start_POSTSUPERSCRIPT 19 end_POSTSUPERSCRIPT</annotation></semantics></math> FLOPs, inference cost is measured in <math alttext="10^{12}" class="ltx_Math" display="inline" id="A1.T3.83.m11.1"><semantics id="A1.T3.83.m11.1b"><msup id="A1.T3.83.m11.1.1" xref="A1.T3.83.m11.1.1.cmml"><mn id="A1.T3.83.m11.1.1.2" xref="A1.T3.83.m11.1.1.2.cmml">10</mn><mn id="A1.T3.83.m11.1.1.3" xref="A1.T3.83.m11.1.1.3.cmml">12</mn></msup><annotation-xml encoding="MathML-Content" id="A1.T3.83.m11.1c"><apply id="A1.T3.83.m11.1.1.cmml" xref="A1.T3.83.m11.1.1"><csymbol cd="ambiguous" id="A1.T3.83.m11.1.1.1.cmml" xref="A1.T3.83.m11.1.1">superscript</csymbol><cn id="A1.T3.83.m11.1.1.2.cmml" type="integer" xref="A1.T3.83.m11.1.1.2">10</cn><cn id="A1.T3.83.m11.1.1.3.cmml" type="integer" xref="A1.T3.83.m11.1.1.3">12</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.83.m11.1d">10^{12}</annotation><annotation encoding="application/x-llamapun" id="A1.T3.83.m11.1e">10 start_POSTSUPERSCRIPT 12 end_POSTSUPERSCRIPT</annotation></semantics></math> FLOPs. The dense baselines and corresponding mixture models were trained on the same data volume.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<section class="ltx_paragraph" id="A1.SS3.SSS2.Px1">
<h5 class="ltx_title ltx_title_paragraph">Regarding Computational Overhead</h5><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="A1.SS3.SSS2.Px1.p1">
<p class="ltx_p" id="A1.SS3.SSS2.Px1.p1.9">As demonstrated in Table&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#A1.T3" title="Table 3 ‣ A.3.2 Mixture of LLMs ‣ A.3 Computational Cost ‣ Appendix A Language modeling experiments ‣ No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_tag">3</span></a>, the <math alttext="1.3" class="ltx_Math" display="inline" id="A1.SS3.SSS2.Px1.p1.1.m1.1"><semantics id="A1.SS3.SSS2.Px1.p1.1.m1.1a"><mn id="A1.SS3.SSS2.Px1.p1.1.m1.1.1" xref="A1.SS3.SSS2.Px1.p1.1.m1.1.1.cmml">1.3</mn><annotation-xml encoding="MathML-Content" id="A1.SS3.SSS2.Px1.p1.1.m1.1b"><cn id="A1.SS3.SSS2.Px1.p1.1.m1.1.1.cmml" type="float" xref="A1.SS3.SSS2.Px1.p1.1.m1.1.1">1.3</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.SSS2.Px1.p1.1.m1.1c">1.3</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.SSS2.Px1.p1.1.m1.1d">1.3</annotation></semantics></math>B parameter model with <math alttext="32" class="ltx_Math" display="inline" id="A1.SS3.SSS2.Px1.p1.2.m2.1"><semantics id="A1.SS3.SSS2.Px1.p1.2.m2.1a"><mn id="A1.SS3.SSS2.Px1.p1.2.m2.1.1" xref="A1.SS3.SSS2.Px1.p1.2.m2.1.1.cmml">32</mn><annotation-xml encoding="MathML-Content" id="A1.SS3.SSS2.Px1.p1.2.m2.1b"><cn id="A1.SS3.SSS2.Px1.p1.2.m2.1.1.cmml" type="integer" xref="A1.SS3.SSS2.Px1.p1.2.m2.1.1">32</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.SSS2.Px1.p1.2.m2.1c">32</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.SSS2.Px1.p1.2.m2.1d">32</annotation></semantics></math> experts achieves significant performance improvements almost cost-free, gaining nearly <math alttext="18\%" class="ltx_Math" display="inline" id="A1.SS3.SSS2.Px1.p1.3.m3.1"><semantics id="A1.SS3.SSS2.Px1.p1.3.m3.1a"><mrow id="A1.SS3.SSS2.Px1.p1.3.m3.1.1" xref="A1.SS3.SSS2.Px1.p1.3.m3.1.1.cmml"><mn id="A1.SS3.SSS2.Px1.p1.3.m3.1.1.2" xref="A1.SS3.SSS2.Px1.p1.3.m3.1.1.2.cmml">18</mn><mo id="A1.SS3.SSS2.Px1.p1.3.m3.1.1.1" xref="A1.SS3.SSS2.Px1.p1.3.m3.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.SS3.SSS2.Px1.p1.3.m3.1b"><apply id="A1.SS3.SSS2.Px1.p1.3.m3.1.1.cmml" xref="A1.SS3.SSS2.Px1.p1.3.m3.1.1"><csymbol cd="latexml" id="A1.SS3.SSS2.Px1.p1.3.m3.1.1.1.cmml" xref="A1.SS3.SSS2.Px1.p1.3.m3.1.1.1">percent</csymbol><cn id="A1.SS3.SSS2.Px1.p1.3.m3.1.1.2.cmml" type="integer" xref="A1.SS3.SSS2.Px1.p1.3.m3.1.1.2">18</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.SSS2.Px1.p1.3.m3.1c">18\%</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.SSS2.Px1.p1.3.m3.1d">18 %</annotation></semantics></math> in perplexity compared to the dense baseline while incurring only <math alttext="1\%" class="ltx_Math" display="inline" id="A1.SS3.SSS2.Px1.p1.4.m4.1"><semantics id="A1.SS3.SSS2.Px1.p1.4.m4.1a"><mrow id="A1.SS3.SSS2.Px1.p1.4.m4.1.1" xref="A1.SS3.SSS2.Px1.p1.4.m4.1.1.cmml"><mn id="A1.SS3.SSS2.Px1.p1.4.m4.1.1.2" xref="A1.SS3.SSS2.Px1.p1.4.m4.1.1.2.cmml">1</mn><mo id="A1.SS3.SSS2.Px1.p1.4.m4.1.1.1" xref="A1.SS3.SSS2.Px1.p1.4.m4.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.SS3.SSS2.Px1.p1.4.m4.1b"><apply id="A1.SS3.SSS2.Px1.p1.4.m4.1.1.cmml" xref="A1.SS3.SSS2.Px1.p1.4.m4.1.1"><csymbol cd="latexml" id="A1.SS3.SSS2.Px1.p1.4.m4.1.1.1.cmml" xref="A1.SS3.SSS2.Px1.p1.4.m4.1.1.1">percent</csymbol><cn id="A1.SS3.SSS2.Px1.p1.4.m4.1.1.2.cmml" type="integer" xref="A1.SS3.SSS2.Px1.p1.4.m4.1.1.2">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.SSS2.Px1.p1.4.m4.1c">1\%</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.SSS2.Px1.p1.4.m4.1d">1 %</annotation></semantics></math> additional cost during training and less than <math alttext="3\%" class="ltx_Math" display="inline" id="A1.SS3.SSS2.Px1.p1.5.m5.1"><semantics id="A1.SS3.SSS2.Px1.p1.5.m5.1a"><mrow id="A1.SS3.SSS2.Px1.p1.5.m5.1.1" xref="A1.SS3.SSS2.Px1.p1.5.m5.1.1.cmml"><mn id="A1.SS3.SSS2.Px1.p1.5.m5.1.1.2" xref="A1.SS3.SSS2.Px1.p1.5.m5.1.1.2.cmml">3</mn><mo id="A1.SS3.SSS2.Px1.p1.5.m5.1.1.1" xref="A1.SS3.SSS2.Px1.p1.5.m5.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.SS3.SSS2.Px1.p1.5.m5.1b"><apply id="A1.SS3.SSS2.Px1.p1.5.m5.1.1.cmml" xref="A1.SS3.SSS2.Px1.p1.5.m5.1.1"><csymbol cd="latexml" id="A1.SS3.SSS2.Px1.p1.5.m5.1.1.1.cmml" xref="A1.SS3.SSS2.Px1.p1.5.m5.1.1.1">percent</csymbol><cn id="A1.SS3.SSS2.Px1.p1.5.m5.1.1.2.cmml" type="integer" xref="A1.SS3.SSS2.Px1.p1.5.m5.1.1.2">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.SSS2.Px1.p1.5.m5.1c">3\%</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.SSS2.Px1.p1.5.m5.1d">3 %</annotation></semantics></math> during inference. Furthermore, a <math alttext="335" class="ltx_Math" display="inline" id="A1.SS3.SSS2.Px1.p1.6.m6.1"><semantics id="A1.SS3.SSS2.Px1.p1.6.m6.1a"><mn id="A1.SS3.SSS2.Px1.p1.6.m6.1.1" xref="A1.SS3.SSS2.Px1.p1.6.m6.1.1.cmml">335</mn><annotation-xml encoding="MathML-Content" id="A1.SS3.SSS2.Px1.p1.6.m6.1b"><cn id="A1.SS3.SSS2.Px1.p1.6.m6.1.1.cmml" type="integer" xref="A1.SS3.SSS2.Px1.p1.6.m6.1.1">335</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.SSS2.Px1.p1.6.m6.1c">335</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.SSS2.Px1.p1.6.m6.1d">335</annotation></semantics></math>M parameter mixture of <math alttext="32" class="ltx_Math" display="inline" id="A1.SS3.SSS2.Px1.p1.7.m7.1"><semantics id="A1.SS3.SSS2.Px1.p1.7.m7.1a"><mn id="A1.SS3.SSS2.Px1.p1.7.m7.1.1" xref="A1.SS3.SSS2.Px1.p1.7.m7.1.1.cmml">32</mn><annotation-xml encoding="MathML-Content" id="A1.SS3.SSS2.Px1.p1.7.m7.1b"><cn id="A1.SS3.SSS2.Px1.p1.7.m7.1.1.cmml" type="integer" xref="A1.SS3.SSS2.Px1.p1.7.m7.1.1">32</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.SSS2.Px1.p1.7.m7.1c">32</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.SSS2.Px1.p1.7.m7.1d">32</annotation></semantics></math> experts reaches the same performance level as the <math alttext="1.3" class="ltx_Math" display="inline" id="A1.SS3.SSS2.Px1.p1.8.m8.1"><semantics id="A1.SS3.SSS2.Px1.p1.8.m8.1a"><mn id="A1.SS3.SSS2.Px1.p1.8.m8.1.1" xref="A1.SS3.SSS2.Px1.p1.8.m8.1.1.cmml">1.3</mn><annotation-xml encoding="MathML-Content" id="A1.SS3.SSS2.Px1.p1.8.m8.1b"><cn id="A1.SS3.SSS2.Px1.p1.8.m8.1.1.cmml" type="float" xref="A1.SS3.SSS2.Px1.p1.8.m8.1.1">1.3</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.SSS2.Px1.p1.8.m8.1c">1.3</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.SSS2.Px1.p1.8.m8.1d">1.3</annotation></semantics></math>B parameter model, but with a comparable training budget and <span class="ltx_text ltx_font_bold" id="A1.SS3.SSS2.Px1.p1.9.1">three times lower inference cost</span>.
Despite the <math alttext="335" class="ltx_Math" display="inline" id="A1.SS3.SSS2.Px1.p1.9.m9.1"><semantics id="A1.SS3.SSS2.Px1.p1.9.m9.1a"><mn id="A1.SS3.SSS2.Px1.p1.9.m9.1.1" xref="A1.SS3.SSS2.Px1.p1.9.m9.1.1.cmml">335</mn><annotation-xml encoding="MathML-Content" id="A1.SS3.SSS2.Px1.p1.9.m9.1b"><cn id="A1.SS3.SSS2.Px1.p1.9.m9.1.1.cmml" type="integer" xref="A1.SS3.SSS2.Px1.p1.9.m9.1.1">335</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.SSS2.Px1.p1.9.m9.1c">335</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.SSS2.Px1.p1.9.m9.1d">335</annotation></semantics></math>M parameter model incurring a higher percentage cost during inference, this computational overhead is not the definitive minimum necessary for effective routing: as detailed in §&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#S3.SS4" title="3.4 Routing analysis ‣ 3 Experiments ‣ No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_tag">3.4</span></a>, our results indicate that the routing overhead can be significantly reduced by utilizing smaller routers and shorter prefix sizes. This suggests that further reductions in computational costs, without compromising routing quality, are feasible and present a valuable direction for future research.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
</section>
</section>
<section class="ltx_subsection" id="A1.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.4 </span>Communication overhead</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="A1.SS4.p1">
<p class="ltx_p" id="A1.SS4.p1.2">In this section, we provide an estimate of the communication overhead involved in our model training compared to a dense baseline trained with standard distributed data parallelism. We quantify both the volume of data transmitted and the frequency of communication required during training. For simplicity of computation, we assume that all collective communications are bandwidth-optimal, meaning that the total number of bytes transferred per node is approximately <math alttext="2K" class="ltx_Math" display="inline" id="A1.SS4.p1.1.m1.1"><semantics id="A1.SS4.p1.1.m1.1a"><mrow id="A1.SS4.p1.1.m1.1.1" xref="A1.SS4.p1.1.m1.1.1.cmml"><mn id="A1.SS4.p1.1.m1.1.1.2" xref="A1.SS4.p1.1.m1.1.1.2.cmml">2</mn><mo id="A1.SS4.p1.1.m1.1.1.1" xref="A1.SS4.p1.1.m1.1.1.1.cmml">⁢</mo><mi id="A1.SS4.p1.1.m1.1.1.3" xref="A1.SS4.p1.1.m1.1.1.3.cmml">K</mi></mrow><annotation-xml encoding="MathML-Content" id="A1.SS4.p1.1.m1.1b"><apply id="A1.SS4.p1.1.m1.1.1.cmml" xref="A1.SS4.p1.1.m1.1.1"><times id="A1.SS4.p1.1.m1.1.1.1.cmml" xref="A1.SS4.p1.1.m1.1.1.1"></times><cn id="A1.SS4.p1.1.m1.1.1.2.cmml" type="integer" xref="A1.SS4.p1.1.m1.1.1.2">2</cn><ci id="A1.SS4.p1.1.m1.1.1.3.cmml" xref="A1.SS4.p1.1.m1.1.1.3">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS4.p1.1.m1.1c">2K</annotation><annotation encoding="application/x-llamapun" id="A1.SS4.p1.1.m1.1d">2 italic_K</annotation></semantics></math>, where <math alttext="K" class="ltx_Math" display="inline" id="A1.SS4.p1.2.m2.1"><semantics id="A1.SS4.p1.2.m2.1a"><mi id="A1.SS4.p1.2.m2.1.1" xref="A1.SS4.p1.2.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="A1.SS4.p1.2.m2.1b"><ci id="A1.SS4.p1.2.m2.1.1.cmml" xref="A1.SS4.p1.2.m2.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS4.p1.2.m2.1c">K</annotation><annotation encoding="application/x-llamapun" id="A1.SS4.p1.2.m2.1d">italic_K</annotation></semantics></math> is the size of the message <cite class="ltx_cite ltx_citemacro_citep">(Thakur et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#bib.bib49" title="">2005</a>; Patarasuk &amp; Yuan, <a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#bib.bib41" title="">2009</a>)</cite>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<section class="ltx_paragraph" id="A1.SS4.SSS0.Px1">
<h5 class="ltx_title ltx_title_paragraph">Mixture of LLMs</h5><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="A1.SS4.SSS0.Px1.p1">
<p class="ltx_p" id="A1.SS4.SSS0.Px1.p1.1">Every router performs all gather operation to share the loss on the dataset chunk approximately every <math alttext="T=45" class="ltx_Math" display="inline" id="A1.SS4.SSS0.Px1.p1.1.m1.1"><semantics id="A1.SS4.SSS0.Px1.p1.1.m1.1a"><mrow id="A1.SS4.SSS0.Px1.p1.1.m1.1.1" xref="A1.SS4.SSS0.Px1.p1.1.m1.1.1.cmml"><mi id="A1.SS4.SSS0.Px1.p1.1.m1.1.1.2" xref="A1.SS4.SSS0.Px1.p1.1.m1.1.1.2.cmml">T</mi><mo id="A1.SS4.SSS0.Px1.p1.1.m1.1.1.1" xref="A1.SS4.SSS0.Px1.p1.1.m1.1.1.1.cmml">=</mo><mn id="A1.SS4.SSS0.Px1.p1.1.m1.1.1.3" xref="A1.SS4.SSS0.Px1.p1.1.m1.1.1.3.cmml">45</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.SS4.SSS0.Px1.p1.1.m1.1b"><apply id="A1.SS4.SSS0.Px1.p1.1.m1.1.1.cmml" xref="A1.SS4.SSS0.Px1.p1.1.m1.1.1"><eq id="A1.SS4.SSS0.Px1.p1.1.m1.1.1.1.cmml" xref="A1.SS4.SSS0.Px1.p1.1.m1.1.1.1"></eq><ci id="A1.SS4.SSS0.Px1.p1.1.m1.1.1.2.cmml" xref="A1.SS4.SSS0.Px1.p1.1.m1.1.1.2">𝑇</ci><cn id="A1.SS4.SSS0.Px1.p1.1.m1.1.1.3.cmml" type="integer" xref="A1.SS4.SSS0.Px1.p1.1.m1.1.1.3">45</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS4.SSS0.Px1.p1.1.m1.1c">T=45</annotation><annotation encoding="application/x-llamapun" id="A1.SS4.SSS0.Px1.p1.1.m1.1d">italic_T = 45</annotation></semantics></math>M training tokens, as outlined in <a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#S3.SS2" title="3.2 Language Modeling Results ‣ 3 Experiments ‣ No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_tag">3.2</span></a>. This frequency was primarily determined by implementation specifics related to data storage.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="A1.SS4.SSS0.Px1.p2">
<p class="ltx_p" id="A1.SS4.SSS0.Px1.p2.1">We can define the number of tokens processed per step by a router as <math alttext="N_{\text{tokens\_per\_step}}" class="ltx_Math" display="inline" id="A1.SS4.SSS0.Px1.p2.1.m1.1"><semantics id="A1.SS4.SSS0.Px1.p2.1.m1.1a"><msub id="A1.SS4.SSS0.Px1.p2.1.m1.1.1" xref="A1.SS4.SSS0.Px1.p2.1.m1.1.1.cmml"><mi id="A1.SS4.SSS0.Px1.p2.1.m1.1.1.2" xref="A1.SS4.SSS0.Px1.p2.1.m1.1.1.2.cmml">N</mi><mtext id="A1.SS4.SSS0.Px1.p2.1.m1.1.1.3" xref="A1.SS4.SSS0.Px1.p2.1.m1.1.1.3a.cmml">tokens_per_step</mtext></msub><annotation-xml encoding="MathML-Content" id="A1.SS4.SSS0.Px1.p2.1.m1.1b"><apply id="A1.SS4.SSS0.Px1.p2.1.m1.1.1.cmml" xref="A1.SS4.SSS0.Px1.p2.1.m1.1.1"><csymbol cd="ambiguous" id="A1.SS4.SSS0.Px1.p2.1.m1.1.1.1.cmml" xref="A1.SS4.SSS0.Px1.p2.1.m1.1.1">subscript</csymbol><ci id="A1.SS4.SSS0.Px1.p2.1.m1.1.1.2.cmml" xref="A1.SS4.SSS0.Px1.p2.1.m1.1.1.2">𝑁</ci><ci id="A1.SS4.SSS0.Px1.p2.1.m1.1.1.3a.cmml" xref="A1.SS4.SSS0.Px1.p2.1.m1.1.1.3"><mtext id="A1.SS4.SSS0.Px1.p2.1.m1.1.1.3.cmml" mathsize="70%" xref="A1.SS4.SSS0.Px1.p2.1.m1.1.1.3">tokens_per_step</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS4.SSS0.Px1.p2.1.m1.1c">N_{\text{tokens\_per\_step}}</annotation><annotation encoding="application/x-llamapun" id="A1.SS4.SSS0.Px1.p2.1.m1.1d">italic_N start_POSTSUBSCRIPT tokens_per_step end_POSTSUBSCRIPT</annotation></semantics></math>, which can be calculated as:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equation ltx_eqn_table" id="A1.Ex26">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="N_{\text{tokens\_per\_step}}\leq S\times B_{r}" class="ltx_Math" display="block" id="A1.Ex26.m1.1"><semantics id="A1.Ex26.m1.1a"><mrow id="A1.Ex26.m1.1.1" xref="A1.Ex26.m1.1.1.cmml"><msub id="A1.Ex26.m1.1.1.2" xref="A1.Ex26.m1.1.1.2.cmml"><mi id="A1.Ex26.m1.1.1.2.2" xref="A1.Ex26.m1.1.1.2.2.cmml">N</mi><mtext id="A1.Ex26.m1.1.1.2.3" xref="A1.Ex26.m1.1.1.2.3a.cmml">tokens_per_step</mtext></msub><mo id="A1.Ex26.m1.1.1.1" xref="A1.Ex26.m1.1.1.1.cmml">≤</mo><mrow id="A1.Ex26.m1.1.1.3" xref="A1.Ex26.m1.1.1.3.cmml"><mi id="A1.Ex26.m1.1.1.3.2" xref="A1.Ex26.m1.1.1.3.2.cmml">S</mi><mo id="A1.Ex26.m1.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="A1.Ex26.m1.1.1.3.1.cmml">×</mo><msub id="A1.Ex26.m1.1.1.3.3" xref="A1.Ex26.m1.1.1.3.3.cmml"><mi id="A1.Ex26.m1.1.1.3.3.2" xref="A1.Ex26.m1.1.1.3.3.2.cmml">B</mi><mi id="A1.Ex26.m1.1.1.3.3.3" xref="A1.Ex26.m1.1.1.3.3.3.cmml">r</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex26.m1.1b"><apply id="A1.Ex26.m1.1.1.cmml" xref="A1.Ex26.m1.1.1"><leq id="A1.Ex26.m1.1.1.1.cmml" xref="A1.Ex26.m1.1.1.1"></leq><apply id="A1.Ex26.m1.1.1.2.cmml" xref="A1.Ex26.m1.1.1.2"><csymbol cd="ambiguous" id="A1.Ex26.m1.1.1.2.1.cmml" xref="A1.Ex26.m1.1.1.2">subscript</csymbol><ci id="A1.Ex26.m1.1.1.2.2.cmml" xref="A1.Ex26.m1.1.1.2.2">𝑁</ci><ci id="A1.Ex26.m1.1.1.2.3a.cmml" xref="A1.Ex26.m1.1.1.2.3"><mtext id="A1.Ex26.m1.1.1.2.3.cmml" mathsize="70%" xref="A1.Ex26.m1.1.1.2.3">tokens_per_step</mtext></ci></apply><apply id="A1.Ex26.m1.1.1.3.cmml" xref="A1.Ex26.m1.1.1.3"><times id="A1.Ex26.m1.1.1.3.1.cmml" xref="A1.Ex26.m1.1.1.3.1"></times><ci id="A1.Ex26.m1.1.1.3.2.cmml" xref="A1.Ex26.m1.1.1.3.2">𝑆</ci><apply id="A1.Ex26.m1.1.1.3.3.cmml" xref="A1.Ex26.m1.1.1.3.3"><csymbol cd="ambiguous" id="A1.Ex26.m1.1.1.3.3.1.cmml" xref="A1.Ex26.m1.1.1.3.3">subscript</csymbol><ci id="A1.Ex26.m1.1.1.3.3.2.cmml" xref="A1.Ex26.m1.1.1.3.3.2">𝐵</ci><ci id="A1.Ex26.m1.1.1.3.3.3.cmml" xref="A1.Ex26.m1.1.1.3.3.3">𝑟</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex26.m1.1c">N_{\text{tokens\_per\_step}}\leq S\times B_{r}</annotation><annotation encoding="application/x-llamapun" id="A1.Ex26.m1.1d">italic_N start_POSTSUBSCRIPT tokens_per_step end_POSTSUBSCRIPT ≤ italic_S × italic_B start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A1.SS4.SSS0.Px1.p2.2">This leads to the minimum number of steps between communications, <math alttext="N_{\text{steps\_per\_com}}" class="ltx_Math" display="inline" id="A1.SS4.SSS0.Px1.p2.2.m1.1"><semantics id="A1.SS4.SSS0.Px1.p2.2.m1.1a"><msub id="A1.SS4.SSS0.Px1.p2.2.m1.1.1" xref="A1.SS4.SSS0.Px1.p2.2.m1.1.1.cmml"><mi id="A1.SS4.SSS0.Px1.p2.2.m1.1.1.2" xref="A1.SS4.SSS0.Px1.p2.2.m1.1.1.2.cmml">N</mi><mtext id="A1.SS4.SSS0.Px1.p2.2.m1.1.1.3" xref="A1.SS4.SSS0.Px1.p2.2.m1.1.1.3a.cmml">steps_per_com</mtext></msub><annotation-xml encoding="MathML-Content" id="A1.SS4.SSS0.Px1.p2.2.m1.1b"><apply id="A1.SS4.SSS0.Px1.p2.2.m1.1.1.cmml" xref="A1.SS4.SSS0.Px1.p2.2.m1.1.1"><csymbol cd="ambiguous" id="A1.SS4.SSS0.Px1.p2.2.m1.1.1.1.cmml" xref="A1.SS4.SSS0.Px1.p2.2.m1.1.1">subscript</csymbol><ci id="A1.SS4.SSS0.Px1.p2.2.m1.1.1.2.cmml" xref="A1.SS4.SSS0.Px1.p2.2.m1.1.1.2">𝑁</ci><ci id="A1.SS4.SSS0.Px1.p2.2.m1.1.1.3a.cmml" xref="A1.SS4.SSS0.Px1.p2.2.m1.1.1.3"><mtext id="A1.SS4.SSS0.Px1.p2.2.m1.1.1.3.cmml" mathsize="70%" xref="A1.SS4.SSS0.Px1.p2.2.m1.1.1.3">steps_per_com</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS4.SSS0.Px1.p2.2.m1.1c">N_{\text{steps\_per\_com}}</annotation><annotation encoding="application/x-llamapun" id="A1.SS4.SSS0.Px1.p2.2.m1.1d">italic_N start_POSTSUBSCRIPT steps_per_com end_POSTSUBSCRIPT</annotation></semantics></math>, given by:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equation ltx_eqn_table" id="A1.Ex27">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="N_{\text{steps\_per\_com}}\geq\frac{T}{S\times B_{r}}" class="ltx_Math" display="block" id="A1.Ex27.m1.1"><semantics id="A1.Ex27.m1.1a"><mrow id="A1.Ex27.m1.1.1" xref="A1.Ex27.m1.1.1.cmml"><msub id="A1.Ex27.m1.1.1.2" xref="A1.Ex27.m1.1.1.2.cmml"><mi id="A1.Ex27.m1.1.1.2.2" xref="A1.Ex27.m1.1.1.2.2.cmml">N</mi><mtext id="A1.Ex27.m1.1.1.2.3" xref="A1.Ex27.m1.1.1.2.3a.cmml">steps_per_com</mtext></msub><mo id="A1.Ex27.m1.1.1.1" xref="A1.Ex27.m1.1.1.1.cmml">≥</mo><mfrac id="A1.Ex27.m1.1.1.3" xref="A1.Ex27.m1.1.1.3.cmml"><mi id="A1.Ex27.m1.1.1.3.2" xref="A1.Ex27.m1.1.1.3.2.cmml">T</mi><mrow id="A1.Ex27.m1.1.1.3.3" xref="A1.Ex27.m1.1.1.3.3.cmml"><mi id="A1.Ex27.m1.1.1.3.3.2" xref="A1.Ex27.m1.1.1.3.3.2.cmml">S</mi><mo id="A1.Ex27.m1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="A1.Ex27.m1.1.1.3.3.1.cmml">×</mo><msub id="A1.Ex27.m1.1.1.3.3.3" xref="A1.Ex27.m1.1.1.3.3.3.cmml"><mi id="A1.Ex27.m1.1.1.3.3.3.2" xref="A1.Ex27.m1.1.1.3.3.3.2.cmml">B</mi><mi id="A1.Ex27.m1.1.1.3.3.3.3" xref="A1.Ex27.m1.1.1.3.3.3.3.cmml">r</mi></msub></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex27.m1.1b"><apply id="A1.Ex27.m1.1.1.cmml" xref="A1.Ex27.m1.1.1"><geq id="A1.Ex27.m1.1.1.1.cmml" xref="A1.Ex27.m1.1.1.1"></geq><apply id="A1.Ex27.m1.1.1.2.cmml" xref="A1.Ex27.m1.1.1.2"><csymbol cd="ambiguous" id="A1.Ex27.m1.1.1.2.1.cmml" xref="A1.Ex27.m1.1.1.2">subscript</csymbol><ci id="A1.Ex27.m1.1.1.2.2.cmml" xref="A1.Ex27.m1.1.1.2.2">𝑁</ci><ci id="A1.Ex27.m1.1.1.2.3a.cmml" xref="A1.Ex27.m1.1.1.2.3"><mtext id="A1.Ex27.m1.1.1.2.3.cmml" mathsize="70%" xref="A1.Ex27.m1.1.1.2.3">steps_per_com</mtext></ci></apply><apply id="A1.Ex27.m1.1.1.3.cmml" xref="A1.Ex27.m1.1.1.3"><divide id="A1.Ex27.m1.1.1.3.1.cmml" xref="A1.Ex27.m1.1.1.3"></divide><ci id="A1.Ex27.m1.1.1.3.2.cmml" xref="A1.Ex27.m1.1.1.3.2">𝑇</ci><apply id="A1.Ex27.m1.1.1.3.3.cmml" xref="A1.Ex27.m1.1.1.3.3"><times id="A1.Ex27.m1.1.1.3.3.1.cmml" xref="A1.Ex27.m1.1.1.3.3.1"></times><ci id="A1.Ex27.m1.1.1.3.3.2.cmml" xref="A1.Ex27.m1.1.1.3.3.2">𝑆</ci><apply id="A1.Ex27.m1.1.1.3.3.3.cmml" xref="A1.Ex27.m1.1.1.3.3.3"><csymbol cd="ambiguous" id="A1.Ex27.m1.1.1.3.3.3.1.cmml" xref="A1.Ex27.m1.1.1.3.3.3">subscript</csymbol><ci id="A1.Ex27.m1.1.1.3.3.3.2.cmml" xref="A1.Ex27.m1.1.1.3.3.3.2">𝐵</ci><ci id="A1.Ex27.m1.1.1.3.3.3.3.cmml" xref="A1.Ex27.m1.1.1.3.3.3.3">𝑟</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex27.m1.1c">N_{\text{steps\_per\_com}}\geq\frac{T}{S\times B_{r}}</annotation><annotation encoding="application/x-llamapun" id="A1.Ex27.m1.1d">italic_N start_POSTSUBSCRIPT steps_per_com end_POSTSUBSCRIPT ≥ divide start_ARG italic_T end_ARG start_ARG italic_S × italic_B start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="A1.SS4.SSS0.Px1.p3">
<p class="ltx_p" id="A1.SS4.SSS0.Px1.p3.1">The maximum number of communication events, <math alttext="N_{\text{comm}}" class="ltx_Math" display="inline" id="A1.SS4.SSS0.Px1.p3.1.m1.1"><semantics id="A1.SS4.SSS0.Px1.p3.1.m1.1a"><msub id="A1.SS4.SSS0.Px1.p3.1.m1.1.1" xref="A1.SS4.SSS0.Px1.p3.1.m1.1.1.cmml"><mi id="A1.SS4.SSS0.Px1.p3.1.m1.1.1.2" xref="A1.SS4.SSS0.Px1.p3.1.m1.1.1.2.cmml">N</mi><mtext id="A1.SS4.SSS0.Px1.p3.1.m1.1.1.3" xref="A1.SS4.SSS0.Px1.p3.1.m1.1.1.3a.cmml">comm</mtext></msub><annotation-xml encoding="MathML-Content" id="A1.SS4.SSS0.Px1.p3.1.m1.1b"><apply id="A1.SS4.SSS0.Px1.p3.1.m1.1.1.cmml" xref="A1.SS4.SSS0.Px1.p3.1.m1.1.1"><csymbol cd="ambiguous" id="A1.SS4.SSS0.Px1.p3.1.m1.1.1.1.cmml" xref="A1.SS4.SSS0.Px1.p3.1.m1.1.1">subscript</csymbol><ci id="A1.SS4.SSS0.Px1.p3.1.m1.1.1.2.cmml" xref="A1.SS4.SSS0.Px1.p3.1.m1.1.1.2">𝑁</ci><ci id="A1.SS4.SSS0.Px1.p3.1.m1.1.1.3a.cmml" xref="A1.SS4.SSS0.Px1.p3.1.m1.1.1.3"><mtext id="A1.SS4.SSS0.Px1.p3.1.m1.1.1.3.cmml" mathsize="70%" xref="A1.SS4.SSS0.Px1.p3.1.m1.1.1.3">comm</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS4.SSS0.Px1.p3.1.m1.1c">N_{\text{comm}}</annotation><annotation encoding="application/x-llamapun" id="A1.SS4.SSS0.Px1.p3.1.m1.1d">italic_N start_POSTSUBSCRIPT comm end_POSTSUBSCRIPT</annotation></semantics></math>, during the router’s training can then be estimated as:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equation ltx_eqn_table" id="A1.Ex28">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="N_{\text{comm}}\leq\frac{N_{\text{steps\_router}}}{N_{\text{steps\_per\_comm}}%
}=\frac{N_{\text{steps\_router}}\times S\times B_{r}}{T}" class="ltx_Math" display="block" id="A1.Ex28.m1.1"><semantics id="A1.Ex28.m1.1a"><mrow id="A1.Ex28.m1.1.1" xref="A1.Ex28.m1.1.1.cmml"><msub id="A1.Ex28.m1.1.1.2" xref="A1.Ex28.m1.1.1.2.cmml"><mi id="A1.Ex28.m1.1.1.2.2" xref="A1.Ex28.m1.1.1.2.2.cmml">N</mi><mtext id="A1.Ex28.m1.1.1.2.3" xref="A1.Ex28.m1.1.1.2.3a.cmml">comm</mtext></msub><mo id="A1.Ex28.m1.1.1.3" xref="A1.Ex28.m1.1.1.3.cmml">≤</mo><mfrac id="A1.Ex28.m1.1.1.4" xref="A1.Ex28.m1.1.1.4.cmml"><msub id="A1.Ex28.m1.1.1.4.2" xref="A1.Ex28.m1.1.1.4.2.cmml"><mi id="A1.Ex28.m1.1.1.4.2.2" xref="A1.Ex28.m1.1.1.4.2.2.cmml">N</mi><mtext id="A1.Ex28.m1.1.1.4.2.3" xref="A1.Ex28.m1.1.1.4.2.3a.cmml">steps_router</mtext></msub><msub id="A1.Ex28.m1.1.1.4.3" xref="A1.Ex28.m1.1.1.4.3.cmml"><mi id="A1.Ex28.m1.1.1.4.3.2" xref="A1.Ex28.m1.1.1.4.3.2.cmml">N</mi><mtext id="A1.Ex28.m1.1.1.4.3.3" xref="A1.Ex28.m1.1.1.4.3.3a.cmml">steps_per_comm</mtext></msub></mfrac><mo id="A1.Ex28.m1.1.1.5" xref="A1.Ex28.m1.1.1.5.cmml">=</mo><mfrac id="A1.Ex28.m1.1.1.6" xref="A1.Ex28.m1.1.1.6.cmml"><mrow id="A1.Ex28.m1.1.1.6.2" xref="A1.Ex28.m1.1.1.6.2.cmml"><msub id="A1.Ex28.m1.1.1.6.2.2" xref="A1.Ex28.m1.1.1.6.2.2.cmml"><mi id="A1.Ex28.m1.1.1.6.2.2.2" xref="A1.Ex28.m1.1.1.6.2.2.2.cmml">N</mi><mtext id="A1.Ex28.m1.1.1.6.2.2.3" xref="A1.Ex28.m1.1.1.6.2.2.3a.cmml">steps_router</mtext></msub><mo id="A1.Ex28.m1.1.1.6.2.1" lspace="0.222em" rspace="0.222em" xref="A1.Ex28.m1.1.1.6.2.1.cmml">×</mo><mi id="A1.Ex28.m1.1.1.6.2.3" xref="A1.Ex28.m1.1.1.6.2.3.cmml">S</mi><mo id="A1.Ex28.m1.1.1.6.2.1a" lspace="0.222em" rspace="0.222em" xref="A1.Ex28.m1.1.1.6.2.1.cmml">×</mo><msub id="A1.Ex28.m1.1.1.6.2.4" xref="A1.Ex28.m1.1.1.6.2.4.cmml"><mi id="A1.Ex28.m1.1.1.6.2.4.2" xref="A1.Ex28.m1.1.1.6.2.4.2.cmml">B</mi><mi id="A1.Ex28.m1.1.1.6.2.4.3" xref="A1.Ex28.m1.1.1.6.2.4.3.cmml">r</mi></msub></mrow><mi id="A1.Ex28.m1.1.1.6.3" xref="A1.Ex28.m1.1.1.6.3.cmml">T</mi></mfrac></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex28.m1.1b"><apply id="A1.Ex28.m1.1.1.cmml" xref="A1.Ex28.m1.1.1"><and id="A1.Ex28.m1.1.1a.cmml" xref="A1.Ex28.m1.1.1"></and><apply id="A1.Ex28.m1.1.1b.cmml" xref="A1.Ex28.m1.1.1"><leq id="A1.Ex28.m1.1.1.3.cmml" xref="A1.Ex28.m1.1.1.3"></leq><apply id="A1.Ex28.m1.1.1.2.cmml" xref="A1.Ex28.m1.1.1.2"><csymbol cd="ambiguous" id="A1.Ex28.m1.1.1.2.1.cmml" xref="A1.Ex28.m1.1.1.2">subscript</csymbol><ci id="A1.Ex28.m1.1.1.2.2.cmml" xref="A1.Ex28.m1.1.1.2.2">𝑁</ci><ci id="A1.Ex28.m1.1.1.2.3a.cmml" xref="A1.Ex28.m1.1.1.2.3"><mtext id="A1.Ex28.m1.1.1.2.3.cmml" mathsize="70%" xref="A1.Ex28.m1.1.1.2.3">comm</mtext></ci></apply><apply id="A1.Ex28.m1.1.1.4.cmml" xref="A1.Ex28.m1.1.1.4"><divide id="A1.Ex28.m1.1.1.4.1.cmml" xref="A1.Ex28.m1.1.1.4"></divide><apply id="A1.Ex28.m1.1.1.4.2.cmml" xref="A1.Ex28.m1.1.1.4.2"><csymbol cd="ambiguous" id="A1.Ex28.m1.1.1.4.2.1.cmml" xref="A1.Ex28.m1.1.1.4.2">subscript</csymbol><ci id="A1.Ex28.m1.1.1.4.2.2.cmml" xref="A1.Ex28.m1.1.1.4.2.2">𝑁</ci><ci id="A1.Ex28.m1.1.1.4.2.3a.cmml" xref="A1.Ex28.m1.1.1.4.2.3"><mtext id="A1.Ex28.m1.1.1.4.2.3.cmml" mathsize="70%" xref="A1.Ex28.m1.1.1.4.2.3">steps_router</mtext></ci></apply><apply id="A1.Ex28.m1.1.1.4.3.cmml" xref="A1.Ex28.m1.1.1.4.3"><csymbol cd="ambiguous" id="A1.Ex28.m1.1.1.4.3.1.cmml" xref="A1.Ex28.m1.1.1.4.3">subscript</csymbol><ci id="A1.Ex28.m1.1.1.4.3.2.cmml" xref="A1.Ex28.m1.1.1.4.3.2">𝑁</ci><ci id="A1.Ex28.m1.1.1.4.3.3a.cmml" xref="A1.Ex28.m1.1.1.4.3.3"><mtext id="A1.Ex28.m1.1.1.4.3.3.cmml" mathsize="70%" xref="A1.Ex28.m1.1.1.4.3.3">steps_per_comm</mtext></ci></apply></apply></apply><apply id="A1.Ex28.m1.1.1c.cmml" xref="A1.Ex28.m1.1.1"><eq id="A1.Ex28.m1.1.1.5.cmml" xref="A1.Ex28.m1.1.1.5"></eq><share href="https://arxiv.org/html/2410.03529v1#A1.Ex28.m1.1.1.4.cmml" id="A1.Ex28.m1.1.1d.cmml" xref="A1.Ex28.m1.1.1"></share><apply id="A1.Ex28.m1.1.1.6.cmml" xref="A1.Ex28.m1.1.1.6"><divide id="A1.Ex28.m1.1.1.6.1.cmml" xref="A1.Ex28.m1.1.1.6"></divide><apply id="A1.Ex28.m1.1.1.6.2.cmml" xref="A1.Ex28.m1.1.1.6.2"><times id="A1.Ex28.m1.1.1.6.2.1.cmml" xref="A1.Ex28.m1.1.1.6.2.1"></times><apply id="A1.Ex28.m1.1.1.6.2.2.cmml" xref="A1.Ex28.m1.1.1.6.2.2"><csymbol cd="ambiguous" id="A1.Ex28.m1.1.1.6.2.2.1.cmml" xref="A1.Ex28.m1.1.1.6.2.2">subscript</csymbol><ci id="A1.Ex28.m1.1.1.6.2.2.2.cmml" xref="A1.Ex28.m1.1.1.6.2.2.2">𝑁</ci><ci id="A1.Ex28.m1.1.1.6.2.2.3a.cmml" xref="A1.Ex28.m1.1.1.6.2.2.3"><mtext id="A1.Ex28.m1.1.1.6.2.2.3.cmml" mathsize="70%" xref="A1.Ex28.m1.1.1.6.2.2.3">steps_router</mtext></ci></apply><ci id="A1.Ex28.m1.1.1.6.2.3.cmml" xref="A1.Ex28.m1.1.1.6.2.3">𝑆</ci><apply id="A1.Ex28.m1.1.1.6.2.4.cmml" xref="A1.Ex28.m1.1.1.6.2.4"><csymbol cd="ambiguous" id="A1.Ex28.m1.1.1.6.2.4.1.cmml" xref="A1.Ex28.m1.1.1.6.2.4">subscript</csymbol><ci id="A1.Ex28.m1.1.1.6.2.4.2.cmml" xref="A1.Ex28.m1.1.1.6.2.4.2">𝐵</ci><ci id="A1.Ex28.m1.1.1.6.2.4.3.cmml" xref="A1.Ex28.m1.1.1.6.2.4.3">𝑟</ci></apply></apply><ci id="A1.Ex28.m1.1.1.6.3.cmml" xref="A1.Ex28.m1.1.1.6.3">𝑇</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex28.m1.1c">N_{\text{comm}}\leq\frac{N_{\text{steps\_router}}}{N_{\text{steps\_per\_comm}}%
}=\frac{N_{\text{steps\_router}}\times S\times B_{r}}{T}</annotation><annotation encoding="application/x-llamapun" id="A1.Ex28.m1.1d">italic_N start_POSTSUBSCRIPT comm end_POSTSUBSCRIPT ≤ divide start_ARG italic_N start_POSTSUBSCRIPT steps_router end_POSTSUBSCRIPT end_ARG start_ARG italic_N start_POSTSUBSCRIPT steps_per_comm end_POSTSUBSCRIPT end_ARG = divide start_ARG italic_N start_POSTSUBSCRIPT steps_router end_POSTSUBSCRIPT × italic_S × italic_B start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT end_ARG start_ARG italic_T end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="A1.SS4.SSS0.Px1.p4">
<p class="ltx_p" id="A1.SS4.SSS0.Px1.p4.4">As shown in App. Table <a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#A1.T2" title="Table 2 ‣ A.1 Architecture and training details ‣ Appendix A Language modeling experiments ‣ No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_tag">2</span></a> we train routers for <math alttext="128,000" class="ltx_Math" display="inline" id="A1.SS4.SSS0.Px1.p4.1.m1.2"><semantics id="A1.SS4.SSS0.Px1.p4.1.m1.2a"><mrow id="A1.SS4.SSS0.Px1.p4.1.m1.2.3.2" xref="A1.SS4.SSS0.Px1.p4.1.m1.2.3.1.cmml"><mn id="A1.SS4.SSS0.Px1.p4.1.m1.1.1" xref="A1.SS4.SSS0.Px1.p4.1.m1.1.1.cmml">128</mn><mo id="A1.SS4.SSS0.Px1.p4.1.m1.2.3.2.1" xref="A1.SS4.SSS0.Px1.p4.1.m1.2.3.1.cmml">,</mo><mn id="A1.SS4.SSS0.Px1.p4.1.m1.2.2" xref="A1.SS4.SSS0.Px1.p4.1.m1.2.2.cmml">000</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.SS4.SSS0.Px1.p4.1.m1.2b"><list id="A1.SS4.SSS0.Px1.p4.1.m1.2.3.1.cmml" xref="A1.SS4.SSS0.Px1.p4.1.m1.2.3.2"><cn id="A1.SS4.SSS0.Px1.p4.1.m1.1.1.cmml" type="integer" xref="A1.SS4.SSS0.Px1.p4.1.m1.1.1">128</cn><cn id="A1.SS4.SSS0.Px1.p4.1.m1.2.2.cmml" type="integer" xref="A1.SS4.SSS0.Px1.p4.1.m1.2.2">000</cn></list></annotation-xml><annotation encoding="application/x-tex" id="A1.SS4.SSS0.Px1.p4.1.m1.2c">128,000</annotation><annotation encoding="application/x-llamapun" id="A1.SS4.SSS0.Px1.p4.1.m1.2d">128 , 000</annotation></semantics></math> steps with batch size <math alttext="32" class="ltx_Math" display="inline" id="A1.SS4.SSS0.Px1.p4.2.m2.1"><semantics id="A1.SS4.SSS0.Px1.p4.2.m2.1a"><mn id="A1.SS4.SSS0.Px1.p4.2.m2.1.1" xref="A1.SS4.SSS0.Px1.p4.2.m2.1.1.cmml">32</mn><annotation-xml encoding="MathML-Content" id="A1.SS4.SSS0.Px1.p4.2.m2.1b"><cn id="A1.SS4.SSS0.Px1.p4.2.m2.1.1.cmml" type="integer" xref="A1.SS4.SSS0.Px1.p4.2.m2.1.1">32</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS4.SSS0.Px1.p4.2.m2.1c">32</annotation><annotation encoding="application/x-llamapun" id="A1.SS4.SSS0.Px1.p4.2.m2.1d">32</annotation></semantics></math>. We use context size <math alttext="1024" class="ltx_Math" display="inline" id="A1.SS4.SSS0.Px1.p4.3.m3.1"><semantics id="A1.SS4.SSS0.Px1.p4.3.m3.1a"><mn id="A1.SS4.SSS0.Px1.p4.3.m3.1.1" xref="A1.SS4.SSS0.Px1.p4.3.m3.1.1.cmml">1024</mn><annotation-xml encoding="MathML-Content" id="A1.SS4.SSS0.Px1.p4.3.m3.1b"><cn id="A1.SS4.SSS0.Px1.p4.3.m3.1.1.cmml" type="integer" xref="A1.SS4.SSS0.Px1.p4.3.m3.1.1">1024</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS4.SSS0.Px1.p4.3.m3.1c">1024</annotation><annotation encoding="application/x-llamapun" id="A1.SS4.SSS0.Px1.p4.3.m3.1d">1024</annotation></semantics></math>. Therefore,
<math alttext="N_{\text{comm}}\approx 94<1\times 10^{2}" class="ltx_Math" display="inline" id="A1.SS4.SSS0.Px1.p4.4.m4.1"><semantics id="A1.SS4.SSS0.Px1.p4.4.m4.1a"><mrow id="A1.SS4.SSS0.Px1.p4.4.m4.1.1" xref="A1.SS4.SSS0.Px1.p4.4.m4.1.1.cmml"><msub id="A1.SS4.SSS0.Px1.p4.4.m4.1.1.2" xref="A1.SS4.SSS0.Px1.p4.4.m4.1.1.2.cmml"><mi id="A1.SS4.SSS0.Px1.p4.4.m4.1.1.2.2" xref="A1.SS4.SSS0.Px1.p4.4.m4.1.1.2.2.cmml">N</mi><mtext id="A1.SS4.SSS0.Px1.p4.4.m4.1.1.2.3" xref="A1.SS4.SSS0.Px1.p4.4.m4.1.1.2.3a.cmml">comm</mtext></msub><mo id="A1.SS4.SSS0.Px1.p4.4.m4.1.1.3" xref="A1.SS4.SSS0.Px1.p4.4.m4.1.1.3.cmml">≈</mo><mn id="A1.SS4.SSS0.Px1.p4.4.m4.1.1.4" xref="A1.SS4.SSS0.Px1.p4.4.m4.1.1.4.cmml">94</mn><mo id="A1.SS4.SSS0.Px1.p4.4.m4.1.1.5" xref="A1.SS4.SSS0.Px1.p4.4.m4.1.1.5.cmml">&lt;</mo><mrow id="A1.SS4.SSS0.Px1.p4.4.m4.1.1.6" xref="A1.SS4.SSS0.Px1.p4.4.m4.1.1.6.cmml"><mn id="A1.SS4.SSS0.Px1.p4.4.m4.1.1.6.2" xref="A1.SS4.SSS0.Px1.p4.4.m4.1.1.6.2.cmml">1</mn><mo id="A1.SS4.SSS0.Px1.p4.4.m4.1.1.6.1" lspace="0.222em" rspace="0.222em" xref="A1.SS4.SSS0.Px1.p4.4.m4.1.1.6.1.cmml">×</mo><msup id="A1.SS4.SSS0.Px1.p4.4.m4.1.1.6.3" xref="A1.SS4.SSS0.Px1.p4.4.m4.1.1.6.3.cmml"><mn id="A1.SS4.SSS0.Px1.p4.4.m4.1.1.6.3.2" xref="A1.SS4.SSS0.Px1.p4.4.m4.1.1.6.3.2.cmml">10</mn><mn id="A1.SS4.SSS0.Px1.p4.4.m4.1.1.6.3.3" xref="A1.SS4.SSS0.Px1.p4.4.m4.1.1.6.3.3.cmml">2</mn></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS4.SSS0.Px1.p4.4.m4.1b"><apply id="A1.SS4.SSS0.Px1.p4.4.m4.1.1.cmml" xref="A1.SS4.SSS0.Px1.p4.4.m4.1.1"><and id="A1.SS4.SSS0.Px1.p4.4.m4.1.1a.cmml" xref="A1.SS4.SSS0.Px1.p4.4.m4.1.1"></and><apply id="A1.SS4.SSS0.Px1.p4.4.m4.1.1b.cmml" xref="A1.SS4.SSS0.Px1.p4.4.m4.1.1"><approx id="A1.SS4.SSS0.Px1.p4.4.m4.1.1.3.cmml" xref="A1.SS4.SSS0.Px1.p4.4.m4.1.1.3"></approx><apply id="A1.SS4.SSS0.Px1.p4.4.m4.1.1.2.cmml" xref="A1.SS4.SSS0.Px1.p4.4.m4.1.1.2"><csymbol cd="ambiguous" id="A1.SS4.SSS0.Px1.p4.4.m4.1.1.2.1.cmml" xref="A1.SS4.SSS0.Px1.p4.4.m4.1.1.2">subscript</csymbol><ci id="A1.SS4.SSS0.Px1.p4.4.m4.1.1.2.2.cmml" xref="A1.SS4.SSS0.Px1.p4.4.m4.1.1.2.2">𝑁</ci><ci id="A1.SS4.SSS0.Px1.p4.4.m4.1.1.2.3a.cmml" xref="A1.SS4.SSS0.Px1.p4.4.m4.1.1.2.3"><mtext id="A1.SS4.SSS0.Px1.p4.4.m4.1.1.2.3.cmml" mathsize="70%" xref="A1.SS4.SSS0.Px1.p4.4.m4.1.1.2.3">comm</mtext></ci></apply><cn id="A1.SS4.SSS0.Px1.p4.4.m4.1.1.4.cmml" type="integer" xref="A1.SS4.SSS0.Px1.p4.4.m4.1.1.4">94</cn></apply><apply id="A1.SS4.SSS0.Px1.p4.4.m4.1.1c.cmml" xref="A1.SS4.SSS0.Px1.p4.4.m4.1.1"><lt id="A1.SS4.SSS0.Px1.p4.4.m4.1.1.5.cmml" xref="A1.SS4.SSS0.Px1.p4.4.m4.1.1.5"></lt><share href="https://arxiv.org/html/2410.03529v1#A1.SS4.SSS0.Px1.p4.4.m4.1.1.4.cmml" id="A1.SS4.SSS0.Px1.p4.4.m4.1.1d.cmml" xref="A1.SS4.SSS0.Px1.p4.4.m4.1.1"></share><apply id="A1.SS4.SSS0.Px1.p4.4.m4.1.1.6.cmml" xref="A1.SS4.SSS0.Px1.p4.4.m4.1.1.6"><times id="A1.SS4.SSS0.Px1.p4.4.m4.1.1.6.1.cmml" xref="A1.SS4.SSS0.Px1.p4.4.m4.1.1.6.1"></times><cn id="A1.SS4.SSS0.Px1.p4.4.m4.1.1.6.2.cmml" type="integer" xref="A1.SS4.SSS0.Px1.p4.4.m4.1.1.6.2">1</cn><apply id="A1.SS4.SSS0.Px1.p4.4.m4.1.1.6.3.cmml" xref="A1.SS4.SSS0.Px1.p4.4.m4.1.1.6.3"><csymbol cd="ambiguous" id="A1.SS4.SSS0.Px1.p4.4.m4.1.1.6.3.1.cmml" xref="A1.SS4.SSS0.Px1.p4.4.m4.1.1.6.3">superscript</csymbol><cn id="A1.SS4.SSS0.Px1.p4.4.m4.1.1.6.3.2.cmml" type="integer" xref="A1.SS4.SSS0.Px1.p4.4.m4.1.1.6.3.2">10</cn><cn id="A1.SS4.SSS0.Px1.p4.4.m4.1.1.6.3.3.cmml" type="integer" xref="A1.SS4.SSS0.Px1.p4.4.m4.1.1.6.3.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS4.SSS0.Px1.p4.4.m4.1c">N_{\text{comm}}\approx 94&lt;1\times 10^{2}</annotation><annotation encoding="application/x-llamapun" id="A1.SS4.SSS0.Px1.p4.4.m4.1d">italic_N start_POSTSUBSCRIPT comm end_POSTSUBSCRIPT ≈ 94 &lt; 1 × 10 start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="A1.SS4.SSS0.Px1.p5">
<p class="ltx_p" id="A1.SS4.SSS0.Px1.p5.2">The total amount of data sent and received by each node (router) can be calculated as the total number of sequences multiplied by the number of bytes per sequence. We consider that the loss is transferred in <span class="ltx_text ltx_font_typewriter" id="A1.SS4.SSS0.Px1.p5.2.1">float16</span>, which requires <math alttext="2" class="ltx_Math" display="inline" id="A1.SS4.SSS0.Px1.p5.1.m1.1"><semantics id="A1.SS4.SSS0.Px1.p5.1.m1.1a"><mn id="A1.SS4.SSS0.Px1.p5.1.m1.1.1" xref="A1.SS4.SSS0.Px1.p5.1.m1.1.1.cmml">2</mn><annotation-xml encoding="MathML-Content" id="A1.SS4.SSS0.Px1.p5.1.m1.1b"><cn id="A1.SS4.SSS0.Px1.p5.1.m1.1.1.cmml" type="integer" xref="A1.SS4.SSS0.Px1.p5.1.m1.1.1">2</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS4.SSS0.Px1.p5.1.m1.1c">2</annotation><annotation encoding="application/x-llamapun" id="A1.SS4.SSS0.Px1.p5.1.m1.1d">2</annotation></semantics></math> bytes per element. The total number of sequences can be estimated as <math alttext="\frac{T\times N}{S}" class="ltx_Math" display="inline" id="A1.SS4.SSS0.Px1.p5.2.m2.1"><semantics id="A1.SS4.SSS0.Px1.p5.2.m2.1a"><mfrac id="A1.SS4.SSS0.Px1.p5.2.m2.1.1" xref="A1.SS4.SSS0.Px1.p5.2.m2.1.1.cmml"><mrow id="A1.SS4.SSS0.Px1.p5.2.m2.1.1.2" xref="A1.SS4.SSS0.Px1.p5.2.m2.1.1.2.cmml"><mi id="A1.SS4.SSS0.Px1.p5.2.m2.1.1.2.2" xref="A1.SS4.SSS0.Px1.p5.2.m2.1.1.2.2.cmml">T</mi><mo id="A1.SS4.SSS0.Px1.p5.2.m2.1.1.2.1" lspace="0.222em" rspace="0.222em" xref="A1.SS4.SSS0.Px1.p5.2.m2.1.1.2.1.cmml">×</mo><mi id="A1.SS4.SSS0.Px1.p5.2.m2.1.1.2.3" xref="A1.SS4.SSS0.Px1.p5.2.m2.1.1.2.3.cmml">N</mi></mrow><mi id="A1.SS4.SSS0.Px1.p5.2.m2.1.1.3" xref="A1.SS4.SSS0.Px1.p5.2.m2.1.1.3.cmml">S</mi></mfrac><annotation-xml encoding="MathML-Content" id="A1.SS4.SSS0.Px1.p5.2.m2.1b"><apply id="A1.SS4.SSS0.Px1.p5.2.m2.1.1.cmml" xref="A1.SS4.SSS0.Px1.p5.2.m2.1.1"><divide id="A1.SS4.SSS0.Px1.p5.2.m2.1.1.1.cmml" xref="A1.SS4.SSS0.Px1.p5.2.m2.1.1"></divide><apply id="A1.SS4.SSS0.Px1.p5.2.m2.1.1.2.cmml" xref="A1.SS4.SSS0.Px1.p5.2.m2.1.1.2"><times id="A1.SS4.SSS0.Px1.p5.2.m2.1.1.2.1.cmml" xref="A1.SS4.SSS0.Px1.p5.2.m2.1.1.2.1"></times><ci id="A1.SS4.SSS0.Px1.p5.2.m2.1.1.2.2.cmml" xref="A1.SS4.SSS0.Px1.p5.2.m2.1.1.2.2">𝑇</ci><ci id="A1.SS4.SSS0.Px1.p5.2.m2.1.1.2.3.cmml" xref="A1.SS4.SSS0.Px1.p5.2.m2.1.1.2.3">𝑁</ci></apply><ci id="A1.SS4.SSS0.Px1.p5.2.m2.1.1.3.cmml" xref="A1.SS4.SSS0.Px1.p5.2.m2.1.1.3">𝑆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS4.SSS0.Px1.p5.2.m2.1c">\frac{T\times N}{S}</annotation><annotation encoding="application/x-llamapun" id="A1.SS4.SSS0.Px1.p5.2.m2.1d">divide start_ARG italic_T × italic_N end_ARG start_ARG italic_S end_ARG</annotation></semantics></math>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="A1.SS4.SSS0.Px1.p6">
<p class="ltx_p" id="A1.SS4.SSS0.Px1.p6.1">Each router needs to send and receive the loss values for each sequence to and from other routers, resulting in a factor of 2 for the data sent and received. Therefore, the data per router can be approximated as:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equation ltx_eqn_table" id="A1.Ex29">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\text{Data per router}\approx 2\times 2\times\frac{T\times E}{S}" class="ltx_Math" display="block" id="A1.Ex29.m1.1"><semantics id="A1.Ex29.m1.1a"><mrow id="A1.Ex29.m1.1.1" xref="A1.Ex29.m1.1.1.cmml"><mtext id="A1.Ex29.m1.1.1.2" xref="A1.Ex29.m1.1.1.2a.cmml">Data per router</mtext><mo id="A1.Ex29.m1.1.1.1" xref="A1.Ex29.m1.1.1.1.cmml">≈</mo><mrow id="A1.Ex29.m1.1.1.3" xref="A1.Ex29.m1.1.1.3.cmml"><mn id="A1.Ex29.m1.1.1.3.2" xref="A1.Ex29.m1.1.1.3.2.cmml">2</mn><mo id="A1.Ex29.m1.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="A1.Ex29.m1.1.1.3.1.cmml">×</mo><mn id="A1.Ex29.m1.1.1.3.3" xref="A1.Ex29.m1.1.1.3.3.cmml">2</mn><mo id="A1.Ex29.m1.1.1.3.1a" lspace="0.222em" rspace="0.222em" xref="A1.Ex29.m1.1.1.3.1.cmml">×</mo><mfrac id="A1.Ex29.m1.1.1.3.4" xref="A1.Ex29.m1.1.1.3.4.cmml"><mrow id="A1.Ex29.m1.1.1.3.4.2" xref="A1.Ex29.m1.1.1.3.4.2.cmml"><mi id="A1.Ex29.m1.1.1.3.4.2.2" xref="A1.Ex29.m1.1.1.3.4.2.2.cmml">T</mi><mo id="A1.Ex29.m1.1.1.3.4.2.1" lspace="0.222em" rspace="0.222em" xref="A1.Ex29.m1.1.1.3.4.2.1.cmml">×</mo><mi id="A1.Ex29.m1.1.1.3.4.2.3" xref="A1.Ex29.m1.1.1.3.4.2.3.cmml">E</mi></mrow><mi id="A1.Ex29.m1.1.1.3.4.3" xref="A1.Ex29.m1.1.1.3.4.3.cmml">S</mi></mfrac></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex29.m1.1b"><apply id="A1.Ex29.m1.1.1.cmml" xref="A1.Ex29.m1.1.1"><approx id="A1.Ex29.m1.1.1.1.cmml" xref="A1.Ex29.m1.1.1.1"></approx><ci id="A1.Ex29.m1.1.1.2a.cmml" xref="A1.Ex29.m1.1.1.2"><mtext id="A1.Ex29.m1.1.1.2.cmml" xref="A1.Ex29.m1.1.1.2">Data per router</mtext></ci><apply id="A1.Ex29.m1.1.1.3.cmml" xref="A1.Ex29.m1.1.1.3"><times id="A1.Ex29.m1.1.1.3.1.cmml" xref="A1.Ex29.m1.1.1.3.1"></times><cn id="A1.Ex29.m1.1.1.3.2.cmml" type="integer" xref="A1.Ex29.m1.1.1.3.2">2</cn><cn id="A1.Ex29.m1.1.1.3.3.cmml" type="integer" xref="A1.Ex29.m1.1.1.3.3">2</cn><apply id="A1.Ex29.m1.1.1.3.4.cmml" xref="A1.Ex29.m1.1.1.3.4"><divide id="A1.Ex29.m1.1.1.3.4.1.cmml" xref="A1.Ex29.m1.1.1.3.4"></divide><apply id="A1.Ex29.m1.1.1.3.4.2.cmml" xref="A1.Ex29.m1.1.1.3.4.2"><times id="A1.Ex29.m1.1.1.3.4.2.1.cmml" xref="A1.Ex29.m1.1.1.3.4.2.1"></times><ci id="A1.Ex29.m1.1.1.3.4.2.2.cmml" xref="A1.Ex29.m1.1.1.3.4.2.2">𝑇</ci><ci id="A1.Ex29.m1.1.1.3.4.2.3.cmml" xref="A1.Ex29.m1.1.1.3.4.2.3">𝐸</ci></apply><ci id="A1.Ex29.m1.1.1.3.4.3.cmml" xref="A1.Ex29.m1.1.1.3.4.3">𝑆</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex29.m1.1c">\text{Data per router}\approx 2\times 2\times\frac{T\times E}{S}</annotation><annotation encoding="application/x-llamapun" id="A1.Ex29.m1.1d">Data per router ≈ 2 × 2 × divide start_ARG italic_T × italic_E end_ARG start_ARG italic_S end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="A1.SS4.SSS0.Px1.p7">
<p class="ltx_p" id="A1.SS4.SSS0.Px1.p7.3">Given <math alttext="T=45\times 10^{6}" class="ltx_Math" display="inline" id="A1.SS4.SSS0.Px1.p7.1.m1.1"><semantics id="A1.SS4.SSS0.Px1.p7.1.m1.1a"><mrow id="A1.SS4.SSS0.Px1.p7.1.m1.1.1" xref="A1.SS4.SSS0.Px1.p7.1.m1.1.1.cmml"><mi id="A1.SS4.SSS0.Px1.p7.1.m1.1.1.2" xref="A1.SS4.SSS0.Px1.p7.1.m1.1.1.2.cmml">T</mi><mo id="A1.SS4.SSS0.Px1.p7.1.m1.1.1.1" xref="A1.SS4.SSS0.Px1.p7.1.m1.1.1.1.cmml">=</mo><mrow id="A1.SS4.SSS0.Px1.p7.1.m1.1.1.3" xref="A1.SS4.SSS0.Px1.p7.1.m1.1.1.3.cmml"><mn id="A1.SS4.SSS0.Px1.p7.1.m1.1.1.3.2" xref="A1.SS4.SSS0.Px1.p7.1.m1.1.1.3.2.cmml">45</mn><mo id="A1.SS4.SSS0.Px1.p7.1.m1.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="A1.SS4.SSS0.Px1.p7.1.m1.1.1.3.1.cmml">×</mo><msup id="A1.SS4.SSS0.Px1.p7.1.m1.1.1.3.3" xref="A1.SS4.SSS0.Px1.p7.1.m1.1.1.3.3.cmml"><mn id="A1.SS4.SSS0.Px1.p7.1.m1.1.1.3.3.2" xref="A1.SS4.SSS0.Px1.p7.1.m1.1.1.3.3.2.cmml">10</mn><mn id="A1.SS4.SSS0.Px1.p7.1.m1.1.1.3.3.3" xref="A1.SS4.SSS0.Px1.p7.1.m1.1.1.3.3.3.cmml">6</mn></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS4.SSS0.Px1.p7.1.m1.1b"><apply id="A1.SS4.SSS0.Px1.p7.1.m1.1.1.cmml" xref="A1.SS4.SSS0.Px1.p7.1.m1.1.1"><eq id="A1.SS4.SSS0.Px1.p7.1.m1.1.1.1.cmml" xref="A1.SS4.SSS0.Px1.p7.1.m1.1.1.1"></eq><ci id="A1.SS4.SSS0.Px1.p7.1.m1.1.1.2.cmml" xref="A1.SS4.SSS0.Px1.p7.1.m1.1.1.2">𝑇</ci><apply id="A1.SS4.SSS0.Px1.p7.1.m1.1.1.3.cmml" xref="A1.SS4.SSS0.Px1.p7.1.m1.1.1.3"><times id="A1.SS4.SSS0.Px1.p7.1.m1.1.1.3.1.cmml" xref="A1.SS4.SSS0.Px1.p7.1.m1.1.1.3.1"></times><cn id="A1.SS4.SSS0.Px1.p7.1.m1.1.1.3.2.cmml" type="integer" xref="A1.SS4.SSS0.Px1.p7.1.m1.1.1.3.2">45</cn><apply id="A1.SS4.SSS0.Px1.p7.1.m1.1.1.3.3.cmml" xref="A1.SS4.SSS0.Px1.p7.1.m1.1.1.3.3"><csymbol cd="ambiguous" id="A1.SS4.SSS0.Px1.p7.1.m1.1.1.3.3.1.cmml" xref="A1.SS4.SSS0.Px1.p7.1.m1.1.1.3.3">superscript</csymbol><cn id="A1.SS4.SSS0.Px1.p7.1.m1.1.1.3.3.2.cmml" type="integer" xref="A1.SS4.SSS0.Px1.p7.1.m1.1.1.3.3.2">10</cn><cn id="A1.SS4.SSS0.Px1.p7.1.m1.1.1.3.3.3.cmml" type="integer" xref="A1.SS4.SSS0.Px1.p7.1.m1.1.1.3.3.3">6</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS4.SSS0.Px1.p7.1.m1.1c">T=45\times 10^{6}</annotation><annotation encoding="application/x-llamapun" id="A1.SS4.SSS0.Px1.p7.1.m1.1d">italic_T = 45 × 10 start_POSTSUPERSCRIPT 6 end_POSTSUPERSCRIPT</annotation></semantics></math> – training tokens per router between communication steps, <math alttext="E\leq 32" class="ltx_Math" display="inline" id="A1.SS4.SSS0.Px1.p7.2.m2.1"><semantics id="A1.SS4.SSS0.Px1.p7.2.m2.1a"><mrow id="A1.SS4.SSS0.Px1.p7.2.m2.1.1" xref="A1.SS4.SSS0.Px1.p7.2.m2.1.1.cmml"><mi id="A1.SS4.SSS0.Px1.p7.2.m2.1.1.2" xref="A1.SS4.SSS0.Px1.p7.2.m2.1.1.2.cmml">E</mi><mo id="A1.SS4.SSS0.Px1.p7.2.m2.1.1.1" xref="A1.SS4.SSS0.Px1.p7.2.m2.1.1.1.cmml">≤</mo><mn id="A1.SS4.SSS0.Px1.p7.2.m2.1.1.3" xref="A1.SS4.SSS0.Px1.p7.2.m2.1.1.3.cmml">32</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.SS4.SSS0.Px1.p7.2.m2.1b"><apply id="A1.SS4.SSS0.Px1.p7.2.m2.1.1.cmml" xref="A1.SS4.SSS0.Px1.p7.2.m2.1.1"><leq id="A1.SS4.SSS0.Px1.p7.2.m2.1.1.1.cmml" xref="A1.SS4.SSS0.Px1.p7.2.m2.1.1.1"></leq><ci id="A1.SS4.SSS0.Px1.p7.2.m2.1.1.2.cmml" xref="A1.SS4.SSS0.Px1.p7.2.m2.1.1.2">𝐸</ci><cn id="A1.SS4.SSS0.Px1.p7.2.m2.1.1.3.cmml" type="integer" xref="A1.SS4.SSS0.Px1.p7.2.m2.1.1.3">32</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS4.SSS0.Px1.p7.2.m2.1c">E\leq 32</annotation><annotation encoding="application/x-llamapun" id="A1.SS4.SSS0.Px1.p7.2.m2.1d">italic_E ≤ 32</annotation></semantics></math> – number of experts and <math alttext="S=1{,}024" class="ltx_Math" display="inline" id="A1.SS4.SSS0.Px1.p7.3.m3.2"><semantics id="A1.SS4.SSS0.Px1.p7.3.m3.2a"><mrow id="A1.SS4.SSS0.Px1.p7.3.m3.2.3" xref="A1.SS4.SSS0.Px1.p7.3.m3.2.3.cmml"><mi id="A1.SS4.SSS0.Px1.p7.3.m3.2.3.2" xref="A1.SS4.SSS0.Px1.p7.3.m3.2.3.2.cmml">S</mi><mo id="A1.SS4.SSS0.Px1.p7.3.m3.2.3.1" xref="A1.SS4.SSS0.Px1.p7.3.m3.2.3.1.cmml">=</mo><mrow id="A1.SS4.SSS0.Px1.p7.3.m3.2.3.3.2" xref="A1.SS4.SSS0.Px1.p7.3.m3.2.3.3.1.cmml"><mn id="A1.SS4.SSS0.Px1.p7.3.m3.1.1" xref="A1.SS4.SSS0.Px1.p7.3.m3.1.1.cmml">1</mn><mo id="A1.SS4.SSS0.Px1.p7.3.m3.2.3.3.2.1" xref="A1.SS4.SSS0.Px1.p7.3.m3.2.3.3.1.cmml">,</mo><mn id="A1.SS4.SSS0.Px1.p7.3.m3.2.2" xref="A1.SS4.SSS0.Px1.p7.3.m3.2.2.cmml">024</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS4.SSS0.Px1.p7.3.m3.2b"><apply id="A1.SS4.SSS0.Px1.p7.3.m3.2.3.cmml" xref="A1.SS4.SSS0.Px1.p7.3.m3.2.3"><eq id="A1.SS4.SSS0.Px1.p7.3.m3.2.3.1.cmml" xref="A1.SS4.SSS0.Px1.p7.3.m3.2.3.1"></eq><ci id="A1.SS4.SSS0.Px1.p7.3.m3.2.3.2.cmml" xref="A1.SS4.SSS0.Px1.p7.3.m3.2.3.2">𝑆</ci><list id="A1.SS4.SSS0.Px1.p7.3.m3.2.3.3.1.cmml" xref="A1.SS4.SSS0.Px1.p7.3.m3.2.3.3.2"><cn id="A1.SS4.SSS0.Px1.p7.3.m3.1.1.cmml" type="integer" xref="A1.SS4.SSS0.Px1.p7.3.m3.1.1">1</cn><cn id="A1.SS4.SSS0.Px1.p7.3.m3.2.2.cmml" type="integer" xref="A1.SS4.SSS0.Px1.p7.3.m3.2.2">024</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS4.SSS0.Px1.p7.3.m3.2c">S=1{,}024</annotation><annotation encoding="application/x-llamapun" id="A1.SS4.SSS0.Px1.p7.3.m3.2d">italic_S = 1 , 024</annotation></semantics></math> – sequence length, we can estimated the data transferred per node as:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equation ltx_eqn_table" id="A1.Ex30">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\text{Data per router}\leq 2\times 2\times\frac{T\times E}{S}=4\times\frac{45%
\times 10^{6}\times 32}{1{,}024}=5.625\text{MB}" class="ltx_Math" display="block" id="A1.Ex30.m1.2"><semantics id="A1.Ex30.m1.2a"><mrow id="A1.Ex30.m1.2.3" xref="A1.Ex30.m1.2.3.cmml"><mtext id="A1.Ex30.m1.2.3.2" xref="A1.Ex30.m1.2.3.2a.cmml">Data per router</mtext><mo id="A1.Ex30.m1.2.3.3" xref="A1.Ex30.m1.2.3.3.cmml">≤</mo><mrow id="A1.Ex30.m1.2.3.4" xref="A1.Ex30.m1.2.3.4.cmml"><mn id="A1.Ex30.m1.2.3.4.2" xref="A1.Ex30.m1.2.3.4.2.cmml">2</mn><mo id="A1.Ex30.m1.2.3.4.1" lspace="0.222em" rspace="0.222em" xref="A1.Ex30.m1.2.3.4.1.cmml">×</mo><mn id="A1.Ex30.m1.2.3.4.3" xref="A1.Ex30.m1.2.3.4.3.cmml">2</mn><mo id="A1.Ex30.m1.2.3.4.1a" lspace="0.222em" rspace="0.222em" xref="A1.Ex30.m1.2.3.4.1.cmml">×</mo><mfrac id="A1.Ex30.m1.2.3.4.4" xref="A1.Ex30.m1.2.3.4.4.cmml"><mrow id="A1.Ex30.m1.2.3.4.4.2" xref="A1.Ex30.m1.2.3.4.4.2.cmml"><mi id="A1.Ex30.m1.2.3.4.4.2.2" xref="A1.Ex30.m1.2.3.4.4.2.2.cmml">T</mi><mo id="A1.Ex30.m1.2.3.4.4.2.1" lspace="0.222em" rspace="0.222em" xref="A1.Ex30.m1.2.3.4.4.2.1.cmml">×</mo><mi id="A1.Ex30.m1.2.3.4.4.2.3" xref="A1.Ex30.m1.2.3.4.4.2.3.cmml">E</mi></mrow><mi id="A1.Ex30.m1.2.3.4.4.3" xref="A1.Ex30.m1.2.3.4.4.3.cmml">S</mi></mfrac></mrow><mo id="A1.Ex30.m1.2.3.5" xref="A1.Ex30.m1.2.3.5.cmml">=</mo><mrow id="A1.Ex30.m1.2.3.6" xref="A1.Ex30.m1.2.3.6.cmml"><mn id="A1.Ex30.m1.2.3.6.2" xref="A1.Ex30.m1.2.3.6.2.cmml">4</mn><mo id="A1.Ex30.m1.2.3.6.1" lspace="0.222em" rspace="0.222em" xref="A1.Ex30.m1.2.3.6.1.cmml">×</mo><mfrac id="A1.Ex30.m1.2.2" xref="A1.Ex30.m1.2.2.cmml"><mrow id="A1.Ex30.m1.2.2.4" xref="A1.Ex30.m1.2.2.4.cmml"><mn id="A1.Ex30.m1.2.2.4.2" xref="A1.Ex30.m1.2.2.4.2.cmml">45</mn><mo id="A1.Ex30.m1.2.2.4.1" lspace="0.222em" rspace="0.222em" xref="A1.Ex30.m1.2.2.4.1.cmml">×</mo><msup id="A1.Ex30.m1.2.2.4.3" xref="A1.Ex30.m1.2.2.4.3.cmml"><mn id="A1.Ex30.m1.2.2.4.3.2" xref="A1.Ex30.m1.2.2.4.3.2.cmml">10</mn><mn id="A1.Ex30.m1.2.2.4.3.3" xref="A1.Ex30.m1.2.2.4.3.3.cmml">6</mn></msup><mo id="A1.Ex30.m1.2.2.4.1a" lspace="0.222em" rspace="0.222em" xref="A1.Ex30.m1.2.2.4.1.cmml">×</mo><mn id="A1.Ex30.m1.2.2.4.4" xref="A1.Ex30.m1.2.2.4.4.cmml">32</mn></mrow><mrow id="A1.Ex30.m1.2.2.2.4" xref="A1.Ex30.m1.2.2.2.3.cmml"><mn id="A1.Ex30.m1.1.1.1.1" xref="A1.Ex30.m1.1.1.1.1.cmml">1</mn><mo id="A1.Ex30.m1.2.2.2.4.1" xref="A1.Ex30.m1.2.2.2.3.cmml">,</mo><mn id="A1.Ex30.m1.2.2.2.2" xref="A1.Ex30.m1.2.2.2.2.cmml">024</mn></mrow></mfrac></mrow><mo id="A1.Ex30.m1.2.3.7" xref="A1.Ex30.m1.2.3.7.cmml">=</mo><mrow id="A1.Ex30.m1.2.3.8" xref="A1.Ex30.m1.2.3.8.cmml"><mn id="A1.Ex30.m1.2.3.8.2" xref="A1.Ex30.m1.2.3.8.2.cmml">5.625</mn><mo id="A1.Ex30.m1.2.3.8.1" xref="A1.Ex30.m1.2.3.8.1.cmml">⁢</mo><mtext id="A1.Ex30.m1.2.3.8.3" xref="A1.Ex30.m1.2.3.8.3a.cmml">MB</mtext></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex30.m1.2b"><apply id="A1.Ex30.m1.2.3.cmml" xref="A1.Ex30.m1.2.3"><and id="A1.Ex30.m1.2.3a.cmml" xref="A1.Ex30.m1.2.3"></and><apply id="A1.Ex30.m1.2.3b.cmml" xref="A1.Ex30.m1.2.3"><leq id="A1.Ex30.m1.2.3.3.cmml" xref="A1.Ex30.m1.2.3.3"></leq><ci id="A1.Ex30.m1.2.3.2a.cmml" xref="A1.Ex30.m1.2.3.2"><mtext id="A1.Ex30.m1.2.3.2.cmml" xref="A1.Ex30.m1.2.3.2">Data per router</mtext></ci><apply id="A1.Ex30.m1.2.3.4.cmml" xref="A1.Ex30.m1.2.3.4"><times id="A1.Ex30.m1.2.3.4.1.cmml" xref="A1.Ex30.m1.2.3.4.1"></times><cn id="A1.Ex30.m1.2.3.4.2.cmml" type="integer" xref="A1.Ex30.m1.2.3.4.2">2</cn><cn id="A1.Ex30.m1.2.3.4.3.cmml" type="integer" xref="A1.Ex30.m1.2.3.4.3">2</cn><apply id="A1.Ex30.m1.2.3.4.4.cmml" xref="A1.Ex30.m1.2.3.4.4"><divide id="A1.Ex30.m1.2.3.4.4.1.cmml" xref="A1.Ex30.m1.2.3.4.4"></divide><apply id="A1.Ex30.m1.2.3.4.4.2.cmml" xref="A1.Ex30.m1.2.3.4.4.2"><times id="A1.Ex30.m1.2.3.4.4.2.1.cmml" xref="A1.Ex30.m1.2.3.4.4.2.1"></times><ci id="A1.Ex30.m1.2.3.4.4.2.2.cmml" xref="A1.Ex30.m1.2.3.4.4.2.2">𝑇</ci><ci id="A1.Ex30.m1.2.3.4.4.2.3.cmml" xref="A1.Ex30.m1.2.3.4.4.2.3">𝐸</ci></apply><ci id="A1.Ex30.m1.2.3.4.4.3.cmml" xref="A1.Ex30.m1.2.3.4.4.3">𝑆</ci></apply></apply></apply><apply id="A1.Ex30.m1.2.3c.cmml" xref="A1.Ex30.m1.2.3"><eq id="A1.Ex30.m1.2.3.5.cmml" xref="A1.Ex30.m1.2.3.5"></eq><share href="https://arxiv.org/html/2410.03529v1#A1.Ex30.m1.2.3.4.cmml" id="A1.Ex30.m1.2.3d.cmml" xref="A1.Ex30.m1.2.3"></share><apply id="A1.Ex30.m1.2.3.6.cmml" xref="A1.Ex30.m1.2.3.6"><times id="A1.Ex30.m1.2.3.6.1.cmml" xref="A1.Ex30.m1.2.3.6.1"></times><cn id="A1.Ex30.m1.2.3.6.2.cmml" type="integer" xref="A1.Ex30.m1.2.3.6.2">4</cn><apply id="A1.Ex30.m1.2.2.cmml" xref="A1.Ex30.m1.2.2"><divide id="A1.Ex30.m1.2.2.3.cmml" xref="A1.Ex30.m1.2.2"></divide><apply id="A1.Ex30.m1.2.2.4.cmml" xref="A1.Ex30.m1.2.2.4"><times id="A1.Ex30.m1.2.2.4.1.cmml" xref="A1.Ex30.m1.2.2.4.1"></times><cn id="A1.Ex30.m1.2.2.4.2.cmml" type="integer" xref="A1.Ex30.m1.2.2.4.2">45</cn><apply id="A1.Ex30.m1.2.2.4.3.cmml" xref="A1.Ex30.m1.2.2.4.3"><csymbol cd="ambiguous" id="A1.Ex30.m1.2.2.4.3.1.cmml" xref="A1.Ex30.m1.2.2.4.3">superscript</csymbol><cn id="A1.Ex30.m1.2.2.4.3.2.cmml" type="integer" xref="A1.Ex30.m1.2.2.4.3.2">10</cn><cn id="A1.Ex30.m1.2.2.4.3.3.cmml" type="integer" xref="A1.Ex30.m1.2.2.4.3.3">6</cn></apply><cn id="A1.Ex30.m1.2.2.4.4.cmml" type="integer" xref="A1.Ex30.m1.2.2.4.4">32</cn></apply><list id="A1.Ex30.m1.2.2.2.3.cmml" xref="A1.Ex30.m1.2.2.2.4"><cn id="A1.Ex30.m1.1.1.1.1.cmml" type="integer" xref="A1.Ex30.m1.1.1.1.1">1</cn><cn id="A1.Ex30.m1.2.2.2.2.cmml" type="integer" xref="A1.Ex30.m1.2.2.2.2">024</cn></list></apply></apply></apply><apply id="A1.Ex30.m1.2.3e.cmml" xref="A1.Ex30.m1.2.3"><eq id="A1.Ex30.m1.2.3.7.cmml" xref="A1.Ex30.m1.2.3.7"></eq><share href="https://arxiv.org/html/2410.03529v1#A1.Ex30.m1.2.3.6.cmml" id="A1.Ex30.m1.2.3f.cmml" xref="A1.Ex30.m1.2.3"></share><apply id="A1.Ex30.m1.2.3.8.cmml" xref="A1.Ex30.m1.2.3.8"><times id="A1.Ex30.m1.2.3.8.1.cmml" xref="A1.Ex30.m1.2.3.8.1"></times><cn id="A1.Ex30.m1.2.3.8.2.cmml" type="float" xref="A1.Ex30.m1.2.3.8.2">5.625</cn><ci id="A1.Ex30.m1.2.3.8.3a.cmml" xref="A1.Ex30.m1.2.3.8.3"><mtext id="A1.Ex30.m1.2.3.8.3.cmml" xref="A1.Ex30.m1.2.3.8.3">MB</mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex30.m1.2c">\text{Data per router}\leq 2\times 2\times\frac{T\times E}{S}=4\times\frac{45%
\times 10^{6}\times 32}{1{,}024}=5.625\text{MB}</annotation><annotation encoding="application/x-llamapun" id="A1.Ex30.m1.2d">Data per router ≤ 2 × 2 × divide start_ARG italic_T × italic_E end_ARG start_ARG italic_S end_ARG = 4 × divide start_ARG 45 × 10 start_POSTSUPERSCRIPT 6 end_POSTSUPERSCRIPT × 32 end_ARG start_ARG 1 , 024 end_ARG = 5.625 MB</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="A1.SS4.SSS0.Px1.p8">
<p class="ltx_p" id="A1.SS4.SSS0.Px1.p8.1">Once routers are fully trained, they communicate only when necessary, such as when experts require new data for training.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="A1.SS4.SSS0.Px1.p9">
<p class="ltx_p" id="A1.SS4.SSS0.Px1.p9.4">For instance, consider that the message size is <math alttext="K" class="ltx_Math" display="inline" id="A1.SS4.SSS0.Px1.p9.1.m1.1"><semantics id="A1.SS4.SSS0.Px1.p9.1.m1.1a"><mi id="A1.SS4.SSS0.Px1.p9.1.m1.1.1" xref="A1.SS4.SSS0.Px1.p9.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="A1.SS4.SSS0.Px1.p9.1.m1.1b"><ci id="A1.SS4.SSS0.Px1.p9.1.m1.1.1.cmml" xref="A1.SS4.SSS0.Px1.p9.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS4.SSS0.Px1.p9.1.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="A1.SS4.SSS0.Px1.p9.1.m1.1d">italic_K</annotation></semantics></math> bytes, equivalent to loss array of <math alttext="K/2" class="ltx_Math" display="inline" id="A1.SS4.SSS0.Px1.p9.2.m2.1"><semantics id="A1.SS4.SSS0.Px1.p9.2.m2.1a"><mrow id="A1.SS4.SSS0.Px1.p9.2.m2.1.1" xref="A1.SS4.SSS0.Px1.p9.2.m2.1.1.cmml"><mi id="A1.SS4.SSS0.Px1.p9.2.m2.1.1.2" xref="A1.SS4.SSS0.Px1.p9.2.m2.1.1.2.cmml">K</mi><mo id="A1.SS4.SSS0.Px1.p9.2.m2.1.1.1" xref="A1.SS4.SSS0.Px1.p9.2.m2.1.1.1.cmml">/</mo><mn id="A1.SS4.SSS0.Px1.p9.2.m2.1.1.3" xref="A1.SS4.SSS0.Px1.p9.2.m2.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.SS4.SSS0.Px1.p9.2.m2.1b"><apply id="A1.SS4.SSS0.Px1.p9.2.m2.1.1.cmml" xref="A1.SS4.SSS0.Px1.p9.2.m2.1.1"><divide id="A1.SS4.SSS0.Px1.p9.2.m2.1.1.1.cmml" xref="A1.SS4.SSS0.Px1.p9.2.m2.1.1.1"></divide><ci id="A1.SS4.SSS0.Px1.p9.2.m2.1.1.2.cmml" xref="A1.SS4.SSS0.Px1.p9.2.m2.1.1.2">𝐾</ci><cn id="A1.SS4.SSS0.Px1.p9.2.m2.1.1.3.cmml" type="integer" xref="A1.SS4.SSS0.Px1.p9.2.m2.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS4.SSS0.Px1.p9.2.m2.1c">K/2</annotation><annotation encoding="application/x-llamapun" id="A1.SS4.SSS0.Px1.p9.2.m2.1d">italic_K / 2</annotation></semantics></math> sequences in <span class="ltx_text ltx_font_typewriter" id="A1.SS4.SSS0.Px1.p9.4.1">float16</span> precision. The frequency of communication after routers are fully trained is determined by the batch size of the expert <math alttext="B" class="ltx_Math" display="inline" id="A1.SS4.SSS0.Px1.p9.3.m3.1"><semantics id="A1.SS4.SSS0.Px1.p9.3.m3.1a"><mi id="A1.SS4.SSS0.Px1.p9.3.m3.1.1" xref="A1.SS4.SSS0.Px1.p9.3.m3.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="A1.SS4.SSS0.Px1.p9.3.m3.1b"><ci id="A1.SS4.SSS0.Px1.p9.3.m3.1.1.cmml" xref="A1.SS4.SSS0.Px1.p9.3.m3.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS4.SSS0.Px1.p9.3.m3.1c">B</annotation><annotation encoding="application/x-llamapun" id="A1.SS4.SSS0.Px1.p9.3.m3.1d">italic_B</annotation></semantics></math> and the number of experts <math alttext="E" class="ltx_Math" display="inline" id="A1.SS4.SSS0.Px1.p9.4.m4.1"><semantics id="A1.SS4.SSS0.Px1.p9.4.m4.1a"><mi id="A1.SS4.SSS0.Px1.p9.4.m4.1.1" xref="A1.SS4.SSS0.Px1.p9.4.m4.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="A1.SS4.SSS0.Px1.p9.4.m4.1b"><ci id="A1.SS4.SSS0.Px1.p9.4.m4.1.1.cmml" xref="A1.SS4.SSS0.Px1.p9.4.m4.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS4.SSS0.Px1.p9.4.m4.1c">E</annotation><annotation encoding="application/x-llamapun" id="A1.SS4.SSS0.Px1.p9.4.m4.1d">italic_E</annotation></semantics></math>. Specifically, the number of steps each expert makes between communications can be estimated as:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equation ltx_eqn_table" id="A1.Ex31">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="N_{\text{steps\_per\_comm}}\approx\frac{K}{2\times B\times E}" class="ltx_Math" display="block" id="A1.Ex31.m1.1"><semantics id="A1.Ex31.m1.1a"><mrow id="A1.Ex31.m1.1.1" xref="A1.Ex31.m1.1.1.cmml"><msub id="A1.Ex31.m1.1.1.2" xref="A1.Ex31.m1.1.1.2.cmml"><mi id="A1.Ex31.m1.1.1.2.2" xref="A1.Ex31.m1.1.1.2.2.cmml">N</mi><mtext id="A1.Ex31.m1.1.1.2.3" xref="A1.Ex31.m1.1.1.2.3a.cmml">steps_per_comm</mtext></msub><mo id="A1.Ex31.m1.1.1.1" xref="A1.Ex31.m1.1.1.1.cmml">≈</mo><mfrac id="A1.Ex31.m1.1.1.3" xref="A1.Ex31.m1.1.1.3.cmml"><mi id="A1.Ex31.m1.1.1.3.2" xref="A1.Ex31.m1.1.1.3.2.cmml">K</mi><mrow id="A1.Ex31.m1.1.1.3.3" xref="A1.Ex31.m1.1.1.3.3.cmml"><mn id="A1.Ex31.m1.1.1.3.3.2" xref="A1.Ex31.m1.1.1.3.3.2.cmml">2</mn><mo id="A1.Ex31.m1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="A1.Ex31.m1.1.1.3.3.1.cmml">×</mo><mi id="A1.Ex31.m1.1.1.3.3.3" xref="A1.Ex31.m1.1.1.3.3.3.cmml">B</mi><mo id="A1.Ex31.m1.1.1.3.3.1a" lspace="0.222em" rspace="0.222em" xref="A1.Ex31.m1.1.1.3.3.1.cmml">×</mo><mi id="A1.Ex31.m1.1.1.3.3.4" xref="A1.Ex31.m1.1.1.3.3.4.cmml">E</mi></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex31.m1.1b"><apply id="A1.Ex31.m1.1.1.cmml" xref="A1.Ex31.m1.1.1"><approx id="A1.Ex31.m1.1.1.1.cmml" xref="A1.Ex31.m1.1.1.1"></approx><apply id="A1.Ex31.m1.1.1.2.cmml" xref="A1.Ex31.m1.1.1.2"><csymbol cd="ambiguous" id="A1.Ex31.m1.1.1.2.1.cmml" xref="A1.Ex31.m1.1.1.2">subscript</csymbol><ci id="A1.Ex31.m1.1.1.2.2.cmml" xref="A1.Ex31.m1.1.1.2.2">𝑁</ci><ci id="A1.Ex31.m1.1.1.2.3a.cmml" xref="A1.Ex31.m1.1.1.2.3"><mtext id="A1.Ex31.m1.1.1.2.3.cmml" mathsize="70%" xref="A1.Ex31.m1.1.1.2.3">steps_per_comm</mtext></ci></apply><apply id="A1.Ex31.m1.1.1.3.cmml" xref="A1.Ex31.m1.1.1.3"><divide id="A1.Ex31.m1.1.1.3.1.cmml" xref="A1.Ex31.m1.1.1.3"></divide><ci id="A1.Ex31.m1.1.1.3.2.cmml" xref="A1.Ex31.m1.1.1.3.2">𝐾</ci><apply id="A1.Ex31.m1.1.1.3.3.cmml" xref="A1.Ex31.m1.1.1.3.3"><times id="A1.Ex31.m1.1.1.3.3.1.cmml" xref="A1.Ex31.m1.1.1.3.3.1"></times><cn id="A1.Ex31.m1.1.1.3.3.2.cmml" type="integer" xref="A1.Ex31.m1.1.1.3.3.2">2</cn><ci id="A1.Ex31.m1.1.1.3.3.3.cmml" xref="A1.Ex31.m1.1.1.3.3.3">𝐵</ci><ci id="A1.Ex31.m1.1.1.3.3.4.cmml" xref="A1.Ex31.m1.1.1.3.3.4">𝐸</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex31.m1.1c">N_{\text{steps\_per\_comm}}\approx\frac{K}{2\times B\times E}</annotation><annotation encoding="application/x-llamapun" id="A1.Ex31.m1.1d">italic_N start_POSTSUBSCRIPT steps_per_comm end_POSTSUBSCRIPT ≈ divide start_ARG italic_K end_ARG start_ARG 2 × italic_B × italic_E end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="A1.SS4.SSS0.Px1.p10">
<p class="ltx_p" id="A1.SS4.SSS0.Px1.p10.4">Thus, communication can be scheduled approximately every <math alttext="\frac{K}{4\times B\times E}" class="ltx_Math" display="inline" id="A1.SS4.SSS0.Px1.p10.1.m1.1"><semantics id="A1.SS4.SSS0.Px1.p10.1.m1.1a"><mfrac id="A1.SS4.SSS0.Px1.p10.1.m1.1.1" xref="A1.SS4.SSS0.Px1.p10.1.m1.1.1.cmml"><mi id="A1.SS4.SSS0.Px1.p10.1.m1.1.1.2" xref="A1.SS4.SSS0.Px1.p10.1.m1.1.1.2.cmml">K</mi><mrow id="A1.SS4.SSS0.Px1.p10.1.m1.1.1.3" xref="A1.SS4.SSS0.Px1.p10.1.m1.1.1.3.cmml"><mn id="A1.SS4.SSS0.Px1.p10.1.m1.1.1.3.2" xref="A1.SS4.SSS0.Px1.p10.1.m1.1.1.3.2.cmml">4</mn><mo id="A1.SS4.SSS0.Px1.p10.1.m1.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="A1.SS4.SSS0.Px1.p10.1.m1.1.1.3.1.cmml">×</mo><mi id="A1.SS4.SSS0.Px1.p10.1.m1.1.1.3.3" xref="A1.SS4.SSS0.Px1.p10.1.m1.1.1.3.3.cmml">B</mi><mo id="A1.SS4.SSS0.Px1.p10.1.m1.1.1.3.1a" lspace="0.222em" rspace="0.222em" xref="A1.SS4.SSS0.Px1.p10.1.m1.1.1.3.1.cmml">×</mo><mi id="A1.SS4.SSS0.Px1.p10.1.m1.1.1.3.4" xref="A1.SS4.SSS0.Px1.p10.1.m1.1.1.3.4.cmml">E</mi></mrow></mfrac><annotation-xml encoding="MathML-Content" id="A1.SS4.SSS0.Px1.p10.1.m1.1b"><apply id="A1.SS4.SSS0.Px1.p10.1.m1.1.1.cmml" xref="A1.SS4.SSS0.Px1.p10.1.m1.1.1"><divide id="A1.SS4.SSS0.Px1.p10.1.m1.1.1.1.cmml" xref="A1.SS4.SSS0.Px1.p10.1.m1.1.1"></divide><ci id="A1.SS4.SSS0.Px1.p10.1.m1.1.1.2.cmml" xref="A1.SS4.SSS0.Px1.p10.1.m1.1.1.2">𝐾</ci><apply id="A1.SS4.SSS0.Px1.p10.1.m1.1.1.3.cmml" xref="A1.SS4.SSS0.Px1.p10.1.m1.1.1.3"><times id="A1.SS4.SSS0.Px1.p10.1.m1.1.1.3.1.cmml" xref="A1.SS4.SSS0.Px1.p10.1.m1.1.1.3.1"></times><cn id="A1.SS4.SSS0.Px1.p10.1.m1.1.1.3.2.cmml" type="integer" xref="A1.SS4.SSS0.Px1.p10.1.m1.1.1.3.2">4</cn><ci id="A1.SS4.SSS0.Px1.p10.1.m1.1.1.3.3.cmml" xref="A1.SS4.SSS0.Px1.p10.1.m1.1.1.3.3">𝐵</ci><ci id="A1.SS4.SSS0.Px1.p10.1.m1.1.1.3.4.cmml" xref="A1.SS4.SSS0.Px1.p10.1.m1.1.1.3.4">𝐸</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS4.SSS0.Px1.p10.1.m1.1c">\frac{K}{4\times B\times E}</annotation><annotation encoding="application/x-llamapun" id="A1.SS4.SSS0.Px1.p10.1.m1.1d">divide start_ARG italic_K end_ARG start_ARG 4 × italic_B × italic_E end_ARG</annotation></semantics></math> expert’s training steps. Assuming <math alttext="K=2^{31}-1" class="ltx_Math" display="inline" id="A1.SS4.SSS0.Px1.p10.2.m2.1"><semantics id="A1.SS4.SSS0.Px1.p10.2.m2.1a"><mrow id="A1.SS4.SSS0.Px1.p10.2.m2.1.1" xref="A1.SS4.SSS0.Px1.p10.2.m2.1.1.cmml"><mi id="A1.SS4.SSS0.Px1.p10.2.m2.1.1.2" xref="A1.SS4.SSS0.Px1.p10.2.m2.1.1.2.cmml">K</mi><mo id="A1.SS4.SSS0.Px1.p10.2.m2.1.1.1" xref="A1.SS4.SSS0.Px1.p10.2.m2.1.1.1.cmml">=</mo><mrow id="A1.SS4.SSS0.Px1.p10.2.m2.1.1.3" xref="A1.SS4.SSS0.Px1.p10.2.m2.1.1.3.cmml"><msup id="A1.SS4.SSS0.Px1.p10.2.m2.1.1.3.2" xref="A1.SS4.SSS0.Px1.p10.2.m2.1.1.3.2.cmml"><mn id="A1.SS4.SSS0.Px1.p10.2.m2.1.1.3.2.2" xref="A1.SS4.SSS0.Px1.p10.2.m2.1.1.3.2.2.cmml">2</mn><mn id="A1.SS4.SSS0.Px1.p10.2.m2.1.1.3.2.3" xref="A1.SS4.SSS0.Px1.p10.2.m2.1.1.3.2.3.cmml">31</mn></msup><mo id="A1.SS4.SSS0.Px1.p10.2.m2.1.1.3.1" xref="A1.SS4.SSS0.Px1.p10.2.m2.1.1.3.1.cmml">−</mo><mn id="A1.SS4.SSS0.Px1.p10.2.m2.1.1.3.3" xref="A1.SS4.SSS0.Px1.p10.2.m2.1.1.3.3.cmml">1</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS4.SSS0.Px1.p10.2.m2.1b"><apply id="A1.SS4.SSS0.Px1.p10.2.m2.1.1.cmml" xref="A1.SS4.SSS0.Px1.p10.2.m2.1.1"><eq id="A1.SS4.SSS0.Px1.p10.2.m2.1.1.1.cmml" xref="A1.SS4.SSS0.Px1.p10.2.m2.1.1.1"></eq><ci id="A1.SS4.SSS0.Px1.p10.2.m2.1.1.2.cmml" xref="A1.SS4.SSS0.Px1.p10.2.m2.1.1.2">𝐾</ci><apply id="A1.SS4.SSS0.Px1.p10.2.m2.1.1.3.cmml" xref="A1.SS4.SSS0.Px1.p10.2.m2.1.1.3"><minus id="A1.SS4.SSS0.Px1.p10.2.m2.1.1.3.1.cmml" xref="A1.SS4.SSS0.Px1.p10.2.m2.1.1.3.1"></minus><apply id="A1.SS4.SSS0.Px1.p10.2.m2.1.1.3.2.cmml" xref="A1.SS4.SSS0.Px1.p10.2.m2.1.1.3.2"><csymbol cd="ambiguous" id="A1.SS4.SSS0.Px1.p10.2.m2.1.1.3.2.1.cmml" xref="A1.SS4.SSS0.Px1.p10.2.m2.1.1.3.2">superscript</csymbol><cn id="A1.SS4.SSS0.Px1.p10.2.m2.1.1.3.2.2.cmml" type="integer" xref="A1.SS4.SSS0.Px1.p10.2.m2.1.1.3.2.2">2</cn><cn id="A1.SS4.SSS0.Px1.p10.2.m2.1.1.3.2.3.cmml" type="integer" xref="A1.SS4.SSS0.Px1.p10.2.m2.1.1.3.2.3">31</cn></apply><cn id="A1.SS4.SSS0.Px1.p10.2.m2.1.1.3.3.cmml" type="integer" xref="A1.SS4.SSS0.Px1.p10.2.m2.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS4.SSS0.Px1.p10.2.m2.1c">K=2^{31}-1</annotation><annotation encoding="application/x-llamapun" id="A1.SS4.SSS0.Px1.p10.2.m2.1d">italic_K = 2 start_POSTSUPERSCRIPT 31 end_POSTSUPERSCRIPT - 1</annotation></semantics></math> bytes, <math alttext="B=128" class="ltx_Math" display="inline" id="A1.SS4.SSS0.Px1.p10.3.m3.1"><semantics id="A1.SS4.SSS0.Px1.p10.3.m3.1a"><mrow id="A1.SS4.SSS0.Px1.p10.3.m3.1.1" xref="A1.SS4.SSS0.Px1.p10.3.m3.1.1.cmml"><mi id="A1.SS4.SSS0.Px1.p10.3.m3.1.1.2" xref="A1.SS4.SSS0.Px1.p10.3.m3.1.1.2.cmml">B</mi><mo id="A1.SS4.SSS0.Px1.p10.3.m3.1.1.1" xref="A1.SS4.SSS0.Px1.p10.3.m3.1.1.1.cmml">=</mo><mn id="A1.SS4.SSS0.Px1.p10.3.m3.1.1.3" xref="A1.SS4.SSS0.Px1.p10.3.m3.1.1.3.cmml">128</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.SS4.SSS0.Px1.p10.3.m3.1b"><apply id="A1.SS4.SSS0.Px1.p10.3.m3.1.1.cmml" xref="A1.SS4.SSS0.Px1.p10.3.m3.1.1"><eq id="A1.SS4.SSS0.Px1.p10.3.m3.1.1.1.cmml" xref="A1.SS4.SSS0.Px1.p10.3.m3.1.1.1"></eq><ci id="A1.SS4.SSS0.Px1.p10.3.m3.1.1.2.cmml" xref="A1.SS4.SSS0.Px1.p10.3.m3.1.1.2">𝐵</ci><cn id="A1.SS4.SSS0.Px1.p10.3.m3.1.1.3.cmml" type="integer" xref="A1.SS4.SSS0.Px1.p10.3.m3.1.1.3">128</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS4.SSS0.Px1.p10.3.m3.1c">B=128</annotation><annotation encoding="application/x-llamapun" id="A1.SS4.SSS0.Px1.p10.3.m3.1d">italic_B = 128</annotation></semantics></math> as used in the majority of our experiments, and <math alttext="E\in\{4,8,16,32\}" class="ltx_Math" display="inline" id="A1.SS4.SSS0.Px1.p10.4.m4.4"><semantics id="A1.SS4.SSS0.Px1.p10.4.m4.4a"><mrow id="A1.SS4.SSS0.Px1.p10.4.m4.4.5" xref="A1.SS4.SSS0.Px1.p10.4.m4.4.5.cmml"><mi id="A1.SS4.SSS0.Px1.p10.4.m4.4.5.2" xref="A1.SS4.SSS0.Px1.p10.4.m4.4.5.2.cmml">E</mi><mo id="A1.SS4.SSS0.Px1.p10.4.m4.4.5.1" xref="A1.SS4.SSS0.Px1.p10.4.m4.4.5.1.cmml">∈</mo><mrow id="A1.SS4.SSS0.Px1.p10.4.m4.4.5.3.2" xref="A1.SS4.SSS0.Px1.p10.4.m4.4.5.3.1.cmml"><mo id="A1.SS4.SSS0.Px1.p10.4.m4.4.5.3.2.1" stretchy="false" xref="A1.SS4.SSS0.Px1.p10.4.m4.4.5.3.1.cmml">{</mo><mn id="A1.SS4.SSS0.Px1.p10.4.m4.1.1" xref="A1.SS4.SSS0.Px1.p10.4.m4.1.1.cmml">4</mn><mo id="A1.SS4.SSS0.Px1.p10.4.m4.4.5.3.2.2" xref="A1.SS4.SSS0.Px1.p10.4.m4.4.5.3.1.cmml">,</mo><mn id="A1.SS4.SSS0.Px1.p10.4.m4.2.2" xref="A1.SS4.SSS0.Px1.p10.4.m4.2.2.cmml">8</mn><mo id="A1.SS4.SSS0.Px1.p10.4.m4.4.5.3.2.3" xref="A1.SS4.SSS0.Px1.p10.4.m4.4.5.3.1.cmml">,</mo><mn id="A1.SS4.SSS0.Px1.p10.4.m4.3.3" xref="A1.SS4.SSS0.Px1.p10.4.m4.3.3.cmml">16</mn><mo id="A1.SS4.SSS0.Px1.p10.4.m4.4.5.3.2.4" xref="A1.SS4.SSS0.Px1.p10.4.m4.4.5.3.1.cmml">,</mo><mn id="A1.SS4.SSS0.Px1.p10.4.m4.4.4" xref="A1.SS4.SSS0.Px1.p10.4.m4.4.4.cmml">32</mn><mo id="A1.SS4.SSS0.Px1.p10.4.m4.4.5.3.2.5" stretchy="false" xref="A1.SS4.SSS0.Px1.p10.4.m4.4.5.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS4.SSS0.Px1.p10.4.m4.4b"><apply id="A1.SS4.SSS0.Px1.p10.4.m4.4.5.cmml" xref="A1.SS4.SSS0.Px1.p10.4.m4.4.5"><in id="A1.SS4.SSS0.Px1.p10.4.m4.4.5.1.cmml" xref="A1.SS4.SSS0.Px1.p10.4.m4.4.5.1"></in><ci id="A1.SS4.SSS0.Px1.p10.4.m4.4.5.2.cmml" xref="A1.SS4.SSS0.Px1.p10.4.m4.4.5.2">𝐸</ci><set id="A1.SS4.SSS0.Px1.p10.4.m4.4.5.3.1.cmml" xref="A1.SS4.SSS0.Px1.p10.4.m4.4.5.3.2"><cn id="A1.SS4.SSS0.Px1.p10.4.m4.1.1.cmml" type="integer" xref="A1.SS4.SSS0.Px1.p10.4.m4.1.1">4</cn><cn id="A1.SS4.SSS0.Px1.p10.4.m4.2.2.cmml" type="integer" xref="A1.SS4.SSS0.Px1.p10.4.m4.2.2">8</cn><cn id="A1.SS4.SSS0.Px1.p10.4.m4.3.3.cmml" type="integer" xref="A1.SS4.SSS0.Px1.p10.4.m4.3.3">16</cn><cn id="A1.SS4.SSS0.Px1.p10.4.m4.4.4.cmml" type="integer" xref="A1.SS4.SSS0.Px1.p10.4.m4.4.4">32</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS4.SSS0.Px1.p10.4.m4.4c">E\in\{4,8,16,32\}</annotation><annotation encoding="application/x-llamapun" id="A1.SS4.SSS0.Px1.p10.4.m4.4d">italic_E ∈ { 4 , 8 , 16 , 32 }</annotation></semantics></math> (see Appendix&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#A1.T2" title="Table 2 ‣ A.1 Architecture and training details ‣ Appendix A Language modeling experiments ‣ No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_tag">2</span></a>), the communication interval becomes:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equation ltx_eqn_table" id="A1.E17">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\frac{2^{31}-1}{2\times 128\times E}\approx\frac{2^{23}}{E}\leq 2^{18}\quad%
\forall E\in\{4,8,16,32\}" class="ltx_Math" display="block" id="A1.E17.m1.6"><semantics id="A1.E17.m1.6a"><mrow id="A1.E17.m1.6.6.2" xref="A1.E17.m1.6.6.3.cmml"><mrow id="A1.E17.m1.5.5.1.1" xref="A1.E17.m1.5.5.1.1.cmml"><mfrac id="A1.E17.m1.5.5.1.1.2" xref="A1.E17.m1.5.5.1.1.2.cmml"><mrow id="A1.E17.m1.5.5.1.1.2.2" xref="A1.E17.m1.5.5.1.1.2.2.cmml"><msup id="A1.E17.m1.5.5.1.1.2.2.2" xref="A1.E17.m1.5.5.1.1.2.2.2.cmml"><mn id="A1.E17.m1.5.5.1.1.2.2.2.2" xref="A1.E17.m1.5.5.1.1.2.2.2.2.cmml">2</mn><mn id="A1.E17.m1.5.5.1.1.2.2.2.3" xref="A1.E17.m1.5.5.1.1.2.2.2.3.cmml">31</mn></msup><mo id="A1.E17.m1.5.5.1.1.2.2.1" xref="A1.E17.m1.5.5.1.1.2.2.1.cmml">−</mo><mn id="A1.E17.m1.5.5.1.1.2.2.3" xref="A1.E17.m1.5.5.1.1.2.2.3.cmml">1</mn></mrow><mrow id="A1.E17.m1.5.5.1.1.2.3" xref="A1.E17.m1.5.5.1.1.2.3.cmml"><mn id="A1.E17.m1.5.5.1.1.2.3.2" xref="A1.E17.m1.5.5.1.1.2.3.2.cmml">2</mn><mo id="A1.E17.m1.5.5.1.1.2.3.1" lspace="0.222em" rspace="0.222em" xref="A1.E17.m1.5.5.1.1.2.3.1.cmml">×</mo><mn id="A1.E17.m1.5.5.1.1.2.3.3" xref="A1.E17.m1.5.5.1.1.2.3.3.cmml">128</mn><mo id="A1.E17.m1.5.5.1.1.2.3.1a" lspace="0.222em" rspace="0.222em" xref="A1.E17.m1.5.5.1.1.2.3.1.cmml">×</mo><mi id="A1.E17.m1.5.5.1.1.2.3.4" xref="A1.E17.m1.5.5.1.1.2.3.4.cmml">E</mi></mrow></mfrac><mo id="A1.E17.m1.5.5.1.1.3" xref="A1.E17.m1.5.5.1.1.3.cmml">≈</mo><mfrac id="A1.E17.m1.5.5.1.1.4" xref="A1.E17.m1.5.5.1.1.4.cmml"><msup id="A1.E17.m1.5.5.1.1.4.2" xref="A1.E17.m1.5.5.1.1.4.2.cmml"><mn id="A1.E17.m1.5.5.1.1.4.2.2" xref="A1.E17.m1.5.5.1.1.4.2.2.cmml">2</mn><mn id="A1.E17.m1.5.5.1.1.4.2.3" xref="A1.E17.m1.5.5.1.1.4.2.3.cmml">23</mn></msup><mi id="A1.E17.m1.5.5.1.1.4.3" xref="A1.E17.m1.5.5.1.1.4.3.cmml">E</mi></mfrac><mo id="A1.E17.m1.5.5.1.1.5" xref="A1.E17.m1.5.5.1.1.5.cmml">≤</mo><msup id="A1.E17.m1.5.5.1.1.6" xref="A1.E17.m1.5.5.1.1.6.cmml"><mn id="A1.E17.m1.5.5.1.1.6.2" xref="A1.E17.m1.5.5.1.1.6.2.cmml">2</mn><mn id="A1.E17.m1.5.5.1.1.6.3" xref="A1.E17.m1.5.5.1.1.6.3.cmml">18</mn></msup></mrow><mspace id="A1.E17.m1.6.6.2.3" width="1.167em" xref="A1.E17.m1.6.6.3a.cmml"></mspace><mrow id="A1.E17.m1.6.6.2.2" xref="A1.E17.m1.6.6.2.2.cmml"><mrow id="A1.E17.m1.6.6.2.2.2" xref="A1.E17.m1.6.6.2.2.2.cmml"><mo id="A1.E17.m1.6.6.2.2.2.1" rspace="0.167em" xref="A1.E17.m1.6.6.2.2.2.1.cmml">∀</mo><mi id="A1.E17.m1.6.6.2.2.2.2" xref="A1.E17.m1.6.6.2.2.2.2.cmml">E</mi></mrow><mo id="A1.E17.m1.6.6.2.2.1" xref="A1.E17.m1.6.6.2.2.1.cmml">∈</mo><mrow id="A1.E17.m1.6.6.2.2.3.2" xref="A1.E17.m1.6.6.2.2.3.1.cmml"><mo id="A1.E17.m1.6.6.2.2.3.2.1" stretchy="false" xref="A1.E17.m1.6.6.2.2.3.1.cmml">{</mo><mn id="A1.E17.m1.1.1" xref="A1.E17.m1.1.1.cmml">4</mn><mo id="A1.E17.m1.6.6.2.2.3.2.2" xref="A1.E17.m1.6.6.2.2.3.1.cmml">,</mo><mn id="A1.E17.m1.2.2" xref="A1.E17.m1.2.2.cmml">8</mn><mo id="A1.E17.m1.6.6.2.2.3.2.3" xref="A1.E17.m1.6.6.2.2.3.1.cmml">,</mo><mn id="A1.E17.m1.3.3" xref="A1.E17.m1.3.3.cmml">16</mn><mo id="A1.E17.m1.6.6.2.2.3.2.4" xref="A1.E17.m1.6.6.2.2.3.1.cmml">,</mo><mn id="A1.E17.m1.4.4" xref="A1.E17.m1.4.4.cmml">32</mn><mo id="A1.E17.m1.6.6.2.2.3.2.5" stretchy="false" xref="A1.E17.m1.6.6.2.2.3.1.cmml">}</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E17.m1.6b"><apply id="A1.E17.m1.6.6.3.cmml" xref="A1.E17.m1.6.6.2"><csymbol cd="ambiguous" id="A1.E17.m1.6.6.3a.cmml" xref="A1.E17.m1.6.6.2.3">formulae-sequence</csymbol><apply id="A1.E17.m1.5.5.1.1.cmml" xref="A1.E17.m1.5.5.1.1"><and id="A1.E17.m1.5.5.1.1a.cmml" xref="A1.E17.m1.5.5.1.1"></and><apply id="A1.E17.m1.5.5.1.1b.cmml" xref="A1.E17.m1.5.5.1.1"><approx id="A1.E17.m1.5.5.1.1.3.cmml" xref="A1.E17.m1.5.5.1.1.3"></approx><apply id="A1.E17.m1.5.5.1.1.2.cmml" xref="A1.E17.m1.5.5.1.1.2"><divide id="A1.E17.m1.5.5.1.1.2.1.cmml" xref="A1.E17.m1.5.5.1.1.2"></divide><apply id="A1.E17.m1.5.5.1.1.2.2.cmml" xref="A1.E17.m1.5.5.1.1.2.2"><minus id="A1.E17.m1.5.5.1.1.2.2.1.cmml" xref="A1.E17.m1.5.5.1.1.2.2.1"></minus><apply id="A1.E17.m1.5.5.1.1.2.2.2.cmml" xref="A1.E17.m1.5.5.1.1.2.2.2"><csymbol cd="ambiguous" id="A1.E17.m1.5.5.1.1.2.2.2.1.cmml" xref="A1.E17.m1.5.5.1.1.2.2.2">superscript</csymbol><cn id="A1.E17.m1.5.5.1.1.2.2.2.2.cmml" type="integer" xref="A1.E17.m1.5.5.1.1.2.2.2.2">2</cn><cn id="A1.E17.m1.5.5.1.1.2.2.2.3.cmml" type="integer" xref="A1.E17.m1.5.5.1.1.2.2.2.3">31</cn></apply><cn id="A1.E17.m1.5.5.1.1.2.2.3.cmml" type="integer" xref="A1.E17.m1.5.5.1.1.2.2.3">1</cn></apply><apply id="A1.E17.m1.5.5.1.1.2.3.cmml" xref="A1.E17.m1.5.5.1.1.2.3"><times id="A1.E17.m1.5.5.1.1.2.3.1.cmml" xref="A1.E17.m1.5.5.1.1.2.3.1"></times><cn id="A1.E17.m1.5.5.1.1.2.3.2.cmml" type="integer" xref="A1.E17.m1.5.5.1.1.2.3.2">2</cn><cn id="A1.E17.m1.5.5.1.1.2.3.3.cmml" type="integer" xref="A1.E17.m1.5.5.1.1.2.3.3">128</cn><ci id="A1.E17.m1.5.5.1.1.2.3.4.cmml" xref="A1.E17.m1.5.5.1.1.2.3.4">𝐸</ci></apply></apply><apply id="A1.E17.m1.5.5.1.1.4.cmml" xref="A1.E17.m1.5.5.1.1.4"><divide id="A1.E17.m1.5.5.1.1.4.1.cmml" xref="A1.E17.m1.5.5.1.1.4"></divide><apply id="A1.E17.m1.5.5.1.1.4.2.cmml" xref="A1.E17.m1.5.5.1.1.4.2"><csymbol cd="ambiguous" id="A1.E17.m1.5.5.1.1.4.2.1.cmml" xref="A1.E17.m1.5.5.1.1.4.2">superscript</csymbol><cn id="A1.E17.m1.5.5.1.1.4.2.2.cmml" type="integer" xref="A1.E17.m1.5.5.1.1.4.2.2">2</cn><cn id="A1.E17.m1.5.5.1.1.4.2.3.cmml" type="integer" xref="A1.E17.m1.5.5.1.1.4.2.3">23</cn></apply><ci id="A1.E17.m1.5.5.1.1.4.3.cmml" xref="A1.E17.m1.5.5.1.1.4.3">𝐸</ci></apply></apply><apply id="A1.E17.m1.5.5.1.1c.cmml" xref="A1.E17.m1.5.5.1.1"><leq id="A1.E17.m1.5.5.1.1.5.cmml" xref="A1.E17.m1.5.5.1.1.5"></leq><share href="https://arxiv.org/html/2410.03529v1#A1.E17.m1.5.5.1.1.4.cmml" id="A1.E17.m1.5.5.1.1d.cmml" xref="A1.E17.m1.5.5.1.1"></share><apply id="A1.E17.m1.5.5.1.1.6.cmml" xref="A1.E17.m1.5.5.1.1.6"><csymbol cd="ambiguous" id="A1.E17.m1.5.5.1.1.6.1.cmml" xref="A1.E17.m1.5.5.1.1.6">superscript</csymbol><cn id="A1.E17.m1.5.5.1.1.6.2.cmml" type="integer" xref="A1.E17.m1.5.5.1.1.6.2">2</cn><cn id="A1.E17.m1.5.5.1.1.6.3.cmml" type="integer" xref="A1.E17.m1.5.5.1.1.6.3">18</cn></apply></apply></apply><apply id="A1.E17.m1.6.6.2.2.cmml" xref="A1.E17.m1.6.6.2.2"><in id="A1.E17.m1.6.6.2.2.1.cmml" xref="A1.E17.m1.6.6.2.2.1"></in><apply id="A1.E17.m1.6.6.2.2.2.cmml" xref="A1.E17.m1.6.6.2.2.2"><csymbol cd="latexml" id="A1.E17.m1.6.6.2.2.2.1.cmml" xref="A1.E17.m1.6.6.2.2.2.1">for-all</csymbol><ci id="A1.E17.m1.6.6.2.2.2.2.cmml" xref="A1.E17.m1.6.6.2.2.2.2">𝐸</ci></apply><set id="A1.E17.m1.6.6.2.2.3.1.cmml" xref="A1.E17.m1.6.6.2.2.3.2"><cn id="A1.E17.m1.1.1.cmml" type="integer" xref="A1.E17.m1.1.1">4</cn><cn id="A1.E17.m1.2.2.cmml" type="integer" xref="A1.E17.m1.2.2">8</cn><cn id="A1.E17.m1.3.3.cmml" type="integer" xref="A1.E17.m1.3.3">16</cn><cn id="A1.E17.m1.4.4.cmml" type="integer" xref="A1.E17.m1.4.4">32</cn></set></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E17.m1.6c">\frac{2^{31}-1}{2\times 128\times E}\approx\frac{2^{23}}{E}\leq 2^{18}\quad%
\forall E\in\{4,8,16,32\}</annotation><annotation encoding="application/x-llamapun" id="A1.E17.m1.6d">divide start_ARG 2 start_POSTSUPERSCRIPT 31 end_POSTSUPERSCRIPT - 1 end_ARG start_ARG 2 × 128 × italic_E end_ARG ≈ divide start_ARG 2 start_POSTSUPERSCRIPT 23 end_POSTSUPERSCRIPT end_ARG start_ARG italic_E end_ARG ≤ 2 start_POSTSUPERSCRIPT 18 end_POSTSUPERSCRIPT ∀ italic_E ∈ { 4 , 8 , 16 , 32 }</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(17)</span></td>
</tr></tbody>
</table>
</div>
</section>
<section class="ltx_paragraph" id="A1.SS4.SSS0.Px2">
<h5 class="ltx_title ltx_title_paragraph">Comparison with Distributed Training</h5><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="A1.SS4.SSS0.Px2.p1">
<p class="ltx_p" id="A1.SS4.SSS0.Px2.p1.4">Let us assume that we train a model with a batch size of <math alttext="B" class="ltx_Math" display="inline" id="A1.SS4.SSS0.Px2.p1.1.m1.1"><semantics id="A1.SS4.SSS0.Px2.p1.1.m1.1a"><mi id="A1.SS4.SSS0.Px2.p1.1.m1.1.1" xref="A1.SS4.SSS0.Px2.p1.1.m1.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="A1.SS4.SSS0.Px2.p1.1.m1.1b"><ci id="A1.SS4.SSS0.Px2.p1.1.m1.1.1.cmml" xref="A1.SS4.SSS0.Px2.p1.1.m1.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS4.SSS0.Px2.p1.1.m1.1c">B</annotation><annotation encoding="application/x-llamapun" id="A1.SS4.SSS0.Px2.p1.1.m1.1d">italic_B</annotation></semantics></math> on a single host, where <math alttext="W" class="ltx_Math" display="inline" id="A1.SS4.SSS0.Px2.p1.2.m2.1"><semantics id="A1.SS4.SSS0.Px2.p1.2.m2.1a"><mi id="A1.SS4.SSS0.Px2.p1.2.m2.1.1" xref="A1.SS4.SSS0.Px2.p1.2.m2.1.1.cmml">W</mi><annotation-xml encoding="MathML-Content" id="A1.SS4.SSS0.Px2.p1.2.m2.1b"><ci id="A1.SS4.SSS0.Px2.p1.2.m2.1.1.cmml" xref="A1.SS4.SSS0.Px2.p1.2.m2.1.1">𝑊</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS4.SSS0.Px2.p1.2.m2.1c">W</annotation><annotation encoding="application/x-llamapun" id="A1.SS4.SSS0.Px2.p1.2.m2.1d">italic_W</annotation></semantics></math> represents the model size in parameters. For simplicity, we consider only data parallelism and assume that the model weights can fit on one GPU. To compare communication costs, we examine the additional expense incurred when increasing throughput by a factor of <math alttext="E" class="ltx_Math" display="inline" id="A1.SS4.SSS0.Px2.p1.3.m3.1"><semantics id="A1.SS4.SSS0.Px2.p1.3.m3.1a"><mi id="A1.SS4.SSS0.Px2.p1.3.m3.1.1" xref="A1.SS4.SSS0.Px2.p1.3.m3.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="A1.SS4.SSS0.Px2.p1.3.m3.1b"><ci id="A1.SS4.SSS0.Px2.p1.3.m3.1.1.cmml" xref="A1.SS4.SSS0.Px2.p1.3.m3.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS4.SSS0.Px2.p1.3.m3.1c">E</annotation><annotation encoding="application/x-llamapun" id="A1.SS4.SSS0.Px2.p1.3.m3.1d">italic_E</annotation></semantics></math>, i.e., utilizing <math alttext="E" class="ltx_Math" display="inline" id="A1.SS4.SSS0.Px2.p1.4.m4.1"><semantics id="A1.SS4.SSS0.Px2.p1.4.m4.1a"><mi id="A1.SS4.SSS0.Px2.p1.4.m4.1.1" xref="A1.SS4.SSS0.Px2.p1.4.m4.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="A1.SS4.SSS0.Px2.p1.4.m4.1b"><ci id="A1.SS4.SSS0.Px2.p1.4.m4.1.1.cmml" xref="A1.SS4.SSS0.Px2.p1.4.m4.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS4.SSS0.Px2.p1.4.m4.1c">E</annotation><annotation encoding="application/x-llamapun" id="A1.SS4.SSS0.Px2.p1.4.m4.1d">italic_E</annotation></semantics></math> hosts instead of one.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="A1.SS4.SSS0.Px2.p2">
<p class="ltx_p" id="A1.SS4.SSS0.Px2.p2.2">In regular distributed training, scaling to <math alttext="E" class="ltx_Math" display="inline" id="A1.SS4.SSS0.Px2.p2.1.m1.1"><semantics id="A1.SS4.SSS0.Px2.p2.1.m1.1a"><mi id="A1.SS4.SSS0.Px2.p2.1.m1.1.1" xref="A1.SS4.SSS0.Px2.p2.1.m1.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="A1.SS4.SSS0.Px2.p2.1.m1.1b"><ci id="A1.SS4.SSS0.Px2.p2.1.m1.1.1.cmml" xref="A1.SS4.SSS0.Px2.p2.1.m1.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS4.SSS0.Px2.p2.1.m1.1c">E</annotation><annotation encoding="application/x-llamapun" id="A1.SS4.SSS0.Px2.p2.1.m1.1d">italic_E</annotation></semantics></math> hosts necessitates copying all weights to each host and performing gradient synchronization at every training step. Assuming each parameter is represented by <math alttext="32" class="ltx_Math" display="inline" id="A1.SS4.SSS0.Px2.p2.2.m2.1"><semantics id="A1.SS4.SSS0.Px2.p2.2.m2.1a"><mn id="A1.SS4.SSS0.Px2.p2.2.m2.1.1" xref="A1.SS4.SSS0.Px2.p2.2.m2.1.1.cmml">32</mn><annotation-xml encoding="MathML-Content" id="A1.SS4.SSS0.Px2.p2.2.m2.1b"><cn id="A1.SS4.SSS0.Px2.p2.2.m2.1.1.cmml" type="integer" xref="A1.SS4.SSS0.Px2.p2.2.m2.1.1">32</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS4.SSS0.Px2.p2.2.m2.1c">32</annotation><annotation encoding="application/x-llamapun" id="A1.SS4.SSS0.Px2.p2.2.m2.1d">32</annotation></semantics></math> bits (as optimizers typically operate in <span class="ltx_text ltx_font_typewriter" id="A1.SS4.SSS0.Px2.p2.2.1">float32</span>), the amount of data transferred to and from each node during gradient synchronization can be calculated using the bandwidth-optimal algorithm:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equation ltx_eqn_table" id="A1.Ex32">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\text{Data per node}=2\times W\times 4" class="ltx_Math" display="block" id="A1.Ex32.m1.1"><semantics id="A1.Ex32.m1.1a"><mrow id="A1.Ex32.m1.1.1" xref="A1.Ex32.m1.1.1.cmml"><mtext id="A1.Ex32.m1.1.1.2" xref="A1.Ex32.m1.1.1.2a.cmml">Data per node</mtext><mo id="A1.Ex32.m1.1.1.1" xref="A1.Ex32.m1.1.1.1.cmml">=</mo><mrow id="A1.Ex32.m1.1.1.3" xref="A1.Ex32.m1.1.1.3.cmml"><mn id="A1.Ex32.m1.1.1.3.2" xref="A1.Ex32.m1.1.1.3.2.cmml">2</mn><mo id="A1.Ex32.m1.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="A1.Ex32.m1.1.1.3.1.cmml">×</mo><mi id="A1.Ex32.m1.1.1.3.3" xref="A1.Ex32.m1.1.1.3.3.cmml">W</mi><mo id="A1.Ex32.m1.1.1.3.1a" lspace="0.222em" rspace="0.222em" xref="A1.Ex32.m1.1.1.3.1.cmml">×</mo><mn id="A1.Ex32.m1.1.1.3.4" xref="A1.Ex32.m1.1.1.3.4.cmml">4</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex32.m1.1b"><apply id="A1.Ex32.m1.1.1.cmml" xref="A1.Ex32.m1.1.1"><eq id="A1.Ex32.m1.1.1.1.cmml" xref="A1.Ex32.m1.1.1.1"></eq><ci id="A1.Ex32.m1.1.1.2a.cmml" xref="A1.Ex32.m1.1.1.2"><mtext id="A1.Ex32.m1.1.1.2.cmml" xref="A1.Ex32.m1.1.1.2">Data per node</mtext></ci><apply id="A1.Ex32.m1.1.1.3.cmml" xref="A1.Ex32.m1.1.1.3"><times id="A1.Ex32.m1.1.1.3.1.cmml" xref="A1.Ex32.m1.1.1.3.1"></times><cn id="A1.Ex32.m1.1.1.3.2.cmml" type="integer" xref="A1.Ex32.m1.1.1.3.2">2</cn><ci id="A1.Ex32.m1.1.1.3.3.cmml" xref="A1.Ex32.m1.1.1.3.3">𝑊</ci><cn id="A1.Ex32.m1.1.1.3.4.cmml" type="integer" xref="A1.Ex32.m1.1.1.3.4">4</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex32.m1.1c">\text{Data per node}=2\times W\times 4</annotation><annotation encoding="application/x-llamapun" id="A1.Ex32.m1.1d">Data per node = 2 × italic_W × 4</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A1.SS4.SSS0.Px2.p2.3">Here, <math alttext="W\times 4" class="ltx_Math" display="inline" id="A1.SS4.SSS0.Px2.p2.3.m1.1"><semantics id="A1.SS4.SSS0.Px2.p2.3.m1.1a"><mrow id="A1.SS4.SSS0.Px2.p2.3.m1.1.1" xref="A1.SS4.SSS0.Px2.p2.3.m1.1.1.cmml"><mi id="A1.SS4.SSS0.Px2.p2.3.m1.1.1.2" xref="A1.SS4.SSS0.Px2.p2.3.m1.1.1.2.cmml">W</mi><mo id="A1.SS4.SSS0.Px2.p2.3.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="A1.SS4.SSS0.Px2.p2.3.m1.1.1.1.cmml">×</mo><mn id="A1.SS4.SSS0.Px2.p2.3.m1.1.1.3" xref="A1.SS4.SSS0.Px2.p2.3.m1.1.1.3.cmml">4</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.SS4.SSS0.Px2.p2.3.m1.1b"><apply id="A1.SS4.SSS0.Px2.p2.3.m1.1.1.cmml" xref="A1.SS4.SSS0.Px2.p2.3.m1.1.1"><times id="A1.SS4.SSS0.Px2.p2.3.m1.1.1.1.cmml" xref="A1.SS4.SSS0.Px2.p2.3.m1.1.1.1"></times><ci id="A1.SS4.SSS0.Px2.p2.3.m1.1.1.2.cmml" xref="A1.SS4.SSS0.Px2.p2.3.m1.1.1.2">𝑊</ci><cn id="A1.SS4.SSS0.Px2.p2.3.m1.1.1.3.cmml" type="integer" xref="A1.SS4.SSS0.Px2.p2.3.m1.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS4.SSS0.Px2.p2.3.m1.1c">W\times 4</annotation><annotation encoding="application/x-llamapun" id="A1.SS4.SSS0.Px2.p2.3.m1.1d">italic_W × 4</annotation></semantics></math> represent the size of the model gradients in bytes.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="A1.SS4.SSS0.Px2.p3">
<p class="ltx_p" id="A1.SS4.SSS0.Px2.p3.1">If <math alttext="W=1.3\times 10^{9}" class="ltx_Math" display="inline" id="A1.SS4.SSS0.Px2.p3.1.m1.1"><semantics id="A1.SS4.SSS0.Px2.p3.1.m1.1a"><mrow id="A1.SS4.SSS0.Px2.p3.1.m1.1.1" xref="A1.SS4.SSS0.Px2.p3.1.m1.1.1.cmml"><mi id="A1.SS4.SSS0.Px2.p3.1.m1.1.1.2" xref="A1.SS4.SSS0.Px2.p3.1.m1.1.1.2.cmml">W</mi><mo id="A1.SS4.SSS0.Px2.p3.1.m1.1.1.1" xref="A1.SS4.SSS0.Px2.p3.1.m1.1.1.1.cmml">=</mo><mrow id="A1.SS4.SSS0.Px2.p3.1.m1.1.1.3" xref="A1.SS4.SSS0.Px2.p3.1.m1.1.1.3.cmml"><mn id="A1.SS4.SSS0.Px2.p3.1.m1.1.1.3.2" xref="A1.SS4.SSS0.Px2.p3.1.m1.1.1.3.2.cmml">1.3</mn><mo id="A1.SS4.SSS0.Px2.p3.1.m1.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="A1.SS4.SSS0.Px2.p3.1.m1.1.1.3.1.cmml">×</mo><msup id="A1.SS4.SSS0.Px2.p3.1.m1.1.1.3.3" xref="A1.SS4.SSS0.Px2.p3.1.m1.1.1.3.3.cmml"><mn id="A1.SS4.SSS0.Px2.p3.1.m1.1.1.3.3.2" xref="A1.SS4.SSS0.Px2.p3.1.m1.1.1.3.3.2.cmml">10</mn><mn id="A1.SS4.SSS0.Px2.p3.1.m1.1.1.3.3.3" xref="A1.SS4.SSS0.Px2.p3.1.m1.1.1.3.3.3.cmml">9</mn></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS4.SSS0.Px2.p3.1.m1.1b"><apply id="A1.SS4.SSS0.Px2.p3.1.m1.1.1.cmml" xref="A1.SS4.SSS0.Px2.p3.1.m1.1.1"><eq id="A1.SS4.SSS0.Px2.p3.1.m1.1.1.1.cmml" xref="A1.SS4.SSS0.Px2.p3.1.m1.1.1.1"></eq><ci id="A1.SS4.SSS0.Px2.p3.1.m1.1.1.2.cmml" xref="A1.SS4.SSS0.Px2.p3.1.m1.1.1.2">𝑊</ci><apply id="A1.SS4.SSS0.Px2.p3.1.m1.1.1.3.cmml" xref="A1.SS4.SSS0.Px2.p3.1.m1.1.1.3"><times id="A1.SS4.SSS0.Px2.p3.1.m1.1.1.3.1.cmml" xref="A1.SS4.SSS0.Px2.p3.1.m1.1.1.3.1"></times><cn id="A1.SS4.SSS0.Px2.p3.1.m1.1.1.3.2.cmml" type="float" xref="A1.SS4.SSS0.Px2.p3.1.m1.1.1.3.2">1.3</cn><apply id="A1.SS4.SSS0.Px2.p3.1.m1.1.1.3.3.cmml" xref="A1.SS4.SSS0.Px2.p3.1.m1.1.1.3.3"><csymbol cd="ambiguous" id="A1.SS4.SSS0.Px2.p3.1.m1.1.1.3.3.1.cmml" xref="A1.SS4.SSS0.Px2.p3.1.m1.1.1.3.3">superscript</csymbol><cn id="A1.SS4.SSS0.Px2.p3.1.m1.1.1.3.3.2.cmml" type="integer" xref="A1.SS4.SSS0.Px2.p3.1.m1.1.1.3.3.2">10</cn><cn id="A1.SS4.SSS0.Px2.p3.1.m1.1.1.3.3.3.cmml" type="integer" xref="A1.SS4.SSS0.Px2.p3.1.m1.1.1.3.3.3">9</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS4.SSS0.Px2.p3.1.m1.1c">W=1.3\times 10^{9}</annotation><annotation encoding="application/x-llamapun" id="A1.SS4.SSS0.Px2.p3.1.m1.1d">italic_W = 1.3 × 10 start_POSTSUPERSCRIPT 9 end_POSTSUPERSCRIPT</annotation></semantics></math> parameters, then the amount of data transferred per node per training step is:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equation ltx_eqn_table" id="A1.Ex33">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\text{Data per node}=2\times 1.3\times 10^{9}\times 4=10.4\text{GB}" class="ltx_Math" display="block" id="A1.Ex33.m1.1"><semantics id="A1.Ex33.m1.1a"><mrow id="A1.Ex33.m1.1.1" xref="A1.Ex33.m1.1.1.cmml"><mtext id="A1.Ex33.m1.1.1.2" xref="A1.Ex33.m1.1.1.2a.cmml">Data per node</mtext><mo id="A1.Ex33.m1.1.1.3" xref="A1.Ex33.m1.1.1.3.cmml">=</mo><mrow id="A1.Ex33.m1.1.1.4" xref="A1.Ex33.m1.1.1.4.cmml"><mn id="A1.Ex33.m1.1.1.4.2" xref="A1.Ex33.m1.1.1.4.2.cmml">2</mn><mo id="A1.Ex33.m1.1.1.4.1" lspace="0.222em" rspace="0.222em" xref="A1.Ex33.m1.1.1.4.1.cmml">×</mo><mn id="A1.Ex33.m1.1.1.4.3" xref="A1.Ex33.m1.1.1.4.3.cmml">1.3</mn><mo id="A1.Ex33.m1.1.1.4.1a" lspace="0.222em" rspace="0.222em" xref="A1.Ex33.m1.1.1.4.1.cmml">×</mo><msup id="A1.Ex33.m1.1.1.4.4" xref="A1.Ex33.m1.1.1.4.4.cmml"><mn id="A1.Ex33.m1.1.1.4.4.2" xref="A1.Ex33.m1.1.1.4.4.2.cmml">10</mn><mn id="A1.Ex33.m1.1.1.4.4.3" xref="A1.Ex33.m1.1.1.4.4.3.cmml">9</mn></msup><mo id="A1.Ex33.m1.1.1.4.1b" lspace="0.222em" rspace="0.222em" xref="A1.Ex33.m1.1.1.4.1.cmml">×</mo><mn id="A1.Ex33.m1.1.1.4.5" xref="A1.Ex33.m1.1.1.4.5.cmml">4</mn></mrow><mo id="A1.Ex33.m1.1.1.5" xref="A1.Ex33.m1.1.1.5.cmml">=</mo><mrow id="A1.Ex33.m1.1.1.6" xref="A1.Ex33.m1.1.1.6.cmml"><mn id="A1.Ex33.m1.1.1.6.2" xref="A1.Ex33.m1.1.1.6.2.cmml">10.4</mn><mo id="A1.Ex33.m1.1.1.6.1" xref="A1.Ex33.m1.1.1.6.1.cmml">⁢</mo><mtext id="A1.Ex33.m1.1.1.6.3" xref="A1.Ex33.m1.1.1.6.3a.cmml">GB</mtext></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex33.m1.1b"><apply id="A1.Ex33.m1.1.1.cmml" xref="A1.Ex33.m1.1.1"><and id="A1.Ex33.m1.1.1a.cmml" xref="A1.Ex33.m1.1.1"></and><apply id="A1.Ex33.m1.1.1b.cmml" xref="A1.Ex33.m1.1.1"><eq id="A1.Ex33.m1.1.1.3.cmml" xref="A1.Ex33.m1.1.1.3"></eq><ci id="A1.Ex33.m1.1.1.2a.cmml" xref="A1.Ex33.m1.1.1.2"><mtext id="A1.Ex33.m1.1.1.2.cmml" xref="A1.Ex33.m1.1.1.2">Data per node</mtext></ci><apply id="A1.Ex33.m1.1.1.4.cmml" xref="A1.Ex33.m1.1.1.4"><times id="A1.Ex33.m1.1.1.4.1.cmml" xref="A1.Ex33.m1.1.1.4.1"></times><cn id="A1.Ex33.m1.1.1.4.2.cmml" type="integer" xref="A1.Ex33.m1.1.1.4.2">2</cn><cn id="A1.Ex33.m1.1.1.4.3.cmml" type="float" xref="A1.Ex33.m1.1.1.4.3">1.3</cn><apply id="A1.Ex33.m1.1.1.4.4.cmml" xref="A1.Ex33.m1.1.1.4.4"><csymbol cd="ambiguous" id="A1.Ex33.m1.1.1.4.4.1.cmml" xref="A1.Ex33.m1.1.1.4.4">superscript</csymbol><cn id="A1.Ex33.m1.1.1.4.4.2.cmml" type="integer" xref="A1.Ex33.m1.1.1.4.4.2">10</cn><cn id="A1.Ex33.m1.1.1.4.4.3.cmml" type="integer" xref="A1.Ex33.m1.1.1.4.4.3">9</cn></apply><cn id="A1.Ex33.m1.1.1.4.5.cmml" type="integer" xref="A1.Ex33.m1.1.1.4.5">4</cn></apply></apply><apply id="A1.Ex33.m1.1.1c.cmml" xref="A1.Ex33.m1.1.1"><eq id="A1.Ex33.m1.1.1.5.cmml" xref="A1.Ex33.m1.1.1.5"></eq><share href="https://arxiv.org/html/2410.03529v1#A1.Ex33.m1.1.1.4.cmml" id="A1.Ex33.m1.1.1d.cmml" xref="A1.Ex33.m1.1.1"></share><apply id="A1.Ex33.m1.1.1.6.cmml" xref="A1.Ex33.m1.1.1.6"><times id="A1.Ex33.m1.1.1.6.1.cmml" xref="A1.Ex33.m1.1.1.6.1"></times><cn id="A1.Ex33.m1.1.1.6.2.cmml" type="float" xref="A1.Ex33.m1.1.1.6.2">10.4</cn><ci id="A1.Ex33.m1.1.1.6.3a.cmml" xref="A1.Ex33.m1.1.1.6.3"><mtext id="A1.Ex33.m1.1.1.6.3.cmml" xref="A1.Ex33.m1.1.1.6.3">GB</mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex33.m1.1c">\text{Data per node}=2\times 1.3\times 10^{9}\times 4=10.4\text{GB}</annotation><annotation encoding="application/x-llamapun" id="A1.Ex33.m1.1d">Data per node = 2 × 1.3 × 10 start_POSTSUPERSCRIPT 9 end_POSTSUPERSCRIPT × 4 = 10.4 GB</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A1.SS4.SSS0.Px2.p3.2">Therefore, in regular distributed training, each node must send and receive <span class="ltx_text ltx_font_bold" id="A1.SS4.SSS0.Px2.p3.2.1">gigabytes</span> of data <span class="ltx_text ltx_font_bold" id="A1.SS4.SSS0.Px2.p3.2.2">at every step</span>. In contrast, our approach offers flexible communication strategies. We can transfer large volumes of data only a few times during training (see Equation <a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#A1.E17" title="In Mixture of LLMs ‣ A.4 Communication overhead ‣ Appendix A Language modeling experiments ‣ No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_tag">17</span></a>), or optimise for more frequent communications with smaller data sizes. This flexibility allows us to adapt based on network latency and other infrastructure constraints.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
</section>
</section>
<section class="ltx_appendix" id="A2">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>Downstream evaluation</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="A2.p1">
<p class="ltx_p" id="A2.p1.1">For the evaluation, we utilized the <span class="ltx_text ltx_font_italic" id="A2.p1.1.1">lm-eval-harness</span> software <cite class="ltx_cite ltx_citemacro_citep">(Gao et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#bib.bib17" title="">2024</a>)</cite>. For the computation of perplexity, we compute the perplexity using the format: “Question: {question}. Answer: {answer}.”</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_table" id="A2.T4">
<table class="ltx_tabular ltx_centering ltx_align_middle" id="A2.T4.68">
<tbody><tr class="ltx_tr" id="A2.T4.68.69">
<td class="ltx_td ltx_align_left ltx_border_t" id="A2.T4.68.69.1"><span class="ltx_text ltx_font_bold" id="A2.T4.68.69.1.1">Task</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T4.68.69.2"><span class="ltx_text ltx_font_bold" id="A2.T4.68.69.2.1">32 experts, 2T</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T4.68.69.3"><span class="ltx_text ltx_font_bold" id="A2.T4.68.69.3.1">dense, 2T</span></td>
</tr>
<tr class="ltx_tr" id="A2.T4.2.2">
<td class="ltx_td ltx_align_left ltx_border_t" id="A2.T4.2.2.3">mmlu abstract algebra</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T4.1.1.1"><math alttext="0.1400" class="ltx_Math" display="inline" id="A2.T4.1.1.1.m1.1"><semantics id="A2.T4.1.1.1.m1.1a"><mn id="A2.T4.1.1.1.m1.1.1" xref="A2.T4.1.1.1.m1.1.1.cmml">0.1400</mn><annotation-xml encoding="MathML-Content" id="A2.T4.1.1.1.m1.1b"><cn id="A2.T4.1.1.1.m1.1.1.cmml" type="float" xref="A2.T4.1.1.1.m1.1.1">0.1400</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T4.1.1.1.m1.1c">0.1400</annotation><annotation encoding="application/x-llamapun" id="A2.T4.1.1.1.m1.1d">0.1400</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T4.2.2.2"><math alttext="\mathbf{0.2300}" class="ltx_Math" display="inline" id="A2.T4.2.2.2.m1.1"><semantics id="A2.T4.2.2.2.m1.1a"><mn class="ltx_mathvariant_bold" id="A2.T4.2.2.2.m1.1.1" mathvariant="bold" xref="A2.T4.2.2.2.m1.1.1.cmml">0.2300</mn><annotation-xml encoding="MathML-Content" id="A2.T4.2.2.2.m1.1b"><cn id="A2.T4.2.2.2.m1.1.1.cmml" type="float" xref="A2.T4.2.2.2.m1.1.1">0.2300</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T4.2.2.2.m1.1c">\mathbf{0.2300}</annotation><annotation encoding="application/x-llamapun" id="A2.T4.2.2.2.m1.1d">bold_0.2300</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A2.T4.4.4">
<td class="ltx_td ltx_align_left" id="A2.T4.4.4.3">mmlu astronomy</td>
<td class="ltx_td ltx_align_center" id="A2.T4.3.3.1"><math alttext="\mathbf{0.3553}" class="ltx_Math" display="inline" id="A2.T4.3.3.1.m1.1"><semantics id="A2.T4.3.3.1.m1.1a"><mn class="ltx_mathvariant_bold" id="A2.T4.3.3.1.m1.1.1" mathvariant="bold" xref="A2.T4.3.3.1.m1.1.1.cmml">0.3553</mn><annotation-xml encoding="MathML-Content" id="A2.T4.3.3.1.m1.1b"><cn id="A2.T4.3.3.1.m1.1.1.cmml" type="float" xref="A2.T4.3.3.1.m1.1.1">0.3553</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T4.3.3.1.m1.1c">\mathbf{0.3553}</annotation><annotation encoding="application/x-llamapun" id="A2.T4.3.3.1.m1.1d">bold_0.3553</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="A2.T4.4.4.2"><math alttext="0.2829" class="ltx_Math" display="inline" id="A2.T4.4.4.2.m1.1"><semantics id="A2.T4.4.4.2.m1.1a"><mn id="A2.T4.4.4.2.m1.1.1" xref="A2.T4.4.4.2.m1.1.1.cmml">0.2829</mn><annotation-xml encoding="MathML-Content" id="A2.T4.4.4.2.m1.1b"><cn id="A2.T4.4.4.2.m1.1.1.cmml" type="float" xref="A2.T4.4.4.2.m1.1.1">0.2829</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T4.4.4.2.m1.1c">0.2829</annotation><annotation encoding="application/x-llamapun" id="A2.T4.4.4.2.m1.1d">0.2829</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A2.T4.6.6">
<td class="ltx_td ltx_align_left" id="A2.T4.6.6.3">mmlu business ethics</td>
<td class="ltx_td ltx_align_center" id="A2.T4.5.5.1"><math alttext="0.4900" class="ltx_Math" display="inline" id="A2.T4.5.5.1.m1.1"><semantics id="A2.T4.5.5.1.m1.1a"><mn id="A2.T4.5.5.1.m1.1.1" xref="A2.T4.5.5.1.m1.1.1.cmml">0.4900</mn><annotation-xml encoding="MathML-Content" id="A2.T4.5.5.1.m1.1b"><cn id="A2.T4.5.5.1.m1.1.1.cmml" type="float" xref="A2.T4.5.5.1.m1.1.1">0.4900</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T4.5.5.1.m1.1c">0.4900</annotation><annotation encoding="application/x-llamapun" id="A2.T4.5.5.1.m1.1d">0.4900</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="A2.T4.6.6.2"><math alttext="\mathbf{0.5300}" class="ltx_Math" display="inline" id="A2.T4.6.6.2.m1.1"><semantics id="A2.T4.6.6.2.m1.1a"><mn class="ltx_mathvariant_bold" id="A2.T4.6.6.2.m1.1.1" mathvariant="bold" xref="A2.T4.6.6.2.m1.1.1.cmml">0.5300</mn><annotation-xml encoding="MathML-Content" id="A2.T4.6.6.2.m1.1b"><cn id="A2.T4.6.6.2.m1.1.1.cmml" type="float" xref="A2.T4.6.6.2.m1.1.1">0.5300</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T4.6.6.2.m1.1c">\mathbf{0.5300}</annotation><annotation encoding="application/x-llamapun" id="A2.T4.6.6.2.m1.1d">bold_0.5300</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A2.T4.8.8">
<td class="ltx_td ltx_align_left" id="A2.T4.8.8.3">mmlu college computer science</td>
<td class="ltx_td ltx_align_center" id="A2.T4.7.7.1"><math alttext="0.2500" class="ltx_Math" display="inline" id="A2.T4.7.7.1.m1.1"><semantics id="A2.T4.7.7.1.m1.1a"><mn id="A2.T4.7.7.1.m1.1.1" xref="A2.T4.7.7.1.m1.1.1.cmml">0.2500</mn><annotation-xml encoding="MathML-Content" id="A2.T4.7.7.1.m1.1b"><cn id="A2.T4.7.7.1.m1.1.1.cmml" type="float" xref="A2.T4.7.7.1.m1.1.1">0.2500</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T4.7.7.1.m1.1c">0.2500</annotation><annotation encoding="application/x-llamapun" id="A2.T4.7.7.1.m1.1d">0.2500</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="A2.T4.8.8.2"><math alttext="\mathbf{0.2900}" class="ltx_Math" display="inline" id="A2.T4.8.8.2.m1.1"><semantics id="A2.T4.8.8.2.m1.1a"><mn class="ltx_mathvariant_bold" id="A2.T4.8.8.2.m1.1.1" mathvariant="bold" xref="A2.T4.8.8.2.m1.1.1.cmml">0.2900</mn><annotation-xml encoding="MathML-Content" id="A2.T4.8.8.2.m1.1b"><cn id="A2.T4.8.8.2.m1.1.1.cmml" type="float" xref="A2.T4.8.8.2.m1.1.1">0.2900</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T4.8.8.2.m1.1c">\mathbf{0.2900}</annotation><annotation encoding="application/x-llamapun" id="A2.T4.8.8.2.m1.1d">bold_0.2900</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A2.T4.10.10">
<td class="ltx_td ltx_align_left" id="A2.T4.10.10.3">mmlu college mathematics</td>
<td class="ltx_td ltx_align_center" id="A2.T4.9.9.1"><math alttext="\mathbf{0.1500}" class="ltx_Math" display="inline" id="A2.T4.9.9.1.m1.1"><semantics id="A2.T4.9.9.1.m1.1a"><mn class="ltx_mathvariant_bold" id="A2.T4.9.9.1.m1.1.1" mathvariant="bold" xref="A2.T4.9.9.1.m1.1.1.cmml">0.1500</mn><annotation-xml encoding="MathML-Content" id="A2.T4.9.9.1.m1.1b"><cn id="A2.T4.9.9.1.m1.1.1.cmml" type="float" xref="A2.T4.9.9.1.m1.1.1">0.1500</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T4.9.9.1.m1.1c">\mathbf{0.1500}</annotation><annotation encoding="application/x-llamapun" id="A2.T4.9.9.1.m1.1d">bold_0.1500</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="A2.T4.10.10.2"><math alttext="0.1400" class="ltx_Math" display="inline" id="A2.T4.10.10.2.m1.1"><semantics id="A2.T4.10.10.2.m1.1a"><mn id="A2.T4.10.10.2.m1.1.1" xref="A2.T4.10.10.2.m1.1.1.cmml">0.1400</mn><annotation-xml encoding="MathML-Content" id="A2.T4.10.10.2.m1.1b"><cn id="A2.T4.10.10.2.m1.1.1.cmml" type="float" xref="A2.T4.10.10.2.m1.1.1">0.1400</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T4.10.10.2.m1.1c">0.1400</annotation><annotation encoding="application/x-llamapun" id="A2.T4.10.10.2.m1.1d">0.1400</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A2.T4.12.12">
<td class="ltx_td ltx_align_left" id="A2.T4.12.12.3">mmlu computer security</td>
<td class="ltx_td ltx_align_center" id="A2.T4.11.11.1"><math alttext="0.3500" class="ltx_Math" display="inline" id="A2.T4.11.11.1.m1.1"><semantics id="A2.T4.11.11.1.m1.1a"><mn id="A2.T4.11.11.1.m1.1.1" xref="A2.T4.11.11.1.m1.1.1.cmml">0.3500</mn><annotation-xml encoding="MathML-Content" id="A2.T4.11.11.1.m1.1b"><cn id="A2.T4.11.11.1.m1.1.1.cmml" type="float" xref="A2.T4.11.11.1.m1.1.1">0.3500</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T4.11.11.1.m1.1c">0.3500</annotation><annotation encoding="application/x-llamapun" id="A2.T4.11.11.1.m1.1d">0.3500</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="A2.T4.12.12.2"><math alttext="\mathbf{0.3800}" class="ltx_Math" display="inline" id="A2.T4.12.12.2.m1.1"><semantics id="A2.T4.12.12.2.m1.1a"><mn class="ltx_mathvariant_bold" id="A2.T4.12.12.2.m1.1.1" mathvariant="bold" xref="A2.T4.12.12.2.m1.1.1.cmml">0.3800</mn><annotation-xml encoding="MathML-Content" id="A2.T4.12.12.2.m1.1b"><cn id="A2.T4.12.12.2.m1.1.1.cmml" type="float" xref="A2.T4.12.12.2.m1.1.1">0.3800</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T4.12.12.2.m1.1c">\mathbf{0.3800}</annotation><annotation encoding="application/x-llamapun" id="A2.T4.12.12.2.m1.1d">bold_0.3800</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A2.T4.14.14">
<td class="ltx_td ltx_align_left" id="A2.T4.14.14.3">mmlu elementary mathematics</td>
<td class="ltx_td ltx_align_center" id="A2.T4.13.13.1"><math alttext="\mathbf{0.2672}" class="ltx_Math" display="inline" id="A2.T4.13.13.1.m1.1"><semantics id="A2.T4.13.13.1.m1.1a"><mn class="ltx_mathvariant_bold" id="A2.T4.13.13.1.m1.1.1" mathvariant="bold" xref="A2.T4.13.13.1.m1.1.1.cmml">0.2672</mn><annotation-xml encoding="MathML-Content" id="A2.T4.13.13.1.m1.1b"><cn id="A2.T4.13.13.1.m1.1.1.cmml" type="float" xref="A2.T4.13.13.1.m1.1.1">0.2672</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T4.13.13.1.m1.1c">\mathbf{0.2672}</annotation><annotation encoding="application/x-llamapun" id="A2.T4.13.13.1.m1.1d">bold_0.2672</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="A2.T4.14.14.2"><math alttext="0.2487" class="ltx_Math" display="inline" id="A2.T4.14.14.2.m1.1"><semantics id="A2.T4.14.14.2.m1.1a"><mn id="A2.T4.14.14.2.m1.1.1" xref="A2.T4.14.14.2.m1.1.1.cmml">0.2487</mn><annotation-xml encoding="MathML-Content" id="A2.T4.14.14.2.m1.1b"><cn id="A2.T4.14.14.2.m1.1.1.cmml" type="float" xref="A2.T4.14.14.2.m1.1.1">0.2487</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T4.14.14.2.m1.1c">0.2487</annotation><annotation encoding="application/x-llamapun" id="A2.T4.14.14.2.m1.1d">0.2487</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A2.T4.16.16">
<td class="ltx_td ltx_align_left" id="A2.T4.16.16.3">mmlu formal logic</td>
<td class="ltx_td ltx_align_center" id="A2.T4.15.15.1"><math alttext="\mathbf{0.3016}" class="ltx_Math" display="inline" id="A2.T4.15.15.1.m1.1"><semantics id="A2.T4.15.15.1.m1.1a"><mn class="ltx_mathvariant_bold" id="A2.T4.15.15.1.m1.1.1" mathvariant="bold" xref="A2.T4.15.15.1.m1.1.1.cmml">0.3016</mn><annotation-xml encoding="MathML-Content" id="A2.T4.15.15.1.m1.1b"><cn id="A2.T4.15.15.1.m1.1.1.cmml" type="float" xref="A2.T4.15.15.1.m1.1.1">0.3016</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T4.15.15.1.m1.1c">\mathbf{0.3016}</annotation><annotation encoding="application/x-llamapun" id="A2.T4.15.15.1.m1.1d">bold_0.3016</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="A2.T4.16.16.2"><math alttext="0.2937" class="ltx_Math" display="inline" id="A2.T4.16.16.2.m1.1"><semantics id="A2.T4.16.16.2.m1.1a"><mn id="A2.T4.16.16.2.m1.1.1" xref="A2.T4.16.16.2.m1.1.1.cmml">0.2937</mn><annotation-xml encoding="MathML-Content" id="A2.T4.16.16.2.m1.1b"><cn id="A2.T4.16.16.2.m1.1.1.cmml" type="float" xref="A2.T4.16.16.2.m1.1.1">0.2937</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T4.16.16.2.m1.1c">0.2937</annotation><annotation encoding="application/x-llamapun" id="A2.T4.16.16.2.m1.1d">0.2937</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A2.T4.18.18">
<td class="ltx_td ltx_align_left" id="A2.T4.18.18.3">mmlu global facts</td>
<td class="ltx_td ltx_align_center" id="A2.T4.17.17.1"><math alttext="\mathbf{0.3100}" class="ltx_Math" display="inline" id="A2.T4.17.17.1.m1.1"><semantics id="A2.T4.17.17.1.m1.1a"><mn class="ltx_mathvariant_bold" id="A2.T4.17.17.1.m1.1.1" mathvariant="bold" xref="A2.T4.17.17.1.m1.1.1.cmml">0.3100</mn><annotation-xml encoding="MathML-Content" id="A2.T4.17.17.1.m1.1b"><cn id="A2.T4.17.17.1.m1.1.1.cmml" type="float" xref="A2.T4.17.17.1.m1.1.1">0.3100</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T4.17.17.1.m1.1c">\mathbf{0.3100}</annotation><annotation encoding="application/x-llamapun" id="A2.T4.17.17.1.m1.1d">bold_0.3100</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="A2.T4.18.18.2"><math alttext="0.2800" class="ltx_Math" display="inline" id="A2.T4.18.18.2.m1.1"><semantics id="A2.T4.18.18.2.m1.1a"><mn id="A2.T4.18.18.2.m1.1.1" xref="A2.T4.18.18.2.m1.1.1.cmml">0.2800</mn><annotation-xml encoding="MathML-Content" id="A2.T4.18.18.2.m1.1b"><cn id="A2.T4.18.18.2.m1.1.1.cmml" type="float" xref="A2.T4.18.18.2.m1.1.1">0.2800</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T4.18.18.2.m1.1c">0.2800</annotation><annotation encoding="application/x-llamapun" id="A2.T4.18.18.2.m1.1d">0.2800</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A2.T4.20.20">
<td class="ltx_td ltx_align_left" id="A2.T4.20.20.3">mmlu high school geography</td>
<td class="ltx_td ltx_align_center" id="A2.T4.19.19.1"><math alttext="\mathbf{0.3586}" class="ltx_Math" display="inline" id="A2.T4.19.19.1.m1.1"><semantics id="A2.T4.19.19.1.m1.1a"><mn class="ltx_mathvariant_bold" id="A2.T4.19.19.1.m1.1.1" mathvariant="bold" xref="A2.T4.19.19.1.m1.1.1.cmml">0.3586</mn><annotation-xml encoding="MathML-Content" id="A2.T4.19.19.1.m1.1b"><cn id="A2.T4.19.19.1.m1.1.1.cmml" type="float" xref="A2.T4.19.19.1.m1.1.1">0.3586</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T4.19.19.1.m1.1c">\mathbf{0.3586}</annotation><annotation encoding="application/x-llamapun" id="A2.T4.19.19.1.m1.1d">bold_0.3586</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="A2.T4.20.20.2"><math alttext="\mathbf{0.3586}" class="ltx_Math" display="inline" id="A2.T4.20.20.2.m1.1"><semantics id="A2.T4.20.20.2.m1.1a"><mn class="ltx_mathvariant_bold" id="A2.T4.20.20.2.m1.1.1" mathvariant="bold" xref="A2.T4.20.20.2.m1.1.1.cmml">0.3586</mn><annotation-xml encoding="MathML-Content" id="A2.T4.20.20.2.m1.1b"><cn id="A2.T4.20.20.2.m1.1.1.cmml" type="float" xref="A2.T4.20.20.2.m1.1.1">0.3586</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T4.20.20.2.m1.1c">\mathbf{0.3586}</annotation><annotation encoding="application/x-llamapun" id="A2.T4.20.20.2.m1.1d">bold_0.3586</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A2.T4.22.22">
<td class="ltx_td ltx_align_left" id="A2.T4.22.22.3">mmlu high school macroeconomics</td>
<td class="ltx_td ltx_align_center" id="A2.T4.21.21.1"><math alttext="\mathbf{0.3128}" class="ltx_Math" display="inline" id="A2.T4.21.21.1.m1.1"><semantics id="A2.T4.21.21.1.m1.1a"><mn class="ltx_mathvariant_bold" id="A2.T4.21.21.1.m1.1.1" mathvariant="bold" xref="A2.T4.21.21.1.m1.1.1.cmml">0.3128</mn><annotation-xml encoding="MathML-Content" id="A2.T4.21.21.1.m1.1b"><cn id="A2.T4.21.21.1.m1.1.1.cmml" type="float" xref="A2.T4.21.21.1.m1.1.1">0.3128</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T4.21.21.1.m1.1c">\mathbf{0.3128}</annotation><annotation encoding="application/x-llamapun" id="A2.T4.21.21.1.m1.1d">bold_0.3128</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="A2.T4.22.22.2"><math alttext="0.2872" class="ltx_Math" display="inline" id="A2.T4.22.22.2.m1.1"><semantics id="A2.T4.22.22.2.m1.1a"><mn id="A2.T4.22.22.2.m1.1.1" xref="A2.T4.22.22.2.m1.1.1.cmml">0.2872</mn><annotation-xml encoding="MathML-Content" id="A2.T4.22.22.2.m1.1b"><cn id="A2.T4.22.22.2.m1.1.1.cmml" type="float" xref="A2.T4.22.22.2.m1.1.1">0.2872</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T4.22.22.2.m1.1c">0.2872</annotation><annotation encoding="application/x-llamapun" id="A2.T4.22.22.2.m1.1d">0.2872</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A2.T4.24.24">
<td class="ltx_td ltx_align_left" id="A2.T4.24.24.3">mmlu high school microeconomics</td>
<td class="ltx_td ltx_align_center" id="A2.T4.23.23.1"><math alttext="\mathbf{0.3193}" class="ltx_Math" display="inline" id="A2.T4.23.23.1.m1.1"><semantics id="A2.T4.23.23.1.m1.1a"><mn class="ltx_mathvariant_bold" id="A2.T4.23.23.1.m1.1.1" mathvariant="bold" xref="A2.T4.23.23.1.m1.1.1.cmml">0.3193</mn><annotation-xml encoding="MathML-Content" id="A2.T4.23.23.1.m1.1b"><cn id="A2.T4.23.23.1.m1.1.1.cmml" type="float" xref="A2.T4.23.23.1.m1.1.1">0.3193</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T4.23.23.1.m1.1c">\mathbf{0.3193}</annotation><annotation encoding="application/x-llamapun" id="A2.T4.23.23.1.m1.1d">bold_0.3193</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="A2.T4.24.24.2"><math alttext="\mathbf{0.3193}" class="ltx_Math" display="inline" id="A2.T4.24.24.2.m1.1"><semantics id="A2.T4.24.24.2.m1.1a"><mn class="ltx_mathvariant_bold" id="A2.T4.24.24.2.m1.1.1" mathvariant="bold" xref="A2.T4.24.24.2.m1.1.1.cmml">0.3193</mn><annotation-xml encoding="MathML-Content" id="A2.T4.24.24.2.m1.1b"><cn id="A2.T4.24.24.2.m1.1.1.cmml" type="float" xref="A2.T4.24.24.2.m1.1.1">0.3193</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T4.24.24.2.m1.1c">\mathbf{0.3193}</annotation><annotation encoding="application/x-llamapun" id="A2.T4.24.24.2.m1.1d">bold_0.3193</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A2.T4.26.26">
<td class="ltx_td ltx_align_left" id="A2.T4.26.26.3">mmlu high school statistics</td>
<td class="ltx_td ltx_align_center" id="A2.T4.25.25.1"><math alttext="\mathbf{0.2917}" class="ltx_Math" display="inline" id="A2.T4.25.25.1.m1.1"><semantics id="A2.T4.25.25.1.m1.1a"><mn class="ltx_mathvariant_bold" id="A2.T4.25.25.1.m1.1.1" mathvariant="bold" xref="A2.T4.25.25.1.m1.1.1.cmml">0.2917</mn><annotation-xml encoding="MathML-Content" id="A2.T4.25.25.1.m1.1b"><cn id="A2.T4.25.25.1.m1.1.1.cmml" type="float" xref="A2.T4.25.25.1.m1.1.1">0.2917</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T4.25.25.1.m1.1c">\mathbf{0.2917}</annotation><annotation encoding="application/x-llamapun" id="A2.T4.25.25.1.m1.1d">bold_0.2917</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="A2.T4.26.26.2"><math alttext="0.2593" class="ltx_Math" display="inline" id="A2.T4.26.26.2.m1.1"><semantics id="A2.T4.26.26.2.m1.1a"><mn id="A2.T4.26.26.2.m1.1.1" xref="A2.T4.26.26.2.m1.1.1.cmml">0.2593</mn><annotation-xml encoding="MathML-Content" id="A2.T4.26.26.2.m1.1b"><cn id="A2.T4.26.26.2.m1.1.1.cmml" type="float" xref="A2.T4.26.26.2.m1.1.1">0.2593</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T4.26.26.2.m1.1c">0.2593</annotation><annotation encoding="application/x-llamapun" id="A2.T4.26.26.2.m1.1d">0.2593</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A2.T4.28.28">
<td class="ltx_td ltx_align_left" id="A2.T4.28.28.3">mmlu human aging</td>
<td class="ltx_td ltx_align_center" id="A2.T4.27.27.1"><math alttext="\mathbf{0.4081}" class="ltx_Math" display="inline" id="A2.T4.27.27.1.m1.1"><semantics id="A2.T4.27.27.1.m1.1a"><mn class="ltx_mathvariant_bold" id="A2.T4.27.27.1.m1.1.1" mathvariant="bold" xref="A2.T4.27.27.1.m1.1.1.cmml">0.4081</mn><annotation-xml encoding="MathML-Content" id="A2.T4.27.27.1.m1.1b"><cn id="A2.T4.27.27.1.m1.1.1.cmml" type="float" xref="A2.T4.27.27.1.m1.1.1">0.4081</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T4.27.27.1.m1.1c">\mathbf{0.4081}</annotation><annotation encoding="application/x-llamapun" id="A2.T4.27.27.1.m1.1d">bold_0.4081</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="A2.T4.28.28.2"><math alttext="0.3857" class="ltx_Math" display="inline" id="A2.T4.28.28.2.m1.1"><semantics id="A2.T4.28.28.2.m1.1a"><mn id="A2.T4.28.28.2.m1.1.1" xref="A2.T4.28.28.2.m1.1.1.cmml">0.3857</mn><annotation-xml encoding="MathML-Content" id="A2.T4.28.28.2.m1.1b"><cn id="A2.T4.28.28.2.m1.1.1.cmml" type="float" xref="A2.T4.28.28.2.m1.1.1">0.3857</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T4.28.28.2.m1.1c">0.3857</annotation><annotation encoding="application/x-llamapun" id="A2.T4.28.28.2.m1.1d">0.3857</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A2.T4.30.30">
<td class="ltx_td ltx_align_left" id="A2.T4.30.30.3">mmlu human sexuality</td>
<td class="ltx_td ltx_align_center" id="A2.T4.29.29.1"><math alttext="\mathbf{0.3969}" class="ltx_Math" display="inline" id="A2.T4.29.29.1.m1.1"><semantics id="A2.T4.29.29.1.m1.1a"><mn class="ltx_mathvariant_bold" id="A2.T4.29.29.1.m1.1.1" mathvariant="bold" xref="A2.T4.29.29.1.m1.1.1.cmml">0.3969</mn><annotation-xml encoding="MathML-Content" id="A2.T4.29.29.1.m1.1b"><cn id="A2.T4.29.29.1.m1.1.1.cmml" type="float" xref="A2.T4.29.29.1.m1.1.1">0.3969</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T4.29.29.1.m1.1c">\mathbf{0.3969}</annotation><annotation encoding="application/x-llamapun" id="A2.T4.29.29.1.m1.1d">bold_0.3969</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="A2.T4.30.30.2"><math alttext="0.3893" class="ltx_Math" display="inline" id="A2.T4.30.30.2.m1.1"><semantics id="A2.T4.30.30.2.m1.1a"><mn id="A2.T4.30.30.2.m1.1.1" xref="A2.T4.30.30.2.m1.1.1.cmml">0.3893</mn><annotation-xml encoding="MathML-Content" id="A2.T4.30.30.2.m1.1b"><cn id="A2.T4.30.30.2.m1.1.1.cmml" type="float" xref="A2.T4.30.30.2.m1.1.1">0.3893</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T4.30.30.2.m1.1c">0.3893</annotation><annotation encoding="application/x-llamapun" id="A2.T4.30.30.2.m1.1d">0.3893</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A2.T4.32.32">
<td class="ltx_td ltx_align_left" id="A2.T4.32.32.3">mmlu international law</td>
<td class="ltx_td ltx_align_center" id="A2.T4.31.31.1"><math alttext="\mathbf{0.2314}" class="ltx_Math" display="inline" id="A2.T4.31.31.1.m1.1"><semantics id="A2.T4.31.31.1.m1.1a"><mn class="ltx_mathvariant_bold" id="A2.T4.31.31.1.m1.1.1" mathvariant="bold" xref="A2.T4.31.31.1.m1.1.1.cmml">0.2314</mn><annotation-xml encoding="MathML-Content" id="A2.T4.31.31.1.m1.1b"><cn id="A2.T4.31.31.1.m1.1.1.cmml" type="float" xref="A2.T4.31.31.1.m1.1.1">0.2314</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T4.31.31.1.m1.1c">\mathbf{0.2314}</annotation><annotation encoding="application/x-llamapun" id="A2.T4.31.31.1.m1.1d">bold_0.2314</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="A2.T4.32.32.2"><math alttext="\mathbf{0.2314}" class="ltx_Math" display="inline" id="A2.T4.32.32.2.m1.1"><semantics id="A2.T4.32.32.2.m1.1a"><mn class="ltx_mathvariant_bold" id="A2.T4.32.32.2.m1.1.1" mathvariant="bold" xref="A2.T4.32.32.2.m1.1.1.cmml">0.2314</mn><annotation-xml encoding="MathML-Content" id="A2.T4.32.32.2.m1.1b"><cn id="A2.T4.32.32.2.m1.1.1.cmml" type="float" xref="A2.T4.32.32.2.m1.1.1">0.2314</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T4.32.32.2.m1.1c">\mathbf{0.2314}</annotation><annotation encoding="application/x-llamapun" id="A2.T4.32.32.2.m1.1d">bold_0.2314</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A2.T4.34.34">
<td class="ltx_td ltx_align_left" id="A2.T4.34.34.3">mmlu logical fallacies</td>
<td class="ltx_td ltx_align_center" id="A2.T4.33.33.1"><math alttext="\mathbf{0.3067}" class="ltx_Math" display="inline" id="A2.T4.33.33.1.m1.1"><semantics id="A2.T4.33.33.1.m1.1a"><mn class="ltx_mathvariant_bold" id="A2.T4.33.33.1.m1.1.1" mathvariant="bold" xref="A2.T4.33.33.1.m1.1.1.cmml">0.3067</mn><annotation-xml encoding="MathML-Content" id="A2.T4.33.33.1.m1.1b"><cn id="A2.T4.33.33.1.m1.1.1.cmml" type="float" xref="A2.T4.33.33.1.m1.1.1">0.3067</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T4.33.33.1.m1.1c">\mathbf{0.3067}</annotation><annotation encoding="application/x-llamapun" id="A2.T4.33.33.1.m1.1d">bold_0.3067</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="A2.T4.34.34.2"><math alttext="0.2945" class="ltx_Math" display="inline" id="A2.T4.34.34.2.m1.1"><semantics id="A2.T4.34.34.2.m1.1a"><mn id="A2.T4.34.34.2.m1.1.1" xref="A2.T4.34.34.2.m1.1.1.cmml">0.2945</mn><annotation-xml encoding="MathML-Content" id="A2.T4.34.34.2.m1.1b"><cn id="A2.T4.34.34.2.m1.1.1.cmml" type="float" xref="A2.T4.34.34.2.m1.1.1">0.2945</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T4.34.34.2.m1.1c">0.2945</annotation><annotation encoding="application/x-llamapun" id="A2.T4.34.34.2.m1.1d">0.2945</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A2.T4.36.36">
<td class="ltx_td ltx_align_left" id="A2.T4.36.36.3">mmlu machine learning</td>
<td class="ltx_td ltx_align_center" id="A2.T4.35.35.1"><math alttext="0.2589" class="ltx_Math" display="inline" id="A2.T4.35.35.1.m1.1"><semantics id="A2.T4.35.35.1.m1.1a"><mn id="A2.T4.35.35.1.m1.1.1" xref="A2.T4.35.35.1.m1.1.1.cmml">0.2589</mn><annotation-xml encoding="MathML-Content" id="A2.T4.35.35.1.m1.1b"><cn id="A2.T4.35.35.1.m1.1.1.cmml" type="float" xref="A2.T4.35.35.1.m1.1.1">0.2589</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T4.35.35.1.m1.1c">0.2589</annotation><annotation encoding="application/x-llamapun" id="A2.T4.35.35.1.m1.1d">0.2589</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="A2.T4.36.36.2"><math alttext="\mathbf{0.2679}" class="ltx_Math" display="inline" id="A2.T4.36.36.2.m1.1"><semantics id="A2.T4.36.36.2.m1.1a"><mn class="ltx_mathvariant_bold" id="A2.T4.36.36.2.m1.1.1" mathvariant="bold" xref="A2.T4.36.36.2.m1.1.1.cmml">0.2679</mn><annotation-xml encoding="MathML-Content" id="A2.T4.36.36.2.m1.1b"><cn id="A2.T4.36.36.2.m1.1.1.cmml" type="float" xref="A2.T4.36.36.2.m1.1.1">0.2679</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T4.36.36.2.m1.1c">\mathbf{0.2679}</annotation><annotation encoding="application/x-llamapun" id="A2.T4.36.36.2.m1.1d">bold_0.2679</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A2.T4.38.38">
<td class="ltx_td ltx_align_left" id="A2.T4.38.38.3">mmlu medical genetics</td>
<td class="ltx_td ltx_align_center" id="A2.T4.37.37.1"><math alttext="\mathbf{0.3900}" class="ltx_Math" display="inline" id="A2.T4.37.37.1.m1.1"><semantics id="A2.T4.37.37.1.m1.1a"><mn class="ltx_mathvariant_bold" id="A2.T4.37.37.1.m1.1.1" mathvariant="bold" xref="A2.T4.37.37.1.m1.1.1.cmml">0.3900</mn><annotation-xml encoding="MathML-Content" id="A2.T4.37.37.1.m1.1b"><cn id="A2.T4.37.37.1.m1.1.1.cmml" type="float" xref="A2.T4.37.37.1.m1.1.1">0.3900</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T4.37.37.1.m1.1c">\mathbf{0.3900}</annotation><annotation encoding="application/x-llamapun" id="A2.T4.37.37.1.m1.1d">bold_0.3900</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="A2.T4.38.38.2"><math alttext="0.3500" class="ltx_Math" display="inline" id="A2.T4.38.38.2.m1.1"><semantics id="A2.T4.38.38.2.m1.1a"><mn id="A2.T4.38.38.2.m1.1.1" xref="A2.T4.38.38.2.m1.1.1.cmml">0.3500</mn><annotation-xml encoding="MathML-Content" id="A2.T4.38.38.2.m1.1b"><cn id="A2.T4.38.38.2.m1.1.1.cmml" type="float" xref="A2.T4.38.38.2.m1.1.1">0.3500</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T4.38.38.2.m1.1c">0.3500</annotation><annotation encoding="application/x-llamapun" id="A2.T4.38.38.2.m1.1d">0.3500</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A2.T4.40.40">
<td class="ltx_td ltx_align_left" id="A2.T4.40.40.3">mmlu moral disputes</td>
<td class="ltx_td ltx_align_center" id="A2.T4.39.39.1"><math alttext="0.2803" class="ltx_Math" display="inline" id="A2.T4.39.39.1.m1.1"><semantics id="A2.T4.39.39.1.m1.1a"><mn id="A2.T4.39.39.1.m1.1.1" xref="A2.T4.39.39.1.m1.1.1.cmml">0.2803</mn><annotation-xml encoding="MathML-Content" id="A2.T4.39.39.1.m1.1b"><cn id="A2.T4.39.39.1.m1.1.1.cmml" type="float" xref="A2.T4.39.39.1.m1.1.1">0.2803</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T4.39.39.1.m1.1c">0.2803</annotation><annotation encoding="application/x-llamapun" id="A2.T4.39.39.1.m1.1d">0.2803</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="A2.T4.40.40.2"><math alttext="\mathbf{0.2890}" class="ltx_Math" display="inline" id="A2.T4.40.40.2.m1.1"><semantics id="A2.T4.40.40.2.m1.1a"><mn class="ltx_mathvariant_bold" id="A2.T4.40.40.2.m1.1.1" mathvariant="bold" xref="A2.T4.40.40.2.m1.1.1.cmml">0.2890</mn><annotation-xml encoding="MathML-Content" id="A2.T4.40.40.2.m1.1b"><cn id="A2.T4.40.40.2.m1.1.1.cmml" type="float" xref="A2.T4.40.40.2.m1.1.1">0.2890</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T4.40.40.2.m1.1c">\mathbf{0.2890}</annotation><annotation encoding="application/x-llamapun" id="A2.T4.40.40.2.m1.1d">bold_0.2890</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A2.T4.42.42">
<td class="ltx_td ltx_align_left" id="A2.T4.42.42.3">mmlu moral scenarios</td>
<td class="ltx_td ltx_align_center" id="A2.T4.41.41.1"><math alttext="\mathbf{0.2380}" class="ltx_Math" display="inline" id="A2.T4.41.41.1.m1.1"><semantics id="A2.T4.41.41.1.m1.1a"><mn class="ltx_mathvariant_bold" id="A2.T4.41.41.1.m1.1.1" mathvariant="bold" xref="A2.T4.41.41.1.m1.1.1.cmml">0.2380</mn><annotation-xml encoding="MathML-Content" id="A2.T4.41.41.1.m1.1b"><cn id="A2.T4.41.41.1.m1.1.1.cmml" type="float" xref="A2.T4.41.41.1.m1.1.1">0.2380</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T4.41.41.1.m1.1c">\mathbf{0.2380}</annotation><annotation encoding="application/x-llamapun" id="A2.T4.41.41.1.m1.1d">bold_0.2380</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="A2.T4.42.42.2"><math alttext="\mathbf{0.2380}" class="ltx_Math" display="inline" id="A2.T4.42.42.2.m1.1"><semantics id="A2.T4.42.42.2.m1.1a"><mn class="ltx_mathvariant_bold" id="A2.T4.42.42.2.m1.1.1" mathvariant="bold" xref="A2.T4.42.42.2.m1.1.1.cmml">0.2380</mn><annotation-xml encoding="MathML-Content" id="A2.T4.42.42.2.m1.1b"><cn id="A2.T4.42.42.2.m1.1.1.cmml" type="float" xref="A2.T4.42.42.2.m1.1.1">0.2380</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T4.42.42.2.m1.1c">\mathbf{0.2380}</annotation><annotation encoding="application/x-llamapun" id="A2.T4.42.42.2.m1.1d">bold_0.2380</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A2.T4.44.44">
<td class="ltx_td ltx_align_left" id="A2.T4.44.44.3">mmlu nutrition</td>
<td class="ltx_td ltx_align_center" id="A2.T4.43.43.1"><math alttext="\mathbf{0.3039}" class="ltx_Math" display="inline" id="A2.T4.43.43.1.m1.1"><semantics id="A2.T4.43.43.1.m1.1a"><mn class="ltx_mathvariant_bold" id="A2.T4.43.43.1.m1.1.1" mathvariant="bold" xref="A2.T4.43.43.1.m1.1.1.cmml">0.3039</mn><annotation-xml encoding="MathML-Content" id="A2.T4.43.43.1.m1.1b"><cn id="A2.T4.43.43.1.m1.1.1.cmml" type="float" xref="A2.T4.43.43.1.m1.1.1">0.3039</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T4.43.43.1.m1.1c">\mathbf{0.3039}</annotation><annotation encoding="application/x-llamapun" id="A2.T4.43.43.1.m1.1d">bold_0.3039</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="A2.T4.44.44.2"><math alttext="0.2516" class="ltx_Math" display="inline" id="A2.T4.44.44.2.m1.1"><semantics id="A2.T4.44.44.2.m1.1a"><mn id="A2.T4.44.44.2.m1.1.1" xref="A2.T4.44.44.2.m1.1.1.cmml">0.2516</mn><annotation-xml encoding="MathML-Content" id="A2.T4.44.44.2.m1.1b"><cn id="A2.T4.44.44.2.m1.1.1.cmml" type="float" xref="A2.T4.44.44.2.m1.1.1">0.2516</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T4.44.44.2.m1.1c">0.2516</annotation><annotation encoding="application/x-llamapun" id="A2.T4.44.44.2.m1.1d">0.2516</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A2.T4.46.46">
<td class="ltx_td ltx_align_left" id="A2.T4.46.46.3">mmlu prehistory</td>
<td class="ltx_td ltx_align_center" id="A2.T4.45.45.1"><math alttext="\mathbf{0.4167}" class="ltx_Math" display="inline" id="A2.T4.45.45.1.m1.1"><semantics id="A2.T4.45.45.1.m1.1a"><mn class="ltx_mathvariant_bold" id="A2.T4.45.45.1.m1.1.1" mathvariant="bold" xref="A2.T4.45.45.1.m1.1.1.cmml">0.4167</mn><annotation-xml encoding="MathML-Content" id="A2.T4.45.45.1.m1.1b"><cn id="A2.T4.45.45.1.m1.1.1.cmml" type="float" xref="A2.T4.45.45.1.m1.1.1">0.4167</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T4.45.45.1.m1.1c">\mathbf{0.4167}</annotation><annotation encoding="application/x-llamapun" id="A2.T4.45.45.1.m1.1d">bold_0.4167</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="A2.T4.46.46.2"><math alttext="0.3858" class="ltx_Math" display="inline" id="A2.T4.46.46.2.m1.1"><semantics id="A2.T4.46.46.2.m1.1a"><mn id="A2.T4.46.46.2.m1.1.1" xref="A2.T4.46.46.2.m1.1.1.cmml">0.3858</mn><annotation-xml encoding="MathML-Content" id="A2.T4.46.46.2.m1.1b"><cn id="A2.T4.46.46.2.m1.1.1.cmml" type="float" xref="A2.T4.46.46.2.m1.1.1">0.3858</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T4.46.46.2.m1.1c">0.3858</annotation><annotation encoding="application/x-llamapun" id="A2.T4.46.46.2.m1.1d">0.3858</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A2.T4.48.48">
<td class="ltx_td ltx_align_left" id="A2.T4.48.48.3">mmlu professional accounting</td>
<td class="ltx_td ltx_align_center" id="A2.T4.47.47.1"><math alttext="\mathbf{0.2872}" class="ltx_Math" display="inline" id="A2.T4.47.47.1.m1.1"><semantics id="A2.T4.47.47.1.m1.1a"><mn class="ltx_mathvariant_bold" id="A2.T4.47.47.1.m1.1.1" mathvariant="bold" xref="A2.T4.47.47.1.m1.1.1.cmml">0.2872</mn><annotation-xml encoding="MathML-Content" id="A2.T4.47.47.1.m1.1b"><cn id="A2.T4.47.47.1.m1.1.1.cmml" type="float" xref="A2.T4.47.47.1.m1.1.1">0.2872</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T4.47.47.1.m1.1c">\mathbf{0.2872}</annotation><annotation encoding="application/x-llamapun" id="A2.T4.47.47.1.m1.1d">bold_0.2872</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="A2.T4.48.48.2"><math alttext="0.2518" class="ltx_Math" display="inline" id="A2.T4.48.48.2.m1.1"><semantics id="A2.T4.48.48.2.m1.1a"><mn id="A2.T4.48.48.2.m1.1.1" xref="A2.T4.48.48.2.m1.1.1.cmml">0.2518</mn><annotation-xml encoding="MathML-Content" id="A2.T4.48.48.2.m1.1b"><cn id="A2.T4.48.48.2.m1.1.1.cmml" type="float" xref="A2.T4.48.48.2.m1.1.1">0.2518</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T4.48.48.2.m1.1c">0.2518</annotation><annotation encoding="application/x-llamapun" id="A2.T4.48.48.2.m1.1d">0.2518</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A2.T4.50.50">
<td class="ltx_td ltx_align_left" id="A2.T4.50.50.3">mmlu professional medicine</td>
<td class="ltx_td ltx_align_center" id="A2.T4.49.49.1"><math alttext="\mathbf{0.3566}" class="ltx_Math" display="inline" id="A2.T4.49.49.1.m1.1"><semantics id="A2.T4.49.49.1.m1.1a"><mn class="ltx_mathvariant_bold" id="A2.T4.49.49.1.m1.1.1" mathvariant="bold" xref="A2.T4.49.49.1.m1.1.1.cmml">0.3566</mn><annotation-xml encoding="MathML-Content" id="A2.T4.49.49.1.m1.1b"><cn id="A2.T4.49.49.1.m1.1.1.cmml" type="float" xref="A2.T4.49.49.1.m1.1.1">0.3566</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T4.49.49.1.m1.1c">\mathbf{0.3566}</annotation><annotation encoding="application/x-llamapun" id="A2.T4.49.49.1.m1.1d">bold_0.3566</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="A2.T4.50.50.2"><math alttext="0.2904" class="ltx_Math" display="inline" id="A2.T4.50.50.2.m1.1"><semantics id="A2.T4.50.50.2.m1.1a"><mn id="A2.T4.50.50.2.m1.1.1" xref="A2.T4.50.50.2.m1.1.1.cmml">0.2904</mn><annotation-xml encoding="MathML-Content" id="A2.T4.50.50.2.m1.1b"><cn id="A2.T4.50.50.2.m1.1.1.cmml" type="float" xref="A2.T4.50.50.2.m1.1.1">0.2904</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T4.50.50.2.m1.1c">0.2904</annotation><annotation encoding="application/x-llamapun" id="A2.T4.50.50.2.m1.1d">0.2904</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A2.T4.52.52">
<td class="ltx_td ltx_align_left" id="A2.T4.52.52.3">mmlu professional psychology</td>
<td class="ltx_td ltx_align_center" id="A2.T4.51.51.1"><math alttext="\mathbf{0.3203}" class="ltx_Math" display="inline" id="A2.T4.51.51.1.m1.1"><semantics id="A2.T4.51.51.1.m1.1a"><mn class="ltx_mathvariant_bold" id="A2.T4.51.51.1.m1.1.1" mathvariant="bold" xref="A2.T4.51.51.1.m1.1.1.cmml">0.3203</mn><annotation-xml encoding="MathML-Content" id="A2.T4.51.51.1.m1.1b"><cn id="A2.T4.51.51.1.m1.1.1.cmml" type="float" xref="A2.T4.51.51.1.m1.1.1">0.3203</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T4.51.51.1.m1.1c">\mathbf{0.3203}</annotation><annotation encoding="application/x-llamapun" id="A2.T4.51.51.1.m1.1d">bold_0.3203</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="A2.T4.52.52.2"><math alttext="0.3186" class="ltx_Math" display="inline" id="A2.T4.52.52.2.m1.1"><semantics id="A2.T4.52.52.2.m1.1a"><mn id="A2.T4.52.52.2.m1.1.1" xref="A2.T4.52.52.2.m1.1.1.cmml">0.3186</mn><annotation-xml encoding="MathML-Content" id="A2.T4.52.52.2.m1.1b"><cn id="A2.T4.52.52.2.m1.1.1.cmml" type="float" xref="A2.T4.52.52.2.m1.1.1">0.3186</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T4.52.52.2.m1.1c">0.3186</annotation><annotation encoding="application/x-llamapun" id="A2.T4.52.52.2.m1.1d">0.3186</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A2.T4.54.54">
<td class="ltx_td ltx_align_left" id="A2.T4.54.54.3">mmlu world religions</td>
<td class="ltx_td ltx_align_center" id="A2.T4.53.53.1"><math alttext="\mathbf{0.5731}" class="ltx_Math" display="inline" id="A2.T4.53.53.1.m1.1"><semantics id="A2.T4.53.53.1.m1.1a"><mn class="ltx_mathvariant_bold" id="A2.T4.53.53.1.m1.1.1" mathvariant="bold" xref="A2.T4.53.53.1.m1.1.1.cmml">0.5731</mn><annotation-xml encoding="MathML-Content" id="A2.T4.53.53.1.m1.1b"><cn id="A2.T4.53.53.1.m1.1.1.cmml" type="float" xref="A2.T4.53.53.1.m1.1.1">0.5731</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T4.53.53.1.m1.1c">\mathbf{0.5731}</annotation><annotation encoding="application/x-llamapun" id="A2.T4.53.53.1.m1.1d">bold_0.5731</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="A2.T4.54.54.2"><math alttext="0.4503" class="ltx_Math" display="inline" id="A2.T4.54.54.2.m1.1"><semantics id="A2.T4.54.54.2.m1.1a"><mn id="A2.T4.54.54.2.m1.1.1" xref="A2.T4.54.54.2.m1.1.1.cmml">0.4503</mn><annotation-xml encoding="MathML-Content" id="A2.T4.54.54.2.m1.1b"><cn id="A2.T4.54.54.2.m1.1.1.cmml" type="float" xref="A2.T4.54.54.2.m1.1.1">0.4503</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T4.54.54.2.m1.1c">0.4503</annotation><annotation encoding="application/x-llamapun" id="A2.T4.54.54.2.m1.1d">0.4503</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A2.T4.56.56">
<td class="ltx_td ltx_align_left" id="A2.T4.56.56.3">mmlu anatomy</td>
<td class="ltx_td ltx_align_center" id="A2.T4.55.55.1"><math alttext="\mathbf{0.4667}" class="ltx_Math" display="inline" id="A2.T4.55.55.1.m1.1"><semantics id="A2.T4.55.55.1.m1.1a"><mn class="ltx_mathvariant_bold" id="A2.T4.55.55.1.m1.1.1" mathvariant="bold" xref="A2.T4.55.55.1.m1.1.1.cmml">0.4667</mn><annotation-xml encoding="MathML-Content" id="A2.T4.55.55.1.m1.1b"><cn id="A2.T4.55.55.1.m1.1.1.cmml" type="float" xref="A2.T4.55.55.1.m1.1.1">0.4667</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T4.55.55.1.m1.1c">\mathbf{0.4667}</annotation><annotation encoding="application/x-llamapun" id="A2.T4.55.55.1.m1.1d">bold_0.4667</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="A2.T4.56.56.2"><math alttext="0.3926" class="ltx_Math" display="inline" id="A2.T4.56.56.2.m1.1"><semantics id="A2.T4.56.56.2.m1.1a"><mn id="A2.T4.56.56.2.m1.1.1" xref="A2.T4.56.56.2.m1.1.1.cmml">0.3926</mn><annotation-xml encoding="MathML-Content" id="A2.T4.56.56.2.m1.1b"><cn id="A2.T4.56.56.2.m1.1.1.cmml" type="float" xref="A2.T4.56.56.2.m1.1.1">0.3926</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T4.56.56.2.m1.1c">0.3926</annotation><annotation encoding="application/x-llamapun" id="A2.T4.56.56.2.m1.1d">0.3926</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A2.T4.58.58">
<td class="ltx_td ltx_align_left" id="A2.T4.58.58.3">mmlu clinical knowledge</td>
<td class="ltx_td ltx_align_center" id="A2.T4.57.57.1"><math alttext="\mathbf{0.3434}" class="ltx_Math" display="inline" id="A2.T4.57.57.1.m1.1"><semantics id="A2.T4.57.57.1.m1.1a"><mn class="ltx_mathvariant_bold" id="A2.T4.57.57.1.m1.1.1" mathvariant="bold" xref="A2.T4.57.57.1.m1.1.1.cmml">0.3434</mn><annotation-xml encoding="MathML-Content" id="A2.T4.57.57.1.m1.1b"><cn id="A2.T4.57.57.1.m1.1.1.cmml" type="float" xref="A2.T4.57.57.1.m1.1.1">0.3434</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T4.57.57.1.m1.1c">\mathbf{0.3434}</annotation><annotation encoding="application/x-llamapun" id="A2.T4.57.57.1.m1.1d">bold_0.3434</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="A2.T4.58.58.2"><math alttext="0.2755" class="ltx_Math" display="inline" id="A2.T4.58.58.2.m1.1"><semantics id="A2.T4.58.58.2.m1.1a"><mn id="A2.T4.58.58.2.m1.1.1" xref="A2.T4.58.58.2.m1.1.1.cmml">0.2755</mn><annotation-xml encoding="MathML-Content" id="A2.T4.58.58.2.m1.1b"><cn id="A2.T4.58.58.2.m1.1.1.cmml" type="float" xref="A2.T4.58.58.2.m1.1.1">0.2755</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T4.58.58.2.m1.1c">0.2755</annotation><annotation encoding="application/x-llamapun" id="A2.T4.58.58.2.m1.1d">0.2755</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A2.T4.60.60">
<td class="ltx_td ltx_align_left" id="A2.T4.60.60.3">mmlu college biology</td>
<td class="ltx_td ltx_align_center" id="A2.T4.59.59.1"><math alttext="\mathbf{0.4028}" class="ltx_Math" display="inline" id="A2.T4.59.59.1.m1.1"><semantics id="A2.T4.59.59.1.m1.1a"><mn class="ltx_mathvariant_bold" id="A2.T4.59.59.1.m1.1.1" mathvariant="bold" xref="A2.T4.59.59.1.m1.1.1.cmml">0.4028</mn><annotation-xml encoding="MathML-Content" id="A2.T4.59.59.1.m1.1b"><cn id="A2.T4.59.59.1.m1.1.1.cmml" type="float" xref="A2.T4.59.59.1.m1.1.1">0.4028</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T4.59.59.1.m1.1c">\mathbf{0.4028}</annotation><annotation encoding="application/x-llamapun" id="A2.T4.59.59.1.m1.1d">bold_0.4028</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="A2.T4.60.60.2"><math alttext="0.3819" class="ltx_Math" display="inline" id="A2.T4.60.60.2.m1.1"><semantics id="A2.T4.60.60.2.m1.1a"><mn id="A2.T4.60.60.2.m1.1.1" xref="A2.T4.60.60.2.m1.1.1.cmml">0.3819</mn><annotation-xml encoding="MathML-Content" id="A2.T4.60.60.2.m1.1b"><cn id="A2.T4.60.60.2.m1.1.1.cmml" type="float" xref="A2.T4.60.60.2.m1.1.1">0.3819</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T4.60.60.2.m1.1c">0.3819</annotation><annotation encoding="application/x-llamapun" id="A2.T4.60.60.2.m1.1d">0.3819</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A2.T4.62.62">
<td class="ltx_td ltx_align_left" id="A2.T4.62.62.3">mmlu college chemistry</td>
<td class="ltx_td ltx_align_center" id="A2.T4.61.61.1"><math alttext="\mathbf{0.2800}" class="ltx_Math" display="inline" id="A2.T4.61.61.1.m1.1"><semantics id="A2.T4.61.61.1.m1.1a"><mn class="ltx_mathvariant_bold" id="A2.T4.61.61.1.m1.1.1" mathvariant="bold" xref="A2.T4.61.61.1.m1.1.1.cmml">0.2800</mn><annotation-xml encoding="MathML-Content" id="A2.T4.61.61.1.m1.1b"><cn id="A2.T4.61.61.1.m1.1.1.cmml" type="float" xref="A2.T4.61.61.1.m1.1.1">0.2800</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T4.61.61.1.m1.1c">\mathbf{0.2800}</annotation><annotation encoding="application/x-llamapun" id="A2.T4.61.61.1.m1.1d">bold_0.2800</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="A2.T4.62.62.2"><math alttext="0.2600" class="ltx_Math" display="inline" id="A2.T4.62.62.2.m1.1"><semantics id="A2.T4.62.62.2.m1.1a"><mn id="A2.T4.62.62.2.m1.1.1" xref="A2.T4.62.62.2.m1.1.1.cmml">0.2600</mn><annotation-xml encoding="MathML-Content" id="A2.T4.62.62.2.m1.1b"><cn id="A2.T4.62.62.2.m1.1.1.cmml" type="float" xref="A2.T4.62.62.2.m1.1.1">0.2600</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T4.62.62.2.m1.1c">0.2600</annotation><annotation encoding="application/x-llamapun" id="A2.T4.62.62.2.m1.1d">0.2600</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A2.T4.64.64">
<td class="ltx_td ltx_align_left" id="A2.T4.64.64.3">mmlu college medicine</td>
<td class="ltx_td ltx_align_center" id="A2.T4.63.63.1"><math alttext="\mathbf{0.2832}" class="ltx_Math" display="inline" id="A2.T4.63.63.1.m1.1"><semantics id="A2.T4.63.63.1.m1.1a"><mn class="ltx_mathvariant_bold" id="A2.T4.63.63.1.m1.1.1" mathvariant="bold" xref="A2.T4.63.63.1.m1.1.1.cmml">0.2832</mn><annotation-xml encoding="MathML-Content" id="A2.T4.63.63.1.m1.1b"><cn id="A2.T4.63.63.1.m1.1.1.cmml" type="float" xref="A2.T4.63.63.1.m1.1.1">0.2832</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T4.63.63.1.m1.1c">\mathbf{0.2832}</annotation><annotation encoding="application/x-llamapun" id="A2.T4.63.63.1.m1.1d">bold_0.2832</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="A2.T4.64.64.2"><math alttext="0.2659" class="ltx_Math" display="inline" id="A2.T4.64.64.2.m1.1"><semantics id="A2.T4.64.64.2.m1.1a"><mn id="A2.T4.64.64.2.m1.1.1" xref="A2.T4.64.64.2.m1.1.1.cmml">0.2659</mn><annotation-xml encoding="MathML-Content" id="A2.T4.64.64.2.m1.1b"><cn id="A2.T4.64.64.2.m1.1.1.cmml" type="float" xref="A2.T4.64.64.2.m1.1.1">0.2659</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T4.64.64.2.m1.1c">0.2659</annotation><annotation encoding="application/x-llamapun" id="A2.T4.64.64.2.m1.1d">0.2659</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A2.T4.66.66">
<td class="ltx_td ltx_align_left" id="A2.T4.66.66.3">mmlu college physics</td>
<td class="ltx_td ltx_align_center" id="A2.T4.65.65.1"><math alttext="0.1863" class="ltx_Math" display="inline" id="A2.T4.65.65.1.m1.1"><semantics id="A2.T4.65.65.1.m1.1a"><mn id="A2.T4.65.65.1.m1.1.1" xref="A2.T4.65.65.1.m1.1.1.cmml">0.1863</mn><annotation-xml encoding="MathML-Content" id="A2.T4.65.65.1.m1.1b"><cn id="A2.T4.65.65.1.m1.1.1.cmml" type="float" xref="A2.T4.65.65.1.m1.1.1">0.1863</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T4.65.65.1.m1.1c">0.1863</annotation><annotation encoding="application/x-llamapun" id="A2.T4.65.65.1.m1.1d">0.1863</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="A2.T4.66.66.2"><math alttext="\mathbf{0.1961}" class="ltx_Math" display="inline" id="A2.T4.66.66.2.m1.1"><semantics id="A2.T4.66.66.2.m1.1a"><mn class="ltx_mathvariant_bold" id="A2.T4.66.66.2.m1.1.1" mathvariant="bold" xref="A2.T4.66.66.2.m1.1.1.cmml">0.1961</mn><annotation-xml encoding="MathML-Content" id="A2.T4.66.66.2.m1.1b"><cn id="A2.T4.66.66.2.m1.1.1.cmml" type="float" xref="A2.T4.66.66.2.m1.1.1">0.1961</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T4.66.66.2.m1.1c">\mathbf{0.1961}</annotation><annotation encoding="application/x-llamapun" id="A2.T4.66.66.2.m1.1d">bold_0.1961</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A2.T4.68.68">
<td class="ltx_td ltx_align_left ltx_border_b" id="A2.T4.68.68.3">mmlu conceptual physics</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="A2.T4.67.67.1"><math alttext="\mathbf{0.3787}" class="ltx_Math" display="inline" id="A2.T4.67.67.1.m1.1"><semantics id="A2.T4.67.67.1.m1.1a"><mn class="ltx_mathvariant_bold" id="A2.T4.67.67.1.m1.1.1" mathvariant="bold" xref="A2.T4.67.67.1.m1.1.1.cmml">0.3787</mn><annotation-xml encoding="MathML-Content" id="A2.T4.67.67.1.m1.1b"><cn id="A2.T4.67.67.1.m1.1.1.cmml" type="float" xref="A2.T4.67.67.1.m1.1.1">0.3787</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T4.67.67.1.m1.1c">\mathbf{0.3787}</annotation><annotation encoding="application/x-llamapun" id="A2.T4.67.67.1.m1.1d">bold_0.3787</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="A2.T4.68.68.2"><math alttext="\mathbf{0.3787}" class="ltx_Math" display="inline" id="A2.T4.68.68.2.m1.1"><semantics id="A2.T4.68.68.2.m1.1a"><mn class="ltx_mathvariant_bold" id="A2.T4.68.68.2.m1.1.1" mathvariant="bold" xref="A2.T4.68.68.2.m1.1.1.cmml">0.3787</mn><annotation-xml encoding="MathML-Content" id="A2.T4.68.68.2.m1.1b"><cn id="A2.T4.68.68.2.m1.1.1.cmml" type="float" xref="A2.T4.68.68.2.m1.1.1">0.3787</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T4.68.68.2.m1.1c">\mathbf{0.3787}</annotation><annotation encoding="application/x-llamapun" id="A2.T4.68.68.2.m1.1d">bold_0.3787</annotation></semantics></math></td>
</tr>
</tbody></table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 4: </span><span class="ltx_text ltx_font_bold" id="A2.T4.82.1">Downstream Evaluation Results (Part 1).</span> This table presents a comparison in accuracy on downstream tasks between a <math alttext="1.3" class="ltx_Math" display="inline" id="A2.T4.75.m1.1"><semantics id="A2.T4.75.m1.1b"><mn id="A2.T4.75.m1.1.1" xref="A2.T4.75.m1.1.1.cmml">1.3</mn><annotation-xml encoding="MathML-Content" id="A2.T4.75.m1.1c"><cn id="A2.T4.75.m1.1.1.cmml" type="float" xref="A2.T4.75.m1.1.1">1.3</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T4.75.m1.1d">1.3</annotation><annotation encoding="application/x-llamapun" id="A2.T4.75.m1.1e">1.3</annotation></semantics></math>B-parameter, <math alttext="32" class="ltx_Math" display="inline" id="A2.T4.76.m2.1"><semantics id="A2.T4.76.m2.1b"><mn id="A2.T4.76.m2.1.1" xref="A2.T4.76.m2.1.1.cmml">32</mn><annotation-xml encoding="MathML-Content" id="A2.T4.76.m2.1c"><cn id="A2.T4.76.m2.1.1.cmml" type="integer" xref="A2.T4.76.m2.1.1">32</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T4.76.m2.1d">32</annotation><annotation encoding="application/x-llamapun" id="A2.T4.76.m2.1e">32</annotation></semantics></math>-expert model and a <math alttext="1.3" class="ltx_Math" display="inline" id="A2.T4.77.m3.1"><semantics id="A2.T4.77.m3.1b"><mn id="A2.T4.77.m3.1.1" xref="A2.T4.77.m3.1.1.cmml">1.3</mn><annotation-xml encoding="MathML-Content" id="A2.T4.77.m3.1c"><cn id="A2.T4.77.m3.1.1.cmml" type="float" xref="A2.T4.77.m3.1.1">1.3</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T4.77.m3.1d">1.3</annotation><annotation encoding="application/x-llamapun" id="A2.T4.77.m3.1e">1.3</annotation></semantics></math>B-parameter dense model. Both models were trained using the <math alttext="2" class="ltx_Math" display="inline" id="A2.T4.78.m4.1"><semantics id="A2.T4.78.m4.1b"><mn id="A2.T4.78.m4.1.1" xref="A2.T4.78.m4.1.1.cmml">2</mn><annotation-xml encoding="MathML-Content" id="A2.T4.78.m4.1c"><cn id="A2.T4.78.m4.1.1.cmml" type="integer" xref="A2.T4.78.m4.1.1">2</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T4.78.m4.1d">2</annotation><annotation encoding="application/x-llamapun" id="A2.T4.78.m4.1e">2</annotation></semantics></math>T tokens and nearly the same training FLOPs, with only a <math alttext="1\%" class="ltx_Math" display="inline" id="A2.T4.79.m5.1"><semantics id="A2.T4.79.m5.1b"><mrow id="A2.T4.79.m5.1.1" xref="A2.T4.79.m5.1.1.cmml"><mn id="A2.T4.79.m5.1.1.2" xref="A2.T4.79.m5.1.1.2.cmml">1</mn><mo id="A2.T4.79.m5.1.1.1" xref="A2.T4.79.m5.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="A2.T4.79.m5.1c"><apply id="A2.T4.79.m5.1.1.cmml" xref="A2.T4.79.m5.1.1"><csymbol cd="latexml" id="A2.T4.79.m5.1.1.1.cmml" xref="A2.T4.79.m5.1.1.1">percent</csymbol><cn id="A2.T4.79.m5.1.1.2.cmml" type="integer" xref="A2.T4.79.m5.1.1.2">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T4.79.m5.1d">1\%</annotation><annotation encoding="application/x-llamapun" id="A2.T4.79.m5.1e">1 %</annotation></semantics></math> difference. The inference cost of the expert model increased by less than <math alttext="3\%" class="ltx_Math" display="inline" id="A2.T4.80.m6.1"><semantics id="A2.T4.80.m6.1b"><mrow id="A2.T4.80.m6.1.1" xref="A2.T4.80.m6.1.1.cmml"><mn id="A2.T4.80.m6.1.1.2" xref="A2.T4.80.m6.1.1.2.cmml">3</mn><mo id="A2.T4.80.m6.1.1.1" xref="A2.T4.80.m6.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="A2.T4.80.m6.1c"><apply id="A2.T4.80.m6.1.1.cmml" xref="A2.T4.80.m6.1.1"><csymbol cd="latexml" id="A2.T4.80.m6.1.1.1.cmml" xref="A2.T4.80.m6.1.1.1">percent</csymbol><cn id="A2.T4.80.m6.1.1.2.cmml" type="integer" xref="A2.T4.80.m6.1.1.2">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T4.80.m6.1d">3\%</annotation><annotation encoding="application/x-llamapun" id="A2.T4.80.m6.1e">3 %</annotation></semantics></math> compared to the dense baseline FLOPs.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_table" id="A2.T5">
<table class="ltx_tabular ltx_centering ltx_align_middle" id="A2.T5.52">
<tbody><tr class="ltx_tr" id="A2.T5.52.53">
<td class="ltx_td ltx_align_left ltx_border_t" id="A2.T5.52.53.1"><span class="ltx_text ltx_font_bold" id="A2.T5.52.53.1.1">Task</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T5.52.53.2"><span class="ltx_text ltx_font_bold" id="A2.T5.52.53.2.1">32 experts, 2T</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T5.52.53.3"><span class="ltx_text ltx_font_bold" id="A2.T5.52.53.3.1">dense, 2T</span></td>
</tr>
<tr class="ltx_tr" id="A2.T5.2.2">
<td class="ltx_td ltx_align_left ltx_border_t" id="A2.T5.2.2.3">mmlu econometrics</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T5.1.1.1"><math alttext="\mathbf{0.2719}" class="ltx_Math" display="inline" id="A2.T5.1.1.1.m1.1"><semantics id="A2.T5.1.1.1.m1.1a"><mn class="ltx_mathvariant_bold" id="A2.T5.1.1.1.m1.1.1" mathvariant="bold" xref="A2.T5.1.1.1.m1.1.1.cmml">0.2719</mn><annotation-xml encoding="MathML-Content" id="A2.T5.1.1.1.m1.1b"><cn id="A2.T5.1.1.1.m1.1.1.cmml" type="float" xref="A2.T5.1.1.1.m1.1.1">0.2719</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T5.1.1.1.m1.1c">\mathbf{0.2719}</annotation><annotation encoding="application/x-llamapun" id="A2.T5.1.1.1.m1.1d">bold_0.2719</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T5.2.2.2"><math alttext="0.2018" class="ltx_Math" display="inline" id="A2.T5.2.2.2.m1.1"><semantics id="A2.T5.2.2.2.m1.1a"><mn id="A2.T5.2.2.2.m1.1.1" xref="A2.T5.2.2.2.m1.1.1.cmml">0.2018</mn><annotation-xml encoding="MathML-Content" id="A2.T5.2.2.2.m1.1b"><cn id="A2.T5.2.2.2.m1.1.1.cmml" type="float" xref="A2.T5.2.2.2.m1.1.1">0.2018</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T5.2.2.2.m1.1c">0.2018</annotation><annotation encoding="application/x-llamapun" id="A2.T5.2.2.2.m1.1d">0.2018</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A2.T5.4.4">
<td class="ltx_td ltx_align_left" id="A2.T5.4.4.3">mmlu electrical engineering</td>
<td class="ltx_td ltx_align_center" id="A2.T5.3.3.1"><math alttext="0.2552" class="ltx_Math" display="inline" id="A2.T5.3.3.1.m1.1"><semantics id="A2.T5.3.3.1.m1.1a"><mn id="A2.T5.3.3.1.m1.1.1" xref="A2.T5.3.3.1.m1.1.1.cmml">0.2552</mn><annotation-xml encoding="MathML-Content" id="A2.T5.3.3.1.m1.1b"><cn id="A2.T5.3.3.1.m1.1.1.cmml" type="float" xref="A2.T5.3.3.1.m1.1.1">0.2552</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T5.3.3.1.m1.1c">0.2552</annotation><annotation encoding="application/x-llamapun" id="A2.T5.3.3.1.m1.1d">0.2552</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="A2.T5.4.4.2"><math alttext="\mathbf{0.2621}" class="ltx_Math" display="inline" id="A2.T5.4.4.2.m1.1"><semantics id="A2.T5.4.4.2.m1.1a"><mn class="ltx_mathvariant_bold" id="A2.T5.4.4.2.m1.1.1" mathvariant="bold" xref="A2.T5.4.4.2.m1.1.1.cmml">0.2621</mn><annotation-xml encoding="MathML-Content" id="A2.T5.4.4.2.m1.1b"><cn id="A2.T5.4.4.2.m1.1.1.cmml" type="float" xref="A2.T5.4.4.2.m1.1.1">0.2621</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T5.4.4.2.m1.1c">\mathbf{0.2621}</annotation><annotation encoding="application/x-llamapun" id="A2.T5.4.4.2.m1.1d">bold_0.2621</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A2.T5.6.6">
<td class="ltx_td ltx_align_left" id="A2.T5.6.6.3">mmlu high school biology</td>
<td class="ltx_td ltx_align_center" id="A2.T5.5.5.1"><math alttext="\mathbf{0.3290}" class="ltx_Math" display="inline" id="A2.T5.5.5.1.m1.1"><semantics id="A2.T5.5.5.1.m1.1a"><mn class="ltx_mathvariant_bold" id="A2.T5.5.5.1.m1.1.1" mathvariant="bold" xref="A2.T5.5.5.1.m1.1.1.cmml">0.3290</mn><annotation-xml encoding="MathML-Content" id="A2.T5.5.5.1.m1.1b"><cn id="A2.T5.5.5.1.m1.1.1.cmml" type="float" xref="A2.T5.5.5.1.m1.1.1">0.3290</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T5.5.5.1.m1.1c">\mathbf{0.3290}</annotation><annotation encoding="application/x-llamapun" id="A2.T5.5.5.1.m1.1d">bold_0.3290</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="A2.T5.6.6.2"><math alttext="0.3097" class="ltx_Math" display="inline" id="A2.T5.6.6.2.m1.1"><semantics id="A2.T5.6.6.2.m1.1a"><mn id="A2.T5.6.6.2.m1.1.1" xref="A2.T5.6.6.2.m1.1.1.cmml">0.3097</mn><annotation-xml encoding="MathML-Content" id="A2.T5.6.6.2.m1.1b"><cn id="A2.T5.6.6.2.m1.1.1.cmml" type="float" xref="A2.T5.6.6.2.m1.1.1">0.3097</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T5.6.6.2.m1.1c">0.3097</annotation><annotation encoding="application/x-llamapun" id="A2.T5.6.6.2.m1.1d">0.3097</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A2.T5.8.8">
<td class="ltx_td ltx_align_left" id="A2.T5.8.8.3">mmlu high school chemistry</td>
<td class="ltx_td ltx_align_center" id="A2.T5.7.7.1"><math alttext="\mathbf{0.2167}" class="ltx_Math" display="inline" id="A2.T5.7.7.1.m1.1"><semantics id="A2.T5.7.7.1.m1.1a"><mn class="ltx_mathvariant_bold" id="A2.T5.7.7.1.m1.1.1" mathvariant="bold" xref="A2.T5.7.7.1.m1.1.1.cmml">0.2167</mn><annotation-xml encoding="MathML-Content" id="A2.T5.7.7.1.m1.1b"><cn id="A2.T5.7.7.1.m1.1.1.cmml" type="float" xref="A2.T5.7.7.1.m1.1.1">0.2167</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T5.7.7.1.m1.1c">\mathbf{0.2167}</annotation><annotation encoding="application/x-llamapun" id="A2.T5.7.7.1.m1.1d">bold_0.2167</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="A2.T5.8.8.2"><math alttext="0.1970" class="ltx_Math" display="inline" id="A2.T5.8.8.2.m1.1"><semantics id="A2.T5.8.8.2.m1.1a"><mn id="A2.T5.8.8.2.m1.1.1" xref="A2.T5.8.8.2.m1.1.1.cmml">0.1970</mn><annotation-xml encoding="MathML-Content" id="A2.T5.8.8.2.m1.1b"><cn id="A2.T5.8.8.2.m1.1.1.cmml" type="float" xref="A2.T5.8.8.2.m1.1.1">0.1970</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T5.8.8.2.m1.1c">0.1970</annotation><annotation encoding="application/x-llamapun" id="A2.T5.8.8.2.m1.1d">0.1970</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A2.T5.10.10">
<td class="ltx_td ltx_align_left" id="A2.T5.10.10.3">mmlu high school computer science</td>
<td class="ltx_td ltx_align_center" id="A2.T5.9.9.1"><math alttext="\mathbf{0.2400}" class="ltx_Math" display="inline" id="A2.T5.9.9.1.m1.1"><semantics id="A2.T5.9.9.1.m1.1a"><mn class="ltx_mathvariant_bold" id="A2.T5.9.9.1.m1.1.1" mathvariant="bold" xref="A2.T5.9.9.1.m1.1.1.cmml">0.2400</mn><annotation-xml encoding="MathML-Content" id="A2.T5.9.9.1.m1.1b"><cn id="A2.T5.9.9.1.m1.1.1.cmml" type="float" xref="A2.T5.9.9.1.m1.1.1">0.2400</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T5.9.9.1.m1.1c">\mathbf{0.2400}</annotation><annotation encoding="application/x-llamapun" id="A2.T5.9.9.1.m1.1d">bold_0.2400</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="A2.T5.10.10.2"><math alttext="\mathbf{0.2400}" class="ltx_Math" display="inline" id="A2.T5.10.10.2.m1.1"><semantics id="A2.T5.10.10.2.m1.1a"><mn class="ltx_mathvariant_bold" id="A2.T5.10.10.2.m1.1.1" mathvariant="bold" xref="A2.T5.10.10.2.m1.1.1.cmml">0.2400</mn><annotation-xml encoding="MathML-Content" id="A2.T5.10.10.2.m1.1b"><cn id="A2.T5.10.10.2.m1.1.1.cmml" type="float" xref="A2.T5.10.10.2.m1.1.1">0.2400</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T5.10.10.2.m1.1c">\mathbf{0.2400}</annotation><annotation encoding="application/x-llamapun" id="A2.T5.10.10.2.m1.1d">bold_0.2400</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A2.T5.12.12">
<td class="ltx_td ltx_align_left" id="A2.T5.12.12.3">mmlu high school european history</td>
<td class="ltx_td ltx_align_center" id="A2.T5.11.11.1"><math alttext="0.2848" class="ltx_Math" display="inline" id="A2.T5.11.11.1.m1.1"><semantics id="A2.T5.11.11.1.m1.1a"><mn id="A2.T5.11.11.1.m1.1.1" xref="A2.T5.11.11.1.m1.1.1.cmml">0.2848</mn><annotation-xml encoding="MathML-Content" id="A2.T5.11.11.1.m1.1b"><cn id="A2.T5.11.11.1.m1.1.1.cmml" type="float" xref="A2.T5.11.11.1.m1.1.1">0.2848</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T5.11.11.1.m1.1c">0.2848</annotation><annotation encoding="application/x-llamapun" id="A2.T5.11.11.1.m1.1d">0.2848</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="A2.T5.12.12.2"><math alttext="\mathbf{0.3212}" class="ltx_Math" display="inline" id="A2.T5.12.12.2.m1.1"><semantics id="A2.T5.12.12.2.m1.1a"><mn class="ltx_mathvariant_bold" id="A2.T5.12.12.2.m1.1.1" mathvariant="bold" xref="A2.T5.12.12.2.m1.1.1.cmml">0.3212</mn><annotation-xml encoding="MathML-Content" id="A2.T5.12.12.2.m1.1b"><cn id="A2.T5.12.12.2.m1.1.1.cmml" type="float" xref="A2.T5.12.12.2.m1.1.1">0.3212</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T5.12.12.2.m1.1c">\mathbf{0.3212}</annotation><annotation encoding="application/x-llamapun" id="A2.T5.12.12.2.m1.1d">bold_0.3212</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A2.T5.14.14">
<td class="ltx_td ltx_align_left" id="A2.T5.14.14.3">mmlu high school government and politics</td>
<td class="ltx_td ltx_align_center" id="A2.T5.13.13.1"><math alttext="\mathbf{0.4093}" class="ltx_Math" display="inline" id="A2.T5.13.13.1.m1.1"><semantics id="A2.T5.13.13.1.m1.1a"><mn class="ltx_mathvariant_bold" id="A2.T5.13.13.1.m1.1.1" mathvariant="bold" xref="A2.T5.13.13.1.m1.1.1.cmml">0.4093</mn><annotation-xml encoding="MathML-Content" id="A2.T5.13.13.1.m1.1b"><cn id="A2.T5.13.13.1.m1.1.1.cmml" type="float" xref="A2.T5.13.13.1.m1.1.1">0.4093</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T5.13.13.1.m1.1c">\mathbf{0.4093}</annotation><annotation encoding="application/x-llamapun" id="A2.T5.13.13.1.m1.1d">bold_0.4093</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="A2.T5.14.14.2"><math alttext="0.3834" class="ltx_Math" display="inline" id="A2.T5.14.14.2.m1.1"><semantics id="A2.T5.14.14.2.m1.1a"><mn id="A2.T5.14.14.2.m1.1.1" xref="A2.T5.14.14.2.m1.1.1.cmml">0.3834</mn><annotation-xml encoding="MathML-Content" id="A2.T5.14.14.2.m1.1b"><cn id="A2.T5.14.14.2.m1.1.1.cmml" type="float" xref="A2.T5.14.14.2.m1.1.1">0.3834</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T5.14.14.2.m1.1c">0.3834</annotation><annotation encoding="application/x-llamapun" id="A2.T5.14.14.2.m1.1d">0.3834</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A2.T5.16.16">
<td class="ltx_td ltx_align_left" id="A2.T5.16.16.3">mmlu high school mathematics</td>
<td class="ltx_td ltx_align_center" id="A2.T5.15.15.1"><math alttext="\mathbf{0.1519}" class="ltx_Math" display="inline" id="A2.T5.15.15.1.m1.1"><semantics id="A2.T5.15.15.1.m1.1a"><mn class="ltx_mathvariant_bold" id="A2.T5.15.15.1.m1.1.1" mathvariant="bold" xref="A2.T5.15.15.1.m1.1.1.cmml">0.1519</mn><annotation-xml encoding="MathML-Content" id="A2.T5.15.15.1.m1.1b"><cn id="A2.T5.15.15.1.m1.1.1.cmml" type="float" xref="A2.T5.15.15.1.m1.1.1">0.1519</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T5.15.15.1.m1.1c">\mathbf{0.1519}</annotation><annotation encoding="application/x-llamapun" id="A2.T5.15.15.1.m1.1d">bold_0.1519</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="A2.T5.16.16.2"><math alttext="0.1444" class="ltx_Math" display="inline" id="A2.T5.16.16.2.m1.1"><semantics id="A2.T5.16.16.2.m1.1a"><mn id="A2.T5.16.16.2.m1.1.1" xref="A2.T5.16.16.2.m1.1.1.cmml">0.1444</mn><annotation-xml encoding="MathML-Content" id="A2.T5.16.16.2.m1.1b"><cn id="A2.T5.16.16.2.m1.1.1.cmml" type="float" xref="A2.T5.16.16.2.m1.1.1">0.1444</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T5.16.16.2.m1.1c">0.1444</annotation><annotation encoding="application/x-llamapun" id="A2.T5.16.16.2.m1.1d">0.1444</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A2.T5.18.18">
<td class="ltx_td ltx_align_left" id="A2.T5.18.18.3">mmlu high school physics</td>
<td class="ltx_td ltx_align_center" id="A2.T5.17.17.1"><math alttext="\mathbf{0.2980}" class="ltx_Math" display="inline" id="A2.T5.17.17.1.m1.1"><semantics id="A2.T5.17.17.1.m1.1a"><mn class="ltx_mathvariant_bold" id="A2.T5.17.17.1.m1.1.1" mathvariant="bold" xref="A2.T5.17.17.1.m1.1.1.cmml">0.2980</mn><annotation-xml encoding="MathML-Content" id="A2.T5.17.17.1.m1.1b"><cn id="A2.T5.17.17.1.m1.1.1.cmml" type="float" xref="A2.T5.17.17.1.m1.1.1">0.2980</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T5.17.17.1.m1.1c">\mathbf{0.2980}</annotation><annotation encoding="application/x-llamapun" id="A2.T5.17.17.1.m1.1d">bold_0.2980</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="A2.T5.18.18.2"><math alttext="0.2715" class="ltx_Math" display="inline" id="A2.T5.18.18.2.m1.1"><semantics id="A2.T5.18.18.2.m1.1a"><mn id="A2.T5.18.18.2.m1.1.1" xref="A2.T5.18.18.2.m1.1.1.cmml">0.2715</mn><annotation-xml encoding="MathML-Content" id="A2.T5.18.18.2.m1.1b"><cn id="A2.T5.18.18.2.m1.1.1.cmml" type="float" xref="A2.T5.18.18.2.m1.1.1">0.2715</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T5.18.18.2.m1.1c">0.2715</annotation><annotation encoding="application/x-llamapun" id="A2.T5.18.18.2.m1.1d">0.2715</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A2.T5.20.20">
<td class="ltx_td ltx_align_left" id="A2.T5.20.20.3">mmlu high school psychology</td>
<td class="ltx_td ltx_align_center" id="A2.T5.19.19.1"><math alttext="\mathbf{0.4642}" class="ltx_Math" display="inline" id="A2.T5.19.19.1.m1.1"><semantics id="A2.T5.19.19.1.m1.1a"><mn class="ltx_mathvariant_bold" id="A2.T5.19.19.1.m1.1.1" mathvariant="bold" xref="A2.T5.19.19.1.m1.1.1.cmml">0.4642</mn><annotation-xml encoding="MathML-Content" id="A2.T5.19.19.1.m1.1b"><cn id="A2.T5.19.19.1.m1.1.1.cmml" type="float" xref="A2.T5.19.19.1.m1.1.1">0.4642</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T5.19.19.1.m1.1c">\mathbf{0.4642}</annotation><annotation encoding="application/x-llamapun" id="A2.T5.19.19.1.m1.1d">bold_0.4642</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="A2.T5.20.20.2"><math alttext="0.4330" class="ltx_Math" display="inline" id="A2.T5.20.20.2.m1.1"><semantics id="A2.T5.20.20.2.m1.1a"><mn id="A2.T5.20.20.2.m1.1.1" xref="A2.T5.20.20.2.m1.1.1.cmml">0.4330</mn><annotation-xml encoding="MathML-Content" id="A2.T5.20.20.2.m1.1b"><cn id="A2.T5.20.20.2.m1.1.1.cmml" type="float" xref="A2.T5.20.20.2.m1.1.1">0.4330</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T5.20.20.2.m1.1c">0.4330</annotation><annotation encoding="application/x-llamapun" id="A2.T5.20.20.2.m1.1d">0.4330</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A2.T5.22.22">
<td class="ltx_td ltx_align_left" id="A2.T5.22.22.3">mmlu high school us history</td>
<td class="ltx_td ltx_align_center" id="A2.T5.21.21.1"><math alttext="\mathbf{0.3382}" class="ltx_Math" display="inline" id="A2.T5.21.21.1.m1.1"><semantics id="A2.T5.21.21.1.m1.1a"><mn class="ltx_mathvariant_bold" id="A2.T5.21.21.1.m1.1.1" mathvariant="bold" xref="A2.T5.21.21.1.m1.1.1.cmml">0.3382</mn><annotation-xml encoding="MathML-Content" id="A2.T5.21.21.1.m1.1b"><cn id="A2.T5.21.21.1.m1.1.1.cmml" type="float" xref="A2.T5.21.21.1.m1.1.1">0.3382</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T5.21.21.1.m1.1c">\mathbf{0.3382}</annotation><annotation encoding="application/x-llamapun" id="A2.T5.21.21.1.m1.1d">bold_0.3382</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="A2.T5.22.22.2"><math alttext="0.3137" class="ltx_Math" display="inline" id="A2.T5.22.22.2.m1.1"><semantics id="A2.T5.22.22.2.m1.1a"><mn id="A2.T5.22.22.2.m1.1.1" xref="A2.T5.22.22.2.m1.1.1.cmml">0.3137</mn><annotation-xml encoding="MathML-Content" id="A2.T5.22.22.2.m1.1b"><cn id="A2.T5.22.22.2.m1.1.1.cmml" type="float" xref="A2.T5.22.22.2.m1.1.1">0.3137</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T5.22.22.2.m1.1c">0.3137</annotation><annotation encoding="application/x-llamapun" id="A2.T5.22.22.2.m1.1d">0.3137</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A2.T5.24.24">
<td class="ltx_td ltx_align_left" id="A2.T5.24.24.3">mmlu high school world history</td>
<td class="ltx_td ltx_align_center" id="A2.T5.23.23.1"><math alttext="0.2827" class="ltx_Math" display="inline" id="A2.T5.23.23.1.m1.1"><semantics id="A2.T5.23.23.1.m1.1a"><mn id="A2.T5.23.23.1.m1.1.1" xref="A2.T5.23.23.1.m1.1.1.cmml">0.2827</mn><annotation-xml encoding="MathML-Content" id="A2.T5.23.23.1.m1.1b"><cn id="A2.T5.23.23.1.m1.1.1.cmml" type="float" xref="A2.T5.23.23.1.m1.1.1">0.2827</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T5.23.23.1.m1.1c">0.2827</annotation><annotation encoding="application/x-llamapun" id="A2.T5.23.23.1.m1.1d">0.2827</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="A2.T5.24.24.2"><math alttext="\mathbf{0.2996}" class="ltx_Math" display="inline" id="A2.T5.24.24.2.m1.1"><semantics id="A2.T5.24.24.2.m1.1a"><mn class="ltx_mathvariant_bold" id="A2.T5.24.24.2.m1.1.1" mathvariant="bold" xref="A2.T5.24.24.2.m1.1.1.cmml">0.2996</mn><annotation-xml encoding="MathML-Content" id="A2.T5.24.24.2.m1.1b"><cn id="A2.T5.24.24.2.m1.1.1.cmml" type="float" xref="A2.T5.24.24.2.m1.1.1">0.2996</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T5.24.24.2.m1.1c">\mathbf{0.2996}</annotation><annotation encoding="application/x-llamapun" id="A2.T5.24.24.2.m1.1d">bold_0.2996</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A2.T5.26.26">
<td class="ltx_td ltx_align_left" id="A2.T5.26.26.3">mmlu jurisprudence</td>
<td class="ltx_td ltx_align_center" id="A2.T5.25.25.1"><math alttext="\mathbf{0.2407}" class="ltx_Math" display="inline" id="A2.T5.25.25.1.m1.1"><semantics id="A2.T5.25.25.1.m1.1a"><mn class="ltx_mathvariant_bold" id="A2.T5.25.25.1.m1.1.1" mathvariant="bold" xref="A2.T5.25.25.1.m1.1.1.cmml">0.2407</mn><annotation-xml encoding="MathML-Content" id="A2.T5.25.25.1.m1.1b"><cn id="A2.T5.25.25.1.m1.1.1.cmml" type="float" xref="A2.T5.25.25.1.m1.1.1">0.2407</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T5.25.25.1.m1.1c">\mathbf{0.2407}</annotation><annotation encoding="application/x-llamapun" id="A2.T5.25.25.1.m1.1d">bold_0.2407</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="A2.T5.26.26.2"><math alttext="0.2222" class="ltx_Math" display="inline" id="A2.T5.26.26.2.m1.1"><semantics id="A2.T5.26.26.2.m1.1a"><mn id="A2.T5.26.26.2.m1.1.1" xref="A2.T5.26.26.2.m1.1.1.cmml">0.2222</mn><annotation-xml encoding="MathML-Content" id="A2.T5.26.26.2.m1.1b"><cn id="A2.T5.26.26.2.m1.1.1.cmml" type="float" xref="A2.T5.26.26.2.m1.1.1">0.2222</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T5.26.26.2.m1.1c">0.2222</annotation><annotation encoding="application/x-llamapun" id="A2.T5.26.26.2.m1.1d">0.2222</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A2.T5.28.28">
<td class="ltx_td ltx_align_left" id="A2.T5.28.28.3">mmlu management</td>
<td class="ltx_td ltx_align_center" id="A2.T5.27.27.1"><math alttext="0.3786" class="ltx_Math" display="inline" id="A2.T5.27.27.1.m1.1"><semantics id="A2.T5.27.27.1.m1.1a"><mn id="A2.T5.27.27.1.m1.1.1" xref="A2.T5.27.27.1.m1.1.1.cmml">0.3786</mn><annotation-xml encoding="MathML-Content" id="A2.T5.27.27.1.m1.1b"><cn id="A2.T5.27.27.1.m1.1.1.cmml" type="float" xref="A2.T5.27.27.1.m1.1.1">0.3786</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T5.27.27.1.m1.1c">0.3786</annotation><annotation encoding="application/x-llamapun" id="A2.T5.27.27.1.m1.1d">0.3786</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="A2.T5.28.28.2"><math alttext="\mathbf{0.3981}" class="ltx_Math" display="inline" id="A2.T5.28.28.2.m1.1"><semantics id="A2.T5.28.28.2.m1.1a"><mn class="ltx_mathvariant_bold" id="A2.T5.28.28.2.m1.1.1" mathvariant="bold" xref="A2.T5.28.28.2.m1.1.1.cmml">0.3981</mn><annotation-xml encoding="MathML-Content" id="A2.T5.28.28.2.m1.1b"><cn id="A2.T5.28.28.2.m1.1.1.cmml" type="float" xref="A2.T5.28.28.2.m1.1.1">0.3981</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T5.28.28.2.m1.1c">\mathbf{0.3981}</annotation><annotation encoding="application/x-llamapun" id="A2.T5.28.28.2.m1.1d">bold_0.3981</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A2.T5.30.30">
<td class="ltx_td ltx_align_left" id="A2.T5.30.30.3">mmlu marketing</td>
<td class="ltx_td ltx_align_center" id="A2.T5.29.29.1"><math alttext="\mathbf{0.4915}" class="ltx_Math" display="inline" id="A2.T5.29.29.1.m1.1"><semantics id="A2.T5.29.29.1.m1.1a"><mn class="ltx_mathvariant_bold" id="A2.T5.29.29.1.m1.1.1" mathvariant="bold" xref="A2.T5.29.29.1.m1.1.1.cmml">0.4915</mn><annotation-xml encoding="MathML-Content" id="A2.T5.29.29.1.m1.1b"><cn id="A2.T5.29.29.1.m1.1.1.cmml" type="float" xref="A2.T5.29.29.1.m1.1.1">0.4915</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T5.29.29.1.m1.1c">\mathbf{0.4915}</annotation><annotation encoding="application/x-llamapun" id="A2.T5.29.29.1.m1.1d">bold_0.4915</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="A2.T5.30.30.2"><math alttext="\mathbf{0.4915}" class="ltx_Math" display="inline" id="A2.T5.30.30.2.m1.1"><semantics id="A2.T5.30.30.2.m1.1a"><mn class="ltx_mathvariant_bold" id="A2.T5.30.30.2.m1.1.1" mathvariant="bold" xref="A2.T5.30.30.2.m1.1.1.cmml">0.4915</mn><annotation-xml encoding="MathML-Content" id="A2.T5.30.30.2.m1.1b"><cn id="A2.T5.30.30.2.m1.1.1.cmml" type="float" xref="A2.T5.30.30.2.m1.1.1">0.4915</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T5.30.30.2.m1.1c">\mathbf{0.4915}</annotation><annotation encoding="application/x-llamapun" id="A2.T5.30.30.2.m1.1d">bold_0.4915</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A2.T5.32.32">
<td class="ltx_td ltx_align_left" id="A2.T5.32.32.3">mmlu miscellaneous</td>
<td class="ltx_td ltx_align_center" id="A2.T5.31.31.1"><math alttext="\mathbf{0.5121}" class="ltx_Math" display="inline" id="A2.T5.31.31.1.m1.1"><semantics id="A2.T5.31.31.1.m1.1a"><mn class="ltx_mathvariant_bold" id="A2.T5.31.31.1.m1.1.1" mathvariant="bold" xref="A2.T5.31.31.1.m1.1.1.cmml">0.5121</mn><annotation-xml encoding="MathML-Content" id="A2.T5.31.31.1.m1.1b"><cn id="A2.T5.31.31.1.m1.1.1.cmml" type="float" xref="A2.T5.31.31.1.m1.1.1">0.5121</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T5.31.31.1.m1.1c">\mathbf{0.5121}</annotation><annotation encoding="application/x-llamapun" id="A2.T5.31.31.1.m1.1d">bold_0.5121</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="A2.T5.32.32.2"><math alttext="0.4994" class="ltx_Math" display="inline" id="A2.T5.32.32.2.m1.1"><semantics id="A2.T5.32.32.2.m1.1a"><mn id="A2.T5.32.32.2.m1.1.1" xref="A2.T5.32.32.2.m1.1.1.cmml">0.4994</mn><annotation-xml encoding="MathML-Content" id="A2.T5.32.32.2.m1.1b"><cn id="A2.T5.32.32.2.m1.1.1.cmml" type="float" xref="A2.T5.32.32.2.m1.1.1">0.4994</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T5.32.32.2.m1.1c">0.4994</annotation><annotation encoding="application/x-llamapun" id="A2.T5.32.32.2.m1.1d">0.4994</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A2.T5.34.34">
<td class="ltx_td ltx_align_left" id="A2.T5.34.34.3">mmlu philosophy</td>
<td class="ltx_td ltx_align_center" id="A2.T5.33.33.1"><math alttext="0.2958" class="ltx_Math" display="inline" id="A2.T5.33.33.1.m1.1"><semantics id="A2.T5.33.33.1.m1.1a"><mn id="A2.T5.33.33.1.m1.1.1" xref="A2.T5.33.33.1.m1.1.1.cmml">0.2958</mn><annotation-xml encoding="MathML-Content" id="A2.T5.33.33.1.m1.1b"><cn id="A2.T5.33.33.1.m1.1.1.cmml" type="float" xref="A2.T5.33.33.1.m1.1.1">0.2958</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T5.33.33.1.m1.1c">0.2958</annotation><annotation encoding="application/x-llamapun" id="A2.T5.33.33.1.m1.1d">0.2958</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="A2.T5.34.34.2"><math alttext="\mathbf{0.3119}" class="ltx_Math" display="inline" id="A2.T5.34.34.2.m1.1"><semantics id="A2.T5.34.34.2.m1.1a"><mn class="ltx_mathvariant_bold" id="A2.T5.34.34.2.m1.1.1" mathvariant="bold" xref="A2.T5.34.34.2.m1.1.1.cmml">0.3119</mn><annotation-xml encoding="MathML-Content" id="A2.T5.34.34.2.m1.1b"><cn id="A2.T5.34.34.2.m1.1.1.cmml" type="float" xref="A2.T5.34.34.2.m1.1.1">0.3119</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T5.34.34.2.m1.1c">\mathbf{0.3119}</annotation><annotation encoding="application/x-llamapun" id="A2.T5.34.34.2.m1.1d">bold_0.3119</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A2.T5.36.36">
<td class="ltx_td ltx_align_left" id="A2.T5.36.36.3">mmlu professional law</td>
<td class="ltx_td ltx_align_center" id="A2.T5.35.35.1"><math alttext="\mathbf{0.2634}" class="ltx_Math" display="inline" id="A2.T5.35.35.1.m1.1"><semantics id="A2.T5.35.35.1.m1.1a"><mn class="ltx_mathvariant_bold" id="A2.T5.35.35.1.m1.1.1" mathvariant="bold" xref="A2.T5.35.35.1.m1.1.1.cmml">0.2634</mn><annotation-xml encoding="MathML-Content" id="A2.T5.35.35.1.m1.1b"><cn id="A2.T5.35.35.1.m1.1.1.cmml" type="float" xref="A2.T5.35.35.1.m1.1.1">0.2634</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T5.35.35.1.m1.1c">\mathbf{0.2634}</annotation><annotation encoding="application/x-llamapun" id="A2.T5.35.35.1.m1.1d">bold_0.2634</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="A2.T5.36.36.2"><math alttext="0.2536" class="ltx_Math" display="inline" id="A2.T5.36.36.2.m1.1"><semantics id="A2.T5.36.36.2.m1.1a"><mn id="A2.T5.36.36.2.m1.1.1" xref="A2.T5.36.36.2.m1.1.1.cmml">0.2536</mn><annotation-xml encoding="MathML-Content" id="A2.T5.36.36.2.m1.1b"><cn id="A2.T5.36.36.2.m1.1.1.cmml" type="float" xref="A2.T5.36.36.2.m1.1.1">0.2536</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T5.36.36.2.m1.1c">0.2536</annotation><annotation encoding="application/x-llamapun" id="A2.T5.36.36.2.m1.1d">0.2536</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A2.T5.38.38">
<td class="ltx_td ltx_align_left" id="A2.T5.38.38.3">mmlu public relations</td>
<td class="ltx_td ltx_align_center" id="A2.T5.37.37.1"><math alttext="0.3545" class="ltx_Math" display="inline" id="A2.T5.37.37.1.m1.1"><semantics id="A2.T5.37.37.1.m1.1a"><mn id="A2.T5.37.37.1.m1.1.1" xref="A2.T5.37.37.1.m1.1.1.cmml">0.3545</mn><annotation-xml encoding="MathML-Content" id="A2.T5.37.37.1.m1.1b"><cn id="A2.T5.37.37.1.m1.1.1.cmml" type="float" xref="A2.T5.37.37.1.m1.1.1">0.3545</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T5.37.37.1.m1.1c">0.3545</annotation><annotation encoding="application/x-llamapun" id="A2.T5.37.37.1.m1.1d">0.3545</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="A2.T5.38.38.2"><math alttext="\mathbf{0.4273}" class="ltx_Math" display="inline" id="A2.T5.38.38.2.m1.1"><semantics id="A2.T5.38.38.2.m1.1a"><mn class="ltx_mathvariant_bold" id="A2.T5.38.38.2.m1.1.1" mathvariant="bold" xref="A2.T5.38.38.2.m1.1.1.cmml">0.4273</mn><annotation-xml encoding="MathML-Content" id="A2.T5.38.38.2.m1.1b"><cn id="A2.T5.38.38.2.m1.1.1.cmml" type="float" xref="A2.T5.38.38.2.m1.1.1">0.4273</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T5.38.38.2.m1.1c">\mathbf{0.4273}</annotation><annotation encoding="application/x-llamapun" id="A2.T5.38.38.2.m1.1d">bold_0.4273</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A2.T5.40.40">
<td class="ltx_td ltx_align_left" id="A2.T5.40.40.3">mmlu security studies</td>
<td class="ltx_td ltx_align_center" id="A2.T5.39.39.1"><math alttext="\mathbf{0.3224}" class="ltx_Math" display="inline" id="A2.T5.39.39.1.m1.1"><semantics id="A2.T5.39.39.1.m1.1a"><mn class="ltx_mathvariant_bold" id="A2.T5.39.39.1.m1.1.1" mathvariant="bold" xref="A2.T5.39.39.1.m1.1.1.cmml">0.3224</mn><annotation-xml encoding="MathML-Content" id="A2.T5.39.39.1.m1.1b"><cn id="A2.T5.39.39.1.m1.1.1.cmml" type="float" xref="A2.T5.39.39.1.m1.1.1">0.3224</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T5.39.39.1.m1.1c">\mathbf{0.3224}</annotation><annotation encoding="application/x-llamapun" id="A2.T5.39.39.1.m1.1d">bold_0.3224</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="A2.T5.40.40.2"><math alttext="0.3020" class="ltx_Math" display="inline" id="A2.T5.40.40.2.m1.1"><semantics id="A2.T5.40.40.2.m1.1a"><mn id="A2.T5.40.40.2.m1.1.1" xref="A2.T5.40.40.2.m1.1.1.cmml">0.3020</mn><annotation-xml encoding="MathML-Content" id="A2.T5.40.40.2.m1.1b"><cn id="A2.T5.40.40.2.m1.1.1.cmml" type="float" xref="A2.T5.40.40.2.m1.1.1">0.3020</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T5.40.40.2.m1.1c">0.3020</annotation><annotation encoding="application/x-llamapun" id="A2.T5.40.40.2.m1.1d">0.3020</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A2.T5.42.42">
<td class="ltx_td ltx_align_left" id="A2.T5.42.42.3">mmlu sociology</td>
<td class="ltx_td ltx_align_center" id="A2.T5.41.41.1"><math alttext="\mathbf{0.2786}" class="ltx_Math" display="inline" id="A2.T5.41.41.1.m1.1"><semantics id="A2.T5.41.41.1.m1.1a"><mn class="ltx_mathvariant_bold" id="A2.T5.41.41.1.m1.1.1" mathvariant="bold" xref="A2.T5.41.41.1.m1.1.1.cmml">0.2786</mn><annotation-xml encoding="MathML-Content" id="A2.T5.41.41.1.m1.1b"><cn id="A2.T5.41.41.1.m1.1.1.cmml" type="float" xref="A2.T5.41.41.1.m1.1.1">0.2786</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T5.41.41.1.m1.1c">\mathbf{0.2786}</annotation><annotation encoding="application/x-llamapun" id="A2.T5.41.41.1.m1.1d">bold_0.2786</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="A2.T5.42.42.2"><math alttext="\mathbf{0.2786}" class="ltx_Math" display="inline" id="A2.T5.42.42.2.m1.1"><semantics id="A2.T5.42.42.2.m1.1a"><mn class="ltx_mathvariant_bold" id="A2.T5.42.42.2.m1.1.1" mathvariant="bold" xref="A2.T5.42.42.2.m1.1.1.cmml">0.2786</mn><annotation-xml encoding="MathML-Content" id="A2.T5.42.42.2.m1.1b"><cn id="A2.T5.42.42.2.m1.1.1.cmml" type="float" xref="A2.T5.42.42.2.m1.1.1">0.2786</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T5.42.42.2.m1.1c">\mathbf{0.2786}</annotation><annotation encoding="application/x-llamapun" id="A2.T5.42.42.2.m1.1d">bold_0.2786</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A2.T5.44.44">
<td class="ltx_td ltx_align_left" id="A2.T5.44.44.3">mmlu us foreign policy</td>
<td class="ltx_td ltx_align_center" id="A2.T5.43.43.1"><math alttext="0.3300" class="ltx_Math" display="inline" id="A2.T5.43.43.1.m1.1"><semantics id="A2.T5.43.43.1.m1.1a"><mn id="A2.T5.43.43.1.m1.1.1" xref="A2.T5.43.43.1.m1.1.1.cmml">0.3300</mn><annotation-xml encoding="MathML-Content" id="A2.T5.43.43.1.m1.1b"><cn id="A2.T5.43.43.1.m1.1.1.cmml" type="float" xref="A2.T5.43.43.1.m1.1.1">0.3300</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T5.43.43.1.m1.1c">0.3300</annotation><annotation encoding="application/x-llamapun" id="A2.T5.43.43.1.m1.1d">0.3300</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="A2.T5.44.44.2"><math alttext="\mathbf{0.3400}" class="ltx_Math" display="inline" id="A2.T5.44.44.2.m1.1"><semantics id="A2.T5.44.44.2.m1.1a"><mn class="ltx_mathvariant_bold" id="A2.T5.44.44.2.m1.1.1" mathvariant="bold" xref="A2.T5.44.44.2.m1.1.1.cmml">0.3400</mn><annotation-xml encoding="MathML-Content" id="A2.T5.44.44.2.m1.1b"><cn id="A2.T5.44.44.2.m1.1.1.cmml" type="float" xref="A2.T5.44.44.2.m1.1.1">0.3400</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T5.44.44.2.m1.1c">\mathbf{0.3400}</annotation><annotation encoding="application/x-llamapun" id="A2.T5.44.44.2.m1.1d">bold_0.3400</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A2.T5.46.46">
<td class="ltx_td ltx_align_left" id="A2.T5.46.46.3">arc challenge</td>
<td class="ltx_td ltx_align_center" id="A2.T5.45.45.1"><math alttext="\mathbf{0.3200}" class="ltx_Math" display="inline" id="A2.T5.45.45.1.m1.1"><semantics id="A2.T5.45.45.1.m1.1a"><mn class="ltx_mathvariant_bold" id="A2.T5.45.45.1.m1.1.1" mathvariant="bold" xref="A2.T5.45.45.1.m1.1.1.cmml">0.3200</mn><annotation-xml encoding="MathML-Content" id="A2.T5.45.45.1.m1.1b"><cn id="A2.T5.45.45.1.m1.1.1.cmml" type="float" xref="A2.T5.45.45.1.m1.1.1">0.3200</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T5.45.45.1.m1.1c">\mathbf{0.3200}</annotation><annotation encoding="application/x-llamapun" id="A2.T5.45.45.1.m1.1d">bold_0.3200</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="A2.T5.46.46.2"><math alttext="0.2892" class="ltx_Math" display="inline" id="A2.T5.46.46.2.m1.1"><semantics id="A2.T5.46.46.2.m1.1a"><mn id="A2.T5.46.46.2.m1.1.1" xref="A2.T5.46.46.2.m1.1.1.cmml">0.2892</mn><annotation-xml encoding="MathML-Content" id="A2.T5.46.46.2.m1.1b"><cn id="A2.T5.46.46.2.m1.1.1.cmml" type="float" xref="A2.T5.46.46.2.m1.1.1">0.2892</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T5.46.46.2.m1.1c">0.2892</annotation><annotation encoding="application/x-llamapun" id="A2.T5.46.46.2.m1.1d">0.2892</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A2.T5.48.48">
<td class="ltx_td ltx_align_left" id="A2.T5.48.48.3">arc easy</td>
<td class="ltx_td ltx_align_center" id="A2.T5.47.47.1"><math alttext="\mathbf{0.6780}" class="ltx_Math" display="inline" id="A2.T5.47.47.1.m1.1"><semantics id="A2.T5.47.47.1.m1.1a"><mn class="ltx_mathvariant_bold" id="A2.T5.47.47.1.m1.1.1" mathvariant="bold" xref="A2.T5.47.47.1.m1.1.1.cmml">0.6780</mn><annotation-xml encoding="MathML-Content" id="A2.T5.47.47.1.m1.1b"><cn id="A2.T5.47.47.1.m1.1.1.cmml" type="float" xref="A2.T5.47.47.1.m1.1.1">0.6780</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T5.47.47.1.m1.1c">\mathbf{0.6780}</annotation><annotation encoding="application/x-llamapun" id="A2.T5.47.47.1.m1.1d">bold_0.6780</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="A2.T5.48.48.2"><math alttext="0.6549" class="ltx_Math" display="inline" id="A2.T5.48.48.2.m1.1"><semantics id="A2.T5.48.48.2.m1.1a"><mn id="A2.T5.48.48.2.m1.1.1" xref="A2.T5.48.48.2.m1.1.1.cmml">0.6549</mn><annotation-xml encoding="MathML-Content" id="A2.T5.48.48.2.m1.1b"><cn id="A2.T5.48.48.2.m1.1.1.cmml" type="float" xref="A2.T5.48.48.2.m1.1.1">0.6549</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T5.48.48.2.m1.1c">0.6549</annotation><annotation encoding="application/x-llamapun" id="A2.T5.48.48.2.m1.1d">0.6549</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A2.T5.50.50">
<td class="ltx_td ltx_align_left" id="A2.T5.50.50.3">hellaswag</td>
<td class="ltx_td ltx_align_center" id="A2.T5.49.49.1"><math alttext="\mathbf{0.4912}" class="ltx_Math" display="inline" id="A2.T5.49.49.1.m1.1"><semantics id="A2.T5.49.49.1.m1.1a"><mn class="ltx_mathvariant_bold" id="A2.T5.49.49.1.m1.1.1" mathvariant="bold" xref="A2.T5.49.49.1.m1.1.1.cmml">0.4912</mn><annotation-xml encoding="MathML-Content" id="A2.T5.49.49.1.m1.1b"><cn id="A2.T5.49.49.1.m1.1.1.cmml" type="float" xref="A2.T5.49.49.1.m1.1.1">0.4912</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T5.49.49.1.m1.1c">\mathbf{0.4912}</annotation><annotation encoding="application/x-llamapun" id="A2.T5.49.49.1.m1.1d">bold_0.4912</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="A2.T5.50.50.2"><math alttext="0.4663" class="ltx_Math" display="inline" id="A2.T5.50.50.2.m1.1"><semantics id="A2.T5.50.50.2.m1.1a"><mn id="A2.T5.50.50.2.m1.1.1" xref="A2.T5.50.50.2.m1.1.1.cmml">0.4663</mn><annotation-xml encoding="MathML-Content" id="A2.T5.50.50.2.m1.1b"><cn id="A2.T5.50.50.2.m1.1.1.cmml" type="float" xref="A2.T5.50.50.2.m1.1.1">0.4663</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T5.50.50.2.m1.1c">0.4663</annotation><annotation encoding="application/x-llamapun" id="A2.T5.50.50.2.m1.1d">0.4663</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A2.T5.52.52">
<td class="ltx_td ltx_align_left ltx_border_b" id="A2.T5.52.52.3">sciq</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="A2.T5.51.51.1"><math alttext="0.8950" class="ltx_Math" display="inline" id="A2.T5.51.51.1.m1.1"><semantics id="A2.T5.51.51.1.m1.1a"><mn id="A2.T5.51.51.1.m1.1.1" xref="A2.T5.51.51.1.m1.1.1.cmml">0.8950</mn><annotation-xml encoding="MathML-Content" id="A2.T5.51.51.1.m1.1b"><cn id="A2.T5.51.51.1.m1.1.1.cmml" type="float" xref="A2.T5.51.51.1.m1.1.1">0.8950</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T5.51.51.1.m1.1c">0.8950</annotation><annotation encoding="application/x-llamapun" id="A2.T5.51.51.1.m1.1d">0.8950</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="A2.T5.52.52.2"><math alttext="\mathbf{0.9130}" class="ltx_Math" display="inline" id="A2.T5.52.52.2.m1.1"><semantics id="A2.T5.52.52.2.m1.1a"><mn class="ltx_mathvariant_bold" id="A2.T5.52.52.2.m1.1.1" mathvariant="bold" xref="A2.T5.52.52.2.m1.1.1.cmml">0.9130</mn><annotation-xml encoding="MathML-Content" id="A2.T5.52.52.2.m1.1b"><cn id="A2.T5.52.52.2.m1.1.1.cmml" type="float" xref="A2.T5.52.52.2.m1.1.1">0.9130</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T5.52.52.2.m1.1c">\mathbf{0.9130}</annotation><annotation encoding="application/x-llamapun" id="A2.T5.52.52.2.m1.1d">bold_0.9130</annotation></semantics></math></td>
</tr>
</tbody></table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 5: </span><span class="ltx_text ltx_font_bold" id="A2.T5.54.1">Downstream Evaluation Results (Part 2)</span></figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
<section class="ltx_appendix" id="A3">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix C </span>Additional Results</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<section class="ltx_paragraph" id="A3.SS0.SSS0.Px1">
<h5 class="ltx_title ltx_title_paragraph">Effect of Prefix Length on Routing Performance</h5><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="A3.SS0.SSS0.Px1.p1">
<p class="ltx_p" id="A3.SS0.SSS0.Px1.p1.2">We also conducted experiments by partitioning the data using a shorter prefix length of <math alttext="M=32" class="ltx_Math" display="inline" id="A3.SS0.SSS0.Px1.p1.1.m1.1"><semantics id="A3.SS0.SSS0.Px1.p1.1.m1.1a"><mrow id="A3.SS0.SSS0.Px1.p1.1.m1.1.1" xref="A3.SS0.SSS0.Px1.p1.1.m1.1.1.cmml"><mi id="A3.SS0.SSS0.Px1.p1.1.m1.1.1.2" xref="A3.SS0.SSS0.Px1.p1.1.m1.1.1.2.cmml">M</mi><mo id="A3.SS0.SSS0.Px1.p1.1.m1.1.1.1" xref="A3.SS0.SSS0.Px1.p1.1.m1.1.1.1.cmml">=</mo><mn id="A3.SS0.SSS0.Px1.p1.1.m1.1.1.3" xref="A3.SS0.SSS0.Px1.p1.1.m1.1.1.3.cmml">32</mn></mrow><annotation-xml encoding="MathML-Content" id="A3.SS0.SSS0.Px1.p1.1.m1.1b"><apply id="A3.SS0.SSS0.Px1.p1.1.m1.1.1.cmml" xref="A3.SS0.SSS0.Px1.p1.1.m1.1.1"><eq id="A3.SS0.SSS0.Px1.p1.1.m1.1.1.1.cmml" xref="A3.SS0.SSS0.Px1.p1.1.m1.1.1.1"></eq><ci id="A3.SS0.SSS0.Px1.p1.1.m1.1.1.2.cmml" xref="A3.SS0.SSS0.Px1.p1.1.m1.1.1.2">𝑀</ci><cn id="A3.SS0.SSS0.Px1.p1.1.m1.1.1.3.cmml" type="integer" xref="A3.SS0.SSS0.Px1.p1.1.m1.1.1.3">32</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS0.SSS0.Px1.p1.1.m1.1c">M=32</annotation><annotation encoding="application/x-llamapun" id="A3.SS0.SSS0.Px1.p1.1.m1.1d">italic_M = 32</annotation></semantics></math> tokens during training, whereas in our main results (see §&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#S3" title="3 Experiments ‣ No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_tag">3</span></a>), we used a prefix length of <math alttext="M=256" class="ltx_Math" display="inline" id="A3.SS0.SSS0.Px1.p1.2.m2.1"><semantics id="A3.SS0.SSS0.Px1.p1.2.m2.1a"><mrow id="A3.SS0.SSS0.Px1.p1.2.m2.1.1" xref="A3.SS0.SSS0.Px1.p1.2.m2.1.1.cmml"><mi id="A3.SS0.SSS0.Px1.p1.2.m2.1.1.2" xref="A3.SS0.SSS0.Px1.p1.2.m2.1.1.2.cmml">M</mi><mo id="A3.SS0.SSS0.Px1.p1.2.m2.1.1.1" xref="A3.SS0.SSS0.Px1.p1.2.m2.1.1.1.cmml">=</mo><mn id="A3.SS0.SSS0.Px1.p1.2.m2.1.1.3" xref="A3.SS0.SSS0.Px1.p1.2.m2.1.1.3.cmml">256</mn></mrow><annotation-xml encoding="MathML-Content" id="A3.SS0.SSS0.Px1.p1.2.m2.1b"><apply id="A3.SS0.SSS0.Px1.p1.2.m2.1.1.cmml" xref="A3.SS0.SSS0.Px1.p1.2.m2.1.1"><eq id="A3.SS0.SSS0.Px1.p1.2.m2.1.1.1.cmml" xref="A3.SS0.SSS0.Px1.p1.2.m2.1.1.1"></eq><ci id="A3.SS0.SSS0.Px1.p1.2.m2.1.1.2.cmml" xref="A3.SS0.SSS0.Px1.p1.2.m2.1.1.2">𝑀</ci><cn id="A3.SS0.SSS0.Px1.p1.2.m2.1.1.3.cmml" type="integer" xref="A3.SS0.SSS0.Px1.p1.2.m2.1.1.3">256</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS0.SSS0.Px1.p1.2.m2.1c">M=256</annotation><annotation encoding="application/x-llamapun" id="A3.SS0.SSS0.Px1.p1.2.m2.1d">italic_M = 256</annotation></semantics></math> tokens.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_figure ltx_align_floatright" id="A3.F6"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="274" id="A3.F6.g1" src="https://arxiv.org/html/2410.03529v1/x16.png" width="373">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6: </span>Test perplexity as a function of routing prefix length during inference for <math alttext="1.3" class="ltx_Math" display="inline" id="A3.F6.5.m1.1"><semantics id="A3.F6.5.m1.1b"><mn id="A3.F6.5.m1.1.1" xref="A3.F6.5.m1.1.1.cmml">1.3</mn><annotation-xml encoding="MathML-Content" id="A3.F6.5.m1.1c"><cn id="A3.F6.5.m1.1.1.cmml" type="float" xref="A3.F6.5.m1.1.1">1.3</cn></annotation-xml><annotation encoding="application/x-tex" id="A3.F6.5.m1.1d">1.3</annotation><annotation encoding="application/x-llamapun" id="A3.F6.5.m1.1e">1.3</annotation></semantics></math>B parameter models with <math alttext="16" class="ltx_Math" display="inline" id="A3.F6.6.m2.1"><semantics id="A3.F6.6.m2.1b"><mn id="A3.F6.6.m2.1.1" xref="A3.F6.6.m2.1.1.cmml">16</mn><annotation-xml encoding="MathML-Content" id="A3.F6.6.m2.1c"><cn id="A3.F6.6.m2.1.1.cmml" type="integer" xref="A3.F6.6.m2.1.1">16</cn></annotation-xml><annotation encoding="application/x-tex" id="A3.F6.6.m2.1d">16</annotation><annotation encoding="application/x-llamapun" id="A3.F6.6.m2.1e">16</annotation></semantics></math> experts. The orange curve represents a prefix length of <math alttext="32" class="ltx_Math" display="inline" id="A3.F6.7.m3.1"><semantics id="A3.F6.7.m3.1b"><mn id="A3.F6.7.m3.1.1" xref="A3.F6.7.m3.1.1.cmml">32</mn><annotation-xml encoding="MathML-Content" id="A3.F6.7.m3.1c"><cn id="A3.F6.7.m3.1.1.cmml" type="integer" xref="A3.F6.7.m3.1.1">32</cn></annotation-xml><annotation encoding="application/x-tex" id="A3.F6.7.m3.1d">32</annotation><annotation encoding="application/x-llamapun" id="A3.F6.7.m3.1e">32</annotation></semantics></math>, while the blue curve corresponds to a prefix length of <math alttext="256" class="ltx_Math" display="inline" id="A3.F6.8.m4.1"><semantics id="A3.F6.8.m4.1b"><mn id="A3.F6.8.m4.1.1" xref="A3.F6.8.m4.1.1.cmml">256</mn><annotation-xml encoding="MathML-Content" id="A3.F6.8.m4.1c"><cn id="A3.F6.8.m4.1.1.cmml" type="integer" xref="A3.F6.8.m4.1.1">256</cn></annotation-xml><annotation encoding="application/x-tex" id="A3.F6.8.m4.1d">256</annotation><annotation encoding="application/x-llamapun" id="A3.F6.8.m4.1e">256</annotation></semantics></math>.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="A3.SS0.SSS0.Px1.p2">
<p class="ltx_p" id="A3.SS0.SSS0.Px1.p2.1">We observed that training with a smaller prefix length resulted in better expert performance when routing during inference was done using a small number of tokens (see Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#A3.F6" title="Figure 6 ‣ Effect of Prefix Length on Routing Performance ‣ Appendix C Additional Results ‣ No Need to Talk: Asynchronous Mixture of Language Models"><span class="ltx_text ltx_ref_tag">6</span></a>). This suggests that using a shorter prefix during training enhances the router’s ability to make effective decisions with limited context.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="A3.SS0.SSS0.Px1.p3">
<p class="ltx_p" id="A3.SS0.SSS0.Px1.p3.1">We did not take any action to make sure that the router models could extrapolate to longer sequences than seen in training (e.g. interpolating positional encodings, using ALiBi <cite class="ltx_cite ltx_citemacro_citep">(Press et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03529v1#bib.bib42" title="">2022</a>)</cite>, etc.). As expected, we observe a performance degradation when making routing decisions for sequences longer than the ones used for training.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_pagination ltx_role_newpage"></div>
</div>
</section>
</section>
</article>
</div>

</div>


<button type="button" class="btn btn-primary hover-rp-button" id="openForm">Report Issue</button><div class="modal" id="myForm" role="dialog" aria-labelledby="modal-title"><div class="modal-dialog"><form class="modal-content" id="myFormContent" enctype="multipart/form-data"><div class="modal-header" id="modal-header"><h5 class="modal-title">Report Github Issue</h5><button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button></div><div class="modal-body"><label for="form_title" id="modalTitle">Title:</label><input class="form-control" id="form_title" name="form_title" required="required" placeholder="Enter title"><label for="description" id="selectedTextModalDescription" style="display: none;">Content selection saved. Describe the issue below:</label><label for="description" id="nomralModalDescription">Description:</label><textarea class="form-control" id="description" name="description" required="required" style="height: 80px;" maxlength="500" placeholder="500 characters maximum"></textarea></div><div class="modal-footer d-flex justify-content-end"><button type="submit" class="sr-only button" id="modal-submit-sr">Submit without Github</button><button type="submit" class="btn btn-primary" id="modal-submit">Submit in Github</button></div></form></div></div><button id="small-report-button" type="button" class="btn btn-secondary btn-sm" style="background-color: rgb(179, 27, 27); position: fixed;">Report Issue for Selection</button><div class="ltx_page_footer">
        <div class="ltx_page_logo">
            Generated by
            <a href="https://math.nist.gov/~BMiller/LaTeXML/" class="ltx_LaTeXML_logo">
                <span style="letter-spacing: -0.2em; margin-right: 0.1em;">
                    L
                    <span style="font-size: 70%; position: relative; bottom: 2.2pt;">A</span>
                    T
                    <span style="position: relative; bottom: -0.4ex;">E</span>
                </span>
                <span class="ltx_font_smallcaps">xml</span>
                <img alt="[LOGO]" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==">
            </a>
        </div></div><footer id="footer" class="ltx_document">
        <div class="keyboard-glossary">
            <h2>Instructions for reporting errors</h2>
            <p>We are continuing to improve HTML versions of papers, and your feedback helps enhance accessibility and mobile support. To report errors in the HTML that will help us improve conversion and rendering, choose any of the methods listed below:</p>
            <ul>
                <li>Click the "Report Issue" button.</li>
                <li>Open a report feedback form via keyboard, use "<strong>Ctrl + ?</strong>".</li>
                <li>Make a text selection and click the "Report Issue for Selection" button near your cursor.</li>
                <li class="sr-only">You can use Alt+Y to toggle on and Alt+Shift+Y to toggle off accessible reporting links at each section.</li>
            </ul>
            <p>Our team has already identified <a class="ltx_ref" href="https://github.com/arXiv/html_feedback/issues" target="_blank">the following issues</a>. We appreciate your time reviewing and reporting rendering errors we may not have found yet. Your efforts will help us improve the HTML versions for all readers, because disability should not be a barrier to accessing research. Thank you for your continued support in championing open access for all.</p>
            <p>Have a free development cycle? Help support accessibility at arXiv! Our collaborators at LaTeXML maintain a <a class="ltx_ref" href="https://github.com/brucemiller/LaTeXML/wiki/Porting-LaTeX-packages-for-LaTeXML" target="_blank">list of packages that need conversion</a>, and welcome <a class="ltx_ref" href="https://github.com/brucemiller/LaTeXML/issues" target="_blank">developer contributions</a>.</p>
        </div>
    </footer></body></html>