<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>Learning Structured Representations by Embedding Class Hierarchy with Fast Optimal Transport</title>
<!--Generated on Fri Oct  4 00:19:53 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<base href="/html/2410.03052v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.03052v1#S1" title="In Learning Structured Representations by Embedding Class Hierarchy with Fast Optimal Transport"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03052v1#S2" title="In Learning Structured Representations by Embedding Class Hierarchy with Fast Optimal Transport"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Preliminaries</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.03052v1#S2.SS0.SSS0.Px1" title="In 2 Preliminaries ‣ Learning Structured Representations by Embedding Class Hierarchy with Fast Optimal Transport"><span class="ltx_text ltx_ref_title">Notation and Problem Setup</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03052v1#S2.SS1" title="In 2 Preliminaries ‣ Learning Structured Representations by Embedding Class Hierarchy with Fast Optimal Transport"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.1 </span>Cophenetic Correlation Coefficient</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03052v1#S2.SS2" title="In 2 Preliminaries ‣ Learning Structured Representations by Embedding Class Hierarchy with Fast Optimal Transport"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2 </span>Exact Earth Mover’s Distance</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03052v1#S3" title="In Learning Structured Representations by Embedding Class Hierarchy with Fast Optimal Transport"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>CPCC with Optimal Transport</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03052v1#S3.SS1" title="In 3 CPCC with Optimal Transport ‣ Learning Structured Representations by Embedding Class Hierarchy with Fast Optimal Transport"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>OT-CPCC Family</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03052v1#S3.SS2" title="In 3 CPCC with Optimal Transport ‣ Learning Structured Representations by Embedding Class Hierarchy with Fast Optimal Transport"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>Fast FlowTree</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.03052v1#S3.SS2.SSS0.Px1" title="In 3.2 Fast FlowTree ‣ 3 CPCC with Optimal Transport ‣ Learning Structured Representations by Embedding Class Hierarchy with Fast Optimal Transport"><span class="ltx_text ltx_ref_title">FlowTree</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.03052v1#S3.SS2.SSS0.Px2" title="In 3.2 Fast FlowTree ‣ 3 CPCC with Optimal Transport ‣ Learning Structured Representations by Embedding Class Hierarchy with Fast Optimal Transport"><span class="ltx_text ltx_ref_title">Our Fast FlowTree</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.03052v1#S3.SS2.SSS0.Px3" title="In 3.2 Fast FlowTree ‣ 3 CPCC with Optimal Transport ‣ Learning Structured Representations by Embedding Class Hierarchy with Fast Optimal Transport"><span class="ltx_text ltx_ref_title">Comparison of OT-methods on Synthetic Dataset</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03052v1#S3.SS3" title="In 3 CPCC with Optimal Transport ‣ Learning Structured Representations by Embedding Class Hierarchy with Fast Optimal Transport"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3 </span>Differentiability Analysis of OT-CPCC</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.03052v1#S3.SS3.SSS0.Px1" title="In 3.3 Differentiability Analysis of OT-CPCC ‣ 3 CPCC with Optimal Transport ‣ Learning Structured Representations by Embedding Class Hierarchy with Fast Optimal Transport"><span class="ltx_text ltx_ref_title">Differentiability for Other OT-CPCC Methods</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.03052v1#S3.SS3.SSS0.Px2" title="In 3.3 Differentiability Analysis of OT-CPCC ‣ 3 CPCC with Optimal Transport ‣ Learning Structured Representations by Embedding Class Hierarchy with Fast Optimal Transport"><span class="ltx_text ltx_ref_title">Gradient of <math alttext="\ell_{2}" class="ltx_Math" display="inline"><semantics><msub><mi mathvariant="normal">ℓ</mi><mn>2</mn></msub><annotation-xml encoding="MathML-Content"><apply><csymbol cd="ambiguous">subscript</csymbol><ci>ℓ</ci><cn type="integer">2</cn></apply></annotation-xml><annotation encoding="application/x-tex">\ell_{2}</annotation><annotation encoding="application/x-llamapun">roman_ℓ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>-CPCC</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.03052v1#S3.SS3.SSS0.Px3" title="In 3.3 Differentiability Analysis of OT-CPCC ‣ 3 CPCC with Optimal Transport ‣ Learning Structured Representations by Embedding Class Hierarchy with Fast Optimal Transport"><span class="ltx_text ltx_ref_title">Gradient of EMD-CPCC</span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03052v1#S4" title="In Learning Structured Representations by Embedding Class Hierarchy with Fast Optimal Transport"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Experiments</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03052v1#S4.SS1" title="In 4 Experiments ‣ Learning Structured Representations by Embedding Class Hierarchy with Fast Optimal Transport"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Datasets</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03052v1#S4.SS2" title="In 4 Experiments ‣ Learning Structured Representations by Embedding Class Hierarchy with Fast Optimal Transport"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>Existence of Multi-mode Class-conditioned Feature Distribution</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03052v1#S4.SS3" title="In 4 Experiments ‣ Learning Structured Representations by Embedding Class Hierarchy with Fast Optimal Transport"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3 </span>Hierarchical Classification and Retrieval</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.03052v1#S4.SS3.SSS0.Px1" title="In 4.3 Hierarchical Classification and Retrieval ‣ 4 Experiments ‣ Learning Structured Representations by Embedding Class Hierarchy with Fast Optimal Transport"><span class="ltx_text ltx_ref_title">Hierarchical Dataset Split</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.03052v1#S4.SS3.SSS0.Px2" title="In 4.3 Hierarchical Classification and Retrieval ‣ 4 Experiments ‣ Learning Structured Representations by Embedding Class Hierarchy with Fast Optimal Transport"><span class="ltx_text ltx_ref_title">Metrics</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.03052v1#S4.SS3.SSS0.Px3" title="In 4.3 Hierarchical Classification and Retrieval ‣ 4 Experiments ‣ Learning Structured Representations by Embedding Class Hierarchy with Fast Optimal Transport"><span class="ltx_text ltx_ref_title">Discussion</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03052v1#S4.SS4" title="In 4 Experiments ‣ Learning Structured Representations by Embedding Class Hierarchy with Fast Optimal Transport"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.4 </span>Interpretability Evaluation</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.03052v1#S4.SS4.SSS0.Px1" title="In 4.4 Interpretability Evaluation ‣ 4 Experiments ‣ Learning Structured Representations by Embedding Class Hierarchy with Fast Optimal Transport"><span class="ltx_text ltx_ref_title">Ablation Study</span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03052v1#S5" title="In Learning Structured Representations by Embedding Class Hierarchy with Fast Optimal Transport"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Related Work</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.03052v1#S5.SS0.SSS0.Px1" title="In 5 Related Work ‣ Learning Structured Representations by Embedding Class Hierarchy with Fast Optimal Transport"><span class="ltx_text ltx_ref_title">Learning Hierarchical Representations</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.03052v1#S5.SS0.SSS0.Px2" title="In 5 Related Work ‣ Learning Structured Representations by Embedding Class Hierarchy with Fast Optimal Transport"><span class="ltx_text ltx_ref_title">OT Methods and Hierarchical Learning</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.03052v1#S6" title="In Learning Structured Representations by Embedding Class Hierarchy with Fast Optimal Transport"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6 </span>Conclusion</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2410.03052v1#A1" title="In Learning Structured Representations by Embedding Class Hierarchy with Fast Optimal Transport"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A </span>Approximation Methods of Earth Mover’s Distance</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2410.03052v1#A2" title="In Learning Structured Representations by Embedding Class Hierarchy with Fast Optimal Transport"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B </span>EMD-CPCC Generalizes <math alttext="\ell_{2}" class="ltx_Math" display="inline"><semantics><msub><mi mathvariant="normal">ℓ</mi><mn>2</mn></msub><annotation-xml encoding="MathML-Content"><apply><csymbol cd="ambiguous">subscript</csymbol><ci>ℓ</ci><cn type="integer">2</cn></apply></annotation-xml><annotation encoding="application/x-tex">\ell_{2}</annotation><annotation encoding="application/x-llamapun">roman_ℓ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>-CPCC</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2410.03052v1#A3" title="In Learning Structured Representations by Embedding Class Hierarchy with Fast Optimal Transport"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">C </span>Details for Fast Flow Tree CPCC Algorithm</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2410.03052v1#A4" title="In Learning Structured Representations by Embedding Class Hierarchy with Fast Optimal Transport"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">D </span>Dataset Hierarchy Construction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03052v1#A5" title="In Learning Structured Representations by Embedding Class Hierarchy with Fast Optimal Transport"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">E </span>Training Hyperparameters</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03052v1#A5.SS1" title="In Appendix E Training Hyperparameters ‣ Learning Structured Representations by Embedding Class Hierarchy with Fast Optimal Transport"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">E.1 </span>CIFAR10, CIFAR100</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03052v1#A5.SS2" title="In Appendix E Training Hyperparameters ‣ Learning Structured Representations by Embedding Class Hierarchy with Fast Optimal Transport"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">E.2 </span>BREEDS</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03052v1#A5.SS3" title="In Appendix E Training Hyperparameters ‣ Learning Structured Representations by Embedding Class Hierarchy with Fast Optimal Transport"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">E.3 </span>INAT</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03052v1#A6" title="In Learning Structured Representations by Embedding Class Hierarchy with Fast Optimal Transport"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">F </span>Hierarchical Baseline Objectives</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.03052v1#A6.SS0.SSS0.Px1" title="In Appendix F Hierarchical Baseline Objectives ‣ Learning Structured Representations by Embedding Class Hierarchy with Fast Optimal Transport"><span class="ltx_text ltx_ref_title">Flat</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.03052v1#A6.SS0.SSS0.Px2" title="In Appendix F Hierarchical Baseline Objectives ‣ Learning Structured Representations by Embedding Class Hierarchy with Fast Optimal Transport"><span class="ltx_text ltx_ref_title">Soft Hierarchical Consistency</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.03052v1#A6.SS0.SSS0.Px3" title="In Appendix F Hierarchical Baseline Objectives ‣ Learning Structured Representations by Embedding Class Hierarchy with Fast Optimal Transport"><span class="ltx_text ltx_ref_title">Geometric Consistency</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.03052v1#A6.SS0.SSS0.Px4" title="In Appendix F Hierarchical Baseline Objectives ‣ Learning Structured Representations by Embedding Class Hierarchy with Fast Optimal Transport"><span class="ltx_text ltx_ref_title">RankLoss</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03052v1#A7" title="In Learning Structured Representations by Embedding Class Hierarchy with Fast Optimal Transport"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">G </span>Additional Experiments</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03052v1#A7.SS1" title="In Appendix G Additional Experiments ‣ Learning Structured Representations by Embedding Class Hierarchy with Fast Optimal Transport"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">G.1 </span>Effect of Tree Depth</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03052v1#A7.SS2" title="In Appendix G Additional Experiments ‣ Learning Structured Representations by Embedding Class Hierarchy with Fast Optimal Transport"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">G.2 </span>Effect of Tree Weights</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03052v1#A7.SS3" title="In Appendix G Additional Experiments ‣ Learning Structured Representations by Embedding Class Hierarchy with Fast Optimal Transport"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">G.3 </span>Effect of Flow Weight</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03052v1#A7.SS4" title="In Appendix G Additional Experiments ‣ Learning Structured Representations by Embedding Class Hierarchy with Fast Optimal Transport"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">G.4 </span>Comparison to Other Hierarchical Baselines</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03052v1#A8" title="In Learning Structured Representations by Embedding Class Hierarchy with Fast Optimal Transport"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">H </span>Implementation Details for Synthetic Datasets Experiments</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.03052v1#A8.SS0.SSS0.Px1" title="In Appendix H Implementation Details for Synthetic Datasets Experiments ‣ Learning Structured Representations by Embedding Class Hierarchy with Fast Optimal Transport"><span class="ltx_text ltx_ref_title">Computational Efficiency</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.03052v1#A8.SS0.SSS0.Px2" title="In Appendix H Implementation Details for Synthetic Datasets Experiments ‣ Learning Structured Representations by Embedding Class Hierarchy with Fast Optimal Transport"><span class="ltx_text ltx_ref_title">Approximation Error</span></a></li>
</ol>
</li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Learning Structured Representations by Embedding Class Hierarchy with Fast Optimal Transport</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Siqi Zeng 
<br class="ltx_break"/>University of Illinois, Urbana-Champaign
<br class="ltx_break"/><span class="ltx_text ltx_font_typewriter" id="id1.1.id1">siqi6@illinois.edu</span>
<br class="ltx_break"/>&amp;Sixian Du
<br class="ltx_break"/>Stanford University
<br class="ltx_break"/><span class="ltx_text ltx_font_typewriter" id="id2.2.id2">dusixian@stanford.edu</span>
<br class="ltx_break"/>Makoto Yamada 
<br class="ltx_break"/>Okinawa Institute of Science and Technology 
<br class="ltx_break"/><span class="ltx_text ltx_font_typewriter" id="id3.3.id3">makoto.yamada@oist.jp</span>
<br class="ltx_break"/>&amp;Han Zhao 
<br class="ltx_break"/>University of Illinois, Urbana-Champaign 
<br class="ltx_break"/><span class="ltx_text ltx_font_typewriter" id="id4.4.id4">hanzhao@illinois.edu</span>
</span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id5.id1">To embed structured knowledge within labels into feature representations, prior work <cite class="ltx_cite ltx_citemacro_citep">(Zeng et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03052v1#bib.bib40" title="">2022</a>)</cite> proposed to use the <span class="ltx_text ltx_font_bold" id="id5.id1.1">C</span>o<span class="ltx_text ltx_font_bold" id="id5.id1.2">p</span>henetic <span class="ltx_text ltx_font_bold" id="id5.id1.3">C</span>orrelation <span class="ltx_text ltx_font_bold" id="id5.id1.4">C</span>oefficient (CPCC) as a regularizer during supervised learning. This regularizer calculates pairwise Euclidean distances of class means and aligns them with the corresponding shortest path distances derived from the label hierarchy tree. However, class means may not be good representatives of the class conditional distributions, especially when they are multi-mode in nature. To address this limitation, under the CPCC framework, we propose to use the Earth Mover’s Distance (EMD) to measure the pairwise distances among classes in the feature space. We show that our exact EMD method generalizes previous work, and recovers the existing algorithm when class-conditional distributions are Gaussian. To further improve the computational efficiency of our method, we introduce the <span class="ltx_text ltx_font_bold" id="id5.id1.5">O</span>ptimal <span class="ltx_text ltx_font_bold" id="id5.id1.6">T</span>ransport-CPCC family by exploring four EMD approximation variants. Our most efficient OT-CPCC variant, the proposed Fast FlowTree algorithm, runs in linear time in the size of the dataset, while maintaining competitive performance across datasets and tasks.</p>
</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">Supervised classification problems have been a cornerstone in machine learning. While traditional classification methods treat class labels as independent entities, there has been a growing interest in leveraging semantic similarity among classes to improve model performance while following existing label dependency. This is particularly important in fine-grained classification tasks where labels are inherently living on a hierarchy, such as in the CIFAR <cite class="ltx_cite ltx_citemacro_citep">(Krizhevsky and Hinton, <a class="ltx_ref" href="https://arxiv.org/html/2410.03052v1#bib.bib23" title="">2009</a>)</cite> and ImageNet <cite class="ltx_cite ltx_citemacro_citep">(Deng et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03052v1#bib.bib10" title="">2009</a>)</cite> datasets. To capture the hierarchical relationship between classes, <cite class="ltx_cite ltx_citemacro_citet">Zeng et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03052v1#bib.bib40" title="">2022</a>)</cite> made a significant contribution by embedding the tree metric of a given class hierarchy into the feature space. They introduced a regularizer, the Cophenetic Correlation Coefficient (CPCC), to correlate the tree metric with the Euclidean distance in the class-conditioned representations. This approach of encoding hierarchical relationship in the latent space not only led to more interpretable features compared to other hierarchical classification methods <cite class="ltx_cite ltx_citemacro_citep">(Shen et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03052v1#bib.bib33" title="">2023</a>)</cite>, but also improved some generalization performance across multiple datasets.</p>
</div>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.2">Despite the value of this framework for embedding class hierarchies, it presents a notable limitation. Specifically, <cite class="ltx_cite ltx_citemacro_citet">Zeng et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03052v1#bib.bib40" title="">2022</a>)</cite> uses the <math alttext="\ell_{2}" class="ltx_Math" display="inline" id="S1.p2.1.m1.1"><semantics id="S1.p2.1.m1.1a"><msub id="S1.p2.1.m1.1.1" xref="S1.p2.1.m1.1.1.cmml"><mi id="S1.p2.1.m1.1.1.2" mathvariant="normal" xref="S1.p2.1.m1.1.1.2.cmml">ℓ</mi><mn id="S1.p2.1.m1.1.1.3" xref="S1.p2.1.m1.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S1.p2.1.m1.1b"><apply id="S1.p2.1.m1.1.1.cmml" xref="S1.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S1.p2.1.m1.1.1.1.cmml" xref="S1.p2.1.m1.1.1">subscript</csymbol><ci id="S1.p2.1.m1.1.1.2.cmml" xref="S1.p2.1.m1.1.1.2">ℓ</ci><cn id="S1.p2.1.m1.1.1.3.cmml" type="integer" xref="S1.p2.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p2.1.m1.1c">\ell_{2}</annotation><annotation encoding="application/x-llamapun" id="S1.p2.1.m1.1d">roman_ℓ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math> norm between two class Euclidean centroids as the distance of two class distributions. However, this approach overlooks the difference of samples within the same class, and thus cannot fully capture the global structural information given pairs of class-conditional distributions, especially when they are multi-modal.
On the other hand, the use of Optimal Transport (OT) as an alternative to Euclidean centroids has first gained attention in the context of clustering, where Euclidean centroids neglect the intrinsic geometry of data distributions <cite class="ltx_cite ltx_citemacro_citep">(Cuturi and Doucet, <a class="ltx_ref" href="https://arxiv.org/html/2410.03052v1#bib.bib8" title="">2014</a>)</cite>. For the same motivation, we propose addressing the limitation of <math alttext="\ell_{2}" class="ltx_Math" display="inline" id="S1.p2.2.m2.1"><semantics id="S1.p2.2.m2.1a"><msub id="S1.p2.2.m2.1.1" xref="S1.p2.2.m2.1.1.cmml"><mi id="S1.p2.2.m2.1.1.2" mathvariant="normal" xref="S1.p2.2.m2.1.1.2.cmml">ℓ</mi><mn id="S1.p2.2.m2.1.1.3" xref="S1.p2.2.m2.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S1.p2.2.m2.1b"><apply id="S1.p2.2.m2.1.1.cmml" xref="S1.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S1.p2.2.m2.1.1.1.cmml" xref="S1.p2.2.m2.1.1">subscript</csymbol><ci id="S1.p2.2.m2.1.1.2.cmml" xref="S1.p2.2.m2.1.1.2">ℓ</ci><cn id="S1.p2.2.m2.1.1.3.cmml" type="integer" xref="S1.p2.2.m2.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p2.2.m2.1c">\ell_{2}</annotation><annotation encoding="application/x-llamapun" id="S1.p2.2.m2.1d">roman_ℓ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>-CPCC <cite class="ltx_cite ltx_citemacro_citep">(Zeng et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03052v1#bib.bib40" title="">2022</a>)</cite>, by integrating the OT distance, also known as the Wasserstein distance, and its variants, as a more effective metric for measuring the distance between class distributions in the problem of embedding hierarchical representations.</p>
</div>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.4">Our contributions are as follows: (i) We first generalize the <math alttext="\ell_{2}" class="ltx_Math" display="inline" id="S1.p3.1.m1.1"><semantics id="S1.p3.1.m1.1a"><msub id="S1.p3.1.m1.1.1" xref="S1.p3.1.m1.1.1.cmml"><mi id="S1.p3.1.m1.1.1.2" mathvariant="normal" xref="S1.p3.1.m1.1.1.2.cmml">ℓ</mi><mn id="S1.p3.1.m1.1.1.3" xref="S1.p3.1.m1.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S1.p3.1.m1.1b"><apply id="S1.p3.1.m1.1.1.cmml" xref="S1.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S1.p3.1.m1.1.1.1.cmml" xref="S1.p3.1.m1.1.1">subscript</csymbol><ci id="S1.p3.1.m1.1.1.2.cmml" xref="S1.p3.1.m1.1.1.2">ℓ</ci><cn id="S1.p3.1.m1.1.1.3.cmml" type="integer" xref="S1.p3.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.1.m1.1c">\ell_{2}</annotation><annotation encoding="application/x-llamapun" id="S1.p3.1.m1.1d">roman_ℓ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>-CPCC with EMD, and propose a family of OT-CPCC algorithm to address the limitation of using <math alttext="\ell_{2}" class="ltx_Math" display="inline" id="S1.p3.2.m2.1"><semantics id="S1.p3.2.m2.1a"><msub id="S1.p3.2.m2.1.1" xref="S1.p3.2.m2.1.1.cmml"><mi id="S1.p3.2.m2.1.1.2" mathvariant="normal" xref="S1.p3.2.m2.1.1.2.cmml">ℓ</mi><mn id="S1.p3.2.m2.1.1.3" xref="S1.p3.2.m2.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S1.p3.2.m2.1b"><apply id="S1.p3.2.m2.1.1.cmml" xref="S1.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S1.p3.2.m2.1.1.1.cmml" xref="S1.p3.2.m2.1.1">subscript</csymbol><ci id="S1.p3.2.m2.1.1.2.cmml" xref="S1.p3.2.m2.1.1.2">ℓ</ci><cn id="S1.p3.2.m2.1.1.3.cmml" type="integer" xref="S1.p3.2.m2.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.2.m2.1c">\ell_{2}</annotation><annotation encoding="application/x-llamapun" id="S1.p3.2.m2.1d">roman_ℓ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math> centroids that misrepresents class relationships. We provide a detailed comparative analysis of <math alttext="\ell_{2}" class="ltx_Math" display="inline" id="S1.p3.3.m3.1"><semantics id="S1.p3.3.m3.1a"><msub id="S1.p3.3.m3.1.1" xref="S1.p3.3.m3.1.1.cmml"><mi id="S1.p3.3.m3.1.1.2" mathvariant="normal" xref="S1.p3.3.m3.1.1.2.cmml">ℓ</mi><mn id="S1.p3.3.m3.1.1.3" xref="S1.p3.3.m3.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S1.p3.3.m3.1b"><apply id="S1.p3.3.m3.1.1.cmml" xref="S1.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S1.p3.3.m3.1.1.1.cmml" xref="S1.p3.3.m3.1.1">subscript</csymbol><ci id="S1.p3.3.m3.1.1.2.cmml" xref="S1.p3.3.m3.1.1.2">ℓ</ci><cn id="S1.p3.3.m3.1.1.3.cmml" type="integer" xref="S1.p3.3.m3.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.3.m3.1c">\ell_{2}</annotation><annotation encoding="application/x-llamapun" id="S1.p3.3.m3.1d">roman_ℓ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>-CPCC versus OT-CPCC about their forward and backward computation. (ii) We propose a novel linear time OT approximation algorithm, FastFT, and apply it in the CPCC framework to learn hierarchical representations that is significantly more efficient than the cubic time exact EMD solution. (iii) We empirically analyze the advantage of OT-CPCC over <math alttext="\ell_{2}" class="ltx_Math" display="inline" id="S1.p3.4.m4.1"><semantics id="S1.p3.4.m4.1a"><msub id="S1.p3.4.m4.1.1" xref="S1.p3.4.m4.1.1.cmml"><mi id="S1.p3.4.m4.1.1.2" mathvariant="normal" xref="S1.p3.4.m4.1.1.2.cmml">ℓ</mi><mn id="S1.p3.4.m4.1.1.3" xref="S1.p3.4.m4.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S1.p3.4.m4.1b"><apply id="S1.p3.4.m4.1.1.cmml" xref="S1.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S1.p3.4.m4.1.1.1.cmml" xref="S1.p3.4.m4.1.1">subscript</csymbol><ci id="S1.p3.4.m4.1.1.2.cmml" xref="S1.p3.4.m4.1.1.2">ℓ</ci><cn id="S1.p3.4.m4.1.1.3.cmml" type="integer" xref="S1.p3.4.m4.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.4.m4.1c">\ell_{2}</annotation><annotation encoding="application/x-llamapun" id="S1.p3.4.m4.1d">roman_ℓ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>-CPCC across a wide range real-world datasets and tasks.</p>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Preliminaries</h2>
<section class="ltx_paragraph" id="S2.SS0.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">Notation and Problem Setup</h4>
<div class="ltx_para" id="S2.SS0.SSS0.Px1.p1">
<p class="ltx_p" id="S2.SS0.SSS0.Px1.p1.8">Throughout the paper we focus on the supervised <math alttext="k" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p1.1.m1.1"><semantics id="S2.SS0.SSS0.Px1.p1.1.m1.1a"><mi id="S2.SS0.SSS0.Px1.p1.1.m1.1.1" xref="S2.SS0.SSS0.Px1.p1.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p1.1.m1.1b"><ci id="S2.SS0.SSS0.Px1.p1.1.m1.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p1.1.m1.1c">k</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.p1.1.m1.1d">italic_k</annotation></semantics></math>-class classification problem. We denote a sample of input <math alttext="x" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p1.2.m2.1"><semantics id="S2.SS0.SSS0.Px1.p1.2.m2.1a"><mi id="S2.SS0.SSS0.Px1.p1.2.m2.1.1" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p1.2.m2.1b"><ci id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p1.2.m2.1c">x</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.p1.2.m2.1d">italic_x</annotation></semantics></math> with label <math alttext="y" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p1.3.m3.1"><semantics id="S2.SS0.SSS0.Px1.p1.3.m3.1a"><mi id="S2.SS0.SSS0.Px1.p1.3.m3.1.1" xref="S2.SS0.SSS0.Px1.p1.3.m3.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p1.3.m3.1b"><ci id="S2.SS0.SSS0.Px1.p1.3.m3.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.3.m3.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p1.3.m3.1c">y</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.p1.3.m3.1d">italic_y</annotation></semantics></math> living in the space of <math alttext="{\mathcal{X}}\subseteq\mathbb{R}^{p}" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p1.4.m4.1"><semantics id="S2.SS0.SSS0.Px1.p1.4.m4.1a"><mrow id="S2.SS0.SSS0.Px1.p1.4.m4.1.1" xref="S2.SS0.SSS0.Px1.p1.4.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS0.SSS0.Px1.p1.4.m4.1.1.2" xref="S2.SS0.SSS0.Px1.p1.4.m4.1.1.2.cmml">𝒳</mi><mo id="S2.SS0.SSS0.Px1.p1.4.m4.1.1.1" xref="S2.SS0.SSS0.Px1.p1.4.m4.1.1.1.cmml">⊆</mo><msup id="S2.SS0.SSS0.Px1.p1.4.m4.1.1.3" xref="S2.SS0.SSS0.Px1.p1.4.m4.1.1.3.cmml"><mi id="S2.SS0.SSS0.Px1.p1.4.m4.1.1.3.2" xref="S2.SS0.SSS0.Px1.p1.4.m4.1.1.3.2.cmml">ℝ</mi><mi id="S2.SS0.SSS0.Px1.p1.4.m4.1.1.3.3" xref="S2.SS0.SSS0.Px1.p1.4.m4.1.1.3.3.cmml">p</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p1.4.m4.1b"><apply id="S2.SS0.SSS0.Px1.p1.4.m4.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.4.m4.1.1"><subset id="S2.SS0.SSS0.Px1.p1.4.m4.1.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.4.m4.1.1.1"></subset><ci id="S2.SS0.SSS0.Px1.p1.4.m4.1.1.2.cmml" xref="S2.SS0.SSS0.Px1.p1.4.m4.1.1.2">𝒳</ci><apply id="S2.SS0.SSS0.Px1.p1.4.m4.1.1.3.cmml" xref="S2.SS0.SSS0.Px1.p1.4.m4.1.1.3"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p1.4.m4.1.1.3.1.cmml" xref="S2.SS0.SSS0.Px1.p1.4.m4.1.1.3">superscript</csymbol><ci id="S2.SS0.SSS0.Px1.p1.4.m4.1.1.3.2.cmml" xref="S2.SS0.SSS0.Px1.p1.4.m4.1.1.3.2">ℝ</ci><ci id="S2.SS0.SSS0.Px1.p1.4.m4.1.1.3.3.cmml" xref="S2.SS0.SSS0.Px1.p1.4.m4.1.1.3.3">𝑝</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p1.4.m4.1c">{\mathcal{X}}\subseteq\mathbb{R}^{p}</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.p1.4.m4.1d">caligraphic_X ⊆ blackboard_R start_POSTSUPERSCRIPT italic_p end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="{\mathcal{Y}}=[k]\vcentcolon=\{1\ldots,k\}" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p1.5.m5.3"><semantics id="S2.SS0.SSS0.Px1.p1.5.m5.3a"><mrow id="S2.SS0.SSS0.Px1.p1.5.m5.3.3" xref="S2.SS0.SSS0.Px1.p1.5.m5.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS0.SSS0.Px1.p1.5.m5.3.3.3" xref="S2.SS0.SSS0.Px1.p1.5.m5.3.3.3.cmml">𝒴</mi><mo id="S2.SS0.SSS0.Px1.p1.5.m5.3.3.4" xref="S2.SS0.SSS0.Px1.p1.5.m5.3.3.4.cmml">=</mo><mrow id="S2.SS0.SSS0.Px1.p1.5.m5.3.3.5.2" xref="S2.SS0.SSS0.Px1.p1.5.m5.3.3.5.1.cmml"><mo id="S2.SS0.SSS0.Px1.p1.5.m5.3.3.5.2.1" stretchy="false" xref="S2.SS0.SSS0.Px1.p1.5.m5.3.3.5.1.1.cmml">[</mo><mi id="S2.SS0.SSS0.Px1.p1.5.m5.1.1" xref="S2.SS0.SSS0.Px1.p1.5.m5.1.1.cmml">k</mi><mo id="S2.SS0.SSS0.Px1.p1.5.m5.3.3.5.2.2" rspace="0.278em" stretchy="false" xref="S2.SS0.SSS0.Px1.p1.5.m5.3.3.5.1.1.cmml">]</mo></mrow><mo id="S2.SS0.SSS0.Px1.p1.5.m5.3.3.6" rspace="0.278em" xref="S2.SS0.SSS0.Px1.p1.5.m5.3.3.6.cmml">:=</mo><mrow id="S2.SS0.SSS0.Px1.p1.5.m5.3.3.1.1" xref="S2.SS0.SSS0.Px1.p1.5.m5.3.3.1.2.cmml"><mo id="S2.SS0.SSS0.Px1.p1.5.m5.3.3.1.1.2" stretchy="false" xref="S2.SS0.SSS0.Px1.p1.5.m5.3.3.1.2.cmml">{</mo><mrow id="S2.SS0.SSS0.Px1.p1.5.m5.3.3.1.1.1" xref="S2.SS0.SSS0.Px1.p1.5.m5.3.3.1.1.1.cmml"><mn id="S2.SS0.SSS0.Px1.p1.5.m5.3.3.1.1.1.2" xref="S2.SS0.SSS0.Px1.p1.5.m5.3.3.1.1.1.2.cmml">1</mn><mo id="S2.SS0.SSS0.Px1.p1.5.m5.3.3.1.1.1.1" xref="S2.SS0.SSS0.Px1.p1.5.m5.3.3.1.1.1.1.cmml">⁢</mo><mi id="S2.SS0.SSS0.Px1.p1.5.m5.3.3.1.1.1.3" mathvariant="normal" xref="S2.SS0.SSS0.Px1.p1.5.m5.3.3.1.1.1.3.cmml">…</mi></mrow><mo id="S2.SS0.SSS0.Px1.p1.5.m5.3.3.1.1.3" xref="S2.SS0.SSS0.Px1.p1.5.m5.3.3.1.2.cmml">,</mo><mi id="S2.SS0.SSS0.Px1.p1.5.m5.2.2" xref="S2.SS0.SSS0.Px1.p1.5.m5.2.2.cmml">k</mi><mo id="S2.SS0.SSS0.Px1.p1.5.m5.3.3.1.1.4" stretchy="false" xref="S2.SS0.SSS0.Px1.p1.5.m5.3.3.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p1.5.m5.3b"><apply id="S2.SS0.SSS0.Px1.p1.5.m5.3.3.cmml" xref="S2.SS0.SSS0.Px1.p1.5.m5.3.3"><and id="S2.SS0.SSS0.Px1.p1.5.m5.3.3a.cmml" xref="S2.SS0.SSS0.Px1.p1.5.m5.3.3"></and><apply id="S2.SS0.SSS0.Px1.p1.5.m5.3.3b.cmml" xref="S2.SS0.SSS0.Px1.p1.5.m5.3.3"><eq id="S2.SS0.SSS0.Px1.p1.5.m5.3.3.4.cmml" xref="S2.SS0.SSS0.Px1.p1.5.m5.3.3.4"></eq><ci id="S2.SS0.SSS0.Px1.p1.5.m5.3.3.3.cmml" xref="S2.SS0.SSS0.Px1.p1.5.m5.3.3.3">𝒴</ci><apply id="S2.SS0.SSS0.Px1.p1.5.m5.3.3.5.1.cmml" xref="S2.SS0.SSS0.Px1.p1.5.m5.3.3.5.2"><csymbol cd="latexml" id="S2.SS0.SSS0.Px1.p1.5.m5.3.3.5.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.5.m5.3.3.5.2.1">delimited-[]</csymbol><ci id="S2.SS0.SSS0.Px1.p1.5.m5.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.5.m5.1.1">𝑘</ci></apply></apply><apply id="S2.SS0.SSS0.Px1.p1.5.m5.3.3c.cmml" xref="S2.SS0.SSS0.Px1.p1.5.m5.3.3"><csymbol cd="latexml" id="S2.SS0.SSS0.Px1.p1.5.m5.3.3.6.cmml" xref="S2.SS0.SSS0.Px1.p1.5.m5.3.3.6">assign</csymbol><share href="https://arxiv.org/html/2410.03052v1#S2.SS0.SSS0.Px1.p1.5.m5.3.3.5.cmml" id="S2.SS0.SSS0.Px1.p1.5.m5.3.3d.cmml" xref="S2.SS0.SSS0.Px1.p1.5.m5.3.3"></share><set id="S2.SS0.SSS0.Px1.p1.5.m5.3.3.1.2.cmml" xref="S2.SS0.SSS0.Px1.p1.5.m5.3.3.1.1"><apply id="S2.SS0.SSS0.Px1.p1.5.m5.3.3.1.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.5.m5.3.3.1.1.1"><times id="S2.SS0.SSS0.Px1.p1.5.m5.3.3.1.1.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.5.m5.3.3.1.1.1.1"></times><cn id="S2.SS0.SSS0.Px1.p1.5.m5.3.3.1.1.1.2.cmml" type="integer" xref="S2.SS0.SSS0.Px1.p1.5.m5.3.3.1.1.1.2">1</cn><ci id="S2.SS0.SSS0.Px1.p1.5.m5.3.3.1.1.1.3.cmml" xref="S2.SS0.SSS0.Px1.p1.5.m5.3.3.1.1.1.3">…</ci></apply><ci id="S2.SS0.SSS0.Px1.p1.5.m5.2.2.cmml" xref="S2.SS0.SSS0.Px1.p1.5.m5.2.2">𝑘</ci></set></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p1.5.m5.3c">{\mathcal{Y}}=[k]\vcentcolon=\{1\ldots,k\}</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.p1.5.m5.3d">caligraphic_Y = [ italic_k ] := { 1 … , italic_k }</annotation></semantics></math>. The dataset <math alttext="{\mathcal{D}}" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p1.6.m6.1"><semantics id="S2.SS0.SSS0.Px1.p1.6.m6.1a"><mi class="ltx_font_mathcaligraphic" id="S2.SS0.SSS0.Px1.p1.6.m6.1.1" xref="S2.SS0.SSS0.Px1.p1.6.m6.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p1.6.m6.1b"><ci id="S2.SS0.SSS0.Px1.p1.6.m6.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.6.m6.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p1.6.m6.1c">{\mathcal{D}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.p1.6.m6.1d">caligraphic_D</annotation></semantics></math> consists of <math alttext="N" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p1.7.m7.1"><semantics id="S2.SS0.SSS0.Px1.p1.7.m7.1a"><mi id="S2.SS0.SSS0.Px1.p1.7.m7.1.1" xref="S2.SS0.SSS0.Px1.p1.7.m7.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p1.7.m7.1b"><ci id="S2.SS0.SSS0.Px1.p1.7.m7.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.7.m7.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p1.7.m7.1c">N</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.p1.7.m7.1d">italic_N</annotation></semantics></math> data pairs <math alttext="\{(x_{i},y_{i})\}_{i=1}^{N}" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p1.8.m8.1"><semantics id="S2.SS0.SSS0.Px1.p1.8.m8.1a"><msubsup id="S2.SS0.SSS0.Px1.p1.8.m8.1.1" xref="S2.SS0.SSS0.Px1.p1.8.m8.1.1.cmml"><mrow id="S2.SS0.SSS0.Px1.p1.8.m8.1.1.1.1.1" xref="S2.SS0.SSS0.Px1.p1.8.m8.1.1.1.1.2.cmml"><mo id="S2.SS0.SSS0.Px1.p1.8.m8.1.1.1.1.1.2" stretchy="false" xref="S2.SS0.SSS0.Px1.p1.8.m8.1.1.1.1.2.cmml">{</mo><mrow id="S2.SS0.SSS0.Px1.p1.8.m8.1.1.1.1.1.1.2" xref="S2.SS0.SSS0.Px1.p1.8.m8.1.1.1.1.1.1.3.cmml"><mo id="S2.SS0.SSS0.Px1.p1.8.m8.1.1.1.1.1.1.2.3" stretchy="false" xref="S2.SS0.SSS0.Px1.p1.8.m8.1.1.1.1.1.1.3.cmml">(</mo><msub id="S2.SS0.SSS0.Px1.p1.8.m8.1.1.1.1.1.1.1.1" xref="S2.SS0.SSS0.Px1.p1.8.m8.1.1.1.1.1.1.1.1.cmml"><mi id="S2.SS0.SSS0.Px1.p1.8.m8.1.1.1.1.1.1.1.1.2" xref="S2.SS0.SSS0.Px1.p1.8.m8.1.1.1.1.1.1.1.1.2.cmml">x</mi><mi id="S2.SS0.SSS0.Px1.p1.8.m8.1.1.1.1.1.1.1.1.3" xref="S2.SS0.SSS0.Px1.p1.8.m8.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S2.SS0.SSS0.Px1.p1.8.m8.1.1.1.1.1.1.2.4" xref="S2.SS0.SSS0.Px1.p1.8.m8.1.1.1.1.1.1.3.cmml">,</mo><msub id="S2.SS0.SSS0.Px1.p1.8.m8.1.1.1.1.1.1.2.2" xref="S2.SS0.SSS0.Px1.p1.8.m8.1.1.1.1.1.1.2.2.cmml"><mi id="S2.SS0.SSS0.Px1.p1.8.m8.1.1.1.1.1.1.2.2.2" xref="S2.SS0.SSS0.Px1.p1.8.m8.1.1.1.1.1.1.2.2.2.cmml">y</mi><mi id="S2.SS0.SSS0.Px1.p1.8.m8.1.1.1.1.1.1.2.2.3" xref="S2.SS0.SSS0.Px1.p1.8.m8.1.1.1.1.1.1.2.2.3.cmml">i</mi></msub><mo id="S2.SS0.SSS0.Px1.p1.8.m8.1.1.1.1.1.1.2.5" stretchy="false" xref="S2.SS0.SSS0.Px1.p1.8.m8.1.1.1.1.1.1.3.cmml">)</mo></mrow><mo id="S2.SS0.SSS0.Px1.p1.8.m8.1.1.1.1.1.3" stretchy="false" xref="S2.SS0.SSS0.Px1.p1.8.m8.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S2.SS0.SSS0.Px1.p1.8.m8.1.1.1.3" xref="S2.SS0.SSS0.Px1.p1.8.m8.1.1.1.3.cmml"><mi id="S2.SS0.SSS0.Px1.p1.8.m8.1.1.1.3.2" xref="S2.SS0.SSS0.Px1.p1.8.m8.1.1.1.3.2.cmml">i</mi><mo id="S2.SS0.SSS0.Px1.p1.8.m8.1.1.1.3.1" xref="S2.SS0.SSS0.Px1.p1.8.m8.1.1.1.3.1.cmml">=</mo><mn id="S2.SS0.SSS0.Px1.p1.8.m8.1.1.1.3.3" xref="S2.SS0.SSS0.Px1.p1.8.m8.1.1.1.3.3.cmml">1</mn></mrow><mi id="S2.SS0.SSS0.Px1.p1.8.m8.1.1.3" xref="S2.SS0.SSS0.Px1.p1.8.m8.1.1.3.cmml">N</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p1.8.m8.1b"><apply id="S2.SS0.SSS0.Px1.p1.8.m8.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p1.8.m8.1.1.2.cmml" xref="S2.SS0.SSS0.Px1.p1.8.m8.1.1">superscript</csymbol><apply id="S2.SS0.SSS0.Px1.p1.8.m8.1.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p1.8.m8.1.1.1.2.cmml" xref="S2.SS0.SSS0.Px1.p1.8.m8.1.1">subscript</csymbol><set id="S2.SS0.SSS0.Px1.p1.8.m8.1.1.1.1.2.cmml" xref="S2.SS0.SSS0.Px1.p1.8.m8.1.1.1.1.1"><interval closure="open" id="S2.SS0.SSS0.Px1.p1.8.m8.1.1.1.1.1.1.3.cmml" xref="S2.SS0.SSS0.Px1.p1.8.m8.1.1.1.1.1.1.2"><apply id="S2.SS0.SSS0.Px1.p1.8.m8.1.1.1.1.1.1.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.8.m8.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p1.8.m8.1.1.1.1.1.1.1.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.8.m8.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.p1.8.m8.1.1.1.1.1.1.1.1.2.cmml" xref="S2.SS0.SSS0.Px1.p1.8.m8.1.1.1.1.1.1.1.1.2">𝑥</ci><ci id="S2.SS0.SSS0.Px1.p1.8.m8.1.1.1.1.1.1.1.1.3.cmml" xref="S2.SS0.SSS0.Px1.p1.8.m8.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S2.SS0.SSS0.Px1.p1.8.m8.1.1.1.1.1.1.2.2.cmml" xref="S2.SS0.SSS0.Px1.p1.8.m8.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p1.8.m8.1.1.1.1.1.1.2.2.1.cmml" xref="S2.SS0.SSS0.Px1.p1.8.m8.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.p1.8.m8.1.1.1.1.1.1.2.2.2.cmml" xref="S2.SS0.SSS0.Px1.p1.8.m8.1.1.1.1.1.1.2.2.2">𝑦</ci><ci id="S2.SS0.SSS0.Px1.p1.8.m8.1.1.1.1.1.1.2.2.3.cmml" xref="S2.SS0.SSS0.Px1.p1.8.m8.1.1.1.1.1.1.2.2.3">𝑖</ci></apply></interval></set><apply id="S2.SS0.SSS0.Px1.p1.8.m8.1.1.1.3.cmml" xref="S2.SS0.SSS0.Px1.p1.8.m8.1.1.1.3"><eq id="S2.SS0.SSS0.Px1.p1.8.m8.1.1.1.3.1.cmml" xref="S2.SS0.SSS0.Px1.p1.8.m8.1.1.1.3.1"></eq><ci id="S2.SS0.SSS0.Px1.p1.8.m8.1.1.1.3.2.cmml" xref="S2.SS0.SSS0.Px1.p1.8.m8.1.1.1.3.2">𝑖</ci><cn id="S2.SS0.SSS0.Px1.p1.8.m8.1.1.1.3.3.cmml" type="integer" xref="S2.SS0.SSS0.Px1.p1.8.m8.1.1.1.3.3">1</cn></apply></apply><ci id="S2.SS0.SSS0.Px1.p1.8.m8.1.1.3.cmml" xref="S2.SS0.SSS0.Px1.p1.8.m8.1.1.3">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p1.8.m8.1c">\{(x_{i},y_{i})\}_{i=1}^{N}</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.p1.8.m8.1d">{ ( italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) } start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S2.SS0.SSS0.Px1.p2">
<p class="ltx_p" id="S2.SS0.SSS0.Px1.p2.15">Given the label space <math alttext="{\mathcal{Y}}" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p2.1.m1.1"><semantics id="S2.SS0.SSS0.Px1.p2.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S2.SS0.SSS0.Px1.p2.1.m1.1.1" xref="S2.SS0.SSS0.Px1.p2.1.m1.1.1.cmml">𝒴</mi><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p2.1.m1.1b"><ci id="S2.SS0.SSS0.Px1.p2.1.m1.1.1.cmml" xref="S2.SS0.SSS0.Px1.p2.1.m1.1.1">𝒴</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p2.1.m1.1c">{\mathcal{Y}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.p2.1.m1.1d">caligraphic_Y</annotation></semantics></math>, we have a corresponding <span class="ltx_text ltx_font_italic" id="S2.SS0.SSS0.Px1.p2.15.1">label tree</span> <math alttext="{\mathcal{T}}" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p2.2.m2.1"><semantics id="S2.SS0.SSS0.Px1.p2.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S2.SS0.SSS0.Px1.p2.2.m2.1.1" xref="S2.SS0.SSS0.Px1.p2.2.m2.1.1.cmml">𝒯</mi><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p2.2.m2.1b"><ci id="S2.SS0.SSS0.Px1.p2.2.m2.1.1.cmml" xref="S2.SS0.SSS0.Px1.p2.2.m2.1.1">𝒯</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p2.2.m2.1c">{\mathcal{T}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.p2.2.m2.1d">caligraphic_T</annotation></semantics></math> that characterizes the relationship between different subsets of <math alttext="{\mathcal{Y}}" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p2.3.m3.1"><semantics id="S2.SS0.SSS0.Px1.p2.3.m3.1a"><mi class="ltx_font_mathcaligraphic" id="S2.SS0.SSS0.Px1.p2.3.m3.1.1" xref="S2.SS0.SSS0.Px1.p2.3.m3.1.1.cmml">𝒴</mi><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p2.3.m3.1b"><ci id="S2.SS0.SSS0.Px1.p2.3.m3.1.1.cmml" xref="S2.SS0.SSS0.Px1.p2.3.m3.1.1">𝒴</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p2.3.m3.1c">{\mathcal{Y}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.p2.3.m3.1d">caligraphic_Y</annotation></semantics></math>. In particular, each node of <math alttext="{\mathcal{T}}" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p2.4.m4.1"><semantics id="S2.SS0.SSS0.Px1.p2.4.m4.1a"><mi class="ltx_font_mathcaligraphic" id="S2.SS0.SSS0.Px1.p2.4.m4.1.1" xref="S2.SS0.SSS0.Px1.p2.4.m4.1.1.cmml">𝒯</mi><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p2.4.m4.1b"><ci id="S2.SS0.SSS0.Px1.p2.4.m4.1.1.cmml" xref="S2.SS0.SSS0.Px1.p2.4.m4.1.1">𝒯</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p2.4.m4.1c">{\mathcal{T}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.p2.4.m4.1d">caligraphic_T</annotation></semantics></math> is associated with a subset of <math alttext="{\mathcal{Y}}" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p2.5.m5.1"><semantics id="S2.SS0.SSS0.Px1.p2.5.m5.1a"><mi class="ltx_font_mathcaligraphic" id="S2.SS0.SSS0.Px1.p2.5.m5.1.1" xref="S2.SS0.SSS0.Px1.p2.5.m5.1.1.cmml">𝒴</mi><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p2.5.m5.1b"><ci id="S2.SS0.SSS0.Px1.p2.5.m5.1.1.cmml" xref="S2.SS0.SSS0.Px1.p2.5.m5.1.1">𝒴</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p2.5.m5.1c">{\mathcal{Y}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.p2.5.m5.1d">caligraphic_Y</annotation></semantics></math>: each leaf node <math alttext="v" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p2.6.m6.1"><semantics id="S2.SS0.SSS0.Px1.p2.6.m6.1a"><mi id="S2.SS0.SSS0.Px1.p2.6.m6.1.1" xref="S2.SS0.SSS0.Px1.p2.6.m6.1.1.cmml">v</mi><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p2.6.m6.1b"><ci id="S2.SS0.SSS0.Px1.p2.6.m6.1.1.cmml" xref="S2.SS0.SSS0.Px1.p2.6.m6.1.1">𝑣</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p2.6.m6.1c">v</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.p2.6.m6.1d">italic_v</annotation></semantics></math> is associated with a particular class in <math alttext="{\mathcal{Y}}" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p2.7.m7.1"><semantics id="S2.SS0.SSS0.Px1.p2.7.m7.1a"><mi class="ltx_font_mathcaligraphic" id="S2.SS0.SSS0.Px1.p2.7.m7.1.1" xref="S2.SS0.SSS0.Px1.p2.7.m7.1.1.cmml">𝒴</mi><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p2.7.m7.1b"><ci id="S2.SS0.SSS0.Px1.p2.7.m7.1.1.cmml" xref="S2.SS0.SSS0.Px1.p2.7.m7.1.1">𝒴</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p2.7.m7.1c">{\mathcal{Y}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.p2.7.m7.1d">caligraphic_Y</annotation></semantics></math>; any internal node corresponds to the subset that is the union of its leaf children classes; the root node of <math alttext="{\mathcal{T}}" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p2.8.m8.1"><semantics id="S2.SS0.SSS0.Px1.p2.8.m8.1a"><mi class="ltx_font_mathcaligraphic" id="S2.SS0.SSS0.Px1.p2.8.m8.1.1" xref="S2.SS0.SSS0.Px1.p2.8.m8.1.1.cmml">𝒯</mi><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p2.8.m8.1b"><ci id="S2.SS0.SSS0.Px1.p2.8.m8.1.1.cmml" xref="S2.SS0.SSS0.Px1.p2.8.m8.1.1">𝒯</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p2.8.m8.1c">{\mathcal{T}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.p2.8.m8.1d">caligraphic_T</annotation></semantics></math> corresponds to the full <math alttext="{\mathcal{Y}}" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p2.9.m9.1"><semantics id="S2.SS0.SSS0.Px1.p2.9.m9.1a"><mi class="ltx_font_mathcaligraphic" id="S2.SS0.SSS0.Px1.p2.9.m9.1.1" xref="S2.SS0.SSS0.Px1.p2.9.m9.1.1.cmml">𝒴</mi><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p2.9.m9.1b"><ci id="S2.SS0.SSS0.Px1.p2.9.m9.1.1.cmml" xref="S2.SS0.SSS0.Px1.p2.9.m9.1.1">𝒴</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p2.9.m9.1c">{\mathcal{Y}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.p2.9.m9.1d">caligraphic_Y</annotation></semantics></math>. The metric function of <math alttext="{\mathcal{Y}}" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p2.10.m10.1"><semantics id="S2.SS0.SSS0.Px1.p2.10.m10.1a"><mi class="ltx_font_mathcaligraphic" id="S2.SS0.SSS0.Px1.p2.10.m10.1.1" xref="S2.SS0.SSS0.Px1.p2.10.m10.1.1.cmml">𝒴</mi><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p2.10.m10.1b"><ci id="S2.SS0.SSS0.Px1.p2.10.m10.1.1.cmml" xref="S2.SS0.SSS0.Px1.p2.10.m10.1.1">𝒴</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p2.10.m10.1c">{\mathcal{Y}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.p2.10.m10.1d">caligraphic_Y</annotation></semantics></math> is called <em class="ltx_emph ltx_font_italic" id="S2.SS0.SSS0.Px1.p2.15.2">tree metric</em> <math alttext="t:{\mathcal{Y}}\times{\mathcal{Y}}\rightarrow\mathbb{R}_{+}" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p2.11.m11.1"><semantics id="S2.SS0.SSS0.Px1.p2.11.m11.1a"><mrow id="S2.SS0.SSS0.Px1.p2.11.m11.1.1" xref="S2.SS0.SSS0.Px1.p2.11.m11.1.1.cmml"><mi id="S2.SS0.SSS0.Px1.p2.11.m11.1.1.2" xref="S2.SS0.SSS0.Px1.p2.11.m11.1.1.2.cmml">t</mi><mo id="S2.SS0.SSS0.Px1.p2.11.m11.1.1.1" lspace="0.278em" rspace="0.278em" xref="S2.SS0.SSS0.Px1.p2.11.m11.1.1.1.cmml">:</mo><mrow id="S2.SS0.SSS0.Px1.p2.11.m11.1.1.3" xref="S2.SS0.SSS0.Px1.p2.11.m11.1.1.3.cmml"><mrow id="S2.SS0.SSS0.Px1.p2.11.m11.1.1.3.2" xref="S2.SS0.SSS0.Px1.p2.11.m11.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS0.SSS0.Px1.p2.11.m11.1.1.3.2.2" xref="S2.SS0.SSS0.Px1.p2.11.m11.1.1.3.2.2.cmml">𝒴</mi><mo id="S2.SS0.SSS0.Px1.p2.11.m11.1.1.3.2.1" lspace="0.222em" rspace="0.222em" xref="S2.SS0.SSS0.Px1.p2.11.m11.1.1.3.2.1.cmml">×</mo><mi class="ltx_font_mathcaligraphic" id="S2.SS0.SSS0.Px1.p2.11.m11.1.1.3.2.3" xref="S2.SS0.SSS0.Px1.p2.11.m11.1.1.3.2.3.cmml">𝒴</mi></mrow><mo id="S2.SS0.SSS0.Px1.p2.11.m11.1.1.3.1" stretchy="false" xref="S2.SS0.SSS0.Px1.p2.11.m11.1.1.3.1.cmml">→</mo><msub id="S2.SS0.SSS0.Px1.p2.11.m11.1.1.3.3" xref="S2.SS0.SSS0.Px1.p2.11.m11.1.1.3.3.cmml"><mi id="S2.SS0.SSS0.Px1.p2.11.m11.1.1.3.3.2" xref="S2.SS0.SSS0.Px1.p2.11.m11.1.1.3.3.2.cmml">ℝ</mi><mo id="S2.SS0.SSS0.Px1.p2.11.m11.1.1.3.3.3" xref="S2.SS0.SSS0.Px1.p2.11.m11.1.1.3.3.3.cmml">+</mo></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p2.11.m11.1b"><apply id="S2.SS0.SSS0.Px1.p2.11.m11.1.1.cmml" xref="S2.SS0.SSS0.Px1.p2.11.m11.1.1"><ci id="S2.SS0.SSS0.Px1.p2.11.m11.1.1.1.cmml" xref="S2.SS0.SSS0.Px1.p2.11.m11.1.1.1">:</ci><ci id="S2.SS0.SSS0.Px1.p2.11.m11.1.1.2.cmml" xref="S2.SS0.SSS0.Px1.p2.11.m11.1.1.2">𝑡</ci><apply id="S2.SS0.SSS0.Px1.p2.11.m11.1.1.3.cmml" xref="S2.SS0.SSS0.Px1.p2.11.m11.1.1.3"><ci id="S2.SS0.SSS0.Px1.p2.11.m11.1.1.3.1.cmml" xref="S2.SS0.SSS0.Px1.p2.11.m11.1.1.3.1">→</ci><apply id="S2.SS0.SSS0.Px1.p2.11.m11.1.1.3.2.cmml" xref="S2.SS0.SSS0.Px1.p2.11.m11.1.1.3.2"><times id="S2.SS0.SSS0.Px1.p2.11.m11.1.1.3.2.1.cmml" xref="S2.SS0.SSS0.Px1.p2.11.m11.1.1.3.2.1"></times><ci id="S2.SS0.SSS0.Px1.p2.11.m11.1.1.3.2.2.cmml" xref="S2.SS0.SSS0.Px1.p2.11.m11.1.1.3.2.2">𝒴</ci><ci id="S2.SS0.SSS0.Px1.p2.11.m11.1.1.3.2.3.cmml" xref="S2.SS0.SSS0.Px1.p2.11.m11.1.1.3.2.3">𝒴</ci></apply><apply id="S2.SS0.SSS0.Px1.p2.11.m11.1.1.3.3.cmml" xref="S2.SS0.SSS0.Px1.p2.11.m11.1.1.3.3"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p2.11.m11.1.1.3.3.1.cmml" xref="S2.SS0.SSS0.Px1.p2.11.m11.1.1.3.3">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.p2.11.m11.1.1.3.3.2.cmml" xref="S2.SS0.SSS0.Px1.p2.11.m11.1.1.3.3.2">ℝ</ci><plus id="S2.SS0.SSS0.Px1.p2.11.m11.1.1.3.3.3.cmml" xref="S2.SS0.SSS0.Px1.p2.11.m11.1.1.3.3.3"></plus></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p2.11.m11.1c">t:{\mathcal{Y}}\times{\mathcal{Y}}\rightarrow\mathbb{R}_{+}</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.p2.11.m11.1d">italic_t : caligraphic_Y × caligraphic_Y → blackboard_R start_POSTSUBSCRIPT + end_POSTSUBSCRIPT</annotation></semantics></math> which measures the similarity of two class labels <math alttext="u,v" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p2.12.m12.2"><semantics id="S2.SS0.SSS0.Px1.p2.12.m12.2a"><mrow id="S2.SS0.SSS0.Px1.p2.12.m12.2.3.2" xref="S2.SS0.SSS0.Px1.p2.12.m12.2.3.1.cmml"><mi id="S2.SS0.SSS0.Px1.p2.12.m12.1.1" xref="S2.SS0.SSS0.Px1.p2.12.m12.1.1.cmml">u</mi><mo id="S2.SS0.SSS0.Px1.p2.12.m12.2.3.2.1" xref="S2.SS0.SSS0.Px1.p2.12.m12.2.3.1.cmml">,</mo><mi id="S2.SS0.SSS0.Px1.p2.12.m12.2.2" xref="S2.SS0.SSS0.Px1.p2.12.m12.2.2.cmml">v</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p2.12.m12.2b"><list id="S2.SS0.SSS0.Px1.p2.12.m12.2.3.1.cmml" xref="S2.SS0.SSS0.Px1.p2.12.m12.2.3.2"><ci id="S2.SS0.SSS0.Px1.p2.12.m12.1.1.cmml" xref="S2.SS0.SSS0.Px1.p2.12.m12.1.1">𝑢</ci><ci id="S2.SS0.SSS0.Px1.p2.12.m12.2.2.cmml" xref="S2.SS0.SSS0.Px1.p2.12.m12.2.2">𝑣</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p2.12.m12.2c">u,v</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.p2.12.m12.2d">italic_u , italic_v</annotation></semantics></math> based on the shortest path distance of two <em class="ltx_emph ltx_font_italic" id="S2.SS0.SSS0.Px1.p2.15.3">leaf nodes</em> on <math alttext="{\mathcal{T}}" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p2.13.m13.1"><semantics id="S2.SS0.SSS0.Px1.p2.13.m13.1a"><mi class="ltx_font_mathcaligraphic" id="S2.SS0.SSS0.Px1.p2.13.m13.1.1" xref="S2.SS0.SSS0.Px1.p2.13.m13.1.1.cmml">𝒯</mi><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p2.13.m13.1b"><ci id="S2.SS0.SSS0.Px1.p2.13.m13.1.1.cmml" xref="S2.SS0.SSS0.Px1.p2.13.m13.1.1">𝒯</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p2.13.m13.1c">{\mathcal{T}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.p2.13.m13.1d">caligraphic_T</annotation></semantics></math>. Intuitively, the tree <math alttext="{\mathcal{T}}" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p2.14.m14.1"><semantics id="S2.SS0.SSS0.Px1.p2.14.m14.1a"><mi class="ltx_font_mathcaligraphic" id="S2.SS0.SSS0.Px1.p2.14.m14.1.1" xref="S2.SS0.SSS0.Px1.p2.14.m14.1.1.cmml">𝒯</mi><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p2.14.m14.1b"><ci id="S2.SS0.SSS0.Px1.p2.14.m14.1.1.cmml" xref="S2.SS0.SSS0.Px1.p2.14.m14.1.1">𝒯</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p2.14.m14.1c">{\mathcal{T}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.p2.14.m14.1d">caligraphic_T</annotation></semantics></math> could be understood as a dendrogram of <math alttext="{\mathcal{Y}}" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p2.15.m15.1"><semantics id="S2.SS0.SSS0.Px1.p2.15.m15.1a"><mi class="ltx_font_mathcaligraphic" id="S2.SS0.SSS0.Px1.p2.15.m15.1.1" xref="S2.SS0.SSS0.Px1.p2.15.m15.1.1.cmml">𝒴</mi><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p2.15.m15.1b"><ci id="S2.SS0.SSS0.Px1.p2.15.m15.1.1.cmml" xref="S2.SS0.SSS0.Px1.p2.15.m15.1.1">𝒴</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p2.15.m15.1c">{\mathcal{Y}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.p2.15.m15.1d">caligraphic_Y</annotation></semantics></math> that characterizes the similarity of different classes.</p>
</div>
<div class="ltx_para" id="S2.SS0.SSS0.Px1.p3">
<p class="ltx_p" id="S2.SS0.SSS0.Px1.p3.15">Let <math alttext="{\mathcal{Z}}\subseteq\mathbb{R}^{d}" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p3.1.m1.1"><semantics id="S2.SS0.SSS0.Px1.p3.1.m1.1a"><mrow id="S2.SS0.SSS0.Px1.p3.1.m1.1.1" xref="S2.SS0.SSS0.Px1.p3.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS0.SSS0.Px1.p3.1.m1.1.1.2" xref="S2.SS0.SSS0.Px1.p3.1.m1.1.1.2.cmml">𝒵</mi><mo id="S2.SS0.SSS0.Px1.p3.1.m1.1.1.1" xref="S2.SS0.SSS0.Px1.p3.1.m1.1.1.1.cmml">⊆</mo><msup id="S2.SS0.SSS0.Px1.p3.1.m1.1.1.3" xref="S2.SS0.SSS0.Px1.p3.1.m1.1.1.3.cmml"><mi id="S2.SS0.SSS0.Px1.p3.1.m1.1.1.3.2" xref="S2.SS0.SSS0.Px1.p3.1.m1.1.1.3.2.cmml">ℝ</mi><mi id="S2.SS0.SSS0.Px1.p3.1.m1.1.1.3.3" xref="S2.SS0.SSS0.Px1.p3.1.m1.1.1.3.3.cmml">d</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p3.1.m1.1b"><apply id="S2.SS0.SSS0.Px1.p3.1.m1.1.1.cmml" xref="S2.SS0.SSS0.Px1.p3.1.m1.1.1"><subset id="S2.SS0.SSS0.Px1.p3.1.m1.1.1.1.cmml" xref="S2.SS0.SSS0.Px1.p3.1.m1.1.1.1"></subset><ci id="S2.SS0.SSS0.Px1.p3.1.m1.1.1.2.cmml" xref="S2.SS0.SSS0.Px1.p3.1.m1.1.1.2">𝒵</ci><apply id="S2.SS0.SSS0.Px1.p3.1.m1.1.1.3.cmml" xref="S2.SS0.SSS0.Px1.p3.1.m1.1.1.3"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p3.1.m1.1.1.3.1.cmml" xref="S2.SS0.SSS0.Px1.p3.1.m1.1.1.3">superscript</csymbol><ci id="S2.SS0.SSS0.Px1.p3.1.m1.1.1.3.2.cmml" xref="S2.SS0.SSS0.Px1.p3.1.m1.1.1.3.2">ℝ</ci><ci id="S2.SS0.SSS0.Px1.p3.1.m1.1.1.3.3.cmml" xref="S2.SS0.SSS0.Px1.p3.1.m1.1.1.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p3.1.m1.1c">{\mathcal{Z}}\subseteq\mathbb{R}^{d}</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.p3.1.m1.1d">caligraphic_Z ⊆ blackboard_R start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT</annotation></semantics></math> be the representation/feature space. A deep network <math alttext="h" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p3.2.m2.1"><semantics id="S2.SS0.SSS0.Px1.p3.2.m2.1a"><mi id="S2.SS0.SSS0.Px1.p3.2.m2.1.1" xref="S2.SS0.SSS0.Px1.p3.2.m2.1.1.cmml">h</mi><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p3.2.m2.1b"><ci id="S2.SS0.SSS0.Px1.p3.2.m2.1.1.cmml" xref="S2.SS0.SSS0.Px1.p3.2.m2.1.1">ℎ</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p3.2.m2.1c">h</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.p3.2.m2.1d">italic_h</annotation></semantics></math> is the composition of two functions <math alttext="h_{w,\theta}=g_{w}\circ f_{\theta}:{\mathcal{X}}\rightarrow\Delta_{k}" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p3.3.m3.2"><semantics id="S2.SS0.SSS0.Px1.p3.3.m3.2a"><mrow id="S2.SS0.SSS0.Px1.p3.3.m3.2.3" xref="S2.SS0.SSS0.Px1.p3.3.m3.2.3.cmml"><mrow id="S2.SS0.SSS0.Px1.p3.3.m3.2.3.2" xref="S2.SS0.SSS0.Px1.p3.3.m3.2.3.2.cmml"><msub id="S2.SS0.SSS0.Px1.p3.3.m3.2.3.2.2" xref="S2.SS0.SSS0.Px1.p3.3.m3.2.3.2.2.cmml"><mi id="S2.SS0.SSS0.Px1.p3.3.m3.2.3.2.2.2" xref="S2.SS0.SSS0.Px1.p3.3.m3.2.3.2.2.2.cmml">h</mi><mrow id="S2.SS0.SSS0.Px1.p3.3.m3.2.2.2.4" xref="S2.SS0.SSS0.Px1.p3.3.m3.2.2.2.3.cmml"><mi id="S2.SS0.SSS0.Px1.p3.3.m3.1.1.1.1" xref="S2.SS0.SSS0.Px1.p3.3.m3.1.1.1.1.cmml">w</mi><mo id="S2.SS0.SSS0.Px1.p3.3.m3.2.2.2.4.1" xref="S2.SS0.SSS0.Px1.p3.3.m3.2.2.2.3.cmml">,</mo><mi id="S2.SS0.SSS0.Px1.p3.3.m3.2.2.2.2" xref="S2.SS0.SSS0.Px1.p3.3.m3.2.2.2.2.cmml">θ</mi></mrow></msub><mo id="S2.SS0.SSS0.Px1.p3.3.m3.2.3.2.1" xref="S2.SS0.SSS0.Px1.p3.3.m3.2.3.2.1.cmml">=</mo><mrow id="S2.SS0.SSS0.Px1.p3.3.m3.2.3.2.3" xref="S2.SS0.SSS0.Px1.p3.3.m3.2.3.2.3.cmml"><msub id="S2.SS0.SSS0.Px1.p3.3.m3.2.3.2.3.2" xref="S2.SS0.SSS0.Px1.p3.3.m3.2.3.2.3.2.cmml"><mi id="S2.SS0.SSS0.Px1.p3.3.m3.2.3.2.3.2.2" xref="S2.SS0.SSS0.Px1.p3.3.m3.2.3.2.3.2.2.cmml">g</mi><mi id="S2.SS0.SSS0.Px1.p3.3.m3.2.3.2.3.2.3" xref="S2.SS0.SSS0.Px1.p3.3.m3.2.3.2.3.2.3.cmml">w</mi></msub><mo id="S2.SS0.SSS0.Px1.p3.3.m3.2.3.2.3.1" lspace="0.222em" rspace="0.222em" xref="S2.SS0.SSS0.Px1.p3.3.m3.2.3.2.3.1.cmml">∘</mo><msub id="S2.SS0.SSS0.Px1.p3.3.m3.2.3.2.3.3" xref="S2.SS0.SSS0.Px1.p3.3.m3.2.3.2.3.3.cmml"><mi id="S2.SS0.SSS0.Px1.p3.3.m3.2.3.2.3.3.2" xref="S2.SS0.SSS0.Px1.p3.3.m3.2.3.2.3.3.2.cmml">f</mi><mi id="S2.SS0.SSS0.Px1.p3.3.m3.2.3.2.3.3.3" xref="S2.SS0.SSS0.Px1.p3.3.m3.2.3.2.3.3.3.cmml">θ</mi></msub></mrow></mrow><mo id="S2.SS0.SSS0.Px1.p3.3.m3.2.3.1" lspace="0.278em" rspace="0.278em" xref="S2.SS0.SSS0.Px1.p3.3.m3.2.3.1.cmml">:</mo><mrow id="S2.SS0.SSS0.Px1.p3.3.m3.2.3.3" xref="S2.SS0.SSS0.Px1.p3.3.m3.2.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS0.SSS0.Px1.p3.3.m3.2.3.3.2" xref="S2.SS0.SSS0.Px1.p3.3.m3.2.3.3.2.cmml">𝒳</mi><mo id="S2.SS0.SSS0.Px1.p3.3.m3.2.3.3.1" stretchy="false" xref="S2.SS0.SSS0.Px1.p3.3.m3.2.3.3.1.cmml">→</mo><msub id="S2.SS0.SSS0.Px1.p3.3.m3.2.3.3.3" xref="S2.SS0.SSS0.Px1.p3.3.m3.2.3.3.3.cmml"><mi id="S2.SS0.SSS0.Px1.p3.3.m3.2.3.3.3.2" mathvariant="normal" xref="S2.SS0.SSS0.Px1.p3.3.m3.2.3.3.3.2.cmml">Δ</mi><mi id="S2.SS0.SSS0.Px1.p3.3.m3.2.3.3.3.3" xref="S2.SS0.SSS0.Px1.p3.3.m3.2.3.3.3.3.cmml">k</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p3.3.m3.2b"><apply id="S2.SS0.SSS0.Px1.p3.3.m3.2.3.cmml" xref="S2.SS0.SSS0.Px1.p3.3.m3.2.3"><ci id="S2.SS0.SSS0.Px1.p3.3.m3.2.3.1.cmml" xref="S2.SS0.SSS0.Px1.p3.3.m3.2.3.1">:</ci><apply id="S2.SS0.SSS0.Px1.p3.3.m3.2.3.2.cmml" xref="S2.SS0.SSS0.Px1.p3.3.m3.2.3.2"><eq id="S2.SS0.SSS0.Px1.p3.3.m3.2.3.2.1.cmml" xref="S2.SS0.SSS0.Px1.p3.3.m3.2.3.2.1"></eq><apply id="S2.SS0.SSS0.Px1.p3.3.m3.2.3.2.2.cmml" xref="S2.SS0.SSS0.Px1.p3.3.m3.2.3.2.2"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p3.3.m3.2.3.2.2.1.cmml" xref="S2.SS0.SSS0.Px1.p3.3.m3.2.3.2.2">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.p3.3.m3.2.3.2.2.2.cmml" xref="S2.SS0.SSS0.Px1.p3.3.m3.2.3.2.2.2">ℎ</ci><list id="S2.SS0.SSS0.Px1.p3.3.m3.2.2.2.3.cmml" xref="S2.SS0.SSS0.Px1.p3.3.m3.2.2.2.4"><ci id="S2.SS0.SSS0.Px1.p3.3.m3.1.1.1.1.cmml" xref="S2.SS0.SSS0.Px1.p3.3.m3.1.1.1.1">𝑤</ci><ci id="S2.SS0.SSS0.Px1.p3.3.m3.2.2.2.2.cmml" xref="S2.SS0.SSS0.Px1.p3.3.m3.2.2.2.2">𝜃</ci></list></apply><apply id="S2.SS0.SSS0.Px1.p3.3.m3.2.3.2.3.cmml" xref="S2.SS0.SSS0.Px1.p3.3.m3.2.3.2.3"><compose id="S2.SS0.SSS0.Px1.p3.3.m3.2.3.2.3.1.cmml" xref="S2.SS0.SSS0.Px1.p3.3.m3.2.3.2.3.1"></compose><apply id="S2.SS0.SSS0.Px1.p3.3.m3.2.3.2.3.2.cmml" xref="S2.SS0.SSS0.Px1.p3.3.m3.2.3.2.3.2"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p3.3.m3.2.3.2.3.2.1.cmml" xref="S2.SS0.SSS0.Px1.p3.3.m3.2.3.2.3.2">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.p3.3.m3.2.3.2.3.2.2.cmml" xref="S2.SS0.SSS0.Px1.p3.3.m3.2.3.2.3.2.2">𝑔</ci><ci id="S2.SS0.SSS0.Px1.p3.3.m3.2.3.2.3.2.3.cmml" xref="S2.SS0.SSS0.Px1.p3.3.m3.2.3.2.3.2.3">𝑤</ci></apply><apply id="S2.SS0.SSS0.Px1.p3.3.m3.2.3.2.3.3.cmml" xref="S2.SS0.SSS0.Px1.p3.3.m3.2.3.2.3.3"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p3.3.m3.2.3.2.3.3.1.cmml" xref="S2.SS0.SSS0.Px1.p3.3.m3.2.3.2.3.3">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.p3.3.m3.2.3.2.3.3.2.cmml" xref="S2.SS0.SSS0.Px1.p3.3.m3.2.3.2.3.3.2">𝑓</ci><ci id="S2.SS0.SSS0.Px1.p3.3.m3.2.3.2.3.3.3.cmml" xref="S2.SS0.SSS0.Px1.p3.3.m3.2.3.2.3.3.3">𝜃</ci></apply></apply></apply><apply id="S2.SS0.SSS0.Px1.p3.3.m3.2.3.3.cmml" xref="S2.SS0.SSS0.Px1.p3.3.m3.2.3.3"><ci id="S2.SS0.SSS0.Px1.p3.3.m3.2.3.3.1.cmml" xref="S2.SS0.SSS0.Px1.p3.3.m3.2.3.3.1">→</ci><ci id="S2.SS0.SSS0.Px1.p3.3.m3.2.3.3.2.cmml" xref="S2.SS0.SSS0.Px1.p3.3.m3.2.3.3.2">𝒳</ci><apply id="S2.SS0.SSS0.Px1.p3.3.m3.2.3.3.3.cmml" xref="S2.SS0.SSS0.Px1.p3.3.m3.2.3.3.3"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p3.3.m3.2.3.3.3.1.cmml" xref="S2.SS0.SSS0.Px1.p3.3.m3.2.3.3.3">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.p3.3.m3.2.3.3.3.2.cmml" xref="S2.SS0.SSS0.Px1.p3.3.m3.2.3.3.3.2">Δ</ci><ci id="S2.SS0.SSS0.Px1.p3.3.m3.2.3.3.3.3.cmml" xref="S2.SS0.SSS0.Px1.p3.3.m3.2.3.3.3.3">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p3.3.m3.2c">h_{w,\theta}=g_{w}\circ f_{\theta}:{\mathcal{X}}\rightarrow\Delta_{k}</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.p3.3.m3.2d">italic_h start_POSTSUBSCRIPT italic_w , italic_θ end_POSTSUBSCRIPT = italic_g start_POSTSUBSCRIPT italic_w end_POSTSUBSCRIPT ∘ italic_f start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT : caligraphic_X → roman_Δ start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> where <math alttext="\Delta_{k}" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p3.4.m4.1"><semantics id="S2.SS0.SSS0.Px1.p3.4.m4.1a"><msub id="S2.SS0.SSS0.Px1.p3.4.m4.1.1" xref="S2.SS0.SSS0.Px1.p3.4.m4.1.1.cmml"><mi id="S2.SS0.SSS0.Px1.p3.4.m4.1.1.2" mathvariant="normal" xref="S2.SS0.SSS0.Px1.p3.4.m4.1.1.2.cmml">Δ</mi><mi id="S2.SS0.SSS0.Px1.p3.4.m4.1.1.3" xref="S2.SS0.SSS0.Px1.p3.4.m4.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p3.4.m4.1b"><apply id="S2.SS0.SSS0.Px1.p3.4.m4.1.1.cmml" xref="S2.SS0.SSS0.Px1.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p3.4.m4.1.1.1.cmml" xref="S2.SS0.SSS0.Px1.p3.4.m4.1.1">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.p3.4.m4.1.1.2.cmml" xref="S2.SS0.SSS0.Px1.p3.4.m4.1.1.2">Δ</ci><ci id="S2.SS0.SSS0.Px1.p3.4.m4.1.1.3.cmml" xref="S2.SS0.SSS0.Px1.p3.4.m4.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p3.4.m4.1c">\Delta_{k}</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.p3.4.m4.1d">roman_Δ start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> is a <math alttext="k-1" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p3.5.m5.1"><semantics id="S2.SS0.SSS0.Px1.p3.5.m5.1a"><mrow id="S2.SS0.SSS0.Px1.p3.5.m5.1.1" xref="S2.SS0.SSS0.Px1.p3.5.m5.1.1.cmml"><mi id="S2.SS0.SSS0.Px1.p3.5.m5.1.1.2" xref="S2.SS0.SSS0.Px1.p3.5.m5.1.1.2.cmml">k</mi><mo id="S2.SS0.SSS0.Px1.p3.5.m5.1.1.1" xref="S2.SS0.SSS0.Px1.p3.5.m5.1.1.1.cmml">−</mo><mn id="S2.SS0.SSS0.Px1.p3.5.m5.1.1.3" xref="S2.SS0.SSS0.Px1.p3.5.m5.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p3.5.m5.1b"><apply id="S2.SS0.SSS0.Px1.p3.5.m5.1.1.cmml" xref="S2.SS0.SSS0.Px1.p3.5.m5.1.1"><minus id="S2.SS0.SSS0.Px1.p3.5.m5.1.1.1.cmml" xref="S2.SS0.SSS0.Px1.p3.5.m5.1.1.1"></minus><ci id="S2.SS0.SSS0.Px1.p3.5.m5.1.1.2.cmml" xref="S2.SS0.SSS0.Px1.p3.5.m5.1.1.2">𝑘</ci><cn id="S2.SS0.SSS0.Px1.p3.5.m5.1.1.3.cmml" type="integer" xref="S2.SS0.SSS0.Px1.p3.5.m5.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p3.5.m5.1c">k-1</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.p3.5.m5.1d">italic_k - 1</annotation></semantics></math> dimensional probability simplex. The feature encoder <math alttext="f_{\theta}" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p3.6.m6.1"><semantics id="S2.SS0.SSS0.Px1.p3.6.m6.1a"><msub id="S2.SS0.SSS0.Px1.p3.6.m6.1.1" xref="S2.SS0.SSS0.Px1.p3.6.m6.1.1.cmml"><mi id="S2.SS0.SSS0.Px1.p3.6.m6.1.1.2" xref="S2.SS0.SSS0.Px1.p3.6.m6.1.1.2.cmml">f</mi><mi id="S2.SS0.SSS0.Px1.p3.6.m6.1.1.3" xref="S2.SS0.SSS0.Px1.p3.6.m6.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p3.6.m6.1b"><apply id="S2.SS0.SSS0.Px1.p3.6.m6.1.1.cmml" xref="S2.SS0.SSS0.Px1.p3.6.m6.1.1"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p3.6.m6.1.1.1.cmml" xref="S2.SS0.SSS0.Px1.p3.6.m6.1.1">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.p3.6.m6.1.1.2.cmml" xref="S2.SS0.SSS0.Px1.p3.6.m6.1.1.2">𝑓</ci><ci id="S2.SS0.SSS0.Px1.p3.6.m6.1.1.3.cmml" xref="S2.SS0.SSS0.Px1.p3.6.m6.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p3.6.m6.1c">f_{\theta}</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.p3.6.m6.1d">italic_f start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math> contains all layers until the penultimate layer of a neural network. On top of that, <math alttext="g_{w}:{\mathcal{Z}}\rightarrow\Delta_{k}" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p3.7.m7.1"><semantics id="S2.SS0.SSS0.Px1.p3.7.m7.1a"><mrow id="S2.SS0.SSS0.Px1.p3.7.m7.1.1" xref="S2.SS0.SSS0.Px1.p3.7.m7.1.1.cmml"><msub id="S2.SS0.SSS0.Px1.p3.7.m7.1.1.2" xref="S2.SS0.SSS0.Px1.p3.7.m7.1.1.2.cmml"><mi id="S2.SS0.SSS0.Px1.p3.7.m7.1.1.2.2" xref="S2.SS0.SSS0.Px1.p3.7.m7.1.1.2.2.cmml">g</mi><mi id="S2.SS0.SSS0.Px1.p3.7.m7.1.1.2.3" xref="S2.SS0.SSS0.Px1.p3.7.m7.1.1.2.3.cmml">w</mi></msub><mo id="S2.SS0.SSS0.Px1.p3.7.m7.1.1.1" lspace="0.278em" rspace="0.278em" xref="S2.SS0.SSS0.Px1.p3.7.m7.1.1.1.cmml">:</mo><mrow id="S2.SS0.SSS0.Px1.p3.7.m7.1.1.3" xref="S2.SS0.SSS0.Px1.p3.7.m7.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS0.SSS0.Px1.p3.7.m7.1.1.3.2" xref="S2.SS0.SSS0.Px1.p3.7.m7.1.1.3.2.cmml">𝒵</mi><mo id="S2.SS0.SSS0.Px1.p3.7.m7.1.1.3.1" stretchy="false" xref="S2.SS0.SSS0.Px1.p3.7.m7.1.1.3.1.cmml">→</mo><msub id="S2.SS0.SSS0.Px1.p3.7.m7.1.1.3.3" xref="S2.SS0.SSS0.Px1.p3.7.m7.1.1.3.3.cmml"><mi id="S2.SS0.SSS0.Px1.p3.7.m7.1.1.3.3.2" mathvariant="normal" xref="S2.SS0.SSS0.Px1.p3.7.m7.1.1.3.3.2.cmml">Δ</mi><mi id="S2.SS0.SSS0.Px1.p3.7.m7.1.1.3.3.3" xref="S2.SS0.SSS0.Px1.p3.7.m7.1.1.3.3.3.cmml">k</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p3.7.m7.1b"><apply id="S2.SS0.SSS0.Px1.p3.7.m7.1.1.cmml" xref="S2.SS0.SSS0.Px1.p3.7.m7.1.1"><ci id="S2.SS0.SSS0.Px1.p3.7.m7.1.1.1.cmml" xref="S2.SS0.SSS0.Px1.p3.7.m7.1.1.1">:</ci><apply id="S2.SS0.SSS0.Px1.p3.7.m7.1.1.2.cmml" xref="S2.SS0.SSS0.Px1.p3.7.m7.1.1.2"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p3.7.m7.1.1.2.1.cmml" xref="S2.SS0.SSS0.Px1.p3.7.m7.1.1.2">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.p3.7.m7.1.1.2.2.cmml" xref="S2.SS0.SSS0.Px1.p3.7.m7.1.1.2.2">𝑔</ci><ci id="S2.SS0.SSS0.Px1.p3.7.m7.1.1.2.3.cmml" xref="S2.SS0.SSS0.Px1.p3.7.m7.1.1.2.3">𝑤</ci></apply><apply id="S2.SS0.SSS0.Px1.p3.7.m7.1.1.3.cmml" xref="S2.SS0.SSS0.Px1.p3.7.m7.1.1.3"><ci id="S2.SS0.SSS0.Px1.p3.7.m7.1.1.3.1.cmml" xref="S2.SS0.SSS0.Px1.p3.7.m7.1.1.3.1">→</ci><ci id="S2.SS0.SSS0.Px1.p3.7.m7.1.1.3.2.cmml" xref="S2.SS0.SSS0.Px1.p3.7.m7.1.1.3.2">𝒵</ci><apply id="S2.SS0.SSS0.Px1.p3.7.m7.1.1.3.3.cmml" xref="S2.SS0.SSS0.Px1.p3.7.m7.1.1.3.3"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p3.7.m7.1.1.3.3.1.cmml" xref="S2.SS0.SSS0.Px1.p3.7.m7.1.1.3.3">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.p3.7.m7.1.1.3.3.2.cmml" xref="S2.SS0.SSS0.Px1.p3.7.m7.1.1.3.3.2">Δ</ci><ci id="S2.SS0.SSS0.Px1.p3.7.m7.1.1.3.3.3.cmml" xref="S2.SS0.SSS0.Px1.p3.7.m7.1.1.3.3.3">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p3.7.m7.1c">g_{w}:{\mathcal{Z}}\rightarrow\Delta_{k}</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.p3.7.m7.1d">italic_g start_POSTSUBSCRIPT italic_w end_POSTSUBSCRIPT : caligraphic_Z → roman_Δ start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> is a linear classifier with weights <math alttext="w" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p3.8.m8.1"><semantics id="S2.SS0.SSS0.Px1.p3.8.m8.1a"><mi id="S2.SS0.SSS0.Px1.p3.8.m8.1.1" xref="S2.SS0.SSS0.Px1.p3.8.m8.1.1.cmml">w</mi><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p3.8.m8.1b"><ci id="S2.SS0.SSS0.Px1.p3.8.m8.1.1.cmml" xref="S2.SS0.SSS0.Px1.p3.8.m8.1.1">𝑤</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p3.8.m8.1c">w</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.p3.8.m8.1d">italic_w</annotation></semantics></math>. Let <math alttext="q" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p3.9.m9.1"><semantics id="S2.SS0.SSS0.Px1.p3.9.m9.1a"><mi id="S2.SS0.SSS0.Px1.p3.9.m9.1.1" xref="S2.SS0.SSS0.Px1.p3.9.m9.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p3.9.m9.1b"><ci id="S2.SS0.SSS0.Px1.p3.9.m9.1.1.cmml" xref="S2.SS0.SSS0.Px1.p3.9.m9.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p3.9.m9.1c">q</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.p3.9.m9.1d">italic_q</annotation></semantics></math> be the one-hot encoding vector of <math alttext="y" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p3.10.m10.1"><semantics id="S2.SS0.SSS0.Px1.p3.10.m10.1a"><mi id="S2.SS0.SSS0.Px1.p3.10.m10.1.1" xref="S2.SS0.SSS0.Px1.p3.10.m10.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p3.10.m10.1b"><ci id="S2.SS0.SSS0.Px1.p3.10.m10.1.1.cmml" xref="S2.SS0.SSS0.Px1.p3.10.m10.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p3.10.m10.1c">y</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.p3.10.m10.1d">italic_y</annotation></semantics></math>. The parameters <math alttext="\theta" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p3.11.m11.1"><semantics id="S2.SS0.SSS0.Px1.p3.11.m11.1a"><mi id="S2.SS0.SSS0.Px1.p3.11.m11.1.1" xref="S2.SS0.SSS0.Px1.p3.11.m11.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p3.11.m11.1b"><ci id="S2.SS0.SSS0.Px1.p3.11.m11.1.1.cmml" xref="S2.SS0.SSS0.Px1.p3.11.m11.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p3.11.m11.1c">\theta</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.p3.11.m11.1d">italic_θ</annotation></semantics></math> and <math alttext="w" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p3.12.m12.1"><semantics id="S2.SS0.SSS0.Px1.p3.12.m12.1a"><mi id="S2.SS0.SSS0.Px1.p3.12.m12.1.1" xref="S2.SS0.SSS0.Px1.p3.12.m12.1.1.cmml">w</mi><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p3.12.m12.1b"><ci id="S2.SS0.SSS0.Px1.p3.12.m12.1.1.cmml" xref="S2.SS0.SSS0.Px1.p3.12.m12.1.1">𝑤</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p3.12.m12.1c">w</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.p3.12.m12.1d">italic_w</annotation></semantics></math> are learned by minimizing <math alttext="{\mathcal{L}}" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p3.13.m13.1"><semantics id="S2.SS0.SSS0.Px1.p3.13.m13.1a"><mi class="ltx_font_mathcaligraphic" id="S2.SS0.SSS0.Px1.p3.13.m13.1.1" xref="S2.SS0.SSS0.Px1.p3.13.m13.1.1.cmml">ℒ</mi><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p3.13.m13.1b"><ci id="S2.SS0.SSS0.Px1.p3.13.m13.1.1.cmml" xref="S2.SS0.SSS0.Px1.p3.13.m13.1.1">ℒ</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p3.13.m13.1c">{\mathcal{L}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.p3.13.m13.1d">caligraphic_L</annotation></semantics></math> combining the cross entropy loss <math alttext="\ell_{\text{CE}}" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p3.14.m14.1"><semantics id="S2.SS0.SSS0.Px1.p3.14.m14.1a"><msub id="S2.SS0.SSS0.Px1.p3.14.m14.1.1" xref="S2.SS0.SSS0.Px1.p3.14.m14.1.1.cmml"><mi id="S2.SS0.SSS0.Px1.p3.14.m14.1.1.2" mathvariant="normal" xref="S2.SS0.SSS0.Px1.p3.14.m14.1.1.2.cmml">ℓ</mi><mtext id="S2.SS0.SSS0.Px1.p3.14.m14.1.1.3" xref="S2.SS0.SSS0.Px1.p3.14.m14.1.1.3a.cmml">CE</mtext></msub><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p3.14.m14.1b"><apply id="S2.SS0.SSS0.Px1.p3.14.m14.1.1.cmml" xref="S2.SS0.SSS0.Px1.p3.14.m14.1.1"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p3.14.m14.1.1.1.cmml" xref="S2.SS0.SSS0.Px1.p3.14.m14.1.1">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.p3.14.m14.1.1.2.cmml" xref="S2.SS0.SSS0.Px1.p3.14.m14.1.1.2">ℓ</ci><ci id="S2.SS0.SSS0.Px1.p3.14.m14.1.1.3a.cmml" xref="S2.SS0.SSS0.Px1.p3.14.m14.1.1.3"><mtext id="S2.SS0.SSS0.Px1.p3.14.m14.1.1.3.cmml" mathsize="70%" xref="S2.SS0.SSS0.Px1.p3.14.m14.1.1.3">CE</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p3.14.m14.1c">\ell_{\text{CE}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.p3.14.m14.1d">roman_ℓ start_POSTSUBSCRIPT CE end_POSTSUBSCRIPT</annotation></semantics></math> with an optional regularization term <math alttext="{\mathcal{R}}" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p3.15.m15.1"><semantics id="S2.SS0.SSS0.Px1.p3.15.m15.1a"><mi class="ltx_font_mathcaligraphic" id="S2.SS0.SSS0.Px1.p3.15.m15.1.1" xref="S2.SS0.SSS0.Px1.p3.15.m15.1.1.cmml">ℛ</mi><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p3.15.m15.1b"><ci id="S2.SS0.SSS0.Px1.p3.15.m15.1.1.cmml" xref="S2.SS0.SSS0.Px1.p3.15.m15.1.1">ℛ</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p3.15.m15.1c">{\mathcal{R}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.p3.15.m15.1d">caligraphic_R</annotation></semantics></math>:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="{\mathcal{L}}(x,y;w,\theta)=\sum\limits_{i=1}^{k}-q_{i}\log h_{w,\theta}(x)_{i%
}+\lambda{\mathcal{R}}(x,y,\theta)." class="ltx_Math" display="block" id="S2.E1.m1.11"><semantics id="S2.E1.m1.11a"><mrow id="S2.E1.m1.11.11.1" xref="S2.E1.m1.11.11.1.1.cmml"><mrow id="S2.E1.m1.11.11.1.1" xref="S2.E1.m1.11.11.1.1.cmml"><mrow id="S2.E1.m1.11.11.1.1.2" xref="S2.E1.m1.11.11.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E1.m1.11.11.1.1.2.2" xref="S2.E1.m1.11.11.1.1.2.2.cmml">ℒ</mi><mo id="S2.E1.m1.11.11.1.1.2.1" xref="S2.E1.m1.11.11.1.1.2.1.cmml">⁢</mo><mrow id="S2.E1.m1.11.11.1.1.2.3.2" xref="S2.E1.m1.11.11.1.1.2.3.1.cmml"><mo id="S2.E1.m1.11.11.1.1.2.3.2.1" stretchy="false" xref="S2.E1.m1.11.11.1.1.2.3.1.cmml">(</mo><mi id="S2.E1.m1.3.3" xref="S2.E1.m1.3.3.cmml">x</mi><mo id="S2.E1.m1.11.11.1.1.2.3.2.2" xref="S2.E1.m1.11.11.1.1.2.3.1.cmml">,</mo><mi id="S2.E1.m1.4.4" xref="S2.E1.m1.4.4.cmml">y</mi><mo id="S2.E1.m1.11.11.1.1.2.3.2.3" xref="S2.E1.m1.11.11.1.1.2.3.1.cmml">;</mo><mi id="S2.E1.m1.5.5" xref="S2.E1.m1.5.5.cmml">w</mi><mo id="S2.E1.m1.11.11.1.1.2.3.2.4" xref="S2.E1.m1.11.11.1.1.2.3.1.cmml">,</mo><mi id="S2.E1.m1.6.6" xref="S2.E1.m1.6.6.cmml">θ</mi><mo id="S2.E1.m1.11.11.1.1.2.3.2.5" stretchy="false" xref="S2.E1.m1.11.11.1.1.2.3.1.cmml">)</mo></mrow></mrow><mo id="S2.E1.m1.11.11.1.1.1" rspace="0.111em" xref="S2.E1.m1.11.11.1.1.1.cmml">=</mo><mrow id="S2.E1.m1.11.11.1.1.3" xref="S2.E1.m1.11.11.1.1.3.cmml"><mrow id="S2.E1.m1.11.11.1.1.3.2" xref="S2.E1.m1.11.11.1.1.3.2.cmml"><munderover id="S2.E1.m1.11.11.1.1.3.2.2" xref="S2.E1.m1.11.11.1.1.3.2.2.cmml"><mo id="S2.E1.m1.11.11.1.1.3.2.2.2.2" movablelimits="false" rspace="0em" xref="S2.E1.m1.11.11.1.1.3.2.2.2.2.cmml">∑</mo><mrow id="S2.E1.m1.11.11.1.1.3.2.2.2.3" xref="S2.E1.m1.11.11.1.1.3.2.2.2.3.cmml"><mi id="S2.E1.m1.11.11.1.1.3.2.2.2.3.2" xref="S2.E1.m1.11.11.1.1.3.2.2.2.3.2.cmml">i</mi><mo id="S2.E1.m1.11.11.1.1.3.2.2.2.3.1" xref="S2.E1.m1.11.11.1.1.3.2.2.2.3.1.cmml">=</mo><mn id="S2.E1.m1.11.11.1.1.3.2.2.2.3.3" xref="S2.E1.m1.11.11.1.1.3.2.2.2.3.3.cmml">1</mn></mrow><mi id="S2.E1.m1.11.11.1.1.3.2.2.3" xref="S2.E1.m1.11.11.1.1.3.2.2.3.cmml">k</mi></munderover><mo id="S2.E1.m1.11.11.1.1.3.2.1" lspace="0em" xref="S2.E1.m1.11.11.1.1.3.2.1.cmml">−</mo><mrow id="S2.E1.m1.11.11.1.1.3.2.3" xref="S2.E1.m1.11.11.1.1.3.2.3.cmml"><msub id="S2.E1.m1.11.11.1.1.3.2.3.2" xref="S2.E1.m1.11.11.1.1.3.2.3.2.cmml"><mi id="S2.E1.m1.11.11.1.1.3.2.3.2.2" xref="S2.E1.m1.11.11.1.1.3.2.3.2.2.cmml">q</mi><mi id="S2.E1.m1.11.11.1.1.3.2.3.2.3" xref="S2.E1.m1.11.11.1.1.3.2.3.2.3.cmml">i</mi></msub><mo id="S2.E1.m1.11.11.1.1.3.2.3.1" lspace="0.167em" xref="S2.E1.m1.11.11.1.1.3.2.3.1.cmml">⁢</mo><mrow id="S2.E1.m1.11.11.1.1.3.2.3.3" xref="S2.E1.m1.11.11.1.1.3.2.3.3.cmml"><mi id="S2.E1.m1.11.11.1.1.3.2.3.3.1" xref="S2.E1.m1.11.11.1.1.3.2.3.3.1.cmml">log</mi><mo id="S2.E1.m1.11.11.1.1.3.2.3.3a" lspace="0.167em" xref="S2.E1.m1.11.11.1.1.3.2.3.3.cmml">⁡</mo><msub id="S2.E1.m1.11.11.1.1.3.2.3.3.2" xref="S2.E1.m1.11.11.1.1.3.2.3.3.2.cmml"><mi id="S2.E1.m1.11.11.1.1.3.2.3.3.2.2" xref="S2.E1.m1.11.11.1.1.3.2.3.3.2.2.cmml">h</mi><mrow id="S2.E1.m1.2.2.2.4" xref="S2.E1.m1.2.2.2.3.cmml"><mi id="S2.E1.m1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.cmml">w</mi><mo id="S2.E1.m1.2.2.2.4.1" xref="S2.E1.m1.2.2.2.3.cmml">,</mo><mi id="S2.E1.m1.2.2.2.2" xref="S2.E1.m1.2.2.2.2.cmml">θ</mi></mrow></msub></mrow><mo id="S2.E1.m1.11.11.1.1.3.2.3.1a" xref="S2.E1.m1.11.11.1.1.3.2.3.1.cmml">⁢</mo><msub id="S2.E1.m1.11.11.1.1.3.2.3.4" xref="S2.E1.m1.11.11.1.1.3.2.3.4.cmml"><mrow id="S2.E1.m1.11.11.1.1.3.2.3.4.2.2" xref="S2.E1.m1.11.11.1.1.3.2.3.4.cmml"><mo id="S2.E1.m1.11.11.1.1.3.2.3.4.2.2.1" stretchy="false" xref="S2.E1.m1.11.11.1.1.3.2.3.4.cmml">(</mo><mi id="S2.E1.m1.7.7" xref="S2.E1.m1.7.7.cmml">x</mi><mo id="S2.E1.m1.11.11.1.1.3.2.3.4.2.2.2" stretchy="false" xref="S2.E1.m1.11.11.1.1.3.2.3.4.cmml">)</mo></mrow><mi id="S2.E1.m1.11.11.1.1.3.2.3.4.3" xref="S2.E1.m1.11.11.1.1.3.2.3.4.3.cmml">i</mi></msub></mrow></mrow><mo id="S2.E1.m1.11.11.1.1.3.1" xref="S2.E1.m1.11.11.1.1.3.1.cmml">+</mo><mrow id="S2.E1.m1.11.11.1.1.3.3" xref="S2.E1.m1.11.11.1.1.3.3.cmml"><mi id="S2.E1.m1.11.11.1.1.3.3.2" xref="S2.E1.m1.11.11.1.1.3.3.2.cmml">λ</mi><mo id="S2.E1.m1.11.11.1.1.3.3.1" xref="S2.E1.m1.11.11.1.1.3.3.1.cmml">⁢</mo><mi class="ltx_font_mathcaligraphic" id="S2.E1.m1.11.11.1.1.3.3.3" xref="S2.E1.m1.11.11.1.1.3.3.3.cmml">ℛ</mi><mo id="S2.E1.m1.11.11.1.1.3.3.1a" xref="S2.E1.m1.11.11.1.1.3.3.1.cmml">⁢</mo><mrow id="S2.E1.m1.11.11.1.1.3.3.4.2" xref="S2.E1.m1.11.11.1.1.3.3.4.1.cmml"><mo id="S2.E1.m1.11.11.1.1.3.3.4.2.1" stretchy="false" xref="S2.E1.m1.11.11.1.1.3.3.4.1.cmml">(</mo><mi id="S2.E1.m1.8.8" xref="S2.E1.m1.8.8.cmml">x</mi><mo id="S2.E1.m1.11.11.1.1.3.3.4.2.2" xref="S2.E1.m1.11.11.1.1.3.3.4.1.cmml">,</mo><mi id="S2.E1.m1.9.9" xref="S2.E1.m1.9.9.cmml">y</mi><mo id="S2.E1.m1.11.11.1.1.3.3.4.2.3" xref="S2.E1.m1.11.11.1.1.3.3.4.1.cmml">,</mo><mi id="S2.E1.m1.10.10" xref="S2.E1.m1.10.10.cmml">θ</mi><mo id="S2.E1.m1.11.11.1.1.3.3.4.2.4" stretchy="false" xref="S2.E1.m1.11.11.1.1.3.3.4.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S2.E1.m1.11.11.1.2" lspace="0em" xref="S2.E1.m1.11.11.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E1.m1.11b"><apply id="S2.E1.m1.11.11.1.1.cmml" xref="S2.E1.m1.11.11.1"><eq id="S2.E1.m1.11.11.1.1.1.cmml" xref="S2.E1.m1.11.11.1.1.1"></eq><apply id="S2.E1.m1.11.11.1.1.2.cmml" xref="S2.E1.m1.11.11.1.1.2"><times id="S2.E1.m1.11.11.1.1.2.1.cmml" xref="S2.E1.m1.11.11.1.1.2.1"></times><ci id="S2.E1.m1.11.11.1.1.2.2.cmml" xref="S2.E1.m1.11.11.1.1.2.2">ℒ</ci><vector id="S2.E1.m1.11.11.1.1.2.3.1.cmml" xref="S2.E1.m1.11.11.1.1.2.3.2"><ci id="S2.E1.m1.3.3.cmml" xref="S2.E1.m1.3.3">𝑥</ci><ci id="S2.E1.m1.4.4.cmml" xref="S2.E1.m1.4.4">𝑦</ci><ci id="S2.E1.m1.5.5.cmml" xref="S2.E1.m1.5.5">𝑤</ci><ci id="S2.E1.m1.6.6.cmml" xref="S2.E1.m1.6.6">𝜃</ci></vector></apply><apply id="S2.E1.m1.11.11.1.1.3.cmml" xref="S2.E1.m1.11.11.1.1.3"><plus id="S2.E1.m1.11.11.1.1.3.1.cmml" xref="S2.E1.m1.11.11.1.1.3.1"></plus><apply id="S2.E1.m1.11.11.1.1.3.2.cmml" xref="S2.E1.m1.11.11.1.1.3.2"><minus id="S2.E1.m1.11.11.1.1.3.2.1.cmml" xref="S2.E1.m1.11.11.1.1.3.2.1"></minus><apply id="S2.E1.m1.11.11.1.1.3.2.2.cmml" xref="S2.E1.m1.11.11.1.1.3.2.2"><csymbol cd="ambiguous" id="S2.E1.m1.11.11.1.1.3.2.2.1.cmml" xref="S2.E1.m1.11.11.1.1.3.2.2">superscript</csymbol><apply id="S2.E1.m1.11.11.1.1.3.2.2.2.cmml" xref="S2.E1.m1.11.11.1.1.3.2.2"><csymbol cd="ambiguous" id="S2.E1.m1.11.11.1.1.3.2.2.2.1.cmml" xref="S2.E1.m1.11.11.1.1.3.2.2">subscript</csymbol><sum id="S2.E1.m1.11.11.1.1.3.2.2.2.2.cmml" xref="S2.E1.m1.11.11.1.1.3.2.2.2.2"></sum><apply id="S2.E1.m1.11.11.1.1.3.2.2.2.3.cmml" xref="S2.E1.m1.11.11.1.1.3.2.2.2.3"><eq id="S2.E1.m1.11.11.1.1.3.2.2.2.3.1.cmml" xref="S2.E1.m1.11.11.1.1.3.2.2.2.3.1"></eq><ci id="S2.E1.m1.11.11.1.1.3.2.2.2.3.2.cmml" xref="S2.E1.m1.11.11.1.1.3.2.2.2.3.2">𝑖</ci><cn id="S2.E1.m1.11.11.1.1.3.2.2.2.3.3.cmml" type="integer" xref="S2.E1.m1.11.11.1.1.3.2.2.2.3.3">1</cn></apply></apply><ci id="S2.E1.m1.11.11.1.1.3.2.2.3.cmml" xref="S2.E1.m1.11.11.1.1.3.2.2.3">𝑘</ci></apply><apply id="S2.E1.m1.11.11.1.1.3.2.3.cmml" xref="S2.E1.m1.11.11.1.1.3.2.3"><times id="S2.E1.m1.11.11.1.1.3.2.3.1.cmml" xref="S2.E1.m1.11.11.1.1.3.2.3.1"></times><apply id="S2.E1.m1.11.11.1.1.3.2.3.2.cmml" xref="S2.E1.m1.11.11.1.1.3.2.3.2"><csymbol cd="ambiguous" id="S2.E1.m1.11.11.1.1.3.2.3.2.1.cmml" xref="S2.E1.m1.11.11.1.1.3.2.3.2">subscript</csymbol><ci id="S2.E1.m1.11.11.1.1.3.2.3.2.2.cmml" xref="S2.E1.m1.11.11.1.1.3.2.3.2.2">𝑞</ci><ci id="S2.E1.m1.11.11.1.1.3.2.3.2.3.cmml" xref="S2.E1.m1.11.11.1.1.3.2.3.2.3">𝑖</ci></apply><apply id="S2.E1.m1.11.11.1.1.3.2.3.3.cmml" xref="S2.E1.m1.11.11.1.1.3.2.3.3"><log id="S2.E1.m1.11.11.1.1.3.2.3.3.1.cmml" xref="S2.E1.m1.11.11.1.1.3.2.3.3.1"></log><apply id="S2.E1.m1.11.11.1.1.3.2.3.3.2.cmml" xref="S2.E1.m1.11.11.1.1.3.2.3.3.2"><csymbol cd="ambiguous" id="S2.E1.m1.11.11.1.1.3.2.3.3.2.1.cmml" xref="S2.E1.m1.11.11.1.1.3.2.3.3.2">subscript</csymbol><ci id="S2.E1.m1.11.11.1.1.3.2.3.3.2.2.cmml" xref="S2.E1.m1.11.11.1.1.3.2.3.3.2.2">ℎ</ci><list id="S2.E1.m1.2.2.2.3.cmml" xref="S2.E1.m1.2.2.2.4"><ci id="S2.E1.m1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1.1">𝑤</ci><ci id="S2.E1.m1.2.2.2.2.cmml" xref="S2.E1.m1.2.2.2.2">𝜃</ci></list></apply></apply><apply id="S2.E1.m1.11.11.1.1.3.2.3.4.cmml" xref="S2.E1.m1.11.11.1.1.3.2.3.4"><csymbol cd="ambiguous" id="S2.E1.m1.11.11.1.1.3.2.3.4.1.cmml" xref="S2.E1.m1.11.11.1.1.3.2.3.4">subscript</csymbol><ci id="S2.E1.m1.7.7.cmml" xref="S2.E1.m1.7.7">𝑥</ci><ci id="S2.E1.m1.11.11.1.1.3.2.3.4.3.cmml" xref="S2.E1.m1.11.11.1.1.3.2.3.4.3">𝑖</ci></apply></apply></apply><apply id="S2.E1.m1.11.11.1.1.3.3.cmml" xref="S2.E1.m1.11.11.1.1.3.3"><times id="S2.E1.m1.11.11.1.1.3.3.1.cmml" xref="S2.E1.m1.11.11.1.1.3.3.1"></times><ci id="S2.E1.m1.11.11.1.1.3.3.2.cmml" xref="S2.E1.m1.11.11.1.1.3.3.2">𝜆</ci><ci id="S2.E1.m1.11.11.1.1.3.3.3.cmml" xref="S2.E1.m1.11.11.1.1.3.3.3">ℛ</ci><vector id="S2.E1.m1.11.11.1.1.3.3.4.1.cmml" xref="S2.E1.m1.11.11.1.1.3.3.4.2"><ci id="S2.E1.m1.8.8.cmml" xref="S2.E1.m1.8.8">𝑥</ci><ci id="S2.E1.m1.9.9.cmml" xref="S2.E1.m1.9.9">𝑦</ci><ci id="S2.E1.m1.10.10.cmml" xref="S2.E1.m1.10.10">𝜃</ci></vector></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1.m1.11c">{\mathcal{L}}(x,y;w,\theta)=\sum\limits_{i=1}^{k}-q_{i}\log h_{w,\theta}(x)_{i%
}+\lambda{\mathcal{R}}(x,y,\theta).</annotation><annotation encoding="application/x-llamapun" id="S2.E1.m1.11d">caligraphic_L ( italic_x , italic_y ; italic_w , italic_θ ) = ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT - italic_q start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT roman_log italic_h start_POSTSUBSCRIPT italic_w , italic_θ end_POSTSUBSCRIPT ( italic_x ) start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT + italic_λ caligraphic_R ( italic_x , italic_y , italic_θ ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS0.SSS0.Px1.p3.19">The hyperparameter <math alttext="\lambda" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p3.16.m1.1"><semantics id="S2.SS0.SSS0.Px1.p3.16.m1.1a"><mi id="S2.SS0.SSS0.Px1.p3.16.m1.1.1" xref="S2.SS0.SSS0.Px1.p3.16.m1.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p3.16.m1.1b"><ci id="S2.SS0.SSS0.Px1.p3.16.m1.1.1.cmml" xref="S2.SS0.SSS0.Px1.p3.16.m1.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p3.16.m1.1c">\lambda</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.p3.16.m1.1d">italic_λ</annotation></semantics></math> is the regularization factor which controls the strength of <math alttext="{\mathcal{R}}" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p3.17.m2.1"><semantics id="S2.SS0.SSS0.Px1.p3.17.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S2.SS0.SSS0.Px1.p3.17.m2.1.1" xref="S2.SS0.SSS0.Px1.p3.17.m2.1.1.cmml">ℛ</mi><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p3.17.m2.1b"><ci id="S2.SS0.SSS0.Px1.p3.17.m2.1.1.cmml" xref="S2.SS0.SSS0.Px1.p3.17.m2.1.1">ℛ</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p3.17.m2.1c">{\mathcal{R}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.p3.17.m2.1d">caligraphic_R</annotation></semantics></math>. The goal of the problem is to embed the class hierarchical relationship in the feature space. At a high level, the distance of class-conditioned representations should approximate the tree metric of classes in <math alttext="{\mathcal{T}}" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p3.18.m3.1"><semantics id="S2.SS0.SSS0.Px1.p3.18.m3.1a"><mi class="ltx_font_mathcaligraphic" id="S2.SS0.SSS0.Px1.p3.18.m3.1.1" xref="S2.SS0.SSS0.Px1.p3.18.m3.1.1.cmml">𝒯</mi><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p3.18.m3.1b"><ci id="S2.SS0.SSS0.Px1.p3.18.m3.1.1.cmml" xref="S2.SS0.SSS0.Px1.p3.18.m3.1.1">𝒯</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p3.18.m3.1c">{\mathcal{T}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.p3.18.m3.1d">caligraphic_T</annotation></semantics></math>. This extra constraint can be quantitatively characterized by CPCC as the regularizer term <math alttext="{\mathcal{R}}" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p3.19.m4.1"><semantics id="S2.SS0.SSS0.Px1.p3.19.m4.1a"><mi class="ltx_font_mathcaligraphic" id="S2.SS0.SSS0.Px1.p3.19.m4.1.1" xref="S2.SS0.SSS0.Px1.p3.19.m4.1.1.cmml">ℛ</mi><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p3.19.m4.1b"><ci id="S2.SS0.SSS0.Px1.p3.19.m4.1.1.cmml" xref="S2.SS0.SSS0.Px1.p3.19.m4.1.1">ℛ</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p3.19.m4.1c">{\mathcal{R}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.p3.19.m4.1d">caligraphic_R</annotation></semantics></math> that we will introduce next.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Cophenetic Correlation Coefficient</h3>
<div class="ltx_para" id="S2.SS1.p1">
<p class="ltx_p" id="S2.SS1.p1.3">The Cophenetic Correlation Coefficient (CPCC) <cite class="ltx_cite ltx_citemacro_citep">(Sokal and Rohlf, <a class="ltx_ref" href="https://arxiv.org/html/2410.03052v1#bib.bib34" title="">1962</a>)</cite> was introduced as a regularization term in <cite class="ltx_cite ltx_citemacro_citet">Zeng et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03052v1#bib.bib40" title="">2022</a>)</cite> to embed the class hierarchy <math alttext="{\mathcal{T}}" class="ltx_Math" display="inline" id="S2.SS1.p1.1.m1.1"><semantics id="S2.SS1.p1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.1.m1.1.1" xref="S2.SS1.p1.1.m1.1.1.cmml">𝒯</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.1.m1.1b"><ci id="S2.SS1.p1.1.m1.1.1.cmml" xref="S2.SS1.p1.1.m1.1.1">𝒯</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.1.m1.1c">{\mathcal{T}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.1.m1.1d">caligraphic_T</annotation></semantics></math> in the feature space. CPCC has the same formulation as Pearson’s correlation coefficient that measures the linear dependence between two metrics <math alttext="t" class="ltx_Math" display="inline" id="S2.SS1.p1.2.m2.1"><semantics id="S2.SS1.p1.2.m2.1a"><mi id="S2.SS1.p1.2.m2.1.1" xref="S2.SS1.p1.2.m2.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.2.m2.1b"><ci id="S2.SS1.p1.2.m2.1.1.cmml" xref="S2.SS1.p1.2.m2.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.2.m2.1c">t</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.2.m2.1d">italic_t</annotation></semantics></math> and <math alttext="\rho" class="ltx_Math" display="inline" id="S2.SS1.p1.3.m3.1"><semantics id="S2.SS1.p1.3.m3.1a"><mi id="S2.SS1.p1.3.m3.1.1" xref="S2.SS1.p1.3.m3.1.1.cmml">ρ</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.3.m3.1b"><ci id="S2.SS1.p1.3.m3.1.1.cmml" xref="S2.SS1.p1.3.m3.1.1">𝜌</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.3.m3.1c">\rho</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.3.m3.1d">italic_ρ</annotation></semantics></math>:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\text{CPCC}(t,\rho)=\frac{\sum\limits_{u&lt;v}(t(u,v)-\bar{t})(\rho(u,v)-\bar{%
\rho})}{(\sum\limits_{u&lt;v}(t(u,v)-\bar{t})^{2})^{-1/2}(\sum\limits_{u&lt;v}(\rho(%
u,v)-\bar{\rho})^{2})^{-1/2}}," class="ltx_Math" display="block" id="S2.E2.m1.15"><semantics id="S2.E2.m1.15a"><mrow id="S2.E2.m1.15.15.1" xref="S2.E2.m1.15.15.1.1.cmml"><mrow id="S2.E2.m1.15.15.1.1" xref="S2.E2.m1.15.15.1.1.cmml"><mrow id="S2.E2.m1.15.15.1.1.2" xref="S2.E2.m1.15.15.1.1.2.cmml"><mtext id="S2.E2.m1.15.15.1.1.2.2" xref="S2.E2.m1.15.15.1.1.2.2a.cmml">CPCC</mtext><mo id="S2.E2.m1.15.15.1.1.2.1" xref="S2.E2.m1.15.15.1.1.2.1.cmml">⁢</mo><mrow id="S2.E2.m1.15.15.1.1.2.3.2" xref="S2.E2.m1.15.15.1.1.2.3.1.cmml"><mo id="S2.E2.m1.15.15.1.1.2.3.2.1" stretchy="false" xref="S2.E2.m1.15.15.1.1.2.3.1.cmml">(</mo><mi id="S2.E2.m1.13.13" xref="S2.E2.m1.13.13.cmml">t</mi><mo id="S2.E2.m1.15.15.1.1.2.3.2.2" xref="S2.E2.m1.15.15.1.1.2.3.1.cmml">,</mo><mi id="S2.E2.m1.14.14" xref="S2.E2.m1.14.14.cmml">ρ</mi><mo id="S2.E2.m1.15.15.1.1.2.3.2.3" stretchy="false" xref="S2.E2.m1.15.15.1.1.2.3.1.cmml">)</mo></mrow></mrow><mo id="S2.E2.m1.15.15.1.1.1" xref="S2.E2.m1.15.15.1.1.1.cmml">=</mo><mfrac id="S2.E2.m1.12.12" xref="S2.E2.m1.12.12.cmml"><mrow id="S2.E2.m1.6.6.6" xref="S2.E2.m1.6.6.6.cmml"><munder id="S2.E2.m1.6.6.6.7" xref="S2.E2.m1.6.6.6.7.cmml"><mo id="S2.E2.m1.6.6.6.7.2" movablelimits="false" xref="S2.E2.m1.6.6.6.7.2.cmml">∑</mo><mrow id="S2.E2.m1.6.6.6.7.3" xref="S2.E2.m1.6.6.6.7.3.cmml"><mi id="S2.E2.m1.6.6.6.7.3.2" xref="S2.E2.m1.6.6.6.7.3.2.cmml">u</mi><mo id="S2.E2.m1.6.6.6.7.3.1" xref="S2.E2.m1.6.6.6.7.3.1.cmml">&lt;</mo><mi id="S2.E2.m1.6.6.6.7.3.3" xref="S2.E2.m1.6.6.6.7.3.3.cmml">v</mi></mrow></munder><mrow id="S2.E2.m1.6.6.6.6" xref="S2.E2.m1.6.6.6.6.cmml"><mrow id="S2.E2.m1.5.5.5.5.1.1" xref="S2.E2.m1.5.5.5.5.1.1.1.cmml"><mo id="S2.E2.m1.5.5.5.5.1.1.2" lspace="0em" stretchy="false" xref="S2.E2.m1.5.5.5.5.1.1.1.cmml">(</mo><mrow id="S2.E2.m1.5.5.5.5.1.1.1" xref="S2.E2.m1.5.5.5.5.1.1.1.cmml"><mrow id="S2.E2.m1.5.5.5.5.1.1.1.2" xref="S2.E2.m1.5.5.5.5.1.1.1.2.cmml"><mi id="S2.E2.m1.5.5.5.5.1.1.1.2.2" xref="S2.E2.m1.5.5.5.5.1.1.1.2.2.cmml">t</mi><mo id="S2.E2.m1.5.5.5.5.1.1.1.2.1" xref="S2.E2.m1.5.5.5.5.1.1.1.2.1.cmml">⁢</mo><mrow id="S2.E2.m1.5.5.5.5.1.1.1.2.3.2" xref="S2.E2.m1.5.5.5.5.1.1.1.2.3.1.cmml"><mo id="S2.E2.m1.5.5.5.5.1.1.1.2.3.2.1" stretchy="false" xref="S2.E2.m1.5.5.5.5.1.1.1.2.3.1.cmml">(</mo><mi id="S2.E2.m1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.cmml">u</mi><mo id="S2.E2.m1.5.5.5.5.1.1.1.2.3.2.2" xref="S2.E2.m1.5.5.5.5.1.1.1.2.3.1.cmml">,</mo><mi id="S2.E2.m1.2.2.2.2" xref="S2.E2.m1.2.2.2.2.cmml">v</mi><mo id="S2.E2.m1.5.5.5.5.1.1.1.2.3.2.3" stretchy="false" xref="S2.E2.m1.5.5.5.5.1.1.1.2.3.1.cmml">)</mo></mrow></mrow><mo id="S2.E2.m1.5.5.5.5.1.1.1.1" xref="S2.E2.m1.5.5.5.5.1.1.1.1.cmml">−</mo><mover accent="true" id="S2.E2.m1.5.5.5.5.1.1.1.3" xref="S2.E2.m1.5.5.5.5.1.1.1.3.cmml"><mi id="S2.E2.m1.5.5.5.5.1.1.1.3.2" xref="S2.E2.m1.5.5.5.5.1.1.1.3.2.cmml">t</mi><mo id="S2.E2.m1.5.5.5.5.1.1.1.3.1" xref="S2.E2.m1.5.5.5.5.1.1.1.3.1.cmml">¯</mo></mover></mrow><mo id="S2.E2.m1.5.5.5.5.1.1.3" stretchy="false" xref="S2.E2.m1.5.5.5.5.1.1.1.cmml">)</mo></mrow><mo id="S2.E2.m1.6.6.6.6.3" xref="S2.E2.m1.6.6.6.6.3.cmml">⁢</mo><mrow id="S2.E2.m1.6.6.6.6.2.1" xref="S2.E2.m1.6.6.6.6.2.1.1.cmml"><mo id="S2.E2.m1.6.6.6.6.2.1.2" stretchy="false" xref="S2.E2.m1.6.6.6.6.2.1.1.cmml">(</mo><mrow id="S2.E2.m1.6.6.6.6.2.1.1" xref="S2.E2.m1.6.6.6.6.2.1.1.cmml"><mrow id="S2.E2.m1.6.6.6.6.2.1.1.2" xref="S2.E2.m1.6.6.6.6.2.1.1.2.cmml"><mi id="S2.E2.m1.6.6.6.6.2.1.1.2.2" xref="S2.E2.m1.6.6.6.6.2.1.1.2.2.cmml">ρ</mi><mo id="S2.E2.m1.6.6.6.6.2.1.1.2.1" xref="S2.E2.m1.6.6.6.6.2.1.1.2.1.cmml">⁢</mo><mrow id="S2.E2.m1.6.6.6.6.2.1.1.2.3.2" xref="S2.E2.m1.6.6.6.6.2.1.1.2.3.1.cmml"><mo id="S2.E2.m1.6.6.6.6.2.1.1.2.3.2.1" stretchy="false" xref="S2.E2.m1.6.6.6.6.2.1.1.2.3.1.cmml">(</mo><mi id="S2.E2.m1.3.3.3.3" xref="S2.E2.m1.3.3.3.3.cmml">u</mi><mo id="S2.E2.m1.6.6.6.6.2.1.1.2.3.2.2" xref="S2.E2.m1.6.6.6.6.2.1.1.2.3.1.cmml">,</mo><mi id="S2.E2.m1.4.4.4.4" xref="S2.E2.m1.4.4.4.4.cmml">v</mi><mo id="S2.E2.m1.6.6.6.6.2.1.1.2.3.2.3" stretchy="false" xref="S2.E2.m1.6.6.6.6.2.1.1.2.3.1.cmml">)</mo></mrow></mrow><mo id="S2.E2.m1.6.6.6.6.2.1.1.1" xref="S2.E2.m1.6.6.6.6.2.1.1.1.cmml">−</mo><mover accent="true" id="S2.E2.m1.6.6.6.6.2.1.1.3" xref="S2.E2.m1.6.6.6.6.2.1.1.3.cmml"><mi id="S2.E2.m1.6.6.6.6.2.1.1.3.2" xref="S2.E2.m1.6.6.6.6.2.1.1.3.2.cmml">ρ</mi><mo id="S2.E2.m1.6.6.6.6.2.1.1.3.1" xref="S2.E2.m1.6.6.6.6.2.1.1.3.1.cmml">¯</mo></mover></mrow><mo id="S2.E2.m1.6.6.6.6.2.1.3" stretchy="false" xref="S2.E2.m1.6.6.6.6.2.1.1.cmml">)</mo></mrow></mrow></mrow><mrow id="S2.E2.m1.12.12.12" xref="S2.E2.m1.12.12.12.cmml"><msup id="S2.E2.m1.11.11.11.5" xref="S2.E2.m1.11.11.11.5.cmml"><mrow id="S2.E2.m1.11.11.11.5.1.1" xref="S2.E2.m1.11.11.11.5.1.1.1.cmml"><mo id="S2.E2.m1.11.11.11.5.1.1.2" stretchy="false" xref="S2.E2.m1.11.11.11.5.1.1.1.cmml">(</mo><mrow id="S2.E2.m1.11.11.11.5.1.1.1" xref="S2.E2.m1.11.11.11.5.1.1.1.cmml"><munder id="S2.E2.m1.11.11.11.5.1.1.1.2" xref="S2.E2.m1.11.11.11.5.1.1.1.2.cmml"><mo id="S2.E2.m1.11.11.11.5.1.1.1.2.2" lspace="0em" movablelimits="false" rspace="0em" xref="S2.E2.m1.11.11.11.5.1.1.1.2.2.cmml">∑</mo><mrow id="S2.E2.m1.11.11.11.5.1.1.1.2.3" xref="S2.E2.m1.11.11.11.5.1.1.1.2.3.cmml"><mi id="S2.E2.m1.11.11.11.5.1.1.1.2.3.2" xref="S2.E2.m1.11.11.11.5.1.1.1.2.3.2.cmml">u</mi><mo id="S2.E2.m1.11.11.11.5.1.1.1.2.3.1" xref="S2.E2.m1.11.11.11.5.1.1.1.2.3.1.cmml">&lt;</mo><mi id="S2.E2.m1.11.11.11.5.1.1.1.2.3.3" xref="S2.E2.m1.11.11.11.5.1.1.1.2.3.3.cmml">v</mi></mrow></munder><msup id="S2.E2.m1.11.11.11.5.1.1.1.1" xref="S2.E2.m1.11.11.11.5.1.1.1.1.cmml"><mrow id="S2.E2.m1.11.11.11.5.1.1.1.1.1.1" xref="S2.E2.m1.11.11.11.5.1.1.1.1.1.1.1.cmml"><mo id="S2.E2.m1.11.11.11.5.1.1.1.1.1.1.2" stretchy="false" xref="S2.E2.m1.11.11.11.5.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E2.m1.11.11.11.5.1.1.1.1.1.1.1" xref="S2.E2.m1.11.11.11.5.1.1.1.1.1.1.1.cmml"><mrow id="S2.E2.m1.11.11.11.5.1.1.1.1.1.1.1.2" xref="S2.E2.m1.11.11.11.5.1.1.1.1.1.1.1.2.cmml"><mi id="S2.E2.m1.11.11.11.5.1.1.1.1.1.1.1.2.2" xref="S2.E2.m1.11.11.11.5.1.1.1.1.1.1.1.2.2.cmml">t</mi><mo id="S2.E2.m1.11.11.11.5.1.1.1.1.1.1.1.2.1" xref="S2.E2.m1.11.11.11.5.1.1.1.1.1.1.1.2.1.cmml">⁢</mo><mrow id="S2.E2.m1.11.11.11.5.1.1.1.1.1.1.1.2.3.2" xref="S2.E2.m1.11.11.11.5.1.1.1.1.1.1.1.2.3.1.cmml"><mo id="S2.E2.m1.11.11.11.5.1.1.1.1.1.1.1.2.3.2.1" stretchy="false" xref="S2.E2.m1.11.11.11.5.1.1.1.1.1.1.1.2.3.1.cmml">(</mo><mi id="S2.E2.m1.7.7.7.1" xref="S2.E2.m1.7.7.7.1.cmml">u</mi><mo id="S2.E2.m1.11.11.11.5.1.1.1.1.1.1.1.2.3.2.2" xref="S2.E2.m1.11.11.11.5.1.1.1.1.1.1.1.2.3.1.cmml">,</mo><mi id="S2.E2.m1.8.8.8.2" xref="S2.E2.m1.8.8.8.2.cmml">v</mi><mo id="S2.E2.m1.11.11.11.5.1.1.1.1.1.1.1.2.3.2.3" stretchy="false" xref="S2.E2.m1.11.11.11.5.1.1.1.1.1.1.1.2.3.1.cmml">)</mo></mrow></mrow><mo id="S2.E2.m1.11.11.11.5.1.1.1.1.1.1.1.1" xref="S2.E2.m1.11.11.11.5.1.1.1.1.1.1.1.1.cmml">−</mo><mover accent="true" id="S2.E2.m1.11.11.11.5.1.1.1.1.1.1.1.3" xref="S2.E2.m1.11.11.11.5.1.1.1.1.1.1.1.3.cmml"><mi id="S2.E2.m1.11.11.11.5.1.1.1.1.1.1.1.3.2" xref="S2.E2.m1.11.11.11.5.1.1.1.1.1.1.1.3.2.cmml">t</mi><mo id="S2.E2.m1.11.11.11.5.1.1.1.1.1.1.1.3.1" xref="S2.E2.m1.11.11.11.5.1.1.1.1.1.1.1.3.1.cmml">¯</mo></mover></mrow><mo id="S2.E2.m1.11.11.11.5.1.1.1.1.1.1.3" stretchy="false" xref="S2.E2.m1.11.11.11.5.1.1.1.1.1.1.1.cmml">)</mo></mrow><mn id="S2.E2.m1.11.11.11.5.1.1.1.1.3" xref="S2.E2.m1.11.11.11.5.1.1.1.1.3.cmml">2</mn></msup></mrow><mo id="S2.E2.m1.11.11.11.5.1.1.3" stretchy="false" xref="S2.E2.m1.11.11.11.5.1.1.1.cmml">)</mo></mrow><mrow id="S2.E2.m1.11.11.11.5.3" xref="S2.E2.m1.11.11.11.5.3.cmml"><mo id="S2.E2.m1.11.11.11.5.3a" xref="S2.E2.m1.11.11.11.5.3.cmml">−</mo><mrow id="S2.E2.m1.11.11.11.5.3.2" xref="S2.E2.m1.11.11.11.5.3.2.cmml"><mn id="S2.E2.m1.11.11.11.5.3.2.2" xref="S2.E2.m1.11.11.11.5.3.2.2.cmml">1</mn><mo id="S2.E2.m1.11.11.11.5.3.2.1" xref="S2.E2.m1.11.11.11.5.3.2.1.cmml">/</mo><mn id="S2.E2.m1.11.11.11.5.3.2.3" xref="S2.E2.m1.11.11.11.5.3.2.3.cmml">2</mn></mrow></mrow></msup><mo id="S2.E2.m1.12.12.12.7" xref="S2.E2.m1.12.12.12.7.cmml">⁢</mo><msup id="S2.E2.m1.12.12.12.6" xref="S2.E2.m1.12.12.12.6.cmml"><mrow id="S2.E2.m1.12.12.12.6.1.1" xref="S2.E2.m1.12.12.12.6.1.1.1.cmml"><mo id="S2.E2.m1.12.12.12.6.1.1.2" stretchy="false" xref="S2.E2.m1.12.12.12.6.1.1.1.cmml">(</mo><mrow id="S2.E2.m1.12.12.12.6.1.1.1" xref="S2.E2.m1.12.12.12.6.1.1.1.cmml"><munder id="S2.E2.m1.12.12.12.6.1.1.1.2" xref="S2.E2.m1.12.12.12.6.1.1.1.2.cmml"><mo id="S2.E2.m1.12.12.12.6.1.1.1.2.2" lspace="0em" movablelimits="false" rspace="0em" xref="S2.E2.m1.12.12.12.6.1.1.1.2.2.cmml">∑</mo><mrow id="S2.E2.m1.12.12.12.6.1.1.1.2.3" xref="S2.E2.m1.12.12.12.6.1.1.1.2.3.cmml"><mi id="S2.E2.m1.12.12.12.6.1.1.1.2.3.2" xref="S2.E2.m1.12.12.12.6.1.1.1.2.3.2.cmml">u</mi><mo id="S2.E2.m1.12.12.12.6.1.1.1.2.3.1" xref="S2.E2.m1.12.12.12.6.1.1.1.2.3.1.cmml">&lt;</mo><mi id="S2.E2.m1.12.12.12.6.1.1.1.2.3.3" xref="S2.E2.m1.12.12.12.6.1.1.1.2.3.3.cmml">v</mi></mrow></munder><msup id="S2.E2.m1.12.12.12.6.1.1.1.1" xref="S2.E2.m1.12.12.12.6.1.1.1.1.cmml"><mrow id="S2.E2.m1.12.12.12.6.1.1.1.1.1.1" xref="S2.E2.m1.12.12.12.6.1.1.1.1.1.1.1.cmml"><mo id="S2.E2.m1.12.12.12.6.1.1.1.1.1.1.2" stretchy="false" xref="S2.E2.m1.12.12.12.6.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E2.m1.12.12.12.6.1.1.1.1.1.1.1" xref="S2.E2.m1.12.12.12.6.1.1.1.1.1.1.1.cmml"><mrow id="S2.E2.m1.12.12.12.6.1.1.1.1.1.1.1.2" xref="S2.E2.m1.12.12.12.6.1.1.1.1.1.1.1.2.cmml"><mi id="S2.E2.m1.12.12.12.6.1.1.1.1.1.1.1.2.2" xref="S2.E2.m1.12.12.12.6.1.1.1.1.1.1.1.2.2.cmml">ρ</mi><mo id="S2.E2.m1.12.12.12.6.1.1.1.1.1.1.1.2.1" xref="S2.E2.m1.12.12.12.6.1.1.1.1.1.1.1.2.1.cmml">⁢</mo><mrow id="S2.E2.m1.12.12.12.6.1.1.1.1.1.1.1.2.3.2" xref="S2.E2.m1.12.12.12.6.1.1.1.1.1.1.1.2.3.1.cmml"><mo id="S2.E2.m1.12.12.12.6.1.1.1.1.1.1.1.2.3.2.1" stretchy="false" xref="S2.E2.m1.12.12.12.6.1.1.1.1.1.1.1.2.3.1.cmml">(</mo><mi id="S2.E2.m1.9.9.9.3" xref="S2.E2.m1.9.9.9.3.cmml">u</mi><mo id="S2.E2.m1.12.12.12.6.1.1.1.1.1.1.1.2.3.2.2" xref="S2.E2.m1.12.12.12.6.1.1.1.1.1.1.1.2.3.1.cmml">,</mo><mi id="S2.E2.m1.10.10.10.4" xref="S2.E2.m1.10.10.10.4.cmml">v</mi><mo id="S2.E2.m1.12.12.12.6.1.1.1.1.1.1.1.2.3.2.3" stretchy="false" xref="S2.E2.m1.12.12.12.6.1.1.1.1.1.1.1.2.3.1.cmml">)</mo></mrow></mrow><mo id="S2.E2.m1.12.12.12.6.1.1.1.1.1.1.1.1" xref="S2.E2.m1.12.12.12.6.1.1.1.1.1.1.1.1.cmml">−</mo><mover accent="true" id="S2.E2.m1.12.12.12.6.1.1.1.1.1.1.1.3" xref="S2.E2.m1.12.12.12.6.1.1.1.1.1.1.1.3.cmml"><mi id="S2.E2.m1.12.12.12.6.1.1.1.1.1.1.1.3.2" xref="S2.E2.m1.12.12.12.6.1.1.1.1.1.1.1.3.2.cmml">ρ</mi><mo id="S2.E2.m1.12.12.12.6.1.1.1.1.1.1.1.3.1" xref="S2.E2.m1.12.12.12.6.1.1.1.1.1.1.1.3.1.cmml">¯</mo></mover></mrow><mo id="S2.E2.m1.12.12.12.6.1.1.1.1.1.1.3" stretchy="false" xref="S2.E2.m1.12.12.12.6.1.1.1.1.1.1.1.cmml">)</mo></mrow><mn id="S2.E2.m1.12.12.12.6.1.1.1.1.3" xref="S2.E2.m1.12.12.12.6.1.1.1.1.3.cmml">2</mn></msup></mrow><mo id="S2.E2.m1.12.12.12.6.1.1.3" stretchy="false" xref="S2.E2.m1.12.12.12.6.1.1.1.cmml">)</mo></mrow><mrow id="S2.E2.m1.12.12.12.6.3" xref="S2.E2.m1.12.12.12.6.3.cmml"><mo id="S2.E2.m1.12.12.12.6.3a" xref="S2.E2.m1.12.12.12.6.3.cmml">−</mo><mrow id="S2.E2.m1.12.12.12.6.3.2" xref="S2.E2.m1.12.12.12.6.3.2.cmml"><mn id="S2.E2.m1.12.12.12.6.3.2.2" xref="S2.E2.m1.12.12.12.6.3.2.2.cmml">1</mn><mo id="S2.E2.m1.12.12.12.6.3.2.1" xref="S2.E2.m1.12.12.12.6.3.2.1.cmml">/</mo><mn id="S2.E2.m1.12.12.12.6.3.2.3" xref="S2.E2.m1.12.12.12.6.3.2.3.cmml">2</mn></mrow></mrow></msup></mrow></mfrac></mrow><mo id="S2.E2.m1.15.15.1.2" xref="S2.E2.m1.15.15.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E2.m1.15b"><apply id="S2.E2.m1.15.15.1.1.cmml" xref="S2.E2.m1.15.15.1"><eq id="S2.E2.m1.15.15.1.1.1.cmml" xref="S2.E2.m1.15.15.1.1.1"></eq><apply id="S2.E2.m1.15.15.1.1.2.cmml" xref="S2.E2.m1.15.15.1.1.2"><times id="S2.E2.m1.15.15.1.1.2.1.cmml" xref="S2.E2.m1.15.15.1.1.2.1"></times><ci id="S2.E2.m1.15.15.1.1.2.2a.cmml" xref="S2.E2.m1.15.15.1.1.2.2"><mtext id="S2.E2.m1.15.15.1.1.2.2.cmml" xref="S2.E2.m1.15.15.1.1.2.2">CPCC</mtext></ci><interval closure="open" id="S2.E2.m1.15.15.1.1.2.3.1.cmml" xref="S2.E2.m1.15.15.1.1.2.3.2"><ci id="S2.E2.m1.13.13.cmml" xref="S2.E2.m1.13.13">𝑡</ci><ci id="S2.E2.m1.14.14.cmml" xref="S2.E2.m1.14.14">𝜌</ci></interval></apply><apply id="S2.E2.m1.12.12.cmml" xref="S2.E2.m1.12.12"><divide id="S2.E2.m1.12.12.13.cmml" xref="S2.E2.m1.12.12"></divide><apply id="S2.E2.m1.6.6.6.cmml" xref="S2.E2.m1.6.6.6"><apply id="S2.E2.m1.6.6.6.7.cmml" xref="S2.E2.m1.6.6.6.7"><csymbol cd="ambiguous" id="S2.E2.m1.6.6.6.7.1.cmml" xref="S2.E2.m1.6.6.6.7">subscript</csymbol><sum id="S2.E2.m1.6.6.6.7.2.cmml" xref="S2.E2.m1.6.6.6.7.2"></sum><apply id="S2.E2.m1.6.6.6.7.3.cmml" xref="S2.E2.m1.6.6.6.7.3"><lt id="S2.E2.m1.6.6.6.7.3.1.cmml" xref="S2.E2.m1.6.6.6.7.3.1"></lt><ci id="S2.E2.m1.6.6.6.7.3.2.cmml" xref="S2.E2.m1.6.6.6.7.3.2">𝑢</ci><ci id="S2.E2.m1.6.6.6.7.3.3.cmml" xref="S2.E2.m1.6.6.6.7.3.3">𝑣</ci></apply></apply><apply id="S2.E2.m1.6.6.6.6.cmml" xref="S2.E2.m1.6.6.6.6"><times id="S2.E2.m1.6.6.6.6.3.cmml" xref="S2.E2.m1.6.6.6.6.3"></times><apply id="S2.E2.m1.5.5.5.5.1.1.1.cmml" xref="S2.E2.m1.5.5.5.5.1.1"><minus id="S2.E2.m1.5.5.5.5.1.1.1.1.cmml" xref="S2.E2.m1.5.5.5.5.1.1.1.1"></minus><apply id="S2.E2.m1.5.5.5.5.1.1.1.2.cmml" xref="S2.E2.m1.5.5.5.5.1.1.1.2"><times id="S2.E2.m1.5.5.5.5.1.1.1.2.1.cmml" xref="S2.E2.m1.5.5.5.5.1.1.1.2.1"></times><ci id="S2.E2.m1.5.5.5.5.1.1.1.2.2.cmml" xref="S2.E2.m1.5.5.5.5.1.1.1.2.2">𝑡</ci><interval closure="open" id="S2.E2.m1.5.5.5.5.1.1.1.2.3.1.cmml" xref="S2.E2.m1.5.5.5.5.1.1.1.2.3.2"><ci id="S2.E2.m1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1">𝑢</ci><ci id="S2.E2.m1.2.2.2.2.cmml" xref="S2.E2.m1.2.2.2.2">𝑣</ci></interval></apply><apply id="S2.E2.m1.5.5.5.5.1.1.1.3.cmml" xref="S2.E2.m1.5.5.5.5.1.1.1.3"><ci id="S2.E2.m1.5.5.5.5.1.1.1.3.1.cmml" xref="S2.E2.m1.5.5.5.5.1.1.1.3.1">¯</ci><ci id="S2.E2.m1.5.5.5.5.1.1.1.3.2.cmml" xref="S2.E2.m1.5.5.5.5.1.1.1.3.2">𝑡</ci></apply></apply><apply id="S2.E2.m1.6.6.6.6.2.1.1.cmml" xref="S2.E2.m1.6.6.6.6.2.1"><minus id="S2.E2.m1.6.6.6.6.2.1.1.1.cmml" xref="S2.E2.m1.6.6.6.6.2.1.1.1"></minus><apply id="S2.E2.m1.6.6.6.6.2.1.1.2.cmml" xref="S2.E2.m1.6.6.6.6.2.1.1.2"><times id="S2.E2.m1.6.6.6.6.2.1.1.2.1.cmml" xref="S2.E2.m1.6.6.6.6.2.1.1.2.1"></times><ci id="S2.E2.m1.6.6.6.6.2.1.1.2.2.cmml" xref="S2.E2.m1.6.6.6.6.2.1.1.2.2">𝜌</ci><interval closure="open" id="S2.E2.m1.6.6.6.6.2.1.1.2.3.1.cmml" xref="S2.E2.m1.6.6.6.6.2.1.1.2.3.2"><ci id="S2.E2.m1.3.3.3.3.cmml" xref="S2.E2.m1.3.3.3.3">𝑢</ci><ci id="S2.E2.m1.4.4.4.4.cmml" xref="S2.E2.m1.4.4.4.4">𝑣</ci></interval></apply><apply id="S2.E2.m1.6.6.6.6.2.1.1.3.cmml" xref="S2.E2.m1.6.6.6.6.2.1.1.3"><ci id="S2.E2.m1.6.6.6.6.2.1.1.3.1.cmml" xref="S2.E2.m1.6.6.6.6.2.1.1.3.1">¯</ci><ci id="S2.E2.m1.6.6.6.6.2.1.1.3.2.cmml" xref="S2.E2.m1.6.6.6.6.2.1.1.3.2">𝜌</ci></apply></apply></apply></apply><apply id="S2.E2.m1.12.12.12.cmml" xref="S2.E2.m1.12.12.12"><times id="S2.E2.m1.12.12.12.7.cmml" xref="S2.E2.m1.12.12.12.7"></times><apply id="S2.E2.m1.11.11.11.5.cmml" xref="S2.E2.m1.11.11.11.5"><csymbol cd="ambiguous" id="S2.E2.m1.11.11.11.5.2.cmml" xref="S2.E2.m1.11.11.11.5">superscript</csymbol><apply id="S2.E2.m1.11.11.11.5.1.1.1.cmml" xref="S2.E2.m1.11.11.11.5.1.1"><apply id="S2.E2.m1.11.11.11.5.1.1.1.2.cmml" xref="S2.E2.m1.11.11.11.5.1.1.1.2"><csymbol cd="ambiguous" id="S2.E2.m1.11.11.11.5.1.1.1.2.1.cmml" xref="S2.E2.m1.11.11.11.5.1.1.1.2">subscript</csymbol><sum id="S2.E2.m1.11.11.11.5.1.1.1.2.2.cmml" xref="S2.E2.m1.11.11.11.5.1.1.1.2.2"></sum><apply id="S2.E2.m1.11.11.11.5.1.1.1.2.3.cmml" xref="S2.E2.m1.11.11.11.5.1.1.1.2.3"><lt id="S2.E2.m1.11.11.11.5.1.1.1.2.3.1.cmml" xref="S2.E2.m1.11.11.11.5.1.1.1.2.3.1"></lt><ci id="S2.E2.m1.11.11.11.5.1.1.1.2.3.2.cmml" xref="S2.E2.m1.11.11.11.5.1.1.1.2.3.2">𝑢</ci><ci id="S2.E2.m1.11.11.11.5.1.1.1.2.3.3.cmml" xref="S2.E2.m1.11.11.11.5.1.1.1.2.3.3">𝑣</ci></apply></apply><apply id="S2.E2.m1.11.11.11.5.1.1.1.1.cmml" xref="S2.E2.m1.11.11.11.5.1.1.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.11.11.11.5.1.1.1.1.2.cmml" xref="S2.E2.m1.11.11.11.5.1.1.1.1">superscript</csymbol><apply id="S2.E2.m1.11.11.11.5.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.11.11.11.5.1.1.1.1.1.1"><minus id="S2.E2.m1.11.11.11.5.1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.11.11.11.5.1.1.1.1.1.1.1.1"></minus><apply id="S2.E2.m1.11.11.11.5.1.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.11.11.11.5.1.1.1.1.1.1.1.2"><times id="S2.E2.m1.11.11.11.5.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E2.m1.11.11.11.5.1.1.1.1.1.1.1.2.1"></times><ci id="S2.E2.m1.11.11.11.5.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E2.m1.11.11.11.5.1.1.1.1.1.1.1.2.2">𝑡</ci><interval closure="open" id="S2.E2.m1.11.11.11.5.1.1.1.1.1.1.1.2.3.1.cmml" xref="S2.E2.m1.11.11.11.5.1.1.1.1.1.1.1.2.3.2"><ci id="S2.E2.m1.7.7.7.1.cmml" xref="S2.E2.m1.7.7.7.1">𝑢</ci><ci id="S2.E2.m1.8.8.8.2.cmml" xref="S2.E2.m1.8.8.8.2">𝑣</ci></interval></apply><apply id="S2.E2.m1.11.11.11.5.1.1.1.1.1.1.1.3.cmml" xref="S2.E2.m1.11.11.11.5.1.1.1.1.1.1.1.3"><ci id="S2.E2.m1.11.11.11.5.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E2.m1.11.11.11.5.1.1.1.1.1.1.1.3.1">¯</ci><ci id="S2.E2.m1.11.11.11.5.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E2.m1.11.11.11.5.1.1.1.1.1.1.1.3.2">𝑡</ci></apply></apply><cn id="S2.E2.m1.11.11.11.5.1.1.1.1.3.cmml" type="integer" xref="S2.E2.m1.11.11.11.5.1.1.1.1.3">2</cn></apply></apply><apply id="S2.E2.m1.11.11.11.5.3.cmml" xref="S2.E2.m1.11.11.11.5.3"><minus id="S2.E2.m1.11.11.11.5.3.1.cmml" xref="S2.E2.m1.11.11.11.5.3"></minus><apply id="S2.E2.m1.11.11.11.5.3.2.cmml" xref="S2.E2.m1.11.11.11.5.3.2"><divide id="S2.E2.m1.11.11.11.5.3.2.1.cmml" xref="S2.E2.m1.11.11.11.5.3.2.1"></divide><cn id="S2.E2.m1.11.11.11.5.3.2.2.cmml" type="integer" xref="S2.E2.m1.11.11.11.5.3.2.2">1</cn><cn id="S2.E2.m1.11.11.11.5.3.2.3.cmml" type="integer" xref="S2.E2.m1.11.11.11.5.3.2.3">2</cn></apply></apply></apply><apply id="S2.E2.m1.12.12.12.6.cmml" xref="S2.E2.m1.12.12.12.6"><csymbol cd="ambiguous" id="S2.E2.m1.12.12.12.6.2.cmml" xref="S2.E2.m1.12.12.12.6">superscript</csymbol><apply id="S2.E2.m1.12.12.12.6.1.1.1.cmml" xref="S2.E2.m1.12.12.12.6.1.1"><apply id="S2.E2.m1.12.12.12.6.1.1.1.2.cmml" xref="S2.E2.m1.12.12.12.6.1.1.1.2"><csymbol cd="ambiguous" id="S2.E2.m1.12.12.12.6.1.1.1.2.1.cmml" xref="S2.E2.m1.12.12.12.6.1.1.1.2">subscript</csymbol><sum id="S2.E2.m1.12.12.12.6.1.1.1.2.2.cmml" xref="S2.E2.m1.12.12.12.6.1.1.1.2.2"></sum><apply id="S2.E2.m1.12.12.12.6.1.1.1.2.3.cmml" xref="S2.E2.m1.12.12.12.6.1.1.1.2.3"><lt id="S2.E2.m1.12.12.12.6.1.1.1.2.3.1.cmml" xref="S2.E2.m1.12.12.12.6.1.1.1.2.3.1"></lt><ci id="S2.E2.m1.12.12.12.6.1.1.1.2.3.2.cmml" xref="S2.E2.m1.12.12.12.6.1.1.1.2.3.2">𝑢</ci><ci id="S2.E2.m1.12.12.12.6.1.1.1.2.3.3.cmml" xref="S2.E2.m1.12.12.12.6.1.1.1.2.3.3">𝑣</ci></apply></apply><apply id="S2.E2.m1.12.12.12.6.1.1.1.1.cmml" xref="S2.E2.m1.12.12.12.6.1.1.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.12.12.12.6.1.1.1.1.2.cmml" xref="S2.E2.m1.12.12.12.6.1.1.1.1">superscript</csymbol><apply id="S2.E2.m1.12.12.12.6.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.12.12.12.6.1.1.1.1.1.1"><minus id="S2.E2.m1.12.12.12.6.1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.12.12.12.6.1.1.1.1.1.1.1.1"></minus><apply id="S2.E2.m1.12.12.12.6.1.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.12.12.12.6.1.1.1.1.1.1.1.2"><times id="S2.E2.m1.12.12.12.6.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E2.m1.12.12.12.6.1.1.1.1.1.1.1.2.1"></times><ci id="S2.E2.m1.12.12.12.6.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E2.m1.12.12.12.6.1.1.1.1.1.1.1.2.2">𝜌</ci><interval closure="open" id="S2.E2.m1.12.12.12.6.1.1.1.1.1.1.1.2.3.1.cmml" xref="S2.E2.m1.12.12.12.6.1.1.1.1.1.1.1.2.3.2"><ci id="S2.E2.m1.9.9.9.3.cmml" xref="S2.E2.m1.9.9.9.3">𝑢</ci><ci id="S2.E2.m1.10.10.10.4.cmml" xref="S2.E2.m1.10.10.10.4">𝑣</ci></interval></apply><apply id="S2.E2.m1.12.12.12.6.1.1.1.1.1.1.1.3.cmml" xref="S2.E2.m1.12.12.12.6.1.1.1.1.1.1.1.3"><ci id="S2.E2.m1.12.12.12.6.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E2.m1.12.12.12.6.1.1.1.1.1.1.1.3.1">¯</ci><ci id="S2.E2.m1.12.12.12.6.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E2.m1.12.12.12.6.1.1.1.1.1.1.1.3.2">𝜌</ci></apply></apply><cn id="S2.E2.m1.12.12.12.6.1.1.1.1.3.cmml" type="integer" xref="S2.E2.m1.12.12.12.6.1.1.1.1.3">2</cn></apply></apply><apply id="S2.E2.m1.12.12.12.6.3.cmml" xref="S2.E2.m1.12.12.12.6.3"><minus id="S2.E2.m1.12.12.12.6.3.1.cmml" xref="S2.E2.m1.12.12.12.6.3"></minus><apply id="S2.E2.m1.12.12.12.6.3.2.cmml" xref="S2.E2.m1.12.12.12.6.3.2"><divide id="S2.E2.m1.12.12.12.6.3.2.1.cmml" xref="S2.E2.m1.12.12.12.6.3.2.1"></divide><cn id="S2.E2.m1.12.12.12.6.3.2.2.cmml" type="integer" xref="S2.E2.m1.12.12.12.6.3.2.2">1</cn><cn id="S2.E2.m1.12.12.12.6.3.2.3.cmml" type="integer" xref="S2.E2.m1.12.12.12.6.3.2.3">2</cn></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2.m1.15c">\text{CPCC}(t,\rho)=\frac{\sum\limits_{u&lt;v}(t(u,v)-\bar{t})(\rho(u,v)-\bar{%
\rho})}{(\sum\limits_{u&lt;v}(t(u,v)-\bar{t})^{2})^{-1/2}(\sum\limits_{u&lt;v}(\rho(%
u,v)-\bar{\rho})^{2})^{-1/2}},</annotation><annotation encoding="application/x-llamapun" id="S2.E2.m1.15d">CPCC ( italic_t , italic_ρ ) = divide start_ARG ∑ start_POSTSUBSCRIPT italic_u &lt; italic_v end_POSTSUBSCRIPT ( italic_t ( italic_u , italic_v ) - over¯ start_ARG italic_t end_ARG ) ( italic_ρ ( italic_u , italic_v ) - over¯ start_ARG italic_ρ end_ARG ) end_ARG start_ARG ( ∑ start_POSTSUBSCRIPT italic_u &lt; italic_v end_POSTSUBSCRIPT ( italic_t ( italic_u , italic_v ) - over¯ start_ARG italic_t end_ARG ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT - 1 / 2 end_POSTSUPERSCRIPT ( ∑ start_POSTSUBSCRIPT italic_u &lt; italic_v end_POSTSUBSCRIPT ( italic_ρ ( italic_u , italic_v ) - over¯ start_ARG italic_ρ end_ARG ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT - 1 / 2 end_POSTSUPERSCRIPT end_ARG ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS1.p1.10">where <math alttext="\rho" class="ltx_Math" display="inline" id="S2.SS1.p1.4.m1.1"><semantics id="S2.SS1.p1.4.m1.1a"><mi id="S2.SS1.p1.4.m1.1.1" xref="S2.SS1.p1.4.m1.1.1.cmml">ρ</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.4.m1.1b"><ci id="S2.SS1.p1.4.m1.1.1.cmml" xref="S2.SS1.p1.4.m1.1.1">𝜌</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.4.m1.1c">\rho</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.4.m1.1d">italic_ρ</annotation></semantics></math> is a distance function between <math alttext="u,v" class="ltx_Math" display="inline" id="S2.SS1.p1.5.m2.2"><semantics id="S2.SS1.p1.5.m2.2a"><mrow id="S2.SS1.p1.5.m2.2.3.2" xref="S2.SS1.p1.5.m2.2.3.1.cmml"><mi id="S2.SS1.p1.5.m2.1.1" xref="S2.SS1.p1.5.m2.1.1.cmml">u</mi><mo id="S2.SS1.p1.5.m2.2.3.2.1" xref="S2.SS1.p1.5.m2.2.3.1.cmml">,</mo><mi id="S2.SS1.p1.5.m2.2.2" xref="S2.SS1.p1.5.m2.2.2.cmml">v</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.5.m2.2b"><list id="S2.SS1.p1.5.m2.2.3.1.cmml" xref="S2.SS1.p1.5.m2.2.3.2"><ci id="S2.SS1.p1.5.m2.1.1.cmml" xref="S2.SS1.p1.5.m2.1.1">𝑢</ci><ci id="S2.SS1.p1.5.m2.2.2.cmml" xref="S2.SS1.p1.5.m2.2.2">𝑣</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.5.m2.2c">u,v</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.5.m2.2d">italic_u , italic_v</annotation></semantics></math> on feature space <math alttext="{\mathcal{Z}}" class="ltx_Math" display="inline" id="S2.SS1.p1.6.m3.1"><semantics id="S2.SS1.p1.6.m3.1a"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.6.m3.1.1" xref="S2.SS1.p1.6.m3.1.1.cmml">𝒵</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.6.m3.1b"><ci id="S2.SS1.p1.6.m3.1.1.cmml" xref="S2.SS1.p1.6.m3.1.1">𝒵</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.6.m3.1c">{\mathcal{Z}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.6.m3.1d">caligraphic_Z</annotation></semantics></math>, and <math alttext="\bar{t},\bar{\rho}" class="ltx_Math" display="inline" id="S2.SS1.p1.7.m4.2"><semantics id="S2.SS1.p1.7.m4.2a"><mrow id="S2.SS1.p1.7.m4.2.3.2" xref="S2.SS1.p1.7.m4.2.3.1.cmml"><mover accent="true" id="S2.SS1.p1.7.m4.1.1" xref="S2.SS1.p1.7.m4.1.1.cmml"><mi id="S2.SS1.p1.7.m4.1.1.2" xref="S2.SS1.p1.7.m4.1.1.2.cmml">t</mi><mo id="S2.SS1.p1.7.m4.1.1.1" xref="S2.SS1.p1.7.m4.1.1.1.cmml">¯</mo></mover><mo id="S2.SS1.p1.7.m4.2.3.2.1" xref="S2.SS1.p1.7.m4.2.3.1.cmml">,</mo><mover accent="true" id="S2.SS1.p1.7.m4.2.2" xref="S2.SS1.p1.7.m4.2.2.cmml"><mi id="S2.SS1.p1.7.m4.2.2.2" xref="S2.SS1.p1.7.m4.2.2.2.cmml">ρ</mi><mo id="S2.SS1.p1.7.m4.2.2.1" xref="S2.SS1.p1.7.m4.2.2.1.cmml">¯</mo></mover></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.7.m4.2b"><list id="S2.SS1.p1.7.m4.2.3.1.cmml" xref="S2.SS1.p1.7.m4.2.3.2"><apply id="S2.SS1.p1.7.m4.1.1.cmml" xref="S2.SS1.p1.7.m4.1.1"><ci id="S2.SS1.p1.7.m4.1.1.1.cmml" xref="S2.SS1.p1.7.m4.1.1.1">¯</ci><ci id="S2.SS1.p1.7.m4.1.1.2.cmml" xref="S2.SS1.p1.7.m4.1.1.2">𝑡</ci></apply><apply id="S2.SS1.p1.7.m4.2.2.cmml" xref="S2.SS1.p1.7.m4.2.2"><ci id="S2.SS1.p1.7.m4.2.2.1.cmml" xref="S2.SS1.p1.7.m4.2.2.1">¯</ci><ci id="S2.SS1.p1.7.m4.2.2.2.cmml" xref="S2.SS1.p1.7.m4.2.2.2">𝜌</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.7.m4.2c">\bar{t},\bar{\rho}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.7.m4.2d">over¯ start_ARG italic_t end_ARG , over¯ start_ARG italic_ρ end_ARG</annotation></semantics></math> are the average of each metric. Let <math alttext="{\mathcal{D}}_{u}=\{(x^{u}_{i},u)\}_{i=1}^{m},{\mathcal{D}}_{v}=\{(x^{v}_{i},v%
)\}_{i=1}^{n}\subseteq{\mathcal{D}}" class="ltx_Math" display="inline" id="S2.SS1.p1.8.m5.4"><semantics id="S2.SS1.p1.8.m5.4a"><mrow id="S2.SS1.p1.8.m5.4.4.2" xref="S2.SS1.p1.8.m5.4.4.3.cmml"><mrow id="S2.SS1.p1.8.m5.3.3.1.1" xref="S2.SS1.p1.8.m5.3.3.1.1.cmml"><msub id="S2.SS1.p1.8.m5.3.3.1.1.3" xref="S2.SS1.p1.8.m5.3.3.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.8.m5.3.3.1.1.3.2" xref="S2.SS1.p1.8.m5.3.3.1.1.3.2.cmml">𝒟</mi><mi id="S2.SS1.p1.8.m5.3.3.1.1.3.3" xref="S2.SS1.p1.8.m5.3.3.1.1.3.3.cmml">u</mi></msub><mo id="S2.SS1.p1.8.m5.3.3.1.1.2" xref="S2.SS1.p1.8.m5.3.3.1.1.2.cmml">=</mo><msubsup id="S2.SS1.p1.8.m5.3.3.1.1.1" xref="S2.SS1.p1.8.m5.3.3.1.1.1.cmml"><mrow id="S2.SS1.p1.8.m5.3.3.1.1.1.1.1.1" xref="S2.SS1.p1.8.m5.3.3.1.1.1.1.1.2.cmml"><mo id="S2.SS1.p1.8.m5.3.3.1.1.1.1.1.1.2" stretchy="false" xref="S2.SS1.p1.8.m5.3.3.1.1.1.1.1.2.cmml">{</mo><mrow id="S2.SS1.p1.8.m5.3.3.1.1.1.1.1.1.1.1" xref="S2.SS1.p1.8.m5.3.3.1.1.1.1.1.1.1.2.cmml"><mo id="S2.SS1.p1.8.m5.3.3.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S2.SS1.p1.8.m5.3.3.1.1.1.1.1.1.1.2.cmml">(</mo><msubsup id="S2.SS1.p1.8.m5.3.3.1.1.1.1.1.1.1.1.1" xref="S2.SS1.p1.8.m5.3.3.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.SS1.p1.8.m5.3.3.1.1.1.1.1.1.1.1.1.2.2" xref="S2.SS1.p1.8.m5.3.3.1.1.1.1.1.1.1.1.1.2.2.cmml">x</mi><mi id="S2.SS1.p1.8.m5.3.3.1.1.1.1.1.1.1.1.1.3" xref="S2.SS1.p1.8.m5.3.3.1.1.1.1.1.1.1.1.1.3.cmml">i</mi><mi id="S2.SS1.p1.8.m5.3.3.1.1.1.1.1.1.1.1.1.2.3" xref="S2.SS1.p1.8.m5.3.3.1.1.1.1.1.1.1.1.1.2.3.cmml">u</mi></msubsup><mo id="S2.SS1.p1.8.m5.3.3.1.1.1.1.1.1.1.1.3" xref="S2.SS1.p1.8.m5.3.3.1.1.1.1.1.1.1.2.cmml">,</mo><mi id="S2.SS1.p1.8.m5.1.1" xref="S2.SS1.p1.8.m5.1.1.cmml">u</mi><mo id="S2.SS1.p1.8.m5.3.3.1.1.1.1.1.1.1.1.4" stretchy="false" xref="S2.SS1.p1.8.m5.3.3.1.1.1.1.1.1.1.2.cmml">)</mo></mrow><mo id="S2.SS1.p1.8.m5.3.3.1.1.1.1.1.1.3" stretchy="false" xref="S2.SS1.p1.8.m5.3.3.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S2.SS1.p1.8.m5.3.3.1.1.1.1.3" xref="S2.SS1.p1.8.m5.3.3.1.1.1.1.3.cmml"><mi id="S2.SS1.p1.8.m5.3.3.1.1.1.1.3.2" xref="S2.SS1.p1.8.m5.3.3.1.1.1.1.3.2.cmml">i</mi><mo id="S2.SS1.p1.8.m5.3.3.1.1.1.1.3.1" xref="S2.SS1.p1.8.m5.3.3.1.1.1.1.3.1.cmml">=</mo><mn id="S2.SS1.p1.8.m5.3.3.1.1.1.1.3.3" xref="S2.SS1.p1.8.m5.3.3.1.1.1.1.3.3.cmml">1</mn></mrow><mi id="S2.SS1.p1.8.m5.3.3.1.1.1.3" xref="S2.SS1.p1.8.m5.3.3.1.1.1.3.cmml">m</mi></msubsup></mrow><mo id="S2.SS1.p1.8.m5.4.4.2.3" xref="S2.SS1.p1.8.m5.4.4.3a.cmml">,</mo><mrow id="S2.SS1.p1.8.m5.4.4.2.2" xref="S2.SS1.p1.8.m5.4.4.2.2.cmml"><msub id="S2.SS1.p1.8.m5.4.4.2.2.3" xref="S2.SS1.p1.8.m5.4.4.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.8.m5.4.4.2.2.3.2" xref="S2.SS1.p1.8.m5.4.4.2.2.3.2.cmml">𝒟</mi><mi id="S2.SS1.p1.8.m5.4.4.2.2.3.3" xref="S2.SS1.p1.8.m5.4.4.2.2.3.3.cmml">v</mi></msub><mo id="S2.SS1.p1.8.m5.4.4.2.2.4" xref="S2.SS1.p1.8.m5.4.4.2.2.4.cmml">=</mo><msubsup id="S2.SS1.p1.8.m5.4.4.2.2.1" xref="S2.SS1.p1.8.m5.4.4.2.2.1.cmml"><mrow id="S2.SS1.p1.8.m5.4.4.2.2.1.1.1.1" xref="S2.SS1.p1.8.m5.4.4.2.2.1.1.1.2.cmml"><mo id="S2.SS1.p1.8.m5.4.4.2.2.1.1.1.1.2" stretchy="false" xref="S2.SS1.p1.8.m5.4.4.2.2.1.1.1.2.cmml">{</mo><mrow id="S2.SS1.p1.8.m5.4.4.2.2.1.1.1.1.1.1" xref="S2.SS1.p1.8.m5.4.4.2.2.1.1.1.1.1.2.cmml"><mo id="S2.SS1.p1.8.m5.4.4.2.2.1.1.1.1.1.1.2" stretchy="false" xref="S2.SS1.p1.8.m5.4.4.2.2.1.1.1.1.1.2.cmml">(</mo><msubsup id="S2.SS1.p1.8.m5.4.4.2.2.1.1.1.1.1.1.1" xref="S2.SS1.p1.8.m5.4.4.2.2.1.1.1.1.1.1.1.cmml"><mi id="S2.SS1.p1.8.m5.4.4.2.2.1.1.1.1.1.1.1.2.2" xref="S2.SS1.p1.8.m5.4.4.2.2.1.1.1.1.1.1.1.2.2.cmml">x</mi><mi id="S2.SS1.p1.8.m5.4.4.2.2.1.1.1.1.1.1.1.3" xref="S2.SS1.p1.8.m5.4.4.2.2.1.1.1.1.1.1.1.3.cmml">i</mi><mi id="S2.SS1.p1.8.m5.4.4.2.2.1.1.1.1.1.1.1.2.3" xref="S2.SS1.p1.8.m5.4.4.2.2.1.1.1.1.1.1.1.2.3.cmml">v</mi></msubsup><mo id="S2.SS1.p1.8.m5.4.4.2.2.1.1.1.1.1.1.3" xref="S2.SS1.p1.8.m5.4.4.2.2.1.1.1.1.1.2.cmml">,</mo><mi id="S2.SS1.p1.8.m5.2.2" xref="S2.SS1.p1.8.m5.2.2.cmml">v</mi><mo id="S2.SS1.p1.8.m5.4.4.2.2.1.1.1.1.1.1.4" stretchy="false" xref="S2.SS1.p1.8.m5.4.4.2.2.1.1.1.1.1.2.cmml">)</mo></mrow><mo id="S2.SS1.p1.8.m5.4.4.2.2.1.1.1.1.3" stretchy="false" xref="S2.SS1.p1.8.m5.4.4.2.2.1.1.1.2.cmml">}</mo></mrow><mrow id="S2.SS1.p1.8.m5.4.4.2.2.1.1.3" xref="S2.SS1.p1.8.m5.4.4.2.2.1.1.3.cmml"><mi id="S2.SS1.p1.8.m5.4.4.2.2.1.1.3.2" xref="S2.SS1.p1.8.m5.4.4.2.2.1.1.3.2.cmml">i</mi><mo id="S2.SS1.p1.8.m5.4.4.2.2.1.1.3.1" xref="S2.SS1.p1.8.m5.4.4.2.2.1.1.3.1.cmml">=</mo><mn id="S2.SS1.p1.8.m5.4.4.2.2.1.1.3.3" xref="S2.SS1.p1.8.m5.4.4.2.2.1.1.3.3.cmml">1</mn></mrow><mi id="S2.SS1.p1.8.m5.4.4.2.2.1.3" xref="S2.SS1.p1.8.m5.4.4.2.2.1.3.cmml">n</mi></msubsup><mo id="S2.SS1.p1.8.m5.4.4.2.2.5" xref="S2.SS1.p1.8.m5.4.4.2.2.5.cmml">⊆</mo><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.8.m5.4.4.2.2.6" xref="S2.SS1.p1.8.m5.4.4.2.2.6.cmml">𝒟</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.8.m5.4b"><apply id="S2.SS1.p1.8.m5.4.4.3.cmml" xref="S2.SS1.p1.8.m5.4.4.2"><csymbol cd="ambiguous" id="S2.SS1.p1.8.m5.4.4.3a.cmml" xref="S2.SS1.p1.8.m5.4.4.2.3">formulae-sequence</csymbol><apply id="S2.SS1.p1.8.m5.3.3.1.1.cmml" xref="S2.SS1.p1.8.m5.3.3.1.1"><eq id="S2.SS1.p1.8.m5.3.3.1.1.2.cmml" xref="S2.SS1.p1.8.m5.3.3.1.1.2"></eq><apply id="S2.SS1.p1.8.m5.3.3.1.1.3.cmml" xref="S2.SS1.p1.8.m5.3.3.1.1.3"><csymbol cd="ambiguous" id="S2.SS1.p1.8.m5.3.3.1.1.3.1.cmml" xref="S2.SS1.p1.8.m5.3.3.1.1.3">subscript</csymbol><ci id="S2.SS1.p1.8.m5.3.3.1.1.3.2.cmml" xref="S2.SS1.p1.8.m5.3.3.1.1.3.2">𝒟</ci><ci id="S2.SS1.p1.8.m5.3.3.1.1.3.3.cmml" xref="S2.SS1.p1.8.m5.3.3.1.1.3.3">𝑢</ci></apply><apply id="S2.SS1.p1.8.m5.3.3.1.1.1.cmml" xref="S2.SS1.p1.8.m5.3.3.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.8.m5.3.3.1.1.1.2.cmml" xref="S2.SS1.p1.8.m5.3.3.1.1.1">superscript</csymbol><apply id="S2.SS1.p1.8.m5.3.3.1.1.1.1.cmml" xref="S2.SS1.p1.8.m5.3.3.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.8.m5.3.3.1.1.1.1.2.cmml" xref="S2.SS1.p1.8.m5.3.3.1.1.1">subscript</csymbol><set id="S2.SS1.p1.8.m5.3.3.1.1.1.1.1.2.cmml" xref="S2.SS1.p1.8.m5.3.3.1.1.1.1.1.1"><interval closure="open" id="S2.SS1.p1.8.m5.3.3.1.1.1.1.1.1.1.2.cmml" xref="S2.SS1.p1.8.m5.3.3.1.1.1.1.1.1.1.1"><apply id="S2.SS1.p1.8.m5.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="S2.SS1.p1.8.m5.3.3.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.8.m5.3.3.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.SS1.p1.8.m5.3.3.1.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="S2.SS1.p1.8.m5.3.3.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.SS1.p1.8.m5.3.3.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.8.m5.3.3.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.SS1.p1.8.m5.3.3.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S2.SS1.p1.8.m5.3.3.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.SS1.p1.8.m5.3.3.1.1.1.1.1.1.1.1.1.2.2">𝑥</ci><ci id="S2.SS1.p1.8.m5.3.3.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.SS1.p1.8.m5.3.3.1.1.1.1.1.1.1.1.1.2.3">𝑢</ci></apply><ci id="S2.SS1.p1.8.m5.3.3.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.SS1.p1.8.m5.3.3.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><ci id="S2.SS1.p1.8.m5.1.1.cmml" xref="S2.SS1.p1.8.m5.1.1">𝑢</ci></interval></set><apply id="S2.SS1.p1.8.m5.3.3.1.1.1.1.3.cmml" xref="S2.SS1.p1.8.m5.3.3.1.1.1.1.3"><eq id="S2.SS1.p1.8.m5.3.3.1.1.1.1.3.1.cmml" xref="S2.SS1.p1.8.m5.3.3.1.1.1.1.3.1"></eq><ci id="S2.SS1.p1.8.m5.3.3.1.1.1.1.3.2.cmml" xref="S2.SS1.p1.8.m5.3.3.1.1.1.1.3.2">𝑖</ci><cn id="S2.SS1.p1.8.m5.3.3.1.1.1.1.3.3.cmml" type="integer" xref="S2.SS1.p1.8.m5.3.3.1.1.1.1.3.3">1</cn></apply></apply><ci id="S2.SS1.p1.8.m5.3.3.1.1.1.3.cmml" xref="S2.SS1.p1.8.m5.3.3.1.1.1.3">𝑚</ci></apply></apply><apply id="S2.SS1.p1.8.m5.4.4.2.2.cmml" xref="S2.SS1.p1.8.m5.4.4.2.2"><and id="S2.SS1.p1.8.m5.4.4.2.2a.cmml" xref="S2.SS1.p1.8.m5.4.4.2.2"></and><apply id="S2.SS1.p1.8.m5.4.4.2.2b.cmml" xref="S2.SS1.p1.8.m5.4.4.2.2"><eq id="S2.SS1.p1.8.m5.4.4.2.2.4.cmml" xref="S2.SS1.p1.8.m5.4.4.2.2.4"></eq><apply id="S2.SS1.p1.8.m5.4.4.2.2.3.cmml" xref="S2.SS1.p1.8.m5.4.4.2.2.3"><csymbol cd="ambiguous" id="S2.SS1.p1.8.m5.4.4.2.2.3.1.cmml" xref="S2.SS1.p1.8.m5.4.4.2.2.3">subscript</csymbol><ci id="S2.SS1.p1.8.m5.4.4.2.2.3.2.cmml" xref="S2.SS1.p1.8.m5.4.4.2.2.3.2">𝒟</ci><ci id="S2.SS1.p1.8.m5.4.4.2.2.3.3.cmml" xref="S2.SS1.p1.8.m5.4.4.2.2.3.3">𝑣</ci></apply><apply id="S2.SS1.p1.8.m5.4.4.2.2.1.cmml" xref="S2.SS1.p1.8.m5.4.4.2.2.1"><csymbol cd="ambiguous" id="S2.SS1.p1.8.m5.4.4.2.2.1.2.cmml" xref="S2.SS1.p1.8.m5.4.4.2.2.1">superscript</csymbol><apply id="S2.SS1.p1.8.m5.4.4.2.2.1.1.cmml" xref="S2.SS1.p1.8.m5.4.4.2.2.1"><csymbol cd="ambiguous" id="S2.SS1.p1.8.m5.4.4.2.2.1.1.2.cmml" xref="S2.SS1.p1.8.m5.4.4.2.2.1">subscript</csymbol><set id="S2.SS1.p1.8.m5.4.4.2.2.1.1.1.2.cmml" xref="S2.SS1.p1.8.m5.4.4.2.2.1.1.1.1"><interval closure="open" id="S2.SS1.p1.8.m5.4.4.2.2.1.1.1.1.1.2.cmml" xref="S2.SS1.p1.8.m5.4.4.2.2.1.1.1.1.1.1"><apply id="S2.SS1.p1.8.m5.4.4.2.2.1.1.1.1.1.1.1.cmml" xref="S2.SS1.p1.8.m5.4.4.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.8.m5.4.4.2.2.1.1.1.1.1.1.1.1.cmml" xref="S2.SS1.p1.8.m5.4.4.2.2.1.1.1.1.1.1.1">subscript</csymbol><apply id="S2.SS1.p1.8.m5.4.4.2.2.1.1.1.1.1.1.1.2.cmml" xref="S2.SS1.p1.8.m5.4.4.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.8.m5.4.4.2.2.1.1.1.1.1.1.1.2.1.cmml" xref="S2.SS1.p1.8.m5.4.4.2.2.1.1.1.1.1.1.1">superscript</csymbol><ci id="S2.SS1.p1.8.m5.4.4.2.2.1.1.1.1.1.1.1.2.2.cmml" xref="S2.SS1.p1.8.m5.4.4.2.2.1.1.1.1.1.1.1.2.2">𝑥</ci><ci id="S2.SS1.p1.8.m5.4.4.2.2.1.1.1.1.1.1.1.2.3.cmml" xref="S2.SS1.p1.8.m5.4.4.2.2.1.1.1.1.1.1.1.2.3">𝑣</ci></apply><ci id="S2.SS1.p1.8.m5.4.4.2.2.1.1.1.1.1.1.1.3.cmml" xref="S2.SS1.p1.8.m5.4.4.2.2.1.1.1.1.1.1.1.3">𝑖</ci></apply><ci id="S2.SS1.p1.8.m5.2.2.cmml" xref="S2.SS1.p1.8.m5.2.2">𝑣</ci></interval></set><apply id="S2.SS1.p1.8.m5.4.4.2.2.1.1.3.cmml" xref="S2.SS1.p1.8.m5.4.4.2.2.1.1.3"><eq id="S2.SS1.p1.8.m5.4.4.2.2.1.1.3.1.cmml" xref="S2.SS1.p1.8.m5.4.4.2.2.1.1.3.1"></eq><ci id="S2.SS1.p1.8.m5.4.4.2.2.1.1.3.2.cmml" xref="S2.SS1.p1.8.m5.4.4.2.2.1.1.3.2">𝑖</ci><cn id="S2.SS1.p1.8.m5.4.4.2.2.1.1.3.3.cmml" type="integer" xref="S2.SS1.p1.8.m5.4.4.2.2.1.1.3.3">1</cn></apply></apply><ci id="S2.SS1.p1.8.m5.4.4.2.2.1.3.cmml" xref="S2.SS1.p1.8.m5.4.4.2.2.1.3">𝑛</ci></apply></apply><apply id="S2.SS1.p1.8.m5.4.4.2.2c.cmml" xref="S2.SS1.p1.8.m5.4.4.2.2"><subset id="S2.SS1.p1.8.m5.4.4.2.2.5.cmml" xref="S2.SS1.p1.8.m5.4.4.2.2.5"></subset><share href="https://arxiv.org/html/2410.03052v1#S2.SS1.p1.8.m5.4.4.2.2.1.cmml" id="S2.SS1.p1.8.m5.4.4.2.2d.cmml" xref="S2.SS1.p1.8.m5.4.4.2.2"></share><ci id="S2.SS1.p1.8.m5.4.4.2.2.6.cmml" xref="S2.SS1.p1.8.m5.4.4.2.2.6">𝒟</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.8.m5.4c">{\mathcal{D}}_{u}=\{(x^{u}_{i},u)\}_{i=1}^{m},{\mathcal{D}}_{v}=\{(x^{v}_{i},v%
)\}_{i=1}^{n}\subseteq{\mathcal{D}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.8.m5.4d">caligraphic_D start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT = { ( italic_x start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_u ) } start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_m end_POSTSUPERSCRIPT , caligraphic_D start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT = { ( italic_x start_POSTSUPERSCRIPT italic_v end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_v ) } start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT ⊆ caligraphic_D</annotation></semantics></math> be datasets with the same class label <math alttext="u,v" class="ltx_Math" display="inline" id="S2.SS1.p1.9.m6.2"><semantics id="S2.SS1.p1.9.m6.2a"><mrow id="S2.SS1.p1.9.m6.2.3.2" xref="S2.SS1.p1.9.m6.2.3.1.cmml"><mi id="S2.SS1.p1.9.m6.1.1" xref="S2.SS1.p1.9.m6.1.1.cmml">u</mi><mo id="S2.SS1.p1.9.m6.2.3.2.1" xref="S2.SS1.p1.9.m6.2.3.1.cmml">,</mo><mi id="S2.SS1.p1.9.m6.2.2" xref="S2.SS1.p1.9.m6.2.2.cmml">v</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.9.m6.2b"><list id="S2.SS1.p1.9.m6.2.3.1.cmml" xref="S2.SS1.p1.9.m6.2.3.2"><ci id="S2.SS1.p1.9.m6.1.1.cmml" xref="S2.SS1.p1.9.m6.1.1">𝑢</ci><ci id="S2.SS1.p1.9.m6.2.2.cmml" xref="S2.SS1.p1.9.m6.2.2">𝑣</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.9.m6.2c">u,v</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.9.m6.2d">italic_u , italic_v</annotation></semantics></math>. When <math alttext="\ell_{2}" class="ltx_Math" display="inline" id="S2.SS1.p1.10.m7.1"><semantics id="S2.SS1.p1.10.m7.1a"><msub id="S2.SS1.p1.10.m7.1.1" xref="S2.SS1.p1.10.m7.1.1.cmml"><mi id="S2.SS1.p1.10.m7.1.1.2" mathvariant="normal" xref="S2.SS1.p1.10.m7.1.1.2.cmml">ℓ</mi><mn id="S2.SS1.p1.10.m7.1.1.3" xref="S2.SS1.p1.10.m7.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.10.m7.1b"><apply id="S2.SS1.p1.10.m7.1.1.cmml" xref="S2.SS1.p1.10.m7.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.10.m7.1.1.1.cmml" xref="S2.SS1.p1.10.m7.1.1">subscript</csymbol><ci id="S2.SS1.p1.10.m7.1.1.2.cmml" xref="S2.SS1.p1.10.m7.1.1.2">ℓ</ci><cn id="S2.SS1.p1.10.m7.1.1.3.cmml" type="integer" xref="S2.SS1.p1.10.m7.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.10.m7.1c">\ell_{2}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.10.m7.1d">roman_ℓ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>-CPCC is used as a regularizer in Eq. <a class="ltx_ref" href="https://arxiv.org/html/2410.03052v1#S2.E1" title="Equation 1 ‣ Notation and Problem Setup ‣ 2 Preliminaries ‣ Learning Structured Representations by Embedding Class Hierarchy with Fast Optimal Transport"><span class="ltx_text ltx_ref_tag">1</span></a>,</p>
<table class="ltx_equation ltx_eqn_table" id="S2.Ex1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\rho(u,v)\vcentcolon=\left\|\frac{1}{m}\sum_{(x^{u}_{i},u)\in{\mathcal{D}}_{u}%
}f(x^{u}_{i})-\frac{1}{n}\sum_{(x^{v}_{j},v)\in{\mathcal{D}}_{v}}f(x^{v}_{j})%
\right\|_{2}," class="ltx_Math" display="block" id="S2.Ex1.m1.7"><semantics id="S2.Ex1.m1.7a"><mrow id="S2.Ex1.m1.7.7.1" xref="S2.Ex1.m1.7.7.1.1.cmml"><mrow id="S2.Ex1.m1.7.7.1.1" xref="S2.Ex1.m1.7.7.1.1.cmml"><mrow id="S2.Ex1.m1.7.7.1.1.3" xref="S2.Ex1.m1.7.7.1.1.3.cmml"><mi id="S2.Ex1.m1.7.7.1.1.3.2" xref="S2.Ex1.m1.7.7.1.1.3.2.cmml">ρ</mi><mo id="S2.Ex1.m1.7.7.1.1.3.1" xref="S2.Ex1.m1.7.7.1.1.3.1.cmml">⁢</mo><mrow id="S2.Ex1.m1.7.7.1.1.3.3.2" xref="S2.Ex1.m1.7.7.1.1.3.3.1.cmml"><mo id="S2.Ex1.m1.7.7.1.1.3.3.2.1" stretchy="false" xref="S2.Ex1.m1.7.7.1.1.3.3.1.cmml">(</mo><mi id="S2.Ex1.m1.5.5" xref="S2.Ex1.m1.5.5.cmml">u</mi><mo id="S2.Ex1.m1.7.7.1.1.3.3.2.2" xref="S2.Ex1.m1.7.7.1.1.3.3.1.cmml">,</mo><mi id="S2.Ex1.m1.6.6" xref="S2.Ex1.m1.6.6.cmml">v</mi><mo id="S2.Ex1.m1.7.7.1.1.3.3.2.3" rspace="0.278em" stretchy="false" xref="S2.Ex1.m1.7.7.1.1.3.3.1.cmml">)</mo></mrow></mrow><mo id="S2.Ex1.m1.7.7.1.1.2" rspace="0.278em" xref="S2.Ex1.m1.7.7.1.1.2.cmml">:=</mo><msub id="S2.Ex1.m1.7.7.1.1.1" xref="S2.Ex1.m1.7.7.1.1.1.cmml"><mrow id="S2.Ex1.m1.7.7.1.1.1.1.1" xref="S2.Ex1.m1.7.7.1.1.1.1.2.cmml"><mo id="S2.Ex1.m1.7.7.1.1.1.1.1.2" xref="S2.Ex1.m1.7.7.1.1.1.1.2.1.cmml">‖</mo><mrow id="S2.Ex1.m1.7.7.1.1.1.1.1.1" xref="S2.Ex1.m1.7.7.1.1.1.1.1.1.cmml"><mrow id="S2.Ex1.m1.7.7.1.1.1.1.1.1.1" xref="S2.Ex1.m1.7.7.1.1.1.1.1.1.1.cmml"><mfrac id="S2.Ex1.m1.7.7.1.1.1.1.1.1.1.3" xref="S2.Ex1.m1.7.7.1.1.1.1.1.1.1.3.cmml"><mn id="S2.Ex1.m1.7.7.1.1.1.1.1.1.1.3.2" xref="S2.Ex1.m1.7.7.1.1.1.1.1.1.1.3.2.cmml">1</mn><mi id="S2.Ex1.m1.7.7.1.1.1.1.1.1.1.3.3" xref="S2.Ex1.m1.7.7.1.1.1.1.1.1.1.3.3.cmml">m</mi></mfrac><mo id="S2.Ex1.m1.7.7.1.1.1.1.1.1.1.2" xref="S2.Ex1.m1.7.7.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.Ex1.m1.7.7.1.1.1.1.1.1.1.1" xref="S2.Ex1.m1.7.7.1.1.1.1.1.1.1.1.cmml"><munder id="S2.Ex1.m1.7.7.1.1.1.1.1.1.1.1.2" xref="S2.Ex1.m1.7.7.1.1.1.1.1.1.1.1.2.cmml"><mo id="S2.Ex1.m1.7.7.1.1.1.1.1.1.1.1.2.2" movablelimits="false" xref="S2.Ex1.m1.7.7.1.1.1.1.1.1.1.1.2.2.cmml">∑</mo><mrow id="S2.Ex1.m1.2.2.2" xref="S2.Ex1.m1.2.2.2.cmml"><mrow id="S2.Ex1.m1.2.2.2.2.1" xref="S2.Ex1.m1.2.2.2.2.2.cmml"><mo id="S2.Ex1.m1.2.2.2.2.1.2" stretchy="false" xref="S2.Ex1.m1.2.2.2.2.2.cmml">(</mo><msubsup id="S2.Ex1.m1.2.2.2.2.1.1" xref="S2.Ex1.m1.2.2.2.2.1.1.cmml"><mi id="S2.Ex1.m1.2.2.2.2.1.1.2.2" xref="S2.Ex1.m1.2.2.2.2.1.1.2.2.cmml">x</mi><mi id="S2.Ex1.m1.2.2.2.2.1.1.3" xref="S2.Ex1.m1.2.2.2.2.1.1.3.cmml">i</mi><mi id="S2.Ex1.m1.2.2.2.2.1.1.2.3" xref="S2.Ex1.m1.2.2.2.2.1.1.2.3.cmml">u</mi></msubsup><mo id="S2.Ex1.m1.2.2.2.2.1.3" xref="S2.Ex1.m1.2.2.2.2.2.cmml">,</mo><mi id="S2.Ex1.m1.1.1.1.1" xref="S2.Ex1.m1.1.1.1.1.cmml">u</mi><mo id="S2.Ex1.m1.2.2.2.2.1.4" stretchy="false" xref="S2.Ex1.m1.2.2.2.2.2.cmml">)</mo></mrow><mo id="S2.Ex1.m1.2.2.2.3" xref="S2.Ex1.m1.2.2.2.3.cmml">∈</mo><msub id="S2.Ex1.m1.2.2.2.4" xref="S2.Ex1.m1.2.2.2.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.Ex1.m1.2.2.2.4.2" xref="S2.Ex1.m1.2.2.2.4.2.cmml">𝒟</mi><mi id="S2.Ex1.m1.2.2.2.4.3" xref="S2.Ex1.m1.2.2.2.4.3.cmml">u</mi></msub></mrow></munder><mrow id="S2.Ex1.m1.7.7.1.1.1.1.1.1.1.1.1" xref="S2.Ex1.m1.7.7.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.Ex1.m1.7.7.1.1.1.1.1.1.1.1.1.3" xref="S2.Ex1.m1.7.7.1.1.1.1.1.1.1.1.1.3.cmml">f</mi><mo id="S2.Ex1.m1.7.7.1.1.1.1.1.1.1.1.1.2" xref="S2.Ex1.m1.7.7.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.Ex1.m1.7.7.1.1.1.1.1.1.1.1.1.1.1" xref="S2.Ex1.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S2.Ex1.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S2.Ex1.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="S2.Ex1.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1" xref="S2.Ex1.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.Ex1.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S2.Ex1.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">x</mi><mi id="S2.Ex1.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S2.Ex1.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi><mi id="S2.Ex1.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S2.Ex1.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">u</mi></msubsup><mo id="S2.Ex1.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S2.Ex1.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S2.Ex1.m1.7.7.1.1.1.1.1.1.3" xref="S2.Ex1.m1.7.7.1.1.1.1.1.1.3.cmml">−</mo><mrow id="S2.Ex1.m1.7.7.1.1.1.1.1.1.2" xref="S2.Ex1.m1.7.7.1.1.1.1.1.1.2.cmml"><mfrac id="S2.Ex1.m1.7.7.1.1.1.1.1.1.2.3" xref="S2.Ex1.m1.7.7.1.1.1.1.1.1.2.3.cmml"><mn id="S2.Ex1.m1.7.7.1.1.1.1.1.1.2.3.2" xref="S2.Ex1.m1.7.7.1.1.1.1.1.1.2.3.2.cmml">1</mn><mi id="S2.Ex1.m1.7.7.1.1.1.1.1.1.2.3.3" xref="S2.Ex1.m1.7.7.1.1.1.1.1.1.2.3.3.cmml">n</mi></mfrac><mo id="S2.Ex1.m1.7.7.1.1.1.1.1.1.2.2" xref="S2.Ex1.m1.7.7.1.1.1.1.1.1.2.2.cmml">⁢</mo><mrow id="S2.Ex1.m1.7.7.1.1.1.1.1.1.2.1" xref="S2.Ex1.m1.7.7.1.1.1.1.1.1.2.1.cmml"><munder id="S2.Ex1.m1.7.7.1.1.1.1.1.1.2.1.2" xref="S2.Ex1.m1.7.7.1.1.1.1.1.1.2.1.2.cmml"><mo id="S2.Ex1.m1.7.7.1.1.1.1.1.1.2.1.2.2" movablelimits="false" xref="S2.Ex1.m1.7.7.1.1.1.1.1.1.2.1.2.2.cmml">∑</mo><mrow id="S2.Ex1.m1.4.4.2" xref="S2.Ex1.m1.4.4.2.cmml"><mrow id="S2.Ex1.m1.4.4.2.2.1" xref="S2.Ex1.m1.4.4.2.2.2.cmml"><mo id="S2.Ex1.m1.4.4.2.2.1.2" stretchy="false" xref="S2.Ex1.m1.4.4.2.2.2.cmml">(</mo><msubsup id="S2.Ex1.m1.4.4.2.2.1.1" xref="S2.Ex1.m1.4.4.2.2.1.1.cmml"><mi id="S2.Ex1.m1.4.4.2.2.1.1.2.2" xref="S2.Ex1.m1.4.4.2.2.1.1.2.2.cmml">x</mi><mi id="S2.Ex1.m1.4.4.2.2.1.1.3" xref="S2.Ex1.m1.4.4.2.2.1.1.3.cmml">j</mi><mi id="S2.Ex1.m1.4.4.2.2.1.1.2.3" xref="S2.Ex1.m1.4.4.2.2.1.1.2.3.cmml">v</mi></msubsup><mo id="S2.Ex1.m1.4.4.2.2.1.3" xref="S2.Ex1.m1.4.4.2.2.2.cmml">,</mo><mi id="S2.Ex1.m1.3.3.1.1" xref="S2.Ex1.m1.3.3.1.1.cmml">v</mi><mo id="S2.Ex1.m1.4.4.2.2.1.4" stretchy="false" xref="S2.Ex1.m1.4.4.2.2.2.cmml">)</mo></mrow><mo id="S2.Ex1.m1.4.4.2.3" xref="S2.Ex1.m1.4.4.2.3.cmml">∈</mo><msub id="S2.Ex1.m1.4.4.2.4" xref="S2.Ex1.m1.4.4.2.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.Ex1.m1.4.4.2.4.2" xref="S2.Ex1.m1.4.4.2.4.2.cmml">𝒟</mi><mi id="S2.Ex1.m1.4.4.2.4.3" xref="S2.Ex1.m1.4.4.2.4.3.cmml">v</mi></msub></mrow></munder><mrow id="S2.Ex1.m1.7.7.1.1.1.1.1.1.2.1.1" xref="S2.Ex1.m1.7.7.1.1.1.1.1.1.2.1.1.cmml"><mi id="S2.Ex1.m1.7.7.1.1.1.1.1.1.2.1.1.3" xref="S2.Ex1.m1.7.7.1.1.1.1.1.1.2.1.1.3.cmml">f</mi><mo id="S2.Ex1.m1.7.7.1.1.1.1.1.1.2.1.1.2" xref="S2.Ex1.m1.7.7.1.1.1.1.1.1.2.1.1.2.cmml">⁢</mo><mrow id="S2.Ex1.m1.7.7.1.1.1.1.1.1.2.1.1.1.1" xref="S2.Ex1.m1.7.7.1.1.1.1.1.1.2.1.1.1.1.1.cmml"><mo id="S2.Ex1.m1.7.7.1.1.1.1.1.1.2.1.1.1.1.2" stretchy="false" xref="S2.Ex1.m1.7.7.1.1.1.1.1.1.2.1.1.1.1.1.cmml">(</mo><msubsup id="S2.Ex1.m1.7.7.1.1.1.1.1.1.2.1.1.1.1.1" xref="S2.Ex1.m1.7.7.1.1.1.1.1.1.2.1.1.1.1.1.cmml"><mi id="S2.Ex1.m1.7.7.1.1.1.1.1.1.2.1.1.1.1.1.2.2" xref="S2.Ex1.m1.7.7.1.1.1.1.1.1.2.1.1.1.1.1.2.2.cmml">x</mi><mi id="S2.Ex1.m1.7.7.1.1.1.1.1.1.2.1.1.1.1.1.3" xref="S2.Ex1.m1.7.7.1.1.1.1.1.1.2.1.1.1.1.1.3.cmml">j</mi><mi id="S2.Ex1.m1.7.7.1.1.1.1.1.1.2.1.1.1.1.1.2.3" xref="S2.Ex1.m1.7.7.1.1.1.1.1.1.2.1.1.1.1.1.2.3.cmml">v</mi></msubsup><mo id="S2.Ex1.m1.7.7.1.1.1.1.1.1.2.1.1.1.1.3" stretchy="false" xref="S2.Ex1.m1.7.7.1.1.1.1.1.1.2.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="S2.Ex1.m1.7.7.1.1.1.1.1.3" xref="S2.Ex1.m1.7.7.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S2.Ex1.m1.7.7.1.1.1.3" xref="S2.Ex1.m1.7.7.1.1.1.3.cmml">2</mn></msub></mrow><mo id="S2.Ex1.m1.7.7.1.2" xref="S2.Ex1.m1.7.7.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.Ex1.m1.7b"><apply id="S2.Ex1.m1.7.7.1.1.cmml" xref="S2.Ex1.m1.7.7.1"><csymbol cd="latexml" id="S2.Ex1.m1.7.7.1.1.2.cmml" xref="S2.Ex1.m1.7.7.1.1.2">assign</csymbol><apply id="S2.Ex1.m1.7.7.1.1.3.cmml" xref="S2.Ex1.m1.7.7.1.1.3"><times id="S2.Ex1.m1.7.7.1.1.3.1.cmml" xref="S2.Ex1.m1.7.7.1.1.3.1"></times><ci id="S2.Ex1.m1.7.7.1.1.3.2.cmml" xref="S2.Ex1.m1.7.7.1.1.3.2">𝜌</ci><interval closure="open" id="S2.Ex1.m1.7.7.1.1.3.3.1.cmml" xref="S2.Ex1.m1.7.7.1.1.3.3.2"><ci id="S2.Ex1.m1.5.5.cmml" xref="S2.Ex1.m1.5.5">𝑢</ci><ci id="S2.Ex1.m1.6.6.cmml" xref="S2.Ex1.m1.6.6">𝑣</ci></interval></apply><apply id="S2.Ex1.m1.7.7.1.1.1.cmml" xref="S2.Ex1.m1.7.7.1.1.1"><csymbol cd="ambiguous" id="S2.Ex1.m1.7.7.1.1.1.2.cmml" xref="S2.Ex1.m1.7.7.1.1.1">subscript</csymbol><apply id="S2.Ex1.m1.7.7.1.1.1.1.2.cmml" xref="S2.Ex1.m1.7.7.1.1.1.1.1"><csymbol cd="latexml" id="S2.Ex1.m1.7.7.1.1.1.1.2.1.cmml" xref="S2.Ex1.m1.7.7.1.1.1.1.1.2">norm</csymbol><apply id="S2.Ex1.m1.7.7.1.1.1.1.1.1.cmml" xref="S2.Ex1.m1.7.7.1.1.1.1.1.1"><minus id="S2.Ex1.m1.7.7.1.1.1.1.1.1.3.cmml" xref="S2.Ex1.m1.7.7.1.1.1.1.1.1.3"></minus><apply id="S2.Ex1.m1.7.7.1.1.1.1.1.1.1.cmml" xref="S2.Ex1.m1.7.7.1.1.1.1.1.1.1"><times id="S2.Ex1.m1.7.7.1.1.1.1.1.1.1.2.cmml" xref="S2.Ex1.m1.7.7.1.1.1.1.1.1.1.2"></times><apply id="S2.Ex1.m1.7.7.1.1.1.1.1.1.1.3.cmml" xref="S2.Ex1.m1.7.7.1.1.1.1.1.1.1.3"><divide id="S2.Ex1.m1.7.7.1.1.1.1.1.1.1.3.1.cmml" xref="S2.Ex1.m1.7.7.1.1.1.1.1.1.1.3"></divide><cn id="S2.Ex1.m1.7.7.1.1.1.1.1.1.1.3.2.cmml" type="integer" xref="S2.Ex1.m1.7.7.1.1.1.1.1.1.1.3.2">1</cn><ci id="S2.Ex1.m1.7.7.1.1.1.1.1.1.1.3.3.cmml" xref="S2.Ex1.m1.7.7.1.1.1.1.1.1.1.3.3">𝑚</ci></apply><apply id="S2.Ex1.m1.7.7.1.1.1.1.1.1.1.1.cmml" xref="S2.Ex1.m1.7.7.1.1.1.1.1.1.1.1"><apply id="S2.Ex1.m1.7.7.1.1.1.1.1.1.1.1.2.cmml" xref="S2.Ex1.m1.7.7.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.Ex1.m1.7.7.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.Ex1.m1.7.7.1.1.1.1.1.1.1.1.2">subscript</csymbol><sum id="S2.Ex1.m1.7.7.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.Ex1.m1.7.7.1.1.1.1.1.1.1.1.2.2"></sum><apply id="S2.Ex1.m1.2.2.2.cmml" xref="S2.Ex1.m1.2.2.2"><in id="S2.Ex1.m1.2.2.2.3.cmml" xref="S2.Ex1.m1.2.2.2.3"></in><interval closure="open" id="S2.Ex1.m1.2.2.2.2.2.cmml" xref="S2.Ex1.m1.2.2.2.2.1"><apply id="S2.Ex1.m1.2.2.2.2.1.1.cmml" xref="S2.Ex1.m1.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S2.Ex1.m1.2.2.2.2.1.1.1.cmml" xref="S2.Ex1.m1.2.2.2.2.1.1">subscript</csymbol><apply id="S2.Ex1.m1.2.2.2.2.1.1.2.cmml" xref="S2.Ex1.m1.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S2.Ex1.m1.2.2.2.2.1.1.2.1.cmml" xref="S2.Ex1.m1.2.2.2.2.1.1">superscript</csymbol><ci id="S2.Ex1.m1.2.2.2.2.1.1.2.2.cmml" xref="S2.Ex1.m1.2.2.2.2.1.1.2.2">𝑥</ci><ci id="S2.Ex1.m1.2.2.2.2.1.1.2.3.cmml" xref="S2.Ex1.m1.2.2.2.2.1.1.2.3">𝑢</ci></apply><ci id="S2.Ex1.m1.2.2.2.2.1.1.3.cmml" xref="S2.Ex1.m1.2.2.2.2.1.1.3">𝑖</ci></apply><ci id="S2.Ex1.m1.1.1.1.1.cmml" xref="S2.Ex1.m1.1.1.1.1">𝑢</ci></interval><apply id="S2.Ex1.m1.2.2.2.4.cmml" xref="S2.Ex1.m1.2.2.2.4"><csymbol cd="ambiguous" id="S2.Ex1.m1.2.2.2.4.1.cmml" xref="S2.Ex1.m1.2.2.2.4">subscript</csymbol><ci id="S2.Ex1.m1.2.2.2.4.2.cmml" xref="S2.Ex1.m1.2.2.2.4.2">𝒟</ci><ci id="S2.Ex1.m1.2.2.2.4.3.cmml" xref="S2.Ex1.m1.2.2.2.4.3">𝑢</ci></apply></apply></apply><apply id="S2.Ex1.m1.7.7.1.1.1.1.1.1.1.1.1.cmml" xref="S2.Ex1.m1.7.7.1.1.1.1.1.1.1.1.1"><times id="S2.Ex1.m1.7.7.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.Ex1.m1.7.7.1.1.1.1.1.1.1.1.1.2"></times><ci id="S2.Ex1.m1.7.7.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.Ex1.m1.7.7.1.1.1.1.1.1.1.1.1.3">𝑓</ci><apply id="S2.Ex1.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.Ex1.m1.7.7.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.Ex1.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.Ex1.m1.7.7.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="S2.Ex1.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.Ex1.m1.7.7.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.Ex1.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.Ex1.m1.7.7.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S2.Ex1.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.Ex1.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.2.2">𝑥</ci><ci id="S2.Ex1.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.Ex1.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.2.3">𝑢</ci></apply><ci id="S2.Ex1.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.Ex1.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply></apply></apply><apply id="S2.Ex1.m1.7.7.1.1.1.1.1.1.2.cmml" xref="S2.Ex1.m1.7.7.1.1.1.1.1.1.2"><times id="S2.Ex1.m1.7.7.1.1.1.1.1.1.2.2.cmml" xref="S2.Ex1.m1.7.7.1.1.1.1.1.1.2.2"></times><apply id="S2.Ex1.m1.7.7.1.1.1.1.1.1.2.3.cmml" xref="S2.Ex1.m1.7.7.1.1.1.1.1.1.2.3"><divide id="S2.Ex1.m1.7.7.1.1.1.1.1.1.2.3.1.cmml" xref="S2.Ex1.m1.7.7.1.1.1.1.1.1.2.3"></divide><cn id="S2.Ex1.m1.7.7.1.1.1.1.1.1.2.3.2.cmml" type="integer" xref="S2.Ex1.m1.7.7.1.1.1.1.1.1.2.3.2">1</cn><ci id="S2.Ex1.m1.7.7.1.1.1.1.1.1.2.3.3.cmml" xref="S2.Ex1.m1.7.7.1.1.1.1.1.1.2.3.3">𝑛</ci></apply><apply id="S2.Ex1.m1.7.7.1.1.1.1.1.1.2.1.cmml" xref="S2.Ex1.m1.7.7.1.1.1.1.1.1.2.1"><apply id="S2.Ex1.m1.7.7.1.1.1.1.1.1.2.1.2.cmml" xref="S2.Ex1.m1.7.7.1.1.1.1.1.1.2.1.2"><csymbol cd="ambiguous" id="S2.Ex1.m1.7.7.1.1.1.1.1.1.2.1.2.1.cmml" xref="S2.Ex1.m1.7.7.1.1.1.1.1.1.2.1.2">subscript</csymbol><sum id="S2.Ex1.m1.7.7.1.1.1.1.1.1.2.1.2.2.cmml" xref="S2.Ex1.m1.7.7.1.1.1.1.1.1.2.1.2.2"></sum><apply id="S2.Ex1.m1.4.4.2.cmml" xref="S2.Ex1.m1.4.4.2"><in id="S2.Ex1.m1.4.4.2.3.cmml" xref="S2.Ex1.m1.4.4.2.3"></in><interval closure="open" id="S2.Ex1.m1.4.4.2.2.2.cmml" xref="S2.Ex1.m1.4.4.2.2.1"><apply id="S2.Ex1.m1.4.4.2.2.1.1.cmml" xref="S2.Ex1.m1.4.4.2.2.1.1"><csymbol cd="ambiguous" id="S2.Ex1.m1.4.4.2.2.1.1.1.cmml" xref="S2.Ex1.m1.4.4.2.2.1.1">subscript</csymbol><apply id="S2.Ex1.m1.4.4.2.2.1.1.2.cmml" xref="S2.Ex1.m1.4.4.2.2.1.1"><csymbol cd="ambiguous" id="S2.Ex1.m1.4.4.2.2.1.1.2.1.cmml" xref="S2.Ex1.m1.4.4.2.2.1.1">superscript</csymbol><ci id="S2.Ex1.m1.4.4.2.2.1.1.2.2.cmml" xref="S2.Ex1.m1.4.4.2.2.1.1.2.2">𝑥</ci><ci id="S2.Ex1.m1.4.4.2.2.1.1.2.3.cmml" xref="S2.Ex1.m1.4.4.2.2.1.1.2.3">𝑣</ci></apply><ci id="S2.Ex1.m1.4.4.2.2.1.1.3.cmml" xref="S2.Ex1.m1.4.4.2.2.1.1.3">𝑗</ci></apply><ci id="S2.Ex1.m1.3.3.1.1.cmml" xref="S2.Ex1.m1.3.3.1.1">𝑣</ci></interval><apply id="S2.Ex1.m1.4.4.2.4.cmml" xref="S2.Ex1.m1.4.4.2.4"><csymbol cd="ambiguous" id="S2.Ex1.m1.4.4.2.4.1.cmml" xref="S2.Ex1.m1.4.4.2.4">subscript</csymbol><ci id="S2.Ex1.m1.4.4.2.4.2.cmml" xref="S2.Ex1.m1.4.4.2.4.2">𝒟</ci><ci id="S2.Ex1.m1.4.4.2.4.3.cmml" xref="S2.Ex1.m1.4.4.2.4.3">𝑣</ci></apply></apply></apply><apply id="S2.Ex1.m1.7.7.1.1.1.1.1.1.2.1.1.cmml" xref="S2.Ex1.m1.7.7.1.1.1.1.1.1.2.1.1"><times id="S2.Ex1.m1.7.7.1.1.1.1.1.1.2.1.1.2.cmml" xref="S2.Ex1.m1.7.7.1.1.1.1.1.1.2.1.1.2"></times><ci id="S2.Ex1.m1.7.7.1.1.1.1.1.1.2.1.1.3.cmml" xref="S2.Ex1.m1.7.7.1.1.1.1.1.1.2.1.1.3">𝑓</ci><apply id="S2.Ex1.m1.7.7.1.1.1.1.1.1.2.1.1.1.1.1.cmml" xref="S2.Ex1.m1.7.7.1.1.1.1.1.1.2.1.1.1.1"><csymbol cd="ambiguous" id="S2.Ex1.m1.7.7.1.1.1.1.1.1.2.1.1.1.1.1.1.cmml" xref="S2.Ex1.m1.7.7.1.1.1.1.1.1.2.1.1.1.1">subscript</csymbol><apply id="S2.Ex1.m1.7.7.1.1.1.1.1.1.2.1.1.1.1.1.2.cmml" xref="S2.Ex1.m1.7.7.1.1.1.1.1.1.2.1.1.1.1"><csymbol cd="ambiguous" id="S2.Ex1.m1.7.7.1.1.1.1.1.1.2.1.1.1.1.1.2.1.cmml" xref="S2.Ex1.m1.7.7.1.1.1.1.1.1.2.1.1.1.1">superscript</csymbol><ci id="S2.Ex1.m1.7.7.1.1.1.1.1.1.2.1.1.1.1.1.2.2.cmml" xref="S2.Ex1.m1.7.7.1.1.1.1.1.1.2.1.1.1.1.1.2.2">𝑥</ci><ci id="S2.Ex1.m1.7.7.1.1.1.1.1.1.2.1.1.1.1.1.2.3.cmml" xref="S2.Ex1.m1.7.7.1.1.1.1.1.1.2.1.1.1.1.1.2.3">𝑣</ci></apply><ci id="S2.Ex1.m1.7.7.1.1.1.1.1.1.2.1.1.1.1.1.3.cmml" xref="S2.Ex1.m1.7.7.1.1.1.1.1.1.2.1.1.1.1.1.3">𝑗</ci></apply></apply></apply></apply></apply></apply><cn id="S2.Ex1.m1.7.7.1.1.1.3.cmml" type="integer" xref="S2.Ex1.m1.7.7.1.1.1.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Ex1.m1.7c">\rho(u,v)\vcentcolon=\left\|\frac{1}{m}\sum_{(x^{u}_{i},u)\in{\mathcal{D}}_{u}%
}f(x^{u}_{i})-\frac{1}{n}\sum_{(x^{v}_{j},v)\in{\mathcal{D}}_{v}}f(x^{v}_{j})%
\right\|_{2},</annotation><annotation encoding="application/x-llamapun" id="S2.Ex1.m1.7d">italic_ρ ( italic_u , italic_v ) := ∥ divide start_ARG 1 end_ARG start_ARG italic_m end_ARG ∑ start_POSTSUBSCRIPT ( italic_x start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_u ) ∈ caligraphic_D start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT end_POSTSUBSCRIPT italic_f ( italic_x start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) - divide start_ARG 1 end_ARG start_ARG italic_n end_ARG ∑ start_POSTSUBSCRIPT ( italic_x start_POSTSUPERSCRIPT italic_v end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT , italic_v ) ∈ caligraphic_D start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT end_POSTSUBSCRIPT italic_f ( italic_x start_POSTSUPERSCRIPT italic_v end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) ∥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S2.SS1.p2">
<p class="ltx_p" id="S2.SS1.p2.8">which is the <math alttext="\ell_{2}" class="ltx_Math" display="inline" id="S2.SS1.p2.1.m1.1"><semantics id="S2.SS1.p2.1.m1.1a"><msub id="S2.SS1.p2.1.m1.1.1" xref="S2.SS1.p2.1.m1.1.1.cmml"><mi id="S2.SS1.p2.1.m1.1.1.2" mathvariant="normal" xref="S2.SS1.p2.1.m1.1.1.2.cmml">ℓ</mi><mn id="S2.SS1.p2.1.m1.1.1.3" xref="S2.SS1.p2.1.m1.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.1.m1.1b"><apply id="S2.SS1.p2.1.m1.1.1.cmml" xref="S2.SS1.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.1.m1.1.1.1.cmml" xref="S2.SS1.p2.1.m1.1.1">subscript</csymbol><ci id="S2.SS1.p2.1.m1.1.1.2.cmml" xref="S2.SS1.p2.1.m1.1.1.2">ℓ</ci><cn id="S2.SS1.p2.1.m1.1.1.3.cmml" type="integer" xref="S2.SS1.p2.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.1.m1.1c">\ell_{2}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.1.m1.1d">roman_ℓ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math> distance of the mean of the two class-conditional features. We call <math alttext="z_{i}^{u}" class="ltx_Math" display="inline" id="S2.SS1.p2.2.m2.1"><semantics id="S2.SS1.p2.2.m2.1a"><msubsup id="S2.SS1.p2.2.m2.1.1" xref="S2.SS1.p2.2.m2.1.1.cmml"><mi id="S2.SS1.p2.2.m2.1.1.2.2" xref="S2.SS1.p2.2.m2.1.1.2.2.cmml">z</mi><mi id="S2.SS1.p2.2.m2.1.1.2.3" xref="S2.SS1.p2.2.m2.1.1.2.3.cmml">i</mi><mi id="S2.SS1.p2.2.m2.1.1.3" xref="S2.SS1.p2.2.m2.1.1.3.cmml">u</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.2.m2.1b"><apply id="S2.SS1.p2.2.m2.1.1.cmml" xref="S2.SS1.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.2.m2.1.1.1.cmml" xref="S2.SS1.p2.2.m2.1.1">superscript</csymbol><apply id="S2.SS1.p2.2.m2.1.1.2.cmml" xref="S2.SS1.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.2.m2.1.1.2.1.cmml" xref="S2.SS1.p2.2.m2.1.1">subscript</csymbol><ci id="S2.SS1.p2.2.m2.1.1.2.2.cmml" xref="S2.SS1.p2.2.m2.1.1.2.2">𝑧</ci><ci id="S2.SS1.p2.2.m2.1.1.2.3.cmml" xref="S2.SS1.p2.2.m2.1.1.2.3">𝑖</ci></apply><ci id="S2.SS1.p2.2.m2.1.1.3.cmml" xref="S2.SS1.p2.2.m2.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.2.m2.1c">z_{i}^{u}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.2.m2.1d">italic_z start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT</annotation></semantics></math> as the <math alttext="i" class="ltx_Math" display="inline" id="S2.SS1.p2.3.m3.1"><semantics id="S2.SS1.p2.3.m3.1a"><mi id="S2.SS1.p2.3.m3.1.1" xref="S2.SS1.p2.3.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.3.m3.1b"><ci id="S2.SS1.p2.3.m3.1.1.cmml" xref="S2.SS1.p2.3.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.3.m3.1c">i</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.3.m3.1d">italic_i</annotation></semantics></math>-th feature vector with label <math alttext="u" class="ltx_Math" display="inline" id="S2.SS1.p2.4.m4.1"><semantics id="S2.SS1.p2.4.m4.1a"><mi id="S2.SS1.p2.4.m4.1.1" xref="S2.SS1.p2.4.m4.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.4.m4.1b"><ci id="S2.SS1.p2.4.m4.1.1.cmml" xref="S2.SS1.p2.4.m4.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.4.m4.1c">u</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.4.m4.1d">italic_u</annotation></semantics></math>, when the context is clear, we drop the superscript <math alttext="u" class="ltx_Math" display="inline" id="S2.SS1.p2.5.m5.1"><semantics id="S2.SS1.p2.5.m5.1a"><mi id="S2.SS1.p2.5.m5.1.1" xref="S2.SS1.p2.5.m5.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.5.m5.1b"><ci id="S2.SS1.p2.5.m5.1.1.cmml" xref="S2.SS1.p2.5.m5.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.5.m5.1c">u</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.5.m5.1d">italic_u</annotation></semantics></math> for convenience. By maximizing CPCC (<math alttext="\lambda&lt;0" class="ltx_Math" display="inline" id="S2.SS1.p2.6.m6.1"><semantics id="S2.SS1.p2.6.m6.1a"><mrow id="S2.SS1.p2.6.m6.1.1" xref="S2.SS1.p2.6.m6.1.1.cmml"><mi id="S2.SS1.p2.6.m6.1.1.2" xref="S2.SS1.p2.6.m6.1.1.2.cmml">λ</mi><mo id="S2.SS1.p2.6.m6.1.1.1" xref="S2.SS1.p2.6.m6.1.1.1.cmml">&lt;</mo><mn id="S2.SS1.p2.6.m6.1.1.3" xref="S2.SS1.p2.6.m6.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.6.m6.1b"><apply id="S2.SS1.p2.6.m6.1.1.cmml" xref="S2.SS1.p2.6.m6.1.1"><lt id="S2.SS1.p2.6.m6.1.1.1.cmml" xref="S2.SS1.p2.6.m6.1.1.1"></lt><ci id="S2.SS1.p2.6.m6.1.1.2.cmml" xref="S2.SS1.p2.6.m6.1.1.2">𝜆</ci><cn id="S2.SS1.p2.6.m6.1.1.3.cmml" type="integer" xref="S2.SS1.p2.6.m6.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.6.m6.1c">\lambda&lt;0</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.6.m6.1d">italic_λ &lt; 0</annotation></semantics></math>), <math alttext="\rho" class="ltx_Math" display="inline" id="S2.SS1.p2.7.m7.1"><semantics id="S2.SS1.p2.7.m7.1a"><mi id="S2.SS1.p2.7.m7.1.1" xref="S2.SS1.p2.7.m7.1.1.cmml">ρ</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.7.m7.1b"><ci id="S2.SS1.p2.7.m7.1.1.cmml" xref="S2.SS1.p2.7.m7.1.1">𝜌</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.7.m7.1c">\rho</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.7.m7.1d">italic_ρ</annotation></semantics></math> follows the relation in <math alttext="t" class="ltx_Math" display="inline" id="S2.SS1.p2.8.m8.1"><semantics id="S2.SS1.p2.8.m8.1a"><mi id="S2.SS1.p2.8.m8.1.1" xref="S2.SS1.p2.8.m8.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.8.m8.1b"><ci id="S2.SS1.p2.8.m8.1.1.cmml" xref="S2.SS1.p2.8.m8.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.8.m8.1c">t</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.8.m8.1d">italic_t</annotation></semantics></math>: classes sharing a close common ancestor will be grouped together while classes with a higher common ancestor are pulled away with respect to Euclidean distance.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>Exact Earth Mover’s Distance</h3>
<div class="ltx_para" id="S2.SS2.p1">
<p class="ltx_p" id="S2.SS2.p1.8"><span class="ltx_text ltx_font_bold" id="S2.SS2.p1.8.1">Earth Mover’s Distance</span> (EMD), or Optimal Transport distances, aims to find the optimal transportation plan between two discrete measures. For <math alttext="{\mathcal{D}}_{u}" class="ltx_Math" display="inline" id="S2.SS2.p1.1.m1.1"><semantics id="S2.SS2.p1.1.m1.1a"><msub id="S2.SS2.p1.1.m1.1.1" xref="S2.SS2.p1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p1.1.m1.1.1.2" xref="S2.SS2.p1.1.m1.1.1.2.cmml">𝒟</mi><mi id="S2.SS2.p1.1.m1.1.1.3" xref="S2.SS2.p1.1.m1.1.1.3.cmml">u</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.1.m1.1b"><apply id="S2.SS2.p1.1.m1.1.1.cmml" xref="S2.SS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.1.m1.1.1.1.cmml" xref="S2.SS2.p1.1.m1.1.1">subscript</csymbol><ci id="S2.SS2.p1.1.m1.1.1.2.cmml" xref="S2.SS2.p1.1.m1.1.1.2">𝒟</ci><ci id="S2.SS2.p1.1.m1.1.1.3.cmml" xref="S2.SS2.p1.1.m1.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.1.m1.1c">{\mathcal{D}}_{u}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.1.m1.1d">caligraphic_D start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT</annotation></semantics></math>, let <math alttext="a=(a_{1},\dots,a_{m})\in\Delta_{m}" class="ltx_Math" display="inline" id="S2.SS2.p1.2.m2.3"><semantics id="S2.SS2.p1.2.m2.3a"><mrow id="S2.SS2.p1.2.m2.3.3" xref="S2.SS2.p1.2.m2.3.3.cmml"><mi id="S2.SS2.p1.2.m2.3.3.4" xref="S2.SS2.p1.2.m2.3.3.4.cmml">a</mi><mo id="S2.SS2.p1.2.m2.3.3.5" xref="S2.SS2.p1.2.m2.3.3.5.cmml">=</mo><mrow id="S2.SS2.p1.2.m2.3.3.2.2" xref="S2.SS2.p1.2.m2.3.3.2.3.cmml"><mo id="S2.SS2.p1.2.m2.3.3.2.2.3" stretchy="false" xref="S2.SS2.p1.2.m2.3.3.2.3.cmml">(</mo><msub id="S2.SS2.p1.2.m2.2.2.1.1.1" xref="S2.SS2.p1.2.m2.2.2.1.1.1.cmml"><mi id="S2.SS2.p1.2.m2.2.2.1.1.1.2" xref="S2.SS2.p1.2.m2.2.2.1.1.1.2.cmml">a</mi><mn id="S2.SS2.p1.2.m2.2.2.1.1.1.3" xref="S2.SS2.p1.2.m2.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S2.SS2.p1.2.m2.3.3.2.2.4" xref="S2.SS2.p1.2.m2.3.3.2.3.cmml">,</mo><mi id="S2.SS2.p1.2.m2.1.1" mathvariant="normal" xref="S2.SS2.p1.2.m2.1.1.cmml">…</mi><mo id="S2.SS2.p1.2.m2.3.3.2.2.5" xref="S2.SS2.p1.2.m2.3.3.2.3.cmml">,</mo><msub id="S2.SS2.p1.2.m2.3.3.2.2.2" xref="S2.SS2.p1.2.m2.3.3.2.2.2.cmml"><mi id="S2.SS2.p1.2.m2.3.3.2.2.2.2" xref="S2.SS2.p1.2.m2.3.3.2.2.2.2.cmml">a</mi><mi id="S2.SS2.p1.2.m2.3.3.2.2.2.3" xref="S2.SS2.p1.2.m2.3.3.2.2.2.3.cmml">m</mi></msub><mo id="S2.SS2.p1.2.m2.3.3.2.2.6" stretchy="false" xref="S2.SS2.p1.2.m2.3.3.2.3.cmml">)</mo></mrow><mo id="S2.SS2.p1.2.m2.3.3.6" xref="S2.SS2.p1.2.m2.3.3.6.cmml">∈</mo><msub id="S2.SS2.p1.2.m2.3.3.7" xref="S2.SS2.p1.2.m2.3.3.7.cmml"><mi id="S2.SS2.p1.2.m2.3.3.7.2" mathvariant="normal" xref="S2.SS2.p1.2.m2.3.3.7.2.cmml">Δ</mi><mi id="S2.SS2.p1.2.m2.3.3.7.3" xref="S2.SS2.p1.2.m2.3.3.7.3.cmml">m</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.2.m2.3b"><apply id="S2.SS2.p1.2.m2.3.3.cmml" xref="S2.SS2.p1.2.m2.3.3"><and id="S2.SS2.p1.2.m2.3.3a.cmml" xref="S2.SS2.p1.2.m2.3.3"></and><apply id="S2.SS2.p1.2.m2.3.3b.cmml" xref="S2.SS2.p1.2.m2.3.3"><eq id="S2.SS2.p1.2.m2.3.3.5.cmml" xref="S2.SS2.p1.2.m2.3.3.5"></eq><ci id="S2.SS2.p1.2.m2.3.3.4.cmml" xref="S2.SS2.p1.2.m2.3.3.4">𝑎</ci><vector id="S2.SS2.p1.2.m2.3.3.2.3.cmml" xref="S2.SS2.p1.2.m2.3.3.2.2"><apply id="S2.SS2.p1.2.m2.2.2.1.1.1.cmml" xref="S2.SS2.p1.2.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.2.m2.2.2.1.1.1.1.cmml" xref="S2.SS2.p1.2.m2.2.2.1.1.1">subscript</csymbol><ci id="S2.SS2.p1.2.m2.2.2.1.1.1.2.cmml" xref="S2.SS2.p1.2.m2.2.2.1.1.1.2">𝑎</ci><cn id="S2.SS2.p1.2.m2.2.2.1.1.1.3.cmml" type="integer" xref="S2.SS2.p1.2.m2.2.2.1.1.1.3">1</cn></apply><ci id="S2.SS2.p1.2.m2.1.1.cmml" xref="S2.SS2.p1.2.m2.1.1">…</ci><apply id="S2.SS2.p1.2.m2.3.3.2.2.2.cmml" xref="S2.SS2.p1.2.m2.3.3.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.p1.2.m2.3.3.2.2.2.1.cmml" xref="S2.SS2.p1.2.m2.3.3.2.2.2">subscript</csymbol><ci id="S2.SS2.p1.2.m2.3.3.2.2.2.2.cmml" xref="S2.SS2.p1.2.m2.3.3.2.2.2.2">𝑎</ci><ci id="S2.SS2.p1.2.m2.3.3.2.2.2.3.cmml" xref="S2.SS2.p1.2.m2.3.3.2.2.2.3">𝑚</ci></apply></vector></apply><apply id="S2.SS2.p1.2.m2.3.3c.cmml" xref="S2.SS2.p1.2.m2.3.3"><in id="S2.SS2.p1.2.m2.3.3.6.cmml" xref="S2.SS2.p1.2.m2.3.3.6"></in><share href="https://arxiv.org/html/2410.03052v1#S2.SS2.p1.2.m2.3.3.2.cmml" id="S2.SS2.p1.2.m2.3.3d.cmml" xref="S2.SS2.p1.2.m2.3.3"></share><apply id="S2.SS2.p1.2.m2.3.3.7.cmml" xref="S2.SS2.p1.2.m2.3.3.7"><csymbol cd="ambiguous" id="S2.SS2.p1.2.m2.3.3.7.1.cmml" xref="S2.SS2.p1.2.m2.3.3.7">subscript</csymbol><ci id="S2.SS2.p1.2.m2.3.3.7.2.cmml" xref="S2.SS2.p1.2.m2.3.3.7.2">Δ</ci><ci id="S2.SS2.p1.2.m2.3.3.7.3.cmml" xref="S2.SS2.p1.2.m2.3.3.7.3">𝑚</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.2.m2.3c">a=(a_{1},\dots,a_{m})\in\Delta_{m}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.2.m2.3d">italic_a = ( italic_a start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_a start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT ) ∈ roman_Δ start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT</annotation></semantics></math> which is not necessarily uniform. Let <math alttext="b" class="ltx_Math" display="inline" id="S2.SS2.p1.3.m3.1"><semantics id="S2.SS2.p1.3.m3.1a"><mi id="S2.SS2.p1.3.m3.1.1" xref="S2.SS2.p1.3.m3.1.1.cmml">b</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.3.m3.1b"><ci id="S2.SS2.p1.3.m3.1.1.cmml" xref="S2.SS2.p1.3.m3.1.1">𝑏</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.3.m3.1c">b</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.3.m3.1d">italic_b</annotation></semantics></math> defined similarly for <math alttext="{\mathcal{D}}_{v}" class="ltx_Math" display="inline" id="S2.SS2.p1.4.m4.1"><semantics id="S2.SS2.p1.4.m4.1a"><msub id="S2.SS2.p1.4.m4.1.1" xref="S2.SS2.p1.4.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p1.4.m4.1.1.2" xref="S2.SS2.p1.4.m4.1.1.2.cmml">𝒟</mi><mi id="S2.SS2.p1.4.m4.1.1.3" xref="S2.SS2.p1.4.m4.1.1.3.cmml">v</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.4.m4.1b"><apply id="S2.SS2.p1.4.m4.1.1.cmml" xref="S2.SS2.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.4.m4.1.1.1.cmml" xref="S2.SS2.p1.4.m4.1.1">subscript</csymbol><ci id="S2.SS2.p1.4.m4.1.1.2.cmml" xref="S2.SS2.p1.4.m4.1.1.2">𝒟</ci><ci id="S2.SS2.p1.4.m4.1.1.3.cmml" xref="S2.SS2.p1.4.m4.1.1.3">𝑣</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.4.m4.1c">{\mathcal{D}}_{v}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.4.m4.1d">caligraphic_D start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT</annotation></semantics></math>, and <math alttext="\delta_{z}" class="ltx_Math" display="inline" id="S2.SS2.p1.5.m5.1"><semantics id="S2.SS2.p1.5.m5.1a"><msub id="S2.SS2.p1.5.m5.1.1" xref="S2.SS2.p1.5.m5.1.1.cmml"><mi id="S2.SS2.p1.5.m5.1.1.2" xref="S2.SS2.p1.5.m5.1.1.2.cmml">δ</mi><mi id="S2.SS2.p1.5.m5.1.1.3" xref="S2.SS2.p1.5.m5.1.1.3.cmml">z</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.5.m5.1b"><apply id="S2.SS2.p1.5.m5.1.1.cmml" xref="S2.SS2.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.5.m5.1.1.1.cmml" xref="S2.SS2.p1.5.m5.1.1">subscript</csymbol><ci id="S2.SS2.p1.5.m5.1.1.2.cmml" xref="S2.SS2.p1.5.m5.1.1.2">𝛿</ci><ci id="S2.SS2.p1.5.m5.1.1.3.cmml" xref="S2.SS2.p1.5.m5.1.1.3">𝑧</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.5.m5.1c">\delta_{z}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.5.m5.1d">italic_δ start_POSTSUBSCRIPT italic_z end_POSTSUBSCRIPT</annotation></semantics></math> is the Dirac delta at <math alttext="z" class="ltx_Math" display="inline" id="S2.SS2.p1.6.m6.1"><semantics id="S2.SS2.p1.6.m6.1a"><mi id="S2.SS2.p1.6.m6.1.1" xref="S2.SS2.p1.6.m6.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.6.m6.1b"><ci id="S2.SS2.p1.6.m6.1.1.cmml" xref="S2.SS2.p1.6.m6.1.1">𝑧</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.6.m6.1c">z</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.6.m6.1d">italic_z</annotation></semantics></math>. Define two discrete measures as <math alttext="\mu=\sum_{i=1}^{m}a_{i}\delta_{z_{i}},\nu=\sum_{j=1}^{n}b_{j}\delta_{z_{j}}" class="ltx_Math" display="inline" id="S2.SS2.p1.7.m7.2"><semantics id="S2.SS2.p1.7.m7.2a"><mrow id="S2.SS2.p1.7.m7.2.2.2" xref="S2.SS2.p1.7.m7.2.2.3.cmml"><mrow id="S2.SS2.p1.7.m7.1.1.1.1" xref="S2.SS2.p1.7.m7.1.1.1.1.cmml"><mi id="S2.SS2.p1.7.m7.1.1.1.1.2" xref="S2.SS2.p1.7.m7.1.1.1.1.2.cmml">μ</mi><mo id="S2.SS2.p1.7.m7.1.1.1.1.1" rspace="0.111em" xref="S2.SS2.p1.7.m7.1.1.1.1.1.cmml">=</mo><mrow id="S2.SS2.p1.7.m7.1.1.1.1.3" xref="S2.SS2.p1.7.m7.1.1.1.1.3.cmml"><msubsup id="S2.SS2.p1.7.m7.1.1.1.1.3.1" xref="S2.SS2.p1.7.m7.1.1.1.1.3.1.cmml"><mo id="S2.SS2.p1.7.m7.1.1.1.1.3.1.2.2" xref="S2.SS2.p1.7.m7.1.1.1.1.3.1.2.2.cmml">∑</mo><mrow id="S2.SS2.p1.7.m7.1.1.1.1.3.1.2.3" xref="S2.SS2.p1.7.m7.1.1.1.1.3.1.2.3.cmml"><mi id="S2.SS2.p1.7.m7.1.1.1.1.3.1.2.3.2" xref="S2.SS2.p1.7.m7.1.1.1.1.3.1.2.3.2.cmml">i</mi><mo id="S2.SS2.p1.7.m7.1.1.1.1.3.1.2.3.1" xref="S2.SS2.p1.7.m7.1.1.1.1.3.1.2.3.1.cmml">=</mo><mn id="S2.SS2.p1.7.m7.1.1.1.1.3.1.2.3.3" xref="S2.SS2.p1.7.m7.1.1.1.1.3.1.2.3.3.cmml">1</mn></mrow><mi id="S2.SS2.p1.7.m7.1.1.1.1.3.1.3" xref="S2.SS2.p1.7.m7.1.1.1.1.3.1.3.cmml">m</mi></msubsup><mrow id="S2.SS2.p1.7.m7.1.1.1.1.3.2" xref="S2.SS2.p1.7.m7.1.1.1.1.3.2.cmml"><msub id="S2.SS2.p1.7.m7.1.1.1.1.3.2.2" xref="S2.SS2.p1.7.m7.1.1.1.1.3.2.2.cmml"><mi id="S2.SS2.p1.7.m7.1.1.1.1.3.2.2.2" xref="S2.SS2.p1.7.m7.1.1.1.1.3.2.2.2.cmml">a</mi><mi id="S2.SS2.p1.7.m7.1.1.1.1.3.2.2.3" xref="S2.SS2.p1.7.m7.1.1.1.1.3.2.2.3.cmml">i</mi></msub><mo id="S2.SS2.p1.7.m7.1.1.1.1.3.2.1" xref="S2.SS2.p1.7.m7.1.1.1.1.3.2.1.cmml">⁢</mo><msub id="S2.SS2.p1.7.m7.1.1.1.1.3.2.3" xref="S2.SS2.p1.7.m7.1.1.1.1.3.2.3.cmml"><mi id="S2.SS2.p1.7.m7.1.1.1.1.3.2.3.2" xref="S2.SS2.p1.7.m7.1.1.1.1.3.2.3.2.cmml">δ</mi><msub id="S2.SS2.p1.7.m7.1.1.1.1.3.2.3.3" xref="S2.SS2.p1.7.m7.1.1.1.1.3.2.3.3.cmml"><mi id="S2.SS2.p1.7.m7.1.1.1.1.3.2.3.3.2" xref="S2.SS2.p1.7.m7.1.1.1.1.3.2.3.3.2.cmml">z</mi><mi id="S2.SS2.p1.7.m7.1.1.1.1.3.2.3.3.3" xref="S2.SS2.p1.7.m7.1.1.1.1.3.2.3.3.3.cmml">i</mi></msub></msub></mrow></mrow></mrow><mo id="S2.SS2.p1.7.m7.2.2.2.3" xref="S2.SS2.p1.7.m7.2.2.3a.cmml">,</mo><mrow id="S2.SS2.p1.7.m7.2.2.2.2" xref="S2.SS2.p1.7.m7.2.2.2.2.cmml"><mi id="S2.SS2.p1.7.m7.2.2.2.2.2" xref="S2.SS2.p1.7.m7.2.2.2.2.2.cmml">ν</mi><mo id="S2.SS2.p1.7.m7.2.2.2.2.1" rspace="0.111em" xref="S2.SS2.p1.7.m7.2.2.2.2.1.cmml">=</mo><mrow id="S2.SS2.p1.7.m7.2.2.2.2.3" xref="S2.SS2.p1.7.m7.2.2.2.2.3.cmml"><msubsup id="S2.SS2.p1.7.m7.2.2.2.2.3.1" xref="S2.SS2.p1.7.m7.2.2.2.2.3.1.cmml"><mo id="S2.SS2.p1.7.m7.2.2.2.2.3.1.2.2" xref="S2.SS2.p1.7.m7.2.2.2.2.3.1.2.2.cmml">∑</mo><mrow id="S2.SS2.p1.7.m7.2.2.2.2.3.1.2.3" xref="S2.SS2.p1.7.m7.2.2.2.2.3.1.2.3.cmml"><mi id="S2.SS2.p1.7.m7.2.2.2.2.3.1.2.3.2" xref="S2.SS2.p1.7.m7.2.2.2.2.3.1.2.3.2.cmml">j</mi><mo id="S2.SS2.p1.7.m7.2.2.2.2.3.1.2.3.1" xref="S2.SS2.p1.7.m7.2.2.2.2.3.1.2.3.1.cmml">=</mo><mn id="S2.SS2.p1.7.m7.2.2.2.2.3.1.2.3.3" xref="S2.SS2.p1.7.m7.2.2.2.2.3.1.2.3.3.cmml">1</mn></mrow><mi id="S2.SS2.p1.7.m7.2.2.2.2.3.1.3" xref="S2.SS2.p1.7.m7.2.2.2.2.3.1.3.cmml">n</mi></msubsup><mrow id="S2.SS2.p1.7.m7.2.2.2.2.3.2" xref="S2.SS2.p1.7.m7.2.2.2.2.3.2.cmml"><msub id="S2.SS2.p1.7.m7.2.2.2.2.3.2.2" xref="S2.SS2.p1.7.m7.2.2.2.2.3.2.2.cmml"><mi id="S2.SS2.p1.7.m7.2.2.2.2.3.2.2.2" xref="S2.SS2.p1.7.m7.2.2.2.2.3.2.2.2.cmml">b</mi><mi id="S2.SS2.p1.7.m7.2.2.2.2.3.2.2.3" xref="S2.SS2.p1.7.m7.2.2.2.2.3.2.2.3.cmml">j</mi></msub><mo id="S2.SS2.p1.7.m7.2.2.2.2.3.2.1" xref="S2.SS2.p1.7.m7.2.2.2.2.3.2.1.cmml">⁢</mo><msub id="S2.SS2.p1.7.m7.2.2.2.2.3.2.3" xref="S2.SS2.p1.7.m7.2.2.2.2.3.2.3.cmml"><mi id="S2.SS2.p1.7.m7.2.2.2.2.3.2.3.2" xref="S2.SS2.p1.7.m7.2.2.2.2.3.2.3.2.cmml">δ</mi><msub id="S2.SS2.p1.7.m7.2.2.2.2.3.2.3.3" xref="S2.SS2.p1.7.m7.2.2.2.2.3.2.3.3.cmml"><mi id="S2.SS2.p1.7.m7.2.2.2.2.3.2.3.3.2" xref="S2.SS2.p1.7.m7.2.2.2.2.3.2.3.3.2.cmml">z</mi><mi id="S2.SS2.p1.7.m7.2.2.2.2.3.2.3.3.3" xref="S2.SS2.p1.7.m7.2.2.2.2.3.2.3.3.3.cmml">j</mi></msub></msub></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.7.m7.2b"><apply id="S2.SS2.p1.7.m7.2.2.3.cmml" xref="S2.SS2.p1.7.m7.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.p1.7.m7.2.2.3a.cmml" xref="S2.SS2.p1.7.m7.2.2.2.3">formulae-sequence</csymbol><apply id="S2.SS2.p1.7.m7.1.1.1.1.cmml" xref="S2.SS2.p1.7.m7.1.1.1.1"><eq id="S2.SS2.p1.7.m7.1.1.1.1.1.cmml" xref="S2.SS2.p1.7.m7.1.1.1.1.1"></eq><ci id="S2.SS2.p1.7.m7.1.1.1.1.2.cmml" xref="S2.SS2.p1.7.m7.1.1.1.1.2">𝜇</ci><apply id="S2.SS2.p1.7.m7.1.1.1.1.3.cmml" xref="S2.SS2.p1.7.m7.1.1.1.1.3"><apply id="S2.SS2.p1.7.m7.1.1.1.1.3.1.cmml" xref="S2.SS2.p1.7.m7.1.1.1.1.3.1"><csymbol cd="ambiguous" id="S2.SS2.p1.7.m7.1.1.1.1.3.1.1.cmml" xref="S2.SS2.p1.7.m7.1.1.1.1.3.1">superscript</csymbol><apply id="S2.SS2.p1.7.m7.1.1.1.1.3.1.2.cmml" xref="S2.SS2.p1.7.m7.1.1.1.1.3.1"><csymbol cd="ambiguous" id="S2.SS2.p1.7.m7.1.1.1.1.3.1.2.1.cmml" xref="S2.SS2.p1.7.m7.1.1.1.1.3.1">subscript</csymbol><sum id="S2.SS2.p1.7.m7.1.1.1.1.3.1.2.2.cmml" xref="S2.SS2.p1.7.m7.1.1.1.1.3.1.2.2"></sum><apply id="S2.SS2.p1.7.m7.1.1.1.1.3.1.2.3.cmml" xref="S2.SS2.p1.7.m7.1.1.1.1.3.1.2.3"><eq id="S2.SS2.p1.7.m7.1.1.1.1.3.1.2.3.1.cmml" xref="S2.SS2.p1.7.m7.1.1.1.1.3.1.2.3.1"></eq><ci id="S2.SS2.p1.7.m7.1.1.1.1.3.1.2.3.2.cmml" xref="S2.SS2.p1.7.m7.1.1.1.1.3.1.2.3.2">𝑖</ci><cn id="S2.SS2.p1.7.m7.1.1.1.1.3.1.2.3.3.cmml" type="integer" xref="S2.SS2.p1.7.m7.1.1.1.1.3.1.2.3.3">1</cn></apply></apply><ci id="S2.SS2.p1.7.m7.1.1.1.1.3.1.3.cmml" xref="S2.SS2.p1.7.m7.1.1.1.1.3.1.3">𝑚</ci></apply><apply id="S2.SS2.p1.7.m7.1.1.1.1.3.2.cmml" xref="S2.SS2.p1.7.m7.1.1.1.1.3.2"><times id="S2.SS2.p1.7.m7.1.1.1.1.3.2.1.cmml" xref="S2.SS2.p1.7.m7.1.1.1.1.3.2.1"></times><apply id="S2.SS2.p1.7.m7.1.1.1.1.3.2.2.cmml" xref="S2.SS2.p1.7.m7.1.1.1.1.3.2.2"><csymbol cd="ambiguous" id="S2.SS2.p1.7.m7.1.1.1.1.3.2.2.1.cmml" xref="S2.SS2.p1.7.m7.1.1.1.1.3.2.2">subscript</csymbol><ci id="S2.SS2.p1.7.m7.1.1.1.1.3.2.2.2.cmml" xref="S2.SS2.p1.7.m7.1.1.1.1.3.2.2.2">𝑎</ci><ci id="S2.SS2.p1.7.m7.1.1.1.1.3.2.2.3.cmml" xref="S2.SS2.p1.7.m7.1.1.1.1.3.2.2.3">𝑖</ci></apply><apply id="S2.SS2.p1.7.m7.1.1.1.1.3.2.3.cmml" xref="S2.SS2.p1.7.m7.1.1.1.1.3.2.3"><csymbol cd="ambiguous" id="S2.SS2.p1.7.m7.1.1.1.1.3.2.3.1.cmml" xref="S2.SS2.p1.7.m7.1.1.1.1.3.2.3">subscript</csymbol><ci id="S2.SS2.p1.7.m7.1.1.1.1.3.2.3.2.cmml" xref="S2.SS2.p1.7.m7.1.1.1.1.3.2.3.2">𝛿</ci><apply id="S2.SS2.p1.7.m7.1.1.1.1.3.2.3.3.cmml" xref="S2.SS2.p1.7.m7.1.1.1.1.3.2.3.3"><csymbol cd="ambiguous" id="S2.SS2.p1.7.m7.1.1.1.1.3.2.3.3.1.cmml" xref="S2.SS2.p1.7.m7.1.1.1.1.3.2.3.3">subscript</csymbol><ci id="S2.SS2.p1.7.m7.1.1.1.1.3.2.3.3.2.cmml" xref="S2.SS2.p1.7.m7.1.1.1.1.3.2.3.3.2">𝑧</ci><ci id="S2.SS2.p1.7.m7.1.1.1.1.3.2.3.3.3.cmml" xref="S2.SS2.p1.7.m7.1.1.1.1.3.2.3.3.3">𝑖</ci></apply></apply></apply></apply></apply><apply id="S2.SS2.p1.7.m7.2.2.2.2.cmml" xref="S2.SS2.p1.7.m7.2.2.2.2"><eq id="S2.SS2.p1.7.m7.2.2.2.2.1.cmml" xref="S2.SS2.p1.7.m7.2.2.2.2.1"></eq><ci id="S2.SS2.p1.7.m7.2.2.2.2.2.cmml" xref="S2.SS2.p1.7.m7.2.2.2.2.2">𝜈</ci><apply id="S2.SS2.p1.7.m7.2.2.2.2.3.cmml" xref="S2.SS2.p1.7.m7.2.2.2.2.3"><apply id="S2.SS2.p1.7.m7.2.2.2.2.3.1.cmml" xref="S2.SS2.p1.7.m7.2.2.2.2.3.1"><csymbol cd="ambiguous" id="S2.SS2.p1.7.m7.2.2.2.2.3.1.1.cmml" xref="S2.SS2.p1.7.m7.2.2.2.2.3.1">superscript</csymbol><apply id="S2.SS2.p1.7.m7.2.2.2.2.3.1.2.cmml" xref="S2.SS2.p1.7.m7.2.2.2.2.3.1"><csymbol cd="ambiguous" id="S2.SS2.p1.7.m7.2.2.2.2.3.1.2.1.cmml" xref="S2.SS2.p1.7.m7.2.2.2.2.3.1">subscript</csymbol><sum id="S2.SS2.p1.7.m7.2.2.2.2.3.1.2.2.cmml" xref="S2.SS2.p1.7.m7.2.2.2.2.3.1.2.2"></sum><apply id="S2.SS2.p1.7.m7.2.2.2.2.3.1.2.3.cmml" xref="S2.SS2.p1.7.m7.2.2.2.2.3.1.2.3"><eq id="S2.SS2.p1.7.m7.2.2.2.2.3.1.2.3.1.cmml" xref="S2.SS2.p1.7.m7.2.2.2.2.3.1.2.3.1"></eq><ci id="S2.SS2.p1.7.m7.2.2.2.2.3.1.2.3.2.cmml" xref="S2.SS2.p1.7.m7.2.2.2.2.3.1.2.3.2">𝑗</ci><cn id="S2.SS2.p1.7.m7.2.2.2.2.3.1.2.3.3.cmml" type="integer" xref="S2.SS2.p1.7.m7.2.2.2.2.3.1.2.3.3">1</cn></apply></apply><ci id="S2.SS2.p1.7.m7.2.2.2.2.3.1.3.cmml" xref="S2.SS2.p1.7.m7.2.2.2.2.3.1.3">𝑛</ci></apply><apply id="S2.SS2.p1.7.m7.2.2.2.2.3.2.cmml" xref="S2.SS2.p1.7.m7.2.2.2.2.3.2"><times id="S2.SS2.p1.7.m7.2.2.2.2.3.2.1.cmml" xref="S2.SS2.p1.7.m7.2.2.2.2.3.2.1"></times><apply id="S2.SS2.p1.7.m7.2.2.2.2.3.2.2.cmml" xref="S2.SS2.p1.7.m7.2.2.2.2.3.2.2"><csymbol cd="ambiguous" id="S2.SS2.p1.7.m7.2.2.2.2.3.2.2.1.cmml" xref="S2.SS2.p1.7.m7.2.2.2.2.3.2.2">subscript</csymbol><ci id="S2.SS2.p1.7.m7.2.2.2.2.3.2.2.2.cmml" xref="S2.SS2.p1.7.m7.2.2.2.2.3.2.2.2">𝑏</ci><ci id="S2.SS2.p1.7.m7.2.2.2.2.3.2.2.3.cmml" xref="S2.SS2.p1.7.m7.2.2.2.2.3.2.2.3">𝑗</ci></apply><apply id="S2.SS2.p1.7.m7.2.2.2.2.3.2.3.cmml" xref="S2.SS2.p1.7.m7.2.2.2.2.3.2.3"><csymbol cd="ambiguous" id="S2.SS2.p1.7.m7.2.2.2.2.3.2.3.1.cmml" xref="S2.SS2.p1.7.m7.2.2.2.2.3.2.3">subscript</csymbol><ci id="S2.SS2.p1.7.m7.2.2.2.2.3.2.3.2.cmml" xref="S2.SS2.p1.7.m7.2.2.2.2.3.2.3.2">𝛿</ci><apply id="S2.SS2.p1.7.m7.2.2.2.2.3.2.3.3.cmml" xref="S2.SS2.p1.7.m7.2.2.2.2.3.2.3.3"><csymbol cd="ambiguous" id="S2.SS2.p1.7.m7.2.2.2.2.3.2.3.3.1.cmml" xref="S2.SS2.p1.7.m7.2.2.2.2.3.2.3.3">subscript</csymbol><ci id="S2.SS2.p1.7.m7.2.2.2.2.3.2.3.3.2.cmml" xref="S2.SS2.p1.7.m7.2.2.2.2.3.2.3.3.2">𝑧</ci><ci id="S2.SS2.p1.7.m7.2.2.2.2.3.2.3.3.3.cmml" xref="S2.SS2.p1.7.m7.2.2.2.2.3.2.3.3.3">𝑗</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.7.m7.2c">\mu=\sum_{i=1}^{m}a_{i}\delta_{z_{i}},\nu=\sum_{j=1}^{n}b_{j}\delta_{z_{j}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.7.m7.2d">italic_μ = ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_m end_POSTSUPERSCRIPT italic_a start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT italic_δ start_POSTSUBSCRIPT italic_z start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT , italic_ν = ∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT italic_b start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT italic_δ start_POSTSUBSCRIPT italic_z start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math>. Then, EMD between probability distributions defined over <math alttext="{\mathcal{Z}}" class="ltx_Math" display="inline" id="S2.SS2.p1.8.m8.1"><semantics id="S2.SS2.p1.8.m8.1a"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p1.8.m8.1.1" xref="S2.SS2.p1.8.m8.1.1.cmml">𝒵</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.8.m8.1b"><ci id="S2.SS2.p1.8.m8.1.1.cmml" xref="S2.SS2.p1.8.m8.1.1">𝒵</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.8.m8.1c">{\mathcal{Z}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.8.m8.1d">caligraphic_Z</annotation></semantics></math>, is the objective value of the following linear program:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\min\limits_{{\bm{P}}}\ \langle{\bm{P}},{\bm{D}}\rangle,\quad\mathrm{\,s.t.\ }%
{\bm{P}}{\bm{1}}_{m}=a,~{}{\bm{P}}^{\top}{\bm{1}}_{n}=b." class="ltx_Math" display="block" id="S2.E3.m1.5"><semantics id="S2.E3.m1.5a"><mrow id="S2.E3.m1.5.5.1"><mrow id="S2.E3.m1.5.5.1.1.2" xref="S2.E3.m1.5.5.1.1.3.cmml"><mrow id="S2.E3.m1.5.5.1.1.1.1.1" xref="S2.E3.m1.5.5.1.1.1.1.2.cmml"><mrow id="S2.E3.m1.5.5.1.1.1.1.1.1.1" xref="S2.E3.m1.5.5.1.1.1.1.1.1.2.cmml"><munder id="S2.E3.m1.5.5.1.1.1.1.1.1.1.1" xref="S2.E3.m1.5.5.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E3.m1.5.5.1.1.1.1.1.1.1.1.2" xref="S2.E3.m1.5.5.1.1.1.1.1.1.1.1.2.cmml">min</mi><mi id="S2.E3.m1.5.5.1.1.1.1.1.1.1.1.3" xref="S2.E3.m1.5.5.1.1.1.1.1.1.1.1.3.cmml">𝑷</mi></munder><mo id="S2.E3.m1.5.5.1.1.1.1.1.1.1a" lspace="0.500em" xref="S2.E3.m1.5.5.1.1.1.1.1.1.2.cmml">⁡</mo><mrow id="S2.E3.m1.5.5.1.1.1.1.1.1.1.2" xref="S2.E3.m1.5.5.1.1.1.1.1.1.2.cmml"><mo id="S2.E3.m1.5.5.1.1.1.1.1.1.1.2.1" stretchy="false" xref="S2.E3.m1.5.5.1.1.1.1.1.1.2.cmml">⟨</mo><mi id="S2.E3.m1.1.1" xref="S2.E3.m1.1.1.cmml">𝑷</mi><mo id="S2.E3.m1.5.5.1.1.1.1.1.1.1.2.2" xref="S2.E3.m1.5.5.1.1.1.1.1.1.2.cmml">,</mo><mi id="S2.E3.m1.2.2" xref="S2.E3.m1.2.2.cmml">𝑫</mi><mo id="S2.E3.m1.5.5.1.1.1.1.1.1.1.2.3" stretchy="false" xref="S2.E3.m1.5.5.1.1.1.1.1.1.2.cmml">⟩</mo></mrow></mrow><mo id="S2.E3.m1.5.5.1.1.1.1.1.2" rspace="1.337em" xref="S2.E3.m1.5.5.1.1.1.1.2.cmml">,</mo><mi id="S2.E3.m1.3.3" mathvariant="normal" xref="S2.E3.m1.3.3.cmml">s</mi></mrow><mo id="S2.E3.m1.5.5.1.1.2.3" lspace="0em" rspace="0.167em" xref="S2.E3.m1.5.5.1.1.3a.cmml">.</mo><mi id="S2.E3.m1.4.4" mathvariant="normal" xref="S2.E3.m1.4.4.cmml">t</mi><mo id="S2.E3.m1.5.5.1.1.2.4" lspace="0em" rspace="0.667em" xref="S2.E3.m1.5.5.1.1.3a.cmml">.</mo><mrow id="S2.E3.m1.5.5.1.1.2.2.2" xref="S2.E3.m1.5.5.1.1.2.2.3.cmml"><mrow id="S2.E3.m1.5.5.1.1.2.2.1.1" xref="S2.E3.m1.5.5.1.1.2.2.1.1.cmml"><mrow id="S2.E3.m1.5.5.1.1.2.2.1.1.2" xref="S2.E3.m1.5.5.1.1.2.2.1.1.2.cmml"><mi id="S2.E3.m1.5.5.1.1.2.2.1.1.2.2" xref="S2.E3.m1.5.5.1.1.2.2.1.1.2.2.cmml">𝑷</mi><mo id="S2.E3.m1.5.5.1.1.2.2.1.1.2.1" xref="S2.E3.m1.5.5.1.1.2.2.1.1.2.1.cmml">⁢</mo><msub id="S2.E3.m1.5.5.1.1.2.2.1.1.2.3" xref="S2.E3.m1.5.5.1.1.2.2.1.1.2.3.cmml"><mn id="S2.E3.m1.5.5.1.1.2.2.1.1.2.3.2" xref="S2.E3.m1.5.5.1.1.2.2.1.1.2.3.2.cmml">𝟏</mn><mi id="S2.E3.m1.5.5.1.1.2.2.1.1.2.3.3" xref="S2.E3.m1.5.5.1.1.2.2.1.1.2.3.3.cmml">m</mi></msub></mrow><mo id="S2.E3.m1.5.5.1.1.2.2.1.1.1" xref="S2.E3.m1.5.5.1.1.2.2.1.1.1.cmml">=</mo><mi id="S2.E3.m1.5.5.1.1.2.2.1.1.3" xref="S2.E3.m1.5.5.1.1.2.2.1.1.3.cmml">a</mi></mrow><mo id="S2.E3.m1.5.5.1.1.2.2.2.3" rspace="0.497em" xref="S2.E3.m1.5.5.1.1.2.2.3a.cmml">,</mo><mrow id="S2.E3.m1.5.5.1.1.2.2.2.2" xref="S2.E3.m1.5.5.1.1.2.2.2.2.cmml"><mrow id="S2.E3.m1.5.5.1.1.2.2.2.2.2" xref="S2.E3.m1.5.5.1.1.2.2.2.2.2.cmml"><msup id="S2.E3.m1.5.5.1.1.2.2.2.2.2.2" xref="S2.E3.m1.5.5.1.1.2.2.2.2.2.2.cmml"><mi id="S2.E3.m1.5.5.1.1.2.2.2.2.2.2.2" xref="S2.E3.m1.5.5.1.1.2.2.2.2.2.2.2.cmml">𝑷</mi><mo id="S2.E3.m1.5.5.1.1.2.2.2.2.2.2.3" xref="S2.E3.m1.5.5.1.1.2.2.2.2.2.2.3.cmml">⊤</mo></msup><mo id="S2.E3.m1.5.5.1.1.2.2.2.2.2.1" xref="S2.E3.m1.5.5.1.1.2.2.2.2.2.1.cmml">⁢</mo><msub id="S2.E3.m1.5.5.1.1.2.2.2.2.2.3" xref="S2.E3.m1.5.5.1.1.2.2.2.2.2.3.cmml"><mn id="S2.E3.m1.5.5.1.1.2.2.2.2.2.3.2" xref="S2.E3.m1.5.5.1.1.2.2.2.2.2.3.2.cmml">𝟏</mn><mi id="S2.E3.m1.5.5.1.1.2.2.2.2.2.3.3" xref="S2.E3.m1.5.5.1.1.2.2.2.2.2.3.3.cmml">n</mi></msub></mrow><mo id="S2.E3.m1.5.5.1.1.2.2.2.2.1" xref="S2.E3.m1.5.5.1.1.2.2.2.2.1.cmml">=</mo><mi id="S2.E3.m1.5.5.1.1.2.2.2.2.3" xref="S2.E3.m1.5.5.1.1.2.2.2.2.3.cmml">b</mi></mrow></mrow></mrow><mo id="S2.E3.m1.5.5.1.2" lspace="0em">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E3.m1.5b"><apply id="S2.E3.m1.5.5.1.1.3.cmml" xref="S2.E3.m1.5.5.1.1.2"><csymbol cd="ambiguous" id="S2.E3.m1.5.5.1.1.3a.cmml" xref="S2.E3.m1.5.5.1.1.2.3">formulae-sequence</csymbol><list id="S2.E3.m1.5.5.1.1.1.1.2.cmml" xref="S2.E3.m1.5.5.1.1.1.1.1"><apply id="S2.E3.m1.5.5.1.1.1.1.1.1.2.cmml" xref="S2.E3.m1.5.5.1.1.1.1.1.1.1"><apply id="S2.E3.m1.5.5.1.1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.5.5.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E3.m1.5.5.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.5.5.1.1.1.1.1.1.1.1">subscript</csymbol><min id="S2.E3.m1.5.5.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E3.m1.5.5.1.1.1.1.1.1.1.1.2"></min><ci id="S2.E3.m1.5.5.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E3.m1.5.5.1.1.1.1.1.1.1.1.3">𝑷</ci></apply><ci id="S2.E3.m1.1.1.cmml" xref="S2.E3.m1.1.1">𝑷</ci><ci id="S2.E3.m1.2.2.cmml" xref="S2.E3.m1.2.2">𝑫</ci></apply><ci id="S2.E3.m1.3.3.cmml" xref="S2.E3.m1.3.3">s</ci></list><ci id="S2.E3.m1.4.4.cmml" xref="S2.E3.m1.4.4">t</ci><apply id="S2.E3.m1.5.5.1.1.2.2.3.cmml" xref="S2.E3.m1.5.5.1.1.2.2.2"><csymbol cd="ambiguous" id="S2.E3.m1.5.5.1.1.2.2.3a.cmml" xref="S2.E3.m1.5.5.1.1.2.2.2.3">formulae-sequence</csymbol><apply id="S2.E3.m1.5.5.1.1.2.2.1.1.cmml" xref="S2.E3.m1.5.5.1.1.2.2.1.1"><eq id="S2.E3.m1.5.5.1.1.2.2.1.1.1.cmml" xref="S2.E3.m1.5.5.1.1.2.2.1.1.1"></eq><apply id="S2.E3.m1.5.5.1.1.2.2.1.1.2.cmml" xref="S2.E3.m1.5.5.1.1.2.2.1.1.2"><times id="S2.E3.m1.5.5.1.1.2.2.1.1.2.1.cmml" xref="S2.E3.m1.5.5.1.1.2.2.1.1.2.1"></times><ci id="S2.E3.m1.5.5.1.1.2.2.1.1.2.2.cmml" xref="S2.E3.m1.5.5.1.1.2.2.1.1.2.2">𝑷</ci><apply id="S2.E3.m1.5.5.1.1.2.2.1.1.2.3.cmml" xref="S2.E3.m1.5.5.1.1.2.2.1.1.2.3"><csymbol cd="ambiguous" id="S2.E3.m1.5.5.1.1.2.2.1.1.2.3.1.cmml" xref="S2.E3.m1.5.5.1.1.2.2.1.1.2.3">subscript</csymbol><cn id="S2.E3.m1.5.5.1.1.2.2.1.1.2.3.2.cmml" type="integer" xref="S2.E3.m1.5.5.1.1.2.2.1.1.2.3.2">1</cn><ci id="S2.E3.m1.5.5.1.1.2.2.1.1.2.3.3.cmml" xref="S2.E3.m1.5.5.1.1.2.2.1.1.2.3.3">𝑚</ci></apply></apply><ci id="S2.E3.m1.5.5.1.1.2.2.1.1.3.cmml" xref="S2.E3.m1.5.5.1.1.2.2.1.1.3">𝑎</ci></apply><apply id="S2.E3.m1.5.5.1.1.2.2.2.2.cmml" xref="S2.E3.m1.5.5.1.1.2.2.2.2"><eq id="S2.E3.m1.5.5.1.1.2.2.2.2.1.cmml" xref="S2.E3.m1.5.5.1.1.2.2.2.2.1"></eq><apply id="S2.E3.m1.5.5.1.1.2.2.2.2.2.cmml" xref="S2.E3.m1.5.5.1.1.2.2.2.2.2"><times id="S2.E3.m1.5.5.1.1.2.2.2.2.2.1.cmml" xref="S2.E3.m1.5.5.1.1.2.2.2.2.2.1"></times><apply id="S2.E3.m1.5.5.1.1.2.2.2.2.2.2.cmml" xref="S2.E3.m1.5.5.1.1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.E3.m1.5.5.1.1.2.2.2.2.2.2.1.cmml" xref="S2.E3.m1.5.5.1.1.2.2.2.2.2.2">superscript</csymbol><ci id="S2.E3.m1.5.5.1.1.2.2.2.2.2.2.2.cmml" xref="S2.E3.m1.5.5.1.1.2.2.2.2.2.2.2">𝑷</ci><csymbol cd="latexml" id="S2.E3.m1.5.5.1.1.2.2.2.2.2.2.3.cmml" xref="S2.E3.m1.5.5.1.1.2.2.2.2.2.2.3">top</csymbol></apply><apply id="S2.E3.m1.5.5.1.1.2.2.2.2.2.3.cmml" xref="S2.E3.m1.5.5.1.1.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S2.E3.m1.5.5.1.1.2.2.2.2.2.3.1.cmml" xref="S2.E3.m1.5.5.1.1.2.2.2.2.2.3">subscript</csymbol><cn id="S2.E3.m1.5.5.1.1.2.2.2.2.2.3.2.cmml" type="integer" xref="S2.E3.m1.5.5.1.1.2.2.2.2.2.3.2">1</cn><ci id="S2.E3.m1.5.5.1.1.2.2.2.2.2.3.3.cmml" xref="S2.E3.m1.5.5.1.1.2.2.2.2.2.3.3">𝑛</ci></apply></apply><ci id="S2.E3.m1.5.5.1.1.2.2.2.2.3.cmml" xref="S2.E3.m1.5.5.1.1.2.2.2.2.3">𝑏</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E3.m1.5c">\min\limits_{{\bm{P}}}\ \langle{\bm{P}},{\bm{D}}\rangle,\quad\mathrm{\,s.t.\ }%
{\bm{P}}{\bm{1}}_{m}=a,~{}{\bm{P}}^{\top}{\bm{1}}_{n}=b.</annotation><annotation encoding="application/x-llamapun" id="S2.E3.m1.5d">roman_min start_POSTSUBSCRIPT bold_italic_P end_POSTSUBSCRIPT ⟨ bold_italic_P , bold_italic_D ⟩ , roman_s . roman_t . bold_italic_P bold_1 start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT = italic_a , bold_italic_P start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT bold_1 start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT = italic_b .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS2.p1.22">In Eq.<a class="ltx_ref" href="https://arxiv.org/html/2410.03052v1#S2.E3" title="Equation 3 ‣ 2.2 Exact Earth Mover’s Distance ‣ 2 Preliminaries ‣ Learning Structured Representations by Embedding Class Hierarchy with Fast Optimal Transport"><span class="ltx_text ltx_ref_tag">3</span></a>, <math alttext="\langle\cdot,\cdot\rangle" class="ltx_Math" display="inline" id="S2.SS2.p1.9.m1.2"><semantics id="S2.SS2.p1.9.m1.2a"><mrow id="S2.SS2.p1.9.m1.2.3.2" xref="S2.SS2.p1.9.m1.2.3.1.cmml"><mo id="S2.SS2.p1.9.m1.2.3.2.1" stretchy="false" xref="S2.SS2.p1.9.m1.2.3.1.cmml">⟨</mo><mo id="S2.SS2.p1.9.m1.1.1" lspace="0em" rspace="0em" xref="S2.SS2.p1.9.m1.1.1.cmml">⋅</mo><mo id="S2.SS2.p1.9.m1.2.3.2.2" rspace="0em" xref="S2.SS2.p1.9.m1.2.3.1.cmml">,</mo><mo id="S2.SS2.p1.9.m1.2.2" lspace="0em" rspace="0em" xref="S2.SS2.p1.9.m1.2.2.cmml">⋅</mo><mo id="S2.SS2.p1.9.m1.2.3.2.3" stretchy="false" xref="S2.SS2.p1.9.m1.2.3.1.cmml">⟩</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.9.m1.2b"><list id="S2.SS2.p1.9.m1.2.3.1.cmml" xref="S2.SS2.p1.9.m1.2.3.2"><ci id="S2.SS2.p1.9.m1.1.1.cmml" xref="S2.SS2.p1.9.m1.1.1">⋅</ci><ci id="S2.SS2.p1.9.m1.2.2.cmml" xref="S2.SS2.p1.9.m1.2.2">⋅</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.9.m1.2c">\langle\cdot,\cdot\rangle</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.9.m1.2d">⟨ ⋅ , ⋅ ⟩</annotation></semantics></math> is the Frobenius inner product, <math alttext="{\bm{1}}_{N}" class="ltx_Math" display="inline" id="S2.SS2.p1.10.m2.1"><semantics id="S2.SS2.p1.10.m2.1a"><msub id="S2.SS2.p1.10.m2.1.1" xref="S2.SS2.p1.10.m2.1.1.cmml"><mn id="S2.SS2.p1.10.m2.1.1.2" xref="S2.SS2.p1.10.m2.1.1.2.cmml">𝟏</mn><mi id="S2.SS2.p1.10.m2.1.1.3" xref="S2.SS2.p1.10.m2.1.1.3.cmml">N</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.10.m2.1b"><apply id="S2.SS2.p1.10.m2.1.1.cmml" xref="S2.SS2.p1.10.m2.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.10.m2.1.1.1.cmml" xref="S2.SS2.p1.10.m2.1.1">subscript</csymbol><cn id="S2.SS2.p1.10.m2.1.1.2.cmml" type="integer" xref="S2.SS2.p1.10.m2.1.1.2">1</cn><ci id="S2.SS2.p1.10.m2.1.1.3.cmml" xref="S2.SS2.p1.10.m2.1.1.3">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.10.m2.1c">{\bm{1}}_{N}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.10.m2.1d">bold_1 start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT</annotation></semantics></math> is the <math alttext="N" class="ltx_Math" display="inline" id="S2.SS2.p1.11.m3.1"><semantics id="S2.SS2.p1.11.m3.1a"><mi id="S2.SS2.p1.11.m3.1.1" xref="S2.SS2.p1.11.m3.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.11.m3.1b"><ci id="S2.SS2.p1.11.m3.1.1.cmml" xref="S2.SS2.p1.11.m3.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.11.m3.1c">N</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.11.m3.1d">italic_N</annotation></semantics></math>-dimensional all ones vector, <math alttext="{\bm{D}}" class="ltx_Math" display="inline" id="S2.SS2.p1.12.m4.1"><semantics id="S2.SS2.p1.12.m4.1a"><mi id="S2.SS2.p1.12.m4.1.1" xref="S2.SS2.p1.12.m4.1.1.cmml">𝑫</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.12.m4.1b"><ci id="S2.SS2.p1.12.m4.1.1.cmml" xref="S2.SS2.p1.12.m4.1.1">𝑫</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.12.m4.1c">{\bm{D}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.12.m4.1d">bold_italic_D</annotation></semantics></math> is the <math alttext="m\times n" class="ltx_Math" display="inline" id="S2.SS2.p1.13.m5.1"><semantics id="S2.SS2.p1.13.m5.1a"><mrow id="S2.SS2.p1.13.m5.1.1" xref="S2.SS2.p1.13.m5.1.1.cmml"><mi id="S2.SS2.p1.13.m5.1.1.2" xref="S2.SS2.p1.13.m5.1.1.2.cmml">m</mi><mo id="S2.SS2.p1.13.m5.1.1.1" lspace="0.222em" rspace="0.222em" xref="S2.SS2.p1.13.m5.1.1.1.cmml">×</mo><mi id="S2.SS2.p1.13.m5.1.1.3" xref="S2.SS2.p1.13.m5.1.1.3.cmml">n</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.13.m5.1b"><apply id="S2.SS2.p1.13.m5.1.1.cmml" xref="S2.SS2.p1.13.m5.1.1"><times id="S2.SS2.p1.13.m5.1.1.1.cmml" xref="S2.SS2.p1.13.m5.1.1.1"></times><ci id="S2.SS2.p1.13.m5.1.1.2.cmml" xref="S2.SS2.p1.13.m5.1.1.2">𝑚</ci><ci id="S2.SS2.p1.13.m5.1.1.3.cmml" xref="S2.SS2.p1.13.m5.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.13.m5.1c">m\times n</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.13.m5.1d">italic_m × italic_n</annotation></semantics></math> pairwise distance matrix where <math alttext="{\bm{D}}_{ij}=\left\lVert z_{i}-z_{j}\right\rVert" class="ltx_Math" display="inline" id="S2.SS2.p1.14.m6.1"><semantics id="S2.SS2.p1.14.m6.1a"><mrow id="S2.SS2.p1.14.m6.1.1" xref="S2.SS2.p1.14.m6.1.1.cmml"><msub id="S2.SS2.p1.14.m6.1.1.3" xref="S2.SS2.p1.14.m6.1.1.3.cmml"><mi id="S2.SS2.p1.14.m6.1.1.3.2" xref="S2.SS2.p1.14.m6.1.1.3.2.cmml">𝑫</mi><mrow id="S2.SS2.p1.14.m6.1.1.3.3" xref="S2.SS2.p1.14.m6.1.1.3.3.cmml"><mi id="S2.SS2.p1.14.m6.1.1.3.3.2" xref="S2.SS2.p1.14.m6.1.1.3.3.2.cmml">i</mi><mo id="S2.SS2.p1.14.m6.1.1.3.3.1" xref="S2.SS2.p1.14.m6.1.1.3.3.1.cmml">⁢</mo><mi id="S2.SS2.p1.14.m6.1.1.3.3.3" xref="S2.SS2.p1.14.m6.1.1.3.3.3.cmml">j</mi></mrow></msub><mo id="S2.SS2.p1.14.m6.1.1.2" rspace="0.1389em" xref="S2.SS2.p1.14.m6.1.1.2.cmml">=</mo><mrow id="S2.SS2.p1.14.m6.1.1.1.1" xref="S2.SS2.p1.14.m6.1.1.1.2.cmml"><mo fence="true" id="S2.SS2.p1.14.m6.1.1.1.1.2" lspace="0.1389em" rspace="0em" stretchy="true" xref="S2.SS2.p1.14.m6.1.1.1.2.1.cmml">∥</mo><mrow id="S2.SS2.p1.14.m6.1.1.1.1.1" xref="S2.SS2.p1.14.m6.1.1.1.1.1.cmml"><msub id="S2.SS2.p1.14.m6.1.1.1.1.1.2" xref="S2.SS2.p1.14.m6.1.1.1.1.1.2.cmml"><mi id="S2.SS2.p1.14.m6.1.1.1.1.1.2.2" xref="S2.SS2.p1.14.m6.1.1.1.1.1.2.2.cmml">z</mi><mi id="S2.SS2.p1.14.m6.1.1.1.1.1.2.3" xref="S2.SS2.p1.14.m6.1.1.1.1.1.2.3.cmml">i</mi></msub><mo id="S2.SS2.p1.14.m6.1.1.1.1.1.1" xref="S2.SS2.p1.14.m6.1.1.1.1.1.1.cmml">−</mo><msub id="S2.SS2.p1.14.m6.1.1.1.1.1.3" xref="S2.SS2.p1.14.m6.1.1.1.1.1.3.cmml"><mi id="S2.SS2.p1.14.m6.1.1.1.1.1.3.2" xref="S2.SS2.p1.14.m6.1.1.1.1.1.3.2.cmml">z</mi><mi id="S2.SS2.p1.14.m6.1.1.1.1.1.3.3" xref="S2.SS2.p1.14.m6.1.1.1.1.1.3.3.cmml">j</mi></msub></mrow><mo fence="true" id="S2.SS2.p1.14.m6.1.1.1.1.3" lspace="0em" stretchy="true" xref="S2.SS2.p1.14.m6.1.1.1.2.1.cmml">∥</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.14.m6.1b"><apply id="S2.SS2.p1.14.m6.1.1.cmml" xref="S2.SS2.p1.14.m6.1.1"><eq id="S2.SS2.p1.14.m6.1.1.2.cmml" xref="S2.SS2.p1.14.m6.1.1.2"></eq><apply id="S2.SS2.p1.14.m6.1.1.3.cmml" xref="S2.SS2.p1.14.m6.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.p1.14.m6.1.1.3.1.cmml" xref="S2.SS2.p1.14.m6.1.1.3">subscript</csymbol><ci id="S2.SS2.p1.14.m6.1.1.3.2.cmml" xref="S2.SS2.p1.14.m6.1.1.3.2">𝑫</ci><apply id="S2.SS2.p1.14.m6.1.1.3.3.cmml" xref="S2.SS2.p1.14.m6.1.1.3.3"><times id="S2.SS2.p1.14.m6.1.1.3.3.1.cmml" xref="S2.SS2.p1.14.m6.1.1.3.3.1"></times><ci id="S2.SS2.p1.14.m6.1.1.3.3.2.cmml" xref="S2.SS2.p1.14.m6.1.1.3.3.2">𝑖</ci><ci id="S2.SS2.p1.14.m6.1.1.3.3.3.cmml" xref="S2.SS2.p1.14.m6.1.1.3.3.3">𝑗</ci></apply></apply><apply id="S2.SS2.p1.14.m6.1.1.1.2.cmml" xref="S2.SS2.p1.14.m6.1.1.1.1"><csymbol cd="latexml" id="S2.SS2.p1.14.m6.1.1.1.2.1.cmml" xref="S2.SS2.p1.14.m6.1.1.1.1.2">delimited-∥∥</csymbol><apply id="S2.SS2.p1.14.m6.1.1.1.1.1.cmml" xref="S2.SS2.p1.14.m6.1.1.1.1.1"><minus id="S2.SS2.p1.14.m6.1.1.1.1.1.1.cmml" xref="S2.SS2.p1.14.m6.1.1.1.1.1.1"></minus><apply id="S2.SS2.p1.14.m6.1.1.1.1.1.2.cmml" xref="S2.SS2.p1.14.m6.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.SS2.p1.14.m6.1.1.1.1.1.2.1.cmml" xref="S2.SS2.p1.14.m6.1.1.1.1.1.2">subscript</csymbol><ci id="S2.SS2.p1.14.m6.1.1.1.1.1.2.2.cmml" xref="S2.SS2.p1.14.m6.1.1.1.1.1.2.2">𝑧</ci><ci id="S2.SS2.p1.14.m6.1.1.1.1.1.2.3.cmml" xref="S2.SS2.p1.14.m6.1.1.1.1.1.2.3">𝑖</ci></apply><apply id="S2.SS2.p1.14.m6.1.1.1.1.1.3.cmml" xref="S2.SS2.p1.14.m6.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.p1.14.m6.1.1.1.1.1.3.1.cmml" xref="S2.SS2.p1.14.m6.1.1.1.1.1.3">subscript</csymbol><ci id="S2.SS2.p1.14.m6.1.1.1.1.1.3.2.cmml" xref="S2.SS2.p1.14.m6.1.1.1.1.1.3.2">𝑧</ci><ci id="S2.SS2.p1.14.m6.1.1.1.1.1.3.3.cmml" xref="S2.SS2.p1.14.m6.1.1.1.1.1.3.3">𝑗</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.14.m6.1c">{\bm{D}}_{ij}=\left\lVert z_{i}-z_{j}\right\rVert</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.14.m6.1d">bold_italic_D start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT = ∥ italic_z start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT - italic_z start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ∥</annotation></semantics></math>, and <math alttext="{\bm{P}}" class="ltx_Math" display="inline" id="S2.SS2.p1.15.m7.1"><semantics id="S2.SS2.p1.15.m7.1a"><mi id="S2.SS2.p1.15.m7.1.1" xref="S2.SS2.p1.15.m7.1.1.cmml">𝑷</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.15.m7.1b"><ci id="S2.SS2.p1.15.m7.1.1.cmml" xref="S2.SS2.p1.15.m7.1.1">𝑷</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.15.m7.1c">{\bm{P}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.15.m7.1d">bold_italic_P</annotation></semantics></math> is called the flow matrix in the computer science literature, or optimal transport plan in the OT literature, the same size with <math alttext="{\bm{D}}" class="ltx_Math" display="inline" id="S2.SS2.p1.16.m8.1"><semantics id="S2.SS2.p1.16.m8.1a"><mi id="S2.SS2.p1.16.m8.1.1" xref="S2.SS2.p1.16.m8.1.1.cmml">𝑫</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.16.m8.1b"><ci id="S2.SS2.p1.16.m8.1.1.cmml" xref="S2.SS2.p1.16.m8.1.1">𝑫</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.16.m8.1c">{\bm{D}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.16.m8.1d">bold_italic_D</annotation></semantics></math> with nonnegative entries. Intuitively, this is a minimum cost flow problem. Both source and target flow sum to <math alttext="1" class="ltx_Math" display="inline" id="S2.SS2.p1.17.m9.1"><semantics id="S2.SS2.p1.17.m9.1a"><mn id="S2.SS2.p1.17.m9.1.1" xref="S2.SS2.p1.17.m9.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.17.m9.1b"><cn id="S2.SS2.p1.17.m9.1.1.cmml" type="integer" xref="S2.SS2.p1.17.m9.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.17.m9.1c">1</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.17.m9.1d">1</annotation></semantics></math>, and we want to find the optimal transportation plan <math alttext="{\bm{P}}" class="ltx_Math" display="inline" id="S2.SS2.p1.18.m10.1"><semantics id="S2.SS2.p1.18.m10.1a"><mi id="S2.SS2.p1.18.m10.1.1" xref="S2.SS2.p1.18.m10.1.1.cmml">𝑷</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.18.m10.1b"><ci id="S2.SS2.p1.18.m10.1.1.cmml" xref="S2.SS2.p1.18.m10.1.1">𝑷</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.18.m10.1c">{\bm{P}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.18.m10.1d">bold_italic_P</annotation></semantics></math> with the minimum cost with respect to ground similarity <math alttext="{\bm{D}}" class="ltx_Math" display="inline" id="S2.SS2.p1.19.m11.1"><semantics id="S2.SS2.p1.19.m11.1a"><mi id="S2.SS2.p1.19.m11.1.1" xref="S2.SS2.p1.19.m11.1.1.cmml">𝑫</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.19.m11.1b"><ci id="S2.SS2.p1.19.m11.1.1.cmml" xref="S2.SS2.p1.19.m11.1.1">𝑫</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.19.m11.1c">{\bm{D}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.19.m11.1d">bold_italic_D</annotation></semantics></math>. The norm <math alttext="\lVert\cdot\rVert" class="ltx_Math" display="inline" id="S2.SS2.p1.20.m12.1"><semantics id="S2.SS2.p1.20.m12.1a"><mrow id="S2.SS2.p1.20.m12.1.2.2" xref="S2.SS2.p1.20.m12.1.2.1.cmml"><mo fence="true" id="S2.SS2.p1.20.m12.1.2.2.1" rspace="0em" xref="S2.SS2.p1.20.m12.1.2.1.1.cmml">∥</mo><mo id="S2.SS2.p1.20.m12.1.1" lspace="0em" rspace="0em" xref="S2.SS2.p1.20.m12.1.1.cmml">⋅</mo><mo fence="true" id="S2.SS2.p1.20.m12.1.2.2.2" lspace="0em" xref="S2.SS2.p1.20.m12.1.2.1.1.cmml">∥</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.20.m12.1b"><apply id="S2.SS2.p1.20.m12.1.2.1.cmml" xref="S2.SS2.p1.20.m12.1.2.2"><csymbol cd="latexml" id="S2.SS2.p1.20.m12.1.2.1.1.cmml" xref="S2.SS2.p1.20.m12.1.2.2.1">delimited-∥∥</csymbol><ci id="S2.SS2.p1.20.m12.1.1.cmml" xref="S2.SS2.p1.20.m12.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.20.m12.1c">\lVert\cdot\rVert</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.20.m12.1d">∥ ⋅ ∥</annotation></semantics></math> depends on the ground metric of <math alttext="{\bm{D}}" class="ltx_Math" display="inline" id="S2.SS2.p1.21.m13.1"><semantics id="S2.SS2.p1.21.m13.1a"><mi id="S2.SS2.p1.21.m13.1.1" xref="S2.SS2.p1.21.m13.1.1.cmml">𝑫</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.21.m13.1b"><ci id="S2.SS2.p1.21.m13.1.1.cmml" xref="S2.SS2.p1.21.m13.1.1">𝑫</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.21.m13.1c">{\bm{D}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.21.m13.1d">bold_italic_D</annotation></semantics></math>. We use the <math alttext="\lVert\cdot\rVert_{2}" class="ltx_Math" display="inline" id="S2.SS2.p1.22.m14.1"><semantics id="S2.SS2.p1.22.m14.1a"><msub id="S2.SS2.p1.22.m14.1.2" xref="S2.SS2.p1.22.m14.1.2.cmml"><mrow id="S2.SS2.p1.22.m14.1.2.2.2" xref="S2.SS2.p1.22.m14.1.2.2.1.cmml"><mo fence="true" id="S2.SS2.p1.22.m14.1.2.2.2.1" rspace="0em" xref="S2.SS2.p1.22.m14.1.2.2.1.1.cmml">∥</mo><mo id="S2.SS2.p1.22.m14.1.1" lspace="0em" rspace="0em" xref="S2.SS2.p1.22.m14.1.1.cmml">⋅</mo><mo fence="true" id="S2.SS2.p1.22.m14.1.2.2.2.2" lspace="0em" xref="S2.SS2.p1.22.m14.1.2.2.1.1.cmml">∥</mo></mrow><mn id="S2.SS2.p1.22.m14.1.2.3" xref="S2.SS2.p1.22.m14.1.2.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.22.m14.1b"><apply id="S2.SS2.p1.22.m14.1.2.cmml" xref="S2.SS2.p1.22.m14.1.2"><csymbol cd="ambiguous" id="S2.SS2.p1.22.m14.1.2.1.cmml" xref="S2.SS2.p1.22.m14.1.2">subscript</csymbol><apply id="S2.SS2.p1.22.m14.1.2.2.1.cmml" xref="S2.SS2.p1.22.m14.1.2.2.2"><csymbol cd="latexml" id="S2.SS2.p1.22.m14.1.2.2.1.1.cmml" xref="S2.SS2.p1.22.m14.1.2.2.2.1">delimited-∥∥</csymbol><ci id="S2.SS2.p1.22.m14.1.1.cmml" xref="S2.SS2.p1.22.m14.1.1">⋅</ci></apply><cn id="S2.SS2.p1.22.m14.1.2.3.cmml" type="integer" xref="S2.SS2.p1.22.m14.1.2.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.22.m14.1c">\lVert\cdot\rVert_{2}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.22.m14.1d">∥ ⋅ ∥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math> norm as the ground metric throughout this paper.</p>
</div>
<div class="ltx_para" id="S2.SS2.p2">
<p class="ltx_p" id="S2.SS2.p2.15">When the dimension of the feature is 1, fast computation of the EMD distance exists <cite class="ltx_cite ltx_citemacro_citep">(Houry et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03052v1#bib.bib19" title="">2024</a>)</cite>. Instead of solving a linear program in Eq.<a class="ltx_ref" href="https://arxiv.org/html/2410.03052v1#S2.E3" title="Equation 3 ‣ 2.2 Exact Earth Mover’s Distance ‣ 2 Preliminaries ‣ Learning Structured Representations by Embedding Class Hierarchy with Fast Optimal Transport"><span class="ltx_text ltx_ref_tag">3</span></a>, when <math alttext="m=n" class="ltx_Math" display="inline" id="S2.SS2.p2.1.m1.1"><semantics id="S2.SS2.p2.1.m1.1a"><mrow id="S2.SS2.p2.1.m1.1.1" xref="S2.SS2.p2.1.m1.1.1.cmml"><mi id="S2.SS2.p2.1.m1.1.1.2" xref="S2.SS2.p2.1.m1.1.1.2.cmml">m</mi><mo id="S2.SS2.p2.1.m1.1.1.1" xref="S2.SS2.p2.1.m1.1.1.1.cmml">=</mo><mi id="S2.SS2.p2.1.m1.1.1.3" xref="S2.SS2.p2.1.m1.1.1.3.cmml">n</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.1.m1.1b"><apply id="S2.SS2.p2.1.m1.1.1.cmml" xref="S2.SS2.p2.1.m1.1.1"><eq id="S2.SS2.p2.1.m1.1.1.1.cmml" xref="S2.SS2.p2.1.m1.1.1.1"></eq><ci id="S2.SS2.p2.1.m1.1.1.2.cmml" xref="S2.SS2.p2.1.m1.1.1.2">𝑚</ci><ci id="S2.SS2.p2.1.m1.1.1.3.cmml" xref="S2.SS2.p2.1.m1.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.1.m1.1c">m=n</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.1.m1.1d">italic_m = italic_n</annotation></semantics></math>, <math alttext="a_{i}=b_{i}=1/n" class="ltx_Math" display="inline" id="S2.SS2.p2.2.m2.1"><semantics id="S2.SS2.p2.2.m2.1a"><mrow id="S2.SS2.p2.2.m2.1.1" xref="S2.SS2.p2.2.m2.1.1.cmml"><msub id="S2.SS2.p2.2.m2.1.1.2" xref="S2.SS2.p2.2.m2.1.1.2.cmml"><mi id="S2.SS2.p2.2.m2.1.1.2.2" xref="S2.SS2.p2.2.m2.1.1.2.2.cmml">a</mi><mi id="S2.SS2.p2.2.m2.1.1.2.3" xref="S2.SS2.p2.2.m2.1.1.2.3.cmml">i</mi></msub><mo id="S2.SS2.p2.2.m2.1.1.3" xref="S2.SS2.p2.2.m2.1.1.3.cmml">=</mo><msub id="S2.SS2.p2.2.m2.1.1.4" xref="S2.SS2.p2.2.m2.1.1.4.cmml"><mi id="S2.SS2.p2.2.m2.1.1.4.2" xref="S2.SS2.p2.2.m2.1.1.4.2.cmml">b</mi><mi id="S2.SS2.p2.2.m2.1.1.4.3" xref="S2.SS2.p2.2.m2.1.1.4.3.cmml">i</mi></msub><mo id="S2.SS2.p2.2.m2.1.1.5" xref="S2.SS2.p2.2.m2.1.1.5.cmml">=</mo><mrow id="S2.SS2.p2.2.m2.1.1.6" xref="S2.SS2.p2.2.m2.1.1.6.cmml"><mn id="S2.SS2.p2.2.m2.1.1.6.2" xref="S2.SS2.p2.2.m2.1.1.6.2.cmml">1</mn><mo id="S2.SS2.p2.2.m2.1.1.6.1" xref="S2.SS2.p2.2.m2.1.1.6.1.cmml">/</mo><mi id="S2.SS2.p2.2.m2.1.1.6.3" xref="S2.SS2.p2.2.m2.1.1.6.3.cmml">n</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.2.m2.1b"><apply id="S2.SS2.p2.2.m2.1.1.cmml" xref="S2.SS2.p2.2.m2.1.1"><and id="S2.SS2.p2.2.m2.1.1a.cmml" xref="S2.SS2.p2.2.m2.1.1"></and><apply id="S2.SS2.p2.2.m2.1.1b.cmml" xref="S2.SS2.p2.2.m2.1.1"><eq id="S2.SS2.p2.2.m2.1.1.3.cmml" xref="S2.SS2.p2.2.m2.1.1.3"></eq><apply id="S2.SS2.p2.2.m2.1.1.2.cmml" xref="S2.SS2.p2.2.m2.1.1.2"><csymbol cd="ambiguous" id="S2.SS2.p2.2.m2.1.1.2.1.cmml" xref="S2.SS2.p2.2.m2.1.1.2">subscript</csymbol><ci id="S2.SS2.p2.2.m2.1.1.2.2.cmml" xref="S2.SS2.p2.2.m2.1.1.2.2">𝑎</ci><ci id="S2.SS2.p2.2.m2.1.1.2.3.cmml" xref="S2.SS2.p2.2.m2.1.1.2.3">𝑖</ci></apply><apply id="S2.SS2.p2.2.m2.1.1.4.cmml" xref="S2.SS2.p2.2.m2.1.1.4"><csymbol cd="ambiguous" id="S2.SS2.p2.2.m2.1.1.4.1.cmml" xref="S2.SS2.p2.2.m2.1.1.4">subscript</csymbol><ci id="S2.SS2.p2.2.m2.1.1.4.2.cmml" xref="S2.SS2.p2.2.m2.1.1.4.2">𝑏</ci><ci id="S2.SS2.p2.2.m2.1.1.4.3.cmml" xref="S2.SS2.p2.2.m2.1.1.4.3">𝑖</ci></apply></apply><apply id="S2.SS2.p2.2.m2.1.1c.cmml" xref="S2.SS2.p2.2.m2.1.1"><eq id="S2.SS2.p2.2.m2.1.1.5.cmml" xref="S2.SS2.p2.2.m2.1.1.5"></eq><share href="https://arxiv.org/html/2410.03052v1#S2.SS2.p2.2.m2.1.1.4.cmml" id="S2.SS2.p2.2.m2.1.1d.cmml" xref="S2.SS2.p2.2.m2.1.1"></share><apply id="S2.SS2.p2.2.m2.1.1.6.cmml" xref="S2.SS2.p2.2.m2.1.1.6"><divide id="S2.SS2.p2.2.m2.1.1.6.1.cmml" xref="S2.SS2.p2.2.m2.1.1.6.1"></divide><cn id="S2.SS2.p2.2.m2.1.1.6.2.cmml" type="integer" xref="S2.SS2.p2.2.m2.1.1.6.2">1</cn><ci id="S2.SS2.p2.2.m2.1.1.6.3.cmml" xref="S2.SS2.p2.2.m2.1.1.6.3">𝑛</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.2.m2.1c">a_{i}=b_{i}=1/n</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.2.m2.1d">italic_a start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_b start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = 1 / italic_n</annotation></semantics></math> for all <math alttext="i" class="ltx_Math" display="inline" id="S2.SS2.p2.3.m3.1"><semantics id="S2.SS2.p2.3.m3.1a"><mi id="S2.SS2.p2.3.m3.1.1" xref="S2.SS2.p2.3.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.3.m3.1b"><ci id="S2.SS2.p2.3.m3.1.1.cmml" xref="S2.SS2.p2.3.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.3.m3.1c">i</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.3.m3.1d">italic_i</annotation></semantics></math>, the closed form solution for <span class="ltx_text ltx_font_bold" id="S2.SS2.p2.4.1">1<span class="ltx_text ltx_markedasmath" id="S2.SS2.p2.4.1.1">d</span> EMD</span> is: <math alttext="\text{EMD}_{\text{1d}}(\mu,\nu)=\frac{1}{n}\sum_{i=1}^{n}\|z_{(i)}-z^{\prime}_%
{(i)}\|" class="ltx_Math" display="inline" id="S2.SS2.p2.5.m4.5"><semantics id="S2.SS2.p2.5.m4.5a"><mrow id="S2.SS2.p2.5.m4.5.5" xref="S2.SS2.p2.5.m4.5.5.cmml"><mrow id="S2.SS2.p2.5.m4.5.5.3" xref="S2.SS2.p2.5.m4.5.5.3.cmml"><msub id="S2.SS2.p2.5.m4.5.5.3.2" xref="S2.SS2.p2.5.m4.5.5.3.2.cmml"><mtext id="S2.SS2.p2.5.m4.5.5.3.2.2" xref="S2.SS2.p2.5.m4.5.5.3.2.2a.cmml">EMD</mtext><mtext id="S2.SS2.p2.5.m4.5.5.3.2.3" xref="S2.SS2.p2.5.m4.5.5.3.2.3a.cmml">1d</mtext></msub><mo id="S2.SS2.p2.5.m4.5.5.3.1" xref="S2.SS2.p2.5.m4.5.5.3.1.cmml">⁢</mo><mrow id="S2.SS2.p2.5.m4.5.5.3.3.2" xref="S2.SS2.p2.5.m4.5.5.3.3.1.cmml"><mo id="S2.SS2.p2.5.m4.5.5.3.3.2.1" stretchy="false" xref="S2.SS2.p2.5.m4.5.5.3.3.1.cmml">(</mo><mi id="S2.SS2.p2.5.m4.3.3" xref="S2.SS2.p2.5.m4.3.3.cmml">μ</mi><mo id="S2.SS2.p2.5.m4.5.5.3.3.2.2" xref="S2.SS2.p2.5.m4.5.5.3.3.1.cmml">,</mo><mi id="S2.SS2.p2.5.m4.4.4" xref="S2.SS2.p2.5.m4.4.4.cmml">ν</mi><mo id="S2.SS2.p2.5.m4.5.5.3.3.2.3" stretchy="false" xref="S2.SS2.p2.5.m4.5.5.3.3.1.cmml">)</mo></mrow></mrow><mo id="S2.SS2.p2.5.m4.5.5.2" xref="S2.SS2.p2.5.m4.5.5.2.cmml">=</mo><mrow id="S2.SS2.p2.5.m4.5.5.1" xref="S2.SS2.p2.5.m4.5.5.1.cmml"><mfrac id="S2.SS2.p2.5.m4.5.5.1.3" xref="S2.SS2.p2.5.m4.5.5.1.3.cmml"><mn id="S2.SS2.p2.5.m4.5.5.1.3.2" xref="S2.SS2.p2.5.m4.5.5.1.3.2.cmml">1</mn><mi id="S2.SS2.p2.5.m4.5.5.1.3.3" xref="S2.SS2.p2.5.m4.5.5.1.3.3.cmml">n</mi></mfrac><mo id="S2.SS2.p2.5.m4.5.5.1.2" xref="S2.SS2.p2.5.m4.5.5.1.2.cmml">⁢</mo><mrow id="S2.SS2.p2.5.m4.5.5.1.1" xref="S2.SS2.p2.5.m4.5.5.1.1.cmml"><msubsup id="S2.SS2.p2.5.m4.5.5.1.1.2" xref="S2.SS2.p2.5.m4.5.5.1.1.2.cmml"><mo id="S2.SS2.p2.5.m4.5.5.1.1.2.2.2" rspace="0em" xref="S2.SS2.p2.5.m4.5.5.1.1.2.2.2.cmml">∑</mo><mrow id="S2.SS2.p2.5.m4.5.5.1.1.2.2.3" xref="S2.SS2.p2.5.m4.5.5.1.1.2.2.3.cmml"><mi id="S2.SS2.p2.5.m4.5.5.1.1.2.2.3.2" xref="S2.SS2.p2.5.m4.5.5.1.1.2.2.3.2.cmml">i</mi><mo id="S2.SS2.p2.5.m4.5.5.1.1.2.2.3.1" xref="S2.SS2.p2.5.m4.5.5.1.1.2.2.3.1.cmml">=</mo><mn id="S2.SS2.p2.5.m4.5.5.1.1.2.2.3.3" xref="S2.SS2.p2.5.m4.5.5.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S2.SS2.p2.5.m4.5.5.1.1.2.3" xref="S2.SS2.p2.5.m4.5.5.1.1.2.3.cmml">n</mi></msubsup><mrow id="S2.SS2.p2.5.m4.5.5.1.1.1.1" xref="S2.SS2.p2.5.m4.5.5.1.1.1.2.cmml"><mo id="S2.SS2.p2.5.m4.5.5.1.1.1.1.2" stretchy="false" xref="S2.SS2.p2.5.m4.5.5.1.1.1.2.1.cmml">‖</mo><mrow id="S2.SS2.p2.5.m4.5.5.1.1.1.1.1" xref="S2.SS2.p2.5.m4.5.5.1.1.1.1.1.cmml"><msub id="S2.SS2.p2.5.m4.5.5.1.1.1.1.1.2" xref="S2.SS2.p2.5.m4.5.5.1.1.1.1.1.2.cmml"><mi id="S2.SS2.p2.5.m4.5.5.1.1.1.1.1.2.2" xref="S2.SS2.p2.5.m4.5.5.1.1.1.1.1.2.2.cmml">z</mi><mrow id="S2.SS2.p2.5.m4.1.1.1.3" xref="S2.SS2.p2.5.m4.5.5.1.1.1.1.1.2.cmml"><mo id="S2.SS2.p2.5.m4.1.1.1.3.1" stretchy="false" xref="S2.SS2.p2.5.m4.5.5.1.1.1.1.1.2.cmml">(</mo><mi id="S2.SS2.p2.5.m4.1.1.1.1" xref="S2.SS2.p2.5.m4.1.1.1.1.cmml">i</mi><mo id="S2.SS2.p2.5.m4.1.1.1.3.2" stretchy="false" xref="S2.SS2.p2.5.m4.5.5.1.1.1.1.1.2.cmml">)</mo></mrow></msub><mo id="S2.SS2.p2.5.m4.5.5.1.1.1.1.1.1" xref="S2.SS2.p2.5.m4.5.5.1.1.1.1.1.1.cmml">−</mo><msubsup id="S2.SS2.p2.5.m4.5.5.1.1.1.1.1.3" xref="S2.SS2.p2.5.m4.5.5.1.1.1.1.1.3.cmml"><mi id="S2.SS2.p2.5.m4.5.5.1.1.1.1.1.3.2.2" xref="S2.SS2.p2.5.m4.5.5.1.1.1.1.1.3.2.2.cmml">z</mi><mrow id="S2.SS2.p2.5.m4.2.2.1.3" xref="S2.SS2.p2.5.m4.5.5.1.1.1.1.1.3.cmml"><mo id="S2.SS2.p2.5.m4.2.2.1.3.1" stretchy="false" xref="S2.SS2.p2.5.m4.5.5.1.1.1.1.1.3.cmml">(</mo><mi id="S2.SS2.p2.5.m4.2.2.1.1" xref="S2.SS2.p2.5.m4.2.2.1.1.cmml">i</mi><mo id="S2.SS2.p2.5.m4.2.2.1.3.2" stretchy="false" xref="S2.SS2.p2.5.m4.5.5.1.1.1.1.1.3.cmml">)</mo></mrow><mo id="S2.SS2.p2.5.m4.5.5.1.1.1.1.1.3.2.3" xref="S2.SS2.p2.5.m4.5.5.1.1.1.1.1.3.2.3.cmml">′</mo></msubsup></mrow><mo id="S2.SS2.p2.5.m4.5.5.1.1.1.1.3" stretchy="false" xref="S2.SS2.p2.5.m4.5.5.1.1.1.2.1.cmml">‖</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.5.m4.5b"><apply id="S2.SS2.p2.5.m4.5.5.cmml" xref="S2.SS2.p2.5.m4.5.5"><eq id="S2.SS2.p2.5.m4.5.5.2.cmml" xref="S2.SS2.p2.5.m4.5.5.2"></eq><apply id="S2.SS2.p2.5.m4.5.5.3.cmml" xref="S2.SS2.p2.5.m4.5.5.3"><times id="S2.SS2.p2.5.m4.5.5.3.1.cmml" xref="S2.SS2.p2.5.m4.5.5.3.1"></times><apply id="S2.SS2.p2.5.m4.5.5.3.2.cmml" xref="S2.SS2.p2.5.m4.5.5.3.2"><csymbol cd="ambiguous" id="S2.SS2.p2.5.m4.5.5.3.2.1.cmml" xref="S2.SS2.p2.5.m4.5.5.3.2">subscript</csymbol><ci id="S2.SS2.p2.5.m4.5.5.3.2.2a.cmml" xref="S2.SS2.p2.5.m4.5.5.3.2.2"><mtext id="S2.SS2.p2.5.m4.5.5.3.2.2.cmml" xref="S2.SS2.p2.5.m4.5.5.3.2.2">EMD</mtext></ci><ci id="S2.SS2.p2.5.m4.5.5.3.2.3a.cmml" xref="S2.SS2.p2.5.m4.5.5.3.2.3"><mtext id="S2.SS2.p2.5.m4.5.5.3.2.3.cmml" mathsize="70%" xref="S2.SS2.p2.5.m4.5.5.3.2.3">1d</mtext></ci></apply><interval closure="open" id="S2.SS2.p2.5.m4.5.5.3.3.1.cmml" xref="S2.SS2.p2.5.m4.5.5.3.3.2"><ci id="S2.SS2.p2.5.m4.3.3.cmml" xref="S2.SS2.p2.5.m4.3.3">𝜇</ci><ci id="S2.SS2.p2.5.m4.4.4.cmml" xref="S2.SS2.p2.5.m4.4.4">𝜈</ci></interval></apply><apply id="S2.SS2.p2.5.m4.5.5.1.cmml" xref="S2.SS2.p2.5.m4.5.5.1"><times id="S2.SS2.p2.5.m4.5.5.1.2.cmml" xref="S2.SS2.p2.5.m4.5.5.1.2"></times><apply id="S2.SS2.p2.5.m4.5.5.1.3.cmml" xref="S2.SS2.p2.5.m4.5.5.1.3"><divide id="S2.SS2.p2.5.m4.5.5.1.3.1.cmml" xref="S2.SS2.p2.5.m4.5.5.1.3"></divide><cn id="S2.SS2.p2.5.m4.5.5.1.3.2.cmml" type="integer" xref="S2.SS2.p2.5.m4.5.5.1.3.2">1</cn><ci id="S2.SS2.p2.5.m4.5.5.1.3.3.cmml" xref="S2.SS2.p2.5.m4.5.5.1.3.3">𝑛</ci></apply><apply id="S2.SS2.p2.5.m4.5.5.1.1.cmml" xref="S2.SS2.p2.5.m4.5.5.1.1"><apply id="S2.SS2.p2.5.m4.5.5.1.1.2.cmml" xref="S2.SS2.p2.5.m4.5.5.1.1.2"><csymbol cd="ambiguous" id="S2.SS2.p2.5.m4.5.5.1.1.2.1.cmml" xref="S2.SS2.p2.5.m4.5.5.1.1.2">superscript</csymbol><apply id="S2.SS2.p2.5.m4.5.5.1.1.2.2.cmml" xref="S2.SS2.p2.5.m4.5.5.1.1.2"><csymbol cd="ambiguous" id="S2.SS2.p2.5.m4.5.5.1.1.2.2.1.cmml" xref="S2.SS2.p2.5.m4.5.5.1.1.2">subscript</csymbol><sum id="S2.SS2.p2.5.m4.5.5.1.1.2.2.2.cmml" xref="S2.SS2.p2.5.m4.5.5.1.1.2.2.2"></sum><apply id="S2.SS2.p2.5.m4.5.5.1.1.2.2.3.cmml" xref="S2.SS2.p2.5.m4.5.5.1.1.2.2.3"><eq id="S2.SS2.p2.5.m4.5.5.1.1.2.2.3.1.cmml" xref="S2.SS2.p2.5.m4.5.5.1.1.2.2.3.1"></eq><ci id="S2.SS2.p2.5.m4.5.5.1.1.2.2.3.2.cmml" xref="S2.SS2.p2.5.m4.5.5.1.1.2.2.3.2">𝑖</ci><cn id="S2.SS2.p2.5.m4.5.5.1.1.2.2.3.3.cmml" type="integer" xref="S2.SS2.p2.5.m4.5.5.1.1.2.2.3.3">1</cn></apply></apply><ci id="S2.SS2.p2.5.m4.5.5.1.1.2.3.cmml" xref="S2.SS2.p2.5.m4.5.5.1.1.2.3">𝑛</ci></apply><apply id="S2.SS2.p2.5.m4.5.5.1.1.1.2.cmml" xref="S2.SS2.p2.5.m4.5.5.1.1.1.1"><csymbol cd="latexml" id="S2.SS2.p2.5.m4.5.5.1.1.1.2.1.cmml" xref="S2.SS2.p2.5.m4.5.5.1.1.1.1.2">norm</csymbol><apply id="S2.SS2.p2.5.m4.5.5.1.1.1.1.1.cmml" xref="S2.SS2.p2.5.m4.5.5.1.1.1.1.1"><minus id="S2.SS2.p2.5.m4.5.5.1.1.1.1.1.1.cmml" xref="S2.SS2.p2.5.m4.5.5.1.1.1.1.1.1"></minus><apply id="S2.SS2.p2.5.m4.5.5.1.1.1.1.1.2.cmml" xref="S2.SS2.p2.5.m4.5.5.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.SS2.p2.5.m4.5.5.1.1.1.1.1.2.1.cmml" xref="S2.SS2.p2.5.m4.5.5.1.1.1.1.1.2">subscript</csymbol><ci id="S2.SS2.p2.5.m4.5.5.1.1.1.1.1.2.2.cmml" xref="S2.SS2.p2.5.m4.5.5.1.1.1.1.1.2.2">𝑧</ci><ci id="S2.SS2.p2.5.m4.1.1.1.1.cmml" xref="S2.SS2.p2.5.m4.1.1.1.1">𝑖</ci></apply><apply id="S2.SS2.p2.5.m4.5.5.1.1.1.1.1.3.cmml" xref="S2.SS2.p2.5.m4.5.5.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.p2.5.m4.5.5.1.1.1.1.1.3.1.cmml" xref="S2.SS2.p2.5.m4.5.5.1.1.1.1.1.3">subscript</csymbol><apply id="S2.SS2.p2.5.m4.5.5.1.1.1.1.1.3.2.cmml" xref="S2.SS2.p2.5.m4.5.5.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.p2.5.m4.5.5.1.1.1.1.1.3.2.1.cmml" xref="S2.SS2.p2.5.m4.5.5.1.1.1.1.1.3">superscript</csymbol><ci id="S2.SS2.p2.5.m4.5.5.1.1.1.1.1.3.2.2.cmml" xref="S2.SS2.p2.5.m4.5.5.1.1.1.1.1.3.2.2">𝑧</ci><ci id="S2.SS2.p2.5.m4.5.5.1.1.1.1.1.3.2.3.cmml" xref="S2.SS2.p2.5.m4.5.5.1.1.1.1.1.3.2.3">′</ci></apply><ci id="S2.SS2.p2.5.m4.2.2.1.1.cmml" xref="S2.SS2.p2.5.m4.2.2.1.1">𝑖</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.5.m4.5c">\text{EMD}_{\text{1d}}(\mu,\nu)=\frac{1}{n}\sum_{i=1}^{n}\|z_{(i)}-z^{\prime}_%
{(i)}\|</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.5.m4.5d">EMD start_POSTSUBSCRIPT 1d end_POSTSUBSCRIPT ( italic_μ , italic_ν ) = divide start_ARG 1 end_ARG start_ARG italic_n end_ARG ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT ∥ italic_z start_POSTSUBSCRIPT ( italic_i ) end_POSTSUBSCRIPT - italic_z start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT ( italic_i ) end_POSTSUBSCRIPT ∥</annotation></semantics></math>, and <math alttext="z_{(i)}" class="ltx_Math" display="inline" id="S2.SS2.p2.6.m5.1"><semantics id="S2.SS2.p2.6.m5.1a"><msub id="S2.SS2.p2.6.m5.1.2" xref="S2.SS2.p2.6.m5.1.2.cmml"><mi id="S2.SS2.p2.6.m5.1.2.2" xref="S2.SS2.p2.6.m5.1.2.2.cmml">z</mi><mrow id="S2.SS2.p2.6.m5.1.1.1.3" xref="S2.SS2.p2.6.m5.1.2.cmml"><mo id="S2.SS2.p2.6.m5.1.1.1.3.1" stretchy="false" xref="S2.SS2.p2.6.m5.1.2.cmml">(</mo><mi id="S2.SS2.p2.6.m5.1.1.1.1" xref="S2.SS2.p2.6.m5.1.1.1.1.cmml">i</mi><mo id="S2.SS2.p2.6.m5.1.1.1.3.2" stretchy="false" xref="S2.SS2.p2.6.m5.1.2.cmml">)</mo></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.6.m5.1b"><apply id="S2.SS2.p2.6.m5.1.2.cmml" xref="S2.SS2.p2.6.m5.1.2"><csymbol cd="ambiguous" id="S2.SS2.p2.6.m5.1.2.1.cmml" xref="S2.SS2.p2.6.m5.1.2">subscript</csymbol><ci id="S2.SS2.p2.6.m5.1.2.2.cmml" xref="S2.SS2.p2.6.m5.1.2.2">𝑧</ci><ci id="S2.SS2.p2.6.m5.1.1.1.1.cmml" xref="S2.SS2.p2.6.m5.1.1.1.1">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.6.m5.1c">z_{(i)}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.6.m5.1d">italic_z start_POSTSUBSCRIPT ( italic_i ) end_POSTSUBSCRIPT</annotation></semantics></math> is the <math alttext="i" class="ltx_Math" display="inline" id="S2.SS2.p2.7.m6.1"><semantics id="S2.SS2.p2.7.m6.1a"><mi id="S2.SS2.p2.7.m6.1.1" xref="S2.SS2.p2.7.m6.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.7.m6.1b"><ci id="S2.SS2.p2.7.m6.1.1.cmml" xref="S2.SS2.p2.7.m6.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.7.m6.1c">i</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.7.m6.1d">italic_i</annotation></semantics></math>-th order statistic of the sequence <math alttext="\{z_{1},\cdots z_{n}\}" class="ltx_Math" display="inline" id="S2.SS2.p2.8.m7.2"><semantics id="S2.SS2.p2.8.m7.2a"><mrow id="S2.SS2.p2.8.m7.2.2.2" xref="S2.SS2.p2.8.m7.2.2.3.cmml"><mo id="S2.SS2.p2.8.m7.2.2.2.3" stretchy="false" xref="S2.SS2.p2.8.m7.2.2.3.cmml">{</mo><msub id="S2.SS2.p2.8.m7.1.1.1.1" xref="S2.SS2.p2.8.m7.1.1.1.1.cmml"><mi id="S2.SS2.p2.8.m7.1.1.1.1.2" xref="S2.SS2.p2.8.m7.1.1.1.1.2.cmml">z</mi><mn id="S2.SS2.p2.8.m7.1.1.1.1.3" xref="S2.SS2.p2.8.m7.1.1.1.1.3.cmml">1</mn></msub><mo id="S2.SS2.p2.8.m7.2.2.2.4" xref="S2.SS2.p2.8.m7.2.2.3.cmml">,</mo><mrow id="S2.SS2.p2.8.m7.2.2.2.2" xref="S2.SS2.p2.8.m7.2.2.2.2.cmml"><mi id="S2.SS2.p2.8.m7.2.2.2.2.2" mathvariant="normal" xref="S2.SS2.p2.8.m7.2.2.2.2.2.cmml">⋯</mi><mo id="S2.SS2.p2.8.m7.2.2.2.2.1" xref="S2.SS2.p2.8.m7.2.2.2.2.1.cmml">⁢</mo><msub id="S2.SS2.p2.8.m7.2.2.2.2.3" xref="S2.SS2.p2.8.m7.2.2.2.2.3.cmml"><mi id="S2.SS2.p2.8.m7.2.2.2.2.3.2" xref="S2.SS2.p2.8.m7.2.2.2.2.3.2.cmml">z</mi><mi id="S2.SS2.p2.8.m7.2.2.2.2.3.3" xref="S2.SS2.p2.8.m7.2.2.2.2.3.3.cmml">n</mi></msub></mrow><mo id="S2.SS2.p2.8.m7.2.2.2.5" stretchy="false" xref="S2.SS2.p2.8.m7.2.2.3.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.8.m7.2b"><set id="S2.SS2.p2.8.m7.2.2.3.cmml" xref="S2.SS2.p2.8.m7.2.2.2"><apply id="S2.SS2.p2.8.m7.1.1.1.1.cmml" xref="S2.SS2.p2.8.m7.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.8.m7.1.1.1.1.1.cmml" xref="S2.SS2.p2.8.m7.1.1.1.1">subscript</csymbol><ci id="S2.SS2.p2.8.m7.1.1.1.1.2.cmml" xref="S2.SS2.p2.8.m7.1.1.1.1.2">𝑧</ci><cn id="S2.SS2.p2.8.m7.1.1.1.1.3.cmml" type="integer" xref="S2.SS2.p2.8.m7.1.1.1.1.3">1</cn></apply><apply id="S2.SS2.p2.8.m7.2.2.2.2.cmml" xref="S2.SS2.p2.8.m7.2.2.2.2"><times id="S2.SS2.p2.8.m7.2.2.2.2.1.cmml" xref="S2.SS2.p2.8.m7.2.2.2.2.1"></times><ci id="S2.SS2.p2.8.m7.2.2.2.2.2.cmml" xref="S2.SS2.p2.8.m7.2.2.2.2.2">⋯</ci><apply id="S2.SS2.p2.8.m7.2.2.2.2.3.cmml" xref="S2.SS2.p2.8.m7.2.2.2.2.3"><csymbol cd="ambiguous" id="S2.SS2.p2.8.m7.2.2.2.2.3.1.cmml" xref="S2.SS2.p2.8.m7.2.2.2.2.3">subscript</csymbol><ci id="S2.SS2.p2.8.m7.2.2.2.2.3.2.cmml" xref="S2.SS2.p2.8.m7.2.2.2.2.3.2">𝑧</ci><ci id="S2.SS2.p2.8.m7.2.2.2.2.3.3.cmml" xref="S2.SS2.p2.8.m7.2.2.2.2.3.3">𝑛</ci></apply></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.8.m7.2c">\{z_{1},\cdots z_{n}\}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.8.m7.2d">{ italic_z start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , ⋯ italic_z start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT }</annotation></semantics></math> after sorting. When <math alttext="m\neq n" class="ltx_Math" display="inline" id="S2.SS2.p2.9.m8.1"><semantics id="S2.SS2.p2.9.m8.1a"><mrow id="S2.SS2.p2.9.m8.1.1" xref="S2.SS2.p2.9.m8.1.1.cmml"><mi id="S2.SS2.p2.9.m8.1.1.2" xref="S2.SS2.p2.9.m8.1.1.2.cmml">m</mi><mo id="S2.SS2.p2.9.m8.1.1.1" xref="S2.SS2.p2.9.m8.1.1.1.cmml">≠</mo><mi id="S2.SS2.p2.9.m8.1.1.3" xref="S2.SS2.p2.9.m8.1.1.3.cmml">n</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.9.m8.1b"><apply id="S2.SS2.p2.9.m8.1.1.cmml" xref="S2.SS2.p2.9.m8.1.1"><neq id="S2.SS2.p2.9.m8.1.1.1.cmml" xref="S2.SS2.p2.9.m8.1.1.1"></neq><ci id="S2.SS2.p2.9.m8.1.1.2.cmml" xref="S2.SS2.p2.9.m8.1.1.2">𝑚</ci><ci id="S2.SS2.p2.9.m8.1.1.3.cmml" xref="S2.SS2.p2.9.m8.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.9.m8.1c">m\neq n</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.9.m8.1d">italic_m ≠ italic_n</annotation></semantics></math>, <math alttext="\text{EMD}_{\text{1d}}" class="ltx_Math" display="inline" id="S2.SS2.p2.10.m9.1"><semantics id="S2.SS2.p2.10.m9.1a"><msub id="S2.SS2.p2.10.m9.1.1" xref="S2.SS2.p2.10.m9.1.1.cmml"><mtext id="S2.SS2.p2.10.m9.1.1.2" xref="S2.SS2.p2.10.m9.1.1.2a.cmml">EMD</mtext><mtext id="S2.SS2.p2.10.m9.1.1.3" xref="S2.SS2.p2.10.m9.1.1.3a.cmml">1d</mtext></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.10.m9.1b"><apply id="S2.SS2.p2.10.m9.1.1.cmml" xref="S2.SS2.p2.10.m9.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.10.m9.1.1.1.cmml" xref="S2.SS2.p2.10.m9.1.1">subscript</csymbol><ci id="S2.SS2.p2.10.m9.1.1.2a.cmml" xref="S2.SS2.p2.10.m9.1.1.2"><mtext id="S2.SS2.p2.10.m9.1.1.2.cmml" xref="S2.SS2.p2.10.m9.1.1.2">EMD</mtext></ci><ci id="S2.SS2.p2.10.m9.1.1.3a.cmml" xref="S2.SS2.p2.10.m9.1.1.3"><mtext id="S2.SS2.p2.10.m9.1.1.3.cmml" mathsize="70%" xref="S2.SS2.p2.10.m9.1.1.3">1d</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.10.m9.1c">\text{EMD}_{\text{1d}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.10.m9.1d">EMD start_POSTSUBSCRIPT 1d end_POSTSUBSCRIPT</annotation></semantics></math> generalizes to solving inverse CDF of <math alttext="\mu,\nu" class="ltx_Math" display="inline" id="S2.SS2.p2.11.m10.2"><semantics id="S2.SS2.p2.11.m10.2a"><mrow id="S2.SS2.p2.11.m10.2.3.2" xref="S2.SS2.p2.11.m10.2.3.1.cmml"><mi id="S2.SS2.p2.11.m10.1.1" xref="S2.SS2.p2.11.m10.1.1.cmml">μ</mi><mo id="S2.SS2.p2.11.m10.2.3.2.1" xref="S2.SS2.p2.11.m10.2.3.1.cmml">,</mo><mi id="S2.SS2.p2.11.m10.2.2" xref="S2.SS2.p2.11.m10.2.2.cmml">ν</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.11.m10.2b"><list id="S2.SS2.p2.11.m10.2.3.1.cmml" xref="S2.SS2.p2.11.m10.2.3.2"><ci id="S2.SS2.p2.11.m10.1.1.cmml" xref="S2.SS2.p2.11.m10.1.1">𝜇</ci><ci id="S2.SS2.p2.11.m10.2.2.cmml" xref="S2.SS2.p2.11.m10.2.2">𝜈</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.11.m10.2c">\mu,\nu</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.11.m10.2d">italic_μ , italic_ν</annotation></semantics></math> <cite class="ltx_cite ltx_citemacro_citep">(Peyré and Cuturi, <a class="ltx_ref" href="https://arxiv.org/html/2410.03052v1#bib.bib30" title="">2019</a>)</cite> which requires approximation. To avoid this approximation, <em class="ltx_emph ltx_font_italic" id="S2.SS2.p2.15.2">after sorting</em>, we can compute the flow matrix <math alttext="{\bm{P}}" class="ltx_Math" display="inline" id="S2.SS2.p2.12.m11.1"><semantics id="S2.SS2.p2.12.m11.1a"><mi id="S2.SS2.p2.12.m11.1.1" xref="S2.SS2.p2.12.m11.1.1.cmml">𝑷</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.12.m11.1b"><ci id="S2.SS2.p2.12.m11.1.1.cmml" xref="S2.SS2.p2.12.m11.1.1">𝑷</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.12.m11.1c">{\bm{P}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.12.m11.1d">bold_italic_P</annotation></semantics></math> <cite class="ltx_cite ltx_citemacro_citep">(Hoffman, <a class="ltx_ref" href="https://arxiv.org/html/2410.03052v1#bib.bib18" title="">1963</a>)</cite> efficiently via a greedy algorithm in linear time (Alg.<a class="ltx_ref" href="https://arxiv.org/html/2410.03052v1#alg1" title="Algorithm 1 ‣ 2.2 Exact Earth Mover’s Distance ‣ 2 Preliminaries ‣ Learning Structured Representations by Embedding Class Hierarchy with Fast Optimal Transport"><span class="ltx_text ltx_ref_tag">1</span></a>) and use the inner product objective of EMD in Eq.<a class="ltx_ref" href="https://arxiv.org/html/2410.03052v1#S2.E3" title="Equation 3 ‣ 2.2 Exact Earth Mover’s Distance ‣ 2 Preliminaries ‣ Learning Structured Representations by Embedding Class Hierarchy with Fast Optimal Transport"><span class="ltx_text ltx_ref_tag">3</span></a> to compute the result. This greedy flow matching algorithm that generates the optimal transport plan can be used for any <math alttext="m,n" class="ltx_Math" display="inline" id="S2.SS2.p2.13.m12.2"><semantics id="S2.SS2.p2.13.m12.2a"><mrow id="S2.SS2.p2.13.m12.2.3.2" xref="S2.SS2.p2.13.m12.2.3.1.cmml"><mi id="S2.SS2.p2.13.m12.1.1" xref="S2.SS2.p2.13.m12.1.1.cmml">m</mi><mo id="S2.SS2.p2.13.m12.2.3.2.1" xref="S2.SS2.p2.13.m12.2.3.1.cmml">,</mo><mi id="S2.SS2.p2.13.m12.2.2" xref="S2.SS2.p2.13.m12.2.2.cmml">n</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.13.m12.2b"><list id="S2.SS2.p2.13.m12.2.3.1.cmml" xref="S2.SS2.p2.13.m12.2.3.2"><ci id="S2.SS2.p2.13.m12.1.1.cmml" xref="S2.SS2.p2.13.m12.1.1">𝑚</ci><ci id="S2.SS2.p2.13.m12.2.2.cmml" xref="S2.SS2.p2.13.m12.2.2">𝑛</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.13.m12.2c">m,n</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.13.m12.2d">italic_m , italic_n</annotation></semantics></math>, including the special case when <math alttext="m=n" class="ltx_Math" display="inline" id="S2.SS2.p2.14.m13.1"><semantics id="S2.SS2.p2.14.m13.1a"><mrow id="S2.SS2.p2.14.m13.1.1" xref="S2.SS2.p2.14.m13.1.1.cmml"><mi id="S2.SS2.p2.14.m13.1.1.2" xref="S2.SS2.p2.14.m13.1.1.2.cmml">m</mi><mo id="S2.SS2.p2.14.m13.1.1.1" xref="S2.SS2.p2.14.m13.1.1.1.cmml">=</mo><mi id="S2.SS2.p2.14.m13.1.1.3" xref="S2.SS2.p2.14.m13.1.1.3.cmml">n</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.14.m13.1b"><apply id="S2.SS2.p2.14.m13.1.1.cmml" xref="S2.SS2.p2.14.m13.1.1"><eq id="S2.SS2.p2.14.m13.1.1.1.cmml" xref="S2.SS2.p2.14.m13.1.1.1"></eq><ci id="S2.SS2.p2.14.m13.1.1.2.cmml" xref="S2.SS2.p2.14.m13.1.1.2">𝑚</ci><ci id="S2.SS2.p2.14.m13.1.1.3.cmml" xref="S2.SS2.p2.14.m13.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.14.m13.1c">m=n</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.14.m13.1d">italic_m = italic_n</annotation></semantics></math>, and fit any non-uniform weights of <math alttext="a,b" class="ltx_Math" display="inline" id="S2.SS2.p2.15.m14.2"><semantics id="S2.SS2.p2.15.m14.2a"><mrow id="S2.SS2.p2.15.m14.2.3.2" xref="S2.SS2.p2.15.m14.2.3.1.cmml"><mi id="S2.SS2.p2.15.m14.1.1" xref="S2.SS2.p2.15.m14.1.1.cmml">a</mi><mo id="S2.SS2.p2.15.m14.2.3.2.1" xref="S2.SS2.p2.15.m14.2.3.1.cmml">,</mo><mi id="S2.SS2.p2.15.m14.2.2" xref="S2.SS2.p2.15.m14.2.2.cmml">b</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.15.m14.2b"><list id="S2.SS2.p2.15.m14.2.3.1.cmml" xref="S2.SS2.p2.15.m14.2.3.2"><ci id="S2.SS2.p2.15.m14.1.1.cmml" xref="S2.SS2.p2.15.m14.1.1">𝑎</ci><ci id="S2.SS2.p2.15.m14.2.2.cmml" xref="S2.SS2.p2.15.m14.2.2">𝑏</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.15.m14.2c">a,b</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.15.m14.2d">italic_a , italic_b</annotation></semantics></math>.</p>
</div>
<figure class="ltx_figure" id="S2.SS2.fig1">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_float ltx_figure_panel ltx_minipage ltx_align_top ltx_framed ltx_framed_top" id="alg1" style="width:173.4pt;">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="alg1.2.1.1">Algorithm 1</span> </span> Greedy Flow Matching</figcaption>
<div class="ltx_listing ltx_listing" id="alg1.3">
<div class="ltx_listingline" id="alg1.l0">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l0.1.1.1" style="font-size:80%;">0:</span></span>  number of features <math alttext="m,n" class="ltx_Math" display="inline" id="alg1.l0.m1.2"><semantics id="alg1.l0.m1.2a"><mrow id="alg1.l0.m1.2.3.2" xref="alg1.l0.m1.2.3.1.cmml"><mi id="alg1.l0.m1.1.1" xref="alg1.l0.m1.1.1.cmml">m</mi><mo id="alg1.l0.m1.2.3.2.1" xref="alg1.l0.m1.2.3.1.cmml">,</mo><mi id="alg1.l0.m1.2.2" xref="alg1.l0.m1.2.2.cmml">n</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l0.m1.2b"><list id="alg1.l0.m1.2.3.1.cmml" xref="alg1.l0.m1.2.3.2"><ci id="alg1.l0.m1.1.1.cmml" xref="alg1.l0.m1.1.1">𝑚</ci><ci id="alg1.l0.m1.2.2.cmml" xref="alg1.l0.m1.2.2">𝑛</ci></list></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m1.2c">m,n</annotation><annotation encoding="application/x-llamapun" id="alg1.l0.m1.2d">italic_m , italic_n</annotation></semantics></math>,
weights <math alttext="a=({a_{1}},\ldots,{a_{m}})" class="ltx_Math" display="inline" id="alg1.l0.m2.3"><semantics id="alg1.l0.m2.3a"><mrow id="alg1.l0.m2.3.3" xref="alg1.l0.m2.3.3.cmml"><mi id="alg1.l0.m2.3.3.4" xref="alg1.l0.m2.3.3.4.cmml">a</mi><mo id="alg1.l0.m2.3.3.3" xref="alg1.l0.m2.3.3.3.cmml">=</mo><mrow id="alg1.l0.m2.3.3.2.2" xref="alg1.l0.m2.3.3.2.3.cmml"><mo id="alg1.l0.m2.3.3.2.2.3" stretchy="false" xref="alg1.l0.m2.3.3.2.3.cmml">(</mo><msub id="alg1.l0.m2.2.2.1.1.1" xref="alg1.l0.m2.2.2.1.1.1.cmml"><mi id="alg1.l0.m2.2.2.1.1.1.2" xref="alg1.l0.m2.2.2.1.1.1.2.cmml">a</mi><mn id="alg1.l0.m2.2.2.1.1.1.3" xref="alg1.l0.m2.2.2.1.1.1.3.cmml">1</mn></msub><mo id="alg1.l0.m2.3.3.2.2.4" xref="alg1.l0.m2.3.3.2.3.cmml">,</mo><mi id="alg1.l0.m2.1.1" mathvariant="normal" xref="alg1.l0.m2.1.1.cmml">…</mi><mo id="alg1.l0.m2.3.3.2.2.5" xref="alg1.l0.m2.3.3.2.3.cmml">,</mo><msub id="alg1.l0.m2.3.3.2.2.2" xref="alg1.l0.m2.3.3.2.2.2.cmml"><mi id="alg1.l0.m2.3.3.2.2.2.2" xref="alg1.l0.m2.3.3.2.2.2.2.cmml">a</mi><mi id="alg1.l0.m2.3.3.2.2.2.3" xref="alg1.l0.m2.3.3.2.2.2.3.cmml">m</mi></msub><mo id="alg1.l0.m2.3.3.2.2.6" stretchy="false" xref="alg1.l0.m2.3.3.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l0.m2.3b"><apply id="alg1.l0.m2.3.3.cmml" xref="alg1.l0.m2.3.3"><eq id="alg1.l0.m2.3.3.3.cmml" xref="alg1.l0.m2.3.3.3"></eq><ci id="alg1.l0.m2.3.3.4.cmml" xref="alg1.l0.m2.3.3.4">𝑎</ci><vector id="alg1.l0.m2.3.3.2.3.cmml" xref="alg1.l0.m2.3.3.2.2"><apply id="alg1.l0.m2.2.2.1.1.1.cmml" xref="alg1.l0.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="alg1.l0.m2.2.2.1.1.1.1.cmml" xref="alg1.l0.m2.2.2.1.1.1">subscript</csymbol><ci id="alg1.l0.m2.2.2.1.1.1.2.cmml" xref="alg1.l0.m2.2.2.1.1.1.2">𝑎</ci><cn id="alg1.l0.m2.2.2.1.1.1.3.cmml" type="integer" xref="alg1.l0.m2.2.2.1.1.1.3">1</cn></apply><ci id="alg1.l0.m2.1.1.cmml" xref="alg1.l0.m2.1.1">…</ci><apply id="alg1.l0.m2.3.3.2.2.2.cmml" xref="alg1.l0.m2.3.3.2.2.2"><csymbol cd="ambiguous" id="alg1.l0.m2.3.3.2.2.2.1.cmml" xref="alg1.l0.m2.3.3.2.2.2">subscript</csymbol><ci id="alg1.l0.m2.3.3.2.2.2.2.cmml" xref="alg1.l0.m2.3.3.2.2.2.2">𝑎</ci><ci id="alg1.l0.m2.3.3.2.2.2.3.cmml" xref="alg1.l0.m2.3.3.2.2.2.3">𝑚</ci></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m2.3c">a=({a_{1}},\ldots,{a_{m}})</annotation><annotation encoding="application/x-llamapun" id="alg1.l0.m2.3d">italic_a = ( italic_a start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_a start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT )</annotation></semantics></math>, <math alttext="b=({b_{1}},\ldots,{b_{n}})" class="ltx_Math" display="inline" id="alg1.l0.m3.3"><semantics id="alg1.l0.m3.3a"><mrow id="alg1.l0.m3.3.3" xref="alg1.l0.m3.3.3.cmml"><mi id="alg1.l0.m3.3.3.4" xref="alg1.l0.m3.3.3.4.cmml">b</mi><mo id="alg1.l0.m3.3.3.3" xref="alg1.l0.m3.3.3.3.cmml">=</mo><mrow id="alg1.l0.m3.3.3.2.2" xref="alg1.l0.m3.3.3.2.3.cmml"><mo id="alg1.l0.m3.3.3.2.2.3" stretchy="false" xref="alg1.l0.m3.3.3.2.3.cmml">(</mo><msub id="alg1.l0.m3.2.2.1.1.1" xref="alg1.l0.m3.2.2.1.1.1.cmml"><mi id="alg1.l0.m3.2.2.1.1.1.2" xref="alg1.l0.m3.2.2.1.1.1.2.cmml">b</mi><mn id="alg1.l0.m3.2.2.1.1.1.3" xref="alg1.l0.m3.2.2.1.1.1.3.cmml">1</mn></msub><mo id="alg1.l0.m3.3.3.2.2.4" xref="alg1.l0.m3.3.3.2.3.cmml">,</mo><mi id="alg1.l0.m3.1.1" mathvariant="normal" xref="alg1.l0.m3.1.1.cmml">…</mi><mo id="alg1.l0.m3.3.3.2.2.5" xref="alg1.l0.m3.3.3.2.3.cmml">,</mo><msub id="alg1.l0.m3.3.3.2.2.2" xref="alg1.l0.m3.3.3.2.2.2.cmml"><mi id="alg1.l0.m3.3.3.2.2.2.2" xref="alg1.l0.m3.3.3.2.2.2.2.cmml">b</mi><mi id="alg1.l0.m3.3.3.2.2.2.3" xref="alg1.l0.m3.3.3.2.2.2.3.cmml">n</mi></msub><mo id="alg1.l0.m3.3.3.2.2.6" stretchy="false" xref="alg1.l0.m3.3.3.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l0.m3.3b"><apply id="alg1.l0.m3.3.3.cmml" xref="alg1.l0.m3.3.3"><eq id="alg1.l0.m3.3.3.3.cmml" xref="alg1.l0.m3.3.3.3"></eq><ci id="alg1.l0.m3.3.3.4.cmml" xref="alg1.l0.m3.3.3.4">𝑏</ci><vector id="alg1.l0.m3.3.3.2.3.cmml" xref="alg1.l0.m3.3.3.2.2"><apply id="alg1.l0.m3.2.2.1.1.1.cmml" xref="alg1.l0.m3.2.2.1.1.1"><csymbol cd="ambiguous" id="alg1.l0.m3.2.2.1.1.1.1.cmml" xref="alg1.l0.m3.2.2.1.1.1">subscript</csymbol><ci id="alg1.l0.m3.2.2.1.1.1.2.cmml" xref="alg1.l0.m3.2.2.1.1.1.2">𝑏</ci><cn id="alg1.l0.m3.2.2.1.1.1.3.cmml" type="integer" xref="alg1.l0.m3.2.2.1.1.1.3">1</cn></apply><ci id="alg1.l0.m3.1.1.cmml" xref="alg1.l0.m3.1.1">…</ci><apply id="alg1.l0.m3.3.3.2.2.2.cmml" xref="alg1.l0.m3.3.3.2.2.2"><csymbol cd="ambiguous" id="alg1.l0.m3.3.3.2.2.2.1.cmml" xref="alg1.l0.m3.3.3.2.2.2">subscript</csymbol><ci id="alg1.l0.m3.3.3.2.2.2.2.cmml" xref="alg1.l0.m3.3.3.2.2.2.2">𝑏</ci><ci id="alg1.l0.m3.3.3.2.2.2.3.cmml" xref="alg1.l0.m3.3.3.2.2.2.3">𝑛</ci></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m3.3c">b=({b_{1}},\ldots,{b_{n}})</annotation><annotation encoding="application/x-llamapun" id="alg1.l0.m3.3d">italic_b = ( italic_b start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_b start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l1">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l1.1.1.1" style="font-size:80%;">1:</span></span>  <math alttext="{\bm{P}}=\mathrm{Array}[m\times n]" class="ltx_Math" display="inline" id="alg1.l1.m1.1"><semantics id="alg1.l1.m1.1a"><mrow id="alg1.l1.m1.1.1" xref="alg1.l1.m1.1.1.cmml"><mi id="alg1.l1.m1.1.1.3" xref="alg1.l1.m1.1.1.3.cmml">𝑷</mi><mo id="alg1.l1.m1.1.1.2" xref="alg1.l1.m1.1.1.2.cmml">=</mo><mrow id="alg1.l1.m1.1.1.1" xref="alg1.l1.m1.1.1.1.cmml"><mi id="alg1.l1.m1.1.1.1.3" xref="alg1.l1.m1.1.1.1.3.cmml">Array</mi><mo id="alg1.l1.m1.1.1.1.2" xref="alg1.l1.m1.1.1.1.2.cmml">⁢</mo><mrow id="alg1.l1.m1.1.1.1.1.1" xref="alg1.l1.m1.1.1.1.1.2.cmml"><mo id="alg1.l1.m1.1.1.1.1.1.2" stretchy="false" xref="alg1.l1.m1.1.1.1.1.2.1.cmml">[</mo><mrow id="alg1.l1.m1.1.1.1.1.1.1" xref="alg1.l1.m1.1.1.1.1.1.1.cmml"><mi id="alg1.l1.m1.1.1.1.1.1.1.2" xref="alg1.l1.m1.1.1.1.1.1.1.2.cmml">m</mi><mo id="alg1.l1.m1.1.1.1.1.1.1.1" lspace="0.222em" rspace="0.222em" xref="alg1.l1.m1.1.1.1.1.1.1.1.cmml">×</mo><mi id="alg1.l1.m1.1.1.1.1.1.1.3" xref="alg1.l1.m1.1.1.1.1.1.1.3.cmml">n</mi></mrow><mo id="alg1.l1.m1.1.1.1.1.1.3" stretchy="false" xref="alg1.l1.m1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l1.m1.1b"><apply id="alg1.l1.m1.1.1.cmml" xref="alg1.l1.m1.1.1"><eq id="alg1.l1.m1.1.1.2.cmml" xref="alg1.l1.m1.1.1.2"></eq><ci id="alg1.l1.m1.1.1.3.cmml" xref="alg1.l1.m1.1.1.3">𝑷</ci><apply id="alg1.l1.m1.1.1.1.cmml" xref="alg1.l1.m1.1.1.1"><times id="alg1.l1.m1.1.1.1.2.cmml" xref="alg1.l1.m1.1.1.1.2"></times><ci id="alg1.l1.m1.1.1.1.3.cmml" xref="alg1.l1.m1.1.1.1.3">Array</ci><apply id="alg1.l1.m1.1.1.1.1.2.cmml" xref="alg1.l1.m1.1.1.1.1.1"><csymbol cd="latexml" id="alg1.l1.m1.1.1.1.1.2.1.cmml" xref="alg1.l1.m1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="alg1.l1.m1.1.1.1.1.1.1.cmml" xref="alg1.l1.m1.1.1.1.1.1.1"><times id="alg1.l1.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l1.m1.1.1.1.1.1.1.1"></times><ci id="alg1.l1.m1.1.1.1.1.1.1.2.cmml" xref="alg1.l1.m1.1.1.1.1.1.1.2">𝑚</ci><ci id="alg1.l1.m1.1.1.1.1.1.1.3.cmml" xref="alg1.l1.m1.1.1.1.1.1.1.3">𝑛</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m1.1c">{\bm{P}}=\mathrm{Array}[m\times n]</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m1.1d">bold_italic_P = roman_Array [ italic_m × italic_n ]</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l2">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l2.1.1.1" style="font-size:80%;">2:</span></span>  <math alttext="i=0" class="ltx_Math" display="inline" id="alg1.l2.m1.1"><semantics id="alg1.l2.m1.1a"><mrow id="alg1.l2.m1.1.1" xref="alg1.l2.m1.1.1.cmml"><mi id="alg1.l2.m1.1.1.2" xref="alg1.l2.m1.1.1.2.cmml">i</mi><mo id="alg1.l2.m1.1.1.1" xref="alg1.l2.m1.1.1.1.cmml">=</mo><mn id="alg1.l2.m1.1.1.3" xref="alg1.l2.m1.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="alg1.l2.m1.1b"><apply id="alg1.l2.m1.1.1.cmml" xref="alg1.l2.m1.1.1"><eq id="alg1.l2.m1.1.1.1.cmml" xref="alg1.l2.m1.1.1.1"></eq><ci id="alg1.l2.m1.1.1.2.cmml" xref="alg1.l2.m1.1.1.2">𝑖</ci><cn id="alg1.l2.m1.1.1.3.cmml" type="integer" xref="alg1.l2.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m1.1c">i=0</annotation><annotation encoding="application/x-llamapun" id="alg1.l2.m1.1d">italic_i = 0</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l3">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l3.1.1.1" style="font-size:80%;">3:</span></span>  <math alttext="j=0" class="ltx_Math" display="inline" id="alg1.l3.m1.1"><semantics id="alg1.l3.m1.1a"><mrow id="alg1.l3.m1.1.1" xref="alg1.l3.m1.1.1.cmml"><mi id="alg1.l3.m1.1.1.2" xref="alg1.l3.m1.1.1.2.cmml">j</mi><mo id="alg1.l3.m1.1.1.1" xref="alg1.l3.m1.1.1.1.cmml">=</mo><mn id="alg1.l3.m1.1.1.3" xref="alg1.l3.m1.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="alg1.l3.m1.1b"><apply id="alg1.l3.m1.1.1.cmml" xref="alg1.l3.m1.1.1"><eq id="alg1.l3.m1.1.1.1.cmml" xref="alg1.l3.m1.1.1.1"></eq><ci id="alg1.l3.m1.1.1.2.cmml" xref="alg1.l3.m1.1.1.2">𝑗</ci><cn id="alg1.l3.m1.1.1.3.cmml" type="integer" xref="alg1.l3.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m1.1c">j=0</annotation><annotation encoding="application/x-llamapun" id="alg1.l3.m1.1d">italic_j = 0</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l4">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l4.2.1.1" style="font-size:80%;">4:</span></span>  <span class="ltx_text ltx_font_bold" id="alg1.l4.3">while</span> <math alttext="i&lt;m" class="ltx_Math" display="inline" id="alg1.l4.m1.1"><semantics id="alg1.l4.m1.1a"><mrow id="alg1.l4.m1.1.1" xref="alg1.l4.m1.1.1.cmml"><mi id="alg1.l4.m1.1.1.2" mathcolor="#2E8BC0" xref="alg1.l4.m1.1.1.2.cmml">i</mi><mo id="alg1.l4.m1.1.1.1" mathcolor="#2E8BC0" xref="alg1.l4.m1.1.1.1.cmml">&lt;</mo><mi id="alg1.l4.m1.1.1.3" mathcolor="#2E8BC0" xref="alg1.l4.m1.1.1.3.cmml">m</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l4.m1.1b"><apply id="alg1.l4.m1.1.1.cmml" xref="alg1.l4.m1.1.1"><lt id="alg1.l4.m1.1.1.1.cmml" xref="alg1.l4.m1.1.1.1"></lt><ci id="alg1.l4.m1.1.1.2.cmml" xref="alg1.l4.m1.1.1.2">𝑖</ci><ci id="alg1.l4.m1.1.1.3.cmml" xref="alg1.l4.m1.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m1.1c">i&lt;m</annotation><annotation encoding="application/x-llamapun" id="alg1.l4.m1.1d">italic_i &lt; italic_m</annotation></semantics></math><span class="ltx_text" id="alg1.l4.1" style="color:#2E8BC0;"> <span class="ltx_text ltx_font_bold" id="alg1.l4.1.1">and</span> <math alttext="j&lt;n" class="ltx_Math" display="inline" id="alg1.l4.1.m1.1"><semantics id="alg1.l4.1.m1.1a"><mrow id="alg1.l4.1.m1.1.1" xref="alg1.l4.1.m1.1.1.cmml"><mi id="alg1.l4.1.m1.1.1.2" mathcolor="#2E8BC0" xref="alg1.l4.1.m1.1.1.2.cmml">j</mi><mo id="alg1.l4.1.m1.1.1.1" mathcolor="#2E8BC0" xref="alg1.l4.1.m1.1.1.1.cmml">&lt;</mo><mi id="alg1.l4.1.m1.1.1.3" mathcolor="#2E8BC0" xref="alg1.l4.1.m1.1.1.3.cmml">n</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l4.1.m1.1b"><apply id="alg1.l4.1.m1.1.1.cmml" xref="alg1.l4.1.m1.1.1"><lt id="alg1.l4.1.m1.1.1.1.cmml" xref="alg1.l4.1.m1.1.1.1"></lt><ci id="alg1.l4.1.m1.1.1.2.cmml" xref="alg1.l4.1.m1.1.1.2">𝑗</ci><ci id="alg1.l4.1.m1.1.1.3.cmml" xref="alg1.l4.1.m1.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.1.m1.1c">j&lt;n</annotation><annotation encoding="application/x-llamapun" id="alg1.l4.1.m1.1d">italic_j &lt; italic_n</annotation></semantics></math></span> <span class="ltx_text ltx_font_bold" id="alg1.l4.4">do</span>
</div>
<div class="ltx_listingline" id="alg1.l5">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l5.1.1.1" style="font-size:80%;">5:</span></span>     <math alttext="{\bm{P}}[i,j]\leftarrow\min(a[i],b[j])" class="ltx_Math" display="inline" id="alg1.l5.m1.7"><semantics id="alg1.l5.m1.7a"><mrow id="alg1.l5.m1.7.7" xref="alg1.l5.m1.7.7.cmml"><mrow id="alg1.l5.m1.7.7.4" xref="alg1.l5.m1.7.7.4.cmml"><mi id="alg1.l5.m1.7.7.4.2" mathcolor="#2E8BC0" xref="alg1.l5.m1.7.7.4.2.cmml">𝑷</mi><mo id="alg1.l5.m1.7.7.4.1" xref="alg1.l5.m1.7.7.4.1.cmml">⁢</mo><mrow id="alg1.l5.m1.7.7.4.3.2" xref="alg1.l5.m1.7.7.4.3.1.cmml"><mo id="alg1.l5.m1.7.7.4.3.2.1" mathcolor="#2E8BC0" stretchy="false" xref="alg1.l5.m1.7.7.4.3.1.cmml">[</mo><mi id="alg1.l5.m1.1.1" mathcolor="#2E8BC0" xref="alg1.l5.m1.1.1.cmml">i</mi><mo id="alg1.l5.m1.7.7.4.3.2.2" mathcolor="#2E8BC0" xref="alg1.l5.m1.7.7.4.3.1.cmml">,</mo><mi id="alg1.l5.m1.2.2" mathcolor="#2E8BC0" xref="alg1.l5.m1.2.2.cmml">j</mi><mo id="alg1.l5.m1.7.7.4.3.2.3" mathcolor="#2E8BC0" stretchy="false" xref="alg1.l5.m1.7.7.4.3.1.cmml">]</mo></mrow></mrow><mo id="alg1.l5.m1.7.7.3" mathcolor="#2E8BC0" stretchy="false" xref="alg1.l5.m1.7.7.3.cmml">←</mo><mrow id="alg1.l5.m1.7.7.2.2" xref="alg1.l5.m1.7.7.2.3.cmml"><mi id="alg1.l5.m1.5.5" mathcolor="#2E8BC0" xref="alg1.l5.m1.5.5.cmml">min</mi><mo id="alg1.l5.m1.7.7.2.2a" xref="alg1.l5.m1.7.7.2.3.cmml">⁡</mo><mrow id="alg1.l5.m1.7.7.2.2.2" xref="alg1.l5.m1.7.7.2.3.cmml"><mo id="alg1.l5.m1.7.7.2.2.2.3" mathcolor="#2E8BC0" stretchy="false" xref="alg1.l5.m1.7.7.2.3.cmml">(</mo><mrow id="alg1.l5.m1.6.6.1.1.1.1" xref="alg1.l5.m1.6.6.1.1.1.1.cmml"><mi id="alg1.l5.m1.6.6.1.1.1.1.2" mathcolor="#2E8BC0" xref="alg1.l5.m1.6.6.1.1.1.1.2.cmml">a</mi><mo id="alg1.l5.m1.6.6.1.1.1.1.1" xref="alg1.l5.m1.6.6.1.1.1.1.1.cmml">⁢</mo><mrow id="alg1.l5.m1.6.6.1.1.1.1.3.2" xref="alg1.l5.m1.6.6.1.1.1.1.3.1.cmml"><mo id="alg1.l5.m1.6.6.1.1.1.1.3.2.1" mathcolor="#2E8BC0" stretchy="false" xref="alg1.l5.m1.6.6.1.1.1.1.3.1.1.cmml">[</mo><mi id="alg1.l5.m1.3.3" mathcolor="#2E8BC0" xref="alg1.l5.m1.3.3.cmml">i</mi><mo id="alg1.l5.m1.6.6.1.1.1.1.3.2.2" mathcolor="#2E8BC0" stretchy="false" xref="alg1.l5.m1.6.6.1.1.1.1.3.1.1.cmml">]</mo></mrow></mrow><mo id="alg1.l5.m1.7.7.2.2.2.4" mathcolor="#2E8BC0" xref="alg1.l5.m1.7.7.2.3.cmml">,</mo><mrow id="alg1.l5.m1.7.7.2.2.2.2" xref="alg1.l5.m1.7.7.2.2.2.2.cmml"><mi id="alg1.l5.m1.7.7.2.2.2.2.2" mathcolor="#2E8BC0" xref="alg1.l5.m1.7.7.2.2.2.2.2.cmml">b</mi><mo id="alg1.l5.m1.7.7.2.2.2.2.1" xref="alg1.l5.m1.7.7.2.2.2.2.1.cmml">⁢</mo><mrow id="alg1.l5.m1.7.7.2.2.2.2.3.2" xref="alg1.l5.m1.7.7.2.2.2.2.3.1.cmml"><mo id="alg1.l5.m1.7.7.2.2.2.2.3.2.1" mathcolor="#2E8BC0" stretchy="false" xref="alg1.l5.m1.7.7.2.2.2.2.3.1.1.cmml">[</mo><mi id="alg1.l5.m1.4.4" mathcolor="#2E8BC0" xref="alg1.l5.m1.4.4.cmml">j</mi><mo id="alg1.l5.m1.7.7.2.2.2.2.3.2.2" mathcolor="#2E8BC0" stretchy="false" xref="alg1.l5.m1.7.7.2.2.2.2.3.1.1.cmml">]</mo></mrow></mrow><mo id="alg1.l5.m1.7.7.2.2.2.5" mathcolor="#2E8BC0" stretchy="false" xref="alg1.l5.m1.7.7.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l5.m1.7b"><apply id="alg1.l5.m1.7.7.cmml" xref="alg1.l5.m1.7.7"><ci id="alg1.l5.m1.7.7.3.cmml" xref="alg1.l5.m1.7.7.3">←</ci><apply id="alg1.l5.m1.7.7.4.cmml" xref="alg1.l5.m1.7.7.4"><times id="alg1.l5.m1.7.7.4.1.cmml" xref="alg1.l5.m1.7.7.4.1"></times><ci id="alg1.l5.m1.7.7.4.2.cmml" xref="alg1.l5.m1.7.7.4.2">𝑷</ci><interval closure="closed" id="alg1.l5.m1.7.7.4.3.1.cmml" xref="alg1.l5.m1.7.7.4.3.2"><ci id="alg1.l5.m1.1.1.cmml" xref="alg1.l5.m1.1.1">𝑖</ci><ci id="alg1.l5.m1.2.2.cmml" xref="alg1.l5.m1.2.2">𝑗</ci></interval></apply><apply id="alg1.l5.m1.7.7.2.3.cmml" xref="alg1.l5.m1.7.7.2.2"><min id="alg1.l5.m1.5.5.cmml" xref="alg1.l5.m1.5.5"></min><apply id="alg1.l5.m1.6.6.1.1.1.1.cmml" xref="alg1.l5.m1.6.6.1.1.1.1"><times id="alg1.l5.m1.6.6.1.1.1.1.1.cmml" xref="alg1.l5.m1.6.6.1.1.1.1.1"></times><ci id="alg1.l5.m1.6.6.1.1.1.1.2.cmml" xref="alg1.l5.m1.6.6.1.1.1.1.2">𝑎</ci><apply id="alg1.l5.m1.6.6.1.1.1.1.3.1.cmml" xref="alg1.l5.m1.6.6.1.1.1.1.3.2"><csymbol cd="latexml" id="alg1.l5.m1.6.6.1.1.1.1.3.1.1.cmml" xref="alg1.l5.m1.6.6.1.1.1.1.3.2.1">delimited-[]</csymbol><ci id="alg1.l5.m1.3.3.cmml" xref="alg1.l5.m1.3.3">𝑖</ci></apply></apply><apply id="alg1.l5.m1.7.7.2.2.2.2.cmml" xref="alg1.l5.m1.7.7.2.2.2.2"><times id="alg1.l5.m1.7.7.2.2.2.2.1.cmml" xref="alg1.l5.m1.7.7.2.2.2.2.1"></times><ci id="alg1.l5.m1.7.7.2.2.2.2.2.cmml" xref="alg1.l5.m1.7.7.2.2.2.2.2">𝑏</ci><apply id="alg1.l5.m1.7.7.2.2.2.2.3.1.cmml" xref="alg1.l5.m1.7.7.2.2.2.2.3.2"><csymbol cd="latexml" id="alg1.l5.m1.7.7.2.2.2.2.3.1.1.cmml" xref="alg1.l5.m1.7.7.2.2.2.2.3.2.1">delimited-[]</csymbol><ci id="alg1.l5.m1.4.4.cmml" xref="alg1.l5.m1.4.4">𝑗</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m1.7c">{\bm{P}}[i,j]\leftarrow\min(a[i],b[j])</annotation><annotation encoding="application/x-llamapun" id="alg1.l5.m1.7d">bold_italic_P [ italic_i , italic_j ] ← roman_min ( italic_a [ italic_i ] , italic_b [ italic_j ] )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l6">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l6.1.1.1" style="font-size:80%;">6:</span></span>     <math alttext="a[i]\mathrel{-}={\bm{P}}[i,j]" class="ltx_math_unparsed" display="inline" id="alg1.l6.m1.1"><semantics id="alg1.l6.m1.1a"><mrow id="alg1.l6.m1.1b"><mi id="alg1.l6.m1.1.2" mathcolor="#2E8BC0">a</mi><mrow id="alg1.l6.m1.1.3"><mo id="alg1.l6.m1.1.3.1" mathcolor="#2E8BC0" stretchy="false">[</mo><mi id="alg1.l6.m1.1.1" mathcolor="#2E8BC0">i</mi><mo id="alg1.l6.m1.1.3.2" mathcolor="#2E8BC0" rspace="0.056em" stretchy="false">]</mo></mrow><mo id="alg1.l6.m1.1.4" mathcolor="#2E8BC0" rspace="0em">-</mo><mo id="alg1.l6.m1.1.5" lspace="0em" mathcolor="#2E8BC0">=</mo><mi id="alg1.l6.m1.1.6" mathcolor="#2E8BC0">𝑷</mi><mrow id="alg1.l6.m1.1.7"><mo id="alg1.l6.m1.1.7.1" mathcolor="#2E8BC0" stretchy="false">[</mo><mi id="alg1.l6.m1.1.7.2" mathcolor="#2E8BC0">i</mi><mo id="alg1.l6.m1.1.7.3" mathcolor="#2E8BC0">,</mo><mi id="alg1.l6.m1.1.7.4" mathcolor="#2E8BC0">j</mi><mo id="alg1.l6.m1.1.7.5" mathcolor="#2E8BC0" stretchy="false">]</mo></mrow></mrow><annotation encoding="application/x-tex" id="alg1.l6.m1.1c">a[i]\mathrel{-}={\bm{P}}[i,j]</annotation><annotation encoding="application/x-llamapun" id="alg1.l6.m1.1d">italic_a [ italic_i ] - = bold_italic_P [ italic_i , italic_j ]</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l7">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l7.1.1.1" style="font-size:80%;">7:</span></span>     <math alttext="b[j]\mathrel{-}={\bm{P}}[i,j]" class="ltx_math_unparsed" display="inline" id="alg1.l7.m1.1"><semantics id="alg1.l7.m1.1a"><mrow id="alg1.l7.m1.1b"><mi id="alg1.l7.m1.1.2" mathcolor="#2E8BC0">b</mi><mrow id="alg1.l7.m1.1.3"><mo id="alg1.l7.m1.1.3.1" mathcolor="#2E8BC0" stretchy="false">[</mo><mi id="alg1.l7.m1.1.1" mathcolor="#2E8BC0">j</mi><mo id="alg1.l7.m1.1.3.2" mathcolor="#2E8BC0" rspace="0.056em" stretchy="false">]</mo></mrow><mo id="alg1.l7.m1.1.4" mathcolor="#2E8BC0" rspace="0em">-</mo><mo id="alg1.l7.m1.1.5" lspace="0em" mathcolor="#2E8BC0">=</mo><mi id="alg1.l7.m1.1.6" mathcolor="#2E8BC0">𝑷</mi><mrow id="alg1.l7.m1.1.7"><mo id="alg1.l7.m1.1.7.1" mathcolor="#2E8BC0" stretchy="false">[</mo><mi id="alg1.l7.m1.1.7.2" mathcolor="#2E8BC0">i</mi><mo id="alg1.l7.m1.1.7.3" mathcolor="#2E8BC0">,</mo><mi id="alg1.l7.m1.1.7.4" mathcolor="#2E8BC0">j</mi><mo id="alg1.l7.m1.1.7.5" mathcolor="#2E8BC0" stretchy="false">]</mo></mrow></mrow><annotation encoding="application/x-tex" id="alg1.l7.m1.1c">b[j]\mathrel{-}={\bm{P}}[i,j]</annotation><annotation encoding="application/x-llamapun" id="alg1.l7.m1.1d">italic_b [ italic_j ] - = bold_italic_P [ italic_i , italic_j ]</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l8">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l8.1.1.1" style="font-size:80%;">8:</span></span>     <span class="ltx_text ltx_font_bold" id="alg1.l8.2">if</span> <math alttext="a[i]==0" class="ltx_math_unparsed" display="inline" id="alg1.l8.m1.1"><semantics id="alg1.l8.m1.1a"><mrow id="alg1.l8.m1.1b"><mi id="alg1.l8.m1.1.2">a</mi><mrow id="alg1.l8.m1.1.3"><mo id="alg1.l8.m1.1.3.1" stretchy="false">[</mo><mi id="alg1.l8.m1.1.1">i</mi><mo id="alg1.l8.m1.1.3.2" stretchy="false">]</mo></mrow><mo id="alg1.l8.m1.1.4" rspace="0em">=</mo><mo id="alg1.l8.m1.1.5" lspace="0em">=</mo><mn id="alg1.l8.m1.1.6">0</mn></mrow><annotation encoding="application/x-tex" id="alg1.l8.m1.1c">a[i]==0</annotation><annotation encoding="application/x-llamapun" id="alg1.l8.m1.1d">italic_a [ italic_i ] = = 0</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="alg1.l8.3">then</span> <math alttext="\quad i\mathrel{+}=1" class="ltx_math_unparsed" display="inline" id="alg1.l8.m2.1"><semantics id="alg1.l8.m2.1a"><mrow id="alg1.l8.m2.1b"><mi id="alg1.l8.m2.1.1">i</mi><mo id="alg1.l8.m2.1.2" lspace="0.278em" rspace="0em">+</mo><mo id="alg1.l8.m2.1.3" lspace="0em">=</mo><mn id="alg1.l8.m2.1.4">1</mn></mrow><annotation encoding="application/x-tex" id="alg1.l8.m2.1c">\quad i\mathrel{+}=1</annotation><annotation encoding="application/x-llamapun" id="alg1.l8.m2.1d">italic_i + = 1</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l9">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l9.1.1.1" style="font-size:80%;">9:</span></span>     <span class="ltx_text ltx_font_bold" id="alg1.l9.2">if</span> <math alttext="b[j]==0" class="ltx_math_unparsed" display="inline" id="alg1.l9.m1.1"><semantics id="alg1.l9.m1.1a"><mrow id="alg1.l9.m1.1b"><mi id="alg1.l9.m1.1.2">b</mi><mrow id="alg1.l9.m1.1.3"><mo id="alg1.l9.m1.1.3.1" stretchy="false">[</mo><mi id="alg1.l9.m1.1.1">j</mi><mo id="alg1.l9.m1.1.3.2" stretchy="false">]</mo></mrow><mo id="alg1.l9.m1.1.4" rspace="0em">=</mo><mo id="alg1.l9.m1.1.5" lspace="0em">=</mo><mn id="alg1.l9.m1.1.6">0</mn></mrow><annotation encoding="application/x-tex" id="alg1.l9.m1.1c">b[j]==0</annotation><annotation encoding="application/x-llamapun" id="alg1.l9.m1.1d">italic_b [ italic_j ] = = 0</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="alg1.l9.3">then</span> <math alttext="\quad j\mathrel{+}=1" class="ltx_math_unparsed" display="inline" id="alg1.l9.m2.1"><semantics id="alg1.l9.m2.1a"><mrow id="alg1.l9.m2.1b"><mi id="alg1.l9.m2.1.1">j</mi><mo id="alg1.l9.m2.1.2" lspace="0.278em" rspace="0em">+</mo><mo id="alg1.l9.m2.1.3" lspace="0em">=</mo><mn id="alg1.l9.m2.1.4">1</mn></mrow><annotation encoding="application/x-tex" id="alg1.l9.m2.1c">\quad j\mathrel{+}=1</annotation><annotation encoding="application/x-llamapun" id="alg1.l9.m2.1d">italic_j + = 1</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l9a">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l9a.1.1.1" style="font-size:80%;">9:</span></span>  <math alttext="{\bm{P}}" class="ltx_Math" display="inline" id="alg1.l9a.m1.1"><semantics id="alg1.l9a.m1.1a"><mi id="alg1.l9a.m1.1.1" xref="alg1.l9a.m1.1.1.cmml">𝑷</mi><annotation-xml encoding="MathML-Content" id="alg1.l9a.m1.1b"><ci id="alg1.l9a.m1.1.1.cmml" xref="alg1.l9a.m1.1.1">𝑷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9a.m1.1c">{\bm{P}}</annotation><annotation encoding="application/x-llamapun" id="alg1.l9a.m1.1d">bold_italic_P</annotation></semantics></math>
</div>
</div>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_float ltx_figure_panel ltx_minipage ltx_align_center ltx_align_top ltx_framed ltx_framed_top" id="alg2" style="width:251.5pt;">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="alg2.2.1.1">Algorithm 2</span> </span> Bottom-up Tree Flow Matching</figcaption>
<div class="ltx_listing ltx_listing" id="alg2.3">
<div class="ltx_listingline" id="alg2.l0">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l0.1.1.1" style="font-size:80%;">0:</span></span>  <math alttext="m,n,a,b" class="ltx_Math" display="inline" id="alg2.l0.m1.4"><semantics id="alg2.l0.m1.4a"><mrow id="alg2.l0.m1.4.5.2" xref="alg2.l0.m1.4.5.1.cmml"><mi id="alg2.l0.m1.1.1" xref="alg2.l0.m1.1.1.cmml">m</mi><mo id="alg2.l0.m1.4.5.2.1" xref="alg2.l0.m1.4.5.1.cmml">,</mo><mi id="alg2.l0.m1.2.2" xref="alg2.l0.m1.2.2.cmml">n</mi><mo id="alg2.l0.m1.4.5.2.2" xref="alg2.l0.m1.4.5.1.cmml">,</mo><mi id="alg2.l0.m1.3.3" xref="alg2.l0.m1.3.3.cmml">a</mi><mo id="alg2.l0.m1.4.5.2.3" xref="alg2.l0.m1.4.5.1.cmml">,</mo><mi id="alg2.l0.m1.4.4" xref="alg2.l0.m1.4.4.cmml">b</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.l0.m1.4b"><list id="alg2.l0.m1.4.5.1.cmml" xref="alg2.l0.m1.4.5.2"><ci id="alg2.l0.m1.1.1.cmml" xref="alg2.l0.m1.1.1">𝑚</ci><ci id="alg2.l0.m1.2.2.cmml" xref="alg2.l0.m1.2.2">𝑛</ci><ci id="alg2.l0.m1.3.3.cmml" xref="alg2.l0.m1.3.3">𝑎</ci><ci id="alg2.l0.m1.4.4.cmml" xref="alg2.l0.m1.4.4">𝑏</ci></list></annotation-xml><annotation encoding="application/x-tex" id="alg2.l0.m1.4c">m,n,a,b</annotation><annotation encoding="application/x-llamapun" id="alg2.l0.m1.4d">italic_m , italic_n , italic_a , italic_b</annotation></semantics></math>, flow tree <math alttext="\mathcal{T}" class="ltx_Math" display="inline" id="alg2.l0.m2.1"><semantics id="alg2.l0.m2.1a"><mi class="ltx_font_mathcaligraphic" id="alg2.l0.m2.1.1" xref="alg2.l0.m2.1.1.cmml">𝒯</mi><annotation-xml encoding="MathML-Content" id="alg2.l0.m2.1b"><ci id="alg2.l0.m2.1.1.cmml" xref="alg2.l0.m2.1.1">𝒯</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l0.m2.1c">\mathcal{T}</annotation><annotation encoding="application/x-llamapun" id="alg2.l0.m2.1d">caligraphic_T</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg2.l1">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l1.1.1.1" style="font-size:80%;">1:</span></span>  <math alttext="{\bm{P}}=\mathrm{Array}[m\times n]" class="ltx_Math" display="inline" id="alg2.l1.m1.1"><semantics id="alg2.l1.m1.1a"><mrow id="alg2.l1.m1.1.1" xref="alg2.l1.m1.1.1.cmml"><mi id="alg2.l1.m1.1.1.3" xref="alg2.l1.m1.1.1.3.cmml">𝑷</mi><mo id="alg2.l1.m1.1.1.2" xref="alg2.l1.m1.1.1.2.cmml">=</mo><mrow id="alg2.l1.m1.1.1.1" xref="alg2.l1.m1.1.1.1.cmml"><mi id="alg2.l1.m1.1.1.1.3" xref="alg2.l1.m1.1.1.1.3.cmml">Array</mi><mo id="alg2.l1.m1.1.1.1.2" xref="alg2.l1.m1.1.1.1.2.cmml">⁢</mo><mrow id="alg2.l1.m1.1.1.1.1.1" xref="alg2.l1.m1.1.1.1.1.2.cmml"><mo id="alg2.l1.m1.1.1.1.1.1.2" stretchy="false" xref="alg2.l1.m1.1.1.1.1.2.1.cmml">[</mo><mrow id="alg2.l1.m1.1.1.1.1.1.1" xref="alg2.l1.m1.1.1.1.1.1.1.cmml"><mi id="alg2.l1.m1.1.1.1.1.1.1.2" xref="alg2.l1.m1.1.1.1.1.1.1.2.cmml">m</mi><mo id="alg2.l1.m1.1.1.1.1.1.1.1" lspace="0.222em" rspace="0.222em" xref="alg2.l1.m1.1.1.1.1.1.1.1.cmml">×</mo><mi id="alg2.l1.m1.1.1.1.1.1.1.3" xref="alg2.l1.m1.1.1.1.1.1.1.3.cmml">n</mi></mrow><mo id="alg2.l1.m1.1.1.1.1.1.3" stretchy="false" xref="alg2.l1.m1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l1.m1.1b"><apply id="alg2.l1.m1.1.1.cmml" xref="alg2.l1.m1.1.1"><eq id="alg2.l1.m1.1.1.2.cmml" xref="alg2.l1.m1.1.1.2"></eq><ci id="alg2.l1.m1.1.1.3.cmml" xref="alg2.l1.m1.1.1.3">𝑷</ci><apply id="alg2.l1.m1.1.1.1.cmml" xref="alg2.l1.m1.1.1.1"><times id="alg2.l1.m1.1.1.1.2.cmml" xref="alg2.l1.m1.1.1.1.2"></times><ci id="alg2.l1.m1.1.1.1.3.cmml" xref="alg2.l1.m1.1.1.1.3">Array</ci><apply id="alg2.l1.m1.1.1.1.1.2.cmml" xref="alg2.l1.m1.1.1.1.1.1"><csymbol cd="latexml" id="alg2.l1.m1.1.1.1.1.2.1.cmml" xref="alg2.l1.m1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="alg2.l1.m1.1.1.1.1.1.1.cmml" xref="alg2.l1.m1.1.1.1.1.1.1"><times id="alg2.l1.m1.1.1.1.1.1.1.1.cmml" xref="alg2.l1.m1.1.1.1.1.1.1.1"></times><ci id="alg2.l1.m1.1.1.1.1.1.1.2.cmml" xref="alg2.l1.m1.1.1.1.1.1.1.2">𝑚</ci><ci id="alg2.l1.m1.1.1.1.1.1.1.3.cmml" xref="alg2.l1.m1.1.1.1.1.1.1.3">𝑛</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.m1.1c">{\bm{P}}=\mathrm{Array}[m\times n]</annotation><annotation encoding="application/x-llamapun" id="alg2.l1.m1.1d">bold_italic_P = roman_Array [ italic_m × italic_n ]</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg2.l2">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l2.1.1.1" style="font-size:80%;">2:</span></span>  <span class="ltx_text ltx_font_bold" id="alg2.l2.2">for</span> height <math alttext="h" class="ltx_Math" display="inline" id="alg2.l2.m1.1"><semantics id="alg2.l2.m1.1a"><mi id="alg2.l2.m1.1.1" xref="alg2.l2.m1.1.1.cmml">h</mi><annotation-xml encoding="MathML-Content" id="alg2.l2.m1.1b"><ci id="alg2.l2.m1.1.1.cmml" xref="alg2.l2.m1.1.1">ℎ</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l2.m1.1c">h</annotation><annotation encoding="application/x-llamapun" id="alg2.l2.m1.1d">italic_h</annotation></semantics></math> from <math alttext="0" class="ltx_Math" display="inline" id="alg2.l2.m2.1"><semantics id="alg2.l2.m2.1a"><mn id="alg2.l2.m2.1.1" xref="alg2.l2.m2.1.1.cmml">0</mn><annotation-xml encoding="MathML-Content" id="alg2.l2.m2.1b"><cn id="alg2.l2.m2.1.1.cmml" type="integer" xref="alg2.l2.m2.1.1">0</cn></annotation-xml></semantics></math> to <math alttext="\text{height}({\mathcal{T}})" class="ltx_Math" display="inline" id="alg2.l2.m3.1"><semantics id="alg2.l2.m3.1a"><mrow id="alg2.l2.m3.1.2" xref="alg2.l2.m3.1.2.cmml"><mtext id="alg2.l2.m3.1.2.2" xref="alg2.l2.m3.1.2.2a.cmml">height</mtext><mo id="alg2.l2.m3.1.2.1" xref="alg2.l2.m3.1.2.1.cmml">⁢</mo><mrow id="alg2.l2.m3.1.2.3.2" xref="alg2.l2.m3.1.2.cmml"><mo id="alg2.l2.m3.1.2.3.2.1" stretchy="false" xref="alg2.l2.m3.1.2.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="alg2.l2.m3.1.1" xref="alg2.l2.m3.1.1.cmml">𝒯</mi><mo id="alg2.l2.m3.1.2.3.2.2" stretchy="false" xref="alg2.l2.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l2.m3.1b"><apply id="alg2.l2.m3.1.2.cmml" xref="alg2.l2.m3.1.2"><times id="alg2.l2.m3.1.2.1.cmml" xref="alg2.l2.m3.1.2.1"></times><ci id="alg2.l2.m3.1.2.2a.cmml" xref="alg2.l2.m3.1.2.2"><mtext id="alg2.l2.m3.1.2.2.cmml" xref="alg2.l2.m3.1.2.2">height</mtext></ci><ci id="alg2.l2.m3.1.1.cmml" xref="alg2.l2.m3.1.1">𝒯</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l2.m3.1c">\text{height}({\mathcal{T}})</annotation><annotation encoding="application/x-llamapun" id="alg2.l2.m3.1d">height ( caligraphic_T )</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="alg2.l2.3">do</span>
</div>
<div class="ltx_listingline" id="alg2.l3">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l3.1.1.1" style="font-size:80%;">3:</span></span>     <span class="ltx_text ltx_font_bold" id="alg2.l3.2">for</span> each node <math alttext="v" class="ltx_Math" display="inline" id="alg2.l3.m1.1"><semantics id="alg2.l3.m1.1a"><mi id="alg2.l3.m1.1.1" xref="alg2.l3.m1.1.1.cmml">v</mi><annotation-xml encoding="MathML-Content" id="alg2.l3.m1.1b"><ci id="alg2.l3.m1.1.1.cmml" xref="alg2.l3.m1.1.1">𝑣</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l3.m1.1c">v</annotation><annotation encoding="application/x-llamapun" id="alg2.l3.m1.1d">italic_v</annotation></semantics></math> at height <math alttext="h" class="ltx_Math" display="inline" id="alg2.l3.m2.1"><semantics id="alg2.l3.m2.1a"><mi id="alg2.l3.m2.1.1" xref="alg2.l3.m2.1.1.cmml">h</mi><annotation-xml encoding="MathML-Content" id="alg2.l3.m2.1b"><ci id="alg2.l3.m2.1.1.cmml" xref="alg2.l3.m2.1.1">ℎ</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l3.m2.1c">h</annotation><annotation encoding="application/x-llamapun" id="alg2.l3.m2.1d">italic_h</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="alg2.l3.3">do</span>
</div>
<div class="ltx_listingline" id="alg2.l4">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l4.1.1.1" style="font-size:80%;">4:</span></span>        <span class="ltx_text ltx_font_bold" id="alg2.l4.2">if</span> <math alttext="v" class="ltx_Math" display="inline" id="alg2.l4.m1.1"><semantics id="alg2.l4.m1.1a"><mi id="alg2.l4.m1.1.1" xref="alg2.l4.m1.1.1.cmml">v</mi><annotation-xml encoding="MathML-Content" id="alg2.l4.m1.1b"><ci id="alg2.l4.m1.1.1.cmml" xref="alg2.l4.m1.1.1">𝑣</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l4.m1.1c">v</annotation><annotation encoding="application/x-llamapun" id="alg2.l4.m1.1d">italic_v</annotation></semantics></math> is a leaf <span class="ltx_text ltx_font_bold" id="alg2.l4.3">then</span>
</div>
<div class="ltx_listingline" id="alg2.l5">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l5.1.1.1" style="font-size:80%;">5:</span></span>           Pass its flow to its parent

</div>
<div class="ltx_listingline" id="alg2.l6">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l6.1.1.1" style="font-size:80%;">6:</span></span>        <span class="ltx_text ltx_font_bold" id="alg2.l6.2">else</span>
</div>
<div class="ltx_listingline" id="alg2.l7">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l7.1.1.1" style="font-size:80%;">7:</span></span>           <math alttext="C_{a}(v)=\{z:a(z)&gt;0\},C_{b}(v)=\{z:b(z)&gt;0\}" class="ltx_Math" display="inline" id="alg2.l7.m1.8"><semantics id="alg2.l7.m1.8a"><mrow id="alg2.l7.m1.8.8.2" xref="alg2.l7.m1.8.8.3.cmml"><mrow id="alg2.l7.m1.7.7.1.1" xref="alg2.l7.m1.7.7.1.1.cmml"><mrow id="alg2.l7.m1.7.7.1.1.3" xref="alg2.l7.m1.7.7.1.1.3.cmml"><msub id="alg2.l7.m1.7.7.1.1.3.2" xref="alg2.l7.m1.7.7.1.1.3.2.cmml"><mi id="alg2.l7.m1.7.7.1.1.3.2.2" xref="alg2.l7.m1.7.7.1.1.3.2.2.cmml">C</mi><mi id="alg2.l7.m1.7.7.1.1.3.2.3" xref="alg2.l7.m1.7.7.1.1.3.2.3.cmml">a</mi></msub><mo id="alg2.l7.m1.7.7.1.1.3.1" xref="alg2.l7.m1.7.7.1.1.3.1.cmml">⁢</mo><mrow id="alg2.l7.m1.7.7.1.1.3.3.2" xref="alg2.l7.m1.7.7.1.1.3.cmml"><mo id="alg2.l7.m1.7.7.1.1.3.3.2.1" stretchy="false" xref="alg2.l7.m1.7.7.1.1.3.cmml">(</mo><mi id="alg2.l7.m1.1.1" xref="alg2.l7.m1.1.1.cmml">v</mi><mo id="alg2.l7.m1.7.7.1.1.3.3.2.2" stretchy="false" xref="alg2.l7.m1.7.7.1.1.3.cmml">)</mo></mrow></mrow><mo id="alg2.l7.m1.7.7.1.1.2" xref="alg2.l7.m1.7.7.1.1.2.cmml">=</mo><mrow id="alg2.l7.m1.7.7.1.1.1.1" xref="alg2.l7.m1.7.7.1.1.1.2.cmml"><mo id="alg2.l7.m1.7.7.1.1.1.1.2" stretchy="false" xref="alg2.l7.m1.7.7.1.1.1.2.1.cmml">{</mo><mi id="alg2.l7.m1.3.3" xref="alg2.l7.m1.3.3.cmml">z</mi><mo id="alg2.l7.m1.7.7.1.1.1.1.3" lspace="0.278em" rspace="0.278em" xref="alg2.l7.m1.7.7.1.1.1.2.1.cmml">:</mo><mrow id="alg2.l7.m1.7.7.1.1.1.1.1" xref="alg2.l7.m1.7.7.1.1.1.1.1.cmml"><mrow id="alg2.l7.m1.7.7.1.1.1.1.1.2" xref="alg2.l7.m1.7.7.1.1.1.1.1.2.cmml"><mi id="alg2.l7.m1.7.7.1.1.1.1.1.2.2" xref="alg2.l7.m1.7.7.1.1.1.1.1.2.2.cmml">a</mi><mo id="alg2.l7.m1.7.7.1.1.1.1.1.2.1" xref="alg2.l7.m1.7.7.1.1.1.1.1.2.1.cmml">⁢</mo><mrow id="alg2.l7.m1.7.7.1.1.1.1.1.2.3.2" xref="alg2.l7.m1.7.7.1.1.1.1.1.2.cmml"><mo id="alg2.l7.m1.7.7.1.1.1.1.1.2.3.2.1" stretchy="false" xref="alg2.l7.m1.7.7.1.1.1.1.1.2.cmml">(</mo><mi id="alg2.l7.m1.2.2" xref="alg2.l7.m1.2.2.cmml">z</mi><mo id="alg2.l7.m1.7.7.1.1.1.1.1.2.3.2.2" stretchy="false" xref="alg2.l7.m1.7.7.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="alg2.l7.m1.7.7.1.1.1.1.1.1" xref="alg2.l7.m1.7.7.1.1.1.1.1.1.cmml">&gt;</mo><mn id="alg2.l7.m1.7.7.1.1.1.1.1.3" xref="alg2.l7.m1.7.7.1.1.1.1.1.3.cmml">0</mn></mrow><mo id="alg2.l7.m1.7.7.1.1.1.1.4" stretchy="false" xref="alg2.l7.m1.7.7.1.1.1.2.1.cmml">}</mo></mrow></mrow><mo id="alg2.l7.m1.8.8.2.3" xref="alg2.l7.m1.8.8.3a.cmml">,</mo><mrow id="alg2.l7.m1.8.8.2.2" xref="alg2.l7.m1.8.8.2.2.cmml"><mrow id="alg2.l7.m1.8.8.2.2.3" xref="alg2.l7.m1.8.8.2.2.3.cmml"><msub id="alg2.l7.m1.8.8.2.2.3.2" xref="alg2.l7.m1.8.8.2.2.3.2.cmml"><mi id="alg2.l7.m1.8.8.2.2.3.2.2" xref="alg2.l7.m1.8.8.2.2.3.2.2.cmml">C</mi><mi id="alg2.l7.m1.8.8.2.2.3.2.3" xref="alg2.l7.m1.8.8.2.2.3.2.3.cmml">b</mi></msub><mo id="alg2.l7.m1.8.8.2.2.3.1" xref="alg2.l7.m1.8.8.2.2.3.1.cmml">⁢</mo><mrow id="alg2.l7.m1.8.8.2.2.3.3.2" xref="alg2.l7.m1.8.8.2.2.3.cmml"><mo id="alg2.l7.m1.8.8.2.2.3.3.2.1" stretchy="false" xref="alg2.l7.m1.8.8.2.2.3.cmml">(</mo><mi id="alg2.l7.m1.4.4" xref="alg2.l7.m1.4.4.cmml">v</mi><mo id="alg2.l7.m1.8.8.2.2.3.3.2.2" stretchy="false" xref="alg2.l7.m1.8.8.2.2.3.cmml">)</mo></mrow></mrow><mo id="alg2.l7.m1.8.8.2.2.2" xref="alg2.l7.m1.8.8.2.2.2.cmml">=</mo><mrow id="alg2.l7.m1.8.8.2.2.1.1" xref="alg2.l7.m1.8.8.2.2.1.2.cmml"><mo id="alg2.l7.m1.8.8.2.2.1.1.2" stretchy="false" xref="alg2.l7.m1.8.8.2.2.1.2.1.cmml">{</mo><mi id="alg2.l7.m1.6.6" xref="alg2.l7.m1.6.6.cmml">z</mi><mo id="alg2.l7.m1.8.8.2.2.1.1.3" lspace="0.278em" rspace="0.278em" xref="alg2.l7.m1.8.8.2.2.1.2.1.cmml">:</mo><mrow id="alg2.l7.m1.8.8.2.2.1.1.1" xref="alg2.l7.m1.8.8.2.2.1.1.1.cmml"><mrow id="alg2.l7.m1.8.8.2.2.1.1.1.2" xref="alg2.l7.m1.8.8.2.2.1.1.1.2.cmml"><mi id="alg2.l7.m1.8.8.2.2.1.1.1.2.2" xref="alg2.l7.m1.8.8.2.2.1.1.1.2.2.cmml">b</mi><mo id="alg2.l7.m1.8.8.2.2.1.1.1.2.1" xref="alg2.l7.m1.8.8.2.2.1.1.1.2.1.cmml">⁢</mo><mrow id="alg2.l7.m1.8.8.2.2.1.1.1.2.3.2" xref="alg2.l7.m1.8.8.2.2.1.1.1.2.cmml"><mo id="alg2.l7.m1.8.8.2.2.1.1.1.2.3.2.1" stretchy="false" xref="alg2.l7.m1.8.8.2.2.1.1.1.2.cmml">(</mo><mi id="alg2.l7.m1.5.5" xref="alg2.l7.m1.5.5.cmml">z</mi><mo id="alg2.l7.m1.8.8.2.2.1.1.1.2.3.2.2" stretchy="false" xref="alg2.l7.m1.8.8.2.2.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="alg2.l7.m1.8.8.2.2.1.1.1.1" xref="alg2.l7.m1.8.8.2.2.1.1.1.1.cmml">&gt;</mo><mn id="alg2.l7.m1.8.8.2.2.1.1.1.3" xref="alg2.l7.m1.8.8.2.2.1.1.1.3.cmml">0</mn></mrow><mo id="alg2.l7.m1.8.8.2.2.1.1.4" stretchy="false" xref="alg2.l7.m1.8.8.2.2.1.2.1.cmml">}</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l7.m1.8b"><apply id="alg2.l7.m1.8.8.3.cmml" xref="alg2.l7.m1.8.8.2"><csymbol cd="ambiguous" id="alg2.l7.m1.8.8.3a.cmml" xref="alg2.l7.m1.8.8.2.3">formulae-sequence</csymbol><apply id="alg2.l7.m1.7.7.1.1.cmml" xref="alg2.l7.m1.7.7.1.1"><eq id="alg2.l7.m1.7.7.1.1.2.cmml" xref="alg2.l7.m1.7.7.1.1.2"></eq><apply id="alg2.l7.m1.7.7.1.1.3.cmml" xref="alg2.l7.m1.7.7.1.1.3"><times id="alg2.l7.m1.7.7.1.1.3.1.cmml" xref="alg2.l7.m1.7.7.1.1.3.1"></times><apply id="alg2.l7.m1.7.7.1.1.3.2.cmml" xref="alg2.l7.m1.7.7.1.1.3.2"><csymbol cd="ambiguous" id="alg2.l7.m1.7.7.1.1.3.2.1.cmml" xref="alg2.l7.m1.7.7.1.1.3.2">subscript</csymbol><ci id="alg2.l7.m1.7.7.1.1.3.2.2.cmml" xref="alg2.l7.m1.7.7.1.1.3.2.2">𝐶</ci><ci id="alg2.l7.m1.7.7.1.1.3.2.3.cmml" xref="alg2.l7.m1.7.7.1.1.3.2.3">𝑎</ci></apply><ci id="alg2.l7.m1.1.1.cmml" xref="alg2.l7.m1.1.1">𝑣</ci></apply><apply id="alg2.l7.m1.7.7.1.1.1.2.cmml" xref="alg2.l7.m1.7.7.1.1.1.1"><csymbol cd="latexml" id="alg2.l7.m1.7.7.1.1.1.2.1.cmml" xref="alg2.l7.m1.7.7.1.1.1.1.2">conditional-set</csymbol><ci id="alg2.l7.m1.3.3.cmml" xref="alg2.l7.m1.3.3">𝑧</ci><apply id="alg2.l7.m1.7.7.1.1.1.1.1.cmml" xref="alg2.l7.m1.7.7.1.1.1.1.1"><gt id="alg2.l7.m1.7.7.1.1.1.1.1.1.cmml" xref="alg2.l7.m1.7.7.1.1.1.1.1.1"></gt><apply id="alg2.l7.m1.7.7.1.1.1.1.1.2.cmml" xref="alg2.l7.m1.7.7.1.1.1.1.1.2"><times id="alg2.l7.m1.7.7.1.1.1.1.1.2.1.cmml" xref="alg2.l7.m1.7.7.1.1.1.1.1.2.1"></times><ci id="alg2.l7.m1.7.7.1.1.1.1.1.2.2.cmml" xref="alg2.l7.m1.7.7.1.1.1.1.1.2.2">𝑎</ci><ci id="alg2.l7.m1.2.2.cmml" xref="alg2.l7.m1.2.2">𝑧</ci></apply><cn id="alg2.l7.m1.7.7.1.1.1.1.1.3.cmml" type="integer" xref="alg2.l7.m1.7.7.1.1.1.1.1.3">0</cn></apply></apply></apply><apply id="alg2.l7.m1.8.8.2.2.cmml" xref="alg2.l7.m1.8.8.2.2"><eq id="alg2.l7.m1.8.8.2.2.2.cmml" xref="alg2.l7.m1.8.8.2.2.2"></eq><apply id="alg2.l7.m1.8.8.2.2.3.cmml" xref="alg2.l7.m1.8.8.2.2.3"><times id="alg2.l7.m1.8.8.2.2.3.1.cmml" xref="alg2.l7.m1.8.8.2.2.3.1"></times><apply id="alg2.l7.m1.8.8.2.2.3.2.cmml" xref="alg2.l7.m1.8.8.2.2.3.2"><csymbol cd="ambiguous" id="alg2.l7.m1.8.8.2.2.3.2.1.cmml" xref="alg2.l7.m1.8.8.2.2.3.2">subscript</csymbol><ci id="alg2.l7.m1.8.8.2.2.3.2.2.cmml" xref="alg2.l7.m1.8.8.2.2.3.2.2">𝐶</ci><ci id="alg2.l7.m1.8.8.2.2.3.2.3.cmml" xref="alg2.l7.m1.8.8.2.2.3.2.3">𝑏</ci></apply><ci id="alg2.l7.m1.4.4.cmml" xref="alg2.l7.m1.4.4">𝑣</ci></apply><apply id="alg2.l7.m1.8.8.2.2.1.2.cmml" xref="alg2.l7.m1.8.8.2.2.1.1"><csymbol cd="latexml" id="alg2.l7.m1.8.8.2.2.1.2.1.cmml" xref="alg2.l7.m1.8.8.2.2.1.1.2">conditional-set</csymbol><ci id="alg2.l7.m1.6.6.cmml" xref="alg2.l7.m1.6.6">𝑧</ci><apply id="alg2.l7.m1.8.8.2.2.1.1.1.cmml" xref="alg2.l7.m1.8.8.2.2.1.1.1"><gt id="alg2.l7.m1.8.8.2.2.1.1.1.1.cmml" xref="alg2.l7.m1.8.8.2.2.1.1.1.1"></gt><apply id="alg2.l7.m1.8.8.2.2.1.1.1.2.cmml" xref="alg2.l7.m1.8.8.2.2.1.1.1.2"><times id="alg2.l7.m1.8.8.2.2.1.1.1.2.1.cmml" xref="alg2.l7.m1.8.8.2.2.1.1.1.2.1"></times><ci id="alg2.l7.m1.8.8.2.2.1.1.1.2.2.cmml" xref="alg2.l7.m1.8.8.2.2.1.1.1.2.2">𝑏</ci><ci id="alg2.l7.m1.5.5.cmml" xref="alg2.l7.m1.5.5">𝑧</ci></apply><cn id="alg2.l7.m1.8.8.2.2.1.1.1.3.cmml" type="integer" xref="alg2.l7.m1.8.8.2.2.1.1.1.3">0</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l7.m1.8c">C_{a}(v)=\{z:a(z)&gt;0\},C_{b}(v)=\{z:b(z)&gt;0\}</annotation><annotation encoding="application/x-llamapun" id="alg2.l7.m1.8d">italic_C start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT ( italic_v ) = { italic_z : italic_a ( italic_z ) &gt; 0 } , italic_C start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT ( italic_v ) = { italic_z : italic_b ( italic_z ) &gt; 0 }</annotation></semantics></math>, <math alttext="z" class="ltx_Math" display="inline" id="alg2.l7.m2.1"><semantics id="alg2.l7.m2.1a"><mi id="alg2.l7.m2.1.1" xref="alg2.l7.m2.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="alg2.l7.m2.1b"><ci id="alg2.l7.m2.1.1.cmml" xref="alg2.l7.m2.1.1">𝑧</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l7.m2.1c">z</annotation><annotation encoding="application/x-llamapun" id="alg2.l7.m2.1d">italic_z</annotation></semantics></math> is the leaf children of <math alttext="v" class="ltx_Math" display="inline" id="alg2.l7.m3.1"><semantics id="alg2.l7.m3.1a"><mi id="alg2.l7.m3.1.1" xref="alg2.l7.m3.1.1.cmml">v</mi><annotation-xml encoding="MathML-Content" id="alg2.l7.m3.1b"><ci id="alg2.l7.m3.1.1.cmml" xref="alg2.l7.m3.1.1">𝑣</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l7.m3.1c">v</annotation><annotation encoding="application/x-llamapun" id="alg2.l7.m3.1d">italic_v</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg2.l8">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l8.2.1.1" style="font-size:80%;">8:</span></span>           <span class="ltx_text ltx_font_bold" id="alg2.l8.3">while</span> <math alttext="\exists z_{a}\in C_{a}(v)" class="ltx_Math" display="inline" id="alg2.l8.m1.1"><semantics id="alg2.l8.m1.1a"><mrow id="alg2.l8.m1.1.2" xref="alg2.l8.m1.1.2.cmml"><mrow id="alg2.l8.m1.1.2.2" xref="alg2.l8.m1.1.2.2.cmml"><mo id="alg2.l8.m1.1.2.2.1" mathcolor="#2E8BC0" rspace="0.167em" xref="alg2.l8.m1.1.2.2.1.cmml">∃</mo><msub id="alg2.l8.m1.1.2.2.2" xref="alg2.l8.m1.1.2.2.2.cmml"><mi id="alg2.l8.m1.1.2.2.2.2" mathcolor="#2E8BC0" xref="alg2.l8.m1.1.2.2.2.2.cmml">z</mi><mi id="alg2.l8.m1.1.2.2.2.3" mathcolor="#2E8BC0" xref="alg2.l8.m1.1.2.2.2.3.cmml">a</mi></msub></mrow><mo id="alg2.l8.m1.1.2.1" mathcolor="#2E8BC0" xref="alg2.l8.m1.1.2.1.cmml">∈</mo><mrow id="alg2.l8.m1.1.2.3" xref="alg2.l8.m1.1.2.3.cmml"><msub id="alg2.l8.m1.1.2.3.2" xref="alg2.l8.m1.1.2.3.2.cmml"><mi id="alg2.l8.m1.1.2.3.2.2" mathcolor="#2E8BC0" xref="alg2.l8.m1.1.2.3.2.2.cmml">C</mi><mi id="alg2.l8.m1.1.2.3.2.3" mathcolor="#2E8BC0" xref="alg2.l8.m1.1.2.3.2.3.cmml">a</mi></msub><mo id="alg2.l8.m1.1.2.3.1" xref="alg2.l8.m1.1.2.3.1.cmml">⁢</mo><mrow id="alg2.l8.m1.1.2.3.3.2" xref="alg2.l8.m1.1.2.3.cmml"><mo id="alg2.l8.m1.1.2.3.3.2.1" mathcolor="#2E8BC0" stretchy="false" xref="alg2.l8.m1.1.2.3.cmml">(</mo><mi id="alg2.l8.m1.1.1" mathcolor="#2E8BC0" xref="alg2.l8.m1.1.1.cmml">v</mi><mo id="alg2.l8.m1.1.2.3.3.2.2" mathcolor="#2E8BC0" stretchy="false" xref="alg2.l8.m1.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l8.m1.1b"><apply id="alg2.l8.m1.1.2.cmml" xref="alg2.l8.m1.1.2"><in id="alg2.l8.m1.1.2.1.cmml" xref="alg2.l8.m1.1.2.1"></in><apply id="alg2.l8.m1.1.2.2.cmml" xref="alg2.l8.m1.1.2.2"><exists id="alg2.l8.m1.1.2.2.1.cmml" xref="alg2.l8.m1.1.2.2.1"></exists><apply id="alg2.l8.m1.1.2.2.2.cmml" xref="alg2.l8.m1.1.2.2.2"><csymbol cd="ambiguous" id="alg2.l8.m1.1.2.2.2.1.cmml" xref="alg2.l8.m1.1.2.2.2">subscript</csymbol><ci id="alg2.l8.m1.1.2.2.2.2.cmml" xref="alg2.l8.m1.1.2.2.2.2">𝑧</ci><ci id="alg2.l8.m1.1.2.2.2.3.cmml" xref="alg2.l8.m1.1.2.2.2.3">𝑎</ci></apply></apply><apply id="alg2.l8.m1.1.2.3.cmml" xref="alg2.l8.m1.1.2.3"><times id="alg2.l8.m1.1.2.3.1.cmml" xref="alg2.l8.m1.1.2.3.1"></times><apply id="alg2.l8.m1.1.2.3.2.cmml" xref="alg2.l8.m1.1.2.3.2"><csymbol cd="ambiguous" id="alg2.l8.m1.1.2.3.2.1.cmml" xref="alg2.l8.m1.1.2.3.2">subscript</csymbol><ci id="alg2.l8.m1.1.2.3.2.2.cmml" xref="alg2.l8.m1.1.2.3.2.2">𝐶</ci><ci id="alg2.l8.m1.1.2.3.2.3.cmml" xref="alg2.l8.m1.1.2.3.2.3">𝑎</ci></apply><ci id="alg2.l8.m1.1.1.cmml" xref="alg2.l8.m1.1.1">𝑣</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l8.m1.1c">\exists z_{a}\in C_{a}(v)</annotation><annotation encoding="application/x-llamapun" id="alg2.l8.m1.1d">∃ italic_z start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT ∈ italic_C start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT ( italic_v )</annotation></semantics></math><span class="ltx_text" id="alg2.l8.1" style="color:#2E8BC0;"> <span class="ltx_text ltx_font_bold" id="alg2.l8.1.1">and</span> <math alttext="z_{b}\in C_{b}(v)" class="ltx_Math" display="inline" id="alg2.l8.1.m1.1"><semantics id="alg2.l8.1.m1.1a"><mrow id="alg2.l8.1.m1.1.2" xref="alg2.l8.1.m1.1.2.cmml"><msub id="alg2.l8.1.m1.1.2.2" xref="alg2.l8.1.m1.1.2.2.cmml"><mi id="alg2.l8.1.m1.1.2.2.2" mathcolor="#2E8BC0" xref="alg2.l8.1.m1.1.2.2.2.cmml">z</mi><mi id="alg2.l8.1.m1.1.2.2.3" mathcolor="#2E8BC0" xref="alg2.l8.1.m1.1.2.2.3.cmml">b</mi></msub><mo id="alg2.l8.1.m1.1.2.1" mathcolor="#2E8BC0" xref="alg2.l8.1.m1.1.2.1.cmml">∈</mo><mrow id="alg2.l8.1.m1.1.2.3" xref="alg2.l8.1.m1.1.2.3.cmml"><msub id="alg2.l8.1.m1.1.2.3.2" xref="alg2.l8.1.m1.1.2.3.2.cmml"><mi id="alg2.l8.1.m1.1.2.3.2.2" mathcolor="#2E8BC0" xref="alg2.l8.1.m1.1.2.3.2.2.cmml">C</mi><mi id="alg2.l8.1.m1.1.2.3.2.3" mathcolor="#2E8BC0" xref="alg2.l8.1.m1.1.2.3.2.3.cmml">b</mi></msub><mo id="alg2.l8.1.m1.1.2.3.1" xref="alg2.l8.1.m1.1.2.3.1.cmml">⁢</mo><mrow id="alg2.l8.1.m1.1.2.3.3.2" xref="alg2.l8.1.m1.1.2.3.cmml"><mo id="alg2.l8.1.m1.1.2.3.3.2.1" mathcolor="#2E8BC0" stretchy="false" xref="alg2.l8.1.m1.1.2.3.cmml">(</mo><mi id="alg2.l8.1.m1.1.1" mathcolor="#2E8BC0" xref="alg2.l8.1.m1.1.1.cmml">v</mi><mo id="alg2.l8.1.m1.1.2.3.3.2.2" mathcolor="#2E8BC0" stretchy="false" xref="alg2.l8.1.m1.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l8.1.m1.1b"><apply id="alg2.l8.1.m1.1.2.cmml" xref="alg2.l8.1.m1.1.2"><in id="alg2.l8.1.m1.1.2.1.cmml" xref="alg2.l8.1.m1.1.2.1"></in><apply id="alg2.l8.1.m1.1.2.2.cmml" xref="alg2.l8.1.m1.1.2.2"><csymbol cd="ambiguous" id="alg2.l8.1.m1.1.2.2.1.cmml" xref="alg2.l8.1.m1.1.2.2">subscript</csymbol><ci id="alg2.l8.1.m1.1.2.2.2.cmml" xref="alg2.l8.1.m1.1.2.2.2">𝑧</ci><ci id="alg2.l8.1.m1.1.2.2.3.cmml" xref="alg2.l8.1.m1.1.2.2.3">𝑏</ci></apply><apply id="alg2.l8.1.m1.1.2.3.cmml" xref="alg2.l8.1.m1.1.2.3"><times id="alg2.l8.1.m1.1.2.3.1.cmml" xref="alg2.l8.1.m1.1.2.3.1"></times><apply id="alg2.l8.1.m1.1.2.3.2.cmml" xref="alg2.l8.1.m1.1.2.3.2"><csymbol cd="ambiguous" id="alg2.l8.1.m1.1.2.3.2.1.cmml" xref="alg2.l8.1.m1.1.2.3.2">subscript</csymbol><ci id="alg2.l8.1.m1.1.2.3.2.2.cmml" xref="alg2.l8.1.m1.1.2.3.2.2">𝐶</ci><ci id="alg2.l8.1.m1.1.2.3.2.3.cmml" xref="alg2.l8.1.m1.1.2.3.2.3">𝑏</ci></apply><ci id="alg2.l8.1.m1.1.1.cmml" xref="alg2.l8.1.m1.1.1">𝑣</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l8.1.m1.1c">z_{b}\in C_{b}(v)</annotation><annotation encoding="application/x-llamapun" id="alg2.l8.1.m1.1d">italic_z start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT ∈ italic_C start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT ( italic_v )</annotation></semantics></math></span> <span class="ltx_text ltx_font_bold" id="alg2.l8.4">do</span>
</div>
<div class="ltx_listingline" id="alg2.l9">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l9.1.1.1" style="font-size:80%;">9:</span></span>              <math alttext="\eta=\min(a(z_{a}),b(z_{b}))" class="ltx_Math" display="inline" id="alg2.l9.m1.3"><semantics id="alg2.l9.m1.3a"><mrow id="alg2.l9.m1.3.3" xref="alg2.l9.m1.3.3.cmml"><mi id="alg2.l9.m1.3.3.4" mathcolor="#2E8BC0" xref="alg2.l9.m1.3.3.4.cmml">η</mi><mo id="alg2.l9.m1.3.3.3" mathcolor="#2E8BC0" xref="alg2.l9.m1.3.3.3.cmml">=</mo><mrow id="alg2.l9.m1.3.3.2.2" xref="alg2.l9.m1.3.3.2.3.cmml"><mi id="alg2.l9.m1.1.1" mathcolor="#2E8BC0" xref="alg2.l9.m1.1.1.cmml">min</mi><mo id="alg2.l9.m1.3.3.2.2a" xref="alg2.l9.m1.3.3.2.3.cmml">⁡</mo><mrow id="alg2.l9.m1.3.3.2.2.2" xref="alg2.l9.m1.3.3.2.3.cmml"><mo id="alg2.l9.m1.3.3.2.2.2.3" mathcolor="#2E8BC0" stretchy="false" xref="alg2.l9.m1.3.3.2.3.cmml">(</mo><mrow id="alg2.l9.m1.2.2.1.1.1.1" xref="alg2.l9.m1.2.2.1.1.1.1.cmml"><mi id="alg2.l9.m1.2.2.1.1.1.1.3" mathcolor="#2E8BC0" xref="alg2.l9.m1.2.2.1.1.1.1.3.cmml">a</mi><mo id="alg2.l9.m1.2.2.1.1.1.1.2" xref="alg2.l9.m1.2.2.1.1.1.1.2.cmml">⁢</mo><mrow id="alg2.l9.m1.2.2.1.1.1.1.1.1" xref="alg2.l9.m1.2.2.1.1.1.1.1.1.1.cmml"><mo id="alg2.l9.m1.2.2.1.1.1.1.1.1.2" mathcolor="#2E8BC0" stretchy="false" xref="alg2.l9.m1.2.2.1.1.1.1.1.1.1.cmml">(</mo><msub id="alg2.l9.m1.2.2.1.1.1.1.1.1.1" xref="alg2.l9.m1.2.2.1.1.1.1.1.1.1.cmml"><mi id="alg2.l9.m1.2.2.1.1.1.1.1.1.1.2" mathcolor="#2E8BC0" xref="alg2.l9.m1.2.2.1.1.1.1.1.1.1.2.cmml">z</mi><mi id="alg2.l9.m1.2.2.1.1.1.1.1.1.1.3" mathcolor="#2E8BC0" xref="alg2.l9.m1.2.2.1.1.1.1.1.1.1.3.cmml">a</mi></msub><mo id="alg2.l9.m1.2.2.1.1.1.1.1.1.3" mathcolor="#2E8BC0" stretchy="false" xref="alg2.l9.m1.2.2.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="alg2.l9.m1.3.3.2.2.2.4" mathcolor="#2E8BC0" xref="alg2.l9.m1.3.3.2.3.cmml">,</mo><mrow id="alg2.l9.m1.3.3.2.2.2.2" xref="alg2.l9.m1.3.3.2.2.2.2.cmml"><mi id="alg2.l9.m1.3.3.2.2.2.2.3" mathcolor="#2E8BC0" xref="alg2.l9.m1.3.3.2.2.2.2.3.cmml">b</mi><mo id="alg2.l9.m1.3.3.2.2.2.2.2" xref="alg2.l9.m1.3.3.2.2.2.2.2.cmml">⁢</mo><mrow id="alg2.l9.m1.3.3.2.2.2.2.1.1" xref="alg2.l9.m1.3.3.2.2.2.2.1.1.1.cmml"><mo id="alg2.l9.m1.3.3.2.2.2.2.1.1.2" mathcolor="#2E8BC0" stretchy="false" xref="alg2.l9.m1.3.3.2.2.2.2.1.1.1.cmml">(</mo><msub id="alg2.l9.m1.3.3.2.2.2.2.1.1.1" xref="alg2.l9.m1.3.3.2.2.2.2.1.1.1.cmml"><mi id="alg2.l9.m1.3.3.2.2.2.2.1.1.1.2" mathcolor="#2E8BC0" xref="alg2.l9.m1.3.3.2.2.2.2.1.1.1.2.cmml">z</mi><mi id="alg2.l9.m1.3.3.2.2.2.2.1.1.1.3" mathcolor="#2E8BC0" xref="alg2.l9.m1.3.3.2.2.2.2.1.1.1.3.cmml">b</mi></msub><mo id="alg2.l9.m1.3.3.2.2.2.2.1.1.3" mathcolor="#2E8BC0" stretchy="false" xref="alg2.l9.m1.3.3.2.2.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="alg2.l9.m1.3.3.2.2.2.5" mathcolor="#2E8BC0" stretchy="false" xref="alg2.l9.m1.3.3.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l9.m1.3b"><apply id="alg2.l9.m1.3.3.cmml" xref="alg2.l9.m1.3.3"><eq id="alg2.l9.m1.3.3.3.cmml" xref="alg2.l9.m1.3.3.3"></eq><ci id="alg2.l9.m1.3.3.4.cmml" xref="alg2.l9.m1.3.3.4">𝜂</ci><apply id="alg2.l9.m1.3.3.2.3.cmml" xref="alg2.l9.m1.3.3.2.2"><min id="alg2.l9.m1.1.1.cmml" xref="alg2.l9.m1.1.1"></min><apply id="alg2.l9.m1.2.2.1.1.1.1.cmml" xref="alg2.l9.m1.2.2.1.1.1.1"><times id="alg2.l9.m1.2.2.1.1.1.1.2.cmml" xref="alg2.l9.m1.2.2.1.1.1.1.2"></times><ci id="alg2.l9.m1.2.2.1.1.1.1.3.cmml" xref="alg2.l9.m1.2.2.1.1.1.1.3">𝑎</ci><apply id="alg2.l9.m1.2.2.1.1.1.1.1.1.1.cmml" xref="alg2.l9.m1.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l9.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="alg2.l9.m1.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="alg2.l9.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="alg2.l9.m1.2.2.1.1.1.1.1.1.1.2">𝑧</ci><ci id="alg2.l9.m1.2.2.1.1.1.1.1.1.1.3.cmml" xref="alg2.l9.m1.2.2.1.1.1.1.1.1.1.3">𝑎</ci></apply></apply><apply id="alg2.l9.m1.3.3.2.2.2.2.cmml" xref="alg2.l9.m1.3.3.2.2.2.2"><times id="alg2.l9.m1.3.3.2.2.2.2.2.cmml" xref="alg2.l9.m1.3.3.2.2.2.2.2"></times><ci id="alg2.l9.m1.3.3.2.2.2.2.3.cmml" xref="alg2.l9.m1.3.3.2.2.2.2.3">𝑏</ci><apply id="alg2.l9.m1.3.3.2.2.2.2.1.1.1.cmml" xref="alg2.l9.m1.3.3.2.2.2.2.1.1"><csymbol cd="ambiguous" id="alg2.l9.m1.3.3.2.2.2.2.1.1.1.1.cmml" xref="alg2.l9.m1.3.3.2.2.2.2.1.1">subscript</csymbol><ci id="alg2.l9.m1.3.3.2.2.2.2.1.1.1.2.cmml" xref="alg2.l9.m1.3.3.2.2.2.2.1.1.1.2">𝑧</ci><ci id="alg2.l9.m1.3.3.2.2.2.2.1.1.1.3.cmml" xref="alg2.l9.m1.3.3.2.2.2.2.1.1.1.3">𝑏</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l9.m1.3c">\eta=\min(a(z_{a}),b(z_{b}))</annotation><annotation encoding="application/x-llamapun" id="alg2.l9.m1.3d">italic_η = roman_min ( italic_a ( italic_z start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT ) , italic_b ( italic_z start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT ) )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg2.l10">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l10.1.1.1" style="font-size:80%;">10:</span></span>              <math alttext="{\bm{P}}(z_{a},z_{b})\mathrel{+}=\eta,a(z_{a})\mathrel{-}=\eta,b(z_{b})%
\mathrel{-}=\eta" class="ltx_math_unparsed" display="inline" id="alg2.l10.m1.1"><semantics id="alg2.l10.m1.1a"><mrow id="alg2.l10.m1.1b"><mi id="alg2.l10.m1.1.1" mathcolor="#2E8BC0">𝑷</mi><mrow id="alg2.l10.m1.1.2"><mo id="alg2.l10.m1.1.2.1" mathcolor="#2E8BC0" stretchy="false">(</mo><msub id="alg2.l10.m1.1.2.2"><mi id="alg2.l10.m1.1.2.2.2" mathcolor="#2E8BC0">z</mi><mi id="alg2.l10.m1.1.2.2.3" mathcolor="#2E8BC0">a</mi></msub><mo id="alg2.l10.m1.1.2.3" mathcolor="#2E8BC0">,</mo><msub id="alg2.l10.m1.1.2.4"><mi id="alg2.l10.m1.1.2.4.2" mathcolor="#2E8BC0">z</mi><mi id="alg2.l10.m1.1.2.4.3" mathcolor="#2E8BC0">b</mi></msub><mo id="alg2.l10.m1.1.2.5" mathcolor="#2E8BC0" rspace="0.056em" stretchy="false">)</mo></mrow><mo id="alg2.l10.m1.1.3" mathcolor="#2E8BC0" rspace="0em">+</mo><mo id="alg2.l10.m1.1.4" lspace="0em" mathcolor="#2E8BC0">=</mo><mi id="alg2.l10.m1.1.5" mathcolor="#2E8BC0">η</mi><mo id="alg2.l10.m1.1.6" mathcolor="#2E8BC0">,</mo><mi id="alg2.l10.m1.1.7" mathcolor="#2E8BC0">a</mi><mrow id="alg2.l10.m1.1.8"><mo id="alg2.l10.m1.1.8.1" mathcolor="#2E8BC0" stretchy="false">(</mo><msub id="alg2.l10.m1.1.8.2"><mi id="alg2.l10.m1.1.8.2.2" mathcolor="#2E8BC0">z</mi><mi id="alg2.l10.m1.1.8.2.3" mathcolor="#2E8BC0">a</mi></msub><mo id="alg2.l10.m1.1.8.3" mathcolor="#2E8BC0" rspace="0.056em" stretchy="false">)</mo></mrow><mo id="alg2.l10.m1.1.9" mathcolor="#2E8BC0" rspace="0em">-</mo><mo id="alg2.l10.m1.1.10" lspace="0em" mathcolor="#2E8BC0">=</mo><mi id="alg2.l10.m1.1.11" mathcolor="#2E8BC0">η</mi><mo id="alg2.l10.m1.1.12" mathcolor="#2E8BC0">,</mo><mi id="alg2.l10.m1.1.13" mathcolor="#2E8BC0">b</mi><mrow id="alg2.l10.m1.1.14"><mo id="alg2.l10.m1.1.14.1" mathcolor="#2E8BC0" stretchy="false">(</mo><msub id="alg2.l10.m1.1.14.2"><mi id="alg2.l10.m1.1.14.2.2" mathcolor="#2E8BC0">z</mi><mi id="alg2.l10.m1.1.14.2.3" mathcolor="#2E8BC0">b</mi></msub><mo id="alg2.l10.m1.1.14.3" mathcolor="#2E8BC0" rspace="0.056em" stretchy="false">)</mo></mrow><mo id="alg2.l10.m1.1.15" mathcolor="#2E8BC0" rspace="0em">-</mo><mo id="alg2.l10.m1.1.16" lspace="0em" mathcolor="#2E8BC0">=</mo><mi id="alg2.l10.m1.1.17" mathcolor="#2E8BC0">η</mi></mrow><annotation encoding="application/x-tex" id="alg2.l10.m1.1c">{\bm{P}}(z_{a},z_{b})\mathrel{+}=\eta,a(z_{a})\mathrel{-}=\eta,b(z_{b})%
\mathrel{-}=\eta</annotation><annotation encoding="application/x-llamapun" id="alg2.l10.m1.1d">bold_italic_P ( italic_z start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT , italic_z start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT ) + = italic_η , italic_a ( italic_z start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT ) - = italic_η , italic_b ( italic_z start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT ) - = italic_η</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg2.l11">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l11.1.1.1" style="font-size:80%;">11:</span></span>           Pass non-zero unmatched flows in either <math alttext="a" class="ltx_Math" display="inline" id="alg2.l11.m1.1"><semantics id="alg2.l11.m1.1a"><mi id="alg2.l11.m1.1.1" xref="alg2.l11.m1.1.1.cmml">a</mi><annotation-xml encoding="MathML-Content" id="alg2.l11.m1.1b"><ci id="alg2.l11.m1.1.1.cmml" xref="alg2.l11.m1.1.1">𝑎</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l11.m1.1c">a</annotation><annotation encoding="application/x-llamapun" id="alg2.l11.m1.1d">italic_a</annotation></semantics></math> or <math alttext="b" class="ltx_Math" display="inline" id="alg2.l11.m2.1"><semantics id="alg2.l11.m2.1a"><mi id="alg2.l11.m2.1.1" xref="alg2.l11.m2.1.1.cmml">b</mi><annotation-xml encoding="MathML-Content" id="alg2.l11.m2.1b"><ci id="alg2.l11.m2.1.1.cmml" xref="alg2.l11.m2.1.1">𝑏</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l11.m2.1c">b</annotation><annotation encoding="application/x-llamapun" id="alg2.l11.m2.1d">italic_b</annotation></semantics></math> to its parent

</div>
<div class="ltx_listingline" id="alg2.l11a">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l11a.1.1.1" style="font-size:80%;">11:</span></span>  <math alttext="{\bm{P}}" class="ltx_Math" display="inline" id="alg2.l11a.m1.1"><semantics id="alg2.l11a.m1.1a"><mi id="alg2.l11a.m1.1.1" xref="alg2.l11a.m1.1.1.cmml">𝑷</mi><annotation-xml encoding="MathML-Content" id="alg2.l11a.m1.1b"><ci id="alg2.l11a.m1.1.1.cmml" xref="alg2.l11a.m1.1.1">𝑷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l11a.m1.1c">{\bm{P}}</annotation><annotation encoding="application/x-llamapun" id="alg2.l11a.m1.1d">bold_italic_P</annotation></semantics></math>
</div>
</div>
</figure>
</div>
</div>
</figure>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>CPCC with Optimal Transport</h2>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>OT-CPCC Family</h3>
<div class="ltx_para" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.10">Despite its simplicity, <em class="ltx_emph ltx_font_italic" id="S3.SS1.p1.1.1">the use of class centroids <math alttext="\ell_{2}" class="ltx_Math" display="inline" id="S3.SS1.p1.1.1.m1.1"><semantics id="S3.SS1.p1.1.1.m1.1a"><msub id="S3.SS1.p1.1.1.m1.1.1" xref="S3.SS1.p1.1.1.m1.1.1.cmml"><mi id="S3.SS1.p1.1.1.m1.1.1.2" mathvariant="normal" xref="S3.SS1.p1.1.1.m1.1.1.2.cmml">ℓ</mi><mn id="S3.SS1.p1.1.1.m1.1.1.3" xref="S3.SS1.p1.1.1.m1.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.1.m1.1b"><apply id="S3.SS1.p1.1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.1.1.m1.1.1.1.cmml" xref="S3.SS1.p1.1.1.m1.1.1">subscript</csymbol><ci id="S3.SS1.p1.1.1.m1.1.1.2.cmml" xref="S3.SS1.p1.1.1.m1.1.1.2">ℓ</ci><cn id="S3.SS1.p1.1.1.m1.1.1.3.cmml" type="integer" xref="S3.SS1.p1.1.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.1.m1.1c">\ell_{2}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.1.1.m1.1d">roman_ℓ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math> distance as a measure of class distances has two limitations.</em> First, since there is no guarantee of the distribution of class conditional features, the class mean difference may not accurately reflect the average pairwise Euclidean distance between all the pairs of sample. For example, in Fig.<a class="ltx_ref" href="https://arxiv.org/html/2410.03052v1#S3.F1" title="Figure 1 ‣ 3.1 OT-CPCC Family ‣ 3 CPCC with Optimal Transport ‣ Learning Structured Representations by Embedding Class Hierarchy with Fast Optimal Transport"><span class="ltx_text ltx_ref_tag">1</span></a>, class <math alttext="v" class="ltx_Math" display="inline" id="S3.SS1.p1.2.m1.1"><semantics id="S3.SS1.p1.2.m1.1a"><mi id="S3.SS1.p1.2.m1.1.1" xref="S3.SS1.p1.2.m1.1.1.cmml">v</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m1.1b"><ci id="S3.SS1.p1.2.m1.1.1.cmml" xref="S3.SS1.p1.2.m1.1.1">𝑣</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m1.1c">v</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.2.m1.1d">italic_v</annotation></semantics></math> is a non-unimodal (bi-modal in this example) distribution, which is very likely to happen when class <math alttext="v" class="ltx_Math" display="inline" id="S3.SS1.p1.3.m2.1"><semantics id="S3.SS1.p1.3.m2.1a"><mi id="S3.SS1.p1.3.m2.1.1" xref="S3.SS1.p1.3.m2.1.1.cmml">v</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m2.1b"><ci id="S3.SS1.p1.3.m2.1.1.cmml" xref="S3.SS1.p1.3.m2.1.1">𝑣</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m2.1c">v</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.3.m2.1d">italic_v</annotation></semantics></math> is an abstract concept, such as coarse classes like household furniture in CIFAR100 <cite class="ltx_cite ltx_citemacro_citep">(Krizhevsky and Hinton, <a class="ltx_ref" href="https://arxiv.org/html/2410.03052v1#bib.bib23" title="">2009</a>)</cite> or the collection of diverse dog breeds in ImageNet <cite class="ltx_cite ltx_citemacro_cite">Deng et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03052v1#bib.bib10" title="">2009</a>)</cite>. The blue <math alttext="\ell_{2}" class="ltx_Math" display="inline" id="S3.SS1.p1.4.m3.1"><semantics id="S3.SS1.p1.4.m3.1a"><msub id="S3.SS1.p1.4.m3.1.1" xref="S3.SS1.p1.4.m3.1.1.cmml"><mi id="S3.SS1.p1.4.m3.1.1.2" mathvariant="normal" xref="S3.SS1.p1.4.m3.1.1.2.cmml">ℓ</mi><mn id="S3.SS1.p1.4.m3.1.1.3" xref="S3.SS1.p1.4.m3.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m3.1b"><apply id="S3.SS1.p1.4.m3.1.1.cmml" xref="S3.SS1.p1.4.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m3.1.1.1.cmml" xref="S3.SS1.p1.4.m3.1.1">subscript</csymbol><ci id="S3.SS1.p1.4.m3.1.1.2.cmml" xref="S3.SS1.p1.4.m3.1.1.2">ℓ</ci><cn id="S3.SS1.p1.4.m3.1.1.3.cmml" type="integer" xref="S3.SS1.p1.4.m3.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m3.1c">\ell_{2}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.4.m3.1d">roman_ℓ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math> line can be a biased estimation of the average of red lines. We will see later (c.f. Sec.<a class="ltx_ref" href="https://arxiv.org/html/2410.03052v1#S3.SS3" title="3.3 Differentiability Analysis of OT-CPCC ‣ 3 CPCC with Optimal Transport ‣ Learning Structured Representations by Embedding Class Hierarchy with Fast Optimal Transport"><span class="ltx_text ltx_ref_tag">3.3</span></a>) that the direction of blue vector plays an important role in the feature geometry in <math alttext="\ell_{2}" class="ltx_Math" display="inline" id="S3.SS1.p1.5.m4.1"><semantics id="S3.SS1.p1.5.m4.1a"><msub id="S3.SS1.p1.5.m4.1.1" xref="S3.SS1.p1.5.m4.1.1.cmml"><mi id="S3.SS1.p1.5.m4.1.1.2" mathvariant="normal" xref="S3.SS1.p1.5.m4.1.1.2.cmml">ℓ</mi><mn id="S3.SS1.p1.5.m4.1.1.3" xref="S3.SS1.p1.5.m4.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.m4.1b"><apply id="S3.SS1.p1.5.m4.1.1.cmml" xref="S3.SS1.p1.5.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.5.m4.1.1.1.cmml" xref="S3.SS1.p1.5.m4.1.1">subscript</csymbol><ci id="S3.SS1.p1.5.m4.1.1.2.cmml" xref="S3.SS1.p1.5.m4.1.1.2">ℓ</ci><cn id="S3.SS1.p1.5.m4.1.1.3.cmml" type="integer" xref="S3.SS1.p1.5.m4.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.5.m4.1c">\ell_{2}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.5.m4.1d">roman_ℓ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>-CPCC, and therefore we misrepresent the class distribution in <math alttext="\ell_{2}" class="ltx_Math" display="inline" id="S3.SS1.p1.6.m5.1"><semantics id="S3.SS1.p1.6.m5.1a"><msub id="S3.SS1.p1.6.m5.1.1" xref="S3.SS1.p1.6.m5.1.1.cmml"><mi id="S3.SS1.p1.6.m5.1.1.2" mathvariant="normal" xref="S3.SS1.p1.6.m5.1.1.2.cmml">ℓ</mi><mn id="S3.SS1.p1.6.m5.1.1.3" xref="S3.SS1.p1.6.m5.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.6.m5.1b"><apply id="S3.SS1.p1.6.m5.1.1.cmml" xref="S3.SS1.p1.6.m5.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.6.m5.1.1.1.cmml" xref="S3.SS1.p1.6.m5.1.1">subscript</csymbol><ci id="S3.SS1.p1.6.m5.1.1.2.cmml" xref="S3.SS1.p1.6.m5.1.1.2">ℓ</ci><cn id="S3.SS1.p1.6.m5.1.1.3.cmml" type="integer" xref="S3.SS1.p1.6.m5.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.6.m5.1c">\ell_{2}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.6.m5.1d">roman_ℓ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>-CPCC. Second, it is known <cite class="ltx_cite ltx_citemacro_citep">(Linial et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03052v1#bib.bib25" title="">1994</a>)</cite> that, for certain trees such as a basic star graph with three edges, it is impossible to embed tree metric <math alttext="t" class="ltx_Math" display="inline" id="S3.SS1.p1.7.m6.1"><semantics id="S3.SS1.p1.7.m6.1a"><mi id="S3.SS1.p1.7.m6.1.1" xref="S3.SS1.p1.7.m6.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.7.m6.1b"><ci id="S3.SS1.p1.7.m6.1.1.cmml" xref="S3.SS1.p1.7.m6.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.7.m6.1c">t</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.7.m6.1d">italic_t</annotation></semantics></math> into <math alttext="\ell_{2}" class="ltx_Math" display="inline" id="S3.SS1.p1.8.m7.1"><semantics id="S3.SS1.p1.8.m7.1a"><msub id="S3.SS1.p1.8.m7.1.1" xref="S3.SS1.p1.8.m7.1.1.cmml"><mi id="S3.SS1.p1.8.m7.1.1.2" mathvariant="normal" xref="S3.SS1.p1.8.m7.1.1.2.cmml">ℓ</mi><mn id="S3.SS1.p1.8.m7.1.1.3" xref="S3.SS1.p1.8.m7.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.8.m7.1b"><apply id="S3.SS1.p1.8.m7.1.1.cmml" xref="S3.SS1.p1.8.m7.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.8.m7.1.1.1.cmml" xref="S3.SS1.p1.8.m7.1.1">subscript</csymbol><ci id="S3.SS1.p1.8.m7.1.1.2.cmml" xref="S3.SS1.p1.8.m7.1.1.2">ℓ</ci><cn id="S3.SS1.p1.8.m7.1.1.3.cmml" type="integer" xref="S3.SS1.p1.8.m7.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.8.m7.1c">\ell_{2}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.8.m7.1d">roman_ℓ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math> exactly, no matter how large feature dimension <math alttext="d" class="ltx_Math" display="inline" id="S3.SS1.p1.9.m8.1"><semantics id="S3.SS1.p1.9.m8.1a"><mi id="S3.SS1.p1.9.m8.1.1" xref="S3.SS1.p1.9.m8.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.9.m8.1b"><ci id="S3.SS1.p1.9.m8.1.1.cmml" xref="S3.SS1.p1.9.m8.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.9.m8.1c">d</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.9.m8.1d">italic_d</annotation></semantics></math> is. It implies if we use the Euclidean <em class="ltx_emph ltx_font_italic" id="S3.SS1.p1.10.2">centroids</em> to represent a class, we can never reach the optimal CPCC value <math alttext="1" class="ltx_Math" display="inline" id="S3.SS1.p1.10.m9.1"><semantics id="S3.SS1.p1.10.m9.1a"><mn id="S3.SS1.p1.10.m9.1.1" xref="S3.SS1.p1.10.m9.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.10.m9.1b"><cn id="S3.SS1.p1.10.m9.1.1.cmml" type="integer" xref="S3.SS1.p1.10.m9.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.10.m9.1c">1</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.10.m9.1d">1</annotation></semantics></math> during training, which always cause some loss of hierarchical information in the learning of structured representation.</p>
</div>
<figure class="ltx_figure ltx_align_floatright" id="S3.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_portrait" height="631" id="S3.F1.g1" src="x1.png" width="399"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F1.4.2.1" style="font-size:90%;">Figure 1</span>: </span><span class="ltx_text" id="S3.F1.2.1" style="font-size:90%;">Comparison between EMD (weighted sum of red lines) and the class mean <math alttext="\ell_{2}" class="ltx_Math" display="inline" id="S3.F1.2.1.m1.1"><semantics id="S3.F1.2.1.m1.1b"><msub id="S3.F1.2.1.m1.1.1" xref="S3.F1.2.1.m1.1.1.cmml"><mi id="S3.F1.2.1.m1.1.1.2" mathvariant="normal" xref="S3.F1.2.1.m1.1.1.2.cmml">ℓ</mi><mn id="S3.F1.2.1.m1.1.1.3" xref="S3.F1.2.1.m1.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S3.F1.2.1.m1.1c"><apply id="S3.F1.2.1.m1.1.1.cmml" xref="S3.F1.2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.F1.2.1.m1.1.1.1.cmml" xref="S3.F1.2.1.m1.1.1">subscript</csymbol><ci id="S3.F1.2.1.m1.1.1.2.cmml" xref="S3.F1.2.1.m1.1.1.2">ℓ</ci><cn id="S3.F1.2.1.m1.1.1.3.cmml" type="integer" xref="S3.F1.2.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F1.2.1.m1.1d">\ell_{2}</annotation><annotation encoding="application/x-llamapun" id="S3.F1.2.1.m1.1e">roman_ℓ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math> distance (blue line).</span></figcaption>
</figure>
<div class="ltx_para" id="S3.SS1.p2">
<p class="ltx_p" id="S3.SS1.p2.12">How to overcome the above limitations? Instead of finding a one-to-one correspondence of a label and a point estimate of a class, we represent a label class with all <em class="ltx_emph ltx_font_italic" id="S3.SS1.p2.12.1">samples</em> that belong to the class, which leads to EMD-CPCC.
We call the set of data-weight pairs containing <math alttext="m" class="ltx_Math" display="inline" id="S3.SS1.p2.1.m1.1"><semantics id="S3.SS1.p2.1.m1.1a"><mi id="S3.SS1.p2.1.m1.1.1" xref="S3.SS1.p2.1.m1.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.1b"><ci id="S3.SS1.p2.1.m1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.1c">m</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.1.m1.1d">italic_m</annotation></semantics></math> class-<math alttext="u" class="ltx_Math" display="inline" id="S3.SS1.p2.2.m2.1"><semantics id="S3.SS1.p2.2.m2.1a"><mi id="S3.SS1.p2.2.m2.1.1" xref="S3.SS1.p2.2.m2.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.2.m2.1b"><ci id="S3.SS1.p2.2.m2.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.2.m2.1c">u</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.2.m2.1d">italic_u</annotation></semantics></math> conditioned features as <math alttext="\mu=\{(z_{i},a_{i})\}_{i=1}^{m}" class="ltx_Math" display="inline" id="S3.SS1.p2.3.m3.1"><semantics id="S3.SS1.p2.3.m3.1a"><mrow id="S3.SS1.p2.3.m3.1.1" xref="S3.SS1.p2.3.m3.1.1.cmml"><mi id="S3.SS1.p2.3.m3.1.1.3" xref="S3.SS1.p2.3.m3.1.1.3.cmml">μ</mi><mo id="S3.SS1.p2.3.m3.1.1.2" xref="S3.SS1.p2.3.m3.1.1.2.cmml">=</mo><msubsup id="S3.SS1.p2.3.m3.1.1.1" xref="S3.SS1.p2.3.m3.1.1.1.cmml"><mrow id="S3.SS1.p2.3.m3.1.1.1.1.1.1" xref="S3.SS1.p2.3.m3.1.1.1.1.1.2.cmml"><mo id="S3.SS1.p2.3.m3.1.1.1.1.1.1.2" stretchy="false" xref="S3.SS1.p2.3.m3.1.1.1.1.1.2.cmml">{</mo><mrow id="S3.SS1.p2.3.m3.1.1.1.1.1.1.1.2" xref="S3.SS1.p2.3.m3.1.1.1.1.1.1.1.3.cmml"><mo id="S3.SS1.p2.3.m3.1.1.1.1.1.1.1.2.3" stretchy="false" xref="S3.SS1.p2.3.m3.1.1.1.1.1.1.1.3.cmml">(</mo><msub id="S3.SS1.p2.3.m3.1.1.1.1.1.1.1.1.1" xref="S3.SS1.p2.3.m3.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.SS1.p2.3.m3.1.1.1.1.1.1.1.1.1.2" xref="S3.SS1.p2.3.m3.1.1.1.1.1.1.1.1.1.2.cmml">z</mi><mi id="S3.SS1.p2.3.m3.1.1.1.1.1.1.1.1.1.3" xref="S3.SS1.p2.3.m3.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS1.p2.3.m3.1.1.1.1.1.1.1.2.4" xref="S3.SS1.p2.3.m3.1.1.1.1.1.1.1.3.cmml">,</mo><msub id="S3.SS1.p2.3.m3.1.1.1.1.1.1.1.2.2" xref="S3.SS1.p2.3.m3.1.1.1.1.1.1.1.2.2.cmml"><mi id="S3.SS1.p2.3.m3.1.1.1.1.1.1.1.2.2.2" xref="S3.SS1.p2.3.m3.1.1.1.1.1.1.1.2.2.2.cmml">a</mi><mi id="S3.SS1.p2.3.m3.1.1.1.1.1.1.1.2.2.3" xref="S3.SS1.p2.3.m3.1.1.1.1.1.1.1.2.2.3.cmml">i</mi></msub><mo id="S3.SS1.p2.3.m3.1.1.1.1.1.1.1.2.5" stretchy="false" xref="S3.SS1.p2.3.m3.1.1.1.1.1.1.1.3.cmml">)</mo></mrow><mo id="S3.SS1.p2.3.m3.1.1.1.1.1.1.3" stretchy="false" xref="S3.SS1.p2.3.m3.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S3.SS1.p2.3.m3.1.1.1.1.3" xref="S3.SS1.p2.3.m3.1.1.1.1.3.cmml"><mi id="S3.SS1.p2.3.m3.1.1.1.1.3.2" xref="S3.SS1.p2.3.m3.1.1.1.1.3.2.cmml">i</mi><mo id="S3.SS1.p2.3.m3.1.1.1.1.3.1" xref="S3.SS1.p2.3.m3.1.1.1.1.3.1.cmml">=</mo><mn id="S3.SS1.p2.3.m3.1.1.1.1.3.3" xref="S3.SS1.p2.3.m3.1.1.1.1.3.3.cmml">1</mn></mrow><mi id="S3.SS1.p2.3.m3.1.1.1.3" xref="S3.SS1.p2.3.m3.1.1.1.3.cmml">m</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.3.m3.1b"><apply id="S3.SS1.p2.3.m3.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1"><eq id="S3.SS1.p2.3.m3.1.1.2.cmml" xref="S3.SS1.p2.3.m3.1.1.2"></eq><ci id="S3.SS1.p2.3.m3.1.1.3.cmml" xref="S3.SS1.p2.3.m3.1.1.3">𝜇</ci><apply id="S3.SS1.p2.3.m3.1.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.3.m3.1.1.1.2.cmml" xref="S3.SS1.p2.3.m3.1.1.1">superscript</csymbol><apply id="S3.SS1.p2.3.m3.1.1.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.3.m3.1.1.1.1.2.cmml" xref="S3.SS1.p2.3.m3.1.1.1">subscript</csymbol><set id="S3.SS1.p2.3.m3.1.1.1.1.1.2.cmml" xref="S3.SS1.p2.3.m3.1.1.1.1.1.1"><interval closure="open" id="S3.SS1.p2.3.m3.1.1.1.1.1.1.1.3.cmml" xref="S3.SS1.p2.3.m3.1.1.1.1.1.1.1.2"><apply id="S3.SS1.p2.3.m3.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.3.m3.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p2.3.m3.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.SS1.p2.3.m3.1.1.1.1.1.1.1.1.1.2">𝑧</ci><ci id="S3.SS1.p2.3.m3.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.SS1.p2.3.m3.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.SS1.p2.3.m3.1.1.1.1.1.1.1.2.2.cmml" xref="S3.SS1.p2.3.m3.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.SS1.p2.3.m3.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.SS1.p2.3.m3.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S3.SS1.p2.3.m3.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.SS1.p2.3.m3.1.1.1.1.1.1.1.2.2.2">𝑎</ci><ci id="S3.SS1.p2.3.m3.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.SS1.p2.3.m3.1.1.1.1.1.1.1.2.2.3">𝑖</ci></apply></interval></set><apply id="S3.SS1.p2.3.m3.1.1.1.1.3.cmml" xref="S3.SS1.p2.3.m3.1.1.1.1.3"><eq id="S3.SS1.p2.3.m3.1.1.1.1.3.1.cmml" xref="S3.SS1.p2.3.m3.1.1.1.1.3.1"></eq><ci id="S3.SS1.p2.3.m3.1.1.1.1.3.2.cmml" xref="S3.SS1.p2.3.m3.1.1.1.1.3.2">𝑖</ci><cn id="S3.SS1.p2.3.m3.1.1.1.1.3.3.cmml" type="integer" xref="S3.SS1.p2.3.m3.1.1.1.1.3.3">1</cn></apply></apply><ci id="S3.SS1.p2.3.m3.1.1.1.3.cmml" xref="S3.SS1.p2.3.m3.1.1.1.3">𝑚</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.3.m3.1c">\mu=\{(z_{i},a_{i})\}_{i=1}^{m}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.3.m3.1d">italic_μ = { ( italic_z start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_a start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) } start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_m end_POSTSUPERSCRIPT</annotation></semantics></math> and define <math alttext="\nu" class="ltx_Math" display="inline" id="S3.SS1.p2.4.m4.1"><semantics id="S3.SS1.p2.4.m4.1a"><mi id="S3.SS1.p2.4.m4.1.1" xref="S3.SS1.p2.4.m4.1.1.cmml">ν</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.4.m4.1b"><ci id="S3.SS1.p2.4.m4.1.1.cmml" xref="S3.SS1.p2.4.m4.1.1">𝜈</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.4.m4.1c">\nu</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.4.m4.1d">italic_ν</annotation></semantics></math> similarly for the dataset containing <math alttext="n" class="ltx_Math" display="inline" id="S3.SS1.p2.5.m5.1"><semantics id="S3.SS1.p2.5.m5.1a"><mi id="S3.SS1.p2.5.m5.1.1" xref="S3.SS1.p2.5.m5.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.5.m5.1b"><ci id="S3.SS1.p2.5.m5.1.1.cmml" xref="S3.SS1.p2.5.m5.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.5.m5.1c">n</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.5.m5.1d">italic_n</annotation></semantics></math> class-<math alttext="v" class="ltx_Math" display="inline" id="S3.SS1.p2.6.m6.1"><semantics id="S3.SS1.p2.6.m6.1a"><mi id="S3.SS1.p2.6.m6.1.1" xref="S3.SS1.p2.6.m6.1.1.cmml">v</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.6.m6.1b"><ci id="S3.SS1.p2.6.m6.1.1.cmml" xref="S3.SS1.p2.6.m6.1.1">𝑣</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.6.m6.1c">v</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.6.m6.1d">italic_v</annotation></semantics></math> conditioned features. The weight <math alttext="a_{i}" class="ltx_Math" display="inline" id="S3.SS1.p2.7.m7.1"><semantics id="S3.SS1.p2.7.m7.1a"><msub id="S3.SS1.p2.7.m7.1.1" xref="S3.SS1.p2.7.m7.1.1.cmml"><mi id="S3.SS1.p2.7.m7.1.1.2" xref="S3.SS1.p2.7.m7.1.1.2.cmml">a</mi><mi id="S3.SS1.p2.7.m7.1.1.3" xref="S3.SS1.p2.7.m7.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.7.m7.1b"><apply id="S3.SS1.p2.7.m7.1.1.cmml" xref="S3.SS1.p2.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.7.m7.1.1.1.cmml" xref="S3.SS1.p2.7.m7.1.1">subscript</csymbol><ci id="S3.SS1.p2.7.m7.1.1.2.cmml" xref="S3.SS1.p2.7.m7.1.1.2">𝑎</ci><ci id="S3.SS1.p2.7.m7.1.1.3.cmml" xref="S3.SS1.p2.7.m7.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.7.m7.1c">a_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.7.m7.1d">italic_a start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> can be set as uniform (<math alttext="1/m" class="ltx_Math" display="inline" id="S3.SS1.p2.8.m8.1"><semantics id="S3.SS1.p2.8.m8.1a"><mrow id="S3.SS1.p2.8.m8.1.1" xref="S3.SS1.p2.8.m8.1.1.cmml"><mn id="S3.SS1.p2.8.m8.1.1.2" xref="S3.SS1.p2.8.m8.1.1.2.cmml">1</mn><mo id="S3.SS1.p2.8.m8.1.1.1" xref="S3.SS1.p2.8.m8.1.1.1.cmml">/</mo><mi id="S3.SS1.p2.8.m8.1.1.3" xref="S3.SS1.p2.8.m8.1.1.3.cmml">m</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.8.m8.1b"><apply id="S3.SS1.p2.8.m8.1.1.cmml" xref="S3.SS1.p2.8.m8.1.1"><divide id="S3.SS1.p2.8.m8.1.1.1.cmml" xref="S3.SS1.p2.8.m8.1.1.1"></divide><cn id="S3.SS1.p2.8.m8.1.1.2.cmml" type="integer" xref="S3.SS1.p2.8.m8.1.1.2">1</cn><ci id="S3.SS1.p2.8.m8.1.1.3.cmml" xref="S3.SS1.p2.8.m8.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.8.m8.1c">1/m</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.8.m8.1d">1 / italic_m</annotation></semantics></math>) by default, or non-uniform if external prior knowledge is available. We propose EMD-CPCC by implementing <math alttext="\rho(u,v)\vcentcolon=\text{EMD}(\mu,\nu)" class="ltx_Math" display="inline" id="S3.SS1.p2.9.m9.4"><semantics id="S3.SS1.p2.9.m9.4a"><mrow id="S3.SS1.p2.9.m9.4.5" xref="S3.SS1.p2.9.m9.4.5.cmml"><mrow id="S3.SS1.p2.9.m9.4.5.2" xref="S3.SS1.p2.9.m9.4.5.2.cmml"><mi id="S3.SS1.p2.9.m9.4.5.2.2" xref="S3.SS1.p2.9.m9.4.5.2.2.cmml">ρ</mi><mo id="S3.SS1.p2.9.m9.4.5.2.1" xref="S3.SS1.p2.9.m9.4.5.2.1.cmml">⁢</mo><mrow id="S3.SS1.p2.9.m9.4.5.2.3.2" xref="S3.SS1.p2.9.m9.4.5.2.3.1.cmml"><mo id="S3.SS1.p2.9.m9.4.5.2.3.2.1" stretchy="false" xref="S3.SS1.p2.9.m9.4.5.2.3.1.cmml">(</mo><mi id="S3.SS1.p2.9.m9.1.1" xref="S3.SS1.p2.9.m9.1.1.cmml">u</mi><mo id="S3.SS1.p2.9.m9.4.5.2.3.2.2" xref="S3.SS1.p2.9.m9.4.5.2.3.1.cmml">,</mo><mi id="S3.SS1.p2.9.m9.2.2" xref="S3.SS1.p2.9.m9.2.2.cmml">v</mi><mo id="S3.SS1.p2.9.m9.4.5.2.3.2.3" rspace="0.278em" stretchy="false" xref="S3.SS1.p2.9.m9.4.5.2.3.1.cmml">)</mo></mrow></mrow><mo id="S3.SS1.p2.9.m9.4.5.1" rspace="0.278em" xref="S3.SS1.p2.9.m9.4.5.1.cmml">:=</mo><mrow id="S3.SS1.p2.9.m9.4.5.3" xref="S3.SS1.p2.9.m9.4.5.3.cmml"><mtext id="S3.SS1.p2.9.m9.4.5.3.2" xref="S3.SS1.p2.9.m9.4.5.3.2a.cmml">EMD</mtext><mo id="S3.SS1.p2.9.m9.4.5.3.1" xref="S3.SS1.p2.9.m9.4.5.3.1.cmml">⁢</mo><mrow id="S3.SS1.p2.9.m9.4.5.3.3.2" xref="S3.SS1.p2.9.m9.4.5.3.3.1.cmml"><mo id="S3.SS1.p2.9.m9.4.5.3.3.2.1" stretchy="false" xref="S3.SS1.p2.9.m9.4.5.3.3.1.cmml">(</mo><mi id="S3.SS1.p2.9.m9.3.3" xref="S3.SS1.p2.9.m9.3.3.cmml">μ</mi><mo id="S3.SS1.p2.9.m9.4.5.3.3.2.2" xref="S3.SS1.p2.9.m9.4.5.3.3.1.cmml">,</mo><mi id="S3.SS1.p2.9.m9.4.4" xref="S3.SS1.p2.9.m9.4.4.cmml">ν</mi><mo id="S3.SS1.p2.9.m9.4.5.3.3.2.3" stretchy="false" xref="S3.SS1.p2.9.m9.4.5.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.9.m9.4b"><apply id="S3.SS1.p2.9.m9.4.5.cmml" xref="S3.SS1.p2.9.m9.4.5"><csymbol cd="latexml" id="S3.SS1.p2.9.m9.4.5.1.cmml" xref="S3.SS1.p2.9.m9.4.5.1">assign</csymbol><apply id="S3.SS1.p2.9.m9.4.5.2.cmml" xref="S3.SS1.p2.9.m9.4.5.2"><times id="S3.SS1.p2.9.m9.4.5.2.1.cmml" xref="S3.SS1.p2.9.m9.4.5.2.1"></times><ci id="S3.SS1.p2.9.m9.4.5.2.2.cmml" xref="S3.SS1.p2.9.m9.4.5.2.2">𝜌</ci><interval closure="open" id="S3.SS1.p2.9.m9.4.5.2.3.1.cmml" xref="S3.SS1.p2.9.m9.4.5.2.3.2"><ci id="S3.SS1.p2.9.m9.1.1.cmml" xref="S3.SS1.p2.9.m9.1.1">𝑢</ci><ci id="S3.SS1.p2.9.m9.2.2.cmml" xref="S3.SS1.p2.9.m9.2.2">𝑣</ci></interval></apply><apply id="S3.SS1.p2.9.m9.4.5.3.cmml" xref="S3.SS1.p2.9.m9.4.5.3"><times id="S3.SS1.p2.9.m9.4.5.3.1.cmml" xref="S3.SS1.p2.9.m9.4.5.3.1"></times><ci id="S3.SS1.p2.9.m9.4.5.3.2a.cmml" xref="S3.SS1.p2.9.m9.4.5.3.2"><mtext id="S3.SS1.p2.9.m9.4.5.3.2.cmml" xref="S3.SS1.p2.9.m9.4.5.3.2">EMD</mtext></ci><interval closure="open" id="S3.SS1.p2.9.m9.4.5.3.3.1.cmml" xref="S3.SS1.p2.9.m9.4.5.3.3.2"><ci id="S3.SS1.p2.9.m9.3.3.cmml" xref="S3.SS1.p2.9.m9.3.3">𝜇</ci><ci id="S3.SS1.p2.9.m9.4.4.cmml" xref="S3.SS1.p2.9.m9.4.4">𝜈</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.9.m9.4c">\rho(u,v)\vcentcolon=\text{EMD}(\mu,\nu)</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.9.m9.4d">italic_ρ ( italic_u , italic_v ) := EMD ( italic_μ , italic_ν )</annotation></semantics></math>. In Eq.<a class="ltx_ref" href="https://arxiv.org/html/2410.03052v1#S2.E3" title="Equation 3 ‣ 2.2 Exact Earth Mover’s Distance ‣ 2 Preliminaries ‣ Learning Structured Representations by Embedding Class Hierarchy with Fast Optimal Transport"><span class="ltx_text ltx_ref_tag">3</span></a>, <math alttext="{\bm{P}}" class="ltx_Math" display="inline" id="S3.SS1.p2.10.m10.1"><semantics id="S3.SS1.p2.10.m10.1a"><mi id="S3.SS1.p2.10.m10.1.1" xref="S3.SS1.p2.10.m10.1.1.cmml">𝑷</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.10.m10.1b"><ci id="S3.SS1.p2.10.m10.1.1.cmml" xref="S3.SS1.p2.10.m10.1.1">𝑷</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.10.m10.1c">{\bm{P}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.10.m10.1d">bold_italic_P</annotation></semantics></math> depends on <math alttext="{\bm{D}}" class="ltx_Math" display="inline" id="S3.SS1.p2.11.m11.1"><semantics id="S3.SS1.p2.11.m11.1a"><mi id="S3.SS1.p2.11.m11.1.1" xref="S3.SS1.p2.11.m11.1.1.cmml">𝑫</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.11.m11.1b"><ci id="S3.SS1.p2.11.m11.1.1.cmml" xref="S3.SS1.p2.11.m11.1.1">𝑫</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.11.m11.1c">{\bm{D}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.11.m11.1d">bold_italic_D</annotation></semantics></math> derived from each <em class="ltx_emph ltx_font_italic" id="S3.SS1.p2.12.2">sample</em> in two datasets. Besides, EMD is actually a generalization of <math alttext="\ell_{2}" class="ltx_Math" display="inline" id="S3.SS1.p2.12.m12.1"><semantics id="S3.SS1.p2.12.m12.1a"><msub id="S3.SS1.p2.12.m12.1.1" xref="S3.SS1.p2.12.m12.1.1.cmml"><mi id="S3.SS1.p2.12.m12.1.1.2" mathvariant="normal" xref="S3.SS1.p2.12.m12.1.1.2.cmml">ℓ</mi><mn id="S3.SS1.p2.12.m12.1.1.3" xref="S3.SS1.p2.12.m12.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.12.m12.1b"><apply id="S3.SS1.p2.12.m12.1.1.cmml" xref="S3.SS1.p2.12.m12.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.12.m12.1.1.1.cmml" xref="S3.SS1.p2.12.m12.1.1">subscript</csymbol><ci id="S3.SS1.p2.12.m12.1.1.2.cmml" xref="S3.SS1.p2.12.m12.1.1.2">ℓ</ci><cn id="S3.SS1.p2.12.m12.1.1.3.cmml" type="integer" xref="S3.SS1.p2.12.m12.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.12.m12.1c">\ell_{2}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.12.m12.1d">roman_ℓ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math> method:</p>
</div>
<div class="ltx_theorem ltx_theorem_proposition" id="S3.Thmtheorem1">
<h6 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span class="ltx_text ltx_font_bold" id="S3.Thmtheorem1.2.1.1">Proposition 3.1</span></span><span class="ltx_text ltx_font_bold" id="S3.Thmtheorem1.3.2"> </span>(EMD reduces to <math alttext="\ell_{2}" class="ltx_Math" display="inline" id="S3.Thmtheorem1.1.m1.1"><semantics id="S3.Thmtheorem1.1.m1.1b"><msub id="S3.Thmtheorem1.1.m1.1.1" xref="S3.Thmtheorem1.1.m1.1.1.cmml"><mi id="S3.Thmtheorem1.1.m1.1.1.2" mathvariant="normal" xref="S3.Thmtheorem1.1.m1.1.1.2.cmml">ℓ</mi><mn id="S3.Thmtheorem1.1.m1.1.1.3" xref="S3.Thmtheorem1.1.m1.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S3.Thmtheorem1.1.m1.1c"><apply id="S3.Thmtheorem1.1.m1.1.1.cmml" xref="S3.Thmtheorem1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.Thmtheorem1.1.m1.1.1.1.cmml" xref="S3.Thmtheorem1.1.m1.1.1">subscript</csymbol><ci id="S3.Thmtheorem1.1.m1.1.1.2.cmml" xref="S3.Thmtheorem1.1.m1.1.1.2">ℓ</ci><cn id="S3.Thmtheorem1.1.m1.1.1.3.cmml" type="integer" xref="S3.Thmtheorem1.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmtheorem1.1.m1.1d">\ell_{2}</annotation><annotation encoding="application/x-llamapun" id="S3.Thmtheorem1.1.m1.1e">roman_ℓ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math> for Gaussians with same covariance)<span class="ltx_text ltx_font_bold" id="S3.Thmtheorem1.4.3">.</span>
</h6>
<div class="ltx_para" id="S3.Thmtheorem1.p1">
<p class="ltx_p" id="S3.Thmtheorem1.p1.1"><math alttext="\mathrm{EMD}({\mathcal{N}}(\mu_{z},\Sigma),{\mathcal{N}}(\mu_{z^{\prime}},%
\Sigma))=\|\mu_{z}-\mu_{z^{\prime}}\|" class="ltx_Math" display="inline" id="S3.Thmtheorem1.p1.1.m1.5"><semantics id="S3.Thmtheorem1.p1.1.m1.5a"><mrow id="S3.Thmtheorem1.p1.1.m1.5.5" xref="S3.Thmtheorem1.p1.1.m1.5.5.cmml"><mrow id="S3.Thmtheorem1.p1.1.m1.4.4.2" xref="S3.Thmtheorem1.p1.1.m1.4.4.2.cmml"><mi id="S3.Thmtheorem1.p1.1.m1.4.4.2.4" xref="S3.Thmtheorem1.p1.1.m1.4.4.2.4.cmml">EMD</mi><mo id="S3.Thmtheorem1.p1.1.m1.4.4.2.3" xref="S3.Thmtheorem1.p1.1.m1.4.4.2.3.cmml">⁢</mo><mrow id="S3.Thmtheorem1.p1.1.m1.4.4.2.2.2" xref="S3.Thmtheorem1.p1.1.m1.4.4.2.2.3.cmml"><mo id="S3.Thmtheorem1.p1.1.m1.4.4.2.2.2.3" stretchy="false" xref="S3.Thmtheorem1.p1.1.m1.4.4.2.2.3.cmml">(</mo><mrow id="S3.Thmtheorem1.p1.1.m1.3.3.1.1.1.1" xref="S3.Thmtheorem1.p1.1.m1.3.3.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.Thmtheorem1.p1.1.m1.3.3.1.1.1.1.3" xref="S3.Thmtheorem1.p1.1.m1.3.3.1.1.1.1.3.cmml">𝒩</mi><mo id="S3.Thmtheorem1.p1.1.m1.3.3.1.1.1.1.2" xref="S3.Thmtheorem1.p1.1.m1.3.3.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.Thmtheorem1.p1.1.m1.3.3.1.1.1.1.1.1" xref="S3.Thmtheorem1.p1.1.m1.3.3.1.1.1.1.1.2.cmml"><mo id="S3.Thmtheorem1.p1.1.m1.3.3.1.1.1.1.1.1.2" stretchy="false" xref="S3.Thmtheorem1.p1.1.m1.3.3.1.1.1.1.1.2.cmml">(</mo><msub id="S3.Thmtheorem1.p1.1.m1.3.3.1.1.1.1.1.1.1" xref="S3.Thmtheorem1.p1.1.m1.3.3.1.1.1.1.1.1.1.cmml"><mi id="S3.Thmtheorem1.p1.1.m1.3.3.1.1.1.1.1.1.1.2" xref="S3.Thmtheorem1.p1.1.m1.3.3.1.1.1.1.1.1.1.2.cmml">μ</mi><mi id="S3.Thmtheorem1.p1.1.m1.3.3.1.1.1.1.1.1.1.3" xref="S3.Thmtheorem1.p1.1.m1.3.3.1.1.1.1.1.1.1.3.cmml">z</mi></msub><mo id="S3.Thmtheorem1.p1.1.m1.3.3.1.1.1.1.1.1.3" xref="S3.Thmtheorem1.p1.1.m1.3.3.1.1.1.1.1.2.cmml">,</mo><mi id="S3.Thmtheorem1.p1.1.m1.1.1" mathvariant="normal" xref="S3.Thmtheorem1.p1.1.m1.1.1.cmml">Σ</mi><mo id="S3.Thmtheorem1.p1.1.m1.3.3.1.1.1.1.1.1.4" stretchy="false" xref="S3.Thmtheorem1.p1.1.m1.3.3.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.Thmtheorem1.p1.1.m1.4.4.2.2.2.4" xref="S3.Thmtheorem1.p1.1.m1.4.4.2.2.3.cmml">,</mo><mrow id="S3.Thmtheorem1.p1.1.m1.4.4.2.2.2.2" xref="S3.Thmtheorem1.p1.1.m1.4.4.2.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.Thmtheorem1.p1.1.m1.4.4.2.2.2.2.3" xref="S3.Thmtheorem1.p1.1.m1.4.4.2.2.2.2.3.cmml">𝒩</mi><mo id="S3.Thmtheorem1.p1.1.m1.4.4.2.2.2.2.2" xref="S3.Thmtheorem1.p1.1.m1.4.4.2.2.2.2.2.cmml">⁢</mo><mrow id="S3.Thmtheorem1.p1.1.m1.4.4.2.2.2.2.1.1" xref="S3.Thmtheorem1.p1.1.m1.4.4.2.2.2.2.1.2.cmml"><mo id="S3.Thmtheorem1.p1.1.m1.4.4.2.2.2.2.1.1.2" stretchy="false" xref="S3.Thmtheorem1.p1.1.m1.4.4.2.2.2.2.1.2.cmml">(</mo><msub id="S3.Thmtheorem1.p1.1.m1.4.4.2.2.2.2.1.1.1" xref="S3.Thmtheorem1.p1.1.m1.4.4.2.2.2.2.1.1.1.cmml"><mi id="S3.Thmtheorem1.p1.1.m1.4.4.2.2.2.2.1.1.1.2" xref="S3.Thmtheorem1.p1.1.m1.4.4.2.2.2.2.1.1.1.2.cmml">μ</mi><msup id="S3.Thmtheorem1.p1.1.m1.4.4.2.2.2.2.1.1.1.3" xref="S3.Thmtheorem1.p1.1.m1.4.4.2.2.2.2.1.1.1.3.cmml"><mi id="S3.Thmtheorem1.p1.1.m1.4.4.2.2.2.2.1.1.1.3.2" xref="S3.Thmtheorem1.p1.1.m1.4.4.2.2.2.2.1.1.1.3.2.cmml">z</mi><mo id="S3.Thmtheorem1.p1.1.m1.4.4.2.2.2.2.1.1.1.3.3" xref="S3.Thmtheorem1.p1.1.m1.4.4.2.2.2.2.1.1.1.3.3.cmml">′</mo></msup></msub><mo id="S3.Thmtheorem1.p1.1.m1.4.4.2.2.2.2.1.1.3" xref="S3.Thmtheorem1.p1.1.m1.4.4.2.2.2.2.1.2.cmml">,</mo><mi id="S3.Thmtheorem1.p1.1.m1.2.2" mathvariant="normal" xref="S3.Thmtheorem1.p1.1.m1.2.2.cmml">Σ</mi><mo id="S3.Thmtheorem1.p1.1.m1.4.4.2.2.2.2.1.1.4" stretchy="false" xref="S3.Thmtheorem1.p1.1.m1.4.4.2.2.2.2.1.2.cmml">)</mo></mrow></mrow><mo id="S3.Thmtheorem1.p1.1.m1.4.4.2.2.2.5" stretchy="false" xref="S3.Thmtheorem1.p1.1.m1.4.4.2.2.3.cmml">)</mo></mrow></mrow><mo id="S3.Thmtheorem1.p1.1.m1.5.5.4" xref="S3.Thmtheorem1.p1.1.m1.5.5.4.cmml">=</mo><mrow id="S3.Thmtheorem1.p1.1.m1.5.5.3.1" xref="S3.Thmtheorem1.p1.1.m1.5.5.3.2.cmml"><mo id="S3.Thmtheorem1.p1.1.m1.5.5.3.1.2" stretchy="false" xref="S3.Thmtheorem1.p1.1.m1.5.5.3.2.1.cmml">‖</mo><mrow id="S3.Thmtheorem1.p1.1.m1.5.5.3.1.1" xref="S3.Thmtheorem1.p1.1.m1.5.5.3.1.1.cmml"><msub id="S3.Thmtheorem1.p1.1.m1.5.5.3.1.1.2" xref="S3.Thmtheorem1.p1.1.m1.5.5.3.1.1.2.cmml"><mi id="S3.Thmtheorem1.p1.1.m1.5.5.3.1.1.2.2" xref="S3.Thmtheorem1.p1.1.m1.5.5.3.1.1.2.2.cmml">μ</mi><mi id="S3.Thmtheorem1.p1.1.m1.5.5.3.1.1.2.3" xref="S3.Thmtheorem1.p1.1.m1.5.5.3.1.1.2.3.cmml">z</mi></msub><mo id="S3.Thmtheorem1.p1.1.m1.5.5.3.1.1.1" xref="S3.Thmtheorem1.p1.1.m1.5.5.3.1.1.1.cmml">−</mo><msub id="S3.Thmtheorem1.p1.1.m1.5.5.3.1.1.3" xref="S3.Thmtheorem1.p1.1.m1.5.5.3.1.1.3.cmml"><mi id="S3.Thmtheorem1.p1.1.m1.5.5.3.1.1.3.2" xref="S3.Thmtheorem1.p1.1.m1.5.5.3.1.1.3.2.cmml">μ</mi><msup id="S3.Thmtheorem1.p1.1.m1.5.5.3.1.1.3.3" xref="S3.Thmtheorem1.p1.1.m1.5.5.3.1.1.3.3.cmml"><mi id="S3.Thmtheorem1.p1.1.m1.5.5.3.1.1.3.3.2" xref="S3.Thmtheorem1.p1.1.m1.5.5.3.1.1.3.3.2.cmml">z</mi><mo id="S3.Thmtheorem1.p1.1.m1.5.5.3.1.1.3.3.3" xref="S3.Thmtheorem1.p1.1.m1.5.5.3.1.1.3.3.3.cmml">′</mo></msup></msub></mrow><mo id="S3.Thmtheorem1.p1.1.m1.5.5.3.1.3" stretchy="false" xref="S3.Thmtheorem1.p1.1.m1.5.5.3.2.1.cmml">‖</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Thmtheorem1.p1.1.m1.5b"><apply id="S3.Thmtheorem1.p1.1.m1.5.5.cmml" xref="S3.Thmtheorem1.p1.1.m1.5.5"><eq id="S3.Thmtheorem1.p1.1.m1.5.5.4.cmml" xref="S3.Thmtheorem1.p1.1.m1.5.5.4"></eq><apply id="S3.Thmtheorem1.p1.1.m1.4.4.2.cmml" xref="S3.Thmtheorem1.p1.1.m1.4.4.2"><times id="S3.Thmtheorem1.p1.1.m1.4.4.2.3.cmml" xref="S3.Thmtheorem1.p1.1.m1.4.4.2.3"></times><ci id="S3.Thmtheorem1.p1.1.m1.4.4.2.4.cmml" xref="S3.Thmtheorem1.p1.1.m1.4.4.2.4">EMD</ci><interval closure="open" id="S3.Thmtheorem1.p1.1.m1.4.4.2.2.3.cmml" xref="S3.Thmtheorem1.p1.1.m1.4.4.2.2.2"><apply id="S3.Thmtheorem1.p1.1.m1.3.3.1.1.1.1.cmml" xref="S3.Thmtheorem1.p1.1.m1.3.3.1.1.1.1"><times id="S3.Thmtheorem1.p1.1.m1.3.3.1.1.1.1.2.cmml" xref="S3.Thmtheorem1.p1.1.m1.3.3.1.1.1.1.2"></times><ci id="S3.Thmtheorem1.p1.1.m1.3.3.1.1.1.1.3.cmml" xref="S3.Thmtheorem1.p1.1.m1.3.3.1.1.1.1.3">𝒩</ci><interval closure="open" id="S3.Thmtheorem1.p1.1.m1.3.3.1.1.1.1.1.2.cmml" xref="S3.Thmtheorem1.p1.1.m1.3.3.1.1.1.1.1.1"><apply id="S3.Thmtheorem1.p1.1.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S3.Thmtheorem1.p1.1.m1.3.3.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Thmtheorem1.p1.1.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="S3.Thmtheorem1.p1.1.m1.3.3.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.Thmtheorem1.p1.1.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="S3.Thmtheorem1.p1.1.m1.3.3.1.1.1.1.1.1.1.2">𝜇</ci><ci id="S3.Thmtheorem1.p1.1.m1.3.3.1.1.1.1.1.1.1.3.cmml" xref="S3.Thmtheorem1.p1.1.m1.3.3.1.1.1.1.1.1.1.3">𝑧</ci></apply><ci id="S3.Thmtheorem1.p1.1.m1.1.1.cmml" xref="S3.Thmtheorem1.p1.1.m1.1.1">Σ</ci></interval></apply><apply id="S3.Thmtheorem1.p1.1.m1.4.4.2.2.2.2.cmml" xref="S3.Thmtheorem1.p1.1.m1.4.4.2.2.2.2"><times id="S3.Thmtheorem1.p1.1.m1.4.4.2.2.2.2.2.cmml" xref="S3.Thmtheorem1.p1.1.m1.4.4.2.2.2.2.2"></times><ci id="S3.Thmtheorem1.p1.1.m1.4.4.2.2.2.2.3.cmml" xref="S3.Thmtheorem1.p1.1.m1.4.4.2.2.2.2.3">𝒩</ci><interval closure="open" id="S3.Thmtheorem1.p1.1.m1.4.4.2.2.2.2.1.2.cmml" xref="S3.Thmtheorem1.p1.1.m1.4.4.2.2.2.2.1.1"><apply id="S3.Thmtheorem1.p1.1.m1.4.4.2.2.2.2.1.1.1.cmml" xref="S3.Thmtheorem1.p1.1.m1.4.4.2.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.Thmtheorem1.p1.1.m1.4.4.2.2.2.2.1.1.1.1.cmml" xref="S3.Thmtheorem1.p1.1.m1.4.4.2.2.2.2.1.1.1">subscript</csymbol><ci id="S3.Thmtheorem1.p1.1.m1.4.4.2.2.2.2.1.1.1.2.cmml" xref="S3.Thmtheorem1.p1.1.m1.4.4.2.2.2.2.1.1.1.2">𝜇</ci><apply id="S3.Thmtheorem1.p1.1.m1.4.4.2.2.2.2.1.1.1.3.cmml" xref="S3.Thmtheorem1.p1.1.m1.4.4.2.2.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.Thmtheorem1.p1.1.m1.4.4.2.2.2.2.1.1.1.3.1.cmml" xref="S3.Thmtheorem1.p1.1.m1.4.4.2.2.2.2.1.1.1.3">superscript</csymbol><ci id="S3.Thmtheorem1.p1.1.m1.4.4.2.2.2.2.1.1.1.3.2.cmml" xref="S3.Thmtheorem1.p1.1.m1.4.4.2.2.2.2.1.1.1.3.2">𝑧</ci><ci id="S3.Thmtheorem1.p1.1.m1.4.4.2.2.2.2.1.1.1.3.3.cmml" xref="S3.Thmtheorem1.p1.1.m1.4.4.2.2.2.2.1.1.1.3.3">′</ci></apply></apply><ci id="S3.Thmtheorem1.p1.1.m1.2.2.cmml" xref="S3.Thmtheorem1.p1.1.m1.2.2">Σ</ci></interval></apply></interval></apply><apply id="S3.Thmtheorem1.p1.1.m1.5.5.3.2.cmml" xref="S3.Thmtheorem1.p1.1.m1.5.5.3.1"><csymbol cd="latexml" id="S3.Thmtheorem1.p1.1.m1.5.5.3.2.1.cmml" xref="S3.Thmtheorem1.p1.1.m1.5.5.3.1.2">norm</csymbol><apply id="S3.Thmtheorem1.p1.1.m1.5.5.3.1.1.cmml" xref="S3.Thmtheorem1.p1.1.m1.5.5.3.1.1"><minus id="S3.Thmtheorem1.p1.1.m1.5.5.3.1.1.1.cmml" xref="S3.Thmtheorem1.p1.1.m1.5.5.3.1.1.1"></minus><apply id="S3.Thmtheorem1.p1.1.m1.5.5.3.1.1.2.cmml" xref="S3.Thmtheorem1.p1.1.m1.5.5.3.1.1.2"><csymbol cd="ambiguous" id="S3.Thmtheorem1.p1.1.m1.5.5.3.1.1.2.1.cmml" xref="S3.Thmtheorem1.p1.1.m1.5.5.3.1.1.2">subscript</csymbol><ci id="S3.Thmtheorem1.p1.1.m1.5.5.3.1.1.2.2.cmml" xref="S3.Thmtheorem1.p1.1.m1.5.5.3.1.1.2.2">𝜇</ci><ci id="S3.Thmtheorem1.p1.1.m1.5.5.3.1.1.2.3.cmml" xref="S3.Thmtheorem1.p1.1.m1.5.5.3.1.1.2.3">𝑧</ci></apply><apply id="S3.Thmtheorem1.p1.1.m1.5.5.3.1.1.3.cmml" xref="S3.Thmtheorem1.p1.1.m1.5.5.3.1.1.3"><csymbol cd="ambiguous" id="S3.Thmtheorem1.p1.1.m1.5.5.3.1.1.3.1.cmml" xref="S3.Thmtheorem1.p1.1.m1.5.5.3.1.1.3">subscript</csymbol><ci id="S3.Thmtheorem1.p1.1.m1.5.5.3.1.1.3.2.cmml" xref="S3.Thmtheorem1.p1.1.m1.5.5.3.1.1.3.2">𝜇</ci><apply id="S3.Thmtheorem1.p1.1.m1.5.5.3.1.1.3.3.cmml" xref="S3.Thmtheorem1.p1.1.m1.5.5.3.1.1.3.3"><csymbol cd="ambiguous" id="S3.Thmtheorem1.p1.1.m1.5.5.3.1.1.3.3.1.cmml" xref="S3.Thmtheorem1.p1.1.m1.5.5.3.1.1.3.3">superscript</csymbol><ci id="S3.Thmtheorem1.p1.1.m1.5.5.3.1.1.3.3.2.cmml" xref="S3.Thmtheorem1.p1.1.m1.5.5.3.1.1.3.3.2">𝑧</ci><ci id="S3.Thmtheorem1.p1.1.m1.5.5.3.1.1.3.3.3.cmml" xref="S3.Thmtheorem1.p1.1.m1.5.5.3.1.1.3.3.3">′</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmtheorem1.p1.1.m1.5c">\mathrm{EMD}({\mathcal{N}}(\mu_{z},\Sigma),{\mathcal{N}}(\mu_{z^{\prime}},%
\Sigma))=\|\mu_{z}-\mu_{z^{\prime}}\|</annotation><annotation encoding="application/x-llamapun" id="S3.Thmtheorem1.p1.1.m1.5d">roman_EMD ( caligraphic_N ( italic_μ start_POSTSUBSCRIPT italic_z end_POSTSUBSCRIPT , roman_Σ ) , caligraphic_N ( italic_μ start_POSTSUBSCRIPT italic_z start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT end_POSTSUBSCRIPT , roman_Σ ) ) = ∥ italic_μ start_POSTSUBSCRIPT italic_z end_POSTSUBSCRIPT - italic_μ start_POSTSUBSCRIPT italic_z start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT end_POSTSUBSCRIPT ∥</annotation></semantics></math><span class="ltx_text ltx_font_italic" id="S3.Thmtheorem1.p1.1.1">.</span></p>
</div>
</div>
<div class="ltx_para" id="S3.SS1.p3">
<p class="ltx_p" id="S3.SS1.p3.4">Although EMD has many appealing properties, the computational cost of EMD is high, where the time complexity of linear programming is cubic time with respect to the data size. Many following work provides approximation methods to reduce the computational cost, such as Sinkhorn <cite class="ltx_cite ltx_citemacro_citep">(Cuturi, <a class="ltx_ref" href="https://arxiv.org/html/2410.03052v1#bib.bib7" title="">2013</a>)</cite>, Sliced Wasserstein Distance (SWD) <cite class="ltx_cite ltx_citemacro_citep">(Bonneel et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03052v1#bib.bib5" title="">2015</a>)</cite>, Tree Wasserstein Distance (TWD) <cite class="ltx_cite ltx_citemacro_citep">(Yamada et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03052v1#bib.bib38" title="">2022</a>; Le et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03052v1#bib.bib24" title="">2019</a>; Takezawa et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03052v1#bib.bib35" title="">2021</a>)</cite>, and FlowTree (FT) <cite class="ltx_cite ltx_citemacro_citep">(Backurs et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03052v1#bib.bib1" title="">2020</a>)</cite> (detailed discussion of approximation methods in App.<a class="ltx_ref" href="https://arxiv.org/html/2410.03052v1#A1" title="Appendix A Approximation Methods of Earth Mover’s Distance ‣ Learning Structured Representations by Embedding Class Hierarchy with Fast Optimal Transport"><span class="ltx_text ltx_ref_tag">A</span></a>). Similarly, we can replace <math alttext="\rho" class="ltx_Math" display="inline" id="S3.SS1.p3.1.m1.1"><semantics id="S3.SS1.p3.1.m1.1a"><mi id="S3.SS1.p3.1.m1.1.1" xref="S3.SS1.p3.1.m1.1.1.cmml">ρ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.1.m1.1b"><ci id="S3.SS1.p3.1.m1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1">𝜌</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.1.m1.1c">\rho</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.1.m1.1d">italic_ρ</annotation></semantics></math> with all other EMD approximation methods, and we call all of them as the <span class="ltx_text ltx_font_bold" id="S3.SS1.p3.4.1">OT-CPCC family</span>. As a side remark, since all approximation methods provide a <math alttext="{\bm{P}}" class="ltx_Math" display="inline" id="S3.SS1.p3.2.m2.1"><semantics id="S3.SS1.p3.2.m2.1a"><mi id="S3.SS1.p3.2.m2.1.1" xref="S3.SS1.p3.2.m2.1.1.cmml">𝑷</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.2.m2.1b"><ci id="S3.SS1.p3.2.m2.1.1.cmml" xref="S3.SS1.p3.2.m2.1.1">𝑷</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.2.m2.1c">{\bm{P}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.2.m2.1d">bold_italic_P</annotation></semantics></math> satisfying constraints in Eq.<a class="ltx_ref" href="https://arxiv.org/html/2410.03052v1#S2.E3" title="Equation 3 ‣ 2.2 Exact Earth Mover’s Distance ‣ 2 Preliminaries ‣ Learning Structured Representations by Embedding Class Hierarchy with Fast Optimal Transport"><span class="ltx_text ltx_ref_tag">3</span></a> and since EMD is lower bounded by <math alttext="\ell_{2}" class="ltx_Math" display="inline" id="S3.SS1.p3.3.m3.1"><semantics id="S3.SS1.p3.3.m3.1a"><msub id="S3.SS1.p3.3.m3.1.1" xref="S3.SS1.p3.3.m3.1.1.cmml"><mi id="S3.SS1.p3.3.m3.1.1.2" mathvariant="normal" xref="S3.SS1.p3.3.m3.1.1.2.cmml">ℓ</mi><mn id="S3.SS1.p3.3.m3.1.1.3" xref="S3.SS1.p3.3.m3.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.3.m3.1b"><apply id="S3.SS1.p3.3.m3.1.1.cmml" xref="S3.SS1.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.3.m3.1.1.1.cmml" xref="S3.SS1.p3.3.m3.1.1">subscript</csymbol><ci id="S3.SS1.p3.3.m3.1.1.2.cmml" xref="S3.SS1.p3.3.m3.1.1.2">ℓ</ci><cn id="S3.SS1.p3.3.m3.1.1.3.cmml" type="integer" xref="S3.SS1.p3.3.m3.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.3.m3.1c">\ell_{2}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.3.m3.1d">roman_ℓ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math> (see proof of Prop.<a class="ltx_ref" href="https://arxiv.org/html/2410.03052v1#S3.Thmtheorem1" title="Proposition 3.1 (EMD reduces to ℓ₂ for Gaussians with same covariance). ‣ 3.1 OT-CPCC Family ‣ 3 CPCC with Optimal Transport ‣ Learning Structured Representations by Embedding Class Hierarchy with Fast Optimal Transport"><span class="ltx_text ltx_ref_tag">3.1</span></a> in App.<a class="ltx_ref" href="https://arxiv.org/html/2410.03052v1#A2" title="Appendix B EMD-CPCC Generalizes ℓ₂-CPCC ‣ Learning Structured Representations by Embedding Class Hierarchy with Fast Optimal Transport"><span class="ltx_text ltx_ref_tag">B</span></a>), all OT-CPCC methods are still lower bounded by <math alttext="\ell_{2}" class="ltx_Math" display="inline" id="S3.SS1.p3.4.m4.1"><semantics id="S3.SS1.p3.4.m4.1a"><msub id="S3.SS1.p3.4.m4.1.1" xref="S3.SS1.p3.4.m4.1.1.cmml"><mi id="S3.SS1.p3.4.m4.1.1.2" mathvariant="normal" xref="S3.SS1.p3.4.m4.1.1.2.cmml">ℓ</mi><mn id="S3.SS1.p3.4.m4.1.1.3" xref="S3.SS1.p3.4.m4.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.4.m4.1b"><apply id="S3.SS1.p3.4.m4.1.1.cmml" xref="S3.SS1.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.4.m4.1.1.1.cmml" xref="S3.SS1.p3.4.m4.1.1">subscript</csymbol><ci id="S3.SS1.p3.4.m4.1.1.2.cmml" xref="S3.SS1.p3.4.m4.1.1.2">ℓ</ci><cn id="S3.SS1.p3.4.m4.1.1.3.cmml" type="integer" xref="S3.SS1.p3.4.m4.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.4.m4.1c">\ell_{2}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.4.m4.1d">roman_ℓ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Fast FlowTree</h3>
<section class="ltx_paragraph" id="S3.SS2.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">FlowTree</h4>
<div class="ltx_para" id="S3.SS2.SSS0.Px1.p1">
<p class="ltx_p" id="S3.SS2.SSS0.Px1.p1.6"><cite class="ltx_cite ltx_citemacro_citep">(Backurs et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03052v1#bib.bib1" title="">2020</a>)</cite> is a tree-based method where the structure of the tree <math alttext="{\mathcal{T}}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p1.1.m1.1"><semantics id="S3.SS2.SSS0.Px1.p1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS0.Px1.p1.1.m1.1.1" xref="S3.SS2.SSS0.Px1.p1.1.m1.1.1.cmml">𝒯</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p1.1.m1.1b"><ci id="S3.SS2.SSS0.Px1.p1.1.m1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.1.m1.1.1">𝒯</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p1.1.m1.1c">{\mathcal{T}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p1.1.m1.1d">caligraphic_T</annotation></semantics></math> is learned using QuadTree <cite class="ltx_cite ltx_citemacro_citep">(Samet, <a class="ltx_ref" href="https://arxiv.org/html/2410.03052v1#bib.bib31" title="">1984</a>)</cite> to approximate the Euclidean space. Once the tree has been built, it firsts compute the optimal flow matrix <math alttext="{\bm{P}}_{t}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p1.2.m2.1"><semantics id="S3.SS2.SSS0.Px1.p1.2.m2.1a"><msub id="S3.SS2.SSS0.Px1.p1.2.m2.1.1" xref="S3.SS2.SSS0.Px1.p1.2.m2.1.1.cmml"><mi id="S3.SS2.SSS0.Px1.p1.2.m2.1.1.2" xref="S3.SS2.SSS0.Px1.p1.2.m2.1.1.2.cmml">𝑷</mi><mi id="S3.SS2.SSS0.Px1.p1.2.m2.1.1.3" xref="S3.SS2.SSS0.Px1.p1.2.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p1.2.m2.1b"><apply id="S3.SS2.SSS0.Px1.p1.2.m2.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.2.m2.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p1.2.m2.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p1.2.m2.1.1.2">𝑷</ci><ci id="S3.SS2.SSS0.Px1.p1.2.m2.1.1.3.cmml" xref="S3.SS2.SSS0.Px1.p1.2.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p1.2.m2.1c">{\bm{P}}_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p1.2.m2.1d">bold_italic_P start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> using <math alttext="t" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p1.3.m3.1"><semantics id="S3.SS2.SSS0.Px1.p1.3.m3.1a"><mi id="S3.SS2.SSS0.Px1.p1.3.m3.1.1" xref="S3.SS2.SSS0.Px1.p1.3.m3.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p1.3.m3.1b"><ci id="S3.SS2.SSS0.Px1.p1.3.m3.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.3.m3.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p1.3.m3.1c">t</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p1.3.m3.1d">italic_t</annotation></semantics></math> as the ground metric with a linear time bottom-up as shown in Alg.<a class="ltx_ref" href="https://arxiv.org/html/2410.03052v1#alg2" title="Algorithm 2 ‣ 2.2 Exact Earth Mover’s Distance ‣ 2 Preliminaries ‣ Learning Structured Representations by Embedding Class Hierarchy with Fast Optimal Transport"><span class="ltx_text ltx_ref_tag">2</span></a> <cite class="ltx_cite ltx_citemacro_citep">(Kalantari and Kalantari, <a class="ltx_ref" href="https://arxiv.org/html/2410.03052v1#bib.bib21" title="">1995</a>)</cite> (see App.Fig.<a class="ltx_ref" href="https://arxiv.org/html/2410.03052v1#A3.F8" title="Figure 8 ‣ Appendix C Details for Fast Flow Tree CPCC Algorithm ‣ Learning Structured Representations by Embedding Class Hierarchy with Fast Optimal Transport"><span class="ltx_text ltx_ref_tag">8</span></a> in for visualization). Then, it estimates EMD with <math alttext="\langle{\bm{P}}_{t},{\bm{D}}_{\text{$\ell_{2}$}}\rangle" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p1.4.m4.3"><semantics id="S3.SS2.SSS0.Px1.p1.4.m4.3a"><mrow id="S3.SS2.SSS0.Px1.p1.4.m4.3.3.2" xref="S3.SS2.SSS0.Px1.p1.4.m4.3.3.3.cmml"><mo id="S3.SS2.SSS0.Px1.p1.4.m4.3.3.2.3" stretchy="false" xref="S3.SS2.SSS0.Px1.p1.4.m4.3.3.3.cmml">⟨</mo><msub id="S3.SS2.SSS0.Px1.p1.4.m4.2.2.1.1" xref="S3.SS2.SSS0.Px1.p1.4.m4.2.2.1.1.cmml"><mi id="S3.SS2.SSS0.Px1.p1.4.m4.2.2.1.1.2" xref="S3.SS2.SSS0.Px1.p1.4.m4.2.2.1.1.2.cmml">𝑷</mi><mi id="S3.SS2.SSS0.Px1.p1.4.m4.2.2.1.1.3" xref="S3.SS2.SSS0.Px1.p1.4.m4.2.2.1.1.3.cmml">t</mi></msub><mo id="S3.SS2.SSS0.Px1.p1.4.m4.3.3.2.4" xref="S3.SS2.SSS0.Px1.p1.4.m4.3.3.3.cmml">,</mo><msub id="S3.SS2.SSS0.Px1.p1.4.m4.3.3.2.2" xref="S3.SS2.SSS0.Px1.p1.4.m4.3.3.2.2.cmml"><mi id="S3.SS2.SSS0.Px1.p1.4.m4.3.3.2.2.2" xref="S3.SS2.SSS0.Px1.p1.4.m4.3.3.2.2.2.cmml">𝑫</mi><msub id="S3.SS2.SSS0.Px1.p1.4.m4.1.1.1" xref="S3.SS2.SSS0.Px1.p1.4.m4.1.1.1.cmml"><mi id="S3.SS2.SSS0.Px1.p1.4.m4.1.1.1.3" mathvariant="normal" xref="S3.SS2.SSS0.Px1.p1.4.m4.1.1.1.3.cmml">ℓ</mi><mn id="S3.SS2.SSS0.Px1.p1.4.m4.1.1.1.4" mathsize="98%" xref="S3.SS2.SSS0.Px1.p1.4.m4.1.1.1.4.cmml">2</mn></msub></msub><mo id="S3.SS2.SSS0.Px1.p1.4.m4.3.3.2.5" stretchy="false" xref="S3.SS2.SSS0.Px1.p1.4.m4.3.3.3.cmml">⟩</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p1.4.m4.3b"><list id="S3.SS2.SSS0.Px1.p1.4.m4.3.3.3.cmml" xref="S3.SS2.SSS0.Px1.p1.4.m4.3.3.2"><apply id="S3.SS2.SSS0.Px1.p1.4.m4.2.2.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.4.m4.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.4.m4.2.2.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.4.m4.2.2.1.1">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p1.4.m4.2.2.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p1.4.m4.2.2.1.1.2">𝑷</ci><ci id="S3.SS2.SSS0.Px1.p1.4.m4.2.2.1.1.3.cmml" xref="S3.SS2.SSS0.Px1.p1.4.m4.2.2.1.1.3">𝑡</ci></apply><apply id="S3.SS2.SSS0.Px1.p1.4.m4.3.3.2.2.cmml" xref="S3.SS2.SSS0.Px1.p1.4.m4.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.4.m4.3.3.2.2.1.cmml" xref="S3.SS2.SSS0.Px1.p1.4.m4.3.3.2.2">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p1.4.m4.3.3.2.2.2.cmml" xref="S3.SS2.SSS0.Px1.p1.4.m4.3.3.2.2.2">𝑫</ci><apply id="S3.SS2.SSS0.Px1.p1.4.m4.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.4.m4.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.4.m4.1.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p1.4.m4.1.1.1">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p1.4.m4.1.1.1.3.cmml" xref="S3.SS2.SSS0.Px1.p1.4.m4.1.1.1.3">ℓ</ci><cn id="S3.SS2.SSS0.Px1.p1.4.m4.1.1.1.4.cmml" type="integer" xref="S3.SS2.SSS0.Px1.p1.4.m4.1.1.1.4">2</cn></apply></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p1.4.m4.3c">\langle{\bm{P}}_{t},{\bm{D}}_{\text{$\ell_{2}$}}\rangle</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p1.4.m4.3d">⟨ bold_italic_P start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , bold_italic_D start_POSTSUBSCRIPT roman_ℓ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ⟩</annotation></semantics></math>. Given the tree, the time complexity of computing the FT is <math alttext="O((m+n)d\log(d\Phi))" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p1.5.m5.2"><semantics id="S3.SS2.SSS0.Px1.p1.5.m5.2a"><mrow id="S3.SS2.SSS0.Px1.p1.5.m5.2.2" xref="S3.SS2.SSS0.Px1.p1.5.m5.2.2.cmml"><mi id="S3.SS2.SSS0.Px1.p1.5.m5.2.2.3" xref="S3.SS2.SSS0.Px1.p1.5.m5.2.2.3.cmml">O</mi><mo id="S3.SS2.SSS0.Px1.p1.5.m5.2.2.2" xref="S3.SS2.SSS0.Px1.p1.5.m5.2.2.2.cmml">⁢</mo><mrow id="S3.SS2.SSS0.Px1.p1.5.m5.2.2.1.1" xref="S3.SS2.SSS0.Px1.p1.5.m5.2.2.1.1.1.cmml"><mo id="S3.SS2.SSS0.Px1.p1.5.m5.2.2.1.1.2" stretchy="false" xref="S3.SS2.SSS0.Px1.p1.5.m5.2.2.1.1.1.cmml">(</mo><mrow id="S3.SS2.SSS0.Px1.p1.5.m5.2.2.1.1.1" xref="S3.SS2.SSS0.Px1.p1.5.m5.2.2.1.1.1.cmml"><mrow id="S3.SS2.SSS0.Px1.p1.5.m5.2.2.1.1.1.1.1" xref="S3.SS2.SSS0.Px1.p1.5.m5.2.2.1.1.1.1.1.1.cmml"><mo id="S3.SS2.SSS0.Px1.p1.5.m5.2.2.1.1.1.1.1.2" stretchy="false" xref="S3.SS2.SSS0.Px1.p1.5.m5.2.2.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.SSS0.Px1.p1.5.m5.2.2.1.1.1.1.1.1" xref="S3.SS2.SSS0.Px1.p1.5.m5.2.2.1.1.1.1.1.1.cmml"><mi id="S3.SS2.SSS0.Px1.p1.5.m5.2.2.1.1.1.1.1.1.2" xref="S3.SS2.SSS0.Px1.p1.5.m5.2.2.1.1.1.1.1.1.2.cmml">m</mi><mo id="S3.SS2.SSS0.Px1.p1.5.m5.2.2.1.1.1.1.1.1.1" xref="S3.SS2.SSS0.Px1.p1.5.m5.2.2.1.1.1.1.1.1.1.cmml">+</mo><mi id="S3.SS2.SSS0.Px1.p1.5.m5.2.2.1.1.1.1.1.1.3" xref="S3.SS2.SSS0.Px1.p1.5.m5.2.2.1.1.1.1.1.1.3.cmml">n</mi></mrow><mo id="S3.SS2.SSS0.Px1.p1.5.m5.2.2.1.1.1.1.1.3" stretchy="false" xref="S3.SS2.SSS0.Px1.p1.5.m5.2.2.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.SS2.SSS0.Px1.p1.5.m5.2.2.1.1.1.3" xref="S3.SS2.SSS0.Px1.p1.5.m5.2.2.1.1.1.3.cmml">⁢</mo><mi id="S3.SS2.SSS0.Px1.p1.5.m5.2.2.1.1.1.4" xref="S3.SS2.SSS0.Px1.p1.5.m5.2.2.1.1.1.4.cmml">d</mi><mo id="S3.SS2.SSS0.Px1.p1.5.m5.2.2.1.1.1.3a" lspace="0.167em" xref="S3.SS2.SSS0.Px1.p1.5.m5.2.2.1.1.1.3.cmml">⁢</mo><mrow id="S3.SS2.SSS0.Px1.p1.5.m5.2.2.1.1.1.2.1" xref="S3.SS2.SSS0.Px1.p1.5.m5.2.2.1.1.1.2.2.cmml"><mi id="S3.SS2.SSS0.Px1.p1.5.m5.1.1" xref="S3.SS2.SSS0.Px1.p1.5.m5.1.1.cmml">log</mi><mo id="S3.SS2.SSS0.Px1.p1.5.m5.2.2.1.1.1.2.1a" xref="S3.SS2.SSS0.Px1.p1.5.m5.2.2.1.1.1.2.2.cmml">⁡</mo><mrow id="S3.SS2.SSS0.Px1.p1.5.m5.2.2.1.1.1.2.1.1" xref="S3.SS2.SSS0.Px1.p1.5.m5.2.2.1.1.1.2.2.cmml"><mo id="S3.SS2.SSS0.Px1.p1.5.m5.2.2.1.1.1.2.1.1.2" stretchy="false" xref="S3.SS2.SSS0.Px1.p1.5.m5.2.2.1.1.1.2.2.cmml">(</mo><mrow id="S3.SS2.SSS0.Px1.p1.5.m5.2.2.1.1.1.2.1.1.1" xref="S3.SS2.SSS0.Px1.p1.5.m5.2.2.1.1.1.2.1.1.1.cmml"><mi id="S3.SS2.SSS0.Px1.p1.5.m5.2.2.1.1.1.2.1.1.1.2" xref="S3.SS2.SSS0.Px1.p1.5.m5.2.2.1.1.1.2.1.1.1.2.cmml">d</mi><mo id="S3.SS2.SSS0.Px1.p1.5.m5.2.2.1.1.1.2.1.1.1.1" xref="S3.SS2.SSS0.Px1.p1.5.m5.2.2.1.1.1.2.1.1.1.1.cmml">⁢</mo><mi id="S3.SS2.SSS0.Px1.p1.5.m5.2.2.1.1.1.2.1.1.1.3" mathvariant="normal" xref="S3.SS2.SSS0.Px1.p1.5.m5.2.2.1.1.1.2.1.1.1.3.cmml">Φ</mi></mrow><mo id="S3.SS2.SSS0.Px1.p1.5.m5.2.2.1.1.1.2.1.1.3" stretchy="false" xref="S3.SS2.SSS0.Px1.p1.5.m5.2.2.1.1.1.2.2.cmml">)</mo></mrow></mrow></mrow><mo id="S3.SS2.SSS0.Px1.p1.5.m5.2.2.1.1.3" stretchy="false" xref="S3.SS2.SSS0.Px1.p1.5.m5.2.2.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p1.5.m5.2b"><apply id="S3.SS2.SSS0.Px1.p1.5.m5.2.2.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.2.2"><times id="S3.SS2.SSS0.Px1.p1.5.m5.2.2.2.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.2.2.2"></times><ci id="S3.SS2.SSS0.Px1.p1.5.m5.2.2.3.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.2.2.3">𝑂</ci><apply id="S3.SS2.SSS0.Px1.p1.5.m5.2.2.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.2.2.1.1"><times id="S3.SS2.SSS0.Px1.p1.5.m5.2.2.1.1.1.3.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.2.2.1.1.1.3"></times><apply id="S3.SS2.SSS0.Px1.p1.5.m5.2.2.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.2.2.1.1.1.1.1"><plus id="S3.SS2.SSS0.Px1.p1.5.m5.2.2.1.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.2.2.1.1.1.1.1.1.1"></plus><ci id="S3.SS2.SSS0.Px1.p1.5.m5.2.2.1.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.2.2.1.1.1.1.1.1.2">𝑚</ci><ci id="S3.SS2.SSS0.Px1.p1.5.m5.2.2.1.1.1.1.1.1.3.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.2.2.1.1.1.1.1.1.3">𝑛</ci></apply><ci id="S3.SS2.SSS0.Px1.p1.5.m5.2.2.1.1.1.4.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.2.2.1.1.1.4">𝑑</ci><apply id="S3.SS2.SSS0.Px1.p1.5.m5.2.2.1.1.1.2.2.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.2.2.1.1.1.2.1"><log id="S3.SS2.SSS0.Px1.p1.5.m5.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.1.1"></log><apply id="S3.SS2.SSS0.Px1.p1.5.m5.2.2.1.1.1.2.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.2.2.1.1.1.2.1.1.1"><times id="S3.SS2.SSS0.Px1.p1.5.m5.2.2.1.1.1.2.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.2.2.1.1.1.2.1.1.1.1"></times><ci id="S3.SS2.SSS0.Px1.p1.5.m5.2.2.1.1.1.2.1.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.2.2.1.1.1.2.1.1.1.2">𝑑</ci><ci id="S3.SS2.SSS0.Px1.p1.5.m5.2.2.1.1.1.2.1.1.1.3.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.2.2.1.1.1.2.1.1.1.3">Φ</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p1.5.m5.2c">O((m+n)d\log(d\Phi))</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p1.5.m5.2d">italic_O ( ( italic_m + italic_n ) italic_d roman_log ( italic_d roman_Φ ) )</annotation></semantics></math> where <math alttext="\Phi" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p1.6.m6.1"><semantics id="S3.SS2.SSS0.Px1.p1.6.m6.1a"><mi id="S3.SS2.SSS0.Px1.p1.6.m6.1.1" mathvariant="normal" xref="S3.SS2.SSS0.Px1.p1.6.m6.1.1.cmml">Φ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p1.6.m6.1b"><ci id="S3.SS2.SSS0.Px1.p1.6.m6.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.6.m6.1.1">Φ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p1.6.m6.1c">\Phi</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p1.6.m6.1d">roman_Φ</annotation></semantics></math> is the maximum Euclidean distance of any two feature vectors.</p>
</div>
</section>
<section class="ltx_paragraph" id="S3.SS2.SSS0.Px2">
<h4 class="ltx_title ltx_title_paragraph">Our Fast FlowTree</h4>
<div class="ltx_para" id="S3.SS2.SSS0.Px2.p1">
<p class="ltx_p" id="S3.SS2.SSS0.Px2.p1.5">The main computational bottleneck of FT is the construction of the tree. However, in our case, we have access to <math alttext="{\mathcal{T}}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px2.p1.1.m1.1"><semantics id="S3.SS2.SSS0.Px2.p1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS0.Px2.p1.1.m1.1.1" xref="S3.SS2.SSS0.Px2.p1.1.m1.1.1.cmml">𝒯</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p1.1.m1.1b"><ci id="S3.SS2.SSS0.Px2.p1.1.m1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p1.1.m1.1.1">𝒯</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p1.1.m1.1c">{\mathcal{T}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px2.p1.1.m1.1d">caligraphic_T</annotation></semantics></math> given as prior knowledge, and thus we can skip the tree construction step. To apply tree-based EMD approximation methods, instead of building a QuadTree in FT, we first construct an <em class="ltx_emph ltx_font_italic" id="S3.SS2.SSS0.Px2.p1.5.1">augmented tree</em> by extending the leaves of the original label tree <math alttext="{\mathcal{T}}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px2.p1.2.m2.1"><semantics id="S3.SS2.SSS0.Px2.p1.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS0.Px2.p1.2.m2.1.1" xref="S3.SS2.SSS0.Px2.p1.2.m2.1.1.cmml">𝒯</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p1.2.m2.1b"><ci id="S3.SS2.SSS0.Px2.p1.2.m2.1.1.cmml" xref="S3.SS2.SSS0.Px2.p1.2.m2.1.1">𝒯</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p1.2.m2.1c">{\mathcal{T}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px2.p1.2.m2.1d">caligraphic_T</annotation></semantics></math> with samples. Specifically, since each leaf node in <math alttext="{\mathcal{T}}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px2.p1.3.m3.1"><semantics id="S3.SS2.SSS0.Px2.p1.3.m3.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS0.Px2.p1.3.m3.1.1" xref="S3.SS2.SSS0.Px2.p1.3.m3.1.1.cmml">𝒯</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p1.3.m3.1b"><ci id="S3.SS2.SSS0.Px2.p1.3.m3.1.1.cmml" xref="S3.SS2.SSS0.Px2.p1.3.m3.1.1">𝒯</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p1.3.m3.1c">{\mathcal{T}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px2.p1.3.m3.1d">caligraphic_T</annotation></semantics></math> corresponds to a class, we extend each leaf node by adding all samples from the corresponding class, as demonstrated in <a class="ltx_ref" href="https://arxiv.org/html/2410.03052v1#S3.F2" title="In Our Fast FlowTree ‣ 3.2 Fast FlowTree ‣ 3 CPCC with Optimal Transport ‣ Learning Structured Representations by Embedding Class Hierarchy with Fast Optimal Transport"><span class="ltx_text ltx_ref_tag">Figure</span> <span class="ltx_text ltx_ref_tag">2</span></a>. We set all extended edges to have edge weight <math alttext="1" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px2.p1.4.m4.1"><semantics id="S3.SS2.SSS0.Px2.p1.4.m4.1a"><mn id="S3.SS2.SSS0.Px2.p1.4.m4.1.1" xref="S3.SS2.SSS0.Px2.p1.4.m4.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p1.4.m4.1b"><cn id="S3.SS2.SSS0.Px2.p1.4.m4.1.1.cmml" type="integer" xref="S3.SS2.SSS0.Px2.p1.4.m4.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p1.4.m4.1c">1</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px2.p1.4.m4.1d">1</annotation></semantics></math>, and assign the instance weight <math alttext="a_{i}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px2.p1.5.m5.1"><semantics id="S3.SS2.SSS0.Px2.p1.5.m5.1a"><msub id="S3.SS2.SSS0.Px2.p1.5.m5.1.1" xref="S3.SS2.SSS0.Px2.p1.5.m5.1.1.cmml"><mi id="S3.SS2.SSS0.Px2.p1.5.m5.1.1.2" xref="S3.SS2.SSS0.Px2.p1.5.m5.1.1.2.cmml">a</mi><mi id="S3.SS2.SSS0.Px2.p1.5.m5.1.1.3" xref="S3.SS2.SSS0.Px2.p1.5.m5.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p1.5.m5.1b"><apply id="S3.SS2.SSS0.Px2.p1.5.m5.1.1.cmml" xref="S3.SS2.SSS0.Px2.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p1.5.m5.1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p1.5.m5.1.1">subscript</csymbol><ci id="S3.SS2.SSS0.Px2.p1.5.m5.1.1.2.cmml" xref="S3.SS2.SSS0.Px2.p1.5.m5.1.1.2">𝑎</ci><ci id="S3.SS2.SSS0.Px2.p1.5.m5.1.1.3.cmml" xref="S3.SS2.SSS0.Px2.p1.5.m5.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p1.5.m5.1c">a_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px2.p1.5.m5.1d">italic_a start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> for each data point. The resulting algorithm that applies Alg.<a class="ltx_ref" href="https://arxiv.org/html/2410.03052v1#alg2" title="Algorithm 2 ‣ 2.2 Exact Earth Mover’s Distance ‣ 2 Preliminaries ‣ Learning Structured Representations by Embedding Class Hierarchy with Fast Optimal Transport"><span class="ltx_text ltx_ref_tag">2</span></a> to the <em class="ltx_emph ltx_font_italic" id="S3.SS2.SSS0.Px2.p1.5.2">augmented</em> label tree is called <span class="ltx_text ltx_font_bold" id="S3.SS2.SSS0.Px2.p1.5.3">Fast FlowTree</span> (FastFT).</p>
</div>
<div class="ltx_para" id="S3.SS2.SSS0.Px2.p2">
<p class="ltx_p" id="S3.SS2.SSS0.Px2.p2.3">One key insight that allows FastFT to be more efficient than FT is that the tree metric between any two data samples from different classes is always identical in the augmented tree <math alttext="{\mathcal{T}}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px2.p2.1.m1.1"><semantics id="S3.SS2.SSS0.Px2.p2.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS0.Px2.p2.1.m1.1.1" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.1.cmml">𝒯</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p2.1.m1.1b"><ci id="S3.SS2.SSS0.Px2.p2.1.m1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.1">𝒯</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p2.1.m1.1c">{\mathcal{T}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px2.p2.1.m1.1d">caligraphic_T</annotation></semantics></math>, which allows us to reduce the computation of <math alttext="{\bm{P}}_{t}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px2.p2.2.m2.1"><semantics id="S3.SS2.SSS0.Px2.p2.2.m2.1a"><msub id="S3.SS2.SSS0.Px2.p2.2.m2.1.1" xref="S3.SS2.SSS0.Px2.p2.2.m2.1.1.cmml"><mi id="S3.SS2.SSS0.Px2.p2.2.m2.1.1.2" xref="S3.SS2.SSS0.Px2.p2.2.m2.1.1.2.cmml">𝑷</mi><mi id="S3.SS2.SSS0.Px2.p2.2.m2.1.1.3" xref="S3.SS2.SSS0.Px2.p2.2.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p2.2.m2.1b"><apply id="S3.SS2.SSS0.Px2.p2.2.m2.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p2.2.m2.1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.SSS0.Px2.p2.2.m2.1.1.2.cmml" xref="S3.SS2.SSS0.Px2.p2.2.m2.1.1.2">𝑷</ci><ci id="S3.SS2.SSS0.Px2.p2.2.m2.1.1.3.cmml" xref="S3.SS2.SSS0.Px2.p2.2.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p2.2.m2.1c">{\bm{P}}_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px2.p2.2.m2.1d">bold_italic_P start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> to 1d OT greedy flow matching using Alg.<a class="ltx_ref" href="https://arxiv.org/html/2410.03052v1#alg1" title="Algorithm 1 ‣ 2.2 Exact Earth Mover’s Distance ‣ 2 Preliminaries ‣ Learning Structured Representations by Embedding Class Hierarchy with Fast Optimal Transport"><span class="ltx_text ltx_ref_tag">1</span></a>. The time complexity of FastFT is <math alttext="O((m+n)d)" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px2.p2.3.m3.1"><semantics id="S3.SS2.SSS0.Px2.p2.3.m3.1a"><mrow id="S3.SS2.SSS0.Px2.p2.3.m3.1.1" xref="S3.SS2.SSS0.Px2.p2.3.m3.1.1.cmml"><mi id="S3.SS2.SSS0.Px2.p2.3.m3.1.1.3" xref="S3.SS2.SSS0.Px2.p2.3.m3.1.1.3.cmml">O</mi><mo id="S3.SS2.SSS0.Px2.p2.3.m3.1.1.2" xref="S3.SS2.SSS0.Px2.p2.3.m3.1.1.2.cmml">⁢</mo><mrow id="S3.SS2.SSS0.Px2.p2.3.m3.1.1.1.1" xref="S3.SS2.SSS0.Px2.p2.3.m3.1.1.1.1.1.cmml"><mo id="S3.SS2.SSS0.Px2.p2.3.m3.1.1.1.1.2" stretchy="false" xref="S3.SS2.SSS0.Px2.p2.3.m3.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.SSS0.Px2.p2.3.m3.1.1.1.1.1" xref="S3.SS2.SSS0.Px2.p2.3.m3.1.1.1.1.1.cmml"><mrow id="S3.SS2.SSS0.Px2.p2.3.m3.1.1.1.1.1.1.1" xref="S3.SS2.SSS0.Px2.p2.3.m3.1.1.1.1.1.1.1.1.cmml"><mo id="S3.SS2.SSS0.Px2.p2.3.m3.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.SS2.SSS0.Px2.p2.3.m3.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.SSS0.Px2.p2.3.m3.1.1.1.1.1.1.1.1" xref="S3.SS2.SSS0.Px2.p2.3.m3.1.1.1.1.1.1.1.1.cmml"><mi id="S3.SS2.SSS0.Px2.p2.3.m3.1.1.1.1.1.1.1.1.2" xref="S3.SS2.SSS0.Px2.p2.3.m3.1.1.1.1.1.1.1.1.2.cmml">m</mi><mo id="S3.SS2.SSS0.Px2.p2.3.m3.1.1.1.1.1.1.1.1.1" xref="S3.SS2.SSS0.Px2.p2.3.m3.1.1.1.1.1.1.1.1.1.cmml">+</mo><mi id="S3.SS2.SSS0.Px2.p2.3.m3.1.1.1.1.1.1.1.1.3" xref="S3.SS2.SSS0.Px2.p2.3.m3.1.1.1.1.1.1.1.1.3.cmml">n</mi></mrow><mo id="S3.SS2.SSS0.Px2.p2.3.m3.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.SS2.SSS0.Px2.p2.3.m3.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.SS2.SSS0.Px2.p2.3.m3.1.1.1.1.1.2" xref="S3.SS2.SSS0.Px2.p2.3.m3.1.1.1.1.1.2.cmml">⁢</mo><mi id="S3.SS2.SSS0.Px2.p2.3.m3.1.1.1.1.1.3" xref="S3.SS2.SSS0.Px2.p2.3.m3.1.1.1.1.1.3.cmml">d</mi></mrow><mo id="S3.SS2.SSS0.Px2.p2.3.m3.1.1.1.1.3" stretchy="false" xref="S3.SS2.SSS0.Px2.p2.3.m3.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p2.3.m3.1b"><apply id="S3.SS2.SSS0.Px2.p2.3.m3.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.3.m3.1.1"><times id="S3.SS2.SSS0.Px2.p2.3.m3.1.1.2.cmml" xref="S3.SS2.SSS0.Px2.p2.3.m3.1.1.2"></times><ci id="S3.SS2.SSS0.Px2.p2.3.m3.1.1.3.cmml" xref="S3.SS2.SSS0.Px2.p2.3.m3.1.1.3">𝑂</ci><apply id="S3.SS2.SSS0.Px2.p2.3.m3.1.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.3.m3.1.1.1.1"><times id="S3.SS2.SSS0.Px2.p2.3.m3.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS0.Px2.p2.3.m3.1.1.1.1.1.2"></times><apply id="S3.SS2.SSS0.Px2.p2.3.m3.1.1.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.3.m3.1.1.1.1.1.1.1"><plus id="S3.SS2.SSS0.Px2.p2.3.m3.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.3.m3.1.1.1.1.1.1.1.1.1"></plus><ci id="S3.SS2.SSS0.Px2.p2.3.m3.1.1.1.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS0.Px2.p2.3.m3.1.1.1.1.1.1.1.1.2">𝑚</ci><ci id="S3.SS2.SSS0.Px2.p2.3.m3.1.1.1.1.1.1.1.1.3.cmml" xref="S3.SS2.SSS0.Px2.p2.3.m3.1.1.1.1.1.1.1.1.3">𝑛</ci></apply><ci id="S3.SS2.SSS0.Px2.p2.3.m3.1.1.1.1.1.3.cmml" xref="S3.SS2.SSS0.Px2.p2.3.m3.1.1.1.1.1.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p2.3.m3.1c">O((m+n)d)</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px2.p2.3.m3.1d">italic_O ( ( italic_m + italic_n ) italic_d )</annotation></semantics></math>, which is optimal among all OT variants.</p>
</div>
<div class="ltx_theorem ltx_theorem_theorem" id="S3.Thmtheorem2">
<h6 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span class="ltx_text ltx_font_bold" id="S3.Thmtheorem2.1.1.1">Theorem 3.2</span></span><span class="ltx_text ltx_font_bold" id="S3.Thmtheorem2.2.2"> </span>(Correctness of Fast FlowTree)<span class="ltx_text ltx_font_bold" id="S3.Thmtheorem2.3.3">.</span>
</h6>
<div class="ltx_para" id="S3.Thmtheorem2.p1">
