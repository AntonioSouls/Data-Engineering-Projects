<!DOCTYPE html>
<html lang="en" prefix="dcterms: http://purl.org/dc/terms/">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>Adjusting Pretrained Backbones for Performativity</title>
<!--Generated on Sun Oct  6 14:33:40 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<base href="/html/2410.04499v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#S1" title="In Adjusting Pretrained Backbones for Performativity"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#S1.SS1" title="In 1 Introduction ‣ Adjusting Pretrained Backbones for Performativity"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1.1 </span>Our work</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#S2" title="In Adjusting Pretrained Backbones for Performativity"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Background and related work</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#S3" title="In Adjusting Pretrained Backbones for Performativity"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Anticipating performativity</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#S3.SS0.SSS0.Px1" title="In 3 Anticipating performativity ‣ Adjusting Pretrained Backbones for Performativity"><span class="ltx_text ltx_ref_title">Problem setup.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#S3.SS0.SSS0.Px2" title="In 3 Anticipating performativity ‣ Adjusting Pretrained Backbones for Performativity"><span class="ltx_text ltx_ref_title">Practical challenges.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#S3.SS1" title="In 3 Anticipating performativity ‣ Adjusting Pretrained Backbones for Performativity"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>A modular adaptation architecture</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#S3.SS2" title="In 3 Anticipating performativity ‣ Adjusting Pretrained Backbones for Performativity"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>Anticipating performative label shifts</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#S3.SS2.SSS0.Px1" title="In 3.2 Anticipating performative label shifts ‣ 3 Anticipating performativity ‣ Adjusting Pretrained Backbones for Performativity"><span class="ltx_text ltx_ref_title">Dynamic benchmarking.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#S3.SS2.SSS0.Px2" title="In 3.2 Anticipating performative label shifts ‣ 3 Anticipating performativity ‣ Adjusting Pretrained Backbones for Performativity"><span class="ltx_text ltx_ref_title">Self-selection.</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#S3.SS3" title="In 3 Anticipating performativity ‣ Adjusting Pretrained Backbones for Performativity"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3 </span>Learning adapter module along the retraining trajectory</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#S3.SS3.SSS0.Px1" title="In 3.3 Learning adapter module along the retraining trajectory ‣ 3 Anticipating performativity ‣ Adjusting Pretrained Backbones for Performativity"><span class="ltx_text ltx_ref_title">End product.</span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#S4" title="In Adjusting Pretrained Backbones for Performativity"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Experiments</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#S4.SS0.SSS0.Px1" title="In 4 Experiments ‣ Adjusting Pretrained Backbones for Performativity"><span class="ltx_text ltx_ref_title">Baselines.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#S4.SS1" title="In 4 Experiments ‣ Adjusting Pretrained Backbones for Performativity"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Performative label shift</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#S4.SS1.SSS0.Px1" title="In 4.1 Performative label shift ‣ 4 Experiments ‣ Adjusting Pretrained Backbones for Performativity"><span class="ltx_text ltx_ref_title">Strength of performativity.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#S4.SS1.SSS0.Px2" title="In 4.1 Performative label shift ‣ 4 Experiments ‣ Adjusting Pretrained Backbones for Performativity"><span class="ltx_text ltx_ref_title">Evaluation metric.</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#S4.SS2" title="In 4 Experiments ‣ Adjusting Pretrained Backbones for Performativity"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>Empirical findings</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#S4.SS2.SSS0.Px1" title="In 4.2 Empirical findings ‣ 4 Experiments ‣ Adjusting Pretrained Backbones for Performativity"><span class="ltx_text ltx_ref_title">Retraining trajectory.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#S4.SS2.SSS0.Px2" title="In 4.2 Empirical findings ‣ 4 Experiments ‣ Adjusting Pretrained Backbones for Performativity"><span class="ltx_text ltx_ref_title">Modularity and zero-shot model updates.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#S4.SS2.SSS0.Px3" title="In 4.2 Empirical findings ‣ 4 Experiments ‣ Adjusting Pretrained Backbones for Performativity"><span class="ltx_text ltx_ref_title">Anticipating performativity.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#S4.SS2.SSS0.Px4" title="In 4.2 Empirical findings ‣ 4 Experiments ‣ Adjusting Pretrained Backbones for Performativity"><span class="ltx_text ltx_ref_title">Beyond label shift.</span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#S5" title="In Adjusting Pretrained Backbones for Performativity"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Conclusion</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#S5.SS0.SSS0.Px1" title="In 5 Conclusion ‣ Adjusting Pretrained Backbones for Performativity"><span class="ltx_text ltx_ref_title">Limitations and extensions.</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#A1" title="In Adjusting Pretrained Backbones for Performativity"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A </span>Appendix</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#A1.SS1" title="In Appendix A Appendix ‣ Adjusting Pretrained Backbones for Performativity"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.1 </span>Implementation Details</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#A1.SS2" title="In Appendix A Appendix ‣ Adjusting Pretrained Backbones for Performativity"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.2 </span>Additional Experimental Results</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#A1.SS2.SSS0.Px1" title="In A.2 Additional Experimental Results ‣ Appendix A Appendix ‣ Adjusting Pretrained Backbones for Performativity"><span class="ltx_text ltx_ref_title">Label shift on TerraIncognita dataset.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#A1.SS2.SSS0.Px2" title="In A.2 Additional Experimental Results ‣ Appendix A Appendix ‣ Adjusting Pretrained Backbones for Performativity"><span class="ltx_text ltx_ref_title">Training only the last linear layer does not improve model robustness to performative shift.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#A1.SS2.SSS0.Px3" title="In A.2 Additional Experimental Results ‣ Appendix A Appendix ‣ Adjusting Pretrained Backbones for Performativity"><span class="ltx_text ltx_ref_title">Varying training epochs on the current distribution for <span class="ltx_text ltx_font_italic">Oracle Fine-tuning</span> controls distribution bias incorporation.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#A1.SS2.SSS0.Px4" title="In A.2 Additional Experimental Results ‣ Appendix A Appendix ‣ Adjusting Pretrained Backbones for Performativity"><span class="ltx_text ltx_ref_title"><span class="ltx_text ltx_font_italic">PaP</span> is a lightweight adaptation module.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#A1.SS2.SSS0.Px5" title="In A.2 Additional Experimental Results ‣ Appendix A Appendix ‣ Adjusting Pretrained Backbones for Performativity"><span class="ltx_text ltx_ref_title"><span class="ltx_text ltx_font_italic">PaP</span> can be used for pre-deployment performance evaluation.</span></a></li>
</ol>
</li>
</ol>
</li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">
Adjusting Pretrained Backbones for Performativity
</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Berker Demirel
</span><span class="ltx_author_notes">equal contribution
<span class="ltx_contact ltx_role_affiliation">Institute of Science and Technology, Austria
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Lingjing Kong<sup class="ltx_sup" id="id2.2.id1">∗</sup>
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">Carnegie Mellon University
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Kun Zhang
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">Carnegie Mellon University
</span>
<span class="ltx_contact ltx_role_affiliation">Mohamed bin Zayed University of Artificial Intelligence
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Theofanis Karaletsos
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">Chan Zuckerberg Initiative
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Celestine Mendler-Dünner
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">Max Planck Institute for Intelligent Systems and Tübingen AI Center
</span>
<span class="ltx_contact ltx_role_affiliation">ELLIS Institute Tübingen
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Francesco Locatello
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">Institute of Science and Technology, Austria
</span></span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id3.id1">With the widespread deployment of deep learning models, they influence their environment in various ways. The induced distribution shifts can lead to unexpected performance degradation in deployed models. Existing methods to anticipate performativity typically incorporate information about the deployed model into the feature vector when predicting future outcomes. While enjoying appealing theoretical properties, modifying the input dimension of the prediction task is often not practical. To address this, we propose a novel technique to adjust pretrained backbones for performativity in a modular way, achieving better sample efficiency and enabling the reuse of existing deep learning assets. Focusing on performative label shift, the key idea is to train a shallow adapter module to perform a <em class="ltx_emph ltx_font_italic" id="id3.id1.1">Bayes-optimal</em> label shift correction to the backbone’s logits given a sufficient statistic of the model to be deployed. As such, our framework decouples the construction of input-specific feature embeddings from the mechanism governing performativity.
Motivated by dynamic benchmarking as a use-case, we evaluate our approach under adversarial sampling, for vision and language tasks. We show how it leads to smaller loss along the retraining trajectory and enables us to effectively select among candidate models to anticipate performance degradations. More broadly, our work provides a first baseline for addressing performativity in deep learning. Code is available at <a class="ltx_ref ltx_href" href="https://github.com/berkerdemirel/Adjusting-Pretrained-Backbones-for-Performativity" title="">https://github.com/berkerdemirel/Adjusting-Pretrained-Backbones-for-Performativity</a></p>
</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">Machine learning models have been experiencing a growing adoption for automated decision-making.
High-stake applications necessitate models to generalize beyond the training distribution and perform robustly over distribution shifts. A prevalent but often neglected cause of distribution shift is the model deployment itself. When informing down-stream decisions, and actions, the predictions of machine learning models can change future data.
Such patterns are ubiquitous in social settings, where algorithmic predictions impact individual expectations, steer consumer choices, or inform policy decisions. Similarly, standard community practices can lead to future data depending on the deployment of past models; this can be through data feedback-loops <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#bib.bib78" title="">78</a>]</cite>, active learning pipelines <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#bib.bib71" title="">71</a>]</cite>, and dynamic benchmarks <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#bib.bib61" title="">61</a>]</cite>. Performative prediction <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#bib.bib63" title="">63</a>]</cite> articulates how this causal link between predictions and future data surfaces as distribution shift in machine learning pipelines.</p>
</div>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">It is inevitable that repeatedly ad-hoc trained models become suboptimal after deployment under performativity <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#bib.bib45" title="">45</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#bib.bib66" title="">66</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#bib.bib79" title="">79</a>]</cite>. Thus, a natural question to ask is—can we learn to foresee these shifts?
Of course, in full generality performative shifts can be arbitrarily complex. However, given a low-dimensional sufficient statistic for the shift, <cite class="ltx_cite ltx_citemacro_citet">Mendler-Dünner et al. [<a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#bib.bib56" title="">56</a>]</cite> show that a data-driven approach can be successful in anticipating performativity. Once the relevant mechanism mapping the model statistic to the induced data is learnt, shifts can be anticipated and the performative prediction problem can be solved offline <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#bib.bib38" title="">38</a>]</cite>. While this approach is appealing theoretically, a demonstration of the practical feasibility in the regime of deep learning was still missing.</p>
</div>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">In particular, existing approaches <cite class="ltx_cite ltx_citemacro_citep">[e.g., <a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#bib.bib56" title="">56</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#bib.bib38" title="">38</a>]</cite> learn predictive models from scratch, assuming access to performativity-augmented datasets that contain statistics about the deployed model, in addition to feature-label pairs. In large-scale deep learning, this approach to anticipating performativity has two fundamental practical limitations. First, large-scale models are extremely data-hungry when trained from scratch, and performativity-augmented datasets are hard to gather and they are not yet widely available.
Second, existing pre-trained models only process raw features and they are not compatible with this paradigm, preventing the utilization of valuable data resources and existing open source models. In this work we provide the first practical approach to building performativity-aware deep learning models around pre-trained backbones.</p>
</div>
<figure class="ltx_figure" id="S1.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="166" id="S1.F1.g1" src="x1.png" width="664"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S1.F1.12.6.1" style="font-size:90%;">Figure 1</span>: </span><span class="ltx_text" id="S1.F1.10.5" style="font-size:90%;">Setup: In each round a model is deployed to make predictions <math alttext="\hat{Y}" class="ltx_Math" display="inline" id="S1.F1.6.1.m1.1"><semantics id="S1.F1.6.1.m1.1b"><mover accent="true" id="S1.F1.6.1.m1.1.1" xref="S1.F1.6.1.m1.1.1.cmml"><mi id="S1.F1.6.1.m1.1.1.2" xref="S1.F1.6.1.m1.1.1.2.cmml">Y</mi><mo id="S1.F1.6.1.m1.1.1.1" xref="S1.F1.6.1.m1.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S1.F1.6.1.m1.1c"><apply id="S1.F1.6.1.m1.1.1.cmml" xref="S1.F1.6.1.m1.1.1"><ci id="S1.F1.6.1.m1.1.1.1.cmml" xref="S1.F1.6.1.m1.1.1.1">^</ci><ci id="S1.F1.6.1.m1.1.1.2.cmml" xref="S1.F1.6.1.m1.1.1.2">𝑌</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.6.1.m1.1d">\hat{Y}</annotation><annotation encoding="application/x-llamapun" id="S1.F1.6.1.m1.1e">over^ start_ARG italic_Y end_ARG</annotation></semantics></math> over <math alttext="P_{t}" class="ltx_Math" display="inline" id="S1.F1.7.2.m2.1"><semantics id="S1.F1.7.2.m2.1b"><msub id="S1.F1.7.2.m2.1.1" xref="S1.F1.7.2.m2.1.1.cmml"><mi id="S1.F1.7.2.m2.1.1.2" xref="S1.F1.7.2.m2.1.1.2.cmml">P</mi><mi id="S1.F1.7.2.m2.1.1.3" xref="S1.F1.7.2.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S1.F1.7.2.m2.1c"><apply id="S1.F1.7.2.m2.1.1.cmml" xref="S1.F1.7.2.m2.1.1"><csymbol cd="ambiguous" id="S1.F1.7.2.m2.1.1.1.cmml" xref="S1.F1.7.2.m2.1.1">subscript</csymbol><ci id="S1.F1.7.2.m2.1.1.2.cmml" xref="S1.F1.7.2.m2.1.1.2">𝑃</ci><ci id="S1.F1.7.2.m2.1.1.3.cmml" xref="S1.F1.7.2.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.7.2.m2.1d">P_{t}</annotation><annotation encoding="application/x-llamapun" id="S1.F1.7.2.m2.1e">italic_P start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>. These predictions give rise to a new distribution <math alttext="P_{t+1}" class="ltx_Math" display="inline" id="S1.F1.8.3.m3.1"><semantics id="S1.F1.8.3.m3.1b"><msub id="S1.F1.8.3.m3.1.1" xref="S1.F1.8.3.m3.1.1.cmml"><mi id="S1.F1.8.3.m3.1.1.2" xref="S1.F1.8.3.m3.1.1.2.cmml">P</mi><mrow id="S1.F1.8.3.m3.1.1.3" xref="S1.F1.8.3.m3.1.1.3.cmml"><mi id="S1.F1.8.3.m3.1.1.3.2" xref="S1.F1.8.3.m3.1.1.3.2.cmml">t</mi><mo id="S1.F1.8.3.m3.1.1.3.1" xref="S1.F1.8.3.m3.1.1.3.1.cmml">+</mo><mn id="S1.F1.8.3.m3.1.1.3.3" xref="S1.F1.8.3.m3.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S1.F1.8.3.m3.1c"><apply id="S1.F1.8.3.m3.1.1.cmml" xref="S1.F1.8.3.m3.1.1"><csymbol cd="ambiguous" id="S1.F1.8.3.m3.1.1.1.cmml" xref="S1.F1.8.3.m3.1.1">subscript</csymbol><ci id="S1.F1.8.3.m3.1.1.2.cmml" xref="S1.F1.8.3.m3.1.1.2">𝑃</ci><apply id="S1.F1.8.3.m3.1.1.3.cmml" xref="S1.F1.8.3.m3.1.1.3"><plus id="S1.F1.8.3.m3.1.1.3.1.cmml" xref="S1.F1.8.3.m3.1.1.3.1"></plus><ci id="S1.F1.8.3.m3.1.1.3.2.cmml" xref="S1.F1.8.3.m3.1.1.3.2">𝑡</ci><cn id="S1.F1.8.3.m3.1.1.3.3.cmml" type="integer" xref="S1.F1.8.3.m3.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.8.3.m3.1d">P_{t+1}</annotation><annotation encoding="application/x-llamapun" id="S1.F1.8.3.m3.1e">italic_P start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT</annotation></semantics></math>. To achieve high accuracy after deployment, we equip existing backbones with an adapter module to build a performativity-aware predictor. The adapter module seeks to predict the next distribution based on the sufficient statistic <math alttext="S" class="ltx_Math" display="inline" id="S1.F1.9.4.m4.1"><semantics id="S1.F1.9.4.m4.1b"><mi id="S1.F1.9.4.m4.1.1" xref="S1.F1.9.4.m4.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S1.F1.9.4.m4.1c"><ci id="S1.F1.9.4.m4.1.1.cmml" xref="S1.F1.9.4.m4.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.9.4.m4.1d">S</annotation><annotation encoding="application/x-llamapun" id="S1.F1.9.4.m4.1e">italic_S</annotation></semantics></math> for the shift, and adjusts the predictions accordingly. Under performativity the <math alttext="S" class="ltx_Math" display="inline" id="S1.F1.10.5.m5.1"><semantics id="S1.F1.10.5.m5.1b"><mi id="S1.F1.10.5.m5.1.1" xref="S1.F1.10.5.m5.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S1.F1.10.5.m5.1c"><ci id="S1.F1.10.5.m5.1.1.cmml" xref="S1.F1.10.5.m5.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.10.5.m5.1d">S</annotation><annotation encoding="application/x-llamapun" id="S1.F1.10.5.m5.1e">italic_S</annotation></semantics></math> is a function of the deployed model.</span></figcaption>
</figure>
<section class="ltx_subsection" id="S1.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">1.1 </span>Our work</h3>
<div class="ltx_para" id="S1.SS1.p1">
<p class="ltx_p" id="S1.SS1.p1.1">We propose a pipeline to adjust deep learning predictions for performative label shift. This refers to a setting where the deployment of a model changes the class proportions in future rounds. This setting is particularly relevant for
vision and language tasks, where pretrained backbones prevail.
For instance, adaptive data collection <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#bib.bib73" title="">73</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#bib.bib61" title="">61</a>]</cite> and performance-dependent participation <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#bib.bib49" title="">49</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#bib.bib18" title="">18</a>]</cite> are instances of this problem which has been under ongoing investigation <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#bib.bib48" title="">48</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#bib.bib50" title="">50</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#bib.bib22" title="">22</a>]</cite>.</p>
</div>
<div class="ltx_para" id="S1.SS1.p2">
<p class="ltx_p" id="S1.SS1.p2.1">To anticipate performative label shift, we propose a modular framework to equip existing pre-trained models with a learnable adaptation module. The adaptation module takes the sufficient statistic for the shift, and the pretrained model’s intermediate representations as input and outputs adjusted predictions. In the concrete instantiation of performative label shift, the adaptation module learns to predict the label marginals and corrects for performativity post-hoc with a Bayes-optimal correction to the model’s logits. More generally, our framework decouples the task of modeling the underlying concept from modeling performative effects. This has the crucial advantage that existing pre-trained models can be used for the former, and only the parameters of the latter are learned from performativity-augmented data, making it more practical and data-efficient.</p>
</div>
<div class="ltx_para" id="S1.SS1.p3">
<p class="ltx_p" id="S1.SS1.p3.1">To evaluate our approach, we draw upon connections between performativity and dynamic benchmarks <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#bib.bib61" title="">61</a>]</cite> and simulate performative shifts over vision and language tasks through adversarial sampling.
Our main empirical findings can be summarized as follows:</p>
<ul class="ltx_itemize" id="S1.I1">
<li class="ltx_item" id="S1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i1.p1">
<p class="ltx_p" id="S1.I1.i1.p1.1">We demonstrate that our proposed adaptation module can learn the performative mechanism effectively from <span class="ltx_text ltx_font_bold" id="S1.I1.i1.p1.1.1">a few performativity-augmented datasets</span> collected along a natural retraining trajectory.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i2.p1">
<p class="ltx_p" id="S1.I1.i2.p1.1">The module enables us to adapt the predictor to future data <span class="ltx_text ltx_font_italic" id="S1.I1.i2.p1.1.1">before</span> deployment, <span class="ltx_text ltx_font_bold" id="S1.I1.i2.p1.1.2">significantly reducing performance degradation</span> due to performative distribution shifts, compared to state-of-the art fine-tuning techniques.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i3.p1">
<p class="ltx_p" id="S1.I1.i3.p1.1">The readily trained adjustment module is <span class="ltx_text ltx_font_bold" id="S1.I1.i3.p1.1.1">flexible</span> in that it can be combined with various pre-trained backbones
allowing zero-shot transfer during model updates, e.g., when more performant backbones become available.
</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i4.p1">
<p class="ltx_p" id="S1.I1.i4.p1.1">We show that our trained adaptation module can anticipate a model’s brittleness to performative shifts before deployment, enabling <span class="ltx_text ltx_font_bold" id="S1.I1.i4.p1.1.1">more informed model selection</span>.</p>
</div>
</li>
</ul>
</div>
<div class="ltx_para" id="S1.SS1.p4">
<p class="ltx_p" id="S1.SS1.p4.1">In a nutshell, we offer the first baseline to effectively adapt state-of-the art deep learning models to performative distribution shifts. Along the way we highlight connections between performative prediction, state-of-the art fine-tuning techniques and their application in dynamic benchmarking, as well as several interesting opportunities for future work.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Background and related work</h2>
<div class="ltx_para" id="S2.p1">
<p class="ltx_p" id="S2.p1.1"><cite class="ltx_cite ltx_citemacro_citet">Perdomo et al. [<a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#bib.bib63" title="">63</a>]</cite> introduce the framework of <span class="ltx_text ltx_font_bold" id="S2.p1.1.1">performative prediction</span> to study performativity in machine learning. We refer to <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#bib.bib26" title="">26</a>]</cite> for a comprehensive overview on related literature. The key conceptual component of the framework is to allow the data distribution to depend on the predictive model.
A natural approach to deal with distribution shifts of all kind is to perform naive retraining. Interestingly, such heuristics can converge to equilibria under performativity <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#bib.bib63" title="">63</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#bib.bib56" title="">56</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#bib.bib46" title="">46</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#bib.bib17" title="">17</a>]</cite>. However, it is known that retraining can lead to suboptimal solutions even after convergence <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#bib.bib63" title="">63</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#bib.bib59" title="">59</a>]</cite>.
Thus, a more ambitious goal is to anticipate performative shifts, instead of solely responding to them <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#bib.bib59" title="">59</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#bib.bib33" title="">33</a>]</cite>. In particular, <cite class="ltx_cite ltx_citemacro_citet">Mendler-Dünner et al. [<a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#bib.bib56" title="">56</a>]</cite> suggest treating predictions as features in a machine learning model, assuming that performativity is mediated by predictions. <cite class="ltx_cite ltx_citemacro_citet">Kim and Perdomo [<a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#bib.bib38" title="">38</a>]</cite> formalize requirements under which such a model allows for optimizing any downstream loss under performativity, also referred to as an omnipredictor <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#bib.bib25" title="">25</a>]</cite>. Both of these approaches require a dataset containing information about the deployed model large enough to train a performativity-aware predictor from scratch. Unfortunately, such data is rarely available in practice, and the paradigm prevents the use of existing pre-trained models and benchmark datasets as they lack such information. To the best of our knowledge, we are the first to offer a solution that allows to build on existing pretrained-backbones towards this goal.</p>
</div>
<div class="ltx_para" id="S2.p2">
<p class="ltx_p" id="S2.p2.2">We primarily focus on <span class="ltx_text ltx_font_bold" id="S2.p2.2.1">label shift</span> in this work. Label shift refers to the shift of the marginal distribution <math alttext="P(Y)" class="ltx_Math" display="inline" id="S2.p2.1.m1.1"><semantics id="S2.p2.1.m1.1a"><mrow id="S2.p2.1.m1.1.2" xref="S2.p2.1.m1.1.2.cmml"><mi id="S2.p2.1.m1.1.2.2" xref="S2.p2.1.m1.1.2.2.cmml">P</mi><mo id="S2.p2.1.m1.1.2.1" xref="S2.p2.1.m1.1.2.1.cmml">⁢</mo><mrow id="S2.p2.1.m1.1.2.3.2" xref="S2.p2.1.m1.1.2.cmml"><mo id="S2.p2.1.m1.1.2.3.2.1" stretchy="false" xref="S2.p2.1.m1.1.2.cmml">(</mo><mi id="S2.p2.1.m1.1.1" xref="S2.p2.1.m1.1.1.cmml">Y</mi><mo id="S2.p2.1.m1.1.2.3.2.2" stretchy="false" xref="S2.p2.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p2.1.m1.1b"><apply id="S2.p2.1.m1.1.2.cmml" xref="S2.p2.1.m1.1.2"><times id="S2.p2.1.m1.1.2.1.cmml" xref="S2.p2.1.m1.1.2.1"></times><ci id="S2.p2.1.m1.1.2.2.cmml" xref="S2.p2.1.m1.1.2.2">𝑃</ci><ci id="S2.p2.1.m1.1.1.cmml" xref="S2.p2.1.m1.1.1">𝑌</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.1.m1.1c">P(Y)</annotation><annotation encoding="application/x-llamapun" id="S2.p2.1.m1.1d">italic_P ( italic_Y )</annotation></semantics></math>, while the class conditionals <math alttext="P(X|Y)" class="ltx_Math" display="inline" id="S2.p2.2.m2.1"><semantics id="S2.p2.2.m2.1a"><mrow id="S2.p2.2.m2.1.1" xref="S2.p2.2.m2.1.1.cmml"><mi id="S2.p2.2.m2.1.1.3" xref="S2.p2.2.m2.1.1.3.cmml">P</mi><mo id="S2.p2.2.m2.1.1.2" xref="S2.p2.2.m2.1.1.2.cmml">⁢</mo><mrow id="S2.p2.2.m2.1.1.1.1" xref="S2.p2.2.m2.1.1.1.1.1.cmml"><mo id="S2.p2.2.m2.1.1.1.1.2" stretchy="false" xref="S2.p2.2.m2.1.1.1.1.1.cmml">(</mo><mrow id="S2.p2.2.m2.1.1.1.1.1" xref="S2.p2.2.m2.1.1.1.1.1.cmml"><mi id="S2.p2.2.m2.1.1.1.1.1.2" xref="S2.p2.2.m2.1.1.1.1.1.2.cmml">X</mi><mo fence="false" id="S2.p2.2.m2.1.1.1.1.1.1" xref="S2.p2.2.m2.1.1.1.1.1.1.cmml">|</mo><mi id="S2.p2.2.m2.1.1.1.1.1.3" xref="S2.p2.2.m2.1.1.1.1.1.3.cmml">Y</mi></mrow><mo id="S2.p2.2.m2.1.1.1.1.3" stretchy="false" xref="S2.p2.2.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p2.2.m2.1b"><apply id="S2.p2.2.m2.1.1.cmml" xref="S2.p2.2.m2.1.1"><times id="S2.p2.2.m2.1.1.2.cmml" xref="S2.p2.2.m2.1.1.2"></times><ci id="S2.p2.2.m2.1.1.3.cmml" xref="S2.p2.2.m2.1.1.3">𝑃</ci><apply id="S2.p2.2.m2.1.1.1.1.1.cmml" xref="S2.p2.2.m2.1.1.1.1"><csymbol cd="latexml" id="S2.p2.2.m2.1.1.1.1.1.1.cmml" xref="S2.p2.2.m2.1.1.1.1.1.1">conditional</csymbol><ci id="S2.p2.2.m2.1.1.1.1.1.2.cmml" xref="S2.p2.2.m2.1.1.1.1.1.2">𝑋</ci><ci id="S2.p2.2.m2.1.1.1.1.1.3.cmml" xref="S2.p2.2.m2.1.1.1.1.1.3">𝑌</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.2.m2.1c">P(X|Y)</annotation><annotation encoding="application/x-llamapun" id="S2.p2.2.m2.1d">italic_P ( italic_X | italic_Y )</annotation></semantics></math> remain fixed <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#bib.bib55" title="">55</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#bib.bib75" title="">75</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#bib.bib84" title="">84</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#bib.bib48" title="">48</a>]</cite>. In contrast to prior work on model-induced shifts, focusing predominantly on covariate shift <cite class="ltx_cite ltx_citemacro_citep">[e.g., <a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#bib.bib27" title="">27</a>]</cite> and concept shift <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#bib.bib56" title="">56</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#bib.bib38" title="">38</a>]</cite>, our focus on deep learning applications puts forth this novel and important dimension of label shift. While concept shift would mean, e.g., a change in the image labeling function, label shift means a change in the sampling procedure, making it much more ubiquitous. Performance degradation due to label shift has been a long-standing problem for computer vision tasks <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#bib.bib57" title="">57</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#bib.bib36" title="">36</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#bib.bib53" title="">53</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#bib.bib14" title="">14</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#bib.bib72" title="">72</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#bib.bib20" title="">20</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#bib.bib86" title="">86</a>]</cite>, with a plethora of principled approaches to correcting the label shift through unlabeled test data <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#bib.bib2" title="">2</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#bib.bib23" title="">23</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#bib.bib21" title="">21</a>]</cite>.
However, existing efforts do not consider the dynamic interplay between model deployments and induced shifts. Our work aims to address this issue and provide initial empirical baselines.</p>
</div>
<div class="ltx_para" id="S2.p3">
<p class="ltx_p" id="S2.p3.1">A <span class="ltx_text ltx_font_bold" id="S2.p3.1.1">practical setting</span> where performative label shift surfaces are adaptive data collection settings. Here performativity is a response to the predictive performance of the model. For example in active learning <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#bib.bib71" title="">71</a>]</cite> data samples are collected to obtain information in high uncertainty regimes of the current model. Dynamic benchmarks <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#bib.bib61" title="">61</a>]</cite> suggest designing datasets adaptively to challenge prior models. Approaches to mitigating fairness issues <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#bib.bib1" title="">1</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#bib.bib24" title="">24</a>]</cite> suggest collecting data for groups on which the model performs poorly. In all these settings, the shifts are mediated by model performance affecting future data collection. In contrast to tabular data, performative concept shift is less common in image and language settings, whereas covariate and label shift prevail.</p>
</div>
<div class="ltx_para" id="S2.p4">
<p class="ltx_p" id="S2.p4.1">Finally, there are various <span class="ltx_text ltx_font_bold" id="S2.p4.1.1">techniques to address distribution shifts</span> in deep learning, independent of their origin.
Prominent example include full fine-tuning <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#bib.bib43" title="">43</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#bib.bib41" title="">41</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#bib.bib83" title="">83</a>]</cite>, partial adaptation <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#bib.bib11" title="">11</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#bib.bib31" title="">31</a>]</cite>, last-layer re-training <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#bib.bib39" title="">39</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#bib.bib67" title="">67</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#bib.bib32" title="">32</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#bib.bib16" title="">16</a>]</cite>, prefix-tuning <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#bib.bib51" title="">51</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#bib.bib34" title="">34</a>]</cite>, unsupervised domain adaptation <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#bib.bib84" title="">84</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#bib.bib19" title="">19</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#bib.bib74" title="">74</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#bib.bib76" title="">76</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#bib.bib13" title="">13</a>]</cite> and test-time adaptation <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#bib.bib77" title="">77</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#bib.bib80" title="">80</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#bib.bib47" title="">47</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#bib.bib52" title="">52</a>]</cite>.
Orthogonal to these, continual learning focuses on mitigating catastrophic forgetting <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#bib.bib40" title="">40</a>]</cite> (i.e., knowledge accumulation) while dealing with a stream of data distributions <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#bib.bib10" title="">10</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#bib.bib3" title="">3</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#bib.bib30" title="">30</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#bib.bib7" title="">7</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#bib.bib81" title="">81</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#bib.bib58" title="">58</a>]</cite>.
None of these methods is designed to address shifts proactively. They all need to observe the induced distribution before adaptation and, thus, inevitably suffer from performance degradation due to performative shifts. By training the model to learn how to perform an adaptation before a performative shift occurs, our work takes a first step into a widely unexplored new direction to improve predictive performance under distribution shifts of known cause.
</p>
</div>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Anticipating performativity</h2>
<div class="ltx_para" id="S3.p1">
<p class="ltx_p" id="S3.p1.1">Performative distribution shifts are caused by model deployment. Thus, having access to the right statistic about the model is in principle, sufficient to foresee performative shifts. This is the core idea making it possible to anticipate performativity, in contrast to arbitrary distribution shifts. Making this more practical is the challenge we tackle in this work. Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Adjusting Pretrained Backbones for Performativity"><span class="ltx_text ltx_ref_tag">1</span></a> illustrates our proposal.</p>
</div>
<section class="ltx_paragraph" id="S3.SS0.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">Problem setup.</h4>
<div class="ltx_para" id="S3.SS0.SSS0.Px1.p1">
<p class="ltx_p" id="S3.SS0.SSS0.Px1.p1.16">We consider discrete time steps, indicating the deployment of model updates. In each step <math alttext="t\geq 0" class="ltx_Math" display="inline" id="S3.SS0.SSS0.Px1.p1.1.m1.1"><semantics id="S3.SS0.SSS0.Px1.p1.1.m1.1a"><mrow id="S3.SS0.SSS0.Px1.p1.1.m1.1.1" xref="S3.SS0.SSS0.Px1.p1.1.m1.1.1.cmml"><mi id="S3.SS0.SSS0.Px1.p1.1.m1.1.1.2" xref="S3.SS0.SSS0.Px1.p1.1.m1.1.1.2.cmml">t</mi><mo id="S3.SS0.SSS0.Px1.p1.1.m1.1.1.1" xref="S3.SS0.SSS0.Px1.p1.1.m1.1.1.1.cmml">≥</mo><mn id="S3.SS0.SSS0.Px1.p1.1.m1.1.1.3" xref="S3.SS0.SSS0.Px1.p1.1.m1.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px1.p1.1.m1.1b"><apply id="S3.SS0.SSS0.Px1.p1.1.m1.1.1.cmml" xref="S3.SS0.SSS0.Px1.p1.1.m1.1.1"><geq id="S3.SS0.SSS0.Px1.p1.1.m1.1.1.1.cmml" xref="S3.SS0.SSS0.Px1.p1.1.m1.1.1.1"></geq><ci id="S3.SS0.SSS0.Px1.p1.1.m1.1.1.2.cmml" xref="S3.SS0.SSS0.Px1.p1.1.m1.1.1.2">𝑡</ci><cn id="S3.SS0.SSS0.Px1.p1.1.m1.1.1.3.cmml" type="integer" xref="S3.SS0.SSS0.Px1.p1.1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px1.p1.1.m1.1c">t\geq 0</annotation><annotation encoding="application/x-llamapun" id="S3.SS0.SSS0.Px1.p1.1.m1.1d">italic_t ≥ 0</annotation></semantics></math>, first, a dataset of feature label pairs <math alttext="(X,Y)" class="ltx_Math" display="inline" id="S3.SS0.SSS0.Px1.p1.2.m2.2"><semantics id="S3.SS0.SSS0.Px1.p1.2.m2.2a"><mrow id="S3.SS0.SSS0.Px1.p1.2.m2.2.3.2" xref="S3.SS0.SSS0.Px1.p1.2.m2.2.3.1.cmml"><mo id="S3.SS0.SSS0.Px1.p1.2.m2.2.3.2.1" stretchy="false" xref="S3.SS0.SSS0.Px1.p1.2.m2.2.3.1.cmml">(</mo><mi id="S3.SS0.SSS0.Px1.p1.2.m2.1.1" xref="S3.SS0.SSS0.Px1.p1.2.m2.1.1.cmml">X</mi><mo id="S3.SS0.SSS0.Px1.p1.2.m2.2.3.2.2" xref="S3.SS0.SSS0.Px1.p1.2.m2.2.3.1.cmml">,</mo><mi id="S3.SS0.SSS0.Px1.p1.2.m2.2.2" xref="S3.SS0.SSS0.Px1.p1.2.m2.2.2.cmml">Y</mi><mo id="S3.SS0.SSS0.Px1.p1.2.m2.2.3.2.3" stretchy="false" xref="S3.SS0.SSS0.Px1.p1.2.m2.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px1.p1.2.m2.2b"><interval closure="open" id="S3.SS0.SSS0.Px1.p1.2.m2.2.3.1.cmml" xref="S3.SS0.SSS0.Px1.p1.2.m2.2.3.2"><ci id="S3.SS0.SSS0.Px1.p1.2.m2.1.1.cmml" xref="S3.SS0.SSS0.Px1.p1.2.m2.1.1">𝑋</ci><ci id="S3.SS0.SSS0.Px1.p1.2.m2.2.2.cmml" xref="S3.SS0.SSS0.Px1.p1.2.m2.2.2">𝑌</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px1.p1.2.m2.2c">(X,Y)</annotation><annotation encoding="application/x-llamapun" id="S3.SS0.SSS0.Px1.p1.2.m2.2d">( italic_X , italic_Y )</annotation></semantics></math> is collected. We consider a classification setting with <math alttext="X\in\mathbb{R}^{d}" class="ltx_Math" display="inline" id="S3.SS0.SSS0.Px1.p1.3.m3.1"><semantics id="S3.SS0.SSS0.Px1.p1.3.m3.1a"><mrow id="S3.SS0.SSS0.Px1.p1.3.m3.1.1" xref="S3.SS0.SSS0.Px1.p1.3.m3.1.1.cmml"><mi id="S3.SS0.SSS0.Px1.p1.3.m3.1.1.2" xref="S3.SS0.SSS0.Px1.p1.3.m3.1.1.2.cmml">X</mi><mo id="S3.SS0.SSS0.Px1.p1.3.m3.1.1.1" xref="S3.SS0.SSS0.Px1.p1.3.m3.1.1.1.cmml">∈</mo><msup id="S3.SS0.SSS0.Px1.p1.3.m3.1.1.3" xref="S3.SS0.SSS0.Px1.p1.3.m3.1.1.3.cmml"><mi id="S3.SS0.SSS0.Px1.p1.3.m3.1.1.3.2" xref="S3.SS0.SSS0.Px1.p1.3.m3.1.1.3.2.cmml">ℝ</mi><mi id="S3.SS0.SSS0.Px1.p1.3.m3.1.1.3.3" xref="S3.SS0.SSS0.Px1.p1.3.m3.1.1.3.3.cmml">d</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px1.p1.3.m3.1b"><apply id="S3.SS0.SSS0.Px1.p1.3.m3.1.1.cmml" xref="S3.SS0.SSS0.Px1.p1.3.m3.1.1"><in id="S3.SS0.SSS0.Px1.p1.3.m3.1.1.1.cmml" xref="S3.SS0.SSS0.Px1.p1.3.m3.1.1.1"></in><ci id="S3.SS0.SSS0.Px1.p1.3.m3.1.1.2.cmml" xref="S3.SS0.SSS0.Px1.p1.3.m3.1.1.2">𝑋</ci><apply id="S3.SS0.SSS0.Px1.p1.3.m3.1.1.3.cmml" xref="S3.SS0.SSS0.Px1.p1.3.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px1.p1.3.m3.1.1.3.1.cmml" xref="S3.SS0.SSS0.Px1.p1.3.m3.1.1.3">superscript</csymbol><ci id="S3.SS0.SSS0.Px1.p1.3.m3.1.1.3.2.cmml" xref="S3.SS0.SSS0.Px1.p1.3.m3.1.1.3.2">ℝ</ci><ci id="S3.SS0.SSS0.Px1.p1.3.m3.1.1.3.3.cmml" xref="S3.SS0.SSS0.Px1.p1.3.m3.1.1.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px1.p1.3.m3.1c">X\in\mathbb{R}^{d}</annotation><annotation encoding="application/x-llamapun" id="S3.SS0.SSS0.Px1.p1.3.m3.1d">italic_X ∈ blackboard_R start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="Y" class="ltx_Math" display="inline" id="S3.SS0.SSS0.Px1.p1.4.m4.1"><semantics id="S3.SS0.SSS0.Px1.p1.4.m4.1a"><mi id="S3.SS0.SSS0.Px1.p1.4.m4.1.1" xref="S3.SS0.SSS0.Px1.p1.4.m4.1.1.cmml">Y</mi><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px1.p1.4.m4.1b"><ci id="S3.SS0.SSS0.Px1.p1.4.m4.1.1.cmml" xref="S3.SS0.SSS0.Px1.p1.4.m4.1.1">𝑌</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px1.p1.4.m4.1c">Y</annotation><annotation encoding="application/x-llamapun" id="S3.SS0.SSS0.Px1.p1.4.m4.1d">italic_Y</annotation></semantics></math> taking on <math alttext="K" class="ltx_Math" display="inline" id="S3.SS0.SSS0.Px1.p1.5.m5.1"><semantics id="S3.SS0.SSS0.Px1.p1.5.m5.1a"><mi id="S3.SS0.SSS0.Px1.p1.5.m5.1.1" xref="S3.SS0.SSS0.Px1.p1.5.m5.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px1.p1.5.m5.1b"><ci id="S3.SS0.SSS0.Px1.p1.5.m5.1.1.cmml" xref="S3.SS0.SSS0.Px1.p1.5.m5.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px1.p1.5.m5.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.SS0.SSS0.Px1.p1.5.m5.1d">italic_K</annotation></semantics></math> discrete values. We use <math alttext="P_{t}" class="ltx_Math" display="inline" id="S3.SS0.SSS0.Px1.p1.6.m6.1"><semantics id="S3.SS0.SSS0.Px1.p1.6.m6.1a"><msub id="S3.SS0.SSS0.Px1.p1.6.m6.1.1" xref="S3.SS0.SSS0.Px1.p1.6.m6.1.1.cmml"><mi id="S3.SS0.SSS0.Px1.p1.6.m6.1.1.2" xref="S3.SS0.SSS0.Px1.p1.6.m6.1.1.2.cmml">P</mi><mi id="S3.SS0.SSS0.Px1.p1.6.m6.1.1.3" xref="S3.SS0.SSS0.Px1.p1.6.m6.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px1.p1.6.m6.1b"><apply id="S3.SS0.SSS0.Px1.p1.6.m6.1.1.cmml" xref="S3.SS0.SSS0.Px1.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px1.p1.6.m6.1.1.1.cmml" xref="S3.SS0.SSS0.Px1.p1.6.m6.1.1">subscript</csymbol><ci id="S3.SS0.SSS0.Px1.p1.6.m6.1.1.2.cmml" xref="S3.SS0.SSS0.Px1.p1.6.m6.1.1.2">𝑃</ci><ci id="S3.SS0.SSS0.Px1.p1.6.m6.1.1.3.cmml" xref="S3.SS0.SSS0.Px1.p1.6.m6.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px1.p1.6.m6.1c">P_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS0.SSS0.Px1.p1.6.m6.1d">italic_P start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> to denote the distribution over data points at time step <math alttext="t" class="ltx_Math" display="inline" id="S3.SS0.SSS0.Px1.p1.7.m7.1"><semantics id="S3.SS0.SSS0.Px1.p1.7.m7.1a"><mi id="S3.SS0.SSS0.Px1.p1.7.m7.1.1" xref="S3.SS0.SSS0.Px1.p1.7.m7.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px1.p1.7.m7.1b"><ci id="S3.SS0.SSS0.Px1.p1.7.m7.1.1.cmml" xref="S3.SS0.SSS0.Px1.p1.7.m7.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px1.p1.7.m7.1c">t</annotation><annotation encoding="application/x-llamapun" id="S3.SS0.SSS0.Px1.p1.7.m7.1d">italic_t</annotation></semantics></math>. Then, a new model <math alttext="f_{t}" class="ltx_Math" display="inline" id="S3.SS0.SSS0.Px1.p1.8.m8.1"><semantics id="S3.SS0.SSS0.Px1.p1.8.m8.1a"><msub id="S3.SS0.SSS0.Px1.p1.8.m8.1.1" xref="S3.SS0.SSS0.Px1.p1.8.m8.1.1.cmml"><mi id="S3.SS0.SSS0.Px1.p1.8.m8.1.1.2" xref="S3.SS0.SSS0.Px1.p1.8.m8.1.1.2.cmml">f</mi><mi id="S3.SS0.SSS0.Px1.p1.8.m8.1.1.3" xref="S3.SS0.SSS0.Px1.p1.8.m8.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px1.p1.8.m8.1b"><apply id="S3.SS0.SSS0.Px1.p1.8.m8.1.1.cmml" xref="S3.SS0.SSS0.Px1.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px1.p1.8.m8.1.1.1.cmml" xref="S3.SS0.SSS0.Px1.p1.8.m8.1.1">subscript</csymbol><ci id="S3.SS0.SSS0.Px1.p1.8.m8.1.1.2.cmml" xref="S3.SS0.SSS0.Px1.p1.8.m8.1.1.2">𝑓</ci><ci id="S3.SS0.SSS0.Px1.p1.8.m8.1.1.3.cmml" xref="S3.SS0.SSS0.Px1.p1.8.m8.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px1.p1.8.m8.1c">f_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS0.SSS0.Px1.p1.8.m8.1d">italic_f start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> is trained to predict <math alttext="Y" class="ltx_Math" display="inline" id="S3.SS0.SSS0.Px1.p1.9.m9.1"><semantics id="S3.SS0.SSS0.Px1.p1.9.m9.1a"><mi id="S3.SS0.SSS0.Px1.p1.9.m9.1.1" xref="S3.SS0.SSS0.Px1.p1.9.m9.1.1.cmml">Y</mi><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px1.p1.9.m9.1b"><ci id="S3.SS0.SSS0.Px1.p1.9.m9.1.1.cmml" xref="S3.SS0.SSS0.Px1.p1.9.m9.1.1">𝑌</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px1.p1.9.m9.1c">Y</annotation><annotation encoding="application/x-llamapun" id="S3.SS0.SSS0.Px1.p1.9.m9.1d">italic_Y</annotation></semantics></math> from <math alttext="X" class="ltx_Math" display="inline" id="S3.SS0.SSS0.Px1.p1.10.m10.1"><semantics id="S3.SS0.SSS0.Px1.p1.10.m10.1a"><mi id="S3.SS0.SSS0.Px1.p1.10.m10.1.1" xref="S3.SS0.SSS0.Px1.p1.10.m10.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px1.p1.10.m10.1b"><ci id="S3.SS0.SSS0.Px1.p1.10.m10.1.1.cmml" xref="S3.SS0.SSS0.Px1.p1.10.m10.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px1.p1.10.m10.1c">X</annotation><annotation encoding="application/x-llamapun" id="S3.SS0.SSS0.Px1.p1.10.m10.1d">italic_X</annotation></semantics></math>. The model <math alttext="f_{t}" class="ltx_Math" display="inline" id="S3.SS0.SSS0.Px1.p1.11.m11.1"><semantics id="S3.SS0.SSS0.Px1.p1.11.m11.1a"><msub id="S3.SS0.SSS0.Px1.p1.11.m11.1.1" xref="S3.SS0.SSS0.Px1.p1.11.m11.1.1.cmml"><mi id="S3.SS0.SSS0.Px1.p1.11.m11.1.1.2" xref="S3.SS0.SSS0.Px1.p1.11.m11.1.1.2.cmml">f</mi><mi id="S3.SS0.SSS0.Px1.p1.11.m11.1.1.3" xref="S3.SS0.SSS0.Px1.p1.11.m11.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px1.p1.11.m11.1b"><apply id="S3.SS0.SSS0.Px1.p1.11.m11.1.1.cmml" xref="S3.SS0.SSS0.Px1.p1.11.m11.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px1.p1.11.m11.1.1.1.cmml" xref="S3.SS0.SSS0.Px1.p1.11.m11.1.1">subscript</csymbol><ci id="S3.SS0.SSS0.Px1.p1.11.m11.1.1.2.cmml" xref="S3.SS0.SSS0.Px1.p1.11.m11.1.1.2">𝑓</ci><ci id="S3.SS0.SSS0.Px1.p1.11.m11.1.1.3.cmml" xref="S3.SS0.SSS0.Px1.p1.11.m11.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px1.p1.11.m11.1c">f_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS0.SSS0.Px1.p1.11.m11.1d">italic_f start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> is deployed and <math alttext="t" class="ltx_Math" display="inline" id="S3.SS0.SSS0.Px1.p1.12.m12.1"><semantics id="S3.SS0.SSS0.Px1.p1.12.m12.1a"><mi id="S3.SS0.SSS0.Px1.p1.12.m12.1.1" xref="S3.SS0.SSS0.Px1.p1.12.m12.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px1.p1.12.m12.1b"><ci id="S3.SS0.SSS0.Px1.p1.12.m12.1.1.cmml" xref="S3.SS0.SSS0.Px1.p1.12.m12.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px1.p1.12.m12.1c">t</annotation><annotation encoding="application/x-llamapun" id="S3.SS0.SSS0.Px1.p1.12.m12.1d">italic_t</annotation></semantics></math> is incremented. The new distribution <math alttext="P_{t+1}" class="ltx_Math" display="inline" id="S3.SS0.SSS0.Px1.p1.13.m13.1"><semantics id="S3.SS0.SSS0.Px1.p1.13.m13.1a"><msub id="S3.SS0.SSS0.Px1.p1.13.m13.1.1" xref="S3.SS0.SSS0.Px1.p1.13.m13.1.1.cmml"><mi id="S3.SS0.SSS0.Px1.p1.13.m13.1.1.2" xref="S3.SS0.SSS0.Px1.p1.13.m13.1.1.2.cmml">P</mi><mrow id="S3.SS0.SSS0.Px1.p1.13.m13.1.1.3" xref="S3.SS0.SSS0.Px1.p1.13.m13.1.1.3.cmml"><mi id="S3.SS0.SSS0.Px1.p1.13.m13.1.1.3.2" xref="S3.SS0.SSS0.Px1.p1.13.m13.1.1.3.2.cmml">t</mi><mo id="S3.SS0.SSS0.Px1.p1.13.m13.1.1.3.1" xref="S3.SS0.SSS0.Px1.p1.13.m13.1.1.3.1.cmml">+</mo><mn id="S3.SS0.SSS0.Px1.p1.13.m13.1.1.3.3" xref="S3.SS0.SSS0.Px1.p1.13.m13.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px1.p1.13.m13.1b"><apply id="S3.SS0.SSS0.Px1.p1.13.m13.1.1.cmml" xref="S3.SS0.SSS0.Px1.p1.13.m13.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px1.p1.13.m13.1.1.1.cmml" xref="S3.SS0.SSS0.Px1.p1.13.m13.1.1">subscript</csymbol><ci id="S3.SS0.SSS0.Px1.p1.13.m13.1.1.2.cmml" xref="S3.SS0.SSS0.Px1.p1.13.m13.1.1.2">𝑃</ci><apply id="S3.SS0.SSS0.Px1.p1.13.m13.1.1.3.cmml" xref="S3.SS0.SSS0.Px1.p1.13.m13.1.1.3"><plus id="S3.SS0.SSS0.Px1.p1.13.m13.1.1.3.1.cmml" xref="S3.SS0.SSS0.Px1.p1.13.m13.1.1.3.1"></plus><ci id="S3.SS0.SSS0.Px1.p1.13.m13.1.1.3.2.cmml" xref="S3.SS0.SSS0.Px1.p1.13.m13.1.1.3.2">𝑡</ci><cn id="S3.SS0.SSS0.Px1.p1.13.m13.1.1.3.3.cmml" type="integer" xref="S3.SS0.SSS0.Px1.p1.13.m13.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px1.p1.13.m13.1c">P_{t+1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS0.SSS0.Px1.p1.13.m13.1d">italic_P start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT</annotation></semantics></math> is fully characterized by a sufficient statistic <math alttext="S_{t}" class="ltx_Math" display="inline" id="S3.SS0.SSS0.Px1.p1.14.m14.1"><semantics id="S3.SS0.SSS0.Px1.p1.14.m14.1a"><msub id="S3.SS0.SSS0.Px1.p1.14.m14.1.1" xref="S3.SS0.SSS0.Px1.p1.14.m14.1.1.cmml"><mi id="S3.SS0.SSS0.Px1.p1.14.m14.1.1.2" xref="S3.SS0.SSS0.Px1.p1.14.m14.1.1.2.cmml">S</mi><mi id="S3.SS0.SSS0.Px1.p1.14.m14.1.1.3" xref="S3.SS0.SSS0.Px1.p1.14.m14.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px1.p1.14.m14.1b"><apply id="S3.SS0.SSS0.Px1.p1.14.m14.1.1.cmml" xref="S3.SS0.SSS0.Px1.p1.14.m14.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px1.p1.14.m14.1.1.1.cmml" xref="S3.SS0.SSS0.Px1.p1.14.m14.1.1">subscript</csymbol><ci id="S3.SS0.SSS0.Px1.p1.14.m14.1.1.2.cmml" xref="S3.SS0.SSS0.Px1.p1.14.m14.1.1.2">𝑆</ci><ci id="S3.SS0.SSS0.Px1.p1.14.m14.1.1.3.cmml" xref="S3.SS0.SSS0.Px1.p1.14.m14.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px1.p1.14.m14.1c">S_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS0.SSS0.Px1.p1.14.m14.1d">italic_S start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, which is a function of <math alttext="f_{t}" class="ltx_Math" display="inline" id="S3.SS0.SSS0.Px1.p1.15.m15.1"><semantics id="S3.SS0.SSS0.Px1.p1.15.m15.1a"><msub id="S3.SS0.SSS0.Px1.p1.15.m15.1.1" xref="S3.SS0.SSS0.Px1.p1.15.m15.1.1.cmml"><mi id="S3.SS0.SSS0.Px1.p1.15.m15.1.1.2" xref="S3.SS0.SSS0.Px1.p1.15.m15.1.1.2.cmml">f</mi><mi id="S3.SS0.SSS0.Px1.p1.15.m15.1.1.3" xref="S3.SS0.SSS0.Px1.p1.15.m15.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px1.p1.15.m15.1b"><apply id="S3.SS0.SSS0.Px1.p1.15.m15.1.1.cmml" xref="S3.SS0.SSS0.Px1.p1.15.m15.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px1.p1.15.m15.1.1.1.cmml" xref="S3.SS0.SSS0.Px1.p1.15.m15.1.1">subscript</csymbol><ci id="S3.SS0.SSS0.Px1.p1.15.m15.1.1.2.cmml" xref="S3.SS0.SSS0.Px1.p1.15.m15.1.1.2">𝑓</ci><ci id="S3.SS0.SSS0.Px1.p1.15.m15.1.1.3.cmml" xref="S3.SS0.SSS0.Px1.p1.15.m15.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px1.p1.15.m15.1c">f_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS0.SSS0.Px1.p1.15.m15.1d">italic_f start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="P_{t}" class="ltx_Math" display="inline" id="S3.SS0.SSS0.Px1.p1.16.m16.1"><semantics id="S3.SS0.SSS0.Px1.p1.16.m16.1a"><msub id="S3.SS0.SSS0.Px1.p1.16.m16.1.1" xref="S3.SS0.SSS0.Px1.p1.16.m16.1.1.cmml"><mi id="S3.SS0.SSS0.Px1.p1.16.m16.1.1.2" xref="S3.SS0.SSS0.Px1.p1.16.m16.1.1.2.cmml">P</mi><mi id="S3.SS0.SSS0.Px1.p1.16.m16.1.1.3" xref="S3.SS0.SSS0.Px1.p1.16.m16.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px1.p1.16.m16.1b"><apply id="S3.SS0.SSS0.Px1.p1.16.m16.1.1.cmml" xref="S3.SS0.SSS0.Px1.p1.16.m16.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px1.p1.16.m16.1.1.1.cmml" xref="S3.SS0.SSS0.Px1.p1.16.m16.1.1">subscript</csymbol><ci id="S3.SS0.SSS0.Px1.p1.16.m16.1.1.2.cmml" xref="S3.SS0.SSS0.Px1.p1.16.m16.1.1.2">𝑃</ci><ci id="S3.SS0.SSS0.Px1.p1.16.m16.1.1.3.cmml" xref="S3.SS0.SSS0.Px1.p1.16.m16.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px1.p1.16.m16.1c">P_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS0.SSS0.Px1.p1.16.m16.1d">italic_P start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>. This corresponds to a stateful extension of the framework by <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#bib.bib63" title="">63</a>]</cite>, using a Markovian assumption similar to <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#bib.bib9" title="">9</a>]</cite>:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\textstyle P_{t+1}(X,Y)=P(X,Y|S=S_{t})\quad\text{with }\quad S_{t}=\mathrm{%
Stat}(f_{t},P_{t})" class="ltx_Math" display="block" id="S3.E1.m1.6"><semantics id="S3.E1.m1.6a"><mrow id="S3.E1.m1.6.6.2" xref="S3.E1.m1.6.6.3.cmml"><mrow id="S3.E1.m1.5.5.1.1" xref="S3.E1.m1.5.5.1.1.cmml"><mrow id="S3.E1.m1.5.5.1.1.3" xref="S3.E1.m1.5.5.1.1.3.cmml"><msub id="S3.E1.m1.5.5.1.1.3.2" xref="S3.E1.m1.5.5.1.1.3.2.cmml"><mi id="S3.E1.m1.5.5.1.1.3.2.2" xref="S3.E1.m1.5.5.1.1.3.2.2.cmml">P</mi><mrow id="S3.E1.m1.5.5.1.1.3.2.3" xref="S3.E1.m1.5.5.1.1.3.2.3.cmml"><mi id="S3.E1.m1.5.5.1.1.3.2.3.2" xref="S3.E1.m1.5.5.1.1.3.2.3.2.cmml">t</mi><mo id="S3.E1.m1.5.5.1.1.3.2.3.1" xref="S3.E1.m1.5.5.1.1.3.2.3.1.cmml">+</mo><mn id="S3.E1.m1.5.5.1.1.3.2.3.3" xref="S3.E1.m1.5.5.1.1.3.2.3.3.cmml">1</mn></mrow></msub><mo id="S3.E1.m1.5.5.1.1.3.1" xref="S3.E1.m1.5.5.1.1.3.1.cmml">⁢</mo><mrow id="S3.E1.m1.5.5.1.1.3.3.2" xref="S3.E1.m1.5.5.1.1.3.3.1.cmml"><mo id="S3.E1.m1.5.5.1.1.3.3.2.1" stretchy="false" xref="S3.E1.m1.5.5.1.1.3.3.1.cmml">(</mo><mi id="S3.E1.m1.1.1" xref="S3.E1.m1.1.1.cmml">X</mi><mo id="S3.E1.m1.5.5.1.1.3.3.2.2" xref="S3.E1.m1.5.5.1.1.3.3.1.cmml">,</mo><mi id="S3.E1.m1.2.2" xref="S3.E1.m1.2.2.cmml">Y</mi><mo id="S3.E1.m1.5.5.1.1.3.3.2.3" stretchy="false" xref="S3.E1.m1.5.5.1.1.3.3.1.cmml">)</mo></mrow></mrow><mo id="S3.E1.m1.5.5.1.1.2" xref="S3.E1.m1.5.5.1.1.2.cmml">=</mo><mrow id="S3.E1.m1.5.5.1.1.1.1" xref="S3.E1.m1.5.5.1.1.1.2.cmml"><mrow id="S3.E1.m1.5.5.1.1.1.1.1" xref="S3.E1.m1.5.5.1.1.1.1.1.cmml"><mi id="S3.E1.m1.5.5.1.1.1.1.1.3" xref="S3.E1.m1.5.5.1.1.1.1.1.3.cmml">P</mi><mo id="S3.E1.m1.5.5.1.1.1.1.1.2" xref="S3.E1.m1.5.5.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E1.m1.5.5.1.1.1.1.1.1.1" xref="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E1.m1.5.5.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E1.m1.5.5.1.1.1.1.1.1.1.1" xref="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.cmml"><mrow id="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E1.m1.3.3" xref="S3.E1.m1.3.3.cmml">X</mi><mo id="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.1.2.cmml">,</mo><mrow id="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.2.cmml">Y</mi><mo fence="false" id="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.cmml">|</mo><mi id="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3.cmml">S</mi></mrow></mrow><mo id="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.2" xref="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.2.cmml">=</mo><msub id="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.3" xref="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.3.2" xref="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.3.2.cmml">S</mi><mi id="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.3.3" xref="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.3.3.cmml">t</mi></msub></mrow><mo id="S3.E1.m1.5.5.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mspace id="S3.E1.m1.5.5.1.1.1.1.2" width="1em" xref="S3.E1.m1.5.5.1.1.1.2.cmml"></mspace><mtext id="S3.E1.m1.4.4" xref="S3.E1.m1.4.4a.cmml">with </mtext></mrow></mrow><mspace id="S3.E1.m1.6.6.2.3" width="1em" xref="S3.E1.m1.6.6.3a.cmml"></mspace><mrow id="S3.E1.m1.6.6.2.2" xref="S3.E1.m1.6.6.2.2.cmml"><msub id="S3.E1.m1.6.6.2.2.4" xref="S3.E1.m1.6.6.2.2.4.cmml"><mi id="S3.E1.m1.6.6.2.2.4.2" xref="S3.E1.m1.6.6.2.2.4.2.cmml">S</mi><mi id="S3.E1.m1.6.6.2.2.4.3" xref="S3.E1.m1.6.6.2.2.4.3.cmml">t</mi></msub><mo id="S3.E1.m1.6.6.2.2.3" xref="S3.E1.m1.6.6.2.2.3.cmml">=</mo><mrow id="S3.E1.m1.6.6.2.2.2" xref="S3.E1.m1.6.6.2.2.2.cmml"><mi id="S3.E1.m1.6.6.2.2.2.4" xref="S3.E1.m1.6.6.2.2.2.4.cmml">Stat</mi><mo id="S3.E1.m1.6.6.2.2.2.3" xref="S3.E1.m1.6.6.2.2.2.3.cmml">⁢</mo><mrow id="S3.E1.m1.6.6.2.2.2.2.2" xref="S3.E1.m1.6.6.2.2.2.2.3.cmml"><mo id="S3.E1.m1.6.6.2.2.2.2.2.3" stretchy="false" xref="S3.E1.m1.6.6.2.2.2.2.3.cmml">(</mo><msub id="S3.E1.m1.6.6.2.2.1.1.1.1" xref="S3.E1.m1.6.6.2.2.1.1.1.1.cmml"><mi id="S3.E1.m1.6.6.2.2.1.1.1.1.2" xref="S3.E1.m1.6.6.2.2.1.1.1.1.2.cmml">f</mi><mi id="S3.E1.m1.6.6.2.2.1.1.1.1.3" xref="S3.E1.m1.6.6.2.2.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.E1.m1.6.6.2.2.2.2.2.4" xref="S3.E1.m1.6.6.2.2.2.2.3.cmml">,</mo><msub id="S3.E1.m1.6.6.2.2.2.2.2.2" xref="S3.E1.m1.6.6.2.2.2.2.2.2.cmml"><mi id="S3.E1.m1.6.6.2.2.2.2.2.2.2" xref="S3.E1.m1.6.6.2.2.2.2.2.2.2.cmml">P</mi><mi id="S3.E1.m1.6.6.2.2.2.2.2.2.3" xref="S3.E1.m1.6.6.2.2.2.2.2.2.3.cmml">t</mi></msub><mo id="S3.E1.m1.6.6.2.2.2.2.2.5" stretchy="false" xref="S3.E1.m1.6.6.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.6b"><apply id="S3.E1.m1.6.6.3.cmml" xref="S3.E1.m1.6.6.2"><csymbol cd="ambiguous" id="S3.E1.m1.6.6.3a.cmml" xref="S3.E1.m1.6.6.2.3">formulae-sequence</csymbol><apply id="S3.E1.m1.5.5.1.1.cmml" xref="S3.E1.m1.5.5.1.1"><eq id="S3.E1.m1.5.5.1.1.2.cmml" xref="S3.E1.m1.5.5.1.1.2"></eq><apply id="S3.E1.m1.5.5.1.1.3.cmml" xref="S3.E1.m1.5.5.1.1.3"><times id="S3.E1.m1.5.5.1.1.3.1.cmml" xref="S3.E1.m1.5.5.1.1.3.1"></times><apply id="S3.E1.m1.5.5.1.1.3.2.cmml" xref="S3.E1.m1.5.5.1.1.3.2"><csymbol cd="ambiguous" id="S3.E1.m1.5.5.1.1.3.2.1.cmml" xref="S3.E1.m1.5.5.1.1.3.2">subscript</csymbol><ci id="S3.E1.m1.5.5.1.1.3.2.2.cmml" xref="S3.E1.m1.5.5.1.1.3.2.2">𝑃</ci><apply id="S3.E1.m1.5.5.1.1.3.2.3.cmml" xref="S3.E1.m1.5.5.1.1.3.2.3"><plus id="S3.E1.m1.5.5.1.1.3.2.3.1.cmml" xref="S3.E1.m1.5.5.1.1.3.2.3.1"></plus><ci id="S3.E1.m1.5.5.1.1.3.2.3.2.cmml" xref="S3.E1.m1.5.5.1.1.3.2.3.2">𝑡</ci><cn id="S3.E1.m1.5.5.1.1.3.2.3.3.cmml" type="integer" xref="S3.E1.m1.5.5.1.1.3.2.3.3">1</cn></apply></apply><interval closure="open" id="S3.E1.m1.5.5.1.1.3.3.1.cmml" xref="S3.E1.m1.5.5.1.1.3.3.2"><ci id="S3.E1.m1.1.1.cmml" xref="S3.E1.m1.1.1">𝑋</ci><ci id="S3.E1.m1.2.2.cmml" xref="S3.E1.m1.2.2">𝑌</ci></interval></apply><list id="S3.E1.m1.5.5.1.1.1.2.cmml" xref="S3.E1.m1.5.5.1.1.1.1"><apply id="S3.E1.m1.5.5.1.1.1.1.1.cmml" xref="S3.E1.m1.5.5.1.1.1.1.1"><times id="S3.E1.m1.5.5.1.1.1.1.1.2.cmml" xref="S3.E1.m1.5.5.1.1.1.1.1.2"></times><ci id="S3.E1.m1.5.5.1.1.1.1.1.3.cmml" xref="S3.E1.m1.5.5.1.1.1.1.1.3">𝑃</ci><apply id="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.5.5.1.1.1.1.1.1.1"><eq id="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.2"></eq><list id="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1"><ci id="S3.E1.m1.3.3.cmml" xref="S3.E1.m1.3.3">𝑋</ci><apply id="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1">conditional</csymbol><ci id="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.2">𝑌</ci><ci id="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3">𝑆</ci></apply></list><apply id="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.3.2">𝑆</ci><ci id="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.3.3">𝑡</ci></apply></apply></apply><ci id="S3.E1.m1.4.4a.cmml" xref="S3.E1.m1.4.4"><mtext id="S3.E1.m1.4.4.cmml" xref="S3.E1.m1.4.4">with </mtext></ci></list></apply><apply id="S3.E1.m1.6.6.2.2.cmml" xref="S3.E1.m1.6.6.2.2"><eq id="S3.E1.m1.6.6.2.2.3.cmml" xref="S3.E1.m1.6.6.2.2.3"></eq><apply id="S3.E1.m1.6.6.2.2.4.cmml" xref="S3.E1.m1.6.6.2.2.4"><csymbol cd="ambiguous" id="S3.E1.m1.6.6.2.2.4.1.cmml" xref="S3.E1.m1.6.6.2.2.4">subscript</csymbol><ci id="S3.E1.m1.6.6.2.2.4.2.cmml" xref="S3.E1.m1.6.6.2.2.4.2">𝑆</ci><ci id="S3.E1.m1.6.6.2.2.4.3.cmml" xref="S3.E1.m1.6.6.2.2.4.3">𝑡</ci></apply><apply id="S3.E1.m1.6.6.2.2.2.cmml" xref="S3.E1.m1.6.6.2.2.2"><times id="S3.E1.m1.6.6.2.2.2.3.cmml" xref="S3.E1.m1.6.6.2.2.2.3"></times><ci id="S3.E1.m1.6.6.2.2.2.4.cmml" xref="S3.E1.m1.6.6.2.2.2.4">Stat</ci><interval closure="open" id="S3.E1.m1.6.6.2.2.2.2.3.cmml" xref="S3.E1.m1.6.6.2.2.2.2.2"><apply id="S3.E1.m1.6.6.2.2.1.1.1.1.cmml" xref="S3.E1.m1.6.6.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.6.6.2.2.1.1.1.1.1.cmml" xref="S3.E1.m1.6.6.2.2.1.1.1.1">subscript</csymbol><ci id="S3.E1.m1.6.6.2.2.1.1.1.1.2.cmml" xref="S3.E1.m1.6.6.2.2.1.1.1.1.2">𝑓</ci><ci id="S3.E1.m1.6.6.2.2.1.1.1.1.3.cmml" xref="S3.E1.m1.6.6.2.2.1.1.1.1.3">𝑡</ci></apply><apply id="S3.E1.m1.6.6.2.2.2.2.2.2.cmml" xref="S3.E1.m1.6.6.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.6.6.2.2.2.2.2.2.1.cmml" xref="S3.E1.m1.6.6.2.2.2.2.2.2">subscript</csymbol><ci id="S3.E1.m1.6.6.2.2.2.2.2.2.2.cmml" xref="S3.E1.m1.6.6.2.2.2.2.2.2.2">𝑃</ci><ci id="S3.E1.m1.6.6.2.2.2.2.2.2.3.cmml" xref="S3.E1.m1.6.6.2.2.2.2.2.2.3">𝑡</ci></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.6c">\textstyle P_{t+1}(X,Y)=P(X,Y|S=S_{t})\quad\text{with }\quad S_{t}=\mathrm{%
Stat}(f_{t},P_{t})</annotation><annotation encoding="application/x-llamapun" id="S3.E1.m1.6d">italic_P start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT ( italic_X , italic_Y ) = italic_P ( italic_X , italic_Y | italic_S = italic_S start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) with italic_S start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = roman_Stat ( italic_f start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_P start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS0.SSS0.Px1.p1.20">An example of a sufficient statistic could be the model predictions over the previous data <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#bib.bib56" title="">56</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#bib.bib38" title="">38</a>]</cite>, or model accuracy across subgroups <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#bib.bib61" title="">61</a>]</cite>. Such statistics are typically significantly lower-dimensional than the raw parameters of <math alttext="P_{t}" class="ltx_Math" display="inline" id="S3.SS0.SSS0.Px1.p1.17.m1.1"><semantics id="S3.SS0.SSS0.Px1.p1.17.m1.1a"><msub id="S3.SS0.SSS0.Px1.p1.17.m1.1.1" xref="S3.SS0.SSS0.Px1.p1.17.m1.1.1.cmml"><mi id="S3.SS0.SSS0.Px1.p1.17.m1.1.1.2" xref="S3.SS0.SSS0.Px1.p1.17.m1.1.1.2.cmml">P</mi><mi id="S3.SS0.SSS0.Px1.p1.17.m1.1.1.3" xref="S3.SS0.SSS0.Px1.p1.17.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px1.p1.17.m1.1b"><apply id="S3.SS0.SSS0.Px1.p1.17.m1.1.1.cmml" xref="S3.SS0.SSS0.Px1.p1.17.m1.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px1.p1.17.m1.1.1.1.cmml" xref="S3.SS0.SSS0.Px1.p1.17.m1.1.1">subscript</csymbol><ci id="S3.SS0.SSS0.Px1.p1.17.m1.1.1.2.cmml" xref="S3.SS0.SSS0.Px1.p1.17.m1.1.1.2">𝑃</ci><ci id="S3.SS0.SSS0.Px1.p1.17.m1.1.1.3.cmml" xref="S3.SS0.SSS0.Px1.p1.17.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px1.p1.17.m1.1c">P_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS0.SSS0.Px1.p1.17.m1.1d">italic_P start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="f_{t}" class="ltx_Math" display="inline" id="S3.SS0.SSS0.Px1.p1.18.m2.1"><semantics id="S3.SS0.SSS0.Px1.p1.18.m2.1a"><msub id="S3.SS0.SSS0.Px1.p1.18.m2.1.1" xref="S3.SS0.SSS0.Px1.p1.18.m2.1.1.cmml"><mi id="S3.SS0.SSS0.Px1.p1.18.m2.1.1.2" xref="S3.SS0.SSS0.Px1.p1.18.m2.1.1.2.cmml">f</mi><mi id="S3.SS0.SSS0.Px1.p1.18.m2.1.1.3" xref="S3.SS0.SSS0.Px1.p1.18.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px1.p1.18.m2.1b"><apply id="S3.SS0.SSS0.Px1.p1.18.m2.1.1.cmml" xref="S3.SS0.SSS0.Px1.p1.18.m2.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px1.p1.18.m2.1.1.1.cmml" xref="S3.SS0.SSS0.Px1.p1.18.m2.1.1">subscript</csymbol><ci id="S3.SS0.SSS0.Px1.p1.18.m2.1.1.2.cmml" xref="S3.SS0.SSS0.Px1.p1.18.m2.1.1.2">𝑓</ci><ci id="S3.SS0.SSS0.Px1.p1.18.m2.1.1.3.cmml" xref="S3.SS0.SSS0.Px1.p1.18.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px1.p1.18.m2.1c">f_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS0.SSS0.Px1.p1.18.m2.1d">italic_f start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> (and avoid explicit parametric assumptions for <math alttext="P_{t}" class="ltx_Math" display="inline" id="S3.SS0.SSS0.Px1.p1.19.m3.1"><semantics id="S3.SS0.SSS0.Px1.p1.19.m3.1a"><msub id="S3.SS0.SSS0.Px1.p1.19.m3.1.1" xref="S3.SS0.SSS0.Px1.p1.19.m3.1.1.cmml"><mi id="S3.SS0.SSS0.Px1.p1.19.m3.1.1.2" xref="S3.SS0.SSS0.Px1.p1.19.m3.1.1.2.cmml">P</mi><mi id="S3.SS0.SSS0.Px1.p1.19.m3.1.1.3" xref="S3.SS0.SSS0.Px1.p1.19.m3.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px1.p1.19.m3.1b"><apply id="S3.SS0.SSS0.Px1.p1.19.m3.1.1.cmml" xref="S3.SS0.SSS0.Px1.p1.19.m3.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px1.p1.19.m3.1.1.1.cmml" xref="S3.SS0.SSS0.Px1.p1.19.m3.1.1">subscript</csymbol><ci id="S3.SS0.SSS0.Px1.p1.19.m3.1.1.2.cmml" xref="S3.SS0.SSS0.Px1.p1.19.m3.1.1.2">𝑃</ci><ci id="S3.SS0.SSS0.Px1.p1.19.m3.1.1.3.cmml" xref="S3.SS0.SSS0.Px1.p1.19.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px1.p1.19.m3.1c">P_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS0.SSS0.Px1.p1.19.m3.1d">italic_P start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>). In the following, we assume that, through expert and domain knowledge, we can specify such a statistic. This means we assume the model developer knows, for example, that predictions are causing the shift, rather than the specifics of the model parameters themselves. We leave for future work the possibility of identifying such statistics from data in settings where such knowledge can not be assumed. Following the notion of independent causal mechanisms <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#bib.bib70" title="">70</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#bib.bib64" title="">64</a>]</cite>, we assume that the mechanism underlying the distribution shift is fixed and shifts only manifest through instantiations of <math alttext="S" class="ltx_Math" display="inline" id="S3.SS0.SSS0.Px1.p1.20.m4.1"><semantics id="S3.SS0.SSS0.Px1.p1.20.m4.1a"><mi id="S3.SS0.SSS0.Px1.p1.20.m4.1.1" xref="S3.SS0.SSS0.Px1.p1.20.m4.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px1.p1.20.m4.1b"><ci id="S3.SS0.SSS0.Px1.p1.20.m4.1.1.cmml" xref="S3.SS0.SSS0.Px1.p1.20.m4.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px1.p1.20.m4.1c">S</annotation><annotation encoding="application/x-llamapun" id="S3.SS0.SSS0.Px1.p1.20.m4.1d">italic_S</annotation></semantics></math>.</p>
</div>
</section>
<section class="ltx_paragraph" id="S3.SS0.SSS0.Px2">
<h4 class="ltx_title ltx_title_paragraph">Practical challenges.</h4>
<div class="ltx_para" id="S3.SS0.SSS0.Px2.p1">
<p class="ltx_p" id="S3.SS0.SSS0.Px2.p1.4">Given a statistic <math alttext="S" class="ltx_Math" display="inline" id="S3.SS0.SSS0.Px2.p1.1.m1.1"><semantics id="S3.SS0.SSS0.Px2.p1.1.m1.1a"><mi id="S3.SS0.SSS0.Px2.p1.1.m1.1.1" xref="S3.SS0.SSS0.Px2.p1.1.m1.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px2.p1.1.m1.1b"><ci id="S3.SS0.SSS0.Px2.p1.1.m1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p1.1.m1.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px2.p1.1.m1.1c">S</annotation><annotation encoding="application/x-llamapun" id="S3.SS0.SSS0.Px2.p1.1.m1.1d">italic_S</annotation></semantics></math>, anticipating performativity means to predict <math alttext="Y" class="ltx_Math" display="inline" id="S3.SS0.SSS0.Px2.p1.2.m2.1"><semantics id="S3.SS0.SSS0.Px2.p1.2.m2.1a"><mi id="S3.SS0.SSS0.Px2.p1.2.m2.1.1" xref="S3.SS0.SSS0.Px2.p1.2.m2.1.1.cmml">Y</mi><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px2.p1.2.m2.1b"><ci id="S3.SS0.SSS0.Px2.p1.2.m2.1.1.cmml" xref="S3.SS0.SSS0.Px2.p1.2.m2.1.1">𝑌</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px2.p1.2.m2.1c">Y</annotation><annotation encoding="application/x-llamapun" id="S3.SS0.SSS0.Px2.p1.2.m2.1d">italic_Y</annotation></semantics></math> from <math alttext="X" class="ltx_Math" display="inline" id="S3.SS0.SSS0.Px2.p1.3.m3.1"><semantics id="S3.SS0.SSS0.Px2.p1.3.m3.1a"><mi id="S3.SS0.SSS0.Px2.p1.3.m3.1.1" xref="S3.SS0.SSS0.Px2.p1.3.m3.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px2.p1.3.m3.1b"><ci id="S3.SS0.SSS0.Px2.p1.3.m3.1.1.cmml" xref="S3.SS0.SSS0.Px2.p1.3.m3.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px2.p1.3.m3.1c">X</annotation><annotation encoding="application/x-llamapun" id="S3.SS0.SSS0.Px2.p1.3.m3.1d">italic_X</annotation></semantics></math> taking the instantiation of <math alttext="S" class="ltx_Math" display="inline" id="S3.SS0.SSS0.Px2.p1.4.m4.1"><semantics id="S3.SS0.SSS0.Px2.p1.4.m4.1a"><mi id="S3.SS0.SSS0.Px2.p1.4.m4.1.1" xref="S3.SS0.SSS0.Px2.p1.4.m4.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px2.p1.4.m4.1b"><ci id="S3.SS0.SSS0.Px2.p1.4.m4.1.1.cmml" xref="S3.SS0.SSS0.Px2.p1.4.m4.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px2.p1.4.m4.1c">S</annotation><annotation encoding="application/x-llamapun" id="S3.SS0.SSS0.Px2.p1.4.m4.1d">italic_S</annotation></semantics></math> into account. This corresponds to learning a performativity-aware predictor of the form</p>
<table class="ltx_equation ltx_eqn_table" id="S3.Ex1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="f_{\mathrm{perf}}:(X,S)\rightarrow Y." class="ltx_Math" display="block" id="S3.Ex1.m1.3"><semantics id="S3.Ex1.m1.3a"><mrow id="S3.Ex1.m1.3.3.1" xref="S3.Ex1.m1.3.3.1.1.cmml"><mrow id="S3.Ex1.m1.3.3.1.1" xref="S3.Ex1.m1.3.3.1.1.cmml"><msub id="S3.Ex1.m1.3.3.1.1.2" xref="S3.Ex1.m1.3.3.1.1.2.cmml"><mi id="S3.Ex1.m1.3.3.1.1.2.2" xref="S3.Ex1.m1.3.3.1.1.2.2.cmml">f</mi><mi id="S3.Ex1.m1.3.3.1.1.2.3" xref="S3.Ex1.m1.3.3.1.1.2.3.cmml">perf</mi></msub><mo id="S3.Ex1.m1.3.3.1.1.1" lspace="0.278em" rspace="0.278em" xref="S3.Ex1.m1.3.3.1.1.1.cmml">:</mo><mrow id="S3.Ex1.m1.3.3.1.1.3" xref="S3.Ex1.m1.3.3.1.1.3.cmml"><mrow id="S3.Ex1.m1.3.3.1.1.3.2.2" xref="S3.Ex1.m1.3.3.1.1.3.2.1.cmml"><mo id="S3.Ex1.m1.3.3.1.1.3.2.2.1" stretchy="false" xref="S3.Ex1.m1.3.3.1.1.3.2.1.cmml">(</mo><mi id="S3.Ex1.m1.1.1" xref="S3.Ex1.m1.1.1.cmml">X</mi><mo id="S3.Ex1.m1.3.3.1.1.3.2.2.2" xref="S3.Ex1.m1.3.3.1.1.3.2.1.cmml">,</mo><mi id="S3.Ex1.m1.2.2" xref="S3.Ex1.m1.2.2.cmml">S</mi><mo id="S3.Ex1.m1.3.3.1.1.3.2.2.3" stretchy="false" xref="S3.Ex1.m1.3.3.1.1.3.2.1.cmml">)</mo></mrow><mo id="S3.Ex1.m1.3.3.1.1.3.1" stretchy="false" xref="S3.Ex1.m1.3.3.1.1.3.1.cmml">→</mo><mi id="S3.Ex1.m1.3.3.1.1.3.3" xref="S3.Ex1.m1.3.3.1.1.3.3.cmml">Y</mi></mrow></mrow><mo id="S3.Ex1.m1.3.3.1.2" lspace="0em" xref="S3.Ex1.m1.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex1.m1.3b"><apply id="S3.Ex1.m1.3.3.1.1.cmml" xref="S3.Ex1.m1.3.3.1"><ci id="S3.Ex1.m1.3.3.1.1.1.cmml" xref="S3.Ex1.m1.3.3.1.1.1">:</ci><apply id="S3.Ex1.m1.3.3.1.1.2.cmml" xref="S3.Ex1.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="S3.Ex1.m1.3.3.1.1.2.1.cmml" xref="S3.Ex1.m1.3.3.1.1.2">subscript</csymbol><ci id="S3.Ex1.m1.3.3.1.1.2.2.cmml" xref="S3.Ex1.m1.3.3.1.1.2.2">𝑓</ci><ci id="S3.Ex1.m1.3.3.1.1.2.3.cmml" xref="S3.Ex1.m1.3.3.1.1.2.3">perf</ci></apply><apply id="S3.Ex1.m1.3.3.1.1.3.cmml" xref="S3.Ex1.m1.3.3.1.1.3"><ci id="S3.Ex1.m1.3.3.1.1.3.1.cmml" xref="S3.Ex1.m1.3.3.1.1.3.1">→</ci><interval closure="open" id="S3.Ex1.m1.3.3.1.1.3.2.1.cmml" xref="S3.Ex1.m1.3.3.1.1.3.2.2"><ci id="S3.Ex1.m1.1.1.cmml" xref="S3.Ex1.m1.1.1">𝑋</ci><ci id="S3.Ex1.m1.2.2.cmml" xref="S3.Ex1.m1.2.2">𝑆</ci></interval><ci id="S3.Ex1.m1.3.3.1.1.3.3.cmml" xref="S3.Ex1.m1.3.3.1.1.3.3">𝑌</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex1.m1.3c">f_{\mathrm{perf}}:(X,S)\rightarrow Y.</annotation><annotation encoding="application/x-llamapun" id="S3.Ex1.m1.3d">italic_f start_POSTSUBSCRIPT roman_perf end_POSTSUBSCRIPT : ( italic_X , italic_S ) → italic_Y .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS0.SSS0.Px2.p1.5">Toward this goal, we highlight two important practical challenges:</p>
</div>
<div class="ltx_para" id="S3.SS0.SSS0.Px2.p2">
<span class="ltx_ERROR undefined" id="S3.SS0.SSS0.Px2.p2.4">{mdframed}</span>
<p class="ltx_p" id="S3.SS0.SSS0.Px2.p2.3">[backgroundcolor=gray!20, linecolor=black, linewidth=1pt]
<span class="ltx_text ltx_font_bold" id="S3.SS0.SSS0.Px2.p2.3.1">Challenge 1: (Scarcity of performativity-augmented data).</span> Curating a training dataset of <math alttext="(X,S,Y)" class="ltx_Math" display="inline" id="S3.SS0.SSS0.Px2.p2.1.m1.3"><semantics id="S3.SS0.SSS0.Px2.p2.1.m1.3a"><mrow id="S3.SS0.SSS0.Px2.p2.1.m1.3.4.2" xref="S3.SS0.SSS0.Px2.p2.1.m1.3.4.1.cmml"><mo id="S3.SS0.SSS0.Px2.p2.1.m1.3.4.2.1" stretchy="false" xref="S3.SS0.SSS0.Px2.p2.1.m1.3.4.1.cmml">(</mo><mi id="S3.SS0.SSS0.Px2.p2.1.m1.1.1" xref="S3.SS0.SSS0.Px2.p2.1.m1.1.1.cmml">X</mi><mo id="S3.SS0.SSS0.Px2.p2.1.m1.3.4.2.2" xref="S3.SS0.SSS0.Px2.p2.1.m1.3.4.1.cmml">,</mo><mi id="S3.SS0.SSS0.Px2.p2.1.m1.2.2" xref="S3.SS0.SSS0.Px2.p2.1.m1.2.2.cmml">S</mi><mo id="S3.SS0.SSS0.Px2.p2.1.m1.3.4.2.3" xref="S3.SS0.SSS0.Px2.p2.1.m1.3.4.1.cmml">,</mo><mi id="S3.SS0.SSS0.Px2.p2.1.m1.3.3" xref="S3.SS0.SSS0.Px2.p2.1.m1.3.3.cmml">Y</mi><mo id="S3.SS0.SSS0.Px2.p2.1.m1.3.4.2.4" stretchy="false" xref="S3.SS0.SSS0.Px2.p2.1.m1.3.4.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px2.p2.1.m1.3b"><vector id="S3.SS0.SSS0.Px2.p2.1.m1.3.4.1.cmml" xref="S3.SS0.SSS0.Px2.p2.1.m1.3.4.2"><ci id="S3.SS0.SSS0.Px2.p2.1.m1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p2.1.m1.1.1">𝑋</ci><ci id="S3.SS0.SSS0.Px2.p2.1.m1.2.2.cmml" xref="S3.SS0.SSS0.Px2.p2.1.m1.2.2">𝑆</ci><ci id="S3.SS0.SSS0.Px2.p2.1.m1.3.3.cmml" xref="S3.SS0.SSS0.Px2.p2.1.m1.3.3">𝑌</ci></vector></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px2.p2.1.m1.3c">(X,S,Y)</annotation><annotation encoding="application/x-llamapun" id="S3.SS0.SSS0.Px2.p2.1.m1.3d">( italic_X , italic_S , italic_Y )</annotation></semantics></math> pairs for learning <math alttext="f_{\mathrm{perf}}" class="ltx_Math" display="inline" id="S3.SS0.SSS0.Px2.p2.2.m2.1"><semantics id="S3.SS0.SSS0.Px2.p2.2.m2.1a"><msub id="S3.SS0.SSS0.Px2.p2.2.m2.1.1" xref="S3.SS0.SSS0.Px2.p2.2.m2.1.1.cmml"><mi id="S3.SS0.SSS0.Px2.p2.2.m2.1.1.2" xref="S3.SS0.SSS0.Px2.p2.2.m2.1.1.2.cmml">f</mi><mi id="S3.SS0.SSS0.Px2.p2.2.m2.1.1.3" xref="S3.SS0.SSS0.Px2.p2.2.m2.1.1.3.cmml">perf</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px2.p2.2.m2.1b"><apply id="S3.SS0.SSS0.Px2.p2.2.m2.1.1.cmml" xref="S3.SS0.SSS0.Px2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px2.p2.2.m2.1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p2.2.m2.1.1">subscript</csymbol><ci id="S3.SS0.SSS0.Px2.p2.2.m2.1.1.2.cmml" xref="S3.SS0.SSS0.Px2.p2.2.m2.1.1.2">𝑓</ci><ci id="S3.SS0.SSS0.Px2.p2.2.m2.1.1.3.cmml" xref="S3.SS0.SSS0.Px2.p2.2.m2.1.1.3">perf</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px2.p2.2.m2.1c">f_{\mathrm{perf}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS0.SSS0.Px2.p2.2.m2.1d">italic_f start_POSTSUBSCRIPT roman_perf end_POSTSUBSCRIPT</annotation></semantics></math> can be prohibitively expensive, as it necessitates exposing the environment to models associated with different statistics <math alttext="S" class="ltx_Math" display="inline" id="S3.SS0.SSS0.Px2.p2.3.m3.1"><semantics id="S3.SS0.SSS0.Px2.p2.3.m3.1a"><mi id="S3.SS0.SSS0.Px2.p2.3.m3.1.1" xref="S3.SS0.SSS0.Px2.p2.3.m3.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px2.p2.3.m3.1b"><ci id="S3.SS0.SSS0.Px2.p2.3.m3.1.1.cmml" xref="S3.SS0.SSS0.Px2.p2.3.m3.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px2.p2.3.m3.1c">S</annotation><annotation encoding="application/x-llamapun" id="S3.SS0.SSS0.Px2.p2.3.m3.1d">italic_S</annotation></semantics></math> and pooling the obtained data together for training.
The complexity of gathering such datasets is insurmountable for high-dimensional data such as images and text and drastically increases training costs.</p>
</div>
<div class="ltx_para" id="S3.SS0.SSS0.Px2.p3">
<span class="ltx_ERROR undefined" id="S3.SS0.SSS0.Px2.p3.5">{mdframed}</span>
<p class="ltx_p" id="S3.SS0.SSS0.Px2.p3.4">[backgroundcolor=gray!20, linecolor=black, linewidth=1pt]
<span class="ltx_text ltx_font_bold" id="S3.SS0.SSS0.Px2.p3.4.1">Challenge 2: (Compatibility with existing backbones).</span> The function <math alttext="f_{\mathrm{perf}}" class="ltx_Math" display="inline" id="S3.SS0.SSS0.Px2.p3.1.m1.1"><semantics id="S3.SS0.SSS0.Px2.p3.1.m1.1a"><msub id="S3.SS0.SSS0.Px2.p3.1.m1.1.1" xref="S3.SS0.SSS0.Px2.p3.1.m1.1.1.cmml"><mi id="S3.SS0.SSS0.Px2.p3.1.m1.1.1.2" xref="S3.SS0.SSS0.Px2.p3.1.m1.1.1.2.cmml">f</mi><mi id="S3.SS0.SSS0.Px2.p3.1.m1.1.1.3" xref="S3.SS0.SSS0.Px2.p3.1.m1.1.1.3.cmml">perf</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px2.p3.1.m1.1b"><apply id="S3.SS0.SSS0.Px2.p3.1.m1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px2.p3.1.m1.1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p3.1.m1.1.1">subscript</csymbol><ci id="S3.SS0.SSS0.Px2.p3.1.m1.1.1.2.cmml" xref="S3.SS0.SSS0.Px2.p3.1.m1.1.1.2">𝑓</ci><ci id="S3.SS0.SSS0.Px2.p3.1.m1.1.1.3.cmml" xref="S3.SS0.SSS0.Px2.p3.1.m1.1.1.3">perf</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px2.p3.1.m1.1c">f_{\mathrm{perf}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS0.SSS0.Px2.p3.1.m1.1d">italic_f start_POSTSUBSCRIPT roman_perf end_POSTSUBSCRIPT</annotation></semantics></math> processes performativity-augmented data points <math alttext="(X,S)" class="ltx_Math" display="inline" id="S3.SS0.SSS0.Px2.p3.2.m2.2"><semantics id="S3.SS0.SSS0.Px2.p3.2.m2.2a"><mrow id="S3.SS0.SSS0.Px2.p3.2.m2.2.3.2" xref="S3.SS0.SSS0.Px2.p3.2.m2.2.3.1.cmml"><mo id="S3.SS0.SSS0.Px2.p3.2.m2.2.3.2.1" stretchy="false" xref="S3.SS0.SSS0.Px2.p3.2.m2.2.3.1.cmml">(</mo><mi id="S3.SS0.SSS0.Px2.p3.2.m2.1.1" xref="S3.SS0.SSS0.Px2.p3.2.m2.1.1.cmml">X</mi><mo id="S3.SS0.SSS0.Px2.p3.2.m2.2.3.2.2" xref="S3.SS0.SSS0.Px2.p3.2.m2.2.3.1.cmml">,</mo><mi id="S3.SS0.SSS0.Px2.p3.2.m2.2.2" xref="S3.SS0.SSS0.Px2.p3.2.m2.2.2.cmml">S</mi><mo id="S3.SS0.SSS0.Px2.p3.2.m2.2.3.2.3" stretchy="false" xref="S3.SS0.SSS0.Px2.p3.2.m2.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px2.p3.2.m2.2b"><interval closure="open" id="S3.SS0.SSS0.Px2.p3.2.m2.2.3.1.cmml" xref="S3.SS0.SSS0.Px2.p3.2.m2.2.3.2"><ci id="S3.SS0.SSS0.Px2.p3.2.m2.1.1.cmml" xref="S3.SS0.SSS0.Px2.p3.2.m2.1.1">𝑋</ci><ci id="S3.SS0.SSS0.Px2.p3.2.m2.2.2.cmml" xref="S3.SS0.SSS0.Px2.p3.2.m2.2.2">𝑆</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px2.p3.2.m2.2c">(X,S)</annotation><annotation encoding="application/x-llamapun" id="S3.SS0.SSS0.Px2.p3.2.m2.2d">( italic_X , italic_S )</annotation></semantics></math> as its input.
This forbids the direct application of existing pre-trained deep learning models to learn <math alttext="f_{\mathrm{perf}}" class="ltx_Math" display="inline" id="S3.SS0.SSS0.Px2.p3.3.m3.1"><semantics id="S3.SS0.SSS0.Px2.p3.3.m3.1a"><msub id="S3.SS0.SSS0.Px2.p3.3.m3.1.1" xref="S3.SS0.SSS0.Px2.p3.3.m3.1.1.cmml"><mi id="S3.SS0.SSS0.Px2.p3.3.m3.1.1.2" xref="S3.SS0.SSS0.Px2.p3.3.m3.1.1.2.cmml">f</mi><mi id="S3.SS0.SSS0.Px2.p3.3.m3.1.1.3" xref="S3.SS0.SSS0.Px2.p3.3.m3.1.1.3.cmml">perf</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px2.p3.3.m3.1b"><apply id="S3.SS0.SSS0.Px2.p3.3.m3.1.1.cmml" xref="S3.SS0.SSS0.Px2.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px2.p3.3.m3.1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p3.3.m3.1.1">subscript</csymbol><ci id="S3.SS0.SSS0.Px2.p3.3.m3.1.1.2.cmml" xref="S3.SS0.SSS0.Px2.p3.3.m3.1.1.2">𝑓</ci><ci id="S3.SS0.SSS0.Px2.p3.3.m3.1.1.3.cmml" xref="S3.SS0.SSS0.Px2.p3.3.m3.1.1.3">perf</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px2.p3.3.m3.1c">f_{\mathrm{perf}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS0.SSS0.Px2.p3.3.m3.1d">italic_f start_POSTSUBSCRIPT roman_perf end_POSTSUBSCRIPT</annotation></semantics></math>, as they typically do not include a feature about the statistic <math alttext="S" class="ltx_Math" display="inline" id="S3.SS0.SSS0.Px2.p3.4.m4.1"><semantics id="S3.SS0.SSS0.Px2.p3.4.m4.1a"><mi id="S3.SS0.SSS0.Px2.p3.4.m4.1.1" xref="S3.SS0.SSS0.Px2.p3.4.m4.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px2.p3.4.m4.1b"><ci id="S3.SS0.SSS0.Px2.p3.4.m4.1.1.cmml" xref="S3.SS0.SSS0.Px2.p3.4.m4.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px2.p3.4.m4.1c">S</annotation><annotation encoding="application/x-llamapun" id="S3.SS0.SSS0.Px2.p3.4.m4.1d">italic_S</annotation></semantics></math> related to the dataset collection as their inputs.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>A modular adaptation architecture </h3>
<div class="ltx_para" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.2">Our goal is to develop an architecture to model <math alttext="f_{\mathrm{perf}}" class="ltx_Math" display="inline" id="S3.SS1.p1.1.m1.1"><semantics id="S3.SS1.p1.1.m1.1a"><msub id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml"><mi id="S3.SS1.p1.1.m1.1.1.2" xref="S3.SS1.p1.1.m1.1.1.2.cmml">f</mi><mi id="S3.SS1.p1.1.m1.1.1.3" xref="S3.SS1.p1.1.m1.1.1.3.cmml">perf</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><apply id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS1.p1.1.m1.1.1.2.cmml" xref="S3.SS1.p1.1.m1.1.1.2">𝑓</ci><ci id="S3.SS1.p1.1.m1.1.1.3.cmml" xref="S3.SS1.p1.1.m1.1.1.3">perf</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">f_{\mathrm{perf}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.1.m1.1d">italic_f start_POSTSUBSCRIPT roman_perf end_POSTSUBSCRIPT</annotation></semantics></math> that uses <math alttext="f_{\mathrm{pre}}" class="ltx_Math" display="inline" id="S3.SS1.p1.2.m2.1"><semantics id="S3.SS1.p1.2.m2.1a"><msub id="S3.SS1.p1.2.m2.1.1" xref="S3.SS1.p1.2.m2.1.1.cmml"><mi id="S3.SS1.p1.2.m2.1.1.2" xref="S3.SS1.p1.2.m2.1.1.2.cmml">f</mi><mi id="S3.SS1.p1.2.m2.1.1.3" xref="S3.SS1.p1.2.m2.1.1.3.cmml">pre</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.1b"><apply id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.1.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS1.p1.2.m2.1.1.2.cmml" xref="S3.SS1.p1.2.m2.1.1.2">𝑓</ci><ci id="S3.SS1.p1.2.m2.1.1.3.cmml" xref="S3.SS1.p1.2.m2.1.1.3">pre</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.1c">f_{\mathrm{pre}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.2.m2.1d">italic_f start_POSTSUBSCRIPT roman_pre end_POSTSUBSCRIPT</annotation></semantics></math> as a building block. That is, we consider functions of the form</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="f_{\mathrm{perf}}(X,S)=F(\{f_{\mathrm{pre}}^{(k)}(X)\}_{k\geq 0},S)," class="ltx_Math" display="block" id="S3.E2.m1.6"><semantics id="S3.E2.m1.6a"><mrow id="S3.E2.m1.6.6.1" xref="S3.E2.m1.6.6.1.1.cmml"><mrow id="S3.E2.m1.6.6.1.1" xref="S3.E2.m1.6.6.1.1.cmml"><mrow id="S3.E2.m1.6.6.1.1.3" xref="S3.E2.m1.6.6.1.1.3.cmml"><msub id="S3.E2.m1.6.6.1.1.3.2" xref="S3.E2.m1.6.6.1.1.3.2.cmml"><mi id="S3.E2.m1.6.6.1.1.3.2.2" xref="S3.E2.m1.6.6.1.1.3.2.2.cmml">f</mi><mi id="S3.E2.m1.6.6.1.1.3.2.3" xref="S3.E2.m1.6.6.1.1.3.2.3.cmml">perf</mi></msub><mo id="S3.E2.m1.6.6.1.1.3.1" xref="S3.E2.m1.6.6.1.1.3.1.cmml">⁢</mo><mrow id="S3.E2.m1.6.6.1.1.3.3.2" xref="S3.E2.m1.6.6.1.1.3.3.1.cmml"><mo id="S3.E2.m1.6.6.1.1.3.3.2.1" stretchy="false" xref="S3.E2.m1.6.6.1.1.3.3.1.cmml">(</mo><mi id="S3.E2.m1.2.2" xref="S3.E2.m1.2.2.cmml">X</mi><mo id="S3.E2.m1.6.6.1.1.3.3.2.2" xref="S3.E2.m1.6.6.1.1.3.3.1.cmml">,</mo><mi id="S3.E2.m1.3.3" xref="S3.E2.m1.3.3.cmml">S</mi><mo id="S3.E2.m1.6.6.1.1.3.3.2.3" stretchy="false" xref="S3.E2.m1.6.6.1.1.3.3.1.cmml">)</mo></mrow></mrow><mo id="S3.E2.m1.6.6.1.1.2" xref="S3.E2.m1.6.6.1.1.2.cmml">=</mo><mrow id="S3.E2.m1.6.6.1.1.1" xref="S3.E2.m1.6.6.1.1.1.cmml"><mi id="S3.E2.m1.6.6.1.1.1.3" xref="S3.E2.m1.6.6.1.1.1.3.cmml">F</mi><mo id="S3.E2.m1.6.6.1.1.1.2" xref="S3.E2.m1.6.6.1.1.1.2.cmml">⁢</mo><mrow id="S3.E2.m1.6.6.1.1.1.1.1" xref="S3.E2.m1.6.6.1.1.1.1.2.cmml"><mo id="S3.E2.m1.6.6.1.1.1.1.1.2" stretchy="false" xref="S3.E2.m1.6.6.1.1.1.1.2.cmml">(</mo><msub id="S3.E2.m1.6.6.1.1.1.1.1.1" xref="S3.E2.m1.6.6.1.1.1.1.1.1.cmml"><mrow id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.2.cmml"><mo id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.2.cmml">{</mo><mrow id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.cmml"><msubsup id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.2" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.2.2.2" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.2.2.2.cmml">f</mi><mi id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.2.2.3" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.2.2.3.cmml">pre</mi><mrow id="S3.E2.m1.1.1.1.3" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.2.cmml"><mo id="S3.E2.m1.1.1.1.3.1" stretchy="false" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.2.cmml">(</mo><mi id="S3.E2.m1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.cmml">k</mi><mo id="S3.E2.m1.1.1.1.3.2" stretchy="false" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></msubsup><mo id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.3.2.1" stretchy="false" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.cmml">(</mo><mi id="S3.E2.m1.4.4" xref="S3.E2.m1.4.4.cmml">X</mi><mo id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.3.2.2" stretchy="false" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S3.E2.m1.6.6.1.1.1.1.1.1.3" xref="S3.E2.m1.6.6.1.1.1.1.1.1.3.cmml"><mi id="S3.E2.m1.6.6.1.1.1.1.1.1.3.2" xref="S3.E2.m1.6.6.1.1.1.1.1.1.3.2.cmml">k</mi><mo id="S3.E2.m1.6.6.1.1.1.1.1.1.3.1" xref="S3.E2.m1.6.6.1.1.1.1.1.1.3.1.cmml">≥</mo><mn id="S3.E2.m1.6.6.1.1.1.1.1.1.3.3" xref="S3.E2.m1.6.6.1.1.1.1.1.1.3.3.cmml">0</mn></mrow></msub><mo id="S3.E2.m1.6.6.1.1.1.1.1.3" xref="S3.E2.m1.6.6.1.1.1.1.2.cmml">,</mo><mi id="S3.E2.m1.5.5" xref="S3.E2.m1.5.5.cmml">S</mi><mo id="S3.E2.m1.6.6.1.1.1.1.1.4" stretchy="false" xref="S3.E2.m1.6.6.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E2.m1.6.6.1.2" xref="S3.E2.m1.6.6.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.6b"><apply id="S3.E2.m1.6.6.1.1.cmml" xref="S3.E2.m1.6.6.1"><eq id="S3.E2.m1.6.6.1.1.2.cmml" xref="S3.E2.m1.6.6.1.1.2"></eq><apply id="S3.E2.m1.6.6.1.1.3.cmml" xref="S3.E2.m1.6.6.1.1.3"><times id="S3.E2.m1.6.6.1.1.3.1.cmml" xref="S3.E2.m1.6.6.1.1.3.1"></times><apply id="S3.E2.m1.6.6.1.1.3.2.cmml" xref="S3.E2.m1.6.6.1.1.3.2"><csymbol cd="ambiguous" id="S3.E2.m1.6.6.1.1.3.2.1.cmml" xref="S3.E2.m1.6.6.1.1.3.2">subscript</csymbol><ci id="S3.E2.m1.6.6.1.1.3.2.2.cmml" xref="S3.E2.m1.6.6.1.1.3.2.2">𝑓</ci><ci id="S3.E2.m1.6.6.1.1.3.2.3.cmml" xref="S3.E2.m1.6.6.1.1.3.2.3">perf</ci></apply><interval closure="open" id="S3.E2.m1.6.6.1.1.3.3.1.cmml" xref="S3.E2.m1.6.6.1.1.3.3.2"><ci id="S3.E2.m1.2.2.cmml" xref="S3.E2.m1.2.2">𝑋</ci><ci id="S3.E2.m1.3.3.cmml" xref="S3.E2.m1.3.3">𝑆</ci></interval></apply><apply id="S3.E2.m1.6.6.1.1.1.cmml" xref="S3.E2.m1.6.6.1.1.1"><times id="S3.E2.m1.6.6.1.1.1.2.cmml" xref="S3.E2.m1.6.6.1.1.1.2"></times><ci id="S3.E2.m1.6.6.1.1.1.3.cmml" xref="S3.E2.m1.6.6.1.1.1.3">𝐹</ci><interval closure="open" id="S3.E2.m1.6.6.1.1.1.1.2.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1"><apply id="S3.E2.m1.6.6.1.1.1.1.1.1.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.6.6.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.1">subscript</csymbol><set id="S3.E2.m1.6.6.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1"><apply id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1"><times id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1"></times><apply id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.2">superscript</csymbol><apply id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.2.2.2">𝑓</ci><ci id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.2.2.3">pre</ci></apply><ci id="S3.E2.m1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1">𝑘</ci></apply><ci id="S3.E2.m1.4.4.cmml" xref="S3.E2.m1.4.4">𝑋</ci></apply></set><apply id="S3.E2.m1.6.6.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.1.3"><geq id="S3.E2.m1.6.6.1.1.1.1.1.1.3.1.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.1.3.1"></geq><ci id="S3.E2.m1.6.6.1.1.1.1.1.1.3.2.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.1.3.2">𝑘</ci><cn id="S3.E2.m1.6.6.1.1.1.1.1.1.3.3.cmml" type="integer" xref="S3.E2.m1.6.6.1.1.1.1.1.1.3.3">0</cn></apply></apply><ci id="S3.E2.m1.5.5.cmml" xref="S3.E2.m1.5.5">𝑆</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.6c">f_{\mathrm{perf}}(X,S)=F(\{f_{\mathrm{pre}}^{(k)}(X)\}_{k\geq 0},S),</annotation><annotation encoding="application/x-llamapun" id="S3.E2.m1.6d">italic_f start_POSTSUBSCRIPT roman_perf end_POSTSUBSCRIPT ( italic_X , italic_S ) = italic_F ( { italic_f start_POSTSUBSCRIPT roman_pre end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_k ) end_POSTSUPERSCRIPT ( italic_X ) } start_POSTSUBSCRIPT italic_k ≥ 0 end_POSTSUBSCRIPT , italic_S ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS1.p1.7">where <math alttext="f_{\mathrm{pre}}^{(k)}" class="ltx_Math" display="inline" id="S3.SS1.p1.3.m1.1"><semantics id="S3.SS1.p1.3.m1.1a"><msubsup id="S3.SS1.p1.3.m1.1.2" xref="S3.SS1.p1.3.m1.1.2.cmml"><mi id="S3.SS1.p1.3.m1.1.2.2.2" xref="S3.SS1.p1.3.m1.1.2.2.2.cmml">f</mi><mi id="S3.SS1.p1.3.m1.1.2.2.3" xref="S3.SS1.p1.3.m1.1.2.2.3.cmml">pre</mi><mrow id="S3.SS1.p1.3.m1.1.1.1.3" xref="S3.SS1.p1.3.m1.1.2.cmml"><mo id="S3.SS1.p1.3.m1.1.1.1.3.1" stretchy="false" xref="S3.SS1.p1.3.m1.1.2.cmml">(</mo><mi id="S3.SS1.p1.3.m1.1.1.1.1" xref="S3.SS1.p1.3.m1.1.1.1.1.cmml">k</mi><mo id="S3.SS1.p1.3.m1.1.1.1.3.2" stretchy="false" xref="S3.SS1.p1.3.m1.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m1.1b"><apply id="S3.SS1.p1.3.m1.1.2.cmml" xref="S3.SS1.p1.3.m1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m1.1.2.1.cmml" xref="S3.SS1.p1.3.m1.1.2">superscript</csymbol><apply id="S3.SS1.p1.3.m1.1.2.2.cmml" xref="S3.SS1.p1.3.m1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m1.1.2.2.1.cmml" xref="S3.SS1.p1.3.m1.1.2">subscript</csymbol><ci id="S3.SS1.p1.3.m1.1.2.2.2.cmml" xref="S3.SS1.p1.3.m1.1.2.2.2">𝑓</ci><ci id="S3.SS1.p1.3.m1.1.2.2.3.cmml" xref="S3.SS1.p1.3.m1.1.2.2.3">pre</ci></apply><ci id="S3.SS1.p1.3.m1.1.1.1.1.cmml" xref="S3.SS1.p1.3.m1.1.1.1.1">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m1.1c">f_{\mathrm{pre}}^{(k)}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.3.m1.1d">italic_f start_POSTSUBSCRIPT roman_pre end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_k ) end_POSTSUPERSCRIPT</annotation></semantics></math> denotes the pre-trained model’s representation at layer <math alttext="k" class="ltx_Math" display="inline" id="S3.SS1.p1.4.m2.1"><semantics id="S3.SS1.p1.4.m2.1a"><mi id="S3.SS1.p1.4.m2.1.1" xref="S3.SS1.p1.4.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m2.1b"><ci id="S3.SS1.p1.4.m2.1.1.cmml" xref="S3.SS1.p1.4.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m2.1c">k</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.4.m2.1d">italic_k</annotation></semantics></math>. The adapter module <math alttext="F" class="ltx_Math" display="inline" id="S3.SS1.p1.5.m3.1"><semantics id="S3.SS1.p1.5.m3.1a"><mi id="S3.SS1.p1.5.m3.1.1" xref="S3.SS1.p1.5.m3.1.1.cmml">F</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.m3.1b"><ci id="S3.SS1.p1.5.m3.1.1.cmml" xref="S3.SS1.p1.5.m3.1.1">𝐹</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.5.m3.1c">F</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.5.m3.1d">italic_F</annotation></semantics></math> acts on top of the pre-trained backbone <math alttext="f_{\mathrm{pre}}" class="ltx_Math" display="inline" id="S3.SS1.p1.6.m4.1"><semantics id="S3.SS1.p1.6.m4.1a"><msub id="S3.SS1.p1.6.m4.1.1" xref="S3.SS1.p1.6.m4.1.1.cmml"><mi id="S3.SS1.p1.6.m4.1.1.2" xref="S3.SS1.p1.6.m4.1.1.2.cmml">f</mi><mi id="S3.SS1.p1.6.m4.1.1.3" xref="S3.SS1.p1.6.m4.1.1.3.cmml">pre</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.6.m4.1b"><apply id="S3.SS1.p1.6.m4.1.1.cmml" xref="S3.SS1.p1.6.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.6.m4.1.1.1.cmml" xref="S3.SS1.p1.6.m4.1.1">subscript</csymbol><ci id="S3.SS1.p1.6.m4.1.1.2.cmml" xref="S3.SS1.p1.6.m4.1.1.2">𝑓</ci><ci id="S3.SS1.p1.6.m4.1.1.3.cmml" xref="S3.SS1.p1.6.m4.1.1.3">pre</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.6.m4.1c">f_{\mathrm{pre}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.6.m4.1d">italic_f start_POSTSUBSCRIPT roman_pre end_POSTSUBSCRIPT</annotation></semantics></math>, potentially accesses its intermediate layer representations, and incorporates the statistic <math alttext="S" class="ltx_Math" display="inline" id="S3.SS1.p1.7.m5.1"><semantics id="S3.SS1.p1.7.m5.1a"><mi id="S3.SS1.p1.7.m5.1.1" xref="S3.SS1.p1.7.m5.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.7.m5.1b"><ci id="S3.SS1.p1.7.m5.1.1.cmml" xref="S3.SS1.p1.7.m5.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.7.m5.1c">S</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.7.m5.1d">italic_S</annotation></semantics></math> to adjust the model’s outputs for performativity.</p>
</div>
<div class="ltx_para" id="S3.SS1.p2">
<p class="ltx_p" id="S3.SS1.p2.4">The adapter module reduces to a scalar function if it operates only on top of the pretrained model’s predictions, such as the case for self-negating and self-fulfilling prophecies <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#bib.bib8" title="">8</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#bib.bib4" title="">4</a>]</cite>, or reflection effects <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#bib.bib54" title="">54</a>]</cite>. At the same time, the mechanism mapping <math alttext="X" class="ltx_Math" display="inline" id="S3.SS1.p2.1.m1.1"><semantics id="S3.SS1.p2.1.m1.1a"><mi id="S3.SS1.p2.1.m1.1.1" xref="S3.SS1.p2.1.m1.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.1b"><ci id="S3.SS1.p2.1.m1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.1c">X</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.1.m1.1d">italic_X</annotation></semantics></math> to <math alttext="Y" class="ltx_Math" display="inline" id="S3.SS1.p2.2.m2.1"><semantics id="S3.SS1.p2.2.m2.1a"><mi id="S3.SS1.p2.2.m2.1.1" xref="S3.SS1.p2.2.m2.1.1.cmml">Y</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.2.m2.1b"><ci id="S3.SS1.p2.2.m2.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1">𝑌</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.2.m2.1c">Y</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.2.m2.1d">italic_Y</annotation></semantics></math> could be arbitrarily complex, and <math alttext="X" class="ltx_Math" display="inline" id="S3.SS1.p2.3.m3.1"><semantics id="S3.SS1.p2.3.m3.1a"><mi id="S3.SS1.p2.3.m3.1.1" xref="S3.SS1.p2.3.m3.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.3.m3.1b"><ci id="S3.SS1.p2.3.m3.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.3.m3.1c">X</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.3.m3.1d">italic_X</annotation></semantics></math> be high dimensional, such as for image or text. Thus, decoupling the feature extraction step from the performative mechanism can come with a significant reduction in complexity for learning the latter, using <math alttext="f_{\mathrm{pre}}" class="ltx_Math" display="inline" id="S3.SS1.p2.4.m4.1"><semantics id="S3.SS1.p2.4.m4.1a"><msub id="S3.SS1.p2.4.m4.1.1" xref="S3.SS1.p2.4.m4.1.1.cmml"><mi id="S3.SS1.p2.4.m4.1.1.2" xref="S3.SS1.p2.4.m4.1.1.2.cmml">f</mi><mi id="S3.SS1.p2.4.m4.1.1.3" xref="S3.SS1.p2.4.m4.1.1.3.cmml">pre</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.4.m4.1b"><apply id="S3.SS1.p2.4.m4.1.1.cmml" xref="S3.SS1.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.4.m4.1.1.1.cmml" xref="S3.SS1.p2.4.m4.1.1">subscript</csymbol><ci id="S3.SS1.p2.4.m4.1.1.2.cmml" xref="S3.SS1.p2.4.m4.1.1.2">𝑓</ci><ci id="S3.SS1.p2.4.m4.1.1.3.cmml" xref="S3.SS1.p2.4.m4.1.1.3">pre</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.4.m4.1c">f_{\mathrm{pre}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.4.m4.1d">italic_f start_POSTSUBSCRIPT roman_pre end_POSTSUBSCRIPT</annotation></semantics></math> as a building block, instead of learning both jointly. Typically, the adapter is given access to more layers of the backbone for the sake of expressivity. At the extreme it get access to the backbone’s input, allowing it to learning the performativity-aware predictor from scratch. With access to more information, the complexity, as well as data requirements for learning the adapter module will naturally increase, offering a useful lever to strategically trade-off assumptions and evidence, and to adapt the module to the availability of performativity-augmented data.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Anticipating performative label shifts</h3>
<div class="ltx_para" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.6">Label shift focuses on the effect of deploying <math alttext="f_{t}" class="ltx_Math" display="inline" id="S3.SS2.p1.1.m1.1"><semantics id="S3.SS2.p1.1.m1.1a"><msub id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml"><mi id="S3.SS2.p1.1.m1.1.1.2" xref="S3.SS2.p1.1.m1.1.1.2.cmml">f</mi><mi id="S3.SS2.p1.1.m1.1.1.3" xref="S3.SS2.p1.1.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><apply id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.p1.1.m1.1.1.2.cmml" xref="S3.SS2.p1.1.m1.1.1.2">𝑓</ci><ci id="S3.SS2.p1.1.m1.1.1.3.cmml" xref="S3.SS2.p1.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">f_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.1.m1.1d">italic_f start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> on the marginal distribution <math alttext="P_{t+1}(Y|S_{t})" class="ltx_Math" display="inline" id="S3.SS2.p1.2.m2.1"><semantics id="S3.SS2.p1.2.m2.1a"><mrow id="S3.SS2.p1.2.m2.1.1" xref="S3.SS2.p1.2.m2.1.1.cmml"><msub id="S3.SS2.p1.2.m2.1.1.3" xref="S3.SS2.p1.2.m2.1.1.3.cmml"><mi id="S3.SS2.p1.2.m2.1.1.3.2" xref="S3.SS2.p1.2.m2.1.1.3.2.cmml">P</mi><mrow id="S3.SS2.p1.2.m2.1.1.3.3" xref="S3.SS2.p1.2.m2.1.1.3.3.cmml"><mi id="S3.SS2.p1.2.m2.1.1.3.3.2" xref="S3.SS2.p1.2.m2.1.1.3.3.2.cmml">t</mi><mo id="S3.SS2.p1.2.m2.1.1.3.3.1" xref="S3.SS2.p1.2.m2.1.1.3.3.1.cmml">+</mo><mn id="S3.SS2.p1.2.m2.1.1.3.3.3" xref="S3.SS2.p1.2.m2.1.1.3.3.3.cmml">1</mn></mrow></msub><mo id="S3.SS2.p1.2.m2.1.1.2" xref="S3.SS2.p1.2.m2.1.1.2.cmml">⁢</mo><mrow id="S3.SS2.p1.2.m2.1.1.1.1" xref="S3.SS2.p1.2.m2.1.1.1.1.1.cmml"><mo id="S3.SS2.p1.2.m2.1.1.1.1.2" stretchy="false" xref="S3.SS2.p1.2.m2.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.p1.2.m2.1.1.1.1.1" xref="S3.SS2.p1.2.m2.1.1.1.1.1.cmml"><mi id="S3.SS2.p1.2.m2.1.1.1.1.1.2" xref="S3.SS2.p1.2.m2.1.1.1.1.1.2.cmml">Y</mi><mo fence="false" id="S3.SS2.p1.2.m2.1.1.1.1.1.1" xref="S3.SS2.p1.2.m2.1.1.1.1.1.1.cmml">|</mo><msub id="S3.SS2.p1.2.m2.1.1.1.1.1.3" xref="S3.SS2.p1.2.m2.1.1.1.1.1.3.cmml"><mi id="S3.SS2.p1.2.m2.1.1.1.1.1.3.2" xref="S3.SS2.p1.2.m2.1.1.1.1.1.3.2.cmml">S</mi><mi id="S3.SS2.p1.2.m2.1.1.1.1.1.3.3" xref="S3.SS2.p1.2.m2.1.1.1.1.1.3.3.cmml">t</mi></msub></mrow><mo id="S3.SS2.p1.2.m2.1.1.1.1.3" stretchy="false" xref="S3.SS2.p1.2.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.1b"><apply id="S3.SS2.p1.2.m2.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1"><times id="S3.SS2.p1.2.m2.1.1.2.cmml" xref="S3.SS2.p1.2.m2.1.1.2"></times><apply id="S3.SS2.p1.2.m2.1.1.3.cmml" xref="S3.SS2.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.1.1.3.1.cmml" xref="S3.SS2.p1.2.m2.1.1.3">subscript</csymbol><ci id="S3.SS2.p1.2.m2.1.1.3.2.cmml" xref="S3.SS2.p1.2.m2.1.1.3.2">𝑃</ci><apply id="S3.SS2.p1.2.m2.1.1.3.3.cmml" xref="S3.SS2.p1.2.m2.1.1.3.3"><plus id="S3.SS2.p1.2.m2.1.1.3.3.1.cmml" xref="S3.SS2.p1.2.m2.1.1.3.3.1"></plus><ci id="S3.SS2.p1.2.m2.1.1.3.3.2.cmml" xref="S3.SS2.p1.2.m2.1.1.3.3.2">𝑡</ci><cn id="S3.SS2.p1.2.m2.1.1.3.3.3.cmml" type="integer" xref="S3.SS2.p1.2.m2.1.1.3.3.3">1</cn></apply></apply><apply id="S3.SS2.p1.2.m2.1.1.1.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1.1.1"><csymbol cd="latexml" id="S3.SS2.p1.2.m2.1.1.1.1.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1.1.1.1.1">conditional</csymbol><ci id="S3.SS2.p1.2.m2.1.1.1.1.1.2.cmml" xref="S3.SS2.p1.2.m2.1.1.1.1.1.2">𝑌</ci><apply id="S3.SS2.p1.2.m2.1.1.1.1.1.3.cmml" xref="S3.SS2.p1.2.m2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.1.1.1.1.1.3.1.cmml" xref="S3.SS2.p1.2.m2.1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS2.p1.2.m2.1.1.1.1.1.3.2.cmml" xref="S3.SS2.p1.2.m2.1.1.1.1.1.3.2">𝑆</ci><ci id="S3.SS2.p1.2.m2.1.1.1.1.1.3.3.cmml" xref="S3.SS2.p1.2.m2.1.1.1.1.1.3.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.1c">P_{t+1}(Y|S_{t})</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.2.m2.1d">italic_P start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT ( italic_Y | italic_S start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math> <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#bib.bib84" title="">84</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#bib.bib48" title="">48</a>]</cite>.
For a discrete classification task, the marginal over the outcome can be concisely represented with a probability vector <math alttext="{\Lambda}\in\mathbb{R}^{K}" class="ltx_Math" display="inline" id="S3.SS2.p1.3.m3.1"><semantics id="S3.SS2.p1.3.m3.1a"><mrow id="S3.SS2.p1.3.m3.1.1" xref="S3.SS2.p1.3.m3.1.1.cmml"><mi id="S3.SS2.p1.3.m3.1.1.2" mathvariant="normal" xref="S3.SS2.p1.3.m3.1.1.2.cmml">Λ</mi><mo id="S3.SS2.p1.3.m3.1.1.1" xref="S3.SS2.p1.3.m3.1.1.1.cmml">∈</mo><msup id="S3.SS2.p1.3.m3.1.1.3" xref="S3.SS2.p1.3.m3.1.1.3.cmml"><mi id="S3.SS2.p1.3.m3.1.1.3.2" xref="S3.SS2.p1.3.m3.1.1.3.2.cmml">ℝ</mi><mi id="S3.SS2.p1.3.m3.1.1.3.3" xref="S3.SS2.p1.3.m3.1.1.3.3.cmml">K</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.3.m3.1b"><apply id="S3.SS2.p1.3.m3.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1"><in id="S3.SS2.p1.3.m3.1.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1.1"></in><ci id="S3.SS2.p1.3.m3.1.1.2.cmml" xref="S3.SS2.p1.3.m3.1.1.2">Λ</ci><apply id="S3.SS2.p1.3.m3.1.1.3.cmml" xref="S3.SS2.p1.3.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p1.3.m3.1.1.3.1.cmml" xref="S3.SS2.p1.3.m3.1.1.3">superscript</csymbol><ci id="S3.SS2.p1.3.m3.1.1.3.2.cmml" xref="S3.SS2.p1.3.m3.1.1.3.2">ℝ</ci><ci id="S3.SS2.p1.3.m3.1.1.3.3.cmml" xref="S3.SS2.p1.3.m3.1.1.3.3">𝐾</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.3.m3.1c">{\Lambda}\in\mathbb{R}^{K}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.3.m3.1d">roman_Λ ∈ blackboard_R start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT</annotation></semantics></math> where <math alttext="K" class="ltx_Math" display="inline" id="S3.SS2.p1.4.m4.1"><semantics id="S3.SS2.p1.4.m4.1a"><mi id="S3.SS2.p1.4.m4.1.1" xref="S3.SS2.p1.4.m4.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.4.m4.1b"><ci id="S3.SS2.p1.4.m4.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.4.m4.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.4.m4.1d">italic_K</annotation></semantics></math> denotes the number of classes, and each entry of <math alttext="{\Lambda}" class="ltx_Math" display="inline" id="S3.SS2.p1.5.m5.1"><semantics id="S3.SS2.p1.5.m5.1a"><mi id="S3.SS2.p1.5.m5.1.1" mathvariant="normal" xref="S3.SS2.p1.5.m5.1.1.cmml">Λ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.5.m5.1b"><ci id="S3.SS2.p1.5.m5.1.1.cmml" xref="S3.SS2.p1.5.m5.1.1">Λ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.5.m5.1c">{\Lambda}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.5.m5.1d">roman_Λ</annotation></semantics></math> specifies the corresponding class probability. Thus, anticipating performativity is equivalent to anticipating changes to <math alttext="\Lambda" class="ltx_Math" display="inline" id="S3.SS2.p1.6.m6.1"><semantics id="S3.SS2.p1.6.m6.1a"><mi id="S3.SS2.p1.6.m6.1.1" mathvariant="normal" xref="S3.SS2.p1.6.m6.1.1.cmml">Λ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.6.m6.1b"><ci id="S3.SS2.p1.6.m6.1.1.cmml" xref="S3.SS2.p1.6.m6.1.1">Λ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.6.m6.1c">\Lambda</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.6.m6.1d">roman_Λ</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S3.SS2.p2">
<p class="ltx_p" id="S3.SS2.p2.3">At the core of the adapter module is a neural network <math alttext="T:S\mapsto\hat{\Lambda}" class="ltx_Math" display="inline" id="S3.SS2.p2.1.m1.1"><semantics id="S3.SS2.p2.1.m1.1a"><mrow id="S3.SS2.p2.1.m1.1.1" xref="S3.SS2.p2.1.m1.1.1.cmml"><mi id="S3.SS2.p2.1.m1.1.1.2" xref="S3.SS2.p2.1.m1.1.1.2.cmml">T</mi><mo id="S3.SS2.p2.1.m1.1.1.1" lspace="0.278em" rspace="0.278em" xref="S3.SS2.p2.1.m1.1.1.1.cmml">:</mo><mrow id="S3.SS2.p2.1.m1.1.1.3" xref="S3.SS2.p2.1.m1.1.1.3.cmml"><mi id="S3.SS2.p2.1.m1.1.1.3.2" xref="S3.SS2.p2.1.m1.1.1.3.2.cmml">S</mi><mo id="S3.SS2.p2.1.m1.1.1.3.1" stretchy="false" xref="S3.SS2.p2.1.m1.1.1.3.1.cmml">↦</mo><mover accent="true" id="S3.SS2.p2.1.m1.1.1.3.3" xref="S3.SS2.p2.1.m1.1.1.3.3.cmml"><mi id="S3.SS2.p2.1.m1.1.1.3.3.2" mathvariant="normal" xref="S3.SS2.p2.1.m1.1.1.3.3.2.cmml">Λ</mi><mo id="S3.SS2.p2.1.m1.1.1.3.3.1" xref="S3.SS2.p2.1.m1.1.1.3.3.1.cmml">^</mo></mover></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.1.m1.1b"><apply id="S3.SS2.p2.1.m1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1"><ci id="S3.SS2.p2.1.m1.1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1.1">:</ci><ci id="S3.SS2.p2.1.m1.1.1.2.cmml" xref="S3.SS2.p2.1.m1.1.1.2">𝑇</ci><apply id="S3.SS2.p2.1.m1.1.1.3.cmml" xref="S3.SS2.p2.1.m1.1.1.3"><csymbol cd="latexml" id="S3.SS2.p2.1.m1.1.1.3.1.cmml" xref="S3.SS2.p2.1.m1.1.1.3.1">maps-to</csymbol><ci id="S3.SS2.p2.1.m1.1.1.3.2.cmml" xref="S3.SS2.p2.1.m1.1.1.3.2">𝑆</ci><apply id="S3.SS2.p2.1.m1.1.1.3.3.cmml" xref="S3.SS2.p2.1.m1.1.1.3.3"><ci id="S3.SS2.p2.1.m1.1.1.3.3.1.cmml" xref="S3.SS2.p2.1.m1.1.1.3.3.1">^</ci><ci id="S3.SS2.p2.1.m1.1.1.3.3.2.cmml" xref="S3.SS2.p2.1.m1.1.1.3.3.2">Λ</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.1.m1.1c">T:S\mapsto\hat{\Lambda}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.1.m1.1d">italic_T : italic_S ↦ over^ start_ARG roman_Λ end_ARG</annotation></semantics></math> that predicts the label marginals <math alttext="\Lambda" class="ltx_Math" display="inline" id="S3.SS2.p2.2.m2.1"><semantics id="S3.SS2.p2.2.m2.1a"><mi id="S3.SS2.p2.2.m2.1.1" mathvariant="normal" xref="S3.SS2.p2.2.m2.1.1.cmml">Λ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.2.m2.1b"><ci id="S3.SS2.p2.2.m2.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1">Λ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.2.m2.1c">\Lambda</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.2.m2.1d">roman_Λ</annotation></semantics></math> from the sufficient statistic <math alttext="S" class="ltx_Math" display="inline" id="S3.SS2.p2.3.m3.1"><semantics id="S3.SS2.p2.3.m3.1a"><mi id="S3.SS2.p2.3.m3.1.1" xref="S3.SS2.p2.3.m3.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.3.m3.1b"><ci id="S3.SS2.p2.3.m3.1.1.cmml" xref="S3.SS2.p2.3.m3.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.3.m3.1c">S</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.3.m3.1d">italic_S</annotation></semantics></math>. These estimates can be used to anticipate the deployment of future models and adapt the predictions by accessing the pretrained-model’s logits. More formally, we implement the following adjustment:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A1.EGx1">
<tbody id="S3.E3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle f_{\mathrm{perf}}(X,S_{t};T)=\operatorname*{arg\,max}_{i}\lambda%
_{i}(S)\cdot[f_{\mathrm{pre}}(X)]_{i}\quad\text{with}\quad\lambda_{i}(S):=%
\frac{[T(S)]_{i}}{\Lambda_{i}^{\mathrm{pre}}}," class="ltx_Math" display="inline" id="S3.E3.m1.9"><semantics id="S3.E3.m1.9a"><mrow id="S3.E3.m1.9.9.1"><mrow id="S3.E3.m1.9.9.1.1.2" xref="S3.E3.m1.9.9.1.1.3.cmml"><mrow id="S3.E3.m1.9.9.1.1.1.1" xref="S3.E3.m1.9.9.1.1.1.1.cmml"><mrow id="S3.E3.m1.9.9.1.1.1.1.1" xref="S3.E3.m1.9.9.1.1.1.1.1.cmml"><msub id="S3.E3.m1.9.9.1.1.1.1.1.3" xref="S3.E3.m1.9.9.1.1.1.1.1.3.cmml"><mi id="S3.E3.m1.9.9.1.1.1.1.1.3.2" xref="S3.E3.m1.9.9.1.1.1.1.1.3.2.cmml">f</mi><mi id="S3.E3.m1.9.9.1.1.1.1.1.3.3" xref="S3.E3.m1.9.9.1.1.1.1.1.3.3.cmml">perf</mi></msub><mo id="S3.E3.m1.9.9.1.1.1.1.1.2" xref="S3.E3.m1.9.9.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E3.m1.9.9.1.1.1.1.1.1.1" xref="S3.E3.m1.9.9.1.1.1.1.1.1.2.cmml"><mo id="S3.E3.m1.9.9.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E3.m1.9.9.1.1.1.1.1.1.2.cmml">(</mo><mi id="S3.E3.m1.3.3" xref="S3.E3.m1.3.3.cmml">X</mi><mo id="S3.E3.m1.9.9.1.1.1.1.1.1.1.3" xref="S3.E3.m1.9.9.1.1.1.1.1.1.2.cmml">,</mo><msub id="S3.E3.m1.9.9.1.1.1.1.1.1.1.1" xref="S3.E3.m1.9.9.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E3.m1.9.9.1.1.1.1.1.1.1.1.2" xref="S3.E3.m1.9.9.1.1.1.1.1.1.1.1.2.cmml">S</mi><mi id="S3.E3.m1.9.9.1.1.1.1.1.1.1.1.3" xref="S3.E3.m1.9.9.1.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.E3.m1.9.9.1.1.1.1.1.1.1.4" xref="S3.E3.m1.9.9.1.1.1.1.1.1.2.cmml">;</mo><mi id="S3.E3.m1.4.4" xref="S3.E3.m1.4.4.cmml">T</mi><mo id="S3.E3.m1.9.9.1.1.1.1.1.1.1.5" stretchy="false" xref="S3.E3.m1.9.9.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E3.m1.9.9.1.1.1.1.3" xref="S3.E3.m1.9.9.1.1.1.1.3.cmml">=</mo><mrow id="S3.E3.m1.9.9.1.1.1.1.2.1" xref="S3.E3.m1.9.9.1.1.1.1.2.2.cmml"><mrow id="S3.E3.m1.9.9.1.1.1.1.2.1.1" xref="S3.E3.m1.9.9.1.1.1.1.2.1.1.cmml"><mrow id="S3.E3.m1.9.9.1.1.1.1.2.1.1.3" xref="S3.E3.m1.9.9.1.1.1.1.2.1.1.3.cmml"><mrow id="S3.E3.m1.9.9.1.1.1.1.2.1.1.3.2" xref="S3.E3.m1.9.9.1.1.1.1.2.1.1.3.2.cmml"><munder id="S3.E3.m1.9.9.1.1.1.1.2.1.1.3.2.1" xref="S3.E3.m1.9.9.1.1.1.1.2.1.1.3.2.1.cmml"><mrow id="S3.E3.m1.9.9.1.1.1.1.2.1.1.3.2.1.2" xref="S3.E3.m1.9.9.1.1.1.1.2.1.1.3.2.1.2.cmml"><mi id="S3.E3.m1.9.9.1.1.1.1.2.1.1.3.2.1.2.2" xref="S3.E3.m1.9.9.1.1.1.1.2.1.1.3.2.1.2.2.cmml">arg</mi><mo id="S3.E3.m1.9.9.1.1.1.1.2.1.1.3.2.1.2.1" lspace="0.170em" xref="S3.E3.m1.9.9.1.1.1.1.2.1.1.3.2.1.2.1.cmml">⁢</mo><mi id="S3.E3.m1.9.9.1.1.1.1.2.1.1.3.2.1.2.3" xref="S3.E3.m1.9.9.1.1.1.1.2.1.1.3.2.1.2.3.cmml">max</mi></mrow><mi id="S3.E3.m1.9.9.1.1.1.1.2.1.1.3.2.1.3" xref="S3.E3.m1.9.9.1.1.1.1.2.1.1.3.2.1.3.cmml">i</mi></munder><mo id="S3.E3.m1.9.9.1.1.1.1.2.1.1.3.2a" xref="S3.E3.m1.9.9.1.1.1.1.2.1.1.3.2.cmml">⁡</mo><msub id="S3.E3.m1.9.9.1.1.1.1.2.1.1.3.2.2" xref="S3.E3.m1.9.9.1.1.1.1.2.1.1.3.2.2.cmml"><mi id="S3.E3.m1.9.9.1.1.1.1.2.1.1.3.2.2.2" xref="S3.E3.m1.9.9.1.1.1.1.2.1.1.3.2.2.2.cmml">λ</mi><mi id="S3.E3.m1.9.9.1.1.1.1.2.1.1.3.2.2.3" xref="S3.E3.m1.9.9.1.1.1.1.2.1.1.3.2.2.3.cmml">i</mi></msub></mrow><mo id="S3.E3.m1.9.9.1.1.1.1.2.1.1.3.1" xref="S3.E3.m1.9.9.1.1.1.1.2.1.1.3.1.cmml">⁢</mo><mrow id="S3.E3.m1.9.9.1.1.1.1.2.1.1.3.3.2" xref="S3.E3.m1.9.9.1.1.1.1.2.1.1.3.cmml"><mo id="S3.E3.m1.9.9.1.1.1.1.2.1.1.3.3.2.1" stretchy="false" xref="S3.E3.m1.9.9.1.1.1.1.2.1.1.3.cmml">(</mo><mi id="S3.E3.m1.5.5" xref="S3.E3.m1.5.5.cmml">S</mi><mo id="S3.E3.m1.9.9.1.1.1.1.2.1.1.3.3.2.2" rspace="0.055em" stretchy="false" xref="S3.E3.m1.9.9.1.1.1.1.2.1.1.3.cmml">)</mo></mrow></mrow><mo id="S3.E3.m1.9.9.1.1.1.1.2.1.1.2" rspace="0.222em" xref="S3.E3.m1.9.9.1.1.1.1.2.1.1.2.cmml">⋅</mo><msub id="S3.E3.m1.9.9.1.1.1.1.2.1.1.1" xref="S3.E3.m1.9.9.1.1.1.1.2.1.1.1.cmml"><mrow id="S3.E3.m1.9.9.1.1.1.1.2.1.1.1.1.1" xref="S3.E3.m1.9.9.1.1.1.1.2.1.1.1.1.2.cmml"><mo id="S3.E3.m1.9.9.1.1.1.1.2.1.1.1.1.1.2" stretchy="false" xref="S3.E3.m1.9.9.1.1.1.1.2.1.1.1.1.2.1.cmml">[</mo><mrow id="S3.E3.m1.9.9.1.1.1.1.2.1.1.1.1.1.1" xref="S3.E3.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.cmml"><msub id="S3.E3.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.2" xref="S3.E3.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.2.cmml"><mi id="S3.E3.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.2.2" xref="S3.E3.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.2.2.cmml">f</mi><mi id="S3.E3.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.2.3" xref="S3.E3.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.2.3.cmml">pre</mi></msub><mo id="S3.E3.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.1" xref="S3.E3.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S3.E3.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.3.2" xref="S3.E3.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.cmml"><mo id="S3.E3.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.3.2.1" stretchy="false" xref="S3.E3.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.cmml">(</mo><mi id="S3.E3.m1.6.6" xref="S3.E3.m1.6.6.cmml">X</mi><mo id="S3.E3.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.3.2.2" stretchy="false" xref="S3.E3.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E3.m1.9.9.1.1.1.1.2.1.1.1.1.1.3" stretchy="false" xref="S3.E3.m1.9.9.1.1.1.1.2.1.1.1.1.2.1.cmml">]</mo></mrow><mi id="S3.E3.m1.9.9.1.1.1.1.2.1.1.1.3" xref="S3.E3.m1.9.9.1.1.1.1.2.1.1.1.3.cmml">i</mi></msub></mrow><mspace id="S3.E3.m1.9.9.1.1.1.1.2.1.2" width="1em" xref="S3.E3.m1.9.9.1.1.1.1.2.2.cmml"></mspace><mtext id="S3.E3.m1.8.8" xref="S3.E3.m1.8.8a.cmml">with</mtext></mrow></mrow><mspace id="S3.E3.m1.9.9.1.1.2.3" width="1em" xref="S3.E3.m1.9.9.1.1.3a.cmml"></mspace><mrow id="S3.E3.m1.9.9.1.1.2.2" xref="S3.E3.m1.9.9.1.1.2.2.cmml"><mrow id="S3.E3.m1.9.9.1.1.2.2.2" xref="S3.E3.m1.9.9.1.1.2.2.2.cmml"><msub id="S3.E3.m1.9.9.1.1.2.2.2.2" xref="S3.E3.m1.9.9.1.1.2.2.2.2.cmml"><mi id="S3.E3.m1.9.9.1.1.2.2.2.2.2" xref="S3.E3.m1.9.9.1.1.2.2.2.2.2.cmml">λ</mi><mi id="S3.E3.m1.9.9.1.1.2.2.2.2.3" xref="S3.E3.m1.9.9.1.1.2.2.2.2.3.cmml">i</mi></msub><mo id="S3.E3.m1.9.9.1.1.2.2.2.1" xref="S3.E3.m1.9.9.1.1.2.2.2.1.cmml">⁢</mo><mrow id="S3.E3.m1.9.9.1.1.2.2.2.3.2" xref="S3.E3.m1.9.9.1.1.2.2.2.cmml"><mo id="S3.E3.m1.9.9.1.1.2.2.2.3.2.1" stretchy="false" xref="S3.E3.m1.9.9.1.1.2.2.2.cmml">(</mo><mi id="S3.E3.m1.7.7" xref="S3.E3.m1.7.7.cmml">S</mi><mo id="S3.E3.m1.9.9.1.1.2.2.2.3.2.2" rspace="0.278em" stretchy="false" xref="S3.E3.m1.9.9.1.1.2.2.2.cmml">)</mo></mrow></mrow><mo id="S3.E3.m1.9.9.1.1.2.2.1" rspace="0.278em" xref="S3.E3.m1.9.9.1.1.2.2.1.cmml">:=</mo><mstyle displaystyle="true" id="S3.E3.m1.2.2" xref="S3.E3.m1.2.2.cmml"><mfrac id="S3.E3.m1.2.2a" xref="S3.E3.m1.2.2.cmml"><msub id="S3.E3.m1.2.2.2" xref="S3.E3.m1.2.2.2.cmml"><mrow id="S3.E3.m1.2.2.2.2.1" xref="S3.E3.m1.2.2.2.2.2.cmml"><mo id="S3.E3.m1.2.2.2.2.1.2" stretchy="false" xref="S3.E3.m1.2.2.2.2.2.1.cmml">[</mo><mrow id="S3.E3.m1.2.2.2.2.1.1" xref="S3.E3.m1.2.2.2.2.1.1.cmml"><mi id="S3.E3.m1.2.2.2.2.1.1.2" xref="S3.E3.m1.2.2.2.2.1.1.2.cmml">T</mi><mo id="S3.E3.m1.2.2.2.2.1.1.1" xref="S3.E3.m1.2.2.2.2.1.1.1.cmml">⁢</mo><mrow id="S3.E3.m1.2.2.2.2.1.1.3.2" xref="S3.E3.m1.2.2.2.2.1.1.cmml"><mo id="S3.E3.m1.2.2.2.2.1.1.3.2.1" stretchy="false" xref="S3.E3.m1.2.2.2.2.1.1.cmml">(</mo><mi id="S3.E3.m1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.cmml">S</mi><mo id="S3.E3.m1.2.2.2.2.1.1.3.2.2" stretchy="false" xref="S3.E3.m1.2.2.2.2.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E3.m1.2.2.2.2.1.3" stretchy="false" xref="S3.E3.m1.2.2.2.2.2.1.cmml">]</mo></mrow><mi id="S3.E3.m1.2.2.2.4" xref="S3.E3.m1.2.2.2.4.cmml">i</mi></msub><msubsup id="S3.E3.m1.2.2.4" xref="S3.E3.m1.2.2.4.cmml"><mi id="S3.E3.m1.2.2.4.2.2" mathvariant="normal" xref="S3.E3.m1.2.2.4.2.2.cmml">Λ</mi><mi id="S3.E3.m1.2.2.4.2.3" xref="S3.E3.m1.2.2.4.2.3.cmml">i</mi><mi id="S3.E3.m1.2.2.4.3" xref="S3.E3.m1.2.2.4.3.cmml">pre</mi></msubsup></mfrac></mstyle></mrow></mrow><mo id="S3.E3.m1.9.9.1.2">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.9b"><apply id="S3.E3.m1.9.9.1.1.3.cmml" xref="S3.E3.m1.9.9.1.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.9.9.1.1.3a.cmml" xref="S3.E3.m1.9.9.1.1.2.3">formulae-sequence</csymbol><apply id="S3.E3.m1.9.9.1.1.1.1.cmml" xref="S3.E3.m1.9.9.1.1.1.1"><eq id="S3.E3.m1.9.9.1.1.1.1.3.cmml" xref="S3.E3.m1.9.9.1.1.1.1.3"></eq><apply id="S3.E3.m1.9.9.1.1.1.1.1.cmml" xref="S3.E3.m1.9.9.1.1.1.1.1"><times id="S3.E3.m1.9.9.1.1.1.1.1.2.cmml" xref="S3.E3.m1.9.9.1.1.1.1.1.2"></times><apply id="S3.E3.m1.9.9.1.1.1.1.1.3.cmml" xref="S3.E3.m1.9.9.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E3.m1.9.9.1.1.1.1.1.3.1.cmml" xref="S3.E3.m1.9.9.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E3.m1.9.9.1.1.1.1.1.3.2.cmml" xref="S3.E3.m1.9.9.1.1.1.1.1.3.2">𝑓</ci><ci id="S3.E3.m1.9.9.1.1.1.1.1.3.3.cmml" xref="S3.E3.m1.9.9.1.1.1.1.1.3.3">perf</ci></apply><vector id="S3.E3.m1.9.9.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.9.9.1.1.1.1.1.1.1"><ci id="S3.E3.m1.3.3.cmml" xref="S3.E3.m1.3.3">𝑋</ci><apply id="S3.E3.m1.9.9.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.9.9.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.9.9.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E3.m1.9.9.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.9.9.1.1.1.1.1.1.1.1.2">𝑆</ci><ci id="S3.E3.m1.9.9.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.9.9.1.1.1.1.1.1.1.1.3">𝑡</ci></apply><ci id="S3.E3.m1.4.4.cmml" xref="S3.E3.m1.4.4">𝑇</ci></vector></apply><list id="S3.E3.m1.9.9.1.1.1.1.2.2.cmml" xref="S3.E3.m1.9.9.1.1.1.1.2.1"><apply id="S3.E3.m1.9.9.1.1.1.1.2.1.1.cmml" xref="S3.E3.m1.9.9.1.1.1.1.2.1.1"><ci id="S3.E3.m1.9.9.1.1.1.1.2.1.1.2.cmml" xref="S3.E3.m1.9.9.1.1.1.1.2.1.1.2">⋅</ci><apply id="S3.E3.m1.9.9.1.1.1.1.2.1.1.3.cmml" xref="S3.E3.m1.9.9.1.1.1.1.2.1.1.3"><times id="S3.E3.m1.9.9.1.1.1.1.2.1.1.3.1.cmml" xref="S3.E3.m1.9.9.1.1.1.1.2.1.1.3.1"></times><apply id="S3.E3.m1.9.9.1.1.1.1.2.1.1.3.2.cmml" xref="S3.E3.m1.9.9.1.1.1.1.2.1.1.3.2"><apply id="S3.E3.m1.9.9.1.1.1.1.2.1.1.3.2.1.cmml" xref="S3.E3.m1.9.9.1.1.1.1.2.1.1.3.2.1"><csymbol cd="ambiguous" id="S3.E3.m1.9.9.1.1.1.1.2.1.1.3.2.1.1.cmml" xref="S3.E3.m1.9.9.1.1.1.1.2.1.1.3.2.1">subscript</csymbol><apply id="S3.E3.m1.9.9.1.1.1.1.2.1.1.3.2.1.2.cmml" xref="S3.E3.m1.9.9.1.1.1.1.2.1.1.3.2.1.2"><times id="S3.E3.m1.9.9.1.1.1.1.2.1.1.3.2.1.2.1.cmml" xref="S3.E3.m1.9.9.1.1.1.1.2.1.1.3.2.1.2.1"></times><ci id="S3.E3.m1.9.9.1.1.1.1.2.1.1.3.2.1.2.2.cmml" xref="S3.E3.m1.9.9.1.1.1.1.2.1.1.3.2.1.2.2">arg</ci><ci id="S3.E3.m1.9.9.1.1.1.1.2.1.1.3.2.1.2.3.cmml" xref="S3.E3.m1.9.9.1.1.1.1.2.1.1.3.2.1.2.3">max</ci></apply><ci id="S3.E3.m1.9.9.1.1.1.1.2.1.1.3.2.1.3.cmml" xref="S3.E3.m1.9.9.1.1.1.1.2.1.1.3.2.1.3">𝑖</ci></apply><apply id="S3.E3.m1.9.9.1.1.1.1.2.1.1.3.2.2.cmml" xref="S3.E3.m1.9.9.1.1.1.1.2.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.9.9.1.1.1.1.2.1.1.3.2.2.1.cmml" xref="S3.E3.m1.9.9.1.1.1.1.2.1.1.3.2.2">subscript</csymbol><ci id="S3.E3.m1.9.9.1.1.1.1.2.1.1.3.2.2.2.cmml" xref="S3.E3.m1.9.9.1.1.1.1.2.1.1.3.2.2.2">𝜆</ci><ci id="S3.E3.m1.9.9.1.1.1.1.2.1.1.3.2.2.3.cmml" xref="S3.E3.m1.9.9.1.1.1.1.2.1.1.3.2.2.3">𝑖</ci></apply></apply><ci id="S3.E3.m1.5.5.cmml" xref="S3.E3.m1.5.5">𝑆</ci></apply><apply id="S3.E3.m1.9.9.1.1.1.1.2.1.1.1.cmml" xref="S3.E3.m1.9.9.1.1.1.1.2.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.9.9.1.1.1.1.2.1.1.1.2.cmml" xref="S3.E3.m1.9.9.1.1.1.1.2.1.1.1">subscript</csymbol><apply id="S3.E3.m1.9.9.1.1.1.1.2.1.1.1.1.2.cmml" xref="S3.E3.m1.9.9.1.1.1.1.2.1.1.1.1.1"><csymbol cd="latexml" id="S3.E3.m1.9.9.1.1.1.1.2.1.1.1.1.2.1.cmml" xref="S3.E3.m1.9.9.1.1.1.1.2.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.E3.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.cmml" xref="S3.E3.m1.9.9.1.1.1.1.2.1.1.1.1.1.1"><times id="S3.E3.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.1"></times><apply id="S3.E3.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.2.1.cmml" xref="S3.E3.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E3.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.2.2.cmml" xref="S3.E3.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.2.2">𝑓</ci><ci id="S3.E3.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.2.3.cmml" xref="S3.E3.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.2.3">pre</ci></apply><ci id="S3.E3.m1.6.6.cmml" xref="S3.E3.m1.6.6">𝑋</ci></apply></apply><ci id="S3.E3.m1.9.9.1.1.1.1.2.1.1.1.3.cmml" xref="S3.E3.m1.9.9.1.1.1.1.2.1.1.1.3">𝑖</ci></apply></apply><ci id="S3.E3.m1.8.8a.cmml" xref="S3.E3.m1.8.8"><mtext id="S3.E3.m1.8.8.cmml" xref="S3.E3.m1.8.8">with</mtext></ci></list></apply><apply id="S3.E3.m1.9.9.1.1.2.2.cmml" xref="S3.E3.m1.9.9.1.1.2.2"><csymbol cd="latexml" id="S3.E3.m1.9.9.1.1.2.2.1.cmml" xref="S3.E3.m1.9.9.1.1.2.2.1">assign</csymbol><apply id="S3.E3.m1.9.9.1.1.2.2.2.cmml" xref="S3.E3.m1.9.9.1.1.2.2.2"><times id="S3.E3.m1.9.9.1.1.2.2.2.1.cmml" xref="S3.E3.m1.9.9.1.1.2.2.2.1"></times><apply id="S3.E3.m1.9.9.1.1.2.2.2.2.cmml" xref="S3.E3.m1.9.9.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.9.9.1.1.2.2.2.2.1.cmml" xref="S3.E3.m1.9.9.1.1.2.2.2.2">subscript</csymbol><ci id="S3.E3.m1.9.9.1.1.2.2.2.2.2.cmml" xref="S3.E3.m1.9.9.1.1.2.2.2.2.2">𝜆</ci><ci id="S3.E3.m1.9.9.1.1.2.2.2.2.3.cmml" xref="S3.E3.m1.9.9.1.1.2.2.2.2.3">𝑖</ci></apply><ci id="S3.E3.m1.7.7.cmml" xref="S3.E3.m1.7.7">𝑆</ci></apply><apply id="S3.E3.m1.2.2.cmml" xref="S3.E3.m1.2.2"><divide id="S3.E3.m1.2.2.3.cmml" xref="S3.E3.m1.2.2"></divide><apply id="S3.E3.m1.2.2.2.cmml" xref="S3.E3.m1.2.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.2.3.cmml" xref="S3.E3.m1.2.2.2">subscript</csymbol><apply id="S3.E3.m1.2.2.2.2.2.cmml" xref="S3.E3.m1.2.2.2.2.1"><csymbol cd="latexml" id="S3.E3.m1.2.2.2.2.2.1.cmml" xref="S3.E3.m1.2.2.2.2.1.2">delimited-[]</csymbol><apply id="S3.E3.m1.2.2.2.2.1.1.cmml" xref="S3.E3.m1.2.2.2.2.1.1"><times id="S3.E3.m1.2.2.2.2.1.1.1.cmml" xref="S3.E3.m1.2.2.2.2.1.1.1"></times><ci id="S3.E3.m1.2.2.2.2.1.1.2.cmml" xref="S3.E3.m1.2.2.2.2.1.1.2">𝑇</ci><ci id="S3.E3.m1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1">𝑆</ci></apply></apply><ci id="S3.E3.m1.2.2.2.4.cmml" xref="S3.E3.m1.2.2.2.4">𝑖</ci></apply><apply id="S3.E3.m1.2.2.4.cmml" xref="S3.E3.m1.2.2.4"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.4.1.cmml" xref="S3.E3.m1.2.2.4">superscript</csymbol><apply id="S3.E3.m1.2.2.4.2.cmml" xref="S3.E3.m1.2.2.4"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.4.2.1.cmml" xref="S3.E3.m1.2.2.4">subscript</csymbol><ci id="S3.E3.m1.2.2.4.2.2.cmml" xref="S3.E3.m1.2.2.4.2.2">Λ</ci><ci id="S3.E3.m1.2.2.4.2.3.cmml" xref="S3.E3.m1.2.2.4.2.3">𝑖</ci></apply><ci id="S3.E3.m1.2.2.4.3.cmml" xref="S3.E3.m1.2.2.4.3">pre</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.9c">\displaystyle f_{\mathrm{perf}}(X,S_{t};T)=\operatorname*{arg\,max}_{i}\lambda%
_{i}(S)\cdot[f_{\mathrm{pre}}(X)]_{i}\quad\text{with}\quad\lambda_{i}(S):=%
\frac{[T(S)]_{i}}{\Lambda_{i}^{\mathrm{pre}}},</annotation><annotation encoding="application/x-llamapun" id="S3.E3.m1.9d">italic_f start_POSTSUBSCRIPT roman_perf end_POSTSUBSCRIPT ( italic_X , italic_S start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ; italic_T ) = start_OPERATOR roman_arg roman_max end_OPERATOR start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT italic_λ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ( italic_S ) ⋅ [ italic_f start_POSTSUBSCRIPT roman_pre end_POSTSUBSCRIPT ( italic_X ) ] start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT with italic_λ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ( italic_S ) := divide start_ARG [ italic_T ( italic_S ) ] start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_ARG start_ARG roman_Λ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT roman_pre end_POSTSUPERSCRIPT end_ARG ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.p2.6">where <math alttext="\Lambda^{\mathrm{pre}}" class="ltx_Math" display="inline" id="S3.SS2.p2.4.m1.1"><semantics id="S3.SS2.p2.4.m1.1a"><msup id="S3.SS2.p2.4.m1.1.1" xref="S3.SS2.p2.4.m1.1.1.cmml"><mi id="S3.SS2.p2.4.m1.1.1.2" mathvariant="normal" xref="S3.SS2.p2.4.m1.1.1.2.cmml">Λ</mi><mi id="S3.SS2.p2.4.m1.1.1.3" xref="S3.SS2.p2.4.m1.1.1.3.cmml">pre</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.4.m1.1b"><apply id="S3.SS2.p2.4.m1.1.1.cmml" xref="S3.SS2.p2.4.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.4.m1.1.1.1.cmml" xref="S3.SS2.p2.4.m1.1.1">superscript</csymbol><ci id="S3.SS2.p2.4.m1.1.1.2.cmml" xref="S3.SS2.p2.4.m1.1.1.2">Λ</ci><ci id="S3.SS2.p2.4.m1.1.1.3.cmml" xref="S3.SS2.p2.4.m1.1.1.3">pre</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.4.m1.1c">\Lambda^{\mathrm{pre}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.4.m1.1d">roman_Λ start_POSTSUPERSCRIPT roman_pre end_POSTSUPERSCRIPT</annotation></semantics></math> is denotes the label marginals over the training data of <math alttext="f_{\mathrm{pre}}" class="ltx_Math" display="inline" id="S3.SS2.p2.5.m2.1"><semantics id="S3.SS2.p2.5.m2.1a"><msub id="S3.SS2.p2.5.m2.1.1" xref="S3.SS2.p2.5.m2.1.1.cmml"><mi id="S3.SS2.p2.5.m2.1.1.2" xref="S3.SS2.p2.5.m2.1.1.2.cmml">f</mi><mi id="S3.SS2.p2.5.m2.1.1.3" xref="S3.SS2.p2.5.m2.1.1.3.cmml">pre</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.5.m2.1b"><apply id="S3.SS2.p2.5.m2.1.1.cmml" xref="S3.SS2.p2.5.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.5.m2.1.1.1.cmml" xref="S3.SS2.p2.5.m2.1.1">subscript</csymbol><ci id="S3.SS2.p2.5.m2.1.1.2.cmml" xref="S3.SS2.p2.5.m2.1.1.2">𝑓</ci><ci id="S3.SS2.p2.5.m2.1.1.3.cmml" xref="S3.SS2.p2.5.m2.1.1.3">pre</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.5.m2.1c">f_{\mathrm{pre}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.5.m2.1d">italic_f start_POSTSUBSCRIPT roman_pre end_POSTSUBSCRIPT</annotation></semantics></math>. This expression fully decouples the mechanism underlying the shift from the feature-extraction part on the input. The next result shows that for a well trained <math alttext="T" class="ltx_Math" display="inline" id="S3.SS2.p2.6.m3.1"><semantics id="S3.SS2.p2.6.m3.1a"><mi id="S3.SS2.p2.6.m3.1.1" xref="S3.SS2.p2.6.m3.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.6.m3.1b"><ci id="S3.SS2.p2.6.m3.1.1.cmml" xref="S3.SS2.p2.6.m3.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.6.m3.1c">T</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.6.m3.1d">italic_T</annotation></semantics></math> and a good pretrained model, such an adjustment can indeed be optimal under label shift.</p>
</div>
<div class="ltx_theorem ltx_theorem_proposition" id="S3.Thmtheorem1">
<h6 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span class="ltx_text ltx_font_bold" id="S3.Thmtheorem1.1.1.1">Proposition 3.1</span></span><span class="ltx_text ltx_font_bold" id="S3.Thmtheorem1.2.2">.</span>
</h6>
<div class="ltx_para" id="S3.Thmtheorem1.p1">
<p class="ltx_p" id="S3.Thmtheorem1.p1.6"><span class="ltx_text ltx_font_italic" id="S3.Thmtheorem1.p1.6.6">Assume the pretrained model <math alttext="f" class="ltx_Math" display="inline" id="S3.Thmtheorem1.p1.1.1.m1.1"><semantics id="S3.Thmtheorem1.p1.1.1.m1.1a"><mi id="S3.Thmtheorem1.p1.1.1.m1.1.1" xref="S3.Thmtheorem1.p1.1.1.m1.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="S3.Thmtheorem1.p1.1.1.m1.1b"><ci id="S3.Thmtheorem1.p1.1.1.m1.1.1.cmml" xref="S3.Thmtheorem1.p1.1.1.m1.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmtheorem1.p1.1.1.m1.1c">f</annotation><annotation encoding="application/x-llamapun" id="S3.Thmtheorem1.p1.1.1.m1.1d">italic_f</annotation></semantics></math> accurately represents the likelihood of the training data. Then, if performativity only surfaces in the marginal <math alttext="P(Y)" class="ltx_Math" display="inline" id="S3.Thmtheorem1.p1.2.2.m2.1"><semantics id="S3.Thmtheorem1.p1.2.2.m2.1a"><mrow id="S3.Thmtheorem1.p1.2.2.m2.1.2" xref="S3.Thmtheorem1.p1.2.2.m2.1.2.cmml"><mi id="S3.Thmtheorem1.p1.2.2.m2.1.2.2" xref="S3.Thmtheorem1.p1.2.2.m2.1.2.2.cmml">P</mi><mo id="S3.Thmtheorem1.p1.2.2.m2.1.2.1" xref="S3.Thmtheorem1.p1.2.2.m2.1.2.1.cmml">⁢</mo><mrow id="S3.Thmtheorem1.p1.2.2.m2.1.2.3.2" xref="S3.Thmtheorem1.p1.2.2.m2.1.2.cmml"><mo id="S3.Thmtheorem1.p1.2.2.m2.1.2.3.2.1" stretchy="false" xref="S3.Thmtheorem1.p1.2.2.m2.1.2.cmml">(</mo><mi id="S3.Thmtheorem1.p1.2.2.m2.1.1" xref="S3.Thmtheorem1.p1.2.2.m2.1.1.cmml">Y</mi><mo id="S3.Thmtheorem1.p1.2.2.m2.1.2.3.2.2" stretchy="false" xref="S3.Thmtheorem1.p1.2.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Thmtheorem1.p1.2.2.m2.1b"><apply id="S3.Thmtheorem1.p1.2.2.m2.1.2.cmml" xref="S3.Thmtheorem1.p1.2.2.m2.1.2"><times id="S3.Thmtheorem1.p1.2.2.m2.1.2.1.cmml" xref="S3.Thmtheorem1.p1.2.2.m2.1.2.1"></times><ci id="S3.Thmtheorem1.p1.2.2.m2.1.2.2.cmml" xref="S3.Thmtheorem1.p1.2.2.m2.1.2.2">𝑃</ci><ci id="S3.Thmtheorem1.p1.2.2.m2.1.1.cmml" xref="S3.Thmtheorem1.p1.2.2.m2.1.1">𝑌</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmtheorem1.p1.2.2.m2.1c">P(Y)</annotation><annotation encoding="application/x-llamapun" id="S3.Thmtheorem1.p1.2.2.m2.1d">italic_P ( italic_Y )</annotation></semantics></math>, and <math alttext="P(Y|X)" class="ltx_Math" display="inline" id="S3.Thmtheorem1.p1.3.3.m3.1"><semantics id="S3.Thmtheorem1.p1.3.3.m3.1a"><mrow id="S3.Thmtheorem1.p1.3.3.m3.1.1" xref="S3.Thmtheorem1.p1.3.3.m3.1.1.cmml"><mi id="S3.Thmtheorem1.p1.3.3.m3.1.1.3" xref="S3.Thmtheorem1.p1.3.3.m3.1.1.3.cmml">P</mi><mo id="S3.Thmtheorem1.p1.3.3.m3.1.1.2" xref="S3.Thmtheorem1.p1.3.3.m3.1.1.2.cmml">⁢</mo><mrow id="S3.Thmtheorem1.p1.3.3.m3.1.1.1.1" xref="S3.Thmtheorem1.p1.3.3.m3.1.1.1.1.1.cmml"><mo id="S3.Thmtheorem1.p1.3.3.m3.1.1.1.1.2" stretchy="false" xref="S3.Thmtheorem1.p1.3.3.m3.1.1.1.1.1.cmml">(</mo><mrow id="S3.Thmtheorem1.p1.3.3.m3.1.1.1.1.1" xref="S3.Thmtheorem1.p1.3.3.m3.1.1.1.1.1.cmml"><mi id="S3.Thmtheorem1.p1.3.3.m3.1.1.1.1.1.2" xref="S3.Thmtheorem1.p1.3.3.m3.1.1.1.1.1.2.cmml">Y</mi><mo fence="false" id="S3.Thmtheorem1.p1.3.3.m3.1.1.1.1.1.1" xref="S3.Thmtheorem1.p1.3.3.m3.1.1.1.1.1.1.cmml">|</mo><mi id="S3.Thmtheorem1.p1.3.3.m3.1.1.1.1.1.3" xref="S3.Thmtheorem1.p1.3.3.m3.1.1.1.1.1.3.cmml">X</mi></mrow><mo id="S3.Thmtheorem1.p1.3.3.m3.1.1.1.1.3" stretchy="false" xref="S3.Thmtheorem1.p1.3.3.m3.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Thmtheorem1.p1.3.3.m3.1b"><apply id="S3.Thmtheorem1.p1.3.3.m3.1.1.cmml" xref="S3.Thmtheorem1.p1.3.3.m3.1.1"><times id="S3.Thmtheorem1.p1.3.3.m3.1.1.2.cmml" xref="S3.Thmtheorem1.p1.3.3.m3.1.1.2"></times><ci id="S3.Thmtheorem1.p1.3.3.m3.1.1.3.cmml" xref="S3.Thmtheorem1.p1.3.3.m3.1.1.3">𝑃</ci><apply id="S3.Thmtheorem1.p1.3.3.m3.1.1.1.1.1.cmml" xref="S3.Thmtheorem1.p1.3.3.m3.1.1.1.1"><csymbol cd="latexml" id="S3.Thmtheorem1.p1.3.3.m3.1.1.1.1.1.1.cmml" xref="S3.Thmtheorem1.p1.3.3.m3.1.1.1.1.1.1">conditional</csymbol><ci id="S3.Thmtheorem1.p1.3.3.m3.1.1.1.1.1.2.cmml" xref="S3.Thmtheorem1.p1.3.3.m3.1.1.1.1.1.2">𝑌</ci><ci id="S3.Thmtheorem1.p1.3.3.m3.1.1.1.1.1.3.cmml" xref="S3.Thmtheorem1.p1.3.3.m3.1.1.1.1.1.3">𝑋</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmtheorem1.p1.3.3.m3.1c">P(Y|X)</annotation><annotation encoding="application/x-llamapun" id="S3.Thmtheorem1.p1.3.3.m3.1d">italic_P ( italic_Y | italic_X )</annotation></semantics></math> is unaffected by performativity, there exists a predictor <math alttext="T" class="ltx_Math" display="inline" id="S3.Thmtheorem1.p1.4.4.m4.1"><semantics id="S3.Thmtheorem1.p1.4.4.m4.1a"><mi id="S3.Thmtheorem1.p1.4.4.m4.1.1" xref="S3.Thmtheorem1.p1.4.4.m4.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S3.Thmtheorem1.p1.4.4.m4.1b"><ci id="S3.Thmtheorem1.p1.4.4.m4.1.1.cmml" xref="S3.Thmtheorem1.p1.4.4.m4.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmtheorem1.p1.4.4.m4.1c">T</annotation><annotation encoding="application/x-llamapun" id="S3.Thmtheorem1.p1.4.4.m4.1d">italic_T</annotation></semantics></math> such that <math alttext="F" class="ltx_Math" display="inline" id="S3.Thmtheorem1.p1.5.5.m5.1"><semantics id="S3.Thmtheorem1.p1.5.5.m5.1a"><mi id="S3.Thmtheorem1.p1.5.5.m5.1.1" xref="S3.Thmtheorem1.p1.5.5.m5.1.1.cmml">F</mi><annotation-xml encoding="MathML-Content" id="S3.Thmtheorem1.p1.5.5.m5.1b"><ci id="S3.Thmtheorem1.p1.5.5.m5.1.1.cmml" xref="S3.Thmtheorem1.p1.5.5.m5.1.1">𝐹</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmtheorem1.p1.5.5.m5.1c">F</annotation><annotation encoding="application/x-llamapun" id="S3.Thmtheorem1.p1.5.5.m5.1d">italic_F</annotation></semantics></math> recovers <math alttext="f_{\mathrm{perf}}" class="ltx_Math" display="inline" id="S3.Thmtheorem1.p1.6.6.m6.1"><semantics id="S3.Thmtheorem1.p1.6.6.m6.1a"><msub id="S3.Thmtheorem1.p1.6.6.m6.1.1" xref="S3.Thmtheorem1.p1.6.6.m6.1.1.cmml"><mi id="S3.Thmtheorem1.p1.6.6.m6.1.1.2" xref="S3.Thmtheorem1.p1.6.6.m6.1.1.2.cmml">f</mi><mi id="S3.Thmtheorem1.p1.6.6.m6.1.1.3" xref="S3.Thmtheorem1.p1.6.6.m6.1.1.3.cmml">perf</mi></msub><annotation-xml encoding="MathML-Content" id="S3.Thmtheorem1.p1.6.6.m6.1b"><apply id="S3.Thmtheorem1.p1.6.6.m6.1.1.cmml" xref="S3.Thmtheorem1.p1.6.6.m6.1.1"><csymbol cd="ambiguous" id="S3.Thmtheorem1.p1.6.6.m6.1.1.1.cmml" xref="S3.Thmtheorem1.p1.6.6.m6.1.1">subscript</csymbol><ci id="S3.Thmtheorem1.p1.6.6.m6.1.1.2.cmml" xref="S3.Thmtheorem1.p1.6.6.m6.1.1.2">𝑓</ci><ci id="S3.Thmtheorem1.p1.6.6.m6.1.1.3.cmml" xref="S3.Thmtheorem1.p1.6.6.m6.1.1.3">perf</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmtheorem1.p1.6.6.m6.1c">f_{\mathrm{perf}}</annotation><annotation encoding="application/x-llamapun" id="S3.Thmtheorem1.p1.6.6.m6.1d">italic_f start_POSTSUBSCRIPT roman_perf end_POSTSUBSCRIPT</annotation></semantics></math>.</span></p>
</div>
</div>
<div class="ltx_proof" id="S3.SS2.1">
<h6 class="ltx_title ltx_runin ltx_font_italic ltx_title_proof">Proof.</h6>
<div class="ltx_para" id="S3.SS2.1.p1">
<p class="ltx_p" id="S3.SS2.1.p1.2">Let <math alttext="T(S)=P(Y|S)" class="ltx_Math" display="inline" id="S3.SS2.1.p1.1.m1.2"><semantics id="S3.SS2.1.p1.1.m1.2a"><mrow id="S3.SS2.1.p1.1.m1.2.2" xref="S3.SS2.1.p1.1.m1.2.2.cmml"><mrow id="S3.SS2.1.p1.1.m1.2.2.3" xref="S3.SS2.1.p1.1.m1.2.2.3.cmml"><mi id="S3.SS2.1.p1.1.m1.2.2.3.2" xref="S3.SS2.1.p1.1.m1.2.2.3.2.cmml">T</mi><mo id="S3.SS2.1.p1.1.m1.2.2.3.1" xref="S3.SS2.1.p1.1.m1.2.2.3.1.cmml">⁢</mo><mrow id="S3.SS2.1.p1.1.m1.2.2.3.3.2" xref="S3.SS2.1.p1.1.m1.2.2.3.cmml"><mo id="S3.SS2.1.p1.1.m1.2.2.3.3.2.1" stretchy="false" xref="S3.SS2.1.p1.1.m1.2.2.3.cmml">(</mo><mi id="S3.SS2.1.p1.1.m1.1.1" xref="S3.SS2.1.p1.1.m1.1.1.cmml">S</mi><mo id="S3.SS2.1.p1.1.m1.2.2.3.3.2.2" stretchy="false" xref="S3.SS2.1.p1.1.m1.2.2.3.cmml">)</mo></mrow></mrow><mo id="S3.SS2.1.p1.1.m1.2.2.2" xref="S3.SS2.1.p1.1.m1.2.2.2.cmml">=</mo><mrow id="S3.SS2.1.p1.1.m1.2.2.1" xref="S3.SS2.1.p1.1.m1.2.2.1.cmml"><mi id="S3.SS2.1.p1.1.m1.2.2.1.3" xref="S3.SS2.1.p1.1.m1.2.2.1.3.cmml">P</mi><mo id="S3.SS2.1.p1.1.m1.2.2.1.2" xref="S3.SS2.1.p1.1.m1.2.2.1.2.cmml">⁢</mo><mrow id="S3.SS2.1.p1.1.m1.2.2.1.1.1" xref="S3.SS2.1.p1.1.m1.2.2.1.1.1.1.cmml"><mo id="S3.SS2.1.p1.1.m1.2.2.1.1.1.2" stretchy="false" xref="S3.SS2.1.p1.1.m1.2.2.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.1.p1.1.m1.2.2.1.1.1.1" xref="S3.SS2.1.p1.1.m1.2.2.1.1.1.1.cmml"><mi id="S3.SS2.1.p1.1.m1.2.2.1.1.1.1.2" xref="S3.SS2.1.p1.1.m1.2.2.1.1.1.1.2.cmml">Y</mi><mo fence="false" id="S3.SS2.1.p1.1.m1.2.2.1.1.1.1.1" xref="S3.SS2.1.p1.1.m1.2.2.1.1.1.1.1.cmml">|</mo><mi id="S3.SS2.1.p1.1.m1.2.2.1.1.1.1.3" xref="S3.SS2.1.p1.1.m1.2.2.1.1.1.1.3.cmml">S</mi></mrow><mo id="S3.SS2.1.p1.1.m1.2.2.1.1.1.3" stretchy="false" xref="S3.SS2.1.p1.1.m1.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.1.p1.1.m1.2b"><apply id="S3.SS2.1.p1.1.m1.2.2.cmml" xref="S3.SS2.1.p1.1.m1.2.2"><eq id="S3.SS2.1.p1.1.m1.2.2.2.cmml" xref="S3.SS2.1.p1.1.m1.2.2.2"></eq><apply id="S3.SS2.1.p1.1.m1.2.2.3.cmml" xref="S3.SS2.1.p1.1.m1.2.2.3"><times id="S3.SS2.1.p1.1.m1.2.2.3.1.cmml" xref="S3.SS2.1.p1.1.m1.2.2.3.1"></times><ci id="S3.SS2.1.p1.1.m1.2.2.3.2.cmml" xref="S3.SS2.1.p1.1.m1.2.2.3.2">𝑇</ci><ci id="S3.SS2.1.p1.1.m1.1.1.cmml" xref="S3.SS2.1.p1.1.m1.1.1">𝑆</ci></apply><apply id="S3.SS2.1.p1.1.m1.2.2.1.cmml" xref="S3.SS2.1.p1.1.m1.2.2.1"><times id="S3.SS2.1.p1.1.m1.2.2.1.2.cmml" xref="S3.SS2.1.p1.1.m1.2.2.1.2"></times><ci id="S3.SS2.1.p1.1.m1.2.2.1.3.cmml" xref="S3.SS2.1.p1.1.m1.2.2.1.3">𝑃</ci><apply id="S3.SS2.1.p1.1.m1.2.2.1.1.1.1.cmml" xref="S3.SS2.1.p1.1.m1.2.2.1.1.1"><csymbol cd="latexml" id="S3.SS2.1.p1.1.m1.2.2.1.1.1.1.1.cmml" xref="S3.SS2.1.p1.1.m1.2.2.1.1.1.1.1">conditional</csymbol><ci id="S3.SS2.1.p1.1.m1.2.2.1.1.1.1.2.cmml" xref="S3.SS2.1.p1.1.m1.2.2.1.1.1.1.2">𝑌</ci><ci id="S3.SS2.1.p1.1.m1.2.2.1.1.1.1.3.cmml" xref="S3.SS2.1.p1.1.m1.2.2.1.1.1.1.3">𝑆</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.1.p1.1.m1.2c">T(S)=P(Y|S)</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.1.p1.1.m1.2d">italic_T ( italic_S ) = italic_P ( italic_Y | italic_S )</annotation></semantics></math> and <math alttext="f(X)\propto P_{\mathrm{pre}}(Y|X)" class="ltx_Math" display="inline" id="S3.SS2.1.p1.2.m2.2"><semantics id="S3.SS2.1.p1.2.m2.2a"><mrow id="S3.SS2.1.p1.2.m2.2.2" xref="S3.SS2.1.p1.2.m2.2.2.cmml"><mrow id="S3.SS2.1.p1.2.m2.2.2.3" xref="S3.SS2.1.p1.2.m2.2.2.3.cmml"><mi id="S3.SS2.1.p1.2.m2.2.2.3.2" xref="S3.SS2.1.p1.2.m2.2.2.3.2.cmml">f</mi><mo id="S3.SS2.1.p1.2.m2.2.2.3.1" xref="S3.SS2.1.p1.2.m2.2.2.3.1.cmml">⁢</mo><mrow id="S3.SS2.1.p1.2.m2.2.2.3.3.2" xref="S3.SS2.1.p1.2.m2.2.2.3.cmml"><mo id="S3.SS2.1.p1.2.m2.2.2.3.3.2.1" stretchy="false" xref="S3.SS2.1.p1.2.m2.2.2.3.cmml">(</mo><mi id="S3.SS2.1.p1.2.m2.1.1" xref="S3.SS2.1.p1.2.m2.1.1.cmml">X</mi><mo id="S3.SS2.1.p1.2.m2.2.2.3.3.2.2" stretchy="false" xref="S3.SS2.1.p1.2.m2.2.2.3.cmml">)</mo></mrow></mrow><mo id="S3.SS2.1.p1.2.m2.2.2.2" xref="S3.SS2.1.p1.2.m2.2.2.2.cmml">∝</mo><mrow id="S3.SS2.1.p1.2.m2.2.2.1" xref="S3.SS2.1.p1.2.m2.2.2.1.cmml"><msub id="S3.SS2.1.p1.2.m2.2.2.1.3" xref="S3.SS2.1.p1.2.m2.2.2.1.3.cmml"><mi id="S3.SS2.1.p1.2.m2.2.2.1.3.2" xref="S3.SS2.1.p1.2.m2.2.2.1.3.2.cmml">P</mi><mi id="S3.SS2.1.p1.2.m2.2.2.1.3.3" xref="S3.SS2.1.p1.2.m2.2.2.1.3.3.cmml">pre</mi></msub><mo id="S3.SS2.1.p1.2.m2.2.2.1.2" xref="S3.SS2.1.p1.2.m2.2.2.1.2.cmml">⁢</mo><mrow id="S3.SS2.1.p1.2.m2.2.2.1.1.1" xref="S3.SS2.1.p1.2.m2.2.2.1.1.1.1.cmml"><mo id="S3.SS2.1.p1.2.m2.2.2.1.1.1.2" stretchy="false" xref="S3.SS2.1.p1.2.m2.2.2.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.1.p1.2.m2.2.2.1.1.1.1" xref="S3.SS2.1.p1.2.m2.2.2.1.1.1.1.cmml"><mi id="S3.SS2.1.p1.2.m2.2.2.1.1.1.1.2" xref="S3.SS2.1.p1.2.m2.2.2.1.1.1.1.2.cmml">Y</mi><mo fence="false" id="S3.SS2.1.p1.2.m2.2.2.1.1.1.1.1" xref="S3.SS2.1.p1.2.m2.2.2.1.1.1.1.1.cmml">|</mo><mi id="S3.SS2.1.p1.2.m2.2.2.1.1.1.1.3" xref="S3.SS2.1.p1.2.m2.2.2.1.1.1.1.3.cmml">X</mi></mrow><mo id="S3.SS2.1.p1.2.m2.2.2.1.1.1.3" stretchy="false" xref="S3.SS2.1.p1.2.m2.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.1.p1.2.m2.2b"><apply id="S3.SS2.1.p1.2.m2.2.2.cmml" xref="S3.SS2.1.p1.2.m2.2.2"><csymbol cd="latexml" id="S3.SS2.1.p1.2.m2.2.2.2.cmml" xref="S3.SS2.1.p1.2.m2.2.2.2">proportional-to</csymbol><apply id="S3.SS2.1.p1.2.m2.2.2.3.cmml" xref="S3.SS2.1.p1.2.m2.2.2.3"><times id="S3.SS2.1.p1.2.m2.2.2.3.1.cmml" xref="S3.SS2.1.p1.2.m2.2.2.3.1"></times><ci id="S3.SS2.1.p1.2.m2.2.2.3.2.cmml" xref="S3.SS2.1.p1.2.m2.2.2.3.2">𝑓</ci><ci id="S3.SS2.1.p1.2.m2.1.1.cmml" xref="S3.SS2.1.p1.2.m2.1.1">𝑋</ci></apply><apply id="S3.SS2.1.p1.2.m2.2.2.1.cmml" xref="S3.SS2.1.p1.2.m2.2.2.1"><times id="S3.SS2.1.p1.2.m2.2.2.1.2.cmml" xref="S3.SS2.1.p1.2.m2.2.2.1.2"></times><apply id="S3.SS2.1.p1.2.m2.2.2.1.3.cmml" xref="S3.SS2.1.p1.2.m2.2.2.1.3"><csymbol cd="ambiguous" id="S3.SS2.1.p1.2.m2.2.2.1.3.1.cmml" xref="S3.SS2.1.p1.2.m2.2.2.1.3">subscript</csymbol><ci id="S3.SS2.1.p1.2.m2.2.2.1.3.2.cmml" xref="S3.SS2.1.p1.2.m2.2.2.1.3.2">𝑃</ci><ci id="S3.SS2.1.p1.2.m2.2.2.1.3.3.cmml" xref="S3.SS2.1.p1.2.m2.2.2.1.3.3">pre</ci></apply><apply id="S3.SS2.1.p1.2.m2.2.2.1.1.1.1.cmml" xref="S3.SS2.1.p1.2.m2.2.2.1.1.1"><csymbol cd="latexml" id="S3.SS2.1.p1.2.m2.2.2.1.1.1.1.1.cmml" xref="S3.SS2.1.p1.2.m2.2.2.1.1.1.1.1">conditional</csymbol><ci id="S3.SS2.1.p1.2.m2.2.2.1.1.1.1.2.cmml" xref="S3.SS2.1.p1.2.m2.2.2.1.1.1.1.2">𝑌</ci><ci id="S3.SS2.1.p1.2.m2.2.2.1.1.1.1.3.cmml" xref="S3.SS2.1.p1.2.m2.2.2.1.1.1.1.3">𝑋</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.1.p1.2.m2.2c">f(X)\propto P_{\mathrm{pre}}(Y|X)</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.1.p1.2.m2.2d">italic_f ( italic_X ) ∝ italic_P start_POSTSUBSCRIPT roman_pre end_POSTSUBSCRIPT ( italic_Y | italic_X )</annotation></semantics></math>. Then, following <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#bib.bib69" title="">69</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#bib.bib68" title="">68</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#bib.bib57" title="">57</a>]</cite> we have</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A1.EGx2">
<tbody id="S3.E4"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\small\lambda_{i}(S)[f(X)]_{i}\approx\frac{P_{t}(Y=i)}{P_{\mathrm%
{pre}}(Y=i)}\cdot P_{\mathrm{pre}}(Y=i|X)=\frac{P_{t}(X)}{P_{\mathrm{pre}}(X)}%
\cdot P_{t}(Y=i|X)\propto P_{t}(Y=i|X)." class="ltx_Math" display="inline" id="S3.E4.m1.7"><semantics id="S3.E4.m1.7a"><mrow id="S3.E4.m1.7.7.1" xref="S3.E4.m1.7.7.1.1.cmml"><mrow id="S3.E4.m1.7.7.1.1" xref="S3.E4.m1.7.7.1.1.cmml"><mrow id="S3.E4.m1.7.7.1.1.1" xref="S3.E4.m1.7.7.1.1.1.cmml"><msub id="S3.E4.m1.7.7.1.1.1.3" xref="S3.E4.m1.7.7.1.1.1.3.cmml"><mi id="S3.E4.m1.7.7.1.1.1.3.2" mathsize="90%" xref="S3.E4.m1.7.7.1.1.1.3.2.cmml">λ</mi><mi id="S3.E4.m1.7.7.1.1.1.3.3" mathsize="90%" xref="S3.E4.m1.7.7.1.1.1.3.3.cmml">i</mi></msub><mo id="S3.E4.m1.7.7.1.1.1.2" xref="S3.E4.m1.7.7.1.1.1.2.cmml">⁢</mo><mrow id="S3.E4.m1.7.7.1.1.1.4.2" xref="S3.E4.m1.7.7.1.1.1.cmml"><mo id="S3.E4.m1.7.7.1.1.1.4.2.1" maxsize="90%" minsize="90%" xref="S3.E4.m1.7.7.1.1.1.cmml">(</mo><mi id="S3.E4.m1.5.5" mathsize="90%" xref="S3.E4.m1.5.5.cmml">S</mi><mo id="S3.E4.m1.7.7.1.1.1.4.2.2" maxsize="90%" minsize="90%" xref="S3.E4.m1.7.7.1.1.1.cmml">)</mo></mrow><mo id="S3.E4.m1.7.7.1.1.1.2a" xref="S3.E4.m1.7.7.1.1.1.2.cmml">⁢</mo><msub id="S3.E4.m1.7.7.1.1.1.1" xref="S3.E4.m1.7.7.1.1.1.1.cmml"><mrow id="S3.E4.m1.7.7.1.1.1.1.1.1" xref="S3.E4.m1.7.7.1.1.1.1.1.2.cmml"><mo id="S3.E4.m1.7.7.1.1.1.1.1.1.2" maxsize="90%" minsize="90%" xref="S3.E4.m1.7.7.1.1.1.1.1.2.1.cmml">[</mo><mrow id="S3.E4.m1.7.7.1.1.1.1.1.1.1" xref="S3.E4.m1.7.7.1.1.1.1.1.1.1.cmml"><mi id="S3.E4.m1.7.7.1.1.1.1.1.1.1.2" mathsize="90%" xref="S3.E4.m1.7.7.1.1.1.1.1.1.1.2.cmml">f</mi><mo id="S3.E4.m1.7.7.1.1.1.1.1.1.1.1" xref="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S3.E4.m1.7.7.1.1.1.1.1.1.1.3.2" xref="S3.E4.m1.7.7.1.1.1.1.1.1.1.cmml"><mo id="S3.E4.m1.7.7.1.1.1.1.1.1.1.3.2.1" maxsize="90%" minsize="90%" xref="S3.E4.m1.7.7.1.1.1.1.1.1.1.cmml">(</mo><mi id="S3.E4.m1.6.6" mathsize="90%" xref="S3.E4.m1.6.6.cmml">X</mi><mo id="S3.E4.m1.7.7.1.1.1.1.1.1.1.3.2.2" maxsize="90%" minsize="90%" xref="S3.E4.m1.7.7.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E4.m1.7.7.1.1.1.1.1.1.3" maxsize="90%" minsize="90%" xref="S3.E4.m1.7.7.1.1.1.1.1.2.1.cmml">]</mo></mrow><mi id="S3.E4.m1.7.7.1.1.1.1.3" mathsize="90%" xref="S3.E4.m1.7.7.1.1.1.1.3.cmml">i</mi></msub></mrow><mo id="S3.E4.m1.7.7.1.1.6" mathsize="90%" xref="S3.E4.m1.7.7.1.1.6.cmml">≈</mo><mrow id="S3.E4.m1.7.7.1.1.2" xref="S3.E4.m1.7.7.1.1.2.cmml"><mrow id="S3.E4.m1.7.7.1.1.2.3" xref="S3.E4.m1.7.7.1.1.2.3.cmml"><mstyle displaystyle="true" id="S3.E4.m1.2.2" xref="S3.E4.m1.2.2.cmml"><mfrac id="S3.E4.m1.2.2a" xref="S3.E4.m1.2.2.cmml"><mrow id="S3.E4.m1.1.1.1" xref="S3.E4.m1.1.1.1.cmml"><msub id="S3.E4.m1.1.1.1.3" xref="S3.E4.m1.1.1.1.3.cmml"><mi id="S3.E4.m1.1.1.1.3.2" mathsize="90%" xref="S3.E4.m1.1.1.1.3.2.cmml">P</mi><mi id="S3.E4.m1.1.1.1.3.3" mathsize="90%" xref="S3.E4.m1.1.1.1.3.3.cmml">t</mi></msub><mo id="S3.E4.m1.1.1.1.2" xref="S3.E4.m1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E4.m1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.1.cmml"><mo id="S3.E4.m1.1.1.1.1.1.2" maxsize="90%" minsize="90%" xref="S3.E4.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E4.m1.1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.1.cmml"><mi id="S3.E4.m1.1.1.1.1.1.1.2" mathsize="90%" xref="S3.E4.m1.1.1.1.1.1.1.2.cmml">Y</mi><mo id="S3.E4.m1.1.1.1.1.1.1.1" mathsize="90%" xref="S3.E4.m1.1.1.1.1.1.1.1.cmml">=</mo><mi id="S3.E4.m1.1.1.1.1.1.1.3" mathsize="90%" xref="S3.E4.m1.1.1.1.1.1.1.3.cmml">i</mi></mrow><mo id="S3.E4.m1.1.1.1.1.1.3" maxsize="90%" minsize="90%" xref="S3.E4.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="S3.E4.m1.2.2.2" xref="S3.E4.m1.2.2.2.cmml"><msub id="S3.E4.m1.2.2.2.3" xref="S3.E4.m1.2.2.2.3.cmml"><mi id="S3.E4.m1.2.2.2.3.2" mathsize="90%" xref="S3.E4.m1.2.2.2.3.2.cmml">P</mi><mi id="S3.E4.m1.2.2.2.3.3" mathsize="90%" xref="S3.E4.m1.2.2.2.3.3.cmml">pre</mi></msub><mo id="S3.E4.m1.2.2.2.2" xref="S3.E4.m1.2.2.2.2.cmml">⁢</mo><mrow id="S3.E4.m1.2.2.2.1.1" xref="S3.E4.m1.2.2.2.1.1.1.cmml"><mo id="S3.E4.m1.2.2.2.1.1.2" maxsize="90%" minsize="90%" xref="S3.E4.m1.2.2.2.1.1.1.cmml">(</mo><mrow id="S3.E4.m1.2.2.2.1.1.1" xref="S3.E4.m1.2.2.2.1.1.1.cmml"><mi id="S3.E4.m1.2.2.2.1.1.1.2" mathsize="90%" xref="S3.E4.m1.2.2.2.1.1.1.2.cmml">Y</mi><mo id="S3.E4.m1.2.2.2.1.1.1.1" mathsize="90%" xref="S3.E4.m1.2.2.2.1.1.1.1.cmml">=</mo><mi id="S3.E4.m1.2.2.2.1.1.1.3" mathsize="90%" xref="S3.E4.m1.2.2.2.1.1.1.3.cmml">i</mi></mrow><mo id="S3.E4.m1.2.2.2.1.1.3" maxsize="90%" minsize="90%" xref="S3.E4.m1.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mstyle><mo id="S3.E4.m1.7.7.1.1.2.3.1" lspace="0.222em" mathsize="90%" rspace="0.222em" xref="S3.E4.m1.7.7.1.1.2.3.1.cmml">⋅</mo><msub id="S3.E4.m1.7.7.1.1.2.3.2" xref="S3.E4.m1.7.7.1.1.2.3.2.cmml"><mi id="S3.E4.m1.7.7.1.1.2.3.2.2" mathsize="90%" xref="S3.E4.m1.7.7.1.1.2.3.2.2.cmml">P</mi><mi id="S3.E4.m1.7.7.1.1.2.3.2.3" mathsize="90%" xref="S3.E4.m1.7.7.1.1.2.3.2.3.cmml">pre</mi></msub></mrow><mo id="S3.E4.m1.7.7.1.1.2.2" xref="S3.E4.m1.7.7.1.1.2.2.cmml">⁢</mo><mrow id="S3.E4.m1.7.7.1.1.2.1.1" xref="S3.E4.m1.7.7.1.1.2.1.1.1.cmml"><mo id="S3.E4.m1.7.7.1.1.2.1.1.2" maxsize="90%" minsize="90%" xref="S3.E4.m1.7.7.1.1.2.1.1.1.cmml">(</mo><mrow id="S3.E4.m1.7.7.1.1.2.1.1.1" xref="S3.E4.m1.7.7.1.1.2.1.1.1.cmml"><mi id="S3.E4.m1.7.7.1.1.2.1.1.1.2" mathsize="90%" xref="S3.E4.m1.7.7.1.1.2.1.1.1.2.cmml">Y</mi><mo id="S3.E4.m1.7.7.1.1.2.1.1.1.1" mathsize="90%" xref="S3.E4.m1.7.7.1.1.2.1.1.1.1.cmml">=</mo><mrow id="S3.E4.m1.7.7.1.1.2.1.1.1.3" xref="S3.E4.m1.7.7.1.1.2.1.1.1.3.cmml"><mi id="S3.E4.m1.7.7.1.1.2.1.1.1.3.2" mathsize="90%" xref="S3.E4.m1.7.7.1.1.2.1.1.1.3.2.cmml">i</mi><mo fence="false" id="S3.E4.m1.7.7.1.1.2.1.1.1.3.1" mathsize="90%" xref="S3.E4.m1.7.7.1.1.2.1.1.1.3.1.cmml">|</mo><mi id="S3.E4.m1.7.7.1.1.2.1.1.1.3.3" mathsize="90%" xref="S3.E4.m1.7.7.1.1.2.1.1.1.3.3.cmml">X</mi></mrow></mrow><mo id="S3.E4.m1.7.7.1.1.2.1.1.3" maxsize="90%" minsize="90%" xref="S3.E4.m1.7.7.1.1.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E4.m1.7.7.1.1.7" mathsize="90%" xref="S3.E4.m1.7.7.1.1.7.cmml">=</mo><mrow id="S3.E4.m1.7.7.1.1.3" xref="S3.E4.m1.7.7.1.1.3.cmml"><mrow id="S3.E4.m1.7.7.1.1.3.3" xref="S3.E4.m1.7.7.1.1.3.3.cmml"><mstyle displaystyle="true" id="S3.E4.m1.4.4" xref="S3.E4.m1.4.4.cmml"><mfrac id="S3.E4.m1.4.4a" xref="S3.E4.m1.4.4.cmml"><mrow id="S3.E4.m1.3.3.1" xref="S3.E4.m1.3.3.1.cmml"><msub id="S3.E4.m1.3.3.1.3" xref="S3.E4.m1.3.3.1.3.cmml"><mi id="S3.E4.m1.3.3.1.3.2" mathsize="90%" xref="S3.E4.m1.3.3.1.3.2.cmml">P</mi><mi id="S3.E4.m1.3.3.1.3.3" mathsize="90%" xref="S3.E4.m1.3.3.1.3.3.cmml">t</mi></msub><mo id="S3.E4.m1.3.3.1.2" xref="S3.E4.m1.3.3.1.2.cmml">⁢</mo><mrow id="S3.E4.m1.3.3.1.4.2" xref="S3.E4.m1.3.3.1.cmml"><mo id="S3.E4.m1.3.3.1.4.2.1" maxsize="90%" minsize="90%" xref="S3.E4.m1.3.3.1.cmml">(</mo><mi id="S3.E4.m1.3.3.1.1" mathsize="90%" xref="S3.E4.m1.3.3.1.1.cmml">X</mi><mo id="S3.E4.m1.3.3.1.4.2.2" maxsize="90%" minsize="90%" xref="S3.E4.m1.3.3.1.cmml">)</mo></mrow></mrow><mrow id="S3.E4.m1.4.4.2" xref="S3.E4.m1.4.4.2.cmml"><msub id="S3.E4.m1.4.4.2.3" xref="S3.E4.m1.4.4.2.3.cmml"><mi id="S3.E4.m1.4.4.2.3.2" mathsize="90%" xref="S3.E4.m1.4.4.2.3.2.cmml">P</mi><mi id="S3.E4.m1.4.4.2.3.3" mathsize="90%" xref="S3.E4.m1.4.4.2.3.3.cmml">pre</mi></msub><mo id="S3.E4.m1.4.4.2.2" xref="S3.E4.m1.4.4.2.2.cmml">⁢</mo><mrow id="S3.E4.m1.4.4.2.4.2" xref="S3.E4.m1.4.4.2.cmml"><mo id="S3.E4.m1.4.4.2.4.2.1" maxsize="90%" minsize="90%" xref="S3.E4.m1.4.4.2.cmml">(</mo><mi id="S3.E4.m1.4.4.2.1" mathsize="90%" xref="S3.E4.m1.4.4.2.1.cmml">X</mi><mo id="S3.E4.m1.4.4.2.4.2.2" maxsize="90%" minsize="90%" xref="S3.E4.m1.4.4.2.cmml">)</mo></mrow></mrow></mfrac></mstyle><mo id="S3.E4.m1.7.7.1.1.3.3.1" lspace="0.222em" mathsize="90%" rspace="0.222em" xref="S3.E4.m1.7.7.1.1.3.3.1.cmml">⋅</mo><msub id="S3.E4.m1.7.7.1.1.3.3.2" xref="S3.E4.m1.7.7.1.1.3.3.2.cmml"><mi id="S3.E4.m1.7.7.1.1.3.3.2.2" mathsize="90%" xref="S3.E4.m1.7.7.1.1.3.3.2.2.cmml">P</mi><mi id="S3.E4.m1.7.7.1.1.3.3.2.3" mathsize="90%" xref="S3.E4.m1.7.7.1.1.3.3.2.3.cmml">t</mi></msub></mrow><mo id="S3.E4.m1.7.7.1.1.3.2" xref="S3.E4.m1.7.7.1.1.3.2.cmml">⁢</mo><mrow id="S3.E4.m1.7.7.1.1.3.1.1" xref="S3.E4.m1.7.7.1.1.3.1.1.1.cmml"><mo id="S3.E4.m1.7.7.1.1.3.1.1.2" maxsize="90%" minsize="90%" xref="S3.E4.m1.7.7.1.1.3.1.1.1.cmml">(</mo><mrow id="S3.E4.m1.7.7.1.1.3.1.1.1" xref="S3.E4.m1.7.7.1.1.3.1.1.1.cmml"><mi id="S3.E4.m1.7.7.1.1.3.1.1.1.2" mathsize="90%" xref="S3.E4.m1.7.7.1.1.3.1.1.1.2.cmml">Y</mi><mo id="S3.E4.m1.7.7.1.1.3.1.1.1.1" mathsize="90%" xref="S3.E4.m1.7.7.1.1.3.1.1.1.1.cmml">=</mo><mrow id="S3.E4.m1.7.7.1.1.3.1.1.1.3" xref="S3.E4.m1.7.7.1.1.3.1.1.1.3.cmml"><mi id="S3.E4.m1.7.7.1.1.3.1.1.1.3.2" mathsize="90%" xref="S3.E4.m1.7.7.1.1.3.1.1.1.3.2.cmml">i</mi><mo fence="false" id="S3.E4.m1.7.7.1.1.3.1.1.1.3.1" mathsize="90%" xref="S3.E4.m1.7.7.1.1.3.1.1.1.3.1.cmml">|</mo><mi id="S3.E4.m1.7.7.1.1.3.1.1.1.3.3" mathsize="90%" xref="S3.E4.m1.7.7.1.1.3.1.1.1.3.3.cmml">X</mi></mrow></mrow><mo id="S3.E4.m1.7.7.1.1.3.1.1.3" maxsize="90%" minsize="90%" xref="S3.E4.m1.7.7.1.1.3.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E4.m1.7.7.1.1.8" mathsize="90%" xref="S3.E4.m1.7.7.1.1.8.cmml">∝</mo><mrow id="S3.E4.m1.7.7.1.1.4" xref="S3.E4.m1.7.7.1.1.4.cmml"><msub id="S3.E4.m1.7.7.1.1.4.3" xref="S3.E4.m1.7.7.1.1.4.3.cmml"><mi id="S3.E4.m1.7.7.1.1.4.3.2" mathsize="90%" xref="S3.E4.m1.7.7.1.1.4.3.2.cmml">P</mi><mi id="S3.E4.m1.7.7.1.1.4.3.3" mathsize="90%" xref="S3.E4.m1.7.7.1.1.4.3.3.cmml">t</mi></msub><mo id="S3.E4.m1.7.7.1.1.4.2" xref="S3.E4.m1.7.7.1.1.4.2.cmml">⁢</mo><mrow id="S3.E4.m1.7.7.1.1.4.1.1" xref="S3.E4.m1.7.7.1.1.4.1.1.1.cmml"><mo id="S3.E4.m1.7.7.1.1.4.1.1.2" maxsize="90%" minsize="90%" xref="S3.E4.m1.7.7.1.1.4.1.1.1.cmml">(</mo><mrow id="S3.E4.m1.7.7.1.1.4.1.1.1" xref="S3.E4.m1.7.7.1.1.4.1.1.1.cmml"><mi id="S3.E4.m1.7.7.1.1.4.1.1.1.2" mathsize="90%" xref="S3.E4.m1.7.7.1.1.4.1.1.1.2.cmml">Y</mi><mo id="S3.E4.m1.7.7.1.1.4.1.1.1.1" mathsize="90%" xref="S3.E4.m1.7.7.1.1.4.1.1.1.1.cmml">=</mo><mrow id="S3.E4.m1.7.7.1.1.4.1.1.1.3" xref="S3.E4.m1.7.7.1.1.4.1.1.1.3.cmml"><mi id="S3.E4.m1.7.7.1.1.4.1.1.1.3.2" mathsize="90%" xref="S3.E4.m1.7.7.1.1.4.1.1.1.3.2.cmml">i</mi><mo fence="false" id="S3.E4.m1.7.7.1.1.4.1.1.1.3.1" mathsize="90%" xref="S3.E4.m1.7.7.1.1.4.1.1.1.3.1.cmml">|</mo><mi id="S3.E4.m1.7.7.1.1.4.1.1.1.3.3" mathsize="90%" xref="S3.E4.m1.7.7.1.1.4.1.1.1.3.3.cmml">X</mi></mrow></mrow><mo id="S3.E4.m1.7.7.1.1.4.1.1.3" maxsize="90%" minsize="90%" xref="S3.E4.m1.7.7.1.1.4.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E4.m1.7.7.1.2" lspace="0em" mathsize="90%" xref="S3.E4.m1.7.7.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.7b"><apply id="S3.E4.m1.7.7.1.1.cmml" xref="S3.E4.m1.7.7.1"><and id="S3.E4.m1.7.7.1.1a.cmml" xref="S3.E4.m1.7.7.1"></and><apply id="S3.E4.m1.7.7.1.1b.cmml" xref="S3.E4.m1.7.7.1"><approx id="S3.E4.m1.7.7.1.1.6.cmml" xref="S3.E4.m1.7.7.1.1.6"></approx><apply id="S3.E4.m1.7.7.1.1.1.cmml" xref="S3.E4.m1.7.7.1.1.1"><times id="S3.E4.m1.7.7.1.1.1.2.cmml" xref="S3.E4.m1.7.7.1.1.1.2"></times><apply id="S3.E4.m1.7.7.1.1.1.3.cmml" xref="S3.E4.m1.7.7.1.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.7.7.1.1.1.3.1.cmml" xref="S3.E4.m1.7.7.1.1.1.3">subscript</csymbol><ci id="S3.E4.m1.7.7.1.1.1.3.2.cmml" xref="S3.E4.m1.7.7.1.1.1.3.2">𝜆</ci><ci id="S3.E4.m1.7.7.1.1.1.3.3.cmml" xref="S3.E4.m1.7.7.1.1.1.3.3">𝑖</ci></apply><ci id="S3.E4.m1.5.5.cmml" xref="S3.E4.m1.5.5">𝑆</ci><apply id="S3.E4.m1.7.7.1.1.1.1.cmml" xref="S3.E4.m1.7.7.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.7.7.1.1.1.1.2.cmml" xref="S3.E4.m1.7.7.1.1.1.1">subscript</csymbol><apply id="S3.E4.m1.7.7.1.1.1.1.1.2.cmml" xref="S3.E4.m1.7.7.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E4.m1.7.7.1.1.1.1.1.2.1.cmml" xref="S3.E4.m1.7.7.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.E4.m1.7.7.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.7.7.1.1.1.1.1.1.1"><times id="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.7.7.1.1.1.1.1.1.1.1"></times><ci id="S3.E4.m1.7.7.1.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.7.7.1.1.1.1.1.1.1.2">𝑓</ci><ci id="S3.E4.m1.6.6.cmml" xref="S3.E4.m1.6.6">𝑋</ci></apply></apply><ci id="S3.E4.m1.7.7.1.1.1.1.3.cmml" xref="S3.E4.m1.7.7.1.1.1.1.3">𝑖</ci></apply></apply><apply id="S3.E4.m1.7.7.1.1.2.cmml" xref="S3.E4.m1.7.7.1.1.2"><times id="S3.E4.m1.7.7.1.1.2.2.cmml" xref="S3.E4.m1.7.7.1.1.2.2"></times><apply id="S3.E4.m1.7.7.1.1.2.3.cmml" xref="S3.E4.m1.7.7.1.1.2.3"><ci id="S3.E4.m1.7.7.1.1.2.3.1.cmml" xref="S3.E4.m1.7.7.1.1.2.3.1">⋅</ci><apply id="S3.E4.m1.2.2.cmml" xref="S3.E4.m1.2.2"><divide id="S3.E4.m1.2.2.3.cmml" xref="S3.E4.m1.2.2"></divide><apply id="S3.E4.m1.1.1.1.cmml" xref="S3.E4.m1.1.1.1"><times id="S3.E4.m1.1.1.1.2.cmml" xref="S3.E4.m1.1.1.1.2"></times><apply id="S3.E4.m1.1.1.1.3.cmml" xref="S3.E4.m1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.3.1.cmml" xref="S3.E4.m1.1.1.1.3">subscript</csymbol><ci id="S3.E4.m1.1.1.1.3.2.cmml" xref="S3.E4.m1.1.1.1.3.2">𝑃</ci><ci id="S3.E4.m1.1.1.1.3.3.cmml" xref="S3.E4.m1.1.1.1.3.3">𝑡</ci></apply><apply id="S3.E4.m1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1"><eq id="S3.E4.m1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1"></eq><ci id="S3.E4.m1.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.1.1.1.1.1.1.2">𝑌</ci><ci id="S3.E4.m1.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.1.1.1.1.1.1.3">𝑖</ci></apply></apply><apply id="S3.E4.m1.2.2.2.cmml" xref="S3.E4.m1.2.2.2"><times id="S3.E4.m1.2.2.2.2.cmml" xref="S3.E4.m1.2.2.2.2"></times><apply id="S3.E4.m1.2.2.2.3.cmml" xref="S3.E4.m1.2.2.2.3"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.2.3.1.cmml" xref="S3.E4.m1.2.2.2.3">subscript</csymbol><ci id="S3.E4.m1.2.2.2.3.2.cmml" xref="S3.E4.m1.2.2.2.3.2">𝑃</ci><ci id="S3.E4.m1.2.2.2.3.3.cmml" xref="S3.E4.m1.2.2.2.3.3">pre</ci></apply><apply id="S3.E4.m1.2.2.2.1.1.1.cmml" xref="S3.E4.m1.2.2.2.1.1"><eq id="S3.E4.m1.2.2.2.1.1.1.1.cmml" xref="S3.E4.m1.2.2.2.1.1.1.1"></eq><ci id="S3.E4.m1.2.2.2.1.1.1.2.cmml" xref="S3.E4.m1.2.2.2.1.1.1.2">𝑌</ci><ci id="S3.E4.m1.2.2.2.1.1.1.3.cmml" xref="S3.E4.m1.2.2.2.1.1.1.3">𝑖</ci></apply></apply></apply><apply id="S3.E4.m1.7.7.1.1.2.3.2.cmml" xref="S3.E4.m1.7.7.1.1.2.3.2"><csymbol cd="ambiguous" id="S3.E4.m1.7.7.1.1.2.3.2.1.cmml" xref="S3.E4.m1.7.7.1.1.2.3.2">subscript</csymbol><ci id="S3.E4.m1.7.7.1.1.2.3.2.2.cmml" xref="S3.E4.m1.7.7.1.1.2.3.2.2">𝑃</ci><ci id="S3.E4.m1.7.7.1.1.2.3.2.3.cmml" xref="S3.E4.m1.7.7.1.1.2.3.2.3">pre</ci></apply></apply><apply id="S3.E4.m1.7.7.1.1.2.1.1.1.cmml" xref="S3.E4.m1.7.7.1.1.2.1.1"><eq id="S3.E4.m1.7.7.1.1.2.1.1.1.1.cmml" xref="S3.E4.m1.7.7.1.1.2.1.1.1.1"></eq><ci id="S3.E4.m1.7.7.1.1.2.1.1.1.2.cmml" xref="S3.E4.m1.7.7.1.1.2.1.1.1.2">𝑌</ci><apply id="S3.E4.m1.7.7.1.1.2.1.1.1.3.cmml" xref="S3.E4.m1.7.7.1.1.2.1.1.1.3"><csymbol cd="latexml" id="S3.E4.m1.7.7.1.1.2.1.1.1.3.1.cmml" xref="S3.E4.m1.7.7.1.1.2.1.1.1.3.1">conditional</csymbol><ci id="S3.E4.m1.7.7.1.1.2.1.1.1.3.2.cmml" xref="S3.E4.m1.7.7.1.1.2.1.1.1.3.2">𝑖</ci><ci id="S3.E4.m1.7.7.1.1.2.1.1.1.3.3.cmml" xref="S3.E4.m1.7.7.1.1.2.1.1.1.3.3">𝑋</ci></apply></apply></apply></apply><apply id="S3.E4.m1.7.7.1.1c.cmml" xref="S3.E4.m1.7.7.1"><eq id="S3.E4.m1.7.7.1.1.7.cmml" xref="S3.E4.m1.7.7.1.1.7"></eq><share href="https://arxiv.org/html/2410.04499v1#S3.E4.m1.7.7.1.1.2.cmml" id="S3.E4.m1.7.7.1.1d.cmml" xref="S3.E4.m1.7.7.1"></share><apply id="S3.E4.m1.7.7.1.1.3.cmml" xref="S3.E4.m1.7.7.1.1.3"><times id="S3.E4.m1.7.7.1.1.3.2.cmml" xref="S3.E4.m1.7.7.1.1.3.2"></times><apply id="S3.E4.m1.7.7.1.1.3.3.cmml" xref="S3.E4.m1.7.7.1.1.3.3"><ci id="S3.E4.m1.7.7.1.1.3.3.1.cmml" xref="S3.E4.m1.7.7.1.1.3.3.1">⋅</ci><apply id="S3.E4.m1.4.4.cmml" xref="S3.E4.m1.4.4"><divide id="S3.E4.m1.4.4.3.cmml" xref="S3.E4.m1.4.4"></divide><apply id="S3.E4.m1.3.3.1.cmml" xref="S3.E4.m1.3.3.1"><times id="S3.E4.m1.3.3.1.2.cmml" xref="S3.E4.m1.3.3.1.2"></times><apply id="S3.E4.m1.3.3.1.3.cmml" xref="S3.E4.m1.3.3.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.3.3.1.3.1.cmml" xref="S3.E4.m1.3.3.1.3">subscript</csymbol><ci id="S3.E4.m1.3.3.1.3.2.cmml" xref="S3.E4.m1.3.3.1.3.2">𝑃</ci><ci id="S3.E4.m1.3.3.1.3.3.cmml" xref="S3.E4.m1.3.3.1.3.3">𝑡</ci></apply><ci id="S3.E4.m1.3.3.1.1.cmml" xref="S3.E4.m1.3.3.1.1">𝑋</ci></apply><apply id="S3.E4.m1.4.4.2.cmml" xref="S3.E4.m1.4.4.2"><times id="S3.E4.m1.4.4.2.2.cmml" xref="S3.E4.m1.4.4.2.2"></times><apply id="S3.E4.m1.4.4.2.3.cmml" xref="S3.E4.m1.4.4.2.3"><csymbol cd="ambiguous" id="S3.E4.m1.4.4.2.3.1.cmml" xref="S3.E4.m1.4.4.2.3">subscript</csymbol><ci id="S3.E4.m1.4.4.2.3.2.cmml" xref="S3.E4.m1.4.4.2.3.2">𝑃</ci><ci id="S3.E4.m1.4.4.2.3.3.cmml" xref="S3.E4.m1.4.4.2.3.3">pre</ci></apply><ci id="S3.E4.m1.4.4.2.1.cmml" xref="S3.E4.m1.4.4.2.1">𝑋</ci></apply></apply><apply id="S3.E4.m1.7.7.1.1.3.3.2.cmml" xref="S3.E4.m1.7.7.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.E4.m1.7.7.1.1.3.3.2.1.cmml" xref="S3.E4.m1.7.7.1.1.3.3.2">subscript</csymbol><ci id="S3.E4.m1.7.7.1.1.3.3.2.2.cmml" xref="S3.E4.m1.7.7.1.1.3.3.2.2">𝑃</ci><ci id="S3.E4.m1.7.7.1.1.3.3.2.3.cmml" xref="S3.E4.m1.7.7.1.1.3.3.2.3">𝑡</ci></apply></apply><apply id="S3.E4.m1.7.7.1.1.3.1.1.1.cmml" xref="S3.E4.m1.7.7.1.1.3.1.1"><eq id="S3.E4.m1.7.7.1.1.3.1.1.1.1.cmml" xref="S3.E4.m1.7.7.1.1.3.1.1.1.1"></eq><ci id="S3.E4.m1.7.7.1.1.3.1.1.1.2.cmml" xref="S3.E4.m1.7.7.1.1.3.1.1.1.2">𝑌</ci><apply id="S3.E4.m1.7.7.1.1.3.1.1.1.3.cmml" xref="S3.E4.m1.7.7.1.1.3.1.1.1.3"><csymbol cd="latexml" id="S3.E4.m1.7.7.1.1.3.1.1.1.3.1.cmml" xref="S3.E4.m1.7.7.1.1.3.1.1.1.3.1">conditional</csymbol><ci id="S3.E4.m1.7.7.1.1.3.1.1.1.3.2.cmml" xref="S3.E4.m1.7.7.1.1.3.1.1.1.3.2">𝑖</ci><ci id="S3.E4.m1.7.7.1.1.3.1.1.1.3.3.cmml" xref="S3.E4.m1.7.7.1.1.3.1.1.1.3.3">𝑋</ci></apply></apply></apply></apply><apply id="S3.E4.m1.7.7.1.1e.cmml" xref="S3.E4.m1.7.7.1"><csymbol cd="latexml" id="S3.E4.m1.7.7.1.1.8.cmml" xref="S3.E4.m1.7.7.1.1.8">proportional-to</csymbol><share href="https://arxiv.org/html/2410.04499v1#S3.E4.m1.7.7.1.1.3.cmml" id="S3.E4.m1.7.7.1.1f.cmml" xref="S3.E4.m1.7.7.1"></share><apply id="S3.E4.m1.7.7.1.1.4.cmml" xref="S3.E4.m1.7.7.1.1.4"><times id="S3.E4.m1.7.7.1.1.4.2.cmml" xref="S3.E4.m1.7.7.1.1.4.2"></times><apply id="S3.E4.m1.7.7.1.1.4.3.cmml" xref="S3.E4.m1.7.7.1.1.4.3"><csymbol cd="ambiguous" id="S3.E4.m1.7.7.1.1.4.3.1.cmml" xref="S3.E4.m1.7.7.1.1.4.3">subscript</csymbol><ci id="S3.E4.m1.7.7.1.1.4.3.2.cmml" xref="S3.E4.m1.7.7.1.1.4.3.2">𝑃</ci><ci id="S3.E4.m1.7.7.1.1.4.3.3.cmml" xref="S3.E4.m1.7.7.1.1.4.3.3">𝑡</ci></apply><apply id="S3.E4.m1.7.7.1.1.4.1.1.1.cmml" xref="S3.E4.m1.7.7.1.1.4.1.1"><eq id="S3.E4.m1.7.7.1.1.4.1.1.1.1.cmml" xref="S3.E4.m1.7.7.1.1.4.1.1.1.1"></eq><ci id="S3.E4.m1.7.7.1.1.4.1.1.1.2.cmml" xref="S3.E4.m1.7.7.1.1.4.1.1.1.2">𝑌</ci><apply id="S3.E4.m1.7.7.1.1.4.1.1.1.3.cmml" xref="S3.E4.m1.7.7.1.1.4.1.1.1.3"><csymbol cd="latexml" id="S3.E4.m1.7.7.1.1.4.1.1.1.3.1.cmml" xref="S3.E4.m1.7.7.1.1.4.1.1.1.3.1">conditional</csymbol><ci id="S3.E4.m1.7.7.1.1.4.1.1.1.3.2.cmml" xref="S3.E4.m1.7.7.1.1.4.1.1.1.3.2">𝑖</ci><ci id="S3.E4.m1.7.7.1.1.4.1.1.1.3.3.cmml" xref="S3.E4.m1.7.7.1.1.4.1.1.1.3.3">𝑋</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.7c">\displaystyle\small\lambda_{i}(S)[f(X)]_{i}\approx\frac{P_{t}(Y=i)}{P_{\mathrm%
{pre}}(Y=i)}\cdot P_{\mathrm{pre}}(Y=i|X)=\frac{P_{t}(X)}{P_{\mathrm{pre}}(X)}%
\cdot P_{t}(Y=i|X)\propto P_{t}(Y=i|X).</annotation><annotation encoding="application/x-llamapun" id="S3.E4.m1.7d">italic_λ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ( italic_S ) [ italic_f ( italic_X ) ] start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ≈ divide start_ARG italic_P start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( italic_Y = italic_i ) end_ARG start_ARG italic_P start_POSTSUBSCRIPT roman_pre end_POSTSUBSCRIPT ( italic_Y = italic_i ) end_ARG ⋅ italic_P start_POSTSUBSCRIPT roman_pre end_POSTSUBSCRIPT ( italic_Y = italic_i | italic_X ) = divide start_ARG italic_P start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( italic_X ) end_ARG start_ARG italic_P start_POSTSUBSCRIPT roman_pre end_POSTSUBSCRIPT ( italic_X ) end_ARG ⋅ italic_P start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( italic_Y = italic_i | italic_X ) ∝ italic_P start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( italic_Y = italic_i | italic_X ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.1.p1.3">and hence the adjustment in (<a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#S3.E3" title="Equation 3 ‣ 3.2 Anticipating performative label shifts ‣ 3 Anticipating performativity ‣ Adjusting Pretrained Backbones for Performativity"><span class="ltx_text ltx_ref_tag">3</span></a>) is Bayes-optimal under label shifts.
∎</p>
</div>
</div>
<section class="ltx_paragraph" id="S3.SS2.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">Dynamic benchmarking.</h4>
<div class="ltx_para" id="S3.SS2.SSS0.Px1.p1">
<p class="ltx_p" id="S3.SS2.SSS0.Px1.p1.1">Our running example for performative label shift is the use case of dynamic benchmarks  <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#bib.bib73" title="">73</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#bib.bib61" title="">61</a>]</cite>. Dynamic benchmarks are a recent and popular way to assess and compare the performance of predictive models across multiple phases, where data collection is performed repeatedly with respect to the model performance. The aim is to challenge the model to be better at places where its performance is lacking <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#bib.bib37" title="">37</a>]</cite>. Model updates and the data collection phases follow each other, creating a feedback loop between model performance and data distribution through adversarial sampling.</p>
</div>
</section>
<section class="ltx_paragraph" id="S3.SS2.SSS0.Px2">
<h4 class="ltx_title ltx_title_paragraph">Self-selection.</h4>
<div class="ltx_para" id="S3.SS2.SSS0.Px2.p1">
<p class="ltx_p" id="S3.SS2.SSS0.Px2.p1.1">An alternative mechanism leading to opposite dynamics could be caused by model’s poor performance on certain classes or subgroups. These negatively impacted users disengage from the data ecosystem,
causing representational disparities in the data <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#bib.bib29" title="">29</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#bib.bib42" title="">42</a>]</cite>, which can further amplify through retraining <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#bib.bib28" title="">28</a>]</cite>.
Both examples are natural use-cases of performative labels shift, where the next round’s label proportions are impacted by the model’s performance in the current round.</p>
</div>
<figure class="ltx_float ltx_algorithm" id="algorithm1">
<div class="ltx_listing ltx_lst_numbers_left ltx_listing" id="algorithm1.22">
<div class="ltx_listingline" id="algorithm1.5.5">
<span class="ltx_text ltx_font_bold" id="algorithm1.5.5.1">Input :</span> Frozen pre-trained model <math alttext="f_{\mathrm{pre}}" class="ltx_Math" display="inline" id="algorithm1.1.1.m1.1"><semantics id="algorithm1.1.1.m1.1a"><msub id="algorithm1.1.1.m1.1.1" xref="algorithm1.1.1.m1.1.1.cmml"><mi id="algorithm1.1.1.m1.1.1.2" xref="algorithm1.1.1.m1.1.1.2.cmml">f</mi><mi id="algorithm1.1.1.m1.1.1.3" xref="algorithm1.1.1.m1.1.1.3.cmml">pre</mi></msub><annotation-xml encoding="MathML-Content" id="algorithm1.1.1.m1.1b"><apply id="algorithm1.1.1.m1.1.1.cmml" xref="algorithm1.1.1.m1.1.1"><csymbol cd="ambiguous" id="algorithm1.1.1.m1.1.1.1.cmml" xref="algorithm1.1.1.m1.1.1">subscript</csymbol><ci id="algorithm1.1.1.m1.1.1.2.cmml" xref="algorithm1.1.1.m1.1.1.2">𝑓</ci><ci id="algorithm1.1.1.m1.1.1.3.cmml" xref="algorithm1.1.1.m1.1.1.3">pre</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.1.1.m1.1c">f_{\mathrm{pre}}</annotation><annotation encoding="application/x-llamapun" id="algorithm1.1.1.m1.1d">italic_f start_POSTSUBSCRIPT roman_pre end_POSTSUBSCRIPT</annotation></semantics></math> and training label marginals <math alttext="\Lambda^{\mathrm{pre}}" class="ltx_Math" display="inline" id="algorithm1.2.2.m2.1"><semantics id="algorithm1.2.2.m2.1a"><msup id="algorithm1.2.2.m2.1.1" xref="algorithm1.2.2.m2.1.1.cmml"><mi id="algorithm1.2.2.m2.1.1.2" mathvariant="normal" xref="algorithm1.2.2.m2.1.1.2.cmml">Λ</mi><mi id="algorithm1.2.2.m2.1.1.3" xref="algorithm1.2.2.m2.1.1.3.cmml">pre</mi></msup><annotation-xml encoding="MathML-Content" id="algorithm1.2.2.m2.1b"><apply id="algorithm1.2.2.m2.1.1.cmml" xref="algorithm1.2.2.m2.1.1"><csymbol cd="ambiguous" id="algorithm1.2.2.m2.1.1.1.cmml" xref="algorithm1.2.2.m2.1.1">superscript</csymbol><ci id="algorithm1.2.2.m2.1.1.2.cmml" xref="algorithm1.2.2.m2.1.1.2">Λ</ci><ci id="algorithm1.2.2.m2.1.1.3.cmml" xref="algorithm1.2.2.m2.1.1.3">pre</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.2.2.m2.1c">\Lambda^{\mathrm{pre}}</annotation><annotation encoding="application/x-llamapun" id="algorithm1.2.2.m2.1d">roman_Λ start_POSTSUPERSCRIPT roman_pre end_POSTSUPERSCRIPT</annotation></semantics></math>. Randomly initialized adapter <math alttext="T_{0}" class="ltx_Math" display="inline" id="algorithm1.3.3.m3.1"><semantics id="algorithm1.3.3.m3.1a"><msub id="algorithm1.3.3.m3.1.1" xref="algorithm1.3.3.m3.1.1.cmml"><mi id="algorithm1.3.3.m3.1.1.2" xref="algorithm1.3.3.m3.1.1.2.cmml">T</mi><mn id="algorithm1.3.3.m3.1.1.3" xref="algorithm1.3.3.m3.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="algorithm1.3.3.m3.1b"><apply id="algorithm1.3.3.m3.1.1.cmml" xref="algorithm1.3.3.m3.1.1"><csymbol cd="ambiguous" id="algorithm1.3.3.m3.1.1.1.cmml" xref="algorithm1.3.3.m3.1.1">subscript</csymbol><ci id="algorithm1.3.3.m3.1.1.2.cmml" xref="algorithm1.3.3.m3.1.1.2">𝑇</ci><cn id="algorithm1.3.3.m3.1.1.3.cmml" type="integer" xref="algorithm1.3.3.m3.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.3.3.m3.1c">T_{0}</annotation><annotation encoding="application/x-llamapun" id="algorithm1.3.3.m3.1d">italic_T start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math>, empty memory buffer <math alttext="\mathcal{M}" class="ltx_Math" display="inline" id="algorithm1.4.4.m4.1"><semantics id="algorithm1.4.4.m4.1a"><mi class="ltx_font_mathcaligraphic" id="algorithm1.4.4.m4.1.1" xref="algorithm1.4.4.m4.1.1.cmml">ℳ</mi><annotation-xml encoding="MathML-Content" id="algorithm1.4.4.m4.1b"><ci id="algorithm1.4.4.m4.1.1.cmml" xref="algorithm1.4.4.m4.1.1">ℳ</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.4.4.m4.1c">\mathcal{M}</annotation><annotation encoding="application/x-llamapun" id="algorithm1.4.4.m4.1d">caligraphic_M</annotation></semantics></math>. Initial distribution <math alttext="P_{0}" class="ltx_Math" display="inline" id="algorithm1.5.5.m5.1"><semantics id="algorithm1.5.5.m5.1a"><msub id="algorithm1.5.5.m5.1.1" xref="algorithm1.5.5.m5.1.1.cmml"><mi id="algorithm1.5.5.m5.1.1.2" xref="algorithm1.5.5.m5.1.1.2.cmml">P</mi><mn id="algorithm1.5.5.m5.1.1.3" xref="algorithm1.5.5.m5.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="algorithm1.5.5.m5.1b"><apply id="algorithm1.5.5.m5.1.1.cmml" xref="algorithm1.5.5.m5.1.1"><csymbol cd="ambiguous" id="algorithm1.5.5.m5.1.1.1.cmml" xref="algorithm1.5.5.m5.1.1">subscript</csymbol><ci id="algorithm1.5.5.m5.1.1.2.cmml" xref="algorithm1.5.5.m5.1.1.2">𝑃</ci><cn id="algorithm1.5.5.m5.1.1.3.cmml" type="integer" xref="algorithm1.5.5.m5.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.5.5.m5.1c">P_{0}</annotation><annotation encoding="application/x-llamapun" id="algorithm1.5.5.m5.1d">italic_P start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algorithm1.6.6">
<span class="ltx_tag ltx_tag_listingline">1</span>

Deploy <math alttext="f_{0}=f_{\mathrm{pre}}" class="ltx_Math" display="inline" id="algorithm1.6.6.m1.1"><semantics id="algorithm1.6.6.m1.1a"><mrow id="algorithm1.6.6.m1.1.1" xref="algorithm1.6.6.m1.1.1.cmml"><msub id="algorithm1.6.6.m1.1.1.2" xref="algorithm1.6.6.m1.1.1.2.cmml"><mi id="algorithm1.6.6.m1.1.1.2.2" xref="algorithm1.6.6.m1.1.1.2.2.cmml">f</mi><mn id="algorithm1.6.6.m1.1.1.2.3" xref="algorithm1.6.6.m1.1.1.2.3.cmml">0</mn></msub><mo id="algorithm1.6.6.m1.1.1.1" xref="algorithm1.6.6.m1.1.1.1.cmml">=</mo><msub id="algorithm1.6.6.m1.1.1.3" xref="algorithm1.6.6.m1.1.1.3.cmml"><mi id="algorithm1.6.6.m1.1.1.3.2" xref="algorithm1.6.6.m1.1.1.3.2.cmml">f</mi><mi id="algorithm1.6.6.m1.1.1.3.3" xref="algorithm1.6.6.m1.1.1.3.3.cmml">pre</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.6.6.m1.1b"><apply id="algorithm1.6.6.m1.1.1.cmml" xref="algorithm1.6.6.m1.1.1"><eq id="algorithm1.6.6.m1.1.1.1.cmml" xref="algorithm1.6.6.m1.1.1.1"></eq><apply id="algorithm1.6.6.m1.1.1.2.cmml" xref="algorithm1.6.6.m1.1.1.2"><csymbol cd="ambiguous" id="algorithm1.6.6.m1.1.1.2.1.cmml" xref="algorithm1.6.6.m1.1.1.2">subscript</csymbol><ci id="algorithm1.6.6.m1.1.1.2.2.cmml" xref="algorithm1.6.6.m1.1.1.2.2">𝑓</ci><cn id="algorithm1.6.6.m1.1.1.2.3.cmml" type="integer" xref="algorithm1.6.6.m1.1.1.2.3">0</cn></apply><apply id="algorithm1.6.6.m1.1.1.3.cmml" xref="algorithm1.6.6.m1.1.1.3"><csymbol cd="ambiguous" id="algorithm1.6.6.m1.1.1.3.1.cmml" xref="algorithm1.6.6.m1.1.1.3">subscript</csymbol><ci id="algorithm1.6.6.m1.1.1.3.2.cmml" xref="algorithm1.6.6.m1.1.1.3.2">𝑓</ci><ci id="algorithm1.6.6.m1.1.1.3.3.cmml" xref="algorithm1.6.6.m1.1.1.3.3">pre</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.6.6.m1.1c">f_{0}=f_{\mathrm{pre}}</annotation><annotation encoding="application/x-llamapun" id="algorithm1.6.6.m1.1d">italic_f start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT = italic_f start_POSTSUBSCRIPT roman_pre end_POSTSUBSCRIPT</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algorithm1.7.7">
<span class="ltx_tag ltx_tag_listingline">2</span>
<math alttext="S_{0}\leftarrow\mathrm{Stat}(f_{0},P_{0})" class="ltx_Math" display="inline" id="algorithm1.7.7.m1.2"><semantics id="algorithm1.7.7.m1.2a"><mrow id="algorithm1.7.7.m1.2.2" xref="algorithm1.7.7.m1.2.2.cmml"><msub id="algorithm1.7.7.m1.2.2.4" xref="algorithm1.7.7.m1.2.2.4.cmml"><mi id="algorithm1.7.7.m1.2.2.4.2" xref="algorithm1.7.7.m1.2.2.4.2.cmml">S</mi><mn id="algorithm1.7.7.m1.2.2.4.3" xref="algorithm1.7.7.m1.2.2.4.3.cmml">0</mn></msub><mo id="algorithm1.7.7.m1.2.2.3" stretchy="false" xref="algorithm1.7.7.m1.2.2.3.cmml">←</mo><mrow id="algorithm1.7.7.m1.2.2.2" xref="algorithm1.7.7.m1.2.2.2.cmml"><mi id="algorithm1.7.7.m1.2.2.2.4" xref="algorithm1.7.7.m1.2.2.2.4.cmml">Stat</mi><mo id="algorithm1.7.7.m1.2.2.2.3" xref="algorithm1.7.7.m1.2.2.2.3.cmml">⁢</mo><mrow id="algorithm1.7.7.m1.2.2.2.2.2" xref="algorithm1.7.7.m1.2.2.2.2.3.cmml"><mo id="algorithm1.7.7.m1.2.2.2.2.2.3" stretchy="false" xref="algorithm1.7.7.m1.2.2.2.2.3.cmml">(</mo><msub id="algorithm1.7.7.m1.1.1.1.1.1.1" xref="algorithm1.7.7.m1.1.1.1.1.1.1.cmml"><mi id="algorithm1.7.7.m1.1.1.1.1.1.1.2" xref="algorithm1.7.7.m1.1.1.1.1.1.1.2.cmml">f</mi><mn id="algorithm1.7.7.m1.1.1.1.1.1.1.3" xref="algorithm1.7.7.m1.1.1.1.1.1.1.3.cmml">0</mn></msub><mo id="algorithm1.7.7.m1.2.2.2.2.2.4" xref="algorithm1.7.7.m1.2.2.2.2.3.cmml">,</mo><msub id="algorithm1.7.7.m1.2.2.2.2.2.2" xref="algorithm1.7.7.m1.2.2.2.2.2.2.cmml"><mi id="algorithm1.7.7.m1.2.2.2.2.2.2.2" xref="algorithm1.7.7.m1.2.2.2.2.2.2.2.cmml">P</mi><mn id="algorithm1.7.7.m1.2.2.2.2.2.2.3" xref="algorithm1.7.7.m1.2.2.2.2.2.2.3.cmml">0</mn></msub><mo id="algorithm1.7.7.m1.2.2.2.2.2.5" stretchy="false" xref="algorithm1.7.7.m1.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.7.7.m1.2b"><apply id="algorithm1.7.7.m1.2.2.cmml" xref="algorithm1.7.7.m1.2.2"><ci id="algorithm1.7.7.m1.2.2.3.cmml" xref="algorithm1.7.7.m1.2.2.3">←</ci><apply id="algorithm1.7.7.m1.2.2.4.cmml" xref="algorithm1.7.7.m1.2.2.4"><csymbol cd="ambiguous" id="algorithm1.7.7.m1.2.2.4.1.cmml" xref="algorithm1.7.7.m1.2.2.4">subscript</csymbol><ci id="algorithm1.7.7.m1.2.2.4.2.cmml" xref="algorithm1.7.7.m1.2.2.4.2">𝑆</ci><cn id="algorithm1.7.7.m1.2.2.4.3.cmml" type="integer" xref="algorithm1.7.7.m1.2.2.4.3">0</cn></apply><apply id="algorithm1.7.7.m1.2.2.2.cmml" xref="algorithm1.7.7.m1.2.2.2"><times id="algorithm1.7.7.m1.2.2.2.3.cmml" xref="algorithm1.7.7.m1.2.2.2.3"></times><ci id="algorithm1.7.7.m1.2.2.2.4.cmml" xref="algorithm1.7.7.m1.2.2.2.4">Stat</ci><interval closure="open" id="algorithm1.7.7.m1.2.2.2.2.3.cmml" xref="algorithm1.7.7.m1.2.2.2.2.2"><apply id="algorithm1.7.7.m1.1.1.1.1.1.1.cmml" xref="algorithm1.7.7.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="algorithm1.7.7.m1.1.1.1.1.1.1.1.cmml" xref="algorithm1.7.7.m1.1.1.1.1.1.1">subscript</csymbol><ci id="algorithm1.7.7.m1.1.1.1.1.1.1.2.cmml" xref="algorithm1.7.7.m1.1.1.1.1.1.1.2">𝑓</ci><cn id="algorithm1.7.7.m1.1.1.1.1.1.1.3.cmml" type="integer" xref="algorithm1.7.7.m1.1.1.1.1.1.1.3">0</cn></apply><apply id="algorithm1.7.7.m1.2.2.2.2.2.2.cmml" xref="algorithm1.7.7.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="algorithm1.7.7.m1.2.2.2.2.2.2.1.cmml" xref="algorithm1.7.7.m1.2.2.2.2.2.2">subscript</csymbol><ci id="algorithm1.7.7.m1.2.2.2.2.2.2.2.cmml" xref="algorithm1.7.7.m1.2.2.2.2.2.2.2">𝑃</ci><cn id="algorithm1.7.7.m1.2.2.2.2.2.2.3.cmml" type="integer" xref="algorithm1.7.7.m1.2.2.2.2.2.2.3">0</cn></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.7.7.m1.2c">S_{0}\leftarrow\mathrm{Stat}(f_{0},P_{0})</annotation><annotation encoding="application/x-llamapun" id="algorithm1.7.7.m1.2d">italic_S start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ← roman_Stat ( italic_f start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , italic_P start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algorithm1.9.9">
<span class="ltx_tag ltx_tag_listingline">3</span>
<span class="ltx_text ltx_font_bold" id="algorithm1.9.9.3">for</span> <em class="ltx_emph ltx_font_italic" id="algorithm1.9.9.2">round <math alttext="t" class="ltx_Math" display="inline" id="algorithm1.8.8.1.m1.1"><semantics id="algorithm1.8.8.1.m1.1a"><mi id="algorithm1.8.8.1.m1.1.1" xref="algorithm1.8.8.1.m1.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="algorithm1.8.8.1.m1.1b"><ci id="algorithm1.8.8.1.m1.1.1.cmml" xref="algorithm1.8.8.1.m1.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.8.8.1.m1.1c">t</annotation><annotation encoding="application/x-llamapun" id="algorithm1.8.8.1.m1.1d">italic_t</annotation></semantics></math> in <math alttext="1,2,3,\dots" class="ltx_Math" display="inline" id="algorithm1.9.9.2.m2.4"><semantics id="algorithm1.9.9.2.m2.4a"><mrow id="algorithm1.9.9.2.m2.4.5.2" xref="algorithm1.9.9.2.m2.4.5.1.cmml"><mn id="algorithm1.9.9.2.m2.1.1" xref="algorithm1.9.9.2.m2.1.1.cmml">1</mn><mo id="algorithm1.9.9.2.m2.4.5.2.1" xref="algorithm1.9.9.2.m2.4.5.1.cmml">,</mo><mn id="algorithm1.9.9.2.m2.2.2" xref="algorithm1.9.9.2.m2.2.2.cmml">2</mn><mo id="algorithm1.9.9.2.m2.4.5.2.2" xref="algorithm1.9.9.2.m2.4.5.1.cmml">,</mo><mn id="algorithm1.9.9.2.m2.3.3" xref="algorithm1.9.9.2.m2.3.3.cmml">3</mn><mo id="algorithm1.9.9.2.m2.4.5.2.3" xref="algorithm1.9.9.2.m2.4.5.1.cmml">,</mo><mi id="algorithm1.9.9.2.m2.4.4" xref="algorithm1.9.9.2.m2.4.4.cmml">…</mi></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.9.9.2.m2.4b"><list id="algorithm1.9.9.2.m2.4.5.1.cmml" xref="algorithm1.9.9.2.m2.4.5.2"><cn id="algorithm1.9.9.2.m2.1.1.cmml" type="integer" xref="algorithm1.9.9.2.m2.1.1">1</cn><cn id="algorithm1.9.9.2.m2.2.2.cmml" type="integer" xref="algorithm1.9.9.2.m2.2.2">2</cn><cn id="algorithm1.9.9.2.m2.3.3.cmml" type="integer" xref="algorithm1.9.9.2.m2.3.3">3</cn><ci id="algorithm1.9.9.2.m2.4.4.cmml" xref="algorithm1.9.9.2.m2.4.4">italic-…</ci></list></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.9.9.2.m2.4c">1,2,3,\dots</annotation><annotation encoding="application/x-llamapun" id="algorithm1.9.9.2.m2.4d">1 , 2 , 3 , italic_…</annotation></semantics></math>, T</em> <span class="ltx_text ltx_font_bold" id="algorithm1.9.9.4">do</span>
</div>
<div class="ltx_listingline" id="algorithm1.10.10">
<span class="ltx_tag ltx_tag_listingline">4</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
Observe sample from <math alttext="P_{t}" class="ltx_Math" display="inline" id="algorithm1.10.10.m1.1"><semantics id="algorithm1.10.10.m1.1a"><msub id="algorithm1.10.10.m1.1.1" xref="algorithm1.10.10.m1.1.1.cmml"><mi id="algorithm1.10.10.m1.1.1.2" xref="algorithm1.10.10.m1.1.1.2.cmml">P</mi><mi id="algorithm1.10.10.m1.1.1.3" xref="algorithm1.10.10.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="algorithm1.10.10.m1.1b"><apply id="algorithm1.10.10.m1.1.1.cmml" xref="algorithm1.10.10.m1.1.1"><csymbol cd="ambiguous" id="algorithm1.10.10.m1.1.1.1.cmml" xref="algorithm1.10.10.m1.1.1">subscript</csymbol><ci id="algorithm1.10.10.m1.1.1.2.cmml" xref="algorithm1.10.10.m1.1.1.2">𝑃</ci><ci id="algorithm1.10.10.m1.1.1.3.cmml" xref="algorithm1.10.10.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.10.10.m1.1c">P_{t}</annotation><annotation encoding="application/x-llamapun" id="algorithm1.10.10.m1.1d">italic_P start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algorithm1.22.23">
<span class="ltx_tag ltx_tag_listingline">5</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   [1.5ex]
<span class="ltx_text ltx_framed ltx_framed_underline" id="algorithm1.22.23.1">Update adaptor module:</span>
</div>
<div class="ltx_listingline" id="algorithm1.11.11">
<span class="ltx_tag ltx_tag_listingline">6</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math alttext="\Lambda^{(t)}\leftarrow" class="ltx_Math" display="inline" id="algorithm1.11.11.m1.1"><semantics id="algorithm1.11.11.m1.1a"><mrow id="algorithm1.11.11.m1.1.2" xref="algorithm1.11.11.m1.1.2.cmml"><msup id="algorithm1.11.11.m1.1.2.2" xref="algorithm1.11.11.m1.1.2.2.cmml"><mi id="algorithm1.11.11.m1.1.2.2.2" mathvariant="normal" xref="algorithm1.11.11.m1.1.2.2.2.cmml">Λ</mi><mrow id="algorithm1.11.11.m1.1.1.1.3" xref="algorithm1.11.11.m1.1.2.2.cmml"><mo id="algorithm1.11.11.m1.1.1.1.3.1" stretchy="false" xref="algorithm1.11.11.m1.1.2.2.cmml">(</mo><mi id="algorithm1.11.11.m1.1.1.1.1" xref="algorithm1.11.11.m1.1.1.1.1.cmml">t</mi><mo id="algorithm1.11.11.m1.1.1.1.3.2" stretchy="false" xref="algorithm1.11.11.m1.1.2.2.cmml">)</mo></mrow></msup><mo id="algorithm1.11.11.m1.1.2.1" stretchy="false" xref="algorithm1.11.11.m1.1.2.1.cmml">←</mo><mi id="algorithm1.11.11.m1.1.2.3" xref="algorithm1.11.11.m1.1.2.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.11.11.m1.1b"><apply id="algorithm1.11.11.m1.1.2.cmml" xref="algorithm1.11.11.m1.1.2"><ci id="algorithm1.11.11.m1.1.2.1.cmml" xref="algorithm1.11.11.m1.1.2.1">←</ci><apply id="algorithm1.11.11.m1.1.2.2.cmml" xref="algorithm1.11.11.m1.1.2.2"><csymbol cd="ambiguous" id="algorithm1.11.11.m1.1.2.2.1.cmml" xref="algorithm1.11.11.m1.1.2.2">superscript</csymbol><ci id="algorithm1.11.11.m1.1.2.2.2.cmml" xref="algorithm1.11.11.m1.1.2.2.2">Λ</ci><ci id="algorithm1.11.11.m1.1.1.1.1.cmml" xref="algorithm1.11.11.m1.1.1.1.1">𝑡</ci></apply><csymbol cd="latexml" id="algorithm1.11.11.m1.1.2.3.cmml" xref="algorithm1.11.11.m1.1.2.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.11.11.m1.1c">\Lambda^{(t)}\leftarrow</annotation><annotation encoding="application/x-llamapun" id="algorithm1.11.11.m1.1d">roman_Λ start_POSTSUPERSCRIPT ( italic_t ) end_POSTSUPERSCRIPT ←</annotation></semantics></math> marginals evaluated on observed samples
</div>
<div class="ltx_listingline" id="algorithm1.13.13">
<span class="ltx_tag ltx_tag_listingline">7</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
Write <math alttext="(S_{t-1},\Lambda^{(t)})" class="ltx_Math" display="inline" id="algorithm1.12.12.m1.3"><semantics id="algorithm1.12.12.m1.3a"><mrow id="algorithm1.12.12.m1.3.3.2" xref="algorithm1.12.12.m1.3.3.3.cmml"><mo id="algorithm1.12.12.m1.3.3.2.3" stretchy="false" xref="algorithm1.12.12.m1.3.3.3.cmml">(</mo><msub id="algorithm1.12.12.m1.2.2.1.1" xref="algorithm1.12.12.m1.2.2.1.1.cmml"><mi id="algorithm1.12.12.m1.2.2.1.1.2" xref="algorithm1.12.12.m1.2.2.1.1.2.cmml">S</mi><mrow id="algorithm1.12.12.m1.2.2.1.1.3" xref="algorithm1.12.12.m1.2.2.1.1.3.cmml"><mi id="algorithm1.12.12.m1.2.2.1.1.3.2" xref="algorithm1.12.12.m1.2.2.1.1.3.2.cmml">t</mi><mo id="algorithm1.12.12.m1.2.2.1.1.3.1" xref="algorithm1.12.12.m1.2.2.1.1.3.1.cmml">−</mo><mn id="algorithm1.12.12.m1.2.2.1.1.3.3" xref="algorithm1.12.12.m1.2.2.1.1.3.3.cmml">1</mn></mrow></msub><mo id="algorithm1.12.12.m1.3.3.2.4" xref="algorithm1.12.12.m1.3.3.3.cmml">,</mo><msup id="algorithm1.12.12.m1.3.3.2.2" xref="algorithm1.12.12.m1.3.3.2.2.cmml"><mi id="algorithm1.12.12.m1.3.3.2.2.2" mathvariant="normal" xref="algorithm1.12.12.m1.3.3.2.2.2.cmml">Λ</mi><mrow id="algorithm1.12.12.m1.1.1.1.3" xref="algorithm1.12.12.m1.3.3.2.2.cmml"><mo id="algorithm1.12.12.m1.1.1.1.3.1" stretchy="false" xref="algorithm1.12.12.m1.3.3.2.2.cmml">(</mo><mi id="algorithm1.12.12.m1.1.1.1.1" xref="algorithm1.12.12.m1.1.1.1.1.cmml">t</mi><mo id="algorithm1.12.12.m1.1.1.1.3.2" stretchy="false" xref="algorithm1.12.12.m1.3.3.2.2.cmml">)</mo></mrow></msup><mo id="algorithm1.12.12.m1.3.3.2.5" stretchy="false" xref="algorithm1.12.12.m1.3.3.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.12.12.m1.3b"><interval closure="open" id="algorithm1.12.12.m1.3.3.3.cmml" xref="algorithm1.12.12.m1.3.3.2"><apply id="algorithm1.12.12.m1.2.2.1.1.cmml" xref="algorithm1.12.12.m1.2.2.1.1"><csymbol cd="ambiguous" id="algorithm1.12.12.m1.2.2.1.1.1.cmml" xref="algorithm1.12.12.m1.2.2.1.1">subscript</csymbol><ci id="algorithm1.12.12.m1.2.2.1.1.2.cmml" xref="algorithm1.12.12.m1.2.2.1.1.2">𝑆</ci><apply id="algorithm1.12.12.m1.2.2.1.1.3.cmml" xref="algorithm1.12.12.m1.2.2.1.1.3"><minus id="algorithm1.12.12.m1.2.2.1.1.3.1.cmml" xref="algorithm1.12.12.m1.2.2.1.1.3.1"></minus><ci id="algorithm1.12.12.m1.2.2.1.1.3.2.cmml" xref="algorithm1.12.12.m1.2.2.1.1.3.2">𝑡</ci><cn id="algorithm1.12.12.m1.2.2.1.1.3.3.cmml" type="integer" xref="algorithm1.12.12.m1.2.2.1.1.3.3">1</cn></apply></apply><apply id="algorithm1.12.12.m1.3.3.2.2.cmml" xref="algorithm1.12.12.m1.3.3.2.2"><csymbol cd="ambiguous" id="algorithm1.12.12.m1.3.3.2.2.1.cmml" xref="algorithm1.12.12.m1.3.3.2.2">superscript</csymbol><ci id="algorithm1.12.12.m1.3.3.2.2.2.cmml" xref="algorithm1.12.12.m1.3.3.2.2.2">Λ</ci><ci id="algorithm1.12.12.m1.1.1.1.1.cmml" xref="algorithm1.12.12.m1.1.1.1.1">𝑡</ci></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.12.12.m1.3c">(S_{t-1},\Lambda^{(t)})</annotation><annotation encoding="application/x-llamapun" id="algorithm1.12.12.m1.3d">( italic_S start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT , roman_Λ start_POSTSUPERSCRIPT ( italic_t ) end_POSTSUPERSCRIPT )</annotation></semantics></math> to <math alttext="\mathcal{M}" class="ltx_Math" display="inline" id="algorithm1.13.13.m2.1"><semantics id="algorithm1.13.13.m2.1a"><mi class="ltx_font_mathcaligraphic" id="algorithm1.13.13.m2.1.1" xref="algorithm1.13.13.m2.1.1.cmml">ℳ</mi><annotation-xml encoding="MathML-Content" id="algorithm1.13.13.m2.1b"><ci id="algorithm1.13.13.m2.1.1.cmml" xref="algorithm1.13.13.m2.1.1">ℳ</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.13.13.m2.1c">\mathcal{M}</annotation><annotation encoding="application/x-llamapun" id="algorithm1.13.13.m2.1d">caligraphic_M</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algorithm1.16.16">
<span class="ltx_tag ltx_tag_listingline">8</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math alttext="T_{t}\leftarrow" class="ltx_Math" display="inline" id="algorithm1.14.14.m1.1"><semantics id="algorithm1.14.14.m1.1a"><mrow id="algorithm1.14.14.m1.1.1" xref="algorithm1.14.14.m1.1.1.cmml"><msub id="algorithm1.14.14.m1.1.1.2" xref="algorithm1.14.14.m1.1.1.2.cmml"><mi id="algorithm1.14.14.m1.1.1.2.2" xref="algorithm1.14.14.m1.1.1.2.2.cmml">T</mi><mi id="algorithm1.14.14.m1.1.1.2.3" xref="algorithm1.14.14.m1.1.1.2.3.cmml">t</mi></msub><mo id="algorithm1.14.14.m1.1.1.1" stretchy="false" xref="algorithm1.14.14.m1.1.1.1.cmml">←</mo><mi id="algorithm1.14.14.m1.1.1.3" xref="algorithm1.14.14.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.14.14.m1.1b"><apply id="algorithm1.14.14.m1.1.1.cmml" xref="algorithm1.14.14.m1.1.1"><ci id="algorithm1.14.14.m1.1.1.1.cmml" xref="algorithm1.14.14.m1.1.1.1">←</ci><apply id="algorithm1.14.14.m1.1.1.2.cmml" xref="algorithm1.14.14.m1.1.1.2"><csymbol cd="ambiguous" id="algorithm1.14.14.m1.1.1.2.1.cmml" xref="algorithm1.14.14.m1.1.1.2">subscript</csymbol><ci id="algorithm1.14.14.m1.1.1.2.2.cmml" xref="algorithm1.14.14.m1.1.1.2.2">𝑇</ci><ci id="algorithm1.14.14.m1.1.1.2.3.cmml" xref="algorithm1.14.14.m1.1.1.2.3">𝑡</ci></apply><csymbol cd="latexml" id="algorithm1.14.14.m1.1.1.3.cmml" xref="algorithm1.14.14.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.14.14.m1.1c">T_{t}\leftarrow</annotation><annotation encoding="application/x-llamapun" id="algorithm1.14.14.m1.1d">italic_T start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ←</annotation></semantics></math> update <math alttext="T_{t-1}" class="ltx_Math" display="inline" id="algorithm1.15.15.m2.1"><semantics id="algorithm1.15.15.m2.1a"><msub id="algorithm1.15.15.m2.1.1" xref="algorithm1.15.15.m2.1.1.cmml"><mi id="algorithm1.15.15.m2.1.1.2" xref="algorithm1.15.15.m2.1.1.2.cmml">T</mi><mrow id="algorithm1.15.15.m2.1.1.3" xref="algorithm1.15.15.m2.1.1.3.cmml"><mi id="algorithm1.15.15.m2.1.1.3.2" xref="algorithm1.15.15.m2.1.1.3.2.cmml">t</mi><mo id="algorithm1.15.15.m2.1.1.3.1" xref="algorithm1.15.15.m2.1.1.3.1.cmml">−</mo><mn id="algorithm1.15.15.m2.1.1.3.3" xref="algorithm1.15.15.m2.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="algorithm1.15.15.m2.1b"><apply id="algorithm1.15.15.m2.1.1.cmml" xref="algorithm1.15.15.m2.1.1"><csymbol cd="ambiguous" id="algorithm1.15.15.m2.1.1.1.cmml" xref="algorithm1.15.15.m2.1.1">subscript</csymbol><ci id="algorithm1.15.15.m2.1.1.2.cmml" xref="algorithm1.15.15.m2.1.1.2">𝑇</ci><apply id="algorithm1.15.15.m2.1.1.3.cmml" xref="algorithm1.15.15.m2.1.1.3"><minus id="algorithm1.15.15.m2.1.1.3.1.cmml" xref="algorithm1.15.15.m2.1.1.3.1"></minus><ci id="algorithm1.15.15.m2.1.1.3.2.cmml" xref="algorithm1.15.15.m2.1.1.3.2">𝑡</ci><cn id="algorithm1.15.15.m2.1.1.3.3.cmml" type="integer" xref="algorithm1.15.15.m2.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.15.15.m2.1c">T_{t-1}</annotation><annotation encoding="application/x-llamapun" id="algorithm1.15.15.m2.1d">italic_T start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT</annotation></semantics></math> using gradient descent doing a pass over <math alttext="\mathcal{M}" class="ltx_Math" display="inline" id="algorithm1.16.16.m3.1"><semantics id="algorithm1.16.16.m3.1a"><mi class="ltx_font_mathcaligraphic" id="algorithm1.16.16.m3.1.1" xref="algorithm1.16.16.m3.1.1.cmml">ℳ</mi><annotation-xml encoding="MathML-Content" id="algorithm1.16.16.m3.1b"><ci id="algorithm1.16.16.m3.1.1.cmml" xref="algorithm1.16.16.m3.1.1">ℳ</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.16.16.m3.1c">\mathcal{M}</annotation><annotation encoding="application/x-llamapun" id="algorithm1.16.16.m3.1d">caligraphic_M</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algorithm1.22.24">
<span class="ltx_tag ltx_tag_listingline">9</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   [1.5ex]
<span class="ltx_text ltx_framed ltx_framed_underline" id="algorithm1.22.24.1">Anticipate model deployment:</span>
</div>
<div class="ltx_listingline" id="algorithm1.17.17">
<span class="ltx_tag ltx_tag_listingline">10</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
Let <math alttext="\tilde{S}_{t}" class="ltx_Math" display="inline" id="algorithm1.17.17.m1.1"><semantics id="algorithm1.17.17.m1.1a"><msub id="algorithm1.17.17.m1.1.1" xref="algorithm1.17.17.m1.1.1.cmml"><mover accent="true" id="algorithm1.17.17.m1.1.1.2" xref="algorithm1.17.17.m1.1.1.2.cmml"><mi id="algorithm1.17.17.m1.1.1.2.2" xref="algorithm1.17.17.m1.1.1.2.2.cmml">S</mi><mo id="algorithm1.17.17.m1.1.1.2.1" xref="algorithm1.17.17.m1.1.1.2.1.cmml">~</mo></mover><mi id="algorithm1.17.17.m1.1.1.3" xref="algorithm1.17.17.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="algorithm1.17.17.m1.1b"><apply id="algorithm1.17.17.m1.1.1.cmml" xref="algorithm1.17.17.m1.1.1"><csymbol cd="ambiguous" id="algorithm1.17.17.m1.1.1.1.cmml" xref="algorithm1.17.17.m1.1.1">subscript</csymbol><apply id="algorithm1.17.17.m1.1.1.2.cmml" xref="algorithm1.17.17.m1.1.1.2"><ci id="algorithm1.17.17.m1.1.1.2.1.cmml" xref="algorithm1.17.17.m1.1.1.2.1">~</ci><ci id="algorithm1.17.17.m1.1.1.2.2.cmml" xref="algorithm1.17.17.m1.1.1.2.2">𝑆</ci></apply><ci id="algorithm1.17.17.m1.1.1.3.cmml" xref="algorithm1.17.17.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.17.17.m1.1c">\tilde{S}_{t}</annotation><annotation encoding="application/x-llamapun" id="algorithm1.17.17.m1.1d">over~ start_ARG italic_S end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> be the sufficient statistic to anticipate
</div>
<div class="ltx_listingline" id="algorithm1.19.19">
<span class="ltx_tag ltx_tag_listingline">11</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math alttext="f_{t}\leftarrow" class="ltx_Math" display="inline" id="algorithm1.18.18.m1.1"><semantics id="algorithm1.18.18.m1.1a"><mrow id="algorithm1.18.18.m1.1.1" xref="algorithm1.18.18.m1.1.1.cmml"><msub id="algorithm1.18.18.m1.1.1.2" xref="algorithm1.18.18.m1.1.1.2.cmml"><mi id="algorithm1.18.18.m1.1.1.2.2" xref="algorithm1.18.18.m1.1.1.2.2.cmml">f</mi><mi id="algorithm1.18.18.m1.1.1.2.3" xref="algorithm1.18.18.m1.1.1.2.3.cmml">t</mi></msub><mo id="algorithm1.18.18.m1.1.1.1" stretchy="false" xref="algorithm1.18.18.m1.1.1.1.cmml">←</mo><mi id="algorithm1.18.18.m1.1.1.3" xref="algorithm1.18.18.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.18.18.m1.1b"><apply id="algorithm1.18.18.m1.1.1.cmml" xref="algorithm1.18.18.m1.1.1"><ci id="algorithm1.18.18.m1.1.1.1.cmml" xref="algorithm1.18.18.m1.1.1.1">←</ci><apply id="algorithm1.18.18.m1.1.1.2.cmml" xref="algorithm1.18.18.m1.1.1.2"><csymbol cd="ambiguous" id="algorithm1.18.18.m1.1.1.2.1.cmml" xref="algorithm1.18.18.m1.1.1.2">subscript</csymbol><ci id="algorithm1.18.18.m1.1.1.2.2.cmml" xref="algorithm1.18.18.m1.1.1.2.2">𝑓</ci><ci id="algorithm1.18.18.m1.1.1.2.3.cmml" xref="algorithm1.18.18.m1.1.1.2.3">𝑡</ci></apply><csymbol cd="latexml" id="algorithm1.18.18.m1.1.1.3.cmml" xref="algorithm1.18.18.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.18.18.m1.1c">f_{t}\leftarrow</annotation><annotation encoding="application/x-llamapun" id="algorithm1.18.18.m1.1d">italic_f start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ←</annotation></semantics></math> construct a Performativity-aware Predictor from <math alttext="T_{t}(\tilde{S}_{t})" class="ltx_Math" display="inline" id="algorithm1.19.19.m2.1"><semantics id="algorithm1.19.19.m2.1a"><mrow id="algorithm1.19.19.m2.1.1" xref="algorithm1.19.19.m2.1.1.cmml"><msub id="algorithm1.19.19.m2.1.1.3" xref="algorithm1.19.19.m2.1.1.3.cmml"><mi id="algorithm1.19.19.m2.1.1.3.2" xref="algorithm1.19.19.m2.1.1.3.2.cmml">T</mi><mi id="algorithm1.19.19.m2.1.1.3.3" xref="algorithm1.19.19.m2.1.1.3.3.cmml">t</mi></msub><mo id="algorithm1.19.19.m2.1.1.2" xref="algorithm1.19.19.m2.1.1.2.cmml">⁢</mo><mrow id="algorithm1.19.19.m2.1.1.1.1" xref="algorithm1.19.19.m2.1.1.1.1.1.cmml"><mo id="algorithm1.19.19.m2.1.1.1.1.2" stretchy="false" xref="algorithm1.19.19.m2.1.1.1.1.1.cmml">(</mo><msub id="algorithm1.19.19.m2.1.1.1.1.1" xref="algorithm1.19.19.m2.1.1.1.1.1.cmml"><mover accent="true" id="algorithm1.19.19.m2.1.1.1.1.1.2" xref="algorithm1.19.19.m2.1.1.1.1.1.2.cmml"><mi id="algorithm1.19.19.m2.1.1.1.1.1.2.2" xref="algorithm1.19.19.m2.1.1.1.1.1.2.2.cmml">S</mi><mo id="algorithm1.19.19.m2.1.1.1.1.1.2.1" xref="algorithm1.19.19.m2.1.1.1.1.1.2.1.cmml">~</mo></mover><mi id="algorithm1.19.19.m2.1.1.1.1.1.3" xref="algorithm1.19.19.m2.1.1.1.1.1.3.cmml">t</mi></msub><mo id="algorithm1.19.19.m2.1.1.1.1.3" stretchy="false" xref="algorithm1.19.19.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.19.19.m2.1b"><apply id="algorithm1.19.19.m2.1.1.cmml" xref="algorithm1.19.19.m2.1.1"><times id="algorithm1.19.19.m2.1.1.2.cmml" xref="algorithm1.19.19.m2.1.1.2"></times><apply id="algorithm1.19.19.m2.1.1.3.cmml" xref="algorithm1.19.19.m2.1.1.3"><csymbol cd="ambiguous" id="algorithm1.19.19.m2.1.1.3.1.cmml" xref="algorithm1.19.19.m2.1.1.3">subscript</csymbol><ci id="algorithm1.19.19.m2.1.1.3.2.cmml" xref="algorithm1.19.19.m2.1.1.3.2">𝑇</ci><ci id="algorithm1.19.19.m2.1.1.3.3.cmml" xref="algorithm1.19.19.m2.1.1.3.3">𝑡</ci></apply><apply id="algorithm1.19.19.m2.1.1.1.1.1.cmml" xref="algorithm1.19.19.m2.1.1.1.1"><csymbol cd="ambiguous" id="algorithm1.19.19.m2.1.1.1.1.1.1.cmml" xref="algorithm1.19.19.m2.1.1.1.1">subscript</csymbol><apply id="algorithm1.19.19.m2.1.1.1.1.1.2.cmml" xref="algorithm1.19.19.m2.1.1.1.1.1.2"><ci id="algorithm1.19.19.m2.1.1.1.1.1.2.1.cmml" xref="algorithm1.19.19.m2.1.1.1.1.1.2.1">~</ci><ci id="algorithm1.19.19.m2.1.1.1.1.1.2.2.cmml" xref="algorithm1.19.19.m2.1.1.1.1.1.2.2">𝑆</ci></apply><ci id="algorithm1.19.19.m2.1.1.1.1.1.3.cmml" xref="algorithm1.19.19.m2.1.1.1.1.1.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.19.19.m2.1c">T_{t}(\tilde{S}_{t})</annotation><annotation encoding="application/x-llamapun" id="algorithm1.19.19.m2.1d">italic_T start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( over~ start_ARG italic_S end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math> as in (<a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#S3.E3" title="Equation 3 ‣ 3.2 Anticipating performative label shifts ‣ 3 Anticipating performativity ‣ Adjusting Pretrained Backbones for Performativity"><span class="ltx_text ltx_ref_tag">3</span></a>)
</div>
<div class="ltx_listingline" id="algorithm1.20.20">
<span class="ltx_tag ltx_tag_listingline">12</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math alttext="S_{t}\leftarrow\mathrm{Stat}(f_{t},P_{t})" class="ltx_Math" display="inline" id="algorithm1.20.20.m1.2"><semantics id="algorithm1.20.20.m1.2a"><mrow id="algorithm1.20.20.m1.2.2" xref="algorithm1.20.20.m1.2.2.cmml"><msub id="algorithm1.20.20.m1.2.2.4" xref="algorithm1.20.20.m1.2.2.4.cmml"><mi id="algorithm1.20.20.m1.2.2.4.2" xref="algorithm1.20.20.m1.2.2.4.2.cmml">S</mi><mi id="algorithm1.20.20.m1.2.2.4.3" xref="algorithm1.20.20.m1.2.2.4.3.cmml">t</mi></msub><mo id="algorithm1.20.20.m1.2.2.3" stretchy="false" xref="algorithm1.20.20.m1.2.2.3.cmml">←</mo><mrow id="algorithm1.20.20.m1.2.2.2" xref="algorithm1.20.20.m1.2.2.2.cmml"><mi id="algorithm1.20.20.m1.2.2.2.4" xref="algorithm1.20.20.m1.2.2.2.4.cmml">Stat</mi><mo id="algorithm1.20.20.m1.2.2.2.3" xref="algorithm1.20.20.m1.2.2.2.3.cmml">⁢</mo><mrow id="algorithm1.20.20.m1.2.2.2.2.2" xref="algorithm1.20.20.m1.2.2.2.2.3.cmml"><mo id="algorithm1.20.20.m1.2.2.2.2.2.3" stretchy="false" xref="algorithm1.20.20.m1.2.2.2.2.3.cmml">(</mo><msub id="algorithm1.20.20.m1.1.1.1.1.1.1" xref="algorithm1.20.20.m1.1.1.1.1.1.1.cmml"><mi id="algorithm1.20.20.m1.1.1.1.1.1.1.2" xref="algorithm1.20.20.m1.1.1.1.1.1.1.2.cmml">f</mi><mi id="algorithm1.20.20.m1.1.1.1.1.1.1.3" xref="algorithm1.20.20.m1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="algorithm1.20.20.m1.2.2.2.2.2.4" xref="algorithm1.20.20.m1.2.2.2.2.3.cmml">,</mo><msub id="algorithm1.20.20.m1.2.2.2.2.2.2" xref="algorithm1.20.20.m1.2.2.2.2.2.2.cmml"><mi id="algorithm1.20.20.m1.2.2.2.2.2.2.2" xref="algorithm1.20.20.m1.2.2.2.2.2.2.2.cmml">P</mi><mi id="algorithm1.20.20.m1.2.2.2.2.2.2.3" xref="algorithm1.20.20.m1.2.2.2.2.2.2.3.cmml">t</mi></msub><mo id="algorithm1.20.20.m1.2.2.2.2.2.5" stretchy="false" xref="algorithm1.20.20.m1.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.20.20.m1.2b"><apply id="algorithm1.20.20.m1.2.2.cmml" xref="algorithm1.20.20.m1.2.2"><ci id="algorithm1.20.20.m1.2.2.3.cmml" xref="algorithm1.20.20.m1.2.2.3">←</ci><apply id="algorithm1.20.20.m1.2.2.4.cmml" xref="algorithm1.20.20.m1.2.2.4"><csymbol cd="ambiguous" id="algorithm1.20.20.m1.2.2.4.1.cmml" xref="algorithm1.20.20.m1.2.2.4">subscript</csymbol><ci id="algorithm1.20.20.m1.2.2.4.2.cmml" xref="algorithm1.20.20.m1.2.2.4.2">𝑆</ci><ci id="algorithm1.20.20.m1.2.2.4.3.cmml" xref="algorithm1.20.20.m1.2.2.4.3">𝑡</ci></apply><apply id="algorithm1.20.20.m1.2.2.2.cmml" xref="algorithm1.20.20.m1.2.2.2"><times id="algorithm1.20.20.m1.2.2.2.3.cmml" xref="algorithm1.20.20.m1.2.2.2.3"></times><ci id="algorithm1.20.20.m1.2.2.2.4.cmml" xref="algorithm1.20.20.m1.2.2.2.4">Stat</ci><interval closure="open" id="algorithm1.20.20.m1.2.2.2.2.3.cmml" xref="algorithm1.20.20.m1.2.2.2.2.2"><apply id="algorithm1.20.20.m1.1.1.1.1.1.1.cmml" xref="algorithm1.20.20.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="algorithm1.20.20.m1.1.1.1.1.1.1.1.cmml" xref="algorithm1.20.20.m1.1.1.1.1.1.1">subscript</csymbol><ci id="algorithm1.20.20.m1.1.1.1.1.1.1.2.cmml" xref="algorithm1.20.20.m1.1.1.1.1.1.1.2">𝑓</ci><ci id="algorithm1.20.20.m1.1.1.1.1.1.1.3.cmml" xref="algorithm1.20.20.m1.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="algorithm1.20.20.m1.2.2.2.2.2.2.cmml" xref="algorithm1.20.20.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="algorithm1.20.20.m1.2.2.2.2.2.2.1.cmml" xref="algorithm1.20.20.m1.2.2.2.2.2.2">subscript</csymbol><ci id="algorithm1.20.20.m1.2.2.2.2.2.2.2.cmml" xref="algorithm1.20.20.m1.2.2.2.2.2.2.2">𝑃</ci><ci id="algorithm1.20.20.m1.2.2.2.2.2.2.3.cmml" xref="algorithm1.20.20.m1.2.2.2.2.2.2.3">𝑡</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.20.20.m1.2c">S_{t}\leftarrow\mathrm{Stat}(f_{t},P_{t})</annotation><annotation encoding="application/x-llamapun" id="algorithm1.20.20.m1.2d">italic_S start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ← roman_Stat ( italic_f start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_P start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algorithm1.21.21">
<span class="ltx_tag ltx_tag_listingline">13</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
deploy <math alttext="f_{t}" class="ltx_Math" display="inline" id="algorithm1.21.21.m1.1"><semantics id="algorithm1.21.21.m1.1a"><msub id="algorithm1.21.21.m1.1.1" xref="algorithm1.21.21.m1.1.1.cmml"><mi id="algorithm1.21.21.m1.1.1.2" xref="algorithm1.21.21.m1.1.1.2.cmml">f</mi><mi id="algorithm1.21.21.m1.1.1.3" xref="algorithm1.21.21.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="algorithm1.21.21.m1.1b"><apply id="algorithm1.21.21.m1.1.1.cmml" xref="algorithm1.21.21.m1.1.1"><csymbol cd="ambiguous" id="algorithm1.21.21.m1.1.1.1.cmml" xref="algorithm1.21.21.m1.1.1">subscript</csymbol><ci id="algorithm1.21.21.m1.1.1.2.cmml" xref="algorithm1.21.21.m1.1.1.2">𝑓</ci><ci id="algorithm1.21.21.m1.1.1.3.cmml" xref="algorithm1.21.21.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.21.21.m1.1c">f_{t}</annotation><annotation encoding="application/x-llamapun" id="algorithm1.21.21.m1.1d">italic_f start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algorithm1.22.25">
<span class="ltx_tag ltx_tag_listingline">14</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   [1.5ex]

</div>
<div class="ltx_listingline" id="algorithm1.22.22">
<span class="ltx_text ltx_font_bold" id="algorithm1.22.22.1">Output :</span> Performativity-aware Predictor <math alttext="f_{\mathrm{perf}}=f_{T}" class="ltx_Math" display="inline" id="algorithm1.22.22.m1.1"><semantics id="algorithm1.22.22.m1.1a"><mrow id="algorithm1.22.22.m1.1.1" xref="algorithm1.22.22.m1.1.1.cmml"><msub id="algorithm1.22.22.m1.1.1.2" xref="algorithm1.22.22.m1.1.1.2.cmml"><mi id="algorithm1.22.22.m1.1.1.2.2" xref="algorithm1.22.22.m1.1.1.2.2.cmml">f</mi><mi id="algorithm1.22.22.m1.1.1.2.3" xref="algorithm1.22.22.m1.1.1.2.3.cmml">perf</mi></msub><mo id="algorithm1.22.22.m1.1.1.1" xref="algorithm1.22.22.m1.1.1.1.cmml">=</mo><msub id="algorithm1.22.22.m1.1.1.3" xref="algorithm1.22.22.m1.1.1.3.cmml"><mi id="algorithm1.22.22.m1.1.1.3.2" xref="algorithm1.22.22.m1.1.1.3.2.cmml">f</mi><mi id="algorithm1.22.22.m1.1.1.3.3" xref="algorithm1.22.22.m1.1.1.3.3.cmml">T</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.22.22.m1.1b"><apply id="algorithm1.22.22.m1.1.1.cmml" xref="algorithm1.22.22.m1.1.1"><eq id="algorithm1.22.22.m1.1.1.1.cmml" xref="algorithm1.22.22.m1.1.1.1"></eq><apply id="algorithm1.22.22.m1.1.1.2.cmml" xref="algorithm1.22.22.m1.1.1.2"><csymbol cd="ambiguous" id="algorithm1.22.22.m1.1.1.2.1.cmml" xref="algorithm1.22.22.m1.1.1.2">subscript</csymbol><ci id="algorithm1.22.22.m1.1.1.2.2.cmml" xref="algorithm1.22.22.m1.1.1.2.2">𝑓</ci><ci id="algorithm1.22.22.m1.1.1.2.3.cmml" xref="algorithm1.22.22.m1.1.1.2.3">perf</ci></apply><apply id="algorithm1.22.22.m1.1.1.3.cmml" xref="algorithm1.22.22.m1.1.1.3"><csymbol cd="ambiguous" id="algorithm1.22.22.m1.1.1.3.1.cmml" xref="algorithm1.22.22.m1.1.1.3">subscript</csymbol><ci id="algorithm1.22.22.m1.1.1.3.2.cmml" xref="algorithm1.22.22.m1.1.1.3.2">𝑓</ci><ci id="algorithm1.22.22.m1.1.1.3.3.cmml" xref="algorithm1.22.22.m1.1.1.3.3">𝑇</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.22.22.m1.1c">f_{\mathrm{perf}}=f_{T}</annotation><annotation encoding="application/x-llamapun" id="algorithm1.22.22.m1.1d">italic_f start_POSTSUBSCRIPT roman_perf end_POSTSUBSCRIPT = italic_f start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT</annotation></semantics></math>; 
</div>
<div class="ltx_listingline" id="algorithm1.22.26">
</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="algorithm1.25.1.1">Algorithm 1</span> </span>
<span class="ltx_text ltx_font_bold" id="algorithm1.26.2">Building a performativity-aware predictor.</span>
</figcaption>
</figure>
</section>
</section>
<section class="ltx_subsection" id="S3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Learning adapter module along the retraining trajectory</h3>
<div class="ltx_para" id="S3.SS3.p1">
<p class="ltx_p" id="S3.SS3.p1.8">Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#algorithm1" title="Algorithm 1 ‣ Self-selection. ‣ 3.2 Anticipating performative label shifts ‣ 3 Anticipating performativity ‣ Adjusting Pretrained Backbones for Performativity"><span class="ltx_text ltx_ref_tag">1</span></a> illustrates a muti-step protocol for training the neural network <math alttext="T" class="ltx_Math" display="inline" id="S3.SS3.p1.1.m1.1"><semantics id="S3.SS3.p1.1.m1.1a"><mi id="S3.SS3.p1.1.m1.1.1" xref="S3.SS3.p1.1.m1.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.1.m1.1b"><ci id="S3.SS3.p1.1.m1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.1.m1.1c">T</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.1.m1.1d">italic_T</annotation></semantics></math> to predict the next round’s label marginals. In each round fresh data under the deployment of a new model is collected and used to update <math alttext="T" class="ltx_Math" display="inline" id="S3.SS3.p1.2.m2.1"><semantics id="S3.SS3.p1.2.m2.1a"><mi id="S3.SS3.p1.2.m2.1.1" xref="S3.SS3.p1.2.m2.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.2.m2.1b"><ci id="S3.SS3.p1.2.m2.1.1.cmml" xref="S3.SS3.p1.2.m2.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.2.m2.1c">T</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.2.m2.1d">italic_T</annotation></semantics></math>.
More specifically, in each round, we collect the statistic <math alttext="S_{t-1}" class="ltx_Math" display="inline" id="S3.SS3.p1.3.m3.1"><semantics id="S3.SS3.p1.3.m3.1a"><msub id="S3.SS3.p1.3.m3.1.1" xref="S3.SS3.p1.3.m3.1.1.cmml"><mi id="S3.SS3.p1.3.m3.1.1.2" xref="S3.SS3.p1.3.m3.1.1.2.cmml">S</mi><mrow id="S3.SS3.p1.3.m3.1.1.3" xref="S3.SS3.p1.3.m3.1.1.3.cmml"><mi id="S3.SS3.p1.3.m3.1.1.3.2" xref="S3.SS3.p1.3.m3.1.1.3.2.cmml">t</mi><mo id="S3.SS3.p1.3.m3.1.1.3.1" xref="S3.SS3.p1.3.m3.1.1.3.1.cmml">−</mo><mn id="S3.SS3.p1.3.m3.1.1.3.3" xref="S3.SS3.p1.3.m3.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.3.m3.1b"><apply id="S3.SS3.p1.3.m3.1.1.cmml" xref="S3.SS3.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.3.m3.1.1.1.cmml" xref="S3.SS3.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS3.p1.3.m3.1.1.2.cmml" xref="S3.SS3.p1.3.m3.1.1.2">𝑆</ci><apply id="S3.SS3.p1.3.m3.1.1.3.cmml" xref="S3.SS3.p1.3.m3.1.1.3"><minus id="S3.SS3.p1.3.m3.1.1.3.1.cmml" xref="S3.SS3.p1.3.m3.1.1.3.1"></minus><ci id="S3.SS3.p1.3.m3.1.1.3.2.cmml" xref="S3.SS3.p1.3.m3.1.1.3.2">𝑡</ci><cn id="S3.SS3.p1.3.m3.1.1.3.3.cmml" type="integer" xref="S3.SS3.p1.3.m3.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.3.m3.1c">S_{t-1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.3.m3.1d">italic_S start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT</annotation></semantics></math> of the deployed model <math alttext="f_{t-1}" class="ltx_Math" display="inline" id="S3.SS3.p1.4.m4.1"><semantics id="S3.SS3.p1.4.m4.1a"><msub id="S3.SS3.p1.4.m4.1.1" xref="S3.SS3.p1.4.m4.1.1.cmml"><mi id="S3.SS3.p1.4.m4.1.1.2" xref="S3.SS3.p1.4.m4.1.1.2.cmml">f</mi><mrow id="S3.SS3.p1.4.m4.1.1.3" xref="S3.SS3.p1.4.m4.1.1.3.cmml"><mi id="S3.SS3.p1.4.m4.1.1.3.2" xref="S3.SS3.p1.4.m4.1.1.3.2.cmml">t</mi><mo id="S3.SS3.p1.4.m4.1.1.3.1" xref="S3.SS3.p1.4.m4.1.1.3.1.cmml">−</mo><mn id="S3.SS3.p1.4.m4.1.1.3.3" xref="S3.SS3.p1.4.m4.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.4.m4.1b"><apply id="S3.SS3.p1.4.m4.1.1.cmml" xref="S3.SS3.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.4.m4.1.1.1.cmml" xref="S3.SS3.p1.4.m4.1.1">subscript</csymbol><ci id="S3.SS3.p1.4.m4.1.1.2.cmml" xref="S3.SS3.p1.4.m4.1.1.2">𝑓</ci><apply id="S3.SS3.p1.4.m4.1.1.3.cmml" xref="S3.SS3.p1.4.m4.1.1.3"><minus id="S3.SS3.p1.4.m4.1.1.3.1.cmml" xref="S3.SS3.p1.4.m4.1.1.3.1"></minus><ci id="S3.SS3.p1.4.m4.1.1.3.2.cmml" xref="S3.SS3.p1.4.m4.1.1.3.2">𝑡</ci><cn id="S3.SS3.p1.4.m4.1.1.3.3.cmml" type="integer" xref="S3.SS3.p1.4.m4.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.4.m4.1c">f_{t-1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.4.m4.1d">italic_f start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT</annotation></semantics></math>, together with the induced label marginals <math alttext="\Lambda_{t}" class="ltx_Math" display="inline" id="S3.SS3.p1.5.m5.1"><semantics id="S3.SS3.p1.5.m5.1a"><msub id="S3.SS3.p1.5.m5.1.1" xref="S3.SS3.p1.5.m5.1.1.cmml"><mi id="S3.SS3.p1.5.m5.1.1.2" mathvariant="normal" xref="S3.SS3.p1.5.m5.1.1.2.cmml">Λ</mi><mi id="S3.SS3.p1.5.m5.1.1.3" xref="S3.SS3.p1.5.m5.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.5.m5.1b"><apply id="S3.SS3.p1.5.m5.1.1.cmml" xref="S3.SS3.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.5.m5.1.1.1.cmml" xref="S3.SS3.p1.5.m5.1.1">subscript</csymbol><ci id="S3.SS3.p1.5.m5.1.1.2.cmml" xref="S3.SS3.p1.5.m5.1.1.2">Λ</ci><ci id="S3.SS3.p1.5.m5.1.1.3.cmml" xref="S3.SS3.p1.5.m5.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.5.m5.1c">\Lambda_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.5.m5.1d">roman_Λ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> over <math alttext="P_{t}" class="ltx_Math" display="inline" id="S3.SS3.p1.6.m6.1"><semantics id="S3.SS3.p1.6.m6.1a"><msub id="S3.SS3.p1.6.m6.1.1" xref="S3.SS3.p1.6.m6.1.1.cmml"><mi id="S3.SS3.p1.6.m6.1.1.2" xref="S3.SS3.p1.6.m6.1.1.2.cmml">P</mi><mi id="S3.SS3.p1.6.m6.1.1.3" xref="S3.SS3.p1.6.m6.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.6.m6.1b"><apply id="S3.SS3.p1.6.m6.1.1.cmml" xref="S3.SS3.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.6.m6.1.1.1.cmml" xref="S3.SS3.p1.6.m6.1.1">subscript</csymbol><ci id="S3.SS3.p1.6.m6.1.1.2.cmml" xref="S3.SS3.p1.6.m6.1.1.2">𝑃</ci><ci id="S3.SS3.p1.6.m6.1.1.3.cmml" xref="S3.SS3.p1.6.m6.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.6.m6.1c">P_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.6.m6.1d">italic_P start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> and store it in a memory buffer to learn the predictor <math alttext="T" class="ltx_Math" display="inline" id="S3.SS3.p1.7.m7.1"><semantics id="S3.SS3.p1.7.m7.1a"><mi id="S3.SS3.p1.7.m7.1.1" xref="S3.SS3.p1.7.m7.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.7.m7.1b"><ci id="S3.SS3.p1.7.m7.1.1.cmml" xref="S3.SS3.p1.7.m7.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.7.m7.1c">T</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.7.m7.1d">italic_T</annotation></semantics></math> in a supervised manner.
Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#algorithm1" title="Algorithm 1 ‣ Self-selection. ‣ 3.2 Anticipating performative label shifts ‣ 3 Anticipating performativity ‣ Adjusting Pretrained Backbones for Performativity"><span class="ltx_text ltx_ref_tag">1</span></a> aggregates data along a natural retraining trajectory, where the previous round’s adjusted predictor is deployed repeatedly. This is reflected by <math alttext="\tilde{S}=\mathrm{Stat}(f_{t-1},P_{t-1})" class="ltx_Math" display="inline" id="S3.SS3.p1.8.m8.2"><semantics id="S3.SS3.p1.8.m8.2a"><mrow id="S3.SS3.p1.8.m8.2.2" xref="S3.SS3.p1.8.m8.2.2.cmml"><mover accent="true" id="S3.SS3.p1.8.m8.2.2.4" xref="S3.SS3.p1.8.m8.2.2.4.cmml"><mi id="S3.SS3.p1.8.m8.2.2.4.2" xref="S3.SS3.p1.8.m8.2.2.4.2.cmml">S</mi><mo id="S3.SS3.p1.8.m8.2.2.4.1" xref="S3.SS3.p1.8.m8.2.2.4.1.cmml">~</mo></mover><mo id="S3.SS3.p1.8.m8.2.2.3" xref="S3.SS3.p1.8.m8.2.2.3.cmml">=</mo><mrow id="S3.SS3.p1.8.m8.2.2.2" xref="S3.SS3.p1.8.m8.2.2.2.cmml"><mi id="S3.SS3.p1.8.m8.2.2.2.4" xref="S3.SS3.p1.8.m8.2.2.2.4.cmml">Stat</mi><mo id="S3.SS3.p1.8.m8.2.2.2.3" xref="S3.SS3.p1.8.m8.2.2.2.3.cmml">⁢</mo><mrow id="S3.SS3.p1.8.m8.2.2.2.2.2" xref="S3.SS3.p1.8.m8.2.2.2.2.3.cmml"><mo id="S3.SS3.p1.8.m8.2.2.2.2.2.3" stretchy="false" xref="S3.SS3.p1.8.m8.2.2.2.2.3.cmml">(</mo><msub id="S3.SS3.p1.8.m8.1.1.1.1.1.1" xref="S3.SS3.p1.8.m8.1.1.1.1.1.1.cmml"><mi id="S3.SS3.p1.8.m8.1.1.1.1.1.1.2" xref="S3.SS3.p1.8.m8.1.1.1.1.1.1.2.cmml">f</mi><mrow id="S3.SS3.p1.8.m8.1.1.1.1.1.1.3" xref="S3.SS3.p1.8.m8.1.1.1.1.1.1.3.cmml"><mi id="S3.SS3.p1.8.m8.1.1.1.1.1.1.3.2" xref="S3.SS3.p1.8.m8.1.1.1.1.1.1.3.2.cmml">t</mi><mo id="S3.SS3.p1.8.m8.1.1.1.1.1.1.3.1" xref="S3.SS3.p1.8.m8.1.1.1.1.1.1.3.1.cmml">−</mo><mn id="S3.SS3.p1.8.m8.1.1.1.1.1.1.3.3" xref="S3.SS3.p1.8.m8.1.1.1.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="S3.SS3.p1.8.m8.2.2.2.2.2.4" xref="S3.SS3.p1.8.m8.2.2.2.2.3.cmml">,</mo><msub id="S3.SS3.p1.8.m8.2.2.2.2.2.2" xref="S3.SS3.p1.8.m8.2.2.2.2.2.2.cmml"><mi id="S3.SS3.p1.8.m8.2.2.2.2.2.2.2" xref="S3.SS3.p1.8.m8.2.2.2.2.2.2.2.cmml">P</mi><mrow id="S3.SS3.p1.8.m8.2.2.2.2.2.2.3" xref="S3.SS3.p1.8.m8.2.2.2.2.2.2.3.cmml"><mi id="S3.SS3.p1.8.m8.2.2.2.2.2.2.3.2" xref="S3.SS3.p1.8.m8.2.2.2.2.2.2.3.2.cmml">t</mi><mo id="S3.SS3.p1.8.m8.2.2.2.2.2.2.3.1" xref="S3.SS3.p1.8.m8.2.2.2.2.2.2.3.1.cmml">−</mo><mn id="S3.SS3.p1.8.m8.2.2.2.2.2.2.3.3" xref="S3.SS3.p1.8.m8.2.2.2.2.2.2.3.3.cmml">1</mn></mrow></msub><mo id="S3.SS3.p1.8.m8.2.2.2.2.2.5" stretchy="false" xref="S3.SS3.p1.8.m8.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.8.m8.2b"><apply id="S3.SS3.p1.8.m8.2.2.cmml" xref="S3.SS3.p1.8.m8.2.2"><eq id="S3.SS3.p1.8.m8.2.2.3.cmml" xref="S3.SS3.p1.8.m8.2.2.3"></eq><apply id="S3.SS3.p1.8.m8.2.2.4.cmml" xref="S3.SS3.p1.8.m8.2.2.4"><ci id="S3.SS3.p1.8.m8.2.2.4.1.cmml" xref="S3.SS3.p1.8.m8.2.2.4.1">~</ci><ci id="S3.SS3.p1.8.m8.2.2.4.2.cmml" xref="S3.SS3.p1.8.m8.2.2.4.2">𝑆</ci></apply><apply id="S3.SS3.p1.8.m8.2.2.2.cmml" xref="S3.SS3.p1.8.m8.2.2.2"><times id="S3.SS3.p1.8.m8.2.2.2.3.cmml" xref="S3.SS3.p1.8.m8.2.2.2.3"></times><ci id="S3.SS3.p1.8.m8.2.2.2.4.cmml" xref="S3.SS3.p1.8.m8.2.2.2.4">Stat</ci><interval closure="open" id="S3.SS3.p1.8.m8.2.2.2.2.3.cmml" xref="S3.SS3.p1.8.m8.2.2.2.2.2"><apply id="S3.SS3.p1.8.m8.1.1.1.1.1.1.cmml" xref="S3.SS3.p1.8.m8.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.8.m8.1.1.1.1.1.1.1.cmml" xref="S3.SS3.p1.8.m8.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS3.p1.8.m8.1.1.1.1.1.1.2.cmml" xref="S3.SS3.p1.8.m8.1.1.1.1.1.1.2">𝑓</ci><apply id="S3.SS3.p1.8.m8.1.1.1.1.1.1.3.cmml" xref="S3.SS3.p1.8.m8.1.1.1.1.1.1.3"><minus id="S3.SS3.p1.8.m8.1.1.1.1.1.1.3.1.cmml" xref="S3.SS3.p1.8.m8.1.1.1.1.1.1.3.1"></minus><ci id="S3.SS3.p1.8.m8.1.1.1.1.1.1.3.2.cmml" xref="S3.SS3.p1.8.m8.1.1.1.1.1.1.3.2">𝑡</ci><cn id="S3.SS3.p1.8.m8.1.1.1.1.1.1.3.3.cmml" type="integer" xref="S3.SS3.p1.8.m8.1.1.1.1.1.1.3.3">1</cn></apply></apply><apply id="S3.SS3.p1.8.m8.2.2.2.2.2.2.cmml" xref="S3.SS3.p1.8.m8.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.p1.8.m8.2.2.2.2.2.2.1.cmml" xref="S3.SS3.p1.8.m8.2.2.2.2.2.2">subscript</csymbol><ci id="S3.SS3.p1.8.m8.2.2.2.2.2.2.2.cmml" xref="S3.SS3.p1.8.m8.2.2.2.2.2.2.2">𝑃</ci><apply id="S3.SS3.p1.8.m8.2.2.2.2.2.2.3.cmml" xref="S3.SS3.p1.8.m8.2.2.2.2.2.2.3"><minus id="S3.SS3.p1.8.m8.2.2.2.2.2.2.3.1.cmml" xref="S3.SS3.p1.8.m8.2.2.2.2.2.2.3.1"></minus><ci id="S3.SS3.p1.8.m8.2.2.2.2.2.2.3.2.cmml" xref="S3.SS3.p1.8.m8.2.2.2.2.2.2.3.2">𝑡</ci><cn id="S3.SS3.p1.8.m8.2.2.2.2.2.2.3.3.cmml" type="integer" xref="S3.SS3.p1.8.m8.2.2.2.2.2.2.3.3">1</cn></apply></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.8.m8.2c">\tilde{S}=\mathrm{Stat}(f_{t-1},P_{t-1})</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.8.m8.2d">over~ start_ARG italic_S end_ARG = roman_Stat ( italic_f start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT , italic_P start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT )</annotation></semantics></math> defining the next distribution.</p>
</div>
<section class="ltx_paragraph" id="S3.SS3.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">End product.</h4>
<div class="ltx_para" id="S3.SS3.SSS0.Px1.p1">
<p class="ltx_p" id="S3.SS3.SSS0.Px1.p1.2">Our algorithm outputs the trained module <math alttext="T" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px1.p1.1.m1.1"><semantics id="S3.SS3.SSS0.Px1.p1.1.m1.1a"><mi id="S3.SS3.SSS0.Px1.p1.1.m1.1.1" xref="S3.SS3.SSS0.Px1.p1.1.m1.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p1.1.m1.1b"><ci id="S3.SS3.SSS0.Px1.p1.1.m1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.1.m1.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p1.1.m1.1c">T</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px1.p1.1.m1.1d">italic_T</annotation></semantics></math> that serves to construct a performativity-aware predictor and to anticipate the performative label shift of future deployments. Once <math alttext="T" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px1.p1.2.m2.1"><semantics id="S3.SS3.SSS0.Px1.p1.2.m2.1a"><mi id="S3.SS3.SSS0.Px1.p1.2.m2.1.1" xref="S3.SS3.SSS0.Px1.p1.2.m2.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p1.2.m2.1b"><ci id="S3.SS3.SSS0.Px1.p1.2.m2.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.2.m2.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p1.2.m2.1c">T</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px1.p1.2.m2.1d">italic_T</annotation></semantics></math> is known, the consequences of a model deployment can be anticipated before actually putting it out in the wild, simply by feeding the model’s statistic into the adjustment module to predict the consequences. While we focus on predictive accuracy as a metric in this work, the same procedure could be used to directly measure class imbalances after deployment, and account for the desire to reflect different groups equally well in the data <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#bib.bib82" title="">82</a>]</cite>, or other societal desiderata <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#bib.bib15" title="">15</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#bib.bib5" title="">5</a>]</cite>.</p>
</div>
</section>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Experiments</h2>
<div class="ltx_para" id="S4.p1">
<p class="ltx_p" id="S4.p1.1">We empirically investigate the performance of our adapter module under performative label shift for vision and language classification tasks.
For vision, we evaluate our model on CIFAR100 <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#bib.bib44" title="">44</a>]</cite>, ImageNet100 <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#bib.bib12" title="">12</a>]</cite>, and TerraIncognita <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#bib.bib6" title="">6</a>]</cite>.
For language, we use Amazon <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#bib.bib60" title="">60</a>]</cite> and AGNews <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#bib.bib85" title="">85</a>]</cite>.
We evaluate the performances of different baselines in a semi-synthetic setting where we simulate model deployments and performative shifts across multiple rounds of retraining.</p>
</div>
<section class="ltx_paragraph" id="S4.SS0.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">Baselines.</h4>
<div class="ltx_para" id="S4.SS0.SSS0.Px1.p1">
<p class="ltx_p" id="S4.SS0.SSS0.Px1.p1.1">We use three different baselines for adjusting a model to performative distribution shifts: <span class="ltx_text ltx_font_italic" id="S4.SS0.SSS0.Px1.p1.1.1">Oracle Fine-tuning</span>, <span class="ltx_text ltx_font_italic" id="S4.SS0.SSS0.Px1.p1.1.2">Oracle Distribution</span>, and <span class="ltx_text ltx_font_italic" id="S4.SS0.SSS0.Px1.p1.1.3">No Adaptation</span>. All of them start with the deployment of a pretrained model and then tackle performative shifts in their own way.</p>
</div>
<div class="ltx_para" id="S4.SS0.SSS0.Px1.p2">
<ul class="ltx_itemize" id="S4.I1">
<li class="ltx_item" id="S4.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I1.i1.p1">
<p class="ltx_p" id="S4.I1.i1.p1.4"><span class="ltx_text ltx_font_italic" id="S4.I1.i1.p1.4.1">Oracle Fine-tuning</span> adapts the pretrained model by training it with complete information about current round’s <math alttext="(x,y)" class="ltx_Math" display="inline" id="S4.I1.i1.p1.1.m1.2"><semantics id="S4.I1.i1.p1.1.m1.2a"><mrow id="S4.I1.i1.p1.1.m1.2.3.2" xref="S4.I1.i1.p1.1.m1.2.3.1.cmml"><mo id="S4.I1.i1.p1.1.m1.2.3.2.1" stretchy="false" xref="S4.I1.i1.p1.1.m1.2.3.1.cmml">(</mo><mi id="S4.I1.i1.p1.1.m1.1.1" xref="S4.I1.i1.p1.1.m1.1.1.cmml">x</mi><mo id="S4.I1.i1.p1.1.m1.2.3.2.2" xref="S4.I1.i1.p1.1.m1.2.3.1.cmml">,</mo><mi id="S4.I1.i1.p1.1.m1.2.2" xref="S4.I1.i1.p1.1.m1.2.2.cmml">y</mi><mo id="S4.I1.i1.p1.1.m1.2.3.2.3" stretchy="false" xref="S4.I1.i1.p1.1.m1.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.I1.i1.p1.1.m1.2b"><interval closure="open" id="S4.I1.i1.p1.1.m1.2.3.1.cmml" xref="S4.I1.i1.p1.1.m1.2.3.2"><ci id="S4.I1.i1.p1.1.m1.1.1.cmml" xref="S4.I1.i1.p1.1.m1.1.1">𝑥</ci><ci id="S4.I1.i1.p1.1.m1.2.2.cmml" xref="S4.I1.i1.p1.1.m1.2.2">𝑦</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i1.p1.1.m1.2c">(x,y)</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i1.p1.1.m1.2d">( italic_x , italic_y )</annotation></semantics></math> pairs for <math alttext="25" class="ltx_Math" display="inline" id="S4.I1.i1.p1.2.m2.1"><semantics id="S4.I1.i1.p1.2.m2.1a"><mn id="S4.I1.i1.p1.2.m2.1.1" xref="S4.I1.i1.p1.2.m2.1.1.cmml">25</mn><annotation-xml encoding="MathML-Content" id="S4.I1.i1.p1.2.m2.1b"><cn id="S4.I1.i1.p1.2.m2.1.1.cmml" type="integer" xref="S4.I1.i1.p1.2.m2.1.1">25</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i1.p1.2.m2.1c">25</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i1.p1.2.m2.1d">25</annotation></semantics></math> epochs after observing the shift. While this approach ensures convergence on the available data and allows the model to continuously learn from an expanding number of samples across rounds, it may be computationally costly and potentially overfits to the current distribution, which increases its sensitivity to distribution shifts. In other words, <span class="ltx_text ltx_font_italic" id="S4.I1.i1.p1.4.2">Oracle Fine-tuning</span> updates <math alttext="f_{t}" class="ltx_Math" display="inline" id="S4.I1.i1.p1.3.m3.1"><semantics id="S4.I1.i1.p1.3.m3.1a"><msub id="S4.I1.i1.p1.3.m3.1.1" xref="S4.I1.i1.p1.3.m3.1.1.cmml"><mi id="S4.I1.i1.p1.3.m3.1.1.2" xref="S4.I1.i1.p1.3.m3.1.1.2.cmml">f</mi><mi id="S4.I1.i1.p1.3.m3.1.1.3" xref="S4.I1.i1.p1.3.m3.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S4.I1.i1.p1.3.m3.1b"><apply id="S4.I1.i1.p1.3.m3.1.1.cmml" xref="S4.I1.i1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S4.I1.i1.p1.3.m3.1.1.1.cmml" xref="S4.I1.i1.p1.3.m3.1.1">subscript</csymbol><ci id="S4.I1.i1.p1.3.m3.1.1.2.cmml" xref="S4.I1.i1.p1.3.m3.1.1.2">𝑓</ci><ci id="S4.I1.i1.p1.3.m3.1.1.3.cmml" xref="S4.I1.i1.p1.3.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i1.p1.3.m3.1c">f_{t}</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i1.p1.3.m3.1d">italic_f start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> in each step to fit the current distribution <math alttext="P_{t}(X,Y)" class="ltx_Math" display="inline" id="S4.I1.i1.p1.4.m4.2"><semantics id="S4.I1.i1.p1.4.m4.2a"><mrow id="S4.I1.i1.p1.4.m4.2.3" xref="S4.I1.i1.p1.4.m4.2.3.cmml"><msub id="S4.I1.i1.p1.4.m4.2.3.2" xref="S4.I1.i1.p1.4.m4.2.3.2.cmml"><mi id="S4.I1.i1.p1.4.m4.2.3.2.2" xref="S4.I1.i1.p1.4.m4.2.3.2.2.cmml">P</mi><mi id="S4.I1.i1.p1.4.m4.2.3.2.3" xref="S4.I1.i1.p1.4.m4.2.3.2.3.cmml">t</mi></msub><mo id="S4.I1.i1.p1.4.m4.2.3.1" xref="S4.I1.i1.p1.4.m4.2.3.1.cmml">⁢</mo><mrow id="S4.I1.i1.p1.4.m4.2.3.3.2" xref="S4.I1.i1.p1.4.m4.2.3.3.1.cmml"><mo id="S4.I1.i1.p1.4.m4.2.3.3.2.1" stretchy="false" xref="S4.I1.i1.p1.4.m4.2.3.3.1.cmml">(</mo><mi id="S4.I1.i1.p1.4.m4.1.1" xref="S4.I1.i1.p1.4.m4.1.1.cmml">X</mi><mo id="S4.I1.i1.p1.4.m4.2.3.3.2.2" xref="S4.I1.i1.p1.4.m4.2.3.3.1.cmml">,</mo><mi id="S4.I1.i1.p1.4.m4.2.2" xref="S4.I1.i1.p1.4.m4.2.2.cmml">Y</mi><mo id="S4.I1.i1.p1.4.m4.2.3.3.2.3" stretchy="false" xref="S4.I1.i1.p1.4.m4.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.I1.i1.p1.4.m4.2b"><apply id="S4.I1.i1.p1.4.m4.2.3.cmml" xref="S4.I1.i1.p1.4.m4.2.3"><times id="S4.I1.i1.p1.4.m4.2.3.1.cmml" xref="S4.I1.i1.p1.4.m4.2.3.1"></times><apply id="S4.I1.i1.p1.4.m4.2.3.2.cmml" xref="S4.I1.i1.p1.4.m4.2.3.2"><csymbol cd="ambiguous" id="S4.I1.i1.p1.4.m4.2.3.2.1.cmml" xref="S4.I1.i1.p1.4.m4.2.3.2">subscript</csymbol><ci id="S4.I1.i1.p1.4.m4.2.3.2.2.cmml" xref="S4.I1.i1.p1.4.m4.2.3.2.2">𝑃</ci><ci id="S4.I1.i1.p1.4.m4.2.3.2.3.cmml" xref="S4.I1.i1.p1.4.m4.2.3.2.3">𝑡</ci></apply><interval closure="open" id="S4.I1.i1.p1.4.m4.2.3.3.1.cmml" xref="S4.I1.i1.p1.4.m4.2.3.3.2"><ci id="S4.I1.i1.p1.4.m4.1.1.cmml" xref="S4.I1.i1.p1.4.m4.1.1">𝑋</ci><ci id="S4.I1.i1.p1.4.m4.2.2.cmml" xref="S4.I1.i1.p1.4.m4.2.2">𝑌</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i1.p1.4.m4.2c">P_{t}(X,Y)</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i1.p1.4.m4.2d">italic_P start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( italic_X , italic_Y )</annotation></semantics></math>.</p>
</div>
</li>
<li class="ltx_item" id="S4.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I1.i2.p1">
<p class="ltx_p" id="S4.I1.i2.p1.1"><span class="ltx_text ltx_font_italic" id="S4.I1.i2.p1.1.1">Oracle Distribution</span> uses the true label marginals to adjust the pretrained model’s predictions instead of the estimates from the adapter module. It serves as an upper bound.</p>
</div>
</li>
<li class="ltx_item" id="S4.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I1.i3.p1">
<p class="ltx_p" id="S4.I1.i3.p1.1"><span class="ltx_text ltx_font_italic" id="S4.I1.i3.p1.1.1">No Adaptation</span> uses a fixed pretrained model without making any adjustments for the performative distribution shifts over rounds. This baseline provides a reference point for evaluating the value of adaptation strategies in handling performative shifts.</p>
</div>
</li>
</ul>
</div>
</section>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Performative label shift</h3>
<div class="ltx_para" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.4">We simulate performative label shift caused by a model’s predictive accuracy in previous rounds, as observed in the context of dynamic benchmarks <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#bib.bib73" title="">73</a>]</cite>, adversarial sampling <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#bib.bib61" title="">61</a>]</cite> and self-selection <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#bib.bib29" title="">29</a>]</cite>, see discussion in Section <a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#S3.SS2" title="3.2 Anticipating performative label shifts ‣ 3 Anticipating performativity ‣ Adjusting Pretrained Backbones for Performativity"><span class="ltx_text ltx_ref_tag">3.2</span></a>. Thus, we use the model’s class-wise accuracy as a sufficient statistic for the shift, i.e.,</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E5">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="S_{t}:=[\text{Acc}_{t}[0],\text{Acc}_{t}[1],...,\text{Acc}_{t}[K-1]]," class="ltx_Math" display="block" id="S4.E5.m1.4"><semantics id="S4.E5.m1.4a"><mrow id="S4.E5.m1.4.4.1" xref="S4.E5.m1.4.4.1.1.cmml"><mrow id="S4.E5.m1.4.4.1.1" xref="S4.E5.m1.4.4.1.1.cmml"><msub id="S4.E5.m1.4.4.1.1.5" xref="S4.E5.m1.4.4.1.1.5.cmml"><mi id="S4.E5.m1.4.4.1.1.5.2" xref="S4.E5.m1.4.4.1.1.5.2.cmml">S</mi><mi id="S4.E5.m1.4.4.1.1.5.3" xref="S4.E5.m1.4.4.1.1.5.3.cmml">t</mi></msub><mo id="S4.E5.m1.4.4.1.1.4" lspace="0.278em" rspace="0.278em" xref="S4.E5.m1.4.4.1.1.4.cmml">:=</mo><mrow id="S4.E5.m1.4.4.1.1.3.3" xref="S4.E5.m1.4.4.1.1.3.4.cmml"><mo id="S4.E5.m1.4.4.1.1.3.3.4" stretchy="false" xref="S4.E5.m1.4.4.1.1.3.4.cmml">[</mo><mrow id="S4.E5.m1.4.4.1.1.1.1.1" xref="S4.E5.m1.4.4.1.1.1.1.1.cmml"><msub id="S4.E5.m1.4.4.1.1.1.1.1.2" xref="S4.E5.m1.4.4.1.1.1.1.1.2.cmml"><mtext id="S4.E5.m1.4.4.1.1.1.1.1.2.2" xref="S4.E5.m1.4.4.1.1.1.1.1.2.2a.cmml">Acc</mtext><mi id="S4.E5.m1.4.4.1.1.1.1.1.2.3" xref="S4.E5.m1.4.4.1.1.1.1.1.2.3.cmml">t</mi></msub><mo id="S4.E5.m1.4.4.1.1.1.1.1.1" xref="S4.E5.m1.4.4.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S4.E5.m1.4.4.1.1.1.1.1.3.2" xref="S4.E5.m1.4.4.1.1.1.1.1.3.1.cmml"><mo id="S4.E5.m1.4.4.1.1.1.1.1.3.2.1" stretchy="false" xref="S4.E5.m1.4.4.1.1.1.1.1.3.1.1.cmml">[</mo><mn id="S4.E5.m1.1.1" xref="S4.E5.m1.1.1.cmml">0</mn><mo id="S4.E5.m1.4.4.1.1.1.1.1.3.2.2" stretchy="false" xref="S4.E5.m1.4.4.1.1.1.1.1.3.1.1.cmml">]</mo></mrow></mrow><mo id="S4.E5.m1.4.4.1.1.3.3.5" xref="S4.E5.m1.4.4.1.1.3.4.cmml">,</mo><mrow id="S4.E5.m1.4.4.1.1.2.2.2" xref="S4.E5.m1.4.4.1.1.2.2.2.cmml"><msub id="S4.E5.m1.4.4.1.1.2.2.2.2" xref="S4.E5.m1.4.4.1.1.2.2.2.2.cmml"><mtext id="S4.E5.m1.4.4.1.1.2.2.2.2.2" xref="S4.E5.m1.4.4.1.1.2.2.2.2.2a.cmml">Acc</mtext><mi id="S4.E5.m1.4.4.1.1.2.2.2.2.3" xref="S4.E5.m1.4.4.1.1.2.2.2.2.3.cmml">t</mi></msub><mo id="S4.E5.m1.4.4.1.1.2.2.2.1" xref="S4.E5.m1.4.4.1.1.2.2.2.1.cmml">⁢</mo><mrow id="S4.E5.m1.4.4.1.1.2.2.2.3.2" xref="S4.E5.m1.4.4.1.1.2.2.2.3.1.cmml"><mo id="S4.E5.m1.4.4.1.1.2.2.2.3.2.1" stretchy="false" xref="S4.E5.m1.4.4.1.1.2.2.2.3.1.1.cmml">[</mo><mn id="S4.E5.m1.2.2" xref="S4.E5.m1.2.2.cmml">1</mn><mo id="S4.E5.m1.4.4.1.1.2.2.2.3.2.2" stretchy="false" xref="S4.E5.m1.4.4.1.1.2.2.2.3.1.1.cmml">]</mo></mrow></mrow><mo id="S4.E5.m1.4.4.1.1.3.3.6" xref="S4.E5.m1.4.4.1.1.3.4.cmml">,</mo><mi id="S4.E5.m1.3.3" mathvariant="normal" xref="S4.E5.m1.3.3.cmml">…</mi><mo id="S4.E5.m1.4.4.1.1.3.3.7" xref="S4.E5.m1.4.4.1.1.3.4.cmml">,</mo><mrow id="S4.E5.m1.4.4.1.1.3.3.3" xref="S4.E5.m1.4.4.1.1.3.3.3.cmml"><msub id="S4.E5.m1.4.4.1.1.3.3.3.3" xref="S4.E5.m1.4.4.1.1.3.3.3.3.cmml"><mtext id="S4.E5.m1.4.4.1.1.3.3.3.3.2" xref="S4.E5.m1.4.4.1.1.3.3.3.3.2a.cmml">Acc</mtext><mi id="S4.E5.m1.4.4.1.1.3.3.3.3.3" xref="S4.E5.m1.4.4.1.1.3.3.3.3.3.cmml">t</mi></msub><mo id="S4.E5.m1.4.4.1.1.3.3.3.2" xref="S4.E5.m1.4.4.1.1.3.3.3.2.cmml">⁢</mo><mrow id="S4.E5.m1.4.4.1.1.3.3.3.1.1" xref="S4.E5.m1.4.4.1.1.3.3.3.1.2.cmml"><mo id="S4.E5.m1.4.4.1.1.3.3.3.1.1.2" stretchy="false" xref="S4.E5.m1.4.4.1.1.3.3.3.1.2.1.cmml">[</mo><mrow id="S4.E5.m1.4.4.1.1.3.3.3.1.1.1" xref="S4.E5.m1.4.4.1.1.3.3.3.1.1.1.cmml"><mi id="S4.E5.m1.4.4.1.1.3.3.3.1.1.1.2" xref="S4.E5.m1.4.4.1.1.3.3.3.1.1.1.2.cmml">K</mi><mo id="S4.E5.m1.4.4.1.1.3.3.3.1.1.1.1" xref="S4.E5.m1.4.4.1.1.3.3.3.1.1.1.1.cmml">−</mo><mn id="S4.E5.m1.4.4.1.1.3.3.3.1.1.1.3" xref="S4.E5.m1.4.4.1.1.3.3.3.1.1.1.3.cmml">1</mn></mrow><mo id="S4.E5.m1.4.4.1.1.3.3.3.1.1.3" stretchy="false" xref="S4.E5.m1.4.4.1.1.3.3.3.1.2.1.cmml">]</mo></mrow></mrow><mo id="S4.E5.m1.4.4.1.1.3.3.8" stretchy="false" xref="S4.E5.m1.4.4.1.1.3.4.cmml">]</mo></mrow></mrow><mo id="S4.E5.m1.4.4.1.2" xref="S4.E5.m1.4.4.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E5.m1.4b"><apply id="S4.E5.m1.4.4.1.1.cmml" xref="S4.E5.m1.4.4.1"><csymbol cd="latexml" id="S4.E5.m1.4.4.1.1.4.cmml" xref="S4.E5.m1.4.4.1.1.4">assign</csymbol><apply id="S4.E5.m1.4.4.1.1.5.cmml" xref="S4.E5.m1.4.4.1.1.5"><csymbol cd="ambiguous" id="S4.E5.m1.4.4.1.1.5.1.cmml" xref="S4.E5.m1.4.4.1.1.5">subscript</csymbol><ci id="S4.E5.m1.4.4.1.1.5.2.cmml" xref="S4.E5.m1.4.4.1.1.5.2">𝑆</ci><ci id="S4.E5.m1.4.4.1.1.5.3.cmml" xref="S4.E5.m1.4.4.1.1.5.3">𝑡</ci></apply><list id="S4.E5.m1.4.4.1.1.3.4.cmml" xref="S4.E5.m1.4.4.1.1.3.3"><apply id="S4.E5.m1.4.4.1.1.1.1.1.cmml" xref="S4.E5.m1.4.4.1.1.1.1.1"><times id="S4.E5.m1.4.4.1.1.1.1.1.1.cmml" xref="S4.E5.m1.4.4.1.1.1.1.1.1"></times><apply id="S4.E5.m1.4.4.1.1.1.1.1.2.cmml" xref="S4.E5.m1.4.4.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E5.m1.4.4.1.1.1.1.1.2.1.cmml" xref="S4.E5.m1.4.4.1.1.1.1.1.2">subscript</csymbol><ci id="S4.E5.m1.4.4.1.1.1.1.1.2.2a.cmml" xref="S4.E5.m1.4.4.1.1.1.1.1.2.2"><mtext id="S4.E5.m1.4.4.1.1.1.1.1.2.2.cmml" xref="S4.E5.m1.4.4.1.1.1.1.1.2.2">Acc</mtext></ci><ci id="S4.E5.m1.4.4.1.1.1.1.1.2.3.cmml" xref="S4.E5.m1.4.4.1.1.1.1.1.2.3">𝑡</ci></apply><apply id="S4.E5.m1.4.4.1.1.1.1.1.3.1.cmml" xref="S4.E5.m1.4.4.1.1.1.1.1.3.2"><csymbol cd="latexml" id="S4.E5.m1.4.4.1.1.1.1.1.3.1.1.cmml" xref="S4.E5.m1.4.4.1.1.1.1.1.3.2.1">delimited-[]</csymbol><cn id="S4.E5.m1.1.1.cmml" type="integer" xref="S4.E5.m1.1.1">0</cn></apply></apply><apply id="S4.E5.m1.4.4.1.1.2.2.2.cmml" xref="S4.E5.m1.4.4.1.1.2.2.2"><times id="S4.E5.m1.4.4.1.1.2.2.2.1.cmml" xref="S4.E5.m1.4.4.1.1.2.2.2.1"></times><apply id="S4.E5.m1.4.4.1.1.2.2.2.2.cmml" xref="S4.E5.m1.4.4.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S4.E5.m1.4.4.1.1.2.2.2.2.1.cmml" xref="S4.E5.m1.4.4.1.1.2.2.2.2">subscript</csymbol><ci id="S4.E5.m1.4.4.1.1.2.2.2.2.2a.cmml" xref="S4.E5.m1.4.4.1.1.2.2.2.2.2"><mtext id="S4.E5.m1.4.4.1.1.2.2.2.2.2.cmml" xref="S4.E5.m1.4.4.1.1.2.2.2.2.2">Acc</mtext></ci><ci id="S4.E5.m1.4.4.1.1.2.2.2.2.3.cmml" xref="S4.E5.m1.4.4.1.1.2.2.2.2.3">𝑡</ci></apply><apply id="S4.E5.m1.4.4.1.1.2.2.2.3.1.cmml" xref="S4.E5.m1.4.4.1.1.2.2.2.3.2"><csymbol cd="latexml" id="S4.E5.m1.4.4.1.1.2.2.2.3.1.1.cmml" xref="S4.E5.m1.4.4.1.1.2.2.2.3.2.1">delimited-[]</csymbol><cn id="S4.E5.m1.2.2.cmml" type="integer" xref="S4.E5.m1.2.2">1</cn></apply></apply><ci id="S4.E5.m1.3.3.cmml" xref="S4.E5.m1.3.3">…</ci><apply id="S4.E5.m1.4.4.1.1.3.3.3.cmml" xref="S4.E5.m1.4.4.1.1.3.3.3"><times id="S4.E5.m1.4.4.1.1.3.3.3.2.cmml" xref="S4.E5.m1.4.4.1.1.3.3.3.2"></times><apply id="S4.E5.m1.4.4.1.1.3.3.3.3.cmml" xref="S4.E5.m1.4.4.1.1.3.3.3.3"><csymbol cd="ambiguous" id="S4.E5.m1.4.4.1.1.3.3.3.3.1.cmml" xref="S4.E5.m1.4.4.1.1.3.3.3.3">subscript</csymbol><ci id="S4.E5.m1.4.4.1.1.3.3.3.3.2a.cmml" xref="S4.E5.m1.4.4.1.1.3.3.3.3.2"><mtext id="S4.E5.m1.4.4.1.1.3.3.3.3.2.cmml" xref="S4.E5.m1.4.4.1.1.3.3.3.3.2">Acc</mtext></ci><ci id="S4.E5.m1.4.4.1.1.3.3.3.3.3.cmml" xref="S4.E5.m1.4.4.1.1.3.3.3.3.3">𝑡</ci></apply><apply id="S4.E5.m1.4.4.1.1.3.3.3.1.2.cmml" xref="S4.E5.m1.4.4.1.1.3.3.3.1.1"><csymbol cd="latexml" id="S4.E5.m1.4.4.1.1.3.3.3.1.2.1.cmml" xref="S4.E5.m1.4.4.1.1.3.3.3.1.1.2">delimited-[]</csymbol><apply id="S4.E5.m1.4.4.1.1.3.3.3.1.1.1.cmml" xref="S4.E5.m1.4.4.1.1.3.3.3.1.1.1"><minus id="S4.E5.m1.4.4.1.1.3.3.3.1.1.1.1.cmml" xref="S4.E5.m1.4.4.1.1.3.3.3.1.1.1.1"></minus><ci id="S4.E5.m1.4.4.1.1.3.3.3.1.1.1.2.cmml" xref="S4.E5.m1.4.4.1.1.3.3.3.1.1.1.2">𝐾</ci><cn id="S4.E5.m1.4.4.1.1.3.3.3.1.1.1.3.cmml" type="integer" xref="S4.E5.m1.4.4.1.1.3.3.3.1.1.1.3">1</cn></apply></apply></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E5.m1.4c">S_{t}:=[\text{Acc}_{t}[0],\text{Acc}_{t}[1],...,\text{Acc}_{t}[K-1]],</annotation><annotation encoding="application/x-llamapun" id="S4.E5.m1.4d">italic_S start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT := [ Acc start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT [ 0 ] , Acc start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT [ 1 ] , … , Acc start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT [ italic_K - 1 ] ] ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS1.p1.3">where <math alttext="\text{Acc}_{t}[i]" class="ltx_Math" display="inline" id="S4.SS1.p1.1.m1.1"><semantics id="S4.SS1.p1.1.m1.1a"><mrow id="S4.SS1.p1.1.m1.1.2" xref="S4.SS1.p1.1.m1.1.2.cmml"><msub id="S4.SS1.p1.1.m1.1.2.2" xref="S4.SS1.p1.1.m1.1.2.2.cmml"><mtext id="S4.SS1.p1.1.m1.1.2.2.2" xref="S4.SS1.p1.1.m1.1.2.2.2a.cmml">Acc</mtext><mi id="S4.SS1.p1.1.m1.1.2.2.3" xref="S4.SS1.p1.1.m1.1.2.2.3.cmml">t</mi></msub><mo id="S4.SS1.p1.1.m1.1.2.1" xref="S4.SS1.p1.1.m1.1.2.1.cmml">⁢</mo><mrow id="S4.SS1.p1.1.m1.1.2.3.2" xref="S4.SS1.p1.1.m1.1.2.3.1.cmml"><mo id="S4.SS1.p1.1.m1.1.2.3.2.1" stretchy="false" xref="S4.SS1.p1.1.m1.1.2.3.1.1.cmml">[</mo><mi id="S4.SS1.p1.1.m1.1.1" xref="S4.SS1.p1.1.m1.1.1.cmml">i</mi><mo id="S4.SS1.p1.1.m1.1.2.3.2.2" stretchy="false" xref="S4.SS1.p1.1.m1.1.2.3.1.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.1.m1.1b"><apply id="S4.SS1.p1.1.m1.1.2.cmml" xref="S4.SS1.p1.1.m1.1.2"><times id="S4.SS1.p1.1.m1.1.2.1.cmml" xref="S4.SS1.p1.1.m1.1.2.1"></times><apply id="S4.SS1.p1.1.m1.1.2.2.cmml" xref="S4.SS1.p1.1.m1.1.2.2"><csymbol cd="ambiguous" id="S4.SS1.p1.1.m1.1.2.2.1.cmml" xref="S4.SS1.p1.1.m1.1.2.2">subscript</csymbol><ci id="S4.SS1.p1.1.m1.1.2.2.2a.cmml" xref="S4.SS1.p1.1.m1.1.2.2.2"><mtext id="S4.SS1.p1.1.m1.1.2.2.2.cmml" xref="S4.SS1.p1.1.m1.1.2.2.2">Acc</mtext></ci><ci id="S4.SS1.p1.1.m1.1.2.2.3.cmml" xref="S4.SS1.p1.1.m1.1.2.2.3">𝑡</ci></apply><apply id="S4.SS1.p1.1.m1.1.2.3.1.cmml" xref="S4.SS1.p1.1.m1.1.2.3.2"><csymbol cd="latexml" id="S4.SS1.p1.1.m1.1.2.3.1.1.cmml" xref="S4.SS1.p1.1.m1.1.2.3.2.1">delimited-[]</csymbol><ci id="S4.SS1.p1.1.m1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.1.m1.1c">\text{Acc}_{t}[i]</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.1.m1.1d">Acc start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT [ italic_i ]</annotation></semantics></math> represents the accuracy of class <math alttext="i" class="ltx_Math" display="inline" id="S4.SS1.p1.2.m2.1"><semantics id="S4.SS1.p1.2.m2.1a"><mi id="S4.SS1.p1.2.m2.1.1" xref="S4.SS1.p1.2.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.2.m2.1b"><ci id="S4.SS1.p1.2.m2.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.2.m2.1c">i</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.2.m2.1d">italic_i</annotation></semantics></math> after model deployment at time step <math alttext="t" class="ltx_Math" display="inline" id="S4.SS1.p1.3.m3.1"><semantics id="S4.SS1.p1.3.m3.1a"><mi id="S4.SS1.p1.3.m3.1.1" xref="S4.SS1.p1.3.m3.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.3.m3.1b"><ci id="S4.SS1.p1.3.m3.1.1.cmml" xref="S4.SS1.p1.3.m3.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.3.m3.1c">t</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.3.m3.1d">italic_t</annotation></semantics></math>.</p>
</div>
<figure class="ltx_table" id="S4.T1">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S4.T1.25.1.1" style="font-size:90%;">Table 1</span>: </span><em class="ltx_emph ltx_font_italic" id="S4.T1.26.2" style="font-size:90%;">Anticipating performative label shift</em><span class="ltx_text" id="S4.T1.27.3" style="font-size:90%;">. The table reports the performance of different models on CIFAR100. Performance is measure on a balanced base data set (pre deployment), after the shift caused by the model (post deployment), and compared with the performance estimate of the <span class="ltx_text ltx_font_italic" id="S4.T1.27.3.1">PaP</span> module.
Our module, correctly anticipate the model ranking which would be incorrect if model selection was performed with the accuracy after the first round, ignoring performativity.</span></figcaption>
<table class="ltx_tabular ltx_centering ltx_align_middle" id="S4.T1.21">
<tr class="ltx_tr" id="S4.T1.21.22">
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T1.21.22.1"><span class="ltx_text ltx_font_bold" id="S4.T1.21.22.1.1">Model</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T1.21.22.2"><span class="ltx_text ltx_font_bold" id="S4.T1.21.22.2.1">Pre deployment</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T1.21.22.3"><span class="ltx_text ltx_font_bold" id="S4.T1.21.22.3.1">Post deployment</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T1.21.22.4"><span class="ltx_text ltx_font_bold" id="S4.T1.21.22.4.1">PaP estimate</span></td>
</tr>
<tr class="ltx_tr" id="S4.T1.7.7">
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.1">Model <math alttext="1" class="ltx_Math" display="inline" id="S4.T1.1.1.1.m1.1"><semantics id="S4.T1.1.1.1.m1.1a"><mn id="S4.T1.1.1.1.m1.1.1" xref="S4.T1.1.1.1.m1.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="S4.T1.1.1.1.m1.1b"><cn id="S4.T1.1.1.1.m1.1.1.cmml" type="integer" xref="S4.T1.1.1.1.m1.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.1.1.1.m1.1c">1</annotation><annotation encoding="application/x-llamapun" id="S4.T1.1.1.1.m1.1d">1</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.3.3.3">
<math alttext="82.60" class="ltx_Math" display="inline" id="S4.T1.2.2.2.m1.1"><semantics id="S4.T1.2.2.2.m1.1a"><mn id="S4.T1.2.2.2.m1.1.1" xref="S4.T1.2.2.2.m1.1.1.cmml">82.60</mn><annotation-xml encoding="MathML-Content" id="S4.T1.2.2.2.m1.1b"><cn id="S4.T1.2.2.2.m1.1.1.cmml" type="float" xref="S4.T1.2.2.2.m1.1.1">82.60</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.2.2.2.m1.1c">82.60</annotation><annotation encoding="application/x-llamapun" id="S4.T1.2.2.2.m1.1d">82.60</annotation></semantics></math> <svg class="ltx_picture ltx_markedasmath" color="#136013" height="19.62" id="S4.T1.3.3.3.m2.1.1.pic1" overflow="visible" version="1.1" width="19.62"><g fill="#136013" stroke="#136013" stroke-width="0.4pt" transform="translate(0,19.62) matrix(1 0 0 -1 0 0) translate(9.81,0) translate(0,9.81)"><path d="M 9.54 0 C 9.54 5.27 5.27 9.54 0 9.54 C -5.27 9.54 -9.54 5.27 -9.54 0 C -9.54 -5.27 -5.27 -9.54 0 -9.54 C 5.27 -9.54 9.54 -5.27 9.54 0 Z M 0 0" style="fill:none"></path><g fill="#136013" stroke="#136013" transform="matrix(1.0 0.0 0.0 1.0 -3.46 -4.46)"><foreignobject height="8.92" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="6.92"><span class="ltx_text" id="S4.T1.3.3.3.m2.1.1.pic1.1.1.1.1.1">1</span></foreignobject></g></g></svg>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.5.5.5">
<math alttext="72.50" class="ltx_Math" display="inline" id="S4.T1.4.4.4.m1.1"><semantics id="S4.T1.4.4.4.m1.1a"><mn id="S4.T1.4.4.4.m1.1.1" xref="S4.T1.4.4.4.m1.1.1.cmml">72.50</mn><annotation-xml encoding="MathML-Content" id="S4.T1.4.4.4.m1.1b"><cn id="S4.T1.4.4.4.m1.1.1.cmml" type="float" xref="S4.T1.4.4.4.m1.1.1">72.50</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.4.4.4.m1.1c">72.50</annotation><annotation encoding="application/x-llamapun" id="S4.T1.4.4.4.m1.1d">72.50</annotation></semantics></math> <svg class="ltx_picture ltx_markedasmath" color="#FF0000" height="19.62" id="S4.T1.5.5.5.m2.1.1.pic1" overflow="visible" version="1.1" width="19.62"><g fill="#FF0000" stroke="#FF0000" stroke-width="0.4pt" transform="translate(0,19.62) matrix(1 0 0 -1 0 0) translate(9.81,0) translate(0,9.81)"><path d="M 9.54 0 C 9.54 5.27 5.27 9.54 0 9.54 C -5.27 9.54 -9.54 5.27 -9.54 0 C -9.54 -5.27 -5.27 -9.54 0 -9.54 C 5.27 -9.54 9.54 -5.27 9.54 0 Z M 0 0" style="fill:none"></path><g fill="#FF0000" stroke="#FF0000" transform="matrix(1.0 0.0 0.0 1.0 -3.46 -4.46)"><foreignobject height="8.92" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="6.92"><span class="ltx_text" id="S4.T1.5.5.5.m2.1.1.pic1.1.1.1.1.1">3</span></foreignobject></g></g></svg>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.7.7.7">
<math alttext="76.42" class="ltx_Math" display="inline" id="S4.T1.6.6.6.m1.1"><semantics id="S4.T1.6.6.6.m1.1a"><mn id="S4.T1.6.6.6.m1.1.1" xref="S4.T1.6.6.6.m1.1.1.cmml">76.42</mn><annotation-xml encoding="MathML-Content" id="S4.T1.6.6.6.m1.1b"><cn id="S4.T1.6.6.6.m1.1.1.cmml" type="float" xref="S4.T1.6.6.6.m1.1.1">76.42</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.6.6.6.m1.1c">76.42</annotation><annotation encoding="application/x-llamapun" id="S4.T1.6.6.6.m1.1d">76.42</annotation></semantics></math> <svg class="ltx_picture ltx_markedasmath" color="#FF0000" height="19.62" id="S4.T1.7.7.7.m2.1.1.pic1" overflow="visible" version="1.1" width="19.62"><g fill="#FF0000" stroke="#FF0000" stroke-width="0.4pt" transform="translate(0,19.62) matrix(1 0 0 -1 0 0) translate(9.81,0) translate(0,9.81)"><path d="M 9.54 0 C 9.54 5.27 5.27 9.54 0 9.54 C -5.27 9.54 -9.54 5.27 -9.54 0 C -9.54 -5.27 -5.27 -9.54 0 -9.54 C 5.27 -9.54 9.54 -5.27 9.54 0 Z M 0 0" style="fill:none"></path><g fill="#FF0000" stroke="#FF0000" transform="matrix(1.0 0.0 0.0 1.0 -3.46 -4.46)"><foreignobject height="8.92" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="6.92"><span class="ltx_text" id="S4.T1.7.7.7.m2.1.1.pic1.1.1.1.1.1">3</span></foreignobject></g></g></svg>
</td>
</tr>
<tr class="ltx_tr" id="S4.T1.14.14">
<td class="ltx_td ltx_align_center" id="S4.T1.8.8.1">Model <math alttext="2" class="ltx_Math" display="inline" id="S4.T1.8.8.1.m1.1"><semantics id="S4.T1.8.8.1.m1.1a"><mn id="S4.T1.8.8.1.m1.1.1" xref="S4.T1.8.8.1.m1.1.1.cmml">2</mn><annotation-xml encoding="MathML-Content" id="S4.T1.8.8.1.m1.1b"><cn id="S4.T1.8.8.1.m1.1.1.cmml" type="integer" xref="S4.T1.8.8.1.m1.1.1">2</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.8.8.1.m1.1c">2</annotation><annotation encoding="application/x-llamapun" id="S4.T1.8.8.1.m1.1d">2</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center" id="S4.T1.10.10.3">
<math alttext="82.12" class="ltx_Math" display="inline" id="S4.T1.9.9.2.m1.1"><semantics id="S4.T1.9.9.2.m1.1a"><mn id="S4.T1.9.9.2.m1.1.1" xref="S4.T1.9.9.2.m1.1.1.cmml">82.12</mn><annotation-xml encoding="MathML-Content" id="S4.T1.9.9.2.m1.1b"><cn id="S4.T1.9.9.2.m1.1.1.cmml" type="float" xref="S4.T1.9.9.2.m1.1.1">82.12</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.9.9.2.m1.1c">82.12</annotation><annotation encoding="application/x-llamapun" id="S4.T1.9.9.2.m1.1d">82.12</annotation></semantics></math> <svg class="ltx_picture ltx_markedasmath" color="#0000FF" height="19.62" id="S4.T1.10.10.3.m2.1.1.pic1" overflow="visible" version="1.1" width="19.62"><g fill="#0000FF" stroke="#0000FF" stroke-width="0.4pt" transform="translate(0,19.62) matrix(1 0 0 -1 0 0) translate(9.81,0) translate(0,9.81)"><path d="M 9.54 0 C 9.54 5.27 5.27 9.54 0 9.54 C -5.27 9.54 -9.54 5.27 -9.54 0 C -9.54 -5.27 -5.27 -9.54 0 -9.54 C 5.27 -9.54 9.54 -5.27 9.54 0 Z M 0 0" style="fill:none"></path><g fill="#0000FF" stroke="#0000FF" transform="matrix(1.0 0.0 0.0 1.0 -3.46 -4.46)"><foreignobject height="8.92" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="6.92"><span class="ltx_text" id="S4.T1.10.10.3.m2.1.1.pic1.1.1.1.1.1">2</span></foreignobject></g></g></svg>
</td>
<td class="ltx_td ltx_align_center" id="S4.T1.12.12.5">
<math alttext="78.72" class="ltx_Math" display="inline" id="S4.T1.11.11.4.m1.1"><semantics id="S4.T1.11.11.4.m1.1a"><mn id="S4.T1.11.11.4.m1.1.1" xref="S4.T1.11.11.4.m1.1.1.cmml">78.72</mn><annotation-xml encoding="MathML-Content" id="S4.T1.11.11.4.m1.1b"><cn id="S4.T1.11.11.4.m1.1.1.cmml" type="float" xref="S4.T1.11.11.4.m1.1.1">78.72</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.11.11.4.m1.1c">78.72</annotation><annotation encoding="application/x-llamapun" id="S4.T1.11.11.4.m1.1d">78.72</annotation></semantics></math> <svg class="ltx_picture ltx_markedasmath" color="#136013" height="19.62" id="S4.T1.12.12.5.m2.1.1.pic1" overflow="visible" version="1.1" width="19.62"><g fill="#136013" stroke="#136013" stroke-width="0.4pt" transform="translate(0,19.62) matrix(1 0 0 -1 0 0) translate(9.81,0) translate(0,9.81)"><path d="M 9.54 0 C 9.54 5.27 5.27 9.54 0 9.54 C -5.27 9.54 -9.54 5.27 -9.54 0 C -9.54 -5.27 -5.27 -9.54 0 -9.54 C 5.27 -9.54 9.54 -5.27 9.54 0 Z M 0 0" style="fill:none"></path><g fill="#136013" stroke="#136013" transform="matrix(1.0 0.0 0.0 1.0 -3.46 -4.46)"><foreignobject height="8.92" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="6.92"><span class="ltx_text" id="S4.T1.12.12.5.m2.1.1.pic1.1.1.1.1.1">1</span></foreignobject></g></g></svg>
</td>
<td class="ltx_td ltx_align_center" id="S4.T1.14.14.7">
<math alttext="77.66" class="ltx_Math" display="inline" id="S4.T1.13.13.6.m1.1"><semantics id="S4.T1.13.13.6.m1.1a"><mn id="S4.T1.13.13.6.m1.1.1" xref="S4.T1.13.13.6.m1.1.1.cmml">77.66</mn><annotation-xml encoding="MathML-Content" id="S4.T1.13.13.6.m1.1b"><cn id="S4.T1.13.13.6.m1.1.1.cmml" type="float" xref="S4.T1.13.13.6.m1.1.1">77.66</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.13.13.6.m1.1c">77.66</annotation><annotation encoding="application/x-llamapun" id="S4.T1.13.13.6.m1.1d">77.66</annotation></semantics></math> <svg class="ltx_picture ltx_markedasmath" color="#136013" height="19.62" id="S4.T1.14.14.7.m2.1.1.pic1" overflow="visible" version="1.1" width="19.62"><g fill="#136013" stroke="#136013" stroke-width="0.4pt" transform="translate(0,19.62) matrix(1 0 0 -1 0 0) translate(9.81,0) translate(0,9.81)"><path d="M 9.54 0 C 9.54 5.27 5.27 9.54 0 9.54 C -5.27 9.54 -9.54 5.27 -9.54 0 C -9.54 -5.27 -5.27 -9.54 0 -9.54 C 5.27 -9.54 9.54 -5.27 9.54 0 Z M 0 0" style="fill:none"></path><g fill="#136013" stroke="#136013" transform="matrix(1.0 0.0 0.0 1.0 -3.46 -4.46)"><foreignobject height="8.92" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="6.92"><span class="ltx_text" id="S4.T1.14.14.7.m2.1.1.pic1.1.1.1.1.1">1</span></foreignobject></g></g></svg>
</td>
</tr>
<tr class="ltx_tr" id="S4.T1.21.21">
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.15.15.1">Model <math alttext="3" class="ltx_Math" display="inline" id="S4.T1.15.15.1.m1.1"><semantics id="S4.T1.15.15.1.m1.1a"><mn id="S4.T1.15.15.1.m1.1.1" xref="S4.T1.15.15.1.m1.1.1.cmml">3</mn><annotation-xml encoding="MathML-Content" id="S4.T1.15.15.1.m1.1b"><cn id="S4.T1.15.15.1.m1.1.1.cmml" type="integer" xref="S4.T1.15.15.1.m1.1.1">3</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.15.15.1.m1.1c">3</annotation><annotation encoding="application/x-llamapun" id="S4.T1.15.15.1.m1.1d">3</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.17.17.3">
<math alttext="81.80" class="ltx_Math" display="inline" id="S4.T1.16.16.2.m1.1"><semantics id="S4.T1.16.16.2.m1.1a"><mn id="S4.T1.16.16.2.m1.1.1" xref="S4.T1.16.16.2.m1.1.1.cmml">81.80</mn><annotation-xml encoding="MathML-Content" id="S4.T1.16.16.2.m1.1b"><cn id="S4.T1.16.16.2.m1.1.1.cmml" type="float" xref="S4.T1.16.16.2.m1.1.1">81.80</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.16.16.2.m1.1c">81.80</annotation><annotation encoding="application/x-llamapun" id="S4.T1.16.16.2.m1.1d">81.80</annotation></semantics></math> <svg class="ltx_picture ltx_markedasmath" color="#FF0000" height="19.62" id="S4.T1.17.17.3.m2.1.1.pic1" overflow="visible" version="1.1" width="19.62"><g fill="#FF0000" stroke="#FF0000" stroke-width="0.4pt" transform="translate(0,19.62) matrix(1 0 0 -1 0 0) translate(9.81,0) translate(0,9.81)"><path d="M 9.54 0 C 9.54 5.27 5.27 9.54 0 9.54 C -5.27 9.54 -9.54 5.27 -9.54 0 C -9.54 -5.27 -5.27 -9.54 0 -9.54 C 5.27 -9.54 9.54 -5.27 9.54 0 Z M 0 0" style="fill:none"></path><g fill="#FF0000" stroke="#FF0000" transform="matrix(1.0 0.0 0.0 1.0 -3.46 -4.46)"><foreignobject height="8.92" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="6.92"><span class="ltx_text" id="S4.T1.17.17.3.m2.1.1.pic1.1.1.1.1.1">3</span></foreignobject></g></g></svg>
</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.19.19.5">
<math alttext="75.90" class="ltx_Math" display="inline" id="S4.T1.18.18.4.m1.1"><semantics id="S4.T1.18.18.4.m1.1a"><mn id="S4.T1.18.18.4.m1.1.1" xref="S4.T1.18.18.4.m1.1.1.cmml">75.90</mn><annotation-xml encoding="MathML-Content" id="S4.T1.18.18.4.m1.1b"><cn id="S4.T1.18.18.4.m1.1.1.cmml" type="float" xref="S4.T1.18.18.4.m1.1.1">75.90</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.18.18.4.m1.1c">75.90</annotation><annotation encoding="application/x-llamapun" id="S4.T1.18.18.4.m1.1d">75.90</annotation></semantics></math> <svg class="ltx_picture ltx_markedasmath" color="#0000FF" height="19.62" id="S4.T1.19.19.5.m2.1.1.pic1" overflow="visible" version="1.1" width="19.62"><g fill="#0000FF" stroke="#0000FF" stroke-width="0.4pt" transform="translate(0,19.62) matrix(1 0 0 -1 0 0) translate(9.81,0) translate(0,9.81)"><path d="M 9.54 0 C 9.54 5.27 5.27 9.54 0 9.54 C -5.27 9.54 -9.54 5.27 -9.54 0 C -9.54 -5.27 -5.27 -9.54 0 -9.54 C 5.27 -9.54 9.54 -5.27 9.54 0 Z M 0 0" style="fill:none"></path><g fill="#0000FF" stroke="#0000FF" transform="matrix(1.0 0.0 0.0 1.0 -3.46 -4.46)"><foreignobject height="8.92" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="6.92"><span class="ltx_text" id="S4.T1.19.19.5.m2.1.1.pic1.1.1.1.1.1">2</span></foreignobject></g></g></svg>
</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.21.21.7">
<math alttext="77.53" class="ltx_Math" display="inline" id="S4.T1.20.20.6.m1.1"><semantics id="S4.T1.20.20.6.m1.1a"><mn id="S4.T1.20.20.6.m1.1.1" xref="S4.T1.20.20.6.m1.1.1.cmml">77.53</mn><annotation-xml encoding="MathML-Content" id="S4.T1.20.20.6.m1.1b"><cn id="S4.T1.20.20.6.m1.1.1.cmml" type="float" xref="S4.T1.20.20.6.m1.1.1">77.53</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.20.20.6.m1.1c">77.53</annotation><annotation encoding="application/x-llamapun" id="S4.T1.20.20.6.m1.1d">77.53</annotation></semantics></math> <svg class="ltx_picture ltx_markedasmath" color="#0000FF" height="19.62" id="S4.T1.21.21.7.m2.1.1.pic1" overflow="visible" version="1.1" width="19.62"><g fill="#0000FF" stroke="#0000FF" stroke-width="0.4pt" transform="translate(0,19.62) matrix(1 0 0 -1 0 0) translate(9.81,0) translate(0,9.81)"><path d="M 9.54 0 C 9.54 5.27 5.27 9.54 0 9.54 C -5.27 9.54 -9.54 5.27 -9.54 0 C -9.54 -5.27 -5.27 -9.54 0 -9.54 C 5.27 -9.54 9.54 -5.27 9.54 0 Z M 0 0" style="fill:none"></path><g fill="#0000FF" stroke="#0000FF" transform="matrix(1.0 0.0 0.0 1.0 -3.46 -4.46)"><foreignobject height="8.92" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="6.92"><span class="ltx_text" id="S4.T1.21.21.7.m2.1.1.pic1.1.1.1.1.1">2</span></foreignobject></g></g></svg>
</td>
</tr>
</table>
</figure>
<div class="ltx_para" id="S4.SS1.p2">
<p class="ltx_p" id="S4.SS1.p2.2">To simulate the performative effect, we pass the current rounds class accuracy through a Softmax to obtain the proportion of each class in the next round.
Specifically, for any class <math alttext="i" class="ltx_Math" display="inline" id="S4.SS1.p2.1.m1.1"><semantics id="S4.SS1.p2.1.m1.1a"><mi id="S4.SS1.p2.1.m1.1.1" xref="S4.SS1.p2.1.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.1.m1.1b"><ci id="S4.SS1.p2.1.m1.1.1.cmml" xref="S4.SS1.p2.1.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.1.m1.1c">i</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.1.m1.1d">italic_i</annotation></semantics></math> the class proportion in round <math alttext="t+1" class="ltx_Math" display="inline" id="S4.SS1.p2.2.m2.1"><semantics id="S4.SS1.p2.2.m2.1a"><mrow id="S4.SS1.p2.2.m2.1.1" xref="S4.SS1.p2.2.m2.1.1.cmml"><mi id="S4.SS1.p2.2.m2.1.1.2" xref="S4.SS1.p2.2.m2.1.1.2.cmml">t</mi><mo id="S4.SS1.p2.2.m2.1.1.1" xref="S4.SS1.p2.2.m2.1.1.1.cmml">+</mo><mn id="S4.SS1.p2.2.m2.1.1.3" xref="S4.SS1.p2.2.m2.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.2.m2.1b"><apply id="S4.SS1.p2.2.m2.1.1.cmml" xref="S4.SS1.p2.2.m2.1.1"><plus id="S4.SS1.p2.2.m2.1.1.1.cmml" xref="S4.SS1.p2.2.m2.1.1.1"></plus><ci id="S4.SS1.p2.2.m2.1.1.2.cmml" xref="S4.SS1.p2.2.m2.1.1.2">𝑡</ci><cn id="S4.SS1.p2.2.m2.1.1.3.cmml" type="integer" xref="S4.SS1.p2.2.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.2.m2.1c">t+1</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.2.m2.1d">italic_t + 1</annotation></semantics></math> is chosen as</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A1.EGx3">
<tbody id="S4.E6"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle P_{t+1}(Y=i|S)=\exp(S_{i}/\tau)\Big{[}\sum_{j=1}^{K}\exp(S_{j}/%
\tau)\Big{]}^{-1}," class="ltx_Math" display="inline" id="S4.E6.m1.3"><semantics id="S4.E6.m1.3a"><mrow id="S4.E6.m1.3.3.1" xref="S4.E6.m1.3.3.1.1.cmml"><mrow id="S4.E6.m1.3.3.1.1" xref="S4.E6.m1.3.3.1.1.cmml"><mrow id="S4.E6.m1.3.3.1.1.1" xref="S4.E6.m1.3.3.1.1.1.cmml"><msub id="S4.E6.m1.3.3.1.1.1.3" xref="S4.E6.m1.3.3.1.1.1.3.cmml"><mi id="S4.E6.m1.3.3.1.1.1.3.2" xref="S4.E6.m1.3.3.1.1.1.3.2.cmml">P</mi><mrow id="S4.E6.m1.3.3.1.1.1.3.3" xref="S4.E6.m1.3.3.1.1.1.3.3.cmml"><mi id="S4.E6.m1.3.3.1.1.1.3.3.2" xref="S4.E6.m1.3.3.1.1.1.3.3.2.cmml">t</mi><mo id="S4.E6.m1.3.3.1.1.1.3.3.1" xref="S4.E6.m1.3.3.1.1.1.3.3.1.cmml">+</mo><mn id="S4.E6.m1.3.3.1.1.1.3.3.3" xref="S4.E6.m1.3.3.1.1.1.3.3.3.cmml">1</mn></mrow></msub><mo id="S4.E6.m1.3.3.1.1.1.2" xref="S4.E6.m1.3.3.1.1.1.2.cmml">⁢</mo><mrow id="S4.E6.m1.3.3.1.1.1.1.1" xref="S4.E6.m1.3.3.1.1.1.1.1.1.cmml"><mo id="S4.E6.m1.3.3.1.1.1.1.1.2" stretchy="false" xref="S4.E6.m1.3.3.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E6.m1.3.3.1.1.1.1.1.1" xref="S4.E6.m1.3.3.1.1.1.1.1.1.cmml"><mi id="S4.E6.m1.3.3.1.1.1.1.1.1.2" xref="S4.E6.m1.3.3.1.1.1.1.1.1.2.cmml">Y</mi><mo id="S4.E6.m1.3.3.1.1.1.1.1.1.1" xref="S4.E6.m1.3.3.1.1.1.1.1.1.1.cmml">=</mo><mrow id="S4.E6.m1.3.3.1.1.1.1.1.1.3" xref="S4.E6.m1.3.3.1.1.1.1.1.1.3.cmml"><mi id="S4.E6.m1.3.3.1.1.1.1.1.1.3.2" xref="S4.E6.m1.3.3.1.1.1.1.1.1.3.2.cmml">i</mi><mo fence="false" id="S4.E6.m1.3.3.1.1.1.1.1.1.3.1" xref="S4.E6.m1.3.3.1.1.1.1.1.1.3.1.cmml">|</mo><mi id="S4.E6.m1.3.3.1.1.1.1.1.1.3.3" xref="S4.E6.m1.3.3.1.1.1.1.1.1.3.3.cmml">S</mi></mrow></mrow><mo id="S4.E6.m1.3.3.1.1.1.1.1.3" stretchy="false" xref="S4.E6.m1.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E6.m1.3.3.1.1.4" xref="S4.E6.m1.3.3.1.1.4.cmml">=</mo><mrow id="S4.E6.m1.3.3.1.1.3" xref="S4.E6.m1.3.3.1.1.3.cmml"><mrow id="S4.E6.m1.3.3.1.1.2.1.1" xref="S4.E6.m1.3.3.1.1.2.1.2.cmml"><mi id="S4.E6.m1.1.1" xref="S4.E6.m1.1.1.cmml">exp</mi><mo id="S4.E6.m1.3.3.1.1.2.1.1a" xref="S4.E6.m1.3.3.1.1.2.1.2.cmml">⁡</mo><mrow id="S4.E6.m1.3.3.1.1.2.1.1.1" xref="S4.E6.m1.3.3.1.1.2.1.2.cmml"><mo id="S4.E6.m1.3.3.1.1.2.1.1.1.2" stretchy="false" xref="S4.E6.m1.3.3.1.1.2.1.2.cmml">(</mo><mrow id="S4.E6.m1.3.3.1.1.2.1.1.1.1" xref="S4.E6.m1.3.3.1.1.2.1.1.1.1.cmml"><msub id="S4.E6.m1.3.3.1.1.2.1.1.1.1.2" xref="S4.E6.m1.3.3.1.1.2.1.1.1.1.2.cmml"><mi id="S4.E6.m1.3.3.1.1.2.1.1.1.1.2.2" xref="S4.E6.m1.3.3.1.1.2.1.1.1.1.2.2.cmml">S</mi><mi id="S4.E6.m1.3.3.1.1.2.1.1.1.1.2.3" xref="S4.E6.m1.3.3.1.1.2.1.1.1.1.2.3.cmml">i</mi></msub><mo id="S4.E6.m1.3.3.1.1.2.1.1.1.1.1" xref="S4.E6.m1.3.3.1.1.2.1.1.1.1.1.cmml">/</mo><mi id="S4.E6.m1.3.3.1.1.2.1.1.1.1.3" xref="S4.E6.m1.3.3.1.1.2.1.1.1.1.3.cmml">τ</mi></mrow><mo id="S4.E6.m1.3.3.1.1.2.1.1.1.3" stretchy="false" xref="S4.E6.m1.3.3.1.1.2.1.2.cmml">)</mo></mrow></mrow><mo id="S4.E6.m1.3.3.1.1.3.3" xref="S4.E6.m1.3.3.1.1.3.3.cmml">⁢</mo><msup id="S4.E6.m1.3.3.1.1.3.2" xref="S4.E6.m1.3.3.1.1.3.2.cmml"><mrow id="S4.E6.m1.3.3.1.1.3.2.1.1" xref="S4.E6.m1.3.3.1.1.3.2.1.2.cmml"><mo id="S4.E6.m1.3.3.1.1.3.2.1.1.2" maxsize="160%" minsize="160%" xref="S4.E6.m1.3.3.1.1.3.2.1.2.1.cmml">[</mo><mrow id="S4.E6.m1.3.3.1.1.3.2.1.1.1" xref="S4.E6.m1.3.3.1.1.3.2.1.1.1.cmml"><mstyle displaystyle="true" id="S4.E6.m1.3.3.1.1.3.2.1.1.1.2" xref="S4.E6.m1.3.3.1.1.3.2.1.1.1.2.cmml"><munderover id="S4.E6.m1.3.3.1.1.3.2.1.1.1.2a" xref="S4.E6.m1.3.3.1.1.3.2.1.1.1.2.cmml"><mo id="S4.E6.m1.3.3.1.1.3.2.1.1.1.2.2.2" movablelimits="false" xref="S4.E6.m1.3.3.1.1.3.2.1.1.1.2.2.2.cmml">∑</mo><mrow id="S4.E6.m1.3.3.1.1.3.2.1.1.1.2.2.3" xref="S4.E6.m1.3.3.1.1.3.2.1.1.1.2.2.3.cmml"><mi id="S4.E6.m1.3.3.1.1.3.2.1.1.1.2.2.3.2" xref="S4.E6.m1.3.3.1.1.3.2.1.1.1.2.2.3.2.cmml">j</mi><mo id="S4.E6.m1.3.3.1.1.3.2.1.1.1.2.2.3.1" xref="S4.E6.m1.3.3.1.1.3.2.1.1.1.2.2.3.1.cmml">=</mo><mn id="S4.E6.m1.3.3.1.1.3.2.1.1.1.2.2.3.3" xref="S4.E6.m1.3.3.1.1.3.2.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S4.E6.m1.3.3.1.1.3.2.1.1.1.2.3" xref="S4.E6.m1.3.3.1.1.3.2.1.1.1.2.3.cmml">K</mi></munderover></mstyle><mrow id="S4.E6.m1.3.3.1.1.3.2.1.1.1.1.1" xref="S4.E6.m1.3.3.1.1.3.2.1.1.1.1.2.cmml"><mi id="S4.E6.m1.2.2" xref="S4.E6.m1.2.2.cmml">exp</mi><mo id="S4.E6.m1.3.3.1.1.3.2.1.1.1.1.1a" xref="S4.E6.m1.3.3.1.1.3.2.1.1.1.1.2.cmml">⁡</mo><mrow id="S4.E6.m1.3.3.1.1.3.2.1.1.1.1.1.1" xref="S4.E6.m1.3.3.1.1.3.2.1.1.1.1.2.cmml"><mo id="S4.E6.m1.3.3.1.1.3.2.1.1.1.1.1.1.2" stretchy="false" xref="S4.E6.m1.3.3.1.1.3.2.1.1.1.1.2.cmml">(</mo><mrow id="S4.E6.m1.3.3.1.1.3.2.1.1.1.1.1.1.1" xref="S4.E6.m1.3.3.1.1.3.2.1.1.1.1.1.1.1.cmml"><msub id="S4.E6.m1.3.3.1.1.3.2.1.1.1.1.1.1.1.2" xref="S4.E6.m1.3.3.1.1.3.2.1.1.1.1.1.1.1.2.cmml"><mi id="S4.E6.m1.3.3.1.1.3.2.1.1.1.1.1.1.1.2.2" xref="S4.E6.m1.3.3.1.1.3.2.1.1.1.1.1.1.1.2.2.cmml">S</mi><mi id="S4.E6.m1.3.3.1.1.3.2.1.1.1.1.1.1.1.2.3" xref="S4.E6.m1.3.3.1.1.3.2.1.1.1.1.1.1.1.2.3.cmml">j</mi></msub><mo id="S4.E6.m1.3.3.1.1.3.2.1.1.1.1.1.1.1.1" xref="S4.E6.m1.3.3.1.1.3.2.1.1.1.1.1.1.1.1.cmml">/</mo><mi id="S4.E6.m1.3.3.1.1.3.2.1.1.1.1.1.1.1.3" xref="S4.E6.m1.3.3.1.1.3.2.1.1.1.1.1.1.1.3.cmml">τ</mi></mrow><mo id="S4.E6.m1.3.3.1.1.3.2.1.1.1.1.1.1.3" stretchy="false" xref="S4.E6.m1.3.3.1.1.3.2.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E6.m1.3.3.1.1.3.2.1.1.3" maxsize="160%" minsize="160%" xref="S4.E6.m1.3.3.1.1.3.2.1.2.1.cmml">]</mo></mrow><mrow id="S4.E6.m1.3.3.1.1.3.2.3" xref="S4.E6.m1.3.3.1.1.3.2.3.cmml"><mo id="S4.E6.m1.3.3.1.1.3.2.3a" xref="S4.E6.m1.3.3.1.1.3.2.3.cmml">−</mo><mn id="S4.E6.m1.3.3.1.1.3.2.3.2" xref="S4.E6.m1.3.3.1.1.3.2.3.2.cmml">1</mn></mrow></msup></mrow></mrow><mo id="S4.E6.m1.3.3.1.2" xref="S4.E6.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E6.m1.3b"><apply id="S4.E6.m1.3.3.1.1.cmml" xref="S4.E6.m1.3.3.1"><eq id="S4.E6.m1.3.3.1.1.4.cmml" xref="S4.E6.m1.3.3.1.1.4"></eq><apply id="S4.E6.m1.3.3.1.1.1.cmml" xref="S4.E6.m1.3.3.1.1.1"><times id="S4.E6.m1.3.3.1.1.1.2.cmml" xref="S4.E6.m1.3.3.1.1.1.2"></times><apply id="S4.E6.m1.3.3.1.1.1.3.cmml" xref="S4.E6.m1.3.3.1.1.1.3"><csymbol cd="ambiguous" id="S4.E6.m1.3.3.1.1.1.3.1.cmml" xref="S4.E6.m1.3.3.1.1.1.3">subscript</csymbol><ci id="S4.E6.m1.3.3.1.1.1.3.2.cmml" xref="S4.E6.m1.3.3.1.1.1.3.2">𝑃</ci><apply id="S4.E6.m1.3.3.1.1.1.3.3.cmml" xref="S4.E6.m1.3.3.1.1.1.3.3"><plus id="S4.E6.m1.3.3.1.1.1.3.3.1.cmml" xref="S4.E6.m1.3.3.1.1.1.3.3.1"></plus><ci id="S4.E6.m1.3.3.1.1.1.3.3.2.cmml" xref="S4.E6.m1.3.3.1.1.1.3.3.2">𝑡</ci><cn id="S4.E6.m1.3.3.1.1.1.3.3.3.cmml" type="integer" xref="S4.E6.m1.3.3.1.1.1.3.3.3">1</cn></apply></apply><apply id="S4.E6.m1.3.3.1.1.1.1.1.1.cmml" xref="S4.E6.m1.3.3.1.1.1.1.1"><eq id="S4.E6.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S4.E6.m1.3.3.1.1.1.1.1.1.1"></eq><ci id="S4.E6.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S4.E6.m1.3.3.1.1.1.1.1.1.2">𝑌</ci><apply id="S4.E6.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S4.E6.m1.3.3.1.1.1.1.1.1.3"><csymbol cd="latexml" id="S4.E6.m1.3.3.1.1.1.1.1.1.3.1.cmml" xref="S4.E6.m1.3.3.1.1.1.1.1.1.3.1">conditional</csymbol><ci id="S4.E6.m1.3.3.1.1.1.1.1.1.3.2.cmml" xref="S4.E6.m1.3.3.1.1.1.1.1.1.3.2">𝑖</ci><ci id="S4.E6.m1.3.3.1.1.1.1.1.1.3.3.cmml" xref="S4.E6.m1.3.3.1.1.1.1.1.1.3.3">𝑆</ci></apply></apply></apply><apply id="S4.E6.m1.3.3.1.1.3.cmml" xref="S4.E6.m1.3.3.1.1.3"><times id="S4.E6.m1.3.3.1.1.3.3.cmml" xref="S4.E6.m1.3.3.1.1.3.3"></times><apply id="S4.E6.m1.3.3.1.1.2.1.2.cmml" xref="S4.E6.m1.3.3.1.1.2.1.1"><exp id="S4.E6.m1.1.1.cmml" xref="S4.E6.m1.1.1"></exp><apply id="S4.E6.m1.3.3.1.1.2.1.1.1.1.cmml" xref="S4.E6.m1.3.3.1.1.2.1.1.1.1"><divide id="S4.E6.m1.3.3.1.1.2.1.1.1.1.1.cmml" xref="S4.E6.m1.3.3.1.1.2.1.1.1.1.1"></divide><apply id="S4.E6.m1.3.3.1.1.2.1.1.1.1.2.cmml" xref="S4.E6.m1.3.3.1.1.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E6.m1.3.3.1.1.2.1.1.1.1.2.1.cmml" xref="S4.E6.m1.3.3.1.1.2.1.1.1.1.2">subscript</csymbol><ci id="S4.E6.m1.3.3.1.1.2.1.1.1.1.2.2.cmml" xref="S4.E6.m1.3.3.1.1.2.1.1.1.1.2.2">𝑆</ci><ci id="S4.E6.m1.3.3.1.1.2.1.1.1.1.2.3.cmml" xref="S4.E6.m1.3.3.1.1.2.1.1.1.1.2.3">𝑖</ci></apply><ci id="S4.E6.m1.3.3.1.1.2.1.1.1.1.3.cmml" xref="S4.E6.m1.3.3.1.1.2.1.1.1.1.3">𝜏</ci></apply></apply><apply id="S4.E6.m1.3.3.1.1.3.2.cmml" xref="S4.E6.m1.3.3.1.1.3.2"><csymbol cd="ambiguous" id="S4.E6.m1.3.3.1.1.3.2.2.cmml" xref="S4.E6.m1.3.3.1.1.3.2">superscript</csymbol><apply id="S4.E6.m1.3.3.1.1.3.2.1.2.cmml" xref="S4.E6.m1.3.3.1.1.3.2.1.1"><csymbol cd="latexml" id="S4.E6.m1.3.3.1.1.3.2.1.2.1.cmml" xref="S4.E6.m1.3.3.1.1.3.2.1.1.2">delimited-[]</csymbol><apply id="S4.E6.m1.3.3.1.1.3.2.1.1.1.cmml" xref="S4.E6.m1.3.3.1.1.3.2.1.1.1"><apply id="S4.E6.m1.3.3.1.1.3.2.1.1.1.2.cmml" xref="S4.E6.m1.3.3.1.1.3.2.1.1.1.2"><csymbol cd="ambiguous" id="S4.E6.m1.3.3.1.1.3.2.1.1.1.2.1.cmml" xref="S4.E6.m1.3.3.1.1.3.2.1.1.1.2">superscript</csymbol><apply id="S4.E6.m1.3.3.1.1.3.2.1.1.1.2.2.cmml" xref="S4.E6.m1.3.3.1.1.3.2.1.1.1.2"><csymbol cd="ambiguous" id="S4.E6.m1.3.3.1.1.3.2.1.1.1.2.2.1.cmml" xref="S4.E6.m1.3.3.1.1.3.2.1.1.1.2">subscript</csymbol><sum id="S4.E6.m1.3.3.1.1.3.2.1.1.1.2.2.2.cmml" xref="S4.E6.m1.3.3.1.1.3.2.1.1.1.2.2.2"></sum><apply id="S4.E6.m1.3.3.1.1.3.2.1.1.1.2.2.3.cmml" xref="S4.E6.m1.3.3.1.1.3.2.1.1.1.2.2.3"><eq id="S4.E6.m1.3.3.1.1.3.2.1.1.1.2.2.3.1.cmml" xref="S4.E6.m1.3.3.1.1.3.2.1.1.1.2.2.3.1"></eq><ci id="S4.E6.m1.3.3.1.1.3.2.1.1.1.2.2.3.2.cmml" xref="S4.E6.m1.3.3.1.1.3.2.1.1.1.2.2.3.2">𝑗</ci><cn id="S4.E6.m1.3.3.1.1.3.2.1.1.1.2.2.3.3.cmml" type="integer" xref="S4.E6.m1.3.3.1.1.3.2.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S4.E6.m1.3.3.1.1.3.2.1.1.1.2.3.cmml" xref="S4.E6.m1.3.3.1.1.3.2.1.1.1.2.3">𝐾</ci></apply><apply id="S4.E6.m1.3.3.1.1.3.2.1.1.1.1.2.cmml" xref="S4.E6.m1.3.3.1.1.3.2.1.1.1.1.1"><exp id="S4.E6.m1.2.2.cmml" xref="S4.E6.m1.2.2"></exp><apply id="S4.E6.m1.3.3.1.1.3.2.1.1.1.1.1.1.1.cmml" xref="S4.E6.m1.3.3.1.1.3.2.1.1.1.1.1.1.1"><divide id="S4.E6.m1.3.3.1.1.3.2.1.1.1.1.1.1.1.1.cmml" xref="S4.E6.m1.3.3.1.1.3.2.1.1.1.1.1.1.1.1"></divide><apply id="S4.E6.m1.3.3.1.1.3.2.1.1.1.1.1.1.1.2.cmml" xref="S4.E6.m1.3.3.1.1.3.2.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E6.m1.3.3.1.1.3.2.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E6.m1.3.3.1.1.3.2.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S4.E6.m1.3.3.1.1.3.2.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E6.m1.3.3.1.1.3.2.1.1.1.1.1.1.1.2.2">𝑆</ci><ci id="S4.E6.m1.3.3.1.1.3.2.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E6.m1.3.3.1.1.3.2.1.1.1.1.1.1.1.2.3">𝑗</ci></apply><ci id="S4.E6.m1.3.3.1.1.3.2.1.1.1.1.1.1.1.3.cmml" xref="S4.E6.m1.3.3.1.1.3.2.1.1.1.1.1.1.1.3">𝜏</ci></apply></apply></apply></apply><apply id="S4.E6.m1.3.3.1.1.3.2.3.cmml" xref="S4.E6.m1.3.3.1.1.3.2.3"><minus id="S4.E6.m1.3.3.1.1.3.2.3.1.cmml" xref="S4.E6.m1.3.3.1.1.3.2.3"></minus><cn id="S4.E6.m1.3.3.1.1.3.2.3.2.cmml" type="integer" xref="S4.E6.m1.3.3.1.1.3.2.3.2">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E6.m1.3c">\displaystyle P_{t+1}(Y=i|S)=\exp(S_{i}/\tau)\Big{[}\sum_{j=1}^{K}\exp(S_{j}/%
\tau)\Big{]}^{-1},</annotation><annotation encoding="application/x-llamapun" id="S4.E6.m1.3d">italic_P start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT ( italic_Y = italic_i | italic_S ) = roman_exp ( italic_S start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT / italic_τ ) [ ∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT roman_exp ( italic_S start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT / italic_τ ) ] start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS1.p2.7">where <math alttext="\tau\neq 0" class="ltx_Math" display="inline" id="S4.SS1.p2.3.m1.1"><semantics id="S4.SS1.p2.3.m1.1a"><mrow id="S4.SS1.p2.3.m1.1.1" xref="S4.SS1.p2.3.m1.1.1.cmml"><mi id="S4.SS1.p2.3.m1.1.1.2" xref="S4.SS1.p2.3.m1.1.1.2.cmml">τ</mi><mo id="S4.SS1.p2.3.m1.1.1.1" xref="S4.SS1.p2.3.m1.1.1.1.cmml">≠</mo><mn id="S4.SS1.p2.3.m1.1.1.3" xref="S4.SS1.p2.3.m1.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.3.m1.1b"><apply id="S4.SS1.p2.3.m1.1.1.cmml" xref="S4.SS1.p2.3.m1.1.1"><neq id="S4.SS1.p2.3.m1.1.1.1.cmml" xref="S4.SS1.p2.3.m1.1.1.1"></neq><ci id="S4.SS1.p2.3.m1.1.1.2.cmml" xref="S4.SS1.p2.3.m1.1.1.2">𝜏</ci><cn id="S4.SS1.p2.3.m1.1.1.3.cmml" type="integer" xref="S4.SS1.p2.3.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.3.m1.1c">\tau\neq 0</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.3.m1.1d">italic_τ ≠ 0</annotation></semantics></math> parameterizes the shift and <math alttext="\text{Acc}[i]" class="ltx_Math" display="inline" id="S4.SS1.p2.4.m2.1"><semantics id="S4.SS1.p2.4.m2.1a"><mrow id="S4.SS1.p2.4.m2.1.2" xref="S4.SS1.p2.4.m2.1.2.cmml"><mtext id="S4.SS1.p2.4.m2.1.2.2" xref="S4.SS1.p2.4.m2.1.2.2a.cmml">Acc</mtext><mo id="S4.SS1.p2.4.m2.1.2.1" xref="S4.SS1.p2.4.m2.1.2.1.cmml">⁢</mo><mrow id="S4.SS1.p2.4.m2.1.2.3.2" xref="S4.SS1.p2.4.m2.1.2.3.1.cmml"><mo id="S4.SS1.p2.4.m2.1.2.3.2.1" stretchy="false" xref="S4.SS1.p2.4.m2.1.2.3.1.1.cmml">[</mo><mi id="S4.SS1.p2.4.m2.1.1" xref="S4.SS1.p2.4.m2.1.1.cmml">i</mi><mo id="S4.SS1.p2.4.m2.1.2.3.2.2" stretchy="false" xref="S4.SS1.p2.4.m2.1.2.3.1.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.4.m2.1b"><apply id="S4.SS1.p2.4.m2.1.2.cmml" xref="S4.SS1.p2.4.m2.1.2"><times id="S4.SS1.p2.4.m2.1.2.1.cmml" xref="S4.SS1.p2.4.m2.1.2.1"></times><ci id="S4.SS1.p2.4.m2.1.2.2a.cmml" xref="S4.SS1.p2.4.m2.1.2.2"><mtext id="S4.SS1.p2.4.m2.1.2.2.cmml" xref="S4.SS1.p2.4.m2.1.2.2">Acc</mtext></ci><apply id="S4.SS1.p2.4.m2.1.2.3.1.cmml" xref="S4.SS1.p2.4.m2.1.2.3.2"><csymbol cd="latexml" id="S4.SS1.p2.4.m2.1.2.3.1.1.cmml" xref="S4.SS1.p2.4.m2.1.2.3.2.1">delimited-[]</csymbol><ci id="S4.SS1.p2.4.m2.1.1.cmml" xref="S4.SS1.p2.4.m2.1.1">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.4.m2.1c">\text{Acc}[i]</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.4.m2.1d">Acc [ italic_i ]</annotation></semantics></math> represents the accuracy of class <math alttext="i" class="ltx_Math" display="inline" id="S4.SS1.p2.5.m3.1"><semantics id="S4.SS1.p2.5.m3.1a"><mi id="S4.SS1.p2.5.m3.1.1" xref="S4.SS1.p2.5.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.5.m3.1b"><ci id="S4.SS1.p2.5.m3.1.1.cmml" xref="S4.SS1.p2.5.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.5.m3.1c">i</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.5.m3.1d">italic_i</annotation></semantics></math>. The equation in (<a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#S4.E6" title="Equation 6 ‣ 4.1 Performative label shift ‣ 4 Experiments ‣ Adjusting Pretrained Backbones for Performativity"><span class="ltx_text ltx_ref_tag">6</span></a>) is a modeling choice for simulating the effect which is hidden to the algorithm.
For <math alttext="\tau&lt;0" class="ltx_Math" display="inline" id="S4.SS1.p2.6.m4.1"><semantics id="S4.SS1.p2.6.m4.1a"><mrow id="S4.SS1.p2.6.m4.1.1" xref="S4.SS1.p2.6.m4.1.1.cmml"><mi id="S4.SS1.p2.6.m4.1.1.2" xref="S4.SS1.p2.6.m4.1.1.2.cmml">τ</mi><mo id="S4.SS1.p2.6.m4.1.1.1" xref="S4.SS1.p2.6.m4.1.1.1.cmml">&lt;</mo><mn id="S4.SS1.p2.6.m4.1.1.3" xref="S4.SS1.p2.6.m4.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.6.m4.1b"><apply id="S4.SS1.p2.6.m4.1.1.cmml" xref="S4.SS1.p2.6.m4.1.1"><lt id="S4.SS1.p2.6.m4.1.1.1.cmml" xref="S4.SS1.p2.6.m4.1.1.1"></lt><ci id="S4.SS1.p2.6.m4.1.1.2.cmml" xref="S4.SS1.p2.6.m4.1.1.2">𝜏</ci><cn id="S4.SS1.p2.6.m4.1.1.3.cmml" type="integer" xref="S4.SS1.p2.6.m4.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.6.m4.1c">\tau&lt;0</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.6.m4.1d">italic_τ &lt; 0</annotation></semantics></math> it emulates the adversarial setting where classes that achieve high accuracy in the past round will diminish in the next round, and vice versa. In contrast, for <math alttext="\tau&gt;0" class="ltx_Math" display="inline" id="S4.SS1.p2.7.m5.1"><semantics id="S4.SS1.p2.7.m5.1a"><mrow id="S4.SS1.p2.7.m5.1.1" xref="S4.SS1.p2.7.m5.1.1.cmml"><mi id="S4.SS1.p2.7.m5.1.1.2" xref="S4.SS1.p2.7.m5.1.1.2.cmml">τ</mi><mo id="S4.SS1.p2.7.m5.1.1.1" xref="S4.SS1.p2.7.m5.1.1.1.cmml">&gt;</mo><mn id="S4.SS1.p2.7.m5.1.1.3" xref="S4.SS1.p2.7.m5.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.7.m5.1b"><apply id="S4.SS1.p2.7.m5.1.1.cmml" xref="S4.SS1.p2.7.m5.1.1"><gt id="S4.SS1.p2.7.m5.1.1.1.cmml" xref="S4.SS1.p2.7.m5.1.1.1"></gt><ci id="S4.SS1.p2.7.m5.1.1.2.cmml" xref="S4.SS1.p2.7.m5.1.1.2">𝜏</ci><cn id="S4.SS1.p2.7.m5.1.1.3.cmml" type="integer" xref="S4.SS1.p2.7.m5.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.7.m5.1c">\tau&gt;0</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.7.m5.1d">italic_τ &gt; 0</annotation></semantics></math> classes with higher accuracy would be stronger represented in the next round, accumulating mass in small regions of the input space, making the task trivial.</p>
</div>
<section class="ltx_paragraph" id="S4.SS1.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">Strength of performativity.</h4>
<div class="ltx_para" id="S4.SS1.SSS0.Px1.p1">
<p class="ltx_p" id="S4.SS1.SSS0.Px1.p1.6">We use the parameter <math alttext="\tau" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px1.p1.1.m1.1"><semantics id="S4.SS1.SSS0.Px1.p1.1.m1.1a"><mi id="S4.SS1.SSS0.Px1.p1.1.m1.1.1" xref="S4.SS1.SSS0.Px1.p1.1.m1.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p1.1.m1.1b"><ci id="S4.SS1.SSS0.Px1.p1.1.m1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.1.m1.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p1.1.m1.1c">\tau</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px1.p1.1.m1.1d">italic_τ</annotation></semantics></math> to simulate different strengths of performativity.
We selected three different values for <math alttext="\tau" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px1.p1.2.m2.1"><semantics id="S4.SS1.SSS0.Px1.p1.2.m2.1a"><mi id="S4.SS1.SSS0.Px1.p1.2.m2.1.1" xref="S4.SS1.SSS0.Px1.p1.2.m2.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p1.2.m2.1b"><ci id="S4.SS1.SSS0.Px1.p1.2.m2.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.2.m2.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p1.2.m2.1c">\tau</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px1.p1.2.m2.1d">italic_τ</annotation></semantics></math>, chosen to induce absolute accuracy drops of <math alttext="2\%" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px1.p1.3.m3.1"><semantics id="S4.SS1.SSS0.Px1.p1.3.m3.1a"><mrow id="S4.SS1.SSS0.Px1.p1.3.m3.1.1" xref="S4.SS1.SSS0.Px1.p1.3.m3.1.1.cmml"><mn id="S4.SS1.SSS0.Px1.p1.3.m3.1.1.2" xref="S4.SS1.SSS0.Px1.p1.3.m3.1.1.2.cmml">2</mn><mo id="S4.SS1.SSS0.Px1.p1.3.m3.1.1.1" xref="S4.SS1.SSS0.Px1.p1.3.m3.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p1.3.m3.1b"><apply id="S4.SS1.SSS0.Px1.p1.3.m3.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.3.m3.1.1"><csymbol cd="latexml" id="S4.SS1.SSS0.Px1.p1.3.m3.1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.3.m3.1.1.1">percent</csymbol><cn id="S4.SS1.SSS0.Px1.p1.3.m3.1.1.2.cmml" type="integer" xref="S4.SS1.SSS0.Px1.p1.3.m3.1.1.2">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p1.3.m3.1c">2\%</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px1.p1.3.m3.1d">2 %</annotation></semantics></math>, <math alttext="5\%" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px1.p1.4.m4.1"><semantics id="S4.SS1.SSS0.Px1.p1.4.m4.1a"><mrow id="S4.SS1.SSS0.Px1.p1.4.m4.1.1" xref="S4.SS1.SSS0.Px1.p1.4.m4.1.1.cmml"><mn id="S4.SS1.SSS0.Px1.p1.4.m4.1.1.2" xref="S4.SS1.SSS0.Px1.p1.4.m4.1.1.2.cmml">5</mn><mo id="S4.SS1.SSS0.Px1.p1.4.m4.1.1.1" xref="S4.SS1.SSS0.Px1.p1.4.m4.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p1.4.m4.1b"><apply id="S4.SS1.SSS0.Px1.p1.4.m4.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.4.m4.1.1"><csymbol cd="latexml" id="S4.SS1.SSS0.Px1.p1.4.m4.1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.4.m4.1.1.1">percent</csymbol><cn id="S4.SS1.SSS0.Px1.p1.4.m4.1.1.2.cmml" type="integer" xref="S4.SS1.SSS0.Px1.p1.4.m4.1.1.2">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p1.4.m4.1c">5\%</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px1.p1.4.m4.1d">5 %</annotation></semantics></math>, and <math alttext="10\%" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px1.p1.5.m5.1"><semantics id="S4.SS1.SSS0.Px1.p1.5.m5.1a"><mrow id="S4.SS1.SSS0.Px1.p1.5.m5.1.1" xref="S4.SS1.SSS0.Px1.p1.5.m5.1.1.cmml"><mn id="S4.SS1.SSS0.Px1.p1.5.m5.1.1.2" xref="S4.SS1.SSS0.Px1.p1.5.m5.1.1.2.cmml">10</mn><mo id="S4.SS1.SSS0.Px1.p1.5.m5.1.1.1" xref="S4.SS1.SSS0.Px1.p1.5.m5.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p1.5.m5.1b"><apply id="S4.SS1.SSS0.Px1.p1.5.m5.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.5.m5.1.1"><csymbol cd="latexml" id="S4.SS1.SSS0.Px1.p1.5.m5.1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.5.m5.1.1.1">percent</csymbol><cn id="S4.SS1.SSS0.Px1.p1.5.m5.1.1.2.cmml" type="integer" xref="S4.SS1.SSS0.Px1.p1.5.m5.1.1.2">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p1.5.m5.1c">10\%</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px1.p1.5.m5.1d">10 %</annotation></semantics></math> after observing a balanced distribution for each model and freeze <math alttext="\tau" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px1.p1.6.m6.1"><semantics id="S4.SS1.SSS0.Px1.p1.6.m6.1a"><mi id="S4.SS1.SSS0.Px1.p1.6.m6.1.1" xref="S4.SS1.SSS0.Px1.p1.6.m6.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p1.6.m6.1b"><ci id="S4.SS1.SSS0.Px1.p1.6.m6.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.6.m6.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p1.6.m6.1c">\tau</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px1.p1.6.m6.1d">italic_τ</annotation></semantics></math> thereof. We refer to these as the low, moderate, and high shift scenarios, respectively.</p>
</div>
</section>
<section class="ltx_paragraph" id="S4.SS1.SSS0.Px2">
<h4 class="ltx_title ltx_title_paragraph">Evaluation metric.</h4>
<div class="ltx_para" id="S4.SS1.SSS0.Px2.p1">
<p class="ltx_p" id="S4.SS1.SSS0.Px2.p1.3">We simulate each model’s retraining trajectory for <math alttext="200" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px2.p1.1.m1.1"><semantics id="S4.SS1.SSS0.Px2.p1.1.m1.1a"><mn id="S4.SS1.SSS0.Px2.p1.1.m1.1.1" xref="S4.SS1.SSS0.Px2.p1.1.m1.1.1.cmml">200</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px2.p1.1.m1.1b"><cn id="S4.SS1.SSS0.Px2.p1.1.m1.1.1.cmml" type="integer" xref="S4.SS1.SSS0.Px2.p1.1.m1.1.1">200</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px2.p1.1.m1.1c">200</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px2.p1.1.m1.1d">200</annotation></semantics></math> steps and we repeatedly evaluate the accuracy after deployment, denoted as <math alttext="\mathrm{Acc}_{t}=\text{Acc}(f_{t},P_{t+1})" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px2.p1.2.m2.2"><semantics id="S4.SS1.SSS0.Px2.p1.2.m2.2a"><mrow id="S4.SS1.SSS0.Px2.p1.2.m2.2.2" xref="S4.SS1.SSS0.Px2.p1.2.m2.2.2.cmml"><msub id="S4.SS1.SSS0.Px2.p1.2.m2.2.2.4" xref="S4.SS1.SSS0.Px2.p1.2.m2.2.2.4.cmml"><mi id="S4.SS1.SSS0.Px2.p1.2.m2.2.2.4.2" xref="S4.SS1.SSS0.Px2.p1.2.m2.2.2.4.2.cmml">Acc</mi><mi id="S4.SS1.SSS0.Px2.p1.2.m2.2.2.4.3" xref="S4.SS1.SSS0.Px2.p1.2.m2.2.2.4.3.cmml">t</mi></msub><mo id="S4.SS1.SSS0.Px2.p1.2.m2.2.2.3" xref="S4.SS1.SSS0.Px2.p1.2.m2.2.2.3.cmml">=</mo><mrow id="S4.SS1.SSS0.Px2.p1.2.m2.2.2.2" xref="S4.SS1.SSS0.Px2.p1.2.m2.2.2.2.cmml"><mtext id="S4.SS1.SSS0.Px2.p1.2.m2.2.2.2.4" xref="S4.SS1.SSS0.Px2.p1.2.m2.2.2.2.4a.cmml">Acc</mtext><mo id="S4.SS1.SSS0.Px2.p1.2.m2.2.2.2.3" xref="S4.SS1.SSS0.Px2.p1.2.m2.2.2.2.3.cmml">⁢</mo><mrow id="S4.SS1.SSS0.Px2.p1.2.m2.2.2.2.2.2" xref="S4.SS1.SSS0.Px2.p1.2.m2.2.2.2.2.3.cmml"><mo id="S4.SS1.SSS0.Px2.p1.2.m2.2.2.2.2.2.3" stretchy="false" xref="S4.SS1.SSS0.Px2.p1.2.m2.2.2.2.2.3.cmml">(</mo><msub id="S4.SS1.SSS0.Px2.p1.2.m2.1.1.1.1.1.1" xref="S4.SS1.SSS0.Px2.p1.2.m2.1.1.1.1.1.1.cmml"><mi id="S4.SS1.SSS0.Px2.p1.2.m2.1.1.1.1.1.1.2" xref="S4.SS1.SSS0.Px2.p1.2.m2.1.1.1.1.1.1.2.cmml">f</mi><mi id="S4.SS1.SSS0.Px2.p1.2.m2.1.1.1.1.1.1.3" xref="S4.SS1.SSS0.Px2.p1.2.m2.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S4.SS1.SSS0.Px2.p1.2.m2.2.2.2.2.2.4" xref="S4.SS1.SSS0.Px2.p1.2.m2.2.2.2.2.3.cmml">,</mo><msub id="S4.SS1.SSS0.Px2.p1.2.m2.2.2.2.2.2.2" xref="S4.SS1.SSS0.Px2.p1.2.m2.2.2.2.2.2.2.cmml"><mi id="S4.SS1.SSS0.Px2.p1.2.m2.2.2.2.2.2.2.2" xref="S4.SS1.SSS0.Px2.p1.2.m2.2.2.2.2.2.2.2.cmml">P</mi><mrow id="S4.SS1.SSS0.Px2.p1.2.m2.2.2.2.2.2.2.3" xref="S4.SS1.SSS0.Px2.p1.2.m2.2.2.2.2.2.2.3.cmml"><mi id="S4.SS1.SSS0.Px2.p1.2.m2.2.2.2.2.2.2.3.2" xref="S4.SS1.SSS0.Px2.p1.2.m2.2.2.2.2.2.2.3.2.cmml">t</mi><mo id="S4.SS1.SSS0.Px2.p1.2.m2.2.2.2.2.2.2.3.1" xref="S4.SS1.SSS0.Px2.p1.2.m2.2.2.2.2.2.2.3.1.cmml">+</mo><mn id="S4.SS1.SSS0.Px2.p1.2.m2.2.2.2.2.2.2.3.3" xref="S4.SS1.SSS0.Px2.p1.2.m2.2.2.2.2.2.2.3.3.cmml">1</mn></mrow></msub><mo id="S4.SS1.SSS0.Px2.p1.2.m2.2.2.2.2.2.5" stretchy="false" xref="S4.SS1.SSS0.Px2.p1.2.m2.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px2.p1.2.m2.2b"><apply id="S4.SS1.SSS0.Px2.p1.2.m2.2.2.cmml" xref="S4.SS1.SSS0.Px2.p1.2.m2.2.2"><eq id="S4.SS1.SSS0.Px2.p1.2.m2.2.2.3.cmml" xref="S4.SS1.SSS0.Px2.p1.2.m2.2.2.3"></eq><apply id="S4.SS1.SSS0.Px2.p1.2.m2.2.2.4.cmml" xref="S4.SS1.SSS0.Px2.p1.2.m2.2.2.4"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px2.p1.2.m2.2.2.4.1.cmml" xref="S4.SS1.SSS0.Px2.p1.2.m2.2.2.4">subscript</csymbol><ci id="S4.SS1.SSS0.Px2.p1.2.m2.2.2.4.2.cmml" xref="S4.SS1.SSS0.Px2.p1.2.m2.2.2.4.2">Acc</ci><ci id="S4.SS1.SSS0.Px2.p1.2.m2.2.2.4.3.cmml" xref="S4.SS1.SSS0.Px2.p1.2.m2.2.2.4.3">𝑡</ci></apply><apply id="S4.SS1.SSS0.Px2.p1.2.m2.2.2.2.cmml" xref="S4.SS1.SSS0.Px2.p1.2.m2.2.2.2"><times id="S4.SS1.SSS0.Px2.p1.2.m2.2.2.2.3.cmml" xref="S4.SS1.SSS0.Px2.p1.2.m2.2.2.2.3"></times><ci id="S4.SS1.SSS0.Px2.p1.2.m2.2.2.2.4a.cmml" xref="S4.SS1.SSS0.Px2.p1.2.m2.2.2.2.4"><mtext id="S4.SS1.SSS0.Px2.p1.2.m2.2.2.2.4.cmml" xref="S4.SS1.SSS0.Px2.p1.2.m2.2.2.2.4">Acc</mtext></ci><interval closure="open" id="S4.SS1.SSS0.Px2.p1.2.m2.2.2.2.2.3.cmml" xref="S4.SS1.SSS0.Px2.p1.2.m2.2.2.2.2.2"><apply id="S4.SS1.SSS0.Px2.p1.2.m2.1.1.1.1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.2.m2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px2.p1.2.m2.1.1.1.1.1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.2.m2.1.1.1.1.1.1">subscript</csymbol><ci id="S4.SS1.SSS0.Px2.p1.2.m2.1.1.1.1.1.1.2.cmml" xref="S4.SS1.SSS0.Px2.p1.2.m2.1.1.1.1.1.1.2">𝑓</ci><ci id="S4.SS1.SSS0.Px2.p1.2.m2.1.1.1.1.1.1.3.cmml" xref="S4.SS1.SSS0.Px2.p1.2.m2.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="S4.SS1.SSS0.Px2.p1.2.m2.2.2.2.2.2.2.cmml" xref="S4.SS1.SSS0.Px2.p1.2.m2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px2.p1.2.m2.2.2.2.2.2.2.1.cmml" xref="S4.SS1.SSS0.Px2.p1.2.m2.2.2.2.2.2.2">subscript</csymbol><ci id="S4.SS1.SSS0.Px2.p1.2.m2.2.2.2.2.2.2.2.cmml" xref="S4.SS1.SSS0.Px2.p1.2.m2.2.2.2.2.2.2.2">𝑃</ci><apply id="S4.SS1.SSS0.Px2.p1.2.m2.2.2.2.2.2.2.3.cmml" xref="S4.SS1.SSS0.Px2.p1.2.m2.2.2.2.2.2.2.3"><plus id="S4.SS1.SSS0.Px2.p1.2.m2.2.2.2.2.2.2.3.1.cmml" xref="S4.SS1.SSS0.Px2.p1.2.m2.2.2.2.2.2.2.3.1"></plus><ci id="S4.SS1.SSS0.Px2.p1.2.m2.2.2.2.2.2.2.3.2.cmml" xref="S4.SS1.SSS0.Px2.p1.2.m2.2.2.2.2.2.2.3.2">𝑡</ci><cn id="S4.SS1.SSS0.Px2.p1.2.m2.2.2.2.2.2.2.3.3.cmml" type="integer" xref="S4.SS1.SSS0.Px2.p1.2.m2.2.2.2.2.2.2.3.3">1</cn></apply></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px2.p1.2.m2.2c">\mathrm{Acc}_{t}=\text{Acc}(f_{t},P_{t+1})</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px2.p1.2.m2.2d">roman_Acc start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = Acc ( italic_f start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_P start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT )</annotation></semantics></math>. Note that this implies that all models encounter different distributions after the first round. For reference we evaluate all models on the initial balanced distribution at <math alttext="t=0" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px2.p1.3.m3.1"><semantics id="S4.SS1.SSS0.Px2.p1.3.m3.1a"><mrow id="S4.SS1.SSS0.Px2.p1.3.m3.1.1" xref="S4.SS1.SSS0.Px2.p1.3.m3.1.1.cmml"><mi id="S4.SS1.SSS0.Px2.p1.3.m3.1.1.2" xref="S4.SS1.SSS0.Px2.p1.3.m3.1.1.2.cmml">t</mi><mo id="S4.SS1.SSS0.Px2.p1.3.m3.1.1.1" xref="S4.SS1.SSS0.Px2.p1.3.m3.1.1.1.cmml">=</mo><mn id="S4.SS1.SSS0.Px2.p1.3.m3.1.1.3" xref="S4.SS1.SSS0.Px2.p1.3.m3.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px2.p1.3.m3.1b"><apply id="S4.SS1.SSS0.Px2.p1.3.m3.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.3.m3.1.1"><eq id="S4.SS1.SSS0.Px2.p1.3.m3.1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.3.m3.1.1.1"></eq><ci id="S4.SS1.SSS0.Px2.p1.3.m3.1.1.2.cmml" xref="S4.SS1.SSS0.Px2.p1.3.m3.1.1.2">𝑡</ci><cn id="S4.SS1.SSS0.Px2.p1.3.m3.1.1.3.cmml" type="integer" xref="S4.SS1.SSS0.Px2.p1.3.m3.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px2.p1.3.m3.1c">t=0</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px2.p1.3.m3.1d">italic_t = 0</annotation></semantics></math>. For each model, we compare the performance on the trajectory of distributions induced by the respective model to avoid bias toward any particular approach. In addition, we also analyze the utility of the reusable adapter module resulting from the <span class="ltx_text ltx_font_italic" id="S4.SS1.SSS0.Px2.p1.3.1">PaP</span> procedure.</p>
</div>
<figure class="ltx_figure" id="S4.F2">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S4.F2.16" style="width:216.8pt;"><span class="ltx_text ltx_font_bold" id="S4.F2.16.1">CIFAR100</span></p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S4.F2.17" style="width:216.8pt;"><span class="ltx_text ltx_font_bold" id="S4.F2.17.1">ImageNet100</span></p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S4.F2.1" style="width:208.1pt;">
<img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="294" id="S4.F2.1.g1" src="extracted/5905190/figures/vision/accuracy_over_time/accuracy_over_time_CIFAR100_0.1.png" width="479"/>
<div class="ltx_inline-block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle ltx_transformed_outer" id="S4.F2.1.1" style="width:8.7pt;height:45pt;vertical-align:-20.0pt;"><span class="ltx_transformed_inner" style="width:45.0pt;transform:translate(-18.06pt,2.92pt) rotate(-90deg) ;">
<p class="ltx_p" id="S4.F2.1.1.1"><span class="ltx_text ltx_font_bold" id="S4.F2.1.1.1.1">High Shift</span></p>
</span></div>
</div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S4.F2.2" style="width:208.1pt;">
<img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="287" id="S4.F2.2.g1" src="extracted/5905190/figures/vision/accuracy_over_time/accuracy_over_time_ImageNet100_0.1.png" width="479"/>
<div class="ltx_inline-block ltx_minipage ltx_align_center ltx_align_middle ltx_transformed_outer" id="S4.F2.2.1" style="width:8.7pt;height:65.9pt;vertical-align:-29.5pt;"><span class="ltx_transformed_inner" style="width:65.9pt;transform:translate(-29.46pt,0pt) rotate(-90deg) ;">
<p class="ltx_p" id="S4.F2.2.1.1"><span class="ltx_text ltx_font_bold" id="S4.F2.2.1.1.1">Moderate Shift</span></p>
</span></div>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S4.F2.3" style="width:208.1pt;">
<img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="283" id="S4.F2.3.g1" src="extracted/5905190/figures/vision/accuracy_over_time/accuracy_over_time_CIFAR100_0.3.png" width="479"/>
</div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S4.F2.4" style="width:208.1pt;">
<img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="272" id="S4.F2.4.g1" src="extracted/5905190/figures/vision/accuracy_over_time/accuracy_over_time_ImageNet100_0.3.png" width="479"/>
<div class="ltx_inline-block ltx_minipage ltx_align_center ltx_align_middle ltx_transformed_outer" id="S4.F2.4.1" style="width:8.7pt;height:42.4pt;vertical-align:-17.7pt;"><span class="ltx_transformed_inner" style="width:42.4pt;transform:translate(-17.71pt,0pt) rotate(-90deg) ;">
<p class="ltx_p" id="S4.F2.4.1.1"><span class="ltx_text ltx_font_bold" id="S4.F2.4.1.1.1">Low Shift</span></p>
</span></div>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S4.F2.5" style="width:208.1pt;">
<img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="294" id="S4.F2.5.g1" src="extracted/5905190/figures/vision/accuracy_over_time/accuracy_over_time_CIFAR100_0.5.png" width="479"/>
</div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S4.F2.6" style="width:208.1pt;">
<img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="285" id="S4.F2.6.g1" src="extracted/5905190/figures/vision/accuracy_over_time/accuracy_over_time_ImageNet100_0.6.png" width="479"/>
</div>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F2.20.5.1" style="font-size:90%;">Figure 2</span>: </span><em class="ltx_emph ltx_font_italic" id="S4.F2.21.6" style="font-size:90%;">Accuracy along retraining trajectory for vision tasks</em><span class="ltx_text" id="S4.F2.14.4" style="font-size:90%;">. Each method starts from the same pretrained model, evaluated on the balanced dataset at <math alttext="t=0" class="ltx_Math" display="inline" id="S4.F2.11.1.m1.1"><semantics id="S4.F2.11.1.m1.1b"><mrow id="S4.F2.11.1.m1.1.1" xref="S4.F2.11.1.m1.1.1.cmml"><mi id="S4.F2.11.1.m1.1.1.2" xref="S4.F2.11.1.m1.1.1.2.cmml">t</mi><mo id="S4.F2.11.1.m1.1.1.1" xref="S4.F2.11.1.m1.1.1.1.cmml">=</mo><mn id="S4.F2.11.1.m1.1.1.3" xref="S4.F2.11.1.m1.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.F2.11.1.m1.1c"><apply id="S4.F2.11.1.m1.1.1.cmml" xref="S4.F2.11.1.m1.1.1"><eq id="S4.F2.11.1.m1.1.1.1.cmml" xref="S4.F2.11.1.m1.1.1.1"></eq><ci id="S4.F2.11.1.m1.1.1.2.cmml" xref="S4.F2.11.1.m1.1.1.2">𝑡</ci><cn id="S4.F2.11.1.m1.1.1.3.cmml" type="integer" xref="S4.F2.11.1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F2.11.1.m1.1d">t=0</annotation><annotation encoding="application/x-llamapun" id="S4.F2.11.1.m1.1e">italic_t = 0</annotation></semantics></math>. Starting from <math alttext="t=1" class="ltx_Math" display="inline" id="S4.F2.12.2.m2.1"><semantics id="S4.F2.12.2.m2.1b"><mrow id="S4.F2.12.2.m2.1.1" xref="S4.F2.12.2.m2.1.1.cmml"><mi id="S4.F2.12.2.m2.1.1.2" xref="S4.F2.12.2.m2.1.1.2.cmml">t</mi><mo id="S4.F2.12.2.m2.1.1.1" xref="S4.F2.12.2.m2.1.1.1.cmml">=</mo><mn id="S4.F2.12.2.m2.1.1.3" xref="S4.F2.12.2.m2.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.F2.12.2.m2.1c"><apply id="S4.F2.12.2.m2.1.1.cmml" xref="S4.F2.12.2.m2.1.1"><eq id="S4.F2.12.2.m2.1.1.1.cmml" xref="S4.F2.12.2.m2.1.1.1"></eq><ci id="S4.F2.12.2.m2.1.1.2.cmml" xref="S4.F2.12.2.m2.1.1.2">𝑡</ci><cn id="S4.F2.12.2.m2.1.1.3.cmml" type="integer" xref="S4.F2.12.2.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F2.12.2.m2.1d">t=1</annotation><annotation encoding="application/x-llamapun" id="S4.F2.12.2.m2.1e">italic_t = 1</annotation></semantics></math>, we simulate <math alttext="200" class="ltx_Math" display="inline" id="S4.F2.13.3.m3.1"><semantics id="S4.F2.13.3.m3.1b"><mn id="S4.F2.13.3.m3.1.1" xref="S4.F2.13.3.m3.1.1.cmml">200</mn><annotation-xml encoding="MathML-Content" id="S4.F2.13.3.m3.1c"><cn id="S4.F2.13.3.m3.1.1.cmml" type="integer" xref="S4.F2.13.3.m3.1.1">200</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.F2.13.3.m3.1d">200</annotation><annotation encoding="application/x-llamapun" id="S4.F2.13.3.m3.1e">200</annotation></semantics></math> rounds of deployments with performative shift of varying strength. The <span class="ltx_text ltx_font_italic" id="S4.F2.14.4.1">Performative-aware Predictor (PaP)</span> performs well even under the high shift scenario, approaching Bayes-optimal update performance as it is trained over rounds. The inset plot zooms in on the performance up to the first checkpoint. As it learns the structure, it typically adapts to the shift within the first <math alttext="10" class="ltx_Math" display="inline" id="S4.F2.14.4.m4.1"><semantics id="S4.F2.14.4.m4.1b"><mn id="S4.F2.14.4.m4.1.1" xref="S4.F2.14.4.m4.1.1.cmml">10</mn><annotation-xml encoding="MathML-Content" id="S4.F2.14.4.m4.1c"><cn id="S4.F2.14.4.m4.1.1.cmml" type="integer" xref="S4.F2.14.4.m4.1.1">10</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.F2.14.4.m4.1d">10</annotation><annotation encoding="application/x-llamapun" id="S4.F2.14.4.m4.1e">10</annotation></semantics></math> updates.</span></figcaption>
</figure>
</section>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Empirical findings</h3>
<div class="ltx_para" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.1">We conduct experiments with performative label shift, as instantiated above, with varying parameters, applied to data of different modalities.</p>
</div>
<section class="ltx_paragraph" id="S4.SS2.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">Retraining trajectory.</h4>
<div class="ltx_para" id="S4.SS2.SSS0.Px1.p1">
<p class="ltx_p" id="S4.SS2.SSS0.Px1.p1.4">Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#S4.F2" title="Figure 2 ‣ Evaluation metric. ‣ 4.1 Performative label shift ‣ 4 Experiments ‣ Adjusting Pretrained Backbones for Performativity"><span class="ltx_text ltx_ref_tag">2</span></a> shows the experiments conducted on ImageNet100 and CIFAR100 datasets. We observe that our adapter module (<span class="ltx_text ltx_font_italic" id="S4.SS2.SSS0.Px1.p1.4.1">PaP</span>) demonstrates comparable performance to <span class="ltx_text ltx_font_italic" id="S4.SS2.SSS0.Px1.p1.4.2">Oracle Fine-tuning</span> even in the low shift scenario, yet without the more resource-intensive demands in terms of time and compute.
High shift scenarios reveal the sensitivity of fine-tuning strategy even when it has complete information about the samples collected throughout rounds. Adopting fine-tuning makes the model lean heavily towards the previous round’s class marginals, making the model vulnerable to the upcoming distribution shift. Instead, <span class="ltx_text ltx_font_italic" id="S4.SS2.SSS0.Px1.p1.4.3">PaP</span> leverages the causal relationship between performance and subsequent distribution, relying solely on the label marginals from previous rounds to model this relationship. In Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#S4.F5" title="Figure 5 ‣ Beyond label shift. ‣ 4.2 Empirical findings ‣ 4 Experiments ‣ Adjusting Pretrained Backbones for Performativity"><span class="ltx_text ltx_ref_tag">5</span></a> we show the average accuracy improvement of different approaches over <span class="ltx_text ltx_font_italic" id="S4.SS2.SSS0.Px1.p1.4.4">No Adaptation</span>. We see significant average accuracy improvements of <math alttext="3.31\%" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px1.p1.1.m1.1"><semantics id="S4.SS2.SSS0.Px1.p1.1.m1.1a"><mrow id="S4.SS2.SSS0.Px1.p1.1.m1.1.1" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.cmml"><mn id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.cmml">3.31</mn><mo id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.1" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p1.1.m1.1b"><apply id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1"><csymbol cd="latexml" id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.1">percent</csymbol><cn id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.cmml" type="float" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2">3.31</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p1.1.m1.1c">3.31\%</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px1.p1.1.m1.1d">3.31 %</annotation></semantics></math> and <math alttext="4.25\%" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px1.p1.2.m2.1"><semantics id="S4.SS2.SSS0.Px1.p1.2.m2.1a"><mrow id="S4.SS2.SSS0.Px1.p1.2.m2.1.1" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.1.cmml"><mn id="S4.SS2.SSS0.Px1.p1.2.m2.1.1.2" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.1.2.cmml">4.25</mn><mo id="S4.SS2.SSS0.Px1.p1.2.m2.1.1.1" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p1.2.m2.1b"><apply id="S4.SS2.SSS0.Px1.p1.2.m2.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.1"><csymbol cd="latexml" id="S4.SS2.SSS0.Px1.p1.2.m2.1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.1.1">percent</csymbol><cn id="S4.SS2.SSS0.Px1.p1.2.m2.1.1.2.cmml" type="float" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.1.2">4.25</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p1.2.m2.1c">4.25\%</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px1.p1.2.m2.1d">4.25 %</annotation></semantics></math> for <span class="ltx_text ltx_font_italic" id="S4.SS2.SSS0.Px1.p1.4.5">PaP</span> on CIFAR100 and ImageNet100, respectively. While these improvements fall short of the Bayes-optimal update’s enhancements of <math alttext="9.4\%" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px1.p1.3.m3.1"><semantics id="S4.SS2.SSS0.Px1.p1.3.m3.1a"><mrow id="S4.SS2.SSS0.Px1.p1.3.m3.1.1" xref="S4.SS2.SSS0.Px1.p1.3.m3.1.1.cmml"><mn id="S4.SS2.SSS0.Px1.p1.3.m3.1.1.2" xref="S4.SS2.SSS0.Px1.p1.3.m3.1.1.2.cmml">9.4</mn><mo id="S4.SS2.SSS0.Px1.p1.3.m3.1.1.1" xref="S4.SS2.SSS0.Px1.p1.3.m3.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p1.3.m3.1b"><apply id="S4.SS2.SSS0.Px1.p1.3.m3.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.3.m3.1.1"><csymbol cd="latexml" id="S4.SS2.SSS0.Px1.p1.3.m3.1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.3.m3.1.1.1">percent</csymbol><cn id="S4.SS2.SSS0.Px1.p1.3.m3.1.1.2.cmml" type="float" xref="S4.SS2.SSS0.Px1.p1.3.m3.1.1.2">9.4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p1.3.m3.1c">9.4\%</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px1.p1.3.m3.1d">9.4 %</annotation></semantics></math> and <math alttext="6.88\%" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px1.p1.4.m4.1"><semantics id="S4.SS2.SSS0.Px1.p1.4.m4.1a"><mrow id="S4.SS2.SSS0.Px1.p1.4.m4.1.1" xref="S4.SS2.SSS0.Px1.p1.4.m4.1.1.cmml"><mn id="S4.SS2.SSS0.Px1.p1.4.m4.1.1.2" xref="S4.SS2.SSS0.Px1.p1.4.m4.1.1.2.cmml">6.88</mn><mo id="S4.SS2.SSS0.Px1.p1.4.m4.1.1.1" xref="S4.SS2.SSS0.Px1.p1.4.m4.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p1.4.m4.1b"><apply id="S4.SS2.SSS0.Px1.p1.4.m4.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.4.m4.1.1"><csymbol cd="latexml" id="S4.SS2.SSS0.Px1.p1.4.m4.1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.4.m4.1.1.1">percent</csymbol><cn id="S4.SS2.SSS0.Px1.p1.4.m4.1.1.2.cmml" type="float" xref="S4.SS2.SSS0.Px1.p1.4.m4.1.1.2">6.88</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p1.4.m4.1c">6.88\%</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px1.p1.4.m4.1d">6.88 %</annotation></semantics></math> on the same datasets, they underscore the effectiveness of our adapter module in approximating the causal mechanism. Additionally, its ability to achieve such improvements while being computationally and informationally efficient highlights its adaptability across different shift settings.</p>
</div>
<div class="ltx_para" id="S4.SS2.SSS0.Px1.p2">
<p class="ltx_p" id="S4.SS2.SSS0.Px1.p2.2">Similar gains can be observed on language tasks. Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#S4.F3" title="Figure 3 ‣ Modularity and zero-shot model updates. ‣ 4.2 Empirical findings ‣ 4 Experiments ‣ Adjusting Pretrained Backbones for Performativity"><span class="ltx_text ltx_ref_tag">3</span></a> illustrates the performances of the different baselines on Amazon and AGNews datasets. Again, it can be seen that high shift scenarios hinder the <span class="ltx_text ltx_font_italic" id="S4.SS2.SSS0.Px1.p2.2.1">Oracle Fine-tuning</span> performance, failing to anticipate the next distribution similar to the vision case. Moreover, the results reveal that our <span class="ltx_text ltx_font_italic" id="S4.SS2.SSS0.Px1.p2.2.2">Performativity-aware Predictor</span> steadily approaches the performance of the <span class="ltx_text ltx_font_italic" id="S4.SS2.SSS0.Px1.p2.2.3">Oracle Distribution</span> over time, as the model learns the inherent relationship between class accuracies and subsequent label distributions. We inspect the learning curve of the adapter in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#A1.SS2" title="A.2 Additional Experimental Results ‣ Appendix A Appendix ‣ Adjusting Pretrained Backbones for Performativity"><span class="ltx_text ltx_ref_tag">A.2</span></a>.
Looking at the comparison to <span class="ltx_text ltx_font_italic" id="S4.SS2.SSS0.Px1.p2.2.4">No Adaptation</span> in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#S4.F5" title="Figure 5 ‣ Beyond label shift. ‣ 4.2 Empirical findings ‣ 4 Experiments ‣ Adjusting Pretrained Backbones for Performativity"><span class="ltx_text ltx_ref_tag">5</span></a> we see an average accuracy gain of <math alttext="2.83\%" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px1.p2.1.m1.1"><semantics id="S4.SS2.SSS0.Px1.p2.1.m1.1a"><mrow id="S4.SS2.SSS0.Px1.p2.1.m1.1.1" xref="S4.SS2.SSS0.Px1.p2.1.m1.1.1.cmml"><mn id="S4.SS2.SSS0.Px1.p2.1.m1.1.1.2" xref="S4.SS2.SSS0.Px1.p2.1.m1.1.1.2.cmml">2.83</mn><mo id="S4.SS2.SSS0.Px1.p2.1.m1.1.1.1" xref="S4.SS2.SSS0.Px1.p2.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p2.1.m1.1b"><apply id="S4.SS2.SSS0.Px1.p2.1.m1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p2.1.m1.1.1"><csymbol cd="latexml" id="S4.SS2.SSS0.Px1.p2.1.m1.1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p2.1.m1.1.1.1">percent</csymbol><cn id="S4.SS2.SSS0.Px1.p2.1.m1.1.1.2.cmml" type="float" xref="S4.SS2.SSS0.Px1.p2.1.m1.1.1.2">2.83</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p2.1.m1.1c">2.83\%</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px1.p2.1.m1.1d">2.83 %</annotation></semantics></math> and <math alttext="1.3\%" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px1.p2.2.m2.1"><semantics id="S4.SS2.SSS0.Px1.p2.2.m2.1a"><mrow id="S4.SS2.SSS0.Px1.p2.2.m2.1.1" xref="S4.SS2.SSS0.Px1.p2.2.m2.1.1.cmml"><mn id="S4.SS2.SSS0.Px1.p2.2.m2.1.1.2" xref="S4.SS2.SSS0.Px1.p2.2.m2.1.1.2.cmml">1.3</mn><mo id="S4.SS2.SSS0.Px1.p2.2.m2.1.1.1" xref="S4.SS2.SSS0.Px1.p2.2.m2.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p2.2.m2.1b"><apply id="S4.SS2.SSS0.Px1.p2.2.m2.1.1.cmml" xref="S4.SS2.SSS0.Px1.p2.2.m2.1.1"><csymbol cd="latexml" id="S4.SS2.SSS0.Px1.p2.2.m2.1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p2.2.m2.1.1.1">percent</csymbol><cn id="S4.SS2.SSS0.Px1.p2.2.m2.1.1.2.cmml" type="float" xref="S4.SS2.SSS0.Px1.p2.2.m2.1.1.2">1.3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p2.2.m2.1c">1.3\%</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px1.p2.2.m2.1d">1.3 %</annotation></semantics></math>.</p>
</div>
</section>
<section class="ltx_paragraph" id="S4.SS2.SSS0.Px2">
<h4 class="ltx_title ltx_title_paragraph">Modularity and zero-shot model updates.</h4>
<div class="ltx_para" id="S4.SS2.SSS0.Px2.p1">
<p class="ltx_p" id="S4.SS2.SSS0.Px2.p1.1">We demonstrate the modularity of our approach in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#S4.F5" title="Figure 5 ‣ Beyond label shift. ‣ 4.2 Empirical findings ‣ 4 Experiments ‣ Adjusting Pretrained Backbones for Performativity"><span class="ltx_text ltx_ref_tag">5</span></a> under high label shift. We first trained the adapter module compined with a ResNet18 backbone at high shift on ImageNet100. Then, using the same pretrained frozen adapter, we simulated <math alttext="200" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px2.p1.1.m1.1"><semantics id="S4.SS2.SSS0.Px2.p1.1.m1.1a"><mn id="S4.SS2.SSS0.Px2.p1.1.m1.1.1" xref="S4.SS2.SSS0.Px2.p1.1.m1.1.1.cmml">200</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px2.p1.1.m1.1b"><cn id="S4.SS2.SSS0.Px2.p1.1.m1.1.1.cmml" type="integer" xref="S4.SS2.SSS0.Px2.p1.1.m1.1.1">200</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px2.p1.1.m1.1c">200</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px2.p1.1.m1.1d">200</annotation></semantics></math> rounds starting with ResNet18. Over the rounds, we switched the deployed backbone from ResNet18 to ResNet34, and then from ResNet34 to ResNet50. Since the predictor captures the inherent relationship between the sufficient statistic (i.e., class level accuracies) and the label marginals, it is not coupled with the specific model it attaches to and continues to improve with its corrections.
Consequently, practitioners can update the current model if a more suitable one becomes available at <span class="ltx_text ltx_font_italic" id="S4.SS2.SSS0.Px2.p1.1.1">any time</span> during deployment cycles, without the need to retrain the predictor.</p>
</div>
<figure class="ltx_figure" id="S4.F3">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S4.F3.12" style="width:216.8pt;"><span class="ltx_text ltx_font_bold" id="S4.F3.12.1">Amazon</span></p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S4.F3.13" style="width:216.8pt;"><span class="ltx_text ltx_font_bold" id="S4.F3.13.1">AGNews</span></p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S4.F3.1" style="width:208.1pt;">
<img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="294" id="S4.F3.1.g1" src="extracted/5905190/figures/language/accuracy_over_time/accuracy_over_time_Amazon_0.05.png" width="479"/>
<div class="ltx_inline-block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle ltx_transformed_outer" id="S4.F3.1.1" style="width:8.7pt;height:45pt;vertical-align:-20.0pt;"><span class="ltx_transformed_inner" style="width:45.0pt;transform:translate(-18.06pt,2.92pt) rotate(-90deg) ;">
<p class="ltx_p" id="S4.F3.1.1.1"><span class="ltx_text ltx_font_bold" id="S4.F3.1.1.1.1">High Shift</span></p>
</span></div>
</div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S4.F3.2" style="width:208.1pt;">
<img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="294" id="S4.F3.2.g1" src="extracted/5905190/figures/language/accuracy_over_time/accuracy_over_time_AGNews_0.01.png" width="479"/>
<div class="ltx_inline-block ltx_minipage ltx_align_center ltx_align_middle ltx_transformed_outer" id="S4.F3.2.1" style="width:8.7pt;height:65.9pt;vertical-align:-29.5pt;"><span class="ltx_transformed_inner" style="width:65.9pt;transform:translate(-29.46pt,0pt) rotate(-90deg) ;">
<p class="ltx_p" id="S4.F3.2.1.1"><span class="ltx_text ltx_font_bold" id="S4.F3.2.1.1.1">Moderate Shift</span></p>
</span></div>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S4.F3.3" style="width:208.1pt;">
<img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="288" id="S4.F3.3.g1" src="extracted/5905190/figures/language/accuracy_over_time/accuracy_over_time_Amazon_0.1.png" width="479"/>
</div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S4.F3.4" style="width:208.1pt;">
<img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="287" id="S4.F3.4.g1" src="extracted/5905190/figures/language/accuracy_over_time/accuracy_over_time_AGNews_0.025.png" width="479"/>
<div class="ltx_inline-block ltx_minipage ltx_align_center ltx_align_middle ltx_transformed_outer" id="S4.F3.4.1" style="width:8.7pt;height:42.4pt;vertical-align:-17.7pt;"><span class="ltx_transformed_inner" style="width:42.4pt;transform:translate(-17.71pt,0pt) rotate(-90deg) ;">
<p class="ltx_p" id="S4.F3.4.1.1"><span class="ltx_text ltx_font_bold" id="S4.F3.4.1.1.1">Low Shift</span></p>
</span></div>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S4.F3.5" style="width:208.1pt;">
<img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="294" id="S4.F3.5.g1" src="extracted/5905190/figures/language/accuracy_over_time/accuracy_over_time_Amazon_0.45.png" width="479"/>
</div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S4.F3.6" style="width:208.1pt;">
<img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="294" id="S4.F3.6.g1" src="extracted/5905190/figures/language/accuracy_over_time/accuracy_over_time_AGNews_0.05.png" width="479"/>
</div>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F3.18.3.1" style="font-size:90%;">Figure 3</span>: </span><em class="ltx_emph ltx_font_italic" id="S4.F3.19.4" style="font-size:90%;">Accuracy along retraining trajectory for language tasks</em><span class="ltx_text" id="S4.F3.10.2" style="font-size:90%;">. The <span class="ltx_text ltx_font_italic" id="S4.F3.10.2.1">Oracle fine-tuning</span> method is more sensitive to shifts in language datasets. Again, <math alttext="t=0" class="ltx_Math" display="inline" id="S4.F3.9.1.m1.1"><semantics id="S4.F3.9.1.m1.1b"><mrow id="S4.F3.9.1.m1.1.1" xref="S4.F3.9.1.m1.1.1.cmml"><mi id="S4.F3.9.1.m1.1.1.2" xref="S4.F3.9.1.m1.1.1.2.cmml">t</mi><mo id="S4.F3.9.1.m1.1.1.1" xref="S4.F3.9.1.m1.1.1.1.cmml">=</mo><mn id="S4.F3.9.1.m1.1.1.3" xref="S4.F3.9.1.m1.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.F3.9.1.m1.1c"><apply id="S4.F3.9.1.m1.1.1.cmml" xref="S4.F3.9.1.m1.1.1"><eq id="S4.F3.9.1.m1.1.1.1.cmml" xref="S4.F3.9.1.m1.1.1.1"></eq><ci id="S4.F3.9.1.m1.1.1.2.cmml" xref="S4.F3.9.1.m1.1.1.2">𝑡</ci><cn id="S4.F3.9.1.m1.1.1.3.cmml" type="integer" xref="S4.F3.9.1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F3.9.1.m1.1d">t=0</annotation><annotation encoding="application/x-llamapun" id="S4.F3.9.1.m1.1e">italic_t = 0</annotation></semantics></math> refers to the balanced training accuracy. Similar to the vision case, the <span class="ltx_text ltx_font_italic" id="S4.F3.10.2.2">Performative-aware Predictor (PaP)</span> performs well under different shift scenarios, increasing its proximity to the Bayes-optimal <span class="ltx_text ltx_font_italic" id="S4.F3.10.2.3">Oracle distribution</span> performance as it is trained over rounds. The inset plot provides a detailed view of the initial performance, focusing on the model’s learning curve within the first <math alttext="10" class="ltx_Math" display="inline" id="S4.F3.10.2.m2.1"><semantics id="S4.F3.10.2.m2.1b"><mn id="S4.F3.10.2.m2.1.1" xref="S4.F3.10.2.m2.1.1.cmml">10</mn><annotation-xml encoding="MathML-Content" id="S4.F3.10.2.m2.1c"><cn id="S4.F3.10.2.m2.1.1.cmml" type="integer" xref="S4.F3.10.2.m2.1.1">10</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.F3.10.2.m2.1d">10</annotation><annotation encoding="application/x-llamapun" id="S4.F3.10.2.m2.1e">10</annotation></semantics></math> updates.</span></figcaption>
</figure>
</section>
<section class="ltx_paragraph" id="S4.SS2.SSS0.Px3">
<h4 class="ltx_title ltx_title_paragraph">Anticipating performativity.</h4>
<div class="ltx_para" id="S4.SS2.SSS0.Px3.p1">
<p class="ltx_p" id="S4.SS2.SSS0.Px3.p1.8">We demonstrate that the learnt adapter module <span class="ltx_text ltx_font_italic" id="S4.SS2.SSS0.Px3.p1.8.1">PaP</span> can effectively anticipate the future performance of a model before its deployment, providing valuable information for model selection.
Our experiment involves training various models with different random initializations. For each model, we evaluate its performance on a balanced dataset (pre deployment), then deploy it and measure performance again on the induced data (post deployment). In parallel, we use our learnt adapter model to predict post deployment performance, given only the sufficient statistic, and sample access to the current distribution. In Table <a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#S4.T1" title="Table 1 ‣ 4.1 Performative label shift ‣ 4 Experiments ‣ Adjusting Pretrained Backbones for Performativity"><span class="ltx_text ltx_ref_tag">1</span></a>, we compare our anticipation with the actual performance.
We can observe that our approach provides a much better estimate than the initial performance.
Importantly, the ranking based on our estimates exactly matches the true shift performance ranking, which cannot be inferred from first round performances alone. For example, Model <math alttext="1" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px3.p1.1.m1.1"><semantics id="S4.SS2.SSS0.Px3.p1.1.m1.1a"><mn id="S4.SS2.SSS0.Px3.p1.1.m1.1.1" xref="S4.SS2.SSS0.Px3.p1.1.m1.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px3.p1.1.m1.1b"><cn id="S4.SS2.SSS0.Px3.p1.1.m1.1.1.cmml" type="integer" xref="S4.SS2.SSS0.Px3.p1.1.m1.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px3.p1.1.m1.1c">1</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px3.p1.1.m1.1d">1</annotation></semantics></math> initially outperforms Models <math alttext="2" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px3.p1.2.m2.1"><semantics id="S4.SS2.SSS0.Px3.p1.2.m2.1a"><mn id="S4.SS2.SSS0.Px3.p1.2.m2.1.1" xref="S4.SS2.SSS0.Px3.p1.2.m2.1.1.cmml">2</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px3.p1.2.m2.1b"><cn id="S4.SS2.SSS0.Px3.p1.2.m2.1.1.cmml" type="integer" xref="S4.SS2.SSS0.Px3.p1.2.m2.1.1">2</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px3.p1.2.m2.1c">2</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px3.p1.2.m2.1d">2</annotation></semantics></math> and <math alttext="3" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px3.p1.3.m3.1"><semantics id="S4.SS2.SSS0.Px3.p1.3.m3.1a"><mn id="S4.SS2.SSS0.Px3.p1.3.m3.1.1" xref="S4.SS2.SSS0.Px3.p1.3.m3.1.1.cmml">3</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px3.p1.3.m3.1b"><cn id="S4.SS2.SSS0.Px3.p1.3.m3.1.1.cmml" type="integer" xref="S4.SS2.SSS0.Px3.p1.3.m3.1.1">3</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px3.p1.3.m3.1c">3</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px3.p1.3.m3.1d">3</annotation></semantics></math>. However, the nature of the performative shift affects Model <math alttext="1" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px3.p1.4.m4.1"><semantics id="S4.SS2.SSS0.Px3.p1.4.m4.1a"><mn id="S4.SS2.SSS0.Px3.p1.4.m4.1.1" xref="S4.SS2.SSS0.Px3.p1.4.m4.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px3.p1.4.m4.1b"><cn id="S4.SS2.SSS0.Px3.p1.4.m4.1.1.cmml" type="integer" xref="S4.SS2.SSS0.Px3.p1.4.m4.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px3.p1.4.m4.1c">1</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px3.p1.4.m4.1d">1</annotation></semantics></math> more significantly, resulting in worse post-shift performance compared to Models <math alttext="2" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px3.p1.5.m5.1"><semantics id="S4.SS2.SSS0.Px3.p1.5.m5.1a"><mn id="S4.SS2.SSS0.Px3.p1.5.m5.1.1" xref="S4.SS2.SSS0.Px3.p1.5.m5.1.1.cmml">2</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px3.p1.5.m5.1b"><cn id="S4.SS2.SSS0.Px3.p1.5.m5.1.1.cmml" type="integer" xref="S4.SS2.SSS0.Px3.p1.5.m5.1.1">2</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px3.p1.5.m5.1c">2</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px3.p1.5.m5.1d">2</annotation></semantics></math> and <math alttext="3" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px3.p1.6.m6.1"><semantics id="S4.SS2.SSS0.Px3.p1.6.m6.1a"><mn id="S4.SS2.SSS0.Px3.p1.6.m6.1.1" xref="S4.SS2.SSS0.Px3.p1.6.m6.1.1.cmml">3</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px3.p1.6.m6.1b"><cn id="S4.SS2.SSS0.Px3.p1.6.m6.1.1.cmml" type="integer" xref="S4.SS2.SSS0.Px3.p1.6.m6.1.1">3</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px3.p1.6.m6.1c">3</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px3.p1.6.m6.1d">3</annotation></semantics></math>. Using <span class="ltx_text ltx_font_italic" id="S4.SS2.SSS0.Px3.p1.8.2">PaP</span>, one can infer that Models <math alttext="2" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px3.p1.7.m7.1"><semantics id="S4.SS2.SSS0.Px3.p1.7.m7.1a"><mn id="S4.SS2.SSS0.Px3.p1.7.m7.1.1" xref="S4.SS2.SSS0.Px3.p1.7.m7.1.1.cmml">2</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px3.p1.7.m7.1b"><cn id="S4.SS2.SSS0.Px3.p1.7.m7.1.1.cmml" type="integer" xref="S4.SS2.SSS0.Px3.p1.7.m7.1.1">2</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px3.p1.7.m7.1c">2</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px3.p1.7.m7.1d">2</annotation></semantics></math> and <math alttext="3" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px3.p1.8.m8.1"><semantics id="S4.SS2.SSS0.Px3.p1.8.m8.1a"><mn id="S4.SS2.SSS0.Px3.p1.8.m8.1.1" xref="S4.SS2.SSS0.Px3.p1.8.m8.1.1.cmml">3</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px3.p1.8.m8.1b"><cn id="S4.SS2.SSS0.Px3.p1.8.m8.1.1.cmml" type="integer" xref="S4.SS2.SSS0.Px3.p1.8.m8.1.1">3</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px3.p1.8.m8.1c">3</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px3.p1.8.m8.1d">3</annotation></semantics></math>, despite having worse performance on the current distribution, are more robust against the performative shift.</p>
</div>
</section>
<section class="ltx_paragraph" id="S4.SS2.SSS0.Px4">
<h4 class="ltx_title ltx_title_paragraph">Beyond label shift.</h4>
<div class="ltx_para" id="S4.SS2.SSS0.Px4.p1">
<p class="ltx_p" id="S4.SS2.SSS0.Px4.p1.5">As a more general setting, we combine label shift with domain shift. For illustration purposes, we simulated an almost extreme scenario. Specifically, we randomly selected two domains and sampled data points exclusively from these domains. Using the TerraIncognita dataset <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#bib.bib6" title="">6</a>]</cite> and employing the same experimental setting over <math alttext="200" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px4.p1.1.m1.1"><semantics id="S4.SS2.SSS0.Px4.p1.1.m1.1a"><mn id="S4.SS2.SSS0.Px4.p1.1.m1.1.1" xref="S4.SS2.SSS0.Px4.p1.1.m1.1.1.cmml">200</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px4.p1.1.m1.1b"><cn id="S4.SS2.SSS0.Px4.p1.1.m1.1.1.cmml" type="integer" xref="S4.SS2.SSS0.Px4.p1.1.m1.1.1">200</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px4.p1.1.m1.1c">200</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px4.p1.1.m1.1d">200</annotation></semantics></math> rounds, we evaluate the average accuracies across rounds with their standard errors in this scenario. The <span class="ltx_text ltx_font_italic" id="S4.SS2.SSS0.Px4.p1.5.1">Performativity-aware Predictor</span> achieves an average accuracy of <math alttext="78.25\pm 3.24" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px4.p1.2.m2.1"><semantics id="S4.SS2.SSS0.Px4.p1.2.m2.1a"><mrow id="S4.SS2.SSS0.Px4.p1.2.m2.1.1" xref="S4.SS2.SSS0.Px4.p1.2.m2.1.1.cmml"><mn id="S4.SS2.SSS0.Px4.p1.2.m2.1.1.2" xref="S4.SS2.SSS0.Px4.p1.2.m2.1.1.2.cmml">78.25</mn><mo id="S4.SS2.SSS0.Px4.p1.2.m2.1.1.1" xref="S4.SS2.SSS0.Px4.p1.2.m2.1.1.1.cmml">±</mo><mn id="S4.SS2.SSS0.Px4.p1.2.m2.1.1.3" xref="S4.SS2.SSS0.Px4.p1.2.m2.1.1.3.cmml">3.24</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px4.p1.2.m2.1b"><apply id="S4.SS2.SSS0.Px4.p1.2.m2.1.1.cmml" xref="S4.SS2.SSS0.Px4.p1.2.m2.1.1"><csymbol cd="latexml" id="S4.SS2.SSS0.Px4.p1.2.m2.1.1.1.cmml" xref="S4.SS2.SSS0.Px4.p1.2.m2.1.1.1">plus-or-minus</csymbol><cn id="S4.SS2.SSS0.Px4.p1.2.m2.1.1.2.cmml" type="float" xref="S4.SS2.SSS0.Px4.p1.2.m2.1.1.2">78.25</cn><cn id="S4.SS2.SSS0.Px4.p1.2.m2.1.1.3.cmml" type="float" xref="S4.SS2.SSS0.Px4.p1.2.m2.1.1.3">3.24</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px4.p1.2.m2.1c">78.25\pm 3.24</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px4.p1.2.m2.1d">78.25 ± 3.24</annotation></semantics></math>, outperforming the <span class="ltx_text ltx_font_italic" id="S4.SS2.SSS0.Px4.p1.5.2">No Adaptation</span> case with <math alttext="75.39\pm 3.32" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px4.p1.3.m3.1"><semantics id="S4.SS2.SSS0.Px4.p1.3.m3.1a"><mrow id="S4.SS2.SSS0.Px4.p1.3.m3.1.1" xref="S4.SS2.SSS0.Px4.p1.3.m3.1.1.cmml"><mn id="S4.SS2.SSS0.Px4.p1.3.m3.1.1.2" xref="S4.SS2.SSS0.Px4.p1.3.m3.1.1.2.cmml">75.39</mn><mo id="S4.SS2.SSS0.Px4.p1.3.m3.1.1.1" xref="S4.SS2.SSS0.Px4.p1.3.m3.1.1.1.cmml">±</mo><mn id="S4.SS2.SSS0.Px4.p1.3.m3.1.1.3" xref="S4.SS2.SSS0.Px4.p1.3.m3.1.1.3.cmml">3.32</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px4.p1.3.m3.1b"><apply id="S4.SS2.SSS0.Px4.p1.3.m3.1.1.cmml" xref="S4.SS2.SSS0.Px4.p1.3.m3.1.1"><csymbol cd="latexml" id="S4.SS2.SSS0.Px4.p1.3.m3.1.1.1.cmml" xref="S4.SS2.SSS0.Px4.p1.3.m3.1.1.1">plus-or-minus</csymbol><cn id="S4.SS2.SSS0.Px4.p1.3.m3.1.1.2.cmml" type="float" xref="S4.SS2.SSS0.Px4.p1.3.m3.1.1.2">75.39</cn><cn id="S4.SS2.SSS0.Px4.p1.3.m3.1.1.3.cmml" type="float" xref="S4.SS2.SSS0.Px4.p1.3.m3.1.1.3">3.32</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px4.p1.3.m3.1c">75.39\pm 3.32</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px4.p1.3.m3.1d">75.39 ± 3.32</annotation></semantics></math> and the <span class="ltx_text ltx_font_italic" id="S4.SS2.SSS0.Px4.p1.5.3">No Adaptation (only label shift)</span> case with <math alttext="75.89\pm 1.31" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px4.p1.4.m4.1"><semantics id="S4.SS2.SSS0.Px4.p1.4.m4.1a"><mrow id="S4.SS2.SSS0.Px4.p1.4.m4.1.1" xref="S4.SS2.SSS0.Px4.p1.4.m4.1.1.cmml"><mn id="S4.SS2.SSS0.Px4.p1.4.m4.1.1.2" xref="S4.SS2.SSS0.Px4.p1.4.m4.1.1.2.cmml">75.89</mn><mo id="S4.SS2.SSS0.Px4.p1.4.m4.1.1.1" xref="S4.SS2.SSS0.Px4.p1.4.m4.1.1.1.cmml">±</mo><mn id="S4.SS2.SSS0.Px4.p1.4.m4.1.1.3" xref="S4.SS2.SSS0.Px4.p1.4.m4.1.1.3.cmml">1.31</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px4.p1.4.m4.1b"><apply id="S4.SS2.SSS0.Px4.p1.4.m4.1.1.cmml" xref="S4.SS2.SSS0.Px4.p1.4.m4.1.1"><csymbol cd="latexml" id="S4.SS2.SSS0.Px4.p1.4.m4.1.1.1.cmml" xref="S4.SS2.SSS0.Px4.p1.4.m4.1.1.1">plus-or-minus</csymbol><cn id="S4.SS2.SSS0.Px4.p1.4.m4.1.1.2.cmml" type="float" xref="S4.SS2.SSS0.Px4.p1.4.m4.1.1.2">75.89</cn><cn id="S4.SS2.SSS0.Px4.p1.4.m4.1.1.3.cmml" type="float" xref="S4.SS2.SSS0.Px4.p1.4.m4.1.1.3">1.31</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px4.p1.4.m4.1c">75.89\pm 1.31</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px4.p1.4.m4.1d">75.89 ± 1.31</annotation></semantics></math>. The high standard error shows that the presence of simulated domain shift results in higher fluctuation in performance, reflecting the extremity of our simulation. However, assessing the average accuracy performance reveals that the effect of additional domain shift on performance is not highly significant. Furthermore, one can see the effectiveness of using the adapter module compared to <span class="ltx_text ltx_font_italic" id="S4.SS2.SSS0.Px4.p1.5.4">No Adaptation</span> when both types of shifts are present. <span class="ltx_text ltx_font_italic" id="S4.SS2.SSS0.Px4.p1.5.5">PaP</span> outperforms no adaptation cases by almost <math alttext="3\%" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px4.p1.5.m5.1"><semantics id="S4.SS2.SSS0.Px4.p1.5.m5.1a"><mrow id="S4.SS2.SSS0.Px4.p1.5.m5.1.1" xref="S4.SS2.SSS0.Px4.p1.5.m5.1.1.cmml"><mn id="S4.SS2.SSS0.Px4.p1.5.m5.1.1.2" xref="S4.SS2.SSS0.Px4.p1.5.m5.1.1.2.cmml">3</mn><mo id="S4.SS2.SSS0.Px4.p1.5.m5.1.1.1" xref="S4.SS2.SSS0.Px4.p1.5.m5.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px4.p1.5.m5.1b"><apply id="S4.SS2.SSS0.Px4.p1.5.m5.1.1.cmml" xref="S4.SS2.SSS0.Px4.p1.5.m5.1.1"><csymbol cd="latexml" id="S4.SS2.SSS0.Px4.p1.5.m5.1.1.1.cmml" xref="S4.SS2.SSS0.Px4.p1.5.m5.1.1.1">percent</csymbol><cn id="S4.SS2.SSS0.Px4.p1.5.m5.1.1.2.cmml" type="integer" xref="S4.SS2.SSS0.Px4.p1.5.m5.1.1.2">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px4.p1.5.m5.1c">3\%</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px4.p1.5.m5.1d">3 %</annotation></semantics></math>, both in the presence of label shift alone and when both shifts are combined. This demonstrates that our adapter module designed to correct for performative label shift remains effective even in the presence of additional sources of shifts on the input distribution.</p>
</div>
<figure class="ltx_figure" id="S4.F5">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S4.F5.1" style="width:208.1pt;"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="286" id="S4.F5.1.g1" src="extracted/5905190/figures/model_switching/accuracy_over_time_model_switching_0.1.png" width="479"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F5.1.4.1.1" style="font-size:90%;">Figure 4</span>: </span><em class="ltx_emph ltx_font_italic" id="S4.F5.1.5.2" style="font-size:90%;">Modularity of the architecture.</em><span class="ltx_text" id="S4.F5.1.6.3" style="font-size:90%;"> We conduct a model switching experiment where we replace the backbone within PaP. <span class="ltx_text ltx_font_italic" id="S4.F5.1.6.3.1">PaP</span> still outperforms the <span class="ltx_text ltx_font_italic" id="S4.F5.1.6.3.2">No Adaptation</span> baseline consistently, even with models it wasn’t originally trained with.</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S4.F5.2" style="width:208.1pt;"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="294" id="S4.F5.2.g1" src="extracted/5905190/figures/accuracy_change/merged_performance_difference.png" width="479"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F5.2.6.1.1" style="font-size:90%;">Figure 5</span>: </span><em class="ltx_emph ltx_font_italic" id="S4.F5.2.7.2" style="font-size:90%;">Anticipating performativity.</em><span class="ltx_text" id="S4.F5.2.8.3" style="font-size:90%;"> Average performance gain over <span class="ltx_text ltx_font_italic" id="S4.F5.2.8.3.1">No Adaptation</span> in high shift scenarios. <span class="ltx_text ltx_font_italic" id="S4.F5.2.8.3.2">Oracle fine-tuning</span> performs significantly worse than <span class="ltx_text ltx_font_italic" id="S4.F5.2.8.3.3">No Adaptation</span>, as it does not anticipate the shift. In contrast, <span class="ltx_text ltx_font_italic" id="S4.F5.2.8.3.4">PaP</span> achieves consistent gains and performs comparable to the oracle baseline. </span></figcaption>
</figure>
</div>
</div>
</figure>
</section>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Conclusion</h2>
<div class="ltx_para" id="S5.p1">
<p class="ltx_p" id="S5.p1.1">This work investigates performative prediction in deep learning.
We design the first practical algorithm to adjust pre-trained models for performativity that is compatible with existing deep learning assets. We motivate the use of modular architectures to increase data efficiency and evaluate our approach under performative distribution shifts arising in typical dynamic benchmark settings. On multiple vision and language datasets with different types of shifts, we observe consistent performance gains along the retraining trajectory compared to standard baselines for the same adjustment module applied to different backbones. Finally, we illustrate how the adapter can be used for model selection under performativity to enable more informed model deployments and anticipate unwanted consequences.</p>
</div>
<section class="ltx_paragraph" id="S5.SS0.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">Limitations and extensions.</h4>
<div class="ltx_para" id="S5.SS0.SSS0.Px1.p1">
<p class="ltx_p" id="S5.SS0.SSS0.Px1.p1.1">Overall, our work is the first tackling performativity in deep learning. Thus, there are countless possible extensions of our method. We demonstrated the feasibility of designing a modular architecture in the context of performative label shift by accessing the logits of the pre-trained models. An interesting and natural direction could be to capture and adjust representations, closer to the input level. This would allow to account for more complex shifts, and offers a natural lever to trade off expressivity of the adapter and sample requirements.
Further, our approach critically assumes known statistics, which are easily encoded in the label shift setting we consider, and easy to reconstruct with minimal knowledge about the paradigm. An interesting extension is to learn such statistics, perhaps leveraging causal representation learning tools <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#bib.bib70" title="">70</a>]</cite>. Besides being more general, it could also serve open vocabulary tasks <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#bib.bib65" title="">65</a>]</cite>, where even labels shifts would be challenging to characterize with a finite dimensional vector, or even generative modeling. Another unanswered question is to derive theoretical guarantees for learning the underlying performative mechanism such as causal identification guarantee, similar to <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#bib.bib56" title="">56</a>]</cite>, as well as sample complexities. These results can potentially guide more data-efficient algorithms, or more effective strategies to select the sequence of models to deploy during the training phase of the adapter module, akin to <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#bib.bib33" title="">33</a>]</cite>.</p>
</div>
</section>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Abernethy et al. [2022]</span>
<span class="ltx_bibblock">
J. D. Abernethy, P. Awasthi, M. Kleindessner, J. Morgenstern, C. Russell, and J. Zhang.

</span>
<span class="ltx_bibblock">Active sampling for min-max fairness.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib1.1.1">International Conference on Machine Learning</em>, pages 53–65, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Alexandari et al. [2020]</span>
<span class="ltx_bibblock">
A. Alexandari, A. Kundaje, and A. Shrikumar.

</span>
<span class="ltx_bibblock">Maximum likelihood with bias-corrected calibration is hard-to-beat at label shift adaptation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib2.1.1">International Conference on Machine Learning</em>, pages 222–232. PMLR, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Aljundi et al. [2018]</span>
<span class="ltx_bibblock">
R. Aljundi, F. Babiloni, M. Elhoseiny, M. Rohrbach, and T. Tuytelaars.

</span>
<span class="ltx_bibblock">Memory aware synapses: Learning what (not) to forget.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib3.1.1">Proceedings of the European conference on computer vision (ECCV)</em>, pages 139–154, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Arrow [2012]</span>
<span class="ltx_bibblock">
K. J. Arrow.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib4.1.1">Social Choice and Individual Values</em>.

</span>
<span class="ltx_bibblock">Yale University Press, 2012.

</span>
<span class="ltx_bibblock">ISBN 9780300179316.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Barocas et al. [2023]</span>
<span class="ltx_bibblock">
S. Barocas, M. Hardt, and A. Narayanan.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib5.1.1">Fairness and Machine Learning: Limitations and Opportunities</em>.

</span>
<span class="ltx_bibblock">MIT Press, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Beery et al. [2018]</span>
<span class="ltx_bibblock">
S. Beery, G. Van Horn, and P. Perona.

</span>
<span class="ltx_bibblock">Recognition in terra incognita.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib6.1.1">Proceedings of the European conference on computer vision (ECCV)</em>, pages 456–473, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Belouadah and Popescu [2019]</span>
<span class="ltx_bibblock">
E. Belouadah and A. Popescu.

</span>
<span class="ltx_bibblock">Il2m: Class incremental learning with dual memory.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib7.1.1">Proceedings of the IEEE/CVF international conference on computer vision</em>, pages 583–592, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bezuijen et al. [2009]</span>
<span class="ltx_bibblock">
X. M. Bezuijen, P. T. van den Berg, K. van Dam, and H. Thierry.

</span>
<span class="ltx_bibblock">Pygmalion and employee learning: The role of leader behaviors.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib8.1.1">Journal of Management</em>, 35(5):1248–1267, 2009.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.1177/0149206308329966</span>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Brown et al. [2022]</span>
<span class="ltx_bibblock">
G. Brown, S. Hod, and I. Kalemaj.

</span>
<span class="ltx_bibblock">Performative prediction in a stateful world.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib9.1.1">Proceedings of the International Conference on Artificial Intelligence and Statistics</em>, pages 6045–6061, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Castro et al. [2018]</span>
<span class="ltx_bibblock">
F. M. Castro, M. J. Marín-Jiménez, N. Guil, C. Schmid, and K. Alahari.

</span>
<span class="ltx_bibblock">End-to-end incremental learning.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib10.1.1">Proceedings of the European conference on computer vision (ECCV)</em>, pages 233–248, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al. [2020]</span>
<span class="ltx_bibblock">
T. Chen, S. Kornblith, M. Norouzi, and G. Hinton.

</span>
<span class="ltx_bibblock">A simple framework for contrastive learning of visual representations.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib11.1.1">Proceedings of the International Conference on Machine Learning</em>, pages 1597–1607, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chun-Hsiao Yeh [2022]</span>
<span class="ltx_bibblock">
Y. C. Chun-Hsiao Yeh.

</span>
<span class="ltx_bibblock">IN100pytorch: Pytorch implementation: Training resnets on imagenet-100.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/danielchyeh/ImageNet-100-Pytorch" title="">https://github.com/danielchyeh/ImageNet-100-Pytorch</a>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Courty et al. [2017]</span>
<span class="ltx_bibblock">
N. Courty, R. Flamary, A. Habrard, and A. Rakotomamonjy.

</span>
<span class="ltx_bibblock">Joint distribution optimal transportation for domain adaptation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib13.1.1">International Conference on Neural Information Processing Systems</em>, page 3733–3742, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cui et al. [2019]</span>
<span class="ltx_bibblock">
Y. Cui, M. Jia, T.-Y. Lin, Y. Song, and S. Belongie.

</span>
<span class="ltx_bibblock">Class-balanced loss based on effective number of samples.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib14.1.1">Proceedings of the IEEE/CVF conference on computer vision and pattern recognition</em>, pages 9268–9277, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Davis et al. [2021]</span>
<span class="ltx_bibblock">
J. L. Davis, A. Williams, and M. W. Yang.

</span>
<span class="ltx_bibblock">Algorithmic reparation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib15.1.1">Big Data &amp; Society</em>, 8(2):20539517211044808, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dettmers et al. [2023]</span>
<span class="ltx_bibblock">
T. Dettmers, A. Pagnoni, A. Holtzman, and L. Zettlemoyer.

</span>
<span class="ltx_bibblock">QLoRA: Efficient finetuning of quantized LLMs.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib16.1.1">Conference on Neural Information Processing Systems</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Drusvyatskiy and Xiao [2023]</span>
<span class="ltx_bibblock">
D. Drusvyatskiy and L. Xiao.

</span>
<span class="ltx_bibblock">Stochastic optimization with decision-dependent distributions.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib17.1.1">Mathematics of Operations Research</em>, 48(2):954–998, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ensign et al. [2018]</span>
<span class="ltx_bibblock">
D. Ensign, S. A. Friedler, S. Neville, C. Scheidegger, and S. Venkatasubramanian.

</span>
<span class="ltx_bibblock">Runaway feedback loops in predictive policing.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib18.1.1">Conference on fairness, accountability and transparency</em>, pages 160–171. PMLR, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ganin et al. [2016]</span>
<span class="ltx_bibblock">
Y. Ganin, E. Ustinova, H. Ajakan, P. Germain, H. Larochelle, F. Laviolette, M. March, and V. Lempitsky.

</span>
<span class="ltx_bibblock">Domain-adversarial training of neural networks.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib19.1.1">Journal of Machine Learning Research</em>, 17(59):1–35, 2016.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gao et al. [2024]</span>
<span class="ltx_bibblock">
J. Gao, H. Zhao, D. dan Guo, and H. Zha.

</span>
<span class="ltx_bibblock">Distribution alignment optimization through neural collapse for long-tailed classification.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib20.1.1">International Conference on Machine Learning</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Garg et al. [2020a]</span>
<span class="ltx_bibblock">
S. Garg, Y. Wu, S. Balakrishnan, and Z. Lipton.

</span>
<span class="ltx_bibblock">A unified view of label shift estimation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib21.1.1">Advances in Neural Information Processing Systems (NeurIPS)</em>, 2020a.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Garg et al. [2020b]</span>
<span class="ltx_bibblock">
S. Garg, Y. Wu, S. Balakrishnan, and Z. Lipton.

</span>
<span class="ltx_bibblock">A unified view of label shift estimation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib22.1.1">Advances in Neural Information Processing Systems</em>, 33:3290–3300, 2020b.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Garg et al. [2023]</span>
<span class="ltx_bibblock">
S. Garg, N. Erickson, J. Sharpnack, A. Smola, S. Balakrishnan, and Z. Lipton.

</span>
<span class="ltx_bibblock">Rlsbench: Domain adaptation under relaxed label shift.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib23.1.1">International Conference on Machine Learning (ICML)</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Globus-Harris et al. [2022]</span>
<span class="ltx_bibblock">
I. Globus-Harris, M. Kearns, and A. Roth.

</span>
<span class="ltx_bibblock">An algorithmic framework for bias bounties.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib24.1.1">Proceedings of the 2022 ACM Conference on Fairness, Accountability, and Transparency</em>, pages 1106–1124, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gopalan et al. [2022]</span>
<span class="ltx_bibblock">
P. Gopalan, A. T. Kalai, O. Reingold, V. Sharan, and U. Wieder.

</span>
<span class="ltx_bibblock">Omnipredictors.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib25.1.1">Innovations in Theoretical Computer Science Conference</em>, volume 215, pages 79:1–79:21, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hardt and Mendler-Dünner [2023]</span>
<span class="ltx_bibblock">
M. Hardt and C. Mendler-Dünner.

</span>
<span class="ltx_bibblock">Performative prediction: Past and future.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib26.1.1">Arxiv preprint arxiv:2310.16608</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hardt et al. [2016]</span>
<span class="ltx_bibblock">
M. Hardt, N. Megiddo, C. Papadimitriou, and M. Wootters.

</span>
<span class="ltx_bibblock">Strategic classification.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib27.1.1">Proceedings of the 2016 ACM Conference on Innovations in Theoretical Computer Science</em>, ITCS ’16, page 111–122, 2016.

</span>
<span class="ltx_bibblock">ISBN 9781450340571.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hashimoto et al. [2018]</span>
<span class="ltx_bibblock">
T. Hashimoto, M. Srivastava, H. Namkoong, and P. Liang.

</span>
<span class="ltx_bibblock">Fairness without demographics in repeated loss minimization.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib28.1.1">International Conference on Machine Learning</em>, volume 80, pages 1929–1938, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Horowitz et al. [2024]</span>
<span class="ltx_bibblock">
G. Horowitz, Y. Sommer, M. Koren, and N. Rosenfeld.

</span>
<span class="ltx_bibblock">Classification under strategic self-selection.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib29.1.1">International Conference on Machine Learning</em>, volume 235, pages 18833–18858, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hou et al. [2019]</span>
<span class="ltx_bibblock">
S. Hou, X. Pan, C. C. Loy, Z. Wang, and D. Lin.

</span>
<span class="ltx_bibblock">Learning a unified classifier incrementally via rebalancing.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib30.1.1">Proceedings of the IEEE/CVF conference on computer vision and pattern recognition</em>, pages 831–839, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Houlsby et al. [2019]</span>
<span class="ltx_bibblock">
N. Houlsby, A. Giurgiu, S. Jastrzebski, B. Morrone, Q. De Laroussilhe, A. Gesmundo, M. Attariyan, and S. Gelly.

</span>
<span class="ltx_bibblock">Parameter-efficient transfer learning for NLP.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib31.1.1">Proceedings of the 36th International Conference on Machine Learning</em>, pages 2790–2799, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hu et al. [2022]</span>
<span class="ltx_bibblock">
E. J. Hu, yelong shen, P. Wallis, Z. Allen-Zhu, Y. Li, S. Wang, L. Wang, and W. Chen.

</span>
<span class="ltx_bibblock">LoRA: Low-rank adaptation of large language models.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib32.1.1">International Conference on Learning Representations</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jagadeesan et al. [2022]</span>
<span class="ltx_bibblock">
M. Jagadeesan, T. Zrnic, and C. Mendler-Dünner.

</span>
<span class="ltx_bibblock">Regret minimization with performative feedback.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib33.1.1">International Conference on Machine Learning</em>, pages 9760–9785. PMLR, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jia et al. [2022]</span>
<span class="ltx_bibblock">
M. Jia, L. Tang, B.-C. Chen, C. Cardie, S. Belongie, B. Hariharan, and S.-N. Lim.

</span>
<span class="ltx_bibblock">Visual prompt tuning.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib34.1.1">European Conference on Computer Vision</em>, pages 709–727. Springer, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jiang et al. [2020]</span>
<span class="ltx_bibblock">
J. Jiang, B. Chen, B. Fu, and M. Long.

</span>
<span class="ltx_bibblock">Transfer-learning-library.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/thuml/Transfer-Learning-Library" title="">https://github.com/thuml/Transfer-Learning-Library</a>, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kang et al. [2020]</span>
<span class="ltx_bibblock">
B. Kang, Y. Li, S. Xie, Z. Yuan, and J. Feng.

</span>
<span class="ltx_bibblock">Exploring balanced feature spaces for representation learning.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib36.1.1">International conference on learning representations</em>, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kiela et al. [2021]</span>
<span class="ltx_bibblock">
D. Kiela, M. Bartolo, Y. Nie, D. Kaushik, A. Geiger, Z. Wu, B. Vidgen, G. Prasad, A. Singh, P. Ringshia, Z. Ma, T. Thrush, S. Riedel, Z. Waseem, P. Stenetorp, R. Jia, M. Bansal, C. Potts, and A. Williams.

</span>
<span class="ltx_bibblock">Dynabench: Rethinking benchmarking in NLP.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib37.1.1">Conference of the North American Chapter of the Association for Computational Linguistics: Human Language Technologies</em>, pages 4110–4124, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kim and Perdomo [2023]</span>
<span class="ltx_bibblock">
M. P. Kim and J. C. Perdomo.

</span>
<span class="ltx_bibblock">Making Decisions Under Outcome Performativity.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib38.1.1">14th Innovations in Theoretical Computer Science Conference</em>, volume 251, pages 79:1–79:15, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib39">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kirichenko et al. [2023]</span>
<span class="ltx_bibblock">
P. Kirichenko, P. Izmailov, and A. G. Wilson.

</span>
<span class="ltx_bibblock">Last layer re-training is sufficient for robustness to spurious correlations.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib39.1.1">International Conference on Learning Representations</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib40">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kirkpatrick et al. [2017]</span>
<span class="ltx_bibblock">
J. Kirkpatrick, R. Pascanu, N. Rabinowitz, J. Veness, G. Desjardins, A. A. Rusu, K. Milan, J. Quan, T. Ramalho, A. Grabska-Barwinska, et al.

</span>
<span class="ltx_bibblock">Overcoming catastrophic forgetting in neural networks.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib40.1.1">Proceedings of the national academy of sciences</em>, 114(13):3521–3526, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib41">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kolesnikov et al. [2020]</span>
<span class="ltx_bibblock">
A. Kolesnikov, L. Beyer, X. Zhai, J. Puigcerver, J. Yung, S. Gelly, and N. Houlsby.

</span>
<span class="ltx_bibblock">Big transfer (bit): General visual representation learning.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib41.1.1">Arxiv preprint arxiv:1912.11370</em>, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib42">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Koren [2024]</span>
<span class="ltx_bibblock">
M. Koren.

</span>
<span class="ltx_bibblock">The gatekeeper effect: The implications of pre-screening, self-selection, and bias for hiring processes.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib42.1.1">Management Science</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib43">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kornblith et al. [2019]</span>
<span class="ltx_bibblock">
S. Kornblith, J. Shlens, and Q. V. Le.

</span>
<span class="ltx_bibblock">Do better imagenet models transfer better?

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib43.1.1">2019 IEEE/CVF Conference on Computer Vision and Pattern Recognition (CVPR)</em>, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib44">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Krizhevsky et al. [2009]</span>
<span class="ltx_bibblock">
A. Krizhevsky, G. Hinton, et al.

</span>
<span class="ltx_bibblock">Learning multiple layers of features from tiny images.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib44.1.1">Toronto, ON, Canada</em>, 2009.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib45">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kumar et al. [2022]</span>
<span class="ltx_bibblock">
A. Kumar, A. Raghunathan, R. M. Jones, T. Ma, and P. Liang.

</span>
<span class="ltx_bibblock">Fine-tuning can distort pretrained features and underperform out-of-distribution.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib45.1.1">International Conference on Learning Representations</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib46">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. [2022]</span>
<span class="ltx_bibblock">
Q. Li, C.-Y. Yau, and H.-T. Wai.

</span>
<span class="ltx_bibblock">Multi-agent performative prediction with greedy deployment and consensus seeking agents.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib46.1.1">Advances in Neural Information Processing Systems (NeurIPS)</em>, volume 35, pages 38449–38460, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib47">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liang et al. [2020]</span>
<span class="ltx_bibblock">
P. P. Liang, T. Liu, L. Ziyin, N. B. Allen, R. P. Auerbach, D. Brent, R. Salakhutdinov, and L.-P. Morency.

</span>
<span class="ltx_bibblock">Think locally, act globally: Federated learning with local and global representations.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib47.1.1">ArXiv preprint arXiv:2001.01523</em>, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib48">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lipton et al. [2018]</span>
<span class="ltx_bibblock">
Z. Lipton, Y.-X. Wang, and A. Smola.

</span>
<span class="ltx_bibblock">Detecting and correcting for label shift with black box predictors.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib48.1.1">International conference on machine learning</em>, pages 3122–3130, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib49">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al. [2018]</span>
<span class="ltx_bibblock">
L. T. Liu, S. Dean, E. Rolf, M. Simchowitz, and M. Hardt.

</span>
<span class="ltx_bibblock">Delayed impact of fair machine learning.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib49.1.1">International Conference on Machine Learning</em>, pages 3150–3158. PMLR, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib50">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al. [2021a]</span>
<span class="ltx_bibblock">
X. Liu, Z. Guo, S. Li, F. Xing, J. You, C.-C. J. Kuo, G. El Fakhri, and J. Woo.

</span>
<span class="ltx_bibblock">Adversarial unsupervised domain adaptation with conditional and label shift: Infer, align and iterate.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib50.1.1">Proceedings of the IEEE/CVF international conference on computer vision</em>, pages 10367–10376, 2021a.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib51">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al. [2022]</span>
<span class="ltx_bibblock">
X. Liu, K. Ji, Y. Fu, W. L. Tam, Z. Du, Z. Yang, and J. Tang.

</span>
<span class="ltx_bibblock">P-tuning v2: Prompt tuning can be comparable to fine-tuning universally across scales and tasks.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib51.1.1">Arvix preprint arxiv:2110.07602</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib52">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al. [2021b]</span>
<span class="ltx_bibblock">
Y. Liu, P. Kothari, B. G. van Delft, B. Bellot-Gurlet, T. Mordan, and A. Alahi.

</span>
<span class="ltx_bibblock">TTT++: When does self-supervised test-time training fail or thrive?

</span>
<span class="ltx_bibblock">In A. Beygelzimer, Y. Dauphin, P. Liang, and J. W. Vaughan, editors, <em class="ltx_emph ltx_font_italic" id="bib.bib52.1.1">Advances in Neural Information Processing Systems</em>, 2021b.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib53">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al. [2019]</span>
<span class="ltx_bibblock">
Z. Liu, Z. Miao, X. Zhan, J. Wang, B. Gong, and S. X. Yu.

</span>
<span class="ltx_bibblock">Large-scale long-tailed recognition in an open world.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib53.1.1">Proceedings of the IEEE/CVF conference on computer vision and pattern recognition</em>, pages 2537–2546, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib54">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Manski [1993]</span>
<span class="ltx_bibblock">
C. F. Manski.

</span>
<span class="ltx_bibblock">Identification of endogenous social effects: The reflection problem.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib54.1.1">The Review of Economic Studies</em>, 60(3):531–542, 1993.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib55">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Manski and Lerman [1977]</span>
<span class="ltx_bibblock">
C. F. Manski and S. R. Lerman.

</span>
<span class="ltx_bibblock">The estimation of choice probabilities from choice based samples.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib55.1.1">Econometrica: Journal of the Econometric Society</em>, pages 1977–1988, 1977.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib56">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mendler-Dünner et al. [2022]</span>
<span class="ltx_bibblock">
C. Mendler-Dünner, F. Ding, and Y. Wang.

</span>
<span class="ltx_bibblock">Anticipating performativity by predicting from predictions.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib56.1.1">Advances in Neural Information Processing Systems</em>, volume 35, pages 31171–31185, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib57">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Menon et al. [2021]</span>
<span class="ltx_bibblock">
A. K. Menon, S. Jayasumana, A. S. Rawat, H. Jain, A. Veit, and S. Kumar.

</span>
<span class="ltx_bibblock">Long-tail learning via logit adjustment.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib57.1.1">International Conference on Learning Representations</em>, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib58">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mi et al. [2020]</span>
<span class="ltx_bibblock">
F. Mi, L. Kong, T. Lin, K. Yu, and B. Faltings.

</span>
<span class="ltx_bibblock">Generalized class incremental learning.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib58.1.1">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition (CVPR) Workshops</em>, June 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib59">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Miller et al. [2021]</span>
<span class="ltx_bibblock">
J. P. Miller, J. C. Perdomo, and T. Zrnic.

</span>
<span class="ltx_bibblock">Outside the echo chamber: Optimizing the performative risk.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib59.1.1">International Conference on Machine Learning</em>, pages 7710–7720, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib60">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ni et al. [2019]</span>
<span class="ltx_bibblock">
J. Ni, J. Li, and J. McAuley.

</span>
<span class="ltx_bibblock">Justifying recommendations using distantly-labeled reviews and fine-grained aspects.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib60.1.1">Proceedings of the 2019 conference on empirical methods in natural language processing and the 9th international joint conference on natural language processing (EMNLP-IJCNLP)</em>, pages 188–197, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib61">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Nie et al. [2020]</span>
<span class="ltx_bibblock">
Y. Nie, A. Williams, E. Dinan, M. Bansal, J. Weston, and D. Kiela.

</span>
<span class="ltx_bibblock">Adversarial NLI: A new benchmark for natural language understanding.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib61.1.1">Proceedings of the 58th Annual Meeting of the Association for Computational Linguistics</em>, pages 4885–4901, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib62">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Paszke et al. [2019]</span>
<span class="ltx_bibblock">
A. Paszke, S. Gross, F. Massa, A. Lerer, J. Bradbury, G. Chanan, T. Killeen, Z. Lin, N. Gimelshein, L. Antiga, et al.

</span>
<span class="ltx_bibblock">Pytorch: An imperative style, high-performance deep learning library.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib62.1.1">Advances in neural information processing systems</em>, 32, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib63">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Perdomo et al. [2020]</span>
<span class="ltx_bibblock">
J. Perdomo, T. Zrnic, C. Mendler-Dünner, and M. Hardt.

</span>
<span class="ltx_bibblock">Performative prediction.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib63.1.1">Proceedings of the 37th International Conference on Machine Learning</em>, volume 119, pages 7599–7609, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib64">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Peters et al. [2017]</span>
<span class="ltx_bibblock">
J. Peters, D. Janzing, and B. Schölkopf.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib64.1.1">Elements of Causal Inference: Foundations and Learning Algorithms</em>.

</span>
<span class="ltx_bibblock">MIT Press, Cambridge, MA, USA, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib65">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Radford et al. [2021]</span>
<span class="ltx_bibblock">
A. Radford, J. W. Kim, C. Hallacy, A. Ramesh, G. Goh, S. Agarwal, G. Sastry, A. Askell, P. Mishkin, J. Clark, G. Krueger, and I. Sutskever.

</span>
<span class="ltx_bibblock">Learning transferable visual models from natural language supervision.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib65.1.1">Proceedings of the 38th International Conference on Machine Learning</em>, pages 8748–8763, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib66">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Recht et al. [2019]</span>
<span class="ltx_bibblock">
B. Recht, R. Roelofs, L. Schmidt, and V. Shankar.

</span>
<span class="ltx_bibblock">Do ImageNet classifiers generalize to ImageNet?

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib66.1.1">Proceedings of the 36th International Conference on Machine Learning</em>, pages 5389–5400, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib67">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rosenfeld et al. [2022]</span>
<span class="ltx_bibblock">
E. Rosenfeld, P. Ravikumar, and A. Risteski.

</span>
<span class="ltx_bibblock">Domain-adjusted regression or: Erm may already learn features sufficient for out-of-distribution generalization.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib67.1.1">Arxiv preprint arxiv:2202.06856</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib68">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Royer and Lampert [2015]</span>
<span class="ltx_bibblock">
A. Royer and C. H. Lampert.

</span>
<span class="ltx_bibblock">Classifier adaptation at prediction time.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib68.1.1">Proceedings of the IEEE Conference on Computer Vision and Pattern Recognition</em>, pages 1401–1409, 2015.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib69">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Saerens et al. [2002]</span>
<span class="ltx_bibblock">
M. Saerens, P. Latinne, and C. Decaestecker.

</span>
<span class="ltx_bibblock">Adjusting the outputs of a classifier to new a priori probabilities: a simple procedure.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib69.1.1">Neural computation</em>, 14(1):21–41, 2002.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib70">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Schölkopf et al. [2021]</span>
<span class="ltx_bibblock">
B. Schölkopf, F. Locatello, S. Bauer, N. R. Ke, N. Kalchbrenner, A. Goyal, and Y. Bengio.

</span>
<span class="ltx_bibblock">Toward causal representation learning.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib70.1.1">Proceedings of the IEEE</em>, 109(5):612–634, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib71">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Settles [2009]</span>
<span class="ltx_bibblock">
B. Settles.

</span>
<span class="ltx_bibblock">Active learning literature survey.

</span>
<span class="ltx_bibblock">Computer Sciences Technical Report 1648, 2009.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib72">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shi et al. [2023]</span>
<span class="ltx_bibblock">
J.-X. Shi, T. Wei, Y. Xiang, and Y.-F. Li.

</span>
<span class="ltx_bibblock">How re-sampling helps for long-tail learning?

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib72.1.1">Advances in Neural Information Processing Systems</em>, 36, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib73">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shirali et al. [2023]</span>
<span class="ltx_bibblock">
A. Shirali, R. Abebe, and M. Hardt.

</span>
<span class="ltx_bibblock">A theory of dynamic benchmarks.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib73.1.1">The Eleventh International Conference on Learning Representations</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib74">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shu et al. [2018]</span>
<span class="ltx_bibblock">
R. Shu, H. H. Bui, H. Narui, and S. Ermon.

</span>
<span class="ltx_bibblock">A dirt-t approach to unsupervised domain adaptation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib74.1.1">Proc. 6th International Conference on Learning Representations</em>, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib75">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Storkey et al. [2008]</span>
<span class="ltx_bibblock">
A. Storkey, J. Quiñonero-Candela, M. Sugiyama, A. Schwaighofer, and N. Lawrence.

</span>
<span class="ltx_bibblock">When training and test sets are different: Characterizing learning transfer.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib75.1.1">Dataset Shift in Machine Learning</em>, pages 3–28. Yale University Press in association with the Museum of London, 2008.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib76">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sun and Saenko [2016]</span>
<span class="ltx_bibblock">
B. Sun and K. Saenko.

</span>
<span class="ltx_bibblock">Deep coral: Correlation alignment for deep domain adaptation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib76.1.1">European Conference on Computer Vision</em>, pages 443–450. Springer, 2016.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib77">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sun et al. [2020]</span>
<span class="ltx_bibblock">
Y. Sun, X. Wang, Z. Liu, J. Miller, A. Efros, and M. Hardt.

</span>
<span class="ltx_bibblock">Test-time training with self-supervision for generalization under distribution shifts.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib77.1.1">International Conference on Machine Learning</em>, pages 9229–9248. PMLR, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib78">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Taori and Hashimoto [2023]</span>
<span class="ltx_bibblock">
R. Taori and T. Hashimoto.

</span>
<span class="ltx_bibblock">Data feedback loops: Model-driven amplification of dataset biases.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib78.1.1">International Conference on Machine Learning</em>, pages 33883–33920. PMLR, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib79">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Taori et al. [2020]</span>
<span class="ltx_bibblock">
R. Taori, A. Dave, V. Shankar, N. Carlini, B. Recht, and L. Schmidt.

</span>
<span class="ltx_bibblock">Measuring robustness to natural distribution shifts in image classification.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib79.1.1">Advances in Neural Information Processing Systems</em>, volume 33, pages 18583–18599, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib80">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. [2021]</span>
<span class="ltx_bibblock">
D. Wang, E. Shelhamer, S. Liu, B. Olshausen, and T. Darrell.

</span>
<span class="ltx_bibblock">Tent: Fully test-time adaptation by entropy minimization.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib80.1.1">International Conference on Learning Representations</em>, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib81">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. [2024]</span>
<span class="ltx_bibblock">
L. Wang, X. Zhang, H. Su, and J. Zhu.

</span>
<span class="ltx_bibblock">A comprehensive survey of continual learning: theory, method and application.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib81.1.1">IEEE Transactions on Pattern Analysis and Machine Intelligence</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib82">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wyllie et al. [2024]</span>
<span class="ltx_bibblock">
S. Wyllie, I. Shumailov, and N. Papernot.

</span>
<span class="ltx_bibblock">Fairness feedback loops: Training on synthetic data amplifies bias.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib82.1.1">ACM Conference on Fairness, Accountability, and Transparency</em>, page 2113–2147, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib83">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhai et al. [2020]</span>
<span class="ltx_bibblock">
X. Zhai, J. Puigcerver, A. Kolesnikov, P. Ruyssen, C. Riquelme, M. Lucic, J. Djolonga, A. S. Pinto, M. Neumann, A. Dosovitskiy, L. Beyer, O. Bachem, M. Tschannen, M. Michalski, O. Bousquet, S. Gelly, and N. Houlsby.

</span>
<span class="ltx_bibblock">A large-scale study of representation learning with the visual task adaptation benchmark.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib83.1.1">Arxiv preprint arxiv:1910.04867</em>, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib84">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al. [2013]</span>
<span class="ltx_bibblock">
K. Zhang, B. Schölkopf, K. Muandet, and Z. Wang.

</span>
<span class="ltx_bibblock">Domain adaptation under target and conditional shift.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib84.1.1">International Conference on Machine Learning</em>, pages 819–827, 2013.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib85">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al. [2015]</span>
<span class="ltx_bibblock">
X. Zhang, J. Zhao, and Y. LeCun.

</span>
<span class="ltx_bibblock">Character-level convolutional networks for text classification.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib85.1.1">Advances in neural information processing systems</em>, 28, 2015.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib86">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al. [2023]</span>
<span class="ltx_bibblock">
Y. Zhang, B. Kang, B. Hooi, S. Yan, and J. Feng.

</span>
<span class="ltx_bibblock">Deep long-tailed learning: A survey.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib86.1.1">IEEE Transactions on Pattern Analysis and Machine Intelligence</em>, 45(9):10795–10816, 2023.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.1109/TPAMI.2023.3268118</span>.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<div class="ltx_pagination ltx_role_newpage"></div>
<section class="ltx_appendix" id="A1">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Appendix</h2>
<section class="ltx_subsection" id="A1.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.1 </span>Implementation Details</h3>
<div class="ltx_para" id="A1.SS1.p1">
<p class="ltx_p" id="A1.SS1.p1.1">Here we report implementation details omitted from the body of the paper due to space limitations. We first give details about the datasets used, then explain training details of our approach.</p>
</div>
<figure class="ltx_table" id="A1.T2">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="A1.T2.22.1.1" style="font-size:90%;">Table 2</span>: </span><span class="ltx_text" id="A1.T2.23.2" style="font-size:90%;">Hyperparameter Configurations for Different Datasets</span></figcaption>
<table class="ltx_tabular ltx_align_middle" id="A1.T2.20">
<tr class="ltx_tr" id="A1.T2.20.21">
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_l ltx_border_r ltx_border_t" id="A1.T2.20.21.1">
<span class="ltx_inline-block ltx_align_top" id="A1.T2.20.21.1.1">
<span class="ltx_p" id="A1.T2.20.21.1.1.1" style="width:51.2pt;"><span class="ltx_text ltx_font_bold" id="A1.T2.20.21.1.1.1.1">Dataset</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="A1.T2.20.21.2">
<span class="ltx_inline-block ltx_align_top" id="A1.T2.20.21.2.1">
<span class="ltx_p" id="A1.T2.20.21.2.1.1" style="width:42.7pt;"><span class="ltx_text ltx_font_bold" id="A1.T2.20.21.2.1.1.1">Backbone</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="A1.T2.20.21.3">
<span class="ltx_inline-block ltx_align_top" id="A1.T2.20.21.3.1">
<span class="ltx_p" id="A1.T2.20.21.3.1.1" style="width:65.4pt;"><span class="ltx_text ltx_font_bold" id="A1.T2.20.21.3.1.1.1">Temperatures</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_border_r ltx_border_t" id="A1.T2.20.21.4">
<span class="ltx_inline-block ltx_align_top" id="A1.T2.20.21.4.1">
<span class="ltx_p" id="A1.T2.20.21.4.1.1"><span class="ltx_text ltx_font_bold" id="A1.T2.20.21.4.1.1.1">Learning Rate</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="A1.T2.20.21.5">
<span class="ltx_inline-block ltx_align_top" id="A1.T2.20.21.5.1">
<span class="ltx_p" id="A1.T2.20.21.5.1.1" style="width:28.5pt;"><span class="ltx_text ltx_font_bold" id="A1.T2.20.21.5.1.1.1">Batch Size</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_border_r ltx_border_t" id="A1.T2.20.21.6">
<span class="ltx_inline-block ltx_align_top" id="A1.T2.20.21.6.1">
<span class="ltx_p" id="A1.T2.20.21.6.1.1"><span class="ltx_text ltx_font_bold" id="A1.T2.20.21.6.1.1.1">Epochs &amp; Rounds</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_border_r ltx_border_t" id="A1.T2.20.21.7">
<span class="ltx_inline-block ltx_align_top" id="A1.T2.20.21.7.1">
<span class="ltx_p" id="A1.T2.20.21.7.1.1"><span class="ltx_text ltx_font_bold" id="A1.T2.20.21.7.1.1.1">Optimizer</span></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A1.T2.4.4">
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_l ltx_border_r ltx_border_t" id="A1.T2.4.4.5">
<span class="ltx_inline-block ltx_align_top" id="A1.T2.4.4.5.1">
<span class="ltx_p" id="A1.T2.4.4.5.1.1" style="width:51.2pt;">CIFAR100</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="A1.T2.4.4.6">
<span class="ltx_inline-block ltx_align_top" id="A1.T2.4.4.6.1">
<span class="ltx_p" id="A1.T2.4.4.6.1.1" style="width:42.7pt;">ResNet18</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="A1.T2.1.1.1">
<span class="ltx_inline-block ltx_align_top" id="A1.T2.1.1.1.1">
<span class="ltx_p" id="A1.T2.1.1.1.1.1" style="width:65.4pt;"><math alttext="0.1/0.3/0.5" class="ltx_Math" display="inline" id="A1.T2.1.1.1.1.1.m1.1"><semantics id="A1.T2.1.1.1.1.1.m1.1a"><mrow id="A1.T2.1.1.1.1.1.m1.1.1" xref="A1.T2.1.1.1.1.1.m1.1.1.cmml"><mn id="A1.T2.1.1.1.1.1.m1.1.1.2" xref="A1.T2.1.1.1.1.1.m1.1.1.2.cmml">0.1</mn><mo id="A1.T2.1.1.1.1.1.m1.1.1.1" xref="A1.T2.1.1.1.1.1.m1.1.1.1.cmml">/</mo><mn id="A1.T2.1.1.1.1.1.m1.1.1.3" xref="A1.T2.1.1.1.1.1.m1.1.1.3.cmml">0.3</mn><mo id="A1.T2.1.1.1.1.1.m1.1.1.1a" xref="A1.T2.1.1.1.1.1.m1.1.1.1.cmml">/</mo><mn id="A1.T2.1.1.1.1.1.m1.1.1.4" xref="A1.T2.1.1.1.1.1.m1.1.1.4.cmml">0.5</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.T2.1.1.1.1.1.m1.1b"><apply id="A1.T2.1.1.1.1.1.m1.1.1.cmml" xref="A1.T2.1.1.1.1.1.m1.1.1"><divide id="A1.T2.1.1.1.1.1.m1.1.1.1.cmml" xref="A1.T2.1.1.1.1.1.m1.1.1.1"></divide><cn id="A1.T2.1.1.1.1.1.m1.1.1.2.cmml" type="float" xref="A1.T2.1.1.1.1.1.m1.1.1.2">0.1</cn><cn id="A1.T2.1.1.1.1.1.m1.1.1.3.cmml" type="float" xref="A1.T2.1.1.1.1.1.m1.1.1.3">0.3</cn><cn id="A1.T2.1.1.1.1.1.m1.1.1.4.cmml" type="float" xref="A1.T2.1.1.1.1.1.m1.1.1.4">0.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T2.1.1.1.1.1.m1.1c">0.1/0.3/0.5</annotation><annotation encoding="application/x-llamapun" id="A1.T2.1.1.1.1.1.m1.1d">0.1 / 0.3 / 0.5</annotation></semantics></math></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_border_r ltx_border_t" id="A1.T2.2.2.2">
<span class="ltx_inline-block ltx_align_top" id="A1.T2.2.2.2.1">
<span class="ltx_p" id="A1.T2.2.2.2.1.1"><math alttext="1e-3" class="ltx_Math" display="inline" id="A1.T2.2.2.2.1.1.m1.1"><semantics id="A1.T2.2.2.2.1.1.m1.1a"><mrow id="A1.T2.2.2.2.1.1.m1.1.1" xref="A1.T2.2.2.2.1.1.m1.1.1.cmml"><mrow id="A1.T2.2.2.2.1.1.m1.1.1.2" xref="A1.T2.2.2.2.1.1.m1.1.1.2.cmml"><mn id="A1.T2.2.2.2.1.1.m1.1.1.2.2" xref="A1.T2.2.2.2.1.1.m1.1.1.2.2.cmml">1</mn><mo id="A1.T2.2.2.2.1.1.m1.1.1.2.1" xref="A1.T2.2.2.2.1.1.m1.1.1.2.1.cmml">⁢</mo><mi id="A1.T2.2.2.2.1.1.m1.1.1.2.3" xref="A1.T2.2.2.2.1.1.m1.1.1.2.3.cmml">e</mi></mrow><mo id="A1.T2.2.2.2.1.1.m1.1.1.1" xref="A1.T2.2.2.2.1.1.m1.1.1.1.cmml">−</mo><mn id="A1.T2.2.2.2.1.1.m1.1.1.3" xref="A1.T2.2.2.2.1.1.m1.1.1.3.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.T2.2.2.2.1.1.m1.1b"><apply id="A1.T2.2.2.2.1.1.m1.1.1.cmml" xref="A1.T2.2.2.2.1.1.m1.1.1"><minus id="A1.T2.2.2.2.1.1.m1.1.1.1.cmml" xref="A1.T2.2.2.2.1.1.m1.1.1.1"></minus><apply id="A1.T2.2.2.2.1.1.m1.1.1.2.cmml" xref="A1.T2.2.2.2.1.1.m1.1.1.2"><times id="A1.T2.2.2.2.1.1.m1.1.1.2.1.cmml" xref="A1.T2.2.2.2.1.1.m1.1.1.2.1"></times><cn id="A1.T2.2.2.2.1.1.m1.1.1.2.2.cmml" type="integer" xref="A1.T2.2.2.2.1.1.m1.1.1.2.2">1</cn><ci id="A1.T2.2.2.2.1.1.m1.1.1.2.3.cmml" xref="A1.T2.2.2.2.1.1.m1.1.1.2.3">𝑒</ci></apply><cn id="A1.T2.2.2.2.1.1.m1.1.1.3.cmml" type="integer" xref="A1.T2.2.2.2.1.1.m1.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T2.2.2.2.1.1.m1.1c">1e-3</annotation><annotation encoding="application/x-llamapun" id="A1.T2.2.2.2.1.1.m1.1d">1 italic_e - 3</annotation></semantics></math></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="A1.T2.3.3.3">
<span class="ltx_inline-block ltx_align_top" id="A1.T2.3.3.3.1">
<span class="ltx_p" id="A1.T2.3.3.3.1.1" style="width:28.5pt;"><math alttext="16" class="ltx_Math" display="inline" id="A1.T2.3.3.3.1.1.m1.1"><semantics id="A1.T2.3.3.3.1.1.m1.1a"><mn id="A1.T2.3.3.3.1.1.m1.1.1" xref="A1.T2.3.3.3.1.1.m1.1.1.cmml">16</mn><annotation-xml encoding="MathML-Content" id="A1.T2.3.3.3.1.1.m1.1b"><cn id="A1.T2.3.3.3.1.1.m1.1.1.cmml" type="integer" xref="A1.T2.3.3.3.1.1.m1.1.1">16</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T2.3.3.3.1.1.m1.1c">16</annotation><annotation encoding="application/x-llamapun" id="A1.T2.3.3.3.1.1.m1.1d">16</annotation></semantics></math></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_border_r ltx_border_t" id="A1.T2.4.4.4">
<span class="ltx_inline-block ltx_align_top" id="A1.T2.4.4.4.1">
<span class="ltx_p" id="A1.T2.4.4.4.1.1"><math alttext="25/200" class="ltx_Math" display="inline" id="A1.T2.4.4.4.1.1.m1.1"><semantics id="A1.T2.4.4.4.1.1.m1.1a"><mrow id="A1.T2.4.4.4.1.1.m1.1.1" xref="A1.T2.4.4.4.1.1.m1.1.1.cmml"><mn id="A1.T2.4.4.4.1.1.m1.1.1.2" xref="A1.T2.4.4.4.1.1.m1.1.1.2.cmml">25</mn><mo id="A1.T2.4.4.4.1.1.m1.1.1.1" xref="A1.T2.4.4.4.1.1.m1.1.1.1.cmml">/</mo><mn id="A1.T2.4.4.4.1.1.m1.1.1.3" xref="A1.T2.4.4.4.1.1.m1.1.1.3.cmml">200</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.T2.4.4.4.1.1.m1.1b"><apply id="A1.T2.4.4.4.1.1.m1.1.1.cmml" xref="A1.T2.4.4.4.1.1.m1.1.1"><divide id="A1.T2.4.4.4.1.1.m1.1.1.1.cmml" xref="A1.T2.4.4.4.1.1.m1.1.1.1"></divide><cn id="A1.T2.4.4.4.1.1.m1.1.1.2.cmml" type="integer" xref="A1.T2.4.4.4.1.1.m1.1.1.2">25</cn><cn id="A1.T2.4.4.4.1.1.m1.1.1.3.cmml" type="integer" xref="A1.T2.4.4.4.1.1.m1.1.1.3">200</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T2.4.4.4.1.1.m1.1c">25/200</annotation><annotation encoding="application/x-llamapun" id="A1.T2.4.4.4.1.1.m1.1d">25 / 200</annotation></semantics></math></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_border_r ltx_border_t" id="A1.T2.4.4.7">
<span class="ltx_inline-block ltx_align_top" id="A1.T2.4.4.7.1">
<span class="ltx_p" id="A1.T2.4.4.7.1.1">SGD</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A1.T2.8.8">
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_l ltx_border_r ltx_border_t" id="A1.T2.8.8.5">
<span class="ltx_inline-block ltx_align_top" id="A1.T2.8.8.5.1">
<span class="ltx_p" id="A1.T2.8.8.5.1.1" style="width:51.2pt;">ImageNet100</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="A1.T2.8.8.6">
<span class="ltx_inline-block ltx_align_top" id="A1.T2.8.8.6.1">
<span class="ltx_p" id="A1.T2.8.8.6.1.1" style="width:42.7pt;">ResNet18</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="A1.T2.5.5.1">
<span class="ltx_inline-block ltx_align_top" id="A1.T2.5.5.1.1">
<span class="ltx_p" id="A1.T2.5.5.1.1.1" style="width:65.4pt;"><math alttext="0.1/0.3/0.6" class="ltx_Math" display="inline" id="A1.T2.5.5.1.1.1.m1.1"><semantics id="A1.T2.5.5.1.1.1.m1.1a"><mrow id="A1.T2.5.5.1.1.1.m1.1.1" xref="A1.T2.5.5.1.1.1.m1.1.1.cmml"><mn id="A1.T2.5.5.1.1.1.m1.1.1.2" xref="A1.T2.5.5.1.1.1.m1.1.1.2.cmml">0.1</mn><mo id="A1.T2.5.5.1.1.1.m1.1.1.1" xref="A1.T2.5.5.1.1.1.m1.1.1.1.cmml">/</mo><mn id="A1.T2.5.5.1.1.1.m1.1.1.3" xref="A1.T2.5.5.1.1.1.m1.1.1.3.cmml">0.3</mn><mo id="A1.T2.5.5.1.1.1.m1.1.1.1a" xref="A1.T2.5.5.1.1.1.m1.1.1.1.cmml">/</mo><mn id="A1.T2.5.5.1.1.1.m1.1.1.4" xref="A1.T2.5.5.1.1.1.m1.1.1.4.cmml">0.6</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.T2.5.5.1.1.1.m1.1b"><apply id="A1.T2.5.5.1.1.1.m1.1.1.cmml" xref="A1.T2.5.5.1.1.1.m1.1.1"><divide id="A1.T2.5.5.1.1.1.m1.1.1.1.cmml" xref="A1.T2.5.5.1.1.1.m1.1.1.1"></divide><cn id="A1.T2.5.5.1.1.1.m1.1.1.2.cmml" type="float" xref="A1.T2.5.5.1.1.1.m1.1.1.2">0.1</cn><cn id="A1.T2.5.5.1.1.1.m1.1.1.3.cmml" type="float" xref="A1.T2.5.5.1.1.1.m1.1.1.3">0.3</cn><cn id="A1.T2.5.5.1.1.1.m1.1.1.4.cmml" type="float" xref="A1.T2.5.5.1.1.1.m1.1.1.4">0.6</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T2.5.5.1.1.1.m1.1c">0.1/0.3/0.6</annotation><annotation encoding="application/x-llamapun" id="A1.T2.5.5.1.1.1.m1.1d">0.1 / 0.3 / 0.6</annotation></semantics></math></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_border_r ltx_border_t" id="A1.T2.6.6.2">
<span class="ltx_inline-block ltx_align_top" id="A1.T2.6.6.2.1">
<span class="ltx_p" id="A1.T2.6.6.2.1.1"><math alttext="1e-3" class="ltx_Math" display="inline" id="A1.T2.6.6.2.1.1.m1.1"><semantics id="A1.T2.6.6.2.1.1.m1.1a"><mrow id="A1.T2.6.6.2.1.1.m1.1.1" xref="A1.T2.6.6.2.1.1.m1.1.1.cmml"><mrow id="A1.T2.6.6.2.1.1.m1.1.1.2" xref="A1.T2.6.6.2.1.1.m1.1.1.2.cmml"><mn id="A1.T2.6.6.2.1.1.m1.1.1.2.2" xref="A1.T2.6.6.2.1.1.m1.1.1.2.2.cmml">1</mn><mo id="A1.T2.6.6.2.1.1.m1.1.1.2.1" xref="A1.T2.6.6.2.1.1.m1.1.1.2.1.cmml">⁢</mo><mi id="A1.T2.6.6.2.1.1.m1.1.1.2.3" xref="A1.T2.6.6.2.1.1.m1.1.1.2.3.cmml">e</mi></mrow><mo id="A1.T2.6.6.2.1.1.m1.1.1.1" xref="A1.T2.6.6.2.1.1.m1.1.1.1.cmml">−</mo><mn id="A1.T2.6.6.2.1.1.m1.1.1.3" xref="A1.T2.6.6.2.1.1.m1.1.1.3.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.T2.6.6.2.1.1.m1.1b"><apply id="A1.T2.6.6.2.1.1.m1.1.1.cmml" xref="A1.T2.6.6.2.1.1.m1.1.1"><minus id="A1.T2.6.6.2.1.1.m1.1.1.1.cmml" xref="A1.T2.6.6.2.1.1.m1.1.1.1"></minus><apply id="A1.T2.6.6.2.1.1.m1.1.1.2.cmml" xref="A1.T2.6.6.2.1.1.m1.1.1.2"><times id="A1.T2.6.6.2.1.1.m1.1.1.2.1.cmml" xref="A1.T2.6.6.2.1.1.m1.1.1.2.1"></times><cn id="A1.T2.6.6.2.1.1.m1.1.1.2.2.cmml" type="integer" xref="A1.T2.6.6.2.1.1.m1.1.1.2.2">1</cn><ci id="A1.T2.6.6.2.1.1.m1.1.1.2.3.cmml" xref="A1.T2.6.6.2.1.1.m1.1.1.2.3">𝑒</ci></apply><cn id="A1.T2.6.6.2.1.1.m1.1.1.3.cmml" type="integer" xref="A1.T2.6.6.2.1.1.m1.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T2.6.6.2.1.1.m1.1c">1e-3</annotation><annotation encoding="application/x-llamapun" id="A1.T2.6.6.2.1.1.m1.1d">1 italic_e - 3</annotation></semantics></math></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="A1.T2.7.7.3">
<span class="ltx_inline-block ltx_align_top" id="A1.T2.7.7.3.1">
<span class="ltx_p" id="A1.T2.7.7.3.1.1" style="width:28.5pt;"><math alttext="16" class="ltx_Math" display="inline" id="A1.T2.7.7.3.1.1.m1.1"><semantics id="A1.T2.7.7.3.1.1.m1.1a"><mn id="A1.T2.7.7.3.1.1.m1.1.1" xref="A1.T2.7.7.3.1.1.m1.1.1.cmml">16</mn><annotation-xml encoding="MathML-Content" id="A1.T2.7.7.3.1.1.m1.1b"><cn id="A1.T2.7.7.3.1.1.m1.1.1.cmml" type="integer" xref="A1.T2.7.7.3.1.1.m1.1.1">16</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T2.7.7.3.1.1.m1.1c">16</annotation><annotation encoding="application/x-llamapun" id="A1.T2.7.7.3.1.1.m1.1d">16</annotation></semantics></math></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_border_r ltx_border_t" id="A1.T2.8.8.4">
<span class="ltx_inline-block ltx_align_top" id="A1.T2.8.8.4.1">
<span class="ltx_p" id="A1.T2.8.8.4.1.1"><math alttext="25/200" class="ltx_Math" display="inline" id="A1.T2.8.8.4.1.1.m1.1"><semantics id="A1.T2.8.8.4.1.1.m1.1a"><mrow id="A1.T2.8.8.4.1.1.m1.1.1" xref="A1.T2.8.8.4.1.1.m1.1.1.cmml"><mn id="A1.T2.8.8.4.1.1.m1.1.1.2" xref="A1.T2.8.8.4.1.1.m1.1.1.2.cmml">25</mn><mo id="A1.T2.8.8.4.1.1.m1.1.1.1" xref="A1.T2.8.8.4.1.1.m1.1.1.1.cmml">/</mo><mn id="A1.T2.8.8.4.1.1.m1.1.1.3" xref="A1.T2.8.8.4.1.1.m1.1.1.3.cmml">200</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.T2.8.8.4.1.1.m1.1b"><apply id="A1.T2.8.8.4.1.1.m1.1.1.cmml" xref="A1.T2.8.8.4.1.1.m1.1.1"><divide id="A1.T2.8.8.4.1.1.m1.1.1.1.cmml" xref="A1.T2.8.8.4.1.1.m1.1.1.1"></divide><cn id="A1.T2.8.8.4.1.1.m1.1.1.2.cmml" type="integer" xref="A1.T2.8.8.4.1.1.m1.1.1.2">25</cn><cn id="A1.T2.8.8.4.1.1.m1.1.1.3.cmml" type="integer" xref="A1.T2.8.8.4.1.1.m1.1.1.3">200</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T2.8.8.4.1.1.m1.1c">25/200</annotation><annotation encoding="application/x-llamapun" id="A1.T2.8.8.4.1.1.m1.1d">25 / 200</annotation></semantics></math></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_border_r ltx_border_t" id="A1.T2.8.8.7">
<span class="ltx_inline-block ltx_align_top" id="A1.T2.8.8.7.1">
<span class="ltx_p" id="A1.T2.8.8.7.1.1">SGD</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A1.T2.12.12">
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_l ltx_border_r ltx_border_t" id="A1.T2.12.12.5">
<span class="ltx_inline-block ltx_align_top" id="A1.T2.12.12.5.1">
<span class="ltx_p" id="A1.T2.12.12.5.1.1" style="width:51.2pt;">TerraIncognita</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="A1.T2.12.12.6">
<span class="ltx_inline-block ltx_align_top" id="A1.T2.12.12.6.1">
<span class="ltx_p" id="A1.T2.12.12.6.1.1" style="width:42.7pt;">ResNet18</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="A1.T2.9.9.1">
<span class="ltx_inline-block ltx_align_top" id="A1.T2.9.9.1.1">
<span class="ltx_p" id="A1.T2.9.9.1.1.1" style="width:65.4pt;"><math alttext="0.1/0.2/0.8" class="ltx_Math" display="inline" id="A1.T2.9.9.1.1.1.m1.1"><semantics id="A1.T2.9.9.1.1.1.m1.1a"><mrow id="A1.T2.9.9.1.1.1.m1.1.1" xref="A1.T2.9.9.1.1.1.m1.1.1.cmml"><mn id="A1.T2.9.9.1.1.1.m1.1.1.2" xref="A1.T2.9.9.1.1.1.m1.1.1.2.cmml">0.1</mn><mo id="A1.T2.9.9.1.1.1.m1.1.1.1" xref="A1.T2.9.9.1.1.1.m1.1.1.1.cmml">/</mo><mn id="A1.T2.9.9.1.1.1.m1.1.1.3" xref="A1.T2.9.9.1.1.1.m1.1.1.3.cmml">0.2</mn><mo id="A1.T2.9.9.1.1.1.m1.1.1.1a" xref="A1.T2.9.9.1.1.1.m1.1.1.1.cmml">/</mo><mn id="A1.T2.9.9.1.1.1.m1.1.1.4" xref="A1.T2.9.9.1.1.1.m1.1.1.4.cmml">0.8</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.T2.9.9.1.1.1.m1.1b"><apply id="A1.T2.9.9.1.1.1.m1.1.1.cmml" xref="A1.T2.9.9.1.1.1.m1.1.1"><divide id="A1.T2.9.9.1.1.1.m1.1.1.1.cmml" xref="A1.T2.9.9.1.1.1.m1.1.1.1"></divide><cn id="A1.T2.9.9.1.1.1.m1.1.1.2.cmml" type="float" xref="A1.T2.9.9.1.1.1.m1.1.1.2">0.1</cn><cn id="A1.T2.9.9.1.1.1.m1.1.1.3.cmml" type="float" xref="A1.T2.9.9.1.1.1.m1.1.1.3">0.2</cn><cn id="A1.T2.9.9.1.1.1.m1.1.1.4.cmml" type="float" xref="A1.T2.9.9.1.1.1.m1.1.1.4">0.8</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T2.9.9.1.1.1.m1.1c">0.1/0.2/0.8</annotation><annotation encoding="application/x-llamapun" id="A1.T2.9.9.1.1.1.m1.1d">0.1 / 0.2 / 0.8</annotation></semantics></math></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_border_r ltx_border_t" id="A1.T2.10.10.2">
<span class="ltx_inline-block ltx_align_top" id="A1.T2.10.10.2.1">
<span class="ltx_p" id="A1.T2.10.10.2.1.1"><math alttext="1e-3" class="ltx_Math" display="inline" id="A1.T2.10.10.2.1.1.m1.1"><semantics id="A1.T2.10.10.2.1.1.m1.1a"><mrow id="A1.T2.10.10.2.1.1.m1.1.1" xref="A1.T2.10.10.2.1.1.m1.1.1.cmml"><mrow id="A1.T2.10.10.2.1.1.m1.1.1.2" xref="A1.T2.10.10.2.1.1.m1.1.1.2.cmml"><mn id="A1.T2.10.10.2.1.1.m1.1.1.2.2" xref="A1.T2.10.10.2.1.1.m1.1.1.2.2.cmml">1</mn><mo id="A1.T2.10.10.2.1.1.m1.1.1.2.1" xref="A1.T2.10.10.2.1.1.m1.1.1.2.1.cmml">⁢</mo><mi id="A1.T2.10.10.2.1.1.m1.1.1.2.3" xref="A1.T2.10.10.2.1.1.m1.1.1.2.3.cmml">e</mi></mrow><mo id="A1.T2.10.10.2.1.1.m1.1.1.1" xref="A1.T2.10.10.2.1.1.m1.1.1.1.cmml">−</mo><mn id="A1.T2.10.10.2.1.1.m1.1.1.3" xref="A1.T2.10.10.2.1.1.m1.1.1.3.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.T2.10.10.2.1.1.m1.1b"><apply id="A1.T2.10.10.2.1.1.m1.1.1.cmml" xref="A1.T2.10.10.2.1.1.m1.1.1"><minus id="A1.T2.10.10.2.1.1.m1.1.1.1.cmml" xref="A1.T2.10.10.2.1.1.m1.1.1.1"></minus><apply id="A1.T2.10.10.2.1.1.m1.1.1.2.cmml" xref="A1.T2.10.10.2.1.1.m1.1.1.2"><times id="A1.T2.10.10.2.1.1.m1.1.1.2.1.cmml" xref="A1.T2.10.10.2.1.1.m1.1.1.2.1"></times><cn id="A1.T2.10.10.2.1.1.m1.1.1.2.2.cmml" type="integer" xref="A1.T2.10.10.2.1.1.m1.1.1.2.2">1</cn><ci id="A1.T2.10.10.2.1.1.m1.1.1.2.3.cmml" xref="A1.T2.10.10.2.1.1.m1.1.1.2.3">𝑒</ci></apply><cn id="A1.T2.10.10.2.1.1.m1.1.1.3.cmml" type="integer" xref="A1.T2.10.10.2.1.1.m1.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T2.10.10.2.1.1.m1.1c">1e-3</annotation><annotation encoding="application/x-llamapun" id="A1.T2.10.10.2.1.1.m1.1d">1 italic_e - 3</annotation></semantics></math></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="A1.T2.11.11.3">
<span class="ltx_inline-block ltx_align_top" id="A1.T2.11.11.3.1">
<span class="ltx_p" id="A1.T2.11.11.3.1.1" style="width:28.5pt;"><math alttext="16" class="ltx_Math" display="inline" id="A1.T2.11.11.3.1.1.m1.1"><semantics id="A1.T2.11.11.3.1.1.m1.1a"><mn id="A1.T2.11.11.3.1.1.m1.1.1" xref="A1.T2.11.11.3.1.1.m1.1.1.cmml">16</mn><annotation-xml encoding="MathML-Content" id="A1.T2.11.11.3.1.1.m1.1b"><cn id="A1.T2.11.11.3.1.1.m1.1.1.cmml" type="integer" xref="A1.T2.11.11.3.1.1.m1.1.1">16</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T2.11.11.3.1.1.m1.1c">16</annotation><annotation encoding="application/x-llamapun" id="A1.T2.11.11.3.1.1.m1.1d">16</annotation></semantics></math></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_border_r ltx_border_t" id="A1.T2.12.12.4">
<span class="ltx_inline-block ltx_align_top" id="A1.T2.12.12.4.1">
<span class="ltx_p" id="A1.T2.12.12.4.1.1"><math alttext="25/200" class="ltx_Math" display="inline" id="A1.T2.12.12.4.1.1.m1.1"><semantics id="A1.T2.12.12.4.1.1.m1.1a"><mrow id="A1.T2.12.12.4.1.1.m1.1.1" xref="A1.T2.12.12.4.1.1.m1.1.1.cmml"><mn id="A1.T2.12.12.4.1.1.m1.1.1.2" xref="A1.T2.12.12.4.1.1.m1.1.1.2.cmml">25</mn><mo id="A1.T2.12.12.4.1.1.m1.1.1.1" xref="A1.T2.12.12.4.1.1.m1.1.1.1.cmml">/</mo><mn id="A1.T2.12.12.4.1.1.m1.1.1.3" xref="A1.T2.12.12.4.1.1.m1.1.1.3.cmml">200</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.T2.12.12.4.1.1.m1.1b"><apply id="A1.T2.12.12.4.1.1.m1.1.1.cmml" xref="A1.T2.12.12.4.1.1.m1.1.1"><divide id="A1.T2.12.12.4.1.1.m1.1.1.1.cmml" xref="A1.T2.12.12.4.1.1.m1.1.1.1"></divide><cn id="A1.T2.12.12.4.1.1.m1.1.1.2.cmml" type="integer" xref="A1.T2.12.12.4.1.1.m1.1.1.2">25</cn><cn id="A1.T2.12.12.4.1.1.m1.1.1.3.cmml" type="integer" xref="A1.T2.12.12.4.1.1.m1.1.1.3">200</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T2.12.12.4.1.1.m1.1c">25/200</annotation><annotation encoding="application/x-llamapun" id="A1.T2.12.12.4.1.1.m1.1d">25 / 200</annotation></semantics></math></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_border_r ltx_border_t" id="A1.T2.12.12.7">
<span class="ltx_inline-block ltx_align_top" id="A1.T2.12.12.7.1">
<span class="ltx_p" id="A1.T2.12.12.7.1.1">SGD</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A1.T2.16.16">
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_l ltx_border_r ltx_border_t" id="A1.T2.16.16.5">
<span class="ltx_inline-block ltx_align_top" id="A1.T2.16.16.5.1">
<span class="ltx_p" id="A1.T2.16.16.5.1.1" style="width:51.2pt;">Amazon</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="A1.T2.16.16.6">
<span class="ltx_inline-block ltx_align_top" id="A1.T2.16.16.6.1">
<span class="ltx_p" id="A1.T2.16.16.6.1.1" style="width:42.7pt;">DistilBERT</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="A1.T2.13.13.1">
<span class="ltx_inline-block ltx_align_top" id="A1.T2.13.13.1.1">
<span class="ltx_p" id="A1.T2.13.13.1.1.1" style="width:65.4pt;"><math alttext="0.05/0.1/0.45" class="ltx_Math" display="inline" id="A1.T2.13.13.1.1.1.m1.1"><semantics id="A1.T2.13.13.1.1.1.m1.1a"><mrow id="A1.T2.13.13.1.1.1.m1.1.1" xref="A1.T2.13.13.1.1.1.m1.1.1.cmml"><mn id="A1.T2.13.13.1.1.1.m1.1.1.2" xref="A1.T2.13.13.1.1.1.m1.1.1.2.cmml">0.05</mn><mo id="A1.T2.13.13.1.1.1.m1.1.1.1" xref="A1.T2.13.13.1.1.1.m1.1.1.1.cmml">/</mo><mn id="A1.T2.13.13.1.1.1.m1.1.1.3" xref="A1.T2.13.13.1.1.1.m1.1.1.3.cmml">0.1</mn><mo id="A1.T2.13.13.1.1.1.m1.1.1.1a" xref="A1.T2.13.13.1.1.1.m1.1.1.1.cmml">/</mo><mn id="A1.T2.13.13.1.1.1.m1.1.1.4" xref="A1.T2.13.13.1.1.1.m1.1.1.4.cmml">0.45</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.T2.13.13.1.1.1.m1.1b"><apply id="A1.T2.13.13.1.1.1.m1.1.1.cmml" xref="A1.T2.13.13.1.1.1.m1.1.1"><divide id="A1.T2.13.13.1.1.1.m1.1.1.1.cmml" xref="A1.T2.13.13.1.1.1.m1.1.1.1"></divide><cn id="A1.T2.13.13.1.1.1.m1.1.1.2.cmml" type="float" xref="A1.T2.13.13.1.1.1.m1.1.1.2">0.05</cn><cn id="A1.T2.13.13.1.1.1.m1.1.1.3.cmml" type="float" xref="A1.T2.13.13.1.1.1.m1.1.1.3">0.1</cn><cn id="A1.T2.13.13.1.1.1.m1.1.1.4.cmml" type="float" xref="A1.T2.13.13.1.1.1.m1.1.1.4">0.45</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T2.13.13.1.1.1.m1.1c">0.05/0.1/0.45</annotation><annotation encoding="application/x-llamapun" id="A1.T2.13.13.1.1.1.m1.1d">0.05 / 0.1 / 0.45</annotation></semantics></math></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_border_r ltx_border_t" id="A1.T2.14.14.2">
<span class="ltx_inline-block ltx_align_top" id="A1.T2.14.14.2.1">
<span class="ltx_p" id="A1.T2.14.14.2.1.1"><math alttext="1e-5" class="ltx_Math" display="inline" id="A1.T2.14.14.2.1.1.m1.1"><semantics id="A1.T2.14.14.2.1.1.m1.1a"><mrow id="A1.T2.14.14.2.1.1.m1.1.1" xref="A1.T2.14.14.2.1.1.m1.1.1.cmml"><mrow id="A1.T2.14.14.2.1.1.m1.1.1.2" xref="A1.T2.14.14.2.1.1.m1.1.1.2.cmml"><mn id="A1.T2.14.14.2.1.1.m1.1.1.2.2" xref="A1.T2.14.14.2.1.1.m1.1.1.2.2.cmml">1</mn><mo id="A1.T2.14.14.2.1.1.m1.1.1.2.1" xref="A1.T2.14.14.2.1.1.m1.1.1.2.1.cmml">⁢</mo><mi id="A1.T2.14.14.2.1.1.m1.1.1.2.3" xref="A1.T2.14.14.2.1.1.m1.1.1.2.3.cmml">e</mi></mrow><mo id="A1.T2.14.14.2.1.1.m1.1.1.1" xref="A1.T2.14.14.2.1.1.m1.1.1.1.cmml">−</mo><mn id="A1.T2.14.14.2.1.1.m1.1.1.3" xref="A1.T2.14.14.2.1.1.m1.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.T2.14.14.2.1.1.m1.1b"><apply id="A1.T2.14.14.2.1.1.m1.1.1.cmml" xref="A1.T2.14.14.2.1.1.m1.1.1"><minus id="A1.T2.14.14.2.1.1.m1.1.1.1.cmml" xref="A1.T2.14.14.2.1.1.m1.1.1.1"></minus><apply id="A1.T2.14.14.2.1.1.m1.1.1.2.cmml" xref="A1.T2.14.14.2.1.1.m1.1.1.2"><times id="A1.T2.14.14.2.1.1.m1.1.1.2.1.cmml" xref="A1.T2.14.14.2.1.1.m1.1.1.2.1"></times><cn id="A1.T2.14.14.2.1.1.m1.1.1.2.2.cmml" type="integer" xref="A1.T2.14.14.2.1.1.m1.1.1.2.2">1</cn><ci id="A1.T2.14.14.2.1.1.m1.1.1.2.3.cmml" xref="A1.T2.14.14.2.1.1.m1.1.1.2.3">𝑒</ci></apply><cn id="A1.T2.14.14.2.1.1.m1.1.1.3.cmml" type="integer" xref="A1.T2.14.14.2.1.1.m1.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T2.14.14.2.1.1.m1.1c">1e-5</annotation><annotation encoding="application/x-llamapun" id="A1.T2.14.14.2.1.1.m1.1d">1 italic_e - 5</annotation></semantics></math></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="A1.T2.15.15.3">
<span class="ltx_inline-block ltx_align_top" id="A1.T2.15.15.3.1">
<span class="ltx_p" id="A1.T2.15.15.3.1.1" style="width:28.5pt;"><math alttext="24" class="ltx_Math" display="inline" id="A1.T2.15.15.3.1.1.m1.1"><semantics id="A1.T2.15.15.3.1.1.m1.1a"><mn id="A1.T2.15.15.3.1.1.m1.1.1" xref="A1.T2.15.15.3.1.1.m1.1.1.cmml">24</mn><annotation-xml encoding="MathML-Content" id="A1.T2.15.15.3.1.1.m1.1b"><cn id="A1.T2.15.15.3.1.1.m1.1.1.cmml" type="integer" xref="A1.T2.15.15.3.1.1.m1.1.1">24</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T2.15.15.3.1.1.m1.1c">24</annotation><annotation encoding="application/x-llamapun" id="A1.T2.15.15.3.1.1.m1.1d">24</annotation></semantics></math></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_border_r ltx_border_t" id="A1.T2.16.16.4">
<span class="ltx_inline-block ltx_align_top" id="A1.T2.16.16.4.1">
<span class="ltx_p" id="A1.T2.16.16.4.1.1"><math alttext="3/200" class="ltx_Math" display="inline" id="A1.T2.16.16.4.1.1.m1.1"><semantics id="A1.T2.16.16.4.1.1.m1.1a"><mrow id="A1.T2.16.16.4.1.1.m1.1.1" xref="A1.T2.16.16.4.1.1.m1.1.1.cmml"><mn id="A1.T2.16.16.4.1.1.m1.1.1.2" xref="A1.T2.16.16.4.1.1.m1.1.1.2.cmml">3</mn><mo id="A1.T2.16.16.4.1.1.m1.1.1.1" xref="A1.T2.16.16.4.1.1.m1.1.1.1.cmml">/</mo><mn id="A1.T2.16.16.4.1.1.m1.1.1.3" xref="A1.T2.16.16.4.1.1.m1.1.1.3.cmml">200</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.T2.16.16.4.1.1.m1.1b"><apply id="A1.T2.16.16.4.1.1.m1.1.1.cmml" xref="A1.T2.16.16.4.1.1.m1.1.1"><divide id="A1.T2.16.16.4.1.1.m1.1.1.1.cmml" xref="A1.T2.16.16.4.1.1.m1.1.1.1"></divide><cn id="A1.T2.16.16.4.1.1.m1.1.1.2.cmml" type="integer" xref="A1.T2.16.16.4.1.1.m1.1.1.2">3</cn><cn id="A1.T2.16.16.4.1.1.m1.1.1.3.cmml" type="integer" xref="A1.T2.16.16.4.1.1.m1.1.1.3">200</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T2.16.16.4.1.1.m1.1c">3/200</annotation><annotation encoding="application/x-llamapun" id="A1.T2.16.16.4.1.1.m1.1d">3 / 200</annotation></semantics></math></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_border_r ltx_border_t" id="A1.T2.16.16.7">
<span class="ltx_inline-block ltx_align_top" id="A1.T2.16.16.7.1">
<span class="ltx_p" id="A1.T2.16.16.7.1.1">AdamW</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A1.T2.20.20">
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_b ltx_border_l ltx_border_r ltx_border_t" id="A1.T2.20.20.5">
<span class="ltx_inline-block ltx_align_top" id="A1.T2.20.20.5.1">
<span class="ltx_p" id="A1.T2.20.20.5.1.1" style="width:51.2pt;">AGNews</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_b ltx_border_r ltx_border_t" id="A1.T2.20.20.6">
<span class="ltx_inline-block ltx_align_top" id="A1.T2.20.20.6.1">
<span class="ltx_p" id="A1.T2.20.20.6.1.1" style="width:42.7pt;">DistilBERT</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_b ltx_border_r ltx_border_t" id="A1.T2.17.17.1">
<span class="ltx_inline-block ltx_align_top" id="A1.T2.17.17.1.1">
<span class="ltx_p" id="A1.T2.17.17.1.1.1" style="width:65.4pt;"><math alttext="0.01/0.025/0.05" class="ltx_Math" display="inline" id="A1.T2.17.17.1.1.1.m1.1"><semantics id="A1.T2.17.17.1.1.1.m1.1a"><mrow id="A1.T2.17.17.1.1.1.m1.1.1" xref="A1.T2.17.17.1.1.1.m1.1.1.cmml"><mn id="A1.T2.17.17.1.1.1.m1.1.1.2" xref="A1.T2.17.17.1.1.1.m1.1.1.2.cmml">0.01</mn><mo id="A1.T2.17.17.1.1.1.m1.1.1.1" xref="A1.T2.17.17.1.1.1.m1.1.1.1.cmml">/</mo><mn id="A1.T2.17.17.1.1.1.m1.1.1.3" xref="A1.T2.17.17.1.1.1.m1.1.1.3.cmml">0.025</mn><mo id="A1.T2.17.17.1.1.1.m1.1.1.1a" xref="A1.T2.17.17.1.1.1.m1.1.1.1.cmml">/</mo><mn id="A1.T2.17.17.1.1.1.m1.1.1.4" xref="A1.T2.17.17.1.1.1.m1.1.1.4.cmml">0.05</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.T2.17.17.1.1.1.m1.1b"><apply id="A1.T2.17.17.1.1.1.m1.1.1.cmml" xref="A1.T2.17.17.1.1.1.m1.1.1"><divide id="A1.T2.17.17.1.1.1.m1.1.1.1.cmml" xref="A1.T2.17.17.1.1.1.m1.1.1.1"></divide><cn id="A1.T2.17.17.1.1.1.m1.1.1.2.cmml" type="float" xref="A1.T2.17.17.1.1.1.m1.1.1.2">0.01</cn><cn id="A1.T2.17.17.1.1.1.m1.1.1.3.cmml" type="float" xref="A1.T2.17.17.1.1.1.m1.1.1.3">0.025</cn><cn id="A1.T2.17.17.1.1.1.m1.1.1.4.cmml" type="float" xref="A1.T2.17.17.1.1.1.m1.1.1.4">0.05</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T2.17.17.1.1.1.m1.1c">0.01/0.025/0.05</annotation><annotation encoding="application/x-llamapun" id="A1.T2.17.17.1.1.1.m1.1d">0.01 / 0.025 / 0.05</annotation></semantics></math></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_border_b ltx_border_r ltx_border_t" id="A1.T2.18.18.2">
<span class="ltx_inline-block ltx_align_top" id="A1.T2.18.18.2.1">
<span class="ltx_p" id="A1.T2.18.18.2.1.1"><math alttext="1e-5" class="ltx_Math" display="inline" id="A1.T2.18.18.2.1.1.m1.1"><semantics id="A1.T2.18.18.2.1.1.m1.1a"><mrow id="A1.T2.18.18.2.1.1.m1.1.1" xref="A1.T2.18.18.2.1.1.m1.1.1.cmml"><mrow id="A1.T2.18.18.2.1.1.m1.1.1.2" xref="A1.T2.18.18.2.1.1.m1.1.1.2.cmml"><mn id="A1.T2.18.18.2.1.1.m1.1.1.2.2" xref="A1.T2.18.18.2.1.1.m1.1.1.2.2.cmml">1</mn><mo id="A1.T2.18.18.2.1.1.m1.1.1.2.1" xref="A1.T2.18.18.2.1.1.m1.1.1.2.1.cmml">⁢</mo><mi id="A1.T2.18.18.2.1.1.m1.1.1.2.3" xref="A1.T2.18.18.2.1.1.m1.1.1.2.3.cmml">e</mi></mrow><mo id="A1.T2.18.18.2.1.1.m1.1.1.1" xref="A1.T2.18.18.2.1.1.m1.1.1.1.cmml">−</mo><mn id="A1.T2.18.18.2.1.1.m1.1.1.3" xref="A1.T2.18.18.2.1.1.m1.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.T2.18.18.2.1.1.m1.1b"><apply id="A1.T2.18.18.2.1.1.m1.1.1.cmml" xref="A1.T2.18.18.2.1.1.m1.1.1"><minus id="A1.T2.18.18.2.1.1.m1.1.1.1.cmml" xref="A1.T2.18.18.2.1.1.m1.1.1.1"></minus><apply id="A1.T2.18.18.2.1.1.m1.1.1.2.cmml" xref="A1.T2.18.18.2.1.1.m1.1.1.2"><times id="A1.T2.18.18.2.1.1.m1.1.1.2.1.cmml" xref="A1.T2.18.18.2.1.1.m1.1.1.2.1"></times><cn id="A1.T2.18.18.2.1.1.m1.1.1.2.2.cmml" type="integer" xref="A1.T2.18.18.2.1.1.m1.1.1.2.2">1</cn><ci id="A1.T2.18.18.2.1.1.m1.1.1.2.3.cmml" xref="A1.T2.18.18.2.1.1.m1.1.1.2.3">𝑒</ci></apply><cn id="A1.T2.18.18.2.1.1.m1.1.1.3.cmml" type="integer" xref="A1.T2.18.18.2.1.1.m1.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T2.18.18.2.1.1.m1.1c">1e-5</annotation><annotation encoding="application/x-llamapun" id="A1.T2.18.18.2.1.1.m1.1d">1 italic_e - 5</annotation></semantics></math></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_b ltx_border_r ltx_border_t" id="A1.T2.19.19.3">
<span class="ltx_inline-block ltx_align_top" id="A1.T2.19.19.3.1">
<span class="ltx_p" id="A1.T2.19.19.3.1.1" style="width:28.5pt;"><math alttext="24" class="ltx_Math" display="inline" id="A1.T2.19.19.3.1.1.m1.1"><semantics id="A1.T2.19.19.3.1.1.m1.1a"><mn id="A1.T2.19.19.3.1.1.m1.1.1" xref="A1.T2.19.19.3.1.1.m1.1.1.cmml">24</mn><annotation-xml encoding="MathML-Content" id="A1.T2.19.19.3.1.1.m1.1b"><cn id="A1.T2.19.19.3.1.1.m1.1.1.cmml" type="integer" xref="A1.T2.19.19.3.1.1.m1.1.1">24</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T2.19.19.3.1.1.m1.1c">24</annotation><annotation encoding="application/x-llamapun" id="A1.T2.19.19.3.1.1.m1.1d">24</annotation></semantics></math></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_border_b ltx_border_r ltx_border_t" id="A1.T2.20.20.4">
<span class="ltx_inline-block ltx_align_top" id="A1.T2.20.20.4.1">
<span class="ltx_p" id="A1.T2.20.20.4.1.1"><math alttext="3/200" class="ltx_Math" display="inline" id="A1.T2.20.20.4.1.1.m1.1"><semantics id="A1.T2.20.20.4.1.1.m1.1a"><mrow id="A1.T2.20.20.4.1.1.m1.1.1" xref="A1.T2.20.20.4.1.1.m1.1.1.cmml"><mn id="A1.T2.20.20.4.1.1.m1.1.1.2" xref="A1.T2.20.20.4.1.1.m1.1.1.2.cmml">3</mn><mo id="A1.T2.20.20.4.1.1.m1.1.1.1" xref="A1.T2.20.20.4.1.1.m1.1.1.1.cmml">/</mo><mn id="A1.T2.20.20.4.1.1.m1.1.1.3" xref="A1.T2.20.20.4.1.1.m1.1.1.3.cmml">200</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.T2.20.20.4.1.1.m1.1b"><apply id="A1.T2.20.20.4.1.1.m1.1.1.cmml" xref="A1.T2.20.20.4.1.1.m1.1.1"><divide id="A1.T2.20.20.4.1.1.m1.1.1.1.cmml" xref="A1.T2.20.20.4.1.1.m1.1.1.1"></divide><cn id="A1.T2.20.20.4.1.1.m1.1.1.2.cmml" type="integer" xref="A1.T2.20.20.4.1.1.m1.1.1.2">3</cn><cn id="A1.T2.20.20.4.1.1.m1.1.1.3.cmml" type="integer" xref="A1.T2.20.20.4.1.1.m1.1.1.3">200</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T2.20.20.4.1.1.m1.1c">3/200</annotation><annotation encoding="application/x-llamapun" id="A1.T2.20.20.4.1.1.m1.1d">3 / 200</annotation></semantics></math></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_border_b ltx_border_r ltx_border_t" id="A1.T2.20.20.7">
<span class="ltx_inline-block ltx_align_top" id="A1.T2.20.20.7.1">
<span class="ltx_p" id="A1.T2.20.20.7.1.1">AdamW</span>
</span>
</td>
</tr>
</table>
</figure>
<div class="ltx_para" id="A1.SS1.p2">
<p class="ltx_p" id="A1.SS1.p2.1"><span class="ltx_text ltx_font_bold" id="A1.SS1.p2.1.1">Dataset Details</span></p>
</div>
<div class="ltx_para" id="A1.SS1.p3">
<ul class="ltx_itemize" id="A1.I1">
<li class="ltx_item" id="A1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A1.I1.i1.p1">
<p class="ltx_p" id="A1.I1.i1.p1.4"><span class="ltx_text ltx_font_bold" id="A1.I1.i1.p1.4.1">ImageNet100:</span> The ImageNet100 dataset <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#bib.bib12" title="">12</a>]</cite> is a subset from the ImageNet Large Scale Visual Recognition Challenge <math alttext="2012" class="ltx_Math" display="inline" id="A1.I1.i1.p1.1.m1.1"><semantics id="A1.I1.i1.p1.1.m1.1a"><mn id="A1.I1.i1.p1.1.m1.1.1" xref="A1.I1.i1.p1.1.m1.1.1.cmml">2012</mn><annotation-xml encoding="MathML-Content" id="A1.I1.i1.p1.1.m1.1b"><cn id="A1.I1.i1.p1.1.m1.1.1.cmml" type="integer" xref="A1.I1.i1.p1.1.m1.1.1">2012</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.I1.i1.p1.1.m1.1c">2012</annotation><annotation encoding="application/x-llamapun" id="A1.I1.i1.p1.1.m1.1d">2012</annotation></semantics></math>. It contains random <math alttext="100" class="ltx_Math" display="inline" id="A1.I1.i1.p1.2.m2.1"><semantics id="A1.I1.i1.p1.2.m2.1a"><mn id="A1.I1.i1.p1.2.m2.1.1" xref="A1.I1.i1.p1.2.m2.1.1.cmml">100</mn><annotation-xml encoding="MathML-Content" id="A1.I1.i1.p1.2.m2.1b"><cn id="A1.I1.i1.p1.2.m2.1.1.cmml" type="integer" xref="A1.I1.i1.p1.2.m2.1.1">100</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.I1.i1.p1.2.m2.1c">100</annotation><annotation encoding="application/x-llamapun" id="A1.I1.i1.p1.2.m2.1d">100</annotation></semantics></math> classes, each having <math alttext="1350" class="ltx_Math" display="inline" id="A1.I1.i1.p1.3.m3.1"><semantics id="A1.I1.i1.p1.3.m3.1a"><mn id="A1.I1.i1.p1.3.m3.1.1" xref="A1.I1.i1.p1.3.m3.1.1.cmml">1350</mn><annotation-xml encoding="MathML-Content" id="A1.I1.i1.p1.3.m3.1b"><cn id="A1.I1.i1.p1.3.m3.1.1.cmml" type="integer" xref="A1.I1.i1.p1.3.m3.1.1">1350</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.I1.i1.p1.3.m3.1c">1350</annotation><annotation encoding="application/x-llamapun" id="A1.I1.i1.p1.3.m3.1d">1350</annotation></semantics></math> samples with resolution <math alttext="3\times 224\times 224" class="ltx_Math" display="inline" id="A1.I1.i1.p1.4.m4.1"><semantics id="A1.I1.i1.p1.4.m4.1a"><mrow id="A1.I1.i1.p1.4.m4.1.1" xref="A1.I1.i1.p1.4.m4.1.1.cmml"><mn id="A1.I1.i1.p1.4.m4.1.1.2" xref="A1.I1.i1.p1.4.m4.1.1.2.cmml">3</mn><mo id="A1.I1.i1.p1.4.m4.1.1.1" lspace="0.222em" rspace="0.222em" xref="A1.I1.i1.p1.4.m4.1.1.1.cmml">×</mo><mn id="A1.I1.i1.p1.4.m4.1.1.3" xref="A1.I1.i1.p1.4.m4.1.1.3.cmml">224</mn><mo id="A1.I1.i1.p1.4.m4.1.1.1a" lspace="0.222em" rspace="0.222em" xref="A1.I1.i1.p1.4.m4.1.1.1.cmml">×</mo><mn id="A1.I1.i1.p1.4.m4.1.1.4" xref="A1.I1.i1.p1.4.m4.1.1.4.cmml">224</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.I1.i1.p1.4.m4.1b"><apply id="A1.I1.i1.p1.4.m4.1.1.cmml" xref="A1.I1.i1.p1.4.m4.1.1"><times id="A1.I1.i1.p1.4.m4.1.1.1.cmml" xref="A1.I1.i1.p1.4.m4.1.1.1"></times><cn id="A1.I1.i1.p1.4.m4.1.1.2.cmml" type="integer" xref="A1.I1.i1.p1.4.m4.1.1.2">3</cn><cn id="A1.I1.i1.p1.4.m4.1.1.3.cmml" type="integer" xref="A1.I1.i1.p1.4.m4.1.1.3">224</cn><cn id="A1.I1.i1.p1.4.m4.1.1.4.cmml" type="integer" xref="A1.I1.i1.p1.4.m4.1.1.4">224</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.I1.i1.p1.4.m4.1c">3\times 224\times 224</annotation><annotation encoding="application/x-llamapun" id="A1.I1.i1.p1.4.m4.1d">3 × 224 × 224</annotation></semantics></math>.</p>
</div>
</li>
<li class="ltx_item" id="A1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A1.I1.i2.p1">
<p class="ltx_p" id="A1.I1.i2.p1.3"><span class="ltx_text ltx_font_bold" id="A1.I1.i2.p1.3.1">CIFAR100:</span> The CIFAR100 <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#bib.bib44" title="">44</a>]</cite> dataset has <math alttext="60,000" class="ltx_Math" display="inline" id="A1.I1.i2.p1.1.m1.2"><semantics id="A1.I1.i2.p1.1.m1.2a"><mrow id="A1.I1.i2.p1.1.m1.2.3.2" xref="A1.I1.i2.p1.1.m1.2.3.1.cmml"><mn id="A1.I1.i2.p1.1.m1.1.1" xref="A1.I1.i2.p1.1.m1.1.1.cmml">60</mn><mo id="A1.I1.i2.p1.1.m1.2.3.2.1" xref="A1.I1.i2.p1.1.m1.2.3.1.cmml">,</mo><mn id="A1.I1.i2.p1.1.m1.2.2" xref="A1.I1.i2.p1.1.m1.2.2.cmml">000</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.I1.i2.p1.1.m1.2b"><list id="A1.I1.i2.p1.1.m1.2.3.1.cmml" xref="A1.I1.i2.p1.1.m1.2.3.2"><cn id="A1.I1.i2.p1.1.m1.1.1.cmml" type="integer" xref="A1.I1.i2.p1.1.m1.1.1">60</cn><cn id="A1.I1.i2.p1.1.m1.2.2.cmml" type="integer" xref="A1.I1.i2.p1.1.m1.2.2">000</cn></list></annotation-xml><annotation encoding="application/x-tex" id="A1.I1.i2.p1.1.m1.2c">60,000</annotation><annotation encoding="application/x-llamapun" id="A1.I1.i2.p1.1.m1.2d">60 , 000</annotation></semantics></math> images with <math alttext="100" class="ltx_Math" display="inline" id="A1.I1.i2.p1.2.m2.1"><semantics id="A1.I1.i2.p1.2.m2.1a"><mn id="A1.I1.i2.p1.2.m2.1.1" xref="A1.I1.i2.p1.2.m2.1.1.cmml">100</mn><annotation-xml encoding="MathML-Content" id="A1.I1.i2.p1.2.m2.1b"><cn id="A1.I1.i2.p1.2.m2.1.1.cmml" type="integer" xref="A1.I1.i2.p1.2.m2.1.1">100</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.I1.i2.p1.2.m2.1c">100</annotation><annotation encoding="application/x-llamapun" id="A1.I1.i2.p1.2.m2.1d">100</annotation></semantics></math> different classes and resolution <math alttext="3\times 24\times 24" class="ltx_Math" display="inline" id="A1.I1.i2.p1.3.m3.1"><semantics id="A1.I1.i2.p1.3.m3.1a"><mrow id="A1.I1.i2.p1.3.m3.1.1" xref="A1.I1.i2.p1.3.m3.1.1.cmml"><mn id="A1.I1.i2.p1.3.m3.1.1.2" xref="A1.I1.i2.p1.3.m3.1.1.2.cmml">3</mn><mo id="A1.I1.i2.p1.3.m3.1.1.1" lspace="0.222em" rspace="0.222em" xref="A1.I1.i2.p1.3.m3.1.1.1.cmml">×</mo><mn id="A1.I1.i2.p1.3.m3.1.1.3" xref="A1.I1.i2.p1.3.m3.1.1.3.cmml">24</mn><mo id="A1.I1.i2.p1.3.m3.1.1.1a" lspace="0.222em" rspace="0.222em" xref="A1.I1.i2.p1.3.m3.1.1.1.cmml">×</mo><mn id="A1.I1.i2.p1.3.m3.1.1.4" xref="A1.I1.i2.p1.3.m3.1.1.4.cmml">24</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.I1.i2.p1.3.m3.1b"><apply id="A1.I1.i2.p1.3.m3.1.1.cmml" xref="A1.I1.i2.p1.3.m3.1.1"><times id="A1.I1.i2.p1.3.m3.1.1.1.cmml" xref="A1.I1.i2.p1.3.m3.1.1.1"></times><cn id="A1.I1.i2.p1.3.m3.1.1.2.cmml" type="integer" xref="A1.I1.i2.p1.3.m3.1.1.2">3</cn><cn id="A1.I1.i2.p1.3.m3.1.1.3.cmml" type="integer" xref="A1.I1.i2.p1.3.m3.1.1.3">24</cn><cn id="A1.I1.i2.p1.3.m3.1.1.4.cmml" type="integer" xref="A1.I1.i2.p1.3.m3.1.1.4">24</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.I1.i2.p1.3.m3.1c">3\times 24\times 24</annotation><annotation encoding="application/x-llamapun" id="A1.I1.i2.p1.3.m3.1d">3 × 24 × 24</annotation></semantics></math>.</p>
</div>
</li>
<li class="ltx_item" id="A1.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A1.I1.i3.p1">
<p class="ltx_p" id="A1.I1.i3.p1.4"><span class="ltx_text ltx_font_bold" id="A1.I1.i3.p1.4.1">TerraIncognita:</span> The TerraIncognita dataset <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#bib.bib6" title="">6</a>]</cite> consists of wild animal photographs with <math alttext="4" class="ltx_Math" display="inline" id="A1.I1.i3.p1.1.m1.1"><semantics id="A1.I1.i3.p1.1.m1.1a"><mn id="A1.I1.i3.p1.1.m1.1.1" xref="A1.I1.i3.p1.1.m1.1.1.cmml">4</mn><annotation-xml encoding="MathML-Content" id="A1.I1.i3.p1.1.m1.1b"><cn id="A1.I1.i3.p1.1.m1.1.1.cmml" type="integer" xref="A1.I1.i3.p1.1.m1.1.1">4</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.I1.i3.p1.1.m1.1c">4</annotation><annotation encoding="application/x-llamapun" id="A1.I1.i3.p1.1.m1.1d">4</annotation></semantics></math> domains based on the location where the images were captured. It contains <math alttext="24,788" class="ltx_Math" display="inline" id="A1.I1.i3.p1.2.m2.2"><semantics id="A1.I1.i3.p1.2.m2.2a"><mrow id="A1.I1.i3.p1.2.m2.2.3.2" xref="A1.I1.i3.p1.2.m2.2.3.1.cmml"><mn id="A1.I1.i3.p1.2.m2.1.1" xref="A1.I1.i3.p1.2.m2.1.1.cmml">24</mn><mo id="A1.I1.i3.p1.2.m2.2.3.2.1" xref="A1.I1.i3.p1.2.m2.2.3.1.cmml">,</mo><mn id="A1.I1.i3.p1.2.m2.2.2" xref="A1.I1.i3.p1.2.m2.2.2.cmml">788</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.I1.i3.p1.2.m2.2b"><list id="A1.I1.i3.p1.2.m2.2.3.1.cmml" xref="A1.I1.i3.p1.2.m2.2.3.2"><cn id="A1.I1.i3.p1.2.m2.1.1.cmml" type="integer" xref="A1.I1.i3.p1.2.m2.1.1">24</cn><cn id="A1.I1.i3.p1.2.m2.2.2.cmml" type="integer" xref="A1.I1.i3.p1.2.m2.2.2">788</cn></list></annotation-xml><annotation encoding="application/x-tex" id="A1.I1.i3.p1.2.m2.2c">24,788</annotation><annotation encoding="application/x-llamapun" id="A1.I1.i3.p1.2.m2.2d">24 , 788</annotation></semantics></math> images with a resolution of <math alttext="3\times 224\times 224" class="ltx_Math" display="inline" id="A1.I1.i3.p1.3.m3.1"><semantics id="A1.I1.i3.p1.3.m3.1a"><mrow id="A1.I1.i3.p1.3.m3.1.1" xref="A1.I1.i3.p1.3.m3.1.1.cmml"><mn id="A1.I1.i3.p1.3.m3.1.1.2" xref="A1.I1.i3.p1.3.m3.1.1.2.cmml">3</mn><mo id="A1.I1.i3.p1.3.m3.1.1.1" lspace="0.222em" rspace="0.222em" xref="A1.I1.i3.p1.3.m3.1.1.1.cmml">×</mo><mn id="A1.I1.i3.p1.3.m3.1.1.3" xref="A1.I1.i3.p1.3.m3.1.1.3.cmml">224</mn><mo id="A1.I1.i3.p1.3.m3.1.1.1a" lspace="0.222em" rspace="0.222em" xref="A1.I1.i3.p1.3.m3.1.1.1.cmml">×</mo><mn id="A1.I1.i3.p1.3.m3.1.1.4" xref="A1.I1.i3.p1.3.m3.1.1.4.cmml">224</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.I1.i3.p1.3.m3.1b"><apply id="A1.I1.i3.p1.3.m3.1.1.cmml" xref="A1.I1.i3.p1.3.m3.1.1"><times id="A1.I1.i3.p1.3.m3.1.1.1.cmml" xref="A1.I1.i3.p1.3.m3.1.1.1"></times><cn id="A1.I1.i3.p1.3.m3.1.1.2.cmml" type="integer" xref="A1.I1.i3.p1.3.m3.1.1.2">3</cn><cn id="A1.I1.i3.p1.3.m3.1.1.3.cmml" type="integer" xref="A1.I1.i3.p1.3.m3.1.1.3">224</cn><cn id="A1.I1.i3.p1.3.m3.1.1.4.cmml" type="integer" xref="A1.I1.i3.p1.3.m3.1.1.4">224</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.I1.i3.p1.3.m3.1c">3\times 224\times 224</annotation><annotation encoding="application/x-llamapun" id="A1.I1.i3.p1.3.m3.1d">3 × 224 × 224</annotation></semantics></math> and <math alttext="10" class="ltx_Math" display="inline" id="A1.I1.i3.p1.4.m4.1"><semantics id="A1.I1.i3.p1.4.m4.1a"><mn id="A1.I1.i3.p1.4.m4.1.1" xref="A1.I1.i3.p1.4.m4.1.1.cmml">10</mn><annotation-xml encoding="MathML-Content" id="A1.I1.i3.p1.4.m4.1b"><cn id="A1.I1.i3.p1.4.m4.1.1.cmml" type="integer" xref="A1.I1.i3.p1.4.m4.1.1">10</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.I1.i3.p1.4.m4.1c">10</annotation><annotation encoding="application/x-llamapun" id="A1.I1.i3.p1.4.m4.1d">10</annotation></semantics></math> classes.</p>
</div>
</li>
<li class="ltx_item" id="A1.I1.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A1.I1.i4.p1">
<p class="ltx_p" id="A1.I1.i4.p1.2"><span class="ltx_text ltx_font_bold" id="A1.I1.i4.p1.2.1">Amazon:</span> The Amazon review dataset <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#bib.bib60" title="">60</a>]</cite> is a text classificaiton dataset containing reviews for products together with the scores from the users. It has <math alttext="4,002,170" class="ltx_Math" display="inline" id="A1.I1.i4.p1.1.m1.3"><semantics id="A1.I1.i4.p1.1.m1.3a"><mrow id="A1.I1.i4.p1.1.m1.3.4.2" xref="A1.I1.i4.p1.1.m1.3.4.1.cmml"><mn id="A1.I1.i4.p1.1.m1.1.1" xref="A1.I1.i4.p1.1.m1.1.1.cmml">4</mn><mo id="A1.I1.i4.p1.1.m1.3.4.2.1" xref="A1.I1.i4.p1.1.m1.3.4.1.cmml">,</mo><mn id="A1.I1.i4.p1.1.m1.2.2" xref="A1.I1.i4.p1.1.m1.2.2.cmml">002</mn><mo id="A1.I1.i4.p1.1.m1.3.4.2.2" xref="A1.I1.i4.p1.1.m1.3.4.1.cmml">,</mo><mn id="A1.I1.i4.p1.1.m1.3.3" xref="A1.I1.i4.p1.1.m1.3.3.cmml">170</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.I1.i4.p1.1.m1.3b"><list id="A1.I1.i4.p1.1.m1.3.4.1.cmml" xref="A1.I1.i4.p1.1.m1.3.4.2"><cn id="A1.I1.i4.p1.1.m1.1.1.cmml" type="integer" xref="A1.I1.i4.p1.1.m1.1.1">4</cn><cn id="A1.I1.i4.p1.1.m1.2.2.cmml" type="integer" xref="A1.I1.i4.p1.1.m1.2.2">002</cn><cn id="A1.I1.i4.p1.1.m1.3.3.cmml" type="integer" xref="A1.I1.i4.p1.1.m1.3.3">170</cn></list></annotation-xml><annotation encoding="application/x-tex" id="A1.I1.i4.p1.1.m1.3c">4,002,170</annotation><annotation encoding="application/x-llamapun" id="A1.I1.i4.p1.1.m1.3d">4 , 002 , 170</annotation></semantics></math> reviews with <math alttext="5" class="ltx_Math" display="inline" id="A1.I1.i4.p1.2.m2.1"><semantics id="A1.I1.i4.p1.2.m2.1a"><mn id="A1.I1.i4.p1.2.m2.1.1" xref="A1.I1.i4.p1.2.m2.1.1.cmml">5</mn><annotation-xml encoding="MathML-Content" id="A1.I1.i4.p1.2.m2.1b"><cn id="A1.I1.i4.p1.2.m2.1.1.cmml" type="integer" xref="A1.I1.i4.p1.2.m2.1.1">5</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.I1.i4.p1.2.m2.1c">5</annotation><annotation encoding="application/x-llamapun" id="A1.I1.i4.p1.2.m2.1d">5</annotation></semantics></math> classes.</p>
</div>
</li>
<li class="ltx_item" id="A1.I1.i5" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A1.I1.i5.p1">
<p class="ltx_p" id="A1.I1.i5.p1.2"><span class="ltx_text ltx_font_bold" id="A1.I1.i5.p1.2.1">AGNews:</span> The AGNews dataset <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#bib.bib85" title="">85</a>]</cite> consists of a collection of collection <math alttext="127,600" class="ltx_Math" display="inline" id="A1.I1.i5.p1.1.m1.2"><semantics id="A1.I1.i5.p1.1.m1.2a"><mrow id="A1.I1.i5.p1.1.m1.2.3.2" xref="A1.I1.i5.p1.1.m1.2.3.1.cmml"><mn id="A1.I1.i5.p1.1.m1.1.1" xref="A1.I1.i5.p1.1.m1.1.1.cmml">127</mn><mo id="A1.I1.i5.p1.1.m1.2.3.2.1" xref="A1.I1.i5.p1.1.m1.2.3.1.cmml">,</mo><mn id="A1.I1.i5.p1.1.m1.2.2" xref="A1.I1.i5.p1.1.m1.2.2.cmml">600</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.I1.i5.p1.1.m1.2b"><list id="A1.I1.i5.p1.1.m1.2.3.1.cmml" xref="A1.I1.i5.p1.1.m1.2.3.2"><cn id="A1.I1.i5.p1.1.m1.1.1.cmml" type="integer" xref="A1.I1.i5.p1.1.m1.1.1">127</cn><cn id="A1.I1.i5.p1.1.m1.2.2.cmml" type="integer" xref="A1.I1.i5.p1.1.m1.2.2">600</cn></list></annotation-xml><annotation encoding="application/x-tex" id="A1.I1.i5.p1.1.m1.2c">127,600</annotation><annotation encoding="application/x-llamapun" id="A1.I1.i5.p1.1.m1.2d">127 , 600</annotation></semantics></math> news articles with <math alttext="4" class="ltx_Math" display="inline" id="A1.I1.i5.p1.2.m2.1"><semantics id="A1.I1.i5.p1.2.m2.1a"><mn id="A1.I1.i5.p1.2.m2.1.1" xref="A1.I1.i5.p1.2.m2.1.1.cmml">4</mn><annotation-xml encoding="MathML-Content" id="A1.I1.i5.p1.2.m2.1b"><cn id="A1.I1.i5.p1.2.m2.1.1.cmml" type="integer" xref="A1.I1.i5.p1.2.m2.1.1">4</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.I1.i5.p1.2.m2.1c">4</annotation><annotation encoding="application/x-llamapun" id="A1.I1.i5.p1.2.m2.1d">4</annotation></semantics></math> classes.</p>
</div>
</li>
</ul>
</div>
<div class="ltx_para" id="A1.SS1.p4">
<p class="ltx_p" id="A1.SS1.p4.13"><span class="ltx_text ltx_font_bold" id="A1.SS1.p4.13.1">Training Details.</span> We use a train-test-split with ratios <math alttext="0.4" class="ltx_Math" display="inline" id="A1.SS1.p4.1.m1.1"><semantics id="A1.SS1.p4.1.m1.1a"><mn id="A1.SS1.p4.1.m1.1.1" xref="A1.SS1.p4.1.m1.1.1.cmml">0.4</mn><annotation-xml encoding="MathML-Content" id="A1.SS1.p4.1.m1.1b"><cn id="A1.SS1.p4.1.m1.1.1.cmml" type="float" xref="A1.SS1.p4.1.m1.1.1">0.4</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p4.1.m1.1c">0.4</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p4.1.m1.1d">0.4</annotation></semantics></math>, <math alttext="0.3" class="ltx_Math" display="inline" id="A1.SS1.p4.2.m2.1"><semantics id="A1.SS1.p4.2.m2.1a"><mn id="A1.SS1.p4.2.m2.1.1" xref="A1.SS1.p4.2.m2.1.1.cmml">0.3</mn><annotation-xml encoding="MathML-Content" id="A1.SS1.p4.2.m2.1b"><cn id="A1.SS1.p4.2.m2.1.1.cmml" type="float" xref="A1.SS1.p4.2.m2.1.1">0.3</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p4.2.m2.1c">0.3</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p4.2.m2.1d">0.3</annotation></semantics></math> and <math alttext="0.3" class="ltx_Math" display="inline" id="A1.SS1.p4.3.m3.1"><semantics id="A1.SS1.p4.3.m3.1a"><mn id="A1.SS1.p4.3.m3.1.1" xref="A1.SS1.p4.3.m3.1.1.cmml">0.3</mn><annotation-xml encoding="MathML-Content" id="A1.SS1.p4.3.m3.1b"><cn id="A1.SS1.p4.3.m3.1.1.cmml" type="float" xref="A1.SS1.p4.3.m3.1.1">0.3</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p4.3.m3.1c">0.3</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p4.3.m3.1d">0.3</annotation></semantics></math> respectively. Each dataset is treated as a data pool for sampling. To compute the initial performance of the pretrained model and generate the first statistic (class-level accuracies) we sample instances using a Dirichlet distribution. Choice of parameter <math alttext="\alpha" class="ltx_Math" display="inline" id="A1.SS1.p4.4.m4.1"><semantics id="A1.SS1.p4.4.m4.1a"><mi id="A1.SS1.p4.4.m4.1.1" xref="A1.SS1.p4.4.m4.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.p4.4.m4.1b"><ci id="A1.SS1.p4.4.m4.1.1.cmml" xref="A1.SS1.p4.4.m4.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p4.4.m4.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p4.4.m4.1d">italic_α</annotation></semantics></math> for the distribution guides the skewness of the initial distribution for the initial model. We set <math alttext="\alpha=100" class="ltx_Math" display="inline" id="A1.SS1.p4.5.m5.1"><semantics id="A1.SS1.p4.5.m5.1a"><mrow id="A1.SS1.p4.5.m5.1.1" xref="A1.SS1.p4.5.m5.1.1.cmml"><mi id="A1.SS1.p4.5.m5.1.1.2" xref="A1.SS1.p4.5.m5.1.1.2.cmml">α</mi><mo id="A1.SS1.p4.5.m5.1.1.1" xref="A1.SS1.p4.5.m5.1.1.1.cmml">=</mo><mn id="A1.SS1.p4.5.m5.1.1.3" xref="A1.SS1.p4.5.m5.1.1.3.cmml">100</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.p4.5.m5.1b"><apply id="A1.SS1.p4.5.m5.1.1.cmml" xref="A1.SS1.p4.5.m5.1.1"><eq id="A1.SS1.p4.5.m5.1.1.1.cmml" xref="A1.SS1.p4.5.m5.1.1.1"></eq><ci id="A1.SS1.p4.5.m5.1.1.2.cmml" xref="A1.SS1.p4.5.m5.1.1.2">𝛼</ci><cn id="A1.SS1.p4.5.m5.1.1.3.cmml" type="integer" xref="A1.SS1.p4.5.m5.1.1.3">100</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p4.5.m5.1c">\alpha=100</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p4.5.m5.1d">italic_α = 100</annotation></semantics></math> to evaluate the initial model on a fairly balanced dataset. For each round, we sample <math alttext="1,000" class="ltx_Math" display="inline" id="A1.SS1.p4.6.m6.2"><semantics id="A1.SS1.p4.6.m6.2a"><mrow id="A1.SS1.p4.6.m6.2.3.2" xref="A1.SS1.p4.6.m6.2.3.1.cmml"><mn id="A1.SS1.p4.6.m6.1.1" xref="A1.SS1.p4.6.m6.1.1.cmml">1</mn><mo id="A1.SS1.p4.6.m6.2.3.2.1" xref="A1.SS1.p4.6.m6.2.3.1.cmml">,</mo><mn id="A1.SS1.p4.6.m6.2.2" xref="A1.SS1.p4.6.m6.2.2.cmml">000</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.p4.6.m6.2b"><list id="A1.SS1.p4.6.m6.2.3.1.cmml" xref="A1.SS1.p4.6.m6.2.3.2"><cn id="A1.SS1.p4.6.m6.1.1.cmml" type="integer" xref="A1.SS1.p4.6.m6.1.1">1</cn><cn id="A1.SS1.p4.6.m6.2.2.cmml" type="integer" xref="A1.SS1.p4.6.m6.2.2">000</cn></list></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p4.6.m6.2c">1,000</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p4.6.m6.2d">1 , 000</annotation></semantics></math> train and validation samples and <math alttext="2,000" class="ltx_Math" display="inline" id="A1.SS1.p4.7.m7.2"><semantics id="A1.SS1.p4.7.m7.2a"><mrow id="A1.SS1.p4.7.m7.2.3.2" xref="A1.SS1.p4.7.m7.2.3.1.cmml"><mn id="A1.SS1.p4.7.m7.1.1" xref="A1.SS1.p4.7.m7.1.1.cmml">2</mn><mo id="A1.SS1.p4.7.m7.2.3.2.1" xref="A1.SS1.p4.7.m7.2.3.1.cmml">,</mo><mn id="A1.SS1.p4.7.m7.2.2" xref="A1.SS1.p4.7.m7.2.2.cmml">000</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.p4.7.m7.2b"><list id="A1.SS1.p4.7.m7.2.3.1.cmml" xref="A1.SS1.p4.7.m7.2.3.2"><cn id="A1.SS1.p4.7.m7.1.1.cmml" type="integer" xref="A1.SS1.p4.7.m7.1.1">2</cn><cn id="A1.SS1.p4.7.m7.2.2.cmml" type="integer" xref="A1.SS1.p4.7.m7.2.2">000</cn></list></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p4.7.m7.2c">2,000</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p4.7.m7.2d">2 , 000</annotation></semantics></math> test samples from the data pools to simulate the round. Each iteration of the loop (rounds) follows: (1) evaluation of the existing model on the current distribution, (2) updating the model using the current distribution, (3) computing the statistics using the updated model on the current distribution. The computed statistics in the final step determine the next distribution and these steps are repeated over <math alttext="200" class="ltx_Math" display="inline" id="A1.SS1.p4.8.m8.1"><semantics id="A1.SS1.p4.8.m8.1a"><mn id="A1.SS1.p4.8.m8.1.1" xref="A1.SS1.p4.8.m8.1.1.cmml">200</mn><annotation-xml encoding="MathML-Content" id="A1.SS1.p4.8.m8.1b"><cn id="A1.SS1.p4.8.m8.1.1.cmml" type="integer" xref="A1.SS1.p4.8.m8.1.1">200</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p4.8.m8.1c">200</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p4.8.m8.1d">200</annotation></semantics></math> rounds. Baselines differ based on their approach to step (2). <span class="ltx_text ltx_font_italic" id="A1.SS1.p4.13.2">Oracle Fine-tuning</span> uses train and validation set to fit to the current distribution. <span class="ltx_text ltx_font_italic" id="A1.SS1.p4.13.3">No Adaptation</span> skips that step and <span class="ltx_text ltx_font_italic" id="A1.SS1.p4.13.4">Performativity-aware Predictor</span> adds previous round statistic, current label marginal pair to its memory buffer and make a pass over it to update the label marginal predictor. This memory buffer simulates epoch-like training for the label marginal predictor. Since it passes over the first pair it has added to the memory buffer many times, we apply a scaling to balance sample importance exponentially with a decay factor <math alttext="0.995" class="ltx_Math" display="inline" id="A1.SS1.p4.9.m9.1"><semantics id="A1.SS1.p4.9.m9.1a"><mn id="A1.SS1.p4.9.m9.1.1" xref="A1.SS1.p4.9.m9.1.1.cmml">0.995</mn><annotation-xml encoding="MathML-Content" id="A1.SS1.p4.9.m9.1b"><cn id="A1.SS1.p4.9.m9.1.1.cmml" type="float" xref="A1.SS1.p4.9.m9.1.1">0.995</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p4.9.m9.1c">0.995</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p4.9.m9.1d">0.995</annotation></semantics></math>. For the vision experiments we use a cosine annealing learning rate scheduler, while for the language datasets we use linear scheduling. Throughout all classification tasks we used a cross entropy loss as the metric. To train the <span class="ltx_text ltx_font_italic" id="A1.SS1.p4.13.5">Performativity-aware Predictor</span>, we used Adam optimizer with a learning rate of <math alttext="1e-4" class="ltx_Math" display="inline" id="A1.SS1.p4.10.m10.1"><semantics id="A1.SS1.p4.10.m10.1a"><mrow id="A1.SS1.p4.10.m10.1.1" xref="A1.SS1.p4.10.m10.1.1.cmml"><mrow id="A1.SS1.p4.10.m10.1.1.2" xref="A1.SS1.p4.10.m10.1.1.2.cmml"><mn id="A1.SS1.p4.10.m10.1.1.2.2" xref="A1.SS1.p4.10.m10.1.1.2.2.cmml">1</mn><mo id="A1.SS1.p4.10.m10.1.1.2.1" xref="A1.SS1.p4.10.m10.1.1.2.1.cmml">⁢</mo><mi id="A1.SS1.p4.10.m10.1.1.2.3" xref="A1.SS1.p4.10.m10.1.1.2.3.cmml">e</mi></mrow><mo id="A1.SS1.p4.10.m10.1.1.1" xref="A1.SS1.p4.10.m10.1.1.1.cmml">−</mo><mn id="A1.SS1.p4.10.m10.1.1.3" xref="A1.SS1.p4.10.m10.1.1.3.cmml">4</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.p4.10.m10.1b"><apply id="A1.SS1.p4.10.m10.1.1.cmml" xref="A1.SS1.p4.10.m10.1.1"><minus id="A1.SS1.p4.10.m10.1.1.1.cmml" xref="A1.SS1.p4.10.m10.1.1.1"></minus><apply id="A1.SS1.p4.10.m10.1.1.2.cmml" xref="A1.SS1.p4.10.m10.1.1.2"><times id="A1.SS1.p4.10.m10.1.1.2.1.cmml" xref="A1.SS1.p4.10.m10.1.1.2.1"></times><cn id="A1.SS1.p4.10.m10.1.1.2.2.cmml" type="integer" xref="A1.SS1.p4.10.m10.1.1.2.2">1</cn><ci id="A1.SS1.p4.10.m10.1.1.2.3.cmml" xref="A1.SS1.p4.10.m10.1.1.2.3">𝑒</ci></apply><cn id="A1.SS1.p4.10.m10.1.1.3.cmml" type="integer" xref="A1.SS1.p4.10.m10.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p4.10.m10.1c">1e-4</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p4.10.m10.1d">1 italic_e - 4</annotation></semantics></math> and KL-Divergence loss. For the model switching experiments, we switched models at rounds <math alttext="60" class="ltx_Math" display="inline" id="A1.SS1.p4.11.m11.1"><semantics id="A1.SS1.p4.11.m11.1a"><mn id="A1.SS1.p4.11.m11.1.1" xref="A1.SS1.p4.11.m11.1.1.cmml">60</mn><annotation-xml encoding="MathML-Content" id="A1.SS1.p4.11.m11.1b"><cn id="A1.SS1.p4.11.m11.1.1.cmml" type="integer" xref="A1.SS1.p4.11.m11.1.1">60</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p4.11.m11.1c">60</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p4.11.m11.1d">60</annotation></semantics></math> and <math alttext="120" class="ltx_Math" display="inline" id="A1.SS1.p4.12.m12.1"><semantics id="A1.SS1.p4.12.m12.1a"><mn id="A1.SS1.p4.12.m12.1.1" xref="A1.SS1.p4.12.m12.1.1.cmml">120</mn><annotation-xml encoding="MathML-Content" id="A1.SS1.p4.12.m12.1b"><cn id="A1.SS1.p4.12.m12.1.1.cmml" type="integer" xref="A1.SS1.p4.12.m12.1.1">120</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p4.12.m12.1c">120</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p4.12.m12.1d">120</annotation></semantics></math> over the course of <math alttext="200" class="ltx_Math" display="inline" id="A1.SS1.p4.13.m13.1"><semantics id="A1.SS1.p4.13.m13.1a"><mn id="A1.SS1.p4.13.m13.1.1" xref="A1.SS1.p4.13.m13.1.1.cmml">200</mn><annotation-xml encoding="MathML-Content" id="A1.SS1.p4.13.m13.1b"><cn id="A1.SS1.p4.13.m13.1.1.cmml" type="integer" xref="A1.SS1.p4.13.m13.1.1">200</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p4.13.m13.1c">200</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p4.13.m13.1d">200</annotation></semantics></math> rounds of simulation.
<br class="ltx_break"/></p>
</div>
<div class="ltx_para ltx_noindent" id="A1.SS1.p5">
<p class="ltx_p" id="A1.SS1.p5.1">We use the Transfer Learning Library <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#bib.bib35" title="">35</a>]</cite> together with PyTorch <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#bib.bib62" title="">62</a>]</cite> to implement our models. Table <a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#A1.T2" title="Table 2 ‣ A.1 Implementation Details ‣ Appendix A Appendix ‣ Adjusting Pretrained Backbones for Performativity"><span class="ltx_text ltx_ref_tag">2</span></a> shows dataset specific, backbone and optimization-related hyperparameters which are chosen through grid search. All our experiments were run on a local computing cluster using RTX 3090 NVIDIA GPUs with <math alttext="30" class="ltx_Math" display="inline" id="A1.SS1.p5.1.m1.1"><semantics id="A1.SS1.p5.1.m1.1a"><mn id="A1.SS1.p5.1.m1.1.1" xref="A1.SS1.p5.1.m1.1.1.cmml">30</mn><annotation-xml encoding="MathML-Content" id="A1.SS1.p5.1.m1.1b"><cn id="A1.SS1.p5.1.m1.1.1.cmml" type="integer" xref="A1.SS1.p5.1.m1.1.1">30</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p5.1.m1.1c">30</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p5.1.m1.1d">30</annotation></semantics></math> GB of RAM. Although individual jobs are run on a single GPU, we typically used multiple GPUs to run the experiments in parallel.</p>
</div>
</section>
<section class="ltx_subsection" id="A1.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.2 </span>Additional Experimental Results</h3>
<figure class="ltx_figure" id="A1.F6">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="A1.F6.8" style="width:216.8pt;">
<p class="ltx_p ltx_align_center" id="A1.F6.8.1"><span class="ltx_text ltx_font_bold" id="A1.F6.8.1.1">Accuracy over Time</span></p>
</div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="A1.F6.9" style="width:216.8pt;"><span class="ltx_text ltx_font_bold" id="A1.F6.9.1">KL-Divergence over Time</span></p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="A1.F6.1" style="width:208.1pt;">
<img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="285" id="A1.F6.1.g1" src="extracted/5905190/figures/accuracy_over_time_TerraIncognita_0.1.png" width="479"/>
<div class="ltx_inline-block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle ltx_transformed_outer" id="A1.F6.1.1" style="width:8.7pt;height:45pt;vertical-align:-20.0pt;"><span class="ltx_transformed_inner" style="width:45.0pt;transform:translate(-18.06pt,2.92pt) rotate(-90deg) ;">
<p class="ltx_p" id="A1.F6.1.1.1"><span class="ltx_text ltx_font_bold" id="A1.F6.1.1.1.1">High Shift</span></p>
</span></div>
</div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="A1.F6.2" style="width:208.1pt;">
<img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="280" id="A1.F6.2.g1" src="extracted/5905190/figures/kl_div_loss/kl_div_loss_TerraIncognita_0.1.png" width="479"/>
<div class="ltx_inline-block ltx_minipage ltx_align_center ltx_align_middle ltx_transformed_outer" id="A1.F6.2.1" style="width:8.7pt;height:65.9pt;vertical-align:-29.5pt;"><span class="ltx_transformed_inner" style="width:65.9pt;transform:translate(-29.46pt,0pt) rotate(-90deg) ;">
<p class="ltx_p" id="A1.F6.2.1.1"><span class="ltx_text ltx_font_bold" id="A1.F6.2.1.1.1">Moderate Shift</span></p>
</span></div>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="A1.F6.3" style="width:208.1pt;">
<img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="274" id="A1.F6.3.g1" src="extracted/5905190/figures/accuracy_over_time_TerraIncognita_0.2.png" width="479"/>
</div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="A1.F6.4" style="width:208.1pt;">
<img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="267" id="A1.F6.4.g1" src="extracted/5905190/figures/kl_div_loss/kl_div_loss_TerraIncognita_0.2.png" width="479"/>
<div class="ltx_inline-block ltx_minipage ltx_align_center ltx_align_middle ltx_transformed_outer" id="A1.F6.4.1" style="width:8.7pt;height:42.4pt;vertical-align:-17.7pt;"><span class="ltx_transformed_inner" style="width:42.4pt;transform:translate(-17.71pt,0pt) rotate(-90deg) ;">
<p class="ltx_p" id="A1.F6.4.1.1"><span class="ltx_text ltx_font_bold" id="A1.F6.4.1.1.1">Low Shift</span></p>
</span></div>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="A1.F6.5" style="width:208.1pt;">
<img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="287" id="A1.F6.5.g1" src="extracted/5905190/figures/accuracy_over_time_TerraIncognita_0.8.png" width="479"/>
</div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="A1.F6.6" style="width:208.1pt;">
<img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="277" id="A1.F6.6.g1" src="extracted/5905190/figures/kl_div_loss/kl_div_loss_TerraIncognita_0.8.png" width="479"/>
</div>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="A1.F6.15.1.1" style="font-size:90%;">Figure 6</span>: </span><span class="ltx_text" id="A1.F6.16.2" style="font-size:90%;">Each row shows the accuracy over time for the TerraIncognita dataset under the corresponding shift, alongside our method’s KL-Divergence loss trajectory. The inset plots zoom in to demonstrate our model’s adaptation during early rounds. In moderate and low shift scenarios, <span class="ltx_text ltx_font_italic" id="A1.F6.16.2.1">Oracle Fine-tuning</span> scales well with an increased number of training samples, outperforming the <span class="ltx_text ltx_font_italic" id="A1.F6.16.2.2">Oracle Distribution</span>. Consistent with previous experiments, the <span class="ltx_text ltx_font_italic" id="A1.F6.16.2.3">Performative-aware Predictor (PaP)</span> excels under high shift conditions, where <span class="ltx_text ltx_font_italic" id="A1.F6.16.2.4">Oracle Fine-tuning</span> fails. Moreover, across all shift scenarios, <span class="ltx_text ltx_font_italic" id="A1.F6.16.2.5">PaP</span> learns to predict the next distribution’s label marginals very accurately after only a few rounds, showcasing its effectiveness.</span></figcaption>
</figure>
<section class="ltx_paragraph" id="A1.SS2.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">Label shift on TerraIncognita dataset.</h4>
<div class="ltx_para" id="A1.SS2.SSS0.Px1.p1">
<p class="ltx_p" id="A1.SS2.SSS0.Px1.p1.1">Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#A1.F6" title="Figure 6 ‣ A.2 Additional Experimental Results ‣ Appendix A Appendix ‣ Adjusting Pretrained Backbones for Performativity"><span class="ltx_text ltx_ref_tag">6</span></a> shows a similar pattern as of the previous experiments under the label shift setting in the high shift setting. However, for the moderate and low shift settings, it can be seen <span class="ltx_text ltx_font_italic" id="A1.SS2.SSS0.Px1.p1.1.1">Oracle Fine-tuning</span> continues to improve its performance over rounds outperforming other baselines. Due to TerraIncognita dataset’s fewer number of classes, task for the backbone is easier and it benefits from training more, and there is not enough room for the label shift to confuse the model. Moreover, <span class="ltx_text ltx_font_italic" id="A1.SS2.SSS0.Px1.p1.1.2">Performativity-aware Predictor</span> learns the prediction of next label marginals accurately after only a few rounds which reflects to its accuracy trajectory. Comparing <span class="ltx_text ltx_font_italic" id="A1.SS2.SSS0.Px1.p1.1.3">Performativity-aware Predictor</span> with <span class="ltx_text ltx_font_italic" id="A1.SS2.SSS0.Px1.p1.1.4">Oracle distribution</span> supports that as <span class="ltx_text ltx_font_italic" id="A1.SS2.SSS0.Px1.p1.1.5">PaP</span> is almost indistinguishable from its upper bound, achieving almost optimal updates. 
<br class="ltx_break"/></p>
</div>
<figure class="ltx_table" id="A1.T3">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="A1.T3.10.1.1" style="font-size:90%;">Table 3</span>: </span><span class="ltx_text" id="A1.T3.11.2" style="font-size:90%;">Number of trainable parameters and training FLOPs for different models.</span></figcaption>
<table class="ltx_tabular ltx_centering ltx_align_middle" id="A1.T3.8">
<tr class="ltx_tr" id="A1.T3.8.9">
<td class="ltx_td ltx_align_left ltx_border_tt" id="A1.T3.8.9.1"><span class="ltx_text ltx_font_bold" id="A1.T3.8.9.1.1">Model</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A1.T3.8.9.2"><span class="ltx_text ltx_font_bold" id="A1.T3.8.9.2.1">Trainable Parameters</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A1.T3.8.9.3"><span class="ltx_text ltx_font_bold" id="A1.T3.8.9.3.1">Backward GFLOPs (per round)</span></td>
</tr>
<tr class="ltx_tr" id="A1.T3.2.2">
<td class="ltx_td ltx_align_left ltx_border_t" id="A1.T3.2.2.3">No Adaptation</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T3.1.1.1"><math alttext="0" class="ltx_Math" display="inline" id="A1.T3.1.1.1.m1.1"><semantics id="A1.T3.1.1.1.m1.1a"><mn id="A1.T3.1.1.1.m1.1.1" xref="A1.T3.1.1.1.m1.1.1.cmml">0</mn><annotation-xml encoding="MathML-Content" id="A1.T3.1.1.1.m1.1b"><cn id="A1.T3.1.1.1.m1.1.1.cmml" type="integer" xref="A1.T3.1.1.1.m1.1.1">0</cn></annotation-xml></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T3.2.2.2"><math alttext="0" class="ltx_Math" display="inline" id="A1.T3.2.2.2.m1.1"><semantics id="A1.T3.2.2.2.m1.1a"><mn id="A1.T3.2.2.2.m1.1.1" xref="A1.T3.2.2.2.m1.1.1.cmml">0</mn><annotation-xml encoding="MathML-Content" id="A1.T3.2.2.2.m1.1b"><cn id="A1.T3.2.2.2.m1.1.1.cmml" type="integer" xref="A1.T3.2.2.2.m1.1.1">0</cn></annotation-xml></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A1.T3.4.4">
<td class="ltx_td ltx_align_left" id="A1.T3.4.4.3">PaP</td>
<td class="ltx_td ltx_align_center" id="A1.T3.3.3.1"><math alttext="117,348" class="ltx_Math" display="inline" id="A1.T3.3.3.1.m1.2"><semantics id="A1.T3.3.3.1.m1.2a"><mrow id="A1.T3.3.3.1.m1.2.3.2" xref="A1.T3.3.3.1.m1.2.3.1.cmml"><mn id="A1.T3.3.3.1.m1.1.1" xref="A1.T3.3.3.1.m1.1.1.cmml">117</mn><mo id="A1.T3.3.3.1.m1.2.3.2.1" xref="A1.T3.3.3.1.m1.2.3.1.cmml">,</mo><mn id="A1.T3.3.3.1.m1.2.2" xref="A1.T3.3.3.1.m1.2.2.cmml">348</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.T3.3.3.1.m1.2b"><list id="A1.T3.3.3.1.m1.2.3.1.cmml" xref="A1.T3.3.3.1.m1.2.3.2"><cn id="A1.T3.3.3.1.m1.1.1.cmml" type="integer" xref="A1.T3.3.3.1.m1.1.1">117</cn><cn id="A1.T3.3.3.1.m1.2.2.cmml" type="integer" xref="A1.T3.3.3.1.m1.2.2">348</cn></list></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.3.3.1.m1.2c">117,348</annotation><annotation encoding="application/x-llamapun" id="A1.T3.3.3.1.m1.2d">117 , 348</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="A1.T3.4.4.2"><math alttext="0.07" class="ltx_Math" display="inline" id="A1.T3.4.4.2.m1.1"><semantics id="A1.T3.4.4.2.m1.1a"><mn id="A1.T3.4.4.2.m1.1.1" xref="A1.T3.4.4.2.m1.1.1.cmml">0.07</mn><annotation-xml encoding="MathML-Content" id="A1.T3.4.4.2.m1.1b"><cn id="A1.T3.4.4.2.m1.1.1.cmml" type="float" xref="A1.T3.4.4.2.m1.1.1">0.07</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.4.4.2.m1.1c">0.07</annotation><annotation encoding="application/x-llamapun" id="A1.T3.4.4.2.m1.1d">0.07</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A1.T3.6.6">
<td class="ltx_td ltx_align_left" id="A1.T3.6.6.3">Oracle Fine-tuning (last linear)</td>
<td class="ltx_td ltx_align_center" id="A1.T3.5.5.1"><math alttext="51,300" class="ltx_Math" display="inline" id="A1.T3.5.5.1.m1.2"><semantics id="A1.T3.5.5.1.m1.2a"><mrow id="A1.T3.5.5.1.m1.2.3.2" xref="A1.T3.5.5.1.m1.2.3.1.cmml"><mn id="A1.T3.5.5.1.m1.1.1" xref="A1.T3.5.5.1.m1.1.1.cmml">51</mn><mo id="A1.T3.5.5.1.m1.2.3.2.1" xref="A1.T3.5.5.1.m1.2.3.1.cmml">,</mo><mn id="A1.T3.5.5.1.m1.2.2" xref="A1.T3.5.5.1.m1.2.2.cmml">300</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.T3.5.5.1.m1.2b"><list id="A1.T3.5.5.1.m1.2.3.1.cmml" xref="A1.T3.5.5.1.m1.2.3.2"><cn id="A1.T3.5.5.1.m1.1.1.cmml" type="integer" xref="A1.T3.5.5.1.m1.1.1">51</cn><cn id="A1.T3.5.5.1.m1.2.2.cmml" type="integer" xref="A1.T3.5.5.1.m1.2.2">300</cn></list></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.5.5.1.m1.2c">51,300</annotation><annotation encoding="application/x-llamapun" id="A1.T3.5.5.1.m1.2d">51 , 300</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="A1.T3.6.6.2"><math alttext="2.56" class="ltx_Math" display="inline" id="A1.T3.6.6.2.m1.1"><semantics id="A1.T3.6.6.2.m1.1a"><mn id="A1.T3.6.6.2.m1.1.1" xref="A1.T3.6.6.2.m1.1.1.cmml">2.56</mn><annotation-xml encoding="MathML-Content" id="A1.T3.6.6.2.m1.1b"><cn id="A1.T3.6.6.2.m1.1.1.cmml" type="float" xref="A1.T3.6.6.2.m1.1.1">2.56</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.6.6.2.m1.1c">2.56</annotation><annotation encoding="application/x-llamapun" id="A1.T3.6.6.2.m1.1d">2.56</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A1.T3.8.8">
<td class="ltx_td ltx_align_left ltx_border_bb" id="A1.T3.8.8.3">Oracle Fine-tuning</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A1.T3.7.7.1"><math alttext="11,740,812" class="ltx_Math" display="inline" id="A1.T3.7.7.1.m1.3"><semantics id="A1.T3.7.7.1.m1.3a"><mrow id="A1.T3.7.7.1.m1.3.4.2" xref="A1.T3.7.7.1.m1.3.4.1.cmml"><mn id="A1.T3.7.7.1.m1.1.1" xref="A1.T3.7.7.1.m1.1.1.cmml">11</mn><mo id="A1.T3.7.7.1.m1.3.4.2.1" xref="A1.T3.7.7.1.m1.3.4.1.cmml">,</mo><mn id="A1.T3.7.7.1.m1.2.2" xref="A1.T3.7.7.1.m1.2.2.cmml">740</mn><mo id="A1.T3.7.7.1.m1.3.4.2.2" xref="A1.T3.7.7.1.m1.3.4.1.cmml">,</mo><mn id="A1.T3.7.7.1.m1.3.3" xref="A1.T3.7.7.1.m1.3.3.cmml">812</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.T3.7.7.1.m1.3b"><list id="A1.T3.7.7.1.m1.3.4.1.cmml" xref="A1.T3.7.7.1.m1.3.4.2"><cn id="A1.T3.7.7.1.m1.1.1.cmml" type="integer" xref="A1.T3.7.7.1.m1.1.1">11</cn><cn id="A1.T3.7.7.1.m1.2.2.cmml" type="integer" xref="A1.T3.7.7.1.m1.2.2">740</cn><cn id="A1.T3.7.7.1.m1.3.3.cmml" type="integer" xref="A1.T3.7.7.1.m1.3.3">812</cn></list></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.7.7.1.m1.3c">11,740,812</annotation><annotation encoding="application/x-llamapun" id="A1.T3.7.7.1.m1.3d">11 , 740 , 812</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A1.T3.8.8.2"><math alttext="90,804" class="ltx_Math" display="inline" id="A1.T3.8.8.2.m1.2"><semantics id="A1.T3.8.8.2.m1.2a"><mrow id="A1.T3.8.8.2.m1.2.3.2" xref="A1.T3.8.8.2.m1.2.3.1.cmml"><mn id="A1.T3.8.8.2.m1.1.1" xref="A1.T3.8.8.2.m1.1.1.cmml">90</mn><mo id="A1.T3.8.8.2.m1.2.3.2.1" xref="A1.T3.8.8.2.m1.2.3.1.cmml">,</mo><mn id="A1.T3.8.8.2.m1.2.2" xref="A1.T3.8.8.2.m1.2.2.cmml">804</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.T3.8.8.2.m1.2b"><list id="A1.T3.8.8.2.m1.2.3.1.cmml" xref="A1.T3.8.8.2.m1.2.3.2"><cn id="A1.T3.8.8.2.m1.1.1.cmml" type="integer" xref="A1.T3.8.8.2.m1.1.1">90</cn><cn id="A1.T3.8.8.2.m1.2.2.cmml" type="integer" xref="A1.T3.8.8.2.m1.2.2">804</cn></list></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.8.8.2.m1.2c">90,804</annotation><annotation encoding="application/x-llamapun" id="A1.T3.8.8.2.m1.2d">90 , 804</annotation></semantics></math></td>
</tr>
</table>
</figure>
<figure class="ltx_table" id="A1.T4">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="A1.T4.35.1.1" style="font-size:90%;">Table 4</span>: </span><span class="ltx_text" id="A1.T4.36.2" style="font-size:90%;">Performance anticipation results on the CIFAR100 dataset. The table reports the performance of models with varying initializations on a balanced set, the next round performance estimate using pretrained <span class="ltx_text ltx_font_italic" id="A1.T4.36.2.1">PaP</span>, and the performance after the true shift.</span></figcaption>
<table class="ltx_tabular ltx_centering ltx_align_middle" id="A1.T4.32">
<tr class="ltx_tr" id="A1.T4.32.33">
<td class="ltx_td ltx_align_center ltx_border_tt" id="A1.T4.32.33.1"><span class="ltx_text ltx_font_bold" id="A1.T4.32.33.1.1">Model</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A1.T4.32.33.2"><span class="ltx_text ltx_font_bold" id="A1.T4.32.33.2.1">First Round</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A1.T4.32.33.3"><span class="ltx_text ltx_font_bold" id="A1.T4.32.33.3.1">Next Round Estimate</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A1.T4.32.33.4"><span class="ltx_text ltx_font_bold" id="A1.T4.32.33.4.1">True Shift Performance</span></td>
</tr>
<tr class="ltx_tr" id="A1.T4.4.4">
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T4.1.1.1">Model <math alttext="1" class="ltx_Math" display="inline" id="A1.T4.1.1.1.m1.1"><semantics id="A1.T4.1.1.1.m1.1a"><mn id="A1.T4.1.1.1.m1.1.1" xref="A1.T4.1.1.1.m1.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="A1.T4.1.1.1.m1.1b"><cn id="A1.T4.1.1.1.m1.1.1.cmml" type="integer" xref="A1.T4.1.1.1.m1.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T4.1.1.1.m1.1c">1</annotation><annotation encoding="application/x-llamapun" id="A1.T4.1.1.1.m1.1d">1</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T4.2.2.2"><math alttext="82.60" class="ltx_Math" display="inline" id="A1.T4.2.2.2.m1.1"><semantics id="A1.T4.2.2.2.m1.1a"><mn id="A1.T4.2.2.2.m1.1.1" xref="A1.T4.2.2.2.m1.1.1.cmml">82.60</mn><annotation-xml encoding="MathML-Content" id="A1.T4.2.2.2.m1.1b"><cn id="A1.T4.2.2.2.m1.1.1.cmml" type="float" xref="A1.T4.2.2.2.m1.1.1">82.60</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T4.2.2.2.m1.1c">82.60</annotation><annotation encoding="application/x-llamapun" id="A1.T4.2.2.2.m1.1d">82.60</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T4.3.3.3"><math alttext="76.42" class="ltx_Math" display="inline" id="A1.T4.3.3.3.m1.1"><semantics id="A1.T4.3.3.3.m1.1a"><mn id="A1.T4.3.3.3.m1.1.1" xref="A1.T4.3.3.3.m1.1.1.cmml">76.42</mn><annotation-xml encoding="MathML-Content" id="A1.T4.3.3.3.m1.1b"><cn id="A1.T4.3.3.3.m1.1.1.cmml" type="float" xref="A1.T4.3.3.3.m1.1.1">76.42</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T4.3.3.3.m1.1c">76.42</annotation><annotation encoding="application/x-llamapun" id="A1.T4.3.3.3.m1.1d">76.42</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T4.4.4.4"><math alttext="72.50" class="ltx_Math" display="inline" id="A1.T4.4.4.4.m1.1"><semantics id="A1.T4.4.4.4.m1.1a"><mn id="A1.T4.4.4.4.m1.1.1" xref="A1.T4.4.4.4.m1.1.1.cmml">72.50</mn><annotation-xml encoding="MathML-Content" id="A1.T4.4.4.4.m1.1b"><cn id="A1.T4.4.4.4.m1.1.1.cmml" type="float" xref="A1.T4.4.4.4.m1.1.1">72.50</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T4.4.4.4.m1.1c">72.50</annotation><annotation encoding="application/x-llamapun" id="A1.T4.4.4.4.m1.1d">72.50</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A1.T4.8.8">
<td class="ltx_td ltx_align_center" id="A1.T4.5.5.1">Model <math alttext="2" class="ltx_Math" display="inline" id="A1.T4.5.5.1.m1.1"><semantics id="A1.T4.5.5.1.m1.1a"><mn id="A1.T4.5.5.1.m1.1.1" xref="A1.T4.5.5.1.m1.1.1.cmml">2</mn><annotation-xml encoding="MathML-Content" id="A1.T4.5.5.1.m1.1b"><cn id="A1.T4.5.5.1.m1.1.1.cmml" type="integer" xref="A1.T4.5.5.1.m1.1.1">2</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T4.5.5.1.m1.1c">2</annotation><annotation encoding="application/x-llamapun" id="A1.T4.5.5.1.m1.1d">2</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center" id="A1.T4.6.6.2"><math alttext="82.12" class="ltx_Math" display="inline" id="A1.T4.6.6.2.m1.1"><semantics id="A1.T4.6.6.2.m1.1a"><mn id="A1.T4.6.6.2.m1.1.1" xref="A1.T4.6.6.2.m1.1.1.cmml">82.12</mn><annotation-xml encoding="MathML-Content" id="A1.T4.6.6.2.m1.1b"><cn id="A1.T4.6.6.2.m1.1.1.cmml" type="float" xref="A1.T4.6.6.2.m1.1.1">82.12</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T4.6.6.2.m1.1c">82.12</annotation><annotation encoding="application/x-llamapun" id="A1.T4.6.6.2.m1.1d">82.12</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="A1.T4.7.7.3"><math alttext="77.66" class="ltx_Math" display="inline" id="A1.T4.7.7.3.m1.1"><semantics id="A1.T4.7.7.3.m1.1a"><mn id="A1.T4.7.7.3.m1.1.1" xref="A1.T4.7.7.3.m1.1.1.cmml">77.66</mn><annotation-xml encoding="MathML-Content" id="A1.T4.7.7.3.m1.1b"><cn id="A1.T4.7.7.3.m1.1.1.cmml" type="float" xref="A1.T4.7.7.3.m1.1.1">77.66</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T4.7.7.3.m1.1c">77.66</annotation><annotation encoding="application/x-llamapun" id="A1.T4.7.7.3.m1.1d">77.66</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="A1.T4.8.8.4"><math alttext="78.72" class="ltx_Math" display="inline" id="A1.T4.8.8.4.m1.1"><semantics id="A1.T4.8.8.4.m1.1a"><mn id="A1.T4.8.8.4.m1.1.1" xref="A1.T4.8.8.4.m1.1.1.cmml">78.72</mn><annotation-xml encoding="MathML-Content" id="A1.T4.8.8.4.m1.1b"><cn id="A1.T4.8.8.4.m1.1.1.cmml" type="float" xref="A1.T4.8.8.4.m1.1.1">78.72</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T4.8.8.4.m1.1c">78.72</annotation><annotation encoding="application/x-llamapun" id="A1.T4.8.8.4.m1.1d">78.72</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A1.T4.12.12">
<td class="ltx_td ltx_align_center" id="A1.T4.9.9.1">Model <math alttext="3" class="ltx_Math" display="inline" id="A1.T4.9.9.1.m1.1"><semantics id="A1.T4.9.9.1.m1.1a"><mn id="A1.T4.9.9.1.m1.1.1" xref="A1.T4.9.9.1.m1.1.1.cmml">3</mn><annotation-xml encoding="MathML-Content" id="A1.T4.9.9.1.m1.1b"><cn id="A1.T4.9.9.1.m1.1.1.cmml" type="integer" xref="A1.T4.9.9.1.m1.1.1">3</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T4.9.9.1.m1.1c">3</annotation><annotation encoding="application/x-llamapun" id="A1.T4.9.9.1.m1.1d">3</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center" id="A1.T4.10.10.2"><math alttext="81.80" class="ltx_Math" display="inline" id="A1.T4.10.10.2.m1.1"><semantics id="A1.T4.10.10.2.m1.1a"><mn id="A1.T4.10.10.2.m1.1.1" xref="A1.T4.10.10.2.m1.1.1.cmml">81.80</mn><annotation-xml encoding="MathML-Content" id="A1.T4.10.10.2.m1.1b"><cn id="A1.T4.10.10.2.m1.1.1.cmml" type="float" xref="A1.T4.10.10.2.m1.1.1">81.80</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T4.10.10.2.m1.1c">81.80</annotation><annotation encoding="application/x-llamapun" id="A1.T4.10.10.2.m1.1d">81.80</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="A1.T4.11.11.3"><math alttext="77.53" class="ltx_Math" display="inline" id="A1.T4.11.11.3.m1.1"><semantics id="A1.T4.11.11.3.m1.1a"><mn id="A1.T4.11.11.3.m1.1.1" xref="A1.T4.11.11.3.m1.1.1.cmml">77.53</mn><annotation-xml encoding="MathML-Content" id="A1.T4.11.11.3.m1.1b"><cn id="A1.T4.11.11.3.m1.1.1.cmml" type="float" xref="A1.T4.11.11.3.m1.1.1">77.53</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T4.11.11.3.m1.1c">77.53</annotation><annotation encoding="application/x-llamapun" id="A1.T4.11.11.3.m1.1d">77.53</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="A1.T4.12.12.4"><math alttext="75.90" class="ltx_Math" display="inline" id="A1.T4.12.12.4.m1.1"><semantics id="A1.T4.12.12.4.m1.1a"><mn id="A1.T4.12.12.4.m1.1.1" xref="A1.T4.12.12.4.m1.1.1.cmml">75.90</mn><annotation-xml encoding="MathML-Content" id="A1.T4.12.12.4.m1.1b"><cn id="A1.T4.12.12.4.m1.1.1.cmml" type="float" xref="A1.T4.12.12.4.m1.1.1">75.90</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T4.12.12.4.m1.1c">75.90</annotation><annotation encoding="application/x-llamapun" id="A1.T4.12.12.4.m1.1d">75.90</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A1.T4.16.16">
<td class="ltx_td ltx_align_center" id="A1.T4.13.13.1">Model <math alttext="4" class="ltx_Math" display="inline" id="A1.T4.13.13.1.m1.1"><semantics id="A1.T4.13.13.1.m1.1a"><mn id="A1.T4.13.13.1.m1.1.1" xref="A1.T4.13.13.1.m1.1.1.cmml">4</mn><annotation-xml encoding="MathML-Content" id="A1.T4.13.13.1.m1.1b"><cn id="A1.T4.13.13.1.m1.1.1.cmml" type="integer" xref="A1.T4.13.13.1.m1.1.1">4</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T4.13.13.1.m1.1c">4</annotation><annotation encoding="application/x-llamapun" id="A1.T4.13.13.1.m1.1d">4</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center" id="A1.T4.14.14.2"><math alttext="79.56" class="ltx_Math" display="inline" id="A1.T4.14.14.2.m1.1"><semantics id="A1.T4.14.14.2.m1.1a"><mn id="A1.T4.14.14.2.m1.1.1" xref="A1.T4.14.14.2.m1.1.1.cmml">79.56</mn><annotation-xml encoding="MathML-Content" id="A1.T4.14.14.2.m1.1b"><cn id="A1.T4.14.14.2.m1.1.1.cmml" type="float" xref="A1.T4.14.14.2.m1.1.1">79.56</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T4.14.14.2.m1.1c">79.56</annotation><annotation encoding="application/x-llamapun" id="A1.T4.14.14.2.m1.1d">79.56</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="A1.T4.15.15.3"><math alttext="72.95" class="ltx_Math" display="inline" id="A1.T4.15.15.3.m1.1"><semantics id="A1.T4.15.15.3.m1.1a"><mn id="A1.T4.15.15.3.m1.1.1" xref="A1.T4.15.15.3.m1.1.1.cmml">72.95</mn><annotation-xml encoding="MathML-Content" id="A1.T4.15.15.3.m1.1b"><cn id="A1.T4.15.15.3.m1.1.1.cmml" type="float" xref="A1.T4.15.15.3.m1.1.1">72.95</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T4.15.15.3.m1.1c">72.95</annotation><annotation encoding="application/x-llamapun" id="A1.T4.15.15.3.m1.1d">72.95</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="A1.T4.16.16.4"><math alttext="69.40" class="ltx_Math" display="inline" id="A1.T4.16.16.4.m1.1"><semantics id="A1.T4.16.16.4.m1.1a"><mn id="A1.T4.16.16.4.m1.1.1" xref="A1.T4.16.16.4.m1.1.1.cmml">69.40</mn><annotation-xml encoding="MathML-Content" id="A1.T4.16.16.4.m1.1b"><cn id="A1.T4.16.16.4.m1.1.1.cmml" type="float" xref="A1.T4.16.16.4.m1.1.1">69.40</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T4.16.16.4.m1.1c">69.40</annotation><annotation encoding="application/x-llamapun" id="A1.T4.16.16.4.m1.1d">69.40</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A1.T4.20.20">
<td class="ltx_td ltx_align_center" id="A1.T4.17.17.1">Model <math alttext="5" class="ltx_Math" display="inline" id="A1.T4.17.17.1.m1.1"><semantics id="A1.T4.17.17.1.m1.1a"><mn id="A1.T4.17.17.1.m1.1.1" xref="A1.T4.17.17.1.m1.1.1.cmml">5</mn><annotation-xml encoding="MathML-Content" id="A1.T4.17.17.1.m1.1b"><cn id="A1.T4.17.17.1.m1.1.1.cmml" type="integer" xref="A1.T4.17.17.1.m1.1.1">5</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T4.17.17.1.m1.1c">5</annotation><annotation encoding="application/x-llamapun" id="A1.T4.17.17.1.m1.1d">5</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center" id="A1.T4.18.18.2"><math alttext="78.90" class="ltx_Math" display="inline" id="A1.T4.18.18.2.m1.1"><semantics id="A1.T4.18.18.2.m1.1a"><mn id="A1.T4.18.18.2.m1.1.1" xref="A1.T4.18.18.2.m1.1.1.cmml">78.90</mn><annotation-xml encoding="MathML-Content" id="A1.T4.18.18.2.m1.1b"><cn id="A1.T4.18.18.2.m1.1.1.cmml" type="float" xref="A1.T4.18.18.2.m1.1.1">78.90</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T4.18.18.2.m1.1c">78.90</annotation><annotation encoding="application/x-llamapun" id="A1.T4.18.18.2.m1.1d">78.90</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="A1.T4.19.19.3"><math alttext="72.13" class="ltx_Math" display="inline" id="A1.T4.19.19.3.m1.1"><semantics id="A1.T4.19.19.3.m1.1a"><mn id="A1.T4.19.19.3.m1.1.1" xref="A1.T4.19.19.3.m1.1.1.cmml">72.13</mn><annotation-xml encoding="MathML-Content" id="A1.T4.19.19.3.m1.1b"><cn id="A1.T4.19.19.3.m1.1.1.cmml" type="float" xref="A1.T4.19.19.3.m1.1.1">72.13</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T4.19.19.3.m1.1c">72.13</annotation><annotation encoding="application/x-llamapun" id="A1.T4.19.19.3.m1.1d">72.13</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="A1.T4.20.20.4"><math alttext="66.10" class="ltx_Math" display="inline" id="A1.T4.20.20.4.m1.1"><semantics id="A1.T4.20.20.4.m1.1a"><mn id="A1.T4.20.20.4.m1.1.1" xref="A1.T4.20.20.4.m1.1.1.cmml">66.10</mn><annotation-xml encoding="MathML-Content" id="A1.T4.20.20.4.m1.1b"><cn id="A1.T4.20.20.4.m1.1.1.cmml" type="float" xref="A1.T4.20.20.4.m1.1.1">66.10</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T4.20.20.4.m1.1c">66.10</annotation><annotation encoding="application/x-llamapun" id="A1.T4.20.20.4.m1.1d">66.10</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A1.T4.24.24">
<td class="ltx_td ltx_align_center" id="A1.T4.21.21.1">Model <math alttext="6" class="ltx_Math" display="inline" id="A1.T4.21.21.1.m1.1"><semantics id="A1.T4.21.21.1.m1.1a"><mn id="A1.T4.21.21.1.m1.1.1" xref="A1.T4.21.21.1.m1.1.1.cmml">6</mn><annotation-xml encoding="MathML-Content" id="A1.T4.21.21.1.m1.1b"><cn id="A1.T4.21.21.1.m1.1.1.cmml" type="integer" xref="A1.T4.21.21.1.m1.1.1">6</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T4.21.21.1.m1.1c">6</annotation><annotation encoding="application/x-llamapun" id="A1.T4.21.21.1.m1.1d">6</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center" id="A1.T4.22.22.2"><math alttext="73.16" class="ltx_Math" display="inline" id="A1.T4.22.22.2.m1.1"><semantics id="A1.T4.22.22.2.m1.1a"><mn id="A1.T4.22.22.2.m1.1.1" xref="A1.T4.22.22.2.m1.1.1.cmml">73.16</mn><annotation-xml encoding="MathML-Content" id="A1.T4.22.22.2.m1.1b"><cn id="A1.T4.22.22.2.m1.1.1.cmml" type="float" xref="A1.T4.22.22.2.m1.1.1">73.16</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T4.22.22.2.m1.1c">73.16</annotation><annotation encoding="application/x-llamapun" id="A1.T4.22.22.2.m1.1d">73.16</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="A1.T4.23.23.3"><math alttext="67.15" class="ltx_Math" display="inline" id="A1.T4.23.23.3.m1.1"><semantics id="A1.T4.23.23.3.m1.1a"><mn id="A1.T4.23.23.3.m1.1.1" xref="A1.T4.23.23.3.m1.1.1.cmml">67.15</mn><annotation-xml encoding="MathML-Content" id="A1.T4.23.23.3.m1.1b"><cn id="A1.T4.23.23.3.m1.1.1.cmml" type="float" xref="A1.T4.23.23.3.m1.1.1">67.15</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T4.23.23.3.m1.1c">67.15</annotation><annotation encoding="application/x-llamapun" id="A1.T4.23.23.3.m1.1d">67.15</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="A1.T4.24.24.4"><math alttext="62.08" class="ltx_Math" display="inline" id="A1.T4.24.24.4.m1.1"><semantics id="A1.T4.24.24.4.m1.1a"><mn id="A1.T4.24.24.4.m1.1.1" xref="A1.T4.24.24.4.m1.1.1.cmml">62.08</mn><annotation-xml encoding="MathML-Content" id="A1.T4.24.24.4.m1.1b"><cn id="A1.T4.24.24.4.m1.1.1.cmml" type="float" xref="A1.T4.24.24.4.m1.1.1">62.08</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T4.24.24.4.m1.1c">62.08</annotation><annotation encoding="application/x-llamapun" id="A1.T4.24.24.4.m1.1d">62.08</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A1.T4.28.28">
<td class="ltx_td ltx_align_center" id="A1.T4.25.25.1">Model <math alttext="7" class="ltx_Math" display="inline" id="A1.T4.25.25.1.m1.1"><semantics id="A1.T4.25.25.1.m1.1a"><mn id="A1.T4.25.25.1.m1.1.1" xref="A1.T4.25.25.1.m1.1.1.cmml">7</mn><annotation-xml encoding="MathML-Content" id="A1.T4.25.25.1.m1.1b"><cn id="A1.T4.25.25.1.m1.1.1.cmml" type="integer" xref="A1.T4.25.25.1.m1.1.1">7</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T4.25.25.1.m1.1c">7</annotation><annotation encoding="application/x-llamapun" id="A1.T4.25.25.1.m1.1d">7</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center" id="A1.T4.26.26.2"><math alttext="71.74" class="ltx_Math" display="inline" id="A1.T4.26.26.2.m1.1"><semantics id="A1.T4.26.26.2.m1.1a"><mn id="A1.T4.26.26.2.m1.1.1" xref="A1.T4.26.26.2.m1.1.1.cmml">71.74</mn><annotation-xml encoding="MathML-Content" id="A1.T4.26.26.2.m1.1b"><cn id="A1.T4.26.26.2.m1.1.1.cmml" type="float" xref="A1.T4.26.26.2.m1.1.1">71.74</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T4.26.26.2.m1.1c">71.74</annotation><annotation encoding="application/x-llamapun" id="A1.T4.26.26.2.m1.1d">71.74</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="A1.T4.27.27.3"><math alttext="62.75" class="ltx_Math" display="inline" id="A1.T4.27.27.3.m1.1"><semantics id="A1.T4.27.27.3.m1.1a"><mn id="A1.T4.27.27.3.m1.1.1" xref="A1.T4.27.27.3.m1.1.1.cmml">62.75</mn><annotation-xml encoding="MathML-Content" id="A1.T4.27.27.3.m1.1b"><cn id="A1.T4.27.27.3.m1.1.1.cmml" type="float" xref="A1.T4.27.27.3.m1.1.1">62.75</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T4.27.27.3.m1.1c">62.75</annotation><annotation encoding="application/x-llamapun" id="A1.T4.27.27.3.m1.1d">62.75</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="A1.T4.28.28.4"><math alttext="56.58" class="ltx_Math" display="inline" id="A1.T4.28.28.4.m1.1"><semantics id="A1.T4.28.28.4.m1.1a"><mn id="A1.T4.28.28.4.m1.1.1" xref="A1.T4.28.28.4.m1.1.1.cmml">56.58</mn><annotation-xml encoding="MathML-Content" id="A1.T4.28.28.4.m1.1b"><cn id="A1.T4.28.28.4.m1.1.1.cmml" type="float" xref="A1.T4.28.28.4.m1.1.1">56.58</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T4.28.28.4.m1.1c">56.58</annotation><annotation encoding="application/x-llamapun" id="A1.T4.28.28.4.m1.1d">56.58</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A1.T4.32.32">
<td class="ltx_td ltx_align_center ltx_border_bb" id="A1.T4.29.29.1">Model <math alttext="8" class="ltx_Math" display="inline" id="A1.T4.29.29.1.m1.1"><semantics id="A1.T4.29.29.1.m1.1a"><mn id="A1.T4.29.29.1.m1.1.1" xref="A1.T4.29.29.1.m1.1.1.cmml">8</mn><annotation-xml encoding="MathML-Content" id="A1.T4.29.29.1.m1.1b"><cn id="A1.T4.29.29.1.m1.1.1.cmml" type="integer" xref="A1.T4.29.29.1.m1.1.1">8</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T4.29.29.1.m1.1c">8</annotation><annotation encoding="application/x-llamapun" id="A1.T4.29.29.1.m1.1d">8</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A1.T4.30.30.2"><math alttext="71.52" class="ltx_Math" display="inline" id="A1.T4.30.30.2.m1.1"><semantics id="A1.T4.30.30.2.m1.1a"><mn id="A1.T4.30.30.2.m1.1.1" xref="A1.T4.30.30.2.m1.1.1.cmml">71.52</mn><annotation-xml encoding="MathML-Content" id="A1.T4.30.30.2.m1.1b"><cn id="A1.T4.30.30.2.m1.1.1.cmml" type="float" xref="A1.T4.30.30.2.m1.1.1">71.52</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T4.30.30.2.m1.1c">71.52</annotation><annotation encoding="application/x-llamapun" id="A1.T4.30.30.2.m1.1d">71.52</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A1.T4.31.31.3"><math alttext="62.82" class="ltx_Math" display="inline" id="A1.T4.31.31.3.m1.1"><semantics id="A1.T4.31.31.3.m1.1a"><mn id="A1.T4.31.31.3.m1.1.1" xref="A1.T4.31.31.3.m1.1.1.cmml">62.82</mn><annotation-xml encoding="MathML-Content" id="A1.T4.31.31.3.m1.1b"><cn id="A1.T4.31.31.3.m1.1.1.cmml" type="float" xref="A1.T4.31.31.3.m1.1.1">62.82</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T4.31.31.3.m1.1c">62.82</annotation><annotation encoding="application/x-llamapun" id="A1.T4.31.31.3.m1.1d">62.82</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A1.T4.32.32.4"><math alttext="64.00" class="ltx_Math" display="inline" id="A1.T4.32.32.4.m1.1"><semantics id="A1.T4.32.32.4.m1.1a"><mn id="A1.T4.32.32.4.m1.1.1" xref="A1.T4.32.32.4.m1.1.1.cmml">64.00</mn><annotation-xml encoding="MathML-Content" id="A1.T4.32.32.4.m1.1b"><cn id="A1.T4.32.32.4.m1.1.1.cmml" type="float" xref="A1.T4.32.32.4.m1.1.1">64.00</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T4.32.32.4.m1.1c">64.00</annotation><annotation encoding="application/x-llamapun" id="A1.T4.32.32.4.m1.1d">64.00</annotation></semantics></math></td>
</tr>
</table>
</figure>
<figure class="ltx_figure" id="A1.F7"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="202" id="A1.F7.g1" src="extracted/5905190/figures/rebuttal_ablation/accuracy_over_time_ImageNet100_ABLATION_2.png" width="359"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="A1.F7.6.3.1" style="font-size:90%;">Figure 7</span>: </span><span class="ltx_text" id="A1.F7.4.2" style="font-size:90%;">Additional experiments for Oracle-finetuning baseline: including tuning only the last linear layer, training with <math alttext="5" class="ltx_Math" display="inline" id="A1.F7.3.1.m1.1"><semantics id="A1.F7.3.1.m1.1b"><mn id="A1.F7.3.1.m1.1.1" xref="A1.F7.3.1.m1.1.1.cmml">5</mn><annotation-xml encoding="MathML-Content" id="A1.F7.3.1.m1.1c"><cn id="A1.F7.3.1.m1.1.1.cmml" type="integer" xref="A1.F7.3.1.m1.1.1">5</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.F7.3.1.m1.1d">5</annotation><annotation encoding="application/x-llamapun" id="A1.F7.3.1.m1.1e">5</annotation></semantics></math> epochs and training with <math alttext="40" class="ltx_Math" display="inline" id="A1.F7.4.2.m2.1"><semantics id="A1.F7.4.2.m2.1b"><mn id="A1.F7.4.2.m2.1.1" xref="A1.F7.4.2.m2.1.1.cmml">40</mn><annotation-xml encoding="MathML-Content" id="A1.F7.4.2.m2.1c"><cn id="A1.F7.4.2.m2.1.1.cmml" type="integer" xref="A1.F7.4.2.m2.1.1">40</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.F7.4.2.m2.1d">40</annotation><annotation encoding="application/x-llamapun" id="A1.F7.4.2.m2.1e">40</annotation></semantics></math> epochs.</span></figcaption>
</figure>
</section>
<section class="ltx_paragraph" id="A1.SS2.SSS0.Px2">
<h4 class="ltx_title ltx_title_paragraph">Training only the last linear layer does not improve model robustness to performative shift.</h4>
<div class="ltx_para" id="A1.SS2.SSS0.Px2.p1">
<p class="ltx_p" id="A1.SS2.SSS0.Px2.p1.1">Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#A1.F7" title="Figure 7 ‣ Label shift on TerraIncognita dataset. ‣ A.2 Additional Experimental Results ‣ Appendix A Appendix ‣ Adjusting Pretrained Backbones for Performativity"><span class="ltx_text ltx_ref_tag">7</span></a> demonstrates that training only the classification head is sufficient to incorporate the current distribution’s label bias. Although computationally cheaper, this approach suffers from high performative shift similarly to <span class="ltx_text ltx_font_italic" id="A1.SS2.SSS0.Px2.p1.1.1">Oracle Fine-tuning</span>.</p>
</div>
</section>
<section class="ltx_paragraph" id="A1.SS2.SSS0.Px3">
<h4 class="ltx_title ltx_title_paragraph">Varying training epochs on the current distribution for <span class="ltx_text ltx_font_italic" id="A1.SS2.SSS0.Px3.1.1">Oracle Fine-tuning</span> controls distribution bias incorporation.</h4>
<div class="ltx_para" id="A1.SS2.SSS0.Px3.p1">
<p class="ltx_p" id="A1.SS2.SSS0.Px3.p1.1">Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#A1.F7" title="Figure 7 ‣ Label shift on TerraIncognita dataset. ‣ A.2 Additional Experimental Results ‣ Appendix A Appendix ‣ Adjusting Pretrained Backbones for Performativity"><span class="ltx_text ltx_ref_tag">7</span></a> illustrates the effect of different training epochs on the current distribution. In our main experiments, we trained until convergence using the current distribution dataset. Setting the number of epochs to 0 reduces <span class="ltx_text ltx_font_italic" id="A1.SS2.SSS0.Px3.p1.1.1">Oracle Fine-tuning</span> to <span class="ltx_text ltx_font_italic" id="A1.SS2.SSS0.Px3.p1.1.2">No Adaptation</span>. Our ablation study compares training for 5 and 40 epochs. As expected, in high performative shift scenarios, partial fitting to the current distribution (5 epochs) outperforms full fitting (40 epochs) due to significant differences between consecutive distributions.</p>
</div>
</section>
<section class="ltx_paragraph" id="A1.SS2.SSS0.Px4">
<h4 class="ltx_title ltx_title_paragraph">
<span class="ltx_text ltx_font_italic" id="A1.SS2.SSS0.Px4.1.1">PaP</span> is a lightweight adaptation module.</h4>
<div class="ltx_para" id="A1.SS2.SSS0.Px4.p1">
<p class="ltx_p" id="A1.SS2.SSS0.Px4.p1.1">Table <a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#A1.T3" title="Table 3 ‣ Label shift on TerraIncognita dataset. ‣ A.2 Additional Experimental Results ‣ Appendix A Appendix ‣ Adjusting Pretrained Backbones for Performativity"><span class="ltx_text ltx_ref_tag">3</span></a> compares the number of trainable parameters and training FLOPs across baselines. <span class="ltx_text ltx_font_italic" id="A1.SS2.SSS0.Px4.p1.1.1">PaP</span> offers negligible computational cost while providing (i) adaptation for models under performative label shift, and (ii) evaluation of multiple potential models for deployment selection.</p>
</div>
</section>
<section class="ltx_paragraph" id="A1.SS2.SSS0.Px5">
<h4 class="ltx_title ltx_title_paragraph">
<span class="ltx_text ltx_font_italic" id="A1.SS2.SSS0.Px5.1.1">PaP</span> can be used for pre-deployment performance evaluation.</h4>
<div class="ltx_para" id="A1.SS2.SSS0.Px5.p1">
<p class="ltx_p" id="A1.SS2.SSS0.Px5.p1.1">Table <a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#A1.T4" title="Table 4 ‣ Label shift on TerraIncognita dataset. ‣ A.2 Additional Experimental Results ‣ Appendix A Appendix ‣ Adjusting Pretrained Backbones for Performativity"><span class="ltx_text ltx_ref_tag">4</span></a> expands on Table <a class="ltx_ref" href="https://arxiv.org/html/2410.04499v1#S4.T1" title="Table 1 ‣ 4.1 Performative label shift ‣ 4 Experiments ‣ Adjusting Pretrained Backbones for Performativity"><span class="ltx_text ltx_ref_tag">1</span></a>, demonstrating that <span class="ltx_text ltx_font_italic" id="A1.SS2.SSS0.Px5.p1.1.1">PaP</span> rankings closely align with true shift performance. Moreover, PaP provides more accurate estimates of post-shift performance compared to initial model evaluations on the first distribution.</p>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
</section>
</section><div about="" class="ltx_rdf" property="dcterms:creator"></div>
<div about="" class="ltx_rdf" content="language model, llm, calibration, benchmark, folktexts, datasets" property="dcterms:subject"></div>
<div about="" class="ltx_rdf" property="dcterms:title"></div>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Sun Oct  6 14:33:40 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
