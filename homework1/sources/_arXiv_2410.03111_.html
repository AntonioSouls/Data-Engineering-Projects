<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>LoRC: Low-Rank Compression for LLMs KV Cache with a Progressive Compression Strategy</title>
<!--Generated on Fri Oct  4 02:59:27 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<base href="/html/2410.03111v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.03111v1#S1" title="In LoRC: Low-Rank Compression for LLMs KV Cache with a Progressive Compression Strategy"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03111v1#S2" title="In LoRC: Low-Rank Compression for LLMs KV Cache with a Progressive Compression Strategy"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Related Works</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03111v1#S2.SS1" title="In 2 Related Works ‣ LoRC: Low-Rank Compression for LLMs KV Cache with a Progressive Compression Strategy"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.1 </span>Attention Mechanism</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03111v1#S2.SS2" title="In 2 Related Works ‣ LoRC: Low-Rank Compression for LLMs KV Cache with a Progressive Compression Strategy"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2 </span>KV Cache Compression</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.03111v1#S3" title="In LoRC: Low-Rank Compression for LLMs KV Cache with a Progressive Compression Strategy"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Preliminary: Attention Mechanism and KV Cache</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03111v1#S4" title="In LoRC: Low-Rank Compression for LLMs KV Cache with a Progressive Compression Strategy"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Method</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03111v1#S4.SS1" title="In 4 Method ‣ LoRC: Low-Rank Compression for LLMs KV Cache with a Progressive Compression Strategy"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>KV Cache Compression via Low-rank Approximation of Weight Matrices</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03111v1#S4.SS2" title="In 4 Method ‣ LoRC: Low-Rank Compression for LLMs KV Cache with a Progressive Compression Strategy"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>Progressive Compression Strategy</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.03111v1#S4.SS2.SSS0.Px1" title="In 4.2 Progressive Compression Strategy ‣ 4 Method ‣ LoRC: Low-Rank Compression for LLMs KV Cache with a Progressive Compression Strategy"><span class="ltx_text ltx_ref_title">Condition Number and Sensitivity Analysis</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03111v1#S4.SS3" title="In 4 Method ‣ LoRC: Low-Rank Compression for LLMs KV Cache with a Progressive Compression Strategy"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3 </span>Multi-head Attention and Group-query Attention</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03111v1#S5" title="In LoRC: Low-Rank Compression for LLMs KV Cache with a Progressive Compression Strategy"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Error Bounds for KV Cache Compression</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03111v1#S5.SS1" title="In 5 Error Bounds for KV Cache Compression ‣ LoRC: Low-Rank Compression for LLMs KV Cache with a Progressive Compression Strategy"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.1 </span>Error Bound for Key/Value Matrix Approximation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03111v1#S5.SS2" title="In 5 Error Bounds for KV Cache Compression ‣ LoRC: Low-Rank Compression for LLMs KV Cache with a Progressive Compression Strategy"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.2 </span>Single Layer Error Bound Including Nonlinearities</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03111v1#S5.SS3" title="In 5 Error Bounds for KV Cache Compression ‣ LoRC: Low-Rank Compression for LLMs KV Cache with a Progressive Compression Strategy"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.3 </span>Error Propagation Bound</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03111v1#S6" title="In LoRC: Low-Rank Compression for LLMs KV Cache with a Progressive Compression Strategy"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6 </span>Experiment</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03111v1#S6.SS1" title="In 6 Experiment ‣ LoRC: Low-Rank Compression for LLMs KV Cache with a Progressive Compression Strategy"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6.1 </span>Models</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03111v1#S6.SS2" title="In 6 Experiment ‣ LoRC: Low-Rank Compression for LLMs KV Cache with a Progressive Compression Strategy"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6.2 </span>Implementation Details</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03111v1#S6.SS3" title="In 6 Experiment ‣ LoRC: Low-Rank Compression for LLMs KV Cache with a Progressive Compression Strategy"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6.3 </span>Dataset</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03111v1#S6.SS4" title="In 6 Experiment ‣ LoRC: Low-Rank Compression for LLMs KV Cache with a Progressive Compression Strategy"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6.4 </span>Main Results</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03111v1#S6.SS5" title="In 6 Experiment ‣ LoRC: Low-Rank Compression for LLMs KV Cache with a Progressive Compression Strategy"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6.5 </span>Single Layer Profiling</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03111v1#S6.SS6" title="In 6 Experiment ‣ LoRC: Low-Rank Compression for LLMs KV Cache with a Progressive Compression Strategy"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6.6 </span>Curse of shallow layers</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03111v1#S6.SS7" title="In 6 Experiment ‣ LoRC: Low-Rank Compression for LLMs KV Cache with a Progressive Compression Strategy"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6.7 </span>Memory footprint reduction analysis</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.03111v1#S7" title="In LoRC: Low-Rank Compression for LLMs KV Cache with a Progressive Compression Strategy"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">7 </span>Conclusions</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03111v1#A1" title="In LoRC: Low-Rank Compression for LLMs KV Cache with a Progressive Compression Strategy"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A </span>Detailed Proofs</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03111v1#A1.SS1" title="In Appendix A Detailed Proofs ‣ LoRC: Low-Rank Compression for LLMs KV Cache with a Progressive Compression Strategy"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.1 </span>Proof of Theorem <span class="ltx_text ltx_ref_tag">1</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03111v1#A1.SS2" title="In Appendix A Detailed Proofs ‣ LoRC: Low-Rank Compression for LLMs KV Cache with a Progressive Compression Strategy"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.2 </span>Proof of Theorem <span class="ltx_text ltx_ref_tag">3</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03111v1#A1.SS3" title="In Appendix A Detailed Proofs ‣ LoRC: Low-Rank Compression for LLMs KV Cache with a Progressive Compression Strategy"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.3 </span>Note on Activation Functions and the Lipschitz Constant</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2410.03111v1#A2" title="In LoRC: Low-Rank Compression for LLMs KV Cache with a Progressive Compression Strategy"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B </span>Reconstruction Error of Matrix SVD</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2410.03111v1#A3" title="In LoRC: Low-Rank Compression for LLMs KV Cache with a Progressive Compression Strategy"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">C </span>Adjusted Position Embedding</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2410.03111v1#A4" title="In LoRC: Low-Rank Compression for LLMs KV Cache with a Progressive Compression Strategy"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">D </span>Computational details</span></a></li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line" lang="en">
<h1 class="ltx_title ltx_title_document">
<span class="ltx_text ltx_font_smallcaps" id="id10.id1">LoRC</span>: Low-Rank Compression for LLMs KV Cache with a Progressive Compression Strategy</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Rongzhi Zhang<sup class="ltx_sup" id="id11.10.id1"><span class="ltx_text ltx_font_italic" id="id11.10.id1.1">1</span></sup>, Kuang Wang<sup class="ltx_sup" id="id12.11.id2"><span class="ltx_text ltx_font_italic" id="id12.11.id2.1">1</span></sup>, Liyuan Liu<sup class="ltx_sup" id="id13.12.id3">2</sup>, Shuohang Wang<sup class="ltx_sup" id="id14.13.id4">2</sup>
<br class="ltx_break"/><span class="ltx_text ltx_font_bold" id="id7.7.3">Hao Cheng<sup class="ltx_sup" id="id7.7.3.1"><span class="ltx_text ltx_font_medium" id="id7.7.3.1.1">1</span></sup>, Chao Zhang<sup class="ltx_sup" id="id7.7.3.2"><span class="ltx_text ltx_font_medium" id="id7.7.3.2.1">1</span></sup>, Yelong Shen<sup class="ltx_sup" id="id7.7.3.3"><span class="ltx_text ltx_font_medium" id="id7.7.3.3.1">2</span></sup> </span>
<br class="ltx_break"/><span class="ltx_text ltx_font_typewriter" id="id15.14.id5">{rongzhi.zhang, kuanwang, chaozhang}@gatech.edu</span>
<br class="ltx_break"/><span class="ltx_text ltx_font_typewriter" id="id16.15.id6">{lucliu, shuowa, chehao, yeshe}@microsoft.com</span>
<br class="ltx_break"/><sup class="ltx_sup" id="id17.16.id7">1</sup>Georgia Tech, <sup class="ltx_sup" id="id18.17.id8">2</sup>Microsoft 
<br class="ltx_break"/>
</span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id19.id1"><span class="ltx_text" id="id19.id1.1">The Key-Value (KV) cache is a crucial component in serving transformer-based autoregressive large language models (LLMs), enabling faster inference by storing previously computed KV vectors. However, its memory consumption scales linearly with sequence length and batch size, posing a significant bottleneck in LLM deployment.
Existing approaches to mitigate this issue include: (1) efficient attention variants integrated in upcycling stages, which requires extensive parameter tuning thus unsuitable for pre-trained LLMs; (2) KV cache compression at test time, primarily through token eviction policies, which often overlook inter-layer dependencies and can be task-specific.</span></p>
<p class="ltx_p" id="id20.id2"><span class="ltx_text" id="id20.id2.1">This paper introduces an orthogonal approach to KV cache compression.
We propose a <span class="ltx_text ltx_font_italic" id="id20.id2.1.1">low-rank approximation</span> of KV weight matrices, allowing for plug-in integration with existing transformer-based LLMs without model retraining.
To effectively compress KV cache at the weight level, we adjust for layerwise sensitivity and introduce a <span class="ltx_text ltx_font_italic" id="id20.id2.1.2">progressive compression</span> strategy, which is supported by our theoretical analysis on how compression errors accumulate in deep networks. Our method is designed to function without model tuning in upcycling stages or task-specific profiling in test stages.
Extensive experiments with LLaMA models ranging from 8B to 70B parameters across various tasks show that our approach significantly reduces the GPU memory footprint while maintaining performance.</span></p>
</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">Autoregressive large language models (LLMs) such as GPT <cite class="ltx_cite ltx_citemacro_citep">(Achiam et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03111v1#bib.bib1" title="">2023</a>)</cite>, PaLM <cite class="ltx_cite ltx_citemacro_citep">(Chowdhery et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03111v1#bib.bib3" title="">2023</a>)</cite>, and LLaMA <cite class="ltx_cite ltx_citemacro_citep">(Touvron et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03111v1#bib.bib24" title="">2023</a>)</cite>, built upon transformer architectures <cite class="ltx_cite ltx_citemacro_citep">(Vaswani et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03111v1#bib.bib25" title="">2017</a>)</cite>, have shown remarkable capabilities across a wide range of tasks.
However, the attention mechanism underpinning those models poses significant challenges to the efficiency of their deployment, particularly the management of the Key-Value (KV) cache.
The KV cache is originally designed to accelerate the generation process by storing intermediate attention KV vectors, thus avoiding recomputation of shared prefixes for each autoregressively generated token.
Despite reducing computational overhead, the KV cache significantly increases memory footprints, as its size scales
linearly with both sequence length and batch size.
This drives the need for KV cache compression to enable cost-effective deployment of LLMs across various devices and platforms.</p>
</div>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">To address the overhead of the original attention mechanism, one prominent line of work aims to design more efficient attention variants, such as multi-query attention (MQA) <cite class="ltx_cite ltx_citemacro_citep">(Shazeer, <a class="ltx_ref" href="https://arxiv.org/html/2410.03111v1#bib.bib20" title="">2019</a>)</cite> and group-query attention (GQA) <cite class="ltx_cite ltx_citemacro_citep">(Ainslie et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03111v1#bib.bib2" title="">2023</a>)</cite>, which inherently reduce the corresponding KV cache.
Nevertheless, those techniques typically require upcycling existing models. Without proper training, their direct application often results in degraded performance <cite class="ltx_cite ltx_citemacro_citep">(Ribar et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03111v1#bib.bib18" title="">2023</a>; Ainslie et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03111v1#bib.bib2" title="">2023</a>; Liu et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03111v1#bib.bib13" title="">2024b</a>)</cite>, thereby making them unsuitable for deployment in resource-constrained environments. Recently, <cite class="ltx_cite ltx_citemacro_cite">Liu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03111v1#bib.bib12" title="">2024a</a>)</cite> design a multi-head latent attention (MLA) for efficient inference, utilizing low-rank key-value union compression to reduce KV cache. However, similar to MQA and GQA, MLA is also integrated during the model’s training cycle, thus not directly applicable to pre-trained LLMs.</p>
</div>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">In contrast, another line of work focuses on KV cache compression at test time, primarily achieved by dropping tokens while leaving the backbone model intact. Several works design the token eviction policy based on accumulated attention scores <cite class="ltx_cite ltx_citemacro_citep">(Sheng et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03111v1#bib.bib21" title="">2023</a>; Zhang et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03111v1#bib.bib28" title="">2024b</a>; Liu et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03111v1#bib.bib13" title="">2024b</a>)</cite>, or heuristics such as special tokens or and relative distance between tokens <cite class="ltx_cite ltx_citemacro_citep">(Ge et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03111v1#bib.bib7" title="">2023</a>)</cite>
However, these methods either ignore inter-layer dependencies or require attention pattern analysis, and the resulting eviction policy can be task-specific.</p>
</div>
<div class="ltx_para" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">In this paper, we propose to compress KV cache from an orthogonal perspective, <span class="ltx_text ltx_font_italic" id="S1.p4.1.1">i.e.,</span> the KV weight matrices. As the KV weight matrices are typically characterized by low-rank properties, we perform a <span class="ltx_text ltx_font_italic" id="S1.p4.1.2">low-rank approximation</span> to reduce their dimension and thus compress the resulting KV cache.
Recognizing that compressed KV caches inevitably introduce information loss to subsequent layers, and that sensitivity to input changes varies across layers, we introduce a
<span class="ltx_text ltx_font_italic" id="S1.p4.1.3">progressive</span> compression strategy.
This approach is grounded in the calculation of cumulative condition numbers for KV weight matrices across different layers, reflecting their sensitivity and guiding the compression strategy.
Theoretically, we derive error bounds for both individual layer compression and error propagation through the network. These theoretical results reveal that errors introduced in earlier (shallower) layers are amplified more significantly than those in deeper layers, and informs our progressive compression strategy.</p>
</div>
<div class="ltx_para" id="S1.p5">
<p class="ltx_p" id="S1.p5.1">Our method is designed for straightforward implementation, requiring neither model profiling nor detailed inspection of the attention structure.
It can be directly applied to pre-trained LLMs by extracting weight matrices and leveraging their inherent properties to swiftly determine optimal layer-wise compression. This approach offers a practical and efficient solution for enhancing LLM inference performance in memory-constrained deployment scenarios, without the need for model retraining or complex eviction strategy composition.</p>
</div>
<div class="ltx_para" id="S1.p6">
<p class="ltx_p" id="S1.p6.1">We evaluate our method on 8B, 13B, and 70B LLaMA models that built upon multi-query attention or group-query attention.
Experiments across tasks such as commonsense reasoning, reading comprehension, text summarization, and mathematical reasoning, demonstrate that our approach can reduce substantial GPU memory footprint while maintaining minimal impact on performance.</p>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Works</h2>
<section class="ltx_subsection" id="S2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Attention Mechanism</h3>
<div class="ltx_para" id="S2.SS1.p1">
<p class="ltx_p" id="S2.SS1.p1.1">Attention mechanisms in Transformer models have evolved to enhance efficiency and effectiveness <cite class="ltx_cite ltx_citemacro_citep">(Vaswani et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03111v1#bib.bib25" title="">2017</a>)</cite>. Multi-Query Attention (MQA) <cite class="ltx_cite ltx_citemacro_citep">(Shazeer, <a class="ltx_ref" href="https://arxiv.org/html/2410.03111v1#bib.bib20" title="">2019</a>)</cite> reduces memory requirements during decoding, while Grouped-Query Attention (GQA) <cite class="ltx_cite ltx_citemacro_citep">(Ainslie et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03111v1#bib.bib2" title="">2023</a>)</cite> balances efficiency and performance by sharing key and value heads among query groups. Recently, <cite class="ltx_cite ltx_citemacro_cite">Liu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03111v1#bib.bib12" title="">2024a</a>)</cite> introduced Multi-head Latent Attention (MLA), using low-rank key-value union compression to optimize inference. However, these approaches are typically integrated during model training, limiting their applicability to pre-trained LLMs.
Parallel research efforts have targeted inference efficiency improvements. For example, <cite class="ltx_cite ltx_citemacro_cite">Pope et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03111v1#bib.bib17" title="">2023</a>)</cite> developed multi-dimensional partitioning techniques, and <cite class="ltx_cite ltx_citemacro_cite">de Jong et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03111v1#bib.bib6" title="">2022</a>)</cite> optimized the Fusion-in-Decoder (FiD) approach <cite class="ltx_cite ltx_citemacro_citep">(Izacard &amp; Grave, <a class="ltx_ref" href="https://arxiv.org/html/2410.03111v1#bib.bib10" title="">2020</a>)</cite> for more efficient inference.
<cite class="ltx_cite ltx_citemacro_cite">Holmes et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03111v1#bib.bib9" title="">2024</a>)</cite> introduces SplitFuse which leverages dynamic prompt and generation decomposition and unification to further improve continuous batching and system throughput.
In this paper, we contribute to this line of research by improving inference efficiency through the compression of KV cache. Our approach leverages the low-rank property of the attention weight matrices, offering a plug-and-play method to reduce the memory footprint of LLMs during inference without requiring model retraining.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>KV Cache Compression</h3>
<div class="ltx_para" id="S2.SS2.p1">
<p class="ltx_p" id="S2.SS2.p1.1">As Large Language Models (LLMs) continue to grow in size and complexity, efficient management of their memory usage during inference has become a critical challenge.
Early efforts to compress token hidden states <cite class="ltx_cite ltx_citemacro_citep">(Guan et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03111v1#bib.bib8" title="">2022</a>; Sun et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03111v1#bib.bib23" title="">2022</a>; Zhou et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03111v1#bib.bib29" title="">2020</a>)</cite> are limited to non-autoregressive models and require retraining, thus motivating research into pruning tokens in the KV cache of auto-regressive LLMs. For instance, <cite class="ltx_cite ltx_citemacro_cite">Mu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03111v1#bib.bib15" title="">2024</a>)</cite> learns to compress prompts into a few special tokens to reduce memory pressure during caching, but this token prediction requires model retraining and could be an expensive overhead during inference.
Several methods design token eviction policies based on accumulated attention scores <cite class="ltx_cite ltx_citemacro_citep">(Sheng et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03111v1#bib.bib21" title="">2023</a>; Zhang et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03111v1#bib.bib28" title="">2024b</a>; Liu et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03111v1#bib.bib13" title="">2024b</a>)</cite>, or heuristics such as special tokens and relative distance between tokens <cite class="ltx_cite ltx_citemacro_citep">(Ge et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03111v1#bib.bib7" title="">2023</a>)</cite>. However, these approaches often overlook inter-layer dependencies, potentially resulting in task-specific eviction policies that may not generalize well across different applications.
In contrast to token-dropping methods, our study takes a different tack. We focus on compressing the KV cache from the perspective of weight matrix dimension reduction. Importantly, our progressive compression strategy carefully addresses the issue of error propagation across compressed layers, a consideration often ignored in previous methods.</p>
</div>
<div class="ltx_para" id="S2.SS2.p2">
<p class="ltx_p" id="S2.SS2.p2.1">A few studies have explored customized cache budgets across different layers in the context of token dropping, yet no definitive consensus has been reached on the most effective strategies. <cite class="ltx_cite ltx_citemacro_cite">Zhang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03111v1#bib.bib27" title="">2024a</a>)</cite> suggest increasing compression intensity in higher layers based on the assumption that these layers contain less critical information. Conversely, <cite class="ltx_cite ltx_citemacro_cite">Liu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03111v1#bib.bib13" title="">2024b</a>)</cite> argue that significant tokens exhibit greater variability at higher layers, thus larger caches are required to reduce cache misses. While these approaches demonstrate understanding of layer-specific requirements, they depend heavily on task-specific attention patterns.
Our approach diverges fundamentally by adopting an orthogonal perspective to compression, focusing on weight matrix dimension reduction rather than token eviction. This approach enables us to establish error propagation bounds across the network and to guide our progressive compression strategy effectively. It eliminates the need to analyze attention patterns for eviction policy design, simplifying implementation and enhancing general applicability across different LLMs.</p>
</div>
<div class="ltx_para" id="S2.SS2.p3">
<p class="ltx_p" id="S2.SS2.p3.1">Concurrently, <cite class="ltx_cite ltx_citemacro_cite">Liu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03111v1#bib.bib12" title="">2024a</a>)</cite> and <cite class="ltx_cite ltx_citemacro_cite">Yu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03111v1#bib.bib26" title="">2024</a>)</cite> modify attention mechanisms to manage KV caches more efficiently during inference. While these methods align with our philosophy of altering attention dynamics, they require either pretraining adjustments or extensive model finetuning to accommodate the modified attention schemas, limiting their practicality in deployed systems. In contrast, our method requires no such training or fine-tuning, offering a plug-and-play solution that seamlessly integrates with pre-trained models to deliver efficient compression without compromising the model’s integrity or performance.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Preliminary: Attention Mechanism and KV Cache</h2>
<div class="ltx_para" id="S3.p1">
<p class="ltx_p" id="S3.p1.8">Transformer-based language models use self-attention to weigh the importance of different tokens, thus allowing for the model to focus on different parts of the input sequence.
Given an input <math alttext="X\in\mathbb{R}^{N\times D}" class="ltx_Math" display="inline" id="S3.p1.1.m1.1"><semantics id="S3.p1.1.m1.1a"><mrow id="S3.p1.1.m1.1.1" xref="S3.p1.1.m1.1.1.cmml"><mi id="S3.p1.1.m1.1.1.2" xref="S3.p1.1.m1.1.1.2.cmml">X</mi><mo id="S3.p1.1.m1.1.1.1" xref="S3.p1.1.m1.1.1.1.cmml">∈</mo><msup id="S3.p1.1.m1.1.1.3" xref="S3.p1.1.m1.1.1.3.cmml"><mi id="S3.p1.1.m1.1.1.3.2" xref="S3.p1.1.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S3.p1.1.m1.1.1.3.3" xref="S3.p1.1.m1.1.1.3.3.cmml"><mi id="S3.p1.1.m1.1.1.3.3.2" xref="S3.p1.1.m1.1.1.3.3.2.cmml">N</mi><mo id="S3.p1.1.m1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.p1.1.m1.1.1.3.3.1.cmml">×</mo><mi id="S3.p1.1.m1.1.1.3.3.3" xref="S3.p1.1.m1.1.1.3.3.3.cmml">D</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.1.m1.1b"><apply id="S3.p1.1.m1.1.1.cmml" xref="S3.p1.1.m1.1.1"><in id="S3.p1.1.m1.1.1.1.cmml" xref="S3.p1.1.m1.1.1.1"></in><ci id="S3.p1.1.m1.1.1.2.cmml" xref="S3.p1.1.m1.1.1.2">𝑋</ci><apply id="S3.p1.1.m1.1.1.3.cmml" xref="S3.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.p1.1.m1.1.1.3.1.cmml" xref="S3.p1.1.m1.1.1.3">superscript</csymbol><ci id="S3.p1.1.m1.1.1.3.2.cmml" xref="S3.p1.1.m1.1.1.3.2">ℝ</ci><apply id="S3.p1.1.m1.1.1.3.3.cmml" xref="S3.p1.1.m1.1.1.3.3"><times id="S3.p1.1.m1.1.1.3.3.1.cmml" xref="S3.p1.1.m1.1.1.3.3.1"></times><ci id="S3.p1.1.m1.1.1.3.3.2.cmml" xref="S3.p1.1.m1.1.1.3.3.2">𝑁</ci><ci id="S3.p1.1.m1.1.1.3.3.3.cmml" xref="S3.p1.1.m1.1.1.3.3.3">𝐷</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.1.m1.1c">X\in\mathbb{R}^{N\times D}</annotation><annotation encoding="application/x-llamapun" id="S3.p1.1.m1.1d">italic_X ∈ blackboard_R start_POSTSUPERSCRIPT italic_N × italic_D end_POSTSUPERSCRIPT</annotation></semantics></math>, where <math alttext="N" class="ltx_Math" display="inline" id="S3.p1.2.m2.1"><semantics id="S3.p1.2.m2.1a"><mi id="S3.p1.2.m2.1.1" xref="S3.p1.2.m2.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.p1.2.m2.1b"><ci id="S3.p1.2.m2.1.1.cmml" xref="S3.p1.2.m2.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.2.m2.1c">N</annotation><annotation encoding="application/x-llamapun" id="S3.p1.2.m2.1d">italic_N</annotation></semantics></math> is the sequence length and <math alttext="D" class="ltx_Math" display="inline" id="S3.p1.3.m3.1"><semantics id="S3.p1.3.m3.1a"><mi id="S3.p1.3.m3.1.1" xref="S3.p1.3.m3.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="S3.p1.3.m3.1b"><ci id="S3.p1.3.m3.1.1.cmml" xref="S3.p1.3.m3.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.3.m3.1c">D</annotation><annotation encoding="application/x-llamapun" id="S3.p1.3.m3.1d">italic_D</annotation></semantics></math> is the dimensionality of each token’s embedding, we compute the Query (<math alttext="Q" class="ltx_Math" display="inline" id="S3.p1.4.m4.1"><semantics id="S3.p1.4.m4.1a"><mi id="S3.p1.4.m4.1.1" xref="S3.p1.4.m4.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S3.p1.4.m4.1b"><ci id="S3.p1.4.m4.1.1.cmml" xref="S3.p1.4.m4.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.4.m4.1c">Q</annotation><annotation encoding="application/x-llamapun" id="S3.p1.4.m4.1d">italic_Q</annotation></semantics></math>), Key (<math alttext="K" class="ltx_Math" display="inline" id="S3.p1.5.m5.1"><semantics id="S3.p1.5.m5.1a"><mi id="S3.p1.5.m5.1.1" xref="S3.p1.5.m5.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.p1.5.m5.1b"><ci id="S3.p1.5.m5.1.1.cmml" xref="S3.p1.5.m5.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.5.m5.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.p1.5.m5.1d">italic_K</annotation></semantics></math>), and Value (<math alttext="V" class="ltx_Math" display="inline" id="S3.p1.6.m6.1"><semantics id="S3.p1.6.m6.1a"><mi id="S3.p1.6.m6.1.1" xref="S3.p1.6.m6.1.1.cmml">V</mi><annotation-xml encoding="MathML-Content" id="S3.p1.6.m6.1b"><ci id="S3.p1.6.m6.1.1.cmml" xref="S3.p1.6.m6.1.1">𝑉</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.6.m6.1c">V</annotation><annotation encoding="application/x-llamapun" id="S3.p1.6.m6.1d">italic_V</annotation></semantics></math>) matrices by multiplying <math alttext="X" class="ltx_Math" display="inline" id="S3.p1.7.m7.1"><semantics id="S3.p1.7.m7.1a"><mi id="S3.p1.7.m7.1.1" xref="S3.p1.7.m7.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="S3.p1.7.m7.1b"><ci id="S3.p1.7.m7.1.1.cmml" xref="S3.p1.7.m7.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.7.m7.1c">X</annotation><annotation encoding="application/x-llamapun" id="S3.p1.7.m7.1d">italic_X</annotation></semantics></math> with their respective weight matrices: <math alttext="Q=XW_{q},K=XW_{k},V=XW_{v}" class="ltx_Math" display="inline" id="S3.p1.8.m8.2"><semantics id="S3.p1.8.m8.2a"><mrow id="S3.p1.8.m8.2.2.2" xref="S3.p1.8.m8.2.2.3.cmml"><mrow id="S3.p1.8.m8.1.1.1.1" xref="S3.p1.8.m8.1.1.1.1.cmml"><mi id="S3.p1.8.m8.1.1.1.1.2" mathsize="90%" xref="S3.p1.8.m8.1.1.1.1.2.cmml">Q</mi><mo id="S3.p1.8.m8.1.1.1.1.1" mathsize="90%" xref="S3.p1.8.m8.1.1.1.1.1.cmml">=</mo><mrow id="S3.p1.8.m8.1.1.1.1.3" xref="S3.p1.8.m8.1.1.1.1.3.cmml"><mi id="S3.p1.8.m8.1.1.1.1.3.2" mathsize="90%" xref="S3.p1.8.m8.1.1.1.1.3.2.cmml">X</mi><mo id="S3.p1.8.m8.1.1.1.1.3.1" xref="S3.p1.8.m8.1.1.1.1.3.1.cmml">⁢</mo><msub id="S3.p1.8.m8.1.1.1.1.3.3" xref="S3.p1.8.m8.1.1.1.1.3.3.cmml"><mi id="S3.p1.8.m8.1.1.1.1.3.3.2" mathsize="90%" xref="S3.p1.8.m8.1.1.1.1.3.3.2.cmml">W</mi><mi id="S3.p1.8.m8.1.1.1.1.3.3.3" mathsize="90%" xref="S3.p1.8.m8.1.1.1.1.3.3.3.cmml">q</mi></msub></mrow></mrow><mo id="S3.p1.8.m8.2.2.2.3" mathsize="90%" xref="S3.p1.8.m8.2.2.3a.cmml">,</mo><mrow id="S3.p1.8.m8.2.2.2.2.2" xref="S3.p1.8.m8.2.2.2.2.3.cmml"><mrow id="S3.p1.8.m8.2.2.2.2.1.1" xref="S3.p1.8.m8.2.2.2.2.1.1.cmml"><mi id="S3.p1.8.m8.2.2.2.2.1.1.2" mathsize="90%" xref="S3.p1.8.m8.2.2.2.2.1.1.2.cmml">K</mi><mo id="S3.p1.8.m8.2.2.2.2.1.1.1" mathsize="90%" xref="S3.p1.8.m8.2.2.2.2.1.1.1.cmml">=</mo><mrow id="S3.p1.8.m8.2.2.2.2.1.1.3" xref="S3.p1.8.m8.2.2.2.2.1.1.3.cmml"><mi id="S3.p1.8.m8.2.2.2.2.1.1.3.2" mathsize="90%" xref="S3.p1.8.m8.2.2.2.2.1.1.3.2.cmml">X</mi><mo id="S3.p1.8.m8.2.2.2.2.1.1.3.1" xref="S3.p1.8.m8.2.2.2.2.1.1.3.1.cmml">⁢</mo><msub id="S3.p1.8.m8.2.2.2.2.1.1.3.3" xref="S3.p1.8.m8.2.2.2.2.1.1.3.3.cmml"><mi id="S3.p1.8.m8.2.2.2.2.1.1.3.3.2" mathsize="90%" xref="S3.p1.8.m8.2.2.2.2.1.1.3.3.2.cmml">W</mi><mi id="S3.p1.8.m8.2.2.2.2.1.1.3.3.3" mathsize="90%" xref="S3.p1.8.m8.2.2.2.2.1.1.3.3.3.cmml">k</mi></msub></mrow></mrow><mo id="S3.p1.8.m8.2.2.2.2.2.3" mathsize="90%" xref="S3.p1.8.m8.2.2.2.2.3a.cmml">,</mo><mrow id="S3.p1.8.m8.2.2.2.2.2.2" xref="S3.p1.8.m8.2.2.2.2.2.2.cmml"><mi id="S3.p1.8.m8.2.2.2.2.2.2.2" mathsize="90%" xref="S3.p1.8.m8.2.2.2.2.2.2.2.cmml">V</mi><mo id="S3.p1.8.m8.2.2.2.2.2.2.1" mathsize="90%" xref="S3.p1.8.m8.2.2.2.2.2.2.1.cmml">=</mo><mrow id="S3.p1.8.m8.2.2.2.2.2.2.3" xref="S3.p1.8.m8.2.2.2.2.2.2.3.cmml"><mi id="S3.p1.8.m8.2.2.2.2.2.2.3.2" mathsize="90%" xref="S3.p1.8.m8.2.2.2.2.2.2.3.2.cmml">X</mi><mo id="S3.p1.8.m8.2.2.2.2.2.2.3.1" xref="S3.p1.8.m8.2.2.2.2.2.2.3.1.cmml">⁢</mo><msub id="S3.p1.8.m8.2.2.2.2.2.2.3.3" xref="S3.p1.8.m8.2.2.2.2.2.2.3.3.cmml"><mi id="S3.p1.8.m8.2.2.2.2.2.2.3.3.2" mathsize="90%" xref="S3.p1.8.m8.2.2.2.2.2.2.3.3.2.cmml">W</mi><mi id="S3.p1.8.m8.2.2.2.2.2.2.3.3.3" mathsize="90%" xref="S3.p1.8.m8.2.2.2.2.2.2.3.3.3.cmml">v</mi></msub></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.8.m8.2b"><apply id="S3.p1.8.m8.2.2.3.cmml" xref="S3.p1.8.m8.2.2.2"><csymbol cd="ambiguous" id="S3.p1.8.m8.2.2.3a.cmml" xref="S3.p1.8.m8.2.2.2.3">formulae-sequence</csymbol><apply id="S3.p1.8.m8.1.1.1.1.cmml" xref="S3.p1.8.m8.1.1.1.1"><eq id="S3.p1.8.m8.1.1.1.1.1.cmml" xref="S3.p1.8.m8.1.1.1.1.1"></eq><ci id="S3.p1.8.m8.1.1.1.1.2.cmml" xref="S3.p1.8.m8.1.1.1.1.2">𝑄</ci><apply id="S3.p1.8.m8.1.1.1.1.3.cmml" xref="S3.p1.8.m8.1.1.1.1.3"><times id="S3.p1.8.m8.1.1.1.1.3.1.cmml" xref="S3.p1.8.m8.1.1.1.1.3.1"></times><ci id="S3.p1.8.m8.1.1.1.1.3.2.cmml" xref="S3.p1.8.m8.1.1.1.1.3.2">𝑋</ci><apply id="S3.p1.8.m8.1.1.1.1.3.3.cmml" xref="S3.p1.8.m8.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.p1.8.m8.1.1.1.1.3.3.1.cmml" xref="S3.p1.8.m8.1.1.1.1.3.3">subscript</csymbol><ci id="S3.p1.8.m8.1.1.1.1.3.3.2.cmml" xref="S3.p1.8.m8.1.1.1.1.3.3.2">𝑊</ci><ci id="S3.p1.8.m8.1.1.1.1.3.3.3.cmml" xref="S3.p1.8.m8.1.1.1.1.3.3.3">𝑞</ci></apply></apply></apply><apply id="S3.p1.8.m8.2.2.2.2.3.cmml" xref="S3.p1.8.m8.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.p1.8.m8.2.2.2.2.3a.cmml" xref="S3.p1.8.m8.2.2.2.2.2.3">formulae-sequence</csymbol><apply id="S3.p1.8.m8.2.2.2.2.1.1.cmml" xref="S3.p1.8.m8.2.2.2.2.1.1"><eq id="S3.p1.8.m8.2.2.2.2.1.1.1.cmml" xref="S3.p1.8.m8.2.2.2.2.1.1.1"></eq><ci id="S3.p1.8.m8.2.2.2.2.1.1.2.cmml" xref="S3.p1.8.m8.2.2.2.2.1.1.2">𝐾</ci><apply id="S3.p1.8.m8.2.2.2.2.1.1.3.cmml" xref="S3.p1.8.m8.2.2.2.2.1.1.3"><times id="S3.p1.8.m8.2.2.2.2.1.1.3.1.cmml" xref="S3.p1.8.m8.2.2.2.2.1.1.3.1"></times><ci id="S3.p1.8.m8.2.2.2.2.1.1.3.2.cmml" xref="S3.p1.8.m8.2.2.2.2.1.1.3.2">𝑋</ci><apply id="S3.p1.8.m8.2.2.2.2.1.1.3.3.cmml" xref="S3.p1.8.m8.2.2.2.2.1.1.3.3"><csymbol cd="ambiguous" id="S3.p1.8.m8.2.2.2.2.1.1.3.3.1.cmml" xref="S3.p1.8.m8.2.2.2.2.1.1.3.3">subscript</csymbol><ci id="S3.p1.8.m8.2.2.2.2.1.1.3.3.2.cmml" xref="S3.p1.8.m8.2.2.2.2.1.1.3.3.2">𝑊</ci><ci id="S3.p1.8.m8.2.2.2.2.1.1.3.3.3.cmml" xref="S3.p1.8.m8.2.2.2.2.1.1.3.3.3">𝑘</ci></apply></apply></apply><apply id="S3.p1.8.m8.2.2.2.2.2.2.cmml" xref="S3.p1.8.m8.2.2.2.2.2.2"><eq id="S3.p1.8.m8.2.2.2.2.2.2.1.cmml" xref="S3.p1.8.m8.2.2.2.2.2.2.1"></eq><ci id="S3.p1.8.m8.2.2.2.2.2.2.2.cmml" xref="S3.p1.8.m8.2.2.2.2.2.2.2">𝑉</ci><apply id="S3.p1.8.m8.2.2.2.2.2.2.3.cmml" xref="S3.p1.8.m8.2.2.2.2.2.2.3"><times id="S3.p1.8.m8.2.2.2.2.2.2.3.1.cmml" xref="S3.p1.8.m8.2.2.2.2.2.2.3.1"></times><ci id="S3.p1.8.m8.2.2.2.2.2.2.3.2.cmml" xref="S3.p1.8.m8.2.2.2.2.2.2.3.2">𝑋</ci><apply id="S3.p1.8.m8.2.2.2.2.2.2.3.3.cmml" xref="S3.p1.8.m8.2.2.2.2.2.2.3.3"><csymbol cd="ambiguous" id="S3.p1.8.m8.2.2.2.2.2.2.3.3.1.cmml" xref="S3.p1.8.m8.2.2.2.2.2.2.3.3">subscript</csymbol><ci id="S3.p1.8.m8.2.2.2.2.2.2.3.3.2.cmml" xref="S3.p1.8.m8.2.2.2.2.2.2.3.3.2">𝑊</ci><ci id="S3.p1.8.m8.2.2.2.2.2.2.3.3.3.cmml" xref="S3.p1.8.m8.2.2.2.2.2.2.3.3.3">𝑣</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.8.m8.2c">Q=XW_{q},K=XW_{k},V=XW_{v}</annotation><annotation encoding="application/x-llamapun" id="S3.p1.8.m8.2d">italic_Q = italic_X italic_W start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT , italic_K = italic_X italic_W start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT , italic_V = italic_X italic_W start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT</annotation></semantics></math><span class="ltx_text" id="S3.p1.8.1" style="font-size:90%;">.</span></p>
</div>
<div class="ltx_para" id="S3.p2">
<p class="ltx_p" id="S3.p2.6">Then the attention mechanism is as follows:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\text{Attention}(Q,K,V)=\text{softmax}\left(\frac{QK^{\top}}{\sqrt{d_{k}}}%
\right)V." class="ltx_Math" display="block" id="S3.E1.m1.5"><semantics id="S3.E1.m1.5a"><mrow id="S3.E1.m1.5.5.1" xref="S3.E1.m1.5.5.1.1.cmml"><mrow id="S3.E1.m1.5.5.1.1" xref="S3.E1.m1.5.5.1.1.cmml"><mrow id="S3.E1.m1.5.5.1.1.2" xref="S3.E1.m1.5.5.1.1.2.cmml"><mtext id="S3.E1.m1.5.5.1.1.2.2" xref="S3.E1.m1.5.5.1.1.2.2a.cmml">Attention</mtext><mo id="S3.E1.m1.5.5.1.1.2.1" xref="S3.E1.m1.5.5.1.1.2.1.cmml">⁢</mo><mrow id="S3.E1.m1.5.5.1.1.2.3.2" xref="S3.E1.m1.5.5.1.1.2.3.1.cmml"><mo id="S3.E1.m1.5.5.1.1.2.3.2.1" stretchy="false" xref="S3.E1.m1.5.5.1.1.2.3.1.cmml">(</mo><mi id="S3.E1.m1.1.1" xref="S3.E1.m1.1.1.cmml">Q</mi><mo id="S3.E1.m1.5.5.1.1.2.3.2.2" xref="S3.E1.m1.5.5.1.1.2.3.1.cmml">,</mo><mi id="S3.E1.m1.2.2" xref="S3.E1.m1.2.2.cmml">K</mi><mo id="S3.E1.m1.5.5.1.1.2.3.2.3" xref="S3.E1.m1.5.5.1.1.2.3.1.cmml">,</mo><mi id="S3.E1.m1.3.3" xref="S3.E1.m1.3.3.cmml">V</mi><mo id="S3.E1.m1.5.5.1.1.2.3.2.4" stretchy="false" xref="S3.E1.m1.5.5.1.1.2.3.1.cmml">)</mo></mrow></mrow><mo id="S3.E1.m1.5.5.1.1.1" xref="S3.E1.m1.5.5.1.1.1.cmml">=</mo><mrow id="S3.E1.m1.5.5.1.1.3" xref="S3.E1.m1.5.5.1.1.3.cmml"><mtext id="S3.E1.m1.5.5.1.1.3.2" xref="S3.E1.m1.5.5.1.1.3.2a.cmml">softmax</mtext><mo id="S3.E1.m1.5.5.1.1.3.1" xref="S3.E1.m1.5.5.1.1.3.1.cmml">⁢</mo><mrow id="S3.E1.m1.5.5.1.1.3.3.2" xref="S3.E1.m1.4.4.cmml"><mo id="S3.E1.m1.5.5.1.1.3.3.2.1" xref="S3.E1.m1.4.4.cmml">(</mo><mfrac id="S3.E1.m1.4.4" xref="S3.E1.m1.4.4.cmml"><mrow id="S3.E1.m1.4.4.2" xref="S3.E1.m1.4.4.2.cmml"><mi id="S3.E1.m1.4.4.2.2" xref="S3.E1.m1.4.4.2.2.cmml">Q</mi><mo id="S3.E1.m1.4.4.2.1" xref="S3.E1.m1.4.4.2.1.cmml">⁢</mo><msup id="S3.E1.m1.4.4.2.3" xref="S3.E1.m1.4.4.2.3.cmml"><mi id="S3.E1.m1.4.4.2.3.2" xref="S3.E1.m1.4.4.2.3.2.cmml">K</mi><mo id="S3.E1.m1.4.4.2.3.3" xref="S3.E1.m1.4.4.2.3.3.cmml">⊤</mo></msup></mrow><msqrt id="S3.E1.m1.4.4.3" xref="S3.E1.m1.4.4.3.cmml"><msub id="S3.E1.m1.4.4.3.2" xref="S3.E1.m1.4.4.3.2.cmml"><mi id="S3.E1.m1.4.4.3.2.2" xref="S3.E1.m1.4.4.3.2.2.cmml">d</mi><mi id="S3.E1.m1.4.4.3.2.3" xref="S3.E1.m1.4.4.3.2.3.cmml">k</mi></msub></msqrt></mfrac><mo id="S3.E1.m1.5.5.1.1.3.3.2.2" xref="S3.E1.m1.4.4.cmml">)</mo></mrow><mo id="S3.E1.m1.5.5.1.1.3.1a" xref="S3.E1.m1.5.5.1.1.3.1.cmml">⁢</mo><mi id="S3.E1.m1.5.5.1.1.3.4" xref="S3.E1.m1.5.5.1.1.3.4.cmml">V</mi></mrow></mrow><mo id="S3.E1.m1.5.5.1.2" lspace="0em" xref="S3.E1.m1.5.5.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.5b"><apply id="S3.E1.m1.5.5.1.1.cmml" xref="S3.E1.m1.5.5.1"><eq id="S3.E1.m1.5.5.1.1.1.cmml" xref="S3.E1.m1.5.5.1.1.1"></eq><apply id="S3.E1.m1.5.5.1.1.2.cmml" xref="S3.E1.m1.5.5.1.1.2"><times id="S3.E1.m1.5.5.1.1.2.1.cmml" xref="S3.E1.m1.5.5.1.1.2.1"></times><ci id="S3.E1.m1.5.5.1.1.2.2a.cmml" xref="S3.E1.m1.5.5.1.1.2.2"><mtext id="S3.E1.m1.5.5.1.1.2.2.cmml" xref="S3.E1.m1.5.5.1.1.2.2">Attention</mtext></ci><vector id="S3.E1.m1.5.5.1.1.2.3.1.cmml" xref="S3.E1.m1.5.5.1.1.2.3.2"><ci id="S3.E1.m1.1.1.cmml" xref="S3.E1.m1.1.1">𝑄</ci><ci id="S3.E1.m1.2.2.cmml" xref="S3.E1.m1.2.2">𝐾</ci><ci id="S3.E1.m1.3.3.cmml" xref="S3.E1.m1.3.3">𝑉</ci></vector></apply><apply id="S3.E1.m1.5.5.1.1.3.cmml" xref="S3.E1.m1.5.5.1.1.3"><times id="S3.E1.m1.5.5.1.1.3.1.cmml" xref="S3.E1.m1.5.5.1.1.3.1"></times><ci id="S3.E1.m1.5.5.1.1.3.2a.cmml" xref="S3.E1.m1.5.5.1.1.3.2"><mtext id="S3.E1.m1.5.5.1.1.3.2.cmml" xref="S3.E1.m1.5.5.1.1.3.2">softmax</mtext></ci><apply id="S3.E1.m1.4.4.cmml" xref="S3.E1.m1.5.5.1.1.3.3.2"><divide id="S3.E1.m1.4.4.1.cmml" xref="S3.E1.m1.5.5.1.1.3.3.2"></divide><apply id="S3.E1.m1.4.4.2.cmml" xref="S3.E1.m1.4.4.2"><times id="S3.E1.m1.4.4.2.1.cmml" xref="S3.E1.m1.4.4.2.1"></times><ci id="S3.E1.m1.4.4.2.2.cmml" xref="S3.E1.m1.4.4.2.2">𝑄</ci><apply id="S3.E1.m1.4.4.2.3.cmml" xref="S3.E1.m1.4.4.2.3"><csymbol cd="ambiguous" id="S3.E1.m1.4.4.2.3.1.cmml" xref="S3.E1.m1.4.4.2.3">superscript</csymbol><ci id="S3.E1.m1.4.4.2.3.2.cmml" xref="S3.E1.m1.4.4.2.3.2">𝐾</ci><csymbol cd="latexml" id="S3.E1.m1.4.4.2.3.3.cmml" xref="S3.E1.m1.4.4.2.3.3">top</csymbol></apply></apply><apply id="S3.E1.m1.4.4.3.cmml" xref="S3.E1.m1.4.4.3"><root id="S3.E1.m1.4.4.3a.cmml" xref="S3.E1.m1.4.4.3"></root><apply id="S3.E1.m1.4.4.3.2.cmml" xref="S3.E1.m1.4.4.3.2"><csymbol cd="ambiguous" id="S3.E1.m1.4.4.3.2.1.cmml" xref="S3.E1.m1.4.4.3.2">subscript</csymbol><ci id="S3.E1.m1.4.4.3.2.2.cmml" xref="S3.E1.m1.4.4.3.2.2">𝑑</ci><ci id="S3.E1.m1.4.4.3.2.3.cmml" xref="S3.E1.m1.4.4.3.2.3">𝑘</ci></apply></apply></apply><ci id="S3.E1.m1.5.5.1.1.3.4.cmml" xref="S3.E1.m1.5.5.1.1.3.4">𝑉</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.5c">\text{Attention}(Q,K,V)=\text{softmax}\left(\frac{QK^{\top}}{\sqrt{d_{k}}}%
\right)V.</annotation><annotation encoding="application/x-llamapun" id="S3.E1.m1.5d">Attention ( italic_Q , italic_K , italic_V ) = softmax ( divide start_ARG italic_Q italic_K start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT end_ARG start_ARG square-root start_ARG italic_d start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_ARG end_ARG ) italic_V .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.p2.7">Multi-head attention allows the model to jointly attend to information from different representation
subspaces at different positions</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\text{MultiHead}(Q,K,V)=\text{Concat}(\text{head}^{1},\ldots,\text{head}^{h})W%
_{o}," class="ltx_Math" display="block" id="S3.E2.m1.5"><semantics id="S3.E2.m1.5a"><mrow id="S3.E2.m1.5.5.1" xref="S3.E2.m1.5.5.1.1.cmml"><mrow id="S3.E2.m1.5.5.1.1" xref="S3.E2.m1.5.5.1.1.cmml"><mrow id="S3.E2.m1.5.5.1.1.4" xref="S3.E2.m1.5.5.1.1.4.cmml"><mtext id="S3.E2.m1.5.5.1.1.4.2" xref="S3.E2.m1.5.5.1.1.4.2a.cmml">MultiHead</mtext><mo id="S3.E2.m1.5.5.1.1.4.1" xref="S3.E2.m1.5.5.1.1.4.1.cmml">⁢</mo><mrow id="S3.E2.m1.5.5.1.1.4.3.2" xref="S3.E2.m1.5.5.1.1.4.3.1.cmml"><mo id="S3.E2.m1.5.5.1.1.4.3.2.1" stretchy="false" xref="S3.E2.m1.5.5.1.1.4.3.1.cmml">(</mo><mi id="S3.E2.m1.1.1" xref="S3.E2.m1.1.1.cmml">Q</mi><mo id="S3.E2.m1.5.5.1.1.4.3.2.2" xref="S3.E2.m1.5.5.1.1.4.3.1.cmml">,</mo><mi id="S3.E2.m1.2.2" xref="S3.E2.m1.2.2.cmml">K</mi><mo id="S3.E2.m1.5.5.1.1.4.3.2.3" xref="S3.E2.m1.5.5.1.1.4.3.1.cmml">,</mo><mi id="S3.E2.m1.3.3" xref="S3.E2.m1.3.3.cmml">V</mi><mo id="S3.E2.m1.5.5.1.1.4.3.2.4" stretchy="false" xref="S3.E2.m1.5.5.1.1.4.3.1.cmml">)</mo></mrow></mrow><mo id="S3.E2.m1.5.5.1.1.3" xref="S3.E2.m1.5.5.1.1.3.cmml">=</mo><mrow id="S3.E2.m1.5.5.1.1.2" xref="S3.E2.m1.5.5.1.1.2.cmml"><mtext id="S3.E2.m1.5.5.1.1.2.4" xref="S3.E2.m1.5.5.1.1.2.4a.cmml">Concat</mtext><mo id="S3.E2.m1.5.5.1.1.2.3" xref="S3.E2.m1.5.5.1.1.2.3.cmml">⁢</mo><mrow id="S3.E2.m1.5.5.1.1.2.2.2" xref="S3.E2.m1.5.5.1.1.2.2.3.cmml"><mo id="S3.E2.m1.5.5.1.1.2.2.2.3" stretchy="false" xref="S3.E2.m1.5.5.1.1.2.2.3.cmml">(</mo><msup id="S3.E2.m1.5.5.1.1.1.1.1.1" xref="S3.E2.m1.5.5.1.1.1.1.1.1.cmml"><mtext id="S3.E2.m1.5.5.1.1.1.1.1.1.2" xref="S3.E2.m1.5.5.1.1.1.1.1.1.2a.cmml">head</mtext><mn id="S3.E2.m1.5.5.1.1.1.1.1.1.3" xref="S3.E2.m1.5.5.1.1.1.1.1.1.3.cmml">1</mn></msup><mo id="S3.E2.m1.5.5.1.1.2.2.2.4" xref="S3.E2.m1.5.5.1.1.2.2.3.cmml">,</mo><mi id="S3.E2.m1.4.4" mathvariant="normal" xref="S3.E2.m1.4.4.cmml">…</mi><mo id="S3.E2.m1.5.5.1.1.2.2.2.5" xref="S3.E2.m1.5.5.1.1.2.2.3.cmml">,</mo><msup id="S3.E2.m1.5.5.1.1.2.2.2.2" xref="S3.E2.m1.5.5.1.1.2.2.2.2.cmml"><mtext id="S3.E2.m1.5.5.1.1.2.2.2.2.2" xref="S3.E2.m1.5.5.1.1.2.2.2.2.2a.cmml">head</mtext><mi id="S3.E2.m1.5.5.1.1.2.2.2.2.3" xref="S3.E2.m1.5.5.1.1.2.2.2.2.3.cmml">h</mi></msup><mo id="S3.E2.m1.5.5.1.1.2.2.2.6" stretchy="false" xref="S3.E2.m1.5.5.1.1.2.2.3.cmml">)</mo></mrow><mo id="S3.E2.m1.5.5.1.1.2.3a" xref="S3.E2.m1.5.5.1.1.2.3.cmml">⁢</mo><msub id="S3.E2.m1.5.5.1.1.2.5" xref="S3.E2.m1.5.5.1.1.2.5.cmml"><mi id="S3.E2.m1.5.5.1.1.2.5.2" xref="S3.E2.m1.5.5.1.1.2.5.2.cmml">W</mi><mi id="S3.E2.m1.5.5.1.1.2.5.3" xref="S3.E2.m1.5.5.1.1.2.5.3.cmml">o</mi></msub></mrow></mrow><mo id="S3.E2.m1.5.5.1.2" xref="S3.E2.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.5b"><apply id="S3.E2.m1.5.5.1.1.cmml" xref="S3.E2.m1.5.5.1"><eq id="S3.E2.m1.5.5.1.1.3.cmml" xref="S3.E2.m1.5.5.1.1.3"></eq><apply id="S3.E2.m1.5.5.1.1.4.cmml" xref="S3.E2.m1.5.5.1.1.4"><times id="S3.E2.m1.5.5.1.1.4.1.cmml" xref="S3.E2.m1.5.5.1.1.4.1"></times><ci id="S3.E2.m1.5.5.1.1.4.2a.cmml" xref="S3.E2.m1.5.5.1.1.4.2"><mtext id="S3.E2.m1.5.5.1.1.4.2.cmml" xref="S3.E2.m1.5.5.1.1.4.2">MultiHead</mtext></ci><vector id="S3.E2.m1.5.5.1.1.4.3.1.cmml" xref="S3.E2.m1.5.5.1.1.4.3.2"><ci id="S3.E2.m1.1.1.cmml" xref="S3.E2.m1.1.1">𝑄</ci><ci id="S3.E2.m1.2.2.cmml" xref="S3.E2.m1.2.2">𝐾</ci><ci id="S3.E2.m1.3.3.cmml" xref="S3.E2.m1.3.3">𝑉</ci></vector></apply><apply id="S3.E2.m1.5.5.1.1.2.cmml" xref="S3.E2.m1.5.5.1.1.2"><times id="S3.E2.m1.5.5.1.1.2.3.cmml" xref="S3.E2.m1.5.5.1.1.2.3"></times><ci id="S3.E2.m1.5.5.1.1.2.4a.cmml" xref="S3.E2.m1.5.5.1.1.2.4"><mtext id="S3.E2.m1.5.5.1.1.2.4.cmml" xref="S3.E2.m1.5.5.1.1.2.4">Concat</mtext></ci><vector id="S3.E2.m1.5.5.1.1.2.2.3.cmml" xref="S3.E2.m1.5.5.1.1.2.2.2"><apply id="S3.E2.m1.5.5.1.1.1.1.1.1.cmml" xref="S3.E2.m1.5.5.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.5.5.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.5.5.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E2.m1.5.5.1.1.1.1.1.1.2a.cmml" xref="S3.E2.m1.5.5.1.1.1.1.1.1.2"><mtext id="S3.E2.m1.5.5.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.5.5.1.1.1.1.1.1.2">head</mtext></ci><cn id="S3.E2.m1.5.5.1.1.1.1.1.1.3.cmml" type="integer" xref="S3.E2.m1.5.5.1.1.1.1.1.1.3">1</cn></apply><ci id="S3.E2.m1.4.4.cmml" xref="S3.E2.m1.4.4">…</ci><apply id="S3.E2.m1.5.5.1.1.2.2.2.2.cmml" xref="S3.E2.m1.5.5.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.5.5.1.1.2.2.2.2.1.cmml" xref="S3.E2.m1.5.5.1.1.2.2.2.2">superscript</csymbol><ci id="S3.E2.m1.5.5.1.1.2.2.2.2.2a.cmml" xref="S3.E2.m1.5.5.1.1.2.2.2.2.2"><mtext id="S3.E2.m1.5.5.1.1.2.2.2.2.2.cmml" xref="S3.E2.m1.5.5.1.1.2.2.2.2.2">head</mtext></ci><ci id="S3.E2.m1.5.5.1.1.2.2.2.2.3.cmml" xref="S3.E2.m1.5.5.1.1.2.2.2.2.3">ℎ</ci></apply></vector><apply id="S3.E2.m1.5.5.1.1.2.5.cmml" xref="S3.E2.m1.5.5.1.1.2.5"><csymbol cd="ambiguous" id="S3.E2.m1.5.5.1.1.2.5.1.cmml" xref="S3.E2.m1.5.5.1.1.2.5">subscript</csymbol><ci id="S3.E2.m1.5.5.1.1.2.5.2.cmml" xref="S3.E2.m1.5.5.1.1.2.5.2">𝑊</ci><ci id="S3.E2.m1.5.5.1.1.2.5.3.cmml" xref="S3.E2.m1.5.5.1.1.2.5.3">𝑜</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.5c">\text{MultiHead}(Q,K,V)=\text{Concat}(\text{head}^{1},\ldots,\text{head}^{h})W%
_{o},</annotation><annotation encoding="application/x-llamapun" id="S3.E2.m1.5d">MultiHead ( italic_Q , italic_K , italic_V ) = Concat ( head start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT , … , head start_POSTSUPERSCRIPT italic_h end_POSTSUPERSCRIPT ) italic_W start_POSTSUBSCRIPT italic_o end_POSTSUBSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.p2.8">where</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\text{head}^{i}=\text{Attention}(X(W^{i}_{q})^{T},X(W^{i}_{k})^{T},X(W^{i}_{v}%
)^{T})." class="ltx_Math" display="block" id="S3.E3.m1.1"><semantics id="S3.E3.m1.1a"><mrow id="S3.E3.m1.1.1.1" xref="S3.E3.m1.1.1.1.1.cmml"><mrow id="S3.E3.m1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.cmml"><msup id="S3.E3.m1.1.1.1.1.5" xref="S3.E3.m1.1.1.1.1.5.cmml"><mtext id="S3.E3.m1.1.1.1.1.5.2" xref="S3.E3.m1.1.1.1.1.5.2a.cmml">head</mtext><mi id="S3.E3.m1.1.1.1.1.5.3" xref="S3.E3.m1.1.1.1.1.5.3.cmml">i</mi></msup><mo id="S3.E3.m1.1.1.1.1.4" xref="S3.E3.m1.1.1.1.1.4.cmml">=</mo><mrow id="S3.E3.m1.1.1.1.1.3" xref="S3.E3.m1.1.1.1.1.3.cmml"><mtext id="S3.E3.m1.1.1.1.1.3.5" xref="S3.E3.m1.1.1.1.1.3.5a.cmml">Attention</mtext><mo id="S3.E3.m1.1.1.1.1.3.4" xref="S3.E3.m1.1.1.1.1.3.4.cmml">⁢</mo><mrow id="S3.E3.m1.1.1.1.1.3.3.3" xref="S3.E3.m1.1.1.1.1.3.3.4.cmml"><mo id="S3.E3.m1.1.1.1.1.3.3.3.4" stretchy="false" xref="S3.E3.m1.1.1.1.1.3.3.4.cmml">(</mo><mrow id="S3.E3.m1.1.1.1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E3.m1.1.1.1.1.1.1.1.1.3" xref="S3.E3.m1.1.1.1.1.1.1.1.1.3.cmml">X</mi><mo id="S3.E3.m1.1.1.1.1.1.1.1.1.2" xref="S3.E3.m1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><msup id="S3.E3.m1.1.1.1.1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">W</mi><mi id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">q</mi><mi id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">i</mi></msubsup><mo id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mi id="S3.E3.m1.1.1.1.1.1.1.1.1.1.3" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.3.cmml">T</mi></msup></mrow><mo id="S3.E3.m1.1.1.1.1.3.3.3.5" xref="S3.E3.m1.1.1.1.1.3.3.4.cmml">,</mo><mrow id="S3.E3.m1.1.1.1.1.2.2.2.2" xref="S3.E3.m1.1.1.1.1.2.2.2.2.cmml"><mi id="S3.E3.m1.1.1.1.1.2.2.2.2.3" xref="S3.E3.m1.1.1.1.1.2.2.2.2.3.cmml">X</mi><mo id="S3.E3.m1.1.1.1.1.2.2.2.2.2" xref="S3.E3.m1.1.1.1.1.2.2.2.2.2.cmml">⁢</mo><msup id="S3.E3.m1.1.1.1.1.2.2.2.2.1" xref="S3.E3.m1.1.1.1.1.2.2.2.2.1.cmml"><mrow id="S3.E3.m1.1.1.1.1.2.2.2.2.1.1.1" xref="S3.E3.m1.1.1.1.1.2.2.2.2.1.1.1.1.cmml"><mo id="S3.E3.m1.1.1.1.1.2.2.2.2.1.1.1.2" stretchy="false" xref="S3.E3.m1.1.1.1.1.2.2.2.2.1.1.1.1.cmml">(</mo><msubsup id="S3.E3.m1.1.1.1.1.2.2.2.2.1.1.1.1" xref="S3.E3.m1.1.1.1.1.2.2.2.2.1.1.1.1.cmml"><mi id="S3.E3.m1.1.1.1.1.2.2.2.2.1.1.1.1.2.2" xref="S3.E3.m1.1.1.1.1.2.2.2.2.1.1.1.1.2.2.cmml">W</mi><mi id="S3.E3.m1.1.1.1.1.2.2.2.2.1.1.1.1.3" xref="S3.E3.m1.1.1.1.1.2.2.2.2.1.1.1.1.3.cmml">k</mi><mi id="S3.E3.m1.1.1.1.1.2.2.2.2.1.1.1.1.2.3" xref="S3.E3.m1.1.1.1.1.2.2.2.2.1.1.1.1.2.3.cmml">i</mi></msubsup><mo id="S3.E3.m1.1.1.1.1.2.2.2.2.1.1.1.3" stretchy="false" xref="S3.E3.m1.1.1.1.1.2.2.2.2.1.1.1.1.cmml">)</mo></mrow><mi id="S3.E3.m1.1.1.1.1.2.2.2.2.1.3" xref="S3.E3.m1.1.1.1.1.2.2.2.2.1.3.cmml">T</mi></msup></mrow><mo id="S3.E3.m1.1.1.1.1.3.3.3.6" xref="S3.E3.m1.1.1.1.1.3.3.4.cmml">,</mo><mrow id="S3.E3.m1.1.1.1.1.3.3.3.3" xref="S3.E3.m1.1.1.1.1.3.3.3.3.cmml"><mi id="S3.E3.m1.1.1.1.1.3.3.3.3.3" xref="S3.E3.m1.1.1.1.1.3.3.3.3.3.cmml">X</mi><mo id="S3.E3.m1.1.1.1.1.3.3.3.3.2" xref="S3.E3.m1.1.1.1.1.3.3.3.3.2.cmml">⁢</mo><msup id="S3.E3.m1.1.1.1.1.3.3.3.3.1" xref="S3.E3.m1.1.1.1.1.3.3.3.3.1.cmml"><mrow id="S3.E3.m1.1.1.1.1.3.3.3.3.1.1.1" xref="S3.E3.m1.1.1.1.1.3.3.3.3.1.1.1.1.cmml"><mo id="S3.E3.m1.1.1.1.1.3.3.3.3.1.1.1.2" stretchy="false" xref="S3.E3.m1.1.1.1.1.3.3.3.3.1.1.1.1.cmml">(</mo><msubsup id="S3.E3.m1.1.1.1.1.3.3.3.3.1.1.1.1" xref="S3.E3.m1.1.1.1.1.3.3.3.3.1.1.1.1.cmml"><mi id="S3.E3.m1.1.1.1.1.3.3.3.3.1.1.1.1.2.2" xref="S3.E3.m1.1.1.1.1.3.3.3.3.1.1.1.1.2.2.cmml">W</mi><mi id="S3.E3.m1.1.1.1.1.3.3.3.3.1.1.1.1.3" xref="S3.E3.m1.1.1.1.1.3.3.3.3.1.1.1.1.3.cmml">v</mi><mi id="S3.E3.m1.1.1.1.1.3.3.3.3.1.1.1.1.2.3" xref="S3.E3.m1.1.1.1.1.3.3.3.3.1.1.1.1.2.3.cmml">i</mi></msubsup><mo id="S3.E3.m1.1.1.1.1.3.3.3.3.1.1.1.3" stretchy="false" xref="S3.E3.m1.1.1.1.1.3.3.3.3.1.1.1.1.cmml">)</mo></mrow><mi id="S3.E3.m1.1.1.1.1.3.3.3.3.1.3" xref="S3.E3.m1.1.1.1.1.3.3.3.3.1.3.cmml">T</mi></msup></mrow><mo id="S3.E3.m1.1.1.1.1.3.3.3.7" stretchy="false" xref="S3.E3.m1.1.1.1.1.3.3.4.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E3.m1.1.1.1.2" lspace="0em" xref="S3.E3.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.1b"><apply id="S3.E3.m1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1"><eq id="S3.E3.m1.1.1.1.1.4.cmml" xref="S3.E3.m1.1.1.1.1.4"></eq><apply id="S3.E3.m1.1.1.1.1.5.cmml" xref="S3.E3.m1.1.1.1.1.5"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.5.1.cmml" xref="S3.E3.m1.1.1.1.1.5">superscript</csymbol><ci id="S3.E3.m1.1.1.1.1.5.2a.cmml" xref="S3.E3.m1.1.1.1.1.5.2"><mtext id="S3.E3.m1.1.1.1.1.5.2.cmml" xref="S3.E3.m1.1.1.1.1.5.2">head</mtext></ci><ci id="S3.E3.m1.1.1.1.1.5.3.cmml" xref="S3.E3.m1.1.1.1.1.5.3">𝑖</ci></apply><apply id="S3.E3.m1.1.1.1.1.3.cmml" xref="S3.E3.m1.1.1.1.1.3"><times id="S3.E3.m1.1.1.1.1.3.4.cmml" xref="S3.E3.m1.1.1.1.1.3.4"></times><ci id="S3.E3.m1.1.1.1.1.3.5a.cmml" xref="S3.E3.m1.1.1.1.1.3.5"><mtext id="S3.E3.m1.1.1.1.1.3.5.cmml" xref="S3.E3.m1.1.1.1.1.3.5">Attention</mtext></ci><vector id="S3.E3.m1.1.1.1.1.3.3.4.cmml" xref="S3.E3.m1.1.1.1.1.3.3.3"><apply id="S3.E3.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1"><times id="S3.E3.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.2"></times><ci id="S3.E3.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.3">𝑋</ci><apply id="S3.E3.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2">𝑊</ci><ci id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑞</ci></apply><ci id="S3.E3.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.3">𝑇</ci></apply></apply><apply id="S3.E3.m1.1.1.1.1.2.2.2.2.cmml" xref="S3.E3.m1.1.1.1.1.2.2.2.2"><times id="S3.E3.m1.1.1.1.1.2.2.2.2.2.cmml" xref="S3.E3.m1.1.1.1.1.2.2.2.2.2"></times><ci id="S3.E3.m1.1.1.1.1.2.2.2.2.3.cmml" xref="S3.E3.m1.1.1.1.1.2.2.2.2.3">𝑋</ci><apply id="S3.E3.m1.1.1.1.1.2.2.2.2.1.cmml" xref="S3.E3.m1.1.1.1.1.2.2.2.2.1"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.2.2.2.2.1.2.cmml" xref="S3.E3.m1.1.1.1.1.2.2.2.2.1">superscript</csymbol><apply id="S3.E3.m1.1.1.1.1.2.2.2.2.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.2.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.2.2.2.2.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.2.2.2.2.1.1.1">subscript</csymbol><apply id="S3.E3.m1.1.1.1.1.2.2.2.2.1.1.1.1.2.cmml" xref="S3.E3.m1.1.1.1.1.2.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.2.2.2.2.1.1.1.1.2.1.cmml" xref="S3.E3.m1.1.1.1.1.2.2.2.2.1.1.1">superscript</csymbol><ci id="S3.E3.m1.1.1.1.1.2.2.2.2.1.1.1.1.2.2.cmml" xref="S3.E3.m1.1.1.1.1.2.2.2.2.1.1.1.1.2.2">𝑊</ci><ci id="S3.E3.m1.1.1.1.1.2.2.2.2.1.1.1.1.2.3.cmml" xref="S3.E3.m1.1.1.1.1.2.2.2.2.1.1.1.1.2.3">𝑖</ci></apply><ci id="S3.E3.m1.1.1.1.1.2.2.2.2.1.1.1.1.3.cmml" xref="S3.E3.m1.1.1.1.1.2.2.2.2.1.1.1.1.3">𝑘</ci></apply><ci id="S3.E3.m1.1.1.1.1.2.2.2.2.1.3.cmml" xref="S3.E3.m1.1.1.1.1.2.2.2.2.1.3">𝑇</ci></apply></apply><apply id="S3.E3.m1.1.1.1.1.3.3.3.3.cmml" xref="S3.E3.m1.1.1.1.1.3.3.3.3"><times id="S3.E3.m1.1.1.1.1.3.3.3.3.2.cmml" xref="S3.E3.m1.1.1.1.1.3.3.3.3.2"></times><ci id="S3.E3.m1.1.1.1.1.3.3.3.3.3.cmml" xref="S3.E3.m1.1.1.1.1.3.3.3.3.3">𝑋</ci><apply id="S3.E3.m1.1.1.1.1.3.3.3.3.1.cmml" xref="S3.E3.m1.1.1.1.1.3.3.3.3.1"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.3.3.3.3.1.2.cmml" xref="S3.E3.m1.1.1.1.1.3.3.3.3.1">superscript</csymbol><apply id="S3.E3.m1.1.1.1.1.3.3.3.3.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.3.3.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.3.3.3.3.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.3.3.3.3.1.1.1">subscript</csymbol><apply id="S3.E3.m1.1.1.1.1.3.3.3.3.1.1.1.1.2.cmml" xref="S3.E3.m1.1.1.1.1.3.3.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.3.3.3.3.1.1.1.1.2.1.cmml" xref="S3.E3.m1.1.1.1.1.3.3.3.3.1.1.1">superscript</csymbol><ci id="S3.E3.m1.1.1.1.1.3.3.3.3.1.1.1.1.2.2.cmml" xref="S3.E3.m1.1.1.1.1.3.3.3.3.1.1.1.1.2.2">𝑊</ci><ci id="S3.E3.m1.1.1.1.1.3.3.3.3.1.1.1.1.2.3.cmml" xref="S3.E3.m1.1.1.1.1.3.3.3.3.1.1.1.1.2.3">𝑖</ci></apply><ci id="S3.E3.m1.1.1.1.1.3.3.3.3.1.1.1.1.3.cmml" xref="S3.E3.m1.1.1.1.1.3.3.3.3.1.1.1.1.3">𝑣</ci></apply><ci id="S3.E3.m1.1.1.1.1.3.3.3.3.1.3.cmml" xref="S3.E3.m1.1.1.1.1.3.3.3.3.1.3">𝑇</ci></apply></apply></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.1c">\text{head}^{i}=\text{Attention}(X(W^{i}_{q})^{T},X(W^{i}_{k})^{T},X(W^{i}_{v}%
)^{T}).</annotation><annotation encoding="application/x-llamapun" id="S3.E3.m1.1d">head start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT = Attention ( italic_X ( italic_W start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT , italic_X ( italic_W start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT , italic_X ( italic_W start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.p2.5">Here, <math alttext="W^{i}_{q}" class="ltx_Math" display="inline" id="S3.p2.1.m1.1"><semantics id="S3.p2.1.m1.1a"><msubsup id="S3.p2.1.m1.1.1" xref="S3.p2.1.m1.1.1.cmml"><mi id="S3.p2.1.m1.1.1.2.2" xref="S3.p2.1.m1.1.1.2.2.cmml">W</mi><mi id="S3.p2.1.m1.1.1.3" xref="S3.p2.1.m1.1.1.3.cmml">q</mi><mi id="S3.p2.1.m1.1.1.2.3" xref="S3.p2.1.m1.1.1.2.3.cmml">i</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.p2.1.m1.1b"><apply id="S3.p2.1.m1.1.1.cmml" xref="S3.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.p2.1.m1.1.1.1.cmml" xref="S3.p2.1.m1.1.1">subscript</csymbol><apply id="S3.p2.1.m1.1.1.2.cmml" xref="S3.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.p2.1.m1.1.1.2.1.cmml" xref="S3.p2.1.m1.1.1">superscript</csymbol><ci id="S3.p2.1.m1.1.1.2.2.cmml" xref="S3.p2.1.m1.1.1.2.2">𝑊</ci><ci id="S3.p2.1.m1.1.1.2.3.cmml" xref="S3.p2.1.m1.1.1.2.3">𝑖</ci></apply><ci id="S3.p2.1.m1.1.1.3.cmml" xref="S3.p2.1.m1.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.1.m1.1c">W^{i}_{q}</annotation><annotation encoding="application/x-llamapun" id="S3.p2.1.m1.1d">italic_W start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="W^{i}_{k}" class="ltx_Math" display="inline" id="S3.p2.2.m2.1"><semantics id="S3.p2.2.m2.1a"><msubsup id="S3.p2.2.m2.1.1" xref="S3.p2.2.m2.1.1.cmml"><mi id="S3.p2.2.m2.1.1.2.2" xref="S3.p2.2.m2.1.1.2.2.cmml">W</mi><mi id="S3.p2.2.m2.1.1.3" xref="S3.p2.2.m2.1.1.3.cmml">k</mi><mi id="S3.p2.2.m2.1.1.2.3" xref="S3.p2.2.m2.1.1.2.3.cmml">i</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.p2.2.m2.1b"><apply id="S3.p2.2.m2.1.1.cmml" xref="S3.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.p2.2.m2.1.1.1.cmml" xref="S3.p2.2.m2.1.1">subscript</csymbol><apply id="S3.p2.2.m2.1.1.2.cmml" xref="S3.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.p2.2.m2.1.1.2.1.cmml" xref="S3.p2.2.m2.1.1">superscript</csymbol><ci id="S3.p2.2.m2.1.1.2.2.cmml" xref="S3.p2.2.m2.1.1.2.2">𝑊</ci><ci id="S3.p2.2.m2.1.1.2.3.cmml" xref="S3.p2.2.m2.1.1.2.3">𝑖</ci></apply><ci id="S3.p2.2.m2.1.1.3.cmml" xref="S3.p2.2.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.2.m2.1c">W^{i}_{k}</annotation><annotation encoding="application/x-llamapun" id="S3.p2.2.m2.1d">italic_W start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math>, and <math alttext="W^{i}_{v}" class="ltx_Math" display="inline" id="S3.p2.3.m3.1"><semantics id="S3.p2.3.m3.1a"><msubsup id="S3.p2.3.m3.1.1" xref="S3.p2.3.m3.1.1.cmml"><mi id="S3.p2.3.m3.1.1.2.2" xref="S3.p2.3.m3.1.1.2.2.cmml">W</mi><mi id="S3.p2.3.m3.1.1.3" xref="S3.p2.3.m3.1.1.3.cmml">v</mi><mi id="S3.p2.3.m3.1.1.2.3" xref="S3.p2.3.m3.1.1.2.3.cmml">i</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.p2.3.m3.1b"><apply id="S3.p2.3.m3.1.1.cmml" xref="S3.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.p2.3.m3.1.1.1.cmml" xref="S3.p2.3.m3.1.1">subscript</csymbol><apply id="S3.p2.3.m3.1.1.2.cmml" xref="S3.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.p2.3.m3.1.1.2.1.cmml" xref="S3.p2.3.m3.1.1">superscript</csymbol><ci id="S3.p2.3.m3.1.1.2.2.cmml" xref="S3.p2.3.m3.1.1.2.2">𝑊</ci><ci id="S3.p2.3.m3.1.1.2.3.cmml" xref="S3.p2.3.m3.1.1.2.3">𝑖</ci></apply><ci id="S3.p2.3.m3.1.1.3.cmml" xref="S3.p2.3.m3.1.1.3">𝑣</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.3.m3.1c">W^{i}_{v}</annotation><annotation encoding="application/x-llamapun" id="S3.p2.3.m3.1d">italic_W start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT</annotation></semantics></math> are the weight matrices for the <math alttext="i" class="ltx_Math" display="inline" id="S3.p2.4.m4.1"><semantics id="S3.p2.4.m4.1a"><mi id="S3.p2.4.m4.1.1" xref="S3.p2.4.m4.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.p2.4.m4.1b"><ci id="S3.p2.4.m4.1.1.cmml" xref="S3.p2.4.m4.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.4.m4.1c">i</annotation><annotation encoding="application/x-llamapun" id="S3.p2.4.m4.1d">italic_i</annotation></semantics></math>-th attention head, and <math alttext="W_{o}" class="ltx_Math" display="inline" id="S3.p2.5.m5.1"><semantics id="S3.p2.5.m5.1a"><msub id="S3.p2.5.m5.1.1" xref="S3.p2.5.m5.1.1.cmml"><mi id="S3.p2.5.m5.1.1.2" xref="S3.p2.5.m5.1.1.2.cmml">W</mi><mi id="S3.p2.5.m5.1.1.3" xref="S3.p2.5.m5.1.1.3.cmml">o</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p2.5.m5.1b"><apply id="S3.p2.5.m5.1.1.cmml" xref="S3.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S3.p2.5.m5.1.1.1.cmml" xref="S3.p2.5.m5.1.1">subscript</csymbol><ci id="S3.p2.5.m5.1.1.2.cmml" xref="S3.p2.5.m5.1.1.2">𝑊</ci><ci id="S3.p2.5.m5.1.1.3.cmml" xref="S3.p2.5.m5.1.1.3">𝑜</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.5.m5.1c">W_{o}</annotation><annotation encoding="application/x-llamapun" id="S3.p2.5.m5.1d">italic_W start_POSTSUBSCRIPT italic_o end_POSTSUBSCRIPT</annotation></semantics></math> is the weight matrix for the output linear transformation.</p>
</div>
<div class="ltx_para" id="S3.p3">
<p class="ltx_p" id="S3.p3.2">In autoregressive transformers, the computation of attention scales quadratically (<span class="ltx_text ltx_font_italic" id="S3.p3.2.1">i.e.,</span> <math alttext="\mathcal{O}(N^{2})" class="ltx_Math" display="inline" id="S3.p3.1.m1.1"><semantics id="S3.p3.1.m1.1a"><mrow id="S3.p3.1.m1.1.1" xref="S3.p3.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p3.1.m1.1.1.3" xref="S3.p3.1.m1.1.1.3.cmml">𝒪</mi><mo id="S3.p3.1.m1.1.1.2" xref="S3.p3.1.m1.1.1.2.cmml">⁢</mo><mrow id="S3.p3.1.m1.1.1.1.1" xref="S3.p3.1.m1.1.1.1.1.1.cmml"><mo id="S3.p3.1.m1.1.1.1.1.2" stretchy="false" xref="S3.p3.1.m1.1.1.1.1.1.cmml">(</mo><msup id="S3.p3.1.m1.1.1.1.1.1" xref="S3.p3.1.m1.1.1.1.1.1.cmml"><mi id="S3.p3.1.m1.1.1.1.1.1.2" xref="S3.p3.1.m1.1.1.1.1.1.2.cmml">N</mi><mn id="S3.p3.1.m1.1.1.1.1.1.3" xref="S3.p3.1.m1.1.1.1.1.1.3.cmml">2</mn></msup><mo id="S3.p3.1.m1.1.1.1.1.3" stretchy="false" xref="S3.p3.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p3.1.m1.1b"><apply id="S3.p3.1.m1.1.1.cmml" xref="S3.p3.1.m1.1.1"><times id="S3.p3.1.m1.1.1.2.cmml" xref="S3.p3.1.m1.1.1.2"></times><ci id="S3.p3.1.m1.1.1.3.cmml" xref="S3.p3.1.m1.1.1.3">𝒪</ci><apply id="S3.p3.1.m1.1.1.1.1.1.cmml" xref="S3.p3.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.p3.1.m1.1.1.1.1.1.1.cmml" xref="S3.p3.1.m1.1.1.1.1">superscript</csymbol><ci id="S3.p3.1.m1.1.1.1.1.1.2.cmml" xref="S3.p3.1.m1.1.1.1.1.1.2">𝑁</ci><cn id="S3.p3.1.m1.1.1.1.1.1.3.cmml" type="integer" xref="S3.p3.1.m1.1.1.1.1.1.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.1.m1.1c">\mathcal{O}(N^{2})</annotation><annotation encoding="application/x-llamapun" id="S3.p3.1.m1.1d">caligraphic_O ( italic_N start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT )</annotation></semantics></math>) with the sequence length <math alttext="N" class="ltx_Math" display="inline" id="S3.p3.2.m2.1"><semantics id="S3.p3.2.m2.1a"><mi id="S3.p3.2.m2.1.1" xref="S3.p3.2.m2.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.p3.2.m2.1b"><ci id="S3.p3.2.m2.1.1.cmml" xref="S3.p3.2.m2.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.2.m2.1c">N</annotation><annotation encoding="application/x-llamapun" id="S3.p3.2.m2.1d">italic_N</annotation></semantics></math>, as every token in the sequence computes interactions with every other token. Such scaling is impractical for very large inputs or real-time applications, where speed and efficiency are crucial.</p>
</div>
<div class="ltx_para" id="S3.p4">
<p class="ltx_p" id="S3.p4.5">To address this computational bottleneck, KV caches store the results of previous computations of the KV matrices. When processing subsequent tokens, the model can retrieve keys and values from the cache rather than recomputing them, thereby reducing the number of operations to a linear scale with respect to the sequence length. This method trades off increased memory usage for a reduction in computational overhead. The size of KV cache per layer is defined as below:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="C_{k,v}=b\times N\times h\times d," class="ltx_Math" display="block" id="S3.E4.m1.3"><semantics id="S3.E4.m1.3a"><mrow id="S3.E4.m1.3.3.1" xref="S3.E4.m1.3.3.1.1.cmml"><mrow id="S3.E4.m1.3.3.1.1" xref="S3.E4.m1.3.3.1.1.cmml"><msub id="S3.E4.m1.3.3.1.1.2" xref="S3.E4.m1.3.3.1.1.2.cmml"><mi id="S3.E4.m1.3.3.1.1.2.2" xref="S3.E4.m1.3.3.1.1.2.2.cmml">C</mi><mrow id="S3.E4.m1.2.2.2.4" xref="S3.E4.m1.2.2.2.3.cmml"><mi id="S3.E4.m1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.cmml">k</mi><mo id="S3.E4.m1.2.2.2.4.1" xref="S3.E4.m1.2.2.2.3.cmml">,</mo><mi id="S3.E4.m1.2.2.2.2" xref="S3.E4.m1.2.2.2.2.cmml">v</mi></mrow></msub><mo id="S3.E4.m1.3.3.1.1.1" xref="S3.E4.m1.3.3.1.1.1.cmml">=</mo><mrow id="S3.E4.m1.3.3.1.1.3" xref="S3.E4.m1.3.3.1.1.3.cmml"><mi id="S3.E4.m1.3.3.1.1.3.2" xref="S3.E4.m1.3.3.1.1.3.2.cmml">b</mi><mo id="S3.E4.m1.3.3.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="S3.E4.m1.3.3.1.1.3.1.cmml">×</mo><mi id="S3.E4.m1.3.3.1.1.3.3" xref="S3.E4.m1.3.3.1.1.3.3.cmml">N</mi><mo id="S3.E4.m1.3.3.1.1.3.1a" lspace="0.222em" rspace="0.222em" xref="S3.E4.m1.3.3.1.1.3.1.cmml">×</mo><mi id="S3.E4.m1.3.3.1.1.3.4" xref="S3.E4.m1.3.3.1.1.3.4.cmml">h</mi><mo id="S3.E4.m1.3.3.1.1.3.1b" lspace="0.222em" rspace="0.222em" xref="S3.E4.m1.3.3.1.1.3.1.cmml">×</mo><mi id="S3.E4.m1.3.3.1.1.3.5" xref="S3.E4.m1.3.3.1.1.3.5.cmml">d</mi></mrow></mrow><mo id="S3.E4.m1.3.3.1.2" xref="S3.E4.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.3b"><apply id="S3.E4.m1.3.3.1.1.cmml" xref="S3.E4.m1.3.3.1"><eq id="S3.E4.m1.3.3.1.1.1.cmml" xref="S3.E4.m1.3.3.1.1.1"></eq><apply id="S3.E4.m1.3.3.1.1.2.cmml" xref="S3.E4.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.3.3.1.1.2.1.cmml" xref="S3.E4.m1.3.3.1.1.2">subscript</csymbol><ci id="S3.E4.m1.3.3.1.1.2.2.cmml" xref="S3.E4.m1.3.3.1.1.2.2">𝐶</ci><list id="S3.E4.m1.2.2.2.3.cmml" xref="S3.E4.m1.2.2.2.4"><ci id="S3.E4.m1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1">𝑘</ci><ci id="S3.E4.m1.2.2.2.2.cmml" xref="S3.E4.m1.2.2.2.2">𝑣</ci></list></apply><apply id="S3.E4.m1.3.3.1.1.3.cmml" xref="S3.E4.m1.3.3.1.1.3"><times id="S3.E4.m1.3.3.1.1.3.1.cmml" xref="S3.E4.m1.3.3.1.1.3.1"></times><ci id="S3.E4.m1.3.3.1.1.3.2.cmml" xref="S3.E4.m1.3.3.1.1.3.2">𝑏</ci><ci id="S3.E4.m1.3.3.1.1.3.3.cmml" xref="S3.E4.m1.3.3.1.1.3.3">𝑁</ci><ci id="S3.E4.m1.3.3.1.1.3.4.cmml" xref="S3.E4.m1.3.3.1.1.3.4">ℎ</ci><ci id="S3.E4.m1.3.3.1.1.3.5.cmml" xref="S3.E4.m1.3.3.1.1.3.5">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.3c">C_{k,v}=b\times N\times h\times d,</annotation><annotation encoding="application/x-llamapun" id="S3.E4.m1.3d">italic_C start_POSTSUBSCRIPT italic_k , italic_v end_POSTSUBSCRIPT = italic_b × italic_N × italic_h × italic_d ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.p4.4">where <math alttext="b" class="ltx_Math" display="inline" id="S3.p4.1.m1.1"><semantics id="S3.p4.1.m1.1a"><mi id="S3.p4.1.m1.1.1" xref="S3.p4.1.m1.1.1.cmml">b</mi><annotation-xml encoding="MathML-Content" id="S3.p4.1.m1.1b"><ci id="S3.p4.1.m1.1.1.cmml" xref="S3.p4.1.m1.1.1">𝑏</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.1.m1.1c">b</annotation><annotation encoding="application/x-llamapun" id="S3.p4.1.m1.1d">italic_b</annotation></semantics></math> is the batch size, <math alttext="N" class="ltx_Math" display="inline" id="S3.p4.2.m2.1"><semantics id="S3.p4.2.m2.1a"><mi id="S3.p4.2.m2.1.1" xref="S3.p4.2.m2.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.p4.2.m2.1b"><ci id="S3.p4.2.m2.1.1.cmml" xref="S3.p4.2.m2.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.2.m2.1c">N</annotation><annotation encoding="application/x-llamapun" id="S3.p4.2.m2.1d">italic_N</annotation></semantics></math> is the max sequence length in the batch, <math alttext="h" class="ltx_Math" display="inline" id="S3.p4.3.m3.1"><semantics id="S3.p4.3.m3.1a"><mi id="S3.p4.3.m3.1.1" xref="S3.p4.3.m3.1.1.cmml">h</mi><annotation-xml encoding="MathML-Content" id="S3.p4.3.m3.1b"><ci id="S3.p4.3.m3.1.1.cmml" xref="S3.p4.3.m3.1.1">ℎ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.3.m3.1c">h</annotation><annotation encoding="application/x-llamapun" id="S3.p4.3.m3.1d">italic_h</annotation></semantics></math> is the number of K/V head and <math alttext="d" class="ltx_Math" display="inline" id="S3.p4.4.m4.1"><semantics id="S3.p4.4.m4.1a"><mi id="S3.p4.4.m4.1.1" xref="S3.p4.4.m4.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S3.p4.4.m4.1b"><ci id="S3.p4.4.m4.1.1.cmml" xref="S3.p4.4.m4.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.4.m4.1c">d</annotation><annotation encoding="application/x-llamapun" id="S3.p4.4.m4.1d">italic_d</annotation></semantics></math> is the head dimension.
This linear relationship between cache size and sequence length, as well as batch size, underscores the critical need for efficient compression methods.
As described, existing works that can reduce KV cache consumption either require expensive model training in upcycling stages or empirical token eviction policy design at test time. In the following section, we present a novel method for KV cache compression from the perspective of low-rank weight approximation.
</p>
</div>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Method</h2>
<figure class="ltx_figure" id="S4.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="175" id="S4.F1.g1" src="extracted/5900565/figure/overview.png" width="592"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F1.3.1.1" style="font-size:90%;">Figure 1</span>: </span><span class="ltx_text ltx_font_smallcaps" id="S4.F1.4.2" style="font-size:90%;">LoRC<span class="ltx_text ltx_font_upright" id="S4.F1.4.2.1"> compresses KV-cache by decomposing the KV weight matrices in attention heads. The progressive compression strategy retains more dimension for KV weights in shallow layers and compresses the KV weights in deep layers more aggressively.</span></span></figcaption>
</figure>
<div class="ltx_para" id="S4.p1">
<p class="ltx_p" id="S4.p1.1">We structure this section as follows. In Section <a class="ltx_ref" href="https://arxiv.org/html/2410.03111v1#S4.SS1" title="4.1 KV Cache Compression via Low-rank Approximation of Weight Matrices ‣ 4 Method ‣ LoRC: Low-Rank Compression for LLMs KV Cache with a Progressive Compression Strategy"><span class="ltx_text ltx_ref_tag">4.1</span></a>, we detail the process of compressing the KV cache for a single layer using Singular Value Decomposition (SVD) on weight matrices. Section <a class="ltx_ref" href="https://arxiv.org/html/2410.03111v1#S4.SS2" title="4.2 Progressive Compression Strategy ‣ 4 Method ‣ LoRC: Low-Rank Compression for LLMs KV Cache with a Progressive Compression Strategy"><span class="ltx_text ltx_ref_tag">4.2</span></a> introduces our progressive compression strategy, which determines adaptive compression dimensions for each layer.
Finally, Section <a class="ltx_ref" href="https://arxiv.org/html/2410.03111v1#S4.SS3" title="4.3 Multi-head Attention and Group-query Attention ‣ 4 Method ‣ LoRC: Low-Rank Compression for LLMs KV Cache with a Progressive Compression Strategy"><span class="ltx_text ltx_ref_tag">4.3</span></a> covers additional considerations for handling various attention mechanisms, and Section <a class="ltx_ref" href="https://arxiv.org/html/2410.03111v1#A3" title="Appendix C Adjusted Position Embedding ‣ LoRC: Low-Rank Compression for LLMs KV Cache with a Progressive Compression Strategy"><span class="ltx_text ltx_ref_tag">C</span></a> addresses the implementation details specific to the rotary position embedding. Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03111v1#S4.F1" title="Figure 1 ‣ 4 Method ‣ LoRC: Low-Rank Compression for LLMs KV Cache with a Progressive Compression Strategy"><span class="ltx_text ltx_ref_tag">1</span></a> presents an overview of our method, illustrating the low-rank approximation of the weight matrix and the progressive compression strategy across layers.</p>
</div>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>KV Cache Compression via Low-rank Approximation of Weight Matrices</h3>
<div class="ltx_para" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.1">Unlike previous approaches that focus on token-level eviction strategies or require model retraining, we propose a novel method that operates at the weight matrix level in the attention mechanism. This approach leverages the inherent low-rank properties of these matrices (as shown in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.03111v1#A2" title="Appendix B Reconstruction Error of Matrix SVD ‣ LoRC: Low-Rank Compression for LLMs KV Cache with a Progressive Compression Strategy"><span class="ltx_text ltx_ref_tag">B</span></a>), allowing for significant compression without the need for complex token selection algorithms or time-consuming model tuning. By applying a low-rank approximation to the weight matrices, we effectively reduce the dimensionality of the KV cache while preserving the essential information flow through the network.</p>
</div>
<div class="ltx_para" id="S4.SS1.p2">
<p class="ltx_p" id="S4.SS1.p2.2"><span class="ltx_text ltx_font_bold" id="S4.SS1.p2.2.1">Key Matrix Compression:</span>
Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03111v1#S4.F1" title="Figure 1 ‣ 4 Method ‣ LoRC: Low-Rank Compression for LLMs KV Cache with a Progressive Compression Strategy"><span class="ltx_text ltx_ref_tag">1</span></a> presents how we implement SVD on the key weight matrices. Specifically, for the <math alttext="i" class="ltx_Math" display="inline" id="S4.SS1.p2.1.m1.1"><semantics id="S4.SS1.p2.1.m1.1a"><mi id="S4.SS1.p2.1.m1.1.1" xref="S4.SS1.p2.1.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.1.m1.1b"><ci id="S4.SS1.p2.1.m1.1.1.cmml" xref="S4.SS1.p2.1.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.1.m1.1c">i</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.1.m1.1d">italic_i</annotation></semantics></math>-th head in the MHA attention, we decompose its key matrix <math alttext="W^{i}_{k}\in\mathbb{R}^{D\times d}" class="ltx_Math" display="inline" id="S4.SS1.p2.2.m2.1"><semantics id="S4.SS1.p2.2.m2.1a"><mrow id="S4.SS1.p2.2.m2.1.1" xref="S4.SS1.p2.2.m2.1.1.cmml"><msubsup id="S4.SS1.p2.2.m2.1.1.2" xref="S4.SS1.p2.2.m2.1.1.2.cmml"><mi id="S4.SS1.p2.2.m2.1.1.2.2.2" xref="S4.SS1.p2.2.m2.1.1.2.2.2.cmml">W</mi><mi id="S4.SS1.p2.2.m2.1.1.2.3" xref="S4.SS1.p2.2.m2.1.1.2.3.cmml">k</mi><mi id="S4.SS1.p2.2.m2.1.1.2.2.3" xref="S4.SS1.p2.2.m2.1.1.2.2.3.cmml">i</mi></msubsup><mo id="S4.SS1.p2.2.m2.1.1.1" xref="S4.SS1.p2.2.m2.1.1.1.cmml">∈</mo><msup id="S4.SS1.p2.2.m2.1.1.3" xref="S4.SS1.p2.2.m2.1.1.3.cmml"><mi id="S4.SS1.p2.2.m2.1.1.3.2" xref="S4.SS1.p2.2.m2.1.1.3.2.cmml">ℝ</mi><mrow id="S4.SS1.p2.2.m2.1.1.3.3" xref="S4.SS1.p2.2.m2.1.1.3.3.cmml"><mi id="S4.SS1.p2.2.m2.1.1.3.3.2" xref="S4.SS1.p2.2.m2.1.1.3.3.2.cmml">D</mi><mo id="S4.SS1.p2.2.m2.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S4.SS1.p2.2.m2.1.1.3.3.1.cmml">×</mo><mi id="S4.SS1.p2.2.m2.1.1.3.3.3" xref="S4.SS1.p2.2.m2.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.2.m2.1b"><apply id="S4.SS1.p2.2.m2.1.1.cmml" xref="S4.SS1.p2.2.m2.1.1"><in id="S4.SS1.p2.2.m2.1.1.1.cmml" xref="S4.SS1.p2.2.m2.1.1.1"></in><apply id="S4.SS1.p2.2.m2.1.1.2.cmml" xref="S4.SS1.p2.2.m2.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p2.2.m2.1.1.2.1.cmml" xref="S4.SS1.p2.2.m2.1.1.2">subscript</csymbol><apply id="S4.SS1.p2.2.m2.1.1.2.2.cmml" xref="S4.SS1.p2.2.m2.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p2.2.m2.1.1.2.2.1.cmml" xref="S4.SS1.p2.2.m2.1.1.2">superscript</csymbol><ci id="S4.SS1.p2.2.m2.1.1.2.2.2.cmml" xref="S4.SS1.p2.2.m2.1.1.2.2.2">𝑊</ci><ci id="S4.SS1.p2.2.m2.1.1.2.2.3.cmml" xref="S4.SS1.p2.2.m2.1.1.2.2.3">𝑖</ci></apply><ci id="S4.SS1.p2.2.m2.1.1.2.3.cmml" xref="S4.SS1.p2.2.m2.1.1.2.3">𝑘</ci></apply><apply id="S4.SS1.p2.2.m2.1.1.3.cmml" xref="S4.SS1.p2.2.m2.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p2.2.m2.1.1.3.1.cmml" xref="S4.SS1.p2.2.m2.1.1.3">superscript</csymbol><ci id="S4.SS1.p2.2.m2.1.1.3.2.cmml" xref="S4.SS1.p2.2.m2.1.1.3.2">ℝ</ci><apply id="S4.SS1.p2.2.m2.1.1.3.3.cmml" xref="S4.SS1.p2.2.m2.1.1.3.3"><times id="S4.SS1.p2.2.m2.1.1.3.3.1.cmml" xref="S4.SS1.p2.2.m2.1.1.3.3.1"></times><ci id="S4.SS1.p2.2.m2.1.1.3.3.2.cmml" xref="S4.SS1.p2.2.m2.1.1.3.3.2">𝐷</ci><ci id="S4.SS1.p2.2.m2.1.1.3.3.3.cmml" xref="S4.SS1.p2.2.m2.1.1.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.2.m2.1c">W^{i}_{k}\in\mathbb{R}^{D\times d}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.2.m2.1d">italic_W start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_D × italic_d end_POSTSUPERSCRIPT</annotation></semantics></math> to:</p>
</div>
<div class="ltx_para" id="S4.SS1.p3">
<table class="ltx_equation ltx_eqn_table" id="S4.E5">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\text{SVD}(W^{i}_{k})_{D\times d}=U_{D\times d_{c}}\Sigma_{d_{c}\times d_{c}}V%
^{T}_{d_{c}\times d}=U_{D\times d_{c}}(\Sigma V^{T})_{d_{c}\times d}." class="ltx_Math" display="block" id="S4.E5.m1.1"><semantics id="S4.E5.m1.1a"><mrow id="S4.E5.m1.1.1.1" xref="S4.E5.m1.1.1.1.1.cmml"><mrow id="S4.E5.m1.1.1.1.1" xref="S4.E5.m1.1.1.1.1.cmml"><mrow id="S4.E5.m1.1.1.1.1.1" xref="S4.E5.m1.1.1.1.1.1.cmml"><mtext id="S4.E5.m1.1.1.1.1.1.3" xref="S4.E5.m1.1.1.1.1.1.3a.cmml">SVD</mtext><mo id="S4.E5.m1.1.1.1.1.1.2" xref="S4.E5.m1.1.1.1.1.1.2.cmml">⁢</mo><msub id="S4.E5.m1.1.1.1.1.1.1" xref="S4.E5.m1.1.1.1.1.1.1.cmml"><mrow id="S4.E5.m1.1.1.1.1.1.1.1.1" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.E5.m1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="S4.E5.m1.1.1.1.1.1.1.1.1.1" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E5.m1.1.1.1.1.1.1.1.1.1.2.2" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.2.2.cmml">W</mi><mi id="S4.E5.m1.1.1.1.1.1.1.1.1.1.3" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.3.cmml">k</mi><mi id="S4.E5.m1.1.1.1.1.1.1.1.1.1.2.3" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.2.3.cmml">i</mi></msubsup><mo id="S4.E5.m1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mrow id="S4.E5.m1.1.1.1.1.1.1.3" xref="S4.E5.m1.1.1.1.1.1.1.3.cmml"><mi id="S4.E5.m1.1.1.1.1.1.1.3.2" xref="S4.E5.m1.1.1.1.1.1.1.3.2.cmml">D</mi><mo id="S4.E5.m1.1.1.1.1.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="S4.E5.m1.1.1.1.1.1.1.3.1.cmml">×</mo><mi id="S4.E5.m1.1.1.1.1.1.1.3.3" xref="S4.E5.m1.1.1.1.1.1.1.3.3.cmml">d</mi></mrow></msub></mrow><mo id="S4.E5.m1.1.1.1.1.4" xref="S4.E5.m1.1.1.1.1.4.cmml">=</mo><mrow id="S4.E5.m1.1.1.1.1.5" xref="S4.E5.m1.1.1.1.1.5.cmml"><msub id="S4.E5.m1.1.1.1.1.5.2" xref="S4.E5.m1.1.1.1.1.5.2.cmml"><mi id="S4.E5.m1.1.1.1.1.5.2.2" xref="S4.E5.m1.1.1.1.1.5.2.2.cmml">U</mi><mrow id="S4.E5.m1.1.1.1.1.5.2.3" xref="S4.E5.m1.1.1.1.1.5.2.3.cmml"><mi id="S4.E5.m1.1.1.1.1.5.2.3.2" xref="S4.E5.m1.1.1.1.1.5.2.3.2.cmml">D</mi><mo id="S4.E5.m1.1.1.1.1.5.2.3.1" lspace="0.222em" rspace="0.222em" xref="S4.E5.m1.1.1.1.1.5.2.3.1.cmml">×</mo><msub id="S4.E5.m1.1.1.1.1.5.2.3.3" xref="S4.E5.m1.1.1.1.1.5.2.3.3.cmml"><mi id="S4.E5.m1.1.1.1.1.5.2.3.3.2" xref="S4.E5.m1.1.1.1.1.5.2.3.3.2.cmml">d</mi><mi id="S4.E5.m1.1.1.1.1.5.2.3.3.3" xref="S4.E5.m1.1.1.1.1.5.2.3.3.3.cmml">c</mi></msub></mrow></msub><mo id="S4.E5.m1.1.1.1.1.5.1" xref="S4.E5.m1.1.1.1.1.5.1.cmml">⁢</mo><msub id="S4.E5.m1.1.1.1.1.5.3" xref="S4.E5.m1.1.1.1.1.5.3.cmml"><mi id="S4.E5.m1.1.1.1.1.5.3.2" mathvariant="normal" xref="S4.E5.m1.1.1.1.1.5.3.2.cmml">Σ</mi><mrow id="S4.E5.m1.1.1.1.1.5.3.3" xref="S4.E5.m1.1.1.1.1.5.3.3.cmml"><msub id="S4.E5.m1.1.1.1.1.5.3.3.2" xref="S4.E5.m1.1.1.1.1.5.3.3.2.cmml"><mi id="S4.E5.m1.1.1.1.1.5.3.3.2.2" xref="S4.E5.m1.1.1.1.1.5.3.3.2.2.cmml">d</mi><mi id="S4.E5.m1.1.1.1.1.5.3.3.2.3" xref="S4.E5.m1.1.1.1.1.5.3.3.2.3.cmml">c</mi></msub><mo id="S4.E5.m1.1.1.1.1.5.3.3.1" lspace="0.222em" rspace="0.222em" xref="S4.E5.m1.1.1.1.1.5.3.3.1.cmml">×</mo><msub id="S4.E5.m1.1.1.1.1.5.3.3.3" xref="S4.E5.m1.1.1.1.1.5.3.3.3.cmml"><mi id="S4.E5.m1.1.1.1.1.5.3.3.3.2" xref="S4.E5.m1.1.1.1.1.5.3.3.3.2.cmml">d</mi><mi id="S4.E5.m1.1.1.1.1.5.3.3.3.3" xref="S4.E5.m1.1.1.1.1.5.3.3.3.3.cmml">c</mi></msub></mrow></msub><mo id="S4.E5.m1.1.1.1.1.5.1a" xref="S4.E5.m1.1.1.1.1.5.1.cmml">⁢</mo><msubsup id="S4.E5.m1.1.1.1.1.5.4" xref="S4.E5.m1.1.1.1.1.5.4.cmml"><mi id="S4.E5.m1.1.1.1.1.5.4.2.2" xref="S4.E5.m1.1.1.1.1.5.4.2.2.cmml">V</mi><mrow id="S4.E5.m1.1.1.1.1.5.4.3" xref="S4.E5.m1.1.1.1.1.5.4.3.cmml"><msub id="S4.E5.m1.1.1.1.1.5.4.3.2" xref="S4.E5.m1.1.1.1.1.5.4.3.2.cmml"><mi id="S4.E5.m1.1.1.1.1.5.4.3.2.2" xref="S4.E5.m1.1.1.1.1.5.4.3.2.2.cmml">d</mi><mi id="S4.E5.m1.1.1.1.1.5.4.3.2.3" xref="S4.E5.m1.1.1.1.1.5.4.3.2.3.cmml">c</mi></msub><mo id="S4.E5.m1.1.1.1.1.5.4.3.1" lspace="0.222em" rspace="0.222em" xref="S4.E5.m1.1.1.1.1.5.4.3.1.cmml">×</mo><mi id="S4.E5.m1.1.1.1.1.5.4.3.3" xref="S4.E5.m1.1.1.1.1.5.4.3.3.cmml">d</mi></mrow><mi id="S4.E5.m1.1.1.1.1.5.4.2.3" xref="S4.E5.m1.1.1.1.1.5.4.2.3.cmml">T</mi></msubsup></mrow><mo id="S4.E5.m1.1.1.1.1.6" xref="S4.E5.m1.1.1.1.1.6.cmml">=</mo><mrow id="S4.E5.m1.1.1.1.1.2" xref="S4.E5.m1.1.1.1.1.2.cmml"><msub id="S4.E5.m1.1.1.1.1.2.3" xref="S4.E5.m1.1.1.1.1.2.3.cmml"><mi id="S4.E5.m1.1.1.1.1.2.3.2" xref="S4.E5.m1.1.1.1.1.2.3.2.cmml">U</mi><mrow id="S4.E5.m1.1.1.1.1.2.3.3" xref="S4.E5.m1.1.1.1.1.2.3.3.cmml"><mi id="S4.E5.m1.1.1.1.1.2.3.3.2" xref="S4.E5.m1.1.1.1.1.2.3.3.2.cmml">D</mi><mo id="S4.E5.m1.1.1.1.1.2.3.3.1" lspace="0.222em" rspace="0.222em" xref="S4.E5.m1.1.1.1.1.2.3.3.1.cmml">×</mo><msub id="S4.E5.m1.1.1.1.1.2.3.3.3" xref="S4.E5.m1.1.1.1.1.2.3.3.3.cmml"><mi id="S4.E5.m1.1.1.1.1.2.3.3.3.2" xref="S4.E5.m1.1.1.1.1.2.3.3.3.2.cmml">d</mi><mi id="S4.E5.m1.1.1.1.1.2.3.3.3.3" xref="S4.E5.m1.1.1.1.1.2.3.3.3.3.cmml">c</mi></msub></mrow></msub><mo id="S4.E5.m1.1.1.1.1.2.2" xref="S4.E5.m1.1.1.1.1.2.2.cmml">⁢</mo><msub id="S4.E5.m1.1.1.1.1.2.1" xref="S4.E5.m1.1.1.1.1.2.1.cmml"><mrow id="S4.E5.m1.1.1.1.1.2.1.1.1" xref="S4.E5.m1.1.1.1.1.2.1.1.1.1.cmml"><mo id="S4.E5.m1.1.1.1.1.2.1.1.1.2" stretchy="false" xref="S4.E5.m1.1.1.1.1.2.1.1.1.1.cmml">(</mo><mrow id="S4.E5.m1.1.1.1.1.2.1.1.1.1" xref="S4.E5.m1.1.1.1.1.2.1.1.1.1.cmml"><mi id="S4.E5.m1.1.1.1.1.2.1.1.1.1.2" mathvariant="normal" xref="S4.E5.m1.1.1.1.1.2.1.1.1.1.2.cmml">Σ</mi><mo id="S4.E5.m1.1.1.1.1.2.1.1.1.1.1" xref="S4.E5.m1.1.1.1.1.2.1.1.1.1.1.cmml">⁢</mo><msup id="S4.E5.m1.1.1.1.1.2.1.1.1.1.3" xref="S4.E5.m1.1.1.1.1.2.1.1.1.1.3.cmml"><mi id="S4.E5.m1.1.1.1.1.2.1.1.1.1.3.2" xref="S4.E5.m1.1.1.1.1.2.1.1.1.1.3.2.cmml">V</mi><mi id="S4.E5.m1.1.1.1.1.2.1.1.1.1.3.3" xref="S4.E5.m1.1.1.1.1.2.1.1.1.1.3.3.cmml">T</mi></msup></mrow><mo id="S4.E5.m1.1.1.1.1.2.1.1.1.3" stretchy="false" xref="S4.E5.m1.1.1.1.1.2.1.1.1.1.cmml">)</mo></mrow><mrow id="S4.E5.m1.1.1.1.1.2.1.3" xref="S4.E5.m1.1.1.1.1.2.1.3.cmml"><msub id="S4.E5.m1.1.1.1.1.2.1.3.2" xref="S4.E5.m1.1.1.1.1.2.1.3.2.cmml"><mi id="S4.E5.m1.1.1.1.1.2.1.3.2.2" xref="S4.E5.m1.1.1.1.1.2.1.3.2.2.cmml">d</mi><mi id="S4.E5.m1.1.1.1.1.2.1.3.2.3" xref="S4.E5.m1.1.1.1.1.2.1.3.2.3.cmml">c</mi></msub><mo id="S4.E5.m1.1.1.1.1.2.1.3.1" lspace="0.222em" rspace="0.222em" xref="S4.E5.m1.1.1.1.1.2.1.3.1.cmml">×</mo><mi id="S4.E5.m1.1.1.1.1.2.1.3.3" xref="S4.E5.m1.1.1.1.1.2.1.3.3.cmml">d</mi></mrow></msub></mrow></mrow><mo id="S4.E5.m1.1.1.1.2" lspace="0em" xref="S4.E5.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E5.m1.1b"><apply id="S4.E5.m1.1.1.1.1.cmml" xref="S4.E5.m1.1.1.1"><and id="S4.E5.m1.1.1.1.1a.cmml" xref="S4.E5.m1.1.1.1"></and><apply id="S4.E5.m1.1.1.1.1b.cmml" xref="S4.E5.m1.1.1.1"><eq id="S4.E5.m1.1.1.1.1.4.cmml" xref="S4.E5.m1.1.1.1.1.4"></eq><apply id="S4.E5.m1.1.1.1.1.1.cmml" xref="S4.E5.m1.1.1.1.1.1"><times id="S4.E5.m1.1.1.1.1.1.2.cmml" xref="S4.E5.m1.1.1.1.1.1.2"></times><ci id="S4.E5.m1.1.1.1.1.1.3a.cmml" xref="S4.E5.m1.1.1.1.1.1.3"><mtext id="S4.E5.m1.1.1.1.1.1.3.cmml" xref="S4.E5.m1.1.1.1.1.1.3">SVD</mtext></ci><apply id="S4.E5.m1.1.1.1.1.1.1.cmml" xref="S4.E5.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E5.m1.1.1.1.1.1.1.2.cmml" xref="S4.E5.m1.1.1.1.1.1.1">subscript</csymbol><apply id="S4.E5.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="S4.E5.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E5.m1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S4.E5.m1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.2.2">𝑊</ci><ci id="S4.E5.m1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="S4.E5.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.3">𝑘</ci></apply><apply id="S4.E5.m1.1.1.1.1.1.1.3.cmml" xref="S4.E5.m1.1.1.1.1.1.1.3"><times id="S4.E5.m1.1.1.1.1.1.1.3.1.cmml" xref="S4.E5.m1.1.1.1.1.1.1.3.1"></times><ci id="S4.E5.m1.1.1.1.1.1.1.3.2.cmml" xref="S4.E5.m1.1.1.1.1.1.1.3.2">𝐷</ci><ci id="S4.E5.m1.1.1.1.1.1.1.3.3.cmml" xref="S4.E5.m1.1.1.1.1.1.1.3.3">𝑑</ci></apply></apply></apply><apply id="S4.E5.m1.1.1.1.1.5.cmml" xref="S4.E5.m1.1.1.1.1.5"><times id="S4.E5.m1.1.1.1.1.5.1.cmml" xref="S4.E5.m1.1.1.1.1.5.1"></times><apply id="S4.E5.m1.1.1.1.1.5.2.cmml" xref="S4.E5.m1.1.1.1.1.5.2"><csymbol cd="ambiguous" id="S4.E5.m1.1.1.1.1.5.2.1.cmml" xref="S4.E5.m1.1.1.1.1.5.2">subscript</csymbol><ci id="S4.E5.m1.1.1.1.1.5.2.2.cmml" xref="S4.E5.m1.1.1.1.1.5.2.2">𝑈</ci><apply id="S4.E5.m1.1.1.1.1.5.2.3.cmml" xref="S4.E5.m1.1.1.1.1.5.2.3"><times id="S4.E5.m1.1.1.1.1.5.2.3.1.cmml" xref="S4.E5.m1.1.1.1.1.5.2.3.1"></times><ci id="S4.E5.m1.1.1.1.1.5.2.3.2.cmml" xref="S4.E5.m1.1.1.1.1.5.2.3.2">𝐷</ci><apply id="S4.E5.m1.1.1.1.1.5.2.3.3.cmml" xref="S4.E5.m1.1.1.1.1.5.2.3.3"><csymbol cd="ambiguous" id="S4.E5.m1.1.1.1.1.5.2.3.3.1.cmml" xref="S4.E5.m1.1.1.1.1.5.2.3.3">subscript</csymbol><ci id="S4.E5.m1.1.1.1.1.5.2.3.3.2.cmml" xref="S4.E5.m1.1.1.1.1.5.2.3.3.2">𝑑</ci><ci id="S4.E5.m1.1.1.1.1.5.2.3.3.3.cmml" xref="S4.E5.m1.1.1.1.1.5.2.3.3.3">𝑐</ci></apply></apply></apply><apply id="S4.E5.m1.1.1.1.1.5.3.cmml" xref="S4.E5.m1.1.1.1.1.5.3"><csymbol cd="ambiguous" id="S4.E5.m1.1.1.1.1.5.3.1.cmml" xref="S4.E5.m1.1.1.1.1.5.3">subscript</csymbol><ci id="S4.E5.m1.1.1.1.1.5.3.2.cmml" xref="S4.E5.m1.1.1.1.1.5.3.2">Σ</ci><apply id="S4.E5.m1.1.1.1.1.5.3.3.cmml" xref="S4.E5.m1.1.1.1.1.5.3.3"><times id="S4.E5.m1.1.1.1.1.5.3.3.1.cmml" xref="S4.E5.m1.1.1.1.1.5.3.3.1"></times><apply id="S4.E5.m1.1.1.1.1.5.3.3.2.cmml" xref="S4.E5.m1.1.1.1.1.5.3.3.2"><csymbol cd="ambiguous" id="S4.E5.m1.1.1.1.1.5.3.3.2.1.cmml" xref="S4.E5.m1.1.1.1.1.5.3.3.2">subscript</csymbol><ci id="S4.E5.m1.1.1.1.1.5.3.3.2.2.cmml" xref="S4.E5.m1.1.1.1.1.5.3.3.2.2">𝑑</ci><ci id="S4.E5.m1.1.1.1.1.5.3.3.2.3.cmml" xref="S4.E5.m1.1.1.1.1.5.3.3.2.3">𝑐</ci></apply><apply id="S4.E5.m1.1.1.1.1.5.3.3.3.cmml" xref="S4.E5.m1.1.1.1.1.5.3.3.3"><csymbol cd="ambiguous" id="S4.E5.m1.1.1.1.1.5.3.3.3.1.cmml" xref="S4.E5.m1.1.1.1.1.5.3.3.3">subscript</csymbol><ci id="S4.E5.m1.1.1.1.1.5.3.3.3.2.cmml" xref="S4.E5.m1.1.1.1.1.5.3.3.3.2">𝑑</ci><ci id="S4.E5.m1.1.1.1.1.5.3.3.3.3.cmml" xref="S4.E5.m1.1.1.1.1.5.3.3.3.3">𝑐</ci></apply></apply></apply><apply id="S4.E5.m1.1.1.1.1.5.4.cmml" xref="S4.E5.m1.1.1.1.1.5.4"><csymbol cd="ambiguous" id="S4.E5.m1.1.1.1.1.5.4.1.cmml" xref="S4.E5.m1.1.1.1.1.5.4">subscript</csymbol><apply id="S4.E5.m1.1.1.1.1.5.4.2.cmml" xref="S4.E5.m1.1.1.1.1.5.4"><csymbol cd="ambiguous" id="S4.E5.m1.1.1.1.1.5.4.2.1.cmml" xref="S4.E5.m1.1.1.1.1.5.4">superscript</csymbol><ci id="S4.E5.m1.1.1.1.1.5.4.2.2.cmml" xref="S4.E5.m1.1.1.1.1.5.4.2.2">𝑉</ci><ci id="S4.E5.m1.1.1.1.1.5.4.2.3.cmml" xref="S4.E5.m1.1.1.1.1.5.4.2.3">𝑇</ci></apply><apply id="S4.E5.m1.1.1.1.1.5.4.3.cmml" xref="S4.E5.m1.1.1.1.1.5.4.3"><times id="S4.E5.m1.1.1.1.1.5.4.3.1.cmml" xref="S4.E5.m1.1.1.1.1.5.4.3.1"></times><apply id="S4.E5.m1.1.1.1.1.5.4.3.2.cmml" xref="S4.E5.m1.1.1.1.1.5.4.3.2"><csymbol cd="ambiguous" id="S4.E5.m1.1.1.1.1.5.4.3.2.1.cmml" xref="S4.E5.m1.1.1.1.1.5.4.3.2">subscript</csymbol><ci id="S4.E5.m1.1.1.1.1.5.4.3.2.2.cmml" xref="S4.E5.m1.1.1.1.1.5.4.3.2.2">𝑑</ci><ci id="S4.E5.m1.1.1.1.1.5.4.3.2.3.cmml" xref="S4.E5.m1.1.1.1.1.5.4.3.2.3">𝑐</ci></apply><ci id="S4.E5.m1.1.1.1.1.5.4.3.3.cmml" xref="S4.E5.m1.1.1.1.1.5.4.3.3">𝑑</ci></apply></apply></apply></apply><apply id="S4.E5.m1.1.1.1.1c.cmml" xref="S4.E5.m1.1.1.1"><eq id="S4.E5.m1.1.1.1.1.6.cmml" xref="S4.E5.m1.1.1.1.1.6"></eq><share href="https://arxiv.org/html/2410.03111v1#S4.E5.m1.1.1.1.1.5.cmml" id="S4.E5.m1.1.1.1.1d.cmml" xref="S4.E5.m1.1.1.1"></share><apply id="S4.E5.m1.1.1.1.1.2.cmml" xref="S4.E5.m1.1.1.1.1.2"><times id="S4.E5.m1.1.1.1.1.2.2.cmml" xref="S4.E5.m1.1.1.1.1.2.2"></times><apply id="S4.E5.m1.1.1.1.1.2.3.cmml" xref="S4.E5.m1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S4.E5.m1.1.1.1.1.2.3.1.cmml" xref="S4.E5.m1.1.1.1.1.2.3">subscript</csymbol><ci id="S4.E5.m1.1.1.1.1.2.3.2.cmml" xref="S4.E5.m1.1.1.1.1.2.3.2">𝑈</ci><apply id="S4.E5.m1.1.1.1.1.2.3.3.cmml" xref="S4.E5.m1.1.1.1.1.2.3.3"><times id="S4.E5.m1.1.1.1.1.2.3.3.1.cmml" xref="S4.E5.m1.1.1.1.1.2.3.3.1"></times><ci id="S4.E5.m1.1.1.1.1.2.3.3.2.cmml" xref="S4.E5.m1.1.1.1.1.2.3.3.2">𝐷</ci><apply id="S4.E5.m1.1.1.1.1.2.3.3.3.cmml" xref="S4.E5.m1.1.1.1.1.2.3.3.3"><csymbol cd="ambiguous" id="S4.E5.m1.1.1.1.1.2.3.3.3.1.cmml" xref="S4.E5.m1.1.1.1.1.2.3.3.3">subscript</csymbol><ci id="S4.E5.m1.1.1.1.1.2.3.3.3.2.cmml" xref="S4.E5.m1.1.1.1.1.2.3.3.3.2">𝑑</ci><ci id="S4.E5.m1.1.1.1.1.2.3.3.3.3.cmml" xref="S4.E5.m1.1.1.1.1.2.3.3.3.3">𝑐</ci></apply></apply></apply><apply id="S4.E5.m1.1.1.1.1.2.1.cmml" xref="S4.E5.m1.1.1.1.1.2.1"><csymbol cd="ambiguous" id="S4.E5.m1.1.1.1.1.2.1.2.cmml" xref="S4.E5.m1.1.1.1.1.2.1">subscript</csymbol><apply id="S4.E5.m1.1.1.1.1.2.1.1.1.1.cmml" xref="S4.E5.m1.1.1.1.1.2.1.1.1"><times id="S4.E5.m1.1.1.1.1.2.1.1.1.1.1.cmml" xref="S4.E5.m1.1.1.1.1.2.1.1.1.1.1"></times><ci id="S4.E5.m1.1.1.1.1.2.1.1.1.1.2.cmml" xref="S4.E5.m1.1.1.1.1.2.1.1.1.1.2">Σ</ci><apply id="S4.E5.m1.1.1.1.1.2.1.1.1.1.3.cmml" xref="S4.E5.m1.1.1.1.1.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E5.m1.1.1.1.1.2.1.1.1.1.3.1.cmml" xref="S4.E5.m1.1.1.1.1.2.1.1.1.1.3">superscript</csymbol><ci id="S4.E5.m1.1.1.1.1.2.1.1.1.1.3.2.cmml" xref="S4.E5.m1.1.1.1.1.2.1.1.1.1.3.2">𝑉</ci><ci id="S4.E5.m1.1.1.1.1.2.1.1.1.1.3.3.cmml" xref="S4.E5.m1.1.1.1.1.2.1.1.1.1.3.3">𝑇</ci></apply></apply><apply id="S4.E5.m1.1.1.1.1.2.1.3.cmml" xref="S4.E5.m1.1.1.1.1.2.1.3"><times id="S4.E5.m1.1.1.1.1.2.1.3.1.cmml" xref="S4.E5.m1.1.1.1.1.2.1.3.1"></times><apply id="S4.E5.m1.1.1.1.1.2.1.3.2.cmml" xref="S4.E5.m1.1.1.1.1.2.1.3.2"><csymbol cd="ambiguous" id="S4.E5.m1.1.1.1.1.2.1.3.2.1.cmml" xref="S4.E5.m1.1.1.1.1.2.1.3.2">subscript</csymbol><ci id="S4.E5.m1.1.1.1.1.2.1.3.2.2.cmml" xref="S4.E5.m1.1.1.1.1.2.1.3.2.2">𝑑</ci><ci id="S4.E5.m1.1.1.1.1.2.1.3.2.3.cmml" xref="S4.E5.m1.1.1.1.1.2.1.3.2.3">𝑐</ci></apply><ci id="S4.E5.m1.1.1.1.1.2.1.3.3.cmml" xref="S4.E5.m1.1.1.1.1.2.1.3.3">𝑑</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E5.m1.1c">\text{SVD}(W^{i}_{k})_{D\times d}=U_{D\times d_{c}}\Sigma_{d_{c}\times d_{c}}V%
^{T}_{d_{c}\times d}=U_{D\times d_{c}}(\Sigma V^{T})_{d_{c}\times d}.</annotation><annotation encoding="application/x-llamapun" id="S4.E5.m1.1d">SVD ( italic_W start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ) start_POSTSUBSCRIPT italic_D × italic_d end_POSTSUBSCRIPT = italic_U start_POSTSUBSCRIPT italic_D × italic_d start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT end_POSTSUBSCRIPT roman_Σ start_POSTSUBSCRIPT italic_d start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT × italic_d start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT end_POSTSUBSCRIPT italic_V start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_d start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT × italic_d end_POSTSUBSCRIPT = italic_U start_POSTSUBSCRIPT italic_D × italic_d start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( roman_Σ italic_V start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT ) start_POSTSUBSCRIPT italic_d start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT × italic_d end_POSTSUBSCRIPT .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS1.p3.1">For MHA, there are <math alttext="h" class="ltx_Math" display="inline" id="S4.SS1.p3.1.m1.1"><semantics id="S4.SS1.p3.1.m1.1a"><mi id="S4.SS1.p3.1.m1.1.1" xref="S4.SS1.p3.1.m1.1.1.cmml">h</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.1.m1.1b"><ci id="S4.SS1.p3.1.m1.1.1.cmml" xref="S4.SS1.p3.1.m1.1.1">ℎ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.1.m1.1c">h</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.1.m1.1d">italic_h</annotation></semantics></math> attention heads, then the decomposition becomes:</p>
</div>
<div class="ltx_para" id="S4.SS1.p4">
<table class="ltx_equation ltx_eqn_table" id="S4.E6">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\text{SVD}(W^{H}_{k})_{D\times hd}=U_{D\times d_{c}}(\Sigma V^{T})_{d_{c}%
\times hd}=U_{D\times d_{c}}\left[\begin{array}[]{cccc}(A^{1})_{d_{c}\times d}%
&amp;(A^{2})_{d_{c}\times d}&amp;\cdots&amp;(A^{h})_{d_{c}\times d}\end{array}\right]," class="ltx_Math" display="block" id="S4.E6.m1.4"><semantics id="S4.E6.m1.4a"><mrow id="S4.E6.m1.4.4.1" xref="S4.E6.m1.4.4.1.1.cmml"><mrow id="S4.E6.m1.4.4.1.1" xref="S4.E6.m1.4.4.1.1.cmml"><mrow id="S4.E6.m1.4.4.1.1.1" xref="S4.E6.m1.4.4.1.1.1.cmml"><mtext id="S4.E6.m1.4.4.1.1.1.3" xref="S4.E6.m1.4.4.1.1.1.3a.cmml">SVD</mtext><mo id="S4.E6.m1.4.4.1.1.1.2" xref="S4.E6.m1.4.4.1.1.1.2.cmml">⁢</mo><msub id="S4.E6.m1.4.4.1.1.1.1" xref="S4.E6.m1.4.4.1.1.1.1.cmml"><mrow id="S4.E6.m1.4.4.1.1.1.1.1.1" xref="S4.E6.m1.4.4.1.1.1.1.1.1.1.cmml"><mo id="S4.E6.m1.4.4.1.1.1.1.1.1.2" stretchy="false" xref="S4.E6.m1.4.4.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="S4.E6.m1.4.4.1.1.1.1.1.1.1" xref="S4.E6.m1.4.4.1.1.1.1.1.1.1.cmml"><mi id="S4.E6.m1.4.4.1.1.1.1.1.1.1.2.2" xref="S4.E6.m1.4.4.1.1.1.1.1.1.1.2.2.cmml">W</mi><mi id="S4.E6.m1.4.4.1.1.1.1.1.1.1.3" xref="S4.E6.m1.4.4.1.1.1.1.1.1.1.3.cmml">k</mi><mi id="S4.E6.m1.4.4.1.1.1.1.1.1.1.2.3" xref="S4.E6.m1.4.4.1.1.1.1.1.1.1.2.3.cmml">H</mi></msubsup><mo id="S4.E6.m1.4.4.1.1.1.1.1.1.3" stretchy="false" xref="S4.E6.m1.4.4.1.1.1.1.1.1.1.cmml">)</mo></mrow><mrow id="S4.E6.m1.4.4.1.1.1.1.3" xref="S4.E6.m1.4.4.1.1.1.1.3.cmml"><mrow id="S4.E6.m1.4.4.1.1.1.1.3.2" xref="S4.E6.m1.4.4.1.1.1.1.3.2.cmml"><mi id="S4.E6.m1.4.4.1.1.1.1.3.2.2" xref="S4.E6.m1.4.4.1.1.1.1.3.2.2.cmml">D</mi><mo id="S4.E6.m1.4.4.1.1.1.1.3.2.1" lspace="0.222em" rspace="0.222em" xref="S4.E6.m1.4.4.1.1.1.1.3.2.1.cmml">×</mo><mi id="S4.E6.m1.4.4.1.1.1.1.3.2.3" xref="S4.E6.m1.4.4.1.1.1.1.3.2.3.cmml">h</mi></mrow><mo id="S4.E6.m1.4.4.1.1.1.1.3.1" xref="S4.E6.m1.4.4.1.1.1.1.3.1.cmml">⁢</mo><mi id="S4.E6.m1.4.4.1.1.1.1.3.3" xref="S4.E6.m1.4.4.1.1.1.1.3.3.cmml">d</mi></mrow></msub></mrow><mo id="S4.E6.m1.4.4.1.1.4" xref="S4.E6.m1.4.4.1.1.4.cmml">=</mo><mrow id="S4.E6.m1.4.4.1.1.2" xref="S4.E6.m1.4.4.1.1.2.cmml"><msub id="S4.E6.m1.4.4.1.1.2.3" xref="S4.E6.m1.4.4.1.1.2.3.cmml"><mi id="S4.E6.m1.4.4.1.1.2.3.2" xref="S4.E6.m1.4.4.1.1.2.3.2.cmml">U</mi><mrow id="S4.E6.m1.4.4.1.1.2.3.3" xref="S4.E6.m1.4.4.1.1.2.3.3.cmml"><mi id="S4.E6.m1.4.4.1.1.2.3.3.2" xref="S4.E6.m1.4.4.1.1.2.3.3.2.cmml">D</mi><mo id="S4.E6.m1.4.4.1.1.2.3.3.1" lspace="0.222em" rspace="0.222em" xref="S4.E6.m1.4.4.1.1.2.3.3.1.cmml">×</mo><msub id="S4.E6.m1.4.4.1.1.2.3.3.3" xref="S4.E6.m1.4.4.1.1.2.3.3.3.cmml"><mi id="S4.E6.m1.4.4.1.1.2.3.3.3.2" xref="S4.E6.m1.4.4.1.1.2.3.3.3.2.cmml">d</mi><mi id="S4.E6.m1.4.4.1.1.2.3.3.3.3" xref="S4.E6.m1.4.4.1.1.2.3.3.3.3.cmml">c</mi></msub></mrow></msub><mo id="S4.E6.m1.4.4.1.1.2.2" xref="S4.E6.m1.4.4.1.1.2.2.cmml">⁢</mo><msub id="S4.E6.m1.4.4.1.1.2.1" xref="S4.E6.m1.4.4.1.1.2.1.cmml"><mrow id="S4.E6.m1.4.4.1.1.2.1.1.1" xref="S4.E6.m1.4.4.1.1.2.1.1.1.1.cmml"><mo id="S4.E6.m1.4.4.1.1.2.1.1.1.2" stretchy="false" xref="S4.E6.m1.4.4.1.1.2.1.1.1.1.cmml">(</mo><mrow id="S4.E6.m1.4.4.1.1.2.1.1.1.1" xref="S4.E6.m1.4.4.1.1.2.1.1.1.1.cmml"><mi id="S4.E6.m1.4.4.1.1.2.1.1.1.1.2" mathvariant="normal" xref="S4.E6.m1.4.4.1.1.2.1.1.1.1.2.cmml">Σ</mi><mo id="S4.E6.m1.4.4.1.1.2.1.1.1.1.1" xref="S4.E6.m1.4.4.1.1.2.1.1.1.1.1.cmml">⁢</mo><msup id="S4.E6.m1.4.4.1.1.2.1.1.1.1.3" xref="S4.E6.m1.4.4.1.1.2.1.1.1.1.3.cmml"><mi id="S4.E6.m1.4.4.1.1.2.1.1.1.1.3.2" xref="S4.E6.m1.4.4.1.1.2.1.1.1.1.3.2.cmml">V</mi><mi id="S4.E6.m1.4.4.1.1.2.1.1.1.1.3.3" xref="S4.E6.m1.4.4.1.1.2.1.1.1.1.3.3.cmml">T</mi></msup></mrow><mo id="S4.E6.m1.4.4.1.1.2.1.1.1.3" stretchy="false" xref="S4.E6.m1.4.4.1.1.2.1.1.1.1.cmml">)</mo></mrow><mrow id="S4.E6.m1.4.4.1.1.2.1.3" xref="S4.E6.m1.4.4.1.1.2.1.3.cmml"><mrow id="S4.E6.m1.4.4.1.1.2.1.3.2" xref="S4.E6.m1.4.4.1.1.2.1.3.2.cmml"><msub id="S4.E6.m1.4.4.1.1.2.1.3.2.2" xref="S4.E6.m1.4.4.1.1.2.1.3.2.2.cmml"><mi id="S4.E6.m1.4.4.1.1.2.1.3.2.2.2" xref="S4.E6.m1.4.4.1.1.2.1.3.2.2.2.cmml">d</mi><mi id="S4.E6.m1.4.4.1.1.2.1.3.2.2.3" xref="S4.E6.m1.4.4.1.1.2.1.3.2.2.3.cmml">c</mi></msub><mo id="S4.E6.m1.4.4.1.1.2.1.3.2.1" lspace="0.222em" rspace="0.222em" xref="S4.E6.m1.4.4.1.1.2.1.3.2.1.cmml">×</mo><mi id="S4.E6.m1.4.4.1.1.2.1.3.2.3" xref="S4.E6.m1.4.4.1.1.2.1.3.2.3.cmml">h</mi></mrow><mo id="S4.E6.m1.4.4.1.1.2.1.3.1" xref="S4.E6.m1.4.4.1.1.2.1.3.1.cmml">⁢</mo><mi id="S4.E6.m1.4.4.1.1.2.1.3.3" xref="S4.E6.m1.4.4.1.1.2.1.3.3.cmml">d</mi></mrow></msub></mrow><mo id="S4.E6.m1.4.4.1.1.5" xref="S4.E6.m1.4.4.1.1.5.cmml">=</mo><mrow id="S4.E6.m1.4.4.1.1.6" xref="S4.E6.m1.4.4.1.1.6.cmml"><msub id="S4.E6.m1.4.4.1.1.6.2" xref="S4.E6.m1.4.4.1.1.6.2.cmml"><mi id="S4.E6.m1.4.4.1.1.6.2.2" xref="S4.E6.m1.4.4.1.1.6.2.2.cmml">U</mi><mrow id="S4.E6.m1.4.4.1.1.6.2.3" xref="S4.E6.m1.4.4.1.1.6.2.3.cmml"><mi id="S4.E6.m1.4.4.1.1.6.2.3.2" xref="S4.E6.m1.4.4.1.1.6.2.3.2.cmml">D</mi><mo id="S4.E6.m1.4.4.1.1.6.2.3.1" lspace="0.222em" rspace="0.222em" xref="S4.E6.m1.4.4.1.1.6.2.3.1.cmml">×</mo><msub id="S4.E6.m1.4.4.1.1.6.2.3.3" xref="S4.E6.m1.4.4.1.1.6.2.3.3.cmml"><mi id="S4.E6.m1.4.4.1.1.6.2.3.3.2" xref="S4.E6.m1.4.4.1.1.6.2.3.3.2.cmml">d</mi><mi id="S4.E6.m1.4.4.1.1.6.2.3.3.3" xref="S4.E6.m1.4.4.1.1.6.2.3.3.3.cmml">c</mi></msub></mrow></msub><mo id="S4.E6.m1.4.4.1.1.6.1" xref="S4.E6.m1.4.4.1.1.6.1.cmml">⁢</mo><mrow id="S4.E6.m1.4.4.1.1.6.3.2" xref="S4.E6.m1.4.4.1.1.6.3.1.cmml"><mo id="S4.E6.m1.4.4.1.1.6.3.2.1" xref="S4.E6.m1.4.4.1.1.6.3.1.1.cmml">[</mo><mtable columnspacing="5pt" displaystyle="true" id="S4.E6.m1.3.3" xref="S4.E6.m1.3.3.cmml"><mtr id="S4.E6.m1.3.3a" xref="S4.E6.m1.3.3.cmml"><mtd id="S4.E6.m1.3.3b" xref="S4.E6.m1.3.3.cmml"><msub id="S4.E6.m1.1.1.1.1.1" xref="S4.E6.m1.1.1.1.1.1.cmml"><mrow id="S4.E6.m1.1.1.1.1.1.1.1" xref="S4.E6.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.E6.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.E6.m1.1.1.1.1.1.1.1.1.cmml">(</mo><msup id="S4.E6.m1.1.1.1.1.1.1.1.1" xref="S4.E6.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E6.m1.1.1.1.1.1.1.1.1.2" xref="S4.E6.m1.1.1.1.1.1.1.1.1.2.cmml">A</mi><mn id="S4.E6.m1.1.1.1.1.1.1.1.1.3" xref="S4.E6.m1.1.1.1.1.1.1.1.1.3.cmml">1</mn></msup><mo id="S4.E6.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.E6.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mrow id="S4.E6.m1.1.1.1.1.1.3" xref="S4.E6.m1.1.1.1.1.1.3.cmml"><msub id="S4.E6.m1.1.1.1.1.1.3.2" xref="S4.E6.m1.1.1.1.1.1.3.2.cmml"><mi id="S4.E6.m1.1.1.1.1.1.3.2.2" xref="S4.E6.m1.1.1.1.1.1.3.2.2.cmml">d</mi><mi id="S4.E6.m1.1.1.1.1.1.3.2.3" xref="S4.E6.m1.1.1.1.1.1.3.2.3.cmml">c</mi></msub><mo id="S4.E6.m1.1.1.1.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="S4.E6.m1.1.1.1.1.1.3.1.cmml">×</mo><mi id="S4.E6.m1.1.1.1.1.1.3.3" xref="S4.E6.m1.1.1.1.1.1.3.3.cmml">d</mi></mrow></msub></mtd><mtd id="S4.E6.m1.3.3c" xref="S4.E6.m1.3.3.cmml"><msub id="S4.E6.m1.2.2.2.2.1" xref="S4.E6.m1.2.2.2.2.1.cmml"><mrow id="S4.E6.m1.2.2.2.2.1.1.1" xref="S4.E6.m1.2.2.2.2.1.1.1.1.cmml"><mo id="S4.E6.m1.2.2.2.2.1.1.1.2" stretchy="false" xref="S4.E6.m1.2.2.2.2.1.1.1.1.cmml">(</mo><msup id="S4.E6.m1.2.2.2.2.1.1.1.1" xref="S4.E6.m1.2.2.2.2.1.1.1.1.cmml"><mi id="S4.E6.m1.2.2.2.2.1.1.1.1.2" xref="S4.E6.m1.2.2.2.2.1.1.1.1.2.cmml">A</mi><mn id="S4.E6.m1.2.2.2.2.1.1.1.1.3" xref="S4.E6.m1.2.2.2.2.1.1.1.1.3.cmml">2</mn></msup><mo id="S4.E6.m1.2.2.2.2.1.1.1.3" stretchy="false" xref="S4.E6.m1.2.2.2.2.1.1.1.1.cmml">)</mo></mrow><mrow id="S4.E6.m1.2.2.2.2.1.3" xref="S4.E6.m1.2.2.2.2.1.3.cmml"><msub id="S4.E6.m1.2.2.2.2.1.3.2" xref="S4.E6.m1.2.2.2.2.1.3.2.cmml"><mi id="S4.E6.m1.2.2.2.2.1.3.2.2" xref="S4.E6.m1.2.2.2.2.1.3.2.2.cmml">d</mi><mi id="S4.E6.m1.2.2.2.2.1.3.2.3" xref="S4.E6.m1.2.2.2.2.1.3.2.3.cmml">c</mi></msub><mo id="S4.E6.m1.2.2.2.2.1.3.1" lspace="0.222em" rspace="0.222em" xref="S4.E6.m1.2.2.2.2.1.3.1.cmml">×</mo><mi id="S4.E6.m1.2.2.2.2.1.3.3" xref="S4.E6.m1.2.2.2.2.1.3.3.cmml">d</mi></mrow></msub></mtd><mtd id="S4.E6.m1.3.3d" xref="S4.E6.m1.3.3.cmml"><mi id="S4.E6.m1.3.3.3.4.1" mathvariant="normal" xref="S4.E6.m1.3.3.3.4.1.cmml">⋯</mi></mtd><mtd id="S4.E6.m1.3.3e" xref="S4.E6.m1.3.3.cmml"><msub id="S4.E6.m1.3.3.3.3.1" xref="S4.E6.m1.3.3.3.3.1.cmml"><mrow id="S4.E6.m1.3.3.3.3.1.1.1" xref="S4.E6.m1.3.3.3.3.1.1.1.1.cmml"><mo id="S4.E6.m1.3.3.3.3.1.1.1.2" stretchy="false" xref="S4.E6.m1.3.3.3.3.1.1.1.1.cmml">(</mo><msup id="S4.E6.m1.3.3.3.3.1.1.1.1" xref="S4.E6.m1.3.3.3.3.1.1.1.1.cmml"><mi id="S4.E6.m1.3.3.3.3.1.1.1.1.2" xref="S4.E6.m1.3.3.3.3.1.1.1.1.2.cmml">A</mi><mi id="S4.E6.m1.3.3.3.3.1.1.1.1.3" xref="S4.E6.m1.3.3.3.3.1.1.1.1.3.cmml">h</mi></msup><mo id="S4.E6.m1.3.3.3.3.1.1.1.3" stretchy="false" xref="S4.E6.m1.3.3.3.3.1.1.1.1.cmml">)</mo></mrow><mrow id="S4.E6.m1.3.3.3.3.1.3" xref="S4.E6.m1.3.3.3.3.1.3.cmml"><msub id="S4.E6.m1.3.3.3.3.1.3.2" xref="S4.E6.m1.3.3.3.3.1.3.2.cmml"><mi id="S4.E6.m1.3.3.3.3.1.3.2.2" xref="S4.E6.m1.3.3.3.3.1.3.2.2.cmml">d</mi><mi id="S4.E6.m1.3.3.3.3.1.3.2.3" xref="S4.E6.m1.3.3.3.3.1.3.2.3.cmml">c</mi></msub><mo id="S4.E6.m1.3.3.3.3.1.3.1" lspace="0.222em" rspace="0.222em" xref="S4.E6.m1.3.3.3.3.1.3.1.cmml">×</mo><mi id="S4.E6.m1.3.3.3.3.1.3.3" xref="S4.E6.m1.3.3.3.3.1.3.3.cmml">d</mi></mrow></msub></mtd></mtr></mtable><mo id="S4.E6.m1.4.4.1.1.6.3.2.2" xref="S4.E6.m1.4.4.1.1.6.3.1.1.cmml">]</mo></mrow></mrow></mrow><mo id="S4.E6.m1.4.4.1.2" xref="S4.E6.m1.4.4.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E6.m1.4b"><apply id="S4.E6.m1.4.4.1.1.cmml" xref="S4.E6.m1.4.4.1"><and id="S4.E6.m1.4.4.1.1a.cmml" xref="S4.E6.m1.4.4.1"></and><apply id="S4.E6.m1.4.4.1.1b.cmml" xref="S4.E6.m1.4.4.1"><eq id="S4.E6.m1.4.4.1.1.4.cmml" xref="S4.E6.m1.4.4.1.1.4"></eq><apply id="S4.E6.m1.4.4.1.1.1.cmml" xref="S4.E6.m1.4.4.1.1.1"><times id="S4.E6.m1.4.4.1.1.1.2.cmml" xref="S4.E6.m1.4.4.1.1.1.2"></times><ci id="S4.E6.m1.4.4.1.1.1.3a.cmml" xref="S4.E6.m1.4.4.1.1.1.3"><mtext id="S4.E6.m1.4.4.1.1.1.3.cmml" xref="S4.E6.m1.4.4.1.1.1.3">SVD</mtext></ci><apply id="S4.E6.m1.4.4.1.1.1.1.cmml" xref="S4.E6.m1.4.4.1.1.1.1"><csymbol cd="ambiguous" id="S4.E6.m1.4.4.1.1.1.1.2.cmml" xref="S4.E6.m1.4.4.1.1.1.1">subscript</csymbol><apply id="S4.E6.m1.4.4.1.1.1.1.1.1.1.cmml" xref="S4.E6.m1.4.4.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E6.m1.4.4.1.1.1.1.1.1.1.1.cmml" xref="S4.E6.m1.4.4.1.1.1.1.1.1">subscript</csymbol><apply id="S4.E6.m1.4.4.1.1.1.1.1.1.1.2.cmml" xref="S4.E6.m1.4.4.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E6.m1.4.4.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E6.m1.4.4.1.1.1.1.1.1">superscript</csymbol><ci id="S4.E6.m1.4.4.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E6.m1.4.4.1.1.1.1.1.1.1.2.2">𝑊</ci><ci id="S4.E6.m1.4.4.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E6.m1.4.4.1.1.1.1.1.1.1.2.3">𝐻</ci></apply><ci id="S4.E6.m1.4.4.1.1.1.1.1.1.1.3.cmml" xref="S4.E6.m1.4.4.1.1.1.1.1.1.1.3">𝑘</ci></apply><apply id="S4.E6.m1.4.4.1.1.1.1.3.cmml" xref="S4.E6.m1.4.4.1.1.1.1.3"><times id="S4.E6.m1.4.4.1.1.1.1.3.1.cmml" xref="S4.E6.m1.4.4.1.1.1.1.3.1"></times><apply id="S4.E6.m1.4.4.1.1.1.1.3.2.cmml" xref="S4.E6.m1.4.4.1.1.1.1.3.2"><times id="S4.E6.m1.4.4.1.1.1.1.3.2.1.cmml" xref="S4.E6.m1.4.4.1.1.1.1.3.2.1"></times><ci id="S4.E6.m1.4.4.1.1.1.1.3.2.2.cmml" xref="S4.E6.m1.4.4.1.1.1.1.3.2.2">𝐷</ci><ci id="S4.E6.m1.4.4.1.1.1.1.3.2.3.cmml" xref="S4.E6.m1.4.4.1.1.1.1.3.2.3">ℎ</ci></apply><ci id="S4.E6.m1.4.4.1.1.1.1.3.3.cmml" xref="S4.E6.m1.4.4.1.1.1.1.3.3">𝑑</ci></apply></apply></apply><apply id="S4.E6.m1.4.4.1.1.2.cmml" xref="S4.E6.m1.4.4.1.1.2"><times id="S4.E6.m1.4.4.1.1.2.2.cmml" xref="S4.E6.m1.4.4.1.1.2.2"></times><apply id="S4.E6.m1.4.4.1.1.2.3.cmml" xref="S4.E6.m1.4.4.1.1.2.3"><csymbol cd="ambiguous" id="S4.E6.m1.4.4.1.1.2.3.1.cmml" xref="S4.E6.m1.4.4.1.1.2.3">subscript</csymbol><ci id="S4.E6.m1.4.4.1.1.2.3.2.cmml" xref="S4.E6.m1.4.4.1.1.2.3.2">𝑈</ci><apply id="S4.E6.m1.4.4.1.1.2.3.3.cmml" xref="S4.E6.m1.4.4.1.1.2.3.3"><times id="S4.E6.m1.4.4.1.1.2.3.3.1.cmml" xref="S4.E6.m1.4.4.1.1.2.3.3.1"></times><ci id="S4.E6.m1.4.4.1.1.2.3.3.2.cmml" xref="S4.E6.m1.4.4.1.1.2.3.3.2">𝐷</ci><apply id="S4.E6.m1.4.4.1.1.2.3.3.3.cmml" xref="S4.E6.m1.4.4.1.1.2.3.3.3"><csymbol cd="ambiguous" id="S4.E6.m1.4.4.1.1.2.3.3.3.1.cmml" xref="S4.E6.m1.4.4.1.1.2.3.3.3">subscript</csymbol><ci id="S4.E6.m1.4.4.1.1.2.3.3.3.2.cmml" xref="S4.E6.m1.4.4.1.1.2.3.3.3.2">𝑑</ci><ci id="S4.E6.m1.4.4.1.1.2.3.3.3.3.cmml" xref="S4.E6.m1.4.4.1.1.2.3.3.3.3">𝑐</ci></apply></apply></apply><apply id="S4.E6.m1.4.4.1.1.2.1.cmml" xref="S4.E6.m1.4.4.1.1.2.1"><csymbol cd="ambiguous" id="S4.E6.m1.4.4.1.1.2.1.2.cmml" xref="S4.E6.m1.4.4.1.1.2.1">subscript</csymbol><apply id="S4.E6.m1.4.4.1.1.2.1.1.1.1.cmml" xref="S4.E6.m1.4.4.1.1.2.1.1.1"><times id="S4.E6.m1.4.4.1.1.2.1.1.1.1.1.cmml" xref="S4.E6.m1.4.4.1.1.2.1.1.1.1.1"></times><ci id="S4.E6.m1.4.4.1.1.2.1.1.1.1.2.cmml" xref="S4.E6.m1.4.4.1.1.2.1.1.1.1.2">Σ</ci><apply id="S4.E6.m1.4.4.1.1.2.1.1.1.1.3.cmml" xref="S4.E6.m1.4.4.1.1.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E6.m1.4.4.1.1.2.1.1.1.1.3.1.cmml" xref="S4.E6.m1.4.4.1.1.2.1.1.1.1.3">superscript</csymbol><ci id="S4.E6.m1.4.4.1.1.2.1.1.1.1.3.2.cmml" xref="S4.E6.m1.4.4.1.1.2.1.1.1.1.3.2">𝑉</ci><ci id="S4.E6.m1.4.4.1.1.2.1.1.1.1.3.3.cmml" xref="S4.E6.m1.4.4.1.1.2.1.1.1.1.3.3">𝑇</ci></apply></apply><apply id="S4.E6.m1.4.4.1.1.2.1.3.cmml" xref="S4.E6.m1.4.4.1.1.2.1.3"><times id="S4.E6.m1.4.4.1.1.2.1.3.1.cmml" xref="S4.E6.m1.4.4.1.1.2.1.3.1"></times><apply id="S4.E6.m1.4.4.1.1.2.1.3.2.cmml" xref="S4.E6.m1.4.4.1.1.2.1.3.2"><times id="S4.E6.m1.4.4.1.1.2.1.3.2.1.cmml" xref="S4.E6.m1.4.4.1.1.2.1.3.2.1"></times><apply id="S4.E6.m1.4.4.1.1.2.1.3.2.2.cmml" xref="S4.E6.m1.4.4.1.1.2.1.3.2.2"><csymbol cd="ambiguous" id="S4.E6.m1.4.4.1.1.2.1.3.2.2.1.cmml" xref="S4.E6.m1.4.4.1.1.2.1.3.2.2">subscript</csymbol><ci id="S4.E6.m1.4.4.1.1.2.1.3.2.2.2.cmml" xref="S4.E6.m1.4.4.1.1.2.1.3.2.2.2">𝑑</ci><ci id="S4.E6.m1.4.4.1.1.2.1.3.2.2.3.cmml" xref="S4.E6.m1.4.4.1.1.2.1.3.2.2.3">𝑐</ci></apply><ci id="S4.E6.m1.4.4.1.1.2.1.3.2.3.cmml" xref="S4.E6.m1.4.4.1.1.2.1.3.2.3">ℎ</ci></apply><ci id="S4.E6.m1.4.4.1.1.2.1.3.3.cmml" xref="S4.E6.m1.4.4.1.1.2.1.3.3">𝑑</ci></apply></apply></apply></apply><apply id="S4.E6.m1.4.4.1.1c.cmml" xref="S4.E6.m1.4.4.1"><eq id="S4.E6.m1.4.4.1.1.5.cmml" xref="S4.E6.m1.4.4.1.1.5"></eq><share href="https://arxiv.org/html/2410.03111v1#S4.E6.m1.4.4.1.1.2.cmml" id="S4.E6.m1.4.4.1.1d.cmml" xref="S4.E6.m1.4.4.1"></share><apply id="S4.E6.m1.4.4.1.1.6.cmml" xref="S4.E6.m1.4.4.1.1.6"><times id="S4.E6.m1.4.4.1.1.6.1.cmml" xref="S4.E6.m1.4.4.1.1.6.1"></times><apply id="S4.E6.m1.4.4.1.1.6.2.cmml" xref="S4.E6.m1.4.4.1.1.6.2"><csymbol cd="ambiguous" id="S4.E6.m1.4.4.1.1.6.2.1.cmml" xref="S4.E6.m1.4.4.1.1.6.2">subscript</csymbol><ci id="S4.E6.m1.4.4.1.1.6.2.2.cmml" xref="S4.E6.m1.4.4.1.1.6.2.2">𝑈</ci><apply id="S4.E6.m1.4.4.1.1.6.2.3.cmml" xref="S4.E6.m1.4.4.1.1.6.2.3"><times id="S4.E6.m1.4.4.1.1.6.2.3.1.cmml" xref="S4.E6.m1.4.4.1.1.6.2.3.1"></times><ci id="S4.E6.m1.4.4.1.1.6.2.3.2.cmml" xref="S4.E6.m1.4.4.1.1.6.2.3.2">𝐷</ci><apply id="S4.E6.m1.4.4.1.1.6.2.3.3.cmml" xref="S4.E6.m1.4.4.1.1.6.2.3.3"><csymbol cd="ambiguous" id="S4.E6.m1.4.4.1.1.6.2.3.3.1.cmml" xref="S4.E6.m1.4.4.1.1.6.2.3.3">subscript</csymbol><ci id="S4.E6.m1.4.4.1.1.6.2.3.3.2.cmml" xref="S4.E6.m1.4.4.1.1.6.2.3.3.2">𝑑</ci><ci id="S4.E6.m1.4.4.1.1.6.2.3.3.3.cmml" xref="S4.E6.m1.4.4.1.1.6.2.3.3.3">𝑐</ci></apply></apply></apply><apply id="S4.E6.m1.4.4.1.1.6.3.1.cmml" xref="S4.E6.m1.4.4.1.1.6.3.2"><csymbol cd="latexml" id="S4.E6.m1.4.4.1.1.6.3.1.1.cmml" xref="S4.E6.m1.4.4.1.1.6.3.2.1">delimited-[]</csymbol><matrix id="S4.E6.m1.3.3.cmml" xref="S4.E6.m1.3.3"><matrixrow id="S4.E6.m1.3.3a.cmml" xref="S4.E6.m1.3.3"><apply id="S4.E6.m1.1.1.1.1.1.cmml" xref="S4.E6.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E6.m1.1.1.1.1.1.2.cmml" xref="S4.E6.m1.1.1.1.1.1">subscript</csymbol><apply id="S4.E6.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.E6.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E6.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E6.m1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S4.E6.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E6.m1.1.1.1.1.1.1.1.1.2">𝐴</ci><cn id="S4.E6.m1.1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S4.E6.m1.1.1.1.1.1.1.1.1.3">1</cn></apply><apply id="S4.E6.m1.1.1.1.1.1.3.cmml" xref="S4.E6.m1.1.1.1.1.1.3"><times id="S4.E6.m1.1.1.1.1.1.3.1.cmml" xref="S4.E6.m1.1.1.1.1.1.3.1"></times><apply id="S4.E6.m1.1.1.1.1.1.3.2.cmml" xref="S4.E6.m1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S4.E6.m1.1.1.1.1.1.3.2.1.cmml" xref="S4.E6.m1.1.1.1.1.1.3.2">subscript</csymbol><ci id="S4.E6.m1.1.1.1.1.1.3.2.2.cmml" xref="S4.E6.m1.1.1.1.1.1.3.2.2">𝑑</ci><ci id="S4.E6.m1.1.1.1.1.1.3.2.3.cmml" xref="S4.E6.m1.1.1.1.1.1.3.2.3">𝑐</ci></apply><ci id="S4.E6.m1.1.1.1.1.1.3.3.cmml" xref="S4.E6.m1.1.1.1.1.1.3.3">𝑑</ci></apply></apply><apply id="S4.E6.m1.2.2.2.2.1.cmml" xref="S4.E6.m1.2.2.2.2.1"><csymbol cd="ambiguous" id="S4.E6.m1.2.2.2.2.1.2.cmml" xref="S4.E6.m1.2.2.2.2.1">subscript</csymbol><apply id="S4.E6.m1.2.2.2.2.1.1.1.1.cmml" xref="S4.E6.m1.2.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.E6.m1.2.2.2.2.1.1.1.1.1.cmml" xref="S4.E6.m1.2.2.2.2.1.1.1">superscript</csymbol><ci id="S4.E6.m1.2.2.2.2.1.1.1.1.2.cmml" xref="S4.E6.m1.2.2.2.2.1.1.1.1.2">𝐴</ci><cn id="S4.E6.m1.2.2.2.2.1.1.1.1.3.cmml" type="integer" xref="S4.E6.m1.2.2.2.2.1.1.1.1.3">2</cn></apply><apply id="S4.E6.m1.2.2.2.2.1.3.cmml" xref="S4.E6.m1.2.2.2.2.1.3"><times id="S4.E6.m1.2.2.2.2.1.3.1.cmml" xref="S4.E6.m1.2.2.2.2.1.3.1"></times><apply id="S4.E6.m1.2.2.2.2.1.3.2.cmml" xref="S4.E6.m1.2.2.2.2.1.3.2"><csymbol cd="ambiguous" id="S4.E6.m1.2.2.2.2.1.3.2.1.cmml" xref="S4.E6.m1.2.2.2.2.1.3.2">subscript</csymbol><ci id="S4.E6.m1.2.2.2.2.1.3.2.2.cmml" xref="S4.E6.m1.2.2.2.2.1.3.2.2">𝑑</ci><ci id="S4.E6.m1.2.2.2.2.1.3.2.3.cmml" xref="S4.E6.m1.2.2.2.2.1.3.2.3">𝑐</ci></apply><ci id="S4.E6.m1.2.2.2.2.1.3.3.cmml" xref="S4.E6.m1.2.2.2.2.1.3.3">𝑑</ci></apply></apply><ci id="S4.E6.m1.3.3.3.4.1.cmml" xref="S4.E6.m1.3.3.3.4.1">⋯</ci><apply id="S4.E6.m1.3.3.3.3.1.cmml" xref="S4.E6.m1.3.3.3.3.1"><csymbol cd="ambiguous" id="S4.E6.m1.3.3.3.3.1.2.cmml" xref="S4.E6.m1.3.3.3.3.1">subscript</csymbol><apply id="S4.E6.m1.3.3.3.3.1.1.1.1.cmml" xref="S4.E6.m1.3.3.3.3.1.1.1"><csymbol cd="ambiguous" id="S4.E6.m1.3.3.3.3.1.1.1.1.1.cmml" xref="S4.E6.m1.3.3.3.3.1.1.1">superscript</csymbol><ci id="S4.E6.m1.3.3.3.3.1.1.1.1.2.cmml" xref="S4.E6.m1.3.3.3.3.1.1.1.1.2">𝐴</ci><ci id="S4.E6.m1.3.3.3.3.1.1.1.1.3.cmml" xref="S4.E6.m1.3.3.3.3.1.1.1.1.3">ℎ</ci></apply><apply id="S4.E6.m1.3.3.3.3.1.3.cmml" xref="S4.E6.m1.3.3.3.3.1.3"><times id="S4.E6.m1.3.3.3.3.1.3.1.cmml" xref="S4.E6.m1.3.3.3.3.1.3.1"></times><apply id="S4.E6.m1.3.3.3.3.1.3.2.cmml" xref="S4.E6.m1.3.3.3.3.1.3.2"><csymbol cd="ambiguous" id="S4.E6.m1.3.3.3.3.1.3.2.1.cmml" xref="S4.E6.m1.3.3.3.3.1.3.2">subscript</csymbol><ci id="S4.E6.m1.3.3.3.3.1.3.2.2.cmml" xref="S4.E6.m1.3.3.3.3.1.3.2.2">𝑑</ci><ci id="S4.E6.m1.3.3.3.3.1.3.2.3.cmml" xref="S4.E6.m1.3.3.3.3.1.3.2.3">𝑐</ci></apply><ci id="S4.E6.m1.3.3.3.3.1.3.3.cmml" xref="S4.E6.m1.3.3.3.3.1.3.3">𝑑</ci></apply></apply></matrixrow></matrix></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E6.m1.4c">\text{SVD}(W^{H}_{k})_{D\times hd}=U_{D\times d_{c}}(\Sigma V^{T})_{d_{c}%
\times hd}=U_{D\times d_{c}}\left[\begin{array}[]{cccc}(A^{1})_{d_{c}\times d}%
&amp;(A^{2})_{d_{c}\times d}&amp;\cdots&amp;(A^{h})_{d_{c}\times d}\end{array}\right],</annotation><annotation encoding="application/x-llamapun" id="S4.E6.m1.4d">SVD ( italic_W start_POSTSUPERSCRIPT italic_H end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ) start_POSTSUBSCRIPT italic_D × italic_h italic_d end_POSTSUBSCRIPT = italic_U start_POSTSUBSCRIPT italic_D × italic_d start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( roman_Σ italic_V start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT ) start_POSTSUBSCRIPT italic_d start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT × italic_h italic_d end_POSTSUBSCRIPT = italic_U start_POSTSUBSCRIPT italic_D × italic_d start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT end_POSTSUBSCRIPT [ start_ARRAY start_ROW start_CELL ( italic_A start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT ) start_POSTSUBSCRIPT italic_d start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT × italic_d end_POSTSUBSCRIPT end_CELL start_CELL ( italic_A start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ) start_POSTSUBSCRIPT italic_d start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT × italic_d end_POSTSUBSCRIPT end_CELL start_CELL ⋯ end_CELL start_CELL ( italic_A start_POSTSUPERSCRIPT italic_h end_POSTSUPERSCRIPT ) start_POSTSUBSCRIPT italic_d start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT × italic_d end_POSTSUBSCRIPT end_CELL end_ROW end_ARRAY ] ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS1.p4.3">where <math alttext="(A^{i})_{d_{c}\times d}" class="ltx_Math" display="inline" id="S4.SS1.p4.1.m1.1"><semantics id="S4.SS1.p4.1.m1.1a"><msub id="S4.SS1.p4.1.m1.1.1" xref="S4.SS1.p4.1.m1.1.1.cmml"><mrow id="S4.SS1.p4.1.m1.1.1.1.1" xref="S4.SS1.p4.1.m1.1.1.1.1.1.cmml"><mo id="S4.SS1.p4.1.m1.1.1.1.1.2" stretchy="false" xref="S4.SS1.p4.1.m1.1.1.1.1.1.cmml">(</mo><msup id="S4.SS1.p4.1.m1.1.1.1.1.1" xref="S4.SS1.p4.1.m1.1.1.1.1.1.cmml"><mi id="S4.SS1.p4.1.m1.1.1.1.1.1.2" xref="S4.SS1.p4.1.m1.1.1.1.1.1.2.cmml">A</mi><mi id="S4.SS1.p4.1.m1.1.1.1.1.1.3" xref="S4.SS1.p4.1.m1.1.1.1.1.1.3.cmml">i</mi></msup><mo id="S4.SS1.p4.1.m1.1.1.1.1.3" stretchy="false" xref="S4.SS1.p4.1.m1.1.1.1.1.1.cmml">)</mo></mrow><mrow id="S4.SS1.p4.1.m1.1.1.3" xref="S4.SS1.p4.1.m1.1.1.3.cmml"><msub id="S4.SS1.p4.1.m1.1.1.3.2" xref="S4.SS1.p4.1.m1.1.1.3.2.cmml"><mi id="S4.SS1.p4.1.m1.1.1.3.2.2" xref="S4.SS1.p4.1.m1.1.1.3.2.2.cmml">d</mi><mi id="S4.SS1.p4.1.m1.1.1.3.2.3" xref="S4.SS1.p4.1.m1.1.1.3.2.3.cmml">c</mi></msub><mo id="S4.SS1.p4.1.m1.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="S4.SS1.p4.1.m1.1.1.3.1.cmml">×</mo><mi id="S4.SS1.p4.1.m1.1.1.3.3" xref="S4.SS1.p4.1.m1.1.1.3.3.cmml">d</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.1.m1.1b"><apply id="S4.SS1.p4.1.m1.1.1.cmml" xref="S4.SS1.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p4.1.m1.1.1.2.cmml" xref="S4.SS1.p4.1.m1.1.1">subscript</csymbol><apply id="S4.SS1.p4.1.m1.1.1.1.1.1.cmml" xref="S4.SS1.p4.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p4.1.m1.1.1.1.1.1.1.cmml" xref="S4.SS1.p4.1.m1.1.1.1.1">superscript</csymbol><ci id="S4.SS1.p4.1.m1.1.1.1.1.1.2.cmml" xref="S4.SS1.p4.1.m1.1.1.1.1.1.2">𝐴</ci><ci id="S4.SS1.p4.1.m1.1.1.1.1.1.3.cmml" xref="S4.SS1.p4.1.m1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S4.SS1.p4.1.m1.1.1.3.cmml" xref="S4.SS1.p4.1.m1.1.1.3"><times id="S4.SS1.p4.1.m1.1.1.3.1.cmml" xref="S4.SS1.p4.1.m1.1.1.3.1"></times><apply id="S4.SS1.p4.1.m1.1.1.3.2.cmml" xref="S4.SS1.p4.1.m1.1.1.3.2"><csymbol cd="ambiguous" id="S4.SS1.p4.1.m1.1.1.3.2.1.cmml" xref="S4.SS1.p4.1.m1.1.1.3.2">subscript</csymbol><ci id="S4.SS1.p4.1.m1.1.1.3.2.2.cmml" xref="S4.SS1.p4.1.m1.1.1.3.2.2">𝑑</ci><ci id="S4.SS1.p4.1.m1.1.1.3.2.3.cmml" xref="S4.SS1.p4.1.m1.1.1.3.2.3">𝑐</ci></apply><ci id="S4.SS1.p4.1.m1.1.1.3.3.cmml" xref="S4.SS1.p4.1.m1.1.1.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.1.m1.1c">(A^{i})_{d_{c}\times d}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p4.1.m1.1d">( italic_A start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT ) start_POSTSUBSCRIPT italic_d start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT × italic_d end_POSTSUBSCRIPT</annotation></semantics></math> is the <math alttext="i" class="ltx_Math" display="inline" id="S4.SS1.p4.2.m2.1"><semantics id="S4.SS1.p4.2.m2.1a"><mi id="S4.SS1.p4.2.m2.1.1" xref="S4.SS1.p4.2.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.2.m2.1b"><ci id="S4.SS1.p4.2.m2.1.1.cmml" xref="S4.SS1.p4.2.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.2.m2.1c">i</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p4.2.m2.1d">italic_i</annotation></semantics></math>-th block in the matrix <math alttext="(\Sigma V^{T})_{d_{c}\times hd}" class="ltx_Math" display="inline" id="S4.SS1.p4.3.m3.1"><semantics id="S4.SS1.p4.3.m3.1a"><msub id="S4.SS1.p4.3.m3.1.1" xref="S4.SS1.p4.3.m3.1.1.cmml"><mrow id="S4.SS1.p4.3.m3.1.1.1.1" xref="S4.SS1.p4.3.m3.1.1.1.1.1.cmml"><mo id="S4.SS1.p4.3.m3.1.1.1.1.2" stretchy="false" xref="S4.SS1.p4.3.m3.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS1.p4.3.m3.1.1.1.1.1" xref="S4.SS1.p4.3.m3.1.1.1.1.1.cmml"><mi id="S4.SS1.p4.3.m3.1.1.1.1.1.2" mathvariant="normal" xref="S4.SS1.p4.3.m3.1.1.1.1.1.2.cmml">Σ</mi><mo id="S4.SS1.p4.3.m3.1.1.1.1.1.1" xref="S4.SS1.p4.3.m3.1.1.1.1.1.1.cmml">⁢</mo><msup id="S4.SS1.p4.3.m3.1.1.1.1.1.3" xref="S4.SS1.p4.3.m3.1.1.1.1.1.3.cmml"><mi id="S4.SS1.p4.3.m3.1.1.1.1.1.3.2" xref="S4.SS1.p4.3.m3.1.1.1.1.1.3.2.cmml">V</mi><mi id="S4.SS1.p4.3.m3.1.1.1.1.1.3.3" xref="S4.SS1.p4.3.m3.1.1.1.1.1.3.3.cmml">T</mi></msup></mrow><mo id="S4.SS1.p4.3.m3.1.1.1.1.3" stretchy="false" xref="S4.SS1.p4.3.m3.1.1.1.1.1.cmml">)</mo></mrow><mrow id="S4.SS1.p4.3.m3.1.1.3" xref="S4.SS1.p4.3.m3.1.1.3.cmml"><mrow id="S4.SS1.p4.3.m3.1.1.3.2" xref="S4.SS1.p4.3.m3.1.1.3.2.cmml"><msub id="S4.SS1.p4.3.m3.1.1.3.2.2" xref="S4.SS1.p4.3.m3.1.1.3.2.2.cmml"><mi id="S4.SS1.p4.3.m3.1.1.3.2.2.2" xref="S4.SS1.p4.3.m3.1.1.3.2.2.2.cmml">d</mi><mi id="S4.SS1.p4.3.m3.1.1.3.2.2.3" xref="S4.SS1.p4.3.m3.1.1.3.2.2.3.cmml">c</mi></msub><mo id="S4.SS1.p4.3.m3.1.1.3.2.1" lspace="0.222em" rspace="0.222em" xref="S4.SS1.p4.3.m3.1.1.3.2.1.cmml">×</mo><mi id="S4.SS1.p4.3.m3.1.1.3.2.3" xref="S4.SS1.p4.3.m3.1.1.3.2.3.cmml">h</mi></mrow><mo id="S4.SS1.p4.3.m3.1.1.3.1" xref="S4.SS1.p4.3.m3.1.1.3.1.cmml">⁢</mo><mi id="S4.SS1.p4.3.m3.1.1.3.3" xref="S4.SS1.p4.3.m3.1.1.3.3.cmml">d</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.3.m3.1b"><apply id="S4.SS1.p4.3.m3.1.1.cmml" xref="S4.SS1.p4.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS1.p4.3.m3.1.1.2.cmml" xref="S4.SS1.p4.3.m3.1.1">subscript</csymbol><apply id="S4.SS1.p4.3.m3.1.1.1.1.1.cmml" xref="S4.SS1.p4.3.m3.1.1.1.1"><times id="S4.SS1.p4.3.m3.1.1.1.1.1.1.cmml" xref="S4.SS1.p4.3.m3.1.1.1.1.1.1"></times><ci id="S4.SS1.p4.3.m3.1.1.1.1.1.2.cmml" xref="S4.SS1.p4.3.m3.1.1.1.1.1.2">Σ</ci><apply id="S4.SS1.p4.3.m3.1.1.1.1.1.3.cmml" xref="S4.SS1.p4.3.m3.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p4.3.m3.1.1.1.1.1.3.1.cmml" xref="S4.SS1.p4.3.m3.1.1.1.1.1.3">superscript</csymbol><ci id="S4.SS1.p4.3.m3.1.1.1.1.1.3.2.cmml" xref="S4.SS1.p4.3.m3.1.1.1.1.1.3.2">𝑉</ci><ci id="S4.SS1.p4.3.m3.1.1.1.1.1.3.3.cmml" xref="S4.SS1.p4.3.m3.1.1.1.1.1.3.3">𝑇</ci></apply></apply><apply id="S4.SS1.p4.3.m3.1.1.3.cmml" xref="S4.SS1.p4.3.m3.1.1.3"><times id="S4.SS1.p4.3.m3.1.1.3.1.cmml" xref="S4.SS1.p4.3.m3.1.1.3.1"></times><apply id="S4.SS1.p4.3.m3.1.1.3.2.cmml" xref="S4.SS1.p4.3.m3.1.1.3.2"><times id="S4.SS1.p4.3.m3.1.1.3.2.1.cmml" xref="S4.SS1.p4.3.m3.1.1.3.2.1"></times><apply id="S4.SS1.p4.3.m3.1.1.3.2.2.cmml" xref="S4.SS1.p4.3.m3.1.1.3.2.2"><csymbol cd="ambiguous" id="S4.SS1.p4.3.m3.1.1.3.2.2.1.cmml" xref="S4.SS1.p4.3.m3.1.1.3.2.2">subscript</csymbol><ci id="S4.SS1.p4.3.m3.1.1.3.2.2.2.cmml" xref="S4.SS1.p4.3.m3.1.1.3.2.2.2">𝑑</ci><ci id="S4.SS1.p4.3.m3.1.1.3.2.2.3.cmml" xref="S4.SS1.p4.3.m3.1.1.3.2.2.3">𝑐</ci></apply><ci id="S4.SS1.p4.3.m3.1.1.3.2.3.cmml" xref="S4.SS1.p4.3.m3.1.1.3.2.3">ℎ</ci></apply><ci id="S4.SS1.p4.3.m3.1.1.3.3.cmml" xref="S4.SS1.p4.3.m3.1.1.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.3.m3.1c">(\Sigma V^{T})_{d_{c}\times hd}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p4.3.m3.1d">( roman_Σ italic_V start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT ) start_POSTSUBSCRIPT italic_d start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT × italic_h italic_d end_POSTSUBSCRIPT</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S4.SS1.p5">
<p class="ltx_p" id="S4.SS1.p5.9">We have now decomposed the key matrix <math alttext="W^{i}_{k}" class="ltx_Math" display="inline" id="S4.SS1.p5.1.m1.1"><semantics id="S4.SS1.p5.1.m1.1a"><msubsup id="S4.SS1.p5.1.m1.1.1" xref="S4.SS1.p5.1.m1.1.1.cmml"><mi id="S4.SS1.p5.1.m1.1.1.2.2" xref="S4.SS1.p5.1.m1.1.1.2.2.cmml">W</mi><mi id="S4.SS1.p5.1.m1.1.1.3" xref="S4.SS1.p5.1.m1.1.1.3.cmml">k</mi><mi id="S4.SS1.p5.1.m1.1.1.2.3" xref="S4.SS1.p5.1.m1.1.1.2.3.cmml">i</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS1.p5.1.m1.1b"><apply id="S4.SS1.p5.1.m1.1.1.cmml" xref="S4.SS1.p5.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p5.1.m1.1.1.1.cmml" xref="S4.SS1.p5.1.m1.1.1">subscript</csymbol><apply id="S4.SS1.p5.1.m1.1.1.2.cmml" xref="S4.SS1.p5.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p5.1.m1.1.1.2.1.cmml" xref="S4.SS1.p5.1.m1.1.1">superscript</csymbol><ci id="S4.SS1.p5.1.m1.1.1.2.2.cmml" xref="S4.SS1.p5.1.m1.1.1.2.2">𝑊</ci><ci id="S4.SS1.p5.1.m1.1.1.2.3.cmml" xref="S4.SS1.p5.1.m1.1.1.2.3">𝑖</ci></apply><ci id="S4.SS1.p5.1.m1.1.1.3.cmml" xref="S4.SS1.p5.1.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p5.1.m1.1c">W^{i}_{k}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p5.1.m1.1d">italic_W start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> to the multiplication of <math alttext="U_{D\times d_{c}}" class="ltx_Math" display="inline" id="S4.SS1.p5.2.m2.1"><semantics id="S4.SS1.p5.2.m2.1a"><msub id="S4.SS1.p5.2.m2.1.1" xref="S4.SS1.p5.2.m2.1.1.cmml"><mi id="S4.SS1.p5.2.m2.1.1.2" xref="S4.SS1.p5.2.m2.1.1.2.cmml">U</mi><mrow id="S4.SS1.p5.2.m2.1.1.3" xref="S4.SS1.p5.2.m2.1.1.3.cmml"><mi id="S4.SS1.p5.2.m2.1.1.3.2" xref="S4.SS1.p5.2.m2.1.1.3.2.cmml">D</mi><mo id="S4.SS1.p5.2.m2.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="S4.SS1.p5.2.m2.1.1.3.1.cmml">×</mo><msub id="S4.SS1.p5.2.m2.1.1.3.3" xref="S4.SS1.p5.2.m2.1.1.3.3.cmml"><mi id="S4.SS1.p5.2.m2.1.1.3.3.2" xref="S4.SS1.p5.2.m2.1.1.3.3.2.cmml">d</mi><mi id="S4.SS1.p5.2.m2.1.1.3.3.3" xref="S4.SS1.p5.2.m2.1.1.3.3.3.cmml">c</mi></msub></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p5.2.m2.1b"><apply id="S4.SS1.p5.2.m2.1.1.cmml" xref="S4.SS1.p5.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS1.p5.2.m2.1.1.1.cmml" xref="S4.SS1.p5.2.m2.1.1">subscript</csymbol><ci id="S4.SS1.p5.2.m2.1.1.2.cmml" xref="S4.SS1.p5.2.m2.1.1.2">𝑈</ci><apply id="S4.SS1.p5.2.m2.1.1.3.cmml" xref="S4.SS1.p5.2.m2.1.1.3"><times id="S4.SS1.p5.2.m2.1.1.3.1.cmml" xref="S4.SS1.p5.2.m2.1.1.3.1"></times><ci id="S4.SS1.p5.2.m2.1.1.3.2.cmml" xref="S4.SS1.p5.2.m2.1.1.3.2">𝐷</ci><apply id="S4.SS1.p5.2.m2.1.1.3.3.cmml" xref="S4.SS1.p5.2.m2.1.1.3.3"><csymbol cd="ambiguous" id="S4.SS1.p5.2.m2.1.1.3.3.1.cmml" xref="S4.SS1.p5.2.m2.1.1.3.3">subscript</csymbol><ci id="S4.SS1.p5.2.m2.1.1.3.3.2.cmml" xref="S4.SS1.p5.2.m2.1.1.3.3.2">𝑑</ci><ci id="S4.SS1.p5.2.m2.1.1.3.3.3.cmml" xref="S4.SS1.p5.2.m2.1.1.3.3.3">𝑐</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p5.2.m2.1c">U_{D\times d_{c}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p5.2.m2.1d">italic_U start_POSTSUBSCRIPT italic_D × italic_d start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="(\Sigma V^{T})_{d_{c}\times hd}" class="ltx_Math" display="inline" id="S4.SS1.p5.3.m3.1"><semantics id="S4.SS1.p5.3.m3.1a"><msub id="S4.SS1.p5.3.m3.1.1" xref="S4.SS1.p5.3.m3.1.1.cmml"><mrow id="S4.SS1.p5.3.m3.1.1.1.1" xref="S4.SS1.p5.3.m3.1.1.1.1.1.cmml"><mo id="S4.SS1.p5.3.m3.1.1.1.1.2" stretchy="false" xref="S4.SS1.p5.3.m3.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS1.p5.3.m3.1.1.1.1.1" xref="S4.SS1.p5.3.m3.1.1.1.1.1.cmml"><mi id="S4.SS1.p5.3.m3.1.1.1.1.1.2" mathvariant="normal" xref="S4.SS1.p5.3.m3.1.1.1.1.1.2.cmml">Σ</mi><mo id="S4.SS1.p5.3.m3.1.1.1.1.1.1" xref="S4.SS1.p5.3.m3.1.1.1.1.1.1.cmml">⁢</mo><msup id="S4.SS1.p5.3.m3.1.1.1.1.1.3" xref="S4.SS1.p5.3.m3.1.1.1.1.1.3.cmml"><mi id="S4.SS1.p5.3.m3.1.1.1.1.1.3.2" xref="S4.SS1.p5.3.m3.1.1.1.1.1.3.2.cmml">V</mi><mi id="S4.SS1.p5.3.m3.1.1.1.1.1.3.3" xref="S4.SS1.p5.3.m3.1.1.1.1.1.3.3.cmml">T</mi></msup></mrow><mo id="S4.SS1.p5.3.m3.1.1.1.1.3" stretchy="false" xref="S4.SS1.p5.3.m3.1.1.1.1.1.cmml">)</mo></mrow><mrow id="S4.SS1.p5.3.m3.1.1.3" xref="S4.SS1.p5.3.m3.1.1.3.cmml"><mrow id="S4.SS1.p5.3.m3.1.1.3.2" xref="S4.SS1.p5.3.m3.1.1.3.2.cmml"><msub id="S4.SS1.p5.3.m3.1.1.3.2.2" xref="S4.SS1.p5.3.m3.1.1.3.2.2.cmml"><mi id="S4.SS1.p5.3.m3.1.1.3.2.2.2" xref="S4.SS1.p5.3.m3.1.1.3.2.2.2.cmml">d</mi><mi id="S4.SS1.p5.3.m3.1.1.3.2.2.3" xref="S4.SS1.p5.3.m3.1.1.3.2.2.3.cmml">c</mi></msub><mo id="S4.SS1.p5.3.m3.1.1.3.2.1" lspace="0.222em" rspace="0.222em" xref="S4.SS1.p5.3.m3.1.1.3.2.1.cmml">×</mo><mi id="S4.SS1.p5.3.m3.1.1.3.2.3" xref="S4.SS1.p5.3.m3.1.1.3.2.3.cmml">h</mi></mrow><mo id="S4.SS1.p5.3.m3.1.1.3.1" xref="S4.SS1.p5.3.m3.1.1.3.1.cmml">⁢</mo><mi id="S4.SS1.p5.3.m3.1.1.3.3" xref="S4.SS1.p5.3.m3.1.1.3.3.cmml">d</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p5.3.m3.1b"><apply id="S4.SS1.p5.3.m3.1.1.cmml" xref="S4.SS1.p5.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS1.p5.3.m3.1.1.2.cmml" xref="S4.SS1.p5.3.m3.1.1">subscript</csymbol><apply id="S4.SS1.p5.3.m3.1.1.1.1.1.cmml" xref="S4.SS1.p5.3.m3.1.1.1.1"><times id="S4.SS1.p5.3.m3.1.1.1.1.1.1.cmml" xref="S4.SS1.p5.3.m3.1.1.1.1.1.1"></times><ci id="S4.SS1.p5.3.m3.1.1.1.1.1.2.cmml" xref="S4.SS1.p5.3.m3.1.1.1.1.1.2">Σ</ci><apply id="S4.SS1.p5.3.m3.1.1.1.1.1.3.cmml" xref="S4.SS1.p5.3.m3.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p5.3.m3.1.1.1.1.1.3.1.cmml" xref="S4.SS1.p5.3.m3.1.1.1.1.1.3">superscript</csymbol><ci id="S4.SS1.p5.3.m3.1.1.1.1.1.3.2.cmml" xref="S4.SS1.p5.3.m3.1.1.1.1.1.3.2">𝑉</ci><ci id="S4.SS1.p5.3.m3.1.1.1.1.1.3.3.cmml" xref="S4.SS1.p5.3.m3.1.1.1.1.1.3.3">𝑇</ci></apply></apply><apply id="S4.SS1.p5.3.m3.1.1.3.cmml" xref="S4.SS1.p5.3.m3.1.1.3"><times id="S4.SS1.p5.3.m3.1.1.3.1.cmml" xref="S4.SS1.p5.3.m3.1.1.3.1"></times><apply id="S4.SS1.p5.3.m3.1.1.3.2.cmml" xref="S4.SS1.p5.3.m3.1.1.3.2"><times id="S4.SS1.p5.3.m3.1.1.3.2.1.cmml" xref="S4.SS1.p5.3.m3.1.1.3.2.1"></times><apply id="S4.SS1.p5.3.m3.1.1.3.2.2.cmml" xref="S4.SS1.p5.3.m3.1.1.3.2.2"><csymbol cd="ambiguous" id="S4.SS1.p5.3.m3.1.1.3.2.2.1.cmml" xref="S4.SS1.p5.3.m3.1.1.3.2.2">subscript</csymbol><ci id="S4.SS1.p5.3.m3.1.1.3.2.2.2.cmml" xref="S4.SS1.p5.3.m3.1.1.3.2.2.2">𝑑</ci><ci id="S4.SS1.p5.3.m3.1.1.3.2.2.3.cmml" xref="S4.SS1.p5.3.m3.1.1.3.2.2.3">𝑐</ci></apply><ci id="S4.SS1.p5.3.m3.1.1.3.2.3.cmml" xref="S4.SS1.p5.3.m3.1.1.3.2.3">ℎ</ci></apply><ci id="S4.SS1.p5.3.m3.1.1.3.3.cmml" xref="S4.SS1.p5.3.m3.1.1.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p5.3.m3.1c">(\Sigma V^{T})_{d_{c}\times hd}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p5.3.m3.1d">( roman_Σ italic_V start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT ) start_POSTSUBSCRIPT italic_d start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT × italic_h italic_d end_POSTSUBSCRIPT</annotation></semantics></math>. We will multiply <math alttext="X" class="ltx_Math" display="inline" id="S4.SS1.p5.4.m4.1"><semantics id="S4.SS1.p5.4.m4.1a"><mi id="S4.SS1.p5.4.m4.1.1" xref="S4.SS1.p5.4.m4.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p5.4.m4.1b"><ci id="S4.SS1.p5.4.m4.1.1.cmml" xref="S4.SS1.p5.4.m4.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p5.4.m4.1c">X</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p5.4.m4.1d">italic_X</annotation></semantics></math> with <math alttext="(\Sigma V^{T})^{T}_{hd\times d_{c}}" class="ltx_Math" display="inline" id="S4.SS1.p5.5.m5.1"><semantics id="S4.SS1.p5.5.m5.1a"><msubsup id="S4.SS1.p5.5.m5.1.1" xref="S4.SS1.p5.5.m5.1.1.cmml"><mrow id="S4.SS1.p5.5.m5.1.1.1.1.1" xref="S4.SS1.p5.5.m5.1.1.1.1.1.1.cmml"><mo id="S4.SS1.p5.5.m5.1.1.1.1.1.2" stretchy="false" xref="S4.SS1.p5.5.m5.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS1.p5.5.m5.1.1.1.1.1.1" xref="S4.SS1.p5.5.m5.1.1.1.1.1.1.cmml"><mi id="S4.SS1.p5.5.m5.1.1.1.1.1.1.2" mathvariant="normal" xref="S4.SS1.p5.5.m5.1.1.1.1.1.1.2.cmml">Σ</mi><mo id="S4.SS1.p5.5.m5.1.1.1.1.1.1.1" xref="S4.SS1.p5.5.m5.1.1.1.1.1.1.1.cmml">⁢</mo><msup id="S4.SS1.p5.5.m5.1.1.1.1.1.1.3" xref="S4.SS1.p5.5.m5.1.1.1.1.1.1.3.cmml"><mi id="S4.SS1.p5.5.m5.1.1.1.1.1.1.3.2" xref="S4.SS1.p5.5.m5.1.1.1.1.1.1.3.2.cmml">V</mi><mi id="S4.SS1.p5.5.m5.1.1.1.1.1.1.3.3" xref="S4.SS1.p5.5.m5.1.1.1.1.1.1.3.3.cmml">T</mi></msup></mrow><mo id="S4.SS1.p5.5.m5.1.1.1.1.1.3" stretchy="false" xref="S4.SS1.p5.5.m5.1.1.1.1.1.1.cmml">)</mo></mrow><mrow id="S4.SS1.p5.5.m5.1.1.3" xref="S4.SS1.p5.5.m5.1.1.3.cmml"><mrow id="S4.SS1.p5.5.m5.1.1.3.2" xref="S4.SS1.p5.5.m5.1.1.3.2.cmml"><mi id="S4.SS1.p5.5.m5.1.1.3.2.2" xref="S4.SS1.p5.5.m5.1.1.3.2.2.cmml">h</mi><mo id="S4.SS1.p5.5.m5.1.1.3.2.1" xref="S4.SS1.p5.5.m5.1.1.3.2.1.cmml">⁢</mo><mi id="S4.SS1.p5.5.m5.1.1.3.2.3" xref="S4.SS1.p5.5.m5.1.1.3.2.3.cmml">d</mi></mrow><mo id="S4.SS1.p5.5.m5.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="S4.SS1.p5.5.m5.1.1.3.1.cmml">×</mo><msub id="S4.SS1.p5.5.m5.1.1.3.3" xref="S4.SS1.p5.5.m5.1.1.3.3.cmml"><mi id="S4.SS1.p5.5.m5.1.1.3.3.2" xref="S4.SS1.p5.5.m5.1.1.3.3.2.cmml">d</mi><mi id="S4.SS1.p5.5.m5.1.1.3.3.3" xref="S4.SS1.p5.5.m5.1.1.3.3.3.cmml">c</mi></msub></mrow><mi id="S4.SS1.p5.5.m5.1.1.1.3" xref="S4.SS1.p5.5.m5.1.1.1.3.cmml">T</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS1.p5.5.m5.1b"><apply id="S4.SS1.p5.5.m5.1.1.cmml" xref="S4.SS1.p5.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS1.p5.5.m5.1.1.2.cmml" xref="S4.SS1.p5.5.m5.1.1">subscript</csymbol><apply id="S4.SS1.p5.5.m5.1.1.1.cmml" xref="S4.SS1.p5.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS1.p5.5.m5.1.1.1.2.cmml" xref="S4.SS1.p5.5.m5.1.1">superscript</csymbol><apply id="S4.SS1.p5.5.m5.1.1.1.1.1.1.cmml" xref="S4.SS1.p5.5.m5.1.1.1.1.1"><times id="S4.SS1.p5.5.m5.1.1.1.1.1.1.1.cmml" xref="S4.SS1.p5.5.m5.1.1.1.1.1.1.1"></times><ci id="S4.SS1.p5.5.m5.1.1.1.1.1.1.2.cmml" xref="S4.SS1.p5.5.m5.1.1.1.1.1.1.2">Σ</ci><apply id="S4.SS1.p5.5.m5.1.1.1.1.1.1.3.cmml" xref="S4.SS1.p5.5.m5.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p5.5.m5.1.1.1.1.1.1.3.1.cmml" xref="S4.SS1.p5.5.m5.1.1.1.1.1.1.3">superscript</csymbol><ci id="S4.SS1.p5.5.m5.1.1.1.1.1.1.3.2.cmml" xref="S4.SS1.p5.5.m5.1.1.1.1.1.1.3.2">𝑉</ci><ci id="S4.SS1.p5.5.m5.1.1.1.1.1.1.3.3.cmml" xref="S4.SS1.p5.5.m5.1.1.1.1.1.1.3.3">𝑇</ci></apply></apply><ci id="S4.SS1.p5.5.m5.1.1.1.3.cmml" xref="S4.SS1.p5.5.m5.1.1.1.3">𝑇</ci></apply><apply id="S4.SS1.p5.5.m5.1.1.3.cmml" xref="S4.SS1.p5.5.m5.1.1.3"><times id="S4.SS1.p5.5.m5.1.1.3.1.cmml" xref="S4.SS1.p5.5.m5.1.1.3.1"></times><apply id="S4.SS1.p5.5.m5.1.1.3.2.cmml" xref="S4.SS1.p5.5.m5.1.1.3.2"><times id="S4.SS1.p5.5.m5.1.1.3.2.1.cmml" xref="S4.SS1.p5.5.m5.1.1.3.2.1"></times><ci id="S4.SS1.p5.5.m5.1.1.3.2.2.cmml" xref="S4.SS1.p5.5.m5.1.1.3.2.2">ℎ</ci><ci id="S4.SS1.p5.5.m5.1.1.3.2.3.cmml" xref="S4.SS1.p5.5.m5.1.1.3.2.3">𝑑</ci></apply><apply id="S4.SS1.p5.5.m5.1.1.3.3.cmml" xref="S4.SS1.p5.5.m5.1.1.3.3"><csymbol cd="ambiguous" id="S4.SS1.p5.5.m5.1.1.3.3.1.cmml" xref="S4.SS1.p5.5.m5.1.1.3.3">subscript</csymbol><ci id="S4.SS1.p5.5.m5.1.1.3.3.2.cmml" xref="S4.SS1.p5.5.m5.1.1.3.3.2">𝑑</ci><ci id="S4.SS1.p5.5.m5.1.1.3.3.3.cmml" xref="S4.SS1.p5.5.m5.1.1.3.3.3">𝑐</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p5.5.m5.1c">(\Sigma V^{T})^{T}_{hd\times d_{c}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p5.5.m5.1d">( roman_Σ italic_V start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_h italic_d × italic_d start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math> as the compressed key, which is stored in the KV cache. Through this implementation, we effectively update the size of key cache from <math alttext="hd" class="ltx_Math" display="inline" id="S4.SS1.p5.6.m6.1"><semantics id="S4.SS1.p5.6.m6.1a"><mrow id="S4.SS1.p5.6.m6.1.1" xref="S4.SS1.p5.6.m6.1.1.cmml"><mi id="S4.SS1.p5.6.m6.1.1.2" xref="S4.SS1.p5.6.m6.1.1.2.cmml">h</mi><mo id="S4.SS1.p5.6.m6.1.1.1" xref="S4.SS1.p5.6.m6.1.1.1.cmml">⁢</mo><mi id="S4.SS1.p5.6.m6.1.1.3" xref="S4.SS1.p5.6.m6.1.1.3.cmml">d</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p5.6.m6.1b"><apply id="S4.SS1.p5.6.m6.1.1.cmml" xref="S4.SS1.p5.6.m6.1.1"><times id="S4.SS1.p5.6.m6.1.1.1.cmml" xref="S4.SS1.p5.6.m6.1.1.1"></times><ci id="S4.SS1.p5.6.m6.1.1.2.cmml" xref="S4.SS1.p5.6.m6.1.1.2">ℎ</ci><ci id="S4.SS1.p5.6.m6.1.1.3.cmml" xref="S4.SS1.p5.6.m6.1.1.3">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p5.6.m6.1c">hd</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p5.6.m6.1d">italic_h italic_d</annotation></semantics></math> to <math alttext="d_{c}" class="ltx_Math" display="inline" id="S4.SS1.p5.7.m7.1"><semantics id="S4.SS1.p5.7.m7.1a"><msub id="S4.SS1.p5.7.m7.1.1" xref="S4.SS1.p5.7.m7.1.1.cmml"><mi id="S4.SS1.p5.7.m7.1.1.2" xref="S4.SS1.p5.7.m7.1.1.2.cmml">d</mi><mi id="S4.SS1.p5.7.m7.1.1.3" xref="S4.SS1.p5.7.m7.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p5.7.m7.1b"><apply id="S4.SS1.p5.7.m7.1.1.cmml" xref="S4.SS1.p5.7.m7.1.1"><csymbol cd="ambiguous" id="S4.SS1.p5.7.m7.1.1.1.cmml" xref="S4.SS1.p5.7.m7.1.1">subscript</csymbol><ci id="S4.SS1.p5.7.m7.1.1.2.cmml" xref="S4.SS1.p5.7.m7.1.1.2">𝑑</ci><ci id="S4.SS1.p5.7.m7.1.1.3.cmml" xref="S4.SS1.p5.7.m7.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p5.7.m7.1c">d_{c}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p5.7.m7.1d">italic_d start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT</annotation></semantics></math>, where <math alttext="d_{c}" class="ltx_Math" display="inline" id="S4.SS1.p5.8.m8.1"><semantics id="S4.SS1.p5.8.m8.1a"><msub id="S4.SS1.p5.8.m8.1.1" xref="S4.SS1.p5.8.m8.1.1.cmml"><mi id="S4.SS1.p5.8.m8.1.1.2" xref="S4.SS1.p5.8.m8.1.1.2.cmml">d</mi><mi id="S4.SS1.p5.8.m8.1.1.3" xref="S4.SS1.p5.8.m8.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p5.8.m8.1b"><apply id="S4.SS1.p5.8.m8.1.1.cmml" xref="S4.SS1.p5.8.m8.1.1"><csymbol cd="ambiguous" id="S4.SS1.p5.8.m8.1.1.1.cmml" xref="S4.SS1.p5.8.m8.1.1">subscript</csymbol><ci id="S4.SS1.p5.8.m8.1.1.2.cmml" xref="S4.SS1.p5.8.m8.1.1.2">𝑑</ci><ci id="S4.SS1.p5.8.m8.1.1.3.cmml" xref="S4.SS1.p5.8.m8.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p5.8.m8.1c">d_{c}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p5.8.m8.1d">italic_d start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT</annotation></semantics></math> is smaller than <math alttext="hd" class="ltx_Math" display="inline" id="S4.SS1.p5.9.m9.1"><semantics id="S4.SS1.p5.9.m9.1a"><mrow id="S4.SS1.p5.9.m9.1.1" xref="S4.SS1.p5.9.m9.1.1.cmml"><mi id="S4.SS1.p5.9.m9.1.1.2" xref="S4.SS1.p5.9.m9.1.1.2.cmml">h</mi><mo id="S4.SS1.p5.9.m9.1.1.1" xref="S4.SS1.p5.9.m9.1.1.1.cmml">⁢</mo><mi id="S4.SS1.p5.9.m9.1.1.3" xref="S4.SS1.p5.9.m9.1.1.3.cmml">d</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p5.9.m9.1b"><apply id="S4.SS1.p5.9.m9.1.1.cmml" xref="S4.SS1.p5.9.m9.1.1"><times id="S4.SS1.p5.9.m9.1.1.1.cmml" xref="S4.SS1.p5.9.m9.1.1.1"></times><ci id="S4.SS1.p5.9.m9.1.1.2.cmml" xref="S4.SS1.p5.9.m9.1.1.2">ℎ</ci><ci id="S4.SS1.p5.9.m9.1.1.3.cmml" xref="S4.SS1.p5.9.m9.1.1.3">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p5.9.m9.1c">hd</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p5.9.m9.1d">italic_h italic_d</annotation></semantics></math>, reducing the memory footprint while keeping the essential information intact.</p>
</div>
<div class="ltx_para" id="S4.SS1.p6">
<p class="ltx_p" id="S4.SS1.p6.2">For <math alttext="U_{D\times d_{c}}" class="ltx_Math" display="inline" id="S4.SS1.p6.1.m1.1"><semantics id="S4.SS1.p6.1.m1.1a"><msub id="S4.SS1.p6.1.m1.1.1" xref="S4.SS1.p6.1.m1.1.1.cmml"><mi id="S4.SS1.p6.1.m1.1.1.2" xref="S4.SS1.p6.1.m1.1.1.2.cmml">U</mi><mrow id="S4.SS1.p6.1.m1.1.1.3" xref="S4.SS1.p6.1.m1.1.1.3.cmml"><mi id="S4.SS1.p6.1.m1.1.1.3.2" xref="S4.SS1.p6.1.m1.1.1.3.2.cmml">D</mi><mo id="S4.SS1.p6.1.m1.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="S4.SS1.p6.1.m1.1.1.3.1.cmml">×</mo><msub id="S4.SS1.p6.1.m1.1.1.3.3" xref="S4.SS1.p6.1.m1.1.1.3.3.cmml"><mi id="S4.SS1.p6.1.m1.1.1.3.3.2" xref="S4.SS1.p6.1.m1.1.1.3.3.2.cmml">d</mi><mi id="S4.SS1.p6.1.m1.1.1.3.3.3" xref="S4.SS1.p6.1.m1.1.1.3.3.3.cmml">c</mi></msub></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p6.1.m1.1b"><apply id="S4.SS1.p6.1.m1.1.1.cmml" xref="S4.SS1.p6.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p6.1.m1.1.1.1.cmml" xref="S4.SS1.p6.1.m1.1.1">subscript</csymbol><ci id="S4.SS1.p6.1.m1.1.1.2.cmml" xref="S4.SS1.p6.1.m1.1.1.2">𝑈</ci><apply id="S4.SS1.p6.1.m1.1.1.3.cmml" xref="S4.SS1.p6.1.m1.1.1.3"><times id="S4.SS1.p6.1.m1.1.1.3.1.cmml" xref="S4.SS1.p6.1.m1.1.1.3.1"></times><ci id="S4.SS1.p6.1.m1.1.1.3.2.cmml" xref="S4.SS1.p6.1.m1.1.1.3.2">𝐷</ci><apply id="S4.SS1.p6.1.m1.1.1.3.3.cmml" xref="S4.SS1.p6.1.m1.1.1.3.3"><csymbol cd="ambiguous" id="S4.SS1.p6.1.m1.1.1.3.3.1.cmml" xref="S4.SS1.p6.1.m1.1.1.3.3">subscript</csymbol><ci id="S4.SS1.p6.1.m1.1.1.3.3.2.cmml" xref="S4.SS1.p6.1.m1.1.1.3.3.2">𝑑</ci><ci id="S4.SS1.p6.1.m1.1.1.3.3.3.cmml" xref="S4.SS1.p6.1.m1.1.1.3.3.3">𝑐</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p6.1.m1.1c">U_{D\times d_{c}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p6.1.m1.1d">italic_U start_POSTSUBSCRIPT italic_D × italic_d start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math>, we incorporate it to the query calculation by updating the original query matrix <math alttext="W^{H}_{q}\in\mathbb{R}^{D\times hd}" class="ltx_Math" display="inline" id="S4.SS1.p6.2.m2.1"><semantics id="S4.SS1.p6.2.m2.1a"><mrow id="S4.SS1.p6.2.m2.1.1" xref="S4.SS1.p6.2.m2.1.1.cmml"><msubsup id="S4.SS1.p6.2.m2.1.1.2" xref="S4.SS1.p6.2.m2.1.1.2.cmml"><mi id="S4.SS1.p6.2.m2.1.1.2.2.2" xref="S4.SS1.p6.2.m2.1.1.2.2.2.cmml">W</mi><mi id="S4.SS1.p6.2.m2.1.1.2.3" xref="S4.SS1.p6.2.m2.1.1.2.3.cmml">q</mi><mi id="S4.SS1.p6.2.m2.1.1.2.2.3" xref="S4.SS1.p6.2.m2.1.1.2.2.3.cmml">H</mi></msubsup><mo id="S4.SS1.p6.2.m2.1.1.1" xref="S4.SS1.p6.2.m2.1.1.1.cmml">∈</mo><msup id="S4.SS1.p6.2.m2.1.1.3" xref="S4.SS1.p6.2.m2.1.1.3.cmml"><mi id="S4.SS1.p6.2.m2.1.1.3.2" xref="S4.SS1.p6.2.m2.1.1.3.2.cmml">ℝ</mi><mrow id="S4.SS1.p6.2.m2.1.1.3.3" xref="S4.SS1.p6.2.m2.1.1.3.3.cmml"><mrow id="S4.SS1.p6.2.m2.1.1.3.3.2" xref="S4.SS1.p6.2.m2.1.1.3.3.2.cmml"><mi id="S4.SS1.p6.2.m2.1.1.3.3.2.2" xref="S4.SS1.p6.2.m2.1.1.3.3.2.2.cmml">D</mi><mo id="S4.SS1.p6.2.m2.1.1.3.3.2.1" lspace="0.222em" rspace="0.222em" xref="S4.SS1.p6.2.m2.1.1.3.3.2.1.cmml">×</mo><mi id="S4.SS1.p6.2.m2.1.1.3.3.2.3" xref="S4.SS1.p6.2.m2.1.1.3.3.2.3.cmml">h</mi></mrow><mo id="S4.SS1.p6.2.m2.1.1.3.3.1" xref="S4.SS1.p6.2.m2.1.1.3.3.1.cmml">⁢</mo><mi id="S4.SS1.p6.2.m2.1.1.3.3.3" xref="S4.SS1.p6.2.m2.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p6.2.m2.1b"><apply id="S4.SS1.p6.2.m2.1.1.cmml" xref="S4.SS1.p6.2.m2.1.1"><in id="S4.SS1.p6.2.m2.1.1.1.cmml" xref="S4.SS1.p6.2.m2.1.1.1"></in><apply id="S4.SS1.p6.2.m2.1.1.2.cmml" xref="S4.SS1.p6.2.m2.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p6.2.m2.1.1.2.1.cmml" xref="S4.SS1.p6.2.m2.1.1.2">subscript</csymbol><apply id="S4.SS1.p6.2.m2.1.1.2.2.cmml" xref="S4.SS1.p6.2.m2.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p6.2.m2.1.1.2.2.1.cmml" xref="S4.SS1.p6.2.m2.1.1.2">superscript</csymbol><ci id="S4.SS1.p6.2.m2.1.1.2.2.2.cmml" xref="S4.SS1.p6.2.m2.1.1.2.2.2">𝑊</ci><ci id="S4.SS1.p6.2.m2.1.1.2.2.3.cmml" xref="S4.SS1.p6.2.m2.1.1.2.2.3">𝐻</ci></apply><ci id="S4.SS1.p6.2.m2.1.1.2.3.cmml" xref="S4.SS1.p6.2.m2.1.1.2.3">𝑞</ci></apply><apply id="S4.SS1.p6.2.m2.1.1.3.cmml" xref="S4.SS1.p6.2.m2.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p6.2.m2.1.1.3.1.cmml" xref="S4.SS1.p6.2.m2.1.1.3">superscript</csymbol><ci id="S4.SS1.p6.2.m2.1.1.3.2.cmml" xref="S4.SS1.p6.2.m2.1.1.3.2">ℝ</ci><apply id="S4.SS1.p6.2.m2.1.1.3.3.cmml" xref="S4.SS1.p6.2.m2.1.1.3.3"><times id="S4.SS1.p6.2.m2.1.1.3.3.1.cmml" xref="S4.SS1.p6.2.m2.1.1.3.3.1"></times><apply id="S4.SS1.p6.2.m2.1.1.3.3.2.cmml" xref="S4.SS1.p6.2.m2.1.1.3.3.2"><times id="S4.SS1.p6.2.m2.1.1.3.3.2.1.cmml" xref="S4.SS1.p6.2.m2.1.1.3.3.2.1"></times><ci id="S4.SS1.p6.2.m2.1.1.3.3.2.2.cmml" xref="S4.SS1.p6.2.m2.1.1.3.3.2.2">𝐷</ci><ci id="S4.SS1.p6.2.m2.1.1.3.3.2.3.cmml" xref="S4.SS1.p6.2.m2.1.1.3.3.2.3">ℎ</ci></apply><ci id="S4.SS1.p6.2.m2.1.1.3.3.3.cmml" xref="S4.SS1.p6.2.m2.1.1.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p6.2.m2.1c">W^{H}_{q}\in\mathbb{R}^{D\times hd}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p6.2.m2.1d">italic_W start_POSTSUPERSCRIPT italic_H end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_D × italic_h italic_d end_POSTSUPERSCRIPT</annotation></semantics></math> as follows:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E7">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="W^{H}_{q^{\prime}}=(W^{H}_{q})_{D\times hd}U_{D\times d_{c}}." class="ltx_Math" display="block" id="S4.E7.m1.1"><semantics id="S4.E7.m1.1a"><mrow id="S4.E7.m1.1.1.1" xref="S4.E7.m1.1.1.1.1.cmml"><mrow id="S4.E7.m1.1.1.1.1" xref="S4.E7.m1.1.1.1.1.cmml"><msubsup id="S4.E7.m1.1.1.1.1.3" xref="S4.E7.m1.1.1.1.1.3.cmml"><mi id="S4.E7.m1.1.1.1.1.3.2.2" xref="S4.E7.m1.1.1.1.1.3.2.2.cmml">W</mi><msup id="S4.E7.m1.1.1.1.1.3.3" xref="S4.E7.m1.1.1.1.1.3.3.cmml"><mi id="S4.E7.m1.1.1.1.1.3.3.2" xref="S4.E7.m1.1.1.1.1.3.3.2.cmml">q</mi><mo id="S4.E7.m1.1.1.1.1.3.3.3" xref="S4.E7.m1.1.1.1.1.3.3.3.cmml">′</mo></msup><mi id="S4.E7.m1.1.1.1.1.3.2.3" xref="S4.E7.m1.1.1.1.1.3.2.3.cmml">H</mi></msubsup><mo id="S4.E7.m1.1.1.1.1.2" xref="S4.E7.m1.1.1.1.1.2.cmml">=</mo><mrow id="S4.E7.m1.1.1.1.1.1" xref="S4.E7.m1.1.1.1.1.1.cmml"><msub id="S4.E7.m1.1.1.1.1.1.1" xref="S4.E7.m1.1.1.1.1.1.1.cmml"><mrow id="S4.E7.m1.1.1.1.1.1.1.1.1" xref="S4.E7.m1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.E7.m1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.E7.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="S4.E7.m1.1.1.1.1.1.1.1.1.1" xref="S4.E7.m1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E7.m1.1.1.1.1.1.1.1.1.1.2.2" xref="S4.E7.m1.1.1.1.1.1.1.1.1.1.2.2.cmml">W</mi><mi id="S4.E7.m1.1.1.1.1.1.1.1.1.1.3" xref="S4.E7.m1.1.1.1.1.1.1.1.1.1.3.cmml">q</mi><mi id="S4.E7.m1.1.1.1.1.1.1.1.1.1.2.3" xref="S4.E7.m1.1.1.1.1.1.1.1.1.1.2.3.cmml">H</mi></msubsup><mo id="S4.E7.m1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.E7.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mrow id="S4.E7.m1.1.1.1.1.1.1.3" xref="S4.E7.m1.1.1.1.1.1.1.3.cmml"><mrow id="S4.E7.m1.1.1.1.1.1.1.3.2" xref="S4.E7.m1.1.1.1.1.1.1.3.2.cmml"><mi id="S4.E7.m1.1.1.1.1.1.1.3.2.2" xref="S4.E7.m1.1.1.1.1.1.1.3.2.2.cmml">D</mi><mo id="S4.E7.m1.1.1.1.1.1.1.3.2.1" lspace="0.222em" rspace="0.222em" xref="S4.E7.m1.1.1.1.1.1.1.3.2.1.cmml">×</mo><mi id="S4.E7.m1.1.1.1.1.1.1.3.2.3" xref="S4.E7.m1.1.1.1.1.1.1.3.2.3.cmml">h</mi></mrow><mo id="S4.E7.m1.1.1.1.1.1.1.3.1" xref="S4.E7.m1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S4.E7.m1.1.1.1.1.1.1.3.3" xref="S4.E7.m1.1.1.1.1.1.1.3.3.cmml">d</mi></mrow></msub><mo id="S4.E7.m1.1.1.1.1.1.2" xref="S4.E7.m1.1.1.1.1.1.2.cmml">⁢</mo><msub id="S4.E7.m1.1.1.1.1.1.3" xref="S4.E7.m1.1.1.1.1.1.3.cmml"><mi id="S4.E7.m1.1.1.1.1.1.3.2" xref="S4.E7.m1.1.1.1.1.1.3.2.cmml">U</mi><mrow id="S4.E7.m1.1.1.1.1.1.3.3" xref="S4.E7.m1.1.1.1.1.1.3.3.cmml"><mi id="S4.E7.m1.1.1.1.1.1.3.3.2" xref="S4.E7.m1.1.1.1.1.1.3.3.2.cmml">D</mi><mo id="S4.E7.m1.1.1.1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S4.E7.m1.1.1.1.1.1.3.3.1.cmml">×</mo><msub id="S4.E7.m1.1.1.1.1.1.3.3.3" xref="S4.E7.m1.1.1.1.1.1.3.3.3.cmml"><mi id="S4.E7.m1.1.1.1.1.1.3.3.3.2" xref="S4.E7.m1.1.1.1.1.1.3.3.3.2.cmml">d</mi><mi id="S4.E7.m1.1.1.1.1.1.3.3.3.3" xref="S4.E7.m1.1.1.1.1.1.3.3.3.3.cmml">c</mi></msub></mrow></msub></mrow></mrow><mo id="S4.E7.m1.1.1.1.2" lspace="0em" xref="S4.E7.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E7.m1.1b"><apply id="S4.E7.m1.1.1.1.1.cmml" xref="S4.E7.m1.1.1.1"><eq id="S4.E7.m1.1.1.1.1.2.cmml" xref="S4.E7.m1.1.1.1.1.2"></eq><apply id="S4.E7.m1.1.1.1.1.3.cmml" xref="S4.E7.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E7.m1.1.1.1.1.3.1.cmml" xref="S4.E7.m1.1.1.1.1.3">subscript</csymbol><apply id="S4.E7.m1.1.1.1.1.3.2.cmml" xref="S4.E7.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E7.m1.1.1.1.1.3.2.1.cmml" xref="S4.E7.m1.1.1.1.1.3">superscript</csymbol><ci id="S4.E7.m1.1.1.1.1.3.2.2.cmml" xref="S4.E7.m1.1.1.1.1.3.2.2">𝑊</ci><ci id="S4.E7.m1.1.1.1.1.3.2.3.cmml" xref="S4.E7.m1.1.1.1.1.3.2.3">𝐻</ci></apply><apply id="S4.E7.m1.1.1.1.1.3.3.cmml" xref="S4.E7.m1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.E7.m1.1.1.1.1.3.3.1.cmml" xref="S4.E7.m1.1.1.1.1.3.3">superscript</csymbol><ci id="S4.E7.m1.1.1.1.1.3.3.2.cmml" xref="S4.E7.m1.1.1.1.1.3.3.2">𝑞</ci><ci id="S4.E7.m1.1.1.1.1.3.3.3.cmml" xref="S4.E7.m1.1.1.1.1.3.3.3">′</ci></apply></apply><apply id="S4.E7.m1.1.1.1.1.1.cmml" xref="S4.E7.m1.1.1.1.1.1"><times id="S4.E7.m1.1.1.1.1.1.2.cmml" xref="S4.E7.m1.1.1.1.1.1.2"></times><apply id="S4.E7.m1.1.1.1.1.1.1.cmml" xref="S4.E7.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E7.m1.1.1.1.1.1.1.2.cmml" xref="S4.E7.m1.1.1.1.1.1.1">subscript</csymbol><apply id="S4.E7.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E7.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E7.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E7.m1.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="S4.E7.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E7.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E7.m1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E7.m1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S4.E7.m1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E7.m1.1.1.1.1.1.1.1.1.1.2.2">𝑊</ci><ci id="S4.E7.m1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E7.m1.1.1.1.1.1.1.1.1.1.2.3">𝐻</ci></apply><ci id="S4.E7.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E7.m1.1.1.1.1.1.1.1.1.1.3">𝑞</ci></apply><apply id="S4.E7.m1.1.1.1.1.1.1.3.cmml" xref="S4.E7.m1.1.1.1.1.1.1.3"><times id="S4.E7.m1.1.1.1.1.1.1.3.1.cmml" xref="S4.E7.m1.1.1.1.1.1.1.3.1"></times><apply id="S4.E7.m1.1.1.1.1.1.1.3.2.cmml" xref="S4.E7.m1.1.1.1.1.1.1.3.2"><times id="S4.E7.m1.1.1.1.1.1.1.3.2.1.cmml" xref="S4.E7.m1.1.1.1.1.1.1.3.2.1"></times><ci id="S4.E7.m1.1.1.1.1.1.1.3.2.2.cmml" xref="S4.E7.m1.1.1.1.1.1.1.3.2.2">𝐷</ci><ci id="S4.E7.m1.1.1.1.1.1.1.3.2.3.cmml" xref="S4.E7.m1.1.1.1.1.1.1.3.2.3">ℎ</ci></apply><ci id="S4.E7.m1.1.1.1.1.1.1.3.3.cmml" xref="S4.E7.m1.1.1.1.1.1.1.3.3">𝑑</ci></apply></apply><apply id="S4.E7.m1.1.1.1.1.1.3.cmml" xref="S4.E7.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E7.m1.1.1.1.1.1.3.1.cmml" xref="S4.E7.m1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E7.m1.1.1.1.1.1.3.2.cmml" xref="S4.E7.m1.1.1.1.1.1.3.2">𝑈</ci><apply id="S4.E7.m1.1.1.1.1.1.3.3.cmml" xref="S4.E7.m1.1.1.1.1.1.3.3"><times id="S4.E7.m1.1.1.1.1.1.3.3.1.cmml" xref="S4.E7.m1.1.1.1.1.1.3.3.1"></times><ci id="S4.E7.m1.1.1.1.1.1.3.3.2.cmml" xref="S4.E7.m1.1.1.1.1.1.3.3.2">𝐷</ci><apply id="S4.E7.m1.1.1.1.1.1.3.3.3.cmml" xref="S4.E7.m1.1.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S4.E7.m1.1.1.1.1.1.3.3.3.1.cmml" xref="S4.E7.m1.1.1.1.1.1.3.3.3">subscript</csymbol><ci id="S4.E7.m1.1.1.1.1.1.3.3.3.2.cmml" xref="S4.E7.m1.1.1.1.1.1.3.3.3.2">𝑑</ci><ci id="S4.E7.m1.1.1.1.1.1.3.3.3.3.cmml" xref="S4.E7.m1.1.1.1.1.1.3.3.3.3">𝑐</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E7.m1.1c">W^{H}_{q^{\prime}}=(W^{H}_{q})_{D\times hd}U_{D\times d_{c}}.</annotation><annotation encoding="application/x-llamapun" id="S4.E7.m1.1d">italic_W start_POSTSUPERSCRIPT italic_H end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_q start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT end_POSTSUBSCRIPT = ( italic_W start_POSTSUPERSCRIPT italic_H end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT ) start_POSTSUBSCRIPT italic_D × italic_h italic_d end_POSTSUBSCRIPT italic_U start_POSTSUBSCRIPT italic_D × italic_d start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT end_POSTSUBSCRIPT .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS1.p6.7">Note that the embedding dimension <math alttext="D" class="ltx_Math" display="inline" id="S4.SS1.p6.3.m1.1"><semantics id="S4.SS1.p6.3.m1.1a"><mi id="S4.SS1.p6.3.m1.1.1" xref="S4.SS1.p6.3.m1.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p6.3.m1.1b"><ci id="S4.SS1.p6.3.m1.1.1.cmml" xref="S4.SS1.p6.3.m1.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p6.3.m1.1c">D</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p6.3.m1.1d">italic_D</annotation></semantics></math> is equal to the product of the number of attention heads <math alttext="h" class="ltx_Math" display="inline" id="S4.SS1.p6.4.m2.1"><semantics id="S4.SS1.p6.4.m2.1a"><mi id="S4.SS1.p6.4.m2.1.1" xref="S4.SS1.p6.4.m2.1.1.cmml">h</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p6.4.m2.1b"><ci id="S4.SS1.p6.4.m2.1.1.cmml" xref="S4.SS1.p6.4.m2.1.1">ℎ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p6.4.m2.1c">h</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p6.4.m2.1d">italic_h</annotation></semantics></math> and the dimension per head <math alttext="d" class="ltx_Math" display="inline" id="S4.SS1.p6.5.m3.1"><semantics id="S4.SS1.p6.5.m3.1a"><mi id="S4.SS1.p6.5.m3.1.1" xref="S4.SS1.p6.5.m3.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p6.5.m3.1b"><ci id="S4.SS1.p6.5.m3.1.1.cmml" xref="S4.SS1.p6.5.m3.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p6.5.m3.1c">d</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p6.5.m3.1d">italic_d</annotation></semantics></math>, i.e., <math alttext="D=hd" class="ltx_Math" display="inline" id="S4.SS1.p6.6.m4.1"><semantics id="S4.SS1.p6.6.m4.1a"><mrow id="S4.SS1.p6.6.m4.1.1" xref="S4.SS1.p6.6.m4.1.1.cmml"><mi id="S4.SS1.p6.6.m4.1.1.2" xref="S4.SS1.p6.6.m4.1.1.2.cmml">D</mi><mo id="S4.SS1.p6.6.m4.1.1.1" xref="S4.SS1.p6.6.m4.1.1.1.cmml">=</mo><mrow id="S4.SS1.p6.6.m4.1.1.3" xref="S4.SS1.p6.6.m4.1.1.3.cmml"><mi id="S4.SS1.p6.6.m4.1.1.3.2" xref="S4.SS1.p6.6.m4.1.1.3.2.cmml">h</mi><mo id="S4.SS1.p6.6.m4.1.1.3.1" xref="S4.SS1.p6.6.m4.1.1.3.1.cmml">⁢</mo><mi id="S4.SS1.p6.6.m4.1.1.3.3" xref="S4.SS1.p6.6.m4.1.1.3.3.cmml">d</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p6.6.m4.1b"><apply id="S4.SS1.p6.6.m4.1.1.cmml" xref="S4.SS1.p6.6.m4.1.1"><eq id="S4.SS1.p6.6.m4.1.1.1.cmml" xref="S4.SS1.p6.6.m4.1.1.1"></eq><ci id="S4.SS1.p6.6.m4.1.1.2.cmml" xref="S4.SS1.p6.6.m4.1.1.2">𝐷</ci><apply id="S4.SS1.p6.6.m4.1.1.3.cmml" xref="S4.SS1.p6.6.m4.1.1.3"><times id="S4.SS1.p6.6.m4.1.1.3.1.cmml" xref="S4.SS1.p6.6.m4.1.1.3.1"></times><ci id="S4.SS1.p6.6.m4.1.1.3.2.cmml" xref="S4.SS1.p6.6.m4.1.1.3.2">ℎ</ci><ci id="S4.SS1.p6.6.m4.1.1.3.3.cmml" xref="S4.SS1.p6.6.m4.1.1.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p6.6.m4.1c">D=hd</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p6.6.m4.1d">italic_D = italic_h italic_d</annotation></semantics></math>. Consequently, the updated query matrix <math alttext="W^{H}_{q^{\prime}}\in\mathbb{R}^{D\times d_{c}}" class="ltx_Math" display="inline" id="S4.SS1.p6.7.m5.1"><semantics id="S4.SS1.p6.7.m5.1a"><mrow id="S4.SS1.p6.7.m5.1.1" xref="S4.SS1.p6.7.m5.1.1.cmml"><msubsup id="S4.SS1.p6.7.m5.1.1.2" xref="S4.SS1.p6.7.m5.1.1.2.cmml"><mi id="S4.SS1.p6.7.m5.1.1.2.2.2" xref="S4.SS1.p6.7.m5.1.1.2.2.2.cmml">W</mi><msup id="S4.SS1.p6.7.m5.1.1.2.3" xref="S4.SS1.p6.7.m5.1.1.2.3.cmml"><mi id="S4.SS1.p6.7.m5.1.1.2.3.2" xref="S4.SS1.p6.7.m5.1.1.2.3.2.cmml">q</mi><mo id="S4.SS1.p6.7.m5.1.1.2.3.3" xref="S4.SS1.p6.7.m5.1.1.2.3.3.cmml">′</mo></msup><mi id="S4.SS1.p6.7.m5.1.1.2.2.3" xref="S4.SS1.p6.7.m5.1.1.2.2.3.cmml">H</mi></msubsup><mo id="S4.SS1.p6.7.m5.1.1.1" xref="S4.SS1.p6.7.m5.1.1.1.cmml">∈</mo><msup id="S4.SS1.p6.7.m5.1.1.3" xref="S4.SS1.p6.7.m5.1.1.3.cmml"><mi id="S4.SS1.p6.7.m5.1.1.3.2" xref="S4.SS1.p6.7.m5.1.1.3.2.cmml">ℝ</mi><mrow id="S4.SS1.p6.7.m5.1.1.3.3" xref="S4.SS1.p6.7.m5.1.1.3.3.cmml"><mi id="S4.SS1.p6.7.m5.1.1.3.3.2" xref="S4.SS1.p6.7.m5.1.1.3.3.2.cmml">D</mi><mo id="S4.SS1.p6.7.m5.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S4.SS1.p6.7.m5.1.1.3.3.1.cmml">×</mo><msub id="S4.SS1.p6.7.m5.1.1.3.3.3" xref="S4.SS1.p6.7.m5.1.1.3.3.3.cmml"><mi id="S4.SS1.p6.7.m5.1.1.3.3.3.2" xref="S4.SS1.p6.7.m5.1.1.3.3.3.2.cmml">d</mi><mi id="S4.SS1.p6.7.m5.1.1.3.3.3.3" xref="S4.SS1.p6.7.m5.1.1.3.3.3.3.cmml">c</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p6.7.m5.1b"><apply id="S4.SS1.p6.7.m5.1.1.cmml" xref="S4.SS1.p6.7.m5.1.1"><in id="S4.SS1.p6.7.m5.1.1.1.cmml" xref="S4.SS1.p6.7.m5.1.1.1"></in><apply id="S4.SS1.p6.7.m5.1.1.2.cmml" xref="S4.SS1.p6.7.m5.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p6.7.m5.1.1.2.1.cmml" xref="S4.SS1.p6.7.m5.1.1.2">subscript</csymbol><apply id="S4.SS1.p6.7.m5.1.1.2.2.cmml" xref="S4.SS1.p6.7.m5.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p6.7.m5.1.1.2.2.1.cmml" xref="S4.SS1.p6.7.m5.1.1.2">superscript</csymbol><ci id="S4.SS1.p6.7.m5.1.1.2.2.2.cmml" xref="S4.SS1.p6.7.m5.1.1.2.2.2">𝑊</ci><ci id="S4.SS1.p6.7.m5.1.1.2.2.3.cmml" xref="S4.SS1.p6.7.m5.1.1.2.2.3">𝐻</ci></apply><apply id="S4.SS1.p6.7.m5.1.1.2.3.cmml" xref="S4.SS1.p6.7.m5.1.1.2.3"><csymbol cd="ambiguous" id="S4.SS1.p6.7.m5.1.1.2.3.1.cmml" xref="S4.SS1.p6.7.m5.1.1.2.3">superscript</csymbol><ci id="S4.SS1.p6.7.m5.1.1.2.3.2.cmml" xref="S4.SS1.p6.7.m5.1.1.2.3.2">𝑞</ci><ci id="S4.SS1.p6.7.m5.1.1.2.3.3.cmml" xref="S4.SS1.p6.7.m5.1.1.2.3.3">′</ci></apply></apply><apply id="S4.SS1.p6.7.m5.1.1.3.cmml" xref="S4.SS1.p6.7.m5.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p6.7.m5.1.1.3.1.cmml" xref="S4.SS1.p6.7.m5.1.1.3">superscript</csymbol><ci id="S4.SS1.p6.7.m5.1.1.3.2.cmml" xref="S4.SS1.p6.7.m5.1.1.3.2">ℝ</ci><apply id="S4.SS1.p6.7.m5.1.1.3.3.cmml" xref="S4.SS1.p6.7.m5.1.1.3.3"><times id="S4.SS1.p6.7.m5.1.1.3.3.1.cmml" xref="S4.SS1.p6.7.m5.1.1.3.3.1"></times><ci id="S4.SS1.p6.7.m5.1.1.3.3.2.cmml" xref="S4.SS1.p6.7.m5.1.1.3.3.2">𝐷</ci><apply id="S4.SS1.p6.7.m5.1.1.3.3.3.cmml" xref="S4.SS1.p6.7.m5.1.1.3.3.3"><csymbol cd="ambiguous" id="S4.SS1.p6.7.m5.1.1.3.3.3.1.cmml" xref="S4.SS1.p6.7.m5.1.1.3.3.3">subscript</csymbol><ci id="S4.SS1.p6.7.m5.1.1.3.3.3.2.cmml" xref="S4.SS1.p6.7.m5.1.1.3.3.3.2">𝑑</ci><ci id="S4.SS1.p6.7.m5.1.1.3.3.3.3.cmml" xref="S4.SS1.p6.7.m5.1.1.3.3.3.3">𝑐</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p6.7.m5.1c">W^{H}_{q^{\prime}}\in\mathbb{R}^{D\times d_{c}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p6.7.m5.1d">italic_W start_POSTSUPERSCRIPT italic_H end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_q start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_D × italic_d start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S4.SS1.p7">
<p class="ltx_p" id="S4.SS1.p7.1"><span class="ltx_text ltx_font_bold" id="S4.SS1.p7.1.1">Value Matrix Compression:</span>
The decomposition for the value matrix follows a similar structure to that of the key matrix, with the difference that we integrate its left singular vectors to the output matrix <math alttext="W_{o}" class="ltx_Math" display="inline" id="S4.SS1.p7.1.m1.1"><semantics id="S4.SS1.p7.1.m1.1a"><msub id="S4.SS1.p7.1.m1.1.1" xref="S4.SS1.p7.1.m1.1.1.cmml"><mi id="S4.SS1.p7.1.m1.1.1.2" xref="S4.SS1.p7.1.m1.1.1.2.cmml">W</mi><mi id="S4.SS1.p7.1.m1.1.1.3" xref="S4.SS1.p7.1.m1.1.1.3.cmml">o</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p7.1.m1.1b"><apply id="S4.SS1.p7.1.m1.1.1.cmml" xref="S4.SS1.p7.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p7.1.m1.1.1.1.cmml" xref="S4.SS1.p7.1.m1.1.1">subscript</csymbol><ci id="S4.SS1.p7.1.m1.1.1.2.cmml" xref="S4.SS1.p7.1.m1.1.1.2">𝑊</ci><ci id="S4.SS1.p7.1.m1.1.1.3.cmml" xref="S4.SS1.p7.1.m1.1.1.3">𝑜</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p7.1.m1.1c">W_{o}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p7.1.m1.1d">italic_W start_POSTSUBSCRIPT italic_o end_POSTSUBSCRIPT</annotation></semantics></math>. Specifically, the value matrix is decomposed as:</p>
</div>
<div class="ltx_para" id="S4.SS1.p8">
<table class="ltx_equation ltx_eqn_table" id="S4.E8">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\text{SVD}(W^{H}_{v})_{D\times hd}=U_{D\times d_{c}}(\Sigma V^{T})_{d_{c}%
\times hd}=U_{D\times d_{c}}\left[\begin{array}[]{cccc}(B^{1})_{d_{c}\times d}%
&amp;(B^{2})_{d_{c}\times d}&amp;\cdots&amp;(B^{h})_{d_{c}\times d}\end{array}\right]" class="ltx_Math" display="block" id="S4.E8.m1.5"><semantics id="S4.E8.m1.5a"><mrow id="S4.E8.m1.5.5" xref="S4.E8.m1.5.5.cmml"><mrow id="S4.E8.m1.4.4.1" xref="S4.E8.m1.4.4.1.cmml"><mtext id="S4.E8.m1.4.4.1.3" xref="S4.E8.m1.4.4.1.3a.cmml">SVD</mtext><mo id="S4.E8.m1.4.4.1.2" xref="S4.E8.m1.4.4.1.2.cmml">⁢</mo><msub id="S4.E8.m1.4.4.1.1" xref="S4.E8.m1.4.4.1.1.cmml"><mrow id="S4.E8.m1.4.4.1.1.1.1" xref="S4.E8.m1.4.4.1.1.1.1.1.cmml"><mo id="S4.E8.m1.4.4.1.1.1.1.2" stretchy="false" xref="S4.E8.m1.4.4.1.1.1.1.1.cmml">(</mo><msubsup id="S4.E8.m1.4.4.1.1.1.1.1" xref="S4.E8.m1.4.4.1.1.1.1.1.cmml"><mi id="S4.E8.m1.4.4.1.1.1.1.1.2.2" xref="S4.E8.m1.4.4.1.1.1.1.1.2.2.cmml">W</mi><mi id="S4.E8.m1.4.4.1.1.1.1.1.3" xref="S4.E8.m1.4.4.1.1.1.1.1.3.cmml">v</mi><mi id="S4.E8.m1.4.4.1.1.1.1.1.2.3" xref="S4.E8.m1.4.4.1.1.1.1.1.2.3.cmml">H</mi></msubsup><mo id="S4.E8.m1.4.4.1.1.1.1.3" stretchy="false" xref="S4.E8.m1.4.4.1.1.1.1.1.cmml">)</mo></mrow><mrow id="S4.E8.m1.4.4.1.1.3" xref="S4.E8.m1.4.4.1.1.3.cmml"><mrow id="S4.E8.m1.4.4.1.1.3.2" xref="S4.E8.m1.4.4.1.1.3.2.cmml"><mi id="S4.E8.m1.4.4.1.1.3.2.2" xref="S4.E8.m1.4.4.1.1.3.2.2.cmml">D</mi><mo id="S4.E8.m1.4.4.1.1.3.2.1" lspace="0.222em" rspace="0.222em" xref="S4.E8.m1.4.4.1.1.3.2.1.cmml">×</mo><mi id="S4.E8.m1.4.4.1.1.3.2.3" xref="S4.E8.m1.4.4.1.1.3.2.3.cmml">h</mi></mrow><mo id="S4.E8.m1.4.4.1.1.3.1" xref="S4.E8.m1.4.4.1.1.3.1.cmml">⁢</mo><mi id="S4.E8.m1.4.4.1.1.3.3" xref="S4.E8.m1.4.4.1.1.3.3.cmml">d</mi></mrow></msub></mrow><mo id="S4.E8.m1.5.5.4" xref="S4.E8.m1.5.5.4.cmml">=</mo><mrow id="S4.E8.m1.5.5.2" xref="S4.E8.m1.5.5.2.cmml"><msub id="S4.E8.m1.5.5.2.3" xref="S4.E8.m1.5.5.2.3.cmml"><mi id="S4.E8.m1.5.5.2.3.2" xref="S4.E8.m1.5.5.2.3.2.cmml">U</mi><mrow id="S4.E8.m1.5.5.2.3.3" xref="S4.E8.m1.5.5.2.3.3.cmml"><mi id="S4.E8.m1.5.5.2.3.3.2" xref="S4.E8.m1.5.5.2.3.3.2.cmml">D</mi><mo id="S4.E8.m1.5.5.2.3.3.1" lspace="0.222em" rspace="0.222em" xref="S4.E8.m1.5.5.2.3.3.1.cmml">×</mo><msub id="S4.E8.m1.5.5.2.3.3.3" xref="S4.E8.m1.5.5.2.3.3.3.cmml"><mi id="S4.E8.m1.5.5.2.3.3.3.2" xref="S4.E8.m1.5.5.2.3.3.3.2.cmml">d</mi><mi id="S4.E8.m1.5.5.2.3.3.3.3" xref="S4.E8.m1.5.5.2.3.3.3.3.cmml">c</mi></msub></mrow></msub><mo id="S4.E8.m1.5.5.2.2" xref="S4.E8.m1.5.5.2.2.cmml">⁢</mo><msub id="S4.E8.m1.5.5.2.1" xref="S4.E8.m1.5.5.2.1.cmml"><mrow id="S4.E8.m1.5.5.2.1.1.1" xref="S4.E8.m1.5.5.2.1.1.1.1.cmml"><mo id="S4.E8.m1.5.5.2.1.1.1.2" stretchy="false" xref="S4.E8.m1.5.5.2.1.1.1.1.cmml">(</mo><mrow id="S4.E8.m1.5.5.2.1.1.1.1" xref="S4.E8.m1.5.5.2.1.1.1.1.cmml"><mi id="S4.E8.m1.5.5.2.1.1.1.1.2" mathvariant="normal" xref="S4.E8.m1.5.5.2.1.1.1.1.2.cmml">Σ</mi><mo id="S4.E8.m1.5.5.2.1.1.1.1.1" xref="S4.E8.m1.5.5.2.1.1.1.1.1.cmml">⁢</mo><msup id="S4.E8.m1.5.5.2.1.1.1.1.3" xref="S4.E8.m1.5.5.2.1.1.1.1.3.cmml"><mi id="S4.E8.m1.5.5.2.1.1.1.1.3.2" xref="S4.E8.m1.5.5.2.1.1.1.1.3.2.cmml">V</mi><mi id="S4.E8.m1.5.5.2.1.1.1.1.3.3" xref="S4.E8.m1.5.5.2.1.1.1.1.3.3.cmml">T</mi></msup></mrow><mo id="S4.E8.m1.5.5.2.1.1.1.3" stretchy="false" xref="S4.E8.m1.5.5.2.1.1.1.1.cmml">)</mo></mrow><mrow id="S4.E8.m1.5.5.2.1.3" xref="S4.E8.m1.5.5.2.1.3.cmml"><mrow id="S4.E8.m1.5.5.2.1.3.2" xref="S4.E8.m1.5.5.2.1.3.2.cmml"><msub id="S4.E8.m1.5.5.2.1.3.2.2" xref="S4.E8.m1.5.5.2.1.3.2.2.cmml"><mi id="S4.E8.m1.5.5.2.1.3.2.2.2" xref="S4.E8.m1.5.5.2.1.3.2.2.2.cmml">d</mi><mi id="S4.E8.m1.5.5.2.1.3.2.2.3" xref="S4.E8.m1.5.5.2.1.3.2.2.3.cmml">c</mi></msub><mo id="S4.E8.m1.5.5.2.1.3.2.1" lspace="0.222em" rspace="0.222em" xref="S4.E8.m1.5.5.2.1.3.2.1.cmml">×</mo><mi id="S4.E8.m1.5.5.2.1.3.2.3" xref="S4.E8.m1.5.5.2.1.3.2.3.cmml">h</mi></mrow><mo id="S4.E8.m1.5.5.2.1.3.1" xref="S4.E8.m1.5.5.2.1.3.1.cmml">⁢</mo><mi id="S4.E8.m1.5.5.2.1.3.3" xref="S4.E8.m1.5.5.2.1.3.3.cmml">d</mi></mrow></msub></mrow><mo id="S4.E8.m1.5.5.5" xref="S4.E8.m1.5.5.5.cmml">=</mo><mrow id="S4.E8.m1.5.5.6" xref="S4.E8.m1.5.5.6.cmml"><msub id="S4.E8.m1.5.5.6.2" xref="S4.E8.m1.5.5.6.2.cmml"><mi id="S4.E8.m1.5.5.6.2.2" xref="S4.E8.m1.5.5.6.2.2.cmml">U</mi><mrow id="S4.E8.m1.5.5.6.2.3" xref="S4.E8.m1.5.5.6.2.3.cmml"><mi id="S4.E8.m1.5.5.6.2.3.2" xref="S4.E8.m1.5.5.6.2.3.2.cmml">D</mi><mo id="S4.E8.m1.5.5.6.2.3.1" lspace="0.222em" rspace="0.222em" xref="S4.E8.m1.5.5.6.2.3.1.cmml">×</mo><msub id="S4.E8.m1.5.5.6.2.3.3" xref="S4.E8.m1.5.5.6.2.3.3.cmml"><mi id="S4.E8.m1.5.5.6.2.3.3.2" xref="S4.E8.m1.5.5.6.2.3.3.2.cmml">d</mi><mi id="S4.E8.m1.5.5.6.2.3.3.3" xref="S4.E8.m1.5.5.6.2.3.3.3.cmml">c</mi></msub></mrow></msub><mo id="S4.E8.m1.5.5.6.1" xref="S4.E8.m1.5.5.6.1.cmml">⁢</mo><mrow id="S4.E8.m1.5.5.6.3.2" xref="S4.E8.m1.5.5.6.3.1.cmml"><mo id="S4.E8.m1.5.5.6.3.2.1" xref="S4.E8.m1.5.5.6.3.1.1.cmml">[</mo><mtable columnspacing="5pt" displaystyle="true" id="S4.E8.m1.3.3" xref="S4.E8.m1.3.3.cmml"><mtr id="S4.E8.m1.3.3a" xref="S4.E8.m1.3.3.cmml"><mtd id="S4.E8.m1.3.3b" xref="S4.E8.m1.3.3.cmml"><msub id="S4.E8.m1.1.1.1.1.1" xref="S4.E8.m1.1.1.1.1.1.cmml"><mrow id="S4.E8.m1.1.1.1.1.1.1.1" xref="S4.E8.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.E8.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.E8.m1.1.1.1.1.1.1.1.1.cmml">(</mo><msup id="S4.E8.m1.1.1.1.1.1.1.1.1" xref="S4.E8.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E8.m1.1.1.1.1.1.1.1.1.2" xref="S4.E8.m1.1.1.1.1.1.1.1.1.2.cmml">B</mi><mn id="S4.E8.m1.1.1.1.1.1.1.1.1.3" xref="S4.E8.m1.1.1.1.1.1.1.1.1.3.cmml">1</mn></msup><mo id="S4.E8.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.E8.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mrow id="S4.E8.m1.1.1.1.1.1.3" xref="S4.E8.m1.1.1.1.1.1.3.cmml"><msub id="S4.E8.m1.1.1.1.1.1.3.2" xref="S4.E8.m1.1.1.1.1.1.3.2.cmml"><mi id="S4.E8.m1.1.1.1.1.1.3.2.2" xref="S4.E8.m1.1.1.1.1.1.3.2.2.cmml">d</mi><mi id="S4.E8.m1.1.1.1.1.1.3.2.3" xref="S4.E8.m1.1.1.1.1.1.3.2.3.cmml">c</mi></msub><mo id="S4.E8.m1.1.1.1.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="S4.E8.m1.1.1.1.1.1.3.1.cmml">×</mo><mi id="S4.E8.m1.1.1.1.1.1.3.3" xref="S4.E8.m1.1.1.1.1.1.3.3.cmml">d</mi></mrow></msub></mtd><mtd id="S4.E8.m1.3.3c" xref="S4.E8.m1.3.3.cmml"><msub id="S4.E8.m1.2.2.2.2.1" xref="S4.E8.m1.2.2.2.2.1.cmml"><mrow id="S4.E8.m1.2.2.2.2.1.1.1" xref="S4.E8.m1.2.2.2.2.1.1.1.1.cmml"><mo id="S4.E8.m1.2.2.2.2.1.1.1.2" stretchy="false" xref="S4.E8.m1.2.2.2.2.1.1.1.1.cmml">(</mo><msup id="S4.E8.m1.2.2.2.2.1.1.1.1" xref="S4.E8.m1.2.2.2.2.1.1.1.1.cmml"><mi id="S4.E8.m1.2.2.2.2.1.1.1.1.2" xref="S4.E8.m1.2.2.2.2.1.1.1.1.2.cmml">B</mi><mn id="S4.E8.m1.2.2.2.2.1.1.1.1.3" xref="S4.E8.m1.2.2.2.2.1.1.1.1.3.cmml">2</mn></msup><mo id="S4.E8.m1.2.2.2.2.1.1.1.3" stretchy="false" xref="S4.E8.m1.2.2.2.2.1.1.1.1.cmml">)</mo></mrow><mrow id="S4.E8.m1.2.2.2.2.1.3" xref="S4.E8.m1.2.2.2.2.1.3.cmml"><msub id="S4.E8.m1.2.2.2.2.1.3.2" xref="S4.E8.m1.2.2.2.2.1.3.2.cmml"><mi id="S4.E8.m1.2.2.2.2.1.3.2.2" xref="S4.E8.m1.2.2.2.2.1.3.2.2.cmml">d</mi><mi id="S4.E8.m1.2.2.2.2.1.3.2.3" xref="S4.E8.m1.2.2.2.2.1.3.2.3.cmml">c</mi></msub><mo id="S4.E8.m1.2.2.2.2.1.3.1" lspace="0.222em" rspace="0.222em" xref="S4.E8.m1.2.2.2.2.1.3.1.cmml">×</mo><mi id="S4.E8.m1.2.2.2.2.1.3.3" xref="S4.E8.m1.2.2.2.2.1.3.3.cmml">d</mi></mrow></msub></mtd><mtd id="S4.E8.m1.3.3d" xref="S4.E8.m1.3.3.cmml"><mi id="S4.E8.m1.3.3.3.4.1" mathvariant="normal" xref="S4.E8.m1.3.3.3.4.1.cmml">⋯</mi></mtd><mtd id="S4.E8.m1.3.3e" xref="S4.E8.m1.3.3.cmml"><msub id="S4.E8.m1.3.3.3.3.1" xref="S4.E8.m1.3.3.3.3.1.cmml"><mrow id="S4.E8.m1.3.3.3.3.1.1.1" xref="S4.E8.m1.3.3.3.3.1.1.1.1.cmml"><mo id="S4.E8.m1.3.3.3.3.1.1.1.2" stretchy="false" xref="S4.E8.m1.3.3.3.3.1.1.1.1.cmml">(</mo><msup id="S4.E8.m1.3.3.3.3.1.1.1.1" xref="S4.E8.m1.3.3.3.3.1.1.1.1.cmml"><mi id="S4.E8.m1.3.3.3.3.1.1.1.1.2" xref="S4.E8.m1.3.3.3.3.1.1.1.1.2.cmml">B</mi><mi id="S4.E8.m1.3.3.3.3.1.1.1.1.3" xref="S4.E8.m1.3.3.3.3.1.1.1.1.3.cmml">h</mi></msup><mo id="S4.E8.m1.3.3.3.3.1.1.1.3" stretchy="false" xref="S4.E8.m1.3.3.3.3.1.1.1.1.cmml">)</mo></mrow><mrow id="S4.E8.m1.3.3.3.3.1.3" xref="S4.E8.m1.3.3.3.3.1.3.cmml"><msub id="S4.E8.m1.3.3.3.3.1.3.2" xref="S4.E8.m1.3.3.3.3.1.3.2.cmml"><mi id="S4.E8.m1.3.3.3.3.1.3.2.2" xref="S4.E8.m1.3.3.3.3.1.3.2.2.cmml">d</mi><mi id="S4.E8.m1.3.3.3.3.1.3.2.3" xref="S4.E8.m1.3.3.3.3.1.3.2.3.cmml">c</mi></msub><mo id="S4.E8.m1.3.3.3.3.1.3.1" lspace="0.222em" rspace="0.222em" xref="S4.E8.m1.3.3.3.3.1.3.1.cmml">×</mo><mi id="S4.E8.m1.3.3.3.3.1.3.3" xref="S4.E8.m1.3.3.3.3.1.3.3.cmml">d</mi></mrow></msub></mtd></mtr></mtable><mo id="S4.E8.m1.5.5.6.3.2.2" xref="S4.E8.m1.5.5.6.3.1.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E8.m1.5b"><apply id="S4.E8.m1.5.5.cmml" xref="S4.E8.m1.5.5"><and id="S4.E8.m1.5.5a.cmml" xref="S4.E8.m1.5.5"></and><apply id="S4.E8.m1.5.5b.cmml" xref="S4.E8.m1.5.5"><eq id="S4.E8.m1.5.5.4.cmml" xref="S4.E8.m1.5.5.4"></eq><apply id="S4.E8.m1.4.4.1.cmml" xref="S4.E8.m1.4.4.1"><times id="S4.E8.m1.4.4.1.2.cmml" xref="S4.E8.m1.4.4.1.2"></times><ci id="S4.E8.m1.4.4.1.3a.cmml" xref="S4.E8.m1.4.4.1.3"><mtext id="S4.E8.m1.4.4.1.3.cmml" xref="S4.E8.m1.4.4.1.3">SVD</mtext></ci><apply id="S4.E8.m1.4.4.1.1.cmml" xref="S4.E8.m1.4.4.1.1"><csymbol cd="ambiguous" id="S4.E8.m1.4.4.1.1.2.cmml" xref="S4.E8.m1.4.4.1.1">subscript</csymbol><apply id="S4.E8.m1.4.4.1.1.1.1.1.cmml" xref="S4.E8.m1.4.4.1.1.1.1"><csymbol cd="ambiguous" id="S4.E8.m1.4.4.1.1.1.1.1.1.cmml" xref="S4.E8.m1.4.4.1.1.1.1">subscript</csymbol><apply id="S4.E8.m1.4.4.1.1.1.1.1.2.cmml" xref="S4.E8.m1.4.4.1.1.1.1"><csymbol cd="ambiguous" id="S4.E8.m1.4.4.1.1.1.1.1.2.1.cmml" xref="S4.E8.m1.4.4.1.1.1.1">superscript</csymbol><ci id="S4.E8.m1.4.4.1.1.1.1.1.2.2.cmml" xref="S4.E8.m1.4.4.1.1.1.1.1.2.2">𝑊</ci><ci id="S4.E8.m1.4.4.1.1.1.1.1.2.3.cmml" xref="S4.E8.m1.4.4.1.1.1.1.1.2.3">𝐻</ci></apply><ci id="S4.E8.m1.4.4.1.1.1.1.1.3.cmml" xref="S4.E8.m1.4.4.1.1.1.1.1.3">𝑣</ci></apply><apply id="S4.E8.m1.4.4.1.1.3.cmml" xref="S4.E8.m1.4.4.1.1.3"><times id="S4.E8.m1.4.4.1.1.3.1.cmml" xref="S4.E8.m1.4.4.1.1.3.1"></times><apply id="S4.E8.m1.4.4.1.1.3.2.cmml" xref="S4.E8.m1.4.4.1.1.3.2"><times id="S4.E8.m1.4.4.1.1.3.2.1.cmml" xref="S4.E8.m1.4.4.1.1.3.2.1"></times><ci id="S4.E8.m1.4.4.1.1.3.2.2.cmml" xref="S4.E8.m1.4.4.1.1.3.2.2">𝐷</ci><ci id="S4.E8.m1.4.4.1.1.3.2.3.cmml" xref="S4.E8.m1.4.4.1.1.3.2.3">ℎ</ci></apply><ci id="S4.E8.m1.4.4.1.1.3.3.cmml" xref="S4.E8.m1.4.4.1.1.3.3">𝑑</ci></apply></apply></apply><apply id="S4.E8.m1.5.5.2.cmml" xref="S4.E8.m1.5.5.2"><times id="S4.E8.m1.5.5.2.2.cmml" xref="S4.E8.m1.5.5.2.2"></times><apply id="S4.E8.m1.5.5.2.3.cmml" xref="S4.E8.m1.5.5.2.3"><csymbol cd="ambiguous" id="S4.E8.m1.5.5.2.3.1.cmml" xref="S4.E8.m1.5.5.2.3">subscript</csymbol><ci id="S4.E8.m1.5.5.2.3.2.cmml" xref="S4.E8.m1.5.5.2.3.2">𝑈</ci><apply id="S4.E8.m1.5.5.2.3.3.cmml" xref="S4.E8.m1.5.5.2.3.3"><times id="S4.E8.m1.5.5.2.3.3.1.cmml" xref="S4.E8.m1.5.5.2.3.3.1"></times><ci id="S4.E8.m1.5.5.2.3.3.2.cmml" xref="S4.E8.m1.5.5.2.3.3.2">𝐷</ci><apply id="S4.E8.m1.5.5.2.3.3.3.cmml" xref="S4.E8.m1.5.5.2.3.3.3"><csymbol cd="ambiguous" id="S4.E8.m1.5.5.2.3.3.3.1.cmml" xref="S4.E8.m1.5.5.2.3.3.3">subscript</csymbol><ci id="S4.E8.m1.5.5.2.3.3.3.2.cmml" xref="S4.E8.m1.5.5.2.3.3.3.2">𝑑</ci><ci id="S4.E8.m1.5.5.2.3.3.3.3.cmml" xref="S4.E8.m1.5.5.2.3.3.3.3">𝑐</ci></apply></apply></apply><apply id="S4.E8.m1.5.5.2.1.cmml" xref="S4.E8.m1.5.5.2.1"><csymbol cd="ambiguous" id="S4.E8.m1.5.5.2.1.2.cmml" xref="S4.E8.m1.5.5.2.1">subscript</csymbol><apply id="S4.E8.m1.5.5.2.1.1.1.1.cmml" xref="S4.E8.m1.5.5.2.1.1.1"><times id="S4.E8.m1.5.5.2.1.1.1.1.1.cmml" xref="S4.E8.m1.5.5.2.1.1.1.1.1"></times><ci id="S4.E8.m1.5.5.2.1.1.1.1.2.cmml" xref="S4.E8.m1.5.5.2.1.1.1.1.2">Σ</ci><apply id="S4.E8.m1.5.5.2.1.1.1.1.3.cmml" xref="S4.E8.m1.5.5.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E8.m1.5.5.2.1.1.1.1.3.1.cmml" xref="S4.E8.m1.5.5.2.1.1.1.1.3">superscript</csymbol><ci id="S4.E8.m1.5.5.2.1.1.1.1.3.2.cmml" xref="S4.E8.m1.5.5.2.1.1.1.1.3.2">𝑉</ci><ci id="S4.E8.m1.5.5.2.1.1.1.1.3.3.cmml" xref="S4.E8.m1.5.5.2.1.1.1.1.3.3">𝑇</ci></apply></apply><apply id="S4.E8.m1.5.5.2.1.3.cmml" xref="S4.E8.m1.5.5.2.1.3"><times id="S4.E8.m1.5.5.2.1.3.1.cmml" xref="S4.E8.m1.5.5.2.1.3.1"></times><apply id="S4.E8.m1.5.5.2.1.3.2.cmml" xref="S4.E8.m1.5.5.2.1.3.2"><times id="S4.E8.m1.5.5.2.1.3.2.1.cmml" xref="S4.E8.m1.5.5.2.1.3.2.1"></times><apply id="S4.E8.m1.5.5.2.1.3.2.2.cmml" xref="S4.E8.m1.5.5.2.1.3.2.2"><csymbol cd="ambiguous" id="S4.E8.m1.5.5.2.1.3.2.2.1.cmml" xref="S4.E8.m1.5.5.2.1.3.2.2">subscript</csymbol><ci id="S4.E8.m1.5.5.2.1.3.2.2.2.cmml" xref="S4.E8.m1.5.5.2.1.3.2.2.2">𝑑</ci><ci id="S4.E8.m1.5.5.2.1.3.2.2.3.cmml" xref="S4.E8.m1.5.5.2.1.3.2.2.3">𝑐</ci></apply><ci id="S4.E8.m1.5.5.2.1.3.2.3.cmml" xref="S4.E8.m1.5.5.2.1.3.2.3">ℎ</ci></apply><ci id="S4.E8.m1.5.5.2.1.3.3.cmml" xref="S4.E8.m1.5.5.2.1.3.3">𝑑</ci></apply></apply></apply></apply><apply id="S4.E8.m1.5.5c.cmml" xref="S4.E8.m1.5.5"><eq id="S4.E8.m1.5.5.5.cmml" xref="S4.E8.m1.5.5.5"></eq><share href="https://arxiv.org/html/2410.03111v1#S4.E8.m1.5.5.2.cmml" id="S4.E8.m1.5.5d.cmml" xref="S4.E8.m1.5.5"></share><apply id="S4.E8.m1.5.5.6.cmml" xref="S4.E8.m1.5.5.6"><times id="S4.E8.m1.5.5.6.1.cmml" xref="S4.E8.m1.5.5.6.1"></times><apply id="S4.E8.m1.5.5.6.2.cmml" xref="S4.E8.m1.5.5.6.2"><csymbol cd="ambiguous" id="S4.E8.m1.5.5.6.2.1.cmml" xref="S4.E8.m1.5.5.6.2">subscript</csymbol><ci id="S4.E8.m1.5.5.6.2.2.cmml" xref="S4.E8.m1.5.5.6.2.2">𝑈</ci><apply id="S4.E8.m1.5.5.6.2.3.cmml" xref="S4.E8.m1.5.5.6.2.3"><times id="S4.E8.m1.5.5.6.2.3.1.cmml" xref="S4.E8.m1.5.5.6.2.3.1"></times><ci id="S4.E8.m1.5.5.6.2.3.2.cmml" xref="S4.E8.m1.5.5.6.2.3.2">𝐷</ci><apply id="S4.E8.m1.5.5.6.2.3.3.cmml" xref="S4.E8.m1.5.5.6.2.3.3"><csymbol cd="ambiguous" id="S4.E8.m1.5.5.6.2.3.3.1.cmml" xref="S4.E8.m1.5.5.6.2.3.3">subscript</csymbol><ci id="S4.E8.m1.5.5.6.2.3.3.2.cmml" xref="S4.E8.m1.5.5.6.2.3.3.2">𝑑</ci><ci id="S4.E8.m1.5.5.6.2.3.3.3.cmml" xref="S4.E8.m1.5.5.6.2.3.3.3">𝑐</ci></apply></apply></apply><apply id="S4.E8.m1.5.5.6.3.1.cmml" xref="S4.E8.m1.5.5.6.3.2"><csymbol cd="latexml" id="S4.E8.m1.5.5.6.3.1.1.cmml" xref="S4.E8.m1.5.5.6.3.2.1">delimited-[]</csymbol><matrix id="S4.E8.m1.3.3.cmml" xref="S4.E8.m1.3.3"><matrixrow id="S4.E8.m1.3.3a.cmml" xref="S4.E8.m1.3.3"><apply id="S4.E8.m1.1.1.1.1.1.cmml" xref="S4.E8.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E8.m1.1.1.1.1.1.2.cmml" xref="S4.E8.m1.1.1.1.1.1">subscript</csymbol><apply id="S4.E8.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.E8.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E8.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E8.m1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S4.E8.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E8.m1.1.1.1.1.1.1.1.1.2">𝐵</ci><cn id="S4.E8.m1.1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S4.E8.m1.1.1.1.1.1.1.1.1.3">1</cn></apply><apply id="S4.E8.m1.1.1.1.1.1.3.cmml" xref="S4.E8.m1.1.1.1.1.1.3"><times id="S4.E8.m1.1.1.1.1.1.3.1.cmml" xref="S4.E8.m1.1.1.1.1.1.3.1"></times><apply id="S4.E8.m1.1.1.1.1.1.3.2.cmml" xref="S4.E8.m1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S4.E8.m1.1.1.1.1.1.3.2.1.cmml" xref="S4.E8.m1.1.1.1.1.1.3.2">subscript</csymbol><ci id="S4.E8.m1.1.1.1.1.1.3.2.2.cmml" xref="S4.E8.m1.1.1.1.1.1.3.2.2">𝑑</ci><ci id="S4.E8.m1.1.1.1.1.1.3.2.3.cmml" xref="S4.E8.m1.1.1.1.1.1.3.2.3">𝑐</ci></apply><ci id="S4.E8.m1.1.1.1.1.1.3.3.cmml" xref="S4.E8.m1.1.1.1.1.1.3.3">𝑑</ci></apply></apply><apply id="S4.E8.m1.2.2.2.2.1.cmml" xref="S4.E8.m1.2.2.2.2.1"><csymbol cd="ambiguous" id="S4.E8.m1.2.2.2.2.1.2.cmml" xref="S4.E8.m1.2.2.2.2.1">subscript</csymbol><apply id="S4.E8.m1.2.2.2.2.1.1.1.1.cmml" xref="S4.E8.m1.2.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.E8.m1.2.2.2.2.1.1.1.1.1.cmml" xref="S4.E8.m1.2.2.2.2.1.1.1">superscript</csymbol><ci id="S4.E8.m1.2.2.2.2.1.1.1.1.2.cmml" xref="S4.E8.m1.2.2.2.2.1.1.1.1.2">𝐵</ci><cn id="S4.E8.m1.2.2.2.2.1.1.1.1.3.cmml" type="integer" xref="S4.E8.m1.2.2.2.2.1.1.1.1.3">2</cn></apply><apply id="S4.E8.m1.2.2.2.2.1.3.cmml" xref="S4.E8.m1.2.2.2.2.1.3"><times id="S4.E8.m1.2.2.2.2.1.3.1.cmml" xref="S4.E8.m1.2.2.2.2.1.3.1"></times><apply id="S4.E8.m1.2.2.2.2.1.3.2.cmml" xref="S4.E8.m1.2.2.2.2.1.3.2"><csymbol cd="ambiguous" id="S4.E8.m1.2.2.2.2.1.3.2.1.cmml" xref="S4.E8.m1.2.2.2.2.1.3.2">subscript</csymbol><ci id="S4.E8.m1.2.2.2.2.1.3.2.2.cmml" xref="S4.E8.m1.2.2.2.2.1.3.2.2">𝑑</ci><ci id="S4.E8.m1.2.2.2.2.1.3.2.3.cmml" xref="S4.E8.m1.2.2.2.2.1.3.2.3">𝑐</ci></apply><ci id="S4.E8.m1.2.2.2.2.1.3.3.cmml" xref="S4.E8.m1.2.2.2.2.1.3.3">𝑑</ci></apply></apply><ci id="S4.E8.m1.3.3.3.4.1.cmml" xref="S4.E8.m1.3.3.3.4.1">⋯</ci><apply id="S4.E8.m1.3.3.3.3.1.cmml" xref="S4.E8.m1.3.3.3.3.1"><csymbol cd="ambiguous" id="S4.E8.m1.3.3.3.3.1.2.cmml" xref="S4.E8.m1.3.3.3.3.1">subscript</csymbol><apply id="S4.E8.m1.3.3.3.3.1.1.1.1.cmml" xref="S4.E8.m1.3.3.3.3.1.1.1"><csymbol cd="ambiguous" id="S4.E8.m1.3.3.3.3.1.1.1.1.1.cmml" xref="S4.E8.m1.3.3.3.3.1.1.1">superscript</csymbol><ci id="S4.E8.m1.3.3.3.3.1.1.1.1.2.cmml" xref="S4.E8.m1.3.3.3.3.1.1.1.1.2">𝐵</ci><ci id="S4.E8.m1.3.3.3.3.1.1.1.1.3.cmml" xref="S4.E8.m1.3.3.3.3.1.1.1.1.3">ℎ</ci></apply><apply id="S4.E8.m1.3.3.3.3.1.3.cmml" xref="S4.E8.m1.3.3.3.3.1.3"><times id="S4.E8.m1.3.3.3.3.1.3.1.cmml" xref="S4.E8.m1.3.3.3.3.1.3.1"></times><apply id="S4.E8.m1.3.3.3.3.1.3.2.cmml" xref="S4.E8.m1.3.3.3.3.1.3.2"><csymbol cd="ambiguous" id="S4.E8.m1.3.3.3.3.1.3.2.1.cmml" xref="S4.E8.m1.3.3.3.3.1.3.2">subscript</csymbol><ci id="S4.E8.m1.3.3.3.3.1.3.2.2.cmml" xref="S4.E8.m1.3.3.3.3.1.3.2.2">𝑑</ci><ci id="S4.E8.m1.3.3.3.3.1.3.2.3.cmml" xref="S4.E8.m1.3.3.3.3.1.3.2.3">𝑐</ci></apply><ci id="S4.E8.m1.3.3.3.3.1.3.3.cmml" xref="S4.E8.m1.3.3.3.3.1.3.3">𝑑</ci></apply></apply></matrixrow></matrix></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E8.m1.5c">\text{SVD}(W^{H}_{v})_{D\times hd}=U_{D\times d_{c}}(\Sigma V^{T})_{d_{c}%
\times hd}=U_{D\times d_{c}}\left[\begin{array}[]{cccc}(B^{1})_{d_{c}\times d}%
&amp;(B^{2})_{d_{c}\times d}&amp;\cdots&amp;(B^{h})_{d_{c}\times d}\end{array}\right]</annotation><annotation encoding="application/x-llamapun" id="S4.E8.m1.5d">SVD ( italic_W start_POSTSUPERSCRIPT italic_H end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT ) start_POSTSUBSCRIPT italic_D × italic_h italic_d end_POSTSUBSCRIPT = italic_U start_POSTSUBSCRIPT italic_D × italic_d start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( roman_Σ italic_V start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT ) start_POSTSUBSCRIPT italic_d start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT × italic_h italic_d end_POSTSUBSCRIPT = italic_U start_POSTSUBSCRIPT italic_D × italic_d start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT end_POSTSUBSCRIPT [ start_ARRAY start_ROW start_CELL ( italic_B start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT ) start_POSTSUBSCRIPT italic_d start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT × italic_d end_POSTSUBSCRIPT end_CELL start_CELL ( italic_B start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ) start_POSTSUBSCRIPT italic_d start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT × italic_d end_POSTSUBSCRIPT end_CELL start_CELL ⋯ end_CELL start_CELL ( italic_B start_POSTSUPERSCRIPT italic_h end_POSTSUPERSCRIPT ) start_POSTSUBSCRIPT italic_d start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT × italic_d end_POSTSUBSCRIPT end_CELL end_ROW end_ARRAY ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS1.p8.6">where <math alttext="(B^{i})_{d_{c}\times d}" class="ltx_Math" display="inline" id="S4.SS1.p8.1.m1.1"><semantics id="S4.SS1.p8.1.m1.1a"><msub id="S4.SS1.p8.1.m1.1.1" xref="S4.SS1.p8.1.m1.1.1.cmml"><mrow id="S4.SS1.p8.1.m1.1.1.1.1" xref="S4.SS1.p8.1.m1.1.1.1.1.1.cmml"><mo id="S4.SS1.p8.1.m1.1.1.1.1.2" stretchy="false" xref="S4.SS1.p8.1.m1.1.1.1.1.1.cmml">(</mo><msup id="S4.SS1.p8.1.m1.1.1.1.1.1" xref="S4.SS1.p8.1.m1.1.1.1.1.1.cmml"><mi id="S4.SS1.p8.1.m1.1.1.1.1.1.2" xref="S4.SS1.p8.1.m1.1.1.1.1.1.2.cmml">B</mi><mi id="S4.SS1.p8.1.m1.1.1.1.1.1.3" xref="S4.SS1.p8.1.m1.1.1.1.1.1.3.cmml">i</mi></msup><mo id="S4.SS1.p8.1.m1.1.1.1.1.3" stretchy="false" xref="S4.SS1.p8.1.m1.1.1.1.1.1.cmml">)</mo></mrow><mrow id="S4.SS1.p8.1.m1.1.1.3" xref="S4.SS1.p8.1.m1.1.1.3.cmml"><msub id="S4.SS1.p8.1.m1.1.1.3.2" xref="S4.SS1.p8.1.m1.1.1.3.2.cmml"><mi id="S4.SS1.p8.1.m1.1.1.3.2.2" xref="S4.SS1.p8.1.m1.1.1.3.2.2.cmml">d</mi><mi id="S4.SS1.p8.1.m1.1.1.3.2.3" xref="S4.SS1.p8.1.m1.1.1.3.2.3.cmml">c</mi></msub><mo id="S4.SS1.p8.1.m1.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="S4.SS1.p8.1.m1.1.1.3.1.cmml">×</mo><mi id="S4.SS1.p8.1.m1.1.1.3.3" xref="S4.SS1.p8.1.m1.1.1.3.3.cmml">d</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p8.1.m1.1b"><apply id="S4.SS1.p8.1.m1.1.1.cmml" xref="S4.SS1.p8.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p8.1.m1.1.1.2.cmml" xref="S4.SS1.p8.1.m1.1.1">subscript</csymbol><apply id="S4.SS1.p8.1.m1.1.1.1.1.1.cmml" xref="S4.SS1.p8.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p8.1.m1.1.1.1.1.1.1.cmml" xref="S4.SS1.p8.1.m1.1.1.1.1">superscript</csymbol><ci id="S4.SS1.p8.1.m1.1.1.1.1.1.2.cmml" xref="S4.SS1.p8.1.m1.1.1.1.1.1.2">𝐵</ci><ci id="S4.SS1.p8.1.m1.1.1.1.1.1.3.cmml" xref="S4.SS1.p8.1.m1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S4.SS1.p8.1.m1.1.1.3.cmml" xref="S4.SS1.p8.1.m1.1.1.3"><times id="S4.SS1.p8.1.m1.1.1.3.1.cmml" xref="S4.SS1.p8.1.m1.1.1.3.1"></times><apply id="S4.SS1.p8.1.m1.1.1.3.2.cmml" xref="S4.SS1.p8.1.m1.1.1.3.2"><csymbol cd="ambiguous" id="S4.SS1.p8.1.m1.1.1.3.2.1.cmml" xref="S4.SS1.p8.1.m1.1.1.3.2">subscript</csymbol><ci id="S4.SS1.p8.1.m1.1.1.3.2.2.cmml" xref="S4.SS1.p8.1.m1.1.1.3.2.2">𝑑</ci><ci id="S4.SS1.p8.1.m1.1.1.3.2.3.cmml" xref="S4.SS1.p8.1.m1.1.1.3.2.3">𝑐</ci></apply><ci id="S4.SS1.p8.1.m1.1.1.3.3.cmml" xref="S4.SS1.p8.1.m1.1.1.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p8.1.m1.1c">(B^{i})_{d_{c}\times d}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p8.1.m1.1d">( italic_B start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT ) start_POSTSUBSCRIPT italic_d start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT × italic_d end_POSTSUBSCRIPT</annotation></semantics></math> is the <math alttext="i" class="ltx_Math" display="inline" id="S4.SS1.p8.2.m2.1"><semantics id="S4.SS1.p8.2.m2.1a"><mi id="S4.SS1.p8.2.m2.1.1" xref="S4.SS1.p8.2.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p8.2.m2.1b"><ci id="S4.SS1.p8.2.m2.1.1.cmml" xref="S4.SS1.p8.2.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p8.2.m2.1c">i</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p8.2.m2.1d">italic_i</annotation></semantics></math>-th block in the matrix <math alttext="(\Sigma V^{T})_{d_{c}\times hd}" class="ltx_Math" display="inline" id="S4.SS1.p8.3.m3.1"><semantics id="S4.SS1.p8.3.m3.1a"><msub id="S4.SS1.p8.3.m3.1.1" xref="S4.SS1.p8.3.m3.1.1.cmml"><mrow id="S4.SS1.p8.3.m3.1.1.1.1" xref="S4.SS1.p8.3.m3.1.1.1.1.1.cmml"><mo id="S4.SS1.p8.3.m3.1.1.1.1.2" stretchy="false" xref="S4.SS1.p8.3.m3.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS1.p8.3.m3.1.1.1.1.1" xref="S4.SS1.p8.3.m3.1.1.1.1.1.cmml"><mi id="S4.SS1.p8.3.m3.1.1.1.1.1.2" mathvariant="normal" xref="S4.SS1.p8.3.m3.1.1.1.1.1.2.cmml">Σ</mi><mo id="S4.SS1.p8.3.m3.1.1.1.1.1.1" xref="S4.SS1.p8.3.m3.1.1.1.1.1.1.cmml">⁢</mo><msup id="S4.SS1.p8.3.m3.1.1.1.1.1.3" xref="S4.SS1.p8.3.m3.1.1.1.1.1.3.cmml"><mi id="S4.SS1.p8.3.m3.1.1.1.1.1.3.2" xref="S4.SS1.p8.3.m3.1.1.1.1.1.3.2.cmml">V</mi><mi id="S4.SS1.p8.3.m3.1.1.1.1.1.3.3" xref="S4.SS1.p8.3.m3.1.1.1.1.1.3.3.cmml">T</mi></msup></mrow><mo id="S4.SS1.p8.3.m3.1.1.1.1.3" stretchy="false" xref="S4.SS1.p8.3.m3.1.1.1.1.1.cmml">)</mo></mrow><mrow id="S4.SS1.p8.3.m3.1.1.3" xref="S4.SS1.p8.3.m3.1.1.3.cmml"><mrow id="S4.SS1.p8.3.m3.1.1.3.2" xref="S4.SS1.p8.3.m3.1.1.3.2.cmml"><msub id="S4.SS1.p8.3.m3.1.1.3.2.2" xref="S4.SS1.p8.3.m3.1.1.3.2.2.cmml"><mi id="S4.SS1.p8.3.m3.1.1.3.2.2.2" xref="S4.SS1.p8.3.m3.1.1.3.2.2.2.cmml">d</mi><mi id="S4.SS1.p8.3.m3.1.1.3.2.2.3" xref="S4.SS1.p8.3.m3.1.1.3.2.2.3.cmml">c</mi></msub><mo id="S4.SS1.p8.3.m3.1.1.3.2.1" lspace="0.222em" rspace="0.222em" xref="S4.SS1.p8.3.m3.1.1.3.2.1.cmml">×</mo><mi id="S4.SS1.p8.3.m3.1.1.3.2.3" xref="S4.SS1.p8.3.m3.1.1.3.2.3.cmml">h</mi></mrow><mo id="S4.SS1.p8.3.m3.1.1.3.1" xref="S4.SS1.p8.3.m3.1.1.3.1.cmml">⁢</mo><mi id="S4.SS1.p8.3.m3.1.1.3.3" xref="S4.SS1.p8.3.m3.1.1.3.3.cmml">d</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p8.3.m3.1b"><apply id="S4.SS1.p8.3.m3.1.1.cmml" xref="S4.SS1.p8.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS1.p8.3.m3.1.1.2.cmml" xref="S4.SS1.p8.3.m3.1.1">subscript</csymbol><apply id="S4.SS1.p8.3.m3.1.1.1.1.1.cmml" xref="S4.SS1.p8.3.m3.1.1.1.1"><times id="S4.SS1.p8.3.m3.1.1.1.1.1.1.cmml" xref="S4.SS1.p8.3.m3.1.1.1.1.1.1"></times><ci id="S4.SS1.p8.3.m3.1.1.1.1.1.2.cmml" xref="S4.SS1.p8.3.m3.1.1.1.1.1.2">Σ</ci><apply id="S4.SS1.p8.3.m3.1.1.1.1.1.3.cmml" xref="S4.SS1.p8.3.m3.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p8.3.m3.1.1.1.1.1.3.1.cmml" xref="S4.SS1.p8.3.m3.1.1.1.1.1.3">superscript</csymbol><ci id="S4.SS1.p8.3.m3.1.1.1.1.1.3.2.cmml" xref="S4.SS1.p8.3.m3.1.1.1.1.1.3.2">𝑉</ci><ci id="S4.SS1.p8.3.m3.1.1.1.1.1.3.3.cmml" xref="S4.SS1.p8.3.m3.1.1.1.1.1.3.3">𝑇</ci></apply></apply><apply id="S4.SS1.p8.3.m3.1.1.3.cmml" xref="S4.SS1.p8.3.m3.1.1.3"><times id="S4.SS1.p8.3.m3.1.1.3.1.cmml" xref="S4.SS1.p8.3.m3.1.1.3.1"></times><apply id="S4.SS1.p8.3.m3.1.1.3.2.cmml" xref="S4.SS1.p8.3.m3.1.1.3.2"><times id="S4.SS1.p8.3.m3.1.1.3.2.1.cmml" xref="S4.SS1.p8.3.m3.1.1.3.2.1"></times><apply id="S4.SS1.p8.3.m3.1.1.3.2.2.cmml" xref="S4.SS1.p8.3.m3.1.1.3.2.2"><csymbol cd="ambiguous" id="S4.SS1.p8.3.m3.1.1.3.2.2.1.cmml" xref="S4.SS1.p8.3.m3.1.1.3.2.2">subscript</csymbol><ci id="S4.SS1.p8.3.m3.1.1.3.2.2.2.cmml" xref="S4.SS1.p8.3.m3.1.1.3.2.2.2">𝑑</ci><ci id="S4.SS1.p8.3.m3.1.1.3.2.2.3.cmml" xref="S4.SS1.p8.3.m3.1.1.3.2.2.3">𝑐</ci></apply><ci id="S4.SS1.p8.3.m3.1.1.3.2.3.cmml" xref="S4.SS1.p8.3.m3.1.1.3.2.3">ℎ</ci></apply><ci id="S4.SS1.p8.3.m3.1.1.3.3.cmml" xref="S4.SS1.p8.3.m3.1.1.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p8.3.m3.1c">(\Sigma V^{T})_{d_{c}\times hd}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p8.3.m3.1d">( roman_Σ italic_V start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT ) start_POSTSUBSCRIPT italic_d start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT × italic_h italic_d end_POSTSUBSCRIPT</annotation></semantics></math>. After multiplication with <math alttext="X" class="ltx_Math" display="inline" id="S4.SS1.p8.4.m4.1"><semantics id="S4.SS1.p8.4.m4.1a"><mi id="S4.SS1.p8.4.m4.1.1" xref="S4.SS1.p8.4.m4.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p8.4.m4.1b"><ci id="S4.SS1.p8.4.m4.1.1.cmml" xref="S4.SS1.p8.4.m4.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p8.4.m4.1c">X</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p8.4.m4.1d">italic_X</annotation></semantics></math>, the dimension of the value cache shrinks from <math alttext="hd" class="ltx_Math" display="inline" id="S4.SS1.p8.5.m5.1"><semantics id="S4.SS1.p8.5.m5.1a"><mrow id="S4.SS1.p8.5.m5.1.1" xref="S4.SS1.p8.5.m5.1.1.cmml"><mi id="S4.SS1.p8.5.m5.1.1.2" xref="S4.SS1.p8.5.m5.1.1.2.cmml">h</mi><mo id="S4.SS1.p8.5.m5.1.1.1" xref="S4.SS1.p8.5.m5.1.1.1.cmml">⁢</mo><mi id="S4.SS1.p8.5.m5.1.1.3" xref="S4.SS1.p8.5.m5.1.1.3.cmml">d</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p8.5.m5.1b"><apply id="S4.SS1.p8.5.m5.1.1.cmml" xref="S4.SS1.p8.5.m5.1.1"><times id="S4.SS1.p8.5.m5.1.1.1.cmml" xref="S4.SS1.p8.5.m5.1.1.1"></times><ci id="S4.SS1.p8.5.m5.1.1.2.cmml" xref="S4.SS1.p8.5.m5.1.1.2">ℎ</ci><ci id="S4.SS1.p8.5.m5.1.1.3.cmml" xref="S4.SS1.p8.5.m5.1.1.3">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p8.5.m5.1c">hd</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p8.5.m5.1d">italic_h italic_d</annotation></semantics></math> to <math alttext="d_{c}" class="ltx_Math" display="inline" id="S4.SS1.p8.6.m6.1"><semantics id="S4.SS1.p8.6.m6.1a"><msub id="S4.SS1.p8.6.m6.1.1" xref="S4.SS1.p8.6.m6.1.1.cmml"><mi id="S4.SS1.p8.6.m6.1.1.2" xref="S4.SS1.p8.6.m6.1.1.2.cmml">d</mi><mi id="S4.SS1.p8.6.m6.1.1.3" xref="S4.SS1.p8.6.m6.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p8.6.m6.1b"><apply id="S4.SS1.p8.6.m6.1.1.cmml" xref="S4.SS1.p8.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS1.p8.6.m6.1.1.1.cmml" xref="S4.SS1.p8.6.m6.1.1">subscript</csymbol><ci id="S4.SS1.p8.6.m6.1.1.2.cmml" xref="S4.SS1.p8.6.m6.1.1.2">𝑑</ci><ci id="S4.SS1.p8.6.m6.1.1.3.cmml" xref="S4.SS1.p8.6.m6.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p8.6.m6.1c">d_{c}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p8.6.m6.1d">italic_d start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT</annotation></semantics></math>, thus reducing memory consumption.</p>
</div>
<div class="ltx_para" id="S4.SS1.p9">
<p class="ltx_p" id="S4.SS1.p9.2">In contrast to the key matrix operation, we incorporate <math alttext="U_{D\times d_{c}}" class="ltx_Math" display="inline" id="S4.SS1.p9.1.m1.1"><semantics id="S4.SS1.p9.1.m1.1a"><msub id="S4.SS1.p9.1.m1.1.1" xref="S4.SS1.p9.1.m1.1.1.cmml"><mi id="S4.SS1.p9.1.m1.1.1.2" xref="S4.SS1.p9.1.m1.1.1.2.cmml">U</mi><mrow id="S4.SS1.p9.1.m1.1.1.3" xref="S4.SS1.p9.1.m1.1.1.3.cmml"><mi id="S4.SS1.p9.1.m1.1.1.3.2" xref="S4.SS1.p9.1.m1.1.1.3.2.cmml">D</mi><mo id="S4.SS1.p9.1.m1.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="S4.SS1.p9.1.m1.1.1.3.1.cmml">×</mo><msub id="S4.SS1.p9.1.m1.1.1.3.3" xref="S4.SS1.p9.1.m1.1.1.3.3.cmml"><mi id="S4.SS1.p9.1.m1.1.1.3.3.2" xref="S4.SS1.p9.1.m1.1.1.3.3.2.cmml">d</mi><mi id="S4.SS1.p9.1.m1.1.1.3.3.3" xref="S4.SS1.p9.1.m1.1.1.3.3.3.cmml">c</mi></msub></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p9.1.m1.1b"><apply id="S4.SS1.p9.1.m1.1.1.cmml" xref="S4.SS1.p9.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p9.1.m1.1.1.1.cmml" xref="S4.SS1.p9.1.m1.1.1">subscript</csymbol><ci id="S4.SS1.p9.1.m1.1.1.2.cmml" xref="S4.SS1.p9.1.m1.1.1.2">𝑈</ci><apply id="S4.SS1.p9.1.m1.1.1.3.cmml" xref="S4.SS1.p9.1.m1.1.1.3"><times id="S4.SS1.p9.1.m1.1.1.3.1.cmml" xref="S4.SS1.p9.1.m1.1.1.3.1"></times><ci id="S4.SS1.p9.1.m1.1.1.3.2.cmml" xref="S4.SS1.p9.1.m1.1.1.3.2">𝐷</ci><apply id="S4.SS1.p9.1.m1.1.1.3.3.cmml" xref="S4.SS1.p9.1.m1.1.1.3.3"><csymbol cd="ambiguous" id="S4.SS1.p9.1.m1.1.1.3.3.1.cmml" xref="S4.SS1.p9.1.m1.1.1.3.3">subscript</csymbol><ci id="S4.SS1.p9.1.m1.1.1.3.3.2.cmml" xref="S4.SS1.p9.1.m1.1.1.3.3.2">𝑑</ci><ci id="S4.SS1.p9.1.m1.1.1.3.3.3.cmml" xref="S4.SS1.p9.1.m1.1.1.3.3.3">𝑐</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p9.1.m1.1c">U_{D\times d_{c}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p9.1.m1.1d">italic_U start_POSTSUBSCRIPT italic_D × italic_d start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math> to the output matrix. To achieve this, we update the output matrix <math alttext="W_{o}\in\mathbb{R}^{D\times D}" class="ltx_Math" display="inline" id="S4.SS1.p9.2.m2.1"><semantics id="S4.SS1.p9.2.m2.1a"><mrow id="S4.SS1.p9.2.m2.1.1" xref="S4.SS1.p9.2.m2.1.1.cmml"><msub id="S4.SS1.p9.2.m2.1.1.2" xref="S4.SS1.p9.2.m2.1.1.2.cmml"><mi id="S4.SS1.p9.2.m2.1.1.2.2" xref="S4.SS1.p9.2.m2.1.1.2.2.cmml">W</mi><mi id="S4.SS1.p9.2.m2.1.1.2.3" xref="S4.SS1.p9.2.m2.1.1.2.3.cmml">o</mi></msub><mo id="S4.SS1.p9.2.m2.1.1.1" xref="S4.SS1.p9.2.m2.1.1.1.cmml">∈</mo><msup id="S4.SS1.p9.2.m2.1.1.3" xref="S4.SS1.p9.2.m2.1.1.3.cmml"><mi id="S4.SS1.p9.2.m2.1.1.3.2" xref="S4.SS1.p9.2.m2.1.1.3.2.cmml">ℝ</mi><mrow id="S4.SS1.p9.2.m2.1.1.3.3" xref="S4.SS1.p9.2.m2.1.1.3.3.cmml"><mi id="S4.SS1.p9.2.m2.1.1.3.3.2" xref="S4.SS1.p9.2.m2.1.1.3.3.2.cmml">D</mi><mo id="S4.SS1.p9.2.m2.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S4.SS1.p9.2.m2.1.1.3.3.1.cmml">×</mo><mi id="S4.SS1.p9.2.m2.1.1.3.3.3" xref="S4.SS1.p9.2.m2.1.1.3.3.3.cmml">D</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p9.2.m2.1b"><apply id="S4.SS1.p9.2.m2.1.1.cmml" xref="S4.SS1.p9.2.m2.1.1"><in id="S4.SS1.p9.2.m2.1.1.1.cmml" xref="S4.SS1.p9.2.m2.1.1.1"></in><apply id="S4.SS1.p9.2.m2.1.1.2.cmml" xref="S4.SS1.p9.2.m2.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p9.2.m2.1.1.2.1.cmml" xref="S4.SS1.p9.2.m2.1.1.2">subscript</csymbol><ci id="S4.SS1.p9.2.m2.1.1.2.2.cmml" xref="S4.SS1.p9.2.m2.1.1.2.2">𝑊</ci><ci id="S4.SS1.p9.2.m2.1.1.2.3.cmml" xref="S4.SS1.p9.2.m2.1.1.2.3">𝑜</ci></apply><apply id="S4.SS1.p9.2.m2.1.1.3.cmml" xref="S4.SS1.p9.2.m2.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p9.2.m2.1.1.3.1.cmml" xref="S4.SS1.p9.2.m2.1.1.3">superscript</csymbol><ci id="S4.SS1.p9.2.m2.1.1.3.2.cmml" xref="S4.SS1.p9.2.m2.1.1.3.2">ℝ</ci><apply id="S4.SS1.p9.2.m2.1.1.3.3.cmml" xref="S4.SS1.p9.2.m2.1.1.3.3"><times id="S4.SS1.p9.2.m2.1.1.3.3.1.cmml" xref="S4.SS1.p9.2.m2.1.1.3.3.1"></times><ci id="S4.SS1.p9.2.m2.1.1.3.3.2.cmml" xref="S4.SS1.p9.2.m2.1.1.3.3.2">𝐷</ci><ci id="S4.SS1.p9.2.m2.1.1.3.3.3.cmml" xref="S4.SS1.p9.2.m2.1.1.3.3.3">𝐷</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p9.2.m2.1c">W_{o}\in\mathbb{R}^{D\times D}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p9.2.m2.1d">italic_W start_POSTSUBSCRIPT italic_o end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_D × italic_D end_POSTSUPERSCRIPT</annotation></semantics></math> as follows:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E9">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="W_{o^{\prime}}=(U^{\top})_{d_{c}\times D}(W_{o})_{D\times D}," class="ltx_Math" display="block" id="S4.E9.m1.1"><semantics id="S4.E9.m1.1a"><mrow id="S4.E9.m1.1.1.1" xref="S4.E9.m1.1.1.1.1.cmml"><mrow id="S4.E9.m1.1.1.1.1" xref="S4.E9.m1.1.1.1.1.cmml"><msub id="S4.E9.m1.1.1.1.1.4" xref="S4.E9.m1.1.1.1.1.4.cmml"><mi id="S4.E9.m1.1.1.1.1.4.2" xref="S4.E9.m1.1.1.1.1.4.2.cmml">W</mi><msup id="S4.E9.m1.1.1.1.1.4.3" xref="S4.E9.m1.1.1.1.1.4.3.cmml"><mi id="S4.E9.m1.1.1.1.1.4.3.2" xref="S4.E9.m1.1.1.1.1.4.3.2.cmml">o</mi><mo id="S4.E9.m1.1.1.1.1.4.3.3" xref="S4.E9.m1.1.1.1.1.4.3.3.cmml">′</mo></msup></msub><mo id="S4.E9.m1.1.1.1.1.3" xref="S4.E9.m1.1.1.1.1.3.cmml">=</mo><mrow id="S4.E9.m1.1.1.1.1.2" xref="S4.E9.m1.1.1.1.1.2.cmml"><msub id="S4.E9.m1.1.1.1.1.1.1" xref="S4.E9.m1.1.1.1.1.1.1.cmml"><mrow id="S4.E9.m1.1.1.1.1.1.1.1.1" xref="S4.E9.m1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.E9.m1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.E9.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msup id="S4.E9.m1.1.1.1.1.1.1.1.1.1" xref="S4.E9.m1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E9.m1.1.1.1.1.1.1.1.1.1.2" xref="S4.E9.m1.1.1.1.1.1.1.1.1.1.2.cmml">U</mi><mo id="S4.E9.m1.1.1.1.1.1.1.1.1.1.3" xref="S4.E9.m1.1.1.1.1.1.1.1.1.1.3.cmml">⊤</mo></msup><mo id="S4.E9.m1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.E9.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mrow id="S4.E9.m1.1.1.1.1.1.1.3" xref="S4.E9.m1.1.1.1.1.1.1.3.cmml"><msub id="S4.E9.m1.1.1.1.1.1.1.3.2" xref="S4.E9.m1.1.1.1.1.1.1.3.2.cmml"><mi id="S4.E9.m1.1.1.1.1.1.1.3.2.2" xref="S4.E9.m1.1.1.1.1.1.1.3.2.2.cmml">d</mi><mi id="S4.E9.m1.1.1.1.1.1.1.3.2.3" xref="S4.E9.m1.1.1.1.1.1.1.3.2.3.cmml">c</mi></msub><mo id="S4.E9.m1.1.1.1.1.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="S4.E9.m1.1.1.1.1.1.1.3.1.cmml">×</mo><mi id="S4.E9.m1.1.1.1.1.1.1.3.3" xref="S4.E9.m1.1.1.1.1.1.1.3.3.cmml">D</mi></mrow></msub><mo id="S4.E9.m1.1.1.1.1.2.3" xref="S4.E9.m1.1.1.1.1.2.3.cmml">⁢</mo><msub id="S4.E9.m1.1.1.1.1.2.2" xref="S4.E9.m1.1.1.1.1.2.2.cmml"><mrow id="S4.E9.m1.1.1.1.1.2.2.1.1" xref="S4.E9.m1.1.1.1.1.2.2.1.1.1.cmml"><mo id="S4.E9.m1.1.1.1.1.2.2.1.1.2" stretchy="false" xref="S4.E9.m1.1.1.1.1.2.2.1.1.1.cmml">(</mo><msub id="S4.E9.m1.1.1.1.1.2.2.1.1.1" xref="S4.E9.m1.1.1.1.1.2.2.1.1.1.cmml"><mi id="S4.E9.m1.1.1.1.1.2.2.1.1.1.2" xref="S4.E9.m1.1.1.1.1.2.2.1.1.1.2.cmml">W</mi><mi id="S4.E9.m1.1.1.1.1.2.2.1.1.1.3" xref="S4.E9.m1.1.1.1.1.2.2.1.1.1.3.cmml">o</mi></msub><mo id="S4.E9.m1.1.1.1.1.2.2.1.1.3" stretchy="false" xref="S4.E9.m1.1.1.1.1.2.2.1.1.1.cmml">)</mo></mrow><mrow id="S4.E9.m1.1.1.1.1.2.2.3" xref="S4.E9.m1.1.1.1.1.2.2.3.cmml"><mi id="S4.E9.m1.1.1.1.1.2.2.3.2" xref="S4.E9.m1.1.1.1.1.2.2.3.2.cmml">D</mi><mo id="S4.E9.m1.1.1.1.1.2.2.3.1" lspace="0.222em" rspace="0.222em" xref="S4.E9.m1.1.1.1.1.2.2.3.1.cmml">×</mo><mi id="S4.E9.m1.1.1.1.1.2.2.3.3" xref="S4.E9.m1.1.1.1.1.2.2.3.3.cmml">D</mi></mrow></msub></mrow></mrow><mo id="S4.E9.m1.1.1.1.2" xref="S4.E9.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E9.m1.1b"><apply id="S4.E9.m1.1.1.1.1.cmml" xref="S4.E9.m1.1.1.1"><eq id="S4.E9.m1.1.1.1.1.3.cmml" xref="S4.E9.m1.1.1.1.1.3"></eq><apply id="S4.E9.m1.1.1.1.1.4.cmml" xref="S4.E9.m1.1.1.1.1.4"><csymbol cd="ambiguous" id="S4.E9.m1.1.1.1.1.4.1.cmml" xref="S4.E9.m1.1.1.1.1.4">subscript</csymbol><ci id="S4.E9.m1.1.1.1.1.4.2.cmml" xref="S4.E9.m1.1.1.1.1.4.2">𝑊</ci><apply id="S4.E9.m1.1.1.1.1.4.3.cmml" xref="S4.E9.m1.1.1.1.1.4.3"><csymbol cd="ambiguous" id="S4.E9.m1.1.1.1.1.4.3.1.cmml" xref="S4.E9.m1.1.1.1.1.4.3">superscript</csymbol><ci id="S4.E9.m1.1.1.1.1.4.3.2.cmml" xref="S4.E9.m1.1.1.1.1.4.3.2">𝑜</ci><ci id="S4.E9.m1.1.1.1.1.4.3.3.cmml" xref="S4.E9.m1.1.1.1.1.4.3.3">′</ci></apply></apply><apply id="S4.E9.m1.1.1.1.1.2.cmml" xref="S4.E9.m1.1.1.1.1.2"><times id="S4.E9.m1.1.1.1.1.2.3.cmml" xref="S4.E9.m1.1.1.1.1.2.3"></times><apply id="S4.E9.m1.1.1.1.1.1.1.cmml" xref="S4.E9.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E9.m1.1.1.1.1.1.1.2.cmml" xref="S4.E9.m1.1.1.1.1.1.1">subscript</csymbol><apply id="S4.E9.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E9.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E9.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E9.m1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S4.E9.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E9.m1.1.1.1.1.1.1.1.1.1.2">𝑈</ci><csymbol cd="latexml" id="S4.E9.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E9.m1.1.1.1.1.1.1.1.1.1.3">top</csymbol></apply><apply id="S4.E9.m1.1.1.1.1.1.1.3.cmml" xref="S4.E9.m1.1.1.1.1.1.1.3"><times id="S4.E9.m1.1.1.1.1.1.1.3.1.cmml" xref="S4.E9.m1.1.1.1.1.1.1.3.1"></times><apply id="S4.E9.m1.1.1.1.1.1.1.3.2.cmml" xref="S4.E9.m1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S4.E9.m1.1.1.1.1.1.1.3.2.1.cmml" xref="S4.E9.m1.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="S4.E9.m1.1.1.1.1.1.1.3.2.2.cmml" xref="S4.E9.m1.1.1.1.1.1.1.3.2.2">𝑑</ci><ci id="S4.E9.m1.1.1.1.1.1.1.3.2.3.cmml" xref="S4.E9.m1.1.1.1.1.1.1.3.2.3">𝑐</ci></apply><ci id="S4.E9.m1.1.1.1.1.1.1.3.3.cmml" xref="S4.E9.m1.1.1.1.1.1.1.3.3">𝐷</ci></apply></apply><apply id="S4.E9.m1.1.1.1.1.2.2.cmml" xref="S4.E9.m1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S4.E9.m1.1.1.1.1.2.2.2.cmml" xref="S4.E9.m1.1.1.1.1.2.2">subscript</csymbol><apply id="S4.E9.m1.1.1.1.1.2.2.1.1.1.cmml" xref="S4.E9.m1.1.1.1.1.2.2.1.1"><csymbol cd="ambiguous" id="S4.E9.m1.1.1.1.1.2.2.1.1.1.1.cmml" xref="S4.E9.m1.1.1.1.1.2.2.1.1">subscript</csymbol><ci id="S4.E9.m1.1.1.1.1.2.2.1.1.1.2.cmml" xref="S4.E9.m1.1.1.1.1.2.2.1.1.1.2">𝑊</ci><ci id="S4.E9.m1.1.1.1.1.2.2.1.1.1.3.cmml" xref="S4.E9.m1.1.1.1.1.2.2.1.1.1.3">𝑜</ci></apply><apply id="S4.E9.m1.1.1.1.1.2.2.3.cmml" xref="S4.E9.m1.1.1.1.1.2.2.3"><times id="S4.E9.m1.1.1.1.1.2.2.3.1.cmml" xref="S4.E9.m1.1.1.1.1.2.2.3.1"></times><ci id="S4.E9.m1.1.1.1.1.2.2.3.2.cmml" xref="S4.E9.m1.1.1.1.1.2.2.3.2">𝐷</ci><ci id="S4.E9.m1.1.1.1.1.2.2.3.3.cmml" xref="S4.E9.m1.1.1.1.1.2.2.3.3">𝐷</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E9.m1.1c">W_{o^{\prime}}=(U^{\top})_{d_{c}\times D}(W_{o})_{D\times D},</annotation><annotation encoding="application/x-llamapun" id="S4.E9.m1.1d">italic_W start_POSTSUBSCRIPT italic_o start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT end_POSTSUBSCRIPT = ( italic_U start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT ) start_POSTSUBSCRIPT italic_d start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT × italic_D end_POSTSUBSCRIPT ( italic_W start_POSTSUBSCRIPT italic_o end_POSTSUBSCRIPT ) start_POSTSUBSCRIPT italic_D × italic_D end_POSTSUBSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS1.p9.3">resulting in an updated output matrix <math alttext="W_{o^{\prime}}\in\mathbb{R}^{d_{c}\times D}" class="ltx_Math" display="inline" id="S4.SS1.p9.3.m1.1"><semantics id="S4.SS1.p9.3.m1.1a"><mrow id="S4.SS1.p9.3.m1.1.1" xref="S4.SS1.p9.3.m1.1.1.cmml"><msub id="S4.SS1.p9.3.m1.1.1.2" xref="S4.SS1.p9.3.m1.1.1.2.cmml"><mi id="S4.SS1.p9.3.m1.1.1.2.2" xref="S4.SS1.p9.3.m1.1.1.2.2.cmml">W</mi><msup id="S4.SS1.p9.3.m1.1.1.2.3" xref="S4.SS1.p9.3.m1.1.1.2.3.cmml"><mi id="S4.SS1.p9.3.m1.1.1.2.3.2" xref="S4.SS1.p9.3.m1.1.1.2.3.2.cmml">o</mi><mo id="S4.SS1.p9.3.m1.1.1.2.3.3" xref="S4.SS1.p9.3.m1.1.1.2.3.3.cmml">′</mo></msup></msub><mo id="S4.SS1.p9.3.m1.1.1.1" xref="S4.SS1.p9.3.m1.1.1.1.cmml">∈</mo><msup id="S4.SS1.p9.3.m1.1.1.3" xref="S4.SS1.p9.3.m1.1.1.3.cmml"><mi id="S4.SS1.p9.3.m1.1.1.3.2" xref="S4.SS1.p9.3.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S4.SS1.p9.3.m1.1.1.3.3" xref="S4.SS1.p9.3.m1.1.1.3.3.cmml"><msub id="S4.SS1.p9.3.m1.1.1.3.3.2" xref="S4.SS1.p9.3.m1.1.1.3.3.2.cmml"><mi id="S4.SS1.p9.3.m1.1.1.3.3.2.2" xref="S4.SS1.p9.3.m1.1.1.3.3.2.2.cmml">d</mi><mi id="S4.SS1.p9.3.m1.1.1.3.3.2.3" xref="S4.SS1.p9.3.m1.1.1.3.3.2.3.cmml">c</mi></msub><mo id="S4.SS1.p9.3.m1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S4.SS1.p9.3.m1.1.1.3.3.1.cmml">×</mo><mi id="S4.SS1.p9.3.m1.1.1.3.3.3" xref="S4.SS1.p9.3.m1.1.1.3.3.3.cmml">D</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p9.3.m1.1b"><apply id="S4.SS1.p9.3.m1.1.1.cmml" xref="S4.SS1.p9.3.m1.1.1"><in id="S4.SS1.p9.3.m1.1.1.1.cmml" xref="S4.SS1.p9.3.m1.1.1.1"></in><apply id="S4.SS1.p9.3.m1.1.1.2.cmml" xref="S4.SS1.p9.3.m1.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p9.3.m1.1.1.2.1.cmml" xref="S4.SS1.p9.3.m1.1.1.2">subscript</csymbol><ci id="S4.SS1.p9.3.m1.1.1.2.2.cmml" xref="S4.SS1.p9.3.m1.1.1.2.2">𝑊</ci><apply id="S4.SS1.p9.3.m1.1.1.2.3.cmml" xref="S4.SS1.p9.3.m1.1.1.2.3"><csymbol cd="ambiguous" id="S4.SS1.p9.3.m1.1.1.2.3.1.cmml" xref="S4.SS1.p9.3.m1.1.1.2.3">superscript</csymbol><ci id="S4.SS1.p9.3.m1.1.1.2.3.2.cmml" xref="S4.SS1.p9.3.m1.1.1.2.3.2">𝑜</ci><ci id="S4.SS1.p9.3.m1.1.1.2.3.3.cmml" xref="S4.SS1.p9.3.m1.1.1.2.3.3">′</ci></apply></apply><apply id="S4.SS1.p9.3.m1.1.1.3.cmml" xref="S4.SS1.p9.3.m1.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p9.3.m1.1.1.3.1.cmml" xref="S4.SS1.p9.3.m1.1.1.3">superscript</csymbol><ci id="S4.SS1.p9.3.m1.1.1.3.2.cmml" xref="S4.SS1.p9.3.m1.1.1.3.2">ℝ</ci><apply id="S4.SS1.p9.3.m1.1.1.3.3.cmml" xref="S4.SS1.p9.3.m1.1.1.3.3"><times id="S4.SS1.p9.3.m1.1.1.3.3.1.cmml" xref="S4.SS1.p9.3.m1.1.1.3.3.1"></times><apply id="S4.SS1.p9.3.m1.1.1.3.3.2.cmml" xref="S4.SS1.p9.3.m1.1.1.3.3.2"><csymbol cd="ambiguous" id="S4.SS1.p9.3.m1.1.1.3.3.2.1.cmml" xref="S4.SS1.p9.3.m1.1.1.3.3.2">subscript</csymbol><ci id="S4.SS1.p9.3.m1.1.1.3.3.2.2.cmml" xref="S4.SS1.p9.3.m1.1.1.3.3.2.2">𝑑</ci><ci id="S4.SS1.p9.3.m1.1.1.3.3.2.3.cmml" xref="S4.SS1.p9.3.m1.1.1.3.3.2.3">𝑐</ci></apply><ci id="S4.SS1.p9.3.m1.1.1.3.3.3.cmml" xref="S4.SS1.p9.3.m1.1.1.3.3.3">𝐷</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p9.3.m1.1c">W_{o^{\prime}}\in\mathbb{R}^{d_{c}\times D}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p9.3.m1.1d">italic_W start_POSTSUBSCRIPT italic_o start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT × italic_D end_POSTSUPERSCRIPT</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S4.SS1.p10">
<p class="ltx_p" id="S4.SS1.p10.3"><span class="ltx_text ltx_font_bold" id="S4.SS1.p10.3.1">Compression Ratio:</span>
The compression strategy effectively reduces the dimensions from <math alttext="N\times d\times h" class="ltx_Math" display="inline" id="S4.SS1.p10.1.m1.1"><semantics id="S4.SS1.p10.1.m1.1a"><mrow id="S4.SS1.p10.1.m1.1.1" xref="S4.SS1.p10.1.m1.1.1.cmml"><mi id="S4.SS1.p10.1.m1.1.1.2" xref="S4.SS1.p10.1.m1.1.1.2.cmml">N</mi><mo id="S4.SS1.p10.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.SS1.p10.1.m1.1.1.1.cmml">×</mo><mi id="S4.SS1.p10.1.m1.1.1.3" xref="S4.SS1.p10.1.m1.1.1.3.cmml">d</mi><mo id="S4.SS1.p10.1.m1.1.1.1a" lspace="0.222em" rspace="0.222em" xref="S4.SS1.p10.1.m1.1.1.1.cmml">×</mo><mi id="S4.SS1.p10.1.m1.1.1.4" xref="S4.SS1.p10.1.m1.1.1.4.cmml">h</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p10.1.m1.1b"><apply id="S4.SS1.p10.1.m1.1.1.cmml" xref="S4.SS1.p10.1.m1.1.1"><times id="S4.SS1.p10.1.m1.1.1.1.cmml" xref="S4.SS1.p10.1.m1.1.1.1"></times><ci id="S4.SS1.p10.1.m1.1.1.2.cmml" xref="S4.SS1.p10.1.m1.1.1.2">𝑁</ci><ci id="S4.SS1.p10.1.m1.1.1.3.cmml" xref="S4.SS1.p10.1.m1.1.1.3">𝑑</ci><ci id="S4.SS1.p10.1.m1.1.1.4.cmml" xref="S4.SS1.p10.1.m1.1.1.4">ℎ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p10.1.m1.1c">N\times d\times h</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p10.1.m1.1d">italic_N × italic_d × italic_h</annotation></semantics></math> for both keys and values to <math alttext="N\times d_{c}" class="ltx_Math" display="inline" id="S4.SS1.p10.2.m2.1"><semantics id="S4.SS1.p10.2.m2.1a"><mrow id="S4.SS1.p10.2.m2.1.1" xref="S4.SS1.p10.2.m2.1.1.cmml"><mi id="S4.SS1.p10.2.m2.1.1.2" xref="S4.SS1.p10.2.m2.1.1.2.cmml">N</mi><mo id="S4.SS1.p10.2.m2.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.SS1.p10.2.m2.1.1.1.cmml">×</mo><msub id="S4.SS1.p10.2.m2.1.1.3" xref="S4.SS1.p10.2.m2.1.1.3.cmml"><mi id="S4.SS1.p10.2.m2.1.1.3.2" xref="S4.SS1.p10.2.m2.1.1.3.2.cmml">d</mi><mi id="S4.SS1.p10.2.m2.1.1.3.3" xref="S4.SS1.p10.2.m2.1.1.3.3.cmml">c</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p10.2.m2.1b"><apply id="S4.SS1.p10.2.m2.1.1.cmml" xref="S4.SS1.p10.2.m2.1.1"><times id="S4.SS1.p10.2.m2.1.1.1.cmml" xref="S4.SS1.p10.2.m2.1.1.1"></times><ci id="S4.SS1.p10.2.m2.1.1.2.cmml" xref="S4.SS1.p10.2.m2.1.1.2">𝑁</ci><apply id="S4.SS1.p10.2.m2.1.1.3.cmml" xref="S4.SS1.p10.2.m2.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p10.2.m2.1.1.3.1.cmml" xref="S4.SS1.p10.2.m2.1.1.3">subscript</csymbol><ci id="S4.SS1.p10.2.m2.1.1.3.2.cmml" xref="S4.SS1.p10.2.m2.1.1.3.2">𝑑</ci><ci id="S4.SS1.p10.2.m2.1.1.3.3.cmml" xref="S4.SS1.p10.2.m2.1.1.3.3">𝑐</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p10.2.m2.1c">N\times d_{c}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p10.2.m2.1d">italic_N × italic_d start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT</annotation></semantics></math>, ensuring data integrity and minimizing overhead. This results in a layer compression ratio <math alttext="\rho=\frac{d_{c}}{h\times d}" class="ltx_Math" display="inline" id="S4.SS1.p10.3.m3.1"><semantics id="S4.SS1.p10.3.m3.1a"><mrow id="S4.SS1.p10.3.m3.1.1" xref="S4.SS1.p10.3.m3.1.1.cmml"><mi id="S4.SS1.p10.3.m3.1.1.2" xref="S4.SS1.p10.3.m3.1.1.2.cmml">ρ</mi><mo id="S4.SS1.p10.3.m3.1.1.1" xref="S4.SS1.p10.3.m3.1.1.1.cmml">=</mo><mfrac id="S4.SS1.p10.3.m3.1.1.3" xref="S4.SS1.p10.3.m3.1.1.3.cmml"><msub id="S4.SS1.p10.3.m3.1.1.3.2" xref="S4.SS1.p10.3.m3.1.1.3.2.cmml"><mi id="S4.SS1.p10.3.m3.1.1.3.2.2" xref="S4.SS1.p10.3.m3.1.1.3.2.2.cmml">d</mi><mi id="S4.SS1.p10.3.m3.1.1.3.2.3" xref="S4.SS1.p10.3.m3.1.1.3.2.3.cmml">c</mi></msub><mrow id="S4.SS1.p10.3.m3.1.1.3.3" xref="S4.SS1.p10.3.m3.1.1.3.3.cmml"><mi id="S4.SS1.p10.3.m3.1.1.3.3.2" xref="S4.SS1.p10.3.m3.1.1.3.3.2.cmml">h</mi><mo id="S4.SS1.p10.3.m3.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S4.SS1.p10.3.m3.1.1.3.3.1.cmml">×</mo><mi id="S4.SS1.p10.3.m3.1.1.3.3.3" xref="S4.SS1.p10.3.m3.1.1.3.3.3.cmml">d</mi></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p10.3.m3.1b"><apply id="S4.SS1.p10.3.m3.1.1.cmml" xref="S4.SS1.p10.3.m3.1.1"><eq id="S4.SS1.p10.3.m3.1.1.1.cmml" xref="S4.SS1.p10.3.m3.1.1.1"></eq><ci id="S4.SS1.p10.3.m3.1.1.2.cmml" xref="S4.SS1.p10.3.m3.1.1.2">𝜌</ci><apply id="S4.SS1.p10.3.m3.1.1.3.cmml" xref="S4.SS1.p10.3.m3.1.1.3"><divide id="S4.SS1.p10.3.m3.1.1.3.1.cmml" xref="S4.SS1.p10.3.m3.1.1.3"></divide><apply id="S4.SS1.p10.3.m3.1.1.3.2.cmml" xref="S4.SS1.p10.3.m3.1.1.3.2"><csymbol cd="ambiguous" id="S4.SS1.p10.3.m3.1.1.3.2.1.cmml" xref="S4.SS1.p10.3.m3.1.1.3.2">subscript</csymbol><ci id="S4.SS1.p10.3.m3.1.1.3.2.2.cmml" xref="S4.SS1.p10.3.m3.1.1.3.2.2">𝑑</ci><ci id="S4.SS1.p10.3.m3.1.1.3.2.3.cmml" xref="S4.SS1.p10.3.m3.1.1.3.2.3">𝑐</ci></apply><apply id="S4.SS1.p10.3.m3.1.1.3.3.cmml" xref="S4.SS1.p10.3.m3.1.1.3.3"><times id="S4.SS1.p10.3.m3.1.1.3.3.1.cmml" xref="S4.SS1.p10.3.m3.1.1.3.3.1"></times><ci id="S4.SS1.p10.3.m3.1.1.3.3.2.cmml" xref="S4.SS1.p10.3.m3.1.1.3.3.2">ℎ</ci><ci id="S4.SS1.p10.3.m3.1.1.3.3.3.cmml" xref="S4.SS1.p10.3.m3.1.1.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p10.3.m3.1c">\rho=\frac{d_{c}}{h\times d}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p10.3.m3.1d">italic_ρ = divide start_ARG italic_d start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT end_ARG start_ARG italic_h × italic_d end_ARG</annotation></semantics></math>, which quantifies the extent of the reduction.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Progressive Compression Strategy</h3>
<figure class="ltx_float ltx_minipage ltx_align_top ltx_framed ltx_framed_top" id="alg1" style="width:199.5pt;">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="alg1.3.1.1">Algorithm 1</span> </span> <span class="ltx_text ltx_font_smallcaps" id="alg1.4.2">LoRC</span> Algorithm</figcaption>
<div class="ltx_listing ltx_listing" id="alg1.5">
<div class="ltx_listingline" id="alg1.l1">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l1.1.1.1" style="font-size:80%;">1:</span></span><span class="ltx_text" id="alg1.l1.2" style="font-size:90%;">Pre-trained LLM with </span><math alttext="L" class="ltx_Math" display="inline" id="alg1.l1.m1.1"><semantics id="alg1.l1.m1.1a"><mi id="alg1.l1.m1.1.1" mathsize="90%" xref="alg1.l1.m1.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m1.1b"><ci id="alg1.l1.m1.1.1.cmml" xref="alg1.l1.m1.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m1.1c">L</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m1.1d">italic_L</annotation></semantics></math><span class="ltx_text" id="alg1.l1.3" style="font-size:90%;"> layers
</span>
</div>
<div class="ltx_listingline" id="alg1.l2">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l2.1.1.1" style="font-size:80%;">2:</span></span><span class="ltx_text ltx_font_bold" id="alg1.l2.2" style="font-size:90%;">Initialize</span><span class="ltx_text" id="alg1.l2.3" style="font-size:90%;"> cumulative condition numbers </span><math alttext="\tilde{\kappa}_{l}" class="ltx_Math" display="inline" id="alg1.l2.m1.1"><semantics id="alg1.l2.m1.1a"><msub id="alg1.l2.m1.1.1" xref="alg1.l2.m1.1.1.cmml"><mover accent="true" id="alg1.l2.m1.1.1.2" xref="alg1.l2.m1.1.1.2.cmml"><mi id="alg1.l2.m1.1.1.2.2" mathsize="90%" xref="alg1.l2.m1.1.1.2.2.cmml">κ</mi><mo id="alg1.l2.m1.1.1.2.1" mathsize="90%" xref="alg1.l2.m1.1.1.2.1.cmml">~</mo></mover><mi id="alg1.l2.m1.1.1.3" mathsize="90%" xref="alg1.l2.m1.1.1.3.cmml">l</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l2.m1.1b"><apply id="alg1.l2.m1.1.1.cmml" xref="alg1.l2.m1.1.1"><csymbol cd="ambiguous" id="alg1.l2.m1.1.1.1.cmml" xref="alg1.l2.m1.1.1">subscript</csymbol><apply id="alg1.l2.m1.1.1.2.cmml" xref="alg1.l2.m1.1.1.2"><ci id="alg1.l2.m1.1.1.2.1.cmml" xref="alg1.l2.m1.1.1.2.1">~</ci><ci id="alg1.l2.m1.1.1.2.2.cmml" xref="alg1.l2.m1.1.1.2.2">𝜅</ci></apply><ci id="alg1.l2.m1.1.1.3.cmml" xref="alg1.l2.m1.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m1.1c">\tilde{\kappa}_{l}</annotation><annotation encoding="application/x-llamapun" id="alg1.l2.m1.1d">over~ start_ARG italic_κ end_ARG start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT</annotation></semantics></math><span class="ltx_text" id="alg1.l2.4" style="font-size:90%;">
</span>
</div>
<div class="ltx_listingline" id="alg1.l3">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l3.1.1.1" style="font-size:80%;">3:</span></span><span class="ltx_text ltx_font_bold" id="alg1.l3.2" style="font-size:90%;">for</span><span class="ltx_text" id="alg1.l3.3" style="font-size:90%;"> </span><math alttext="l=L" class="ltx_Math" display="inline" id="alg1.l3.m1.1"><semantics id="alg1.l3.m1.1a"><mrow id="alg1.l3.m1.1.1" xref="alg1.l3.m1.1.1.cmml"><mi id="alg1.l3.m1.1.1.2" mathsize="90%" xref="alg1.l3.m1.1.1.2.cmml">l</mi><mo id="alg1.l3.m1.1.1.1" mathsize="90%" xref="alg1.l3.m1.1.1.1.cmml">=</mo><mi id="alg1.l3.m1.1.1.3" mathsize="90%" xref="alg1.l3.m1.1.1.3.cmml">L</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l3.m1.1b"><apply id="alg1.l3.m1.1.1.cmml" xref="alg1.l3.m1.1.1"><eq id="alg1.l3.m1.1.1.1.cmml" xref="alg1.l3.m1.1.1.1"></eq><ci id="alg1.l3.m1.1.1.2.cmml" xref="alg1.l3.m1.1.1.2">𝑙</ci><ci id="alg1.l3.m1.1.1.3.cmml" xref="alg1.l3.m1.1.1.3">𝐿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m1.1c">l=L</annotation><annotation encoding="application/x-llamapun" id="alg1.l3.m1.1d">italic_l = italic_L</annotation></semantics></math><span class="ltx_text" id="alg1.l3.4" style="font-size:90%;"> </span><span class="ltx_text ltx_font_bold" id="alg1.l3.5" style="font-size:90%;">to</span><span class="ltx_text" id="alg1.l3.6" style="font-size:90%;"> </span><math alttext="1" class="ltx_Math" display="inline" id="alg1.l3.m2.1"><semantics id="alg1.l3.m2.1a"><mn id="alg1.l3.m2.1.1" mathsize="90%" xref="alg1.l3.m2.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="alg1.l3.m2.1b"><cn id="alg1.l3.m2.1.1.cmml" type="integer" xref="alg1.l3.m2.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m2.1c">1</annotation><annotation encoding="application/x-llamapun" id="alg1.l3.m2.1d">1</annotation></semantics></math><span class="ltx_text" id="alg1.l3.7" style="font-size:90%;"> </span><span class="ltx_text ltx_font_bold" id="alg1.l3.8" style="font-size:90%;">do</span><span class="ltx_text" id="alg1.l3.9" style="font-size:90%;">
</span>
</div>
<div class="ltx_listingline" id="alg1.l4">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l4.1.1.1" style="font-size:80%;">4:</span></span><span class="ltx_text" id="alg1.l4.2" style="font-size:90%;">    Compute </span><math alttext="\kappa(W^{l}_{k})" class="ltx_Math" display="inline" id="alg1.l4.m1.1"><semantics id="alg1.l4.m1.1a"><mrow id="alg1.l4.m1.1.1" xref="alg1.l4.m1.1.1.cmml"><mi id="alg1.l4.m1.1.1.3" mathsize="90%" xref="alg1.l4.m1.1.1.3.cmml">κ</mi><mo id="alg1.l4.m1.1.1.2" xref="alg1.l4.m1.1.1.2.cmml">⁢</mo><mrow id="alg1.l4.m1.1.1.1.1" xref="alg1.l4.m1.1.1.1.1.1.cmml"><mo id="alg1.l4.m1.1.1.1.1.2" maxsize="90%" minsize="90%" xref="alg1.l4.m1.1.1.1.1.1.cmml">(</mo><msubsup id="alg1.l4.m1.1.1.1.1.1" xref="alg1.l4.m1.1.1.1.1.1.cmml"><mi id="alg1.l4.m1.1.1.1.1.1.2.2" mathsize="90%" xref="alg1.l4.m1.1.1.1.1.1.2.2.cmml">W</mi><mi id="alg1.l4.m1.1.1.1.1.1.3" mathsize="90%" xref="alg1.l4.m1.1.1.1.1.1.3.cmml">k</mi><mi id="alg1.l4.m1.1.1.1.1.1.2.3" mathsize="90%" xref="alg1.l4.m1.1.1.1.1.1.2.3.cmml">l</mi></msubsup><mo id="alg1.l4.m1.1.1.1.1.3" maxsize="90%" minsize="90%" xref="alg1.l4.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l4.m1.1b"><apply id="alg1.l4.m1.1.1.cmml" xref="alg1.l4.m1.1.1"><times id="alg1.l4.m1.1.1.2.cmml" xref="alg1.l4.m1.1.1.2"></times><ci id="alg1.l4.m1.1.1.3.cmml" xref="alg1.l4.m1.1.1.3">𝜅</ci><apply id="alg1.l4.m1.1.1.1.1.1.cmml" xref="alg1.l4.m1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l4.m1.1.1.1.1.1.1.cmml" xref="alg1.l4.m1.1.1.1.1">subscript</csymbol><apply id="alg1.l4.m1.1.1.1.1.1.2.cmml" xref="alg1.l4.m1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l4.m1.1.1.1.1.1.2.1.cmml" xref="alg1.l4.m1.1.1.1.1">superscript</csymbol><ci id="alg1.l4.m1.1.1.1.1.1.2.2.cmml" xref="alg1.l4.m1.1.1.1.1.1.2.2">𝑊</ci><ci id="alg1.l4.m1.1.1.1.1.1.2.3.cmml" xref="alg1.l4.m1.1.1.1.1.1.2.3">𝑙</ci></apply><ci id="alg1.l4.m1.1.1.1.1.1.3.cmml" xref="alg1.l4.m1.1.1.1.1.1.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m1.1c">\kappa(W^{l}_{k})</annotation><annotation encoding="application/x-llamapun" id="alg1.l4.m1.1d">italic_κ ( italic_W start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT )</annotation></semantics></math><span class="ltx_text" id="alg1.l4.3" style="font-size:90%;"> and </span><math alttext="\kappa(W^{l}_{v})" class="ltx_Math" display="inline" id="alg1.l4.m2.1"><semantics id="alg1.l4.m2.1a"><mrow id="alg1.l4.m2.1.1" xref="alg1.l4.m2.1.1.cmml"><mi id="alg1.l4.m2.1.1.3" mathsize="90%" xref="alg1.l4.m2.1.1.3.cmml">κ</mi><mo id="alg1.l4.m2.1.1.2" xref="alg1.l4.m2.1.1.2.cmml">⁢</mo><mrow id="alg1.l4.m2.1.1.1.1" xref="alg1.l4.m2.1.1.1.1.1.cmml"><mo id="alg1.l4.m2.1.1.1.1.2" maxsize="90%" minsize="90%" xref="alg1.l4.m2.1.1.1.1.1.cmml">(</mo><msubsup id="alg1.l4.m2.1.1.1.1.1" xref="alg1.l4.m2.1.1.1.1.1.cmml"><mi id="alg1.l4.m2.1.1.1.1.1.2.2" mathsize="90%" xref="alg1.l4.m2.1.1.1.1.1.2.2.cmml">W</mi><mi id="alg1.l4.m2.1.1.1.1.1.3" mathsize="90%" xref="alg1.l4.m2.1.1.1.1.1.3.cmml">v</mi><mi id="alg1.l4.m2.1.1.1.1.1.2.3" mathsize="90%" xref="alg1.l4.m2.1.1.1.1.1.2.3.cmml">l</mi></msubsup><mo id="alg1.l4.m2.1.1.1.1.3" maxsize="90%" minsize="90%" xref="alg1.l4.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l4.m2.1b"><apply id="alg1.l4.m2.1.1.cmml" xref="alg1.l4.m2.1.1"><times id="alg1.l4.m2.1.1.2.cmml" xref="alg1.l4.m2.1.1.2"></times><ci id="alg1.l4.m2.1.1.3.cmml" xref="alg1.l4.m2.1.1.3">𝜅</ci><apply id="alg1.l4.m2.1.1.1.1.1.cmml" xref="alg1.l4.m2.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l4.m2.1.1.1.1.1.1.cmml" xref="alg1.l4.m2.1.1.1.1">subscript</csymbol><apply id="alg1.l4.m2.1.1.1.1.1.2.cmml" xref="alg1.l4.m2.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l4.m2.1.1.1.1.1.2.1.cmml" xref="alg1.l4.m2.1.1.1.1">superscript</csymbol><ci id="alg1.l4.m2.1.1.1.1.1.2.2.cmml" xref="alg1.l4.m2.1.1.1.1.1.2.2">𝑊</ci><ci id="alg1.l4.m2.1.1.1.1.1.2.3.cmml" xref="alg1.l4.m2.1.1.1.1.1.2.3">𝑙</ci></apply><ci id="alg1.l4.m2.1.1.1.1.1.3.cmml" xref="alg1.l4.m2.1.1.1.1.1.3">𝑣</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m2.1c">\kappa(W^{l}_{v})</annotation><annotation encoding="application/x-llamapun" id="alg1.l4.m2.1d">italic_κ ( italic_W start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT )</annotation></semantics></math><span class="ltx_text" id="alg1.l4.4" style="font-size:90%;">
</span>
</div>
<div class="ltx_listingline" id="alg1.l5">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l5.1.1.1" style="font-size:80%;">5:</span></span><span class="ltx_text" id="alg1.l5.2" style="font-size:90%;">    </span><math alttext="\tilde{\kappa}_{l}\leftarrow\prod_{j=l}^{L}\kappa(W^{j}_{k})\cdot\kappa(W^{j}_%
{v})" class="ltx_Math" display="inline" id="alg1.l5.m1.2"><semantics id="alg1.l5.m1.2a"><mrow id="alg1.l5.m1.2.2" xref="alg1.l5.m1.2.2.cmml"><msub id="alg1.l5.m1.2.2.4" xref="alg1.l5.m1.2.2.4.cmml"><mover accent="true" id="alg1.l5.m1.2.2.4.2" xref="alg1.l5.m1.2.2.4.2.cmml"><mi id="alg1.l5.m1.2.2.4.2.2" mathsize="90%" xref="alg1.l5.m1.2.2.4.2.2.cmml">κ</mi><mo id="alg1.l5.m1.2.2.4.2.1" mathsize="90%" xref="alg1.l5.m1.2.2.4.2.1.cmml">~</mo></mover><mi id="alg1.l5.m1.2.2.4.3" mathsize="90%" xref="alg1.l5.m1.2.2.4.3.cmml">l</mi></msub><mo id="alg1.l5.m1.2.2.3" mathsize="90%" rspace="0.111em" stretchy="false" xref="alg1.l5.m1.2.2.3.cmml">←</mo><mrow id="alg1.l5.m1.2.2.2" xref="alg1.l5.m1.2.2.2.cmml"><msubsup id="alg1.l5.m1.2.2.2.3" xref="alg1.l5.m1.2.2.2.3.cmml"><mo id="alg1.l5.m1.2.2.2.3.2.2" maxsize="90%" minsize="90%" stretchy="true" xref="alg1.l5.m1.2.2.2.3.2.2.cmml">∏</mo><mrow id="alg1.l5.m1.2.2.2.3.2.3" xref="alg1.l5.m1.2.2.2.3.2.3.cmml"><mi id="alg1.l5.m1.2.2.2.3.2.3.2" mathsize="90%" xref="alg1.l5.m1.2.2.2.3.2.3.2.cmml">j</mi><mo id="alg1.l5.m1.2.2.2.3.2.3.1" mathsize="90%" xref="alg1.l5.m1.2.2.2.3.2.3.1.cmml">=</mo><mi id="alg1.l5.m1.2.2.2.3.2.3.3" mathsize="90%" xref="alg1.l5.m1.2.2.2.3.2.3.3.cmml">l</mi></mrow><mi id="alg1.l5.m1.2.2.2.3.3" mathsize="90%" xref="alg1.l5.m1.2.2.2.3.3.cmml">L</mi></msubsup><mrow id="alg1.l5.m1.2.2.2.2" xref="alg1.l5.m1.2.2.2.2.cmml"><mrow id="alg1.l5.m1.1.1.1.1.1" xref="alg1.l5.m1.1.1.1.1.1.cmml"><mrow id="alg1.l5.m1.1.1.1.1.1.1" xref="alg1.l5.m1.1.1.1.1.1.1.cmml"><mi id="alg1.l5.m1.1.1.1.1.1.1.3" mathsize="90%" xref="alg1.l5.m1.1.1.1.1.1.1.3.cmml">κ</mi><mo id="alg1.l5.m1.1.1.1.1.1.1.2" xref="alg1.l5.m1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="alg1.l5.m1.1.1.1.1.1.1.1.1" xref="alg1.l5.m1.1.1.1.1.1.1.1.1.1.cmml"><mo id="alg1.l5.m1.1.1.1.1.1.1.1.1.2" maxsize="90%" minsize="90%" xref="alg1.l5.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="alg1.l5.m1.1.1.1.1.1.1.1.1.1" xref="alg1.l5.m1.1.1.1.1.1.1.1.1.1.cmml"><mi id="alg1.l5.m1.1.1.1.1.1.1.1.1.1.2.2" mathsize="90%" xref="alg1.l5.m1.1.1.1.1.1.1.1.1.1.2.2.cmml">W</mi><mi id="alg1.l5.m1.1.1.1.1.1.1.1.1.1.3" mathsize="90%" xref="alg1.l5.m1.1.1.1.1.1.1.1.1.1.3.cmml">k</mi><mi id="alg1.l5.m1.1.1.1.1.1.1.1.1.1.2.3" mathsize="90%" xref="alg1.l5.m1.1.1.1.1.1.1.1.1.1.2.3.cmml">j</mi></msubsup><mo id="alg1.l5.m1.1.1.1.1.1.1.1.1.3" maxsize="90%" minsize="90%" rspace="0.055em" xref="alg1.l5.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="alg1.l5.m1.1.1.1.1.1.2" mathsize="90%" rspace="0.222em" xref="alg1.l5.m1.1.1.1.1.1.2.cmml">⋅</mo><mi id="alg1.l5.m1.1.1.1.1.1.3" mathsize="90%" xref="alg1.l5.m1.1.1.1.1.1.3.cmml">κ</mi></mrow><mo id="alg1.l5.m1.2.2.2.2.3" xref="alg1.l5.m1.2.2.2.2.3.cmml">⁢</mo><mrow id="alg1.l5.m1.2.2.2.2.2.1" xref="alg1.l5.m1.2.2.2.2.2.1.1.cmml"><mo id="alg1.l5.m1.2.2.2.2.2.1.2" maxsize="90%" minsize="90%" xref="alg1.l5.m1.2.2.2.2.2.1.1.cmml">(</mo><msubsup id="alg1.l5.m1.2.2.2.2.2.1.1" xref="alg1.l5.m1.2.2.2.2.2.1.1.cmml"><mi id="alg1.l5.m1.2.2.2.2.2.1.1.2.2" mathsize="90%" xref="alg1.l5.m1.2.2.2.2.2.1.1.2.2.cmml">W</mi><mi id="alg1.l5.m1.2.2.2.2.2.1.1.3" mathsize="90%" xref="alg1.l5.m1.2.2.2.2.2.1.1.3.cmml">v</mi><mi id="alg1.l5.m1.2.2.2.2.2.1.1.2.3" mathsize="90%" xref="alg1.l5.m1.2.2.2.2.2.1.1.2.3.cmml">j</mi></msubsup><mo id="alg1.l5.m1.2.2.2.2.2.1.3" maxsize="90%" minsize="90%" xref="alg1.l5.m1.2.2.2.2.2.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l5.m1.2b"><apply id="alg1.l5.m1.2.2.cmml" xref="alg1.l5.m1.2.2"><ci id="alg1.l5.m1.2.2.3.cmml" xref="alg1.l5.m1.2.2.3">←</ci><apply id="alg1.l5.m1.2.2.4.cmml" xref="alg1.l5.m1.2.2.4"><csymbol cd="ambiguous" id="alg1.l5.m1.2.2.4.1.cmml" xref="alg1.l5.m1.2.2.4">subscript</csymbol><apply id="alg1.l5.m1.2.2.4.2.cmml" xref="alg1.l5.m1.2.2.4.2"><ci id="alg1.l5.m1.2.2.4.2.1.cmml" xref="alg1.l5.m1.2.2.4.2.1">~</ci><ci id="alg1.l5.m1.2.2.4.2.2.cmml" xref="alg1.l5.m1.2.2.4.2.2">𝜅</ci></apply><ci id="alg1.l5.m1.2.2.4.3.cmml" xref="alg1.l5.m1.2.2.4.3">𝑙</ci></apply><apply id="alg1.l5.m1.2.2.2.cmml" xref="alg1.l5.m1.2.2.2"><apply id="alg1.l5.m1.2.2.2.3.cmml" xref="alg1.l5.m1.2.2.2.3"><csymbol cd="ambiguous" id="alg1.l5.m1.2.2.2.3.1.cmml" xref="alg1.l5.m1.2.2.2.3">superscript</csymbol><apply id="alg1.l5.m1.2.2.2.3.2.cmml" xref="alg1.l5.m1.2.2.2.3"><csymbol cd="ambiguous" id="alg1.l5.m1.2.2.2.3.2.1.cmml" xref="alg1.l5.m1.2.2.2.3">subscript</csymbol><csymbol cd="latexml" id="alg1.l5.m1.2.2.2.3.2.2.cmml" xref="alg1.l5.m1.2.2.2.3.2.2">product</csymbol><apply id="alg1.l5.m1.2.2.2.3.2.3.cmml" xref="alg1.l5.m1.2.2.2.3.2.3"><eq id="alg1.l5.m1.2.2.2.3.2.3.1.cmml" xref="alg1.l5.m1.2.2.2.3.2.3.1"></eq><ci id="alg1.l5.m1.2.2.2.3.2.3.2.cmml" xref="alg1.l5.m1.2.2.2.3.2.3.2">𝑗</ci><ci id="alg1.l5.m1.2.2.2.3.2.3.3.cmml" xref="alg1.l5.m1.2.2.2.3.2.3.3">𝑙</ci></apply></apply><ci id="alg1.l5.m1.2.2.2.3.3.cmml" xref="alg1.l5.m1.2.2.2.3.3">𝐿</ci></apply><apply id="alg1.l5.m1.2.2.2.2.cmml" xref="alg1.l5.m1.2.2.2.2"><times id="alg1.l5.m1.2.2.2.2.3.cmml" xref="alg1.l5.m1.2.2.2.2.3"></times><apply id="alg1.l5.m1.1.1.1.1.1.cmml" xref="alg1.l5.m1.1.1.1.1.1"><ci id="alg1.l5.m1.1.1.1.1.1.2.cmml" xref="alg1.l5.m1.1.1.1.1.1.2">⋅</ci><apply id="alg1.l5.m1.1.1.1.1.1.1.cmml" xref="alg1.l5.m1.1.1.1.1.1.1"><times id="alg1.l5.m1.1.1.1.1.1.1.2.cmml" xref="alg1.l5.m1.1.1.1.1.1.1.2"></times><ci id="alg1.l5.m1.1.1.1.1.1.1.3.cmml" xref="alg1.l5.m1.1.1.1.1.1.1.3">𝜅</ci><apply id="alg1.l5.m1.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l5.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l5.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l5.m1.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="alg1.l5.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l5.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l5.m1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="alg1.l5.m1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="alg1.l5.m1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="alg1.l5.m1.1.1.1.1.1.1.1.1.1.2.2">𝑊</ci><ci id="alg1.l5.m1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="alg1.l5.m1.1.1.1.1.1.1.1.1.1.2.3">𝑗</ci></apply><ci id="alg1.l5.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l5.m1.1.1.1.1.1.1.1.1.1.3">𝑘</ci></apply></apply><ci id="alg1.l5.m1.1.1.1.1.1.3.cmml" xref="alg1.l5.m1.1.1.1.1.1.3">𝜅</ci></apply><apply id="alg1.l5.m1.2.2.2.2.2.1.1.cmml" xref="alg1.l5.m1.2.2.2.2.2.1"><csymbol cd="ambiguous" id="alg1.l5.m1.2.2.2.2.2.1.1.1.cmml" xref="alg1.l5.m1.2.2.2.2.2.1">subscript</csymbol><apply id="alg1.l5.m1.2.2.2.2.2.1.1.2.cmml" xref="alg1.l5.m1.2.2.2.2.2.1"><csymbol cd="ambiguous" id="alg1.l5.m1.2.2.2.2.2.1.1.2.1.cmml" xref="alg1.l5.m1.2.2.2.2.2.1">superscript</csymbol><ci id="alg1.l5.m1.2.2.2.2.2.1.1.2.2.cmml" xref="alg1.l5.m1.2.2.2.2.2.1.1.2.2">𝑊</ci><ci id="alg1.l5.m1.2.2.2.2.2.1.1.2.3.cmml" xref="alg1.l5.m1.2.2.2.2.2.1.1.2.3">𝑗</ci></apply><ci id="alg1.l5.m1.2.2.2.2.2.1.1.3.cmml" xref="alg1.l5.m1.2.2.2.2.2.1.1.3">𝑣</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m1.2c">\tilde{\kappa}_{l}\leftarrow\prod_{j=l}^{L}\kappa(W^{j}_{k})\cdot\kappa(W^{j}_%
{v})</annotation><annotation encoding="application/x-llamapun" id="alg1.l5.m1.2d">over~ start_ARG italic_κ end_ARG start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT ← ∏ start_POSTSUBSCRIPT italic_j = italic_l end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_L end_POSTSUPERSCRIPT italic_κ ( italic_W start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ) ⋅ italic_κ ( italic_W start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT )</annotation></semantics></math><span class="ltx_text" id="alg1.l5.3" style="font-size:90%;">
</span>
</div>
<div class="ltx_listingline" id="alg1.l6">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l6.1.1.1" style="font-size:80%;">6:</span></span><span class="ltx_text ltx_font_bold" id="alg1.l6.2" style="font-size:90%;">end</span><span class="ltx_text" id="alg1.l6.3" style="font-size:90%;"> </span><span class="ltx_text ltx_font_bold" id="alg1.l6.4" style="font-size:90%;">for</span>
</div>
<div class="ltx_listingline" id="alg1.l7">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l7.1.1.1" style="font-size:80%;">7:</span></span><span class="ltx_text ltx_font_bold" id="alg1.l7.2" style="font-size:90%;">for</span><span class="ltx_text" id="alg1.l7.3" style="font-size:90%;"> </span><math alttext="l=1" class="ltx_Math" display="inline" id="alg1.l7.m1.1"><semantics id="alg1.l7.m1.1a"><mrow id="alg1.l7.m1.1.1" xref="alg1.l7.m1.1.1.cmml"><mi id="alg1.l7.m1.1.1.2" mathsize="90%" xref="alg1.l7.m1.1.1.2.cmml">l</mi><mo id="alg1.l7.m1.1.1.1" mathsize="90%" xref="alg1.l7.m1.1.1.1.cmml">=</mo><mn id="alg1.l7.m1.1.1.3" mathsize="90%" xref="alg1.l7.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="alg1.l7.m1.1b"><apply id="alg1.l7.m1.1.1.cmml" xref="alg1.l7.m1.1.1"><eq id="alg1.l7.m1.1.1.1.cmml" xref="alg1.l7.m1.1.1.1"></eq><ci id="alg1.l7.m1.1.1.2.cmml" xref="alg1.l7.m1.1.1.2">𝑙</ci><cn id="alg1.l7.m1.1.1.3.cmml" type="integer" xref="alg1.l7.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m1.1c">l=1</annotation><annotation encoding="application/x-llamapun" id="alg1.l7.m1.1d">italic_l = 1</annotation></semantics></math><span class="ltx_text" id="alg1.l7.4" style="font-size:90%;"> </span><span class="ltx_text ltx_font_bold" id="alg1.l7.5" style="font-size:90%;">to</span><span class="ltx_text" id="alg1.l7.6" style="font-size:90%;"> </span><math alttext="L" class="ltx_Math" display="inline" id="alg1.l7.m2.1"><semantics id="alg1.l7.m2.1a"><mi id="alg1.l7.m2.1.1" mathsize="90%" xref="alg1.l7.m2.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="alg1.l7.m2.1b"><ci id="alg1.l7.m2.1.1.cmml" xref="alg1.l7.m2.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m2.1c">L</annotation><annotation encoding="application/x-llamapun" id="alg1.l7.m2.1d">italic_L</annotation></semantics></math><span class="ltx_text" id="alg1.l7.7" style="font-size:90%;"> </span><span class="ltx_text ltx_font_bold" id="alg1.l7.8" style="font-size:90%;">do</span><span class="ltx_text" id="alg1.l7.9" style="font-size:90%;">
</span>
</div>
<div class="ltx_listingline" id="alg1.l8">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l8.1.1.1" style="font-size:80%;">8:</span></span><span class="ltx_text" id="alg1.l8.2" style="font-size:90%;">    </span><math alttext="d^{l}_{c}\leftarrow" class="ltx_Math" display="inline" id="alg1.l8.m1.1"><semantics id="alg1.l8.m1.1a"><mrow id="alg1.l8.m1.1.1" xref="alg1.l8.m1.1.1.cmml"><msubsup id="alg1.l8.m1.1.1.2" xref="alg1.l8.m1.1.1.2.cmml"><mi id="alg1.l8.m1.1.1.2.2.2" mathsize="90%" xref="alg1.l8.m1.1.1.2.2.2.cmml">d</mi><mi id="alg1.l8.m1.1.1.2.3" mathsize="90%" xref="alg1.l8.m1.1.1.2.3.cmml">c</mi><mi id="alg1.l8.m1.1.1.2.2.3" mathsize="90%" xref="alg1.l8.m1.1.1.2.2.3.cmml">l</mi></msubsup><mo id="alg1.l8.m1.1.1.1" mathsize="90%" stretchy="false" xref="alg1.l8.m1.1.1.1.cmml">←</mo><mi id="alg1.l8.m1.1.1.3" xref="alg1.l8.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l8.m1.1b"><apply id="alg1.l8.m1.1.1.cmml" xref="alg1.l8.m1.1.1"><ci id="alg1.l8.m1.1.1.1.cmml" xref="alg1.l8.m1.1.1.1">←</ci><apply id="alg1.l8.m1.1.1.2.cmml" xref="alg1.l8.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l8.m1.1.1.2.1.cmml" xref="alg1.l8.m1.1.1.2">subscript</csymbol><apply id="alg1.l8.m1.1.1.2.2.cmml" xref="alg1.l8.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l8.m1.1.1.2.2.1.cmml" xref="alg1.l8.m1.1.1.2">superscript</csymbol><ci id="alg1.l8.m1.1.1.2.2.2.cmml" xref="alg1.l8.m1.1.1.2.2.2">𝑑</ci><ci id="alg1.l8.m1.1.1.2.2.3.cmml" xref="alg1.l8.m1.1.1.2.2.3">𝑙</ci></apply><ci id="alg1.l8.m1.1.1.2.3.cmml" xref="alg1.l8.m1.1.1.2.3">𝑐</ci></apply><csymbol cd="latexml" id="alg1.l8.m1.1.1.3.cmml" xref="alg1.l8.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m1.1c">d^{l}_{c}\leftarrow</annotation><annotation encoding="application/x-llamapun" id="alg1.l8.m1.1d">italic_d start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT ←</annotation></semantics></math><span class="ltx_text" id="alg1.l8.3" style="font-size:90%;"> Calculate by Eq. </span><a class="ltx_ref" href="https://arxiv.org/html/2410.03111v1#S4.E13" style="font-size:90%;" title="In Condition Number and Sensitivity Analysis ‣ 4.2 Progressive Compression Strategy ‣ 4 Method ‣ LoRC: Low-Rank Compression for LLMs KV Cache with a Progressive Compression Strategy"><span class="ltx_text ltx_ref_tag">13</span></a><span class="ltx_text" id="alg1.l8.4" style="font-size:90%;">
</span>
</div>
<div class="ltx_listingline" id="alg1.l9">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l9.1.1.1" style="font-size:80%;">9:</span></span><span class="ltx_text" id="alg1.l9.2" style="font-size:90%;">    </span><span class="ltx_text ltx_font_bold" id="alg1.l9.3" style="font-size:90%;">if</span><span class="ltx_text" id="alg1.l9.4" style="font-size:90%;"> </span><math alttext="\tilde{\kappa}_{l}&gt;\text{threshold}" class="ltx_Math" display="inline" id="alg1.l9.m1.1"><semantics id="alg1.l9.m1.1a"><mrow id="alg1.l9.m1.1.1" xref="alg1.l9.m1.1.1.cmml"><msub id="alg1.l9.m1.1.1.2" xref="alg1.l9.m1.1.1.2.cmml"><mover accent="true" id="alg1.l9.m1.1.1.2.2" xref="alg1.l9.m1.1.1.2.2.cmml"><mi id="alg1.l9.m1.1.1.2.2.2" mathsize="90%" xref="alg1.l9.m1.1.1.2.2.2.cmml">κ</mi><mo id="alg1.l9.m1.1.1.2.2.1" mathsize="90%" xref="alg1.l9.m1.1.1.2.2.1.cmml">~</mo></mover><mi id="alg1.l9.m1.1.1.2.3" mathsize="90%" xref="alg1.l9.m1.1.1.2.3.cmml">l</mi></msub><mo id="alg1.l9.m1.1.1.1" mathsize="90%" xref="alg1.l9.m1.1.1.1.cmml">&gt;</mo><mtext id="alg1.l9.m1.1.1.3" mathsize="90%" xref="alg1.l9.m1.1.1.3a.cmml">threshold</mtext></mrow><annotation-xml encoding="MathML-Content" id="alg1.l9.m1.1b"><apply id="alg1.l9.m1.1.1.cmml" xref="alg1.l9.m1.1.1"><gt id="alg1.l9.m1.1.1.1.cmml" xref="alg1.l9.m1.1.1.1"></gt><apply id="alg1.l9.m1.1.1.2.cmml" xref="alg1.l9.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l9.m1.1.1.2.1.cmml" xref="alg1.l9.m1.1.1.2">subscript</csymbol><apply id="alg1.l9.m1.1.1.2.2.cmml" xref="alg1.l9.m1.1.1.2.2"><ci id="alg1.l9.m1.1.1.2.2.1.cmml" xref="alg1.l9.m1.1.1.2.2.1">~</ci><ci id="alg1.l9.m1.1.1.2.2.2.cmml" xref="alg1.l9.m1.1.1.2.2.2">𝜅</ci></apply><ci id="alg1.l9.m1.1.1.2.3.cmml" xref="alg1.l9.m1.1.1.2.3">𝑙</ci></apply><ci id="alg1.l9.m1.1.1.3a.cmml" xref="alg1.l9.m1.1.1.3"><mtext id="alg1.l9.m1.1.1.3.cmml" mathsize="90%" xref="alg1.l9.m1.1.1.3">threshold</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m1.1c">\tilde{\kappa}_{l}&gt;\text{threshold}</annotation><annotation encoding="application/x-llamapun" id="alg1.l9.m1.1d">over~ start_ARG italic_κ end_ARG start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT &gt; threshold</annotation></semantics></math><span class="ltx_text" id="alg1.l9.5" style="font-size:90%;"> </span><span class="ltx_text ltx_font_bold" id="alg1.l9.6" style="font-size:90%;">then</span><span class="ltx_text" id="alg1.l9.7" style="font-size:90%;">
</span>
</div>
<div class="ltx_listingline" id="alg1.l10">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l10.1.1.1" style="font-size:80%;">10:</span></span><span class="ltx_text" id="alg1.l10.2" style="font-size:90%;">         Skip compression for layer </span><math alttext="l" class="ltx_Math" display="inline" id="alg1.l10.m1.1"><semantics id="alg1.l10.m1.1a"><mi id="alg1.l10.m1.1.1" mathsize="90%" xref="alg1.l10.m1.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="alg1.l10.m1.1b"><ci id="alg1.l10.m1.1.1.cmml" xref="alg1.l10.m1.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m1.1c">l</annotation><annotation encoding="application/x-llamapun" id="alg1.l10.m1.1d">italic_l</annotation></semantics></math><span class="ltx_text" id="alg1.l10.3" style="font-size:90%;">
</span>
</div>
<div class="ltx_listingline" id="alg1.l11">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l11.1.1.1" style="font-size:80%;">11:</span></span><span class="ltx_text" id="alg1.l11.2" style="font-size:90%;">         </span><span class="ltx_text ltx_font_bold" id="alg1.l11.3" style="font-size:90%;">continue</span><span class="ltx_text" id="alg1.l11.4" style="font-size:90%;">
</span>
</div>
<div class="ltx_listingline" id="alg1.l12">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l12.1.1.1" style="font-size:80%;">12:</span></span><span class="ltx_text" id="alg1.l12.2" style="font-size:90%;">    </span><span class="ltx_text ltx_font_bold" id="alg1.l12.3" style="font-size:90%;">end</span><span class="ltx_text" id="alg1.l12.4" style="font-size:90%;"> </span><span class="ltx_text ltx_font_bold" id="alg1.l12.5" style="font-size:90%;">if</span>
</div>
<div class="ltx_listingline" id="alg1.l13">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l13.1.1.1" style="font-size:80%;">13:</span></span><span class="ltx_text" id="alg1.l13.2" style="font-size:90%;">    </span><span class="ltx_text ltx_font_bold" id="alg1.l13.3" style="font-size:90%;">Key Matrix Compression:</span><span class="ltx_text" id="alg1.l13.4" style="font-size:90%;">
    </span>
</div>
<div class="ltx_listingline" id="alg1.l14">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l14.1.1.1" style="font-size:80%;">14:</span></span><span class="ltx_text" id="alg1.l14.2" style="font-size:90%;">         Perform SVD: </span><math alttext="W^{l}_{k}=U_{k}\Sigma_{k}(V_{k}^{T})" class="ltx_Math" display="inline" id="alg1.l14.m1.1"><semantics id="alg1.l14.m1.1a"><mrow id="alg1.l14.m1.1.1" xref="alg1.l14.m1.1.1.cmml"><msubsup id="alg1.l14.m1.1.1.3" xref="alg1.l14.m1.1.1.3.cmml"><mi id="alg1.l14.m1.1.1.3.2.2" mathsize="90%" xref="alg1.l14.m1.1.1.3.2.2.cmml">W</mi><mi id="alg1.l14.m1.1.1.3.3" mathsize="90%" xref="alg1.l14.m1.1.1.3.3.cmml">k</mi><mi id="alg1.l14.m1.1.1.3.2.3" mathsize="90%" xref="alg1.l14.m1.1.1.3.2.3.cmml">l</mi></msubsup><mo id="alg1.l14.m1.1.1.2" mathsize="90%" xref="alg1.l14.m1.1.1.2.cmml">=</mo><mrow id="alg1.l14.m1.1.1.1" xref="alg1.l14.m1.1.1.1.cmml"><msub id="alg1.l14.m1.1.1.1.3" xref="alg1.l14.m1.1.1.1.3.cmml"><mi id="alg1.l14.m1.1.1.1.3.2" mathsize="90%" xref="alg1.l14.m1.1.1.1.3.2.cmml">U</mi><mi id="alg1.l14.m1.1.1.1.3.3" mathsize="90%" xref="alg1.l14.m1.1.1.1.3.3.cmml">k</mi></msub><mo id="alg1.l14.m1.1.1.1.2" xref="alg1.l14.m1.1.1.1.2.cmml">⁢</mo><msub id="alg1.l14.m1.1.1.1.4" xref="alg1.l14.m1.1.1.1.4.cmml"><mi id="alg1.l14.m1.1.1.1.4.2" mathsize="90%" mathvariant="normal" xref="alg1.l14.m1.1.1.1.4.2.cmml">Σ</mi><mi id="alg1.l14.m1.1.1.1.4.3" mathsize="90%" xref="alg1.l14.m1.1.1.1.4.3.cmml">k</mi></msub><mo id="alg1.l14.m1.1.1.1.2a" xref="alg1.l14.m1.1.1.1.2.cmml">⁢</mo><mrow id="alg1.l14.m1.1.1.1.1.1" xref="alg1.l14.m1.1.1.1.1.1.1.cmml"><mo id="alg1.l14.m1.1.1.1.1.1.2" maxsize="90%" minsize="90%" xref="alg1.l14.m1.1.1.1.1.1.1.cmml">(</mo><msubsup id="alg1.l14.m1.1.1.1.1.1.1" xref="alg1.l14.m1.1.1.1.1.1.1.cmml"><mi id="alg1.l14.m1.1.1.1.1.1.1.2.2" mathsize="90%" xref="alg1.l14.m1.1.1.1.1.1.1.2.2.cmml">V</mi><mi id="alg1.l14.m1.1.1.1.1.1.1.2.3" mathsize="90%" xref="alg1.l14.m1.1.1.1.1.1.1.2.3.cmml">k</mi><mi id="alg1.l14.m1.1.1.1.1.1.1.3" mathsize="90%" xref="alg1.l14.m1.1.1.1.1.1.1.3.cmml">T</mi></msubsup><mo id="alg1.l14.m1.1.1.1.1.1.3" maxsize="90%" minsize="90%" xref="alg1.l14.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l14.m1.1b"><apply id="alg1.l14.m1.1.1.cmml" xref="alg1.l14.m1.1.1"><eq id="alg1.l14.m1.1.1.2.cmml" xref="alg1.l14.m1.1.1.2"></eq><apply id="alg1.l14.m1.1.1.3.cmml" xref="alg1.l14.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l14.m1.1.1.3.1.cmml" xref="alg1.l14.m1.1.1.3">subscript</csymbol><apply id="alg1.l14.m1.1.1.3.2.cmml" xref="alg1.l14.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l14.m1.1.1.3.2.1.cmml" xref="alg1.l14.m1.1.1.3">superscript</csymbol><ci id="alg1.l14.m1.1.1.3.2.2.cmml" xref="alg1.l14.m1.1.1.3.2.2">𝑊</ci><ci id="alg1.l14.m1.1.1.3.2.3.cmml" xref="alg1.l14.m1.1.1.3.2.3">𝑙</ci></apply><ci id="alg1.l14.m1.1.1.3.3.cmml" xref="alg1.l14.m1.1.1.3.3">𝑘</ci></apply><apply id="alg1.l14.m1.1.1.1.cmml" xref="alg1.l14.m1.1.1.1"><times id="alg1.l14.m1.1.1.1.2.cmml" xref="alg1.l14.m1.1.1.1.2"></times><apply id="alg1.l14.m1.1.1.1.3.cmml" xref="alg1.l14.m1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l14.m1.1.1.1.3.1.cmml" xref="alg1.l14.m1.1.1.1.3">subscript</csymbol><ci id="alg1.l14.m1.1.1.1.3.2.cmml" xref="alg1.l14.m1.1.1.1.3.2">𝑈</ci><ci id="alg1.l14.m1.1.1.1.3.3.cmml" xref="alg1.l14.m1.1.1.1.3.3">𝑘</ci></apply><apply id="alg1.l14.m1.1.1.1.4.cmml" xref="alg1.l14.m1.1.1.1.4"><csymbol cd="ambiguous" id="alg1.l14.m1.1.1.1.4.1.cmml" xref="alg1.l14.m1.1.1.1.4">subscript</csymbol><ci id="alg1.l14.m1.1.1.1.4.2.cmml" xref="alg1.l14.m1.1.1.1.4.2">Σ</ci><ci id="alg1.l14.m1.1.1.1.4.3.cmml" xref="alg1.l14.m1.1.1.1.4.3">𝑘</ci></apply><apply id="alg1.l14.m1.1.1.1.1.1.1.cmml" xref="alg1.l14.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l14.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l14.m1.1.1.1.1.1">superscript</csymbol><apply id="alg1.l14.m1.1.1.1.1.1.1.2.cmml" xref="alg1.l14.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l14.m1.1.1.1.1.1.1.2.1.cmml" xref="alg1.l14.m1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l14.m1.1.1.1.1.1.1.2.2.cmml" xref="alg1.l14.m1.1.1.1.1.1.1.2.2">𝑉</ci><ci id="alg1.l14.m1.1.1.1.1.1.1.2.3.cmml" xref="alg1.l14.m1.1.1.1.1.1.1.2.3">𝑘</ci></apply><ci id="alg1.l14.m1.1.1.1.1.1.1.3.cmml" xref="alg1.l14.m1.1.1.1.1.1.1.3">𝑇</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l14.m1.1c">W^{l}_{k}=U_{k}\Sigma_{k}(V_{k}^{T})</annotation><annotation encoding="application/x-llamapun" id="alg1.l14.m1.1d">italic_W start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT = italic_U start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT roman_Σ start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ( italic_V start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT )</annotation></semantics></math><span class="ltx_text" id="alg1.l14.3" style="font-size:90%;">
</span>
</div>
<div class="ltx_listingline" id="alg1.l15">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l15.1.1.1" style="font-size:80%;">15:</span></span><span class="ltx_text" id="alg1.l15.2" style="font-size:90%;">         </span><math alttext="\tilde{W}^{l}_{k}\leftarrow U_{k}[:,:d^{l}_{c}](\Sigma_{k}V_{k}^{T})[:d^{l}_{c%
},:]" class="ltx_math_unparsed" display="inline" id="alg1.l15.m1.1"><semantics id="alg1.l15.m1.1a"><mrow id="alg1.l15.m1.1b"><msubsup id="alg1.l15.m1.1.1"><mover accent="true" id="alg1.l15.m1.1.1.2.2"><mi id="alg1.l15.m1.1.1.2.2.2" mathsize="90%">W</mi><mo id="alg1.l15.m1.1.1.2.2.1" mathsize="90%">~</mo></mover><mi id="alg1.l15.m1.1.1.3" mathsize="90%">k</mi><mi id="alg1.l15.m1.1.1.2.3" mathsize="90%">l</mi></msubsup><mo id="alg1.l15.m1.1.2" mathsize="90%" stretchy="false">←</mo><msub id="alg1.l15.m1.1.3"><mi id="alg1.l15.m1.1.3.2" mathsize="90%">U</mi><mi id="alg1.l15.m1.1.3.3" mathsize="90%">k</mi></msub><mrow id="alg1.l15.m1.1.4"><mo id="alg1.l15.m1.1.4.1" maxsize="90%" minsize="90%">[</mo><mo id="alg1.l15.m1.1.4.2" mathsize="90%" rspace="0em">:</mo><mo id="alg1.l15.m1.1.4.3" mathsize="90%">,</mo><mo id="alg1.l15.m1.1.4.4" mathsize="90%" rspace="0.278em">:</mo><msubsup id="alg1.l15.m1.1.4.5"><mi id="alg1.l15.m1.1.4.5.2.2" mathsize="90%">d</mi><mi id="alg1.l15.m1.1.4.5.3" mathsize="90%">c</mi><mi id="alg1.l15.m1.1.4.5.2.3" mathsize="90%">l</mi></msubsup><mo id="alg1.l15.m1.1.4.6" maxsize="90%" minsize="90%">]</mo></mrow><mrow id="alg1.l15.m1.1.5"><mo id="alg1.l15.m1.1.5.1" maxsize="90%" minsize="90%">(</mo><msub id="alg1.l15.m1.1.5.2"><mi id="alg1.l15.m1.1.5.2.2" mathsize="90%" mathvariant="normal">Σ</mi><mi id="alg1.l15.m1.1.5.2.3" mathsize="90%">k</mi></msub><msubsup id="alg1.l15.m1.1.5.3"><mi id="alg1.l15.m1.1.5.3.2.2" mathsize="90%">V</mi><mi id="alg1.l15.m1.1.5.3.2.3" mathsize="90%">k</mi><mi id="alg1.l15.m1.1.5.3.3" mathsize="90%">T</mi></msubsup><mo id="alg1.l15.m1.1.5.4" maxsize="90%" minsize="90%">)</mo></mrow><mrow id="alg1.l15.m1.1.6"><mo id="alg1.l15.m1.1.6.1" maxsize="90%" minsize="90%">[</mo><mo id="alg1.l15.m1.1.6.2" mathsize="90%" rspace="0.278em">:</mo><msubsup id="alg1.l15.m1.1.6.3"><mi id="alg1.l15.m1.1.6.3.2.2" mathsize="90%">d</mi><mi id="alg1.l15.m1.1.6.3.3" mathsize="90%">c</mi><mi id="alg1.l15.m1.1.6.3.2.3" mathsize="90%">l</mi></msubsup><mo id="alg1.l15.m1.1.6.4" mathsize="90%">,</mo><mo id="alg1.l15.m1.1.6.5" mathsize="90%" rspace="0em">:</mo><mo id="alg1.l15.m1.1.6.6" maxsize="90%" minsize="90%">]</mo></mrow></mrow><annotation encoding="application/x-tex" id="alg1.l15.m1.1c">\tilde{W}^{l}_{k}\leftarrow U_{k}[:,:d^{l}_{c}](\Sigma_{k}V_{k}^{T})[:d^{l}_{c%
},:]</annotation><annotation encoding="application/x-llamapun" id="alg1.l15.m1.1d">over~ start_ARG italic_W end_ARG start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ← italic_U start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT [ : , : italic_d start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT ] ( roman_Σ start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT italic_V start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT ) [ : italic_d start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT , : ]</annotation></semantics></math><span class="ltx_text" id="alg1.l15.3" style="font-size:90%;">
</span>
</div>
<div class="ltx_listingline" id="alg1.l16">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l16.1.1.1" style="font-size:80%;">16:</span></span><span class="ltx_text" id="alg1.l16.2" style="font-size:90%;">         </span><math alttext="W^{l}_{q^{\prime}}\leftarrow W^{l}_{q}U_{k}[:,:d^{l}_{c}]" class="ltx_math_unparsed" display="inline" id="alg1.l16.m1.1"><semantics id="alg1.l16.m1.1a"><mrow id="alg1.l16.m1.1b"><msubsup id="alg1.l16.m1.1.1"><mi id="alg1.l16.m1.1.1.2.2" mathsize="90%">W</mi><msup id="alg1.l16.m1.1.1.3"><mi id="alg1.l16.m1.1.1.3.2" mathsize="90%">q</mi><mo id="alg1.l16.m1.1.1.3.3" mathsize="90%">′</mo></msup><mi id="alg1.l16.m1.1.1.2.3" mathsize="90%">l</mi></msubsup><mo id="alg1.l16.m1.1.2" mathsize="90%" stretchy="false">←</mo><msubsup id="alg1.l16.m1.1.3"><mi id="alg1.l16.m1.1.3.2.2" mathsize="90%">W</mi><mi id="alg1.l16.m1.1.3.3" mathsize="90%">q</mi><mi id="alg1.l16.m1.1.3.2.3" mathsize="90%">l</mi></msubsup><msub id="alg1.l16.m1.1.4"><mi id="alg1.l16.m1.1.4.2" mathsize="90%">U</mi><mi id="alg1.l16.m1.1.4.3" mathsize="90%">k</mi></msub><mrow id="alg1.l16.m1.1.5"><mo id="alg1.l16.m1.1.5.1" maxsize="90%" minsize="90%">[</mo><mo id="alg1.l16.m1.1.5.2" mathsize="90%" rspace="0em">:</mo><mo id="alg1.l16.m1.1.5.3" mathsize="90%">,</mo><mo id="alg1.l16.m1.1.5.4" mathsize="90%" rspace="0.278em">:</mo><msubsup id="alg1.l16.m1.1.5.5"><mi id="alg1.l16.m1.1.5.5.2.2" mathsize="90%">d</mi><mi id="alg1.l16.m1.1.5.5.3" mathsize="90%">c</mi><mi id="alg1.l16.m1.1.5.5.2.3" mathsize="90%">l</mi></msubsup><mo id="alg1.l16.m1.1.5.6" maxsize="90%" minsize="90%">]</mo></mrow></mrow><annotation encoding="application/x-tex" id="alg1.l16.m1.1c">W^{l}_{q^{\prime}}\leftarrow W^{l}_{q}U_{k}[:,:d^{l}_{c}]</annotation><annotation encoding="application/x-llamapun" id="alg1.l16.m1.1d">italic_W start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_q start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT end_POSTSUBSCRIPT ← italic_W start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT italic_U start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT [ : , : italic_d start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT ]</annotation></semantics></math><span class="ltx_text" id="alg1.l16.3" style="font-size:90%;">
    </span>
</div>
<div class="ltx_listingline" id="alg1.l17">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l17.1.1.1" style="font-size:80%;">17:</span></span><span class="ltx_text" id="alg1.l17.2" style="font-size:90%;">    </span><span class="ltx_text ltx_font_bold" id="alg1.l17.3" style="font-size:90%;">Value Matrix Compression:</span><span class="ltx_text" id="alg1.l17.4" style="font-size:90%;">
    </span>
</div>
<div class="ltx_listingline" id="alg1.l18">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l18.1.1.1" style="font-size:80%;">18:</span></span><span class="ltx_text" id="alg1.l18.2" style="font-size:90%;">         Perform SVD: </span><math alttext="W^{l}_{v}=U_{v}\Sigma_{v}(V_{v}^{T})" class="ltx_Math" display="inline" id="alg1.l18.m1.1"><semantics id="alg1.l18.m1.1a"><mrow id="alg1.l18.m1.1.1" xref="alg1.l18.m1.1.1.cmml"><msubsup id="alg1.l18.m1.1.1.3" xref="alg1.l18.m1.1.1.3.cmml"><mi id="alg1.l18.m1.1.1.3.2.2" mathsize="90%" xref="alg1.l18.m1.1.1.3.2.2.cmml">W</mi><mi id="alg1.l18.m1.1.1.3.3" mathsize="90%" xref="alg1.l18.m1.1.1.3.3.cmml">v</mi><mi id="alg1.l18.m1.1.1.3.2.3" mathsize="90%" xref="alg1.l18.m1.1.1.3.2.3.cmml">l</mi></msubsup><mo id="alg1.l18.m1.1.1.2" mathsize="90%" xref="alg1.l18.m1.1.1.2.cmml">=</mo><mrow id="alg1.l18.m1.1.1.1" xref="alg1.l18.m1.1.1.1.cmml"><msub id="alg1.l18.m1.1.1.1.3" xref="alg1.l18.m1.1.1.1.3.cmml"><mi id="alg1.l18.m1.1.1.1.3.2" mathsize="90%" xref="alg1.l18.m1.1.1.1.3.2.cmml">U</mi><mi id="alg1.l18.m1.1.1.1.3.3" mathsize="90%" xref="alg1.l18.m1.1.1.1.3.3.cmml">v</mi></msub><mo id="alg1.l18.m1.1.1.1.2" xref="alg1.l18.m1.1.1.1.2.cmml">⁢</mo><msub id="alg1.l18.m1.1.1.1.4" xref="alg1.l18.m1.1.1.1.4.cmml"><mi id="alg1.l18.m1.1.1.1.4.2" mathsize="90%" mathvariant="normal" xref="alg1.l18.m1.1.1.1.4.2.cmml">Σ</mi><mi id="alg1.l18.m1.1.1.1.4.3" mathsize="90%" xref="alg1.l18.m1.1.1.1.4.3.cmml">v</mi></msub><mo id="alg1.l18.m1.1.1.1.2a" xref="alg1.l18.m1.1.1.1.2.cmml">⁢</mo><mrow id="alg1.l18.m1.1.1.1.1.1" xref="alg1.l18.m1.1.1.1.1.1.1.cmml"><mo id="alg1.l18.m1.1.1.1.1.1.2" maxsize="90%" minsize="90%" xref="alg1.l18.m1.1.1.1.1.1.1.cmml">(</mo><msubsup id="alg1.l18.m1.1.1.1.1.1.1" xref="alg1.l18.m1.1.1.1.1.1.1.cmml"><mi id="alg1.l18.m1.1.1.1.1.1.1.2.2" mathsize="90%" xref="alg1.l18.m1.1.1.1.1.1.1.2.2.cmml">V</mi><mi id="alg1.l18.m1.1.1.1.1.1.1.2.3" mathsize="90%" xref="alg1.l18.m1.1.1.1.1.1.1.2.3.cmml">v</mi><mi id="alg1.l18.m1.1.1.1.1.1.1.3" mathsize="90%" xref="alg1.l18.m1.1.1.1.1.1.1.3.cmml">T</mi></msubsup><mo id="alg1.l18.m1.1.1.1.1.1.3" maxsize="90%" minsize="90%" xref="alg1.l18.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l18.m1.1b"><apply id="alg1.l18.m1.1.1.cmml" xref="alg1.l18.m1.1.1"><eq id="alg1.l18.m1.1.1.2.cmml" xref="alg1.l18.m1.1.1.2"></eq><apply id="alg1.l18.m1.1.1.3.cmml" xref="alg1.l18.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l18.m1.1.1.3.1.cmml" xref="alg1.l18.m1.1.1.3">subscript</csymbol><apply id="alg1.l18.m1.1.1.3.2.cmml" xref="alg1.l18.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l18.m1.1.1.3.2.1.cmml" xref="alg1.l18.m1.1.1.3">superscript</csymbol><ci id="alg1.l18.m1.1.1.3.2.2.cmml" xref="alg1.l18.m1.1.1.3.2.2">𝑊</ci><ci id="alg1.l18.m1.1.1.3.2.3.cmml" xref="alg1.l18.m1.1.1.3.2.3">𝑙</ci></apply><ci id="alg1.l18.m1.1.1.3.3.cmml" xref="alg1.l18.m1.1.1.3.3">𝑣</ci></apply><apply id="alg1.l18.m1.1.1.1.cmml" xref="alg1.l18.m1.1.1.1"><times id="alg1.l18.m1.1.1.1.2.cmml" xref="alg1.l18.m1.1.1.1.2"></times><apply id="alg1.l18.m1.1.1.1.3.cmml" xref="alg1.l18.m1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l18.m1.1.1.1.3.1.cmml" xref="alg1.l18.m1.1.1.1.3">subscript</csymbol><ci id="alg1.l18.m1.1.1.1.3.2.cmml" xref="alg1.l18.m1.1.1.1.3.2">𝑈</ci><ci id="alg1.l18.m1.1.1.1.3.3.cmml" xref="alg1.l18.m1.1.1.1.3.3">𝑣</ci></apply><apply id="alg1.l18.m1.1.1.1.4.cmml" xref="alg1.l18.m1.1.1.1.4"><csymbol cd="ambiguous" id="alg1.l18.m1.1.1.1.4.1.cmml" xref="alg1.l18.m1.1.1.1.4">subscript</csymbol><ci id="alg1.l18.m1.1.1.1.4.2.cmml" xref="alg1.l18.m1.1.1.1.4.2">Σ</ci><ci id="alg1.l18.m1.1.1.1.4.3.cmml" xref="alg1.l18.m1.1.1.1.4.3">𝑣</ci></apply><apply id="alg1.l18.m1.1.1.1.1.1.1.cmml" xref="alg1.l18.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l18.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l18.m1.1.1.1.1.1">superscript</csymbol><apply id="alg1.l18.m1.1.1.1.1.1.1.2.cmml" xref="alg1.l18.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l18.m1.1.1.1.1.1.1.2.1.cmml" xref="alg1.l18.m1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l18.m1.1.1.1.1.1.1.2.2.cmml" xref="alg1.l18.m1.1.1.1.1.1.1.2.2">𝑉</ci><ci id="alg1.l18.m1.1.1.1.1.1.1.2.3.cmml" xref="alg1.l18.m1.1.1.1.1.1.1.2.3">𝑣</ci></apply><ci id="alg1.l18.m1.1.1.1.1.1.1.3.cmml" xref="alg1.l18.m1.1.1.1.1.1.1.3">𝑇</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l18.m1.1c">W^{l}_{v}=U_{v}\Sigma_{v}(V_{v}^{T})</annotation><annotation encoding="application/x-llamapun" id="alg1.l18.m1.1d">italic_W start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT = italic_U start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT roman_Σ start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT ( italic_V start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT )</annotation></semantics></math><span class="ltx_text" id="alg1.l18.3" style="font-size:90%;">
</span>
</div>
<div class="ltx_listingline" id="alg1.l19">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l19.1.1.1" style="font-size:80%;">19:</span></span><span class="ltx_text" id="alg1.l19.2" style="font-size:90%;">         </span><math alttext="\tilde{W}^{l}_{v}\leftarrow U_{v}[:,:d^{l}_{c}](\Sigma_{v}V_{v}^{T})[:d^{l}_{c%
},:]" class="ltx_math_unparsed" display="inline" id="alg1.l19.m1.1"><semantics id="alg1.l19.m1.1a"><mrow id="alg1.l19.m1.1b"><msubsup id="alg1.l19.m1.1.1"><mover accent="true" id="alg1.l19.m1.1.1.2.2"><mi id="alg1.l19.m1.1.1.2.2.2" mathsize="90%">W</mi><mo id="alg1.l19.m1.1.1.2.2.1" mathsize="90%">~</mo></mover><mi id="alg1.l19.m1.1.1.3" mathsize="90%">v</mi><mi id="alg1.l19.m1.1.1.2.3" mathsize="90%">l</mi></msubsup><mo id="alg1.l19.m1.1.2" mathsize="90%" stretchy="false">←</mo><msub id="alg1.l19.m1.1.3"><mi id="alg1.l19.m1.1.3.2" mathsize="90%">U</mi><mi id="alg1.l19.m1.1.3.3" mathsize="90%">v</mi></msub><mrow id="alg1.l19.m1.1.4"><mo id="alg1.l19.m1.1.4.1" maxsize="90%" minsize="90%">[</mo><mo id="alg1.l19.m1.1.4.2" mathsize="90%" rspace="0em">:</mo><mo id="alg1.l19.m1.1.4.3" mathsize="90%">,</mo><mo id="alg1.l19.m1.1.4.4" mathsize="90%" rspace="0.278em">:</mo><msubsup id="alg1.l19.m1.1.4.5"><mi id="alg1.l19.m1.1.4.5.2.2" mathsize="90%">d</mi><mi id="alg1.l19.m1.1.4.5.3" mathsize="90%">c</mi><mi id="alg1.l19.m1.1.4.5.2.3" mathsize="90%">l</mi></msubsup><mo id="alg1.l19.m1.1.4.6" maxsize="90%" minsize="90%">]</mo></mrow><mrow id="alg1.l19.m1.1.5"><mo id="alg1.l19.m1.1.5.1" maxsize="90%" minsize="90%">(</mo><msub id="alg1.l19.m1.1.5.2"><mi id="alg1.l19.m1.1.5.2.2" mathsize="90%" mathvariant="normal">Σ</mi><mi id="alg1.l19.m1.1.5.2.3" mathsize="90%">v</mi></msub><msubsup id="alg1.l19.m1.1.5.3"><mi id="alg1.l19.m1.1.5.3.2.2" mathsize="90%">V</mi><mi id="alg1.l19.m1.1.5.3.2.3" mathsize="90%">v</mi><mi id="alg1.l19.m1.1.5.3.3" mathsize="90%">T</mi></msubsup><mo id="alg1.l19.m1.1.5.4" maxsize="90%" minsize="90%">)</mo></mrow><mrow id="alg1.l19.m1.1.6"><mo id="alg1.l19.m1.1.6.1" maxsize="90%" minsize="90%">[</mo><mo id="alg1.l19.m1.1.6.2" mathsize="90%" rspace="0.278em">:</mo><msubsup id="alg1.l19.m1.1.6.3"><mi id="alg1.l19.m1.1.6.3.2.2" mathsize="90%">d</mi><mi id="alg1.l19.m1.1.6.3.3" mathsize="90%">c</mi><mi id="alg1.l19.m1.1.6.3.2.3" mathsize="90%">l</mi></msubsup><mo id="alg1.l19.m1.1.6.4" mathsize="90%">,</mo><mo id="alg1.l19.m1.1.6.5" mathsize="90%" rspace="0em">:</mo><mo id="alg1.l19.m1.1.6.6" maxsize="90%" minsize="90%">]</mo></mrow></mrow><annotation encoding="application/x-tex" id="alg1.l19.m1.1c">\tilde{W}^{l}_{v}\leftarrow U_{v}[:,:d^{l}_{c}](\Sigma_{v}V_{v}^{T})[:d^{l}_{c%
},:]</annotation><annotation encoding="application/x-llamapun" id="alg1.l19.m1.1d">over~ start_ARG italic_W end_ARG start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT ← italic_U start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT [ : , : italic_d start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT ] ( roman_Σ start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT italic_V start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT ) [ : italic_d start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT , : ]</annotation></semantics></math><span class="ltx_text" id="alg1.l19.3" style="font-size:90%;">
</span>
</div>
<div class="ltx_listingline" id="alg1.l20">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l20.1.1.1" style="font-size:80%;">20:</span></span><span class="ltx_text" id="alg1.l20.2" style="font-size:90%;">         </span><math alttext="W^{l}_{o^{\prime}}\leftarrow U_{v}[:,:d^{l}_{c}]^{T}W^{l}_{o}" class="ltx_math_unparsed" display="inline" id="alg1.l20.m1.1"><semantics id="alg1.l20.m1.1a"><mrow id="alg1.l20.m1.1b"><msubsup id="alg1.l20.m1.1.1"><mi id="alg1.l20.m1.1.1.2.2" mathsize="90%">W</mi><msup id="alg1.l20.m1.1.1.3"><mi id="alg1.l20.m1.1.1.3.2" mathsize="90%">o</mi><mo id="alg1.l20.m1.1.1.3.3" mathsize="90%">′</mo></msup><mi id="alg1.l20.m1.1.1.2.3" mathsize="90%">l</mi></msubsup><mo id="alg1.l20.m1.1.2" mathsize="90%" stretchy="false">←</mo><msub id="alg1.l20.m1.1.3"><mi id="alg1.l20.m1.1.3.2" mathsize="90%">U</mi><mi id="alg1.l20.m1.1.3.3" mathsize="90%">v</mi></msub><msup id="alg1.l20.m1.1.4"><mrow id="alg1.l20.m1.1.4.2"><mo id="alg1.l20.m1.1.4.2.1" maxsize="90%" minsize="90%">[</mo><mo id="alg1.l20.m1.1.4.2.2" mathsize="90%" rspace="0em">:</mo><mo id="alg1.l20.m1.1.4.2.3" mathsize="90%">,</mo><mo id="alg1.l20.m1.1.4.2.4" mathsize="90%" rspace="0.278em">:</mo><msubsup id="alg1.l20.m1.1.4.2.5"><mi id="alg1.l20.m1.1.4.2.5.2.2" mathsize="90%">d</mi><mi id="alg1.l20.m1.1.4.2.5.3" mathsize="90%">c</mi><mi id="alg1.l20.m1.1.4.2.5.2.3" mathsize="90%">l</mi></msubsup><mo id="alg1.l20.m1.1.4.2.6" maxsize="90%" minsize="90%">]</mo></mrow><mi id="alg1.l20.m1.1.4.3" mathsize="90%">T</mi></msup><msubsup id="alg1.l20.m1.1.5"><mi id="alg1.l20.m1.1.5.2.2" mathsize="90%">W</mi><mi id="alg1.l20.m1.1.5.3" mathsize="90%">o</mi><mi id="alg1.l20.m1.1.5.2.3" mathsize="90%">l</mi></msubsup></mrow><annotation encoding="application/x-tex" id="alg1.l20.m1.1c">W^{l}_{o^{\prime}}\leftarrow U_{v}[:,:d^{l}_{c}]^{T}W^{l}_{o}</annotation><annotation encoding="application/x-llamapun" id="alg1.l20.m1.1d">italic_W start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_o start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT end_POSTSUBSCRIPT ← italic_U start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT [ : , : italic_d start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT ] start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_W start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_o end_POSTSUBSCRIPT</annotation></semantics></math><span class="ltx_text" id="alg1.l20.3" style="font-size:90%;">
    </span>
</div>
<div class="ltx_listingline" id="alg1.l21">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l21.1.1.1" style="font-size:80%;">21:</span></span><span class="ltx_text" id="alg1.l21.2" style="font-size:90%;">    Update KV cache size for layer </span><math alttext="l" class="ltx_Math" display="inline" id="alg1.l21.m1.1"><semantics id="alg1.l21.m1.1a"><mi id="alg1.l21.m1.1.1" mathsize="90%" xref="alg1.l21.m1.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="alg1.l21.m1.1b"><ci id="alg1.l21.m1.1.1.cmml" xref="alg1.l21.m1.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l21.m1.1c">l</annotation><annotation encoding="application/x-llamapun" id="alg1.l21.m1.1d">italic_l</annotation></semantics></math><span class="ltx_text" id="alg1.l21.3" style="font-size:90%;">
</span>
</div>
<div class="ltx_listingline" id="alg1.l22">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l22.1.1.1" style="font-size:80%;">22:</span></span><span class="ltx_text ltx_font_bold" id="alg1.l22.2" style="font-size:90%;">end</span><span class="ltx_text" id="alg1.l22.3" style="font-size:90%;"> </span><span class="ltx_text ltx_font_bold" id="alg1.l22.4" style="font-size:90%;">for</span>
</div>
</div>
</figure>
<div class="ltx_logical-block ltx_minipage ltx_align_top" id="S4.SS2.1" style="width:221.1pt;">
<div class="ltx_para" id="S4.SS2.1.p1">
<p class="ltx_p" id="S4.SS2.1.p1.1">Having established low-rank approximation for compressing weight matrices, we now address its dynamic application across network layers. This approach is necessary due to the varying sensitivity of different layers, which significantly affects overall model efficacy and efficiency.</p>
<p class="ltx_p" id="S4.SS2.1.p1.2">To tackle this challenge, we propose a <span class="ltx_text ltx_font_italic" id="S4.SS2.1.p1.2.1">progressive</span> compression strategy for our low-rank approximation of KV weight matrices. Our intuition is that the compressed shallow layers could lead to cascading errors that propagate and amplify through the network. Therefore, we measure the layer sensitivity by the condition numbers of KV matrices to determine <span class="ltx_text ltx_font_italic" id="S4.SS2.1.p1.2.2">layer-wise</span> compression dimensions. This approach accounts for each layer’s sensitivity to perturbations caused by previously compressed layers, ensuring output variations remain within acceptable ranges.
This progressive nature allows for more conservative compression in shallow layers and more aggressive compression in deeper layers, minimizing the risk of error accumulation throughout the network.
By carefully balancing compression across layers, we maintain model integrity while achieving significant memory savings.</p>
</div>
</div>
<section class="ltx_paragraph" id="S4.SS2.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">Condition Number and Sensitivity Analysis</h4>
<div class="ltx_para" id="S4.SS2.SSS0.Px1.p1">
<p class="ltx_p" id="S4.SS2.SSS0.Px1.p1.5">To ensure that the change in the output <math alttext="\mathbf{b}_{l}=\mathbf{A}_{l}\mathbf{x}_{l}" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px1.p1.1.m1.1"><semantics id="S4.SS2.SSS0.Px1.p1.1.m1.1a"><mrow id="S4.SS2.SSS0.Px1.p1.1.m1.1.1" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.cmml"><msub id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.cmml"><mi id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.cmml">𝐛</mi><mi id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.3" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.3.cmml">l</mi></msub><mo id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.1" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.1.cmml">=</mo><mrow id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.3" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.3.cmml"><msub id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.3.2" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.3.2.cmml"><mi id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.3.2.2" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.3.2.2.cmml">𝐀</mi><mi id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.3.2.3" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.3.2.3.cmml">l</mi></msub><mo id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.3.1" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.3.1.cmml">⁢</mo><msub id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.3.3" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.3.3.cmml"><mi id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.3.3.2" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.3.3.2.cmml">𝐱</mi><mi id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.3.3.3" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.3.3.3.cmml">l</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p1.1.m1.1b"><apply id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1"><eq id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.1"></eq><apply id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.1.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2">subscript</csymbol><ci id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2">𝐛</ci><ci id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.3.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.3">𝑙</ci></apply><apply id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.3.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.3"><times id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.3.1.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.3.1"></times><apply id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.3.2.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.3.2"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.3.2.1.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.3.2">subscript</csymbol><ci id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.3.2.2.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.3.2.2">𝐀</ci><ci id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.3.2.3.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.3.2.3">𝑙</ci></apply><apply id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.3.3.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.3.3"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.3.3.1.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.3.3">subscript</csymbol><ci id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.3.3.2.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.3.3.2">𝐱</ci><ci id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.3.3.3.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.3.3.3">𝑙</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p1.1.m1.1c">\mathbf{b}_{l}=\mathbf{A}_{l}\mathbf{x}_{l}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px1.p1.1.m1.1d">bold_b start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT = bold_A start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT bold_x start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT</annotation></semantics></math> remains within a specified range when the input <math alttext="\mathbf{x}_{l}" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px1.p1.2.m2.1"><semantics id="S4.SS2.SSS0.Px1.p1.2.m2.1a"><msub id="S4.SS2.SSS0.Px1.p1.2.m2.1.1" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.1.cmml"><mi id="S4.SS2.SSS0.Px1.p1.2.m2.1.1.2" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.1.2.cmml">𝐱</mi><mi id="S4.SS2.SSS0.Px1.p1.2.m2.1.1.3" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.1.3.cmml">l</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p1.2.m2.1b"><apply id="S4.SS2.SSS0.Px1.p1.2.m2.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px1.p1.2.m2.1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.1">subscript</csymbol><ci id="S4.SS2.SSS0.Px1.p1.2.m2.1.1.2.cmml" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.1.2">𝐱</ci><ci id="S4.SS2.SSS0.Px1.p1.2.m2.1.1.3.cmml" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p1.2.m2.1c">\mathbf{x}_{l}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px1.p1.2.m2.1d">bold_x start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT</annotation></semantics></math> changes due to compression in previous layers, we need to consider the sensitivity of the output to such changes. Given a weight matrix <math alttext="\mathbf{A}_{l}" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px1.p1.3.m3.1"><semantics id="S4.SS2.SSS0.Px1.p1.3.m3.1a"><msub id="S4.SS2.SSS0.Px1.p1.3.m3.1.1" xref="S4.SS2.SSS0.Px1.p1.3.m3.1.1.cmml"><mi id="S4.SS2.SSS0.Px1.p1.3.m3.1.1.2" xref="S4.SS2.SSS0.Px1.p1.3.m3.1.1.2.cmml">𝐀</mi><mi id="S4.SS2.SSS0.Px1.p1.3.m3.1.1.3" xref="S4.SS2.SSS0.Px1.p1.3.m3.1.1.3.cmml">l</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p1.3.m3.1b"><apply id="S4.SS2.SSS0.Px1.p1.3.m3.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px1.p1.3.m3.1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.3.m3.1.1">subscript</csymbol><ci id="S4.SS2.SSS0.Px1.p1.3.m3.1.1.2.cmml" xref="S4.SS2.SSS0.Px1.p1.3.m3.1.1.2">𝐀</ci><ci id="S4.SS2.SSS0.Px1.p1.3.m3.1.1.3.cmml" xref="S4.SS2.SSS0.Px1.p1.3.m3.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p1.3.m3.1c">\mathbf{A}_{l}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px1.p1.3.m3.1d">bold_A start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT</annotation></semantics></math>, its condition number plays a crucial role in determining the allowable change in <math alttext="\mathbf{x}_{l}" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px1.p1.4.m4.1"><semantics id="S4.SS2.SSS0.Px1.p1.4.m4.1a"><msub id="S4.SS2.SSS0.Px1.p1.4.m4.1.1" xref="S4.SS2.SSS0.Px1.p1.4.m4.1.1.cmml"><mi id="S4.SS2.SSS0.Px1.p1.4.m4.1.1.2" xref="S4.SS2.SSS0.Px1.p1.4.m4.1.1.2.cmml">𝐱</mi><mi id="S4.SS2.SSS0.Px1.p1.4.m4.1.1.3" xref="S4.SS2.SSS0.Px1.p1.4.m4.1.1.3.cmml">l</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p1.4.m4.1b"><apply id="S4.SS2.SSS0.Px1.p1.4.m4.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px1.p1.4.m4.1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.4.m4.1.1">subscript</csymbol><ci id="S4.SS2.SSS0.Px1.p1.4.m4.1.1.2.cmml" xref="S4.SS2.SSS0.Px1.p1.4.m4.1.1.2">𝐱</ci><ci id="S4.SS2.SSS0.Px1.p1.4.m4.1.1.3.cmml" xref="S4.SS2.SSS0.Px1.p1.4.m4.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p1.4.m4.1c">\mathbf{x}_{l}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px1.p1.4.m4.1d">bold_x start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT</annotation></semantics></math>. The condition number <math alttext="\kappa(\mathbf{A}_{l})" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px1.p1.5.m5.1"><semantics id="S4.SS2.SSS0.Px1.p1.5.m5.1a"><mrow id="S4.SS2.SSS0.Px1.p1.5.m5.1.1" xref="S4.SS2.SSS0.Px1.p1.5.m5.1.1.cmml"><mi id="S4.SS2.SSS0.Px1.p1.5.m5.1.1.3" xref="S4.SS2.SSS0.Px1.p1.5.m5.1.1.3.cmml">κ</mi><mo id="S4.SS2.SSS0.Px1.p1.5.m5.1.1.2" xref="S4.SS2.SSS0.Px1.p1.5.m5.1.1.2.cmml">⁢</mo><mrow id="S4.SS2.SSS0.Px1.p1.5.m5.1.1.1.1" xref="S4.SS2.SSS0.Px1.p1.5.m5.1.1.1.1.1.cmml"><mo id="S4.SS2.SSS0.Px1.p1.5.m5.1.1.1.1.2" stretchy="false" xref="S4.SS2.SSS0.Px1.p1.5.m5.1.1.1.1.1.cmml">(</mo><msub id="S4.SS2.SSS0.Px1.p1.5.m5.1.1.1.1.1" xref="S4.SS2.SSS0.Px1.p1.5.m5.1.1.1.1.1.cmml"><mi id="S4.SS2.SSS0.Px1.p1.5.m5.1.1.1.1.1.2" xref="S4.SS2.SSS0.Px1.p1.5.m5.1.1.1.1.1.2.cmml">𝐀</mi><mi id="S4.SS2.SSS0.Px1.p1.5.m5.1.1.1.1.1.3" xref="S4.SS2.SSS0.Px1.p1.5.m5.1.1.1.1.1.3.cmml">l</mi></msub><mo id="S4.SS2.SSS0.Px1.p1.5.m5.1.1.1.1.3" stretchy="false" xref="S4.SS2.SSS0.Px1.p1.5.m5.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p1.5.m5.1b"><apply id="S4.SS2.SSS0.Px1.p1.5.m5.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.5.m5.1.1"><times id="S4.SS2.SSS0.Px1.p1.5.m5.1.1.2.cmml" xref="S4.SS2.SSS0.Px1.p1.5.m5.1.1.2"></times><ci id="S4.SS2.SSS0.Px1.p1.5.m5.1.1.3.cmml" xref="S4.SS2.SSS0.Px1.p1.5.m5.1.1.3">𝜅</ci><apply id="S4.SS2.SSS0.Px1.p1.5.m5.1.1.1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.5.m5.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px1.p1.5.m5.1.1.1.1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.5.m5.1.1.1.1">subscript</csymbol><ci id="S4.SS2.SSS0.Px1.p1.5.m5.1.1.1.1.1.2.cmml" xref="S4.SS2.SSS0.Px1.p1.5.m5.1.1.1.1.1.2">𝐀</ci><ci id="S4.SS2.SSS0.Px1.p1.5.m5.1.1.1.1.1.3.cmml" xref="S4.SS2.SSS0.Px1.p1.5.m5.1.1.1.1.1.3">𝑙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p1.5.m5.1c">\kappa(\mathbf{A}_{l})</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px1.p1.5.m5.1d">italic_κ ( bold_A start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT )</annotation></semantics></math> is defined as:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E10">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\kappa(\mathbf{A}_{l})=|\mathbf{A}_{l}|_{2}\cdot|\mathbf{A}_{l}^{-1}|_{2}=%
\frac{\sigma_{\text{max}}(\mathbf{A}_{l})}{\sigma_{\text{min}}(\mathbf{A}_{l})}," class="ltx_Math" display="block" id="S4.E10.m1.3"><semantics id="S4.E10.m1.3a"><mrow id="S4.E10.m1.3.3.1" xref="S4.E10.m1.3.3.1.1.cmml"><mrow id="S4.E10.m1.3.3.1.1" xref="S4.E10.m1.3.3.1.1.cmml"><mrow id="S4.E10.m1.3.3.1.1.1" xref="S4.E10.m1.3.3.1.1.1.cmml"><mi id="S4.E10.m1.3.3.1.1.1.3" xref="S4.E10.m1.3.3.1.1.1.3.cmml">κ</mi><mo id="S4.E10.m1.3.3.1.1.1.2" xref="S4.E10.m1.3.3.1.1.1.2.cmml">⁢</mo><mrow id="S4.E10.m1.3.3.1.1.1.1.1" xref="S4.E10.m1.3.3.1.1.1.1.1.1.cmml"><mo id="S4.E10.m1.3.3.1.1.1.1.1.2" stretchy="false" xref="S4.E10.m1.3.3.1.1.1.1.1.1.cmml">(</mo><msub id="S4.E10.m1.3.3.1.1.1.1.1.1" xref="S4.E10.m1.3.3.1.1.1.1.1.1.cmml"><mi id="S4.E10.m1.3.3.1.1.1.1.1.1.2" xref="S4.E10.m1.3.3.1.1.1.1.1.1.2.cmml">𝐀</mi><mi id="S4.E10.m1.3.3.1.1.1.1.1.1.3" xref="S4.E10.m1.3.3.1.1.1.1.1.1.3.cmml">l</mi></msub><mo id="S4.E10.m1.3.3.1.1.1.1.1.3" stretchy="false" xref="S4.E10.m1.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E10.m1.3.3.1.1.5" xref="S4.E10.m1.3.3.1.1.5.cmml">=</mo><mrow id="S4.E10.m1.3.3.1.1.3" xref="S4.E10.m1.3.3.1.1.3.cmml"><msub id="S4.E10.m1.3.3.1.1.2.1" xref="S4.E10.m1.3.3.1.1.2.1.cmml"><mrow id="S4.E10.m1.3.3.1.1.2.1.1.1" xref="S4.E10.m1.3.3.1.1.2.1.1.2.cmml"><mo id="S4.E10.m1.3.3.1.1.2.1.1.1.2" stretchy="false" xref="S4.E10.m1.3.3.1.1.2.1.1.2.1.cmml">|</mo><msub id="S4.E10.m1.3.3.1.1.2.1.1.1.1" xref="S4.E10.m1.3.3.1.1.2.1.1.1.1.cmml"><mi id="S4.E10.m1.3.3.1.1.2.1.1.1.1.2" xref="S4.E10.m1.3.3.1.1.2.1.1.1.1.2.cmml">𝐀</mi><mi id="S4.E10.m1.3.3.1.1.2.1.1.1.1.3" xref="S4.E10.m1.3.3.1.1.2.1.1.1.1.3.cmml">l</mi></msub><mo id="S4.E10.m1.3.3.1.1.2.1.1.1.3" rspace="0.055em" stretchy="false" xref="S4.E10.m1.3.3.1.1.2.1.1.2.1.cmml">|</mo></mrow><mn id="S4.E10.m1.3.3.1.1.2.1.3" xref="S4.E10.m1.3.3.1.1.2.1.3.cmml">2</mn></msub><mo id="S4.E10.m1.3.3.1.1.3.3" rspace="0.222em" xref="S4.E10.m1.3.3.1.1.3.3.cmml">⋅</mo><msub id="S4.E10.m1.3.3.1.1.3.2" xref="S4.E10.m1.3.3.1.1.3.2.cmml"><mrow id="S4.E10.m1.3.3.1.1.3.2.1.1" xref="S4.E10.m1.3.3.1.1.3.2.1.2.cmml"><mo id="S4.E10.m1.3.3.1.1.3.2.1.1.2" stretchy="false" xref="S4.E10.m1.3.3.1.1.3.2.1.2.1.cmml">|</mo><msubsup id="S4.E10.m1.3.3.1.1.3.2.1.1.1" xref="S4.E10.m1.3.3.1.1.3.2.1.1.1.cmml"><mi id="S4.E10.m1.3.3.1.1.3.2.1.1.1.2.2" xref="S4.E10.m1.3.3.1.1.3.2.1.1.1.2.2.cmml">𝐀</mi><mi id="S4.E10.m1.3.3.1.1.3.2.1.1.1.2.3" xref="S4.E10.m1.3.3.1.1.3.2.1.1.1.2.3.cmml">l</mi><mrow id="S4.E10.m1.3.3.1.1.3.2.1.1.1.3" xref="S4.E10.m1.3.3.1.1.3.2.1.1.1.3.cmml"><mo id="S4.E10.m1.3.3.1.1.3.2.1.1.1.3a" xref="S4.E10.m1.3.3.1.1.3.2.1.1.1.3.cmml">−</mo><mn id="S4.E10.m1.3.3.1.1.3.2.1.1.1.3.2" xref="S4.E10.m1.3.3.1.1.3.2.1.1.1.3.2.cmml">1</mn></mrow></msubsup><mo id="S4.E10.m1.3.3.1.1.3.2.1.1.3" stretchy="false" xref="S4.E10.m1.3.3.1.1.3.2.1.2.1.cmml">|</mo></mrow><mn id="S4.E10.m1.3.3.1.1.3.2.3" xref="S4.E10.m1.3.3.1.1.3.2.3.cmml">2</mn></msub></mrow><mo id="S4.E10.m1.3.3.1.1.6" xref="S4.E10.m1.3.3.1.1.6.cmml">=</mo><mfrac id="S4.E10.m1.2.2" xref="S4.E10.m1.2.2.cmml"><mrow id="S4.E10.m1.1.1.1" xref="S4.E10.m1.1.1.1.cmml"><msub id="S4.E10.m1.1.1.1.3" xref="S4.E10.m1.1.1.1.3.cmml"><mi id="S4.E10.m1.1.1.1.3.2" xref="S4.E10.m1.1.1.1.3.2.cmml">σ</mi><mtext id="S4.E10.m1.1.1.1.3.3" xref="S4.E10.m1.1.1.1.3.3a.cmml">max</mtext></msub><mo id="S4.E10.m1.1.1.1.2" xref="S4.E10.m1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E10.m1.1.1.1.1.1" xref="S4.E10.m1.1.1.1.1.1.1.cmml"><mo id="S4.E10.m1.1.1.1.1.1.2" stretchy="false" xref="S4.E10.m1.1.1.1.1.1.1.cmml">(</mo><msub id="S4.E10.m1.1.1.1.1.1.1" xref="S4.E10.m1.1.1.1.1.1.1.cmml"><mi id="S4.E10.m1.1.1.1.1.1.1.2" xref="S4.E10.m1.1.1.1.1.1.1.2.cmml">𝐀</mi><mi id="S4.E10.m1.1.1.1.1.1.1.3" xref="S4.E10.m1.1.1.1.1.1.1.3.cmml">l</mi></msub><mo id="S4.E10.m1.1.1.1.1.1.3" stretchy="false" xref="S4.E10.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="S4.E10.m1.2.2.2" xref="S4.E10.m1.2.2.2.cmml"><msub id="S4.E10.m1.2.2.2.3" xref="S4.E10.m1.2.2.2.3.cmml"><mi id="S4.E10.m1.2.2.2.3.2" xref="S4.E10.m1.2.2.2.3.2.cmml">σ</mi><mtext id="S4.E10.m1.2.2.2.3.3" xref="S4.E10.m1.2.2.2.3.3a.cmml">min</mtext></msub><mo id="S4.E10.m1.2.2.2.2" xref="S4.E10.m1.2.2.2.2.cmml">⁢</mo><mrow id="S4.E10.m1.2.2.2.1.1" xref="S4.E10.m1.2.2.2.1.1.1.cmml"><mo id="S4.E10.m1.2.2.2.1.1.2" stretchy="false" xref="S4.E10.m1.2.2.2.1.1.1.cmml">(</mo><msub id="S4.E10.m1.2.2.2.1.1.1" xref="S4.E10.m1.2.2.2.1.1.1.cmml"><mi id="S4.E10.m1.2.2.2.1.1.1.2" xref="S4.E10.m1.2.2.2.1.1.1.2.cmml">𝐀</mi><mi id="S4.E10.m1.2.2.2.1.1.1.3" xref="S4.E10.m1.2.2.2.1.1.1.3.cmml">l</mi></msub><mo id="S4.E10.m1.2.2.2.1.1.3" stretchy="false" xref="S4.E10.m1.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mrow><mo id="S4.E10.m1.3.3.1.2" xref="S4.E10.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E10.m1.3b"><apply id="S4.E10.m1.3.3.1.1.cmml" xref="S4.E10.m1.3.3.1"><and id="S4.E10.m1.3.3.1.1a.cmml" xref="S4.E10.m1.3.3.1"></and><apply id="S4.E10.m1.3.3.1.1b.cmml" xref="S4.E10.m1.3.3.1"><eq id="S4.E10.m1.3.3.1.1.5.cmml" xref="S4.E10.m1.3.3.1.1.5"></eq><apply id="S4.E10.m1.3.3.1.1.1.cmml" xref="S4.E10.m1.3.3.1.1.1"><times id="S4.E10.m1.3.3.1.1.1.2.cmml" xref="S4.E10.m1.3.3.1.1.1.2"></times><ci id="S4.E10.m1.3.3.1.1.1.3.cmml" xref="S4.E10.m1.3.3.1.1.1.3">𝜅</ci><apply id="S4.E10.m1.3.3.1.1.1.1.1.1.cmml" xref="S4.E10.m1.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E10.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S4.E10.m1.3.3.1.1.1.1.1">subscript</csymbol><ci id="S4.E10.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S4.E10.m1.3.3.1.1.1.1.1.1.2">𝐀</ci><ci id="S4.E10.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S4.E10.m1.3.3.1.1.1.1.1.1.3">𝑙</ci></apply></apply><apply id="S4.E10.m1.3.3.1.1.3.cmml" xref="S4.E10.m1.3.3.1.1.3"><ci id="S4.E10.m1.3.3.1.1.3.3.cmml" xref="S4.E10.m1.3.3.1.1.3.3">⋅</ci><apply id="S4.E10.m1.3.3.1.1.2.1.cmml" xref="S4.E10.m1.3.3.1.1.2.1"><csymbol cd="ambiguous" id="S4.E10.m1.3.3.1.1.2.1.2.cmml" xref="S4.E10.m1.3.3.1.1.2.1">subscript</csymbol><apply id="S4.E10.m1.3.3.1.1.2.1.1.2.cmml" xref="S4.E10.m1.3.3.1.1.2.1.1.1"><abs id="S4.E10.m1.3.3.1.1.2.1.1.2.1.cmml" xref="S4.E10.m1.3.3.1.1.2.1.1.1.2"></abs><apply id="S4.E10.m1.3.3.1.1.2.1.1.1.1.cmml" xref="S4.E10.m1.3.3.1.1.2.1.1.1.1"><csymbol cd="ambiguous" id="S4.E10.m1.3.3.1.1.2.1.1.1.1.1.cmml" xref="S4.E10.m1.3.3.1.1.2.1.1.1.1">subscript</csymbol><ci id="S4.E10.m1.3.3.1.1.2.1.1.1.1.2.cmml" xref="S4.E10.m1.3.3.1.1.2.1.1.1.1.2">𝐀</ci><ci id="S4.E10.m1.3.3.1.1.2.1.1.1.1.3.cmml" xref="S4.E10.m1.3.3.1.1.2.1.1.1.1.3">𝑙</ci></apply></apply><cn id="S4.E10.m1.3.3.1.1.2.1.3.cmml" type="integer" xref="S4.E10.m1.3.3.1.1.2.1.3">2</cn></apply><apply id="S4.E10.m1.3.3.1.1.3.2.cmml" xref="S4.E10.m1.3.3.1.1.3.2"><csymbol cd="ambiguous" id="S4.E10.m1.3.3.1.1.3.2.2.cmml" xref="S4.E10.m1.3.3.1.1.3.2">subscript</csymbol><apply id="S4.E10.m1.3.3.1.1.3.2.1.2.cmml" xref="S4.E10.m1.3.3.1.1.3.2.1.1"><abs id="S4.E10.m1.3.3.1.1.3.2.1.2.1.cmml" xref="S4.E10.m1.3.3.1.1.3.2.1.1.2"></abs><apply id="S4.E10.m1.3.3.1.1.3.2.1.1.1.cmml" xref="S4.E10.m1.3.3.1.1.3.2.1.1.1"><csymbol cd="ambiguous" id="S4.E10.m1.3.3.1.1.3.2.1.1.1.1.cmml" xref="S4.E10.m1.3.3.1.1.3.2.1.1.1">superscript</csymbol><apply id="S4.E10.m1.3.3.1.1.3.2.1.1.1.2.cmml" xref="S4.E10.m1.3.3.1.1.3.2.1.1.1"><csymbol cd="ambiguous" id="S4.E10.m1.3.3.1.1.3.2.1.1.1.2.1.cmml" xref="S4.E10.m1.3.3.1.1.3.2.1.1.1">subscript</csymbol><ci id="S4.E10.m1.3.3.1.1.3.2.1.1.1.2.2.cmml" xref="S4.E10.m1.3.3.1.1.3.2.1.1.1.2.2">𝐀</ci><ci id="S4.E10.m1.3.3.1.1.3.2.1.1.1.2.3.cmml" xref="S4.E10.m1.3.3.1.1.3.2.1.1.1.2.3">𝑙</ci></apply><apply id="S4.E10.m1.3.3.1.1.3.2.1.1.1.3.cmml" xref="S4.E10.m1.3.3.1.1.3.2.1.1.1.3"><minus id="S4.E10.m1.3.3.1.1.3.2.1.1.1.3.1.cmml" xref="S4.E10.m1.3.3.1.1.3.2.1.1.1.3"></minus><cn id="S4.E10.m1.3.3.1.1.3.2.1.1.1.3.2.cmml" type="integer" xref="S4.E10.m1.3.3.1.1.3.2.1.1.1.3.2">1</cn></apply></apply></apply><cn id="S4.E10.m1.3.3.1.1.3.2.3.cmml" type="integer" xref="S4.E10.m1.3.3.1.1.3.2.3">2</cn></apply></apply></apply><apply id="S4.E10.m1.3.3.1.1c.cmml" xref="S4.E10.m1.3.3.1"><eq id="S4.E10.m1.3.3.1.1.6.cmml" xref="S4.E10.m1.3.3.1.1.6"></eq><share href="https://arxiv.org/html/2410.03111v1#S4.E10.m1.3.3.1.1.3.cmml" id="S4.E10.m1.3.3.1.1d.cmml" xref="S4.E10.m1.3.3.1"></share><apply id="S4.E10.m1.2.2.cmml" xref="S4.E10.m1.2.2"><divide id="S4.E10.m1.2.2.3.cmml" xref="S4.E10.m1.2.2"></divide><apply id="S4.E10.m1.1.1.1.cmml" xref="S4.E10.m1.1.1.1"><times id="S4.E10.m1.1.1.1.2.cmml" xref="S4.E10.m1.1.1.1.2"></times><apply id="S4.E10.m1.1.1.1.3.cmml" xref="S4.E10.m1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E10.m1.1.1.1.3.1.cmml" xref="S4.E10.m1.1.1.1.3">subscript</csymbol><ci id="S4.E10.m1.1.1.1.3.2.cmml" xref="S4.E10.m1.1.1.1.3.2">𝜎</ci><ci id="S4.E10.m1.1.1.1.3.3a.cmml" xref="S4.E10.m1.1.1.1.3.3"><mtext id="S4.E10.m1.1.1.1.3.3.cmml" mathsize="70%" xref="S4.E10.m1.1.1.1.3.3">max</mtext></ci></apply><apply id="S4.E10.m1.1.1.1.1.1.1.cmml" xref="S4.E10.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E10.m1.1.1.1.1.1.1.1.cmml" xref="S4.E10.m1.1.1.1.1.1">subscript</csymbol><ci id="S4.E10.m1.1.1.1.1.1.1.2.cmml" xref="S4.E10.m1.1.1.1.1.1.1.2">𝐀</ci><ci id="S4.E10.m1.1.1.1.1.1.1.3.cmml" xref="S4.E10.m1.1.1.1.1.1.1.3">𝑙</ci></apply></apply><apply id="S4.E10.m1.2.2.2.cmml" xref="S4.E10.m1.2.2.2"><times id="S4.E10.m1.2.2.2.2.cmml" xref="S4.E10.m1.2.2.2.2"></times><apply id="S4.E10.m1.2.2.2.3.cmml" xref="S4.E10.m1.2.2.2.3"><csymbol cd="ambiguous" id="S4.E10.m1.2.2.2.3.1.cmml" xref="S4.E10.m1.2.2.2.3">subscript</csymbol><ci id="S4.E10.m1.2.2.2.3.2.cmml" xref="S4.E10.m1.2.2.2.3.2">𝜎</ci><ci id="S4.E10.m1.2.2.2.3.3a.cmml" xref="S4.E10.m1.2.2.2.3.3"><mtext id="S4.E10.m1.2.2.2.3.3.cmml" mathsize="70%" xref="S4.E10.m1.2.2.2.3.3">min</mtext></ci></apply><apply id="S4.E10.m1.2.2.2.1.1.1.cmml" xref="S4.E10.m1.2.2.2.1.1"><csymbol cd="ambiguous" id="S4.E10.m1.2.2.2.1.1.1.1.cmml" xref="S4.E10.m1.2.2.2.1.1">subscript</csymbol><ci id="S4.E10.m1.2.2.2.1.1.1.2.cmml" xref="S4.E10.m1.2.2.2.1.1.1.2">𝐀</ci><ci id="S4.E10.m1.2.2.2.1.1.1.3.cmml" xref="S4.E10.m1.2.2.2.1.1.1.3">𝑙</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E10.m1.3c">\kappa(\mathbf{A}_{l})=|\mathbf{A}_{l}|_{2}\cdot|\mathbf{A}_{l}^{-1}|_{2}=%
\frac{\sigma_{\text{max}}(\mathbf{A}_{l})}{\sigma_{\text{min}}(\mathbf{A}_{l})},</annotation><annotation encoding="application/x-llamapun" id="S4.E10.m1.3d">italic_κ ( bold_A start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT ) = | bold_A start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT | start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ⋅ | bold_A start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT | start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT = divide start_ARG italic_σ start_POSTSUBSCRIPT max end_POSTSUBSCRIPT ( bold_A start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT ) end_ARG start_ARG italic_σ start_POSTSUBSCRIPT min end_POSTSUBSCRIPT ( bold_A start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT ) end_ARG ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS2.SSS0.Px1.p1.11">where <math alttext="\sigma_{\text{max}}(\mathbf{A}l)" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px1.p1.6.m1.1"><semantics id="S4.SS2.SSS0.Px1.p1.6.m1.1a"><mrow id="S4.SS2.SSS0.Px1.p1.6.m1.1.1" xref="S4.SS2.SSS0.Px1.p1.6.m1.1.1.cmml"><msub id="S4.SS2.SSS0.Px1.p1.6.m1.1.1.3" xref="S4.SS2.SSS0.Px1.p1.6.m1.1.1.3.cmml"><mi id="S4.SS2.SSS0.Px1.p1.6.m1.1.1.3.2" xref="S4.SS2.SSS0.Px1.p1.6.m1.1.1.3.2.cmml">σ</mi><mtext id="S4.SS2.SSS0.Px1.p1.6.m1.1.1.3.3" xref="S4.SS2.SSS0.Px1.p1.6.m1.1.1.3.3a.cmml">max</mtext></msub><mo id="S4.SS2.SSS0.Px1.p1.6.m1.1.1.2" xref="S4.SS2.SSS0.Px1.p1.6.m1.1.1.2.cmml">⁢</mo><mrow id="S4.SS2.SSS0.Px1.p1.6.m1.1.1.1.1" xref="S4.SS2.SSS0.Px1.p1.6.m1.1.1.1.1.1.cmml"><mo id="S4.SS2.SSS0.Px1.p1.6.m1.1.1.1.1.2" stretchy="false" xref="S4.SS2.SSS0.Px1.p1.6.m1.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS2.SSS0.Px1.p1.6.m1.1.1.1.1.1" xref="S4.SS2.SSS0.Px1.p1.6.m1.1.1.1.1.1.cmml"><mi id="S4.SS2.SSS0.Px1.p1.6.m1.1.1.1.1.1.2" xref="S4.SS2.SSS0.Px1.p1.6.m1.1.1.1.1.1.2.cmml">𝐀</mi><mo id="S4.SS2.SSS0.Px1.p1.6.m1.1.1.1.1.1.1" xref="S4.SS2.SSS0.Px1.p1.6.m1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S4.SS2.SSS0.Px1.p1.6.m1.1.1.1.1.1.3" xref="S4.SS2.SSS0.Px1.p1.6.m1.1.1.1.1.1.3.cmml">l</mi></mrow><mo id="S4.SS2.SSS0.Px1.p1.6.m1.1.1.1.1.3" stretchy="false" xref="S4.SS2.SSS0.Px1.p1.6.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p1.6.m1.1b"><apply id="S4.SS2.SSS0.Px1.p1.6.m1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.6.m1.1.1"><times id="S4.SS2.SSS0.Px1.p1.6.m1.1.1.2.cmml" xref="S4.SS2.SSS0.Px1.p1.6.m1.1.1.2"></times><apply id="S4.SS2.SSS0.Px1.p1.6.m1.1.1.3.cmml" xref="S4.SS2.SSS0.Px1.p1.6.m1.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px1.p1.6.m1.1.1.3.1.cmml" xref="S4.SS2.SSS0.Px1.p1.6.m1.1.1.3">subscript</csymbol><ci id="S4.SS2.SSS0.Px1.p1.6.m1.1.1.3.2.cmml" xref="S4.SS2.SSS0.Px1.p1.6.m1.1.1.3.2">𝜎</ci><ci id="S4.SS2.SSS0.Px1.p1.6.m1.1.1.3.3a.cmml" xref="S4.SS2.SSS0.Px1.p1.6.m1.1.1.3.3"><mtext id="S4.SS2.SSS0.Px1.p1.6.m1.1.1.3.3.cmml" mathsize="70%" xref="S4.SS2.SSS0.Px1.p1.6.m1.1.1.3.3">max</mtext></ci></apply><apply id="S4.SS2.SSS0.Px1.p1.6.m1.1.1.1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.6.m1.1.1.1.1"><times id="S4.SS2.SSS0.Px1.p1.6.m1.1.1.1.1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.6.m1.1.1.1.1.1.1"></times><ci id="S4.SS2.SSS0.Px1.p1.6.m1.1.1.1.1.1.2.cmml" xref="S4.SS2.SSS0.Px1.p1.6.m1.1.1.1.1.1.2">𝐀</ci><ci id="S4.SS2.SSS0.Px1.p1.6.m1.1.1.1.1.1.3.cmml" xref="S4.SS2.SSS0.Px1.p1.6.m1.1.1.1.1.1.3">𝑙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p1.6.m1.1c">\sigma_{\text{max}}(\mathbf{A}l)</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px1.p1.6.m1.1d">italic_σ start_POSTSUBSCRIPT max end_POSTSUBSCRIPT ( bold_A italic_l )</annotation></semantics></math> and <math alttext="\sigma_{\text{min}}(\mathbf{A}_{l})" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px1.p1.7.m2.1"><semantics id="S4.SS2.SSS0.Px1.p1.7.m2.1a"><mrow id="S4.SS2.SSS0.Px1.p1.7.m2.1.1" xref="S4.SS2.SSS0.Px1.p1.7.m2.1.1.cmml"><msub id="S4.SS2.SSS0.Px1.p1.7.m2.1.1.3" xref="S4.SS2.SSS0.Px1.p1.7.m2.1.1.3.cmml"><mi id="S4.SS2.SSS0.Px1.p1.7.m2.1.1.3.2" xref="S4.SS2.SSS0.Px1.p1.7.m2.1.1.3.2.cmml">σ</mi><mtext id="S4.SS2.SSS0.Px1.p1.7.m2.1.1.3.3" xref="S4.SS2.SSS0.Px1.p1.7.m2.1.1.3.3a.cmml">min</mtext></msub><mo id="S4.SS2.SSS0.Px1.p1.7.m2.1.1.2" xref="S4.SS2.SSS0.Px1.p1.7.m2.1.1.2.cmml">⁢</mo><mrow id="S4.SS2.SSS0.Px1.p1.7.m2.1.1.1.1" xref="S4.SS2.SSS0.Px1.p1.7.m2.1.1.1.1.1.cmml"><mo id="S4.SS2.SSS0.Px1.p1.7.m2.1.1.1.1.2" stretchy="false" xref="S4.SS2.SSS0.Px1.p1.7.m2.1.1.1.1.1.cmml">(</mo><msub id="S4.SS2.SSS0.Px1.p1.7.m2.1.1.1.1.1" xref="S4.SS2.SSS0.Px1.p1.7.m2.1.1.1.1.1.cmml"><mi id="S4.SS2.SSS0.Px1.p1.7.m2.1.1.1.1.1.2" xref="S4.SS2.SSS0.Px1.p1.7.m2.1.1.1.1.1.2.cmml">𝐀</mi><mi id="S4.SS2.SSS0.Px1.p1.7.m2.1.1.1.1.1.3" xref="S4.SS2.SSS0.Px1.p1.7.m2.1.1.1.1.1.3.cmml">l</mi></msub><mo id="S4.SS2.SSS0.Px1.p1.7.m2.1.1.1.1.3" stretchy="false" xref="S4.SS2.SSS0.Px1.p1.7.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p1.7.m2.1b"><apply id="S4.SS2.SSS0.Px1.p1.7.m2.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.7.m2.1.1"><times id="S4.SS2.SSS0.Px1.p1.7.m2.1.1.2.cmml" xref="S4.SS2.SSS0.Px1.p1.7.m2.1.1.2"></times><apply id="S4.SS2.SSS0.Px1.p1.7.m2.1.1.3.cmml" xref="S4.SS2.SSS0.Px1.p1.7.m2.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px1.p1.7.m2.1.1.3.1.cmml" xref="S4.SS2.SSS0.Px1.p1.7.m2.1.1.3">subscript</csymbol><ci id="S4.SS2.SSS0.Px1.p1.7.m2.1.1.3.2.cmml" xref="S4.SS2.SSS0.Px1.p1.7.m2.1.1.3.2">𝜎</ci><ci id="S4.SS2.SSS0.Px1.p1.7.m2.1.1.3.3a.cmml" xref="S4.SS2.SSS0.Px1.p1.7.m2.1.1.3.3"><mtext id="S4.SS2.SSS0.Px1.p1.7.m2.1.1.3.3.cmml" mathsize="70%" xref="S4.SS2.SSS0.Px1.p1.7.m2.1.1.3.3">min</mtext></ci></apply><apply id="S4.SS2.SSS0.Px1.p1.7.m2.1.1.1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.7.m2.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px1.p1.7.m2.1.1.1.1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.7.m2.1.1.1.1">subscript</csymbol><ci id="S4.SS2.SSS0.Px1.p1.7.m2.1.1.1.1.1.2.cmml" xref="S4.SS2.SSS0.Px1.p1.7.m2.1.1.1.1.1.2">𝐀</ci><ci id="S4.SS2.SSS0.Px1.p1.7.m2.1.1.1.1.1.3.cmml" xref="S4.SS2.SSS0.Px1.p1.7.m2.1.1.1.1.1.3">𝑙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p1.7.m2.1c">\sigma_{\text{min}}(\mathbf{A}_{l})</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px1.p1.7.m2.1d">italic_σ start_POSTSUBSCRIPT min end_POSTSUBSCRIPT ( bold_A start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT )</annotation></semantics></math> are the largest and smallest singular values of <math alttext="\mathbf{A}_{l}" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px1.p1.8.m3.1"><semantics id="S4.SS2.SSS0.Px1.p1.8.m3.1a"><msub id="S4.SS2.SSS0.Px1.p1.8.m3.1.1" xref="S4.SS2.SSS0.Px1.p1.8.m3.1.1.cmml"><mi id="S4.SS2.SSS0.Px1.p1.8.m3.1.1.2" xref="S4.SS2.SSS0.Px1.p1.8.m3.1.1.2.cmml">𝐀</mi><mi id="S4.SS2.SSS0.Px1.p1.8.m3.1.1.3" xref="S4.SS2.SSS0.Px1.p1.8.m3.1.1.3.cmml">l</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p1.8.m3.1b"><apply id="S4.SS2.SSS0.Px1.p1.8.m3.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.8.m3.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px1.p1.8.m3.1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.8.m3.1.1">subscript</csymbol><ci id="S4.SS2.SSS0.Px1.p1.8.m3.1.1.2.cmml" xref="S4.SS2.SSS0.Px1.p1.8.m3.1.1.2">𝐀</ci><ci id="S4.SS2.SSS0.Px1.p1.8.m3.1.1.3.cmml" xref="S4.SS2.SSS0.Px1.p1.8.m3.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p1.8.m3.1c">\mathbf{A}_{l}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px1.p1.8.m3.1d">bold_A start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT</annotation></semantics></math>, respectively.
To keep the relative change in the output <math alttext="\mathbf{b}_{l}" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px1.p1.9.m4.1"><semantics id="S4.SS2.SSS0.Px1.p1.9.m4.1a"><msub id="S4.SS2.SSS0.Px1.p1.9.m4.1.1" xref="S4.SS2.SSS0.Px1.p1.9.m4.1.1.cmml"><mi id="S4.SS2.SSS0.Px1.p1.9.m4.1.1.2" xref="S4.SS2.SSS0.Px1.p1.9.m4.1.1.2.cmml">𝐛</mi><mi id="S4.SS2.SSS0.Px1.p1.9.m4.1.1.3" xref="S4.SS2.SSS0.Px1.p1.9.m4.1.1.3.cmml">l</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p1.9.m4.1b"><apply id="S4.SS2.SSS0.Px1.p1.9.m4.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.9.m4.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px1.p1.9.m4.1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.9.m4.1.1">subscript</csymbol><ci id="S4.SS2.SSS0.Px1.p1.9.m4.1.1.2.cmml" xref="S4.SS2.SSS0.Px1.p1.9.m4.1.1.2">𝐛</ci><ci id="S4.SS2.SSS0.Px1.p1.9.m4.1.1.3.cmml" xref="S4.SS2.SSS0.Px1.p1.9.m4.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p1.9.m4.1c">\mathbf{b}_{l}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px1.p1.9.m4.1d">bold_b start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT</annotation></semantics></math> within a tolerance <math alttext="\epsilon" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px1.p1.10.m5.1"><semantics id="S4.SS2.SSS0.Px1.p1.10.m5.1a"><mi id="S4.SS2.SSS0.Px1.p1.10.m5.1.1" xref="S4.SS2.SSS0.Px1.p1.10.m5.1.1.cmml">ϵ</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p1.10.m5.1b"><ci id="S4.SS2.SSS0.Px1.p1.10.m5.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.10.m5.1.1">italic-ϵ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p1.10.m5.1c">\epsilon</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px1.p1.10.m5.1d">italic_ϵ</annotation></semantics></math>, we utilize the standard definition of the condition number to relate it to the allowable relative change in the input <math alttext="\mathbf{x}_{l}" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px1.p1.11.m6.1"><semantics id="S4.SS2.SSS0.Px1.p1.11.m6.1a"><msub id="S4.SS2.SSS0.Px1.p1.11.m6.1.1" xref="S4.SS2.SSS0.Px1.p1.11.m6.1.1.cmml"><mi id="S4.SS2.SSS0.Px1.p1.11.m6.1.1.2" xref="S4.SS2.SSS0.Px1.p1.11.m6.1.1.2.cmml">𝐱</mi><mi id="S4.SS2.SSS0.Px1.p1.11.m6.1.1.3" xref="S4.SS2.SSS0.Px1.p1.11.m6.1.1.3.cmml">l</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p1.11.m6.1b"><apply id="S4.SS2.SSS0.Px1.p1.11.m6.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.11.m6.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px1.p1.11.m6.1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.11.m6.1.1">subscript</csymbol><ci id="S4.SS2.SSS0.Px1.p1.11.m6.1.1.2.cmml" xref="S4.SS2.SSS0.Px1.p1.11.m6.1.1.2">𝐱</ci><ci id="S4.SS2.SSS0.Px1.p1.11.m6.1.1.3.cmml" xref="S4.SS2.SSS0.Px1.p1.11.m6.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p1.11.m6.1c">\mathbf{x}_{l}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px1.p1.11.m6.1d">bold_x start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT</annotation></semantics></math>:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E11">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\frac{|\Delta\mathbf{b}_{l}|_{2}}{|\mathbf{b}_{l}|_{2}}\leq\kappa(\mathbf{A}_{%
l})\cdot\frac{|\Delta\mathbf{x}_{l}|_{2}}{|\mathbf{x}_{l}|_{2}}\leq\epsilon." class="ltx_Math" display="block" id="S4.E11.m1.5"><semantics id="S4.E11.m1.5a"><mrow id="S4.E11.m1.5.5.1" xref="S4.E11.m1.5.5.1.1.cmml"><mrow id="S4.E11.m1.5.5.1.1" xref="S4.E11.m1.5.5.1.1.cmml"><mfrac id="S4.E11.m1.2.2" xref="S4.E11.m1.2.2.cmml"><msub id="S4.E11.m1.1.1.1" xref="S4.E11.m1.1.1.1.cmml"><mrow id="S4.E11.m1.1.1.1.1.1" xref="S4.E11.m1.1.1.1.1.2.cmml"><mo id="S4.E11.m1.1.1.1.1.1.2" stretchy="false" xref="S4.E11.m1.1.1.1.1.2.1.cmml">|</mo><mrow id="S4.E11.m1.1.1.1.1.1.1" xref="S4.E11.m1.1.1.1.1.1.1.cmml"><mi id="S4.E11.m1.1.1.1.1.1.1.2" mathvariant="normal" xref="S4.E11.m1.1.1.1.1.1.1.2.cmml">Δ</mi><mo id="S4.E11.m1.1.1.1.1.1.1.1" xref="S4.E11.m1.1.1.1.1.1.1.1.cmml">⁢</mo><msub id="S4.E11.m1.1.1.1.1.1.1.3" xref="S4.E11.m1.1.1.1.1.1.1.3.cmml"><mi id="S4.E11.m1.1.1.1.1.1.1.3.2" xref="S4.E11.m1.1.1.1.1.1.1.3.2.cmml">𝐛</mi><mi id="S4.E11.m1.1.1.1.1.1.1.3.3" xref="S4.E11.m1.1.1.1.1.1.1.3.3.cmml">l</mi></msub></mrow><mo id="S4.E11.m1.1.1.1.1.1.3" stretchy="false" xref="S4.E11.m1.1.1.1.1.2.1.cmml">|</mo></mrow><mn id="S4.E11.m1.1.1.1.3" xref="S4.E11.m1.1.1.1.3.cmml">2</mn></msub><msub id="S4.E11.m1.2.2.2" xref="S4.E11.m1.2.2.2.cmml"><mrow id="S4.E11.m1.2.2.2.1.1" xref="S4.E11.m1.2.2.2.1.2.cmml"><mo id="S4.E11.m1.2.2.2.1.1.2" stretchy="false" xref="S4.E11.m1.2.2.2.1.2.1.cmml">|</mo><msub id="S4.E11.m1.2.2.2.1.1.1" xref="S4.E11.m1.2.2.2.1.1.1.cmml"><mi id="S4.E11.m1.2.2.2.1.1.1.2" xref="S4.E11.m1.2.2.2.1.1.1.2.cmml">𝐛</mi><mi id="S4.E11.m1.2.2.2.1.1.1.3" xref="S4.E11.m1.2.2.2.1.1.1.3.cmml">l</mi></msub><mo id="S4.E11.m1.2.2.2.1.1.3" stretchy="false" xref="S4.E11.m1.2.2.2.1.2.1.cmml">|</mo></mrow><mn id="S4.E11.m1.2.2.2.3" xref="S4.E11.m1.2.2.2.3.cmml">2</mn></msub></mfrac><mo id="S4.E11.m1.5.5.1.1.3" xref="S4.E11.m1.5.5.1.1.3.cmml">≤</mo><mrow id="S4.E11.m1.5.5.1.1.1" xref="S4.E11.m1.5.5.1.1.1.cmml"><mrow id="S4.E11.m1.5.5.1.1.1.1" xref="S4.E11.m1.5.5.1.1.1.1.cmml"><mi id="S4.E11.m1.5.5.1.1.1.1.3" xref="S4.E11.m1.5.5.1.1.1.1.3.cmml">κ</mi><mo id="S4.E11.m1.5.5.1.1.1.1.2" xref="S4.E11.m1.5.5.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E11.m1.5.5.1.1.1.1.1.1" xref="S4.E11.m1.5.5.1.1.1.1.1.1.1.cmml"><mo id="S4.E11.m1.5.5.1.1.1.1.1.1.2" stretchy="false" xref="S4.E11.m1.5.5.1.1.1.1.1.1.1.cmml">(</mo><msub id="S4.E11.m1.5.5.1.1.1.1.1.1.1" xref="S4.E11.m1.5.5.1.1.1.1.1.1.1.cmml"><mi id="S4.E11.m1.5.5.1.1.1.1.1.1.1.2" xref="S4.E11.m1.5.5.1.1.1.1.1.1.1.2.cmml">𝐀</mi><mi id="S4.E11.m1.5.5.1.1.1.1.1.1.1.3" xref="S4.E11.m1.5.5.1.1.1.1.1.1.1.3.cmml">l</mi></msub><mo id="S4.E11.m1.5.5.1.1.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="S4.E11.m1.5.5.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E11.m1.5.5.1.1.1.2" rspace="0.222em" xref="S4.E11.m1.5.5.1.1.1.2.cmml">⋅</mo><mfrac id="S4.E11.m1.4.4" xref="S4.E11.m1.4.4.cmml"><msub id="S4.E11.m1.3.3.1" xref="S4.E11.m1.3.3.1.cmml"><mrow id="S4.E11.m1.3.3.1.1.1" xref="S4.E11.m1.3.3.1.1.2.cmml"><mo id="S4.E11.m1.3.3.1.1.1.2" stretchy="false" xref="S4.E11.m1.3.3.1.1.2.1.cmml">|</mo><mrow id="S4.E11.m1.3.3.1.1.1.1" xref="S4.E11.m1.3.3.1.1.1.1.cmml"><mi id="S4.E11.m1.3.3.1.1.1.1.2" mathvariant="normal" xref="S4.E11.m1.3.3.1.1.1.1.2.cmml">Δ</mi><mo id="S4.E11.m1.3.3.1.1.1.1.1" xref="S4.E11.m1.3.3.1.1.1.1.1.cmml">⁢</mo><msub id="S4.E11.m1.3.3.1.1.1.1.3" xref="S4.E11.m1.3.3.1.1.1.1.3.cmml"><mi id="S4.E11.m1.3.3.1.1.1.1.3.2" xref="S4.E11.m1.3.3.1.1.1.1.3.2.cmml">𝐱</mi><mi id="S4.E11.m1.3.3.1.1.1.1.3.3" xref="S4.E11.m1.3.3.1.1.1.1.3.3.cmml">l</mi></msub></mrow><mo id="S4.E11.m1.3.3.1.1.1.3" stretchy="false" xref="S4.E11.m1.3.3.1.1.2.1.cmml">|</mo></mrow><mn id="S4.E11.m1.3.3.1.3" xref="S4.E11.m1.3.3.1.3.cmml">2</mn></msub><msub id="S4.E11.m1.4.4.2" xref="S4.E11.m1.4.4.2.cmml"><mrow id="S4.E11.m1.4.4.2.1.1" xref="S4.E11.m1.4.4.2.1.2.cmml"><mo id="S4.E11.m1.4.4.2.1.1.2" stretchy="false" xref="S4.E11.m1.4.4.2.1.2.1.cmml">|</mo><msub id="S4.E11.m1.4.4.2.1.1.1" xref="S4.E11.m1.4.4.2.1.1.1.cmml"><mi id="S4.E11.m1.4.4.2.1.1.1.2" xref="S4.E11.m1.4.4.2.1.1.1.2.cmml">𝐱</mi><mi id="S4.E11.m1.4.4.2.1.1.1.3" xref="S4.E11.m1.4.4.2.1.1.1.3.cmml">l</mi></msub><mo id="S4.E11.m1.4.4.2.1.1.3" stretchy="false" xref="S4.E11.m1.4.4.2.1.2.1.cmml">|</mo></mrow><mn id="S4.E11.m1.4.4.2.3" xref="S4.E11.m1.4.4.2.3.cmml">2</mn></msub></mfrac></mrow><mo id="S4.E11.m1.5.5.1.1.4" xref="S4.E11.m1.5.5.1.1.4.cmml">≤</mo><mi id="S4.E11.m1.5.5.1.1.5" xref="S4.E11.m1.5.5.1.1.5.cmml">ϵ</mi></mrow><mo id="S4.E11.m1.5.5.1.2" lspace="0em" xref="S4.E11.m1.5.5.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E11.m1.5b"><apply id="S4.E11.m1.5.5.1.1.cmml" xref="S4.E11.m1.5.5.1"><and id="S4.E11.m1.5.5.1.1a.cmml" xref="S4.E11.m1.5.5.1"></and><apply id="S4.E11.m1.5.5.1.1b.cmml" xref="S4.E11.m1.5.5.1"><leq id="S4.E11.m1.5.5.1.1.3.cmml" xref="S4.E11.m1.5.5.1.1.3"></leq><apply id="S4.E11.m1.2.2.cmml" xref="S4.E11.m1.2.2"><divide id="S4.E11.m1.2.2.3.cmml" xref="S4.E11.m1.2.2"></divide><apply id="S4.E11.m1.1.1.1.cmml" xref="S4.E11.m1.1.1.1"><csymbol cd="ambiguous" id="S4.E11.m1.1.1.1.2.cmml" xref="S4.E11.m1.1.1.1">subscript</csymbol><apply id="S4.E11.m1.1.1.1.1.2.cmml" xref="S4.E11.m1.1.1.1.1.1"><abs id="S4.E11.m1.1.1.1.1.2.1.cmml" xref="S4.E11.m1.1.1.1.1.1.2"></abs><apply id="S4.E11.m1.1.1.1.1.1.1.cmml" xref="S4.E11.m1.1.1.1.1.1.1"><times id="S4.E11.m1.1.1.1.1.1.1.1.cmml" xref="S4.E11.m1.1.1.1.1.1.1.1"></times><ci id="S4.E11.m1.1.1.1.1.1.1.2.cmml" xref="S4.E11.m1.1.1.1.1.1.1.2">Δ</ci><apply id="S4.E11.m1.1.1.1.1.1.1.3.cmml" xref="S4.E11.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E11.m1.1.1.1.1.1.1.3.1.cmml" xref="S4.E11.m1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E11.m1.1.1.1.1.1.1.3.2.cmml" xref="S4.E11.m1.1.1.1.1.1.1.3.2">𝐛</ci><ci id="S4.E11.m1.1.1.1.1.1.1.3.3.cmml" xref="S4.E11.m1.1.1.1.1.1.1.3.3">𝑙</ci></apply></apply></apply><cn id="S4.E11.m1.1.1.1.3.cmml" type="integer" xref="S4.E11.m1.1.1.1.3">2</cn></apply><apply id="S4.E11.m1.2.2.2.cmml" xref="S4.E11.m1.2.2.2"><csymbol cd="ambiguous" id="S4.E11.m1.2.2.2.2.cmml" xref="S4.E11.m1.2.2.2">subscript</csymbol><apply id="S4.E11.m1.2.2.2.1.2.cmml" xref="S4.E11.m1.2.2.2.1.1"><abs id="S4.E11.m1.2.2.2.1.2.1.cmml" xref="S4.E11.m1.2.2.2.1.1.2"></abs><apply id="S4.E11.m1.2.2.2.1.1.1.cmml" xref="S4.E11.m1.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.E11.m1.2.2.2.1.1.1.1.cmml" xref="S4.E11.m1.2.2.2.1.1.1">subscript</csymbol><ci id="S4.E11.m1.2.2.2.1.1.1.2.cmml" xref="S4.E11.m1.2.2.2.1.1.1.2">𝐛</ci><ci id="S4.E11.m1.2.2.2.1.1.1.3.cmml" xref="S4.E11.m1.2.2.2.1.1.1.3">𝑙</ci></apply></apply><cn id="S4.E11.m1.2.2.2.3.cmml" type="integer" xref="S4.E11.m1.2.2.2.3">2</cn></apply></apply><apply id="S4.E11.m1.5.5.1.1.1.cmml" xref="S4.E11.m1.5.5.1.1.1"><ci id="S4.E11.m1.5.5.1.1.1.2.cmml" xref="S4.E11.m1.5.5.1.1.1.2">⋅</ci><apply id="S4.E11.m1.5.5.1.1.1.1.cmml" xref="S4.E11.m1.5.5.1.1.1.1"><times id="S4.E11.m1.5.5.1.1.1.1.2.cmml" xref="S4.E11.m1.5.5.1.1.1.1.2"></times><ci id="S4.E11.m1.5.5.1.1.1.1.3.cmml" xref="S4.E11.m1.5.5.1.1.1.1.3">𝜅</ci><apply id="S4.E11.m1.5.5.1.1.1.1.1.1.1.cmml" xref="S4.E11.m1.5.5.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E11.m1.5.5.1.1.1.1.1.1.1.1.cmml" xref="S4.E11.m1.5.5.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E11.m1.5.5.1.1.1.1.1.1.1.2.cmml" xref="S4.E11.m1.5.5.1.1.1.1.1.1.1.2">𝐀</ci><ci id="S4.E11.m1.5.5.1.1.1.1.1.1.1.3.cmml" xref="S4.E11.m1.5.5.1.1.1.1.1.1.1.3">𝑙</ci></apply></apply><apply id="S4.E11.m1.4.4.cmml" xref="S4.E11.m1.4.4"><divide id="S4.E11.m1.4.4.3.cmml" xref="S4.E11.m1.4.4"></divide><apply id="S4.E11.m1.3.3.1.cmml" xref="S4.E11.m1.3.3.1"><csymbol cd="ambiguous" id="S4.E11.m1.3.3.1.2.cmml" xref="S4.E11.m1.3.3.1">subscript</csymbol><apply id="S4.E11.m1.3.3.1.1.2.cmml" xref="S4.E11.m1.3.3.1.1.1"><abs id="S4.E11.m1.3.3.1.1.2.1.cmml" xref="S4.E11.m1.3.3.1.1.1.2"></abs><apply id="S4.E11.m1.3.3.1.1.1.1.cmml" xref="S4.E11.m1.3.3.1.1.1.1"><times id="S4.E11.m1.3.3.1.1.1.1.1.cmml" xref="S4.E11.m1.3.3.1.1.1.1.1"></times><ci id="S4.E11.m1.3.3.1.1.1.1.2.cmml" xref="S4.E11.m1.3.3.1.1.1.1.2">Δ</ci><apply id="S4.E11.m1.3.3.1.1.1.1.3.cmml" xref="S4.E11.m1.3.3.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E11.m1.3.3.1.1.1.1.3.1.cmml" xref="S4.E11.m1.3.3.1.1.1.1.3">subscript</csymbol><ci id="S4.E11.m1.3.3.1.1.1.1.3.2.cmml" xref="S4.E11.m1.3.3.1.1.1.1.3.2">𝐱</ci><ci id="S4.E11.m1.3.3.1.1.1.1.3.3.cmml" xref="S4.E11.m1.3.3.1.1.1.1.3.3">𝑙</ci></apply></apply></apply><cn id="S4.E11.m1.3.3.1.3.cmml" type="integer" xref="S4.E11.m1.3.3.1.3">2</cn></apply><apply id="S4.E11.m1.4.4.2.cmml" xref="S4.E11.m1.4.4.2"><csymbol cd="ambiguous" id="S4.E11.m1.4.4.2.2.cmml" xref="S4.E11.m1.4.4.2">subscript</csymbol><apply id="S4.E11.m1.4.4.2.1.2.cmml" xref="S4.E11.m1.4.4.2.1.1"><abs id="S4.E11.m1.4.4.2.1.2.1.cmml" xref="S4.E11.m1.4.4.2.1.1.2"></abs><apply id="S4.E11.m1.4.4.2.1.1.1.cmml" xref="S4.E11.m1.4.4.2.1.1.1"><csymbol cd="ambiguous" id="S4.E11.m1.4.4.2.1.1.1.1.cmml" xref="S4.E11.m1.4.4.2.1.1.1">subscript</csymbol><ci id="S4.E11.m1.4.4.2.1.1.1.2.cmml" xref="S4.E11.m1.4.4.2.1.1.1.2">𝐱</ci><ci id="S4.E11.m1.4.4.2.1.1.1.3.cmml" xref="S4.E11.m1.4.4.2.1.1.1.3">𝑙</ci></apply></apply><cn id="S4.E11.m1.4.4.2.3.cmml" type="integer" xref="S4.E11.m1.4.4.2.3">2</cn></apply></apply></apply></apply><apply id="S4.E11.m1.5.5.1.1c.cmml" xref="S4.E11.m1.5.5.1"><leq id="S4.E11.m1.5.5.1.1.4.cmml" xref="S4.E11.m1.5.5.1.1.4"></leq><share href="https://arxiv.org/html/2410.03111v1#S4.E11.m1.5.5.1.1.1.cmml" id="S4.E11.m1.5.5.1.1d.cmml" xref="S4.E11.m1.5.5.1"></share><ci id="S4.E11.m1.5.5.1.1.5.cmml" xref="S4.E11.m1.5.5.1.1.5">italic-ϵ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E11.m1.5c">\frac{|\Delta\mathbf{b}_{l}|_{2}}{|\mathbf{b}_{l}|_{2}}\leq\kappa(\mathbf{A}_{%
l})\cdot\frac{|\Delta\mathbf{x}_{l}|_{2}}{|\mathbf{x}_{l}|_{2}}\leq\epsilon.</annotation><annotation encoding="application/x-llamapun" id="S4.E11.m1.5d">divide start_ARG | roman_Δ bold_b start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT | start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_ARG start_ARG | bold_b start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT | start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_ARG ≤ italic_κ ( bold_A start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT ) ⋅ divide start_ARG | roman_Δ bold_x start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT | start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_ARG start_ARG | bold_x start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT | start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_ARG ≤ italic_ϵ .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(11)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS2.SSS0.Px1.p1.16">Solving for the allowable relative change in <math alttext="\mathbf{x}_{l}" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px1.p1.12.m1.1"><semantics id="S4.SS2.SSS0.Px1.p1.12.m1.1a"><msub id="S4.SS2.SSS0.Px1.p1.12.m1.1.1" xref="S4.SS2.SSS0.Px1.p1.12.m1.1.1.cmml"><mi id="S4.SS2.SSS0.Px1.p1.12.m1.1.1.2" xref="S4.SS2.SSS0.Px1.p1.12.m1.1.1.2.cmml">𝐱</mi><mi id="S4.SS2.SSS0.Px1.p1.12.m1.1.1.3" xref="S4.SS2.SSS0.Px1.p1.12.m1.1.1.3.cmml">l</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p1.12.m1.1b"><apply id="S4.SS2.SSS0.Px1.p1.12.m1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.12.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px1.p1.12.m1.1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.12.m1.1.1">subscript</csymbol><ci id="S4.SS2.SSS0.Px1.p1.12.m1.1.1.2.cmml" xref="S4.SS2.SSS0.Px1.p1.12.m1.1.1.2">𝐱</ci><ci id="S4.SS2.SSS0.Px1.p1.12.m1.1.1.3.cmml" xref="S4.SS2.SSS0.Px1.p1.12.m1.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p1.12.m1.1c">\mathbf{x}_{l}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px1.p1.12.m1.1d">bold_x start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT</annotation></semantics></math>, we obtain:
<math alttext="\frac{|\Delta\mathbf{x}_{l}|_{2}}{|\mathbf{x}_{l}|_{2}}\leq\frac{\epsilon}{%
\kappa(\mathbf{A}_{l})}" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px1.p1.13.m2.3"><semantics id="S4.SS2.SSS0.Px1.p1.13.m2.3a"><mrow id="S4.SS2.SSS0.Px1.p1.13.m2.3.4" xref="S4.SS2.SSS0.Px1.p1.13.m2.3.4.cmml"><mfrac id="S4.SS2.SSS0.Px1.p1.13.m2.2.2" xref="S4.SS2.SSS0.Px1.p1.13.m2.2.2.cmml"><msub id="S4.SS2.SSS0.Px1.p1.13.m2.1.1.1" xref="S4.SS2.SSS0.Px1.p1.13.m2.1.1.1.cmml"><mrow id="S4.SS2.SSS0.Px1.p1.13.m2.1.1.1.1.1" xref="S4.SS2.SSS0.Px1.p1.13.m2.1.1.1.1.2.cmml"><mo id="S4.SS2.SSS0.Px1.p1.13.m2.1.1.1.1.1.2" stretchy="false" xref="S4.SS2.SSS0.Px1.p1.13.m2.1.1.1.1.2.1.cmml">|</mo><mrow id="S4.SS2.SSS0.Px1.p1.13.m2.1.1.1.1.1.1" xref="S4.SS2.SSS0.Px1.p1.13.m2.1.1.1.1.1.1.cmml"><mi id="S4.SS2.SSS0.Px1.p1.13.m2.1.1.1.1.1.1.2" mathvariant="normal" xref="S4.SS2.SSS0.Px1.p1.13.m2.1.1.1.1.1.1.2.cmml">Δ</mi><mo id="S4.SS2.SSS0.Px1.p1.13.m2.1.1.1.1.1.1.1" xref="S4.SS2.SSS0.Px1.p1.13.m2.1.1.1.1.1.1.1.cmml">⁢</mo><msub id="S4.SS2.SSS0.Px1.p1.13.m2.1.1.1.1.1.1.3" xref="S4.SS2.SSS0.Px1.p1.13.m2.1.1.1.1.1.1.3.cmml"><mi id="S4.SS2.SSS0.Px1.p1.13.m2.1.1.1.1.1.1.3.2" xref="S4.SS2.SSS0.Px1.p1.13.m2.1.1.1.1.1.1.3.2.cmml">𝐱</mi><mi id="S4.SS2.SSS0.Px1.p1.13.m2.1.1.1.1.1.1.3.3" xref="S4.SS2.SSS0.Px1.p1.13.m2.1.1.1.1.1.1.3.3.cmml">l</mi></msub></mrow><mo id="S4.SS2.SSS0.Px1.p1.13.m2.1.1.1.1.1.3" stretchy="false" xref="S4.SS2.SSS0.Px1.p1.13.m2.1.1.1.1.2.1.cmml">|</mo></mrow><mn id="S4.SS2.SSS0.Px1.p1.13.m2.1.1.1.3" xref="S4.SS2.SSS0.Px1.p1.13.m2.1.1.1.3.cmml">2</mn></msub><msub id="S4.SS2.SSS0.Px1.p1.13.m2.2.2.2" xref="S4.SS2.SSS0.Px1.p1.13.m2.2.2.2.cmml"><mrow id="S4.SS2.SSS0.Px1.p1.13.m2.2.2.2.1.1" xref="S4.SS2.SSS0.Px1.p1.13.m2.2.2.2.1.2.cmml"><mo id="S4.SS2.SSS0.Px1.p1.13.m2.2.2.2.1.1.2" stretchy="false" xref="S4.SS2.SSS0.Px1.p1.13.m2.2.2.2.1.2.1.cmml">|</mo><msub id="S4.SS2.SSS0.Px1.p1.13.m2.2.2.2.1.1.1" xref="S4.SS2.SSS0.Px1.p1.13.m2.2.2.2.1.1.1.cmml"><mi id="S4.SS2.SSS0.Px1.p1.13.m2.2.2.2.1.1.1.2" xref="S4.SS2.SSS0.Px1.p1.13.m2.2.2.2.1.1.1.2.cmml">𝐱</mi><mi id="S4.SS2.SSS0.Px1.p1.13.m2.2.2.2.1.1.1.3" xref="S4.SS2.SSS0.Px1.p1.13.m2.2.2.2.1.1.1.3.cmml">l</mi></msub><mo id="S4.SS2.SSS0.Px1.p1.13.m2.2.2.2.1.1.3" stretchy="false" xref="S4.SS2.SSS0.Px1.p1.13.m2.2.2.2.1.2.1.cmml">|</mo></mrow><mn id="S4.SS2.SSS0.Px1.p1.13.m2.2.2.2.3" xref="S4.SS2.SSS0.Px1.p1.13.m2.2.2.2.3.cmml">2</mn></msub></mfrac><mo id="S4.SS2.SSS0.Px1.p1.13.m2.3.4.1" xref="S4.SS2.SSS0.Px1.p1.13.m2.3.4.1.cmml">≤</mo><mfrac id="S4.SS2.SSS0.Px1.p1.13.m2.3.3" xref="S4.SS2.SSS0.Px1.p1.13.m2.3.3.cmml"><mi id="S4.SS2.SSS0.Px1.p1.13.m2.3.3.3" xref="S4.SS2.SSS0.Px1.p1.13.m2.3.3.3.cmml">ϵ</mi><mrow id="S4.SS2.SSS0.Px1.p1.13.m2.3.3.1" xref="S4.SS2.SSS0.Px1.p1.13.m2.3.3.1.cmml"><mi id="S4.SS2.SSS0.Px1.p1.13.m2.3.3.1.3" xref="S4.SS2.SSS0.Px1.p1.13.m2.3.3.1.3.cmml">κ</mi><mo id="S4.SS2.SSS0.Px1.p1.13.m2.3.3.1.2" xref="S4.SS2.SSS0.Px1.p1.13.m2.3.3.1.2.cmml">⁢</mo><mrow id="S4.SS2.SSS0.Px1.p1.13.m2.3.3.1.1.1" xref="S4.SS2.SSS0.Px1.p1.13.m2.3.3.1.1.1.1.cmml"><mo id="S4.SS2.SSS0.Px1.p1.13.m2.3.3.1.1.1.2" stretchy="false" xref="S4.SS2.SSS0.Px1.p1.13.m2.3.3.1.1.1.1.cmml">(</mo><msub id="S4.SS2.SSS0.Px1.p1.13.m2.3.3.1.1.1.1" xref="S4.SS2.SSS0.Px1.p1.13.m2.3.3.1.1.1.1.cmml"><mi id="S4.SS2.SSS0.Px1.p1.13.m2.3.3.1.1.1.1.2" xref="S4.SS2.SSS0.Px1.p1.13.m2.3.3.1.1.1.1.2.cmml">𝐀</mi><mi id="S4.SS2.SSS0.Px1.p1.13.m2.3.3.1.1.1.1.3" xref="S4.SS2.SSS0.Px1.p1.13.m2.3.3.1.1.1.1.3.cmml">l</mi></msub><mo id="S4.SS2.SSS0.Px1.p1.13.m2.3.3.1.1.1.3" stretchy="false" xref="S4.SS2.SSS0.Px1.p1.13.m2.3.3.1.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p1.13.m2.3b"><apply id="S4.SS2.SSS0.Px1.p1.13.m2.3.4.cmml" xref="S4.SS2.SSS0.Px1.p1.13.m2.3.4"><leq id="S4.SS2.SSS0.Px1.p1.13.m2.3.4.1.cmml" xref="S4.SS2.SSS0.Px1.p1.13.m2.3.4.1"></leq><apply id="S4.SS2.SSS0.Px1.p1.13.m2.2.2.cmml" xref="S4.SS2.SSS0.Px1.p1.13.m2.2.2"><divide id="S4.SS2.SSS0.Px1.p1.13.m2.2.2.3.cmml" xref="S4.SS2.SSS0.Px1.p1.13.m2.2.2"></divide><apply id="S4.SS2.SSS0.Px1.p1.13.m2.1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.13.m2.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px1.p1.13.m2.1.1.1.2.cmml" xref="S4.SS2.SSS0.Px1.p1.13.m2.1.1.1">subscript</csymbol><apply id="S4.SS2.SSS0.Px1.p1.13.m2.1.1.1.1.2.cmml" xref="S4.SS2.SSS0.Px1.p1.13.m2.1.1.1.1.1"><abs id="S4.SS2.SSS0.Px1.p1.13.m2.1.1.1.1.2.1.cmml" xref="S4.SS2.SSS0.Px1.p1.13.m2.1.1.1.1.1.2"></abs><apply id="S4.SS2.SSS0.Px1.p1.13.m2.1.1.1.1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.13.m2.1.1.1.1.1.1"><times id="S4.SS2.SSS0.Px1.p1.13.m2.1.1.1.1.1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.13.m2.1.1.1.1.1.1.1"></times><ci id="S4.SS2.SSS0.Px1.p1.13.m2.1.1.1.1.1.1.2.cmml" xref="S4.SS2.SSS0.Px1.p1.13.m2.1.1.1.1.1.1.2">Δ</ci><apply id="S4.SS2.SSS0.Px1.p1.13.m2.1.1.1.1.1.1.3.cmml" xref="S4.SS2.SSS0.Px1.p1.13.m2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px1.p1.13.m2.1.1.1.1.1.1.3.1.cmml" xref="S4.SS2.SSS0.Px1.p1.13.m2.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.SS2.SSS0.Px1.p1.13.m2.1.1.1.1.1.1.3.2.cmml" xref="S4.SS2.SSS0.Px1.p1.13.m2.1.1.1.1.1.1.3.2">𝐱</ci><ci id="S4.SS2.SSS0.Px1.p1.13.m2.1.1.1.1.1.1.3.3.cmml" xref="S4.SS2.SSS0.Px1.p1.13.m2.1.1.1.1.1.1.3.3">𝑙</ci></apply></apply></apply><cn id="S4.SS2.SSS0.Px1.p1.13.m2.1.1.1.3.cmml" type="integer" xref="S4.SS2.SSS0.Px1.p1.13.m2.1.1.1.3">2</cn></apply><apply id="S4.SS2.SSS0.Px1.p1.13.m2.2.2.2.cmml" xref="S4.SS2.SSS0.Px1.p1.13.m2.2.2.2"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px1.p1.13.m2.2.2.2.2.cmml" xref="S4.SS2.SSS0.Px1.p1.13.m2.2.2.2">subscript</csymbol><apply id="S4.SS2.SSS0.Px1.p1.13.m2.2.2.2.1.2.cmml" xref="S4.SS2.SSS0.Px1.p1.13.m2.2.2.2.1.1"><abs id="S4.SS2.SSS0.Px1.p1.13.m2.2.2.2.1.2.1.cmml" xref="S4.SS2.SSS0.Px1.p1.13.m2.2.2.2.1.1.2"></abs><apply id="S4.SS2.SSS0.Px1.p1.13.m2.2.2.2.1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.13.m2.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px1.p1.13.m2.2.2.2.1.1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.13.m2.2.2.2.1.1.1">subscript</csymbol><ci id="S4.SS2.SSS0.Px1.p1.13.m2.2.2.2.1.1.1.2.cmml" xref="S4.SS2.SSS0.Px1.p1.13.m2.2.2.2.1.1.1.2">𝐱</ci><ci id="S4.SS2.SSS0.Px1.p1.13.m2.2.2.2.1.1.1.3.cmml" xref="S4.SS2.SSS0.Px1.p1.13.m2.2.2.2.1.1.1.3">𝑙</ci></apply></apply><cn id="S4.SS2.SSS0.Px1.p1.13.m2.2.2.2.3.cmml" type="integer" xref="S4.SS2.SSS0.Px1.p1.13.m2.2.2.2.3">2</cn></apply></apply><apply id="S4.SS2.SSS0.Px1.p1.13.m2.3.3.cmml" xref="S4.SS2.SSS0.Px1.p1.13.m2.3.3"><divide id="S4.SS2.SSS0.Px1.p1.13.m2.3.3.2.cmml" xref="S4.SS2.SSS0.Px1.p1.13.m2.3.3"></divide><ci id="S4.SS2.SSS0.Px1.p1.13.m2.3.3.3.cmml" xref="S4.SS2.SSS0.Px1.p1.13.m2.3.3.3">italic-ϵ</ci><apply id="S4.SS2.SSS0.Px1.p1.13.m2.3.3.1.cmml" xref="S4.SS2.SSS0.Px1.p1.13.m2.3.3.1"><times id="S4.SS2.SSS0.Px1.p1.13.m2.3.3.1.2.cmml" xref="S4.SS2.SSS0.Px1.p1.13.m2.3.3.1.2"></times><ci id="S4.SS2.SSS0.Px1.p1.13.m2.3.3.1.3.cmml" xref="S4.SS2.SSS0.Px1.p1.13.m2.3.3.1.3">𝜅</ci><apply id="S4.SS2.SSS0.Px1.p1.13.m2.3.3.1.1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.13.m2.3.3.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px1.p1.13.m2.3.3.1.1.1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.13.m2.3.3.1.1.1">subscript</csymbol><ci id="S4.SS2.SSS0.Px1.p1.13.m2.3.3.1.1.1.1.2.cmml" xref="S4.SS2.SSS0.Px1.p1.13.m2.3.3.1.1.1.1.2">𝐀</ci><ci id="S4.SS2.SSS0.Px1.p1.13.m2.3.3.1.1.1.1.3.cmml" xref="S4.SS2.SSS0.Px1.p1.13.m2.3.3.1.1.1.1.3">𝑙</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p1.13.m2.3c">\frac{|\Delta\mathbf{x}_{l}|_{2}}{|\mathbf{x}_{l}|_{2}}\leq\frac{\epsilon}{%
\kappa(\mathbf{A}_{l})}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px1.p1.13.m2.3d">divide start_ARG | roman_Δ bold_x start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT | start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_ARG start_ARG | bold_x start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT | start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_ARG ≤ divide start_ARG italic_ϵ end_ARG start_ARG italic_κ ( bold_A start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT ) end_ARG</annotation></semantics></math>.
This inequality indicates that the acceptable change in the input <math alttext="\mathbf{x}_{l}" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px1.p1.14.m3.1"><semantics id="S4.SS2.SSS0.Px1.p1.14.m3.1a"><msub id="S4.SS2.SSS0.Px1.p1.14.m3.1.1" xref="S4.SS2.SSS0.Px1.p1.14.m3.1.1.cmml"><mi id="S4.SS2.SSS0.Px1.p1.14.m3.1.1.2" xref="S4.SS2.SSS0.Px1.p1.14.m3.1.1.2.cmml">𝐱</mi><mi id="S4.SS2.SSS0.Px1.p1.14.m3.1.1.3" xref="S4.SS2.SSS0.Px1.p1.14.m3.1.1.3.cmml">l</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p1.14.m3.1b"><apply id="S4.SS2.SSS0.Px1.p1.14.m3.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.14.m3.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px1.p1.14.m3.1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.14.m3.1.1">subscript</csymbol><ci id="S4.SS2.SSS0.Px1.p1.14.m3.1.1.2.cmml" xref="S4.SS2.SSS0.Px1.p1.14.m3.1.1.2">𝐱</ci><ci id="S4.SS2.SSS0.Px1.p1.14.m3.1.1.3.cmml" xref="S4.SS2.SSS0.Px1.p1.14.m3.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p1.14.m3.1c">\mathbf{x}_{l}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px1.p1.14.m3.1d">bold_x start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT</annotation></semantics></math> is <span class="ltx_text ltx_font_italic" id="S4.SS2.SSS0.Px1.p1.16.1">inversely proportional</span> to the condition number <math alttext="\kappa(\mathbf{A}_{l})" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px1.p1.15.m4.1"><semantics id="S4.SS2.SSS0.Px1.p1.15.m4.1a"><mrow id="S4.SS2.SSS0.Px1.p1.15.m4.1.1" xref="S4.SS2.SSS0.Px1.p1.15.m4.1.1.cmml"><mi id="S4.SS2.SSS0.Px1.p1.15.m4.1.1.3" xref="S4.SS2.SSS0.Px1.p1.15.m4.1.1.3.cmml">κ</mi><mo id="S4.SS2.SSS0.Px1.p1.15.m4.1.1.2" xref="S4.SS2.SSS0.Px1.p1.15.m4.1.1.2.cmml">⁢</mo><mrow id="S4.SS2.SSS0.Px1.p1.15.m4.1.1.1.1" xref="S4.SS2.SSS0.Px1.p1.15.m4.1.1.1.1.1.cmml"><mo id="S4.SS2.SSS0.Px1.p1.15.m4.1.1.1.1.2" stretchy="false" xref="S4.SS2.SSS0.Px1.p1.15.m4.1.1.1.1.1.cmml">(</mo><msub id="S4.SS2.SSS0.Px1.p1.15.m4.1.1.1.1.1" xref="S4.SS2.SSS0.Px1.p1.15.m4.1.1.1.1.1.cmml"><mi id="S4.SS2.SSS0.Px1.p1.15.m4.1.1.1.1.1.2" xref="S4.SS2.SSS0.Px1.p1.15.m4.1.1.1.1.1.2.cmml">𝐀</mi><mi id="S4.SS2.SSS0.Px1.p1.15.m4.1.1.1.1.1.3" xref="S4.SS2.SSS0.Px1.p1.15.m4.1.1.1.1.1.3.cmml">l</mi></msub><mo id="S4.SS2.SSS0.Px1.p1.15.m4.1.1.1.1.3" stretchy="false" xref="S4.SS2.SSS0.Px1.p1.15.m4.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p1.15.m4.1b"><apply id="S4.SS2.SSS0.Px1.p1.15.m4.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.15.m4.1.1"><times id="S4.SS2.SSS0.Px1.p1.15.m4.1.1.2.cmml" xref="S4.SS2.SSS0.Px1.p1.15.m4.1.1.2"></times><ci id="S4.SS2.SSS0.Px1.p1.15.m4.1.1.3.cmml" xref="S4.SS2.SSS0.Px1.p1.15.m4.1.1.3">𝜅</ci><apply id="S4.SS2.SSS0.Px1.p1.15.m4.1.1.1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.15.m4.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px1.p1.15.m4.1.1.1.1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.15.m4.1.1.1.1">subscript</csymbol><ci id="S4.SS2.SSS0.Px1.p1.15.m4.1.1.1.1.1.2.cmml" xref="S4.SS2.SSS0.Px1.p1.15.m4.1.1.1.1.1.2">𝐀</ci><ci id="S4.SS2.SSS0.Px1.p1.15.m4.1.1.1.1.1.3.cmml" xref="S4.SS2.SSS0.Px1.p1.15.m4.1.1.1.1.1.3">𝑙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p1.15.m4.1c">\kappa(\mathbf{A}_{l})</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px1.p1.15.m4.1d">italic_κ ( bold_A start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT )</annotation></semantics></math> of the layer’s weight matrix. Layers with higher condition numbers are more sensitive to input perturbations, requiring smaller changes in <math alttext="\mathbf{x}_{l}" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px1.p1.16.m5.1"><semantics id="S4.SS2.SSS0.Px1.p1.16.m5.1a"><msub id="S4.SS2.SSS0.Px1.p1.16.m5.1.1" xref="S4.SS2.SSS0.Px1.p1.16.m5.1.1.cmml"><mi id="S4.SS2.SSS0.Px1.p1.16.m5.1.1.2" xref="S4.SS2.SSS0.Px1.p1.16.m5.1.1.2.cmml">𝐱</mi><mi id="S4.SS2.SSS0.Px1.p1.16.m5.1.1.3" xref="S4.SS2.SSS0.Px1.p1.16.m5.1.1.3.cmml">l</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p1.16.m5.1b"><apply id="S4.SS2.SSS0.Px1.p1.16.m5.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.16.m5.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px1.p1.16.m5.1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.16.m5.1.1">subscript</csymbol><ci id="S4.SS2.SSS0.Px1.p1.16.m5.1.1.2.cmml" xref="S4.SS2.SSS0.Px1.p1.16.m5.1.1.2">𝐱</ci><ci id="S4.SS2.SSS0.Px1.p1.16.m5.1.1.3.cmml" xref="S4.SS2.SSS0.Px1.p1.16.m5.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p1.16.m5.1c">\mathbf{x}_{l}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px1.p1.16.m5.1d">bold_x start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT</annotation></semantics></math> to maintain the output within the desired range.
Given the multi-layer structure of transformers, it is essential to consider not just the condition number of a single layer but the cumulative effect of condition numbers from all preceding layers. This cumulative measure gives a more holistic view of how perturbations might propagate and amplify as data passes through successive layers.</p>
</div>
<div class="ltx_para" id="S4.SS2.SSS0.Px1.p2">
<p class="ltx_p" id="S4.SS2.SSS0.Px1.p2.2"><span class="ltx_text ltx_font_bold" id="S4.SS2.SSS0.Px1.p2.2.1">Cumulative Condition Number</span>: To effectively manage this across the network, we calculate the cumulative condition number as an estimated layer sensitivity, which we then use to derive the compression dimension. For a model with <math alttext="L" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px1.p2.1.m1.1"><semantics id="S4.SS2.SSS0.Px1.p2.1.m1.1a"><mi id="S4.SS2.SSS0.Px1.p2.1.m1.1.1" xref="S4.SS2.SSS0.Px1.p2.1.m1.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p2.1.m1.1b"><ci id="S4.SS2.SSS0.Px1.p2.1.m1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p2.1.m1.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p2.1.m1.1c">L</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px1.p2.1.m1.1d">italic_L</annotation></semantics></math> layers, we calculate the cumulative condition number for each layer <math alttext="l" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px1.p2.2.m2.1"><semantics id="S4.SS2.SSS0.Px1.p2.2.m2.1a"><mi id="S4.SS2.SSS0.Px1.p2.2.m2.1.1" xref="S4.SS2.SSS0.Px1.p2.2.m2.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p2.2.m2.1b"><ci id="S4.SS2.SSS0.Px1.p2.2.m2.1.1.cmml" xref="S4.SS2.SSS0.Px1.p2.2.m2.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p2.2.m2.1c">l</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px1.p2.2.m2.1d">italic_l</annotation></semantics></math> by multiplying the condition numbers of the current layer and all subsequent layers:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E12">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\tilde{\kappa}_{l}=\prod_{j=l}^{L}\kappa(W_{k}^{j})\cdot\kappa(W_{v}^{j})," class="ltx_Math" display="block" id="S4.E12.m1.1"><semantics id="S4.E12.m1.1a"><mrow id="S4.E12.m1.1.1.1" xref="S4.E12.m1.1.1.1.1.cmml"><mrow id="S4.E12.m1.1.1.1.1" xref="S4.E12.m1.1.1.1.1.cmml"><msub id="S4.E12.m1.1.1.1.1.4" xref="S4.E12.m1.1.1.1.1.4.cmml"><mover accent="true" id="S4.E12.m1.1.1.1.1.4.2" xref="S4.E12.m1.1.1.1.1.4.2.cmml"><mi id="S4.E12.m1.1.1.1.1.4.2.2" xref="S4.E12.m1.1.1.1.1.4.2.2.cmml">κ</mi><mo id="S4.E12.m1.1.1.1.1.4.2.1" xref="S4.E12.m1.1.1.1.1.4.2.1.cmml">~</mo></mover><mi id="S4.E12.m1.1.1.1.1.4.3" xref="S4.E12.m1.1.1.1.1.4.3.cmml">l</mi></msub><mo id="S4.E12.m1.1.1.1.1.3" rspace="0.111em" xref="S4.E12.m1.1.1.1.1.3.cmml">=</mo><mrow id="S4.E12.m1.1.1.1.1.2" xref="S4.E12.m1.1.1.1.1.2.cmml"><munderover id="S4.E12.m1.1.1.1.1.2.3" xref="S4.E12.m1.1.1.1.1.2.3.cmml"><mo id="S4.E12.m1.1.1.1.1.2.3.2.2" movablelimits="false" xref="S4.E12.m1.1.1.1.1.2.3.2.2.cmml">∏</mo><mrow id="S4.E12.m1.1.1.1.1.2.3.2.3" xref="S4.E12.m1.1.1.1.1.2.3.2.3.cmml"><mi id="S4.E12.m1.1.1.1.1.2.3.2.3.2" xref="S4.E12.m1.1.1.1.1.2.3.2.3.2.cmml">j</mi><mo id="S4.E12.m1.1.1.1.1.2.3.2.3.1" xref="S4.E12.m1.1.1.1.1.2.3.2.3.1.cmml">=</mo><mi id="S4.E12.m1.1.1.1.1.2.3.2.3.3" xref="S4.E12.m1.1.1.1.1.2.3.2.3.3.cmml">l</mi></mrow><mi id="S4.E12.m1.1.1.1.1.2.3.3" xref="S4.E12.m1.1.1.1.1.2.3.3.cmml">L</mi></munderover><mrow id="S4.E12.m1.1.1.1.1.2.2" xref="S4.E12.m1.1.1.1.1.2.2.cmml"><mrow id="S4.E12.m1.1.1.1.1.1.1.1" xref="S4.E12.m1.1.1.1.1.1.1.1.cmml"><mrow id="S4.E12.m1.1.1.1.1.1.1.1.1" xref="S4.E12.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E12.m1.1.1.1.1.1.1.1.1.3" xref="S4.E12.m1.1.1.1.1.1.1.1.1.3.cmml">κ</mi><mo id="S4.E12.m1.1.1.1.1.1.1.1.1.2" xref="S4.E12.m1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E12.m1.1.1.1.1.1.1.1.1.1.1" xref="S4.E12.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.E12.m1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.E12.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="S4.E12.m1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E12.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E12.m1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S4.E12.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">W</mi><mi id="S4.E12.m1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S4.E12.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">k</mi><mi id="S4.E12.m1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E12.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">j</mi></msubsup><mo id="S4.E12.m1.1.1.1.1.1.1.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="S4.E12.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E12.m1.1.1.1.1.1.1.1.2" rspace="0.222em" xref="S4.E12.m1.1.1.1.1.1.1.1.2.cmml">⋅</mo><mi id="S4.E12.m1.1.1.1.1.1.1.1.3" xref="S4.E12.m1.1.1.1.1.1.1.1.3.cmml">κ</mi></mrow><mo id="S4.E12.m1.1.1.1.1.2.2.3" xref="S4.E12.m1.1.1.1.1.2.2.3.cmml">⁢</mo><mrow id="S4.E12.m1.1.1.1.1.2.2.2.1" xref="S4.E12.m1.1.1.1.1.2.2.2.1.1.cmml"><mo id="S4.E12.m1.1.1.1.1.2.2.2.1.2" stretchy="false" xref="S4.E12.m1.1.1.1.1.2.2.2.1.1.cmml">(</mo><msubsup id="S4.E12.m1.1.1.1.1.2.2.2.1.1" xref="S4.E12.m1.1.1.1.1.2.2.2.1.1.cmml"><mi id="S4.E12.m1.1.1.1.1.2.2.2.1.1.2.2" xref="S4.E12.m1.1.1.1.1.2.2.2.1.1.2.2.cmml">W</mi><mi id="S4.E12.m1.1.1.1.1.2.2.2.1.1.2.3" xref="S4.E12.m1.1.1.1.1.2.2.2.1.1.2.3.cmml">v</mi><mi id="S4.E12.m1.1.1.1.1.2.2.2.1.1.3" xref="S4.E12.m1.1.1.1.1.2.2.2.1.1.3.cmml">j</mi></msubsup><mo id="S4.E12.m1.1.1.1.1.2.2.2.1.3" stretchy="false" xref="S4.E12.m1.1.1.1.1.2.2.2.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S4.E12.m1.1.1.1.2" xref="S4.E12.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E12.m1.1b"><apply id="S4.E12.m1.1.1.1.1.cmml" xref="S4.E12.m1.1.1.1"><eq id="S4.E12.m1.1.1.1.1.3.cmml" xref="S4.E12.m1.1.1.1.1.3"></eq><apply id="S4.E12.m1.1.1.1.1.4.cmml" xref="S4.E12.m1.1.1.1.1.4"><csymbol cd="ambiguous" id="S4.E12.m1.1.1.1.1.4.1.cmml" xref="S4.E12.m1.1.1.1.1.4">subscript</csymbol><apply id="S4.E12.m1.1.1.1.1.4.2.cmml" xref="S4.E12.m1.1.1.1.1.4.2"><ci id="S4.E12.m1.1.1.1.1.4.2.1.cmml" xref="S4.E12.m1.1.1.1.1.4.2.1">~</ci><ci id="S4.E12.m1.1.1.1.1.4.2.2.cmml" xref="S4.E12.m1.1.1.1.1.4.2.2">𝜅</ci></apply><ci id="S4.E12.m1.1.1.1.1.4.3.cmml" xref="S4.E12.m1.1.1.1.1.4.3">𝑙</ci></apply><apply id="S4.E12.m1.1.1.1.1.2.cmml" xref="S4.E12.m1.1.1.1.1.2"><apply id="S4.E12.m1.1.1.1.1.2.3.cmml" xref="S4.E12.m1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S4.E12.m1.1.1.1.1.2.3.1.cmml" xref="S4.E12.m1.1.1.1.1.2.3">superscript</csymbol><apply id="S4.E12.m1.1.1.1.1.2.3.2.cmml" xref="S4.E12.m1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S4.E12.m1.1.1.1.1.2.3.2.1.cmml" xref="S4.E12.m1.1.1.1.1.2.3">subscript</csymbol><csymbol cd="latexml" id="S4.E12.m1.1.1.1.1.2.3.2.2.cmml" xref="S4.E12.m1.1.1.1.1.2.3.2.2">product</csymbol><apply id="S4.E12.m1.1.1.1.1.2.3.2.3.cmml" xref="S4.E12.m1.1.1.1.1.2.3.2.3"><eq id="S4.E12.m1.1.1.1.1.2.3.2.3.1.cmml" xref="S4.E12.m1.1.1.1.1.2.3.2.3.1"></eq><ci id="S4.E12.m1.1.1.1.1.2.3.2.3.2.cmml" xref="S4.E12.m1.1.1.1.1.2.3.2.3.2">𝑗</ci><ci id="S4.E12.m1.1.1.1.1.2.3.2.3.3.cmml" xref="S4.E12.m1.1.1.1.1.2.3.2.3.3">𝑙</ci></apply></apply><ci id="S4.E12.m1.1.1.1.1.2.3.3.cmml" xref="S4.E12.m1.1.1.1.1.2.3.3">𝐿</ci></apply><apply id="S4.E12.m1.1.1.1.1.2.2.cmml" xref="S4.E12.m1.1.1.1.1.2.2"><times id="S4.E12.m1.1.1.1.1.2.2.3.cmml" xref="S4.E12.m1.1.1.1.1.2.2.3"></times><apply id="S4.E12.m1.1.1.1.1.1.1.1.cmml" xref="S4.E12.m1.1.1.1.1.1.1.1"><ci id="S4.E12.m1.1.1.1.1.1.1.1.2.cmml" xref="S4.E12.m1.1.1.1.1.1.1.1.2">⋅</ci><apply id="S4.E12.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.E12.m1.1.1.1.1.1.1.1.1"><times id="S4.E12.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E12.m1.1.1.1.1.1.1.1.1.2"></times><ci id="S4.E12.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E12.m1.1.1.1.1.1.1.1.1.3">𝜅</ci><apply id="S4.E12.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E12.m1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E12.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E12.m1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S4.E12.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E12.m1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E12.m1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E12.m1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E12.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E12.m1.1.1.1.1.1.1.1.1.1.1.1.2.2">𝑊</ci><ci id="S4.E12.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E12.m1.1.1.1.1.1.1.1.1.1.1.1.2.3">𝑘</ci></apply><ci id="S4.E12.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E12.m1.1.1.1.1.1.1.1.1.1.1.1.3">𝑗</ci></apply></apply><ci id="S4.E12.m1.1.1.1.1.1.1.1.3.cmml" xref="S4.E12.m1.1.1.1.1.1.1.1.3">𝜅</ci></apply><apply id="S4.E12.m1.1.1.1.1.2.2.2.1.1.cmml" xref="S4.E12.m1.1.1.1.1.2.2.2.1"><csymbol cd="ambiguous" id="S4.E12.m1.1.1.1.1.2.2.2.1.1.1.cmml" xref="S4.E12.m1.1.1.1.1.2.2.2.1">superscript</csymbol><apply id="S4.E12.m1.1.1.1.1.2.2.2.1.1.2.cmml" xref="S4.E12.m1.1.1.1.1.2.2.2.1"><csymbol cd="ambiguous" id="S4.E12.m1.1.1.1.1.2.2.2.1.1.2.1.cmml" xref="S4.E12.m1.1.1.1.1.2.2.2.1">subscript</csymbol><ci id="S4.E12.m1.1.1.1.1.2.2.2.1.1.2.2.cmml" xref="S4.E12.m1.1.1.1.1.2.2.2.1.1.2.2">𝑊</ci><ci id="S4.E12.m1.1.1.1.1.2.2.2.1.1.2.3.cmml" xref="S4.E12.m1.1.1.1.1.2.2.2.1.1.2.3">𝑣</ci></apply><ci id="S4.E12.m1.1.1.1.1.2.2.2.1.1.3.cmml" xref="S4.E12.m1.1.1.1.1.2.2.2.1.1.3">𝑗</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E12.m1.1c">\tilde{\kappa}_{l}=\prod_{j=l}^{L}\kappa(W_{k}^{j})\cdot\kappa(W_{v}^{j}),</annotation><annotation encoding="application/x-llamapun" id="S4.E12.m1.1d">over~ start_ARG italic_κ end_ARG start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT = ∏ start_POSTSUBSCRIPT italic_j = italic_l end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_L end_POSTSUPERSCRIPT italic_κ ( italic_W start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT ) ⋅ italic_κ ( italic_W start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(12)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS2.SSS0.Px1.p2.8">where <math alttext="W_{k}^{j}" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px1.p2.3.m1.1"><semantics id="S4.SS2.SSS0.Px1.p2.3.m1.1a"><msubsup id="S4.SS2.SSS0.Px1.p2.3.m1.1.1" xref="S4.SS2.SSS0.Px1.p2.3.m1.1.1.cmml"><mi id="S4.SS2.SSS0.Px1.p2.3.m1.1.1.2.2" xref="S4.SS2.SSS0.Px1.p2.3.m1.1.1.2.2.cmml">W</mi><mi id="S4.SS2.SSS0.Px1.p2.3.m1.1.1.2.3" xref="S4.SS2.SSS0.Px1.p2.3.m1.1.1.2.3.cmml">k</mi><mi id="S4.SS2.SSS0.Px1.p2.3.m1.1.1.3" xref="S4.SS2.SSS0.Px1.p2.3.m1.1.1.3.cmml">j</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p2.3.m1.1b"><apply id="S4.SS2.SSS0.Px1.p2.3.m1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p2.3.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px1.p2.3.m1.1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p2.3.m1.1.1">superscript</csymbol><apply id="S4.SS2.SSS0.Px1.p2.3.m1.1.1.2.cmml" xref="S4.SS2.SSS0.Px1.p2.3.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px1.p2.3.m1.1.1.2.1.cmml" xref="S4.SS2.SSS0.Px1.p2.3.m1.1.1">subscript</csymbol><ci id="S4.SS2.SSS0.Px1.p2.3.m1.1.1.2.2.cmml" xref="S4.SS2.SSS0.Px1.p2.3.m1.1.1.2.2">𝑊</ci><ci id="S4.SS2.SSS0.Px1.p2.3.m1.1.1.2.3.cmml" xref="S4.SS2.SSS0.Px1.p2.3.m1.1.1.2.3">𝑘</ci></apply><ci id="S4.SS2.SSS0.Px1.p2.3.m1.1.1.3.cmml" xref="S4.SS2.SSS0.Px1.p2.3.m1.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p2.3.m1.1c">W_{k}^{j}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px1.p2.3.m1.1d">italic_W start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="W_{v}^{j}" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px1.p2.4.m2.1"><semantics id="S4.SS2.SSS0.Px1.p2.4.m2.1a"><msubsup id="S4.SS2.SSS0.Px1.p2.4.m2.1.1" xref="S4.SS2.SSS0.Px1.p2.4.m2.1.1.cmml"><mi id="S4.SS2.SSS0.Px1.p2.4.m2.1.1.2.2" xref="S4.SS2.SSS0.Px1.p2.4.m2.1.1.2.2.cmml">W</mi><mi id="S4.SS2.SSS0.Px1.p2.4.m2.1.1.2.3" xref="S4.SS2.SSS0.Px1.p2.4.m2.1.1.2.3.cmml">v</mi><mi id="S4.SS2.SSS0.Px1.p2.4.m2.1.1.3" xref="S4.SS2.SSS0.Px1.p2.4.m2.1.1.3.cmml">j</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p2.4.m2.1b"><apply id="S4.SS2.SSS0.Px1.p2.4.m2.1.1.cmml" xref="S4.SS2.SSS0.Px1.p2.4.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px1.p2.4.m2.1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p2.4.m2.1.1">superscript</csymbol><apply id="S4.SS2.SSS0.Px1.p2.4.m2.1.1.2.cmml" xref="S4.SS2.SSS0.Px1.p2.4.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px1.p2.4.m2.1.1.2.1.cmml" xref="S4.SS2.SSS0.Px1.p2.4.m2.1.1">subscript</csymbol><ci id="S4.SS2.SSS0.Px1.p2.4.m2.1.1.2.2.cmml" xref="S4.SS2.SSS0.Px1.p2.4.m2.1.1.2.2">𝑊</ci><ci id="S4.SS2.SSS0.Px1.p2.4.m2.1.1.2.3.cmml" xref="S4.SS2.SSS0.Px1.p2.4.m2.1.1.2.3">𝑣</ci></apply><ci id="S4.SS2.SSS0.Px1.p2.4.m2.1.1.3.cmml" xref="S4.SS2.SSS0.Px1.p2.4.m2.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p2.4.m2.1c">W_{v}^{j}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px1.p2.4.m2.1d">italic_W start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT</annotation></semantics></math> denote the key and value weight matrices of the <math alttext="j" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px1.p2.5.m3.1"><semantics id="S4.SS2.SSS0.Px1.p2.5.m3.1a"><mi id="S4.SS2.SSS0.Px1.p2.5.m3.1.1" xref="S4.SS2.SSS0.Px1.p2.5.m3.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p2.5.m3.1b"><ci id="S4.SS2.SSS0.Px1.p2.5.m3.1.1.cmml" xref="S4.SS2.SSS0.Px1.p2.5.m3.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p2.5.m3.1c">j</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px1.p2.5.m3.1d">italic_j</annotation></semantics></math>-th layer, respectively. This cumulative condition number <math alttext="\tilde{\kappa}_{l}" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px1.p2.6.m4.1"><semantics id="S4.SS2.SSS0.Px1.p2.6.m4.1a"><msub id="S4.SS2.SSS0.Px1.p2.6.m4.1.1" xref="S4.SS2.SSS0.Px1.p2.6.m4.1.1.cmml"><mover accent="true" id="S4.SS2.SSS0.Px1.p2.6.m4.1.1.2" xref="S4.SS2.SSS0.Px1.p2.6.m4.1.1.2.cmml"><mi id="S4.SS2.SSS0.Px1.p2.6.m4.1.1.2.2" xref="S4.SS2.SSS0.Px1.p2.6.m4.1.1.2.2.cmml">κ</mi><mo id="S4.SS2.SSS0.Px1.p2.6.m4.1.1.2.1" xref="S4.SS2.SSS0.Px1.p2.6.m4.1.1.2.1.cmml">~</mo></mover><mi id="S4.SS2.SSS0.Px1.p2.6.m4.1.1.3" xref="S4.SS2.SSS0.Px1.p2.6.m4.1.1.3.cmml">l</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p2.6.m4.1b"><apply id="S4.SS2.SSS0.Px1.p2.6.m4.1.1.cmml" xref="S4.SS2.SSS0.Px1.p2.6.m4.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px1.p2.6.m4.1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p2.6.m4.1.1">subscript</csymbol><apply id="S4.SS2.SSS0.Px1.p2.6.m4.1.1.2.cmml" xref="S4.SS2.SSS0.Px1.p2.6.m4.1.1.2"><ci id="S4.SS2.SSS0.Px1.p2.6.m4.1.1.2.1.cmml" xref="S4.SS2.SSS0.Px1.p2.6.m4.1.1.2.1">~</ci><ci id="S4.SS2.SSS0.Px1.p2.6.m4.1.1.2.2.cmml" xref="S4.SS2.SSS0.Px1.p2.6.m4.1.1.2.2">𝜅</ci></apply><ci id="S4.SS2.SSS0.Px1.p2.6.m4.1.1.3.cmml" xref="S4.SS2.SSS0.Px1.p2.6.m4.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p2.6.m4.1c">\tilde{\kappa}_{l}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px1.p2.6.m4.1d">over~ start_ARG italic_κ end_ARG start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT</annotation></semantics></math> reflects the total amplification of input perturbations from current layer to the final output layer, encompassing the effects of layers from <math alttext="l" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px1.p2.7.m5.1"><semantics id="S4.SS2.SSS0.Px1.p2.7.m5.1a"><mi id="S4.SS2.SSS0.Px1.p2.7.m5.1.1" xref="S4.SS2.SSS0.Px1.p2.7.m5.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p2.7.m5.1b"><ci id="S4.SS2.SSS0.Px1.p2.7.m5.1.1.cmml" xref="S4.SS2.SSS0.Px1.p2.7.m5.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p2.7.m5.1c">l</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px1.p2.7.m5.1d">italic_l</annotation></semantics></math> to <math alttext="L" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px1.p2.8.m6.1"><semantics id="S4.SS2.SSS0.Px1.p2.8.m6.1a"><mi id="S4.SS2.SSS0.Px1.p2.8.m6.1.1" xref="S4.SS2.SSS0.Px1.p2.8.m6.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p2.8.m6.1b"><ci id="S4.SS2.SSS0.Px1.p2.8.m6.1.1.cmml" xref="S4.SS2.SSS0.Px1.p2.8.m6.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p2.8.m6.1c">L</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px1.p2.8.m6.1d">italic_L</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S4.SS2.SSS0.Px1.p3">
<p class="ltx_p" id="S4.SS2.SSS0.Px1.p3.2"><span class="ltx_text ltx_font_bold" id="S4.SS2.SSS0.Px1.p3.2.1">Compression Dimension</span>:
Based on the cumulative condition number, we then adjust the compression dimensions for each layer to balance the fidelity and compression rate. More sensitive layers (those with higher cumulative condition numbers) will have less aggressive compression to preserve information, whereas layers with lower sensitivity can be compressed more substantially without significantly affecting the overall network performance.
We compute the compressed dimension <math alttext="d_{c}^{l}" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px1.p3.1.m1.1"><semantics id="S4.SS2.SSS0.Px1.p3.1.m1.1a"><msubsup id="S4.SS2.SSS0.Px1.p3.1.m1.1.1" xref="S4.SS2.SSS0.Px1.p3.1.m1.1.1.cmml"><mi id="S4.SS2.SSS0.Px1.p3.1.m1.1.1.2.2" xref="S4.SS2.SSS0.Px1.p3.1.m1.1.1.2.2.cmml">d</mi><mi id="S4.SS2.SSS0.Px1.p3.1.m1.1.1.2.3" xref="S4.SS2.SSS0.Px1.p3.1.m1.1.1.2.3.cmml">c</mi><mi id="S4.SS2.SSS0.Px1.p3.1.m1.1.1.3" xref="S4.SS2.SSS0.Px1.p3.1.m1.1.1.3.cmml">l</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p3.1.m1.1b"><apply id="S4.SS2.SSS0.Px1.p3.1.m1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px1.p3.1.m1.1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p3.1.m1.1.1">superscript</csymbol><apply id="S4.SS2.SSS0.Px1.p3.1.m1.1.1.2.cmml" xref="S4.SS2.SSS0.Px1.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px1.p3.1.m1.1.1.2.1.cmml" xref="S4.SS2.SSS0.Px1.p3.1.m1.1.1">subscript</csymbol><ci id="S4.SS2.SSS0.Px1.p3.1.m1.1.1.2.2.cmml" xref="S4.SS2.SSS0.Px1.p3.1.m1.1.1.2.2">𝑑</ci><ci id="S4.SS2.SSS0.Px1.p3.1.m1.1.1.2.3.cmml" xref="S4.SS2.SSS0.Px1.p3.1.m1.1.1.2.3">𝑐</ci></apply><ci id="S4.SS2.SSS0.Px1.p3.1.m1.1.1.3.cmml" xref="S4.SS2.SSS0.Px1.p3.1.m1.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p3.1.m1.1c">d_{c}^{l}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px1.p3.1.m1.1d">italic_d start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT</annotation></semantics></math> for each layer by scaling <math alttext="\tilde{\kappa}_{l}" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px1.p3.2.m2.1"><semantics id="S4.SS2.SSS0.Px1.p3.2.m2.1a"><msub id="S4.SS2.SSS0.Px1.p3.2.m2.1.1" xref="S4.SS2.SSS0.Px1.p3.2.m2.1.1.cmml"><mover accent="true" id="S4.SS2.SSS0.Px1.p3.2.m2.1.1.2" xref="S4.SS2.SSS0.Px1.p3.2.m2.1.1.2.cmml"><mi id="S4.SS2.SSS0.Px1.p3.2.m2.1.1.2.2" xref="S4.SS2.SSS0.Px1.p3.2.m2.1.1.2.2.cmml">κ</mi><mo id="S4.SS2.SSS0.Px1.p3.2.m2.1.1.2.1" xref="S4.SS2.SSS0.Px1.p3.2.m2.1.1.2.1.cmml">~</mo></mover><mi id="S4.SS2.SSS0.Px1.p3.2.m2.1.1.3" xref="S4.SS2.SSS0.Px1.p3.2.m2.1.1.3.cmml">l</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p3.2.m2.1b"><apply id="S4.SS2.SSS0.Px1.p3.2.m2.1.1.cmml" xref="S4.SS2.SSS0.Px1.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px1.p3.2.m2.1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p3.2.m2.1.1">subscript</csymbol><apply id="S4.SS2.SSS0.Px1.p3.2.m2.1.1.2.cmml" xref="S4.SS2.SSS0.Px1.p3.2.m2.1.1.2"><ci id="S4.SS2.SSS0.Px1.p3.2.m2.1.1.2.1.cmml" xref="S4.SS2.SSS0.Px1.p3.2.m2.1.1.2.1">~</ci><ci id="S4.SS2.SSS0.Px1.p3.2.m2.1.1.2.2.cmml" xref="S4.SS2.SSS0.Px1.p3.2.m2.1.1.2.2">𝜅</ci></apply><ci id="S4.SS2.SSS0.Px1.p3.2.m2.1.1.3.cmml" xref="S4.SS2.SSS0.Px1.p3.2.m2.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p3.2.m2.1c">\tilde{\kappa}_{l}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px1.p3.2.m2.1d">over~ start_ARG italic_κ end_ARG start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT</annotation></semantics></math> using the following function:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E13">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="d_{c}^{l}=d_{\max}\times\left[1-\left(\frac{\max_{i\in[1:L]}\log(\tilde{\kappa%
}_{i})-\log(\tilde{\kappa}_{l})}{\max_{i\in[1:L]}\log(\tilde{\kappa}_{i})-\min%
_{i\in[1:L]}\log(\tilde{\kappa}_{i})}\right)\times\left(1-\frac{d_{\min}}{d_{%
\max}}\right)\right]," class="ltx_Math" display="block" id="S4.E13.m1.18"><semantics id="S4.E13.m1.18a"><mrow id="S4.E13.m1.18.18.1" xref="S4.E13.m1.18.18.1.1.cmml"><mrow id="S4.E13.m1.18.18.1.1" xref="S4.E13.m1.18.18.1.1.cmml"><msubsup id="S4.E13.m1.18.18.1.1.3" xref="S4.E13.m1.18.18.1.1.3.cmml"><mi id="S4.E13.m1.18.18.1.1.3.2.2" xref="S4.E13.m1.18.18.1.1.3.2.2.cmml">d</mi><mi id="S4.E13.m1.18.18.1.1.3.2.3" xref="S4.E13.m1.18.18.1.1.3.2.3.cmml">c</mi><mi id="S4.E13.m1.18.18.1.1.3.3" xref="S4.E13.m1.18.18.1.1.3.3.cmml">l</mi></msubsup><mo id="S4.E13.m1.18.18.1.1.2" xref="S4.E13.m1.18.18.1.1.2.cmml">=</mo><mrow id="S4.E13.m1.18.18.1.1.1" xref="S4.E13.m1.18.18.1.1.1.cmml"><msub id="S4.E13.m1.18.18.1.1.1.3" xref="S4.E13.m1.18.18.1.1.1.3.cmml"><mi id="S4.E13.m1.18.18.1.1.1.3.2" xref="S4.E13.m1.18.18.1.1.1.3.2.cmml">d</mi><mi id="S4.E13.m1.18.18.1.1.1.3.3" xref="S4.E13.m1.18.18.1.1.1.3.3.cmml">max</mi></msub><mo id="S4.E13.m1.18.18.1.1.1.2" lspace="0.222em" rspace="0.222em" xref="S4.E13.m1.18.18.1.1.1.2.cmml">×</mo><mrow id="S4.E13.m1.18.18.1.1.1.1.1" xref="S4.E13.m1.18.18.1.1.1.1.2.cmml"><mo id="S4.E13.m1.18.18.1.1.1.1.1.2" xref="S4.E13.m1.18.18.1.1.1.1.2.1.cmml">[</mo><mrow id="S4.E13.m1.18.18.1.1.1.1.1.1" xref="S4.E13.m1.18.18.1.1.1.1.1.1.cmml"><mn id="S4.E13.m1.18.18.1.1.1.1.1.1.3" xref="S4.E13.m1.18.18.1.1.1.1.1.1.3.cmml">1</mn><mo id="S4.E13.m1.18.18.1.1.1.1.1.1.2" xref="S4.E13.m1.18.18.1.1.1.1.1.1.2.cmml">−</mo><mrow id="S4.E13.m1.18.18.1.1.1.1.1.1.1" xref="S4.E13.m1.18.18.1.1.1.1.1.1.1.cmml"><mrow id="S4.E13.m1.18.18.1.1.1.1.1.1.1.3.2" xref="S4.E13.m1.17.17.cmml"><mo id="S4.E13.m1.18.18.1.1.1.1.1.1.1.3.2.1" xref="S4.E13.m1.17.17.cmml">(</mo><mfrac id="S4.E13.m1.17.17" xref="S4.E13.m1.17.17.cmml"><mrow id="S4.E13.m1.7.7.7" xref="S4.E13.m1.7.7.7.cmml"><mrow id="S4.E13.m1.6.6.6.6" xref="S4.E13.m1.6.6.6.6.cmml"><msub id="S4.E13.m1.6.6.6.6.2" xref="S4.E13.m1.6.6.6.6.2.cmml"><mi id="S4.E13.m1.6.6.6.6.2.2" xref="S4.E13.m1.6.6.6.6.2.2.cmml">max</mi><mrow id="S4.E13.m1.3.3.3.3.3.3" xref="S4.E13.m1.3.3.3.3.3.4.cmml"><mi id="S4.E13.m1.1.1.1.1.1.1" xref="S4.E13.m1.1.1.1.1.1.1.cmml">i</mi><mo id="S4.E13.m1.3.3.3.3.3.3.2" xref="S4.E13.m1.3.3.3.3.3.4.cmml">⁣</mo><mo id="S4.E13.m1.2.2.2.2.2.2" xref="S4.E13.m1.2.2.2.2.2.2.cmml">∈</mo><mo id="S4.E13.m1.3.3.3.3.3.3.3" xref="S4.E13.m1.3.3.3.3.3.4.cmml">⁣</mo><mrow id="S4.E13.m1.3.3.3.3.3.3.1.1" xref="S4.E13.m1.3.3.3.3.3.3.1.2.cmml"><mo id="S4.E13.m1.3.3.3.3.3.3.1.1.2" stretchy="false" xref="S4.E13.m1.3.3.3.3.3.3.1.2.1.cmml">[</mo><mrow id="S4.E13.m1.3.3.3.3.3.3.1.1.1" xref="S4.E13.m1.3.3.3.3.3.3.1.1.1.cmml"><mn id="S4.E13.m1.3.3.3.3.3.3.1.1.1.2" xref="S4.E13.m1.3.3.3.3.3.3.1.1.1.2.cmml">1</mn><mo id="S4.E13.m1.3.3.3.3.3.3.1.1.1.1" lspace="0.278em" rspace="0.278em" xref="S4.E13.m1.3.3.3.3.3.3.1.1.1.1.cmml">:</mo><mi id="S4.E13.m1.3.3.3.3.3.3.1.1.1.3" xref="S4.E13.m1.3.3.3.3.3.3.1.1.1.3.cmml">L</mi></mrow><mo id="S4.E13.m1.3.3.3.3.3.3.1.1.3" stretchy="false" xref="S4.E13.m1.3.3.3.3.3.3.1.2.1.cmml">]</mo></mrow></mrow></msub><mo id="S4.E13.m1.6.6.6.6a" lspace="0.167em" xref="S4.E13.m1.6.6.6.6.cmml">⁡</mo><mrow id="S4.E13.m1.6.6.6.6.1.1" xref="S4.E13.m1.6.6.6.6.1.2.cmml"><mi id="S4.E13.m1.4.4.4.4" xref="S4.E13.m1.4.4.4.4.cmml">log</mi><mo id="S4.E13.m1.6.6.6.6.1.1a" xref="S4.E13.m1.6.6.6.6.1.2.cmml">⁡</mo><mrow id="S4.E13.m1.6.6.6.6.1.1.1" xref="S4.E13.m1.6.6.6.6.1.2.cmml"><mo id="S4.E13.m1.6.6.6.6.1.1.1.2" stretchy="false" xref="S4.E13.m1.6.6.6.6.1.2.cmml">(</mo><msub id="S4.E13.m1.6.6.6.6.1.1.1.1" xref="S4.E13.m1.6.6.6.6.1.1.1.1.cmml"><mover accent="true" id="S4.E13.m1.6.6.6.6.1.1.1.1.2" xref="S4.E13.m1.6.6.6.6.1.1.1.1.2.cmml"><mi id="S4.E13.m1.6.6.6.6.1.1.1.1.2.2" xref="S4.E13.m1.6.6.6.6.1.1.1.1.2.2.cmml">κ</mi><mo id="S4.E13.m1.6.6.6.6.1.1.1.1.2.1" xref="S4.E13.m1.6.6.6.6.1.1.1.1.2.1.cmml">~</mo></mover><mi id="S4.E13.m1.6.6.6.6.1.1.1.1.3" xref="S4.E13.m1.6.6.6.6.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.E13.m1.6.6.6.6.1.1.1.3" stretchy="false" xref="S4.E13.m1.6.6.6.6.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E13.m1.7.7.7.8" xref="S4.E13.m1.7.7.7.8.cmml">−</mo><mrow id="S4.E13.m1.7.7.7.7.1" xref="S4.E13.m1.7.7.7.7.2.cmml"><mi id="S4.E13.m1.5.5.5.5" xref="S4.E13.m1.5.5.5.5.cmml">log</mi><mo id="S4.E13.m1.7.7.7.7.1a" xref="S4.E13.m1.7.7.7.7.2.cmml">⁡</mo><mrow id="S4.E13.m1.7.7.7.7.1.1" xref="S4.E13.m1.7.7.7.7.2.cmml"><mo id="S4.E13.m1.7.7.7.7.1.1.2" stretchy="false" xref="S4.E13.m1.7.7.7.7.2.cmml">(</mo><msub id="S4.E13.m1.7.7.7.7.1.1.1" xref="S4.E13.m1.7.7.7.7.1.1.1.cmml"><mover accent="true" id="S4.E13.m1.7.7.7.7.1.1.1.2" xref="S4.E13.m1.7.7.7.7.1.1.1.2.cmml"><mi id="S4.E13.m1.7.7.7.7.1.1.1.2.2" xref="S4.E13.m1.7.7.7.7.1.1.1.2.2.cmml">κ</mi><mo id="S4.E13.m1.7.7.7.7.1.1.1.2.1" xref="S4.E13.m1.7.7.7.7.1.1.1.2.1.cmml">~</mo></mover><mi id="S4.E13.m1.7.7.7.7.1.1.1.3" xref="S4.E13.m1.7.7.7.7.1.1.1.3.cmml">l</mi></msub><mo id="S4.E13.m1.7.7.7.7.1.1.3" stretchy="false" xref="S4.E13.m1.7.7.7.7.2.cmml">)</mo></mrow></mrow></mrow><mrow id="S4.E13.m1.17.17.17" xref="S4.E13.m1.17.17.17.cmml"><mrow id="S4.E13.m1.16.16.16.9" xref="S4.E13.m1.16.16.16.9.cmml"><msub id="S4.E13.m1.16.16.16.9.2" xref="S4.E13.m1.16.16.16.9.2.cmml"><mi id="S4.E13.m1.16.16.16.9.2.2" xref="S4.E13.m1.16.16.16.9.2.2.cmml">max</mi><mrow id="S4.E13.m1.10.10.10.3.3.3" xref="S4.E13.m1.10.10.10.3.3.4.cmml"><mi id="S4.E13.m1.8.8.8.1.1.1" xref="S4.E13.m1.8.8.8.1.1.1.cmml">i</mi><mo id="S4.E13.m1.10.10.10.3.3.3.2" xref="S4.E13.m1.10.10.10.3.3.4.cmml">⁣</mo><mo id="S4.E13.m1.9.9.9.2.2.2" xref="S4.E13.m1.9.9.9.2.2.2.cmml">∈</mo><mo id="S4.E13.m1.10.10.10.3.3.3.3" xref="S4.E13.m1.10.10.10.3.3.4.cmml">⁣</mo><mrow id="S4.E13.m1.10.10.10.3.3.3.1.1" xref="S4.E13.m1.10.10.10.3.3.3.1.2.cmml"><mo id="S4.E13.m1.10.10.10.3.3.3.1.1.2" stretchy="false" xref="S4.E13.m1.10.10.10.3.3.3.1.2.1.cmml">[</mo><mrow id="S4.E13.m1.10.10.10.3.3.3.1.1.1" xref="S4.E13.m1.10.10.10.3.3.3.1.1.1.cmml"><mn id="S4.E13.m1.10.10.10.3.3.3.1.1.1.2" xref="S4.E13.m1.10.10.10.3.3.3.1.1.1.2.cmml">1</mn><mo id="S4.E13.m1.10.10.10.3.3.3.1.1.1.1" lspace="0.278em" rspace="0.278em" xref="S4.E13.m1.10.10.10.3.3.3.1.1.1.1.cmml">:</mo><mi id="S4.E13.m1.10.10.10.3.3.3.1.1.1.3" xref="S4.E13.m1.10.10.10.3.3.3.1.1.1.3.cmml">L</mi></mrow><mo id="S4.E13.m1.10.10.10.3.3.3.1.1.3" stretchy="false" xref="S4.E13.m1.10.10.10.3.3.3.1.2.1.cmml">]</mo></mrow></mrow></msub><mo id="S4.E13.m1.16.16.16.9a" lspace="0.167em" xref="S4.E13.m1.16.16.16.9.cmml">⁡</mo><mrow id="S4.E13.m1.16.16.16.9.1.1" xref="S4.E13.m1.16.16.16.9.1.2.cmml"><mi id="S4.E13.m1.14.14.14.7" xref="S4.E13.m1.14.14.14.7.cmml">log</mi><mo id="S4.E13.m1.16.16.16.9.1.1a" xref="S4.E13.m1.16.16.16.9.1.2.cmml">⁡</mo><mrow id="S4.E13.m1.16.16.16.9.1.1.1" xref="S4.E13.m1.16.16.16.9.1.2.cmml"><mo id="S4.E13.m1.16.16.16.9.1.1.1.2" stretchy="false" xref="S4.E13.m1.16.16.16.9.1.2.cmml">(</mo><msub id="S4.E13.m1.16.16.16.9.1.1.1.1" xref="S4.E13.m1.16.16.16.9.1.1.1.1.cmml"><mover accent="true" id="S4.E13.m1.16.16.16.9.1.1.1.1.2" xref="S4.E13.m1.16.16.16.9.1.1.1.1.2.cmml"><mi id="S4.E13.m1.16.16.16.9.1.1.1.1.2.2" xref="S4.E13.m1.16.16.16.9.1.1.1.1.2.2.cmml">κ</mi><mo id="S4.E13.m1.16.16.16.9.1.1.1.1.2.1" xref="S4.E13.m1.16.16.16.9.1.1.1.1.2.1.cmml">~</mo></mover><mi id="S4.E13.m1.16.16.16.9.1.1.1.1.3" xref="S4.E13.m1.16.16.16.9.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.E13.m1.16.16.16.9.1.1.1.3" stretchy="false" xref="S4.E13.m1.16.16.16.9.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E13.m1.17.17.17.11" xref="S4.E13.m1.17.17.17.11.cmml">−</mo><mrow id="S4.E13.m1.17.17.17.10" xref="S4.E13.m1.17.17.17.10.cmml"><msub id="S4.E13.m1.17.17.17.10.2" xref="S4.E13.m1.17.17.17.10.2.cmml"><mi id="S4.E13.m1.17.17.17.10.2.2" xref="S4.E13.m1.17.17.17.10.2.2.cmml">min</mi><mrow id="S4.E13.m1.13.13.13.6.3.3" xref="S4.E13.m1.13.13.13.6.3.4.cmml"><mi id="S4.E13.m1.11.11.11.4.1.1" xref="S4.E13.m1.11.11.11.4.1.1.cmml">i</mi><mo id="S4.E13.m1.13.13.13.6.3.3.2" xref="S4.E13.m1.13.13.13.6.3.4.cmml">⁣</mo><mo id="S4.E13.m1.12.12.12.5.2.2" xref="S4.E13.m1.12.12.12.5.2.2.cmml">∈</mo><mo id="S4.E13.m1.13.13.13.6.3.3.3" xref="S4.E13.m1.13.13.13.6.3.4.cmml">⁣</mo><mrow id="S4.E13.m1.13.13.13.6.3.3.1.1" xref="S4.E13.m1.13.13.13.6.3.3.1.2.cmml"><mo id="S4.E13.m1.13.13.13.6.3.3.1.1.2" stretchy="false" xref="S4.E13.m1.13.13.13.6.3.3.1.2.1.cmml">[</mo><mrow id="S4.E13.m1.13.13.13.6.3.3.1.1.1" xref="S4.E13.m1.13.13.13.6.3.3.1.1.1.cmml"><mn id="S4.E13.m1.13.13.13.6.3.3.1.1.1.2" xref="S4.E13.m1.13.13.13.6.3.3.1.1.1.2.cmml">1</mn><mo id="S4.E13.m1.13.13.13.6.3.3.1.1.1.1" lspace="0.278em" rspace="0.278em" xref="S4.E13.m1.13.13.13.6.3.3.1.1.1.1.cmml">:</mo><mi id="S4.E13.m1.13.13.13.6.3.3.1.1.1.3" xref="S4.E13.m1.13.13.13.6.3.3.1.1.1.3.cmml">L</mi></mrow><mo id="S4.E13.m1.13.13.13.6.3.3.1.1.3" stretchy="false" xref="S4.E13.m1.13.13.13.6.3.3.1.2.1.cmml">]</mo></mrow></mrow></msub><mo id="S4.E13.m1.17.17.17.10a" lspace="0.167em" xref="S4.E13.m1.17.17.17.10.cmml">⁡</mo><mrow id="S4.E13.m1.17.17.17.10.1.1" xref="S4.E13.m1.17.17.17.10.1.2.cmml"><mi id="S4.E13.m1.15.15.15.8" xref="S4.E13.m1.15.15.15.8.cmml">log</mi><mo id="S4.E13.m1.17.17.17.10.1.1a" xref="S4.E13.m1.17.17.17.10.1.2.cmml">⁡</mo><mrow id="S4.E13.m1.17.17.17.10.1.1.1" xref="S4.E13.m1.17.17.17.10.1.2.cmml"><mo id="S4.E13.m1.17.17.17.10.1.1.1.2" stretchy="false" xref="S4.E13.m1.17.17.17.10.1.2.cmml">(</mo><msub id="S4.E13.m1.17.17.17.10.1.1.1.1" xref="S4.E13.m1.17.17.17.10.1.1.1.1.cmml"><mover accent="true" id="S4.E13.m1.17.17.17.10.1.1.1.1.2" xref="S4.E13.m1.17.17.17.10.1.1.1.1.2.cmml"><mi id="S4.E13.m1.17.17.17.10.1.1.1.1.2.2" xref="S4.E13.m1.17.17.17.10.1.1.1.1.2.2.cmml">κ</mi><mo id="S4.E13.m1.17.17.17.10.1.1.1.1.2.1" xref="S4.E13.m1.17.17.17.10.1.1.1.1.2.1.cmml">~</mo></mover><mi id="S4.E13.m1.17.17.17.10.1.1.1.1.3" xref="S4.E13.m1.17.17.17.10.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.E13.m1.17.17.17.10.1.1.1.3" stretchy="false" xref="S4.E13.m1.17.17.17.10.1.2.cmml">)</mo></mrow></mrow></mrow></mrow></mfrac><mo id="S4.E13.m1.18.18.1.1.1.1.1.1.1.3.2.2" rspace="0.055em" xref="S4.E13.m1.17.17.cmml">)</mo></mrow><mo id="S4.E13.m1.18.18.1.1.1.1.1.1.1.2" rspace="0.222em" xref="S4.E13.m1.18.18.1.1.1.1.1.1.1.2.cmml">×</mo><mrow id="S4.E13.m1.18.18.1.1.1.1.1.1.1.1.1" xref="S4.E13.m1.18.18.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.E13.m1.18.18.1.1.1.1.1.1.1.1.1.2" xref="S4.E13.m1.18.18.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E13.m1.18.18.1.1.1.1.1.1.1.1.1.1" xref="S4.E13.m1.18.18.1.1.1.1.1.1.1.1.1.1.cmml"><mn id="S4.E13.m1.18.18.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E13.m1.18.18.1.1.1.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="S4.E13.m1.18.18.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E13.m1.18.18.1.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><mfrac id="S4.E13.m1.18.18.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E13.m1.18.18.1.1.1.1.1.1.1.1.1.1.3.cmml"><msub id="S4.E13.m1.18.18.1.1.1.1.1.1.1.1.1.1.3.2" xref="S4.E13.m1.18.18.1.1.1.1.1.1.1.1.1.1.3.2.cmml"><mi id="S4.E13.m1.18.18.1.1.1.1.1.1.1.1.1.1.3.2.2" xref="S4.E13.m1.18.18.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml">d</mi><mi id="S4.E13.m1.18.18.1.1.1.1.1.1.1.1.1.1.3.2.3" xref="S4.E13.m1.18.18.1.1.1.1.1.1.1.1.1.1.3.2.3.cmml">min</mi></msub><msub id="S4.E13.m1.18.18.1.1.1.1.1.1.1.1.1.1.3.3" xref="S4.E13.m1.18.18.1.1.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="S4.E13.m1.18.18.1.1.1.1.1.1.1.1.1.1.3.3.2" xref="S4.E13.m1.18.18.1.1.1.1.1.1.1.1.1.1.3.3.2.cmml">d</mi><mi id="S4.E13.m1.18.18.1.1.1.1.1.1.1.1.1.1.3.3.3" xref="S4.E13.m1.18.18.1.1.1.1.1.1.1.1.1.1.3.3.3.cmml">max</mi></msub></mfrac></mrow><mo id="S4.E13.m1.18.18.1.1.1.1.1.1.1.1.1.3" xref="S4.E13.m1.18.18.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E13.m1.18.18.1.1.1.1.1.3" xref="S4.E13.m1.18.18.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><mo id="S4.E13.m1.18.18.1.2" xref="S4.E13.m1.18.18.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E13.m1.18b"><apply id="S4.E13.m1.18.18.1.1.cmml" xref="S4.E13.m1.18.18.1"><eq id="S4.E13.m1.18.18.1.1.2.cmml" xref="S4.E13.m1.18.18.1.1.2"></eq><apply id="S4.E13.m1.18.18.1.1.3.cmml" xref="S4.E13.m1.18.18.1.1.3"><csymbol cd="ambiguous" id="S4.E13.m1.18.18.1.1.3.1.cmml" xref="S4.E13.m1.18.18.1.1.3">superscript</csymbol><apply id="S4.E13.m1.18.18.1.1.3.2.cmml" xref="S4.E13.m1.18.18.1.1.3"><csymbol cd="ambiguous" id="S4.E13.m1.18.18.1.1.3.2.1.cmml" xref="S4.E13.m1.18.18.1.1.3">subscript</csymbol><ci id="S4.E13.m1.18.18.1.1.3.2.2.cmml" xref="S4.E13.m1.18.18.1.1.3.2.2">𝑑</ci><ci id="S4.E13.m1.18.18.1.1.3.2.3.cmml" xref="S4.E13.m1.18.18.1.1.3.2.3">𝑐</ci></apply><ci id="S4.E13.m1.18.18.1.1.3.3.cmml" xref="S4.E13.m1.18.18.1.1.3.3">𝑙</ci></apply><apply id="S4.E13.m1.18.18.1.1.1.cmml" xref="S4.E13.m1.18.18.1.1.1"><times id="S4.E13.m1.18.18.1.1.1.2.cmml" xref="S4.E13.m1.18.18.1.1.1.2"></times><apply id="S4.E13.m1.18.18.1.1.1.3.cmml" xref="S4.E13.m1.18.18.1.1.1.3"><csymbol cd="ambiguous" id="S4.E13.m1.18.18.1.1.1.3.1.cmml" xref="S4.E13.m1.18.18.1.1.1.3">subscript</csymbol><ci id="S4.E13.m1.18.18.1.1.1.3.2.cmml" xref="S4.E13.m1.18.18.1.1.1.3.2">𝑑</ci><max id="S4.E13.m1.18.18.1.1.1.3.3.cmml" xref="S4.E13.m1.18.18.1.1.1.3.3"></max></apply><apply id="S4.E13.m1.18.18.1.1.1.1.2.cmml" xref="S4.E13.m1.18.18.1.1.1.1.1"><csymbol cd="latexml" id="S4.E13.m1.18.18.1.1.1.1.2.1.cmml" xref="S4.E13.m1.18.18.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S4.E13.m1.18.18.1.1.1.1.1.1.cmml" xref="S4.E13.m1.18.18.1.1.1.1.1.1"><minus id="S4.E13.m1.18.18.1.1.1.1.1.1.2.cmml" xref="S4.E13.m1.18.18.1.1.1.1.1.1.2"></minus><cn id="S4.E13.m1.18.18.1.1.1.1.1.1.3.cmml" type="integer" xref="S4.E13.m1.18.18.1.1.1.1.1.1.3">1</cn><apply id="S4.E13.m1.18.18.1.1.1.1.1.1.1.cmml" xref="S4.E13.m1.18.18.1.1.1.1.1.1.1"><times id="S4.E13.m1.18.18.1.1.1.1.1.1.1.2.cmml" xref="S4.E13.m1.18.18.1.1.1.1.1.1.1.2"></times><apply id="S4.E13.m1.17.17.cmml" xref="S4.E13.m1.18.18.1.1.1.1.1.1.1.3.2"><divide id="S4.E13.m1.17.17.18.cmml" xref="S4.E13.m1.18.18.1.1.1.1.1.1.1.3.2"></divide><apply id="S4.E13.m1.7.7.7.cmml" xref="S4.E13.m1.7.7.7"><minus id="S4.E13.m1.7.7.7.8.cmml" xref="S4.E13.m1.7.7.7.8"></minus><apply id="S4.E13.m1.6.6.6.6.cmml" xref="S4.E13.m1.6.6.6.6"><apply id="S4.E13.m1.6.6.6.6.2.cmml" xref="S4.E13.m1.6.6.6.6.2"><csymbol cd="ambiguous" id="S4.E13.m1.6.6.6.6.2.1.cmml" xref="S4.E13.m1.6.6.6.6.2">subscript</csymbol><max id="S4.E13.m1.6.6.6.6.2.2.cmml" xref="S4.E13.m1.6.6.6.6.2.2"></max><list id="S4.E13.m1.3.3.3.3.3.4.cmml" xref="S4.E13.m1.3.3.3.3.3.3"><ci id="S4.E13.m1.1.1.1.1.1.1.cmml" xref="S4.E13.m1.1.1.1.1.1.1">𝑖</ci><in id="S4.E13.m1.2.2.2.2.2.2.cmml" xref="S4.E13.m1.2.2.2.2.2.2"></in><apply id="S4.E13.m1.3.3.3.3.3.3.1.2.cmml" xref="S4.E13.m1.3.3.3.3.3.3.1.1"><csymbol cd="latexml" id="S4.E13.m1.3.3.3.3.3.3.1.2.1.cmml" xref="S4.E13.m1.3.3.3.3.3.3.1.1.2">delimited-[]</csymbol><apply id="S4.E13.m1.3.3.3.3.3.3.1.1.1.cmml" xref="S4.E13.m1.3.3.3.3.3.3.1.1.1"><ci id="S4.E13.m1.3.3.3.3.3.3.1.1.1.1.cmml" xref="S4.E13.m1.3.3.3.3.3.3.1.1.1.1">:</ci><cn id="S4.E13.m1.3.3.3.3.3.3.1.1.1.2.cmml" type="integer" xref="S4.E13.m1.3.3.3.3.3.3.1.1.1.2">1</cn><ci id="S4.E13.m1.3.3.3.3.3.3.1.1.1.3.cmml" xref="S4.E13.m1.3.3.3.3.3.3.1.1.1.3">𝐿</ci></apply></apply></list></apply><apply id="S4.E13.m1.6.6.6.6.1.2.cmml" xref="S4.E13.m1.6.6.6.6.1.1"><log id="S4.E13.m1.4.4.4.4.cmml" xref="S4.E13.m1.4.4.4.4"></log><apply id="S4.E13.m1.6.6.6.6.1.1.1.1.cmml" xref="S4.E13.m1.6.6.6.6.1.1.1.1"><csymbol cd="ambiguous" id="S4.E13.m1.6.6.6.6.1.1.1.1.1.cmml" xref="S4.E13.m1.6.6.6.6.1.1.1.1">subscript</csymbol><apply id="S4.E13.m1.6.6.6.6.1.1.1.1.2.cmml" xref="S4.E13.m1.6.6.6.6.1.1.1.1.2"><ci id="S4.E13.m1.6.6.6.6.1.1.1.1.2.1.cmml" xref="S4.E13.m1.6.6.6.6.1.1.1.1.2.1">~</ci><ci id="S4.E13.m1.6.6.6.6.1.1.1.1.2.2.cmml" xref="S4.E13.m1.6.6.6.6.1.1.1.1.2.2">𝜅</ci></apply><ci id="S4.E13.m1.6.6.6.6.1.1.1.1.3.cmml" xref="S4.E13.m1.6.6.6.6.1.1.1.1.3">𝑖</ci></apply></apply></apply><apply id="S4.E13.m1.7.7.7.7.2.cmml" xref="S4.E13.m1.7.7.7.7.1"><log id="S4.E13.m1.5.5.5.5.cmml" xref="S4.E13.m1.5.5.5.5"></log><apply id="S4.E13.m1.7.7.7.7.1.1.1.cmml" xref="S4.E13.m1.7.7.7.7.1.1.1"><csymbol cd="ambiguous" id="S4.E13.m1.7.7.7.7.1.1.1.1.cmml" xref="S4.E13.m1.7.7.7.7.1.1.1">subscript</csymbol><apply id="S4.E13.m1.7.7.7.7.1.1.1.2.cmml" xref="S4.E13.m1.7.7.7.7.1.1.1.2"><ci id="S4.E13.m1.7.7.7.7.1.1.1.2.1.cmml" xref="S4.E13.m1.7.7.7.7.1.1.1.2.1">~</ci><ci id="S4.E13.m1.7.7.7.7.1.1.1.2.2.cmml" xref="S4.E13.m1.7.7.7.7.1.1.1.2.2">𝜅</ci></apply><ci id="S4.E13.m1.7.7.7.7.1.1.1.3.cmml" xref="S4.E13.m1.7.7.7.7.1.1.1.3">𝑙</ci></apply></apply></apply><apply id="S4.E13.m1.17.17.17.cmml" xref="S4.E13.m1.17.17.17"><minus id="S4.E13.m1.17.17.17.11.cmml" xref="S4.E13.m1.17.17.17.11"></minus><apply id="S4.E13.m1.16.16.16.9.cmml" xref="S4.E13.m1.16.16.16.9"><apply id="S4.E13.m1.16.16.16.9.2.cmml" xref="S4.E13.m1.16.16.16.9.2"><csymbol cd="ambiguous" id="S4.E13.m1.16.16.16.9.2.1.cmml" xref="S4.E13.m1.16.16.16.9.2">subscript</csymbol><max id="S4.E13.m1.16.16.16.9.2.2.cmml" xref="S4.E13.m1.16.16.16.9.2.2"></max><list id="S4.E13.m1.10.10.10.3.3.4.cmml" xref="S4.E13.m1.10.10.10.3.3.3"><ci id="S4.E13.m1.8.8.8.1.1.1.cmml" xref="S4.E13.m1.8.8.8.1.1.1">𝑖</ci><in id="S4.E13.m1.9.9.9.2.2.2.cmml" xref="S4.E13.m1.9.9.9.2.2.2"></in><apply id="S4.E13.m1.10.10.10.3.3.3.1.2.cmml" xref="S4.E13.m1.10.10.10.3.3.3.1.1"><csymbol cd="latexml" id="S4.E13.m1.10.10.10.3.3.3.1.2.1.cmml" xref="S4.E13.m1.10.10.10.3.3.3.1.1.2">delimited-[]</csymbol><apply id="S4.E13.m1.10.10.10.3.3.3.1.1.1.cmml" xref="S4.E13.m1.10.10.10.3.3.3.1.1.1"><ci id="S4.E13.m1.10.10.10.3.3.3.1.1.1.1.cmml" xref="S4.E13.m1.10.10.10.3.3.3.1.1.1.1">:</ci><cn id="S4.E13.m1.10.10.10.3.3.3.1.1.1.2.cmml" type="integer" xref="S4.E13.m1.10.10.10.3.3.3.1.1.1.2">1</cn><ci id="S4.E13.m1.10.10.10.3.3.3.1.1.1.3.cmml" xref="S4.E13.m1.10.10.10.3.3.3.1.1.1.3">𝐿</ci></apply></apply></list></apply><apply id="S4.E13.m1.16.16.16.9.1.2.cmml" xref="S4.E13.m1.16.16.16.9.1.1"><log id="S4.E13.m1.14.14.14.7.cmml" xref="S4.E13.m1.14.14.14.7"></log><apply id="S4.E13.m1.16.16.16.9.1.1.1.1.cmml" xref="S4.E13.m1.16.16.16.9.1.1.1.1"><csymbol cd="ambiguous" id="S4.E13.m1.16.16.16.9.1.1.1.1.1.cmml" xref="S4.E13.m1.16.16.16.9.1.1.1.1">subscript</csymbol><apply id="S4.E13.m1.16.16.16.9.1.1.1.1.2.cmml" xref="S4.E13.m1.16.16.16.9.1.1.1.1.2"><ci id="S4.E13.m1.16.16.16.9.1.1.1.1.2.1.cmml" xref="S4.E13.m1.16.16.16.9.1.1.1.1.2.1">~</ci><ci id="S4.E13.m1.16.16.16.9.1.1.1.1.2.2.cmml" xref="S4.E13.m1.16.16.16.9.1.1.1.1.2.2">𝜅</ci></apply><ci id="S4.E13.m1.16.16.16.9.1.1.1.1.3.cmml" xref="S4.E13.m1.16.16.16.9.1.1.1.1.3">𝑖</ci></apply></apply></apply><apply id="S4.E13.m1.17.17.17.10.cmml" xref="S4.E13.m1.17.17.17.10"><apply id="S4.E13.m1.17.17.17.10.2.cmml" xref="S4.E13.m1.17.17.17.10.2"><csymbol cd="ambiguous" id="S4.E13.m1.17.17.17.10.2.1.cmml" xref="S4.E13.m1.17.17.17.10.2">subscript</csymbol><min id="S4.E13.m1.17.17.17.10.2.2.cmml" xref="S4.E13.m1.17.17.17.10.2.2"></min><list id="S4.E13.m1.13.13.13.6.3.4.cmml" xref="S4.E13.m1.13.13.13.6.3.3"><ci id="S4.E13.m1.11.11.11.4.1.1.cmml" xref="S4.E13.m1.11.11.11.4.1.1">𝑖</ci><in id="S4.E13.m1.12.12.12.5.2.2.cmml" xref="S4.E13.m1.12.12.12.5.2.2"></in><apply id="S4.E13.m1.13.13.13.6.3.3.1.2.cmml" xref="S4.E13.m1.13.13.13.6.3.3.1.1"><csymbol cd="latexml" id="S4.E13.m1.13.13.13.6.3.3.1.2.1.cmml" xref="S4.E13.m1.13.13.13.6.3.3.1.1.2">delimited-[]</csymbol><apply id="S4.E13.m1.13.13.13.6.3.3.1.1.1.cmml" xref="S4.E13.m1.13.13.13.6.3.3.1.1.1"><ci id="S4.E13.m1.13.13.13.6.3.3.1.1.1.1.cmml" xref="S4.E13.m1.13.13.13.6.3.3.1.1.1.1">:</ci><cn id="S4.E13.m1.13.13.13.6.3.3.1.1.1.2.cmml" type="integer" xref="S4.E13.m1.13.13.13.6.3.3.1.1.1.2">1</cn><ci id="S4.E13.m1.13.13.13.6.3.3.1.1.1.3.cmml" xref="S4.E13.m1.13.13.13.6.3.3.1.1.1.3">𝐿</ci></apply></apply></list></apply><apply id="S4.E13.m1.17.17.17.10.1.2.cmml" xref="S4.E13.m1.17.17.17.10.1.1"><log id="S4.E13.m1.15.15.15.8.cmml" xref="S4.E13.m1.15.15.15.8"></log><apply id="S4.E13.m1.17.17.17.10.1.1.1.1.cmml" xref="S4.E13.m1.17.17.17.10.1.1.1.1"><csymbol cd="ambiguous" id="S4.E13.m1.17.17.17.10.1.1.1.1.1.cmml" xref="S4.E13.m1.17.17.17.10.1.1.1.1">subscript</csymbol><apply id="S4.E13.m1.17.17.17.10.1.1.1.1.2.cmml" xref="S4.E13.m1.17.17.17.10.1.1.1.1.2"><ci id="S4.E13.m1.17.17.17.10.1.1.1.1.2.1.cmml" xref="S4.E13.m1.17.17.17.10.1.1.1.1.2.1">~</ci><ci id="S4.E13.m1.17.17.17.10.1.1.1.1.2.2.cmml" xref="S4.E13.m1.17.17.17.10.1.1.1.1.2.2">𝜅</ci></apply><ci id="S4.E13.m1.17.17.17.10.1.1.1.1.3.cmml" xref="S4.E13.m1.17.17.17.10.1.1.1.1.3">𝑖</ci></apply></apply></apply></apply></apply><apply id="S4.E13.m1.18.18.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E13.m1.18.18.1.1.1.1.1.1.1.1.1"><minus id="S4.E13.m1.18.18.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E13.m1.18.18.1.1.1.1.1.1.1.1.1.1.1"></minus><cn id="S4.E13.m1.18.18.1.1.1.1.1.1.1.1.1.1.2.cmml" type="integer" xref="S4.E13.m1.18.18.1.1.1.1.1.1.1.1.1.1.2">1</cn><apply id="S4.E13.m1.18.18.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E13.m1.18.18.1.1.1.1.1.1.1.1.1.1.3"><divide id="S4.E13.m1.18.18.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E13.m1.18.18.1.1.1.1.1.1.1.1.1.1.3"></divide><apply id="S4.E13.m1.18.18.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E13.m1.18.18.1.1.1.1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S4.E13.m1.18.18.1.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S4.E13.m1.18.18.1.1.1.1.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="S4.E13.m1.18.18.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S4.E13.m1.18.18.1.1.1.1.1.1.1.1.1.1.3.2.2">𝑑</ci><min id="S4.E13.m1.18.18.1.1.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S4.E13.m1.18.18.1.1.1.1.1.1.1.1.1.1.3.2.3"></min></apply><apply id="S4.E13.m1.18.18.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E13.m1.18.18.1.1.1.1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.E13.m1.18.18.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S4.E13.m1.18.18.1.1.1.1.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="S4.E13.m1.18.18.1.1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S4.E13.m1.18.18.1.1.1.1.1.1.1.1.1.1.3.3.2">𝑑</ci><max id="S4.E13.m1.18.18.1.1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S4.E13.m1.18.18.1.1.1.1.1.1.1.1.1.1.3.3.3"></max></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E13.m1.18c">d_{c}^{l}=d_{\max}\times\left[1-\left(\frac{\max_{i\in[1:L]}\log(\tilde{\kappa%
}_{i})-\log(\tilde{\kappa}_{l})}{\max_{i\in[1:L]}\log(\tilde{\kappa}_{i})-\min%
_{i\in[1:L]}\log(\tilde{\kappa}_{i})}\right)\times\left(1-\frac{d_{\min}}{d_{%
\max}}\right)\right],</annotation><annotation encoding="application/x-llamapun" id="S4.E13.m1.18d">italic_d start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT = italic_d start_POSTSUBSCRIPT roman_max end_POSTSUBSCRIPT × [ 1 - ( divide start_ARG roman_max start_POSTSUBSCRIPT italic_i ∈ [ 1 : italic_L ] end_POSTSUBSCRIPT roman_log ( over~ start_ARG italic_κ end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) - roman_log ( over~ start_ARG italic_κ end_ARG start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT ) end_ARG start_ARG roman_max start_POSTSUBSCRIPT italic_i ∈ [ 1 : italic_L ] end_POSTSUBSCRIPT roman_log ( over~ start_ARG italic_κ end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) - roman_min start_POSTSUBSCRIPT italic_i ∈ [ 1 : italic_L ] end_POSTSUBSCRIPT roman_log ( over~ start_ARG italic_κ end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) end_ARG ) × ( 1 - divide start_ARG italic_d start_POSTSUBSCRIPT roman_min end_POSTSUBSCRIPT end_ARG start_ARG italic_d start_POSTSUBSCRIPT roman_max end_POSTSUBSCRIPT end_ARG ) ] ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(13)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS2.SSS0.Px1.p3.6">where <math alttext="d_{\max}" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px1.p3.3.m1.1"><semantics id="S4.SS2.SSS0.Px1.p3.3.m1.1a"><msub id="S4.SS2.SSS0.Px1.p3.3.m1.1.1" xref="S4.SS2.SSS0.Px1.p3.3.m1.1.1.cmml"><mi id="S4.SS2.SSS0.Px1.p3.3.m1.1.1.2" xref="S4.SS2.SSS0.Px1.p3.3.m1.1.1.2.cmml">d</mi><mi id="S4.SS2.SSS0.Px1.p3.3.m1.1.1.3" xref="S4.SS2.SSS0.Px1.p3.3.m1.1.1.3.cmml">max</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p3.3.m1.1b"><apply id="S4.SS2.SSS0.Px1.p3.3.m1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p3.3.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px1.p3.3.m1.1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p3.3.m1.1.1">subscript</csymbol><ci id="S4.SS2.SSS0.Px1.p3.3.m1.1.1.2.cmml" xref="S4.SS2.SSS0.Px1.p3.3.m1.1.1.2">𝑑</ci><max id="S4.SS2.SSS0.Px1.p3.3.m1.1.1.3.cmml" xref="S4.SS2.SSS0.Px1.p3.3.m1.1.1.3"></max></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p3.3.m1.1c">d_{\max}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px1.p3.3.m1.1d">italic_d start_POSTSUBSCRIPT roman_max end_POSTSUBSCRIPT</annotation></semantics></math> is the maximum allowable compressed dimension, and <math alttext="d_{\min}" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px1.p3.4.m2.1"><semantics id="S4.SS2.SSS0.Px1.p3.4.m2.1a"><msub id="S4.SS2.SSS0.Px1.p3.4.m2.1.1" xref="S4.SS2.SSS0.Px1.p3.4.m2.1.1.cmml"><mi id="S4.SS2.SSS0.Px1.p3.4.m2.1.1.2" xref="S4.SS2.SSS0.Px1.p3.4.m2.1.1.2.cmml">d</mi><mi id="S4.SS2.SSS0.Px1.p3.4.m2.1.1.3" xref="S4.SS2.SSS0.Px1.p3.4.m2.1.1.3.cmml">min</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p3.4.m2.1b"><apply id="S4.SS2.SSS0.Px1.p3.4.m2.1.1.cmml" xref="S4.SS2.SSS0.Px1.p3.4.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px1.p3.4.m2.1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p3.4.m2.1.1">subscript</csymbol><ci id="S4.SS2.SSS0.Px1.p3.4.m2.1.1.2.cmml" xref="S4.SS2.SSS0.Px1.p3.4.m2.1.1.2">𝑑</ci><min id="S4.SS2.SSS0.Px1.p3.4.m2.1.1.3.cmml" xref="S4.SS2.SSS0.Px1.p3.4.m2.1.1.3"></min></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p3.4.m2.1c">d_{\min}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px1.p3.4.m2.1d">italic_d start_POSTSUBSCRIPT roman_min end_POSTSUBSCRIPT</annotation></semantics></math> is the minimum one.
The logarithmic scale mitigates the effect of large variations in the cumulative condition numbers, providing a more balanced sensitivity metric across layers.
This equation ensures that layers with higher sensitivity (larger <math alttext="\tilde{\kappa}_{l}" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px1.p3.5.m3.1"><semantics id="S4.SS2.SSS0.Px1.p3.5.m3.1a"><msub id="S4.SS2.SSS0.Px1.p3.5.m3.1.1" xref="S4.SS2.SSS0.Px1.p3.5.m3.1.1.cmml"><mover accent="true" id="S4.SS2.SSS0.Px1.p3.5.m3.1.1.2" xref="S4.SS2.SSS0.Px1.p3.5.m3.1.1.2.cmml"><mi id="S4.SS2.SSS0.Px1.p3.5.m3.1.1.2.2" xref="S4.SS2.SSS0.Px1.p3.5.m3.1.1.2.2.cmml">κ</mi><mo id="S4.SS2.SSS0.Px1.p3.5.m3.1.1.2.1" xref="S4.SS2.SSS0.Px1.p3.5.m3.1.1.2.1.cmml">~</mo></mover><mi id="S4.SS2.SSS0.Px1.p3.5.m3.1.1.3" xref="S4.SS2.SSS0.Px1.p3.5.m3.1.1.3.cmml">l</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p3.5.m3.1b"><apply id="S4.SS2.SSS0.Px1.p3.5.m3.1.1.cmml" xref="S4.SS2.SSS0.Px1.p3.5.m3.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px1.p3.5.m3.1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p3.5.m3.1.1">subscript</csymbol><apply id="S4.SS2.SSS0.Px1.p3.5.m3.1.1.2.cmml" xref="S4.SS2.SSS0.Px1.p3.5.m3.1.1.2"><ci id="S4.SS2.SSS0.Px1.p3.5.m3.1.1.2.1.cmml" xref="S4.SS2.SSS0.Px1.p3.5.m3.1.1.2.1">~</ci><ci id="S4.SS2.SSS0.Px1.p3.5.m3.1.1.2.2.cmml" xref="S4.SS2.SSS0.Px1.p3.5.m3.1.1.2.2">𝜅</ci></apply><ci id="S4.SS2.SSS0.Px1.p3.5.m3.1.1.3.cmml" xref="S4.SS2.SSS0.Px1.p3.5.m3.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p3.5.m3.1c">\tilde{\kappa}_{l}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px1.p3.5.m3.1d">over~ start_ARG italic_κ end_ARG start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT</annotation></semantics></math>) retain more dimensions (larger <math alttext="d_{l}" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px1.p3.6.m4.1"><semantics id="S4.SS2.SSS0.Px1.p3.6.m4.1a"><msub id="S4.SS2.SSS0.Px1.p3.6.m4.1.1" xref="S4.SS2.SSS0.Px1.p3.6.m4.1.1.cmml"><mi id="S4.SS2.SSS0.Px1.p3.6.m4.1.1.2" xref="S4.SS2.SSS0.Px1.p3.6.m4.1.1.2.cmml">d</mi><mi id="S4.SS2.SSS0.Px1.p3.6.m4.1.1.3" xref="S4.SS2.SSS0.Px1.p3.6.m4.1.1.3.cmml">l</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p3.6.m4.1b"><apply id="S4.SS2.SSS0.Px1.p3.6.m4.1.1.cmml" xref="S4.SS2.SSS0.Px1.p3.6.m4.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px1.p3.6.m4.1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p3.6.m4.1.1">subscript</csymbol><ci id="S4.SS2.SSS0.Px1.p3.6.m4.1.1.2.cmml" xref="S4.SS2.SSS0.Px1.p3.6.m4.1.1.2">𝑑</ci><ci id="S4.SS2.SSS0.Px1.p3.6.m4.1.1.3.cmml" xref="S4.SS2.SSS0.Px1.p3.6.m4.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p3.6.m4.1c">d_{l}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px1.p3.6.m4.1d">italic_d start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT</annotation></semantics></math>), while less sensitive layers can be compressed more aggressively.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S4.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Multi-head Attention and Group-query Attention</h3>
<div class="ltx_para" id="S4.SS3.p1">
<p class="ltx_p" id="S4.SS3.p1.2">The above derivation in Section <a class="ltx_ref" href="https://arxiv.org/html/2410.03111v1#S4.SS1" title="4.1 KV Cache Compression via Low-rank Approximation of Weight Matrices ‣ 4 Method ‣ LoRC: Low-Rank Compression for LLMs KV Cache with a Progressive Compression Strategy"><span class="ltx_text ltx_ref_tag">4.1</span></a> holds for standard MHA, where the model dimension <math alttext="D" class="ltx_Math" display="inline" id="S4.SS3.p1.1.m1.1"><semantics id="S4.SS3.p1.1.m1.1a"><mi id="S4.SS3.p1.1.m1.1.1" xref="S4.SS3.p1.1.m1.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.1.m1.1b"><ci id="S4.SS3.p1.1.m1.1.1.cmml" xref="S4.SS3.p1.1.m1.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.1.m1.1c">D</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.1.m1.1d">italic_D</annotation></semantics></math> equals to the multiplication of number of head and head dimension <math alttext="h\times d" class="ltx_Math" display="inline" id="S4.SS3.p1.2.m2.1"><semantics id="S4.SS3.p1.2.m2.1a"><mrow id="S4.SS3.p1.2.m2.1.1" xref="S4.SS3.p1.2.m2.1.1.cmml"><mi id="S4.SS3.p1.2.m2.1.1.2" xref="S4.SS3.p1.2.m2.1.1.2.cmml">h</mi><mo id="S4.SS3.p1.2.m2.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.SS3.p1.2.m2.1.1.1.cmml">×</mo><mi id="S4.SS3.p1.2.m2.1.1.3" xref="S4.SS3.p1.2.m2.1.1.3.cmml">d</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.2.m2.1b"><apply id="S4.SS3.p1.2.m2.1.1.cmml" xref="S4.SS3.p1.2.m2.1.1"><times id="S4.SS3.p1.2.m2.1.1.1.cmml" xref="S4.SS3.p1.2.m2.1.1.1"></times><ci id="S4.SS3.p1.2.m2.1.1.2.cmml" xref="S4.SS3.p1.2.m2.1.1.2">ℎ</ci><ci id="S4.SS3.p1.2.m2.1.1.3.cmml" xref="S4.SS3.p1.2.m2.1.1.3">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.2.m2.1c">h\times d</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.2.m2.1d">italic_h × italic_d</annotation></semantics></math>. For GQA, the number of KV heads is reduced as shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2410.03111v1#A4.T3" title="Table 3 ‣ Appendix D Computational details ‣ LoRC: Low-Rank Compression for LLMs KV Cache with a Progressive Compression Strategy"><span class="ltx_text ltx_ref_tag">3</span></a>. To adapt such implementation, we can still follow the above procedure for cache compression. After fetching the key and value from cache, we just need to repeat them according to the number of the total attention heads.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Error Bounds for KV Cache Compression</h2>
<div class="ltx_para" id="S5.p1">
<p class="ltx_p" id="S5.p1.1">In this section, we derive error bounds for our KV cache compression method, considering both individual layer errors and their propagation through a deep network. These theoretical results provide insights into how the matrix decomposition-based compression affects the network’s performance and guide the progressive compression strategy to balance model efficiency and performance.</p>
</div>
<section class="ltx_subsection" id="S5.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1 </span>Error Bound for Key/Value Matrix Approximation</h3>
<div class="ltx_theorem ltx_theorem_theorem" id="Thmtheorem1">
<h6 class="ltx_title ltx_runin ltx_title_theorem"><span class="ltx_tag ltx_tag_theorem"><span class="ltx_text ltx_font_bold" id="Thmtheorem1.1.1.1">Theorem 1</span></span></h6>
<div class="ltx_para" id="Thmtheorem1.p1">
<p class="ltx_p" id="Thmtheorem1.p1.4"><span class="ltx_text ltx_font_italic" id="Thmtheorem1.p1.4.4">Let <math alttext="W\in\mathbb{R}^{m\times n}" class="ltx_Math" display="inline" id="Thmtheorem1.p1.1.1.m1.1"><semantics id="Thmtheorem1.p1.1.1.m1.1a"><mrow id="Thmtheorem1.p1.1.1.m1.1.1" xref="Thmtheorem1.p1.1.1.m1.1.1.cmml"><mi id="Thmtheorem1.p1.1.1.m1.1.1.2" xref="Thmtheorem1.p1.1.1.m1.1.1.2.cmml">W</mi><mo id="Thmtheorem1.p1.1.1.m1.1.1.1" xref="Thmtheorem1.p1.1.1.m1.1.1.1.cmml">∈</mo><msup id="Thmtheorem1.p1.1.1.m1.1.1.3" xref="Thmtheorem1.p1.1.1.m1.1.1.3.cmml"><mi id="Thmtheorem1.p1.1.1.m1.1.1.3.2" xref="Thmtheorem1.p1.1.1.m1.1.1.3.2.cmml">ℝ</mi><mrow id="Thmtheorem1.p1.1.1.m1.1.1.3.3" xref="Thmtheorem1.p1.1.1.m1.1.1.3.3.cmml"><mi id="Thmtheorem1.p1.1.1.m1.1.1.3.3.2" xref="Thmtheorem1.p1.1.1.m1.1.1.3.3.2.cmml">m</mi><mo id="Thmtheorem1.p1.1.1.m1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="Thmtheorem1.p1.1.1.m1.1.1.3.3.1.cmml">×</mo><mi id="Thmtheorem1.p1.1.1.m1.1.1.3.3.3" xref="Thmtheorem1.p1.1.1.m1.1.1.3.3.3.cmml">n</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="Thmtheorem1.p1.1.1.m1.1b"><apply id="Thmtheorem1.p1.1.1.m1.1.1.cmml" xref="Thmtheorem1.p1.1.1.m1.1.1"><in id="Thmtheorem1.p1.1.1.m1.1.1.1.cmml" xref="Thmtheorem1.p1.1.1.m1.1.1.1"></in><ci id="Thmtheorem1.p1.1.1.m1.1.1.2.cmml" xref="Thmtheorem1.p1.1.1.m1.1.1.2">𝑊</ci><apply id="Thmtheorem1.p1.1.1.m1.1.1.3.cmml" xref="Thmtheorem1.p1.1.1.m1.1.1.3"><csymbol cd="ambiguous" id="Thmtheorem1.p1.1.1.m1.1.1.3.1.cmml" xref="Thmtheorem1.p1.1.1.m1.1.1.3">superscript</csymbol><ci id="Thmtheorem1.p1.1.1.m1.1.1.3.2.cmml" xref="Thmtheorem1.p1.1.1.m1.1.1.3.2">ℝ</ci><apply id="Thmtheorem1.p1.1.1.m1.1.1.3.3.cmml" xref="Thmtheorem1.p1.1.1.m1.1.1.3.3"><times id="Thmtheorem1.p1.1.1.m1.1.1.3.3.1.cmml" xref="Thmtheorem1.p1.1.1.m1.1.1.3.3.1"></times><ci id="Thmtheorem1.p1.1.1.m1.1.1.3.3.2.cmml" xref="Thmtheorem1.p1.1.1.m1.1.1.3.3.2">𝑚</ci><ci id="Thmtheorem1.p1.1.1.m1.1.1.3.3.3.cmml" xref="Thmtheorem1.p1.1.1.m1.1.1.3.3.3">𝑛</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmtheorem1.p1.1.1.m1.1c">W\in\mathbb{R}^{m\times n}</annotation><annotation encoding="application/x-llamapun" id="Thmtheorem1.p1.1.1.m1.1d">italic_W ∈ blackboard_R start_POSTSUPERSCRIPT italic_m × italic_n end_POSTSUPERSCRIPT</annotation></semantics></math> be a weight matrix (either key or value), and let <math alttext="\tilde{W}\in\mathbb{R}^{m\times n}" class="ltx_Math" display="inline" id="Thmtheorem1.p1.2.2.m2.1"><semantics id="Thmtheorem1.p1.2.2.m2.1a"><mrow id="Thmtheorem1.p1.2.2.m2.1.1" xref="Thmtheorem1.p1.2.2.m2.1.1.cmml"><mover accent="true" id="Thmtheorem1.p1.2.2.m2.1.1.2" xref="Thmtheorem1.p1.2.2.m2.1.1.2.cmml"><mi id="Thmtheorem1.p1.2.2.m2.1.1.2.2" xref="Thmtheorem1.p1.2.2.m2.1.1.2.2.cmml">W</mi><mo id="Thmtheorem1.p1.2.2.m2.1.1.2.1" xref="Thmtheorem1.p1.2.2.m2.1.1.2.1.cmml">~</mo></mover><mo id="Thmtheorem1.p1.2.2.m2.1.1.1" xref="Thmtheorem1.p1.2.2.m2.1.1.1.cmml">∈</mo><msup id="Thmtheorem1.p1.2.2.m2.1.1.3" xref="Thmtheorem1.p1.2.2.m2.1.1.3.cmml"><mi id="Thmtheorem1.p1.2.2.m2.1.1.3.2" xref="Thmtheorem1.p1.2.2.m2.1.1.3.2.cmml">ℝ</mi><mrow id="Thmtheorem1.p1.2.2.m2.1.1.3.3" xref="Thmtheorem1.p1.2.2.m2.1.1.3.3.cmml"><mi id="Thmtheorem1.p1.2.2.m2.1.1.3.3.2" xref="Thmtheorem1.p1.2.2.m2.1.1.3.3.2.cmml">m</mi><mo id="Thmtheorem1.p1.2.2.m2.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="Thmtheorem1.p1.2.2.m2.1.1.3.3.1.cmml">×</mo><mi id="Thmtheorem1.p1.2.2.m2.1.1.3.3.3" xref="Thmtheorem1.p1.2.2.m2.1.1.3.3.3.cmml">n</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="Thmtheorem1.p1.2.2.m2.1b"><apply id="Thmtheorem1.p1.2.2.m2.1.1.cmml" xref="Thmtheorem1.p1.2.2.m2.1.1"><in id="Thmtheorem1.p1.2.2.m2.1.1.1.cmml" xref="Thmtheorem1.p1.2.2.m2.1.1.1"></in><apply id="Thmtheorem1.p1.2.2.m2.1.1.2.cmml" xref="Thmtheorem1.p1.2.2.m2.1.1.2"><ci id="Thmtheorem1.p1.2.2.m2.1.1.2.1.cmml" xref="Thmtheorem1.p1.2.2.m2.1.1.2.1">~</ci><ci id="Thmtheorem1.p1.2.2.m2.1.1.2.2.cmml" xref="Thmtheorem1.p1.2.2.m2.1.1.2.2">𝑊</ci></apply><apply id="Thmtheorem1.p1.2.2.m2.1.1.3.cmml" xref="Thmtheorem1.p1.2.2.m2.1.1.3"><csymbol cd="ambiguous" id="Thmtheorem1.p1.2.2.m2.1.1.3.1.cmml" xref="Thmtheorem1.p1.2.2.m2.1.1.3">superscript</csymbol><ci id="Thmtheorem1.p1.2.2.m2.1.1.3.2.cmml" xref="Thmtheorem1.p1.2.2.m2.1.1.3.2">ℝ</ci><apply id="Thmtheorem1.p1.2.2.m2.1.1.3.3.cmml" xref="Thmtheorem1.p1.2.2.m2.1.1.3.3"><times id="Thmtheorem1.p1.2.2.m2.1.1.3.3.1.cmml" xref="Thmtheorem1.p1.2.2.m2.1.1.3.3.1"></times><ci id="Thmtheorem1.p1.2.2.m2.1.1.3.3.2.cmml" xref="Thmtheorem1.p1.2.2.m2.1.1.3.3.2">𝑚</ci><ci id="Thmtheorem1.p1.2.2.m2.1.1.3.3.3.cmml" xref="Thmtheorem1.p1.2.2.m2.1.1.3.3.3">𝑛</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmtheorem1.p1.2.2.m2.1c">\tilde{W}\in\mathbb{R}^{m\times n}</annotation><annotation encoding="application/x-llamapun" id="Thmtheorem1.p1.2.2.m2.1d">over~ start_ARG italic_W end_ARG ∈ blackboard_R start_POSTSUPERSCRIPT italic_m × italic_n end_POSTSUPERSCRIPT</annotation></semantics></math> be its rank-<math alttext="k" class="ltx_Math" display="inline" id="Thmtheorem1.p1.3.3.m3.1"><semantics id="Thmtheorem1.p1.3.3.m3.1a"><mi id="Thmtheorem1.p1.3.3.m3.1.1" xref="Thmtheorem1.p1.3.3.m3.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="Thmtheorem1.p1.3.3.m3.1b"><ci id="Thmtheorem1.p1.3.3.m3.1.1.cmml" xref="Thmtheorem1.p1.3.3.m3.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="Thmtheorem1.p1.3.3.m3.1c">k</annotation><annotation encoding="application/x-llamapun" id="Thmtheorem1.p1.3.3.m3.1d">italic_k</annotation></semantics></math> approximation obtained via truncated singular value decomposition (SVD). For any input vector <math alttext="x\in\mathbb{R}^{n}" class="ltx_Math" display="inline" id="Thmtheorem1.p1.4.4.m4.1"><semantics id="Thmtheorem1.p1.4.4.m4.1a"><mrow id="Thmtheorem1.p1.4.4.m4.1.1" xref="Thmtheorem1.p1.4.4.m4.1.1.cmml"><mi id="Thmtheorem1.p1.4.4.m4.1.1.2" xref="Thmtheorem1.p1.4.4.m4.1.1.2.cmml">x</mi><mo id="Thmtheorem1.p1.4.4.m4.1.1.1" xref="Thmtheorem1.p1.4.4.m4.1.1.1.cmml">∈</mo><msup id="Thmtheorem1.p1.4.4.m4.1.1.3" xref="Thmtheorem1.p1.4.4.m4.1.1.3.cmml"><mi id="Thmtheorem1.p1.4.4.m4.1.1.3.2" xref="Thmtheorem1.p1.4.4.m4.1.1.3.2.cmml">ℝ</mi><mi id="Thmtheorem1.p1.4.4.m4.1.1.3.3" xref="Thmtheorem1.p1.4.4.m4.1.1.3.3.cmml">n</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="Thmtheorem1.p1.4.4.m4.1b"><apply id="Thmtheorem1.p1.4.4.m4.1.1.cmml" xref="Thmtheorem1.p1.4.4.m4.1.1"><in id="Thmtheorem1.p1.4.4.m4.1.1.1.cmml" xref="Thmtheorem1.p1.4.4.m4.1.1.1"></in><ci id="Thmtheorem1.p1.4.4.m4.1.1.2.cmml" xref="Thmtheorem1.p1.4.4.m4.1.1.2">𝑥</ci><apply id="Thmtheorem1.p1.4.4.m4.1.1.3.cmml" xref="Thmtheorem1.p1.4.4.m4.1.1.3"><csymbol cd="ambiguous" id="Thmtheorem1.p1.4.4.m4.1.1.3.1.cmml" xref="Thmtheorem1.p1.4.4.m4.1.1.3">superscript</csymbol><ci id="Thmtheorem1.p1.4.4.m4.1.1.3.2.cmml" xref="Thmtheorem1.p1.4.4.m4.1.1.3.2">ℝ</ci><ci id="Thmtheorem1.p1.4.4.m4.1.1.3.3.cmml" xref="Thmtheorem1.p1.4.4.m4.1.1.3.3">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmtheorem1.p1.4.4.m4.1c">x\in\mathbb{R}^{n}</annotation><annotation encoding="application/x-llamapun" id="Thmtheorem1.p1.4.4.m4.1d">italic_x ∈ blackboard_R start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT</annotation></semantics></math>, the error introduced by the approximation is bounded by:</span></p>
<table class="ltx_equation ltx_eqn_table" id="S5.E14">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\|Wx-\tilde{W}x\|_{2}\leq\sigma_{k+1}\|x\|_{2}," class="ltx_Math" display="block" id="S5.E14.m1.2"><semantics id="S5.E14.m1.2a"><mrow id="S5.E14.m1.2.2.1" xref="S5.E14.m1.2.2.1.1.cmml"><mrow id="S5.E14.m1.2.2.1.1" xref="S5.E14.m1.2.2.1.1.cmml"><msub id="S5.E14.m1.2.2.1.1.1" xref="S5.E14.m1.2.2.1.1.1.cmml"><mrow id="S5.E14.m1.2.2.1.1.1.1.1" xref="S5.E14.m1.2.2.1.1.1.1.2.cmml"><mo id="S5.E14.m1.2.2.1.1.1.1.1.2" stretchy="false" xref="S5.E14.m1.2.2.1.1.1.1.2.1.cmml">‖</mo><mrow id="S5.E14.m1.2.2.1.1.1.1.1.1" xref="S5.E14.m1.2.2.1.1.1.1.1.1.cmml"><mrow id="S5.E14.m1.2.2.1.1.1.1.1.1.2" xref="S5.E14.m1.2.2.1.1.1.1.1.1.2.cmml"><mi id="S5.E14.m1.2.2.1.1.1.1.1.1.2.2" xref="S5.E14.m1.2.2.1.1.1.1.1.1.2.2.cmml">W</mi><mo id="S5.E14.m1.2.2.1.1.1.1.1.1.2.1" xref="S5.E14.m1.2.2.1.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="S5.E14.m1.2.2.1.1.1.1.1.1.2.3" xref="S5.E14.m1.2.2.1.1.1.1.1.1.2.3.cmml">x</mi></mrow><mo id="S5.E14.m1.2.2.1.1.1.1.1.1.1" xref="S5.E14.m1.2.2.1.1.1.1.1.1.1.cmml">−</mo><mrow id="S5.E14.m1.2.2.1.1.1.1.1.1.3" xref="S5.E14.m1.2.2.1.1.1.1.1.1.3.cmml"><mover accent="true" id="S5.E14.m1.2.2.1.1.1.1.1.1.3.2" xref="S5.E14.m1.2.2.1.1.1.1.1.1.3.2.cmml"><mi id="S5.E14.m1.2.2.1.1.1.1.1.1.3.2.2" xref="S5.E14.m1.2.2.1.1.1.1.1.1.3.2.2.cmml">W</mi><mo id="S5.E14.m1.2.2.1.1.1.1.1.1.3.2.1" xref="S5.E14.m1.2.2.1.1.1.1.1.1.3.2.1.cmml">~</mo></mover><mo id="S5.E14.m1.2.2.1.1.1.1.1.1.3.1" xref="S5.E14.m1.2.2.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S5.E14.m1.2.2.1.1.1.1.1.1.3.3" xref="S5.E14.m1.2.2.1.1.1.1.1.1.3.3.cmml">x</mi></mrow></mrow><mo id="S5.E14.m1.2.2.1.1.1.1.1.3" stretchy="false" xref="S5.E14.m1.2.2.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S5.E14.m1.2.2.1.1.1.3" xref="S5.E14.m1.2.2.1.1.1.3.cmml">2</mn></msub><mo id="S5.E14.m1.2.2.1.1.2" xref="S5.E14.m1.2.2.1.1.2.cmml">≤</mo><mrow id="S5.E14.m1.2.2.1.1.3" xref="S5.E14.m1.2.2.1.1.3.cmml"><msub id="S5.E14.m1.2.2.1.1.3.2" xref="S5.E14.m1.2.2.1.1.3.2.cmml"><mi id="S5.E14.m1.2.2.1.1.3.2.2" xref="S5.E14.m1.2.2.1.1.3.2.2.cmml">σ</mi><mrow id="S5.E14.m1.2.2.1.1.3.2.3" xref="S5.E14.m1.2.2.1.1.3.2.3.cmml"><mi id="S5.E14.m1.2.2.1.1.3.2.3.2" xref="S5.E14.m1.2.2.1.1.3.2.3.2.cmml">k</mi><mo id="S5.E14.m1.2.2.1.1.3.2.3.1" xref="S5.E14.m1.2.2.1.1.3.2.3.1.cmml">+</mo><mn id="S5.E14.m1.2.2.1.1.3.2.3.3" xref="S5.E14.m1.2.2.1.1.3.2.3.3.cmml">1</mn></mrow></msub><mo id="S5.E14.m1.2.2.1.1.3.1" xref="S5.E14.m1.2.2.1.1.3.1.cmml">⁢</mo><msub id="S5.E14.m1.2.2.1.1.3.3" xref="S5.E14.m1.2.2.1.1.3.3.cmml"><mrow id="S5.E14.m1.2.2.1.1.3.3.2.2" xref="S5.E14.m1.2.2.1.1.3.3.2.1.cmml"><mo id="S5.E14.m1.2.2.1.1.3.3.2.2.1" stretchy="false" xref="S5.E14.m1.2.2.1.1.3.3.2.1.1.cmml">‖</mo><mi id="S5.E14.m1.1.1" xref="S5.E14.m1.1.1.cmml">x</mi><mo id="S5.E14.m1.2.2.1.1.3.3.2.2.2" stretchy="false" xref="S5.E14.m1.2.2.1.1.3.3.2.1.1.cmml">‖</mo></mrow><mn id="S5.E14.m1.2.2.1.1.3.3.3" xref="S5.E14.m1.2.2.1.1.3.3.3.cmml">2</mn></msub></mrow></mrow><mo id="S5.E14.m1.2.2.1.2" xref="S5.E14.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.E14.m1.2b"><apply id="S5.E14.m1.2.2.1.1.cmml" xref="S5.E14.m1.2.2.1"><leq id="S5.E14.m1.2.2.1.1.2.cmml" xref="S5.E14.m1.2.2.1.1.2"></leq><apply id="S5.E14.m1.2.2.1.1.1.cmml" xref="S5.E14.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S5.E14.m1.2.2.1.1.1.2.cmml" xref="S5.E14.m1.2.2.1.1.1">subscript</csymbol><apply id="S5.E14.m1.2.2.1.1.1.1.2.cmml" xref="S5.E14.m1.2.2.1.1.1.1.1"><csymbol cd="latexml" id="S5.E14.m1.2.2.1.1.1.1.2.1.cmml" xref="S5.E14.m1.2.2.1.1.1.1.1.2">norm</csymbol><apply id="S5.E14.m1.2.2.1.1.1.1.1.1.cmml" xref="S5.E14.m1.2.2.1.1.1.1.1.1"><minus id="S5.E14.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S5.E14.m1.2.2.1.1.1.1.1.1.1"></minus><apply id="S5.E14.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S5.E14.m1.2.2.1.1.1.1.1.1.2"><times id="S5.E14.m1.2.2.1.1.1.1.1.1.2.1.cmml" xref="S5.E14.m1.2.2.1.1.1.1.1.1.2.1"></times><ci id="S5.E14.m1.2.2.1.1.1.1.1.1.2.2.cmml" xref="S5.E14.m1.2.2.1.1.1.1.1.1.2.2">𝑊</ci><ci id="S5.E14.m1.2.2.1.1.1.1.1.1.2.3.cmml" xref="S5.E14.m1.2.2.1.1.1.1.1.1.2.3">𝑥</ci></apply><apply id="S5.E14.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S5.E14.m1.2.2.1.1.1.1.1.1.3"><times id="S5.E14.m1.2.2.1.1.1.1.1.1.3.1.cmml" xref="S5.E14.m1.2.2.1.1.1.1.1.1.3.1"></times><apply id="S5.E14.m1.2.2.1.1.1.1.1.1.3.2.cmml" xref="S5.E14.m1.2.2.1.1.1.1.1.1.3.2"><ci id="S5.E14.m1.2.2.1.1.1.1.1.1.3.2.1.cmml" xref="S5.E14.m1.2.2.1.1.1.1.1.1.3.2.1">~</ci><ci id="S5.E14.m1.2.2.1.1.1.1.1.1.3.2.2.cmml" xref="S5.E14.m1.2.2.1.1.1.1.1.1.3.2.2">𝑊</ci></apply><ci id="S5.E14.m1.2.2.1.1.1.1.1.1.3.3.cmml" xref="S5.E14.m1.2.2.1.1.1.1.1.1.3.3">𝑥</ci></apply></apply></apply><cn id="S5.E14.m1.2.2.1.1.1.3.cmml" type="integer" xref="S5.E14.m1.2.2.1.1.1.3">2</cn></apply><apply id="S5.E14.m1.2.2.1.1.3.cmml" xref="S5.E14.m1.2.2.1.1.3"><times id="S5.E14.m1.2.2.1.1.3.1.cmml" xref="S5.E14.m1.2.2.1.1.3.1"></times><apply id="S5.E14.m1.2.2.1.1.3.2.cmml" xref="S5.E14.m1.2.2.1.1.3.2"><csymbol cd="ambiguous" id="S5.E14.m1.2.2.1.1.3.2.1.cmml" xref="S5.E14.m1.2.2.1.1.3.2">subscript</csymbol><ci id="S5.E14.m1.2.2.1.1.3.2.2.cmml" xref="S5.E14.m1.2.2.1.1.3.2.2">𝜎</ci><apply id="S5.E14.m1.2.2.1.1.3.2.3.cmml" xref="S5.E14.m1.2.2.1.1.3.2.3"><plus id="S5.E14.m1.2.2.1.1.3.2.3.1.cmml" xref="S5.E14.m1.2.2.1.1.3.2.3.1"></plus><ci id="S5.E14.m1.2.2.1.1.3.2.3.2.cmml" xref="S5.E14.m1.2.2.1.1.3.2.3.2">𝑘</ci><cn id="S5.E14.m1.2.2.1.1.3.2.3.3.cmml" type="integer" xref="S5.E14.m1.2.2.1.1.3.2.3.3">1</cn></apply></apply><apply id="S5.E14.m1.2.2.1.1.3.3.cmml" xref="S5.E14.m1.2.2.1.1.3.3"><csymbol cd="ambiguous" id="S5.E14.m1.2.2.1.1.3.3.1.cmml" xref="S5.E14.m1.2.2.1.1.3.3">subscript</csymbol><apply id="S5.E14.m1.2.2.1.1.3.3.2.1.cmml" xref="S5.E14.m1.2.2.1.1.3.3.2.2"><csymbol cd="latexml" id="S5.E14.m1.2.2.1.1.3.3.2.1.1.cmml" xref="S5.E14.m1.2.2.1.1.3.3.2.2.1">norm</csymbol><ci id="S5.E14.m1.1.1.cmml" xref="S5.E14.m1.1.1">𝑥</ci></apply><cn id="S5.E14.m1.2.2.1.1.3.3.3.cmml" type="integer" xref="S5.E14.m1.2.2.1.1.3.3.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.E14.m1.2c">\|Wx-\tilde{W}x\|_{2}\leq\sigma_{k+1}\|x\|_{2},</annotation><annotation encoding="application/x-llamapun" id="S5.E14.m1.2d">∥ italic_W italic_x - over~ start_ARG italic_W end_ARG italic_x ∥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ≤ italic_σ start_POSTSUBSCRIPT italic_k + 1 end_POSTSUBSCRIPT ∥ italic_x ∥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(14)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="Thmtheorem1.p2">
<p class="ltx_p" id="Thmtheorem1.p2.3"><span class="ltx_text ltx_font_italic" id="Thmtheorem1.p2.3.3">where <math alttext="\sigma_{k+1}" class="ltx_Math" display="inline" id="Thmtheorem1.p2.1.1.m1.1"><semantics id="Thmtheorem1.p2.1.1.m1.1a"><msub id="Thmtheorem1.p2.1.1.m1.1.1" xref="Thmtheorem1.p2.1.1.m1.1.1.cmml"><mi id="Thmtheorem1.p2.1.1.m1.1.1.2" xref="Thmtheorem1.p2.1.1.m1.1.1.2.cmml">σ</mi><mrow id="Thmtheorem1.p2.1.1.m1.1.1.3" xref="Thmtheorem1.p2.1.1.m1.1.1.3.cmml"><mi id="Thmtheorem1.p2.1.1.m1.1.1.3.2" xref="Thmtheorem1.p2.1.1.m1.1.1.3.2.cmml">k</mi><mo id="Thmtheorem1.p2.1.1.m1.1.1.3.1" xref="Thmtheorem1.p2.1.1.m1.1.1.3.1.cmml">+</mo><mn id="Thmtheorem1.p2.1.1.m1.1.1.3.3" xref="Thmtheorem1.p2.1.1.m1.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="Thmtheorem1.p2.1.1.m1.1b"><apply id="Thmtheorem1.p2.1.1.m1.1.1.cmml" xref="Thmtheorem1.p2.1.1.m1.1.1"><csymbol cd="ambiguous" id="Thmtheorem1.p2.1.1.m1.1.1.1.cmml" xref="Thmtheorem1.p2.1.1.m1.1.1">subscript</csymbol><ci id="Thmtheorem1.p2.1.1.m1.1.1.2.cmml" xref="Thmtheorem1.p2.1.1.m1.1.1.2">𝜎</ci><apply id="Thmtheorem1.p2.1.1.m1.1.1.3.cmml" xref="Thmtheorem1.p2.1.1.m1.1.1.3"><plus id="Thmtheorem1.p2.1.1.m1.1.1.3.1.cmml" xref="Thmtheorem1.p2.1.1.m1.1.1.3.1"></plus><ci id="Thmtheorem1.p2.1.1.m1.1.1.3.2.cmml" xref="Thmtheorem1.p2.1.1.m1.1.1.3.2">𝑘</ci><cn id="Thmtheorem1.p2.1.1.m1.1.1.3.3.cmml" type="integer" xref="Thmtheorem1.p2.1.1.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmtheorem1.p2.1.1.m1.1c">\sigma_{k+1}</annotation><annotation encoding="application/x-llamapun" id="Thmtheorem1.p2.1.1.m1.1d">italic_σ start_POSTSUBSCRIPT italic_k + 1 end_POSTSUBSCRIPT</annotation></semantics></math> is the <math alttext="(k+1)" class="ltx_Math" display="inline" id="Thmtheorem1.p2.2.2.m2.1"><semantics id="Thmtheorem1.p2.2.2.m2.1a"><mrow id="Thmtheorem1.p2.2.2.m2.1.1.1" xref="Thmtheorem1.p2.2.2.m2.1.1.1.1.cmml"><mo id="Thmtheorem1.p2.2.2.m2.1.1.1.2" stretchy="false" xref="Thmtheorem1.p2.2.2.m2.1.1.1.1.cmml">(</mo><mrow id="Thmtheorem1.p2.2.2.m2.1.1.1.1" xref="Thmtheorem1.p2.2.2.m2.1.1.1.1.cmml"><mi id="Thmtheorem1.p2.2.2.m2.1.1.1.1.2" xref="Thmtheorem1.p2.2.2.m2.1.1.1.1.2.cmml">k</mi><mo id="Thmtheorem1.p2.2.2.m2.1.1.1.1.1" xref="Thmtheorem1.p2.2.2.m2.1.1.1.1.1.cmml">+</mo><mn id="Thmtheorem1.p2.2.2.m2.1.1.1.1.3" xref="Thmtheorem1.p2.2.2.m2.1.1.1.1.3.cmml">1</mn></mrow><mo id="Thmtheorem1.p2.2.2.m2.1.1.1.3" stretchy="false" xref="Thmtheorem1.p2.2.2.m2.1.1.1.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="Thmtheorem1.p2.2.2.m2.1b"><apply id="Thmtheorem1.p2.2.2.m2.1.1.1.1.cmml" xref="Thmtheorem1.p2.2.2.m2.1.1.1"><plus id="Thmtheorem1.p2.2.2.m2.1.1.1.1.1.cmml" xref="Thmtheorem1.p2.2.2.m2.1.1.1.1.1"></plus><ci id="Thmtheorem1.p2.2.2.m2.1.1.1.1.2.cmml" xref="Thmtheorem1.p2.2.2.m2.1.1.1.1.2">𝑘</ci><cn id="Thmtheorem1.p2.2.2.m2.1.1.1.1.3.cmml" type="integer" xref="Thmtheorem1.p2.2.2.m2.1.1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmtheorem1.p2.2.2.m2.1c">(k+1)</annotation><annotation encoding="application/x-llamapun" id="Thmtheorem1.p2.2.2.m2.1d">( italic_k + 1 )</annotation></semantics></math>-th singular value of <math alttext="W" class="ltx_Math" display="inline" id="Thmtheorem1.p2.3.3.m3.1"><semantics id="Thmtheorem1.p2.3.3.m3.1a"><mi id="Thmtheorem1.p2.3.3.m3.1.1" xref="Thmtheorem1.p2.3.3.m3.1.1.cmml">W</mi><annotation-xml encoding="MathML-Content" id="Thmtheorem1.p2.3.3.m3.1b"><ci id="Thmtheorem1.p2.3.3.m3.1.1.cmml" xref="Thmtheorem1.p2.3.3.m3.1.1">𝑊</ci></annotation-xml><annotation encoding="application/x-tex" id="Thmtheorem1.p2.3.3.m3.1c">W</annotation><annotation encoding="application/x-llamapun" id="Thmtheorem1.p2.3.3.m3.1d">italic_W</annotation></semantics></math>.</span></p>
</div>
</div>
<div class="ltx_para" id="S5.SS1.p1">
<p class="ltx_p" id="S5.SS1.p1.3">The proof is provided in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.03111v1#A1.SS1" title="A.1 Proof of Theorem 1 ‣ Appendix A Detailed Proofs ‣ LoRC: Low-Rank Compression for LLMs KV Cache with a Progressive Compression Strategy"><span class="ltx_text ltx_ref_tag">A.1</span></a>.
This theorem quantifies the error introduced at a single layer due to compressing the weight matrix. The bound indicates that the error is directly proportional to the <math alttext="(k+1)" class="ltx_Math" display="inline" id="S5.SS1.p1.1.m1.1"><semantics id="S5.SS1.p1.1.m1.1a"><mrow id="S5.SS1.p1.1.m1.1.1.1" xref="S5.SS1.p1.1.m1.1.1.1.1.cmml"><mo id="S5.SS1.p1.1.m1.1.1.1.2" stretchy="false" xref="S5.SS1.p1.1.m1.1.1.1.1.cmml">(</mo><mrow id="S5.SS1.p1.1.m1.1.1.1.1" xref="S5.SS1.p1.1.m1.1.1.1.1.cmml"><mi id="S5.SS1.p1.1.m1.1.1.1.1.2" xref="S5.SS1.p1.1.m1.1.1.1.1.2.cmml">k</mi><mo id="S5.SS1.p1.1.m1.1.1.1.1.1" xref="S5.SS1.p1.1.m1.1.1.1.1.1.cmml">+</mo><mn id="S5.SS1.p1.1.m1.1.1.1.1.3" xref="S5.SS1.p1.1.m1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S5.SS1.p1.1.m1.1.1.1.3" stretchy="false" xref="S5.SS1.p1.1.m1.1.1.1.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.1.m1.1b"><apply id="S5.SS1.p1.1.m1.1.1.1.1.cmml" xref="S5.SS1.p1.1.m1.1.1.1"><plus id="S5.SS1.p1.1.m1.1.1.1.1.1.cmml" xref="S5.SS1.p1.1.m1.1.1.1.1.1"></plus><ci id="S5.SS1.p1.1.m1.1.1.1.1.2.cmml" xref="S5.SS1.p1.1.m1.1.1.1.1.2">𝑘</ci><cn id="S5.SS1.p1.1.m1.1.1.1.1.3.cmml" type="integer" xref="S5.SS1.p1.1.m1.1.1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.1.m1.1c">(k+1)</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p1.1.m1.1d">( italic_k + 1 )</annotation></semantics></math>-th singular value of <math alttext="W" class="ltx_Math" display="inline" id="S5.SS1.p1.2.m2.1"><semantics id="S5.SS1.p1.2.m2.1a"><mi id="S5.SS1.p1.2.m2.1.1" xref="S5.SS1.p1.2.m2.1.1.cmml">W</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.2.m2.1b"><ci id="S5.SS1.p1.2.m2.1.1.cmml" xref="S5.SS1.p1.2.m2.1.1">𝑊</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.2.m2.1c">W</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p1.2.m2.1d">italic_W</annotation></semantics></math> and the norm of the input vector <math alttext="x" class="ltx_Math" display="inline" id="S5.SS1.p1.3.m3.1"><semantics id="S5.SS1.p1.3.m3.1a"><mi id="S5.SS1.p1.3.m3.1.1" xref="S5.SS1.p1.3.m3.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.3.m3.1b"><ci id="S5.SS1.p1.3.m3.1.1.cmml" xref="S5.SS1.p1.3.m3.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.3.m3.1c">x</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p1.3.m3.1d">italic_x</annotation></semantics></math>. Larger singular values correspond to directions of significant variance in the data, so truncating smaller singular values (which represent less significant features) minimizes the error introduced by compression.</p>
</div>
</section>
<section class="ltx_subsection" id="S5.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2 </span>Single Layer Error Bound Including Nonlinearities</h3>
<div class="ltx_para" id="S5.SS2.p1">
<p class="ltx_p" id="S5.SS2.p1.1">We now extend the analysis to include the effect of nonlinearities within a single layer. We derive an error bound that accounts for both the approximation of the weight matrix and the layer’s nonlinear activation function. For simplicity, we analyze the error introduced by compressing each weight matrix (key or value) individually.</p>
</div>
<div class="ltx_theorem ltx_theorem_theorem" id="Thmtheorem2">
<h6 class="ltx_title ltx_runin ltx_title_theorem"><span class="ltx_tag ltx_tag_theorem"><span class="ltx_text ltx_font_bold" id="Thmtheorem2.1.1.1">Theorem 2</span></span></h6>
<div class="ltx_para" id="Thmtheorem2.p1">
<p class="ltx_p" id="Thmtheorem2.p1.7"><span class="ltx_text ltx_font_italic" id="Thmtheorem2.p1.7.7">Consider a single layer applying a linear transformation <math alttext="W" class="ltx_Math" display="inline" id="Thmtheorem2.p1.1.1.m1.1"><semantics id="Thmtheorem2.p1.1.1.m1.1a"><mi id="Thmtheorem2.p1.1.1.m1.1.1" xref="Thmtheorem2.p1.1.1.m1.1.1.cmml">W</mi><annotation-xml encoding="MathML-Content" id="Thmtheorem2.p1.1.1.m1.1b"><ci id="Thmtheorem2.p1.1.1.m1.1.1.cmml" xref="Thmtheorem2.p1.1.1.m1.1.1">𝑊</ci></annotation-xml><annotation encoding="application/x-tex" id="Thmtheorem2.p1.1.1.m1.1c">W</annotation><annotation encoding="application/x-llamapun" id="Thmtheorem2.p1.1.1.m1.1d">italic_W</annotation></semantics></math> followed by a nonlinearity <math alttext="\phi" class="ltx_Math" display="inline" id="Thmtheorem2.p1.2.2.m2.1"><semantics id="Thmtheorem2.p1.2.2.m2.1a"><mi id="Thmtheorem2.p1.2.2.m2.1.1" xref="Thmtheorem2.p1.2.2.m2.1.1.cmml">ϕ</mi><annotation-xml encoding="MathML-Content" id="Thmtheorem2.p1.2.2.m2.1b"><ci id="Thmtheorem2.p1.2.2.m2.1.1.cmml" xref="Thmtheorem2.p1.2.2.m2.1.1">italic-ϕ</ci></annotation-xml><annotation encoding="application/x-tex" id="Thmtheorem2.p1.2.2.m2.1c">\phi</annotation><annotation encoding="application/x-llamapun" id="Thmtheorem2.p1.2.2.m2.1d">italic_ϕ</annotation></semantics></math> with Lipschitz constant <math alttext="L_{\phi}" class="ltx_Math" display="inline" id="Thmtheorem2.p1.3.3.m3.1"><semantics id="Thmtheorem2.p1.3.3.m3.1a"><msub id="Thmtheorem2.p1.3.3.m3.1.1" xref="Thmtheorem2.p1.3.3.m3.1.1.cmml"><mi id="Thmtheorem2.p1.3.3.m3.1.1.2" xref="Thmtheorem2.p1.3.3.m3.1.1.2.cmml">L</mi><mi id="Thmtheorem2.p1.3.3.m3.1.1.3" xref="Thmtheorem2.p1.3.3.m3.1.1.3.cmml">ϕ</mi></msub><annotation-xml encoding="MathML-Content" id="Thmtheorem2.p1.3.3.m3.1b"><apply id="Thmtheorem2.p1.3.3.m3.1.1.cmml" xref="Thmtheorem2.p1.3.3.m3.1.1"><csymbol cd="ambiguous" id="Thmtheorem2.p1.3.3.m3.1.1.1.cmml" xref="Thmtheorem2.p1.3.3.m3.1.1">subscript</csymbol><ci id="Thmtheorem2.p1.3.3.m3.1.1.2.cmml" xref="Thmtheorem2.p1.3.3.m3.1.1.2">𝐿</ci><ci id="Thmtheorem2.p1.3.3.m3.1.1.3.cmml" xref="Thmtheorem2.p1.3.3.m3.1.1.3">italic-ϕ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmtheorem2.p1.3.3.m3.1c">L_{\phi}</annotation><annotation encoding="application/x-llamapun" id="Thmtheorem2.p1.3.3.m3.1d">italic_L start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT</annotation></semantics></math>. Let <math alttext="\tilde{W}" class="ltx_Math" display="inline" id="Thmtheorem2.p1.4.4.m4.1"><semantics id="Thmtheorem2.p1.4.4.m4.1a"><mover accent="true" id="Thmtheorem2.p1.4.4.m4.1.1" xref="Thmtheorem2.p1.4.4.m4.1.1.cmml"><mi id="Thmtheorem2.p1.4.4.m4.1.1.2" xref="Thmtheorem2.p1.4.4.m4.1.1.2.cmml">W</mi><mo id="Thmtheorem2.p1.4.4.m4.1.1.1" xref="Thmtheorem2.p1.4.4.m4.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="Thmtheorem2.p1.4.4.m4.1b"><apply id="Thmtheorem2.p1.4.4.m4.1.1.cmml" xref="Thmtheorem2.p1.4.4.m4.1.1"><ci id="Thmtheorem2.p1.4.4.m4.1.1.1.cmml" xref="Thmtheorem2.p1.4.4.m4.1.1.1">~</ci><ci id="Thmtheorem2.p1.4.4.m4.1.1.2.cmml" xref="Thmtheorem2.p1.4.4.m4.1.1.2">𝑊</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmtheorem2.p1.4.4.m4.1c">\tilde{W}</annotation><annotation encoding="application/x-llamapun" id="Thmtheorem2.p1.4.4.m4.1d">over~ start_ARG italic_W end_ARG</annotation></semantics></math> be the compressed version of <math alttext="W" class="ltx_Math" display="inline" id="Thmtheorem2.p1.5.5.m5.1"><semantics id="Thmtheorem2.p1.5.5.m5.1a"><mi id="Thmtheorem2.p1.5.5.m5.1.1" xref="Thmtheorem2.p1.5.5.m5.1.1.cmml">W</mi><annotation-xml encoding="MathML-Content" id="Thmtheorem2.p1.5.5.m5.1b"><ci id="Thmtheorem2.p1.5.5.m5.1.1.cmml" xref="Thmtheorem2.p1.5.5.m5.1.1">𝑊</ci></annotation-xml><annotation encoding="application/x-tex" id="Thmtheorem2.p1.5.5.m5.1c">W</annotation><annotation encoding="application/x-llamapun" id="Thmtheorem2.p1.5.5.m5.1d">italic_W</annotation></semantics></math> obtained via truncated SVD with rank <math alttext="k" class="ltx_Math" display="inline" id="Thmtheorem2.p1.6.6.m6.1"><semantics id="Thmtheorem2.p1.6.6.m6.1a"><mi id="Thmtheorem2.p1.6.6.m6.1.1" xref="Thmtheorem2.p1.6.6.m6.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="Thmtheorem2.p1.6.6.m6.1b"><ci id="Thmtheorem2.p1.6.6.m6.1.1.cmml" xref="Thmtheorem2.p1.6.6.m6.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="Thmtheorem2.p1.6.6.m6.1c">k</annotation><annotation encoding="application/x-llamapun" id="Thmtheorem2.p1.6.6.m6.1d">italic_k</annotation></semantics></math>. For any input vector <math alttext="x\in\mathbb{R}^{n}" class="ltx_Math" display="inline" id="Thmtheorem2.p1.7.7.m7.1"><semantics id="Thmtheorem2.p1.7.7.m7.1a"><mrow id="Thmtheorem2.p1.7.7.m7.1.1" xref="Thmtheorem2.p1.7.7.m7.1.1.cmml"><mi id="Thmtheorem2.p1.7.7.m7.1.1.2" xref="Thmtheorem2.p1.7.7.m7.1.1.2.cmml">x</mi><mo id="Thmtheorem2.p1.7.7.m7.1.1.1" xref="Thmtheorem2.p1.7.7.m7.1.1.1.cmml">∈</mo><msup id="Thmtheorem2.p1.7.7.m7.1.1.3" xref="Thmtheorem2.p1.7.7.m7.1.1.3.cmml"><mi id="Thmtheorem2.p1.7.7.m7.1.1.3.2" xref="Thmtheorem2.p1.7.7.m7.1.1.3.2.cmml">ℝ</mi><mi id="Thmtheorem2.p1.7.7.m7.1.1.3.3" xref="Thmtheorem2.p1.7.7.m7.1.1.3.3.cmml">n</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="Thmtheorem2.p1.7.7.m7.1b"><apply id="Thmtheorem2.p1.7.7.m7.1.1.cmml" xref="Thmtheorem2.p1.7.7.m7.1.1"><in id="Thmtheorem2.p1.7.7.m7.1.1.1.cmml" xref="Thmtheorem2.p1.7.7.m7.1.1.1"></in><ci id="Thmtheorem2.p1.7.7.m7.1.1.2.cmml" xref="Thmtheorem2.p1.7.7.m7.1.1.2">𝑥</ci><apply id="Thmtheorem2.p1.7.7.m7.1.1.3.cmml" xref="Thmtheorem2.p1.7.7.m7.1.1.3"><csymbol cd="ambiguous" id="Thmtheorem2.p1.7.7.m7.1.1.3.1.cmml" xref="Thmtheorem2.p1.7.7.m7.1.1.3">superscript</csymbol><ci id="Thmtheorem2.p1.7.7.m7.1.1.3.2.cmml" xref="Thmtheorem2.p1.7.7.m7.1.1.3.2">ℝ</ci><ci id="Thmtheorem2.p1.7.7.m7.1.1.3.3.cmml" xref="Thmtheorem2.p1.7.7.m7.1.1.3.3">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmtheorem2.p1.7.7.m7.1c">x\in\mathbb{R}^{n}</annotation><annotation encoding="application/x-llamapun" id="Thmtheorem2.p1.7.7.m7.1d">italic_x ∈ blackboard_R start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT</annotation></semantics></math>, the error at the output of the layer is bounded by:</span></p>
<table class="ltx_equation ltx_eqn_table" id="S5.E15">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\left|\phi(Wx)-\phi(\tilde{W}x)\right|\leq L_{\phi}\sigma_{k+1}\|x\|_{2}." class="ltx_Math" display="block" id="S5.E15.m1.2"><semantics id="S5.E15.m1.2a"><mrow id="S5.E15.m1.2.2.1" xref="S5.E15.m1.2.2.1.1.cmml"><mrow id="S5.E15.m1.2.2.1.1" xref="S5.E15.m1.2.2.1.1.cmml"><mrow id="S5.E15.m1.2.2.1.1.1.1" xref="S5.E15.m1.2.2.1.1.1.2.cmml"><mo id="S5.E15.m1.2.2.1.1.1.1.2" xref="S5.E15.m1.2.2.1.1.1.2.1.cmml">|</mo><mrow id="S5.E15.m1.2.2.1.1.1.1.1" xref="S5.E15.m1.2.2.1.1.1.1.1.cmml"><mrow id="S5.E15.m1.2.2.1.1.1.1.1.1" xref="S5.E15.m1.2.2.1.1.1.1.1.1.cmml"><mi id="S5.E15.m1.2.2.1.1.1.1.1.1.3" xref="S5.E15.m1.2.2.1.1.1.1.1.1.3.cmml">ϕ</mi><mo id="S5.E15.m1.2.2.1.1.1.1.1.1.2" xref="S5.E15.m1.2.2.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S5.E15.m1.2.2.1.1.1.1.1.1.1.1" xref="S5.E15.m1.2.2.1.1.1.1.1.1.1.1.1.cmml"><mo id="S5.E15.m1.2.2.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S5.E15.m1.2.2.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S5.E15.m1.2.2.1.1.1.1.1.1.1.1.1" xref="S5.E15.m1.2.2.1.1.1.1.1.1.1.1.1.cmml"><mi id="S5.E15.m1.2.2.1.1.1.1.1.1.1.1.1.2" xref="S5.E15.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml">W</mi><mo id="S5.E15.m1.2.2.1.1.1.1.1.1.1.1.1.1" xref="S5.E15.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S5.E15.m1.2.2.1.1.1.1.1.1.1.1.1.3" xref="S5.E15.m1.2.2.1.1.1.1.1.1.1.1.1.3.cmml">x</mi></mrow><mo id="S5.E15.m1.2.2.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S5.E15.m1.2.2.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S5.E15.m1.2.2.1.1.1.1.1.3" xref="S5.E15.m1.2.2.1.1.1.1.1.3.cmml">−</mo><mrow id="S5.E15.m1.2.2.1.1.1.1.1.2" xref="S5.E15.m1.2.2.1.1.1.1.1.2.cmml"><mi id="S5.E15.m1.2.2.1.1.1.1.1.2.3" xref="S5.E15.m1.2.2.1.1.1.1.1.2.3.cmml">ϕ</mi><mo id="S5.E15.m1.2.2.1.1.1.1.1.2.2" xref="S5.E15.m1.2.2.1.1.1.1.1.2.2.cmml">⁢</mo><mrow id="S5.E15.m1.2.2.1.1.1.1.1.2.1.1" xref="S5.E15.m1.2.2.1.1.1.1.1.2.1.1.1.cmml"><mo id="S5.E15.m1.2.2.1.1.1.1.1.2.1.1.2" stretchy="false" xref="S5.E15.m1.2.2.1.1.1.1.1.2.1.1.1.cmml">(</mo><mrow id="S5.E15.m1.2.2.1.1.1.1.1.2.1.1.1" xref="S5.E15.m1.2.2.1.1.1.1.1.2.1.1.1.cmml"><mover accent="true" id="S5.E15.m1.2.2.1.1.1.1.1.2.1.1.1.2" xref="S5.E15.m1.2.2.1.1.1.1.1.2.1.1.1.2.cmml"><mi id="S5.E15.m1.2.2.1.1.1.1.1.2.1.1.1.2.2" xref="S5.E15.m1.2.2.1.1.1.1.1.2.1.1.1.2.2.cmml">W</mi><mo id="S5.E15.m1.2.2.1.1.1.1.1.2.1.1.1.2.1" xref="S5.E15.m1.2.2.1.1.1.1.1.2.1.1.1.2.1.cmml">~</mo></mover><mo id="S5.E15.m1.2.2.1.1.1.1.1.2.1.1.1.1" xref="S5.E15.m1.2.2.1.1.1.1.1.2.1.1.1.1.cmml">⁢</mo><mi id="S5.E15.m1.2.2.1.1.1.1.1.2.1.1.1.3" xref="S5.E15.m1.2.2.1.1.1.1.1.2.1.1.1.3.cmml">x</mi></mrow><mo id="S5.E15.m1.2.2.1.1.1.1.1.2.1.1.3" stretchy="false" xref="S5.E15.m1.2.2.1.1.1.1.1.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S5.E15.m1.2.2.1.1.1.1.3" xref="S5.E15.m1.2.2.1.1.1.2.1.cmml">|</mo></mrow><mo id="S5.E15.m1.2.2.1.1.2" xref="S5.E15.m1.2.2.1.1.2.cmml">≤</mo><mrow id="S5.E15.m1.2.2.1.1.3" xref="S5.E15.m1.2.2.1.1.3.cmml"><msub id="S5.E15.m1.2.2.1.1.3.2" xref="S5.E15.m1.2.2.1.1.3.2.cmml"><mi id="S5.E15.m1.2.2.1.1.3.2.2" xref="S5.E15.m1.2.2.1.1.3.2.2.cmml">L</mi><mi id="S5.E15.m1.2.2.1.1.3.2.3" xref="S5.E15.m1.2.2.1.1.3.2.3.cmml">ϕ</mi></msub><mo id="S5.E15.m1.2.2.1.1.3.1" xref="S5.E15.m1.2.2.1.1.3.1.cmml">⁢</mo><msub id="S5.E15.m1.2.2.1.1.3.3" xref="S5.E15.m1.2.2.1.1.3.3.cmml"><mi id="S5.E15.m1.2.2.1.1.3.3.2" xref="S5.E15.m1.2.2.1.1.3.3.2.cmml">σ</mi><mrow id="S5.E15.m1.2.2.1.1.3.3.3" xref="S5.E15.m1.2.2.1.1.3.3.3.cmml"><mi id="S5.E15.m1.2.2.1.1.3.3.3.2" xref="S5.E15.m1.2.2.1.1.3.3.3.2.cmml">k</mi><mo id="S5.E15.m1.2.2.1.1.3.3.3.1" xref="S5.E15.m1.2.2.1.1.3.3.3.1.cmml">+</mo><mn id="S5.E15.m1.2.2.1.1.3.3.3.3" xref="S5.E15.m1.2.2.1.1.3.3.3.3.cmml">1</mn></mrow></msub><mo id="S5.E15.m1.2.2.1.1.3.1a" xref="S5.E15.m1.2.2.1.1.3.1.cmml">⁢</mo><msub id="S5.E15.m1.2.2.1.1.3.4" xref="S5.E15.m1.2.2.1.1.3.4.cmml"><mrow id="S5.E15.m1.2.2.1.1.3.4.2.2" xref="S5.E15.m1.2.2.1.1.3.4.2.1.cmml"><mo id="S5.E15.m1.2.2.1.1.3.4.2.2.1" stretchy="false" xref="S5.E15.m1.2.2.1.1.3.4.2.1.1.cmml">‖</mo><mi id="S5.E15.m1.1.1" xref="S5.E15.m1.1.1.cmml">x</mi><mo id="S5.E15.m1.2.2.1.1.3.4.2.2.2" stretchy="false" xref="S5.E15.m1.2.2.1.1.3.4.2.1.1.cmml">‖</mo></mrow><mn id="S5.E15.m1.2.2.1.1.3.4.3" xref="S5.E15.m1.2.2.1.1.3.4.3.cmml">2</mn></msub></mrow></mrow><mo id="S5.E15.m1.2.2.1.2" lspace="0em" xref="S5.E15.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.E15.m1.2b"><apply id="S5.E15.m1.2.2.1.1.cmml" xref="S5.E15.m1.2.2.1"><leq id="S5.E15.m1.2.2.1.1.2.cmml" xref="S5.E15.m1.2.2.1.1.2"></leq><apply id="S5.E15.m1.2.2.1.1.1.2.cmml" xref="S5.E15.m1.2.2.1.1.1.1"><abs id="S5.E15.m1.2.2.1.1.1.2.1.cmml" xref="S5.E15.m1.2.2.1.1.1.1.2"></abs><apply id="S5.E15.m1.2.2.1.1.1.1.1.cmml" xref="S5.E15.m1.2.2.1.1.1.1.1"><minus id="S5.E15.m1.2.2.1.1.1.1.1.3.cmml" xref="S5.E15.m1.2.2.1.1.1.1.1.3"></minus><apply id="S5.E15.m1.2.2.1.1.1.1.1.1.cmml" xref="S5.E15.m1.2.2.1.1.1.1.1.1"><times id="S5.E15.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S5.E15.m1.2.2.1.1.1.1.1.1.2"></times><ci id="S5.E15.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S5.E15.m1.2.2.1.1.1.1.1.1.3">italic-ϕ</ci><apply id="S5.E15.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S5.E15.m1.2.2.1.1.1.1.1.1.1.1"><times id="S5.E15.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S5.E15.m1.2.2.1.1.1.1.1.1.1.1.1.1"></times><ci id="S5.E15.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S5.E15.m1.2.2.1.1.1.1.1.1.1.1.1.2">𝑊</ci><ci id="S5.E15.m1.2.2.1.1.1.1.1.1.1.1.1.3.cmml" xref="S5.E15.m1.2.2.1.1.1.1.1.1.1.1.1.3">𝑥</ci></apply></apply><apply id="S5.E15.m1.2.2.1.1.1.1.1.2.cmml" xref="S5.E15.m1.2.2.1.1.1.1.1.2"><times id="S5.E15.m1.2.2.1.1.1.1.1.2.2.cmml" xref="S5.E15.m1.2.2.1.1.1.1.1.2.2"></times><ci id="S5.E15.m1.2.2.1.1.1.1.1.2.3.cmml" xref="S5.E15.m1.2.2.1.1.1.1.1.2.3">italic-ϕ</ci><apply id="S5.E15.m1.2.2.1.1.1.1.1.2.1.1.1.cmml" xref="S5.E15.m1.2.2.1.1.1.1.1.2.1.1"><times id="S5.E15.m1.2.2.1.1.1.1.1.2.1.1.1.1.cmml" xref="S5.E15.m1.2.2.1.1.1.1.1.2.1.1.1.1"></times><apply id="S5.E15.m1.2.2.1.1.1.1.1.2.1.1.1.2.cmml" xref="S5.E15.m1.2.2.1.1.1.1.1.2.1.1.1.2"><ci id="S5.E15.m1.2.2.1.1.1.1.1.2.1.1.1.2.1.cmml" xref="S5.E15.m1.2.2.1.1.1.1.1.2.1.1.1.2.1">~</ci><ci id="S5.E15.m1.2.2.1.1.1.1.1.2.1.1.1.2.2.cmml" xref="S5.E15.m1.2.2.1.1.1.1.1.2.1.1.1.2.2">𝑊</ci></apply><ci id="S5.E15.m1.2.2.1.1.1.1.1.2.1.1.1.3.cmml" xref="S5.E15.m1.2.2.1.1.1.1.1.2.1.1.1.3">𝑥</ci></apply></apply></apply></apply><apply id="S5.E15.m1.2.2.1.1.3.cmml" xref="S5.E15.m1.2.2.1.1.3"><times id="S5.E15.m1.2.2.1.1.3.1.cmml" xref="S5.E15.m1.2.2.1.1.3.1"></times><apply id="S5.E15.m1.2.2.1.1.3.2.cmml" xref="S5.E15.m1.2.2.1.1.3.2"><csymbol cd="ambiguous" id="S5.E15.m1.2.2.1.1.3.2.1.cmml" xref="S5.E15.m1.2.2.1.1.3.2">subscript</csymbol><ci id="S5.E15.m1.2.2.1.1.3.2.2.cmml" xref="S5.E15.m1.2.2.1.1.3.2.2">𝐿</ci><ci id="S5.E15.m1.2.2.1.1.3.2.3.cmml" xref="S5.E15.m1.2.2.1.1.3.2.3">italic-ϕ</ci></apply><apply id="S5.E15.m1.2.2.1.1.3.3.cmml" xref="S5.E15.m1.2.2.1.1.3.3"><csymbol cd="ambiguous" id="S5.E15.m1.2.2.1.1.3.3.1.cmml" xref="S5.E15.m1.2.2.1.1.3.3">subscript</csymbol><ci id="S5.E15.m1.2.2.1.1.3.3.2.cmml" xref="S5.E15.m1.2.2.1.1.3.3.2">𝜎</ci><apply id="S5.E15.m1.2.2.1.1.3.3.3.cmml" xref="S5.E15.m1.2.2.1.1.3.3.3"><plus id="S5.E15.m1.2.2.1.1.3.3.3.1.cmml" xref="S5.E15.m1.2.2.1.1.3.3.3.1"></plus><ci id="S5.E15.m1.2.2.1.1.3.3.3.2.cmml" xref="S5.E15.m1.2.2.1.1.3.3.3.2">𝑘</ci><cn id="S5.E15.m1.2.2.1.1.3.3.3.3.cmml" type="integer" xref="S5.E15.m1.2.2.1.1.3.3.3.3">1</cn></apply></apply><apply id="S5.E15.m1.2.2.1.1.3.4.cmml" xref="S5.E15.m1.2.2.1.1.3.4"><csymbol cd="ambiguous" id="S5.E15.m1.2.2.1.1.3.4.1.cmml" xref="S5.E15.m1.2.2.1.1.3.4">subscript</csymbol><apply id="S5.E15.m1.2.2.1.1.3.4.2.1.cmml" xref="S5.E15.m1.2.2.1.1.3.4.2.2"><csymbol cd="latexml" id="S5.E15.m1.2.2.1.1.3.4.2.1.1.cmml" xref="S5.E15.m1.2.2.1.1.3.4.2.2.1">norm</csymbol><ci id="S5.E15.m1.1.1.cmml" xref="S5.E15.m1.1.1">𝑥</ci></apply><cn id="S5.E15.m1.2.2.1.1.3.4.3.cmml" type="integer" xref="S5.E15.m1.2.2.1.1.3.4.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.E15.m1.2c">\left|\phi(Wx)-\phi(\tilde{W}x)\right|\leq L_{\phi}\sigma_{k+1}\|x\|_{2}.</annotation><annotation encoding="application/x-llamapun" id="S5.E15.m1.2d">| italic_ϕ ( italic_W italic_x ) - italic_ϕ ( over~ start_ARG italic_W end_ARG italic_x ) | ≤ italic_L start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT italic_σ start_POSTSUBSCRIPT italic_k + 1 end_POSTSUBSCRIPT ∥ italic_x ∥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(15)</span></td>
</tr></tbody>
</table>
</div>
</div>
<div class="ltx_para" id="S5.SS2.p2">
<p class="ltx_p" id="S5.SS2.p2.1">The proof is straightforward by using Theorem 1 and the Lipschitz property of <math alttext="\phi" class="ltx_Math" display="inline" id="S5.SS2.p2.1.m1.1"><semantics id="S5.SS2.p2.1.m1.1a"><mi id="S5.SS2.p2.1.m1.1.1" xref="S5.SS2.p2.1.m1.1.1.cmml">ϕ</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p2.1.m1.1b"><ci id="S5.SS2.p2.1.m1.1.1.cmml" xref="S5.SS2.p2.1.m1.1.1">italic-ϕ</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p2.1.m1.1c">\phi</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p2.1.m1.1d">italic_ϕ</annotation></semantics></math>, we present it as the base case in the proof of Theorem <a class="ltx_ref" href="https://arxiv.org/html/2410.03111v1#Thmtheorem3" title="Theorem 3 ‣ 5.3 Error Propagation Bound ‣ 5 Error Bounds for KV Cache Compression ‣ LoRC: Low-Rank Compression for LLMs KV Cache with a Progressive Compression Strategy"><span class="ltx_text ltx_ref_tag">3</span></a>, which is detailed in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.03111v1#A1.SS2" title="A.2 Proof of Theorem 3 ‣ Appendix A Detailed Proofs ‣ LoRC: Low-Rank Compression for LLMs KV Cache with a Progressive Compression Strategy"><span class="ltx_text ltx_ref_tag">A.2</span></a>.</p>
</div>
<div class="ltx_para" id="S5.SS2.p3">
<p class="ltx_p" id="S5.SS2.p3.1">This theorem shows that the error introduced by the compressed weight matrix propagates through the nonlinearity, scaled by the Lipschitz constant of the activation function.
While considering both matrices simultaneously complicates the bounds due to their interactions within the attention mechanism, it is still feasible to derive combined error bounds because the attention mechanism allows us to mathematically bound these interactions. The total error due to simultaneous compression can be bounded by the sum of their individual approximation errors, scaled by a constant. However, for simplicity and clarity in the following derivation, we use the simplified version that considers each matrix individually.</p>
</div>
</section>
<section class="ltx_subsection" id="S5.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.3 </span>Error Propagation Bound</h3>
<div class="ltx_theorem ltx_theorem_theorem" id="Thmtheorem3">
<h6 class="ltx_title ltx_runin ltx_title_theorem"><span class="ltx_tag ltx_tag_theorem"><span class="ltx_text ltx_font_bold" id="Thmtheorem3.1.1.1">Theorem 3</span></span></h6>
<div class="ltx_para" id="Thmtheorem3.p1">
<p class="ltx_p" id="Thmtheorem3.p1.8"><span class="ltx_text ltx_font_italic" id="Thmtheorem3.p1.8.8">Consider an <math alttext="L" class="ltx_Math" display="inline" id="Thmtheorem3.p1.1.1.m1.1"><semantics id="Thmtheorem3.p1.1.1.m1.1a"><mi id="Thmtheorem3.p1.1.1.m1.1.1" xref="Thmtheorem3.p1.1.1.m1.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="Thmtheorem3.p1.1.1.m1.1b"><ci id="Thmtheorem3.p1.1.1.m1.1.1.cmml" xref="Thmtheorem3.p1.1.1.m1.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="Thmtheorem3.p1.1.1.m1.1c">L</annotation><annotation encoding="application/x-llamapun" id="Thmtheorem3.p1.1.1.m1.1d">italic_L</annotation></semantics></math>-layer network where each layer <math alttext="i" class="ltx_Math" display="inline" id="Thmtheorem3.p1.2.2.m2.1"><semantics id="Thmtheorem3.p1.2.2.m2.1a"><mi id="Thmtheorem3.p1.2.2.m2.1.1" xref="Thmtheorem3.p1.2.2.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="Thmtheorem3.p1.2.2.m2.1b"><ci id="Thmtheorem3.p1.2.2.m2.1.1.cmml" xref="Thmtheorem3.p1.2.2.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="Thmtheorem3.p1.2.2.m2.1c">i</annotation><annotation encoding="application/x-llamapun" id="Thmtheorem3.p1.2.2.m2.1d">italic_i</annotation></semantics></math> applies a linear transformation <math alttext="W_{i}" class="ltx_Math" display="inline" id="Thmtheorem3.p1.3.3.m3.1"><semantics id="Thmtheorem3.p1.3.3.m3.1a"><msub id="Thmtheorem3.p1.3.3.m3.1.1" xref="Thmtheorem3.p1.3.3.m3.1.1.cmml"><mi id="Thmtheorem3.p1.3.3.m3.1.1.2" xref="Thmtheorem3.p1.3.3.m3.1.1.2.cmml">W</mi><mi id="Thmtheorem3.p1.3.3.m3.1.1.3" xref="Thmtheorem3.p1.3.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="Thmtheorem3.p1.3.3.m3.1b"><apply id="Thmtheorem3.p1.3.3.m3.1.1.cmml" xref="Thmtheorem3.p1.3.3.m3.1.1"><csymbol cd="ambiguous" id="Thmtheorem3.p1.3.3.m3.1.1.1.cmml" xref="Thmtheorem3.p1.3.3.m3.1.1">subscript</csymbol><ci id="Thmtheorem3.p1.3.3.m3.1.1.2.cmml" xref="Thmtheorem3.p1.3.3.m3.1.1.2">𝑊</ci><ci id="Thmtheorem3.p1.3.3.m3.1.1.3.cmml" xref="Thmtheorem3.p1.3.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmtheorem3.p1.3.3.m3.1c">W_{i}</annotation><annotation encoding="application/x-llamapun" id="Thmtheorem3.p1.3.3.m3.1d">italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> followed by a nonlinearity <math alttext="\phi" class="ltx_Math" display="inline" id="Thmtheorem3.p1.4.4.m4.1"><semantics id="Thmtheorem3.p1.4.4.m4.1a"><mi id="Thmtheorem3.p1.4.4.m4.1.1" xref="Thmtheorem3.p1.4.4.m4.1.1.cmml">ϕ</mi><annotation-xml encoding="MathML-Content" id="Thmtheorem3.p1.4.4.m4.1b"><ci id="Thmtheorem3.p1.4.4.m4.1.1.cmml" xref="Thmtheorem3.p1.4.4.m4.1.1">italic-ϕ</ci></annotation-xml><annotation encoding="application/x-tex" id="Thmtheorem3.p1.4.4.m4.1c">\phi</annotation><annotation encoding="application/x-llamapun" id="Thmtheorem3.p1.4.4.m4.1d">italic_ϕ</annotation></semantics></math> with Lipschitz constant <math alttext="L_{\phi}" class="ltx_Math" display="inline" id="Thmtheorem3.p1.5.5.m5.1"><semantics id="Thmtheorem3.p1.5.5.m5.1a"><msub id="Thmtheorem3.p1.5.5.m5.1.1" xref="Thmtheorem3.p1.5.5.m5.1.1.cmml"><mi id="Thmtheorem3.p1.5.5.m5.1.1.2" xref="Thmtheorem3.p1.5.5.m5.1.1.2.cmml">L</mi><mi id="Thmtheorem3.p1.5.5.m5.1.1.3" xref="Thmtheorem3.p1.5.5.m5.1.1.3.cmml">ϕ</mi></msub><annotation-xml encoding="MathML-Content" id="Thmtheorem3.p1.5.5.m5.1b"><apply id="Thmtheorem3.p1.5.5.m5.1.1.cmml" xref="Thmtheorem3.p1.5.5.m5.1.1"><csymbol cd="ambiguous" id="Thmtheorem3.p1.5.5.m5.1.1.1.cmml" xref="Thmtheorem3.p1.5.5.m5.1.1">subscript</csymbol><ci id="Thmtheorem3.p1.5.5.m5.1.1.2.cmml" xref="Thmtheorem3.p1.5.5.m5.1.1.2">𝐿</ci><ci id="Thmtheorem3.p1.5.5.m5.1.1.3.cmml" xref="Thmtheorem3.p1.5.5.m5.1.1.3">italic-ϕ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmtheorem3.p1.5.5.m5.1c">L_{\phi}</annotation><annotation encoding="application/x-llamapun" id="Thmtheorem3.p1.5.5.m5.1d">italic_L start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT</annotation></semantics></math>. Let <math alttext="\tilde{W}_{i}" class="ltx_Math" display="inline" id="Thmtheorem3.p1.6.6.m6.1"><semantics id="Thmtheorem3.p1.6.6.m6.1a"><msub id="Thmtheorem3.p1.6.6.m6.1.1" xref="Thmtheorem3.p1.6.6.m6.1.1.cmml"><mover accent="true" id="Thmtheorem3.p1.6.6.m6.1.1.2" xref="Thmtheorem3.p1.6.6.m6.1.1.2.cmml"><mi id="Thmtheorem3.p1.6.6.m6.1.1.2.2" xref="Thmtheorem3.p1.6.6.m6.1.1.2.2.cmml">W</mi><mo id="Thmtheorem3.p1.6.6.m6.1.1.2.1" xref="Thmtheorem3.p1.6.6.m6.1.1.2.1.cmml">~</mo></mover><mi id="Thmtheorem3.p1.6.6.m6.1.1.3" xref="Thmtheorem3.p1.6.6.m6.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="Thmtheorem3.p1.6.6.m6.1b"><apply id="Thmtheorem3.p1.6.6.m6.1.1.cmml" xref="Thmtheorem3.p1.6.6.m6.1.1"><csymbol cd="ambiguous" id="Thmtheorem3.p1.6.6.m6.1.1.1.cmml" xref="Thmtheorem3.p1.6.6.m6.1.1">subscript</csymbol><apply id="Thmtheorem3.p1.6.6.m6.1.1.2.cmml" xref="Thmtheorem3.p1.6.6.m6.1.1.2"><ci id="Thmtheorem3.p1.6.6.m6.1.1.2.1.cmml" xref="Thmtheorem3.p1.6.6.m6.1.1.2.1">~</ci><ci id="Thmtheorem3.p1.6.6.m6.1.1.2.2.cmml" xref="Thmtheorem3.p1.6.6.m6.1.1.2.2">𝑊</ci></apply><ci id="Thmtheorem3.p1.6.6.m6.1.1.3.cmml" xref="Thmtheorem3.p1.6.6.m6.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmtheorem3.p1.6.6.m6.1c">\tilde{W}_{i}</annotation><annotation encoding="application/x-llamapun" id="Thmtheorem3.p1.6.6.m6.1d">over~ start_ARG italic_W end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> be the compressed version of <math alttext="W_{i}" class="ltx_Math" display="inline" id="Thmtheorem3.p1.7.7.m7.1"><semantics id="Thmtheorem3.p1.7.7.m7.1a"><msub id="Thmtheorem3.p1.7.7.m7.1.1" xref="Thmtheorem3.p1.7.7.m7.1.1.cmml"><mi id="Thmtheorem3.p1.7.7.m7.1.1.2" xref="Thmtheorem3.p1.7.7.m7.1.1.2.cmml">W</mi><mi id="Thmtheorem3.p1.7.7.m7.1.1.3" xref="Thmtheorem3.p1.7.7.m7.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="Thmtheorem3.p1.7.7.m7.1b"><apply id="Thmtheorem3.p1.7.7.m7.1.1.cmml" xref="Thmtheorem3.p1.7.7.m7.1.1"><csymbol cd="ambiguous" id="Thmtheorem3.p1.7.7.m7.1.1.1.cmml" xref="Thmtheorem3.p1.7.7.m7.1.1">subscript</csymbol><ci id="Thmtheorem3.p1.7.7.m7.1.1.2.cmml" xref="Thmtheorem3.p1.7.7.m7.1.1.2">𝑊</ci><ci id="Thmtheorem3.p1.7.7.m7.1.1.3.cmml" xref="Thmtheorem3.p1.7.7.m7.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmtheorem3.p1.7.7.m7.1c">W_{i}</annotation><annotation encoding="application/x-llamapun" id="Thmtheorem3.p1.7.7.m7.1d">italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> obtained via truncated SVD with rank <math alttext="k_{i}" class="ltx_Math" display="inline" id="Thmtheorem3.p1.8.8.m8.1"><semantics id="Thmtheorem3.p1.8.8.m8.1a"><msub id="Thmtheorem3.p1.8.8.m8.1.1" xref="Thmtheorem3.p1.8.8.m8.1.1.cmml"><mi id="Thmtheorem3.p1.8.8.m8.1.1.2" xref="Thmtheorem3.p1.8.8.m8.1.1.2.cmml">k</mi><mi id="Thmtheorem3.p1.8.8.m8.1.1.3" xref="Thmtheorem3.p1.8.8.m8.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="Thmtheorem3.p1.8.8.m8.1b"><apply id="Thmtheorem3.p1.8.8.m8.1.1.cmml" xref="Thmtheorem3.p1.8.8.m8.1.1"><csymbol cd="ambiguous" id="Thmtheorem3.p1.8.8.m8.1.1.1.cmml" xref="Thmtheorem3.p1.8.8.m8.1.1">subscript</csymbol><ci id="Thmtheorem3.p1.8.8.m8.1.1.2.cmml" xref="Thmtheorem3.p1.8.8.m8.1.1.2">𝑘</ci><ci id="Thmtheorem3.p1.8.8.m8.1.1.3.cmml" xref="Thmtheorem3.p1.8.8.m8.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmtheorem3.p1.8.8.m8.1c">k_{i}</annotation><annotation encoding="application/x-llamapun" id="Thmtheorem3.p1.8.8.m8.1d">italic_k start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>. The error at the output of the network is bounded by:</span></p>
</div>
<div class="ltx_para" id="Thmtheorem3.p2">
<table class="ltx_equation ltx_eqn_table" id="S5.E16">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\|x_{L}-\tilde{x}_{L}\|_{2}\leq\sum_{i=1}^{L}\left(\sigma_{k_{i}+1}^{(i)}L_{%
\phi}^{L-i}\prod_{j=i+1}^{L}\|W_{j}\|_{2}\right)," class="ltx_Math" display="block" id="S5.E16.m1.2"><semantics id="S5.E16.m1.2a"><mrow id="S5.E16.m1.2.2.1" xref="S5.E16.m1.2.2.1.1.cmml"><mrow id="S5.E16.m1.2.2.1.1" xref="S5.E16.m1.2.2.1.1.cmml"><msub id="S5.E16.m1.2.2.1.1.1" xref="S5.E16.m1.2.2.1.1.1.cmml"><mrow id="S5.E16.m1.2.2.1.1.1.1.1" xref="S5.E16.m1.2.2.1.1.1.1.2.cmml"><mo id="S5.E16.m1.2.2.1.1.1.1.1.2" stretchy="false" xref="S5.E16.m1.2.2.1.1.1.1.2.1.cmml">‖</mo><mrow id="S5.E16.m1.2.2.1.1.1.1.1.1" xref="S5.E16.m1.2.2.1.1.1.1.1.1.cmml"><msub id="S5.E16.m1.2.2.1.1.1.1.1.1.2" xref="S5.E16.m1.2.2.1.1.1.1.1.1.2.cmml"><mi id="S5.E16.m1.2.2.1.1.1.1.1.1.2.2" xref="S5.E16.m1.2.2.1.1.1.1.1.1.2.2.cmml">x</mi><mi id="S5.E16.m1.2.2.1.1.1.1.1.1.2.3" xref="S5.E16.m1.2.2.1.1.1.1.1.1.2.3.cmml">L</mi></msub><mo id="S5.E16.m1.2.2.1.1.1.1.1.1.1" xref="S5.E16.m1.2.2.1.1.1.1.1.1.1.cmml">−</mo><msub id="S5.E16.m1.2.2.1.1.1.1.1.1.3" xref="S5.E16.m1.2.2.1.1.1.1.1.1.3.cmml"><mover accent="true" id="S5.E16.m1.2.2.1.1.1.1.1.1.3.2" xref="S5.E16.m1.2.2.1.1.1.1.1.1.3.2.cmml"><mi id="S5.E16.m1.2.2.1.1.1.1.1.1.3.2.2" xref="S5.E16.m1.2.2.1.1.1.1.1.1.3.2.2.cmml">x</mi><mo id="S5.E16.m1.2.2.1.1.1.1.1.1.3.2.1" xref="S5.E16.m1.2.2.1.1.1.1.1.1.3.2.1.cmml">~</mo></mover><mi id="S5.E16.m1.2.2.1.1.1.1.1.1.3.3" xref="S5.E16.m1.2.2.1.1.1.1.1.1.3.3.cmml">L</mi></msub></mrow><mo id="S5.E16.m1.2.2.1.1.1.1.1.3" stretchy="false" xref="S5.E16.m1.2.2.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S5.E16.m1.2.2.1.1.1.3" xref="S5.E16.m1.2.2.1.1.1.3.cmml">2</mn></msub><mo id="S5.E16.m1.2.2.1.1.3" rspace="0.111em" xref="S5.E16.m1.2.2.1.1.3.cmml">≤</mo><mrow id="S5.E16.m1.2.2.1.1.2" xref="S5.E16.m1.2.2.1.1.2.cmml"><munderover id="S5.E16.m1.2.2.1.1.2.2" xref="S5.E16.m1.2.2.1.1.2.2.cmml"><mo id="S5.E16.m1.2.2.1.1.2.2.2.2" movablelimits="false" rspace="0em" xref="S5.E16.m1.2.2.1.1.2.2.2.2.cmml">∑</mo><mrow id="S5.E16.m1.2.2.1.1.2.2.2.3" xref="S5.E16.m1.2.2.1.1.2.2.2.3.cmml"><mi id="S5.E16.m1.2.2.1.1.2.2.2.3.2" xref="S5.E16.m1.2.2.1.1.2.2.2.3.2.cmml">i</mi><mo id="S5.E16.m1.2.2.1.1.2.2.2.3.1" xref="S5.E16.m1.2.2.1.1.2.2.2.3.1.cmml">=</mo><mn id="S5.E16.m1.2.2.1.1.2.2.2.3.3" xref="S5.E16.m1.2.2.1.1.2.2.2.3.3.cmml">1</mn></mrow><mi id="S5.E16.m1.2.2.1.1.2.2.3" xref="S5.E16.m1.2.2.1.1.2.2.3.cmml">L</mi></munderover><mrow id="S5.E16.m1.2.2.1.1.2.1.1" xref="S5.E16.m1.2.2.1.1.2.1.1.1.cmml"><mo id="S5.E16.m1.2.2.1.1.2.1.1.2" xref="S5.E16.m1.2.2.1.1.2.1.1.1.cmml">(</mo><mrow id="S5.E16.m1.2.2.1.1.2.1.1.1" xref="S5.E16.m1.2.2.1.1.2.1.1.1.cmml"><msubsup id="S5.E16.m1.2.2.1.1.2.1.1.1.3" xref="S5.E16.m1.2.2.1.1.2.1.1.1.3.cmml"><mi id="S5.E16.m1.2.2.1.1.2.1.1.1.3.2.2" xref="S5.E16.m1.2.2.1.1.2.1.1.1.3.2.2.cmml">σ</mi><mrow id="S5.E16.m1.2.2.1.1.2.1.1.1.3.2.3" xref="S5.E16.m1.2.2.1.1.2.1.1.1.3.2.3.cmml"><msub id="S5.E16.m1.2.2.1.1.2.1.1.1.3.2.3.2" xref="S5.E16.m1.2.2.1.1.2.1.1.1.3.2.3.2.cmml"><mi id="S5.E16.m1.2.2.1.1.2.1.1.1.3.2.3.2.2" xref="S5.E16.m1.2.2.1.1.2.1.1.1.3.2.3.2.2.cmml">k</mi><mi id="S5.E16.m1.2.2.1.1.2.1.1.1.3.2.3.2.3" xref="S5.E16.m1.2.2.1.1.2.1.1.1.3.2.3.2.3.cmml">i</mi></msub><mo id="S5.E16.m1.2.2.1.1.2.1.1.1.3.2.3.1" xref="S5.E16.m1.2.2.1.1.2.1.1.1.3.2.3.1.cmml">+</mo><mn id="S5.E16.m1.2.2.1.1.2.1.1.1.3.2.3.3" xref="S5.E16.m1.2.2.1.1.2.1.1.1.3.2.3.3.cmml">1</mn></mrow><mrow id="S5.E16.m1.1.1.1.3" xref="S5.E16.m1.2.2.1.1.2.1.1.1.3.cmml"><mo id="S5.E16.m1.1.1.1.3.1" stretchy="false" xref="S5.E16.m1.2.2.1.1.2.1.1.1.3.cmml">(</mo><mi id="S5.E16.m1.1.1.1.1" xref="S5.E16.m1.1.1.1.1.cmml">i</mi><mo id="S5.E16.m1.1.1.1.3.2" stretchy="false" xref="S5.E16.m1.2.2.1.1.2.1.1.1.3.cmml">)</mo></mrow></msubsup><mo id="S5.E16.m1.2.2.1.1.2.1.1.1.2" xref="S5.E16.m1.2.2.1.1.2.1.1.1.2.cmml">⁢</mo><msubsup id="S5.E16.m1.2.2.1.1.2.1.1.1.4" xref="S5.E16.m1.2.2.1.1.2.1.1.1.4.cmml"><mi id="S5.E16.m1.2.2.1.1.2.1.1.1.4.2.2" xref="S5.E16.m1.2.2.1.1.2.1.1.1.4.2.2.cmml">L</mi><mi id="S5.E16.m1.2.2.1.1.2.1.1.1.4.2.3" xref="S5.E16.m1.2.2.1.1.2.1.1.1.4.2.3.cmml">ϕ</mi><mrow id="S5.E16.m1.2.2.1.1.2.1.1.1.4.3" xref="S5.E16.m1.2.2.1.1.2.1.1.1.4.3.cmml"><mi id="S5.E16.m1.2.2.1.1.2.1.1.1.4.3.2" xref="S5.E16.m1.2.2.1.1.2.1.1.1.4.3.2.cmml">L</mi><mo id="S5.E16.m1.2.2.1.1.2.1.1.1.4.3.1" xref="S5.E16.m1.2.2.1.1.2.1.1.1.4.3.1.cmml">−</mo><mi id="S5.E16.m1.2.2.1.1.2.1.1.1.4.3.3" xref="S5.E16.m1.2.2.1.1.2.1.1.1.4.3.3.cmml">i</mi></mrow></msubsup><mo id="S5.E16.m1.2.2.1.1.2.1.1.1.2a" xref="S5.E16.m1.2.2.1.1.2.1.1.1.2.cmml">⁢</mo><mrow id="S5.E16.m1.2.2.1.1.2.1.1.1.1" xref="S5.E16.m1.2.2.1.1.2.1.1.1.1.cmml"><munderover id="S5.E16.m1.2.2.1.1.2.1.1.1.1.2" xref="S5.E16.m1.2.2.1.1.2.1.1.1.1.2.cmml"><mo id="S5.E16.m1.2.2.1.1.2.1.1.1.1.2.2.2" movablelimits="false" rspace="0em" xref="S5.E16.m1.2.2.1.1.2.1.1.1.1.2.2.2.cmml">∏</mo><mrow id="S5.E16.m1.2.2.1.1.2.1.1.1.1.2.2.3" xref="S5.E16.m1.2.2.1.1.2.1.1.1.1.2.2.3.cmml"><mi id="S5.E16.m1.2.2.1.1.2.1.1.1.1.2.2.3.2" xref="S5.E16.m1.2.2.1.1.2.1.1.1.1.2.2.3.2.cmml">j</mi><mo id="S5.E16.m1.2.2.1.1.2.1.1.1.1.2.2.3.1" xref="S5.E16.m1.2.2.1.1.2.1.1.1.1.2.2.3.1.cmml">=</mo><mrow id="S5.E16.m1.2.2.1.1.2.1.1.1.1.2.2.3.3" xref="S5.E16.m1.2.2.1.1.2.1.1.1.1.2.2.3.3.cmml"><mi id="S5.E16.m1.2.2.1.1.2.1.1.1.1.2.2.3.3.2" xref="S5.E16.m1.2.2.1.1.2.1.1.1.1.2.2.3.3.2.cmml">i</mi><mo id="S5.E16.m1.2.2.1.1.2.1.1.1.1.2.2.3.3.1" xref="S5.E16.m1.2.2.1.1.2.1.1.1.1.2.2.3.3.1.cmml">+</mo><mn id="S5.E16.m1.2.2.1.1.2.1.1.1.1.2.2.3.3.3" xref="S5.E16.m1.2.2.1.1.2.1.1.1.1.2.2.3.3.3.cmml">1</mn></mrow></mrow><mi id="S5.E16.m1.2.2.1.1.2.1.1.1.1.2.3" xref="S5.E16.m1.2.2.1.1.2.1.1.1.1.2.3.cmml">L</mi></munderover><msub id="S5.E16.m1.2.2.1.1.2.1.1.1.1.1" xref="S5.E16.m1.2.2.1.1.2.1.1.1.1.1.cmml"><mrow id="S5.E16.m1.2.2.1.1.2.1.1.1.1.1.1.1" xref="S5.E16.m1.2.2.1.1.2.1.1.1.1.1.1.2.cmml"><mo id="S5.E16.m1.2.2.1.1.2.1.1.1.1.1.1.1.2" stretchy="false" xref="S5.E16.m1.2.2.1.1.2.1.1.1.1.1.1.2.1.cmml">‖</mo><msub id="S5.E16.m1.2.2.1.1.2.1.1.1.1.1.1.1.1" xref="S5.E16.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.cmml"><mi id="S5.E16.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.2" xref="S5.E16.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.2.cmml">W</mi><mi id="S5.E16.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.3" xref="S5.E16.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.3.cmml">j</mi></msub><mo id="S5.E16.m1.2.2.1.1.2.1.1.1.1.1.1.1.3" stretchy="false" xref="S5.E16.m1.2.2.1.1.2.1.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S5.E16.m1.2.2.1.1.2.1.1.1.1.1.3" xref="S5.E16.m1.2.2.1.1.2.1.1.1.1.1.3.cmml">2</mn></msub></mrow></mrow><mo id="S5.E16.m1.2.2.1.1.2.1.1.3" xref="S5.E16.m1.2.2.1.1.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S5.E16.m1.2.2.1.2" xref="S5.E16.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.E16.m1.2b"><apply id="S5.E16.m1.2.2.1.1.cmml" xref="S5.E16.m1.2.2.1"><leq id="S5.E16.m1.2.2.1.1.3.cmml" xref="S5.E16.m1.2.2.1.1.3"></leq><apply id="S5.E16.m1.2.2.1.1.1.cmml" xref="S5.E16.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S5.E16.m1.2.2.1.1.1.2.cmml" xref="S5.E16.m1.2.2.1.1.1">subscript</csymbol><apply id="S5.E16.m1.2.2.1.1.1.1.2.cmml" xref="S5.E16.m1.2.2.1.1.1.1.1"><csymbol cd="latexml" id="S5.E16.m1.2.2.1.1.1.1.2.1.cmml" xref="S5.E16.m1.2.2.1.1.1.1.1.2">norm</csymbol><apply id="S5.E16.m1.2.2.1.1.1.1.1.1.cmml" xref="S5.E16.m1.2.2.1.1.1.1.1.1"><minus id="S5.E16.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S5.E16.m1.2.2.1.1.1.1.1.1.1"></minus><apply id="S5.E16.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S5.E16.m1.2.2.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S5.E16.m1.2.2.1.1.1.1.1.1.2.1.cmml" xref="S5.E16.m1.2.2.1.1.1.1.1.1.2">subscript</csymbol><ci id="S5.E16.m1.2.2.1.1.1.1.1.1.2.2.cmml" xref="S5.E16.m1.2.2.1.1.1.1.1.1.2.2">𝑥</ci><ci id="S5.E16.m1.2.2.1.1.1.1.1.1.2.3.cmml" xref="S5.E16.m1.2.2.1.1.1.1.1.1.2.3">𝐿</ci></apply><apply id="S5.E16.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S5.E16.m1.2.2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S5.E16.m1.2.2.1.1.1.1.1.1.3.1.cmml" xref="S5.E16.m1.2.2.1.1.1.1.1.1.3">subscript</csymbol><apply id="S5.E16.m1.2.2.1.1.1.1.1.1.3.2.cmml" xref="S5.E16.m1.2.2.1.1.1.1.1.1.3.2"><ci id="S5.E16.m1.2.2.1.1.1.1.1.1.3.2.1.cmml" xref="S5.E16.m1.2.2.1.1.1.1.1.1.3.2.1">~</ci><ci id="S5.E16.m1.2.2.1.1.1.1.1.1.3.2.2.cmml" xref="S5.E16.m1.2.2.1.1.1.1.1.1.3.2.2">𝑥</ci></apply><ci id="S5.E16.m1.2.2.1.1.1.1.1.1.3.3.cmml" xref="S5.E16.m1.2.2.1.1.1.1.1.1.3.3">𝐿</ci></apply></apply></apply><cn id="S5.E16.m1.2.2.1.1.1.3.cmml" type="integer" xref="S5.E16.m1.2.2.1.1.1.3">2</cn></apply><apply id="S5.E16.m1.2.2.1.1.2.cmml" xref="S5.E16.m1.2.2.1.1.2"><apply id="S5.E16.m1.2.2.1.1.2.2.cmml" xref="S5.E16.m1.2.2.1.1.2.2"><csymbol cd="ambiguous" id="S5.E16.m1.2.2.1.1.2.2.1.cmml" xref="S5.E16.m1.2.2.1.1.2.2">superscript</csymbol><apply id="S5.E16.m1.2.2.1.1.2.2.2.cmml" xref="S5.E16.m1.2.2.1.1.2.2"><csymbol cd="ambiguous" id="S5.E16.m1.2.2.1.1.2.2.2.1.cmml" xref="S5.E16.m1.2.2.1.1.2.2">subscript</csymbol><sum id="S5.E16.m1.2.2.1.1.2.2.2.2.cmml" xref="S5.E16.m1.2.2.1.1.2.2.2.2"></sum><apply id="S5.E16.m1.2.2.1.1.2.2.2.3.cmml" xref="S5.E16.m1.2.2.1.1.2.2.2.3"><eq id="S5.E16.m1.2.2.1.1.2.2.2.3.1.cmml" xref="S5.E16.m1.2.2.1.1.2.2.2.3.1"></eq><ci id="S5.E16.m1.2.2.1.1.2.2.2.3.2.cmml" xref="S5.E16.m1.2.2.1.1.2.2.2.3.2">𝑖</ci><cn id="S5.E16.m1.2.2.1.1.2.2.2.3.3.cmml" type="integer" xref="S5.E16.m1.2.2.1.1.2.2.2.3.3">1</cn></apply></apply><ci id="S5.E16.m1.2.2.1.1.2.2.3.cmml" xref="S5.E16.m1.2.2.1.1.2.2.3">𝐿</ci></apply><apply id="S5.E16.m1.2.2.1.1.2.1.1.1.cmml" xref="S5.E16.m1.2.2.1.1.2.1.1"><times id="S5.E16.m1.2.2.1.1.2.1.1.1.2.cmml" xref="S5.E16.m1.2.2.1.1.2.1.1.1.2"></times><apply id="S5.E16.m1.2.2.1.1.2.1.1.1.3.cmml" xref="S5.E16.m1.2.2.1.1.2.1.1.1.3"><csymbol cd="ambiguous" id="S5.E16.m1.2.2.1.1.2.1.1.1.3.1.cmml" xref="S5.E16.m1.2.2.1.1.2.1.1.1.3">superscript</csymbol><apply id="S5.E16.m1.2.2.1.1.2.1.1.1.3.2.cmml" xref="S5.E16.m1.2.2.1.1.2.1.1.1.3"><csymbol cd="ambiguous" id="S5.E16.m1.2.2.1.1.2.1.1.1.3.2.1.cmml" xref="S5.E16.m1.2.2.1.1.2.1.1.1.3">subscript</csymbol><ci id="S5.E16.m1.2.2.1.1.2.1.1.1.3.2.2.cmml" xref="S5.E16.m1.2.2.1.1.2.1.1.1.3.2.2">𝜎</ci><apply id="S5.E16.m1.2.2.1.1.2.1.1.1.3.2.3.cmml" xref="S5.E16.m1.2.2.1.1.2.1.1.1.3.2.3"><plus id="S5.E16.m1.2.2.1.1.2.1.1.1.3.2.3.1.cmml" xref="S5.E16.m1.2.2.1.1.2.1.1.1.3.2.3.1"></plus><apply id="S5.E16.m1.2.2.1.1.2.1.1.1.3.2.3.2.cmml" xref="S5.E16.m1.2.2.1.1.2.1.1.1.3.2.3.2"><csymbol cd="ambiguous" id="S5.E16.m1.2.2.1.1.2.1.1.1.3.2.3.2.1.cmml" xref="S5.E16.m1.2.2.1.1.2.1.1.1.3.2.3.2">subscript</csymbol><ci id="S5.E16.m1.2.2.1.1.2.1.1.1.3.2.3.2.2.cmml" xref="S5.E16.m1.2.2.1.1.2.1.1.1.3.2.3.2.2">𝑘</ci><ci id="S5.E16.m1.2.2.1.1.2.1.1.1.3.2.3.2.3.cmml" xref="S5.E16.m1.2.2.1.1.2.1.1.1.3.2.3.2.3">𝑖</ci></apply><cn id="S5.E16.m1.2.2.1.1.2.1.1.1.3.2.3.3.cmml" type="integer" xref="S5.E16.m1.2.2.1.1.2.1.1.1.3.2.3.3">1</cn></apply></apply><ci id="S5.E16.m1.1.1.1.1.cmml" xref="S5.E16.m1.1.1.1.1">𝑖</ci></apply><apply id="S5.E16.m1.2.2.1.1.2.1.1.1.4.cmml" xref="S5.E16.m1.2.2.1.1.2.1.1.1.4"><csymbol cd="ambiguous" id="S5.E16.m1.2.2.1.1.2.1.1.1.4.1.cmml" xref="S5.E16.m1.2.2.1.1.2.1.1.1.4">superscript</csymbol><apply id="S5.E16.m1.2.2.1.1.2.1.1.1.4.2.cmml" xref="S5.E16.m1.2.2.1.1.2.1.1.1.4"><csymbol cd="ambiguous" id="S5.E16.m1.2.2.1.1.2.1.1.1.4.2.1.cmml" xref="S5.E16.m1.2.2.1.1.2.1.1.1.4">subscript</csymbol><ci id="S5.E16.m1.2.2.1.1.2.1.1.1.4.2.2.cmml" xref="S5.E16.m1.2.2.1.1.2.1.1.1.4.2.2">𝐿</ci><ci id="S5.E16.m1.2.2.1.1.2.1.1.1.4.2.3.cmml" xref="S5.E16.m1.2.2.1.1.2.1.1.1.4.2.3">italic-ϕ</ci></apply><apply id="S5.E16.m1.2.2.1.1.2.1.1.1.4.3.cmml" xref="S5.E16.m1.2.2.1.1.2.1.1.1.4.3"><minus id="S5.E16.m1.2.2.1.1.2.1.1.1.4.3.1.cmml" xref="S5.E16.m1.2.2.1.1.2.1.1.1.4.3.1"></minus><ci id="S5.E16.m1.2.2.1.1.2.1.1.1.4.3.2.cmml" xref="S5.E16.m1.2.2.1.1.2.1.1.1.4.3.2">𝐿</ci><ci id="S5.E16.m1.2.2.1.1.2.1.1.1.4.3.3.cmml" xref="S5.E16.m1.2.2.1.1.2.1.1.1.4.3.3">𝑖</ci></apply></apply><apply id="S5.E16.m1.2.2.1.1.2.1.1.1.1.cmml" xref="S5.E16.m1.2.2.1.1.2.1.1.1.1"><apply id="S5.E16.m1.2.2.1.1.2.1.1.1.1.2.cmml" xref="S5.E16.m1.2.2.1.1.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S5.E16.m1.2.2.1.1.2.1.1.1.1.2.1.cmml" xref="S5.E16.m1.2.2.1.1.2.1.1.1.1.2">superscript</csymbol><apply id="S5.E16.m1.2.2.1.1.2.1.1.1.1.2.2.cmml" xref="S5.E16.m1.2.2.1.1.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S5.E16.m1.2.2.1.1.2.1.1.1.1.2.2.1.cmml" xref="S5.E16.m1.2.2.1.1.2.1.1.1.1.2">subscript</csymbol><csymbol cd="latexml" id="S5.E16.m1.2.2.1.1.2.1.1.1.1.2.2.2.cmml" xref="S5.E16.m1.2.2.1.1.2.1.1.1.1.2.2.2">product</csymbol><apply id="S5.E16.m1.2.2.1.1.2.1.1.1.1.2.2.3.cmml" xref="S5.E16.m1.2.2.1.1.2.1.1.1.1.2.2.3"><eq id="S5.E16.m1.2.2.1.1.2.1.1.1.1.2.2.3.1.cmml" xref="S5.E16.m1.2.2.1.1.2.1.1.1.1.2.2.3.1"></eq><ci id="S5.E16.m1.2.2.1.1.2.1.1.1.1.2.2.3.2.cmml" xref="S5.E16.m1.2.2.1.1.2.1.1.1.1.2.2.3.2">𝑗</ci><apply id="S5.E16.m1.2.2.1.1.2.1.1.1.1.2.2.3.3.cmml" xref="S5.E16.m1.2.2.1.1.2.1.1.1.1.2.2.3.3"><plus id="S5.E16.m1.2.2.1.1.2.1.1.1.1.2.2.3.3.1.cmml" xref="S5.E16.m1.2.2.1.1.2.1.1.1.1.2.2.3.3.1"></plus><ci id="S5.E16.m1.2.2.1.1.2.1.1.1.1.2.2.3.3.2.cmml" xref="S5.E16.m1.2.2.1.1.2.1.1.1.1.2.2.3.3.2">𝑖</ci><cn id="S5.E16.m1.2.2.1.1.2.1.1.1.1.2.2.3.3.3.cmml" type="integer" xref="S5.E16.m1.2.2.1.1.2.1.1.1.1.2.2.3.3.3">1</cn></apply></apply></apply><ci id="S5.E16.m1.2.2.1.1.2.1.1.1.1.2.3.cmml" xref="S5.E16.m1.2.2.1.1.2.1.1.1.1.2.3">𝐿</ci></apply><apply id="S5.E16.m1.2.2.1.1.2.1.1.1.1.1.cmml" xref="S5.E16.m1.2.2.1.1.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S5.E16.m1.2.2.1.1.2.1.1.1.1.1.2.cmml" xref="S5.E16.m1.2.2.1.1.2.1.1.1.1.1">subscript</csymbol><apply id="S5.E16.m1.2.2.1.1.2.1.1.1.1.1.1.2.cmml" xref="S5.E16.m1.2.2.1.1.2.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S5.E16.m1.2.2.1.1.2.1.1.1.1.1.1.2.1.cmml" xref="S5.E16.m1.2.2.1.1.2.1.1.1.1.1.1.1.2">norm</csymbol><apply id="S5.E16.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.cmml" xref="S5.E16.m1.2.2.1.1.2.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S5.E16.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.1.cmml" xref="S5.E16.m1.2.2.1.1.2.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S5.E16.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.2.cmml" xref="S5.E16.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.2">𝑊</ci><ci id="S5.E16.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.3.cmml" xref="S5.E16.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.3">𝑗</ci></apply></apply><cn id="S5.E16.m1.2.2.1.1.2.1.1.1.1.1.3.cmml" type="integer" xref="S5.E16.m1.2.2.1.1.2.1.1.1.1.1.3">2</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.E16.m1.2c">\|x_{L}-\tilde{x}_{L}\|_{2}\leq\sum_{i=1}^{L}\left(\sigma_{k_{i}+1}^{(i)}L_{%
\phi}^{L-i}\prod_{j=i+1}^{L}\|W_{j}\|_{2}\right),</annotation><annotation encoding="application/x-llamapun" id="S5.E16.m1.2d">∥ italic_x start_POSTSUBSCRIPT italic_L end_POSTSUBSCRIPT - over~ start_ARG italic_x end_ARG start_POSTSUBSCRIPT italic_L end_POSTSUBSCRIPT ∥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ≤ ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_L end_POSTSUPERSCRIPT ( italic_σ start_POSTSUBSCRIPT italic_k start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT + 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT italic_L start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_L - italic_i end_POSTSUPERSCRIPT ∏ start_POSTSUBSCRIPT italic_j = italic_i + 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_L end_POSTSUPERSCRIPT ∥ italic_W start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ∥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(16)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="Thmtheorem3.p3">
<p class="ltx_p" id="Thmtheorem3.p3.9"><span class="ltx_text ltx_font_italic" id="Thmtheorem3.p3.9.9">where <math alttext="x_{L}" class="ltx_Math" display="inline" id="Thmtheorem3.p3.1.1.m1.1"><semantics id="Thmtheorem3.p3.1.1.m1.1a"><msub id="Thmtheorem3.p3.1.1.m1.1.1" xref="Thmtheorem3.p3.1.1.m1.1.1.cmml"><mi id="Thmtheorem3.p3.1.1.m1.1.1.2" xref="Thmtheorem3.p3.1.1.m1.1.1.2.cmml">x</mi><mi id="Thmtheorem3.p3.1.1.m1.1.1.3" xref="Thmtheorem3.p3.1.1.m1.1.1.3.cmml">L</mi></msub><annotation-xml encoding="MathML-Content" id="Thmtheorem3.p3.1.1.m1.1b"><apply id="Thmtheorem3.p3.1.1.m1.1.1.cmml" xref="Thmtheorem3.p3.1.1.m1.1.1"><csymbol cd="ambiguous" id="Thmtheorem3.p3.1.1.m1.1.1.1.cmml" xref="Thmtheorem3.p3.1.1.m1.1.1">subscript</csymbol><ci id="Thmtheorem3.p3.1.1.m1.1.1.2.cmml" xref="Thmtheorem3.p3.1.1.m1.1.1.2">𝑥</ci><ci id="Thmtheorem3.p3.1.1.m1.1.1.3.cmml" xref="Thmtheorem3.p3.1.1.m1.1.1.3">𝐿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmtheorem3.p3.1.1.m1.1c">x_{L}</annotation><annotation encoding="application/x-llamapun" id="Thmtheorem3.p3.1.1.m1.1d">italic_x start_POSTSUBSCRIPT italic_L end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\tilde{x}_{L}" class="ltx_Math" display="inline" id="Thmtheorem3.p3.2.2.m2.1"><semantics id="Thmtheorem3.p3.2.2.m2.1a"><msub id="Thmtheorem3.p3.2.2.m2.1.1" xref="Thmtheorem3.p3.2.2.m2.1.1.cmml"><mover accent="true" id="Thmtheorem3.p3.2.2.m2.1.1.2" xref="Thmtheorem3.p3.2.2.m2.1.1.2.cmml"><mi id="Thmtheorem3.p3.2.2.m2.1.1.2.2" xref="Thmtheorem3.p3.2.2.m2.1.1.2.2.cmml">x</mi><mo id="Thmtheorem3.p3.2.2.m2.1.1.2.1" xref="Thmtheorem3.p3.2.2.m2.1.1.2.1.cmml">~</mo></mover><mi id="Thmtheorem3.p3.2.2.m2.1.1.3" xref="Thmtheorem3.p3.2.2.m2.1.1.3.cmml">L</mi></msub><annotation-xml encoding="MathML-Content" id="Thmtheorem3.p3.2.2.m2.1b"><apply id="Thmtheorem3.p3.2.2.m2.1.1.cmml" xref="Thmtheorem3.p3.2.2.m2.1.1"><csymbol cd="ambiguous" id="Thmtheorem3.p3.2.2.m2.1.1.1.cmml" xref="Thmtheorem3.p3.2.2.m2.1.1">subscript</csymbol><apply id="Thmtheorem3.p3.2.2.m2.1.1.2.cmml" xref="Thmtheorem3.p3.2.2.m2.1.1.2"><ci id="Thmtheorem3.p3.2.2.m2.1.1.2.1.cmml" xref="Thmtheorem3.p3.2.2.m2.1.1.2.1">~</ci><ci id="Thmtheorem3.p3.2.2.m2.1.1.2.2.cmml" xref="Thmtheorem3.p3.2.2.m2.1.1.2.2">𝑥</ci></apply><ci id="Thmtheorem3.p3.2.2.m2.1.1.3.cmml" xref="Thmtheorem3.p3.2.2.m2.1.1.3">𝐿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmtheorem3.p3.2.2.m2.1c">\tilde{x}_{L}</annotation><annotation encoding="application/x-llamapun" id="Thmtheorem3.p3.2.2.m2.1d">over~ start_ARG italic_x end_ARG start_POSTSUBSCRIPT italic_L end_POSTSUBSCRIPT</annotation></semantics></math> are the outputs of the original and compressed networks, respectively; <math alttext="\sigma_{k_{i}+1}^{(i)}" class="ltx_Math" display="inline" id="Thmtheorem3.p3.3.3.m3.1"><semantics id="Thmtheorem3.p3.3.3.m3.1a"><msubsup id="Thmtheorem3.p3.3.3.m3.1.2" xref="Thmtheorem3.p3.3.3.m3.1.2.cmml"><mi id="Thmtheorem3.p3.3.3.m3.1.2.2.2" xref="Thmtheorem3.p3.3.3.m3.1.2.2.2.cmml">σ</mi><mrow id="Thmtheorem3.p3.3.3.m3.1.2.2.3" xref="Thmtheorem3.p3.3.3.m3.1.2.2.3.cmml"><msub id="Thmtheorem3.p3.3.3.m3.1.2.2.3.2" xref="Thmtheorem3.p3.3.3.m3.1.2.2.3.2.cmml"><mi id="Thmtheorem3.p3.3.3.m3.1.2.2.3.2.2" xref="Thmtheorem3.p3.3.3.m3.1.2.2.3.2.2.cmml">k</mi><mi id="Thmtheorem3.p3.3.3.m3.1.2.2.3.2.3" xref="Thmtheorem3.p3.3.3.m3.1.2.2.3.2.3.cmml">i</mi></msub><mo id="Thmtheorem3.p3.3.3.m3.1.2.2.3.1" xref="Thmtheorem3.p3.3.3.m3.1.2.2.3.1.cmml">+</mo><mn id="Thmtheorem3.p3.3.3.m3.1.2.2.3.3" xref="Thmtheorem3.p3.3.3.m3.1.2.2.3.3.cmml">1</mn></mrow><mrow id="Thmtheorem3.p3.3.3.m3.1.1.1.3" xref="Thmtheorem3.p3.3.3.m3.1.2.cmml"><mo id="Thmtheorem3.p3.3.3.m3.1.1.1.3.1" stretchy="false" xref="Thmtheorem3.p3.3.3.m3.1.2.cmml">(</mo><mi id="Thmtheorem3.p3.3.3.m3.1.1.1.1" xref="Thmtheorem3.p3.3.3.m3.1.1.1.1.cmml">i</mi><mo id="Thmtheorem3.p3.3.3.m3.1.1.1.3.2" stretchy="false" xref="Thmtheorem3.p3.3.3.m3.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="Thmtheorem3.p3.3.3.m3.1b"><apply id="Thmtheorem3.p3.3.3.m3.1.2.cmml" xref="Thmtheorem3.p3.3.3.m3.1.2"><csymbol cd="ambiguous" id="Thmtheorem3.p3.3.3.m3.1.2.1.cmml" xref="Thmtheorem3.p3.3.3.m3.1.2">superscript</csymbol><apply id="Thmtheorem3.p3.3.3.m3.1.2.2.cmml" xref="Thmtheorem3.p3.3.3.m3.1.2"><csymbol cd="ambiguous" id="Thmtheorem3.p3.3.3.m3.1.2.2.1.cmml" xref="Thmtheorem3.p3.3.3.m3.1.2">subscript</csymbol><ci id="Thmtheorem3.p3.3.3.m3.1.2.2.2.cmml" xref="Thmtheorem3.p3.3.3.m3.1.2.2.2">𝜎</ci><apply id="Thmtheorem3.p3.3.3.m3.1.2.2.3.cmml" xref="Thmtheorem3.p3.3.3.m3.1.2.2.3"><plus id="Thmtheorem3.p3.3.3.m3.1.2.2.3.1.cmml" xref="Thmtheorem3.p3.3.3.m3.1.2.2.3.1"></plus><apply id="Thmtheorem3.p3.3.3.m3.1.2.2.3.2.cmml" xref="Thmtheorem3.p3.3.3.m3.1.2.2.3.2"><csymbol cd="ambiguous" id="Thmtheorem3.p3.3.3.m3.1.2.2.3.2.1.cmml" xref="Thmtheorem3.p3.3.3.m3.1.2.2.3.2">subscript</csymbol><ci id="Thmtheorem3.p3.3.3.m3.1.2.2.3.2.2.cmml" xref="Thmtheorem3.p3.3.3.m3.1.2.2.3.2.2">𝑘</ci><ci id="Thmtheorem3.p3.3.3.m3.1.2.2.3.2.3.cmml" xref="Thmtheorem3.p3.3.3.m3.1.2.2.3.2.3">𝑖</ci></apply><cn id="Thmtheorem3.p3.3.3.m3.1.2.2.3.3.cmml" type="integer" xref="Thmtheorem3.p3.3.3.m3.1.2.2.3.3">1</cn></apply></apply><ci id="Thmtheorem3.p3.3.3.m3.1.1.1.1.cmml" xref="Thmtheorem3.p3.3.3.m3.1.1.1.1">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmtheorem3.p3.3.3.m3.1c">\sigma_{k_{i}+1}^{(i)}</annotation><annotation encoding="application/x-llamapun" id="Thmtheorem3.p3.3.3.m3.1d">italic_σ start_POSTSUBSCRIPT italic_k start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT + 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT</annotation></semantics></math> is the <math alttext="(k_{i}+1)" class="ltx_Math" display="inline" id="Thmtheorem3.p3.4.4.m4.1"><semantics id="Thmtheorem3.p3.4.4.m4.1a"><mrow id="Thmtheorem3.p3.4.4.m4.1.1.1" xref="Thmtheorem3.p3.4.4.m4.1.1.1.1.cmml"><mo id="Thmtheorem3.p3.4.4.m4.1.1.1.2" stretchy="false" xref="Thmtheorem3.p3.4.4.m4.1.1.1.1.cmml">(</mo><mrow id="Thmtheorem3.p3.4.4.m4.1.1.1.1" xref="Thmtheorem3.p3.4.4.m4.1.1.1.1.cmml"><msub id="Thmtheorem3.p3.4.4.m4.1.1.1.1.2" xref="Thmtheorem3.p3.4.4.m4.1.1.1.1.2.cmml"><mi id="Thmtheorem3.p3.4.4.m4.1.1.1.1.2.2" xref="Thmtheorem3.p3.4.4.m4.1.1.1.1.2.2.cmml">k</mi><mi id="Thmtheorem3.p3.4.4.m4.1.1.1.1.2.3" xref="Thmtheorem3.p3.4.4.m4.1.1.1.1.2.3.cmml">i</mi></msub><mo id="Thmtheorem3.p3.4.4.m4.1.1.1.1.1" xref="Thmtheorem3.p3.4.4.m4.1.1.1.1.1.cmml">+</mo><mn id="Thmtheorem3.p3.4.4.m4.1.1.1.1.3" xref="Thmtheorem3.p3.4.4.m4.1.1.1.1.3.cmml">1</mn></mrow><mo id="Thmtheorem3.p3.4.4.m4.1.1.1.3" stretchy="false" xref="Thmtheorem3.p3.4.4.m4.1.1.1.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="Thmtheorem3.p3.4.4.m4.1b"><apply id="Thmtheorem3.p3.4.4.m4.1.1.1.1.cmml" xref="Thmtheorem3.p3.4.4.m4.1.1.1"><plus id="Thmtheorem3.p3.4.4.m4.1.1.1.1.1.cmml" xref="Thmtheorem3.p3.4.4.m4.1.1.1.1.1"></plus><apply id="Thmtheorem3.p3.4.4.m4.1.1.1.1.2.cmml" xref="Thmtheorem3.p3.4.4.m4.1.1.1.1.2"><csymbol cd="ambiguous" id="Thmtheorem3.p3.4.4.m4.1.1.1.1.2.1.cmml" xref="Thmtheorem3.p3.4.4.m4.1.1.1.1.2">subscript</csymbol><ci id="Thmtheorem3.p3.4.4.m4.1.1.1.1.2.2.cmml" xref="Thmtheorem3.p3.4.4.m4.1.1.1.1.2.2">𝑘</ci><ci id="Thmtheorem3.p3.4.4.m4.1.1.1.1.2.3.cmml" xref="Thmtheorem3.p3.4.4.m4.1.1.1.1.2.3">𝑖</ci></apply><cn id="Thmtheorem3.p3.4.4.m4.1.1.1.1.3.cmml" type="integer" xref="Thmtheorem3.p3.4.4.m4.1.1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmtheorem3.p3.4.4.m4.1c">(k_{i}+1)</annotation><annotation encoding="application/x-llamapun" id="Thmtheorem3.p3.4.4.m4.1d">( italic_k start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT + 1 )</annotation></semantics></math>-th singular value of <math alttext="W_{i}" class="ltx_Math" display="inline" id="Thmtheorem3.p3.5.5.m5.1"><semantics id="Thmtheorem3.p3.5.5.m5.1a"><msub id="Thmtheorem3.p3.5.5.m5.1.1" xref="Thmtheorem3.p3.5.5.m5.1.1.cmml"><mi id="Thmtheorem3.p3.5.5.m5.1.1.2" xref="Thmtheorem3.p3.5.5.m5.1.1.2.cmml">W</mi><mi id="Thmtheorem3.p3.5.5.m5.1.1.3" xref="Thmtheorem3.p3.5.5.m5.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="Thmtheorem3.p3.5.5.m5.1b"><apply id="Thmtheorem3.p3.5.5.m5.1.1.cmml" xref="Thmtheorem3.p3.5.5.m5.1.1"><csymbol cd="ambiguous" id="Thmtheorem3.p3.5.5.m5.1.1.1.cmml" xref="Thmtheorem3.p3.5.5.m5.1.1">subscript</csymbol><ci id="Thmtheorem3.p3.5.5.m5.1.1.2.cmml" xref="Thmtheorem3.p3.5.5.m5.1.1.2">𝑊</ci><ci id="Thmtheorem3.p3.5.5.m5.1.1.3.cmml" xref="Thmtheorem3.p3.5.5.m5.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmtheorem3.p3.5.5.m5.1c">W_{i}</annotation><annotation encoding="application/x-llamapun" id="Thmtheorem3.p3.5.5.m5.1d">italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>; <math alttext="\|W_{j}\|_{2}" class="ltx_Math" display="inline" id="Thmtheorem3.p3.6.6.m6.1"><semantics id="Thmtheorem3.p3.6.6.m6.1a"><msub id="Thmtheorem3.p3.6.6.m6.1.1" xref="Thmtheorem3.p3.6.6.m6.1.1.cmml"><mrow id="Thmtheorem3.p3.6.6.m6.1.1.1.1" xref="Thmtheorem3.p3.6.6.m6.1.1.1.2.cmml"><mo id="Thmtheorem3.p3.6.6.m6.1.1.1.1.2" stretchy="false" xref="Thmtheorem3.p3.6.6.m6.1.1.1.2.1.cmml">‖</mo><msub id="Thmtheorem3.p3.6.6.m6.1.1.1.1.1" xref="Thmtheorem3.p3.6.6.m6.1.1.1.1.1.cmml"><mi id="Thmtheorem3.p3.6.6.m6.1.1.1.1.1.2" xref="Thmtheorem3.p3.6.6.m6.1.1.1.1.1.2.cmml">W</mi><mi id="Thmtheorem3.p3.6.6.m6.1.1.1.1.1.3" xref="Thmtheorem3.p3.6.6.m6.1.1.1.1.1.3.cmml">j</mi></msub><mo id="Thmtheorem3.p3.6.6.m6.1.1.1.1.3" stretchy="false" xref="Thmtheorem3.p3.6.6.m6.1.1.1.2.1.cmml">‖</mo></mrow><mn id="Thmtheorem3.p3.6.6.m6.1.1.3" xref="Thmtheorem3.p3.6.6.m6.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="Thmtheorem3.p3.6.6.m6.1b"><apply id="Thmtheorem3.p3.6.6.m6.1.1.cmml" xref="Thmtheorem3.p3.6.6.m6.1.1"><csymbol cd="ambiguous" id="Thmtheorem3.p3.6.6.m6.1.1.2.cmml" xref="Thmtheorem3.p3.6.6.m6.1.1">subscript</csymbol><apply id="Thmtheorem3.p3.6.6.m6.1.1.1.2.cmml" xref="Thmtheorem3.p3.6.6.m6.1.1.1.1"><csymbol cd="latexml" id="Thmtheorem3.p3.6.6.m6.1.1.1.2.1.cmml" xref="Thmtheorem3.p3.6.6.m6.1.1.1.1.2">norm</csymbol><apply id="Thmtheorem3.p3.6.6.m6.1.1.1.1.1.cmml" xref="Thmtheorem3.p3.6.6.m6.1.1.1.1.1"><csymbol cd="ambiguous" id="Thmtheorem3.p3.6.6.m6.1.1.1.1.1.1.cmml" xref="Thmtheorem3.p3.6.6.m6.1.1.1.1.1">subscript</csymbol><ci id="Thmtheorem3.p3.6.6.m6.1.1.1.1.1.2.cmml" xref="Thmtheorem3.p3.6.6.m6.1.1.1.1.1.2">𝑊</ci><ci id="Thmtheorem3.p3.6.6.m6.1.1.1.1.1.3.cmml" xref="Thmtheorem3.p3.6.6.m6.1.1.1.1.1.3">𝑗</ci></apply></apply><cn id="Thmtheorem3.p3.6.6.m6.1.1.3.cmml" type="integer" xref="Thmtheorem3.p3.6.6.m6.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmtheorem3.p3.6.6.m6.1c">\|W_{j}\|_{2}</annotation><annotation encoding="application/x-llamapun" id="Thmtheorem3.p3.6.6.m6.1d">∥ italic_W start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ∥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math> denotes the spectral norm of <math alttext="W_{j}" class="ltx_Math" display="inline" id="Thmtheorem3.p3.7.7.m7.1"><semantics id="Thmtheorem3.p3.7.7.m7.1a"><msub id="Thmtheorem3.p3.7.7.m7.1.1" xref="Thmtheorem3.p3.7.7.m7.1.1.cmml"><mi id="Thmtheorem3.p3.7.7.m7.1.1.2" xref="Thmtheorem3.p3.7.7.m7.1.1.2.cmml">W</mi><mi id="Thmtheorem3.p3.7.7.m7.1.1.3" xref="Thmtheorem3.p3.7.7.m7.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="Thmtheorem3.p3.7.7.m7.1b"><apply id="Thmtheorem3.p3.7.7.m7.1.1.cmml" xref="Thmtheorem3.p3.7.7.m7.1.1"><csymbol cd="ambiguous" id="Thmtheorem3.p3.7.7.m7.1.1.1.cmml" xref="Thmtheorem3.p3.7.7.m7.1.1">subscript</csymbol><ci id="Thmtheorem3.p3.7.7.m7.1.1.2.cmml" xref="Thmtheorem3.p3.7.7.m7.1.1.2">𝑊</ci><ci id="Thmtheorem3.p3.7.7.m7.1.1.3.cmml" xref="Thmtheorem3.p3.7.7.m7.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmtheorem3.p3.7.7.m7.1c">W_{j}</annotation><annotation encoding="application/x-llamapun" id="Thmtheorem3.p3.7.7.m7.1d">italic_W start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math>; and <math alttext="L_{\phi}" class="ltx_Math" display="inline" id="Thmtheorem3.p3.8.8.m8.1"><semantics id="Thmtheorem3.p3.8.8.m8.1a"><msub id="Thmtheorem3.p3.8.8.m8.1.1" xref="Thmtheorem3.p3.8.8.m8.1.1.cmml"><mi id="Thmtheorem3.p3.8.8.m8.1.1.2" xref="Thmtheorem3.p3.8.8.m8.1.1.2.cmml">L</mi><mi id="Thmtheorem3.p3.8.8.m8.1.1.3" xref="Thmtheorem3.p3.8.8.m8.1.1.3.cmml">ϕ</mi></msub><annotation-xml encoding="MathML-Content" id="Thmtheorem3.p3.8.8.m8.1b"><apply id="Thmtheorem3.p3.8.8.m8.1.1.cmml" xref="Thmtheorem3.p3.8.8.m8.1.1"><csymbol cd="ambiguous" id="Thmtheorem3.p3.8.8.m8.1.1.1.cmml" xref="Thmtheorem3.p3.8.8.m8.1.1">subscript</csymbol><ci id="Thmtheorem3.p3.8.8.m8.1.1.2.cmml" xref="Thmtheorem3.p3.8.8.m8.1.1.2">𝐿</ci><ci id="Thmtheorem3.p3.8.8.m8.1.1.3.cmml" xref="Thmtheorem3.p3.8.8.m8.1.1.3">italic-ϕ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmtheorem3.p3.8.8.m8.1c">L_{\phi}</annotation><annotation encoding="application/x-llamapun" id="Thmtheorem3.p3.8.8.m8.1d">italic_L start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT</annotation></semantics></math> is the Lipschitz constant of the activation function <math alttext="\phi" class="ltx_Math" display="inline" id="Thmtheorem3.p3.9.9.m9.1"><semantics id="Thmtheorem3.p3.9.9.m9.1a"><mi id="Thmtheorem3.p3.9.9.m9.1.1" xref="Thmtheorem3.p3.9.9.m9.1.1.cmml">ϕ</mi><annotation-xml encoding="MathML-Content" id="Thmtheorem3.p3.9.9.m9.1b"><ci id="Thmtheorem3.p3.9.9.m9.1.1.cmml" xref="Thmtheorem3.p3.9.9.m9.1.1">italic-ϕ</ci></annotation-xml><annotation encoding="application/x-tex" id="Thmtheorem3.p3.9.9.m9.1c">\phi</annotation><annotation encoding="application/x-llamapun" id="Thmtheorem3.p3.9.9.m9.1d">italic_ϕ</annotation></semantics></math>.</span></p>
</div>
</div>
<div class="ltx_para" id="S5.SS3.p1">
<p class="ltx_p" id="S5.SS3.p1.1">We detail the proof in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.03111v1#A1.SS2" title="A.2 Proof of Theorem 3 ‣ Appendix A Detailed Proofs ‣ LoRC: Low-Rank Compression for LLMs KV Cache with a Progressive Compression Strategy"><span class="ltx_text ltx_ref_tag">A.2</span></a>.
Until now, we have established an upper bound on the cumulative error at the network’s output due to compression of weight matrices across multiple layers. It is important to note that the nonlinearities characterized by the Lipschitz constant
<math alttext="L_{\phi}" class="ltx_Math" display="inline" id="S5.SS3.p1.1.m1.1"><semantics id="S5.SS3.p1.1.m1.1a"><msub id="S5.SS3.p1.1.m1.1.1" xref="S5.SS3.p1.1.m1.1.1.cmml"><mi id="S5.SS3.p1.1.m1.1.1.2" xref="S5.SS3.p1.1.m1.1.1.2.cmml">L</mi><mi id="S5.SS3.p1.1.m1.1.1.3" xref="S5.SS3.p1.1.m1.1.1.3.cmml">ϕ</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.1.m1.1b"><apply id="S5.SS3.p1.1.m1.1.1.cmml" xref="S5.SS3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S5.SS3.p1.1.m1.1.1.1.cmml" xref="S5.SS3.p1.1.m1.1.1">subscript</csymbol><ci id="S5.SS3.p1.1.m1.1.1.2.cmml" xref="S5.SS3.p1.1.m1.1.1.2">𝐿</ci><ci id="S5.SS3.p1.1.m1.1.1.3.cmml" xref="S5.SS3.p1.1.m1.1.1.3">italic-ϕ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.1.m1.1c">L_{\phi}</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p1.1.m1.1d">italic_L start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT</annotation></semantics></math> represent a simplification.
In practice, transformer models like LLaMA incorporate complex nonlinear components, so the exact error propagation may deviate from this simplified bound due to intricate nonlinearities.
Despite these complexities, the theorem still offers insights into how compression errors may accumulate in deep networks.
Specifically, it reveals that errors introduced in earlier (shallower) layers are amplified more significantly than those in deeper layers because they pass through more subsequent transformations and nonlinearities.</p>
</div>
<div class="ltx_para" id="S5.SS3.p2">
<p class="ltx_p" id="S5.SS3.p2.1">This understanding supports our design of a progressive compression strategy, where we compress shallow layers less aggressively than deeper ones. By preserving more information in the early layers (i.e., retaining more singular values), we minimize the initial errors that could be significantly amplified throughout the network. This approach helps maintain overall model performance while still achieving substantial compression in deeper layers, where the impact on the final output is less pronounced due to reduced error amplification.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S6">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Experiment</h2>
<section class="ltx_subsection" id="S6.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.1 </span>Models</h3>
<div class="ltx_para" id="S6.SS1.p1">
<p class="ltx_p" id="S6.SS1.p1.1">We conduct experiments using two attention mechanisms, Multi-Head Attention (MHA) <cite class="ltx_cite ltx_citemacro_citep">(Vaswani et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03111v1#bib.bib25" title="">2017</a>)</cite> and Graph Query Attention (GQA) <cite class="ltx_cite ltx_citemacro_citep">(Ainslie et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03111v1#bib.bib2" title="">2023</a>)</cite>, across three models: LLaMA-2-13B, LLaMA-3-Instruct-8B, and LLaMA-3-Instruct-70B. The LLaMA-2 family incorporates the MHA mechanism, while the LLaMA-3 family is based on the GQA framework. We list the model specifications in Table  <a class="ltx_ref" href="https://arxiv.org/html/2410.03111v1#A4.T3" title="Table 3 ‣ Appendix D Computational details ‣ LoRC: Low-Rank Compression for LLMs KV Cache with a Progressive Compression Strategy"><span class="ltx_text ltx_ref_tag">3</span></a>. Note that for the models based on MHA, the number of KV heads is equal to the number of attention heads, so the weight matrices of KV are square matrices. The models based on GQA use an intermediate number of key-value heads to group the query heads, with an adjustment on the shape of KV weight matrices.</p>
</div>
</section>
<section class="ltx_subsection" id="S6.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.2 </span>Implementation Details</h3>
<div class="ltx_para" id="S6.SS2.p1">
<p class="ltx_p" id="S6.SS2.p1.2">In practice, we set thresholds to exclude compression on layers with high cumulative condition numbers: 30 for LLaMA-3-Instruct-8B, and 90 for LLaMA-2-13B and LLaMA-3-Instruct-70B. The <math alttext="d_{max}" class="ltx_Math" display="inline" id="S6.SS2.p1.1.m1.1"><semantics id="S6.SS2.p1.1.m1.1a"><msub id="S6.SS2.p1.1.m1.1.1" xref="S6.SS2.p1.1.m1.1.1.cmml"><mi id="S6.SS2.p1.1.m1.1.1.2" xref="S6.SS2.p1.1.m1.1.1.2.cmml">d</mi><mrow id="S6.SS2.p1.1.m1.1.1.3" xref="S6.SS2.p1.1.m1.1.1.3.cmml"><mi id="S6.SS2.p1.1.m1.1.1.3.2" xref="S6.SS2.p1.1.m1.1.1.3.2.cmml">m</mi><mo id="S6.SS2.p1.1.m1.1.1.3.1" xref="S6.SS2.p1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S6.SS2.p1.1.m1.1.1.3.3" xref="S6.SS2.p1.1.m1.1.1.3.3.cmml">a</mi><mo id="S6.SS2.p1.1.m1.1.1.3.1a" xref="S6.SS2.p1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S6.SS2.p1.1.m1.1.1.3.4" xref="S6.SS2.p1.1.m1.1.1.3.4.cmml">x</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S6.SS2.p1.1.m1.1b"><apply id="S6.SS2.p1.1.m1.1.1.cmml" xref="S6.SS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S6.SS2.p1.1.m1.1.1.1.cmml" xref="S6.SS2.p1.1.m1.1.1">subscript</csymbol><ci id="S6.SS2.p1.1.m1.1.1.2.cmml" xref="S6.SS2.p1.1.m1.1.1.2">𝑑</ci><apply id="S6.SS2.p1.1.m1.1.1.3.cmml" xref="S6.SS2.p1.1.m1.1.1.3"><times id="S6.SS2.p1.1.m1.1.1.3.1.cmml" xref="S6.SS2.p1.1.m1.1.1.3.1"></times><ci id="S6.SS2.p1.1.m1.1.1.3.2.cmml" xref="S6.SS2.p1.1.m1.1.1.3.2">𝑚</ci><ci id="S6.SS2.p1.1.m1.1.1.3.3.cmml" xref="S6.SS2.p1.1.m1.1.1.3.3">𝑎</ci><ci id="S6.SS2.p1.1.m1.1.1.3.4.cmml" xref="S6.SS2.p1.1.m1.1.1.3.4">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.p1.1.m1.1c">d_{max}</annotation><annotation encoding="application/x-llamapun" id="S6.SS2.p1.1.m1.1d">italic_d start_POSTSUBSCRIPT italic_m italic_a italic_x end_POSTSUBSCRIPT</annotation></semantics></math> equals to the original head dimension, while <math alttext="d_{min}" class="ltx_Math" display="inline" id="S6.SS2.p1.2.m2.1"><semantics id="S6.SS2.p1.2.m2.1a"><msub id="S6.SS2.p1.2.m2.1.1" xref="S6.SS2.p1.2.m2.1.1.cmml"><mi id="S6.SS2.p1.2.m2.1.1.2" xref="S6.SS2.p1.2.m2.1.1.2.cmml">d</mi><mrow id="S6.SS2.p1.2.m2.1.1.3" xref="S6.SS2.p1.2.m2.1.1.3.cmml"><mi id="S6.SS2.p1.2.m2.1.1.3.2" xref="S6.SS2.p1.2.m2.1.1.3.2.cmml">m</mi><mo id="S6.SS2.p1.2.m2.1.1.3.1" xref="S6.SS2.p1.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S6.SS2.p1.2.m2.1.1.3.3" xref="S6.SS2.p1.2.m2.1.1.3.3.cmml">i</mi><mo id="S6.SS2.p1.2.m2.1.1.3.1a" xref="S6.SS2.p1.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S6.SS2.p1.2.m2.1.1.3.4" xref="S6.SS2.p1.2.m2.1.1.3.4.cmml">n</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S6.SS2.p1.2.m2.1b"><apply id="S6.SS2.p1.2.m2.1.1.cmml" xref="S6.SS2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S6.SS2.p1.2.m2.1.1.1.cmml" xref="S6.SS2.p1.2.m2.1.1">subscript</csymbol><ci id="S6.SS2.p1.2.m2.1.1.2.cmml" xref="S6.SS2.p1.2.m2.1.1.2">𝑑</ci><apply id="S6.SS2.p1.2.m2.1.1.3.cmml" xref="S6.SS2.p1.2.m2.1.1.3"><times id="S6.SS2.p1.2.m2.1.1.3.1.cmml" xref="S6.SS2.p1.2.m2.1.1.3.1"></times><ci id="S6.SS2.p1.2.m2.1.1.3.2.cmml" xref="S6.SS2.p1.2.m2.1.1.3.2">𝑚</ci><ci id="S6.SS2.p1.2.m2.1.1.3.3.cmml" xref="S6.SS2.p1.2.m2.1.1.3.3">𝑖</ci><ci id="S6.SS2.p1.2.m2.1.1.3.4.cmml" xref="S6.SS2.p1.2.m2.1.1.3.4">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.p1.2.m2.1c">d_{min}</annotation><annotation encoding="application/x-llamapun" id="S6.SS2.p1.2.m2.1d">italic_d start_POSTSUBSCRIPT italic_m italic_i italic_n end_POSTSUBSCRIPT</annotation></semantics></math> varies based on the target compression ratio. For baseline methods, we have the same refrained layers while applying the uniform compression ratios across compressed layers instead of using a progressive compression strategy.</p>
</div>
</section>
<section class="ltx_subsection" id="S6.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.3 </span>Dataset</h3>
<div class="ltx_para" id="S6.SS3.p1">
<p class="ltx_p" id="S6.SS3.p1.1">We follow <cite class="ltx_cite ltx_citemacro_cite">Touvron et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03111v1#bib.bib24" title="">2023</a>)</cite> to evaluate our methods on the following tasks:
<span class="ltx_text ltx_font_bold" id="S6.SS3.p1.1.1">BoolQ</span> <cite class="ltx_cite ltx_citemacro_citep">(Clark et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03111v1#bib.bib4" title="">2019</a>)</cite> for reading comprehension, <span class="ltx_text ltx_font_bold" id="S6.SS3.p1.1.2">XSum</span> <cite class="ltx_cite ltx_citemacro_citep">(Narayan et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03111v1#bib.bib16" title="">2018</a>)</cite> for text summarization. <span class="ltx_text ltx_font_bold" id="S6.SS3.p1.1.3">Openbook QA</span> <cite class="ltx_cite ltx_citemacro_citep">(Mihaylov et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03111v1#bib.bib14" title="">2018</a>)</cite> for commonsense reasoning, and <span class="ltx_text ltx_font_bold" id="S6.SS3.p1.1.4">GSM8K</span> <cite class="ltx_cite ltx_citemacro_citep">(Cobbe et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03111v1#bib.bib5" title="">2021</a>)</cite> for mathematical reasoning.
We use ROUGE score <cite class="ltx_cite ltx_citemacro_citep">(Lin, <a class="ltx_ref" href="https://arxiv.org/html/2410.03111v1#bib.bib11" title="">2004</a>)</cite> as the evaluation metric for XSum and accuracy for the other tasks.
We report 2-shot results for LLaMA-2 models on BoolQ, and 0-shot results for other settings.</p>
</div>
</section>
<section class="ltx_subsection" id="S6.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.4 </span>Main Results</h3>
<figure class="ltx_figure" id="S6.F2">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S6.F2.1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="207" id="S6.F2.1.g1" src="x1.png" width="830"/>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S6.F2.2"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="207" id="S6.F2.2.g1" src="x2.png" width="830"/>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S6.F2.5.1.1" style="font-size:90%;">Figure 2</span>: </span><span class="ltx_text" id="S6.F2.6.2" style="font-size:90%;">Performance of KV cache compression on LLaMA models. <span class="ltx_text ltx_font_smallcaps" id="S6.F2.6.2.1">LoRC</span> compresses the KV weights with a progressive strategy, while the baselines compress each layer with the same ratio. The horizontal dashed line indicates the performance with a full-cache model.</span></figcaption>
</figure>
<div class="ltx_para" id="S6.SS4.p1">
<p class="ltx_p" id="S6.SS4.p1.1">Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03111v1#S6.F2" title="Figure 2 ‣ 6.4 Main Results ‣ 6 Experiment ‣ LoRC: Low-Rank Compression for LLMs KV Cache with a Progressive Compression Strategy"><span class="ltx_text ltx_ref_tag">2</span></a> presents our main results on four datasets with different KV cache budgets. Compared to the full-cache model, <span class="ltx_text ltx_font_smallcaps" id="S6.SS4.p1.1.1">LoRC</span> achieves on-par performance with a significant compression ratio, and the performance degradation is still nearly negligible with a <math alttext="60\%" class="ltx_Math" display="inline" id="S6.SS4.p1.1.m1.1"><semantics id="S6.SS4.p1.1.m1.1a"><mrow id="S6.SS4.p1.1.m1.1.1" xref="S6.SS4.p1.1.m1.1.1.cmml"><mn id="S6.SS4.p1.1.m1.1.1.2" xref="S6.SS4.p1.1.m1.1.1.2.cmml">60</mn><mo id="S6.SS4.p1.1.m1.1.1.1" xref="S6.SS4.p1.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S6.SS4.p1.1.m1.1b"><apply id="S6.SS4.p1.1.m1.1.1.cmml" xref="S6.SS4.p1.1.m1.1.1"><csymbol cd="latexml" id="S6.SS4.p1.1.m1.1.1.1.cmml" xref="S6.SS4.p1.1.m1.1.1.1">percent</csymbol><cn id="S6.SS4.p1.1.m1.1.1.2.cmml" type="integer" xref="S6.SS4.p1.1.m1.1.1.2">60</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS4.p1.1.m1.1c">60\%</annotation><annotation encoding="application/x-llamapun" id="S6.SS4.p1.1.m1.1d">60 %</annotation></semantics></math> compression ratio on most datasets. When slightly compressed, <span class="ltx_text ltx_font_smallcaps" id="S6.SS4.p1.1.2">LoRC</span> could even enhance model performance in some cases. Note that our method requires no model training or model profiling, the only efforts are SVD on weight matrices which requires minimal computational cost compared to the LLM inference. Such plug-and-play merits make our method easily integrable in resource-constrained environments, enabling efficient model deployment with limited KV cache budgets.</p>
</div>
<div class="ltx_para" id="S6.SS4.p2">
<p class="ltx_p" id="S6.SS4.p2.1">In Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03111v1#S6.F2" title="Figure 2 ‣ 6.4 Main Results ‣ 6 Experiment ‣ LoRC: Low-Rank Compression for LLMs KV Cache with a Progressive Compression Strategy"><span class="ltx_text ltx_ref_tag">2</span></a>, one interesting observation is that in some cases the model with a compressed KV cache leads to better performance.
Particularly, on the GSM8K dataset, performing KV cache compression leads to more than 10% performance improvement.
This phenomenon aligns with findings reported in the literature <cite class="ltx_cite ltx_citemacro_citep">(Ge et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03111v1#bib.bib7" title="">2023</a>)</cite>.
Also, similar effects have been documented in the context of improving reasoning by applying low-rank decomposition on the MLP layers <cite class="ltx_cite ltx_citemacro_citep">(Sharma et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03111v1#bib.bib19" title="">2023</a>)</cite>.
We believe this phenomenon demonstrates the feasibility of conducting task-specific profiling for better performance, or adapting our proposed method in model finetuning.</p>
</div>
</section>
<section class="ltx_subsection" id="S6.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.5 </span>Single Layer Profiling</h3>
<figure class="ltx_figure ltx_align_floatleft" id="S6.F3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="304" id="S6.F3.g1" src="x3.png" width="913"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S6.F3.2.1.1" style="font-size:90%;">Figure 3</span>: </span><span class="ltx_text" id="S6.F3.3.2" style="font-size:90%;">Single-layer compression results. This experiment uses LLaMA-3-Instruct-8B on the OpenBookQA dataset.</span></figcaption>
</figure>
<div class="ltx_para" id="S6.SS5.p1">
<p class="ltx_p" id="S6.SS5.p1.1">To investigate the impact of compression at different layers, we conduct experiments on single-layer compression as shown in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.03111v1#S6.F3" title="Figure 3 ‣ 6.5 Single Layer Profiling ‣ 6 Experiment ‣ LoRC: Low-Rank Compression for LLMs KV Cache with a Progressive Compression Strategy"><span class="ltx_text ltx_ref_tag">3</span></a>. We use LLaMA-3-Instruct-8B on OpenBook QA for this experiment. The original dimension of the KV head is 1024, and we select compression dimensions from <math alttext="[256,384,512]" class="ltx_Math" display="inline" id="S6.SS5.p1.1.m1.3"><semantics id="S6.SS5.p1.1.m1.3a"><mrow id="S6.SS5.p1.1.m1.3.4.2" xref="S6.SS5.p1.1.m1.3.4.1.cmml"><mo id="S6.SS5.p1.1.m1.3.4.2.1" stretchy="false" xref="S6.SS5.p1.1.m1.3.4.1.cmml">[</mo><mn id="S6.SS5.p1.1.m1.1.1" xref="S6.SS5.p1.1.m1.1.1.cmml">256</mn><mo id="S6.SS5.p1.1.m1.3.4.2.2" xref="S6.SS5.p1.1.m1.3.4.1.cmml">,</mo><mn id="S6.SS5.p1.1.m1.2.2" xref="S6.SS5.p1.1.m1.2.2.cmml">384</mn><mo id="S6.SS5.p1.1.m1.3.4.2.3" xref="S6.SS5.p1.1.m1.3.4.1.cmml">,</mo><mn id="S6.SS5.p1.1.m1.3.3" xref="S6.SS5.p1.1.m1.3.3.cmml">512</mn><mo id="S6.SS5.p1.1.m1.3.4.2.4" stretchy="false" xref="S6.SS5.p1.1.m1.3.4.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S6.SS5.p1.1.m1.3b"><list id="S6.SS5.p1.1.m1.3.4.1.cmml" xref="S6.SS5.p1.1.m1.3.4.2"><cn id="S6.SS5.p1.1.m1.1.1.cmml" type="integer" xref="S6.SS5.p1.1.m1.1.1">256</cn><cn id="S6.SS5.p1.1.m1.2.2.cmml" type="integer" xref="S6.SS5.p1.1.m1.2.2">384</cn><cn id="S6.SS5.p1.1.m1.3.3.cmml" type="integer" xref="S6.SS5.p1.1.m1.3.3">512</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S6.SS5.p1.1.m1.3c">[256,384,512]</annotation><annotation encoding="application/x-llamapun" id="S6.SS5.p1.1.m1.3d">[ 256 , 384 , 512 ]</annotation></semantics></math> to compress each single layer while keeping all other layers untouched.</p>
</div>
<div class="ltx_para" id="S6.SS5.p2">
<p class="ltx_p" id="S6.SS5.p2.1">Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03111v1#S6.F3" title="Figure 3 ‣ 6.5 Single Layer Profiling ‣ 6 Experiment ‣ LoRC: Low-Rank Compression for LLMs KV Cache with a Progressive Compression Strategy"><span class="ltx_text ltx_ref_tag">3</span></a> shows clear layer-specific variability, indicating that some layers are more susceptible to compression than others, particularly in the shallow layers.
It is observed that the deep layers (<span class="ltx_text ltx_font_italic" id="S6.SS5.p2.1.1">i.e.,</span> layers 15–31 of the 32-layer LLaMA-3-Instruct 8B model), despite the reduction in dimensions, maintain performance closely approaching the full KV Cache baseline. This suggests that these layers can sustain robust performance even when subjected to significant parameter reduction. This finding supports our progressive compression strategy for optimizing model efficiency without significantly compromising the model’s effectiveness.</p>
</div>
</section>
<section class="ltx_subsection" id="S6.SS6">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.6 </span>Curse of shallow layers</h3>
<figure class="ltx_table" id="S6.T1">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S6.T1.19.5.1" style="font-size:90%;">Table 1</span>: </span><span class="ltx_text" id="S6.T1.8.4" style="font-size:90%;">Performance comparison between compression on shallow layers and deep layers on OpenBookQA. For our progressive compression strategy, we report the performance at the <math alttext="60\%" class="ltx_Math" display="inline" id="S6.T1.5.1.m1.1"><semantics id="S6.T1.5.1.m1.1b"><mrow id="S6.T1.5.1.m1.1.1" xref="S6.T1.5.1.m1.1.1.cmml"><mn id="S6.T1.5.1.m1.1.1.2" xref="S6.T1.5.1.m1.1.1.2.cmml">60</mn><mo id="S6.T1.5.1.m1.1.1.1" xref="S6.T1.5.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S6.T1.5.1.m1.1c"><apply id="S6.T1.5.1.m1.1.1.cmml" xref="S6.T1.5.1.m1.1.1"><csymbol cd="latexml" id="S6.T1.5.1.m1.1.1.1.cmml" xref="S6.T1.5.1.m1.1.1.1">percent</csymbol><cn id="S6.T1.5.1.m1.1.1.2.cmml" type="integer" xref="S6.T1.5.1.m1.1.1.2">60</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T1.5.1.m1.1d">60\%</annotation><annotation encoding="application/x-llamapun" id="S6.T1.5.1.m1.1e">60 %</annotation></semantics></math> overall compression ratio. For layer-0 compression and shallow blocks compression, we use a <math alttext="50\%" class="ltx_Math" display="inline" id="S6.T1.6.2.m2.1"><semantics id="S6.T1.6.2.m2.1b"><mrow id="S6.T1.6.2.m2.1.1" xref="S6.T1.6.2.m2.1.1.cmml"><mn id="S6.T1.6.2.m2.1.1.2" xref="S6.T1.6.2.m2.1.1.2.cmml">50</mn><mo id="S6.T1.6.2.m2.1.1.1" xref="S6.T1.6.2.m2.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S6.T1.6.2.m2.1c"><apply id="S6.T1.6.2.m2.1.1.cmml" xref="S6.T1.6.2.m2.1.1"><csymbol cd="latexml" id="S6.T1.6.2.m2.1.1.1.cmml" xref="S6.T1.6.2.m2.1.1.1">percent</csymbol><cn id="S6.T1.6.2.m2.1.1.2.cmml" type="integer" xref="S6.T1.6.2.m2.1.1.2">50</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T1.6.2.m2.1d">50\%</annotation><annotation encoding="application/x-llamapun" id="S6.T1.6.2.m2.1e">50 %</annotation></semantics></math> layer compression ratio within the chosen strategy. Hence, the overall compression ratio is <math alttext="98.44\%" class="ltx_Math" display="inline" id="S6.T1.7.3.m3.1"><semantics id="S6.T1.7.3.m3.1b"><mrow id="S6.T1.7.3.m3.1.1" xref="S6.T1.7.3.m3.1.1.cmml"><mn id="S6.T1.7.3.m3.1.1.2" xref="S6.T1.7.3.m3.1.1.2.cmml">98.44</mn><mo id="S6.T1.7.3.m3.1.1.1" xref="S6.T1.7.3.m3.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S6.T1.7.3.m3.1c"><apply id="S6.T1.7.3.m3.1.1.cmml" xref="S6.T1.7.3.m3.1.1"><csymbol cd="latexml" id="S6.T1.7.3.m3.1.1.1.cmml" xref="S6.T1.7.3.m3.1.1.1">percent</csymbol><cn id="S6.T1.7.3.m3.1.1.2.cmml" type="float" xref="S6.T1.7.3.m3.1.1.2">98.44</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T1.7.3.m3.1d">98.44\%</annotation><annotation encoding="application/x-llamapun" id="S6.T1.7.3.m3.1e">98.44 %</annotation></semantics></math> for the layer-0 compression, and <math alttext="93.75\%" class="ltx_Math" display="inline" id="S6.T1.8.4.m4.1"><semantics id="S6.T1.8.4.m4.1b"><mrow id="S6.T1.8.4.m4.1.1" xref="S6.T1.8.4.m4.1.1.cmml"><mn id="S6.T1.8.4.m4.1.1.2" xref="S6.T1.8.4.m4.1.1.2.cmml">93.75</mn><mo id="S6.T1.8.4.m4.1.1.1" xref="S6.T1.8.4.m4.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S6.T1.8.4.m4.1c"><apply id="S6.T1.8.4.m4.1.1.cmml" xref="S6.T1.8.4.m4.1.1"><csymbol cd="latexml" id="S6.T1.8.4.m4.1.1.1.cmml" xref="S6.T1.8.4.m4.1.1.1">percent</csymbol><cn id="S6.T1.8.4.m4.1.1.2.cmml" type="float" xref="S6.T1.8.4.m4.1.1.2">93.75</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T1.8.4.m4.1d">93.75\%</annotation><annotation encoding="application/x-llamapun" id="S6.T1.8.4.m4.1e">93.75 %</annotation></semantics></math> for the shallow blocks compression.</span></figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S6.T1.17">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S6.T1.17.10.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S6.T1.17.10.1.1">Model</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S6.T1.17.10.1.2">Baseline</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T1.17.10.1.3">Ours</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T1.17.10.1.4">Layer 0</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T1.17.10.1.5">Shallow Blocks (1/8)</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S6.T1.11.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" id="S6.T1.11.3.4">LLaMA-2-13b</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" id="S6.T1.11.3.5">76.6</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T1.9.1.1">77.4 (<math alttext="\uparrow 0.8" class="ltx_Math" display="inline" id="S6.T1.9.1.1.m1.1"><semantics id="S6.T1.9.1.1.m1.1a"><mrow id="S6.T1.9.1.1.m1.1.1" xref="S6.T1.9.1.1.m1.1.1.cmml"><mi id="S6.T1.9.1.1.m1.1.1.2" xref="S6.T1.9.1.1.m1.1.1.2.cmml"></mi><mo id="S6.T1.9.1.1.m1.1.1.1" mathcolor="#008000" stretchy="false" xref="S6.T1.9.1.1.m1.1.1.1.cmml">↑</mo><mn id="S6.T1.9.1.1.m1.1.1.3" mathcolor="#008000" xref="S6.T1.9.1.1.m1.1.1.3.cmml">0.8</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.T1.9.1.1.m1.1b"><apply id="S6.T1.9.1.1.m1.1.1.cmml" xref="S6.T1.9.1.1.m1.1.1"><ci id="S6.T1.9.1.1.m1.1.1.1.cmml" xref="S6.T1.9.1.1.m1.1.1.1">↑</ci><csymbol cd="latexml" id="S6.T1.9.1.1.m1.1.1.2.cmml" xref="S6.T1.9.1.1.m1.1.1.2">absent</csymbol><cn id="S6.T1.9.1.1.m1.1.1.3.cmml" type="float" xref="S6.T1.9.1.1.m1.1.1.3">0.8</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T1.9.1.1.m1.1c">\uparrow 0.8</annotation><annotation encoding="application/x-llamapun" id="S6.T1.9.1.1.m1.1d">↑ 0.8</annotation></semantics></math>)</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T1.10.2.2">77.2 (<math alttext="\uparrow 0.6" class="ltx_Math" display="inline" id="S6.T1.10.2.2.m1.1"><semantics id="S6.T1.10.2.2.m1.1a"><mrow id="S6.T1.10.2.2.m1.1.1" xref="S6.T1.10.2.2.m1.1.1.cmml"><mi id="S6.T1.10.2.2.m1.1.1.2" xref="S6.T1.10.2.2.m1.1.1.2.cmml"></mi><mo id="S6.T1.10.2.2.m1.1.1.1" mathcolor="#008000" stretchy="false" xref="S6.T1.10.2.2.m1.1.1.1.cmml">↑</mo><mn id="S6.T1.10.2.2.m1.1.1.3" mathcolor="#008000" xref="S6.T1.10.2.2.m1.1.1.3.cmml">0.6</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.T1.10.2.2.m1.1b"><apply id="S6.T1.10.2.2.m1.1.1.cmml" xref="S6.T1.10.2.2.m1.1.1"><ci id="S6.T1.10.2.2.m1.1.1.1.cmml" xref="S6.T1.10.2.2.m1.1.1.1">↑</ci><csymbol cd="latexml" id="S6.T1.10.2.2.m1.1.1.2.cmml" xref="S6.T1.10.2.2.m1.1.1.2">absent</csymbol><cn id="S6.T1.10.2.2.m1.1.1.3.cmml" type="float" xref="S6.T1.10.2.2.m1.1.1.3">0.6</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T1.10.2.2.m1.1c">\uparrow 0.6</annotation><annotation encoding="application/x-llamapun" id="S6.T1.10.2.2.m1.1d">↑ 0.6</annotation></semantics></math>)</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T1.11.3.3">74.8 (<math alttext="\downarrow 1.8" class="ltx_Math" display="inline" id="S6.T1.11.3.3.m1.1"><semantics id="S6.T1.11.3.3.m1.1a"><mrow id="S6.T1.11.3.3.m1.1.1" xref="S6.T1.11.3.3.m1.1.1.cmml"><mi id="S6.T1.11.3.3.m1.1.1.2" xref="S6.T1.11.3.3.m1.1.1.2.cmml"></mi><mo id="S6.T1.11.3.3.m1.1.1.1" mathcolor="#CC0000" stretchy="false" xref="S6.T1.11.3.3.m1.1.1.1.cmml">↓</mo><mn id="S6.T1.11.3.3.m1.1.1.3" mathcolor="#CC0000" xref="S6.T1.11.3.3.m1.1.1.3.cmml">1.8</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.T1.11.3.3.m1.1b"><apply id="S6.T1.11.3.3.m1.1.1.cmml" xref="S6.T1.11.3.3.m1.1.1"><ci id="S6.T1.11.3.3.m1.1.1.1.cmml" xref="S6.T1.11.3.3.m1.1.1.1">↓</ci><csymbol cd="latexml" id="S6.T1.11.3.3.m1.1.1.2.cmml" xref="S6.T1.11.3.3.m1.1.1.2">absent</csymbol><cn id="S6.T1.11.3.3.m1.1.1.3.cmml" type="float" xref="S6.T1.11.3.3.m1.1.1.3">1.8</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T1.11.3.3.m1.1c">\downarrow 1.8</annotation><annotation encoding="application/x-llamapun" id="S6.T1.11.3.3.m1.1d">↓ 1.8</annotation></semantics></math>)</td>
</tr>
<tr class="ltx_tr" id="S6.T1.14.6">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S6.T1.14.6.4">LLaMA-3-Instruct-8b</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S6.T1.14.6.5">78.0</th>
<td class="ltx_td ltx_align_center" id="S6.T1.12.4.1">77.4 (<math alttext="\downarrow 0.6" class="ltx_Math" display="inline" id="S6.T1.12.4.1.m1.1"><semantics id="S6.T1.12.4.1.m1.1a"><mrow id="S6.T1.12.4.1.m1.1.1" xref="S6.T1.12.4.1.m1.1.1.cmml"><mi id="S6.T1.12.4.1.m1.1.1.2" xref="S6.T1.12.4.1.m1.1.1.2.cmml"></mi><mo id="S6.T1.12.4.1.m1.1.1.1" mathcolor="#CC0000" stretchy="false" xref="S6.T1.12.4.1.m1.1.1.1.cmml">↓</mo><mn id="S6.T1.12.4.1.m1.1.1.3" mathcolor="#CC0000" xref="S6.T1.12.4.1.m1.1.1.3.cmml">0.6</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.T1.12.4.1.m1.1b"><apply id="S6.T1.12.4.1.m1.1.1.cmml" xref="S6.T1.12.4.1.m1.1.1"><ci id="S6.T1.12.4.1.m1.1.1.1.cmml" xref="S6.T1.12.4.1.m1.1.1.1">↓</ci><csymbol cd="latexml" id="S6.T1.12.4.1.m1.1.1.2.cmml" xref="S6.T1.12.4.1.m1.1.1.2">absent</csymbol><cn id="S6.T1.12.4.1.m1.1.1.3.cmml" type="float" xref="S6.T1.12.4.1.m1.1.1.3">0.6</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T1.12.4.1.m1.1c">\downarrow 0.6</annotation><annotation encoding="application/x-llamapun" id="S6.T1.12.4.1.m1.1d">↓ 0.6</annotation></semantics></math>)</td>
<td class="ltx_td ltx_align_center" id="S6.T1.13.5.2">67.2 (<math alttext="\downarrow 10.8" class="ltx_Math" display="inline" id="S6.T1.13.5.2.m1.1"><semantics id="S6.T1.13.5.2.m1.1a"><mrow id="S6.T1.13.5.2.m1.1.1" xref="S6.T1.13.5.2.m1.1.1.cmml"><mi id="S6.T1.13.5.2.m1.1.1.2" xref="S6.T1.13.5.2.m1.1.1.2.cmml"></mi><mo id="S6.T1.13.5.2.m1.1.1.1" mathcolor="#CC0000" stretchy="false" xref="S6.T1.13.5.2.m1.1.1.1.cmml">↓</mo><mn id="S6.T1.13.5.2.m1.1.1.3" mathcolor="#CC0000" xref="S6.T1.13.5.2.m1.1.1.3.cmml">10.8</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.T1.13.5.2.m1.1b"><apply id="S6.T1.13.5.2.m1.1.1.cmml" xref="S6.T1.13.5.2.m1.1.1"><ci id="S6.T1.13.5.2.m1.1.1.1.cmml" xref="S6.T1.13.5.2.m1.1.1.1">↓</ci><csymbol cd="latexml" id="S6.T1.13.5.2.m1.1.1.2.cmml" xref="S6.T1.13.5.2.m1.1.1.2">absent</csymbol><cn id="S6.T1.13.5.2.m1.1.1.3.cmml" type="float" xref="S6.T1.13.5.2.m1.1.1.3">10.8</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T1.13.5.2.m1.1c">\downarrow 10.8</annotation><annotation encoding="application/x-llamapun" id="S6.T1.13.5.2.m1.1d">↓ 10.8</annotation></semantics></math>)</td>
<td class="ltx_td ltx_align_center" id="S6.T1.14.6.3">61.4 (<math alttext="\downarrow 16.6" class="ltx_Math" display="inline" id="S6.T1.14.6.3.m1.1"><semantics id="S6.T1.14.6.3.m1.1a"><mrow id="S6.T1.14.6.3.m1.1.1" xref="S6.T1.14.6.3.m1.1.1.cmml"><mi id="S6.T1.14.6.3.m1.1.1.2" xref="S6.T1.14.6.3.m1.1.1.2.cmml"></mi><mo id="S6.T1.14.6.3.m1.1.1.1" mathcolor="#CC0000" stretchy="false" xref="S6.T1.14.6.3.m1.1.1.1.cmml">↓</mo><mn id="S6.T1.14.6.3.m1.1.1.3" mathcolor="#CC0000" xref="S6.T1.14.6.3.m1.1.1.3.cmml">16.6</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.T1.14.6.3.m1.1b"><apply id="S6.T1.14.6.3.m1.1.1.cmml" xref="S6.T1.14.6.3.m1.1.1"><ci id="S6.T1.14.6.3.m1.1.1.1.cmml" xref="S6.T1.14.6.3.m1.1.1.1">↓</ci><csymbol cd="latexml" id="S6.T1.14.6.3.m1.1.1.2.cmml" xref="S6.T1.14.6.3.m1.1.1.2">absent</csymbol><cn id="S6.T1.14.6.3.m1.1.1.3.cmml" type="float" xref="S6.T1.14.6.3.m1.1.1.3">16.6</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T1.14.6.3.m1.1c">\downarrow 16.6</annotation><annotation encoding="application/x-llamapun" id="S6.T1.14.6.3.m1.1d">↓ 16.6</annotation></semantics></math>)</td>
</tr>
<tr class="ltx_tr" id="S6.T1.17.9">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb" id="S6.T1.17.9.4">LLaMA-3-Instruct-70b</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb" id="S6.T1.17.9.5">91.2</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T1.15.7.1">91.2 (<math alttext="\uparrow 0.0" class="ltx_Math" display="inline" id="S6.T1.15.7.1.m1.1"><semantics id="S6.T1.15.7.1.m1.1a"><mrow id="S6.T1.15.7.1.m1.1.1" xref="S6.T1.15.7.1.m1.1.1.cmml"><mi id="S6.T1.15.7.1.m1.1.1.2" xref="S6.T1.15.7.1.m1.1.1.2.cmml"></mi><mo id="S6.T1.15.7.1.m1.1.1.1" mathcolor="#008000" stretchy="false" xref="S6.T1.15.7.1.m1.1.1.1.cmml">↑</mo><mn id="S6.T1.15.7.1.m1.1.1.3" mathcolor="#008000" xref="S6.T1.15.7.1.m1.1.1.3.cmml">0.0</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.T1.15.7.1.m1.1b"><apply id="S6.T1.15.7.1.m1.1.1.cmml" xref="S6.T1.15.7.1.m1.1.1"><ci id="S6.T1.15.7.1.m1.1.1.1.cmml" xref="S6.T1.15.7.1.m1.1.1.1">↑</ci><csymbol cd="latexml" id="S6.T1.15.7.1.m1.1.1.2.cmml" xref="S6.T1.15.7.1.m1.1.1.2">absent</csymbol><cn id="S6.T1.15.7.1.m1.1.1.3.cmml" type="float" xref="S6.T1.15.7.1.m1.1.1.3">0.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T1.15.7.1.m1.1c">\uparrow 0.0</annotation><annotation encoding="application/x-llamapun" id="S6.T1.15.7.1.m1.1d">↑ 0.0</annotation></semantics></math>)</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T1.16.8.2">84.2 (<math alttext="\downarrow 7.0" class="ltx_Math" display="inline" id="S6.T1.16.8.2.m1.1"><semantics id="S6.T1.16.8.2.m1.1a"><mrow id="S6.T1.16.8.2.m1.1.1" xref="S6.T1.16.8.2.m1.1.1.cmml"><mi id="S6.T1.16.8.2.m1.1.1.2" xref="S6.T1.16.8.2.m1.1.1.2.cmml"></mi><mo id="S6.T1.16.8.2.m1.1.1.1" mathcolor="#CC0000" stretchy="false" xref="S6.T1.16.8.2.m1.1.1.1.cmml">↓</mo><mn id="S6.T1.16.8.2.m1.1.1.3" mathcolor="#CC0000" xref="S6.T1.16.8.2.m1.1.1.3.cmml">7.0</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.T1.16.8.2.m1.1b"><apply id="S6.T1.16.8.2.m1.1.1.cmml" xref="S6.T1.16.8.2.m1.1.1"><ci id="S6.T1.16.8.2.m1.1.1.1.cmml" xref="S6.T1.16.8.2.m1.1.1.1">↓</ci><csymbol cd="latexml" id="S6.T1.16.8.2.m1.1.1.2.cmml" xref="S6.T1.16.8.2.m1.1.1.2">absent</csymbol><cn id="S6.T1.16.8.2.m1.1.1.3.cmml" type="float" xref="S6.T1.16.8.2.m1.1.1.3">7.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T1.16.8.2.m1.1c">\downarrow 7.0</annotation><annotation encoding="application/x-llamapun" id="S6.T1.16.8.2.m1.1d">↓ 7.0</annotation></semantics></math>)</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T1.17.9.3">23.2 (<math alttext="\downarrow 68.0" class="ltx_Math" display="inline" id="S6.T1.17.9.3.m1.1"><semantics id="S6.T1.17.9.3.m1.1a"><mrow id="S6.T1.17.9.3.m1.1.1" xref="S6.T1.17.9.3.m1.1.1.cmml"><mi id="S6.T1.17.9.3.m1.1.1.2" xref="S6.T1.17.9.3.m1.1.1.2.cmml"></mi><mo id="S6.T1.17.9.3.m1.1.1.1" mathcolor="#CC0000" stretchy="false" xref="S6.T1.17.9.3.m1.1.1.1.cmml">↓</mo><mn id="S6.T1.17.9.3.m1.1.1.3" mathcolor="#CC0000" xref="S6.T1.17.9.3.m1.1.1.3.cmml">68.0</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.T1.17.9.3.m1.1b"><apply id="S6.T1.17.9.3.m1.1.1.cmml" xref="S6.T1.17.9.3.m1.1.1"><ci id="S6.T1.17.9.3.m1.1.1.1.cmml" xref="S6.T1.17.9.3.m1.1.1.1">↓</ci><csymbol cd="latexml" id="S6.T1.17.9.3.m1.1.1.2.cmml" xref="S6.T1.17.9.3.m1.1.1.2">absent</csymbol><cn id="S6.T1.17.9.3.m1.1.1.3.cmml" type="float" xref="S6.T1.17.9.3.m1.1.1.3">68.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T1.17.9.3.m1.1c">\downarrow 68.0</annotation><annotation encoding="application/x-llamapun" id="S6.T1.17.9.3.m1.1d">↓ 68.0</annotation></semantics></math>)</td>
</tr>
</tbody>
</table>
</figure>
<div class="ltx_para" id="S6.SS6.p1">
<p class="ltx_p" id="S6.SS6.p1.1">To validate the intuition of the progressive compression strategy that the noise caused by shallow compressed layers will be amplified more after propagation, we compare it to compressing the first layer and the shallow blocks (i.e., the first 1/8 layers in a model) on 3 LLaMA models.</p>
</div>
<div class="ltx_para" id="S6.SS6.p2">
<p class="ltx_p" id="S6.SS6.p2.4">Table <a class="ltx_ref" href="https://arxiv.org/html/2410.03111v1#S6.T1" title="Table 1 ‣ 6.6 Curse of shallow layers ‣ 6 Experiment ‣ LoRC: Low-Rank Compression for LLMs KV Cache with a Progressive Compression Strategy"><span class="ltx_text ltx_ref_tag">1</span></a> shows how the compressed shallow layers impact the model performance, taking the baseline full-cache model and our method as reference. The results indicate that compressing only the first layer can lead to a performance decline, with reductions ranging from minimal to moderate. For instance, the LLaMA-3-70B gives a <math alttext="7.0\%" class="ltx_Math" display="inline" id="S6.SS6.p2.1.m1.1"><semantics id="S6.SS6.p2.1.m1.1a"><mrow id="S6.SS6.p2.1.m1.1.1" xref="S6.SS6.p2.1.m1.1.1.cmml"><mn id="S6.SS6.p2.1.m1.1.1.2" xref="S6.SS6.p2.1.m1.1.1.2.cmml">7.0</mn><mo id="S6.SS6.p2.1.m1.1.1.1" xref="S6.SS6.p2.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S6.SS6.p2.1.m1.1b"><apply id="S6.SS6.p2.1.m1.1.1.cmml" xref="S6.SS6.p2.1.m1.1.1"><csymbol cd="latexml" id="S6.SS6.p2.1.m1.1.1.1.cmml" xref="S6.SS6.p2.1.m1.1.1.1">percent</csymbol><cn id="S6.SS6.p2.1.m1.1.1.2.cmml" type="float" xref="S6.SS6.p2.1.m1.1.1.2">7.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS6.p2.1.m1.1c">7.0\%</annotation><annotation encoding="application/x-llamapun" id="S6.SS6.p2.1.m1.1d">7.0 %</annotation></semantics></math> decrease, while the LLaMA-3-Instruct-8b shows a more substantial drop of <math alttext="10.8\%" class="ltx_Math" display="inline" id="S6.SS6.p2.2.m2.1"><semantics id="S6.SS6.p2.2.m2.1a"><mrow id="S6.SS6.p2.2.m2.1.1" xref="S6.SS6.p2.2.m2.1.1.cmml"><mn id="S6.SS6.p2.2.m2.1.1.2" xref="S6.SS6.p2.2.m2.1.1.2.cmml">10.8</mn><mo id="S6.SS6.p2.2.m2.1.1.1" xref="S6.SS6.p2.2.m2.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S6.SS6.p2.2.m2.1b"><apply id="S6.SS6.p2.2.m2.1.1.cmml" xref="S6.SS6.p2.2.m2.1.1"><csymbol cd="latexml" id="S6.SS6.p2.2.m2.1.1.1.cmml" xref="S6.SS6.p2.2.m2.1.1.1">percent</csymbol><cn id="S6.SS6.p2.2.m2.1.1.2.cmml" type="float" xref="S6.SS6.p2.2.m2.1.1.2">10.8</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS6.p2.2.m2.1c">10.8\%</annotation><annotation encoding="application/x-llamapun" id="S6.SS6.p2.2.m2.1d">10.8 %</annotation></semantics></math>.
When compressing the shallow blocks, the impact is more pronounced. The LLaMA-3-Instruct-8B suffers a <math alttext="16.6\%" class="ltx_Math" display="inline" id="S6.SS6.p2.3.m3.1"><semantics id="S6.SS6.p2.3.m3.1a"><mrow id="S6.SS6.p2.3.m3.1.1" xref="S6.SS6.p2.3.m3.1.1.cmml"><mn id="S6.SS6.p2.3.m3.1.1.2" xref="S6.SS6.p2.3.m3.1.1.2.cmml">16.6</mn><mo id="S6.SS6.p2.3.m3.1.1.1" xref="S6.SS6.p2.3.m3.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S6.SS6.p2.3.m3.1b"><apply id="S6.SS6.p2.3.m3.1.1.cmml" xref="S6.SS6.p2.3.m3.1.1"><csymbol cd="latexml" id="S6.SS6.p2.3.m3.1.1.1.cmml" xref="S6.SS6.p2.3.m3.1.1.1">percent</csymbol><cn id="S6.SS6.p2.3.m3.1.1.2.cmml" type="float" xref="S6.SS6.p2.3.m3.1.1.2">16.6</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS6.p2.3.m3.1c">16.6\%</annotation><annotation encoding="application/x-llamapun" id="S6.SS6.p2.3.m3.1d">16.6 %</annotation></semantics></math> reduction. Notably, the LLaMA-3-Instruct-70b model shows a drastic <math alttext="68.0\%" class="ltx_Math" display="inline" id="S6.SS6.p2.4.m4.1"><semantics id="S6.SS6.p2.4.m4.1a"><mrow id="S6.SS6.p2.4.m4.1.1" xref="S6.SS6.p2.4.m4.1.1.cmml"><mn id="S6.SS6.p2.4.m4.1.1.2" xref="S6.SS6.p2.4.m4.1.1.2.cmml">68.0</mn><mo id="S6.SS6.p2.4.m4.1.1.1" xref="S6.SS6.p2.4.m4.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S6.SS6.p2.4.m4.1b"><apply id="S6.SS6.p2.4.m4.1.1.cmml" xref="S6.SS6.p2.4.m4.1.1"><csymbol cd="latexml" id="S6.SS6.p2.4.m4.1.1.1.cmml" xref="S6.SS6.p2.4.m4.1.1.1">percent</csymbol><cn id="S6.SS6.p2.4.m4.1.1.2.cmml" type="float" xref="S6.SS6.p2.4.m4.1.1.2">68.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS6.p2.4.m4.1c">68.0\%</annotation><annotation encoding="application/x-llamapun" id="S6.SS6.p2.4.m4.1d">68.0 %</annotation></semantics></math> decline, highlighting a significant sensitivity to shallow layer compression.</p>
</div>
<div class="ltx_para" id="S6.SS6.p3">
<p class="ltx_p" id="S6.SS6.p3.1">These findings underscore the importance of careful layer selection in compression strategies and validate the effectiveness of our progressive compression method, as the choice of layer to compress can have a substantial impact on model performance, particularly in larger or more complex models.</p>
</div>
</section>
<section class="ltx_subsection" id="S6.SS7">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.7 </span>Memory footprint reduction analysis</h3>
<figure class="ltx_table" id="S6.T2">
<figcaption class="ltx_caption ltx_centering" style="font-size:90%;"><span class="ltx_tag ltx_tag_table">Table 2: </span>Summary of Model Sizes, KV cache usage and performance drop. Experiments were conducted with a batch size of 64 and a sequence length of 2048 for all models.</figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S6.T2.4" style="width:433.6pt;height:95.6pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(12.8pt,-2.8pt) scale(1.06253187711166,1.06253187711166) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S6.T2.4.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S6.T2.4.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T2.4.1.1.1.1"><span class="ltx_text" id="S6.T2.4.1.1.1.1.1" style="font-size:90%;">Model</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="5" id="S6.T2.4.1.1.1.2"><span class="ltx_text" id="S6.T2.4.1.1.1.2.1" style="font-size:90%;">KV Cache</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T2.4.1.1.1.3"><span class="ltx_text" id="S6.T2.4.1.1.1.3.1" style="font-size:90%;">Average Performance Drop</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S6.T2.4.1.2.1">
<td class="ltx_td" id="S6.T2.4.1.2.1.1"></td>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S6.T2.4.1.2.1.2"><span class="ltx_text" id="S6.T2.4.1.2.1.2.1" style="font-size:90%;">Full</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S6.T2.4.1.2.1.3"><span class="ltx_text" id="S6.T2.4.1.2.1.3.1" style="font-size:90%;">dim</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S6.T2.4.1.2.1.4"><span class="ltx_text" id="S6.T2.4.1.2.1.4.1" style="font-size:90%;">dim_c</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S6.T2.4.1.2.1.5"><span class="ltx_text" id="S6.T2.4.1.2.1.5.1" style="font-size:90%;">Ours</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S6.T2.4.1.2.1.6"><span class="ltx_text" id="S6.T2.4.1.2.1.6.1" style="font-size:90%;">Compression Ratio</span></th>
<td class="ltx_td" id="S6.T2.4.1.2.1.7"></td>
</tr>
<tr class="ltx_tr" id="S6.T2.4.1.3.2">
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T2.4.1.3.2.1"><span class="ltx_text ltx_font_bold" id="S6.T2.4.1.3.2.1.1" style="font-size:90%;">LLaMA-2-13B</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T2.4.1.3.2.2"><span class="ltx_text" id="S6.T2.4.1.3.2.2.1" style="font-size:90%;">50G</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T2.4.1.3.2.3"><span class="ltx_text" id="S6.T2.4.1.3.2.3.1" style="font-size:90%;">5120</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T2.4.1.3.2.4"><span class="ltx_text" id="S6.T2.4.1.3.2.4.1" style="font-size:90%;">2048</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T2.4.1.3.2.5"><span class="ltx_text" id="S6.T2.4.1.3.2.5.1" style="font-size:90%;">27.5G</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T2.4.1.3.2.6"><span class="ltx_text" id="S6.T2.4.1.3.2.6.1" style="font-size:90%;">55%</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T2.4.1.3.2.7"><span class="ltx_text" id="S6.T2.4.1.3.2.7.1" style="font-size:90%;">0.47%</span></td>
</tr>
<tr class="ltx_tr" id="S6.T2.4.1.4.3">
<td class="ltx_td ltx_align_center" id="S6.T2.4.1.4.3.1"><span class="ltx_text ltx_font_bold" id="S6.T2.4.1.4.3.1.1" style="font-size:90%;">LLaMA-3-8B</span></td>
<td class="ltx_td ltx_align_center" id="S6.T2.4.1.4.3.2"><span class="ltx_text" id="S6.T2.4.1.4.3.2.1" style="font-size:90%;">8G</span></td>
<td class="ltx_td ltx_align_center" id="S6.T2.4.1.4.3.3"><span class="ltx_text" id="S6.T2.4.1.4.3.3.1" style="font-size:90%;">1024</span></td>
<td class="ltx_td ltx_align_center" id="S6.T2.4.1.4.3.4"><span class="ltx_text" id="S6.T2.4.1.4.3.4.1" style="font-size:90%;">512</span></td>
<td class="ltx_td ltx_align_center" id="S6.T2.4.1.4.3.5"><span class="ltx_text" id="S6.T2.4.1.4.3.5.1" style="font-size:90%;">4.8G</span></td>
<td class="ltx_td ltx_align_center" id="S6.T2.4.1.4.3.6"><span class="ltx_text" id="S6.T2.4.1.4.3.6.1" style="font-size:90%;">60%</span></td>
<td class="ltx_td ltx_align_center" id="S6.T2.4.1.4.3.7"><span class="ltx_text" id="S6.T2.4.1.4.3.7.1" style="font-size:90%;">0.92%</span></td>
</tr>
<tr class="ltx_tr" id="S6.T2.4.1.5.4">
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T2.4.1.5.4.1"><span class="ltx_text ltx_font_bold" id="S6.T2.4.1.5.4.1.1" style="font-size:90%;">LLaMA-3-70B</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T2.4.1.5.4.2"><span class="ltx_text" id="S6.T2.4.1.5.4.2.1" style="font-size:90%;">20G</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T2.4.1.5.4.3"><span class="ltx_text" id="S6.T2.4.1.5.4.3.1" style="font-size:90%;">1024</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T2.4.1.5.4.4"><span class="ltx_text" id="S6.T2.4.1.5.4.4.1" style="font-size:90%;">512</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T2.4.1.5.4.5"><span class="ltx_text" id="S6.T2.4.1.5.4.5.1" style="font-size:90%;">11G</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T2.4.1.5.4.6"><span class="ltx_text" id="S6.T2.4.1.5.4.6.1" style="font-size:90%;">55%</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T2.4.1.5.4.7"><span class="ltx_text" id="S6.T2.4.1.5.4.7.1" style="font-size:90%;">0.22%</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<div class="ltx_para" id="S6.SS7.p1">
<p class="ltx_p" id="S6.SS7.p1.1">We report the memory footprint reduction in Table <a class="ltx_ref" href="https://arxiv.org/html/2410.03111v1#S6.T2" title="Table 2 ‣ 6.7 Memory footprint reduction analysis ‣ 6 Experiment ‣ LoRC: Low-Rank Compression for LLMs KV Cache with a Progressive Compression Strategy"><span class="ltx_text ltx_ref_tag">2</span></a>. By controlling the performance drop averaged on the four tasks less than 1%, we can achieve a considerable compression ratio from 55%-60%. For the LLaMA-3 models in which the GQA has already been employed to save the KV cache, we further achieve a significant compression ratio. Note that we have excluded the GSM8k results for the performance drop calculation for a fair comparison.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S7">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">7 </span>Conclusions</h2>
<div class="ltx_para" id="S7.p1">
<p class="ltx_p" id="S7.p1.1">In conclusion, we proposed <span class="ltx_text ltx_font_smallcaps" id="S7.p1.1.1">LoRC</span>, a novel approach to KV cache compression that capitalizes on the inherent low-rank properties of weight matrices. Our method employs a progressive layer-wise compression strategy, implementing a post-hoc low-rank approximation to circumvent the complexities and limitations associated with token-level eviction strategies and model retraining. Moreover, we provide theoretical analysis, deriving error bounds for layer compression and error propagation in deep networks, supporting our design of progressive compression strategy.
This theoretically grounded and universally applicable approach preserves model integrity and performance across diverse tasks, attention mechanisms, and model scales.
Our comprehensive experimental results demonstrate that <span class="ltx_text ltx_font_smallcaps" id="S7.p1.1.2">LoRC</span> significantly reduces GPU memory requirements while minimally impacting performance. This approach offers a robust and efficient solution of KV cache compression, without requiring attention pattern analysis or model tuning.</p>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Achiam et al. (2023)</span>
<span class="ltx_bibblock">
Achiam, J., Adler, S., Agarwal, S., Ahmad, L., Akkaya, I., Aleman, F. L., Almeida, D., Altenschmidt, J., Altman, S., Anadkat, S., et al.

</span>
<span class="ltx_bibblock">Gpt-4 technical report.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib1.1.1">arXiv preprint arXiv:2303.08774</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ainslie et al. (2023)</span>
<span class="ltx_bibblock">
Ainslie, J., Lee-Thorp, J., de Jong, M., Zemlyanskiy, Y., Lebrón, F., and Sanghai, S.

</span>
<span class="ltx_bibblock">Gqa: Training generalized multi-query transformer models from multi-head checkpoints.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib2.1.1">arXiv preprint arXiv:2305.13245</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chowdhery et al. (2023)</span>
<span class="ltx_bibblock">
Chowdhery, A., Narang, S., Devlin, J., Bosma, M., Mishra, G., Roberts, A., Barham, P., Chung, H. W., Sutton, C., Gehrmann, S., et al.

</span>
<span class="ltx_bibblock">Palm: Scaling language modeling with pathways.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib3.1.1">Journal of Machine Learning Research</em>, 24(240):1–113, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Clark et al. (2019)</span>
<span class="ltx_bibblock">
Clark, C., Lee, K., Chang, M.-W., Kwiatkowski, T., Collins, M., and Toutanova, K.

</span>
<span class="ltx_bibblock">Boolq: Exploring the surprising difficulty of natural yes/no questions.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib4.1.1">arXiv preprint arXiv:1905.10044</em>, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cobbe et al. (2021)</span>
<span class="ltx_bibblock">
Cobbe, K., Kosaraju, V., Bavarian, M., Chen, M., Jun, H., Kaiser, L., Plappert, M., Tworek, J., Hilton, J., Nakano, R., et al.

</span>
<span class="ltx_bibblock">Training verifiers to solve math word problems.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib5.1.1">arXiv preprint arXiv:2110.14168</em>, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">de Jong et al. (2022)</span>
<span class="ltx_bibblock">
de Jong, M., Zemlyanskiy, Y., Ainslie, J., FitzGerald, N., Sanghai, S., Sha, F., and Cohen, W.

</span>
<span class="ltx_bibblock">Fido: Fusion-in-decoder optimized for stronger performance and faster inference.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib6.1.1">arXiv preprint arXiv:2212.08153</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ge et al. (2023)</span>
<span class="ltx_bibblock">
Ge, S., Zhang, Y., Liu, L., Zhang, M., Han, J., and Gao, J.

</span>
<span class="ltx_bibblock">Model tells you what to discard: Adaptive kv cache compression for llms.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib7.1.1">arXiv preprint arXiv:2310.01801</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Guan et al. (2022)</span>
<span class="ltx_bibblock">
Guan, Y., Li, Z., Leng, J., Lin, Z., and Guo, M.

</span>
<span class="ltx_bibblock">Transkimmer: Transformer learns to layer-wise skim.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib8.1.1">arXiv preprint arXiv:2205.07324</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Holmes et al. (2024)</span>
<span class="ltx_bibblock">
Holmes, C., Tanaka, M., Wyatt, M., Awan, A. A., Rasley, J., Rajbhandari, S., Aminabadi, R. Y., Qin, H., Bakhtiari, A., Kurilenko, L., et al.

</span>
<span class="ltx_bibblock">Deepspeed-fastgen: High-throughput text generation for llms via mii and deepspeed-inference.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib9.1.1">arXiv preprint arXiv:2401.08671</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Izacard &amp; Grave (2020)</span>
<span class="ltx_bibblock">
Izacard, G. and Grave, E.

</span>
<span class="ltx_bibblock">Leveraging passage retrieval with generative models for open domain question answering.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib10.1.1">arXiv preprint arXiv:2007.01282</em>, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lin (2004)</span>
<span class="ltx_bibblock">
Lin, C.-Y.

</span>
<span class="ltx_bibblock">ROUGE: A package for automatic evaluation of summaries.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib11.1.1">Text Summarization Branches Out</em>, pp.  74–81, Barcelona, Spain, July 2004. Association for Computational Linguistics.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://www.aclweb.org/anthology/W04-1013" title="">https://www.aclweb.org/anthology/W04-1013</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al. (2024a)</span>
<span class="ltx_bibblock">
Liu, A., Feng, B., Wang, B., Wang, B., Liu, B., Zhao, C., Dengr, C., Ruan, C., Dai, D., Guo, D., et al.

</span>
<span class="ltx_bibblock">Deepseek-v2: A strong, economical, and efficient mixture-of-experts language model.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib12.1.1">arXiv preprint arXiv:2405.04434</em>, 2024a.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al. (2024b)</span>
<span class="ltx_bibblock">
Liu, Z., Desai, A., Liao, F., Wang, W., Xie, V., Xu, Z., Kyrillidis, A., and Shrivastava, A.

</span>
<span class="ltx_bibblock">Scissorhands: Exploiting the persistence of importance hypothesis for llm kv cache compression at test time.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib13.1.1">Advances in Neural Information Processing Systems</em>, 36, 2024b.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mihaylov et al. (2018)</span>
<span class="ltx_bibblock">
Mihaylov, T., Clark, P., Khot, T., and Sabharwal, A.

</span>
<span class="ltx_bibblock">Can a suit of armor conduct electricity? a new dataset for open book question answering.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib14.1.1">arXiv preprint arXiv:1809.02789</em>, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mu et al. (2024)</span>
<span class="ltx_bibblock">
Mu, J., Li, X., and Goodman, N.

</span>
<span class="ltx_bibblock">Learning to compress prompts with gist tokens.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib15.1.1">Advances in Neural Information Processing Systems</em>, 36, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Narayan et al. (2018)</span>
<span class="ltx_bibblock">
Narayan, S., Cohen, S. B., and Lapata, M.

</span>
<span class="ltx_bibblock">Don’t give me the details, just the summary! topic-aware convolutional neural networks for extreme summarization.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib16.1.1">ArXiv</em>, abs/1808.08745, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Pope et al. (2023)</span>
<span class="ltx_bibblock">
Pope, R., Douglas, S., Chowdhery, A., Devlin, J., Bradbury, J., Heek, J., Xiao, K., Agrawal, S., and Dean, J.

</span>
<span class="ltx_bibblock">Efficiently scaling transformer inference.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib17.1.1">Proceedings of Machine Learning and Systems</em>, 5, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ribar et al. (2023)</span>
<span class="ltx_bibblock">
Ribar, L., Chelombiev, I., Hudlass-Galley, L., Blake, C., Luschi, C., and Orr, D.

</span>
<span class="ltx_bibblock">Sparq attention: Bandwidth-efficient llm inference.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib18.1.1">arXiv preprint arXiv:2312.04985</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sharma et al. (2023)</span>
<span class="ltx_bibblock">
Sharma, P., Ash, J. T., and Misra, D.

</span>
<span class="ltx_bibblock">The truth is in there: Improving reasoning in language models with layer-selective rank reduction.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib19.1.1">ArXiv</em>, abs/2312.13558, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shazeer (2019)</span>
<span class="ltx_bibblock">
Shazeer, N.

</span>
<span class="ltx_bibblock">Fast transformer decoding: One write-head is all you need.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib20.1.1">arXiv preprint arXiv:1911.02150</em>, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sheng et al. (2023)</span>
<span class="ltx_bibblock">
Sheng, Y., Zheng, L., Yuan, B., Li, Z., Ryabinin, M., Chen, B., Liang, P., Ré, C., Stoica, I., and Zhang, C.

</span>
<span class="ltx_bibblock">Flexgen: High-throughput generative inference of large language models with a single gpu.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib21.1.1">International Conference on Machine Learning</em>, pp.  31094–31116. PMLR, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Su et al. (2024)</span>
<span class="ltx_bibblock">
Su, J., Ahmed, M., Lu, Y., Pan, S., Bo, W., and Liu, Y.

</span>
<span class="ltx_bibblock">Roformer: Enhanced transformer with rotary position embedding.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib22.1.1">Neurocomputing</em>, 568:127063, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sun et al. (2022)</span>
<span class="ltx_bibblock">
Sun, T., Liu, X., Zhu, W., Geng, Z., Wu, L., He, Y., Ni, Y., Xie, G., Huang, X., and Qiu, X.

</span>
<span class="ltx_bibblock">A simple hash-based early exiting approach for language understanding and generation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib23.1.1">arXiv preprint arXiv:2203.01670</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Touvron et al. (2023)</span>
<span class="ltx_bibblock">
Touvron, H., Martin, L., Stone, K., Albert, P., Almahairi, A., Babaei, Y., Bashlykov, N., Batra, S., Bhargava, P., Bhosale, S., et al.

</span>
<span class="ltx_bibblock">Llama 2: Open foundation and fine-tuned chat models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib24.1.1">arXiv preprint arXiv:2307.09288</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Vaswani et al. (2017)</span>
<span class="ltx_bibblock">
Vaswani, A., Shazeer, N., Parmar, N., Uszkoreit, J., Jones, L., Gomez, A. N., Kaiser, Ł., and Polosukhin, I.

</span>
<span class="ltx_bibblock">Attention is all you need.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib25.1.1">Advances in neural information processing systems</em>, 30, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yu et al. (2024)</span>
<span class="ltx_bibblock">
Yu, H., Yang, Z., Li, S., Li, Y., and Wu, J.

</span>
<span class="ltx_bibblock">Effectively compress kv heads for llm.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib26.1.1">arXiv preprint arXiv:2406.07056</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al. (2024a)</span>
<span class="ltx_bibblock">
Zhang, Y., Gao, B., Liu, T., Lu, K., Xiong, W., Dong, Y., Chang, B., Hu, J., Xiao, W., et al.

</span>
<span class="ltx_bibblock">Pyramidkv: Dynamic kv cache compression based on pyramidal information funneling.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib27.1.1">arXiv preprint arXiv:2406.02069</em>, 2024a.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al. (2024b)</span>
<span class="ltx_bibblock">
Zhang, Z., Sheng, Y., Zhou, T., Chen, T., Zheng, L., Cai, R., Song, Z., Tian, Y., Ré, C., Barrett, C., et al.

</span>
<span class="ltx_bibblock">H2o: Heavy-hitter oracle for efficient generative inference of large language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib28.1.1">Advances in Neural Information Processing Systems</em>, 36, 2024b.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhou et al. (2020)</span>
<span class="ltx_bibblock">
Zhou, W., Xu, C., Ge, T., McAuley, J., Xu, K., and Wei, F.

</span>
<span class="ltx_bibblock">Bert loses patience: Fast and robust inference with early exit.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib29.1.1">Advances in Neural Information Processing Systems</em>, 33:18330–18341, 2020.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<section class="ltx_appendix" id="A1">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Detailed Proofs</h2>
<section class="ltx_subsection" id="A1.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.1 </span>Proof of Theorem <a class="ltx_ref" href="https://arxiv.org/html/2410.03111v1#Thmtheorem1" title="Theorem 1 ‣ 5.1 Error Bound for Key/Value Matrix Approximation ‣ 5 Error Bounds for KV Cache Compression ‣ LoRC: Low-Rank Compression for LLMs KV Cache with a Progressive Compression Strategy"><span class="ltx_text ltx_ref_tag">1</span></a>
</h3>
<div class="ltx_para" id="A1.SS1.p1">
<p class="ltx_p" id="A1.SS1.p1.1"><span class="ltx_text ltx_font_bold" id="A1.SS1.p1.1.1">Proof.</span></p>
</div>
<div class="ltx_para" id="A1.SS1.p2">
<p class="ltx_p" id="A1.SS1.p2.6">Let <math alttext="W=U\Sigma V^{\top}" class="ltx_Math" display="inline" id="A1.SS1.p2.1.m1.1"><semantics id="A1.SS1.p2.1.m1.1a"><mrow id="A1.SS1.p2.1.m1.1.1" xref="A1.SS1.p2.1.m1.1.1.cmml"><mi id="A1.SS1.p2.1.m1.1.1.2" xref="A1.SS1.p2.1.m1.1.1.2.cmml">W</mi><mo id="A1.SS1.p2.1.m1.1.1.1" xref="A1.SS1.p2.1.m1.1.1.1.cmml">=</mo><mrow id="A1.SS1.p2.1.m1.1.1.3" xref="A1.SS1.p2.1.m1.1.1.3.cmml"><mi id="A1.SS1.p2.1.m1.1.1.3.2" xref="A1.SS1.p2.1.m1.1.1.3.2.cmml">U</mi><mo id="A1.SS1.p2.1.m1.1.1.3.1" xref="A1.SS1.p2.1.m1.1.1.3.1.cmml">⁢</mo><mi id="A1.SS1.p2.1.m1.1.1.3.3" mathvariant="normal" xref="A1.SS1.p2.1.m1.1.1.3.3.cmml">Σ</mi><mo id="A1.SS1.p2.1.m1.1.1.3.1a" xref="A1.SS1.p2.1.m1.1.1.3.1.cmml">⁢</mo><msup id="A1.SS1.p2.1.m1.1.1.3.4" xref="A1.SS1.p2.1.m1.1.1.3.4.cmml"><mi id="A1.SS1.p2.1.m1.1.1.3.4.2" xref="A1.SS1.p2.1.m1.1.1.3.4.2.cmml">V</mi><mo id="A1.SS1.p2.1.m1.1.1.3.4.3" xref="A1.SS1.p2.1.m1.1.1.3.4.3.cmml">⊤</mo></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.p2.1.m1.1b"><apply id="A1.SS1.p2.1.m1.1.1.cmml" xref="A1.SS1.p2.1.m1.1.1"><eq id="A1.SS1.p2.1.m1.1.1.1.cmml" xref="A1.SS1.p2.1.m1.1.1.1"></eq><ci id="A1.SS1.p2.1.m1.1.1.2.cmml" xref="A1.SS1.p2.1.m1.1.1.2">𝑊</ci><apply id="A1.SS1.p2.1.m1.1.1.3.cmml" xref="A1.SS1.p2.1.m1.1.1.3"><times id="A1.SS1.p2.1.m1.1.1.3.1.cmml" xref="A1.SS1.p2.1.m1.1.1.3.1"></times><ci id="A1.SS1.p2.1.m1.1.1.3.2.cmml" xref="A1.SS1.p2.1.m1.1.1.3.2">𝑈</ci><ci id="A1.SS1.p2.1.m1.1.1.3.3.cmml" xref="A1.SS1.p2.1.m1.1.1.3.3">Σ</ci><apply id="A1.SS1.p2.1.m1.1.1.3.4.cmml" xref="A1.SS1.p2.1.m1.1.1.3.4"><csymbol cd="ambiguous" id="A1.SS1.p2.1.m1.1.1.3.4.1.cmml" xref="A1.SS1.p2.1.m1.1.1.3.4">superscript</csymbol><ci id="A1.SS1.p2.1.m1.1.1.3.4.2.cmml" xref="A1.SS1.p2.1.m1.1.1.3.4.2">𝑉</ci><csymbol cd="latexml" id="A1.SS1.p2.1.m1.1.1.3.4.3.cmml" xref="A1.SS1.p2.1.m1.1.1.3.4.3">top</csymbol></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p2.1.m1.1c">W=U\Sigma V^{\top}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p2.1.m1.1d">italic_W = italic_U roman_Σ italic_V start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT</annotation></semantics></math> be the full SVD of <math alttext="W" class="ltx_Math" display="inline" id="A1.SS1.p2.2.m2.1"><semantics id="A1.SS1.p2.2.m2.1a"><mi id="A1.SS1.p2.2.m2.1.1" xref="A1.SS1.p2.2.m2.1.1.cmml">W</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.p2.2.m2.1b"><ci id="A1.SS1.p2.2.m2.1.1.cmml" xref="A1.SS1.p2.2.m2.1.1">𝑊</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p2.2.m2.1c">W</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p2.2.m2.1d">italic_W</annotation></semantics></math>, where <math alttext="U\in\mathbb{R}^{m\times m}" class="ltx_Math" display="inline" id="A1.SS1.p2.3.m3.1"><semantics id="A1.SS1.p2.3.m3.1a"><mrow id="A1.SS1.p2.3.m3.1.1" xref="A1.SS1.p2.3.m3.1.1.cmml"><mi id="A1.SS1.p2.3.m3.1.1.2" xref="A1.SS1.p2.3.m3.1.1.2.cmml">U</mi><mo id="A1.SS1.p2.3.m3.1.1.1" xref="A1.SS1.p2.3.m3.1.1.1.cmml">∈</mo><msup id="A1.SS1.p2.3.m3.1.1.3" xref="A1.SS1.p2.3.m3.1.1.3.cmml"><mi id="A1.SS1.p2.3.m3.1.1.3.2" xref="A1.SS1.p2.3.m3.1.1.3.2.cmml">ℝ</mi><mrow id="A1.SS1.p2.3.m3.1.1.3.3" xref="A1.SS1.p2.3.m3.1.1.3.3.cmml"><mi id="A1.SS1.p2.3.m3.1.1.3.3.2" xref="A1.SS1.p2.3.m3.1.1.3.3.2.cmml">m</mi><mo id="A1.SS1.p2.3.m3.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="A1.SS1.p2.3.m3.1.1.3.3.1.cmml">×</mo><mi id="A1.SS1.p2.3.m3.1.1.3.3.3" xref="A1.SS1.p2.3.m3.1.1.3.3.3.cmml">m</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.p2.3.m3.1b"><apply id="A1.SS1.p2.3.m3.1.1.cmml" xref="A1.SS1.p2.3.m3.1.1"><in id="A1.SS1.p2.3.m3.1.1.1.cmml" xref="A1.SS1.p2.3.m3.1.1.1"></in><ci id="A1.SS1.p2.3.m3.1.1.2.cmml" xref="A1.SS1.p2.3.m3.1.1.2">𝑈</ci><apply id="A1.SS1.p2.3.m3.1.1.3.cmml" xref="A1.SS1.p2.3.m3.1.1.3"><csymbol cd="ambiguous" id="A1.SS1.p2.3.m3.1.1.3.1.cmml" xref="A1.SS1.p2.3.m3.1.1.3">superscript</csymbol><ci id="A1.SS1.p2.3.m3.1.1.3.2.cmml" xref="A1.SS1.p2.3.m3.1.1.3.2">ℝ</ci><apply id="A1.SS1.p2.3.m3.1.1.3.3.cmml" xref="A1.SS1.p2.3.m3.1.1.3.3"><times id="A1.SS1.p2.3.m3.1.1.3.3.1.cmml" xref="A1.SS1.p2.3.m3.1.1.3.3.1"></times><ci id="A1.SS1.p2.3.m3.1.1.3.3.2.cmml" xref="A1.SS1.p2.3.m3.1.1.3.3.2">𝑚</ci><ci id="A1.SS1.p2.3.m3.1.1.3.3.3.cmml" xref="A1.SS1.p2.3.m3.1.1.3.3.3">𝑚</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p2.3.m3.1c">U\in\mathbb{R}^{m\times m}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p2.3.m3.1d">italic_U ∈ blackboard_R start_POSTSUPERSCRIPT italic_m × italic_m end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="V\in\mathbb{R}^{n\times n}" class="ltx_Math" display="inline" id="A1.SS1.p2.4.m4.1"><semantics id="A1.SS1.p2.4.m4.1a"><mrow id="A1.SS1.p2.4.m4.1.1" xref="A1.SS1.p2.4.m4.1.1.cmml"><mi id="A1.SS1.p2.4.m4.1.1.2" xref="A1.SS1.p2.4.m4.1.1.2.cmml">V</mi><mo id="A1.SS1.p2.4.m4.1.1.1" xref="A1.SS1.p2.4.m4.1.1.1.cmml">∈</mo><msup id="A1.SS1.p2.4.m4.1.1.3" xref="A1.SS1.p2.4.m4.1.1.3.cmml"><mi id="A1.SS1.p2.4.m4.1.1.3.2" xref="A1.SS1.p2.4.m4.1.1.3.2.cmml">ℝ</mi><mrow id="A1.SS1.p2.4.m4.1.1.3.3" xref="A1.SS1.p2.4.m4.1.1.3.3.cmml"><mi id="A1.SS1.p2.4.m4.1.1.3.3.2" xref="A1.SS1.p2.4.m4.1.1.3.3.2.cmml">n</mi><mo id="A1.SS1.p2.4.m4.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="A1.SS1.p2.4.m4.1.1.3.3.1.cmml">×</mo><mi id="A1.SS1.p2.4.m4.1.1.3.3.3" xref="A1.SS1.p2.4.m4.1.1.3.3.3.cmml">n</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.p2.4.m4.1b"><apply id="A1.SS1.p2.4.m4.1.1.cmml" xref="A1.SS1.p2.4.m4.1.1"><in id="A1.SS1.p2.4.m4.1.1.1.cmml" xref="A1.SS1.p2.4.m4.1.1.1"></in><ci id="A1.SS1.p2.4.m4.1.1.2.cmml" xref="A1.SS1.p2.4.m4.1.1.2">𝑉</ci><apply id="A1.SS1.p2.4.m4.1.1.3.cmml" xref="A1.SS1.p2.4.m4.1.1.3"><csymbol cd="ambiguous" id="A1.SS1.p2.4.m4.1.1.3.1.cmml" xref="A1.SS1.p2.4.m4.1.1.3">superscript</csymbol><ci id="A1.SS1.p2.4.m4.1.1.3.2.cmml" xref="A1.SS1.p2.4.m4.1.1.3.2">ℝ</ci><apply id="A1.SS1.p2.4.m4.1.1.3.3.cmml" xref="A1.SS1.p2.4.m4.1.1.3.3"><times id="A1.SS1.p2.4.m4.1.1.3.3.1.cmml" xref="A1.SS1.p2.4.m4.1.1.3.3.1"></times><ci id="A1.SS1.p2.4.m4.1.1.3.3.2.cmml" xref="A1.SS1.p2.4.m4.1.1.3.3.2">𝑛</ci><ci id="A1.SS1.p2.4.m4.1.1.3.3.3.cmml" xref="A1.SS1.p2.4.m4.1.1.3.3.3">𝑛</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p2.4.m4.1c">V\in\mathbb{R}^{n\times n}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p2.4.m4.1d">italic_V ∈ blackboard_R start_POSTSUPERSCRIPT italic_n × italic_n end_POSTSUPERSCRIPT</annotation></semantics></math> are orthogonal matrices, and <math alttext="\Sigma=\operatorname{diag}(\sigma_{1},\ldots,\sigma_{n})" class="ltx_Math" display="inline" id="A1.SS1.p2.5.m5.4"><semantics id="A1.SS1.p2.5.m5.4a"><mrow id="A1.SS1.p2.5.m5.4.4" xref="A1.SS1.p2.5.m5.4.4.cmml"><mi id="A1.SS1.p2.5.m5.4.4.4" mathvariant="normal" xref="A1.SS1.p2.5.m5.4.4.4.cmml">Σ</mi><mo id="A1.SS1.p2.5.m5.4.4.3" xref="A1.SS1.p2.5.m5.4.4.3.cmml">=</mo><mrow id="A1.SS1.p2.5.m5.4.4.2.2" xref="A1.SS1.p2.5.m5.4.4.2.3.cmml"><mi id="A1.SS1.p2.5.m5.1.1" xref="A1.SS1.p2.5.m5.1.1.cmml">diag</mi><mo id="A1.SS1.p2.5.m5.4.4.2.2a" xref="A1.SS1.p2.5.m5.4.4.2.3.cmml">⁡</mo><mrow id="A1.SS1.p2.5.m5.4.4.2.2.2" xref="A1.SS1.p2.5.m5.4.4.2.3.cmml"><mo id="A1.SS1.p2.5.m5.4.4.2.2.2.3" stretchy="false" xref="A1.SS1.p2.5.m5.4.4.2.3.cmml">(</mo><msub id="A1.SS1.p2.5.m5.3.3.1.1.1.1" xref="A1.SS1.p2.5.m5.3.3.1.1.1.1.cmml"><mi id="A1.SS1.p2.5.m5.3.3.1.1.1.1.2" xref="A1.SS1.p2.5.m5.3.3.1.1.1.1.2.cmml">σ</mi><mn id="A1.SS1.p2.5.m5.3.3.1.1.1.1.3" xref="A1.SS1.p2.5.m5.3.3.1.1.1.1.3.cmml">1</mn></msub><mo id="A1.SS1.p2.5.m5.4.4.2.2.2.4" xref="A1.SS1.p2.5.m5.4.4.2.3.cmml">,</mo><mi id="A1.SS1.p2.5.m5.2.2" mathvariant="normal" xref="A1.SS1.p2.5.m5.2.2.cmml">…</mi><mo id="A1.SS1.p2.5.m5.4.4.2.2.2.5" xref="A1.SS1.p2.5.m5.4.4.2.3.cmml">,</mo><msub id="A1.SS1.p2.5.m5.4.4.2.2.2.2" xref="A1.SS1.p2.5.m5.4.4.2.2.2.2.cmml"><mi id="A1.SS1.p2.5.m5.4.4.2.2.2.2.2" xref="A1.SS1.p2.5.m5.4.4.2.2.2.2.2.cmml">σ</mi><mi id="A1.SS1.p2.5.m5.4.4.2.2.2.2.3" xref="A1.SS1.p2.5.m5.4.4.2.2.2.2.3.cmml">n</mi></msub><mo id="A1.SS1.p2.5.m5.4.4.2.2.2.6" stretchy="false" xref="A1.SS1.p2.5.m5.4.4.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.p2.5.m5.4b"><apply id="A1.SS1.p2.5.m5.4.4.cmml" xref="A1.SS1.p2.5.m5.4.4"><eq id="A1.SS1.p2.5.m5.4.4.3.cmml" xref="A1.SS1.p2.5.m5.4.4.3"></eq><ci id="A1.SS1.p2.5.m5.4.4.4.cmml" xref="A1.SS1.p2.5.m5.4.4.4">Σ</ci><apply id="A1.SS1.p2.5.m5.4.4.2.3.cmml" xref="A1.SS1.p2.5.m5.4.4.2.2"><ci id="A1.SS1.p2.5.m5.1.1.cmml" xref="A1.SS1.p2.5.m5.1.1">diag</ci><apply id="A1.SS1.p2.5.m5.3.3.1.1.1.1.cmml" xref="A1.SS1.p2.5.m5.3.3.1.1.1.1"><csymbol cd="ambiguous" id="A1.SS1.p2.5.m5.3.3.1.1.1.1.1.cmml" xref="A1.SS1.p2.5.m5.3.3.1.1.1.1">subscript</csymbol><ci id="A1.SS1.p2.5.m5.3.3.1.1.1.1.2.cmml" xref="A1.SS1.p2.5.m5.3.3.1.1.1.1.2">𝜎</ci><cn id="A1.SS1.p2.5.m5.3.3.1.1.1.1.3.cmml" type="integer" xref="A1.SS1.p2.5.m5.3.3.1.1.1.1.3">1</cn></apply><ci id="A1.SS1.p2.5.m5.2.2.cmml" xref="A1.SS1.p2.5.m5.2.2">…</ci><apply id="A1.SS1.p2.5.m5.4.4.2.2.2.2.cmml" xref="A1.SS1.p2.5.m5.4.4.2.2.2.2"><csymbol cd="ambiguous" id="A1.SS1.p2.5.m5.4.4.2.2.2.2.1.cmml" xref="A1.SS1.p2.5.m5.4.4.2.2.2.2">subscript</csymbol><ci id="A1.SS1.p2.5.m5.4.4.2.2.2.2.2.cmml" xref="A1.SS1.p2.5.m5.4.4.2.2.2.2.2">𝜎</ci><ci id="A1.SS1.p2.5.m5.4.4.2.2.2.2.3.cmml" xref="A1.SS1.p2.5.m5.4.4.2.2.2.2.3">𝑛</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p2.5.m5.4c">\Sigma=\operatorname{diag}(\sigma_{1},\ldots,\sigma_{n})</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p2.5.m5.4d">roman_Σ = roman_diag ( italic_σ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_σ start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT )</annotation></semantics></math> with singular values <math alttext="\sigma_{1}\geq\sigma_{2}\geq\cdots\geq\sigma_{n}\geq 0" class="ltx_Math" display="inline" id="A1.SS1.p2.6.m6.1"><semantics id="A1.SS1.p2.6.m6.1a"><mrow id="A1.SS1.p2.6.m6.1.1" xref="A1.SS1.p2.6.m6.1.1.cmml"><msub id="A1.SS1.p2.6.m6.1.1.2" xref="A1.SS1.p2.6.m6.1.1.2.cmml"><mi id="A1.SS1.p2.6.m6.1.1.2.2" xref="A1.SS1.p2.6.m6.1.1.2.2.cmml">σ</mi><mn id="A1.SS1.p2.6.m6.1.1.2.3" xref="A1.SS1.p2.6.m6.1.1.2.3.cmml">1</mn></msub><mo id="A1.SS1.p2.6.m6.1.1.3" xref="A1.SS1.p2.6.m6.1.1.3.cmml">≥</mo><msub id="A1.SS1.p2.6.m6.1.1.4" xref="A1.SS1.p2.6.m6.1.1.4.cmml"><mi id="A1.SS1.p2.6.m6.1.1.4.2" xref="A1.SS1.p2.6.m6.1.1.4.2.cmml">σ</mi><mn id="A1.SS1.p2.6.m6.1.1.4.3" xref="A1.SS1.p2.6.m6.1.1.4.3.cmml">2</mn></msub><mo id="A1.SS1.p2.6.m6.1.1.5" xref="A1.SS1.p2.6.m6.1.1.5.cmml">≥</mo><mi id="A1.SS1.p2.6.m6.1.1.6" mathvariant="normal" xref="A1.SS1.p2.6.m6.1.1.6.cmml">⋯</mi><mo id="A1.SS1.p2.6.m6.1.1.7" xref="A1.SS1.p2.6.m6.1.1.7.cmml">≥</mo><msub id="A1.SS1.p2.6.m6.1.1.8" xref="A1.SS1.p2.6.m6.1.1.8.cmml"><mi id="A1.SS1.p2.6.m6.1.1.8.2" xref="A1.SS1.p2.6.m6.1.1.8.2.cmml">σ</mi><mi id="A1.SS1.p2.6.m6.1.1.8.3" xref="A1.SS1.p2.6.m6.1.1.8.3.cmml">n</mi></msub><mo id="A1.SS1.p2.6.m6.1.1.9" xref="A1.SS1.p2.6.m6.1.1.9.cmml">≥</mo><mn id="A1.SS1.p2.6.m6.1.1.10" xref="A1.SS1.p2.6.m6.1.1.10.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.p2.6.m6.1b"><apply id="A1.SS1.p2.6.m6.1.1.cmml" xref="A1.SS1.p2.6.m6.1.1"><and id="A1.SS1.p2.6.m6.1.1a.cmml" xref="A1.SS1.p2.6.m6.1.1"></and><apply id="A1.SS1.p2.6.m6.1.1b.cmml" xref="A1.SS1.p2.6.m6.1.1"><geq id="A1.SS1.p2.6.m6.1.1.3.cmml" xref="A1.SS1.p2.6.m6.1.1.3"></geq><apply id="A1.SS1.p2.6.m6.1.1.2.cmml" xref="A1.SS1.p2.6.m6.1.1.2"><csymbol cd="ambiguous" id="A1.SS1.p2.6.m6.1.1.2.1.cmml" xref="A1.SS1.p2.6.m6.1.1.2">subscript</csymbol><ci id="A1.SS1.p2.6.m6.1.1.2.2.cmml" xref="A1.SS1.p2.6.m6.1.1.2.2">𝜎</ci><cn id="A1.SS1.p2.6.m6.1.1.2.3.cmml" type="integer" xref="A1.SS1.p2.6.m6.1.1.2.3">1</cn></apply><apply id="A1.SS1.p2.6.m6.1.1.4.cmml" xref="A1.SS1.p2.6.m6.1.1.4"><csymbol cd="ambiguous" id="A1.SS1.p2.6.m6.1.1.4.1.cmml" xref="A1.SS1.p2.6.m6.1.1.4">subscript</csymbol><ci id="A1.SS1.p2.6.m6.1.1.4.2.cmml" xref="A1.SS1.p2.6.m6.1.1.4.2">𝜎</ci><cn id="A1.SS1.p2.6.m6.1.1.4.3.cmml" type="integer" xref="A1.SS1.p2.6.m6.1.1.4.3">2</cn></apply></apply><apply id="A1.SS1.p2.6.m6.1.1c.cmml" xref="A1.SS1.p2.6.m6.1.1"><geq id="A1.SS1.p2.6.m6.1.1.5.cmml" xref="A1.SS1.p2.6.m6.1.1.5"></geq><share href="https://arxiv.org/html/2410.03111v1#A1.SS1.p2.6.m6.1.1.4.cmml" id="A1.SS1.p2.6.m6.1.1d.cmml" xref="A1.SS1.p2.6.m6.1.1"></share><ci id="A1.SS1.p2.6.m6.1.1.6.cmml" xref="A1.SS1.p2.6.m6.1.1.6">⋯</ci></apply><apply id="A1.SS1.p2.6.m6.1.1e.cmml" xref="A1.SS1.p2.6.m6.1.1"><geq id="A1.SS1.p2.6.m6.1.1.7.cmml" xref="A1.SS1.p2.6.m6.1.1.7"></geq><share href="https://arxiv.org/html/2410.03111v1#A1.SS1.p2.6.m6.1.1.6.cmml" id="A1.SS1.p2.6.m6.1.1f.cmml" xref="A1.SS1.p2.6.m6.1.1"></share><apply id="A1.SS1.p2.6.m6.1.1.8.cmml" xref="A1.SS1.p2.6.m6.1.1.8"><csymbol cd="ambiguous" id="A1.SS1.p2.6.m6.1.1.8.1.cmml" xref="A1.SS1.p2.6.m6.1.1.8">subscript</csymbol><ci id="A1.SS1.p2.6.m6.1.1.8.2.cmml" xref="A1.SS1.p2.6.m6.1.1.8.2">𝜎</ci><ci id="A1.SS1.p2.6.m6.1.1.8.3.cmml" xref="A1.SS1.p2.6.m6.1.1.8.3">𝑛</ci></apply></apply><apply id="A1.SS1.p2.6.m6.1.1g.cmml" xref="A1.SS1.p2.6.m6.1.1"><geq id="A1.SS1.p2.6.m6.1.1.9.cmml" xref="A1.SS1.p2.6.m6.1.1.9"></geq><share href="https://arxiv.org/html/2410.03111v1#A1.SS1.p2.6.m6.1.1.8.cmml" id="A1.SS1.p2.6.m6.1.1h.cmml" xref="A1.SS1.p2.6.m6.1.1"></share><cn id="A1.SS1.p2.6.m6.1.1.10.cmml" type="integer" xref="A1.SS1.p2.6.m6.1.1.10">0</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p2.6.m6.1c">\sigma_{1}\geq\sigma_{2}\geq\cdots\geq\sigma_{n}\geq 0</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p2.6.m6.1d">italic_σ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ≥ italic_σ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ≥ ⋯ ≥ italic_σ start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT ≥ 0</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="A1.SS1.p3">
<p class="ltx_p" id="A1.SS1.p3.2">The rank-<math alttext="k" class="ltx_Math" display="inline" id="A1.SS1.p3.1.m1.1"><semantics id="A1.SS1.p3.1.m1.1a"><mi id="A1.SS1.p3.1.m1.1.1" xref="A1.SS1.p3.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.p3.1.m1.1b"><ci id="A1.SS1.p3.1.m1.1.1.cmml" xref="A1.SS1.p3.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p3.1.m1.1c">k</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p3.1.m1.1d">italic_k</annotation></semantics></math> approximation <math alttext="\tilde{W}" class="ltx_Math" display="inline" id="A1.SS1.p3.2.m2.1"><semantics id="A1.SS1.p3.2.m2.1a"><mover accent="true" id="A1.SS1.p3.2.m2.1.1" xref="A1.SS1.p3.2.m2.1.1.cmml"><mi id="A1.SS1.p3.2.m2.1.1.2" xref="A1.SS1.p3.2.m2.1.1.2.cmml">W</mi><mo id="A1.SS1.p3.2.m2.1.1.1" xref="A1.SS1.p3.2.m2.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="A1.SS1.p3.2.m2.1b"><apply id="A1.SS1.p3.2.m2.1.1.cmml" xref="A1.SS1.p3.2.m2.1.1"><ci id="A1.SS1.p3.2.m2.1.1.1.cmml" xref="A1.SS1.p3.2.m2.1.1.1">~</ci><ci id="A1.SS1.p3.2.m2.1.1.2.cmml" xref="A1.SS1.p3.2.m2.1.1.2">𝑊</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p3.2.m2.1c">\tilde{W}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p3.2.m2.1d">over~ start_ARG italic_W end_ARG</annotation></semantics></math> is given by:</p>
</div>
<div class="ltx_para" id="A1.SS1.p4">
<table class="ltx_equation ltx_eqn_table" id="A1.Ex1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\tilde{W}=U_{k}\Sigma_{k}V_{k}^{\top}," class="ltx_Math" display="block" id="A1.Ex1.m1.1"><semantics id="A1.Ex1.m1.1a"><mrow id="A1.Ex1.m1.1.1.1" xref="A1.Ex1.m1.1.1.1.1.cmml"><mrow id="A1.Ex1.m1.1.1.1.1" xref="A1.Ex1.m1.1.1.1.1.cmml"><mover accent="true" id="A1.Ex1.m1.1.1.1.1.2" xref="A1.Ex1.m1.1.1.1.1.2.cmml"><mi id="A1.Ex1.m1.1.1.1.1.2.2" xref="A1.Ex1.m1.1.1.1.1.2.2.cmml">W</mi><mo id="A1.Ex1.m1.1.1.1.1.2.1" xref="A1.Ex1.m1.1.1.1.1.2.1.cmml">~</mo></mover><mo id="A1.Ex1.m1.1.1.1.1.1" xref="A1.Ex1.m1.1.1.1.1.1.cmml">=</mo><mrow id="A1.Ex1.m1.1.1.1.1.3" xref="A1.Ex1.m1.1.1.1.1.3.cmml"><msub id="A1.Ex1.m1.1.1.1.1.3.2" xref="A1.Ex1.m1.1.1.1.1.3.2.cmml"><mi id="A1.Ex1.m1.1.1.1.1.3.2.2" xref="A1.Ex1.m1.1.1.1.1.3.2.2.cmml">U</mi><mi id="A1.Ex1.m1.1.1.1.1.3.2.3" xref="A1.Ex1.m1.1.1.1.1.3.2.3.cmml">k</mi></msub><mo id="A1.Ex1.m1.1.1.1.1.3.1" xref="A1.Ex1.m1.1.1.1.1.3.1.cmml">⁢</mo><msub id="A1.Ex1.m1.1.1.1.1.3.3" xref="A1.Ex1.m1.1.1.1.1.3.3.cmml"><mi id="A1.Ex1.m1.1.1.1.1.3.3.2" mathvariant="normal" xref="A1.Ex1.m1.1.1.1.1.3.3.2.cmml">Σ</mi><mi id="A1.Ex1.m1.1.1.1.1.3.3.3" xref="A1.Ex1.m1.1.1.1.1.3.3.3.cmml">k</mi></msub><mo id="A1.Ex1.m1.1.1.1.1.3.1a" xref="A1.Ex1.m1.1.1.1.1.3.1.cmml">⁢</mo><msubsup id="A1.Ex1.m1.1.1.1.1.3.4" xref="A1.Ex1.m1.1.1.1.1.3.4.cmml"><mi id="A1.Ex1.m1.1.1.1.1.3.4.2.2" xref="A1.Ex1.m1.1.1.1.1.3.4.2.2.cmml">V</mi><mi id="A1.Ex1.m1.1.1.1.1.3.4.2.3" xref="A1.Ex1.m1.1.1.1.1.3.4.2.3.cmml">k</mi><mo id="A1.Ex1.m1.1.1.1.1.3.4.3" xref="A1.Ex1.m1.1.1.1.1.3.4.3.cmml">⊤</mo></msubsup></mrow></mrow><mo id="A1.Ex1.m1.1.1.1.2" xref="A1.Ex1.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex1.m1.1b"><apply id="A1.Ex1.m1.1.1.1.1.cmml" xref="A1.Ex1.m1.1.1.1"><eq id="A1.Ex1.m1.1.1.1.1.1.cmml" xref="A1.Ex1.m1.1.1.1.1.1"></eq><apply id="A1.Ex1.m1.1.1.1.1.2.cmml" xref="A1.Ex1.m1.1.1.1.1.2"><ci id="A1.Ex1.m1.1.1.1.1.2.1.cmml" xref="A1.Ex1.m1.1.1.1.1.2.1">~</ci><ci id="A1.Ex1.m1.1.1.1.1.2.2.cmml" xref="A1.Ex1.m1.1.1.1.1.2.2">𝑊</ci></apply><apply id="A1.Ex1.m1.1.1.1.1.3.cmml" xref="A1.Ex1.m1.1.1.1.1.3"><times id="A1.Ex1.m1.1.1.1.1.3.1.cmml" xref="A1.Ex1.m1.1.1.1.1.3.1"></times><apply id="A1.Ex1.m1.1.1.1.1.3.2.cmml" xref="A1.Ex1.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="A1.Ex1.m1.1.1.1.1.3.2.1.cmml" xref="A1.Ex1.m1.1.1.1.1.3.2">subscript</csymbol><ci id="A1.Ex1.m1.1.1.1.1.3.2.2.cmml" xref="A1.Ex1.m1.1.1.1.1.3.2.2">𝑈</ci><ci id="A1.Ex1.m1.1.1.1.1.3.2.3.cmml" xref="A1.Ex1.m1.1.1.1.1.3.2.3">𝑘</ci></apply><apply id="A1.Ex1.m1.1.1.1.1.3.3.cmml" xref="A1.Ex1.m1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="A1.Ex1.m1.1.1.1.1.3.3.1.cmml" xref="A1.Ex1.m1.1.1.1.1.3.3">subscript</csymbol><ci id="A1.Ex1.m1.1.1.1.1.3.3.2.cmml" xref="A1.Ex1.m1.1.1.1.1.3.3.2">Σ</ci><ci id="A1.Ex1.m1.1.1.1.1.3.3.3.cmml" xref="A1.Ex1.m1.1.1.1.1.3.3.3">𝑘</ci></apply><apply id="A1.Ex1.m1.1.1.1.1.3.4.cmml" xref="A1.Ex1.m1.1.1.1.1.3.4"><csymbol cd="ambiguous" id="A1.Ex1.m1.1.1.1.1.3.4.1.cmml" xref="A1.Ex1.m1.1.1.1.1.3.4">superscript</csymbol><apply id="A1.Ex1.m1.1.1.1.1.3.4.2.cmml" xref="A1.Ex1.m1.1.1.1.1.3.4"><csymbol cd="ambiguous" id="A1.Ex1.m1.1.1.1.1.3.4.2.1.cmml" xref="A1.Ex1.m1.1.1.1.1.3.4">subscript</csymbol><ci id="A1.Ex1.m1.1.1.1.1.3.4.2.2.cmml" xref="A1.Ex1.m1.1.1.1.1.3.4.2.2">𝑉</ci><ci id="A1.Ex1.m1.1.1.1.1.3.4.2.3.cmml" xref="A1.Ex1.m1.1.1.1.1.3.4.2.3">𝑘</ci></apply><csymbol cd="latexml" id="A1.Ex1.m1.1.1.1.1.3.4.3.cmml" xref="A1.Ex1.m1.1.1.1.1.3.4.3">top</csymbol></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex1.m1.1c">\tilde{W}=U_{k}\Sigma_{k}V_{k}^{\top},</annotation><annotation encoding="application/x-llamapun" id="A1.Ex1.m1.1d">over~ start_ARG italic_W end_ARG = italic_U start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT roman_Σ start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT italic_V start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="A1.SS1.p5">
<p class="ltx_p" id="A1.SS1.p5.7">where <math alttext="U_{k}" class="ltx_Math" display="inline" id="A1.SS1.p5.1.m1.1"><semantics id="A1.SS1.p5.1.m1.1a"><msub id="A1.SS1.p5.1.m1.1.1" xref="A1.SS1.p5.1.m1.1.1.cmml"><mi id="A1.SS1.p5.1.m1.1.1.2" xref="A1.SS1.p5.1.m1.1.1.2.cmml">U</mi><mi id="A1.SS1.p5.1.m1.1.1.3" xref="A1.SS1.p5.1.m1.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS1.p5.1.m1.1b"><apply id="A1.SS1.p5.1.m1.1.1.cmml" xref="A1.SS1.p5.1.m1.1.1"><csymbol cd="ambiguous" id="A1.SS1.p5.1.m1.1.1.1.cmml" xref="A1.SS1.p5.1.m1.1.1">subscript</csymbol><ci id="A1.SS1.p5.1.m1.1.1.2.cmml" xref="A1.SS1.p5.1.m1.1.1.2">𝑈</ci><ci id="A1.SS1.p5.1.m1.1.1.3.cmml" xref="A1.SS1.p5.1.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p5.1.m1.1c">U_{k}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p5.1.m1.1d">italic_U start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="\Sigma_{k}" class="ltx_Math" display="inline" id="A1.SS1.p5.2.m2.1"><semantics id="A1.SS1.p5.2.m2.1a"><msub id="A1.SS1.p5.2.m2.1.1" xref="A1.SS1.p5.2.m2.1.1.cmml"><mi id="A1.SS1.p5.2.m2.1.1.2" mathvariant="normal" xref="A1.SS1.p5.2.m2.1.1.2.cmml">Σ</mi><mi id="A1.SS1.p5.2.m2.1.1.3" xref="A1.SS1.p5.2.m2.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS1.p5.2.m2.1b"><apply id="A1.SS1.p5.2.m2.1.1.cmml" xref="A1.SS1.p5.2.m2.1.1"><csymbol cd="ambiguous" id="A1.SS1.p5.2.m2.1.1.1.cmml" xref="A1.SS1.p5.2.m2.1.1">subscript</csymbol><ci id="A1.SS1.p5.2.m2.1.1.2.cmml" xref="A1.SS1.p5.2.m2.1.1.2">Σ</ci><ci id="A1.SS1.p5.2.m2.1.1.3.cmml" xref="A1.SS1.p5.2.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p5.2.m2.1c">\Sigma_{k}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p5.2.m2.1d">roman_Σ start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math>, and <math alttext="V_{k}" class="ltx_Math" display="inline" id="A1.SS1.p5.3.m3.1"><semantics id="A1.SS1.p5.3.m3.1a"><msub id="A1.SS1.p5.3.m3.1.1" xref="A1.SS1.p5.3.m3.1.1.cmml"><mi id="A1.SS1.p5.3.m3.1.1.2" xref="A1.SS1.p5.3.m3.1.1.2.cmml">V</mi><mi id="A1.SS1.p5.3.m3.1.1.3" xref="A1.SS1.p5.3.m3.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS1.p5.3.m3.1b"><apply id="A1.SS1.p5.3.m3.1.1.cmml" xref="A1.SS1.p5.3.m3.1.1"><csymbol cd="ambiguous" id="A1.SS1.p5.3.m3.1.1.1.cmml" xref="A1.SS1.p5.3.m3.1.1">subscript</csymbol><ci id="A1.SS1.p5.3.m3.1.1.2.cmml" xref="A1.SS1.p5.3.m3.1.1.2">𝑉</ci><ci id="A1.SS1.p5.3.m3.1.1.3.cmml" xref="A1.SS1.p5.3.m3.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p5.3.m3.1c">V_{k}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p5.3.m3.1d">italic_V start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> are truncated versions of <math alttext="U" class="ltx_Math" display="inline" id="A1.SS1.p5.4.m4.1"><semantics id="A1.SS1.p5.4.m4.1a"><mi id="A1.SS1.p5.4.m4.1.1" xref="A1.SS1.p5.4.m4.1.1.cmml">U</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.p5.4.m4.1b"><ci id="A1.SS1.p5.4.m4.1.1.cmml" xref="A1.SS1.p5.4.m4.1.1">𝑈</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p5.4.m4.1c">U</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p5.4.m4.1d">italic_U</annotation></semantics></math>, <math alttext="\Sigma" class="ltx_Math" display="inline" id="A1.SS1.p5.5.m5.1"><semantics id="A1.SS1.p5.5.m5.1a"><mi id="A1.SS1.p5.5.m5.1.1" mathvariant="normal" xref="A1.SS1.p5.5.m5.1.1.cmml">Σ</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.p5.5.m5.1b"><ci id="A1.SS1.p5.5.m5.1.1.cmml" xref="A1.SS1.p5.5.m5.1.1">Σ</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p5.5.m5.1c">\Sigma</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p5.5.m5.1d">roman_Σ</annotation></semantics></math>, and <math alttext="V" class="ltx_Math" display="inline" id="A1.SS1.p5.6.m6.1"><semantics id="A1.SS1.p5.6.m6.1a"><mi id="A1.SS1.p5.6.m6.1.1" xref="A1.SS1.p5.6.m6.1.1.cmml">V</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.p5.6.m6.1b"><ci id="A1.SS1.p5.6.m6.1.1.cmml" xref="A1.SS1.p5.6.m6.1.1">𝑉</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p5.6.m6.1c">V</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p5.6.m6.1d">italic_V</annotation></semantics></math>, respectively, keeping only the first <math alttext="k" class="ltx_Math" display="inline" id="A1.SS1.p5.7.m7.1"><semantics id="A1.SS1.p5.7.m7.1a"><mi id="A1.SS1.p5.7.m7.1.1" xref="A1.SS1.p5.7.m7.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.p5.7.m7.1b"><ci id="A1.SS1.p5.7.m7.1.1.cmml" xref="A1.SS1.p5.7.m7.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p5.7.m7.1c">k</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p5.7.m7.1d">italic_k</annotation></semantics></math> singular values and corresponding vectors.</p>
</div>
<div class="ltx_para" id="A1.SS1.p6">
<p class="ltx_p" id="A1.SS1.p6.1">We have:</p>
</div>
<div class="ltx_para" id="A1.SS1.p7">
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A4.EGx1">
<tbody id="A1.Ex2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\|Wx-\tilde{W}x\|_{2}" class="ltx_Math" display="inline" id="A1.Ex2.m1.1"><semantics id="A1.Ex2.m1.1a"><msub id="A1.Ex2.m1.1.1" xref="A1.Ex2.m1.1.1.cmml"><mrow id="A1.Ex2.m1.1.1.1.1" xref="A1.Ex2.m1.1.1.1.2.cmml"><mo id="A1.Ex2.m1.1.1.1.1.2" stretchy="false" xref="A1.Ex2.m1.1.1.1.2.1.cmml">‖</mo><mrow id="A1.Ex2.m1.1.1.1.1.1" xref="A1.Ex2.m1.1.1.1.1.1.cmml"><mrow id="A1.Ex2.m1.1.1.1.1.1.2" xref="A1.Ex2.m1.1.1.1.1.1.2.cmml"><mi id="A1.Ex2.m1.1.1.1.1.1.2.2" xref="A1.Ex2.m1.1.1.1.1.1.2.2.cmml">W</mi><mo id="A1.Ex2.m1.1.1.1.1.1.2.1" xref="A1.Ex2.m1.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="A1.Ex2.m1.1.1.1.1.1.2.3" xref="A1.Ex2.m1.1.1.1.1.1.2.3.cmml">x</mi></mrow><mo id="A1.Ex2.m1.1.1.1.1.1.1" xref="A1.Ex2.m1.1.1.1.1.1.1.cmml">−</mo><mrow id="A1.Ex2.m1.1.1.1.1.1.3" xref="A1.Ex2.m1.1.1.1.1.1.3.cmml"><mover accent="true" id="A1.Ex2.m1.1.1.1.1.1.3.2" xref="A1.Ex2.m1.1.1.1.1.1.3.2.cmml"><mi id="A1.Ex2.m1.1.1.1.1.1.3.2.2" xref="A1.Ex2.m1.1.1.1.1.1.3.2.2.cmml">W</mi><mo id="A1.Ex2.m1.1.1.1.1.1.3.2.1" xref="A1.Ex2.m1.1.1.1.1.1.3.2.1.cmml">~</mo></mover><mo id="A1.Ex2.m1.1.1.1.1.1.3.1" xref="A1.Ex2.m1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="A1.Ex2.m1.1.1.1.1.1.3.3" xref="A1.Ex2.m1.1.1.1.1.1.3.3.cmml">x</mi></mrow></mrow><mo id="A1.Ex2.m1.1.1.1.1.3" stretchy="false" xref="A1.Ex2.m1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="A1.Ex2.m1.1.1.3" xref="A1.Ex2.m1.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="A1.Ex2.m1.1b"><apply id="A1.Ex2.m1.1.1.cmml" xref="A1.Ex2.m1.1.1"><csymbol cd="ambiguous" id="A1.Ex2.m1.1.1.2.cmml" xref="A1.Ex2.m1.1.1">subscript</csymbol><apply id="A1.Ex2.m1.1.1.1.2.cmml" xref="A1.Ex2.m1.1.1.1.1"><csymbol cd="latexml" id="A1.Ex2.m1.1.1.1.2.1.cmml" xref="A1.Ex2.m1.1.1.1.1.2">norm</csymbol><apply id="A1.Ex2.m1.1.1.1.1.1.cmml" xref="A1.Ex2.m1.1.1.1.1.1"><minus id="A1.Ex2.m1.1.1.1.1.1.1.cmml" xref="A1.Ex2.m1.1.1.1.1.1.1"></minus><apply id="A1.Ex2.m1.1.1.1.1.1.2.cmml" xref="A1.Ex2.m1.1.1.1.1.1.2"><times id="A1.Ex2.m1.1.1.1.1.1.2.1.cmml" xref="A1.Ex2.m1.1.1.1.1.1.2.1"></times><ci id="A1.Ex2.m1.1.1.1.1.1.2.2.cmml" xref="A1.Ex2.m1.1.1.1.1.1.2.2">𝑊</ci><ci id="A1.Ex2.m1.1.1.1.1.1.2.3.cmml" xref="A1.Ex2.m1.1.1.1.1.1.2.3">𝑥</ci></apply><apply id="A1.Ex2.m1.1.1.1.1.1.3.cmml" xref="A1.Ex2.m1.1.1.1.1.1.3"><times id="A1.Ex2.m1.1.1.1.1.1.3.1.cmml" xref="A1.Ex2.m1.1.1.1.1.1.3.1"></times><apply id="A1.Ex2.m1.1.1.1.1.1.3.2.cmml" xref="A1.Ex2.m1.1.1.1.1.1.3.2"><ci id="A1.Ex2.m1.1.1.1.1.1.3.2.1.cmml" xref="A1.Ex2.m1.1.1.1.1.1.3.2.1">~</ci><ci id="A1.Ex2.m1.1.1.1.1.1.3.2.2.cmml" xref="A1.Ex2.m1.1.1.1.1.1.3.2.2">𝑊</ci></apply><ci id="A1.Ex2.m1.1.1.1.1.1.3.3.cmml" xref="A1.Ex2.m1.1.1.1.1.1.3.3">𝑥</ci></apply></apply></apply><cn id="A1.Ex2.m1.1.1.3.cmml" type="integer" xref="A1.Ex2.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex2.m1.1c">\displaystyle\|Wx-\tilde{W}x\|_{2}</annotation><annotation encoding="application/x-llamapun" id="A1.Ex2.m1.1d">∥ italic_W italic_x - over~ start_ARG italic_W end_ARG italic_x ∥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\|(W-\tilde{W})x\|_{2}" class="ltx_Math" display="inline" id="A1.Ex2.m2.1"><semantics id="A1.Ex2.m2.1a"><mrow id="A1.Ex2.m2.1.1" xref="A1.Ex2.m2.1.1.cmml"><mi id="A1.Ex2.m2.1.1.3" xref="A1.Ex2.m2.1.1.3.cmml"></mi><mo id="A1.Ex2.m2.1.1.2" xref="A1.Ex2.m2.1.1.2.cmml">=</mo><msub id="A1.Ex2.m2.1.1.1" xref="A1.Ex2.m2.1.1.1.cmml"><mrow id="A1.Ex2.m2.1.1.1.1.1" xref="A1.Ex2.m2.1.1.1.1.2.cmml"><mo id="A1.Ex2.m2.1.1.1.1.1.2" stretchy="false" xref="A1.Ex2.m2.1.1.1.1.2.1.cmml">‖</mo><mrow id="A1.Ex2.m2.1.1.1.1.1.1" xref="A1.Ex2.m2.1.1.1.1.1.1.cmml"><mrow id="A1.Ex2.m2.1.1.1.1.1.1.1.1" xref="A1.Ex2.m2.1.1.1.1.1.1.1.1.1.cmml"><mo id="A1.Ex2.m2.1.1.1.1.1.1.1.1.2" stretchy="false" xref="A1.Ex2.m2.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.Ex2.m2.1.1.1.1.1.1.1.1.1" xref="A1.Ex2.m2.1.1.1.1.1.1.1.1.1.cmml"><mi id="A1.Ex2.m2.1.1.1.1.1.1.1.1.1.2" xref="A1.Ex2.m2.1.1.1.1.1.1.1.1.1.2.cmml">W</mi><mo id="A1.Ex2.m2.1.1.1.1.1.1.1.1.1.1" xref="A1.Ex2.m2.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><mover accent="true" id="A1.Ex2.m2.1.1.1.1.1.1.1.1.1.3" xref="A1.Ex2.m2.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="A1.Ex2.m2.1.1.1.1.1.1.1.1.1.3.2" xref="A1.Ex2.m2.1.1.1.1.1.1.1.1.1.3.2.cmml">W</mi><mo id="A1.Ex2.m2.1.1.1.1.1.1.1.1.1.3.1" xref="A1.Ex2.m2.1.1.1.1.1.1.1.1.1.3.1.cmml">~</mo></mover></mrow><mo id="A1.Ex2.m2.1.1.1.1.1.1.1.1.3" stretchy="false" xref="A1.Ex2.m2.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="A1.Ex2.m2.1.1.1.1.1.1.2" xref="A1.Ex2.m2.1.1.1.1.1.1.2.cmml">⁢</mo><mi id="A1.Ex2.m2.1.1.1.1.1.1.3" xref="A1.Ex2.m2.1.1.1.1.1.1.3.cmml">x</mi></mrow><mo id="A1.Ex2.m2.1.1.1.1.1.3" stretchy="false" xref="A1.Ex2.m2.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="A1.Ex2.m2.1.1.1.3" xref="A1.Ex2.m2.1.1.1.3.cmml">2</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex2.m2.1b"><apply id="A1.Ex2.m2.1.1.cmml" xref="A1.Ex2.m2.1.1"><eq id="A1.Ex2.m2.1.1.2.cmml" xref="A1.Ex2.m2.1.1.2"></eq><csymbol cd="latexml" id="A1.Ex2.m2.1.1.3.cmml" xref="A1.Ex2.m2.1.1.3">absent</csymbol><apply id="A1.Ex2.m2.1.1.1.cmml" xref="A1.Ex2.m2.1.1.1"><csymbol cd="ambiguous" id="A1.Ex2.m2.1.1.1.2.cmml" xref="A1.Ex2.m2.1.1.1">subscript</csymbol><apply id="A1.Ex2.m2.1.1.1.1.2.cmml" xref="A1.Ex2.m2.1.1.1.1.1"><csymbol cd="latexml" id="A1.Ex2.m2.1.1.1.1.2.1.cmml" xref="A1.Ex2.m2.1.1.1.1.1.2">norm</csymbol><apply id="A1.Ex2.m2.1.1.1.1.1.1.cmml" xref="A1.Ex2.m2.1.1.1.1.1.1"><times id="A1.Ex2.m2.1.1.1.1.1.1.2.cmml" xref="A1.Ex2.m2.1.1.1.1.1.1.2"></times><apply id="A1.Ex2.m2.1.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex2.m2.1.1.1.1.1.1.1.1"><minus id="A1.Ex2.m2.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex2.m2.1.1.1.1.1.1.1.1.1.1"></minus><ci id="A1.Ex2.m2.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.Ex2.m2.1.1.1.1.1.1.1.1.1.2">𝑊</ci><apply id="A1.Ex2.m2.1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.Ex2.m2.1.1.1.1.1.1.1.1.1.3"><ci id="A1.Ex2.m2.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="A1.Ex2.m2.1.1.1.1.1.1.1.1.1.3.1">~</ci><ci id="A1.Ex2.m2.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="A1.Ex2.m2.1.1.1.1.1.1.1.1.1.3.2">𝑊</ci></apply></apply><ci id="A1.Ex2.m2.1.1.1.1.1.1.3.cmml" xref="A1.Ex2.m2.1.1.1.1.1.1.3">𝑥</ci></apply></apply><cn id="A1.Ex2.m2.1.1.1.3.cmml" type="integer" xref="A1.Ex2.m2.1.1.1.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex2.m2.1c">\displaystyle=\|(W-\tilde{W})x\|_{2}</annotation><annotation encoding="application/x-llamapun" id="A1.Ex2.m2.1d">= ∥ ( italic_W - over~ start_ARG italic_W end_ARG ) italic_x ∥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A1.Ex3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\|U(\Sigma-\Sigma_{k})V^{\top}x\|_{2}" class="ltx_Math" display="inline" id="A1.Ex3.m1.1"><semantics id="A1.Ex3.m1.1a"><mrow id="A1.Ex3.m1.1.1" xref="A1.Ex3.m1.1.1.cmml"><mi id="A1.Ex3.m1.1.1.3" xref="A1.Ex3.m1.1.1.3.cmml"></mi><mo id="A1.Ex3.m1.1.1.2" xref="A1.Ex3.m1.1.1.2.cmml">=</mo><msub id="A1.Ex3.m1.1.1.1" xref="A1.Ex3.m1.1.1.1.cmml"><mrow id="A1.Ex3.m1.1.1.1.1.1" xref="A1.Ex3.m1.1.1.1.1.2.cmml"><mo id="A1.Ex3.m1.1.1.1.1.1.2" stretchy="false" xref="A1.Ex3.m1.1.1.1.1.2.1.cmml">‖</mo><mrow id="A1.Ex3.m1.1.1.1.1.1.1" xref="A1.Ex3.m1.1.1.1.1.1.1.cmml"><mi id="A1.Ex3.m1.1.1.1.1.1.1.3" xref="A1.Ex3.m1.1.1.1.1.1.1.3.cmml">U</mi><mo id="A1.Ex3.m1.1.1.1.1.1.1.2" xref="A1.Ex3.m1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.Ex3.m1.1.1.1.1.1.1.1.1" xref="A1.Ex3.m1.1.1.1.1.1.1.1.1.1.cmml"><mo id="A1.Ex3.m1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="A1.Ex3.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.Ex3.m1.1.1.1.1.1.1.1.1.1" xref="A1.Ex3.m1.1.1.1.1.1.1.1.1.1.cmml"><mi id="A1.Ex3.m1.1.1.1.1.1.1.1.1.1.2" mathvariant="normal" xref="A1.Ex3.m1.1.1.1.1.1.1.1.1.1.2.cmml">Σ</mi><mo id="A1.Ex3.m1.1.1.1.1.1.1.1.1.1.1" xref="A1.Ex3.m1.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><msub id="A1.Ex3.m1.1.1.1.1.1.1.1.1.1.3" xref="A1.Ex3.m1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="A1.Ex3.m1.1.1.1.1.1.1.1.1.1.3.2" mathvariant="normal" xref="A1.Ex3.m1.1.1.1.1.1.1.1.1.1.3.2.cmml">Σ</mi><mi id="A1.Ex3.m1.1.1.1.1.1.1.1.1.1.3.3" xref="A1.Ex3.m1.1.1.1.1.1.1.1.1.1.3.3.cmml">k</mi></msub></mrow><mo id="A1.Ex3.m1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="A1.Ex3.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="A1.Ex3.m1.1.1.1.1.1.1.2a" xref="A1.Ex3.m1.1.1.1.1.1.1.2.cmml">⁢</mo><msup id="A1.Ex3.m1.1.1.1.1.1.1.4" xref="A1.Ex3.m1.1.1.1.1.1.1.4.cmml"><mi id="A1.Ex3.m1.1.1.1.1.1.1.4.2" xref="A1.Ex3.m1.1.1.1.1.1.1.4.2.cmml">V</mi><mo id="A1.Ex3.m1.1.1.1.1.1.1.4.3" xref="A1.Ex3.m1.1.1.1.1.1.1.4.3.cmml">⊤</mo></msup><mo id="A1.Ex3.m1.1.1.1.1.1.1.2b" xref="A1.Ex3.m1.1.1.1.1.1.1.2.cmml">⁢</mo><mi id="A1.Ex3.m1.1.1.1.1.1.1.5" xref="A1.Ex3.m1.1.1.1.1.1.1.5.cmml">x</mi></mrow><mo id="A1.Ex3.m1.1.1.1.1.1.3" stretchy="false" xref="A1.Ex3.m1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="A1.Ex3.m1.1.1.1.3" xref="A1.Ex3.m1.1.1.1.3.cmml">2</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex3.m1.1b"><apply id="A1.Ex3.m1.1.1.cmml" xref="A1.Ex3.m1.1.1"><eq id="A1.Ex3.m1.1.1.2.cmml" xref="A1.Ex3.m1.1.1.2"></eq><csymbol cd="latexml" id="A1.Ex3.m1.1.1.3.cmml" xref="A1.Ex3.m1.1.1.3">absent</csymbol><apply id="A1.Ex3.m1.1.1.1.cmml" xref="A1.Ex3.m1.1.1.1"><csymbol cd="ambiguous" id="A1.Ex3.m1.1.1.1.2.cmml" xref="A1.Ex3.m1.1.1.1">subscript</csymbol><apply id="A1.Ex3.m1.1.1.1.1.2.cmml" xref="A1.Ex3.m1.1.1.1.1.1"><csymbol cd="latexml" id="A1.Ex3.m1.1.1.1.1.2.1.cmml" xref="A1.Ex3.m1.1.1.1.1.1.2">norm</csymbol><apply id="A1.Ex3.m1.1.1.1.1.1.1.cmml" xref="A1.Ex3.m1.1.1.1.1.1.1"><times id="A1.Ex3.m1.1.1.1.1.1.1.2.cmml" xref="A1.Ex3.m1.1.1.1.1.1.1.2"></times><ci id="A1.Ex3.m1.1.1.1.1.1.1.3.cmml" xref="A1.Ex3.m1.1.1.1.1.1.1.3">𝑈</ci><apply id="A1.Ex3.m1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex3.m1.1.1.1.1.1.1.1.1"><minus id="A1.Ex3.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex3.m1.1.1.1.1.1.1.1.1.1.1"></minus><ci id="A1.Ex3.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.Ex3.m1.1.1.1.1.1.1.1.1.1.2">Σ</ci><apply id="A1.Ex3.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.Ex3.m1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.Ex3.m1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="A1.Ex3.m1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="A1.Ex3.m1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="A1.Ex3.m1.1.1.1.1.1.1.1.1.1.3.2">Σ</ci><ci id="A1.Ex3.m1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="A1.Ex3.m1.1.1.1.1.1.1.1.1.1.3.3">𝑘</ci></apply></apply><apply id="A1.Ex3.m1.1.1.1.1.1.1.4.cmml" xref="A1.Ex3.m1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="A1.Ex3.m1.1.1.1.1.1.1.4.1.cmml" xref="A1.Ex3.m1.1.1.1.1.1.1.4">superscript</csymbol><ci id="A1.Ex3.m1.1.1.1.1.1.1.4.2.cmml" xref="A1.Ex3.m1.1.1.1.1.1.1.4.2">𝑉</ci><csymbol cd="latexml" id="A1.Ex3.m1.1.1.1.1.1.1.4.3.cmml" xref="A1.Ex3.m1.1.1.1.1.1.1.4.3">top</csymbol></apply><ci id="A1.Ex3.m1.1.1.1.1.1.1.5.cmml" xref="A1.Ex3.m1.1.1.1.1.1.1.5">𝑥</ci></apply></apply><cn id="A1.Ex3.m1.1.1.1.3.cmml" type="integer" xref="A1.Ex3.m1.1.1.1.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex3.m1.1c">\displaystyle=\|U(\Sigma-\Sigma_{k})V^{\top}x\|_{2}</annotation><annotation encoding="application/x-llamapun" id="A1.Ex3.m1.1d">= ∥ italic_U ( roman_Σ - roman_Σ start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ) italic_V start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT italic_x ∥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A1.Ex4"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\|(\Sigma-\Sigma_{k})V^{\top}x\|_{2},\quad\text{since }U\text{ %
is orthogonal}" class="ltx_Math" display="inline" id="A1.Ex4.m1.2"><semantics id="A1.Ex4.m1.2a"><mrow id="A1.Ex4.m1.2.2" xref="A1.Ex4.m1.2.2.cmml"><mi id="A1.Ex4.m1.2.2.4" xref="A1.Ex4.m1.2.2.4.cmml"></mi><mo id="A1.Ex4.m1.2.2.3" xref="A1.Ex4.m1.2.2.3.cmml">=</mo><mrow id="A1.Ex4.m1.2.2.2.2" xref="A1.Ex4.m1.2.2.2.3.cmml"><msub id="A1.Ex4.m1.1.1.1.1.1" xref="A1.Ex4.m1.1.1.1.1.1.cmml"><mrow id="A1.Ex4.m1.1.1.1.1.1.1.1" xref="A1.Ex4.m1.1.1.1.1.1.1.2.cmml"><mo id="A1.Ex4.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="A1.Ex4.m1.1.1.1.1.1.1.2.1.cmml">‖</mo><mrow id="A1.Ex4.m1.1.1.1.1.1.1.1.1" xref="A1.Ex4.m1.1.1.1.1.1.1.1.1.cmml"><mrow id="A1.Ex4.m1.1.1.1.1.1.1.1.1.1.1" xref="A1.Ex4.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="A1.Ex4.m1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="A1.Ex4.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.Ex4.m1.1.1.1.1.1.1.1.1.1.1.1" xref="A1.Ex4.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="A1.Ex4.m1.1.1.1.1.1.1.1.1.1.1.1.2" mathvariant="normal" xref="A1.Ex4.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">Σ</mi><mo id="A1.Ex4.m1.1.1.1.1.1.1.1.1.1.1.1.1" xref="A1.Ex4.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><msub id="A1.Ex4.m1.1.1.1.1.1.1.1.1.1.1.1.3" xref="A1.Ex4.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="A1.Ex4.m1.1.1.1.1.1.1.1.1.1.1.1.3.2" mathvariant="normal" xref="A1.Ex4.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">Σ</mi><mi id="A1.Ex4.m1.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="A1.Ex4.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">k</mi></msub></mrow><mo id="A1.Ex4.m1.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="A1.Ex4.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="A1.Ex4.m1.1.1.1.1.1.1.1.1.2" xref="A1.Ex4.m1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><msup id="A1.Ex4.m1.1.1.1.1.1.1.1.1.3" xref="A1.Ex4.m1.1.1.1.1.1.1.1.1.3.cmml"><mi id="A1.Ex4.m1.1.1.1.1.1.1.1.1.3.2" xref="A1.Ex4.m1.1.1.1.1.1.1.1.1.3.2.cmml">V</mi><mo id="A1.Ex4.m1.1.1.1.1.1.1.1.1.3.3" xref="A1.Ex4.m1.1.1.1.1.1.1.1.1.3.3.cmml">⊤</mo></msup><mo id="A1.Ex4.m1.1.1.1.1.1.1.1.1.2a" xref="A1.Ex4.m1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mi id="A1.Ex4.m1.1.1.1.1.1.1.1.1.4" xref="A1.Ex4.m1.1.1.1.1.1.1.1.1.4.cmml">x</mi></mrow><mo id="A1.Ex4.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="A1.Ex4.m1.1.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="A1.Ex4.m1.1.1.1.1.1.3" xref="A1.Ex4.m1.1.1.1.1.1.3.cmml">2</mn></msub><mo id="A1.Ex4.m1.2.2.2.2.3" rspace="1.167em" xref="A1.Ex4.m1.2.2.2.3.cmml">,</mo><mrow id="A1.Ex4.m1.2.2.2.2.2" xref="A1.Ex4.m1.2.2.2.2.2.cmml"><mtext id="A1.Ex4.m1.2.2.2.2.2.2" xref="A1.Ex4.m1.2.2.2.2.2.2a.cmml">since </mtext><mo id="A1.Ex4.m1.2.2.2.2.2.1" xref="A1.Ex4.m1.2.2.2.2.2.1.cmml">⁢</mo><mi id="A1.Ex4.m1.2.2.2.2.2.3" xref="A1.Ex4.m1.2.2.2.2.2.3.cmml">U</mi><mo id="A1.Ex4.m1.2.2.2.2.2.1a" xref="A1.Ex4.m1.2.2.2.2.2.1.cmml">⁢</mo><mtext id="A1.Ex4.m1.2.2.2.2.2.4" xref="A1.Ex4.m1.2.2.2.2.2.4a.cmml"> is orthogonal</mtext></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex4.m1.2b"><apply id="A1.Ex4.m1.2.2.cmml" xref="A1.Ex4.m1.2.2"><eq id="A1.Ex4.m1.2.2.3.cmml" xref="A1.Ex4.m1.2.2.3"></eq><csymbol cd="latexml" id="A1.Ex4.m1.2.2.4.cmml" xref="A1.Ex4.m1.2.2.4">absent</csymbol><list id="A1.Ex4.m1.2.2.2.3.cmml" xref="A1.Ex4.m1.2.2.2.2"><apply id="A1.Ex4.m1.1.1.1.1.1.cmml" xref="A1.Ex4.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.Ex4.m1.1.1.1.1.1.2.cmml" xref="A1.Ex4.m1.1.1.1.1.1">subscript</csymbol><apply id="A1.Ex4.m1.1.1.1.1.1.1.2.cmml" xref="A1.Ex4.m1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="A1.Ex4.m1.1.1.1.1.1.1.2.1.cmml" xref="A1.Ex4.m1.1.1.1.1.1.1.1.2">norm</csymbol><apply id="A1.Ex4.m1.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex4.m1.1.1.1.1.1.1.1.1"><times id="A1.Ex4.m1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.Ex4.m1.1.1.1.1.1.1.1.1.2"></times><apply id="A1.Ex4.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex4.m1.1.1.1.1.1.1.1.1.1.1"><minus id="A1.Ex4.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex4.m1.1.1.1.1.1.1.1.1.1.1.1.1"></minus><ci id="A1.Ex4.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.Ex4.m1.1.1.1.1.1.1.1.1.1.1.1.2">Σ</ci><apply id="A1.Ex4.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.Ex4.m1.1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.Ex4.m1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="A1.Ex4.m1.1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="A1.Ex4.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="A1.Ex4.m1.1.1.1.1.1.1.1.1.1.1.1.3.2">Σ</ci><ci id="A1.Ex4.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="A1.Ex4.m1.1.1.1.1.1.1.1.1.1.1.1.3.3">𝑘</ci></apply></apply><apply id="A1.Ex4.m1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.Ex4.m1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.Ex4.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="A1.Ex4.m1.1.1.1.1.1.1.1.1.3">superscript</csymbol><ci id="A1.Ex4.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="A1.Ex4.m1.1.1.1.1.1.1.1.1.3.2">𝑉</ci><csymbol cd="latexml" id="A1.Ex4.m1.1.1.1.1.1.1.1.1.3.3.cmml" xref="A1.Ex4.m1.1.1.1.1.1.1.1.1.3.3">top</csymbol></apply><ci id="A1.Ex4.m1.1.1.1.1.1.1.1.1.4.cmml" xref="A1.Ex4.m1.1.1.1.1.1.1.1.1.4">𝑥</ci></apply></apply><cn id="A1.Ex4.m1.1.1.1.1.1.3.cmml" type="integer" xref="A1.Ex4.m1.1.1.1.1.1.3">2</cn></apply><apply id="A1.Ex4.m1.2.2.2.2.2.cmml" xref="A1.Ex4.m1.2.2.2.2.2"><times id="A1.Ex4.m1.2.2.2.2.2.1.cmml" xref="A1.Ex4.m1.2.2.2.2.2.1"></times><ci id="A1.Ex4.m1.2.2.2.2.2.2a.cmml" xref="A1.Ex4.m1.2.2.2.2.2.2"><mtext id="A1.Ex4.m1.2.2.2.2.2.2.cmml" xref="A1.Ex4.m1.2.2.2.2.2.2">since </mtext></ci><ci id="A1.Ex4.m1.2.2.2.2.2.3.cmml" xref="A1.Ex4.m1.2.2.2.2.2.3">𝑈</ci><ci id="A1.Ex4.m1.2.2.2.2.2.4a.cmml" xref="A1.Ex4.m1.2.2.2.2.2.4"><mtext id="A1.Ex4.m1.2.2.2.2.2.4.cmml" xref="A1.Ex4.m1.2.2.2.2.2.4"> is orthogonal</mtext></ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex4.m1.2c">\displaystyle=\|(\Sigma-\Sigma_{k})V^{\top}x\|_{2},\quad\text{since }U\text{ %
is orthogonal}</annotation><annotation encoding="application/x-llamapun" id="A1.Ex4.m1.2d">= ∥ ( roman_Σ - roman_Σ start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ) italic_V start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT italic_x ∥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , since italic_U is orthogonal</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A1.Ex5"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\|\operatorname{diag}(0,\ldots,0,\sigma_{k+1},\ldots,\sigma_{n})%
V^{\top}x\|_{2}" class="ltx_Math" display="inline" id="A1.Ex5.m1.6"><semantics id="A1.Ex5.m1.6a"><mrow id="A1.Ex5.m1.6.6" xref="A1.Ex5.m1.6.6.cmml"><mi id="A1.Ex5.m1.6.6.3" xref="A1.Ex5.m1.6.6.3.cmml"></mi><mo id="A1.Ex5.m1.6.6.2" xref="A1.Ex5.m1.6.6.2.cmml">=</mo><msub id="A1.Ex5.m1.6.6.1" xref="A1.Ex5.m1.6.6.1.cmml"><mrow id="A1.Ex5.m1.6.6.1.1.1" xref="A1.Ex5.m1.6.6.1.1.2.cmml"><mo id="A1.Ex5.m1.6.6.1.1.1.2" stretchy="false" xref="A1.Ex5.m1.6.6.1.1.2.1.cmml">‖</mo><mrow id="A1.Ex5.m1.6.6.1.1.1.1" xref="A1.Ex5.m1.6.6.1.1.1.1.cmml"><mrow id="A1.Ex5.m1.6.6.1.1.1.1.2.2" xref="A1.Ex5.m1.6.6.1.1.1.1.2.3.cmml"><mi id="A1.Ex5.m1.1.1" xref="A1.Ex5.m1.1.1.cmml">diag</mi><mo id="A1.Ex5.m1.6.6.1.1.1.1.2.2a" xref="A1.Ex5.m1.6.6.1.1.1.1.2.3.cmml">⁡</mo><mrow id="A1.Ex5.m1.6.6.1.1.1.1.2.2.2" xref="A1.Ex5.m1.6.6.1.1.1.1.2.3.cmml"><mo id="A1.Ex5.m1.6.6.1.1.1.1.2.2.2.3" stretchy="false" xref="A1.Ex5.m1.6.6.1.1.1.1.2.3.cmml">(</mo><mn id="A1.Ex5.m1.2.2" xref="A1.Ex5.m1.2.2.cmml">0</mn><mo id="A1.Ex5.m1.6.6.1.1.1.1.2.2.2.4" xref="A1.Ex5.m1.6.6.1.1.1.1.2.3.cmml">,</mo><mi id="A1.Ex5.m1.3.3" mathvariant="normal" xref="A1.Ex5.m1.3.3.cmml">…</mi><mo id="A1.Ex5.m1.6.6.1.1.1.1.2.2.2.5" xref="A1.Ex5.m1.6.6.1.1.1.1.2.3.cmml">,</mo><mn id="A1.Ex5.m1.4.4" xref="A1.Ex5.m1.4.4.cmml">0</mn><mo id="A1.Ex5.m1.6.6.1.1.1.1.2.2.2.6" xref="A1.Ex5.m1.6.6.1.1.1.1.2.3.cmml">,</mo><msub id="A1.Ex5.m1.6.6.1.1.1.1.1.1.1.1" xref="A1.Ex5.m1.6.6.1.1.1.1.1.1.1.1.cmml"><mi id="A1.Ex5.m1.6.6.1.1.1.1.1.1.1.1.2" xref="A1.Ex5.m1.6.6.1.1.1.1.1.1.1.1.2.cmml">σ</mi><mrow id="A1.Ex5.m1.6.6.1.1.1.1.1.1.1.1.3" xref="A1.Ex5.m1.6.6.1.1.1.1.1.1.1.1.3.cmml"><mi id="A1.Ex5.m1.6.6.1.1.1.1.1.1.1.1.3.2" xref="A1.Ex5.m1.6.6.1.1.1.1.1.1.1.1.3.2.cmml">k</mi><mo id="A1.Ex5.m1.6.6.1.1.1.1.1.1.1.1.3.1" xref="A1.Ex5.m1.6.6.1.1.1.1.1.1.1.1.3.1.cmml">+</mo><mn id="A1.Ex5.m1.6.6.1.1.1.1.1.1.1.1.3.3" xref="A1.Ex5.m1.6.6.1.1.1.1.1.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="A1.Ex5.m1.6.6.1.1.1.1.2.2.2.7" xref="A1.Ex5.m1.6.6.1.1.1.1.2.3.cmml">,</mo><mi id="A1.Ex5.m1.5.5" mathvariant="normal" xref="A1.Ex5.m1.5.5.cmml">…</mi><mo id="A1.Ex5.m1.6.6.1.1.1.1.2.2.2.8" xref="A1.Ex5.m1.6.6.1.1.1.1.2.3.cmml">,</mo><msub id="A1.Ex5.m1.6.6.1.1.1.1.2.2.2.2" xref="A1.Ex5.m1.6.6.1.1.1.1.2.2.2.2.cmml"><mi id="A1.Ex5.m1.6.6.1.1.1.1.2.2.2.2.2" xref="A1.Ex5.m1.6.6.1.1.1.1.2.2.2.2.2.cmml">σ</mi><mi id="A1.Ex5.m1.6.6.1.1.1.1.2.2.2.2.3" xref="A1.Ex5.m1.6.6.1.1.1.1.2.2.2.2.3.cmml">n</mi></msub><mo id="A1.Ex5.m1.6.6.1.1.1.1.2.2.2.9" stretchy="false" xref="A1.Ex5.m1.6.6.1.1.1.1.2.3.cmml">)</mo></mrow></mrow><mo id="A1.Ex5.m1.6.6.1.1.1.1.3" xref="A1.Ex5.m1.6.6.1.1.1.1.3.cmml">⁢</mo><msup id="A1.Ex5.m1.6.6.1.1.1.1.4" xref="A1.Ex5.m1.6.6.1.1.1.1.4.cmml"><mi id="A1.Ex5.m1.6.6.1.1.1.1.4.2" xref="A1.Ex5.m1.6.6.1.1.1.1.4.2.cmml">V</mi><mo id="A1.Ex5.m1.6.6.1.1.1.1.4.3" xref="A1.Ex5.m1.6.6.1.1.1.1.4.3.cmml">⊤</mo></msup><mo id="A1.Ex5.m1.6.6.1.1.1.1.3a" xref="A1.Ex5.m1.6.6.1.1.1.1.3.cmml">⁢</mo><mi id="A1.Ex5.m1.6.6.1.1.1.1.5" xref="A1.Ex5.m1.6.6.1.1.1.1.5.cmml">x</mi></mrow><mo id="A1.Ex5.m1.6.6.1.1.1.3" stretchy="false" xref="A1.Ex5.m1.6.6.1.1.2.1.cmml">‖</mo></mrow><mn id="A1.Ex5.m1.6.6.1.3" xref="A1.Ex5.m1.6.6.1.3.cmml">2</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex5.m1.6b"><apply id="A1.Ex5.m1.6.6.cmml" xref="A1.Ex5.m1.6.6"><eq id="A1.Ex5.m1.6.6.2.cmml" xref="A1.Ex5.m1.6.6.2"></eq><csymbol cd="latexml" id="A1.Ex5.m1.6.6.3.cmml" xref="A1.Ex5.m1.6.6.3">absent</csymbol><apply id="A1.Ex5.m1.6.6.1.cmml" xref="A1.Ex5.m1.6.6.1"><csymbol cd="ambiguous" id="A1.Ex5.m1.6.6.1.2.cmml" xref="A1.Ex5.m1.6.6.1">subscript</csymbol><apply id="A1.Ex5.m1.6.6.1.1.2.cmml" xref="A1.Ex5.m1.6.6.1.1.1"><csymbol cd="latexml" id="A1.Ex5.m1.6.6.1.1.2.1.cmml" xref="A1.Ex5.m1.6.6.1.1.1.2">norm</csymbol><apply id="A1.Ex5.m1.6.6.1.1.1.1.cmml" xref="A1.Ex5.m1.6.6.1.1.1.1"><times id="A1.Ex5.m1.6.6.1.1.1.1.3.cmml" xref="A1.Ex5.m1.6.6.1.1.1.1.3"></times><apply id="A1.Ex5.m1.6.6.1.1.1.1.2.3.cmml" xref="A1.Ex5.m1.6.6.1.1.1.1.2.2"><ci id="A1.Ex5.m1.1.1.cmml" xref="A1.Ex5.m1.1.1">diag</ci><cn id="A1.Ex5.m1.2.2.cmml" type="integer" xref="A1.Ex5.m1.2.2">0</cn><ci id="A1.Ex5.m1.3.3.cmml" xref="A1.Ex5.m1.3.3">…</ci><cn id="A1.Ex5.m1.4.4.cmml" type="integer" xref="A1.Ex5.m1.4.4">0</cn><apply id="A1.Ex5.m1.6.6.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex5.m1.6.6.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.Ex5.m1.6.6.1.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex5.m1.6.6.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.Ex5.m1.6.6.1.1.1.1.1.1.1.1.2.cmml" xref="A1.Ex5.m1.6.6.1.1.1.1.1.1.1.1.2">𝜎</ci><apply id="A1.Ex5.m1.6.6.1.1.1.1.1.1.1.1.3.cmml" xref="A1.Ex5.m1.6.6.1.1.1.1.1.1.1.1.3"><plus id="A1.Ex5.m1.6.6.1.1.1.1.1.1.1.1.3.1.cmml" xref="A1.Ex5.m1.6.6.1.1.1.1.1.1.1.1.3.1"></plus><ci id="A1.Ex5.m1.6.6.1.1.1.1.1.1.1.1.3.2.cmml" xref="A1.Ex5.m1.6.6.1.1.1.1.1.1.1.1.3.2">𝑘</ci><cn id="A1.Ex5.m1.6.6.1.1.1.1.1.1.1.1.3.3.cmml" type="integer" xref="A1.Ex5.m1.6.6.1.1.1.1.1.1.1.1.3.3">1</cn></apply></apply><ci id="A1.Ex5.m1.5.5.cmml" xref="A1.Ex5.m1.5.5">…</ci><apply id="A1.Ex5.m1.6.6.1.1.1.1.2.2.2.2.cmml" xref="A1.Ex5.m1.6.6.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="A1.Ex5.m1.6.6.1.1.1.1.2.2.2.2.1.cmml" xref="A1.Ex5.m1.6.6.1.1.1.1.2.2.2.2">subscript</csymbol><ci id="A1.Ex5.m1.6.6.1.1.1.1.2.2.2.2.2.cmml" xref="A1.Ex5.m1.6.6.1.1.1.1.2.2.2.2.2">𝜎</ci><ci id="A1.Ex5.m1.6.6.1.1.1.1.2.2.2.2.3.cmml" xref="A1.Ex5.m1.6.6.1.1.1.1.2.2.2.2.3">𝑛</ci></apply></apply><apply id="A1.Ex5.m1.6.6.1.1.1.1.4.cmml" xref="A1.Ex5.m1.6.6.1.1.1.1.4"><csymbol cd="ambiguous" id="A1.Ex5.m1.6.6.1.1.1.1.4.1.cmml" xref="A1.Ex5.m1.6.6.1.1.1.1.4">superscript</csymbol><ci id="A1.Ex5.m1.6.6.1.1.1.1.4.2.cmml" xref="A1.Ex5.m1.6.6.1.1.1.1.4.2">𝑉</ci><csymbol cd="latexml" id="A1.Ex5.m1.6.6.1.1.1.1.4.3.cmml" xref="A1.Ex5.m1.6.6.1.1.1.1.4.3">top</csymbol></apply><ci id="A1.Ex5.m1.6.6.1.1.1.1.5.cmml" xref="A1.Ex5.m1.6.6.1.1.1.1.5">𝑥</ci></apply></apply><cn id="A1.Ex5.m1.6.6.1.3.cmml" type="integer" xref="A1.Ex5.m1.6.6.1.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex5.m1.6c">\displaystyle=\|\operatorname{diag}(0,\ldots,0,\sigma_{k+1},\ldots,\sigma_{n})%
V^{\top}x\|_{2}</annotation><annotation encoding="application/x-llamapun" id="A1.Ex5.m1.6d">= ∥ roman_diag ( 0 , … , 0 , italic_σ start_POSTSUBSCRIPT italic_k + 1 end_POSTSUBSCRIPT , … , italic_σ start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT ) italic_V start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT italic_x ∥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A1.Ex6"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\leq\sigma_{k+1}\|V^{\top}x\|_{2}" class="ltx_Math" display="inline" id="A1.Ex6.m1.1"><semantics id="A1.Ex6.m1.1a"><mrow id="A1.Ex6.m1.1.1" xref="A1.Ex6.m1.1.1.cmml"><mi id="A1.Ex6.m1.1.1.3" xref="A1.Ex6.m1.1.1.3.cmml"></mi><mo id="A1.Ex6.m1.1.1.2" xref="A1.Ex6.m1.1.1.2.cmml">≤</mo><mrow id="A1.Ex6.m1.1.1.1" xref="A1.Ex6.m1.1.1.1.cmml"><msub id="A1.Ex6.m1.1.1.1.3" xref="A1.Ex6.m1.1.1.1.3.cmml"><mi id="A1.Ex6.m1.1.1.1.3.2" xref="A1.Ex6.m1.1.1.1.3.2.cmml">σ</mi><mrow id="A1.Ex6.m1.1.1.1.3.3" xref="A1.Ex6.m1.1.1.1.3.3.cmml"><mi id="A1.Ex6.m1.1.1.1.3.3.2" xref="A1.Ex6.m1.1.1.1.3.3.2.cmml">k</mi><mo id="A1.Ex6.m1.1.1.1.3.3.1" xref="A1.Ex6.m1.1.1.1.3.3.1.cmml">+</mo><mn id="A1.Ex6.m1.1.1.1.3.3.3" xref="A1.Ex6.m1.1.1.1.3.3.3.cmml">1</mn></mrow></msub><mo id="A1.Ex6.m1.1.1.1.2" xref="A1.Ex6.m1.1.1.1.2.cmml">⁢</mo><msub id="A1.Ex6.m1.1.1.1.1" xref="A1.Ex6.m1.1.1.1.1.cmml"><mrow id="A1.Ex6.m1.1.1.1.1.1.1" xref="A1.Ex6.m1.1.1.1.1.1.2.cmml"><mo id="A1.Ex6.m1.1.1.1.1.1.1.2" stretchy="false" xref="A1.Ex6.m1.1.1.1.1.1.2.1.cmml">‖</mo><mrow id="A1.Ex6.m1.1.1.1.1.1.1.1" xref="A1.Ex6.m1.1.1.1.1.1.1.1.cmml"><msup id="A1.Ex6.m1.1.1.1.1.1.1.1.2" xref="A1.Ex6.m1.1.1.1.1.1.1.1.2.cmml"><mi id="A1.Ex6.m1.1.1.1.1.1.1.1.2.2" xref="A1.Ex6.m1.1.1.1.1.1.1.1.2.2.cmml">V</mi><mo id="A1.Ex6.m1.1.1.1.1.1.1.1.2.3" xref="A1.Ex6.m1.1.1.1.1.1.1.1.2.3.cmml">⊤</mo></msup><mo id="A1.Ex6.m1.1.1.1.1.1.1.1.1" xref="A1.Ex6.m1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="A1.Ex6.m1.1.1.1.1.1.1.1.3" xref="A1.Ex6.m1.1.1.1.1.1.1.1.3.cmml">x</mi></mrow><mo id="A1.Ex6.m1.1.1.1.1.1.1.3" stretchy="false" xref="A1.Ex6.m1.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="A1.Ex6.m1.1.1.1.1.3" xref="A1.Ex6.m1.1.1.1.1.3.cmml">2</mn></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex6.m1.1b"><apply id="A1.Ex6.m1.1.1.cmml" xref="A1.Ex6.m1.1.1"><leq id="A1.Ex6.m1.1.1.2.cmml" xref="A1.Ex6.m1.1.1.2"></leq><csymbol cd="latexml" id="A1.Ex6.m1.1.1.3.cmml" xref="A1.Ex6.m1.1.1.3">absent</csymbol><apply id="A1.Ex6.m1.1.1.1.cmml" xref="A1.Ex6.m1.1.1.1"><times id="A1.Ex6.m1.1.1.1.2.cmml" xref="A1.Ex6.m1.1.1.1.2"></times><apply id="A1.Ex6.m1.1.1.1.3.cmml" xref="A1.Ex6.m1.1.1.1.3"><csymbol cd="ambiguous" id="A1.Ex6.m1.1.1.1.3.1.cmml" xref="A1.Ex6.m1.1.1.1.3">subscript</csymbol><ci id="A1.Ex6.m1.1.1.1.3.2.cmml" xref="A1.Ex6.m1.1.1.1.3.2">𝜎</ci><apply id="A1.Ex6.m1.1.1.1.3.3.cmml" xref="A1.Ex6.m1.1.1.1.3.3"><plus id="A1.Ex6.m1.1.1.1.3.3.1.cmml" xref="A1.Ex6.m1.1.1.1.3.3.1"></plus><ci id="A1.Ex6.m1.1.1.1.3.3.2.cmml" xref="A1.Ex6.m1.1.1.1.3.3.2">𝑘</ci><cn id="A1.Ex6.m1.1.1.1.3.3.3.cmml" type="integer" xref="A1.Ex6.m1.1.1.1.3.3.3">1</cn></apply></apply><apply id="A1.Ex6.m1.1.1.1.1.cmml" xref="A1.Ex6.m1.1.1.1.1"><csymbol cd="ambiguous" id="A1.Ex6.m1.1.1.1.1.2.cmml" xref="A1.Ex6.m1.1.1.1.1">subscript</csymbol><apply id="A1.Ex6.m1.1.1.1.1.1.2.cmml" xref="A1.Ex6.m1.1.1.1.1.1.1"><csymbol cd="latexml" id="A1.Ex6.m1.1.1.1.1.1.2.1.cmml" xref="A1.Ex6.m1.1.1.1.1.1.1.2">norm</csymbol><apply id="A1.Ex6.m1.1.1.1.1.1.1.1.cmml" xref="A1.Ex6.m1.1.1.1.1.1.1.1"><times id="A1.Ex6.m1.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex6.m1.1.1.1.1.1.1.1.1"></times><apply id="A1.Ex6.m1.1.1.1.1.1.1.1.2.cmml" xref="A1.Ex6.m1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.Ex6.m1.1.1.1.1.1.1.1.2.1.cmml" xref="A1.Ex6.m1.1.1.1.1.1.1.1.2">superscript</csymbol><ci id="A1.Ex6.m1.1.1.1.1.1.1.1.2.2.cmml" xref="A1.Ex6.m1.1.1.1.1.1.1.1.2.2">𝑉</ci><csymbol cd="latexml" id="A1.Ex6.m1.1.1.1.1.1.1.1.2.3.cmml" xref="A1.Ex6.m1.1.1.1.1.1.1.1.2.3">top</csymbol></apply><ci id="A1.Ex6.m1.1.1.1.1.1.1.1.3.cmml" xref="A1.Ex6.m1.1.1.1.1.1.1.1.3">𝑥</ci></apply></apply><cn id="A1.Ex6.m1.1.1.1.1.3.cmml" type="integer" xref="A1.Ex6.m1.1.1.1.1.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex6.m1.1c">\displaystyle\leq\sigma_{k+1}\|V^{\top}x\|_{2}</annotation><annotation encoding="application/x-llamapun" id="A1.Ex6.m1.1d">≤ italic_σ start_POSTSUBSCRIPT italic_k + 1 end_POSTSUBSCRIPT ∥ italic_V start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT italic_x ∥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A1.Ex7"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\sigma_{k+1}\|x\|_{2},\quad\text{since }V\text{ is orthogonal}." class="ltx_Math" display="inline" id="A1.Ex7.m1.2"><semantics id="A1.Ex7.m1.2a"><mrow id="A1.Ex7.m1.2.2.1" xref="A1.Ex7.m1.2.2.1.1.cmml"><mrow id="A1.Ex7.m1.2.2.1.1" xref="A1.Ex7.m1.2.2.1.1.cmml"><mi id="A1.Ex7.m1.2.2.1.1.4" xref="A1.Ex7.m1.2.2.1.1.4.cmml"></mi><mo id="A1.Ex7.m1.2.2.1.1.3" xref="A1.Ex7.m1.2.2.1.1.3.cmml">=</mo><mrow id="A1.Ex7.m1.2.2.1.1.2.2" xref="A1.Ex7.m1.2.2.1.1.2.3.cmml"><mrow id="A1.Ex7.m1.2.2.1.1.1.1.1" xref="A1.Ex7.m1.2.2.1.1.1.1.1.cmml"><msub id="A1.Ex7.m1.2.2.1.1.1.1.1.2" xref="A1.Ex7.m1.2.2.1.1.1.1.1.2.cmml"><mi id="A1.Ex7.m1.2.2.1.1.1.1.1.2.2" xref="A1.Ex7.m1.2.2.1.1.1.1.1.2.2.cmml">σ</mi><mrow id="A1.Ex7.m1.2.2.1.1.1.1.1.2.3" xref="A1.Ex7.m1.2.2.1.1.1.1.1.2.3.cmml"><mi id="A1.Ex7.m1.2.2.1.1.1.1.1.2.3.2" xref="A1.Ex7.m1.2.2.1.1.1.1.1.2.3.2.cmml">k</mi><mo id="A1.Ex7.m1.2.2.1.1.1.1.1.2.3.1" xref="A1.Ex7.m1.2.2.1.1.1.1.1.2.3.1.cmml">+</mo><mn id="A1.Ex7.m1.2.2.1.1.1.1.1.2.3.3" xref="A1.Ex7.m1.2.2.1.1.1.1.1.2.3.3.cmml">1</mn></mrow></msub><mo id="A1.Ex7.m1.2.2.1.1.1.1.1.1" xref="A1.Ex7.m1.2.2.1.1.1.1.1.1.cmml">⁢</mo><msub id="A1.Ex7.m1.2.2.1.1.1.1.1.3" xref="A1.Ex7.m1.2.2.1.1.1.1.1.3.cmml"><mrow id="A1.Ex7.m1.2.2.1.1.1.1.1.3.2.2" xref="A1.Ex7.m1.2.2.1.1.1.1.1.3.2.1.cmml"><mo id="A1.Ex7.m1.2.2.1.1.1.1.1.3.2.2.1" stretchy="false" xref="A1.Ex7.m1.2.2.1.1.1.1.1.3.2.1.1.cmml">‖</mo><mi id="A1.Ex7.m1.1.1" xref="A1.Ex7.m1.1.1.cmml">x</mi><mo id="A1.Ex7.m1.2.2.1.1.1.1.1.3.2.2.2" stretchy="false" xref="A1.Ex7.m1.2.2.1.1.1.1.1.3.2.1.1.cmml">‖</mo></mrow><mn id="A1.Ex7.m1.2.2.1.1.1.1.1.3.3" xref="A1.Ex7.m1.2.2.1.1.1.1.1.3.3.cmml">2</mn></msub></mrow><mo id="A1.Ex7.m1.2.2.1.1.2.2.3" rspace="1.167em" xref="A1.Ex7.m1.2.2.1.1.2.3.cmml">,</mo><mrow id="A1.Ex7.m1.2.2.1.1.2.2.2" xref="A1.Ex7.m1.2.2.1.1.2.2.2.cmml"><mtext id="A1.Ex7.m1.2.2.1.1.2.2.2.2" xref="A1.Ex7.m1.2.2.1.1.2.2.2.2a.cmml">since </mtext><mo id="A1.Ex7.m1.2.2.1.1.2.2.2.1" xref="A1.Ex7.m1.2.2.1.1.2.2.2.1.cmml">⁢</mo><mi id="A1.Ex7.m1.2.2.1.1.2.2.2.3" xref="A1.Ex7.m1.2.2.1.1.2.2.2.3.cmml">V</mi><mo id="A1.Ex7.m1.2.2.1.1.2.2.2.1a" xref="A1.Ex7.m1.2.2.1.1.2.2.2.1.cmml">⁢</mo><mtext id="A1.Ex7.m1.2.2.1.1.2.2.2.4" xref="A1.Ex7.m1.2.2.1.1.2.2.2.4a.cmml"> is orthogonal</mtext></mrow></mrow></mrow><mo id="A1.Ex7.m1.2.2.1.2" lspace="0em" xref="A1.Ex7.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex7.m1.2b"><apply id="A1.Ex7.m1.2.2.1.1.cmml" xref="A1.Ex7.m1.2.2.1"><eq id="A1.Ex7.m1.2.2.1.1.3.cmml" xref="A1.Ex7.m1.2.2.1.1.3"></eq><csymbol cd="latexml" id="A1.Ex7.m1.2.2.1.1.4.cmml" xref="A1.Ex7.m1.2.2.1.1.4">absent</csymbol><list id="A1.Ex7.m1.2.2.1.1.2.3.cmml" xref="A1.Ex7.m1.2.2.1.1.2.2"><apply id="A1.Ex7.m1.2.2.1.1.1.1.1.cmml" xref="A1.Ex7.m1.2.2.1.1.1.1.1"><times id="A1.Ex7.m1.2.2.1.1.1.1.1.1.cmml" xref="A1.Ex7.m1.2.2.1.1.1.1.1.1"></times><apply id="A1.Ex7.m1.2.2.1.1.1.1.1.2.cmml" xref="A1.Ex7.m1.2.2.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.Ex7.m1.2.2.1.1.1.1.1.2.1.cmml" xref="A1.Ex7.m1.2.2.1.1.1.1.1.2">subscript</csymbol><ci id="A1.Ex7.m1.2.2.1.1.1.1.1.2.2.cmml" xref="A1.Ex7.m1.2.2.1.1.1.1.1.2.2">𝜎</ci><apply id="A1.Ex7.m1.2.2.1.1.1.1.1.2.3.cmml" xref="A1.Ex7.m1.2.2.1.1.1.1.1.2.3"><plus id="A1.Ex7.m1.2.2.1.1.1.1.1.2.3.1.cmml" xref="A1.Ex7.m1.2.2.1.1.1.1.1.2.3.1"></plus><ci id="A1.Ex7.m1.2.2.1.1.1.1.1.2.3.2.cmml" xref="A1.Ex7.m1.2.2.1.1.1.1.1.2.3.2">𝑘</ci><cn id="A1.Ex7.m1.2.2.1.1.1.1.1.2.3.3.cmml" type="integer" xref="A1.Ex7.m1.2.2.1.1.1.1.1.2.3.3">1</cn></apply></apply><apply id="A1.Ex7.m1.2.2.1.1.1.1.1.3.cmml" xref="A1.Ex7.m1.2.2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.Ex7.m1.2.2.1.1.1.1.1.3.1.cmml" xref="A1.Ex7.m1.2.2.1.1.1.1.1.3">subscript</csymbol><apply id="A1.Ex7.m1.2.2.1.1.1.1.1.3.2.1.cmml" xref="A1.Ex7.m1.2.2.1.1.1.1.1.3.2.2"><csymbol cd="latexml" id="A1.Ex7.m1.2.2.1.1.1.1.1.3.2.1.1.cmml" xref="A1.Ex7.m1.2.2.1.1.1.1.1.3.2.2.1">norm</csymbol><ci id="A1.Ex7.m1.1.1.cmml" xref="A1.Ex7.m1.1.1">𝑥</ci></apply><cn id="A1.Ex7.m1.2.2.1.1.1.1.1.3.3.cmml" type="integer" xref="A1.Ex7.m1.2.2.1.1.1.1.1.3.3">2</cn></apply></apply><apply id="A1.Ex7.m1.2.2.1.1.2.2.2.cmml" xref="A1.Ex7.m1.2.2.1.1.2.2.2"><times id="A1.Ex7.m1.2.2.1.1.2.2.2.1.cmml" xref="A1.Ex7.m1.2.2.1.1.2.2.2.1"></times><ci id="A1.Ex7.m1.2.2.1.1.2.2.2.2a.cmml" xref="A1.Ex7.m1.2.2.1.1.2.2.2.2"><mtext id="A1.Ex7.m1.2.2.1.1.2.2.2.2.cmml" xref="A1.Ex7.m1.2.2.1.1.2.2.2.2">since </mtext></ci><ci id="A1.Ex7.m1.2.2.1.1.2.2.2.3.cmml" xref="A1.Ex7.m1.2.2.1.1.2.2.2.3">𝑉</ci><ci id="A1.Ex7.m1.2.2.1.1.2.2.2.4a.cmml" xref="A1.Ex7.m1.2.2.1.1.2.2.2.4"><mtext id="A1.Ex7.m1.2.2.1.1.2.2.2.4.cmml" xref="A1.Ex7.m1.2.2.1.1.2.2.2.4"> is orthogonal</mtext></ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex7.m1.2c">\displaystyle=\sigma_{k+1}\|x\|_{2},\quad\text{since }V\text{ is orthogonal}.</annotation><annotation encoding="application/x-llamapun" id="A1.Ex7.m1.2d">= italic_σ start_POSTSUBSCRIPT italic_k + 1 end_POSTSUBSCRIPT ∥ italic_x ∥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , since italic_V is orthogonal .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="A1.SS1.p8">
<p class="ltx_p" id="A1.SS1.p8.1"><math alttext="\square" class="ltx_Math" display="inline" id="A1.SS1.p8.1.m1.1"><semantics id="A1.SS1.p8.1.m1.1a"><mi id="A1.SS1.p8.1.m1.1.1" mathvariant="normal" xref="A1.SS1.p8.1.m1.1.1.cmml">□</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.p8.1.m1.1b"><ci id="A1.SS1.p8.1.m1.1.1.cmml" xref="A1.SS1.p8.1.m1.1.1">□</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p8.1.m1.1c">\square</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p8.1.m1.1d">□</annotation></semantics></math></p>
</div>
</section>
<section class="ltx_subsection" id="A1.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.2 </span>Proof of Theorem <a class="ltx_ref" href="https://arxiv.org/html/2410.03111v1#Thmtheorem3" title="Theorem 3 ‣ 5.3 Error Propagation Bound ‣ 5 Error Bounds for KV Cache Compression ‣ LoRC: Low-Rank Compression for LLMs KV Cache with a Progressive Compression Strategy"><span class="ltx_text ltx_ref_tag">3</span></a>
</h3>
<div class="ltx_para" id="A1.SS2.p1">
<p class="ltx_p" id="A1.SS2.p1.1"><span class="ltx_text ltx_font_bold" id="A1.SS2.p1.1.1">Proof.</span></p>
</div>
<div class="ltx_para" id="A1.SS2.p2">
<p class="ltx_p" id="A1.SS2.p2.3">Let <math alttext="x_{i}" class="ltx_Math" display="inline" id="A1.SS2.p2.1.m1.1"><semantics id="A1.SS2.p2.1.m1.1a"><msub id="A1.SS2.p2.1.m1.1.1" xref="A1.SS2.p2.1.m1.1.1.cmml"><mi id="A1.SS2.p2.1.m1.1.1.2" xref="A1.SS2.p2.1.m1.1.1.2.cmml">x</mi><mi id="A1.SS2.p2.1.m1.1.1.3" xref="A1.SS2.p2.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS2.p2.1.m1.1b"><apply id="A1.SS2.p2.1.m1.1.1.cmml" xref="A1.SS2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="A1.SS2.p2.1.m1.1.1.1.cmml" xref="A1.SS2.p2.1.m1.1.1">subscript</csymbol><ci id="A1.SS2.p2.1.m1.1.1.2.cmml" xref="A1.SS2.p2.1.m1.1.1.2">𝑥</ci><ci id="A1.SS2.p2.1.m1.1.1.3.cmml" xref="A1.SS2.p2.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p2.1.m1.1c">x_{i}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p2.1.m1.1d">italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\tilde{x}_{i}" class="ltx_Math" display="inline" id="A1.SS2.p2.2.m2.1"><semantics id="A1.SS2.p2.2.m2.1a"><msub id="A1.SS2.p2.2.m2.1.1" xref="A1.SS2.p2.2.m2.1.1.cmml"><mover accent="true" id="A1.SS2.p2.2.m2.1.1.2" xref="A1.SS2.p2.2.m2.1.1.2.cmml"><mi id="A1.SS2.p2.2.m2.1.1.2.2" xref="A1.SS2.p2.2.m2.1.1.2.2.cmml">x</mi><mo id="A1.SS2.p2.2.m2.1.1.2.1" xref="A1.SS2.p2.2.m2.1.1.2.1.cmml">~</mo></mover><mi id="A1.SS2.p2.2.m2.1.1.3" xref="A1.SS2.p2.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS2.p2.2.m2.1b"><apply id="A1.SS2.p2.2.m2.1.1.cmml" xref="A1.SS2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="A1.SS2.p2.2.m2.1.1.1.cmml" xref="A1.SS2.p2.2.m2.1.1">subscript</csymbol><apply id="A1.SS2.p2.2.m2.1.1.2.cmml" xref="A1.SS2.p2.2.m2.1.1.2"><ci id="A1.SS2.p2.2.m2.1.1.2.1.cmml" xref="A1.SS2.p2.2.m2.1.1.2.1">~</ci><ci id="A1.SS2.p2.2.m2.1.1.2.2.cmml" xref="A1.SS2.p2.2.m2.1.1.2.2">𝑥</ci></apply><ci id="A1.SS2.p2.2.m2.1.1.3.cmml" xref="A1.SS2.p2.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p2.2.m2.1c">\tilde{x}_{i}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p2.2.m2.1d">over~ start_ARG italic_x end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> denote the outputs of the <math alttext="i" class="ltx_Math" display="inline" id="A1.SS2.p2.3.m3.1"><semantics id="A1.SS2.p2.3.m3.1a"><mi id="A1.SS2.p2.3.m3.1.1" xref="A1.SS2.p2.3.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.p2.3.m3.1b"><ci id="A1.SS2.p2.3.m3.1.1.cmml" xref="A1.SS2.p2.3.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p2.3.m3.1c">i</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p2.3.m3.1d">italic_i</annotation></semantics></math>-th layer in the original and compressed networks, respectively. We prove by induction that:</p>
</div>
<div class="ltx_para" id="A1.SS2.p3">
<table class="ltx_equation ltx_eqn_table" id="A1.E17">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\|x_{i}-\tilde{x}_{i}\|_{2}\leq\sum_{s=1}^{i}\left(\sigma_{k_{s}+1}^{(s)}L_{%
\phi}^{i-s}\prod_{j=s+1}^{i}\|W_{j}\|_{2}\right)." class="ltx_Math" display="block" id="A1.E17.m1.2"><semantics id="A1.E17.m1.2a"><mrow id="A1.E17.m1.2.2.1" xref="A1.E17.m1.2.2.1.1.cmml"><mrow id="A1.E17.m1.2.2.1.1" xref="A1.E17.m1.2.2.1.1.cmml"><msub id="A1.E17.m1.2.2.1.1.1" xref="A1.E17.m1.2.2.1.1.1.cmml"><mrow id="A1.E17.m1.2.2.1.1.1.1.1" xref="A1.E17.m1.2.2.1.1.1.1.2.cmml"><mo id="A1.E17.m1.2.2.1.1.1.1.1.2" stretchy="false" xref="A1.E17.m1.2.2.1.1.1.1.2.1.cmml">‖</mo><mrow id="A1.E17.m1.2.2.1.1.1.1.1.1" xref="A1.E17.m1.2.2.1.1.1.1.1.1.cmml"><msub id="A1.E17.m1.2.2.1.1.1.1.1.1.2" xref="A1.E17.m1.2.2.1.1.1.1.1.1.2.cmml"><mi id="A1.E17.m1.2.2.1.1.1.1.1.1.2.2" xref="A1.E17.m1.2.2.1.1.1.1.1.1.2.2.cmml">x</mi><mi id="A1.E17.m1.2.2.1.1.1.1.1.1.2.3" xref="A1.E17.m1.2.2.1.1.1.1.1.1.2.3.cmml">i</mi></msub><mo id="A1.E17.m1.2.2.1.1.1.1.1.1.1" xref="A1.E17.m1.2.2.1.1.1.1.1.1.1.cmml">−</mo><msub id="A1.E17.m1.2.2.1.1.1.1.1.1.3" xref="A1.E17.m1.2.2.1.1.1.1.1.1.3.cmml"><mover accent="true" id="A1.E17.m1.2.2.1.1.1.1.1.1.3.2" xref="A1.E17.m1.2.2.1.1.1.1.1.1.3.2.cmml"><mi id="A1.E17.m1.2.2.1.1.1.1.1.1.3.2.2" xref="A1.E17.m1.2.2.1.1.1.1.1.1.3.2.2.cmml">x</mi><mo id="A1.E17.m1.2.2.1.1.1.1.1.1.3.2.1" xref="A1.E17.m1.2.2.1.1.1.1.1.1.3.2.1.cmml">~</mo></mover><mi id="A1.E17.m1.2.2.1.1.1.1.1.1.3.3" xref="A1.E17.m1.2.2.1.1.1.1.1.1.3.3.cmml">i</mi></msub></mrow><mo id="A1.E17.m1.2.2.1.1.1.1.1.3" stretchy="false" xref="A1.E17.m1.2.2.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="A1.E17.m1.2.2.1.1.1.3" xref="A1.E17.m1.2.2.1.1.1.3.cmml">2</mn></msub><mo id="A1.E17.m1.2.2.1.1.3" rspace="0.111em" xref="A1.E17.m1.2.2.1.1.3.cmml">≤</mo><mrow id="A1.E17.m1.2.2.1.1.2" xref="A1.E17.m1.2.2.1.1.2.cmml"><munderover id="A1.E17.m1.2.2.1.1.2.2" xref="A1.E17.m1.2.2.1.1.2.2.cmml"><mo id="A1.E17.m1.2.2.1.1.2.2.2.2" movablelimits="false" rspace="0em" xref="A1.E17.m1.2.2.1.1.2.2.2.2.cmml">∑</mo><mrow id="A1.E17.m1.2.2.1.1.2.2.2.3" xref="A1.E17.m1.2.2.1.1.2.2.2.3.cmml"><mi id="A1.E17.m1.2.2.1.1.2.2.2.3.2" xref="A1.E17.m1.2.2.1.1.2.2.2.3.2.cmml">s</mi><mo id="A1.E17.m1.2.2.1.1.2.2.2.3.1" xref="A1.E17.m1.2.2.1.1.2.2.2.3.1.cmml">=</mo><mn id="A1.E17.m1.2.2.1.1.2.2.2.3.3" xref="A1.E17.m1.2.2.1.1.2.2.2.3.3.cmml">1</mn></mrow><mi id="A1.E17.m1.2.2.1.1.2.2.3" xref="A1.E17.m1.2.2.1.1.2.2.3.cmml">i</mi></munderover><mrow id="A1.E17.m1.2.2.1.1.2.1.1" xref="A1.E17.m1.2.2.1.1.2.1.1.1.cmml"><mo id="A1.E17.m1.2.2.1.1.2.1.1.2" xref="A1.E17.m1.2.2.1.1.2.1.1.1.cmml">(</mo><mrow id="A1.E17.m1.2.2.1.1.2.1.1.1" xref="A1.E17.m1.2.2.1.1.2.1.1.1.cmml"><msubsup id="A1.E17.m1.2.2.1.1.2.1.1.1.3" xref="A1.E17.m1.2.2.1.1.2.1.1.1.3.cmml"><mi id="A1.E17.m1.2.2.1.1.2.1.1.1.3.2.2" xref="A1.E17.m1.2.2.1.1.2.1.1.1.3.2.2.cmml">σ</mi><mrow id="A1.E17.m1.2.2.1.1.2.1.1.1.3.2.3" xref="A1.E17.m1.2.2.1.1.2.1.1.1.3.2.3.cmml"><msub id="A1.E17.m1.2.2.1.1.2.1.1.1.3.2.3.2" xref="A1.E17.m1.2.2.1.1.2.1.1.1.3.2.3.2.cmml"><mi id="A1.E17.m1.2.2.1.1.2.1.1.1.3.2.3.2.2" xref="A1.E17.m1.2.2.1.1.2.1.1.1.3.2.3.2.2.cmml">k</mi><mi id="A1.E17.m1.2.2.1.1.2.1.1.1.3.2.3.2.3" xref="A1.E17.m1.2.2.1.1.2.1.1.1.3.2.3.2.3.cmml">s</mi></msub><mo id="A1.E17.m1.2.2.1.1.2.1.1.1.3.2.3.1" xref="A1.E17.m1.2.2.1.1.2.1.1.1.3.2.3.1.cmml">+</mo><mn id="A1.E17.m1.2.2.1.1.2.1.1.1.3.2.3.3" xref="A1.E17.m1.2.2.1.1.2.1.1.1.3.2.3.3.cmml">1</mn></mrow><mrow id="A1.E17.m1.1.1.1.3" xref="A1.E17.m1.2.2.1.1.2.1.1.1.3.cmml"><mo id="A1.E17.m1.1.1.1.3.1" stretchy="false" xref="A1.E17.m1.2.2.1.1.2.1.1.1.3.cmml">(</mo><mi id="A1.E17.m1.1.1.1.1" xref="A1.E17.m1.1.1.1.1.cmml">s</mi><mo id="A1.E17.m1.1.1.1.3.2" stretchy="false" xref="A1.E17.m1.2.2.1.1.2.1.1.1.3.cmml">)</mo></mrow></msubsup><mo id="A1.E17.m1.2.2.1.1.2.1.1.1.2" xref="A1.E17.m1.2.2.1.1.2.1.1.1.2.cmml">⁢</mo><msubsup id="A1.E17.m1.2.2.1.1.2.1.1.1.4" xref="A1.E17.m1.2.2.1.1.2.1.1.1.4.cmml"><mi id="A1.E17.m1.2.2.1.1.2.1.1.1.4.2.2" xref="A1.E17.m1.2.2.1.1.2.1.1.1.4.2.2.cmml">L</mi><mi id="A1.E17.m1.2.2.1.1.2.1.1.1.4.2.3" xref="A1.E17.m1.2.2.1.1.2.1.1.1.4.2.3.cmml">ϕ</mi><mrow id="A1.E17.m1.2.2.1.1.2.1.1.1.4.3" xref="A1.E17.m1.2.2.1.1.2.1.1.1.4.3.cmml"><mi id="A1.E17.m1.2.2.1.1.2.1.1.1.4.3.2" xref="A1.E17.m1.2.2.1.1.2.1.1.1.4.3.2.cmml">i</mi><mo id="A1.E17.m1.2.2.1.1.2.1.1.1.4.3.1" xref="A1.E17.m1.2.2.1.1.2.1.1.1.4.3.1.cmml">−</mo><mi id="A1.E17.m1.2.2.1.1.2.1.1.1.4.3.3" xref="A1.E17.m1.2.2.1.1.2.1.1.1.4.3.3.cmml">s</mi></mrow></msubsup><mo id="A1.E17.m1.2.2.1.1.2.1.1.1.2a" xref="A1.E17.m1.2.2.1.1.2.1.1.1.2.cmml">⁢</mo><mrow id="A1.E17.m1.2.2.1.1.2.1.1.1.1" xref="A1.E17.m1.2.2.1.1.2.1.1.1.1.cmml"><munderover id="A1.E17.m1.2.2.1.1.2.1.1.1.1.2" xref="A1.E17.m1.2.2.1.1.2.1.1.1.1.2.cmml"><mo id="A1.E17.m1.2.2.1.1.2.1.1.1.1.2.2.2" movablelimits="false" rspace="0em" xref="A1.E17.m1.2.2.1.1.2.1.1.1.1.2.2.2.cmml">∏</mo><mrow id="A1.E17.m1.2.2.1.1.2.1.1.1.1.2.2.3" xref="A1.E17.m1.2.2.1.1.2.1.1.1.1.2.2.3.cmml"><mi id="A1.E17.m1.2.2.1.1.2.1.1.1.1.2.2.3.2" xref="A1.E17.m1.2.2.1.1.2.1.1.1.1.2.2.3.2.cmml">j</mi><mo id="A1.E17.m1.2.2.1.1.2.1.1.1.1.2.2.3.1" xref="A1.E17.m1.2.2.1.1.2.1.1.1.1.2.2.3.1.cmml">=</mo><mrow id="A1.E17.m1.2.2.1.1.2.1.1.1.1.2.2.3.3" xref="A1.E17.m1.2.2.1.1.2.1.1.1.1.2.2.3.3.cmml"><mi id="A1.E17.m1.2.2.1.1.2.1.1.1.1.2.2.3.3.2" xref="A1.E17.m1.2.2.1.1.2.1.1.1.1.2.2.3.3.2.cmml">s</mi><mo id="A1.E17.m1.2.2.1.1.2.1.1.1.1.2.2.3.3.1" xref="A1.E17.m1.2.2.1.1.2.1.1.1.1.2.2.3.3.1.cmml">+</mo><mn id="A1.E17.m1.2.2.1.1.2.1.1.1.1.2.2.3.3.3" xref="A1.E17.m1.2.2.1.1.2.1.1.1.1.2.2.3.3.3.cmml">1</mn></mrow></mrow><mi id="A1.E17.m1.2.2.1.1.2.1.1.1.1.2.3" xref="A1.E17.m1.2.2.1.1.2.1.1.1.1.2.3.cmml">i</mi></munderover><msub id="A1.E17.m1.2.2.1.1.2.1.1.1.1.1" xref="A1.E17.m1.2.2.1.1.2.1.1.1.1.1.cmml"><mrow id="A1.E17.m1.2.2.1.1.2.1.1.1.1.1.1.1" xref="A1.E17.m1.2.2.1.1.2.1.1.1.1.1.1.2.cmml"><mo id="A1.E17.m1.2.2.1.1.2.1.1.1.1.1.1.1.2" stretchy="false" xref="A1.E17.m1.2.2.1.1.2.1.1.1.1.1.1.2.1.cmml">‖</mo><msub id="A1.E17.m1.2.2.1.1.2.1.1.1.1.1.1.1.1" xref="A1.E17.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.cmml"><mi id="A1.E17.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.2" xref="A1.E17.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.2.cmml">W</mi><mi id="A1.E17.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.3" xref="A1.E17.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.3.cmml">j</mi></msub><mo id="A1.E17.m1.2.2.1.1.2.1.1.1.1.1.1.1.3" stretchy="false" xref="A1.E17.m1.2.2.1.1.2.1.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="A1.E17.m1.2.2.1.1.2.1.1.1.1.1.3" xref="A1.E17.m1.2.2.1.1.2.1.1.1.1.1.3.cmml">2</mn></msub></mrow></mrow><mo id="A1.E17.m1.2.2.1.1.2.1.1.3" xref="A1.E17.m1.2.2.1.1.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="A1.E17.m1.2.2.1.2" lspace="0em" xref="A1.E17.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.E17.m1.2b"><apply id="A1.E17.m1.2.2.1.1.cmml" xref="A1.E17.m1.2.2.1"><leq id="A1.E17.m1.2.2.1.1.3.cmml" xref="A1.E17.m1.2.2.1.1.3"></leq><apply id="A1.E17.m1.2.2.1.1.1.cmml" xref="A1.E17.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="A1.E17.m1.2.2.1.1.1.2.cmml" xref="A1.E17.m1.2.2.1.1.1">subscript</csymbol><apply id="A1.E17.m1.2.2.1.1.1.1.2.cmml" xref="A1.E17.m1.2.2.1.1.1.1.1"><csymbol cd="latexml" id="A1.E17.m1.2.2.1.1.1.1.2.1.cmml" xref="A1.E17.m1.2.2.1.1.1.1.1.2">norm</csymbol><apply id="A1.E17.m1.2.2.1.1.1.1.1.1.cmml" xref="A1.E17.m1.2.2.1.1.1.1.1.1"><minus id="A1.E17.m1.2.2.1.1.1.1.1.1.1.cmml" xref="A1.E17.m1.2.2.1.1.1.1.1.1.1"></minus><apply id="A1.E17.m1.2.2.1.1.1.1.1.1.2.cmml" xref="A1.E17.m1.2.2.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.E17.m1.2.2.1.1.1.1.1.1.2.1.cmml" xref="A1.E17.m1.2.2.1.1.1.1.1.1.2">subscript</csymbol><ci id="A1.E17.m1.2.2.1.1.1.1.1.1.2.2.cmml" xref="A1.E17.m1.2.2.1.1.1.1.1.1.2.2">𝑥</ci><ci id="A1.E17.m1.2.2.1.1.1.1.1.1.2.3.cmml" xref="A1.E17.m1.2.2.1.1.1.1.1.1.2.3">𝑖</ci></apply><apply id="A1.E17.m1.2.2.1.1.1.1.1.1.3.cmml" xref="A1.E17.m1.2.2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.E17.m1.2.2.1.1.1.1.1.1.3.1.cmml" xref="A1.E17.m1.2.2.1.1.1.1.1.1.3">subscript</csymbol><apply id="A1.E17.m1.2.2.1.1.1.1.1.1.3.2.cmml" xref="A1.E17.m1.2.2.1.1.1.1.1.1.3.2"><ci id="A1.E17.m1.2.2.1.1.1.1.1.1.3.2.1.cmml" xref="A1.E17.m1.2.2.1.1.1.1.1.1.3.2.1">~</ci><ci id="A1.E17.m1.2.2.1.1.1.1.1.1.3.2.2.cmml" xref="A1.E17.m1.2.2.1.1.1.1.1.1.3.2.2">𝑥</ci></apply><ci id="A1.E17.m1.2.2.1.1.1.1.1.1.3.3.cmml" xref="A1.E17.m1.2.2.1.1.1.1.1.1.3.3">𝑖</ci></apply></apply></apply><cn id="A1.E17.m1.2.2.1.1.1.3.cmml" type="integer" xref="A1.E17.m1.2.2.1.1.1.3">2</cn></apply><apply id="A1.E17.m1.2.2.1.1.2.cmml" xref="A1.E17.m1.2.2.1.1.2"><apply id="A1.E17.m1.2.2.1.1.2.2.cmml" xref="A1.E17.m1.2.2.1.1.2.2"><csymbol cd="ambiguous" id="A1.E17.m1.2.2.1.1.2.2.1.cmml" xref="A1.E17.m1.2.2.1.1.2.2">superscript</csymbol><apply id="A1.E17.m1.2.2.1.1.2.2.2.cmml" xref="A1.E17.m1.2.2.1.1.2.2"><csymbol cd="ambiguous" id="A1.E17.m1.2.2.1.1.2.2.2.1.cmml" xref="A1.E17.m1.2.2.1.1.2.2">subscript</csymbol><sum id="A1.E17.m1.2.2.1.1.2.2.2.2.cmml" xref="A1.E17.m1.2.2.1.1.2.2.2.2"></sum><apply id="A1.E17.m1.2.2.1.1.2.2.2.3.cmml" xref="A1.E17.m1.2.2.1.1.2.2.2.3"><eq id="A1.E17.m1.2.2.1.1.2.2.2.3.1.cmml" xref="A1.E17.m1.2.2.1.1.2.2.2.3.1"></eq><ci id="A1.E17.m1.2.2.1.1.2.2.2.3.2.cmml" xref="A1.E17.m1.2.2.1.1.2.2.2.3.2">𝑠</ci><cn id="A1.E17.m1.2.2.1.1.2.2.2.3.3.cmml" type="integer" xref="A1.E17.m1.2.2.1.1.2.2.2.3.3">1</cn></apply></apply><ci id="A1.E17.m1.2.2.1.1.2.2.3.cmml" xref="A1.E17.m1.2.2.1.1.2.2.3">𝑖</ci></apply><apply id="A1.E17.m1.2.2.1.1.2.1.1.1.cmml" xref="A1.E17.m1.2.2.1.1.2.1.1"><times id="A1.E17.m1.2.2.1.1.2.1.1.1.2.cmml" xref="A1.E17.m1.2.2.1.1.2.1.1.1.2"></times><apply id="A1.E17.m1.2.2.1.1.2.1.1.1.3.cmml" xref="A1.E17.m1.2.2.1.1.2.1.1.1.3"><csymbol cd="ambiguous" id="A1.E17.m1.2.2.1.1.2.1.1.1.3.1.cmml" xref="A1.E17.m1.2.2.1.1.2.1.1.1.3">superscript</csymbol><apply id="A1.E17.m1.2.2.1.1.2.1.1.1.3.2.cmml" xref="A1.E17.m1.2.2.1.1.2.1.1.1.3"><csymbol cd="ambiguous" id="A1.E17.m1.2.2.1.1.2.1.1.1.3.2.1.cmml" xref="A1.E17.m1.2.2.1.1.2.1.1.1.3">subscript</csymbol><ci id="A1.E17.m1.2.2.1.1.2.1.1.1.3.2.2.cmml" xref="A1.E17.m1.2.2.1.1.2.1.1.1.3.2.2">𝜎</ci><apply id="A1.E17.m1.2.2.1.1.2.1.1.1.3.2.3.cmml" xref="A1.E17.m1.2.2.1.1.2.1.1.1.3.2.3"><plus id="A1.E17.m1.2.2.1.1.2.1.1.1.3.2.3.1.cmml" xref="A1.E17.m1.2.2.1.1.2.1.1.1.3.2.3.1"></plus><apply id="A1.E17.m1.2.2.1.1.2.1.1.1.3.2.3.2.cmml" xref="A1.E17.m1.2.2.1.1.2.1.1.1.3.2.3.2"><csymbol cd="ambiguous" id="A1.E17.m1.2.2.1.1.2.1.1.1.3.2.3.2.1.cmml" xref="A1.E17.m1.2.2.1.1.2.1.1.1.3.2.3.2">subscript</csymbol><ci id="A1.E17.m1.2.2.1.1.2.1.1.1.3.2.3.2.2.cmml" xref="A1.E17.m1.2.2.1.1.2.1.1.1.3.2.3.2.2">𝑘</ci><ci id="A1.E17.m1.2.2.1.1.2.1.1.1.3.2.3.2.3.cmml" xref="A1.E17.m1.2.2.1.1.2.1.1.1.3.2.3.2.3">𝑠</ci></apply><cn id="A1.E17.m1.2.2.1.1.2.1.1.1.3.2.3.3.cmml" type="integer" xref="A1.E17.m1.2.2.1.1.2.1.1.1.3.2.3.3">1</cn></apply></apply><ci id="A1.E17.m1.1.1.1.1.cmml" xref="A1.E17.m1.1.1.1.1">𝑠</ci></apply><apply id="A1.E17.m1.2.2.1.1.2.1.1.1.4.cmml" xref="A1.E17.m1.2.2.1.1.2.1.1.1.4"><csymbol cd="ambiguous" id="A1.E17.m1.2.2.1.1.2.1.1.1.4.1.cmml" xref="A1.E17.m1.2.2.1.1.2.1.1.1.4">superscript</csymbol><apply id="A1.E17.m1.2.2.1.1.2.1.1.1.4.2.cmml" xref="A1.E17.m1.2.2.1.1.2.1.1.1.4"><csymbol cd="ambiguous" id="A1.E17.m1.2.2.1.1.2.1.1.1.4.2.1.cmml" xref="A1.E17.m1.2.2.1.1.2.1.1.1.4">subscript</csymbol><ci id="A1.E17.m1.2.2.1.1.2.1.1.1.4.2.2.cmml" xref="A1.E17.m1.2.2.1.1.2.1.1.1.4.2.2">𝐿</ci><ci id="A1.E17.m1.2.2.1.1.2.1.1.1.4.2.3.cmml" xref="A1.E17.m1.2.2.1.1.2.1.1.1.4.2.3">italic-ϕ</ci></apply><apply id="A1.E17.m1.2.2.1.1.2.1.1.1.4.3.cmml" xref="A1.E17.m1.2.2.1.1.2.1.1.1.4.3"><minus id="A1.E17.m1.2.2.1.1.2.1.1.1.4.3.1.cmml" xref="A1.E17.m1.2.2.1.1.2.1.1.1.4.3.1"></minus><ci id="A1.E17.m1.2.2.1.1.2.1.1.1.4.3.2.cmml" xref="A1.E17.m1.2.2.1.1.2.1.1.1.4.3.2">𝑖</ci><ci id="A1.E17.m1.2.2.1.1.2.1.1.1.4.3.3.cmml" xref="A1.E17.m1.2.2.1.1.2.1.1.1.4.3.3">𝑠</ci></apply></apply><apply id="A1.E17.m1.2.2.1.1.2.1.1.1.1.cmml" xref="A1.E17.m1.2.2.1.1.2.1.1.1.1"><apply id="A1.E17.m1.2.2.1.1.2.1.1.1.1.2.cmml" xref="A1.E17.m1.2.2.1.1.2.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.E17.m1.2.2.1.1.2.1.1.1.1.2.1.cmml" xref="A1.E17.m1.2.2.1.1.2.1.1.1.1.2">superscript</csymbol><apply id="A1.E17.m1.2.2.1.1.2.1.1.1.1.2.2.cmml" xref="A1.E17.m1.2.2.1.1.2.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.E17.m1.2.2.1.1.2.1.1.1.1.2.2.1.cmml" xref="A1.E17.m1.2.2.1.1.2.1.1.1.1.2">subscript</csymbol><csymbol cd="latexml" id="A1.E17.m1.2.2.1.1.2.1.1.1.1.2.2.2.cmml" xref="A1.E17.m1.2.2.1.1.2.1.1.1.1.2.2.2">product</csymbol><apply id="A1.E17.m1.2.2.1.1.2.1.1.1.1.2.2.3.cmml" xref="A1.E17.m1.2.2.1.1.2.1.1.1.1.2.2.3"><eq id="A1.E17.m1.2.2.1.1.2.1.1.1.1.2.2.3.1.cmml" xref="A1.E17.m1.2.2.1.1.2.1.1.1.1.2.2.3.1"></eq><ci id="A1.E17.m1.2.2.1.1.2.1.1.1.1.2.2.3.2.cmml" xref="A1.E17.m1.2.2.1.1.2.1.1.1.1.2.2.3.2">𝑗</ci><apply id="A1.E17.m1.2.2.1.1.2.1.1.1.1.2.2.3.3.cmml" xref="A1.E17.m1.2.2.1.1.2.1.1.1.1.2.2.3.3"><plus id="A1.E17.m1.2.2.1.1.2.1.1.1.1.2.2.3.3.1.cmml" xref="A1.E17.m1.2.2.1.1.2.1.1.1.1.2.2.3.3.1"></plus><ci id="A1.E17.m1.2.2.1.1.2.1.1.1.1.2.2.3.3.2.cmml" xref="A1.E17.m1.2.2.1.1.2.1.1.1.1.2.2.3.3.2">𝑠</ci><cn id="A1.E17.m1.2.2.1.1.2.1.1.1.1.2.2.3.3.3.cmml" type="integer" xref="A1.E17.m1.2.2.1.1.2.1.1.1.1.2.2.3.3.3">1</cn></apply></apply></apply><ci id="A1.E17.m1.2.2.1.1.2.1.1.1.1.2.3.cmml" xref="A1.E17.m1.2.2.1.1.2.1.1.1.1.2.3">𝑖</ci></apply><apply id="A1.E17.m1.2.2.1.1.2.1.1.1.1.1.cmml" xref="A1.E17.m1.2.2.1.1.2.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E17.m1.2.2.1.1.2.1.1.1.1.1.2.cmml" xref="A1.E17.m1.2.2.1.1.2.1.1.1.1.1">subscript</csymbol><apply id="A1.E17.m1.2.2.1.1.2.1.1.1.1.1.1.2.cmml" xref="A1.E17.m1.2.2.1.1.2.1.1.1.1.1.1.1"><csymbol cd="latexml" id="A1.E17.m1.2.2.1.1.2.1.1.1.1.1.1.2.1.cmml" xref="A1.E17.m1.2.2.1.1.2.1.1.1.1.1.1.1.2">norm</csymbol><apply id="A1.E17.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.cmml" xref="A1.E17.m1.2.2.1.1.2.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E17.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E17.m1.2.2.1.1.2.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.E17.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E17.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.2">𝑊</ci><ci id="A1.E17.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.3.cmml" xref="A1.E17.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.3">𝑗</ci></apply></apply><cn id="A1.E17.m1.2.2.1.1.2.1.1.1.1.1.3.cmml" type="integer" xref="A1.E17.m1.2.2.1.1.2.1.1.1.1.1.3">2</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E17.m1.2c">\|x_{i}-\tilde{x}_{i}\|_{2}\leq\sum_{s=1}^{i}\left(\sigma_{k_{s}+1}^{(s)}L_{%
\phi}^{i-s}\prod_{j=s+1}^{i}\|W_{j}\|_{2}\right).</annotation><annotation encoding="application/x-llamapun" id="A1.E17.m1.2d">∥ italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT - over~ start_ARG italic_x end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ≤ ∑ start_POSTSUBSCRIPT italic_s = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT ( italic_σ start_POSTSUBSCRIPT italic_k start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT + 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_s ) end_POSTSUPERSCRIPT italic_L start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i - italic_s end_POSTSUPERSCRIPT ∏ start_POSTSUBSCRIPT italic_j = italic_s + 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT ∥ italic_W start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ∥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(17)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="A1.SS2.p4">
<p class="ltx_p" id="A1.SS2.p4.1"><span class="ltx_text ltx_font_bold" id="A1.SS2.p4.1.1">Base Case (<math alttext="i=1" class="ltx_Math" display="inline" id="A1.SS2.p4.1.1.m1.1"><semantics id="A1.SS2.p4.1.1.m1.1a"><mrow id="A1.SS2.p4.1.1.m1.1.1" xref="A1.SS2.p4.1.1.m1.1.1.cmml"><mi id="A1.SS2.p4.1.1.m1.1.1.2" xref="A1.SS2.p4.1.1.m1.1.1.2.cmml">i</mi><mo id="A1.SS2.p4.1.1.m1.1.1.1" xref="A1.SS2.p4.1.1.m1.1.1.1.cmml">=</mo><mn id="A1.SS2.p4.1.1.m1.1.1.3" xref="A1.SS2.p4.1.1.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p4.1.1.m1.1b"><apply id="A1.SS2.p4.1.1.m1.1.1.cmml" xref="A1.SS2.p4.1.1.m1.1.1"><eq id="A1.SS2.p4.1.1.m1.1.1.1.cmml" xref="A1.SS2.p4.1.1.m1.1.1.1"></eq><ci id="A1.SS2.p4.1.1.m1.1.1.2.cmml" xref="A1.SS2.p4.1.1.m1.1.1.2">𝑖</ci><cn id="A1.SS2.p4.1.1.m1.1.1.3.cmml" type="integer" xref="A1.SS2.p4.1.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p4.1.1.m1.1c">i=1</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p4.1.1.m1.1d">italic_i = 1</annotation></semantics></math>).</span></p>
</div>
<div class="ltx_para" id="A1.SS2.p5">
<p class="ltx_p" id="A1.SS2.p5.1">Using Theorem 1 and the Lipschitz property of <math alttext="\phi" class="ltx_Math" display="inline" id="A1.SS2.p5.1.m1.1"><semantics id="A1.SS2.p5.1.m1.1a"><mi id="A1.SS2.p5.1.m1.1.1" xref="A1.SS2.p5.1.m1.1.1.cmml">ϕ</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.p5.1.m1.1b"><ci id="A1.SS2.p5.1.m1.1.1.cmml" xref="A1.SS2.p5.1.m1.1.1">italic-ϕ</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p5.1.m1.1c">\phi</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p5.1.m1.1d">italic_ϕ</annotation></semantics></math>:</p>
</div>
<div class="ltx_para" id="A1.SS2.p6">
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A4.EGx2">
<tbody id="A1.Ex8"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\|x_{1}-\tilde{x}_{1}\|_{2}" class="ltx_Math" display="inline" id="A1.Ex8.m1.1"><semantics id="A1.Ex8.m1.1a"><msub id="A1.Ex8.m1.1.1" xref="A1.Ex8.m1.1.1.cmml"><mrow id="A1.Ex8.m1.1.1.1.1" xref="A1.Ex8.m1.1.1.1.2.cmml"><mo id="A1.Ex8.m1.1.1.1.1.2" stretchy="false" xref="A1.Ex8.m1.1.1.1.2.1.cmml">‖</mo><mrow id="A1.Ex8.m1.1.1.1.1.1" xref="A1.Ex8.m1.1.1.1.1.1.cmml"><msub id="A1.Ex8.m1.1.1.1.1.1.2" xref="A1.Ex8.m1.1.1.1.1.1.2.cmml"><mi id="A1.Ex8.m1.1.1.1.1.1.2.2" xref="A1.Ex8.m1.1.1.1.1.1.2.2.cmml">x</mi><mn id="A1.Ex8.m1.1.1.1.1.1.2.3" xref="A1.Ex8.m1.1.1.1.1.1.2.3.cmml">1</mn></msub><mo id="A1.Ex8.m1.1.1.1.1.1.1" xref="A1.Ex8.m1.1.1.1.1.1.1.cmml">−</mo><msub id="A1.Ex8.m1.1.1.1.1.1.3" xref="A1.Ex8.m1.1.1.1.1.1.3.cmml"><mover accent="true" id="A1.Ex8.m1.1.1.1.1.1.3.2" xref="A1.Ex8.m1.1.1.1.1.1.3.2.cmml"><mi id="A1.Ex8.m1.1.1.1.1.1.3.2.2" xref="A1.Ex8.m1.1.1.1.1.1.3.2.2.cmml">x</mi><mo id="A1.Ex8.m1.1.1.1.1.1.3.2.1" xref="A1.Ex8.m1.1.1.1.1.1.3.2.1.cmml">~</mo></mover><mn id="A1.Ex8.m1.1.1.1.1.1.3.3" xref="A1.Ex8.m1.1.1.1.1.1.3.3.cmml">1</mn></msub></mrow><mo id="A1.Ex8.m1.1.1.1.1.3" stretchy="false" xref="A1.Ex8.m1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="A1.Ex8.m1.1.1.3" xref="A1.Ex8.m1.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="A1.Ex8.m1.1b"><apply id="A1.Ex8.m1.1.1.cmml" xref="A1.Ex8.m1.1.1"><csymbol cd="ambiguous" id="A1.Ex8.m1.1.1.2.cmml" xref="A1.Ex8.m1.1.1">subscript</csymbol><apply id="A1.Ex8.m1.1.1.1.2.cmml" xref="A1.Ex8.m1.1.1.1.1"><csymbol cd="latexml" id="A1.Ex8.m1.1.1.1.2.1.cmml" xref="A1.Ex8.m1.1.1.1.1.2">norm</csymbol><apply id="A1.Ex8.m1.1.1.1.1.1.cmml" xref="A1.Ex8.m1.1.1.1.1.1"><minus id="A1.Ex8.m1.1.1.1.1.1.1.cmml" xref="A1.Ex8.m1.1.1.1.1.1.1"></minus><apply id="A1.Ex8.m1.1.1.1.1.1.2.cmml" xref="A1.Ex8.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.Ex8.m1.1.1.1.1.1.2.1.cmml" xref="A1.Ex8.m1.1.1.1.1.1.2">subscript</csymbol><ci id="A1.Ex8.m1.1.1.1.1.1.2.2.cmml" xref="A1.Ex8.m1.1.1.1.1.1.2.2">𝑥</ci><cn id="A1.Ex8.m1.1.1.1.1.1.2.3.cmml" type="integer" xref="A1.Ex8.m1.1.1.1.1.1.2.3">1</cn></apply><apply id="A1.Ex8.m1.1.1.1.1.1.3.cmml" xref="A1.Ex8.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.Ex8.m1.1.1.1.1.1.3.1.cmml" xref="A1.Ex8.m1.1.1.1.1.1.3">subscript</csymbol><apply id="A1.Ex8.m1.1.1.1.1.1.3.2.cmml" xref="A1.Ex8.m1.1.1.1.1.1.3.2"><ci id="A1.Ex8.m1.1.1.1.1.1.3.2.1.cmml" xref="A1.Ex8.m1.1.1.1.1.1.3.2.1">~</ci><ci id="A1.Ex8.m1.1.1.1.1.1.3.2.2.cmml" xref="A1.Ex8.m1.1.1.1.1.1.3.2.2">𝑥</ci></apply><cn id="A1.Ex8.m1.1.1.1.1.1.3.3.cmml" type="integer" xref="A1.Ex8.m1.1.1.1.1.1.3.3">1</cn></apply></apply></apply><cn id="A1.Ex8.m1.1.1.3.cmml" type="integer" xref="A1.Ex8.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex8.m1.1c">\displaystyle\|x_{1}-\tilde{x}_{1}\|_{2}</annotation><annotation encoding="application/x-llamapun" id="A1.Ex8.m1.1d">∥ italic_x start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT - over~ start_ARG italic_x end_ARG start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ∥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\|\phi(W_{1}x_{0})-\phi(\tilde{W}_{1}x_{0})\|_{2}" class="ltx_Math" display="inline" id="A1.Ex8.m2.1"><semantics id="A1.Ex8.m2.1a"><mrow id="A1.Ex8.m2.1.1" xref="A1.Ex8.m2.1.1.cmml"><mi id="A1.Ex8.m2.1.1.3" xref="A1.Ex8.m2.1.1.3.cmml"></mi><mo id="A1.Ex8.m2.1.1.2" xref="A1.Ex8.m2.1.1.2.cmml">=</mo><msub id="A1.Ex8.m2.1.1.1" xref="A1.Ex8.m2.1.1.1.cmml"><mrow id="A1.Ex8.m2.1.1.1.1.1" xref="A1.Ex8.m2.1.1.1.1.2.cmml"><mo id="A1.Ex8.m2.1.1.1.1.1.2" stretchy="false" xref="A1.Ex8.m2.1.1.1.1.2.1.cmml">‖</mo><mrow id="A1.Ex8.m2.1.1.1.1.1.1" xref="A1.Ex8.m2.1.1.1.1.1.1.cmml"><mrow id="A1.Ex8.m2.1.1.1.1.1.1.1" xref="A1.Ex8.m2.1.1.1.1.1.1.1.cmml"><mi id="A1.Ex8.m2.1.1.1.1.1.1.1.3" xref="A1.Ex8.m2.1.1.1.1.1.1.1.3.cmml">ϕ</mi><mo id="A1.Ex8.m2.1.1.1.1.1.1.1.2" xref="A1.Ex8.m2.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.Ex8.m2.1.1.1.1.1.1.1.1.1" xref="A1.Ex8.m2.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="A1.Ex8.m2.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="A1.Ex8.m2.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.Ex8.m2.1.1.1.1.1.1.1.1.1.1" xref="A1.Ex8.m2.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="A1.Ex8.m2.1.1.1.1.1.1.1.1.1.1.2" xref="A1.Ex8.m2.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="A1.Ex8.m2.1.1.1.1.1.1.1.1.1.1.2.2" xref="A1.Ex8.m2.1.1.1.1.1.1.1.1.1.1.2.2.cmml">W</mi><mn id="A1.Ex8.m2.1.1.1.1.1.1.1.1.1.1.2.3" xref="A1.Ex8.m2.1.1.1.1.1.1.1.1.1.1.2.3.cmml">1</mn></msub><mo id="A1.Ex8.m2.1.1.1.1.1.1.1.1.1.1.1" xref="A1.Ex8.m2.1.1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><msub id="A1.Ex8.m2.1.1.1.1.1.1.1.1.1.1.3" xref="A1.Ex8.m2.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="A1.Ex8.m2.1.1.1.1.1.1.1.1.1.1.3.2" xref="A1.Ex8.m2.1.1.1.1.1.1.1.1.1.1.3.2.cmml">x</mi><mn id="A1.Ex8.m2.1.1.1.1.1.1.1.1.1.1.3.3" xref="A1.Ex8.m2.1.1.1.1.1.1.1.1.1.1.3.3.cmml">0</mn></msub></mrow><mo id="A1.Ex8.m2.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="A1.Ex8.m2.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.Ex8.m2.1.1.1.1.1.1.3" xref="A1.Ex8.m2.1.1.1.1.1.1.3.cmml">−</mo><mrow id="A1.Ex8.m2.1.1.1.1.1.1.2" xref="A1.Ex8.m2.1.1.1.1.1.1.2.cmml"><mi id="A1.Ex8.m2.1.1.1.1.1.1.2.3" xref="A1.Ex8.m2.1.1.1.1.1.1.2.3.cmml">ϕ</mi><mo id="A1.Ex8.m2.1.1.1.1.1.1.2.2" xref="A1.Ex8.m2.1.1.1.1.1.1.2.2.cmml">⁢</mo><mrow id="A1.Ex8.m2.1.1.1.1.1.1.2.1.1" xref="A1.Ex8.m2.1.1.1.1.1.1.2.1.1.1.cmml"><mo id="A1.Ex8.m2.1.1.1.1.1.1.2.1.1.2" stretchy="false" xref="A1.Ex8.m2.1.1.1.1.1.1.2.1.1.1.cmml">(</mo><mrow id="A1.Ex8.m2.1.1.1.1.1.1.2.1.1.1" xref="A1.Ex8.m2.1.1.1.1.1.1.2.1.1.1.cmml"><msub id="A1.Ex8.m2.1.1.1.1.1.1.2.1.1.1.2" xref="A1.Ex8.m2.1.1.1.1.1.1.2.1.1.1.2.cmml"><mover accent="true" id="A1.Ex8.m2.1.1.1.1.1.1.2.1.1.1.2.2" xref="A1.Ex8.m2.1.1.1.1.1.1.2.1.1.1.2.2.cmml"><mi id="A1.Ex8.m2.1.1.1.1.1.1.2.1.1.1.2.2.2" xref="A1.Ex8.m2.1.1.1.1.1.1.2.1.1.1.2.2.2.cmml">W</mi><mo id="A1.Ex8.m2.1.1.1.1.1.1.2.1.1.1.2.2.1" xref="A1.Ex8.m2.1.1.1.1.1.1.2.1.1.1.2.2.1.cmml">~</mo></mover><mn id="A1.Ex8.m2.1.1.1.1.1.1.2.1.1.1.2.3" xref="A1.Ex8.m2.1.1.1.1.1.1.2.1.1.1.2.3.cmml">1</mn></msub><mo id="A1.Ex8.m2.1.1.1.1.1.1.2.1.1.1.1" xref="A1.Ex8.m2.1.1.1.1.1.1.2.1.1.1.1.cmml">⁢</mo><msub id="A1.Ex8.m2.1.1.1.1.1.1.2.1.1.1.3" xref="A1.Ex8.m2.1.1.1.1.1.1.2.1.1.1.3.cmml"><mi id="A1.Ex8.m2.1.1.1.1.1.1.2.1.1.1.3.2" xref="A1.Ex8.m2.1.1.1.1.1.1.2.1.1.1.3.2.cmml">x</mi><mn id="A1.Ex8.m2.1.1.1.1.1.1.2.1.1.1.3.3" xref="A1.Ex8.m2.1.1.1.1.1.1.2.1.1.1.3.3.cmml">0</mn></msub></mrow><mo id="A1.Ex8.m2.1.1.1.1.1.1.2.1.1.3" stretchy="false" xref="A1.Ex8.m2.1.1.1.1.1.1.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="A1.Ex8.m2.1.1.1.1.1.3" stretchy="false" xref="A1.Ex8.m2.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="A1.Ex8.m2.1.1.1.3" xref="A1.Ex8.m2.1.1.1.3.cmml">2</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex8.m2.1b"><apply id="A1.Ex8.m2.1.1.cmml" xref="A1.Ex8.m2.1.1"><eq id="A1.Ex8.m2.1.1.2.cmml" xref="A1.Ex8.m2.1.1.2"></eq><csymbol cd="latexml" id="A1.Ex8.m2.1.1.3.cmml" xref="A1.Ex8.m2.1.1.3">absent</csymbol><apply id="A1.Ex8.m2.1.1.1.cmml" xref="A1.Ex8.m2.1.1.1"><csymbol cd="ambiguous" id="A1.Ex8.m2.1.1.1.2.cmml" xref="A1.Ex8.m2.1.1.1">subscript</csymbol><apply id="A1.Ex8.m2.1.1.1.1.2.cmml" xref="A1.Ex8.m2.1.1.1.1.1"><csymbol cd="latexml" id="A1.Ex8.m2.1.1.1.1.2.1.cmml" xref="A1.Ex8.m2.1.1.1.1.1.2">norm</csymbol><apply id="A1.Ex8.m2.1.1.1.1.1.1.cmml" xref="A1.Ex8.m2.1.1.1.1.1.1"><minus id="A1.Ex8.m2.1.1.1.1.1.1.3.cmml" xref="A1.Ex8.m2.1.1.1.1.1.1.3"></minus><apply id="A1.Ex8.m2.1.1.1.1.1.1.1.cmml" xref="A1.Ex8.m2.1.1.1.1.1.1.1"><times id="A1.Ex8.m2.1.1.1.1.1.1.1.2.cmml" xref="A1.Ex8.m2.1.1.1.1.1.1.1.2"></times><ci id="A1.Ex8.m2.1.1.1.1.1.1.1.3.cmml" xref="A1.Ex8.m2.1.1.1.1.1.1.1.3">italic-ϕ</ci><apply id="A1.Ex8.m2.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex8.m2.1.1.1.1.1.1.1.1.1"><times id="A1.Ex8.m2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex8.m2.1.1.1.1.1.1.1.1.1.1.1"></times><apply id="A1.Ex8.m2.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.Ex8.m2.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.Ex8.m2.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="A1.Ex8.m2.1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="A1.Ex8.m2.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="A1.Ex8.m2.1.1.1.1.1.1.1.1.1.1.2.2">𝑊</ci><cn id="A1.Ex8.m2.1.1.1.1.1.1.1.1.1.1.2.3.cmml" type="integer" xref="A1.Ex8.m2.1.1.1.1.1.1.1.1.1.1.2.3">1</cn></apply><apply id="A1.Ex8.m2.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.Ex8.m2.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.Ex8.m2.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="A1.Ex8.m2.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="A1.Ex8.m2.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="A1.Ex8.m2.1.1.1.1.1.1.1.1.1.1.3.2">𝑥</ci><cn id="A1.Ex8.m2.1.1.1.1.1.1.1.1.1.1.3.3.cmml" type="integer" xref="A1.Ex8.m2.1.1.1.1.1.1.1.1.1.1.3.3">0</cn></apply></apply></apply><apply id="A1.Ex8.m2.1.1.1.1.1.1.2.cmml" xref="A1.Ex8.m2.1.1.1.1.1.1.2"><times id="A1.Ex8.m2.1.1.1.1.1.1.2.2.cmml" xref="A1.Ex8.m2.1.1.1.1.1.1.2.2"></times><ci id="A1.Ex8.m2.1.1.1.1.1.1.2.3.cmml" xref="A1.Ex8.m2.1.1.1.1.1.1.2.3">italic-ϕ</ci><apply id="A1.Ex8.m2.1.1.1.1.1.1.2.1.1.1.cmml" xref="A1.Ex8.m2.1.1.1.1.1.1.2.1.1"><times id="A1.Ex8.m2.1.1.1.1.1.1.2.1.1.1.1.cmml" xref="A1.Ex8.m2.1.1.1.1.1.1.2.1.1.1.1"></times><apply id="A1.Ex8.m2.1.1.1.1.1.1.2.1.1.1.2.cmml" xref="A1.Ex8.m2.1.1.1.1.1.1.2.1.1.1.2"><csymbol cd="ambiguous" id="A1.Ex8.m2.1.1.1.1.1.1.2.1.1.1.2.1.cmml" xref="A1.Ex8.m2.1.1.1.1.1.1.2.1.1.1.2">subscript</csymbol><apply id="A1.Ex8.m2.1.1.1.1.1.1.2.1.1.1.2.2.cmml" xref="A1.Ex8.m2.1.1.1.1.1.1.2.1.1.1.2.2"><ci id="A1.Ex8.m2.1.1.1.1.1.1.2.1.1.1.2.2.1.cmml" xref="A1.Ex8.m2.1.1.1.1.1.1.2.1.1.1.2.2.1">~</ci><ci id="A1.Ex8.m2.1.1.1.1.1.1.2.1.1.1.2.2.2.cmml" xref="A1.Ex8.m2.1.1.1.1.1.1.2.1.1.1.2.2.2">𝑊</ci></apply><cn id="A1.Ex8.m2.1.1.1.1.1.1.2.1.1.1.2.3.cmml" type="integer" xref="A1.Ex8.m2.1.1.1.1.1.1.2.1.1.1.2.3">1</cn></apply><apply id="A1.Ex8.m2.1.1.1.1.1.1.2.1.1.1.3.cmml" xref="A1.Ex8.m2.1.1.1.1.1.1.2.1.1.1.3"><csymbol cd="ambiguous" id="A1.Ex8.m2.1.1.1.1.1.1.2.1.1.1.3.1.cmml" xref="A1.Ex8.m2.1.1.1.1.1.1.2.1.1.1.3">subscript</csymbol><ci id="A1.Ex8.m2.1.1.1.1.1.1.2.1.1.1.3.2.cmml" xref="A1.Ex8.m2.1.1.1.1.1.1.2.1.1.1.3.2">𝑥</ci><cn id="A1.Ex8.m2.1.1.1.1.1.1.2.1.1.1.3.3.cmml" type="integer" xref="A1.Ex8.m2.1.1.1.1.1.1.2.1.1.1.3.3">0</cn></apply></apply></apply></apply></apply><cn id="A1.Ex8.m2.1.1.1.3.cmml" type="integer" xref="A1.Ex8.m2.1.1.1.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex8.m2.1c">\displaystyle=\|\phi(W_{1}x_{0})-\phi(\tilde{W}_{1}x_{0})\|_{2}</annotation><annotation encoding="application/x-llamapun" id="A1.Ex8.m2.1d">= ∥ italic_ϕ ( italic_W start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT italic_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ) - italic_ϕ ( over~ start_ARG italic_W end_ARG start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT italic_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ) ∥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A1.Ex9"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\leq L_{\phi}\|W_{1}x_{0}-\tilde{W}_{1}x_{0}\|_{2}" class="ltx_Math" display="inline" id="A1.Ex9.m1.1"><semantics id="A1.Ex9.m1.1a"><mrow id="A1.Ex9.m1.1.1" xref="A1.Ex9.m1.1.1.cmml"><mi id="A1.Ex9.m1.1.1.3" xref="A1.Ex9.m1.1.1.3.cmml"></mi><mo id="A1.Ex9.m1.1.1.2" xref="A1.Ex9.m1.1.1.2.cmml">≤</mo><mrow id="A1.Ex9.m1.1.1.1" xref="A1.Ex9.m1.1.1.1.cmml"><msub id="A1.Ex9.m1.1.1.1.3" xref="A1.Ex9.m1.1.1.1.3.cmml"><mi id="A1.Ex9.m1.1.1.1.3.2" xref="A1.Ex9.m1.1.1.1.3.2.cmml">L</mi><mi id="A1.Ex9.m1.1.1.1.3.3" xref="A1.Ex9.m1.1.1.1.3.3.cmml">ϕ</mi></msub><mo id="A1.Ex9.m1.1.1.1.2" xref="A1.Ex9.m1.1.1.1.2.cmml">⁢</mo><msub id="A1.Ex9.m1.1.1.1.1" xref="A1.Ex9.m1.1.1.1.1.cmml"><mrow id="A1.Ex9.m1.1.1.1.1.1.1" xref="A1.Ex9.m1.1.1.1.1.1.2.cmml"><mo id="A1.Ex9.m1.1.1.1.1.1.1.2" stretchy="false" xref="A1.Ex9.m1.1.1.1.1.1.2.1.cmml">‖</mo><mrow id="A1.Ex9.m1.1.1.1.1.1.1.1" xref="A1.Ex9.m1.1.1.1.1.1.1.1.cmml"><mrow id="A1.Ex9.m1.1.1.1.1.1.1.1.2" xref="A1.Ex9.m1.1.1.1.1.1.1.1.2.cmml"><msub id="A1.Ex9.m1.1.1.1.1.1.1.1.2.2" xref="A1.Ex9.m1.1.1.1.1.1.1.1.2.2.cmml"><mi id="A1.Ex9.m1.1.1.1.1.1.1.1.2.2.2" xref="A1.Ex9.m1.1.1.1.1.1.1.1.2.2.2.cmml">W</mi><mn id="A1.Ex9.m1.1.1.1.1.1.1.1.2.2.3" xref="A1.Ex9.m1.1.1.1.1.1.1.1.2.2.3.cmml">1</mn></msub><mo id="A1.Ex9.m1.1.1.1.1.1.1.1.2.1" xref="A1.Ex9.m1.1.1.1.1.1.1.1.2.1.cmml">⁢</mo><msub id="A1.Ex9.m1.1.1.1.1.1.1.1.2.3" xref="A1.Ex9.m1.1.1.1.1.1.1.1.2.3.cmml"><mi id="A1.Ex9.m1.1.1.1.1.1.1.1.2.3.2" xref="A1.Ex9.m1.1.1.1.1.1.1.1.2.3.2.cmml">x</mi><mn id="A1.Ex9.m1.1.1.1.1.1.1.1.2.3.3" xref="A1.Ex9.m1.1.1.1.1.1.1.1.2.3.3.cmml">0</mn></msub></mrow><mo id="A1.Ex9.m1.1.1.1.1.1.1.1.1" xref="A1.Ex9.m1.1.1.1.1.1.1.1.1.cmml">−</mo><mrow id="A1.Ex9.m1.1.1.1.1.1.1.1.3" xref="A1.Ex9.m1.1.1.1.1.1.1.1.3.cmml"><msub id="A1.Ex9.m1.1.1.1.1.1.1.1.3.2" xref="A1.Ex9.m1.1.1.1.1.1.1.1.3.2.cmml"><mover accent="true" id="A1.Ex9.m1.1.1.1.1.1.1.1.3.2.2" xref="A1.Ex9.m1.1.1.1.1.1.1.1.3.2.2.cmml"><mi id="A1.Ex9.m1.1.1.1.1.1.1.1.3.2.2.2" xref="A1.Ex9.m1.1.1.1.1.1.1.1.3.2.2.2.cmml">W</mi><mo id="A1.Ex9.m1.1.1.1.1.1.1.1.3.2.2.1" xref="A1.Ex9.m1.1.1.1.1.1.1.1.3.2.2.1.cmml">~</mo></mover><mn id="A1.Ex9.m1.1.1.1.1.1.1.1.3.2.3" xref="A1.Ex9.m1.1.1.1.1.1.1.1.3.2.3.cmml">1</mn></msub><mo id="A1.Ex9.m1.1.1.1.1.1.1.1.3.1" xref="A1.Ex9.m1.1.1.1.1.1.1.1.3.1.cmml">⁢</mo><msub id="A1.Ex9.m1.1.1.1.1.1.1.1.3.3" xref="A1.Ex9.m1.1.1.1.1.1.1.1.3.3.cmml"><mi id="A1.Ex9.m1.1.1.1.1.1.1.1.3.3.2" xref="A1.Ex9.m1.1.1.1.1.1.1.1.3.3.2.cmml">x</mi><mn id="A1.Ex9.m1.1.1.1.1.1.1.1.3.3.3" xref="A1.Ex9.m1.1.1.1.1.1.1.1.3.3.3.cmml">0</mn></msub></mrow></mrow><mo id="A1.Ex9.m1.1.1.1.1.1.1.3" stretchy="false" xref="A1.Ex9.m1.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="A1.Ex9.m1.1.1.1.1.3" xref="A1.Ex9.m1.1.1.1.1.3.cmml">2</mn></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex9.m1.1b"><apply id="A1.Ex9.m1.1.1.cmml" xref="A1.Ex9.m1.1.1"><leq id="A1.Ex9.m1.1.1.2.cmml" xref="A1.Ex9.m1.1.1.2"></leq><csymbol cd="latexml" id="A1.Ex9.m1.1.1.3.cmml" xref="A1.Ex9.m1.1.1.3">absent</csymbol><apply id="A1.Ex9.m1.1.1.1.cmml" xref="A1.Ex9.m1.1.1.1"><times id="A1.Ex9.m1.1.1.1.2.cmml" xref="A1.Ex9.m1.1.1.1.2"></times><apply id="A1.Ex9.m1.1.1.1.3.cmml" xref="A1.Ex9.m1.1.1.1.3"><csymbol cd="ambiguous" id="A1.Ex9.m1.1.1.1.3.1.cmml" xref="A1.Ex9.m1.1.1.1.3">subscript</csymbol><ci id="A1.Ex9.m1.1.1.1.3.2.cmml" xref="A1.Ex9.m1.1.1.1.3.2">𝐿</ci><ci id="A1.Ex9.m1.1.1.1.3.3.cmml" xref="A1.Ex9.m1.1.1.1.3.3">italic-ϕ</ci></apply><apply id="A1.Ex9.m1.1.1.1.1.cmml" xref="A1.Ex9.m1.1.1.1.1"><csymbol cd="ambiguous" id="A1.Ex9.m1.1.1.1.1.2.cmml" xref="A1.Ex9.m1.1.1.1.1">subscript</csymbol><apply id="A1.Ex9.m1.1.1.1.1.1.2.cmml" xref="A1.Ex9.m1.1.1.1.1.1.1"><csymbol cd="latexml" id="A1.Ex9.m1.1.1.1.1.1.2.1.cmml" xref="A1.Ex9.m1.1.1.1.1.1.1.2">norm</csymbol><apply id="A1.Ex9.m1.1.1.1.1.1.1.1.cmml" xref="A1.Ex9.m1.1.1.1.1.1.1.1"><minus id="A1.Ex9.m1.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex9.m1.1.1.1.1.1.1.1.1"></minus><apply id="A1.Ex9.m1.1.1.1.1.1.1.1.2.cmml" xref="A1.Ex9.m1.1.1.1.1.1.1.1.2"><times id="A1.Ex9.m1.1.1.1.1.1.1.1.2.1.cmml" xref="A1.Ex9.m1.1.1.1.1.1.1.1.2.1"></times><apply id="A1.Ex9.m1.1.1.1.1.1.1.1.2.2.cmml" xref="A1.Ex9.m1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="A1.Ex9.m1.1.1.1.1.1.1.1.2.2.1.cmml" xref="A1.Ex9.m1.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="A1.Ex9.m1.1.1.1.1.1.1.1.2.2.2.cmml" xref="A1.Ex9.m1.1.1.1.1.1.1.1.2.2.2">𝑊</ci><cn id="A1.Ex9.m1.1.1.1.1.1.1.1.2.2.3.cmml" type="integer" xref="A1.Ex9.m1.1.1.1.1.1.1.1.2.2.3">1</cn></apply><apply id="A1.Ex9.m1.1.1.1.1.1.1.1.2.3.cmml" xref="A1.Ex9.m1.1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="A1.Ex9.m1.1.1.1.1.1.1.1.2.3.1.cmml" xref="A1.Ex9.m1.1.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="A1.Ex9.m1.1.1.1.1.1.1.1.2.3.2.cmml" xref="A1.Ex9.m1.1.1.1.1.1.1.1.2.3.2">𝑥</ci><cn id="A1.Ex9.m1.1.1.1.1.1.1.1.2.3.3.cmml" type="integer" xref="A1.Ex9.m1.1.1.1.1.1.1.1.2.3.3">0</cn></apply></apply><apply id="A1.Ex9.m1.1.1.1.1.1.1.1.3.cmml" xref="A1.Ex9.m1.1.1.1.1.1.1.1.3"><times id="A1.Ex9.m1.1.1.1.1.1.1.1.3.1.cmml" xref="A1.Ex9.m1.1.1.1.1.1.1.1.3.1"></times><apply id="A1.Ex9.m1.1.1.1.1.1.1.1.3.2.cmml" xref="A1.Ex9.m1.1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="A1.Ex9.m1.1.1.1.1.1.1.1.3.2.1.cmml" xref="A1.Ex9.m1.1.1.1.1.1.1.1.3.2">subscript</csymbol><apply id="A1.Ex9.m1.1.1.1.1.1.1.1.3.2.2.cmml" xref="A1.Ex9.m1.1.1.1.1.1.1.1.3.2.2"><ci id="A1.Ex9.m1.1.1.1.1.1.1.1.3.2.2.1.cmml" xref="A1.Ex9.m1.1.1.1.1.1.1.1.3.2.2.1">~</ci><ci id="A1.Ex9.m1.1.1.1.1.1.1.1.3.2.2.2.cmml" xref="A1.Ex9.m1.1.1.1.1.1.1.1.3.2.2.2">𝑊</ci></apply><cn id="A1.Ex9.m1.1.1.1.1.1.1.1.3.2.3.cmml" type="integer" xref="A1.Ex9.m1.1.1.1.1.1.1.1.3.2.3">1</cn></apply><apply id="A1.Ex9.m1.1.1.1.1.1.1.1.3.3.cmml" xref="A1.Ex9.m1.1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="A1.Ex9.m1.1.1.1.1.1.1.1.3.3.1.cmml" xref="A1.Ex9.m1.1.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="A1.Ex9.m1.1.1.1.1.1.1.1.3.3.2.cmml" xref="A1.Ex9.m1.1.1.1.1.1.1.1.3.3.2">𝑥</ci><cn id="A1.Ex9.m1.1.1.1.1.1.1.1.3.3.3.cmml" type="integer" xref="A1.Ex9.m1.1.1.1.1.1.1.1.3.3.3">0</cn></apply></apply></apply></apply><cn id="A1.Ex9.m1.1.1.1.1.3.cmml" type="integer" xref="A1.Ex9.m1.1.1.1.1.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex9.m1.1c">\displaystyle\leq L_{\phi}\|W_{1}x_{0}-\tilde{W}_{1}x_{0}\|_{2}</annotation><annotation encoding="application/x-llamapun" id="A1.Ex9.m1.1d">≤ italic_L start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ∥ italic_W start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT italic_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT - over~ start_ARG italic_W end_ARG start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT italic_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ∥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A1.Ex10"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\leq L_{\phi}\sigma_{k_{1}+1}^{(1)}\|x_{0}\|_{2}." class="ltx_Math" display="inline" id="A1.Ex10.m1.2"><semantics id="A1.Ex10.m1.2a"><mrow id="A1.Ex10.m1.2.2.1" xref="A1.Ex10.m1.2.2.1.1.cmml"><mrow id="A1.Ex10.m1.2.2.1.1" xref="A1.Ex10.m1.2.2.1.1.cmml"><mi id="A1.Ex10.m1.2.2.1.1.3" xref="A1.Ex10.m1.2.2.1.1.3.cmml"></mi><mo id="A1.Ex10.m1.2.2.1.1.2" xref="A1.Ex10.m1.2.2.1.1.2.cmml">≤</mo><mrow id="A1.Ex10.m1.2.2.1.1.1" xref="A1.Ex10.m1.2.2.1.1.1.cmml"><msub id="A1.Ex10.m1.2.2.1.1.1.3" xref="A1.Ex10.m1.2.2.1.1.1.3.cmml"><mi id="A1.Ex10.m1.2.2.1.1.1.3.2" xref="A1.Ex10.m1.2.2.1.1.1.3.2.cmml">L</mi><mi id="A1.Ex10.m1.2.2.1.1.1.3.3" xref="A1.Ex10.m1.2.2.1.1.1.3.3.cmml">ϕ</mi></msub><mo id="A1.Ex10.m1.2.2.1.1.1.2" xref="A1.Ex10.m1.2.2.1.1.1.2.cmml">⁢</mo><msubsup id="A1.Ex10.m1.2.2.1.1.1.4" xref="A1.Ex10.m1.2.2.1.1.1.4.cmml"><mi id="A1.Ex10.m1.2.2.1.1.1.4.2.2" xref="A1.Ex10.m1.2.2.1.1.1.4.2.2.cmml">σ</mi><mrow id="A1.Ex10.m1.2.2.1.1.1.4.2.3" xref="A1.Ex10.m1.2.2.1.1.1.4.2.3.cmml"><msub id="A1.Ex10.m1.2.2.1.1.1.4.2.3.2" xref="A1.Ex10.m1.2.2.1.1.1.4.2.3.2.cmml"><mi id="A1.Ex10.m1.2.2.1.1.1.4.2.3.2.2" xref="A1.Ex10.m1.2.2.1.1.1.4.2.3.2.2.cmml">k</mi><mn id="A1.Ex10.m1.2.2.1.1.1.4.2.3.2.3" xref="A1.Ex10.m1.2.2.1.1.1.4.2.3.2.3.cmml">1</mn></msub><mo id="A1.Ex10.m1.2.2.1.1.1.4.2.3.1" xref="A1.Ex10.m1.2.2.1.1.1.4.2.3.1.cmml">+</mo><mn id="A1.Ex10.m1.2.2.1.1.1.4.2.3.3" xref="A1.Ex10.m1.2.2.1.1.1.4.2.3.3.cmml">1</mn></mrow><mrow id="A1.Ex10.m1.1.1.1.3" xref="A1.Ex10.m1.2.2.1.1.1.4.cmml"><mo id="A1.Ex10.m1.1.1.1.3.1" stretchy="false" xref="A1.Ex10.m1.2.2.1.1.1.4.cmml">(</mo><mn id="A1.Ex10.m1.1.1.1.1" xref="A1.Ex10.m1.1.1.1.1.cmml">1</mn><mo id="A1.Ex10.m1.1.1.1.3.2" stretchy="false" xref="A1.Ex10.m1.2.2.1.1.1.4.cmml">)</mo></mrow></msubsup><mo id="A1.Ex10.m1.2.2.1.1.1.2a" xref="A1.Ex10.m1.2.2.1.1.1.2.cmml">⁢</mo><msub id="A1.Ex10.m1.2.2.1.1.1.1" xref="A1.Ex10.m1.2.2.1.1.1.1.cmml"><mrow id="A1.Ex10.m1.2.2.1.1.1.1.1.1" xref="A1.Ex10.m1.2.2.1.1.1.1.1.2.cmml"><mo id="A1.Ex10.m1.2.2.1.1.1.1.1.1.2" stretchy="false" xref="A1.Ex10.m1.2.2.1.1.1.1.1.2.1.cmml">‖</mo><msub id="A1.Ex10.m1.2.2.1.1.1.1.1.1.1" xref="A1.Ex10.m1.2.2.1.1.1.1.1.1.1.cmml"><mi id="A1.Ex10.m1.2.2.1.1.1.1.1.1.1.2" xref="A1.Ex10.m1.2.2.1.1.1.1.1.1.1.2.cmml">x</mi><mn id="A1.Ex10.m1.2.2.1.1.1.1.1.1.1.3" xref="A1.Ex10.m1.2.2.1.1.1.1.1.1.1.3.cmml">0</mn></msub><mo id="A1.Ex10.m1.2.2.1.1.1.1.1.1.3" stretchy="false" xref="A1.Ex10.m1.2.2.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="A1.Ex10.m1.2.2.1.1.1.1.3" xref="A1.Ex10.m1.2.2.1.1.1.1.3.cmml">2</mn></msub></mrow></mrow><mo id="A1.Ex10.m1.2.2.1.2" lspace="0em" xref="A1.Ex10.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex10.m1.2b"><apply id="A1.Ex10.m1.2.2.1.1.cmml" xref="A1.Ex10.m1.2.2.1"><leq id="A1.Ex10.m1.2.2.1.1.2.cmml" xref="A1.Ex10.m1.2.2.1.1.2"></leq><csymbol cd="latexml" id="A1.Ex10.m1.2.2.1.1.3.cmml" xref="A1.Ex10.m1.2.2.1.1.3">absent</csymbol><apply id="A1.Ex10.m1.2.2.1.1.1.cmml" xref="A1.Ex10.m1.2.2.1.1.1"><times id="A1.Ex10.m1.2.2.1.1.1.2.cmml" xref="A1.Ex10.m1.2.2.1.1.1.2"></times><apply id="A1.Ex10.m1.2.2.1.1.1.3.cmml" xref="A1.Ex10.m1.2.2.1.1.1.3"><csymbol cd="ambiguous" id="A1.Ex10.m1.2.2.1.1.1.3.1.cmml" xref="A1.Ex10.m1.2.2.1.1.1.3">subscript</csymbol><ci id="A1.Ex10.m1.2.2.1.1.1.3.2.cmml" xref="A1.Ex10.m1.2.2.1.1.1.3.2">𝐿</ci><ci id="A1.Ex10.m1.2.2.1.1.1.3.3.cmml" xref="A1.Ex10.m1.2.2.1.1.1.3.3">italic-ϕ</ci></apply><apply id="A1.Ex10.m1.2.2.1.1.1.4.cmml" xref="A1.Ex10.m1.2.2.1.1.1.4"><csymbol cd="ambiguous" id="A1.Ex10.m1.2.2.1.1.1.4.1.cmml" xref="A1.Ex10.m1.2.2.1.1.1.4">superscript</csymbol><apply id="A1.Ex10.m1.2.2.1.1.1.4.2.cmml" xref="A1.Ex10.m1.2.2.1.1.1.4"><csymbol cd="ambiguous" id="A1.Ex10.m1.2.2.1.1.1.4.2.1.cmml" xref="A1.Ex10.m1.2.2.1.1.1.4">subscript</csymbol><ci id="A1.Ex10.m1.2.2.1.1.1.4.2.2.cmml" xref="A1.Ex10.m1.2.2.1.1.1.4.2.2">𝜎</ci><apply id="A1.Ex10.m1.2.2.1.1.1.4.2.3.cmml" xref="A1.Ex10.m1.2.2.1.1.1.4.2.3"><plus id="A1.Ex10.m1.2.2.1.1.1.4.2.3.1.cmml" xref="A1.Ex10.m1.2.2.1.1.1.4.2.3.1"></plus><apply id="A1.Ex10.m1.2.2.1.1.1.4.2.3.2.cmml" xref="A1.Ex10.m1.2.2.1.1.1.4.2.3.2"><csymbol cd="ambiguous" id="A1.Ex10.m1.2.2.1.1.1.4.2.3.2.1.cmml" xref="A1.Ex10.m1.2.2.1.1.1.4.2.3.2">subscript</csymbol><ci id="A1.Ex10.m1.2.2.1.1.1.4.2.3.2.2.cmml" xref="A1.Ex10.m1.2.2.1.1.1.4.2.3.2.2">𝑘</ci><cn id="A1.Ex10.m1.2.2.1.1.1.4.2.3.2.3.cmml" type="integer" xref="A1.Ex10.m1.2.2.1.1.1.4.2.3.2.3">1</cn></apply><cn id="A1.Ex10.m1.2.2.1.1.1.4.2.3.3.cmml" type="integer" xref="A1.Ex10.m1.2.2.1.1.1.4.2.3.3">1</cn></apply></apply><cn id="A1.Ex10.m1.1.1.1.1.cmml" type="integer" xref="A1.Ex10.m1.1.1.1.1">1</cn></apply><apply id="A1.Ex10.m1.2.2.1.1.1.1.cmml" xref="A1.Ex10.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="A1.Ex10.m1.2.2.1.1.1.1.2.cmml" xref="A1.Ex10.m1.2.2.1.1.1.1">subscript</csymbol><apply id="A1.Ex10.m1.2.2.1.1.1.1.1.2.cmml" xref="A1.Ex10.m1.2.2.1.1.1.1.1.1"><csymbol cd="latexml" id="A1.Ex10.m1.2.2.1.1.1.1.1.2.1.cmml" xref="A1.Ex10.m1.2.2.1.1.1.1.1.1.2">norm</csymbol><apply id="A1.Ex10.m1.2.2.1.1.1.1.1.1.1.cmml" xref="A1.Ex10.m1.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.Ex10.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex10.m1.2.2.1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.Ex10.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="A1.Ex10.m1.2.2.1.1.1.1.1.1.1.2">𝑥</ci><cn id="A1.Ex10.m1.2.2.1.1.1.1.1.1.1.3.cmml" type="integer" xref="A1.Ex10.m1.2.2.1.1.1.1.1.1.1.3">0</cn></apply></apply><cn id="A1.Ex10.m1.2.2.1.1.1.1.3.cmml" type="integer" xref="A1.Ex10.m1.2.2.1.1.1.1.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex10.m1.2c">\displaystyle\leq L_{\phi}\sigma_{k_{1}+1}^{(1)}\|x_{0}\|_{2}.</annotation><annotation encoding="application/x-llamapun" id="A1.Ex10.m1.2d">≤ italic_L start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT italic_σ start_POSTSUBSCRIPT italic_k start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT + 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( 1 ) end_POSTSUPERSCRIPT ∥ italic_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ∥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="A1.SS2.p7">
<p class="ltx_p" id="A1.SS2.p7.1"><span class="ltx_text ltx_font_bold" id="A1.SS2.p7.1.1">Inductive Step.</span></p>
</div>
<div class="ltx_para" id="A1.SS2.p8">
<p class="ltx_p" id="A1.SS2.p8.2">Assume the inductive bound holds for layer <math alttext="i-1" class="ltx_Math" display="inline" id="A1.SS2.p8.1.m1.1"><semantics id="A1.SS2.p8.1.m1.1a"><mrow id="A1.SS2.p8.1.m1.1.1" xref="A1.SS2.p8.1.m1.1.1.cmml"><mi id="A1.SS2.p8.1.m1.1.1.2" xref="A1.SS2.p8.1.m1.1.1.2.cmml">i</mi><mo id="A1.SS2.p8.1.m1.1.1.1" xref="A1.SS2.p8.1.m1.1.1.1.cmml">−</mo><mn id="A1.SS2.p8.1.m1.1.1.3" xref="A1.SS2.p8.1.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p8.1.m1.1b"><apply id="A1.SS2.p8.1.m1.1.1.cmml" xref="A1.SS2.p8.1.m1.1.1"><minus id="A1.SS2.p8.1.m1.1.1.1.cmml" xref="A1.SS2.p8.1.m1.1.1.1"></minus><ci id="A1.SS2.p8.1.m1.1.1.2.cmml" xref="A1.SS2.p8.1.m1.1.1.2">𝑖</ci><cn id="A1.SS2.p8.1.m1.1.1.3.cmml" type="integer" xref="A1.SS2.p8.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p8.1.m1.1c">i-1</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p8.1.m1.1d">italic_i - 1</annotation></semantics></math>. For layer <math alttext="i" class="ltx_Math" display="inline" id="A1.SS2.p8.2.m2.1"><semantics id="A1.SS2.p8.2.m2.1a"><mi id="A1.SS2.p8.2.m2.1.1" xref="A1.SS2.p8.2.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.p8.2.m2.1b"><ci id="A1.SS2.p8.2.m2.1.1.cmml" xref="A1.SS2.p8.2.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p8.2.m2.1c">i</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p8.2.m2.1d">italic_i</annotation></semantics></math>:</p>
</div>
<div class="ltx_para" id="A1.SS2.p9">
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A4.EGx3">
<tbody id="A1.Ex11"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\|x_{i}-\tilde{x}_{i}\|_{2}" class="ltx_Math" display="inline" id="A1.Ex11.m1.1"><semantics id="A1.Ex11.m1.1a"><msub id="A1.Ex11.m1.1.1" xref="A1.Ex11.m1.1.1.cmml"><mrow id="A1.Ex11.m1.1.1.1.1" xref="A1.Ex11.m1.1.1.1.2.cmml"><mo id="A1.Ex11.m1.1.1.1.1.2" stretchy="false" xref="A1.Ex11.m1.1.1.1.2.1.cmml">‖</mo><mrow id="A1.Ex11.m1.1.1.1.1.1" xref="A1.Ex11.m1.1.1.1.1.1.cmml"><msub id="A1.Ex11.m1.1.1.1.1.1.2" xref="A1.Ex11.m1.1.1.1.1.1.2.cmml"><mi id="A1.Ex11.m1.1.1.1.1.1.2.2" xref="A1.Ex11.m1.1.1.1.1.1.2.2.cmml">x</mi><mi id="A1.Ex11.m1.1.1.1.1.1.2.3" xref="A1.Ex11.m1.1.1.1.1.1.2.3.cmml">i</mi></msub><mo id="A1.Ex11.m1.1.1.1.1.1.1" xref="A1.Ex11.m1.1.1.1.1.1.1.cmml">−</mo><msub id="A1.Ex11.m1.1.1.1.1.1.3" xref="A1.Ex11.m1.1.1.1.1.1.3.cmml"><mover accent="true" id="A1.Ex11.m1.1.1.1.1.1.3.2" xref="A1.Ex11.m1.1.1.1.1.1.3.2.cmml"><mi id="A1.Ex11.m1.1.1.1.1.1.3.2.2" xref="A1.Ex11.m1.1.1.1.1.1.3.2.2.cmml">x</mi><mo id="A1.Ex11.m1.1.1.1.1.1.3.2.1" xref="A1.Ex11.m1.1.1.1.1.1.3.2.1.cmml">~</mo></mover><mi id="A1.Ex11.m1.1.1.1.1.1.3.3" xref="A1.Ex11.m1.1.1.1.1.1.3.3.cmml">i</mi></msub></mrow><mo id="A1.Ex11.m1.1.1.1.1.3" stretchy="false" xref="A1.Ex11.m1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="A1.Ex11.m1.1.1.3" xref="A1.Ex11.m1.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="A1.Ex11.m1.1b"><apply id="A1.Ex11.m1.1.1.cmml" xref="A1.Ex11.m1.1.1"><csymbol cd="ambiguous" id="A1.Ex11.m1.1.1.2.cmml" xref="A1.Ex11.m1.1.1">subscript</csymbol><apply id="A1.Ex11.m1.1.1.1.2.cmml" xref="A1.Ex11.m1.1.1.1.1"><csymbol cd="latexml" id="A1.Ex11.m1.1.1.1.2.1.cmml" xref="A1.Ex11.m1.1.1.1.1.2">norm</csymbol><apply id="A1.Ex11.m1.1.1.1.1.1.cmml" xref="A1.Ex11.m1.1.1.1.1.1"><minus id="A1.Ex11.m1.1.1.1.1.1.1.cmml" xref="A1.Ex11.m1.1.1.1.1.1.1"></minus><apply id="A1.Ex11.m1.1.1.1.1.1.2.cmml" xref="A1.Ex11.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.Ex11.m1.1.1.1.1.1.2.1.cmml" xref="A1.Ex11.m1.1.1.1.1.1.2">subscript</csymbol><ci id="A1.Ex11.m1.1.1.1.1.1.2.2.cmml" xref="A1.Ex11.m1.1.1.1.1.1.2.2">𝑥</ci><ci id="A1.Ex11.m1.1.1.1.1.1.2.3.cmml" xref="A1.Ex11.m1.1.1.1.1.1.2.3">𝑖</ci></apply><apply id="A1.Ex11.m1.1.1.1.1.1.3.cmml" xref="A1.Ex11.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.Ex11.m1.1.1.1.1.1.3.1.cmml" xref="A1.Ex11.m1.1.1.1.1.1.3">subscript</csymbol><apply id="A1.Ex11.m1.1.1.1.1.1.3.2.cmml" xref="A1.Ex11.m1.1.1.1.1.1.3.2"><ci id="A1.Ex11.m1.1.1.1.1.1.3.2.1.cmml" xref="A1.Ex11.m1.1.1.1.1.1.3.2.1">~</ci><ci id="A1.Ex11.m1.1.1.1.1.1.3.2.2.cmml" xref="A1.Ex11.m1.1.1.1.1.1.3.2.2">𝑥</ci></apply><ci id="A1.Ex11.m1.1.1.1.1.1.3.3.cmml" xref="A1.Ex11.m1.1.1.1.1.1.3.3">𝑖</ci></apply></apply></apply><cn id="A1.Ex11.m1.1.1.3.cmml" type="integer" xref="A1.Ex11.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex11.m1.1c">\displaystyle\|x_{i}-\tilde{x}_{i}\|_{2}</annotation><annotation encoding="application/x-llamapun" id="A1.Ex11.m1.1d">∥ italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT - over~ start_ARG italic_x end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\|\phi(W_{i}x_{i-1})-\phi(\tilde{W}_{i}\tilde{x}_{i-1})\|_{2}" class="ltx_Math" display="inline" id="A1.Ex11.m2.1"><semantics id="A1.Ex11.m2.1a"><mrow id="A1.Ex11.m2.1.1" xref="A1.Ex11.m2.1.1.cmml"><mi id="A1.Ex11.m2.1.1.3" xref="A1.Ex11.m2.1.1.3.cmml"></mi><mo id="A1.Ex11.m2.1.1.2" xref="A1.Ex11.m2.1.1.2.cmml">=</mo><msub id="A1.Ex11.m2.1.1.1" xref="A1.Ex11.m2.1.1.1.cmml"><mrow id="A1.Ex11.m2.1.1.1.1.1" xref="A1.Ex11.m2.1.1.1.1.2.cmml"><mo id="A1.Ex11.m2.1.1.1.1.1.2" stretchy="false" xref="A1.Ex11.m2.1.1.1.1.2.1.cmml">‖</mo><mrow id="A1.Ex11.m2.1.1.1.1.1.1" xref="A1.Ex11.m2.1.1.1.1.1.1.cmml"><mrow id="A1.Ex11.m2.1.1.1.1.1.1.1" xref="A1.Ex11.m2.1.1.1.1.1.1.1.cmml"><mi id="A1.Ex11.m2.1.1.1.1.1.1.1.3" xref="A1.Ex11.m2.1.1.1.1.1.1.1.3.cmml">ϕ</mi><mo id="A1.Ex11.m2.1.1.1.1.1.1.1.2" xref="A1.Ex11.m2.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.Ex11.m2.1.1.1.1.1.1.1.1.1" xref="A1.Ex11.m2.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="A1.Ex11.m2.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="A1.Ex11.m2.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.Ex11.m2.1.1.1.1.1.1.1.1.1.1" xref="A1.Ex11.m2.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="A1.Ex11.m2.1.1.1.1.1.1.1.1.1.1.2" xref="A1.Ex11.m2.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="A1.Ex11.m2.1.1.1.1.1.1.1.1.1.1.2.2" xref="A1.Ex11.m2.1.1.1.1.1.1.1.1.1.1.2.2.cmml">W</mi><mi id="A1.Ex11.m2.1.1.1.1.1.1.1.1.1.1.2.3" xref="A1.Ex11.m2.1.1.1.1.1.1.1.1.1.1.2.3.cmml">i</mi></msub><mo id="A1.Ex11.m2.1.1.1.1.1.1.1.1.1.1.1" xref="A1.Ex11.m2.1.1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><msub id="A1.Ex11.m2.1.1.1.1.1.1.1.1.1.1.3" xref="A1.Ex11.m2.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="A1.Ex11.m2.1.1.1.1.1.1.1.1.1.1.3.2" xref="A1.Ex11.m2.1.1.1.1.1.1.1.1.1.1.3.2.cmml">x</mi><mrow id="A1.Ex11.m2.1.1.1.1.1.1.1.1.1.1.3.3" xref="A1.Ex11.m2.1.1.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="A1.Ex11.m2.1.1.1.1.1.1.1.1.1.1.3.3.2" xref="A1.Ex11.m2.1.1.1.1.1.1.1.1.1.1.3.3.2.cmml">i</mi><mo id="A1.Ex11.m2.1.1.1.1.1.1.1.1.1.1.3.3.1" xref="A1.Ex11.m2.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml">−</mo><mn id="A1.Ex11.m2.1.1.1.1.1.1.1.1.1.1.3.3.3" xref="A1.Ex11.m2.1.1.1.1.1.1.1.1.1.1.3.3.3.cmml">1</mn></mrow></msub></mrow><mo id="A1.Ex11.m2.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="A1.Ex11.m2.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.Ex11.m2.1.1.1.1.1.1.3" xref="A1.Ex11.m2.1.1.1.1.1.1.3.cmml">−</mo><mrow id="A1.Ex11.m2.1.1.1.1.1.1.2" xref="A1.Ex11.m2.1.1.1.1.1.1.2.cmml"><mi id="A1.Ex11.m2.1.1.1.1.1.1.2.3" xref="A1.Ex11.m2.1.1.1.1.1.1.2.3.cmml">ϕ</mi><mo id="A1.Ex11.m2.1.1.1.1.1.1.2.2" xref="A1.Ex11.m2.1.1.1.1.1.1.2.2.cmml">⁢</mo><mrow id="A1.Ex11.m2.1.1.1.1.1.1.2.1.1" xref="A1.Ex11.m2.1.1.1.1.1.1.2.1.1.1.cmml"><mo id="A1.Ex11.m2.1.1.1.1.1.1.2.1.1.2" stretchy="false" xref="A1.Ex11.m2.1.1.1.1.1.1.2.1.1.1.cmml">(</mo><mrow id="A1.Ex11.m2.1.1.1.1.1.1.2.1.1.1" xref="A1.Ex11.m2.1.1.1.1.1.1.2.1.1.1.cmml"><msub id="A1.Ex11.m2.1.1.1.1.1.1.2.1.1.1.2" xref="A1.Ex11.m2.1.1.1.1.1.1.2.1.1.1.2.cmml"><mover accent="true" id="A1.Ex11.m2.1.1.1.1.1.1.2.1.1.1.2.2" xref="A1.Ex11.m2.1.1.1.1.1.1.2.1.1.1.2.2.cmml"><mi id="A1.Ex11.m2.1.1.1.1.1.1.2.1.1.1.2.2.2" xref="A1.Ex11.m2.1.1.1.1.1.1.2.1.1.1.2.2.2.cmml">W</mi><mo id="A1.Ex11.m2.1.1.1.1.1.1.2.1.1.1.2.2.1" xref="A1.Ex11.m2.1.1.1.1.1.1.2.1.1.1.2.2.1.cmml">~</mo></mover><mi id="A1.Ex11.m2.1.1.1.1.1.1.2.1.1.1.2.3" xref="A1.Ex11.m2.1.1.1.1.1.1.2.1.1.1.2.3.cmml">i</mi></msub><mo id="A1.Ex11.m2.1.1.1.1.1.1.2.1.1.1.1" xref="A1.Ex11.m2.1.1.1.1.1.1.2.1.1.1.1.cmml">⁢</mo><msub id="A1.Ex11.m2.1.1.1.1.1.1.2.1.1.1.3" xref="A1.Ex11.m2.1.1.1.1.1.1.2.1.1.1.3.cmml"><mover accent="true" id="A1.Ex11.m2.1.1.1.1.1.1.2.1.1.1.3.2" xref="A1.Ex11.m2.1.1.1.1.1.1.2.1.1.1.3.2.cmml"><mi id="A1.Ex11.m2.1.1.1.1.1.1.2.1.1.1.3.2.2" xref="A1.Ex11.m2.1.1.1.1.1.1.2.1.1.1.3.2.2.cmml">x</mi><mo id="A1.Ex11.m2.1.1.1.1.1.1.2.1.1.1.3.2.1" xref="A1.Ex11.m2.1.1.1.1.1.1.2.1.1.1.3.2.1.cmml">~</mo></mover><mrow id="A1.Ex11.m2.1.1.1.1.1.1.2.1.1.1.3.3" xref="A1.Ex11.m2.1.1.1.1.1.1.2.1.1.1.3.3.cmml"><mi id="A1.Ex11.m2.1.1.1.1.1.1.2.1.1.1.3.3.2" xref="A1.Ex11.m2.1.1.1.1.1.1.2.1.1.1.3.3.2.cmml">i</mi><mo id="A1.Ex11.m2.1.1.1.1.1.1.2.1.1.1.3.3.1" xref="A1.Ex11.m2.1.1.1.1.1.1.2.1.1.1.3.3.1.cmml">−</mo><mn id="A1.Ex11.m2.1.1.1.1.1.1.2.1.1.1.3.3.3" xref="A1.Ex11.m2.1.1.1.1.1.1.2.1.1.1.3.3.3.cmml">1</mn></mrow></msub></mrow><mo id="A1.Ex11.m2.1.1.1.1.1.1.2.1.1.3" stretchy="false" xref="A1.Ex11.m2.1.1.1.1.1.1.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="A1.Ex11.m2.1.1.1.1.1.3" stretchy="false" xref="A1.Ex11.m2.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="A1.Ex11.m2.1.1.1.3" xref="A1.Ex11.m2.1.1.1.3.cmml">2</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex11.m2.1b"><apply id="A1.Ex11.m2.1.1.cmml" xref="A1.Ex11.m2.1.1"><eq id="A1.Ex11.m2.1.1.2.cmml" xref="A1.Ex11.m2.1.1.2"></eq><csymbol cd="latexml" id="A1.Ex11.m2.1.1.3.cmml" xref="A1.Ex11.m2.1.1.3">absent</csymbol><apply id="A1.Ex11.m2.1.1.1.cmml" xref="A1.Ex11.m2.1.1.1"><csymbol cd="ambiguous" id="A1.Ex11.m2.1.1.1.2.cmml" xref="A1.Ex11.m2.1.1.1">subscript</csymbol><apply id="A1.Ex11.m2.1.1.1.1.2.cmml" xref="A1.Ex11.m2.1.1.1.1.1"><csymbol cd="latexml" id="A1.Ex11.m2.1.1.1.1.2.1.cmml" xref="A1.Ex11.m2.1.1.1.1.1.2">norm</csymbol><apply id="A1.Ex11.m2.1.1.1.1.1.1.cmml" xref="A1.Ex11.m2.1.1.1.1.1.1"><minus id="A1.Ex11.m2.1.1.1.1.1.1.3.cmml" xref="A1.Ex11.m2.1.1.1.1.1.1.3"></minus><apply id="A1.Ex11.m2.1.1.1.1.1.1.1.cmml" xref="A1.Ex11.m2.1.1.1.1.1.1.1"><times id="A1.Ex11.m2.1.1.1.1.1.1.1.2.cmml" xref="A1.Ex11.m2.1.1.1.1.1.1.1.2"></times><ci id="A1.Ex11.m2.1.1.1.1.1.1.1.3.cmml" xref="A1.Ex11.m2.1.1.1.1.1.1.1.3">italic-ϕ</ci><apply id="A1.Ex11.m2.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex11.m2.1.1.1.1.1.1.1.1.1"><times id="A1.Ex11.m2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex11.m2.1.1.1.1.1.1.1.1.1.1.1"></times><apply id="A1.Ex11.m2.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.Ex11.m2.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.Ex11.m2.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="A1.Ex11.m2.1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="A1.Ex11.m2.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="A1.Ex11.m2.1.1.1.1.1.1.1.1.1.1.2.2">𝑊</ci><ci id="A1.Ex11.m2.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="A1.Ex11.m2.1.1.1.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><apply id="A1.Ex11.m2.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.Ex11.m2.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.Ex11.m2.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="A1.Ex11.m2.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="A1.Ex11.m2.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="A1.Ex11.m2.1.1.1.1.1.1.1.1.1.1.3.2">𝑥</ci><apply id="A1.Ex11.m2.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="A1.Ex11.m2.1.1.1.1.1.1.1.1.1.1.3.3"><minus id="A1.Ex11.m2.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="A1.Ex11.m2.1.1.1.1.1.1.1.1.1.1.3.3.1"></minus><ci id="A1.Ex11.m2.1.1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="A1.Ex11.m2.1.1.1.1.1.1.1.1.1.1.3.3.2">𝑖</ci><cn id="A1.Ex11.m2.1.1.1.1.1.1.1.1.1.1.3.3.3.cmml" type="integer" xref="A1.Ex11.m2.1.1.1.1.1.1.1.1.1.1.3.3.3">1</cn></apply></apply></apply></apply><apply id="A1.Ex11.m2.1.1.1.1.1.1.2.cmml" xref="A1.Ex11.m2.1.1.1.1.1.1.2"><times id="A1.Ex11.m2.1.1.1.1.1.1.2.2.cmml" xref="A1.Ex11.m2.1.1.1.1.1.1.2.2"></times><ci id="A1.Ex11.m2.1.1.1.1.1.1.2.3.cmml" xref="A1.Ex11.m2.1.1.1.1.1.1.2.3">italic-ϕ</ci><apply id="A1.Ex11.m2.1.1.1.1.1.1.2.1.1.1.cmml" xref="A1.Ex11.m2.1.1.1.1.1.1.2.1.1"><times id="A1.Ex11.m2.1.1.1.1.1.1.2.1.1.1.1.cmml" xref="A1.Ex11.m2.1.1.1.1.1.1.2.1.1.1.1"></times><apply id="A1.Ex11.m2.1.1.1.1.1.1.2.1.1.1.2.cmml" xref="A1.Ex11.m2.1.1.1.1.1.1.2.1.1.1.2"><csymbol cd="ambiguous" id="A1.Ex11.m2.1.1.1.1.1.1.2.1.1.1.2.1.cmml" xref="A1.Ex11.m2.1.1.1.1.1.1.2.1.1.1.2">subscript</csymbol><apply id="A1.Ex11.m2.1.1.1.1.1.1.2.1.1.1.2.2.cmml" xref="A1.Ex11.m2.1.1.1.1.1.1.2.1.1.1.2.2"><ci id="A1.Ex11.m2.1.1.1.1.1.1.2.1.1.1.2.2.1.cmml" xref="A1.Ex11.m2.1.1.1.1.1.1.2.1.1.1.2.2.1">~</ci><ci id="A1.Ex11.m2.1.1.1.1.1.1.2.1.1.1.2.2.2.cmml" xref="A1.Ex11.m2.1.1.1.1.1.1.2.1.1.1.2.2.2">𝑊</ci></apply><ci id="A1.Ex11.m2.1.1.1.1.1.1.2.1.1.1.2.3.cmml" xref="A1.Ex11.m2.1.1.1.1.1.1.2.1.1.1.2.3">𝑖</ci></apply><apply id="A1.Ex11.m2.1.1.1.1.1.1.2.1.1.1.3.cmml" xref="A1.Ex11.m2.1.1.1.1.1.1.2.1.1.1.3"><csymbol cd="ambiguous" id="A1.Ex11.m2.1.1.1.1.1.1.2.1.1.1.3.1.cmml" xref="A1.Ex11.m2.1.1.1.1.1.1.2.1.1.1.3">subscript</csymbol><apply id="A1.Ex11.m2.1.1.1.1.1.1.2.1.1.1.3.2.cmml" xref="A1.Ex11.m2.1.1.1.1.1.1.2.1.1.1.3.2"><ci id="A1.Ex11.m2.1.1.1.1.1.1.2.1.1.1.3.2.1.cmml" xref="A1.Ex11.m2.1.1.1.1.1.1.2.1.1.1.3.2.1">~</ci><ci id="A1.Ex11.m2.1.1.1.1.1.1.2.1.1.1.3.2.2.cmml" xref="A1.Ex11.m2.1.1.1.1.1.1.2.1.1.1.3.2.2">𝑥</ci></apply><apply id="A1.Ex11.m2.1.1.1.1.1.1.2.1.1.1.3.3.cmml" xref="A1.Ex11.m2.1.1.1.1.1.1.2.1.1.1.3.3"><minus id="A1.Ex11.m2.1.1.1.1.1.1.2.1.1.1.3.3.1.cmml" xref="A1.Ex11.m2.1.1.1.1.1.1.2.1.1.1.3.3.1"></minus><ci id="A1.Ex11.m2.1.1.1.1.1.1.2.1.1.1.3.3.2.cmml" xref="A1.Ex11.m2.1.1.1.1.1.1.2.1.1.1.3.3.2">𝑖</ci><cn id="A1.Ex11.m2.1.1.1.1.1.1.2.1.1.1.3.3.3.cmml" type="integer" xref="A1.Ex11.m2.1.1.1.1.1.1.2.1.1.1.3.3.3">1</cn></apply></apply></apply></apply></apply></apply><cn id="A1.Ex11.m2.1.1.1.3.cmml" type="integer" xref="A1.Ex11.m2.1.1.1.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex11.m2.1c">\displaystyle=\|\phi(W_{i}x_{i-1})-\phi(\tilde{W}_{i}\tilde{x}_{i-1})\|_{2}</annotation><annotation encoding="application/x-llamapun" id="A1.Ex11.m2.1d">= ∥ italic_ϕ ( italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT italic_x start_POSTSUBSCRIPT italic_i - 1 end_POSTSUBSCRIPT ) - italic_ϕ ( over~ start_ARG italic_W end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT over~ start_ARG italic_x end_ARG start_POSTSUBSCRIPT italic_i - 1 end_POSTSUBSCRIPT ) ∥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A1.Ex12"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\leq L_{\phi}\|W_{i}x_{i-1}-\tilde{W}_{i}\tilde{x}_{i-1}\|_{2}" class="ltx_Math" display="inline" id="A1.Ex12.m1.1"><semantics id="A1.Ex12.m1.1a"><mrow id="A1.Ex12.m1.1.1" xref="A1.Ex12.m1.1.1.cmml"><mi id="A1.Ex12.m1.1.1.3" xref="A1.Ex12.m1.1.1.3.cmml"></mi><mo id="A1.Ex12.m1.1.1.2" xref="A1.Ex12.m1.1.1.2.cmml">≤</mo><mrow id="A1.Ex12.m1.1.1.1" xref="A1.Ex12.m1.1.1.1.cmml"><msub id="A1.Ex12.m1.1.1.1.3" xref="A1.Ex12.m1.1.1.1.3.cmml"><mi id="A1.Ex12.m1.1.1.1.3.2" xref="A1.Ex12.m1.1.1.1.3.2.cmml">L</mi><mi id="A1.Ex12.m1.1.1.1.3.3" xref="A1.Ex12.m1.1.1.1.3.3.cmml">ϕ</mi></msub><mo id="A1.Ex12.m1.1.1.1.2" xref="A1.Ex12.m1.1.1.1.2.cmml">⁢</mo><msub id="A1.Ex12.m1.1.1.1.1" xref="A1.Ex12.m1.1.1.1.1.cmml"><mrow id="A1.Ex12.m1.1.1.1.1.1.1" xref="A1.Ex12.m1.1.1.1.1.1.2.cmml"><mo id="A1.Ex12.m1.1.1.1.1.1.1.2" stretchy="false" xref="A1.Ex12.m1.1.1.1.1.1.2.1.cmml">‖</mo><mrow id="A1.Ex12.m1.1.1.1.1.1.1.1" xref="A1.Ex12.m1.1.1.1.1.1.1.1.cmml"><mrow id="A1.Ex12.m1.1.1.1.1.1.1.1.2" xref="A1.Ex12.m1.1.1.1.1.1.1.1.2.cmml"><msub id="A1.Ex12.m1.1.1.1.1.1.1.1.2.2" xref="A1.Ex12.m1.1.1.1.1.1.1.1.2.2.cmml"><mi id="A1.Ex12.m1.1.1.1.1.1.1.1.2.2.2" xref="A1.Ex12.m1.1.1.1.1.1.1.1.2.2.2.cmml">W</mi><mi id="A1.Ex12.m1.1.1.1.1.1.1.1.2.2.3" xref="A1.Ex12.m1.1.1.1.1.1.1.1.2.2.3.cmml">i</mi></msub><mo id="A1.Ex12.m1.1.1.1.1.1.1.1.2.1" xref="A1.Ex12.m1.1.1.1.1.1.1.1.2.1.cmml">⁢</mo><msub id="A1.Ex12.m1.1.1.1.1.1.1.1.2.3" xref="A1.Ex12.m1.1.1.1.1.1.1.1.2.3.cmml"><mi id="A1.Ex12.m1.1.1.1.1.1.1.1.2.3.2" xref="A1.Ex12.m1.1.1.1.1.1.1.1.2.3.2.cmml">x</mi><mrow id="A1.Ex12.m1.1.1.1.1.1.1.1.2.3.3" xref="A1.Ex12.m1.1.1.1.1.1.1.1.2.3.3.cmml"><mi id="A1.Ex12.m1.1.1.1.1.1.1.1.2.3.3.2" xref="A1.Ex12.m1.1.1.1.1.1.1.1.2.3.3.2.cmml">i</mi><mo id="A1.Ex12.m1.1.1.1.1.1.1.1.2.3.3.1" xref="A1.Ex12.m1.1.1.1.1.1.1.1.2.3.3.1.cmml">−</mo><mn id="A1.Ex12.m1.1.1.1.1.1.1.1.2.3.3.3" xref="A1.Ex12.m1.1.1.1.1.1.1.1.2.3.3.3.cmml">1</mn></mrow></msub></mrow><mo id="A1.Ex12.m1.1.1.1.1.1.1.1.1" xref="A1.Ex12.m1.1.1.1.1.1.1.1.1.cmml">−</mo><mrow id="A1.Ex12.m1.1.1.1.1.1.1.1.3" xref="A1.Ex12.m1.1.1.1.1.1.1.1.3.cmml"><msub id="A1.Ex12.m1.1.1.1.1.1.1.1.3.2" xref="A1.Ex12.m1.1.1.1.1.1.1.1.3.2.cmml"><mover accent="true" id="A1.Ex12.m1.1.1.1.1.1.1.1.3.2.2" xref="A1.Ex12.m1.1.1.1.1.1.1.1.3.2.2.cmml"><mi id="A1.Ex12.m1.1.1.1.1.1.1.1.3.2.2.2" xref="A1.Ex12.m1.1.1.1.1.1.1.1.3.2.2.2.cmml">W</mi><mo id="A1.Ex12.m1.1.1.1.1.1.1.1.3.2.2.1" xref="A1.Ex12.m1.1.1.1.1.1.1.1.3.2.2.1.cmml">~</mo></mover><mi id="A1.Ex12.m1.1.1.1.1.1.1.1.3.2.3" xref="A1.Ex12.m1.1.1.1.1.1.1.1.3.2.3.cmml">i</mi></msub><mo id="A1.Ex12.m1.1.1.1.1.1.1.1.3.1" xref="A1.Ex12.m1.1.1.1.1.1.1.1.3.1.cmml">⁢</mo><msub id="A1.Ex12.m1.1.1.1.1.1.1.1.3.3" xref="A1.Ex12.m1.1.1.1.1.1.1.1.3.3.cmml"><mover accent="true" id="A1.Ex12.m1.1.1.1.1.1.1.1.3.3.2" xref="A1.Ex12.m1.1.1.1.1.1.1.1.3.3.2.cmml"><mi id="A1.Ex12.m1.1.1.1.1.1.1.1.3.3.2.2" xref="A1.Ex12.m1.1.1.1.1.1.1.1.3.3.2.2.cmml">x</mi><mo id="A1.Ex12.m1.1.1.1.1.1.1.1.3.3.2.1" xref="A1.Ex12.m1.1.1.1.1.1.1.1.3.3.2.1.cmml">~</mo></mover><mrow id="A1.Ex12.m1.1.1.1.1.1.1.1.3.3.3" xref="A1.Ex12.m1.1.1.1.1.1.1.1.3.3.3.cmml"><mi id="A1.Ex12.m1.1.1.1.1.1.1.1.3.3.3.2" xref="A1.Ex12.m1.1.1.1.1.1.1.1.3.3.3.2.cmml">i</mi><mo id="A1.Ex12.m1.1.1.1.1.1.1.1.3.3.3.1" xref="A1.Ex12.m1.1.1.1.1.1.1.1.3.3.3.1.cmml">−</mo><mn id="A1.Ex12.m1.1.1.1.1.1.1.1.3.3.3.3" xref="A1.Ex12.m1.1.1.1.1.1.1.1.3.3.3.3.cmml">1</mn></mrow></msub></mrow></mrow><mo id="A1.Ex12.m1.1.1.1.1.1.1.3" stretchy="false" xref="A1.Ex12.m1.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="A1.Ex12.m1.1.1.1.1.3" xref="A1.Ex12.m1.1.1.1.1.3.cmml">2</mn></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex12.m1.1b"><apply id="A1.Ex12.m1.1.1.cmml" xref="A1.Ex12.m1.1.1"><leq id="A1.Ex12.m1.1.1.2.cmml" xref="A1.Ex12.m1.1.1.2"></leq><csymbol cd="latexml" id="A1.Ex12.m1.1.1.3.cmml" xref="A1.Ex12.m1.1.1.3">absent</csymbol><apply id="A1.Ex12.m1.1.1.1.cmml" xref="A1.Ex12.m1.1.1.1"><times id="A1.Ex12.m1.1.1.1.2.cmml" xref="A1.Ex12.m1.1.1.1.2"></times><apply id="A1.Ex12.m1.1.1.1.3.cmml" xref="A1.Ex12.m1.1.1.1.3"><csymbol cd="ambiguous" id="A1.Ex12.m1.1.1.1.3.1.cmml" xref="A1.Ex12.m1.1.1.1.3">subscript</csymbol><ci id="A1.Ex12.m1.1.1.1.3.2.cmml" xref="A1.Ex12.m1.1.1.1.3.2">𝐿</ci><ci id="A1.Ex12.m1.1.1.1.3.3.cmml" xref="A1.Ex12.m1.1.1.1.3.3">italic-ϕ</ci></apply><apply id="A1.Ex12.m1.1.1.1.1.cmml" xref="A1.Ex12.m1.1.1.1.1"><csymbol cd="ambiguous" id="A1.Ex12.m1.1.1.1.1.2.cmml" xref="A1.Ex12.m1.1.1.1.1">subscript</csymbol><apply id="A1.Ex12.m1.1.1.1.1.1.2.cmml" xref="A1.Ex12.m1.1.1.1.1.1.1"><csymbol cd="latexml" id="A1.Ex12.m1.1.1.1.1.1.2.1.cmml" xref="A1.Ex12.m1.1.1.1.1.1.1.2">norm</csymbol><apply id="A1.Ex12.m1.1.1.1.1.1.1.1.cmml" xref="A1.Ex12.m1.1.1.1.1.1.1.1"><minus id="A1.Ex12.m1.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex12.m1.1.1.1.1.1.1.1.1"></minus><apply id="A1.Ex12.m1.1.1.1.1.1.1.1.2.cmml" xref="A1.Ex12.m1.1.1.1.1.1.1.1.2"><times id="A1.Ex12.m1.1.1.1.1.1.1.1.2.1.cmml" xref="A1.Ex12.m1.1.1.1.1.1.1.1.2.1"></times><apply id="A1.Ex12.m1.1.1.1.1.1.1.1.2.2.cmml" xref="A1.Ex12.m1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="A1.Ex12.m1.1.1.1.1.1.1.1.2.2.1.cmml" xref="A1.Ex12.m1.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="A1.Ex12.m1.1.1.1.1.1.1.1.2.2.2.cmml" xref="A1.Ex12.m1.1.1.1.1.1.1.1.2.2.2">𝑊</ci><ci id="A1.Ex12.m1.1.1.1.1.1.1.1.2.2.3.cmml" xref="A1.Ex12.m1.1.1.1.1.1.1.1.2.2.3">𝑖</ci></apply><apply id="A1.Ex12.m1.1.1.1.1.1.1.1.2.3.cmml" xref="A1.Ex12.m1.1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="A1.Ex12.m1.1.1.1.1.1.1.1.2.3.1.cmml" xref="A1.Ex12.m1.1.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="A1.Ex12.m1.1.1.1.1.1.1.1.2.3.2.cmml" xref="A1.Ex12.m1.1.1.1.1.1.1.1.2.3.2">𝑥</ci><apply id="A1.Ex12.m1.1.1.1.1.1.1.1.2.3.3.cmml" xref="A1.Ex12.m1.1.1.1.1.1.1.1.2.3.3"><minus id="A1.Ex12.m1.1.1.1.1.1.1.1.2.3.3.1.cmml" xref="A1.Ex12.m1.1.1.1.1.1.1.1.2.3.3.1"></minus><ci id="A1.Ex12.m1.1.1.1.1.1.1.1.2.3.3.2.cmml" xref="A1.Ex12.m1.1.1.1.1.1.1.1.2.3.3.2">𝑖</ci><cn id="A1.Ex12.m1.1.1.1.1.1.1.1.2.3.3.3.cmml" type="integer" xref="A1.Ex12.m1.1.1.1.1.1.1.1.2.3.3.3">1</cn></apply></apply></apply><apply id="A1.Ex12.m1.1.1.1.1.1.1.1.3.cmml" xref="A1.Ex12.m1.1.1.1.1.1.1.1.3"><times id="A1.Ex12.m1.1.1.1.1.1.1.1.3.1.cmml" xref="A1.Ex12.m1.1.1.1.1.1.1.1.3.1"></times><apply id="A1.Ex12.m1.1.1.1.1.1.1.1.3.2.cmml" xref="A1.Ex12.m1.1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="A1.Ex12.m1.1.1.1.1.1.1.1.3.2.1.cmml" xref="A1.Ex12.m1.1.1.1.1.1.1.1.3.2">subscript</csymbol><apply id="A1.Ex12.m1.1.1.1.1.1.1.1.3.2.2.cmml" xref="A1.Ex12.m1.1.1.1.1.1.1.1.3.2.2"><ci id="A1.Ex12.m1.1.1.1.1.1.1.1.3.2.2.1.cmml" xref="A1.Ex12.m1.1.1.1.1.1.1.1.3.2.2.1">~</ci><ci id="A1.Ex12.m1.1.1.1.1.1.1.1.3.2.2.2.cmml" xref="A1.Ex12.m1.1.1.1.1.1.1.1.3.2.2.2">𝑊</ci></apply><ci id="A1.Ex12.m1.1.1.1.1.1.1.1.3.2.3.cmml" xref="A1.Ex12.m1.1.1.1.1.1.1.1.3.2.3">𝑖</ci></apply><apply id="A1.Ex12.m1.1.1.1.1.1.1.1.3.3.cmml" xref="A1.Ex12.m1.1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="A1.Ex12.m1.1.1.1.1.1.1.1.3.3.1.cmml" xref="A1.Ex12.m1.1.1.1.1.1.1.1.3.3">subscript</csymbol><apply id="A1.Ex12.m1.1.1.1.1.1.1.1.3.3.2.cmml" xref="A1.Ex12.m1.1.1.1.1.1.1.1.3.3.2"><ci id="A1.Ex12.m1.1.1.1.1.1.1.1.3.3.2.1.cmml" xref="A1.Ex12.m1.1.1.1.1.1.1.1.3.3.2.1">~</ci><ci id="A1.Ex12.m1.1.1.1.1.1.1.1.3.3.2.2.cmml" xref="A1.Ex12.m1.1.1.1.1.1.1.1.3.3.2.2">𝑥</ci></apply><apply id="A1.Ex12.m1.1.1.1.1.1.1.1.3.3.3.cmml" xref="A1.Ex12.m1.1.1.1.1.1.1.1.3.3.3"><minus id="A1.Ex12.m1.1.1.1.1.1.1.1.3.3.3.1.cmml" xref="A1.Ex12.m1.1.1.1.1.1.1.1.3.3.3.1"></minus><ci id="A1.Ex12.m1.1.1.1.1.1.1.1.3.3.3.2.cmml" xref="A1.Ex12.m1.1.1.1.1.1.1.1.3.3.3.2">𝑖</ci><cn id="A1.Ex12.m1.1.1.1.1.1.1.1.3.3.3.3.cmml" type="integer" xref="A1.Ex12.m1.1.1.1.1.1.1.1.3.3.3.3">1</cn></apply></apply></apply></apply></apply><cn id="A1.Ex12.m1.1.1.1.1.3.cmml" type="integer" xref="A1.Ex12.m1.1.1.1.1.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex12.m1.1c">\displaystyle\leq L_{\phi}\|W_{i}x_{i-1}-\tilde{W}_{i}\tilde{x}_{i-1}\|_{2}</annotation><annotation encoding="application/x-llamapun" id="A1.Ex12.m1.1d">≤ italic_L start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ∥ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT italic_x start_POSTSUBSCRIPT italic_i - 1 end_POSTSUBSCRIPT - over~ start_ARG italic_W end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT over~ start_ARG italic_x end_ARG start_POSTSUBSCRIPT italic_i - 1 end_POSTSUBSCRIPT ∥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A1.Ex13"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\leq L_{\phi}\left(\|W_{i}(x_{i-1}-\tilde{x}_{i-1})\|_{2}+\|(W_{i%
}-\tilde{W}_{i})\tilde{x}_{i-1}\|_{2}\right)" class="ltx_Math" display="inline" id="A1.Ex13.m1.1"><semantics id="A1.Ex13.m1.1a"><mrow id="A1.Ex13.m1.1.1" xref="A1.Ex13.m1.1.1.cmml"><mi id="A1.Ex13.m1.1.1.3" xref="A1.Ex13.m1.1.1.3.cmml"></mi><mo id="A1.Ex13.m1.1.1.2" xref="A1.Ex13.m1.1.1.2.cmml">≤</mo><mrow id="A1.Ex13.m1.1.1.1" xref="A1.Ex13.m1.1.1.1.cmml"><msub id="A1.Ex13.m1.1.1.1.3" xref="A1.Ex13.m1.1.1.1.3.cmml"><mi id="A1.Ex13.m1.1.1.1.3.2" xref="A1.Ex13.m1.1.1.1.3.2.cmml">L</mi><mi id="A1.Ex13.m1.1.1.1.3.3" xref="A1.Ex13.m1.1.1.1.3.3.cmml">ϕ</mi></msub><mo id="A1.Ex13.m1.1.1.1.2" xref="A1.Ex13.m1.1.1.1.2.cmml">⁢</mo><mrow id="A1.Ex13.m1.1.1.1.1.1" xref="A1.Ex13.m1.1.1.1.1.1.1.cmml"><mo id="A1.Ex13.m1.1.1.1.1.1.2" xref="A1.Ex13.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.Ex13.m1.1.1.1.1.1.1" xref="A1.Ex13.m1.1.1.1.1.1.1.cmml"><msub id="A1.Ex13.m1.1.1.1.1.1.1.1" xref="A1.Ex13.m1.1.1.1.1.1.1.1.cmml"><mrow id="A1.Ex13.m1.1.1.1.1.1.1.1.1.1" xref="A1.Ex13.m1.1.1.1.1.1.1.1.1.2.cmml"><mo id="A1.Ex13.m1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="A1.Ex13.m1.1.1.1.1.1.1.1.1.2.1.cmml">‖</mo><mrow id="A1.Ex13.m1.1.1.1.1.1.1.1.1.1.1" xref="A1.Ex13.m1.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="A1.Ex13.m1.1.1.1.1.1.1.1.1.1.1.3" xref="A1.Ex13.m1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="A1.Ex13.m1.1.1.1.1.1.1.1.1.1.1.3.2" xref="A1.Ex13.m1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">W</mi><mi id="A1.Ex13.m1.1.1.1.1.1.1.1.1.1.1.3.3" xref="A1.Ex13.m1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">i</mi></msub><mo id="A1.Ex13.m1.1.1.1.1.1.1.1.1.1.1.2" xref="A1.Ex13.m1.1.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.Ex13.m1.1.1.1.1.1.1.1.1.1.1.1.1" xref="A1.Ex13.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="A1.Ex13.m1.1.1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="A1.Ex13.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.Ex13.m1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="A1.Ex13.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="A1.Ex13.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="A1.Ex13.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="A1.Ex13.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="A1.Ex13.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">x</mi><mrow id="A1.Ex13.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="A1.Ex13.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="A1.Ex13.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.2" xref="A1.Ex13.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.2.cmml">i</mi><mo id="A1.Ex13.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.1" xref="A1.Ex13.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.1.cmml">−</mo><mn id="A1.Ex13.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.3" xref="A1.Ex13.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.3.cmml">1</mn></mrow></msub><mo id="A1.Ex13.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="A1.Ex13.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><msub id="A1.Ex13.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="A1.Ex13.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mover accent="true" id="A1.Ex13.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="A1.Ex13.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml"><mi id="A1.Ex13.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.2" xref="A1.Ex13.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml">x</mi><mo id="A1.Ex13.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.1" xref="A1.Ex13.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.1.cmml">~</mo></mover><mrow id="A1.Ex13.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="A1.Ex13.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="A1.Ex13.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.2" xref="A1.Ex13.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.cmml">i</mi><mo id="A1.Ex13.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.1" xref="A1.Ex13.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml">−</mo><mn id="A1.Ex13.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.3" xref="A1.Ex13.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.3.cmml">1</mn></mrow></msub></mrow><mo id="A1.Ex13.m1.1.1.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="A1.Ex13.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.Ex13.m1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="A1.Ex13.m1.1.1.1.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="A1.Ex13.m1.1.1.1.1.1.1.1.3" xref="A1.Ex13.m1.1.1.1.1.1.1.1.3.cmml">2</mn></msub><mo id="A1.Ex13.m1.1.1.1.1.1.1.3" xref="A1.Ex13.m1.1.1.1.1.1.1.3.cmml">+</mo><msub id="A1.Ex13.m1.1.1.1.1.1.1.2" xref="A1.Ex13.m1.1.1.1.1.1.1.2.cmml"><mrow id="A1.Ex13.m1.1.1.1.1.1.1.2.1.1" xref="A1.Ex13.m1.1.1.1.1.1.1.2.1.2.cmml"><mo id="A1.Ex13.m1.1.1.1.1.1.1.2.1.1.2" stretchy="false" xref="A1.Ex13.m1.1.1.1.1.1.1.2.1.2.1.cmml">‖</mo><mrow id="A1.Ex13.m1.1.1.1.1.1.1.2.1.1.1" xref="A1.Ex13.m1.1.1.1.1.1.1.2.1.1.1.cmml"><mrow id="A1.Ex13.m1.1.1.1.1.1.1.2.1.1.1.1.1" xref="A1.Ex13.m1.1.1.1.1.1.1.2.1.1.1.1.1.1.cmml"><mo id="A1.Ex13.m1.1.1.1.1.1.1.2.1.1.1.1.1.2" stretchy="false" xref="A1.Ex13.m1.1.1.1.1.1.1.2.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.Ex13.m1.1.1.1.1.1.1.2.1.1.1.1.1.1" xref="A1.Ex13.m1.1.1.1.1.1.1.2.1.1.1.1.1.1.cmml"><msub id="A1.Ex13.m1.1.1.1.1.1.1.2.1.1.1.1.1.1.2" xref="A1.Ex13.m1.1.1.1.1.1.1.2.1.1.1.1.1.1.2.cmml"><mi id="A1.Ex13.m1.1.1.1.1.1.1.2.1.1.1.1.1.1.2.2" xref="A1.Ex13.m1.1.1.1.1.1.1.2.1.1.1.1.1.1.2.2.cmml">W</mi><mi id="A1.Ex13.m1.1.1.1.1.1.1.2.1.1.1.1.1.1.2.3" xref="A1.Ex13.m1.1.1.1.1.1.1.2.1.1.1.1.1.1.2.3.cmml">i</mi></msub><mo id="A1.Ex13.m1.1.1.1.1.1.1.2.1.1.1.1.1.1.1" xref="A1.Ex13.m1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.cmml">−</mo><msub id="A1.Ex13.m1.1.1.1.1.1.1.2.1.1.1.1.1.1.3" xref="A1.Ex13.m1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.cmml"><mover accent="true" id="A1.Ex13.m1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.2" xref="A1.Ex13.m1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.2.cmml"><mi id="A1.Ex13.m1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.2.2" xref="A1.Ex13.m1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.2.2.cmml">W</mi><mo id="A1.Ex13.m1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.2.1" xref="A1.Ex13.m1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.2.1.cmml">~</mo></mover><mi id="A1.Ex13.m1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.3" xref="A1.Ex13.m1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.3.cmml">i</mi></msub></mrow><mo id="A1.Ex13.m1.1.1.1.1.1.1.2.1.1.1.1.1.3" stretchy="false" xref="A1.Ex13.m1.1.1.1.1.1.1.2.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="A1.Ex13.m1.1.1.1.1.1.1.2.1.1.1.2" xref="A1.Ex13.m1.1.1.1.1.1.1.2.1.1.1.2.cmml">⁢</mo><msub id="A1.Ex13.m1.1.1.1.1.1.1.2.1.1.1.3" xref="A1.Ex13.m1.1.1.1.1.1.1.2.1.1.1.3.cmml"><mover accent="true" id="A1.Ex13.m1.1.1.1.1.1.1.2.1.1.1.3.2" xref="A1.Ex13.m1.1.1.1.1.1.1.2.1.1.1.3.2.cmml"><mi id="A1.Ex13.m1.1.1.1.1.1.1.2.1.1.1.3.2.2" xref="A1.Ex13.m1.1.1.1.1.1.1.2.1.1.1.3.2.2.cmml">x</mi><mo id="A1.Ex13.m1.1.1.1.1.1.1.2.1.1.1.3.2.1" xref="A1.Ex13.m1.1.1.1.1.1.1.2.1.1.1.3.2.1.cmml">~</mo></mover><mrow id="A1.Ex13.m1.1.1.1.1.1.1.2.1.1.1.3.3" xref="A1.Ex13.m1.1.1.1.1.1.1.2.1.1.1.3.3.cmml"><mi id="A1.Ex13.m1.1.1.1.1.1.1.2.1.1.1.3.3.2" xref="A1.Ex13.m1.1.1.1.1.1.1.2.1.1.1.3.3.2.cmml">i</mi><mo id="A1.Ex13.m1.1.1.1.1.1.1.2.1.1.1.3.3.1" xref="A1.Ex13.m1.1.1.1.1.1.1.2.1.1.1.3.3.1.cmml">−</mo><mn id="A1.Ex13.m1.1.1.1.1.1.1.2.1.1.1.3.3.3" xref="A1.Ex13.m1.1.1.1.1.1.1.2.1.1.1.3.3.3.cmml">1</mn></mrow></msub></mrow><mo id="A1.Ex13.m1.1.1.1.1.1.1.2.1.1.3" stretchy="false" xref="A1.Ex13.m1.1.1.1.1.1.1.2.1.2.1.cmml">‖</mo></mrow><mn id="A1.Ex13.m1.1.1.1.1.1.1.2.3" xref="A1.Ex13.m1.1.1.1.1.1.1.2.3.cmml">2</mn></msub></mrow><mo id="A1.Ex13.m1.1.1.1.1.1.3" xref="A1.Ex13.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex13.m1.1b"><apply id="A1.Ex13.m1.1.1.cmml" xref="A1.Ex13.m1.1.1"><leq id="A1.Ex13.m1.1.1.2.cmml" xref="A1.Ex13.m1.1.1.2"></leq><csymbol cd="latexml" id="A1.Ex13.m1.1.1.3.cmml" xref="A1.Ex13.m1.1.1.3">absent</csymbol><apply id="A1.Ex13.m1.1.1.1.cmml" xref="A1.Ex13.m1.1.1.1"><times id="A1.Ex13.m1.1.1.1.2.cmml" xref="A1.Ex13.m1.1.1.1.2"></times><apply id="A1.Ex13.m1.1.1.1.3.cmml" xref="A1.Ex13.m1.1.1.1.3"><csymbol cd="ambiguous" id="A1.Ex13.m1.1.1.1.3.1.cmml" xref="A1.Ex13.m1.1.1.1.3">subscript</csymbol><ci id="A1.Ex13.m1.1.1.1.3.2.cmml" xref="A1.Ex13.m1.1.1.1.3.2">𝐿</ci><ci id="A1.Ex13.m1.1.1.1.3.3.cmml" xref="A1.Ex13.m1.1.1.1.3.3">italic-ϕ</ci></apply><apply id="A1.Ex13.m1.1.1.1.1.1.1.cmml" xref="A1.Ex13.m1.1.1.1.1.1"><plus id="A1.Ex13.m1.1.1.1.1.1.1.3.cmml" xref="A1.Ex13.m1.1.1.1.1.1.1.3"></plus><apply id="A1.Ex13.m1.1.1.1.1.1.1.1.cmml" xref="A1.Ex13.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.Ex13.m1.1.1.1.1.1.1.1.2.cmml" xref="A1.Ex13.m1.1.1.1.1.1.1.1">subscript</csymbol><apply id="A1.Ex13.m1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.Ex13.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="A1.Ex13.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="A1.Ex13.m1.1.1.1.1.1.1.1.1.1.2">norm</csymbol><apply id="A1.Ex13.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex13.m1.1.1.1.1.1.1.1.1.1.1"><times id="A1.Ex13.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.Ex13.m1.1.1.1.1.1.1.1.1.1.1.2"></times><apply id="A1.Ex13.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.Ex13.m1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.Ex13.m1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="A1.Ex13.m1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="A1.Ex13.m1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="A1.Ex13.m1.1.1.1.1.1.1.1.1.1.1.3.2">𝑊</ci><ci id="A1.Ex13.m1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="A1.Ex13.m1.1.1.1.1.1.1.1.1.1.1.3.3">𝑖</ci></apply><apply id="A1.Ex13.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex13.m1.1.1.1.1.1.1.1.1.1.1.1.1"><minus id="A1.Ex13.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex13.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1"></minus><apply id="A1.Ex13.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.Ex13.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.Ex13.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="A1.Ex13.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="A1.Ex13.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="A1.Ex13.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2">𝑥</ci><apply id="A1.Ex13.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="A1.Ex13.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3"><minus id="A1.Ex13.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="A1.Ex13.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.1"></minus><ci id="A1.Ex13.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="A1.Ex13.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.2">𝑖</ci><cn id="A1.Ex13.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.3.cmml" type="integer" xref="A1.Ex13.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.3">1</cn></apply></apply><apply id="A1.Ex13.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.Ex13.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.Ex13.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="A1.Ex13.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><apply id="A1.Ex13.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="A1.Ex13.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2"><ci id="A1.Ex13.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="A1.Ex13.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.1">~</ci><ci id="A1.Ex13.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="A1.Ex13.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.2">𝑥</ci></apply><apply id="A1.Ex13.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="A1.Ex13.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3"><minus id="A1.Ex13.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="A1.Ex13.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.1"></minus><ci id="A1.Ex13.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="A1.Ex13.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.2">𝑖</ci><cn id="A1.Ex13.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.3.cmml" type="integer" xref="A1.Ex13.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.3">1</cn></apply></apply></apply></apply></apply><cn id="A1.Ex13.m1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="A1.Ex13.m1.1.1.1.1.1.1.1.3">2</cn></apply><apply id="A1.Ex13.m1.1.1.1.1.1.1.2.cmml" xref="A1.Ex13.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.Ex13.m1.1.1.1.1.1.1.2.2.cmml" xref="A1.Ex13.m1.1.1.1.1.1.1.2">subscript</csymbol><apply id="A1.Ex13.m1.1.1.1.1.1.1.2.1.2.cmml" xref="A1.Ex13.m1.1.1.1.1.1.1.2.1.1"><csymbol cd="latexml" id="A1.Ex13.m1.1.1.1.1.1.1.2.1.2.1.cmml" xref="A1.Ex13.m1.1.1.1.1.1.1.2.1.1.2">norm</csymbol><apply id="A1.Ex13.m1.1.1.1.1.1.1.2.1.1.1.cmml" xref="A1.Ex13.m1.1.1.1.1.1.1.2.1.1.1"><times id="A1.Ex13.m1.1.1.1.1.1.1.2.1.1.1.2.cmml" xref="A1.Ex13.m1.1.1.1.1.1.1.2.1.1.1.2"></times><apply id="A1.Ex13.m1.1.1.1.1.1.1.2.1.1.1.1.1.1.cmml" xref="A1.Ex13.m1.1.1.1.1.1.1.2.1.1.1.1.1"><minus id="A1.Ex13.m1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.cmml" xref="A1.Ex13.m1.1.1.1.1.1.1.2.1.1.1.1.1.1.1"></minus><apply id="A1.Ex13.m1.1.1.1.1.1.1.2.1.1.1.1.1.1.2.cmml" xref="A1.Ex13.m1.1.1.1.1.1.1.2.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.Ex13.m1.1.1.1.1.1.1.2.1.1.1.1.1.1.2.1.cmml" xref="A1.Ex13.m1.1.1.1.1.1.1.2.1.1.1.1.1.1.2">subscript</csymbol><ci id="A1.Ex13.m1.1.1.1.1.1.1.2.1.1.1.1.1.1.2.2.cmml" xref="A1.Ex13.m1.1.1.1.1.1.1.2.1.1.1.1.1.1.2.2">𝑊</ci><ci id="A1.Ex13.m1.1.1.1.1.1.1.2.1.1.1.1.1.1.2.3.cmml" xref="A1.Ex13.m1.1.1.1.1.1.1.2.1.1.1.1.1.1.2.3">𝑖</ci></apply><apply id="A1.Ex13.m1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.cmml" xref="A1.Ex13.m1.1.1.1.1.1.1.2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.Ex13.m1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.1.cmml" xref="A1.Ex13.m1.1.1.1.1.1.1.2.1.1.1.1.1.1.3">subscript</csymbol><apply id="A1.Ex13.m1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.2.cmml" xref="A1.Ex13.m1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.2"><ci id="A1.Ex13.m1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.2.1.cmml" xref="A1.Ex13.m1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.2.1">~</ci><ci id="A1.Ex13.m1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.2.2.cmml" xref="A1.Ex13.m1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.2.2">𝑊</ci></apply><ci id="A1.Ex13.m1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.3.cmml" xref="A1.Ex13.m1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.3">𝑖</ci></apply></apply><apply id="A1.Ex13.m1.1.1.1.1.1.1.2.1.1.1.3.cmml" xref="A1.Ex13.m1.1.1.1.1.1.1.2.1.1.1.3"><csymbol cd="ambiguous" id="A1.Ex13.m1.1.1.1.1.1.1.2.1.1.1.3.1.cmml" xref="A1.Ex13.m1.1.1.1.1.1.1.2.1.1.1.3">subscript</csymbol><apply id="A1.Ex13.m1.1.1.1.1.1.1.2.1.1.1.3.2.cmml" xref="A1.Ex13.m1.1.1.1.1.1.1.2.1.1.1.3.2"><ci id="A1.Ex13.m1.1.1.1.1.1.1.2.1.1.1.3.2.1.cmml" xref="A1.Ex13.m1.1.1.1.1.1.1.2.1.1.1.3.2.1">~</ci><ci id="A1.Ex13.m1.1.1.1.1.1.1.2.1.1.1.3.2.2.cmml" xref="A1.Ex13.m1.1.1.1.1.1.1.2.1.1.1.3.2.2">𝑥</ci></apply><apply id="A1.Ex13.m1.1.1.1.1.1.1.2.1.1.1.3.3.cmml" xref="A1.Ex13.m1.1.1.1.1.1.1.2.1.1.1.3.3"><minus id="A1.Ex13.m1.1.1.1.1.1.1.2.1.1.1.3.3.1.cmml" xref="A1.Ex13.m1.1.1.1.1.1.1.2.1.1.1.3.3.1"></minus><ci id="A1.Ex13.m1.1.1.1.1.1.1.2.1.1.1.3.3.2.cmml" xref="A1.Ex13.m1.1.1.1.1.1.1.2.1.1.1.3.3.2">𝑖</ci><cn id="A1.Ex13.m1.1.1.1.1.1.1.2.1.1.1.3.3.3.cmml" type="integer" xref="A1.Ex13.m1.1.1.1.1.1.1.2.1.1.1.3.3.3">1</cn></apply></apply></apply></apply><cn id="A1.Ex13.m1.1.1.1.1.1.1.2.3.cmml" type="integer" xref="A1.Ex13.m1.1.1.1.1.1.1.2.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex13.m1.1c">\displaystyle\leq L_{\phi}\left(\|W_{i}(x_{i-1}-\tilde{x}_{i-1})\|_{2}+\|(W_{i%
}-\tilde{W}_{i})\tilde{x}_{i-1}\|_{2}\right)</annotation><annotation encoding="application/x-llamapun" id="A1.Ex13.m1.1d">≤ italic_L start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ( ∥ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ( italic_x start_POSTSUBSCRIPT italic_i - 1 end_POSTSUBSCRIPT - over~ start_ARG italic_x end_ARG start_POSTSUBSCRIPT italic_i - 1 end_POSTSUBSCRIPT ) ∥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT + ∥ ( italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT - over~ start_ARG italic_W end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) over~ start_ARG italic_x end_ARG start_POSTSUBSCRIPT italic_i - 1 end_POSTSUBSCRIPT ∥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A1.Ex14"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\leq L_{\phi}\left(\|W_{i}\|_{2}\|x_{i-1}-\tilde{x}_{i-1}\|_{2}+%
\sigma_{k_{i}+1}^{(i)}\|\tilde{x}_{i-1}\|_{2}\right)." class="ltx_Math" display="inline" id="A1.Ex14.m1.2"><semantics id="A1.Ex14.m1.2a"><mrow id="A1.Ex14.m1.2.2.1" xref="A1.Ex14.m1.2.2.1.1.cmml"><mrow id="A1.Ex14.m1.2.2.1.1" xref="A1.Ex14.m1.2.2.1.1.cmml"><mi id="A1.Ex14.m1.2.2.1.1.3" xref="A1.Ex14.m1.2.2.1.1.3.cmml"></mi><mo id="A1.Ex14.m1.2.2.1.1.2" xref="A1.Ex14.m1.2.2.1.1.2.cmml">≤</mo><mrow id="A1.Ex14.m1.2.2.1.1.1" xref="A1.Ex14.m1.2.2.1.1.1.cmml"><msub id="A1.Ex14.m1.2.2.1.1.1.3" xref="A1.Ex14.m1.2.2.1.1.1.3.cmml"><mi id="A1.Ex14.m1.2.2.1.1.1.3.2" xref="A1.Ex14.m1.2.2.1.1.1.3.2.cmml">L</mi><mi id="A1.Ex14.m1.2.2.1.1.1.3.3" xref="A1.Ex14.m1.2.2.1.1.1.3.3.cmml">ϕ</mi></msub><mo id="A1.Ex14.m1.2.2.1.1.1.2" xref="A1.Ex14.m1.2.2.1.1.1.2.cmml">⁢</mo><mrow id="A1.Ex14.m1.2.2.1.1.1.1.1" xref="A1.Ex14.m1.2.2.1.1.1.1.1.1.cmml"><mo id="A1.Ex14.m1.2.2.1.1.1.1.1.2" xref="A1.Ex14.m1.2.2.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.Ex14.m1.2.2.1.1.1.1.1.1" xref="A1.Ex14.m1.2.2.1.1.1.1.1.1.cmml"><mrow id="A1.Ex14.m1.2.2.1.1.1.1.1.1.2" xref="A1.Ex14.m1.2.2.1.1.1.1.1.1.2.cmml"><msub id="A1.Ex14.m1.2.2.1.1.1.1.1.1.1.1" xref="A1.Ex14.m1.2.2.1.1.1.1.1.1.1.1.cmml"><mrow id="A1.Ex14.m1.2.2.1.1.1.1.1.1.1.1.1.1" xref="A1.Ex14.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml"><mo id="A1.Ex14.m1.2.2.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="A1.Ex14.m1.2.2.1.1.1.1.1.1.1.1.1.2.1.cmml">‖</mo><msub id="A1.Ex14.m1.2.2.1.1.1.1.1.1.1.1.1.1.1" xref="A1.Ex14.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="A1.Ex14.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2" xref="A1.Ex14.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.cmml">W</mi><mi id="A1.Ex14.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3" xref="A1.Ex14.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="A1.Ex14.m1.2.2.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="A1.Ex14.m1.2.2.1.1.1.1.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="A1.Ex14.m1.2.2.1.1.1.1.1.1.1.1.3" xref="A1.Ex14.m1.2.2.1.1.1.1.1.1.1.1.3.cmml">2</mn></msub><mo id="A1.Ex14.m1.2.2.1.1.1.1.1.1.2.3" xref="A1.Ex14.m1.2.2.1.1.1.1.1.1.2.3.cmml">⁢</mo><msub id="A1.Ex14.m1.2.2.1.1.1.1.1.1.2.2" xref="A1.Ex14.m1.2.2.1.1.1.1.1.1.2.2.cmml"><mrow id="A1.Ex14.m1.2.2.1.1.1.1.1.1.2.2.1.1" xref="A1.Ex14.m1.2.2.1.1.1.1.1.1.2.2.1.2.cmml"><mo id="A1.Ex14.m1.2.2.1.1.1.1.1.1.2.2.1.1.2" stretchy="false" xref="A1.Ex14.m1.2.2.1.1.1.1.1.1.2.2.1.2.1.cmml">‖</mo><mrow id="A1.Ex14.m1.2.2.1.1.1.1.1.1.2.2.1.1.1" xref="A1.Ex14.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.cmml"><msub id="A1.Ex14.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.2" xref="A1.Ex14.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.2.cmml"><mi id="A1.Ex14.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.2.2" xref="A1.Ex14.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.2.2.cmml">x</mi><mrow id="A1.Ex14.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.2.3" xref="A1.Ex14.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.2.3.cmml"><mi id="A1.Ex14.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.2.3.2" xref="A1.Ex14.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.2.3.2.cmml">i</mi><mo id="A1.Ex14.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.2.3.1" xref="A1.Ex14.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.2.3.1.cmml">−</mo><mn id="A1.Ex14.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.2.3.3" xref="A1.Ex14.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.2.3.3.cmml">1</mn></mrow></msub><mo id="A1.Ex14.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1" xref="A1.Ex14.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1.cmml">−</mo><msub id="A1.Ex14.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.3" xref="A1.Ex14.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.3.cmml"><mover accent="true" id="A1.Ex14.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.3.2" xref="A1.Ex14.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.3.2.cmml"><mi id="A1.Ex14.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.3.2.2" xref="A1.Ex14.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.3.2.2.cmml">x</mi><mo id="A1.Ex14.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.3.2.1" xref="A1.Ex14.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.3.2.1.cmml">~</mo></mover><mrow id="A1.Ex14.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.3.3" xref="A1.Ex14.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.3.3.cmml"><mi id="A1.Ex14.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.3.3.2" xref="A1.Ex14.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.3.3.2.cmml">i</mi><mo id="A1.Ex14.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.3.3.1" xref="A1.Ex14.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.3.3.1.cmml">−</mo><mn id="A1.Ex14.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.3.3.3" xref="A1.Ex14.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.3.3.3.cmml">1</mn></mrow></msub></mrow><mo id="A1.Ex14.m1.2.2.1.1.1.1.1.1.2.2.1.1.3" stretchy="false" xref="A1.Ex14.m1.2.2.1.1.1.1.1.1.2.2.1.2.1.cmml">‖</mo></mrow><mn id="A1.Ex14.m1.2.2.1.1.1.1.1.1.2.2.3" xref="A1.Ex14.m1.2.2.1.1.1.1.1.1.2.2.3.cmml">2</mn></msub></mrow><mo id="A1.Ex14.m1.2.2.1.1.1.1.1.1.4" xref="A1.Ex14.m1.2.2.1.1.1.1.1.1.4.cmml">+</mo><mrow id="A1.Ex14.m1.2.2.1.1.1.1.1.1.3" xref="A1.Ex14.m1.2.2.1.1.1.1.1.1.3.cmml"><msubsup id="A1.Ex14.m1.2.2.1.1.1.1.1.1.3.3" xref="A1.Ex14.m1.2.2.1.1.1.1.1.1.3.3.cmml"><mi id="A1.Ex14.m1.2.2.1.1.1.1.1.1.3.3.2.2" xref="A1.Ex14.m1.2.2.1.1.1.1.1.1.3.3.2.2.cmml">σ</mi><mrow id="A1.Ex14.m1.2.2.1.1.1.1.1.1.3.3.2.3" xref="A1.Ex14.m1.2.2.1.1.1.1.1.1.3.3.2.3.cmml"><msub id="A1.Ex14.m1.2.2.1.1.1.1.1.1.3.3.2.3.2" xref="A1.Ex14.m1.2.2.1.1.1.1.1.1.3.3.2.3.2.cmml"><mi id="A1.Ex14.m1.2.2.1.1.1.1.1.1.3.3.2.3.2.2" xref="A1.Ex14.m1.2.2.1.1.1.1.1.1.3.3.2.3.2.2.cmml">k</mi><mi id="A1.Ex14.m1.2.2.1.1.1.1.1.1.3.3.2.3.2.3" xref="A1.Ex14.m1.2.2.1.1.1.1.1.1.3.3.2.3.2.3.cmml">i</mi></msub><mo id="A1.Ex14.m1.2.2.1.1.1.1.1.1.3.3.2.3.1" xref="A1.Ex14.m1.2.2.1.1.1.1.1.1.3.3.2.3.1.cmml">+</mo><mn id="A1.Ex14.m1.2.2.1.1.1.1.1.1.3.3.2.3.3" xref="A1.Ex14.m1.2.2.1.1.1.1.1.1.3.3.2.3.3.cmml">1</mn></mrow><mrow id="A1.Ex14.m1.1.1.1.3" xref="A1.Ex14.m1.2.2.1.1.1.1.1.1.3.3.cmml"><mo id="A1.Ex14.m1.1.1.1.3.1" stretchy="false" xref="A1.Ex14.m1.2.2.1.1.1.1.1.1.3.3.cmml">(</mo><mi id="A1.Ex14.m1.1.1.1.1" xref="A1.Ex14.m1.1.1.1.1.cmml">i</mi><mo id="A1.Ex14.m1.1.1.1.3.2" stretchy="false" xref="A1.Ex14.m1.2.2.1.1.1.1.1.1.3.3.cmml">)</mo></mrow></msubsup><mo id="A1.Ex14.m1.2.2.1.1.1.1.1.1.3.2" xref="A1.Ex14.m1.2.2.1.1.1.1.1.1.3.2.cmml">⁢</mo><msub id="A1.Ex14.m1.2.2.1.1.1.1.1.1.3.1" xref="A1.Ex14.m1.2.2.1.1.1.1.1.1.3.1.cmml"><mrow id="A1.Ex14.m1.2.2.1.1.1.1.1.1.3.1.1.1" xref="A1.Ex14.m1.2.2.1.1.1.1.1.1.3.1.1.2.cmml"><mo id="A1.Ex14.m1.2.2.1.1.1.1.1.1.3.1.1.1.2" stretchy="false" xref="A1.Ex14.m1.2.2.1.1.1.1.1.1.3.1.1.2.1.cmml">‖</mo><msub id="A1.Ex14.m1.2.2.1.1.1.1.1.1.3.1.1.1.1" xref="A1.Ex14.m1.2.2.1.1.1.1.1.1.3.1.1.1.1.cmml"><mover accent="true" id="A1.Ex14.m1.2.2.1.1.1.1.1.1.3.1.1.1.1.2" xref="A1.Ex14.m1.2.2.1.1.1.1.1.1.3.1.1.1.1.2.cmml"><mi id="A1.Ex14.m1.2.2.1.1.1.1.1.1.3.1.1.1.1.2.2" xref="A1.Ex14.m1.2.2.1.1.1.1.1.1.3.1.1.1.1.2.2.cmml">x</mi><mo id="A1.Ex14.m1.2.2.1.1.1.1.1.1.3.1.1.1.1.2.1" xref="A1.Ex14.m1.2.2.1.1.1.1.1.1.3.1.1.1.1.2.1.cmml">~</mo></mover><mrow id="A1.Ex14.m1.2.2.1.1.1.1.1.1.3.1.1.1.1.3" xref="A1.Ex14.m1.2.2.1.1.1.1.1.1.3.1.1.1.1.3.cmml"><mi id="A1.Ex14.m1.2.2.1.1.1.1.1.1.3.1.1.1.1.3.2" xref="A1.Ex14.m1.2.2.1.1.1.1.1.1.3.1.1.1.1.3.2.cmml">i</mi><mo id="A1.Ex14.m1.2.2.1.1.1.1.1.1.3.1.1.1.1.3.1" xref="A1.Ex14.m1.2.2.1.1.1.1.1.1.3.1.1.1.1.3.1.cmml">−</mo><mn id="A1.Ex14.m1.2.2.1.1.1.1.1.1.3.1.1.1.1.3.3" xref="A1.Ex14.m1.2.2.1.1.1.1.1.1.3.1.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="A1.Ex14.m1.2.2.1.1.1.1.1.1.3.1.1.1.3" stretchy="false" xref="A1.Ex14.m1.2.2.1.1.1.1.1.1.3.1.1.2.1.cmml">‖</mo></mrow><mn id="A1.Ex14.m1.2.2.1.1.1.1.1.1.3.1.3" xref="A1.Ex14.m1.2.2.1.1.1.1.1.1.3.1.3.cmml">2</mn></msub></mrow></mrow><mo id="A1.Ex14.m1.2.2.1.1.1.1.1.3" xref="A1.Ex14.m1.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="A1.Ex14.m1.2.2.1.2" lspace="0em" xref="A1.Ex14.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex14.m1.2b"><apply id="A1.Ex14.m1.2.2.1.1.cmml" xref="A1.Ex14.m1.2.2.1"><leq id="A1.Ex14.m1.2.2.1.1.2.cmml" xref="A1.Ex14.m1.2.2.1.1.2"></leq><csymbol cd="latexml" id="A1.Ex14.m1.2.2.1.1.3.cmml" xref="A1.Ex14.m1.2.2.1.1.3">absent</csymbol><apply id="A1.Ex14.m1.2.2.1.1.1.cmml" xref="A1.Ex14.m1.2.2.1.1.1"><times id="A1.Ex14.m1.2.2.1.1.1.2.cmml" xref="A1.Ex14.m1.2.2.1.1.1.2"></times><apply id="A1.Ex14.m1.2.2.1.1.1.3.cmml" xref="A1.Ex14.m1.2.2.1.1.1.3"><csymbol cd="ambiguous" id="A1.Ex14.m1.2.2.1.1.1.3.1.cmml" xref="A1.Ex14.m1.2.2.1.1.1.3">subscript</csymbol><ci id="A1.Ex14.m1.2.2.1.1.1.3.2.cmml" xref="A1.Ex14.m1.2.2.1.1.1.3.2">𝐿</ci><ci id="A1.Ex14.m1.2.2.1.1.1.3.3.cmml" xref="A1.Ex14.m1.2.2.1.1.1.3.3">italic-ϕ</ci></apply><apply id="A1.Ex14.m1.2.2.1.1.1.1.1.1.cmml" xref="A1.Ex14.m1.2.2.1.1.1.1.1"><plus id="A1.Ex14.m1.2.2.1.1.1.1.1.1.4.cmml" xref="A1.Ex14.m1.2.2.1.1.1.1.1.1.4"></plus><apply id="A1.Ex14.m1.2.2.1.1.1.1.1.1.2.cmml" xref="A1.Ex14.m1.2.2.1.1.1.1.1.1.2"><times id="A1.Ex14.m1.2.2.1.1.1.1.1.1.2.3.cmml" xref="A1.Ex14.m1.2.2.1.1.1.1.1.1.2.3"></times><apply id="A1.Ex14.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex14.m1.2.2.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.Ex14.m1.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="A1.Ex14.m1.2.2.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="A1.Ex14.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.Ex14.m1.2.2.1.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="A1.Ex14.m1.2.2.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="A1.Ex14.m1.2.2.1.1.1.1.1.1.1.1.1.1.2">norm</csymbol><apply id="A1.Ex14.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex14.m1.2.2.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.Ex14.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex14.m1.2.2.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.Ex14.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.Ex14.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2">𝑊</ci><ci id="A1.Ex14.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.Ex14.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply><cn id="A1.Ex14.m1.2.2.1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="A1.Ex14.m1.2.2.1.1.1.1.1.1.1.1.3">2</cn></apply><apply id="A1.Ex14.m1.2.2.1.1.1.1.1.1.2.2.cmml" xref="A1.Ex14.m1.2.2.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="A1.Ex14.m1.2.2.1.1.1.1.1.1.2.2.2.cmml" xref="A1.Ex14.m1.2.2.1.1.1.1.1.1.2.2">subscript</csymbol><apply id="A1.Ex14.m1.2.2.1.1.1.1.1.1.2.2.1.2.cmml" xref="A1.Ex14.m1.2.2.1.1.1.1.1.1.2.2.1.1"><csymbol cd="latexml" id="A1.Ex14.m1.2.2.1.1.1.1.1.1.2.2.1.2.1.cmml" xref="A1.Ex14.m1.2.2.1.1.1.1.1.1.2.2.1.1.2">norm</csymbol><apply id="A1.Ex14.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.cmml" xref="A1.Ex14.m1.2.2.1.1.1.1.1.1.2.2.1.1.1"><minus id="A1.Ex14.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1.cmml" xref="A1.Ex14.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1"></minus><apply id="A1.Ex14.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.2.cmml" xref="A1.Ex14.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.2"><csymbol cd="ambiguous" id="A1.Ex14.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.2.1.cmml" xref="A1.Ex14.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.2">subscript</csymbol><ci id="A1.Ex14.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.2.2.cmml" xref="A1.Ex14.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.2.2">𝑥</ci><apply id="A1.Ex14.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.2.3.cmml" xref="A1.Ex14.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.2.3"><minus id="A1.Ex14.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.2.3.1.cmml" xref="A1.Ex14.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.2.3.1"></minus><ci id="A1.Ex14.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.2.3.2.cmml" xref="A1.Ex14.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.2.3.2">𝑖</ci><cn id="A1.Ex14.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.2.3.3.cmml" type="integer" xref="A1.Ex14.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.2.3.3">1</cn></apply></apply><apply id="A1.Ex14.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.3.cmml" xref="A1.Ex14.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.3"><csymbol cd="ambiguous" id="A1.Ex14.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.3.1.cmml" xref="A1.Ex14.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.3">subscript</csymbol><apply id="A1.Ex14.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.3.2.cmml" xref="A1.Ex14.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.3.2"><ci id="A1.Ex14.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.3.2.1.cmml" xref="A1.Ex14.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.3.2.1">~</ci><ci id="A1.Ex14.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.3.2.2.cmml" xref="A1.Ex14.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.3.2.2">𝑥</ci></apply><apply id="A1.Ex14.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.3.3.cmml" xref="A1.Ex14.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.3.3"><minus id="A1.Ex14.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.3.3.1.cmml" xref="A1.Ex14.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.3.3.1"></minus><ci id="A1.Ex14.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.3.3.2.cmml" xref="A1.Ex14.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.3.3.2">𝑖</ci><cn id="A1.Ex14.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.3.3.3.cmml" type="integer" xref="A1.Ex14.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.3.3.3">1</cn></apply></apply></apply></apply><cn id="A1.Ex14.m1.2.2.1.1.1.1.1.1.2.2.3.cmml" type="integer" xref="A1.Ex14.m1.2.2.1.1.1.1.1.1.2.2.3">2</cn></apply></apply><apply id="A1.Ex14.m1.2.2.1.1.1.1.1.1.3.cmml" xref="A1.Ex14.m1.2.2.1.1.1.1.1.1.3"><times id="A1.Ex14.m1.2.2.1.1.1.1.1.1.3.2.cmml" xref="A1.Ex14.m1.2.2.1.1.1.1.1.1.3.2"></times><apply id="A1.Ex14.m1.2.2.1.1.1.1.1.1.3.3.cmml" xref="A1.Ex14.m1.2.2.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="A1.Ex14.m1.2.2.1.1.1.1.1.1.3.3.1.cmml" xref="A1.Ex14.m1.2.2.1.1.1.1.1.1.3.3">superscript</csymbol><apply id="A1.Ex14.m1.2.2.1.1.1.1.1.1.3.3.2.cmml" xref="A1.Ex14.m1.2.2.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="A1.Ex14.m1.2.2.1.1.1.1.1.1.3.3.2.1.cmml" xref="A1.Ex14.m1.2.2.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="A1.Ex14.m1.2.2.1.1.1.1.1.1.3.3.2.2.cmml" xref="A1.Ex14.m1.2.2.1.1.1.1.1.1.3.3.2.2">𝜎</ci><apply id="A1.Ex14.m1.2.2.1.1.1.1.1.1.3.3.2.3.cmml" xref="A1.Ex14.m1.2.2.1.1.1.1.1.1.3.3.2.3"><plus id="A1.Ex14.m1.2.2.1.1.1.1.1.1.3.3.2.3.1.cmml" xref="A1.Ex14.m1.2.2.1.1.1.1.1.1.3.3.2.3.1"></plus><apply id="A1.Ex14.m1.2.2.1.1.1.1.1.1.3.3.2.3.2.cmml" xref="A1.Ex14.m1.2.2.1.1.1.1.1.1.3.3.2.3.2"><csymbol cd="ambiguous" id="A1.Ex14.m1.2.2.1.1.1.1.1.1.3.3.2.3.2.1.cmml" xref="A1.Ex14.m1.2.2.1.1.1.1.1.1.3.3.2.3.2">subscript</csymbol><ci id="A1.Ex14.m1.2.2.1.1.1.1.1.1.3.3.2.3.2.2.cmml" xref="A1.Ex14.m1.2.2.1.1.1.1.1.1.3.3.2.3.2.2">𝑘</ci><ci id="A1.Ex14.m1.2.2.1.1.1.1.1.1.3.3.2.3.2.3.cmml" xref="A1.Ex14.m1.2.2.1.1.1.1.1.1.3.3.2.3.2.3">𝑖</ci></apply><cn id="A1.Ex14.m1.2.2.1.1.1.1.1.1.3.3.2.3.3.cmml" type="integer" xref="A1.Ex14.m1.2.2.1.1.1.1.1.1.3.3.2.3.3">1</cn></apply></apply><ci id="A1.Ex14.m1.1.1.1.1.cmml" xref="A1.Ex14.m1.1.1.1.1">𝑖</ci></apply><apply id="A1.Ex14.m1.2.2.1.1.1.1.1.1.3.1.cmml" xref="A1.Ex14.m1.2.2.1.1.1.1.1.1.3.1"><csymbol cd="ambiguous" id="A1.Ex14.m1.2.2.1.1.1.1.1.1.3.1.2.cmml" xref="A1.Ex14.m1.2.2.1.1.1.1.1.1.3.1">subscript</csymbol><apply id="A1.Ex14.m1.2.2.1.1.1.1.1.1.3.1.1.2.cmml" xref="A1.Ex14.m1.2.2.1.1.1.1.1.1.3.1.1.1"><csymbol cd="latexml" id="A1.Ex14.m1.2.2.1.1.1.1.1.1.3.1.1.2.1.cmml" xref="A1.Ex14.m1.2.2.1.1.1.1.1.1.3.1.1.1.2">norm</csymbol><apply id="A1.Ex14.m1.2.2.1.1.1.1.1.1.3.1.1.1.1.cmml" xref="A1.Ex14.m1.2.2.1.1.1.1.1.1.3.1.1.1.1"><csymbol cd="ambiguous" id="A1.Ex14.m1.2.2.1.1.1.1.1.1.3.1.1.1.1.1.cmml" xref="A1.Ex14.m1.2.2.1.1.1.1.1.1.3.1.1.1.1">subscript</csymbol><apply id="A1.Ex14.m1.2.2.1.1.1.1.1.1.3.1.1.1.1.2.cmml" xref="A1.Ex14.m1.2.2.1.1.1.1.1.1.3.1.1.1.1.2"><ci id="A1.Ex14.m1.2.2.1.1.1.1.1.1.3.1.1.1.1.2.1.cmml" xref="A1.Ex14.m1.2.2.1.1.1.1.1.1.3.1.1.1.1.2.1">~</ci><ci id="A1.Ex14.m1.2.2.1.1.1.1.1.1.3.1.1.1.1.2.2.cmml" xref="A1.Ex14.m1.2.2.1.1.1.1.1.1.3.1.1.1.1.2.2">𝑥</ci></apply><apply id="A1.Ex14.m1.2.2.1.1.1.1.1.1.3.1.1.1.1.3.cmml" xref="A1.Ex14.m1.2.2.1.1.1.1.1.1.3.1.1.1.1.3"><minus id="A1.Ex14.m1.2.2.1.1.1.1.1.1.3.1.1.1.1.3.1.cmml" xref="A1.Ex14.m1.2.2.1.1.1.1.1.1.3.1.1.1.1.3.1"></minus><ci id="A1.Ex14.m1.2.2.1.1.1.1.1.1.3.1.1.1.1.3.2.cmml" xref="A1.Ex14.m1.2.2.1.1.1.1.1.1.3.1.1.1.1.3.2">𝑖</ci><cn id="A1.Ex14.m1.2.2.1.1.1.1.1.1.3.1.1.1.1.3.3.cmml" type="integer" xref="A1.Ex14.m1.2.2.1.1.1.1.1.1.3.1.1.1.1.3.3">1</cn></apply></apply></apply><cn id="A1.Ex14.m1.2.2.1.1.1.1.1.1.3.1.3.cmml" type="integer" xref="A1.Ex14.m1.2.2.1.1.1.1.1.1.3.1.3">2</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex14.m1.2c">\displaystyle\leq L_{\phi}\left(\|W_{i}\|_{2}\|x_{i-1}-\tilde{x}_{i-1}\|_{2}+%
\sigma_{k_{i}+1}^{(i)}\|\tilde{x}_{i-1}\|_{2}\right).</annotation><annotation encoding="application/x-llamapun" id="A1.Ex14.m1.2d">≤ italic_L start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ( ∥ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ∥ italic_x start_POSTSUBSCRIPT italic_i - 1 end_POSTSUBSCRIPT - over~ start_ARG italic_x end_ARG start_POSTSUBSCRIPT italic_i - 1 end_POSTSUBSCRIPT ∥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT + italic_σ start_POSTSUBSCRIPT italic_k start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT + 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT ∥ over~ start_ARG italic_x end_ARG start_POSTSUBSCRIPT italic_i - 1 end_POSTSUBSCRIPT ∥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="A1.SS2.p10">
<p class="ltx_p" id="A1.SS2.p10.1">We can bound <math alttext="\|\tilde{x}_{i-1}\|_{2}" class="ltx_Math" display="inline" id="A1.SS2.p10.1.m1.1"><semantics id="A1.SS2.p10.1.m1.1a"><msub id="A1.SS2.p10.1.m1.1.1" xref="A1.SS2.p10.1.m1.1.1.cmml"><mrow id="A1.SS2.p10.1.m1.1.1.1.1" xref="A1.SS2.p10.1.m1.1.1.1.2.cmml"><mo id="A1.SS2.p10.1.m1.1.1.1.1.2" stretchy="false" xref="A1.SS2.p10.1.m1.1.1.1.2.1.cmml">‖</mo><msub id="A1.SS2.p10.1.m1.1.1.1.1.1" xref="A1.SS2.p10.1.m1.1.1.1.1.1.cmml"><mover accent="true" id="A1.SS2.p10.1.m1.1.1.1.1.1.2" xref="A1.SS2.p10.1.m1.1.1.1.1.1.2.cmml"><mi id="A1.SS2.p10.1.m1.1.1.1.1.1.2.2" xref="A1.SS2.p10.1.m1.1.1.1.1.1.2.2.cmml">x</mi><mo id="A1.SS2.p10.1.m1.1.1.1.1.1.2.1" xref="A1.SS2.p10.1.m1.1.1.1.1.1.2.1.cmml">~</mo></mover><mrow id="A1.SS2.p10.1.m1.1.1.1.1.1.3" xref="A1.SS2.p10.1.m1.1.1.1.1.1.3.cmml"><mi id="A1.SS2.p10.1.m1.1.1.1.1.1.3.2" xref="A1.SS2.p10.1.m1.1.1.1.1.1.3.2.cmml">i</mi><mo id="A1.SS2.p10.1.m1.1.1.1.1.1.3.1" xref="A1.SS2.p10.1.m1.1.1.1.1.1.3.1.cmml">−</mo><mn id="A1.SS2.p10.1.m1.1.1.1.1.1.3.3" xref="A1.SS2.p10.1.m1.1.1.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="A1.SS2.p10.1.m1.1.1.1.1.3" stretchy="false" xref="A1.SS2.p10.1.m1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="A1.SS2.p10.1.m1.1.1.3" xref="A1.SS2.p10.1.m1.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="A1.SS2.p10.1.m1.1b"><apply id="A1.SS2.p10.1.m1.1.1.cmml" xref="A1.SS2.p10.1.m1.1.1"><csymbol cd="ambiguous" id="A1.SS2.p10.1.m1.1.1.2.cmml" xref="A1.SS2.p10.1.m1.1.1">subscript</csymbol><apply id="A1.SS2.p10.1.m1.1.1.1.2.cmml" xref="A1.SS2.p10.1.m1.1.1.1.1"><csymbol cd="latexml" id="A1.SS2.p10.1.m1.1.1.1.2.1.cmml" xref="A1.SS2.p10.1.m1.1.1.1.1.2">norm</csymbol><apply id="A1.SS2.p10.1.m1.1.1.1.1.1.cmml" xref="A1.SS2.p10.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.SS2.p10.1.m1.1.1.1.1.1.1.cmml" xref="A1.SS2.p10.1.m1.1.1.1.1.1">subscript</csymbol><apply id="A1.SS2.p10.1.m1.1.1.1.1.1.2.cmml" xref="A1.SS2.p10.1.m1.1.1.1.1.1.2"><ci id="A1.SS2.p10.1.m1.1.1.1.1.1.2.1.cmml" xref="A1.SS2.p10.1.m1.1.1.1.1.1.2.1">~</ci><ci id="A1.SS2.p10.1.m1.1.1.1.1.1.2.2.cmml" xref="A1.SS2.p10.1.m1.1.1.1.1.1.2.2">𝑥</ci></apply><apply id="A1.SS2.p10.1.m1.1.1.1.1.1.3.cmml" xref="A1.SS2.p10.1.m1.1.1.1.1.1.3"><minus id="A1.SS2.p10.1.m1.1.1.1.1.1.3.1.cmml" xref="A1.SS2.p10.1.m1.1.1.1.1.1.3.1"></minus><ci id="A1.SS2.p10.1.m1.1.1.1.1.1.3.2.cmml" xref="A1.SS2.p10.1.m1.1.1.1.1.1.3.2">𝑖</ci><cn id="A1.SS2.p10.1.m1.1.1.1.1.1.3.3.cmml" type="integer" xref="A1.SS2.p10.1.m1.1.1.1.1.1.3.3">1</cn></apply></apply></apply><cn id="A1.SS2.p10.1.m1.1.1.3.cmml" type="integer" xref="A1.SS2.p10.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p10.1.m1.1c">\|\tilde{x}_{i-1}\|_{2}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p10.1.m1.1d">∥ over~ start_ARG italic_x end_ARG start_POSTSUBSCRIPT italic_i - 1 end_POSTSUBSCRIPT ∥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math> using the triangle inequality:</p>
</div>
<div class="ltx_para" id="A1.SS2.p11">
<table class="ltx_equation ltx_eqn_table" id="A1.Ex15">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\|\tilde{x}_{i-1}\|_{2}\leq\|x_{i-1}\|_{2}+\|x_{i-1}-\tilde{x}_{i-1}\|_{2}." class="ltx_Math" display="block" id="A1.Ex15.m1.1"><semantics id="A1.Ex15.m1.1a"><mrow id="A1.Ex15.m1.1.1.1" xref="A1.Ex15.m1.1.1.1.1.cmml"><mrow id="A1.Ex15.m1.1.1.1.1" xref="A1.Ex15.m1.1.1.1.1.cmml"><msub id="A1.Ex15.m1.1.1.1.1.1" xref="A1.Ex15.m1.1.1.1.1.1.cmml"><mrow id="A1.Ex15.m1.1.1.1.1.1.1.1" xref="A1.Ex15.m1.1.1.1.1.1.1.2.cmml"><mo id="A1.Ex15.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="A1.Ex15.m1.1.1.1.1.1.1.2.1.cmml">‖</mo><msub id="A1.Ex15.m1.1.1.1.1.1.1.1.1" xref="A1.Ex15.m1.1.1.1.1.1.1.1.1.cmml"><mover accent="true" id="A1.Ex15.m1.1.1.1.1.1.1.1.1.2" xref="A1.Ex15.m1.1.1.1.1.1.1.1.1.2.cmml"><mi id="A1.Ex15.m1.1.1.1.1.1.1.1.1.2.2" xref="A1.Ex15.m1.1.1.1.1.1.1.1.1.2.2.cmml">x</mi><mo id="A1.Ex15.m1.1.1.1.1.1.1.1.1.2.1" xref="A1.Ex15.m1.1.1.1.1.1.1.1.1.2.1.cmml">~</mo></mover><mrow id="A1.Ex15.m1.1.1.1.1.1.1.1.1.3" xref="A1.Ex15.m1.1.1.1.1.1.1.1.1.3.cmml"><mi id="A1.Ex15.m1.1.1.1.1.1.1.1.1.3.2" xref="A1.Ex15.m1.1.1.1.1.1.1.1.1.3.2.cmml">i</mi><mo id="A1.Ex15.m1.1.1.1.1.1.1.1.1.3.1" xref="A1.Ex15.m1.1.1.1.1.1.1.1.1.3.1.cmml">−</mo><mn id="A1.Ex15.m1.1.1.1.1.1.1.1.1.3.3" xref="A1.Ex15.m1.1.1.1.1.1.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="A1.Ex15.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="A1.Ex15.m1.1.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="A1.Ex15.m1.1.1.1.1.1.3" xref="A1.Ex15.m1.1.1.1.1.1.3.cmml">2</mn></msub><mo id="A1.Ex15.m1.1.1.1.1.4" xref="A1.Ex15.m1.1.1.1.1.4.cmml">≤</mo><mrow id="A1.Ex15.m1.1.1.1.1.3" xref="A1.Ex15.m1.1.1.1.1.3.cmml"><msub id="A1.Ex15.m1.1.1.1.1.2.1" xref="A1.Ex15.m1.1.1.1.1.2.1.cmml"><mrow id="A1.Ex15.m1.1.1.1.1.2.1.1.1" xref="A1.Ex15.m1.1.1.1.1.2.1.1.2.cmml"><mo id="A1.Ex15.m1.1.1.1.1.2.1.1.1.2" stretchy="false" xref="A1.Ex15.m1.1.1.1.1.2.1.1.2.1.cmml">‖</mo><msub id="A1.Ex15.m1.1.1.1.1.2.1.1.1.1" xref="A1.Ex15.m1.1.1.1.1.2.1.1.1.1.cmml"><mi id="A1.Ex15.m1.1.1.1.1.2.1.1.1.1.2" xref="A1.Ex15.m1.1.1.1.1.2.1.1.1.1.2.cmml">x</mi><mrow id="A1.Ex15.m1.1.1.1.1.2.1.1.1.1.3" xref="A1.Ex15.m1.1.1.1.1.2.1.1.1.1.3.cmml"><mi id="A1.Ex15.m1.1.1.1.1.2.1.1.1.1.3.2" xref="A1.Ex15.m1.1.1.1.1.2.1.1.1.1.3.2.cmml">i</mi><mo id="A1.Ex15.m1.1.1.1.1.2.1.1.1.1.3.1" xref="A1.Ex15.m1.1.1.1.1.2.1.1.1.1.3.1.cmml">−</mo><mn id="A1.Ex15.m1.1.1.1.1.2.1.1.1.1.3.3" xref="A1.Ex15.m1.1.1.1.1.2.1.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="A1.Ex15.m1.1.1.1.1.2.1.1.1.3" stretchy="false" xref="A1.Ex15.m1.1.1.1.1.2.1.1.2.1.cmml">‖</mo></mrow><mn id="A1.Ex15.m1.1.1.1.1.2.1.3" xref="A1.Ex15.m1.1.1.1.1.2.1.3.cmml">2</mn></msub><mo id="A1.Ex15.m1.1.1.1.1.3.3" xref="A1.Ex15.m1.1.1.1.1.3.3.cmml">+</mo><msub id="A1.Ex15.m1.1.1.1.1.3.2" xref="A1.Ex15.m1.1.1.1.1.3.2.cmml"><mrow id="A1.Ex15.m1.1.1.1.1.3.2.1.1" xref="A1.Ex15.m1.1.1.1.1.3.2.1.2.cmml"><mo id="A1.Ex15.m1.1.1.1.1.3.2.1.1.2" stretchy="false" xref="A1.Ex15.m1.1.1.1.1.3.2.1.2.1.cmml">‖</mo><mrow id="A1.Ex15.m1.1.1.1.1.3.2.1.1.1" xref="A1.Ex15.m1.1.1.1.1.3.2.1.1.1.cmml"><msub id="A1.Ex15.m1.1.1.1.1.3.2.1.1.1.2" xref="A1.Ex15.m1.1.1.1.1.3.2.1.1.1.2.cmml"><mi id="A1.Ex15.m1.1.1.1.1.3.2.1.1.1.2.2" xref="A1.Ex15.m1.1.1.1.1.3.2.1.1.1.2.2.cmml">x</mi><mrow id="A1.Ex15.m1.1.1.1.1.3.2.1.1.1.2.3" xref="A1.Ex15.m1.1.1.1.1.3.2.1.1.1.2.3.cmml"><mi id="A1.Ex15.m1.1.1.1.1.3.2.1.1.1.2.3.2" xref="A1.Ex15.m1.1.1.1.1.3.2.1.1.1.2.3.2.cmml">i</mi><mo id="A1.Ex15.m1.1.1.1.1.3.2.1.1.1.2.3.1" xref="A1.Ex15.m1.1.1.1.1.3.2.1.1.1.2.3.1.cmml">−</mo><mn id="A1.Ex15.m1.1.1.1.1.3.2.1.1.1.2.3.3" xref="A1.Ex15.m1.1.1.1.1.3.2.1.1.1.2.3.3.cmml">1</mn></mrow></msub><mo id="A1.Ex15.m1.1.1.1.1.3.2.1.1.1.1" xref="A1.Ex15.m1.1.1.1.1.3.2.1.1.1.1.cmml">−</mo><msub id="A1.Ex15.m1.1.1.1.1.3.2.1.1.1.3" xref="A1.Ex15.m1.1.1.1.1.3.2.1.1.1.3.cmml"><mover accent="true" id="A1.Ex15.m1.1.1.1.1.3.2.1.1.1.3.2" xref="A1.Ex15.m1.1.1.1.1.3.2.1.1.1.3.2.cmml"><mi id="A1.Ex15.m1.1.1.1.1.3.2.1.1.1.3.2.2" xref="A1.Ex15.m1.1.1.1.1.3.2.1.1.1.3.2.2.cmml">x</mi><mo id="A1.Ex15.m1.1.1.1.1.3.2.1.1.1.3.2.1" xref="A1.Ex15.m1.1.1.1.1.3.2.1.1.1.3.2.1.cmml">~</mo></mover><mrow id="A1.Ex15.m1.1.1.1.1.3.2.1.1.1.3.3" xref="A1.Ex15.m1.1.1.1.1.3.2.1.1.1.3.3.cmml"><mi id="A1.Ex15.m1.1.1.1.1.3.2.1.1.1.3.3.2" xref="A1.Ex15.m1.1.1.1.1.3.2.1.1.1.3.3.2.cmml">i</mi><mo id="A1.Ex15.m1.1.1.1.1.3.2.1.1.1.3.3.1" xref="A1.Ex15.m1.1.1.1.1.3.2.1.1.1.3.3.1.cmml">−</mo><mn id="A1.Ex15.m1.1.1.1.1.3.2.1.1.1.3.3.3" xref="A1.Ex15.m1.1.1.1.1.3.2.1.1.1.3.3.3.cmml">1</mn></mrow></msub></mrow><mo id="A1.Ex15.m1.1.1.1.1.3.2.1.1.3" stretchy="false" xref="A1.Ex15.m1.1.1.1.1.3.2.1.2.1.cmml">‖</mo></mrow><mn id="A1.Ex15.m1.1.1.1.1.3.2.3" xref="A1.Ex15.m1.1.1.1.1.3.2.3.cmml">2</mn></msub></mrow></mrow><mo id="A1.Ex15.m1.1.1.1.2" lspace="0em" xref="A1.Ex15.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex15.m1.1b"><apply id="A1.Ex15.m1.1.1.1.1.cmml" xref="A1.Ex15.m1.1.1.1"><leq id="A1.Ex15.m1.1.1.1.1.4.cmml" xref="A1.Ex15.m1.1.1.1.1.4"></leq><apply id="A1.Ex15.m1.1.1.1.1.1.cmml" xref="A1.Ex15.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.Ex15.m1.1.1.1.1.1.2.cmml" xref="A1.Ex15.m1.1.1.1.1.1">subscript</csymbol><apply id="A1.Ex15.m1.1.1.1.1.1.1.2.cmml" xref="A1.Ex15.m1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="A1.Ex15.m1.1.1.1.1.1.1.2.1.cmml" xref="A1.Ex15.m1.1.1.1.1.1.1.1.2">norm</csymbol><apply id="A1.Ex15.m1.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex15.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.Ex15.m1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex15.m1.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="A1.Ex15.m1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.Ex15.m1.1.1.1.1.1.1.1.1.2"><ci id="A1.Ex15.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="A1.Ex15.m1.1.1.1.1.1.1.1.1.2.1">~</ci><ci id="A1.Ex15.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="A1.Ex15.m1.1.1.1.1.1.1.1.1.2.2">𝑥</ci></apply><apply id="A1.Ex15.m1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.Ex15.m1.1.1.1.1.1.1.1.1.3"><minus id="A1.Ex15.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="A1.Ex15.m1.1.1.1.1.1.1.1.1.3.1"></minus><ci id="A1.Ex15.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="A1.Ex15.m1.1.1.1.1.1.1.1.1.3.2">𝑖</ci><cn id="A1.Ex15.m1.1.1.1.1.1.1.1.1.3.3.cmml" type="integer" xref="A1.Ex15.m1.1.1.1.1.1.1.1.1.3.3">1</cn></apply></apply></apply><cn id="A1.Ex15.m1.1.1.1.1.1.3.cmml" type="integer" xref="A1.Ex15.m1.1.1.1.1.1.3">2</cn></apply><apply id="A1.Ex15.m1.1.1.1.1.3.cmml" xref="A1.Ex15.m1.1.1.1.1.3"><plus id="A1.Ex15.m1.1.1.1.1.3.3.cmml" xref="A1.Ex15.m1.1.1.1.1.3.3"></plus><apply id="A1.Ex15.m1.1.1.1.1.2.1.cmml" xref="A1.Ex15.m1.1.1.1.1.2.1"><csymbol cd="ambiguous" id="A1.Ex15.m1.1.1.1.1.2.1.2.cmml" xref="A1.Ex15.m1.1.1.1.1.2.1">subscript</csymbol><apply id="A1.Ex15.m1.1.1.1.1.2.1.1.2.cmml" xref="A1.Ex15.m1.1.1.1.1.2.1.1.1"><csymbol cd="latexml" id="A1.Ex15.m1.1.1.1.1.2.1.1.2.1.cmml" xref="A1.Ex15.m1.1.1.1.1.2.1.1.1.2">norm</csymbol><apply id="A1.Ex15.m1.1.1.1.1.2.1.1.1.1.cmml" xref="A1.Ex15.m1.1.1.1.1.2.1.1.1.1"><csymbol cd="ambiguous" id="A1.Ex15.m1.1.1.1.1.2.1.1.1.1.1.cmml" xref="A1.Ex15.m1.1.1.1.1.2.1.1.1.1">subscript</csymbol><ci id="A1.Ex15.m1.1.1.1.1.2.1.1.1.1.2.cmml" xref="A1.Ex15.m1.1.1.1.1.2.1.1.1.1.2">𝑥</ci><apply id="A1.Ex15.m1.1.1.1.1.2.1.1.1.1.3.cmml" xref="A1.Ex15.m1.1.1.1.1.2.1.1.1.1.3"><minus id="A1.Ex15.m1.1.1.1.1.2.1.1.1.1.3.1.cmml" xref="A1.Ex15.m1.1.1.1.1.2.1.1.1.1.3.1"></minus><ci id="A1.Ex15.m1.1.1.1.1.2.1.1.1.1.3.2.cmml" xref="A1.Ex15.m1.1.1.1.1.2.1.1.1.1.3.2">𝑖</ci><cn id="A1.Ex15.m1.1.1.1.1.2.1.1.1.1.3.3.cmml" type="integer" xref="A1.Ex15.m1.1.1.1.1.2.1.1.1.1.3.3">1</cn></apply></apply></apply><cn id="A1.Ex15.m1.1.1.1.1.2.1.3.cmml" type="integer" xref="A1.Ex15.m1.1.1.1.1.2.1.3">2</cn></apply><apply id="A1.Ex15.m1.1.1.1.1.3.2.cmml" xref="A1.Ex15.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="A1.Ex15.m1.1.1.1.1.3.2.2.cmml" xref="A1.Ex15.m1.1.1.1.1.3.2">subscript</csymbol><apply id="A1.Ex15.m1.1.1.1.1.3.2.1.2.cmml" xref="A1.Ex15.m1.1.1.1.1.3.2.1.1"><csymbol cd="latexml" id="A1.Ex15.m1.1.1.1.1.3.2.1.2.1.cmml" xref="A1.Ex15.m1.1.1.1.1.3.2.1.1.2">norm</csymbol><apply id="A1.Ex15.m1.1.1.1.1.3.2.1.1.1.cmml" xref="A1.Ex15.m1.1.1.1.1.3.2.1.1.1"><minus id="A1.Ex15.m1.1.1.1.1.3.2.1.1.1.1.cmml" xref="A1.Ex15.m1.1.1.1.1.3.2.1.1.1.1"></minus><apply id="A1.Ex15.m1.1.1.1.1.3.2.1.1.1.2.cmml" xref="A1.Ex15.m1.1.1.1.1.3.2.1.1.1.2"><csymbol cd="ambiguous" id="A1.Ex15.m1.1.1.1.1.3.2.1.1.1.2.1.cmml" xref="A1.Ex15.m1.1.1.1.1.3.2.1.1.1.2">subscript</csymbol><ci id="A1.Ex15.m1.1.1.1.1.3.2.1.1.1.2.2.cmml" xref="A1.Ex15.m1.1.1.1.1.3.2.1.1.1.2.2">𝑥</ci><apply id="A1.Ex15.m1.1.1.1.1.3.2.1.1.1.2.3.cmml" xref="A1.Ex15.m1.1.1.1.1.3.2.1.1.1.2.3"><minus id="A1.Ex15.m1.1.1.1.1.3.2.1.1.1.2.3.1.cmml" xref="A1.Ex15.m1.1.1.1.1.3.2.1.1.1.2.3.1"></minus><ci id="A1.Ex15.m1.1.1.1.1.3.2.1.1.1.2.3.2.cmml" xref="A1.Ex15.m1.1.1.1.1.3.2.1.1.1.2.3.2">𝑖</ci><cn id="A1.Ex15.m1.1.1.1.1.3.2.1.1.1.2.3.3.cmml" type="integer" xref="A1.Ex15.m1.1.1.1.1.3.2.1.1.1.2.3.3">1</cn></apply></apply><apply id="A1.Ex15.m1.1.1.1.1.3.2.1.1.1.3.cmml" xref="A1.Ex15.m1.1.1.1.1.3.2.1.1.1.3"><csymbol cd="ambiguous" id="A1.Ex15.m1.1.1.1.1.3.2.1.1.1.3.1.cmml" xref="A1.Ex15.m1.1.1.1.1.3.2.1.1.1.3">subscript</csymbol><apply id="A1.Ex15.m1.1.1.1.1.3.2.1.1.1.3.2.cmml" xref="A1.Ex15.m1.1.1.1.1.3.2.1.1.1.3.2"><ci id="A1.Ex15.m1.1.1.1.1.3.2.1.1.1.3.2.1.cmml" xref="A1.Ex15.m1.1.1.1.1.3.2.1.1.1.3.2.1">~</ci><ci id="A1.Ex15.m1.1.1.1.1.3.2.1.1.1.3.2.2.cmml" xref="A1.Ex15.m1.1.1.1.1.3.2.1.1.1.3.2.2">𝑥</ci></apply><apply id="A1.Ex15.m1.1.1.1.1.3.2.1.1.1.3.3.cmml" xref="A1.Ex15.m1.1.1.1.1.3.2.1.1.1.3.3"><minus id="A1.Ex15.m1.1.1.1.1.3.2.1.1.1.3.3.1.cmml" xref="A1.Ex15.m1.1.1.1.1.3.2.1.1.1.3.3.1"></minus><ci id="A1.Ex15.m1.1.1.1.1.3.2.1.1.1.3.3.2.cmml" xref="A1.Ex15.m1.1.1.1.1.3.2.1.1.1.3.3.2">𝑖</ci><cn id="A1.Ex15.m1.1.1.1.1.3.2.1.1.1.3.3.3.cmml" type="integer" xref="A1.Ex15.m1.1.1.1.1.3.2.1.1.1.3.3.3">1</cn></apply></apply></apply></apply><cn id="A1.Ex15.m1.1.1.1.1.3.2.3.cmml" type="integer" xref="A1.Ex15.m1.1.1.1.1.3.2.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex15.m1.1c">\|\tilde{x}_{i-1}\|_{2}\leq\|x_{i-1}\|_{2}+\|x_{i-1}-\tilde{x}_{i-1}\|_{2}.</annotation><annotation encoding="application/x-llamapun" id="A1.Ex15.m1.1d">∥ over~ start_ARG italic_x end_ARG start_POSTSUBSCRIPT italic_i - 1 end_POSTSUBSCRIPT ∥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ≤ ∥ italic_x start_POSTSUBSCRIPT italic_i - 1 end_POSTSUBSCRIPT ∥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT + ∥ italic_x start_POSTSUBSCRIPT italic_i - 1 end_POSTSUBSCRIPT - over~ start_ARG italic_x end_ARG start_POSTSUBSCRIPT italic_i - 1 end_POSTSUBSCRIPT ∥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="A1.SS2.p12">
<p class="ltx_p" id="A1.SS2.p12.3">Assuming that <math alttext="\|x_{i-1}\|_{2}" class="ltx_Math" display="inline" id="A1.SS2.p12.1.m1.1"><semantics id="A1.SS2.p12.1.m1.1a"><msub id="A1.SS2.p12.1.m1.1.1" xref="A1.SS2.p12.1.m1.1.1.cmml"><mrow id="A1.SS2.p12.1.m1.1.1.1.1" xref="A1.SS2.p12.1.m1.1.1.1.2.cmml"><mo id="A1.SS2.p12.1.m1.1.1.1.1.2" stretchy="false" xref="A1.SS2.p12.1.m1.1.1.1.2.1.cmml">‖</mo><msub id="A1.SS2.p12.1.m1.1.1.1.1.1" xref="A1.SS2.p12.1.m1.1.1.1.1.1.cmml"><mi id="A1.SS2.p12.1.m1.1.1.1.1.1.2" xref="A1.SS2.p12.1.m1.1.1.1.1.1.2.cmml">x</mi><mrow id="A1.SS2.p12.1.m1.1.1.1.1.1.3" xref="A1.SS2.p12.1.m1.1.1.1.1.1.3.cmml"><mi id="A1.SS2.p12.1.m1.1.1.1.1.1.3.2" xref="A1.SS2.p12.1.m1.1.1.1.1.1.3.2.cmml">i</mi><mo id="A1.SS2.p12.1.m1.1.1.1.1.1.3.1" xref="A1.SS2.p12.1.m1.1.1.1.1.1.3.1.cmml">−</mo><mn id="A1.SS2.p12.1.m1.1.1.1.1.1.3.3" xref="A1.SS2.p12.1.m1.1.1.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="A1.SS2.p12.1.m1.1.1.1.1.3" stretchy="false" xref="A1.SS2.p12.1.m1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="A1.SS2.p12.1.m1.1.1.3" xref="A1.SS2.p12.1.m1.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="A1.SS2.p12.1.m1.1b"><apply id="A1.SS2.p12.1.m1.1.1.cmml" xref="A1.SS2.p12.1.m1.1.1"><csymbol cd="ambiguous" id="A1.SS2.p12.1.m1.1.1.2.cmml" xref="A1.SS2.p12.1.m1.1.1">subscript</csymbol><apply id="A1.SS2.p12.1.m1.1.1.1.2.cmml" xref="A1.SS2.p12.1.m1.1.1.1.1"><csymbol cd="latexml" id="A1.SS2.p12.1.m1.1.1.1.2.1.cmml" xref="A1.SS2.p12.1.m1.1.1.1.1.2">norm</csymbol><apply id="A1.SS2.p12.1.m1.1.1.1.1.1.cmml" xref="A1.SS2.p12.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.SS2.p12.1.m1.1.1.1.1.1.1.cmml" xref="A1.SS2.p12.1.m1.1.1.1.1.1">subscript</csymbol><ci id="A1.SS2.p12.1.m1.1.1.1.1.1.2.cmml" xref="A1.SS2.p12.1.m1.1.1.1.1.1.2">𝑥</ci><apply id="A1.SS2.p12.1.m1.1.1.1.1.1.3.cmml" xref="A1.SS2.p12.1.m1.1.1.1.1.1.3"><minus id="A1.SS2.p12.1.m1.1.1.1.1.1.3.1.cmml" xref="A1.SS2.p12.1.m1.1.1.1.1.1.3.1"></minus><ci id="A1.SS2.p12.1.m1.1.1.1.1.1.3.2.cmml" xref="A1.SS2.p12.1.m1.1.1.1.1.1.3.2">𝑖</ci><cn id="A1.SS2.p12.1.m1.1.1.1.1.1.3.3.cmml" type="integer" xref="A1.SS2.p12.1.m1.1.1.1.1.1.3.3">1</cn></apply></apply></apply><cn id="A1.SS2.p12.1.m1.1.1.3.cmml" type="integer" xref="A1.SS2.p12.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p12.1.m1.1c">\|x_{i-1}\|_{2}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p12.1.m1.1d">∥ italic_x start_POSTSUBSCRIPT italic_i - 1 end_POSTSUBSCRIPT ∥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math> is bounded (which is reasonable in practice due to normalization techniques), and applying the inductive hypothesis, we can express <math alttext="\|x_{i}-\tilde{x}_{i}\|_{2}" class="ltx_Math" display="inline" id="A1.SS2.p12.2.m2.1"><semantics id="A1.SS2.p12.2.m2.1a"><msub id="A1.SS2.p12.2.m2.1.1" xref="A1.SS2.p12.2.m2.1.1.cmml"><mrow id="A1.SS2.p12.2.m2.1.1.1.1" xref="A1.SS2.p12.2.m2.1.1.1.2.cmml"><mo id="A1.SS2.p12.2.m2.1.1.1.1.2" stretchy="false" xref="A1.SS2.p12.2.m2.1.1.1.2.1.cmml">‖</mo><mrow id="A1.SS2.p12.2.m2.1.1.1.1.1" xref="A1.SS2.p12.2.m2.1.1.1.1.1.cmml"><msub id="A1.SS2.p12.2.m2.1.1.1.1.1.2" xref="A1.SS2.p12.2.m2.1.1.1.1.1.2.cmml"><mi id="A1.SS2.p12.2.m2.1.1.1.1.1.2.2" xref="A1.SS2.p12.2.m2.1.1.1.1.1.2.2.cmml">x</mi><mi id="A1.SS2.p12.2.m2.1.1.1.1.1.2.3" xref="A1.SS2.p12.2.m2.1.1.1.1.1.2.3.cmml">i</mi></msub><mo id="A1.SS2.p12.2.m2.1.1.1.1.1.1" xref="A1.SS2.p12.2.m2.1.1.1.1.1.1.cmml">−</mo><msub id="A1.SS2.p12.2.m2.1.1.1.1.1.3" xref="A1.SS2.p12.2.m2.1.1.1.1.1.3.cmml"><mover accent="true" id="A1.SS2.p12.2.m2.1.1.1.1.1.3.2" xref="A1.SS2.p12.2.m2.1.1.1.1.1.3.2.cmml"><mi id="A1.SS2.p12.2.m2.1.1.1.1.1.3.2.2" xref="A1.SS2.p12.2.m2.1.1.1.1.1.3.2.2.cmml">x</mi><mo id="A1.SS2.p12.2.m2.1.1.1.1.1.3.2.1" xref="A1.SS2.p12.2.m2.1.1.1.1.1.3.2.1.cmml">~</mo></mover><mi id="A1.SS2.p12.2.m2.1.1.1.1.1.3.3" xref="A1.SS2.p12.2.m2.1.1.1.1.1.3.3.cmml">i</mi></msub></mrow><mo id="A1.SS2.p12.2.m2.1.1.1.1.3" stretchy="false" xref="A1.SS2.p12.2.m2.1.1.1.2.1.cmml">‖</mo></mrow><mn id="A1.SS2.p12.2.m2.1.1.3" xref="A1.SS2.p12.2.m2.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="A1.SS2.p12.2.m2.1b"><apply id="A1.SS2.p12.2.m2.1.1.cmml" xref="A1.SS2.p12.2.m2.1.1"><csymbol cd="ambiguous" id="A1.SS2.p12.2.m2.1.1.2.cmml" xref="A1.SS2.p12.2.m2.1.1">subscript</csymbol><apply id="A1.SS2.p12.2.m2.1.1.1.2.cmml" xref="A1.SS2.p12.2.m2.1.1.1.1"><csymbol cd="latexml" id="A1.SS2.p12.2.m2.1.1.1.2.1.cmml" xref="A1.SS2.p12.2.m2.1.1.1.1.2">norm</csymbol><apply id="A1.SS2.p12.2.m2.1.1.1.1.1.cmml" xref="A1.SS2.p12.2.m2.1.1.1.1.1"><minus id="A1.SS2.p12.2.m2.1.1.1.1.1.1.cmml" xref="A1.SS2.p12.2.m2.1.1.1.1.1.1"></minus><apply id="A1.SS2.p12.2.m2.1.1.1.1.1.2.cmml" xref="A1.SS2.p12.2.m2.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.SS2.p12.2.m2.1.1.1.1.1.2.1.cmml" xref="A1.SS2.p12.2.m2.1.1.1.1.1.2">subscript</csymbol><ci id="A1.SS2.p12.2.m2.1.1.1.1.1.2.2.cmml" xref="A1.SS2.p12.2.m2.1.1.1.1.1.2.2">𝑥</ci><ci id="A1.SS2.p12.2.m2.1.1.1.1.1.2.3.cmml" xref="A1.SS2.p12.2.m2.1.1.1.1.1.2.3">𝑖</ci></apply><apply id="A1.SS2.p12.2.m2.1.1.1.1.1.3.cmml" xref="A1.SS2.p12.2.m2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.SS2.p12.2.m2.1.1.1.1.1.3.1.cmml" xref="A1.SS2.p12.2.m2.1.1.1.1.1.3">subscript</csymbol><apply id="A1.SS2.p12.2.m2.1.1.1.1.1.3.2.cmml" xref="A1.SS2.p12.2.m2.1.1.1.1.1.3.2"><ci id="A1.SS2.p12.2.m2.1.1.1.1.1.3.2.1.cmml" xref="A1.SS2.p12.2.m2.1.1.1.1.1.3.2.1">~</ci><ci id="A1.SS2.p12.2.m2.1.1.1.1.1.3.2.2.cmml" xref="A1.SS2.p12.2.m2.1.1.1.1.1.3.2.2">𝑥</ci></apply><ci id="A1.SS2.p12.2.m2.1.1.1.1.1.3.3.cmml" xref="A1.SS2.p12.2.m2.1.1.1.1.1.3.3">𝑖</ci></apply></apply></apply><cn id="A1.SS2.p12.2.m2.1.1.3.cmml" type="integer" xref="A1.SS2.p12.2.m2.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p12.2.m2.1c">\|x_{i}-\tilde{x}_{i}\|_{2}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p12.2.m2.1d">∥ italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT - over~ start_ARG italic_x end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math> in terms of the accumulated errors up to layer <math alttext="i" class="ltx_Math" display="inline" id="A1.SS2.p12.3.m3.1"><semantics id="A1.SS2.p12.3.m3.1a"><mi id="A1.SS2.p12.3.m3.1.1" xref="A1.SS2.p12.3.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.p12.3.m3.1b"><ci id="A1.SS2.p12.3.m3.1.1.cmml" xref="A1.SS2.p12.3.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p12.3.m3.1c">i</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p12.3.m3.1d">italic_i</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="A1.SS2.p13">
<p class="ltx_p" id="A1.SS2.p13.1">By recursively applying this inequality and summing over all layers, we obtain the bound stated in Theorem <a class="ltx_ref" href="https://arxiv.org/html/2410.03111v1#Thmtheorem3" title="Theorem 3 ‣ 5.3 Error Propagation Bound ‣ 5 Error Bounds for KV Cache Compression ‣ LoRC: Low-Rank Compression for LLMs KV Cache with a Progressive Compression Strategy"><span class="ltx_text ltx_ref_tag">3</span></a>.</p>
</div>
<div class="ltx_para" id="A1.SS2.p14">
<p class="ltx_p" id="A1.SS2.p14.1"><math alttext="\square" class="ltx_Math" display="inline" id="A1.SS2.p14.1.m1.1"><semantics id="A1.SS2.p14.1.m1.1a"><mi id="A1.SS2.p14.1.m1.1.1" mathvariant="normal" xref="A1.SS2.p14.1.m1.1.1.cmml">□</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.p14.1.m1.1b"><ci id="A1.SS2.p14.1.m1.1.1.cmml" xref="A1.SS2.p14.1.m1.1.1">□</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p14.1.m1.1c">\square</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p14.1.m1.1d">□</annotation></semantics></math></p>
</div>
</section>
<section class="ltx_subsection" id="A1.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.3 </span>Note on Activation Functions and the Lipschitz Constant</h3>
<div class="ltx_para" id="A1.SS3.p1">
<p class="ltx_p" id="A1.SS3.p1.2">It is important to note that Theorem <a class="ltx_ref" href="https://arxiv.org/html/2410.03111v1#Thmtheorem3" title="Theorem 3 ‣ 5.3 Error Propagation Bound ‣ 5 Error Bounds for KV Cache Compression ‣ LoRC: Low-Rank Compression for LLMs KV Cache with a Progressive Compression Strategy"><span class="ltx_text ltx_ref_tag">3</span></a> assumes the activation function <math alttext="\phi" class="ltx_Math" display="inline" id="A1.SS3.p1.1.m1.1"><semantics id="A1.SS3.p1.1.m1.1a"><mi id="A1.SS3.p1.1.m1.1.1" xref="A1.SS3.p1.1.m1.1.1.cmml">ϕ</mi><annotation-xml encoding="MathML-Content" id="A1.SS3.p1.1.m1.1b"><ci id="A1.SS3.p1.1.m1.1.1.cmml" xref="A1.SS3.p1.1.m1.1.1">italic-ϕ</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.p1.1.m1.1c">\phi</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.p1.1.m1.1d">italic_ϕ</annotation></semantics></math> has a Lipschitz constant <math alttext="L_{\phi}" class="ltx_Math" display="inline" id="A1.SS3.p1.2.m2.1"><semantics id="A1.SS3.p1.2.m2.1a"><msub id="A1.SS3.p1.2.m2.1.1" xref="A1.SS3.p1.2.m2.1.1.cmml"><mi id="A1.SS3.p1.2.m2.1.1.2" xref="A1.SS3.p1.2.m2.1.1.2.cmml">L</mi><mi id="A1.SS3.p1.2.m2.1.1.3" xref="A1.SS3.p1.2.m2.1.1.3.cmml">ϕ</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS3.p1.2.m2.1b"><apply id="A1.SS3.p1.2.m2.1.1.cmml" xref="A1.SS3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="A1.SS3.p1.2.m2.1.1.1.cmml" xref="A1.SS3.p1.2.m2.1.1">subscript</csymbol><ci id="A1.SS3.p1.2.m2.1.1.2.cmml" xref="A1.SS3.p1.2.m2.1.1.2">𝐿</ci><ci id="A1.SS3.p1.2.m2.1.1.3.cmml" xref="A1.SS3.p1.2.m2.1.1.3">italic-ϕ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.p1.2.m2.1c">L_{\phi}</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.p1.2.m2.1d">italic_L start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT</annotation></semantics></math>, which reflects how much the function can amplify differences in its input. For activation functions like ReLU, which are 1-Lipschitz, the error bound simplifies and indicates minimal error amplification through the activation layers.</p>
</div>
<div class="ltx_para" id="A1.SS3.p2">
<p class="ltx_p" id="A1.SS3.p2.1">However, the LLaMA model family uses activation functions such as SwiGLU and GELU, whose derivatives can exceed 1, making them not 1-Lipschitz. For networks employing such activation functions, the error propagation bound in Theorem 2 is adjusted by incorporating a Lipschitz constant <math alttext="L_{\phi}" class="ltx_Math" display="inline" id="A1.SS3.p2.1.m1.1"><semantics id="A1.SS3.p2.1.m1.1a"><msub id="A1.SS3.p2.1.m1.1.1" xref="A1.SS3.p2.1.m1.1.1.cmml"><mi id="A1.SS3.p2.1.m1.1.1.2" xref="A1.SS3.p2.1.m1.1.1.2.cmml">L</mi><mi id="A1.SS3.p2.1.m1.1.1.3" xref="A1.SS3.p2.1.m1.1.1.3.cmml">ϕ</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS3.p2.1.m1.1b"><apply id="A1.SS3.p2.1.m1.1.1.cmml" xref="A1.SS3.p2.1.m1.1.1"><csymbol cd="ambiguous" id="A1.SS3.p2.1.m1.1.1.1.cmml" xref="A1.SS3.p2.1.m1.1.1">subscript</csymbol><ci id="A1.SS3.p2.1.m1.1.1.2.cmml" xref="A1.SS3.p2.1.m1.1.1.2">𝐿</ci><ci id="A1.SS3.p2.1.m1.1.1.3.cmml" xref="A1.SS3.p2.1.m1.1.1.3">italic-ϕ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.p2.1.m1.1c">L_{\phi}</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.p2.1.m1.1d">italic_L start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT</annotation></semantics></math>, which may be greater than 1. This adjustment accounts for the potential additional error amplification introduced by the activation functions.</p>
</div>
</section>
</section>
<section class="ltx_appendix" id="A2">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>Reconstruction Error of Matrix SVD</h2>
<div class="ltx_para" id="A2.p1">
<p class="ltx_p" id="A2.p1.1">In our approach, we conduct layer-wise weight matrix decomposition and reconstruction. In this section, we show that these matrices are low-rank and therefore can be reconstructed with low-dimension matrices, resulting in negligible reconstruction error. This suggests that instead of designing complex eviction policies at the token level, we can focus on the weight matrix level to develop a KV cache compression method. This approach eliminates the need to scrutinize attention patterns to determine which tokens should be dropped.</p>
</div>
<figure class="ltx_figure" id="A2.F4"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="266" id="A2.F4.g1" src="x4.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="A2.F4.12.6.1" style="font-size:90%;">Figure 4</span>: </span><span class="ltx_text" id="A2.F4.10.5" style="font-size:90%;">Layerwise relative reconstruction errors. <math alttext="wk_{err}" class="ltx_Math" display="inline" id="A2.F4.6.1.m1.1"><semantics id="A2.F4.6.1.m1.1b"><mrow id="A2.F4.6.1.m1.1.1" xref="A2.F4.6.1.m1.1.1.cmml"><mi id="A2.F4.6.1.m1.1.1.2" xref="A2.F4.6.1.m1.1.1.2.cmml">w</mi><mo id="A2.F4.6.1.m1.1.1.1" xref="A2.F4.6.1.m1.1.1.1.cmml">⁢</mo><msub id="A2.F4.6.1.m1.1.1.3" xref="A2.F4.6.1.m1.1.1.3.cmml"><mi id="A2.F4.6.1.m1.1.1.3.2" xref="A2.F4.6.1.m1.1.1.3.2.cmml">k</mi><mrow id="A2.F4.6.1.m1.1.1.3.3" xref="A2.F4.6.1.m1.1.1.3.3.cmml"><mi id="A2.F4.6.1.m1.1.1.3.3.2" xref="A2.F4.6.1.m1.1.1.3.3.2.cmml">e</mi><mo id="A2.F4.6.1.m1.1.1.3.3.1" xref="A2.F4.6.1.m1.1.1.3.3.1.cmml">⁢</mo><mi id="A2.F4.6.1.m1.1.1.3.3.3" xref="A2.F4.6.1.m1.1.1.3.3.3.cmml">r</mi><mo id="A2.F4.6.1.m1.1.1.3.3.1b" xref="A2.F4.6.1.m1.1.1.3.3.1.cmml">⁢</mo><mi id="A2.F4.6.1.m1.1.1.3.3.4" xref="A2.F4.6.1.m1.1.1.3.3.4.cmml">r</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="A2.F4.6.1.m1.1c"><apply id="A2.F4.6.1.m1.1.1.cmml" xref="A2.F4.6.1.m1.1.1"><times id="A2.F4.6.1.m1.1.1.1.cmml" xref="A2.F4.6.1.m1.1.1.1"></times><ci id="A2.F4.6.1.m1.1.1.2.cmml" xref="A2.F4.6.1.m1.1.1.2">𝑤</ci><apply id="A2.F4.6.1.m1.1.1.3.cmml" xref="A2.F4.6.1.m1.1.1.3"><csymbol cd="ambiguous" id="A2.F4.6.1.m1.1.1.3.1.cmml" xref="A2.F4.6.1.m1.1.1.3">subscript</csymbol><ci id="A2.F4.6.1.m1.1.1.3.2.cmml" xref="A2.F4.6.1.m1.1.1.3.2">𝑘</ci><apply id="A2.F4.6.1.m1.1.1.3.3.cmml" xref="A2.F4.6.1.m1.1.1.3.3"><times id="A2.F4.6.1.m1.1.1.3.3.1.cmml" xref="A2.F4.6.1.m1.1.1.3.3.1"></times><ci id="A2.F4.6.1.m1.1.1.3.3.2.cmml" xref="A2.F4.6.1.m1.1.1.3.3.2">𝑒</ci><ci id="A2.F4.6.1.m1.1.1.3.3.3.cmml" xref="A2.F4.6.1.m1.1.1.3.3.3">𝑟</ci><ci id="A2.F4.6.1.m1.1.1.3.3.4.cmml" xref="A2.F4.6.1.m1.1.1.3.3.4">𝑟</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.F4.6.1.m1.1d">wk_{err}</annotation><annotation encoding="application/x-llamapun" id="A2.F4.6.1.m1.1e">italic_w italic_k start_POSTSUBSCRIPT italic_e italic_r italic_r end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="wv_{err}" class="ltx_Math" display="inline" id="A2.F4.7.2.m2.1"><semantics id="A2.F4.7.2.m2.1b"><mrow id="A2.F4.7.2.m2.1.1" xref="A2.F4.7.2.m2.1.1.cmml"><mi id="A2.F4.7.2.m2.1.1.2" xref="A2.F4.7.2.m2.1.1.2.cmml">w</mi><mo id="A2.F4.7.2.m2.1.1.1" xref="A2.F4.7.2.m2.1.1.1.cmml">⁢</mo><msub id="A2.F4.7.2.m2.1.1.3" xref="A2.F4.7.2.m2.1.1.3.cmml"><mi id="A2.F4.7.2.m2.1.1.3.2" xref="A2.F4.7.2.m2.1.1.3.2.cmml">v</mi><mrow id="A2.F4.7.2.m2.1.1.3.3" xref="A2.F4.7.2.m2.1.1.3.3.cmml"><mi id="A2.F4.7.2.m2.1.1.3.3.2" xref="A2.F4.7.2.m2.1.1.3.3.2.cmml">e</mi><mo id="A2.F4.7.2.m2.1.1.3.3.1" xref="A2.F4.7.2.m2.1.1.3.3.1.cmml">⁢</mo><mi id="A2.F4.7.2.m2.1.1.3.3.3" xref="A2.F4.7.2.m2.1.1.3.3.3.cmml">r</mi><mo id="A2.F4.7.2.m2.1.1.3.3.1b" xref="A2.F4.7.2.m2.1.1.3.3.1.cmml">⁢</mo><mi id="A2.F4.7.2.m2.1.1.3.3.4" xref="A2.F4.7.2.m2.1.1.3.3.4.cmml">r</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="A2.F4.7.2.m2.1c"><apply id="A2.F4.7.2.m2.1.1.cmml" xref="A2.F4.7.2.m2.1.1"><times id="A2.F4.7.2.m2.1.1.1.cmml" xref="A2.F4.7.2.m2.1.1.1"></times><ci id="A2.F4.7.2.m2.1.1.2.cmml" xref="A2.F4.7.2.m2.1.1.2">𝑤</ci><apply id="A2.F4.7.2.m2.1.1.3.cmml" xref="A2.F4.7.2.m2.1.1.3"><csymbol cd="ambiguous" id="A2.F4.7.2.m2.1.1.3.1.cmml" xref="A2.F4.7.2.m2.1.1.3">subscript</csymbol><ci id="A2.F4.7.2.m2.1.1.3.2.cmml" xref="A2.F4.7.2.m2.1.1.3.2">𝑣</ci><apply id="A2.F4.7.2.m2.1.1.3.3.cmml" xref="A2.F4.7.2.m2.1.1.3.3"><times id="A2.F4.7.2.m2.1.1.3.3.1.cmml" xref="A2.F4.7.2.m2.1.1.3.3.1"></times><ci id="A2.F4.7.2.m2.1.1.3.3.2.cmml" xref="A2.F4.7.2.m2.1.1.3.3.2">𝑒</ci><ci id="A2.F4.7.2.m2.1.1.3.3.3.cmml" xref="A2.F4.7.2.m2.1.1.3.3.3">𝑟</ci><ci id="A2.F4.7.2.m2.1.1.3.3.4.cmml" xref="A2.F4.7.2.m2.1.1.3.3.4">𝑟</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.F4.7.2.m2.1d">wv_{err}</annotation><annotation encoding="application/x-llamapun" id="A2.F4.7.2.m2.1e">italic_w italic_v start_POSTSUBSCRIPT italic_e italic_r italic_r end_POSTSUBSCRIPT</annotation></semantics></math> denote the relative difference between the original key/value matrices and their corresponding low-rank approximations measured using the Frobinus norm. The compression ratio is computed as <math alttext="r={d_{c}\over N_{h}\times d_{h}}" class="ltx_Math" display="inline" id="A2.F4.8.3.m3.1"><semantics id="A2.F4.8.3.m3.1b"><mrow id="A2.F4.8.3.m3.1.1" xref="A2.F4.8.3.m3.1.1.cmml"><mi id="A2.F4.8.3.m3.1.1.2" xref="A2.F4.8.3.m3.1.1.2.cmml">r</mi><mo id="A2.F4.8.3.m3.1.1.1" xref="A2.F4.8.3.m3.1.1.1.cmml">=</mo><mfrac id="A2.F4.8.3.m3.1.1.3" xref="A2.F4.8.3.m3.1.1.3.cmml"><msub id="A2.F4.8.3.m3.1.1.3.2" xref="A2.F4.8.3.m3.1.1.3.2.cmml"><mi id="A2.F4.8.3.m3.1.1.3.2.2" xref="A2.F4.8.3.m3.1.1.3.2.2.cmml">d</mi><mi id="A2.F4.8.3.m3.1.1.3.2.3" xref="A2.F4.8.3.m3.1.1.3.2.3.cmml">c</mi></msub><mrow id="A2.F4.8.3.m3.1.1.3.3" xref="A2.F4.8.3.m3.1.1.3.3.cmml"><msub id="A2.F4.8.3.m3.1.1.3.3.2" xref="A2.F4.8.3.m3.1.1.3.3.2.cmml"><mi id="A2.F4.8.3.m3.1.1.3.3.2.2" xref="A2.F4.8.3.m3.1.1.3.3.2.2.cmml">N</mi><mi id="A2.F4.8.3.m3.1.1.3.3.2.3" xref="A2.F4.8.3.m3.1.1.3.3.2.3.cmml">h</mi></msub><mo id="A2.F4.8.3.m3.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="A2.F4.8.3.m3.1.1.3.3.1.cmml">×</mo><msub id="A2.F4.8.3.m3.1.1.3.3.3" xref="A2.F4.8.3.m3.1.1.3.3.3.cmml"><mi id="A2.F4.8.3.m3.1.1.3.3.3.2" xref="A2.F4.8.3.m3.1.1.3.3.3.2.cmml">d</mi><mi id="A2.F4.8.3.m3.1.1.3.3.3.3" xref="A2.F4.8.3.m3.1.1.3.3.3.3.cmml">h</mi></msub></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="A2.F4.8.3.m3.1c"><apply id="A2.F4.8.3.m3.1.1.cmml" xref="A2.F4.8.3.m3.1.1"><eq id="A2.F4.8.3.m3.1.1.1.cmml" xref="A2.F4.8.3.m3.1.1.1"></eq><ci id="A2.F4.8.3.m3.1.1.2.cmml" xref="A2.F4.8.3.m3.1.1.2">𝑟</ci><apply id="A2.F4.8.3.m3.1.1.3.cmml" xref="A2.F4.8.3.m3.1.1.3"><divide id="A2.F4.8.3.m3.1.1.3.1.cmml" xref="A2.F4.8.3.m3.1.1.3"></divide><apply id="A2.F4.8.3.m3.1.1.3.2.cmml" xref="A2.F4.8.3.m3.1.1.3.2"><csymbol cd="ambiguous" id="A2.F4.8.3.m3.1.1.3.2.1.cmml" xref="A2.F4.8.3.m3.1.1.3.2">subscript</csymbol><ci id="A2.F4.8.3.m3.1.1.3.2.2.cmml" xref="A2.F4.8.3.m3.1.1.3.2.2">𝑑</ci><ci id="A2.F4.8.3.m3.1.1.3.2.3.cmml" xref="A2.F4.8.3.m3.1.1.3.2.3">𝑐</ci></apply><apply id="A2.F4.8.3.m3.1.1.3.3.cmml" xref="A2.F4.8.3.m3.1.1.3.3"><times id="A2.F4.8.3.m3.1.1.3.3.1.cmml" xref="A2.F4.8.3.m3.1.1.3.3.1"></times><apply id="A2.F4.8.3.m3.1.1.3.3.2.cmml" xref="A2.F4.8.3.m3.1.1.3.3.2"><csymbol cd="ambiguous" id="A2.F4.8.3.m3.1.1.3.3.2.1.cmml" xref="A2.F4.8.3.m3.1.1.3.3.2">subscript</csymbol><ci id="A2.F4.8.3.m3.1.1.3.3.2.2.cmml" xref="A2.F4.8.3.m3.1.1.3.3.2.2">𝑁</ci><ci id="A2.F4.8.3.m3.1.1.3.3.2.3.cmml" xref="A2.F4.8.3.m3.1.1.3.3.2.3">ℎ</ci></apply><apply id="A2.F4.8.3.m3.1.1.3.3.3.cmml" xref="A2.F4.8.3.m3.1.1.3.3.3"><csymbol cd="ambiguous" id="A2.F4.8.3.m3.1.1.3.3.3.1.cmml" xref="A2.F4.8.3.m3.1.1.3.3.3">subscript</csymbol><ci id="A2.F4.8.3.m3.1.1.3.3.3.2.cmml" xref="A2.F4.8.3.m3.1.1.3.3.3.2">𝑑</ci><ci id="A2.F4.8.3.m3.1.1.3.3.3.3.cmml" xref="A2.F4.8.3.m3.1.1.3.3.3.3">ℎ</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.F4.8.3.m3.1d">r={d_{c}\over N_{h}\times d_{h}}</annotation><annotation encoding="application/x-llamapun" id="A2.F4.8.3.m3.1e">italic_r = divide start_ARG italic_d start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT end_ARG start_ARG italic_N start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT × italic_d start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT end_ARG</annotation></semantics></math>, where <math alttext="N_{h}" class="ltx_Math" display="inline" id="A2.F4.9.4.m4.1"><semantics id="A2.F4.9.4.m4.1b"><msub id="A2.F4.9.4.m4.1.1" xref="A2.F4.9.4.m4.1.1.cmml"><mi id="A2.F4.9.4.m4.1.1.2" xref="A2.F4.9.4.m4.1.1.2.cmml">N</mi><mi id="A2.F4.9.4.m4.1.1.3" xref="A2.F4.9.4.m4.1.1.3.cmml">h</mi></msub><annotation-xml encoding="MathML-Content" id="A2.F4.9.4.m4.1c"><apply id="A2.F4.9.4.m4.1.1.cmml" xref="A2.F4.9.4.m4.1.1"><csymbol cd="ambiguous" id="A2.F4.9.4.m4.1.1.1.cmml" xref="A2.F4.9.4.m4.1.1">subscript</csymbol><ci id="A2.F4.9.4.m4.1.1.2.cmml" xref="A2.F4.9.4.m4.1.1.2">𝑁</ci><ci id="A2.F4.9.4.m4.1.1.3.cmml" xref="A2.F4.9.4.m4.1.1.3">ℎ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.F4.9.4.m4.1d">N_{h}</annotation><annotation encoding="application/x-llamapun" id="A2.F4.9.4.m4.1e">italic_N start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT</annotation></semantics></math> is the number of attention heads and <math alttext="d_{h},d_{c}" class="ltx_Math" display="inline" id="A2.F4.10.5.m5.2"><semantics id="A2.F4.10.5.m5.2b"><mrow id="A2.F4.10.5.m5.2.2.2" xref="A2.F4.10.5.m5.2.2.3.cmml"><msub id="A2.F4.10.5.m5.1.1.1.1" xref="A2.F4.10.5.m5.1.1.1.1.cmml"><mi id="A2.F4.10.5.m5.1.1.1.1.2" xref="A2.F4.10.5.m5.1.1.1.1.2.cmml">d</mi><mi id="A2.F4.10.5.m5.1.1.1.1.3" xref="A2.F4.10.5.m5.1.1.1.1.3.cmml">h</mi></msub><mo id="A2.F4.10.5.m5.2.2.2.3" xref="A2.F4.10.5.m5.2.2.3.cmml">,</mo><msub id="A2.F4.10.5.m5.2.2.2.2" xref="A2.F4.10.5.m5.2.2.2.2.cmml"><mi id="A2.F4.10.5.m5.2.2.2.2.2" xref="A2.F4.10.5.m5.2.2.2.2.2.cmml">d</mi><mi id="A2.F4.10.5.m5.2.2.2.2.3" xref="A2.F4.10.5.m5.2.2.2.2.3.cmml">c</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="A2.F4.10.5.m5.2c"><list id="A2.F4.10.5.m5.2.2.3.cmml" xref="A2.F4.10.5.m5.2.2.2"><apply id="A2.F4.10.5.m5.1.1.1.1.cmml" xref="A2.F4.10.5.m5.1.1.1.1"><csymbol cd="ambiguous" id="A2.F4.10.5.m5.1.1.1.1.1.cmml" xref="A2.F4.10.5.m5.1.1.1.1">subscript</csymbol><ci id="A2.F4.10.5.m5.1.1.1.1.2.cmml" xref="A2.F4.10.5.m5.1.1.1.1.2">𝑑</ci><ci id="A2.F4.10.5.m5.1.1.1.1.3.cmml" xref="A2.F4.10.5.m5.1.1.1.1.3">ℎ</ci></apply><apply id="A2.F4.10.5.m5.2.2.2.2.cmml" xref="A2.F4.10.5.m5.2.2.2.2"><csymbol cd="ambiguous" id="A2.F4.10.5.m5.2.2.2.2.1.cmml" xref="A2.F4.10.5.m5.2.2.2.2">subscript</csymbol><ci id="A2.F4.10.5.m5.2.2.2.2.2.cmml" xref="A2.F4.10.5.m5.2.2.2.2.2">𝑑</ci><ci id="A2.F4.10.5.m5.2.2.2.2.3.cmml" xref="A2.F4.10.5.m5.2.2.2.2.3">𝑐</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="A2.F4.10.5.m5.2d">d_{h},d_{c}</annotation><annotation encoding="application/x-llamapun" id="A2.F4.10.5.m5.2e">italic_d start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT , italic_d start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT</annotation></semantics></math> is the original and compressed hidden dimensions respectively.</span></figcaption>
</figure>
<div class="ltx_para" id="A2.p2">
<p class="ltx_p" id="A2.p2.1">We present the relative reconstruction error in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03111v1#A2.F4" title="Figure 4 ‣ Appendix B Reconstruction Error of Matrix SVD ‣ LoRC: Low-Rank Compression for LLMs KV Cache with a Progressive Compression Strategy"><span class="ltx_text ltx_ref_tag">4</span></a>, which is computed using the Frobenius norm. For a matrix <math alttext="M" class="ltx_Math" display="inline" id="A2.p2.1.m1.1"><semantics id="A2.p2.1.m1.1a"><mi id="A2.p2.1.m1.1.1" xref="A2.p2.1.m1.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="A2.p2.1.m1.1b"><ci id="A2.p2.1.m1.1.1.cmml" xref="A2.p2.1.m1.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.p2.1.m1.1c">M</annotation><annotation encoding="application/x-llamapun" id="A2.p2.1.m1.1d">italic_M</annotation></semantics></math>, the Frobenius norm is defined as:</p>
</div>
<div class="ltx_para" id="A2.p3">
<table class="ltx_equation ltx_eqn_table" id="A2.E18">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\|M\|_{F}=\sqrt{\sum_{i=1}^{m}\sum_{j=1}^{n}|m_{ij}|^{2}}." class="ltx_Math" display="block" id="A2.E18.m1.3"><semantics id="A2.E18.m1.3a"><mrow id="A2.E18.m1.3.3.1" xref="A2.E18.m1.3.3.1.1.cmml"><mrow id="A2.E18.m1.3.3.1.1" xref="A2.E18.m1.3.3.1.1.cmml"><msub id="A2.E18.m1.3.3.1.1.2" xref="A2.E18.m1.3.3.1.1.2.cmml"><mrow id="A2.E18.m1.3.3.1.1.2.2.2" xref="A2.E18.m1.3.3.1.1.2.2.1.cmml"><mo id="A2.E18.m1.3.3.1.1.2.2.2.1" stretchy="false" xref="A2.E18.m1.3.3.1.1.2.2.1.1.cmml">‖</mo><mi id="A2.E18.m1.2.2" xref="A2.E18.m1.2.2.cmml">M</mi><mo id="A2.E18.m1.3.3.1.1.2.2.2.2" stretchy="false" xref="A2.E18.m1.3.3.1.1.2.2.1.1.cmml">‖</mo></mrow><mi id="A2.E18.m1.3.3.1.1.2.3" xref="A2.E18.m1.3.3.1.1.2.3.cmml">F</mi></msub><mo id="A2.E18.m1.3.3.1.1.1" xref="A2.E18.m1.3.3.1.1.1.cmml">=</mo><msqrt id="A2.E18.m1.1.1" xref="A2.E18.m1.1.1.cmml"><mrow id="A2.E18.m1.1.1.1" xref="A2.E18.m1.1.1.1.cmml"><munderover id="A2.E18.m1.1.1.1.2" xref="A2.E18.m1.1.1.1.2.cmml"><mo id="A2.E18.m1.1.1.1.2.2.2" movablelimits="false" xref="A2.E18.m1.1.1.1.2.2.2.cmml">∑</mo><mrow id="A2.E18.m1.1.1.1.2.2.3" xref="A2.E18.m1.1.1.1.2.2.3.cmml"><mi id="A2.E18.m1.1.1.1.2.2.3.2" xref="A2.E18.m1.1.1.1.2.2.3.2.cmml">i</mi><mo id="A2.E18.m1.1.1.1.2.2.3.1" xref="A2.E18.m1.1.1.1.2.2.3.1.cmml">=</mo><mn id="A2.E18.m1.1.1.1.2.2.3.3" xref="A2.E18.m1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="A2.E18.m1.1.1.1.2.3" xref="A2.E18.m1.1.1.1.2.3.cmml">m</mi></munderover><mrow id="A2.E18.m1.1.1.1.1" xref="A2.E18.m1.1.1.1.1.cmml"><munderover id="A2.E18.m1.1.1.1.1.2" xref="A2.E18.m1.1.1.1.1.2.cmml"><mo id="A2.E18.m1.1.1.1.1.2.2.2" lspace="0.167em" movablelimits="false" rspace="0em" xref="A2.E18.m1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="A2.E18.m1.1.1.1.1.2.2.3" xref="A2.E18.m1.1.1.1.1.2.2.3.cmml"><mi id="A2.E18.m1.1.1.1.1.2.2.3.2" xref="A2.E18.m1.1.1.1.1.2.2.3.2.cmml">j</mi><mo id="A2.E18.m1.1.1.1.1.2.2.3.1" xref="A2.E18.m1.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="A2.E18.m1.1.1.1.1.2.2.3.3" xref="A2.E18.m1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="A2.E18.m1.1.1.1.1.2.3" xref="A2.E18.m1.1.1.1.1.2.3.cmml">n</mi></munderover><msup id="A2.E18.m1.1.1.1.1.1" xref="A2.E18.m1.1.1.1.1.1.cmml"><mrow id="A2.E18.m1.1.1.1.1.1.1.1" xref="A2.E18.m1.1.1.1.1.1.1.2.cmml"><mo id="A2.E18.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="A2.E18.m1.1.1.1.1.1.1.2.1.cmml">|</mo><msub id="A2.E18.m1.1.1.1.1.1.1.1.1" xref="A2.E18.m1.1.1.1.1.1.1.1.1.cmml"><mi id="A2.E18.m1.1.1.1.1.1.1.1.1.2" xref="A2.E18.m1.1.1.1.1.1.1.1.1.2.cmml">m</mi><mrow id="A2.E18.m1.1.1.1.1.1.1.1.1.3" xref="A2.E18.m1.1.1.1.1.1.1.1.1.3.cmml"><mi id="A2.E18.m1.1.1.1.1.1.1.1.1.3.2" xref="A2.E18.m1.1.1.1.1.1.1.1.1.3.2.cmml">i</mi><mo id="A2.E18.m1.1.1.1.1.1.1.1.1.3.1" xref="A2.E18.m1.1.1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="A2.E18.m1.1.1.1.1.1.1.1.1.3.3" xref="A2.E18.m1.1.1.1.1.1.1.1.1.3.3.cmml">j</mi></mrow></msub><mo id="A2.E18.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="A2.E18.m1.1.1.1.1.1.1.2.1.cmml">|</mo></mrow><mn id="A2.E18.m1.1.1.1.1.1.3" xref="A2.E18.m1.1.1.1.1.1.3.cmml">2</mn></msup></mrow></mrow></msqrt></mrow><mo id="A2.E18.m1.3.3.1.2" lspace="0em" xref="A2.E18.m1.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A2.E18.m1.3b"><apply id="A2.E18.m1.3.3.1.1.cmml" xref="A2.E18.m1.3.3.1"><eq id="A2.E18.m1.3.3.1.1.1.cmml" xref="A2.E18.m1.3.3.1.1.1"></eq><apply id="A2.E18.m1.3.3.1.1.2.cmml" xref="A2.E18.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="A2.E18.m1.3.3.1.1.2.1.cmml" xref="A2.E18.m1.3.3.1.1.2">subscript</csymbol><apply id="A2.E18.m1.3.3.1.1.2.2.1.cmml" xref="A2.E18.m1.3.3.1.1.2.2.2"><csymbol cd="latexml" id="A2.E18.m1.3.3.1.1.2.2.1.1.cmml" xref="A2.E18.m1.3.3.1.1.2.2.2.1">norm</csymbol><ci id="A2.E18.m1.2.2.cmml" xref="A2.E18.m1.2.2">𝑀</ci></apply><ci id="A2.E18.m1.3.3.1.1.2.3.cmml" xref="A2.E18.m1.3.3.1.1.2.3">𝐹</ci></apply><apply id="A2.E18.m1.1.1.cmml" xref="A2.E18.m1.1.1"><root id="A2.E18.m1.1.1a.cmml" xref="A2.E18.m1.1.1"></root><apply id="A2.E18.m1.1.1.1.cmml" xref="A2.E18.m1.1.1.1"><apply id="A2.E18.m1.1.1.1.2.cmml" xref="A2.E18.m1.1.1.1.2"><csymbol cd="ambiguous" id="A2.E18.m1.1.1.1.2.1.cmml" xref="A2.E18.m1.1.1.1.2">superscript</csymbol><apply id="A2.E18.m1.1.1.1.2.2.cmml" xref="A2.E18.m1.1.1.1.2"><csymbol cd="ambiguous" id="A2.E18.m1.1.1.1.2.2.1.cmml" xref="A2.E18.m1.1.1.1.2">subscript</csymbol><sum id="A2.E18.m1.1.1.1.2.2.2.cmml" xref="A2.E18.m1.1.1.1.2.2.2"></sum><apply id="A2.E18.m1.1.1.1.2.2.3.cmml" xref="A2.E18.m1.1.1.1.2.2.3"><eq id="A2.E18.m1.1.1.1.2.2.3.1.cmml" xref="A2.E18.m1.1.1.1.2.2.3.1"></eq><ci id="A2.E18.m1.1.1.1.2.2.3.2.cmml" xref="A2.E18.m1.1.1.1.2.2.3.2">𝑖</ci><cn id="A2.E18.m1.1.1.1.2.2.3.3.cmml" type="integer" xref="A2.E18.m1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="A2.E18.m1.1.1.1.2.3.cmml" xref="A2.E18.m1.1.1.1.2.3">𝑚</ci></apply><apply id="A2.E18.m1.1.1.1.1.cmml" xref="A2.E18.m1.1.1.1.1"><apply id="A2.E18.m1.1.1.1.1.2.cmml" xref="A2.E18.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="A2.E18.m1.1.1.1.1.2.1.cmml" xref="A2.E18.m1.1.1.1.1.2">superscript</csymbol><apply id="A2.E18.m1.1.1.1.1.2.2.cmml" xref="A2.E18.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="A2.E18.m1.1.1.1.1.2.2.1.cmml" xref="A2.E18.m1.1.1.1.1.2">subscript</csymbol><sum id="A2.E18.m1.1.1.1.1.2.2.2.cmml" xref="A2.E18.m1.1.1.1.1.2.2.2"></sum><apply id="A2.E18.m1.1.1.1.1.2.2.3.cmml" xref="A2.E18.m1.1.1.1.1.2.2.3"><eq id="A2.E18.m1.1.1.1.1.2.2.3.1.cmml" xref="A2.E18.m1.1.1.1.1.2.2.3.1"></eq><ci id="A2.E18.m1.1.1.1.1.2.2.3.2.cmml" xref="A2.E18.m1.1.1.1.1.2.2.3.2">𝑗</ci><cn id="A2.E18.m1.1.1.1.1.2.2.3.3.cmml" type="integer" xref="A2.E18.m1.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="A2.E18.m1.1.1.1.1.2.3.cmml" xref="A2.E18.m1.1.1.1.1.2.3">𝑛</ci></apply><apply id="A2.E18.m1.1.1.1.1.1.cmml" xref="A2.E18.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="A2.E18.m1.1.1.1.1.1.2.cmml" xref="A2.E18.m1.1.1.1.1.1">superscript</csymbol><apply id="A2.E18.m1.1.1.1.1.1.1.2.cmml" xref="A2.E18.m1.1.1.1.1.1.1.1"><abs id="A2.E18.m1.1.1.1.1.1.1.2.1.cmml" xref="A2.E18.m1.1.1.1.1.1.1.1.2"></abs><apply id="A2.E18.m1.1.1.1.1.1.1.1.1.cmml" xref="A2.E18.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A2.E18.m1.1.1.1.1.1.1.1.1.1.cmml" xref="A2.E18.m1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="A2.E18.m1.1.1.1.1.1.1.1.1.2.cmml" xref="A2.E18.m1.1.1.1.1.1.1.1.1.2">𝑚</ci><apply id="A2.E18.m1.1.1.1.1.1.1.1.1.3.cmml" xref="A2.E18.m1.1.1.1.1.1.1.1.1.3"><times id="A2.E18.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="A2.E18.m1.1.1.1.1.1.1.1.1.3.1"></times><ci id="A2.E18.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="A2.E18.m1.1.1.1.1.1.1.1.1.3.2">𝑖</ci><ci id="A2.E18.m1.1.1.1.1.1.1.1.1.3.3.cmml" xref="A2.E18.m1.1.1.1.1.1.1.1.1.3.3">𝑗</ci></apply></apply></apply><cn id="A2.E18.m1.1.1.1.1.1.3.cmml" type="integer" xref="A2.E18.m1.1.1.1.1.1.3">2</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.E18.m1.3c">\|M\|_{F}=\sqrt{\sum_{i=1}^{m}\sum_{j=1}^{n}|m_{ij}|^{2}}.</annotation><annotation encoding="application/x-llamapun" id="A2.E18.m1.3d">∥ italic_M ∥ start_POSTSUBSCRIPT italic_F end_POSTSUBSCRIPT = square-root start_ARG ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_m end_POSTSUPERSCRIPT ∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT | italic_m start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT | start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(18)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="A2.p4">
<p class="ltx_p" id="A2.p4.1">The relative reconstruction error <math alttext="\varepsilon" class="ltx_Math" display="inline" id="A2.p4.1.m1.1"><semantics id="A2.p4.1.m1.1a"><mi id="A2.p4.1.m1.1.1" xref="A2.p4.1.m1.1.1.cmml">ε</mi><annotation-xml encoding="MathML-Content" id="A2.p4.1.m1.1b"><ci id="A2.p4.1.m1.1.1.cmml" xref="A2.p4.1.m1.1.1">𝜀</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.p4.1.m1.1c">\varepsilon</annotation><annotation encoding="application/x-llamapun" id="A2.p4.1.m1.1d">italic_ε</annotation></semantics></math> is calculated as:</p>
</div>
<div class="ltx_para" id="A2.p5">
<table class="ltx_equation ltx_eqn_table" id="A2.E19">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\varepsilon=\frac{\|M-\hat{M}\|_{F}}{\|M\|_{F}}" class="ltx_Math" display="block" id="A2.E19.m1.2"><semantics id="A2.E19.m1.2a"><mrow id="A2.E19.m1.2.3" xref="A2.E19.m1.2.3.cmml"><mi id="A2.E19.m1.2.3.2" xref="A2.E19.m1.2.3.2.cmml">ε</mi><mo id="A2.E19.m1.2.3.1" xref="A2.E19.m1.2.3.1.cmml">=</mo><mfrac id="A2.E19.m1.2.2" xref="A2.E19.m1.2.2.cmml"><msub id="A2.E19.m1.1.1.1" xref="A2.E19.m1.1.1.1.cmml"><mrow id="A2.E19.m1.1.1.1.1.1" xref="A2.E19.m1.1.1.1.1.2.cmml"><mo id="A2.E19.m1.1.1.1.1.1.2" stretchy="false" xref="A2.E19.m1.1.1.1.1.2.1.cmml">‖</mo><mrow id="A2.E19.m1.1.1.1.1.1.1" xref="A2.E19.m1.1.1.1.1.1.1.cmml"><mi id="A2.E19.m1.1.1.1.1.1.1.2" xref="A2.E19.m1.1.1.1.1.1.1.2.cmml">M</mi><mo id="A2.E19.m1.1.1.1.1.1.1.1" xref="A2.E19.m1.1.1.1.1.1.1.1.cmml">−</mo><mover accent="true" id="A2.E19.m1.1.1.1.1.1.1.3" xref="A2.E19.m1.1.1.1.1.1.1.3.cmml"><mi id="A2.E19.m1.1.1.1.1.1.1.3.2" xref="A2.E19.m1.1.1.1.1.1.1.3.2.cmml">M</mi><mo id="A2.E19.m1.1.1.1.1.1.1.3.1" xref="A2.E19.m1.1.1.1.1.1.1.3.1.cmml">^</mo></mover></mrow><mo id="A2.E19.m1.1.1.1.1.1.3" stretchy="false" xref="A2.E19.m1.1.1.1.1.2.1.cmml">‖</mo></mrow><mi id="A2.E19.m1.1.1.1.3" xref="A2.E19.m1.1.1.1.3.cmml">F</mi></msub><msub id="A2.E19.m1.2.2.2" xref="A2.E19.m1.2.2.2.cmml"><mrow id="A2.E19.m1.2.2.2.3.2" xref="A2.E19.m1.2.2.2.3.1.cmml"><mo id="A2.E19.m1.2.2.2.3.2.1" stretchy="false" xref="A2.E19.m1.2.2.2.3.1.1.cmml">‖</mo><mi id="A2.E19.m1.2.2.2.1" xref="A2.E19.m1.2.2.2.1.cmml">M</mi><mo id="A2.E19.m1.2.2.2.3.2.2" stretchy="false" xref="A2.E19.m1.2.2.2.3.1.1.cmml">‖</mo></mrow><mi id="A2.E19.m1.2.2.2.4" xref="A2.E19.m1.2.2.2.4.cmml">F</mi></msub></mfrac></mrow><annotation-xml encoding="MathML-Content" id="A2.E19.m1.2b"><apply id="A2.E19.m1.2.3.cmml" xref="A2.E19.m1.2.3"><eq id="A2.E19.m1.2.3.1.cmml" xref="A2.E19.m1.2.3.1"></eq><ci id="A2.E19.m1.2.3.2.cmml" xref="A2.E19.m1.2.3.2">𝜀</ci><apply id="A2.E19.m1.2.2.cmml" xref="A2.E19.m1.2.2"><divide id="A2.E19.m1.2.2.3.cmml" xref="A2.E19.m1.2.2"></divide><apply id="A2.E19.m1.1.1.1.cmml" xref="A2.E19.m1.1.1.1"><csymbol cd="ambiguous" id="A2.E19.m1.1.1.1.2.cmml" xref="A2.E19.m1.1.1.1">subscript</csymbol><apply id="A2.E19.m1.1.1.1.1.2.cmml" xref="A2.E19.m1.1.1.1.1.1"><csymbol cd="latexml" id="A2.E19.m1.1.1.1.1.2.1.cmml" xref="A2.E19.m1.1.1.1.1.1.2">norm</csymbol><apply id="A2.E19.m1.1.1.1.1.1.1.cmml" xref="A2.E19.m1.1.1.1.1.1.1"><minus id="A2.E19.m1.1.1.1.1.1.1.1.cmml" xref="A2.E19.m1.1.1.1.1.1.1.1"></minus><ci id="A2.E19.m1.1.1.1.1.1.1.2.cmml" xref="A2.E19.m1.1.1.1.1.1.1.2">𝑀</ci><apply id="A2.E19.m1.1.1.1.1.1.1.3.cmml" xref="A2.E19.m1.1.1.1.1.1.1.3"><ci id="A2.E19.m1.1.1.1.1.1.1.3.1.cmml" xref="A2.E19.m1.1.1.1.1.1.1.3.1">^</ci><ci id="A2.E19.m1.1.1.1.1.1.1.3.2.cmml" xref="A2.E19.m1.1.1.1.1.1.1.3.2">𝑀</ci></apply></apply></apply><ci id="A2.E19.m1.1.1.1.3.cmml" xref="A2.E19.m1.1.1.1.3">𝐹</ci></apply><apply id="A2.E19.m1.2.2.2.cmml" xref="A2.E19.m1.2.2.2"><csymbol cd="ambiguous" id="A2.E19.m1.2.2.2.2.cmml" xref="A2.E19.m1.2.2.2">subscript</csymbol><apply id="A2.E19.m1.2.2.2.3.1.cmml" xref="A2.E19.m1.2.2.2.3.2"><csymbol cd="latexml" id="A2.E19.m1.2.2.2.3.1.1.cmml" xref="A2.E19.m1.2.2.2.3.2.1">norm</csymbol><ci id="A2.E19.m1.2.2.2.1.cmml" xref="A2.E19.m1.2.2.2.1">𝑀</ci></apply><ci id="A2.E19.m1.2.2.2.4.cmml" xref="A2.E19.m1.2.2.2.4">𝐹</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.E19.m1.2c">\varepsilon=\frac{\|M-\hat{M}\|_{F}}{\|M\|_{F}}</annotation><annotation encoding="application/x-llamapun" id="A2.E19.m1.2d">italic_ε = divide start_ARG ∥ italic_M - over^ start_ARG italic_M end_ARG ∥ start_POSTSUBSCRIPT italic_F end_POSTSUBSCRIPT end_ARG start_ARG ∥ italic_M ∥ start_POSTSUBSCRIPT italic_F end_POSTSUBSCRIPT end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(19)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="A2.p6">
<p class="ltx_p" id="A2.p6.2">where <math alttext="M" class="ltx_Math" display="inline" id="A2.p6.1.m1.1"><semantics id="A2.p6.1.m1.1a"><mi id="A2.p6.1.m1.1.1" xref="A2.p6.1.m1.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="A2.p6.1.m1.1b"><ci id="A2.p6.1.m1.1.1.cmml" xref="A2.p6.1.m1.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.p6.1.m1.1c">M</annotation><annotation encoding="application/x-llamapun" id="A2.p6.1.m1.1d">italic_M</annotation></semantics></math> is the original matrix and <math alttext="\hat{M}" class="ltx_Math" display="inline" id="A2.p6.2.m2.1"><semantics id="A2.p6.2.m2.1a"><mover accent="true" id="A2.p6.2.m2.1.1" xref="A2.p6.2.m2.1.1.cmml"><mi id="A2.p6.2.m2.1.1.2" xref="A2.p6.2.m2.1.1.2.cmml">M</mi><mo id="A2.p6.2.m2.1.1.1" xref="A2.p6.2.m2.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="A2.p6.2.m2.1b"><apply id="A2.p6.2.m2.1.1.cmml" xref="A2.p6.2.m2.1.1"><ci id="A2.p6.2.m2.1.1.1.cmml" xref="A2.p6.2.m2.1.1.1">^</ci><ci id="A2.p6.2.m2.1.1.2.cmml" xref="A2.p6.2.m2.1.1.2">𝑀</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p6.2.m2.1c">\hat{M}</annotation><annotation encoding="application/x-llamapun" id="A2.p6.2.m2.1d">over^ start_ARG italic_M end_ARG</annotation></semantics></math> is the reconstructed matrix obtained through truncated SVD.</p>
</div>
<div class="ltx_para" id="A2.p7">
<p class="ltx_p" id="A2.p7.1">This approach enables us to quantify the accuracy of our low-rank approximation for each matrix. It is important to note that although Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03111v1#A2.F4" title="Figure 4 ‣ Appendix B Reconstruction Error of Matrix SVD ‣ LoRC: Low-Rank Compression for LLMs KV Cache with a Progressive Compression Strategy"><span class="ltx_text ltx_ref_tag">4</span></a> demonstrates that reconstruction errors are similar across all layers, with shallow layers exhibiting even lower errors, this does not imply that we can directly compress shallow layers aggressively or compress all layers uniformly. In fact, compression errors propagate and amplify throughout the network as we illustrated in Section <a class="ltx_ref" href="https://arxiv.org/html/2410.03111v1#S4.SS2" title="4.2 Progressive Compression Strategy ‣ 4 Method ‣ LoRC: Low-Rank Compression for LLMs KV Cache with a Progressive Compression Strategy"><span class="ltx_text ltx_ref_tag">4.2</span></a>. To this end, we propose the progressive compression strategy and it is theoretically and empirically effective in minimizing the overall error accumulation.</p>
</div>
</section>
<section class="ltx_appendix" id="A3">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix C </span>Adjusted Position Embedding</h2>
<div class="ltx_para" id="A3.p1">
<p class="ltx_p" id="A3.p1.8"><cite class="ltx_cite ltx_citemacro_cite">Su et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03111v1#bib.bib22" title="">2024</a>)</cite> propose a rotary position embedding (RoPE) and it has been used in most recent LLMs.
Applying RoPE to self-attention gives</p>
<table class="ltx_equation ltx_eqn_table" id="A3.E20">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="q_{m}^{T}k_{n}=(R_{\Theta,m}^{d}W_{q}^{T}x_{m})^{T}(R_{\Theta,n}^{d}W_{k}^{T}x%
_{n})=x^{T}W_{q}R_{\Theta,n-m}^{d}W_{k}^{T}x_{n}," class="ltx_Math" display="block" id="A3.E20.m1.7"><semantics id="A3.E20.m1.7a"><mrow id="A3.E20.m1.7.7.1" xref="A3.E20.m1.7.7.1.1.cmml"><mrow id="A3.E20.m1.7.7.1.1" xref="A3.E20.m1.7.7.1.1.cmml"><mrow id="A3.E20.m1.7.7.1.1.4" xref="A3.E20.m1.7.7.1.1.4.cmml"><msubsup id="A3.E20.m1.7.7.1.1.4.2" xref="A3.E20.m1.7.7.1.1.4.2.cmml"><mi id="A3.E20.m1.7.7.1.1.4.2.2.2" xref="A3.E20.m1.7.7.1.1.4.2.2.2.cmml">q</mi><mi id="A3.E20.m1.7.7.1.1.4.2.2.3" xref="A3.E20.m1.7.7.1.1.4.2.2.3.cmml">m</mi><mi id="A3.E20.m1.7.7.1.1.4.2.3" xref="A3.E20.m1.7.7.1.1.4.2.3.cmml">T</mi></msubsup><mo id="A3.E20.m1.7.7.1.1.4.1" xref="A3.E20.m1.7.7.1.1.4.1.cmml">⁢</mo><msub id="A3.E20.m1.7.7.1.1.4.3" xref="A3.E20.m1.7.7.1.1.4.3.cmml"><mi id="A3.E20.m1.7.7.1.1.4.3.2" xref="A3.E20.m1.7.7.1.1.4.3.2.cmml">k</mi><mi id="A3.E20.m1.7.7.1.1.4.3.3" xref="A3.E20.m1.7.7.1.1.4.3.3.cmml">n</mi></msub></mrow><mo id="A3.E20.m1.7.7.1.1.5" xref="A3.E20.m1.7.7.1.1.5.cmml">=</mo><mrow id="A3.E20.m1.7.7.1.1.2" xref="A3.E20.m1.7.7.1.1.2.cmml"><msup id="A3.E20.m1.7.7.1.1.1.1" xref="A3.E20.m1.7.7.1.1.1.1.cmml"><mrow id="A3.E20.m1.7.7.1.1.1.1.1.1" xref="A3.E20.m1.7.7.1.1.1.1.1.1.1.cmml"><mo id="A3.E20.m1.7.7.1.1.1.1.1.1.2" stretchy="false" xref="A3.E20.m1.7.7.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A3.E20.m1.7.7.1.1.1.1.1.1.1" xref="A3.E20.m1.7.7.1.1.1.1.1.1.1.cmml"><msubsup id="A3.E20.m1.7.7.1.1.1.1.1.1.1.2" xref="A3.E20.m1.7.7.1.1.1.1.1.1.1.2.cmml"><mi id="A3.E20.m1.7.7.1.1.1.1.1.1.1.2.2.2" xref="A3.E20.m1.7.7.1.1.1.1.1.1.1.2.2.2.cmml">R</mi><mrow id="A3.E20.m1.2.2.2.4" xref="A3.E20.m1.2.2.2.3.cmml"><mi id="A3.E20.m1.1.1.1.1" mathvariant="normal" xref="A3.E20.m1.1.1.1.1.cmml">Θ</mi><mo id="A3.E20.m1.2.2.2.4.1" xref="A3.E20.m1.2.2.2.3.cmml">,</mo><mi id="A3.E20.m1.2.2.2.2" xref="A3.E20.m1.2.2.2.2.cmml">m</mi></mrow><mi id="A3.E20.m1.7.7.1.1.1.1.1.1.1.2.3" xref="A3.E20.m1.7.7.1.1.1.1.1.1.1.2.3.cmml">d</mi></msubsup><mo id="A3.E20.m1.7.7.1.1.1.1.1.1.1.1" xref="A3.E20.m1.7.7.1.1.1.1.1.1.1.1.cmml">⁢</mo><msubsup id="A3.E20.m1.7.7.1.1.1.1.1.1.1.3" xref="A3.E20.m1.7.7.1.1.1.1.1.1.1.3.cmml"><mi id="A3.E20.m1.7.7.1.1.1.1.1.1.1.3.2.2" xref="A3.E20.m1.7.7.1.1.1.1.1.1.1.3.2.2.cmml">W</mi><mi id="A3.E20.m1.7.7.1.1.1.1.1.1.1.3.2.3" xref="A3.E20.m1.7.7.1.1.1.1.1.1.1.3.2.3.cmml">q</mi><mi id="A3.E20.m1.7.7.1.1.1.1.1.1.1.3.3" xref="A3.E20.m1.7.7.1.1.1.1.1.1.1.3.3.cmml">T</mi></msubsup><mo id="A3.E20.m1.7.7.1.1.1.1.1.1.1.1a" xref="A3.E20.m1.7.7.1.1.1.1.1.1.1.1.cmml">⁢</mo><msub id="A3.E20.m1.7.7.1.1.1.1.1.1.1.4" xref="A3.E20.m1.7.7.1.1.1.1.1.1.1.4.cmml"><mi id="A3.E20.m1.7.7.1.1.1.1.1.1.1.4.2" xref="A3.E20.m1.7.7.1.1.1.1.1.1.1.4.2.cmml">x</mi><mi id="A3.E20.m1.7.7.1.1.1.1.1.1.1.4.3" xref="A3.E20.m1.7.7.1.1.1.1.1.1.1.4.3.cmml">m</mi></msub></mrow><mo id="A3.E20.m1.7.7.1.1.1.1.1.1.3" stretchy="false" xref="A3.E20.m1.7.7.1.1.1.1.1.1.1.cmml">)</mo></mrow><mi id="A3.E20.m1.7.7.1.1.1.1.3" xref="A3.E20.m1.7.7.1.1.1.1.3.cmml">T</mi></msup><mo id="A3.E20.m1.7.7.1.1.2.3" xref="A3.E20.m1.7.7.1.1.2.3.cmml">⁢</mo><mrow id="A3.E20.m1.7.7.1.1.2.2.1" xref="A3.E20.m1.7.7.1.1.2.2.1.1.cmml"><mo id="A3.E20.m1.7.7.1.1.2.2.1.2" stretchy="false" xref="A3.E20.m1.7.7.1.1.2.2.1.1.cmml">(</mo><mrow id="A3.E20.m1.7.7.1.1.2.2.1.1" xref="A3.E20.m1.7.7.1.1.2.2.1.1.cmml"><msubsup id="A3.E20.m1.7.7.1.1.2.2.1.1.2" xref="A3.E20.m1.7.7.1.1.2.2.1.1.2.cmml"><mi id="A3.E20.m1.7.7.1.1.2.2.1.1.2.2.2" xref="A3.E20.m1.7.7.1.1.2.2.1.1.2.2.2.cmml">R</mi><mrow id="A3.E20.m1.4.4.2.4" xref="A3.E20.m1.4.4.2.3.cmml"><mi id="A3.E20.m1.3.3.1.1" mathvariant="normal" xref="A3.E20.m1.3.3.1.1.cmml">Θ</mi><mo id="A3.E20.m1.4.4.2.4.1" xref="A3.E20.m1.4.4.2.3.cmml">,</mo><mi id="A3.E20.m1.4.4.2.2" xref="A3.E20.m1.4.4.2.2.cmml">n</mi></mrow><mi id="A3.E20.m1.7.7.1.1.2.2.1.1.2.3" xref="A3.E20.m1.7.7.1.1.2.2.1.1.2.3.cmml">d</mi></msubsup><mo id="A3.E20.m1.7.7.1.1.2.2.1.1.1" xref="A3.E20.m1.7.7.1.1.2.2.1.1.1.cmml">⁢</mo><msubsup id="A3.E20.m1.7.7.1.1.2.2.1.1.3" xref="A3.E20.m1.7.7.1.1.2.2.1.1.3.cmml"><mi id="A3.E20.m1.7.7.1.1.2.2.1.1.3.2.2" xref="A3.E20.m1.7.7.1.1.2.2.1.1.3.2.2.cmml">W</mi><mi id="A3.E20.m1.7.7.1.1.2.2.1.1.3.2.3" xref="A3.E20.m1.7.7.1.1.2.2.1.1.3.2.3.cmml">k</mi><mi id="A3.E20.m1.7.7.1.1.2.2.1.1.3.3" xref="A3.E20.m1.7.7.1.1.2.2.1.1.3.3.cmml">T</mi></msubsup><mo id="A3.E20.m1.7.7.1.1.2.2.1.1.1a" xref="A3.E20.m1.7.7.1.1.2.2.1.1.1.cmml">⁢</mo><msub id="A3.E20.m1.7.7.1.1.2.2.1.1.4" xref="A3.E20.m1.7.7.1.1.2.2.1.1.4.cmml"><mi id="A3.E20.m1.7.7.1.1.2.2.1.1.4.2" xref="A3.E20.m1.7.7.1.1.2.2.1.1.4.2.cmml">x</mi><mi id="A3.E20.m1.7.7.1.1.2.2.1.1.4.3" xref="A3.E20.m1.7.7.1.1.2.2.1.1.4.3.cmml">n</mi></msub></mrow><mo id="A3.E20.m1.7.7.1.1.2.2.1.3" stretchy="false" xref="A3.E20.m1.7.7.1.1.2.2.1.1.cmml">)</mo></mrow></mrow><mo id="A3.E20.m1.7.7.1.1.6" xref="A3.E20.m1.7.7.1.1.6.cmml">=</mo><mrow id="A3.E20.m1.7.7.1.1.7" xref="A3.E20.m1.7.7.1.1.7.cmml"><msup id="A3.E20.m1.7.7.1.1.7.2" xref="A3.E20.m1.7.7.1.1.7.2.cmml"><mi id="A3.E20.m1.7.7.1.1.7.2.2" xref="A3.E20.m1.7.7.1.1.7.2.2.cmml">x</mi><mi id="A3.E20.m1.7.7.1.1.7.2.3" xref="A3.E20.m1.7.7.1.1.7.2.3.cmml">T</mi></msup><mo id="A3.E20.m1.7.7.1.1.7.1" xref="A3.E20.m1.7.7.1.1.7.1.cmml">⁢</mo><msub id="A3.E20.m1.7.7.1.1.7.3" xref="A3.E20.m1.7.7.1.1.7.3.cmml"><mi id="A3.E20.m1.7.7.1.1.7.3.2" xref="A3.E20.m1.7.7.1.1.7.3.2.cmml">W</mi><mi id="A3.E20.m1.7.7.1.1.7.3.3" xref="A3.E20.m1.7.7.1.1.7.3.3.cmml">q</mi></msub><mo id="A3.E20.m1.7.7.1.1.7.1a" xref="A3.E20.m1.7.7.1.1.7.1.cmml">⁢</mo><msubsup id="A3.E20.m1.7.7.1.1.7.4" xref="A3.E20.m1.7.7.1.1.7.4.cmml"><mi id="A3.E20.m1.7.7.1.1.7.4.2.2" xref="A3.E20.m1.7.7.1.1.7.4.2.2.cmml">R</mi><mrow id="A3.E20.m1.6.6.2.2" xref="A3.E20.m1.6.6.2.3.cmml"><mi id="A3.E20.m1.5.5.1.1" mathvariant="normal" xref="A3.E20.m1.5.5.1.1.cmml">Θ</mi><mo id="A3.E20.m1.6.6.2.2.2" xref="A3.E20.m1.6.6.2.3.cmml">,</mo><mrow id="A3.E20.m1.6.6.2.2.1" xref="A3.E20.m1.6.6.2.2.1.cmml"><mi id="A3.E20.m1.6.6.2.2.1.2" xref="A3.E20.m1.6.6.2.2.1.2.cmml">n</mi><mo id="A3.E20.m1.6.6.2.2.1.1" xref="A3.E20.m1.6.6.2.2.1.1.cmml">−</mo><mi id="A3.E20.m1.6.6.2.2.1.3" xref="A3.E20.m1.6.6.2.2.1.3.cmml">m</mi></mrow></mrow><mi id="A3.E20.m1.7.7.1.1.7.4.3" xref="A3.E20.m1.7.7.1.1.7.4.3.cmml">d</mi></msubsup><mo id="A3.E20.m1.7.7.1.1.7.1b" xref="A3.E20.m1.7.7.1.1.7.1.cmml">⁢</mo><msubsup id="A3.E20.m1.7.7.1.1.7.5" xref="A3.E20.m1.7.7.1.1.7.5.cmml"><mi id="A3.E20.m1.7.7.1.1.7.5.2.2" xref="A3.E20.m1.7.7.1.1.7.5.2.2.cmml">W</mi><mi id="A3.E20.m1.7.7.1.1.7.5.2.3" xref="A3.E20.m1.7.7.1.1.7.5.2.3.cmml">k</mi><mi id="A3.E20.m1.7.7.1.1.7.5.3" xref="A3.E20.m1.7.7.1.1.7.5.3.cmml">T</mi></msubsup><mo id="A3.E20.m1.7.7.1.1.7.1c" xref="A3.E20.m1.7.7.1.1.7.1.cmml">⁢</mo><msub id="A3.E20.m1.7.7.1.1.7.6" xref="A3.E20.m1.7.7.1.1.7.6.cmml"><mi id="A3.E20.m1.7.7.1.1.7.6.2" xref="A3.E20.m1.7.7.1.1.7.6.2.cmml">x</mi><mi id="A3.E20.m1.7.7.1.1.7.6.3" xref="A3.E20.m1.7.7.1.1.7.6.3.cmml">n</mi></msub></mrow></mrow><mo id="A3.E20.m1.7.7.1.2" xref="A3.E20.m1.7.7.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A3.E20.m1.7b"><apply id="A3.E20.m1.7.7.1.1.cmml" xref="A3.E20.m1.7.7.1"><and id="A3.E20.m1.7.7.1.1a.cmml" xref="A3.E20.m1.7.7.1"></and><apply id="A3.E20.m1.7.7.1.1b.cmml" xref="A3.E20.m1.7.7.1"><eq id="A3.E20.m1.7.7.1.1.5.cmml" xref="A3.E20.m1.7.7.1.1.5"></eq><apply id="A3.E20.m1.7.7.1.1.4.cmml" xref="A3.E20.m1.7.7.1.1.4"><times id="A3.E20.m1.7.7.1.1.4.1.cmml" xref="A3.E20.m1.7.7.1.1.4.1"></times><apply id="A3.E20.m1.7.7.1.1.4.2.cmml" xref="A3.E20.m1.7.7.1.1.4.2"><csymbol cd="ambiguous" id="A3.E20.m1.7.7.1.1.4.2.1.cmml" xref="A3.E20.m1.7.7.1.1.4.2">superscript</csymbol><apply id="A3.E20.m1.7.7.1.1.4.2.2.cmml" xref="A3.E20.m1.7.7.1.1.4.2"><csymbol cd="ambiguous" id="A3.E20.m1.7.7.1.1.4.2.2.1.cmml" xref="A3.E20.m1.7.7.1.1.4.2">subscript</csymbol><ci id="A3.E20.m1.7.7.1.1.4.2.2.2.cmml" xref="A3.E20.m1.7.7.1.1.4.2.2.2">𝑞</ci><ci id="A3.E20.m1.7.7.1.1.4.2.2.3.cmml" xref="A3.E20.m1.7.7.1.1.4.2.2.3">𝑚</ci></apply><ci id="A3.E20.m1.7.7.1.1.4.2.3.cmml" xref="A3.E20.m1.7.7.1.1.4.2.3">𝑇</ci></apply><apply id="A3.E20.m1.7.7.1.1.4.3.cmml" xref="A3.E20.m1.7.7.1.1.4.3"><csymbol cd="ambiguous" id="A3.E20.m1.7.7.1.1.4.3.1.cmml" xref="A3.E20.m1.7.7.1.1.4.3">subscript</csymbol><ci id="A3.E20.m1.7.7.1.1.4.3.2.cmml" xref="A3.E20.m1.7.7.1.1.4.3.2">𝑘</ci><ci id="A3.E20.m1.7.7.1.1.4.3.3.cmml" xref="A3.E20.m1.7.7.1.1.4.3.3">𝑛</ci></apply></apply><apply id="A3.E20.m1.7.7.1.1.2.cmml" xref="A3.E20.m1.7.7.1.1.2"><times id="A3.E20.m1.7.7.1.1.2.3.cmml" xref="A3.E20.m1.7.7.1.1.2.3"></times><apply id="A3.E20.m1.7.7.1.1.1.1.cmml" xref="A3.E20.m1.7.7.1.1.1.1"><csymbol cd="ambiguous" id="A3.E20.m1.7.7.1.1.1.1.2.cmml" xref="A3.E20.m1.7.7.1.1.1.1">superscript</csymbol><apply id="A3.E20.m1.7.7.1.1.1.1.1.1.1.cmml" xref="A3.E20.m1.7.7.1.1.1.1.1.1"><times id="A3.E20.m1.7.7.1.1.1.1.1.1.1.1.cmml" xref="A3.E20.m1.7.7.1.1.1.1.1.1.1.1"></times><apply id="A3.E20.m1.7.7.1.1.1.1.1.1.1.2.cmml" xref="A3.E20.m1.7.7.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A3.E20.m1.7.7.1.1.1.1.1.1.1.2.1.cmml" xref="A3.E20.m1.7.7.1.1.1.1.1.1.1.2">superscript</csymbol><apply id="A3.E20.m1.7.7.1.1.1.1.1.1.1.2.2.cmml" xref="A3.E20.m1.7.7.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A3.E20.m1.7.7.1.1.1.1.1.1.1.2.2.1.cmml" xref="A3.E20.m1.7.7.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="A3.E20.m1.7.7.1.1.1.1.1.1.1.2.2.2.cmml" xref="A3.E20.m1.7.7.1.1.1.1.1.1.1.2.2.2">𝑅</ci><list id="A3.E20.m1.2.2.2.3.cmml" xref="A3.E20.m1.2.2.2.4"><ci id="A3.E20.m1.1.1.1.1.cmml" xref="A3.E20.m1.1.1.1.1">Θ</ci><ci id="A3.E20.m1.2.2.2.2.cmml" xref="A3.E20.m1.2.2.2.2">𝑚</ci></list></apply><ci id="A3.E20.m1.7.7.1.1.1.1.1.1.1.2.3.cmml" xref="A3.E20.m1.7.7.1.1.1.1.1.1.1.2.3">𝑑</ci></apply><apply id="A3.E20.m1.7.7.1.1.1.1.1.1.1.3.cmml" xref="A3.E20.m1.7.7.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A3.E20.m1.7.7.1.1.1.1.1.1.1.3.1.cmml" xref="A3.E20.m1.7.7.1.1.1.1.1.1.1.3">superscript</csymbol><apply id="A3.E20.m1.7.7.1.1.1.1.1.1.1.3.2.cmml" xref="A3.E20.m1.7.7.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A3.E20.m1.7.7.1.1.1.1.1.1.1.3.2.1.cmml" xref="A3.E20.m1.7.7.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="A3.E20.m1.7.7.1.1.1.1.1.1.1.3.2.2.cmml" xref="A3.E20.m1.7.7.1.1.1.1.1.1.1.3.2.2">𝑊</ci><ci id="A3.E20.m1.7.7.1.1.1.1.1.1.1.3.2.3.cmml" xref="A3.E20.m1.7.7.1.1.1.1.1.1.1.3.2.3">𝑞</ci></apply><ci id="A3.E20.m1.7.7.1.1.1.1.1.1.1.3.3.cmml" xref="A3.E20.m1.7.7.1.1.1.1.1.1.1.3.3">𝑇</ci></apply><apply id="A3.E20.m1.7.7.1.1.1.1.1.1.1.4.cmml" xref="A3.E20.m1.7.7.1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="A3.E20.m1.7.7.1.1.1.1.1.1.1.4.1.cmml" xref="A3.E20.m1.7.7.1.1.1.1.1.1.1.4">subscript</csymbol><ci id="A3.E20.m1.7.7.1.1.1.1.1.1.1.4.2.cmml" xref="A3.E20.m1.7.7.1.1.1.1.1.1.1.4.2">𝑥</ci><ci id="A3.E20.m1.7.7.1.1.1.1.1.1.1.4.3.cmml" xref="A3.E20.m1.7.7.1.1.1.1.1.1.1.4.3">𝑚</ci></apply></apply><ci id="A3.E20.m1.7.7.1.1.1.1.3.cmml" xref="A3.E20.m1.7.7.1.1.1.1.3">𝑇</ci></apply><apply id="A3.E20.m1.7.7.1.1.2.2.1.1.cmml" xref="A3.E20.m1.7.7.1.1.2.2.1"><times id="A3.E20.m1.7.7.1.1.2.2.1.1.1.cmml" xref="A3.E20.m1.7.7.1.1.2.2.1.1.1"></times><apply id="A3.E20.m1.7.7.1.1.2.2.1.1.2.cmml" xref="A3.E20.m1.7.7.1.1.2.2.1.1.2"><csymbol cd="ambiguous" id="A3.E20.m1.7.7.1.1.2.2.1.1.2.1.cmml" xref="A3.E20.m1.7.7.1.1.2.2.1.1.2">superscript</csymbol><apply id="A3.E20.m1.7.7.1.1.2.2.1.1.2.2.cmml" xref="A3.E20.m1.7.7.1.1.2.2.1.1.2"><csymbol cd="ambiguous" id="A3.E20.m1.7.7.1.1.2.2.1.1.2.2.1.cmml" xref="A3.E20.m1.7.7.1.1.2.2.1.1.2">subscript</csymbol><ci id="A3.E20.m1.7.7.1.1.2.2.1.1.2.2.2.cmml" xref="A3.E20.m1.7.7.1.1.2.2.1.1.2.2.2">𝑅</ci><list id="A3.E20.m1.4.4.2.3.cmml" xref="A3.E20.m1.4.4.2.4"><ci id="A3.E20.m1.3.3.1.1.cmml" xref="A3.E20.m1.3.3.1.1">Θ</ci><ci id="A3.E20.m1.4.4.2.2.cmml" xref="A3.E20.m1.4.4.2.2">𝑛</ci></list></apply><ci id="A3.E20.m1.7.7.1.1.2.2.1.1.2.3.cmml" xref="A3.E20.m1.7.7.1.1.2.2.1.1.2.3">𝑑</ci></apply><apply id="A3.E20.m1.7.7.1.1.2.2.1.1.3.cmml" xref="A3.E20.m1.7.7.1.1.2.2.1.1.3"><csymbol cd="ambiguous" id="A3.E20.m1.7.7.1.1.2.2.1.1.3.1.cmml" xref="A3.E20.m1.7.7.1.1.2.2.1.1.3">superscript</csymbol><apply id="A3.E20.m1.7.7.1.1.2.2.1.1.3.2.cmml" xref="A3.E20.m1.7.7.1.1.2.2.1.1.3"><csymbol cd="ambiguous" id="A3.E20.m1.7.7.1.1.2.2.1.1.3.2.1.cmml" xref="A3.E20.m1.7.7.1.1.2.2.1.1.3">subscript</csymbol><ci id="A3.E20.m1.7.7.1.1.2.2.1.1.3.2.2.cmml" xref="A3.E20.m1.7.7.1.1.2.2.1.1.3.2.2">𝑊</ci><ci id="A3.E20.m1.7.7.1.1.2.2.1.1.3.2.3.cmml" xref="A3.E20.m1.7.7.1.1.2.2.1.1.3.2.3">𝑘</ci></apply><ci id="A3.E20.m1.7.7.1.1.2.2.1.1.3.3.cmml" xref="A3.E20.m1.7.7.1.1.2.2.1.1.3.3">𝑇</ci></apply><apply id="A3.E20.m1.7.7.1.1.2.2.1.1.4.cmml" xref="A3.E20.m1.7.7.1.1.2.2.1.1.4"><csymbol cd="ambiguous" id="A3.E20.m1.7.7.1.1.2.2.1.1.4.1.cmml" xref="A3.E20.m1.7.7.1.1.2.2.1.1.4">subscript</csymbol><ci id="A3.E20.m1.7.7.1.1.2.2.1.1.4.2.cmml" xref="A3.E20.m1.7.7.1.1.2.2.1.1.4.2">𝑥</ci><ci id="A3.E20.m1.7.7.1.1.2.2.1.1.4.3.cmml" xref="A3.E20.m1.7.7.1.1.2.2.1.1.4.3">𝑛</ci></apply></apply></apply></apply><apply id="A3.E20.m1.7.7.1.1c.cmml" xref="A3.E20.m1.7.7.1"><eq id="A3.E20.m1.7.7.1.1.6.cmml" xref="A3.E20.m1.7.7.1.1.6"></eq><share href="https://arxiv.org/html/2410.03111v1#A3.E20.m1.7.7.1.1.2.cmml" id="A3.E20.m1.7.7.1.1d.cmml" xref="A3.E20.m1.7.7.1"></share><apply id="A3.E20.m1.7.7.1.1.7.cmml" xref="A3.E20.m1.7.7.1.1.7"><times id="A3.E20.m1.7.7.1.1.7.1.cmml" xref="A3.E20.m1.7.7.1.1.7.1"></times><apply id="A3.E20.m1.7.7.1.1.7.2.cmml" xref="A3.E20.m1.7.7.1.1.7.2"><csymbol cd="ambiguous" id="A3.E20.m1.7.7.1.1.7.2.1.cmml" xref="A3.E20.m1.7.7.1.1.7.2">superscript</csymbol><ci id="A3.E20.m1.7.7.1.1.7.2.2.cmml" xref="A3.E20.m1.7.7.1.1.7.2.2">𝑥</ci><ci id="A3.E20.m1.7.7.1.1.7.2.3.cmml" xref="A3.E20.m1.7.7.1.1.7.2.3">𝑇</ci></apply><apply id="A3.E20.m1.7.7.1.1.7.3.cmml" xref="A3.E20.m1.7.7.1.1.7.3"><csymbol cd="ambiguous" id="A3.E20.m1.7.7.1.1.7.3.1.cmml" xref="A3.E20.m1.7.7.1.1.7.3">subscript</csymbol><ci id="A3.E20.m1.7.7.1.1.7.3.2.cmml" xref="A3.E20.m1.7.7.1.1.7.3.2">𝑊</ci><ci id="A3.E20.m1.7.7.1.1.7.3.3.cmml" xref="A3.E20.m1.7.7.1.1.7.3.3">𝑞</ci></apply><apply id="A3.E20.m1.7.7.1.1.7.4.cmml" xref="A3.E20.m1.7.7.1.1.7.4"><csymbol cd="ambiguous" id="A3.E20.m1.7.7.1.1.7.4.1.cmml" xref="A3.E20.m1.7.7.1.1.7.4">superscript</csymbol><apply id="A3.E20.m1.7.7.1.1.7.4.2.cmml" xref="A3.E20.m1.7.7.1.1.7.4"><csymbol cd="ambiguous" id="A3.E20.m1.7.7.1.1.7.4.2.1.cmml" xref="A3.E20.m1.7.7.1.1.7.4">subscript</csymbol><ci id="A3.E20.m1.7.7.1.1.7.4.2.2.cmml" xref="A3.E20.m1.7.7.1.1.7.4.2.2">𝑅</ci><list id="A3.E20.m1.6.6.2.3.cmml" xref="A3.E20.m1.6.6.2.2"><ci id="A3.E20.m1.5.5.1.1.cmml" xref="A3.E20.m1.5.5.1.1">Θ</ci><apply id="A3.E20.m1.6.6.2.2.1.cmml" xref="A3.E20.m1.6.6.2.2.1"><minus id="A3.E20.m1.6.6.2.2.1.1.cmml" xref="A3.E20.m1.6.6.2.2.1.1"></minus><ci id="A3.E20.m1.6.6.2.2.1.2.cmml" xref="A3.E20.m1.6.6.2.2.1.2">𝑛</ci><ci id="A3.E20.m1.6.6.2.2.1.3.cmml" xref="A3.E20.m1.6.6.2.2.1.3">𝑚</ci></apply></list></apply><ci id="A3.E20.m1.7.7.1.1.7.4.3.cmml" xref="A3.E20.m1.7.7.1.1.7.4.3">𝑑</ci></apply><apply id="A3.E20.m1.7.7.1.1.7.5.cmml" xref="A3.E20.m1.7.7.1.1.7.5"><csymbol cd="ambiguous" id="A3.E20.m1.7.7.1.1.7.5.1.cmml" xref="A3.E20.m1.7.7.1.1.7.5">superscript</csymbol><apply id="A3.E20.m1.7.7.1.1.7.5.2.cmml" xref="A3.E20.m1.7.7.1.1.7.5"><csymbol cd="ambiguous" id="A3.E20.m1.7.7.1.1.7.5.2.1.cmml" xref="A3.E20.m1.7.7.1.1.7.5">subscript</csymbol><ci id="A3.E20.m1.7.7.1.1.7.5.2.2.cmml" xref="A3.E20.m1.7.7.1.1.7.5.2.2">𝑊</ci><ci id="A3.E20.m1.7.7.1.1.7.5.2.3.cmml" xref="A3.E20.m1.7.7.1.1.7.5.2.3">𝑘</ci></apply><ci id="A3.E20.m1.7.7.1.1.7.5.3.cmml" xref="A3.E20.m1.7.7.1.1.7.5.3">𝑇</ci></apply><apply id="A3.E20.m1.7.7.1.1.7.6.cmml" xref="A3.E20.m1.7.7.1.1.7.6"><csymbol cd="ambiguous" id="A3.E20.m1.7.7.1.1.7.6.1.cmml" xref="A3.E20.m1.7.7.1.1.7.6">subscript</csymbol><ci id="A3.E20.m1.7.7.1.1.7.6.2.cmml" xref="A3.E20.m1.7.7.1.1.7.6.2">𝑥</ci><ci id="A3.E20.m1.7.7.1.1.7.6.3.cmml" xref="A3.E20.m1.7.7.1.1.7.6.3">𝑛</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.E20.m1.7c">q_{m}^{T}k_{n}=(R_{\Theta,m}^{d}W_{q}^{T}x_{m})^{T}(R_{\Theta,n}^{d}W_{k}^{T}x%
_{n})=x^{T}W_{q}R_{\Theta,n-m}^{d}W_{k}^{T}x_{n},</annotation><annotation encoding="application/x-llamapun" id="A3.E20.m1.7d">italic_q start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_k start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT = ( italic_R start_POSTSUBSCRIPT roman_Θ , italic_m end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT italic_W start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_x start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT ( italic_R start_POSTSUBSCRIPT roman_Θ , italic_n end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT italic_W start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_x start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT ) = italic_x start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_W start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT italic_R start_POSTSUBSCRIPT roman_Θ , italic_n - italic_m end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT italic_W start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_x start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(20)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A3.p1.7">where <math alttext="\Theta" class="ltx_Math" display="inline" id="A3.p1.1.m1.1"><semantics id="A3.p1.1.m1.1a"><mi id="A3.p1.1.m1.1.1" mathvariant="normal" xref="A3.p1.1.m1.1.1.cmml">Θ</mi><annotation-xml encoding="MathML-Content" id="A3.p1.1.m1.1b"><ci id="A3.p1.1.m1.1.1.cmml" xref="A3.p1.1.m1.1.1">Θ</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.1.m1.1c">\Theta</annotation><annotation encoding="application/x-llamapun" id="A3.p1.1.m1.1d">roman_Θ</annotation></semantics></math> is a pre-defined rotary matrix, <math alttext="m" class="ltx_Math" display="inline" id="A3.p1.2.m2.1"><semantics id="A3.p1.2.m2.1a"><mi id="A3.p1.2.m2.1.1" xref="A3.p1.2.m2.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="A3.p1.2.m2.1b"><ci id="A3.p1.2.m2.1.1.cmml" xref="A3.p1.2.m2.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.2.m2.1c">m</annotation><annotation encoding="application/x-llamapun" id="A3.p1.2.m2.1d">italic_m</annotation></semantics></math> and <math alttext="n" class="ltx_Math" display="inline" id="A3.p1.3.m3.1"><semantics id="A3.p1.3.m3.1a"><mi id="A3.p1.3.m3.1.1" xref="A3.p1.3.m3.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="A3.p1.3.m3.1b"><ci id="A3.p1.3.m3.1.1.cmml" xref="A3.p1.3.m3.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.3.m3.1c">n</annotation><annotation encoding="application/x-llamapun" id="A3.p1.3.m3.1d">italic_n</annotation></semantics></math> denotes the token position. In practice, the rotation matrix <math alttext="R_{\Theta,n-m}^{d}" class="ltx_Math" display="inline" id="A3.p1.4.m4.2"><semantics id="A3.p1.4.m4.2a"><msubsup id="A3.p1.4.m4.2.3" xref="A3.p1.4.m4.2.3.cmml"><mi id="A3.p1.4.m4.2.3.2.2" xref="A3.p1.4.m4.2.3.2.2.cmml">R</mi><mrow id="A3.p1.4.m4.2.2.2.2" xref="A3.p1.4.m4.2.2.2.3.cmml"><mi id="A3.p1.4.m4.1.1.1.1" mathvariant="normal" xref="A3.p1.4.m4.1.1.1.1.cmml">Θ</mi><mo id="A3.p1.4.m4.2.2.2.2.2" xref="A3.p1.4.m4.2.2.2.3.cmml">,</mo><mrow id="A3.p1.4.m4.2.2.2.2.1" xref="A3.p1.4.m4.2.2.2.2.1.cmml"><mi id="A3.p1.4.m4.2.2.2.2.1.2" xref="A3.p1.4.m4.2.2.2.2.1.2.cmml">n</mi><mo id="A3.p1.4.m4.2.2.2.2.1.1" xref="A3.p1.4.m4.2.2.2.2.1.1.cmml">−</mo><mi id="A3.p1.4.m4.2.2.2.2.1.3" xref="A3.p1.4.m4.2.2.2.2.1.3.cmml">m</mi></mrow></mrow><mi id="A3.p1.4.m4.2.3.3" xref="A3.p1.4.m4.2.3.3.cmml">d</mi></msubsup><annotation-xml encoding="MathML-Content" id="A3.p1.4.m4.2b"><apply id="A3.p1.4.m4.2.3.cmml" xref="A3.p1.4.m4.2.3"><csymbol cd="ambiguous" id="A3.p1.4.m4.2.3.1.cmml" xref="A3.p1.4.m4.2.3">superscript</csymbol><apply id="A3.p1.4.m4.2.3.2.cmml" xref="A3.p1.4.m4.2.3"><csymbol cd="ambiguous" id="A3.p1.4.m4.2.3.2.1.cmml" xref="A3.p1.4.m4.2.3">subscript</csymbol><ci id="A3.p1.4.m4.2.3.2.2.cmml" xref="A3.p1.4.m4.2.3.2.2">𝑅</ci><list id="A3.p1.4.m4.2.2.2.3.cmml" xref="A3.p1.4.m4.2.2.2.2"><ci id="A3.p1.4.m4.1.1.1.1.cmml" xref="A3.p1.4.m4.1.1.1.1">Θ</ci><apply id="A3.p1.4.m4.2.2.2.2.1.cmml" xref="A3.p1.4.m4.2.2.2.2.1"><minus id="A3.p1.4.m4.2.2.2.2.1.1.cmml" xref="A3.p1.4.m4.2.2.2.2.1.1"></minus><ci id="A3.p1.4.m4.2.2.2.2.1.2.cmml" xref="A3.p1.4.m4.2.2.2.2.1.2">𝑛</ci><ci id="A3.p1.4.m4.2.2.2.2.1.3.cmml" xref="A3.p1.4.m4.2.2.2.2.1.3">𝑚</ci></apply></list></apply><ci id="A3.p1.4.m4.2.3.3.cmml" xref="A3.p1.4.m4.2.3.3">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.4.m4.2c">R_{\Theta,n-m}^{d}</annotation><annotation encoding="application/x-llamapun" id="A3.p1.4.m4.2d">italic_R start_POSTSUBSCRIPT roman_Θ , italic_n - italic_m end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT</annotation></semantics></math> is decomposed as <math alttext="(R_{\Theta,m}^{d})^{T}" class="ltx_Math" display="inline" id="A3.p1.5.m5.3"><semantics id="A3.p1.5.m5.3a"><msup id="A3.p1.5.m5.3.3" xref="A3.p1.5.m5.3.3.cmml"><mrow id="A3.p1.5.m5.3.3.1.1" xref="A3.p1.5.m5.3.3.1.1.1.cmml"><mo id="A3.p1.5.m5.3.3.1.1.2" stretchy="false" xref="A3.p1.5.m5.3.3.1.1.1.cmml">(</mo><msubsup id="A3.p1.5.m5.3.3.1.1.1" xref="A3.p1.5.m5.3.3.1.1.1.cmml"><mi id="A3.p1.5.m5.3.3.1.1.1.2.2" xref="A3.p1.5.m5.3.3.1.1.1.2.2.cmml">R</mi><mrow id="A3.p1.5.m5.2.2.2.4" xref="A3.p1.5.m5.2.2.2.3.cmml"><mi id="A3.p1.5.m5.1.1.1.1" mathvariant="normal" xref="A3.p1.5.m5.1.1.1.1.cmml">Θ</mi><mo id="A3.p1.5.m5.2.2.2.4.1" xref="A3.p1.5.m5.2.2.2.3.cmml">,</mo><mi id="A3.p1.5.m5.2.2.2.2" xref="A3.p1.5.m5.2.2.2.2.cmml">m</mi></mrow><mi id="A3.p1.5.m5.3.3.1.1.1.3" xref="A3.p1.5.m5.3.3.1.1.1.3.cmml">d</mi></msubsup><mo id="A3.p1.5.m5.3.3.1.1.3" stretchy="false" xref="A3.p1.5.m5.3.3.1.1.1.cmml">)</mo></mrow><mi id="A3.p1.5.m5.3.3.3" xref="A3.p1.5.m5.3.3.3.cmml">T</mi></msup><annotation-xml encoding="MathML-Content" id="A3.p1.5.m5.3b"><apply id="A3.p1.5.m5.3.3.cmml" xref="A3.p1.5.m5.3.3"><csymbol cd="ambiguous" id="A3.p1.5.m5.3.3.2.cmml" xref="A3.p1.5.m5.3.3">superscript</csymbol><apply id="A3.p1.5.m5.3.3.1.1.1.cmml" xref="A3.p1.5.m5.3.3.1.1"><csymbol cd="ambiguous" id="A3.p1.5.m5.3.3.1.1.1.1.cmml" xref="A3.p1.5.m5.3.3.1.1">superscript</csymbol><apply id="A3.p1.5.m5.3.3.1.1.1.2.cmml" xref="A3.p1.5.m5.3.3.1.1"><csymbol cd="ambiguous" id="A3.p1.5.m5.3.3.1.1.1.2.1.cmml" xref="A3.p1.5.m5.3.3.1.1">subscript</csymbol><ci id="A3.p1.5.m5.3.3.1.1.1.2.2.cmml" xref="A3.p1.5.m5.3.3.1.1.1.2.2">𝑅</ci><list id="A3.p1.5.m5.2.2.2.3.cmml" xref="A3.p1.5.m5.2.2.2.4"><ci id="A3.p1.5.m5.1.1.1.1.cmml" xref="A3.p1.5.m5.1.1.1.1">Θ</ci><ci id="A3.p1.5.m5.2.2.2.2.cmml" xref="A3.p1.5.m5.2.2.2.2">𝑚</ci></list></apply><ci id="A3.p1.5.m5.3.3.1.1.1.3.cmml" xref="A3.p1.5.m5.3.3.1.1.1.3">𝑑</ci></apply><ci id="A3.p1.5.m5.3.3.3.cmml" xref="A3.p1.5.m5.3.3.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.5.m5.3c">(R_{\Theta,m}^{d})^{T}</annotation><annotation encoding="application/x-llamapun" id="A3.p1.5.m5.3d">( italic_R start_POSTSUBSCRIPT roman_Θ , italic_m end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="R_{\Theta,n}^{d}" class="ltx_Math" display="inline" id="A3.p1.6.m6.2"><semantics id="A3.p1.6.m6.2a"><msubsup id="A3.p1.6.m6.2.3" xref="A3.p1.6.m6.2.3.cmml"><mi id="A3.p1.6.m6.2.3.2.2" xref="A3.p1.6.m6.2.3.2.2.cmml">R</mi><mrow id="A3.p1.6.m6.2.2.2.4" xref="A3.p1.6.m6.2.2.2.3.cmml"><mi id="A3.p1.6.m6.1.1.1.1" mathvariant="normal" xref="A3.p1.6.m6.1.1.1.1.cmml">Θ</mi><mo id="A3.p1.6.m6.2.2.2.4.1" xref="A3.p1.6.m6.2.2.2.3.cmml">,</mo><mi id="A3.p1.6.m6.2.2.2.2" xref="A3.p1.6.m6.2.2.2.2.cmml">n</mi></mrow><mi id="A3.p1.6.m6.2.3.3" xref="A3.p1.6.m6.2.3.3.cmml">d</mi></msubsup><annotation-xml encoding="MathML-Content" id="A3.p1.6.m6.2b"><apply id="A3.p1.6.m6.2.3.cmml" xref="A3.p1.6.m6.2.3"><csymbol cd="ambiguous" id="A3.p1.6.m6.2.3.1.cmml" xref="A3.p1.6.m6.2.3">superscript</csymbol><apply id="A3.p1.6.m6.2.3.2.cmml" xref="A3.p1.6.m6.2.3"><csymbol cd="ambiguous" id="A3.p1.6.m6.2.3.2.1.cmml" xref="A3.p1.6.m6.2.3">subscript</csymbol><ci id="A3.p1.6.m6.2.3.2.2.cmml" xref="A3.p1.6.m6.2.3.2.2">𝑅</ci><list id="A3.p1.6.m6.2.2.2.3.cmml" xref="A3.p1.6.m6.2.2.2.4"><ci id="A3.p1.6.m6.1.1.1.1.cmml" xref="A3.p1.6.m6.1.1.1.1">Θ</ci><ci id="A3.p1.6.m6.2.2.2.2.cmml" xref="A3.p1.6.m6.2.2.2.2">𝑛</ci></list></apply><ci id="A3.p1.6.m6.2.3.3.cmml" xref="A3.p1.6.m6.2.3.3">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.6.m6.2c">R_{\Theta,n}^{d}</annotation><annotation encoding="application/x-llamapun" id="A3.p1.6.m6.2d">italic_R start_POSTSUBSCRIPT roman_Θ , italic_n end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT</annotation></semantics></math> to rotate the query and key separately, and the KV cache stores the rotated keys.
To ensure that our compressed keys are compatible with the rotary operation, we adjust the position embedding pipeline. Specifically, we store the compressed keys <math alttext="X(\Sigma V^{\top})^{\top}_{D\times d_{c}}" class="ltx_Math" display="inline" id="A3.p1.7.m7.1"><semantics id="A3.p1.7.m7.1a"><mrow id="A3.p1.7.m7.1.1" xref="A3.p1.7.m7.1.1.cmml"><mi id="A3.p1.7.m7.1.1.3" xref="A3.p1.7.m7.1.1.3.cmml">X</mi><mo id="A3.p1.7.m7.1.1.2" xref="A3.p1.7.m7.1.1.2.cmml">⁢</mo><msubsup id="A3.p1.7.m7.1.1.1" xref="A3.p1.7.m7.1.1.1.cmml"><mrow id="A3.p1.7.m7.1.1.1.1.1.1" xref="A3.p1.7.m7.1.1.1.1.1.1.1.cmml"><mo id="A3.p1.7.m7.1.1.1.1.1.1.2" stretchy="false" xref="A3.p1.7.m7.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A3.p1.7.m7.1.1.1.1.1.1.1" xref="A3.p1.7.m7.1.1.1.1.1.1.1.cmml"><mi id="A3.p1.7.m7.1.1.1.1.1.1.1.2" mathvariant="normal" xref="A3.p1.7.m7.1.1.1.1.1.1.1.2.cmml">Σ</mi><mo id="A3.p1.7.m7.1.1.1.1.1.1.1.1" xref="A3.p1.7.m7.1.1.1.1.1.1.1.1.cmml">⁢</mo><msup id="A3.p1.7.m7.1.1.1.1.1.1.1.3" xref="A3.p1.7.m7.1.1.1.1.1.1.1.3.cmml"><mi id="A3.p1.7.m7.1.1.1.1.1.1.1.3.2" xref="A3.p1.7.m7.1.1.1.1.1.1.1.3.2.cmml">V</mi><mo id="A3.p1.7.m7.1.1.1.1.1.1.1.3.3" xref="A3.p1.7.m7.1.1.1.1.1.1.1.3.3.cmml">⊤</mo></msup></mrow><mo id="A3.p1.7.m7.1.1.1.1.1.1.3" stretchy="false" xref="A3.p1.7.m7.1.1.1.1.1.1.1.cmml">)</mo></mrow><mrow id="A3.p1.7.m7.1.1.1.3" xref="A3.p1.7.m7.1.1.1.3.cmml"><mi id="A3.p1.7.m7.1.1.1.3.2" xref="A3.p1.7.m7.1.1.1.3.2.cmml">D</mi><mo id="A3.p1.7.m7.1.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="A3.p1.7.m7.1.1.1.3.1.cmml">×</mo><msub id="A3.p1.7.m7.1.1.1.3.3" xref="A3.p1.7.m7.1.1.1.3.3.cmml"><mi id="A3.p1.7.m7.1.1.1.3.3.2" xref="A3.p1.7.m7.1.1.1.3.3.2.cmml">d</mi><mi id="A3.p1.7.m7.1.1.1.3.3.3" xref="A3.p1.7.m7.1.1.1.3.3.3.cmml">c</mi></msub></mrow><mo id="A3.p1.7.m7.1.1.1.1.3" xref="A3.p1.7.m7.1.1.1.1.3.cmml">⊤</mo></msubsup></mrow><annotation-xml encoding="MathML-Content" id="A3.p1.7.m7.1b"><apply id="A3.p1.7.m7.1.1.cmml" xref="A3.p1.7.m7.1.1"><times id="A3.p1.7.m7.1.1.2.cmml" xref="A3.p1.7.m7.1.1.2"></times><ci id="A3.p1.7.m7.1.1.3.cmml" xref="A3.p1.7.m7.1.1.3">𝑋</ci><apply id="A3.p1.7.m7.1.1.1.cmml" xref="A3.p1.7.m7.1.1.1"><csymbol cd="ambiguous" id="A3.p1.7.m7.1.1.1.2.cmml" xref="A3.p1.7.m7.1.1.1">subscript</csymbol><apply id="A3.p1.7.m7.1.1.1.1.cmml" xref="A3.p1.7.m7.1.1.1"><csymbol cd="ambiguous" id="A3.p1.7.m7.1.1.1.1.2.cmml" xref="A3.p1.7.m7.1.1.1">superscript</csymbol><apply id="A3.p1.7.m7.1.1.1.1.1.1.1.cmml" xref="A3.p1.7.m7.1.1.1.1.1.1"><times id="A3.p1.7.m7.1.1.1.1.1.1.1.1.cmml" xref="A3.p1.7.m7.1.1.1.1.1.1.1.1"></times><ci id="A3.p1.7.m7.1.1.1.1.1.1.1.2.cmml" xref="A3.p1.7.m7.1.1.1.1.1.1.1.2">Σ</ci><apply id="A3.p1.7.m7.1.1.1.1.1.1.1.3.cmml" xref="A3.p1.7.m7.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A3.p1.7.m7.1.1.1.1.1.1.1.3.1.cmml" xref="A3.p1.7.m7.1.1.1.1.1.1.1.3">superscript</csymbol><ci id="A3.p1.7.m7.1.1.1.1.1.1.1.3.2.cmml" xref="A3.p1.7.m7.1.1.1.1.1.1.1.3.2">𝑉</ci><csymbol cd="latexml" id="A3.p1.7.m7.1.1.1.1.1.1.1.3.3.cmml" xref="A3.p1.7.m7.1.1.1.1.1.1.1.3.3">top</csymbol></apply></apply><csymbol cd="latexml" id="A3.p1.7.m7.1.1.1.1.3.cmml" xref="A3.p1.7.m7.1.1.1.1.3">top</csymbol></apply><apply id="A3.p1.7.m7.1.1.1.3.cmml" xref="A3.p1.7.m7.1.1.1.3"><times id="A3.p1.7.m7.1.1.1.3.1.cmml" xref="A3.p1.7.m7.1.1.1.3.1"></times><ci id="A3.p1.7.m7.1.1.1.3.2.cmml" xref="A3.p1.7.m7.1.1.1.3.2">𝐷</ci><apply id="A3.p1.7.m7.1.1.1.3.3.cmml" xref="A3.p1.7.m7.1.1.1.3.3"><csymbol cd="ambiguous" id="A3.p1.7.m7.1.1.1.3.3.1.cmml" xref="A3.p1.7.m7.1.1.1.3.3">subscript</csymbol><ci id="A3.p1.7.m7.1.1.1.3.3.2.cmml" xref="A3.p1.7.m7.1.1.1.3.3.2">𝑑</ci><ci id="A3.p1.7.m7.1.1.1.3.3.3.cmml" xref="A3.p1.7.m7.1.1.1.3.3.3">𝑐</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.7.m7.1c">X(\Sigma V^{\top})^{\top}_{D\times d_{c}}</annotation><annotation encoding="application/x-llamapun" id="A3.p1.7.m7.1d">italic_X ( roman_Σ italic_V start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_D × italic_d start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math> in cache, while incorporating the rotation and key projection into the query computation to streamline the process.</p>
</div>
</section>
<section class="ltx_appendix" id="A4">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix D </span>Computational details</h2>
<div class="ltx_para" id="A4.p1">
<p class="ltx_p" id="A4.p1.1">For all experiments except those involving the LLaMA-3-70B model, we utilize a single node equipped with 4 A100 GPUs. For the LLaMA-3-70B model, we employ a node with 8 V100 GPUs.</p>
</div>
<div class="ltx_para" id="A4.p2">
<p class="ltx_p" id="A4.p2.1">The calculation of SVD is efficient based on the Numpy library. For LLaMA-3-Instruct-70B, the largest model used in our experiments, the all-layer (80 layers in total) SVD takes only 40 seconds.</p>
</div>
<figure class="ltx_table" id="A4.T3">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="A4.T3.5.1.1" style="font-size:90%;">Table 3</span>: </span><span class="ltx_text" id="A4.T3.6.2" style="font-size:90%;">Model Architectures.</span></figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="A4.T3.3" style="width:433.6pt;height:56.7pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-58.7pt,7.7pt) scale(0.78680922844563,0.78680922844563) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="A4.T3.3.3">
<thead class="ltx_thead">
<tr class="ltx_tr" id="A4.T3.3.3.4.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="A4.T3.3.3.4.1.1">Model</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="A4.T3.3.3.4.1.2">Attention</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A4.T3.3.3.4.1.3">Layers</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A4.T3.3.3.4.1.4">Heads</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A4.T3.3.3.4.1.5">KV Heads</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A4.T3.3.3.4.1.6">Head Dimension</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A4.T3.3.3.4.1.7">Model Dimension</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A4.T3.3.3.4.1.8">Weight Shape</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A4.T3.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" id="A4.T3.1.1.1.2">LLaMA-2-13B</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" id="A4.T3.1.1.1.3">MHA</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="A4.T3.1.1.1.4">40</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A4.T3.1.1.1.5">40</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A4.T3.1.1.1.6">40</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A4.T3.1.1.1.7">128</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A4.T3.1.1.1.8">5120</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A4.T3.1.1.1.1">5120 <math alttext="\times" class="ltx_Math" display="inline" id="A4.T3.1.1.1.1.m1.1"><semantics id="A4.T3.1.1.1.1.m1.1a"><mo id="A4.T3.1.1.1.1.m1.1.1" xref="A4.T3.1.1.1.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A4.T3.1.1.1.1.m1.1b"><times id="A4.T3.1.1.1.1.m1.1.1.cmml" xref="A4.T3.1.1.1.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A4.T3.1.1.1.1.m1.1c">\times</annotation><annotation encoding="application/x-llamapun" id="A4.T3.1.1.1.1.m1.1d">×</annotation></semantics></math> 5120</td>
</tr>
<tr class="ltx_tr" id="A4.T3.2.2.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="A4.T3.2.2.2.2">LLaMA-3-Instruct-8B</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="A4.T3.2.2.2.3">GQA</th>
<td class="ltx_td ltx_align_center" id="A4.T3.2.2.2.4">32</td>
<td class="ltx_td ltx_align_center" id="A4.T3.2.2.2.5">32</td>
<td class="ltx_td ltx_align_center" id="A4.T3.2.2.2.6">8</td>
<td class="ltx_td ltx_align_center" id="A4.T3.2.2.2.7">128</td>
<td class="ltx_td ltx_align_center" id="A4.T3.2.2.2.8">4096</td>
<td class="ltx_td ltx_align_center" id="A4.T3.2.2.2.1">4096 <math alttext="\times" class="ltx_Math" display="inline" id="A4.T3.2.2.2.1.m1.1"><semantics id="A4.T3.2.2.2.1.m1.1a"><mo id="A4.T3.2.2.2.1.m1.1.1" xref="A4.T3.2.2.2.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A4.T3.2.2.2.1.m1.1b"><times id="A4.T3.2.2.2.1.m1.1.1.cmml" xref="A4.T3.2.2.2.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A4.T3.2.2.2.1.m1.1c">\times</annotation><annotation encoding="application/x-llamapun" id="A4.T3.2.2.2.1.m1.1d">×</annotation></semantics></math> 1024</td>
</tr>
<tr class="ltx_tr" id="A4.T3.3.3.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb" id="A4.T3.3.3.3.2">LLaMA-3-Instruct-70B</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb" id="A4.T3.3.3.3.3">GQA</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A4.T3.3.3.3.4">80</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A4.T3.3.3.3.5">64</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A4.T3.3.3.3.6">8</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A4.T3.3.3.3.7">128</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A4.T3.3.3.3.8">8192</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A4.T3.3.3.3.1">8192 <math alttext="\times" class="ltx_Math" display="inline" id="A4.T3.3.3.3.1.m1.1"><semantics id="A4.T3.3.3.3.1.m1.1a"><mo id="A4.T3.3.3.3.1.m1.1.1" xref="A4.T3.3.3.3.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A4.T3.3.3.3.1.m1.1b"><times id="A4.T3.3.3.3.1.m1.1.1.cmml" xref="A4.T3.3.3.3.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A4.T3.3.3.3.1.m1.1c">\times</annotation><annotation encoding="application/x-llamapun" id="A4.T3.3.3.3.1.m1.1d">×</annotation></semantics></math> 1024</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Fri Oct  4 02:59:27 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
