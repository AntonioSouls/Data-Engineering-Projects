<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2309.08152] DA-RAW: Domain Adaptive Object Detection for Real-World Adverse Weather Conditions</title><meta property="og:description" content="Despite the success of deep learning-based object detection methods in recent years, it is still challenging to make the object detector reliable in adverse weather conditions such as rain and snow. For the robust perf…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="DA-RAW: Domain Adaptive Object Detection for Real-World Adverse Weather Conditions">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="DA-RAW: Domain Adaptive Object Detection for Real-World Adverse Weather Conditions">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2309.08152">

<!--Generated on Wed Feb 28 06:22:16 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_font_bold ltx_title_document" style="font-size:173%;">DA-RAW: Domain Adaptive Object Detection for Real-World 
<br class="ltx_break">Adverse Weather Conditions
</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Minsik Jeon<sup id="id4.4.id1" class="ltx_sup"><span id="id4.4.id1.1" class="ltx_text ltx_font_italic">∗</span></sup>, Junwon Seo<sup id="id5.5.id2" class="ltx_sup"><span id="id5.5.id2.1" class="ltx_text ltx_font_italic">∗</span></sup>, and Jihong Min
</span><span class="ltx_author_notes">This work was supported by the Agency For Defense Development Grant funded by the Korean Government in 2023.Minsik Jeon, Junwon Seo, and Jihong Min are with the Agency for Defense Development, Republic of Korea
<span id="id6.6.id1" class="ltx_text ltx_font_typewriter" style="font-size:80%;">{mikejeon001123, junwon.vision, happymin77}@gmail.com</span><sup id="id7.7.id1" class="ltx_sup"><span id="id7.7.id1.1" class="ltx_text ltx_font_italic">∗</span></sup>These authors contributed equally to this work.Our video can be found at <a target="_blank" href="https://youtu.be/vsUSrFsbuu8" title="" class="ltx_ref ltx_href ltx_font_typewriter" style="font-size:80%;">https://youtu.be/vsUSrFsbuu8</a></span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id8.id1" class="ltx_p">Despite the success of deep learning-based object detection methods in recent years, it is still challenging to make the object detector reliable in adverse weather conditions such as rain and snow. For the robust performance of object detectors, unsupervised domain adaptation has been utilized to adapt the detection network trained on clear weather images to adverse weather images. While previous methods do not explicitly address weather corruption during adaptation, the domain gap between clear and adverse weather can be decomposed into two factors with distinct characteristics: a style gap and a weather gap. In this paper, we present an unsupervised domain adaptation framework for object detection that can more effectively adapt to real-world environments with adverse weather conditions by addressing these two gaps separately. Our method resolves the style gap by concentrating on style-related information of high-level features using an attention module. Using self-supervised contrastive learning, our framework then reduces the weather gap and acquires instance features that are robust to weather corruption. Extensive experiments demonstrate that our method outperforms other methods for object detection in adverse weather conditions.</p>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">I </span><span id="S1.1.1" class="ltx_text ltx_font_smallcaps">INTRODUCTION</span>
</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Object detection plays a crucial role in enabling machines, such as autonomous vehicles and surveillance systems, to perceive and comprehend their surrounding environment. While deep learning has significantly improved object detection capabilities, ensuring the accuracy of these systems under adverse weather conditions like rain and snow remains an ongoing challenge. To ensure the detector’s dependability, it is necessary to develop a learning method that can adapt object detectors to adverse weather conditions.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">Due to the laborious process of obtaining labeled data for real-world adverse weather conditions, various methods have utilized synthetic datasets to improve detection performance. By generating synthetic weather effects on clear weather images without degradation, fully annotated images of adverse weather are obtained. These images are utilized to train the robust model in a supervised manner <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>, <a href="#bib.bib2" title="" class="ltx_ref">2</a>, <a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>, or the removal network can be trained to restore a clear image from adverse weather images <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>, <a href="#bib.bib5" title="" class="ltx_ref">5</a>, <a href="#bib.bib6" title="" class="ltx_ref">6</a>, <a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite>. However, prior knowledge of weather conditions cannot effectively capture the intricate characteristics of adverse weather conditions in the real world, which have diverse and complex effects on images. Therefore, relying on synthetic datasets does not significantly enhance the model’s performance when applied to real-world environments. Recent works also suggest that separately trained removal networks do not help downstream tasks <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>, <a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>, implying the need for methods that improve the performance of downstream tasks in adverse weather conditions.</p>
</div>
<figure id="S1.F1" class="ltx_figure"><img src="/html/2309.08152/assets/x1.png" id="S1.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="295" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>
We propose a novel unsupervised domain adaptation method capable of adapting an object detector from clear weather to real-world adverse weather conditions with a significant domain gap. This gap can be divided into two distinct factors: the <span id="S1.F1.5.1" class="ltx_text ltx_font_italic" style="color:#E83F3F;">Style Gap</span> and the <span id="S1.F1.6.2" class="ltx_text ltx_font_italic" style="color:#0091FF;">Weather Gap</span>. The <span id="S1.F1.7.3" class="ltx_text ltx_font_italic" style="color:#E83F3F;">Style Gap</span> stems from environmental changes such as the image’s background or color, whereas the <span id="S1.F1.8.4" class="ltx_text ltx_font_italic" style="color:#0091FF;">Weather Gap</span> is caused by weather corruptions like rain stains, which introduce random and localized image degradation. Due to the distinct characteristics of the two gaps, we employ separate modules to address each of them independently.
</figcaption>
</figure>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">Recent studies have focused on Unsupervised Domain Adaptation (UDA) to enhance the robustness of object detectors in adverse weather conditions <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>, <a href="#bib.bib11" title="" class="ltx_ref">11</a>, <a href="#bib.bib12" title="" class="ltx_ref">12</a>, <a href="#bib.bib13" title="" class="ltx_ref">13</a>, <a href="#bib.bib14" title="" class="ltx_ref">14</a>, <a href="#bib.bib15" title="" class="ltx_ref">15</a>, <a href="#bib.bib16" title="" class="ltx_ref">16</a>, <a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite>. These methods adapt the model trained in the source domain of clear weather to the target domain of adverse weather by considering adverse weather as a factor contributing to the domain gap <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>, <a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite>. Without requiring the ground truth labels of target domain images, most UDA methods align the feature distributions of the two domains globally in an adversarial manner <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>, <a href="#bib.bib11" title="" class="ltx_ref">11</a>, <a href="#bib.bib12" title="" class="ltx_ref">12</a>, <a href="#bib.bib13" title="" class="ltx_ref">13</a>, <a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite>.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">While most UDA methods regard the domain gap between clear and adverse weather data similarly to conventional domain adaptation settings, the gap can be broken down into two distinct factors: the <span id="S1.p4.1.1" class="ltx_text ltx_font_italic">style gap</span> and the <span id="S1.p4.1.2" class="ltx_text ltx_font_italic">weather gap</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite>. Style gaps are caused by variations in the operating environment (e.g., background, color, texture), whereas weather gaps result from weather-induced corruption (e.g., rain stains, snowflakes).
Unlike style gaps, which are caused by global and semantic factors, weather corruption produces arbitrary and localized image degradation that is hard to characterize using prior knowledge <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>.
Existing UDA methods consider weather corruption as part of the image’s style and align the source and target distributions globally. As some features are arbitrarily and severely distorted by weather corruption, these methods frequently lead to suboptimal alignment under adverse weather conditions. Consequently, they are only effective on synthetic datasets with minor domain gaps <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite>, whereas their performance degrades when applied to real-world datasets with a large style gap and complex weather corruption <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite>. Separately addressing the two aspects of the domain gap improves domain alignment and enables robust object detection in real-world adverse weather conditions.</p>
</div>
<div id="S1.p5" class="ltx_para">
<p id="S1.p5.1" class="ltx_p">In this paper, we propose an unsupervised domain adaptation method to enhance the robustness of object detection in real-world adverse weather conditions. Specifically, we resolve the style and weather gaps separately to achieve optimal feature alignment. To bridge the style gap, our method aligns high-level style-related features using an attention module. Moreover, self-supervised contrastive learning is employed to resolve the weather gap. Based on the assumption that each instance consists of an object and random weather corruption, our model encourages the similarity between instance features within the same class, resulting in a robust representation against corruption. To demonstrate the efficacy of our method in a variety of real-world scenarios, we collect actual driving data in a wide range of environments and weather conditions. Through extensive experiments, we demonstrate that our method effectively adapts to various real-world datasets.</p>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">II </span><span id="S2.1.1" class="ltx_text ltx_font_smallcaps">RELATED WORKS</span>
</h2>

<section id="S2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S2.SS1.5.1.1" class="ltx_text">II-A</span> </span><span id="S2.SS1.6.2" class="ltx_text ltx_font_italic">Object Detection in Adverse Weather Condition</span>
</h3>

<div id="S2.SS1.p1" class="ltx_para">
<p id="S2.SS1.p1.1" class="ltx_p">For the reliable perception of environments, numerous methods attempt to train robust object detectors under adverse weather <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>, <a href="#bib.bib22" title="" class="ltx_ref">22</a>, <a href="#bib.bib23" title="" class="ltx_ref">23</a>, <a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite>.
The most intuitive approach is to utilize annotated datasets of adverse weather conditions <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>, <a href="#bib.bib25" title="" class="ltx_ref">25</a>, <a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite>. Due to the difficulty of acquiring labeled data for real-world adverse weather, synthetic weather effects are generated on labeled clear images using prior knowledge of image formulation under adverse weather condition <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>, <a href="#bib.bib3" title="" class="ltx_ref">3</a>, <a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite>. The object detector is then trained in a supervised manner using this synthetic dataset. Other methods train removal networks to restore clear images from adverse weather images using paired data of clear and synthetic weather images with the same background <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>, <a href="#bib.bib27" title="" class="ltx_ref">27</a>, <a href="#bib.bib28" title="" class="ltx_ref">28</a>]</cite>, or using unpaired data <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib29" title="" class="ltx_ref">29</a>, <a href="#bib.bib30" title="" class="ltx_ref">30</a>, <a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite>. To acquire more realistic synthetic data, some methods jointly train a synthetic data generation model and its removal network <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>, <a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite>.</p>
</div>
<div id="S2.SS1.p2" class="ltx_para">
<p id="S2.SS1.p2.1" class="ltx_p">In real-world environments, however, the efficacy of methods that utilize synthetic data decreases due to the complexity and diversity of real-world weather corruptions <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>. In addition, removal networks are computationally intensive to be attached to the front of the detection network, and they are trained independently to downstream tasks, which provides insufficient performance improvement for these tasks on real-world images <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>, <a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>. While some methods have attempted to jointly train the removal network and downstream tasks <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib31" title="" class="ltx_ref">31</a>, <a href="#bib.bib32" title="" class="ltx_ref">32</a>, <a href="#bib.bib33" title="" class="ltx_ref">33</a>, <a href="#bib.bib34" title="" class="ltx_ref">34</a>]</cite>, they still rely on synthetic data or impose a computational burden.</p>
</div>
</section>
<section id="S2.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S2.SS2.5.1.1" class="ltx_text">II-B</span> </span><span id="S2.SS2.6.2" class="ltx_text ltx_font_italic">Unsupervised Domain Adaptation for Object Detection</span>
</h3>

<div id="S2.SS2.p1" class="ltx_para">
<p id="S2.SS2.p1.1" class="ltx_p">Unsupervised domain adaptation can be used to directly adapt a detector trained on the source domain of clear weather to the target domain of adverse weather <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>, <a href="#bib.bib35" title="" class="ltx_ref">35</a>, <a href="#bib.bib15" title="" class="ltx_ref">15</a>, <a href="#bib.bib36" title="" class="ltx_ref">36</a>, <a href="#bib.bib16" title="" class="ltx_ref">16</a>, <a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite>. Most UDA methods jointly train a domain classifier and a detector so that the classifier distinguishes between the source and target features, while the detector is optimized to confuse the classifier and align the feature distributions globally <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib37" title="" class="ltx_ref">37</a>, <a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite>. Alignment can be performed on image-level features from various backbones, such as ResNet <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite> or Feature Pyramid Network (FPN) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite>. In addition, aligning instance-level features extracted from Region-of-Interest (RoI) can improve domain alignment <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>, <a href="#bib.bib38" title="" class="ltx_ref">38</a>, <a href="#bib.bib39" title="" class="ltx_ref">39</a>]</cite>.
Diverging from conventional UDA approaches, some methods employ mathematical formulations of adverse weather conditions to enhance the alignments of features <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>, <a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite>. However, these methods consider the weather corruption as a part of an image’s style and do not distinguish between the style and the weather gap <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib40" title="" class="ltx_ref">40</a>, <a href="#bib.bib41" title="" class="ltx_ref">41</a>]</cite>, despite their distinct characteristics. This oversight results in suboptimal adaptation performance in real adverse weather conditions with both significant style and weather gaps <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite>.</p>
</div>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">III </span><span id="S3.1.1" class="ltx_text ltx_font_smallcaps">METHODS</span>
</h2>

<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S3.SS1.5.1.1" class="ltx_text">III-A</span> </span><span id="S3.SS1.6.2" class="ltx_text ltx_font_italic">Preliminaries</span>
</h3>

<figure id="S3.F2" class="ltx_figure"><img src="/html/2309.08152/assets/x2.png" id="S3.F2.1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="171" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>Overall pipeline of the proposed method. Faster-RCNN with an FPN backbone is adopted for a detection network. <span id="S3.F2.4.1" class="ltx_text ltx_font_italic" style="color:#E83F3F;">Image-level style alignment</span> reduces the style gap by aligning the FPN’s high-level features. During alignment, they focus on style-related features by incorporating CBAM and highlighting important spatial and channel details. <span id="S3.F2.5.2" class="ltx_text ltx_font_italic" style="color:#0091FF;">Instance-level weather alignment</span> uses instance embedding and its corresponding pseudo-label from RCN to establish a soft assignment for each feature to learnable class prototypes. Using multi-prototype-based contrastive learning, it resolves the weather gap and constructs a weather-resistant feature representation by increasing the similarity between an instance embedding and its assigned prototypes.
</figcaption>
</figure>
<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.2" class="ltx_p">Given labeled images of clear weather conditions from the source domain <math id="S3.SS1.p1.1.m1.1" class="ltx_Math" alttext="\mathcal{S}" display="inline"><semantics id="S3.SS1.p1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml">𝒮</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><ci id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">𝒮</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">\mathcal{S}</annotation></semantics></math> and unlabeled images of adverse weather conditions from the target domain <math id="S3.SS1.p1.2.m2.1" class="ltx_Math" alttext="\mathcal{T}" display="inline"><semantics id="S3.SS1.p1.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.2.m2.1.1" xref="S3.SS1.p1.2.m2.1.1.cmml">𝒯</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.1b"><ci id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1">𝒯</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.1c">\mathcal{T}</annotation></semantics></math>, each minibatch consists of the same number of source and target data. Note that the source and target data are distinct in terms of both weather conditions and the surrounding environment.</p>
</div>
<div id="S3.SS1.p2" class="ltx_para">
<p id="S3.SS1.p2.2" class="ltx_p">We utilize the Faster R-CNN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib42" title="" class="ltx_ref">42</a>]</cite> pipeline with an FPN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib43" title="" class="ltx_ref">43</a>]</cite> backbone during training. The FPN backbone employs pyramid architecture to generate multi-scale feature maps <math id="S3.SS1.p2.1.m1.4" class="ltx_Math" alttext="(P_{2},P_{3},P_{4},P_{5})" display="inline"><semantics id="S3.SS1.p2.1.m1.4a"><mrow id="S3.SS1.p2.1.m1.4.4.4" xref="S3.SS1.p2.1.m1.4.4.5.cmml"><mo stretchy="false" id="S3.SS1.p2.1.m1.4.4.4.5" xref="S3.SS1.p2.1.m1.4.4.5.cmml">(</mo><msub id="S3.SS1.p2.1.m1.1.1.1.1" xref="S3.SS1.p2.1.m1.1.1.1.1.cmml"><mi id="S3.SS1.p2.1.m1.1.1.1.1.2" xref="S3.SS1.p2.1.m1.1.1.1.1.2.cmml">P</mi><mn id="S3.SS1.p2.1.m1.1.1.1.1.3" xref="S3.SS1.p2.1.m1.1.1.1.1.3.cmml">2</mn></msub><mo id="S3.SS1.p2.1.m1.4.4.4.6" xref="S3.SS1.p2.1.m1.4.4.5.cmml">,</mo><msub id="S3.SS1.p2.1.m1.2.2.2.2" xref="S3.SS1.p2.1.m1.2.2.2.2.cmml"><mi id="S3.SS1.p2.1.m1.2.2.2.2.2" xref="S3.SS1.p2.1.m1.2.2.2.2.2.cmml">P</mi><mn id="S3.SS1.p2.1.m1.2.2.2.2.3" xref="S3.SS1.p2.1.m1.2.2.2.2.3.cmml">3</mn></msub><mo id="S3.SS1.p2.1.m1.4.4.4.7" xref="S3.SS1.p2.1.m1.4.4.5.cmml">,</mo><msub id="S3.SS1.p2.1.m1.3.3.3.3" xref="S3.SS1.p2.1.m1.3.3.3.3.cmml"><mi id="S3.SS1.p2.1.m1.3.3.3.3.2" xref="S3.SS1.p2.1.m1.3.3.3.3.2.cmml">P</mi><mn id="S3.SS1.p2.1.m1.3.3.3.3.3" xref="S3.SS1.p2.1.m1.3.3.3.3.3.cmml">4</mn></msub><mo id="S3.SS1.p2.1.m1.4.4.4.8" xref="S3.SS1.p2.1.m1.4.4.5.cmml">,</mo><msub id="S3.SS1.p2.1.m1.4.4.4.4" xref="S3.SS1.p2.1.m1.4.4.4.4.cmml"><mi id="S3.SS1.p2.1.m1.4.4.4.4.2" xref="S3.SS1.p2.1.m1.4.4.4.4.2.cmml">P</mi><mn id="S3.SS1.p2.1.m1.4.4.4.4.3" xref="S3.SS1.p2.1.m1.4.4.4.4.3.cmml">5</mn></msub><mo stretchy="false" id="S3.SS1.p2.1.m1.4.4.4.9" xref="S3.SS1.p2.1.m1.4.4.5.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.4b"><vector id="S3.SS1.p2.1.m1.4.4.5.cmml" xref="S3.SS1.p2.1.m1.4.4.4"><apply id="S3.SS1.p2.1.m1.1.1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.1.m1.1.1.1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p2.1.m1.1.1.1.1.2.cmml" xref="S3.SS1.p2.1.m1.1.1.1.1.2">𝑃</ci><cn type="integer" id="S3.SS1.p2.1.m1.1.1.1.1.3.cmml" xref="S3.SS1.p2.1.m1.1.1.1.1.3">2</cn></apply><apply id="S3.SS1.p2.1.m1.2.2.2.2.cmml" xref="S3.SS1.p2.1.m1.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p2.1.m1.2.2.2.2.1.cmml" xref="S3.SS1.p2.1.m1.2.2.2.2">subscript</csymbol><ci id="S3.SS1.p2.1.m1.2.2.2.2.2.cmml" xref="S3.SS1.p2.1.m1.2.2.2.2.2">𝑃</ci><cn type="integer" id="S3.SS1.p2.1.m1.2.2.2.2.3.cmml" xref="S3.SS1.p2.1.m1.2.2.2.2.3">3</cn></apply><apply id="S3.SS1.p2.1.m1.3.3.3.3.cmml" xref="S3.SS1.p2.1.m1.3.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p2.1.m1.3.3.3.3.1.cmml" xref="S3.SS1.p2.1.m1.3.3.3.3">subscript</csymbol><ci id="S3.SS1.p2.1.m1.3.3.3.3.2.cmml" xref="S3.SS1.p2.1.m1.3.3.3.3.2">𝑃</ci><cn type="integer" id="S3.SS1.p2.1.m1.3.3.3.3.3.cmml" xref="S3.SS1.p2.1.m1.3.3.3.3.3">4</cn></apply><apply id="S3.SS1.p2.1.m1.4.4.4.4.cmml" xref="S3.SS1.p2.1.m1.4.4.4.4"><csymbol cd="ambiguous" id="S3.SS1.p2.1.m1.4.4.4.4.1.cmml" xref="S3.SS1.p2.1.m1.4.4.4.4">subscript</csymbol><ci id="S3.SS1.p2.1.m1.4.4.4.4.2.cmml" xref="S3.SS1.p2.1.m1.4.4.4.4.2">𝑃</ci><cn type="integer" id="S3.SS1.p2.1.m1.4.4.4.4.3.cmml" xref="S3.SS1.p2.1.m1.4.4.4.4.3">5</cn></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.4c">(P_{2},P_{3},P_{4},P_{5})</annotation></semantics></math> from an image, allowing the efficient detection of objects of varying scales. The Region Proposal Network (RPN) proposes RoI on these features and extracts instance features from each RoI, following the Region Classification Network (RCN) which makes final class and bounding box predictions. The supervised loss <math id="S3.SS1.p2.2.m2.1" class="ltx_Math" alttext="\mathcal{L}_{\text{sup}}" display="inline"><semantics id="S3.SS1.p2.2.m2.1a"><msub id="S3.SS1.p2.2.m2.1.1" xref="S3.SS1.p2.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.2.m2.1.1.2" xref="S3.SS1.p2.2.m2.1.1.2.cmml">ℒ</mi><mtext id="S3.SS1.p2.2.m2.1.1.3" xref="S3.SS1.p2.2.m2.1.1.3a.cmml">sup</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.2.m2.1b"><apply id="S3.SS1.p2.2.m2.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.2.m2.1.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1">subscript</csymbol><ci id="S3.SS1.p2.2.m2.1.1.2.cmml" xref="S3.SS1.p2.2.m2.1.1.2">ℒ</ci><ci id="S3.SS1.p2.2.m2.1.1.3a.cmml" xref="S3.SS1.p2.2.m2.1.1.3"><mtext mathsize="70%" id="S3.SS1.p2.2.m2.1.1.3.cmml" xref="S3.SS1.p2.2.m2.1.1.3">sup</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.2.m2.1c">\mathcal{L}_{\text{sup}}</annotation></semantics></math> obtained from RPN and RCN is applied only to the source data.</p>
</div>
<div id="S3.SS1.p3" class="ltx_para">
<p id="S3.SS1.p3.1" class="ltx_p">The overall architecture of our method is depicted in Fig <a href="#S3.F2" title="Figure 2 ‣ III-A Preliminaries ‣ III METHODS ‣ DA-RAW: Domain Adaptive Object Detection for Real-World Adverse Weather Conditions" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>. We aim to train a robust object detector that performs well in real-world environments with adverse weather. Based on the architecture of the FPN-based Faster RCNN framework, we propose two components for domain adaptation to handle both style and weather gaps. First, an image-level style alignment is used to reduce the style gap through adversarial training. An instance-level weather alignment is then utilized to reduce the weather gap and learn the corruption-invariant features. The entire model is trained simultaneously in an end-to-end manner.</p>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S3.SS2.5.1.1" class="ltx_text">III-B</span> </span><span id="S3.SS2.6.2" class="ltx_text ltx_font_italic">Image-level Style Alignment</span>
</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.1" class="ltx_p">The distinct styles of the source and target domains’ environments result in different feature distributions. This style gap between domains is resolved through the alignment of image-level features. Similar to <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite>, a domain classifier is attached to each layer of the FPN backbone to distinguish between domains. The backbone is then trained to generate the domain-invariant feature by confusing the domain classifier through adversarial training. These objectives are accomplished in a single backpropagation step by a Gradient Reversal Layer (GRL) with a weight coefficient <math id="S3.SS2.p1.1.m1.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="S3.SS2.p1.1.m1.1a"><mi id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><ci id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">\lambda</annotation></semantics></math>.</p>
</div>
<div id="S3.SS2.p2" class="ltx_para">
<p id="S3.SS2.p2.3" class="ltx_p">We intend to perform image-level feature adaptation by focusing solely on the style properties of images. However, some features are severely degraded due to weather corruption, making it difficult to concentrate on the style differences. To enable the network to emphasize style-related features during alignment, the Convolutional Block Attention Module (CBAM) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib44" title="" class="ltx_ref">44</a>]</cite> is employed to emphasize features essential for domain alignment. CBAM is attached to each feature map and applies channel and spatial attention modules to acquire refined features <math id="S3.SS2.p2.1.m1.1" class="ltx_Math" alttext="\mathbf{x}^{p}" display="inline"><semantics id="S3.SS2.p2.1.m1.1a"><msup id="S3.SS2.p2.1.m1.1.1" xref="S3.SS2.p2.1.m1.1.1.cmml"><mi id="S3.SS2.p2.1.m1.1.1.2" xref="S3.SS2.p2.1.m1.1.1.2.cmml">𝐱</mi><mi id="S3.SS2.p2.1.m1.1.1.3" xref="S3.SS2.p2.1.m1.1.1.3.cmml">p</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.1.m1.1b"><apply id="S3.SS2.p2.1.m1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.1.m1.1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1">superscript</csymbol><ci id="S3.SS2.p2.1.m1.1.1.2.cmml" xref="S3.SS2.p2.1.m1.1.1.2">𝐱</ci><ci id="S3.SS2.p2.1.m1.1.1.3.cmml" xref="S3.SS2.p2.1.m1.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.1.m1.1c">\mathbf{x}^{p}</annotation></semantics></math> at feature level <math id="S3.SS2.p2.2.m2.1" class="ltx_Math" alttext="p" display="inline"><semantics id="S3.SS2.p2.2.m2.1a"><mi id="S3.SS2.p2.2.m2.1.1" xref="S3.SS2.p2.2.m2.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.2.m2.1b"><ci id="S3.SS2.p2.2.m2.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.2.m2.1c">p</annotation></semantics></math>. The attended feature is then fed into the discriminator <math id="S3.SS2.p2.3.m3.1" class="ltx_Math" alttext="\mathcal{D}_{p}" display="inline"><semantics id="S3.SS2.p2.3.m3.1a"><msub id="S3.SS2.p2.3.m3.1.1" xref="S3.SS2.p2.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p2.3.m3.1.1.2" xref="S3.SS2.p2.3.m3.1.1.2.cmml">𝒟</mi><mi id="S3.SS2.p2.3.m3.1.1.3" xref="S3.SS2.p2.3.m3.1.1.3.cmml">p</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.3.m3.1b"><apply id="S3.SS2.p2.3.m3.1.1.cmml" xref="S3.SS2.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.3.m3.1.1.1.cmml" xref="S3.SS2.p2.3.m3.1.1">subscript</csymbol><ci id="S3.SS2.p2.3.m3.1.1.2.cmml" xref="S3.SS2.p2.3.m3.1.1.2">𝒟</ci><ci id="S3.SS2.p2.3.m3.1.1.3.cmml" xref="S3.SS2.p2.3.m3.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.3.m3.1c">\mathcal{D}_{p}</annotation></semantics></math> that predicts the domain of a feature, leading it to align features through the GRL by concentrating on essential information.</p>
</div>
<div id="S3.SS2.p3" class="ltx_para">
<p id="S3.SS2.p3.3" class="ltx_p">Since low-level features with fine-grained details are more susceptible to weather corruption, only high-level features are used for alignment. Therefore, image-level style alignment is performed on the <math id="S3.SS2.p3.1.m1.1" class="ltx_Math" alttext="P_{4}" display="inline"><semantics id="S3.SS2.p3.1.m1.1a"><msub id="S3.SS2.p3.1.m1.1.1" xref="S3.SS2.p3.1.m1.1.1.cmml"><mi id="S3.SS2.p3.1.m1.1.1.2" xref="S3.SS2.p3.1.m1.1.1.2.cmml">P</mi><mn id="S3.SS2.p3.1.m1.1.1.3" xref="S3.SS2.p3.1.m1.1.1.3.cmml">4</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.1.m1.1b"><apply id="S3.SS2.p3.1.m1.1.1.cmml" xref="S3.SS2.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.1.m1.1.1.1.cmml" xref="S3.SS2.p3.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.p3.1.m1.1.1.2.cmml" xref="S3.SS2.p3.1.m1.1.1.2">𝑃</ci><cn type="integer" id="S3.SS2.p3.1.m1.1.1.3.cmml" xref="S3.SS2.p3.1.m1.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.1.m1.1c">P_{4}</annotation></semantics></math> and <math id="S3.SS2.p3.2.m2.1" class="ltx_Math" alttext="P_{5}" display="inline"><semantics id="S3.SS2.p3.2.m2.1a"><msub id="S3.SS2.p3.2.m2.1.1" xref="S3.SS2.p3.2.m2.1.1.cmml"><mi id="S3.SS2.p3.2.m2.1.1.2" xref="S3.SS2.p3.2.m2.1.1.2.cmml">P</mi><mn id="S3.SS2.p3.2.m2.1.1.3" xref="S3.SS2.p3.2.m2.1.1.3.cmml">5</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.2.m2.1b"><apply id="S3.SS2.p3.2.m2.1.1.cmml" xref="S3.SS2.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.2.m2.1.1.1.cmml" xref="S3.SS2.p3.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.p3.2.m2.1.1.2.cmml" xref="S3.SS2.p3.2.m2.1.1.2">𝑃</ci><cn type="integer" id="S3.SS2.p3.2.m2.1.1.3.cmml" xref="S3.SS2.p3.2.m2.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.2.m2.1c">P_{5}</annotation></semantics></math> layers of the FPN backbone. The loss for image-level alignment, <math id="S3.SS2.p3.3.m3.1" class="ltx_Math" alttext="\mathcal{L}_{\text{img}}" display="inline"><semantics id="S3.SS2.p3.3.m3.1a"><msub id="S3.SS2.p3.3.m3.1.1" xref="S3.SS2.p3.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p3.3.m3.1.1.2" xref="S3.SS2.p3.3.m3.1.1.2.cmml">ℒ</mi><mtext id="S3.SS2.p3.3.m3.1.1.3" xref="S3.SS2.p3.3.m3.1.1.3a.cmml">img</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.3.m3.1b"><apply id="S3.SS2.p3.3.m3.1.1.cmml" xref="S3.SS2.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.3.m3.1.1.1.cmml" xref="S3.SS2.p3.3.m3.1.1">subscript</csymbol><ci id="S3.SS2.p3.3.m3.1.1.2.cmml" xref="S3.SS2.p3.3.m3.1.1.2">ℒ</ci><ci id="S3.SS2.p3.3.m3.1.1.3a.cmml" xref="S3.SS2.p3.3.m3.1.1.3"><mtext mathsize="70%" id="S3.SS2.p3.3.m3.1.1.3.cmml" xref="S3.SS2.p3.3.m3.1.1.3">img</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.3.m3.1c">\mathcal{L}_{\text{img}}</annotation></semantics></math>, is given by the following equation:</p>
<table id="S3.E1" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="S3.E1X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E1X.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle\mathcal{L}_{\text{img}}=-\sum_{p}\sum_{\mathbf{x}_{i}^{p}}" display="inline"><semantics id="S3.E1X.2.1.1.m1.1a"><mrow id="S3.E1X.2.1.1.m1.1.1" xref="S3.E1X.2.1.1.m1.1.1.cmml"><msub id="S3.E1X.2.1.1.m1.1.1.2" xref="S3.E1X.2.1.1.m1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E1X.2.1.1.m1.1.1.2.2" xref="S3.E1X.2.1.1.m1.1.1.2.2.cmml">ℒ</mi><mtext id="S3.E1X.2.1.1.m1.1.1.2.3" xref="S3.E1X.2.1.1.m1.1.1.2.3a.cmml">img</mtext></msub><mo id="S3.E1X.2.1.1.m1.1.1.1" xref="S3.E1X.2.1.1.m1.1.1.1.cmml">=</mo><mrow id="S3.E1X.2.1.1.m1.1.1.3" xref="S3.E1X.2.1.1.m1.1.1.3.cmml"><mo id="S3.E1X.2.1.1.m1.1.1.3a" xref="S3.E1X.2.1.1.m1.1.1.3.cmml">−</mo><mrow id="S3.E1X.2.1.1.m1.1.1.3.2" xref="S3.E1X.2.1.1.m1.1.1.3.2.cmml"><mstyle displaystyle="true" id="S3.E1X.2.1.1.m1.1.1.3.2.1" xref="S3.E1X.2.1.1.m1.1.1.3.2.1.cmml"><munder id="S3.E1X.2.1.1.m1.1.1.3.2.1a" xref="S3.E1X.2.1.1.m1.1.1.3.2.1.cmml"><mo movablelimits="false" id="S3.E1X.2.1.1.m1.1.1.3.2.1.2" xref="S3.E1X.2.1.1.m1.1.1.3.2.1.2.cmml">∑</mo><mi id="S3.E1X.2.1.1.m1.1.1.3.2.1.3" xref="S3.E1X.2.1.1.m1.1.1.3.2.1.3.cmml">p</mi></munder></mstyle><mstyle displaystyle="true" id="S3.E1X.2.1.1.m1.1.1.3.2.2" xref="S3.E1X.2.1.1.m1.1.1.3.2.2.cmml"><munder id="S3.E1X.2.1.1.m1.1.1.3.2.2a" xref="S3.E1X.2.1.1.m1.1.1.3.2.2.cmml"><mo movablelimits="false" id="S3.E1X.2.1.1.m1.1.1.3.2.2.2" xref="S3.E1X.2.1.1.m1.1.1.3.2.2.2.cmml">∑</mo><msubsup id="S3.E1X.2.1.1.m1.1.1.3.2.2.3" xref="S3.E1X.2.1.1.m1.1.1.3.2.2.3.cmml"><mi id="S3.E1X.2.1.1.m1.1.1.3.2.2.3.2.2" xref="S3.E1X.2.1.1.m1.1.1.3.2.2.3.2.2.cmml">𝐱</mi><mi id="S3.E1X.2.1.1.m1.1.1.3.2.2.3.2.3" xref="S3.E1X.2.1.1.m1.1.1.3.2.2.3.2.3.cmml">i</mi><mi id="S3.E1X.2.1.1.m1.1.1.3.2.2.3.3" xref="S3.E1X.2.1.1.m1.1.1.3.2.2.3.3.cmml">p</mi></msubsup></munder></mstyle></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E1X.2.1.1.m1.1b"><apply id="S3.E1X.2.1.1.m1.1.1.cmml" xref="S3.E1X.2.1.1.m1.1.1"><eq id="S3.E1X.2.1.1.m1.1.1.1.cmml" xref="S3.E1X.2.1.1.m1.1.1.1"></eq><apply id="S3.E1X.2.1.1.m1.1.1.2.cmml" xref="S3.E1X.2.1.1.m1.1.1.2"><csymbol cd="ambiguous" id="S3.E1X.2.1.1.m1.1.1.2.1.cmml" xref="S3.E1X.2.1.1.m1.1.1.2">subscript</csymbol><ci id="S3.E1X.2.1.1.m1.1.1.2.2.cmml" xref="S3.E1X.2.1.1.m1.1.1.2.2">ℒ</ci><ci id="S3.E1X.2.1.1.m1.1.1.2.3a.cmml" xref="S3.E1X.2.1.1.m1.1.1.2.3"><mtext mathsize="70%" id="S3.E1X.2.1.1.m1.1.1.2.3.cmml" xref="S3.E1X.2.1.1.m1.1.1.2.3">img</mtext></ci></apply><apply id="S3.E1X.2.1.1.m1.1.1.3.cmml" xref="S3.E1X.2.1.1.m1.1.1.3"><minus id="S3.E1X.2.1.1.m1.1.1.3.1.cmml" xref="S3.E1X.2.1.1.m1.1.1.3"></minus><apply id="S3.E1X.2.1.1.m1.1.1.3.2.cmml" xref="S3.E1X.2.1.1.m1.1.1.3.2"><apply id="S3.E1X.2.1.1.m1.1.1.3.2.1.cmml" xref="S3.E1X.2.1.1.m1.1.1.3.2.1"><csymbol cd="ambiguous" id="S3.E1X.2.1.1.m1.1.1.3.2.1.1.cmml" xref="S3.E1X.2.1.1.m1.1.1.3.2.1">subscript</csymbol><sum id="S3.E1X.2.1.1.m1.1.1.3.2.1.2.cmml" xref="S3.E1X.2.1.1.m1.1.1.3.2.1.2"></sum><ci id="S3.E1X.2.1.1.m1.1.1.3.2.1.3.cmml" xref="S3.E1X.2.1.1.m1.1.1.3.2.1.3">𝑝</ci></apply><apply id="S3.E1X.2.1.1.m1.1.1.3.2.2.cmml" xref="S3.E1X.2.1.1.m1.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.E1X.2.1.1.m1.1.1.3.2.2.1.cmml" xref="S3.E1X.2.1.1.m1.1.1.3.2.2">subscript</csymbol><sum id="S3.E1X.2.1.1.m1.1.1.3.2.2.2.cmml" xref="S3.E1X.2.1.1.m1.1.1.3.2.2.2"></sum><apply id="S3.E1X.2.1.1.m1.1.1.3.2.2.3.cmml" xref="S3.E1X.2.1.1.m1.1.1.3.2.2.3"><csymbol cd="ambiguous" id="S3.E1X.2.1.1.m1.1.1.3.2.2.3.1.cmml" xref="S3.E1X.2.1.1.m1.1.1.3.2.2.3">superscript</csymbol><apply id="S3.E1X.2.1.1.m1.1.1.3.2.2.3.2.cmml" xref="S3.E1X.2.1.1.m1.1.1.3.2.2.3"><csymbol cd="ambiguous" id="S3.E1X.2.1.1.m1.1.1.3.2.2.3.2.1.cmml" xref="S3.E1X.2.1.1.m1.1.1.3.2.2.3">subscript</csymbol><ci id="S3.E1X.2.1.1.m1.1.1.3.2.2.3.2.2.cmml" xref="S3.E1X.2.1.1.m1.1.1.3.2.2.3.2.2">𝐱</ci><ci id="S3.E1X.2.1.1.m1.1.1.3.2.2.3.2.3.cmml" xref="S3.E1X.2.1.1.m1.1.1.3.2.2.3.2.3">𝑖</ci></apply><ci id="S3.E1X.2.1.1.m1.1.1.3.2.2.3.3.cmml" xref="S3.E1X.2.1.1.m1.1.1.3.2.2.3.3">𝑝</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1X.2.1.1.m1.1c">\displaystyle\mathcal{L}_{\text{img}}=-\sum_{p}\sum_{\mathbf{x}_{i}^{p}}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E1X.3.2.2.m1.1" class="ltx_math_unparsed" alttext="\displaystyle\left[y_{i}\log\mathcal{D}_{p}\left(\mathbf{x}_{i}^{p}\right)\right." display="inline"><semantics id="S3.E1X.3.2.2.m1.1a"><mrow id="S3.E1X.3.2.2.m1.1b"><mo id="S3.E1X.3.2.2.m1.1.1">[</mo><msub id="S3.E1X.3.2.2.m1.1.2"><mi id="S3.E1X.3.2.2.m1.1.2.2">y</mi><mi id="S3.E1X.3.2.2.m1.1.2.3">i</mi></msub><mi id="S3.E1X.3.2.2.m1.1.3">log</mi><msub id="S3.E1X.3.2.2.m1.1.4"><mi class="ltx_font_mathcaligraphic" id="S3.E1X.3.2.2.m1.1.4.2">𝒟</mi><mi id="S3.E1X.3.2.2.m1.1.4.3">p</mi></msub><mrow id="S3.E1X.3.2.2.m1.1.5"><mo id="S3.E1X.3.2.2.m1.1.5.1">(</mo><msubsup id="S3.E1X.3.2.2.m1.1.5.2"><mi id="S3.E1X.3.2.2.m1.1.5.2.2.2">𝐱</mi><mi id="S3.E1X.3.2.2.m1.1.5.2.2.3">i</mi><mi id="S3.E1X.3.2.2.m1.1.5.2.3">p</mi></msubsup><mo id="S3.E1X.3.2.2.m1.1.5.3">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="S3.E1X.3.2.2.m1.1c">\displaystyle\left[y_{i}\log\mathcal{D}_{p}\left(\mathbf{x}_{i}^{p}\right)\right.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="2" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(1)</span></td>
</tr>
<tr id="S3.E1Xa" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E1Xa.2.1.1.m1.1" class="ltx_math_unparsed" alttext="\displaystyle\left.+\left(1-y_{i}\right)\log\left(1-\mathcal{D}_{p}\left(\mathbf{x}_{i}^{p}\right)\right)\right]," display="inline"><semantics id="S3.E1Xa.2.1.1.m1.1a"><mrow id="S3.E1Xa.2.1.1.m1.1b"><mo id="S3.E1Xa.2.1.1.m1.1.2">+</mo><mrow id="S3.E1Xa.2.1.1.m1.1.3"><mo id="S3.E1Xa.2.1.1.m1.1.3.1">(</mo><mn id="S3.E1Xa.2.1.1.m1.1.3.2">1</mn><mo id="S3.E1Xa.2.1.1.m1.1.3.3">−</mo><msub id="S3.E1Xa.2.1.1.m1.1.3.4"><mi id="S3.E1Xa.2.1.1.m1.1.3.4.2">y</mi><mi id="S3.E1Xa.2.1.1.m1.1.3.4.3">i</mi></msub><mo rspace="0.167em" id="S3.E1Xa.2.1.1.m1.1.3.5">)</mo></mrow><mi id="S3.E1Xa.2.1.1.m1.1.1">log</mi><mrow id="S3.E1Xa.2.1.1.m1.1.4"><mo id="S3.E1Xa.2.1.1.m1.1.4.1">(</mo><mn id="S3.E1Xa.2.1.1.m1.1.4.2">1</mn><mo id="S3.E1Xa.2.1.1.m1.1.4.3">−</mo><msub id="S3.E1Xa.2.1.1.m1.1.4.4"><mi class="ltx_font_mathcaligraphic" id="S3.E1Xa.2.1.1.m1.1.4.4.2">𝒟</mi><mi id="S3.E1Xa.2.1.1.m1.1.4.4.3">p</mi></msub><mrow id="S3.E1Xa.2.1.1.m1.1.4.5"><mo id="S3.E1Xa.2.1.1.m1.1.4.5.1">(</mo><msubsup id="S3.E1Xa.2.1.1.m1.1.4.5.2"><mi id="S3.E1Xa.2.1.1.m1.1.4.5.2.2.2">𝐱</mi><mi id="S3.E1Xa.2.1.1.m1.1.4.5.2.2.3">i</mi><mi id="S3.E1Xa.2.1.1.m1.1.4.5.2.3">p</mi></msubsup><mo id="S3.E1Xa.2.1.1.m1.1.4.5.3">)</mo></mrow><mo id="S3.E1Xa.2.1.1.m1.1.4.6">)</mo></mrow><mo id="S3.E1Xa.2.1.1.m1.1.5">]</mo><mo id="S3.E1Xa.2.1.1.m1.1.6">,</mo></mrow><annotation encoding="application/x-tex" id="S3.E1Xa.2.1.1.m1.1c">\displaystyle\left.+\left(1-y_{i}\right)\log\left(1-\mathcal{D}_{p}\left(\mathbf{x}_{i}^{p}\right)\right)\right],</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
<p id="S3.SS2.p3.9" class="ltx_p">where <math id="S3.SS2.p3.4.m1.2" class="ltx_Math" alttext="p\in\{P_{4},P_{5}\}" display="inline"><semantics id="S3.SS2.p3.4.m1.2a"><mrow id="S3.SS2.p3.4.m1.2.2" xref="S3.SS2.p3.4.m1.2.2.cmml"><mi id="S3.SS2.p3.4.m1.2.2.4" xref="S3.SS2.p3.4.m1.2.2.4.cmml">p</mi><mo id="S3.SS2.p3.4.m1.2.2.3" xref="S3.SS2.p3.4.m1.2.2.3.cmml">∈</mo><mrow id="S3.SS2.p3.4.m1.2.2.2.2" xref="S3.SS2.p3.4.m1.2.2.2.3.cmml"><mo stretchy="false" id="S3.SS2.p3.4.m1.2.2.2.2.3" xref="S3.SS2.p3.4.m1.2.2.2.3.cmml">{</mo><msub id="S3.SS2.p3.4.m1.1.1.1.1.1" xref="S3.SS2.p3.4.m1.1.1.1.1.1.cmml"><mi id="S3.SS2.p3.4.m1.1.1.1.1.1.2" xref="S3.SS2.p3.4.m1.1.1.1.1.1.2.cmml">P</mi><mn id="S3.SS2.p3.4.m1.1.1.1.1.1.3" xref="S3.SS2.p3.4.m1.1.1.1.1.1.3.cmml">4</mn></msub><mo id="S3.SS2.p3.4.m1.2.2.2.2.4" xref="S3.SS2.p3.4.m1.2.2.2.3.cmml">,</mo><msub id="S3.SS2.p3.4.m1.2.2.2.2.2" xref="S3.SS2.p3.4.m1.2.2.2.2.2.cmml"><mi id="S3.SS2.p3.4.m1.2.2.2.2.2.2" xref="S3.SS2.p3.4.m1.2.2.2.2.2.2.cmml">P</mi><mn id="S3.SS2.p3.4.m1.2.2.2.2.2.3" xref="S3.SS2.p3.4.m1.2.2.2.2.2.3.cmml">5</mn></msub><mo stretchy="false" id="S3.SS2.p3.4.m1.2.2.2.2.5" xref="S3.SS2.p3.4.m1.2.2.2.3.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.4.m1.2b"><apply id="S3.SS2.p3.4.m1.2.2.cmml" xref="S3.SS2.p3.4.m1.2.2"><in id="S3.SS2.p3.4.m1.2.2.3.cmml" xref="S3.SS2.p3.4.m1.2.2.3"></in><ci id="S3.SS2.p3.4.m1.2.2.4.cmml" xref="S3.SS2.p3.4.m1.2.2.4">𝑝</ci><set id="S3.SS2.p3.4.m1.2.2.2.3.cmml" xref="S3.SS2.p3.4.m1.2.2.2.2"><apply id="S3.SS2.p3.4.m1.1.1.1.1.1.cmml" xref="S3.SS2.p3.4.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.4.m1.1.1.1.1.1.1.cmml" xref="S3.SS2.p3.4.m1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.p3.4.m1.1.1.1.1.1.2.cmml" xref="S3.SS2.p3.4.m1.1.1.1.1.1.2">𝑃</ci><cn type="integer" id="S3.SS2.p3.4.m1.1.1.1.1.1.3.cmml" xref="S3.SS2.p3.4.m1.1.1.1.1.1.3">4</cn></apply><apply id="S3.SS2.p3.4.m1.2.2.2.2.2.cmml" xref="S3.SS2.p3.4.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p3.4.m1.2.2.2.2.2.1.cmml" xref="S3.SS2.p3.4.m1.2.2.2.2.2">subscript</csymbol><ci id="S3.SS2.p3.4.m1.2.2.2.2.2.2.cmml" xref="S3.SS2.p3.4.m1.2.2.2.2.2.2">𝑃</ci><cn type="integer" id="S3.SS2.p3.4.m1.2.2.2.2.2.3.cmml" xref="S3.SS2.p3.4.m1.2.2.2.2.2.3">5</cn></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.4.m1.2c">p\in\{P_{4},P_{5}\}</annotation></semantics></math> represents feature level, <math id="S3.SS2.p3.5.m2.1" class="ltx_Math" alttext="\mathbf{x}_{i}^{p}" display="inline"><semantics id="S3.SS2.p3.5.m2.1a"><msubsup id="S3.SS2.p3.5.m2.1.1" xref="S3.SS2.p3.5.m2.1.1.cmml"><mi id="S3.SS2.p3.5.m2.1.1.2.2" xref="S3.SS2.p3.5.m2.1.1.2.2.cmml">𝐱</mi><mi id="S3.SS2.p3.5.m2.1.1.2.3" xref="S3.SS2.p3.5.m2.1.1.2.3.cmml">i</mi><mi id="S3.SS2.p3.5.m2.1.1.3" xref="S3.SS2.p3.5.m2.1.1.3.cmml">p</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.5.m2.1b"><apply id="S3.SS2.p3.5.m2.1.1.cmml" xref="S3.SS2.p3.5.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.5.m2.1.1.1.cmml" xref="S3.SS2.p3.5.m2.1.1">superscript</csymbol><apply id="S3.SS2.p3.5.m2.1.1.2.cmml" xref="S3.SS2.p3.5.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.5.m2.1.1.2.1.cmml" xref="S3.SS2.p3.5.m2.1.1">subscript</csymbol><ci id="S3.SS2.p3.5.m2.1.1.2.2.cmml" xref="S3.SS2.p3.5.m2.1.1.2.2">𝐱</ci><ci id="S3.SS2.p3.5.m2.1.1.2.3.cmml" xref="S3.SS2.p3.5.m2.1.1.2.3">𝑖</ci></apply><ci id="S3.SS2.p3.5.m2.1.1.3.cmml" xref="S3.SS2.p3.5.m2.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.5.m2.1c">\mathbf{x}_{i}^{p}</annotation></semantics></math> represents each feature of level <math id="S3.SS2.p3.6.m3.1" class="ltx_Math" alttext="p" display="inline"><semantics id="S3.SS2.p3.6.m3.1a"><mi id="S3.SS2.p3.6.m3.1.1" xref="S3.SS2.p3.6.m3.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.6.m3.1b"><ci id="S3.SS2.p3.6.m3.1.1.cmml" xref="S3.SS2.p3.6.m3.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.6.m3.1c">p</annotation></semantics></math> at location <math id="S3.SS2.p3.7.m4.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS2.p3.7.m4.1a"><mi id="S3.SS2.p3.7.m4.1.1" xref="S3.SS2.p3.7.m4.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.7.m4.1b"><ci id="S3.SS2.p3.7.m4.1.1.cmml" xref="S3.SS2.p3.7.m4.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.7.m4.1c">i</annotation></semantics></math> after CBAM layers, and <math id="S3.SS2.p3.8.m5.2" class="ltx_Math" alttext="y_{i}\in\{0,1\}" display="inline"><semantics id="S3.SS2.p3.8.m5.2a"><mrow id="S3.SS2.p3.8.m5.2.3" xref="S3.SS2.p3.8.m5.2.3.cmml"><msub id="S3.SS2.p3.8.m5.2.3.2" xref="S3.SS2.p3.8.m5.2.3.2.cmml"><mi id="S3.SS2.p3.8.m5.2.3.2.2" xref="S3.SS2.p3.8.m5.2.3.2.2.cmml">y</mi><mi id="S3.SS2.p3.8.m5.2.3.2.3" xref="S3.SS2.p3.8.m5.2.3.2.3.cmml">i</mi></msub><mo id="S3.SS2.p3.8.m5.2.3.1" xref="S3.SS2.p3.8.m5.2.3.1.cmml">∈</mo><mrow id="S3.SS2.p3.8.m5.2.3.3.2" xref="S3.SS2.p3.8.m5.2.3.3.1.cmml"><mo stretchy="false" id="S3.SS2.p3.8.m5.2.3.3.2.1" xref="S3.SS2.p3.8.m5.2.3.3.1.cmml">{</mo><mn id="S3.SS2.p3.8.m5.1.1" xref="S3.SS2.p3.8.m5.1.1.cmml">0</mn><mo id="S3.SS2.p3.8.m5.2.3.3.2.2" xref="S3.SS2.p3.8.m5.2.3.3.1.cmml">,</mo><mn id="S3.SS2.p3.8.m5.2.2" xref="S3.SS2.p3.8.m5.2.2.cmml">1</mn><mo stretchy="false" id="S3.SS2.p3.8.m5.2.3.3.2.3" xref="S3.SS2.p3.8.m5.2.3.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.8.m5.2b"><apply id="S3.SS2.p3.8.m5.2.3.cmml" xref="S3.SS2.p3.8.m5.2.3"><in id="S3.SS2.p3.8.m5.2.3.1.cmml" xref="S3.SS2.p3.8.m5.2.3.1"></in><apply id="S3.SS2.p3.8.m5.2.3.2.cmml" xref="S3.SS2.p3.8.m5.2.3.2"><csymbol cd="ambiguous" id="S3.SS2.p3.8.m5.2.3.2.1.cmml" xref="S3.SS2.p3.8.m5.2.3.2">subscript</csymbol><ci id="S3.SS2.p3.8.m5.2.3.2.2.cmml" xref="S3.SS2.p3.8.m5.2.3.2.2">𝑦</ci><ci id="S3.SS2.p3.8.m5.2.3.2.3.cmml" xref="S3.SS2.p3.8.m5.2.3.2.3">𝑖</ci></apply><set id="S3.SS2.p3.8.m5.2.3.3.1.cmml" xref="S3.SS2.p3.8.m5.2.3.3.2"><cn type="integer" id="S3.SS2.p3.8.m5.1.1.cmml" xref="S3.SS2.p3.8.m5.1.1">0</cn><cn type="integer" id="S3.SS2.p3.8.m5.2.2.cmml" xref="S3.SS2.p3.8.m5.2.2">1</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.8.m5.2c">y_{i}\in\{0,1\}</annotation></semantics></math> indicates the domain label of each feature at location <math id="S3.SS2.p3.9.m6.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS2.p3.9.m6.1a"><mi id="S3.SS2.p3.9.m6.1.1" xref="S3.SS2.p3.9.m6.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.9.m6.1b"><ci id="S3.SS2.p3.9.m6.1.1.cmml" xref="S3.SS2.p3.9.m6.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.9.m6.1c">i</annotation></semantics></math>.</p>
</div>
</section>
<section id="S3.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S3.SS3.5.1.1" class="ltx_text">III-C</span> </span><span id="S3.SS3.6.2" class="ltx_text ltx_font_italic">Instance-level Weather Alignment</span>
</h3>

<div id="S3.SS3.p1" class="ltx_para">
<p id="S3.SS3.p1.1" class="ltx_p">The weather corruption has a local effect on the image and substantially degrades the instance features that are essential for object detection. We aim to obtain corruption-invariant features and reduce the weather gap through prototype-based contrastive learning. In particular, we assume that an instance feature of the target domain image is composed of an object and an arbitrary pattern of weather corruption. Then, the similarity between instance features of object proposals within the same category is encouraged, resulting in instance features invariant to weather corruption.</p>
</div>
<div id="S3.SS3.p2" class="ltx_para">
<p id="S3.SS3.p2.5" class="ltx_p">From the source and target domain training images, instance features are obtained, and each of them is pseudo-labeled as class <math id="S3.SS3.p2.1.m1.1" class="ltx_Math" alttext="\hat{c_{i}}" display="inline"><semantics id="S3.SS3.p2.1.m1.1a"><mover accent="true" id="S3.SS3.p2.1.m1.1.1" xref="S3.SS3.p2.1.m1.1.1.cmml"><msub id="S3.SS3.p2.1.m1.1.1.2" xref="S3.SS3.p2.1.m1.1.1.2.cmml"><mi id="S3.SS3.p2.1.m1.1.1.2.2" xref="S3.SS3.p2.1.m1.1.1.2.2.cmml">c</mi><mi id="S3.SS3.p2.1.m1.1.1.2.3" xref="S3.SS3.p2.1.m1.1.1.2.3.cmml">i</mi></msub><mo id="S3.SS3.p2.1.m1.1.1.1" xref="S3.SS3.p2.1.m1.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.1.m1.1b"><apply id="S3.SS3.p2.1.m1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1"><ci id="S3.SS3.p2.1.m1.1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1.1">^</ci><apply id="S3.SS3.p2.1.m1.1.1.2.cmml" xref="S3.SS3.p2.1.m1.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p2.1.m1.1.1.2.1.cmml" xref="S3.SS3.p2.1.m1.1.1.2">subscript</csymbol><ci id="S3.SS3.p2.1.m1.1.1.2.2.cmml" xref="S3.SS3.p2.1.m1.1.1.2.2">𝑐</ci><ci id="S3.SS3.p2.1.m1.1.1.2.3.cmml" xref="S3.SS3.p2.1.m1.1.1.2.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.1.m1.1c">\hat{c_{i}}</annotation></semantics></math> using the classwise score of each instance provided by the RCN. To be utilized for contrastive learning, instance features are forwarded to an MLP head to generate instance embeddings <math id="S3.SS3.p2.2.m2.1" class="ltx_Math" alttext="\mathbf{Z}=\{\mathbf{z}_{i}\}_{i=1}^{N}" display="inline"><semantics id="S3.SS3.p2.2.m2.1a"><mrow id="S3.SS3.p2.2.m2.1.1" xref="S3.SS3.p2.2.m2.1.1.cmml"><mi id="S3.SS3.p2.2.m2.1.1.3" xref="S3.SS3.p2.2.m2.1.1.3.cmml">𝐙</mi><mo id="S3.SS3.p2.2.m2.1.1.2" xref="S3.SS3.p2.2.m2.1.1.2.cmml">=</mo><msubsup id="S3.SS3.p2.2.m2.1.1.1" xref="S3.SS3.p2.2.m2.1.1.1.cmml"><mrow id="S3.SS3.p2.2.m2.1.1.1.1.1.1" xref="S3.SS3.p2.2.m2.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.SS3.p2.2.m2.1.1.1.1.1.1.2" xref="S3.SS3.p2.2.m2.1.1.1.1.1.2.cmml">{</mo><msub id="S3.SS3.p2.2.m2.1.1.1.1.1.1.1" xref="S3.SS3.p2.2.m2.1.1.1.1.1.1.1.cmml"><mi id="S3.SS3.p2.2.m2.1.1.1.1.1.1.1.2" xref="S3.SS3.p2.2.m2.1.1.1.1.1.1.1.2.cmml">𝐳</mi><mi id="S3.SS3.p2.2.m2.1.1.1.1.1.1.1.3" xref="S3.SS3.p2.2.m2.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.SS3.p2.2.m2.1.1.1.1.1.1.3" xref="S3.SS3.p2.2.m2.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S3.SS3.p2.2.m2.1.1.1.1.3" xref="S3.SS3.p2.2.m2.1.1.1.1.3.cmml"><mi id="S3.SS3.p2.2.m2.1.1.1.1.3.2" xref="S3.SS3.p2.2.m2.1.1.1.1.3.2.cmml">i</mi><mo id="S3.SS3.p2.2.m2.1.1.1.1.3.1" xref="S3.SS3.p2.2.m2.1.1.1.1.3.1.cmml">=</mo><mn id="S3.SS3.p2.2.m2.1.1.1.1.3.3" xref="S3.SS3.p2.2.m2.1.1.1.1.3.3.cmml">1</mn></mrow><mi id="S3.SS3.p2.2.m2.1.1.1.3" xref="S3.SS3.p2.2.m2.1.1.1.3.cmml">N</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.2.m2.1b"><apply id="S3.SS3.p2.2.m2.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1"><eq id="S3.SS3.p2.2.m2.1.1.2.cmml" xref="S3.SS3.p2.2.m2.1.1.2"></eq><ci id="S3.SS3.p2.2.m2.1.1.3.cmml" xref="S3.SS3.p2.2.m2.1.1.3">𝐙</ci><apply id="S3.SS3.p2.2.m2.1.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.2.m2.1.1.1.2.cmml" xref="S3.SS3.p2.2.m2.1.1.1">superscript</csymbol><apply id="S3.SS3.p2.2.m2.1.1.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.2.m2.1.1.1.1.2.cmml" xref="S3.SS3.p2.2.m2.1.1.1">subscript</csymbol><set id="S3.SS3.p2.2.m2.1.1.1.1.1.2.cmml" xref="S3.SS3.p2.2.m2.1.1.1.1.1.1"><apply id="S3.SS3.p2.2.m2.1.1.1.1.1.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.2.m2.1.1.1.1.1.1.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS3.p2.2.m2.1.1.1.1.1.1.1.2.cmml" xref="S3.SS3.p2.2.m2.1.1.1.1.1.1.1.2">𝐳</ci><ci id="S3.SS3.p2.2.m2.1.1.1.1.1.1.1.3.cmml" xref="S3.SS3.p2.2.m2.1.1.1.1.1.1.1.3">𝑖</ci></apply></set><apply id="S3.SS3.p2.2.m2.1.1.1.1.3.cmml" xref="S3.SS3.p2.2.m2.1.1.1.1.3"><eq id="S3.SS3.p2.2.m2.1.1.1.1.3.1.cmml" xref="S3.SS3.p2.2.m2.1.1.1.1.3.1"></eq><ci id="S3.SS3.p2.2.m2.1.1.1.1.3.2.cmml" xref="S3.SS3.p2.2.m2.1.1.1.1.3.2">𝑖</ci><cn type="integer" id="S3.SS3.p2.2.m2.1.1.1.1.3.3.cmml" xref="S3.SS3.p2.2.m2.1.1.1.1.3.3">1</cn></apply></apply><ci id="S3.SS3.p2.2.m2.1.1.1.3.cmml" xref="S3.SS3.p2.2.m2.1.1.1.3">𝑁</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.2.m2.1c">\mathbf{Z}=\{\mathbf{z}_{i}\}_{i=1}^{N}</annotation></semantics></math> with dimension <math id="S3.SS3.p2.3.m3.1" class="ltx_Math" alttext="D" display="inline"><semantics id="S3.SS3.p2.3.m3.1a"><mi id="S3.SS3.p2.3.m3.1.1" xref="S3.SS3.p2.3.m3.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.3.m3.1b"><ci id="S3.SS3.p2.3.m3.1.1.cmml" xref="S3.SS3.p2.3.m3.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.3.m3.1c">D</annotation></semantics></math>, where <math id="S3.SS3.p2.4.m4.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S3.SS3.p2.4.m4.1a"><mi id="S3.SS3.p2.4.m4.1.1" xref="S3.SS3.p2.4.m4.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.4.m4.1b"><ci id="S3.SS3.p2.4.m4.1.1.cmml" xref="S3.SS3.p2.4.m4.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.4.m4.1c">N</annotation></semantics></math> is the total number of instances. Note that MLPs exist independently for each level of features without sharing weights, and only instance features with scores over a threshold <math id="S3.SS3.p2.5.m5.1" class="ltx_Math" alttext="\delta" display="inline"><semantics id="S3.SS3.p2.5.m5.1a"><mi id="S3.SS3.p2.5.m5.1.1" xref="S3.SS3.p2.5.m5.1.1.cmml">δ</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.5.m5.1b"><ci id="S3.SS3.p2.5.m5.1.1.cmml" xref="S3.SS3.p2.5.m5.1.1">𝛿</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.5.m5.1c">\delta</annotation></semantics></math> from the low-level image feature are utilized to align fine-grained features.</p>
</div>
<div id="S3.SS3.p3" class="ltx_para">
<p id="S3.SS3.p3.6" class="ltx_p">To maximize the similarity between instance embeddings with the same pseudo-labels, prototype-anchored metric learning is used to design the contrastive loss <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib45" title="" class="ltx_ref">45</a>]</cite>. Using learnable prototypes as representatives of each class, each instance embedding is assigned to prototypes, and a network is learned to increase their similarity. <math id="S3.SS3.p3.1.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S3.SS3.p3.1.m1.1a"><mi id="S3.SS3.p3.1.m1.1.1" xref="S3.SS3.p3.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.1.m1.1b"><ci id="S3.SS3.p3.1.m1.1.1.cmml" xref="S3.SS3.p3.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.1.m1.1c">K</annotation></semantics></math> learnable prototypes are used for each class <math id="S3.SS3.p3.2.m2.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S3.SS3.p3.2.m2.1a"><mi id="S3.SS3.p3.2.m2.1.1" xref="S3.SS3.p3.2.m2.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.2.m2.1b"><ci id="S3.SS3.p3.2.m2.1.1.cmml" xref="S3.SS3.p3.2.m2.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.2.m2.1c">c</annotation></semantics></math> as <math id="S3.SS3.p3.3.m3.1" class="ltx_Math" alttext="\mathbf{P}_{c}\in\mathbb{R}^{D\times K}" display="inline"><semantics id="S3.SS3.p3.3.m3.1a"><mrow id="S3.SS3.p3.3.m3.1.1" xref="S3.SS3.p3.3.m3.1.1.cmml"><msub id="S3.SS3.p3.3.m3.1.1.2" xref="S3.SS3.p3.3.m3.1.1.2.cmml"><mi id="S3.SS3.p3.3.m3.1.1.2.2" xref="S3.SS3.p3.3.m3.1.1.2.2.cmml">𝐏</mi><mi id="S3.SS3.p3.3.m3.1.1.2.3" xref="S3.SS3.p3.3.m3.1.1.2.3.cmml">c</mi></msub><mo id="S3.SS3.p3.3.m3.1.1.1" xref="S3.SS3.p3.3.m3.1.1.1.cmml">∈</mo><msup id="S3.SS3.p3.3.m3.1.1.3" xref="S3.SS3.p3.3.m3.1.1.3.cmml"><mi id="S3.SS3.p3.3.m3.1.1.3.2" xref="S3.SS3.p3.3.m3.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS3.p3.3.m3.1.1.3.3" xref="S3.SS3.p3.3.m3.1.1.3.3.cmml"><mi id="S3.SS3.p3.3.m3.1.1.3.3.2" xref="S3.SS3.p3.3.m3.1.1.3.3.2.cmml">D</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS3.p3.3.m3.1.1.3.3.1" xref="S3.SS3.p3.3.m3.1.1.3.3.1.cmml">×</mo><mi id="S3.SS3.p3.3.m3.1.1.3.3.3" xref="S3.SS3.p3.3.m3.1.1.3.3.3.cmml">K</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.3.m3.1b"><apply id="S3.SS3.p3.3.m3.1.1.cmml" xref="S3.SS3.p3.3.m3.1.1"><in id="S3.SS3.p3.3.m3.1.1.1.cmml" xref="S3.SS3.p3.3.m3.1.1.1"></in><apply id="S3.SS3.p3.3.m3.1.1.2.cmml" xref="S3.SS3.p3.3.m3.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p3.3.m3.1.1.2.1.cmml" xref="S3.SS3.p3.3.m3.1.1.2">subscript</csymbol><ci id="S3.SS3.p3.3.m3.1.1.2.2.cmml" xref="S3.SS3.p3.3.m3.1.1.2.2">𝐏</ci><ci id="S3.SS3.p3.3.m3.1.1.2.3.cmml" xref="S3.SS3.p3.3.m3.1.1.2.3">𝑐</ci></apply><apply id="S3.SS3.p3.3.m3.1.1.3.cmml" xref="S3.SS3.p3.3.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p3.3.m3.1.1.3.1.cmml" xref="S3.SS3.p3.3.m3.1.1.3">superscript</csymbol><ci id="S3.SS3.p3.3.m3.1.1.3.2.cmml" xref="S3.SS3.p3.3.m3.1.1.3.2">ℝ</ci><apply id="S3.SS3.p3.3.m3.1.1.3.3.cmml" xref="S3.SS3.p3.3.m3.1.1.3.3"><times id="S3.SS3.p3.3.m3.1.1.3.3.1.cmml" xref="S3.SS3.p3.3.m3.1.1.3.3.1"></times><ci id="S3.SS3.p3.3.m3.1.1.3.3.2.cmml" xref="S3.SS3.p3.3.m3.1.1.3.3.2">𝐷</ci><ci id="S3.SS3.p3.3.m3.1.1.3.3.3.cmml" xref="S3.SS3.p3.3.m3.1.1.3.3.3">𝐾</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.3.m3.1c">\mathbf{P}_{c}\in\mathbb{R}^{D\times K}</annotation></semantics></math> to account for the intra-class variation of instance features, and each prototype <math id="S3.SS3.p3.4.m4.2" class="ltx_Math" alttext="\mathbf{p}_{c,k}\in\mathbb{R}^{D}" display="inline"><semantics id="S3.SS3.p3.4.m4.2a"><mrow id="S3.SS3.p3.4.m4.2.3" xref="S3.SS3.p3.4.m4.2.3.cmml"><msub id="S3.SS3.p3.4.m4.2.3.2" xref="S3.SS3.p3.4.m4.2.3.2.cmml"><mi id="S3.SS3.p3.4.m4.2.3.2.2" xref="S3.SS3.p3.4.m4.2.3.2.2.cmml">𝐩</mi><mrow id="S3.SS3.p3.4.m4.2.2.2.4" xref="S3.SS3.p3.4.m4.2.2.2.3.cmml"><mi id="S3.SS3.p3.4.m4.1.1.1.1" xref="S3.SS3.p3.4.m4.1.1.1.1.cmml">c</mi><mo id="S3.SS3.p3.4.m4.2.2.2.4.1" xref="S3.SS3.p3.4.m4.2.2.2.3.cmml">,</mo><mi id="S3.SS3.p3.4.m4.2.2.2.2" xref="S3.SS3.p3.4.m4.2.2.2.2.cmml">k</mi></mrow></msub><mo id="S3.SS3.p3.4.m4.2.3.1" xref="S3.SS3.p3.4.m4.2.3.1.cmml">∈</mo><msup id="S3.SS3.p3.4.m4.2.3.3" xref="S3.SS3.p3.4.m4.2.3.3.cmml"><mi id="S3.SS3.p3.4.m4.2.3.3.2" xref="S3.SS3.p3.4.m4.2.3.3.2.cmml">ℝ</mi><mi id="S3.SS3.p3.4.m4.2.3.3.3" xref="S3.SS3.p3.4.m4.2.3.3.3.cmml">D</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.4.m4.2b"><apply id="S3.SS3.p3.4.m4.2.3.cmml" xref="S3.SS3.p3.4.m4.2.3"><in id="S3.SS3.p3.4.m4.2.3.1.cmml" xref="S3.SS3.p3.4.m4.2.3.1"></in><apply id="S3.SS3.p3.4.m4.2.3.2.cmml" xref="S3.SS3.p3.4.m4.2.3.2"><csymbol cd="ambiguous" id="S3.SS3.p3.4.m4.2.3.2.1.cmml" xref="S3.SS3.p3.4.m4.2.3.2">subscript</csymbol><ci id="S3.SS3.p3.4.m4.2.3.2.2.cmml" xref="S3.SS3.p3.4.m4.2.3.2.2">𝐩</ci><list id="S3.SS3.p3.4.m4.2.2.2.3.cmml" xref="S3.SS3.p3.4.m4.2.2.2.4"><ci id="S3.SS3.p3.4.m4.1.1.1.1.cmml" xref="S3.SS3.p3.4.m4.1.1.1.1">𝑐</ci><ci id="S3.SS3.p3.4.m4.2.2.2.2.cmml" xref="S3.SS3.p3.4.m4.2.2.2.2">𝑘</ci></list></apply><apply id="S3.SS3.p3.4.m4.2.3.3.cmml" xref="S3.SS3.p3.4.m4.2.3.3"><csymbol cd="ambiguous" id="S3.SS3.p3.4.m4.2.3.3.1.cmml" xref="S3.SS3.p3.4.m4.2.3.3">superscript</csymbol><ci id="S3.SS3.p3.4.m4.2.3.3.2.cmml" xref="S3.SS3.p3.4.m4.2.3.3.2">ℝ</ci><ci id="S3.SS3.p3.4.m4.2.3.3.3.cmml" xref="S3.SS3.p3.4.m4.2.3.3.3">𝐷</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.4.m4.2c">\mathbf{p}_{c,k}\in\mathbb{R}^{D}</annotation></semantics></math> serves as the <math id="S3.SS3.p3.5.m5.1" class="ltx_Math" alttext="k^{th}" display="inline"><semantics id="S3.SS3.p3.5.m5.1a"><msup id="S3.SS3.p3.5.m5.1.1" xref="S3.SS3.p3.5.m5.1.1.cmml"><mi id="S3.SS3.p3.5.m5.1.1.2" xref="S3.SS3.p3.5.m5.1.1.2.cmml">k</mi><mrow id="S3.SS3.p3.5.m5.1.1.3" xref="S3.SS3.p3.5.m5.1.1.3.cmml"><mi id="S3.SS3.p3.5.m5.1.1.3.2" xref="S3.SS3.p3.5.m5.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p3.5.m5.1.1.3.1" xref="S3.SS3.p3.5.m5.1.1.3.1.cmml">​</mo><mi id="S3.SS3.p3.5.m5.1.1.3.3" xref="S3.SS3.p3.5.m5.1.1.3.3.cmml">h</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.5.m5.1b"><apply id="S3.SS3.p3.5.m5.1.1.cmml" xref="S3.SS3.p3.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.5.m5.1.1.1.cmml" xref="S3.SS3.p3.5.m5.1.1">superscript</csymbol><ci id="S3.SS3.p3.5.m5.1.1.2.cmml" xref="S3.SS3.p3.5.m5.1.1.2">𝑘</ci><apply id="S3.SS3.p3.5.m5.1.1.3.cmml" xref="S3.SS3.p3.5.m5.1.1.3"><times id="S3.SS3.p3.5.m5.1.1.3.1.cmml" xref="S3.SS3.p3.5.m5.1.1.3.1"></times><ci id="S3.SS3.p3.5.m5.1.1.3.2.cmml" xref="S3.SS3.p3.5.m5.1.1.3.2">𝑡</ci><ci id="S3.SS3.p3.5.m5.1.1.3.3.cmml" xref="S3.SS3.p3.5.m5.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.5.m5.1c">k^{th}</annotation></semantics></math> cluster center of a class <math id="S3.SS3.p3.6.m6.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S3.SS3.p3.6.m6.1a"><mi id="S3.SS3.p3.6.m6.1.1" xref="S3.SS3.p3.6.m6.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.6.m6.1b"><ci id="S3.SS3.p3.6.m6.1.1.cmml" xref="S3.SS3.p3.6.m6.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.6.m6.1c">c</annotation></semantics></math>. Also, to further boost the performance of contrastive learning, instance embeddings with the background class also adopt the same number of learnable prototypes, which can be used as negative samples for other instances.</p>
</div>
<div id="S3.SS3.p4" class="ltx_para">
<p id="S3.SS3.p4.12" class="ltx_p">Each instance with a pseudo-label <math id="S3.SS3.p4.1.m1.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S3.SS3.p4.1.m1.1a"><mi id="S3.SS3.p4.1.m1.1.1" xref="S3.SS3.p4.1.m1.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.1.m1.1b"><ci id="S3.SS3.p4.1.m1.1.1.cmml" xref="S3.SS3.p4.1.m1.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.1.m1.1c">c</annotation></semantics></math> is assigned to prototypes of the same class by computing the soft assignment matrix for class <math id="S3.SS3.p4.2.m2.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S3.SS3.p4.2.m2.1a"><mi id="S3.SS3.p4.2.m2.1.1" xref="S3.SS3.p4.2.m2.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.2.m2.1b"><ci id="S3.SS3.p4.2.m2.1.1.cmml" xref="S3.SS3.p4.2.m2.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.2.m2.1c">c</annotation></semantics></math>, <math id="S3.SS3.p4.3.m3.1" class="ltx_Math" alttext="\mathbf{L}_{c}\in\mathbb{R}_{+}^{K\times n_{c}}" display="inline"><semantics id="S3.SS3.p4.3.m3.1a"><mrow id="S3.SS3.p4.3.m3.1.1" xref="S3.SS3.p4.3.m3.1.1.cmml"><msub id="S3.SS3.p4.3.m3.1.1.2" xref="S3.SS3.p4.3.m3.1.1.2.cmml"><mi id="S3.SS3.p4.3.m3.1.1.2.2" xref="S3.SS3.p4.3.m3.1.1.2.2.cmml">𝐋</mi><mi id="S3.SS3.p4.3.m3.1.1.2.3" xref="S3.SS3.p4.3.m3.1.1.2.3.cmml">c</mi></msub><mo id="S3.SS3.p4.3.m3.1.1.1" xref="S3.SS3.p4.3.m3.1.1.1.cmml">∈</mo><msubsup id="S3.SS3.p4.3.m3.1.1.3" xref="S3.SS3.p4.3.m3.1.1.3.cmml"><mi id="S3.SS3.p4.3.m3.1.1.3.2.2" xref="S3.SS3.p4.3.m3.1.1.3.2.2.cmml">ℝ</mi><mo id="S3.SS3.p4.3.m3.1.1.3.2.3" xref="S3.SS3.p4.3.m3.1.1.3.2.3.cmml">+</mo><mrow id="S3.SS3.p4.3.m3.1.1.3.3" xref="S3.SS3.p4.3.m3.1.1.3.3.cmml"><mi id="S3.SS3.p4.3.m3.1.1.3.3.2" xref="S3.SS3.p4.3.m3.1.1.3.3.2.cmml">K</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS3.p4.3.m3.1.1.3.3.1" xref="S3.SS3.p4.3.m3.1.1.3.3.1.cmml">×</mo><msub id="S3.SS3.p4.3.m3.1.1.3.3.3" xref="S3.SS3.p4.3.m3.1.1.3.3.3.cmml"><mi id="S3.SS3.p4.3.m3.1.1.3.3.3.2" xref="S3.SS3.p4.3.m3.1.1.3.3.3.2.cmml">n</mi><mi id="S3.SS3.p4.3.m3.1.1.3.3.3.3" xref="S3.SS3.p4.3.m3.1.1.3.3.3.3.cmml">c</mi></msub></mrow></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.3.m3.1b"><apply id="S3.SS3.p4.3.m3.1.1.cmml" xref="S3.SS3.p4.3.m3.1.1"><in id="S3.SS3.p4.3.m3.1.1.1.cmml" xref="S3.SS3.p4.3.m3.1.1.1"></in><apply id="S3.SS3.p4.3.m3.1.1.2.cmml" xref="S3.SS3.p4.3.m3.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p4.3.m3.1.1.2.1.cmml" xref="S3.SS3.p4.3.m3.1.1.2">subscript</csymbol><ci id="S3.SS3.p4.3.m3.1.1.2.2.cmml" xref="S3.SS3.p4.3.m3.1.1.2.2">𝐋</ci><ci id="S3.SS3.p4.3.m3.1.1.2.3.cmml" xref="S3.SS3.p4.3.m3.1.1.2.3">𝑐</ci></apply><apply id="S3.SS3.p4.3.m3.1.1.3.cmml" xref="S3.SS3.p4.3.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p4.3.m3.1.1.3.1.cmml" xref="S3.SS3.p4.3.m3.1.1.3">superscript</csymbol><apply id="S3.SS3.p4.3.m3.1.1.3.2.cmml" xref="S3.SS3.p4.3.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p4.3.m3.1.1.3.2.1.cmml" xref="S3.SS3.p4.3.m3.1.1.3">subscript</csymbol><ci id="S3.SS3.p4.3.m3.1.1.3.2.2.cmml" xref="S3.SS3.p4.3.m3.1.1.3.2.2">ℝ</ci><plus id="S3.SS3.p4.3.m3.1.1.3.2.3.cmml" xref="S3.SS3.p4.3.m3.1.1.3.2.3"></plus></apply><apply id="S3.SS3.p4.3.m3.1.1.3.3.cmml" xref="S3.SS3.p4.3.m3.1.1.3.3"><times id="S3.SS3.p4.3.m3.1.1.3.3.1.cmml" xref="S3.SS3.p4.3.m3.1.1.3.3.1"></times><ci id="S3.SS3.p4.3.m3.1.1.3.3.2.cmml" xref="S3.SS3.p4.3.m3.1.1.3.3.2">𝐾</ci><apply id="S3.SS3.p4.3.m3.1.1.3.3.3.cmml" xref="S3.SS3.p4.3.m3.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.p4.3.m3.1.1.3.3.3.1.cmml" xref="S3.SS3.p4.3.m3.1.1.3.3.3">subscript</csymbol><ci id="S3.SS3.p4.3.m3.1.1.3.3.3.2.cmml" xref="S3.SS3.p4.3.m3.1.1.3.3.3.2">𝑛</ci><ci id="S3.SS3.p4.3.m3.1.1.3.3.3.3.cmml" xref="S3.SS3.p4.3.m3.1.1.3.3.3.3">𝑐</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.3.m3.1c">\mathbf{L}_{c}\in\mathbb{R}_{+}^{K\times n_{c}}</annotation></semantics></math>. The soft assignment matrix satisfies the condition that the sum of soft assignment probabilities for each instance is one, <span id="S3.SS3.p4.12.1" class="ltx_text ltx_font_italic">i.e.</span>, <math id="S3.SS3.p4.4.m4.1" class="ltx_Math" alttext="\mathbf{L}_{c}^{\top}\cdot\mathbf{1}^{K}=\mathbf{1}^{n_{c}}" display="inline"><semantics id="S3.SS3.p4.4.m4.1a"><mrow id="S3.SS3.p4.4.m4.1.1" xref="S3.SS3.p4.4.m4.1.1.cmml"><mrow id="S3.SS3.p4.4.m4.1.1.2" xref="S3.SS3.p4.4.m4.1.1.2.cmml"><msubsup id="S3.SS3.p4.4.m4.1.1.2.2" xref="S3.SS3.p4.4.m4.1.1.2.2.cmml"><mi id="S3.SS3.p4.4.m4.1.1.2.2.2.2" xref="S3.SS3.p4.4.m4.1.1.2.2.2.2.cmml">𝐋</mi><mi id="S3.SS3.p4.4.m4.1.1.2.2.2.3" xref="S3.SS3.p4.4.m4.1.1.2.2.2.3.cmml">c</mi><mo id="S3.SS3.p4.4.m4.1.1.2.2.3" xref="S3.SS3.p4.4.m4.1.1.2.2.3.cmml">⊤</mo></msubsup><mo lspace="0.222em" rspace="0.222em" id="S3.SS3.p4.4.m4.1.1.2.1" xref="S3.SS3.p4.4.m4.1.1.2.1.cmml">⋅</mo><msup id="S3.SS3.p4.4.m4.1.1.2.3" xref="S3.SS3.p4.4.m4.1.1.2.3.cmml"><mn id="S3.SS3.p4.4.m4.1.1.2.3.2" xref="S3.SS3.p4.4.m4.1.1.2.3.2.cmml">𝟏</mn><mi id="S3.SS3.p4.4.m4.1.1.2.3.3" xref="S3.SS3.p4.4.m4.1.1.2.3.3.cmml">K</mi></msup></mrow><mo id="S3.SS3.p4.4.m4.1.1.1" xref="S3.SS3.p4.4.m4.1.1.1.cmml">=</mo><msup id="S3.SS3.p4.4.m4.1.1.3" xref="S3.SS3.p4.4.m4.1.1.3.cmml"><mn id="S3.SS3.p4.4.m4.1.1.3.2" xref="S3.SS3.p4.4.m4.1.1.3.2.cmml">𝟏</mn><msub id="S3.SS3.p4.4.m4.1.1.3.3" xref="S3.SS3.p4.4.m4.1.1.3.3.cmml"><mi id="S3.SS3.p4.4.m4.1.1.3.3.2" xref="S3.SS3.p4.4.m4.1.1.3.3.2.cmml">n</mi><mi id="S3.SS3.p4.4.m4.1.1.3.3.3" xref="S3.SS3.p4.4.m4.1.1.3.3.3.cmml">c</mi></msub></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.4.m4.1b"><apply id="S3.SS3.p4.4.m4.1.1.cmml" xref="S3.SS3.p4.4.m4.1.1"><eq id="S3.SS3.p4.4.m4.1.1.1.cmml" xref="S3.SS3.p4.4.m4.1.1.1"></eq><apply id="S3.SS3.p4.4.m4.1.1.2.cmml" xref="S3.SS3.p4.4.m4.1.1.2"><ci id="S3.SS3.p4.4.m4.1.1.2.1.cmml" xref="S3.SS3.p4.4.m4.1.1.2.1">⋅</ci><apply id="S3.SS3.p4.4.m4.1.1.2.2.cmml" xref="S3.SS3.p4.4.m4.1.1.2.2"><csymbol cd="ambiguous" id="S3.SS3.p4.4.m4.1.1.2.2.1.cmml" xref="S3.SS3.p4.4.m4.1.1.2.2">superscript</csymbol><apply id="S3.SS3.p4.4.m4.1.1.2.2.2.cmml" xref="S3.SS3.p4.4.m4.1.1.2.2"><csymbol cd="ambiguous" id="S3.SS3.p4.4.m4.1.1.2.2.2.1.cmml" xref="S3.SS3.p4.4.m4.1.1.2.2">subscript</csymbol><ci id="S3.SS3.p4.4.m4.1.1.2.2.2.2.cmml" xref="S3.SS3.p4.4.m4.1.1.2.2.2.2">𝐋</ci><ci id="S3.SS3.p4.4.m4.1.1.2.2.2.3.cmml" xref="S3.SS3.p4.4.m4.1.1.2.2.2.3">𝑐</ci></apply><csymbol cd="latexml" id="S3.SS3.p4.4.m4.1.1.2.2.3.cmml" xref="S3.SS3.p4.4.m4.1.1.2.2.3">top</csymbol></apply><apply id="S3.SS3.p4.4.m4.1.1.2.3.cmml" xref="S3.SS3.p4.4.m4.1.1.2.3"><csymbol cd="ambiguous" id="S3.SS3.p4.4.m4.1.1.2.3.1.cmml" xref="S3.SS3.p4.4.m4.1.1.2.3">superscript</csymbol><cn type="integer" id="S3.SS3.p4.4.m4.1.1.2.3.2.cmml" xref="S3.SS3.p4.4.m4.1.1.2.3.2">1</cn><ci id="S3.SS3.p4.4.m4.1.1.2.3.3.cmml" xref="S3.SS3.p4.4.m4.1.1.2.3.3">𝐾</ci></apply></apply><apply id="S3.SS3.p4.4.m4.1.1.3.cmml" xref="S3.SS3.p4.4.m4.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p4.4.m4.1.1.3.1.cmml" xref="S3.SS3.p4.4.m4.1.1.3">superscript</csymbol><cn type="integer" id="S3.SS3.p4.4.m4.1.1.3.2.cmml" xref="S3.SS3.p4.4.m4.1.1.3.2">1</cn><apply id="S3.SS3.p4.4.m4.1.1.3.3.cmml" xref="S3.SS3.p4.4.m4.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS3.p4.4.m4.1.1.3.3.1.cmml" xref="S3.SS3.p4.4.m4.1.1.3.3">subscript</csymbol><ci id="S3.SS3.p4.4.m4.1.1.3.3.2.cmml" xref="S3.SS3.p4.4.m4.1.1.3.3.2">𝑛</ci><ci id="S3.SS3.p4.4.m4.1.1.3.3.3.cmml" xref="S3.SS3.p4.4.m4.1.1.3.3.3">𝑐</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.4.m4.1c">\mathbf{L}_{c}^{\top}\cdot\mathbf{1}^{K}=\mathbf{1}^{n_{c}}</annotation></semantics></math>, where <math id="S3.SS3.p4.5.m5.1" class="ltx_Math" alttext="\mathbf{1}^{K}" display="inline"><semantics id="S3.SS3.p4.5.m5.1a"><msup id="S3.SS3.p4.5.m5.1.1" xref="S3.SS3.p4.5.m5.1.1.cmml"><mn id="S3.SS3.p4.5.m5.1.1.2" xref="S3.SS3.p4.5.m5.1.1.2.cmml">𝟏</mn><mi id="S3.SS3.p4.5.m5.1.1.3" xref="S3.SS3.p4.5.m5.1.1.3.cmml">K</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.5.m5.1b"><apply id="S3.SS3.p4.5.m5.1.1.cmml" xref="S3.SS3.p4.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS3.p4.5.m5.1.1.1.cmml" xref="S3.SS3.p4.5.m5.1.1">superscript</csymbol><cn type="integer" id="S3.SS3.p4.5.m5.1.1.2.cmml" xref="S3.SS3.p4.5.m5.1.1.2">1</cn><ci id="S3.SS3.p4.5.m5.1.1.3.cmml" xref="S3.SS3.p4.5.m5.1.1.3">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.5.m5.1c">\mathbf{1}^{K}</annotation></semantics></math> and <math id="S3.SS3.p4.6.m6.1" class="ltx_Math" alttext="\mathbf{1}^{n_{c}}" display="inline"><semantics id="S3.SS3.p4.6.m6.1a"><msup id="S3.SS3.p4.6.m6.1.1" xref="S3.SS3.p4.6.m6.1.1.cmml"><mn id="S3.SS3.p4.6.m6.1.1.2" xref="S3.SS3.p4.6.m6.1.1.2.cmml">𝟏</mn><msub id="S3.SS3.p4.6.m6.1.1.3" xref="S3.SS3.p4.6.m6.1.1.3.cmml"><mi id="S3.SS3.p4.6.m6.1.1.3.2" xref="S3.SS3.p4.6.m6.1.1.3.2.cmml">n</mi><mi id="S3.SS3.p4.6.m6.1.1.3.3" xref="S3.SS3.p4.6.m6.1.1.3.3.cmml">c</mi></msub></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.6.m6.1b"><apply id="S3.SS3.p4.6.m6.1.1.cmml" xref="S3.SS3.p4.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS3.p4.6.m6.1.1.1.cmml" xref="S3.SS3.p4.6.m6.1.1">superscript</csymbol><cn type="integer" id="S3.SS3.p4.6.m6.1.1.2.cmml" xref="S3.SS3.p4.6.m6.1.1.2">1</cn><apply id="S3.SS3.p4.6.m6.1.1.3.cmml" xref="S3.SS3.p4.6.m6.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p4.6.m6.1.1.3.1.cmml" xref="S3.SS3.p4.6.m6.1.1.3">subscript</csymbol><ci id="S3.SS3.p4.6.m6.1.1.3.2.cmml" xref="S3.SS3.p4.6.m6.1.1.3.2">𝑛</ci><ci id="S3.SS3.p4.6.m6.1.1.3.3.cmml" xref="S3.SS3.p4.6.m6.1.1.3.3">𝑐</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.6.m6.1c">\mathbf{1}^{n_{c}}</annotation></semantics></math> denotes the vector of all ones with dimensions <math id="S3.SS3.p4.7.m7.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S3.SS3.p4.7.m7.1a"><mi id="S3.SS3.p4.7.m7.1.1" xref="S3.SS3.p4.7.m7.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.7.m7.1b"><ci id="S3.SS3.p4.7.m7.1.1.cmml" xref="S3.SS3.p4.7.m7.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.7.m7.1c">K</annotation></semantics></math> and <math id="S3.SS3.p4.8.m8.1" class="ltx_Math" alttext="n_{c}" display="inline"><semantics id="S3.SS3.p4.8.m8.1a"><msub id="S3.SS3.p4.8.m8.1.1" xref="S3.SS3.p4.8.m8.1.1.cmml"><mi id="S3.SS3.p4.8.m8.1.1.2" xref="S3.SS3.p4.8.m8.1.1.2.cmml">n</mi><mi id="S3.SS3.p4.8.m8.1.1.3" xref="S3.SS3.p4.8.m8.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.8.m8.1b"><apply id="S3.SS3.p4.8.m8.1.1.cmml" xref="S3.SS3.p4.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS3.p4.8.m8.1.1.1.cmml" xref="S3.SS3.p4.8.m8.1.1">subscript</csymbol><ci id="S3.SS3.p4.8.m8.1.1.2.cmml" xref="S3.SS3.p4.8.m8.1.1.2">𝑛</ci><ci id="S3.SS3.p4.8.m8.1.1.3.cmml" xref="S3.SS3.p4.8.m8.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.8.m8.1c">n_{c}</annotation></semantics></math>, respectively. The assignment matrix can be obtained by maximizing the similarity between instance embeddings and the class prototypes, <math id="S3.SS3.p4.9.m9.1" class="ltx_Math" alttext="\mathbf{Q}_{c}=\mathbf{P}_{c}^{\top}\mathbf{Z}_{c}\in\mathbb{R}^{K\times n_{c}}" display="inline"><semantics id="S3.SS3.p4.9.m9.1a"><mrow id="S3.SS3.p4.9.m9.1.1" xref="S3.SS3.p4.9.m9.1.1.cmml"><msub id="S3.SS3.p4.9.m9.1.1.2" xref="S3.SS3.p4.9.m9.1.1.2.cmml"><mi id="S3.SS3.p4.9.m9.1.1.2.2" xref="S3.SS3.p4.9.m9.1.1.2.2.cmml">𝐐</mi><mi id="S3.SS3.p4.9.m9.1.1.2.3" xref="S3.SS3.p4.9.m9.1.1.2.3.cmml">c</mi></msub><mo id="S3.SS3.p4.9.m9.1.1.3" xref="S3.SS3.p4.9.m9.1.1.3.cmml">=</mo><mrow id="S3.SS3.p4.9.m9.1.1.4" xref="S3.SS3.p4.9.m9.1.1.4.cmml"><msubsup id="S3.SS3.p4.9.m9.1.1.4.2" xref="S3.SS3.p4.9.m9.1.1.4.2.cmml"><mi id="S3.SS3.p4.9.m9.1.1.4.2.2.2" xref="S3.SS3.p4.9.m9.1.1.4.2.2.2.cmml">𝐏</mi><mi id="S3.SS3.p4.9.m9.1.1.4.2.2.3" xref="S3.SS3.p4.9.m9.1.1.4.2.2.3.cmml">c</mi><mo id="S3.SS3.p4.9.m9.1.1.4.2.3" xref="S3.SS3.p4.9.m9.1.1.4.2.3.cmml">⊤</mo></msubsup><mo lspace="0em" rspace="0em" id="S3.SS3.p4.9.m9.1.1.4.1" xref="S3.SS3.p4.9.m9.1.1.4.1.cmml">​</mo><msub id="S3.SS3.p4.9.m9.1.1.4.3" xref="S3.SS3.p4.9.m9.1.1.4.3.cmml"><mi id="S3.SS3.p4.9.m9.1.1.4.3.2" xref="S3.SS3.p4.9.m9.1.1.4.3.2.cmml">𝐙</mi><mi id="S3.SS3.p4.9.m9.1.1.4.3.3" xref="S3.SS3.p4.9.m9.1.1.4.3.3.cmml">c</mi></msub></mrow><mo id="S3.SS3.p4.9.m9.1.1.5" xref="S3.SS3.p4.9.m9.1.1.5.cmml">∈</mo><msup id="S3.SS3.p4.9.m9.1.1.6" xref="S3.SS3.p4.9.m9.1.1.6.cmml"><mi id="S3.SS3.p4.9.m9.1.1.6.2" xref="S3.SS3.p4.9.m9.1.1.6.2.cmml">ℝ</mi><mrow id="S3.SS3.p4.9.m9.1.1.6.3" xref="S3.SS3.p4.9.m9.1.1.6.3.cmml"><mi id="S3.SS3.p4.9.m9.1.1.6.3.2" xref="S3.SS3.p4.9.m9.1.1.6.3.2.cmml">K</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS3.p4.9.m9.1.1.6.3.1" xref="S3.SS3.p4.9.m9.1.1.6.3.1.cmml">×</mo><msub id="S3.SS3.p4.9.m9.1.1.6.3.3" xref="S3.SS3.p4.9.m9.1.1.6.3.3.cmml"><mi id="S3.SS3.p4.9.m9.1.1.6.3.3.2" xref="S3.SS3.p4.9.m9.1.1.6.3.3.2.cmml">n</mi><mi id="S3.SS3.p4.9.m9.1.1.6.3.3.3" xref="S3.SS3.p4.9.m9.1.1.6.3.3.3.cmml">c</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.9.m9.1b"><apply id="S3.SS3.p4.9.m9.1.1.cmml" xref="S3.SS3.p4.9.m9.1.1"><and id="S3.SS3.p4.9.m9.1.1a.cmml" xref="S3.SS3.p4.9.m9.1.1"></and><apply id="S3.SS3.p4.9.m9.1.1b.cmml" xref="S3.SS3.p4.9.m9.1.1"><eq id="S3.SS3.p4.9.m9.1.1.3.cmml" xref="S3.SS3.p4.9.m9.1.1.3"></eq><apply id="S3.SS3.p4.9.m9.1.1.2.cmml" xref="S3.SS3.p4.9.m9.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p4.9.m9.1.1.2.1.cmml" xref="S3.SS3.p4.9.m9.1.1.2">subscript</csymbol><ci id="S3.SS3.p4.9.m9.1.1.2.2.cmml" xref="S3.SS3.p4.9.m9.1.1.2.2">𝐐</ci><ci id="S3.SS3.p4.9.m9.1.1.2.3.cmml" xref="S3.SS3.p4.9.m9.1.1.2.3">𝑐</ci></apply><apply id="S3.SS3.p4.9.m9.1.1.4.cmml" xref="S3.SS3.p4.9.m9.1.1.4"><times id="S3.SS3.p4.9.m9.1.1.4.1.cmml" xref="S3.SS3.p4.9.m9.1.1.4.1"></times><apply id="S3.SS3.p4.9.m9.1.1.4.2.cmml" xref="S3.SS3.p4.9.m9.1.1.4.2"><csymbol cd="ambiguous" id="S3.SS3.p4.9.m9.1.1.4.2.1.cmml" xref="S3.SS3.p4.9.m9.1.1.4.2">superscript</csymbol><apply id="S3.SS3.p4.9.m9.1.1.4.2.2.cmml" xref="S3.SS3.p4.9.m9.1.1.4.2"><csymbol cd="ambiguous" id="S3.SS3.p4.9.m9.1.1.4.2.2.1.cmml" xref="S3.SS3.p4.9.m9.1.1.4.2">subscript</csymbol><ci id="S3.SS3.p4.9.m9.1.1.4.2.2.2.cmml" xref="S3.SS3.p4.9.m9.1.1.4.2.2.2">𝐏</ci><ci id="S3.SS3.p4.9.m9.1.1.4.2.2.3.cmml" xref="S3.SS3.p4.9.m9.1.1.4.2.2.3">𝑐</ci></apply><csymbol cd="latexml" id="S3.SS3.p4.9.m9.1.1.4.2.3.cmml" xref="S3.SS3.p4.9.m9.1.1.4.2.3">top</csymbol></apply><apply id="S3.SS3.p4.9.m9.1.1.4.3.cmml" xref="S3.SS3.p4.9.m9.1.1.4.3"><csymbol cd="ambiguous" id="S3.SS3.p4.9.m9.1.1.4.3.1.cmml" xref="S3.SS3.p4.9.m9.1.1.4.3">subscript</csymbol><ci id="S3.SS3.p4.9.m9.1.1.4.3.2.cmml" xref="S3.SS3.p4.9.m9.1.1.4.3.2">𝐙</ci><ci id="S3.SS3.p4.9.m9.1.1.4.3.3.cmml" xref="S3.SS3.p4.9.m9.1.1.4.3.3">𝑐</ci></apply></apply></apply><apply id="S3.SS3.p4.9.m9.1.1c.cmml" xref="S3.SS3.p4.9.m9.1.1"><in id="S3.SS3.p4.9.m9.1.1.5.cmml" xref="S3.SS3.p4.9.m9.1.1.5"></in><share href="#S3.SS3.p4.9.m9.1.1.4.cmml" id="S3.SS3.p4.9.m9.1.1d.cmml" xref="S3.SS3.p4.9.m9.1.1"></share><apply id="S3.SS3.p4.9.m9.1.1.6.cmml" xref="S3.SS3.p4.9.m9.1.1.6"><csymbol cd="ambiguous" id="S3.SS3.p4.9.m9.1.1.6.1.cmml" xref="S3.SS3.p4.9.m9.1.1.6">superscript</csymbol><ci id="S3.SS3.p4.9.m9.1.1.6.2.cmml" xref="S3.SS3.p4.9.m9.1.1.6.2">ℝ</ci><apply id="S3.SS3.p4.9.m9.1.1.6.3.cmml" xref="S3.SS3.p4.9.m9.1.1.6.3"><times id="S3.SS3.p4.9.m9.1.1.6.3.1.cmml" xref="S3.SS3.p4.9.m9.1.1.6.3.1"></times><ci id="S3.SS3.p4.9.m9.1.1.6.3.2.cmml" xref="S3.SS3.p4.9.m9.1.1.6.3.2">𝐾</ci><apply id="S3.SS3.p4.9.m9.1.1.6.3.3.cmml" xref="S3.SS3.p4.9.m9.1.1.6.3.3"><csymbol cd="ambiguous" id="S3.SS3.p4.9.m9.1.1.6.3.3.1.cmml" xref="S3.SS3.p4.9.m9.1.1.6.3.3">subscript</csymbol><ci id="S3.SS3.p4.9.m9.1.1.6.3.3.2.cmml" xref="S3.SS3.p4.9.m9.1.1.6.3.3.2">𝑛</ci><ci id="S3.SS3.p4.9.m9.1.1.6.3.3.3.cmml" xref="S3.SS3.p4.9.m9.1.1.6.3.3.3">𝑐</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.9.m9.1c">\mathbf{Q}_{c}=\mathbf{P}_{c}^{\top}\mathbf{Z}_{c}\in\mathbb{R}^{K\times n_{c}}</annotation></semantics></math>, where <math id="S3.SS3.p4.10.m10.1" class="ltx_Math" alttext="\mathbf{Z}_{c}\in\mathbb{R}^{D\times n_{c}}" display="inline"><semantics id="S3.SS3.p4.10.m10.1a"><mrow id="S3.SS3.p4.10.m10.1.1" xref="S3.SS3.p4.10.m10.1.1.cmml"><msub id="S3.SS3.p4.10.m10.1.1.2" xref="S3.SS3.p4.10.m10.1.1.2.cmml"><mi id="S3.SS3.p4.10.m10.1.1.2.2" xref="S3.SS3.p4.10.m10.1.1.2.2.cmml">𝐙</mi><mi id="S3.SS3.p4.10.m10.1.1.2.3" xref="S3.SS3.p4.10.m10.1.1.2.3.cmml">c</mi></msub><mo id="S3.SS3.p4.10.m10.1.1.1" xref="S3.SS3.p4.10.m10.1.1.1.cmml">∈</mo><msup id="S3.SS3.p4.10.m10.1.1.3" xref="S3.SS3.p4.10.m10.1.1.3.cmml"><mi id="S3.SS3.p4.10.m10.1.1.3.2" xref="S3.SS3.p4.10.m10.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS3.p4.10.m10.1.1.3.3" xref="S3.SS3.p4.10.m10.1.1.3.3.cmml"><mi id="S3.SS3.p4.10.m10.1.1.3.3.2" xref="S3.SS3.p4.10.m10.1.1.3.3.2.cmml">D</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS3.p4.10.m10.1.1.3.3.1" xref="S3.SS3.p4.10.m10.1.1.3.3.1.cmml">×</mo><msub id="S3.SS3.p4.10.m10.1.1.3.3.3" xref="S3.SS3.p4.10.m10.1.1.3.3.3.cmml"><mi id="S3.SS3.p4.10.m10.1.1.3.3.3.2" xref="S3.SS3.p4.10.m10.1.1.3.3.3.2.cmml">n</mi><mi id="S3.SS3.p4.10.m10.1.1.3.3.3.3" xref="S3.SS3.p4.10.m10.1.1.3.3.3.3.cmml">c</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.10.m10.1b"><apply id="S3.SS3.p4.10.m10.1.1.cmml" xref="S3.SS3.p4.10.m10.1.1"><in id="S3.SS3.p4.10.m10.1.1.1.cmml" xref="S3.SS3.p4.10.m10.1.1.1"></in><apply id="S3.SS3.p4.10.m10.1.1.2.cmml" xref="S3.SS3.p4.10.m10.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p4.10.m10.1.1.2.1.cmml" xref="S3.SS3.p4.10.m10.1.1.2">subscript</csymbol><ci id="S3.SS3.p4.10.m10.1.1.2.2.cmml" xref="S3.SS3.p4.10.m10.1.1.2.2">𝐙</ci><ci id="S3.SS3.p4.10.m10.1.1.2.3.cmml" xref="S3.SS3.p4.10.m10.1.1.2.3">𝑐</ci></apply><apply id="S3.SS3.p4.10.m10.1.1.3.cmml" xref="S3.SS3.p4.10.m10.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p4.10.m10.1.1.3.1.cmml" xref="S3.SS3.p4.10.m10.1.1.3">superscript</csymbol><ci id="S3.SS3.p4.10.m10.1.1.3.2.cmml" xref="S3.SS3.p4.10.m10.1.1.3.2">ℝ</ci><apply id="S3.SS3.p4.10.m10.1.1.3.3.cmml" xref="S3.SS3.p4.10.m10.1.1.3.3"><times id="S3.SS3.p4.10.m10.1.1.3.3.1.cmml" xref="S3.SS3.p4.10.m10.1.1.3.3.1"></times><ci id="S3.SS3.p4.10.m10.1.1.3.3.2.cmml" xref="S3.SS3.p4.10.m10.1.1.3.3.2">𝐷</ci><apply id="S3.SS3.p4.10.m10.1.1.3.3.3.cmml" xref="S3.SS3.p4.10.m10.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.p4.10.m10.1.1.3.3.3.1.cmml" xref="S3.SS3.p4.10.m10.1.1.3.3.3">subscript</csymbol><ci id="S3.SS3.p4.10.m10.1.1.3.3.3.2.cmml" xref="S3.SS3.p4.10.m10.1.1.3.3.3.2">𝑛</ci><ci id="S3.SS3.p4.10.m10.1.1.3.3.3.3.cmml" xref="S3.SS3.p4.10.m10.1.1.3.3.3.3">𝑐</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.10.m10.1c">\mathbf{Z}_{c}\in\mathbb{R}^{D\times n_{c}}</annotation></semantics></math> and <math id="S3.SS3.p4.11.m11.1" class="ltx_Math" alttext="n_{c}" display="inline"><semantics id="S3.SS3.p4.11.m11.1a"><msub id="S3.SS3.p4.11.m11.1.1" xref="S3.SS3.p4.11.m11.1.1.cmml"><mi id="S3.SS3.p4.11.m11.1.1.2" xref="S3.SS3.p4.11.m11.1.1.2.cmml">n</mi><mi id="S3.SS3.p4.11.m11.1.1.3" xref="S3.SS3.p4.11.m11.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.11.m11.1b"><apply id="S3.SS3.p4.11.m11.1.1.cmml" xref="S3.SS3.p4.11.m11.1.1"><csymbol cd="ambiguous" id="S3.SS3.p4.11.m11.1.1.1.cmml" xref="S3.SS3.p4.11.m11.1.1">subscript</csymbol><ci id="S3.SS3.p4.11.m11.1.1.2.cmml" xref="S3.SS3.p4.11.m11.1.1.2">𝑛</ci><ci id="S3.SS3.p4.11.m11.1.1.3.cmml" xref="S3.SS3.p4.11.m11.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.11.m11.1c">n_{c}</annotation></semantics></math> represent instance embeddings and the number of instances pseudo-labeled as class <math id="S3.SS3.p4.12.m12.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S3.SS3.p4.12.m12.1a"><mi id="S3.SS3.p4.12.m12.1.1" xref="S3.SS3.p4.12.m12.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.12.m12.1b"><ci id="S3.SS3.p4.12.m12.1.1.cmml" xref="S3.SS3.p4.12.m12.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.12.m12.1c">c</annotation></semantics></math>, respectively.</p>
</div>
<div id="S3.SS3.p5" class="ltx_para">
<p id="S3.SS3.p5.2" class="ltx_p">To avoid a trivial solution in which all the instance embeddings are assigned to a single prototype, an equipartition constraint is added to ensure that instances are equally distributed among prototypes within a class. By adding the entropy regularization term <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib46" title="" class="ltx_ref">46</a>]</cite> with a parameter <math id="S3.SS3.p5.1.m1.1" class="ltx_Math" alttext="\kappa" display="inline"><semantics id="S3.SS3.p5.1.m1.1a"><mi id="S3.SS3.p5.1.m1.1.1" xref="S3.SS3.p5.1.m1.1.1.cmml">κ</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p5.1.m1.1b"><ci id="S3.SS3.p5.1.m1.1.1.cmml" xref="S3.SS3.p5.1.m1.1.1">𝜅</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p5.1.m1.1c">\kappa</annotation></semantics></math> that controls the smoothness of assignment, the objective for obtaining the assignment matrix for class <math id="S3.SS3.p5.2.m2.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S3.SS3.p5.2.m2.1a"><mi id="S3.SS3.p5.2.m2.1.1" xref="S3.SS3.p5.2.m2.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p5.2.m2.1b"><ci id="S3.SS3.p5.2.m2.1.1.cmml" xref="S3.SS3.p5.2.m2.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p5.2.m2.1c">c</annotation></semantics></math> is as follows:</p>
<table id="S3.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E2.m1.2" class="ltx_Math" alttext="\max_{{\mathbf{L}}_{c}}\text{Tr}\left({\mathbf{L}}_{c}^{\top}\mathbf{Q}_{c}\right)+\kappa~{}\mathcal{H}(\mathbf{L}_{c}),\quad\textit{s.t.}\quad\mathbf{L}_{c}\cdot\mathbf{1}^{n_{c}}=\frac{n_{c}}{K}\cdot\mathbf{1}^{K}," display="block"><semantics id="S3.E2.m1.2a"><mrow id="S3.E2.m1.2.2.1" xref="S3.E2.m1.2.2.1.1.cmml"><mrow id="S3.E2.m1.2.2.1.1" xref="S3.E2.m1.2.2.1.1.cmml"><mrow id="S3.E2.m1.2.2.1.1.2.2" xref="S3.E2.m1.2.2.1.1.2.3.cmml"><mrow id="S3.E2.m1.2.2.1.1.1.1.1" xref="S3.E2.m1.2.2.1.1.1.1.1.cmml"><mrow id="S3.E2.m1.2.2.1.1.1.1.1.1" xref="S3.E2.m1.2.2.1.1.1.1.1.1.cmml"><mrow id="S3.E2.m1.2.2.1.1.1.1.1.1.3" xref="S3.E2.m1.2.2.1.1.1.1.1.1.3.cmml"><munder id="S3.E2.m1.2.2.1.1.1.1.1.1.3.1" xref="S3.E2.m1.2.2.1.1.1.1.1.1.3.1.cmml"><mi id="S3.E2.m1.2.2.1.1.1.1.1.1.3.1.2" xref="S3.E2.m1.2.2.1.1.1.1.1.1.3.1.2.cmml">max</mi><msub id="S3.E2.m1.2.2.1.1.1.1.1.1.3.1.3" xref="S3.E2.m1.2.2.1.1.1.1.1.1.3.1.3.cmml"><mi id="S3.E2.m1.2.2.1.1.1.1.1.1.3.1.3.2" xref="S3.E2.m1.2.2.1.1.1.1.1.1.3.1.3.2.cmml">𝐋</mi><mi id="S3.E2.m1.2.2.1.1.1.1.1.1.3.1.3.3" xref="S3.E2.m1.2.2.1.1.1.1.1.1.3.1.3.3.cmml">c</mi></msub></munder><mo lspace="0.167em" id="S3.E2.m1.2.2.1.1.1.1.1.1.3a" xref="S3.E2.m1.2.2.1.1.1.1.1.1.3.cmml">⁡</mo><mtext id="S3.E2.m1.2.2.1.1.1.1.1.1.3.2" xref="S3.E2.m1.2.2.1.1.1.1.1.1.3.2a.cmml">Tr</mtext></mrow><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.1.1.1.1.1.1.2" xref="S3.E2.m1.2.2.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.2" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.cmml"><msubsup id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.2" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.2" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.2.cmml">𝐋</mi><mi id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.3" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.3.cmml">c</mi><mo id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.2.3.cmml">⊤</mo></msubsup><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml">​</mo><msub id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.3" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.3.2.cmml">𝐐</mi><mi id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.3.3.cmml">c</mi></msub></mrow><mo id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.3" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E2.m1.2.2.1.1.1.1.1.3" xref="S3.E2.m1.2.2.1.1.1.1.1.3.cmml">+</mo><mrow id="S3.E2.m1.2.2.1.1.1.1.1.2" xref="S3.E2.m1.2.2.1.1.1.1.1.2.cmml"><mi id="S3.E2.m1.2.2.1.1.1.1.1.2.3" xref="S3.E2.m1.2.2.1.1.1.1.1.2.3.cmml">κ</mi><mo lspace="0.330em" rspace="0em" id="S3.E2.m1.2.2.1.1.1.1.1.2.2" xref="S3.E2.m1.2.2.1.1.1.1.1.2.2.cmml">​</mo><mi class="ltx_font_mathcaligraphic" id="S3.E2.m1.2.2.1.1.1.1.1.2.4" xref="S3.E2.m1.2.2.1.1.1.1.1.2.4.cmml">ℋ</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.1.1.1.1.1.2.2a" xref="S3.E2.m1.2.2.1.1.1.1.1.2.2.cmml">​</mo><mrow id="S3.E2.m1.2.2.1.1.1.1.1.2.1.1" xref="S3.E2.m1.2.2.1.1.1.1.1.2.1.1.1.cmml"><mo stretchy="false" id="S3.E2.m1.2.2.1.1.1.1.1.2.1.1.2" xref="S3.E2.m1.2.2.1.1.1.1.1.2.1.1.1.cmml">(</mo><msub id="S3.E2.m1.2.2.1.1.1.1.1.2.1.1.1" xref="S3.E2.m1.2.2.1.1.1.1.1.2.1.1.1.cmml"><mi id="S3.E2.m1.2.2.1.1.1.1.1.2.1.1.1.2" xref="S3.E2.m1.2.2.1.1.1.1.1.2.1.1.1.2.cmml">𝐋</mi><mi id="S3.E2.m1.2.2.1.1.1.1.1.2.1.1.1.3" xref="S3.E2.m1.2.2.1.1.1.1.1.2.1.1.1.3.cmml">c</mi></msub><mo stretchy="false" id="S3.E2.m1.2.2.1.1.1.1.1.2.1.1.3" xref="S3.E2.m1.2.2.1.1.1.1.1.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo rspace="1.167em" id="S3.E2.m1.2.2.1.1.2.2.3" xref="S3.E2.m1.2.2.1.1.2.3.cmml">,</mo><mtext class="ltx_mathvariant_italic" id="S3.E2.m1.1.1" xref="S3.E2.m1.1.1a.cmml">s.t.</mtext><mspace width="1em" id="S3.E2.m1.2.2.1.1.2.2.4" xref="S3.E2.m1.2.2.1.1.2.3.cmml"></mspace><mrow id="S3.E2.m1.2.2.1.1.2.2.2" xref="S3.E2.m1.2.2.1.1.2.2.2.cmml"><msub id="S3.E2.m1.2.2.1.1.2.2.2.2" xref="S3.E2.m1.2.2.1.1.2.2.2.2.cmml"><mi id="S3.E2.m1.2.2.1.1.2.2.2.2.2" xref="S3.E2.m1.2.2.1.1.2.2.2.2.2.cmml">𝐋</mi><mi id="S3.E2.m1.2.2.1.1.2.2.2.2.3" xref="S3.E2.m1.2.2.1.1.2.2.2.2.3.cmml">c</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S3.E2.m1.2.2.1.1.2.2.2.1" xref="S3.E2.m1.2.2.1.1.2.2.2.1.cmml">⋅</mo><msup id="S3.E2.m1.2.2.1.1.2.2.2.3" xref="S3.E2.m1.2.2.1.1.2.2.2.3.cmml"><mn id="S3.E2.m1.2.2.1.1.2.2.2.3.2" xref="S3.E2.m1.2.2.1.1.2.2.2.3.2.cmml">𝟏</mn><msub id="S3.E2.m1.2.2.1.1.2.2.2.3.3" xref="S3.E2.m1.2.2.1.1.2.2.2.3.3.cmml"><mi id="S3.E2.m1.2.2.1.1.2.2.2.3.3.2" xref="S3.E2.m1.2.2.1.1.2.2.2.3.3.2.cmml">n</mi><mi id="S3.E2.m1.2.2.1.1.2.2.2.3.3.3" xref="S3.E2.m1.2.2.1.1.2.2.2.3.3.3.cmml">c</mi></msub></msup></mrow></mrow><mo id="S3.E2.m1.2.2.1.1.3" xref="S3.E2.m1.2.2.1.1.3.cmml">=</mo><mrow id="S3.E2.m1.2.2.1.1.4" xref="S3.E2.m1.2.2.1.1.4.cmml"><mfrac id="S3.E2.m1.2.2.1.1.4.2" xref="S3.E2.m1.2.2.1.1.4.2.cmml"><msub id="S3.E2.m1.2.2.1.1.4.2.2" xref="S3.E2.m1.2.2.1.1.4.2.2.cmml"><mi id="S3.E2.m1.2.2.1.1.4.2.2.2" xref="S3.E2.m1.2.2.1.1.4.2.2.2.cmml">n</mi><mi id="S3.E2.m1.2.2.1.1.4.2.2.3" xref="S3.E2.m1.2.2.1.1.4.2.2.3.cmml">c</mi></msub><mi id="S3.E2.m1.2.2.1.1.4.2.3" xref="S3.E2.m1.2.2.1.1.4.2.3.cmml">K</mi></mfrac><mo lspace="0.222em" rspace="0.222em" id="S3.E2.m1.2.2.1.1.4.1" xref="S3.E2.m1.2.2.1.1.4.1.cmml">⋅</mo><msup id="S3.E2.m1.2.2.1.1.4.3" xref="S3.E2.m1.2.2.1.1.4.3.cmml"><mn id="S3.E2.m1.2.2.1.1.4.3.2" xref="S3.E2.m1.2.2.1.1.4.3.2.cmml">𝟏</mn><mi id="S3.E2.m1.2.2.1.1.4.3.3" xref="S3.E2.m1.2.2.1.1.4.3.3.cmml">K</mi></msup></mrow></mrow><mo id="S3.E2.m1.2.2.1.2" xref="S3.E2.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.2b"><apply id="S3.E2.m1.2.2.1.1.cmml" xref="S3.E2.m1.2.2.1"><eq id="S3.E2.m1.2.2.1.1.3.cmml" xref="S3.E2.m1.2.2.1.1.3"></eq><list id="S3.E2.m1.2.2.1.1.2.3.cmml" xref="S3.E2.m1.2.2.1.1.2.2"><apply id="S3.E2.m1.2.2.1.1.1.1.1.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1"><plus id="S3.E2.m1.2.2.1.1.1.1.1.3.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.3"></plus><apply id="S3.E2.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1"><times id="S3.E2.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.2"></times><apply id="S3.E2.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.3"><apply id="S3.E2.m1.2.2.1.1.1.1.1.1.3.1.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.3.1"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.1.1.1.1.3.1.1.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.3.1">subscript</csymbol><max id="S3.E2.m1.2.2.1.1.1.1.1.1.3.1.2.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.3.1.2"></max><apply id="S3.E2.m1.2.2.1.1.1.1.1.1.3.1.3.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.3.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.1.1.1.1.3.1.3.1.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.3.1.3">subscript</csymbol><ci id="S3.E2.m1.2.2.1.1.1.1.1.1.3.1.3.2.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.3.1.3.2">𝐋</ci><ci id="S3.E2.m1.2.2.1.1.1.1.1.1.3.1.3.3.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.3.1.3.3">𝑐</ci></apply></apply><ci id="S3.E2.m1.2.2.1.1.1.1.1.1.3.2a.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.3.2"><mtext id="S3.E2.m1.2.2.1.1.1.1.1.1.3.2.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.3.2">Tr</mtext></ci></apply><apply id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1"><times id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1"></times><apply id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.2">superscript</csymbol><apply id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.2">𝐋</ci><ci id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.3">𝑐</ci></apply><csymbol cd="latexml" id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.2.3">top</csymbol></apply><apply id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.3.2">𝐐</ci><ci id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.3.3">𝑐</ci></apply></apply></apply><apply id="S3.E2.m1.2.2.1.1.1.1.1.2.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.2"><times id="S3.E2.m1.2.2.1.1.1.1.1.2.2.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.2.2"></times><ci id="S3.E2.m1.2.2.1.1.1.1.1.2.3.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.2.3">𝜅</ci><ci id="S3.E2.m1.2.2.1.1.1.1.1.2.4.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.2.4">ℋ</ci><apply id="S3.E2.m1.2.2.1.1.1.1.1.2.1.1.1.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.2.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.1.1.1.2.1.1.1.1.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.2.1.1">subscript</csymbol><ci id="S3.E2.m1.2.2.1.1.1.1.1.2.1.1.1.2.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.2.1.1.1.2">𝐋</ci><ci id="S3.E2.m1.2.2.1.1.1.1.1.2.1.1.1.3.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.2.1.1.1.3">𝑐</ci></apply></apply></apply><ci id="S3.E2.m1.1.1a.cmml" xref="S3.E2.m1.1.1"><mtext class="ltx_mathvariant_italic" id="S3.E2.m1.1.1.cmml" xref="S3.E2.m1.1.1">s.t.</mtext></ci><apply id="S3.E2.m1.2.2.1.1.2.2.2.cmml" xref="S3.E2.m1.2.2.1.1.2.2.2"><ci id="S3.E2.m1.2.2.1.1.2.2.2.1.cmml" xref="S3.E2.m1.2.2.1.1.2.2.2.1">⋅</ci><apply id="S3.E2.m1.2.2.1.1.2.2.2.2.cmml" xref="S3.E2.m1.2.2.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.2.2.2.2.1.cmml" xref="S3.E2.m1.2.2.1.1.2.2.2.2">subscript</csymbol><ci id="S3.E2.m1.2.2.1.1.2.2.2.2.2.cmml" xref="S3.E2.m1.2.2.1.1.2.2.2.2.2">𝐋</ci><ci id="S3.E2.m1.2.2.1.1.2.2.2.2.3.cmml" xref="S3.E2.m1.2.2.1.1.2.2.2.2.3">𝑐</ci></apply><apply id="S3.E2.m1.2.2.1.1.2.2.2.3.cmml" xref="S3.E2.m1.2.2.1.1.2.2.2.3"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.2.2.2.3.1.cmml" xref="S3.E2.m1.2.2.1.1.2.2.2.3">superscript</csymbol><cn type="integer" id="S3.E2.m1.2.2.1.1.2.2.2.3.2.cmml" xref="S3.E2.m1.2.2.1.1.2.2.2.3.2">1</cn><apply id="S3.E2.m1.2.2.1.1.2.2.2.3.3.cmml" xref="S3.E2.m1.2.2.1.1.2.2.2.3.3"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.2.2.2.3.3.1.cmml" xref="S3.E2.m1.2.2.1.1.2.2.2.3.3">subscript</csymbol><ci id="S3.E2.m1.2.2.1.1.2.2.2.3.3.2.cmml" xref="S3.E2.m1.2.2.1.1.2.2.2.3.3.2">𝑛</ci><ci id="S3.E2.m1.2.2.1.1.2.2.2.3.3.3.cmml" xref="S3.E2.m1.2.2.1.1.2.2.2.3.3.3">𝑐</ci></apply></apply></apply></list><apply id="S3.E2.m1.2.2.1.1.4.cmml" xref="S3.E2.m1.2.2.1.1.4"><ci id="S3.E2.m1.2.2.1.1.4.1.cmml" xref="S3.E2.m1.2.2.1.1.4.1">⋅</ci><apply id="S3.E2.m1.2.2.1.1.4.2.cmml" xref="S3.E2.m1.2.2.1.1.4.2"><divide id="S3.E2.m1.2.2.1.1.4.2.1.cmml" xref="S3.E2.m1.2.2.1.1.4.2"></divide><apply id="S3.E2.m1.2.2.1.1.4.2.2.cmml" xref="S3.E2.m1.2.2.1.1.4.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.4.2.2.1.cmml" xref="S3.E2.m1.2.2.1.1.4.2.2">subscript</csymbol><ci id="S3.E2.m1.2.2.1.1.4.2.2.2.cmml" xref="S3.E2.m1.2.2.1.1.4.2.2.2">𝑛</ci><ci id="S3.E2.m1.2.2.1.1.4.2.2.3.cmml" xref="S3.E2.m1.2.2.1.1.4.2.2.3">𝑐</ci></apply><ci id="S3.E2.m1.2.2.1.1.4.2.3.cmml" xref="S3.E2.m1.2.2.1.1.4.2.3">𝐾</ci></apply><apply id="S3.E2.m1.2.2.1.1.4.3.cmml" xref="S3.E2.m1.2.2.1.1.4.3"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.4.3.1.cmml" xref="S3.E2.m1.2.2.1.1.4.3">superscript</csymbol><cn type="integer" id="S3.E2.m1.2.2.1.1.4.3.2.cmml" xref="S3.E2.m1.2.2.1.1.4.3.2">1</cn><ci id="S3.E2.m1.2.2.1.1.4.3.3.cmml" xref="S3.E2.m1.2.2.1.1.4.3.3">𝐾</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.2c">\max_{{\mathbf{L}}_{c}}\text{Tr}\left({\mathbf{L}}_{c}^{\top}\mathbf{Q}_{c}\right)+\kappa~{}\mathcal{H}(\mathbf{L}_{c}),\quad\textit{s.t.}\quad\mathbf{L}_{c}\cdot\mathbf{1}^{n_{c}}=\frac{n_{c}}{K}\cdot\mathbf{1}^{K},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p id="S3.SS3.p5.4" class="ltx_p">which turns into an optimal transport problem. The solution can be computed by a few iterations of the <span id="S3.SS3.p5.4.1" class="ltx_text ltx_font_italic">Sinkhorn-Knopp</span> algorithm <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib46" title="" class="ltx_ref">46</a>]</cite>, which outputs the re-normalization vectors <math id="S3.SS3.p5.3.m1.1" class="ltx_Math" alttext="\mathbf{u}\in\mathbb{R}^{K}" display="inline"><semantics id="S3.SS3.p5.3.m1.1a"><mrow id="S3.SS3.p5.3.m1.1.1" xref="S3.SS3.p5.3.m1.1.1.cmml"><mi id="S3.SS3.p5.3.m1.1.1.2" xref="S3.SS3.p5.3.m1.1.1.2.cmml">𝐮</mi><mo id="S3.SS3.p5.3.m1.1.1.1" xref="S3.SS3.p5.3.m1.1.1.1.cmml">∈</mo><msup id="S3.SS3.p5.3.m1.1.1.3" xref="S3.SS3.p5.3.m1.1.1.3.cmml"><mi id="S3.SS3.p5.3.m1.1.1.3.2" xref="S3.SS3.p5.3.m1.1.1.3.2.cmml">ℝ</mi><mi id="S3.SS3.p5.3.m1.1.1.3.3" xref="S3.SS3.p5.3.m1.1.1.3.3.cmml">K</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p5.3.m1.1b"><apply id="S3.SS3.p5.3.m1.1.1.cmml" xref="S3.SS3.p5.3.m1.1.1"><in id="S3.SS3.p5.3.m1.1.1.1.cmml" xref="S3.SS3.p5.3.m1.1.1.1"></in><ci id="S3.SS3.p5.3.m1.1.1.2.cmml" xref="S3.SS3.p5.3.m1.1.1.2">𝐮</ci><apply id="S3.SS3.p5.3.m1.1.1.3.cmml" xref="S3.SS3.p5.3.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p5.3.m1.1.1.3.1.cmml" xref="S3.SS3.p5.3.m1.1.1.3">superscript</csymbol><ci id="S3.SS3.p5.3.m1.1.1.3.2.cmml" xref="S3.SS3.p5.3.m1.1.1.3.2">ℝ</ci><ci id="S3.SS3.p5.3.m1.1.1.3.3.cmml" xref="S3.SS3.p5.3.m1.1.1.3.3">𝐾</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p5.3.m1.1c">\mathbf{u}\in\mathbb{R}^{K}</annotation></semantics></math> and <math id="S3.SS3.p5.4.m2.1" class="ltx_Math" alttext="\mathbf{v}\in\mathbb{R}^{n_{c}}" display="inline"><semantics id="S3.SS3.p5.4.m2.1a"><mrow id="S3.SS3.p5.4.m2.1.1" xref="S3.SS3.p5.4.m2.1.1.cmml"><mi id="S3.SS3.p5.4.m2.1.1.2" xref="S3.SS3.p5.4.m2.1.1.2.cmml">𝐯</mi><mo id="S3.SS3.p5.4.m2.1.1.1" xref="S3.SS3.p5.4.m2.1.1.1.cmml">∈</mo><msup id="S3.SS3.p5.4.m2.1.1.3" xref="S3.SS3.p5.4.m2.1.1.3.cmml"><mi id="S3.SS3.p5.4.m2.1.1.3.2" xref="S3.SS3.p5.4.m2.1.1.3.2.cmml">ℝ</mi><msub id="S3.SS3.p5.4.m2.1.1.3.3" xref="S3.SS3.p5.4.m2.1.1.3.3.cmml"><mi id="S3.SS3.p5.4.m2.1.1.3.3.2" xref="S3.SS3.p5.4.m2.1.1.3.3.2.cmml">n</mi><mi id="S3.SS3.p5.4.m2.1.1.3.3.3" xref="S3.SS3.p5.4.m2.1.1.3.3.3.cmml">c</mi></msub></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p5.4.m2.1b"><apply id="S3.SS3.p5.4.m2.1.1.cmml" xref="S3.SS3.p5.4.m2.1.1"><in id="S3.SS3.p5.4.m2.1.1.1.cmml" xref="S3.SS3.p5.4.m2.1.1.1"></in><ci id="S3.SS3.p5.4.m2.1.1.2.cmml" xref="S3.SS3.p5.4.m2.1.1.2">𝐯</ci><apply id="S3.SS3.p5.4.m2.1.1.3.cmml" xref="S3.SS3.p5.4.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p5.4.m2.1.1.3.1.cmml" xref="S3.SS3.p5.4.m2.1.1.3">superscript</csymbol><ci id="S3.SS3.p5.4.m2.1.1.3.2.cmml" xref="S3.SS3.p5.4.m2.1.1.3.2">ℝ</ci><apply id="S3.SS3.p5.4.m2.1.1.3.3.cmml" xref="S3.SS3.p5.4.m2.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS3.p5.4.m2.1.1.3.3.1.cmml" xref="S3.SS3.p5.4.m2.1.1.3.3">subscript</csymbol><ci id="S3.SS3.p5.4.m2.1.1.3.3.2.cmml" xref="S3.SS3.p5.4.m2.1.1.3.3.2">𝑛</ci><ci id="S3.SS3.p5.4.m2.1.1.3.3.3.cmml" xref="S3.SS3.p5.4.m2.1.1.3.3.3">𝑐</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p5.4.m2.1c">\mathbf{v}\in\mathbb{R}^{n_{c}}</annotation></semantics></math>:</p>
<table id="S3.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E3.m1.7" class="ltx_Math" alttext="\mathbf{L}_{c}=\operatorname{diag}(\mathbf{u})\exp\left({\frac{\mathbf{Q}_{c}}{\kappa}}\right)\operatorname{diag}(\mathbf{v})." display="block"><semantics id="S3.E3.m1.7a"><mrow id="S3.E3.m1.7.7.1" xref="S3.E3.m1.7.7.1.1.cmml"><mrow id="S3.E3.m1.7.7.1.1" xref="S3.E3.m1.7.7.1.1.cmml"><msub id="S3.E3.m1.7.7.1.1.2" xref="S3.E3.m1.7.7.1.1.2.cmml"><mi id="S3.E3.m1.7.7.1.1.2.2" xref="S3.E3.m1.7.7.1.1.2.2.cmml">𝐋</mi><mi id="S3.E3.m1.7.7.1.1.2.3" xref="S3.E3.m1.7.7.1.1.2.3.cmml">c</mi></msub><mo id="S3.E3.m1.7.7.1.1.1" xref="S3.E3.m1.7.7.1.1.1.cmml">=</mo><mrow id="S3.E3.m1.7.7.1.1.3" xref="S3.E3.m1.7.7.1.1.3.cmml"><mrow id="S3.E3.m1.7.7.1.1.3.2.2" xref="S3.E3.m1.7.7.1.1.3.2.1.cmml"><mi id="S3.E3.m1.1.1" xref="S3.E3.m1.1.1.cmml">diag</mi><mo id="S3.E3.m1.7.7.1.1.3.2.2a" xref="S3.E3.m1.7.7.1.1.3.2.1.cmml">⁡</mo><mrow id="S3.E3.m1.7.7.1.1.3.2.2.1" xref="S3.E3.m1.7.7.1.1.3.2.1.cmml"><mo stretchy="false" id="S3.E3.m1.7.7.1.1.3.2.2.1.1" xref="S3.E3.m1.7.7.1.1.3.2.1.cmml">(</mo><mi id="S3.E3.m1.2.2" xref="S3.E3.m1.2.2.cmml">𝐮</mi><mo stretchy="false" id="S3.E3.m1.7.7.1.1.3.2.2.1.2" xref="S3.E3.m1.7.7.1.1.3.2.1.cmml">)</mo></mrow></mrow><mo lspace="0.167em" rspace="0em" id="S3.E3.m1.7.7.1.1.3.1" xref="S3.E3.m1.7.7.1.1.3.1.cmml">​</mo><mrow id="S3.E3.m1.7.7.1.1.3.3.2" xref="S3.E3.m1.7.7.1.1.3.3.1.cmml"><mi id="S3.E3.m1.3.3" xref="S3.E3.m1.3.3.cmml">exp</mi><mo id="S3.E3.m1.7.7.1.1.3.3.2a" xref="S3.E3.m1.7.7.1.1.3.3.1.cmml">⁡</mo><mrow id="S3.E3.m1.7.7.1.1.3.3.2.1" xref="S3.E3.m1.7.7.1.1.3.3.1.cmml"><mo id="S3.E3.m1.7.7.1.1.3.3.2.1.1" xref="S3.E3.m1.7.7.1.1.3.3.1.cmml">(</mo><mfrac id="S3.E3.m1.4.4" xref="S3.E3.m1.4.4.cmml"><msub id="S3.E3.m1.4.4.2" xref="S3.E3.m1.4.4.2.cmml"><mi id="S3.E3.m1.4.4.2.2" xref="S3.E3.m1.4.4.2.2.cmml">𝐐</mi><mi id="S3.E3.m1.4.4.2.3" xref="S3.E3.m1.4.4.2.3.cmml">c</mi></msub><mi id="S3.E3.m1.4.4.3" xref="S3.E3.m1.4.4.3.cmml">κ</mi></mfrac><mo id="S3.E3.m1.7.7.1.1.3.3.2.1.2" xref="S3.E3.m1.7.7.1.1.3.3.1.cmml">)</mo></mrow></mrow><mo lspace="0.167em" rspace="0em" id="S3.E3.m1.7.7.1.1.3.1a" xref="S3.E3.m1.7.7.1.1.3.1.cmml">​</mo><mrow id="S3.E3.m1.7.7.1.1.3.4.2" xref="S3.E3.m1.7.7.1.1.3.4.1.cmml"><mi id="S3.E3.m1.5.5" xref="S3.E3.m1.5.5.cmml">diag</mi><mo id="S3.E3.m1.7.7.1.1.3.4.2a" xref="S3.E3.m1.7.7.1.1.3.4.1.cmml">⁡</mo><mrow id="S3.E3.m1.7.7.1.1.3.4.2.1" xref="S3.E3.m1.7.7.1.1.3.4.1.cmml"><mo stretchy="false" id="S3.E3.m1.7.7.1.1.3.4.2.1.1" xref="S3.E3.m1.7.7.1.1.3.4.1.cmml">(</mo><mi id="S3.E3.m1.6.6" xref="S3.E3.m1.6.6.cmml">𝐯</mi><mo stretchy="false" id="S3.E3.m1.7.7.1.1.3.4.2.1.2" xref="S3.E3.m1.7.7.1.1.3.4.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo lspace="0em" id="S3.E3.m1.7.7.1.2" xref="S3.E3.m1.7.7.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.7b"><apply id="S3.E3.m1.7.7.1.1.cmml" xref="S3.E3.m1.7.7.1"><eq id="S3.E3.m1.7.7.1.1.1.cmml" xref="S3.E3.m1.7.7.1.1.1"></eq><apply id="S3.E3.m1.7.7.1.1.2.cmml" xref="S3.E3.m1.7.7.1.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.7.7.1.1.2.1.cmml" xref="S3.E3.m1.7.7.1.1.2">subscript</csymbol><ci id="S3.E3.m1.7.7.1.1.2.2.cmml" xref="S3.E3.m1.7.7.1.1.2.2">𝐋</ci><ci id="S3.E3.m1.7.7.1.1.2.3.cmml" xref="S3.E3.m1.7.7.1.1.2.3">𝑐</ci></apply><apply id="S3.E3.m1.7.7.1.1.3.cmml" xref="S3.E3.m1.7.7.1.1.3"><times id="S3.E3.m1.7.7.1.1.3.1.cmml" xref="S3.E3.m1.7.7.1.1.3.1"></times><apply id="S3.E3.m1.7.7.1.1.3.2.1.cmml" xref="S3.E3.m1.7.7.1.1.3.2.2"><ci id="S3.E3.m1.1.1.cmml" xref="S3.E3.m1.1.1">diag</ci><ci id="S3.E3.m1.2.2.cmml" xref="S3.E3.m1.2.2">𝐮</ci></apply><apply id="S3.E3.m1.7.7.1.1.3.3.1.cmml" xref="S3.E3.m1.7.7.1.1.3.3.2"><exp id="S3.E3.m1.3.3.cmml" xref="S3.E3.m1.3.3"></exp><apply id="S3.E3.m1.4.4.cmml" xref="S3.E3.m1.4.4"><divide id="S3.E3.m1.4.4.1.cmml" xref="S3.E3.m1.4.4"></divide><apply id="S3.E3.m1.4.4.2.cmml" xref="S3.E3.m1.4.4.2"><csymbol cd="ambiguous" id="S3.E3.m1.4.4.2.1.cmml" xref="S3.E3.m1.4.4.2">subscript</csymbol><ci id="S3.E3.m1.4.4.2.2.cmml" xref="S3.E3.m1.4.4.2.2">𝐐</ci><ci id="S3.E3.m1.4.4.2.3.cmml" xref="S3.E3.m1.4.4.2.3">𝑐</ci></apply><ci id="S3.E3.m1.4.4.3.cmml" xref="S3.E3.m1.4.4.3">𝜅</ci></apply></apply><apply id="S3.E3.m1.7.7.1.1.3.4.1.cmml" xref="S3.E3.m1.7.7.1.1.3.4.2"><ci id="S3.E3.m1.5.5.cmml" xref="S3.E3.m1.5.5">diag</ci><ci id="S3.E3.m1.6.6.cmml" xref="S3.E3.m1.6.6">𝐯</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.7c">\mathbf{L}_{c}=\operatorname{diag}(\mathbf{u})\exp\left({\frac{\mathbf{Q}_{c}}{\kappa}}\right)\operatorname{diag}(\mathbf{v}).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS3.p6" class="ltx_para">
<p id="S3.SS3.p6.10" class="ltx_p">After obtaining the soft assignment matrix, the network is trained so that similarities between prototypes and instance embeddings correspond to the soft assignment matrix. The prototypes and instance embeddings are simultaneously optimized by minimizing the following cross-entropy loss between the similarity and assignment matrix:</p>
<table id="S3.E4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E4.m1.11" class="ltx_Math" alttext="\mathcal{L}_{inst}=-\frac{1}{N\cdot K}\sum_{i=1}^{N}\sum_{j=1}^{K}\mathbf{L}^{i,j}_{\hat{c}_{i}}\cdot\log\frac{\exp{\left(\mathbf{z}_{i}\cdot\mathbf{p}_{\hat{c}_{i},j}/\tau\right)}}{\sum_{c}^{C}\sum_{k}^{K}\exp{\left(\mathbf{z}_{i}\cdot\mathbf{p}_{c,k}/\tau\right)}}," display="block"><semantics id="S3.E4.m1.11a"><mrow id="S3.E4.m1.11.11.1" xref="S3.E4.m1.11.11.1.1.cmml"><mrow id="S3.E4.m1.11.11.1.1" xref="S3.E4.m1.11.11.1.1.cmml"><msub id="S3.E4.m1.11.11.1.1.2" xref="S3.E4.m1.11.11.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.11.11.1.1.2.2" xref="S3.E4.m1.11.11.1.1.2.2.cmml">ℒ</mi><mrow id="S3.E4.m1.11.11.1.1.2.3" xref="S3.E4.m1.11.11.1.1.2.3.cmml"><mi id="S3.E4.m1.11.11.1.1.2.3.2" xref="S3.E4.m1.11.11.1.1.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.11.11.1.1.2.3.1" xref="S3.E4.m1.11.11.1.1.2.3.1.cmml">​</mo><mi id="S3.E4.m1.11.11.1.1.2.3.3" xref="S3.E4.m1.11.11.1.1.2.3.3.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.11.11.1.1.2.3.1a" xref="S3.E4.m1.11.11.1.1.2.3.1.cmml">​</mo><mi id="S3.E4.m1.11.11.1.1.2.3.4" xref="S3.E4.m1.11.11.1.1.2.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.11.11.1.1.2.3.1b" xref="S3.E4.m1.11.11.1.1.2.3.1.cmml">​</mo><mi id="S3.E4.m1.11.11.1.1.2.3.5" xref="S3.E4.m1.11.11.1.1.2.3.5.cmml">t</mi></mrow></msub><mo id="S3.E4.m1.11.11.1.1.1" xref="S3.E4.m1.11.11.1.1.1.cmml">=</mo><mrow id="S3.E4.m1.11.11.1.1.3" xref="S3.E4.m1.11.11.1.1.3.cmml"><mo id="S3.E4.m1.11.11.1.1.3a" xref="S3.E4.m1.11.11.1.1.3.cmml">−</mo><mrow id="S3.E4.m1.11.11.1.1.3.2" xref="S3.E4.m1.11.11.1.1.3.2.cmml"><mfrac id="S3.E4.m1.11.11.1.1.3.2.2" xref="S3.E4.m1.11.11.1.1.3.2.2.cmml"><mn id="S3.E4.m1.11.11.1.1.3.2.2.2" xref="S3.E4.m1.11.11.1.1.3.2.2.2.cmml">1</mn><mrow id="S3.E4.m1.11.11.1.1.3.2.2.3" xref="S3.E4.m1.11.11.1.1.3.2.2.3.cmml"><mi id="S3.E4.m1.11.11.1.1.3.2.2.3.2" xref="S3.E4.m1.11.11.1.1.3.2.2.3.2.cmml">N</mi><mo lspace="0.222em" rspace="0.222em" id="S3.E4.m1.11.11.1.1.3.2.2.3.1" xref="S3.E4.m1.11.11.1.1.3.2.2.3.1.cmml">⋅</mo><mi id="S3.E4.m1.11.11.1.1.3.2.2.3.3" xref="S3.E4.m1.11.11.1.1.3.2.2.3.3.cmml">K</mi></mrow></mfrac><mo lspace="0em" rspace="0em" id="S3.E4.m1.11.11.1.1.3.2.1" xref="S3.E4.m1.11.11.1.1.3.2.1.cmml">​</mo><mrow id="S3.E4.m1.11.11.1.1.3.2.3" xref="S3.E4.m1.11.11.1.1.3.2.3.cmml"><munderover id="S3.E4.m1.11.11.1.1.3.2.3.1" xref="S3.E4.m1.11.11.1.1.3.2.3.1.cmml"><mo movablelimits="false" rspace="0em" id="S3.E4.m1.11.11.1.1.3.2.3.1.2.2" xref="S3.E4.m1.11.11.1.1.3.2.3.1.2.2.cmml">∑</mo><mrow id="S3.E4.m1.11.11.1.1.3.2.3.1.2.3" xref="S3.E4.m1.11.11.1.1.3.2.3.1.2.3.cmml"><mi id="S3.E4.m1.11.11.1.1.3.2.3.1.2.3.2" xref="S3.E4.m1.11.11.1.1.3.2.3.1.2.3.2.cmml">i</mi><mo id="S3.E4.m1.11.11.1.1.3.2.3.1.2.3.1" xref="S3.E4.m1.11.11.1.1.3.2.3.1.2.3.1.cmml">=</mo><mn id="S3.E4.m1.11.11.1.1.3.2.3.1.2.3.3" xref="S3.E4.m1.11.11.1.1.3.2.3.1.2.3.3.cmml">1</mn></mrow><mi id="S3.E4.m1.11.11.1.1.3.2.3.1.3" xref="S3.E4.m1.11.11.1.1.3.2.3.1.3.cmml">N</mi></munderover><mrow id="S3.E4.m1.11.11.1.1.3.2.3.2" xref="S3.E4.m1.11.11.1.1.3.2.3.2.cmml"><munderover id="S3.E4.m1.11.11.1.1.3.2.3.2.1" xref="S3.E4.m1.11.11.1.1.3.2.3.2.1.cmml"><mo movablelimits="false" id="S3.E4.m1.11.11.1.1.3.2.3.2.1.2.2" xref="S3.E4.m1.11.11.1.1.3.2.3.2.1.2.2.cmml">∑</mo><mrow id="S3.E4.m1.11.11.1.1.3.2.3.2.1.2.3" xref="S3.E4.m1.11.11.1.1.3.2.3.2.1.2.3.cmml"><mi id="S3.E4.m1.11.11.1.1.3.2.3.2.1.2.3.2" xref="S3.E4.m1.11.11.1.1.3.2.3.2.1.2.3.2.cmml">j</mi><mo id="S3.E4.m1.11.11.1.1.3.2.3.2.1.2.3.1" xref="S3.E4.m1.11.11.1.1.3.2.3.2.1.2.3.1.cmml">=</mo><mn id="S3.E4.m1.11.11.1.1.3.2.3.2.1.2.3.3" xref="S3.E4.m1.11.11.1.1.3.2.3.2.1.2.3.3.cmml">1</mn></mrow><mi id="S3.E4.m1.11.11.1.1.3.2.3.2.1.3" xref="S3.E4.m1.11.11.1.1.3.2.3.2.1.3.cmml">K</mi></munderover><mrow id="S3.E4.m1.11.11.1.1.3.2.3.2.2" xref="S3.E4.m1.11.11.1.1.3.2.3.2.2.cmml"><msubsup id="S3.E4.m1.11.11.1.1.3.2.3.2.2.2" xref="S3.E4.m1.11.11.1.1.3.2.3.2.2.2.cmml"><mi id="S3.E4.m1.11.11.1.1.3.2.3.2.2.2.2.2" xref="S3.E4.m1.11.11.1.1.3.2.3.2.2.2.2.2.cmml">𝐋</mi><msub id="S3.E4.m1.11.11.1.1.3.2.3.2.2.2.3" xref="S3.E4.m1.11.11.1.1.3.2.3.2.2.2.3.cmml"><mover accent="true" id="S3.E4.m1.11.11.1.1.3.2.3.2.2.2.3.2" xref="S3.E4.m1.11.11.1.1.3.2.3.2.2.2.3.2.cmml"><mi id="S3.E4.m1.11.11.1.1.3.2.3.2.2.2.3.2.2" xref="S3.E4.m1.11.11.1.1.3.2.3.2.2.2.3.2.2.cmml">c</mi><mo id="S3.E4.m1.11.11.1.1.3.2.3.2.2.2.3.2.1" xref="S3.E4.m1.11.11.1.1.3.2.3.2.2.2.3.2.1.cmml">^</mo></mover><mi id="S3.E4.m1.11.11.1.1.3.2.3.2.2.2.3.3" xref="S3.E4.m1.11.11.1.1.3.2.3.2.2.2.3.3.cmml">i</mi></msub><mrow id="S3.E4.m1.2.2.2.4" xref="S3.E4.m1.2.2.2.3.cmml"><mi id="S3.E4.m1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.cmml">i</mi><mo id="S3.E4.m1.2.2.2.4.1" xref="S3.E4.m1.2.2.2.3.cmml">,</mo><mi id="S3.E4.m1.2.2.2.2" xref="S3.E4.m1.2.2.2.2.cmml">j</mi></mrow></msubsup><mo lspace="0.222em" rspace="0.222em" id="S3.E4.m1.11.11.1.1.3.2.3.2.2.1" xref="S3.E4.m1.11.11.1.1.3.2.3.2.2.1.cmml">⋅</mo><mrow id="S3.E4.m1.11.11.1.1.3.2.3.2.2.3" xref="S3.E4.m1.11.11.1.1.3.2.3.2.2.3.cmml"><mi id="S3.E4.m1.11.11.1.1.3.2.3.2.2.3.1" xref="S3.E4.m1.11.11.1.1.3.2.3.2.2.3.1.cmml">log</mi><mo lspace="0.167em" id="S3.E4.m1.11.11.1.1.3.2.3.2.2.3a" xref="S3.E4.m1.11.11.1.1.3.2.3.2.2.3.cmml">⁡</mo><mfrac id="S3.E4.m1.10.10" xref="S3.E4.m1.10.10.cmml"><mrow id="S3.E4.m1.6.6.4.4" xref="S3.E4.m1.6.6.4.5.cmml"><mi id="S3.E4.m1.5.5.3.3" xref="S3.E4.m1.5.5.3.3.cmml">exp</mi><mo id="S3.E4.m1.6.6.4.4a" xref="S3.E4.m1.6.6.4.5.cmml">⁡</mo><mrow id="S3.E4.m1.6.6.4.4.1" xref="S3.E4.m1.6.6.4.5.cmml"><mo id="S3.E4.m1.6.6.4.4.1.2" xref="S3.E4.m1.6.6.4.5.cmml">(</mo><mrow id="S3.E4.m1.6.6.4.4.1.1" xref="S3.E4.m1.6.6.4.4.1.1.cmml"><mrow id="S3.E4.m1.6.6.4.4.1.1.2" xref="S3.E4.m1.6.6.4.4.1.1.2.cmml"><msub id="S3.E4.m1.6.6.4.4.1.1.2.2" xref="S3.E4.m1.6.6.4.4.1.1.2.2.cmml"><mi id="S3.E4.m1.6.6.4.4.1.1.2.2.2" xref="S3.E4.m1.6.6.4.4.1.1.2.2.2.cmml">𝐳</mi><mi id="S3.E4.m1.6.6.4.4.1.1.2.2.3" xref="S3.E4.m1.6.6.4.4.1.1.2.2.3.cmml">i</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S3.E4.m1.6.6.4.4.1.1.2.1" xref="S3.E4.m1.6.6.4.4.1.1.2.1.cmml">⋅</mo><msub id="S3.E4.m1.6.6.4.4.1.1.2.3" xref="S3.E4.m1.6.6.4.4.1.1.2.3.cmml"><mi id="S3.E4.m1.6.6.4.4.1.1.2.3.2" xref="S3.E4.m1.6.6.4.4.1.1.2.3.2.cmml">𝐩</mi><mrow id="S3.E4.m1.4.4.2.2.2.2" xref="S3.E4.m1.4.4.2.2.2.3.cmml"><msub id="S3.E4.m1.4.4.2.2.2.2.1" xref="S3.E4.m1.4.4.2.2.2.2.1.cmml"><mover accent="true" id="S3.E4.m1.4.4.2.2.2.2.1.2" xref="S3.E4.m1.4.4.2.2.2.2.1.2.cmml"><mi id="S3.E4.m1.4.4.2.2.2.2.1.2.2" xref="S3.E4.m1.4.4.2.2.2.2.1.2.2.cmml">c</mi><mo id="S3.E4.m1.4.4.2.2.2.2.1.2.1" xref="S3.E4.m1.4.4.2.2.2.2.1.2.1.cmml">^</mo></mover><mi id="S3.E4.m1.4.4.2.2.2.2.1.3" xref="S3.E4.m1.4.4.2.2.2.2.1.3.cmml">i</mi></msub><mo id="S3.E4.m1.4.4.2.2.2.2.2" xref="S3.E4.m1.4.4.2.2.2.3.cmml">,</mo><mi id="S3.E4.m1.3.3.1.1.1.1" xref="S3.E4.m1.3.3.1.1.1.1.cmml">j</mi></mrow></msub></mrow><mo id="S3.E4.m1.6.6.4.4.1.1.1" xref="S3.E4.m1.6.6.4.4.1.1.1.cmml">/</mo><mi id="S3.E4.m1.6.6.4.4.1.1.3" xref="S3.E4.m1.6.6.4.4.1.1.3.cmml">τ</mi></mrow><mo id="S3.E4.m1.6.6.4.4.1.3" xref="S3.E4.m1.6.6.4.5.cmml">)</mo></mrow></mrow><mrow id="S3.E4.m1.10.10.8" xref="S3.E4.m1.10.10.8.cmml"><msubsup id="S3.E4.m1.10.10.8.5" xref="S3.E4.m1.10.10.8.5.cmml"><mo id="S3.E4.m1.10.10.8.5.2.2" xref="S3.E4.m1.10.10.8.5.2.2.cmml">∑</mo><mi id="S3.E4.m1.10.10.8.5.2.3" xref="S3.E4.m1.10.10.8.5.2.3.cmml">c</mi><mi id="S3.E4.m1.10.10.8.5.3" xref="S3.E4.m1.10.10.8.5.3.cmml">C</mi></msubsup><mrow id="S3.E4.m1.10.10.8.4" xref="S3.E4.m1.10.10.8.4.cmml"><msubsup id="S3.E4.m1.10.10.8.4.2" xref="S3.E4.m1.10.10.8.4.2.cmml"><mo lspace="0.167em" id="S3.E4.m1.10.10.8.4.2.2.2" xref="S3.E4.m1.10.10.8.4.2.2.2.cmml">∑</mo><mi id="S3.E4.m1.10.10.8.4.2.2.3" xref="S3.E4.m1.10.10.8.4.2.2.3.cmml">k</mi><mi id="S3.E4.m1.10.10.8.4.2.3" xref="S3.E4.m1.10.10.8.4.2.3.cmml">K</mi></msubsup><mrow id="S3.E4.m1.10.10.8.4.1.1" xref="S3.E4.m1.10.10.8.4.1.2.cmml"><mi id="S3.E4.m1.9.9.7.3" xref="S3.E4.m1.9.9.7.3.cmml">exp</mi><mo id="S3.E4.m1.10.10.8.4.1.1a" xref="S3.E4.m1.10.10.8.4.1.2.cmml">⁡</mo><mrow id="S3.E4.m1.10.10.8.4.1.1.1" xref="S3.E4.m1.10.10.8.4.1.2.cmml"><mo id="S3.E4.m1.10.10.8.4.1.1.1.2" xref="S3.E4.m1.10.10.8.4.1.2.cmml">(</mo><mrow id="S3.E4.m1.10.10.8.4.1.1.1.1" xref="S3.E4.m1.10.10.8.4.1.1.1.1.cmml"><mrow id="S3.E4.m1.10.10.8.4.1.1.1.1.2" xref="S3.E4.m1.10.10.8.4.1.1.1.1.2.cmml"><msub id="S3.E4.m1.10.10.8.4.1.1.1.1.2.2" xref="S3.E4.m1.10.10.8.4.1.1.1.1.2.2.cmml"><mi id="S3.E4.m1.10.10.8.4.1.1.1.1.2.2.2" xref="S3.E4.m1.10.10.8.4.1.1.1.1.2.2.2.cmml">𝐳</mi><mi id="S3.E4.m1.10.10.8.4.1.1.1.1.2.2.3" xref="S3.E4.m1.10.10.8.4.1.1.1.1.2.2.3.cmml">i</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S3.E4.m1.10.10.8.4.1.1.1.1.2.1" xref="S3.E4.m1.10.10.8.4.1.1.1.1.2.1.cmml">⋅</mo><msub id="S3.E4.m1.10.10.8.4.1.1.1.1.2.3" xref="S3.E4.m1.10.10.8.4.1.1.1.1.2.3.cmml"><mi id="S3.E4.m1.10.10.8.4.1.1.1.1.2.3.2" xref="S3.E4.m1.10.10.8.4.1.1.1.1.2.3.2.cmml">𝐩</mi><mrow id="S3.E4.m1.8.8.6.2.2.4" xref="S3.E4.m1.8.8.6.2.2.3.cmml"><mi id="S3.E4.m1.7.7.5.1.1.1" xref="S3.E4.m1.7.7.5.1.1.1.cmml">c</mi><mo id="S3.E4.m1.8.8.6.2.2.4.1" xref="S3.E4.m1.8.8.6.2.2.3.cmml">,</mo><mi id="S3.E4.m1.8.8.6.2.2.2" xref="S3.E4.m1.8.8.6.2.2.2.cmml">k</mi></mrow></msub></mrow><mo id="S3.E4.m1.10.10.8.4.1.1.1.1.1" xref="S3.E4.m1.10.10.8.4.1.1.1.1.1.cmml">/</mo><mi id="S3.E4.m1.10.10.8.4.1.1.1.1.3" xref="S3.E4.m1.10.10.8.4.1.1.1.1.3.cmml">τ</mi></mrow><mo id="S3.E4.m1.10.10.8.4.1.1.1.3" xref="S3.E4.m1.10.10.8.4.1.2.cmml">)</mo></mrow></mrow></mrow></mrow></mfrac></mrow></mrow></mrow></mrow></mrow></mrow></mrow><mo id="S3.E4.m1.11.11.1.2" xref="S3.E4.m1.11.11.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.11b"><apply id="S3.E4.m1.11.11.1.1.cmml" xref="S3.E4.m1.11.11.1"><eq id="S3.E4.m1.11.11.1.1.1.cmml" xref="S3.E4.m1.11.11.1.1.1"></eq><apply id="S3.E4.m1.11.11.1.1.2.cmml" xref="S3.E4.m1.11.11.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.11.11.1.1.2.1.cmml" xref="S3.E4.m1.11.11.1.1.2">subscript</csymbol><ci id="S3.E4.m1.11.11.1.1.2.2.cmml" xref="S3.E4.m1.11.11.1.1.2.2">ℒ</ci><apply id="S3.E4.m1.11.11.1.1.2.3.cmml" xref="S3.E4.m1.11.11.1.1.2.3"><times id="S3.E4.m1.11.11.1.1.2.3.1.cmml" xref="S3.E4.m1.11.11.1.1.2.3.1"></times><ci id="S3.E4.m1.11.11.1.1.2.3.2.cmml" xref="S3.E4.m1.11.11.1.1.2.3.2">𝑖</ci><ci id="S3.E4.m1.11.11.1.1.2.3.3.cmml" xref="S3.E4.m1.11.11.1.1.2.3.3">𝑛</ci><ci id="S3.E4.m1.11.11.1.1.2.3.4.cmml" xref="S3.E4.m1.11.11.1.1.2.3.4">𝑠</ci><ci id="S3.E4.m1.11.11.1.1.2.3.5.cmml" xref="S3.E4.m1.11.11.1.1.2.3.5">𝑡</ci></apply></apply><apply id="S3.E4.m1.11.11.1.1.3.cmml" xref="S3.E4.m1.11.11.1.1.3"><minus id="S3.E4.m1.11.11.1.1.3.1.cmml" xref="S3.E4.m1.11.11.1.1.3"></minus><apply id="S3.E4.m1.11.11.1.1.3.2.cmml" xref="S3.E4.m1.11.11.1.1.3.2"><times id="S3.E4.m1.11.11.1.1.3.2.1.cmml" xref="S3.E4.m1.11.11.1.1.3.2.1"></times><apply id="S3.E4.m1.11.11.1.1.3.2.2.cmml" xref="S3.E4.m1.11.11.1.1.3.2.2"><divide id="S3.E4.m1.11.11.1.1.3.2.2.1.cmml" xref="S3.E4.m1.11.11.1.1.3.2.2"></divide><cn type="integer" id="S3.E4.m1.11.11.1.1.3.2.2.2.cmml" xref="S3.E4.m1.11.11.1.1.3.2.2.2">1</cn><apply id="S3.E4.m1.11.11.1.1.3.2.2.3.cmml" xref="S3.E4.m1.11.11.1.1.3.2.2.3"><ci id="S3.E4.m1.11.11.1.1.3.2.2.3.1.cmml" xref="S3.E4.m1.11.11.1.1.3.2.2.3.1">⋅</ci><ci id="S3.E4.m1.11.11.1.1.3.2.2.3.2.cmml" xref="S3.E4.m1.11.11.1.1.3.2.2.3.2">𝑁</ci><ci id="S3.E4.m1.11.11.1.1.3.2.2.3.3.cmml" xref="S3.E4.m1.11.11.1.1.3.2.2.3.3">𝐾</ci></apply></apply><apply id="S3.E4.m1.11.11.1.1.3.2.3.cmml" xref="S3.E4.m1.11.11.1.1.3.2.3"><apply id="S3.E4.m1.11.11.1.1.3.2.3.1.cmml" xref="S3.E4.m1.11.11.1.1.3.2.3.1"><csymbol cd="ambiguous" id="S3.E4.m1.11.11.1.1.3.2.3.1.1.cmml" xref="S3.E4.m1.11.11.1.1.3.2.3.1">superscript</csymbol><apply id="S3.E4.m1.11.11.1.1.3.2.3.1.2.cmml" xref="S3.E4.m1.11.11.1.1.3.2.3.1"><csymbol cd="ambiguous" id="S3.E4.m1.11.11.1.1.3.2.3.1.2.1.cmml" xref="S3.E4.m1.11.11.1.1.3.2.3.1">subscript</csymbol><sum id="S3.E4.m1.11.11.1.1.3.2.3.1.2.2.cmml" xref="S3.E4.m1.11.11.1.1.3.2.3.1.2.2"></sum><apply id="S3.E4.m1.11.11.1.1.3.2.3.1.2.3.cmml" xref="S3.E4.m1.11.11.1.1.3.2.3.1.2.3"><eq id="S3.E4.m1.11.11.1.1.3.2.3.1.2.3.1.cmml" xref="S3.E4.m1.11.11.1.1.3.2.3.1.2.3.1"></eq><ci id="S3.E4.m1.11.11.1.1.3.2.3.1.2.3.2.cmml" xref="S3.E4.m1.11.11.1.1.3.2.3.1.2.3.2">𝑖</ci><cn type="integer" id="S3.E4.m1.11.11.1.1.3.2.3.1.2.3.3.cmml" xref="S3.E4.m1.11.11.1.1.3.2.3.1.2.3.3">1</cn></apply></apply><ci id="S3.E4.m1.11.11.1.1.3.2.3.1.3.cmml" xref="S3.E4.m1.11.11.1.1.3.2.3.1.3">𝑁</ci></apply><apply id="S3.E4.m1.11.11.1.1.3.2.3.2.cmml" xref="S3.E4.m1.11.11.1.1.3.2.3.2"><apply id="S3.E4.m1.11.11.1.1.3.2.3.2.1.cmml" xref="S3.E4.m1.11.11.1.1.3.2.3.2.1"><csymbol cd="ambiguous" id="S3.E4.m1.11.11.1.1.3.2.3.2.1.1.cmml" xref="S3.E4.m1.11.11.1.1.3.2.3.2.1">superscript</csymbol><apply id="S3.E4.m1.11.11.1.1.3.2.3.2.1.2.cmml" xref="S3.E4.m1.11.11.1.1.3.2.3.2.1"><csymbol cd="ambiguous" id="S3.E4.m1.11.11.1.1.3.2.3.2.1.2.1.cmml" xref="S3.E4.m1.11.11.1.1.3.2.3.2.1">subscript</csymbol><sum id="S3.E4.m1.11.11.1.1.3.2.3.2.1.2.2.cmml" xref="S3.E4.m1.11.11.1.1.3.2.3.2.1.2.2"></sum><apply id="S3.E4.m1.11.11.1.1.3.2.3.2.1.2.3.cmml" xref="S3.E4.m1.11.11.1.1.3.2.3.2.1.2.3"><eq id="S3.E4.m1.11.11.1.1.3.2.3.2.1.2.3.1.cmml" xref="S3.E4.m1.11.11.1.1.3.2.3.2.1.2.3.1"></eq><ci id="S3.E4.m1.11.11.1.1.3.2.3.2.1.2.3.2.cmml" xref="S3.E4.m1.11.11.1.1.3.2.3.2.1.2.3.2">𝑗</ci><cn type="integer" id="S3.E4.m1.11.11.1.1.3.2.3.2.1.2.3.3.cmml" xref="S3.E4.m1.11.11.1.1.3.2.3.2.1.2.3.3">1</cn></apply></apply><ci id="S3.E4.m1.11.11.1.1.3.2.3.2.1.3.cmml" xref="S3.E4.m1.11.11.1.1.3.2.3.2.1.3">𝐾</ci></apply><apply id="S3.E4.m1.11.11.1.1.3.2.3.2.2.cmml" xref="S3.E4.m1.11.11.1.1.3.2.3.2.2"><ci id="S3.E4.m1.11.11.1.1.3.2.3.2.2.1.cmml" xref="S3.E4.m1.11.11.1.1.3.2.3.2.2.1">⋅</ci><apply id="S3.E4.m1.11.11.1.1.3.2.3.2.2.2.cmml" xref="S3.E4.m1.11.11.1.1.3.2.3.2.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.11.11.1.1.3.2.3.2.2.2.1.cmml" xref="S3.E4.m1.11.11.1.1.3.2.3.2.2.2">subscript</csymbol><apply id="S3.E4.m1.11.11.1.1.3.2.3.2.2.2.2.cmml" xref="S3.E4.m1.11.11.1.1.3.2.3.2.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.11.11.1.1.3.2.3.2.2.2.2.1.cmml" xref="S3.E4.m1.11.11.1.1.3.2.3.2.2.2">superscript</csymbol><ci id="S3.E4.m1.11.11.1.1.3.2.3.2.2.2.2.2.cmml" xref="S3.E4.m1.11.11.1.1.3.2.3.2.2.2.2.2">𝐋</ci><list id="S3.E4.m1.2.2.2.3.cmml" xref="S3.E4.m1.2.2.2.4"><ci id="S3.E4.m1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1">𝑖</ci><ci id="S3.E4.m1.2.2.2.2.cmml" xref="S3.E4.m1.2.2.2.2">𝑗</ci></list></apply><apply id="S3.E4.m1.11.11.1.1.3.2.3.2.2.2.3.cmml" xref="S3.E4.m1.11.11.1.1.3.2.3.2.2.2.3"><csymbol cd="ambiguous" id="S3.E4.m1.11.11.1.1.3.2.3.2.2.2.3.1.cmml" xref="S3.E4.m1.11.11.1.1.3.2.3.2.2.2.3">subscript</csymbol><apply id="S3.E4.m1.11.11.1.1.3.2.3.2.2.2.3.2.cmml" xref="S3.E4.m1.11.11.1.1.3.2.3.2.2.2.3.2"><ci id="S3.E4.m1.11.11.1.1.3.2.3.2.2.2.3.2.1.cmml" xref="S3.E4.m1.11.11.1.1.3.2.3.2.2.2.3.2.1">^</ci><ci id="S3.E4.m1.11.11.1.1.3.2.3.2.2.2.3.2.2.cmml" xref="S3.E4.m1.11.11.1.1.3.2.3.2.2.2.3.2.2">𝑐</ci></apply><ci id="S3.E4.m1.11.11.1.1.3.2.3.2.2.2.3.3.cmml" xref="S3.E4.m1.11.11.1.1.3.2.3.2.2.2.3.3">𝑖</ci></apply></apply><apply id="S3.E4.m1.11.11.1.1.3.2.3.2.2.3.cmml" xref="S3.E4.m1.11.11.1.1.3.2.3.2.2.3"><log id="S3.E4.m1.11.11.1.1.3.2.3.2.2.3.1.cmml" xref="S3.E4.m1.11.11.1.1.3.2.3.2.2.3.1"></log><apply id="S3.E4.m1.10.10.cmml" xref="S3.E4.m1.10.10"><divide id="S3.E4.m1.10.10.9.cmml" xref="S3.E4.m1.10.10"></divide><apply id="S3.E4.m1.6.6.4.5.cmml" xref="S3.E4.m1.6.6.4.4"><exp id="S3.E4.m1.5.5.3.3.cmml" xref="S3.E4.m1.5.5.3.3"></exp><apply id="S3.E4.m1.6.6.4.4.1.1.cmml" xref="S3.E4.m1.6.6.4.4.1.1"><divide id="S3.E4.m1.6.6.4.4.1.1.1.cmml" xref="S3.E4.m1.6.6.4.4.1.1.1"></divide><apply id="S3.E4.m1.6.6.4.4.1.1.2.cmml" xref="S3.E4.m1.6.6.4.4.1.1.2"><ci id="S3.E4.m1.6.6.4.4.1.1.2.1.cmml" xref="S3.E4.m1.6.6.4.4.1.1.2.1">⋅</ci><apply id="S3.E4.m1.6.6.4.4.1.1.2.2.cmml" xref="S3.E4.m1.6.6.4.4.1.1.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.6.6.4.4.1.1.2.2.1.cmml" xref="S3.E4.m1.6.6.4.4.1.1.2.2">subscript</csymbol><ci id="S3.E4.m1.6.6.4.4.1.1.2.2.2.cmml" xref="S3.E4.m1.6.6.4.4.1.1.2.2.2">𝐳</ci><ci id="S3.E4.m1.6.6.4.4.1.1.2.2.3.cmml" xref="S3.E4.m1.6.6.4.4.1.1.2.2.3">𝑖</ci></apply><apply id="S3.E4.m1.6.6.4.4.1.1.2.3.cmml" xref="S3.E4.m1.6.6.4.4.1.1.2.3"><csymbol cd="ambiguous" id="S3.E4.m1.6.6.4.4.1.1.2.3.1.cmml" xref="S3.E4.m1.6.6.4.4.1.1.2.3">subscript</csymbol><ci id="S3.E4.m1.6.6.4.4.1.1.2.3.2.cmml" xref="S3.E4.m1.6.6.4.4.1.1.2.3.2">𝐩</ci><list id="S3.E4.m1.4.4.2.2.2.3.cmml" xref="S3.E4.m1.4.4.2.2.2.2"><apply id="S3.E4.m1.4.4.2.2.2.2.1.cmml" xref="S3.E4.m1.4.4.2.2.2.2.1"><csymbol cd="ambiguous" id="S3.E4.m1.4.4.2.2.2.2.1.1.cmml" xref="S3.E4.m1.4.4.2.2.2.2.1">subscript</csymbol><apply id="S3.E4.m1.4.4.2.2.2.2.1.2.cmml" xref="S3.E4.m1.4.4.2.2.2.2.1.2"><ci id="S3.E4.m1.4.4.2.2.2.2.1.2.1.cmml" xref="S3.E4.m1.4.4.2.2.2.2.1.2.1">^</ci><ci id="S3.E4.m1.4.4.2.2.2.2.1.2.2.cmml" xref="S3.E4.m1.4.4.2.2.2.2.1.2.2">𝑐</ci></apply><ci id="S3.E4.m1.4.4.2.2.2.2.1.3.cmml" xref="S3.E4.m1.4.4.2.2.2.2.1.3">𝑖</ci></apply><ci id="S3.E4.m1.3.3.1.1.1.1.cmml" xref="S3.E4.m1.3.3.1.1.1.1">𝑗</ci></list></apply></apply><ci id="S3.E4.m1.6.6.4.4.1.1.3.cmml" xref="S3.E4.m1.6.6.4.4.1.1.3">𝜏</ci></apply></apply><apply id="S3.E4.m1.10.10.8.cmml" xref="S3.E4.m1.10.10.8"><apply id="S3.E4.m1.10.10.8.5.cmml" xref="S3.E4.m1.10.10.8.5"><csymbol cd="ambiguous" id="S3.E4.m1.10.10.8.5.1.cmml" xref="S3.E4.m1.10.10.8.5">superscript</csymbol><apply id="S3.E4.m1.10.10.8.5.2.cmml" xref="S3.E4.m1.10.10.8.5"><csymbol cd="ambiguous" id="S3.E4.m1.10.10.8.5.2.1.cmml" xref="S3.E4.m1.10.10.8.5">subscript</csymbol><sum id="S3.E4.m1.10.10.8.5.2.2.cmml" xref="S3.E4.m1.10.10.8.5.2.2"></sum><ci id="S3.E4.m1.10.10.8.5.2.3.cmml" xref="S3.E4.m1.10.10.8.5.2.3">𝑐</ci></apply><ci id="S3.E4.m1.10.10.8.5.3.cmml" xref="S3.E4.m1.10.10.8.5.3">𝐶</ci></apply><apply id="S3.E4.m1.10.10.8.4.cmml" xref="S3.E4.m1.10.10.8.4"><apply id="S3.E4.m1.10.10.8.4.2.cmml" xref="S3.E4.m1.10.10.8.4.2"><csymbol cd="ambiguous" id="S3.E4.m1.10.10.8.4.2.1.cmml" xref="S3.E4.m1.10.10.8.4.2">superscript</csymbol><apply id="S3.E4.m1.10.10.8.4.2.2.cmml" xref="S3.E4.m1.10.10.8.4.2"><csymbol cd="ambiguous" id="S3.E4.m1.10.10.8.4.2.2.1.cmml" xref="S3.E4.m1.10.10.8.4.2">subscript</csymbol><sum id="S3.E4.m1.10.10.8.4.2.2.2.cmml" xref="S3.E4.m1.10.10.8.4.2.2.2"></sum><ci id="S3.E4.m1.10.10.8.4.2.2.3.cmml" xref="S3.E4.m1.10.10.8.4.2.2.3">𝑘</ci></apply><ci id="S3.E4.m1.10.10.8.4.2.3.cmml" xref="S3.E4.m1.10.10.8.4.2.3">𝐾</ci></apply><apply id="S3.E4.m1.10.10.8.4.1.2.cmml" xref="S3.E4.m1.10.10.8.4.1.1"><exp id="S3.E4.m1.9.9.7.3.cmml" xref="S3.E4.m1.9.9.7.3"></exp><apply id="S3.E4.m1.10.10.8.4.1.1.1.1.cmml" xref="S3.E4.m1.10.10.8.4.1.1.1.1"><divide id="S3.E4.m1.10.10.8.4.1.1.1.1.1.cmml" xref="S3.E4.m1.10.10.8.4.1.1.1.1.1"></divide><apply id="S3.E4.m1.10.10.8.4.1.1.1.1.2.cmml" xref="S3.E4.m1.10.10.8.4.1.1.1.1.2"><ci id="S3.E4.m1.10.10.8.4.1.1.1.1.2.1.cmml" xref="S3.E4.m1.10.10.8.4.1.1.1.1.2.1">⋅</ci><apply id="S3.E4.m1.10.10.8.4.1.1.1.1.2.2.cmml" xref="S3.E4.m1.10.10.8.4.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.10.10.8.4.1.1.1.1.2.2.1.cmml" xref="S3.E4.m1.10.10.8.4.1.1.1.1.2.2">subscript</csymbol><ci id="S3.E4.m1.10.10.8.4.1.1.1.1.2.2.2.cmml" xref="S3.E4.m1.10.10.8.4.1.1.1.1.2.2.2">𝐳</ci><ci id="S3.E4.m1.10.10.8.4.1.1.1.1.2.2.3.cmml" xref="S3.E4.m1.10.10.8.4.1.1.1.1.2.2.3">𝑖</ci></apply><apply id="S3.E4.m1.10.10.8.4.1.1.1.1.2.3.cmml" xref="S3.E4.m1.10.10.8.4.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E4.m1.10.10.8.4.1.1.1.1.2.3.1.cmml" xref="S3.E4.m1.10.10.8.4.1.1.1.1.2.3">subscript</csymbol><ci id="S3.E4.m1.10.10.8.4.1.1.1.1.2.3.2.cmml" xref="S3.E4.m1.10.10.8.4.1.1.1.1.2.3.2">𝐩</ci><list id="S3.E4.m1.8.8.6.2.2.3.cmml" xref="S3.E4.m1.8.8.6.2.2.4"><ci id="S3.E4.m1.7.7.5.1.1.1.cmml" xref="S3.E4.m1.7.7.5.1.1.1">𝑐</ci><ci id="S3.E4.m1.8.8.6.2.2.2.cmml" xref="S3.E4.m1.8.8.6.2.2.2">𝑘</ci></list></apply></apply><ci id="S3.E4.m1.10.10.8.4.1.1.1.1.3.cmml" xref="S3.E4.m1.10.10.8.4.1.1.1.1.3">𝜏</ci></apply></apply></apply></apply></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.11c">\mathcal{L}_{inst}=-\frac{1}{N\cdot K}\sum_{i=1}^{N}\sum_{j=1}^{K}\mathbf{L}^{i,j}_{\hat{c}_{i}}\cdot\log\frac{\exp{\left(\mathbf{z}_{i}\cdot\mathbf{p}_{\hat{c}_{i},j}/\tau\right)}}{\sum_{c}^{C}\sum_{k}^{K}\exp{\left(\mathbf{z}_{i}\cdot\mathbf{p}_{c,k}/\tau\right)}},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p id="S3.SS3.p6.9" class="ltx_p">where <math id="S3.SS3.p6.1.m1.1" class="ltx_Math" alttext="\hat{c}_{i}" display="inline"><semantics id="S3.SS3.p6.1.m1.1a"><msub id="S3.SS3.p6.1.m1.1.1" xref="S3.SS3.p6.1.m1.1.1.cmml"><mover accent="true" id="S3.SS3.p6.1.m1.1.1.2" xref="S3.SS3.p6.1.m1.1.1.2.cmml"><mi id="S3.SS3.p6.1.m1.1.1.2.2" xref="S3.SS3.p6.1.m1.1.1.2.2.cmml">c</mi><mo id="S3.SS3.p6.1.m1.1.1.2.1" xref="S3.SS3.p6.1.m1.1.1.2.1.cmml">^</mo></mover><mi id="S3.SS3.p6.1.m1.1.1.3" xref="S3.SS3.p6.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p6.1.m1.1b"><apply id="S3.SS3.p6.1.m1.1.1.cmml" xref="S3.SS3.p6.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p6.1.m1.1.1.1.cmml" xref="S3.SS3.p6.1.m1.1.1">subscript</csymbol><apply id="S3.SS3.p6.1.m1.1.1.2.cmml" xref="S3.SS3.p6.1.m1.1.1.2"><ci id="S3.SS3.p6.1.m1.1.1.2.1.cmml" xref="S3.SS3.p6.1.m1.1.1.2.1">^</ci><ci id="S3.SS3.p6.1.m1.1.1.2.2.cmml" xref="S3.SS3.p6.1.m1.1.1.2.2">𝑐</ci></apply><ci id="S3.SS3.p6.1.m1.1.1.3.cmml" xref="S3.SS3.p6.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p6.1.m1.1c">\hat{c}_{i}</annotation></semantics></math> is the pseudo-label for the <math id="S3.SS3.p6.2.m2.1" class="ltx_Math" alttext="i^{th}" display="inline"><semantics id="S3.SS3.p6.2.m2.1a"><msup id="S3.SS3.p6.2.m2.1.1" xref="S3.SS3.p6.2.m2.1.1.cmml"><mi id="S3.SS3.p6.2.m2.1.1.2" xref="S3.SS3.p6.2.m2.1.1.2.cmml">i</mi><mrow id="S3.SS3.p6.2.m2.1.1.3" xref="S3.SS3.p6.2.m2.1.1.3.cmml"><mi id="S3.SS3.p6.2.m2.1.1.3.2" xref="S3.SS3.p6.2.m2.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p6.2.m2.1.1.3.1" xref="S3.SS3.p6.2.m2.1.1.3.1.cmml">​</mo><mi id="S3.SS3.p6.2.m2.1.1.3.3" xref="S3.SS3.p6.2.m2.1.1.3.3.cmml">h</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p6.2.m2.1b"><apply id="S3.SS3.p6.2.m2.1.1.cmml" xref="S3.SS3.p6.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p6.2.m2.1.1.1.cmml" xref="S3.SS3.p6.2.m2.1.1">superscript</csymbol><ci id="S3.SS3.p6.2.m2.1.1.2.cmml" xref="S3.SS3.p6.2.m2.1.1.2">𝑖</ci><apply id="S3.SS3.p6.2.m2.1.1.3.cmml" xref="S3.SS3.p6.2.m2.1.1.3"><times id="S3.SS3.p6.2.m2.1.1.3.1.cmml" xref="S3.SS3.p6.2.m2.1.1.3.1"></times><ci id="S3.SS3.p6.2.m2.1.1.3.2.cmml" xref="S3.SS3.p6.2.m2.1.1.3.2">𝑡</ci><ci id="S3.SS3.p6.2.m2.1.1.3.3.cmml" xref="S3.SS3.p6.2.m2.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p6.2.m2.1c">i^{th}</annotation></semantics></math> instance, and <math id="S3.SS3.p6.3.m3.2" class="ltx_Math" alttext="\mathbf{L}^{i,j}_{\hat{c}_{i}}" display="inline"><semantics id="S3.SS3.p6.3.m3.2a"><msubsup id="S3.SS3.p6.3.m3.2.3" xref="S3.SS3.p6.3.m3.2.3.cmml"><mi id="S3.SS3.p6.3.m3.2.3.2.2" xref="S3.SS3.p6.3.m3.2.3.2.2.cmml">𝐋</mi><msub id="S3.SS3.p6.3.m3.2.3.3" xref="S3.SS3.p6.3.m3.2.3.3.cmml"><mover accent="true" id="S3.SS3.p6.3.m3.2.3.3.2" xref="S3.SS3.p6.3.m3.2.3.3.2.cmml"><mi id="S3.SS3.p6.3.m3.2.3.3.2.2" xref="S3.SS3.p6.3.m3.2.3.3.2.2.cmml">c</mi><mo id="S3.SS3.p6.3.m3.2.3.3.2.1" xref="S3.SS3.p6.3.m3.2.3.3.2.1.cmml">^</mo></mover><mi id="S3.SS3.p6.3.m3.2.3.3.3" xref="S3.SS3.p6.3.m3.2.3.3.3.cmml">i</mi></msub><mrow id="S3.SS3.p6.3.m3.2.2.2.4" xref="S3.SS3.p6.3.m3.2.2.2.3.cmml"><mi id="S3.SS3.p6.3.m3.1.1.1.1" xref="S3.SS3.p6.3.m3.1.1.1.1.cmml">i</mi><mo id="S3.SS3.p6.3.m3.2.2.2.4.1" xref="S3.SS3.p6.3.m3.2.2.2.3.cmml">,</mo><mi id="S3.SS3.p6.3.m3.2.2.2.2" xref="S3.SS3.p6.3.m3.2.2.2.2.cmml">j</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.p6.3.m3.2b"><apply id="S3.SS3.p6.3.m3.2.3.cmml" xref="S3.SS3.p6.3.m3.2.3"><csymbol cd="ambiguous" id="S3.SS3.p6.3.m3.2.3.1.cmml" xref="S3.SS3.p6.3.m3.2.3">subscript</csymbol><apply id="S3.SS3.p6.3.m3.2.3.2.cmml" xref="S3.SS3.p6.3.m3.2.3"><csymbol cd="ambiguous" id="S3.SS3.p6.3.m3.2.3.2.1.cmml" xref="S3.SS3.p6.3.m3.2.3">superscript</csymbol><ci id="S3.SS3.p6.3.m3.2.3.2.2.cmml" xref="S3.SS3.p6.3.m3.2.3.2.2">𝐋</ci><list id="S3.SS3.p6.3.m3.2.2.2.3.cmml" xref="S3.SS3.p6.3.m3.2.2.2.4"><ci id="S3.SS3.p6.3.m3.1.1.1.1.cmml" xref="S3.SS3.p6.3.m3.1.1.1.1">𝑖</ci><ci id="S3.SS3.p6.3.m3.2.2.2.2.cmml" xref="S3.SS3.p6.3.m3.2.2.2.2">𝑗</ci></list></apply><apply id="S3.SS3.p6.3.m3.2.3.3.cmml" xref="S3.SS3.p6.3.m3.2.3.3"><csymbol cd="ambiguous" id="S3.SS3.p6.3.m3.2.3.3.1.cmml" xref="S3.SS3.p6.3.m3.2.3.3">subscript</csymbol><apply id="S3.SS3.p6.3.m3.2.3.3.2.cmml" xref="S3.SS3.p6.3.m3.2.3.3.2"><ci id="S3.SS3.p6.3.m3.2.3.3.2.1.cmml" xref="S3.SS3.p6.3.m3.2.3.3.2.1">^</ci><ci id="S3.SS3.p6.3.m3.2.3.3.2.2.cmml" xref="S3.SS3.p6.3.m3.2.3.3.2.2">𝑐</ci></apply><ci id="S3.SS3.p6.3.m3.2.3.3.3.cmml" xref="S3.SS3.p6.3.m3.2.3.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p6.3.m3.2c">\mathbf{L}^{i,j}_{\hat{c}_{i}}</annotation></semantics></math> is a soft assignment of the instance to the <math id="S3.SS3.p6.4.m4.1" class="ltx_Math" alttext="j^{th}" display="inline"><semantics id="S3.SS3.p6.4.m4.1a"><msup id="S3.SS3.p6.4.m4.1.1" xref="S3.SS3.p6.4.m4.1.1.cmml"><mi id="S3.SS3.p6.4.m4.1.1.2" xref="S3.SS3.p6.4.m4.1.1.2.cmml">j</mi><mrow id="S3.SS3.p6.4.m4.1.1.3" xref="S3.SS3.p6.4.m4.1.1.3.cmml"><mi id="S3.SS3.p6.4.m4.1.1.3.2" xref="S3.SS3.p6.4.m4.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p6.4.m4.1.1.3.1" xref="S3.SS3.p6.4.m4.1.1.3.1.cmml">​</mo><mi id="S3.SS3.p6.4.m4.1.1.3.3" xref="S3.SS3.p6.4.m4.1.1.3.3.cmml">h</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p6.4.m4.1b"><apply id="S3.SS3.p6.4.m4.1.1.cmml" xref="S3.SS3.p6.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.p6.4.m4.1.1.1.cmml" xref="S3.SS3.p6.4.m4.1.1">superscript</csymbol><ci id="S3.SS3.p6.4.m4.1.1.2.cmml" xref="S3.SS3.p6.4.m4.1.1.2">𝑗</ci><apply id="S3.SS3.p6.4.m4.1.1.3.cmml" xref="S3.SS3.p6.4.m4.1.1.3"><times id="S3.SS3.p6.4.m4.1.1.3.1.cmml" xref="S3.SS3.p6.4.m4.1.1.3.1"></times><ci id="S3.SS3.p6.4.m4.1.1.3.2.cmml" xref="S3.SS3.p6.4.m4.1.1.3.2">𝑡</ci><ci id="S3.SS3.p6.4.m4.1.1.3.3.cmml" xref="S3.SS3.p6.4.m4.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p6.4.m4.1c">j^{th}</annotation></semantics></math> prototype of the pseudo-labeled class. Also, <math id="S3.SS3.p6.5.m5.1" class="ltx_Math" alttext="\tau" display="inline"><semantics id="S3.SS3.p6.5.m5.1a"><mi id="S3.SS3.p6.5.m5.1.1" xref="S3.SS3.p6.5.m5.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p6.5.m5.1b"><ci id="S3.SS3.p6.5.m5.1.1.cmml" xref="S3.SS3.p6.5.m5.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p6.5.m5.1c">\tau</annotation></semantics></math> is a temperature parameter, and <math id="S3.SS3.p6.6.m6.1" class="ltx_Math" alttext="C" display="inline"><semantics id="S3.SS3.p6.6.m6.1a"><mi id="S3.SS3.p6.6.m6.1.1" xref="S3.SS3.p6.6.m6.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p6.6.m6.1b"><ci id="S3.SS3.p6.6.m6.1.1.cmml" xref="S3.SS3.p6.6.m6.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p6.6.m6.1c">C</annotation></semantics></math> denotes the number of classes, including the background class. For each instance <math id="S3.SS3.p6.7.m7.1" class="ltx_Math" alttext="\mathbf{z}_{i}" display="inline"><semantics id="S3.SS3.p6.7.m7.1a"><msub id="S3.SS3.p6.7.m7.1.1" xref="S3.SS3.p6.7.m7.1.1.cmml"><mi id="S3.SS3.p6.7.m7.1.1.2" xref="S3.SS3.p6.7.m7.1.1.2.cmml">𝐳</mi><mi id="S3.SS3.p6.7.m7.1.1.3" xref="S3.SS3.p6.7.m7.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p6.7.m7.1b"><apply id="S3.SS3.p6.7.m7.1.1.cmml" xref="S3.SS3.p6.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS3.p6.7.m7.1.1.1.cmml" xref="S3.SS3.p6.7.m7.1.1">subscript</csymbol><ci id="S3.SS3.p6.7.m7.1.1.2.cmml" xref="S3.SS3.p6.7.m7.1.1.2">𝐳</ci><ci id="S3.SS3.p6.7.m7.1.1.3.cmml" xref="S3.SS3.p6.7.m7.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p6.7.m7.1c">\mathbf{z}_{i}</annotation></semantics></math>, minimizing <math id="S3.SS3.p6.8.m8.1" class="ltx_Math" alttext="\mathcal{L}_{inst}" display="inline"><semantics id="S3.SS3.p6.8.m8.1a"><msub id="S3.SS3.p6.8.m8.1.1" xref="S3.SS3.p6.8.m8.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p6.8.m8.1.1.2" xref="S3.SS3.p6.8.m8.1.1.2.cmml">ℒ</mi><mrow id="S3.SS3.p6.8.m8.1.1.3" xref="S3.SS3.p6.8.m8.1.1.3.cmml"><mi id="S3.SS3.p6.8.m8.1.1.3.2" xref="S3.SS3.p6.8.m8.1.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p6.8.m8.1.1.3.1" xref="S3.SS3.p6.8.m8.1.1.3.1.cmml">​</mo><mi id="S3.SS3.p6.8.m8.1.1.3.3" xref="S3.SS3.p6.8.m8.1.1.3.3.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p6.8.m8.1.1.3.1a" xref="S3.SS3.p6.8.m8.1.1.3.1.cmml">​</mo><mi id="S3.SS3.p6.8.m8.1.1.3.4" xref="S3.SS3.p6.8.m8.1.1.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p6.8.m8.1.1.3.1b" xref="S3.SS3.p6.8.m8.1.1.3.1.cmml">​</mo><mi id="S3.SS3.p6.8.m8.1.1.3.5" xref="S3.SS3.p6.8.m8.1.1.3.5.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p6.8.m8.1b"><apply id="S3.SS3.p6.8.m8.1.1.cmml" xref="S3.SS3.p6.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS3.p6.8.m8.1.1.1.cmml" xref="S3.SS3.p6.8.m8.1.1">subscript</csymbol><ci id="S3.SS3.p6.8.m8.1.1.2.cmml" xref="S3.SS3.p6.8.m8.1.1.2">ℒ</ci><apply id="S3.SS3.p6.8.m8.1.1.3.cmml" xref="S3.SS3.p6.8.m8.1.1.3"><times id="S3.SS3.p6.8.m8.1.1.3.1.cmml" xref="S3.SS3.p6.8.m8.1.1.3.1"></times><ci id="S3.SS3.p6.8.m8.1.1.3.2.cmml" xref="S3.SS3.p6.8.m8.1.1.3.2">𝑖</ci><ci id="S3.SS3.p6.8.m8.1.1.3.3.cmml" xref="S3.SS3.p6.8.m8.1.1.3.3">𝑛</ci><ci id="S3.SS3.p6.8.m8.1.1.3.4.cmml" xref="S3.SS3.p6.8.m8.1.1.3.4">𝑠</ci><ci id="S3.SS3.p6.8.m8.1.1.3.5.cmml" xref="S3.SS3.p6.8.m8.1.1.3.5">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p6.8.m8.1c">\mathcal{L}_{inst}</annotation></semantics></math> increases its similarity with assigned prototypes <math id="S3.SS3.p6.9.m9.2" class="ltx_Math" alttext="\mathbf{p}_{\hat{c}_{i},j}" display="inline"><semantics id="S3.SS3.p6.9.m9.2a"><msub id="S3.SS3.p6.9.m9.2.3" xref="S3.SS3.p6.9.m9.2.3.cmml"><mi id="S3.SS3.p6.9.m9.2.3.2" xref="S3.SS3.p6.9.m9.2.3.2.cmml">𝐩</mi><mrow id="S3.SS3.p6.9.m9.2.2.2.2" xref="S3.SS3.p6.9.m9.2.2.2.3.cmml"><msub id="S3.SS3.p6.9.m9.2.2.2.2.1" xref="S3.SS3.p6.9.m9.2.2.2.2.1.cmml"><mover accent="true" id="S3.SS3.p6.9.m9.2.2.2.2.1.2" xref="S3.SS3.p6.9.m9.2.2.2.2.1.2.cmml"><mi id="S3.SS3.p6.9.m9.2.2.2.2.1.2.2" xref="S3.SS3.p6.9.m9.2.2.2.2.1.2.2.cmml">c</mi><mo id="S3.SS3.p6.9.m9.2.2.2.2.1.2.1" xref="S3.SS3.p6.9.m9.2.2.2.2.1.2.1.cmml">^</mo></mover><mi id="S3.SS3.p6.9.m9.2.2.2.2.1.3" xref="S3.SS3.p6.9.m9.2.2.2.2.1.3.cmml">i</mi></msub><mo id="S3.SS3.p6.9.m9.2.2.2.2.2" xref="S3.SS3.p6.9.m9.2.2.2.3.cmml">,</mo><mi id="S3.SS3.p6.9.m9.1.1.1.1" xref="S3.SS3.p6.9.m9.1.1.1.1.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p6.9.m9.2b"><apply id="S3.SS3.p6.9.m9.2.3.cmml" xref="S3.SS3.p6.9.m9.2.3"><csymbol cd="ambiguous" id="S3.SS3.p6.9.m9.2.3.1.cmml" xref="S3.SS3.p6.9.m9.2.3">subscript</csymbol><ci id="S3.SS3.p6.9.m9.2.3.2.cmml" xref="S3.SS3.p6.9.m9.2.3.2">𝐩</ci><list id="S3.SS3.p6.9.m9.2.2.2.3.cmml" xref="S3.SS3.p6.9.m9.2.2.2.2"><apply id="S3.SS3.p6.9.m9.2.2.2.2.1.cmml" xref="S3.SS3.p6.9.m9.2.2.2.2.1"><csymbol cd="ambiguous" id="S3.SS3.p6.9.m9.2.2.2.2.1.1.cmml" xref="S3.SS3.p6.9.m9.2.2.2.2.1">subscript</csymbol><apply id="S3.SS3.p6.9.m9.2.2.2.2.1.2.cmml" xref="S3.SS3.p6.9.m9.2.2.2.2.1.2"><ci id="S3.SS3.p6.9.m9.2.2.2.2.1.2.1.cmml" xref="S3.SS3.p6.9.m9.2.2.2.2.1.2.1">^</ci><ci id="S3.SS3.p6.9.m9.2.2.2.2.1.2.2.cmml" xref="S3.SS3.p6.9.m9.2.2.2.2.1.2.2">𝑐</ci></apply><ci id="S3.SS3.p6.9.m9.2.2.2.2.1.3.cmml" xref="S3.SS3.p6.9.m9.2.2.2.2.1.3">𝑖</ci></apply><ci id="S3.SS3.p6.9.m9.1.1.1.1.cmml" xref="S3.SS3.p6.9.m9.1.1.1.1">𝑗</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p6.9.m9.2c">\mathbf{p}_{\hat{c}_{i},j}</annotation></semantics></math>, and decreases its similarity with all the others. Note that the loss is computed on both the source and target domain features using the same prototypes to reduce the domain gap.</p>
</div>
<div id="S3.SS3.p7" class="ltx_para">
<p id="S3.SS3.p7.1" class="ltx_p">As a result, instance embeddings are grouped around their assigned prototypes. This produces corruption-resistant instance features by promoting instance embeddings with similar semantics and variable weather corruption to become closer. The final objective of our method is as follows:</p>
<table id="S3.E5" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E5.m1.1" class="ltx_Math" alttext="\mathcal{L}=\mathcal{L}_{sup}+\alpha\mathcal{L}_{img}+\beta\mathcal{L}_{inst}." display="block"><semantics id="S3.E5.m1.1a"><mrow id="S3.E5.m1.1.1.1" xref="S3.E5.m1.1.1.1.1.cmml"><mrow id="S3.E5.m1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.1.1.1.1.2" xref="S3.E5.m1.1.1.1.1.2.cmml">ℒ</mi><mo id="S3.E5.m1.1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.1.cmml">=</mo><mrow id="S3.E5.m1.1.1.1.1.3" xref="S3.E5.m1.1.1.1.1.3.cmml"><msub id="S3.E5.m1.1.1.1.1.3.2" xref="S3.E5.m1.1.1.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.1.1.1.1.3.2.2" xref="S3.E5.m1.1.1.1.1.3.2.2.cmml">ℒ</mi><mrow id="S3.E5.m1.1.1.1.1.3.2.3" xref="S3.E5.m1.1.1.1.1.3.2.3.cmml"><mi id="S3.E5.m1.1.1.1.1.3.2.3.2" xref="S3.E5.m1.1.1.1.1.3.2.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.1.1.1.1.3.2.3.1" xref="S3.E5.m1.1.1.1.1.3.2.3.1.cmml">​</mo><mi id="S3.E5.m1.1.1.1.1.3.2.3.3" xref="S3.E5.m1.1.1.1.1.3.2.3.3.cmml">u</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.1.1.1.1.3.2.3.1a" xref="S3.E5.m1.1.1.1.1.3.2.3.1.cmml">​</mo><mi id="S3.E5.m1.1.1.1.1.3.2.3.4" xref="S3.E5.m1.1.1.1.1.3.2.3.4.cmml">p</mi></mrow></msub><mo id="S3.E5.m1.1.1.1.1.3.1" xref="S3.E5.m1.1.1.1.1.3.1.cmml">+</mo><mrow id="S3.E5.m1.1.1.1.1.3.3" xref="S3.E5.m1.1.1.1.1.3.3.cmml"><mi id="S3.E5.m1.1.1.1.1.3.3.2" xref="S3.E5.m1.1.1.1.1.3.3.2.cmml">α</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.1.1.1.1.3.3.1" xref="S3.E5.m1.1.1.1.1.3.3.1.cmml">​</mo><msub id="S3.E5.m1.1.1.1.1.3.3.3" xref="S3.E5.m1.1.1.1.1.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.1.1.1.1.3.3.3.2" xref="S3.E5.m1.1.1.1.1.3.3.3.2.cmml">ℒ</mi><mrow id="S3.E5.m1.1.1.1.1.3.3.3.3" xref="S3.E5.m1.1.1.1.1.3.3.3.3.cmml"><mi id="S3.E5.m1.1.1.1.1.3.3.3.3.2" xref="S3.E5.m1.1.1.1.1.3.3.3.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.1.1.1.1.3.3.3.3.1" xref="S3.E5.m1.1.1.1.1.3.3.3.3.1.cmml">​</mo><mi id="S3.E5.m1.1.1.1.1.3.3.3.3.3" xref="S3.E5.m1.1.1.1.1.3.3.3.3.3.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.1.1.1.1.3.3.3.3.1a" xref="S3.E5.m1.1.1.1.1.3.3.3.3.1.cmml">​</mo><mi id="S3.E5.m1.1.1.1.1.3.3.3.3.4" xref="S3.E5.m1.1.1.1.1.3.3.3.3.4.cmml">g</mi></mrow></msub></mrow><mo id="S3.E5.m1.1.1.1.1.3.1a" xref="S3.E5.m1.1.1.1.1.3.1.cmml">+</mo><mrow id="S3.E5.m1.1.1.1.1.3.4" xref="S3.E5.m1.1.1.1.1.3.4.cmml"><mi id="S3.E5.m1.1.1.1.1.3.4.2" xref="S3.E5.m1.1.1.1.1.3.4.2.cmml">β</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.1.1.1.1.3.4.1" xref="S3.E5.m1.1.1.1.1.3.4.1.cmml">​</mo><msub id="S3.E5.m1.1.1.1.1.3.4.3" xref="S3.E5.m1.1.1.1.1.3.4.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.1.1.1.1.3.4.3.2" xref="S3.E5.m1.1.1.1.1.3.4.3.2.cmml">ℒ</mi><mrow id="S3.E5.m1.1.1.1.1.3.4.3.3" xref="S3.E5.m1.1.1.1.1.3.4.3.3.cmml"><mi id="S3.E5.m1.1.1.1.1.3.4.3.3.2" xref="S3.E5.m1.1.1.1.1.3.4.3.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.1.1.1.1.3.4.3.3.1" xref="S3.E5.m1.1.1.1.1.3.4.3.3.1.cmml">​</mo><mi id="S3.E5.m1.1.1.1.1.3.4.3.3.3" xref="S3.E5.m1.1.1.1.1.3.4.3.3.3.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.1.1.1.1.3.4.3.3.1a" xref="S3.E5.m1.1.1.1.1.3.4.3.3.1.cmml">​</mo><mi id="S3.E5.m1.1.1.1.1.3.4.3.3.4" xref="S3.E5.m1.1.1.1.1.3.4.3.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.1.1.1.1.3.4.3.3.1b" xref="S3.E5.m1.1.1.1.1.3.4.3.3.1.cmml">​</mo><mi id="S3.E5.m1.1.1.1.1.3.4.3.3.5" xref="S3.E5.m1.1.1.1.1.3.4.3.3.5.cmml">t</mi></mrow></msub></mrow></mrow></mrow><mo lspace="0em" id="S3.E5.m1.1.1.1.2" xref="S3.E5.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m1.1b"><apply id="S3.E5.m1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1"><eq id="S3.E5.m1.1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1.1"></eq><ci id="S3.E5.m1.1.1.1.1.2.cmml" xref="S3.E5.m1.1.1.1.1.2">ℒ</ci><apply id="S3.E5.m1.1.1.1.1.3.cmml" xref="S3.E5.m1.1.1.1.1.3"><plus id="S3.E5.m1.1.1.1.1.3.1.cmml" xref="S3.E5.m1.1.1.1.1.3.1"></plus><apply id="S3.E5.m1.1.1.1.1.3.2.cmml" xref="S3.E5.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.3.2.1.cmml" xref="S3.E5.m1.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E5.m1.1.1.1.1.3.2.2.cmml" xref="S3.E5.m1.1.1.1.1.3.2.2">ℒ</ci><apply id="S3.E5.m1.1.1.1.1.3.2.3.cmml" xref="S3.E5.m1.1.1.1.1.3.2.3"><times id="S3.E5.m1.1.1.1.1.3.2.3.1.cmml" xref="S3.E5.m1.1.1.1.1.3.2.3.1"></times><ci id="S3.E5.m1.1.1.1.1.3.2.3.2.cmml" xref="S3.E5.m1.1.1.1.1.3.2.3.2">𝑠</ci><ci id="S3.E5.m1.1.1.1.1.3.2.3.3.cmml" xref="S3.E5.m1.1.1.1.1.3.2.3.3">𝑢</ci><ci id="S3.E5.m1.1.1.1.1.3.2.3.4.cmml" xref="S3.E5.m1.1.1.1.1.3.2.3.4">𝑝</ci></apply></apply><apply id="S3.E5.m1.1.1.1.1.3.3.cmml" xref="S3.E5.m1.1.1.1.1.3.3"><times id="S3.E5.m1.1.1.1.1.3.3.1.cmml" xref="S3.E5.m1.1.1.1.1.3.3.1"></times><ci id="S3.E5.m1.1.1.1.1.3.3.2.cmml" xref="S3.E5.m1.1.1.1.1.3.3.2">𝛼</ci><apply id="S3.E5.m1.1.1.1.1.3.3.3.cmml" xref="S3.E5.m1.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.3.3.3.1.cmml" xref="S3.E5.m1.1.1.1.1.3.3.3">subscript</csymbol><ci id="S3.E5.m1.1.1.1.1.3.3.3.2.cmml" xref="S3.E5.m1.1.1.1.1.3.3.3.2">ℒ</ci><apply id="S3.E5.m1.1.1.1.1.3.3.3.3.cmml" xref="S3.E5.m1.1.1.1.1.3.3.3.3"><times id="S3.E5.m1.1.1.1.1.3.3.3.3.1.cmml" xref="S3.E5.m1.1.1.1.1.3.3.3.3.1"></times><ci id="S3.E5.m1.1.1.1.1.3.3.3.3.2.cmml" xref="S3.E5.m1.1.1.1.1.3.3.3.3.2">𝑖</ci><ci id="S3.E5.m1.1.1.1.1.3.3.3.3.3.cmml" xref="S3.E5.m1.1.1.1.1.3.3.3.3.3">𝑚</ci><ci id="S3.E5.m1.1.1.1.1.3.3.3.3.4.cmml" xref="S3.E5.m1.1.1.1.1.3.3.3.3.4">𝑔</ci></apply></apply></apply><apply id="S3.E5.m1.1.1.1.1.3.4.cmml" xref="S3.E5.m1.1.1.1.1.3.4"><times id="S3.E5.m1.1.1.1.1.3.4.1.cmml" xref="S3.E5.m1.1.1.1.1.3.4.1"></times><ci id="S3.E5.m1.1.1.1.1.3.4.2.cmml" xref="S3.E5.m1.1.1.1.1.3.4.2">𝛽</ci><apply id="S3.E5.m1.1.1.1.1.3.4.3.cmml" xref="S3.E5.m1.1.1.1.1.3.4.3"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.3.4.3.1.cmml" xref="S3.E5.m1.1.1.1.1.3.4.3">subscript</csymbol><ci id="S3.E5.m1.1.1.1.1.3.4.3.2.cmml" xref="S3.E5.m1.1.1.1.1.3.4.3.2">ℒ</ci><apply id="S3.E5.m1.1.1.1.1.3.4.3.3.cmml" xref="S3.E5.m1.1.1.1.1.3.4.3.3"><times id="S3.E5.m1.1.1.1.1.3.4.3.3.1.cmml" xref="S3.E5.m1.1.1.1.1.3.4.3.3.1"></times><ci id="S3.E5.m1.1.1.1.1.3.4.3.3.2.cmml" xref="S3.E5.m1.1.1.1.1.3.4.3.3.2">𝑖</ci><ci id="S3.E5.m1.1.1.1.1.3.4.3.3.3.cmml" xref="S3.E5.m1.1.1.1.1.3.4.3.3.3">𝑛</ci><ci id="S3.E5.m1.1.1.1.1.3.4.3.3.4.cmml" xref="S3.E5.m1.1.1.1.1.3.4.3.3.4">𝑠</ci><ci id="S3.E5.m1.1.1.1.1.3.4.3.3.5.cmml" xref="S3.E5.m1.1.1.1.1.3.4.3.3.5">𝑡</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.1c">\mathcal{L}=\mathcal{L}_{sup}+\alpha\mathcal{L}_{img}+\beta\mathcal{L}_{inst}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
</div>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">IV </span><span id="S4.1.1" class="ltx_text ltx_font_smallcaps">EXPERIMENTS</span>
</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p">In this section, we validate that our unsupervised domain adaptation method can effectively enhance object detection performance in real-world environments with adverse weather. Using publicly available datasets and our own datasets, the results of our method are quantitatively and qualitatively compared to those of other methods for object detection under adverse weather conditions. In addition, ablation studies are conducted to assess the validity of each component of our methodology.</p>
</div>
<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S4.SS1.5.1.1" class="ltx_text">IV-A</span> </span><span id="S4.SS1.6.2" class="ltx_text ltx_font_italic">Datasets</span>
</h3>

<figure id="S4.T1" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">TABLE I: </span>
Quantitative results on both synthetic and real-world datasets. mAP (%) is used as an evaluation metric. <span id="S4.T1.3.1" class="ltx_text ltx_font_bold">Synthetic Data</span> column indicates whether synthetically generated adverse weather data are utilized during training, and the <span id="S4.T1.4.2" class="ltx_text ltx_font_bold">Target Data</span> column indicates whether unlabeled data from the target domain is incorporated during training. Our method outperforms other methods when applied to datasets with real-world adverse weather conditions.
</figcaption>
<div id="S4.T1.5" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:60.6pt;vertical-align:-0.4pt;"><span class="ltx_transformed_inner" style="transform:translate(-366.3pt,50.9pt) scale(0.37182064732888,0.37182064732888) ;">
<table id="S4.T1.5.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T1.5.1.1.1" class="ltx_tr">
<th id="S4.T1.5.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-top:1pt;padding-bottom:1pt;" rowspan="3"><span id="S4.T1.5.1.1.1.1.1" class="ltx_text ltx_font_bold">Method</span></th>
<th id="S4.T1.5.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-top:1pt;padding-bottom:1pt;" rowspan="3"><span id="S4.T1.5.1.1.1.2.1" class="ltx_text ltx_font_bold">Source Data</span></th>
<th id="S4.T1.5.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-top:1pt;padding-bottom:1pt;" rowspan="3"><span id="S4.T1.5.1.1.1.3.1" class="ltx_text ltx_font_bold">Synthetic Data</span></th>
<th id="S4.T1.5.1.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-top:1pt;padding-bottom:1pt;" rowspan="3"><span id="S4.T1.5.1.1.1.4.1" class="ltx_text ltx_font_bold">Target Data</span></th>
<th id="S4.T1.5.1.1.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-top:1pt;padding-bottom:1pt;" colspan="4"><span id="S4.T1.5.1.1.1.5.1" class="ltx_text ltx_font_bold">Rainy</span></th>
<th id="S4.T1.5.1.1.1.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-top:1pt;padding-bottom:1pt;" colspan="2"><span id="S4.T1.5.1.1.1.6.1" class="ltx_text ltx_font_bold">Snowy</span></th>
</tr>
<tr id="S4.T1.5.1.2.2" class="ltx_tr">
<th id="S4.T1.5.1.2.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;" colspan="2"><span id="S4.T1.5.1.2.2.1.1" class="ltx_text ltx_font_bold">Synthetic</span></th>
<th id="S4.T1.5.1.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;" colspan="2"><span id="S4.T1.5.1.2.2.2.1" class="ltx_text ltx_font_bold">Real-World</span></th>
<th id="S4.T1.5.1.2.2.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;" colspan="2"><span id="S4.T1.5.1.2.2.3.1" class="ltx_text ltx_font_bold">Real-World</span></th>
</tr>
<tr id="S4.T1.5.1.3.3" class="ltx_tr">
<th id="S4.T1.5.1.3.3.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T1.5.1.3.3.1.1" class="ltx_text ltx_font_italic">RainCityscapes</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib47" title="" class="ltx_ref">47</a>]</cite>
</th>
<th id="S4.T1.5.1.3.3.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T1.5.1.3.3.2.1" class="ltx_text ltx_font_italic">Rain Rendering</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>
</th>
<th id="S4.T1.5.1.3.3.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T1.5.1.3.3.3.1" class="ltx_text ltx_font_italic">BDD 100K</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite>
</th>
<th id="S4.T1.5.1.3.3.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;"><span id="S4.T1.5.1.3.3.4.1" class="ltx_text ltx_font_italic">Our Dataset</span></th>
<th id="S4.T1.5.1.3.3.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T1.5.1.3.3.5.1" class="ltx_text ltx_font_italic">BDD 100K</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite>
</th>
<th id="S4.T1.5.1.3.3.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;"><span id="S4.T1.5.1.3.3.6.1" class="ltx_text ltx_font_italic">Our Dataset</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T1.5.1.4.1" class="ltx_tr">
<td id="S4.T1.5.1.4.1.1" class="ltx_td ltx_align_center ltx_border_tt" style="padding-top:1pt;padding-bottom:1pt;"><span id="S4.T1.5.1.4.1.1.1" class="ltx_text ltx_font_italic">Source Only</span></td>
<td id="S4.T1.5.1.4.1.2" class="ltx_td ltx_align_center ltx_border_tt" style="padding-top:1pt;padding-bottom:1pt;">✓</td>
<td id="S4.T1.5.1.4.1.3" class="ltx_td ltx_align_center ltx_border_tt" style="padding-top:1pt;padding-bottom:1pt;">✗</td>
<td id="S4.T1.5.1.4.1.4" class="ltx_td ltx_align_center ltx_border_tt" style="padding-top:1pt;padding-bottom:1pt;">✗</td>
<td id="S4.T1.5.1.4.1.5" class="ltx_td ltx_align_center ltx_border_tt" style="padding-top:1pt;padding-bottom:1pt;">35.0</td>
<td id="S4.T1.5.1.4.1.6" class="ltx_td ltx_align_center ltx_border_tt" style="padding-top:1pt;padding-bottom:1pt;">31.4</td>
<td id="S4.T1.5.1.4.1.7" class="ltx_td ltx_align_center ltx_border_tt" style="padding-top:1pt;padding-bottom:1pt;">31.6</td>
<td id="S4.T1.5.1.4.1.8" class="ltx_td ltx_align_center ltx_border_tt" style="padding-top:1pt;padding-bottom:1pt;">49.4</td>
<td id="S4.T1.5.1.4.1.9" class="ltx_td ltx_align_center ltx_border_tt" style="padding-top:1pt;padding-bottom:1pt;">27.9</td>
<td id="S4.T1.5.1.4.1.10" class="ltx_td ltx_align_center ltx_border_tt" style="padding-top:1pt;padding-bottom:1pt;">57.8</td>
</tr>
<tr id="S4.T1.5.1.5.2" class="ltx_tr">
<td id="S4.T1.5.1.5.2.1" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T1.5.1.5.2.1.1" class="ltx_text ltx_font_italic">Physics-based</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>
</td>
<td id="S4.T1.5.1.5.2.2" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">✓</td>
<td id="S4.T1.5.1.5.2.3" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">✓</td>
<td id="S4.T1.5.1.5.2.4" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">✗</td>
<td id="S4.T1.5.1.5.2.5" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;"><span id="S4.T1.5.1.5.2.5.1" class="ltx_text ltx_font_bold">40.5</span></td>
<td id="S4.T1.5.1.5.2.6" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">41.8</td>
<td id="S4.T1.5.1.5.2.7" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">22.1</td>
<td id="S4.T1.5.1.5.2.8" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">35.1</td>
<td id="S4.T1.5.1.5.2.9" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">18.1</td>
<td id="S4.T1.5.1.5.2.10" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">42.0</td>
</tr>
<tr id="S4.T1.5.1.6.3" class="ltx_tr">
<td id="S4.T1.5.1.6.3.1" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T1.5.1.6.3.1.1" class="ltx_text ltx_font_italic">MPRNet</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib28" title="" class="ltx_ref">28</a>]</cite>
</td>
<td id="S4.T1.5.1.6.3.2" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">✓</td>
<td id="S4.T1.5.1.6.3.3" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">✓</td>
<td id="S4.T1.5.1.6.3.4" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">✗</td>
<td id="S4.T1.5.1.6.3.5" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">37.7</td>
<td id="S4.T1.5.1.6.3.6" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;"><span id="S4.T1.5.1.6.3.6.1" class="ltx_text ltx_font_bold">46.9</span></td>
<td id="S4.T1.5.1.6.3.7" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">12.8</td>
<td id="S4.T1.5.1.6.3.8" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">38.6</td>
<td id="S4.T1.5.1.6.3.9" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">12.3</td>
<td id="S4.T1.5.1.6.3.10" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">41.8</td>
</tr>
<tr id="S4.T1.5.1.7.4" class="ltx_tr">
<td id="S4.T1.5.1.7.4.1" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T1.5.1.7.4.1.1" class="ltx_text ltx_font_italic">SADA</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite>
</td>
<td id="S4.T1.5.1.7.4.2" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">✓</td>
<td id="S4.T1.5.1.7.4.3" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">✗</td>
<td id="S4.T1.5.1.7.4.4" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">✓</td>
<td id="S4.T1.5.1.7.4.5" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">38.7</td>
<td id="S4.T1.5.1.7.4.6" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">40.1</td>
<td id="S4.T1.5.1.7.4.7" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">29.1</td>
<td id="S4.T1.5.1.7.4.8" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">48.2</td>
<td id="S4.T1.5.1.7.4.9" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">27.6</td>
<td id="S4.T1.5.1.7.4.10" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">53.5</td>
</tr>
<tr id="S4.T1.5.1.8.5" class="ltx_tr">
<td id="S4.T1.5.1.8.5.1" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T1.5.1.8.5.1.1" class="ltx_text ltx_font_italic">SWDA</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite>
</td>
<td id="S4.T1.5.1.8.5.2" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">✓</td>
<td id="S4.T1.5.1.8.5.3" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">✗</td>
<td id="S4.T1.5.1.8.5.4" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">✓</td>
<td id="S4.T1.5.1.8.5.5" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">37.7</td>
<td id="S4.T1.5.1.8.5.6" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">36.7</td>
<td id="S4.T1.5.1.8.5.7" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">31.1</td>
<td id="S4.T1.5.1.8.5.8" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">49.3</td>
<td id="S4.T1.5.1.8.5.9" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">28.4</td>
<td id="S4.T1.5.1.8.5.10" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">58.4</td>
</tr>
<tr id="S4.T1.5.1.9.6" class="ltx_tr">
<td id="S4.T1.5.1.9.6.1" class="ltx_td ltx_align_center ltx_border_bb" style="padding-top:1pt;padding-bottom:1pt;"><span id="S4.T1.5.1.9.6.1.1" class="ltx_text ltx_font_italic">Ours</span></td>
<td id="S4.T1.5.1.9.6.2" class="ltx_td ltx_align_center ltx_border_bb" style="padding-top:1pt;padding-bottom:1pt;">✓</td>
<td id="S4.T1.5.1.9.6.3" class="ltx_td ltx_align_center ltx_border_bb" style="padding-top:1pt;padding-bottom:1pt;">✗</td>
<td id="S4.T1.5.1.9.6.4" class="ltx_td ltx_align_center ltx_border_bb" style="padding-top:1pt;padding-bottom:1pt;">✓</td>
<td id="S4.T1.5.1.9.6.5" class="ltx_td ltx_align_center ltx_border_bb" style="padding-top:1pt;padding-bottom:1pt;">37.7</td>
<td id="S4.T1.5.1.9.6.6" class="ltx_td ltx_align_center ltx_border_bb" style="padding-top:1pt;padding-bottom:1pt;">35.6</td>
<td id="S4.T1.5.1.9.6.7" class="ltx_td ltx_align_center ltx_border_bb" style="padding-top:1pt;padding-bottom:1pt;"><span id="S4.T1.5.1.9.6.7.1" class="ltx_text ltx_font_bold">34.5</span></td>
<td id="S4.T1.5.1.9.6.8" class="ltx_td ltx_align_center ltx_border_bb" style="padding-top:1pt;padding-bottom:1pt;"><span id="S4.T1.5.1.9.6.8.1" class="ltx_text ltx_font_bold">51.2</span></td>
<td id="S4.T1.5.1.9.6.9" class="ltx_td ltx_align_center ltx_border_bb" style="padding-top:1pt;padding-bottom:1pt;"><span id="S4.T1.5.1.9.6.9.1" class="ltx_text ltx_font_bold">30.3</span></td>
<td id="S4.T1.5.1.9.6.10" class="ltx_td ltx_align_center ltx_border_bb" style="padding-top:1pt;padding-bottom:1pt;"><span id="S4.T1.5.1.9.6.10.1" class="ltx_text ltx_font_bold">62.6</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<figure id="S4.F3" class="ltx_figure"><img src="/html/2309.08152/assets/x3.png" id="S4.F3.1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="145" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>
Qualitative results on real-world target datasets. Compared to other methods, <span id="S4.F3.6.1" class="ltx_text ltx_font_italic">Ours</span> successfully detects the objects even in the presence of severe weather corruption and style variations. Even though <span id="S4.F3.7.2" class="ltx_text ltx_font_italic">MPRNet</span> removes raindrops in the first two images, the detector performance remains low, indicating images generated by the removal network do not consistently help object detection. In the remaining images, the removal network fails to remove corruptions and instead creates some artifacts due to the disparity between real weather data and synthetic weather data, which <span id="S4.F3.8.3" class="ltx_text ltx_font_italic">MPRNet</span> was trained on. While <span id="S4.F3.9.4" class="ltx_text ltx_font_italic">SWDA</span> directly adapts the network to the target domain, it fails to detect objects under severe weather corruption and environmental differences. More qualitative results are available in our multimedia material. [<a target="_blank" href="https://youtu.be/vsUSrFsbuu8" title="" class="ltx_ref ltx_href">link</a>]
</figcaption>
</figure>
<div id="S4.SS1.p1" class="ltx_para">
<p id="S4.SS1.p1.1" class="ltx_p">Our source domain dataset is <span id="S4.SS1.p1.1.1" class="ltx_text ltx_font_italic">Cityscapes</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib48" title="" class="ltx_ref">48</a>]</cite>, which consists of real-world urban driving images captured under clear weather conditions. For the target domain dataset, multiple datasets are used to validate the efficacy of our method in various environments with adverse weather conditions. Using two synthetic weather datasets, we investigate the efficacy of other methods employing synthetic data or UDA in synthetic weather contexts. On clear images of the <span id="S4.SS1.p1.1.2" class="ltx_text ltx_font_italic">Cityscapes</span>, the <span id="S4.SS1.p1.1.3" class="ltx_text ltx_font_italic">Rain Rendering</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite> generates synthetic rain images with a physical particle simulator for each, and <span id="S4.SS1.p1.1.4" class="ltx_text ltx_font_italic">RainCityscapes</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib47" title="" class="ltx_ref">47</a>]</cite> generates rain and fog effects subject to scene depth. To validate the efficacy of methods in real-world environments, <span id="S4.SS1.p1.1.5" class="ltx_text ltx_font_italic">BDD 100K</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite>, a real-world driving dataset captured in various weather conditions, is employed. The rainy and snowy subsets are used as our target domain to evaluate the efficacy of methods under diverse weather conditions.</p>
</div>
<div id="S4.SS1.p2" class="ltx_para">
<p id="S4.SS1.p2.1" class="ltx_p">To further validate our model across a wider range of environments, we collect <span id="S4.SS1.p2.1.1" class="ltx_text ltx_font_italic">Our Dataset</span> in adverse weather conditions using our platform, which is equipped with an external vehicle RGB camera <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib49" title="" class="ltx_ref">49</a>, <a href="#bib.bib50" title="" class="ltx_ref">50</a>]</cite>.
In comparison to the <span id="S4.SS1.p2.1.2" class="ltx_text ltx_font_italic">BDD 100K</span>, which uses a camera mounted inside the windshield of the vehicle, our dataset utilizes an external camera that is consistent with the source domain dataset. In addition, raindrops and snowfalls on the lens result in much more severe blurring of the images. Furthermore, unlike other datasets primarily focusing on urban scenes, our datasets include data collected from rural and mountainous environments, providing a broader range of background environments and significant domain gaps. Our dataset is divided into <span id="S4.SS1.p2.1.3" class="ltx_text ltx_font_italic">Rainy</span> and <span id="S4.SS1.p2.1.4" class="ltx_text ltx_font_italic">Snowy</span> subsets. The rainy subset consists of 2845 training images and 677 validation images, and the snowy subset consists of 1656 training images and 598 validation images. Our dataset comprises three classes: <span id="S4.SS1.p2.1.5" class="ltx_text ltx_font_italic">person</span>, <span id="S4.SS1.p2.1.6" class="ltx_text ltx_font_italic">car</span>, and <span id="S4.SS1.p2.1.7" class="ltx_text ltx_font_italic">motorcycle</span>. For alignment with <span id="S4.SS1.p2.1.8" class="ltx_text ltx_font_italic">Cityscapes</span> dataset categories, <span id="S4.SS1.p2.1.9" class="ltx_text ltx_font_italic">Cityscapes</span> classes are assigned to our dataset during the experiment as follows: 1) <span id="S4.SS1.p2.1.10" class="ltx_text ltx_font_italic">person</span>, <span id="S4.SS1.p2.1.11" class="ltx_text ltx_font_italic">rider</span> to <span id="S4.SS1.p2.1.12" class="ltx_text ltx_font_italic">person</span>, 2) <span id="S4.SS1.p2.1.13" class="ltx_text ltx_font_italic">car</span>, <span id="S4.SS1.p2.1.14" class="ltx_text ltx_font_italic">truck</span>, <span id="S4.SS1.p2.1.15" class="ltx_text ltx_font_italic">bus</span> to <span id="S4.SS1.p2.1.16" class="ltx_text ltx_font_italic">car</span>, and 3) <span id="S4.SS1.p2.1.17" class="ltx_text ltx_font_italic">motorcycle</span>, <span id="S4.SS1.p2.1.18" class="ltx_text ltx_font_italic">bicycle</span> to <span id="S4.SS1.p2.1.19" class="ltx_text ltx_font_italic">motorcycle</span>.</p>
</div>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S4.SS2.5.1.1" class="ltx_text">IV-B</span> </span><span id="S4.SS2.6.2" class="ltx_text ltx_font_italic">Experimental Setup</span>
</h3>

<div id="S4.SS2.p1" class="ltx_para ltx_noindent">
<p id="S4.SS2.p1.17" class="ltx_p"><span id="S4.SS2.p1.17.1" class="ltx_text ltx_font_bold">Implementation Details.</span>
We adopt Faster R-CNN with ImageNet-pretrained ResNet-50 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib51" title="" class="ltx_ref">51</a>]</cite> and FPN as our object detection network. Initially, the model is trained with only the <math id="S4.SS2.p1.1.m1.1" class="ltx_Math" alttext="\mathcal{L}_{\text{sup}}" display="inline"><semantics id="S4.SS2.p1.1.m1.1a"><msub id="S4.SS2.p1.1.m1.1.1" xref="S4.SS2.p1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p1.1.m1.1.1.2" xref="S4.SS2.p1.1.m1.1.1.2.cmml">ℒ</mi><mtext id="S4.SS2.p1.1.m1.1.1.3" xref="S4.SS2.p1.1.m1.1.1.3a.cmml">sup</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.1.m1.1b"><apply id="S4.SS2.p1.1.m1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.1.m1.1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1">subscript</csymbol><ci id="S4.SS2.p1.1.m1.1.1.2.cmml" xref="S4.SS2.p1.1.m1.1.1.2">ℒ</ci><ci id="S4.SS2.p1.1.m1.1.1.3a.cmml" xref="S4.SS2.p1.1.m1.1.1.3"><mtext mathsize="70%" id="S4.SS2.p1.1.m1.1.1.3.cmml" xref="S4.SS2.p1.1.m1.1.1.3">sup</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.1.m1.1c">\mathcal{L}_{\text{sup}}</annotation></semantics></math> using source data in order to obtain pseudo-labels, and <math id="S4.SS2.p1.2.m2.1" class="ltx_Math" alttext="\mathcal{L}_{\text{img}}" display="inline"><semantics id="S4.SS2.p1.2.m2.1a"><msub id="S4.SS2.p1.2.m2.1.1" xref="S4.SS2.p1.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p1.2.m2.1.1.2" xref="S4.SS2.p1.2.m2.1.1.2.cmml">ℒ</mi><mtext id="S4.SS2.p1.2.m2.1.1.3" xref="S4.SS2.p1.2.m2.1.1.3a.cmml">img</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.2.m2.1b"><apply id="S4.SS2.p1.2.m2.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.2.m2.1.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1">subscript</csymbol><ci id="S4.SS2.p1.2.m2.1.1.2.cmml" xref="S4.SS2.p1.2.m2.1.1.2">ℒ</ci><ci id="S4.SS2.p1.2.m2.1.1.3a.cmml" xref="S4.SS2.p1.2.m2.1.1.3"><mtext mathsize="70%" id="S4.SS2.p1.2.m2.1.1.3.cmml" xref="S4.SS2.p1.2.m2.1.1.3">img</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.2.m2.1c">\mathcal{L}_{\text{img}}</annotation></semantics></math> and <math id="S4.SS2.p1.3.m3.1" class="ltx_Math" alttext="\mathcal{L}_{\text{inst}}" display="inline"><semantics id="S4.SS2.p1.3.m3.1a"><msub id="S4.SS2.p1.3.m3.1.1" xref="S4.SS2.p1.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p1.3.m3.1.1.2" xref="S4.SS2.p1.3.m3.1.1.2.cmml">ℒ</mi><mtext id="S4.SS2.p1.3.m3.1.1.3" xref="S4.SS2.p1.3.m3.1.1.3a.cmml">inst</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.3.m3.1b"><apply id="S4.SS2.p1.3.m3.1.1.cmml" xref="S4.SS2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.3.m3.1.1.1.cmml" xref="S4.SS2.p1.3.m3.1.1">subscript</csymbol><ci id="S4.SS2.p1.3.m3.1.1.2.cmml" xref="S4.SS2.p1.3.m3.1.1.2">ℒ</ci><ci id="S4.SS2.p1.3.m3.1.1.3a.cmml" xref="S4.SS2.p1.3.m3.1.1.3"><mtext mathsize="70%" id="S4.SS2.p1.3.m3.1.1.3.cmml" xref="S4.SS2.p1.3.m3.1.1.3">inst</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.3.m3.1c">\mathcal{L}_{\text{inst}}</annotation></semantics></math> are applied after 7.5k iterations with <math id="S4.SS2.p1.4.m4.1" class="ltx_Math" alttext="{\alpha=1.0}" display="inline"><semantics id="S4.SS2.p1.4.m4.1a"><mrow id="S4.SS2.p1.4.m4.1.1" xref="S4.SS2.p1.4.m4.1.1.cmml"><mi id="S4.SS2.p1.4.m4.1.1.2" xref="S4.SS2.p1.4.m4.1.1.2.cmml">α</mi><mo id="S4.SS2.p1.4.m4.1.1.1" xref="S4.SS2.p1.4.m4.1.1.1.cmml">=</mo><mn id="S4.SS2.p1.4.m4.1.1.3" xref="S4.SS2.p1.4.m4.1.1.3.cmml">1.0</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.4.m4.1b"><apply id="S4.SS2.p1.4.m4.1.1.cmml" xref="S4.SS2.p1.4.m4.1.1"><eq id="S4.SS2.p1.4.m4.1.1.1.cmml" xref="S4.SS2.p1.4.m4.1.1.1"></eq><ci id="S4.SS2.p1.4.m4.1.1.2.cmml" xref="S4.SS2.p1.4.m4.1.1.2">𝛼</ci><cn type="float" id="S4.SS2.p1.4.m4.1.1.3.cmml" xref="S4.SS2.p1.4.m4.1.1.3">1.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.4.m4.1c">{\alpha=1.0}</annotation></semantics></math>, <math id="S4.SS2.p1.5.m5.1" class="ltx_Math" alttext="{\beta=1.0}" display="inline"><semantics id="S4.SS2.p1.5.m5.1a"><mrow id="S4.SS2.p1.5.m5.1.1" xref="S4.SS2.p1.5.m5.1.1.cmml"><mi id="S4.SS2.p1.5.m5.1.1.2" xref="S4.SS2.p1.5.m5.1.1.2.cmml">β</mi><mo id="S4.SS2.p1.5.m5.1.1.1" xref="S4.SS2.p1.5.m5.1.1.1.cmml">=</mo><mn id="S4.SS2.p1.5.m5.1.1.3" xref="S4.SS2.p1.5.m5.1.1.3.cmml">1.0</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.5.m5.1b"><apply id="S4.SS2.p1.5.m5.1.1.cmml" xref="S4.SS2.p1.5.m5.1.1"><eq id="S4.SS2.p1.5.m5.1.1.1.cmml" xref="S4.SS2.p1.5.m5.1.1.1"></eq><ci id="S4.SS2.p1.5.m5.1.1.2.cmml" xref="S4.SS2.p1.5.m5.1.1.2">𝛽</ci><cn type="float" id="S4.SS2.p1.5.m5.1.1.3.cmml" xref="S4.SS2.p1.5.m5.1.1.3">1.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.5.m5.1c">{\beta=1.0}</annotation></semantics></math>. The image-level style alignment is performed on the FPN features at levels <math id="S4.SS2.p1.6.m6.1" class="ltx_Math" alttext="P_{4}" display="inline"><semantics id="S4.SS2.p1.6.m6.1a"><msub id="S4.SS2.p1.6.m6.1.1" xref="S4.SS2.p1.6.m6.1.1.cmml"><mi id="S4.SS2.p1.6.m6.1.1.2" xref="S4.SS2.p1.6.m6.1.1.2.cmml">P</mi><mn id="S4.SS2.p1.6.m6.1.1.3" xref="S4.SS2.p1.6.m6.1.1.3.cmml">4</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.6.m6.1b"><apply id="S4.SS2.p1.6.m6.1.1.cmml" xref="S4.SS2.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.6.m6.1.1.1.cmml" xref="S4.SS2.p1.6.m6.1.1">subscript</csymbol><ci id="S4.SS2.p1.6.m6.1.1.2.cmml" xref="S4.SS2.p1.6.m6.1.1.2">𝑃</ci><cn type="integer" id="S4.SS2.p1.6.m6.1.1.3.cmml" xref="S4.SS2.p1.6.m6.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.6.m6.1c">P_{4}</annotation></semantics></math> and <math id="S4.SS2.p1.7.m7.1" class="ltx_Math" alttext="P_{5}" display="inline"><semantics id="S4.SS2.p1.7.m7.1a"><msub id="S4.SS2.p1.7.m7.1.1" xref="S4.SS2.p1.7.m7.1.1.cmml"><mi id="S4.SS2.p1.7.m7.1.1.2" xref="S4.SS2.p1.7.m7.1.1.2.cmml">P</mi><mn id="S4.SS2.p1.7.m7.1.1.3" xref="S4.SS2.p1.7.m7.1.1.3.cmml">5</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.7.m7.1b"><apply id="S4.SS2.p1.7.m7.1.1.cmml" xref="S4.SS2.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.7.m7.1.1.1.cmml" xref="S4.SS2.p1.7.m7.1.1">subscript</csymbol><ci id="S4.SS2.p1.7.m7.1.1.2.cmml" xref="S4.SS2.p1.7.m7.1.1.2">𝑃</ci><cn type="integer" id="S4.SS2.p1.7.m7.1.1.3.cmml" xref="S4.SS2.p1.7.m7.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.7.m7.1c">P_{5}</annotation></semantics></math>, with <math id="S4.SS2.p1.8.m8.1" class="ltx_Math" alttext="{\lambda}" display="inline"><semantics id="S4.SS2.p1.8.m8.1a"><mi id="S4.SS2.p1.8.m8.1.1" xref="S4.SS2.p1.8.m8.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.8.m8.1b"><ci id="S4.SS2.p1.8.m8.1.1.cmml" xref="S4.SS2.p1.8.m8.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.8.m8.1c">{\lambda}</annotation></semantics></math> of GRL set as <math id="S4.SS2.p1.9.m9.1" class="ltx_Math" alttext="0.01" display="inline"><semantics id="S4.SS2.p1.9.m9.1a"><mn id="S4.SS2.p1.9.m9.1.1" xref="S4.SS2.p1.9.m9.1.1.cmml">0.01</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.9.m9.1b"><cn type="float" id="S4.SS2.p1.9.m9.1.1.cmml" xref="S4.SS2.p1.9.m9.1.1">0.01</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.9.m9.1c">0.01</annotation></semantics></math>. The instance-level weather alignment is performed on features at levels <math id="S4.SS2.p1.10.m10.1" class="ltx_Math" alttext="P_{2}" display="inline"><semantics id="S4.SS2.p1.10.m10.1a"><msub id="S4.SS2.p1.10.m10.1.1" xref="S4.SS2.p1.10.m10.1.1.cmml"><mi id="S4.SS2.p1.10.m10.1.1.2" xref="S4.SS2.p1.10.m10.1.1.2.cmml">P</mi><mn id="S4.SS2.p1.10.m10.1.1.3" xref="S4.SS2.p1.10.m10.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.10.m10.1b"><apply id="S4.SS2.p1.10.m10.1.1.cmml" xref="S4.SS2.p1.10.m10.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.10.m10.1.1.1.cmml" xref="S4.SS2.p1.10.m10.1.1">subscript</csymbol><ci id="S4.SS2.p1.10.m10.1.1.2.cmml" xref="S4.SS2.p1.10.m10.1.1.2">𝑃</ci><cn type="integer" id="S4.SS2.p1.10.m10.1.1.3.cmml" xref="S4.SS2.p1.10.m10.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.10.m10.1c">P_{2}</annotation></semantics></math> and <math id="S4.SS2.p1.11.m11.1" class="ltx_Math" alttext="P_{3}" display="inline"><semantics id="S4.SS2.p1.11.m11.1a"><msub id="S4.SS2.p1.11.m11.1.1" xref="S4.SS2.p1.11.m11.1.1.cmml"><mi id="S4.SS2.p1.11.m11.1.1.2" xref="S4.SS2.p1.11.m11.1.1.2.cmml">P</mi><mn id="S4.SS2.p1.11.m11.1.1.3" xref="S4.SS2.p1.11.m11.1.1.3.cmml">3</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.11.m11.1b"><apply id="S4.SS2.p1.11.m11.1.1.cmml" xref="S4.SS2.p1.11.m11.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.11.m11.1.1.1.cmml" xref="S4.SS2.p1.11.m11.1.1">subscript</csymbol><ci id="S4.SS2.p1.11.m11.1.1.2.cmml" xref="S4.SS2.p1.11.m11.1.1.2">𝑃</ci><cn type="integer" id="S4.SS2.p1.11.m11.1.1.3.cmml" xref="S4.SS2.p1.11.m11.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.11.m11.1c">P_{3}</annotation></semantics></math>. We execute three iterations of the Sinkhorn-Knopp algorithm with smoothness parameter <math id="S4.SS2.p1.12.m12.1" class="ltx_Math" alttext="{\kappa=0.05}" display="inline"><semantics id="S4.SS2.p1.12.m12.1a"><mrow id="S4.SS2.p1.12.m12.1.1" xref="S4.SS2.p1.12.m12.1.1.cmml"><mi id="S4.SS2.p1.12.m12.1.1.2" xref="S4.SS2.p1.12.m12.1.1.2.cmml">κ</mi><mo id="S4.SS2.p1.12.m12.1.1.1" xref="S4.SS2.p1.12.m12.1.1.1.cmml">=</mo><mn id="S4.SS2.p1.12.m12.1.1.3" xref="S4.SS2.p1.12.m12.1.1.3.cmml">0.05</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.12.m12.1b"><apply id="S4.SS2.p1.12.m12.1.1.cmml" xref="S4.SS2.p1.12.m12.1.1"><eq id="S4.SS2.p1.12.m12.1.1.1.cmml" xref="S4.SS2.p1.12.m12.1.1.1"></eq><ci id="S4.SS2.p1.12.m12.1.1.2.cmml" xref="S4.SS2.p1.12.m12.1.1.2">𝜅</ci><cn type="float" id="S4.SS2.p1.12.m12.1.1.3.cmml" xref="S4.SS2.p1.12.m12.1.1.3">0.05</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.12.m12.1c">{\kappa=0.05}</annotation></semantics></math>. The number of prototypes <math id="S4.SS2.p1.13.m13.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S4.SS2.p1.13.m13.1a"><mi id="S4.SS2.p1.13.m13.1.1" xref="S4.SS2.p1.13.m13.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.13.m13.1b"><ci id="S4.SS2.p1.13.m13.1.1.cmml" xref="S4.SS2.p1.13.m13.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.13.m13.1c">K</annotation></semantics></math> for each class is set to <math id="S4.SS2.p1.14.m14.1" class="ltx_Math" alttext="5" display="inline"><semantics id="S4.SS2.p1.14.m14.1a"><mn id="S4.SS2.p1.14.m14.1.1" xref="S4.SS2.p1.14.m14.1.1.cmml">5</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.14.m14.1b"><cn type="integer" id="S4.SS2.p1.14.m14.1.1.cmml" xref="S4.SS2.p1.14.m14.1.1">5</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.14.m14.1c">5</annotation></semantics></math>, with other hyperparameters empirically set to <math id="S4.SS2.p1.15.m15.1" class="ltx_Math" alttext="{\tau=0.05}" display="inline"><semantics id="S4.SS2.p1.15.m15.1a"><mrow id="S4.SS2.p1.15.m15.1.1" xref="S4.SS2.p1.15.m15.1.1.cmml"><mi id="S4.SS2.p1.15.m15.1.1.2" xref="S4.SS2.p1.15.m15.1.1.2.cmml">τ</mi><mo id="S4.SS2.p1.15.m15.1.1.1" xref="S4.SS2.p1.15.m15.1.1.1.cmml">=</mo><mn id="S4.SS2.p1.15.m15.1.1.3" xref="S4.SS2.p1.15.m15.1.1.3.cmml">0.05</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.15.m15.1b"><apply id="S4.SS2.p1.15.m15.1.1.cmml" xref="S4.SS2.p1.15.m15.1.1"><eq id="S4.SS2.p1.15.m15.1.1.1.cmml" xref="S4.SS2.p1.15.m15.1.1.1"></eq><ci id="S4.SS2.p1.15.m15.1.1.2.cmml" xref="S4.SS2.p1.15.m15.1.1.2">𝜏</ci><cn type="float" id="S4.SS2.p1.15.m15.1.1.3.cmml" xref="S4.SS2.p1.15.m15.1.1.3">0.05</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.15.m15.1c">{\tau=0.05}</annotation></semantics></math>, <math id="S4.SS2.p1.16.m16.1" class="ltx_Math" alttext="{\delta=0.8}" display="inline"><semantics id="S4.SS2.p1.16.m16.1a"><mrow id="S4.SS2.p1.16.m16.1.1" xref="S4.SS2.p1.16.m16.1.1.cmml"><mi id="S4.SS2.p1.16.m16.1.1.2" xref="S4.SS2.p1.16.m16.1.1.2.cmml">δ</mi><mo id="S4.SS2.p1.16.m16.1.1.1" xref="S4.SS2.p1.16.m16.1.1.1.cmml">=</mo><mn id="S4.SS2.p1.16.m16.1.1.3" xref="S4.SS2.p1.16.m16.1.1.3.cmml">0.8</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.16.m16.1b"><apply id="S4.SS2.p1.16.m16.1.1.cmml" xref="S4.SS2.p1.16.m16.1.1"><eq id="S4.SS2.p1.16.m16.1.1.1.cmml" xref="S4.SS2.p1.16.m16.1.1.1"></eq><ci id="S4.SS2.p1.16.m16.1.1.2.cmml" xref="S4.SS2.p1.16.m16.1.1.2">𝛿</ci><cn type="float" id="S4.SS2.p1.16.m16.1.1.3.cmml" xref="S4.SS2.p1.16.m16.1.1.3">0.8</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.16.m16.1c">{\delta=0.8}</annotation></semantics></math>, <math id="S4.SS2.p1.17.m17.1" class="ltx_Math" alttext="{D=128}" display="inline"><semantics id="S4.SS2.p1.17.m17.1a"><mrow id="S4.SS2.p1.17.m17.1.1" xref="S4.SS2.p1.17.m17.1.1.cmml"><mi id="S4.SS2.p1.17.m17.1.1.2" xref="S4.SS2.p1.17.m17.1.1.2.cmml">D</mi><mo id="S4.SS2.p1.17.m17.1.1.1" xref="S4.SS2.p1.17.m17.1.1.1.cmml">=</mo><mn id="S4.SS2.p1.17.m17.1.1.3" xref="S4.SS2.p1.17.m17.1.1.3.cmml">128</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.17.m17.1b"><apply id="S4.SS2.p1.17.m17.1.1.cmml" xref="S4.SS2.p1.17.m17.1.1"><eq id="S4.SS2.p1.17.m17.1.1.1.cmml" xref="S4.SS2.p1.17.m17.1.1.1"></eq><ci id="S4.SS2.p1.17.m17.1.1.2.cmml" xref="S4.SS2.p1.17.m17.1.1.2">𝐷</ci><cn type="integer" id="S4.SS2.p1.17.m17.1.1.3.cmml" xref="S4.SS2.p1.17.m17.1.1.3">128</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.17.m17.1c">{D=128}</annotation></semantics></math>.</p>
</div>
<div id="S4.SS2.p2" class="ltx_para">
<p id="S4.SS2.p2.6" class="ltx_p">During training, stochastic gradient descent (SGD) is used as an optimizer with a weight decay of <math id="S4.SS2.p2.1.m1.1" class="ltx_Math" alttext="5e^{-4}" display="inline"><semantics id="S4.SS2.p2.1.m1.1a"><mrow id="S4.SS2.p2.1.m1.1.1" xref="S4.SS2.p2.1.m1.1.1.cmml"><mn id="S4.SS2.p2.1.m1.1.1.2" xref="S4.SS2.p2.1.m1.1.1.2.cmml">5</mn><mo lspace="0em" rspace="0em" id="S4.SS2.p2.1.m1.1.1.1" xref="S4.SS2.p2.1.m1.1.1.1.cmml">​</mo><msup id="S4.SS2.p2.1.m1.1.1.3" xref="S4.SS2.p2.1.m1.1.1.3.cmml"><mi id="S4.SS2.p2.1.m1.1.1.3.2" xref="S4.SS2.p2.1.m1.1.1.3.2.cmml">e</mi><mrow id="S4.SS2.p2.1.m1.1.1.3.3" xref="S4.SS2.p2.1.m1.1.1.3.3.cmml"><mo id="S4.SS2.p2.1.m1.1.1.3.3a" xref="S4.SS2.p2.1.m1.1.1.3.3.cmml">−</mo><mn id="S4.SS2.p2.1.m1.1.1.3.3.2" xref="S4.SS2.p2.1.m1.1.1.3.3.2.cmml">4</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.1.m1.1b"><apply id="S4.SS2.p2.1.m1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1"><times id="S4.SS2.p2.1.m1.1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1.1"></times><cn type="integer" id="S4.SS2.p2.1.m1.1.1.2.cmml" xref="S4.SS2.p2.1.m1.1.1.2">5</cn><apply id="S4.SS2.p2.1.m1.1.1.3.cmml" xref="S4.SS2.p2.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p2.1.m1.1.1.3.1.cmml" xref="S4.SS2.p2.1.m1.1.1.3">superscript</csymbol><ci id="S4.SS2.p2.1.m1.1.1.3.2.cmml" xref="S4.SS2.p2.1.m1.1.1.3.2">𝑒</ci><apply id="S4.SS2.p2.1.m1.1.1.3.3.cmml" xref="S4.SS2.p2.1.m1.1.1.3.3"><minus id="S4.SS2.p2.1.m1.1.1.3.3.1.cmml" xref="S4.SS2.p2.1.m1.1.1.3.3"></minus><cn type="integer" id="S4.SS2.p2.1.m1.1.1.3.3.2.cmml" xref="S4.SS2.p2.1.m1.1.1.3.3.2">4</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.1.m1.1c">5e^{-4}</annotation></semantics></math> and momentum of <math id="S4.SS2.p2.2.m2.1" class="ltx_Math" alttext="0.9" display="inline"><semantics id="S4.SS2.p2.2.m2.1a"><mn id="S4.SS2.p2.2.m2.1.1" xref="S4.SS2.p2.2.m2.1.1.cmml">0.9</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.2.m2.1b"><cn type="float" id="S4.SS2.p2.2.m2.1.1.cmml" xref="S4.SS2.p2.2.m2.1.1">0.9</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.2.m2.1c">0.9</annotation></semantics></math>. Each batch consists of 16 images, eight from the source domain and eight from the target domain. We resized all the input images so that the shorter side has a length of 800 pixels and applied random horizontal flipping with a probability of 0.5. The entire model is trained with an initial learning rate of <math id="S4.SS2.p2.3.m3.1" class="ltx_Math" alttext="2.5e^{-3}" display="inline"><semantics id="S4.SS2.p2.3.m3.1a"><mrow id="S4.SS2.p2.3.m3.1.1" xref="S4.SS2.p2.3.m3.1.1.cmml"><mn id="S4.SS2.p2.3.m3.1.1.2" xref="S4.SS2.p2.3.m3.1.1.2.cmml">2.5</mn><mo lspace="0em" rspace="0em" id="S4.SS2.p2.3.m3.1.1.1" xref="S4.SS2.p2.3.m3.1.1.1.cmml">​</mo><msup id="S4.SS2.p2.3.m3.1.1.3" xref="S4.SS2.p2.3.m3.1.1.3.cmml"><mi id="S4.SS2.p2.3.m3.1.1.3.2" xref="S4.SS2.p2.3.m3.1.1.3.2.cmml">e</mi><mrow id="S4.SS2.p2.3.m3.1.1.3.3" xref="S4.SS2.p2.3.m3.1.1.3.3.cmml"><mo id="S4.SS2.p2.3.m3.1.1.3.3a" xref="S4.SS2.p2.3.m3.1.1.3.3.cmml">−</mo><mn id="S4.SS2.p2.3.m3.1.1.3.3.2" xref="S4.SS2.p2.3.m3.1.1.3.3.2.cmml">3</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.3.m3.1b"><apply id="S4.SS2.p2.3.m3.1.1.cmml" xref="S4.SS2.p2.3.m3.1.1"><times id="S4.SS2.p2.3.m3.1.1.1.cmml" xref="S4.SS2.p2.3.m3.1.1.1"></times><cn type="float" id="S4.SS2.p2.3.m3.1.1.2.cmml" xref="S4.SS2.p2.3.m3.1.1.2">2.5</cn><apply id="S4.SS2.p2.3.m3.1.1.3.cmml" xref="S4.SS2.p2.3.m3.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p2.3.m3.1.1.3.1.cmml" xref="S4.SS2.p2.3.m3.1.1.3">superscript</csymbol><ci id="S4.SS2.p2.3.m3.1.1.3.2.cmml" xref="S4.SS2.p2.3.m3.1.1.3.2">𝑒</ci><apply id="S4.SS2.p2.3.m3.1.1.3.3.cmml" xref="S4.SS2.p2.3.m3.1.1.3.3"><minus id="S4.SS2.p2.3.m3.1.1.3.3.1.cmml" xref="S4.SS2.p2.3.m3.1.1.3.3"></minus><cn type="integer" id="S4.SS2.p2.3.m3.1.1.3.3.2.cmml" xref="S4.SS2.p2.3.m3.1.1.3.3.2">3</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.3.m3.1c">2.5e^{-3}</annotation></semantics></math> for <math id="S4.SS2.p2.4.m4.1" class="ltx_Math" alttext="9.5k" display="inline"><semantics id="S4.SS2.p2.4.m4.1a"><mrow id="S4.SS2.p2.4.m4.1.1" xref="S4.SS2.p2.4.m4.1.1.cmml"><mn id="S4.SS2.p2.4.m4.1.1.2" xref="S4.SS2.p2.4.m4.1.1.2.cmml">9.5</mn><mo lspace="0em" rspace="0em" id="S4.SS2.p2.4.m4.1.1.1" xref="S4.SS2.p2.4.m4.1.1.1.cmml">​</mo><mi id="S4.SS2.p2.4.m4.1.1.3" xref="S4.SS2.p2.4.m4.1.1.3.cmml">k</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.4.m4.1b"><apply id="S4.SS2.p2.4.m4.1.1.cmml" xref="S4.SS2.p2.4.m4.1.1"><times id="S4.SS2.p2.4.m4.1.1.1.cmml" xref="S4.SS2.p2.4.m4.1.1.1"></times><cn type="float" id="S4.SS2.p2.4.m4.1.1.2.cmml" xref="S4.SS2.p2.4.m4.1.1.2">9.5</cn><ci id="S4.SS2.p2.4.m4.1.1.3.cmml" xref="S4.SS2.p2.4.m4.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.4.m4.1c">9.5k</annotation></semantics></math> iterations and then reduced to <math id="S4.SS2.p2.5.m5.1" class="ltx_Math" alttext="2.5e^{-4}" display="inline"><semantics id="S4.SS2.p2.5.m5.1a"><mrow id="S4.SS2.p2.5.m5.1.1" xref="S4.SS2.p2.5.m5.1.1.cmml"><mn id="S4.SS2.p2.5.m5.1.1.2" xref="S4.SS2.p2.5.m5.1.1.2.cmml">2.5</mn><mo lspace="0em" rspace="0em" id="S4.SS2.p2.5.m5.1.1.1" xref="S4.SS2.p2.5.m5.1.1.1.cmml">​</mo><msup id="S4.SS2.p2.5.m5.1.1.3" xref="S4.SS2.p2.5.m5.1.1.3.cmml"><mi id="S4.SS2.p2.5.m5.1.1.3.2" xref="S4.SS2.p2.5.m5.1.1.3.2.cmml">e</mi><mrow id="S4.SS2.p2.5.m5.1.1.3.3" xref="S4.SS2.p2.5.m5.1.1.3.3.cmml"><mo id="S4.SS2.p2.5.m5.1.1.3.3a" xref="S4.SS2.p2.5.m5.1.1.3.3.cmml">−</mo><mn id="S4.SS2.p2.5.m5.1.1.3.3.2" xref="S4.SS2.p2.5.m5.1.1.3.3.2.cmml">4</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.5.m5.1b"><apply id="S4.SS2.p2.5.m5.1.1.cmml" xref="S4.SS2.p2.5.m5.1.1"><times id="S4.SS2.p2.5.m5.1.1.1.cmml" xref="S4.SS2.p2.5.m5.1.1.1"></times><cn type="float" id="S4.SS2.p2.5.m5.1.1.2.cmml" xref="S4.SS2.p2.5.m5.1.1.2">2.5</cn><apply id="S4.SS2.p2.5.m5.1.1.3.cmml" xref="S4.SS2.p2.5.m5.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p2.5.m5.1.1.3.1.cmml" xref="S4.SS2.p2.5.m5.1.1.3">superscript</csymbol><ci id="S4.SS2.p2.5.m5.1.1.3.2.cmml" xref="S4.SS2.p2.5.m5.1.1.3.2">𝑒</ci><apply id="S4.SS2.p2.5.m5.1.1.3.3.cmml" xref="S4.SS2.p2.5.m5.1.1.3.3"><minus id="S4.SS2.p2.5.m5.1.1.3.3.1.cmml" xref="S4.SS2.p2.5.m5.1.1.3.3"></minus><cn type="integer" id="S4.SS2.p2.5.m5.1.1.3.3.2.cmml" xref="S4.SS2.p2.5.m5.1.1.3.3.2">4</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.5.m5.1c">2.5e^{-4}</annotation></semantics></math> for another <math id="S4.SS2.p2.6.m6.1" class="ltx_Math" alttext="2k" display="inline"><semantics id="S4.SS2.p2.6.m6.1a"><mrow id="S4.SS2.p2.6.m6.1.1" xref="S4.SS2.p2.6.m6.1.1.cmml"><mn id="S4.SS2.p2.6.m6.1.1.2" xref="S4.SS2.p2.6.m6.1.1.2.cmml">2</mn><mo lspace="0em" rspace="0em" id="S4.SS2.p2.6.m6.1.1.1" xref="S4.SS2.p2.6.m6.1.1.1.cmml">​</mo><mi id="S4.SS2.p2.6.m6.1.1.3" xref="S4.SS2.p2.6.m6.1.1.3.cmml">k</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.6.m6.1b"><apply id="S4.SS2.p2.6.m6.1.1.cmml" xref="S4.SS2.p2.6.m6.1.1"><times id="S4.SS2.p2.6.m6.1.1.1.cmml" xref="S4.SS2.p2.6.m6.1.1.1"></times><cn type="integer" id="S4.SS2.p2.6.m6.1.1.2.cmml" xref="S4.SS2.p2.6.m6.1.1.2">2</cn><ci id="S4.SS2.p2.6.m6.1.1.3.cmml" xref="S4.SS2.p2.6.m6.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.6.m6.1c">2k</annotation></semantics></math> iterations.</p>
</div>
<div id="S4.SS2.p3" class="ltx_para ltx_noindent">
<p id="S4.SS2.p3.1" class="ltx_p"><span id="S4.SS2.p3.1.1" class="ltx_text ltx_font_bold">Comparison Methods.</span>
To demonstrate the efficacy of our method under real-world adverse weather conditions, our method is compared to other detection methods designed for such conditions. For comparison with the method utilizing synthetic weather data, <span id="S4.SS2.p3.1.2" class="ltx_text ltx_font_italic">Physics-based</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite> is adopted, which trains the model in a supervised manner using synthetic rainy images. Note that <span id="S4.SS2.p3.1.3" class="ltx_text ltx_font_italic">Physics-based</span> and <span id="S4.SS2.p3.1.4" class="ltx_text ltx_font_italic">Rain Rendering</span> dataset uses the same method to synthesize rain. The rain removal network, <span id="S4.SS2.p3.1.5" class="ltx_text ltx_font_italic">MPRNet</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib28" title="" class="ltx_ref">28</a>]</cite>, is also utilized. The removal network is trained using synthetic paired images of <span id="S4.SS2.p3.1.6" class="ltx_text ltx_font_italic">Cityscapes</span> and <span id="S4.SS2.p3.1.7" class="ltx_text ltx_font_italic">Rain Rendering</span>, and evaluation is conducted on restored images from the network using a detector trained only with clear source domain data. We also include results from several UDA methods. <span id="S4.SS2.p3.1.8" class="ltx_text ltx_font_italic">SADA</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite> directly aligns source and target features at both the image-level and instance-level through adversarial training, whereas <span id="S4.SS2.p3.1.9" class="ltx_text ltx_font_italic">SWDA</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite> focuses solely on aligning image-level features. However, none of the aforementioned methods address the style and weather gaps separately.</p>
</div>
<div id="S4.SS2.p4" class="ltx_para ltx_noindent">
<p id="S4.SS2.p4.2" class="ltx_p"><span id="S4.SS2.p4.2.1" class="ltx_text ltx_font_bold">Evaluation Metric.</span>
The mean Average Precision (mAP) of all categories is used for evaluation with an Intersection over Union (IoU) threshold of <math id="S4.SS2.p4.1.m1.1" class="ltx_Math" alttext="0.5" display="inline"><semantics id="S4.SS2.p4.1.m1.1a"><mn id="S4.SS2.p4.1.m1.1.1" xref="S4.SS2.p4.1.m1.1.1.cmml">0.5</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.1.m1.1b"><cn type="float" id="S4.SS2.p4.1.m1.1.1.cmml" xref="S4.SS2.p4.1.m1.1.1">0.5</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.1.m1.1c">0.5</annotation></semantics></math> to compute the Average Precision (AP). Due to class imbalance issues in our dataset, class-agnostic AP is calculated for all the bounding boxes with an IoU threshold of <math id="S4.SS2.p4.2.m2.1" class="ltx_Math" alttext="0.5" display="inline"><semantics id="S4.SS2.p4.2.m2.1a"><mn id="S4.SS2.p4.2.m2.1.1" xref="S4.SS2.p4.2.m2.1.1.cmml">0.5</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.2.m2.1b"><cn type="float" id="S4.SS2.p4.2.m2.1.1.cmml" xref="S4.SS2.p4.2.m2.1.1">0.5</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.2.m2.1c">0.5</annotation></semantics></math> for a fair comparison.</p>
</div>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S4.SS3.5.1.1" class="ltx_text">IV-C</span> </span><span id="S4.SS3.6.2" class="ltx_text ltx_font_italic">Experimental Results</span>
</h3>

<figure id="S4.T2" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">TABLE II: </span>
Results of the ablation studies. mAP (%) is used as an evaluation metric. Incorporating each module improves detection performance.
</figcaption>
<div id="S4.T2.1" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:136.3pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(16.3pt,-5.1pt) scale(1.08149477156937,1.08149477156937) ;">
<table id="S4.T2.1.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T2.1.1.1.1" class="ltx_tr">
<th id="S4.T2.1.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_tt" style="padding-top:1pt;padding-bottom:1pt;" colspan="2"><span id="S4.T2.1.1.1.1.1.1" class="ltx_text ltx_font_bold">Module</span></th>
<th id="S4.T2.1.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-top:1pt;padding-bottom:1pt;" colspan="2"><span id="S4.T2.1.1.1.1.2.1" class="ltx_text ltx_font_bold">Rainy</span></th>
<th id="S4.T2.1.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-top:1pt;padding-bottom:1pt;" colspan="2"><span id="S4.T2.1.1.1.1.3.1" class="ltx_text ltx_font_bold">Snowy</span></th>
</tr>
<tr id="S4.T2.1.1.2.2" class="ltx_tr">
<th id="S4.T2.1.1.2.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;"><span id="S4.T2.1.1.2.2.1.1" class="ltx_text ltx_font_bold">Style</span></th>
<th id="S4.T2.1.1.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;"><span id="S4.T2.1.1.2.2.2.1" class="ltx_text ltx_font_bold">Weather</span></th>
<th id="S4.T2.1.1.2.2.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;"><span id="S4.T2.1.1.2.2.3.1" class="ltx_text ltx_font_italic">BDD 100K</span></th>
<th id="S4.T2.1.1.2.2.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;"><span id="S4.T2.1.1.2.2.4.1" class="ltx_text ltx_font_italic">Our Dataset</span></th>
<th id="S4.T2.1.1.2.2.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;"><span id="S4.T2.1.1.2.2.5.1" class="ltx_text ltx_font_italic">BDD 100K</span></th>
<th id="S4.T2.1.1.2.2.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;"><span id="S4.T2.1.1.2.2.6.1" class="ltx_text ltx_font_italic">Our Dataset</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T2.1.1.3.1" class="ltx_tr">
<th id="S4.T2.1.1.3.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">✗</th>
<td id="S4.T2.1.1.3.1.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">✗</td>
<td id="S4.T2.1.1.3.1.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">31.6</td>
<td id="S4.T2.1.1.3.1.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">49.4</td>
<td id="S4.T2.1.1.3.1.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">27.9</td>
<td id="S4.T2.1.1.3.1.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">57.8</td>
</tr>
<tr id="S4.T2.1.1.4.2" class="ltx_tr">
<th id="S4.T2.1.1.4.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-top:1pt;padding-bottom:1pt;">✓   <span id="S4.T2.1.1.4.2.1.1" class="ltx_text ltx_font_bold">(w.o. CBAM)</span>
</th>
<td id="S4.T2.1.1.4.2.2" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">✗</td>
<td id="S4.T2.1.1.4.2.3" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">31.5</td>
<td id="S4.T2.1.1.4.2.4" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">50.2</td>
<td id="S4.T2.1.1.4.2.5" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">27.1</td>
<td id="S4.T2.1.1.4.2.6" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">59.2</td>
</tr>
<tr id="S4.T2.1.1.5.3" class="ltx_tr">
<th id="S4.T2.1.1.5.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-top:1pt;padding-bottom:1pt;">✓     <span id="S4.T2.1.1.5.3.1.1" class="ltx_text ltx_font_bold">(w. CBAM)</span>
</th>
<td id="S4.T2.1.1.5.3.2" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">✗</td>
<td id="S4.T2.1.1.5.3.3" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">32.4</td>
<td id="S4.T2.1.1.5.3.4" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">50.7</td>
<td id="S4.T2.1.1.5.3.5" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">28.7</td>
<td id="S4.T2.1.1.5.3.6" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">59.6</td>
</tr>
<tr id="S4.T2.1.1.6.4" class="ltx_tr">
<th id="S4.T2.1.1.6.4.1" class="ltx_td ltx_align_center ltx_th ltx_th_row" style="padding-top:1pt;padding-bottom:1pt;">✗</th>
<td id="S4.T2.1.1.6.4.2" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">✓</td>
<td id="S4.T2.1.1.6.4.3" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">33.7</td>
<td id="S4.T2.1.1.6.4.4" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">51.0</td>
<td id="S4.T2.1.1.6.4.5" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">29.3</td>
<td id="S4.T2.1.1.6.4.6" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">61.5</td>
</tr>
<tr id="S4.T2.1.1.7.5" class="ltx_tr">
<th id="S4.T2.1.1.7.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" style="padding-top:1pt;padding-bottom:1pt;">✓     <span id="S4.T2.1.1.7.5.1.1" class="ltx_text ltx_font_bold">(w. CBAM)</span>
</th>
<td id="S4.T2.1.1.7.5.2" class="ltx_td ltx_align_center ltx_border_bb" style="padding-top:1pt;padding-bottom:1pt;">✓</td>
<td id="S4.T2.1.1.7.5.3" class="ltx_td ltx_align_center ltx_border_bb" style="padding-top:1pt;padding-bottom:1pt;"><span id="S4.T2.1.1.7.5.3.1" class="ltx_text ltx_font_bold">34.5</span></td>
<td id="S4.T2.1.1.7.5.4" class="ltx_td ltx_align_center ltx_border_bb" style="padding-top:1pt;padding-bottom:1pt;"><span id="S4.T2.1.1.7.5.4.1" class="ltx_text ltx_font_bold">51.2</span></td>
<td id="S4.T2.1.1.7.5.5" class="ltx_td ltx_align_center ltx_border_bb" style="padding-top:1pt;padding-bottom:1pt;"><span id="S4.T2.1.1.7.5.5.1" class="ltx_text ltx_font_bold">30.3</span></td>
<td id="S4.T2.1.1.7.5.6" class="ltx_td ltx_align_center ltx_border_bb" style="padding-top:1pt;padding-bottom:1pt;"><span id="S4.T2.1.1.7.5.6.1" class="ltx_text ltx_font_bold">62.6</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<div id="S4.SS3.p1" class="ltx_para ltx_noindent">
<p id="S4.SS3.p1.1" class="ltx_p"><span id="S4.SS3.p1.1.1" class="ltx_text ltx_font_bold">Comparisons with Other Methods.</span>
The quantitative and qualitative results are summarized in Table <a href="#S4.T1" title="TABLE I ‣ IV-A Datasets ‣ IV EXPERIMENTS ‣ DA-RAW: Domain Adaptive Object Detection for Real-World Adverse Weather Conditions" class="ltx_ref"><span class="ltx_text ltx_ref_tag">I</span></a> and Fig <a href="#S4.F3" title="Figure 3 ‣ IV-A Datasets ‣ IV EXPERIMENTS ‣ DA-RAW: Domain Adaptive Object Detection for Real-World Adverse Weather Conditions" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>. In both rainy and snowy conditions, our approach outperforms other methods when applied to real-world datasets. Existing UDA methods such as <span id="S4.SS3.p1.1.2" class="ltx_text ltx_font_italic">SADA</span> and <span id="S4.SS3.p1.1.3" class="ltx_text ltx_font_italic">SWDA</span> show a significant improvement in performance on synthetic datasets, but their performance on real-world datasets is only marginally improved or even decreases. This implies that existing methods that globally align distributions are ineffective when adapting to real-world datasets with a large style gap and severe weather corruption, in contrast to synthetic datasets with a small domain gap from synthetic weather.</p>
</div>
<div id="S4.SS3.p2" class="ltx_para">
<p id="S4.SS3.p2.1" class="ltx_p">In addition, <span id="S4.SS3.p2.1.1" class="ltx_text ltx_font_italic">SWDA</span> outperforms <span id="S4.SS3.p2.1.2" class="ltx_text ltx_font_italic">SADA</span>, despite the fact that <span id="S4.SS3.p2.1.3" class="ltx_text ltx_font_italic">SADA</span> incorporates instance-level alignment while <span id="S4.SS3.p2.1.4" class="ltx_text ltx_font_italic">SWDA</span> focuses solely on image-level alignment. This suggests that directly aligning the instance-level features that are severely contaminated in real adverse weather conditions reduces performance, necessitating the use of alternative alignment methods. Using image-level style alignment and instance-level weather alignment, our method optimizes feature alignment by resolving both style and weather gaps, thereby improving detection performance.</p>
</div>
<div id="S4.SS3.p3" class="ltx_para ltx_noindent">
<p id="S4.SS3.p3.1" class="ltx_p"><span id="S4.SS3.p3.1.1" class="ltx_text ltx_font_bold">Efficacy of Synthetic Weather Dataset.</span>
Methods that utilize synthetic weather images during training perform well when evaluated on synthetic data. However, their performance decreases when evaluated on real-world data, indicating that synthetic weather fails to accurately represent the complexities of real weather. The use of removal networks on real-world datasets also has a negative effect on performance, despite requiring more computation. As shown in Fig <a href="#S4.F3" title="Figure 3 ‣ IV-A Datasets ‣ IV EXPERIMENTS ‣ DA-RAW: Domain Adaptive Object Detection for Real-World Adverse Weather Conditions" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>, the removal network trained on synthetic data has difficulty restoring a clear image from real-world images under both rainy and snowy conditions, showing its inability to remove complex real rain and generalize to other weather conditions. In addition, detection performance decreases even in visually restored areas. This suggests that the features obtained through the removal network do not contribute to improving the detection performance. By directly adapting to downstream tasks, our method achieves superior performance on real-world datasets without relying on synthetic priors.</p>
</div>
<div id="S4.SS3.p4" class="ltx_para ltx_noindent">
<p id="S4.SS3.p4.1" class="ltx_p"><span id="S4.SS3.p4.1.1" class="ltx_text ltx_font_bold">Ablation Studies on Each Component.</span>
To validate the efficacy of each component, we conducted an ablation analysis on real-world datasets. The results are shown in Table <a href="#S4.T2" title="TABLE II ‣ IV-C Experimental Results ‣ IV EXPERIMENTS ‣ DA-RAW: Domain Adaptive Object Detection for Real-World Adverse Weather Conditions" class="ltx_ref"><span class="ltx_text ltx_ref_tag">II</span></a>. Image-level style alignment increases performance, indicating that high-level feature alignment bridges the domain gap between image-level features effectively. Particularly, there is a significant performance increase when CBAM is present, implying that CBAM improves alignment by focusing on essential features.
Incorporating instance-level weather alignment further enhances performance. This suggests that instance features obtained by self-supervised contrastive learning are robust to weather corruption and domain-invariant. Overall, combining both components achieves the highest performance, which effectively addresses both gaps.</p>
</div>
<figure id="S4.F4" class="ltx_figure"><img src="/html/2309.08152/assets/x4.png" id="S4.F4.1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="371" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>
Visualization of proposals assigned to each prototype in our rainy dataset. Each row displays the proposals whose instance embedding is highly similar to each car class prototype. Similar-shaped objects with diverse corruption and styles are assigned to identical prototypes, indicating the effectiveness of prototype-based contrastive learning. For example, the first row contains car proposals captured from a rear-view perspective and showing varying degrees of corruption.
</figcaption>
</figure>
<div id="S4.SS3.p5" class="ltx_para ltx_noindent">
<p id="S4.SS3.p5.1" class="ltx_p"><span id="S4.SS3.p5.1.1" class="ltx_text ltx_font_bold">Efficacy of Instance-level Weather Alignment.</span>
To evaluate the impact of the instance-level weather alignment on feature embeddings, we visualize proposals whose instance embeddings are highly similar to each of the car class prototypes. As shown in Fig <a href="#S4.F4" title="Figure 4 ‣ IV-C Experimental Results ‣ IV EXPERIMENTS ‣ DA-RAW: Domain Adaptive Object Detection for Real-World Adverse Weather Conditions" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>, proposals with similar object shapes but varying degrees of corruption are assigned to the same prototype. This demonstrates that our weather align module contributed to extracting semantically meaningful features that are resilient to corruption. Moreover, the fact that objects with similar shapes are gathered together in the same prototype demonstrates the efficacy of employing multiple prototypes to address intra-class variation.</p>
</div>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">V </span><span id="S5.1.1" class="ltx_text ltx_font_smallcaps">CONCLUSION</span>
</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">This paper presents a novel framework for domain adaptive object detection that improves robustness under real-world adverse weather conditions.
The proposed method effectively addresses two distinct aspects of the domain gap, the style gap and the weather gap, by using image-level style alignment and instance-level weather alignment, respectively.
Diverging from previous approaches that were mostly evaluated in synthetic datasets, our method shows robust performance on real-world datasets which have been validated through extensive experiments. We believe that our method can expand the range of applications for machines as it can detect objects in a variety of real adverse weather conditions. To make our method more applicable to real-world applications, we are investigating techniques that can adapt to dynamic adverse weather conditions during inference time.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
S. S. Halder, J.-F. Lalonde, and R. d. Charette, “Physics-based rendering for improving robustness to rain,” in <em id="bib.bib1.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF International Conference on Computer Vision (ICCV)</em>, 2019, pp. 10 203–10 212.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
M. Tremblay, S. S. Halder, R. De Charette, and J.-F. Lalonde, “Rain rendering for evaluating and improving robustness to bad weather,” <em id="bib.bib2.1.1" class="ltx_emph ltx_font_italic">International Journal of Computer Vision</em>, vol. 129, pp. 341–360, 2021.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
G. Volk, S. Müller, A. Von Bernuth, D. Hospach, and O. Bringmann, “Towards robust cnn-based object detection through augmentation with synthetic rain variations,” in <em id="bib.bib3.1.1" class="ltx_emph ltx_font_italic">2019 IEEE Intelligent Transportation Systems Conference (ITSC)</em>, 2019, pp. 285–292.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
R. Qian, R. T. Tan, W. Yang, J. Su, and J. Liu, “Attentive generative adversarial network for raindrop removal from a single image,” in <em id="bib.bib4.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE Conference on Computer Vision and Pattern Recognition (CVPR)</em>, 2018, pp. 2482–2491.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
H. Wang, Z. Yue, Q. Xie, Q. Zhao, Y. Zheng, and D. Meng, “From rain generation to rain removal,” in <em id="bib.bib5.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition (CVPR)</em>, 2021, pp. 14 791–14 801.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
Y. Ye, Y. Chang, H. Zhou, and L. Yan, “Closing the loop: Joint rain generation and removal via disentangled image translation,” in <em id="bib.bib6.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition (CVPR)</em>, 2021, pp. 2053–2062.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
Y. Ye, C. Yu, Y. Chang, L. Zhu, X.-l. Zhao, L. Yan, and Y. Tian, “Unsupervised deraining: Where contrastive learning meets self-similarity,” in <em id="bib.bib7.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition (CVPR)</em>, 2022, pp. 5821–5830.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
Y. Pei, Y. Huang, Q. Zou, Y. Lu, and S. Wang, “Does haze removal help cnn-based image classification?” in <em id="bib.bib8.1.1" class="ltx_emph ltx_font_italic">Proceedings of the European Conference on Computer Vision (ECCV)</em>, 2018, pp. 682–697.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
S. Li, I. B. Araujo, W. Ren, Z. Wang, E. K. Tokuda, R. H. Junior, R. Cesar-Junior, J. Zhang, X. Guo, and X. Cao, “Single image deraining: A comprehensive benchmark analysis,” in <em id="bib.bib9.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition (CVPR)</em>, 2019, pp. 3838–3847.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
Y. Chen, W. Li, C. Sakaridis, D. Dai, and L. Van Gool, “Domain adaptive faster r-cnn for object detection in the wild,” in <em id="bib.bib10.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE Conference on Computer Vision and Pattern Recognition (CVPR)</em>, 2018, pp. 3339–3348.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
K. Saito, Y. Ushiku, T. Harada, and K. Saenko, “Strong-weak distribution alignment for adaptive object detection,” in <em id="bib.bib11.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition (CVPR)</em>, 2019, pp. 6956–6965.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
V. A. Sindagi, P. Oza, R. Yasarla, and V. M. Patel, “Prior-based domain adaptive object detection for hazy and rainy conditions,” in <em id="bib.bib12.1.1" class="ltx_emph ltx_font_italic">Proceedings of the European Conference on Computer Vision (ECCV)</em>, 2020, pp. 763–780.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
M. Xu, H. Wang, B. Ni, Q. Tian, and W. Zhang, “Cross-domain detection via graph-induced prototype alignment,” in <em id="bib.bib13.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition (CVPR)</em>, 2020, pp. 12 355–12 364.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
J. Deng, W. Li, Y. Chen, and L. Duan, “Unbiased mean teacher for cross-domain object detection,” in <em id="bib.bib14.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition (CVPR)</em>, 2021, pp. 4091–4101.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
Y.-J. Li, X. Dai, C.-Y. Ma, Y.-C. Liu, K. Chen, B. Wu, Z. He, K. Kitani, and P. Vajda, “Cross-domain adaptive teacher for object detection,” in <em id="bib.bib15.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition (CVPR)</em>, 2022, pp. 7581–7590.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
S. Cao, D. Joshi, L.-Y. Gui, and Y.-X. Wang, “Contrastive mean teacher for domain adaptive object detectors,” in <em id="bib.bib16.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition (CVPR)</em>, 2023, pp. 23 839–23 848.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
J. Li, R. Xu, J. Ma, Q. Zou, J. Ma, and H. Yu, “Domain adaptive object detection for autonomous driving under foggy weather,” in <em id="bib.bib17.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF Winter Conference on Applications of Computer Vision (WACV)</em>, 2023, pp. 612–622.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
M. Hnewa and H. Radha, “Object detection under rainy conditions for autonomous vehicles: A review of state-of-the-art and emerging techniques,” <em id="bib.bib18.1.1" class="ltx_emph ltx_font_italic">IEEE Signal Processing Magazine</em>, vol. 38, no. 1, pp. 53–67, 2020.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
P. Oza, V. A. Sindagi, V. V. Sharmini, and V. M. Patel, “Unsupervised domain adaptation of object detectors: A survey,” <em id="bib.bib19.1.1" class="ltx_emph ltx_font_italic">IEEE Transactions on Pattern Analysis and Machine Intelligence</em>, 2023.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">
Y. Chen, H. Wang, W. Li, C. Sakaridis, D. Dai, and L. Van Gool, “Scale-aware domain adaptive faster r-cnn,” <em id="bib.bib20.1.1" class="ltx_emph ltx_font_italic">International Journal of Computer Vision</em>, vol. 129, no. 7, pp. 2223–2243, 2021.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock">
X. Ma, Z. Wang, Y. Zhan, Y. Zheng, Z. Wang, D. Dai, and C.-W. Lin, “Both style and fog matter: Cumulative domain adaptation for semantic foggy scene understanding,” in <em id="bib.bib21.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition (CVPR)</em>, 2022, pp. 18 922–18 931.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock">
M. J. Mirza, C. Buerkle, J. Jarquin, M. Opitz, F. Oboril, K.-U. Scholl, and H. Bischof, “Robustness of object detectors in degrading weather conditions,” in <em id="bib.bib22.1.1" class="ltx_emph ltx_font_italic">IEEE International Intelligent Transportation Systems Conference (ITSC)</em>, 2021, pp. 2719–2724.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock">
W. Wu, H. Chang, Y. Zheng, Z. Li, Z. Chen, and Z. Zhang, “Contrastive learning-based robust object detection under smoky conditions,” in <em id="bib.bib23.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition</em>, 2022, pp. 4295–4302.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock">
T. Rothmeier, D. Wachtel, T. von Dem Bussche-Hünnefeld, and W. Huber, “I had a bad day: Challenges of object detection in bad visibility conditions,” in <em id="bib.bib24.1.1" class="ltx_emph ltx_font_italic">IEEE Intelligent Vehicles Symposium (IV)</em>, 2023, pp. 1–6.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock">
M. Hassaballah, M. A. Kenk, K. Muhammad, and S. Minaee, “Vehicle detection and tracking in adverse weather using a deep learning framework,” <em id="bib.bib25.1.1" class="ltx_emph ltx_font_italic">IEEE Transactions on Intelligent Transportation Systems</em>, vol. 22, no. 7, pp. 4230–4242, 2020.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock">
F. Yu, H. Chen, X. Wang, W. Xian, Y. Chen, F. Liu, V. Madhavan, and T. Darrell, “Bdd100k: A diverse driving dataset for heterogeneous multitask learning,” in <em id="bib.bib26.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition (CVPR)</em>, 2020, pp. 2636–2645.

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock">
T. Wang, X. Yang, K. Xu, S. Chen, Q. Zhang, and R. W. Lau, “Spatial attentive single-image deraining with a high quality real rain dataset,” in <em id="bib.bib27.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition (CVPR)</em>, 2019, pp. 12 270–12 279.

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock">
S. W. Zamir, A. Arora, S. Khan, M. Hayat, F. S. Khan, M.-H. Yang, and L. Shao, “Multi-stage progressive image restoration,” in <em id="bib.bib28.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition (CVPR)</em>, 2021, pp. 14 821–14 831.

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock">
Y. Wei, Z. Zhang, Y. Wang, M. Xu, Y. Yang, S. Yan, and M. Wang, “Deraincyclegan: Rain attentive cyclegan for single image deraining and rainmaking,” <em id="bib.bib29.1.1" class="ltx_emph ltx_font_italic">IEEE Transactions on Image Processing</em>, vol. 30, pp. 4788–4801, 2021.

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock">
X. Chen, J. Pan, K. Jiang, Y. Li, Y. Huang, C. Kong, L. Dai, and Z. Fan, “Unpaired deep image deraining using dual contrastive learning,” in <em id="bib.bib30.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition (CVPR)</em>, 2022, pp. 2017–2026.

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock">
Y. Lee, Y. Ko, Y. Kim, and M. Jeon, “Perception-friendly video enhancement for autonomous driving under adverse weather conditions,” in <em id="bib.bib31.1.1" class="ltx_emph ltx_font_italic">IEEE International Conference on Robotics and Automation (ICRA)</em>, 2022, pp. 7760–7767.

</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[32]</span>
<span class="ltx_bibblock">
K. Wang, T. Wang, J. Qu, H. Jiang, Q. Li, and L. Chang, “An end-to-end cascaded image deraining and object detection neural network,” <em id="bib.bib32.1.1" class="ltx_emph ltx_font_italic">IEEE Robotics and Automation Letters</em>, vol. 7, no. 4, pp. 9541–9548, 2022.

</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[33]</span>
<span class="ltx_bibblock">
W. Liu, G. Ren, R. Yu, S. Guo, J. Zhu, and L. Zhang, “Image-adaptive yolo for object detection in adverse weather conditions,” in <em id="bib.bib33.1.1" class="ltx_emph ltx_font_italic">Proceedings of the AAAI Conference on Artificial Intelligence</em>, vol. 36, no. 2, 2022, pp. 1792–1800.

</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[34]</span>
<span class="ltx_bibblock">
S. Kalwar, D. Patel, A. Aanegola, K. R. Konda, S. Garg, and K. M. Krishna, “Gdip: Gated differentiable image processing for object detection in adverse conditions,” in <em id="bib.bib34.1.1" class="ltx_emph ltx_font_italic">IEEE International Conference on Robotics and Automation (ICRA)</em>, 2023, pp. 7083–7089.

</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[35]</span>
<span class="ltx_bibblock">
G. Eskandar, R. A. Marsden, P. Pandiyan, M. Döbler, K. Guirguis, and B. Yang, “An unsupervised domain adaptive approach for multimodal 2d object detection in adverse weather conditions,” in <em id="bib.bib35.1.1" class="ltx_emph ltx_font_italic">IEEE/RSJ International Conference on Intelligent Robots and Systems (IROS)</em>, 2022, pp. 10 865–10 872.

</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[36]</span>
<span class="ltx_bibblock">
H. Zhang, L. Xiao, X. Cao, and H. Foroosh, “Multiple adverse weather conditions adaptation for object detection via causal intervention,” <em id="bib.bib36.1.1" class="ltx_emph ltx_font_italic">IEEE Transactions on Pattern Analysis and Machine Intelligence</em>, 2022.

</span>
</li>
<li id="bib.bib37" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[37]</span>
<span class="ltx_bibblock">
Y. Ganin, E. Ustinova, H. Ajakan, P. Germain, H. Larochelle, F. Laviolette, M. Marchand, and V. Lempitsky, “Domain-adversarial training of neural networks,” <em id="bib.bib37.1.1" class="ltx_emph ltx_font_italic">The Journal of Machine Learning Research</em>, vol. 17, no. 1, pp. 2096–2030, 2016.

</span>
</li>
<li id="bib.bib38" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[38]</span>
<span class="ltx_bibblock">
F. Rezaeianaran, R. Shetty, R. Aljundi, D. O. Reino, S. Zhang, and B. Schiele, “Seeking similarities over differences: Similarity-based domain alignment for adaptive object detection,” in <em id="bib.bib38.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF International Conference on Computer Vision (ICCV)</em>, 2021, pp. 9204–9213.

</span>
</li>
<li id="bib.bib39" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[39]</span>
<span class="ltx_bibblock">
V. Vs, V. Gupta, P. Oza, V. A. Sindagi, and V. M. Patel, “Mega-cda: Memory guided attention for category-aware unsupervised domain adaptive object detection,” in <em id="bib.bib39.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition (CVPR)</em>, 2021, pp. 4516–4526.

</span>
</li>
<li id="bib.bib40" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[40]</span>
<span class="ltx_bibblock">
S. Choi, S. Jung, H. Yun, J. T. Kim, S. Kim, and J. Choo, “Robustnet: Improving domain generalization in urban-scene segmentation via instance selective whitening,” in <em id="bib.bib40.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition (CVPR)</em>, 2021, pp. 11 580–11 590.

</span>
</li>
<li id="bib.bib41" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[41]</span>
<span class="ltx_bibblock">
S. Lee, T. Son, and S. Kwak, “Fifo: Learning fog-invariant features for foggy scene segmentation,” in <em id="bib.bib41.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition (CVPR)</em>, 2022, pp. 18 911–18 921.

</span>
</li>
<li id="bib.bib42" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[42]</span>
<span class="ltx_bibblock">
S. Ren, K. He, R. Girshick, and J. Sun, “Faster r-cnn: Towards real-time object detection with region proposal networks,” <em id="bib.bib42.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems (NeurIPS)</em>, vol. 28, 2015.

</span>
</li>
<li id="bib.bib43" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[43]</span>
<span class="ltx_bibblock">
T.-Y. Lin, P. Dollár, R. Girshick, K. He, B. Hariharan, and S. Belongie, “Feature pyramid networks for object detection,” in <em id="bib.bib43.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE Conference on Computer Vision and Pattern Recognition (CVPR)</em>, 2017, pp. 2117–2125.

</span>
</li>
<li id="bib.bib44" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[44]</span>
<span class="ltx_bibblock">
S. Woo, J. Park, J.-Y. Lee, and I. S. Kweon, “Cbam: Convolutional block attention module,” in <em id="bib.bib44.1.1" class="ltx_emph ltx_font_italic">Proceedings of the European Conference on Computer Vision (ECCV)</em>, 2018, pp. 3–19.

</span>
</li>
<li id="bib.bib45" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[45]</span>
<span class="ltx_bibblock">
T. Zhou, W. Wang, E. Konukoglu, and L. Van Gool, “Rethinking semantic segmentation: A prototype view,” in <em id="bib.bib45.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition (CVPR)</em>, 2022, pp. 2582–2593.

</span>
</li>
<li id="bib.bib46" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[46]</span>
<span class="ltx_bibblock">
M. Cuturi, “Sinkhorn distances: Lightspeed computation of optimal transport,” <em id="bib.bib46.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems (NeurIPS)</em>, vol. 26, 2013.

</span>
</li>
<li id="bib.bib47" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[47]</span>
<span class="ltx_bibblock">
X. Hu, C.-W. Fu, L. Zhu, and P.-A. Heng, “Depth-attentional features for single-image rain removal,” in <em id="bib.bib47.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition (CVPR)</em>, 2019, pp. 8022–8031.

</span>
</li>
<li id="bib.bib48" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[48]</span>
<span class="ltx_bibblock">
M. Cordts, M. Omran, S. Ramos, T. Rehfeld, M. Enzweiler, R. Benenson, U. Franke, S. Roth, and B. Schiele, “The cityscapes dataset for semantic urban scene understanding,” in <em id="bib.bib48.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE Conference on Computer Vision and Pattern Recognition (CVPR)</em>, 2016, pp. 3213–3223.

</span>
</li>
<li id="bib.bib49" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[49]</span>
<span class="ltx_bibblock">
S. Sim, J. Min, S. Ahn, J. Lee, J. S. Lee, G. Bae, B. Kim, J. Seo, and T. S. Choe, “Build a multi-sensor dataset for autonomous driving in adverse weather conditions,” <em id="bib.bib49.1.1" class="ltx_emph ltx_font_italic">The Journal of Korea Robotics Society</em>, vol. 17, no. 3, pp. 245–254, 2022.

</span>
</li>
<li id="bib.bib50" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[50]</span>
<span class="ltx_bibblock">
J. Seo, S. Sim, and I. Shim, “Learning off-road terrain traversability with self-supervisions only,” <em id="bib.bib50.1.1" class="ltx_emph ltx_font_italic">IEEE Robotics and Automation Letters</em>, vol. 8, no. 8, pp. 4617–4624, 2023.

</span>
</li>
<li id="bib.bib51" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[51]</span>
<span class="ltx_bibblock">
K. He, X. Zhang, S. Ren, and J. Sun, “Deep residual learning for image recognition,” in <em id="bib.bib51.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE Conference on Computer Vision and Pattern Recognition (CVPR)</em>, 2016, pp. 770–778.

</span>
</li>
</ul>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2309.08151" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2309.08152" class="ar5iv-text-button ar5iv-severity-warning">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2309.08152">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2309.08152" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2309.08153" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Wed Feb 28 06:22:16 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
